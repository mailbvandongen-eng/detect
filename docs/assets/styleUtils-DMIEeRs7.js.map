{"version":3,"file":"styleUtils-DMIEeRs7.js","sources":["../../node_modules/@arcgis/core/symbols/support/styleCache.js","../../node_modules/@arcgis/core/symbols/support/styleUtils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nconst e=new Map;export{e as cachedStyles};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport e from\"../../request.js\";import r from\"../../core/Error.js\";import has from\"../../core/has.js\";import{throwIfAbortError as t}from\"../../core/promiseUtils.js\";import{removeFile as o,normalize as s}from\"../../core/urlUtils.js\";import n from\"../../portal/Portal.js\";import l from\"../../portal/PortalQueryParams.js\";import{cachedStyles as a}from\"./styleCache.js\";async function f(e,r){try{return{data:(await p(e,r)).data,baseUrl:o(e),styleUrl:e}}catch(s){return t(s),null}}function u(e,r,t){const o=null!=r.portal?r.portal:n.getDefault();let s;const l=`${o.url} - ${o.user?.username} - ${e}`,f=a.get(l);if(f)return f;const u=c(e,o,t).then(e=>(s=e,e.fetchData())).then(r=>({data:r,baseUrl:s.itemUrl??\"\",styleName:e}));return a.set(l,u),u}function c(e,t,o){return t.load(o).then(()=>{const r=new l({disableExtraQuery:!0,query:`owner:${d} AND type:${w} AND typekeywords:\"${e}\"`});return t.queryItems(r,o)}).then(({results:t})=>{let s=null;const n=e.toLowerCase();if(t&&Array.isArray(t))for(const e of t){const r=e.typeKeywords?.some(e=>e.toLowerCase()===n);if(r&&e.type===w&&e.owner===d){s=e;break}}if(!s)throw new r(\"symbolstyleutils:style-not-found\",`The style '${e}' could not be found`,{styleName:e});return s.load(o)})}function i(e,t,o){return null!=e?.styleUrl?f(e.styleUrl,o):null!=e?.styleName?u(e.styleName,t,o):Promise.reject(new r(\"symbolstyleutils:style-url-and-name-missing\",\"Either styleUrl or styleName is required to resolve a style\"))}function m(e){return null===e||\"CIMSymbolReference\"===e.type?e:{type:\"CIMSymbolReference\",symbol:e}}function y(e,r){for(const t of r)switch(t){case\"cim\":if(e.cimRef)return{format:t,url:encodeURI(e.cimRef)};break;case\"web-gltf-basisu\":{const r=b(e,\"gltf_basisu\");if(r)return{format:t,url:r};break}case\"web-gltf\":{const r=b(e,\"gltf\");if(r)return{format:t,url:r};break}case\"web\":{const r=b(e,\"gltf\");if(r)return{format:\"web-gltf\",url:r};if(e.webRef)return{format:t,url:encodeURI(e.webRef)};break}}}function b(e,r){if(!has(\"enable-feature:force-wosr\"))return e.formatInfos?.find(e=>e.type===r)?.href}function p(r,t){const o={responseType:\"json\",query:{f:\"json\"},...t};return e(s(r),o)}const d=\"esri_en\",w=\"Style\",h=\"https://cdn.arcgis.com/sharing/rest/content/items/220936cc6ed342c9937abd8f180e7d1e/resources/styles/cim/{SymbolName}.json?f=json\";export{h as Style2DUrlTemplate,i as fetchStyle,m as makeCIMSymbolRef,p as requestJSON,y as symbolUrlFromStyleItem};\n"],"names":["e","f","r","p","o","s","t","u","n","l","a","c","d","w","i","m","y","b","has","h"],"mappings":"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","x_google_ignoreList":[0,1]}