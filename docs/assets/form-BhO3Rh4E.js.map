{"version":3,"file":"form-BhO3Rh4E.js","sources":["../../node_modules/@esri/calcite-components/dist/chunks/form.js"],"sourcesContent":["/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.\nv3.3.3 */\nimport { html, isServer } from \"lit\";\nimport { q as queryElementRoots, l as closestElementCrossShadowBoundary } from \"./dom.js\";\nconst componentsWithInputEvent = [\n  \"calcite-input\",\n  \"calcite-input-number\",\n  \"calcite-input-text\",\n  \"calcite-text-area\"\n];\nfunction getClearValidationEventName(componentTag) {\n  const componentTagCamelCase = componentTag.split(\"-\").map((part, index) => index === 0 ? part : `${part[0].toUpperCase()}${part.slice(1)}`).join(\"\");\n  const clearValidationEvent = `${componentTagCamelCase}${componentsWithInputEvent.includes(componentTag) ? \"Input\" : \"Change\"}`;\n  return clearValidationEvent;\n}\nconst hiddenFormInputSlotName = \"hidden-form-input\";\nfunction isCheckable(component) {\n  return \"checked\" in component;\n}\nconst onFormResetMap = /* @__PURE__ */ new WeakMap();\nconst formComponentSet = /* @__PURE__ */ new WeakSet();\nfunction hasRegisteredFormComponentParent(form, formComponentEl) {\n  const hasParentComponentWithFormIdSet = closestElementCrossShadowBoundary(formComponentEl.parentElement, \"[form]\");\n  if (hasParentComponentWithFormIdSet) {\n    return true;\n  }\n  const formComponentRegisterEventName = \"calciteInternalFormComponentRegister\";\n  let hasRegisteredFormComponentParent2 = false;\n  form.addEventListener(formComponentRegisterEventName, (event) => {\n    hasRegisteredFormComponentParent2 = event.composedPath().some((element) => formComponentSet.has(element));\n    event.stopPropagation();\n  }, { once: true });\n  formComponentEl.dispatchEvent(new CustomEvent(formComponentRegisterEventName, {\n    bubbles: true,\n    composed: true\n  }));\n  return hasRegisteredFormComponentParent2;\n}\nfunction displayValidationMessage(component, { status, message, icon }) {\n  if (\"status\" in component) {\n    component.status = status;\n  }\n  if (\"validationIcon\" in component && typeof component.validationIcon !== \"string\") {\n    component.validationIcon = icon;\n  }\n  if (\"validationMessage\" in component && !component.validationMessage) {\n    component.validationMessage = message;\n  }\n}\nfunction getValidationComponent(el) {\n  if (el.nodeName === \"CALCITE-RADIO-BUTTON\") {\n    return closestElementCrossShadowBoundary(el, \"calcite-radio-button-group\");\n  }\n  return el;\n}\nconst invalidEvent = new CustomEvent(\"calciteInvalid\", { bubbles: true, composed: true });\nfunction invalidHandler(event) {\n  const hiddenInput = event?.target;\n  const hiddenInputMessage = hiddenInput?.validationMessage;\n  const formComponent = getValidationComponent(hiddenInput?.parentElement);\n  if (!formComponent) {\n    return;\n  }\n  const componentTag = formComponent?.nodeName?.toLowerCase();\n  const componentTagParts = componentTag?.split(\"-\");\n  if (componentTagParts.length < 2 || componentTagParts[0] !== \"calcite\") {\n    return;\n  }\n  event?.preventDefault();\n  if (\"validity\" in formComponent) {\n    formComponent.validity = hiddenInput?.validity;\n  }\n  formComponent.dispatchEvent(invalidEvent);\n  displayValidationMessage(formComponent, {\n    message: hiddenInputMessage,\n    icon: true,\n    status: \"invalid\"\n  });\n  const clearValidationEvent = getClearValidationEventName(componentTag);\n  formComponent.addEventListener(clearValidationEvent, () => {\n    if (\"status\" in formComponent) {\n      formComponent.status = \"idle\";\n    }\n    if (\"validationIcon\" in formComponent && (formComponent.validationIcon === \"\" || formComponent.validationIcon === true)) {\n      formComponent.validationIcon = false;\n    }\n    if (\"validationMessage\" in formComponent && formComponent.validationMessage === hiddenInputMessage) {\n      formComponent.validationMessage = \"\";\n    }\n    if (\"validity\" in formComponent) {\n      formComponent.validity = hiddenInput?.validity;\n    }\n  }, { once: true });\n}\nfunction submitForm(component) {\n  const { formEl } = component;\n  if (!formEl) {\n    return false;\n  }\n  formEl.addEventListener(\"invalid\", invalidHandler, true);\n  formEl.requestSubmit();\n  formEl.removeEventListener(\"invalid\", invalidHandler, true);\n  requestAnimationFrame(() => {\n    const invalidEls = formEl.querySelectorAll(\"[status=invalid]\");\n    for (const el of invalidEls) {\n      if (el?.validationMessage) {\n        el?.setFocus();\n        break;\n      }\n    }\n  });\n  return true;\n}\nfunction resetForm(component) {\n  component.formEl?.reset();\n}\nfunction connectForm(component) {\n  const { el, value } = component;\n  const associatedForm = findAssociatedForm(component);\n  if (!associatedForm || hasRegisteredFormComponentParent(associatedForm, el)) {\n    return;\n  }\n  component.formEl = associatedForm;\n  component.defaultValue = value;\n  if (isCheckable(component)) {\n    component.defaultChecked = component.checked;\n  }\n  const boundOnFormReset = onFormReset.bind(component);\n  associatedForm.addEventListener(\"reset\", boundOnFormReset);\n  onFormResetMap.set(component.el, boundOnFormReset);\n  formComponentSet.add(el);\n}\nfunction findAssociatedForm(component) {\n  const { el, form } = component;\n  return form ? queryElementRoots(el, { id: form }) : closestElementCrossShadowBoundary(el, \"form\");\n}\nfunction onFormReset() {\n  if (\"status\" in this) {\n    this.status = \"idle\";\n  }\n  if (\"validationIcon\" in this) {\n    this.validationIcon = false;\n  }\n  if (\"validationMessage\" in this) {\n    this.validationMessage = \"\";\n  }\n  if (isCheckable(this)) {\n    this.checked = this.defaultChecked;\n    return;\n  }\n  this.value = this.defaultValue;\n  this.onFormReset?.();\n}\nfunction disconnectForm(component) {\n  const { el, formEl } = component;\n  if (!formEl) {\n    return;\n  }\n  const boundOnFormReset = onFormResetMap.get(el);\n  formEl.removeEventListener(\"reset\", boundOnFormReset);\n  onFormResetMap.delete(el);\n  component.formEl = null;\n  formComponentSet.delete(el);\n}\nfunction afterConnectDefaultValueSet(component, value) {\n  component.defaultValue = value;\n}\nconst internalHiddenInputInputEvent = \"calciteInternalHiddenInputInput\";\nconst hiddenInputInputHandler = (event) => {\n  event.target.dispatchEvent(new CustomEvent(internalHiddenInputInputEvent, { bubbles: true }));\n};\nconst removeHiddenInputChangeEventListener = (input) => input.removeEventListener(\"input\", hiddenInputInputHandler);\nfunction syncHiddenFormInput(component) {\n  const { el, formEl, name, value } = component;\n  const { ownerDocument } = el;\n  if (isServer) {\n    return;\n  }\n  const inputs = el.querySelectorAll(`input[slot=\"${hiddenFormInputSlotName}\"]`);\n  if (!formEl || !name) {\n    inputs.forEach((input) => {\n      removeHiddenInputChangeEventListener(input);\n      input.remove();\n    });\n    return;\n  }\n  const values = Array.isArray(value) ? value : [value];\n  const extra = [];\n  const seen = /* @__PURE__ */ new Set();\n  inputs.forEach((input) => {\n    const valueMatch = values.find((val) => (\n      /* intentional non-strict equality check */\n      val == input.value\n    ));\n    if (valueMatch != null) {\n      seen.add(valueMatch);\n      defaultSyncHiddenFormInput(component, input, valueMatch);\n    } else {\n      extra.push(input);\n    }\n  });\n  let docFrag;\n  values.forEach((value2) => {\n    if (seen.has(value2)) {\n      return;\n    }\n    let input = extra.pop();\n    if (!input) {\n      input = ownerDocument.createElement(\"input\");\n      input.ariaHidden = \"true\";\n      input.slot = hiddenFormInputSlotName;\n    }\n    if (!docFrag) {\n      docFrag = ownerDocument.createDocumentFragment();\n    }\n    docFrag.append(input);\n    input.addEventListener(\"input\", hiddenInputInputHandler);\n    defaultSyncHiddenFormInput(component, input, value2);\n  });\n  if (docFrag) {\n    el.append(docFrag);\n  }\n  extra.forEach((input) => {\n    removeHiddenInputChangeEventListener(input);\n    input.remove();\n  });\n}\nfunction defaultSyncHiddenFormInput(component, input, value) {\n  const { defaultValue, disabled, form, name, required } = component;\n  input.defaultValue = defaultValue;\n  input.disabled = disabled;\n  input.name = name;\n  input.required = required;\n  input.tabIndex = -1;\n  if (form) {\n    input.setAttribute(\"form\", form);\n  } else {\n    input.removeAttribute(\"form\");\n  }\n  if (isCheckable(component)) {\n    input.checked = component.checked;\n    input.defaultChecked = component.defaultChecked;\n    input.value = component.checked ? value || \"on\" : \"\";\n  } else {\n    input.value = value || \"\";\n  }\n  component.syncHiddenFormInput?.(input);\n  const validationComponent = getValidationComponent(component.el);\n  if (validationComponent && \"validity\" in validationComponent) {\n    for (const key in { ...input?.validity }) {\n      validationComponent.validity[key] = input.validity[key];\n    }\n  }\n}\nconst HiddenFormInputSlot = ({ component }) => {\n  syncHiddenFormInput(component);\n  return html`<slot name=${hiddenFormInputSlotName}></slot>`;\n};\nexport {\n  HiddenFormInputSlot as H,\n  afterConnectDefaultValueSet as a,\n  connectForm as c,\n  disconnectForm as d,\n  findAssociatedForm as f,\n  internalHiddenInputInputEvent as i,\n  resetForm as r,\n  submitForm as s\n};\n"],"names":["componentsWithInputEvent","getClearValidationEventName","componentTag","part","index","hiddenFormInputSlotName","isCheckable","component","onFormResetMap","formComponentSet","hasRegisteredFormComponentParent","form","formComponentEl","closestElementCrossShadowBoundary","formComponentRegisterEventName","hasRegisteredFormComponentParent2","event","element","displayValidationMessage","status","message","icon","getValidationComponent","el","invalidEvent","invalidHandler","hiddenInput","hiddenInputMessage","formComponent","componentTagParts","clearValidationEvent","submitForm","formEl","invalidEls","resetForm","connectForm","value","associatedForm","findAssociatedForm","boundOnFormReset","onFormReset","queryElementRoots","disconnectForm","internalHiddenInputInputEvent","hiddenInputInputHandler","removeHiddenInputChangeEventListener","input","syncHiddenFormInput","name","ownerDocument","inputs","values","extra","seen","valueMatch","val","defaultSyncHiddenFormInput","docFrag","value2","defaultValue","disabled","required","validationComponent","key","HiddenFormInputSlot","html"],"mappings":"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","x_google_ignoreList":[0]}