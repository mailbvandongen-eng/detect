const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/romeinseFortenOL-BBlpfbsn.js","assets/iconStyles-DAr_oSlc.js","assets/kastelenOL-DElmWUAN.js","assets/ruinesOL-DgZtGTzU.js","assets/hunebeddenOL-CQ_alGjJ.js","assets/uikavArcheoPuntenOL-6LhMeQKX.js","assets/speeltuinenOL-DBBAxcol.js","assets/museaOL-3plmPfO9.js","assets/kringloopwinkelsOL-wL8CDkrq.js","assets/fossielenOL-CFARDOId.js","assets/fossielUtils-CaXKWWk2.js","assets/fossielenBelgieOL-B4D9oNSi.js","assets/fossielenDuitslandOL-BSYtoSdU.js","assets/fossielenFrankrijkOL-CLQ5GXnu.js","assets/bunkersOL-C6iYRIOQ.js","assets/grafheuvelsOL-FGDvMy6t.js","assets/slagveldenOL-BL9eLWeC.js","assets/IdentityManager-DFUti-1r.js","assets/substitute-DGRfC_eV.js","assets/ElevationLayer-ld381kaw.js","assets/MultiOriginJSONSupport-CbJS1UlB.js","assets/ArcGISCachedService-CCwyDPSc.js","assets/TileInfoTilemapCache-DmJp-J10.js","assets/TilemapCache-PFgnip39.js","assets/LRUCache-IbJQQegO.js","assets/MemCache-Bidw_rOY.js","assets/memoryEstimations-BGhAjZDK.js","assets/ArcGISService-CIzGWy6k.js","assets/OperationalLayer-CrR-atD1.js","assets/layerContainerType-CSXZNpHb.js","assets/ElevationInfo-D2xmZjwG.js","assets/lengthUtils-BXxFayF7.js","assets/PortalLayer-CpCMbe89.js","assets/portalItemUtils-bR7CPcUS.js","assets/WorkerHandle-BdUuBzG2.js","assets/portalLayers-kXvbU65y.js","assets/associatedFeatureServiceUtils-Ctvzk16P.js","assets/fetchService-gFBk87MB.js","assets/loadUtils-Ddv7ENQJ.js","assets/lazyLayerLoader-CXrgzrFF.js","assets/arcgisLayers-DpVrOYHr.js","assets/layersCreator-BMyNPotq.js","assets/styleUtils-XgKdxtFV.js","assets/ElevationQuery-CenUEadC.js","assets/GeometryDescriptor-DDZ7i_MX.js","assets/projectOperator-BJA3HQw3.js","assets/operatorProject-DhLZawQQ.js","assets/SimpleGeometryCursor-B92kdZ15.js","assets/projectOperator-B7dM8_lB.js","assets/statsWorker-DE7ff43w.js","assets/utils-DeVYW--r.js","assets/quantizationUtils-B55mrdGj.js","assets/heatmapUtils-Dx78u6Pg.js","assets/vec42-CMYsJlTP.js","assets/vec4f64-DPb6J-GU.js","assets/utils-BtATgCaH.js","assets/utils-DoNwr8BG.js","assets/ClassBreaksDefinition-CfWa5ffe.js","assets/geometryEngineWorker-BkMQzpX8.js","assets/geometryEngineJSON-B_JiqPb-.js","assets/geometryEngineBase-BQTefT4Y.js","assets/_commonjsHelpers-DCkdB7M8.js","assets/CSVSourceWorker-BMxFtt5l.js","assets/date-DCujAECq.js","assets/OptimizedFeature-BavZyfuI.js","assets/FeatureStore-Dkt8kNvU.js","assets/featureConversionUtils-zRDE-OYA.js","assets/OptimizedFeatureSet-BR8EEvDc.js","assets/BoundsStore-BNbTlgZM.js","assets/PooledRBush-CWatzrde.js","assets/timeSupport-DkiOswl4.js","assets/queryUtils-Ckr2-7_S.js","assets/optimizedFeatureQueryEngineAdapter-J-scO5iI.js","assets/QueryEngine-N7s1XjFY.js","assets/WhereClauseCache-C0-QJhgG.js","assets/WhereClause-DJnwoAoq.js","assets/TimeOnly-DBpKbJWQ.js","assets/enum-68EmjVnQ.js","assets/UnknownTimeZone-B8uW0JUD.js","assets/QueryEngineCapabilities-DJC_YILC.js","assets/SnappingCandidate-DGkpYqI6.js","assets/FixedIntervalBinParameters-OI2P5CBt.js","assets/NormalizationBinParametersMixin-Cz3OaItC.js","assets/FieldsIndex-BJzO5Utx.js","assets/number-aRHS8wd2.js","assets/locationUtils-CaazTe-j.js","assets/clientSideDefaults-BWqd6ipi.js","assets/defaultsJSON-GKolV7NZ.js","assets/EdgeProcessingWorker-hVK5erMg.js","assets/workerHelper-DCh3dmwO.js","assets/InterleavedLayout-DusR75PG.js","assets/BufferView-DU0VGkzl.js","assets/types-BKo2foNY.js","assets/VertexElementDescriptor-BLyltQyJ.js","assets/VertexAttributeLocations-BfZbt_DV.js","assets/edgeProcessing-DMuvYNgk.js","assets/deduplicate-C-5r55wT.js","assets/Indices-C02eSOcA.js","assets/Normals-Dirhkm9E.js","assets/ElevationSamplerWorker-DaTlFgKN.js","assets/MeshLocalVertexSpace-CZPDFoZ4.js","assets/vertexSpaceConversion-BF_JblgE.js","assets/spatialReferenceEllipsoidUtils-Dosa9Uyj.js","assets/computeTranslationToOriginAndRotation-CDvwQUTm.js","assets/projectPointToVector-C02DVwI4.js","assets/meshVertexSpaceUtils-CsJ_uyoM.js","assets/vec3-CjFXij0N.js","assets/vec4-BTyw_Owz.js","assets/FeatureServiceSnappingSourceWorker-DIRh2TGy.js","assets/symbologySnappingCandidates-DQGMML5l.js","assets/pbfQueryUtils-CsHBZOtV.js","assets/pbf-DkU9TF1Q.js","assets/query-yHlx19Vp.js","assets/queryZScale-_9wllB6A.js","assets/GeoJSONSourceWorker-QnrLeICt.js","assets/geojson-D5yrGc1-.js","assets/sourceUtils-D18mE9Pf.js","assets/MemorySourceWorker-fUIAN2Yh.js","assets/objectIdUtils-BmFjqQA3.js","assets/PBFDecoderWorker-B_6Xl-mR.js","assets/dehydratedFeatures-BVqHKnJK.js","assets/FeaturePipelineWorker-Ggp6QCA7.js","assets/diffUtils-CyJUxP1H.js","assets/AttributeStore-DLTvipSn.js","assets/Utils-CEYNCMzV.js","assets/BoundingBox-DO19XMjX.js","assets/UpdateTracking2D-HIqqyJSI.js","assets/ArcadeExpression-B7FztpWd.js","assets/FeatureStoreQueryAdapter-CFI8Mnhj.js","assets/labelPoint-B-ouEX_C.js","assets/labelUtils-Dvd1l_54.js","assets/utils-DQaLv0i_.js","assets/defaultCIMValues-XI-Li77m.js","assets/constants-BBnGEY1d.js","assets/streamLayerUtils-DFlbJ4P1.js","assets/DictionaryScriptEvaluator-pLOB-niA.js","assets/MeshWriterRegistry-XAfJUIJM.js","assets/rasterizingUtils-DQjRzPv6.js","assets/CIMSymbolHelper-CBzNJQ4p.js","assets/BidiEngine-BvER9tXK.js","assets/GeometryUtils-Pl4xx74D.js","assets/Rect-CUzevAry.js","assets/defaults-Drc0XXWm.js","assets/TexturedLineMeshWriter-C0fM7LcB.js","assets/TurboLine-BQKeccz-.js","assets/grouping-HAX8VLMy.js","assets/QueueProcessor-BlaeYgt8.js","assets/FeatureMetadata-B_d0SQSS.js","assets/SourceChunkStore-DVEmyckZ.js","assets/parquet-5Vmt7sR7.js","assets/operatorGeodeticDensify-b4p-S-b6.js","assets/geodeticCurveType-CirnHLSB.js","assets/normalizeUtilsSync-BWNUju72.js","assets/FeatureIdInfo-aDT3ima4.js","assets/displayFilterUtils-DLbBILkF.js","assets/ogcFeatureUtils-DcyhXSy6.js","assets/CircularArray-CujHzHWW.js","assets/createConnection-C1iA4F0L.js","assets/PointCloudWorker-CxWeMIVs.js","assets/quat-DOlZWD6i.js","assets/quatf64-aQ5IuZRd.js","assets/vec3f32-WCVSSNPR.js","assets/PointCloudUniqueValueRenderer-Bgz4bfX_.js","assets/RendererLegendOptions-Dz63neU1.js","assets/ColorStop-BJJHP4dB.js","assets/I3SBinaryReader-C_zVuJx4.js","assets/orientedBoundingBox-ByehxX9L.js","assets/plane-BcCACiyc.js","assets/vectorStacks-Bzll5TB3.js","assets/RasterWorker-DmCrRyko.js","assets/PixelBlock-DXR_ZbVG.js","assets/RasterSymbolizer-LuVDvky0.js","assets/vectorFieldUtils-BFuFWYK3.js","assets/colorUtils-Do1M8Mbe.js","assets/rasterFunctionHelper-Cpy9CtuR.js","assets/clipUtils-B9QdW-cP.js","assets/rasterProjectionHelper-C_WDmV7s.js","assets/colorRamps-DxmVOzhg.js","assets/PolynomialTransform-C2-vy_so.js","assets/dataUtils-C-HegThG.js","assets/SceneLayerSnappingSourceWorker-Cz556_yO.js","assets/lineSegment-BIos0p9I.js","assets/sphere-BL-D8A19.js","assets/Octree-D5SL_sbY.js","assets/frustum-Ddi4BKsy.js","assets/SceneLayerWorker-Df6RePjv.js","assets/projectVectorToVector-BvlBw3LY.js","assets/WFSSourceWorker-BKZkLVzG.js","assets/wfsUtils-Be86T7Rj.js","assets/xmlUtils-CtUoQO7q.js","assets/WorkerTileHandler-CESIaOou.js","assets/constants-BHYAGdRm.js","assets/config-BOD8--da.js","assets/SourceLayerData-B90_aysM.js","assets/StyleRepository-yN3ToCKB.js","assets/earcut-D9gy186-.js","assets/Feature3DPipelineWorker-CrzRpzX_.js","assets/jsonUtils-Cb0upww5.js","assets/typeUtils-CF3ULi0V.js","assets/ClassBreaksRenderer-BegXSdRV.js","assets/commonProperties-BHYZmPyi.js","assets/visualVariableUtils-CEzXbnTs.js","assets/jsonUtils-DW3mLKpf.js","assets/defaults3D-DOj78u6i.js","assets/SimpleRenderer-1IGrdjCs.js","assets/UniqueValueRenderer-iXLbUhKv.js","assets/styleUtils-BrfTNQcA.js","assets/HUDMaterial.glsl-CrmQIOgu.js","assets/hydratedFeatures-DQ_s85GK.js","assets/OutputColorHighlightOID.glsl-COWF__V4.js","assets/triangle-CESqbtkR.js","assets/renderState-CKc66y4x.js","assets/glsl-B5bJgrnA.js","assets/ShaderBuilder-DteBWsmw.js","assets/placementUtils-CzNJNu32.js","assets/sdfPrimitives-B0R1H8gB.js","assets/Texture-gCKmaSvO.js","assets/videoUtils-X_c_L6PL.js","assets/requestImageUtils-FjY3CHLr.js","assets/RealisticTree.glsl-DBQ_0TGt.js","assets/DefaultMaterial-Db36H1cH.js","assets/VertexBuffer-BC-ShP9G.js","assets/BufferObject-B-UZmAdP.js","assets/boundedPlane-ChAxDh4E.js","assets/FlowWorker-BIPsXp8K.js","assets/ParquetSourceWorker-CBzzjH_q.js","assets/parquetUtils-BBuNEpsE.js","assets/PanoramicMeshWorker-lGEBlIlk.js","assets/Popup-BuXhRrC7.js","assets/throttle-BbXmw_XR.js","assets/unitFormatUtils-CcOHTXi4.js","assets/quantityUtils-BSkHAex3.js","assets/AttachmentInfo-z-SwBneB.js","assets/labelingInfo-sI_cfMBl.js","assets/featureUtils-BOwHL7FE.js","assets/utils-DIYC_a7P.js","assets/cimSymbolUtils-CHMxfk6w.js","assets/executeQueryJSON-lHPE5N6-.js","assets/FeatureSet-DiixYWVX.js","assets/shared-BVdFhuQx.js","assets/isImageryGraphicOrigin-Ccuhb4eK.js","assets/isImageryTileGraphicOrigin-ZR-gBf9D.js","assets/FeatureLayer-DEeZcBCh.js","assets/FormTemplate-DVIQvEIY.js","assets/GraphicOrigin-w4zotpZ5.js","assets/editsZScale-D3Cp6oub.js","assets/APIKeyMixin-Dq5NSZir.js","assets/BlendLayer-HKXK0GHl.js","assets/jsonUtils-l9A-aiUG.js","assets/parser-qSiRqXq9.js","assets/CustomParametersMixin-DvWXk8mi.js","assets/DisplayFilteredLayer-CryKl_MS.js","assets/scaleUtils-32M94dzu.js","assets/EditBusLayer-lz7-5s5d.js","assets/FeatureEffectLayer-DpGAb8Cd.js","assets/FeatureEffect-CWKF-AQ4.js","assets/FeatureFilter-CT8aFKMv.js","assets/FeatureLayerBase-DNGKlwNk.js","assets/LayerFloorInfo-BEtV79UL.js","assets/multiLayerServiceUtils-CZ6XPpX4.js","assets/Relationship-6taevLpD.js","assets/serviceCapabilitiesUtils-BteeeFhW.js","assets/infoFor3D-DhzudQro.js","assets/FeatureReductionLayer-BcwVwc69.js","assets/FeatureReductionSelection-sEjVTi_Z.js","assets/OrderedLayer-C9MCC7Wr.js","assets/OrderByInfo-w21uqdkO.js","assets/RefreshableLayer-BYZkJ9FG.js","assets/ScaleRangeLayer-9b_gA67D.js","assets/TemporalLayer-CfZKjMjj.js","assets/TimeInfo-GjbjNpml.js","assets/TrackableLayer-BH1Nk-vx.js","assets/FeatureTemplate-Ch2iTPtd.js","assets/FeatureType-z2A1QACV.js","assets/fieldProperties-BFCRXABG.js","assets/TitleCreator-DhxIdvEh.js","assets/versionUtils-jqrXJ7uc.js","assets/popupUtils-BP2HLeZ3.js","assets/NetworkElement-BYrtUYRX.js","assets/ReactiveSet-B317MrEs.js","assets/symbolUtils-xLh6M7YA.js","assets/layerViewUtils-6Ni4Hwn3.js","assets/arcadeUtils-B_qLBFNH.js","assets/arcade-7gqiMkkG.js","assets/arcadeEnvironment-dqfUPYMT.js","assets/Dictionary-ihOzbCQf.js","assets/ImmutableArray-BPVd6ESQ.js","assets/Feature-BG_U0ibb.js","assets/aiServices-DWrX5INF.js","assets/commonProperties-DHiB1uzW.js","assets/unitConversion-Cdz_zCaJ.js","assets/rasterFieldUtils-DTqr5-c1.js","assets/batchExec-1XUikYCa.js","assets/webStyleSymbolUtils-Cy2vqOyb.js","assets/devEnvironmentUtils-8WtPGj6h.js","assets/geometryServiceUtils-BxsJkqOv.js","assets/project-Ck-x8nxa.js","assets/webglDeps-DLts60pU.js","assets/FramebufferObject-CQICIZED.js","assets/ProgramTemplate-BXiZNGFZ.js","assets/VertexArrayObject-BoIXx5ug.js","assets/mapViewDeps-B3twslwA.js","assets/FeatureCommandQueue-Bh9tQmVm.js","assets/GraphShaderModule-DoB-Uxqh.js","assets/utils-BUi6-GwY.js","assets/WGLContainer-B9tnZHPo.js","assets/Container-Dy9VAko5.js","assets/SDFHelper-D7b1-tCJ.js","assets/OverrideHelper-DZbaUsC5.js","assets/callExpressionWithFeature-CkeyrNQP.js","assets/GridShader-CCNhJEGP.js","assets/testSVGPremultipliedAlpha-B-mm0mMQ.js","assets/SymbolFader-CqJhoXxR.js","assets/RenderingContext-BlVJEpAY.js","assets/CIMResourceManager-ChbEdIia.js","assets/utils-B-4nr2Ln.js","assets/utils-DDjZAYSk.js","assets/GraphicsView2D-cxZzr1Hv.js","assets/GraphicContainer-QRMS6JO4.js","assets/AGraphicContainer-JVnZVcSU.js","assets/TechniqueInstance-DLurrFuo.js","assets/TileContainer-BzpLmVLv.js","assets/gridUtils-Ojt-vwO1.js","assets/geodesicUtils-BEhpICdZ.js","assets/TileLayerView2D-CQfBvOHv.js","assets/imageUtils-BIETjnX1.js","assets/BitmapTechnique-BZCZEaPU.js","assets/bitmapUtils-B8g8AeQJ.js","assets/LayerView2D-Dy9yVn6k.js","assets/HighlightGraphicContainer-B_0J-rAq.js","assets/LayerView-B8A0Nkls.js","assets/RefreshableLayerView-B9FGb5ng.js","assets/MapServiceLayerViewHelper-DJ_ispCJ.js","assets/floorFilterUtils-DKzVzLpH.js","assets/drapedUtils-BKJ4KG07.js","assets/sublayerUtils-BEQnBRaB.js","assets/popupUtils-DAEWazuG.js","assets/highlightOptionsUtils-xb47umus.js","assets/FeatureLayerView2D-BL0LIbdw.js","assets/timeSupport-D1lTF89F.js","assets/AttributeBinsFeatureSet-BP91FBxB.js","assets/AttributeBinsQuery-BBSCpsEP.js","assets/constants-SxxbBSOD.js","assets/BaseDynamicLayerView2D-DgwpOB7B.js","assets/BitmapContainer-BlKip2-p.js","assets/ExportStrategy-DO8prLnG.js","assets/CatalogLayerView2D-DcIyD7Mz.js","assets/CatalogDynamicGroupLayerView2D-Cabdx_sh.js","assets/CatalogFootprintLayerView2D-CmWP5nAd.js","assets/GeoRSSLayerView2D-Dgfjx25F.js","assets/GraphicsLayerView2D-CNs4VrzP.js","assets/GroupLayerView2D-DJbVt8tW.js","assets/ImageryLayerView2D-C-bUiTaq.js","assets/RasterVFDisplayObject-CBMX1U-u.js","assets/ImageryTileLayerView2D-zrqVdO8V.js","assets/datasetUtils-DsBiM9GP.js","assets/rasterUtils-DdW0h37S.js","assets/RawBlockCache-RCvZrdib.js","assets/KMLLayerView2D-Dhgbll5v.js","assets/kmlUtils-B95vWoXS.js","assets/KnowledgeGraphLayerView2D-Dd5TMHM2.js","assets/MapImageLayerView2D-CUbhoD4i.js","assets/ExportImageParameters-Dsy3LMUO.js","assets/MapNotesLayerView2D-C3AneEkJ.js","assets/MediaLayerView2D-BT6hxhMQ.js","assets/mediaLayerUtils-BoowP_Df.js","assets/OverlayContainer-SCWRyyAx.js","assets/OGCFeatureLayerView2D-DxttKhLR.js","assets/RouteLayerView2D-t8oQfVoo.js","assets/Stop-CxKZvpS4.js","assets/networkEnums-Vvv8uQaa.js","assets/StreamLayerView2D-fk3H_fAm.js","assets/SubtypeGroupLayerView2D-BfCIJM61.js","assets/VectorTileLayerView2D-CQp9roqE.js","assets/VideoLayerView2D-B3aqmmQk.js","assets/GraphicsLayer-BrgDSU6B.js","assets/videoUtils-yB_LTpP8.js","assets/ControlPoint-CLQz2AH1.js","assets/WMSLayerView2D-D63f7JRC.js","assets/ExportWMSImageParameters-UrjhE1Z5.js","assets/WMTSLayerView2D-CB1Y03Jo.js","assets/ElevationProfileAnalysisView2D-T2dFV-Z_.js","assets/createUtils-DBOnDPTd.js","assets/distanceOperator-CKf0vdgj.js","assets/Point2D-ByVU2sJE.js","assets/Distance2DCalculator-CXhBP-8I-BxVwC0tX.js","assets/ProjectionTransformation-DnZEpDKs.js","assets/Envelope2D-PYZ6irrd.js","assets/Transformation2D-HOoFpL6n.js","assets/OperatorDefinitions-DP7_WWTp.js","assets/apiConverter-Cf_ht3l2.js","assets/jsonConverter-C0shcYNr.js","assets/simplifyOperator-CNR06L3x.js","assets/operatorSimplify-DZYY9xfz.js","assets/mapCollectionUtils-CsUpRgxr.js","assets/elevationInfoUtils-BqoldGHT.js","assets/getDefaultUnitForView-C94qUR6c.js","assets/SketchViewModel-COiZen_H.js","assets/hitTestSelectUtils-Bwd5cZ-l.js","assets/geodeticLengthOperator-A8Vo8tVp.js","assets/apng-Cdzzv1bH.js","assets/index-BMpr3Wtw.js","assets/index-BMFarFlg.js","assets/guid-LcV_DAvu.js","assets/useT9n-DfBMrrX4.js","assets/index-BmXLn-1y.js","assets/index-D0g0MaDH.js","assets/dom-QadjOGqQ.js","assets/observers-ZUMlbFaR.js","assets/ref-fKg7zyRv.js","assets/static-aYUxgIEz.js","assets/form-CndYXHq9.js","assets/interactive-BRykZmZN.js","assets/label-CgVP1xGZ.js","assets/useSetFocus-awmh23q_.js"])))=>i.map(i=>d[i]);
var kTe=Object.getPrototypeOf;var ATe=Reflect.get;var eX=t=>{throw TypeError(t)};var l6=(t,e,n)=>e.has(t)||eX("Cannot "+n);var Mr=(t,e,n)=>(l6(t,e,"read from private field"),n?n.call(t):e.get(t)),Ru=(t,e,n)=>e.has(t)?eX("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),Mu=(t,e,n,r)=>(l6(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n),pE=(t,e,n)=>(l6(t,e,"access private method"),n);var tX=(t,e,n)=>ATe(kTe(t),n,e);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();function Gz(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var c6={exports:{}},mE={},u6={exports:{}},Kn={};var nX;function ITe(){if(nX)return Kn;nX=1;var t=Symbol.for("react.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),o=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),u=Symbol.for("react.lazy"),h=Symbol.iterator;function f(Q){return Q===null||typeof Q!="object"?null:(Q=h&&Q[h]||Q["@@iterator"],typeof Q=="function"?Q:null)}var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,_={};function b(Q,W,ne){this.props=Q,this.context=W,this.refs=_,this.updater=ne||g}b.prototype.isReactComponent={},b.prototype.setState=function(Q,W){if(typeof Q!="object"&&typeof Q!="function"&&Q!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Q,W,"setState")},b.prototype.forceUpdate=function(Q){this.updater.enqueueForceUpdate(this,Q,"forceUpdate")};function T(){}T.prototype=b.prototype;function A(Q,W,ne){this.props=Q,this.context=W,this.refs=_,this.updater=ne||g}var I=A.prototype=new T;I.constructor=A,y(I,b.prototype),I.isPureReactComponent=!0;var P=Array.isArray,R=Object.prototype.hasOwnProperty,D={current:null},C={key:!0,ref:!0,__self:!0,__source:!0};function M(Q,W,ne){var ie,le={},ve=null,qe=null;if(W!=null)for(ie in W.ref!==void 0&&(qe=W.ref),W.key!==void 0&&(ve=""+W.key),W)R.call(W,ie)&&!C.hasOwnProperty(ie)&&(le[ie]=W[ie]);var Ke=arguments.length-2;if(Ke===1)le.children=ne;else if(1<Ke){for(var Se=Array(Ke),we=0;we<Ke;we++)Se[we]=arguments[we+2];le.children=Se}if(Q&&Q.defaultProps)for(ie in Ke=Q.defaultProps,Ke)le[ie]===void 0&&(le[ie]=Ke[ie]);return{$$typeof:t,type:Q,key:ve,ref:qe,props:le,_owner:D.current}}function O(Q,W){return{$$typeof:t,type:Q.type,key:W,ref:Q.ref,props:Q.props,_owner:Q._owner}}function j(Q){return typeof Q=="object"&&Q!==null&&Q.$$typeof===t}function V(Q){var W={"=":"=0",":":"=2"};return"$"+Q.replace(/[=:]/g,function(ne){return W[ne]})}var U=/\/+/g;function G(Q,W){return typeof Q=="object"&&Q!==null&&Q.key!=null?V(""+Q.key):W.toString(36)}function de(Q,W,ne,ie,le){var ve=typeof Q;(ve==="undefined"||ve==="boolean")&&(Q=null);var qe=!1;if(Q===null)qe=!0;else switch(ve){case"string":case"number":qe=!0;break;case"object":switch(Q.$$typeof){case t:case e:qe=!0}}if(qe)return qe=Q,le=le(qe),Q=ie===""?"."+G(qe,0):ie,P(le)?(ne="",Q!=null&&(ne=Q.replace(U,"$&/")+"/"),de(le,W,ne,"",function(we){return we})):le!=null&&(j(le)&&(le=O(le,ne+(!le.key||qe&&qe.key===le.key?"":(""+le.key).replace(U,"$&/")+"/")+Q)),W.push(le)),1;if(qe=0,ie=ie===""?".":ie+":",P(Q))for(var Ke=0;Ke<Q.length;Ke++){ve=Q[Ke];var Se=ie+G(ve,Ke);qe+=de(ve,W,ne,Se,le)}else if(Se=f(Q),typeof Se=="function")for(Q=Se.call(Q),Ke=0;!(ve=Q.next()).done;)ve=ve.value,Se=ie+G(ve,Ke++),qe+=de(ve,W,ne,Se,le);else if(ve==="object")throw W=String(Q),Error("Objects are not valid as a React child (found: "+(W==="[object Object]"?"object with keys {"+Object.keys(Q).join(", ")+"}":W)+"). If you meant to render a collection of children, use an array instead.");return qe}function Ie(Q,W,ne){if(Q==null)return Q;var ie=[],le=0;return de(Q,ie,"","",function(ve){return W.call(ne,ve,le++)}),ie}function ze(Q){if(Q._status===-1){var W=Q._result;W=W(),W.then(function(ne){(Q._status===0||Q._status===-1)&&(Q._status=1,Q._result=ne)},function(ne){(Q._status===0||Q._status===-1)&&(Q._status=2,Q._result=ne)}),Q._status===-1&&(Q._status=0,Q._result=W)}if(Q._status===1)return Q._result.default;throw Q._result}var Ne={current:null},fe={transition:null},De={ReactCurrentDispatcher:Ne,ReactCurrentBatchConfig:fe,ReactCurrentOwner:D};function Ce(){throw Error("act(...) is not supported in production builds of React.")}return Kn.Children={map:Ie,forEach:function(Q,W,ne){Ie(Q,function(){W.apply(this,arguments)},ne)},count:function(Q){var W=0;return Ie(Q,function(){W++}),W},toArray:function(Q){return Ie(Q,function(W){return W})||[]},only:function(Q){if(!j(Q))throw Error("React.Children.only expected to receive a single React element child.");return Q}},Kn.Component=b,Kn.Fragment=n,Kn.Profiler=i,Kn.PureComponent=A,Kn.StrictMode=r,Kn.Suspense=l,Kn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=De,Kn.act=Ce,Kn.cloneElement=function(Q,W,ne){if(Q==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+Q+".");var ie=y({},Q.props),le=Q.key,ve=Q.ref,qe=Q._owner;if(W!=null){if(W.ref!==void 0&&(ve=W.ref,qe=D.current),W.key!==void 0&&(le=""+W.key),Q.type&&Q.type.defaultProps)var Ke=Q.type.defaultProps;for(Se in W)R.call(W,Se)&&!C.hasOwnProperty(Se)&&(ie[Se]=W[Se]===void 0&&Ke!==void 0?Ke[Se]:W[Se])}var Se=arguments.length-2;if(Se===1)ie.children=ne;else if(1<Se){Ke=Array(Se);for(var we=0;we<Se;we++)Ke[we]=arguments[we+2];ie.children=Ke}return{$$typeof:t,type:Q.type,key:le,ref:ve,props:ie,_owner:qe}},Kn.createContext=function(Q){return Q={$$typeof:o,_currentValue:Q,_currentValue2:Q,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},Q.Provider={$$typeof:s,_context:Q},Q.Consumer=Q},Kn.createElement=M,Kn.createFactory=function(Q){var W=M.bind(null,Q);return W.type=Q,W},Kn.createRef=function(){return{current:null}},Kn.forwardRef=function(Q){return{$$typeof:a,render:Q}},Kn.isValidElement=j,Kn.lazy=function(Q){return{$$typeof:u,_payload:{_status:-1,_result:Q},_init:ze}},Kn.memo=function(Q,W){return{$$typeof:c,type:Q,compare:W===void 0?null:W}},Kn.startTransition=function(Q){var W=fe.transition;fe.transition={};try{Q()}finally{fe.transition=W}},Kn.unstable_act=Ce,Kn.useCallback=function(Q,W){return Ne.current.useCallback(Q,W)},Kn.useContext=function(Q){return Ne.current.useContext(Q)},Kn.useDebugValue=function(){},Kn.useDeferredValue=function(Q){return Ne.current.useDeferredValue(Q)},Kn.useEffect=function(Q,W){return Ne.current.useEffect(Q,W)},Kn.useId=function(){return Ne.current.useId()},Kn.useImperativeHandle=function(Q,W,ne){return Ne.current.useImperativeHandle(Q,W,ne)},Kn.useInsertionEffect=function(Q,W){return Ne.current.useInsertionEffect(Q,W)},Kn.useLayoutEffect=function(Q,W){return Ne.current.useLayoutEffect(Q,W)},Kn.useMemo=function(Q,W){return Ne.current.useMemo(Q,W)},Kn.useReducer=function(Q,W,ne){return Ne.current.useReducer(Q,W,ne)},Kn.useRef=function(Q){return Ne.current.useRef(Q)},Kn.useState=function(Q){return Ne.current.useState(Q)},Kn.useSyncExternalStore=function(Q,W,ne){return Ne.current.useSyncExternalStore(Q,W,ne)},Kn.useTransition=function(){return Ne.current.useTransition()},Kn.version="18.3.1",Kn}var rX;function LA(){return rX||(rX=1,u6.exports=ITe()),u6.exports}var iX;function PTe(){if(iX)return mE;iX=1;var t=LA(),e=Symbol.for("react.element"),n=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,i=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function o(a,l,c){var u,h={},f=null,g=null;c!==void 0&&(f=""+c),l.key!==void 0&&(f=""+l.key),l.ref!==void 0&&(g=l.ref);for(u in l)r.call(l,u)&&!s.hasOwnProperty(u)&&(h[u]=l[u]);if(a&&a.defaultProps)for(u in l=a.defaultProps,l)h[u]===void 0&&(h[u]=l[u]);return{$$typeof:e,type:a,key:f,ref:g,props:h,_owner:i.current}}return mE.Fragment=n,mE.jsx=o,mE.jsxs=o,mE}var sX;function CTe(){return sX||(sX=1,c6.exports=PTe()),c6.exports}var p=CTe(),sC={},h6={exports:{}},Ja={},d6={exports:{}},f6={};var oX;function RTe(){return oX||(oX=1,(function(t){function e(fe,De){var Ce=fe.length;fe.push(De);e:for(;0<Ce;){var Q=Ce-1>>>1,W=fe[Q];if(0<i(W,De))fe[Q]=De,fe[Ce]=W,Ce=Q;else break e}}function n(fe){return fe.length===0?null:fe[0]}function r(fe){if(fe.length===0)return null;var De=fe[0],Ce=fe.pop();if(Ce!==De){fe[0]=Ce;e:for(var Q=0,W=fe.length,ne=W>>>1;Q<ne;){var ie=2*(Q+1)-1,le=fe[ie],ve=ie+1,qe=fe[ve];if(0>i(le,Ce))ve<W&&0>i(qe,le)?(fe[Q]=qe,fe[ve]=Ce,Q=ve):(fe[Q]=le,fe[ie]=Ce,Q=ie);else if(ve<W&&0>i(qe,Ce))fe[Q]=qe,fe[ve]=Ce,Q=ve;else break e}}return De}function i(fe,De){var Ce=fe.sortIndex-De.sortIndex;return Ce!==0?Ce:fe.id-De.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,h=null,f=3,g=!1,y=!1,_=!1,b=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function I(fe){for(var De=n(c);De!==null;){if(De.callback===null)r(c);else if(De.startTime<=fe)r(c),De.sortIndex=De.expirationTime,e(l,De);else break;De=n(c)}}function P(fe){if(_=!1,I(fe),!y)if(n(l)!==null)y=!0,ze(R);else{var De=n(c);De!==null&&Ne(P,De.startTime-fe)}}function R(fe,De){y=!1,_&&(_=!1,T(M),M=-1),g=!0;var Ce=f;try{for(I(De),h=n(l);h!==null&&(!(h.expirationTime>De)||fe&&!V());){var Q=h.callback;if(typeof Q=="function"){h.callback=null,f=h.priorityLevel;var W=Q(h.expirationTime<=De);De=t.unstable_now(),typeof W=="function"?h.callback=W:h===n(l)&&r(l),I(De)}else r(l);h=n(l)}if(h!==null)var ne=!0;else{var ie=n(c);ie!==null&&Ne(P,ie.startTime-De),ne=!1}return ne}finally{h=null,f=Ce,g=!1}}var D=!1,C=null,M=-1,O=5,j=-1;function V(){return!(t.unstable_now()-j<O)}function U(){if(C!==null){var fe=t.unstable_now();j=fe;var De=!0;try{De=C(!0,fe)}finally{De?G():(D=!1,C=null)}}else D=!1}var G;if(typeof A=="function")G=function(){A(U)};else if(typeof MessageChannel<"u"){var de=new MessageChannel,Ie=de.port2;de.port1.onmessage=U,G=function(){Ie.postMessage(null)}}else G=function(){b(U,0)};function ze(fe){C=fe,D||(D=!0,G())}function Ne(fe,De){M=b(function(){fe(t.unstable_now())},De)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(fe){fe.callback=null},t.unstable_continueExecution=function(){y||g||(y=!0,ze(R))},t.unstable_forceFrameRate=function(fe){0>fe||125<fe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<fe?Math.floor(1e3/fe):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(fe){switch(f){case 1:case 2:case 3:var De=3;break;default:De=f}var Ce=f;f=De;try{return fe()}finally{f=Ce}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(fe,De){switch(fe){case 1:case 2:case 3:case 4:case 5:break;default:fe=3}var Ce=f;f=fe;try{return De()}finally{f=Ce}},t.unstable_scheduleCallback=function(fe,De,Ce){var Q=t.unstable_now();switch(typeof Ce=="object"&&Ce!==null?(Ce=Ce.delay,Ce=typeof Ce=="number"&&0<Ce?Q+Ce:Q):Ce=Q,fe){case 1:var W=-1;break;case 2:W=250;break;case 5:W=1073741823;break;case 4:W=1e4;break;default:W=5e3}return W=Ce+W,fe={id:u++,callback:De,priorityLevel:fe,startTime:Ce,expirationTime:W,sortIndex:-1},Ce>Q?(fe.sortIndex=Ce,e(c,fe),n(l)===null&&fe===n(c)&&(_?(T(M),M=-1):_=!0,Ne(P,Ce-Q))):(fe.sortIndex=W,e(l,fe),y||g||(y=!0,ze(R))),fe},t.unstable_shouldYield=V,t.unstable_wrapCallback=function(fe){var De=f;return function(){var Ce=f;f=De;try{return fe.apply(this,arguments)}finally{f=Ce}}}})(f6)),f6}var aX;function MTe(){return aX||(aX=1,d6.exports=RTe()),d6.exports}var lX;function NTe(){if(lX)return Ja;lX=1;var t=LA(),e=MTe();function n(d){for(var m="https://reactjs.org/docs/error-decoder.html?invariant="+d,w=1;w<arguments.length;w++)m+="&args[]="+encodeURIComponent(arguments[w]);return"Minified React error #"+d+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,i={};function s(d,m){o(d,m),o(d+"Capture",m)}function o(d,m){for(i[d]=m,d=0;d<m.length;d++)r.add(m[d])}var a=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),l=Object.prototype.hasOwnProperty,c=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,u={},h={};function f(d){return l.call(h,d)?!0:l.call(u,d)?!1:c.test(d)?h[d]=!0:(u[d]=!0,!1)}function g(d,m,w,k){if(w!==null&&w.type===0)return!1;switch(typeof m){case"function":case"symbol":return!0;case"boolean":return k?!1:w!==null?!w.acceptsBooleans:(d=d.toLowerCase().slice(0,5),d!=="data-"&&d!=="aria-");default:return!1}}function y(d,m,w,k){if(m===null||typeof m>"u"||g(d,m,w,k))return!0;if(k)return!1;if(w!==null)switch(w.type){case 3:return!m;case 4:return m===!1;case 5:return isNaN(m);case 6:return isNaN(m)||1>m}return!1}function _(d,m,w,k,N,L,K){this.acceptsBooleans=m===2||m===3||m===4,this.attributeName=k,this.attributeNamespace=N,this.mustUseProperty=w,this.propertyName=d,this.type=m,this.sanitizeURL=L,this.removeEmptyString=K}var b={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(d){b[d]=new _(d,0,!1,d,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(d){var m=d[0];b[m]=new _(m,1,!1,d[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(d){b[d]=new _(d,2,!1,d.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(d){b[d]=new _(d,2,!1,d,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(d){b[d]=new _(d,3,!1,d.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(d){b[d]=new _(d,3,!0,d,null,!1,!1)}),["capture","download"].forEach(function(d){b[d]=new _(d,4,!1,d,null,!1,!1)}),["cols","rows","size","span"].forEach(function(d){b[d]=new _(d,6,!1,d,null,!1,!1)}),["rowSpan","start"].forEach(function(d){b[d]=new _(d,5,!1,d.toLowerCase(),null,!1,!1)});var T=/[\-:]([a-z])/g;function A(d){return d[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(d){var m=d.replace(T,A);b[m]=new _(m,1,!1,d,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(d){var m=d.replace(T,A);b[m]=new _(m,1,!1,d,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(d){var m=d.replace(T,A);b[m]=new _(m,1,!1,d,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(d){b[d]=new _(d,1,!1,d.toLowerCase(),null,!1,!1)}),b.xlinkHref=new _("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(d){b[d]=new _(d,1,!1,d.toLowerCase(),null,!0,!0)});function I(d,m,w,k){var N=b.hasOwnProperty(m)?b[m]:null;(N!==null?N.type!==0:k||!(2<m.length)||m[0]!=="o"&&m[0]!=="O"||m[1]!=="n"&&m[1]!=="N")&&(y(m,w,N,k)&&(w=null),k||N===null?f(m)&&(w===null?d.removeAttribute(m):d.setAttribute(m,""+w)):N.mustUseProperty?d[N.propertyName]=w===null?N.type===3?!1:"":w:(m=N.attributeName,k=N.attributeNamespace,w===null?d.removeAttribute(m):(N=N.type,w=N===3||N===4&&w===!0?"":""+w,k?d.setAttributeNS(k,m,w):d.setAttribute(m,w))))}var P=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,R=Symbol.for("react.element"),D=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),M=Symbol.for("react.strict_mode"),O=Symbol.for("react.profiler"),j=Symbol.for("react.provider"),V=Symbol.for("react.context"),U=Symbol.for("react.forward_ref"),G=Symbol.for("react.suspense"),de=Symbol.for("react.suspense_list"),Ie=Symbol.for("react.memo"),ze=Symbol.for("react.lazy"),Ne=Symbol.for("react.offscreen"),fe=Symbol.iterator;function De(d){return d===null||typeof d!="object"?null:(d=fe&&d[fe]||d["@@iterator"],typeof d=="function"?d:null)}var Ce=Object.assign,Q;function W(d){if(Q===void 0)try{throw Error()}catch(w){var m=w.stack.trim().match(/\n( *(at )?)/);Q=m&&m[1]||""}return`
`+Q+d}var ne=!1;function ie(d,m){if(!d||ne)return"";ne=!0;var w=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(m)if(m=function(){throw Error()},Object.defineProperty(m.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(m,[])}catch($e){var k=$e}Reflect.construct(d,[],m)}else{try{m.call()}catch($e){k=$e}d.call(m.prototype)}else{try{throw Error()}catch($e){k=$e}d()}}catch($e){if($e&&k&&typeof $e.stack=="string"){for(var N=$e.stack.split(`
`),L=k.stack.split(`
`),K=N.length-1,ce=L.length-1;1<=K&&0<=ce&&N[K]!==L[ce];)ce--;for(;1<=K&&0<=ce;K--,ce--)if(N[K]!==L[ce]){if(K!==1||ce!==1)do if(K--,ce--,0>ce||N[K]!==L[ce]){var he=`
`+N[K].replace(" at new "," at ");return d.displayName&&he.includes("<anonymous>")&&(he=he.replace("<anonymous>",d.displayName)),he}while(1<=K&&0<=ce);break}}}finally{ne=!1,Error.prepareStackTrace=w}return(d=d?d.displayName||d.name:"")?W(d):""}function le(d){switch(d.tag){case 5:return W(d.type);case 16:return W("Lazy");case 13:return W("Suspense");case 19:return W("SuspenseList");case 0:case 2:case 15:return d=ie(d.type,!1),d;case 11:return d=ie(d.type.render,!1),d;case 1:return d=ie(d.type,!0),d;default:return""}}function ve(d){if(d==null)return null;if(typeof d=="function")return d.displayName||d.name||null;if(typeof d=="string")return d;switch(d){case C:return"Fragment";case D:return"Portal";case O:return"Profiler";case M:return"StrictMode";case G:return"Suspense";case de:return"SuspenseList"}if(typeof d=="object")switch(d.$$typeof){case V:return(d.displayName||"Context")+".Consumer";case j:return(d._context.displayName||"Context")+".Provider";case U:var m=d.render;return d=d.displayName,d||(d=m.displayName||m.name||"",d=d!==""?"ForwardRef("+d+")":"ForwardRef"),d;case Ie:return m=d.displayName||null,m!==null?m:ve(d.type)||"Memo";case ze:m=d._payload,d=d._init;try{return ve(d(m))}catch{}}return null}function qe(d){var m=d.type;switch(d.tag){case 24:return"Cache";case 9:return(m.displayName||"Context")+".Consumer";case 10:return(m._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return d=m.render,d=d.displayName||d.name||"",m.displayName||(d!==""?"ForwardRef("+d+")":"ForwardRef");case 7:return"Fragment";case 5:return m;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ve(m);case 8:return m===M?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof m=="function")return m.displayName||m.name||null;if(typeof m=="string")return m}return null}function Ke(d){switch(typeof d){case"boolean":case"number":case"string":case"undefined":return d;case"object":return d;default:return""}}function Se(d){var m=d.type;return(d=d.nodeName)&&d.toLowerCase()==="input"&&(m==="checkbox"||m==="radio")}function we(d){var m=Se(d)?"checked":"value",w=Object.getOwnPropertyDescriptor(d.constructor.prototype,m),k=""+d[m];if(!d.hasOwnProperty(m)&&typeof w<"u"&&typeof w.get=="function"&&typeof w.set=="function"){var N=w.get,L=w.set;return Object.defineProperty(d,m,{configurable:!0,get:function(){return N.call(this)},set:function(K){k=""+K,L.call(this,K)}}),Object.defineProperty(d,m,{enumerable:w.enumerable}),{getValue:function(){return k},setValue:function(K){k=""+K},stopTracking:function(){d._valueTracker=null,delete d[m]}}}}function Dt(d){d._valueTracker||(d._valueTracker=we(d))}function Ye(d){if(!d)return!1;var m=d._valueTracker;if(!m)return!0;var w=m.getValue(),k="";return d&&(k=Se(d)?d.checked?"true":"false":d.value),d=k,d!==w?(m.setValue(d),!0):!1}function on(d){if(d=d||(typeof document<"u"?document:void 0),typeof d>"u")return null;try{return d.activeElement||d.body}catch{return d.body}}function jt(d,m){var w=m.checked;return Ce({},m,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:w??d._wrapperState.initialChecked})}function pn(d,m){var w=m.defaultValue==null?"":m.defaultValue,k=m.checked!=null?m.checked:m.defaultChecked;w=Ke(m.value!=null?m.value:w),d._wrapperState={initialChecked:k,initialValue:w,controlled:m.type==="checkbox"||m.type==="radio"?m.checked!=null:m.value!=null}}function _n(d,m){m=m.checked,m!=null&&I(d,"checked",m,!1)}function dt(d,m){_n(d,m);var w=Ke(m.value),k=m.type;if(w!=null)k==="number"?(w===0&&d.value===""||d.value!=w)&&(d.value=""+w):d.value!==""+w&&(d.value=""+w);else if(k==="submit"||k==="reset"){d.removeAttribute("value");return}m.hasOwnProperty("value")?zn(d,m.type,w):m.hasOwnProperty("defaultValue")&&zn(d,m.type,Ke(m.defaultValue)),m.checked==null&&m.defaultChecked!=null&&(d.defaultChecked=!!m.defaultChecked)}function hr(d,m,w){if(m.hasOwnProperty("value")||m.hasOwnProperty("defaultValue")){var k=m.type;if(!(k!=="submit"&&k!=="reset"||m.value!==void 0&&m.value!==null))return;m=""+d._wrapperState.initialValue,w||m===d.value||(d.value=m),d.defaultValue=m}w=d.name,w!==""&&(d.name=""),d.defaultChecked=!!d._wrapperState.initialChecked,w!==""&&(d.name=w)}function zn(d,m,w){(m!=="number"||on(d.ownerDocument)!==d)&&(w==null?d.defaultValue=""+d._wrapperState.initialValue:d.defaultValue!==""+w&&(d.defaultValue=""+w))}var Wn=Array.isArray;function ei(d,m,w,k){if(d=d.options,m){m={};for(var N=0;N<w.length;N++)m["$"+w[N]]=!0;for(w=0;w<d.length;w++)N=m.hasOwnProperty("$"+d[w].value),d[w].selected!==N&&(d[w].selected=N),N&&k&&(d[w].defaultSelected=!0)}else{for(w=""+Ke(w),m=null,N=0;N<d.length;N++){if(d[N].value===w){d[N].selected=!0,k&&(d[N].defaultSelected=!0);return}m!==null||d[N].disabled||(m=d[N])}m!==null&&(m.selected=!0)}}function _o(d,m){if(m.dangerouslySetInnerHTML!=null)throw Error(n(91));return Ce({},m,{value:void 0,defaultValue:void 0,children:""+d._wrapperState.initialValue})}function Cr(d,m){var w=m.value;if(w==null){if(w=m.children,m=m.defaultValue,w!=null){if(m!=null)throw Error(n(92));if(Wn(w)){if(1<w.length)throw Error(n(93));w=w[0]}m=w}m==null&&(m=""),w=m}d._wrapperState={initialValue:Ke(w)}}function Ai(d,m){var w=Ke(m.value),k=Ke(m.defaultValue);w!=null&&(w=""+w,w!==d.value&&(d.value=w),m.defaultValue==null&&d.defaultValue!==w&&(d.defaultValue=w)),k!=null&&(d.defaultValue=""+k)}function Ls(d){var m=d.textContent;m===d._wrapperState.initialValue&&m!==""&&m!==null&&(d.value=m)}function bt(d){switch(d){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Qn(d,m){return d==null||d==="http://www.w3.org/1999/xhtml"?bt(m):d==="http://www.w3.org/2000/svg"&&m==="foreignObject"?"http://www.w3.org/1999/xhtml":d}var dr,Ft=(function(d){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(m,w,k,N){MSApp.execUnsafeLocalFunction(function(){return d(m,w,k,N)})}:d})(function(d,m){if(d.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in d)d.innerHTML=m;else{for(dr=dr||document.createElement("div"),dr.innerHTML="<svg>"+m.valueOf().toString()+"</svg>",m=dr.firstChild;d.firstChild;)d.removeChild(d.firstChild);for(;m.firstChild;)d.appendChild(m.firstChild)}});function jn(d,m){if(m){var w=d.firstChild;if(w&&w===d.lastChild&&w.nodeType===3){w.nodeValue=m;return}}d.textContent=m}var en={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},$o=["Webkit","ms","Moz","O"];Object.keys(en).forEach(function(d){$o.forEach(function(m){m=m+d.charAt(0).toUpperCase()+d.substring(1),en[m]=en[d]})});function Gi(d,m,w){return m==null||typeof m=="boolean"||m===""?"":w||typeof m!="number"||m===0||en.hasOwnProperty(d)&&en[d]?(""+m).trim():m+"px"}function Ds(d,m){d=d.style;for(var w in m)if(m.hasOwnProperty(w)){var k=w.indexOf("--")===0,N=Gi(w,m[w],k);w==="float"&&(w="cssFloat"),k?d.setProperty(w,N):d[w]=N}}var Nn=Ce({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ii(d,m){if(m){if(Nn[d]&&(m.children!=null||m.dangerouslySetInnerHTML!=null))throw Error(n(137,d));if(m.dangerouslySetInnerHTML!=null){if(m.children!=null)throw Error(n(60));if(typeof m.dangerouslySetInnerHTML!="object"||!("__html"in m.dangerouslySetInnerHTML))throw Error(n(61))}if(m.style!=null&&typeof m.style!="object")throw Error(n(62))}}function He(d,m){if(d.indexOf("-")===-1)return typeof m.is=="string";switch(d){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ke=null;function Ae(d){return d=d.target||d.srcElement||window,d.correspondingUseElement&&(d=d.correspondingUseElement),d.nodeType===3?d.parentNode:d}var sn=null,z=null,Et=null;function X(d){if(d=Qb(d)){if(typeof sn!="function")throw Error(n(280));var m=d.stateNode;m&&(m=xP(m),sn(d.stateNode,d.type,m))}}function ae(d){z?Et?Et.push(d):Et=[d]:z=d}function Ve(){if(z){var d=z,m=Et;if(Et=z=null,X(d),m)for(d=0;d<m.length;d++)X(m[d])}}function ee(d,m){return d(m)}function ge(){}var je=!1;function Je(d,m,w){if(je)return d(m,w);je=!0;try{return ee(d,m,w)}finally{je=!1,(z!==null||Et!==null)&&(ge(),Ve())}}function Ge(d,m){var w=d.stateNode;if(w===null)return null;var k=xP(w);if(k===null)return null;w=k[m];e:switch(m){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(k=!k.disabled)||(d=d.type,k=!(d==="button"||d==="input"||d==="select"||d==="textarea")),d=!k;break e;default:d=!1}if(d)return null;if(w&&typeof w!="function")throw Error(n(231,m,typeof w));return w}var nt=!1;if(a)try{var et={};Object.defineProperty(et,"passive",{get:function(){nt=!0}}),window.addEventListener("test",et,et),window.removeEventListener("test",et,et)}catch{nt=!1}function Mt(d,m,w,k,N,L,K,ce,he){var $e=Array.prototype.slice.call(arguments,3);try{m.apply(w,$e)}catch(ot){this.onError(ot)}}var zt=!1,yn=null,q=!1,re=null,J={onError:function(d){zt=!0,yn=d}};function te(d,m,w,k,N,L,K,ce,he){zt=!1,yn=null,Mt.apply(J,arguments)}function se(d,m,w,k,N,L,K,ce,he){if(te.apply(this,arguments),zt){if(zt){var $e=yn;zt=!1,yn=null}else throw Error(n(198));q||(q=!0,re=$e)}}function oe(d){var m=d,w=d;if(d.alternate)for(;m.return;)m=m.return;else{d=m;do m=d,(m.flags&4098)!==0&&(w=m.return),d=m.return;while(d)}return m.tag===3?w:null}function Re(d){if(d.tag===13){var m=d.memoizedState;if(m===null&&(d=d.alternate,d!==null&&(m=d.memoizedState)),m!==null)return m.dehydrated}return null}function Be(d){if(oe(d)!==d)throw Error(n(188))}function Pe(d){var m=d.alternate;if(!m){if(m=oe(d),m===null)throw Error(n(188));return m!==d?null:d}for(var w=d,k=m;;){var N=w.return;if(N===null)break;var L=N.alternate;if(L===null){if(k=N.return,k!==null){w=k;continue}break}if(N.child===L.child){for(L=N.child;L;){if(L===w)return Be(N),d;if(L===k)return Be(N),m;L=L.sibling}throw Error(n(188))}if(w.return!==k.return)w=N,k=L;else{for(var K=!1,ce=N.child;ce;){if(ce===w){K=!0,w=N,k=L;break}if(ce===k){K=!0,k=N,w=L;break}ce=ce.sibling}if(!K){for(ce=L.child;ce;){if(ce===w){K=!0,w=L,k=N;break}if(ce===k){K=!0,k=L,w=N;break}ce=ce.sibling}if(!K)throw Error(n(189))}}if(w.alternate!==k)throw Error(n(190))}if(w.tag!==3)throw Error(n(188));return w.stateNode.current===w?d:m}function Oe(d){return d=Pe(d),d!==null?Le(d):null}function Le(d){if(d.tag===5||d.tag===6)return d;for(d=d.child;d!==null;){var m=Le(d);if(m!==null)return m;d=d.sibling}return null}var lt=e.unstable_scheduleCallback,gt=e.unstable_cancelCallback,Ct=e.unstable_shouldYield,ct=e.unstable_requestPaint,ut=e.unstable_now,En=e.unstable_getCurrentPriorityLevel,Rr=e.unstable_ImmediatePriority,jr=e.unstable_UserBlockingPriority,vi=e.unstable_NormalPriority,Eu=e.unstable_LowPriority,Tc=e.unstable_IdlePriority,Dl=null,ss=null;function Rp(d){if(ss&&typeof ss.onCommitFiberRoot=="function")try{ss.onCommitFiberRoot(Dl,d,void 0,(d.current.flags&128)===128)}catch{}}var Pi=Math.clz32?Math.clz32:f0,Ih=Math.log,kc=Math.LN2;function f0(d){return d>>>=0,d===0?32:31-(Ih(d)/kc|0)|0}var Ph=64,Mp=4194304;function br(d){switch(d&-d){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return d&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return d}}function Hd(d,m){var w=d.pendingLanes;if(w===0)return 0;var k=0,N=d.suspendedLanes,L=d.pingedLanes,K=w&268435455;if(K!==0){var ce=K&~N;ce!==0?k=br(ce):(L&=K,L!==0&&(k=br(L)))}else K=w&~N,K!==0?k=br(K):L!==0&&(k=br(L));if(k===0)return 0;if(m!==0&&m!==k&&(m&N)===0&&(N=k&-k,L=m&-m,N>=L||N===16&&(L&4194240)!==0))return m;if((k&4)!==0&&(k|=w&16),m=d.entangledLanes,m!==0)for(d=d.entanglements,m&=k;0<m;)w=31-Pi(m),N=1<<w,k|=d[w],m&=~N;return k}function p0(d,m){switch(d){case 1:case 2:case 4:return m+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return m+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function m0(d,m){for(var w=d.suspendedLanes,k=d.pingedLanes,N=d.expirationTimes,L=d.pendingLanes;0<L;){var K=31-Pi(L),ce=1<<K,he=N[K];he===-1?((ce&w)===0||(ce&k)!==0)&&(N[K]=p0(ce,m)):he<=m&&(d.expiredLanes|=ce),L&=~ce}}function Mb(d){return d=d.pendingLanes&-1073741825,d!==0?d:d&1073741824?1073741824:0}function Nb(){var d=Ph;return Ph<<=1,(Ph&4194240)===0&&(Ph=64),d}function Ob(d){for(var m=[],w=0;31>w;w++)m.push(d);return m}function g0(d,m,w){d.pendingLanes|=m,m!==536870912&&(d.suspendedLanes=0,d.pingedLanes=0),d=d.eventTimes,m=31-Pi(m),d[m]=w}function VL(d,m){var w=d.pendingLanes&~m;d.pendingLanes=m,d.suspendedLanes=0,d.pingedLanes=0,d.expiredLanes&=m,d.mutableReadLanes&=m,d.entangledLanes&=m,m=d.entanglements;var k=d.eventTimes;for(d=d.expirationTimes;0<w;){var N=31-Pi(w),L=1<<N;m[N]=0,k[N]=-1,d[N]=-1,w&=~L}}function Lb(d,m){var w=d.entangledLanes|=m;for(d=d.entanglements;w;){var k=31-Pi(w),N=1<<k;N&m|d[k]&m&&(d[k]|=m),w&=~N}}var sr=0;function Ch(d){return d&=-d,1<d?4<d?(d&268435455)!==0?16:536870912:4:1}var Db,kv,jb,$b,Fb,Rh=!1,Av=[],Mh=null,Nh=null,xo=null,y0=new Map,qd=new Map,jl=[],iP="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Np(d,m){switch(d){case"focusin":case"focusout":Mh=null;break;case"dragenter":case"dragleave":Nh=null;break;case"mouseover":case"mouseout":xo=null;break;case"pointerover":case"pointerout":y0.delete(m.pointerId);break;case"gotpointercapture":case"lostpointercapture":qd.delete(m.pointerId)}}function Su(d,m,w,k,N,L){return d===null||d.nativeEvent!==L?(d={blockedOn:m,domEventName:w,eventSystemFlags:k,nativeEvent:L,targetContainers:[N]},m!==null&&(m=Qb(m),m!==null&&kv(m)),d):(d.eventSystemFlags|=k,m=d.targetContainers,N!==null&&m.indexOf(N)===-1&&m.push(N),d)}function sP(d,m,w,k,N){switch(m){case"focusin":return Mh=Su(Mh,d,m,w,k,N),!0;case"dragenter":return Nh=Su(Nh,d,m,w,k,N),!0;case"mouseover":return xo=Su(xo,d,m,w,k,N),!0;case"pointerover":var L=N.pointerId;return y0.set(L,Su(y0.get(L)||null,d,m,w,k,N)),!0;case"gotpointercapture":return L=N.pointerId,qd.set(L,Su(qd.get(L)||null,d,m,w,k,N)),!0}return!1}function Iv(d){var m=w0(d.target);if(m!==null){var w=oe(m);if(w!==null){if(m=w.tag,m===13){if(m=Re(w),m!==null){d.blockedOn=m,Fb(d.priority,function(){jb(w)});return}}else if(m===3&&w.stateNode.current.memoizedState.isDehydrated){d.blockedOn=w.tag===3?w.stateNode.containerInfo:null;return}}}d.blockedOn=null}function ti(d){if(d.blockedOn!==null)return!1;for(var m=d.targetContainers;0<m.length;){var w=Pv(d.domEventName,d.eventSystemFlags,m[0],d.nativeEvent);if(w===null){w=d.nativeEvent;var k=new w.constructor(w.type,w);ke=k,w.target.dispatchEvent(k),ke=null}else return m=Qb(w),m!==null&&kv(m),d.blockedOn=w,!1;m.shift()}return!0}function oP(d,m,w){ti(d)&&w.delete(m)}function zL(){Rh=!1,Mh!==null&&ti(Mh)&&(Mh=null),Nh!==null&&ti(Nh)&&(Nh=null),xo!==null&&ti(xo)&&(xo=null),y0.forEach(oP),qd.forEach(oP)}function Op(d,m){d.blockedOn===m&&(d.blockedOn=null,Rh||(Rh=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,zL)))}function Lp(d){function m(N){return Op(N,d)}if(0<Av.length){Op(Av[0],d);for(var w=1;w<Av.length;w++){var k=Av[w];k.blockedOn===d&&(k.blockedOn=null)}}for(Mh!==null&&Op(Mh,d),Nh!==null&&Op(Nh,d),xo!==null&&Op(xo,d),y0.forEach(m),qd.forEach(m),w=0;w<jl.length;w++)k=jl[w],k.blockedOn===d&&(k.blockedOn=null);for(;0<jl.length&&(w=jl[0],w.blockedOn===null);)Iv(w),w.blockedOn===null&&jl.shift()}var Kd=P.ReactCurrentBatchConfig,Yd=!0;function Oh(d,m,w,k){var N=sr,L=Kd.transition;Kd.transition=null;try{sr=1,Vb(d,m,w,k)}finally{sr=N,Kd.transition=L}}function aP(d,m,w,k){var N=sr,L=Kd.transition;Kd.transition=null;try{sr=4,Vb(d,m,w,k)}finally{sr=N,Kd.transition=L}}function Vb(d,m,w,k){if(Yd){var N=Pv(d,m,w,k);if(N===null)JL(d,m,k,Lh,w),Np(d,k);else if(sP(N,d,m,w,k))k.stopPropagation();else if(Np(d,k),m&4&&-1<iP.indexOf(d)){for(;N!==null;){var L=Qb(N);if(L!==null&&Db(L),L=Pv(d,m,w,k),L===null&&JL(d,m,k,Lh,w),L===N)break;N=L}N!==null&&k.stopPropagation()}else JL(d,m,k,null,w)}}var Lh=null;function Pv(d,m,w,k){if(Lh=null,d=Ae(k),d=w0(d),d!==null)if(m=oe(d),m===null)d=null;else if(w=m.tag,w===13){if(d=Re(m),d!==null)return d;d=null}else if(w===3){if(m.stateNode.current.memoizedState.isDehydrated)return m.tag===3?m.stateNode.containerInfo:null;d=null}else m!==d&&(d=null);return Lh=d,null}function Cv(d){switch(d){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(En()){case Rr:return 1;case jr:return 4;case vi:case Eu:return 16;case Tc:return 536870912;default:return 16}default:return 16}}var $l=null,Rv=null,Xd=null;function lP(){if(Xd)return Xd;var d,m=Rv,w=m.length,k,N="value"in $l?$l.value:$l.textContent,L=N.length;for(d=0;d<w&&m[d]===N[d];d++);var K=w-d;for(k=1;k<=K&&m[w-k]===N[L-k];k++);return Xd=N.slice(d,1<k?1-k:void 0)}function v0(d){var m=d.keyCode;return"charCode"in d?(d=d.charCode,d===0&&m===13&&(d=13)):d=m,d===10&&(d=13),32<=d||d===13?d:0}function Dh(){return!0}function zb(){return!1}function Fo(d){function m(w,k,N,L,K){this._reactName=w,this._targetInst=N,this.type=k,this.nativeEvent=L,this.target=K,this.currentTarget=null;for(var ce in d)d.hasOwnProperty(ce)&&(w=d[ce],this[ce]=w?w(L):L[ce]);return this.isDefaultPrevented=(L.defaultPrevented!=null?L.defaultPrevented:L.returnValue===!1)?Dh:zb,this.isPropagationStopped=zb,this}return Ce(m.prototype,{preventDefault:function(){this.defaultPrevented=!0;var w=this.nativeEvent;w&&(w.preventDefault?w.preventDefault():typeof w.returnValue!="unknown"&&(w.returnValue=!1),this.isDefaultPrevented=Dh)},stopPropagation:function(){var w=this.nativeEvent;w&&(w.stopPropagation?w.stopPropagation():typeof w.cancelBubble!="unknown"&&(w.cancelBubble=!0),this.isPropagationStopped=Dh)},persist:function(){},isPersistent:Dh}),m}var jh={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(d){return d.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},_0=Fo(jh),Dp=Ce({},jh,{view:0,detail:0}),Mv=Fo(Dp),Nv,Ov,Fl,x0=Ce({},Dp,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:On,button:0,buttons:0,relatedTarget:function(d){return d.relatedTarget===void 0?d.fromElement===d.srcElement?d.toElement:d.fromElement:d.relatedTarget},movementX:function(d){return"movementX"in d?d.movementX:(d!==Fl&&(Fl&&d.type==="mousemove"?(Nv=d.screenX-Fl.screenX,Ov=d.screenY-Fl.screenY):Ov=Nv=0,Fl=d),Nv)},movementY:function(d){return"movementY"in d?d.movementY:Ov}}),Gb=Fo(x0),cP=Ce({},x0,{dataTransfer:0}),uP=Fo(cP),Lv=Ce({},Dp,{relatedTarget:0}),wo=Fo(Lv),hP=Ce({},jh,{animationName:0,elapsedTime:0,pseudoElement:0}),dP=Fo(hP),jp=Ce({},jh,{clipboardData:function(d){return"clipboardData"in d?d.clipboardData:window.clipboardData}}),S=Fo(jp),F=Ce({},jh,{data:0}),B=Fo(F),Z={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ee={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Fe={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function xt(d){var m=this.nativeEvent;return m.getModifierState?m.getModifierState(d):(d=Fe[d])?!!m[d]:!1}function On(){return xt}var os=Ce({},Dp,{key:function(d){if(d.key){var m=Z[d.key]||d.key;if(m!=="Unidentified")return m}return d.type==="keypress"?(d=v0(d),d===13?"Enter":String.fromCharCode(d)):d.type==="keydown"||d.type==="keyup"?Ee[d.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:On,charCode:function(d){return d.type==="keypress"?v0(d):0},keyCode:function(d){return d.type==="keydown"||d.type==="keyup"?d.keyCode:0},which:function(d){return d.type==="keypress"?v0(d):d.type==="keydown"||d.type==="keyup"?d.keyCode:0}}),$r=Fo(os),gs=Ce({},x0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Vl=Fo(gs),Zd=Ce({},Dp,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:On}),$h=Fo(Zd),Fh=Ce({},jh,{propertyName:0,elapsedTime:0,pseudoElement:0}),Dv=Fo(Fh),Ub=Ce({},x0,{deltaX:function(d){return"deltaX"in d?d.deltaX:"wheelDeltaX"in d?-d.wheelDeltaX:0},deltaY:function(d){return"deltaY"in d?d.deltaY:"wheelDeltaY"in d?-d.wheelDeltaY:"wheelDelta"in d?-d.wheelDelta:0},deltaZ:0,deltaMode:0}),xSe=Fo(Ub),wSe=[9,13,27,32],GL=a&&"CompositionEvent"in window,Bb=null;a&&"documentMode"in document&&(Bb=document.documentMode);var bSe=a&&"TextEvent"in window&&!Bb,Hq=a&&(!GL||Bb&&8<Bb&&11>=Bb),qq=" ",Kq=!1;function Yq(d,m){switch(d){case"keyup":return wSe.indexOf(m.keyCode)!==-1;case"keydown":return m.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Xq(d){return d=d.detail,typeof d=="object"&&"data"in d?d.data:null}var jv=!1;function ESe(d,m){switch(d){case"compositionend":return Xq(m);case"keypress":return m.which!==32?null:(Kq=!0,qq);case"textInput":return d=m.data,d===qq&&Kq?null:d;default:return null}}function SSe(d,m){if(jv)return d==="compositionend"||!GL&&Yq(d,m)?(d=lP(),Xd=Rv=$l=null,jv=!1,d):null;switch(d){case"paste":return null;case"keypress":if(!(m.ctrlKey||m.altKey||m.metaKey)||m.ctrlKey&&m.altKey){if(m.char&&1<m.char.length)return m.char;if(m.which)return String.fromCharCode(m.which)}return null;case"compositionend":return Hq&&m.locale!=="ko"?null:m.data;default:return null}}var TSe={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Zq(d){var m=d&&d.nodeName&&d.nodeName.toLowerCase();return m==="input"?!!TSe[d.type]:m==="textarea"}function Jq(d,m,w,k){ae(k),m=yP(m,"onChange"),0<m.length&&(w=new _0("onChange","change",null,w,k),d.push({event:w,listeners:m}))}var Wb=null,Hb=null;function kSe(d){gK(d,0)}function fP(d){var m=Gv(d);if(Ye(m))return d}function ASe(d,m){if(d==="change")return m}var Qq=!1;if(a){var UL;if(a){var BL="oninput"in document;if(!BL){var eK=document.createElement("div");eK.setAttribute("oninput","return;"),BL=typeof eK.oninput=="function"}UL=BL}else UL=!1;Qq=UL&&(!document.documentMode||9<document.documentMode)}function tK(){Wb&&(Wb.detachEvent("onpropertychange",nK),Hb=Wb=null)}function nK(d){if(d.propertyName==="value"&&fP(Hb)){var m=[];Jq(m,Hb,d,Ae(d)),Je(kSe,m)}}function ISe(d,m,w){d==="focusin"?(tK(),Wb=m,Hb=w,Wb.attachEvent("onpropertychange",nK)):d==="focusout"&&tK()}function PSe(d){if(d==="selectionchange"||d==="keyup"||d==="keydown")return fP(Hb)}function CSe(d,m){if(d==="click")return fP(m)}function RSe(d,m){if(d==="input"||d==="change")return fP(m)}function MSe(d,m){return d===m&&(d!==0||1/d===1/m)||d!==d&&m!==m}var Tu=typeof Object.is=="function"?Object.is:MSe;function qb(d,m){if(Tu(d,m))return!0;if(typeof d!="object"||d===null||typeof m!="object"||m===null)return!1;var w=Object.keys(d),k=Object.keys(m);if(w.length!==k.length)return!1;for(k=0;k<w.length;k++){var N=w[k];if(!l.call(m,N)||!Tu(d[N],m[N]))return!1}return!0}function rK(d){for(;d&&d.firstChild;)d=d.firstChild;return d}function iK(d,m){var w=rK(d);d=0;for(var k;w;){if(w.nodeType===3){if(k=d+w.textContent.length,d<=m&&k>=m)return{node:w,offset:m-d};d=k}e:{for(;w;){if(w.nextSibling){w=w.nextSibling;break e}w=w.parentNode}w=void 0}w=rK(w)}}function sK(d,m){return d&&m?d===m?!0:d&&d.nodeType===3?!1:m&&m.nodeType===3?sK(d,m.parentNode):"contains"in d?d.contains(m):d.compareDocumentPosition?!!(d.compareDocumentPosition(m)&16):!1:!1}function oK(){for(var d=window,m=on();m instanceof d.HTMLIFrameElement;){try{var w=typeof m.contentWindow.location.href=="string"}catch{w=!1}if(w)d=m.contentWindow;else break;m=on(d.document)}return m}function WL(d){var m=d&&d.nodeName&&d.nodeName.toLowerCase();return m&&(m==="input"&&(d.type==="text"||d.type==="search"||d.type==="tel"||d.type==="url"||d.type==="password")||m==="textarea"||d.contentEditable==="true")}function NSe(d){var m=oK(),w=d.focusedElem,k=d.selectionRange;if(m!==w&&w&&w.ownerDocument&&sK(w.ownerDocument.documentElement,w)){if(k!==null&&WL(w)){if(m=k.start,d=k.end,d===void 0&&(d=m),"selectionStart"in w)w.selectionStart=m,w.selectionEnd=Math.min(d,w.value.length);else if(d=(m=w.ownerDocument||document)&&m.defaultView||window,d.getSelection){d=d.getSelection();var N=w.textContent.length,L=Math.min(k.start,N);k=k.end===void 0?L:Math.min(k.end,N),!d.extend&&L>k&&(N=k,k=L,L=N),N=iK(w,L);var K=iK(w,k);N&&K&&(d.rangeCount!==1||d.anchorNode!==N.node||d.anchorOffset!==N.offset||d.focusNode!==K.node||d.focusOffset!==K.offset)&&(m=m.createRange(),m.setStart(N.node,N.offset),d.removeAllRanges(),L>k?(d.addRange(m),d.extend(K.node,K.offset)):(m.setEnd(K.node,K.offset),d.addRange(m)))}}for(m=[],d=w;d=d.parentNode;)d.nodeType===1&&m.push({element:d,left:d.scrollLeft,top:d.scrollTop});for(typeof w.focus=="function"&&w.focus(),w=0;w<m.length;w++)d=m[w],d.element.scrollLeft=d.left,d.element.scrollTop=d.top}}var OSe=a&&"documentMode"in document&&11>=document.documentMode,$v=null,HL=null,Kb=null,qL=!1;function aK(d,m,w){var k=w.window===w?w.document:w.nodeType===9?w:w.ownerDocument;qL||$v==null||$v!==on(k)||(k=$v,"selectionStart"in k&&WL(k)?k={start:k.selectionStart,end:k.selectionEnd}:(k=(k.ownerDocument&&k.ownerDocument.defaultView||window).getSelection(),k={anchorNode:k.anchorNode,anchorOffset:k.anchorOffset,focusNode:k.focusNode,focusOffset:k.focusOffset}),Kb&&qb(Kb,k)||(Kb=k,k=yP(HL,"onSelect"),0<k.length&&(m=new _0("onSelect","select",null,m,w),d.push({event:m,listeners:k}),m.target=$v)))}function pP(d,m){var w={};return w[d.toLowerCase()]=m.toLowerCase(),w["Webkit"+d]="webkit"+m,w["Moz"+d]="moz"+m,w}var Fv={animationend:pP("Animation","AnimationEnd"),animationiteration:pP("Animation","AnimationIteration"),animationstart:pP("Animation","AnimationStart"),transitionend:pP("Transition","TransitionEnd")},KL={},lK={};a&&(lK=document.createElement("div").style,"AnimationEvent"in window||(delete Fv.animationend.animation,delete Fv.animationiteration.animation,delete Fv.animationstart.animation),"TransitionEvent"in window||delete Fv.transitionend.transition);function mP(d){if(KL[d])return KL[d];if(!Fv[d])return d;var m=Fv[d],w;for(w in m)if(m.hasOwnProperty(w)&&w in lK)return KL[d]=m[w];return d}var cK=mP("animationend"),uK=mP("animationiteration"),hK=mP("animationstart"),dK=mP("transitionend"),fK=new Map,pK="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function $p(d,m){fK.set(d,m),s(m,[d])}for(var YL=0;YL<pK.length;YL++){var XL=pK[YL],LSe=XL.toLowerCase(),DSe=XL[0].toUpperCase()+XL.slice(1);$p(LSe,"on"+DSe)}$p(cK,"onAnimationEnd"),$p(uK,"onAnimationIteration"),$p(hK,"onAnimationStart"),$p("dblclick","onDoubleClick"),$p("focusin","onFocus"),$p("focusout","onBlur"),$p(dK,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Yb="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),jSe=new Set("cancel close invalid load scroll toggle".split(" ").concat(Yb));function mK(d,m,w){var k=d.type||"unknown-event";d.currentTarget=w,se(k,m,void 0,d),d.currentTarget=null}function gK(d,m){m=(m&4)!==0;for(var w=0;w<d.length;w++){var k=d[w],N=k.event;k=k.listeners;e:{var L=void 0;if(m)for(var K=k.length-1;0<=K;K--){var ce=k[K],he=ce.instance,$e=ce.currentTarget;if(ce=ce.listener,he!==L&&N.isPropagationStopped())break e;mK(N,ce,$e),L=he}else for(K=0;K<k.length;K++){if(ce=k[K],he=ce.instance,$e=ce.currentTarget,ce=ce.listener,he!==L&&N.isPropagationStopped())break e;mK(N,ce,$e),L=he}}}if(q)throw d=re,q=!1,re=null,d}function li(d,m){var w=m[iD];w===void 0&&(w=m[iD]=new Set);var k=d+"__bubble";w.has(k)||(yK(m,d,2,!1),w.add(k))}function ZL(d,m,w){var k=0;m&&(k|=4),yK(w,d,k,m)}var gP="_reactListening"+Math.random().toString(36).slice(2);function Xb(d){if(!d[gP]){d[gP]=!0,r.forEach(function(w){w!=="selectionchange"&&(jSe.has(w)||ZL(w,!1,d),ZL(w,!0,d))});var m=d.nodeType===9?d:d.ownerDocument;m===null||m[gP]||(m[gP]=!0,ZL("selectionchange",!1,m))}}function yK(d,m,w,k){switch(Cv(m)){case 1:var N=Oh;break;case 4:N=aP;break;default:N=Vb}w=N.bind(null,m,w,d),N=void 0,!nt||m!=="touchstart"&&m!=="touchmove"&&m!=="wheel"||(N=!0),k?N!==void 0?d.addEventListener(m,w,{capture:!0,passive:N}):d.addEventListener(m,w,!0):N!==void 0?d.addEventListener(m,w,{passive:N}):d.addEventListener(m,w,!1)}function JL(d,m,w,k,N){var L=k;if((m&1)===0&&(m&2)===0&&k!==null)e:for(;;){if(k===null)return;var K=k.tag;if(K===3||K===4){var ce=k.stateNode.containerInfo;if(ce===N||ce.nodeType===8&&ce.parentNode===N)break;if(K===4)for(K=k.return;K!==null;){var he=K.tag;if((he===3||he===4)&&(he=K.stateNode.containerInfo,he===N||he.nodeType===8&&he.parentNode===N))return;K=K.return}for(;ce!==null;){if(K=w0(ce),K===null)return;if(he=K.tag,he===5||he===6){k=L=K;continue e}ce=ce.parentNode}}k=k.return}Je(function(){var $e=L,ot=Ae(w),ht=[];e:{var rt=fK.get(d);if(rt!==void 0){var Nt=_0,Gt=d;switch(d){case"keypress":if(v0(w)===0)break e;case"keydown":case"keyup":Nt=$r;break;case"focusin":Gt="focus",Nt=wo;break;case"focusout":Gt="blur",Nt=wo;break;case"beforeblur":case"afterblur":Nt=wo;break;case"click":if(w.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Nt=Gb;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Nt=uP;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Nt=$h;break;case cK:case uK:case hK:Nt=dP;break;case dK:Nt=Dv;break;case"scroll":Nt=Mv;break;case"wheel":Nt=xSe;break;case"copy":case"cut":case"paste":Nt=S;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Nt=Vl}var Yt=(m&4)!==0,as=!Yt&&d==="scroll",be=Yt?rt!==null?rt+"Capture":null:rt;Yt=[];for(var me=$e,Me;me!==null;){Me=me;var mt=Me.stateNode;if(Me.tag===5&&mt!==null&&(Me=mt,be!==null&&(mt=Ge(me,be),mt!=null&&Yt.push(Zb(me,mt,Me)))),as)break;me=me.return}0<Yt.length&&(rt=new Nt(rt,Gt,null,w,ot),ht.push({event:rt,listeners:Yt}))}}if((m&7)===0){e:{if(rt=d==="mouseover"||d==="pointerover",Nt=d==="mouseout"||d==="pointerout",rt&&w!==ke&&(Gt=w.relatedTarget||w.fromElement)&&(w0(Gt)||Gt[Jd]))break e;if((Nt||rt)&&(rt=ot.window===ot?ot:(rt=ot.ownerDocument)?rt.defaultView||rt.parentWindow:window,Nt?(Gt=w.relatedTarget||w.toElement,Nt=$e,Gt=Gt?w0(Gt):null,Gt!==null&&(as=oe(Gt),Gt!==as||Gt.tag!==5&&Gt.tag!==6)&&(Gt=null)):(Nt=null,Gt=$e),Nt!==Gt)){if(Yt=Gb,mt="onMouseLeave",be="onMouseEnter",me="mouse",(d==="pointerout"||d==="pointerover")&&(Yt=Vl,mt="onPointerLeave",be="onPointerEnter",me="pointer"),as=Nt==null?rt:Gv(Nt),Me=Gt==null?rt:Gv(Gt),rt=new Yt(mt,me+"leave",Nt,w,ot),rt.target=as,rt.relatedTarget=Me,mt=null,w0(ot)===$e&&(Yt=new Yt(be,me+"enter",Gt,w,ot),Yt.target=Me,Yt.relatedTarget=as,mt=Yt),as=mt,Nt&&Gt)t:{for(Yt=Nt,be=Gt,me=0,Me=Yt;Me;Me=Vv(Me))me++;for(Me=0,mt=be;mt;mt=Vv(mt))Me++;for(;0<me-Me;)Yt=Vv(Yt),me--;for(;0<Me-me;)be=Vv(be),Me--;for(;me--;){if(Yt===be||be!==null&&Yt===be.alternate)break t;Yt=Vv(Yt),be=Vv(be)}Yt=null}else Yt=null;Nt!==null&&vK(ht,rt,Nt,Yt,!1),Gt!==null&&as!==null&&vK(ht,as,Gt,Yt,!0)}}e:{if(rt=$e?Gv($e):window,Nt=rt.nodeName&&rt.nodeName.toLowerCase(),Nt==="select"||Nt==="input"&&rt.type==="file")var Zt=ASe;else if(Zq(rt))if(Qq)Zt=RSe;else{Zt=PSe;var un=ISe}else(Nt=rt.nodeName)&&Nt.toLowerCase()==="input"&&(rt.type==="checkbox"||rt.type==="radio")&&(Zt=CSe);if(Zt&&(Zt=Zt(d,$e))){Jq(ht,Zt,w,ot);break e}un&&un(d,rt,$e),d==="focusout"&&(un=rt._wrapperState)&&un.controlled&&rt.type==="number"&&zn(rt,"number",rt.value)}switch(un=$e?Gv($e):window,d){case"focusin":(Zq(un)||un.contentEditable==="true")&&($v=un,HL=$e,Kb=null);break;case"focusout":Kb=HL=$v=null;break;case"mousedown":qL=!0;break;case"contextmenu":case"mouseup":case"dragend":qL=!1,aK(ht,w,ot);break;case"selectionchange":if(OSe)break;case"keydown":case"keyup":aK(ht,w,ot)}var hn;if(GL)e:{switch(d){case"compositionstart":var Sn="onCompositionStart";break e;case"compositionend":Sn="onCompositionEnd";break e;case"compositionupdate":Sn="onCompositionUpdate";break e}Sn=void 0}else jv?Yq(d,w)&&(Sn="onCompositionEnd"):d==="keydown"&&w.keyCode===229&&(Sn="onCompositionStart");Sn&&(Hq&&w.locale!=="ko"&&(jv||Sn!=="onCompositionStart"?Sn==="onCompositionEnd"&&jv&&(hn=lP()):($l=ot,Rv="value"in $l?$l.value:$l.textContent,jv=!0)),un=yP($e,Sn),0<un.length&&(Sn=new B(Sn,d,null,w,ot),ht.push({event:Sn,listeners:un}),hn?Sn.data=hn:(hn=Xq(w),hn!==null&&(Sn.data=hn)))),(hn=bSe?ESe(d,w):SSe(d,w))&&($e=yP($e,"onBeforeInput"),0<$e.length&&(ot=new B("onBeforeInput","beforeinput",null,w,ot),ht.push({event:ot,listeners:$e}),ot.data=hn))}gK(ht,m)})}function Zb(d,m,w){return{instance:d,listener:m,currentTarget:w}}function yP(d,m){for(var w=m+"Capture",k=[];d!==null;){var N=d,L=N.stateNode;N.tag===5&&L!==null&&(N=L,L=Ge(d,w),L!=null&&k.unshift(Zb(d,L,N)),L=Ge(d,m),L!=null&&k.push(Zb(d,L,N))),d=d.return}return k}function Vv(d){if(d===null)return null;do d=d.return;while(d&&d.tag!==5);return d||null}function vK(d,m,w,k,N){for(var L=m._reactName,K=[];w!==null&&w!==k;){var ce=w,he=ce.alternate,$e=ce.stateNode;if(he!==null&&he===k)break;ce.tag===5&&$e!==null&&(ce=$e,N?(he=Ge(w,L),he!=null&&K.unshift(Zb(w,he,ce))):N||(he=Ge(w,L),he!=null&&K.push(Zb(w,he,ce)))),w=w.return}K.length!==0&&d.push({event:m,listeners:K})}var $Se=/\r\n?/g,FSe=/\u0000|\uFFFD/g;function _K(d){return(typeof d=="string"?d:""+d).replace($Se,`
`).replace(FSe,"")}function vP(d,m,w){if(m=_K(m),_K(d)!==m&&w)throw Error(n(425))}function _P(){}var QL=null,eD=null;function tD(d,m){return d==="textarea"||d==="noscript"||typeof m.children=="string"||typeof m.children=="number"||typeof m.dangerouslySetInnerHTML=="object"&&m.dangerouslySetInnerHTML!==null&&m.dangerouslySetInnerHTML.__html!=null}var nD=typeof setTimeout=="function"?setTimeout:void 0,VSe=typeof clearTimeout=="function"?clearTimeout:void 0,xK=typeof Promise=="function"?Promise:void 0,zSe=typeof queueMicrotask=="function"?queueMicrotask:typeof xK<"u"?function(d){return xK.resolve(null).then(d).catch(GSe)}:nD;function GSe(d){setTimeout(function(){throw d})}function rD(d,m){var w=m,k=0;do{var N=w.nextSibling;if(d.removeChild(w),N&&N.nodeType===8)if(w=N.data,w==="/$"){if(k===0){d.removeChild(N),Lp(m);return}k--}else w!=="$"&&w!=="$?"&&w!=="$!"||k++;w=N}while(w);Lp(m)}function Fp(d){for(;d!=null;d=d.nextSibling){var m=d.nodeType;if(m===1||m===3)break;if(m===8){if(m=d.data,m==="$"||m==="$!"||m==="$?")break;if(m==="/$")return null}}return d}function wK(d){d=d.previousSibling;for(var m=0;d;){if(d.nodeType===8){var w=d.data;if(w==="$"||w==="$!"||w==="$?"){if(m===0)return d;m--}else w==="/$"&&m++}d=d.previousSibling}return null}var zv=Math.random().toString(36).slice(2),Vh="__reactFiber$"+zv,Jb="__reactProps$"+zv,Jd="__reactContainer$"+zv,iD="__reactEvents$"+zv,USe="__reactListeners$"+zv,BSe="__reactHandles$"+zv;function w0(d){var m=d[Vh];if(m)return m;for(var w=d.parentNode;w;){if(m=w[Jd]||w[Vh]){if(w=m.alternate,m.child!==null||w!==null&&w.child!==null)for(d=wK(d);d!==null;){if(w=d[Vh])return w;d=wK(d)}return m}d=w,w=d.parentNode}return null}function Qb(d){return d=d[Vh]||d[Jd],!d||d.tag!==5&&d.tag!==6&&d.tag!==13&&d.tag!==3?null:d}function Gv(d){if(d.tag===5||d.tag===6)return d.stateNode;throw Error(n(33))}function xP(d){return d[Jb]||null}var sD=[],Uv=-1;function Vp(d){return{current:d}}function ci(d){0>Uv||(d.current=sD[Uv],sD[Uv]=null,Uv--)}function oi(d,m){Uv++,sD[Uv]=d.current,d.current=m}var zp={},Vo=Vp(zp),qa=Vp(!1),b0=zp;function Bv(d,m){var w=d.type.contextTypes;if(!w)return zp;var k=d.stateNode;if(k&&k.__reactInternalMemoizedUnmaskedChildContext===m)return k.__reactInternalMemoizedMaskedChildContext;var N={},L;for(L in w)N[L]=m[L];return k&&(d=d.stateNode,d.__reactInternalMemoizedUnmaskedChildContext=m,d.__reactInternalMemoizedMaskedChildContext=N),N}function Ka(d){return d=d.childContextTypes,d!=null}function wP(){ci(qa),ci(Vo)}function bK(d,m,w){if(Vo.current!==zp)throw Error(n(168));oi(Vo,m),oi(qa,w)}function EK(d,m,w){var k=d.stateNode;if(m=m.childContextTypes,typeof k.getChildContext!="function")return w;k=k.getChildContext();for(var N in k)if(!(N in m))throw Error(n(108,qe(d)||"Unknown",N));return Ce({},w,k)}function bP(d){return d=(d=d.stateNode)&&d.__reactInternalMemoizedMergedChildContext||zp,b0=Vo.current,oi(Vo,d),oi(qa,qa.current),!0}function SK(d,m,w){var k=d.stateNode;if(!k)throw Error(n(169));w?(d=EK(d,m,b0),k.__reactInternalMemoizedMergedChildContext=d,ci(qa),ci(Vo),oi(Vo,d)):ci(qa),oi(qa,w)}var Qd=null,EP=!1,oD=!1;function TK(d){Qd===null?Qd=[d]:Qd.push(d)}function WSe(d){EP=!0,TK(d)}function Gp(){if(!oD&&Qd!==null){oD=!0;var d=0,m=sr;try{var w=Qd;for(sr=1;d<w.length;d++){var k=w[d];do k=k(!0);while(k!==null)}Qd=null,EP=!1}catch(N){throw Qd!==null&&(Qd=Qd.slice(d+1)),lt(Rr,Gp),N}finally{sr=m,oD=!1}}return null}var Wv=[],Hv=0,SP=null,TP=0,Ac=[],Ic=0,E0=null,ef=1,tf="";function S0(d,m){Wv[Hv++]=TP,Wv[Hv++]=SP,SP=d,TP=m}function kK(d,m,w){Ac[Ic++]=ef,Ac[Ic++]=tf,Ac[Ic++]=E0,E0=d;var k=ef;d=tf;var N=32-Pi(k)-1;k&=~(1<<N),w+=1;var L=32-Pi(m)+N;if(30<L){var K=N-N%5;L=(k&(1<<K)-1).toString(32),k>>=K,N-=K,ef=1<<32-Pi(m)+N|w<<N|k,tf=L+d}else ef=1<<L|w<<N|k,tf=d}function aD(d){d.return!==null&&(S0(d,1),kK(d,1,0))}function lD(d){for(;d===SP;)SP=Wv[--Hv],Wv[Hv]=null,TP=Wv[--Hv],Wv[Hv]=null;for(;d===E0;)E0=Ac[--Ic],Ac[Ic]=null,tf=Ac[--Ic],Ac[Ic]=null,ef=Ac[--Ic],Ac[Ic]=null}var zl=null,Gl=null,_i=!1,ku=null;function AK(d,m){var w=Mc(5,null,null,0);w.elementType="DELETED",w.stateNode=m,w.return=d,m=d.deletions,m===null?(d.deletions=[w],d.flags|=16):m.push(w)}function IK(d,m){switch(d.tag){case 5:var w=d.type;return m=m.nodeType!==1||w.toLowerCase()!==m.nodeName.toLowerCase()?null:m,m!==null?(d.stateNode=m,zl=d,Gl=Fp(m.firstChild),!0):!1;case 6:return m=d.pendingProps===""||m.nodeType!==3?null:m,m!==null?(d.stateNode=m,zl=d,Gl=null,!0):!1;case 13:return m=m.nodeType!==8?null:m,m!==null?(w=E0!==null?{id:ef,overflow:tf}:null,d.memoizedState={dehydrated:m,treeContext:w,retryLane:1073741824},w=Mc(18,null,null,0),w.stateNode=m,w.return=d,d.child=w,zl=d,Gl=null,!0):!1;default:return!1}}function cD(d){return(d.mode&1)!==0&&(d.flags&128)===0}function uD(d){if(_i){var m=Gl;if(m){var w=m;if(!IK(d,m)){if(cD(d))throw Error(n(418));m=Fp(w.nextSibling);var k=zl;m&&IK(d,m)?AK(k,w):(d.flags=d.flags&-4097|2,_i=!1,zl=d)}}else{if(cD(d))throw Error(n(418));d.flags=d.flags&-4097|2,_i=!1,zl=d}}}function PK(d){for(d=d.return;d!==null&&d.tag!==5&&d.tag!==3&&d.tag!==13;)d=d.return;zl=d}function kP(d){if(d!==zl)return!1;if(!_i)return PK(d),_i=!0,!1;var m;if((m=d.tag!==3)&&!(m=d.tag!==5)&&(m=d.type,m=m!=="head"&&m!=="body"&&!tD(d.type,d.memoizedProps)),m&&(m=Gl)){if(cD(d))throw CK(),Error(n(418));for(;m;)AK(d,m),m=Fp(m.nextSibling)}if(PK(d),d.tag===13){if(d=d.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(n(317));e:{for(d=d.nextSibling,m=0;d;){if(d.nodeType===8){var w=d.data;if(w==="/$"){if(m===0){Gl=Fp(d.nextSibling);break e}m--}else w!=="$"&&w!=="$!"&&w!=="$?"||m++}d=d.nextSibling}Gl=null}}else Gl=zl?Fp(d.stateNode.nextSibling):null;return!0}function CK(){for(var d=Gl;d;)d=Fp(d.nextSibling)}function qv(){Gl=zl=null,_i=!1}function hD(d){ku===null?ku=[d]:ku.push(d)}var HSe=P.ReactCurrentBatchConfig;function eE(d,m,w){if(d=w.ref,d!==null&&typeof d!="function"&&typeof d!="object"){if(w._owner){if(w=w._owner,w){if(w.tag!==1)throw Error(n(309));var k=w.stateNode}if(!k)throw Error(n(147,d));var N=k,L=""+d;return m!==null&&m.ref!==null&&typeof m.ref=="function"&&m.ref._stringRef===L?m.ref:(m=function(K){var ce=N.refs;K===null?delete ce[L]:ce[L]=K},m._stringRef=L,m)}if(typeof d!="string")throw Error(n(284));if(!w._owner)throw Error(n(290,d))}return d}function AP(d,m){throw d=Object.prototype.toString.call(m),Error(n(31,d==="[object Object]"?"object with keys {"+Object.keys(m).join(", ")+"}":d))}function RK(d){var m=d._init;return m(d._payload)}function MK(d){function m(be,me){if(d){var Me=be.deletions;Me===null?(be.deletions=[me],be.flags|=16):Me.push(me)}}function w(be,me){if(!d)return null;for(;me!==null;)m(be,me),me=me.sibling;return null}function k(be,me){for(be=new Map;me!==null;)me.key!==null?be.set(me.key,me):be.set(me.index,me),me=me.sibling;return be}function N(be,me){return be=Xp(be,me),be.index=0,be.sibling=null,be}function L(be,me,Me){return be.index=Me,d?(Me=be.alternate,Me!==null?(Me=Me.index,Me<me?(be.flags|=2,me):Me):(be.flags|=2,me)):(be.flags|=1048576,me)}function K(be){return d&&be.alternate===null&&(be.flags|=2),be}function ce(be,me,Me,mt){return me===null||me.tag!==6?(me=n6(Me,be.mode,mt),me.return=be,me):(me=N(me,Me),me.return=be,me)}function he(be,me,Me,mt){var Zt=Me.type;return Zt===C?ot(be,me,Me.props.children,mt,Me.key):me!==null&&(me.elementType===Zt||typeof Zt=="object"&&Zt!==null&&Zt.$$typeof===ze&&RK(Zt)===me.type)?(mt=N(me,Me.props),mt.ref=eE(be,me,Me),mt.return=be,mt):(mt=ZP(Me.type,Me.key,Me.props,null,be.mode,mt),mt.ref=eE(be,me,Me),mt.return=be,mt)}function $e(be,me,Me,mt){return me===null||me.tag!==4||me.stateNode.containerInfo!==Me.containerInfo||me.stateNode.implementation!==Me.implementation?(me=r6(Me,be.mode,mt),me.return=be,me):(me=N(me,Me.children||[]),me.return=be,me)}function ot(be,me,Me,mt,Zt){return me===null||me.tag!==7?(me=M0(Me,be.mode,mt,Zt),me.return=be,me):(me=N(me,Me),me.return=be,me)}function ht(be,me,Me){if(typeof me=="string"&&me!==""||typeof me=="number")return me=n6(""+me,be.mode,Me),me.return=be,me;if(typeof me=="object"&&me!==null){switch(me.$$typeof){case R:return Me=ZP(me.type,me.key,me.props,null,be.mode,Me),Me.ref=eE(be,null,me),Me.return=be,Me;case D:return me=r6(me,be.mode,Me),me.return=be,me;case ze:var mt=me._init;return ht(be,mt(me._payload),Me)}if(Wn(me)||De(me))return me=M0(me,be.mode,Me,null),me.return=be,me;AP(be,me)}return null}function rt(be,me,Me,mt){var Zt=me!==null?me.key:null;if(typeof Me=="string"&&Me!==""||typeof Me=="number")return Zt!==null?null:ce(be,me,""+Me,mt);if(typeof Me=="object"&&Me!==null){switch(Me.$$typeof){case R:return Me.key===Zt?he(be,me,Me,mt):null;case D:return Me.key===Zt?$e(be,me,Me,mt):null;case ze:return Zt=Me._init,rt(be,me,Zt(Me._payload),mt)}if(Wn(Me)||De(Me))return Zt!==null?null:ot(be,me,Me,mt,null);AP(be,Me)}return null}function Nt(be,me,Me,mt,Zt){if(typeof mt=="string"&&mt!==""||typeof mt=="number")return be=be.get(Me)||null,ce(me,be,""+mt,Zt);if(typeof mt=="object"&&mt!==null){switch(mt.$$typeof){case R:return be=be.get(mt.key===null?Me:mt.key)||null,he(me,be,mt,Zt);case D:return be=be.get(mt.key===null?Me:mt.key)||null,$e(me,be,mt,Zt);case ze:var un=mt._init;return Nt(be,me,Me,un(mt._payload),Zt)}if(Wn(mt)||De(mt))return be=be.get(Me)||null,ot(me,be,mt,Zt,null);AP(me,mt)}return null}function Gt(be,me,Me,mt){for(var Zt=null,un=null,hn=me,Sn=me=0,eo=null;hn!==null&&Sn<Me.length;Sn++){hn.index>Sn?(eo=hn,hn=null):eo=hn.sibling;var yr=rt(be,hn,Me[Sn],mt);if(yr===null){hn===null&&(hn=eo);break}d&&hn&&yr.alternate===null&&m(be,hn),me=L(yr,me,Sn),un===null?Zt=yr:un.sibling=yr,un=yr,hn=eo}if(Sn===Me.length)return w(be,hn),_i&&S0(be,Sn),Zt;if(hn===null){for(;Sn<Me.length;Sn++)hn=ht(be,Me[Sn],mt),hn!==null&&(me=L(hn,me,Sn),un===null?Zt=hn:un.sibling=hn,un=hn);return _i&&S0(be,Sn),Zt}for(hn=k(be,hn);Sn<Me.length;Sn++)eo=Nt(hn,be,Sn,Me[Sn],mt),eo!==null&&(d&&eo.alternate!==null&&hn.delete(eo.key===null?Sn:eo.key),me=L(eo,me,Sn),un===null?Zt=eo:un.sibling=eo,un=eo);return d&&hn.forEach(function(Zp){return m(be,Zp)}),_i&&S0(be,Sn),Zt}function Yt(be,me,Me,mt){var Zt=De(Me);if(typeof Zt!="function")throw Error(n(150));if(Me=Zt.call(Me),Me==null)throw Error(n(151));for(var un=Zt=null,hn=me,Sn=me=0,eo=null,yr=Me.next();hn!==null&&!yr.done;Sn++,yr=Me.next()){hn.index>Sn?(eo=hn,hn=null):eo=hn.sibling;var Zp=rt(be,hn,yr.value,mt);if(Zp===null){hn===null&&(hn=eo);break}d&&hn&&Zp.alternate===null&&m(be,hn),me=L(Zp,me,Sn),un===null?Zt=Zp:un.sibling=Zp,un=Zp,hn=eo}if(yr.done)return w(be,hn),_i&&S0(be,Sn),Zt;if(hn===null){for(;!yr.done;Sn++,yr=Me.next())yr=ht(be,yr.value,mt),yr!==null&&(me=L(yr,me,Sn),un===null?Zt=yr:un.sibling=yr,un=yr);return _i&&S0(be,Sn),Zt}for(hn=k(be,hn);!yr.done;Sn++,yr=Me.next())yr=Nt(hn,be,Sn,yr.value,mt),yr!==null&&(d&&yr.alternate!==null&&hn.delete(yr.key===null?Sn:yr.key),me=L(yr,me,Sn),un===null?Zt=yr:un.sibling=yr,un=yr);return d&&hn.forEach(function(TTe){return m(be,TTe)}),_i&&S0(be,Sn),Zt}function as(be,me,Me,mt){if(typeof Me=="object"&&Me!==null&&Me.type===C&&Me.key===null&&(Me=Me.props.children),typeof Me=="object"&&Me!==null){switch(Me.$$typeof){case R:e:{for(var Zt=Me.key,un=me;un!==null;){if(un.key===Zt){if(Zt=Me.type,Zt===C){if(un.tag===7){w(be,un.sibling),me=N(un,Me.props.children),me.return=be,be=me;break e}}else if(un.elementType===Zt||typeof Zt=="object"&&Zt!==null&&Zt.$$typeof===ze&&RK(Zt)===un.type){w(be,un.sibling),me=N(un,Me.props),me.ref=eE(be,un,Me),me.return=be,be=me;break e}w(be,un);break}else m(be,un);un=un.sibling}Me.type===C?(me=M0(Me.props.children,be.mode,mt,Me.key),me.return=be,be=me):(mt=ZP(Me.type,Me.key,Me.props,null,be.mode,mt),mt.ref=eE(be,me,Me),mt.return=be,be=mt)}return K(be);case D:e:{for(un=Me.key;me!==null;){if(me.key===un)if(me.tag===4&&me.stateNode.containerInfo===Me.containerInfo&&me.stateNode.implementation===Me.implementation){w(be,me.sibling),me=N(me,Me.children||[]),me.return=be,be=me;break e}else{w(be,me);break}else m(be,me);me=me.sibling}me=r6(Me,be.mode,mt),me.return=be,be=me}return K(be);case ze:return un=Me._init,as(be,me,un(Me._payload),mt)}if(Wn(Me))return Gt(be,me,Me,mt);if(De(Me))return Yt(be,me,Me,mt);AP(be,Me)}return typeof Me=="string"&&Me!==""||typeof Me=="number"?(Me=""+Me,me!==null&&me.tag===6?(w(be,me.sibling),me=N(me,Me),me.return=be,be=me):(w(be,me),me=n6(Me,be.mode,mt),me.return=be,be=me),K(be)):w(be,me)}return as}var Kv=MK(!0),NK=MK(!1),IP=Vp(null),PP=null,Yv=null,dD=null;function fD(){dD=Yv=PP=null}function pD(d){var m=IP.current;ci(IP),d._currentValue=m}function mD(d,m,w){for(;d!==null;){var k=d.alternate;if((d.childLanes&m)!==m?(d.childLanes|=m,k!==null&&(k.childLanes|=m)):k!==null&&(k.childLanes&m)!==m&&(k.childLanes|=m),d===w)break;d=d.return}}function Xv(d,m){PP=d,dD=Yv=null,d=d.dependencies,d!==null&&d.firstContext!==null&&((d.lanes&m)!==0&&(Ya=!0),d.firstContext=null)}function Pc(d){var m=d._currentValue;if(dD!==d)if(d={context:d,memoizedValue:m,next:null},Yv===null){if(PP===null)throw Error(n(308));Yv=d,PP.dependencies={lanes:0,firstContext:d}}else Yv=Yv.next=d;return m}var T0=null;function gD(d){T0===null?T0=[d]:T0.push(d)}function OK(d,m,w,k){var N=m.interleaved;return N===null?(w.next=w,gD(m)):(w.next=N.next,N.next=w),m.interleaved=w,nf(d,k)}function nf(d,m){d.lanes|=m;var w=d.alternate;for(w!==null&&(w.lanes|=m),w=d,d=d.return;d!==null;)d.childLanes|=m,w=d.alternate,w!==null&&(w.childLanes|=m),w=d,d=d.return;return w.tag===3?w.stateNode:null}var Up=!1;function yD(d){d.updateQueue={baseState:d.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function LK(d,m){d=d.updateQueue,m.updateQueue===d&&(m.updateQueue={baseState:d.baseState,firstBaseUpdate:d.firstBaseUpdate,lastBaseUpdate:d.lastBaseUpdate,shared:d.shared,effects:d.effects})}function rf(d,m){return{eventTime:d,lane:m,tag:0,payload:null,callback:null,next:null}}function Bp(d,m,w){var k=d.updateQueue;if(k===null)return null;if(k=k.shared,(fr&2)!==0){var N=k.pending;return N===null?m.next=m:(m.next=N.next,N.next=m),k.pending=m,nf(d,w)}return N=k.interleaved,N===null?(m.next=m,gD(k)):(m.next=N.next,N.next=m),k.interleaved=m,nf(d,w)}function CP(d,m,w){if(m=m.updateQueue,m!==null&&(m=m.shared,(w&4194240)!==0)){var k=m.lanes;k&=d.pendingLanes,w|=k,m.lanes=w,Lb(d,w)}}function DK(d,m){var w=d.updateQueue,k=d.alternate;if(k!==null&&(k=k.updateQueue,w===k)){var N=null,L=null;if(w=w.firstBaseUpdate,w!==null){do{var K={eventTime:w.eventTime,lane:w.lane,tag:w.tag,payload:w.payload,callback:w.callback,next:null};L===null?N=L=K:L=L.next=K,w=w.next}while(w!==null);L===null?N=L=m:L=L.next=m}else N=L=m;w={baseState:k.baseState,firstBaseUpdate:N,lastBaseUpdate:L,shared:k.shared,effects:k.effects},d.updateQueue=w;return}d=w.lastBaseUpdate,d===null?w.firstBaseUpdate=m:d.next=m,w.lastBaseUpdate=m}function RP(d,m,w,k){var N=d.updateQueue;Up=!1;var L=N.firstBaseUpdate,K=N.lastBaseUpdate,ce=N.shared.pending;if(ce!==null){N.shared.pending=null;var he=ce,$e=he.next;he.next=null,K===null?L=$e:K.next=$e,K=he;var ot=d.alternate;ot!==null&&(ot=ot.updateQueue,ce=ot.lastBaseUpdate,ce!==K&&(ce===null?ot.firstBaseUpdate=$e:ce.next=$e,ot.lastBaseUpdate=he))}if(L!==null){var ht=N.baseState;K=0,ot=$e=he=null,ce=L;do{var rt=ce.lane,Nt=ce.eventTime;if((k&rt)===rt){ot!==null&&(ot=ot.next={eventTime:Nt,lane:0,tag:ce.tag,payload:ce.payload,callback:ce.callback,next:null});e:{var Gt=d,Yt=ce;switch(rt=m,Nt=w,Yt.tag){case 1:if(Gt=Yt.payload,typeof Gt=="function"){ht=Gt.call(Nt,ht,rt);break e}ht=Gt;break e;case 3:Gt.flags=Gt.flags&-65537|128;case 0:if(Gt=Yt.payload,rt=typeof Gt=="function"?Gt.call(Nt,ht,rt):Gt,rt==null)break e;ht=Ce({},ht,rt);break e;case 2:Up=!0}}ce.callback!==null&&ce.lane!==0&&(d.flags|=64,rt=N.effects,rt===null?N.effects=[ce]:rt.push(ce))}else Nt={eventTime:Nt,lane:rt,tag:ce.tag,payload:ce.payload,callback:ce.callback,next:null},ot===null?($e=ot=Nt,he=ht):ot=ot.next=Nt,K|=rt;if(ce=ce.next,ce===null){if(ce=N.shared.pending,ce===null)break;rt=ce,ce=rt.next,rt.next=null,N.lastBaseUpdate=rt,N.shared.pending=null}}while(!0);if(ot===null&&(he=ht),N.baseState=he,N.firstBaseUpdate=$e,N.lastBaseUpdate=ot,m=N.shared.interleaved,m!==null){N=m;do K|=N.lane,N=N.next;while(N!==m)}else L===null&&(N.shared.lanes=0);I0|=K,d.lanes=K,d.memoizedState=ht}}function jK(d,m,w){if(d=m.effects,m.effects=null,d!==null)for(m=0;m<d.length;m++){var k=d[m],N=k.callback;if(N!==null){if(k.callback=null,k=w,typeof N!="function")throw Error(n(191,N));N.call(k)}}}var tE={},zh=Vp(tE),nE=Vp(tE),rE=Vp(tE);function k0(d){if(d===tE)throw Error(n(174));return d}function vD(d,m){switch(oi(rE,m),oi(nE,d),oi(zh,tE),d=m.nodeType,d){case 9:case 11:m=(m=m.documentElement)?m.namespaceURI:Qn(null,"");break;default:d=d===8?m.parentNode:m,m=d.namespaceURI||null,d=d.tagName,m=Qn(m,d)}ci(zh),oi(zh,m)}function Zv(){ci(zh),ci(nE),ci(rE)}function $K(d){k0(rE.current);var m=k0(zh.current),w=Qn(m,d.type);m!==w&&(oi(nE,d),oi(zh,w))}function _D(d){nE.current===d&&(ci(zh),ci(nE))}var Ci=Vp(0);function MP(d){for(var m=d;m!==null;){if(m.tag===13){var w=m.memoizedState;if(w!==null&&(w=w.dehydrated,w===null||w.data==="$?"||w.data==="$!"))return m}else if(m.tag===19&&m.memoizedProps.revealOrder!==void 0){if((m.flags&128)!==0)return m}else if(m.child!==null){m.child.return=m,m=m.child;continue}if(m===d)break;for(;m.sibling===null;){if(m.return===null||m.return===d)return null;m=m.return}m.sibling.return=m.return,m=m.sibling}return null}var xD=[];function wD(){for(var d=0;d<xD.length;d++)xD[d]._workInProgressVersionPrimary=null;xD.length=0}var NP=P.ReactCurrentDispatcher,bD=P.ReactCurrentBatchConfig,A0=0,Ri=null,js=null,Js=null,OP=!1,iE=!1,sE=0,qSe=0;function zo(){throw Error(n(321))}function ED(d,m){if(m===null)return!1;for(var w=0;w<m.length&&w<d.length;w++)if(!Tu(d[w],m[w]))return!1;return!0}function SD(d,m,w,k,N,L){if(A0=L,Ri=m,m.memoizedState=null,m.updateQueue=null,m.lanes=0,NP.current=d===null||d.memoizedState===null?ZSe:JSe,d=w(k,N),iE){L=0;do{if(iE=!1,sE=0,25<=L)throw Error(n(301));L+=1,Js=js=null,m.updateQueue=null,NP.current=QSe,d=w(k,N)}while(iE)}if(NP.current=jP,m=js!==null&&js.next!==null,A0=0,Js=js=Ri=null,OP=!1,m)throw Error(n(300));return d}function TD(){var d=sE!==0;return sE=0,d}function Gh(){var d={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Js===null?Ri.memoizedState=Js=d:Js=Js.next=d,Js}function Cc(){if(js===null){var d=Ri.alternate;d=d!==null?d.memoizedState:null}else d=js.next;var m=Js===null?Ri.memoizedState:Js.next;if(m!==null)Js=m,js=d;else{if(d===null)throw Error(n(310));js=d,d={memoizedState:js.memoizedState,baseState:js.baseState,baseQueue:js.baseQueue,queue:js.queue,next:null},Js===null?Ri.memoizedState=Js=d:Js=Js.next=d}return Js}function oE(d,m){return typeof m=="function"?m(d):m}function kD(d){var m=Cc(),w=m.queue;if(w===null)throw Error(n(311));w.lastRenderedReducer=d;var k=js,N=k.baseQueue,L=w.pending;if(L!==null){if(N!==null){var K=N.next;N.next=L.next,L.next=K}k.baseQueue=N=L,w.pending=null}if(N!==null){L=N.next,k=k.baseState;var ce=K=null,he=null,$e=L;do{var ot=$e.lane;if((A0&ot)===ot)he!==null&&(he=he.next={lane:0,action:$e.action,hasEagerState:$e.hasEagerState,eagerState:$e.eagerState,next:null}),k=$e.hasEagerState?$e.eagerState:d(k,$e.action);else{var ht={lane:ot,action:$e.action,hasEagerState:$e.hasEagerState,eagerState:$e.eagerState,next:null};he===null?(ce=he=ht,K=k):he=he.next=ht,Ri.lanes|=ot,I0|=ot}$e=$e.next}while($e!==null&&$e!==L);he===null?K=k:he.next=ce,Tu(k,m.memoizedState)||(Ya=!0),m.memoizedState=k,m.baseState=K,m.baseQueue=he,w.lastRenderedState=k}if(d=w.interleaved,d!==null){N=d;do L=N.lane,Ri.lanes|=L,I0|=L,N=N.next;while(N!==d)}else N===null&&(w.lanes=0);return[m.memoizedState,w.dispatch]}function AD(d){var m=Cc(),w=m.queue;if(w===null)throw Error(n(311));w.lastRenderedReducer=d;var k=w.dispatch,N=w.pending,L=m.memoizedState;if(N!==null){w.pending=null;var K=N=N.next;do L=d(L,K.action),K=K.next;while(K!==N);Tu(L,m.memoizedState)||(Ya=!0),m.memoizedState=L,m.baseQueue===null&&(m.baseState=L),w.lastRenderedState=L}return[L,k]}function FK(){}function VK(d,m){var w=Ri,k=Cc(),N=m(),L=!Tu(k.memoizedState,N);if(L&&(k.memoizedState=N,Ya=!0),k=k.queue,ID(UK.bind(null,w,k,d),[d]),k.getSnapshot!==m||L||Js!==null&&Js.memoizedState.tag&1){if(w.flags|=2048,aE(9,GK.bind(null,w,k,N,m),void 0,null),Qs===null)throw Error(n(349));(A0&30)!==0||zK(w,m,N)}return N}function zK(d,m,w){d.flags|=16384,d={getSnapshot:m,value:w},m=Ri.updateQueue,m===null?(m={lastEffect:null,stores:null},Ri.updateQueue=m,m.stores=[d]):(w=m.stores,w===null?m.stores=[d]:w.push(d))}function GK(d,m,w,k){m.value=w,m.getSnapshot=k,BK(m)&&WK(d)}function UK(d,m,w){return w(function(){BK(m)&&WK(d)})}function BK(d){var m=d.getSnapshot;d=d.value;try{var w=m();return!Tu(d,w)}catch{return!0}}function WK(d){var m=nf(d,1);m!==null&&Cu(m,d,1,-1)}function HK(d){var m=Gh();return typeof d=="function"&&(d=d()),m.memoizedState=m.baseState=d,d={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:oE,lastRenderedState:d},m.queue=d,d=d.dispatch=XSe.bind(null,Ri,d),[m.memoizedState,d]}function aE(d,m,w,k){return d={tag:d,create:m,destroy:w,deps:k,next:null},m=Ri.updateQueue,m===null?(m={lastEffect:null,stores:null},Ri.updateQueue=m,m.lastEffect=d.next=d):(w=m.lastEffect,w===null?m.lastEffect=d.next=d:(k=w.next,w.next=d,d.next=k,m.lastEffect=d)),d}function qK(){return Cc().memoizedState}function LP(d,m,w,k){var N=Gh();Ri.flags|=d,N.memoizedState=aE(1|m,w,void 0,k===void 0?null:k)}function DP(d,m,w,k){var N=Cc();k=k===void 0?null:k;var L=void 0;if(js!==null){var K=js.memoizedState;if(L=K.destroy,k!==null&&ED(k,K.deps)){N.memoizedState=aE(m,w,L,k);return}}Ri.flags|=d,N.memoizedState=aE(1|m,w,L,k)}function KK(d,m){return LP(8390656,8,d,m)}function ID(d,m){return DP(2048,8,d,m)}function YK(d,m){return DP(4,2,d,m)}function XK(d,m){return DP(4,4,d,m)}function ZK(d,m){if(typeof m=="function")return d=d(),m(d),function(){m(null)};if(m!=null)return d=d(),m.current=d,function(){m.current=null}}function JK(d,m,w){return w=w!=null?w.concat([d]):null,DP(4,4,ZK.bind(null,m,d),w)}function PD(){}function QK(d,m){var w=Cc();m=m===void 0?null:m;var k=w.memoizedState;return k!==null&&m!==null&&ED(m,k[1])?k[0]:(w.memoizedState=[d,m],d)}function eY(d,m){var w=Cc();m=m===void 0?null:m;var k=w.memoizedState;return k!==null&&m!==null&&ED(m,k[1])?k[0]:(d=d(),w.memoizedState=[d,m],d)}function tY(d,m,w){return(A0&21)===0?(d.baseState&&(d.baseState=!1,Ya=!0),d.memoizedState=w):(Tu(w,m)||(w=Nb(),Ri.lanes|=w,I0|=w,d.baseState=!0),m)}function KSe(d,m){var w=sr;sr=w!==0&&4>w?w:4,d(!0);var k=bD.transition;bD.transition={};try{d(!1),m()}finally{sr=w,bD.transition=k}}function nY(){return Cc().memoizedState}function YSe(d,m,w){var k=Kp(d);if(w={lane:k,action:w,hasEagerState:!1,eagerState:null,next:null},rY(d))iY(m,w);else if(w=OK(d,m,w,k),w!==null){var N=Ea();Cu(w,d,k,N),sY(w,m,k)}}function XSe(d,m,w){var k=Kp(d),N={lane:k,action:w,hasEagerState:!1,eagerState:null,next:null};if(rY(d))iY(m,N);else{var L=d.alternate;if(d.lanes===0&&(L===null||L.lanes===0)&&(L=m.lastRenderedReducer,L!==null))try{var K=m.lastRenderedState,ce=L(K,w);if(N.hasEagerState=!0,N.eagerState=ce,Tu(ce,K)){var he=m.interleaved;he===null?(N.next=N,gD(m)):(N.next=he.next,he.next=N),m.interleaved=N;return}}catch{}w=OK(d,m,N,k),w!==null&&(N=Ea(),Cu(w,d,k,N),sY(w,m,k))}}function rY(d){var m=d.alternate;return d===Ri||m!==null&&m===Ri}function iY(d,m){iE=OP=!0;var w=d.pending;w===null?m.next=m:(m.next=w.next,w.next=m),d.pending=m}function sY(d,m,w){if((w&4194240)!==0){var k=m.lanes;k&=d.pendingLanes,w|=k,m.lanes=w,Lb(d,w)}}var jP={readContext:Pc,useCallback:zo,useContext:zo,useEffect:zo,useImperativeHandle:zo,useInsertionEffect:zo,useLayoutEffect:zo,useMemo:zo,useReducer:zo,useRef:zo,useState:zo,useDebugValue:zo,useDeferredValue:zo,useTransition:zo,useMutableSource:zo,useSyncExternalStore:zo,useId:zo,unstable_isNewReconciler:!1},ZSe={readContext:Pc,useCallback:function(d,m){return Gh().memoizedState=[d,m===void 0?null:m],d},useContext:Pc,useEffect:KK,useImperativeHandle:function(d,m,w){return w=w!=null?w.concat([d]):null,LP(4194308,4,ZK.bind(null,m,d),w)},useLayoutEffect:function(d,m){return LP(4194308,4,d,m)},useInsertionEffect:function(d,m){return LP(4,2,d,m)},useMemo:function(d,m){var w=Gh();return m=m===void 0?null:m,d=d(),w.memoizedState=[d,m],d},useReducer:function(d,m,w){var k=Gh();return m=w!==void 0?w(m):m,k.memoizedState=k.baseState=m,d={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:d,lastRenderedState:m},k.queue=d,d=d.dispatch=YSe.bind(null,Ri,d),[k.memoizedState,d]},useRef:function(d){var m=Gh();return d={current:d},m.memoizedState=d},useState:HK,useDebugValue:PD,useDeferredValue:function(d){return Gh().memoizedState=d},useTransition:function(){var d=HK(!1),m=d[0];return d=KSe.bind(null,d[1]),Gh().memoizedState=d,[m,d]},useMutableSource:function(){},useSyncExternalStore:function(d,m,w){var k=Ri,N=Gh();if(_i){if(w===void 0)throw Error(n(407));w=w()}else{if(w=m(),Qs===null)throw Error(n(349));(A0&30)!==0||zK(k,m,w)}N.memoizedState=w;var L={value:w,getSnapshot:m};return N.queue=L,KK(UK.bind(null,k,L,d),[d]),k.flags|=2048,aE(9,GK.bind(null,k,L,w,m),void 0,null),w},useId:function(){var d=Gh(),m=Qs.identifierPrefix;if(_i){var w=tf,k=ef;w=(k&~(1<<32-Pi(k)-1)).toString(32)+w,m=":"+m+"R"+w,w=sE++,0<w&&(m+="H"+w.toString(32)),m+=":"}else w=qSe++,m=":"+m+"r"+w.toString(32)+":";return d.memoizedState=m},unstable_isNewReconciler:!1},JSe={readContext:Pc,useCallback:QK,useContext:Pc,useEffect:ID,useImperativeHandle:JK,useInsertionEffect:YK,useLayoutEffect:XK,useMemo:eY,useReducer:kD,useRef:qK,useState:function(){return kD(oE)},useDebugValue:PD,useDeferredValue:function(d){var m=Cc();return tY(m,js.memoizedState,d)},useTransition:function(){var d=kD(oE)[0],m=Cc().memoizedState;return[d,m]},useMutableSource:FK,useSyncExternalStore:VK,useId:nY,unstable_isNewReconciler:!1},QSe={readContext:Pc,useCallback:QK,useContext:Pc,useEffect:ID,useImperativeHandle:JK,useInsertionEffect:YK,useLayoutEffect:XK,useMemo:eY,useReducer:AD,useRef:qK,useState:function(){return AD(oE)},useDebugValue:PD,useDeferredValue:function(d){var m=Cc();return js===null?m.memoizedState=d:tY(m,js.memoizedState,d)},useTransition:function(){var d=AD(oE)[0],m=Cc().memoizedState;return[d,m]},useMutableSource:FK,useSyncExternalStore:VK,useId:nY,unstable_isNewReconciler:!1};function Au(d,m){if(d&&d.defaultProps){m=Ce({},m),d=d.defaultProps;for(var w in d)m[w]===void 0&&(m[w]=d[w]);return m}return m}function CD(d,m,w,k){m=d.memoizedState,w=w(k,m),w=w==null?m:Ce({},m,w),d.memoizedState=w,d.lanes===0&&(d.updateQueue.baseState=w)}var $P={isMounted:function(d){return(d=d._reactInternals)?oe(d)===d:!1},enqueueSetState:function(d,m,w){d=d._reactInternals;var k=Ea(),N=Kp(d),L=rf(k,N);L.payload=m,w!=null&&(L.callback=w),m=Bp(d,L,N),m!==null&&(Cu(m,d,N,k),CP(m,d,N))},enqueueReplaceState:function(d,m,w){d=d._reactInternals;var k=Ea(),N=Kp(d),L=rf(k,N);L.tag=1,L.payload=m,w!=null&&(L.callback=w),m=Bp(d,L,N),m!==null&&(Cu(m,d,N,k),CP(m,d,N))},enqueueForceUpdate:function(d,m){d=d._reactInternals;var w=Ea(),k=Kp(d),N=rf(w,k);N.tag=2,m!=null&&(N.callback=m),m=Bp(d,N,k),m!==null&&(Cu(m,d,k,w),CP(m,d,k))}};function oY(d,m,w,k,N,L,K){return d=d.stateNode,typeof d.shouldComponentUpdate=="function"?d.shouldComponentUpdate(k,L,K):m.prototype&&m.prototype.isPureReactComponent?!qb(w,k)||!qb(N,L):!0}function aY(d,m,w){var k=!1,N=zp,L=m.contextType;return typeof L=="object"&&L!==null?L=Pc(L):(N=Ka(m)?b0:Vo.current,k=m.contextTypes,L=(k=k!=null)?Bv(d,N):zp),m=new m(w,L),d.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,m.updater=$P,d.stateNode=m,m._reactInternals=d,k&&(d=d.stateNode,d.__reactInternalMemoizedUnmaskedChildContext=N,d.__reactInternalMemoizedMaskedChildContext=L),m}function lY(d,m,w,k){d=m.state,typeof m.componentWillReceiveProps=="function"&&m.componentWillReceiveProps(w,k),typeof m.UNSAFE_componentWillReceiveProps=="function"&&m.UNSAFE_componentWillReceiveProps(w,k),m.state!==d&&$P.enqueueReplaceState(m,m.state,null)}function RD(d,m,w,k){var N=d.stateNode;N.props=w,N.state=d.memoizedState,N.refs={},yD(d);var L=m.contextType;typeof L=="object"&&L!==null?N.context=Pc(L):(L=Ka(m)?b0:Vo.current,N.context=Bv(d,L)),N.state=d.memoizedState,L=m.getDerivedStateFromProps,typeof L=="function"&&(CD(d,m,L,w),N.state=d.memoizedState),typeof m.getDerivedStateFromProps=="function"||typeof N.getSnapshotBeforeUpdate=="function"||typeof N.UNSAFE_componentWillMount!="function"&&typeof N.componentWillMount!="function"||(m=N.state,typeof N.componentWillMount=="function"&&N.componentWillMount(),typeof N.UNSAFE_componentWillMount=="function"&&N.UNSAFE_componentWillMount(),m!==N.state&&$P.enqueueReplaceState(N,N.state,null),RP(d,w,N,k),N.state=d.memoizedState),typeof N.componentDidMount=="function"&&(d.flags|=4194308)}function Jv(d,m){try{var w="",k=m;do w+=le(k),k=k.return;while(k);var N=w}catch(L){N=`
Error generating stack: `+L.message+`
`+L.stack}return{value:d,source:m,stack:N,digest:null}}function MD(d,m,w){return{value:d,source:null,stack:w??null,digest:m??null}}function ND(d,m){try{console.error(m.value)}catch(w){setTimeout(function(){throw w})}}var eTe=typeof WeakMap=="function"?WeakMap:Map;function cY(d,m,w){w=rf(-1,w),w.tag=3,w.payload={element:null};var k=m.value;return w.callback=function(){WP||(WP=!0,KD=k),ND(d,m)},w}function uY(d,m,w){w=rf(-1,w),w.tag=3;var k=d.type.getDerivedStateFromError;if(typeof k=="function"){var N=m.value;w.payload=function(){return k(N)},w.callback=function(){ND(d,m)}}var L=d.stateNode;return L!==null&&typeof L.componentDidCatch=="function"&&(w.callback=function(){ND(d,m),typeof k!="function"&&(Hp===null?Hp=new Set([this]):Hp.add(this));var K=m.stack;this.componentDidCatch(m.value,{componentStack:K!==null?K:""})}),w}function hY(d,m,w){var k=d.pingCache;if(k===null){k=d.pingCache=new eTe;var N=new Set;k.set(m,N)}else N=k.get(m),N===void 0&&(N=new Set,k.set(m,N));N.has(w)||(N.add(w),d=pTe.bind(null,d,m,w),m.then(d,d))}function dY(d){do{var m;if((m=d.tag===13)&&(m=d.memoizedState,m=m!==null?m.dehydrated!==null:!0),m)return d;d=d.return}while(d!==null);return null}function fY(d,m,w,k,N){return(d.mode&1)===0?(d===m?d.flags|=65536:(d.flags|=128,w.flags|=131072,w.flags&=-52805,w.tag===1&&(w.alternate===null?w.tag=17:(m=rf(-1,1),m.tag=2,Bp(w,m,1))),w.lanes|=1),d):(d.flags|=65536,d.lanes=N,d)}var tTe=P.ReactCurrentOwner,Ya=!1;function ba(d,m,w,k){m.child=d===null?NK(m,null,w,k):Kv(m,d.child,w,k)}function pY(d,m,w,k,N){w=w.render;var L=m.ref;return Xv(m,N),k=SD(d,m,w,k,L,N),w=TD(),d!==null&&!Ya?(m.updateQueue=d.updateQueue,m.flags&=-2053,d.lanes&=~N,sf(d,m,N)):(_i&&w&&aD(m),m.flags|=1,ba(d,m,k,N),m.child)}function mY(d,m,w,k,N){if(d===null){var L=w.type;return typeof L=="function"&&!t6(L)&&L.defaultProps===void 0&&w.compare===null&&w.defaultProps===void 0?(m.tag=15,m.type=L,gY(d,m,L,k,N)):(d=ZP(w.type,null,k,m,m.mode,N),d.ref=m.ref,d.return=m,m.child=d)}if(L=d.child,(d.lanes&N)===0){var K=L.memoizedProps;if(w=w.compare,w=w!==null?w:qb,w(K,k)&&d.ref===m.ref)return sf(d,m,N)}return m.flags|=1,d=Xp(L,k),d.ref=m.ref,d.return=m,m.child=d}function gY(d,m,w,k,N){if(d!==null){var L=d.memoizedProps;if(qb(L,k)&&d.ref===m.ref)if(Ya=!1,m.pendingProps=k=L,(d.lanes&N)!==0)(d.flags&131072)!==0&&(Ya=!0);else return m.lanes=d.lanes,sf(d,m,N)}return OD(d,m,w,k,N)}function yY(d,m,w){var k=m.pendingProps,N=k.children,L=d!==null?d.memoizedState:null;if(k.mode==="hidden")if((m.mode&1)===0)m.memoizedState={baseLanes:0,cachePool:null,transitions:null},oi(e_,Ul),Ul|=w;else{if((w&1073741824)===0)return d=L!==null?L.baseLanes|w:w,m.lanes=m.childLanes=1073741824,m.memoizedState={baseLanes:d,cachePool:null,transitions:null},m.updateQueue=null,oi(e_,Ul),Ul|=d,null;m.memoizedState={baseLanes:0,cachePool:null,transitions:null},k=L!==null?L.baseLanes:w,oi(e_,Ul),Ul|=k}else L!==null?(k=L.baseLanes|w,m.memoizedState=null):k=w,oi(e_,Ul),Ul|=k;return ba(d,m,N,w),m.child}function vY(d,m){var w=m.ref;(d===null&&w!==null||d!==null&&d.ref!==w)&&(m.flags|=512,m.flags|=2097152)}function OD(d,m,w,k,N){var L=Ka(w)?b0:Vo.current;return L=Bv(m,L),Xv(m,N),w=SD(d,m,w,k,L,N),k=TD(),d!==null&&!Ya?(m.updateQueue=d.updateQueue,m.flags&=-2053,d.lanes&=~N,sf(d,m,N)):(_i&&k&&aD(m),m.flags|=1,ba(d,m,w,N),m.child)}function _Y(d,m,w,k,N){if(Ka(w)){var L=!0;bP(m)}else L=!1;if(Xv(m,N),m.stateNode===null)VP(d,m),aY(m,w,k),RD(m,w,k,N),k=!0;else if(d===null){var K=m.stateNode,ce=m.memoizedProps;K.props=ce;var he=K.context,$e=w.contextType;typeof $e=="object"&&$e!==null?$e=Pc($e):($e=Ka(w)?b0:Vo.current,$e=Bv(m,$e));var ot=w.getDerivedStateFromProps,ht=typeof ot=="function"||typeof K.getSnapshotBeforeUpdate=="function";ht||typeof K.UNSAFE_componentWillReceiveProps!="function"&&typeof K.componentWillReceiveProps!="function"||(ce!==k||he!==$e)&&lY(m,K,k,$e),Up=!1;var rt=m.memoizedState;K.state=rt,RP(m,k,K,N),he=m.memoizedState,ce!==k||rt!==he||qa.current||Up?(typeof ot=="function"&&(CD(m,w,ot,k),he=m.memoizedState),(ce=Up||oY(m,w,ce,k,rt,he,$e))?(ht||typeof K.UNSAFE_componentWillMount!="function"&&typeof K.componentWillMount!="function"||(typeof K.componentWillMount=="function"&&K.componentWillMount(),typeof K.UNSAFE_componentWillMount=="function"&&K.UNSAFE_componentWillMount()),typeof K.componentDidMount=="function"&&(m.flags|=4194308)):(typeof K.componentDidMount=="function"&&(m.flags|=4194308),m.memoizedProps=k,m.memoizedState=he),K.props=k,K.state=he,K.context=$e,k=ce):(typeof K.componentDidMount=="function"&&(m.flags|=4194308),k=!1)}else{K=m.stateNode,LK(d,m),ce=m.memoizedProps,$e=m.type===m.elementType?ce:Au(m.type,ce),K.props=$e,ht=m.pendingProps,rt=K.context,he=w.contextType,typeof he=="object"&&he!==null?he=Pc(he):(he=Ka(w)?b0:Vo.current,he=Bv(m,he));var Nt=w.getDerivedStateFromProps;(ot=typeof Nt=="function"||typeof K.getSnapshotBeforeUpdate=="function")||typeof K.UNSAFE_componentWillReceiveProps!="function"&&typeof K.componentWillReceiveProps!="function"||(ce!==ht||rt!==he)&&lY(m,K,k,he),Up=!1,rt=m.memoizedState,K.state=rt,RP(m,k,K,N);var Gt=m.memoizedState;ce!==ht||rt!==Gt||qa.current||Up?(typeof Nt=="function"&&(CD(m,w,Nt,k),Gt=m.memoizedState),($e=Up||oY(m,w,$e,k,rt,Gt,he)||!1)?(ot||typeof K.UNSAFE_componentWillUpdate!="function"&&typeof K.componentWillUpdate!="function"||(typeof K.componentWillUpdate=="function"&&K.componentWillUpdate(k,Gt,he),typeof K.UNSAFE_componentWillUpdate=="function"&&K.UNSAFE_componentWillUpdate(k,Gt,he)),typeof K.componentDidUpdate=="function"&&(m.flags|=4),typeof K.getSnapshotBeforeUpdate=="function"&&(m.flags|=1024)):(typeof K.componentDidUpdate!="function"||ce===d.memoizedProps&&rt===d.memoizedState||(m.flags|=4),typeof K.getSnapshotBeforeUpdate!="function"||ce===d.memoizedProps&&rt===d.memoizedState||(m.flags|=1024),m.memoizedProps=k,m.memoizedState=Gt),K.props=k,K.state=Gt,K.context=he,k=$e):(typeof K.componentDidUpdate!="function"||ce===d.memoizedProps&&rt===d.memoizedState||(m.flags|=4),typeof K.getSnapshotBeforeUpdate!="function"||ce===d.memoizedProps&&rt===d.memoizedState||(m.flags|=1024),k=!1)}return LD(d,m,w,k,L,N)}function LD(d,m,w,k,N,L){vY(d,m);var K=(m.flags&128)!==0;if(!k&&!K)return N&&SK(m,w,!1),sf(d,m,L);k=m.stateNode,tTe.current=m;var ce=K&&typeof w.getDerivedStateFromError!="function"?null:k.render();return m.flags|=1,d!==null&&K?(m.child=Kv(m,d.child,null,L),m.child=Kv(m,null,ce,L)):ba(d,m,ce,L),m.memoizedState=k.state,N&&SK(m,w,!0),m.child}function xY(d){var m=d.stateNode;m.pendingContext?bK(d,m.pendingContext,m.pendingContext!==m.context):m.context&&bK(d,m.context,!1),vD(d,m.containerInfo)}function wY(d,m,w,k,N){return qv(),hD(N),m.flags|=256,ba(d,m,w,k),m.child}var DD={dehydrated:null,treeContext:null,retryLane:0};function jD(d){return{baseLanes:d,cachePool:null,transitions:null}}function bY(d,m,w){var k=m.pendingProps,N=Ci.current,L=!1,K=(m.flags&128)!==0,ce;if((ce=K)||(ce=d!==null&&d.memoizedState===null?!1:(N&2)!==0),ce?(L=!0,m.flags&=-129):(d===null||d.memoizedState!==null)&&(N|=1),oi(Ci,N&1),d===null)return uD(m),d=m.memoizedState,d!==null&&(d=d.dehydrated,d!==null)?((m.mode&1)===0?m.lanes=1:d.data==="$!"?m.lanes=8:m.lanes=1073741824,null):(K=k.children,d=k.fallback,L?(k=m.mode,L=m.child,K={mode:"hidden",children:K},(k&1)===0&&L!==null?(L.childLanes=0,L.pendingProps=K):L=JP(K,k,0,null),d=M0(d,k,w,null),L.return=m,d.return=m,L.sibling=d,m.child=L,m.child.memoizedState=jD(w),m.memoizedState=DD,d):$D(m,K));if(N=d.memoizedState,N!==null&&(ce=N.dehydrated,ce!==null))return nTe(d,m,K,k,ce,N,w);if(L){L=k.fallback,K=m.mode,N=d.child,ce=N.sibling;var he={mode:"hidden",children:k.children};return(K&1)===0&&m.child!==N?(k=m.child,k.childLanes=0,k.pendingProps=he,m.deletions=null):(k=Xp(N,he),k.subtreeFlags=N.subtreeFlags&14680064),ce!==null?L=Xp(ce,L):(L=M0(L,K,w,null),L.flags|=2),L.return=m,k.return=m,k.sibling=L,m.child=k,k=L,L=m.child,K=d.child.memoizedState,K=K===null?jD(w):{baseLanes:K.baseLanes|w,cachePool:null,transitions:K.transitions},L.memoizedState=K,L.childLanes=d.childLanes&~w,m.memoizedState=DD,k}return L=d.child,d=L.sibling,k=Xp(L,{mode:"visible",children:k.children}),(m.mode&1)===0&&(k.lanes=w),k.return=m,k.sibling=null,d!==null&&(w=m.deletions,w===null?(m.deletions=[d],m.flags|=16):w.push(d)),m.child=k,m.memoizedState=null,k}function $D(d,m){return m=JP({mode:"visible",children:m},d.mode,0,null),m.return=d,d.child=m}function FP(d,m,w,k){return k!==null&&hD(k),Kv(m,d.child,null,w),d=$D(m,m.pendingProps.children),d.flags|=2,m.memoizedState=null,d}function nTe(d,m,w,k,N,L,K){if(w)return m.flags&256?(m.flags&=-257,k=MD(Error(n(422))),FP(d,m,K,k)):m.memoizedState!==null?(m.child=d.child,m.flags|=128,null):(L=k.fallback,N=m.mode,k=JP({mode:"visible",children:k.children},N,0,null),L=M0(L,N,K,null),L.flags|=2,k.return=m,L.return=m,k.sibling=L,m.child=k,(m.mode&1)!==0&&Kv(m,d.child,null,K),m.child.memoizedState=jD(K),m.memoizedState=DD,L);if((m.mode&1)===0)return FP(d,m,K,null);if(N.data==="$!"){if(k=N.nextSibling&&N.nextSibling.dataset,k)var ce=k.dgst;return k=ce,L=Error(n(419)),k=MD(L,k,void 0),FP(d,m,K,k)}if(ce=(K&d.childLanes)!==0,Ya||ce){if(k=Qs,k!==null){switch(K&-K){case 4:N=2;break;case 16:N=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:N=32;break;case 536870912:N=268435456;break;default:N=0}N=(N&(k.suspendedLanes|K))!==0?0:N,N!==0&&N!==L.retryLane&&(L.retryLane=N,nf(d,N),Cu(k,d,N,-1))}return e6(),k=MD(Error(n(421))),FP(d,m,K,k)}return N.data==="$?"?(m.flags|=128,m.child=d.child,m=mTe.bind(null,d),N._reactRetry=m,null):(d=L.treeContext,Gl=Fp(N.nextSibling),zl=m,_i=!0,ku=null,d!==null&&(Ac[Ic++]=ef,Ac[Ic++]=tf,Ac[Ic++]=E0,ef=d.id,tf=d.overflow,E0=m),m=$D(m,k.children),m.flags|=4096,m)}function EY(d,m,w){d.lanes|=m;var k=d.alternate;k!==null&&(k.lanes|=m),mD(d.return,m,w)}function FD(d,m,w,k,N){var L=d.memoizedState;L===null?d.memoizedState={isBackwards:m,rendering:null,renderingStartTime:0,last:k,tail:w,tailMode:N}:(L.isBackwards=m,L.rendering=null,L.renderingStartTime=0,L.last=k,L.tail=w,L.tailMode=N)}function SY(d,m,w){var k=m.pendingProps,N=k.revealOrder,L=k.tail;if(ba(d,m,k.children,w),k=Ci.current,(k&2)!==0)k=k&1|2,m.flags|=128;else{if(d!==null&&(d.flags&128)!==0)e:for(d=m.child;d!==null;){if(d.tag===13)d.memoizedState!==null&&EY(d,w,m);else if(d.tag===19)EY(d,w,m);else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===m)break e;for(;d.sibling===null;){if(d.return===null||d.return===m)break e;d=d.return}d.sibling.return=d.return,d=d.sibling}k&=1}if(oi(Ci,k),(m.mode&1)===0)m.memoizedState=null;else switch(N){case"forwards":for(w=m.child,N=null;w!==null;)d=w.alternate,d!==null&&MP(d)===null&&(N=w),w=w.sibling;w=N,w===null?(N=m.child,m.child=null):(N=w.sibling,w.sibling=null),FD(m,!1,N,w,L);break;case"backwards":for(w=null,N=m.child,m.child=null;N!==null;){if(d=N.alternate,d!==null&&MP(d)===null){m.child=N;break}d=N.sibling,N.sibling=w,w=N,N=d}FD(m,!0,w,null,L);break;case"together":FD(m,!1,null,null,void 0);break;default:m.memoizedState=null}return m.child}function VP(d,m){(m.mode&1)===0&&d!==null&&(d.alternate=null,m.alternate=null,m.flags|=2)}function sf(d,m,w){if(d!==null&&(m.dependencies=d.dependencies),I0|=m.lanes,(w&m.childLanes)===0)return null;if(d!==null&&m.child!==d.child)throw Error(n(153));if(m.child!==null){for(d=m.child,w=Xp(d,d.pendingProps),m.child=w,w.return=m;d.sibling!==null;)d=d.sibling,w=w.sibling=Xp(d,d.pendingProps),w.return=m;w.sibling=null}return m.child}function rTe(d,m,w){switch(m.tag){case 3:xY(m),qv();break;case 5:$K(m);break;case 1:Ka(m.type)&&bP(m);break;case 4:vD(m,m.stateNode.containerInfo);break;case 10:var k=m.type._context,N=m.memoizedProps.value;oi(IP,k._currentValue),k._currentValue=N;break;case 13:if(k=m.memoizedState,k!==null)return k.dehydrated!==null?(oi(Ci,Ci.current&1),m.flags|=128,null):(w&m.child.childLanes)!==0?bY(d,m,w):(oi(Ci,Ci.current&1),d=sf(d,m,w),d!==null?d.sibling:null);oi(Ci,Ci.current&1);break;case 19:if(k=(w&m.childLanes)!==0,(d.flags&128)!==0){if(k)return SY(d,m,w);m.flags|=128}if(N=m.memoizedState,N!==null&&(N.rendering=null,N.tail=null,N.lastEffect=null),oi(Ci,Ci.current),k)break;return null;case 22:case 23:return m.lanes=0,yY(d,m,w)}return sf(d,m,w)}var TY,VD,kY,AY;TY=function(d,m){for(var w=m.child;w!==null;){if(w.tag===5||w.tag===6)d.appendChild(w.stateNode);else if(w.tag!==4&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===m)break;for(;w.sibling===null;){if(w.return===null||w.return===m)return;w=w.return}w.sibling.return=w.return,w=w.sibling}},VD=function(){},kY=function(d,m,w,k){var N=d.memoizedProps;if(N!==k){d=m.stateNode,k0(zh.current);var L=null;switch(w){case"input":N=jt(d,N),k=jt(d,k),L=[];break;case"select":N=Ce({},N,{value:void 0}),k=Ce({},k,{value:void 0}),L=[];break;case"textarea":N=_o(d,N),k=_o(d,k),L=[];break;default:typeof N.onClick!="function"&&typeof k.onClick=="function"&&(d.onclick=_P)}Ii(w,k);var K;w=null;for($e in N)if(!k.hasOwnProperty($e)&&N.hasOwnProperty($e)&&N[$e]!=null)if($e==="style"){var ce=N[$e];for(K in ce)ce.hasOwnProperty(K)&&(w||(w={}),w[K]="")}else $e!=="dangerouslySetInnerHTML"&&$e!=="children"&&$e!=="suppressContentEditableWarning"&&$e!=="suppressHydrationWarning"&&$e!=="autoFocus"&&(i.hasOwnProperty($e)?L||(L=[]):(L=L||[]).push($e,null));for($e in k){var he=k[$e];if(ce=N?.[$e],k.hasOwnProperty($e)&&he!==ce&&(he!=null||ce!=null))if($e==="style")if(ce){for(K in ce)!ce.hasOwnProperty(K)||he&&he.hasOwnProperty(K)||(w||(w={}),w[K]="");for(K in he)he.hasOwnProperty(K)&&ce[K]!==he[K]&&(w||(w={}),w[K]=he[K])}else w||(L||(L=[]),L.push($e,w)),w=he;else $e==="dangerouslySetInnerHTML"?(he=he?he.__html:void 0,ce=ce?ce.__html:void 0,he!=null&&ce!==he&&(L=L||[]).push($e,he)):$e==="children"?typeof he!="string"&&typeof he!="number"||(L=L||[]).push($e,""+he):$e!=="suppressContentEditableWarning"&&$e!=="suppressHydrationWarning"&&(i.hasOwnProperty($e)?(he!=null&&$e==="onScroll"&&li("scroll",d),L||ce===he||(L=[])):(L=L||[]).push($e,he))}w&&(L=L||[]).push("style",w);var $e=L;(m.updateQueue=$e)&&(m.flags|=4)}},AY=function(d,m,w,k){w!==k&&(m.flags|=4)};function lE(d,m){if(!_i)switch(d.tailMode){case"hidden":m=d.tail;for(var w=null;m!==null;)m.alternate!==null&&(w=m),m=m.sibling;w===null?d.tail=null:w.sibling=null;break;case"collapsed":w=d.tail;for(var k=null;w!==null;)w.alternate!==null&&(k=w),w=w.sibling;k===null?m||d.tail===null?d.tail=null:d.tail.sibling=null:k.sibling=null}}function Go(d){var m=d.alternate!==null&&d.alternate.child===d.child,w=0,k=0;if(m)for(var N=d.child;N!==null;)w|=N.lanes|N.childLanes,k|=N.subtreeFlags&14680064,k|=N.flags&14680064,N.return=d,N=N.sibling;else for(N=d.child;N!==null;)w|=N.lanes|N.childLanes,k|=N.subtreeFlags,k|=N.flags,N.return=d,N=N.sibling;return d.subtreeFlags|=k,d.childLanes=w,m}function iTe(d,m,w){var k=m.pendingProps;switch(lD(m),m.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Go(m),null;case 1:return Ka(m.type)&&wP(),Go(m),null;case 3:return k=m.stateNode,Zv(),ci(qa),ci(Vo),wD(),k.pendingContext&&(k.context=k.pendingContext,k.pendingContext=null),(d===null||d.child===null)&&(kP(m)?m.flags|=4:d===null||d.memoizedState.isDehydrated&&(m.flags&256)===0||(m.flags|=1024,ku!==null&&(ZD(ku),ku=null))),VD(d,m),Go(m),null;case 5:_D(m);var N=k0(rE.current);if(w=m.type,d!==null&&m.stateNode!=null)kY(d,m,w,k,N),d.ref!==m.ref&&(m.flags|=512,m.flags|=2097152);else{if(!k){if(m.stateNode===null)throw Error(n(166));return Go(m),null}if(d=k0(zh.current),kP(m)){k=m.stateNode,w=m.type;var L=m.memoizedProps;switch(k[Vh]=m,k[Jb]=L,d=(m.mode&1)!==0,w){case"dialog":li("cancel",k),li("close",k);break;case"iframe":case"object":case"embed":li("load",k);break;case"video":case"audio":for(N=0;N<Yb.length;N++)li(Yb[N],k);break;case"source":li("error",k);break;case"img":case"image":case"link":li("error",k),li("load",k);break;case"details":li("toggle",k);break;case"input":pn(k,L),li("invalid",k);break;case"select":k._wrapperState={wasMultiple:!!L.multiple},li("invalid",k);break;case"textarea":Cr(k,L),li("invalid",k)}Ii(w,L),N=null;for(var K in L)if(L.hasOwnProperty(K)){var ce=L[K];K==="children"?typeof ce=="string"?k.textContent!==ce&&(L.suppressHydrationWarning!==!0&&vP(k.textContent,ce,d),N=["children",ce]):typeof ce=="number"&&k.textContent!==""+ce&&(L.suppressHydrationWarning!==!0&&vP(k.textContent,ce,d),N=["children",""+ce]):i.hasOwnProperty(K)&&ce!=null&&K==="onScroll"&&li("scroll",k)}switch(w){case"input":Dt(k),hr(k,L,!0);break;case"textarea":Dt(k),Ls(k);break;case"select":case"option":break;default:typeof L.onClick=="function"&&(k.onclick=_P)}k=N,m.updateQueue=k,k!==null&&(m.flags|=4)}else{K=N.nodeType===9?N:N.ownerDocument,d==="http://www.w3.org/1999/xhtml"&&(d=bt(w)),d==="http://www.w3.org/1999/xhtml"?w==="script"?(d=K.createElement("div"),d.innerHTML="<script><\/script>",d=d.removeChild(d.firstChild)):typeof k.is=="string"?d=K.createElement(w,{is:k.is}):(d=K.createElement(w),w==="select"&&(K=d,k.multiple?K.multiple=!0:k.size&&(K.size=k.size))):d=K.createElementNS(d,w),d[Vh]=m,d[Jb]=k,TY(d,m,!1,!1),m.stateNode=d;e:{switch(K=He(w,k),w){case"dialog":li("cancel",d),li("close",d),N=k;break;case"iframe":case"object":case"embed":li("load",d),N=k;break;case"video":case"audio":for(N=0;N<Yb.length;N++)li(Yb[N],d);N=k;break;case"source":li("error",d),N=k;break;case"img":case"image":case"link":li("error",d),li("load",d),N=k;break;case"details":li("toggle",d),N=k;break;case"input":pn(d,k),N=jt(d,k),li("invalid",d);break;case"option":N=k;break;case"select":d._wrapperState={wasMultiple:!!k.multiple},N=Ce({},k,{value:void 0}),li("invalid",d);break;case"textarea":Cr(d,k),N=_o(d,k),li("invalid",d);break;default:N=k}Ii(w,N),ce=N;for(L in ce)if(ce.hasOwnProperty(L)){var he=ce[L];L==="style"?Ds(d,he):L==="dangerouslySetInnerHTML"?(he=he?he.__html:void 0,he!=null&&Ft(d,he)):L==="children"?typeof he=="string"?(w!=="textarea"||he!=="")&&jn(d,he):typeof he=="number"&&jn(d,""+he):L!=="suppressContentEditableWarning"&&L!=="suppressHydrationWarning"&&L!=="autoFocus"&&(i.hasOwnProperty(L)?he!=null&&L==="onScroll"&&li("scroll",d):he!=null&&I(d,L,he,K))}switch(w){case"input":Dt(d),hr(d,k,!1);break;case"textarea":Dt(d),Ls(d);break;case"option":k.value!=null&&d.setAttribute("value",""+Ke(k.value));break;case"select":d.multiple=!!k.multiple,L=k.value,L!=null?ei(d,!!k.multiple,L,!1):k.defaultValue!=null&&ei(d,!!k.multiple,k.defaultValue,!0);break;default:typeof N.onClick=="function"&&(d.onclick=_P)}switch(w){case"button":case"input":case"select":case"textarea":k=!!k.autoFocus;break e;case"img":k=!0;break e;default:k=!1}}k&&(m.flags|=4)}m.ref!==null&&(m.flags|=512,m.flags|=2097152)}return Go(m),null;case 6:if(d&&m.stateNode!=null)AY(d,m,d.memoizedProps,k);else{if(typeof k!="string"&&m.stateNode===null)throw Error(n(166));if(w=k0(rE.current),k0(zh.current),kP(m)){if(k=m.stateNode,w=m.memoizedProps,k[Vh]=m,(L=k.nodeValue!==w)&&(d=zl,d!==null))switch(d.tag){case 3:vP(k.nodeValue,w,(d.mode&1)!==0);break;case 5:d.memoizedProps.suppressHydrationWarning!==!0&&vP(k.nodeValue,w,(d.mode&1)!==0)}L&&(m.flags|=4)}else k=(w.nodeType===9?w:w.ownerDocument).createTextNode(k),k[Vh]=m,m.stateNode=k}return Go(m),null;case 13:if(ci(Ci),k=m.memoizedState,d===null||d.memoizedState!==null&&d.memoizedState.dehydrated!==null){if(_i&&Gl!==null&&(m.mode&1)!==0&&(m.flags&128)===0)CK(),qv(),m.flags|=98560,L=!1;else if(L=kP(m),k!==null&&k.dehydrated!==null){if(d===null){if(!L)throw Error(n(318));if(L=m.memoizedState,L=L!==null?L.dehydrated:null,!L)throw Error(n(317));L[Vh]=m}else qv(),(m.flags&128)===0&&(m.memoizedState=null),m.flags|=4;Go(m),L=!1}else ku!==null&&(ZD(ku),ku=null),L=!0;if(!L)return m.flags&65536?m:null}return(m.flags&128)!==0?(m.lanes=w,m):(k=k!==null,k!==(d!==null&&d.memoizedState!==null)&&k&&(m.child.flags|=8192,(m.mode&1)!==0&&(d===null||(Ci.current&1)!==0?$s===0&&($s=3):e6())),m.updateQueue!==null&&(m.flags|=4),Go(m),null);case 4:return Zv(),VD(d,m),d===null&&Xb(m.stateNode.containerInfo),Go(m),null;case 10:return pD(m.type._context),Go(m),null;case 17:return Ka(m.type)&&wP(),Go(m),null;case 19:if(ci(Ci),L=m.memoizedState,L===null)return Go(m),null;if(k=(m.flags&128)!==0,K=L.rendering,K===null)if(k)lE(L,!1);else{if($s!==0||d!==null&&(d.flags&128)!==0)for(d=m.child;d!==null;){if(K=MP(d),K!==null){for(m.flags|=128,lE(L,!1),k=K.updateQueue,k!==null&&(m.updateQueue=k,m.flags|=4),m.subtreeFlags=0,k=w,w=m.child;w!==null;)L=w,d=k,L.flags&=14680066,K=L.alternate,K===null?(L.childLanes=0,L.lanes=d,L.child=null,L.subtreeFlags=0,L.memoizedProps=null,L.memoizedState=null,L.updateQueue=null,L.dependencies=null,L.stateNode=null):(L.childLanes=K.childLanes,L.lanes=K.lanes,L.child=K.child,L.subtreeFlags=0,L.deletions=null,L.memoizedProps=K.memoizedProps,L.memoizedState=K.memoizedState,L.updateQueue=K.updateQueue,L.type=K.type,d=K.dependencies,L.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext}),w=w.sibling;return oi(Ci,Ci.current&1|2),m.child}d=d.sibling}L.tail!==null&&ut()>t_&&(m.flags|=128,k=!0,lE(L,!1),m.lanes=4194304)}else{if(!k)if(d=MP(K),d!==null){if(m.flags|=128,k=!0,w=d.updateQueue,w!==null&&(m.updateQueue=w,m.flags|=4),lE(L,!0),L.tail===null&&L.tailMode==="hidden"&&!K.alternate&&!_i)return Go(m),null}else 2*ut()-L.renderingStartTime>t_&&w!==1073741824&&(m.flags|=128,k=!0,lE(L,!1),m.lanes=4194304);L.isBackwards?(K.sibling=m.child,m.child=K):(w=L.last,w!==null?w.sibling=K:m.child=K,L.last=K)}return L.tail!==null?(m=L.tail,L.rendering=m,L.tail=m.sibling,L.renderingStartTime=ut(),m.sibling=null,w=Ci.current,oi(Ci,k?w&1|2:w&1),m):(Go(m),null);case 22:case 23:return QD(),k=m.memoizedState!==null,d!==null&&d.memoizedState!==null!==k&&(m.flags|=8192),k&&(m.mode&1)!==0?(Ul&1073741824)!==0&&(Go(m),m.subtreeFlags&6&&(m.flags|=8192)):Go(m),null;case 24:return null;case 25:return null}throw Error(n(156,m.tag))}function sTe(d,m){switch(lD(m),m.tag){case 1:return Ka(m.type)&&wP(),d=m.flags,d&65536?(m.flags=d&-65537|128,m):null;case 3:return Zv(),ci(qa),ci(Vo),wD(),d=m.flags,(d&65536)!==0&&(d&128)===0?(m.flags=d&-65537|128,m):null;case 5:return _D(m),null;case 13:if(ci(Ci),d=m.memoizedState,d!==null&&d.dehydrated!==null){if(m.alternate===null)throw Error(n(340));qv()}return d=m.flags,d&65536?(m.flags=d&-65537|128,m):null;case 19:return ci(Ci),null;case 4:return Zv(),null;case 10:return pD(m.type._context),null;case 22:case 23:return QD(),null;case 24:return null;default:return null}}var zP=!1,Uo=!1,oTe=typeof WeakSet=="function"?WeakSet:Set,$t=null;function Qv(d,m){var w=d.ref;if(w!==null)if(typeof w=="function")try{w(null)}catch(k){Ui(d,m,k)}else w.current=null}function zD(d,m,w){try{w()}catch(k){Ui(d,m,k)}}var IY=!1;function aTe(d,m){if(QL=Yd,d=oK(),WL(d)){if("selectionStart"in d)var w={start:d.selectionStart,end:d.selectionEnd};else e:{w=(w=d.ownerDocument)&&w.defaultView||window;var k=w.getSelection&&w.getSelection();if(k&&k.rangeCount!==0){w=k.anchorNode;var N=k.anchorOffset,L=k.focusNode;k=k.focusOffset;try{w.nodeType,L.nodeType}catch{w=null;break e}var K=0,ce=-1,he=-1,$e=0,ot=0,ht=d,rt=null;t:for(;;){for(var Nt;ht!==w||N!==0&&ht.nodeType!==3||(ce=K+N),ht!==L||k!==0&&ht.nodeType!==3||(he=K+k),ht.nodeType===3&&(K+=ht.nodeValue.length),(Nt=ht.firstChild)!==null;)rt=ht,ht=Nt;for(;;){if(ht===d)break t;if(rt===w&&++$e===N&&(ce=K),rt===L&&++ot===k&&(he=K),(Nt=ht.nextSibling)!==null)break;ht=rt,rt=ht.parentNode}ht=Nt}w=ce===-1||he===-1?null:{start:ce,end:he}}else w=null}w=w||{start:0,end:0}}else w=null;for(eD={focusedElem:d,selectionRange:w},Yd=!1,$t=m;$t!==null;)if(m=$t,d=m.child,(m.subtreeFlags&1028)!==0&&d!==null)d.return=m,$t=d;else for(;$t!==null;){m=$t;try{var Gt=m.alternate;if((m.flags&1024)!==0)switch(m.tag){case 0:case 11:case 15:break;case 1:if(Gt!==null){var Yt=Gt.memoizedProps,as=Gt.memoizedState,be=m.stateNode,me=be.getSnapshotBeforeUpdate(m.elementType===m.type?Yt:Au(m.type,Yt),as);be.__reactInternalSnapshotBeforeUpdate=me}break;case 3:var Me=m.stateNode.containerInfo;Me.nodeType===1?Me.textContent="":Me.nodeType===9&&Me.documentElement&&Me.removeChild(Me.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(n(163))}}catch(mt){Ui(m,m.return,mt)}if(d=m.sibling,d!==null){d.return=m.return,$t=d;break}$t=m.return}return Gt=IY,IY=!1,Gt}function cE(d,m,w){var k=m.updateQueue;if(k=k!==null?k.lastEffect:null,k!==null){var N=k=k.next;do{if((N.tag&d)===d){var L=N.destroy;N.destroy=void 0,L!==void 0&&zD(m,w,L)}N=N.next}while(N!==k)}}function GP(d,m){if(m=m.updateQueue,m=m!==null?m.lastEffect:null,m!==null){var w=m=m.next;do{if((w.tag&d)===d){var k=w.create;w.destroy=k()}w=w.next}while(w!==m)}}function GD(d){var m=d.ref;if(m!==null){var w=d.stateNode;switch(d.tag){case 5:d=w;break;default:d=w}typeof m=="function"?m(d):m.current=d}}function PY(d){var m=d.alternate;m!==null&&(d.alternate=null,PY(m)),d.child=null,d.deletions=null,d.sibling=null,d.tag===5&&(m=d.stateNode,m!==null&&(delete m[Vh],delete m[Jb],delete m[iD],delete m[USe],delete m[BSe])),d.stateNode=null,d.return=null,d.dependencies=null,d.memoizedProps=null,d.memoizedState=null,d.pendingProps=null,d.stateNode=null,d.updateQueue=null}function CY(d){return d.tag===5||d.tag===3||d.tag===4}function RY(d){e:for(;;){for(;d.sibling===null;){if(d.return===null||CY(d.return))return null;d=d.return}for(d.sibling.return=d.return,d=d.sibling;d.tag!==5&&d.tag!==6&&d.tag!==18;){if(d.flags&2||d.child===null||d.tag===4)continue e;d.child.return=d,d=d.child}if(!(d.flags&2))return d.stateNode}}function UD(d,m,w){var k=d.tag;if(k===5||k===6)d=d.stateNode,m?w.nodeType===8?w.parentNode.insertBefore(d,m):w.insertBefore(d,m):(w.nodeType===8?(m=w.parentNode,m.insertBefore(d,w)):(m=w,m.appendChild(d)),w=w._reactRootContainer,w!=null||m.onclick!==null||(m.onclick=_P));else if(k!==4&&(d=d.child,d!==null))for(UD(d,m,w),d=d.sibling;d!==null;)UD(d,m,w),d=d.sibling}function BD(d,m,w){var k=d.tag;if(k===5||k===6)d=d.stateNode,m?w.insertBefore(d,m):w.appendChild(d);else if(k!==4&&(d=d.child,d!==null))for(BD(d,m,w),d=d.sibling;d!==null;)BD(d,m,w),d=d.sibling}var bo=null,Iu=!1;function Wp(d,m,w){for(w=w.child;w!==null;)MY(d,m,w),w=w.sibling}function MY(d,m,w){if(ss&&typeof ss.onCommitFiberUnmount=="function")try{ss.onCommitFiberUnmount(Dl,w)}catch{}switch(w.tag){case 5:Uo||Qv(w,m);case 6:var k=bo,N=Iu;bo=null,Wp(d,m,w),bo=k,Iu=N,bo!==null&&(Iu?(d=bo,w=w.stateNode,d.nodeType===8?d.parentNode.removeChild(w):d.removeChild(w)):bo.removeChild(w.stateNode));break;case 18:bo!==null&&(Iu?(d=bo,w=w.stateNode,d.nodeType===8?rD(d.parentNode,w):d.nodeType===1&&rD(d,w),Lp(d)):rD(bo,w.stateNode));break;case 4:k=bo,N=Iu,bo=w.stateNode.containerInfo,Iu=!0,Wp(d,m,w),bo=k,Iu=N;break;case 0:case 11:case 14:case 15:if(!Uo&&(k=w.updateQueue,k!==null&&(k=k.lastEffect,k!==null))){N=k=k.next;do{var L=N,K=L.destroy;L=L.tag,K!==void 0&&((L&2)!==0||(L&4)!==0)&&zD(w,m,K),N=N.next}while(N!==k)}Wp(d,m,w);break;case 1:if(!Uo&&(Qv(w,m),k=w.stateNode,typeof k.componentWillUnmount=="function"))try{k.props=w.memoizedProps,k.state=w.memoizedState,k.componentWillUnmount()}catch(ce){Ui(w,m,ce)}Wp(d,m,w);break;case 21:Wp(d,m,w);break;case 22:w.mode&1?(Uo=(k=Uo)||w.memoizedState!==null,Wp(d,m,w),Uo=k):Wp(d,m,w);break;default:Wp(d,m,w)}}function NY(d){var m=d.updateQueue;if(m!==null){d.updateQueue=null;var w=d.stateNode;w===null&&(w=d.stateNode=new oTe),m.forEach(function(k){var N=gTe.bind(null,d,k);w.has(k)||(w.add(k),k.then(N,N))})}}function Pu(d,m){var w=m.deletions;if(w!==null)for(var k=0;k<w.length;k++){var N=w[k];try{var L=d,K=m,ce=K;e:for(;ce!==null;){switch(ce.tag){case 5:bo=ce.stateNode,Iu=!1;break e;case 3:bo=ce.stateNode.containerInfo,Iu=!0;break e;case 4:bo=ce.stateNode.containerInfo,Iu=!0;break e}ce=ce.return}if(bo===null)throw Error(n(160));MY(L,K,N),bo=null,Iu=!1;var he=N.alternate;he!==null&&(he.return=null),N.return=null}catch($e){Ui(N,m,$e)}}if(m.subtreeFlags&12854)for(m=m.child;m!==null;)OY(m,d),m=m.sibling}function OY(d,m){var w=d.alternate,k=d.flags;switch(d.tag){case 0:case 11:case 14:case 15:if(Pu(m,d),Uh(d),k&4){try{cE(3,d,d.return),GP(3,d)}catch(Yt){Ui(d,d.return,Yt)}try{cE(5,d,d.return)}catch(Yt){Ui(d,d.return,Yt)}}break;case 1:Pu(m,d),Uh(d),k&512&&w!==null&&Qv(w,w.return);break;case 5:if(Pu(m,d),Uh(d),k&512&&w!==null&&Qv(w,w.return),d.flags&32){var N=d.stateNode;try{jn(N,"")}catch(Yt){Ui(d,d.return,Yt)}}if(k&4&&(N=d.stateNode,N!=null)){var L=d.memoizedProps,K=w!==null?w.memoizedProps:L,ce=d.type,he=d.updateQueue;if(d.updateQueue=null,he!==null)try{ce==="input"&&L.type==="radio"&&L.name!=null&&_n(N,L),He(ce,K);var $e=He(ce,L);for(K=0;K<he.length;K+=2){var ot=he[K],ht=he[K+1];ot==="style"?Ds(N,ht):ot==="dangerouslySetInnerHTML"?Ft(N,ht):ot==="children"?jn(N,ht):I(N,ot,ht,$e)}switch(ce){case"input":dt(N,L);break;case"textarea":Ai(N,L);break;case"select":var rt=N._wrapperState.wasMultiple;N._wrapperState.wasMultiple=!!L.multiple;var Nt=L.value;Nt!=null?ei(N,!!L.multiple,Nt,!1):rt!==!!L.multiple&&(L.defaultValue!=null?ei(N,!!L.multiple,L.defaultValue,!0):ei(N,!!L.multiple,L.multiple?[]:"",!1))}N[Jb]=L}catch(Yt){Ui(d,d.return,Yt)}}break;case 6:if(Pu(m,d),Uh(d),k&4){if(d.stateNode===null)throw Error(n(162));N=d.stateNode,L=d.memoizedProps;try{N.nodeValue=L}catch(Yt){Ui(d,d.return,Yt)}}break;case 3:if(Pu(m,d),Uh(d),k&4&&w!==null&&w.memoizedState.isDehydrated)try{Lp(m.containerInfo)}catch(Yt){Ui(d,d.return,Yt)}break;case 4:Pu(m,d),Uh(d);break;case 13:Pu(m,d),Uh(d),N=d.child,N.flags&8192&&(L=N.memoizedState!==null,N.stateNode.isHidden=L,!L||N.alternate!==null&&N.alternate.memoizedState!==null||(qD=ut())),k&4&&NY(d);break;case 22:if(ot=w!==null&&w.memoizedState!==null,d.mode&1?(Uo=($e=Uo)||ot,Pu(m,d),Uo=$e):Pu(m,d),Uh(d),k&8192){if($e=d.memoizedState!==null,(d.stateNode.isHidden=$e)&&!ot&&(d.mode&1)!==0)for($t=d,ot=d.child;ot!==null;){for(ht=$t=ot;$t!==null;){switch(rt=$t,Nt=rt.child,rt.tag){case 0:case 11:case 14:case 15:cE(4,rt,rt.return);break;case 1:Qv(rt,rt.return);var Gt=rt.stateNode;if(typeof Gt.componentWillUnmount=="function"){k=rt,w=rt.return;try{m=k,Gt.props=m.memoizedProps,Gt.state=m.memoizedState,Gt.componentWillUnmount()}catch(Yt){Ui(k,w,Yt)}}break;case 5:Qv(rt,rt.return);break;case 22:if(rt.memoizedState!==null){jY(ht);continue}}Nt!==null?(Nt.return=rt,$t=Nt):jY(ht)}ot=ot.sibling}e:for(ot=null,ht=d;;){if(ht.tag===5){if(ot===null){ot=ht;try{N=ht.stateNode,$e?(L=N.style,typeof L.setProperty=="function"?L.setProperty("display","none","important"):L.display="none"):(ce=ht.stateNode,he=ht.memoizedProps.style,K=he!=null&&he.hasOwnProperty("display")?he.display:null,ce.style.display=Gi("display",K))}catch(Yt){Ui(d,d.return,Yt)}}}else if(ht.tag===6){if(ot===null)try{ht.stateNode.nodeValue=$e?"":ht.memoizedProps}catch(Yt){Ui(d,d.return,Yt)}}else if((ht.tag!==22&&ht.tag!==23||ht.memoizedState===null||ht===d)&&ht.child!==null){ht.child.return=ht,ht=ht.child;continue}if(ht===d)break e;for(;ht.sibling===null;){if(ht.return===null||ht.return===d)break e;ot===ht&&(ot=null),ht=ht.return}ot===ht&&(ot=null),ht.sibling.return=ht.return,ht=ht.sibling}}break;case 19:Pu(m,d),Uh(d),k&4&&NY(d);break;case 21:break;default:Pu(m,d),Uh(d)}}function Uh(d){var m=d.flags;if(m&2){try{e:{for(var w=d.return;w!==null;){if(CY(w)){var k=w;break e}w=w.return}throw Error(n(160))}switch(k.tag){case 5:var N=k.stateNode;k.flags&32&&(jn(N,""),k.flags&=-33);var L=RY(d);BD(d,L,N);break;case 3:case 4:var K=k.stateNode.containerInfo,ce=RY(d);UD(d,ce,K);break;default:throw Error(n(161))}}catch(he){Ui(d,d.return,he)}d.flags&=-3}m&4096&&(d.flags&=-4097)}function lTe(d,m,w){$t=d,LY(d)}function LY(d,m,w){for(var k=(d.mode&1)!==0;$t!==null;){var N=$t,L=N.child;if(N.tag===22&&k){var K=N.memoizedState!==null||zP;if(!K){var ce=N.alternate,he=ce!==null&&ce.memoizedState!==null||Uo;ce=zP;var $e=Uo;if(zP=K,(Uo=he)&&!$e)for($t=N;$t!==null;)K=$t,he=K.child,K.tag===22&&K.memoizedState!==null?$Y(N):he!==null?(he.return=K,$t=he):$Y(N);for(;L!==null;)$t=L,LY(L),L=L.sibling;$t=N,zP=ce,Uo=$e}DY(d)}else(N.subtreeFlags&8772)!==0&&L!==null?(L.return=N,$t=L):DY(d)}}function DY(d){for(;$t!==null;){var m=$t;if((m.flags&8772)!==0){var w=m.alternate;try{if((m.flags&8772)!==0)switch(m.tag){case 0:case 11:case 15:Uo||GP(5,m);break;case 1:var k=m.stateNode;if(m.flags&4&&!Uo)if(w===null)k.componentDidMount();else{var N=m.elementType===m.type?w.memoizedProps:Au(m.type,w.memoizedProps);k.componentDidUpdate(N,w.memoizedState,k.__reactInternalSnapshotBeforeUpdate)}var L=m.updateQueue;L!==null&&jK(m,L,k);break;case 3:var K=m.updateQueue;if(K!==null){if(w=null,m.child!==null)switch(m.child.tag){case 5:w=m.child.stateNode;break;case 1:w=m.child.stateNode}jK(m,K,w)}break;case 5:var ce=m.stateNode;if(w===null&&m.flags&4){w=ce;var he=m.memoizedProps;switch(m.type){case"button":case"input":case"select":case"textarea":he.autoFocus&&w.focus();break;case"img":he.src&&(w.src=he.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(m.memoizedState===null){var $e=m.alternate;if($e!==null){var ot=$e.memoizedState;if(ot!==null){var ht=ot.dehydrated;ht!==null&&Lp(ht)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(n(163))}Uo||m.flags&512&&GD(m)}catch(rt){Ui(m,m.return,rt)}}if(m===d){$t=null;break}if(w=m.sibling,w!==null){w.return=m.return,$t=w;break}$t=m.return}}function jY(d){for(;$t!==null;){var m=$t;if(m===d){$t=null;break}var w=m.sibling;if(w!==null){w.return=m.return,$t=w;break}$t=m.return}}function $Y(d){for(;$t!==null;){var m=$t;try{switch(m.tag){case 0:case 11:case 15:var w=m.return;try{GP(4,m)}catch(he){Ui(m,w,he)}break;case 1:var k=m.stateNode;if(typeof k.componentDidMount=="function"){var N=m.return;try{k.componentDidMount()}catch(he){Ui(m,N,he)}}var L=m.return;try{GD(m)}catch(he){Ui(m,L,he)}break;case 5:var K=m.return;try{GD(m)}catch(he){Ui(m,K,he)}}}catch(he){Ui(m,m.return,he)}if(m===d){$t=null;break}var ce=m.sibling;if(ce!==null){ce.return=m.return,$t=ce;break}$t=m.return}}var cTe=Math.ceil,UP=P.ReactCurrentDispatcher,WD=P.ReactCurrentOwner,Rc=P.ReactCurrentBatchConfig,fr=0,Qs=null,ys=null,Eo=0,Ul=0,e_=Vp(0),$s=0,uE=null,I0=0,BP=0,HD=0,hE=null,Xa=null,qD=0,t_=1/0,of=null,WP=!1,KD=null,Hp=null,HP=!1,qp=null,qP=0,dE=0,YD=null,KP=-1,YP=0;function Ea(){return(fr&6)!==0?ut():KP!==-1?KP:KP=ut()}function Kp(d){return(d.mode&1)===0?1:(fr&2)!==0&&Eo!==0?Eo&-Eo:HSe.transition!==null?(YP===0&&(YP=Nb()),YP):(d=sr,d!==0||(d=window.event,d=d===void 0?16:Cv(d.type)),d)}function Cu(d,m,w,k){if(50<dE)throw dE=0,YD=null,Error(n(185));g0(d,w,k),((fr&2)===0||d!==Qs)&&(d===Qs&&((fr&2)===0&&(BP|=w),$s===4&&Yp(d,Eo)),Za(d,k),w===1&&fr===0&&(m.mode&1)===0&&(t_=ut()+500,EP&&Gp()))}function Za(d,m){var w=d.callbackNode;m0(d,m);var k=Hd(d,d===Qs?Eo:0);if(k===0)w!==null&&gt(w),d.callbackNode=null,d.callbackPriority=0;else if(m=k&-k,d.callbackPriority!==m){if(w!=null&&gt(w),m===1)d.tag===0?WSe(VY.bind(null,d)):TK(VY.bind(null,d)),zSe(function(){(fr&6)===0&&Gp()}),w=null;else{switch(Ch(k)){case 1:w=Rr;break;case 4:w=jr;break;case 16:w=vi;break;case 536870912:w=Tc;break;default:w=vi}w=KY(w,FY.bind(null,d))}d.callbackPriority=m,d.callbackNode=w}}function FY(d,m){if(KP=-1,YP=0,(fr&6)!==0)throw Error(n(327));var w=d.callbackNode;if(n_()&&d.callbackNode!==w)return null;var k=Hd(d,d===Qs?Eo:0);if(k===0)return null;if((k&30)!==0||(k&d.expiredLanes)!==0||m)m=XP(d,k);else{m=k;var N=fr;fr|=2;var L=GY();(Qs!==d||Eo!==m)&&(of=null,t_=ut()+500,C0(d,m));do try{dTe();break}catch(ce){zY(d,ce)}while(!0);fD(),UP.current=L,fr=N,ys!==null?m=0:(Qs=null,Eo=0,m=$s)}if(m!==0){if(m===2&&(N=Mb(d),N!==0&&(k=N,m=XD(d,N))),m===1)throw w=uE,C0(d,0),Yp(d,k),Za(d,ut()),w;if(m===6)Yp(d,k);else{if(N=d.current.alternate,(k&30)===0&&!uTe(N)&&(m=XP(d,k),m===2&&(L=Mb(d),L!==0&&(k=L,m=XD(d,L))),m===1))throw w=uE,C0(d,0),Yp(d,k),Za(d,ut()),w;switch(d.finishedWork=N,d.finishedLanes=k,m){case 0:case 1:throw Error(n(345));case 2:R0(d,Xa,of);break;case 3:if(Yp(d,k),(k&130023424)===k&&(m=qD+500-ut(),10<m)){if(Hd(d,0)!==0)break;if(N=d.suspendedLanes,(N&k)!==k){Ea(),d.pingedLanes|=d.suspendedLanes&N;break}d.timeoutHandle=nD(R0.bind(null,d,Xa,of),m);break}R0(d,Xa,of);break;case 4:if(Yp(d,k),(k&4194240)===k)break;for(m=d.eventTimes,N=-1;0<k;){var K=31-Pi(k);L=1<<K,K=m[K],K>N&&(N=K),k&=~L}if(k=N,k=ut()-k,k=(120>k?120:480>k?480:1080>k?1080:1920>k?1920:3e3>k?3e3:4320>k?4320:1960*cTe(k/1960))-k,10<k){d.timeoutHandle=nD(R0.bind(null,d,Xa,of),k);break}R0(d,Xa,of);break;case 5:R0(d,Xa,of);break;default:throw Error(n(329))}}}return Za(d,ut()),d.callbackNode===w?FY.bind(null,d):null}function XD(d,m){var w=hE;return d.current.memoizedState.isDehydrated&&(C0(d,m).flags|=256),d=XP(d,m),d!==2&&(m=Xa,Xa=w,m!==null&&ZD(m)),d}function ZD(d){Xa===null?Xa=d:Xa.push.apply(Xa,d)}function uTe(d){for(var m=d;;){if(m.flags&16384){var w=m.updateQueue;if(w!==null&&(w=w.stores,w!==null))for(var k=0;k<w.length;k++){var N=w[k],L=N.getSnapshot;N=N.value;try{if(!Tu(L(),N))return!1}catch{return!1}}}if(w=m.child,m.subtreeFlags&16384&&w!==null)w.return=m,m=w;else{if(m===d)break;for(;m.sibling===null;){if(m.return===null||m.return===d)return!0;m=m.return}m.sibling.return=m.return,m=m.sibling}}return!0}function Yp(d,m){for(m&=~HD,m&=~BP,d.suspendedLanes|=m,d.pingedLanes&=~m,d=d.expirationTimes;0<m;){var w=31-Pi(m),k=1<<w;d[w]=-1,m&=~k}}function VY(d){if((fr&6)!==0)throw Error(n(327));n_();var m=Hd(d,0);if((m&1)===0)return Za(d,ut()),null;var w=XP(d,m);if(d.tag!==0&&w===2){var k=Mb(d);k!==0&&(m=k,w=XD(d,k))}if(w===1)throw w=uE,C0(d,0),Yp(d,m),Za(d,ut()),w;if(w===6)throw Error(n(345));return d.finishedWork=d.current.alternate,d.finishedLanes=m,R0(d,Xa,of),Za(d,ut()),null}function JD(d,m){var w=fr;fr|=1;try{return d(m)}finally{fr=w,fr===0&&(t_=ut()+500,EP&&Gp())}}function P0(d){qp!==null&&qp.tag===0&&(fr&6)===0&&n_();var m=fr;fr|=1;var w=Rc.transition,k=sr;try{if(Rc.transition=null,sr=1,d)return d()}finally{sr=k,Rc.transition=w,fr=m,(fr&6)===0&&Gp()}}function QD(){Ul=e_.current,ci(e_)}function C0(d,m){d.finishedWork=null,d.finishedLanes=0;var w=d.timeoutHandle;if(w!==-1&&(d.timeoutHandle=-1,VSe(w)),ys!==null)for(w=ys.return;w!==null;){var k=w;switch(lD(k),k.tag){case 1:k=k.type.childContextTypes,k!=null&&wP();break;case 3:Zv(),ci(qa),ci(Vo),wD();break;case 5:_D(k);break;case 4:Zv();break;case 13:ci(Ci);break;case 19:ci(Ci);break;case 10:pD(k.type._context);break;case 22:case 23:QD()}w=w.return}if(Qs=d,ys=d=Xp(d.current,null),Eo=Ul=m,$s=0,uE=null,HD=BP=I0=0,Xa=hE=null,T0!==null){for(m=0;m<T0.length;m++)if(w=T0[m],k=w.interleaved,k!==null){w.interleaved=null;var N=k.next,L=w.pending;if(L!==null){var K=L.next;L.next=N,k.next=K}w.pending=k}T0=null}return d}function zY(d,m){do{var w=ys;try{if(fD(),NP.current=jP,OP){for(var k=Ri.memoizedState;k!==null;){var N=k.queue;N!==null&&(N.pending=null),k=k.next}OP=!1}if(A0=0,Js=js=Ri=null,iE=!1,sE=0,WD.current=null,w===null||w.return===null){$s=1,uE=m,ys=null;break}e:{var L=d,K=w.return,ce=w,he=m;if(m=Eo,ce.flags|=32768,he!==null&&typeof he=="object"&&typeof he.then=="function"){var $e=he,ot=ce,ht=ot.tag;if((ot.mode&1)===0&&(ht===0||ht===11||ht===15)){var rt=ot.alternate;rt?(ot.updateQueue=rt.updateQueue,ot.memoizedState=rt.memoizedState,ot.lanes=rt.lanes):(ot.updateQueue=null,ot.memoizedState=null)}var Nt=dY(K);if(Nt!==null){Nt.flags&=-257,fY(Nt,K,ce,L,m),Nt.mode&1&&hY(L,$e,m),m=Nt,he=$e;var Gt=m.updateQueue;if(Gt===null){var Yt=new Set;Yt.add(he),m.updateQueue=Yt}else Gt.add(he);break e}else{if((m&1)===0){hY(L,$e,m),e6();break e}he=Error(n(426))}}else if(_i&&ce.mode&1){var as=dY(K);if(as!==null){(as.flags&65536)===0&&(as.flags|=256),fY(as,K,ce,L,m),hD(Jv(he,ce));break e}}L=he=Jv(he,ce),$s!==4&&($s=2),hE===null?hE=[L]:hE.push(L),L=K;do{switch(L.tag){case 3:L.flags|=65536,m&=-m,L.lanes|=m;var be=cY(L,he,m);DK(L,be);break e;case 1:ce=he;var me=L.type,Me=L.stateNode;if((L.flags&128)===0&&(typeof me.getDerivedStateFromError=="function"||Me!==null&&typeof Me.componentDidCatch=="function"&&(Hp===null||!Hp.has(Me)))){L.flags|=65536,m&=-m,L.lanes|=m;var mt=uY(L,ce,m);DK(L,mt);break e}}L=L.return}while(L!==null)}BY(w)}catch(Zt){m=Zt,ys===w&&w!==null&&(ys=w=w.return);continue}break}while(!0)}function GY(){var d=UP.current;return UP.current=jP,d===null?jP:d}function e6(){($s===0||$s===3||$s===2)&&($s=4),Qs===null||(I0&268435455)===0&&(BP&268435455)===0||Yp(Qs,Eo)}function XP(d,m){var w=fr;fr|=2;var k=GY();(Qs!==d||Eo!==m)&&(of=null,C0(d,m));do try{hTe();break}catch(N){zY(d,N)}while(!0);if(fD(),fr=w,UP.current=k,ys!==null)throw Error(n(261));return Qs=null,Eo=0,$s}function hTe(){for(;ys!==null;)UY(ys)}function dTe(){for(;ys!==null&&!Ct();)UY(ys)}function UY(d){var m=qY(d.alternate,d,Ul);d.memoizedProps=d.pendingProps,m===null?BY(d):ys=m,WD.current=null}function BY(d){var m=d;do{var w=m.alternate;if(d=m.return,(m.flags&32768)===0){if(w=iTe(w,m,Ul),w!==null){ys=w;return}}else{if(w=sTe(w,m),w!==null){w.flags&=32767,ys=w;return}if(d!==null)d.flags|=32768,d.subtreeFlags=0,d.deletions=null;else{$s=6,ys=null;return}}if(m=m.sibling,m!==null){ys=m;return}ys=m=d}while(m!==null);$s===0&&($s=5)}function R0(d,m,w){var k=sr,N=Rc.transition;try{Rc.transition=null,sr=1,fTe(d,m,w,k)}finally{Rc.transition=N,sr=k}return null}function fTe(d,m,w,k){do n_();while(qp!==null);if((fr&6)!==0)throw Error(n(327));w=d.finishedWork;var N=d.finishedLanes;if(w===null)return null;if(d.finishedWork=null,d.finishedLanes=0,w===d.current)throw Error(n(177));d.callbackNode=null,d.callbackPriority=0;var L=w.lanes|w.childLanes;if(VL(d,L),d===Qs&&(ys=Qs=null,Eo=0),(w.subtreeFlags&2064)===0&&(w.flags&2064)===0||HP||(HP=!0,KY(vi,function(){return n_(),null})),L=(w.flags&15990)!==0,(w.subtreeFlags&15990)!==0||L){L=Rc.transition,Rc.transition=null;var K=sr;sr=1;var ce=fr;fr|=4,WD.current=null,aTe(d,w),OY(w,d),NSe(eD),Yd=!!QL,eD=QL=null,d.current=w,lTe(w),ct(),fr=ce,sr=K,Rc.transition=L}else d.current=w;if(HP&&(HP=!1,qp=d,qP=N),L=d.pendingLanes,L===0&&(Hp=null),Rp(w.stateNode),Za(d,ut()),m!==null)for(k=d.onRecoverableError,w=0;w<m.length;w++)N=m[w],k(N.value,{componentStack:N.stack,digest:N.digest});if(WP)throw WP=!1,d=KD,KD=null,d;return(qP&1)!==0&&d.tag!==0&&n_(),L=d.pendingLanes,(L&1)!==0?d===YD?dE++:(dE=0,YD=d):dE=0,Gp(),null}function n_(){if(qp!==null){var d=Ch(qP),m=Rc.transition,w=sr;try{if(Rc.transition=null,sr=16>d?16:d,qp===null)var k=!1;else{if(d=qp,qp=null,qP=0,(fr&6)!==0)throw Error(n(331));var N=fr;for(fr|=4,$t=d.current;$t!==null;){var L=$t,K=L.child;if(($t.flags&16)!==0){var ce=L.deletions;if(ce!==null){for(var he=0;he<ce.length;he++){var $e=ce[he];for($t=$e;$t!==null;){var ot=$t;switch(ot.tag){case 0:case 11:case 15:cE(8,ot,L)}var ht=ot.child;if(ht!==null)ht.return=ot,$t=ht;else for(;$t!==null;){ot=$t;var rt=ot.sibling,Nt=ot.return;if(PY(ot),ot===$e){$t=null;break}if(rt!==null){rt.return=Nt,$t=rt;break}$t=Nt}}}var Gt=L.alternate;if(Gt!==null){var Yt=Gt.child;if(Yt!==null){Gt.child=null;do{var as=Yt.sibling;Yt.sibling=null,Yt=as}while(Yt!==null)}}$t=L}}if((L.subtreeFlags&2064)!==0&&K!==null)K.return=L,$t=K;else e:for(;$t!==null;){if(L=$t,(L.flags&2048)!==0)switch(L.tag){case 0:case 11:case 15:cE(9,L,L.return)}var be=L.sibling;if(be!==null){be.return=L.return,$t=be;break e}$t=L.return}}var me=d.current;for($t=me;$t!==null;){K=$t;var Me=K.child;if((K.subtreeFlags&2064)!==0&&Me!==null)Me.return=K,$t=Me;else e:for(K=me;$t!==null;){if(ce=$t,(ce.flags&2048)!==0)try{switch(ce.tag){case 0:case 11:case 15:GP(9,ce)}}catch(Zt){Ui(ce,ce.return,Zt)}if(ce===K){$t=null;break e}var mt=ce.sibling;if(mt!==null){mt.return=ce.return,$t=mt;break e}$t=ce.return}}if(fr=N,Gp(),ss&&typeof ss.onPostCommitFiberRoot=="function")try{ss.onPostCommitFiberRoot(Dl,d)}catch{}k=!0}return k}finally{sr=w,Rc.transition=m}}return!1}function WY(d,m,w){m=Jv(w,m),m=cY(d,m,1),d=Bp(d,m,1),m=Ea(),d!==null&&(g0(d,1,m),Za(d,m))}function Ui(d,m,w){if(d.tag===3)WY(d,d,w);else for(;m!==null;){if(m.tag===3){WY(m,d,w);break}else if(m.tag===1){var k=m.stateNode;if(typeof m.type.getDerivedStateFromError=="function"||typeof k.componentDidCatch=="function"&&(Hp===null||!Hp.has(k))){d=Jv(w,d),d=uY(m,d,1),m=Bp(m,d,1),d=Ea(),m!==null&&(g0(m,1,d),Za(m,d));break}}m=m.return}}function pTe(d,m,w){var k=d.pingCache;k!==null&&k.delete(m),m=Ea(),d.pingedLanes|=d.suspendedLanes&w,Qs===d&&(Eo&w)===w&&($s===4||$s===3&&(Eo&130023424)===Eo&&500>ut()-qD?C0(d,0):HD|=w),Za(d,m)}function HY(d,m){m===0&&((d.mode&1)===0?m=1:(m=Mp,Mp<<=1,(Mp&130023424)===0&&(Mp=4194304)));var w=Ea();d=nf(d,m),d!==null&&(g0(d,m,w),Za(d,w))}function mTe(d){var m=d.memoizedState,w=0;m!==null&&(w=m.retryLane),HY(d,w)}function gTe(d,m){var w=0;switch(d.tag){case 13:var k=d.stateNode,N=d.memoizedState;N!==null&&(w=N.retryLane);break;case 19:k=d.stateNode;break;default:throw Error(n(314))}k!==null&&k.delete(m),HY(d,w)}var qY;qY=function(d,m,w){if(d!==null)if(d.memoizedProps!==m.pendingProps||qa.current)Ya=!0;else{if((d.lanes&w)===0&&(m.flags&128)===0)return Ya=!1,rTe(d,m,w);Ya=(d.flags&131072)!==0}else Ya=!1,_i&&(m.flags&1048576)!==0&&kK(m,TP,m.index);switch(m.lanes=0,m.tag){case 2:var k=m.type;VP(d,m),d=m.pendingProps;var N=Bv(m,Vo.current);Xv(m,w),N=SD(null,m,k,d,N,w);var L=TD();return m.flags|=1,typeof N=="object"&&N!==null&&typeof N.render=="function"&&N.$$typeof===void 0?(m.tag=1,m.memoizedState=null,m.updateQueue=null,Ka(k)?(L=!0,bP(m)):L=!1,m.memoizedState=N.state!==null&&N.state!==void 0?N.state:null,yD(m),N.updater=$P,m.stateNode=N,N._reactInternals=m,RD(m,k,d,w),m=LD(null,m,k,!0,L,w)):(m.tag=0,_i&&L&&aD(m),ba(null,m,N,w),m=m.child),m;case 16:k=m.elementType;e:{switch(VP(d,m),d=m.pendingProps,N=k._init,k=N(k._payload),m.type=k,N=m.tag=vTe(k),d=Au(k,d),N){case 0:m=OD(null,m,k,d,w);break e;case 1:m=_Y(null,m,k,d,w);break e;case 11:m=pY(null,m,k,d,w);break e;case 14:m=mY(null,m,k,Au(k.type,d),w);break e}throw Error(n(306,k,""))}return m;case 0:return k=m.type,N=m.pendingProps,N=m.elementType===k?N:Au(k,N),OD(d,m,k,N,w);case 1:return k=m.type,N=m.pendingProps,N=m.elementType===k?N:Au(k,N),_Y(d,m,k,N,w);case 3:e:{if(xY(m),d===null)throw Error(n(387));k=m.pendingProps,L=m.memoizedState,N=L.element,LK(d,m),RP(m,k,null,w);var K=m.memoizedState;if(k=K.element,L.isDehydrated)if(L={element:k,isDehydrated:!1,cache:K.cache,pendingSuspenseBoundaries:K.pendingSuspenseBoundaries,transitions:K.transitions},m.updateQueue.baseState=L,m.memoizedState=L,m.flags&256){N=Jv(Error(n(423)),m),m=wY(d,m,k,w,N);break e}else if(k!==N){N=Jv(Error(n(424)),m),m=wY(d,m,k,w,N);break e}else for(Gl=Fp(m.stateNode.containerInfo.firstChild),zl=m,_i=!0,ku=null,w=NK(m,null,k,w),m.child=w;w;)w.flags=w.flags&-3|4096,w=w.sibling;else{if(qv(),k===N){m=sf(d,m,w);break e}ba(d,m,k,w)}m=m.child}return m;case 5:return $K(m),d===null&&uD(m),k=m.type,N=m.pendingProps,L=d!==null?d.memoizedProps:null,K=N.children,tD(k,N)?K=null:L!==null&&tD(k,L)&&(m.flags|=32),vY(d,m),ba(d,m,K,w),m.child;case 6:return d===null&&uD(m),null;case 13:return bY(d,m,w);case 4:return vD(m,m.stateNode.containerInfo),k=m.pendingProps,d===null?m.child=Kv(m,null,k,w):ba(d,m,k,w),m.child;case 11:return k=m.type,N=m.pendingProps,N=m.elementType===k?N:Au(k,N),pY(d,m,k,N,w);case 7:return ba(d,m,m.pendingProps,w),m.child;case 8:return ba(d,m,m.pendingProps.children,w),m.child;case 12:return ba(d,m,m.pendingProps.children,w),m.child;case 10:e:{if(k=m.type._context,N=m.pendingProps,L=m.memoizedProps,K=N.value,oi(IP,k._currentValue),k._currentValue=K,L!==null)if(Tu(L.value,K)){if(L.children===N.children&&!qa.current){m=sf(d,m,w);break e}}else for(L=m.child,L!==null&&(L.return=m);L!==null;){var ce=L.dependencies;if(ce!==null){K=L.child;for(var he=ce.firstContext;he!==null;){if(he.context===k){if(L.tag===1){he=rf(-1,w&-w),he.tag=2;var $e=L.updateQueue;if($e!==null){$e=$e.shared;var ot=$e.pending;ot===null?he.next=he:(he.next=ot.next,ot.next=he),$e.pending=he}}L.lanes|=w,he=L.alternate,he!==null&&(he.lanes|=w),mD(L.return,w,m),ce.lanes|=w;break}he=he.next}}else if(L.tag===10)K=L.type===m.type?null:L.child;else if(L.tag===18){if(K=L.return,K===null)throw Error(n(341));K.lanes|=w,ce=K.alternate,ce!==null&&(ce.lanes|=w),mD(K,w,m),K=L.sibling}else K=L.child;if(K!==null)K.return=L;else for(K=L;K!==null;){if(K===m){K=null;break}if(L=K.sibling,L!==null){L.return=K.return,K=L;break}K=K.return}L=K}ba(d,m,N.children,w),m=m.child}return m;case 9:return N=m.type,k=m.pendingProps.children,Xv(m,w),N=Pc(N),k=k(N),m.flags|=1,ba(d,m,k,w),m.child;case 14:return k=m.type,N=Au(k,m.pendingProps),N=Au(k.type,N),mY(d,m,k,N,w);case 15:return gY(d,m,m.type,m.pendingProps,w);case 17:return k=m.type,N=m.pendingProps,N=m.elementType===k?N:Au(k,N),VP(d,m),m.tag=1,Ka(k)?(d=!0,bP(m)):d=!1,Xv(m,w),aY(m,k,N),RD(m,k,N,w),LD(null,m,k,!0,d,w);case 19:return SY(d,m,w);case 22:return yY(d,m,w)}throw Error(n(156,m.tag))};function KY(d,m){return lt(d,m)}function yTe(d,m,w,k){this.tag=d,this.key=w,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=m,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=k,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Mc(d,m,w,k){return new yTe(d,m,w,k)}function t6(d){return d=d.prototype,!(!d||!d.isReactComponent)}function vTe(d){if(typeof d=="function")return t6(d)?1:0;if(d!=null){if(d=d.$$typeof,d===U)return 11;if(d===Ie)return 14}return 2}function Xp(d,m){var w=d.alternate;return w===null?(w=Mc(d.tag,m,d.key,d.mode),w.elementType=d.elementType,w.type=d.type,w.stateNode=d.stateNode,w.alternate=d,d.alternate=w):(w.pendingProps=m,w.type=d.type,w.flags=0,w.subtreeFlags=0,w.deletions=null),w.flags=d.flags&14680064,w.childLanes=d.childLanes,w.lanes=d.lanes,w.child=d.child,w.memoizedProps=d.memoizedProps,w.memoizedState=d.memoizedState,w.updateQueue=d.updateQueue,m=d.dependencies,w.dependencies=m===null?null:{lanes:m.lanes,firstContext:m.firstContext},w.sibling=d.sibling,w.index=d.index,w.ref=d.ref,w}function ZP(d,m,w,k,N,L){var K=2;if(k=d,typeof d=="function")t6(d)&&(K=1);else if(typeof d=="string")K=5;else e:switch(d){case C:return M0(w.children,N,L,m);case M:K=8,N|=8;break;case O:return d=Mc(12,w,m,N|2),d.elementType=O,d.lanes=L,d;case G:return d=Mc(13,w,m,N),d.elementType=G,d.lanes=L,d;case de:return d=Mc(19,w,m,N),d.elementType=de,d.lanes=L,d;case Ne:return JP(w,N,L,m);default:if(typeof d=="object"&&d!==null)switch(d.$$typeof){case j:K=10;break e;case V:K=9;break e;case U:K=11;break e;case Ie:K=14;break e;case ze:K=16,k=null;break e}throw Error(n(130,d==null?d:typeof d,""))}return m=Mc(K,w,m,N),m.elementType=d,m.type=k,m.lanes=L,m}function M0(d,m,w,k){return d=Mc(7,d,k,m),d.lanes=w,d}function JP(d,m,w,k){return d=Mc(22,d,k,m),d.elementType=Ne,d.lanes=w,d.stateNode={isHidden:!1},d}function n6(d,m,w){return d=Mc(6,d,null,m),d.lanes=w,d}function r6(d,m,w){return m=Mc(4,d.children!==null?d.children:[],d.key,m),m.lanes=w,m.stateNode={containerInfo:d.containerInfo,pendingChildren:null,implementation:d.implementation},m}function _Te(d,m,w,k,N){this.tag=m,this.containerInfo=d,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ob(0),this.expirationTimes=Ob(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ob(0),this.identifierPrefix=k,this.onRecoverableError=N,this.mutableSourceEagerHydrationData=null}function i6(d,m,w,k,N,L,K,ce,he){return d=new _Te(d,m,w,ce,he),m===1?(m=1,L===!0&&(m|=8)):m=0,L=Mc(3,null,null,m),d.current=L,L.stateNode=d,L.memoizedState={element:k,isDehydrated:w,cache:null,transitions:null,pendingSuspenseBoundaries:null},yD(L),d}function xTe(d,m,w){var k=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:D,key:k==null?null:""+k,children:d,containerInfo:m,implementation:w}}function YY(d){if(!d)return zp;d=d._reactInternals;e:{if(oe(d)!==d||d.tag!==1)throw Error(n(170));var m=d;do{switch(m.tag){case 3:m=m.stateNode.context;break e;case 1:if(Ka(m.type)){m=m.stateNode.__reactInternalMemoizedMergedChildContext;break e}}m=m.return}while(m!==null);throw Error(n(171))}if(d.tag===1){var w=d.type;if(Ka(w))return EK(d,w,m)}return m}function XY(d,m,w,k,N,L,K,ce,he){return d=i6(w,k,!0,d,N,L,K,ce,he),d.context=YY(null),w=d.current,k=Ea(),N=Kp(w),L=rf(k,N),L.callback=m??null,Bp(w,L,N),d.current.lanes=N,g0(d,N,k),Za(d,k),d}function QP(d,m,w,k){var N=m.current,L=Ea(),K=Kp(N);return w=YY(w),m.context===null?m.context=w:m.pendingContext=w,m=rf(L,K),m.payload={element:d},k=k===void 0?null:k,k!==null&&(m.callback=k),d=Bp(N,m,K),d!==null&&(Cu(d,N,K,L),CP(d,N,K)),K}function eC(d){if(d=d.current,!d.child)return null;switch(d.child.tag){case 5:return d.child.stateNode;default:return d.child.stateNode}}function ZY(d,m){if(d=d.memoizedState,d!==null&&d.dehydrated!==null){var w=d.retryLane;d.retryLane=w!==0&&w<m?w:m}}function s6(d,m){ZY(d,m),(d=d.alternate)&&ZY(d,m)}function wTe(){return null}var JY=typeof reportError=="function"?reportError:function(d){console.error(d)};function o6(d){this._internalRoot=d}tC.prototype.render=o6.prototype.render=function(d){var m=this._internalRoot;if(m===null)throw Error(n(409));QP(d,m,null,null)},tC.prototype.unmount=o6.prototype.unmount=function(){var d=this._internalRoot;if(d!==null){this._internalRoot=null;var m=d.containerInfo;P0(function(){QP(null,d,null,null)}),m[Jd]=null}};function tC(d){this._internalRoot=d}tC.prototype.unstable_scheduleHydration=function(d){if(d){var m=$b();d={blockedOn:null,target:d,priority:m};for(var w=0;w<jl.length&&m!==0&&m<jl[w].priority;w++);jl.splice(w,0,d),w===0&&Iv(d)}};function a6(d){return!(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)}function nC(d){return!(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11&&(d.nodeType!==8||d.nodeValue!==" react-mount-point-unstable "))}function QY(){}function bTe(d,m,w,k,N){if(N){if(typeof k=="function"){var L=k;k=function(){var $e=eC(K);L.call($e)}}var K=XY(m,k,d,0,null,!1,!1,"",QY);return d._reactRootContainer=K,d[Jd]=K.current,Xb(d.nodeType===8?d.parentNode:d),P0(),K}for(;N=d.lastChild;)d.removeChild(N);if(typeof k=="function"){var ce=k;k=function(){var $e=eC(he);ce.call($e)}}var he=i6(d,0,!1,null,null,!1,!1,"",QY);return d._reactRootContainer=he,d[Jd]=he.current,Xb(d.nodeType===8?d.parentNode:d),P0(function(){QP(m,he,w,k)}),he}function rC(d,m,w,k,N){var L=w._reactRootContainer;if(L){var K=L;if(typeof N=="function"){var ce=N;N=function(){var he=eC(K);ce.call(he)}}QP(m,K,d,N)}else K=bTe(w,m,d,N,k);return eC(K)}Db=function(d){switch(d.tag){case 3:var m=d.stateNode;if(m.current.memoizedState.isDehydrated){var w=br(m.pendingLanes);w!==0&&(Lb(m,w|1),Za(m,ut()),(fr&6)===0&&(t_=ut()+500,Gp()))}break;case 13:P0(function(){var k=nf(d,1);if(k!==null){var N=Ea();Cu(k,d,1,N)}}),s6(d,1)}},kv=function(d){if(d.tag===13){var m=nf(d,134217728);if(m!==null){var w=Ea();Cu(m,d,134217728,w)}s6(d,134217728)}},jb=function(d){if(d.tag===13){var m=Kp(d),w=nf(d,m);if(w!==null){var k=Ea();Cu(w,d,m,k)}s6(d,m)}},$b=function(){return sr},Fb=function(d,m){var w=sr;try{return sr=d,m()}finally{sr=w}},sn=function(d,m,w){switch(m){case"input":if(dt(d,w),m=w.name,w.type==="radio"&&m!=null){for(w=d;w.parentNode;)w=w.parentNode;for(w=w.querySelectorAll("input[name="+JSON.stringify(""+m)+'][type="radio"]'),m=0;m<w.length;m++){var k=w[m];if(k!==d&&k.form===d.form){var N=xP(k);if(!N)throw Error(n(90));Ye(k),dt(k,N)}}}break;case"textarea":Ai(d,w);break;case"select":m=w.value,m!=null&&ei(d,!!w.multiple,m,!1)}},ee=JD,ge=P0;var ETe={usingClientEntryPoint:!1,Events:[Qb,Gv,xP,ae,Ve,JD]},fE={findFiberByHostInstance:w0,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},STe={bundleType:fE.bundleType,version:fE.version,rendererPackageName:fE.rendererPackageName,rendererConfig:fE.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:P.ReactCurrentDispatcher,findHostInstanceByFiber:function(d){return d=Oe(d),d===null?null:d.stateNode},findFiberByHostInstance:fE.findFiberByHostInstance||wTe,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var iC=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!iC.isDisabled&&iC.supportsFiber)try{Dl=iC.inject(STe),ss=iC}catch{}}return Ja.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ETe,Ja.createPortal=function(d,m){var w=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!a6(m))throw Error(n(200));return xTe(d,m,null,w)},Ja.createRoot=function(d,m){if(!a6(d))throw Error(n(299));var w=!1,k="",N=JY;return m!=null&&(m.unstable_strictMode===!0&&(w=!0),m.identifierPrefix!==void 0&&(k=m.identifierPrefix),m.onRecoverableError!==void 0&&(N=m.onRecoverableError)),m=i6(d,1,!1,null,null,w,!1,k,N),d[Jd]=m.current,Xb(d.nodeType===8?d.parentNode:d),new o6(m)},Ja.findDOMNode=function(d){if(d==null)return null;if(d.nodeType===1)return d;var m=d._reactInternals;if(m===void 0)throw typeof d.render=="function"?Error(n(188)):(d=Object.keys(d).join(","),Error(n(268,d)));return d=Oe(m),d=d===null?null:d.stateNode,d},Ja.flushSync=function(d){return P0(d)},Ja.hydrate=function(d,m,w){if(!nC(m))throw Error(n(200));return rC(null,d,m,!0,w)},Ja.hydrateRoot=function(d,m,w){if(!a6(d))throw Error(n(405));var k=w!=null&&w.hydratedSources||null,N=!1,L="",K=JY;if(w!=null&&(w.unstable_strictMode===!0&&(N=!0),w.identifierPrefix!==void 0&&(L=w.identifierPrefix),w.onRecoverableError!==void 0&&(K=w.onRecoverableError)),m=XY(m,null,d,1,w??null,N,!1,L,K),d[Jd]=m.current,Xb(d),k)for(d=0;d<k.length;d++)w=k[d],N=w._getVersion,N=N(w._source),m.mutableSourceEagerHydrationData==null?m.mutableSourceEagerHydrationData=[w,N]:m.mutableSourceEagerHydrationData.push(w,N);return new tC(m)},Ja.render=function(d,m,w){if(!nC(m))throw Error(n(200));return rC(null,d,m,!1,w)},Ja.unmountComponentAtNode=function(d){if(!nC(d))throw Error(n(40));return d._reactRootContainer?(P0(function(){rC(null,null,d,!1,function(){d._reactRootContainer=null,d[Jd]=null})}),!0):!1},Ja.unstable_batchedUpdates=JD,Ja.unstable_renderSubtreeIntoContainer=function(d,m,w,k){if(!nC(w))throw Error(n(200));if(d==null||d._reactInternals===void 0)throw Error(n(38));return rC(d,m,w,!1,k)},Ja.version="18.3.1-next-f1338f8080-20240426",Ja}var cX;function OTe(){if(cX)return h6.exports;cX=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),h6.exports=NTe(),h6.exports}var uX;function LTe(){if(uX)return sC;uX=1;var t=OTe();return sC.createRoot=t.createRoot,sC.hydrateRoot=t.hydrateRoot,sC}var DTe=LTe();const jTe=Gz(DTe);var Y=LA();const $Te=Gz(Y),As={ADD:"add",REMOVE:"remove"},Kw={PROPERTYCHANGE:"propertychange"},wn={CHANGE:"change",ERROR:"error",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",TOUCHMOVE:"touchmove",WHEEL:"wheel"};class DA{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}function FTe(t,e,n){let r,i;n=n||Zf;let s=0,o=t.length,a=!1;for(;s<o;)r=s+(o-s>>1),i=+n(t[r],e),i<0?s=r+1:(o=r,a=!i);return a?s:~s}function Zf(t,e){return t>e?1:t<e?-1:0}function VTe(t,e){return t<e?1:t>e?-1:0}function v5(t,e,n){if(t[0]<=e)return 0;const r=t.length;if(e<=t[r-1])return r-1;if(typeof n=="function"){for(let i=1;i<r;++i){const s=t[i];if(s===e)return i;if(s<e)return n(e,t[i-1],s)>0?i-1:i}return r-1}if(n>0){for(let i=1;i<r;++i)if(t[i]<e)return i-1;return r-1}if(n<0){for(let i=1;i<r;++i)if(t[i]<=e)return i;return r-1}for(let i=1;i<r;++i){if(t[i]==e)return i;if(t[i]<e)return t[i-1]-e<e-t[i]?i-1:i}return r-1}function zTe(t,e,n){for(;e<n;){const r=t[e];t[e]=t[n],t[n]=r,++e,--n}}function _r(t,e){const n=Array.isArray(e)?e:[e],r=n.length;for(let i=0;i<r;i++)t[t.length]=n[i]}function zd(t,e){const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}function GTe(t,e,n){const r=e||Zf;return t.every(function(i,s){if(s===0)return!0;const o=r(t[s-1],i);return!(o>0||o===0)})}function Cg(){return!0}function W2(){return!1}function lk(){}function Mae(t){let e,n,r;return function(){const i=Array.prototype.slice.call(arguments);return(!n||this!==r||!zd(i,n))&&(r=this,n=i,e=t.apply(this,arguments)),e}}function Nae(t){function e(){let n;try{n=t()}catch(r){return Promise.reject(r)}return n instanceof Promise?n:Promise.resolve(n)}return e()}function nv(t){for(const e in t)delete t[e]}function v1(t){let e;for(e in t)return!1;return!e}class Sc{constructor(e){this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}let jA=class extends DA{constructor(e){super(),this.eventTarget_=e,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(e,n){if(!e||!n)return;const r=this.listeners_||(this.listeners_={}),i=r[e]||(r[e]=[]);i.includes(n)||i.push(n)}dispatchEvent(e){const n=typeof e=="string",r=n?e:e.type,i=this.listeners_&&this.listeners_[r];if(!i)return;const s=n?new Sc(e):e;s.target||(s.target=this.eventTarget_||this);const o=this.dispatching_||(this.dispatching_={}),a=this.pendingRemovals_||(this.pendingRemovals_={});r in o||(o[r]=0,a[r]=0),++o[r];let l;for(let c=0,u=i.length;c<u;++c)if("handleEvent"in i[c]?l=i[c].handleEvent(s):l=i[c].call(this,s),l===!1||s.propagationStopped){l=!1;break}if(--o[r]===0){let c=a[r];for(delete a[r];c--;)this.removeEventListener(r,lk);delete o[r]}return l}disposeInternal(){this.listeners_&&nv(this.listeners_)}getListeners(e){return this.listeners_&&this.listeners_[e]||void 0}hasListener(e){return this.listeners_?e?e in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(e,n){if(!this.listeners_)return;const r=this.listeners_[e];if(!r)return;const i=r.indexOf(n);i!==-1&&(this.pendingRemovals_&&e in this.pendingRemovals_?(r[i]=lk,++this.pendingRemovals_[e]):(r.splice(i,1),r.length===0&&delete this.listeners_[e]))}};function Yn(t,e,n,r,i){if(i){const o=n;n=function(a){return t.removeEventListener(e,n),o.call(r??this,a)}}else r&&r!==t&&(n=n.bind(r));const s={target:t,type:e,listener:n};return t.addEventListener(e,n),s}function I3(t,e,n,r){return Yn(t,e,n,r,!0)}function ni(t){t&&t.target&&(t.target.removeEventListener(t.type,t.listener),nv(t))}class $A extends jA{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(wn.CHANGE)}getRevision(){return this.revision_}onInternal(e,n){if(Array.isArray(e)){const r=e.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=Yn(this,e[s],n);return i}return Yn(this,e,n)}onceInternal(e,n){let r;if(Array.isArray(e)){const i=e.length;r=new Array(i);for(let s=0;s<i;++s)r[s]=I3(this,e[s],n)}else r=I3(this,e,n);return n.ol_key=r,r}unInternal(e,n){const r=n.ol_key;if(r)TF(r);else if(Array.isArray(e))for(let i=0,s=e.length;i<s;++i)this.removeEventListener(e[i],n);else this.removeEventListener(e,n)}}$A.prototype.on;$A.prototype.once;$A.prototype.un;function TF(t){if(Array.isArray(t))for(let e=0,n=t.length;e<n;++e)ni(t[e]);else ni(t)}function bn(){throw new Error("Unimplemented abstract method.")}let UTe=0;function Qt(t){return t.ol_uid||(t.ol_uid=String(++UTe))}class hX extends Sc{constructor(e,n,r){super(e),this.key=n,this.oldValue=r}}class Gd extends $A{constructor(e){super(),this.on,this.once,this.un,Qt(this),this.values_=null,e!==void 0&&this.setProperties(e)}get(e){let n;return this.values_&&this.values_.hasOwnProperty(e)&&(n=this.values_[e]),n}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(e,n){let r;r=`change:${e}`,this.hasListener(r)&&this.dispatchEvent(new hX(r,e,n)),r=Kw.PROPERTYCHANGE,this.hasListener(r)&&this.dispatchEvent(new hX(r,e,n))}addChangeListener(e,n){this.addEventListener(`change:${e}`,n)}removeChangeListener(e,n){this.removeEventListener(`change:${e}`,n)}set(e,n,r){const i=this.values_||(this.values_={});if(r)i[e]=n;else{const s=i[e];i[e]=n,s!==n&&this.notify(e,s)}}setProperties(e,n){for(const r in e)this.set(r,e[r],n)}applyProperties(e){e.values_&&Object.assign(this.values_||(this.values_={}),e.values_)}unset(e,n){if(this.values_&&e in this.values_){const r=this.values_[e];delete this.values_[e],v1(this.values_)&&(this.values_=null),n||this.notify(e,r)}}}const dX={LENGTH:"length"};class oC extends Sc{constructor(e,n,r){super(e),this.element=n,this.index=r}}class Da extends Gd{constructor(e,n){if(super(),this.on,this.once,this.un,n=n||{},this.unique_=!!n.unique,this.array_=e??[],this.unique_)for(let r=1,i=this.array_.length;r<i;++r)this.assertUnique_(this.array_[r],r);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(e){for(let n=0,r=e.length;n<r;++n)this.push(e[n]);return this}forEach(e){const n=this.array_;for(let r=0,i=n.length;r<i;++r)e(n[r],r,n)}getArray(){return this.array_}item(e){return this.array_[e]}getLength(){return this.get(dX.LENGTH)}insertAt(e,n){if(e<0||e>this.getLength())throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(n),this.array_.splice(e,0,n),this.updateLength_(),this.dispatchEvent(new oC(As.ADD,n,e))}pop(){return this.removeAt(this.getLength()-1)}push(e){const n=this.getLength();return this.insertAt(n,e),this.getLength()}remove(e){const n=this.array_;for(let r=0,i=n.length;r<i;++r)if(n[r]===e)return this.removeAt(r)}removeAt(e){if(e<0||e>=this.getLength())return;const n=this.array_[e];return this.array_.splice(e,1),this.updateLength_(),this.dispatchEvent(new oC(As.REMOVE,n,e)),n}setAt(e,n){const r=this.getLength();if(e>=r){this.insertAt(e,n);return}if(e<0)throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(n,e);const i=this.array_[e];this.array_[e]=n,this.dispatchEvent(new oC(As.REMOVE,i,e)),this.dispatchEvent(new oC(As.ADD,n,e))}updateLength_(){this.set(dX.LENGTH,this.array_.length)}assertUnique_(e,n){const r=this.array_;for(let i=0,s=r.length;i<s;++i)if(r[i]===e&&i!==n)throw new Error("Duplicate item added to a unique collection")}}function ur(t,e){if(!t)throw new Error(e)}let gr=class Oae extends Gd{constructor(e){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),e)if(typeof e.getSimplifiedGeometry=="function"){const n=e;this.setGeometry(n)}else{const n=e;this.setProperties(n)}}clone(){const e=new Oae(this.hasProperties()?this.getProperties():null);e.setGeometryName(this.getGeometryName());const n=this.getGeometry();n&&e.setGeometry(n.clone());const r=this.getStyle();return r&&e.setStyle(r),e}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(ni(this.geometryChangeKey_),this.geometryChangeKey_=null);const e=this.getGeometry();e&&(this.geometryChangeKey_=Yn(e,wn.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(e){this.set(this.geometryName_,e)}setStyle(e){this.style_=e,this.styleFunction_=e?BTe(e):void 0,this.changed()}setId(e){this.id_=e,this.changed()}setGeometryName(e){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=e,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}};function BTe(t){if(typeof t=="function")return t;let e;return Array.isArray(t)?e=t:(ur(typeof t.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),e=[t]),function(){return e}}const oo={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function ka(t){const e=Ba();for(let n=0,r=t.length;n<r;++n)JS(e,t[n]);return e}function ih(t,e,n){return n?(n[0]=t[0]-e,n[1]=t[1]-e,n[2]=t[2]+e,n[3]=t[3]+e,n):[t[0]-e,t[1]-e,t[2]+e,t[3]+e]}function Lae(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t.slice()}function rv(t,e,n){let r,i;return e<t[0]?r=t[0]-e:t[2]<e?r=e-t[2]:r=0,n<t[1]?i=t[1]-n:t[3]<n?i=n-t[3]:i=0,r*r+i*i}function _1(t,e){return Uz(t,e[0],e[1])}function qm(t,e){return t[0]<=e[0]&&e[2]<=t[2]&&t[1]<=e[1]&&e[3]<=t[3]}function Uz(t,e,n){return t[0]<=e&&e<=t[2]&&t[1]<=n&&n<=t[3]}function kF(t,e){const n=t[0],r=t[1],i=t[2],s=t[3],o=e[0],a=e[1];let l=oo.UNKNOWN;return o<n?l=l|oo.LEFT:o>i&&(l=l|oo.RIGHT),a<r?l=l|oo.BELOW:a>s&&(l=l|oo.ABOVE),l===oo.UNKNOWN&&(l=oo.INTERSECTING),l}function Ba(){return[1/0,1/0,-1/0,-1/0]}function up(t,e,n,r,i){return i?(i[0]=t,i[1]=e,i[2]=n,i[3]=r,i):[t,e,n,r]}function FA(t){return up(1/0,1/0,-1/0,-1/0,t)}function ZS(t,e){const n=t[0],r=t[1];return up(n,r,n,r,e)}function Bz(t,e,n,r,i){const s=FA(i);return Dae(s,t,e,n,r)}function x1(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]}function Wz(t,e){return e[0]<t[0]&&(t[0]=e[0]),e[2]>t[2]&&(t[2]=e[2]),e[1]<t[1]&&(t[1]=e[1]),e[3]>t[3]&&(t[3]=e[3]),t}function JS(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function Dae(t,e,n,r,i){for(;n<r;n+=i)WTe(t,e[n],e[n+1]);return t}function WTe(t,e,n){t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],n),t[2]=Math.max(t[2],e),t[3]=Math.max(t[3],n)}function Hz(t,e){let n;return n=e(_5(t)),n||(n=e(x5(t)),n)||(n=e(w5(t)),n)||(n=e(iv(t)),n)?n:!1}function AF(t){let e=0;return H2(t)||(e=Xn(t)*Ps(t)),e}function _5(t){return[t[0],t[1]]}function x5(t){return[t[2],t[1]]}function gh(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]}function HTe(t,e){let n;if(e==="bottom-left")n=_5(t);else if(e==="bottom-right")n=x5(t);else if(e==="top-left")n=iv(t);else if(e==="top-right")n=w5(t);else throw new Error("Invalid corner");return n}function P3(t,e,n,r,i){const[s,o,a,l,c,u,h,f]=jae(t,e,n,r);return up(Math.min(s,a,c,h),Math.min(o,l,u,f),Math.max(s,a,c,h),Math.max(o,l,u,f),i)}function jae(t,e,n,r){const i=e*r[0]/2,s=e*r[1]/2,o=Math.cos(n),a=Math.sin(n),l=i*o,c=i*a,u=s*o,h=s*a,f=t[0],g=t[1];return[f-l+h,g-c-u,f-l-h,g-c+u,f+l-h,g+c+u,f+l+h,g+c-u,f-l+h,g-c-u]}function Ps(t){return t[3]-t[1]}function Jf(t,e,n){const r=n||Ba();return oa(t,e)?(t[0]>e[0]?r[0]=t[0]:r[0]=e[0],t[1]>e[1]?r[1]=t[1]:r[1]=e[1],t[2]<e[2]?r[2]=t[2]:r[2]=e[2],t[3]<e[3]?r[3]=t[3]:r[3]=e[3]):FA(r),r}function iv(t){return[t[0],t[3]]}function w5(t){return[t[2],t[3]]}function Xn(t){return t[2]-t[0]}function oa(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]}function H2(t){return t[2]<t[0]||t[3]<t[1]}function qTe(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t}function KTe(t,e,n){let r=!1;const i=kF(t,e),s=kF(t,n);if(i===oo.INTERSECTING||s===oo.INTERSECTING)r=!0;else{const o=t[0],a=t[1],l=t[2],c=t[3],u=e[0],h=e[1],f=n[0],g=n[1],y=(g-h)/(f-u);let _,b;s&oo.ABOVE&&!(i&oo.ABOVE)&&(_=f-(g-c)/y,r=_>=o&&_<=l),!r&&s&oo.RIGHT&&!(i&oo.RIGHT)&&(b=g-(f-l)*y,r=b>=a&&b<=c),!r&&s&oo.BELOW&&!(i&oo.BELOW)&&(_=f-(g-a)/y,r=_>=o&&_<=l),!r&&s&oo.LEFT&&!(i&oo.LEFT)&&(b=g-(f-o)*y,r=b>=a&&b<=c)}return r}function $ae(t,e){const n=e.getExtent(),r=gh(t);if(e.canWrapX()&&(r[0]<n[0]||r[0]>=n[2])){const i=Xn(n),o=Math.floor((r[0]-n[0])/i)*i;t[0]-=o,t[2]-=o}return t}function Fae(t,e,n){if(e.canWrapX()){const r=e.getExtent();if(!isFinite(t[0])||!isFinite(t[2]))return[[r[0],t[1],r[2],t[3]]];$ae(t,e);const i=Xn(r);if(Xn(t)>i&&!n)return[[r[0],t[1],r[2],t[3]]];if(t[0]<r[0])return[[t[0]+i,t[1],r[2],t[3]],[r[0],t[1],t[2],t[3]]];if(t[2]>r[2])return[[t[0],t[1],r[2],t[3]],[r[0],t[1],t[2]-i,t[3]]]}return[t]}function ri(t,e,n){return Math.min(Math.max(t,e),n)}function YTe(t,e,n,r,i,s){const o=i-n,a=s-r;if(o!==0||a!==0){const l=((t-n)*o+(e-r)*a)/(o*o+a*a);l>1?(n=i,r=s):l>0&&(n+=o*l,r+=a*l)}return Qf(t,e,n,r)}function Qf(t,e,n,r){const i=n-t,s=r-e;return i*i+s*s}function XTe(t){const e=t.length;for(let r=0;r<e;r++){let i=r,s=Math.abs(t[r][r]);for(let a=r+1;a<e;a++){const l=Math.abs(t[a][r]);l>s&&(s=l,i=a)}if(s===0)return null;const o=t[i];t[i]=t[r],t[r]=o;for(let a=r+1;a<e;a++){const l=-t[a][r]/t[r][r];for(let c=r;c<e+1;c++)r==c?t[a][c]=0:t[a][c]+=l*t[r][c]}}const n=new Array(e);for(let r=e-1;r>=0;r--){n[r]=t[r][e]/t[r][r];for(let i=r-1;i>=0;i--)t[i][e]-=t[i][r]*n[r]}return n}function fX(t){return t*180/Math.PI}function au(t){return t*Math.PI/180}function fg(t,e){const n=t%e;return n*e<0?n+e:n}function rc(t,e,n){return t+n*(e-t)}function q2(t,e){const n=Math.pow(10,e);return Math.round(t*n)/n}function C3(t,e){return Math.round(q2(t,e))}function aC(t,e){return Math.floor(q2(t,e))}function Km(t,e){return Math.ceil(q2(t,e))}function IF(t,e,n){if(t>=e&&t<n)return t;const r=n-e;return((t-e)%r+r)%r+e}function gE(t,e,n){const r=""+t;let i=r.indexOf(".");return i=i===-1?r.length:i,i>e?r:new Array(1+e-i).join("0")+r}function Vae(t,e){const n=(""+t).split("."),r=(""+e).split(".");for(let i=0;i<Math.max(n.length,r.length);i++){const s=parseInt(n[i]||"0",10),o=parseInt(r[i]||"0",10);if(s>o)return 1;if(o>s)return-1}return 0}function ZTe(t,e){return t[0]+=+e[0],t[1]+=+e[1],t}function qz(t,e){const n=t[0],r=t[1],i=e[0],s=e[1],o=i[0],a=i[1],l=s[0],c=s[1],u=l-o,h=c-a,f=u===0&&h===0?0:(u*(n-o)+h*(r-a))/(u*u+h*h||0);let g,y;return f<=0?(g=o,y=a):f>=1?(g=l,y=c):(g=o+f*u,y=a+f*h),[g,y]}function Ia(t,e){let n=!0;for(let r=t.length-1;r>=0;--r)if(t[r]!=e[r]){n=!1;break}return n}function Kz(t,e){const n=Math.cos(e),r=Math.sin(e),i=t[0]*n-t[1]*r,s=t[1]*n+t[0]*r;return t[0]=i,t[1]=s,t}function JTe(t,e){return t[0]*=e,t[1]*=e,t}function Yw(t,e){const n=t[0]-e[0],r=t[1]-e[1];return n*n+r*r}function wx(t,e){return Math.sqrt(Yw(t,e))}function QTe(t,e){return Yw(t,qz(t,e))}function zae(t,e){if(e.canWrapX()){const n=Xn(e.getExtent()),r=Gae(t,e,n);r&&(t[0]-=r*n)}return t}function Gae(t,e,n){const r=e.getExtent();let i=0;return e.canWrapX()&&(t[0]<r[0]||t[0]>r[2])&&(n=n||Xn(r),i=Math.floor((t[0]-r[0])/n)),i}function Uae(...t){console.warn(...t)}const Xw={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};let b5=class{constructor(e){this.code_=e.code,this.units_=e.units,this.extent_=e.extent!==void 0?e.extent:null,this.worldExtent_=e.worldExtent!==void 0?e.worldExtent:null,this.axisOrientation_=e.axisOrientation!==void 0?e.axisOrientation:"enu",this.global_=e.global!==void 0?e.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||Xw[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(e){this.global_=e,this.canWrapX_=!!(e&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(e){this.defaultTileGrid_=e}setExtent(e){this.extent_=e,this.canWrapX_=!!(this.global_&&e)}setWorldExtent(e){this.worldExtent_=e}setGetPointResolution(e){this.getPointResolutionFunc_=e}getPointResolutionFunc(){return this.getPointResolutionFunc_}};const VA=6378137,bx=Math.PI*VA,eke=[-bx,-bx,bx,bx],tke=[-180,-85,180,85],lC=VA*Math.log(Math.tan(Math.PI/2));class r_ extends b5{constructor(e){super({code:e,units:"m",extent:eke,global:!0,worldExtent:tke,getPointResolution:function(n,r){return n/Math.cosh(r[1]/VA)}})}}const pX=[new r_("EPSG:3857"),new r_("EPSG:102100"),new r_("EPSG:102113"),new r_("EPSG:900913"),new r_("http://www.opengis.net/def/crs/EPSG/0/3857"),new r_("http://www.opengis.net/gml/srs/epsg.xml#3857")];function nke(t,e,n,r){const i=t.length;n=n>1?n:2,r=r??n,e===void 0&&(n>2?e=t.slice():e=new Array(i));for(let s=0;s<i;s+=r){e[s]=bx*t[s]/180;let o=VA*Math.log(Math.tan(Math.PI*(+t[s+1]+90)/360));o>lC?o=lC:o<-lC&&(o=-lC),e[s+1]=o}return e}function rke(t,e,n,r){const i=t.length;n=n>1?n:2,r=r??n,e===void 0&&(n>2?e=t.slice():e=new Array(i));for(let s=0;s<i;s+=r)e[s]=180*t[s]/bx,e[s+1]=360*Math.atan(Math.exp(t[s+1]/VA))/Math.PI-90;return e}const ike=6378137,mX=[-180,-90,180,90],ske=Math.PI*ike/180;class N0 extends b5{constructor(e,n){super({code:e,units:"degrees",extent:mX,axisOrientation:n,global:!0,metersPerUnit:ske,worldExtent:mX})}}const gX=[new N0("CRS:84"),new N0("EPSG:4326","neu"),new N0("urn:ogc:def:crs:OGC:1.3:CRS84"),new N0("urn:ogc:def:crs:OGC:2:84"),new N0("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new N0("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new N0("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let PF={};function KR(t){return PF[t]||PF[t.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function oke(t,e){PF[t]=e}let qx={};function w1(t,e,n){const r=t.getCode(),i=e.getCode();r in qx||(qx[r]={}),qx[r][i]=n}function YR(t,e){return t in qx&&e in qx[t]?qx[t][e]:null}const R3=.9996,lu=.00669438,E5=lu*lu,S5=E5*lu,Cy=lu/(1-lu),yX=Math.sqrt(1-lu),Zw=(1-yX)/(1+yX),Bae=Zw*Zw,Yz=Bae*Zw,Xz=Yz*Zw,Wae=Xz*Zw,Hae=1-lu/4-3*E5/64-5*S5/256,ake=3*lu/8+3*E5/32+45*S5/1024,lke=15*E5/256+45*S5/1024,cke=35*S5/3072,uke=3/2*Zw-27/32*Yz+269/512*Wae,hke=21/16*Bae-55/32*Xz,dke=151/96*Yz-417/128*Wae,fke=1097/512*Xz,M3=6378137;function pke(t,e,n){const r=t-5e5,o=(n.north?e:e-1e7)/R3/(M3*Hae),a=o+uke*Math.sin(2*o)+hke*Math.sin(4*o)+dke*Math.sin(6*o)+fke*Math.sin(8*o),l=Math.sin(a),c=l*l,u=Math.cos(a),h=l/u,f=h*h,g=f*f,y=1-lu*c,_=Math.sqrt(1-lu*c),b=M3/_,T=(1-lu)/y,A=Cy*u**2,I=A*A,P=r/(b*R3),R=P*P,D=R*P,C=D*P,M=C*P,O=M*P,j=a-h/T*(R/2-C/24*(5+3*f+10*A-4*I-9*Cy))+O/720*(61+90*f+298*A+45*g-252*Cy-3*I);let V=(P-D/6*(1+2*f+A)+M/120*(5-2*A+28*f-3*I+8*Cy+24*g))/u;return V=IF(V+au(qae(n.number)),-Math.PI,Math.PI),[fX(V),fX(j)]}const vX=-80,_X=84,mke=-180,gke=180;function yke(t,e,n){t=IF(t,mke,gke),e<vX?e=vX:e>_X&&(e=_X);const r=au(e),i=Math.sin(r),s=Math.cos(r),o=i/s,a=o*o,l=a*a,c=au(t),u=qae(n.number),h=au(u),f=M3/Math.sqrt(1-lu*i**2),g=Cy*s**2,y=s*IF(c-h,-Math.PI,Math.PI),_=y*y,b=_*y,T=b*y,A=T*y,I=A*y,P=M3*(Hae*r-ake*Math.sin(2*r)+lke*Math.sin(4*r)-cke*Math.sin(6*r)),R=R3*f*(y+b/6*(1-a+g)+A/120*(5-18*a+l+72*g-58*Cy))+5e5;let D=R3*(P+f*o*(_/2+T/24*(5-a+9*g+4*g**2)+I/720*(61-58*a+l+600*g-330*Cy)));return n.north||(D+=1e7),[R,D]}function qae(t){return(t-1)*6-180+3}const vke=[/^EPSG:(\d+)$/,/^urn:ogc:def:crs:EPSG::(\d+)$/,/^http:\/\/www\.opengis\.net\/def\/crs\/EPSG\/0\/(\d+)$/];function Kae(t){let e=0;for(const i of vke){const s=t.match(i);if(s){e=parseInt(s[1]);break}}if(!e)return null;let n=0,r=!1;return e>32700&&e<32761?n=e-32700:e>32600&&e<32661&&(r=!0,n=e-32600),n?{number:n,north:r}:null}function xX(t,e){return function(n,r,i,s){const o=n.length;i=i>1?i:2,s=s??i,r||(i>2?r=n.slice():r=new Array(o));for(let a=0;a<o;a+=s){const l=n[a],c=n[a+1],u=t(l,c,e);r[a]=u[0],r[a+1]=u[1]}return r}}function _ke(t){return Kae(t)?new b5({code:t,units:"m"}):null}function xke(t){const e=Kae(t.getCode());return e?{forward:xX(yke,e),inverse:xX(pke,e)}:null}const Zz=63710088e-1;function CF(t,e,n){n=n||Zz;const r=au(t[1]),i=au(e[1]),s=(i-r)/2,o=au(e[0]-t[0])/2,a=Math.sin(s)*Math.sin(s)+Math.sin(o)*Math.sin(o)*Math.cos(r)*Math.cos(i);return 2*n*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))}function p6(t,e){let n=0;for(let r=0,i=t.length;r<i-1;++r)n+=CF(t[r],t[r+1],e);return n}function ck(t,e){e=e||{};const n=e.radius||Zz,r=e.projection||"EPSG:3857",i=t.getType();i!=="GeometryCollection"&&(t=t.clone().transform(r,"EPSG:4326"));let s=0,o,a,l,c,u,h;switch(i){case"Point":case"MultiPoint":break;case"LineString":case"LinearRing":{o=t.getCoordinates(),s=p6(o,n);break}case"MultiLineString":case"Polygon":{for(o=t.getCoordinates(),l=0,c=o.length;l<c;++l)s+=p6(o[l],n);break}case"MultiPolygon":{for(o=t.getCoordinates(),l=0,c=o.length;l<c;++l)for(a=o[l],u=0,h=a.length;u<h;++u)s+=p6(a[u],n);break}case"GeometryCollection":{const f=t.getGeometries();for(l=0,c=f.length;l<c;++l)s+=ck(f[l],e);break}default:throw new Error("Unsupported geometry type: "+i)}return s}function cC(t,e){let n=0;const r=t.length;let i=t[r-1][0],s=t[r-1][1];for(let o=0;o<r;o++){const a=t[o][0],l=t[o][1];n+=au(a-i)*(2+Math.sin(au(s))+Math.sin(au(l))),i=a,s=l}return n*e*e/2}function RF(t,e){e=e||{};const n=e.radius||Zz,r=e.projection||"EPSG:3857",i=t.getType();i!=="GeometryCollection"&&(t=t.clone().transform(r,"EPSG:4326"));let s=0,o,a,l,c,u,h;switch(i){case"Point":case"MultiPoint":case"LineString":case"MultiLineString":case"LinearRing":break;case"Polygon":{for(o=t.getCoordinates(),s=Math.abs(cC(o[0],n)),l=1,c=o.length;l<c;++l)s-=Math.abs(cC(o[l],n));break}case"MultiPolygon":{for(o=t.getCoordinates(),l=0,c=o.length;l<c;++l)for(a=o[l],s+=Math.abs(cC(a[0],n)),u=1,h=a.length;u<h;++u)s-=Math.abs(cC(a[u],n));break}case"GeometryCollection":{const f=t.getGeometries();for(l=0,c=f.length;l<c;++l)s+=RF(f[l],e);break}default:throw new Error("Unsupported geometry type: "+i)}return s}const wke=[xke],bke=[_ke];let MF=!0;function Yae(t){MF=!1}function Jz(t,e){if(e!==void 0){for(let n=0,r=t.length;n<r;++n)e[n]=t[n];e=e}else e=t.slice();return e}function N3(t){oke(t.getCode(),t),w1(t,t,Jz)}function Eke(t){t.forEach(N3)}function Jr(t){if(typeof t!="string")return t;const e=KR(t);if(e)return e;for(const n of bke){const r=n(t);if(r)return r}return null}function O3(t,e,n,r){t=Jr(t);let i;const s=t.getPointResolutionFunc();if(s){if(i=s(e,n),r&&r!==t.getUnits()){const o=t.getMetersPerUnit();o&&(i=i*o/Xw[r])}}else{const o=t.getUnits();if(o=="degrees"&&!r||r=="degrees")i=e;else{const a=eG(t,Jr("EPSG:4326"));if(!a&&o!=="degrees")i=e*t.getMetersPerUnit();else{let c=[n[0]-e/2,n[1],n[0]+e/2,n[1],n[0],n[1]-e/2,n[0],n[1]+e/2];c=a(c,c,2);const u=CF(c.slice(0,2),c.slice(2,4)),h=CF(c.slice(4,6),c.slice(6,8));i=(u+h)/2}const l=r?Xw[r]:t.getMetersPerUnit();l!==void 0&&(i/=l)}}return i}function NF(t){Eke(t),t.forEach(function(e){t.forEach(function(n){e!==n&&w1(e,n,Jz)})})}function Ske(t,e,n,r){t.forEach(function(i){e.forEach(function(s){w1(i,s,n),w1(s,i,r)})})}function Qz(t,e){return t?typeof t=="string"?Jr(t):t:Jr(e)}function OF(t){return(function(e,n,r,i){const s=e.length;r=r!==void 0?r:2,i=i??r,n=n!==void 0?n:new Array(s);for(let o=0;o<s;o+=i){const a=t(e.slice(o,o+r)),l=a.length;for(let c=0,u=i;c<u;++c)n[o+c]=c>=l?e[o+c]:a[c]}return n})}function Tke(t,e,n,r){const i=Jr(t),s=Jr(e);w1(i,s,OF(n)),w1(s,i,OF(r))}function Ni(t,e){return Yae(),K2(t,"EPSG:4326","EPSG:3857")}function Fn(t,e){const n=K2(t,"EPSG:3857","EPSG:4326"),r=n[0];return(r<-180||r>180)&&(n[0]=fg(r+180,360)-180),n}function Zy(t,e){if(t===e)return!0;const n=t.getUnits()===e.getUnits();return(t.getCode()===e.getCode()||eG(t,e)===Jz)&&n}function eG(t,e){const n=t.getCode(),r=e.getCode();let i=YR(n,r);if(i)return i;let s=null,o=null;for(const l of wke)s||(s=l(t)),o||(o=l(e));if(!s&&!o)return null;const a="EPSG:4326";if(o)if(s)i=m6(s.inverse,o.forward);else{const l=YR(n,a);l&&(i=m6(l,o.forward))}else{const l=YR(a,r);l&&(i=m6(s.inverse,l))}return i&&(N3(t),N3(e),w1(t,e,i)),i}function m6(t,e){return function(n,r,i,s){return r=t(n,r,i,s),e(r,r,i,s)}}function uk(t,e){const n=Jr(t),r=Jr(e);return eG(n,r)}function K2(t,e,n){const r=uk(e,n);if(!r){const i=Jr(e).getCode(),s=Jr(n).getCode();throw new Error(`No transform available between ${i} and ${s}`)}return r(t,void 0,t.length)}function b1(t,e){return t}function Li(t,e){return MF&&!Ia(t,[0,0])&&t[0]>=-180&&t[0]<=180&&t[1]>=-90&&t[1]<=90&&(MF=!1,Uae("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),t}function tG(t,e){return t}function sh(t,e){return t}function wX(t,e,n){return function(r){let i,s;if(t.canWrapX()){const o=t.getExtent(),a=Xn(o);r=r.slice(0),s=Gae(r,t,a),s&&(r[0]=r[0]-s*a),r[0]=ri(r[0],o[0],o[2]),r[1]=ri(r[1],o[1],o[3]),i=n(r)}else i=n(r);return s&&e.canWrapX()&&(i[0]+=s*Xn(e.getExtent())),i}}function kke(){NF(pX),NF(gX),Ske(gX,pX,nke,rke)}kke();const Ake=new Array(6);function Ws(){return[1,0,0,1,0,0]}function Xae(t,e){const n=t[0],r=t[1],i=t[2],s=t[3],o=t[4],a=t[5],l=e[0],c=e[1],u=e[2],h=e[3],f=e[4],g=e[5];return t[0]=n*l+i*c,t[1]=r*l+s*c,t[2]=n*u+i*h,t[3]=r*u+s*h,t[4]=n*f+i*g+o,t[5]=r*f+s*g+a,t}function Ike(t,e,n,r,i,s,o){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=s,t[5]=o,t}function Zae(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function Zi(t,e){const n=e[0],r=e[1];return e[0]=t[0]*n+t[2]*r+t[4],e[1]=t[1]*n+t[3]*r+t[5],e}function Pke(t,e,n){return Xae(t,Ike(Ake,1,0,0,1,e,n))}function pu(t,e,n,r,i,s,o,a){const l=Math.sin(s),c=Math.cos(s);return t[0]=r*c,t[1]=i*l,t[2]=-r*l,t[3]=i*c,t[4]=o*r*c-a*r*l+e,t[5]=o*i*l+a*i*c+n,t}function hk(t,e){const n=Cke(e);ur(n!==0,"Transformation matrix cannot be inverted");const r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5];return t[0]=o/n,t[1]=-i/n,t[2]=-s/n,t[3]=r/n,t[4]=(s*l-o*a)/n,t[5]=-(r*l-i*a)/n,t}function Cke(t){return t[0]*t[3]-t[1]*t[2]}const Rke=[1e5,1e5,1e5,1e5,2,2];function Mke(t){return"matrix("+t.join(", ")+")"}function LF(t){return t.substring(7,t.length-1).split(",").map(parseFloat)}function Nke(t,e){const n=LF(t),r=LF(e);for(let i=0;i<6;++i)if(Math.round((n[i]-r[i])*Rke[i])!==0)return!1;return!0}function vd(t,e,n,r,i,s,o){s=s||[],o=o||2;let a=0;for(let l=e;l<n;l+=r){const c=t[l],u=t[l+1];s[a++]=i[0]*c+i[2]*u+i[4],s[a++]=i[1]*c+i[3]*u+i[5];for(let h=2;h<o;h++)s[a++]=t[l+h]}return s&&s.length!=a&&(s.length=a),s}function nG(t,e,n,r,i,s,o){o=o||[];const a=Math.cos(i),l=Math.sin(i),c=s[0],u=s[1];let h=0;for(let f=e;f<n;f+=r){const g=t[f]-c,y=t[f+1]-u;o[h++]=c+g*a-y*l,o[h++]=u+g*l+y*a;for(let _=f+2;_<f+r;++_)o[h++]=t[_]}return o&&o.length!=h&&(o.length=h),o}function Oke(t,e,n,r,i,s,o,a){a=a||[];const l=o[0],c=o[1];let u=0;for(let h=e;h<n;h+=r){const f=t[h]-l,g=t[h+1]-c;a[u++]=l+i*f,a[u++]=c+s*g;for(let y=h+2;y<h+r;++y)a[u++]=t[y]}return a&&a.length!=u&&(a.length=u),a}function Lke(t,e,n,r,i,s,o){o=o||[];let a=0;for(let l=e;l<n;l+=r){o[a++]=t[l]+i,o[a++]=t[l+1]+s;for(let c=l+2;c<l+r;++c)o[a++]=t[c]}return o&&o.length!=a&&(o.length=a),o}const bX=Ws(),Dke=[NaN,NaN];class Jae extends Gd{constructor(){super(),this.extent_=Ba(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=Mae((e,n,r)=>{if(!r)return this.getSimplifiedGeometry(n);const i=this.clone();return i.applyTransform(r),i.getSimplifiedGeometry(n)})}simplifyTransformed(e,n){return this.simplifyTransformedInternal(this.getRevision(),e,n)}clone(){return bn()}closestPointXY(e,n,r,i){return bn()}containsXY(e,n){return this.closestPointXY(e,n,Dke,Number.MIN_VALUE)===0}getClosestPoint(e,n){return n=n||[NaN,NaN],this.closestPointXY(e[0],e[1],n,1/0),n}intersectsCoordinate(e){return this.containsXY(e[0],e[1])}computeExtent(e){return bn()}getExtent(e){if(this.extentRevision_!=this.getRevision()){const n=this.computeExtent(this.extent_);(isNaN(n[0])||isNaN(n[1]))&&FA(n),this.extentRevision_=this.getRevision()}return qTe(this.extent_,e)}rotate(e,n){bn()}scale(e,n,r){bn()}simplify(e){return this.getSimplifiedGeometry(e*e)}getSimplifiedGeometry(e){return bn()}getType(){return bn()}applyTransform(e){bn()}intersectsExtent(e){return bn()}translate(e,n){bn()}transform(e,n){const r=Jr(e),i=r.getUnits()=="tile-pixels"?function(s,o,a){const l=r.getExtent(),c=r.getWorldExtent(),u=Ps(c)/Ps(l);pu(bX,c[0],c[3],u,-u,0,0,0);const h=vd(s,0,s.length,a,bX,o),f=uk(r,n);return f?f(h,h,a):h}:uk(r,n);return this.applyTransform(i),this}}class t0 extends Jae{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(e){return Bz(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinates(){return bn()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const n=this.getSimplifiedGeometryInternal(e);return n.getFlatCoordinates().length<this.flatCoordinates.length?n:(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getSimplifiedGeometryInternal(e){return this}getStride(){return this.stride}setFlatCoordinates(e,n){this.stride=L3(e),this.layout=e,this.flatCoordinates=n}setCoordinates(e,n){bn()}setLayout(e,n,r){let i;if(e)i=L3(e);else{for(let s=0;s<r;++s){if(n.length===0){this.layout="XY",this.stride=2;return}n=n[0]}i=n.length,e=sv(i)}this.layout=e,this.stride=i}applyTransform(e){this.flatCoordinates&&(e(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(e,n){const r=this.getFlatCoordinates();if(r){const i=this.getStride();nG(r,0,r.length,i,e,n,r),this.changed()}}scale(e,n,r){n===void 0&&(n=e),r||(r=gh(this.getExtent()));const i=this.getFlatCoordinates();if(i){const s=this.getStride();Oke(i,0,i.length,s,e,n,r,i),this.changed()}}translate(e,n){const r=this.getFlatCoordinates();if(r){const i=this.getStride();Lke(r,0,r.length,i,e,n,r),this.changed()}}}function sv(t){let e;return t==2?e="XY":t==3?e="XYZ":t==4&&(e="XYZM"),e}function L3(t){let e;return t=="XY"?e=2:t=="XYZ"||t=="XYM"?e=3:t=="XYZM"&&(e=4),e}function jke(t,e,n){const r=t.getFlatCoordinates();if(!r)return null;const i=t.getStride();return vd(r,0,r.length,i,e,n)}function EX(t,e,n,r,i,s,o){const a=t[e],l=t[e+1],c=t[n]-a,u=t[n+1]-l;let h;if(c===0&&u===0)h=e;else{const f=((i-a)*c+(s-l)*u)/(c*c+u*u);if(f>1)h=n;else if(f>0){for(let g=0;g<r;++g)o[g]=rc(t[e+g],t[n+g],f);o.length=r;return}else h=e}for(let f=0;f<r;++f)o[f]=t[h+f];o.length=r}function rG(t,e,n,r,i){let s=t[e],o=t[e+1];for(e+=r;e<n;e+=r){const a=t[e],l=t[e+1],c=Qf(s,o,a,l);c>i&&(i=c),s=a,o=l}return i}function iG(t,e,n,r,i){for(let s=0,o=n.length;s<o;++s){const a=n[s];i=rG(t,e,a,r,i),e=a}return i}function $ke(t,e,n,r,i){for(let s=0,o=n.length;s<o;++s){const a=n[s];i=iG(t,e,a,r,i),e=a[a.length-1]}return i}function sG(t,e,n,r,i,s,o,a,l,c,u){if(e==n)return c;let h,f;if(i===0){if(f=Qf(o,a,t[e],t[e+1]),f<c){for(h=0;h<r;++h)l[h]=t[e+h];return l.length=r,f}return c}u=u||[NaN,NaN];let g=e+r;for(;g<n;)if(EX(t,g-r,g,r,o,a,u),f=Qf(o,a,u[0],u[1]),f<c){for(c=f,h=0;h<r;++h)l[h]=u[h];l.length=r,g+=r}else g+=r*Math.max((Math.sqrt(f)-Math.sqrt(c))/i|0,1);if(s&&(EX(t,n-r,e,r,o,a,u),f=Qf(o,a,u[0],u[1]),f<c)){for(c=f,h=0;h<r;++h)l[h]=u[h];l.length=r}return c}function oG(t,e,n,r,i,s,o,a,l,c,u){u=u||[NaN,NaN];for(let h=0,f=n.length;h<f;++h){const g=n[h];c=sG(t,e,g,r,i,s,o,a,l,c,u),e=g}return c}function Fke(t,e,n,r,i,s,o,a,l,c,u){u=u||[NaN,NaN];for(let h=0,f=n.length;h<f;++h){const g=n[h];c=oG(t,e,g,r,i,s,o,a,l,c,u),e=g[g.length-1]}return c}function Qae(t,e,n,r){for(let i=0,s=n.length;i<s;++i)t[e++]=n[i];return e}function T5(t,e,n,r){for(let i=0,s=n.length;i<s;++i){const o=n[i];for(let a=0;a<r;++a)t[e++]=o[a]}return e}function zA(t,e,n,r,i){i=i||[];let s=0;for(let o=0,a=n.length;o<a;++o){const l=T5(t,e,n[o],r);i[s++]=l,e=l}return i.length=s,i}function ele(t,e,n,r,i){i=i||[];let s=0;for(let o=0,a=n.length;o<a;++o){const l=zA(t,e,n[o],r,i[s]);l.length===0&&(l[0]=e),i[s++]=l,e=l[l.length-1]}return i.length=s,i}function Ym(t,e,n,r,i){i=i!==void 0?i:[];let s=0;for(let o=e;o<n;o+=r)i[s++]=t.slice(o,o+r);return i.length=s,i}function dk(t,e,n,r,i){i=i!==void 0?i:[];let s=0;for(let o=0,a=n.length;o<a;++o){const l=n[o];i[s++]=Ym(t,e,l,r,i[s]),e=l}return i.length=s,i}function DF(t,e,n,r,i){i=i!==void 0?i:[];let s=0;for(let o=0,a=n.length;o<a;++o){const l=n[o];i[s++]=l.length===1&&l[0]===e?[]:dk(t,e,l,r,i[s]),e=l[l.length-1]}return i.length=s,i}function D3(t,e,n,r,i,s,o){let a,l;const c=(n-e)/r;if(c===1)a=e;else if(c===2)a=e,l=i;else if(c!==0){let u=t[e],h=t[e+1],f=0;const g=[0];for(let b=e+r;b<n;b+=r){const T=t[b],A=t[b+1];f+=Math.sqrt((T-u)*(T-u)+(A-h)*(A-h)),g.push(f),u=T,h=A}const y=i*f,_=FTe(g,y);_<0?(l=(y-g[-_-2])/(g[-_-1]-g[-_-2]),a=e+(-_-2)*r):a=e+_*r}o=o>1?o:2,s=s||new Array(o);for(let u=0;u<o;++u)s[u]=a===void 0?NaN:l===void 0?t[a+u]:rc(t[a+u],t[a+r+u],l);return s}function jF(t,e,n,r,i,s){if(n==e)return null;let o;if(i<t[e+r-1])return s?(o=t.slice(e,e+r),o[r-1]=i,o):null;if(t[n-1]<i)return s?(o=t.slice(n-r,n),o[r-1]=i,o):null;if(i==t[e+r-1])return t.slice(e,e+r);let a=e/r,l=n/r;for(;a<l;){const f=a+l>>1;i<t[(f+1)*r-1]?l=f:a=f+1}const c=t[a*r-1];if(i==c)return t.slice((a-1)*r,(a-1)*r+r);const u=t[(a+1)*r-1],h=(i-c)/(u-c);o=[];for(let f=0;f<r-1;++f)o.push(rc(t[(a-1)*r+f],t[a*r+f],h));return o.push(i),o}function Vke(t,e,n,r,i,s,o){if(o)return jF(t,e,n[n.length-1],r,i,s);let a;if(i<t[r-1])return s?(a=t.slice(0,r),a[r-1]=i,a):null;if(t[t.length-1]<i)return s?(a=t.slice(t.length-r),a[r-1]=i,a):null;for(let l=0,c=n.length;l<c;++l){const u=n[l];if(e!=u){if(i<t[e+r-1])return null;if(i<=t[u-1])return jF(t,e,u,r,i,!1);e=u}}return null}function zke(t,e,n,r,i){return!Hz(i,function(o){return!Ry(t,e,n,r,o[0],o[1])})}function Ry(t,e,n,r,i,s){let o=0,a=t[n-r],l=t[n-r+1];for(;e<n;e+=r){const c=t[e],u=t[e+1];l<=s?u>s&&(c-a)*(s-l)-(i-a)*(u-l)>0&&o++:u<=s&&(c-a)*(s-l)-(i-a)*(u-l)<0&&o--,a=c,l=u}return o!==0}function aG(t,e,n,r,i,s){if(n.length===0||!Ry(t,e,n[0],r,i,s))return!1;for(let o=1,a=n.length;o<a;++o)if(Ry(t,n[o-1],n[o],r,i,s))return!1;return!0}function Gke(t,e,n,r,i,s){if(n.length===0)return!1;for(let o=0,a=n.length;o<a;++o){const l=n[o];if(aG(t,e,l,r,i,s))return!0;e=l[l.length-1]}return!1}function tle(t,e,n,r,i){let s;for(e+=r;e<n;e+=r)if(s=i(t.slice(e-r,e),t.slice(e,e+r)),s)return s;return!1}function k5(t,e,n,r,i,s){return s=s??Dae(Ba(),t,e,n,r),oa(i,s)?s[0]>=i[0]&&s[2]<=i[2]||s[1]>=i[1]&&s[3]<=i[3]?!0:tle(t,e,n,r,function(o,a){return KTe(i,o,a)}):!1}function Uke(t,e,n,r,i){for(let s=0,o=n.length;s<o;++s){if(k5(t,e,n[s],r,i))return!0;e=n[s]}return!1}function nle(t,e,n,r,i){return!!(k5(t,e,n,r,i)||Ry(t,e,n,r,i[0],i[1])||Ry(t,e,n,r,i[0],i[3])||Ry(t,e,n,r,i[2],i[1])||Ry(t,e,n,r,i[2],i[3]))}function rle(t,e,n,r,i){if(!nle(t,e,n[0],r,i))return!1;if(n.length===1)return!0;for(let s=1,o=n.length;s<o;++s)if(zke(t,n[s-1],n[s],r,i)&&!k5(t,n[s-1],n[s],r,i))return!1;return!0}function Bke(t,e,n,r,i){for(let s=0,o=n.length;s<o;++s){const a=n[s];if(rle(t,e,a,r,i))return!0;e=a[a.length-1]}return!1}function lG(t,e,n,r){let i=t[e],s=t[e+1],o=0;for(let a=e+r;a<n;a+=r){const l=t[a],c=t[a+1];o+=Math.sqrt((l-i)*(l-i)+(c-s)*(c-s)),i=l,s=c}return o}function A5(t,e,n,r,i,s,o){const a=(n-e)/r;if(a<3){for(;e<n;e+=r)s[o++]=t[e],s[o++]=t[e+1];return o}const l=new Array(a);l[0]=1,l[a-1]=1;const c=[e,n-r];let u=0;for(;c.length>0;){const h=c.pop(),f=c.pop();let g=0;const y=t[f],_=t[f+1],b=t[h],T=t[h+1];for(let A=f+r;A<h;A+=r){const I=t[A],P=t[A+1],R=YTe(I,P,y,_,b,T);R>g&&(u=A,g=R)}g>i&&(l[(u-e)/r]=1,f+r<u&&c.push(f,u),u+r<h&&c.push(u,h))}for(let h=0;h<a;++h)l[h]&&(s[o++]=t[e+h*r],s[o++]=t[e+h*r+1]);return o}function ile(t,e,n,r,i,s,o,a){for(let l=0,c=n.length;l<c;++l){const u=n[l];o=A5(t,e,u,r,i,s,o),a.push(o),e=u}return o}function q0(t,e){return e*Math.round(t/e)}function Wke(t,e,n,r,i,s,o){if(e==n)return o;let a=q0(t[e],i),l=q0(t[e+1],i);e+=r,s[o++]=a,s[o++]=l;let c,u;do if(c=q0(t[e],i),u=q0(t[e+1],i),e+=r,e==n)return s[o++]=c,s[o++]=u,o;while(c==a&&u==l);for(;e<n;){const h=q0(t[e],i),f=q0(t[e+1],i);if(e+=r,h==c&&f==u)continue;const g=c-a,y=u-l,_=h-a,b=f-l;if(g*b==y*_&&(g<0&&_<g||g==_||g>0&&_>g)&&(y<0&&b<y||y==b||y>0&&b>y)){c=h,u=f;continue}s[o++]=c,s[o++]=u,a=c,l=u,c=h,u=f}return s[o++]=c,s[o++]=u,o}function cG(t,e,n,r,i,s,o,a){for(let l=0,c=n.length;l<c;++l){const u=n[l];o=Wke(t,e,u,r,i,s,o),a.push(o),e=u}return o}function Hke(t,e,n,r,i,s,o,a){for(let l=0,c=n.length;l<c;++l){const u=n[l],h=[];o=cG(t,e,u,r,i,s,o,h),a.push(h),e=u[u.length-1]}return o}class ts extends t0{constructor(e,n){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,n!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(n,e):this.setCoordinates(e,n)}appendCoordinate(e){_r(this.flatCoordinates,e),this.changed()}clone(){const e=new ts(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,n,r,i){return i<rv(this.getExtent(),e,n)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(rG(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),sG(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,e,n,r,i))}forEachSegment(e){return tle(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinateAtM(e,n){return this.layout!="XYM"&&this.layout!="XYZM"?null:(n=n!==void 0?n:!1,jF(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,n))}getCoordinates(){return Ym(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(e,n){return D3(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,n,this.stride)}getLength(){return lG(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_??void 0),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(e){const n=[];return n.length=A5(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,n,0),new ts(n,"XY")}getType(){return"LineString"}intersectsExtent(e){return k5(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,this.getExtent())}setCoordinates(e,n){this.setLayout(n,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=T5(this.flatCoordinates,0,e,this.stride),this.changed()}}let Ti=class sle extends t0{constructor(e,n){super(),this.setCoordinates(e,n)}clone(){const e=new sle(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,n,r,i){const s=this.flatCoordinates,o=Qf(e,n,s[0],s[1]);if(o<i){const a=this.stride;for(let l=0;l<a;++l)r[l]=s[l];return r.length=a,o}return i}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(e){return ZS(this.flatCoordinates,e)}getType(){return"Point"}intersectsExtent(e){return Uz(e,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(e,n){this.setLayout(n,e,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Qae(this.flatCoordinates,0,e,this.stride),this.changed()}};const co={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"},E1=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",qke=E1.includes("safari")&&!E1.includes("chrom"),Kke=qke&&(E1.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(E1)),Yke=E1.includes("webkit")&&!E1.includes("edge"),ole=E1.includes("macintosh"),Xke=typeof devicePixelRatio<"u"?devicePixelRatio:1,cc=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,uG=typeof Image<"u"&&Image.prototype.decode,ale=typeof createImageBitmap=="function",lle=(function(){let t=!1;try{const e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch{}return t})(),Vt={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function Rs(t,e,n,r){let i;return n&&n.length?i=n.shift():cc?i=new class extends OffscreenCanvas{style={}}(t??300,e??150):i=document.createElement("canvas"),t&&(i.width=t),e&&(i.height=e),i.getContext("2d",r)}let g6;function j3(){return g6||(g6=Rs(1,1)),g6}function I5(t){const e=t.canvas;e.width=1,e.height=1,t.clearRect(0,0,1,1)}function SX(t,e){const n=e.parentNode;n&&n.replaceChild(t,e)}function Zke(t){for(;t.lastChild;)t.lastChild.remove()}function Jke(t,e){const n=t.childNodes;for(let r=0;;++r){const i=n[r],s=e[r];if(!i&&!s)break;if(i!==s){if(!i){t.appendChild(s);continue}if(!s){t.removeChild(i),--r;continue}t.insertBefore(s,i)}}}function cle(){return new Proxy({childNodes:[],appendChild:function(e){return this.childNodes.push(e),e},remove:function(){},removeChild:function(e){const n=this.childNodes.indexOf(e);if(n===-1)throw new Error("Node to remove was not found");return this.childNodes.splice(n,1),e},insertBefore:function(e,n){const r=this.childNodes.indexOf(n);if(r===-1)throw new Error("Reference node not found");return this.childNodes.splice(r,0,e),e},style:{}},{get(e,n,r){return n==="firstElementChild"?e.childNodes.length>0?e.childNodes[0]:null:Reflect.get(e,n,r)}})}function Xm(t){return typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas}const hG=[NaN,NaN,NaN,0];let y6;function Qke(){return y6||(y6=Rs(1,1,void 0,{willReadFrequently:!0,desynchronized:!0})),y6}const eAe=/^rgba?\(\s*(\d+%?)\s+(\d+%?)\s+(\d+%?)(?:\s*\/\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,tAe=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,nAe=/^rgba?\(\s*(\d+%)\s*,\s*(\d+%)\s*,\s*(\d+%)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,rAe=/^#([\da-f]{3,4}|[\da-f]{6}|[\da-f]{8})$/i;function uC(t,e){return t.endsWith("%")?Number(t.substring(0,t.length-1))/e:Number(t)}function QS(t){throw new Error('failed to parse "'+t+'" as color')}function ule(t){if(t.toLowerCase().startsWith("rgb")){const s=t.match(tAe)||t.match(eAe)||t.match(nAe);if(s){const o=s[4],a=100/255;return[ri(uC(s[1],a)+.5|0,0,255),ri(uC(s[2],a)+.5|0,0,255),ri(uC(s[3],a)+.5|0,0,255),o!==void 0?ri(uC(o,100),0,1):1]}QS(t)}if(t.startsWith("#")){if(rAe.test(t)){const s=t.substring(1),o=s.length<=4?1:2,a=[0,0,0,255];for(let l=0,c=s.length;l<c;l+=o){let u=parseInt(s.substring(l,l+o),16);o===1&&(u+=u<<4),a[l/o]=u}return a[3]=a[3]/255,a}QS(t)}const e=Qke();e.fillStyle="#abcdef";let n=e.fillStyle;e.fillStyle=t,e.fillStyle===n&&(e.fillStyle="#fedcba",n=e.fillStyle,e.fillStyle=t,e.fillStyle===n&&QS(t));const r=e.fillStyle;if(r.startsWith("#")||r.startsWith("rgba"))return ule(r);e.clearRect(0,0,1,1),e.fillRect(0,0,1,1);const i=Array.from(e.getImageData(0,0,1,1).data);return i[3]=q2(i[3]/255,3),i}function iAe(t){return typeof t=="string"?t:fG(t)}const sAe=1024,yE={};let v6=0;function oAe(t){if(t.length===4)return t;const e=t.slice();return e[3]=1,e}function _6(t){return t>.0031308?Math.pow(t,1/2.4)*269.025-14.025:t*3294.6}function x6(t){return t>.2068965?Math.pow(t,3):(t-4/29)*(108/841)}function w6(t){return t>10.314724?Math.pow((t+14.025)/269.025,2.4):t/3294.6}function b6(t){return t>.0088564?Math.pow(t,1/3):t/(108/841)+4/29}function TX(t){const e=w6(t[0]),n=w6(t[1]),r=w6(t[2]),i=b6(e*.222488403+n*.716873169+r*.06060791),s=500*(b6(e*.452247074+n*.399439023+r*.148375274)-i),o=200*(i-b6(e*.016863605+n*.117638439+r*.865350722)),a=Math.atan2(o,s)*(180/Math.PI);return[116*i-16,Math.sqrt(s*s+o*o),a<0?a+360:a,t[3]]}function aAe(t){const e=(t[0]+16)/116,n=t[1],r=t[2]*Math.PI/180,i=x6(e),s=x6(e+n/500*Math.cos(r)),o=x6(e-n/200*Math.sin(r)),a=_6(s*3.021973625-i*1.617392459-o*.404875592),l=_6(s*-.943766287+i*1.916279586+o*.027607165),c=_6(s*.069407491-i*.22898585+o*1.159737864);return[ri(a+.5|0,0,255),ri(l+.5|0,0,255),ri(c+.5|0,0,255),t[3]]}function dG(t){if(t==="none")return hG;if(yE.hasOwnProperty(t))return yE[t];if(v6>=sAe){let n=0;for(const r in yE)(n++&3)===0&&(delete yE[r],--v6)}const e=ule(t);e.length!==4&&QS(t);for(const n of e)isNaN(n)&&QS(t);return yE[t]=e,++v6,e}function mu(t){return Array.isArray(t)?t:dG(t)}function fG(t){let e=t[0];e!=(e|0)&&(e=e+.5|0);let n=t[1];n!=(n|0)&&(n=n+.5|0);let r=t[2];r!=(r|0)&&(r=r+.5|0);const i=t[3]===void 0?1:Math.round(t[3]*1e3)/1e3;return"rgba("+e+","+n+","+r+","+i+")"}class hle extends jA{constructor(e,n,r,i){super(),this.extent=e,this.pixelRatio_=r,this.resolution=n,this.state=typeof i=="function"?Vt.IDLE:i,this.image_=null,this.loader=typeof i=="function"?i:null}changed(){this.dispatchEvent(wn.CHANGE)}getExtent(){return this.extent}getImage(){return this.image_}getPixelRatio(){return this.pixelRatio_}getResolution(){return this.resolution}getState(){return this.state}load(){if(this.state==Vt.IDLE&&this.loader){this.state=Vt.LOADING,this.changed();const e=this.getResolution(),n=Array.isArray(e)?e[0]:e;Nae(()=>this.loader(this.getExtent(),n,this.getPixelRatio())).then(r=>{"image"in r&&(this.image_=r.image),"extent"in r&&(this.extent=r.extent),"resolution"in r&&(this.resolution=r.resolution),"pixelRatio"in r&&(this.pixelRatio_=r.pixelRatio),(r instanceof HTMLImageElement||ale&&r instanceof ImageBitmap||r instanceof HTMLCanvasElement||r instanceof HTMLVideoElement)&&(this.image_=r),this.state=Vt.LOADED}).catch(r=>{this.state=Vt.ERROR,console.error(r)}).finally(()=>this.changed())}}setImage(e){this.image_=e}setResolution(e){this.resolution=e}}function lAe(t,e,n){const r=t;let i=!0,s=!1,o=!1;const a=[I3(r,wn.LOAD,function(){o=!0,s||e()})];return r.src&&uG?(s=!0,r.decode().then(function(){i&&e()}).catch(function(l){i&&(o?e():n())})):a.push(I3(r,wn.ERROR,n)),function(){i=!1,a.forEach(ni)}}function cAe(t,e){return new Promise((n,r)=>{function i(){o(),n(t)}function s(){o(),r(new Error("Image load error"))}function o(){t.removeEventListener("load",i),t.removeEventListener("error",s)}t.addEventListener("load",i),t.addEventListener("error",s)})}function dle(t,e){return e&&(t.src=e),t.src&&uG?new Promise((n,r)=>t.decode().then(()=>n(t)).catch(i=>t.complete&&t.width?n(t):r(i))):cAe(t)}function fle(t,e){return e&&(t.src=e),t.src&&uG&&ale?t.decode().then(()=>createImageBitmap(t)).catch(n=>{if(t.complete&&t.width)return t;throw n}):dle(t)}class uAe{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=1024}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let e=0;for(const n in this.cache_){const r=this.cache_[n];(e++&3)===0&&!r.hasListener()&&(delete this.cache_[n],delete this.patternCache_[n],--this.cacheSize_)}}}get(e,n,r){const i=E6(e,n,r);return i in this.cache_?this.cache_[i]:null}getPattern(e,n,r){const i=E6(e,n,r);return i in this.patternCache_?this.patternCache_[i]:null}set(e,n,r,i,s){const o=E6(e,n,r),a=o in this.cache_;this.cache_[o]=i,s&&(i.getImageState()===Vt.IDLE&&i.load(),i.getImageState()===Vt.LOADING?i.ready().then(()=>{this.patternCache_[o]=j3().createPattern(i.getImage(1),"repeat")}):this.patternCache_[o]=j3().createPattern(i.getImage(1),"repeat")),a||++this.cacheSize_}setSize(e){this.maxCacheSize_=e,this.expire()}}function E6(t,e,n){const r=n?mu(n):"null";return e+":"+t+":"+r}const nu=new uAe;let vE=null;class ple extends jA{constructor(e,n,r,i,s){super(),this.hitDetectionImage_=null,this.image_=e,this.crossOrigin_=r,this.canvas_={},this.color_=s,this.imageState_=i===void 0?Vt.IDLE:i,this.size_=e&&e.width&&e.height?[e.width,e.height]:null,this.src_=n,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===Vt.LOADED){vE||(vE=Rs(1,1,void 0,{willReadFrequently:!0})),vE.drawImage(this.image_,0,0);try{vE.getImageData(0,0,1,1),this.tainted_=!1}catch{vE=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(wn.CHANGE)}handleImageError_(){this.imageState_=Vt.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=Vt.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(e){return this.image_||this.initializeImage_(),this.replaceColor_(e),this.canvas_[e]?this.canvas_[e]:this.image_}getPixelRatio(e){return this.replaceColor_(e),this.canvas_[e]?e:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const e=this.size_[0],n=this.size_[1],r=Rs(e,n);r.fillRect(0,0,e,n),this.hitDetectionImage_=r.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===Vt.IDLE){this.image_||this.initializeImage_(),this.imageState_=Vt.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&dle(this.image_,this.src_).then(e=>{this.image_=e,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(e){if(!this.color_||this.canvas_[e]||this.imageState_!==Vt.LOADED)return;const n=this.image_,r=Rs(Math.ceil(n.width*e),Math.ceil(n.height*e)),i=r.canvas;r.scale(e,e),r.drawImage(n,0,0),r.globalCompositeOperation="multiply",r.fillStyle=iAe(this.color_),r.fillRect(0,0,i.width/e,i.height/e),r.globalCompositeOperation="destination-in",r.drawImage(n,0,0),this.canvas_[e]=i}ready(){return this.ready_||(this.ready_=new Promise(e=>{if(this.imageState_===Vt.LOADED||this.imageState_===Vt.ERROR)e();else{const n=()=>{(this.imageState_===Vt.LOADED||this.imageState_===Vt.ERROR)&&(this.removeEventListener(wn.CHANGE,n),e())};this.addEventListener(wn.CHANGE,n)}})),this.ready_}}function $3(t,e,n,r,i,s){let o=e===void 0?void 0:nu.get(e,n,i);return o||(o=new ple(t,t&&"src"in t?t.src||void 0:e,n,r,i),nu.set(e,n,i,o,s)),s&&o&&!nu.getPattern(e,n,i)&&nu.set(e,n,i,o,s),o}function pd(t){return t?Array.isArray(t)?fG(t):typeof t=="object"&&"src"in t?hAe(t):t:null}function hAe(t){if(!t.offset||!t.size)return nu.getPattern(t.src,"anonymous",t.color);const e=t.src+":"+t.offset,n=nu.getPattern(e,void 0,t.color);if(n)return n;const r=nu.get(t.src,"anonymous",null);if(r.getImageState()!==Vt.LOADED)return null;const i=Rs(t.size[0],t.size[1]);return i.drawImage(r.getImage(1),t.offset[0],t.offset[1],t.size[0],t.size[1],0,0,t.size[0],t.size[1]),$3(i.canvas,e,void 0,Vt.LOADED,t.color,!0),nu.getPattern(e,void 0,t.color)}class mle{drawCustom(e,n,r,i,s){}drawGeometry(e){}setStyle(e){}drawCircle(e,n,r){}drawFeature(e,n,r){}drawGeometryCollection(e,n,r){}drawLineString(e,n,r){}drawMultiLineString(e,n,r){}drawMultiPoint(e,n,r){}drawMultiPolygon(e,n,r){}drawPoint(e,n,r){}drawPolygon(e,n,r){}drawText(e,n,r){}setFillStrokeStyle(e,n){}setImageStyle(e,n){}setTextStyle(e,n){}}const hC="ol-hidden",GA="ol-unselectable",pG="ol-control",kX="ol-collapsed",dAe=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z0-9]+?)\\s*$`].join(""),"i"),AX=["style","variant","weight","size","lineHeight","family"],$F={normal:400,bold:700},FF=function(t){const e=t.match(dAe);if(!e)return null;const n={lineHeight:"normal",size:"1.2em",style:"normal",weight:"400",variant:"normal"};for(let r=0,i=AX.length;r<i;++r){const s=e[r+1];s!==void 0&&(n[AX[r]]=typeof s=="string"?s.trim():s)}return isNaN(Number(n.weight))&&n.weight in $F&&(n.weight=$F[n.weight]),n.families=n.family.split(/,\s?/).map(r=>r.trim().replace(/^['"]|['"]$/g,"")),n},gle="10px sans-serif",ml="#000",Jw="round",ep=[],tp=0,Qw="round",fk=10,pk="#000",mk="center",F3="middle",My=[0,0,0,0],gk=1,j_=new Gd;let _E=null,IX;const VF={},fAe=new Set(["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","emoji","math","fangsong"]);function pAe(t,e,n){return`${t} ${e} 16px "${n}"`}const mAe=(function(){let e,n;async function r(s){await n.ready;const o=await n.load(s);if(o.length===0)return!1;const a=FF(s),l=a.families[0].toLowerCase(),c=a.weight;return o.some(u=>{const h=u.family.replace(/^['"]|['"]$/g,"").toLowerCase(),f=$F[u.weight]||u.weight;return h===l&&u.style===a.style&&f==c})}async function i(){await n.ready;let s=!0;const o=j_.getProperties(),a=Object.keys(o).filter(l=>o[l]<100);for(let l=a.length-1;l>=0;--l){const c=a[l];let u=o[c];u<100&&(await r(c)?(nv(VF),j_.set(c,100)):(u+=10,j_.set(c,u,!0),u<100&&(s=!1)))}e=void 0,s||(e=setTimeout(i,100))}return async function(s){n||(n=cc?self.fonts:document.fonts);const o=FF(s);if(!o)return;const a=o.families;let l=!1;for(const c of a){if(fAe.has(c))continue;const u=pAe(o.style,o.weight,c);j_.get(u)===void 0&&(j_.set(u,0,!0),l=!0)}l&&(clearTimeout(e),e=setTimeout(i,100))}})(),gAe=(function(){let t;return function(e){let n=VF[e];if(n==null){if(cc){const r=FF(e),i=yle(e,"g");n=(isNaN(Number(r.lineHeight))?1.2:Number(r.lineHeight))*(i.actualBoundingBoxAscent+i.actualBoundingBoxDescent)}else t||(t=document.createElement("div"),t.innerHTML="M",t.style.minHeight="0",t.style.maxHeight="none",t.style.height="auto",t.style.padding="0",t.style.border="none",t.style.position="absolute",t.style.display="block",t.style.left="-99999px"),t.style.font=e,document.body.appendChild(t),n=t.offsetHeight,document.body.removeChild(t);VF[e]=n}return n}})();function yle(t,e){return _E||(_E=Rs(1,1)),t!=IX&&(_E.font=t,IX=_E.font),_E.measureText(e)}function vle(t,e){return yle(t,e).width}function PX(t,e,n){if(e in n)return n[e];const r=e.split(`
`).reduce((i,s)=>Math.max(i,vle(t,s)),0);return n[e]=r,r}function yAe(t,e){const n=[],r=[],i=[];let s=0,o=0,a=0,l=0;for(let c=0,u=e.length;c<=u;c+=2){const h=e[c];if(h===`
`||c===u){s=Math.max(s,o),i.push(o),o=0,a+=l,l=0;continue}const f=e[c+1]||t.font,g=vle(f,h);n.push(g),o+=g;const y=gAe(f);r.push(y),l=Math.max(l,y)}return{width:s,height:a,widths:n,heights:r,lineWidths:i}}function vAe(t,e,n,r,i,s,o,a,l,c,u){t.save(),n!==1&&(t.globalAlpha===void 0?t.globalAlpha=h=>h.globalAlpha*=n:t.globalAlpha*=n),e&&t.transform.apply(t,e),r.contextInstructions?(t.translate(l,c),t.scale(u[0],u[1]),_Ae(r,t)):u[0]<0||u[1]<0?(t.translate(l,c),t.scale(u[0],u[1]),t.drawImage(r,i,s,o,a,0,0,o,a)):t.drawImage(r,i,s,o,a,l,c,o*u[0],a*u[1]),t.restore()}function _Ae(t,e){const n=t.contextInstructions;for(let r=0,i=n.length;r<i;r+=2)Array.isArray(n[r+1])?e[n[r]].apply(e,n[r+1]):e[n[r]]=n[r+1]}class xAe extends mle{constructor(e,n,r,i,s,o,a){super(),this.context_=e,this.pixelRatio_=n,this.extent_=r,this.transform_=i,this.transformRotation_=i?q2(Math.atan2(i[1],i[0]),10):0,this.viewRotation_=s,this.squaredTolerance_=o,this.userTransform_=a,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=Ws()}drawImages_(e,n,r,i){if(!this.image_)return;const s=vd(e,n,r,i,this.transform_,this.pixelCoordinates_),o=this.context_,a=this.tmpLocalTransform_,l=o.globalAlpha;this.imageOpacity_!=1&&(o.globalAlpha=l*this.imageOpacity_);let c=this.imageRotation_;this.transformRotation_===0&&(c-=this.viewRotation_),this.imageRotateWithView_&&(c+=this.viewRotation_);for(let u=0,h=s.length;u<h;u+=2){const f=s[u]-this.imageAnchorX_,g=s[u+1]-this.imageAnchorY_;if(c!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const y=f+this.imageAnchorX_,_=g+this.imageAnchorY_;pu(a,y,_,1,1,c,-y,-_),o.save(),o.transform.apply(o,a),o.translate(y,_),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.restore()}else o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,f,g,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(o.globalAlpha=l)}drawText_(e,n,r,i){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const s=vd(e,n,r,i,this.transform_,this.pixelCoordinates_),o=this.context_;let a=this.textRotation_;for(this.transformRotation_===0&&(a-=this.viewRotation_),this.textRotateWithView_&&(a+=this.viewRotation_);n<r;n+=i){const l=s[n]+this.textOffsetX_,c=s[n+1]+this.textOffsetY_;a!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(o.save(),o.translate(l-this.textOffsetX_,c-this.textOffsetY_),o.rotate(a),o.translate(this.textOffsetX_,this.textOffsetY_),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.restore()):(this.textStrokeState_&&o.strokeText(this.text_,l,c),this.textFillState_&&o.fillText(this.text_,l,c))}}moveToLineTo_(e,n,r,i,s){const o=this.context_,a=vd(e,n,r,i,this.transform_,this.pixelCoordinates_);o.moveTo(a[0],a[1]);let l=a.length;s&&(l-=2);for(let c=2;c<l;c+=2)o.lineTo(a[c],a[c+1]);return s&&o.closePath(),r}drawRings_(e,n,r,i){for(let s=0,o=r.length;s<o;++s)n=this.moveToLineTo_(e,n,r[s],i,!0);return n}drawCircle(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!oa(this.extent_,e.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const n=jke(e,this.transform_,this.pixelCoordinates_),r=n[2]-n[0],i=n[3]-n[1],s=Math.sqrt(r*r+i*i),o=this.context_;o.beginPath(),o.arc(n[0],n[1],s,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}this.text_!==""&&this.drawText_(e.getCenter(),0,2,2)}}setStyle(e){this.setFillStrokeStyle(e.getFill(),e.getStroke()),this.setImageStyle(e.getImage()),this.setTextStyle(e.getText())}setTransform(e){this.transform_=e}drawGeometry(e){switch(e.getType()){case"Point":this.drawPoint(e);break;case"LineString":this.drawLineString(e);break;case"Polygon":this.drawPolygon(e);break;case"MultiPoint":this.drawMultiPoint(e);break;case"MultiLineString":this.drawMultiLineString(e);break;case"MultiPolygon":this.drawMultiPolygon(e);break;case"GeometryCollection":this.drawGeometryCollection(e);break;case"Circle":this.drawCircle(e);break}}drawFeature(e,n){const r=n.getGeometryFunction()(e);r&&(this.setStyle(n),this.drawGeometry(r))}drawGeometryCollection(e){const n=e.getGeometriesArray();for(let r=0,i=n.length;r<i;++r)this.drawGeometry(n[r])}drawPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const n=e.getFlatCoordinates(),r=e.getStride();this.image_&&this.drawImages_(n,0,n.length,r),this.text_!==""&&this.drawText_(n,0,n.length,r)}drawMultiPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const n=e.getFlatCoordinates(),r=e.getStride();this.image_&&this.drawImages_(n,0,n.length,r),this.text_!==""&&this.drawText_(n,0,n.length,r)}drawLineString(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!oa(this.extent_,e.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const n=this.context_,r=e.getFlatCoordinates();n.beginPath(),this.moveToLineTo_(r,0,r.length,e.getStride(),!1),n.stroke()}if(this.text_!==""){const n=e.getFlatMidpoint();this.drawText_(n,0,2,2)}}}drawMultiLineString(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const n=e.getExtent();if(oa(this.extent_,n)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const r=this.context_,i=e.getFlatCoordinates();let s=0;const o=e.getEnds(),a=e.getStride();r.beginPath();for(let l=0,c=o.length;l<c;++l)s=this.moveToLineTo_(i,s,o[l],a,!1);r.stroke()}if(this.text_!==""){const r=e.getFlatMidpoints();this.drawText_(r,0,r.length,2)}}}drawPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!oa(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const n=this.context_;n.beginPath(),this.drawRings_(e.getOrientedFlatCoordinates(),0,e.getEnds(),e.getStride()),this.fillState_&&n.fill(),this.strokeState_&&n.stroke()}if(this.text_!==""){const n=e.getFlatInteriorPoint();this.drawText_(n,0,2,2)}}}drawMultiPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!oa(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const n=this.context_,r=e.getOrientedFlatCoordinates();let i=0;const s=e.getEndss(),o=e.getStride();n.beginPath();for(let a=0,l=s.length;a<l;++a){const c=s[a];i=this.drawRings_(r,i,c,o)}this.fillState_&&n.fill(),this.strokeState_&&n.stroke()}if(this.text_!==""){const n=e.getFlatInteriorPoints();this.drawText_(n,0,n.length,2)}}}setContextFillState_(e){const n=this.context_,r=this.contextFillState_;r?r.fillStyle!=e.fillStyle&&(r.fillStyle=e.fillStyle,n.fillStyle=e.fillStyle):(n.fillStyle=e.fillStyle,this.contextFillState_={fillStyle:e.fillStyle})}setContextStrokeState_(e){const n=this.context_,r=this.contextStrokeState_;r?(r.lineCap!=e.lineCap&&(r.lineCap=e.lineCap,n.lineCap=e.lineCap),zd(r.lineDash,e.lineDash)||n.setLineDash(r.lineDash=e.lineDash),r.lineDashOffset!=e.lineDashOffset&&(r.lineDashOffset=e.lineDashOffset,n.lineDashOffset=e.lineDashOffset),r.lineJoin!=e.lineJoin&&(r.lineJoin=e.lineJoin,n.lineJoin=e.lineJoin),r.lineWidth!=e.lineWidth&&(r.lineWidth=e.lineWidth,n.lineWidth=e.lineWidth),r.miterLimit!=e.miterLimit&&(r.miterLimit=e.miterLimit,n.miterLimit=e.miterLimit),r.strokeStyle!=e.strokeStyle&&(r.strokeStyle=e.strokeStyle,n.strokeStyle=e.strokeStyle)):(n.lineCap=e.lineCap,n.setLineDash(e.lineDash),n.lineDashOffset=e.lineDashOffset,n.lineJoin=e.lineJoin,n.lineWidth=e.lineWidth,n.miterLimit=e.miterLimit,n.strokeStyle=e.strokeStyle,this.contextStrokeState_={lineCap:e.lineCap,lineDash:e.lineDash,lineDashOffset:e.lineDashOffset,lineJoin:e.lineJoin,lineWidth:e.lineWidth,miterLimit:e.miterLimit,strokeStyle:e.strokeStyle})}setContextTextState_(e){const n=this.context_,r=this.contextTextState_,i=e.textAlign?e.textAlign:mk;r?(r.font!=e.font&&(r.font=e.font,n.font=e.font),r.textAlign!=i&&(r.textAlign=i,n.textAlign=i),r.textBaseline!=e.textBaseline&&(r.textBaseline=e.textBaseline,n.textBaseline=e.textBaseline)):(n.font=e.font,n.textAlign=i,n.textBaseline=e.textBaseline,this.contextTextState_={font:e.font,textAlign:i,textBaseline:e.textBaseline})}setFillStrokeStyle(e,n){if(!e)this.fillState_=null;else{const r=e.getColor();this.fillState_={fillStyle:pd(r||ml)}}if(!n)this.strokeState_=null;else{const r=n.getColor(),i=n.getLineCap(),s=n.getLineDash(),o=n.getLineDashOffset(),a=n.getLineJoin(),l=n.getWidth(),c=n.getMiterLimit(),u=s||ep;this.strokeState_={lineCap:i!==void 0?i:Jw,lineDash:this.pixelRatio_===1?u:u.map(h=>h*this.pixelRatio_),lineDashOffset:(o||tp)*this.pixelRatio_,lineJoin:a!==void 0?a:Qw,lineWidth:(l!==void 0?l:gk)*this.pixelRatio_,miterLimit:c!==void 0?c:fk,strokeStyle:pd(r||pk)}}}setImageStyle(e){let n;if(!e||!(n=e.getSize())){this.image_=null;return}const r=e.getPixelRatio(this.pixelRatio_),i=e.getAnchor(),s=e.getOrigin();this.image_=e.getImage(this.pixelRatio_),this.imageAnchorX_=i[0]*r,this.imageAnchorY_=i[1]*r,this.imageHeight_=n[1]*r,this.imageOpacity_=e.getOpacity(),this.imageOriginX_=s[0],this.imageOriginY_=s[1],this.imageRotateWithView_=e.getRotateWithView(),this.imageRotation_=e.getRotation();const o=e.getScaleArray();this.imageScale_=[o[0]*this.pixelRatio_/r,o[1]*this.pixelRatio_/r],this.imageWidth_=n[0]*r}setTextStyle(e){if(!e)this.text_="";else{const n=e.getFill();if(!n)this.textFillState_=null;else{const g=n.getColor();this.textFillState_={fillStyle:pd(g||ml)}}const r=e.getStroke();if(!r)this.textStrokeState_=null;else{const g=r.getColor(),y=r.getLineCap(),_=r.getLineDash(),b=r.getLineDashOffset(),T=r.getLineJoin(),A=r.getWidth(),I=r.getMiterLimit();this.textStrokeState_={lineCap:y!==void 0?y:Jw,lineDash:_||ep,lineDashOffset:b||tp,lineJoin:T!==void 0?T:Qw,lineWidth:A!==void 0?A:gk,miterLimit:I!==void 0?I:fk,strokeStyle:pd(g||pk)}}const i=e.getFont(),s=e.getOffsetX(),o=e.getOffsetY(),a=e.getRotateWithView(),l=e.getRotation(),c=e.getScaleArray(),u=e.getText(),h=e.getTextAlign(),f=e.getTextBaseline();this.textState_={font:i!==void 0?i:gle,textAlign:h!==void 0?h:mk,textBaseline:f!==void 0?f:F3},this.text_=u!==void 0?Array.isArray(u)?u.reduce((g,y,_)=>g+=_%2?" ":y,""):u:"",this.textOffsetX_=s!==void 0?this.pixelRatio_*s:0,this.textOffsetY_=o!==void 0?this.pixelRatio_*o:0,this.textRotateWithView_=a!==void 0?a:!1,this.textRotation_=l!==void 0?l:0,this.textScale_=[this.pixelRatio_*c[0],this.pixelRatio_*c[1]]}}}const wAe=.5,_le={Point:PAe,LineString:kAe,Polygon:RAe,MultiPoint:CAe,MultiLineString:AAe,MultiPolygon:IAe,GeometryCollection:TAe,Circle:EAe};function bAe(t,e){return parseInt(Qt(t),10)-parseInt(Qt(e),10)}function CX(t,e){const n=xle(t,e);return n*n}function xle(t,e){return wAe*t/e}function EAe(t,e,n,r,i){const s=n.getFill(),o=n.getStroke();if(s||o){const l=t.getBuilder(n.getZIndex(),"Circle");l.setFillStrokeStyle(s,o),l.drawCircle(e,r,i)}const a=n.getText();if(a&&a.getText()){const l=t.getBuilder(n.getZIndex(),"Text");l.setTextStyle(a),l.drawText(e,r)}}function RX(t,e,n,r,i,s,o,a){const l=[],c=n.getImage();if(c){let f=!0;const g=c.getImageState();g==Vt.LOADED||g==Vt.ERROR?f=!1:g==Vt.IDLE&&c.load(),f&&l.push(c.ready())}const u=n.getFill();u&&u.loading()&&l.push(u.ready());const h=l.length>0;return h&&Promise.all(l).then(()=>i(null)),SAe(t,e,n,r,s,o,a),h}function SAe(t,e,n,r,i,s,o){const a=n.getGeometryFunction()(e);if(!a)return;const l=a.simplifyTransformed(r,i);if(n.getRenderer())wle(t,l,n,e,o);else{const u=_le[l.getType()];u(t,l,n,e,o,s)}}function wle(t,e,n,r,i){if(e.getType()=="GeometryCollection"){const o=e.getGeometries();for(let a=0,l=o.length;a<l;++a)wle(t,o[a],n,r,i);return}t.getBuilder(n.getZIndex(),"Default").drawCustom(e,r,n.getRenderer(),n.getHitDetectionRenderer(),i)}function TAe(t,e,n,r,i,s){const o=e.getGeometriesArray();let a,l;for(a=0,l=o.length;a<l;++a){const c=_le[o[a].getType()];c(t,o[a],n,r,i,s)}}function kAe(t,e,n,r,i){const s=n.getStroke();if(s){const a=t.getBuilder(n.getZIndex(),"LineString");a.setFillStrokeStyle(null,s),a.drawLineString(e,r,i)}const o=n.getText();if(o&&o.getText()){const a=t.getBuilder(n.getZIndex(),"Text");a.setTextStyle(o),a.drawText(e,r,i)}}function AAe(t,e,n,r,i){const s=n.getStroke();if(s){const a=t.getBuilder(n.getZIndex(),"LineString");a.setFillStrokeStyle(null,s),a.drawMultiLineString(e,r,i)}const o=n.getText();if(o&&o.getText()){const a=t.getBuilder(n.getZIndex(),"Text");a.setTextStyle(o),a.drawText(e,r,i)}}function IAe(t,e,n,r,i){const s=n.getFill(),o=n.getStroke();if(o||s){const l=t.getBuilder(n.getZIndex(),"Polygon");l.setFillStrokeStyle(s,o),l.drawMultiPolygon(e,r,i)}const a=n.getText();if(a&&a.getText()){const l=t.getBuilder(n.getZIndex(),"Text");l.setTextStyle(a),l.drawText(e,r,i)}}function PAe(t,e,n,r,i,s){const o=n.getImage(),a=n.getText(),l=a&&a.getText(),c=s&&o&&l?{}:void 0;if(o){if(o.getImageState()!=Vt.LOADED)return;const u=t.getBuilder(n.getZIndex(),"Image");u.setImageStyle(o,c),u.drawPoint(e,r,i)}if(l){const u=t.getBuilder(n.getZIndex(),"Text");u.setTextStyle(a,c),u.drawText(e,r,i)}}function CAe(t,e,n,r,i,s){const o=n.getImage(),a=o&&o.getOpacity()!==0,l=n.getText(),c=l&&l.getText(),u=s&&a&&c?{}:void 0;if(a){if(o.getImageState()!=Vt.LOADED)return;const h=t.getBuilder(n.getZIndex(),"Image");h.setImageStyle(o,u),h.drawMultiPoint(e,r,i)}if(c){const h=t.getBuilder(n.getZIndex(),"Text");h.setTextStyle(l,u),h.drawText(e,r,i)}}function RAe(t,e,n,r,i){const s=n.getFill(),o=n.getStroke();if(s||o){const l=t.getBuilder(n.getZIndex(),"Polygon");l.setFillStrokeStyle(s,o),l.drawPolygon(e,r,i)}const a=n.getText();if(a&&a.getText()){const l=t.getBuilder(n.getZIndex(),"Text");l.setTextStyle(a),l.drawText(e,r,i)}}let MAe=!1;function NAe(t,e,n,r,i,s,o){const a=new XMLHttpRequest;a.open("GET",typeof t=="function"?t(n,r,i):t,!0),e.getType()=="arraybuffer"&&(a.responseType="arraybuffer"),a.withCredentials=MAe,a.onload=function(l){if(!a.status||a.status>=200&&a.status<300){const c=e.getType();try{let u;c=="text"||c=="json"?u=a.responseText:c=="xml"?u=a.responseXML||a.responseText:c=="arraybuffer"&&(u=a.response),u?s(e.readFeatures(u,{extent:n,featureProjection:i}),e.readProjection(u)):o()}catch{o()}}else o()},a.onerror=o,a.send()}function MX(t,e){return function(n,r,i,s,o){NAe(t,e,n,r,i,(a,l)=>{this.addFeatures(a),s!==void 0&&s(a)},()=>{this.changed(),o!==void 0&&o()})}}function OAe(t,e){return[[-1/0,-1/0,1/0,1/0]]}function ble(t,e,n,r){const i=[];let s=Ba();for(let o=0,a=n.length;o<a;++o){const l=n[o];s=Bz(t,e,l[0],r),i.push((s[0]+s[2])/2,(s[1]+s[3])/2),e=l[l.length-1]}return i}function mG(t,e,n,r,i,s,o){let a,l,c,u,h,f,g;const y=i[s+1],_=[];for(let A=0,I=n.length;A<I;++A){const P=n[A];for(u=t[P-r],f=t[P-r+1],a=e;a<P;a+=r)h=t[a],g=t[a+1],(y<=f&&g<=y||f<=y&&y<=g)&&(c=(y-f)/(g-f)*(h-u)+u,_.push(c)),u=h,f=g}let b=NaN,T=-1/0;for(_.sort(Zf),u=_[0],a=1,l=_.length;a<l;++a){h=_[a];const A=Math.abs(h-u);A>T&&(c=(u+h)/2,aG(t,e,n,r,c,y)&&(b=c,T=A)),u=h}return isNaN(b)&&(b=i[s]),o?(o.push(b,y,T),o):[b,y,T]}function Ele(t,e,n,r,i){let s=[];for(let o=0,a=n.length;o<a;++o){const l=n[o];s=mG(t,e,l,r,i,2*o,s),e=l[l.length-1]}return s}function LAe(t,e,n,r){for(;e<n-r;){for(let i=0;i<r;++i){const s=t[e+i];t[e+i]=t[n-r+i],t[n-r+i]=s}e+=r,n-=r}}function gG(t,e,n,r){let i=0,s=t[n-r],o=t[n-r+1];for(;e<n;e+=r){const a=t[e],l=t[e+1];i+=(a-s)*(l+o),s=a,o=l}return i===0?void 0:i>0}function yG(t,e,n,r,i){i=i!==void 0?i:!1;for(let s=0,o=n.length;s<o;++s){const a=n[s],l=gG(t,e,a,r);if(s===0){if(i&&l||!i&&!l)return!1}else if(i&&!l||!i&&l)return!1;e=a}return!0}function Sle(t,e,n,r,i){for(let s=0,o=n.length;s<o;++s){const a=n[s];if(!yG(t,e,a,r,i))return!1;a.length&&(e=a[a.length-1])}return!0}function V3(t,e,n,r,i){i=i!==void 0?i:!1;for(let s=0,o=n.length;s<o;++s){const a=n[s],l=gG(t,e,a,r);(s===0?i&&l||!i&&!l:i&&!l||!i&&l)&&LAe(t,e,a,r),e=a}return e}function zF(t,e,n,r,i){for(let s=0,o=n.length;s<o;++s)e=V3(t,e,n[s],r,i);return e}function Tle(t,e){const n=[];let r=0,i=0,s;for(let o=0,a=e.length;o<a;++o){const l=e[o],c=gG(t,r,l,2);if(s===void 0&&(s=c),c===s)n.push(e.slice(i,o+1));else{if(n.length===0)continue;n[n.length-1].push(e[i])}i=o+1,r=l}return n}let kle=class Ale extends t0{constructor(e,n,r){super(),r!==void 0&&n===void 0?this.setFlatCoordinates(r,e):(n=n||0,this.setCenterAndRadius(e,n,r))}clone(){const e=new Ale(this.flatCoordinates.slice(),void 0,this.layout);return e.applyProperties(this),e}closestPointXY(e,n,r,i){const s=this.flatCoordinates,o=e-s[0],a=n-s[1],l=o*o+a*a;if(l<i){if(l===0)for(let c=0;c<this.stride;++c)r[c]=s[c];else{const c=this.getRadius()/Math.sqrt(l);r[0]=s[0]+c*o,r[1]=s[1]+c*a;for(let u=2;u<this.stride;++u)r[u]=s[u]}return r.length=this.stride,l}return i}containsXY(e,n){const r=this.flatCoordinates,i=e-r[0],s=n-r[1];return i*i+s*s<=this.getRadiusSquared_()}getCenter(){return this.flatCoordinates.slice(0,this.stride)}computeExtent(e){const n=this.flatCoordinates,r=n[this.stride]-n[0];return up(n[0]-r,n[1]-r,n[0]+r,n[1]+r,e)}getRadius(){return Math.sqrt(this.getRadiusSquared_())}getRadiusSquared_(){const e=this.flatCoordinates[this.stride]-this.flatCoordinates[0],n=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return e*e+n*n}getType(){return"Circle"}intersectsExtent(e){const n=this.getExtent();if(oa(e,n)){const r=this.getCenter();return e[0]<=r[0]&&e[2]>=r[0]||e[1]<=r[1]&&e[3]>=r[1]?!0:Hz(e,this.intersectsCoordinate.bind(this))}return!1}setCenter(e){const n=this.stride,r=this.flatCoordinates[n]-this.flatCoordinates[0],i=e.slice();i[n]=i[0]+r;for(let s=1;s<n;++s)i[n+s]=e[s];this.setFlatCoordinates(this.layout,i),this.changed()}setCenterAndRadius(e,n,r){this.setLayout(r,e,0),this.flatCoordinates||(this.flatCoordinates=[]);const i=this.flatCoordinates;let s=Qae(i,0,e,this.stride);i[s++]=i[0]+n;for(let o=1,a=this.stride;o<a;++o)i[s++]=i[o];i.length=s,this.changed()}getCoordinates(){return null}setCoordinates(e,n){}setRadius(e){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+e,this.changed()}rotate(e,n){const r=this.getCenter(),i=this.getStride();this.setCenter(nG(r,0,r.length,i,e,n,r)),this.changed()}};kle.prototype.transform;class cu extends Jae{constructor(e){super(),this.geometries_=e,this.changeEventsKeys_=[],this.listenGeometriesChange_()}unlistenGeometriesChange_(){this.changeEventsKeys_.forEach(ni),this.changeEventsKeys_.length=0}listenGeometriesChange_(){const e=this.geometries_;for(let n=0,r=e.length;n<r;++n)this.changeEventsKeys_.push(Yn(e[n],wn.CHANGE,this.changed,this))}clone(){const e=new cu(S6(this.geometries_));return e.applyProperties(this),e}closestPointXY(e,n,r,i){if(i<rv(this.getExtent(),e,n))return i;const s=this.geometries_;for(let o=0,a=s.length;o<a;++o)i=s[o].closestPointXY(e,n,r,i);return i}containsXY(e,n){const r=this.geometries_;for(let i=0,s=r.length;i<s;++i)if(r[i].containsXY(e,n))return!0;return!1}computeExtent(e){FA(e);const n=this.geometries_;for(let r=0,i=n.length;r<i;++r)Wz(e,n[r].getExtent());return e}getGeometries(){return S6(this.geometries_)}getGeometriesArray(){return this.geometries_}getGeometriesArrayRecursive(){let e=[];const n=this.geometries_;for(let r=0,i=n.length;r<i;++r)n[r].getType()===this.getType()?e=e.concat(n[r].getGeometriesArrayRecursive()):e.push(n[r]);return e}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<this.simplifiedGeometryMaxMinSquaredTolerance)return this;const n=[],r=this.geometries_;let i=!1;for(let s=0,o=r.length;s<o;++s){const a=r[s],l=a.getSimplifiedGeometry(e);n.push(l),l!==a&&(i=!0)}return i?new cu(n):(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getType(){return"GeometryCollection"}intersectsExtent(e){const n=this.geometries_;for(let r=0,i=n.length;r<i;++r)if(n[r].intersectsExtent(e))return!0;return!1}isEmpty(){return this.geometries_.length===0}rotate(e,n){const r=this.geometries_;for(let i=0,s=r.length;i<s;++i)r[i].rotate(e,n);this.changed()}scale(e,n,r){r||(r=gh(this.getExtent()));const i=this.geometries_;for(let s=0,o=i.length;s<o;++s)i[s].scale(e,n,r);this.changed()}setGeometries(e){this.setGeometriesArray(S6(e))}setGeometriesArray(e){this.unlistenGeometriesChange_(),this.geometries_=e,this.listenGeometriesChange_(),this.changed()}applyTransform(e){const n=this.geometries_;for(let r=0,i=n.length;r<i;++r)n[r].applyTransform(e);this.changed()}translate(e,n){const r=this.geometries_;for(let i=0,s=r.length;i<s;++i)r[i].translate(e,n);this.changed()}disposeInternal(){this.unlistenGeometriesChange_(),super.disposeInternal()}}function S6(t){return t.map(e=>e.clone())}function Ile(t,e,n,r){let i=0;const s=t[n-r],o=t[n-r+1];let a=0,l=0;for(;e<n;e+=r){const c=t[e]-s,u=t[e+1]-o;i+=l*c-a*u,a=c,l=u}return i/2}function Ple(t,e,n,r){let i=0;for(let s=0,o=n.length;s<o;++s){const a=n[s];i+=Ile(t,e,a,r),e=a}return i}function DAe(t,e,n,r){let i=0;for(let s=0,o=n.length;s<o;++s){const a=n[s];i+=Ple(t,e,a,r),e=a[a.length-1]}return i}class yk extends t0{constructor(e,n){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,n!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(n,e):this.setCoordinates(e,n)}clone(){return new yk(this.flatCoordinates.slice(),this.layout)}closestPointXY(e,n,r,i){return i<rv(this.getExtent(),e,n)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(rG(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),sG(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,e,n,r,i))}getArea(){return Ile(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return Ym(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(e){const n=[];return n.length=A5(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,n,0),new yk(n,"XY")}getType(){return"LinearRing"}intersectsExtent(e){return!1}setCoordinates(e,n){this.setLayout(n,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=T5(this.flatCoordinates,0,e,this.stride),this.changed()}}class yh extends t0{constructor(e,n,r){if(super(),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(e[0]))this.setCoordinates(e,n);else if(n!==void 0&&r)this.setFlatCoordinates(n,e),this.ends_=r;else{const i=e,s=[],o=[];for(let l=0,c=i.length;l<c;++l){const u=i[l];_r(s,u.getFlatCoordinates()),o.push(s.length)}const a=i.length===0?this.getLayout():i[0].getLayout();this.setFlatCoordinates(a,s),this.ends_=o}}appendLineString(e){_r(this.flatCoordinates,e.getFlatCoordinates().slice()),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new yh(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,n,r,i){return i<rv(this.getExtent(),e,n)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(iG(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),oG(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,e,n,r,i))}getCoordinateAtM(e,n,r){return this.layout!="XYM"&&this.layout!="XYZM"||this.flatCoordinates.length===0?null:(n=n!==void 0?n:!1,r=r!==void 0?r:!1,Vke(this.flatCoordinates,0,this.ends_,this.stride,e,n,r))}getCoordinates(){return dk(this.flatCoordinates,0,this.ends_,this.stride)}getEnds(){return this.ends_}getLineString(e){return e<0||this.ends_.length<=e?null:new ts(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLineStrings(){const e=this.flatCoordinates,n=this.ends_,r=this.layout,i=[];let s=0;for(let o=0,a=n.length;o<a;++o){const l=n[o],c=new ts(e.slice(s,l),r);i.push(c),s=l}return i}getLength(){const e=this.ends_;let n=0,r=0;for(let i=0,s=e.length;i<s;++i)r+=lG(this.flatCoordinates,n,e[i],this.stride),n=e[i];return r}getFlatMidpoints(){const e=[],n=this.flatCoordinates;let r=0;const i=this.ends_,s=this.stride;for(let o=0,a=i.length;o<a;++o){const l=i[o],c=D3(n,r,l,s,.5);_r(e,c),r=l}return e}getSimplifiedGeometryInternal(e){const n=[],r=[];return n.length=ile(this.flatCoordinates,0,this.ends_,this.stride,e,n,0,r),new yh(n,"XY",r)}getType(){return"MultiLineString"}intersectsExtent(e){return Uke(this.flatCoordinates,0,this.ends_,this.stride,e)}setCoordinates(e,n){this.setLayout(n,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const r=zA(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=r.length===0?0:r[r.length-1],this.changed()}}class n0 extends t0{constructor(e,n){super(),n&&!Array.isArray(e[0])?this.setFlatCoordinates(n,e):this.setCoordinates(e,n)}appendPoint(e){_r(this.flatCoordinates,e.getFlatCoordinates()),this.changed()}clone(){const e=new n0(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,n,r,i){if(i<rv(this.getExtent(),e,n))return i;const s=this.flatCoordinates,o=this.stride;for(let a=0,l=s.length;a<l;a+=o){const c=Qf(e,n,s[a],s[a+1]);if(c<i){i=c;for(let u=0;u<o;++u)r[u]=s[a+u];r.length=o}}return i}getCoordinates(){return Ym(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getPoint(e){const n=this.flatCoordinates.length/this.stride;return e<0||n<=e?null:new Ti(this.flatCoordinates.slice(e*this.stride,(e+1)*this.stride),this.layout)}getPoints(){const e=this.flatCoordinates,n=this.layout,r=this.stride,i=[];for(let s=0,o=e.length;s<o;s+=r){const a=new Ti(e.slice(s,s+r),n);i.push(a)}return i}getType(){return"MultiPoint"}intersectsExtent(e){const n=this.flatCoordinates,r=this.stride;for(let i=0,s=n.length;i<s;i+=r){const o=n[i],a=n[i+1];if(Uz(e,o,a))return!0}return!1}setCoordinates(e,n){this.setLayout(n,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=T5(this.flatCoordinates,0,e,this.stride),this.changed()}}class kl extends t0{constructor(e,n,r){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,n!==void 0&&r?(this.setFlatCoordinates(n,e),this.ends_=r):this.setCoordinates(e,n)}appendLinearRing(e){this.flatCoordinates?_r(this.flatCoordinates,e.getFlatCoordinates()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new kl(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,n,r,i){return i<rv(this.getExtent(),e,n)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(iG(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),oG(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,e,n,r,i))}containsXY(e,n){return aG(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,n)}getArea(){return Ple(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(e){let n;return e!==void 0?(n=this.getOrientedFlatCoordinates().slice(),V3(n,0,this.ends_,this.stride,e)):n=this.flatCoordinates,dk(n,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const e=gh(this.getExtent());this.flatInteriorPoint_=mG(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new Ti(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(e){return e<0||this.ends_.length<=e?null:new yk(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLinearRings(){const e=this.layout,n=this.flatCoordinates,r=this.ends_,i=[];let s=0;for(let o=0,a=r.length;o<a;++o){const l=r[o],c=new yk(n.slice(s,l),e);i.push(c),s=l}return i}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;yG(e,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=V3(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const n=[],r=[];return n.length=cG(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(e),n,0,r),new kl(n,"XY",r)}getType(){return"Polygon"}intersectsExtent(e){return rle(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e)}setCoordinates(e,n){this.setLayout(n,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const r=zA(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=r.length===0?0:r[r.length-1],this.changed()}}function NX(t){if(H2(t))throw new Error("Cannot create polygon from empty extent");const e=t[0],n=t[1],r=t[2],i=t[3],s=[e,n,e,i,r,i,r,n,e,n];return new kl(s,"XY",[s.length])}class hp extends t0{constructor(e,n,r){if(super(),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!r&&!Array.isArray(e[0])){const i=e,s=[],o=[];for(let a=0,l=i.length;a<l;++a){const c=i[a],u=s.length,h=c.getEnds();for(let f=0,g=h.length;f<g;++f)h[f]+=u;_r(s,c.getFlatCoordinates()),o.push(h)}n=i.length===0?this.getLayout():i[0].getLayout(),e=s,r=o}n!==void 0&&r?(this.setFlatCoordinates(n,e),this.endss_=r):this.setCoordinates(e,n)}appendPolygon(e){let n;if(!this.flatCoordinates)this.flatCoordinates=e.getFlatCoordinates().slice(),n=e.getEnds().slice(),this.endss_.push();else{const r=this.flatCoordinates.length;_r(this.flatCoordinates,e.getFlatCoordinates()),n=e.getEnds().slice();for(let i=0,s=n.length;i<s;++i)n[i]+=r}this.endss_.push(n),this.changed()}clone(){const e=this.endss_.length,n=new Array(e);for(let i=0;i<e;++i)n[i]=this.endss_[i].slice();const r=new hp(this.flatCoordinates.slice(),this.layout,n);return r.applyProperties(this),r}closestPointXY(e,n,r,i){return i<rv(this.getExtent(),e,n)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt($ke(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Fke(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,e,n,r,i))}containsXY(e,n){return Gke(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e,n)}getArea(){return DAe(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}getCoordinates(e){let n;return e!==void 0?(n=this.getOrientedFlatCoordinates().slice(),zF(n,0,this.endss_,this.stride,e)):n=this.flatCoordinates,DF(n,0,this.endss_,this.stride)}getEndss(){return this.endss_}getFlatInteriorPoints(){if(this.flatInteriorPointsRevision_!=this.getRevision()){const e=ble(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=Ele(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}getInteriorPoints(){return new n0(this.getFlatInteriorPoints().slice(),"XYM")}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;Sle(e,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=zF(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const n=[],r=[];return n.length=Hke(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(e),n,0,r),new hp(n,"XY",r)}getPolygon(e){if(e<0||this.endss_.length<=e)return null;let n;if(e===0)n=0;else{const s=this.endss_[e-1];n=s[s.length-1]}const r=this.endss_[e].slice(),i=r[r.length-1];if(n!==0)for(let s=0,o=r.length;s<o;++s)r[s]-=n;return new kl(this.flatCoordinates.slice(n,i),this.layout,r)}getPolygons(){const e=this.layout,n=this.flatCoordinates,r=this.endss_,i=[];let s=0;for(let o=0,a=r.length;o<a;++o){const l=r[o].slice(),c=l[l.length-1];if(s!==0)for(let h=0,f=l.length;h<f;++h)l[h]-=s;const u=new kl(n.slice(s,c),e,l);i.push(u),s=c}return i}getType(){return"MultiPolygon"}intersectsExtent(e){return Bke(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e)}setCoordinates(e,n){this.setLayout(n,e,3),this.flatCoordinates||(this.flatCoordinates=[]);const r=ele(this.flatCoordinates,0,e,this.stride,this.endss_);if(r.length===0)this.flatCoordinates.length=0;else{const i=r[r.length-1];this.flatCoordinates.length=i.length===0?0:i[i.length-1]}this.changed()}}const OX=Ws();class gl{constructor(e,n,r,i,s,o){this.styleFunction,this.extent_,this.id_=o,this.type_=e,this.flatCoordinates_=n,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=r||null,this.properties_=s,this.squaredTolerance_,this.stride_=i,this.simplifiedGeometry_}get(e){return this.properties_[e]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?ZS(this.flatCoordinates_):Bz(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const e=gh(this.getExtent());this.flatInteriorPoints_=mG(this.flatCoordinates_,0,this.ends_,2,e,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const e=Tle(this.flatCoordinates_,this.ends_),n=ble(this.flatCoordinates_,0,e,2);this.flatInteriorPoints_=Ele(this.flatCoordinates_,0,e,2,n)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=D3(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const e=this.flatCoordinates_;let n=0;const r=this.ends_;for(let i=0,s=r.length;i<s;++i){const o=r[i],a=D3(e,n,o,2,.5);_r(this.flatMidpoints_,a),n=o}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(e){return this}simplifyTransformed(e,n){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(e){e=Jr(e);const n=e.getExtent(),r=e.getWorldExtent();if(n&&r){const i=Ps(r)/Ps(n);pu(OX,r[0],r[3],i,-i,0,0,0),vd(this.flatCoordinates_,0,this.flatCoordinates_.length,2,OX,this.flatCoordinates_)}}applyTransform(e){e(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){return new gl(this.type_,this.flatCoordinates_.slice(),this.ends_?.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=Mae((e,n)=>{if(e===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),n&&this.simplifiedGeometry_.applyTransform(n);const r=this.simplifiedGeometry_.getFlatCoordinates();let i;switch(this.type_){case"LineString":r.length=A5(r,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,e,r,0),i=[r.length];break;case"MultiLineString":i=[],r.length=ile(r,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,e,r,0,i);break;case"Polygon":i=[],r.length=cG(r,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(e),r,0,i);break}return i&&(this.simplifiedGeometry_=new gl(this.type_,r,i,2,this.properties_,this.id_)),this.squaredTolerance_=e,this.simplifiedGeometry_}),this}}gl.prototype.getFlatCoordinates=gl.prototype.getOrientedFlatCoordinates;function Cle(t,e,n=0,r=t.length-1,i=jAe){for(;r>n;){if(r-n>600){const l=r-n+1,c=e-n+1,u=Math.log(l),h=.5*Math.exp(2*u/3),f=.5*Math.sqrt(u*h*(l-h)/l)*(c-l/2<0?-1:1),g=Math.max(n,Math.floor(e-c*h/l+f)),y=Math.min(r,Math.floor(e+(l-c)*h/l+f));Cle(t,e,g,y,i)}const s=t[e];let o=n,a=r;for(xE(t,n,e),i(t[r],s)>0&&xE(t,n,r);o<a;){for(xE(t,o,a),o++,a--;i(t[o],s)<0;)o++;for(;i(t[a],s)>0;)a--}i(t[n],s)===0?xE(t,n,a):(a++,xE(t,a,r)),a<=e&&(n=a+1),e<=a&&(r=a-1)}}function xE(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function jAe(t,e){return t<e?-1:t>e?1:0}let Rle=class{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let n=this.data;const r=[];if(!fC(e,n))return r;const i=this.toBBox,s=[];for(;n;){for(let o=0;o<n.children.length;o++){const a=n.children[o],l=n.leaf?i(a):a;fC(e,l)&&(n.leaf?r.push(a):k6(e,l)?this._all(a,r):s.push(a))}n=s.pop()}return r}collides(e){let n=this.data;if(!fC(e,n))return!1;const r=[];for(;n;){for(let i=0;i<n.children.length;i++){const s=n.children[i],o=n.leaf?this.toBBox(s):s;if(fC(e,o)){if(n.leaf||k6(e,o))return!0;r.push(s)}}n=r.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let r=0;r<e.length;r++)this.insert(e[r]);return this}let n=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=n;else if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){const r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=$_([]),this}remove(e,n){if(!e)return this;let r=this.data;const i=this.toBBox(e),s=[],o=[];let a,l,c;for(;r||s.length;){if(r||(r=s.pop(),l=s[s.length-1],a=o.pop(),c=!0),r.leaf){const u=$Ae(e,r.children,n);if(u!==-1)return r.children.splice(u,1),s.push(r),this._condense(s),this}!c&&!r.leaf&&k6(r,i)?(s.push(r),o.push(a),a=0,l=r,r=r.children[0]):l?(a++,r=l.children[a],c=!1):r=null}return this}toBBox(e){return e}compareMinX(e,n){return e.minX-n.minX}compareMinY(e,n){return e.minY-n.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,n){const r=[];for(;e;)e.leaf?n.push(...e.children):r.push(...e.children),e=r.pop();return n}_build(e,n,r,i){const s=r-n+1;let o=this._maxEntries,a;if(s<=o)return a=$_(e.slice(n,r+1)),i_(a,this.toBBox),a;i||(i=Math.ceil(Math.log(s)/Math.log(o)),o=Math.ceil(s/Math.pow(o,i-1))),a=$_([]),a.leaf=!1,a.height=i;const l=Math.ceil(s/o),c=l*Math.ceil(Math.sqrt(o));LX(e,n,r,c,this.compareMinX);for(let u=n;u<=r;u+=c){const h=Math.min(u+c-1,r);LX(e,u,h,l,this.compareMinY);for(let f=u;f<=h;f+=l){const g=Math.min(f+l-1,h);a.children.push(this._build(e,f,g,i-1))}}return i_(a,this.toBBox),a}_chooseSubtree(e,n,r,i){for(;i.push(n),!(n.leaf||i.length-1===r);){let s=1/0,o=1/0,a;for(let l=0;l<n.children.length;l++){const c=n.children[l],u=T6(c),h=zAe(e,c)-u;h<o?(o=h,s=u<s?u:s,a=c):h===o&&u<s&&(s=u,a=c)}n=a||n.children[0]}return n}_insert(e,n,r){const i=r?e:this.toBBox(e),s=[],o=this._chooseSubtree(i,this.data,n,s);for(o.children.push(e),nS(o,i);n>=0&&s[n].children.length>this._maxEntries;)this._split(s,n),n--;this._adjustParentBBoxes(i,s,n)}_split(e,n){const r=e[n],i=r.children.length,s=this._minEntries;this._chooseSplitAxis(r,s,i);const o=this._chooseSplitIndex(r,s,i),a=$_(r.children.splice(o,r.children.length-o));a.height=r.height,a.leaf=r.leaf,i_(r,this.toBBox),i_(a,this.toBBox),n?e[n-1].children.push(a):this._splitRoot(r,a)}_splitRoot(e,n){this.data=$_([e,n]),this.data.height=e.height+1,this.data.leaf=!1,i_(this.data,this.toBBox)}_chooseSplitIndex(e,n,r){let i,s=1/0,o=1/0;for(let a=n;a<=r-n;a++){const l=tS(e,0,a,this.toBBox),c=tS(e,a,r,this.toBBox),u=GAe(l,c),h=T6(l)+T6(c);u<s?(s=u,i=a,o=h<o?h:o):u===s&&h<o&&(o=h,i=a)}return i||r-n}_chooseSplitAxis(e,n,r){const i=e.leaf?this.compareMinX:FAe,s=e.leaf?this.compareMinY:VAe,o=this._allDistMargin(e,n,r,i),a=this._allDistMargin(e,n,r,s);o<a&&e.children.sort(i)}_allDistMargin(e,n,r,i){e.children.sort(i);const s=this.toBBox,o=tS(e,0,n,s),a=tS(e,r-n,r,s);let l=dC(o)+dC(a);for(let c=n;c<r-n;c++){const u=e.children[c];nS(o,e.leaf?s(u):u),l+=dC(o)}for(let c=r-n-1;c>=n;c--){const u=e.children[c];nS(a,e.leaf?s(u):u),l+=dC(a)}return l}_adjustParentBBoxes(e,n,r){for(let i=r;i>=0;i--)nS(n[i],e)}_condense(e){for(let n=e.length-1,r;n>=0;n--)e[n].children.length===0?n>0?(r=e[n-1].children,r.splice(r.indexOf(e[n]),1)):this.clear():i_(e[n],this.toBBox)}};function $Ae(t,e,n){if(!n)return e.indexOf(t);for(let r=0;r<e.length;r++)if(n(t,e[r]))return r;return-1}function i_(t,e){tS(t,0,t.children.length,e,t)}function tS(t,e,n,r,i){i||(i=$_(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(let s=e;s<n;s++){const o=t.children[s];nS(i,t.leaf?r(o):o)}return i}function nS(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function FAe(t,e){return t.minX-e.minX}function VAe(t,e){return t.minY-e.minY}function T6(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function dC(t){return t.maxX-t.minX+(t.maxY-t.minY)}function zAe(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}function GAe(t,e){const n=Math.max(t.minX,e.minX),r=Math.max(t.minY,e.minY),i=Math.min(t.maxX,e.maxX),s=Math.min(t.maxY,e.maxY);return Math.max(0,i-n)*Math.max(0,s-r)}function k6(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function fC(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function $_(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function LX(t,e,n,r,i){const s=[e,n];for(;s.length;){if(n=s.pop(),e=s.pop(),n-e<=r)continue;const o=e+Math.ceil((n-e)/r/2)*r;Cle(t,o,e,n,i),s.push(e,o,o,n)}}class GF{constructor(e){this.rbush_=new Rle(e),this.items_={}}insert(e,n){const r={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:n};this.rbush_.insert(r),this.items_[Qt(n)]=r}load(e,n){const r=new Array(n.length);for(let i=0,s=n.length;i<s;i++){const o=e[i],a=n[i],l={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:a};r[i]=l,this.items_[Qt(a)]=l}this.rbush_.load(r)}remove(e){const n=Qt(e),r=this.items_[n];return delete this.items_[n],this.rbush_.remove(r)!==null}update(e,n){const r=this.items_[Qt(n)],i=[r.minX,r.minY,r.maxX,r.maxY];x1(i,e)||(this.remove(n),this.insert(e,n))}getAll(){return this.rbush_.all().map(function(n){return n.value})}getInExtent(e){const n={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]};return this.rbush_.search(n).map(function(i){return i.value})}forEach(e){return this.forEach_(this.getAll(),e)}forEachInExtent(e,n){return this.forEach_(this.getInExtent(e),n)}forEach_(e,n){let r;for(let i=0,s=e.length;i<s;i++)if(r=n(e[i]),r)return r;return r}isEmpty(){return v1(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(e){const n=this.rbush_.toJSON();return up(n.minX,n.minY,n.maxX,n.maxY,e)}concat(e){this.rbush_.load(e.rbush_.all());for(const n in e.items_)this.items_[n]=e.items_[n]}}class vG extends Gd{constructor(e){super(),this.projection=Jr(e.projection),this.attributions_=DX(e.attributions),this.attributionsCollapsible_=e.attributionsCollapsible??!0,this.loading=!1,this.state_=e.state!==void 0?e.state:"ready",this.wrapX_=e.wrapX!==void 0?e.wrapX:!1,this.interpolate_=!!e.interpolate,this.viewResolver=null,this.viewRejector=null;const n=this;this.viewPromise_=new Promise(function(r,i){n.viewResolver=r,n.viewRejector=i})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(e){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(e){this.attributions_=DX(e),this.changed()}setState(e){this.state_=e,this.changed()}}function DX(t){return t?typeof t=="function"?t:(Array.isArray(t)||(t=[t]),e=>t):null}const io={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};class Jp extends Sc{constructor(e,n,r){super(e),this.feature=n,this.features=r}}class Ml extends vG{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:e.wrapX!==void 0?e.wrapX:!0}),this.on,this.once,this.un,this.loader_=lk,this.format_=e.format||null,this.overlaps_=e.overlaps===void 0?!0:e.overlaps,this.url_=e.url,e.loader!==void 0?this.loader_=e.loader:this.url_!==void 0&&(ur(this.format_,"`format` must be set when `url` is set"),this.loader_=MX(this.url_,this.format_)),this.strategy_=e.strategy!==void 0?e.strategy:OAe;const n=e.useSpatialIndex!==void 0?e.useSpatialIndex:!0;this.featuresRtree_=n?new GF:null,this.loadedExtentsRtree_=new GF,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let r,i;Array.isArray(e.features)?i=e.features:e.features&&(r=e.features,i=r.getArray()),!n&&r===void 0&&(r=new Da(i)),i!==void 0&&this.addFeaturesInternal(i),r!==void 0&&this.bindFeaturesCollection_(r)}addFeature(e){this.addFeatureInternal(e),this.changed()}addFeatureInternal(e){const n=Qt(e);if(!this.addToIndex_(n,e)){this.featuresCollection_&&this.featuresCollection_.remove(e);return}this.setupChangeEvents_(n,e);const r=e.getGeometry();if(r){const i=r.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(i,e)}else this.nullGeometryFeatures_[n]=e;this.dispatchEvent(new Jp(io.ADDFEATURE,e))}setupChangeEvents_(e,n){n instanceof gl||(this.featureChangeKeys_[e]=[Yn(n,wn.CHANGE,this.handleFeatureChange_,this),Yn(n,Kw.PROPERTYCHANGE,this.handleFeatureChange_,this)])}addToIndex_(e,n){let r=!0;if(n.getId()!==void 0){const i=String(n.getId());if(!(i in this.idIndex_))this.idIndex_[i]=n;else if(n instanceof gl){const s=this.idIndex_[i];s instanceof gl?Array.isArray(s)?s.push(n):this.idIndex_[i]=[s,n]:r=!1}else r=!1}return r&&(ur(!(e in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[e]=n),r}addFeatures(e){this.addFeaturesInternal(e),this.changed()}addFeaturesInternal(e){const n=[],r=[],i=[];for(let s=0,o=e.length;s<o;s++){const a=e[s],l=Qt(a);this.addToIndex_(l,a)&&r.push(a)}for(let s=0,o=r.length;s<o;s++){const a=r[s],l=Qt(a);this.setupChangeEvents_(l,a);const c=a.getGeometry();if(c){const u=c.getExtent();n.push(u),i.push(a)}else this.nullGeometryFeatures_[l]=a}if(this.featuresRtree_&&this.featuresRtree_.load(n,i),this.hasListener(io.ADDFEATURE))for(let s=0,o=r.length;s<o;s++)this.dispatchEvent(new Jp(io.ADDFEATURE,r[s]))}bindFeaturesCollection_(e){let n=!1;this.addEventListener(io.ADDFEATURE,function(r){n||(n=!0,e.push(r.feature),n=!1)}),this.addEventListener(io.REMOVEFEATURE,function(r){n||(n=!0,e.remove(r.feature),n=!1)}),e.addEventListener(As.ADD,r=>{n||(n=!0,this.addFeature(r.element),n=!1)}),e.addEventListener(As.REMOVE,r=>{n||(n=!0,this.removeFeature(r.element),n=!1)}),this.featuresCollection_=e}clear(e){if(e){for(const r in this.featureChangeKeys_)this.featureChangeKeys_[r].forEach(ni);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(r=>{this.removeFeatureInternal(r)});for(const r in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[r])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const n=new Jp(io.CLEAR);this.dispatchEvent(n),this.changed()}forEachFeature(e){if(this.featuresRtree_)return this.featuresRtree_.forEach(e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureAtCoordinateDirect(e,n){const r=[e[0],e[1],e[0],e[1]];return this.forEachFeatureInExtent(r,function(i){const s=i.getGeometry();if(s instanceof gl||s.intersectsCoordinate(e))return n(i)})}forEachFeatureInExtent(e,n){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(e,n);this.featuresCollection_&&this.featuresCollection_.forEach(n)}forEachFeatureIntersectingExtent(e,n){return this.forEachFeatureInExtent(e,function(r){const i=r.getGeometry();if(i instanceof gl||i.intersectsExtent(e)){const s=n(r);if(s)return s}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let e;return this.featuresCollection_?e=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(e=this.featuresRtree_.getAll(),v1(this.nullGeometryFeatures_)||_r(e,Object.values(this.nullGeometryFeatures_))),e}getFeaturesAtCoordinate(e){const n=[];return this.forEachFeatureAtCoordinateDirect(e,function(r){n.push(r)}),n}getFeaturesInExtent(e,n){if(this.featuresRtree_){if(!(n&&n.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(e);const i=Fae(e,n);return[].concat(...i.map(s=>this.featuresRtree_.getInExtent(s)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(e,n){const r=e[0],i=e[1];let s=null;const o=[NaN,NaN];let a=1/0;const l=[-1/0,-1/0,1/0,1/0];return n=n||Cg,this.featuresRtree_.forEachInExtent(l,function(c){if(n(c)){const u=c.getGeometry(),h=a;if(a=u instanceof gl?0:u.closestPointXY(r,i,o,a),a<h){s=c;const f=Math.sqrt(a);l[0]=r-f,l[1]=i-f,l[2]=r+f,l[3]=i+f}}}),s}getExtent(e){return this.featuresRtree_.getExtent(e)}getFeatureById(e){const n=this.idIndex_[e.toString()];return n!==void 0?n:null}getFeatureByUid(e){const n=this.uidIndex_[e];return n!==void 0?n:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(e){const n=e.target,r=Qt(n),i=n.getGeometry();if(!i)r in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(n),this.nullGeometryFeatures_[r]=n);else{const o=i.getExtent();r in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[r],this.featuresRtree_&&this.featuresRtree_.insert(o,n)):this.featuresRtree_&&this.featuresRtree_.update(o,n)}const s=n.getId();if(s!==void 0){const o=s.toString();this.idIndex_[o]!==n&&(this.removeFromIdIndex_(n),this.idIndex_[o]=n)}else this.removeFromIdIndex_(n),this.uidIndex_[r]=n;this.changed(),this.dispatchEvent(new Jp(io.CHANGEFEATURE,n))}hasFeature(e){const n=e.getId();return n!==void 0?n in this.idIndex_:Qt(e)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&v1(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(e,n,r){const i=this.loadedExtentsRtree_,s=this.strategy_(e,n,r);for(let o=0,a=s.length;o<a;++o){const l=s[o];i.forEachInExtent(l,function(u){return qm(u.extent,l)})||(++this.loadingExtentsCount_,this.dispatchEvent(new Jp(io.FEATURESLOADSTART)),this.loader_.call(this,l,n,r,u=>{--this.loadingExtentsCount_,this.dispatchEvent(new Jp(io.FEATURESLOADEND,void 0,u))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new Jp(io.FEATURESLOADERROR))}),i.insert(l,{extent:l.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(e){const n=this.loadedExtentsRtree_,r=n.forEachInExtent(e,function(i){if(x1(i.extent,e))return i});r&&n.remove(r)}removeFeatures(e){let n=!1;for(let r=0,i=e.length;r<i;++r)n=this.removeFeatureInternal(e[r])||n;n&&this.changed()}removeFeature(e){if(!e)return;this.removeFeatureInternal(e)&&this.changed()}removeFeatureInternal(e){const n=Qt(e);if(!(n in this.uidIndex_))return!1;n in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[n]:this.featuresRtree_&&this.featuresRtree_.remove(e),this.featureChangeKeys_[n]?.forEach(ni),delete this.featureChangeKeys_[n];const i=e.getId();if(i!==void 0){const s=i.toString(),o=this.idIndex_[s];o===e?delete this.idIndex_[s]:Array.isArray(o)&&(o.splice(o.indexOf(e),1),o.length===1&&(this.idIndex_[s]=o[0]))}return delete this.uidIndex_[n],this.hasListener(io.REMOVEFEATURE)&&this.dispatchEvent(new Jp(io.REMOVEFEATURE,e)),!0}removeFromIdIndex_(e){for(const n in this.idIndex_)if(this.idIndex_[n]===e){delete this.idIndex_[n];break}}setLoader(e){this.loader_=e}setUrl(e){ur(this.format_,"`format` must be set when `url` is set"),this.url_=e,this.setLoader(MX(e,this.format_))}setOverlaps(e){this.overlaps_=e,this.changed()}}class Dn{constructor(e){e=e||{},this.patternImage_=null,this.color_=null,e.color!==void 0&&this.setColor(e.color)}clone(){const e=this.getColor();return new Dn({color:Array.isArray(e)?e.slice():e||void 0})}getColor(){return this.color_}setColor(e){if(e!==null&&typeof e=="object"&&"src"in e){const n=$3(null,e.src,"anonymous",void 0,e.offset?null:e.color?e.color:null,!(e.offset&&e.size));n.ready().then(()=>{this.patternImage_=null}),n.getImageState()===Vt.IDLE&&n.load(),n.getImageState()===Vt.LOADING&&(this.patternImage_=n)}this.color_=e}getKey(){const e=this.getColor();return e?e instanceof CanvasPattern||e instanceof CanvasGradient?Qt(e):typeof e=="object"&&"src"in e?e.src+":"+e.offset:mu(e).toString():""}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}class Pn{constructor(e){e=e||{},this.color_=e.color!==void 0?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=e.lineDash!==void 0?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width}clone(){const e=this.getColor();return new Pn({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(e){this.color_=e}setLineCap(e){this.lineCap_=e}setLineDash(e){this.lineDash_=e}setLineDashOffset(e){this.lineDashOffset_=e}setLineJoin(e){this.lineJoin_=e}setMiterLimit(e){this.miterLimit_=e}setWidth(e){this.width_=e}}function jX(t){return t[0]>0&&t[1]>0}function UAe(t,e,n){return n===void 0&&(n=[0,0]),n[0]=t[0]*e+.5|0,n[1]=t[1]*e+.5|0,n}function ja(t,e){return Array.isArray(t)?t:(e===void 0?e=[t,t]:(e[0]=t,e[1]=t),e)}class P5{constructor(e){this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=ja(e.scale),this.displacement_=e.displacement,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new P5({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return bn()}getImage(e){return bn()}getHitDetectionImage(){return bn()}getPixelRatio(e){return 1}getImageState(){return bn()}getImageSize(){return bn()}getOrigin(){return bn()}getSize(){return bn()}setDisplacement(e){this.displacement_=e}setOpacity(e){this.opacity_=e}setRotateWithView(e){this.rotateWithView_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=ja(e)}listenImageChange(e){bn()}load(){bn()}unlistenImageChange(e){bn()}ready(){return Promise.resolve()}}class C5 extends P5{constructor(e){super({opacity:1,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,rotation:e.rotation!==void 0?e.rotation:0,scale:e.scale!==void 0?e.scale:1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=e.fill!==void 0?e.fill:null,this.origin_=[0,0],this.points_=e.points,this.radius=e.radius,this.radius2_=e.radius2,this.angle_=e.angle!==void 0?e.angle:0,this.stroke_=e.stroke!==void 0?e.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?Vt.LOADING:Vt.LOADED,this.imageState_===Vt.LOADING&&this.ready().then(()=>this.imageState_=Vt.LOADED),this.render()}clone(){const e=this.getScale(),n=new C5({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return n.setOpacity(this.getOpacity()),n}getAnchor(){const e=this.size_,n=this.getDisplacement(),r=this.getScaleArray();return[e[0]/2-n[0]/r[0],e[1]/2+n[1]/r[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(e){this.fill_=e,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(e){const n=this.fill_?.getKey(),r=`${e},${this.angle_},${this.radius},${this.radius2_},${this.points_},${n}`+Object.values(this.renderOptions_).join(",");let i=nu.get(r,null,null)?.getImage(1);if(!i){const s=this.renderOptions_,o=Math.ceil(s.size*e),a=Rs(o,o);this.draw_(s,a,e),i=a.canvas,nu.set(r,null,null,new ple(i,void 0,null,Vt.LOADED,null))}return i}getPixelRatio(e){return e}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e,this.render()}listenImageChange(e){}load(){}unlistenImageChange(e){}calculateLineJoinSize_(e,n,r){if(n===0||this.points_===1/0||e!=="bevel"&&e!=="miter")return n;let i=this.radius,s=this.radius2_===void 0?i:this.radius2_;if(i<s){const D=i;i=s,s=D}const o=this.radius2_===void 0?this.points_:this.points_*2,a=2*Math.PI/o,l=s*Math.sin(a),c=Math.sqrt(s*s-l*l),u=i-c,h=Math.sqrt(l*l+u*u),f=h/l;if(e==="miter"&&f<=r)return f*n;const g=n/2/f,y=n/2*(u/h),b=Math.sqrt((i+g)*(i+g)+y*y)-i;if(this.radius2_===void 0||e==="bevel")return b*2;const T=i*Math.sin(a),A=Math.sqrt(i*i-T*T),I=s-A,R=Math.sqrt(T*T+I*I)/T;if(R<=r){const D=R*n/2-s-i;return 2*Math.max(b,D)}return b*2}createRenderOptions(){let e=Jw,n=Qw,r=0,i=null,s=0,o,a=0;this.stroke_&&(o=pd(this.stroke_.getColor()??pk),a=this.stroke_.getWidth()??gk,i=this.stroke_.getLineDash(),s=this.stroke_.getLineDashOffset()??0,n=this.stroke_.getLineJoin()??Qw,e=this.stroke_.getLineCap()??Jw,r=this.stroke_.getMiterLimit()??fk);const l=this.calculateLineJoinSize_(n,a,r),c=Math.max(this.radius,this.radius2_||0),u=Math.ceil(2*c+l);return{strokeStyle:o,strokeWidth:a,size:u,lineCap:e,lineDash:i,lineDashOffset:s,lineJoin:n,miterLimit:r}}render(){this.renderOptions_=this.createRenderOptions();const e=this.renderOptions_.size;this.hitDetectionCanvas_=null,this.size_=[e,e]}draw_(e,n,r){if(n.scale(r,r),n.translate(e.size/2,e.size/2),this.createPath_(n),this.fill_){let i=this.fill_.getColor();i===null&&(i=ml),n.fillStyle=pd(i),n.fill()}e.strokeStyle&&(n.strokeStyle=e.strokeStyle,n.lineWidth=e.strokeWidth,e.lineDash&&(n.setLineDash(e.lineDash),n.lineDashOffset=e.lineDashOffset),n.lineCap=e.lineCap,n.lineJoin=e.lineJoin,n.miterLimit=e.miterLimit,n.stroke())}createHitDetectionCanvas_(e){let n;if(this.fill_){let r=this.fill_.getColor(),i=0;typeof r=="string"&&(r=mu(r)),r===null?i=1:Array.isArray(r)&&(i=r.length===4?r[3]:1),i===0&&(n=Rs(e.size,e.size),this.drawHitDetectionCanvas_(e,n))}return n?n.canvas:this.getImage(1)}createPath_(e){let n=this.points_;const r=this.radius;if(n===1/0)e.arc(0,0,r,0,2*Math.PI);else{const i=this.radius2_===void 0?r:this.radius2_;this.radius2_!==void 0&&(n*=2);const s=this.angle_-Math.PI/2,o=2*Math.PI/n;for(let a=0;a<n;a++){const l=s+a*o,c=a%2===0?r:i;e.lineTo(c*Math.cos(l),c*Math.sin(l))}e.closePath()}}drawHitDetectionCanvas_(e,n){n.translate(e.size/2,e.size/2),this.createPath_(n),n.fillStyle=ml,n.fill(),e.strokeStyle&&(n.strokeStyle=e.strokeStyle,n.lineWidth=e.strokeWidth,e.lineDash&&(n.setLineDash(e.lineDash),n.lineDashOffset=e.lineDashOffset),n.lineJoin=e.lineJoin,n.miterLimit=e.miterLimit,n.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}class ms extends C5{constructor(e){e=e||{radius:5},super({points:1/0,fill:e.fill,radius:e.radius,stroke:e.stroke,scale:e.scale!==void 0?e.scale:1,rotation:e.rotation!==void 0?e.rotation:0,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode})}clone(){const e=this.getScale(),n=new ms({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return n.setOpacity(this.getOpacity()),n}setRadius(e){this.radius=e,this.render()}}class vn{constructor(e){e=e||{},this.geometry_=null,this.geometryFunction_=$X,e.geometry!==void 0&&this.setGeometry(e.geometry),this.fill_=e.fill!==void 0?e.fill:null,this.image_=e.image!==void 0?e.image:null,this.renderer_=e.renderer!==void 0?e.renderer:null,this.hitDetectionRenderer_=e.hitDetectionRenderer!==void 0?e.hitDetectionRenderer:null,this.stroke_=e.stroke!==void 0?e.stroke:null,this.text_=e.text!==void 0?e.text:null,this.zIndex_=e.zIndex}clone(){let e=this.getGeometry();return e&&typeof e=="object"&&(e=e.clone()),new vn({geometry:e??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(e){this.renderer_=e}setHitDetectionRenderer(e){this.hitDetectionRenderer_=e}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(e){this.fill_=e}getImage(){return this.image_}setImage(e){this.image_=e}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e}getText(){return this.text_}setText(e){this.text_=e}getZIndex(){return this.zIndex_}setGeometry(e){typeof e=="function"?this.geometryFunction_=e:typeof e=="string"?this.geometryFunction_=function(n){return n.get(e)}:e?e!==void 0&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=$X,this.geometry_=e}setZIndex(e){this.zIndex_=e}}function BAe(t){let e;if(typeof t=="function")e=t;else{let n;Array.isArray(t)?n=t:(ur(typeof t.getZIndex=="function","Expected an `Style` or an array of `Style`"),n=[t]),e=function(){return n}}return e}let A6=null;function Mle(t,e){if(!A6){const n=new Dn({color:"rgba(255,255,255,0.4)"}),r=new Pn({color:"#3399CC",width:1.25});A6=[new vn({image:new ms({fill:n,stroke:r,radius:5}),fill:n,stroke:r})]}return A6}function _G(){const t={},e=[255,255,255,1],n=[0,153,255,1],r=3;return t.Polygon=[new vn({fill:new Dn({color:[255,255,255,.5]})})],t.MultiPolygon=t.Polygon,t.LineString=[new vn({stroke:new Pn({color:e,width:r+2})}),new vn({stroke:new Pn({color:n,width:r})})],t.MultiLineString=t.LineString,t.Circle=t.Polygon.concat(t.LineString),t.Point=[new vn({image:new ms({radius:r*2,fill:new Dn({color:n}),stroke:new Pn({color:e,width:r/2})}),zIndex:1/0})],t.MultiPoint=t.Point,t.GeometryCollection=t.Polygon.concat(t.LineString,t.Point),t}function $X(t){return t.getGeometry()}const WAe="#333";class fc{constructor(e){e=e||{},this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.keepUpright_=e.keepUpright,this.scale_=e.scale,this.scaleArray_=ja(e.scale!==void 0?e.scale:1),this.text_=e.text,this.textAlign_=e.textAlign,this.justify_=e.justify,this.repeat_=e.repeat,this.textBaseline_=e.textBaseline,this.fill_=e.fill!==void 0?e.fill:new Dn({color:WAe}),this.maxAngle_=e.maxAngle!==void 0?e.maxAngle:Math.PI/4,this.placement_=e.placement!==void 0?e.placement:"point",this.overflow_=!!e.overflow,this.stroke_=e.stroke!==void 0?e.stroke:null,this.offsetX_=e.offsetX!==void 0?e.offsetX:0,this.offsetY_=e.offsetY!==void 0?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=e.padding===void 0?null:e.padding,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new fc({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),keepUpright:this.getKeepUpright(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()instanceof Dn?this.getFill().clone():this.getFill(),stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getKeepUpright(){return this.keepUpright_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(e){this.overflow_=e}setFont(e){this.font_=e}setMaxAngle(e){this.maxAngle_=e}setOffsetX(e){this.offsetX_=e}setOffsetY(e){this.offsetY_=e}setPlacement(e){this.placement_=e}setRepeat(e){this.repeat_=e}setRotateWithView(e){this.rotateWithView_=e}setKeepUpright(e){this.keepUpright_=e}setFill(e){this.fill_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=ja(e!==void 0?e:1)}setStroke(e){this.stroke_=e}setText(e){this.text_=e}setTextAlign(e){this.textAlign_=e}setJustify(e){this.justify_=e}setTextBaseline(e){this.textBaseline_=e}setBackgroundFill(e){this.backgroundFill_=e}setBackgroundStroke(e){this.backgroundStroke_=e}setPadding(e){this.padding_=e}}const Ts={ANIMATING:0,INTERACTING:1},ln={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},pC=[ln.FILL],Zm=[ln.STROKE],Ny=[ln.BEGIN_PATH],FX=[ln.CLOSE_PATH];class UA extends mle{constructor(e,n,r,i){super(),this.tolerance=e,this.maxExtent=n,this.pixelRatio=i,this.maxLineWidth=0,this.resolution=r,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(e){const n=this.pixelRatio;return n==1?e:e.map(function(r){return r*n})}appendFlatPointCoordinates(e,n){const r=this.getBufferedMaxExtent(),i=this.tmpCoordinate_,s=this.coordinates;let o=s.length;for(let a=0,l=e.length;a<l;a+=n)i[0]=e[a],i[1]=e[a+1],_1(r,i)&&(s[o++]=i[0],s[o++]=i[1]);return o}appendFlatLineCoordinates(e,n,r,i,s,o){const a=this.coordinates;let l=a.length;const c=this.getBufferedMaxExtent();o&&(n+=i);let u=e[n],h=e[n+1];const f=this.tmpCoordinate_;let g=!0,y,_,b;for(y=n+i;y<r;y+=i)f[0]=e[y],f[1]=e[y+1],b=kF(c,f),b!==_?(g&&(a[l++]=u,a[l++]=h,g=!1),a[l++]=f[0],a[l++]=f[1]):b===oo.INTERSECTING?(a[l++]=f[0],a[l++]=f[1],g=!1):g=!0,u=f[0],h=f[1],_=b;return(s&&g||y===n+i)&&(a[l++]=u,a[l++]=h),l}drawCustomCoordinates_(e,n,r,i,s){for(let o=0,a=r.length;o<a;++o){const l=r[o],c=this.appendFlatLineCoordinates(e,n,l,i,!1,!1);s.push(c),n=l}return n}drawCustom(e,n,r,i,s){this.beginGeometry(e,n,s);const o=e.getType(),a=e.getStride(),l=this.coordinates.length;let c,u,h,f,g;switch(o){case"MultiPolygon":c=e.getOrientedFlatCoordinates(),f=[];const y=e.getEndss();g=0;for(let _=0,b=y.length;_<b;++_){const T=[];g=this.drawCustomCoordinates_(c,g,y[_],a,T),f.push(T)}this.instructions.push([ln.CUSTOM,l,f,e,r,DF,s]),this.hitDetectionInstructions.push([ln.CUSTOM,l,f,e,i||r,DF,s]);break;case"Polygon":case"MultiLineString":h=[],c=o=="Polygon"?e.getOrientedFlatCoordinates():e.getFlatCoordinates(),g=this.drawCustomCoordinates_(c,0,e.getEnds(),a,h),this.instructions.push([ln.CUSTOM,l,h,e,r,dk,s]),this.hitDetectionInstructions.push([ln.CUSTOM,l,h,e,i||r,dk,s]);break;case"LineString":case"Circle":c=e.getFlatCoordinates(),u=this.appendFlatLineCoordinates(c,0,c.length,a,!1,!1),this.instructions.push([ln.CUSTOM,l,u,e,r,Ym,s]),this.hitDetectionInstructions.push([ln.CUSTOM,l,u,e,i||r,Ym,s]);break;case"MultiPoint":c=e.getFlatCoordinates(),u=this.appendFlatPointCoordinates(c,a),u>l&&(this.instructions.push([ln.CUSTOM,l,u,e,r,Ym,s]),this.hitDetectionInstructions.push([ln.CUSTOM,l,u,e,i||r,Ym,s]));break;case"Point":c=e.getFlatCoordinates(),this.coordinates.push(c[0],c[1]),u=this.coordinates.length,this.instructions.push([ln.CUSTOM,l,u,e,r,void 0,s]),this.hitDetectionInstructions.push([ln.CUSTOM,l,u,e,i||r,void 0,s]);break}this.endGeometry(n)}beginGeometry(e,n,r){this.beginGeometryInstruction1_=[ln.BEGIN_GEOMETRY,n,0,e,r],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[ln.BEGIN_GEOMETRY,n,0,e,r],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const e=this.hitDetectionInstructions;e.reverse();let n;const r=e.length;let i,s,o=-1;for(n=0;n<r;++n)i=e[n],s=i[0],s==ln.END_GEOMETRY?o=n:s==ln.BEGIN_GEOMETRY&&(i[2]=n,zTe(this.hitDetectionInstructions,o,n),o=-1)}fillStyleToState(e,n={}){if(e){const r=e.getColor();n.fillPatternScale=r&&typeof r=="object"&&"src"in r?this.pixelRatio:1,n.fillStyle=pd(r||ml)}else n.fillStyle=void 0;return n}strokeStyleToState(e,n={}){if(e){const r=e.getColor();n.strokeStyle=pd(r||pk);const i=e.getLineCap();n.lineCap=i!==void 0?i:Jw;const s=e.getLineDash();n.lineDash=s?s.slice():ep;const o=e.getLineDashOffset();n.lineDashOffset=o||tp;const a=e.getLineJoin();n.lineJoin=a!==void 0?a:Qw;const l=e.getWidth();n.lineWidth=l!==void 0?l:gk;const c=e.getMiterLimit();n.miterLimit=c!==void 0?c:fk,n.lineWidth>this.maxLineWidth&&(this.maxLineWidth=n.lineWidth,this.bufferedMaxExtent_=null)}else n.strokeStyle=void 0,n.lineCap=void 0,n.lineDash=null,n.lineDashOffset=void 0,n.lineJoin=void 0,n.lineWidth=void 0,n.miterLimit=void 0;return n}setFillStrokeStyle(e,n){const r=this.state;this.fillStyleToState(e,r),this.strokeStyleToState(n,r)}createFill(e){const n=e.fillStyle,r=[ln.SET_FILL_STYLE,n];return typeof n!="string"&&r.push(e.fillPatternScale),r}applyStroke(e){this.instructions.push(this.createStroke(e))}createStroke(e){return[ln.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth*this.pixelRatio,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash?this.applyPixelRatio(e.lineDash):null,e.lineDashOffset*this.pixelRatio]}updateFillStyle(e,n){const r=e.fillStyle;(typeof r!="string"||e.currentFillStyle!=r)&&(this.instructions.push(n.call(this,e)),e.currentFillStyle=r)}updateStrokeStyle(e,n){const r=e.strokeStyle,i=e.lineCap,s=e.lineDash,o=e.lineDashOffset,a=e.lineJoin,l=e.lineWidth,c=e.miterLimit;(e.currentStrokeStyle!=r||e.currentLineCap!=i||s!=e.currentLineDash&&!zd(e.currentLineDash,s)||e.currentLineDashOffset!=o||e.currentLineJoin!=a||e.currentLineWidth!=l||e.currentMiterLimit!=c)&&(n.call(this,e),e.currentStrokeStyle=r,e.currentLineCap=i,e.currentLineDash=s,e.currentLineDashOffset=o,e.currentLineJoin=a,e.currentLineWidth=l,e.currentMiterLimit=c)}endGeometry(e){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const n=[ln.END_GEOMETRY,e];this.instructions.push(n),this.hitDetectionInstructions.push(n)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=Lae(this.maxExtent),this.maxLineWidth>0)){const e=this.resolution*(this.maxLineWidth+1)/2;ih(this.bufferedMaxExtent_,e,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}class HAe extends UA{constructor(e,n,r,i){super(e,n,r,i),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(e,n,r){if(!this.image_||this.maxExtent&&!_1(this.maxExtent,e.getFlatCoordinates()))return;this.beginGeometry(e,n,r);const i=e.getFlatCoordinates(),s=e.getStride(),o=this.coordinates.length,a=this.appendFlatPointCoordinates(i,s);this.instructions.push([ln.DRAW_IMAGE,o,a,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([ln.DRAW_IMAGE,o,a,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(n)}drawMultiPoint(e,n,r){if(!this.image_)return;this.beginGeometry(e,n,r);const i=e.getFlatCoordinates(),s=[];for(let l=0,c=i.length;l<c;l+=e.getStride())(!this.maxExtent||_1(this.maxExtent,i.slice(l,l+2)))&&s.push(i[l],i[l+1]);const o=this.coordinates.length,a=this.appendFlatPointCoordinates(s,2);this.instructions.push([ln.DRAW_IMAGE,o,a,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([ln.DRAW_IMAGE,o,a,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(n)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(e,n){const r=e.getAnchor(),i=e.getSize(),s=e.getOrigin();this.imagePixelRatio_=e.getPixelRatio(this.pixelRatio),this.anchorX_=r[0],this.anchorY_=r[1],this.hitDetectionImage_=e.getHitDetectionImage(),this.image_=e.getImage(this.pixelRatio),this.height_=i[1],this.opacity_=e.getOpacity(),this.originX_=s[0],this.originY_=s[1],this.rotateWithView_=e.getRotateWithView(),this.rotation_=e.getRotation(),this.scale_=e.getScaleArray(),this.width_=i[0],this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=n}}class qAe extends UA{constructor(e,n,r,i){super(e,n,r,i)}drawFlatCoordinates_(e,n,r,i){const s=this.coordinates.length,o=this.appendFlatLineCoordinates(e,n,r,i,!1,!1),a=[ln.MOVE_TO_LINE_TO,s,o];return this.instructions.push(a),this.hitDetectionInstructions.push(a),r}drawLineString(e,n,r){const i=this.state,s=i.strokeStyle,o=i.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(e,n,r),this.hitDetectionInstructions.push([ln.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,ep,tp],Ny);const a=e.getFlatCoordinates(),l=e.getStride();this.drawFlatCoordinates_(a,0,a.length,l),this.hitDetectionInstructions.push(Zm),this.endGeometry(n)}drawMultiLineString(e,n,r){const i=this.state,s=i.strokeStyle,o=i.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(e,n,r),this.hitDetectionInstructions.push([ln.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,ep,tp],Ny);const a=e.getEnds(),l=e.getFlatCoordinates(),c=e.getStride();let u=0;for(let h=0,f=a.length;h<f;++h)u=this.drawFlatCoordinates_(l,u,a[h],c);this.hitDetectionInstructions.push(Zm),this.endGeometry(n)}finish(){const e=this.state;return e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&this.instructions.push(Zm),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(e){e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&(this.instructions.push(Zm),e.lastStroke=this.coordinates.length),e.lastStroke=0,super.applyStroke(e),this.instructions.push(Ny)}}class VX extends UA{constructor(e,n,r,i){super(e,n,r,i)}drawFlatCoordinatess_(e,n,r,i){const s=this.state,o=s.fillStyle!==void 0,a=s.strokeStyle!==void 0,l=r.length;this.instructions.push(Ny),this.hitDetectionInstructions.push(Ny);for(let c=0;c<l;++c){const u=r[c],h=this.coordinates.length,f=this.appendFlatLineCoordinates(e,n,u,i,!0,!a),g=[ln.MOVE_TO_LINE_TO,h,f];this.instructions.push(g),this.hitDetectionInstructions.push(g),a&&(this.instructions.push(FX),this.hitDetectionInstructions.push(FX)),n=u}return o&&(this.instructions.push(pC),this.hitDetectionInstructions.push(pC)),a&&(this.instructions.push(Zm),this.hitDetectionInstructions.push(Zm)),n}drawCircle(e,n,r){const i=this.state,s=i.fillStyle,o=i.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,n,r),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([ln.SET_FILL_STYLE,ml]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([ln.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,ep,tp]);const a=e.getFlatCoordinates(),l=e.getStride(),c=this.coordinates.length;this.appendFlatLineCoordinates(a,0,a.length,l,!1,!1);const u=[ln.CIRCLE,c];this.instructions.push(Ny,u),this.hitDetectionInstructions.push(Ny,u),i.fillStyle!==void 0&&(this.instructions.push(pC),this.hitDetectionInstructions.push(pC)),i.strokeStyle!==void 0&&(this.instructions.push(Zm),this.hitDetectionInstructions.push(Zm)),this.endGeometry(n)}drawPolygon(e,n,r){const i=this.state,s=i.fillStyle,o=i.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,n,r),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([ln.SET_FILL_STYLE,ml]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([ln.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,ep,tp]);const a=e.getEnds(),l=e.getOrientedFlatCoordinates(),c=e.getStride();this.drawFlatCoordinatess_(l,0,a,c),this.endGeometry(n)}drawMultiPolygon(e,n,r){const i=this.state,s=i.fillStyle,o=i.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,n,r),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([ln.SET_FILL_STYLE,ml]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([ln.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,ep,tp]);const a=e.getEndss(),l=e.getOrientedFlatCoordinates(),c=e.getStride();let u=0;for(let h=0,f=a.length;h<f;++h)u=this.drawFlatCoordinatess_(l,u,a[h],c);this.endGeometry(n)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const e=this.tolerance;if(e!==0){const n=this.coordinates;for(let r=0,i=n.length;r<i;++r)n[r]=q0(n[r],e)}return super.finish()}setFillStrokeStyles_(){const e=this.state;this.updateFillStyle(e,this.createFill),this.updateStrokeStyle(e,this.applyStroke)}}function KAe(t,e,n,r,i){const s=[];let o=n,a=0,l=e.slice(n,2);for(;a<t&&o+i<r;){const[c,u]=l.slice(-2),h=e[o+i],f=e[o+i+1],g=Math.sqrt((h-c)*(h-c)+(f-u)*(f-u));if(a+=g,a>=t){const y=(t-a+g)/g,_=rc(c,h,y),b=rc(u,f,y);l.push(_,b),s.push(l),l=[_,b],a==t&&(o+=i),a=0}else if(a<t)l.push(e[o+i],e[o+i+1]),o+=i;else{const y=g-a,_=rc(c,h,y/g),b=rc(u,f,y/g);l.push(_,b),s.push(l),l=[_,b],a=0,o+=i}}return a>0&&s.push(l),s}function YAe(t,e,n,r,i){let s=n,o=n,a=0,l=0,c=n,u,h,f,g,y,_,b,T,A,I;for(h=n;h<r;h+=i){const P=e[h],R=e[h+1];y!==void 0&&(A=P-y,I=R-_,g=Math.sqrt(A*A+I*I),b!==void 0&&(l+=f,u=Math.acos((b*A+T*I)/(f*g)),u>t&&(l>a&&(a=l,s=c,o=h),l=0,c=h-i)),f=g,b=A,T=I),y=P,_=R}return l+=g,l>a?[c,h]:[s,o]}const z3={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class XAe extends UA{constructor(e,n,r,i){super(e,n,r,i),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textKeepUpright_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[ml]={fillStyle:ml},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const e=super.finish();return e.textStates=this.textStates,e.fillStates=this.fillStates,e.strokeStates=this.strokeStates,e}drawText(e,n,r){const i=this.textFillState_,s=this.textStrokeState_,o=this.textState_;if(this.text_===""||!o||!i&&!s)return;const a=this.coordinates;let l=a.length;const c=e.getType();let u=null,h=e.getStride();if(o.placement==="line"&&(c=="LineString"||c=="MultiLineString"||c=="Polygon"||c=="MultiPolygon")){if(!oa(this.maxExtent,e.getExtent()))return;let f;if(u=e.getFlatCoordinates(),c=="LineString")f=[u.length];else if(c=="MultiLineString")f=e.getEnds();else if(c=="Polygon")f=e.getEnds().slice(0,1);else if(c=="MultiPolygon"){const b=e.getEndss();f=[];for(let T=0,A=b.length;T<A;++T)f.push(b[T][0])}this.beginGeometry(e,n,r);const g=o.repeat,y=g?void 0:o.textAlign;let _=0;for(let b=0,T=f.length;b<T;++b){let A;g?A=KAe(g*this.resolution,u,_,f[b],h):A=[u.slice(_,f[b])];for(let I=0,P=A.length;I<P;++I){const R=A[I];let D=0,C=R.length;if(y==null){const O=YAe(o.maxAngle,R,0,R.length,2);D=O[0],C=O[1]}for(let O=D;O<C;O+=h)a.push(R[O],R[O+1]);const M=a.length;_=f[b],this.drawChars_(l,M),l=M}}this.endGeometry(n)}else{let f=o.overflow?null:[];switch(c){case"Point":case"MultiPoint":u=e.getFlatCoordinates();break;case"LineString":u=e.getFlatMidpoint();break;case"Circle":u=e.getCenter();break;case"MultiLineString":u=e.getFlatMidpoints(),h=2;break;case"Polygon":u=e.getFlatInteriorPoint(),o.overflow||f.push(u[2]/this.resolution),h=3;break;case"MultiPolygon":const P=e.getFlatInteriorPoints();u=[];for(let R=0,D=P.length;R<D;R+=3)o.overflow||f.push(P[R+2]/this.resolution),u.push(P[R],P[R+1]);if(u.length===0)return;h=2;break}const g=this.appendFlatPointCoordinates(u,h);if(g===l)return;if(f&&(g-l)/2!==u.length/h){let P=l/2;f=f.filter((R,D)=>{const C=a[(P+D)*2]===u[D*h]&&a[(P+D)*2+1]===u[D*h+1];return C||--P,C})}this.saveTextStates_();const y=o.backgroundFill?this.createFill(this.fillStyleToState(o.backgroundFill)):null,_=o.backgroundStroke?this.createStroke(this.strokeStyleToState(o.backgroundStroke)):null;this.beginGeometry(e,n,r);let b=o.padding;if(b!=My&&(o.scale[0]<0||o.scale[1]<0)){let P=o.padding[0],R=o.padding[1],D=o.padding[2],C=o.padding[3];o.scale[0]<0&&(R=-R,C=-C),o.scale[1]<0&&(P=-P,D=-D),b=[P,R,D,C]}const T=this.pixelRatio;this.instructions.push([ln.DRAW_IMAGE,l,g,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,b==My?My:b.map(function(P){return P*T}),y,_,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,f]);const A=1/T,I=y?y.slice(0):null;I&&(I[1]=ml),this.hitDetectionInstructions.push([ln.DRAW_IMAGE,l,g,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[A,A],NaN,this.declutterMode_,this.declutterImageWithText_,b,I,_,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?ml:this.fillKey_,this.textOffsetX_,this.textOffsetY_,f]),this.endGeometry(n)}}saveTextStates_(){const e=this.textStrokeState_,n=this.textState_,r=this.textFillState_,i=this.strokeKey_;e&&(i in this.strokeStates||(this.strokeStates[i]={strokeStyle:e.strokeStyle,lineCap:e.lineCap,lineDashOffset:e.lineDashOffset,lineWidth:e.lineWidth,lineJoin:e.lineJoin,miterLimit:e.miterLimit,lineDash:e.lineDash}));const s=this.textKey_;s in this.textStates||(this.textStates[s]={font:n.font,textAlign:n.textAlign||mk,justify:n.justify,textBaseline:n.textBaseline||F3,scale:n.scale});const o=this.fillKey_;r&&(o in this.fillStates||(this.fillStates[o]={fillStyle:r.fillStyle}))}drawChars_(e,n){const r=this.textStrokeState_,i=this.textState_,s=this.strokeKey_,o=this.textKey_,a=this.fillKey_;this.saveTextStates_();const l=this.pixelRatio,c=z3[i.textBaseline],u=this.textOffsetY_*l,h=this.text_,f=r?r.lineWidth*Math.abs(i.scale[0])/2:0;this.instructions.push([ln.DRAW_CHARS,e,n,c,i.overflow,a,i.maxAngle,l,u,s,f*l,h,o,1,this.declutterMode_,this.textKeepUpright_]),this.hitDetectionInstructions.push([ln.DRAW_CHARS,e,n,c,i.overflow,a&&ml,i.maxAngle,l,u,s,f*l,h,o,1/l,this.declutterMode_,this.textKeepUpright_])}setTextStyle(e,n){let r,i,s;if(!e)this.text_="";else{const o=e.getFill();o?(i=this.textFillState_,i||(i={},this.textFillState_=i),i.fillStyle=pd(o.getColor()||ml)):(i=null,this.textFillState_=i);const a=e.getStroke();if(!a)s=null,this.textStrokeState_=s;else{s=this.textStrokeState_,s||(s={},this.textStrokeState_=s);const _=a.getLineDash(),b=a.getLineDashOffset(),T=a.getWidth(),A=a.getMiterLimit();s.lineCap=a.getLineCap()||Jw,s.lineDash=_?_.slice():ep,s.lineDashOffset=b===void 0?tp:b,s.lineJoin=a.getLineJoin()||Qw,s.lineWidth=T===void 0?gk:T,s.miterLimit=A===void 0?fk:A,s.strokeStyle=pd(a.getColor()||pk)}r=this.textState_;const l=e.getFont()||gle;mAe(l);const c=e.getScaleArray();r.overflow=e.getOverflow(),r.font=l,r.maxAngle=e.getMaxAngle(),r.placement=e.getPlacement(),r.textAlign=e.getTextAlign(),r.repeat=e.getRepeat(),r.justify=e.getJustify(),r.textBaseline=e.getTextBaseline()||F3,r.backgroundFill=e.getBackgroundFill(),r.backgroundStroke=e.getBackgroundStroke(),r.padding=e.getPadding()||My,r.scale=c===void 0?[1,1]:c;const u=e.getOffsetX(),h=e.getOffsetY(),f=e.getRotateWithView(),g=e.getKeepUpright(),y=e.getRotation();this.text_=e.getText()||"",this.textOffsetX_=u===void 0?0:u,this.textOffsetY_=h===void 0?0:h,this.textRotateWithView_=f===void 0?!1:f,this.textKeepUpright_=g===void 0?!0:g,this.textRotation_=y===void 0?0:y,this.strokeKey_=s?(typeof s.strokeStyle=="string"?s.strokeStyle:Qt(s.strokeStyle))+s.lineCap+s.lineDashOffset+"|"+s.lineWidth+s.lineJoin+s.miterLimit+"["+s.lineDash.join()+"]":"",this.textKey_=r.font+r.scale+(r.textAlign||"?")+(r.repeat||"?")+(r.justify||"?")+(r.textBaseline||"?"),this.fillKey_=i&&i.fillStyle?typeof i.fillStyle=="string"?i.fillStyle:"|"+Qt(i.fillStyle):""}this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=n}}const ZAe={Circle:VX,Default:UA,Image:HAe,LineString:qAe,Polygon:VX,Text:XAe};class JAe{constructor(e,n,r,i){this.tolerance_=e,this.maxExtent_=n,this.pixelRatio_=i,this.resolution_=r,this.buildersByZIndex_={}}finish(){const e={};for(const n in this.buildersByZIndex_){e[n]=e[n]||{};const r=this.buildersByZIndex_[n];for(const i in r){const s=r[i].finish();e[n][i]=s}}return e}getBuilder(e,n){const r=e!==void 0?e.toString():"0";let i=this.buildersByZIndex_[r];i===void 0&&(i={},this.buildersByZIndex_[r]=i);let s=i[n];if(s===void 0){const o=ZAe[n];s=new o(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),i[n]=s}return s}}function QAe(t,e,n,r,i,s,o,a,l,c,u,h,f=!0){let g=t[e],y=t[e+1],_=0,b=0,T=0,A=0;function I(){_=g,b=y,e+=r,g=t[e],y=t[e+1],A+=T,T=Math.sqrt((g-_)*(g-_)+(y-b)*(y-b))}do I();while(e<n-r&&A+T<s);let P=T===0?0:(s-A)/T;const R=rc(_,g,P),D=rc(b,y,P),C=e-r,M=A,O=s+a*l(c,i,u);for(;e<n-r&&A+T<O;)I();P=T===0?0:(O-A)/T;const j=rc(_,g,P),V=rc(b,y,P);let U=!1;if(f)if(h){const Ne=[R,D,j,V];nG(Ne,0,4,2,h,Ne,Ne),U=Ne[0]>Ne[2]}else U=R>j;const G=Math.PI,de=[],Ie=C+r===e;e=C,T=0,A=M,g=t[e],y=t[e+1];let ze;if(Ie){I(),ze=Math.atan2(y-b,g-_),U&&(ze+=ze>0?-G:G);const Ne=(j+R)/2,fe=(V+D)/2;return de[0]=[Ne,fe,(O-s)/2,ze,i],de}i=i.replace(/\n/g," ");for(let Ne=0,fe=i.length;Ne<fe;){I();let De=Math.atan2(y-b,g-_);if(U&&(De+=De>0?-G:G),ze!==void 0){let le=De-ze;if(le+=le>G?-2*G:le<-G?2*G:0,Math.abs(le)>o)return null}ze=De;const Ce=Ne;let Q=0;for(;Ne<fe;++Ne){const le=U?fe-Ne-1:Ne,ve=a*l(c,i[le],u);if(e+r<n&&A+T<s+Q+ve/2)break;Q+=ve}if(Ne===Ce)continue;const W=U?i.substring(fe-Ce,fe-Ne):i.substring(Ce,Ne);P=T===0?0:(s+Q/2-A)/T;const ne=rc(_,g,P),ie=rc(b,y,P);de.push([ne,ie,Q/2,De,W]),s+=Q}return de}class Nle{constructor(){this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(j3(),{get:(e,n)=>{if(typeof j3()[n]=="function")return this.push_(n),this.pushMethodArgs_},set:(e,n,r)=>(this.push_(n,r),!0)})}push_(...e){const n=this.instructions_,r=this.zIndex+this.offset_;n[r]||(n[r]=[]),n[r].push(...e)}pushMethodArgs_=(...e)=>(this.push_(e),this);pushFunction(e){this.push_(e)}getContext(){return this.context_}draw(e){this.instructions_.forEach(n=>{for(let r=0,i=n.length;r<i;++r){const s=n[r];if(typeof s=="function"){s(e);continue}const o=n[++r];if(typeof e[s]=="function")e[s](...o);else{if(typeof o=="function"){e[s]=o(e);continue}e[s]=o}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}}const s_=Ba(),Qp=[],af=[],lf=[],em=[];function zX(t){return t[3].declutterBox}const GX=new RegExp("[-----]");function I6(t,e){return e==="start"?e=GX.test(t)?"right":"left":e==="end"&&(e=GX.test(t)?"left":"right"),z3[e]}function eIe(t,e,n){return n>0&&t.push(`
`,""),t.push(e,""),t}function tIe(t,e,n){return n%2===0&&(t+=e),t}class nIe{constructor(e,n,r,i,s){this.overlaps=r,this.pixelRatio=n,this.resolution=e,this.alignAndScaleFill_,this.instructions=i.instructions,this.coordinates=i.coordinates,this.coordinateCache_={},this.renderedTransform_=Ws(),this.hitDetectionInstructions=i.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=i.fillStates||{},this.strokeStates=i.strokeStates||{},this.textStates=i.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=s?new Nle:null}getZIndexContext(){return this.zIndexContext_}createLabel(e,n,r,i){const s=e+n+r+i;if(this.labels_[s])return this.labels_[s];const o=i?this.strokeStates[i]:null,a=r?this.fillStates[r]:null,l=this.textStates[n],c=this.pixelRatio,u=[l.scale[0]*c,l.scale[1]*c],h=l.justify?z3[l.justify]:I6(Array.isArray(e)?e[0]:e,l.textAlign||mk),f=i&&o.lineWidth?o.lineWidth:0,g=Array.isArray(e)?e:String(e).split(`
`).reduce(eIe,[]),{width:y,height:_,widths:b,heights:T,lineWidths:A}=yAe(l,g),I=y+f,P=[],R=(I+2)*u[0],D=(_+f)*u[1],C={width:R<0?Math.floor(R):Math.ceil(R),height:D<0?Math.floor(D):Math.ceil(D),contextInstructions:P};(u[0]!=1||u[1]!=1)&&P.push("scale",u),i&&(P.push("strokeStyle",o.strokeStyle),P.push("lineWidth",f),P.push("lineCap",o.lineCap),P.push("lineJoin",o.lineJoin),P.push("miterLimit",o.miterLimit),P.push("setLineDash",[o.lineDash]),P.push("lineDashOffset",o.lineDashOffset)),r&&P.push("fillStyle",a.fillStyle),P.push("textBaseline","middle"),P.push("textAlign","center");const M=.5-h;let O=h*I+M*f;const j=[],V=[];let U=0,G=0,de=0,Ie=0,ze;for(let Ne=0,fe=g.length;Ne<fe;Ne+=2){const De=g[Ne];if(De===`
`){G+=U,U=0,O=h*I+M*f,++Ie;continue}const Ce=g[Ne+1]||l.font;Ce!==ze&&(i&&j.push("font",Ce),r&&V.push("font",Ce),ze=Ce),U=Math.max(U,T[de]);const Q=[De,O+M*b[de]+h*(b[de]-A[Ie]),.5*(f+U)+G];O+=b[de],i&&j.push("strokeText",Q),r&&V.push("fillText",Q),++de}return Array.prototype.push.apply(P,j),Array.prototype.push.apply(P,V),this.labels_[s]=C,C}replayTextBackground_(e,n,r,i,s,o,a){e.beginPath(),e.moveTo.apply(e,n),e.lineTo.apply(e,r),e.lineTo.apply(e,i),e.lineTo.apply(e,s),e.lineTo.apply(e,n),o&&(this.alignAndScaleFill_=o[2],e.fillStyle=o[1],this.fill_(e)),a&&(this.setStrokeStyle_(e,a),e.stroke())}calculateImageOrLabelDimensions_(e,n,r,i,s,o,a,l,c,u,h,f,g,y,_,b){a*=f[0],l*=f[1];let T=r-a,A=i-l;const I=s+c>e?e-c:s,P=o+u>n?n-u:o,R=y[3]+I*f[0]+y[1],D=y[0]+P*f[1]+y[2],C=T-y[3],M=A-y[0];(_||h!==0)&&(Qp[0]=C,em[0]=C,Qp[1]=M,af[1]=M,af[0]=C+R,lf[0]=af[0],lf[1]=M+D,em[1]=lf[1]);let O;return h!==0?(O=pu(Ws(),r,i,1,1,h,-r,-i),Zi(O,Qp),Zi(O,af),Zi(O,lf),Zi(O,em),up(Math.min(Qp[0],af[0],lf[0],em[0]),Math.min(Qp[1],af[1],lf[1],em[1]),Math.max(Qp[0],af[0],lf[0],em[0]),Math.max(Qp[1],af[1],lf[1],em[1]),s_)):up(Math.min(C,C+R),Math.min(M,M+D),Math.max(C,C+R),Math.max(M,M+D),s_),g&&(T=Math.round(T),A=Math.round(A)),{drawImageX:T,drawImageY:A,drawImageW:I,drawImageH:P,originX:c,originY:u,declutterBox:{minX:s_[0],minY:s_[1],maxX:s_[2],maxY:s_[3],value:b},canvasTransform:O,scale:f}}replayImageOrLabel_(e,n,r,i,s,o,a){const l=!!(o||a),c=i.declutterBox,u=a?a[2]*i.scale[0]/2:0;return c.minX-u<=n[0]&&c.maxX+u>=0&&c.minY-u<=n[1]&&c.maxY+u>=0&&(l&&this.replayTextBackground_(e,Qp,af,lf,em,o,a),vAe(e,i.canvasTransform,s,r,i.originX,i.originY,i.drawImageW,i.drawImageH,i.drawImageX,i.drawImageY,i.scale)),!0}fill_(e){const n=this.alignAndScaleFill_;if(n){const r=Zi(this.renderedTransform_,[0,0]),i=512*this.pixelRatio;e.save(),e.translate(r[0]%i,r[1]%i),n!==1&&e.scale(n,n),e.rotate(this.viewRotation_)}e.fill(),n&&e.restore()}setStrokeStyle_(e,n){e.strokeStyle=n[1],n[1]&&(e.lineWidth=n[2],e.lineCap=n[3],e.lineJoin=n[4],e.miterLimit=n[5],e.lineDashOffset=n[7],e.setLineDash(n[6]))}drawLabelWithPointPlacement_(e,n,r,i){const s=this.textStates[n],o=this.createLabel(e,n,i,r),a=this.strokeStates[r],l=this.pixelRatio,c=I6(Array.isArray(e)?e[0]:e,s.textAlign||mk),u=z3[s.textBaseline||F3],h=a&&a.lineWidth?a.lineWidth:0,f=o.width/l-2*s.scale[0],g=c*f+2*(.5-c)*h,y=u*o.height/l+2*(.5-u)*h;return{label:o,anchorX:g,anchorY:y}}execute_(e,n,r,i,s,o,a,l){const c=this.zIndexContext_;let u;this.pixelCoordinates_&&zd(r,this.renderedTransform_)?u=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),u=vd(this.coordinates,0,this.coordinates.length,2,r,this.pixelCoordinates_),Zae(this.renderedTransform_,r));let h=0;const f=i.length;let g=0,y,_,b,T,A,I,P,R,D,C,M,O,j,V=0,U=0;const G=this.coordinateCache_,de=this.viewRotation_,Ie=Math.round(Math.atan2(-r[1],r[0])*1e12)/1e12,ze={context:e,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:de},Ne=this.instructions!=i||this.overlaps?0:200;let fe,De,Ce,Q;for(;h<f;){const W=i[h];switch(W[0]){case ln.BEGIN_GEOMETRY:fe=W[1],Q=W[3],fe.getGeometry()?a!==void 0&&!oa(a,Q.getExtent())?h=W[2]+1:++h:h=W[2],c&&(c.zIndex=W[4]);break;case ln.BEGIN_PATH:V>Ne&&(this.fill_(e),V=0),U>Ne&&(e.stroke(),U=0),!V&&!U&&(e.beginPath(),A=NaN,I=NaN),++h;break;case ln.CIRCLE:g=W[1];const ie=u[g],le=u[g+1],ve=u[g+2],qe=u[g+3],Ke=ve-ie,Se=qe-le,we=Math.sqrt(Ke*Ke+Se*Se);e.moveTo(ie+we,le),e.arc(ie,le,we,0,2*Math.PI,!0),++h;break;case ln.CLOSE_PATH:e.closePath(),++h;break;case ln.CUSTOM:g=W[1],y=W[2];const Dt=W[3],Ye=W[4],on=W[5];ze.geometry=Dt,ze.feature=fe,h in G||(G[h]=[]);const jt=G[h];on?on(u,g,y,2,jt):(jt[0]=u[g],jt[1]=u[g+1],jt.length=2),c&&(c.zIndex=W[6]),Ye(jt,ze),++h;break;case ln.DRAW_IMAGE:g=W[1],y=W[2],D=W[3],_=W[4],b=W[5];let pn=W[6];const _n=W[7],dt=W[8],hr=W[9],zn=W[10];let Wn=W[11];const ei=W[12];let _o=W[13];T=W[14]||"declutter";const Cr=W[15];if(!D&&W.length>=20){C=W[19],M=W[20],O=W[21],j=W[22];const Ve=this.drawLabelWithPointPlacement_(C,M,O,j);D=Ve.label,W[3]=D;const ee=W[23];_=(Ve.anchorX-ee)*this.pixelRatio,W[4]=_;const ge=W[24];b=(Ve.anchorY-ge)*this.pixelRatio,W[5]=b,pn=D.height,W[6]=pn,_o=D.width,W[13]=_o}let Ai;W.length>25&&(Ai=W[25]);let Ls,bt,Qn;W.length>17?(Ls=W[16],bt=W[17],Qn=W[18]):(Ls=My,bt=null,Qn=null),zn&&Ie?Wn+=de:!zn&&!Ie&&(Wn-=de);let dr=0;for(;g<y;g+=2){if(Ai&&Ai[dr++]<_o/this.pixelRatio)continue;const Ve=this.calculateImageOrLabelDimensions_(D.width,D.height,u[g],u[g+1],_o,pn,_,b,dt,hr,Wn,ei,s,Ls,!!bt||!!Qn,fe),ee=[e,n,D,Ve,_n,bt,Qn];if(l){let ge,je,Je;if(Cr){const et=y-g;if(!Cr[et]){Cr[et]={args:ee,declutterMode:T};continue}const Mt=Cr[et];ge=Mt.args,je=Mt.declutterMode,delete Cr[et],Je=zX(ge)}let Ge,nt;if(ge&&(je!=="declutter"||!l.collides(Je))&&(Ge=!0),(T!=="declutter"||!l.collides(Ve.declutterBox))&&(nt=!0),je==="declutter"&&T==="declutter"){const et=Ge&&nt;Ge=et,nt=et}Ge&&(je!=="none"&&l.insert(Je),this.replayImageOrLabel_.apply(this,ge)),nt&&(T!=="none"&&l.insert(Ve.declutterBox),this.replayImageOrLabel_.apply(this,ee))}else this.replayImageOrLabel_.apply(this,ee)}++h;break;case ln.DRAW_CHARS:const Ft=W[1],jn=W[2],en=W[3],$o=W[4];j=W[5];const Gi=W[6],Ds=W[7],Nn=W[8];O=W[9];const Ii=W[10];C=W[11],Array.isArray(C)&&(C=C.reduce(tIe,"")),M=W[12];const He=[W[13],W[13]];T=W[14]||"declutter";const ke=W[15],Ae=this.textStates[M],sn=Ae.font,z=[Ae.scale[0]*Ds,Ae.scale[1]*Ds];let Et;sn in this.widths_?Et=this.widths_[sn]:(Et={},this.widths_[sn]=Et);const X=lG(u,Ft,jn,2),ae=Math.abs(z[0])*PX(sn,C,Et);if($o||ae<=X){const Ve=this.textStates[M].textAlign,ee=(X-ae)*I6(C,Ve),ge=QAe(u,Ft,jn,2,C,ee,Gi,Math.abs(z[0]),PX,sn,Et,Ie?0:this.viewRotation_,ke);e:if(ge){const je=[];let Je,Ge,nt,et,Mt;if(O)for(Je=0,Ge=ge.length;Je<Ge;++Je){Mt=ge[Je],nt=Mt[4],et=this.createLabel(nt,M,"",O),_=Mt[2]+(z[0]<0?-Ii:Ii),b=en*et.height+(.5-en)*2*Ii*z[1]/z[0]-Nn;const zt=this.calculateImageOrLabelDimensions_(et.width,et.height,Mt[0],Mt[1],et.width,et.height,_,b,0,0,Mt[3],He,!1,My,!1,fe);if(l&&T==="declutter"&&l.collides(zt.declutterBox))break e;je.push([e,n,et,zt,1,null,null])}if(j)for(Je=0,Ge=ge.length;Je<Ge;++Je){Mt=ge[Je],nt=Mt[4],et=this.createLabel(nt,M,j,""),_=Mt[2],b=en*et.height-Nn;const zt=this.calculateImageOrLabelDimensions_(et.width,et.height,Mt[0],Mt[1],et.width,et.height,_,b,0,0,Mt[3],He,!1,My,!1,fe);if(l&&T==="declutter"&&l.collides(zt.declutterBox))break e;je.push([e,n,et,zt,1,null,null])}l&&T!=="none"&&l.load(je.map(zX));for(let zt=0,yn=je.length;zt<yn;++zt)this.replayImageOrLabel_.apply(this,je[zt])}}++h;break;case ln.END_GEOMETRY:if(o!==void 0){fe=W[1];const Ve=o(fe,Q,T);if(Ve)return Ve}++h;break;case ln.FILL:Ne?V++:this.fill_(e),++h;break;case ln.MOVE_TO_LINE_TO:for(g=W[1],y=W[2],De=u[g],Ce=u[g+1],e.moveTo(De,Ce),A=De+.5|0,I=Ce+.5|0,g+=2;g<y;g+=2)De=u[g],Ce=u[g+1],P=De+.5|0,R=Ce+.5|0,(g==y-2||P!==A||R!==I)&&(e.lineTo(De,Ce),A=P,I=R);++h;break;case ln.SET_FILL_STYLE:this.alignAndScaleFill_=W[2],V&&(this.fill_(e),V=0,U&&(e.stroke(),U=0)),e.fillStyle=W[1],++h;break;case ln.SET_STROKE_STYLE:U&&(e.stroke(),U=0),this.setStrokeStyle_(e,W),++h;break;case ln.STROKE:Ne?U++:e.stroke(),++h;break;default:++h;break}}V&&this.fill_(e),U&&e.stroke()}execute(e,n,r,i,s,o){this.viewRotation_=i,this.execute_(e,n,r,this.instructions,s,void 0,void 0,o)}executeHitDetection(e,n,r,i,s){return this.viewRotation_=r,this.execute_(e,[e.canvas.width,e.canvas.height],n,this.hitDetectionInstructions,!0,i,s)}}const xy=["Polygon","Circle","LineString","Image","Text","Default"],Ole=["Image","Text"],rIe=xy.filter(t=>!Ole.includes(t));class iIe{constructor(e,n,r,i,s,o,a){this.maxExtent_=e,this.overlaps_=i,this.pixelRatio_=r,this.resolution_=n,this.renderBuffer_=o,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=Ws(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(s,a)}clip(e,n){const r=this.getClipCoords(n);e.beginPath(),e.moveTo(r[0],r[1]),e.lineTo(r[2],r[3]),e.lineTo(r[4],r[5]),e.lineTo(r[6],r[7]),e.clip()}createExecutors_(e,n){for(const r in e){let i=this.executorsByZIndex_[r];i===void 0&&(i={},this.executorsByZIndex_[r]=i);const s=e[r];for(const o in s){const a=s[o];i[o]=new nIe(this.resolution_,this.pixelRatio_,this.overlaps_,a,n)}}}hasExecutors(e){for(const n in this.executorsByZIndex_){const r=this.executorsByZIndex_[n];for(let i=0,s=e.length;i<s;++i)if(e[i]in r)return!0}return!1}forEachFeatureAtCoordinate(e,n,r,i,s,o){i=Math.round(i);const a=i*2+1,l=pu(this.hitDetectionTransform_,i+.5,i+.5,1/n,-1/n,-r,-e[0],-e[1]),c=!this.hitDetectionContext_;c&&(this.hitDetectionContext_=Rs(a,a));const u=this.hitDetectionContext_;u.canvas.width!==a||u.canvas.height!==a?(u.canvas.width=a,u.canvas.height=a):c||u.clearRect(0,0,a,a);let h;this.renderBuffer_!==void 0&&(h=Ba(),JS(h,e),ih(h,n*(this.renderBuffer_+i),h));const f=sIe(i);let g;function y(R,D,C){const M=u.getImageData(0,0,a,a).data;for(let O=0,j=f.length;O<j;O++)if(M[f[O]]>0){if(!o||C==="none"||g!=="Image"&&g!=="Text"||o.includes(R)){const V=(f[O]-3)/4,U=i-V%a,G=i-(V/a|0),de=s(R,D,U*U+G*G);if(de)return de}u.clearRect(0,0,a,a);break}}const _=Object.keys(this.executorsByZIndex_).map(Number);_.sort(Zf);let b,T,A,I,P;for(b=_.length-1;b>=0;--b){const R=_[b].toString();for(A=this.executorsByZIndex_[R],T=xy.length-1;T>=0;--T)if(g=xy[T],I=A[g],I!==void 0&&(P=I.executeHitDetection(u,l,r,y,h),P))return P}}getClipCoords(e){const n=this.maxExtent_;if(!n)return null;const r=n[0],i=n[1],s=n[2],o=n[3],a=[r,i,r,o,s,o,s,i];return vd(a,0,8,2,e,a),a}isEmpty(){return v1(this.executorsByZIndex_)}execute(e,n,r,i,s,o,a){const l=Object.keys(this.executorsByZIndex_).map(Number);l.sort(a?VTe:Zf),o=o||xy;const c=xy.length;for(let u=0,h=l.length;u<h;++u){const f=l[u].toString(),g=this.executorsByZIndex_[f];for(let y=0,_=o.length;y<_;++y){const b=o[y],T=g[b];if(T!==void 0){const A=a===null?void 0:T.getZIndexContext(),I=A?A.getContext():e,P=this.maxExtent_&&b!=="Image"&&b!=="Text";if(P&&(I.save(),this.clip(I,r)),!A||b==="Text"||b==="Image"?T.execute(I,n,r,i,s,a):A.pushFunction(R=>T.execute(R,n,r,i,s,a)),P&&I.restore(),A){A.offset();const R=l[u]*c+xy.indexOf(b);this.deferredZIndexContexts_[R]||(this.deferredZIndexContexts_[R]=[]),this.deferredZIndexContexts_[R].push(A)}}}}this.renderedContext_=e}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const e=this.deferredZIndexContexts_,n=Object.keys(e).map(Number).sort(Zf);for(let r=0,i=n.length;r<i;++r)e[n[r]].forEach(s=>{s.draw(this.renderedContext_),s.clear()}),e[n[r]].length=0}}const P6={};function sIe(t){if(P6[t]!==void 0)return P6[t];const e=t*2+1,n=t*t,r=new Array(n+1);for(let s=0;s<=t;++s)for(let o=0;o<=t;++o){const a=s*s+o*o;if(a>n)break;let l=r[a];l||(l=[],r[a]=l),l.push(((t+s)*e+(t+o))*4+3),s>0&&l.push(((t-s)*e+(t+o))*4+3),o>0&&(l.push(((t+s)*e+(t-o))*4+3),s>0&&l.push(((t-s)*e+(t-o))*4+3))}const i=[];for(let s=0,o=r.length;s<o;++s)r[s]&&i.push(...r[s]);return P6[t]=i,i}function UX(t,e,n,r){return n!==void 0&&r!==void 0?[n/t,r/e]:n!==void 0?n/t:r!==void 0?r/e:1}let BA=class Lle extends P5{constructor(e){e=e||{};const n=e.opacity!==void 0?e.opacity:1,r=e.rotation!==void 0?e.rotation:0,i=e.scale!==void 0?e.scale:1,s=e.rotateWithView!==void 0?e.rotateWithView:!1;super({opacity:n,rotation:r,scale:i,displacement:e.displacement!==void 0?e.displacement:[0,0],rotateWithView:s,declutterMode:e.declutterMode}),this.anchor_=e.anchor!==void 0?e.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=e.anchorOrigin!==void 0?e.anchorOrigin:"top-left",this.anchorXUnits_=e.anchorXUnits!==void 0?e.anchorXUnits:"fraction",this.anchorYUnits_=e.anchorYUnits!==void 0?e.anchorYUnits:"fraction",this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null;const o=e.img!==void 0?e.img:null;let a=e.src;ur(!(a!==void 0&&o),"`image` and `src` cannot be provided at the same time"),(a===void 0||a.length===0)&&o&&(a=o.src||Qt(o)),ur(a!==void 0&&a.length>0,"A defined and non-empty `src` or `image` must be provided"),ur(!((e.width!==void 0||e.height!==void 0)&&e.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let l;if(e.src!==void 0?l=Vt.IDLE:o!==void 0&&("complete"in o?o.complete?l=o.src?Vt.LOADED:Vt.IDLE:l=Vt.LOADING:l=Vt.LOADED),this.color_=e.color!==void 0?mu(e.color):null,this.iconImage_=$3(o,a,this.crossOrigin_,l,this.color_),this.offset_=e.offset!==void 0?e.offset:[0,0],this.offsetOrigin_=e.offsetOrigin!==void 0?e.offsetOrigin:"top-left",this.origin_=null,this.size_=e.size!==void 0?e.size:null,this.initialOptions_,e.width!==void 0||e.height!==void 0){let c,u;if(e.size)[c,u]=e.size;else{const h=this.getImage(1);if(h.width&&h.height)c=h.width,u=h.height;else if(h instanceof HTMLImageElement){this.initialOptions_=e;const f=()=>{if(this.unlistenImageChange(f),!this.initialOptions_)return;const g=this.iconImage_.getSize();this.setScale(UX(g[0],g[1],e.width,e.height))};this.listenImageChange(f);return}}c!==void 0&&this.setScale(UX(c,u,e.width,e.height))}}clone(){let e,n,r;return this.initialOptions_?(n=this.initialOptions_.width,r=this.initialOptions_.height):(e=this.getScale(),e=Array.isArray(e)?e.slice():e),new Lle({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:e,width:n,height:r,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let e=this.normalizedAnchor_;if(!e){e=this.anchor_;const i=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!i)return null;e=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(e[0]*=i[0]),this.anchorYUnits_=="fraction"&&(e[1]*=i[1])}if(this.anchorOrigin_!="top-left"){if(!i)return null;e===this.anchor_&&(e=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(e[0]=-e[0]+i[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(e[1]=-e[1]+i[1])}this.normalizedAnchor_=e}const n=this.getDisplacement(),r=this.getScaleArray();return[e[0]-n[0]/r[0],e[1]+n[1]/r[1]]}setAnchor(e){this.anchor_=e,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(e){return this.iconImage_.getImage(e)}getPixelRatio(e){return this.iconImage_.getPixelRatio(e)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let e=this.offset_;if(this.offsetOrigin_!="top-left"){const n=this.getSize(),r=this.iconImage_.getSize();if(!n||!r)return null;e=e.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(e[0]=r[0]-n[0]-e[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(e[1]=r[1]-n[1]-e[1])}return this.origin_=e,this.origin_}getSrc(){return this.iconImage_.getSrc()}setSrc(e){this.iconImage_=$3(null,e,this.crossOrigin_,Vt.IDLE,this.color_)}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const e=this.getScaleArray();if(this.size_)return this.size_[0]*e[0];if(this.iconImage_.getImageState()==Vt.LOADED)return this.iconImage_.getSize()[0]*e[0]}getHeight(){const e=this.getScaleArray();if(this.size_)return this.size_[1]*e[1];if(this.iconImage_.getImageState()==Vt.LOADED)return this.iconImage_.getSize()[1]*e[1]}setScale(e){delete this.initialOptions_,super.setScale(e)}listenImageChange(e){this.iconImage_.addEventListener(wn.CHANGE,e)}load(){this.iconImage_.load()}unlistenImageChange(e){this.iconImage_.removeEventListener(wn.CHANGE,e)}ready(){return this.iconImage_.ready()}};const ud=.5;function oIe(t,e,n,r,i,s,o,a,l){const c=i,u=t[0]*ud,h=t[1]*ud,f=Rs(u,h);f.imageSmoothingEnabled=!1;const g=f.canvas,y=new xAe(f,ud,i,null,o,a,null),_=n.length,b=Math.floor((256*256*256-1)/_),T={};for(let I=1;I<=_;++I){const P=n[I-1],R=P.getStyleFunction()||r;if(!R)continue;let D=R(P,s);if(!D)continue;Array.isArray(D)||(D=[D]);const M=(I*b).toString(16).padStart(7,"#00000");for(let O=0,j=D.length;O<j;++O){const V=D[O],U=V.getGeometryFunction()(P);if(!U||!oa(c,U.getExtent()))continue;const G=V.clone(),de=G.getFill();de&&de.setColor(M);const Ie=G.getStroke();Ie&&(Ie.setColor(M),Ie.setLineDash(null)),G.setText(void 0);const ze=V.getImage();if(ze){const Ce=ze.getImageSize();if(!Ce)continue;const Q=Rs(Ce[0],Ce[1],void 0,{alpha:!1}),W=Q.canvas;Q.fillStyle=M,Q.fillRect(0,0,W.width,W.height),G.setImage(new BA({img:W,anchor:ze.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:ze.getOrigin(),opacity:1,size:ze.getSize(),scale:ze.getScale(),rotation:ze.getRotation(),rotateWithView:ze.getRotateWithView()}))}const Ne=G.getZIndex()||0;let fe=T[Ne];fe||(fe={},T[Ne]=fe,fe.Polygon=[],fe.Circle=[],fe.LineString=[],fe.Point=[]);const De=U.getType();if(De==="GeometryCollection"){const Ce=U.getGeometriesArrayRecursive();for(let Q=0,W=Ce.length;Q<W;++Q){const ne=Ce[Q];fe[ne.getType().replace("Multi","")].push(ne,G)}}else fe[De.replace("Multi","")].push(U,G)}}const A=Object.keys(T).map(Number).sort(Zf);for(let I=0,P=A.length;I<P;++I){const R=T[A[I]];for(const D in R){const C=R[D];for(let M=0,O=C.length;M<O;M+=2){y.setStyle(C[M+1]);for(let j=0,V=e.length;j<V;++j)y.setTransform(e[j]),y.drawGeometry(C[M])}}}return f.getImageData(0,0,g.width,g.height)}function aIe(t,e,n){const r=[];if(n){const i=Math.floor(Math.round(t[0])*ud),s=Math.floor(Math.round(t[1])*ud),o=(ri(i,0,n.width-1)+ri(s,0,n.height-1)*n.width)*4,a=n.data[o],l=n.data[o+1],u=n.data[o+2]+256*(l+256*a),h=Math.floor((256*256*256-1)/e.length);u&&u%h===0&&r.push(e[u/h-1])}return r}class eT extends Sc{constructor(e,n,r,i){super(e),this.inversePixelTransform=n,this.frameState=r,this.context=i}}const lIe=5;class Dle extends $A{constructor(e){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=e,this.staleKeys_=new Array,this.maxStaleKeys=lIe}getStaleKeys(){return this.staleKeys_}prependStaleKey(e){this.staleKeys_.unshift(e),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(e){return bn()}getData(e){return null}prepareFrame(e){return bn()}renderFrame(e,n){return bn()}forEachFeatureAtCoordinate(e,n,r,i,s){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(e){const n=e.target;(n.getState()===Vt.LOADED||n.getState()===Vt.ERROR)&&this.renderIfReadyAndVisible()}loadImage(e){let n=e.getState();return n!=Vt.LOADED&&n!=Vt.ERROR&&e.addEventListener(wn.CHANGE,this.boundHandleImageChange_),n==Vt.IDLE&&(e.load(),n=e.getState()),n==Vt.LOADED}renderIfReadyAndVisible(){const e=this.getLayer();e&&e.getVisible()&&e.getSourceState()==="ready"&&e.changed()}renderDeferred(e){}disposeInternal(){delete this.layer_,super.disposeInternal()}}const BX=[];let F_=null;function cIe(){F_=Rs(1,1,void 0,{willReadFrequently:!0})}class xG extends Dle{constructor(e){super(e),this.container=null,this.renderedResolution,this.tempTransform=Ws(),this.pixelTransform=Ws(),this.inversePixelTransform=Ws(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(e,n,r){F_||cIe(),F_.clearRect(0,0,1,1);let i;try{F_.drawImage(e,n,r,1,1,0,0,1,1),i=F_.getImageData(0,0,1,1).data}catch{return F_=null,null}return i}getBackground(e){let r=this.getLayer().getBackground();return typeof r=="function"&&(r=r(e.viewState.resolution)),r||void 0}useContainer(e,n,r){const i=this.getLayer().getClassName();let s,o;if(e&&e.className===i&&(!r||e&&e.style.backgroundColor&&zd(mu(e.style.backgroundColor),mu(r)))){const a=e.firstElementChild;Xm(a)&&(o=a.getContext("2d"))}if(o&&Nke(o.canvas.style.transform,n)?(this.container=e,this.context=o,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){s=cc?cle():document.createElement("div"),s.className=i;let a=s.style;a.position="absolute",a.width="100%",a.height="100%",o=Rs();const l=o.canvas;s.appendChild(l),a=l.style,a.position="absolute",a.left="0",a.transformOrigin="top left",this.container=s,this.context=o}!this.containerReused&&r&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=r)}clipUnrotated(e,n,r){const i=iv(r),s=w5(r),o=x5(r),a=_5(r);Zi(n.coordinateToPixelTransform,i),Zi(n.coordinateToPixelTransform,s),Zi(n.coordinateToPixelTransform,o),Zi(n.coordinateToPixelTransform,a);const l=this.inversePixelTransform;Zi(l,i),Zi(l,s),Zi(l,o),Zi(l,a),e.save(),e.beginPath(),e.moveTo(Math.round(i[0]),Math.round(i[1])),e.lineTo(Math.round(s[0]),Math.round(s[1])),e.lineTo(Math.round(o[0]),Math.round(o[1])),e.lineTo(Math.round(a[0]),Math.round(a[1])),e.clip()}prepareContainer(e,n){const r=e.extent,i=e.viewState.resolution,s=e.viewState.rotation,o=e.pixelRatio,a=Math.round(Xn(r)/i*o),l=Math.round(Ps(r)/i*o);pu(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/o,1/o,s,-a/2,-l/2),hk(this.inversePixelTransform,this.pixelTransform);const c=Mke(this.pixelTransform);if(this.useContainer(n,c,this.getBackground(e)),!this.containerReused){const u=this.context.canvas;u.width!=a||u.height!=l?(u.width=a,u.height=l):this.context.clearRect(0,0,a,l),c!==u.style.transform&&(u.style.transform=c)}}dispatchRenderEvent_(e,n,r){const i=this.getLayer();if(i.hasListener(e)){const s=new eT(e,this.inversePixelTransform,r,n);i.dispatchEvent(s)}}preRender(e,n){this.frameState=n,!n.declutter&&this.dispatchRenderEvent_(co.PRERENDER,e,n)}postRender(e,n){n.declutter||this.dispatchRenderEvent_(co.POSTRENDER,e,n)}renderDeferredInternal(e){}getRenderContext(e){return e.declutter&&!this.deferredContext_&&(this.deferredContext_=new Nle),e.declutter?this.deferredContext_.getContext():this.context}renderDeferred(e){e.declutter&&(this.dispatchRenderEvent_(co.PRERENDER,this.context,e),e.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(e),this.dispatchRenderEvent_(co.POSTRENDER,this.context,e))}getRenderTransform(e,n,r,i,s,o,a){const l=s/2,c=o/2,u=i/n,h=-u,f=-e[0]+a,g=-e[1];return pu(this.tempTransform,l,c,u,h,-r,f,g)}disposeInternal(){delete this.frameState,super.disposeInternal()}}class uIe extends xG{constructor(e){super(e),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipped_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=Ba(),this.wrappedRenderedExtent_=Ba(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(e,n,r){const i=n.extent,s=n.viewState,o=s.center,a=s.resolution,l=s.projection,c=s.rotation,u=l.getExtent(),h=this.getLayer().getSource(),f=this.getLayer().getDeclutter(),g=n.pixelRatio,y=n.viewHints,_=!(y[Ts.ANIMATING]||y[Ts.INTERACTING]),b=this.context,T=Math.round(Xn(i)/a*g),A=Math.round(Ps(i)/a*g),I=h.getWrapX()&&l.canWrapX(),P=I?Xn(u):null,R=I?Math.ceil((i[2]-u[2])/P)+1:1;let D=I?Math.floor((i[0]-u[0])/P):0;do{let C=this.getRenderTransform(o,a,0,g,T,A,D*P);n.declutter&&(C=C.slice(0)),e.execute(b,[b.canvas.width,b.canvas.height],C,c,_,r===void 0?xy:r?Ole:rIe,r?f&&n.declutter[f]:void 0)}while(++D<R)}setDrawContext_(){this.opacity_!==1&&(this.targetContext_=this.context,this.context=Rs(this.context.canvas.width,this.context.canvas.height,BX))}resetDrawContext_(){if(this.opacity_!==1&&this.targetContext_){const e=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=e,I5(this.context),BX.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(e){!this.replayGroup_||!this.getLayer().getDeclutter()||this.renderWorlds(this.replayGroup_,e,!0)}renderDeferredInternal(e){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}renderFrame(e,n){const r=e.layerStatesArray[e.layerIndex];this.opacity_=r.opacity;const i=e.viewState;this.prepareContainer(e,n);const s=this.context,o=this.replayGroup_;let a=o&&!o.isEmpty();if(!a&&!(this.getLayer().hasListener(co.PRERENDER)||this.getLayer().hasListener(co.POSTRENDER)))return this.container;if(this.setDrawContext_(),this.preRender(s,e),i.projection,this.clipped_=!1,a&&r.extent&&this.clipping){const l=sh(r.extent);a=oa(l,e.extent),this.clipped_=a&&!qm(l,e.extent),this.clipped_&&this.clipUnrotated(s,e,l)}return a&&this.renderWorlds(o,e,this.getLayer().getDeclutter()?!1:void 0),!e.declutter&&this.clipped_&&s.restore(),this.postRender(s,e),this.renderedRotation_!==i.rotation&&(this.renderedRotation_=i.rotation,this.hitDetectionImageData_=null),e.declutter||this.resetDrawContext_(),this.container}getFeatures(e){return new Promise(n=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const r=this.frameState.size.slice(),i=this.renderedCenter_,s=this.renderedResolution_,o=this.renderedRotation_,a=this.renderedProjection_,l=this.wrappedRenderedExtent_,c=this.getLayer(),u=[],h=r[0]*ud,f=r[1]*ud;u.push(this.getRenderTransform(i,s,o,ud,h,f,0).slice());const g=c.getSource(),y=a.getExtent();if(g.getWrapX()&&a.canWrapX()&&!qm(y,l)){let _=l[0];const b=Xn(y);let T=0,A;for(;_<y[0];)--T,A=b*T,u.push(this.getRenderTransform(i,s,o,ud,h,f,A).slice()),_+=b;for(T=0,_=l[2];_>y[2];)++T,A=b*T,u.push(this.getRenderTransform(i,s,o,ud,h,f,A).slice()),_-=b}this.hitDetectionImageData_=oIe(r,u,this.renderedFeatures_,c.getStyleFunction(),l,s,o,CX(s,this.renderedPixelRatio_))}n(aIe(e,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(e,n,r,i,s){if(!this.replayGroup_)return;const o=n.viewState.resolution,a=n.viewState.rotation,l=this.getLayer(),c={},u=function(f,g,y){const _=Qt(f),b=c[_];if(b){if(b!==!0&&y<b.distanceSq){if(y===0)return c[_]=!0,s.splice(s.lastIndexOf(b),1),i(f,l,g);b.geometry=g,b.distanceSq=y}}else{if(y===0)return c[_]=!0,i(f,l,g);s.push(c[_]={feature:f,layer:l,geometry:g,distanceSq:y,callback:i})}},h=this.getLayer().getDeclutter();return this.replayGroup_.forEachFeatureAtCoordinate(e,o,a,r,u,h?n.declutter?.[h]?.all().map(f=>f.value):null)}handleFontsChanged(){const e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}prepareFrame(e){const n=this.getLayer(),r=n.getSource();if(!r)return!1;const i=e.viewHints[Ts.ANIMATING],s=e.viewHints[Ts.INTERACTING],o=n.getUpdateWhileAnimating(),a=n.getUpdateWhileInteracting();if(this.ready&&!o&&i||!a&&s)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const l=e.extent,c=e.viewState,u=c.projection,h=c.resolution,f=e.pixelRatio,g=n.getRevision(),y=n.getRenderBuffer();let _=n.getRenderOrder();_===void 0&&(_=bAe);const b=c.center.slice(),T=ih(l,y*h),A=T.slice(),I=[T.slice()],P=u.getExtent();if(r.getWrapX()&&u.canWrapX()&&!qm(P,e.extent)){const de=Xn(P),Ie=Math.max(Xn(T)/2,de);T[0]=P[0]-Ie,T[2]=P[2]+Ie,zae(b,u);const ze=$ae(I[0],u);ze[0]<P[0]&&ze[2]<P[2]?I.push([ze[0]+de,ze[1],ze[2]+de,ze[3]]):ze[0]>P[0]&&ze[2]>P[2]&&I.push([ze[0]-de,ze[1],ze[2]-de,ze[3]])}if(this.ready&&this.renderedResolution_==h&&this.renderedRevision_==g&&this.renderedRenderOrder_==_&&this.renderedFrameDeclutter_===!!e.declutter&&qm(this.wrappedRenderedExtent_,T))return zd(this.renderedExtent_,A)||(this.hitDetectionImageData_=null,this.renderedExtent_=A),this.renderedCenter_=b,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const R=new JAe(xle(h,f),T,h,f);let D;for(let de=0,Ie=I.length;de<Ie;++de)r.loadFeatures(I[de],h,u);const C=CX(h,f);let M=!0;const O=(de,Ie)=>{let ze;const Ne=de.getStyleFunction()||n.getStyleFunction();if(Ne&&(ze=Ne(de,h)),ze){const fe=this.renderFeature(de,C,ze,R,D,this.getLayer().getDeclutter(),Ie);M=M&&!fe}},j=tG(T),V=r.getFeaturesInExtent(j);_&&V.sort(_);for(let de=0,Ie=V.length;de<Ie;++de)O(V[de],de);this.renderedFeatures_=V,this.ready=M;const U=R.finish(),G=new iIe(T,h,f,r.getOverlaps(),U,n.getRenderBuffer(),!!e.declutter);return this.renderedResolution_=h,this.renderedRevision_=g,this.renderedRenderOrder_=_,this.renderedFrameDeclutter_=!!e.declutter,this.renderedExtent_=A,this.wrappedRenderedExtent_=T,this.renderedCenter_=b,this.renderedProjection_=u,this.renderedPixelRatio_=f,this.replayGroup_=G,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(e,n,r,i,s,o,a){if(!r)return!1;let l=!1;if(Array.isArray(r))for(let c=0,u=r.length;c<u;++c)l=RX(i,e,r[c],n,this.boundHandleStyleImageChange_,s,o,a)||l;else l=RX(i,e,r,n,this.boundHandleStyleImageChange_,s,o,a);return l}}let ov=0;const Is=1<<ov++,Wt=1<<ov++,Us=1<<ov++,Ei=1<<ov++,Al=1<<ov++,ru=1<<ov++,mC=Math.pow(2,ov)-1,wG={[Is]:"boolean",[Wt]:"number",[Us]:"string",[Ei]:"color",[Al]:"number[]",[ru]:"size"},hIe=Object.keys(wG).map(Number).sort(Zf);function dIe(t){return t in wG}function Ex(t){const e=[];for(const n of hIe)rS(t,n)&&e.push(wG[n]);return e.length===0?"untyped":e.length<3?e.join(" or "):e.slice(0,-1).join(", ")+", or "+e[e.length-1]}function rS(t,e){return(t&e)===e}function id(t,e){return t===e}class zs{constructor(e,n){if(!dIe(e))throw new Error(`literal expressions must have a specific type, got ${Ex(e)}`);this.type=e,this.value=n}}class jle{constructor(e,n,...r){this.type=e,this.operator=n,this.args=r}}function bG(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,mapState:!1}}function ho(t,e,n){switch(typeof t){case"boolean":{if(id(e,Us))return new zs(Us,t?"true":"false");if(!rS(e,Is))throw new Error(`got a boolean, but expected ${Ex(e)}`);return new zs(Is,t)}case"number":{if(id(e,ru))return new zs(ru,ja(t));if(id(e,Is))return new zs(Is,!!t);if(id(e,Us))return new zs(Us,t.toString());if(!rS(e,Wt))throw new Error(`got a number, but expected ${Ex(e)}`);return new zs(Wt,t)}case"string":{if(id(e,Ei))return new zs(Ei,dG(t));if(id(e,Is))return new zs(Is,!!t);if(!rS(e,Us))throw new Error(`got a string, but expected ${Ex(e)}`);return new zs(Us,t)}}if(!Array.isArray(t))throw new Error("expression must be an array or a primitive value");if(t.length===0)throw new Error("empty expression");if(typeof t[0]=="string")return EIe(t,e,n);for(const r of t)if(typeof r!="number")throw new Error("expected an array of numbers");if(id(e,ru)){if(t.length!==2)throw new Error(`expected an array of two values for a size, got ${t.length}`);return new zs(ru,t)}if(id(e,Ei)){if(t.length===3)return new zs(Ei,[...t,1]);if(t.length===4)return new zs(Ei,t);throw new Error(`expected an array of 3 or 4 values for a color, got ${t.length}`)}if(!rS(e,Al))throw new Error(`got an array of numbers, but expected ${Ex(e)}`);return new zs(Al,t)}const Te={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",LineMetric:"line-metric",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string",Has:"has"},fIe={[Te.Get]:Tn($n(1,1/0),WX),[Te.Var]:Tn($n(1,1),pIe),[Te.Has]:Tn($n(1,1/0),WX),[Te.Id]:Tn(mIe,o_),[Te.Concat]:Tn($n(2,1/0),Er(Us)),[Te.GeometryType]:Tn(gIe,o_),[Te.LineMetric]:Tn(o_),[Te.Resolution]:Tn(C6,o_),[Te.Zoom]:Tn(C6,o_),[Te.Time]:Tn(C6,o_),[Te.Any]:Tn($n(2,1/0),Er(Is)),[Te.All]:Tn($n(2,1/0),Er(Is)),[Te.Not]:Tn($n(1,1),Er(Is)),[Te.Equal]:Tn($n(2,2),Er(mC)),[Te.NotEqual]:Tn($n(2,2),Er(mC)),[Te.GreaterThan]:Tn($n(2,2),Er(Wt)),[Te.GreaterThanOrEqualTo]:Tn($n(2,2),Er(Wt)),[Te.LessThan]:Tn($n(2,2),Er(Wt)),[Te.LessThanOrEqualTo]:Tn($n(2,2),Er(Wt)),[Te.Multiply]:Tn($n(2,1/0),HX),[Te.Coalesce]:Tn($n(2,1/0),HX),[Te.Divide]:Tn($n(2,2),Er(Wt)),[Te.Add]:Tn($n(2,1/0),Er(Wt)),[Te.Subtract]:Tn($n(2,2),Er(Wt)),[Te.Clamp]:Tn($n(3,3),Er(Wt)),[Te.Mod]:Tn($n(2,2),Er(Wt)),[Te.Pow]:Tn($n(2,2),Er(Wt)),[Te.Abs]:Tn($n(1,1),Er(Wt)),[Te.Floor]:Tn($n(1,1),Er(Wt)),[Te.Ceil]:Tn($n(1,1),Er(Wt)),[Te.Round]:Tn($n(1,1),Er(Wt)),[Te.Sin]:Tn($n(1,1),Er(Wt)),[Te.Cos]:Tn($n(1,1),Er(Wt)),[Te.Atan]:Tn($n(1,2),Er(Wt)),[Te.Sqrt]:Tn($n(1,1),Er(Wt)),[Te.Match]:Tn($n(4,1/0),qX,vIe),[Te.Between]:Tn($n(3,3),Er(Wt)),[Te.Interpolate]:Tn($n(6,1/0),qX,_Ie),[Te.Case]:Tn($n(3,1/0),yIe,xIe),[Te.In]:Tn($n(2,2),wIe),[Te.Number]:Tn($n(1,1/0),Er(mC)),[Te.String]:Tn($n(1,1/0),Er(mC)),[Te.Array]:Tn($n(1,1/0),Er(Wt)),[Te.Color]:Tn($n(1,4),Er(Wt)),[Te.Band]:Tn($n(1,3),Er(Wt)),[Te.Palette]:Tn($n(2,2),bIe),[Te.ToString]:Tn($n(1,1),Er(Is|Wt|Us|Ei))};function WX(t,e,n){const r=t.length-1,i=new Array(r);for(let s=0;s<r;++s){const o=t[s+1];switch(typeof o){case"number":{i[s]=new zs(Wt,o);break}case"string":{i[s]=new zs(Us,o);break}default:throw new Error(`expected a string key or numeric array index for a get operation, got ${o}`)}s===0&&n.properties.add(String(o))}return i}function pIe(t,e,n){const r=t[1];if(typeof r!="string")throw new Error("expected a string argument for var operation");return n.variables.add(r),[new zs(Us,r)]}function mIe(t,e,n){n.featureId=!0}function gIe(t,e,n){n.geometryType=!0}function C6(t,e,n){n.mapState=!0}function o_(t,e,n){const r=t[0];if(t.length!==1)throw new Error(`expected no arguments for ${r} operation`);return[]}function $n(t,e){return function(n,r,i){const s=n[0],o=n.length-1;if(t===e){if(o!==t){const a=t===1?"":"s";throw new Error(`expected ${t} argument${a} for ${s}, got ${o}`)}}else if(o<t||o>e){const a=e===1/0?`${t} or more`:`${t} to ${e}`;throw new Error(`expected ${a} arguments for ${s}, got ${o}`)}}}function HX(t,e,n){const r=t.length-1,i=new Array(r);for(let s=0;s<r;++s){const o=ho(t[s+1],e,n);i[s]=o}return i}function Er(t){return function(e,n,r){const i=e.length-1,s=new Array(i);for(let o=0;o<i;++o){const a=ho(e[o+1],t,r);s[o]=a}return s}}function yIe(t,e,n){const r=t[0],i=t.length-1;if(i%2===0)throw new Error(`expected an odd number of arguments for ${r}, got ${i} instead`)}function qX(t,e,n){const r=t[0],i=t.length-1;if(i%2===1)throw new Error(`expected an even number of arguments for operation ${r}, got ${i} instead`)}function vIe(t,e,n){const r=t.length-1,i=Us|Wt|Is,s=ho(t[1],i,n),o=ho(t[t.length-1],e,n),a=new Array(r-2);for(let l=0;l<r-2;l+=2){try{const c=ho(t[l+2],s.type,n);a[l]=c}catch(c){throw new Error(`failed to parse argument ${l+1} of match expression: ${c.message}`)}try{const c=ho(t[l+3],o.type,n);a[l+1]=c}catch(c){throw new Error(`failed to parse argument ${l+2} of match expression: ${c.message}`)}}return[s,...a,o]}function _Ie(t,e,n){const r=t[1];let i;switch(r[0]){case"linear":i=1;break;case"exponential":const l=r[1];if(typeof l!="number"||l<=0)throw new Error(`expected a number base for exponential interpolation, got ${JSON.stringify(l)} instead`);i=l;break;default:throw new Error(`invalid interpolation type: ${JSON.stringify(r)}`)}const s=new zs(Wt,i);let o;try{o=ho(t[2],Wt,n)}catch(l){throw new Error(`failed to parse argument 1 in interpolate expression: ${l.message}`)}const a=new Array(t.length-3);for(let l=0;l<a.length;l+=2){try{const c=ho(t[l+3],Wt,n);a[l]=c}catch(c){throw new Error(`failed to parse argument ${l+2} for interpolate expression: ${c.message}`)}try{const c=ho(t[l+4],e,n);a[l+1]=c}catch(c){throw new Error(`failed to parse argument ${l+3} for interpolate expression: ${c.message}`)}}return[s,o,...a]}function xIe(t,e,n){const r=ho(t[t.length-1],e,n),i=new Array(t.length-1);for(let s=0;s<i.length-1;s+=2){try{const o=ho(t[s+1],Is,n);i[s]=o}catch(o){throw new Error(`failed to parse argument ${s} of case expression: ${o.message}`)}try{const o=ho(t[s+2],r.type,n);i[s+1]=o}catch(o){throw new Error(`failed to parse argument ${s+1} of case expression: ${o.message}`)}}return i[i.length-1]=r,i}function wIe(t,e,n){let r=t[2];if(!Array.isArray(r))throw new Error('the second argument for the "in" operator must be an array');let i;if(typeof r[0]=="string"){if(r[0]!=="literal")throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(r[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');r=r[1],i=Us}else i=Wt;const s=new Array(r.length);for(let a=0;a<s.length;a++)try{const l=ho(r[a],i,n);s[a]=l}catch(l){throw new Error(`failed to parse haystack item ${a} for "in" expression: ${l.message}`)}return[ho(t[1],i,n),...s]}function bIe(t,e,n){let r;try{r=ho(t[1],Wt,n)}catch(o){throw new Error(`failed to parse first argument in palette expression: ${o.message}`)}const i=t[2];if(!Array.isArray(i))throw new Error("the second argument of palette must be an array");const s=new Array(i.length);for(let o=0;o<s.length;o++){let a;try{a=ho(i[o],Ei,n)}catch(l){throw new Error(`failed to parse color at index ${o} in palette expression: ${l.message}`)}if(!(a instanceof zs))throw new Error(`the palette color at index ${o} must be a literal value`);s[o]=a}return[r,...s]}function Tn(...t){return function(e,n,r){const i=e[0];let s;for(let o=0;o<t.length;o++){const a=t[o](e,n,r);if(o==t.length-1){if(!a)throw new Error("expected last argument validator to return the parsed args");s=a}}return new jle(n,i,...s)}}function EIe(t,e,n){const r=t[0],i=fIe[r];if(!i)throw new Error(`unknown operator: ${r}`);return i(t,e,n)}function EG(t){if(!t)return"";const e=t.getType();switch(e){case"Point":case"LineString":case"Polygon":return e;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return e.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return EG(t.getGeometries()[0]);default:return""}}function $le(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function Ep(t,e,n){const r=ho(t,e,n);return vh(r)}function vh(t,e){if(t instanceof zs){if(t.type===Ei&&typeof t.value=="string"){const r=dG(t.value);return function(){return r}}return function(){return t.value}}const n=t.operator;switch(n){case Te.Number:case Te.String:case Te.Coalesce:return SIe(t);case Te.Get:case Te.Var:case Te.Has:return TIe(t);case Te.Id:return r=>r.featureId;case Te.GeometryType:return r=>r.geometryType;case Te.Concat:{const r=t.args.map(i=>vh(i));return i=>"".concat(...r.map(s=>s(i).toString()))}case Te.Resolution:return r=>r.resolution;case Te.Any:case Te.All:case Te.Between:case Te.In:case Te.Not:return AIe(t);case Te.Equal:case Te.NotEqual:case Te.LessThan:case Te.LessThanOrEqualTo:case Te.GreaterThan:case Te.GreaterThanOrEqualTo:return kIe(t);case Te.Multiply:case Te.Divide:case Te.Add:case Te.Subtract:case Te.Clamp:case Te.Mod:case Te.Pow:case Te.Abs:case Te.Floor:case Te.Ceil:case Te.Round:case Te.Sin:case Te.Cos:case Te.Atan:case Te.Sqrt:return IIe(t);case Te.Case:return PIe(t);case Te.Match:return CIe(t);case Te.Interpolate:return RIe(t);case Te.ToString:return MIe(t);default:throw new Error(`Unsupported operator ${n}`)}}function SIe(t,e){const n=t.operator,r=t.args.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=vh(t.args[s]);switch(n){case Te.Coalesce:return s=>{for(let o=0;o<r;++o){const a=i[o](s);if(typeof a<"u"&&a!==null)return a}throw new Error("Expected one of the values to be non-null")};case Te.Number:case Te.String:return s=>{for(let o=0;o<r;++o){const a=i[o](s);if(typeof a===n)return a}throw new Error(`Expected one of the values to be a ${n}`)};default:throw new Error(`Unsupported assertion operator ${n}`)}}function TIe(t,e){const r=t.args[0].value;switch(t.operator){case Te.Get:return i=>{const s=t.args;let o=i.properties[r];for(let a=1,l=s.length;a<l;++a){const u=s[a].value;o=o[u]}return o};case Te.Var:return i=>i.variables[r];case Te.Has:return i=>{const s=t.args;if(!(r in i.properties))return!1;let o=i.properties[r];for(let a=1,l=s.length;a<l;++a){const u=s[a].value;if(!o||!Object.hasOwn(o,u))return!1;o=o[u]}return!0};default:throw new Error(`Unsupported accessor operator ${t.operator}`)}}function kIe(t,e){const n=t.operator,r=vh(t.args[0]),i=vh(t.args[1]);switch(n){case Te.Equal:return s=>r(s)===i(s);case Te.NotEqual:return s=>r(s)!==i(s);case Te.LessThan:return s=>r(s)<i(s);case Te.LessThanOrEqualTo:return s=>r(s)<=i(s);case Te.GreaterThan:return s=>r(s)>i(s);case Te.GreaterThanOrEqualTo:return s=>r(s)>=i(s);default:throw new Error(`Unsupported comparison operator ${n}`)}}function AIe(t,e){const n=t.operator,r=t.args.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=vh(t.args[s]);switch(n){case Te.Any:return s=>{for(let o=0;o<r;++o)if(i[o](s))return!0;return!1};case Te.All:return s=>{for(let o=0;o<r;++o)if(!i[o](s))return!1;return!0};case Te.Between:return s=>{const o=i[0](s),a=i[1](s),l=i[2](s);return o>=a&&o<=l};case Te.In:return s=>{const o=i[0](s);for(let a=1;a<r;++a)if(o===i[a](s))return!0;return!1};case Te.Not:return s=>!i[0](s);default:throw new Error(`Unsupported logical operator ${n}`)}}function IIe(t,e){const n=t.operator,r=t.args.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=vh(t.args[s]);switch(n){case Te.Multiply:return s=>{let o=1;for(let a=0;a<r;++a)o*=i[a](s);return o};case Te.Divide:return s=>i[0](s)/i[1](s);case Te.Add:return s=>{let o=0;for(let a=0;a<r;++a)o+=i[a](s);return o};case Te.Subtract:return s=>i[0](s)-i[1](s);case Te.Clamp:return s=>{const o=i[0](s),a=i[1](s);if(o<a)return a;const l=i[2](s);return o>l?l:o};case Te.Mod:return s=>i[0](s)%i[1](s);case Te.Pow:return s=>Math.pow(i[0](s),i[1](s));case Te.Abs:return s=>Math.abs(i[0](s));case Te.Floor:return s=>Math.floor(i[0](s));case Te.Ceil:return s=>Math.ceil(i[0](s));case Te.Round:return s=>Math.round(i[0](s));case Te.Sin:return s=>Math.sin(i[0](s));case Te.Cos:return s=>Math.cos(i[0](s));case Te.Atan:return r===2?s=>Math.atan2(i[0](s),i[1](s)):s=>Math.atan(i[0](s));case Te.Sqrt:return s=>Math.sqrt(i[0](s));default:throw new Error(`Unsupported numeric operator ${n}`)}}function PIe(t,e){const n=t.args.length,r=new Array(n);for(let i=0;i<n;++i)r[i]=vh(t.args[i]);return i=>{for(let s=0;s<n-1;s+=2)if(r[s](i))return r[s+1](i);return r[n-1](i)}}function CIe(t,e){const n=t.args.length,r=new Array(n);for(let i=0;i<n;++i)r[i]=vh(t.args[i]);return i=>{const s=r[0](i);for(let o=1;o<n-1;o+=2)if(s===r[o](i))return r[o+1](i);return r[n-1](i)}}function RIe(t,e){const n=t.args.length,r=new Array(n);for(let i=0;i<n;++i)r[i]=vh(t.args[i]);return i=>{const s=r[0](i),o=r[1](i);let a,l;for(let c=2;c<n;c+=2){const u=r[c](i);let h=r[c+1](i);const f=Array.isArray(h);if(f&&(h=oAe(h)),u>=o)return c===2?h:f?NIe(s,o,a,l,u,h):iS(s,o,a,l,u,h);a=u,l=h}return l}}function MIe(t,e){const n=t.operator,r=t.args.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=vh(t.args[s]);switch(n){case Te.ToString:return s=>{const o=i[0](s);return t.args[0].type===Ei?fG(o):o.toString()};default:throw new Error(`Unsupported convert operator ${n}`)}}function iS(t,e,n,r,i,s){const o=i-n;if(o===0)return r;const a=e-n,l=t===1?a/o:(Math.pow(t,a)-1)/(Math.pow(t,o)-1);return r+l*(s-r)}function NIe(t,e,n,r,i,s){if(i-n===0)return r;const a=TX(r),l=TX(s);let c=l[2]-a[2];c>180?c-=360:c<-180&&(c+=360);const u=[iS(t,e,n,a[0],i,l[0]),iS(t,e,n,a[1],i,l[1]),a[2]+iS(t,e,n,0,i,c),iS(t,e,n,r[3],i,s[3])];return aAe(u)}function OIe(t){return!0}function LIe(t){const e=bG(),n=DIe(t,e),r=$le();return function(i,s){if(r.properties=i.getPropertiesInternal(),r.resolution=s,e.featureId){const o=i.getId();o!==void 0?r.featureId=o:r.featureId=null}return e.geometryType&&(r.geometryType=EG(i.getGeometry())),n(r)}}function KX(t){const e=bG(),n=t.length,r=new Array(n);for(let o=0;o<n;++o)r[o]=UF(t[o],e);const i=$le(),s=new Array(n);return function(o,a){if(i.properties=o.getPropertiesInternal(),i.resolution=a,e.featureId){const c=o.getId();c!==void 0?i.featureId=c:i.featureId=null}let l=0;for(let c=0;c<n;++c){const u=r[c](i);u&&(s[l]=u,l+=1)}return s.length=l,s}}function DIe(t,e){const n=t.length,r=new Array(n);for(let i=0;i<n;++i){const s=t[i],o="filter"in s?Ep(s.filter,Is,e):OIe;let a;if(Array.isArray(s.style)){const l=s.style.length;a=new Array(l);for(let c=0;c<l;++c)a[c]=UF(s.style[c],e)}else a=[UF(s.style,e)];r[i]={filter:o,styles:a}}return function(i){const s=[];let o=!1;for(let a=0;a<n;++a){const l=r[a].filter;if(l(i)&&!(t[a].else&&o)){o=!0;for(const c of r[a].styles){const u=c(i);u&&s.push(u)}}}return s}}function UF(t,e){const n=vk(t,"",e),r=_k(t,"",e),i=jIe(t,e),s=$Ie(t,e),o=yl(t,"z-index",e);if(!n&&!r&&!i&&!s&&!v1(t))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(t));const a=new vn;return function(l){let c=!0;if(n){const u=n(l);u&&(c=!1),a.setFill(u)}if(r){const u=r(l);u&&(c=!1),a.setStroke(u)}if(i){const u=i(l);u&&(c=!1),a.setText(u)}if(s){const u=s(l);u&&(c=!1),a.setImage(u)}return o&&a.setZIndex(o(l)),c?null:a}}function vk(t,e,n){let r;if(e+"fill-pattern-src"in t)r=GIe(t,e+"fill-",n);else{if(t[e+"fill-color"]==="none")return s=>null;r=SG(t,e+"fill-color",n)}if(!r)return null;const i=new Dn;return function(s){const o=r(s);return o===hG?null:(i.setColor(o),i)}}function _k(t,e,n){const r=yl(t,e+"stroke-width",n),i=SG(t,e+"stroke-color",n);if(!r&&!i)return null;const s=jf(t,e+"stroke-line-cap",n),o=jf(t,e+"stroke-line-join",n),a=Fle(t,e+"stroke-line-dash",n),l=yl(t,e+"stroke-line-dash-offset",n),c=yl(t,e+"stroke-miter-limit",n),u=new Pn;return function(h){if(i){const f=i(h);if(f===hG)return null;u.setColor(f)}if(r&&u.setWidth(r(h)),s){const f=s(h);if(f!=="butt"&&f!=="round"&&f!=="square")throw new Error("Expected butt, round, or square line cap");u.setLineCap(f)}if(o){const f=o(h);if(f!=="bevel"&&f!=="round"&&f!=="miter")throw new Error("Expected bevel, round, or miter line join");u.setLineJoin(f)}return a&&u.setLineDash(a(h)),l&&u.setLineDashOffset(l(h)),c&&u.setMiterLimit(c(h)),u}}function jIe(t,e){const n="text-",r=jf(t,n+"value",e);if(!r)return null;const i=vk(t,n,e),s=vk(t,n+"background-",e),o=_k(t,n,e),a=_k(t,n+"background-",e),l=jf(t,n+"font",e),c=yl(t,n+"max-angle",e),u=yl(t,n+"offset-x",e),h=yl(t,n+"offset-y",e),f=Kx(t,n+"overflow",e),g=jf(t,n+"placement",e),y=yl(t,n+"repeat",e),_=R5(t,n+"scale",e),b=Kx(t,n+"rotate-with-view",e),T=yl(t,n+"rotation",e),A=jf(t,n+"align",e),I=jf(t,n+"justify",e),P=jf(t,n+"baseline",e),R=Kx(t,n+"keep-upright",e),D=Fle(t,n+"padding",e),C=M5(t,n+"declutter-mode"),M=new fc({declutterMode:C});return function(O){if(M.setText(r(O)),i&&M.setFill(i(O)),s&&M.setBackgroundFill(s(O)),o&&M.setStroke(o(O)),a&&M.setBackgroundStroke(a(O)),l&&M.setFont(l(O)),c&&M.setMaxAngle(c(O)),u&&M.setOffsetX(u(O)),h&&M.setOffsetY(h(O)),f&&M.setOverflow(f(O)),g){const j=g(O);if(j!=="point"&&j!=="line")throw new Error("Expected point or line for text-placement");M.setPlacement(j)}if(y&&M.setRepeat(y(O)),_&&M.setScale(_(O)),b&&M.setRotateWithView(b(O)),T&&M.setRotation(T(O)),A){const j=A(O);if(j!=="left"&&j!=="center"&&j!=="right"&&j!=="end"&&j!=="start")throw new Error("Expected left, right, center, start, or end for text-align");M.setTextAlign(j)}if(I){const j=I(O);if(j!=="left"&&j!=="right"&&j!=="center")throw new Error("Expected left, right, or center for text-justify");M.setJustify(j)}if(P){const j=P(O);if(j!=="bottom"&&j!=="top"&&j!=="middle"&&j!=="alphabetic"&&j!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");M.setTextBaseline(j)}return D&&M.setPadding(D(O)),R&&M.setKeepUpright(R(O)),M}}function $Ie(t,e){return"icon-src"in t?FIe(t,e):"shape-points"in t?VIe(t,e):"circle-radius"in t?zIe(t,e):null}function FIe(t,e){const n="icon-",r=n+"src",i=Vle(t[r],r),s=G3(t,n+"anchor",e),o=R5(t,n+"scale",e),a=yl(t,n+"opacity",e),l=G3(t,n+"displacement",e),c=yl(t,n+"rotation",e),u=Kx(t,n+"rotate-with-view",e),h=XX(t,n+"anchor-origin"),f=ZX(t,n+"anchor-x-units"),g=ZX(t,n+"anchor-y-units"),y=HIe(t,n+"color"),_=BIe(t,n+"cross-origin"),b=WIe(t,n+"offset"),T=XX(t,n+"offset-origin"),A=U3(t,n+"width"),I=U3(t,n+"height"),P=UIe(t,n+"size"),R=M5(t,n+"declutter-mode"),D=new BA({src:i,anchorOrigin:h,anchorXUnits:f,anchorYUnits:g,color:y,crossOrigin:_,offset:b,offsetOrigin:T,height:I,width:A,size:P,declutterMode:R});return function(C){return a&&D.setOpacity(a(C)),l&&D.setDisplacement(l(C)),c&&D.setRotation(c(C)),u&&D.setRotateWithView(u(C)),o&&D.setScale(o(C)),s&&D.setAnchor(s(C)),D}}function VIe(t,e){const n="shape-",r=n+"points",i=n+"radius",s=BF(t[r],r),o=BF(t[i],i),a=vk(t,n,e),l=_k(t,n,e),c=R5(t,n+"scale",e),u=G3(t,n+"displacement",e),h=yl(t,n+"rotation",e),f=Kx(t,n+"rotate-with-view",e),g=U3(t,n+"radius2"),y=U3(t,n+"angle"),_=M5(t,n+"declutter-mode"),b=new C5({points:s,radius:o,radius2:g,angle:y,declutterMode:_});return function(T){return a&&b.setFill(a(T)),l&&b.setStroke(l(T)),u&&b.setDisplacement(u(T)),h&&b.setRotation(h(T)),f&&b.setRotateWithView(f(T)),c&&b.setScale(c(T)),b}}function zIe(t,e){const n="circle-",r=vk(t,n,e),i=_k(t,n,e),s=yl(t,n+"radius",e),o=R5(t,n+"scale",e),a=G3(t,n+"displacement",e),l=yl(t,n+"rotation",e),c=Kx(t,n+"rotate-with-view",e),u=M5(t,n+"declutter-mode"),h=new ms({radius:5,declutterMode:u});return function(f){return s&&h.setRadius(s(f)),r&&h.setFill(r(f)),i&&h.setStroke(i(f)),a&&h.setDisplacement(a(f)),l&&h.setRotation(l(f)),c&&h.setRotateWithView(c(f)),o&&h.setScale(o(f)),h}}function yl(t,e,n){if(!(e in t))return;const r=Ep(t[e],Wt,n);return function(i){return BF(r(i),e)}}function jf(t,e,n){if(!(e in t))return null;const r=Ep(t[e],Us,n);return function(i){return Vle(r(i),e)}}function GIe(t,e,n){const r=jf(t,e+"pattern-src",n),i=YX(t,e+"pattern-offset",n),s=YX(t,e+"pattern-size",n),o=SG(t,e+"color",n);return function(a){return{src:r(a),offset:i&&i(a),size:s&&s(a),color:o&&o(a)}}}function Kx(t,e,n){if(!(e in t))return null;const r=Ep(t[e],Is,n);return function(i){const s=r(i);if(typeof s!="boolean")throw new Error(`Expected a boolean for ${e}`);return s}}function SG(t,e,n){if(!(e in t))return null;const r=Ep(t[e],Ei,n);return function(i){return zle(r(i),e)}}function Fle(t,e,n){if(!(e in t))return null;const r=Ep(t[e],Al,n);return function(i){return WA(r(i),e)}}function G3(t,e,n){if(!(e in t))return null;const r=Ep(t[e],Al,n);return function(i){const s=WA(r(i),e);if(s.length!==2)throw new Error(`Expected two numbers for ${e}`);return s}}function YX(t,e,n){if(!(e in t))return null;const r=Ep(t[e],Al,n);return function(i){return Gle(r(i),e)}}function R5(t,e,n){if(!(e in t))return null;const r=Ep(t[e],Al|Wt,n);return function(i){return qIe(r(i),e)}}function U3(t,e){const n=t[e];if(n!==void 0){if(typeof n!="number")throw new Error(`Expected a number for ${e}`);return n}}function UIe(t,e){const n=t[e];if(n!==void 0){if(typeof n=="number")return ja(n);if(!Array.isArray(n))throw new Error(`Expected a number or size array for ${e}`);if(n.length!==2||typeof n[0]!="number"||typeof n[1]!="number")throw new Error(`Expected a number or size array for ${e}`);return n}}function BIe(t,e){const n=t[e];if(n!==void 0){if(typeof n!="string")throw new Error(`Expected a string for ${e}`);return n}}function XX(t,e){const n=t[e];if(n!==void 0){if(n!=="bottom-left"&&n!=="bottom-right"&&n!=="top-left"&&n!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${e}`);return n}}function ZX(t,e){const n=t[e];if(n!==void 0){if(n!=="pixels"&&n!=="fraction")throw new Error(`Expected pixels or fraction for ${e}`);return n}}function WIe(t,e){const n=t[e];if(n!==void 0)return WA(n,e)}function M5(t,e){const n=t[e];if(n!==void 0){if(typeof n!="string")throw new Error(`Expected a string for ${e}`);if(n!=="declutter"&&n!=="obstacle"&&n!=="none")throw new Error(`Expected declutter, obstacle, or none for ${e}`);return n}}function HIe(t,e){const n=t[e];if(n!==void 0)return zle(n,e)}function WA(t,e){if(!Array.isArray(t))throw new Error(`Expected an array for ${e}`);const n=t.length;for(let r=0;r<n;++r)if(typeof t[r]!="number")throw new Error(`Expected an array of numbers for ${e}`);return t}function Vle(t,e){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);return t}function BF(t,e){if(typeof t!="number")throw new Error(`Expected a number for ${e}`);return t}function zle(t,e){if(typeof t=="string")return t;const n=WA(t,e),r=n.length;if(r<3||r>4)throw new Error(`Expected a color with 3 or 4 values for ${e}`);return n}function Gle(t,e){const n=WA(t,e);if(n.length!==2)throw new Error(`Expected an array of two numbers for ${e}`);return n}function qIe(t,e){return typeof t=="number"?t:Gle(t,e)}const Nu={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function JX(t,e,n){return(function(r,i,s,o,a){if(!r)return;if(!i&&!e)return r;const l=e?0:s[0]*i,c=e?0:s[1]*i,u=a?a[0]:0,h=a?a[1]:0;let f=t[0]+l/2+u,g=t[2]-l/2+u,y=t[1]+c/2+h,_=t[3]-c/2+h;f>g&&(f=(g+f)/2,g=f),y>_&&(y=(_+y)/2,_=y);let b=ri(r[0],f,g),T=ri(r[1],y,_);if(o&&n&&i){const A=30*i;b+=-A*Math.log(1+Math.max(0,f-r[0])/A)+A*Math.log(1+Math.max(0,r[0]-g)/A),T+=-A*Math.log(1+Math.max(0,y-r[1])/A)+A*Math.log(1+Math.max(0,r[1]-_)/A)}return[b,T]})}function KIe(t){return t}function Ule(t){return Math.pow(t,3)}function Y2(t){return 1-Ule(1-t)}function YIe(t){return 3*t*t-2*t*t*t}function XIe(t){return t}function TG(t,e,n,r){const i=Xn(e)/n[0],s=Ps(e)/n[1];return r?Math.min(t,Math.max(i,s)):Math.min(t,Math.min(i,s))}function kG(t,e,n){let r=Math.min(t,e);const i=50;return r*=Math.log(1+i*Math.max(0,t/e-1))/i+1,n&&(r=Math.max(r,n),r/=Math.log(1+i*Math.max(0,n/t-1))/i+1),ri(r,n/2,e*2)}function ZIe(t,e,n,r){return e=e!==void 0?e:!0,(function(i,s,o,a){if(i!==void 0){const l=t[0],c=t[t.length-1],u=n?TG(l,n,o,r):l;if(a)return e?kG(i,u,c):ri(i,c,u);const h=Math.min(u,i),f=Math.floor(v5(t,h,s));return t[f]>u&&f<t.length-1?t[f+1]:t[f]}})}function JIe(t,e,n,r,i,s){return r=r!==void 0?r:!0,n=n!==void 0?n:0,(function(o,a,l,c){if(o!==void 0){const u=i?TG(e,i,l,s):e;if(c)return r?kG(o,u,n):ri(o,n,u);const h=1e-9,f=Math.ceil(Math.log(e/u)/Math.log(t)-h),g=-a*(.5-h)+.5,y=Math.min(u,o),_=Math.floor(Math.log(e/y)/Math.log(t)+g),b=Math.max(f,_),T=e/Math.pow(t,b);return ri(T,n,u)}})}function QX(t,e,n,r,i){return n=n!==void 0?n:!0,(function(s,o,a,l){if(s!==void 0){const c=r?TG(t,r,a,i):t;return!n||!l?ri(s,e,c):kG(s,c,e)}})}function AG(t){if(t!==void 0)return 0}function eZ(t){if(t!==void 0)return t}function QIe(t){const e=2*Math.PI/t;return(function(n,r){if(r)return n;if(n!==void 0)return n=Math.floor(n/e+.5)*e,n})}function ePe(t){const e=au(5);return(function(n,r){return r||n===void 0?n:Math.abs(n)<=e?0:n})}const tPe=42,IG=256,R6=0;class hd extends Gd{constructor(e){super(),this.on,this.once,this.un,e=Object.assign({},e),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=Qz(e.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,e.projection&&Yae(),e.center&&(e.center=Li(e.center,this.projection_)),e.extent&&(e.extent=sh(e.extent,this.projection_)),this.applyOptions_(e)}applyOptions_(e){const n=Object.assign({},e);for(const a in Nu)delete n[a];this.setProperties(n,!0);const r=rPe(e);this.maxResolution_=r.maxResolution,this.minResolution_=r.minResolution,this.zoomFactor_=r.zoomFactor,this.resolutions_=e.resolutions,this.padding_=e.padding,this.minZoom_=r.minZoom;const i=nPe(e),s=r.constraint,o=iPe(e);this.constraints_={center:i,resolution:s,rotation:o},this.setRotation(e.rotation!==void 0?e.rotation:0),this.setCenterInternal(e.center!==void 0?e.center:null),e.resolution!==void 0?this.setResolution(e.resolution):e.zoom!==void 0&&this.setZoom(e.zoom)}get padding(){return this.padding_}set padding(e){let n=this.padding_;this.padding_=e;const r=this.getCenterInternal();if(r){const i=e||[0,0,0,0];n=n||[0,0,0,0];const s=this.getResolution(),o=s/2*(i[3]-n[3]+n[1]-i[1]),a=s/2*(i[0]-n[0]+n[2]-i[2]);this.setCenterInternal([r[0]+o,r[1]-a])}}getUpdatedOptions_(e){const n=this.getProperties();return n.resolution!==void 0?n.resolution=this.getResolution():n.zoom=this.getZoom(),n.center=this.getCenterInternal(),n.rotation=this.getRotation(),Object.assign({},n,e)}animate(e){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const n=new Array(arguments.length);for(let r=0;r<n.length;++r){let i=arguments[r];i.center&&(i=Object.assign({},i),i.center=Li(i.center,this.getProjection())),i.anchor&&(i=Object.assign({},i),i.anchor=Li(i.anchor,this.getProjection())),n[r]=i}this.animateInternal.apply(this,n)}animateInternal(e){let n=arguments.length,r;n>1&&typeof arguments[n-1]=="function"&&(r=arguments[n-1],--n);let i=0;for(;i<n&&!this.isDef();++i){const u=arguments[i];u.center&&this.setCenterInternal(u.center),u.zoom!==void 0?this.setZoom(u.zoom):u.resolution&&this.setResolution(u.resolution),u.rotation!==void 0&&this.setRotation(u.rotation)}if(i===n){r&&gC(r,!0);return}let s=Date.now(),o=this.targetCenter_.slice(),a=this.targetResolution_,l=this.targetRotation_;const c=[];for(;i<n;++i){const u=arguments[i],h={start:s,complete:!1,anchor:u.anchor,duration:u.duration!==void 0?u.duration:1e3,easing:u.easing||YIe,callback:r};if(u.center&&(h.sourceCenter=o,h.targetCenter=u.center.slice(),o=h.targetCenter),u.zoom!==void 0?(h.sourceResolution=a,h.targetResolution=this.getResolutionForZoom(u.zoom),a=h.targetResolution):u.resolution&&(h.sourceResolution=a,h.targetResolution=u.resolution,a=h.targetResolution),u.rotation!==void 0){h.sourceRotation=l;const f=fg(u.rotation-l+Math.PI,2*Math.PI)-Math.PI;h.targetRotation=l+f,l=h.targetRotation}sPe(h)?h.complete=!0:s+=h.duration,c.push(h)}this.animations_.push(c),this.setHint(Ts.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[Ts.ANIMATING]>0}getInteracting(){return this.hints_[Ts.INTERACTING]>0}cancelAnimations(){this.setHint(Ts.ANIMATING,-this.hints_[Ts.ANIMATING]);let e;for(let n=0,r=this.animations_.length;n<r;++n){const i=this.animations_[n];if(i[0].callback&&gC(i[0].callback,!1),!e)for(let s=0,o=i.length;s<o;++s){const a=i[s];if(!a.complete){e=a.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=e,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const e=Date.now();let n=!1;for(let r=this.animations_.length-1;r>=0;--r){const i=this.animations_[r];let s=!0;for(let o=0,a=i.length;o<a;++o){const l=i[o];if(l.complete)continue;const c=e-l.start;let u=l.duration>0?c/l.duration:1;u>=1?(l.complete=!0,u=1):s=!1;const h=l.easing(u);if(l.sourceCenter){const f=l.sourceCenter[0],g=l.sourceCenter[1],y=l.targetCenter[0],_=l.targetCenter[1];this.nextCenter_=l.targetCenter;const b=f+h*(y-f),T=g+h*(_-g);this.targetCenter_=[b,T]}if(l.sourceResolution&&l.targetResolution){const f=h===1?l.targetResolution:l.sourceResolution+h*(l.targetResolution-l.sourceResolution);if(l.anchor){const g=this.getViewportSize_(this.getRotation()),y=this.constraints_.resolution(f,0,g,!0);this.targetCenter_=this.calculateCenterZoom(y,l.anchor)}this.nextResolution_=l.targetResolution,this.targetResolution_=f,this.applyTargetState_(!0)}if(l.sourceRotation!==void 0&&l.targetRotation!==void 0){const f=h===1?fg(l.targetRotation+Math.PI,2*Math.PI)-Math.PI:l.sourceRotation+h*(l.targetRotation-l.sourceRotation);if(l.anchor){const g=this.constraints_.rotation(f,!0);this.targetCenter_=this.calculateCenterRotate(g,l.anchor)}this.nextRotation_=l.targetRotation,this.targetRotation_=f}if(this.applyTargetState_(!0),n=!0,!l.complete)break}if(s){this.animations_[r]=null,this.setHint(Ts.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const o=i[0].callback;o&&gC(o,!0)}}this.animations_=this.animations_.filter(Boolean),n&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(e,n){let r;const i=this.getCenterInternal();return i!==void 0&&(r=[i[0]-n[0],i[1]-n[1]],Kz(r,e-this.getRotation()),ZTe(r,n)),r}calculateCenterZoom(e,n){let r;const i=this.getCenterInternal(),s=this.getResolution();if(i!==void 0&&s!==void 0){const o=n[0]-e*(n[0]-i[0])/s,a=n[1]-e*(n[1]-i[1])/s;r=[o,a]}return r}getViewportSize_(e){const n=this.viewportSize_;if(e){const r=n[0],i=n[1];return[Math.abs(r*Math.cos(e))+Math.abs(i*Math.sin(e)),Math.abs(r*Math.sin(e))+Math.abs(i*Math.cos(e))]}return n}setViewportSize(e){this.viewportSize_=Array.isArray(e)?e.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const e=this.getCenterInternal();return e&&b1(e,this.getProjection())}getCenterInternal(){return this.get(Nu.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(e){return e!==void 0?(e[0]=this.hints_[0],e[1]=this.hints_[1],e):this.hints_.slice()}calculateExtent(e){const n=this.calculateExtentInternal(e);return tG(n,this.getProjection())}calculateExtentInternal(e){e=e||this.getViewportSizeMinusPadding_();const n=this.getCenterInternal();ur(n,"The view center is not defined");const r=this.getResolution();ur(r!==void 0,"The view resolution is not defined");const i=this.getRotation();return ur(i!==void 0,"The view rotation is not defined"),P3(n,r,i,e)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(e){this.applyOptions_(this.getUpdatedOptions_({maxZoom:e}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(e){this.applyOptions_(this.getUpdatedOptions_({minZoom:e}))}setConstrainResolution(e){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:e}))}getProjection(){return this.projection_}getResolution(){return this.get(Nu.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(e,n){return this.getResolutionForExtentInternal(sh(e,this.getProjection()),n)}getResolutionForExtentInternal(e,n){n=n||this.getViewportSizeMinusPadding_();const r=Xn(e)/n[0],i=Ps(e)/n[1];return Math.max(r,i)}getResolutionForValueFunction(e){e=e||2;const n=this.getConstrainedResolution(this.maxResolution_),r=this.minResolution_,i=Math.log(n/r)/Math.log(e);return(function(s){return n/Math.pow(e,s*i)})}getRotation(){return this.get(Nu.ROTATION)}getValueForResolutionFunction(e){const n=Math.log(e||2),r=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,s=Math.log(r/i)/n;return(function(o){return Math.log(r/o)/n/s})}getViewportSizeMinusPadding_(e){let n=this.getViewportSize_(e);const r=this.padding_;return r&&(n=[n[0]-r[1]-r[3],n[1]-r[0]-r[2]]),n}getState(){const e=this.getProjection(),n=this.getResolution(),r=this.getRotation();let i=this.getCenterInternal();const s=this.padding_;if(s){const o=this.getViewportSizeMinusPadding_();i=M6(i,this.getViewportSize_(),[o[0]/2+s[3],o[1]/2+s[0]],n,r)}return{center:i.slice(0),projection:e!==void 0?e:null,resolution:n,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:r,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let e;const n=this.getResolution();return n!==void 0&&(e=this.getZoomForResolution(n)),e}getZoomForResolution(e){let n=this.minZoom_||0,r,i;if(this.resolutions_){const s=v5(this.resolutions_,e,1);n=s,r=this.resolutions_[s],s==this.resolutions_.length-1?i=2:i=r/this.resolutions_[s+1]}else r=this.maxResolution_,i=this.zoomFactor_;return n+Math.log(r/e)/Math.log(i)}getResolutionForZoom(e){if(this.resolutions_?.length){if(this.resolutions_.length===1)return this.resolutions_[0];const n=ri(Math.floor(e),0,this.resolutions_.length-2),r=this.resolutions_[n]/this.resolutions_[n+1];return this.resolutions_[n]/Math.pow(r,ri(e-n,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,e-this.minZoom_)}fit(e,n){let r;if(ur(Array.isArray(e)||typeof e.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(e)){ur(!H2(e),"Cannot fit empty extent provided as `geometry`");const i=sh(e,this.getProjection());r=NX(i)}else if(e.getType()==="Circle"){const i=sh(e.getExtent(),this.getProjection());r=NX(i),r.rotate(this.getRotation(),gh(i))}else r=e;this.fitInternal(r,n)}rotatedExtentForGeometry(e){const n=this.getRotation(),r=Math.cos(n),i=Math.sin(-n),s=e.getFlatCoordinates(),o=e.getStride();let a=1/0,l=1/0,c=-1/0,u=-1/0;for(let h=0,f=s.length;h<f;h+=o){const g=s[h]*r-s[h+1]*i,y=s[h]*i+s[h+1]*r;a=Math.min(a,g),l=Math.min(l,y),c=Math.max(c,g),u=Math.max(u,y)}return[a,l,c,u]}fitInternal(e,n){n=n||{};let r=n.size;r||(r=this.getViewportSizeMinusPadding_());const i=n.padding!==void 0?n.padding:[0,0,0,0],s=n.nearest!==void 0?n.nearest:!1;let o;n.minResolution!==void 0?o=n.minResolution:n.maxZoom!==void 0?o=this.getResolutionForZoom(n.maxZoom):o=0;const a=this.rotatedExtentForGeometry(e);let l=this.getResolutionForExtentInternal(a,[r[0]-i[1]-i[3],r[1]-i[0]-i[2]]);l=isNaN(l)?o:Math.max(l,o),l=this.getConstrainedResolution(l,s?0:1);const c=this.getRotation(),u=Math.sin(c),h=Math.cos(c),f=gh(a);f[0]+=(i[1]-i[3])/2*l,f[1]+=(i[0]-i[2])/2*l;const g=f[0]*h-f[1]*u,y=f[1]*h+f[0]*u,_=this.getConstrainedCenter([g,y],l),b=n.callback?n.callback:lk;n.duration!==void 0?this.animateInternal({resolution:l,center:_,duration:n.duration,easing:n.easing},b):(this.targetResolution_=l,this.targetCenter_=_,this.applyTargetState_(!1,!0),gC(b,!0))}centerOn(e,n,r){this.centerOnInternal(Li(e,this.getProjection()),n,r)}centerOnInternal(e,n,r){this.setCenterInternal(M6(e,n,r,this.getResolution(),this.getRotation()))}calculateCenterShift(e,n,r,i){let s;const o=this.padding_;if(o&&e){const a=this.getViewportSizeMinusPadding_(-r),l=M6(e,i,[a[0]/2+o[3],a[1]/2+o[0]],n,r);s=[e[0]-l[0],e[1]-l[1]]}return s}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(e){const n=b1(this.targetCenter_,this.getProjection());this.setCenter([n[0]+e[0],n[1]+e[1]])}adjustCenterInternal(e){const n=this.targetCenter_;this.setCenterInternal([n[0]+e[0],n[1]+e[1]])}adjustResolution(e,n){n=n&&Li(n,this.getProjection()),this.adjustResolutionInternal(e,n)}adjustResolutionInternal(e,n){const r=this.getAnimating()||this.getInteracting(),i=this.getViewportSize_(this.getRotation()),s=this.constraints_.resolution(this.targetResolution_*e,0,i,r);n&&(this.targetCenter_=this.calculateCenterZoom(s,n)),this.targetResolution_*=e,this.applyTargetState_()}adjustZoom(e,n){this.adjustResolution(Math.pow(this.zoomFactor_,-e),n)}adjustRotation(e,n){n&&(n=Li(n,this.getProjection())),this.adjustRotationInternal(e,n)}adjustRotationInternal(e,n){const r=this.getAnimating()||this.getInteracting(),i=this.constraints_.rotation(this.targetRotation_+e,r);n&&(this.targetCenter_=this.calculateCenterRotate(i,n)),this.targetRotation_+=e,this.applyTargetState_()}setCenter(e){this.setCenterInternal(e&&Li(e,this.getProjection()))}setCenterInternal(e){this.targetCenter_=e,this.applyTargetState_()}setHint(e,n){return this.hints_[e]+=n,this.changed(),this.hints_[e]}setResolution(e){this.targetResolution_=e,this.applyTargetState_()}setRotation(e){this.targetRotation_=e,this.applyTargetState_()}setZoom(e){this.setResolution(this.getResolutionForZoom(e))}applyTargetState_(e,n){const r=this.getAnimating()||this.getInteracting()||n,i=this.constraints_.rotation(this.targetRotation_,r),s=this.getViewportSize_(i),o=this.constraints_.resolution(this.targetResolution_,0,s,r),a=this.constraints_.center(this.targetCenter_,o,s,r,this.calculateCenterShift(this.targetCenter_,o,i,s));this.get(Nu.ROTATION)!==i&&this.set(Nu.ROTATION,i),this.get(Nu.RESOLUTION)!==o&&(this.set(Nu.RESOLUTION,o),this.set("zoom",this.getZoom(),!0)),(!a||!this.get(Nu.CENTER)||!Ia(this.get(Nu.CENTER),a))&&this.set(Nu.CENTER,a),this.getAnimating()&&!e&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(e,n,r){e=e!==void 0?e:200;const i=n||0,s=this.constraints_.rotation(this.targetRotation_),o=this.getViewportSize_(s),a=this.constraints_.resolution(this.targetResolution_,i,o),l=this.constraints_.center(this.targetCenter_,a,o,!1,this.calculateCenterShift(this.targetCenter_,a,s,o));if(e===0&&!this.cancelAnchor_){this.targetResolution_=a,this.targetRotation_=s,this.targetCenter_=l,this.applyTargetState_();return}r=r||(e===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==a||this.getRotation()!==s||!this.getCenterInternal()||!Ia(this.getCenterInternal(),l))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:s,center:l,resolution:a,duration:e,easing:Y2,anchor:r}))}beginInteraction(){this.resolveConstraints(0),this.setHint(Ts.INTERACTING,1)}endInteraction(e,n,r){r=r&&Li(r,this.getProjection()),this.endInteractionInternal(e,n,r)}endInteractionInternal(e,n,r){this.getInteracting()&&(this.setHint(Ts.INTERACTING,-1),this.resolveConstraints(e,n,r))}getConstrainedCenter(e,n){const r=this.getViewportSize_(this.getRotation());return this.constraints_.center(e,n||this.getResolution(),r)}getConstrainedZoom(e,n){const r=this.getResolutionForZoom(e);return this.getZoomForResolution(this.getConstrainedResolution(r,n))}getConstrainedResolution(e,n){n=n||0;const r=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(e,n,r)}}function gC(t,e){setTimeout(function(){t(e)},0)}function nPe(t){if(t.extent!==void 0){const n=t.smoothExtentConstraint!==void 0?t.smoothExtentConstraint:!0;return JX(t.extent,t.constrainOnlyCenter,n)}const e=Qz(t.projection,"EPSG:3857");if(t.multiWorld!==!0&&e.isGlobal()){const n=e.getExtent().slice();return n[0]=-1/0,n[2]=1/0,JX(n,!1,!1)}return KIe}function rPe(t){let e,n,r,o=t.minZoom!==void 0?t.minZoom:R6,a=t.maxZoom!==void 0?t.maxZoom:28;const l=t.zoomFactor!==void 0?t.zoomFactor:2,c=t.multiWorld!==void 0?t.multiWorld:!1,u=t.smoothResolutionConstraint!==void 0?t.smoothResolutionConstraint:!0,h=t.showFullExtent!==void 0?t.showFullExtent:!1,f=Qz(t.projection,"EPSG:3857"),g=f.getExtent();let y=t.constrainOnlyCenter,_=t.extent;if(!c&&!_&&f.isGlobal()&&(y=!1,_=g),t.resolutions!==void 0){const b=t.resolutions;n=b[o],r=b[a]!==void 0?b[a]:b[b.length-1],t.constrainResolution?e=ZIe(b,u,!y&&_,h):e=QX(n,r,u,!y&&_,h)}else{const T=(g?Math.max(Xn(g),Ps(g)):360*Xw.degrees/f.getMetersPerUnit())/IG/Math.pow(2,R6),A=T/Math.pow(2,28-R6);n=t.maxResolution,n!==void 0?o=0:n=T/Math.pow(l,o),r=t.minResolution,r===void 0&&(t.maxZoom!==void 0?t.maxResolution!==void 0?r=n/Math.pow(l,a):r=T/Math.pow(l,a):r=A),a=o+Math.floor(Math.log(n/r)/Math.log(l)),r=n/Math.pow(l,a-o),t.constrainResolution?e=JIe(l,n,r,u,!y&&_,h):e=QX(n,r,u,!y&&_,h)}return{constraint:e,maxResolution:n,minResolution:r,minZoom:o,zoomFactor:l}}function iPe(t){if(t.enableRotation!==void 0?t.enableRotation:!0){const n=t.constrainRotation;return n===void 0||n===!0?ePe():n===!1?eZ:typeof n=="number"?QIe(n):eZ}return AG}function sPe(t){return!(t.sourceCenter&&t.targetCenter&&!Ia(t.sourceCenter,t.targetCenter)||t.sourceResolution!==t.targetResolution||t.sourceRotation!==t.targetRotation)}function M6(t,e,n,r,i){const s=Math.cos(-i);let o=Math.sin(-i),a=t[0]*s-t[1]*o,l=t[1]*s+t[0]*o;a+=(e[0]/2-n[0])*r,l+=(n[1]-e[1]/2)*r,o=-o;const c=a*s-l*o,u=l*s+a*o;return[c,u]}const Tr={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class Ble extends Gd{constructor(e){super(),this.on,this.once,this.un,this.background_=e.background;const n=Object.assign({},e);typeof e.properties=="object"&&(delete n.properties,Object.assign(n,e.properties)),n[Tr.OPACITY]=e.opacity!==void 0?e.opacity:1,ur(typeof n[Tr.OPACITY]=="number","Layer opacity must be a number"),n[Tr.VISIBLE]=e.visible!==void 0?e.visible:!0,n[Tr.Z_INDEX]=e.zIndex,n[Tr.MAX_RESOLUTION]=e.maxResolution!==void 0?e.maxResolution:1/0,n[Tr.MIN_RESOLUTION]=e.minResolution!==void 0?e.minResolution:0,n[Tr.MIN_ZOOM]=e.minZoom!==void 0?e.minZoom:-1/0,n[Tr.MAX_ZOOM]=e.maxZoom!==void 0?e.maxZoom:1/0,this.className_=n.className!==void 0?n.className:"ol-layer",delete n.className,this.setProperties(n),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(e){const n=this.state_||{layer:this,managed:e===void 0?!0:e},r=this.getZIndex();return n.opacity=ri(Math.round(this.getOpacity()*100)/100,0,1),n.visible=this.getVisible(),n.extent=this.getExtent(),n.zIndex=r===void 0&&!n.managed?1/0:r,n.maxResolution=this.getMaxResolution(),n.minResolution=Math.max(this.getMinResolution(),0),n.minZoom=this.getMinZoom(),n.maxZoom=this.getMaxZoom(),this.state_=n,n}getLayersArray(e){return bn()}getLayerStatesArray(e){return bn()}getExtent(){return this.get(Tr.EXTENT)}getMaxResolution(){return this.get(Tr.MAX_RESOLUTION)}getMinResolution(){return this.get(Tr.MIN_RESOLUTION)}getMinZoom(){return this.get(Tr.MIN_ZOOM)}getMaxZoom(){return this.get(Tr.MAX_ZOOM)}getOpacity(){return this.get(Tr.OPACITY)}getSourceState(){return bn()}getVisible(){return this.get(Tr.VISIBLE)}getZIndex(){return this.get(Tr.Z_INDEX)}setBackground(e){this.background_=e,this.changed()}setExtent(e){this.set(Tr.EXTENT,e)}setMaxResolution(e){this.set(Tr.MAX_RESOLUTION,e)}setMinResolution(e){this.set(Tr.MIN_RESOLUTION,e)}setMaxZoom(e){this.set(Tr.MAX_ZOOM,e)}setMinZoom(e){this.set(Tr.MIN_ZOOM,e)}setOpacity(e){ur(typeof e=="number","Layer opacity must be a number"),this.set(Tr.OPACITY,e)}setVisible(e){this.set(Tr.VISIBLE,e)}setZIndex(e){this.set(Tr.Z_INDEX,e)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}class HA extends Ble{constructor(e){const n=Object.assign({},e);delete n.source,super(n),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,e.render&&(this.render=e.render),e.map&&this.setMap(e.map),this.addChangeListener(Tr.SOURCE,this.handleSourcePropertyChange_);const r=e.source?e.source:null;this.setSource(r)}getLayersArray(e){return e=e||[],e.push(this),e}getLayerStatesArray(e){return e=e||[],e.push(this.getLayerState()),e}getSource(){return this.get(Tr.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const e=this.getSource();return e?e.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(ni(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const e=this.getSource();e&&(this.sourceChangeKey_=Yn(e,wn.CHANGE,this.handleSourceChange_,this),e.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(e){return this.renderer_?this.renderer_.getFeatures(e):Promise.resolve([])}getData(e){return!this.renderer_||!this.rendered?null:this.renderer_.getData(e)}isVisible(e){let n;const r=this.getMapInternal();!e&&r&&(e=r.getView()),e instanceof hd?n={viewState:e.getState(),extent:e.calculateExtent()}:n=e,!n.layerStatesArray&&r&&(n.layerStatesArray=r.getLayerGroup().getLayerStatesArray());let i;if(n.layerStatesArray){if(i=n.layerStatesArray.find(o=>o.layer===this),!i)return!1}else i=this.getLayerState();const s=this.getExtent();return PG(i,n.viewState)&&(!s||oa(s,n.extent))}getAttributions(e){if(!this.isVisible(e))return[];const n=this.getSource()?.getAttributions();if(!n)return[];const r=e instanceof hd?e.getViewStateAndExtent():e;let i=n(r);return Array.isArray(i)||(i=[i]),i}render(e,n){const r=this.getRenderer();return r.prepareFrame(e)?(this.rendered=!0,r.renderFrame(e,n)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(e,n){}renderDeferred(e){const n=this.getRenderer();n&&n.renderDeferred(e)}setMapInternal(e){e||this.unrender(),this.set(Tr.MAP,e)}getMapInternal(){return this.get(Tr.MAP)}setMap(e){this.mapPrecomposeKey_&&(ni(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),e||this.changed(),this.mapRenderKey_&&(ni(this.mapRenderKey_),this.mapRenderKey_=null),e&&(this.mapPrecomposeKey_=Yn(e,co.PRECOMPOSE,this.handlePrecompose_,this),this.mapRenderKey_=Yn(this,wn.CHANGE,e.render,e),this.changed())}handlePrecompose_(e){const n=e.frameState.layerStatesArray,r=this.getLayerState(!1);ur(!n.some(i=>i.layer===r.layer),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),n.push(r)}setSource(e){this.set(Tr.SOURCE,e)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}clearRenderer(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_)}disposeInternal(){this.clearRenderer(),this.setSource(null),super.disposeInternal()}}function PG(t,e){if(!t.visible)return!1;const n=e.resolution;if(n<t.minResolution||n>=t.maxResolution)return!1;const r=e.zoom;return r>t.minZoom&&r<=t.maxZoom}const tZ={RENDER_ORDER:"renderOrder"};class N5 extends HA{constructor(e){e=e||{};const n=Object.assign({},e);delete n.style,delete n.renderBuffer,delete n.updateWhileAnimating,delete n.updateWhileInteracting,super(n),this.declutter_=e.declutter?String(e.declutter):void 0,this.renderBuffer_=e.renderBuffer!==void 0?e.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(e.style),this.updateWhileAnimating_=e.updateWhileAnimating!==void 0?e.updateWhileAnimating:!1,this.updateWhileInteracting_=e.updateWhileInteracting!==void 0?e.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(e){return super.getFeatures(e)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(tZ.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(e,n){const r=this.getDeclutter();r in e.declutter||(e.declutter[r]=new Rle(9)),this.getRenderer().renderDeclutter(e,n)}setRenderOrder(e){this.set(tZ.RENDER_ORDER,e)}setStyle(e){this.style_=e===void 0?Mle:e;const n=oPe(e);this.styleFunction_=e===null?void 0:BAe(n),this.changed()}setDeclutter(e){this.declutter_=e?String(e):void 0,this.changed()}}function oPe(t){if(t===void 0)return Mle;if(!t)return null;if(typeof t=="function"||t instanceof vn)return t;if(!Array.isArray(t))return KX([t]);if(t.length===0)return[];const e=t.length,n=t[0];if(n instanceof vn){const i=new Array(e);for(let s=0;s<e;++s){const o=t[s];if(!(o instanceof vn))throw new Error("Expected a list of style instances");i[s]=o}return i}if("style"in n){const i=new Array(e);for(let s=0;s<e;++s){const o=t[s];if(!("style"in o))throw new Error("Expected a list of rules with a style property");i[s]=o}return LIe(i)}return KX(t)}class Nl extends N5{constructor(e){super(e)}createRenderer(){return new uIe(this)}}const tm={ADDLAYER:"addlayer",REMOVELAYER:"removelayer"};class Mm extends Sc{constructor(e,n){super(e),this.layer=n}}const N6={LAYERS:"layers"};let O5=class Wle extends Ble{constructor(e){e=e||{};const n=Object.assign({},e);delete n.layers;let r=e.layers;super(n),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(N6.LAYERS,this.handleLayersChanged_),r?Array.isArray(r)?r=new Da(r.slice(),{unique:!0}):ur(typeof r.getArray=="function","Expected `layers` to be an array or a `Collection`"):r=new Da(void 0,{unique:!0}),this.setLayers(r)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(ni),this.layersListenerKeys_.length=0;const e=this.getLayers();this.layersListenerKeys_.push(Yn(e,As.ADD,this.handleLayersAdd_,this),Yn(e,As.REMOVE,this.handleLayersRemove_,this));for(const r in this.listenerKeys_)this.listenerKeys_[r].forEach(ni);nv(this.listenerKeys_);const n=e.getArray();for(let r=0,i=n.length;r<i;r++){const s=n[r];this.registerLayerListeners_(s),this.dispatchEvent(new Mm(tm.ADDLAYER,s))}this.changed()}registerLayerListeners_(e){const n=[Yn(e,Kw.PROPERTYCHANGE,this.handleLayerChange_,this),Yn(e,wn.CHANGE,this.handleLayerChange_,this)];e instanceof Wle&&n.push(Yn(e,tm.ADDLAYER,this.handleLayerGroupAdd_,this),Yn(e,tm.REMOVELAYER,this.handleLayerGroupRemove_,this)),this.listenerKeys_[Qt(e)]=n}handleLayerGroupAdd_(e){this.dispatchEvent(new Mm(tm.ADDLAYER,e.layer))}handleLayerGroupRemove_(e){this.dispatchEvent(new Mm(tm.REMOVELAYER,e.layer))}handleLayersAdd_(e){const n=e.element;this.registerLayerListeners_(n),this.dispatchEvent(new Mm(tm.ADDLAYER,n)),this.changed()}handleLayersRemove_(e){const n=e.element,r=Qt(n);this.listenerKeys_[r].forEach(ni),delete this.listenerKeys_[r],this.dispatchEvent(new Mm(tm.REMOVELAYER,n)),this.changed()}getLayers(){return this.get(N6.LAYERS)}setLayers(e){const n=this.getLayers();if(n){const r=n.getArray();for(let i=0,s=r.length;i<s;++i)this.dispatchEvent(new Mm(tm.REMOVELAYER,r[i]))}this.set(N6.LAYERS,e)}getLayersArray(e){return e=e!==void 0?e:[],this.getLayers().forEach(function(n){n.getLayersArray(e)}),e}getLayerStatesArray(e){const n=e!==void 0?e:[],r=n.length;this.getLayers().forEach(function(o){o.getLayerStatesArray(n)});const i=this.getLayerState();let s=i.zIndex;!e&&i.zIndex===void 0&&(s=0);for(let o=r,a=n.length;o<a;o++){const l=n[o];l.opacity*=i.opacity,l.visible=l.visible&&i.visible,l.maxResolution=Math.min(l.maxResolution,i.maxResolution),l.minResolution=Math.max(l.minResolution,i.minResolution),l.minZoom=Math.max(l.minZoom,i.minZoom),l.maxZoom=Math.min(l.maxZoom,i.maxZoom),i.extent!==void 0&&(l.extent!==void 0?l.extent=Jf(l.extent,i.extent):l.extent=i.extent),l.zIndex===void 0&&(l.zIndex=s)}return n}getSourceState(){return"ready"}};const cn={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function Hle(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function WF(t,e){return t[0]=e[0],t[1]=e[1],t[4]=e[2],t[5]=e[3],t[12]=e[4],t[13]=e[5],t}const B3=34962,CG=34963,aPe=35044,O6=35048,lPe=5121,cPe=5123,uPe=5125,qle=5126,nZ=["experimental-webgl","webgl","webkit-3d","moz-webgl"];function hPe(t,e){e=Object.assign({preserveDrawingBuffer:!0,antialias:!Kke},e);const n=nZ.length;for(let r=0;r<n;++r)try{const i=t.getContext(nZ[r],e);if(i)return i}catch{}return null}const dPe={STATIC_DRAW:aPe};class L6{constructor(e,n){this.array_=null,this.type_=e,ur(e===B3||e===CG,"A `WebGLArrayBuffer` must either be of type `ELEMENT_ARRAY_BUFFER` or `ARRAY_BUFFER`"),this.usage_=n!==void 0?n:dPe.STATIC_DRAW}ofSize(e){return this.array_=new(yC(this.type_))(e),this}fromArray(e){return this.array_=yC(this.type_).from(e),this}fromArrayBuffer(e){return this.array_=new(yC(this.type_))(e),this}getType(){return this.type_}getArray(){return this.array_}setArray(e){const n=yC(this.type_);if(!(e instanceof n))throw new Error(`Expected ${n}`);this.array_=e}getUsage(){return this.usage_}getSize(){return this.array_?this.array_.length:0}}function yC(t){switch(t){case B3:return Float32Array;case CG:return Uint32Array;default:return Float32Array}}const vC={LOST:"webglcontextlost",RESTORED:"webglcontextrestored"},fPe=`
  precision mediump float;

  attribute vec2 a_position;
  varying vec2 v_texCoord;
  varying vec2 v_screenCoord;

  uniform vec2 u_screenSize;

  void main() {
    v_texCoord = a_position * 0.5 + 0.5;
    v_screenCoord = v_texCoord * u_screenSize;
    gl_Position = vec4(a_position, 0.0, 1.0);
  }
`,pPe=`
  precision mediump float;

  uniform sampler2D u_image;
  uniform float u_opacity;

  varying vec2 v_texCoord;

  void main() {
    gl_FragColor = texture2D(u_image, v_texCoord) * u_opacity;
  }
`;class rZ{constructor(e){this.gl_=e.webGlContext;const n=this.gl_;this.scaleRatio_=e.scaleRatio||1,this.renderTargetTexture_=n.createTexture(),this.renderTargetTextureSize_=null,this.frameBuffer_=n.createFramebuffer(),this.depthBuffer_=n.createRenderbuffer();const r=n.createShader(n.VERTEX_SHADER);n.shaderSource(r,e.vertexShader||fPe),n.compileShader(r);const i=n.createShader(n.FRAGMENT_SHADER);n.shaderSource(i,e.fragmentShader||pPe),n.compileShader(i),this.renderTargetProgram_=n.createProgram(),n.attachShader(this.renderTargetProgram_,r),n.attachShader(this.renderTargetProgram_,i),n.linkProgram(this.renderTargetProgram_),this.renderTargetVerticesBuffer_=n.createBuffer();const s=[-1,-1,1,-1,-1,1,1,-1,1,1,-1,1];n.bindBuffer(n.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),n.bufferData(n.ARRAY_BUFFER,new Float32Array(s),n.STATIC_DRAW),this.renderTargetAttribLocation_=n.getAttribLocation(this.renderTargetProgram_,"a_position"),this.renderTargetUniformLocation_=n.getUniformLocation(this.renderTargetProgram_,"u_screenSize"),this.renderTargetOpacityLocation_=n.getUniformLocation(this.renderTargetProgram_,"u_opacity"),this.renderTargetTextureLocation_=n.getUniformLocation(this.renderTargetProgram_,"u_image"),this.uniforms_=[],e.uniforms&&Object.keys(e.uniforms).forEach(o=>{this.uniforms_.push({value:e.uniforms[o],location:n.getUniformLocation(this.renderTargetProgram_,o)})})}getRenderTargetTexture(){return this.renderTargetTexture_}getGL(){return this.gl_}init(e){const n=this.getGL(),r=[n.drawingBufferWidth*this.scaleRatio_,n.drawingBufferHeight*this.scaleRatio_];if(n.bindFramebuffer(n.FRAMEBUFFER,this.getFrameBuffer()),n.bindRenderbuffer(n.RENDERBUFFER,this.getDepthBuffer()),n.viewport(0,0,r[0],r[1]),!this.renderTargetTextureSize_||this.renderTargetTextureSize_[0]!==r[0]||this.renderTargetTextureSize_[1]!==r[1]){this.renderTargetTextureSize_=r;const i=0,s=n.RGBA,o=0,a=n.RGBA,l=n.UNSIGNED_BYTE,c=null;n.bindTexture(n.TEXTURE_2D,this.renderTargetTexture_),n.texImage2D(n.TEXTURE_2D,i,s,r[0],r[1],o,a,l,c),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,this.renderTargetTexture_,0),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_COMPONENT16,r[0],r[1]),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,this.depthBuffer_)}}apply(e,n,r,i){const s=this.getGL(),o=e.size;if(s.bindFramebuffer(s.FRAMEBUFFER,n?n.getFrameBuffer():null),s.activeTexture(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,this.renderTargetTexture_),!n){const l=Qt(s.canvas);if(!e.renderTargets[l]){const c=s.getContextAttributes();c&&c.preserveDrawingBuffer&&(s.clearColor(0,0,0,0),s.clearDepth(1),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT)),e.renderTargets[l]=!0}}s.disable(s.DEPTH_TEST),s.enable(s.BLEND),s.blendFunc(s.ONE,s.ONE_MINUS_SRC_ALPHA),s.viewport(0,0,s.drawingBufferWidth,s.drawingBufferHeight),s.bindBuffer(s.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),s.useProgram(this.renderTargetProgram_),s.enableVertexAttribArray(this.renderTargetAttribLocation_),s.vertexAttribPointer(this.renderTargetAttribLocation_,2,s.FLOAT,!1,0,0),s.uniform2f(this.renderTargetUniformLocation_,o[0],o[1]),s.uniform1i(this.renderTargetTextureLocation_,0);const a=e.layerStatesArray[e.layerIndex].opacity;s.uniform1f(this.renderTargetOpacityLocation_,a),this.applyUniforms(e),r&&r(s,e),s.drawArrays(s.TRIANGLES,0,6),i&&i(s,e)}getFrameBuffer(){return this.frameBuffer_}getDepthBuffer(){return this.depthBuffer_}applyUniforms(e){const n=this.getGL();let r,i=1;this.uniforms_.forEach(function(s){if(r=typeof s.value=="function"?s.value(e):s.value,r instanceof HTMLCanvasElement||r instanceof ImageData)s.texture||(s.texture=n.createTexture()),n.activeTexture(n[`TEXTURE${i}`]),n.bindTexture(n.TEXTURE_2D,s.texture),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),r instanceof ImageData?n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,r.width,r.height,0,n.UNSIGNED_BYTE,new Uint8Array(r.data)):n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,r),n.uniform1i(s.location,i++);else if(Array.isArray(r))switch(r.length){case 2:n.uniform2f(s.location,r[0],r[1]);return;case 3:n.uniform3f(s.location,r[0],r[1],r[2]);return;case 4:n.uniform4f(s.location,r[0],r[1],r[2],r[3]);return;default:return}else typeof r=="number"&&n.uniform1f(s.location,r)})}}const gf={PROJECTION_MATRIX:"u_projectionMatrix",SCREEN_TO_WORLD_MATRIX:"u_screenToWorldMatrix",TIME:"u_time",ZOOM:"u_zoom",RESOLUTION:"u_resolution",ROTATION:"u_rotation",VIEWPORT_SIZE_PX:"u_viewportSizePx",PIXEL_RATIO:"u_pixelRatio",HIT_DETECTION:"u_hitDetection"},Ao={UNSIGNED_BYTE:lPe,UNSIGNED_SHORT:cPe,UNSIGNED_INT:uPe,FLOAT:qle},W3={};function iZ(t){return"shared/"+t}let sZ=0;function mPe(){const t="unique/"+sZ;return sZ+=1,t}function gPe(t){let e=W3[t];if(!e){const n=document.createElement("canvas");n.width=1,n.height=1,n.style.position="absolute",n.style.left="0",e={users:0,context:hPe(n)},W3[t]=e}return e.users+=1,e.context}function yPe(t){const e=W3[t];if(!e||(e.users-=1,e.users>0))return;const n=e.context,r=n.getExtension("WEBGL_lose_context");r&&r.loseContext();const i=n.canvas;i.width=1,i.height=1,delete W3[t]}class vPe extends DA{constructor(e){super(),e=e||{},this.boundHandleWebGLContextLost_=this.handleWebGLContextLost.bind(this),this.boundHandleWebGLContextRestored_=this.handleWebGLContextRestored.bind(this),this.canvasCacheKey_=e.canvasCacheKey?iZ(e.canvasCacheKey):mPe(),this.gl_=gPe(this.canvasCacheKey_),this.bufferCache_={},this.extensionCache_={},this.currentProgram_=null,this.needsToBeRecreated_=!1;const n=this.gl_.canvas;n.addEventListener(vC.LOST,this.boundHandleWebGLContextLost_),n.addEventListener(vC.RESTORED,this.boundHandleWebGLContextRestored_),this.offsetRotateMatrix_=Ws(),this.offsetScaleMatrix_=Ws(),this.tmpMat4_=Hle(),this.uniformLocationsByProgram_={},this.attribLocationsByProgram_={},this.uniforms_=[],e.uniforms&&this.setUniforms(e.uniforms),this.postProcessPasses_=e.postProcesses?e.postProcesses.map(r=>new rZ({webGlContext:this.gl_,scaleRatio:r.scaleRatio,vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,uniforms:r.uniforms})):[new rZ({webGlContext:this.gl_})],this.shaderCompileErrors_=null,this.startTime_=Date.now(),this.maxAttributeCount_=this.gl_.getParameter(this.gl_.MAX_VERTEX_ATTRIBS)}setUniforms(e){this.uniforms_=[],this.addUniforms(e)}addUniforms(e){for(const n in e)this.uniforms_.push({name:n,value:e[n]})}canvasCacheKeyMatches(e){return this.canvasCacheKey_===iZ(e)}getExtension(e){if(e in this.extensionCache_)return this.extensionCache_[e];const n=this.gl_.getExtension(e);return this.extensionCache_[e]=n,n}getInstancedRenderingExtension_(){const e=this.getExtension("ANGLE_instanced_arrays");return ur(!!e,"WebGL extension 'ANGLE_instanced_arrays' is required for vector rendering"),e}bindBuffer(e){const n=this.gl_,r=Qt(e);let i=this.bufferCache_[r];if(!i){const s=n.createBuffer();i={buffer:e,webGlBuffer:s},this.bufferCache_[r]=i}n.bindBuffer(e.getType(),i.webGlBuffer)}flushBufferData(e){const n=this.gl_;this.bindBuffer(e),n.bufferData(e.getType(),e.getArray(),e.getUsage())}deleteBuffer(e){const n=Qt(e);delete this.bufferCache_[n]}disposeInternal(){const e=this.gl_.canvas;e.removeEventListener(vC.LOST,this.boundHandleWebGLContextLost_),e.removeEventListener(vC.RESTORED,this.boundHandleWebGLContextRestored_),yPe(this.canvasCacheKey_),delete this.gl_}prepareDraw(e,n,r){const i=this.gl_,s=this.getCanvas(),o=e.size,a=e.pixelRatio;(s.width!==o[0]*a||s.height!==o[1]*a)&&(s.width=o[0]*a,s.height=o[1]*a,s.style.width=o[0]+"px",s.style.height=o[1]+"px");for(let l=this.postProcessPasses_.length-1;l>=0;l--)this.postProcessPasses_[l].init(e);i.bindTexture(i.TEXTURE_2D,null),i.clearColor(0,0,0,0),i.depthRange(0,1),i.clearDepth(1),i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT),i.enable(i.BLEND),i.blendFunc(i.ONE,n?i.ZERO:i.ONE_MINUS_SRC_ALPHA),r?(i.enable(i.DEPTH_TEST),i.depthFunc(i.LEQUAL)):i.disable(i.DEPTH_TEST)}bindFrameBuffer(e,n){const r=this.getGL();r.bindFramebuffer(r.FRAMEBUFFER,e),n&&r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,n,0)}bindInitialFrameBuffer(){const e=this.getGL(),n=this.postProcessPasses_[0].getFrameBuffer();e.bindFramebuffer(e.FRAMEBUFFER,n);const r=this.postProcessPasses_[0].getRenderTargetTexture();e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0)}bindTexture(e,n,r){const i=this.gl_;i.activeTexture(i.TEXTURE0+n),i.bindTexture(i.TEXTURE_2D,e),i.uniform1i(this.getUniformLocation(r),n)}bindAttribute(e,n,r){const i=this.getGL();this.bindBuffer(e);const s=this.getAttributeLocation(n);i.enableVertexAttribArray(s),i.vertexAttribPointer(s,r,i.FLOAT,!1,0,0)}prepareDrawToRenderTarget(e,n,r,i){const s=this.gl_,o=n.getSize();s.bindFramebuffer(s.FRAMEBUFFER,n.getFramebuffer()),s.bindRenderbuffer(s.RENDERBUFFER,n.getDepthbuffer()),s.viewport(0,0,o[0],o[1]),s.bindTexture(s.TEXTURE_2D,n.getTexture()),s.clearColor(0,0,0,0),s.depthRange(0,1),s.clearDepth(1),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),s.enable(s.BLEND),s.blendFunc(s.ONE,r?s.ZERO:s.ONE_MINUS_SRC_ALPHA),i?(s.enable(s.DEPTH_TEST),s.depthFunc(s.LEQUAL)):s.disable(s.DEPTH_TEST)}drawElements(e,n){const r=this.gl_;this.getExtension("OES_element_index_uint");const i=r.UNSIGNED_INT,s=4,o=n-e,a=e*s;r.drawElements(r.TRIANGLES,o,i,a)}drawElementsInstanced(e,n,r){const i=this.gl_;this.getExtension("OES_element_index_uint");const s=this.getInstancedRenderingExtension_(),o=i.UNSIGNED_INT,a=4,l=n-e,c=e*a;s.drawElementsInstancedANGLE(i.TRIANGLES,l,o,c,r);for(let u=0;u<this.maxAttributeCount_;u++)s.vertexAttribDivisorANGLE(u,0)}finalizeDraw(e,n,r){for(let i=0,s=this.postProcessPasses_.length;i<s;i++)i===s-1?this.postProcessPasses_[i].apply(e,null,n,r):this.postProcessPasses_[i].apply(e,this.postProcessPasses_[i+1])}getCanvas(){return this.gl_.canvas}getGL(){return this.gl_}applyFrameState(e){const n=e.size,r=e.viewState.rotation,i=e.pixelRatio;this.setUniformFloatValue(gf.TIME,(Date.now()-this.startTime_)*.001),this.setUniformFloatValue(gf.ZOOM,e.viewState.zoom),this.setUniformFloatValue(gf.RESOLUTION,e.viewState.resolution),this.setUniformFloatValue(gf.PIXEL_RATIO,i),this.setUniformFloatVec2(gf.VIEWPORT_SIZE_PX,[n[0],n[1]]),this.setUniformFloatValue(gf.ROTATION,r)}applyHitDetectionUniform(e){const n=this.getUniformLocation(gf.HIT_DETECTION);this.getGL().uniform1i(n,e?1:0),e&&this.setUniformFloatValue(gf.PIXEL_RATIO,.5)}applyUniforms(e){const n=this.gl_;let r,i=0;this.uniforms_.forEach(s=>{if(r=typeof s.value=="function"?s.value(e):s.value,r instanceof HTMLCanvasElement||r instanceof HTMLImageElement||r instanceof ImageData||r instanceof WebGLTexture){r instanceof WebGLTexture&&!s.texture?(s.prevValue=void 0,s.texture=r):s.texture||(s.prevValue=void 0,s.texture=n.createTexture()),this.bindTexture(s.texture,i,s.name),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE);const o=!(r instanceof HTMLImageElement)||r.complete;!(r instanceof WebGLTexture)&&o&&s.prevValue!==r&&(s.prevValue=r,n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,r)),i++}else if(Array.isArray(r)&&r.length===6)this.setUniformMatrixValue(s.name,WF(this.tmpMat4_,r));else if(Array.isArray(r)&&r.length<=4)switch(r.length){case 2:n.uniform2f(this.getUniformLocation(s.name),r[0],r[1]);return;case 3:n.uniform3f(this.getUniformLocation(s.name),r[0],r[1],r[2]);return;case 4:n.uniform4f(this.getUniformLocation(s.name),r[0],r[1],r[2],r[3]);return;default:return}else typeof r=="number"&&n.uniform1f(this.getUniformLocation(s.name),r)})}useProgram(e,n){this.disableAllAttributes_(),this.gl_.useProgram(e),this.currentProgram_=e,n&&(this.applyFrameState(n),this.applyUniforms(n))}compileShader(e,n){const r=this.gl_,i=r.createShader(n);return r.shaderSource(i,e),r.compileShader(i),i}getProgram(e,n){const r=this.gl_,i=this.compileShader(e,r.FRAGMENT_SHADER),s=this.compileShader(n,r.VERTEX_SHADER),o=r.createProgram();if(r.attachShader(o,i),r.attachShader(o,s),r.linkProgram(o),!r.getShaderParameter(i,r.COMPILE_STATUS)){const a=`Fragment shader compilation failed: ${r.getShaderInfoLog(i)}`;throw new Error(a)}if(r.deleteShader(i),!r.getShaderParameter(s,r.COMPILE_STATUS)){const a=`Vertex shader compilation failed: ${r.getShaderInfoLog(s)}`;throw new Error(a)}if(r.deleteShader(s),!r.getProgramParameter(o,r.LINK_STATUS)){const a=`GL program linking failed: ${r.getProgramInfoLog(o)}`;throw new Error(a)}return o}getUniformLocation(e){const n=Qt(this.currentProgram_);return this.uniformLocationsByProgram_[n]===void 0&&(this.uniformLocationsByProgram_[n]={}),this.uniformLocationsByProgram_[n][e]===void 0&&(this.uniformLocationsByProgram_[n][e]=this.gl_.getUniformLocation(this.currentProgram_,e)),this.uniformLocationsByProgram_[n][e]}getAttributeLocation(e){const n=Qt(this.currentProgram_);return this.attribLocationsByProgram_[n]===void 0&&(this.attribLocationsByProgram_[n]={}),this.attribLocationsByProgram_[n][e]===void 0&&(this.attribLocationsByProgram_[n][e]=this.gl_.getAttribLocation(this.currentProgram_,e)),this.attribLocationsByProgram_[n][e]}makeProjectionTransform(e,n){const r=e.size,i=e.viewState.rotation,s=e.viewState.resolution,o=e.viewState.center;return pu(n,0,0,2/(s*r[0]),2/(s*r[1]),-i,-o[0],-o[1]),n}setUniformFloatValue(e,n){this.gl_.uniform1f(this.getUniformLocation(e),n)}setUniformFloatVec2(e,n){this.gl_.uniform2fv(this.getUniformLocation(e),n)}setUniformFloatVec4(e,n){this.gl_.uniform4fv(this.getUniformLocation(e),n)}setUniformMatrixValue(e,n){this.gl_.uniformMatrix4fv(this.getUniformLocation(e),!1,n)}disableAllAttributes_(){for(let e=0;e<this.maxAttributeCount_;e++)this.gl_.disableVertexAttribArray(e)}enableAttributeArray_(e,n,r,i,s,o){const a=this.getAttributeLocation(e);a<0||(this.gl_.enableVertexAttribArray(a),this.gl_.vertexAttribPointer(a,n,r,!1,i,s),o&&this.getInstancedRenderingExtension_().vertexAttribDivisorANGLE(a,1))}enableAttributes_(e,n){const r=_Pe(e);let i=0;for(let s=0;s<e.length;s++){const o=e[s];o.name&&this.enableAttributeArray_(o.name,o.size,o.type||qle,r,i,n),i+=o.size*Kle(o.type)}}enableAttributes(e){this.enableAttributes_(e,!1)}enableAttributesInstanced(e){this.enableAttributes_(e,!0)}handleWebGLContextLost(e){nv(this.bufferCache_),this.currentProgram_=null,e.preventDefault()}handleWebGLContextRestored(){this.needsToBeRecreated_=!0}needsToBeRecreated(){return this.needsToBeRecreated_}createTexture(e,n,r,i){const s=this.gl_;r=r||s.createTexture();const o=i?s.NEAREST:s.LINEAR;s.bindTexture(s.TEXTURE_2D,r),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,o),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,o),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE);const a=0,l=s.RGBA,c=0,u=s.RGBA,h=s.UNSIGNED_BYTE;return n instanceof Uint8Array?s.texImage2D(s.TEXTURE_2D,a,l,e[0],e[1],c,u,h,n):n?s.texImage2D(s.TEXTURE_2D,a,l,u,h,n):s.texImage2D(s.TEXTURE_2D,a,l,e[0],e[1],c,u,h,null),r}}function _Pe(t){let e=0;for(let n=0;n<t.length;n++){const r=t[n];e+=r.size*Kle(r.type)}return e}function Kle(t){switch(t){case Ao.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case Ao.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case Ao.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case Ao.FLOAT:default:return Float32Array.BYTES_PER_ELEMENT}}class RG extends jA{constructor(e,n,r){super(),r=r||{},this.tileCoord=e,this.state=n,this.key="",this.transition_=r.transition===void 0?250:r.transition,this.transitionStarts_={},this.interpolate=!!r.interpolate}changed(){this.dispatchEvent(wn.CHANGE)}release(){this.setState(cn.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(e){if(this.state!==cn.EMPTY){if(this.state!==cn.ERROR&&this.state>e)throw new Error("Tile load sequence violation");this.state=e,this.changed()}}load(){bn()}getAlpha(e,n){if(!this.transition_)return 1;let r=this.transitionStarts_[e];if(!r)r=n,this.transitionStarts_[e]=r;else if(r===-1)return 1;const i=n-r+1e3/60;return i>=this.transition_?1:Ule(i/this.transition_)}inTransition(e){return this.transition_?this.transitionStarts_[e]!==-1:!1}endTransition(e){this.transition_&&(this.transitionStarts_[e]=-1)}disposeInternal(){this.release(),super.disposeInternal()}}function HF(t){return t instanceof Image||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageBitmap?t:null}const xPe=new Error("disposed"),wPe=[256,256];class oZ extends RG{constructor(e){const n=cn.IDLE;super(e.tileCoord,n,{transition:e.transition,interpolate:e.interpolate}),this.loader_=e.loader,this.data_=null,this.error_=null,this.size_=e.size||null,this.controller_=e.controller||null}getSize(){if(this.size_)return this.size_;const e=HF(this.data_);return e?[e.width,e.height]:wPe}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==cn.IDLE&&this.state!==cn.ERROR)return;this.state=cn.LOADING,this.changed();const e=this;this.loader_().then(function(n){e.data_=n,e.state=cn.LOADED,e.changed()}).catch(function(n){e.error_=n,e.state=cn.ERROR,e.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(xPe),this.controller_=null),super.disposeInternal()}}class Yle extends RG{constructor(e,n,r,i,s,o){super(e,n,o),this.crossOrigin_=i,this.src_=r,this.key=r,this.image_,cc?this.image_=new OffscreenCanvas(1,1):(this.image_=new Image,i!==null&&(this.image_.crossOrigin=i)),this.unlisten_=null,this.tileLoadFunction_=s}getImage(){return this.image_}setImage(e){this.image_=e,this.state=cn.LOADED,this.unlistenImage_(),this.changed()}getCrossOrigin(){return this.crossOrigin_}handleImageError_(){this.state=cn.ERROR,this.unlistenImage_(),this.image_=bPe(),this.changed()}handleImageLoad_(){if(cc)this.state=cn.LOADED;else{const e=this.image_;e.naturalWidth&&e.naturalHeight?this.state=cn.LOADED:this.state=cn.EMPTY}this.unlistenImage_(),this.changed()}load(){this.state==cn.ERROR&&(this.state=cn.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==cn.IDLE&&(this.state=cn.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=lAe(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}}function bPe(){const t=Rs(1,1);return t.fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1),t.canvas}let D6;const Yx=[];function aZ(t,e,n,r,i){t.beginPath(),t.moveTo(0,0),t.lineTo(e,n),t.lineTo(r,i),t.closePath(),t.save(),t.clip(),t.fillRect(0,0,Math.max(e,r)+1,Math.max(n,i)),t.restore()}function j6(t,e){return Math.abs(t[e*4]-210)>2||Math.abs(t[e*4+3]-.75*255)>2}function EPe(){if(D6===void 0){const t=Rs(6,6,Yx);t.globalCompositeOperation="lighter",t.fillStyle="rgba(210, 0, 0, 0.75)",aZ(t,4,5,4,0),aZ(t,4,5,0,5);const e=t.getImageData(0,0,3,3).data;D6=j6(e,0)||j6(e,4)||j6(e,8),I5(t),Yx.push(t.canvas)}return D6}function H3(t,e,n,r){const i=K2(n,e,t);let s=O3(e,r,n);const o=e.getMetersPerUnit();o!==void 0&&(s*=o);const a=t.getMetersPerUnit();a!==void 0&&(s/=a);const l=t.getExtent();if(!l||_1(l,i)){const c=O3(t,s,i)/s;isFinite(c)&&c>0&&(s/=c)}return s}function SPe(t,e,n,r){const i=gh(n);let s=H3(t,e,i,r);return(!isFinite(s)||s<=0)&&Hz(n,function(o){return s=H3(t,e,o,r),isFinite(s)&&s>0}),s}function Xle(t,e,n,r,i,s,o,a,l,c,u,h,f,g){const y=Rs(Math.round(n*t),Math.round(n*e),Yx);if(h||(y.imageSmoothingEnabled=!1),l.length===0)return y.canvas;y.scale(n,n);function _(R){return Math.round(R*n)/n}y.globalCompositeOperation="lighter";const b=Ba();l.forEach(function(R,D,C){Wz(b,R.extent)});let T;const A=n/r,I=(h?1:1+Math.pow(2,-24))/A;(!f||l.length!==1||c!==0)&&(T=Rs(Math.round(Xn(b)*A),Math.round(Ps(b)*A),Yx),h||(T.imageSmoothingEnabled=!1),l.forEach(function(R,D,C){if(R.image.width>0&&R.image.height>0){if(R.clipExtent){T.save();const U=(R.clipExtent[0]-b[0])*A,G=-(R.clipExtent[3]-b[3])*A,de=Xn(R.clipExtent)*A,Ie=Ps(R.clipExtent)*A;T.rect(h?U:Math.round(U),h?G:Math.round(G),h?de:Math.round(U+de)-Math.round(U),h?Ie:Math.round(G+Ie)-Math.round(G)),T.clip()}const M=(R.extent[0]-b[0])*A,O=-(R.extent[3]-b[3])*A,j=Xn(R.extent)*A,V=Ps(R.extent)*A;T.drawImage(R.image,c,c,R.image.width-2*c,R.image.height-2*c,h?M:Math.round(M),h?O:Math.round(O),h?j:Math.round(M+j)-Math.round(M),h?V:Math.round(O+V)-Math.round(O)),R.clipExtent&&T.restore()}}));const P=iv(o);return a.getTriangles().forEach(function(R,D,C){const M=R.source,O=R.target;let j=M[0][0],V=M[0][1],U=M[1][0],G=M[1][1],de=M[2][0],Ie=M[2][1];const ze=_((O[0][0]-P[0])/s),Ne=_(-(O[0][1]-P[1])/s),fe=_((O[1][0]-P[0])/s),De=_(-(O[1][1]-P[1])/s),Ce=_((O[2][0]-P[0])/s),Q=_(-(O[2][1]-P[1])/s),W=j,ne=V;j=0,V=0,U-=W,G-=ne,de-=W,Ie-=ne;const ie=[[U,G,0,0,fe-ze],[de,Ie,0,0,Ce-ze],[0,0,U,G,De-Ne],[0,0,de,Ie,Q-Ne]],le=XTe(ie);if(!le)return;if(y.save(),y.beginPath(),EPe()||!h){y.moveTo(fe,De);const qe=4,Ke=ze-fe,Se=Ne-De;for(let we=0;we<qe;we++)y.lineTo(fe+_((we+1)*Ke/qe),De+_(we*Se/(qe-1))),we!=qe-1&&y.lineTo(fe+_((we+1)*Ke/qe),De+_((we+1)*Se/(qe-1)));y.lineTo(Ce,Q)}else y.moveTo(fe,De),y.lineTo(ze,Ne),y.lineTo(Ce,Q);y.clip(),y.transform(le[0],le[2],le[1],le[3],ze,Ne),y.translate(b[0]-W,b[3]-ne);let ve;if(T)ve=T.canvas,y.scale(I,-I);else{const qe=l[0],Ke=qe.extent;ve=qe.image,y.scale(Xn(Ke)/ve.width,-Ps(Ke)/ve.height)}y.drawImage(ve,0,0),y.restore()}),T&&(I5(T),Yx.push(T.canvas)),u&&(y.save(),y.globalCompositeOperation="source-over",y.strokeStyle="black",y.lineWidth=1,a.getTriangles().forEach(function(R,D,C){const M=R.target,O=(M[0][0]-P[0])/s,j=-(M[0][1]-P[1])/s,V=(M[1][0]-P[0])/s,U=-(M[1][1]-P[1])/s,G=(M[2][0]-P[0])/s,de=-(M[2][1]-P[1])/s;y.beginPath(),y.moveTo(V,U),y.lineTo(O,j),y.lineTo(G,de),y.closePath(),y.stroke()}),y.restore()),y.canvas}const TPe=10,lZ=.25;class Zle{constructor(e,n,r,i,s,o,a){this.sourceProj_=e,this.targetProj_=n;let l={};const c=a?OF(I=>Zi(a,K2(I,this.targetProj_,this.sourceProj_))):uk(this.targetProj_,this.sourceProj_);this.transformInv_=function(I){const P=I[0]+"/"+I[1];return l[P]||(l[P]=c(I)),l[P]},this.maxSourceExtent_=i,this.errorThresholdSquared_=s*s,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!i&&!!this.sourceProj_.getExtent()&&Xn(i)>=Xn(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?Xn(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?Xn(this.targetProj_.getExtent()):null;const u=iv(r),h=w5(r),f=x5(r),g=_5(r),y=this.transformInv_(u),_=this.transformInv_(h),b=this.transformInv_(f),T=this.transformInv_(g),A=TPe+(o?Math.max(0,Math.ceil(Math.log2(AF(r)/(o*o*256*256)))):0);if(this.addQuad_(u,h,f,g,y,_,b,T,A),this.wrapsXInSource_){let I=1/0;this.triangles_.forEach(function(P,R,D){I=Math.min(I,P.source[0][0],P.source[1][0],P.source[2][0])}),this.triangles_.forEach(P=>{if(Math.max(P.source[0][0],P.source[1][0],P.source[2][0])-I>this.sourceWorldWidth_/2){const R=[[P.source[0][0],P.source[0][1]],[P.source[1][0],P.source[1][1]],[P.source[2][0],P.source[2][1]]];R[0][0]-I>this.sourceWorldWidth_/2&&(R[0][0]-=this.sourceWorldWidth_),R[1][0]-I>this.sourceWorldWidth_/2&&(R[1][0]-=this.sourceWorldWidth_),R[2][0]-I>this.sourceWorldWidth_/2&&(R[2][0]-=this.sourceWorldWidth_);const D=Math.min(R[0][0],R[1][0],R[2][0]);Math.max(R[0][0],R[1][0],R[2][0])-D<this.sourceWorldWidth_/2&&(P.source=R)}})}l={}}addTriangle_(e,n,r,i,s,o){this.triangles_.push({source:[i,s,o],target:[e,n,r]})}addQuad_(e,n,r,i,s,o,a,l,c){const u=ka([s,o,a,l]),h=this.sourceWorldWidth_?Xn(u)/this.sourceWorldWidth_:null,f=this.sourceWorldWidth_,g=this.sourceProj_.canWrapX()&&h>.5&&h<1;let y=!1;if(c>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const b=ka([e,n,r,i]);y=Xn(b)/this.targetWorldWidth_>lZ||y}!g&&this.sourceProj_.isGlobal()&&h&&(y=h>lZ||y)}if(!y&&this.maxSourceExtent_&&isFinite(u[0])&&isFinite(u[1])&&isFinite(u[2])&&isFinite(u[3])&&!oa(u,this.maxSourceExtent_))return;let _=0;if(!y&&(!isFinite(s[0])||!isFinite(s[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(a[0])||!isFinite(a[1])||!isFinite(l[0])||!isFinite(l[1]))){if(c>0)y=!0;else if(_=(!isFinite(s[0])||!isFinite(s[1])?8:0)+(!isFinite(o[0])||!isFinite(o[1])?4:0)+(!isFinite(a[0])||!isFinite(a[1])?2:0)+(!isFinite(l[0])||!isFinite(l[1])?1:0),_!=1&&_!=2&&_!=4&&_!=8)return}if(c>0){if(!y){const b=[(e[0]+r[0])/2,(e[1]+r[1])/2],T=this.transformInv_(b);let A;g?A=(fg(s[0],f)+fg(a[0],f))/2-fg(T[0],f):A=(s[0]+a[0])/2-T[0];const I=(s[1]+a[1])/2-T[1];y=A*A+I*I>this.errorThresholdSquared_}if(y){if(Math.abs(e[0]-r[0])<=Math.abs(e[1]-r[1])){const b=[(n[0]+r[0])/2,(n[1]+r[1])/2],T=this.transformInv_(b),A=[(i[0]+e[0])/2,(i[1]+e[1])/2],I=this.transformInv_(A);this.addQuad_(e,n,b,A,s,o,T,I,c-1),this.addQuad_(A,b,r,i,I,T,a,l,c-1)}else{const b=[(e[0]+n[0])/2,(e[1]+n[1])/2],T=this.transformInv_(b),A=[(r[0]+i[0])/2,(r[1]+i[1])/2],I=this.transformInv_(A);this.addQuad_(e,b,A,i,s,T,I,l,c-1),this.addQuad_(b,n,r,A,T,o,a,I,c-1)}return}}if(g){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(_&11)==0&&this.addTriangle_(e,r,i,s,a,l),(_&14)==0&&this.addTriangle_(e,r,n,s,a,o),_&&((_&13)==0&&this.addTriangle_(n,i,e,o,l,s),(_&7)==0&&this.addTriangle_(n,i,r,o,l,a))}calculateSourceExtent(){const e=Ba();return this.triangles_.forEach(function(n,r,i){const s=n.source;JS(e,s[0]),JS(e,s[1]),JS(e,s[2])}),e}getTriangles(){return this.triangles_}}const Jle=.5;class Qle extends RG{constructor(e,n,r,i,s,o,a,l,c,u,h,f){super(s,cn.IDLE,f),this.renderEdges_=h!==void 0?h:!1,this.pixelRatio_=a,this.gutter_=l,this.canvas_=null,this.sourceTileGrid_=n,this.targetTileGrid_=i,this.wrappedTileCoord_=o||s,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=e.canWrapX()?e.getExtent():void 0;const g=i.getTileCoordExtent(this.wrappedTileCoord_),y=this.targetTileGrid_.getExtent();let _=this.sourceTileGrid_.getExtent();const b=y?Jf(g,y):g;if(AF(b)===0){this.state=cn.EMPTY;return}const T=e.getExtent();T&&(_?_=Jf(_,T):_=T);const A=i.getResolution(this.wrappedTileCoord_[0]),I=SPe(e,r,b,A);if(!isFinite(I)||I<=0){this.state=cn.EMPTY;return}const P=u!==void 0?u:Jle;if(this.triangulation_=new Zle(e,r,b,_,I*P,A),this.triangulation_.getTriangles().length===0){this.state=cn.EMPTY;return}this.sourceZ_=n.getZForResolution(I);let R=this.triangulation_.calculateSourceExtent();if(_&&(e.canWrapX()?(R[1]=ri(R[1],_[1],_[3]),R[3]=ri(R[3],_[1],_[3])):R=Jf(R,_)),!AF(R))this.state=cn.EMPTY;else{let D=0,C=0;e.canWrapX()&&(D=Xn(T),C=Math.floor((R[0]-T[0])/D)),Fae(R.slice(),e,!0).forEach(O=>{const j=n.getTileRangeForExtentAndZ(O,this.sourceZ_);for(let V=j.minX;V<=j.maxX;V++)for(let U=j.minY;U<=j.maxY;U++){const G=c(this.sourceZ_,V,U,a);if(G){const de=C*D;this.sourceTiles_.push({tile:G,offset:de})}}++C}),this.sourceTiles_.length===0&&(this.state=cn.EMPTY)}}getImage(){return this.canvas_}reproject_(){const e=[];if(this.sourceTiles_.forEach(n=>{const r=n.tile;if(r&&r.getState()==cn.LOADED){const i=this.sourceTileGrid_.getTileCoordExtent(r.tileCoord);i[0]+=n.offset,i[2]+=n.offset;const s=this.clipExtent_?.slice();s&&(s[0]+=n.offset,s[2]+=n.offset),e.push({extent:i,clipExtent:s,image:r.getImage()})}}),this.sourceTiles_.length=0,e.length===0)this.state=cn.ERROR;else{const n=this.wrappedTileCoord_[0],r=this.targetTileGrid_.getTileSize(n),i=typeof r=="number"?r:r[0],s=typeof r=="number"?r:r[1],o=this.targetTileGrid_.getResolution(n),a=this.sourceTileGrid_.getResolution(this.sourceZ_),l=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=Xle(i,s,this.pixelRatio_,a,this.sourceTileGrid_.getExtent(),o,l,this.triangulation_,e,this.gutter_,this.renderEdges_,this.interpolate),this.state=cn.LOADED}this.changed()}load(){if(this.state==cn.IDLE){this.state=cn.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:n})=>{const r=n.getState();if(r==cn.IDLE||r==cn.LOADING){e++;const i=Yn(n,wn.CHANGE,s=>{const o=n.getState();(o==cn.LOADED||o==cn.ERROR||o==cn.EMPTY)&&(ni(i),e--,e===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(i)}}),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:n},r,i){n.getState()==cn.IDLE&&n.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(ni),this.sourcesListenerKeys_=null}release(){this.canvas_&&(I5(this.canvas_.getContext("2d")),Yx.push(this.canvas_),this.canvas_=null),super.release()}}class MG{constructor(e,n,r,i){this.minX=e,this.maxX=n,this.minY=r,this.maxY=i}contains(e){return this.containsXY(e[1],e[2])}containsTileRange(e){return this.minX<=e.minX&&e.maxX<=this.maxX&&this.minY<=e.minY&&e.maxY<=this.maxY}containsXY(e,n){return this.minX<=e&&e<=this.maxX&&this.minY<=n&&n<=this.maxY}equals(e){return this.minX==e.minX&&this.minY==e.minY&&this.maxX==e.maxX&&this.maxY==e.maxY}extend(e){e.minX<this.minX&&(this.minX=e.minX),e.maxX>this.maxX&&(this.maxX=e.maxX),e.minY<this.minY&&(this.minY=e.minY),e.maxY>this.maxY&&(this.maxY=e.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(e){return this.minX<=e.maxX&&this.maxX>=e.minX&&this.minY<=e.maxY&&this.maxY>=e.minY}}function a_(t,e,n,r,i){return i!==void 0?(i.minX=t,i.maxX=e,i.minY=n,i.maxY=r,i):new MG(t,e,n,r)}class cZ{constructor(e){this.highWaterMark=e!==void 0?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}deleteOldest(){const e=this.pop();e instanceof DA&&e.dispose()}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(e){for(;this.canExpireCache();)this.deleteOldest()}clear(){for(;this.oldest_;)this.deleteOldest()}containsKey(e){return this.entries_.hasOwnProperty(e)}forEach(e){let n=this.oldest_;for(;n;)e(n.value_,n.key_,this),n=n.newer}get(e,n){const r=this.entries_[e];return ur(r!==void 0,"Tried to get a value for a key that does not exist in the cache"),r===this.newest_||(r===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(r.newer.older=r.older,r.older.newer=r.newer),r.newer=null,r.older=this.newest_,this.newest_.newer=r,this.newest_=r),r.value_}remove(e){const n=this.entries_[e];return ur(n!==void 0,"Tried to get a value for a key that does not exist in the cache"),n===this.newest_?(this.newest_=n.older,this.newest_&&(this.newest_.newer=null)):n===this.oldest_?(this.oldest_=n.newer,this.oldest_&&(this.oldest_.older=null)):(n.newer.older=n.older,n.older.newer=n.newer),delete this.entries_[e],--this.count_,n.value_}getCount(){return this.count_}getKeys(){const e=new Array(this.count_);let n=0,r;for(r=this.newest_;r;r=r.older)e[n++]=r.key_;return e}getValues(){const e=new Array(this.count_);let n=0,r;for(r=this.newest_;r;r=r.older)e[n++]=r.value_;return e}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(e){return this.entries_[e]?.value_}pop(){const e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_}replace(e,n){this.get(e),this.entries_[e].value_=n}set(e,n){ur(!(e in this.entries_),"Tried to set a value for a key that is used already");const r={key_:e,newer:null,older:this.newest_,value_:n};this.newest_?this.newest_.newer=r:this.oldest_=r,this.newest_=r,this.entries_[e]=r,++this.count_}setSize(e){this.highWaterMark=e}}function q3(t,e,n,r){return r!==void 0?(r[0]=t,r[1]=e,r[2]=n,r):[t,e,n]}function kPe(t,e,n){return t+"/"+e+"/"+n}function XR(t,e,n,r,i){return`${Qt(t)},${e},${kPe(n,r,i)}`}function ece(t){return APe(t[0],t[1],t[2])}function APe(t,e,n){return(e<<t)+n}function IPe(t,e){const n=t[0],r=t[1],i=t[2];if(e.getMinZoom()>n||n>e.getMaxZoom())return!1;const s=e.getFullTileRange(n);return s?s.containsXY(r,i):!0}class NG extends Dle{constructor(e,n){super(e),n=n||{},this.inversePixelTransform_=Ws(),this.postProcesses_=n.postProcesses,this.uniforms_=n.uniforms,this.helper,this.onMapChanged_=()=>{this.clearCache(),this.removeHelper()},e.addChangeListener(Tr.MAP,this.onMapChanged_),this.dispatchPreComposeEvent=this.dispatchPreComposeEvent.bind(this),this.dispatchPostComposeEvent=this.dispatchPostComposeEvent.bind(this)}dispatchPreComposeEvent(e,n){const r=this.getLayer();if(r.hasListener(co.PRECOMPOSE)){const i=new eT(co.PRECOMPOSE,void 0,n,e);r.dispatchEvent(i)}}dispatchPostComposeEvent(e,n){const r=this.getLayer();if(r.hasListener(co.POSTCOMPOSE)){const i=new eT(co.POSTCOMPOSE,void 0,n,e);r.dispatchEvent(i)}}reset(e){this.uniforms_=e.uniforms,this.helper&&this.helper.setUniforms(this.uniforms_)}removeHelper(){this.helper&&(this.helper.dispose(),delete this.helper)}prepareFrame(e){if(this.getLayer().getRenderSource()){let n=!0,r=-1,i;for(let o=0,a=e.layerStatesArray.length;o<a;o++){const l=e.layerStatesArray[o].layer,c=l.getRenderer();if(!(c instanceof NG)){n=!0;continue}const u=l.getClassName();if((n||u!==i)&&(r+=1,n=!1),i=u,c===this)break}const s="map/"+e.mapId+"/group/"+r;(!this.helper||!this.helper.canvasCacheKeyMatches(s)||this.helper.needsToBeRecreated())&&(this.removeHelper(),this.helper=new vPe({postProcesses:this.postProcesses_,uniforms:this.uniforms_,canvasCacheKey:s}),i&&(this.helper.getCanvas().className=i),this.afterHelperCreated())}return this.prepareFrameInternal(e)}afterHelperCreated(){}prepareFrameInternal(e){return!0}clearCache(){}disposeInternal(){this.clearCache(),this.removeHelper(),this.getLayer()?.removeChangeListener(Tr.MAP,this.onMapChanged_),super.disposeInternal()}dispatchRenderEvent_(e,n,r){const i=this.getLayer();if(i.hasListener(e)){pu(this.inversePixelTransform_,0,0,r.pixelRatio,-r.pixelRatio,0,0,-r.size[1]);const s=new eT(e,this.inversePixelTransform_,r,n);i.dispatchEvent(s)}}preRender(e,n){this.dispatchRenderEvent_(co.PRERENDER,e,n)}postRender(e,n){this.dispatchRenderEvent_(co.POSTRENDER,e,n)}}const $6={TILE_TEXTURE_ARRAY:"u_tileTextures",TEXTURE_PIXEL_WIDTH:"u_texturePixelWidth",TEXTURE_PIXEL_HEIGHT:"u_texturePixelHeight"};class PPe{constructor(e,n){this.name=e,this.data=n,this.texture_=null}getTexture(e){if(!this.texture_){const n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.data.length/4,1,0,e.RGBA,e.UNSIGNED_BYTE,this.data),this.texture_=n}return this.texture_}delete(e){this.texture_&&e.deleteTexture(this.texture_),this.texture_=null}}function CPe(t,e){return`operator_${t}_${Object.keys(e.functions).length}`}function pg(t){const e=t.toString();return e.includes(".")?e:e+".0"}function OG(t){if(t.length<2||t.length>4)throw new Error("`formatArray` can only output `vec2`, `vec3` or `vec4` arrays.");return`vec${t.length}(${t.map(pg).join(", ")})`}function ZR(t){const e=mu(t),n=e.length>3?e[3]:1;return OG([e[0]/255,e[1]/255,e[2]/255,n])}function RPe(t){const e=ja(t);return OG(e)}const F6={};let MPe=0;function xk(t){return t in F6||(F6[t]=MPe++),F6[t]}function $f(t){return pg(xk(t))}function LG(t){return"u_var_"+t}function tce(){return{variables:{},properties:{},functions:{},bandCount:0,featureId:!1,geometryType:!1}}const V6="getBandValue",NPe="u_paletteTextures",nce="featureId",rce="geometryType",qF=-9999999;function OPe(t,e,n,r){const i=ho(t,e,n);return DG(i,e,r)}function vr(t){return(e,n,r)=>{const i=n.args.length,s=new Array(i);for(let o=0;o<i;++o)s[o]=DG(n.args[o],r,e);return t(s,e)}}const LPe={[Te.Get]:(t,e)=>{const r=e.args[0].value;r in t.properties||(t.properties[r]={name:r,type:e.type});let s="a_prop_"+r;return id(e.type,Is)&&(s=`(${s} > 0.0)`),s},[Te.Id]:t=>(t.featureId=!0,"a_"+nce),[Te.GeometryType]:t=>(t.geometryType=!0,"a_"+rce),[Te.LineMetric]:()=>"currentLineMetric",[Te.Var]:(t,e)=>{const r=e.args[0].value;r in t.variables||(t.variables[r]={name:r,type:e.type});let s=LG(r);return id(e.type,Is)&&(s=`(${s} > 0.0)`),s},[Te.Has]:(t,e)=>{const r=e.args[0].value;return r in t.properties||(t.properties[r]={name:r,type:e.type}),`(a_prop_${r} != ${pg(qF)})`},[Te.Resolution]:()=>"u_resolution",[Te.Zoom]:()=>"u_zoom",[Te.Time]:()=>"u_time",[Te.Any]:vr(t=>`(${t.join(" || ")})`),[Te.All]:vr(t=>`(${t.join(" && ")})`),[Te.Not]:vr(([t])=>`(!${t})`),[Te.Equal]:vr(([t,e])=>`(${t} == ${e})`),[Te.NotEqual]:vr(([t,e])=>`(${t} != ${e})`),[Te.GreaterThan]:vr(([t,e])=>`(${t} > ${e})`),[Te.GreaterThanOrEqualTo]:vr(([t,e])=>`(${t} >= ${e})`),[Te.LessThan]:vr(([t,e])=>`(${t} < ${e})`),[Te.LessThanOrEqualTo]:vr(([t,e])=>`(${t} <= ${e})`),[Te.Multiply]:vr(t=>`(${t.join(" * ")})`),[Te.Divide]:vr(([t,e])=>`(${t} / ${e})`),[Te.Add]:vr(t=>`(${t.join(" + ")})`),[Te.Subtract]:vr(([t,e])=>`(${t} - ${e})`),[Te.Clamp]:vr(([t,e,n])=>`clamp(${t}, ${e}, ${n})`),[Te.Mod]:vr(([t,e])=>`mod(${t}, ${e})`),[Te.Pow]:vr(([t,e])=>`pow(${t}, ${e})`),[Te.Abs]:vr(([t])=>`abs(${t})`),[Te.Floor]:vr(([t])=>`floor(${t})`),[Te.Ceil]:vr(([t])=>`ceil(${t})`),[Te.Round]:vr(([t])=>`floor(${t} + 0.5)`),[Te.Sin]:vr(([t])=>`sin(${t})`),[Te.Cos]:vr(([t])=>`cos(${t})`),[Te.Atan]:vr(([t,e])=>e!==void 0?`atan(${t}, ${e})`:`atan(${t})`),[Te.Sqrt]:vr(([t])=>`sqrt(${t})`),[Te.Match]:vr(t=>{const e=t[0],n=t[t.length-1];let r=null;for(let i=t.length-3;i>=1;i-=2){const s=t[i],o=t[i+1];r=`(${e} == ${s} ? ${o} : ${r||n})`}return r}),[Te.Between]:vr(([t,e,n])=>`(${t} >= ${e} && ${t} <= ${n})`),[Te.Interpolate]:vr(([t,e,...n])=>{let r="";for(let i=0;i<n.length-2;i+=2){const s=n[i],o=r||n[i+1],a=n[i+2],l=n[i+3];let c;t===pg(1)?c=`(${e} - ${s}) / (${a} - ${s})`:c=`(pow(${t}, (${e} - ${s})) - 1.0) / (pow(${t}, (${a} - ${s})) - 1.0)`,r=`mix(${o}, ${l}, clamp(${c}, 0.0, 1.0))`}return r}),[Te.Case]:vr(t=>{const e=t[t.length-1];let n=null;for(let r=t.length-3;r>=0;r-=2){const i=t[r],s=t[r+1];n=`(${i} ? ${s} : ${n||e})`}return n}),[Te.In]:vr(([t,...e],n)=>{const r=CPe("in",n),i=[];for(let s=0;s<e.length;s+=1)i.push(`  if (inputValue == ${e[s]}) { return true; }`);return n.functions[r]=`bool ${r}(float inputValue) {
${i.join(`
`)}
  return false;
}`,`${r}(${t})`}),[Te.Array]:vr(t=>`vec${t.length}(${t.join(", ")})`),[Te.Color]:vr(t=>{if(t.length===1)return`vec4(vec3(${t[0]} / 255.0), 1.0)`;if(t.length===2)return`vec4(vec3(${t[0]} / 255.0), ${t[1]})`;const e=t.slice(0,3).map(r=>`${r} / 255.0`);if(t.length===3)return`vec4(${e.join(", ")}, 1.0)`;const n=t[3];return`vec4(${e.join(", ")}, ${n})`}),[Te.Band]:vr(([t,e,n],r)=>{if(!(V6 in r.functions)){let i="";const s=r.bandCount||1;for(let o=0;o<s;o++){const a=Math.floor(o/4);let l=o%4;o===s-1&&l===1&&(l=3);const c=`${$6.TILE_TEXTURE_ARRAY}[${a}]`;i+=`  if (band == ${o+1}.0) {
    return texture2D(${c}, v_textureCoord + vec2(dx, dy))[${l}];
  }
`}r.functions[V6]=`float getBandValue(float band, float xOffset, float yOffset) {
  float dx = xOffset / ${$6.TEXTURE_PIXEL_WIDTH};
  float dy = yOffset / ${$6.TEXTURE_PIXEL_HEIGHT};
${i}
}`}return`${V6}(${t}, ${e??"0.0"}, ${n??"0.0"})`}),[Te.Palette]:(t,e)=>{const[n,...r]=e.args,i=r.length,s=new Uint8Array(i*4);for(let c=0;c<r.length;c++){const u=r[c].value,h=mu(u),f=c*4;s[f]=h[0],s[f+1]=h[1],s[f+2]=h[2],s[f+3]=h[3]*255}t.paletteTextures||(t.paletteTextures=[]);const o=`${NPe}[${t.paletteTextures.length}]`,a=new PPe(o,s);t.paletteTextures.push(a);const l=DG(n,Wt,t);return`texture2D(${o}, vec2((${l} + 0.5) / ${i}.0, 0.5))`}};function DG(t,e,n){if(t instanceof jle){const r=LPe[t.operator];if(r===void 0)throw new Error(`No compiler defined for this operator: ${JSON.stringify(t.operator)}`);return r(n,t,e)}if((t.type&Wt)>0)return pg(t.value);if((t.type&Is)>0)return t.value.toString();if((t.type&Us)>0)return $f(t.value.toString());if((t.type&Ei)>0)return ZR(t.value);if((t.type&Al)>0)return OG(t.value);if((t.type&ru)>0)return RPe(t.value);throw new Error(`Unexpected expression ${t.value} (expected type ${Ex(e)})`)}function DPe(){return{"fill-color":"rgba(255,255,255,0.4)","stroke-color":"#3399CC","stroke-width":1.25,"circle-radius":5,"circle-fill-color":"rgba(255,255,255,0.4)","circle-stroke-width":1.25,"circle-stroke-color":"#3399CC"}}const uZ=.985;function An(t,e,n){const r=bG();return OPe(e,n,r,t)}function jPe(t){const e=mu(t),n=e[0]*256,r=e[1],i=e[2]*256,s=Math.round(e[3]*255);return[n+r,i+s]}const $Pe=`vec4 unpackColor(vec2 packedColor) {
  return vec4(
    min(floor(packedColor[0] / 256.0) / 255.0, 1.0),
    min(mod(packedColor[0], 256.0) / 255.0, 1.0),
    min(floor(packedColor[1] / 256.0) / 255.0, 1.0),
    min(mod(packedColor[1], 256.0) / 255.0, 1.0)
  );
}`;function jG(t){return t===Ei||t===ru?2:t===Al?4:1}function KF(t){const e=jG(t);return e>1?`vec${e}`:"float"}function ice(t,e){for(const n in e.variables){const r=e.variables[n],i=LG(r.name);let s=KF(r.type);r.type===Ei&&(s="vec4"),t.addUniform(i,s)}for(const n in e.properties){const r=e.properties[n],i=KF(r.type),s=`a_prop_${r.name}`;r.type===Ei?t.addAttribute(s,i,`unpackColor(${s})`,"vec4"):t.addAttribute(s,i)}for(const n in e.functions)t.addVertexShaderFunction(e.functions[n]),t.addFragmentShaderFunction(e.functions[n])}function sce(t,e){const n={};for(const r in t.variables){const i=t.variables[r],s=LG(i.name);n[s]=()=>{const o=e[i.name];if(typeof o=="number")return o;if(typeof o=="boolean")return o?1:0;if(i.type===Ei){const a=[...mu(o||"#eee")];return a[0]/=255,a[1]/=255,a[2]/=255,a[3]??=1,a}return typeof o=="string"?xk(o):o}}return n}function oce(t){const e={};for(const n in t.properties){const r=t.properties[n],i=s=>{const o=s.get(r.name);return r.type===Ei?jPe([...mu(o||"#eee")]):typeof o=="string"?xk(o):typeof o=="boolean"?o?1:0:o};e[`prop_${r.name}`]={size:jG(r.type),callback:i}}return e}const l_=`#ifdef GL_FRAGMENT_PRECISION_HIGH
precision highp float;
#else
precision mediump float;
#endif
uniform mat4 u_projectionMatrix;
uniform mat4 u_screenToWorldMatrix;
uniform vec2 u_viewportSizePx;
uniform float u_pixelRatio;
uniform float u_globalAlpha;
uniform float u_time;
uniform float u_zoom;
uniform float u_resolution;
uniform float u_rotation;
uniform vec4 u_renderExtent;
uniform vec2 u_patternOrigin;
uniform float u_depth;
uniform mediump int u_hitDetection;

const float PI = 3.141592653589793238;
const float TWO_PI = 2.0 * PI;
float currentLineMetric = 0.; // an actual value will be used in the stroke shaders

${$Pe}
`,c_=DPe();class ace{constructor(){this.uniforms_=[],this.attributes_=[],this.hasSymbol_=!1,this.symbolSizeExpression_=`vec2(${pg(c_["circle-radius"])} + ${pg(c_["circle-stroke-width"]*.5)})`,this.symbolRotationExpression_="0.0",this.symbolOffsetExpression_="vec2(0.0)",this.symbolColorExpression_=ZR(c_["circle-fill-color"]),this.texCoordExpression_="vec4(0.0, 0.0, 1.0, 1.0)",this.discardExpression_="false",this.symbolRotateWithView_=!1,this.hasStroke_=!1,this.strokeWidthExpression_=pg(c_["stroke-width"]),this.strokeColorExpression_=ZR(c_["stroke-color"]),this.strokeOffsetExpression_="0.",this.strokeCapExpression_=$f("round"),this.strokeJoinExpression_=$f("round"),this.strokeMiterLimitExpression_="10.",this.strokeDistanceFieldExpression_="-1000.",this.strokePatternLengthExpression_=null,this.hasFill_=!1,this.fillColorExpression_=ZR(c_["fill-color"]),this.vertexShaderFunctions_=[],this.fragmentShaderFunctions_=[]}addUniform(e,n){return this.uniforms_.push({name:e,type:n}),this}addAttribute(e,n,r,i){return this.attributes_.push({name:e,type:n,varyingName:e.replace(/^a_/,"v_"),varyingType:i??n,varyingExpression:r??e}),this}setSymbolSizeExpression(e){return this.hasSymbol_=!0,this.symbolSizeExpression_=e,this}getSymbolSizeExpression(){return this.symbolSizeExpression_}setSymbolRotationExpression(e){return this.symbolRotationExpression_=e,this}setSymbolOffsetExpression(e){return this.symbolOffsetExpression_=e,this}getSymbolOffsetExpression(){return this.symbolOffsetExpression_}setSymbolColorExpression(e){return this.hasSymbol_=!0,this.symbolColorExpression_=e,this}getSymbolColorExpression(){return this.symbolColorExpression_}setTextureCoordinateExpression(e){return this.texCoordExpression_=e,this}setFragmentDiscardExpression(e){return this.discardExpression_=e,this}getFragmentDiscardExpression(){return this.discardExpression_}setSymbolRotateWithView(e){return this.symbolRotateWithView_=e,this}setStrokeWidthExpression(e){return this.hasStroke_=!0,this.strokeWidthExpression_=e,this}setStrokeColorExpression(e){return this.hasStroke_=!0,this.strokeColorExpression_=e,this}getStrokeColorExpression(){return this.strokeColorExpression_}setStrokeOffsetExpression(e){return this.strokeOffsetExpression_=e,this}setStrokeCapExpression(e){return this.strokeCapExpression_=e,this}setStrokeJoinExpression(e){return this.strokeJoinExpression_=e,this}setStrokeMiterLimitExpression(e){return this.strokeMiterLimitExpression_=e,this}setStrokeDistanceFieldExpression(e){return this.strokeDistanceFieldExpression_=e,this}setStrokePatternLengthExpression(e){return this.strokePatternLengthExpression_=e,this}getStrokePatternLengthExpression(){return this.strokePatternLengthExpression_}setFillColorExpression(e){return this.hasFill_=!0,this.fillColorExpression_=e,this}getFillColorExpression(){return this.fillColorExpression_}addVertexShaderFunction(e){return this.vertexShaderFunctions_.includes(e)?this:(this.vertexShaderFunctions_.push(e),this)}addFragmentShaderFunction(e){return this.fragmentShaderFunctions_.includes(e)?this:(this.fragmentShaderFunctions_.push(e),this)}getSymbolVertexShader(){return this.hasSymbol_?`${l_}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
attribute vec2 a_position;
attribute vec2 a_localPosition;
attribute vec2 a_hitColor;

varying vec2 v_texCoord;
varying vec2 v_quadCoord;
varying vec4 v_hitColor;
varying vec2 v_centerPx;
varying float v_angle;
varying vec2 v_quadSizePx;

${this.attributes_.map(e=>`attribute ${e.type} ${e.name};
varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.vertexShaderFunctions_.join(`
`)}
vec2 pxToScreen(vec2 coordPx) {
  vec2 scaled = coordPx / u_viewportSizePx / 0.5;
  return scaled;
}

vec2 screenToPx(vec2 coordScreen) {
  return (coordScreen * 0.5 + 0.5) * u_viewportSizePx;
}

void main(void) {
  v_quadSizePx = ${this.symbolSizeExpression_};
  vec2 halfSizePx = v_quadSizePx * 0.5;
  vec2 centerOffsetPx = ${this.symbolOffsetExpression_};
  vec2 offsetPx = centerOffsetPx + a_localPosition * halfSizePx * vec2(1., -1.);
  float angle = ${this.symbolRotationExpression_}${this.symbolRotateWithView_?" + u_rotation":""};
  float c = cos(-angle);
  float s = sin(-angle);
  offsetPx = vec2(c * offsetPx.x - s * offsetPx.y, s * offsetPx.x + c * offsetPx.y);
  vec4 center = u_projectionMatrix * vec4(a_position, 0.0, 1.0);
  gl_Position = center + vec4(pxToScreen(offsetPx), u_depth, 0.);
  vec4 texCoord = ${this.texCoordExpression_};
  float u = mix(texCoord.s, texCoord.p, a_localPosition.x * 0.5 + 0.5);
  float v = mix(texCoord.t, texCoord.q, a_localPosition.y * 0.5 + 0.5);
  v_texCoord = vec2(u, v);
  v_hitColor = unpackColor(a_hitColor);
  v_angle = angle;
  c = cos(-v_angle);
  s = sin(-v_angle);
  centerOffsetPx = vec2(c * centerOffsetPx.x - s * centerOffsetPx.y, s * centerOffsetPx.x + c * centerOffsetPx.y);
  v_centerPx = screenToPx(center.xy) + centerOffsetPx;
${this.attributes_.map(e=>`  ${e.varyingName} = ${e.varyingExpression};`).join(`
`)}
}`:null}getSymbolFragmentShader(){return this.hasSymbol_?`${l_}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
varying vec2 v_texCoord;
varying vec4 v_hitColor;
varying vec2 v_centerPx;
varying float v_angle;
varying vec2 v_quadSizePx;
${this.attributes_.map(e=>`varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.fragmentShaderFunctions_.join(`
`)}

void main(void) {
${this.attributes_.map(e=>`  ${e.varyingType} ${e.name} = ${e.varyingName}; // assign to original attribute name`).join(`
`)}
  if (${this.discardExpression_}) { discard; }
  vec2 coordsPx = gl_FragCoord.xy / u_pixelRatio - v_centerPx; // relative to center
  float c = cos(v_angle);
  float s = sin(v_angle);
  coordsPx = vec2(c * coordsPx.x - s * coordsPx.y, s * coordsPx.x + c * coordsPx.y);
  gl_FragColor = ${this.symbolColorExpression_};
  gl_FragColor.rgb *= gl_FragColor.a;
  if (u_hitDetection > 0) {
    if (gl_FragColor.a < 0.05) { discard; };
    gl_FragColor = v_hitColor;
  }
}`:null}getStrokeVertexShader(){return this.hasStroke_?`${l_}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
attribute vec2 a_segmentStart;
attribute vec2 a_segmentEnd;
attribute vec2 a_localPosition;
attribute float a_measureStart;
attribute float a_measureEnd;
attribute float a_angleTangentSum;
attribute float a_distanceLow;
attribute float a_distanceHigh;
attribute vec2 a_joinAngles;
attribute vec2 a_hitColor;

varying vec2 v_segmentStartPx;
varying vec2 v_segmentEndPx;
varying float v_angleStart;
varying float v_angleEnd;
varying float v_width;
varying vec4 v_hitColor;
varying float v_distancePx;
varying float v_measureStart;
varying float v_measureEnd;

${this.attributes_.map(e=>`attribute ${e.type} ${e.name};
varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.vertexShaderFunctions_.join(`
`)}
vec2 worldToPx(vec2 worldPos) {
  vec4 screenPos = u_projectionMatrix * vec4(worldPos, 0.0, 1.0);
  return (0.5 * screenPos.xy + 0.5) * u_viewportSizePx;
}

vec4 pxToScreen(vec2 pxPos) {
  vec2 screenPos = 2.0 * pxPos / u_viewportSizePx - 1.0;
  return vec4(screenPos, u_depth, 1.0);
}

bool isCap(float joinAngle) {
  return joinAngle < -0.1;
}

vec2 getJoinOffsetDirection(vec2 normalPx, float joinAngle) {
  float halfAngle = joinAngle / 2.0;
  float c = cos(halfAngle);
  float s = sin(halfAngle);
  vec2 angleBisectorNormal = vec2(s * normalPx.x + c * normalPx.y, -c * normalPx.x + s * normalPx.y);
  float length = 1.0 / s;
  return angleBisectorNormal * length;
}

vec2 getOffsetPoint(vec2 point, vec2 normal, float joinAngle, float offsetPx) {
  // if on a cap or the join angle is too high, offset the line along the segment normal
  if (cos(joinAngle) > 0.998 || isCap(joinAngle)) {
    return point - normal * offsetPx;
  }
  // offset is applied along the inverted normal (positive offset goes "right" relative to line direction)
  return point - getJoinOffsetDirection(normal, joinAngle) * offsetPx;
}

void main(void) {
  v_angleStart = a_joinAngles.x;
  v_angleEnd = a_joinAngles.y;
  float startEndRatio = a_localPosition.x * 0.5 + 0.5;
  currentLineMetric = mix(a_measureStart, a_measureEnd, startEndRatio);
  // we're reading the fractional part while keeping the sign (so -4.12 gives -0.12, 3.45 gives 0.45)

  float lineWidth = ${this.strokeWidthExpression_};
  float lineOffsetPx = ${this.strokeOffsetExpression_};

  // compute segment start/end in px with offset
  vec2 segmentStartPx = worldToPx(a_segmentStart);
  vec2 segmentEndPx = worldToPx(a_segmentEnd);
  vec2 tangentPx = normalize(segmentEndPx - segmentStartPx);
  vec2 normalPx = vec2(-tangentPx.y, tangentPx.x);
  segmentStartPx = getOffsetPoint(segmentStartPx, normalPx, v_angleStart, lineOffsetPx),
  segmentEndPx = getOffsetPoint(segmentEndPx, normalPx, v_angleEnd, lineOffsetPx);

  // compute current vertex position
  float normalDir = -1. * a_localPosition.y;
  float tangentDir = -1. * a_localPosition.x;
  float angle = mix(v_angleStart, v_angleEnd, startEndRatio);
  vec2 joinDirection;
  vec2 positionPx = mix(segmentStartPx, segmentEndPx, startEndRatio);
  // if angle is too high, do not make a proper join
  if (cos(angle) > ${uZ} || isCap(angle)) {
    joinDirection = normalPx * normalDir - tangentPx * tangentDir;
  } else {
    joinDirection = getJoinOffsetDirection(normalPx * normalDir, angle);
  }
  positionPx = positionPx + joinDirection * (lineWidth * 0.5 + 1.); // adding 1 pixel for antialiasing
  gl_Position = pxToScreen(positionPx);

  v_segmentStartPx = segmentStartPx;
  v_segmentEndPx = segmentEndPx;
  v_width = lineWidth;
  v_hitColor = unpackColor(a_hitColor);

  v_distancePx = a_distanceLow / u_resolution - (lineOffsetPx * a_angleTangentSum);
  float distanceHighPx = a_distanceHigh / u_resolution;
  ${this.strokePatternLengthExpression_!==null?`v_distancePx = mod(v_distancePx, ${this.strokePatternLengthExpression_});
  distanceHighPx = mod(distanceHighPx, ${this.strokePatternLengthExpression_});
  `:""}v_distancePx += distanceHighPx;

  v_measureStart = a_measureStart;
  v_measureEnd = a_measureEnd;
${this.attributes_.map(e=>`  ${e.varyingName} = ${e.varyingExpression};`).join(`
`)}
}`:null}getStrokeFragmentShader(){return this.hasStroke_?`${l_}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
varying vec2 v_segmentStartPx;
varying vec2 v_segmentEndPx;
varying float v_angleStart;
varying float v_angleEnd;
varying float v_width;
varying vec4 v_hitColor;
varying float v_distancePx;
varying float v_measureStart;
varying float v_measureEnd;
${this.attributes_.map(e=>`varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.fragmentShaderFunctions_.join(`
`)}

vec2 pxToWorld(vec2 pxPos) {
  vec2 screenPos = 2.0 * pxPos / u_viewportSizePx - 1.0;
  return (u_screenToWorldMatrix * vec4(screenPos, 0.0, 1.0)).xy;
}

bool isCap(float joinAngle) {
  return joinAngle < -0.1;
}

float segmentDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  vec2 tangent = normalize(end - start);
  vec2 normal = vec2(-tangent.y, tangent.x);
  vec2 startToPoint = point - start;
  return abs(dot(startToPoint, normal)) - width * 0.5;
}

float buttCapDistanceField(vec2 point, vec2 start, vec2 end) {
  vec2 startToPoint = point - start;
  vec2 tangent = normalize(end - start);
  return dot(startToPoint, -tangent);
}

float squareCapDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  return buttCapDistanceField(point, start, end) - width * 0.5;
}

float roundCapDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  float onSegment = max(0., 1000. * dot(point - start, end - start)); // this is very high when inside the segment
  return length(point - start) - width * 0.5 - onSegment;
}

float roundJoinDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  return roundCapDistanceField(point, start, end, width);
}

float bevelJoinField(vec2 point, vec2 start, vec2 end, float width, float joinAngle) {
  vec2 startToPoint = point - start;
  vec2 tangent = normalize(end - start);
  float c = cos(joinAngle * 0.5);
  float s = sin(joinAngle * 0.5);
  float direction = -sign(sin(joinAngle));
  vec2 bisector = vec2(c * tangent.x - s * tangent.y, s * tangent.x + c * tangent.y);
  float radius = width * 0.5 * s;
  return dot(startToPoint, bisector * direction) - radius;
}

float miterJoinDistanceField(vec2 point, vec2 start, vec2 end, float width, float joinAngle) {
  if (cos(joinAngle) > ${uZ}) { // avoid risking a division by zero
    return bevelJoinField(point, start, end, width, joinAngle);
  }
  float miterLength = 1. / sin(joinAngle * 0.5);
  float miterLimit = ${this.strokeMiterLimitExpression_};
  if (miterLength > miterLimit) {
    return bevelJoinField(point, start, end, width, joinAngle);
  }
  return -1000.;
}

float capDistanceField(vec2 point, vec2 start, vec2 end, float width, float capType) {
   if (capType == ${$f("butt")}) {
    return buttCapDistanceField(point, start, end);
  } else if (capType == ${$f("square")}) {
    return squareCapDistanceField(point, start, end, width);
  }
  return roundCapDistanceField(point, start, end, width);
}

float joinDistanceField(vec2 point, vec2 start, vec2 end, float width, float joinAngle, float joinType) {
  if (joinType == ${$f("bevel")}) {
    return bevelJoinField(point, start, end, width, joinAngle);
  } else if (joinType == ${$f("miter")}) {
    return miterJoinDistanceField(point, start, end, width, joinAngle);
  }
  return roundJoinDistanceField(point, start, end, width);
}

float computeSegmentPointDistance(vec2 point, vec2 start, vec2 end, float width, float joinAngle, float capType, float joinType) {
  if (isCap(joinAngle)) {
    return capDistanceField(point, start, end, width, capType);
  }
  return joinDistanceField(point, start, end, width, joinAngle, joinType);
}

float distanceFromSegment(vec2 point, vec2 start, vec2 end) {
  vec2 tangent = end - start;
  vec2 startToPoint = point - start;
  // inspire by capsule fn in https://iquilezles.org/articles/distfunctions/
  float h = clamp(dot(startToPoint, tangent) / dot(tangent, tangent), 0.0, 1.0);
  return length(startToPoint - tangent * h);
}

void main(void) {
${this.attributes_.map(e=>`  ${e.varyingType} ${e.name} = ${e.varyingName}; // assign to original attribute name`).join(`
`)}

  vec2 currentPointPx = gl_FragCoord.xy / u_pixelRatio;
  #ifdef GL_FRAGMENT_PRECISION_HIGH
  vec2 worldPos = pxToWorld(currentPointPx);
  if (
    abs(u_renderExtent[0] - u_renderExtent[2]) > 0.0 && (
      worldPos[0] < u_renderExtent[0] ||
      worldPos[1] < u_renderExtent[1] ||
      worldPos[0] > u_renderExtent[2] ||
      worldPos[1] > u_renderExtent[3]
    )
  ) {
    discard;
  }
  #endif

  float segmentLengthPx = length(v_segmentEndPx - v_segmentStartPx);
  segmentLengthPx = max(segmentLengthPx, 1.17549429e-38); // avoid divide by zero
  vec2 segmentTangent = (v_segmentEndPx - v_segmentStartPx) / segmentLengthPx;
  vec2 segmentNormal = vec2(-segmentTangent.y, segmentTangent.x);
  vec2 startToPointPx = currentPointPx - v_segmentStartPx;
  float lengthToPointPx = max(0., min(dot(segmentTangent, startToPointPx), segmentLengthPx));
  float currentLengthPx = lengthToPointPx + v_distancePx;
  float currentRadiusPx = distanceFromSegment(currentPointPx, v_segmentStartPx, v_segmentEndPx);
  float currentRadiusRatio = dot(segmentNormal, startToPointPx) * 2. / v_width;
  currentLineMetric = mix(v_measureStart, v_measureEnd, lengthToPointPx / segmentLengthPx);

  if (${this.discardExpression_}) { discard; }

  float capType = ${this.strokeCapExpression_};
  float joinType = ${this.strokeJoinExpression_};
  float segmentStartDistance = computeSegmentPointDistance(currentPointPx, v_segmentStartPx, v_segmentEndPx, v_width, v_angleStart, capType, joinType);
  float segmentEndDistance = computeSegmentPointDistance(currentPointPx, v_segmentEndPx, v_segmentStartPx, v_width, v_angleEnd, capType, joinType);
  float distanceField = max(
    segmentDistanceField(currentPointPx, v_segmentStartPx, v_segmentEndPx, v_width),
    max(segmentStartDistance, segmentEndDistance)
  );
  distanceField = max(distanceField, ${this.strokeDistanceFieldExpression_});

  vec4 color = ${this.strokeColorExpression_};
  color.a *= smoothstep(0.5, -0.5, distanceField);
  gl_FragColor = color;
  gl_FragColor.a *= u_globalAlpha;
  gl_FragColor.rgb *= gl_FragColor.a;
  if (u_hitDetection > 0) {
    if (gl_FragColor.a < 0.1) { discard; };
    gl_FragColor = v_hitColor;
  }
}`:null}getFillVertexShader(){return this.hasFill_?`${l_}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
attribute vec2 a_position;
attribute vec2 a_hitColor;

varying vec4 v_hitColor;

${this.attributes_.map(e=>`attribute ${e.type} ${e.name};
varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.vertexShaderFunctions_.join(`
`)}
void main(void) {
  gl_Position = u_projectionMatrix * vec4(a_position, u_depth, 1.0);
  v_hitColor = unpackColor(a_hitColor);
${this.attributes_.map(e=>`  ${e.varyingName} = ${e.varyingExpression};`).join(`
`)}
}`:null}getFillFragmentShader(){return this.hasFill_?`${l_}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
varying vec4 v_hitColor;
${this.attributes_.map(e=>`varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.fragmentShaderFunctions_.join(`
`)}
vec2 pxToWorld(vec2 pxPos) {
  vec2 screenPos = 2.0 * pxPos / u_viewportSizePx - 1.0;
  return (u_screenToWorldMatrix * vec4(screenPos, 0.0, 1.0)).xy;
}

vec2 worldToPx(vec2 worldPos) {
  vec4 screenPos = u_projectionMatrix * vec4(worldPos, 0.0, 1.0);
  return (0.5 * screenPos.xy + 0.5) * u_viewportSizePx;
}

void main(void) {
${this.attributes_.map(e=>`  ${e.varyingType} ${e.name} = ${e.varyingName}; // assign to original attribute name`).join(`
`)}
  vec2 pxPos = gl_FragCoord.xy / u_pixelRatio;
  vec2 pxOrigin = worldToPx(u_patternOrigin);
  #ifdef GL_FRAGMENT_PRECISION_HIGH
  vec2 worldPos = pxToWorld(pxPos);
  if (
    abs(u_renderExtent[0] - u_renderExtent[2]) > 0.0 && (
      worldPos[0] < u_renderExtent[0] ||
      worldPos[1] < u_renderExtent[1] ||
      worldPos[0] > u_renderExtent[2] ||
      worldPos[1] > u_renderExtent[3]
    )
  ) {
    discard;
  }
  #endif
  if (${this.discardExpression_}) { discard; }
  gl_FragColor = ${this.fillColorExpression_};
  gl_FragColor.a *= u_globalAlpha;
  gl_FragColor.rgb *= gl_FragColor.a;
  if (u_hitDetection > 0) {
    if (gl_FragColor.a < 0.1) { discard; };
    gl_FragColor = v_hitColor;
  }
}`:null}}class K3{constructor(){this.globalCounter_=0,this.refToFeature_=new Map,this.uidToRef_=new Map,this.freeGlobalRef_=[],this.polygonBatch={entries:{},geometriesCount:0,verticesCount:0,ringsCount:0},this.pointBatch={entries:{},geometriesCount:0},this.lineStringBatch={entries:{},geometriesCount:0,verticesCount:0}}addFeatures(e,n){for(let r=0;r<e.length;r++)this.addFeature(e[r],n)}addFeature(e,n){let r=e.getGeometry();r&&(n&&(r=r.clone(),r.applyTransform(n)),this.addGeometry_(r,e))}clearFeatureEntryInPointBatch_(e){const n=Qt(e),r=this.pointBatch.entries[n];if(r)return this.pointBatch.geometriesCount-=r.flatCoordss.length,delete this.pointBatch.entries[n],r}clearFeatureEntryInLineStringBatch_(e){const n=Qt(e),r=this.lineStringBatch.entries[n];if(r)return this.lineStringBatch.verticesCount-=r.verticesCount,this.lineStringBatch.geometriesCount-=r.flatCoordss.length,delete this.lineStringBatch.entries[n],r}clearFeatureEntryInPolygonBatch_(e){const n=Qt(e),r=this.polygonBatch.entries[n];if(r)return this.polygonBatch.verticesCount-=r.verticesCount,this.polygonBatch.ringsCount-=r.ringsCount,this.polygonBatch.geometriesCount-=r.flatCoordss.length,delete this.polygonBatch.entries[n],r}addGeometry_(e,n){const r=e.getType();switch(r){case"GeometryCollection":{const i=e.getGeometriesArray();for(const s of i)this.addGeometry_(s,n);break}case"MultiPolygon":{const i=e;this.addCoordinates_(r,i.getFlatCoordinates(),i.getEndss(),n,Qt(n),i.getStride());break}case"MultiLineString":{const i=e;this.addCoordinates_(r,i.getFlatCoordinates(),i.getEnds(),n,Qt(n),i.getStride());break}case"MultiPoint":{const i=e;this.addCoordinates_(r,i.getFlatCoordinates(),null,n,Qt(n),i.getStride());break}case"Polygon":{const i=e;this.addCoordinates_(r,i.getFlatCoordinates(),i.getEnds(),n,Qt(n),i.getStride());break}case"Point":{const i=e;this.addCoordinates_(r,i.getFlatCoordinates(),null,n,Qt(n),i.getStride());break}case"LineString":case"LinearRing":{const i=e,s=i.getStride();this.addCoordinates_(r,i.getFlatCoordinates(),null,n,Qt(n),s,i.getLayout?.());break}}}addCoordinates_(e,n,r,i,s,o,a){let l;switch(e){case"MultiPolygon":{const c=r;for(let u=0,h=c.length;u<h;u++){let f=c[u];const g=u>0?c[u-1]:null,y=g?g[g.length-1]:0,_=f[f.length-1];f=y>0?f.map(b=>b-y):f,this.addCoordinates_("Polygon",n.slice(y,_),f,i,s,o,a)}break}case"MultiLineString":{const c=r;for(let u=0,h=c.length;u<h;u++){const f=u>0?c[u-1]:0;this.addCoordinates_("LineString",n.slice(f,c[u]),null,i,s,o,a)}break}case"MultiPoint":for(let c=0,u=n.length;c<u;c+=o)this.addCoordinates_("Point",n.slice(c,c+2),null,i,s,null,null);break;case"Polygon":{const c=r;if(i instanceof gl){const f=Tle(n,c);if(f.length>1){this.addCoordinates_("MultiPolygon",n,f,i,s,o,a);return}}this.polygonBatch.entries[s]||(this.polygonBatch.entries[s]=this.addRefToEntry_(s,{feature:i,flatCoordss:[],verticesCount:0,ringsCount:0,ringsVerticesCounts:[]})),l=n.length/o;const u=r.length,h=r.map((f,g,y)=>g>0?(f-y[g-1])/o:f/o);this.polygonBatch.verticesCount+=l,this.polygonBatch.ringsCount+=u,this.polygonBatch.geometriesCount++,this.polygonBatch.entries[s].flatCoordss.push(FPe(n,o)),this.polygonBatch.entries[s].ringsVerticesCounts.push(h),this.polygonBatch.entries[s].verticesCount+=l,this.polygonBatch.entries[s].ringsCount+=u;for(let f=0,g=c.length;f<g;f++){const y=f>0?c[f-1]:0;this.addCoordinates_("LinearRing",n.slice(y,c[f]),null,i,s,o,a)}break}case"Point":this.pointBatch.entries[s]||(this.pointBatch.entries[s]=this.addRefToEntry_(s,{feature:i,flatCoordss:[]})),this.pointBatch.geometriesCount++,this.pointBatch.entries[s].flatCoordss.push(n);break;case"LineString":case"LinearRing":this.lineStringBatch.entries[s]||(this.lineStringBatch.entries[s]=this.addRefToEntry_(s,{feature:i,flatCoordss:[],verticesCount:0})),l=n.length/o,this.lineStringBatch.verticesCount+=l,this.lineStringBatch.geometriesCount++,this.lineStringBatch.entries[s].flatCoordss.push(VPe(n,o,a)),this.lineStringBatch.entries[s].verticesCount+=l;break}}addRefToEntry_(e,n){const r=this.uidToRef_.get(e),i=r||this.freeGlobalRef_.pop()||++this.globalCounter_;return n.ref=i,r||(this.refToFeature_.set(i,n.feature),this.uidToRef_.set(e,i)),n}removeRef_(e,n){if(!e)throw new Error("This feature has no ref: "+n);this.refToFeature_.delete(e),this.uidToRef_.delete(n),this.freeGlobalRef_.push(e)}changeFeature(e,n){if(!this.uidToRef_.get(Qt(e)))return;this.removeFeature(e);let r=e.getGeometry();r&&(n&&(r=r.clone(),r.applyTransform(n)),this.addGeometry_(r,e))}removeFeature(e){let n=this.clearFeatureEntryInPointBatch_(e);n=this.clearFeatureEntryInPolygonBatch_(e)||n,n=this.clearFeatureEntryInLineStringBatch_(e)||n,n&&this.removeRef_(n.ref,Qt(n.feature))}clear(){this.polygonBatch.entries={},this.polygonBatch.geometriesCount=0,this.polygonBatch.verticesCount=0,this.polygonBatch.ringsCount=0,this.lineStringBatch.entries={},this.lineStringBatch.geometriesCount=0,this.lineStringBatch.verticesCount=0,this.pointBatch.entries={},this.pointBatch.geometriesCount=0,this.globalCounter_=0,this.freeGlobalRef_=[],this.refToFeature_.clear(),this.uidToRef_.clear()}getFeatureFromRef(e){return this.refToFeature_.get(e)}isEmpty(){return this.globalCounter_===0}filter(e){const n=new K3;n.globalCounter_=this.globalCounter_,n.uidToRef_=this.uidToRef_,n.refToFeature_=this.refToFeature_;let r=!0;for(const i of this.refToFeature_.values())e(i)&&(n.addFeature(i),r=!1);return r?new K3:n}}function FPe(t,e){return e===2?t:t.filter((n,r)=>r%e<2)}function VPe(t,e,n){return e===3&&n==="XYM"?t:e===4?t.filter((r,i)=>i%e!==2):e===3?t.map((r,i)=>i%e!==2?r:0):new Array(t.length*1.5).fill(0).map((r,i)=>i%3===2?0:t[Math.round(i/1.5)])}function zPe(){const t='function t(t,n,x=2){const o=n&&n.length,i=o?n[0]*x:t.length;let f=e(t,0,i,x,!0);const l=[];if(!f||f.next===f.prev)return l;let c,y,h;if(o&&(f=function(t,n,r,x){const o=[];for(let r=0,i=n.length;r<i;r++){const f=e(t,n[r]*x,r<i-1?n[r+1]*x:t.length,x,!1);f===f.next&&(f.steiner=!0),o.push(a(f))}o.sort(u);for(let t=0;t<o.length;t++)r=s(o[t],r);return r}(t,n,f,x)),t.length>80*x){c=t[0],y=t[1];let e=c,n=y;for(let r=x;r<i;r+=x){const x=t[r],o=t[r+1];x<c&&(c=x),o<y&&(y=o),x>e&&(e=x),o>n&&(n=o)}h=Math.max(e-c,n-y),h=0!==h?32767/h:0}return r(f,l,x,c,y,h,0),l}function e(t,e,n,r,x){let o;if(x===function(t,e,n,r){let x=0;for(let o=e,i=n-r;o<n;o+=r)x+=(t[i]-t[o])*(t[o+1]+t[i+1]),i=o;return x}(t,e,n,r)>0)for(let x=e;x<n;x+=r)o=d(x/r|0,t[x],t[x+1],o);else for(let x=n-r;x>=e;x-=r)o=d(x/r|0,t[x],t[x+1],o);return o&&b(o,o.next)&&(w(o),o=o.next),o}function n(t,e){if(!t)return t;e||(e=t);let n,r=t;do{if(n=!1,r.steiner||!b(r,r.next)&&0!==v(r.prev,r,r.next))r=r.next;else{if(w(r),r=e=r.prev,r===r.next)break;n=!0}}while(n||r!==e);return e}function r(t,e,u,s,l,a,y){if(!t)return;!y&&a&&function(t,e,n,r){let x=t;do{0===x.z&&(x.z=c(x.x,x.y,e,n,r)),x.prevZ=x.prev,x.nextZ=x.next,x=x.next}while(x!==t);x.prevZ.nextZ=null,x.prevZ=null,function(t){let e,n=1;do{let r,x=t;t=null;let o=null;for(e=0;x;){e++;let i=x,f=0;for(let t=0;t<n&&(f++,i=i.nextZ,i);t++);let u=n;for(;f>0||u>0&&i;)0!==f&&(0===u||!i||x.z<=i.z)?(r=x,x=x.nextZ,f--):(r=i,i=i.nextZ,u--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;x=i}o.nextZ=null,n*=2}while(e>1)}(x)}(t,s,l,a);let h=t;for(;t.prev!==t.next;){const c=t.prev,p=t.next;if(a?o(t,s,l,a):x(t))e.push(c.i,t.i,p.i),w(t),t=p.next,h=p.next;else if((t=p)===h){y?1===y?r(t=i(n(t),e),e,u,s,l,a,2):2===y&&f(t,e,u,s,l,a):r(n(t),e,u,s,l,a,1);break}}}function x(t){const e=t.prev,n=t,r=t.next;if(v(e,n,r)>=0)return!1;const x=e.x,o=n.x,i=r.x,f=e.y,u=n.y,s=r.y,l=Math.min(x,o,i),c=Math.min(f,u,s),a=Math.max(x,o,i),y=Math.max(f,u,s);let p=r.next;for(;p!==e;){if(p.x>=l&&p.x<=a&&p.y>=c&&p.y<=y&&h(x,f,o,u,i,s,p.x,p.y)&&v(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function o(t,e,n,r){const x=t.prev,o=t,i=t.next;if(v(x,o,i)>=0)return!1;const f=x.x,u=o.x,s=i.x,l=x.y,a=o.y,y=i.y,p=Math.min(f,u,s),b=Math.min(l,a,y),M=Math.max(f,u,s),m=Math.max(l,a,y),A=c(p,b,e,n,r),g=c(M,m,e,n,r);let Z=t.prevZ,d=t.nextZ;for(;Z&&Z.z>=A&&d&&d.z<=g;){if(Z.x>=p&&Z.x<=M&&Z.y>=b&&Z.y<=m&&Z!==x&&Z!==i&&h(f,l,u,a,s,y,Z.x,Z.y)&&v(Z.prev,Z,Z.next)>=0)return!1;if(Z=Z.prevZ,d.x>=p&&d.x<=M&&d.y>=b&&d.y<=m&&d!==x&&d!==i&&h(f,l,u,a,s,y,d.x,d.y)&&v(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(;Z&&Z.z>=A;){if(Z.x>=p&&Z.x<=M&&Z.y>=b&&Z.y<=m&&Z!==x&&Z!==i&&h(f,l,u,a,s,y,Z.x,Z.y)&&v(Z.prev,Z,Z.next)>=0)return!1;Z=Z.prevZ}for(;d&&d.z<=g;){if(d.x>=p&&d.x<=M&&d.y>=b&&d.y<=m&&d!==x&&d!==i&&h(f,l,u,a,s,y,d.x,d.y)&&v(d.prev,d,d.next)>=0)return!1;d=d.nextZ}return!0}function i(t,e){let r=t;do{const n=r.prev,x=r.next.next;!b(n,x)&&M(n,r,r.next,x)&&g(n,x)&&g(x,n)&&(e.push(n.i,r.i,x.i),w(r),w(r.next),r=t=x),r=r.next}while(r!==t);return n(r)}function f(t,e,x,o,i,f){let u=t;do{let t=u.next.next;for(;t!==u.prev;){if(u.i!==t.i&&p(u,t)){let s=Z(u,t);return u=n(u,u.next),s=n(s,s.next),r(u,e,x,o,i,f,0),void r(s,e,x,o,i,f,0)}t=t.next}u=u.next}while(u!==t)}function u(t,e){let n=t.x-e.x;if(0===n&&(n=t.y-e.y,0===n)){n=(t.next.y-t.y)/(t.next.x-t.x)-(e.next.y-e.y)/(e.next.x-e.x)}return n}function s(t,e){const r=function(t,e){let n=e;const r=t.x,x=t.y;let o,i=-1/0;if(b(t,n))return n;do{if(b(t,n.next))return n.next;if(x<=n.y&&x>=n.next.y&&n.next.y!==n.y){const t=n.x+(x-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(t<=r&&t>i&&(i=t,o=n.x<n.next.x?n:n.next,t===r))return o}n=n.next}while(n!==e);if(!o)return null;const f=o,u=o.x,s=o.y;let c=1/0;n=o;do{if(r>=n.x&&n.x>=u&&r!==n.x&&y(x<s?r:i,x,u,s,x<s?i:r,x,n.x,n.y)){const e=Math.abs(x-n.y)/(r-n.x);g(n,t)&&(e<c||e===c&&(n.x>o.x||n.x===o.x&&l(o,n)))&&(o=n,c=e)}n=n.next}while(n!==f);return o}(t,e);if(!r)return e;const x=Z(r,t);return n(x,x.next),n(r,r.next)}function l(t,e){return v(t.prev,t,e.prev)<0&&v(e.next,t,t.next)<0}function c(t,e,n,r,x){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*x|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*x|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function a(t){let e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function y(t,e,n,r,x,o,i,f){return(x-i)*(e-f)>=(t-i)*(o-f)&&(t-i)*(r-f)>=(n-i)*(e-f)&&(n-i)*(o-f)>=(x-i)*(r-f)}function h(t,e,n,r,x,o,i,f){return!(t===i&&e===f)&&y(t,e,n,r,x,o,i,f)}function p(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&M(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(g(t,e)&&g(e,t)&&function(t,e){let n=t,r=!1;const x=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&x<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)&&(v(t.prev,t,e.prev)||v(t,e.prev,e))||b(t,e)&&v(t.prev,t,t.next)>0&&v(e.prev,e,e.next)>0)}function v(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function b(t,e){return t.x===e.x&&t.y===e.y}function M(t,e,n,r){const x=A(v(t,e,n)),o=A(v(t,e,r)),i=A(v(n,r,t)),f=A(v(n,r,e));return x!==o&&i!==f||(!(0!==x||!m(t,n,e))||(!(0!==o||!m(t,r,e))||(!(0!==i||!m(n,t,r))||!(0!==f||!m(n,e,r)))))}function m(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function A(t){return t>0?1:t<0?-1:0}function g(t,e){return v(t.prev,t,t.next)<0?v(t,e,t.next)>=0&&v(t,t.prev,e)>=0:v(t,e,t.prev)<0||v(t,t.next,e)<0}function Z(t,e){const n=F(t.i,t.x,t.y),r=F(e.i,e.x,e.y),x=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=x,x.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function d(t,e,n,r){const x=F(t,e,n);return r?(x.next=r.next,x.prev=r,r.next.prev=x,r.next=x):(x.prev=x,x.next=x),x}function w(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function F(t,e,n){return{i:t,x:e,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function E(t,e){const n=e[0],r=e[1];return e[0]=t[0]*n+t[2]*r+t[4],e[1]=t[1]*n+t[3]*r+t[5],e}function I(t,e){const n=(r=e)[0]*r[3]-r[1]*r[2];var r;!function(t,e){if(!t)throw new Error(e)}(0!==n,"Transformation matrix cannot be inverted");const x=e[0],o=e[1],i=e[2],f=e[3],u=e[4],s=e[5];return t[0]=f/n,t[1]=-o/n,t[2]=-i/n,t[3]=x/n,t[4]=(i*s-f*u)/n,t[5]=-(x*s-o*u)/n,t}new Array(6);const z=[],B={vertexAttributesPosition:0,instanceAttributesPosition:0,indicesPosition:0};function P(t,e,n,r,x){const o=t[e++],i=t[e++],f=z;f.length=r;for(let n=0;n<f.length;n++)f[n]=t[e+n];let u=x?x.instanceAttributesPosition:0;return n[u++]=o,n[u++]=i,f.length&&(n.set(f,u),u+=f.length),B.instanceAttributesPosition=u,B}function N(t,e,n,r,x,o,i,f,u,s){const l=[t[e],t[e+1]],c=[t[n],t[n+1]],a=t[e+2],y=t[n+2],h=E(f,[...l]),p=E(f,[...c]);function v(t,e,n){const r=Math.sqrt((e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1])),x=[(e[0]-t[0])/r,(e[1]-t[1])/r],o=[-x[1],x[0]],i=Math.sqrt((n[0]-t[0])*(n[0]-t[0])+(n[1]-t[1])*(n[1]-t[1])),f=[(n[0]-t[0])/i,(n[1]-t[1])/i];let u=0===r||0===i?0:Math.acos((s=f[0]*x[0]+f[1]*x[1],l=-1,c=1,Math.min(Math.max(s,l),c)));var s,l,c;u=Math.max(u,1e-5);return f[0]*o[0]+f[1]*o[1]>0?u:2*Math.PI-u}let b=-1,M=-1,m=s;const A=null!==x;if(null!==r){b=v(h,p,E(f,[...[t[r],t[r+1]]])),Math.cos(b)<=.985&&(m+=Math.tan((b-Math.PI)/2))}if(A){M=v(p,h,E(f,[...[t[x],t[x+1]]])),Math.cos(M)<=.985&&(m+=Math.tan((Math.PI-M)/2))}const g=Math.pow(2,24),Z=u%g,d=Math.floor(u/g)*g;return o.push(l[0],l[1],a,c[0],c[1],y,b,M,Z,d,s),o.push(...i),{length:u+Math.sqrt((p[0]-h[0])*(p[0]-h[0])+(p[1]-h[1])*(p[1]-h[1])),angle:m}}function R(e,n,r,x,o){const i=2+o;let f=n;const u=e.slice(f,f+o);f+=o;const s=e[f++];let l=0;const c=new Array(s-1);for(let t=0;t<s;t++)l+=e[f++],t<s-1&&(c[t]=l);const a=e.slice(f,f+2*l),y=t(a,c,2);for(let t=0;t<y.length;t++)x.push(y[t]+r.length/i);for(let t=0;t<a.length;t+=2)r.push(a[t],a[t+1],...u);return f+2*l}const S="GENERATE_POLYGON_BUFFERS",T="GENERATE_POINT_BUFFERS",_="GENERATE_LINE_STRING_BUFFERS",O=self;O.onmessage=t=>{const e=t.data;switch(e.type){case T:{const t=2,n=2,r=e.customAttributesSize,x=n+r,o=new Float32Array(e.renderInstructions),i=o.length/x*(t+r),f=Uint32Array.from([0,1,3,1,2,3]),u=Float32Array.from([-1,-1,1,-1,1,1,-1,1]),s=new Float32Array(i);let l;for(let t=0;t<o.length;t+=x)l=P(o,t,s,r,l);const c=Object.assign({indicesBuffer:f.buffer,vertexAttributesBuffer:u.buffer,instanceAttributesBuffer:s.buffer,renderInstructions:o.buffer},e);O.postMessage(c,[u.buffer,s.buffer,f.buffer,o.buffer]);break}case _:{const t=[],n=e.customAttributesSize,r=3,x=new Float32Array(e.renderInstructions);let o=0;const i=[1,0,0,1,0,0];let f,u;for(I(i,e.renderInstructionsTransform);o<x.length;){u=Array.from(x.slice(o,o+n)),o+=n,f=x[o++];const e=o,s=o+(f-1)*r,l=x[e]===x[s]&&x[e+1]===x[s+1];let c=0,a=0;for(let n=0;n<f-1;n++){let y=null;n>0?y=o+(n-1)*r:l&&(y=s-r);let h=null;n<f-2?h=o+(n+2)*r:l&&(h=e+r);const p=N(x,o+n*r,o+(n+1)*r,y,h,t,u,i,c,a);c=p.length,a=p.angle}o+=f*r}const s=Uint32Array.from([0,1,3,1,2,3]),l=Float32Array.from([-1,-1,1,-1,1,1,-1,1]),c=Float32Array.from(t),a=Object.assign({indicesBuffer:s.buffer,vertexAttributesBuffer:l.buffer,instanceAttributesBuffer:c.buffer,renderInstructions:x.buffer},e);O.postMessage(a,[l.buffer,c.buffer,s.buffer,x.buffer]);break}case S:{const t=[],n=[],r=e.customAttributesSize,x=new Float32Array(e.renderInstructions);let o=0;for(;o<x.length;)o=R(x,o,t,n,r);const i=Uint32Array.from(n),f=Float32Array.from(t),u=Float32Array.from([]),s=Object.assign({indicesBuffer:i.buffer,vertexAttributesBuffer:f.buffer,instanceAttributesBuffer:u.buffer,renderInstructions:x.buffer},e);O.postMessage(s,[f.buffer,u.buffer,i.buffer,x.buffer]);break}}};';return new Worker(typeof Blob>"u"?"data:application/javascript;base64,"+Buffer.from(t,"binary").toString("base64"):URL.createObjectURL(new Blob([t],{type:"application/javascript"})))}const z6={GENERATE_POLYGON_BUFFERS:"GENERATE_POLYGON_BUFFERS",GENERATE_POINT_BUFFERS:"GENERATE_POINT_BUFFERS",GENERATE_LINE_STRING_BUFFERS:"GENERATE_LINE_STRING_BUFFERS"};function GPe(t,e){e=e||[];const n=256,r=n-1,i=Math.floor(t/n/n/n)/r,s=Math.floor(t/n/n)%n/r,o=Math.floor(t/n)%n/r,a=t%n/r;return e[0]=i*256*255+s*255,e[1]=o*256*255+a*255,e}function UPe(t){let e=0;const n=256,r=n-1;return e+=Math.round(t[0]*n*n*n*r),e+=Math.round(t[1]*n*n*r),e+=Math.round(t[2]*n*r),e+=Math.round(t[3]*r),e}function $G(t,e,n,r){let i=0;for(const s in e){const o=e[s],a=o.callback.call(n,n.feature);let l=a?.[0]??a;l===qF&&console.warn('The "has" operator might return false positives.'),l===void 0?l=qF:l===null&&(l=0),t[r+i++]=l,!(!o.size||o.size===1)&&(t[r+i++]=a[1],!(o.size<3)&&(t[r+i++]=a[2],!(o.size<4)&&(t[r+i++]=a[3])))}return i}function L5(t){return Object.keys(t).reduce((e,n)=>e+(t[n].size||1),0)}function BPe(t,e,n,r){const i=(2+L5(n))*t.geometriesCount;(!e||e.length!==i)&&(e=new Float32Array(i));const s=[];let o=0;for(const a in t.entries){const l=t.entries[a];for(let c=0,u=l.flatCoordss.length;c<u;c++)s[0]=l.flatCoordss[c][0],s[1]=l.flatCoordss[c][1],Zi(r,s),e[o++]=s[0],e[o++]=s[1],o+=$G(e,n,l,o)}return e}function WPe(t,e,n,r){const i=3*t.verticesCount+(1+L5(n))*t.geometriesCount;(!e||e.length!==i)&&(e=new Float32Array(i));const s=[];let o=0;for(const a in t.entries){const l=t.entries[a];for(let c=0,u=l.flatCoordss.length;c<u;c++){s.length=l.flatCoordss[c].length,vd(l.flatCoordss[c],0,s.length,3,r,s,3),o+=$G(e,n,l,o),e[o++]=s.length/3;for(let h=0,f=s.length;h<f;h+=3)e[o++]=s[h],e[o++]=s[h+1],e[o++]=s[h+2]}}return e}function HPe(t,e,n,r){const i=2*t.verticesCount+(1+L5(n))*t.geometriesCount+t.ringsCount;(!e||e.length!==i)&&(e=new Float32Array(i));const s=[];let o=0;for(const a in t.entries){const l=t.entries[a];for(let c=0,u=l.flatCoordss.length;c<u;c++){s.length=l.flatCoordss[c].length,vd(l.flatCoordss[c],0,s.length,2,r,s),o+=$G(e,n,l,o),e[o++]=l.ringsVerticesCounts[c].length;for(let h=0,f=l.ringsVerticesCounts[c].length;h<f;h++)e[o++]=l.ringsVerticesCounts[c][h];for(let h=0,f=s.length;h<f;h+=2)e[o++]=s[h],e[o++]=s[h+1]}}return e}function Y3(t){return(JSON.stringify(t).split("").reduce((n,r)=>(n<<5)-n+r.charCodeAt(0),0)>>>0).toString()}function FG(t,e,n,r){if(`${r}radius`in t&&r!=="icon-"){let i=An(n,t[`${r}radius`],Wt);if(`${r}radius2`in t){const s=An(n,t[`${r}radius2`],Wt);i=`max(${i}, ${s})`}`${r}stroke-width`in t&&(i=`(${i} + ${An(n,t[`${r}stroke-width`],Wt)} * 0.5)`),e.setSymbolSizeExpression(`vec2(${i} * 2. + 0.5)`)}if(`${r}scale`in t){const i=An(n,t[`${r}scale`],ru);e.setSymbolSizeExpression(`${e.getSymbolSizeExpression()} * ${i}`)}`${r}displacement`in t&&e.setSymbolOffsetExpression(An(n,t[`${r}displacement`],Al)),`${r}rotation`in t&&e.setSymbolRotationExpression(An(n,t[`${r}rotation`],Wt)),`${r}rotate-with-view`in t&&e.setSymbolRotateWithView(!!t[`${r}rotate-with-view`])}function lce(t,e,n,r,i){let s="vec4(0.)";if(e!==null&&(s=e),n!==null&&r!==null){const l=`smoothstep(-${r} + 0.63, -${r} - 0.58, ${t})`;s=`mix(${n}, ${s}, ${l})`}const o=`(1.0 - smoothstep(-0.63, 0.58, ${t}))`;let a=`${s} * vec4(1.0, 1.0, 1.0, ${o})`;return i!==null&&(a=`${a} * vec4(1.0, 1.0, 1.0, ${i})`),a}function VG(t,e,n,r,i){const s=new Image;s.crossOrigin=t[`${r}cross-origin`]===void 0?"anonymous":t[`${r}cross-origin`],ur(typeof t[`${r}src`]=="string",`WebGL layers do not support expressions for the ${r}src style property`),s.src=t[`${r}src`],n[`u_texture${i}_size`]=()=>s.complete?[s.width,s.height]:[0,0],e.addUniform(`u_texture${i}_size`,"vec2");const o=`u_texture${i}_size`;return n[`u_texture${i}`]=s,e.addUniform(`u_texture${i}`,"sampler2D"),o}function zG(t,e,n,r,i){let s=An(n,t[`${e}offset`],ru);if(`${e}offset-origin`in t)switch(t[`${e}offset-origin`]){case"top-right":s=`vec2(${r}.x, 0.) + ${i} * vec2(-1., 0.) + ${s} * vec2(-1., 1.)`;break;case"bottom-left":s=`vec2(0., ${r}.y) + ${i} * vec2(0., -1.) + ${s} * vec2(1., -1.)`;break;case"bottom-right":s=`${r} - ${i} - ${s}`;break}return s}function qPe(t,e,n,r){r.functions.circleDistanceField=`float circleDistanceField(vec2 point, float radius) {
  return length(point) - radius;
}`,FG(t,e,r,"circle-");let i=null;"circle-opacity"in t&&(i=An(r,t["circle-opacity"],Wt));let s="coordsPx";"circle-scale"in t&&(s=`coordsPx / ${An(r,t["circle-scale"],ru)}`);let o=null;"circle-fill-color"in t&&(o=An(r,t["circle-fill-color"],Ei));let a=null;"circle-stroke-color"in t&&(a=An(r,t["circle-stroke-color"],Ei));let l=An(r,t["circle-radius"],Wt),c=null;"circle-stroke-width"in t&&(c=An(r,t["circle-stroke-width"],Wt),l=`(${l} + ${c} * 0.5)`);const u=`circleDistanceField(${s}, ${l})`,h=lce(u,o,a,c,i);e.setSymbolColorExpression(h)}function KPe(t,e,n,r){r.functions.round=`float round(float v) {
  return sign(v) * floor(abs(v) + 0.5);
}`,r.functions.starDistanceField=`float starDistanceField(vec2 point, float numPoints, float radius, float radius2, float angle) {
  float startAngle = -PI * 0.5 + angle; // tip starts upwards and rotates clockwise with angle
  float c = cos(startAngle);
  float s = sin(startAngle);
  vec2 pointRotated = vec2(c * point.x - s * point.y, s * point.x + c * point.y);
  float alpha = TWO_PI / numPoints; // the angle of one sector
  float beta = atan(pointRotated.y, pointRotated.x);
  float gamma = round(beta / alpha) * alpha; // angle in sector
  c = cos(-gamma);
  s = sin(-gamma);
  vec2 inSector = vec2(c * pointRotated.x - s * pointRotated.y, abs(s * pointRotated.x + c * pointRotated.y));
  vec2 tipToPoint = inSector + vec2(-radius, 0.);
  vec2 edgeNormal = vec2(radius2 * sin(alpha * 0.5), -radius2 * cos(alpha * 0.5) + radius);
  return dot(normalize(edgeNormal), tipToPoint);
}`,r.functions.regularDistanceField=`float regularDistanceField(vec2 point, float numPoints, float radius, float angle) {
  float startAngle = -PI * 0.5 + angle; // tip starts upwards and rotates clockwise with angle
  float c = cos(startAngle);
  float s = sin(startAngle);
  vec2 pointRotated = vec2(c * point.x - s * point.y, s * point.x + c * point.y);
  float alpha = TWO_PI / numPoints; // the angle of one sector
  float radiusIn = radius * cos(PI / numPoints);
  float beta = atan(pointRotated.y, pointRotated.x);
  float gamma = round((beta - alpha * 0.5) / alpha) * alpha + alpha * 0.5; // angle in sector from mid
  c = cos(-gamma);
  s = sin(-gamma);
  vec2 inSector = vec2(c * pointRotated.x - s * pointRotated.y, abs(s * pointRotated.x + c * pointRotated.y));
  return inSector.x - radiusIn;
}`,FG(t,e,r,"shape-");let i=null;"shape-opacity"in t&&(i=An(r,t["shape-opacity"],Wt));let s="coordsPx";"shape-scale"in t&&(s=`coordsPx / ${An(r,t["shape-scale"],ru)}`);let o=null;"shape-fill-color"in t&&(o=An(r,t["shape-fill-color"],Ei));let a=null;"shape-stroke-color"in t&&(a=An(r,t["shape-stroke-color"],Ei));let l=null;"shape-stroke-width"in t&&(l=An(r,t["shape-stroke-width"],Wt));const c=An(r,t["shape-points"],Wt);let u="0.";"shape-angle"in t&&(u=An(r,t["shape-angle"],Wt));let h,f=An(r,t["shape-radius"],Wt);if(l!==null&&(f=`${f} + ${l} * 0.5`),"shape-radius2"in t){let y=An(r,t["shape-radius2"],Wt);l!==null&&(y=`${y} + ${l} * 0.5`),h=`starDistanceField(${s}, ${c}, ${f}, ${y}, ${u})`}else h=`regularDistanceField(${s}, ${c}, ${f}, ${u})`;const g=lce(h,o,a,l,i);e.setSymbolColorExpression(g)}function YPe(t,e,n,r){let i="vec4(1.0)";"icon-color"in t&&(i=An(r,t["icon-color"],Ei)),"icon-opacity"in t&&(i=`${i} * vec4(1.0, 1.0, 1.0, ${An(r,t["icon-opacity"],Wt)})`);const s=Y3(t["icon-src"]),o=VG(t,e,n,"icon-",s);if(e.setSymbolColorExpression(`${i} * texture2D(u_texture${s}, v_texCoord)`).setSymbolSizeExpression(o),"icon-width"in t&&"icon-height"in t&&e.setSymbolSizeExpression(`vec2(${An(r,t["icon-width"],Wt)}, ${An(r,t["icon-height"],Wt)})`),"icon-offset"in t&&"icon-size"in t){const a=An(r,t["icon-size"],Al),l=e.getSymbolSizeExpression();e.setSymbolSizeExpression(a);const c=zG(t,"icon-",r,"v_quadSizePx",a);e.setTextureCoordinateExpression(`(vec4((${c}).xyxy) + vec4(0., 0., ${a})) / (${l}).xyxy`)}if(FG(t,e,r,"icon-"),"icon-anchor"in t){const a=An(r,t["icon-anchor"],Al);let l="1.0";"icon-scale"in t&&(l=An(r,t["icon-scale"],ru));let c;t["icon-anchor-x-units"]==="pixels"&&t["icon-anchor-y-units"]==="pixels"?c=`${a} * ${l}`:t["icon-anchor-x-units"]==="pixels"?c=`${a} * vec2(vec2(${l}).x, v_quadSizePx.y)`:t["icon-anchor-y-units"]==="pixels"?c=`${a} * vec2(v_quadSizePx.x, vec2(${l}).x)`:c=`${a} * v_quadSizePx`;let u=`v_quadSizePx * vec2(0.5, -0.5) + ${c} * vec2(-1., 1.)`;if("icon-anchor-origin"in t)switch(t["icon-anchor-origin"]){case"top-right":u=`v_quadSizePx * -0.5 + ${c}`;break;case"bottom-left":u=`v_quadSizePx * 0.5 - ${c}`;break;case"bottom-right":u=`v_quadSizePx * vec2(-0.5, 0.5) + ${c} * vec2(1., -1.)`;break}e.setSymbolOffsetExpression(`${e.getSymbolOffsetExpression()} + ${u}`)}}function XPe(t,e,n,r){if("stroke-color"in t&&e.setStrokeColorExpression(An(r,t["stroke-color"],Ei)),"stroke-pattern-src"in t){const i=Y3(t["stroke-pattern-src"]),s=VG(t,e,n,"stroke-pattern-",i);let o=s,a="vec2(0.)";"stroke-pattern-offset"in t&&"stroke-pattern-size"in t&&(o=An(r,t["stroke-pattern-size"],Al),a=zG(t,"stroke-pattern-",r,s,o));let l="0.";"stroke-pattern-spacing"in t&&(l=An(r,t["stroke-pattern-spacing"],Wt));let c="0.";"stroke-pattern-start-offset"in t&&(c=An(r,t["stroke-pattern-start-offset"],Wt)),r.functions.sampleStrokePattern=`vec4 sampleStrokePattern(sampler2D texture, vec2 textureSize, vec2 textureOffset, vec2 sampleSize, float spacingPx, float startOffsetPx, float currentLengthPx, float currentRadiusRatio, float lineWidth) {
  float currentLengthScaled = (currentLengthPx - startOffsetPx) * sampleSize.y / lineWidth;
  float spacingScaled = spacingPx * sampleSize.y / lineWidth;
  float uCoordPx = mod(currentLengthScaled, (sampleSize.x + spacingScaled));
  float isInsideOfPattern = step(uCoordPx, sampleSize.x);
  float vCoordPx = (-currentRadiusRatio * 0.5 + 0.5) * sampleSize.y;
  // make sure that we're not sampling too close to the borders to avoid interpolation with outside pixels
  uCoordPx = clamp(uCoordPx, 0.5, sampleSize.x - 0.5);
  vCoordPx = clamp(vCoordPx, 0.5, sampleSize.y - 0.5);
  vec2 texCoord = (vec2(uCoordPx, vCoordPx) + textureOffset) / textureSize;
  return texture2D(texture, texCoord) * vec4(1.0, 1.0, 1.0, isInsideOfPattern);
}`;const u=`u_texture${i}`;let h="1.";"stroke-color"in t&&(h=e.getStrokeColorExpression()),e.setStrokeColorExpression(`${h} * sampleStrokePattern(${u}, ${s}, ${a}, ${o}, ${l}, ${c}, currentLengthPx, currentRadiusRatio, v_width)`),r.functions.computeStrokePatternLength=`float computeStrokePatternLength(vec2 sampleSize, float spacingPx, float lineWidth) {
  float patternLengthPx = sampleSize.x / sampleSize.y * lineWidth;
  return patternLengthPx + spacingPx;
}`,e.setStrokePatternLengthExpression(`computeStrokePatternLength(${o}, ${l}, v_width)`)}if("stroke-width"in t&&e.setStrokeWidthExpression(An(r,t["stroke-width"],Wt)),"stroke-offset"in t&&e.setStrokeOffsetExpression(An(r,t["stroke-offset"],Wt)),"stroke-line-cap"in t&&e.setStrokeCapExpression(An(r,t["stroke-line-cap"],Us)),"stroke-line-join"in t&&e.setStrokeJoinExpression(An(r,t["stroke-line-join"],Us)),"stroke-miter-limit"in t&&e.setStrokeMiterLimitExpression(An(r,t["stroke-miter-limit"],Wt)),"stroke-line-dash"in t){r.functions.getSingleDashDistance=`float getSingleDashDistance(float distance, float radius, float dashOffset, float dashLength, float dashLengthTotal, float capType, float lineWidth) {
  float localDistance = mod(distance, dashLengthTotal);
  float distanceSegment = abs(localDistance - dashOffset - dashLength * 0.5) - dashLength * 0.5;
  distanceSegment = min(distanceSegment, dashLengthTotal - localDistance);
  if (capType == ${$f("square")}) {
    distanceSegment -= lineWidth * 0.5;
  } else if (capType == ${$f("round")}) {
    distanceSegment = min(distanceSegment, sqrt(distanceSegment * distanceSegment + radius * radius) - lineWidth * 0.5);
  }
  return distanceSegment;
}`;let i=t["stroke-line-dash"].map(y=>An(r,y,Wt));i.length%2===1&&(i=[...i,...i]);let s="0.";"stroke-line-dash-offset"in t&&(s=An(r,t["stroke-line-dash-offset"],Wt));const a=`dashDistanceField_${Y3(t["stroke-line-dash"])}`,l=i.map((y,_)=>`float dashLength${_}`).join(", "),c=i.map((y,_)=>`dashLength${_}`).join(" + ");let u="0.",h=`getSingleDashDistance(distance, radius, ${u}, dashLength0, totalDashLength, capType, lineWidth)`;for(let y=2;y<i.length;y+=2)u=`${u} + dashLength${y-2} + dashLength${y-1}`,h=`min(${h}, getSingleDashDistance(distance, radius, ${u}, dashLength${y}, totalDashLength, capType, lineWidth))`;r.functions[a]=`float ${a}(float distance, float radius, float capType, float lineWidth, ${l}) {
  float totalDashLength = ${c};
  return ${h};
}`;const f=i.map((y,_)=>`${y}`).join(", ");e.setStrokeDistanceFieldExpression(`${a}(currentLengthPx + ${s}, currentRadiusPx, capType, v_width, ${f})`);let g=i.join(" + ");e.getStrokePatternLengthExpression()&&(r.functions.combinePatternLengths=`float combinePatternLengths(float patternLength1, float patternLength2) {
  return patternLength1 * patternLength2;
}`,g=`combinePatternLengths(${e.getStrokePatternLengthExpression()}, ${g})`),e.setStrokePatternLengthExpression(g)}}function ZPe(t,e,n,r){if("fill-color"in t&&e.setFillColorExpression(An(r,t["fill-color"],Ei)),"fill-pattern-src"in t){const i=Y3(t["fill-pattern-src"]),s=VG(t,e,n,"fill-pattern-",i);let o=s,a="vec2(0.)";"fill-pattern-offset"in t&&"fill-pattern-size"in t&&(o=An(r,t["fill-pattern-size"],Al),a=zG(t,"fill-pattern-",r,s,o)),r.functions.sampleFillPattern=`vec4 sampleFillPattern(sampler2D texture, vec2 textureSize, vec2 textureOffset, vec2 sampleSize, vec2 pxOrigin, vec2 pxPosition) {
  float scaleRatio = pow(2., mod(u_zoom + 0.5, 1.) - 0.5);
  vec2 pxRelativePos = pxPosition - pxOrigin;
  // rotate the relative position from origin by the current view rotation
  pxRelativePos = vec2(pxRelativePos.x * cos(u_rotation) - pxRelativePos.y * sin(u_rotation), pxRelativePos.x * sin(u_rotation) + pxRelativePos.y * cos(u_rotation));
  // sample position is computed according to the sample offset & size
  vec2 samplePos = mod(pxRelativePos / scaleRatio, sampleSize);
  // also make sure that we're not sampling too close to the borders to avoid interpolation with outside pixels
  samplePos = clamp(samplePos, vec2(0.5), sampleSize - vec2(0.5));
  samplePos.y = sampleSize.y - samplePos.y; // invert y axis so that images appear upright
  return texture2D(texture, (samplePos + textureOffset) / textureSize);
}`;const l=`u_texture${i}`;let c="1.";"fill-color"in t&&(c=e.getFillColorExpression()),e.setFillColorExpression(`${c} * sampleFillPattern(${l}, ${s}, ${a}, ${o}, pxOrigin, pxPos)`)}}function hZ(t,e,n){const r=tce(),i=new ace,s={};if("icon-src"in t?YPe(t,i,s,r):"shape-points"in t?KPe(t,i,s,r):"circle-radius"in t&&qPe(t,i,s,r),XPe(t,i,s,r),ZPe(t,i,s,r),n){const l=An(r,n,Is);i.setFragmentDiscardExpression(`!${l}`)}const o={};function a(l,c,u,h){if(!r[l])return;const f=KF(u),g=jG(u);i.addAttribute(`a_${c}`,f),o[c]={size:g,callback:h}}return a("geometryType",rce,Us,l=>xk(EG(l.getGeometry()))),a("featureId",nce,Us|Wt,l=>{const c=l.getId()??null;return typeof c=="string"?xk(c):c}),ice(i,r),{builder:i,attributes:{...o,...oce(r)},uniforms:{...s,...sce(r,e)}}}const JPe=[];let G6;function QPe(){return G6||(G6=zPe()),G6}let eCe=0;const Nc={POSITION:"a_position",LOCAL_POSITION:"a_localPosition",SEGMENT_START:"a_segmentStart",SEGMENT_END:"a_segmentEnd",MEASURE_START:"a_measureStart",MEASURE_END:"a_measureEnd",ANGLE_TANGENT_SUM:"a_angleTangentSum",JOIN_ANGLES:"a_joinAngles",DISTANCE_LOW:"a_distanceLow",DISTANCE_HIGH:"a_distanceHigh"};class tCe{constructor(e,n,r,i){this.helper_,this.hitDetectionEnabled_=!!i,this.styleShaders=nCe(e,n),this.customAttributes_={},this.uniforms_={},this.hitDetectionEnabled_&&(this.customAttributes_.hitColor={callback(){return GPe(this.ref,JPe)},size:2});for(const s of this.styleShaders){for(const o in s.attributes)o in this.customAttributes_||(this.customAttributes_[o]=s.attributes[o]);for(const o in s.uniforms)o in this.uniforms_||(this.uniforms_[o]=s.uniforms[o])}this.renderPasses_=this.styleShaders.map(s=>{const o={},a=Object.entries(this.customAttributes_).map(([l,c])=>({name:l in s.attributes||l==="hitColor"?`a_${l}`:null,size:c.size||1,type:Ao.FLOAT}));return s.builder.getFillVertexShader()&&(o.fillRenderPass={vertexShader:s.builder.getFillVertexShader(),fragmentShader:s.builder.getFillFragmentShader(),attributesDesc:[{name:Nc.POSITION,size:2,type:Ao.FLOAT},...a],instancedAttributesDesc:[],instancePrimitiveVertexCount:3}),s.builder.getStrokeVertexShader()&&(o.strokeRenderPass={vertexShader:s.builder.getStrokeVertexShader(),fragmentShader:s.builder.getStrokeFragmentShader(),attributesDesc:[{name:Nc.LOCAL_POSITION,size:2,type:Ao.FLOAT}],instancedAttributesDesc:[{name:Nc.SEGMENT_START,size:2,type:Ao.FLOAT},{name:Nc.MEASURE_START,size:1,type:Ao.FLOAT},{name:Nc.SEGMENT_END,size:2,type:Ao.FLOAT},{name:Nc.MEASURE_END,size:1,type:Ao.FLOAT},{name:Nc.JOIN_ANGLES,size:2,type:Ao.FLOAT},{name:Nc.DISTANCE_LOW,size:1,type:Ao.FLOAT},{name:Nc.DISTANCE_HIGH,size:1,type:Ao.FLOAT},{name:Nc.ANGLE_TANGENT_SUM,size:1,type:Ao.FLOAT},...a],instancePrimitiveVertexCount:6}),s.builder.getSymbolVertexShader()&&(o.symbolRenderPass={vertexShader:s.builder.getSymbolVertexShader(),fragmentShader:s.builder.getSymbolFragmentShader(),attributesDesc:[{name:Nc.LOCAL_POSITION,size:2,type:Ao.FLOAT}],instancedAttributesDesc:[{name:Nc.POSITION,size:2,type:Ao.FLOAT},...a],instancePrimitiveVertexCount:6}),o}),this.hasFill_=this.renderPasses_.some(s=>s.fillRenderPass),this.hasStroke_=this.renderPasses_.some(s=>s.strokeRenderPass),this.hasSymbol_=this.renderPasses_.some(s=>s.symbolRenderPass),this.setHelper(r)}async generateBuffers(e,n){if(e.isEmpty())return null;const r=this.generateRenderInstructions_(e,n),[i,s,o]=await Promise.all([this.generateBuffersForType_(r.polygonInstructions,"Polygon",n),this.generateBuffersForType_(r.lineStringInstructions,"LineString",n),this.generateBuffersForType_(r.pointInstructions,"Point",n)]),a=hk(Ws(),n);return{polygonBuffers:i,lineStringBuffers:s,pointBuffers:o,invertVerticesTransform:a}}generateRenderInstructions_(e,n){const r=this.hasFill_?HPe(e.polygonBatch,new Float32Array(0),this.customAttributes_,n):null,i=this.hasStroke_?WPe(e.lineStringBatch,new Float32Array(0),this.customAttributes_,n):null,s=this.hasSymbol_?BPe(e.pointBatch,new Float32Array(0),this.customAttributes_,n):null;return{polygonInstructions:r,lineStringInstructions:i,pointInstructions:s}}generateBuffersForType_(e,n,r){if(e===null)return null;const i=eCe++;let s;switch(n){case"Polygon":s=z6.GENERATE_POLYGON_BUFFERS;break;case"LineString":s=z6.GENERATE_LINE_STRING_BUFFERS;break;case"Point":s=z6.GENERATE_POINT_BUFFERS;break}const o={id:i,type:s,renderInstructions:e.buffer,renderInstructionsTransform:r,customAttributesSize:L5(this.customAttributes_)},a=QPe();return a.postMessage(o,[e.buffer]),e=null,new Promise(l=>{const c=u=>{const h=u.data;if(h.id!==i||(a.removeEventListener("message",c),!this.helper_.getGL()))return;const f=new L6(CG,O6).fromArrayBuffer(h.indicesBuffer),g=new L6(B3,O6).fromArrayBuffer(h.vertexAttributesBuffer),y=new L6(B3,O6).fromArrayBuffer(h.instanceAttributesBuffer);this.helper_.flushBufferData(f),this.helper_.flushBufferData(g),this.helper_.flushBufferData(y),l([f,g,y])};a.addEventListener("message",c)})}render(e,n,r){for(const i of this.renderPasses_)i.fillRenderPass&&this.renderInternal_(e.polygonBuffers[0],e.polygonBuffers[1],e.polygonBuffers[2],i.fillRenderPass,n,r),i.strokeRenderPass&&this.renderInternal_(e.lineStringBuffers[0],e.lineStringBuffers[1],e.lineStringBuffers[2],i.strokeRenderPass,n,r),i.symbolRenderPass&&this.renderInternal_(e.pointBuffers[0],e.pointBuffers[1],e.pointBuffers[2],i.symbolRenderPass,n,r)}renderInternal_(e,n,r,i,s,o){const a=e.getSize();if(a===0)return;const l=i.instancedAttributesDesc.length;if(this.helper_.useProgram(i.program,s),this.helper_.bindBuffer(n),this.helper_.bindBuffer(e),this.helper_.enableAttributes(i.attributesDesc),this.helper_.bindBuffer(r),this.helper_.enableAttributesInstanced(i.instancedAttributesDesc),o(),l){const c=i.instancedAttributesDesc.reduce((h,f)=>h+(f.size||1),0),u=r.getSize()/c;this.helper_.drawElementsInstanced(0,a,u)}else this.helper_.drawElements(0,a)}setHelper(e,n=null){this.helper_=e;for(const r of this.renderPasses_)r.fillRenderPass&&(r.fillRenderPass.program=this.helper_.getProgram(r.fillRenderPass.fragmentShader,r.fillRenderPass.vertexShader)),r.strokeRenderPass&&(r.strokeRenderPass.program=this.helper_.getProgram(r.strokeRenderPass.fragmentShader,r.strokeRenderPass.vertexShader)),r.symbolRenderPass&&(r.symbolRenderPass.program=this.helper_.getProgram(r.symbolRenderPass.fragmentShader,r.symbolRenderPass.vertexShader));this.helper_.addUniforms(this.uniforms_),n&&(n.polygonBuffers&&(this.helper_.flushBufferData(n.polygonBuffers[0]),this.helper_.flushBufferData(n.polygonBuffers[1]),this.helper_.flushBufferData(n.polygonBuffers[2])),n.lineStringBuffers&&(this.helper_.flushBufferData(n.lineStringBuffers[0]),this.helper_.flushBufferData(n.lineStringBuffers[1]),this.helper_.flushBufferData(n.lineStringBuffers[2])),n.pointBuffers&&(this.helper_.flushBufferData(n.pointBuffers[0]),this.helper_.flushBufferData(n.pointBuffers[1]),this.helper_.flushBufferData(n.pointBuffers[2])))}}function nCe(t,e){const n=Array.isArray(t)?t:[t];if("style"in n[0]){const r=[],i=n,s=[];for(const o of i){const a=Array.isArray(o.style)?o.style:[o.style];let l=o.filter;o.else&&s.length&&(l=["all",...s.map(u=>["!",u])],o.filter&&l.push(o.filter),l.length<3&&(l=l[1])),o.filter&&s.push(o.filter);const c=a.map(u=>hZ(u,e,l));r.push(...c)}return r}return"builder"in n[0]?n:n.map(r=>hZ(r,e,null))}const Bh=new Uint8Array(4);class rCe{constructor(e,n){this.helper_=e;const r=e.getGL();this.texture_=r.createTexture(),this.framebuffer_=r.createFramebuffer(),this.depthbuffer_=r.createRenderbuffer(),this.size_=n||[1,1],this.data_=new Uint8Array(0),this.dataCacheDirty_=!0,this.updateSize_()}setSize(e){zd(e,this.size_)||(this.size_[0]=e[0],this.size_[1]=e[1],this.updateSize_())}getSize(){return this.size_}clearCachedData(){this.dataCacheDirty_=!0}readAll(){if(this.dataCacheDirty_){const e=this.size_,n=this.helper_.getGL();n.bindFramebuffer(n.FRAMEBUFFER,this.framebuffer_),n.readPixels(0,0,e[0],e[1],n.RGBA,n.UNSIGNED_BYTE,this.data_),this.dataCacheDirty_=!1}return this.data_}readPixel(e,n){if(e<0||n<0||e>this.size_[0]||n>=this.size_[1])return Bh[0]=0,Bh[1]=0,Bh[2]=0,Bh[3]=0,Bh;this.readAll();const r=Math.floor(e)+(this.size_[1]-Math.floor(n)-1)*this.size_[0];return Bh[0]=this.data_[r*4],Bh[1]=this.data_[r*4+1],Bh[2]=this.data_[r*4+2],Bh[3]=this.data_[r*4+3],Bh}getTexture(){return this.texture_}getFramebuffer(){return this.framebuffer_}getDepthbuffer(){return this.depthbuffer_}updateSize_(){const e=this.size_,n=this.helper_.getGL();this.texture_=this.helper_.createTexture(e,null,this.texture_),n.bindFramebuffer(n.FRAMEBUFFER,this.framebuffer_),n.viewport(0,0,e[0],e[1]),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,this.texture_,0),n.bindRenderbuffer(n.RENDERBUFFER,this.depthbuffer_),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_COMPONENT16,e[0],e[1]),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,this.depthbuffer_),this.data_=new Uint8Array(e[0]*e[1]*4)}}function iCe(t,e){const n=t.viewState.projection,i=e.getSource().getWrapX()&&n.canWrapX(),s=n.getExtent(),o=t.extent,a=i?Xn(s):null,l=i?Math.ceil((o[2]-s[2])/a)+1:1;return[i?Math.floor((o[0]-s[0])/a):0,l,a]}const u_={...gf,RENDER_EXTENT:"u_renderExtent",PATTERN_ORIGIN:"u_patternOrigin",GLOBAL_ALPHA:"u_globalAlpha"};class sCe extends NG{constructor(e,n){const r={[u_.RENDER_EXTENT]:[0,0,0,0],[u_.PATTERN_ORIGIN]:[0,0],[u_.GLOBAL_ALPHA]:1};super(e,{uniforms:r,postProcesses:n.postProcesses}),this.hitDetectionEnabled_=!n.disableHitDetection,this.hitRenderTarget_,this.sourceRevision_=-1,this.previousExtent_=Ba(),this.currentTransform_=Ws(),this.tmpCoords_=[0,0],this.tmpTransform_=Ws(),this.tmpMat4_=Hle(),this.currentFrameStateTransform_=Ws(),this.styleVariables_={},this.style_=[],this.styleRenderer_=null,this.buffers_=null,this.applyOptions_(n),this.batch_=new K3,this.initialFeaturesAdded_=!1,this.sourceListenKeys_=null}addInitialFeatures_(e){const n=this.getLayer().getSource();let r;this.batch_.addFeatures(n.getFeatures(),r),this.sourceListenKeys_=[Yn(n,io.ADDFEATURE,this.handleSourceFeatureAdded_.bind(this,r)),Yn(n,io.CHANGEFEATURE,this.handleSourceFeatureChanged_.bind(this,r),this),Yn(n,io.REMOVEFEATURE,this.handleSourceFeatureDelete_,this),Yn(n,io.CLEAR,this.handleSourceFeatureClear_,this)]}applyOptions_(e){this.styleVariables_=e.variables,this.style_=e.style}createRenderers_(){this.buffers_=null,this.styleRenderer_=new tCe(this.style_,this.styleVariables_,this.helper,this.hitDetectionEnabled_)}reset(e){this.applyOptions_(e),this.helper&&this.createRenderers_(),super.reset(e)}afterHelperCreated(){this.styleRenderer_?this.styleRenderer_.setHelper(this.helper,this.buffers_):this.createRenderers_(),this.hitDetectionEnabled_&&(this.hitRenderTarget_=new rCe(this.helper))}handleSourceFeatureAdded_(e,n){const r=n.feature;this.batch_.addFeature(r,e)}handleSourceFeatureChanged_(e,n){const r=n.feature;this.batch_.changeFeature(r,e)}handleSourceFeatureDelete_(e){const n=e.feature;this.batch_.removeFeature(n)}handleSourceFeatureClear_(){this.batch_.clear()}applyUniforms_(e){Zae(this.tmpTransform_,this.currentFrameStateTransform_),Xae(this.tmpTransform_,e),this.helper.setUniformMatrixValue(u_.PROJECTION_MATRIX,WF(this.tmpMat4_,this.tmpTransform_)),hk(this.tmpTransform_,this.tmpTransform_),this.helper.setUniformMatrixValue(u_.SCREEN_TO_WORLD_MATRIX,WF(this.tmpMat4_,this.tmpTransform_)),this.tmpCoords_[0]=0,this.tmpCoords_[1]=0,hk(this.tmpTransform_,e),Zi(this.tmpTransform_,this.tmpCoords_),this.helper.setUniformFloatVec2(u_.PATTERN_ORIGIN,this.tmpCoords_)}renderFrame(e){const n=this.helper.getGL();this.preRender(n,e);const[r,i,s]=iCe(e,this.getLayer());this.helper.prepareDraw(e),this.renderWorlds(e,!1,r,i,s),this.helper.finalizeDraw(e,this.dispatchPreComposeEvent,this.dispatchPostComposeEvent);const o=this.helper.getCanvas();return this.hitDetectionEnabled_&&(this.renderWorlds(e,!0,r,i,s),this.hitRenderTarget_.clearCachedData()),this.postRender(n,e),o}prepareFrameInternal(e){this.initialFeaturesAdded_||(this.addInitialFeatures_(e),this.initialFeaturesAdded_=!0);const n=this.getLayer(),r=n.getSource(),i=e.viewState,s=!e.viewHints[Ts.ANIMATING]&&!e.viewHints[Ts.INTERACTING],o=!x1(this.previousExtent_,e.extent),a=this.sourceRevision_<r.getRevision();if(a&&(this.sourceRevision_=r.getRevision()),s&&(o||a)){const l=i.projection,c=i.resolution,u=n instanceof N5?n.getRenderBuffer():0,h=ih(e.extent,u*c);r.loadFeatures(h,c,l),this.ready=!1;const f=this.helper.makeProjectionTransform(e,Ws());this.styleRenderer_.generateBuffers(this.batch_,f).then(g=>{this.buffers_&&this.disposeBuffers(this.buffers_),this.buffers_=g,this.ready=!0,this.getLayer().changed()}),this.previousExtent_=e.extent.slice()}return!0}renderWorlds(e,n,r,i,s){let o=r;n&&(this.hitRenderTarget_.setSize([Math.floor(e.size[0]/2),Math.floor(e.size[1]/2)]),this.helper.prepareDrawToRenderTarget(e,this.hitRenderTarget_,!0));do this.helper.makeProjectionTransform(e,this.currentFrameStateTransform_),Pke(this.currentFrameStateTransform_,o*s,0),this.buffers_&&this.styleRenderer_.render(this.buffers_,e,()=>{this.applyUniforms_(this.buffers_.invertVerticesTransform),this.helper.applyHitDetectionUniform(n)});while(++o<i)}forEachFeatureAtCoordinate(e,n,r,i,s){if(ur(this.hitDetectionEnabled_,"`forEachFeatureAtCoordinate` cannot be used on a WebGL layer if the hit detection logic has been disabled using the `disableHitDetection: true` option."),!this.styleRenderer_||!this.hitDetectionEnabled_)return;const o=Zi(n.coordinateToPixelTransform,e.slice()),a=this.hitRenderTarget_.readPixel(o[0]/2,o[1]/2),l=[a[0]/255,a[1]/255,a[2]/255,a[3]/255],c=UPe(l),u=this.batch_.getFeatureFromRef(c);if(u)return i(u,this.getLayer(),null)}disposeBuffers(e){const n=r=>{for(const i of r)i&&this.helper.deleteBuffer(i)};e.pointBuffers&&n(e.pointBuffers),e.lineStringBuffers&&n(e.lineStringBuffers),e.polygonBuffers&&n(e.polygonBuffers)}disposeInternal(){this.buffers_&&this.disposeBuffers(this.buffers_),this.sourceListenKeys_&&(this.sourceListenKeys_.forEach(function(e){ni(e)}),this.sourceListenKeys_=null),super.disposeInternal()}renderDeclutter(){}}const cf={BLUR:"blur",GRADIENT:"gradient",RADIUS:"radius"},oCe=["#00f","#0ff","#0f0","#ff0","#f00"];class aCe extends N5{constructor(e){e=e||{};const n=Object.assign({},e);delete n.gradient,delete n.radius,delete n.blur,delete n.weight,super(n),this.filter_=e.filter??!0,this.styleVariables_=e.variables||{},this.gradient_=null,this.addChangeListener(cf.GRADIENT,this.handleGradientChanged_),this.setGradient(e.gradient?e.gradient:oCe),this.setBlur(e.blur!==void 0?e.blur:15),this.setRadius(e.radius!==void 0?e.radius:8);const r=e.weight?e.weight:"weight";this.weight_=r,this.setRenderOrder(null)}getBlur(){return this.get(cf.BLUR)}getGradient(){return this.get(cf.GRADIENT)}getRadius(){return this.get(cf.RADIUS)}handleGradientChanged_(){this.gradient_=lCe(this.getGradient())}setBlur(e){const n=this.get(cf.BLUR);if(this.set(cf.BLUR,e),typeof e=="number"&&typeof n=="number"){this.changed();return}this.clearRenderer()}setGradient(e){this.set(cf.GRADIENT,e)}setRadius(e){const n=this.get(cf.RADIUS);if(this.set(cf.RADIUS,e),typeof e=="number"&&typeof n=="number"){this.changed();return}this.clearRenderer()}setFilter(e){this.filter_=e,this.changed(),this.clearRenderer()}setWeight(e){this.weight_=e,this.changed(),this.clearRenderer()}createRenderer(){const e=new ace,n=tce(),r=An(n,this.filter_,Is);let i=An(n,this.getRadius(),Wt),s=An(n,this.getBlur(),Wt);const o={};typeof this.getBlur()=="number"&&(s="a_blur",o.a_blur=()=>this.getBlur(),e.addUniform("a_blur","float")),typeof this.getRadius()=="number"&&(i="a_radius",o.a_radius=()=>this.getRadius(),e.addUniform("a_radius","float"));const a={};let l=null;if(typeof this.weight_=="string"||typeof this.weight_=="function"){const h=typeof this.weight_=="string"?f=>f.get(this.weight_):this.weight_;a.prop_weight={size:1,callback:f=>{const g=h(f);return g!==void 0?ri(g,0,1):1}},l="a_prop_weight",e.addAttribute("a_prop_weight","float")}else{const h=["clamp",this.weight_,0,1];l=An(n,h,Wt)}e.addFragmentShaderFunction(`float getBlurSlope() {
  float blur = max(1., ${s});
  float radius = ${i};
  return radius / blur;
}`).setSymbolSizeExpression(`vec2(${i} + ${s}) * 2.`).setSymbolColorExpression(`vec4(smoothstep(0., 1., (1. - length(coordsPx * 2. / v_quadSizePx)) * getBlurSlope()) * ${l})`).setStrokeColorExpression(`vec4(smoothstep(0., 1., (1. - length(currentRadiusPx * 2. / v_width)) * getBlurSlope()) * ${l})`).setStrokeWidthExpression(`(${i} + ${s}) * 2.`).setFillColorExpression(`vec4(${l})`).setFragmentDiscardExpression(`!${r}`),ice(e,n);const c=oce(n),u=sce(n,this.styleVariables_);return new sCe(this,{className:this.getClassName(),variables:this.styleVariables_,style:{builder:e,attributes:{...c,...a},uniforms:{...u,...o}},disableHitDetection:!1,postProcesses:[{fragmentShader:`
            precision mediump float;

            uniform sampler2D u_image;
            uniform sampler2D u_gradientTexture;
            uniform float u_opacity;

            varying vec2 v_texCoord;

            void main() {
              vec4 color = texture2D(u_image, v_texCoord);
              gl_FragColor.a = color.a * u_opacity;
              gl_FragColor.rgb = texture2D(u_gradientTexture, vec2(0.5, color.a)).rgb;
              gl_FragColor.rgb *= gl_FragColor.a;
            }`,uniforms:{u_gradientTexture:()=>this.gradient_,u_opacity:()=>this.getOpacity()}}]})}updateStyleVariables(e){Object.assign(this.styleVariables_,e),this.changed()}renderDeclutter(){}}function lCe(t){const r=Rs(1,256),i=r.createLinearGradient(0,0,1,256),s=1/(t.length-1);for(let o=0,a=t.length;o<a;++o)i.addColorStop(o*s,t[o]);return r.fillStyle=i,r.fillRect(0,0,1,256),r.canvas}class cCe extends xG{constructor(e){super(e),this.image=null}getImage(){return this.image?this.image.getImage():null}prepareFrame(e){const n=e.layerStatesArray[e.layerIndex],r=e.pixelRatio,i=e.viewState,s=i.resolution,o=this.getLayer().getSource(),a=e.viewHints;let l=e.extent;if(n.extent!==void 0&&(l=Jf(l,sh(n.extent,i.projection))),!a[Ts.ANIMATING]&&!a[Ts.INTERACTING]&&!H2(l))if(o){const c=i.projection,u=o.getImage(l,s,r,c);u&&(this.loadImage(u)?this.image=u:u.getState()===Vt.EMPTY&&(this.image=null))}else this.image=null;return!!this.image}getData(e){const n=this.frameState;if(!n)return null;const r=this.getLayer(),i=Zi(n.pixelToCoordinateTransform,e.slice()),s=r.getExtent();if(s&&!_1(s,i))return null;const o=this.image.getExtent(),a=this.image.getImage(),l=Xn(o),c=Math.floor(a.width*((i[0]-o[0])/l));if(c<0||c>=a.width)return null;const u=Ps(o),h=Math.floor(a.height*((o[3]-i[1])/u));return h<0||h>=a.height?null:this.getImageData(a,c,h)}renderFrame(e,n){const r=this.image,i=r.getExtent(),s=r.getResolution(),[o,a]=Array.isArray(s)?s:[s,s],l=r.getPixelRatio(),c=e.layerStatesArray[e.layerIndex],u=e.pixelRatio,h=e.viewState,f=h.center,g=h.resolution,y=u*o/(g*l),_=u*a/(g*l);this.prepareContainer(e,n);const b=this.context.canvas.width,T=this.context.canvas.height,A=this.getRenderContext(e);let I=!1,P=!0;if(c.extent){const O=sh(c.extent,h.projection);P=oa(O,e.extent),I=P&&!qm(O,e.extent),I&&this.clipUnrotated(A,e,O)}const R=r.getImage(),D=pu(this.tempTransform,b/2,T/2,y,_,0,l*(i[0]-f[0])/o,l*(f[1]-i[3])/a);this.renderedResolution=a*u/l;const C=R.width*D[0],M=R.height*D[3];if(this.getLayer().getSource().getInterpolate()||(A.imageSmoothingEnabled=!1),this.preRender(A,e),P&&C>=.5&&M>=.5){const O=D[4],j=D[5],V=c.opacity;V!==1&&(A.save(),A.globalAlpha=V),A.drawImage(R,0,0,+R.width,+R.height,O,j,C,M),V!==1&&A.restore()}return this.postRender(this.context,e),I&&A.restore(),A.imageSmoothingEnabled=!0,this.container}}class uCe extends HA{constructor(e){e=e||{},super(e)}}class hCe extends uCe{constructor(e){super(e)}createRenderer(){return new cCe(this)}getData(e){return super.getData(e)}}function U6(t,e,n){if(!(n in t))return t[n]=new Set([e]),!0;const r=t[n],i=r.has(e);return i||r.add(e),!i}function dCe(t,e,n){const r=t[n];return r?r.delete(e):!1}function dZ(t,e){const n=t.layerStatesArray[t.layerIndex];n.extent&&(e=Jf(e,sh(n.extent,t.viewState.projection)));const r=n.layer.getRenderSource();if(!r.getWrapX()){const i=r.getTileGridForProjection(t.viewState.projection).getExtent();i&&(e=Jf(e,i))}return e}class fCe extends xG{constructor(e,n){super(e),n=n||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=Ba(),this.tempTileRange_=new MG(0,0,0,0),this.tempTileCoord_=q3(0,0,0);const r=n.cacheSize!==void 0?n.cacheSize:512;this.tileCache_=new cZ(r),this.sourceTileCache_=null,this.maxStaleKeys=r*.5}getTileCache(){return this.tileCache_}getSourceTileCache(){return this.sourceTileCache_||(this.sourceTileCache_=new cZ(512)),this.sourceTileCache_}getOrCreateTile(e,n,r,i){const s=this.tileCache_,a=this.getLayer().getSource(),l=XR(a,a.getKey(),e,n,r);let c;if(s.containsKey(l))c=s.get(l);else{const u=i.viewState.projection,h=a.getProjection();if(c=a.getTile(e,n,r,i.pixelRatio,u,!h||Zy(h,u)?void 0:this.getSourceTileCache()),!c)return null;s.set(l,c)}return c}getTile(e,n,r,i){const s=this.getOrCreateTile(e,n,r,i);return s||null}getData(e){const n=this.frameState;if(!n)return null;const r=this.getLayer(),i=Zi(n.pixelToCoordinateTransform,e.slice()),s=r.getExtent();if(s&&!_1(s,i))return null;const o=n.viewState,a=r.getRenderSource(),l=a.getTileGridForProjection(o.projection),c=a.getTilePixelRatio(n.pixelRatio);for(let u=l.getZForResolution(o.resolution);u>=l.getMinZoom();--u){const h=l.getTileCoordForCoordAndZ(i,u),f=this.getTile(u,h[1],h[2],n);if(!f||f.getState()!==cn.LOADED)continue;const g=l.getOrigin(u),y=ja(l.getTileSize(u)),_=l.getResolution(u);let b;if(f instanceof Yle||f instanceof Qle)b=f.getImage();else if(f instanceof oZ){if(b=HF(f.getData()),!b)continue}else continue;const T=Math.floor(c*((i[0]-g[0])/_-h[1]*y[0])),A=Math.floor(c*((g[1]-i[1])/_-h[2]*y[1])),I=Math.round(c*a.getGutterForProjection(o.projection));return this.getImageData(b,T+I,A+I)}return null}prepareFrame(e){this.renderedProjection?e.viewState.projection!==this.renderedProjection&&(this.tileCache_.clear(),this.renderedProjection=e.viewState.projection):this.renderedProjection=e.viewState.projection;const n=this.getLayer().getSource();if(!n)return!1;const r=n.getRevision();return this.renderedSourceRevision_?this.renderedSourceRevision_!==r&&(this.renderedSourceRevision_=r,this.renderedSourceKey_===n.getKey()&&(this.tileCache_.clear(),this.sourceTileCache_?.clear())):this.renderedSourceRevision_=r,!0}enqueueTilesForNextExtent(){return!0}enqueueTiles(e,n,r,i,s){const o=e.viewState,a=this.getLayer(),l=a.getRenderSource(),c=l.getTileGridForProjection(o.projection),u=Qt(l);u in e.wantedTiles||(e.wantedTiles[u]={});const h=e.wantedTiles[u],f=a.getMapInternal(),g=Math.max(r-s,c.getMinZoom(),c.getZForResolution(Math.min(a.getMaxResolution(),f?f.getView().getResolutionForZoom(Math.max(a.getMinZoom(),0)):c.getResolution(0)),l.zDirection)),y=o.rotation,_=y?jae(o.center,o.resolution,y,e.size):void 0;for(let b=r;b>=g;--b){const T=c.getTileRangeForExtentAndZ(n,b,this.tempTileRange_),A=c.getResolution(b);for(let I=T.minX;I<=T.maxX;++I)for(let P=T.minY;P<=T.maxY;++P){if(y&&!c.tileCoordIntersectsViewport([b,I,P],_))continue;const R=this.getTile(b,I,P,e);if(!R||!U6(i,R,b))continue;const C=R.getKey();if(h[C]=!0,R.getState()===cn.IDLE&&!e.tileQueue.isKeyQueued(C)){const M=q3(b,I,P,this.tempTileCoord_);e.tileQueue.enqueue([R,u,c.getTileCoordCenter(M),A])}}}}findStaleTile_(e,n){const r=this.tileCache_,i=e[0],s=e[1],o=e[2],a=this.getStaleKeys();for(let l=0;l<a.length;++l){const c=XR(this.getLayer().getSource(),a[l],i,s,o);if(r.containsKey(c)){const u=r.peek(c);if(u.getState()===cn.LOADED)return u.endTransition(Qt(this)),U6(n,u,i),!0}}return!1}findAltTiles_(e,n,r,i){const s=e.getTileRangeForTileCoordAndZ(n,r,this.tempTileRange_);if(!s)return!1;let o=!0;const a=this.tileCache_,l=this.getLayer().getRenderSource(),c=l.getKey();for(let u=s.minX;u<=s.maxX;++u)for(let h=s.minY;h<=s.maxY;++h){const f=XR(l,c,r,u,h);let g=!1;if(a.containsKey(f)){const y=a.peek(f);y.getState()===cn.LOADED&&(U6(i,y,r),g=!0)}g||(o=!1)}return o}renderFrame(e,n){this.renderComplete=!0;const r=e.layerStatesArray[e.layerIndex],i=e.viewState,s=i.projection,o=i.resolution,a=i.center,l=e.pixelRatio,c=this.getLayer(),u=c.getSource(),h=u.getTileGridForProjection(s),f=h.getZForResolution(o,u.zDirection),g=h.getResolution(f),y=u.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==y&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=y):this.renderedSourceKey_=y;let _=e.extent;const b=u.getTilePixelRatio(l);this.prepareContainer(e,n);const T=this.context.canvas.width,A=this.context.canvas.height,I=r.extent&&sh(r.extent);I&&(_=Jf(_,sh(r.extent)));const P=g*T/2/b,R=g*A/2/b,D=[a[0]-P,a[1]-R,a[0]+P,a[1]+R],C={};this.renderedTiles.length=0;const M=c.getPreload();if(e.nextExtent&&this.enqueueTilesForNextExtent()){const fe=h.getZForResolution(i.nextResolution,u.zDirection),De=dZ(e,e.nextExtent);this.enqueueTiles(e,De,fe,C,M)}const O=dZ(e,_);if(this.enqueueTiles(e,O,f,C,0),M>0&&setTimeout(()=>{this.enqueueTiles(e,O,f-1,C,M-1)},0),!(f in C))return this.container;const j=Qt(this),V=e.time;for(const fe of C[f]){const De=fe.getState();if(De===cn.EMPTY)continue;const Ce=fe.tileCoord;if(De===cn.LOADED&&fe.getAlpha(j,V)===1){fe.endTransition(j);continue}if(De!==cn.ERROR&&(this.renderComplete=!1),this.findStaleTile_(Ce,C)){dCe(C,fe,f),e.animate=!0;continue}if(this.findAltTiles_(h,Ce,f+1,C))continue;const ne=h.getMinZoom();for(let ie=f-1;ie>=ne&&!this.findAltTiles_(h,Ce,ie,C);--ie);}const U=g/o*l/b,G=this.getRenderContext(e);pu(this.tempTransform,T/2,A/2,U,U,0,-T/2,-A/2),r.extent&&this.clipUnrotated(G,e,I),u.getInterpolate()||(G.imageSmoothingEnabled=!1),this.preRender(G,e);const de=Object.keys(C).map(Number);de.sort(Zf);let Ie;const ze=[],Ne=[];for(let fe=de.length-1;fe>=0;--fe){const De=de[fe],Ce=u.getTilePixelSize(De,l,s),W=h.getResolution(De)/g,ne=Ce[0]*W*U,ie=Ce[1]*W*U,le=h.getTileCoordForCoordAndZ(iv(D),De),ve=h.getTileCoordExtent(le),qe=Zi(this.tempTransform,[b*(ve[0]-D[0])/g,b*(D[3]-ve[3])/g]),Ke=b*u.getGutterForProjection(s);for(const Se of C[De]){if(Se.getState()!==cn.LOADED)continue;const we=Se.tileCoord,Dt=le[1]-we[1],Ye=Math.round(qe[0]-(Dt-1)*ne),on=le[2]-we[2],jt=Math.round(qe[1]-(on-1)*ie),pn=Math.round(qe[0]-Dt*ne),_n=Math.round(qe[1]-on*ie),dt=Ye-pn,hr=jt-_n,zn=de.length===1;let Wn=!1;Ie=[pn,_n,pn+dt,_n,pn+dt,_n+hr,pn,_n+hr];for(let ei=0,_o=ze.length;ei<_o;++ei)if(!zn&&De<Ne[ei]){const Cr=ze[ei];oa([pn,_n,pn+dt,_n+hr],[Cr[0],Cr[3],Cr[4],Cr[7]])&&(Wn||(G.save(),Wn=!0),G.beginPath(),G.moveTo(Ie[0],Ie[1]),G.lineTo(Ie[2],Ie[3]),G.lineTo(Ie[4],Ie[5]),G.lineTo(Ie[6],Ie[7]),G.moveTo(Cr[6],Cr[7]),G.lineTo(Cr[4],Cr[5]),G.lineTo(Cr[2],Cr[3]),G.lineTo(Cr[0],Cr[1]),G.clip())}ze.push(Ie),Ne.push(De),this.drawTile(Se,e,pn,_n,dt,hr,Ke,zn),Wn&&G.restore(),this.renderedTiles.unshift(Se),this.updateUsedTiles(e.usedTiles,u,Se)}}if(this.renderedResolution=g,this.extentChanged=!this.renderedExtent_||!x1(this.renderedExtent_,D),this.renderedExtent_=D,this.renderedPixelRatio=l,this.postRender(this.context,e),r.extent&&G.restore(),G.imageSmoothingEnabled=!0,this.renderComplete){const fe=(De,Ce)=>{const Q=Qt(u),W=Ce.wantedTiles[Q],ne=W?Object.keys(W).length:0;this.updateCacheSize(ne),this.tileCache_.expireCache(),this.sourceTileCache_?.expireCache()};e.postRenderFunctions.push(fe)}return this.container}updateCacheSize(e){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,e*2)}drawTile(e,n,r,i,s,o,a,l){let c;if(e instanceof oZ){if(c=HF(e.getData()),!c)throw new Error("Rendering array data is not yet supported")}else c=this.getTileImage(e);if(!c)return;const u=this.getRenderContext(n),h=Qt(this),f=n.layerStatesArray[n.layerIndex],g=f.opacity*(l?e.getAlpha(h,n.time):1),y=g!==u.globalAlpha;y&&(u.save(),u.globalAlpha=g),u.drawImage(c,a,a,c.width-2*a,c.height-2*a,r,i,s,o),y&&u.restore(),g!==f.opacity?n.animate=!0:l&&e.endTransition(h)}getImage(){const e=this.context;return e?e.canvas:null}getTileImage(e){return e.getImage()}updateUsedTiles(e,n,r){const i=Qt(n);i in e||(e[i]={}),e[i][r.getKey()]=!0}}const _C={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class pCe extends HA{constructor(e){e=e||{};const n=Object.assign({},e),r=e.cacheSize;delete e.cacheSize,delete n.preload,delete n.useInterimTilesOnError,super(n),this.on,this.once,this.un,this.cacheSize_=r,this.setPreload(e.preload!==void 0?e.preload:0),this.setUseInterimTilesOnError(e.useInterimTilesOnError!==void 0?e.useInterimTilesOnError:!0)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(_C.PRELOAD)}setPreload(e){this.set(_C.PRELOAD,e)}getUseInterimTilesOnError(){return this.get(_C.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(e){this.set(_C.USE_INTERIM_TILES_ON_ERROR,e)}getData(e){return super.getData(e)}}class Nm extends pCe{constructor(e){super(e)}createRenderer(){return new fCe(this,{cacheSize:this.getCacheSize()})}}function YF(t){return Array.isArray(t)?Math.min(...t):t}const h_=[0,0,0],nm=5;class cce{constructor(e){this.minZoom=e.minZoom!==void 0?e.minZoom:0,this.resolutions_=e.resolutions,ur(GTe(this.resolutions_,(i,s)=>s-i),"`resolutions` must be sorted in descending order");let n;if(!e.origins){for(let i=0,s=this.resolutions_.length-1;i<s;++i)if(!n)n=this.resolutions_[i]/this.resolutions_[i+1];else if(this.resolutions_[i]/this.resolutions_[i+1]!==n){n=void 0;break}}this.zoomFactor_=n,this.maxZoom=this.resolutions_.length-1,this.origin_=e.origin!==void 0?e.origin:null,this.origins_=null,e.origins!==void 0&&(this.origins_=e.origins,ur(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const r=e.extent;r!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=iv(r)),ur(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,e.tileSizes!==void 0&&(this.tileSizes_=e.tileSizes,ur(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=e.tileSize!==void 0?e.tileSize:this.tileSizes_?null:IG,ur(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=r!==void 0?r:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],e.sizes!==void 0?this.fullTileRanges_=e.sizes.map((i,s)=>{const o=new MG(Math.min(0,i[0]),Math.max(i[0]-1,-1),Math.min(0,i[1]),Math.max(i[1]-1,-1));if(r){const a=this.getTileRangeForExtentAndZ(r,s);o.minX=Math.max(a.minX,o.minX),o.maxX=Math.min(a.maxX,o.maxX),o.minY=Math.max(a.minY,o.minY),o.maxY=Math.min(a.maxY,o.maxY)}return o}):r&&this.calculateTileRanges_(r)}forEachTileCoord(e,n,r){const i=this.getTileRangeForExtentAndZ(e,n);for(let s=i.minX,o=i.maxX;s<=o;++s)for(let a=i.minY,l=i.maxY;a<=l;++a)r([n,s,a])}forEachTileCoordParentTileRange(e,n,r,i){let s,o,a,l=null,c=e[0]-1;for(this.zoomFactor_===2?(o=e[1],a=e[2]):l=this.getTileCoordExtent(e,i);c>=this.minZoom;){if(o!==void 0&&a!==void 0?(o=Math.floor(o/2),a=Math.floor(a/2),s=a_(o,o,a,a,r)):s=this.getTileRangeForExtentAndZ(l,c,r),n(c,s))return!0;--c}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(e){return this.origin_?this.origin_:this.origins_[e]}getResolution(e){return this.resolutions_[e]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(e,n,r){if(e[0]<this.maxZoom){if(this.zoomFactor_===2){const s=e[1]*2,o=e[2]*2;return a_(s,s+1,o,o+1,n)}const i=this.getTileCoordExtent(e,r||this.tmpExtent_);return this.getTileRangeForExtentAndZ(i,e[0]+1,n)}return null}getTileRangeForTileCoordAndZ(e,n,r){if(n>this.maxZoom||n<this.minZoom)return null;const i=e[0],s=e[1],o=e[2];if(n===i)return a_(s,o,s,o,r);if(this.zoomFactor_){const l=Math.pow(this.zoomFactor_,n-i),c=Math.floor(s*l),u=Math.floor(o*l);if(n<i)return a_(c,c,u,u,r);const h=Math.floor(l*(s+1))-1,f=Math.floor(l*(o+1))-1;return a_(c,h,u,f,r)}const a=this.getTileCoordExtent(e,this.tmpExtent_);return this.getTileRangeForExtentAndZ(a,n,r)}getTileRangeForExtentAndZ(e,n,r){this.getTileCoordForXYAndZ_(e[0],e[3],n,!1,h_);const i=h_[1],s=h_[2];this.getTileCoordForXYAndZ_(e[2],e[1],n,!0,h_);const o=h_[1],a=h_[2];return a_(i,o,s,a,r)}getTileCoordCenter(e){const n=this.getOrigin(e[0]),r=this.getResolution(e[0]),i=ja(this.getTileSize(e[0]),this.tmpSize_);return[n[0]+(e[1]+.5)*i[0]*r,n[1]-(e[2]+.5)*i[1]*r]}getTileCoordExtent(e,n){const r=this.getOrigin(e[0]),i=this.getResolution(e[0]),s=ja(this.getTileSize(e[0]),this.tmpSize_),o=r[0]+e[1]*s[0]*i,a=r[1]-(e[2]+1)*s[1]*i,l=o+s[0]*i,c=a+s[1]*i;return up(o,a,l,c,n)}getTileCoordForCoordAndResolution(e,n,r){return this.getTileCoordForXYAndResolution_(e[0],e[1],n,!1,r)}getTileCoordForXYAndResolution_(e,n,r,i,s){const o=this.getZForResolution(r),a=r/this.getResolution(o),l=this.getOrigin(o),c=ja(this.getTileSize(o),this.tmpSize_);let u=a*(e-l[0])/r/c[0],h=a*(l[1]-n)/r/c[1];return i?(u=Km(u,nm)-1,h=Km(h,nm)-1):(u=aC(u,nm),h=aC(h,nm)),q3(o,u,h,s)}getTileCoordForXYAndZ_(e,n,r,i,s){const o=this.getOrigin(r),a=this.getResolution(r),l=ja(this.getTileSize(r),this.tmpSize_);let c=(e-o[0])/a/l[0],u=(o[1]-n)/a/l[1];return i?(c=Km(c,nm)-1,u=Km(u,nm)-1):(c=aC(c,nm),u=aC(u,nm)),q3(r,c,u,s)}getTileCoordForCoordAndZ(e,n,r){return this.getTileCoordForXYAndZ_(e[0],e[1],n,!1,r)}getTileCoordResolution(e){return this.resolutions_[e[0]]}getTileSize(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]}getFullTileRange(e){return this.fullTileRanges_?this.fullTileRanges_[e]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,e):null}getZForResolution(e,n){const r=v5(this.resolutions_,e,n||0);return ri(r,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(e,n){return nle(n,0,n.length,2,this.getTileCoordExtent(e))}calculateTileRanges_(e){const n=this.resolutions_.length,r=new Array(n);for(let i=this.minZoom;i<n;++i)r[i]=this.getTileRangeForExtentAndZ(e,i);this.fullTileRanges_=r}}function uce(t){let e=t.getDefaultTileGrid();return e||(e=vCe(t),t.setDefaultTileGrid(e)),e}function mCe(t,e,n){const r=e[0],i=t.getTileCoordCenter(e),s=GG(n);if(!_1(s,i)){const o=Xn(s),a=Math.ceil((s[0]-i[0])/o);return i[0]+=o*a,t.getTileCoordForCoordAndZ(i,r)}return e}function gCe(t,e,n,r){r=r!==void 0?r:"top-left";const i=hce(t,e,n);return new cce({extent:t,origin:HTe(t,r),resolutions:i,tileSize:n})}function yCe(t){const e=t||{},n=e.extent||Jr("EPSG:3857").getExtent(),r={extent:n,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:hce(n,e.maxZoom,e.tileSize,e.maxResolution)};return new cce(r)}function hce(t,e,n,r){e=e!==void 0?e:tPe,n=ja(n!==void 0?n:IG);const i=Ps(t),s=Xn(t);r=r>0?r:Math.max(s/n[0],i/n[1]);const o=e+1,a=new Array(o);for(let l=0;l<o;++l)a[l]=r/Math.pow(2,l);return a}function vCe(t,e,n,r){const i=GG(t);return gCe(i,e,n,r)}function GG(t){t=Jr(t);let e=t.getExtent();if(!e){const n=180*Xw.degrees/t.getMetersPerUnit();e=up(-n,-n,n,n)}return e}function UG(t,e){const n=[];Object.keys(e).forEach(function(i){e[i]!==null&&e[i]!==void 0&&n.push(i+"="+encodeURIComponent(e[i]))});const r=n.join("&");return t=t.replace(/[?&]$/,""),t+=t.includes("?")?"&":"?",t+r}const _Ce=/\{z\}/g,xCe=/\{x\}/g,wCe=/\{y\}/g,bCe=/\{-y\}/g;function ECe(t,e,n,r,i){return t.replace(_Ce,e.toString()).replace(xCe,n.toString()).replace(wCe,r.toString()).replace(bCe,function(){if(i===void 0)throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(i-r).toString()})}function SCe(t){const e=[];let n=/\{([a-z])-([a-z])\}/.exec(t);if(n){const r=n[1].charCodeAt(0),i=n[2].charCodeAt(0);let s;for(s=r;s<=i;++s)e.push(t.replace(n[0],String.fromCharCode(s)));return e}if(n=/\{(\d+)-(\d+)\}/.exec(t),n){const r=parseInt(n[2],10);for(let i=parseInt(n[1],10);i<=r;i++)e.push(t.replace(n[0],i.toString()));return e}return e.push(t),e}function TCe(t,e){return(function(n,r,i){if(!n)return;let s;const o=n[0];if(e){const a=e.getFullTileRange(o);a&&(s=a.getHeight()-1)}return ECe(t,o,n[1],n[2],s)})}function kCe(t,e){const n=t.length,r=new Array(n);for(let i=0;i<n;++i)r[i]=TCe(t[i],e);return ACe(r)}function ACe(t){return t.length===1?t[0]:(function(e,n,r){if(!e)return;const i=ece(e),s=fg(i,t.length);return t[s](e,n,r)})}class ICe extends vG{constructor(e){super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX,interpolate:e.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=e.tilePixelRatio!==void 0?e.tilePixelRatio:1,this.tileGrid=e.tileGrid!==void 0?e.tileGrid:null;const n=[256,256];this.tileGrid&&ja(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),n),this.tmpSize=[0,0],this.key_=e.key||Qt(this),this.tileOptions={transition:e.transition,interpolate:e.interpolate},this.zDirection=e.zDirection?e.zDirection:0}getGutterForProjection(e){return 0}getKey(){return this.key_}setKey(e){this.key_!==e&&(this.key_=e,this.changed())}getResolutions(e){const n=e?this.getTileGridForProjection(e):this.tileGrid;return n?n.getResolutions():null}getTile(e,n,r,i,s,o){return bn()}getTileGrid(){return this.tileGrid}getTileGridForProjection(e){return this.tileGrid?this.tileGrid:uce(e)}getTilePixelRatio(e){return this.tilePixelRatio_}getTilePixelSize(e,n,r){const i=this.getTileGridForProjection(r),s=this.getTilePixelRatio(n),o=ja(i.getTileSize(e),this.tmpSize);return s==1?o:UAe(o,s,this.tmpSize)}getTileCoordForTileUrlFunction(e,n){const r=n!==void 0?n:this.getProjection(),i=n!==void 0?this.getTileGridForProjection(r):this.tileGrid||this.getTileGridForProjection(r);return this.getWrapX()&&r.isGlobal()&&(e=mCe(i,e,r)),IPe(e,i)?e:null}clear(){}refresh(){this.clear(),super.refresh()}}class PCe extends Sc{constructor(e,n){super(e),this.tile=n}}const B6={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};class BG extends ICe{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===BG.prototype.tileUrlFunction,this.tileLoadFunction=e.tileLoadFunction,e.tileUrlFunction&&(this.tileUrlFunction=e.tileUrlFunction),this.urls=null,e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(e){const n=e.target,r=Qt(n),i=n.getState();let s;i==cn.LOADING?(this.tileLoadingKeys_[r]=!0,s=B6.TILELOADSTART):r in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[r],s=i==cn.ERROR?B6.TILELOADERROR:i==cn.LOADED?B6.TILELOADEND:void 0),s!=null&&this.dispatchEvent(new PCe(s,n))}setTileLoadFunction(e){this.tileLoadFunction=e,this.changed()}setTileUrlFunction(e,n){this.tileUrlFunction=e,typeof n<"u"?this.setKey(n):this.changed()}setUrl(e){const n=SCe(e);this.urls=n,this.setUrls(n)}setUrls(e){this.urls=e;const n=e.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(kCe(e,this.tileGrid),n):this.setKey(n)}tileUrlFunction(e,n,r){}}class dce extends BG{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:fce,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate!==void 0?e.interpolate:!0,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.crossOrigin=e.crossOrigin!==void 0?e.crossOrigin:null,this.tileClass=e.tileClass!==void 0?e.tileClass:Yle,this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(e){return this.getProjection()&&e&&!Zy(this.getProjection(),e)?0:this.getGutter()}getGutter(){return 0}getKey(){let e=super.getKey();return this.getInterpolate()||(e+=":disable-interpolation"),e}getTileGridForProjection(e){const n=this.getProjection();if(this.tileGrid&&(!n||Zy(n,e)))return this.tileGrid;const r=Qt(e);return r in this.tileGridForProjection||(this.tileGridForProjection[r]=uce(e)),this.tileGridForProjection[r]}createTile_(e,n,r,i,s,o){const a=[e,n,r],l=this.getTileCoordForTileUrlFunction(a,s),c=l?this.tileUrlFunction(l,i,s):void 0,u=new this.tileClass(a,c!==void 0?cn.IDLE:cn.EMPTY,c!==void 0?c:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return u.key=o,u.addEventListener(wn.CHANGE,this.handleTileChange.bind(this)),u}getTile(e,n,r,i,s,o){const a=this.getProjection();if(!a||!s||Zy(a,s))return this.getTileInternal(e,n,r,i,a||s);const l=[e,n,r],c=this.getKey(),u=this.getTileGridForProjection(a),h=this.getTileGridForProjection(s),f=this.getTileCoordForTileUrlFunction(l,s),g=new Qle(a,u,s,h,l,f,this.getTilePixelRatio(i),this.getGutter(),(y,_,b,T)=>this.getTileInternal(y,_,b,T,a,o),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return g.key=c,g}getTileInternal(e,n,r,i,s,o){const a=this.getKey(),l=XR(this,a,e,n,r);if(o&&o.containsKey(l))return o.get(l);const c=this.createTile_(e,n,r,i,s,a);return o?.set(l,c),c}setRenderReprojectionEdges(e){this.renderReprojectionEdges_!=e&&(this.renderReprojectionEdges_=e,this.changed())}setTileGridForProjection(e,n){const r=Jr(e);if(r){const i=Qt(r);i in this.tileGridForProjection||(this.tileGridForProjection[i]=n)}}}function fce(t,e){if(cc){const n=t.getCrossOrigin();let r="same-origin",i="same-origin";n==="anonymous"||n===""?(r="cors",i="omit"):n==="use-credentials"&&(r="cors",i="include"),fetch(e,{mode:r,credentials:i}).then(s=>{if(!s.ok)throw new Error(`HTTP ${s.status}`);return s.blob()}).then(s=>createImageBitmap(s)).then(s=>{const o=t.getImage();o.width=s.width,o.height=s.height,o.getContext("2d").drawImage(s,0,0),s.close?.(),o.dispatchEvent(new Event("load"))}).catch(()=>{t.getImage().dispatchEvent(new Event("error"))});return}t.getImage().src=e}class wy extends dce{constructor(e){e=e||{};const n=e.projection!==void 0?e.projection:"EPSG:3857",r=e.tileGrid!==void 0?e.tileGrid:yCe({extent:GG(n),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize});super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:n,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:r,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0}getGutter(){return this.gutter_}}const CCe="modulepreload",RCe=function(t){return"/detectorapp-nl/"+t},fZ={},_e=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){let l=function(c){return Promise.all(c.map(u=>Promise.resolve(u).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=o?.nonce||o?.getAttribute("nonce");i=l(n.map(c=>{if(c=RCe(c),c in fZ)return;fZ[c]=!0;const u=c.endsWith(".css"),h=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${h}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":CCe,u||(f.as="script"),f.crossOrigin="",f.href=c,a&&f.setAttribute("nonce",a),document.head.appendChild(f),u)return new Promise((g,y)=>{f.addEventListener("load",g),f.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return i.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return e().catch(s)})};class MCe extends hle{constructor(e,n,r,i,s,o,a){let l=e.getExtent();l&&e.canWrapX()&&(l=l.slice(),l[0]=-1/0,l[2]=1/0);let c=n.getExtent();c&&n.canWrapX()&&(c=c.slice(),c[0]=-1/0,c[2]=1/0);const u=c?Jf(r,c):r,h=gh(u),f=H3(e,n,h,i),g=Jle,y=new Zle(e,n,u,l,f*g,i),_=y.calculateSourceExtent(),b=H2(_)?null:o(_,f,s),T=b?Vt.IDLE:Vt.EMPTY,A=b?b.getPixelRatio():1;super(r,i,A,T),this.targetProj_=n,this.maxSourceExtent_=l,this.triangulation_=y,this.targetResolution_=i,this.targetExtent_=r,this.sourceImage_=b,this.sourcePixelRatio_=A,this.interpolate_=a,this.canvas_=null,this.sourceListenerKey_=null}disposeInternal(){this.state==Vt.LOADING&&this.unlistenSource_(),super.disposeInternal()}getImage(){return this.canvas_}getProjection(){return this.targetProj_}reproject_(){const e=this.sourceImage_.getState();if(e==Vt.LOADED){const n=Xn(this.targetExtent_)/this.targetResolution_,r=Ps(this.targetExtent_)/this.targetResolution_;this.canvas_=Xle(n,r,this.sourcePixelRatio_,YF(this.sourceImage_.getResolution()),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0,void 0,this.interpolate_,!0)}this.state=e,this.changed()}load(){if(this.state==Vt.IDLE){this.state=Vt.LOADING,this.changed();const e=this.sourceImage_.getState();e==Vt.LOADED||e==Vt.ERROR?this.reproject_():(this.sourceListenerKey_=Yn(this.sourceImage_,wn.CHANGE,n=>{const r=this.sourceImage_.getState();(r==Vt.LOADED||r==Vt.ERROR)&&(this.unlistenSource_(),this.reproject_())}),this.sourceImage_.load())}}unlistenSource_(){ni(this.sourceListenerKey_),this.sourceListenerKey_=null}}const Jm=4,W6={IMAGELOADSTART:"imageloadstart",IMAGELOADEND:"imageloadend",IMAGELOADERROR:"imageloaderror"};class NCe extends Sc{constructor(e,n){super(e),this.image=n}}class OCe extends vG{constructor(e){super({attributions:e.attributions,projection:e.projection,state:e.state,interpolate:e.interpolate!==void 0?e.interpolate:!0}),this.on,this.once,this.un,this.loader=e.loader||null,this.resolutions_=e.resolutions!==void 0?e.resolutions:null,this.reprojectedImage_=null,this.reprojectedRevision_=0,this.image=null,this.wantedExtent_,this.wantedResolution_,this.static_=e.loader?e.loader.length===0:!1,this.wantedProjection_=null}getResolutions(){return this.resolutions_}setResolutions(e){this.resolutions_=e}findNearestResolution(e){const n=this.getResolutions();if(n){const r=v5(n,e,0);e=n[r]}return e}getImage(e,n,r,i){const s=this.getProjection();if(!s||!i||Zy(s,i))return s&&(i=s),this.getImageInternal(e,n,r,i);if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&Zy(this.reprojectedImage_.getProjection(),i)&&this.reprojectedImage_.getResolution()==n&&x1(this.reprojectedImage_.getExtent(),e))return this.reprojectedImage_;this.reprojectedImage_.dispose(),this.reprojectedImage_=null}return this.reprojectedImage_=new MCe(s,i,e,n,r,(o,a,l)=>this.getImageInternal(o,a,l,s),this.getInterpolate()),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}getImageInternal(e,n,r,i){if(this.loader){const s=pce(e,n,r,1),o=this.findNearestResolution(n);if(this.image&&(this.static_||this.wantedProjection_===i&&(this.wantedExtent_&&qm(this.wantedExtent_,s)||qm(this.image.getExtent(),s))&&(this.wantedResolution_&&YF(this.wantedResolution_)===o||YF(this.image.getResolution())===o)))return this.image;this.wantedProjection_=i,this.wantedExtent_=s,this.wantedResolution_=o,this.image=new hle(s,o,r,this.loader),this.image.addEventListener(wn.CHANGE,this.handleImageChange.bind(this))}return this.image}handleImageChange(e){const n=e.target;let r;switch(n.getState()){case Vt.LOADING:this.loading=!0,r=W6.IMAGELOADSTART;break;case Vt.LOADED:this.loading=!1,r=W6.IMAGELOADEND;break;case Vt.ERROR:this.loading=!1,r=W6.IMAGELOADERROR;break;default:return}this.hasListener(r)&&this.dispatchEvent(new NCe(r,n))}}function LCe(t,e){t.getImage().src=e}function pce(t,e,n,r){const i=e/n,s=gh(t),o=Km(Xn(t)/i,Jm),a=Km(Ps(t)/i,Jm),l=Km((r-1)*o/2,Jm),c=o+2*l,u=Km((r-1)*a/2,Jm),h=a+2*u;return P3(s,i,0,[c,h])}function DCe(t,e,n,r,i,s){const o=i.getCode().split(/:(?=\d+$)/).pop(),a=n/r,l=[C3(Xn(e)/a,Jm),C3(Ps(e)/a,Jm)];s.SIZE=l[0]+","+l[1],s.BBOX=e.join(","),s.BBOXSR=o,s.IMAGESR=o,s.DPI=Math.round(s.DPI?s.DPI*r:90*r);const c=t.replace(/MapServer\/?$/,"MapServer/export").replace(/ImageServer\/?$/,"ImageServer/exportImage");return UG(c,s)}function jCe(t){const e=t.load?t.load:fle,n=Jr(t.projection||"EPSG:3857"),r=t.ratio??1.5,i=t.crossOrigin??null;return function(s,o,a){a=t.hidpi?a:1;const l={F:"image",FORMAT:"PNG32",TRANSPARENT:!0};Object.assign(l,t.params),s=pce(s,o,a,r);const c=DCe(t.url,s,o,a,n,l),u=new Image;return u.crossOrigin=i,e(u,c).then(h=>{const f=Xn(s)/h.width*a;return{image:h,extent:s,resolution:f,pixelRatio:a}})}}class $Ce extends OCe{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:e.interpolate,projection:e.projection,resolutions:e.resolutions}),this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null,this.hidpi_=e.hidpi!==void 0?e.hidpi:!0,this.url_=e.url,this.imageLoadFunction_=e.imageLoadFunction!==void 0?e.imageLoadFunction:LCe,this.params_=Object.assign({},e.params),this.imageSize_=[0,0],this.renderedRevision_=0,this.ratio_=e.ratio!==void 0?e.ratio:1.5,this.loaderProjection_=null}getParams(){return this.params_}getImageInternal(e,n,r,i){return this.url_===void 0?null:((!this.loader||this.loaderProjection_!==i)&&(this.loaderProjection_=i,this.loader=jCe({crossOrigin:this.crossOrigin_,params:this.params_,projection:i,hidpi:this.hidpi_,url:this.url_,ratio:this.ratio_,load:(s,o)=>(this.image.setImage(s),this.imageLoadFunction_(this.image,o),fle(s))})),super.getImageInternal(e,n,r,i))}getImageLoadFunction(){return this.imageLoadFunction_}getUrl(){return this.url_}setImageLoadFunction(e){this.imageLoadFunction_=e,this.changed()}setUrl(e){e!=this.url_&&(this.url_=e,this.loader=null,this.changed())}setParams(e){this.params_=Object.assign({},e),this.changed()}updateParams(e){Object.assign(this.params_,e),this.changed()}changed(){this.image=null,super.changed()}}const XF="1.3.0";function FCe(t,e,n,r,i){i.WIDTH=n[0],i.HEIGHT=n[1];const s=r.getAxisOrientation(),o=Vae(i.VERSION,"1.3")>=0;i[o?"CRS":"SRS"]=r.getCode();const a=o&&s.startsWith("ne")?[e[1],e[0],e[3],e[2]]:e;return i.BBOX=a.join(","),UG(t,i)}function VCe(t,e,n,r,i,s,o){s=Object.assign({REQUEST:"GetMap"},s);const a=e/n,l=[C3(Xn(t)/a,Jm),C3(Ps(t)/a,Jm)];if(n!=1)switch(o){case"geoserver":const u=90*n+.5|0;"FORMAT_OPTIONS"in s?s.FORMAT_OPTIONS+=";dpi:"+u:s.FORMAT_OPTIONS="dpi:"+u;break;case"mapserver":s.MAP_RESOLUTION=90*n;break;case"carmentaserver":case"qgis":s.DPI=90*n;break;default:throw new Error("Unknown `serverType` configured")}return FCe(i,t,l,r,s)}function pZ(t,e){return Object.assign({REQUEST:e,SERVICE:"WMS",VERSION:XF,FORMAT:"image/png",STYLES:"",TRANSPARENT:"TRUE"},t)}const zCe='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.';class GCe extends wy{constructor(e){e=e||{};let n;e.attributions!==void 0?n=e.attributions:n=[zCe];const r=e.crossOrigin!==void 0?e.crossOrigin:"anonymous",i=e.url!==void 0?e.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:n,attributionsCollapsible:!1,cacheSize:e.cacheSize,crossOrigin:r,interpolate:e.interpolate,maxZoom:e.maxZoom!==void 0?e.maxZoom:19,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileLoadFunction:(s,o)=>{const a=s.getImage();!cc&&a instanceof HTMLImageElement&&(a.referrerPolicy="origin-when-cross-origin"),(e.tileLoadFunction||fce)(s,o)},transition:e.transition,url:i,wrapX:e.wrapX,zDirection:e.zDirection})}}const X3=1/0;class UCe{constructor(e,n){this.priorityFunction_=e,this.keyFunction_=n,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,nv(this.queuedElements_)}dequeue(){const e=this.elements_,n=this.priorities_,r=e[0];e.length==1?(e.length=0,n.length=0):(e[0]=e.pop(),n[0]=n.pop(),this.siftUp_(0));const i=this.keyFunction_(r);return delete this.queuedElements_[i],r}enqueue(e){ur(!(this.keyFunction_(e)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const n=this.priorityFunction_(e);return n!=X3?(this.elements_.push(e),this.priorities_.push(n),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(e){return e*2+1}getRightChildIndex_(e){return e*2+2}getParentIndex_(e){return e-1>>1}heapify_(){let e;for(e=(this.elements_.length>>1)-1;e>=0;e--)this.siftUp_(e)}isEmpty(){return this.elements_.length===0}isKeyQueued(e){return e in this.queuedElements_}isQueued(e){return this.isKeyQueued(this.keyFunction_(e))}siftUp_(e){const n=this.elements_,r=this.priorities_,i=n.length,s=n[e],o=r[e],a=e;for(;e<i>>1;){const l=this.getLeftChildIndex_(e),c=this.getRightChildIndex_(e),u=c<i&&r[c]<r[l]?c:l;n[e]=n[u],r[e]=r[u],e=u}n[e]=s,r[e]=o,this.siftDown_(a,e)}siftDown_(e,n){const r=this.elements_,i=this.priorities_,s=r[n],o=i[n];for(;n>e;){const a=this.getParentIndex_(n);if(i[a]>o)r[n]=r[a],i[n]=i[a],n=a;else break}r[n]=s,i[n]=o}reprioritize(){const e=this.priorityFunction_,n=this.elements_,r=this.priorities_;let i=0;const s=n.length;let o,a,l;for(a=0;a<s;++a)o=n[a],l=e(o),l==X3?delete this.queuedElements_[this.keyFunction_(o)]:(r[i]=l,n[i++]=o);n.length=i,r.length=i,this.heapify_()}}class BCe extends UCe{constructor(e,n){super(r=>e.apply(null,r),r=>r[0].getKey()),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=n,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(e){const n=super.enqueue(e);return n&&e[0].addEventListener(wn.CHANGE,this.boundHandleTileChange_),n}getTilesLoading(){return this.tilesLoading_}handleTileChange(e){const n=e.target,r=n.getState();if(r===cn.LOADED||r===cn.ERROR||r===cn.EMPTY){r!==cn.ERROR&&n.removeEventListener(wn.CHANGE,this.boundHandleTileChange_);const i=n.getKey();i in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[i],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(e,n){let r=0;for(;this.tilesLoading_<e&&r<n&&this.getCount()>0;){const i=this.dequeue()[0],s=i.getKey();i.getState()===cn.IDLE&&!(s in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[s]=!0,++this.tilesLoading_,++r,i.load())}}}function WCe(t,e,n,r,i){if(!t||!(n in t.wantedTiles)||!t.wantedTiles[n][e.getKey()])return X3;const s=t.viewState.center,o=r[0]-s[0],a=r[1]-s[1];return 65536*Math.log(i)+Math.sqrt(o*o+a*a)/i}class HCe extends dce{constructor(e){e=e||{};const n=Object.assign({},e.params);super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:e.projection,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileClass:e.tileClass,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0,this.params_=n,this.v13_=!0,this.serverType_=e.serverType,this.hidpi_=e.hidpi!==void 0?e.hidpi:!0,this.tmpExtent_=Ba(),this.updateV13_(),this.setKey(this.getKeyForParams_())}getFeatureInfoUrl(e,n,r,i){const s=Jr(r),o=this.getProjection()||s;let a=this.getTileGrid();a||(a=this.getTileGridForProjection(o));const l=K2(e,s,o),c=H3(o,s,e,n),u=a.getZForResolution(c,this.zDirection),h=a.getResolution(u),f=a.getTileCoordForCoordAndZ(l,u);if(a.getResolutions().length<=f[0])return;let g=a.getTileCoordExtent(f,this.tmpExtent_);const y=this.gutter_;y!==0&&(g=ih(g,h*y,g));const _={QUERY_LAYERS:this.params_.LAYERS};Object.assign(_,pZ(this.params_,"GetFeatureInfo"),i);const b=Math.floor((l[0]-g[0])/h),T=Math.floor((g[3]-l[1])/h);return _[this.v13_?"I":"X"]=b,_[this.v13_?"J":"Y"]=T,this.getRequestUrl_(f,g,1,o||s,_)}getLegendUrl(e,n){if(this.urls[0]===void 0)return;const r={SERVICE:"WMS",VERSION:XF,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(n===void 0||n.LAYER===void 0){const i=this.params_.LAYERS;if(!(!Array.isArray(i)||i.length===1))return;r.LAYER=i}if(e!==void 0){const i=this.getProjection()?this.getProjection().getMetersPerUnit():1,s=28e-5;r.SCALE=e*i/s}return Object.assign(r,n),UG(this.urls[0],r)}getGutter(){return this.gutter_}getParams(){return this.params_}getRequestUrl_(e,n,r,i,s){const o=this.urls;if(!o)return;let a;if(o.length==1)a=o[0];else{const l=fg(ece(e),o.length);a=o[l]}return VCe(n,(this.tileGrid||this.getTileGridForProjection(i)).getResolution(e[0]),r,i,a,s,this.serverType_)}getTilePixelRatio(e){return!this.hidpi_||this.serverType_===void 0?1:e}getKeyForParams_(){let e=0;const n=[];for(const r in this.params_)n[e++]=r+"-"+this.params_[r];return n.join("/")}setParams_(e){this.params_=e,this.updateV13_(),this.setKey(this.getKeyForParams_())}setParams(e){this.setParams_(Object.assign({},e))}updateParams(e){this.setParams_(Object.assign(this.params_,e))}updateV13_(){const e=this.params_.VERSION||XF;this.v13_=Vae(e,"1.3")>=0}tileUrlFunction(e,n,r){let i=this.getTileGrid();if(i||(i=this.getTileGridForProjection(r)),i.getResolutions().length<=e[0])return;n!=1&&(!this.hidpi_||this.serverType_===void 0)&&(n=1);const s=i.getResolution(e[0]);let o=i.getTileCoordExtent(e,this.tmpExtent_);const a=this.gutter_;a!==0&&(o=ih(o,s*a,o));const l=Object.assign({},pZ(this.params_,"GetMap"));return this.getRequestUrl_(e,o,n,r,l)}}class V_ extends Sc{constructor(e,n,r){super(e),this.map=n,this.frameState=r!==void 0?r:null}}class Rf extends V_{constructor(e,n,r,i,s,o){super(e,n,s),this.originalEvent=r,this.pixel_=null,this.coordinate_=null,this.dragging=i!==void 0?i:!1,this.activePointers=o}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(e){this.pixel_=e}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(e){this.coordinate_=e}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const or={SINGLECLICK:"singleclick",CLICK:wn.CLICK,DBLCLICK:wn.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},ZF={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown"};class qCe extends jA{constructor(e,n){super(e),this.map_=e,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=n===void 0?1:n,this.down_=null;const r=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=r,this.pointerdownListenerKey_=Yn(r,ZF.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=Yn(r,ZF.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(wn.TOUCHMOVE,this.boundHandleTouchMove_,lle?{passive:!1}:!1)}emulateClick_(e){let n=new Rf(or.CLICK,this.map_,e);this.dispatchEvent(n),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,n=new Rf(or.DBLCLICK,this.map_,e),this.dispatchEvent(n)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const r=new Rf(or.SINGLECLICK,this.map_,e);this.dispatchEvent(r)},250)}updateActivePointers_(e){const n=e,r=n.pointerId;if(n.type==or.POINTERUP||n.type==or.POINTERCANCEL){delete this.trackedTouches_[r];for(const i in this.trackedTouches_)if(this.trackedTouches_[i].target!==n.target){delete this.trackedTouches_[i];break}}else(n.type==or.POINTERDOWN||n.type==or.POINTERMOVE)&&(this.trackedTouches_[r]=n);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(e){this.updateActivePointers_(e);const n=new Rf(or.POINTERUP,this.map_,e,void 0,void 0,this.activePointers_);this.dispatchEvent(n),this.emulateClicks_&&!n.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(e)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(ni),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(e){return e.button===0}handlePointerDown_(e){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(e);const n=new Rf(or.POINTERDOWN,this.map_,e,void 0,void 0,this.activePointers_);if(this.dispatchEvent(n),this.down_=new PointerEvent(e.type,e),Object.defineProperty(this.down_,"target",{writable:!1,value:e.target}),this.dragListenerKeys_.length===0){const r=this.map_.getOwnerDocument();this.dragListenerKeys_.push(Yn(r,or.POINTERMOVE,this.handlePointerMove_,this),Yn(r,or.POINTERUP,this.handlePointerUp_,this),Yn(this.element_,or.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==r&&this.dragListenerKeys_.push(Yn(this.element_.getRootNode(),or.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(e){if(this.isMoving_(e)){this.updateActivePointers_(e),this.dragging_=!0;const n=new Rf(or.POINTERDRAG,this.map_,e,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(n)}}relayMoveEvent_(e){this.originalPointerMoveEvent_=e;const n=!!(this.down_&&this.isMoving_(e));this.dispatchEvent(new Rf(or.POINTERMOVE,this.map_,e,n))}handleTouchMove_(e){const n=this.originalPointerMoveEvent_;(!n||n.defaultPrevented)&&(typeof e.cancelable!="boolean"||e.cancelable===!0)&&e.preventDefault()}isMoving_(e){return this.dragging_||Math.abs(e.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(e.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(ni(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(wn.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(ni(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(ni),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const _m={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},Jo={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"};class D5 extends Gd{constructor(e){super();const n=e.element;n&&!e.target&&!n.style.pointerEvents&&(n.style.pointerEvents="auto"),this.element=n||null,this.target_=null,this.map_=null,this.listenerKeys=[],e.render&&(this.render=e.render),e.target&&this.setTarget(e.target)}disposeInternal(){this.element?.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(e){this.map_&&this.element?.remove();for(let n=0,r=this.listenerKeys.length;n<r;++n)ni(this.listenerKeys[n]);if(this.listenerKeys.length=0,this.map_=e,e){const n=this.target_??e.getOverlayContainerStopEvent();this.element&&n.appendChild(this.element),this.render!==lk&&this.listenerKeys.push(Yn(e,_m.POSTRENDER,this.render,this)),e.render()}}render(e){}setTarget(e){this.target_=typeof e=="string"?document.getElementById(e):e}}class KCe extends D5{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=e.collapsed!==void 0?e.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=e.collapsible!==void 0,this.collapsible_=e.collapsible!==void 0?e.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.attributions_=e.attributions;const n=e.className!==void 0?e.className:"ol-attribution",r=e.tipLabel!==void 0?e.tipLabel:"Attributions",i=e.expandClassName!==void 0?e.expandClassName:n+"-expand",s=e.collapseLabel!==void 0?e.collapseLabel:"",o=e.collapseClassName!==void 0?e.collapseClassName:n+"-collapse";typeof s=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=s,this.collapseLabel_.className=o):this.collapseLabel_=s;const a=e.label!==void 0?e.label:"i";typeof a=="string"?(this.label_=document.createElement("span"),this.label_.textContent=a,this.label_.className=i):this.label_=a;const l=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=r,this.toggleButton_.appendChild(l),this.toggleButton_.addEventListener(wn.CLICK,this.handleClick_.bind(this),!1);const c=n+" "+GA+" "+pG+(this.collapsed_&&this.collapsible_?" "+kX:"")+(this.collapsible_?"":" ol-uncollapsible"),u=this.element;u.className=c,u.appendChild(this.toggleButton_),u.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(e){const n=this.getMap().getAllLayers(),r=new Set(n.flatMap(i=>i.getAttributions(e)));if(this.attributions_!==void 0&&(Array.isArray(this.attributions_)?this.attributions_.forEach(i=>r.add(i)):r.add(this.attributions_)),!this.overrideCollapsible_){const i=!n.some(s=>s.getSource()?.getAttributionsCollapsible()===!1);this.setCollapsible(i)}return Array.from(r)}async updateElement_(e){if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const n=await Promise.all(this.collectSourceAttributions_(e).map(i=>Nae(()=>i))),r=n.length>0;if(this.renderedVisible_!=r&&(this.element.style.display=r?"":"none",this.renderedVisible_=r),!zd(n,this.renderedAttributions_)){Zke(this.ulElement_);for(let i=0,s=n.length;i<s;++i){const o=document.createElement("li");o.innerHTML=n[i],this.ulElement_.appendChild(o)}this.renderedAttributions_=n}}handleClick_(e){e.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(kX),this.collapsed_?SX(this.collapseLabel_,this.label_):SX(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(e){this.userCollapsed_=e,!(!this.collapsible_||this.collapsed_===e)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(e){this.updateElement_(e.frameState)}}class YCe extends D5{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target});const n=e.className!==void 0?e.className:"ol-rotate",r=e.label!==void 0?e.label:"",i=e.compassClassName!==void 0?e.compassClassName:"ol-compass";this.label_=null,typeof r=="string"?(this.label_=document.createElement("span"),this.label_.className=i,this.label_.textContent=r):(this.label_=r,this.label_.classList.add(i));const s=e.tipLabel?e.tipLabel:"Reset rotation",o=document.createElement("button");o.className=n+"-reset",o.setAttribute("type","button"),o.title=s,o.appendChild(this.label_),o.addEventListener(wn.CLICK,this.handleClick_.bind(this),!1);const a=n+" "+GA+" "+pG,l=this.element;l.className=a,l.appendChild(o),this.callResetNorth_=e.resetNorth?e.resetNorth:void 0,this.duration_=e.duration!==void 0?e.duration:250,this.autoHide_=e.autoHide!==void 0?e.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(hC)}handleClick_(e){e.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const n=this.getMap().getView();if(!n)return;const r=n.getRotation();r!==void 0&&(this.duration_>0&&r%(2*Math.PI)!==0?n.animate({rotation:0,duration:this.duration_,easing:Y2}):n.setRotation(0))}render(e){const n=e.frameState;if(!n)return;const r=n.viewState.rotation;if(r!=this.rotation_){const i="rotate("+r+"rad)";if(this.autoHide_){const s=this.element.classList.contains(hC);!s&&r===0?this.element.classList.add(hC):s&&r!==0&&this.element.classList.remove(hC)}this.label_.style.transform=i}this.rotation_=r}}class XCe extends D5{constructor(e){e=e||{},super({element:document.createElement("div"),target:e.target});const n=e.className!==void 0?e.className:"ol-zoom",r=e.delta!==void 0?e.delta:1,i=e.zoomInClassName!==void 0?e.zoomInClassName:n+"-in",s=e.zoomOutClassName!==void 0?e.zoomOutClassName:n+"-out",o=e.zoomInLabel!==void 0?e.zoomInLabel:"+",a=e.zoomOutLabel!==void 0?e.zoomOutLabel:"",l=e.zoomInTipLabel!==void 0?e.zoomInTipLabel:"Zoom in",c=e.zoomOutTipLabel!==void 0?e.zoomOutTipLabel:"Zoom out",u=document.createElement("button");u.className=i,u.setAttribute("type","button"),u.title=l,u.appendChild(typeof o=="string"?document.createTextNode(o):o),u.addEventListener(wn.CLICK,this.handleClick_.bind(this,r),!1);const h=document.createElement("button");h.className=s,h.setAttribute("type","button"),h.title=c,h.appendChild(typeof a=="string"?document.createTextNode(a):a),h.addEventListener(wn.CLICK,this.handleClick_.bind(this,-r),!1);const f=n+" "+GA+" "+pG,g=this.element;g.className=f,g.appendChild(u),g.appendChild(h),this.duration_=e.duration!==void 0?e.duration:250}handleClick_(e,n){n.preventDefault(),this.zoomByDelta_(e)}zoomByDelta_(e){const r=this.getMap().getView();if(!r)return;const i=r.getZoom();if(i!==void 0){const s=r.getConstrainedZoom(i+e);this.duration_>0?(r.getAnimating()&&r.cancelAnimations(),r.animate({zoom:s,duration:this.duration_,easing:Y2})):r.setZoom(s)}}}function ZCe(t){t=t||{};const e=new Da;return(t.zoom===void 0||t.zoom)&&e.push(new XCe(t.zoomOptions)),(t.rotate===void 0||t.rotate)&&e.push(new YCe(t.rotateOptions)),(t.attribution===void 0||t.attribution)&&e.push(new KCe(t.attributionOptions)),e}class JCe{constructor(e,n,r){this.decay_=e,this.minVelocity_=n,this.delay_=r,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(e,n){this.points_.push(e,n,Date.now())}end(){if(this.points_.length<6)return!1;const e=Date.now()-this.delay_,n=this.points_.length-3;if(this.points_[n+2]<e)return!1;let r=n-3;for(;r>0&&this.points_[r+2]>e;)r-=3;const i=this.points_[n+2]-this.points_[r+2];if(i<1e3/60)return!1;const s=this.points_[n]-this.points_[r],o=this.points_[n+1]-this.points_[r+1];return this.angle_=Math.atan2(o,s),this.initialVelocity_=Math.sqrt(s*s+o*o)/i,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}const JF={ACTIVE:"active"};class X2 extends Gd{constructor(e){super(),this.on,this.once,this.un,e&&e.handleEvent&&(this.handleEvent=e.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(JF.ACTIVE)}getMap(){return this.map_}handleEvent(e){return!0}setActive(e){this.set(JF.ACTIVE,e)}setMap(e){this.map_=e}}function QCe(t,e,n){const r=t.getCenterInternal();if(r){const i=[r[0]+e[0],r[1]+e[1]];t.animateInternal({duration:n!==void 0?n:250,easing:XIe,center:t.getConstrainedCenter(i)})}}function WG(t,e,n,r){const i=t.getZoom();if(i===void 0)return;const s=t.getConstrainedZoom(i+e),o=t.getResolutionForZoom(s);t.getAnimating()&&t.cancelAnimations(),t.animate({resolution:o,anchor:n,duration:r!==void 0?r:250,easing:Y2})}class eRe extends X2{constructor(e){super(),e=e||{},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:250}handleEvent(e){let n=!1;if(e.type==or.DBLCLICK){const r=e.originalEvent,i=e.map,s=e.coordinate,o=r.shiftKey?-this.delta_:this.delta_,a=i.getView();WG(a,o,s,this.duration_),r.preventDefault(),n=!0}return!n}}function QF(t){const e=arguments;return function(n){let r=!0;for(let i=0,s=e.length;i<s&&(r=r&&e[i](n),!!r);++i);return r}}const tRe=function(t){const e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},nRe=function(t){const e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},rRe=function(t){const e=t.map.getTargetElement(),n=e.getRootNode(),r=t.map.getOwnerDocument().activeElement;return n instanceof ShadowRoot?n.host.contains(r):e.contains(r)},mce=function(t){const e=t.map.getTargetElement(),n=e.getRootNode();return(n instanceof ShadowRoot?n.host:e).hasAttribute("tabindex")?rRe(t):!0},Xx=Cg,gce=function(t){const e=t.originalEvent;return"pointerId"in e&&e.button==0&&!(Yke&&ole&&e.ctrlKey)},Z3=W2,yce=function(t){return t.type==or.SINGLECLICK},HG=function(t){const e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},iRe=function(t){const e=t.originalEvent;return ole?e.metaKey:e.ctrlKey},J3=function(t){const e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},vce=function(t){const e=t.originalEvent,n=e.target.tagName;return n!=="INPUT"&&n!=="SELECT"&&n!=="TEXTAREA"&&!e.target.isContentEditable},H6=function(t){const e=t.originalEvent;return"pointerId"in e&&e.pointerType=="mouse"},_ce=function(t){const e=t.originalEvent;return"pointerId"in e&&e.isPrimary&&e.button===0};class av extends X2{constructor(e){e=e||{},super(e),e.handleDownEvent&&(this.handleDownEvent=e.handleDownEvent),e.handleDragEvent&&(this.handleDragEvent=e.handleDragEvent),e.handleMoveEvent&&(this.handleMoveEvent=e.handleMoveEvent),e.handleUpEvent&&(this.handleUpEvent=e.handleUpEvent),e.stopDown&&(this.stopDown=e.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(e){return!1}handleDragEvent(e){}handleEvent(e){if(!e.originalEvent)return!0;let n=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence){if(e.type==or.POINTERDRAG)this.handleDragEvent(e),e.originalEvent.preventDefault();else if(e.type==or.POINTERUP){const r=this.handleUpEvent(e);this.handlingDownUpSequence=r&&this.targetPointers.length>0}}else if(e.type==or.POINTERDOWN){const r=this.handleDownEvent(e);this.handlingDownUpSequence=r,n=this.stopDown(r)}else e.type==or.POINTERMOVE&&this.handleMoveEvent(e);return!n}handleMoveEvent(e){}handleUpEvent(e){return!1}stopDown(e){return e}updateTrackedPointers_(e){e.activePointers&&(this.targetPointers=e.activePointers)}}function qG(t){const e=t.length;let n=0,r=0;for(let i=0;i<e;i++)n+=t[i].clientX,r+=t[i].clientY;return{clientX:n/e,clientY:r/e}}class sRe extends av{constructor(e){super({stopDown:W2}),e=e||{},this.kinetic_=e.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const n=e.condition?e.condition:QF(HG,_ce);this.condition_=e.onFocusOnly?QF(mce,n):n,this.noKinetic_=!1}handleDragEvent(e){const n=e.map;this.panning_||(this.panning_=!0,n.getView().beginInteraction());const r=this.targetPointers,i=n.getEventPixel(qG(r));if(r.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(i[0],i[1]),this.lastCentroid){const s=[this.lastCentroid[0]-i[0],i[1]-this.lastCentroid[1]],a=e.map.getView();JTe(s,a.getResolution()),Kz(s,a.getRotation()),a.adjustCenterInternal(s)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=i,this.lastPointersCount_=r.length,e.originalEvent.preventDefault()}handleUpEvent(e){const n=e.map,r=n.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const i=this.kinetic_.getDistance(),s=this.kinetic_.getAngle(),o=r.getCenterInternal(),a=n.getPixelFromCoordinateInternal(o),l=n.getCoordinateFromPixelInternal([a[0]-i*Math.cos(s),a[1]-i*Math.sin(s)]);r.animateInternal({center:r.getConstrainedCenter(l),duration:500,easing:Y2})}return this.panning_&&(this.panning_=!1,r.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(e){if(this.targetPointers.length>0&&this.condition_(e)){const r=e.map.getView();return this.lastCentroid=null,r.getAnimating()&&r.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}class oRe extends av{constructor(e){e=e||{},super({stopDown:W2}),this.condition_=e.condition?e.condition:nRe,this.lastAngle_=void 0,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){if(!H6(e))return;const n=e.map,r=n.getView();if(r.getConstraints().rotation===AG)return;const i=n.getSize(),s=e.pixel,o=Math.atan2(i[1]/2-s[1],s[0]-i[0]/2);if(this.lastAngle_!==void 0){const a=o-this.lastAngle_;r.adjustRotationInternal(-a)}this.lastAngle_=o}handleUpEvent(e){return H6(e)?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){return H6(e)&&gce(e)&&this.condition_(e)?(e.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}class aRe extends DA{constructor(e){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+e,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const e=this.startPixel_,n=this.endPixel_,r="px",i=this.element_.style;i.left=Math.min(e[0],n[0])+r,i.top=Math.min(e[1],n[1])+r,i.width=Math.abs(n[0]-e[0])+r,i.height=Math.abs(n[1]-e[1])+r}setMap(e){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const n=this.element_.style;n.left="inherit",n.top="inherit",n.width="inherit",n.height="inherit"}this.map_=e,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(e,n){this.startPixel_=e,this.endPixel_=n,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;const e=this.startPixel_,n=this.endPixel_,i=[e,[e[0],n[1]],n,[n[0],e[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);i[4]=i[0].slice(),this.geometry_?this.geometry_.setCoordinates([i]):this.geometry_=new kl([i])}getGeometry(){return this.geometry_}}const d_={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class wE extends Sc{constructor(e,n,r){super(e),this.coordinate=n,this.mapBrowserEvent=r}}class lRe extends av{constructor(e){super(),this.on,this.once,this.un,e=e??{},this.box_=new aRe(e.className||"ol-dragbox"),this.minArea_=e.minArea??64,e.onBoxEnd&&(this.onBoxEnd=e.onBoxEnd),this.startPixel_=null,this.condition_=e.condition??gce,this.boxEndCondition_=e.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(e,n,r){const i=r[0]-n[0],s=r[1]-n[1];return i*i+s*s>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(e){this.startPixel_&&(this.box_.setPixels(this.startPixel_,e.pixel),this.dispatchEvent(new wE(d_.BOXDRAG,e.coordinate,e)))}handleUpEvent(e){if(!this.startPixel_)return!1;const n=this.boxEndCondition_(e,this.startPixel_,e.pixel);return n&&this.onBoxEnd(e),this.dispatchEvent(new wE(n?d_.BOXEND:d_.BOXCANCEL,e.coordinate,e)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(e){return this.condition_(e)?(this.startPixel_=e.pixel,this.box_.setMap(e.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new wE(d_.BOXSTART,e.coordinate,e)),!0):!1}onBoxEnd(e){}setActive(e){e||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new wE(d_.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setActive(e)}setMap(e){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new wE(d_.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setMap(e)}}class cRe extends lRe{constructor(e){e=e||{};const n=e.condition?e.condition:J3;super({condition:n,className:e.className||"ol-dragzoom",minArea:e.minArea}),this.duration_=e.duration!==void 0?e.duration:200,this.out_=e.out!==void 0?e.out:!1}onBoxEnd(e){const r=this.getMap().getView();let i=this.getGeometry();if(this.out_){const s=r.rotatedExtentForGeometry(i),o=r.getResolutionForExtentInternal(s),a=r.getResolution()/o;i=i.clone(),i.scale(a*a)}r.fitInternal(i,{duration:this.duration_,easing:Y2})}}const O0={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};class uRe extends X2{constructor(e){super(),e=e||{},this.defaultCondition_=function(n){return HG(n)&&vce(n)},this.condition_=e.condition!==void 0?e.condition:this.defaultCondition_,this.duration_=e.duration!==void 0?e.duration:100,this.pixelDelta_=e.pixelDelta!==void 0?e.pixelDelta:128}handleEvent(e){let n=!1;if(e.type==wn.KEYDOWN){const r=e.originalEvent,i=r.key;if(this.condition_(e)&&(i==O0.DOWN||i==O0.LEFT||i==O0.RIGHT||i==O0.UP)){const o=e.map.getView(),a=o.getResolution()*this.pixelDelta_;let l=0,c=0;i==O0.DOWN?c=-a:i==O0.LEFT?l=-a:i==O0.RIGHT?l=a:c=a;const u=[l,c];Kz(u,o.getRotation()),QCe(o,u,this.duration_),r.preventDefault(),n=!0}}return!n}}class hRe extends X2{constructor(e){super(),e=e||{},this.condition_=e.condition?e.condition:function(n){return!iRe(n)&&vce(n)},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:100}handleEvent(e){let n=!1;if(e.type==wn.KEYDOWN||e.type==wn.KEYPRESS){const r=e.originalEvent,i=r.key;if(this.condition_(e)&&(i==="+"||i==="-")){const s=e.map,o=i==="+"?this.delta_:-this.delta_,a=s.getView();WG(a,o,void 0,this.duration_),r.preventDefault(),n=!0}}return!n}}const dRe=40,fRe=300;class pRe extends X2{constructor(e){e=e||{},super(e),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=e.maxDelta!==void 0?e.maxDelta:1,this.duration_=e.duration!==void 0?e.duration:250,this.timeout_=e.timeout!==void 0?e.timeout:80,this.useAnchor_=e.useAnchor!==void 0?e.useAnchor:!0,this.constrainResolution_=e.constrainResolution!==void 0?e.constrainResolution:!1;const n=e.condition?e.condition:Xx;this.condition_=e.onFocusOnly?QF(mce,n):n,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const e=this.getMap();if(!e)return;e.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null)}handleEvent(e){if(!this.condition_(e)||e.type!==wn.WHEEL)return!0;const r=e.map,i=e.originalEvent;i.preventDefault(),this.useAnchor_&&(this.lastAnchor_=e.pixel);let s=i.deltaY;switch(i.deltaMode){case WheelEvent.DOM_DELTA_LINE:s*=dRe;break;case WheelEvent.DOM_DELTA_PAGE:s*=fRe;break}if(s===0)return!1;this.lastDelta_=s;const o=Date.now();this.startTime_===void 0&&(this.startTime_=o),(!this.mode_||o-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(s)<4?"trackpad":"wheel");const a=r.getView();if(this.mode_==="trackpad"&&!(a.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(a.getAnimating()&&a.cancelAnimations(),a.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),a.adjustZoom(-s/this.deltaPerZoom_,this.lastAnchor_?r.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=o,!1;this.totalDelta_+=s;const l=Math.max(this.timeout_-(o-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,r),l),!1}handleWheelZoom_(e){const n=e.getView();n.getAnimating()&&n.cancelAnimations();let r=-ri(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(n.getConstrainResolution()||this.constrainResolution_)&&(r=r?r>0?1:-1:0),WG(n,r,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(e){this.useAnchor_=e,e||(this.lastAnchor_=null)}}class mRe extends av{constructor(e){e=e||{};const n=e;n.stopDown||(n.stopDown=W2),super(n),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=e.threshold!==void 0?e.threshold:.3,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){let n=0;const r=this.targetPointers[0],i=this.targetPointers[1],s=Math.atan2(i.clientY-r.clientY,i.clientX-r.clientX);if(this.lastAngle_!==void 0){const l=s-this.lastAngle_;this.rotationDelta_+=l,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),n=l}this.lastAngle_=s;const o=e.map,a=o.getView();a.getConstraints().rotation!==AG&&(this.anchor_=o.getCoordinateFromPixelInternal(o.getEventPixel(qG(this.targetPointers))),this.rotating_&&(o.render(),a.adjustRotationInternal(n,this.anchor_)))}handleUpEvent(e){return this.targetPointers.length<2?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){if(this.targetPointers.length>=2){const n=e.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||n.getView().beginInteraction(),!0}return!1}}class gRe extends av{constructor(e){e=e||{};const n=e;n.stopDown||(n.stopDown=W2),super(n),this.anchor_=null,this.duration_=e.duration!==void 0?e.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(e){let n=1;const r=this.targetPointers[0],i=this.targetPointers[1],s=r.clientX-i.clientX,o=r.clientY-i.clientY,a=Math.sqrt(s*s+o*o);this.lastDistance_!==void 0&&(n=this.lastDistance_/a),this.lastDistance_=a;const l=e.map,c=l.getView();n!=1&&(this.lastScaleDelta_=n),this.anchor_=l.getCoordinateFromPixelInternal(l.getEventPixel(qG(this.targetPointers))),l.render(),c.adjustResolutionInternal(n,this.anchor_)}handleUpEvent(e){if(this.targetPointers.length<2){const r=e.map.getView(),i=this.lastScaleDelta_>1?1:-1;return r.endInteraction(this.duration_,i),!1}return!0}handleDownEvent(e){if(this.targetPointers.length>=2){const n=e.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||n.getView().beginInteraction(),!0}return!1}}function yRe(t){t=t||{};const e=new Da,n=new JCe(-.005,.05,100);return(t.altShiftDragRotate===void 0||t.altShiftDragRotate)&&e.push(new oRe),(t.doubleClickZoom===void 0||t.doubleClickZoom)&&e.push(new eRe({delta:t.zoomDelta,duration:t.zoomDuration})),(t.dragPan===void 0||t.dragPan)&&e.push(new sRe({onFocusOnly:t.onFocusOnly,kinetic:n})),(t.pinchRotate===void 0||t.pinchRotate)&&e.push(new mRe),(t.pinchZoom===void 0||t.pinchZoom)&&e.push(new gRe({duration:t.zoomDuration})),(t.keyboard===void 0||t.keyboard)&&(e.push(new uRe),e.push(new hRe({delta:t.zoomDelta,duration:t.zoomDuration}))),(t.mouseWheelZoom===void 0||t.mouseWheelZoom)&&e.push(new pRe({onFocusOnly:t.onFocusOnly,duration:t.zoomDuration})),(t.shiftDragZoom===void 0||t.shiftDragZoom)&&e.push(new cRe({duration:t.zoomDuration})),e}class vRe extends DA{constructor(e){super(),this.map_=e}dispatchRenderEvent(e,n){bn()}calculateMatrices2D(e){const n=e.viewState,r=e.coordinateToPixelTransform,i=e.pixelToCoordinateTransform;pu(r,e.size[0]/2,e.size[1]/2,1/n.resolution,-1/n.resolution,-n.rotation,-n.center[0],-n.center[1]),hk(i,r)}forEachFeatureAtCoordinate(e,n,r,i,s,o,a,l){let c;const u=n.viewState;function h(P,R,D,C){return s.call(o,R,P?D:null,C)}const f=u.projection,g=zae(e.slice(),f),y=[[0,0]];if(f.canWrapX()&&i){const P=f.getExtent(),R=Xn(P);y.push([-R,0],[R,0])}const _=n.layerStatesArray,b=_.length,T=[],A=[];for(let P=0;P<y.length;P++)for(let R=b-1;R>=0;--R){const D=_[R],C=D.layer;if(C.hasRenderer()&&PG(D,u)&&a.call(l,C)){const M=C.getRenderer(),O=C.getSource();if(M&&O){const j=O.getWrapX()?g:e,V=h.bind(null,D.managed);A[0]=j[0]+y[P][0],A[1]=j[1]+y[P][1],c=M.forEachFeatureAtCoordinate(A,n,r,V,T)}if(c)return c}}if(T.length===0)return;const I=1/T.length;return T.forEach((P,R)=>P.distanceSq+=R*I),T.sort((P,R)=>P.distanceSq-R.distanceSq),T.some(P=>c=P.callback(P.feature,P.layer,P.geometry)),c}hasFeatureAtCoordinate(e,n,r,i,s,o){return this.forEachFeatureAtCoordinate(e,n,r,i,Cg,this,s,o)!==void 0}getMap(){return this.map_}renderFrame(e){bn()}scheduleExpireIconCache(e){nu.canExpireCache()&&e.postRenderFunctions.push(_Re)}}function _Re(t,e){nu.expire()}class xRe extends vRe{constructor(e){super(e),this.fontChangeListenerKey_=Yn(j_,Kw.PROPERTYCHANGE,e.redrawText,e),this.element_=cc?cle():document.createElement("div");const n=this.element_.style;n.position="absolute",n.width="100%",n.height="100%",n.zIndex="0",this.element_.className=GA+" ol-layers";const r=e.getViewport();r&&r.insertBefore(this.element_,r.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(e,n){const r=this.getMap();if(r.hasListener(e)){const i=new eT(e,void 0,n);r.dispatchEvent(i)}}disposeInternal(){ni(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(e){if(!e){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(e),this.dispatchRenderEvent(co.PRECOMPOSE,e);const n=e.layerStatesArray.sort((c,u)=>c.zIndex-u.zIndex);n.some(c=>c.layer instanceof N5&&c.layer.getDeclutter())&&(e.declutter={});const i=e.viewState;this.children_.length=0;const s=[];let o=null;for(let c=0,u=n.length;c<u;++c){const h=n[c];e.layerIndex=c;const f=h.layer,g=f.getSourceState();if(!PG(h,i)||g!="ready"&&g!="undefined"){f.unrender();continue}const y=f.render(e,o);y&&(y!==o&&(this.children_.push(y),o=y),s.push(h))}this.declutter(e,s),Jke(this.element_,this.children_);const l=this.getMap().getTargetElement();if(Xm(l)){const c=l.getContext("2d");for(const u of this.children_){const h=u.firstElementChild||u,f=u.style.backgroundColor;if(f&&(!Xm(h)||h.width>0)&&(c.fillStyle=f,c.fillRect(0,0,l.width,l.height)),Xm(h)&&h.width>0){const g=u.style.opacity||h.style.opacity;c.globalAlpha=g===""?1:Number(g);const y=h.style.transform;if(y)c.setTransform(...LF(y));else{const _=parseFloat(h.style.width)/h.width,b=parseFloat(h.style.height)/h.height;c.setTransform(_,0,0,b,0,0)}c.drawImage(h,0,0)}}c.globalAlpha=1,c.setTransform(1,0,0,1,0,0)}this.dispatchRenderEvent(co.POSTCOMPOSE,e),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(e)}declutter(e,n){if(e.declutter){for(let r=n.length-1;r>=0;--r){const i=n[r],s=i.layer;s.getDeclutter()&&s.renderDeclutter(e,i)}n.forEach(r=>r.layer.renderDeferred(e))}}}function xce(t){if(t instanceof HA){t.setMapInternal(null);return}t instanceof O5&&t.getLayers().forEach(xce)}function wce(t,e){if(t instanceof HA){t.setMapInternal(e);return}if(t instanceof O5){const n=t.getLayers().getArray();for(let r=0,i=n.length;r<i;++r)wce(n[r],e)}}let wRe=class extends Gd{constructor(e){super(),e=e||{},this.on,this.once,this.un;const n=bRe(e);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=e.maxTilesLoading!==void 0?e.maxTilesLoading:16,this.pixelRatio_=e.pixelRatio!==void 0?e.pixelRatio:Xke,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=Ws(),this.pixelToCoordinateTransform_=Ws(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,cc||(this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_)),this.mapBrowserEventHandler_=null,this.moveTolerance_=e.moveTolerance,this.keyboardEventTarget_=n.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,cc||(this.resizeObserver_=new ResizeObserver(()=>this.updateSize())),this.controls=n.controls||(cc?new Da:ZCe()),this.interactions=n.interactions||(cc?new Da:yRe({onFocusOnly:!0})),this.overlays_=n.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new BCe(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(Jo.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(Jo.VIEW,this.handleViewChanged_),this.addChangeListener(Jo.SIZE,this.handleSizeChanged_),this.addChangeListener(Jo.TARGET,this.handleTargetChanged_),this.setProperties(n.values);const r=this;e.view&&!(e.view instanceof hd)&&e.view.then(function(i){r.setView(new hd(i))}),this.controls.addEventListener(As.ADD,i=>{i.element.setMap(this)}),this.controls.addEventListener(As.REMOVE,i=>{i.element.setMap(null)}),this.interactions.addEventListener(As.ADD,i=>{i.element.setMap(this)}),this.interactions.addEventListener(As.REMOVE,i=>{i.element.setMap(null)}),this.overlays_.addEventListener(As.ADD,i=>{this.addOverlayInternal_(i.element)}),this.overlays_.addEventListener(As.REMOVE,i=>{const s=i.element.getId();s!==void 0&&delete this.overlayIdIndex_[s.toString()],i.element.setMap(null)}),this.controls.forEach(i=>{i.setMap(this)}),this.interactions.forEach(i=>{i.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(e){this.getControls().push(e)}addInteraction(e){this.getInteractions().push(e)}addLayer(e){this.getLayerGroup().getLayers().push(e)}handleLayerAdd_(e){wce(e.layer,this)}addOverlay(e){this.getOverlays().push(e)}addOverlayInternal_(e){const n=e.getId();n!==void 0&&(this.overlayIdIndex_[n.toString()]=e),e.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_?.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(e,n,r){if(!this.frameState_||!this.renderer_)return;const i=this.getCoordinateFromPixelInternal(e);r=r!==void 0?r:{};const s=r.hitTolerance!==void 0?r.hitTolerance:0,o=r.layerFilter!==void 0?r.layerFilter:Cg,a=r.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(i,this.frameState_,s,a,n,null,o,null)}getFeaturesAtPixel(e,n){const r=[];return this.forEachFeatureAtPixel(e,function(i){r.push(i)},n),r}getAllLayers(){const e=[];function n(r){r.forEach(function(i){i instanceof O5?n(i.getLayers()):e.push(i)})}return n(this.getLayers()),e}hasFeatureAtPixel(e,n){if(!this.frameState_||!this.renderer_)return!1;const r=this.getCoordinateFromPixelInternal(e);n=n!==void 0?n:{};const i=n.layerFilter!==void 0?n.layerFilter:Cg,s=n.hitTolerance!==void 0?n.hitTolerance:0,o=n.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(r,this.frameState_,s,o,i,null)}getEventCoordinate(e){return this.getCoordinateFromPixel(this.getEventPixel(e))}getEventCoordinateInternal(e){return this.getCoordinateFromPixelInternal(this.getEventPixel(e))}getEventPixel(e){const r=this.viewport_.getBoundingClientRect(),i=this.getSize(),s=r.width/i[0],o=r.height/i[1],a="changedTouches"in e?e.changedTouches[0]:e;return[(a.clientX-r.left)/s,(a.clientY-r.top)/o]}getTarget(){return this.get(Jo.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(e){return b1(this.getCoordinateFromPixelInternal(e),this.getView().getProjection())}getCoordinateFromPixelInternal(e){const n=this.frameState_;return n?Zi(n.pixelToCoordinateTransform,e.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(e){const n=this.overlayIdIndex_[e.toString()];return n!==void 0?n:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(Jo.LAYERGROUP)}setLayers(e){const n=this.getLayerGroup();if(e instanceof Da){n.setLayers(e);return}const r=n.getLayers();r.clear(),r.extend(e)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const e=this.getLayerGroup().getLayerStatesArray();for(let n=0,r=e.length;n<r;++n){const i=e[n];if(!i.visible)continue;const s=i.layer.getRenderer();if(s&&!s.ready)return!0;const o=i.layer.getSource();if(o&&o.loading)return!0}return!1}getPixelFromCoordinate(e){const n=Li(e,this.getView().getProjection());return this.getPixelFromCoordinateInternal(n)}getPixelFromCoordinateInternal(e){const n=this.frameState_;return n?Zi(n.coordinateToPixelTransform,e.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(Jo.SIZE)}getView(){return this.get(Jo.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const e=this.getTargetElement();return e?e.ownerDocument:document}getTilePriority(e,n,r,i){return WCe(this.frameState_,e,n,r,i)}handleBrowserEvent(e,n){n=n||e.type;const r=new Rf(n,this,e);this.handleMapBrowserEvent(r)}handleMapBrowserEvent(e){if(!this.frameState_)return;const n=e.originalEvent,r=n.type;if(r===ZF.POINTERDOWN||r===wn.WHEEL||r===wn.KEYDOWN){const i=this.getOwnerDocument(),s=this.viewport_.getRootNode?this.viewport_.getRootNode():i,o=n.target,a=s instanceof ShadowRoot?s.host===o?s.host.ownerDocument:s:s===i?i.documentElement:s;if(this.overlayContainerStopEvent_.contains(o)||!a.contains(o))return}if(e.frameState=this.frameState_,this.dispatchEvent(e)!==!1){const i=this.getInteractions().getArray().slice();for(let s=i.length-1;s>=0;s--){const o=i[s];if(o.getMap()!==this||!o.getActive()||!this.getTargetElement())continue;if(!o.handleEvent(e)||e.propagationStopped)break}}}handlePostRender(){const e=this.frameState_,n=this.tileQueue_;if(!n.isEmpty()){let i=this.maxTilesLoading_,s=i;if(e){const o=e.viewHints;if(o[Ts.ANIMATING]||o[Ts.INTERACTING]){const a=Date.now()-e.time>8;i=a?0:8,s=a?0:2}}n.getTilesLoading()<i&&(n.reprioritize(),n.loadMoreTiles(i,s))}e&&this.renderer_&&!e.animate&&(this.renderComplete_?(this.hasListener(co.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(co.RENDERCOMPLETE,e),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new V_(_m.LOADEND,this,e)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new V_(_m.LOADSTART,this,e))));const r=this.postRenderFunctions_;if(e)for(let i=0,s=r.length;i<s;++i)r[i](this,e);r.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let r=0,i=this.targetChangeHandlerKeys_.length;r<i;++r)ni(this.targetChangeHandlerKeys_[r]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(wn.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(wn.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_&&!Xm(this.targetElement_)){this.resizeObserver_?.unobserve(this.targetElement_);const r=this.targetElement_.getRootNode();r instanceof ShadowRoot&&this.resizeObserver_.unobserve(r.host),this.setSize(void 0)}const e=this.getTarget(),n=typeof e=="string"?document.getElementById(e):e;if(this.targetElement_=n,!n)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{if(Xm(n)||n.appendChild(this.viewport_),this.renderer_||(this.renderer_=new xRe(this)),!Xm(n)){this.mapBrowserEventHandler_=new qCe(this,this.moveTolerance_);for(const i in or)this.mapBrowserEventHandler_.addEventListener(or[i],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(wn.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(wn.WHEEL,this.boundHandleBrowserEvent_,lle?{passive:!1}:!1);let r;if(this.keyboardEventTarget_)r=this.keyboardEventTarget_;else{const i=n.getRootNode();r=i instanceof ShadowRoot?i.host:n}if(this.targetChangeHandlerKeys_=[Yn(r,wn.KEYDOWN,this.handleBrowserEvent,this),Yn(r,wn.KEYPRESS,this.handleBrowserEvent,this)],n instanceof HTMLElement){const i=n.getRootNode();i instanceof ShadowRoot&&this.resizeObserver_.observe(i.host),this.resizeObserver_?.observe(n)}}this.updateSize()}}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(ni(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(ni(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const e=this.getView();e&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=Yn(e,Kw.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=Yn(e,wn.CHANGE,this.handleViewPropertyChanged_,this),e.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(ni),this.layerGroupPropertyListenerKeys_=null);const e=this.getLayerGroup();e&&(this.handleLayerAdd_(new Mm("addlayer",e)),this.layerGroupPropertyListenerKeys_=[Yn(e,Kw.PROPERTYCHANGE,this.render,this),Yn(e,wn.CHANGE,this.render,this),Yn(e,"addlayer",this.handleLayerAdd_,this),Yn(e,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){if(!this.frameState_)return;const e=this.frameState_.layerStatesArray;for(let n=0,r=e.length;n<r;++n){const i=e[n].layer;i.hasRenderer()&&i.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(e){return this.getControls().remove(e)}removeInteraction(e){return this.getInteractions().remove(e)}removeLayer(e){return this.getLayerGroup().getLayers().remove(e)}handleLayerRemove_(e){xce(e.layer)}removeOverlay(e){return this.getOverlays().remove(e)}renderFrame_(e){const n=this.getSize(),r=this.getView(),i=this.frameState_;let s=null;if(n!==void 0&&jX(n)&&r&&r.isDef()){const o=r.getHints(this.frameState_?this.frameState_.viewHints:void 0),a=r.getState();if(s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:P3(a.center,a.resolution,a.rotation,n),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:n,tileQueue:this.tileQueue_,time:e,usedTiles:{},viewState:a,viewHints:o,wantedTiles:{},mapId:Qt(this),renderTargets:{}},a.nextCenter&&a.nextResolution){const l=isNaN(a.nextRotation)?a.rotation:a.nextRotation;s.nextExtent=P3(a.nextCenter,a.nextResolution,l,n)}}this.frameState_=s,this.renderer_.renderFrame(s),s&&(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),i&&(!this.previousExtent_||!H2(this.previousExtent_)&&!x1(s.extent,this.previousExtent_))&&(this.dispatchEvent(new V_(_m.MOVESTART,this,i)),this.previousExtent_=FA(this.previousExtent_)),this.previousExtent_&&!s.viewHints[Ts.ANIMATING]&&!s.viewHints[Ts.INTERACTING]&&!x1(s.extent,this.previousExtent_)&&(this.dispatchEvent(new V_(_m.MOVEEND,this,s)),Lae(s.extent,this.previousExtent_))),this.dispatchEvent(new V_(_m.POSTRENDER,this,s)),this.renderComplete_=(this.hasListener(_m.LOADSTART)||this.hasListener(_m.LOADEND)||this.hasListener(co.RENDERCOMPLETE))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(e){const n=this.getLayerGroup();n&&this.handleLayerRemove_(new Mm("removelayer",n)),this.set(Jo.LAYERGROUP,e)}setSize(e){this.set(Jo.SIZE,e)}setTarget(e){this.set(Jo.TARGET,e)}setView(e){if(!e||e instanceof hd){this.set(Jo.VIEW,e);return}this.set(Jo.VIEW,new hd);const n=this;e.then(function(r){n.setView(new hd(r))})}updateSize(){const e=this.getTargetElement();let n;if(e){let i,s;if(Xm(e))i=e.width,s=e.height;else{const o=getComputedStyle(e);i=e.offsetWidth-parseFloat(o.borderLeftWidth)-parseFloat(o.paddingLeft)-parseFloat(o.paddingRight)-parseFloat(o.borderRightWidth),s=e.offsetHeight-parseFloat(o.borderTopWidth)-parseFloat(o.paddingTop)-parseFloat(o.paddingBottom)-parseFloat(o.borderBottomWidth)}!isNaN(i)&&!isNaN(s)&&(n=[Math.max(0,i),Math.max(0,s)],!jX(n)&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)&&Uae("No map visible because the map container's width or height are 0."))}const r=this.getSize();n&&(!r||!zd(n,r))&&(this.setSize(n),this.updateViewportSize_(n))}updateViewportSize_(e){const n=this.getView();n&&n.setViewportSize(e)}};function bRe(t){let e=null;t.keyboardEventTarget!==void 0&&(e=typeof t.keyboardEventTarget=="string"?document.getElementById(t.keyboardEventTarget):t.keyboardEventTarget);const n={},r=t.layers&&typeof t.layers.getLayers=="function"?t.layers:new O5({layers:t.layers});n[Jo.LAYERGROUP]=r,n[Jo.TARGET]=t.target,n[Jo.VIEW]=t.view instanceof hd?t.view:new hd;let i;t.controls!==void 0&&(Array.isArray(t.controls)?i=new Da(t.controls.slice()):(ur(typeof t.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),i=t.controls));let s;t.interactions!==void 0&&(Array.isArray(t.interactions)?s=new Da(t.interactions.slice()):(ur(typeof t.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),s=t.interactions));let o;return t.overlays!==void 0?Array.isArray(t.overlays)?o=new Da(t.overlays.slice()):(ur(typeof t.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),o=t.overlays):o=new Da,{controls:i,interactions:s,keyboardEventTarget:e,overlays:o,values:n}}const q6="units",ERe=[1,2,5],bE=25.4/.28;class SRe extends D5{constructor(e){e=e||{};const n=document.createElement("div");n.style.pointerEvents="none",super({element:n,render:e.render,target:e.target}),this.on,this.once,this.un;const r=e.className!==void 0?e.className:e.bar?"ol-scale-bar":"ol-scale-line";this.innerElement_=document.createElement("div"),this.innerElement_.className=r+"-inner",this.element.className=r+" "+GA,this.element.appendChild(this.innerElement_),this.viewState_=null,this.minWidth_=e.minWidth!==void 0?e.minWidth:64,this.maxWidth_=e.maxWidth,this.renderedVisible_=!1,this.renderedWidth_=void 0,this.renderedHTML_="",this.addChangeListener(q6,this.handleUnitsChanged_),this.setUnits(e.units||"metric"),this.scaleBar_=e.bar||!1,this.scaleBarSteps_=e.steps||4,this.scaleBarText_=e.text||!1,this.dpi_=e.dpi||void 0}getUnits(){return this.get(q6)}handleUnitsChanged_(){this.updateElement_()}setUnits(e){this.set(q6,e)}setDpi(e){this.dpi_=e}updateElement_(){const e=this.viewState_;if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const n=e.center,r=e.projection,i=this.getUnits(),s=i=="degrees"?"degrees":"m";let o=O3(r,e.resolution,n,s);const a=this.minWidth_*(this.dpi_||bE)/bE,l=this.maxWidth_!==void 0?this.maxWidth_*(this.dpi_||bE)/bE:void 0;let c=a*o,u="";if(i=="degrees"){const I=Xw.degrees;c*=I,c<I/60?(u="",o*=3600):c<I?(u="",o*=60):u=""}else if(i=="imperial")c<.9144?(u="in",o/=.0254):c<1609.344?(u="ft",o/=.3048):(u="mi",o/=1609.344);else if(i=="nautical")o/=1852,u="NM";else if(i=="metric")c<1e-6?(u="nm",o*=1e9):c<.001?(u="m",o*=1e6):c<1?(u="mm",o*=1e3):c<1e3?u="m":(u="km",o/=1e3);else if(i=="us")c<.9144?(u="in",o*=39.37):c<1609.344?(u="ft",o/=.30480061):(u="mi",o/=1609.3472);else throw new Error("Invalid units");let h=3*Math.floor(Math.log(a*o)/Math.log(10)),f,g,y,_=0,b,T;for(;;){y=Math.floor(h/3);const I=Math.pow(10,y);if(f=ERe[(h%3+3)%3]*I,g=Math.round(f/o),isNaN(g)){this.element.style.display="none",this.renderedVisible_=!1;return}if(l!==void 0&&g>=l){f=_,g=b,y=T;break}else if(g>=a)break;_=f,b=g,T=y,++h}const A=this.scaleBar_?this.createScaleBar(g,f,u):f.toFixed(y<0?-y:0)+" "+u;this.renderedHTML_!=A&&(this.innerElement_.innerHTML=A,this.renderedHTML_=A),this.renderedWidth_!=g&&(this.innerElement_.style.width=g+"px",this.renderedWidth_=g),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}createScaleBar(e,n,r){const i=this.getScaleForResolution(),s=i<1?Math.round(1/i).toLocaleString()+" : 1":"1 : "+Math.round(i).toLocaleString(),o=this.scaleBarSteps_,a=e/o,l=[this.createMarker("absolute")];for(let u=0;u<o;++u){const h=u%2===0?"ol-scale-singlebar-odd":"ol-scale-singlebar-even";l.push(`<div><div class="ol-scale-singlebar ${h}" style="width: ${a}px;"></div>`+this.createMarker("relative")+(u%2===0||o===2?this.createStepText(u,e,!1,n,r):"")+"</div>")}return l.push(this.createStepText(o,e,!0,n,r)),(this.scaleBarText_?`<div class="ol-scale-text" style="width: ${e}px;">`+s+"</div>":"")+l.join("")}createMarker(e){return`<div class="ol-scale-step-marker" style="position: ${e}; top: ${e==="absolute"?3:-10}px;"></div>`}createStepText(e,n,r,i,s){const a=(e===0?0:Math.round(i/this.scaleBarSteps_*e*100)/100)+(e===0?"":" "+s),l=e===0?-3:n/this.scaleBarSteps_*-1,c=e===0?0:n/this.scaleBarSteps_*2;return`<div class="ol-scale-step-text" style="margin-left: ${l}px;text-align: ${e===0?"left":"center"};min-width: ${c}px;left: ${r?n+"px":"unset"};">`+a+"</div>"}getScaleForResolution(){const e=O3(this.viewState_.projection,this.viewState_.resolution,this.viewState_.center,"m"),n=this.dpi_||bE,r=1e3/25.4;return e*r*n}render(e){const n=e.frameState;n?this.viewState_=n.viewState:this.viewState_=null,this.updateElement_()}}const TRe={},mZ=t=>{let e;const n=new Set,r=(u,h)=>{const f=typeof u=="function"?u(e):u;if(!Object.is(f,e)){const g=e;e=h??(typeof f!="object"||f===null)?f:Object.assign({},e,f),n.forEach(y=>y(e,g))}},i=()=>e,l={setState:r,getState:i,getInitialState:()=>c,subscribe:u=>(n.add(u),()=>n.delete(u)),destroy:()=>{(TRe?"commercial":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},c=e=t(r,i,l);return l},kRe=t=>t?mZ(t):mZ;var K6={exports:{}},Y6={},X6={exports:{}},Z6={};var gZ;function ARe(){if(gZ)return Z6;gZ=1;var t=LA();function e(h,f){return h===f&&(h!==0||1/h===1/f)||h!==h&&f!==f}var n=typeof Object.is=="function"?Object.is:e,r=t.useState,i=t.useEffect,s=t.useLayoutEffect,o=t.useDebugValue;function a(h,f){var g=f(),y=r({inst:{value:g,getSnapshot:f}}),_=y[0].inst,b=y[1];return s(function(){_.value=g,_.getSnapshot=f,l(_)&&b({inst:_})},[h,g,f]),i(function(){return l(_)&&b({inst:_}),h(function(){l(_)&&b({inst:_})})},[h]),o(g),g}function l(h){var f=h.getSnapshot;h=h.value;try{var g=f();return!n(h,g)}catch{return!0}}function c(h,f){return f()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:a;return Z6.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:u,Z6}var yZ;function IRe(){return yZ||(yZ=1,X6.exports=ARe()),X6.exports}var vZ;function PRe(){if(vZ)return Y6;vZ=1;var t=LA(),e=IRe();function n(c,u){return c===u&&(c!==0||1/c===1/u)||c!==c&&u!==u}var r=typeof Object.is=="function"?Object.is:n,i=e.useSyncExternalStore,s=t.useRef,o=t.useEffect,a=t.useMemo,l=t.useDebugValue;return Y6.useSyncExternalStoreWithSelector=function(c,u,h,f,g){var y=s(null);if(y.current===null){var _={hasValue:!1,value:null};y.current=_}else _=y.current;y=a(function(){function T(D){if(!A){if(A=!0,I=D,D=f(D),g!==void 0&&_.hasValue){var C=_.value;if(g(C,D))return P=C}return P=D}if(C=P,r(I,D))return C;var M=f(D);return g!==void 0&&g(C,M)?(I=D,C):(I=D,P=M)}var A=!1,I,P,R=h===void 0?null:h;return[function(){return T(u())},R===null?void 0:function(){return T(R())}]},[u,h,f,g]);var b=i(c,y[0],y[1]);return o(function(){_.hasValue=!0,_.value=b},[b]),l(b),b},Y6}var _Z;function CRe(){return _Z||(_Z=1,K6.exports=PRe()),K6.exports}var RRe=CRe();const MRe=Gz(RRe),bce={},{useDebugValue:NRe}=$Te,{useSyncExternalStoreWithSelector:ORe}=MRe;let xZ=!1;const LRe=t=>t;function DRe(t,e=LRe,n){(bce?"commercial":void 0)!=="production"&&n&&!xZ&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),xZ=!0);const r=ORe(t.subscribe,t.getState,t.getServerState||t.getInitialState,e,n);return NRe(r),r}const wZ=t=>{(bce?"commercial":void 0)!=="production"&&typeof t!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof t=="function"?kRe(t):t,n=(r,i)=>DRe(e,r,i);return Object.assign(n,e),n},yo=t=>t?wZ(t):wZ;var Ece=Symbol.for("immer-nothing"),bZ=Symbol.for("immer-draftable"),vc=Symbol.for("immer-state");function Qu(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var wk=Object.getPrototypeOf;function e2(t){return!!t&&!!t[vc]}function S1(t){return t?Sce(t)||Array.isArray(t)||!!t[bZ]||!!t.constructor?.[bZ]||qA(t)||$5(t):!1}var jRe=Object.prototype.constructor.toString(),EZ=new WeakMap;function Sce(t){if(!t||typeof t!="object")return!1;const e=Object.getPrototypeOf(t);if(e===null||e===Object.prototype)return!0;const n=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;if(n===Object)return!0;if(typeof n!="function")return!1;let r=EZ.get(n);return r===void 0&&(r=Function.toString.call(n),EZ.set(n,r)),r===jRe}function Q3(t,e,n=!0){j5(t)===0?(n?Reflect.ownKeys(t):Object.keys(t)).forEach(i=>{e(i,t[i],t)}):t.forEach((r,i)=>e(i,r,t))}function j5(t){const e=t[vc];return e?e.type_:Array.isArray(t)?1:qA(t)?2:$5(t)?3:0}function e8(t,e){return j5(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function Tce(t,e,n){const r=j5(t);r===2?t.set(e,n):r===3?t.add(n):t[e]=n}function $Re(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function qA(t){return t instanceof Map}function $5(t){return t instanceof Set}function K0(t){return t.copy_||t.base_}function t8(t,e){if(qA(t))return new Map(t);if($5(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const n=Sce(t);if(e===!0||e==="class_only"&&!n){const r=Object.getOwnPropertyDescriptors(t);delete r[vc];let i=Reflect.ownKeys(r);for(let s=0;s<i.length;s++){const o=i[s],a=r[o];a.writable===!1&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(r[o]={configurable:!0,writable:!0,enumerable:a.enumerable,value:t[o]})}return Object.create(wk(t),r)}else{const r=wk(t);if(r!==null&&n)return{...t};const i=Object.create(r);return Object.assign(i,t)}}function KG(t,e=!1){return F5(t)||e2(t)||!S1(t)||(j5(t)>1&&Object.defineProperties(t,{set:xC,add:xC,clear:xC,delete:xC}),Object.freeze(t),e&&Object.values(t).forEach(n=>KG(n,!0))),t}function FRe(){Qu(2)}var xC={value:FRe};function F5(t){return t===null||typeof t!="object"?!0:Object.isFrozen(t)}var VRe={};function T1(t){const e=VRe[t];return e||Qu(0,t),e}var bk;function kce(){return bk}function zRe(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function SZ(t,e){e&&(T1("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function n8(t){r8(t),t.drafts_.forEach(GRe),t.drafts_=null}function r8(t){t===bk&&(bk=t.parent_)}function TZ(t){return bk=zRe(bk,t)}function GRe(t){const e=t[vc];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function kZ(t,e){e.unfinalizedDrafts_=e.drafts_.length;const n=e.drafts_[0];return t!==void 0&&t!==n?(n[vc].modified_&&(n8(e),Qu(4)),S1(t)&&(t=e4(e,t),e.parent_||t4(e,t)),e.patches_&&T1("Patches").generateReplacementPatches_(n[vc].base_,t,e.patches_,e.inversePatches_)):t=e4(e,n,[]),n8(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==Ece?t:void 0}function e4(t,e,n){if(F5(e))return e;const r=t.immer_.shouldUseStrictIteration(),i=e[vc];if(!i)return Q3(e,(s,o)=>AZ(t,i,e,s,o,n),r),e;if(i.scope_!==t)return e;if(!i.modified_)return t4(t,i.base_,!0),i.base_;if(!i.finalized_){i.finalized_=!0,i.scope_.unfinalizedDrafts_--;const s=i.copy_;let o=s,a=!1;i.type_===3&&(o=new Set(s),s.clear(),a=!0),Q3(o,(l,c)=>AZ(t,i,s,l,c,n,a),r),t4(t,s,!1),n&&t.patches_&&T1("Patches").generatePatches_(i,n,t.patches_,t.inversePatches_)}return i.copy_}function AZ(t,e,n,r,i,s,o){if(i==null||typeof i!="object"&&!o)return;const a=F5(i);if(!(a&&!o)){if(e2(i)){const l=s&&e&&e.type_!==3&&!e8(e.assigned_,r)?s.concat(r):void 0,c=e4(t,i,l);if(Tce(n,r,c),e2(c))t.canAutoFreeze_=!1;else return}else o&&n.add(i);if(S1(i)&&!a){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1||e&&e.base_&&e.base_[r]===i&&a)return;e4(t,i),(!e||!e.scope_.parent_)&&typeof r!="symbol"&&(qA(n)?n.has(r):Object.prototype.propertyIsEnumerable.call(n,r))&&t4(t,i)}}}function t4(t,e,n=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&KG(e,n)}function URe(t,e){const n=Array.isArray(t),r={type_:n?1:0,scope_:e?e.scope_:kce(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=r,s=YG;n&&(i=[r],s=Ek);const{revoke:o,proxy:a}=Proxy.revocable(i,s);return r.draft_=a,r.revoke_=o,a}var YG={get(t,e){if(e===vc)return t;const n=K0(t);if(!e8(n,e))return BRe(t,n,e);const r=n[e];return t.finalized_||!S1(r)?r:r===J6(t.base_,e)?(Q6(t),t.copy_[e]=s8(r,t)):r},has(t,e){return e in K0(t)},ownKeys(t){return Reflect.ownKeys(K0(t))},set(t,e,n){const r=Ace(K0(t),e);if(r?.set)return r.set.call(t.draft_,n),!0;if(!t.modified_){const i=J6(K0(t),e),s=i?.[vc];if(s&&s.base_===n)return t.copy_[e]=n,t.assigned_[e]=!1,!0;if($Re(n,i)&&(n!==void 0||e8(t.base_,e)))return!0;Q6(t),i8(t)}return t.copy_[e]===n&&(n!==void 0||e in t.copy_)||Number.isNaN(n)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=n,t.assigned_[e]=!0),!0},deleteProperty(t,e){return J6(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,Q6(t),i8(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const n=K0(t),r=Reflect.getOwnPropertyDescriptor(n,e);return r&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:r.enumerable,value:n[e]}},defineProperty(){Qu(11)},getPrototypeOf(t){return wk(t.base_)},setPrototypeOf(){Qu(12)}},Ek={};Q3(YG,(t,e)=>{Ek[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});Ek.deleteProperty=function(t,e){return Ek.set.call(this,t,e,void 0)};Ek.set=function(t,e,n){return YG.set.call(this,t[0],e,n,t[0])};function J6(t,e){const n=t[vc];return(n?K0(n):t)[e]}function BRe(t,e,n){const r=Ace(e,n);return r?"value"in r?r.value:r.get?.call(t.draft_):void 0}function Ace(t,e){if(!(e in t))return;let n=wk(t);for(;n;){const r=Object.getOwnPropertyDescriptor(n,e);if(r)return r;n=wk(n)}}function i8(t){t.modified_||(t.modified_=!0,t.parent_&&i8(t.parent_))}function Q6(t){t.copy_||(t.copy_=t8(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var WRe=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(e,n,r)=>{if(typeof e=="function"&&typeof n!="function"){const s=n;n=e;const o=this;return function(l=s,...c){return o.produce(l,u=>n.call(this,u,...c))}}typeof n!="function"&&Qu(6),r!==void 0&&typeof r!="function"&&Qu(7);let i;if(S1(e)){const s=TZ(this),o=s8(e,void 0);let a=!0;try{i=n(o),a=!1}finally{a?n8(s):r8(s)}return SZ(s,r),kZ(i,s)}else if(!e||typeof e!="object"){if(i=n(e),i===void 0&&(i=e),i===Ece&&(i=void 0),this.autoFreeze_&&KG(i,!0),r){const s=[],o=[];T1("Patches").generateReplacementPatches_(e,i,s,o),r(s,o)}return i}else Qu(1,e)},this.produceWithPatches=(e,n)=>{if(typeof e=="function")return(o,...a)=>this.produceWithPatches(o,l=>e(l,...a));let r,i;return[this.produce(e,n,(o,a)=>{r=o,i=a}),r,i]},typeof t?.autoFreeze=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof t?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy),typeof t?.useStrictIteration=="boolean"&&this.setUseStrictIteration(t.useStrictIteration)}createDraft(t){S1(t)||Qu(8),e2(t)&&(t=HRe(t));const e=TZ(this),n=s8(t,void 0);return n[vc].isManual_=!0,r8(e),n}finishDraft(t,e){const n=t&&t[vc];(!n||!n.isManual_)&&Qu(9);const{scope_:r}=n;return SZ(r,e),kZ(void 0,r)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}setUseStrictIteration(t){this.useStrictIteration_=t}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(t,e){let n;for(n=e.length-1;n>=0;n--){const i=e[n];if(i.path.length===0&&i.op==="replace"){t=i.value;break}}n>-1&&(e=e.slice(n+1));const r=T1("Patches").applyPatches_;return e2(t)?r(t,e):this.produce(t,i=>r(i,e))}};function s8(t,e){const n=qA(t)?T1("MapSet").proxyMap_(t,e):$5(t)?T1("MapSet").proxySet_(t,e):URe(t,e);return(e?e.scope_:kce()).drafts_.push(n),n}function HRe(t){return e2(t)||Qu(10,t),Ice(t)}function Ice(t){if(!S1(t)||F5(t))return t;const e=t[vc];let n,r=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,n=t8(t,e.scope_.immer_.useStrictShallowCopy_),r=e.scope_.immer_.shouldUseStrictIteration()}else n=t8(t,!0);return Q3(n,(i,s)=>{Tce(n,i,Ice(s))},r),e&&(e.finalized_=!1),n}var qRe=new WRe,KRe=qRe.produce;const YRe=t=>(e,n,r)=>(r.setState=(i,s,...o)=>{const a=typeof i=="function"?KRe(i):i;return e(a,s,...o)},t(r.setState,n,r)),Z2=YRe,ks=yo()(Z2((t,e)=>({tracking:!1,position:null,heading:null,smoothHeading:null,rawGPSHeading:null,accuracy:null,speed:null,headingSource:null,watchId:null,firstFix:!0,navigationMode:"free",config:{centerOnUser:!0},fetchPassivePosition:()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(n=>{t(r=>{r.tracking||(r.position={lat:n.coords.latitude,lng:n.coords.longitude},r.accuracy=n.coords.accuracy)})},()=>{},{enableHighAccuracy:!1,maximumAge:6e4,timeout:1e4})},startTracking:()=>{t(n=>{n.tracking=!0})},stopTracking:()=>{t(n=>{const{watchId:r}=e();r!==null&&navigator.geolocation.clearWatch(r),n.tracking=!1,n.speed=null,n.headingSource=null,n.heading=null,n.smoothHeading=null,n.rawGPSHeading=null,n.watchId=null,n.navigationMode="free"})},updatePosition:n=>{t(r=>{r.position={lat:n.coords.latitude,lng:n.coords.longitude},r.accuracy=n.coords.accuracy,r.speed=n.coords.speed,r.rawGPSHeading=n.coords.heading,n.coords.accuracy!==null&&n.coords.accuracy<20?n.coords.heading!==null&&n.coords.speed!==null&&n.coords.speed>.5?r.headingSource="gps":r.headingSource="compass":r.headingSource=null})},setSmoothedHeading:n=>{t(r=>{r.smoothHeading=n,r.heading=n})},setWatchId:n=>{t(r=>{r.watchId=n})},resetFirstFix:()=>{t(n=>{n.firstFix=!1})},setNavigationMode:n=>{t(r=>{r.navigationMode=n})},toggleNavigationMode:()=>{t(n=>{n.navigationMode=n.navigationMode==="free"?"headingUp":"free"})}}))),Oy={Kansenkaart:{name:"Kansenkaart",factory:async()=>{const{createKansenkaartLayerOL:t}=await _e(async()=>{const{createKansenkaartLayerOL:e}=await import("./kansenkaartOL-uv4ymdTm.js");return{createKansenkaartLayerOL:e}},[]);return t()},immediateLoad:!1,tier:"premium"},"TMK 1850":{name:"TMK 1850",factory:async()=>null,immediateLoad:!0,tier:"premium"},"Bonnebladen 1900":{name:"Bonnebladen 1900",factory:async()=>null,immediateLoad:!0,tier:"premium"},"AHN 0.5m":{name:"AHN 0.5m",factory:async()=>{const{createAHNLayerOL:t}=await _e(async()=>{const{createAHNLayerOL:e}=await import("./pdokWMSLayers-BAJjD92l.js");return{createAHNLayerOL:e}},[]);return t()},immediateLoad:!0},Geomorfologie:{name:"Geomorfologie",factory:async()=>{const{createGeomorfologieLayerOL:t}=await _e(async()=>{const{createGeomorfologieLayerOL:e}=await import("./pdokWMSLayers-BAJjD92l.js");return{createGeomorfologieLayerOL:e}},[]);return t()},immediateLoad:!0},Bodemkaart:{name:"Bodemkaart",factory:async()=>{const{createBodemkaartLayerOL:t}=await _e(async()=>{const{createBodemkaartLayerOL:e}=await import("./pdokWMSLayers-BAJjD92l.js");return{createBodemkaartLayerOL:e}},[]);return t()},immediateLoad:!0},IKAW:{name:"IKAW",factory:async()=>{const{createIKAWLayerOL:t}=await _e(async()=>{const{createIKAWLayerOL:e}=await import("./pdokWMSLayers-BAJjD92l.js");return{createIKAWLayerOL:e}},[]);return t()},immediateLoad:!0},"FAMKE Steentijd":{name:"FAMKE Steentijd",factory:async()=>{const{createFAMKESteentijdLayerOL:t}=await _e(async()=>{const{createFAMKESteentijdLayerOL:e}=await import("./pdokWMSLayers-BAJjD92l.js");return{createFAMKESteentijdLayerOL:e}},[]);return t()},immediateLoad:!0},"FAMKE IJzertijd":{name:"FAMKE IJzertijd",factory:async()=>{const{createFAMKEIJzertijdLayerOL:t}=await _e(async()=>{const{createFAMKEIJzertijdLayerOL:e}=await import("./pdokWMSLayers-BAJjD92l.js");return{createFAMKEIJzertijdLayerOL:e}},[]);return t()},immediateLoad:!0},Essen:{name:"Essen",factory:async()=>{const{createEssenLayerOL:t}=await _e(async()=>{const{createEssenLayerOL:e}=await import("./pdokWMSLayers-BAJjD92l.js");return{createEssenLayerOL:e}},[]);return t()},immediateLoad:!0},Rijksmonumenten:{name:"Rijksmonumenten",factory:async()=>{const{createRijksmonumentenLayerOL:t}=await _e(async()=>{const{createRijksmonumentenLayerOL:e}=await import("./pdokWMSLayers-BAJjD92l.js");return{createRijksmonumentenLayerOL:e}},[]);return t()},immediateLoad:!0},"Archeo Onderzoeken":{name:"Archeo Onderzoeken",factory:async()=>{const{createArcheoOnderzoekenLayerOL:t}=await _e(async()=>{const{createArcheoOnderzoekenLayerOL:e}=await import("./pdokWMSLayers-BAJjD92l.js");return{createArcheoOnderzoekenLayerOL:e}},[]);return t()},immediateLoad:!0},Werelderfgoed:{name:"Werelderfgoed",factory:async()=>{const{createWerelderfgoedLayerOL:t}=await _e(async()=>{const{createWerelderfgoedLayerOL:e}=await import("./pdokWMSLayers-BAJjD92l.js");return{createWerelderfgoedLayerOL:e}},[]);return t()},immediateLoad:!0},Terpen:{name:"Terpen",factory:async()=>{const{createTerpenLayerOL:t}=await _e(async()=>{const{createTerpenLayerOL:e}=await import("./terpenOL-lceWNRjB.js");return{createTerpenLayerOL:e}},[]);return t()},immediateLoad:!0,tier:"premium"},Verdedigingslinies:{name:"Verdedigingslinies",factory:async()=>{const{createLiniesLayerOL:t}=await _e(async()=>{const{createLiniesLayerOL:e}=await import("./verdedigingswerkenOL-BsARC_iy.js");return{createLiniesLayerOL:e}},[]);return t()},immediateLoad:!0},Inundatiegebieden:{name:"Inundatiegebieden",factory:async()=>{const{createInundatiesLayerOL:t}=await _e(async()=>{const{createInundatiesLayerOL:e}=await import("./verdedigingswerkenOL-BsARC_iy.js");return{createInundatiesLayerOL:e}},[]);return t()},immediateLoad:!0},"Militaire Objecten":{name:"Militaire Objecten",factory:async()=>{const{createMilitaireObjectenLayerOL:t}=await _e(async()=>{const{createMilitaireObjectenLayerOL:e}=await import("./verdedigingswerkenOL-BsARC_iy.js");return{createMilitaireObjectenLayerOL:e}},[]);return t()},immediateLoad:!0},"Paleokaart 800 n.Chr.":{name:"Paleokaart 800 n.Chr.",factory:async()=>{const{createPaleo800ncLayerOL:t}=await _e(async()=>{const{createPaleo800ncLayerOL:e}=await import("./paleokaartOL-I-LxIBl6.js");return{createPaleo800ncLayerOL:e}},[]);return t()},immediateLoad:!0},"Paleokaart 100 n.Chr.":{name:"Paleokaart 100 n.Chr.",factory:async()=>{const{createPaleo100ncLayerOL:t}=await _e(async()=>{const{createPaleo100ncLayerOL:e}=await import("./paleokaartOL-I-LxIBl6.js");return{createPaleo100ncLayerOL:e}},[]);return t()},immediateLoad:!0},"Paleokaart 500 v.Chr.":{name:"Paleokaart 500 v.Chr.",factory:async()=>{const{createPaleo500vcLayerOL:t}=await _e(async()=>{const{createPaleo500vcLayerOL:e}=await import("./paleokaartOL-I-LxIBl6.js");return{createPaleo500vcLayerOL:e}},[]);return t()},immediateLoad:!0},"Paleokaart 1500 v.Chr.":{name:"Paleokaart 1500 v.Chr.",factory:async()=>{const{createPaleo1500vcLayerOL:t}=await _e(async()=>{const{createPaleo1500vcLayerOL:e}=await import("./paleokaartOL-I-LxIBl6.js");return{createPaleo1500vcLayerOL:e}},[]);return t()},immediateLoad:!0},"Paleokaart 2750 v.Chr.":{name:"Paleokaart 2750 v.Chr.",factory:async()=>{const{createPaleo2750vcLayerOL:t}=await _e(async()=>{const{createPaleo2750vcLayerOL:e}=await import("./paleokaartOL-I-LxIBl6.js");return{createPaleo2750vcLayerOL:e}},[]);return t()},immediateLoad:!0},"Paleokaart 5500 v.Chr.":{name:"Paleokaart 5500 v.Chr.",factory:async()=>{const{createPaleo5500vcLayerOL:t}=await _e(async()=>{const{createPaleo5500vcLayerOL:e}=await import("./paleokaartOL-I-LxIBl6.js");return{createPaleo5500vcLayerOL:e}},[]);return t()},immediateLoad:!0},"Paleokaart 9000 v.Chr.":{name:"Paleokaart 9000 v.Chr.",factory:async()=>{const{createPaleo9000vcLayerOL:t}=await _e(async()=>{const{createPaleo9000vcLayerOL:e}=await import("./paleokaartOL-I-LxIBl6.js");return{createPaleo9000vcLayerOL:e}},[]);return t()},immediateLoad:!0},"Religieus Erfgoed":{name:"Religieus Erfgoed",factory:async()=>{const{createReligieusErfgoedLayerOL:t}=await _e(async()=>{const{createReligieusErfgoedLayerOL:e}=await import("./religieusErfgoedOL-Bp4lfK3_.js");return{createReligieusErfgoedLayerOL:e}},[]);return t()},immediateLoad:!0},"AHN4 Hoogtekaart Kleur":{name:"AHN4 Hoogtekaart Kleur",factory:async()=>{const{createAHN4ColorElevationLayerOL:t}=await _e(async()=>{const{createAHN4ColorElevationLayerOL:e}=await import("./hillshadeLayers-rQmlxTRD.js");return{createAHN4ColorElevationLayerOL:e}},[]);return t()},immediateLoad:!0,tier:"premium"},"AHN4 Hillshade NL":{name:"AHN4 Hillshade NL",factory:async()=>{const{createAHN4HillshadeLayerOL:t}=await _e(async()=>{const{createAHN4HillshadeLayerOL:e}=await import("./hillshadeLayers-rQmlxTRD.js");return{createAHN4HillshadeLayerOL:e}},[]);return t()},immediateLoad:!0,tier:"premium"},"AHN4 Multi-Hillshade NL":{name:"AHN4 Multi-Hillshade NL",factory:async()=>{const{createAHN4MultiHillshadeLayerOL:t}=await _e(async()=>{const{createAHN4MultiHillshadeLayerOL:e}=await import("./hillshadeLayers-rQmlxTRD.js");return{createAHN4MultiHillshadeLayerOL:e}},[]);return t()},immediateLoad:!0,tier:"premium"},"AHN4 Hillshade Kleur":{name:"AHN4 Hillshade Kleur",factory:async()=>{const{createAHN4ShadedReliefLayerOL:t}=await _e(async()=>{const{createAHN4ShadedReliefLayerOL:e}=await import("./hillshadeLayers-rQmlxTRD.js");return{createAHN4ShadedReliefLayerOL:e}},[]);return t()},immediateLoad:!0,tier:"premium"},Gewaspercelen:{name:"Gewaspercelen",factory:async()=>{const{createGewaspercelenLayerOL:t}=await _e(async()=>{const{createGewaspercelenLayerOL:e}=await import("./pdokWMSLayers-BAJjD92l.js");return{createGewaspercelenLayerOL:e}},[]);return t()},immediateLoad:!0,tier:"premium"},"Kadastrale Grenzen":{name:"Kadastrale Grenzen",factory:async()=>{const{createKadastraleKaartLayerOL:t}=await _e(async()=>{const{createKadastraleKaartLayerOL:e}=await import("./pdokWMSLayers-BAJjD92l.js");return{createKadastraleKaartLayerOL:e}},[]);return t()},immediateLoad:!0},Scheepswrakken:{name:"Scheepswrakken",factory:async()=>{const{createScheepswrakkenLayerOL:t}=await _e(async()=>{const{createScheepswrakkenLayerOL:e}=await import("./pdokWMSLayers-BAJjD92l.js");return{createScheepswrakkenLayerOL:e}},[]);return t()},immediateLoad:!0},"Woonheuvels ZH":{name:"Woonheuvels ZH",factory:async()=>{const{createWoonheuvelsLayerOL:t}=await _e(async()=>{const{createWoonheuvelsLayerOL:e}=await import("./pdokWMSLayers-BAJjD92l.js");return{createWoonheuvelsLayerOL:e}},[]);return t()},immediateLoad:!0},"Romeinse Forten":{name:"Romeinse Forten",factory:async()=>{const{createRomeinseFortenLayerOL:t}=await _e(async()=>{const{createRomeinseFortenLayerOL:e}=await import("./romeinseFortenOL-BBlpfbsn.js");return{createRomeinseFortenLayerOL:e}},__vite__mapDeps([0,1]));return t()},immediateLoad:!1},Windmolens:{name:"Windmolens",factory:async()=>{const{createWindmolensLayerOL:t}=await _e(async()=>{const{createWindmolensLayerOL:e}=await import("./pdokWMSLayers-BAJjD92l.js");return{createWindmolensLayerOL:e}},[]);return t()},immediateLoad:!0},Erfgoedlijnen:{name:"Erfgoedlijnen",factory:async()=>{const{createErfgoedlijnenLayerOL:t}=await _e(async()=>{const{createErfgoedlijnenLayerOL:e}=await import("./pdokWMSLayers-BAJjD92l.js");return{createErfgoedlijnenLayerOL:e}},[]);return t()},immediateLoad:!0},"Oude Kernen":{name:"Oude Kernen",factory:async()=>{const{createOudeKernenLayerOL:t}=await _e(async()=>{const{createOudeKernenLayerOL:e}=await import("./pdokWMSLayers-BAJjD92l.js");return{createOudeKernenLayerOL:e}},[]);return t()},immediateLoad:!0},"Relictenkaart Punten":{name:"Relictenkaart Punten",factory:async()=>{const{createRelictenPuntenLayerOL:t}=await _e(async()=>{const{createRelictenPuntenLayerOL:e}=await import("./relictenGelderlandOL-Cqdyz9UI.js");return{createRelictenPuntenLayerOL:e}},[]);return t()},immediateLoad:!1},"Relictenkaart Lijnen":{name:"Relictenkaart Lijnen",factory:async()=>{const{createRelictenkaartLijnenLayerOL:t}=await _e(async()=>{const{createRelictenkaartLijnenLayerOL:e}=await import("./pdokWMSLayers-BAJjD92l.js");return{createRelictenkaartLijnenLayerOL:e}},[]);return t()},immediateLoad:!0},"Relictenkaart Vlakken":{name:"Relictenkaart Vlakken",factory:async()=>{const{createRelictenkaartVlakkenLayerOL:t}=await _e(async()=>{const{createRelictenkaartVlakkenLayerOL:e}=await import("./pdokWMSLayers-BAJjD92l.js");return{createRelictenkaartVlakkenLayerOL:e}},[]);return t()},immediateLoad:!0},"Verdronken Dorpen":{name:"Verdronken Dorpen",factory:async()=>{const{createVerdronkenDorpenLayerOL:t}=await _e(async()=>{const{createVerdronkenDorpenLayerOL:e}=await import("./pdokWMSLayers-BAJjD92l.js");return{createVerdronkenDorpenLayerOL:e}},[]);return t()},immediateLoad:!0},"AMK Monumenten":{name:"AMK Monumenten",factory:async()=>{const{createAMKLayerOL:t}=await _e(async()=>{const{createAMKLayerOL:e}=await import("./amkOL-CE6MhN1N.js");return{createAMKLayerOL:e}},[]);return t()},immediateLoad:!1,tier:"premium"},"AMK Romeins":{name:"AMK Romeins",factory:async()=>{const{createAMKRomeinsLayerOL:t}=await _e(async()=>{const{createAMKRomeinsLayerOL:e}=await import("./amkOL-CE6MhN1N.js");return{createAMKRomeinsLayerOL:e}},[]);return t()},immediateLoad:!1,tier:"premium"},"AMK Steentijd":{name:"AMK Steentijd",factory:async()=>{const{createAMKSteentijdLayerOL:t}=await _e(async()=>{const{createAMKSteentijdLayerOL:e}=await import("./amkOL-CE6MhN1N.js");return{createAMKSteentijdLayerOL:e}},[]);return t()},immediateLoad:!1,tier:"premium"},"AMK Vroege ME":{name:"AMK Vroege ME",factory:async()=>{const{createAMKVroegeMELayerOL:t}=await _e(async()=>{const{createAMKVroegeMELayerOL:e}=await import("./amkOL-CE6MhN1N.js");return{createAMKVroegeMELayerOL:e}},[]);return t()},immediateLoad:!1,tier:"premium"},"AMK Late ME":{name:"AMK Late ME",factory:async()=>{const{createAMKLateMELayerOL:t}=await _e(async()=>{const{createAMKLateMELayerOL:e}=await import("./amkOL-CE6MhN1N.js");return{createAMKLateMELayerOL:e}},[]);return t()},immediateLoad:!1,tier:"premium"},"AMK Overig":{name:"AMK Overig",factory:async()=>{const{createAMKOverigLayerOL:t}=await _e(async()=>{const{createAMKOverigLayerOL:e}=await import("./amkOL-CE6MhN1N.js");return{createAMKOverigLayerOL:e}},[]);return t()},immediateLoad:!1,tier:"premium"},"Romeinse wegen (regio)":{name:"Romeinse wegen (regio)",factory:async()=>{const{createRomeinseWegenLayerOL:t}=await _e(async()=>{const{createRomeinseWegenLayerOL:e}=await import("./romeinsOL-CrlJVGXu.js");return{createRomeinseWegenLayerOL:e}},[]);return t()},immediateLoad:!1},"Romeinse wegen (Wereld)":{name:"Romeinse wegen (Wereld)",factory:async()=>{const{createRomeinseWegenWereldLayerOL:t}=await _e(async()=>{const{createRomeinseWegenWereldLayerOL:e}=await import("./romeinsOL-CrlJVGXu.js");return{createRomeinseWegenWereldLayerOL:e}},[]);return t()},immediateLoad:!1,tier:"premium",regions:["nl","be","de","fr"]},Kastelen:{name:"Kastelen",factory:async()=>{const{createKastelenLayerOL:t}=await _e(async()=>{const{createKastelenLayerOL:e}=await import("./kastelenOL-DElmWUAN.js");return{createKastelenLayerOL:e}},__vite__mapDeps([2,1]));return t()},immediateLoad:!1},Runes:{name:"Runes",factory:async()=>{const{createRuinesLayerOL:t}=await _e(async()=>{const{createRuinesLayerOL:e}=await import("./ruinesOL-DgZtGTzU.js");return{createRuinesLayerOL:e}},__vite__mapDeps([3,1]));return t()},immediateLoad:!1},Veengebieden:{name:"Veengebieden",factory:async()=>{const{createVeengebiedenLayerOL:t}=await _e(async()=>{const{createVeengebiedenLayerOL:e}=await import("./veengebiedenOL-DA4ORNnv.js");return{createVeengebiedenLayerOL:e}},[]);return t()},immediateLoad:!1},Hunebedden:{name:"Hunebedden",factory:async()=>{const{createHunebeddenLayerOL:t}=await _e(async()=>{const{createHunebeddenLayerOL:e}=await import("./hunebeddenOL-CQ_alGjJ.js");return{createHunebeddenLayerOL:e}},__vite__mapDeps([4,1]));return t()},immediateLoad:!1},"UIKAV Punten":{name:"UIKAV Punten",factory:async()=>{const{createUIKAVArcheoPuntenLayerOL:t}=await _e(async()=>{const{createUIKAVArcheoPuntenLayerOL:e}=await import("./uikavArcheoPuntenOL-6LhMeQKX.js");return{createUIKAVArcheoPuntenLayerOL:e}},__vite__mapDeps([5,1]));return t()},immediateLoad:!1,tier:"premium"},"UIKAV Vlakken":{name:"UIKAV Vlakken",factory:async()=>{const{createUIKAVVlakkenLayerOL:t}=await _e(async()=>{const{createUIKAVVlakkenLayerOL:e}=await import("./uikavVlakkenOL-B-3ZMayt.js");return{createUIKAVVlakkenLayerOL:e}},[]);return t()},immediateLoad:!1},"UIKAV Buffer":{name:"UIKAV Buffer",factory:async()=>{const{createUIKAVBufferlaagLayerOL:t}=await _e(async()=>{const{createUIKAVBufferlaagLayerOL:e}=await import("./uikavBufferlaagOL-nAKYxbXj.js");return{createUIKAVBufferlaagLayerOL:e}},[]);return t()},immediateLoad:!1},"UIKAV Expert":{name:"UIKAV Expert",factory:async()=>{const{createUIKAVExpertLayerOL:t}=await _e(async()=>{const{createUIKAVExpertLayerOL:e}=await import("./uikavExpertOL-DOxOLXKJ.js");return{createUIKAVExpertLayerOL:e}},[]);return t()},immediateLoad:!1},"UIKAV Indeling":{name:"UIKAV Indeling",factory:async()=>{const{createUIKAVUiterwaardenLayerOL:t}=await _e(async()=>{const{createUIKAVUiterwaardenLayerOL:e}=await import("./uikavUiterwaardenOL-BW9trGi9.js");return{createUIKAVUiterwaardenLayerOL:e}},[]);return t()},immediateLoad:!1},Speeltuinen:{name:"Speeltuinen",factory:async()=>{const{createSpeeltuinenLayerOL:t}=await _e(async()=>{const{createSpeeltuinenLayerOL:e}=await import("./speeltuinenOL-DBBAxcol.js");return{createSpeeltuinenLayerOL:e}},__vite__mapDeps([6,1]));return t()},immediateLoad:!1},Musea:{name:"Musea",factory:async()=>{const{createMuseaLayerOL:t}=await _e(async()=>{const{createMuseaLayerOL:e}=await import("./museaOL-3plmPfO9.js");return{createMuseaLayerOL:e}},__vite__mapDeps([7,1]));return t()},immediateLoad:!1},Strandjes:{name:"Strandjes",factory:async()=>{const{createStrandjesLayerOL:t}=await _e(async()=>{const{createStrandjesLayerOL:e}=await import("./strandjesOL-B0RVnqUt.js");return{createStrandjesLayerOL:e}},[]);return t()},immediateLoad:!1},Parken:{name:"Parken",factory:async()=>{const{createParkenLayerOL:t}=await _e(async()=>{const{createParkenLayerOL:e}=await import("./parkenOL-AmxUup1o.js");return{createParkenLayerOL:e}},[]);return t()},immediateLoad:!1},Kringloopwinkels:{name:"Kringloopwinkels",factory:async()=>{const{createKringloopwinkelsLayerOL:t}=await _e(async()=>{const{createKringloopwinkelsLayerOL:e}=await import("./kringloopwinkelsOL-wL8CDkrq.js");return{createKringloopwinkelsLayerOL:e}},__vite__mapDeps([8,1]));return t()},immediateLoad:!1},Ruiterpaden:{name:"Ruiterpaden",factory:async()=>{const{createRuiterpadenLayerOL:t}=await _e(async()=>{const{createRuiterpadenLayerOL:e}=await import("./ruiterpadenOL-C2Z2t1ps.js");return{createRuiterpadenLayerOL:e}},[]);return t()},immediateLoad:!1},Laarzenpaden:{name:"Laarzenpaden",factory:async()=>{const{createLaarzenpadenLayerOL:t}=await _e(async()=>{const{createLaarzenpadenLayerOL:e}=await import("./laarzenpadenOL-D2XgqhIB.js");return{createLaarzenpadenLayerOL:e}},[]);return t()},immediateLoad:!1},"Fossielen Nederland":{name:"Fossielen Nederland",factory:async()=>{const{createFossielenLayerOL:t}=await _e(async()=>{const{createFossielenLayerOL:e}=await import("./fossielenOL-CFARDOId.js");return{createFossielenLayerOL:e}},__vite__mapDeps([9,10,1]));return t()},immediateLoad:!1,tier:"premium"},"Fossielen Belgi":{name:"Fossielen Belgi",factory:async()=>{const{createFossielenBelgieLayerOL:t}=await _e(async()=>{const{createFossielenBelgieLayerOL:e}=await import("./fossielenBelgieOL-B4D9oNSi.js");return{createFossielenBelgieLayerOL:e}},__vite__mapDeps([11,10,1]));return t()},immediateLoad:!1,tier:"premium",regions:["be"]},"Fossielen Duitsland":{name:"Fossielen Duitsland",factory:async()=>{const{createFossielenDuitslandLayerOL:t}=await _e(async()=>{const{createFossielenDuitslandLayerOL:e}=await import("./fossielenDuitslandOL-BSYtoSdU.js");return{createFossielenDuitslandLayerOL:e}},__vite__mapDeps([12,10,1]));return t()},immediateLoad:!1,tier:"premium",regions:["de"]},"Fossielen Frankrijk":{name:"Fossielen Frankrijk",factory:async()=>{const{createFossielenFrankrijkLayerOL:t}=await _e(async()=>{const{createFossielenFrankrijkLayerOL:e}=await import("./fossielenFrankrijkOL-CLQ5GXnu.js");return{createFossielenFrankrijkLayerOL:e}},__vite__mapDeps([13,10,1]));return t()},immediateLoad:!1,tier:"premium",regions:["fr"]},"Fossiel Hotspots":{name:"Fossiel Hotspots",factory:async()=>{const{createFossielHotspotsLayerOL:t}=await _e(async()=>{const{createFossielHotspotsLayerOL:e}=await import("./fossielHotspotsOL-qDaYxlo7.js");return{createFossielHotspotsLayerOL:e}},[]);return t()},immediateLoad:!1,tier:"premium",regions:["nl","be","de","fr"]},"Mineralen Hotspots":{name:"Mineralen Hotspots",factory:async()=>{const{createMineralenHotspotsLayerOL:t}=await _e(async()=>{const{createMineralenHotspotsLayerOL:e}=await import("./mineralenHotspotsOL-DORHXiIK.js");return{createMineralenHotspotsLayerOL:e}},[]);return t()},immediateLoad:!1,tier:"premium",regions:["nl","be","de","fr"]},Goudrivieren:{name:"Goudrivieren",factory:async()=>{const{createGoudrivierenLayerOL:t}=await _e(async()=>{const{createGoudrivierenLayerOL:e}=await import("./goudrivierenOL-aw_nlHsC.js");return{createGoudrivierenLayerOL:e}},[]);return t()},immediateLoad:!1,tier:"premium",regions:["nl","be","de","fr"]},"WWII Bunkers":{name:"WWII Bunkers",factory:async()=>{const{createBunkersLayerOL:t}=await _e(async()=>{const{createBunkersLayerOL:e}=await import("./bunkersOL-C6iYRIOQ.js");return{createBunkersLayerOL:e}},__vite__mapDeps([14,1]));return t()},immediateLoad:!1},Grafheuvels:{name:"Grafheuvels",factory:async()=>{const{createGrafheuvelsLayerOL:t}=await _e(async()=>{const{createGrafheuvelsLayerOL:e}=await import("./grafheuvelsOL-FGDvMy6t.js");return{createGrafheuvelsLayerOL:e}},__vite__mapDeps([15,1]));return t()},immediateLoad:!1},Slagvelden:{name:"Slagvelden",factory:async()=>{const{createSlagveldenLayerOL:t}=await _e(async()=>{const{createSlagveldenLayerOL:e}=await import("./slagveldenOL-BL9eLWeC.js");return{createSlagveldenLayerOL:e}},__vite__mapDeps([16,1]));return t()},immediateLoad:!1},"Militaire Vliegvelden":{name:"Militaire Vliegvelden",factory:async()=>{const{createVliegveldenLayerOL:t}=await _e(async()=>{const{createVliegveldenLayerOL:e}=await import("./vliegveldenOL-pDn9wqGT.js");return{createVliegveldenLayerOL:e}},[]);return t()},immediateLoad:!1}};function XRe(){return Object.values(Oy).filter(t=>t.immediateLoad&&t.platform!=="arcgis")}const gi=yo()(Z2((t,e)=>({map:null,arcgisMap:null,arcgisView:null,arcgisInitialized:!1,rotation:0,rotationEnabled:!0,setMap:n=>{t(r=>{r.map=n})},setArcGISMap:(n,r)=>{t(i=>{i.arcgisMap=n,i.arcgisView=r,i.arcgisInitialized=!0})},setRotation:n=>{t(r=>{if(r.rotation=n,r.map&&r.rotationEnabled){const i=n*Math.PI/180;r.map.getView().setRotation(i)}})},enableRotation:()=>{t(n=>{n.rotationEnabled=!0})},disableRotation:()=>{t(n=>{n.rotationEnabled=!1,n.rotation=0,n.map&&n.map.getView().animate({rotation:0,duration:500})})}}))),Bs=yo()(Z2((t,e)=>({visible:{"CartoDB (licht)":!0,OpenStreetMap:!1,Luchtfoto:!1,"Labels Overlay":!1,"TMK 1850":!1,"Bonnebladen 1900":!1,Hunebedden:!1,"FAMKE Steentijd":!1,"FAMKE IJzertijd":!1,Grafheuvels:!1,Terpen:!1,"AMK Monumenten":!1,"AMK Romeins":!1,"AMK Steentijd":!1,"AMK Vroege ME":!1,"AMK Late ME":!1,"AMK Overig":!1,"Archeo Onderzoeken":!1,"Romeinse wegen (regio)":!1,"Romeinse wegen (Wereld)":!1,Kastelen:!1,IKAW:!1,Essen:!1,Rijksmonumenten:!1,Werelderfgoed:!1,"WWII Bunkers":!1,Slagvelden:!1,"Militaire Vliegvelden":!1,Verdedigingslinies:!1,Inundatiegebieden:!1,"Militaire Objecten":!1,"Paleokaart 800 n.Chr.":!1,"Paleokaart 100 n.Chr.":!1,"Paleokaart 500 v.Chr.":!1,"Paleokaart 1500 v.Chr.":!1,"Paleokaart 2750 v.Chr.":!1,"Paleokaart 5500 v.Chr.":!1,"Paleokaart 9000 v.Chr.":!1,"Religieus Erfgoed":!1,"UIKAV Punten":!1,"UIKAV Vlakken":!1,"UIKAV Buffer":!1,"UIKAV Expert":!1,"UIKAV Indeling":!1,"AHN4 Hoogtekaart Kleur":!1,"AHN4 Hillshade NL":!1,"AHN4 Multi-Hillshade NL":!1,"AHN4 Hillshade Kleur":!1,"AHN 0.5m":!1,Veengebieden:!1,Geomorfologie:!1,Bodemkaart:!1,"Fossielen Nederland":!1,"Fossielen Belgi":!1,"Fossielen Duitsland":!1,"Fossielen Frankrijk":!1,Parken:!1,Speeltuinen:!1,Musea:!1,Strandjes:!1,Ruiterpaden:!1,Laarzenpaden:!1,Gewaspercelen:!1,"Kadastrale Grenzen":!1,Scheepswrakken:!1,"Woonheuvels ZH":!1,"Romeinse Forten":!1,Windmolens:!1,Erfgoedlijnen:!1,"Oude Kernen":!1,"Relictenkaart Punten":!1,"Relictenkaart Lijnen":!1,"Relictenkaart Vlakken":!1,"Verdronken Dorpen":!1,"Mijn Vondsten":!0},opacity:{"AHN4 Hoogtekaart Kleur":.85,"AHN4 Hillshade NL":.7,"AHN4 Multi-Hillshade NL":.7,"AHN4 Hillshade Kleur":.8,"AHN 0.5m":.7,"TMK 1850":.8,"Bonnebladen 1900":.8,Geomorfologie:.5,Bodemkaart:.6,Veengebieden:.6,IKAW:.5,"FAMKE Steentijd":.6,"FAMKE IJzertijd":.6,Essen:.6,Terpen:.7,"AMK Monumenten":.45,"AMK Romeins":.6,"AMK Steentijd":.6,"AMK Vroege ME":.6,"AMK Late ME":.6,"AMK Overig":.6,"Paleokaart 9000 v.Chr.":.7,"Paleokaart 5500 v.Chr.":.7,"Paleokaart 2750 v.Chr.":.7,"Paleokaart 1500 v.Chr.":.7,"Paleokaart 500 v.Chr.":.7,"Paleokaart 100 n.Chr.":.7,"Paleokaart 800 n.Chr.":.7,Verdedigingslinies:.7,Inundatiegebieden:.5,"Militaire Objecten":.8,"Religieus Erfgoed":.8,Gewaspercelen:.6,"Kadastrale Grenzen":.7,Erfgoedlijnen:.7,"Oude Kernen":.6,"Relictenkaart Vlakken":.5},loadingState:{},layers:{},arcgisLayers:{},toggleLayer:n=>{const r=e(),i=!r.visible[n];t(a=>{a.visible[n]=i}),Oy[n]?.platform==="arcgis"?i&&!r.arcgisLayers[n]?e().loadLayer(n):r.arcgisLayers[n]&&(r.arcgisLayers[n].visible=i):i&&!r.layers[n]?e().loadLayer(n):r.layers[n]&&r.layers[n].setVisible(i)},setLayerVisibility:(n,r)=>{const i=e(),o=Oy[n]?.platform==="arcgis";t(l=>{if(l.visible[n]=r,o){const c=l.arcgisLayers[n];c&&(c.visible=r)}else{const c=l.layers[n];c&&c.setVisible(r)}});const a=o?i.arcgisLayers[n]:i.layers[n];r&&!a&&e().loadLayer(n)},setLayerOpacity:(n,r)=>{const s=Oy[n]?.platform==="arcgis";t(o=>{if(o.opacity[n]=r,s){const a=o.arcgisLayers[n];a&&(a.opacity=r)}else{const a=o.layers[n];a&&a.setOpacity(r)}})},registerLayer:(n,r)=>{t(i=>{i.layers[n]=r,i.loadingState[n]="loaded",i.visible[n]!==void 0&&r.setVisible(i.visible[n]),i.opacity[n]!==void 0&&r.setOpacity(i.opacity[n])})},registerArcGISLayer:(n,r)=>{t(i=>{i.arcgisLayers[n]=r,i.loadingState[n]="loaded",i.visible[n]!==void 0&&(r.visible=i.visible[n]),i.opacity[n]!==void 0&&(r.opacity=i.opacity[n])})},unregisterLayer:n=>{t(r=>{delete r.layers[n],delete r.arcgisLayers[n],delete r.loadingState[n]})},loadLayer:async n=>{const r=e(),i=Oy[n];if(!i){console.warn(` Layer "${n}" not found in registry`);return}const s=i.platform==="arcgis";if(r.loadingState[n]==="loading"||s&&r.arcgisLayers[n]||!s&&r.layers[n])return;const o=gi.getState();if(s){if(!o.arcgisMap||!o.arcgisInitialized){console.warn(` Cannot load ArcGIS layer "${n}": ArcGIS map not initialized`);return}}else if(!o.map){console.warn(` Cannot load layer "${n}": map not initialized`);return}t(a=>{a.loadingState[n]="loading"}),console.log(` Loading ${s?"ArcGIS":"OL"} layer: ${n}...`);try{const a=await i.factory();if(!a)throw new Error("Factory returned null");const l=e();if(s){const c=a;c.visible=l.visible[n]??!1,l.opacity[n]!==void 0&&(c.opacity=l.opacity[n]),o.arcgisMap.add(c),t(u=>{u.arcgisLayers[n]=c,u.loadingState[n]="loaded"})}else{const c=a;c.setVisible(l.visible[n]??!1),l.opacity[n]!==void 0&&c.setOpacity(l.opacity[n]),o.map.addLayer(c),t(u=>{u.layers[n]=c,u.loadingState[n]="loaded"})}console.log(` Layer loaded: ${n}`)}catch(a){console.error(` Failed to load layer "${n}":`,a),t(l=>{l.loadingState[n]="error"})}}}))),Gr=yo()(Z2((t,e)=>({layerControlOpen:!1,legendOpen:!1,backgroundsPanelOpen:!1,themesPanelOpen:!1,settingsPanelOpen:!1,infoPanelOpen:!1,presetsPanelOpen:!1,monumentSearchOpen:!1,monumentFilterOpen:!1,vondstFormOpen:!1,vondstFormLocation:null,vondstFormPhoto:null,vondstDashboardOpen:!1,createLayerModalOpen:!1,addPointModalOpen:!1,addPointModalLayerId:null,addPointModalLocation:null,layerManagerModalOpen:!1,layerDashboardOpen:!1,layerDashboardLayerId:null,routeDashboardOpen:!1,collapsedCategories:new Set,closeAllPanels:()=>{t(n=>{n.backgroundsPanelOpen=!1,n.themesPanelOpen=!1,n.settingsPanelOpen=!1,n.infoPanelOpen=!1,n.presetsPanelOpen=!1,n.monumentFilterOpen=!1})},toggleLayerControl:()=>{t(n=>{n.layerControlOpen=!n.layerControlOpen})},toggleLegend:()=>{t(n=>{n.legendOpen=!n.legendOpen})},toggleBackgroundsPanel:()=>{t(n=>{const r=n.backgroundsPanelOpen;n.backgroundsPanelOpen=!1,n.themesPanelOpen=!1,n.settingsPanelOpen=!1,n.infoPanelOpen=!1,n.presetsPanelOpen=!1,n.monumentFilterOpen=!1,r||(n.backgroundsPanelOpen=!0)})},toggleThemesPanel:()=>{t(n=>{const r=n.themesPanelOpen;n.backgroundsPanelOpen=!1,n.themesPanelOpen=!1,n.settingsPanelOpen=!1,n.infoPanelOpen=!1,n.presetsPanelOpen=!1,n.monumentFilterOpen=!1,r||(n.themesPanelOpen=!0)})},toggleSettingsPanel:()=>{t(n=>{const r=n.settingsPanelOpen;n.backgroundsPanelOpen=!1,n.themesPanelOpen=!1,n.settingsPanelOpen=!1,n.infoPanelOpen=!1,n.presetsPanelOpen=!1,n.monumentFilterOpen=!1,r||(n.settingsPanelOpen=!0)})},toggleInfoPanel:()=>{t(n=>{const r=n.infoPanelOpen;n.backgroundsPanelOpen=!1,n.themesPanelOpen=!1,n.settingsPanelOpen=!1,n.infoPanelOpen=!1,n.presetsPanelOpen=!1,n.monumentFilterOpen=!1,r||(n.infoPanelOpen=!0)})},togglePresetsPanel:()=>{t(n=>{const r=n.presetsPanelOpen;n.backgroundsPanelOpen=!1,n.themesPanelOpen=!1,n.settingsPanelOpen=!1,n.infoPanelOpen=!1,n.presetsPanelOpen=!1,n.monumentFilterOpen=!1,r||(n.presetsPanelOpen=!0)})},toggleCategory:n=>{t(r=>{r.collapsedCategories.has(n)?r.collapsedCategories.delete(n):r.collapsedCategories.add(n)})},setLayerControlOpen:n=>{t(r=>{r.layerControlOpen=n})},setLegendOpen:n=>{t(r=>{r.legendOpen=n})},openVondstForm:(n,r)=>{t(i=>{i.backgroundsPanelOpen=!1,i.themesPanelOpen=!1,i.settingsPanelOpen=!1,i.infoPanelOpen=!1,i.presetsPanelOpen=!1,i.vondstFormOpen=!0,i.vondstFormLocation=n||null,i.vondstFormPhoto=r||null})},closeVondstForm:()=>{t(n=>{n.vondstFormOpen=!1,n.vondstFormLocation=null,n.vondstFormPhoto=null})},toggleVondstDashboard:()=>{t(n=>{const r=n.vondstDashboardOpen;n.backgroundsPanelOpen=!1,n.themesPanelOpen=!1,n.settingsPanelOpen=!1,n.infoPanelOpen=!1,n.presetsPanelOpen=!1,n.vondstDashboardOpen=!r})},openCreateLayerModal:()=>{t(n=>{n.createLayerModalOpen=!0})},closeCreateLayerModal:()=>{t(n=>{n.createLayerModalOpen=!1})},openAddPointModal:(n,r)=>{t(i=>{i.addPointModalOpen=!0,i.addPointModalLayerId=n,i.addPointModalLocation=r})},closeAddPointModal:()=>{t(n=>{n.addPointModalOpen=!1,n.addPointModalLayerId=null,n.addPointModalLocation=null})},openLayerManagerModal:()=>{t(n=>{n.layerManagerModalOpen=!0})},closeLayerManagerModal:()=>{t(n=>{n.layerManagerModalOpen=!1})},openLayerDashboard:n=>{t(r=>{r.layerDashboardOpen=!0,r.layerDashboardLayerId=n,r.layerManagerModalOpen=!1})},closeLayerDashboard:()=>{t(n=>{n.layerDashboardOpen=!1,n.layerDashboardLayerId=null})},toggleRouteDashboard:()=>{t(n=>{n.routeDashboardOpen=!n.routeDashboardOpen})},toggleMonumentSearch:()=>{t(n=>{const r=n.monumentSearchOpen;n.backgroundsPanelOpen=!1,n.themesPanelOpen=!1,n.settingsPanelOpen=!1,n.infoPanelOpen=!1,n.presetsPanelOpen=!1,n.monumentSearchOpen=!r})},closeMonumentSearch:()=>{t(n=>{n.monumentSearchOpen=!1})},toggleMonumentFilter:()=>{t(n=>{const r=n.monumentFilterOpen;n.backgroundsPanelOpen=!1,n.themesPanelOpen=!1,n.settingsPanelOpen=!1,n.infoPanelOpen=!1,n.presetsPanelOpen=!1,n.monumentFilterOpen=!1,r||(n.monumentFilterOpen=!0)})},closeMonumentFilter:()=>{t(n=>{n.monumentFilterOpen=!1})}}))),ZRe=()=>{};var IZ={};const Pce=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},JRe=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],o=t[n++],a=t[n++],l=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},Cce={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],o=i+1<t.length,a=o?t[i+1]:0,l=i+2<t.length,c=l?t[i+2]:0,u=s>>2,h=(s&3)<<4|a>>4;let f=(a&15)<<2|c>>6,g=c&63;l||(g=64,o||(f=64)),r.push(n[u],n[h],n[f],n[g])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Pce(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):JRe(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0;++i;const c=i<t.length?n[t.charAt(i)]:64;++i;const h=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||a==null||c==null||h==null)throw new QRe;const f=s<<2|a>>4;if(r.push(f),c!==64){const g=a<<4&240|c>>2;if(r.push(g),h!==64){const y=c<<6&192|h;r.push(y)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class QRe extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const eMe=function(t){const e=Pce(t);return Cce.encodeByteArray(e,!0)},n4=function(t){return eMe(t).replace(/\./g,"")},Rce=function(t){try{return Cce.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Mce(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const tMe=()=>Mce().__FIREBASE_DEFAULTS__,nMe=()=>{if(typeof process>"u"||typeof IZ>"u")return;const t=IZ.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},rMe=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Rce(t[1]);return e&&JSON.parse(e)},V5=()=>{try{return ZRe()||tMe()||nMe()||rMe()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Nce=t=>V5()?.emulatorHosts?.[t],Oce=t=>{const e=Nce(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},Lce=()=>V5()?.config,Dce=t=>V5()?.[`_${t}`];let iMe=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}};function lv(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function XG(t){return(await fetch(t,{credentials:"include"})).ok}function jce(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...t};return[n4(JSON.stringify(n)),n4(JSON.stringify(o)),""].join(".")}const tT={};function sMe(){const t={prod:[],emulator:[]};for(const e of Object.keys(tT))tT[e]?t.emulator.push(e):t.prod.push(e);return t}function oMe(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let PZ=!1;function ZG(t,e){if(typeof window>"u"||typeof document>"u"||!lv(window.location.host)||tT[t]===e||tT[t]||PZ)return;tT[t]=e;function n(f){return`__firebase__banner__${f}`}const r="__firebase__banner",s=sMe().prod.length>0;function o(){const f=document.getElementById(r);f&&f.remove()}function a(f){f.style.display="flex",f.style.background="#7faaf0",f.style.position="fixed",f.style.bottom="5px",f.style.left="5px",f.style.padding=".5em",f.style.borderRadius="5px",f.style.alignItems="center"}function l(f,g){f.setAttribute("width","24"),f.setAttribute("id",g),f.setAttribute("height","24"),f.setAttribute("viewBox","0 0 24 24"),f.setAttribute("fill","none"),f.style.marginLeft="-6px"}function c(){const f=document.createElement("span");return f.style.cursor="pointer",f.style.marginLeft="16px",f.style.fontSize="24px",f.innerHTML=" &times;",f.onclick=()=>{PZ=!0,o()},f}function u(f,g){f.setAttribute("id",g),f.innerText="Learn more",f.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",f.setAttribute("target","__blank"),f.style.paddingLeft="5px",f.style.textDecoration="underline"}function h(){const f=oMe(r),g=n("text"),y=document.getElementById(g)||document.createElement("span"),_=n("learnmore"),b=document.getElementById(_)||document.createElement("a"),T=n("preprendIcon"),A=document.getElementById(T)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(f.created){const I=f.element;a(I),u(b,_);const P=c();l(A,T),I.append(A,y,b,P),document.body.appendChild(I)}s?(y.innerText="Preview backend disconnected.",A.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(A.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,y.innerText="Preview backend running in this workspace."),y.setAttribute("id",g)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",h):h()}function Ks(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function aMe(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ks())}function $ce(){const t=V5()?.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function lMe(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function cMe(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function uMe(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function hMe(){const t=Ks();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function Fce(){return!$ce()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Vce(){return!$ce()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function zce(){try{return typeof indexedDB=="object"}catch{return!1}}function dMe(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(n){e(n)}})}const fMe="FirebaseError";class Ud extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=fMe,Object.setPrototypeOf(this,Ud.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,KA.prototype.create)}}class KA{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?pMe(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new Ud(i,a,r)}}function pMe(t,e){return t.replace(mMe,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const mMe=/\{\$([^}]+)}/g;function gMe(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function k1(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],o=e[i];if(CZ(s)&&CZ(o)){if(!k1(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function CZ(t){return t!==null&&typeof t=="object"}function YA(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function yMe(t,e){const n=new vMe(t,e);return n.subscribe.bind(n)}class vMe{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");_Me(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=ej),i.error===void 0&&(i.error=ej),i.complete===void 0&&(i.complete=ej);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function _Me(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function ej(){}function mo(t){return t&&t._delegate?t._delegate:t}class Rg{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Y0="[DEFAULT]";class xMe{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new iMe;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(bMe(e))try{this.getOrInitializeService({instanceIdentifier:Y0})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Y0){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Y0){return this.instances.has(e)}getOptions(e=Y0){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:wMe(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Y0){return this.component?this.component.multipleInstances?e:Y0:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function wMe(t){return t===Y0?void 0:t}function bMe(t){return t.instantiationMode==="EAGER"}class EMe{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new xMe(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}var tr;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(tr||(tr={}));const SMe={debug:tr.DEBUG,verbose:tr.VERBOSE,info:tr.INFO,warn:tr.WARN,error:tr.ERROR,silent:tr.SILENT},TMe=tr.INFO,kMe={[tr.DEBUG]:"log",[tr.VERBOSE]:"log",[tr.INFO]:"info",[tr.WARN]:"warn",[tr.ERROR]:"error"},AMe=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=kMe[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class JG{constructor(e){this.name=e,this._logLevel=TMe,this._logHandler=AMe,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in tr))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?SMe[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,tr.DEBUG,...e),this._logHandler(this,tr.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,tr.VERBOSE,...e),this._logHandler(this,tr.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,tr.INFO,...e),this._logHandler(this,tr.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,tr.WARN,...e),this._logHandler(this,tr.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,tr.ERROR,...e),this._logHandler(this,tr.ERROR,...e)}}const IMe=(t,e)=>e.some(n=>t instanceof n);let RZ,MZ;function PMe(){return RZ||(RZ=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function CMe(){return MZ||(MZ=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Gce=new WeakMap,o8=new WeakMap,Uce=new WeakMap,tj=new WeakMap,QG=new WeakMap;function RMe(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(mg(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&Gce.set(n,t)}).catch(()=>{}),QG.set(e,t),e}function MMe(t){if(o8.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});o8.set(t,e)}let a8={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return o8.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Uce.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return mg(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function NMe(t){a8=t(a8)}function OMe(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(nj(this),e,...n);return Uce.set(r,e.sort?e.sort():[e]),mg(r)}:CMe().includes(t)?function(...e){return t.apply(nj(this),e),mg(Gce.get(this))}:function(...e){return mg(t.apply(nj(this),e))}}function LMe(t){return typeof t=="function"?OMe(t):(t instanceof IDBTransaction&&MMe(t),IMe(t,PMe())?new Proxy(t,a8):t)}function mg(t){if(t instanceof IDBRequest)return RMe(t);if(tj.has(t))return tj.get(t);const e=LMe(t);return e!==t&&(tj.set(t,e),QG.set(e,t)),e}const nj=t=>QG.get(t);function DMe(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),a=mg(o);return r&&o.addEventListener("upgradeneeded",l=>{r(mg(o.result),l.oldVersion,l.newVersion,mg(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const jMe=["get","getKey","getAll","getAllKeys","count"],$Me=["put","add","delete","clear"],rj=new Map;function NZ(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(rj.get(e))return rj.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=$Me.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||jMe.includes(n)))return;const s=async function(o,...a){const l=this.transaction(o,i?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(a.shift())),(await Promise.all([c[n](...a),i&&l.done]))[0]};return rj.set(e,s),s}NMe(t=>({...t,get:(e,n,r)=>NZ(e,n)||t.get(e,n,r),has:(e,n)=>!!NZ(e,n)||t.has(e,n)}));class FMe{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(VMe(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function VMe(t){return t.getComponent()?.type==="VERSION"}const l8="@firebase/app",OZ="0.14.6";const dp=new JG("@firebase/app"),zMe="@firebase/app-compat",GMe="@firebase/analytics-compat",UMe="@firebase/analytics",BMe="@firebase/app-check-compat",WMe="@firebase/app-check",HMe="@firebase/auth",qMe="@firebase/auth-compat",KMe="@firebase/database",YMe="@firebase/data-connect",XMe="@firebase/database-compat",ZMe="@firebase/functions",JMe="@firebase/functions-compat",QMe="@firebase/installations",e3e="@firebase/installations-compat",t3e="@firebase/messaging",n3e="@firebase/messaging-compat",r3e="@firebase/performance",i3e="@firebase/performance-compat",s3e="@firebase/remote-config",o3e="@firebase/remote-config-compat",a3e="@firebase/storage",l3e="@firebase/storage-compat",c3e="@firebase/firestore",u3e="@firebase/ai",h3e="@firebase/firestore-compat",d3e="firebase",f3e="12.6.0";const c8="[DEFAULT]",p3e={[l8]:"fire-core",[zMe]:"fire-core-compat",[UMe]:"fire-analytics",[GMe]:"fire-analytics-compat",[WMe]:"fire-app-check",[BMe]:"fire-app-check-compat",[HMe]:"fire-auth",[qMe]:"fire-auth-compat",[KMe]:"fire-rtdb",[YMe]:"fire-data-connect",[XMe]:"fire-rtdb-compat",[ZMe]:"fire-fn",[JMe]:"fire-fn-compat",[QMe]:"fire-iid",[e3e]:"fire-iid-compat",[t3e]:"fire-fcm",[n3e]:"fire-fcm-compat",[r3e]:"fire-perf",[i3e]:"fire-perf-compat",[s3e]:"fire-rc",[o3e]:"fire-rc-compat",[a3e]:"fire-gcs",[l3e]:"fire-gcs-compat",[c3e]:"fire-fst",[h3e]:"fire-fst-compat",[u3e]:"fire-vertex","fire-js":"fire-js",[d3e]:"fire-js-all"};const r4=new Map,m3e=new Map,u8=new Map;function LZ(t,e){try{t.container.addComponent(e)}catch(n){dp.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function A1(t){const e=t.name;if(u8.has(e))return dp.debug(`There were multiple attempts to register component ${e}.`),!1;u8.set(e,t);for(const n of r4.values())LZ(n,t);for(const n of m3e.values())LZ(n,t);return!0}function z5(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function lc(t){return t==null?!1:t.settings!==void 0}const g3e={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},gg=new KA("app","Firebase",g3e);class y3e{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Rg("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw gg.create("app-deleted",{appName:this._name})}}const cv=f3e;function Bce(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:c8,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw gg.create("bad-app-name",{appName:String(i)});if(n||(n=Lce()),!n)throw gg.create("no-options");const s=r4.get(i);if(s){if(k1(n,s.options)&&k1(r,s.config))return s;throw gg.create("duplicate-app",{appName:i})}const o=new EMe(i);for(const l of u8.values())o.addComponent(l);const a=new y3e(n,r,o);return r4.set(i,a),a}function eU(t=c8){const e=r4.get(t);if(!e&&t===c8&&Lce())return Bce();if(!e)throw gg.create("no-app",{appName:t});return e}function _d(t,e,n){let r=p3e[t]??t;n&&(r+=`-${n}`);const i=r.match(/\s|\//),s=e.match(/\s|\//);if(i||s){const o=[`Unable to register library "${r}" with version "${e}":`];i&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),dp.warn(o.join(" "));return}A1(new Rg(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}const v3e="firebase-heartbeat-database",_3e=1,Sk="firebase-heartbeat-store";let ij=null;function Wce(){return ij||(ij=DMe(v3e,_3e,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Sk)}catch(n){console.warn(n)}}}}).catch(t=>{throw gg.create("idb-open",{originalErrorMessage:t.message})})),ij}async function x3e(t){try{const n=(await Wce()).transaction(Sk),r=await n.objectStore(Sk).get(Hce(t));return await n.done,r}catch(e){if(e instanceof Ud)dp.warn(e.message);else{const n=gg.create("idb-get",{originalErrorMessage:e?.message});dp.warn(n.message)}}}async function DZ(t,e){try{const r=(await Wce()).transaction(Sk,"readwrite");await r.objectStore(Sk).put(e,Hce(t)),await r.done}catch(n){if(n instanceof Ud)dp.warn(n.message);else{const r=gg.create("idb-set",{originalErrorMessage:n?.message});dp.warn(r.message)}}}function Hce(t){return`${t.name}!${t.options.appId}`}const w3e=1024,b3e=30;class E3e{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new T3e(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=jZ();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(i=>i.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats.length>b3e){const i=k3e(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){dp.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=jZ(),{heartbeatsToSend:n,unsentEntries:r}=S3e(this._heartbeatsCache.heartbeats),i=n4(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return dp.warn(e),""}}}function jZ(){return new Date().toISOString().substring(0,10)}function S3e(t,e=w3e){const n=[];let r=t.slice();for(const i of t){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),$Z(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),$Z(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class T3e{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return zce()?dMe().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await x3e(this.app);return n?.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return DZ(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return DZ(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function $Z(t){return n4(JSON.stringify({version:2,heartbeats:t})).length}function k3e(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}function A3e(t){A1(new Rg("platform-logger",e=>new FMe(e),"PRIVATE")),A1(new Rg("heartbeat",e=>new E3e(e),"PRIVATE")),_d(l8,OZ,t),_d(l8,OZ,"esm2020"),_d("fire-js","")}A3e("");function qce(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const I3e=qce,Kce=new KA("auth","Firebase",qce());const i4=new JG("@firebase/auth");function P3e(t,...e){i4.logLevel<=tr.WARN&&i4.warn(`Auth (${cv}): ${t}`,...e)}function JR(t,...e){i4.logLevel<=tr.ERROR&&i4.error(`Auth (${cv}): ${t}`,...e)}function Rd(t,...e){throw nU(t,...e)}function hh(t,...e){return nU(t,...e)}function tU(t,e,n){const r={...I3e(),[e]:n};return new KA("auth","Firebase",r).create(e,{appName:t.name})}function yg(t){return tU(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function C3e(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&Rd(t,"argument-error"),tU(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function nU(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return Kce.create(t,...e)}function In(t,e,...n){if(!t)throw nU(e,...n)}function Wf(t){const e="INTERNAL ASSERTION FAILED: "+t;throw JR(e),new Error(e)}function fp(t,e){t||Wf(e)}function h8(){return typeof self<"u"&&self.location?.href||""}function R3e(){return FZ()==="http:"||FZ()==="https:"}function FZ(){return typeof self<"u"&&self.location?.protocol||null}function M3e(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(R3e()||cMe()||"connection"in navigator)?navigator.onLine:!0}function N3e(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}class XA{constructor(e,n){this.shortDelay=e,this.longDelay=n,fp(n>e,"Short delay should be less than long delay!"),this.isMobile=aMe()||uMe()}get(){return M3e()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function rU(t,e){fp(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}class Yce{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Wf("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Wf("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Wf("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const O3e={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const L3e=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],D3e=new XA(3e4,6e4);function G5(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function J2(t,e,n,r,i={}){return Xce(t,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const a=YA({key:t.config.apiKey,...o}).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const c={method:e,headers:l,...s};return lMe()||(c.referrerPolicy="no-referrer"),t.emulatorConfig&&lv(t.emulatorConfig.host)&&(c.credentials="include"),Yce.fetch()(await Jce(t,t.config.apiHost,n,a),c)})}async function Xce(t,e,n){t._canInitEmulator=!1;const r={...O3e,...e};try{const i=new j3e(t),s=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw wC(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[l,c]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw wC(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw wC(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw wC(t,"user-disabled",o);const u=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw tU(t,u,c);Rd(t,u)}}catch(i){if(i instanceof Ud)throw i;Rd(t,"network-request-failed",{message:String(i)})}}async function Zce(t,e,n,r,i={}){const s=await J2(t,e,n,r,i);return"mfaPendingCredential"in s&&Rd(t,"multi-factor-auth-required",{_serverResponse:s}),s}async function Jce(t,e,n,r){const i=`${e}${n}?${r}`,s=t,o=s.config.emulator?rU(t.config,i):`${t.config.apiScheme}://${i}`;return L3e.includes(n)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}class j3e{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(hh(this.auth,"network-request-failed")),D3e.get())})}}function wC(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=hh(t,e,r);return i.customData._tokenResponse=n,i}async function $3e(t,e){return J2(t,"POST","/v1/accounts:delete",e)}async function s4(t,e){return J2(t,"POST","/v1/accounts:lookup",e)}function nT(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function F3e(t,e=!1){const n=mo(t),r=await n.getIdToken(e),i=iU(r);In(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s?.sign_in_provider;return{claims:i,token:r,authTime:nT(sj(i.auth_time)),issuedAtTime:nT(sj(i.iat)),expirationTime:nT(sj(i.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}}function sj(t){return Number(t)*1e3}function iU(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return JR("JWT malformed, contained fewer than 3 sections"),null;try{const i=Rce(n);return i?JSON.parse(i):(JR("Failed to decode base64 JWT payload"),null)}catch(i){return JR("Caught error parsing JWT payload as JSON",i?.toString()),null}}function VZ(t){const e=iU(t);return In(e,"internal-error"),In(typeof e.exp<"u","internal-error"),In(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Tk(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Ud&&V3e(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function V3e({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}class z3e{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class d8{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=nT(this.lastLoginAt),this.creationTime=nT(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function o4(t){const e=t.auth,n=await t.getIdToken(),r=await Tk(t,s4(e,{idToken:n}));In(r?.users.length,e,"internal-error");const i=r.users[0];t._notifyReloadListener(i);const s=i.providerUserInfo?.length?Qce(i.providerUserInfo):[],o=U3e(t.providerData,s),a=t.isAnonymous,l=!(t.email&&i.passwordHash)&&!o?.length,c=a?l:!1,u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new d8(i.createdAt,i.lastLoginAt),isAnonymous:c};Object.assign(t,u)}async function G3e(t){const e=mo(t);await o4(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function U3e(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function Qce(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}async function B3e(t,e){const n=await Xce(t,{},async()=>{const r=YA({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,o=await Jce(t,i,"/v1/token",`key=${s}`),a=await t._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:a,body:r};return t.emulatorConfig&&lv(t.emulatorConfig.host)&&(l.credentials="include"),Yce.fetch()(o,l)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function W3e(t,e){return J2(t,"POST","/v2/accounts:revokeToken",G5(t,e))}class Zx{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){In(e.idToken,"internal-error"),In(typeof e.idToken<"u","internal-error"),In(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):VZ(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){In(e.length!==0,"internal-error");const n=VZ(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(In(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:s}=await B3e(e,n);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:s}=n,o=new Zx;return r&&(In(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(In(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(In(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Zx,this.toJSON())}_performRefresh(){return Wf("not implemented")}}function rm(t,e){In(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class oh{constructor({uid:e,auth:n,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new z3e(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new d8(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await Tk(this,this.stsTokenManager.getToken(this.auth,e));return In(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return F3e(this,e)}reload(){return G3e(this)}_assign(e){this!==e&&(In(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new oh({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){In(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await o4(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(lc(this.auth.app))return Promise.reject(yg(this.auth));const e=await this.getIdToken();return await Tk(this,$3e(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,i=n.email??void 0,s=n.phoneNumber??void 0,o=n.photoURL??void 0,a=n.tenantId??void 0,l=n._redirectEventId??void 0,c=n.createdAt??void 0,u=n.lastLoginAt??void 0,{uid:h,emailVerified:f,isAnonymous:g,providerData:y,stsTokenManager:_}=n;In(h&&_,e,"internal-error");const b=Zx.fromJSON(this.name,_);In(typeof h=="string",e,"internal-error"),rm(r,e.name),rm(i,e.name),In(typeof f=="boolean",e,"internal-error"),In(typeof g=="boolean",e,"internal-error"),rm(s,e.name),rm(o,e.name),rm(a,e.name),rm(l,e.name),rm(c,e.name),rm(u,e.name);const T=new oh({uid:h,auth:e,email:i,emailVerified:f,displayName:r,isAnonymous:g,photoURL:o,phoneNumber:s,tenantId:a,stsTokenManager:b,createdAt:c,lastLoginAt:u});return y&&Array.isArray(y)&&(T.providerData=y.map(A=>({...A}))),l&&(T._redirectEventId=l),T}static async _fromIdTokenResponse(e,n,r=!1){const i=new Zx;i.updateFromServerResponse(n);const s=new oh({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await o4(s),s}static async _fromGetAccountInfoResponse(e,n,r){const i=n.users[0];In(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?Qce(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!s?.length,a=new Zx;a.updateFromIdToken(r);const l=new oh({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),c={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new d8(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(l,c),l}}const zZ=new Map;function Hf(t){fp(t instanceof Function,"Expected a class definition");let e=zZ.get(t);return e?(fp(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,zZ.set(t,e),e)}class eue{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}eue.type="NONE";const GZ=eue;function QR(t,e,n){return`firebase:${t}:${e}:${n}`}class Jx{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=QR(this.userKey,i.apiKey,s),this.fullPersistenceKey=QR("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await s4(this.auth,{idToken:e}).catch(()=>{});return n?oh._fromGetAccountInfoResponse(this.auth,n,e):null}return oh._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Jx(Hf(GZ),e,r);const i=(await Promise.all(n.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let s=i[0]||Hf(GZ);const o=QR(r,e.config.apiKey,e.name);let a=null;for(const c of n)try{const u=await c._get(o);if(u){let h;if(typeof u=="string"){const f=await s4(e,{idToken:u}).catch(()=>{});if(!f)break;h=await oh._fromGetAccountInfoResponse(e,f,u)}else h=oh._fromJSON(e,u);c!==s&&(a=h),s=c;break}}catch{}const l=i.filter(c=>c._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new Jx(s,e,r):(s=l[0],a&&await s._set(o,a.toJSON()),await Promise.all(n.map(async c=>{if(c!==s)try{await c._remove(o)}catch{}})),new Jx(s,e,r))}}function UZ(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(iue(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(tue(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(oue(e))return"Blackberry";if(aue(e))return"Webos";if(nue(e))return"Safari";if((e.includes("chrome/")||rue(e))&&!e.includes("edge/"))return"Chrome";if(sue(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if(r?.length===2)return r[1]}return"Other"}function tue(t=Ks()){return/firefox\//i.test(t)}function nue(t=Ks()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function rue(t=Ks()){return/crios\//i.test(t)}function iue(t=Ks()){return/iemobile/i.test(t)}function sue(t=Ks()){return/android/i.test(t)}function oue(t=Ks()){return/blackberry/i.test(t)}function aue(t=Ks()){return/webos/i.test(t)}function sU(t=Ks()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function H3e(t=Ks()){return sU(t)&&!!window.navigator?.standalone}function q3e(){return hMe()&&document.documentMode===10}function lue(t=Ks()){return sU(t)||sue(t)||aue(t)||oue(t)||/windows phone/i.test(t)||iue(t)}function cue(t,e=[]){let n;switch(t){case"Browser":n=UZ(Ks());break;case"Worker":n=`${UZ(Ks())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${cv}/${r}`}class K3e{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=s=>new Promise((o,a)=>{try{const l=e(s);o(l)}catch(l){a(l)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}async function Y3e(t,e={}){return J2(t,"GET","/v2/passwordPolicy",G5(t,e))}const X3e=6;class Z3e{constructor(e){const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??X3e,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}class J3e{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new BZ(this),this.idTokenSubscription=new BZ(this),this.beforeStateQueue=new K3e(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Kce,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Hf(n)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Jx.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await s4(this,{idToken:e}),r=await oh._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(lc(this.app)){const s=this.app.settings.authIdToken;return s?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(s).then(o,o))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const s=this.redirectUser?._redirectEventId,o=r?._redirectEventId,a=await this.tryRedirectSignIn(e);(!s||s===o)&&a?.user&&(r=a.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(s){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return In(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await o4(e)}catch(n){if(n?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=N3e()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(lc(this.app))return Promise.reject(yg(this));const n=e?mo(e):null;return n&&In(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&In(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return lc(this.app)?Promise.reject(yg(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return lc(this.app)?Promise.reject(yg(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Hf(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Y3e(this),n=new Z3e(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new KA("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await W3e(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Hf(e)||this._popupRedirectResolver;In(n,this,"argument-error"),this.redirectPersistenceManager=await Jx.create(this,[Hf(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(In(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,r,i);return()=>{o=!0,l()}}else{const l=e.addObserver(n);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return In(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=cue(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(lc(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&P3e(`Error while retrieving App Check token: ${e.error}`),e?.token}}function ZA(t){return mo(t)}class BZ{constructor(e){this.auth=e,this.observer=null,this.addObserver=yMe(n=>this.observer=n)}get next(){return In(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let oU={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Q3e(t){oU=t}function e4e(t){return oU.loadJS(t)}function t4e(){return oU.gapiScript}function n4e(t){return`__${t}${Math.floor(Math.random()*1e6)}`}function r4e(t,e){const n=z5(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),s=n.getOptions();if(k1(s,e??{}))return i;Rd(i,"already-initialized")}return n.initialize({options:e})}function i4e(t,e){const n=e?.persistence||[],r=(Array.isArray(n)?n:[n]).map(Hf);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e?.popupRedirectResolver)}function s4e(t,e,n){const r=ZA(t);In(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,s=uue(e),{host:o,port:a}=o4e(e),l=a===null?"":`:${a}`,c={url:`${s}//${o}${l}/`},u=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){In(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),In(k1(c,r.config.emulator)&&k1(u,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=c,r.emulatorConfig=u,r.settings.appVerificationDisabledForTesting=!0,lv(o)?(XG(`${s}//${o}${l}`),ZG("Auth",!0)):a4e()}function uue(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function o4e(t){const e=uue(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:WZ(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:WZ(o)}}}function WZ(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function a4e(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}class hue{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Wf("not implemented")}_getIdTokenResponse(e){return Wf("not implemented")}_linkToIdToken(e,n){return Wf("not implemented")}_getReauthenticationResolver(e){return Wf("not implemented")}}async function Qx(t,e){return Zce(t,"POST","/v1/accounts:signInWithIdp",G5(t,e))}const l4e="http://localhost";class I1 extends hue{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new I1(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Rd("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...s}=n;if(!r||!i)return null;const o=new I1(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Qx(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Qx(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Qx(e,n)}buildRequest(){const e={requestUri:l4e,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=YA(n)}return e}}class aU{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class JA extends aU{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Vm extends JA{constructor(){super("facebook.com")}static credential(e){return I1._fromParams({providerId:Vm.PROVIDER_ID,signInMethod:Vm.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Vm.credentialFromTaggedObject(e)}static credentialFromError(e){return Vm.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Vm.credential(e.oauthAccessToken)}catch{return null}}}Vm.FACEBOOK_SIGN_IN_METHOD="facebook.com";Vm.PROVIDER_ID="facebook.com";class eh extends JA{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return I1._fromParams({providerId:eh.PROVIDER_ID,signInMethod:eh.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return eh.credentialFromTaggedObject(e)}static credentialFromError(e){return eh.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return eh.credential(n,r)}catch{return null}}}eh.GOOGLE_SIGN_IN_METHOD="google.com";eh.PROVIDER_ID="google.com";class zm extends JA{constructor(){super("github.com")}static credential(e){return I1._fromParams({providerId:zm.PROVIDER_ID,signInMethod:zm.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return zm.credentialFromTaggedObject(e)}static credentialFromError(e){return zm.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return zm.credential(e.oauthAccessToken)}catch{return null}}}zm.GITHUB_SIGN_IN_METHOD="github.com";zm.PROVIDER_ID="github.com";class Gm extends JA{constructor(){super("twitter.com")}static credential(e,n){return I1._fromParams({providerId:Gm.PROVIDER_ID,signInMethod:Gm.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Gm.credentialFromTaggedObject(e)}static credentialFromError(e){return Gm.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Gm.credential(n,r)}catch{return null}}}Gm.TWITTER_SIGN_IN_METHOD="twitter.com";Gm.PROVIDER_ID="twitter.com";async function c4e(t,e){return Zce(t,"POST","/v1/accounts:signUp",G5(t,e))}class Mg{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const s=await oh._fromIdTokenResponse(e,r,i),o=HZ(r);return new Mg({user:s,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=HZ(r);return new Mg({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function HZ(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}async function u4e(t){if(lc(t.app))return Promise.reject(yg(t));const e=ZA(t);if(await e._initializationPromise,e.currentUser?.isAnonymous)return new Mg({user:e.currentUser,providerId:null,operationType:"signIn"});const n=await c4e(e,{returnSecureToken:!0}),r=await Mg._fromIdTokenResponse(e,"signIn",n,!0);return await e._updateCurrentUser(r.user),r}class a4 extends Ud{constructor(e,n,r,i){super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,a4.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new a4(e,n,r,i)}}function due(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?a4._fromErrorAndOperation(t,s,e,r):s})}async function h4e(t,e,n=!1){const r=await Tk(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Mg._forOperation(t,"link",r)}async function d4e(t,e,n=!1){const{auth:r}=t;if(lc(r.app))return Promise.reject(yg(r));const i="reauthenticate";try{const s=await Tk(t,due(r,i,e,t),n);In(s.idToken,r,"internal-error");const o=iU(s.idToken);In(o,r,"internal-error");const{sub:a}=o;return In(t.uid===a,r,"user-mismatch"),Mg._forOperation(t,i,s)}catch(s){throw s?.code==="auth/user-not-found"&&Rd(r,"user-mismatch"),s}}async function f4e(t,e,n=!1){if(lc(t.app))return Promise.reject(yg(t));const r="signIn",i=await due(t,r,e),s=await Mg._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(s.user),s}function p4e(t,e,n,r){return mo(t).onIdTokenChanged(e,n,r)}function m4e(t,e,n){return mo(t).beforeAuthStateChanged(e,n)}function fue(t,e,n,r){return mo(t).onAuthStateChanged(e,n,r)}function pue(t){return mo(t).signOut()}const l4="__sak";class mue{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(l4,"1"),this.storage.removeItem(l4),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const g4e=1e3,y4e=10;class gue extends mue{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=lue(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;n?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);q3e()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,y4e):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},g4e)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}gue.type="LOCAL";const v4e=gue;class yue extends mue{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}yue.type="SESSION";const vue=yue;function _4e(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}class U5{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new U5(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:s}=n.data,o=this.handlersMap[i];if(!o?.size)return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const a=Array.from(o).map(async c=>c(n.origin,s)),l=await _4e(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}U5.receivers=[];function lU(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}class x4e{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,l)=>{const c=lU("",20);i.port1.start();const u=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(h){const f=h;if(f.data.eventId===c)switch(f.data.status){case"ack":clearTimeout(u),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(f.data.response);break;default:clearTimeout(u),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:c,data:n},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}function xd(){return window}function w4e(t){xd().location.href=t}function _ue(){return typeof xd().WorkerGlobalScope<"u"&&typeof xd().importScripts=="function"}async function b4e(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function E4e(){return navigator?.serviceWorker?.controller||null}function S4e(){return _ue()?self:null}const xue="firebaseLocalStorageDb",T4e=1,c4="firebaseLocalStorage",wue="fbase_key";class QA{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function B5(t,e){return t.transaction([c4],e?"readwrite":"readonly").objectStore(c4)}function k4e(){const t=indexedDB.deleteDatabase(xue);return new QA(t).toPromise()}function f8(){const t=indexedDB.open(xue,T4e);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(c4,{keyPath:wue})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(c4)?e(r):(r.close(),await k4e(),e(await f8()))})})}async function qZ(t,e,n){const r=B5(t,!0).put({[wue]:e,value:n});return new QA(r).toPromise()}async function A4e(t,e){const n=B5(t,!1).get(e),r=await new QA(n).toPromise();return r===void 0?null:r.value}function KZ(t,e){const n=B5(t,!0).delete(e);return new QA(n).toPromise()}const I4e=800,P4e=3;class bue{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await f8(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>P4e)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return _ue()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=U5._getInstance(S4e()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await b4e(),!this.activeServiceWorker)return;this.sender=new x4e(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||E4e()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await f8();return await qZ(e,l4,"1"),await KZ(e,l4),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>qZ(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>A4e(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>KZ(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=B5(i,!1).getAll();return new QA(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),I4e)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}bue.type="LOCAL";const C4e=bue;new XA(3e4,6e4);function Eue(t,e){return e?Hf(e):(In(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}class cU extends hue{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Qx(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Qx(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Qx(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function R4e(t){return f4e(t.auth,new cU(t),t.bypassAuthState)}function M4e(t){const{auth:e,user:n}=t;return In(n,e,"internal-error"),d4e(n,new cU(t),t.bypassAuthState)}async function N4e(t){const{auth:e,user:n}=t;return In(n,e,"internal-error"),h4e(n,new cU(t),t.bypassAuthState)}class Sue{constructor(e,n,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return R4e;case"linkViaPopup":case"linkViaRedirect":return N4e;case"reauthViaPopup":case"reauthViaRedirect":return M4e;default:Rd(this.auth,"internal-error")}}resolve(e){fp(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){fp(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const O4e=new XA(2e3,1e4);async function YZ(t,e,n){if(lc(t.app))return Promise.reject(hh(t,"operation-not-supported-in-this-environment"));const r=ZA(t);C3e(t,e,aU);const i=Eue(r,n);return new Ly(r,"signInViaPopup",e,i).executeNotNull()}class Ly extends Sue{constructor(e,n,r,i,s){super(e,n,i,s),this.provider=r,this.authWindow=null,this.pollId=null,Ly.currentPopupAction&&Ly.currentPopupAction.cancel(),Ly.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return In(e,this.auth,"internal-error"),e}async onExecution(){fp(this.filter.length===1,"Popup operations only handle one event");const e=lU();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(hh(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(hh(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ly.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(hh(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,O4e.get())};e()}}Ly.currentPopupAction=null;const L4e="pendingRedirect",eM=new Map;class D4e extends Sue{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=eM.get(this.auth._key());if(!e){try{const r=await j4e(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}eM.set(this.auth._key(),e)}return this.bypassAuthState||eM.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function j4e(t,e){const n=V4e(e),r=F4e(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}function $4e(t,e){eM.set(t._key(),e)}function F4e(t){return Hf(t._redirectPersistence)}function V4e(t){return QR(L4e,t.config.apiKey,t.name)}async function z4e(t,e,n=!1){if(lc(t.app))return Promise.reject(yg(t));const r=ZA(t),i=Eue(r,e),o=await new D4e(r,i,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}const G4e=600*1e3;class U4e{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!B4e(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){if(e.error&&!Tue(e)){const r=e.error.code?.split("auth/")[1]||"internal-error";n.onError(hh(this.auth,r))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=G4e&&this.cachedEventUids.clear(),this.cachedEventUids.has(XZ(e))}saveEventToCache(e){this.cachedEventUids.add(XZ(e)),this.lastProcessedEventTime=Date.now()}}function XZ(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function Tue({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function B4e(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Tue(t);default:return!1}}async function W4e(t,e={}){return J2(t,"GET","/v1/projects",e)}const H4e=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,q4e=/^https?/;async function K4e(t){if(t.config.emulator)return;const{authorizedDomains:e}=await W4e(t);for(const n of e)try{if(Y4e(n))return}catch{}Rd(t,"unauthorized-domain")}function Y4e(t){const e=h8(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!q4e.test(n))return!1;if(H4e.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const X4e=new XA(3e4,6e4);function ZZ(){const t=xd().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function Z4e(t){return new Promise((e,n)=>{function r(){ZZ(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{ZZ(),n(hh(t,"network-request-failed"))},timeout:X4e.get()})}if(xd().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(xd().gapi?.load)r();else{const i=n4e("iframefcb");return xd()[i]=()=>{gapi.load?r():n(hh(t,"network-request-failed"))},e4e(`${t4e()}?onload=${i}`).catch(s=>n(s))}}).catch(e=>{throw tM=null,e})}let tM=null;function J4e(t){return tM=tM||Z4e(t),tM}const Q4e=new XA(5e3,15e3),eNe="__/auth/iframe",tNe="emulator/auth/iframe",nNe={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},rNe=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function iNe(t){const e=t.config;In(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?rU(e,tNe):`https://${t.config.authDomain}/${eNe}`,r={apiKey:e.apiKey,appName:t.name,v:cv},i=rNe.get(t.config.apiHost);i&&(r.eid=i);const s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${YA(r).slice(1)}`}async function sNe(t){const e=await J4e(t),n=xd().gapi;return In(n,t,"internal-error"),e.open({where:document.body,url:iNe(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:nNe,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=hh(t,"network-request-failed"),a=xd().setTimeout(()=>{s(o)},Q4e.get());function l(){xd().clearTimeout(a),i(r)}r.ping(l).then(l,()=>{s(o)})}))}const oNe={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},aNe=500,lNe=600,cNe="_blank",uNe="http://localhost";class JZ{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function hNe(t,e,n,r=aNe,i=lNe){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l={...oNe,width:r.toString(),height:i.toString(),top:s,left:o},c=Ks().toLowerCase();n&&(a=rue(c)?cNe:n),tue(c)&&(e=e||uNe,l.scrollbars="yes");const u=Object.entries(l).reduce((f,[g,y])=>`${f}${g}=${y},`,"");if(H3e(c)&&a!=="_self")return dNe(e||"",a),new JZ(null);const h=window.open(e||"",a,u);In(h,t,"popup-blocked");try{h.focus()}catch{}return new JZ(h)}function dNe(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}const fNe="__/auth/handler",pNe="emulator/auth/handler",mNe=encodeURIComponent("fac");async function QZ(t,e,n,r,i,s){In(t.config.authDomain,t,"auth-domain-config-required"),In(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:cv,eventId:i};if(e instanceof aU){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",gMe(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[u,h]of Object.entries({}))o[u]=h}if(e instanceof JA){const u=e.getScopes().filter(h=>h!=="");u.length>0&&(o.scopes=u.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const u of Object.keys(a))a[u]===void 0&&delete a[u];const l=await t._getAppCheckToken(),c=l?`#${mNe}=${encodeURIComponent(l)}`:"";return`${gNe(t)}?${YA(a).slice(1)}${c}`}function gNe({config:t}){return t.emulator?rU(t,pNe):`https://${t.authDomain}/${fNe}`}const oj="webStorageSupport";class yNe{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=vue,this._completeRedirectFn=z4e,this._overrideRedirectResult=$4e}async _openPopup(e,n,r,i){fp(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const s=await QZ(e,n,r,h8(),i);return hNe(e,s,lU())}async _openRedirect(e,n,r,i){await this._originValidation(e);const s=await QZ(e,n,r,h8(),i);return w4e(s),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:s}=this.eventManagers[n];return i?Promise.resolve(i):(fp(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await sNe(e),r=new U4e(e);return n.register("authEvent",i=>(In(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(oj,{type:oj},i=>{const s=i?.[0]?.[oj];s!==void 0&&n(!!s),Rd(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=K4e(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return lue()||nue()||sU()}}const vNe=yNe;var eJ="@firebase/auth",tJ="1.12.0";class _Ne{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){In(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function xNe(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function wNe(t){A1(new Rg("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;In(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:cue(t)},c=new J3e(r,i,s,l);return i4e(c,n),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),A1(new Rg("auth-internal",e=>{const n=ZA(e.getProvider("auth").getImmediate());return(r=>new _Ne(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),_d(eJ,tJ,xNe(t)),_d(eJ,tJ,"esm2020")}const bNe=300,ENe=Dce("authIdTokenMaxAge")||bNe;let nJ=null;const SNe=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>ENe)return;const i=n?.token;nJ!==i&&(nJ=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function TNe(t=eU()){const e=z5(t,"auth");if(e.isInitialized())return e.getImmediate();const n=r4e(t,{popupRedirectResolver:vNe,persistence:[C4e,v4e,vue]}),r=Dce("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const o=SNe(s.toString());m4e(n,o,()=>o(n.currentUser)),p4e(n,a=>o(a))}}const i=Nce("auth");return i&&s4e(n,`http://${i}`),n}function kNe(){return document.getElementsByTagName("head")?.[0]??document}Q3e({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const s=hh("internal-error");s.customData=i,n(s)},r.type="text/javascript",r.charset="UTF-8",kNe().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});wNe("Browser");var ANe="firebase",INe="12.7.0";_d(ANe,INe,"app");var rJ=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var vg,kue;(function(){var t;function e(C,M){function O(){}O.prototype=M.prototype,C.F=M.prototype,C.prototype=new O,C.prototype.constructor=C,C.D=function(j,V,U){for(var G=Array(arguments.length-2),de=2;de<arguments.length;de++)G[de-2]=arguments[de];return M.prototype[V].apply(j,G)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(C,M,O){O||(O=0);const j=Array(16);if(typeof M=="string")for(var V=0;V<16;++V)j[V]=M.charCodeAt(O++)|M.charCodeAt(O++)<<8|M.charCodeAt(O++)<<16|M.charCodeAt(O++)<<24;else for(V=0;V<16;++V)j[V]=M[O++]|M[O++]<<8|M[O++]<<16|M[O++]<<24;M=C.g[0],O=C.g[1],V=C.g[2];let U=C.g[3],G;G=M+(U^O&(V^U))+j[0]+3614090360&4294967295,M=O+(G<<7&4294967295|G>>>25),G=U+(V^M&(O^V))+j[1]+3905402710&4294967295,U=M+(G<<12&4294967295|G>>>20),G=V+(O^U&(M^O))+j[2]+606105819&4294967295,V=U+(G<<17&4294967295|G>>>15),G=O+(M^V&(U^M))+j[3]+3250441966&4294967295,O=V+(G<<22&4294967295|G>>>10),G=M+(U^O&(V^U))+j[4]+4118548399&4294967295,M=O+(G<<7&4294967295|G>>>25),G=U+(V^M&(O^V))+j[5]+1200080426&4294967295,U=M+(G<<12&4294967295|G>>>20),G=V+(O^U&(M^O))+j[6]+2821735955&4294967295,V=U+(G<<17&4294967295|G>>>15),G=O+(M^V&(U^M))+j[7]+4249261313&4294967295,O=V+(G<<22&4294967295|G>>>10),G=M+(U^O&(V^U))+j[8]+1770035416&4294967295,M=O+(G<<7&4294967295|G>>>25),G=U+(V^M&(O^V))+j[9]+2336552879&4294967295,U=M+(G<<12&4294967295|G>>>20),G=V+(O^U&(M^O))+j[10]+4294925233&4294967295,V=U+(G<<17&4294967295|G>>>15),G=O+(M^V&(U^M))+j[11]+2304563134&4294967295,O=V+(G<<22&4294967295|G>>>10),G=M+(U^O&(V^U))+j[12]+1804603682&4294967295,M=O+(G<<7&4294967295|G>>>25),G=U+(V^M&(O^V))+j[13]+4254626195&4294967295,U=M+(G<<12&4294967295|G>>>20),G=V+(O^U&(M^O))+j[14]+2792965006&4294967295,V=U+(G<<17&4294967295|G>>>15),G=O+(M^V&(U^M))+j[15]+1236535329&4294967295,O=V+(G<<22&4294967295|G>>>10),G=M+(V^U&(O^V))+j[1]+4129170786&4294967295,M=O+(G<<5&4294967295|G>>>27),G=U+(O^V&(M^O))+j[6]+3225465664&4294967295,U=M+(G<<9&4294967295|G>>>23),G=V+(M^O&(U^M))+j[11]+643717713&4294967295,V=U+(G<<14&4294967295|G>>>18),G=O+(U^M&(V^U))+j[0]+3921069994&4294967295,O=V+(G<<20&4294967295|G>>>12),G=M+(V^U&(O^V))+j[5]+3593408605&4294967295,M=O+(G<<5&4294967295|G>>>27),G=U+(O^V&(M^O))+j[10]+38016083&4294967295,U=M+(G<<9&4294967295|G>>>23),G=V+(M^O&(U^M))+j[15]+3634488961&4294967295,V=U+(G<<14&4294967295|G>>>18),G=O+(U^M&(V^U))+j[4]+3889429448&4294967295,O=V+(G<<20&4294967295|G>>>12),G=M+(V^U&(O^V))+j[9]+568446438&4294967295,M=O+(G<<5&4294967295|G>>>27),G=U+(O^V&(M^O))+j[14]+3275163606&4294967295,U=M+(G<<9&4294967295|G>>>23),G=V+(M^O&(U^M))+j[3]+4107603335&4294967295,V=U+(G<<14&4294967295|G>>>18),G=O+(U^M&(V^U))+j[8]+1163531501&4294967295,O=V+(G<<20&4294967295|G>>>12),G=M+(V^U&(O^V))+j[13]+2850285829&4294967295,M=O+(G<<5&4294967295|G>>>27),G=U+(O^V&(M^O))+j[2]+4243563512&4294967295,U=M+(G<<9&4294967295|G>>>23),G=V+(M^O&(U^M))+j[7]+1735328473&4294967295,V=U+(G<<14&4294967295|G>>>18),G=O+(U^M&(V^U))+j[12]+2368359562&4294967295,O=V+(G<<20&4294967295|G>>>12),G=M+(O^V^U)+j[5]+4294588738&4294967295,M=O+(G<<4&4294967295|G>>>28),G=U+(M^O^V)+j[8]+2272392833&4294967295,U=M+(G<<11&4294967295|G>>>21),G=V+(U^M^O)+j[11]+1839030562&4294967295,V=U+(G<<16&4294967295|G>>>16),G=O+(V^U^M)+j[14]+4259657740&4294967295,O=V+(G<<23&4294967295|G>>>9),G=M+(O^V^U)+j[1]+2763975236&4294967295,M=O+(G<<4&4294967295|G>>>28),G=U+(M^O^V)+j[4]+1272893353&4294967295,U=M+(G<<11&4294967295|G>>>21),G=V+(U^M^O)+j[7]+4139469664&4294967295,V=U+(G<<16&4294967295|G>>>16),G=O+(V^U^M)+j[10]+3200236656&4294967295,O=V+(G<<23&4294967295|G>>>9),G=M+(O^V^U)+j[13]+681279174&4294967295,M=O+(G<<4&4294967295|G>>>28),G=U+(M^O^V)+j[0]+3936430074&4294967295,U=M+(G<<11&4294967295|G>>>21),G=V+(U^M^O)+j[3]+3572445317&4294967295,V=U+(G<<16&4294967295|G>>>16),G=O+(V^U^M)+j[6]+76029189&4294967295,O=V+(G<<23&4294967295|G>>>9),G=M+(O^V^U)+j[9]+3654602809&4294967295,M=O+(G<<4&4294967295|G>>>28),G=U+(M^O^V)+j[12]+3873151461&4294967295,U=M+(G<<11&4294967295|G>>>21),G=V+(U^M^O)+j[15]+530742520&4294967295,V=U+(G<<16&4294967295|G>>>16),G=O+(V^U^M)+j[2]+3299628645&4294967295,O=V+(G<<23&4294967295|G>>>9),G=M+(V^(O|~U))+j[0]+4096336452&4294967295,M=O+(G<<6&4294967295|G>>>26),G=U+(O^(M|~V))+j[7]+1126891415&4294967295,U=M+(G<<10&4294967295|G>>>22),G=V+(M^(U|~O))+j[14]+2878612391&4294967295,V=U+(G<<15&4294967295|G>>>17),G=O+(U^(V|~M))+j[5]+4237533241&4294967295,O=V+(G<<21&4294967295|G>>>11),G=M+(V^(O|~U))+j[12]+1700485571&4294967295,M=O+(G<<6&4294967295|G>>>26),G=U+(O^(M|~V))+j[3]+2399980690&4294967295,U=M+(G<<10&4294967295|G>>>22),G=V+(M^(U|~O))+j[10]+4293915773&4294967295,V=U+(G<<15&4294967295|G>>>17),G=O+(U^(V|~M))+j[1]+2240044497&4294967295,O=V+(G<<21&4294967295|G>>>11),G=M+(V^(O|~U))+j[8]+1873313359&4294967295,M=O+(G<<6&4294967295|G>>>26),G=U+(O^(M|~V))+j[15]+4264355552&4294967295,U=M+(G<<10&4294967295|G>>>22),G=V+(M^(U|~O))+j[6]+2734768916&4294967295,V=U+(G<<15&4294967295|G>>>17),G=O+(U^(V|~M))+j[13]+1309151649&4294967295,O=V+(G<<21&4294967295|G>>>11),G=M+(V^(O|~U))+j[4]+4149444226&4294967295,M=O+(G<<6&4294967295|G>>>26),G=U+(O^(M|~V))+j[11]+3174756917&4294967295,U=M+(G<<10&4294967295|G>>>22),G=V+(M^(U|~O))+j[2]+718787259&4294967295,V=U+(G<<15&4294967295|G>>>17),G=O+(U^(V|~M))+j[9]+3951481745&4294967295,C.g[0]=C.g[0]+M&4294967295,C.g[1]=C.g[1]+(V+(G<<21&4294967295|G>>>11))&4294967295,C.g[2]=C.g[2]+V&4294967295,C.g[3]=C.g[3]+U&4294967295}r.prototype.v=function(C,M){M===void 0&&(M=C.length);const O=M-this.blockSize,j=this.C;let V=this.h,U=0;for(;U<M;){if(V==0)for(;U<=O;)i(this,C,U),U+=this.blockSize;if(typeof C=="string"){for(;U<M;)if(j[V++]=C.charCodeAt(U++),V==this.blockSize){i(this,j),V=0;break}}else for(;U<M;)if(j[V++]=C[U++],V==this.blockSize){i(this,j),V=0;break}}this.h=V,this.o+=M},r.prototype.A=function(){var C=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);C[0]=128;for(var M=1;M<C.length-8;++M)C[M]=0;M=this.o*8;for(var O=C.length-8;O<C.length;++O)C[O]=M&255,M/=256;for(this.v(C),C=Array(16),M=0,O=0;O<4;++O)for(let j=0;j<32;j+=8)C[M++]=this.g[O]>>>j&255;return C};function s(C,M){var O=a;return Object.prototype.hasOwnProperty.call(O,C)?O[C]:O[C]=M(C)}function o(C,M){this.h=M;const O=[];let j=!0;for(let V=C.length-1;V>=0;V--){const U=C[V]|0;j&&U==M||(O[V]=U,j=!1)}this.g=O}var a={};function l(C){return-128<=C&&C<128?s(C,function(M){return new o([M|0],M<0?-1:0)}):new o([C|0],C<0?-1:0)}function c(C){if(isNaN(C)||!isFinite(C))return h;if(C<0)return b(c(-C));const M=[];let O=1;for(let j=0;C>=O;j++)M[j]=C/O|0,O*=4294967296;return new o(M,0)}function u(C,M){if(C.length==0)throw Error("number format error: empty string");if(M=M||10,M<2||36<M)throw Error("radix out of range: "+M);if(C.charAt(0)=="-")return b(u(C.substring(1),M));if(C.indexOf("-")>=0)throw Error('number format error: interior "-" character');const O=c(Math.pow(M,8));let j=h;for(let U=0;U<C.length;U+=8){var V=Math.min(8,C.length-U);const G=parseInt(C.substring(U,U+V),M);V<8?(V=c(Math.pow(M,V)),j=j.j(V).add(c(G))):(j=j.j(O),j=j.add(c(G)))}return j}var h=l(0),f=l(1),g=l(16777216);t=o.prototype,t.m=function(){if(_(this))return-b(this).m();let C=0,M=1;for(let O=0;O<this.g.length;O++){const j=this.i(O);C+=(j>=0?j:4294967296+j)*M,M*=4294967296}return C},t.toString=function(C){if(C=C||10,C<2||36<C)throw Error("radix out of range: "+C);if(y(this))return"0";if(_(this))return"-"+b(this).toString(C);const M=c(Math.pow(C,6));var O=this;let j="";for(;;){const V=P(O,M).g;O=T(O,V.j(M));let U=((O.g.length>0?O.g[0]:O.h)>>>0).toString(C);if(O=V,y(O))return U+j;for(;U.length<6;)U="0"+U;j=U+j}},t.i=function(C){return C<0?0:C<this.g.length?this.g[C]:this.h};function y(C){if(C.h!=0)return!1;for(let M=0;M<C.g.length;M++)if(C.g[M]!=0)return!1;return!0}function _(C){return C.h==-1}t.l=function(C){return C=T(this,C),_(C)?-1:y(C)?0:1};function b(C){const M=C.g.length,O=[];for(let j=0;j<M;j++)O[j]=~C.g[j];return new o(O,~C.h).add(f)}t.abs=function(){return _(this)?b(this):this},t.add=function(C){const M=Math.max(this.g.length,C.g.length),O=[];let j=0;for(let V=0;V<=M;V++){let U=j+(this.i(V)&65535)+(C.i(V)&65535),G=(U>>>16)+(this.i(V)>>>16)+(C.i(V)>>>16);j=G>>>16,U&=65535,G&=65535,O[V]=G<<16|U}return new o(O,O[O.length-1]&-2147483648?-1:0)};function T(C,M){return C.add(b(M))}t.j=function(C){if(y(this)||y(C))return h;if(_(this))return _(C)?b(this).j(b(C)):b(b(this).j(C));if(_(C))return b(this.j(b(C)));if(this.l(g)<0&&C.l(g)<0)return c(this.m()*C.m());const M=this.g.length+C.g.length,O=[];for(var j=0;j<2*M;j++)O[j]=0;for(j=0;j<this.g.length;j++)for(let V=0;V<C.g.length;V++){const U=this.i(j)>>>16,G=this.i(j)&65535,de=C.i(V)>>>16,Ie=C.i(V)&65535;O[2*j+2*V]+=G*Ie,A(O,2*j+2*V),O[2*j+2*V+1]+=U*Ie,A(O,2*j+2*V+1),O[2*j+2*V+1]+=G*de,A(O,2*j+2*V+1),O[2*j+2*V+2]+=U*de,A(O,2*j+2*V+2)}for(C=0;C<M;C++)O[C]=O[2*C+1]<<16|O[2*C];for(C=M;C<2*M;C++)O[C]=0;return new o(O,0)};function A(C,M){for(;(C[M]&65535)!=C[M];)C[M+1]+=C[M]>>>16,C[M]&=65535,M++}function I(C,M){this.g=C,this.h=M}function P(C,M){if(y(M))throw Error("division by zero");if(y(C))return new I(h,h);if(_(C))return M=P(b(C),M),new I(b(M.g),b(M.h));if(_(M))return M=P(C,b(M)),new I(b(M.g),M.h);if(C.g.length>30){if(_(C)||_(M))throw Error("slowDivide_ only works with positive integers.");for(var O=f,j=M;j.l(C)<=0;)O=R(O),j=R(j);var V=D(O,1),U=D(j,1);for(j=D(j,2),O=D(O,2);!y(j);){var G=U.add(j);G.l(C)<=0&&(V=V.add(O),U=G),j=D(j,1),O=D(O,1)}return M=T(C,V.j(M)),new I(V,M)}for(V=h;C.l(M)>=0;){for(O=Math.max(1,Math.floor(C.m()/M.m())),j=Math.ceil(Math.log(O)/Math.LN2),j=j<=48?1:Math.pow(2,j-48),U=c(O),G=U.j(M);_(G)||G.l(C)>0;)O-=j,U=c(O),G=U.j(M);y(U)&&(U=f),V=V.add(U),C=T(C,G)}return new I(V,C)}t.B=function(C){return P(this,C).h},t.and=function(C){const M=Math.max(this.g.length,C.g.length),O=[];for(let j=0;j<M;j++)O[j]=this.i(j)&C.i(j);return new o(O,this.h&C.h)},t.or=function(C){const M=Math.max(this.g.length,C.g.length),O=[];for(let j=0;j<M;j++)O[j]=this.i(j)|C.i(j);return new o(O,this.h|C.h)},t.xor=function(C){const M=Math.max(this.g.length,C.g.length),O=[];for(let j=0;j<M;j++)O[j]=this.i(j)^C.i(j);return new o(O,this.h^C.h)};function R(C){const M=C.g.length+1,O=[];for(let j=0;j<M;j++)O[j]=C.i(j)<<1|C.i(j-1)>>>31;return new o(O,C.h)}function D(C,M){const O=M>>5;M%=32;const j=C.g.length-O,V=[];for(let U=0;U<j;U++)V[U]=M>0?C.i(U+O)>>>M|C.i(U+O+1)<<32-M:C.i(U+O);return new o(V,C.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,kue=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=u,vg=o}).apply(typeof rJ<"u"?rJ:typeof self<"u"?self:typeof window<"u"?window:{});var bC=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Aue,sS,Iue,nM,p8,Pue,Cue,Rue;(function(){var t,e=Object.defineProperty;function n(S){S=[typeof globalThis=="object"&&globalThis,S,typeof window=="object"&&window,typeof self=="object"&&self,typeof bC=="object"&&bC];for(var F=0;F<S.length;++F){var B=S[F];if(B&&B.Math==Math)return B}throw Error("Cannot find global object")}var r=n(this);function i(S,F){if(F)e:{var B=r;S=S.split(".");for(var Z=0;Z<S.length-1;Z++){var Ee=S[Z];if(!(Ee in B))break e;B=B[Ee]}S=S[S.length-1],Z=B[S],F=F(Z),F!=Z&&F!=null&&e(B,S,{configurable:!0,writable:!0,value:F})}}i("Symbol.dispose",function(S){return S||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(S){return S||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(S){return S||function(F){var B=[],Z;for(Z in F)Object.prototype.hasOwnProperty.call(F,Z)&&B.push([Z,F[Z]]);return B}});var s=s||{},o=this||self;function a(S){var F=typeof S;return F=="object"&&S!=null||F=="function"}function l(S,F,B){return S.call.apply(S.bind,arguments)}function c(S,F,B){return c=l,c.apply(null,arguments)}function u(S,F){var B=Array.prototype.slice.call(arguments,1);return function(){var Z=B.slice();return Z.push.apply(Z,arguments),S.apply(this,Z)}}function h(S,F){function B(){}B.prototype=F.prototype,S.Z=F.prototype,S.prototype=new B,S.prototype.constructor=S,S.Ob=function(Z,Ee,Fe){for(var xt=Array(arguments.length-2),On=2;On<arguments.length;On++)xt[On-2]=arguments[On];return F.prototype[Ee].apply(Z,xt)}}var f=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?S=>S&&AsyncContext.Snapshot.wrap(S):S=>S;function g(S){const F=S.length;if(F>0){const B=Array(F);for(let Z=0;Z<F;Z++)B[Z]=S[Z];return B}return[]}function y(S,F){for(let Z=1;Z<arguments.length;Z++){const Ee=arguments[Z];var B=typeof Ee;if(B=B!="object"?B:Ee?Array.isArray(Ee)?"array":B:"null",B=="array"||B=="object"&&typeof Ee.length=="number"){B=S.length||0;const Fe=Ee.length||0;S.length=B+Fe;for(let xt=0;xt<Fe;xt++)S[B+xt]=Ee[xt]}else S.push(Ee)}}class _{constructor(F,B){this.i=F,this.j=B,this.h=0,this.g=null}get(){let F;return this.h>0?(this.h--,F=this.g,this.g=F.next,F.next=null):F=this.i(),F}}function b(S){o.setTimeout(()=>{throw S},0)}function T(){var S=C;let F=null;return S.g&&(F=S.g,S.g=S.g.next,S.g||(S.h=null),F.next=null),F}class A{constructor(){this.h=this.g=null}add(F,B){const Z=I.get();Z.set(F,B),this.h?this.h.next=Z:this.g=Z,this.h=Z}}var I=new _(()=>new P,S=>S.reset());class P{constructor(){this.next=this.g=this.h=null}set(F,B){this.h=F,this.g=B,this.next=null}reset(){this.next=this.g=this.h=null}}let R,D=!1,C=new A,M=()=>{const S=Promise.resolve(void 0);R=()=>{S.then(O)}};function O(){for(var S;S=T();){try{S.h.call(S.g)}catch(B){b(B)}var F=I;F.j(S),F.h<100&&(F.h++,S.next=F.g,F.g=S)}D=!1}function j(){this.u=this.u,this.C=this.C}j.prototype.u=!1,j.prototype.dispose=function(){this.u||(this.u=!0,this.N())},j.prototype[Symbol.dispose]=function(){this.dispose()},j.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function V(S,F){this.type=S,this.g=this.target=F,this.defaultPrevented=!1}V.prototype.h=function(){this.defaultPrevented=!0};var U=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var S=!1,F=Object.defineProperty({},"passive",{get:function(){S=!0}});try{const B=()=>{};o.addEventListener("test",B,F),o.removeEventListener("test",B,F)}catch{}return S})();function G(S){return/^[\s\xa0]*$/.test(S)}function de(S,F){V.call(this,S?S.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,S&&this.init(S,F)}h(de,V),de.prototype.init=function(S,F){const B=this.type=S.type,Z=S.changedTouches&&S.changedTouches.length?S.changedTouches[0]:null;this.target=S.target||S.srcElement,this.g=F,F=S.relatedTarget,F||(B=="mouseover"?F=S.fromElement:B=="mouseout"&&(F=S.toElement)),this.relatedTarget=F,Z?(this.clientX=Z.clientX!==void 0?Z.clientX:Z.pageX,this.clientY=Z.clientY!==void 0?Z.clientY:Z.pageY,this.screenX=Z.screenX||0,this.screenY=Z.screenY||0):(this.clientX=S.clientX!==void 0?S.clientX:S.pageX,this.clientY=S.clientY!==void 0?S.clientY:S.pageY,this.screenX=S.screenX||0,this.screenY=S.screenY||0),this.button=S.button,this.key=S.key||"",this.ctrlKey=S.ctrlKey,this.altKey=S.altKey,this.shiftKey=S.shiftKey,this.metaKey=S.metaKey,this.pointerId=S.pointerId||0,this.pointerType=S.pointerType,this.state=S.state,this.i=S,S.defaultPrevented&&de.Z.h.call(this)},de.prototype.h=function(){de.Z.h.call(this);const S=this.i;S.preventDefault?S.preventDefault():S.returnValue=!1};var Ie="closure_listenable_"+(Math.random()*1e6|0),ze=0;function Ne(S,F,B,Z,Ee){this.listener=S,this.proxy=null,this.src=F,this.type=B,this.capture=!!Z,this.ha=Ee,this.key=++ze,this.da=this.fa=!1}function fe(S){S.da=!0,S.listener=null,S.proxy=null,S.src=null,S.ha=null}function De(S,F,B){for(const Z in S)F.call(B,S[Z],Z,S)}function Ce(S,F){for(const B in S)F.call(void 0,S[B],B,S)}function Q(S){const F={};for(const B in S)F[B]=S[B];return F}const W="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ne(S,F){let B,Z;for(let Ee=1;Ee<arguments.length;Ee++){Z=arguments[Ee];for(B in Z)S[B]=Z[B];for(let Fe=0;Fe<W.length;Fe++)B=W[Fe],Object.prototype.hasOwnProperty.call(Z,B)&&(S[B]=Z[B])}}function ie(S){this.src=S,this.g={},this.h=0}ie.prototype.add=function(S,F,B,Z,Ee){const Fe=S.toString();S=this.g[Fe],S||(S=this.g[Fe]=[],this.h++);const xt=ve(S,F,Z,Ee);return xt>-1?(F=S[xt],B||(F.fa=!1)):(F=new Ne(F,this.src,Fe,!!Z,Ee),F.fa=B,S.push(F)),F};function le(S,F){const B=F.type;if(B in S.g){var Z=S.g[B],Ee=Array.prototype.indexOf.call(Z,F,void 0),Fe;(Fe=Ee>=0)&&Array.prototype.splice.call(Z,Ee,1),Fe&&(fe(F),S.g[B].length==0&&(delete S.g[B],S.h--))}}function ve(S,F,B,Z){for(let Ee=0;Ee<S.length;++Ee){const Fe=S[Ee];if(!Fe.da&&Fe.listener==F&&Fe.capture==!!B&&Fe.ha==Z)return Ee}return-1}var qe="closure_lm_"+(Math.random()*1e6|0),Ke={};function Se(S,F,B,Z,Ee){if(Array.isArray(F)){for(let Fe=0;Fe<F.length;Fe++)Se(S,F[Fe],B,Z,Ee);return null}return B=hr(B),S&&S[Ie]?S.J(F,B,a(Z)?!!Z.capture:!1,Ee):we(S,F,B,!1,Z,Ee)}function we(S,F,B,Z,Ee,Fe){if(!F)throw Error("Invalid event type");const xt=a(Ee)?!!Ee.capture:!!Ee;let On=_n(S);if(On||(S[qe]=On=new ie(S)),B=On.add(F,B,Z,xt,Fe),B.proxy)return B;if(Z=Dt(),B.proxy=Z,Z.src=S,Z.listener=B,S.addEventListener)U||(Ee=xt),Ee===void 0&&(Ee=!1),S.addEventListener(F.toString(),Z,Ee);else if(S.attachEvent)S.attachEvent(jt(F.toString()),Z);else if(S.addListener&&S.removeListener)S.addListener(Z);else throw Error("addEventListener and attachEvent are unavailable.");return B}function Dt(){function S(B){return F.call(S.src,S.listener,B)}const F=pn;return S}function Ye(S,F,B,Z,Ee){if(Array.isArray(F))for(var Fe=0;Fe<F.length;Fe++)Ye(S,F[Fe],B,Z,Ee);else Z=a(Z)?!!Z.capture:!!Z,B=hr(B),S&&S[Ie]?(S=S.i,Fe=String(F).toString(),Fe in S.g&&(F=S.g[Fe],B=ve(F,B,Z,Ee),B>-1&&(fe(F[B]),Array.prototype.splice.call(F,B,1),F.length==0&&(delete S.g[Fe],S.h--)))):S&&(S=_n(S))&&(F=S.g[F.toString()],S=-1,F&&(S=ve(F,B,Z,Ee)),(B=S>-1?F[S]:null)&&on(B))}function on(S){if(typeof S!="number"&&S&&!S.da){var F=S.src;if(F&&F[Ie])le(F.i,S);else{var B=S.type,Z=S.proxy;F.removeEventListener?F.removeEventListener(B,Z,S.capture):F.detachEvent?F.detachEvent(jt(B),Z):F.addListener&&F.removeListener&&F.removeListener(Z),(B=_n(F))?(le(B,S),B.h==0&&(B.src=null,F[qe]=null)):fe(S)}}}function jt(S){return S in Ke?Ke[S]:Ke[S]="on"+S}function pn(S,F){if(S.da)S=!0;else{F=new de(F,this);const B=S.listener,Z=S.ha||S.src;S.fa&&on(S),S=B.call(Z,F)}return S}function _n(S){return S=S[qe],S instanceof ie?S:null}var dt="__closure_events_fn_"+(Math.random()*1e9>>>0);function hr(S){return typeof S=="function"?S:(S[dt]||(S[dt]=function(F){return S.handleEvent(F)}),S[dt])}function zn(){j.call(this),this.i=new ie(this),this.M=this,this.G=null}h(zn,j),zn.prototype[Ie]=!0,zn.prototype.removeEventListener=function(S,F,B,Z){Ye(this,S,F,B,Z)};function Wn(S,F){var B,Z=S.G;if(Z)for(B=[];Z;Z=Z.G)B.push(Z);if(S=S.M,Z=F.type||F,typeof F=="string")F=new V(F,S);else if(F instanceof V)F.target=F.target||S;else{var Ee=F;F=new V(Z,S),ne(F,Ee)}Ee=!0;let Fe,xt;if(B)for(xt=B.length-1;xt>=0;xt--)Fe=F.g=B[xt],Ee=ei(Fe,Z,!0,F)&&Ee;if(Fe=F.g=S,Ee=ei(Fe,Z,!0,F)&&Ee,Ee=ei(Fe,Z,!1,F)&&Ee,B)for(xt=0;xt<B.length;xt++)Fe=F.g=B[xt],Ee=ei(Fe,Z,!1,F)&&Ee}zn.prototype.N=function(){if(zn.Z.N.call(this),this.i){var S=this.i;for(const F in S.g){const B=S.g[F];for(let Z=0;Z<B.length;Z++)fe(B[Z]);delete S.g[F],S.h--}}this.G=null},zn.prototype.J=function(S,F,B,Z){return this.i.add(String(S),F,!1,B,Z)},zn.prototype.K=function(S,F,B,Z){return this.i.add(String(S),F,!0,B,Z)};function ei(S,F,B,Z){if(F=S.i.g[String(F)],!F)return!0;F=F.concat();let Ee=!0;for(let Fe=0;Fe<F.length;++Fe){const xt=F[Fe];if(xt&&!xt.da&&xt.capture==B){const On=xt.listener,os=xt.ha||xt.src;xt.fa&&le(S.i,xt),Ee=On.call(os,Z)!==!1&&Ee}}return Ee&&!Z.defaultPrevented}function _o(S,F){if(typeof S!="function")if(S&&typeof S.handleEvent=="function")S=c(S.handleEvent,S);else throw Error("Invalid listener argument");return Number(F)>2147483647?-1:o.setTimeout(S,F||0)}function Cr(S){S.g=_o(()=>{S.g=null,S.i&&(S.i=!1,Cr(S))},S.l);const F=S.h;S.h=null,S.m.apply(null,F)}class Ai extends j{constructor(F,B){super(),this.m=F,this.l=B,this.h=null,this.i=!1,this.g=null}j(F){this.h=arguments,this.g?this.i=!0:Cr(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ls(S){j.call(this),this.h=S,this.g={}}h(Ls,j);var bt=[];function Qn(S){De(S.g,function(F,B){this.g.hasOwnProperty(B)&&on(F)},S),S.g={}}Ls.prototype.N=function(){Ls.Z.N.call(this),Qn(this)},Ls.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var dr=o.JSON.stringify,Ft=o.JSON.parse,jn=class{stringify(S){return o.JSON.stringify(S,void 0)}parse(S){return o.JSON.parse(S,void 0)}};function en(){}function $o(){}var Gi={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Ds(){V.call(this,"d")}h(Ds,V);function Nn(){V.call(this,"c")}h(Nn,V);var Ii={},He=null;function ke(){return He=He||new zn}Ii.Ia="serverreachability";function Ae(S){V.call(this,Ii.Ia,S)}h(Ae,V);function sn(S){const F=ke();Wn(F,new Ae(F))}Ii.STAT_EVENT="statevent";function z(S,F){V.call(this,Ii.STAT_EVENT,S),this.stat=F}h(z,V);function Et(S){const F=ke();Wn(F,new z(F,S))}Ii.Ja="timingevent";function X(S,F){V.call(this,Ii.Ja,S),this.size=F}h(X,V);function ae(S,F){if(typeof S!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){S()},F)}function Ve(){this.g=!0}Ve.prototype.ua=function(){this.g=!1};function ee(S,F,B,Z,Ee,Fe){S.info(function(){if(S.g)if(Fe){var xt="",On=Fe.split("&");for(let $r=0;$r<On.length;$r++){var os=On[$r].split("=");if(os.length>1){const gs=os[0];os=os[1];const Vl=gs.split("_");xt=Vl.length>=2&&Vl[1]=="type"?xt+(gs+"="+os+"&"):xt+(gs+"=redacted&")}}}else xt=null;else xt=Fe;return"XMLHTTP REQ ("+Z+") [attempt "+Ee+"]: "+F+`
`+B+`
`+xt})}function ge(S,F,B,Z,Ee,Fe,xt){S.info(function(){return"XMLHTTP RESP ("+Z+") [ attempt "+Ee+"]: "+F+`
`+B+`
`+Fe+" "+xt})}function je(S,F,B,Z){S.info(function(){return"XMLHTTP TEXT ("+F+"): "+Ge(S,B)+(Z?" "+Z:"")})}function Je(S,F){S.info(function(){return"TIMEOUT: "+F})}Ve.prototype.info=function(){};function Ge(S,F){if(!S.g)return F;if(!F)return null;try{const Fe=JSON.parse(F);if(Fe){for(S=0;S<Fe.length;S++)if(Array.isArray(Fe[S])){var B=Fe[S];if(!(B.length<2)){var Z=B[1];if(Array.isArray(Z)&&!(Z.length<1)){var Ee=Z[0];if(Ee!="noop"&&Ee!="stop"&&Ee!="close")for(let xt=1;xt<Z.length;xt++)Z[xt]=""}}}}return dr(Fe)}catch{return F}}var nt={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},et={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Mt;function zt(){}h(zt,en),zt.prototype.g=function(){return new XMLHttpRequest},Mt=new zt;function yn(S){return encodeURIComponent(String(S))}function q(S){var F=1;S=S.split(":");const B=[];for(;F>0&&S.length;)B.push(S.shift()),F--;return S.length&&B.push(S.join(":")),B}function re(S,F,B,Z){this.j=S,this.i=F,this.l=B,this.S=Z||1,this.V=new Ls(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new J}function J(){this.i=null,this.g="",this.h=!1}var te={},se={};function oe(S,F,B){S.M=1,S.A=Hd(kc(F)),S.u=B,S.R=!0,Re(S,null)}function Re(S,F){S.F=Date.now(),Le(S),S.B=kc(S.A);var B=S.B,Z=S.S;Array.isArray(Z)||(Z=[String(Z)]),$b(B.i,"t",Z),S.C=0,B=S.j.L,S.h=new J,S.g=cP(S.j,B?F:null,!S.u),S.P>0&&(S.O=new Ai(c(S.Y,S,S.g),S.P)),F=S.V,B=S.g,Z=S.ba;var Ee="readystatechange";Array.isArray(Ee)||(Ee&&(bt[0]=Ee.toString()),Ee=bt);for(let Fe=0;Fe<Ee.length;Fe++){const xt=Se(B,Ee[Fe],Z||F.handleEvent,!1,F.h||F);if(!xt)break;F.g[xt.key]=xt}F=S.J?Q(S.J):{},S.u?(S.v||(S.v="POST"),F["Content-Type"]="application/x-www-form-urlencoded",S.g.ea(S.B,S.v,S.u,F)):(S.v="GET",S.g.ea(S.B,S.v,null,F)),sn(),ee(S.i,S.v,S.B,S.l,S.S,S.u)}re.prototype.ba=function(S){S=S.target;const F=this.O;F&&Oh(S)==3?F.j():this.Y(S)},re.prototype.Y=function(S){try{if(S==this.g)e:{const On=Oh(this.g),os=this.g.ya(),$r=this.g.ca();if(!(On<3)&&(On!=3||this.g&&(this.h.h||this.g.la()||aP(this.g)))){this.K||On!=4||os==7||(os==8||$r<=0?sn(3):sn(2)),gt(this);var F=this.g.ca();this.X=F;var B=Be(this);if(this.o=F==200,ge(this.i,this.v,this.B,this.l,this.S,On,F),this.o){if(this.U&&!this.L){t:{if(this.g){var Z,Ee=this.g;if((Z=Ee.g?Ee.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!G(Z)){var Fe=Z;break t}}Fe=null}if(S=Fe)je(this.i,this.l,S,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,ut(this,S);else{this.o=!1,this.m=3,Et(12),ct(this),Ct(this);break e}}if(this.R){S=!0;let gs;for(;!this.K&&this.C<B.length;)if(gs=Oe(this,B),gs==se){On==4&&(this.m=4,Et(14),S=!1),je(this.i,this.l,null,"[Incomplete Response]");break}else if(gs==te){this.m=4,Et(15),je(this.i,this.l,B,"[Invalid Chunk]"),S=!1;break}else je(this.i,this.l,gs,null),ut(this,gs);if(Pe(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),On!=4||B.length!=0||this.h.h||(this.m=1,Et(16),S=!1),this.o=this.o&&S,!S)je(this.i,this.l,B,"[Invalid Chunked Response]"),ct(this),Ct(this);else if(B.length>0&&!this.W){this.W=!0;var xt=this.j;xt.g==this&&xt.aa&&!xt.P&&(xt.j.info("Great, no buffering proxy detected. Bytes received: "+B.length),_0(xt),xt.P=!0,Et(11))}}else je(this.i,this.l,B,null),ut(this,B);On==4&&ct(this),this.o&&!this.K&&(On==4?Nv(this.j,this):(this.o=!1,Le(this)))}else Vb(this.g),F==400&&B.indexOf("Unknown SID")>0?(this.m=3,Et(12)):(this.m=0,Et(13)),ct(this),Ct(this)}}}catch{}};function Be(S){if(!Pe(S))return S.g.la();const F=aP(S.g);if(F==="")return"";let B="";const Z=F.length,Ee=Oh(S.g)==4;if(!S.h.i){if(typeof TextDecoder>"u")return ct(S),Ct(S),"";S.h.i=new o.TextDecoder}for(let Fe=0;Fe<Z;Fe++)S.h.h=!0,B+=S.h.i.decode(F[Fe],{stream:!(Ee&&Fe==Z-1)});return F.length=0,S.h.g+=B,S.C=0,S.h.g}function Pe(S){return S.g?S.v=="GET"&&S.M!=2&&S.j.Aa:!1}function Oe(S,F){var B=S.C,Z=F.indexOf(`
`,B);return Z==-1?se:(B=Number(F.substring(B,Z)),isNaN(B)?te:(Z+=1,Z+B>F.length?se:(F=F.slice(Z,Z+B),S.C=Z+B,F)))}re.prototype.cancel=function(){this.K=!0,ct(this)};function Le(S){S.T=Date.now()+S.H,lt(S,S.H)}function lt(S,F){if(S.D!=null)throw Error("WatchDog timer not null");S.D=ae(c(S.aa,S),F)}function gt(S){S.D&&(o.clearTimeout(S.D),S.D=null)}re.prototype.aa=function(){this.D=null;const S=Date.now();S-this.T>=0?(Je(this.i,this.B),this.M!=2&&(sn(),Et(17)),ct(this),this.m=2,Ct(this)):lt(this,this.T-S)};function Ct(S){S.j.I==0||S.K||Nv(S.j,S)}function ct(S){gt(S);var F=S.O;F&&typeof F.dispose=="function"&&F.dispose(),S.O=null,Qn(S.V),S.g&&(F=S.g,S.g=null,F.abort(),F.dispose())}function ut(S,F){try{var B=S.j;if(B.I!=0&&(B.g==S||Eu(B.h,S))){if(!S.L&&Eu(B.h,S)&&B.I==3){try{var Z=B.Ba.g.parse(F)}catch{Z=null}if(Array.isArray(Z)&&Z.length==3){var Ee=Z;if(Ee[0]==0){e:if(!B.v){if(B.g)if(B.g.F+3e3<S.F)Mv(B),$l(B);else break e;jh(B),Et(18)}}else B.xa=Ee[1],0<B.xa-B.K&&Ee[2]<37500&&B.F&&B.A==0&&!B.C&&(B.C=ae(c(B.Va,B),6e3));vi(B.h)<=1&&B.ta&&(B.ta=void 0)}else Fl(B,11)}else if((S.L||B.g==S)&&Mv(B),!G(F))for(Ee=B.Ba.g.parse(F),F=0;F<Ee.length;F++){let $r=Ee[F];const gs=$r[0];if(!(gs<=B.K))if(B.K=gs,$r=$r[1],B.I==2)if($r[0]=="c"){B.M=$r[1],B.ba=$r[2];const Vl=$r[3];Vl!=null&&(B.ka=Vl,B.j.info("VER="+B.ka));const Zd=$r[4];Zd!=null&&(B.za=Zd,B.j.info("SVER="+B.za));const $h=$r[5];$h!=null&&typeof $h=="number"&&$h>0&&(Z=1.5*$h,B.O=Z,B.j.info("backChannelRequestTimeoutMs_="+Z)),Z=B;const Fh=S.g;if(Fh){const Dv=Fh.g?Fh.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Dv){var Fe=Z.h;Fe.g||Dv.indexOf("spdy")==-1&&Dv.indexOf("quic")==-1&&Dv.indexOf("h2")==-1||(Fe.j=Fe.l,Fe.g=new Set,Fe.h&&(Tc(Fe,Fe.h),Fe.h=null))}if(Z.G){const Ub=Fh.g?Fh.g.getResponseHeader("X-HTTP-Session-Id"):null;Ub&&(Z.wa=Ub,br(Z.J,Z.G,Ub))}}B.I=3,B.l&&B.l.ra(),B.aa&&(B.T=Date.now()-S.F,B.j.info("Handshake RTT: "+B.T+"ms")),Z=B;var xt=S;if(Z.na=Gb(Z,Z.L?Z.ba:null,Z.W),xt.L){Dl(Z.h,xt);var On=xt,os=Z.O;os&&(On.H=os),On.D&&(gt(On),Le(On)),Z.g=xt}else Fo(Z);B.i.length>0&&Xd(B)}else $r[0]!="stop"&&$r[0]!="close"||Fl(B,7);else B.I==3&&($r[0]=="stop"||$r[0]=="close"?$r[0]=="stop"?Fl(B,7):Cv(B):$r[0]!="noop"&&B.l&&B.l.qa($r),B.A=0)}}sn(4)}catch{}}var En=class{constructor(S,F){this.g=S,this.map=F}};function Rr(S){this.l=S||10,o.PerformanceNavigationTiming?(S=o.performance.getEntriesByType("navigation"),S=S.length>0&&(S[0].nextHopProtocol=="hq"||S[0].nextHopProtocol=="h2")):S=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=S?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function jr(S){return S.h?!0:S.g?S.g.size>=S.j:!1}function vi(S){return S.h?1:S.g?S.g.size:0}function Eu(S,F){return S.h?S.h==F:S.g?S.g.has(F):!1}function Tc(S,F){S.g?S.g.add(F):S.h=F}function Dl(S,F){S.h&&S.h==F?S.h=null:S.g&&S.g.has(F)&&S.g.delete(F)}Rr.prototype.cancel=function(){if(this.i=ss(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const S of this.g.values())S.cancel();this.g.clear()}};function ss(S){if(S.h!=null)return S.i.concat(S.h.G);if(S.g!=null&&S.g.size!==0){let F=S.i;for(const B of S.g.values())F=F.concat(B.G);return F}return g(S.i)}var Rp=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Pi(S,F){if(S){S=S.split("&");for(let B=0;B<S.length;B++){const Z=S[B].indexOf("=");let Ee,Fe=null;Z>=0?(Ee=S[B].substring(0,Z),Fe=S[B].substring(Z+1)):Ee=S[B],F(Ee,Fe?decodeURIComponent(Fe.replace(/\+/g," ")):"")}}}function Ih(S){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let F;S instanceof Ih?(this.l=S.l,f0(this,S.j),this.o=S.o,this.g=S.g,Ph(this,S.u),this.h=S.h,Mp(this,Fb(S.i)),this.m=S.m):S&&(F=String(S).match(Rp))?(this.l=!1,f0(this,F[1]||"",!0),this.o=p0(F[2]||""),this.g=p0(F[3]||"",!0),Ph(this,F[4]),this.h=p0(F[5]||"",!0),Mp(this,F[6]||"",!0),this.m=p0(F[7]||"")):(this.l=!1,this.i=new sr(null,this.l))}Ih.prototype.toString=function(){const S=[];var F=this.j;F&&S.push(m0(F,Nb,!0),":");var B=this.g;return(B||F=="file")&&(S.push("//"),(F=this.o)&&S.push(m0(F,Nb,!0),"@"),S.push(yn(B).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),B=this.u,B!=null&&S.push(":",String(B))),(B=this.h)&&(this.g&&B.charAt(0)!="/"&&S.push("/"),S.push(m0(B,B.charAt(0)=="/"?g0:Ob,!0))),(B=this.i.toString())&&S.push("?",B),(B=this.m)&&S.push("#",m0(B,Lb)),S.join("")},Ih.prototype.resolve=function(S){const F=kc(this);let B=!!S.j;B?f0(F,S.j):B=!!S.o,B?F.o=S.o:B=!!S.g,B?F.g=S.g:B=S.u!=null;var Z=S.h;if(B)Ph(F,S.u);else if(B=!!S.h){if(Z.charAt(0)!="/")if(this.g&&!this.h)Z="/"+Z;else{var Ee=F.h.lastIndexOf("/");Ee!=-1&&(Z=F.h.slice(0,Ee+1)+Z)}if(Ee=Z,Ee==".."||Ee==".")Z="";else if(Ee.indexOf("./")!=-1||Ee.indexOf("/.")!=-1){Z=Ee.lastIndexOf("/",0)==0,Ee=Ee.split("/");const Fe=[];for(let xt=0;xt<Ee.length;){const On=Ee[xt++];On=="."?Z&&xt==Ee.length&&Fe.push(""):On==".."?((Fe.length>1||Fe.length==1&&Fe[0]!="")&&Fe.pop(),Z&&xt==Ee.length&&Fe.push("")):(Fe.push(On),Z=!0)}Z=Fe.join("/")}else Z=Ee}return B?F.h=Z:B=S.i.toString()!=="",B?Mp(F,Fb(S.i)):B=!!S.m,B&&(F.m=S.m),F};function kc(S){return new Ih(S)}function f0(S,F,B){S.j=B?p0(F,!0):F,S.j&&(S.j=S.j.replace(/:$/,""))}function Ph(S,F){if(F){if(F=Number(F),isNaN(F)||F<0)throw Error("Bad port number "+F);S.u=F}else S.u=null}function Mp(S,F,B){F instanceof sr?(S.i=F,Av(S.i,S.l)):(B||(F=m0(F,VL)),S.i=new sr(F,S.l))}function br(S,F,B){S.i.set(F,B)}function Hd(S){return br(S,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),S}function p0(S,F){return S?F?decodeURI(S.replace(/%25/g,"%2525")):decodeURIComponent(S):""}function m0(S,F,B){return typeof S=="string"?(S=encodeURI(S).replace(F,Mb),B&&(S=S.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),S):null}function Mb(S){return S=S.charCodeAt(0),"%"+(S>>4&15).toString(16)+(S&15).toString(16)}var Nb=/[#\/\?@]/g,Ob=/[#\?:]/g,g0=/[#\?]/g,VL=/[#\?@]/g,Lb=/#/g;function sr(S,F){this.h=this.g=null,this.i=S||null,this.j=!!F}function Ch(S){S.g||(S.g=new Map,S.h=0,S.i&&Pi(S.i,function(F,B){S.add(decodeURIComponent(F.replace(/\+/g," ")),B)}))}t=sr.prototype,t.add=function(S,F){Ch(this),this.i=null,S=Rh(this,S);let B=this.g.get(S);return B||this.g.set(S,B=[]),B.push(F),this.h+=1,this};function Db(S,F){Ch(S),F=Rh(S,F),S.g.has(F)&&(S.i=null,S.h-=S.g.get(F).length,S.g.delete(F))}function kv(S,F){return Ch(S),F=Rh(S,F),S.g.has(F)}t.forEach=function(S,F){Ch(this),this.g.forEach(function(B,Z){B.forEach(function(Ee){S.call(F,Ee,Z,this)},this)},this)};function jb(S,F){Ch(S);let B=[];if(typeof F=="string")kv(S,F)&&(B=B.concat(S.g.get(Rh(S,F))));else for(S=Array.from(S.g.values()),F=0;F<S.length;F++)B=B.concat(S[F]);return B}t.set=function(S,F){return Ch(this),this.i=null,S=Rh(this,S),kv(this,S)&&(this.h-=this.g.get(S).length),this.g.set(S,[F]),this.h+=1,this},t.get=function(S,F){return S?(S=jb(this,S),S.length>0?String(S[0]):F):F};function $b(S,F,B){Db(S,F),B.length>0&&(S.i=null,S.g.set(Rh(S,F),g(B)),S.h+=B.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const S=[],F=Array.from(this.g.keys());for(let Z=0;Z<F.length;Z++){var B=F[Z];const Ee=yn(B);B=jb(this,B);for(let Fe=0;Fe<B.length;Fe++){let xt=Ee;B[Fe]!==""&&(xt+="="+yn(B[Fe])),S.push(xt)}}return this.i=S.join("&")};function Fb(S){const F=new sr;return F.i=S.i,S.g&&(F.g=new Map(S.g),F.h=S.h),F}function Rh(S,F){return F=String(F),S.j&&(F=F.toLowerCase()),F}function Av(S,F){F&&!S.j&&(Ch(S),S.i=null,S.g.forEach(function(B,Z){const Ee=Z.toLowerCase();Z!=Ee&&(Db(this,Z),$b(this,Ee,B))},S)),S.j=F}function Mh(S,F){const B=new Ve;if(o.Image){const Z=new Image;Z.onload=u(xo,B,"TestLoadImage: loaded",!0,F,Z),Z.onerror=u(xo,B,"TestLoadImage: error",!1,F,Z),Z.onabort=u(xo,B,"TestLoadImage: abort",!1,F,Z),Z.ontimeout=u(xo,B,"TestLoadImage: timeout",!1,F,Z),o.setTimeout(function(){Z.ontimeout&&Z.ontimeout()},1e4),Z.src=S}else F(!1)}function Nh(S,F){const B=new Ve,Z=new AbortController,Ee=setTimeout(()=>{Z.abort(),xo(B,"TestPingServer: timeout",!1,F)},1e4);fetch(S,{signal:Z.signal}).then(Fe=>{clearTimeout(Ee),Fe.ok?xo(B,"TestPingServer: ok",!0,F):xo(B,"TestPingServer: server error",!1,F)}).catch(()=>{clearTimeout(Ee),xo(B,"TestPingServer: error",!1,F)})}function xo(S,F,B,Z,Ee){try{Ee&&(Ee.onload=null,Ee.onerror=null,Ee.onabort=null,Ee.ontimeout=null),Z(B)}catch{}}function y0(){this.g=new jn}function qd(S){this.i=S.Sb||null,this.h=S.ab||!1}h(qd,en),qd.prototype.g=function(){return new jl(this.i,this.h)};function jl(S,F){zn.call(this),this.H=S,this.o=F,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}h(jl,zn),t=jl.prototype,t.open=function(S,F){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=S,this.D=F,this.readyState=1,Su(this)},t.send=function(S){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const F={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};S&&(F.body=S),(this.H||o).fetch(new Request(this.D,F)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Np(this)),this.readyState=0},t.Pa=function(S){if(this.g&&(this.l=S,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=S.headers,this.readyState=2,Su(this)),this.g&&(this.readyState=3,Su(this),this.g)))if(this.responseType==="arraybuffer")S.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in S){if(this.j=S.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;iP(this)}else S.text().then(this.Oa.bind(this),this.ga.bind(this))};function iP(S){S.j.read().then(S.Ma.bind(S)).catch(S.ga.bind(S))}t.Ma=function(S){if(this.g){if(this.o&&S.value)this.response.push(S.value);else if(!this.o){var F=S.value?S.value:new Uint8Array(0);(F=this.B.decode(F,{stream:!S.done}))&&(this.response=this.responseText+=F)}S.done?Np(this):Su(this),this.readyState==3&&iP(this)}},t.Oa=function(S){this.g&&(this.response=this.responseText=S,Np(this))},t.Na=function(S){this.g&&(this.response=S,Np(this))},t.ga=function(){this.g&&Np(this)};function Np(S){S.readyState=4,S.l=null,S.j=null,S.B=null,Su(S)}t.setRequestHeader=function(S,F){this.A.append(S,F)},t.getResponseHeader=function(S){return this.h&&this.h.get(S.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const S=[],F=this.h.entries();for(var B=F.next();!B.done;)B=B.value,S.push(B[0]+": "+B[1]),B=F.next();return S.join(`\r
`)};function Su(S){S.onreadystatechange&&S.onreadystatechange.call(S)}Object.defineProperty(jl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(S){this.m=S?"include":"same-origin"}});function sP(S){let F="";return De(S,function(B,Z){F+=Z,F+=":",F+=B,F+=`\r
`}),F}function Iv(S,F,B){e:{for(Z in B){var Z=!1;break e}Z=!0}Z||(B=sP(B),typeof S=="string"?B!=null&&yn(B):br(S,F,B))}function ti(S){zn.call(this),this.headers=new Map,this.L=S||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}h(ti,zn);var oP=/^https?$/i,zL=["POST","PUT"];t=ti.prototype,t.Fa=function(S){this.H=S},t.ea=function(S,F,B,Z){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+S);F=F?F.toUpperCase():"GET",this.D=S,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Mt.g(),this.g.onreadystatechange=f(c(this.Ca,this));try{this.B=!0,this.g.open(F,String(S),!0),this.B=!1}catch(Fe){Op(this,Fe);return}if(S=B||"",B=new Map(this.headers),Z)if(Object.getPrototypeOf(Z)===Object.prototype)for(var Ee in Z)B.set(Ee,Z[Ee]);else if(typeof Z.keys=="function"&&typeof Z.get=="function")for(const Fe of Z.keys())B.set(Fe,Z.get(Fe));else throw Error("Unknown input type for opt_headers: "+String(Z));Z=Array.from(B.keys()).find(Fe=>Fe.toLowerCase()=="content-type"),Ee=o.FormData&&S instanceof o.FormData,!(Array.prototype.indexOf.call(zL,F,void 0)>=0)||Z||Ee||B.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Fe,xt]of B)this.g.setRequestHeader(Fe,xt);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(S),this.v=!1}catch(Fe){Op(this,Fe)}};function Op(S,F){S.h=!1,S.g&&(S.j=!0,S.g.abort(),S.j=!1),S.l=F,S.o=5,Lp(S),Yd(S)}function Lp(S){S.A||(S.A=!0,Wn(S,"complete"),Wn(S,"error"))}t.abort=function(S){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=S||7,Wn(this,"complete"),Wn(this,"abort"),Yd(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Yd(this,!0)),ti.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?Kd(this):this.Xa())},t.Xa=function(){Kd(this)};function Kd(S){if(S.h&&typeof s<"u"){if(S.v&&Oh(S)==4)setTimeout(S.Ca.bind(S),0);else if(Wn(S,"readystatechange"),Oh(S)==4){S.h=!1;try{const Fe=S.ca();e:switch(Fe){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var F=!0;break e;default:F=!1}var B;if(!(B=F)){var Z;if(Z=Fe===0){let xt=String(S.D).match(Rp)[1]||null;!xt&&o.self&&o.self.location&&(xt=o.self.location.protocol.slice(0,-1)),Z=!oP.test(xt?xt.toLowerCase():"")}B=Z}if(B)Wn(S,"complete"),Wn(S,"success");else{S.o=6;try{var Ee=Oh(S)>2?S.g.statusText:""}catch{Ee=""}S.l=Ee+" ["+S.ca()+"]",Lp(S)}}finally{Yd(S)}}}}function Yd(S,F){if(S.g){S.m&&(clearTimeout(S.m),S.m=null);const B=S.g;S.g=null,F||Wn(S,"ready");try{B.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function Oh(S){return S.g?S.g.readyState:0}t.ca=function(){try{return Oh(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(S){if(this.g){var F=this.g.responseText;return S&&F.indexOf(S)==0&&(F=F.substring(S.length)),Ft(F)}};function aP(S){try{if(!S.g)return null;if("response"in S.g)return S.g.response;switch(S.F){case"":case"text":return S.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in S.g)return S.g.mozResponseArrayBuffer}return null}catch{return null}}function Vb(S){const F={};S=(S.g&&Oh(S)>=2&&S.g.getAllResponseHeaders()||"").split(`\r
`);for(let Z=0;Z<S.length;Z++){if(G(S[Z]))continue;var B=q(S[Z]);const Ee=B[0];if(B=B[1],typeof B!="string")continue;B=B.trim();const Fe=F[Ee]||[];F[Ee]=Fe,Fe.push(B)}Ce(F,function(Z){return Z.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Lh(S,F,B){return B&&B.internalChannelParams&&B.internalChannelParams[S]||F}function Pv(S){this.za=0,this.i=[],this.j=new Ve,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Lh("failFast",!1,S),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Lh("baseRetryDelayMs",5e3,S),this.Za=Lh("retryDelaySeedMs",1e4,S),this.Ta=Lh("forwardChannelMaxRetries",2,S),this.va=Lh("forwardChannelRequestTimeoutMs",2e4,S),this.ma=S&&S.xmlHttpFactory||void 0,this.Ua=S&&S.Rb||void 0,this.Aa=S&&S.useFetchStreams||!1,this.O=void 0,this.L=S&&S.supportsCrossDomainXhr||!1,this.M="",this.h=new Rr(S&&S.concurrentRequestLimit),this.Ba=new y0,this.S=S&&S.fastHandshake||!1,this.R=S&&S.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=S&&S.Pb||!1,S&&S.ua&&this.j.ua(),S&&S.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&S&&S.detectBufferingProxy||!1,this.ia=void 0,S&&S.longPollingTimeout&&S.longPollingTimeout>0&&(this.ia=S.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=Pv.prototype,t.ka=8,t.I=1,t.connect=function(S,F,B,Z){Et(0),this.W=S,this.H=F||{},B&&Z!==void 0&&(this.H.OSID=B,this.H.OAID=Z),this.F=this.X,this.J=Gb(this,null,this.W),Xd(this)};function Cv(S){if(Rv(S),S.I==3){var F=S.V++,B=kc(S.J);if(br(B,"SID",S.M),br(B,"RID",F),br(B,"TYPE","terminate"),Dh(S,B),F=new re(S,S.j,F),F.M=2,F.A=Hd(kc(B)),B=!1,o.navigator&&o.navigator.sendBeacon)try{B=o.navigator.sendBeacon(F.A.toString(),"")}catch{}!B&&o.Image&&(new Image().src=F.A,B=!0),B||(F.g=cP(F.j,null),F.g.ea(F.A)),F.F=Date.now(),Le(F)}x0(S)}function $l(S){S.g&&(_0(S),S.g.cancel(),S.g=null)}function Rv(S){$l(S),S.v&&(o.clearTimeout(S.v),S.v=null),Mv(S),S.h.cancel(),S.m&&(typeof S.m=="number"&&o.clearTimeout(S.m),S.m=null)}function Xd(S){if(!jr(S.h)&&!S.m){S.m=!0;var F=S.Ea;R||M(),D||(R(),D=!0),C.add(F,S),S.D=0}}function lP(S,F){return vi(S.h)>=S.h.j-(S.m?1:0)?!1:S.m?(S.i=F.G.concat(S.i),!0):S.I==1||S.I==2||S.D>=(S.Sa?0:S.Ta)?!1:(S.m=ae(c(S.Ea,S,F),Ov(S,S.D)),S.D++,!0)}t.Ea=function(S){if(this.m)if(this.m=null,this.I==1){if(!S){this.V=Math.floor(Math.random()*1e5),S=this.V++;const Ee=new re(this,this.j,S);let Fe=this.o;if(this.U&&(Fe?(Fe=Q(Fe),ne(Fe,this.U)):Fe=this.U),this.u!==null||this.R||(Ee.J=Fe,Fe=null),this.S)e:{for(var F=0,B=0;B<this.i.length;B++){t:{var Z=this.i[B];if("__data__"in Z.map&&(Z=Z.map.__data__,typeof Z=="string")){Z=Z.length;break t}Z=void 0}if(Z===void 0)break;if(F+=Z,F>4096){F=B;break e}if(F===4096||B===this.i.length-1){F=B+1;break e}}F=1e3}else F=1e3;F=zb(this,Ee,F),B=kc(this.J),br(B,"RID",S),br(B,"CVER",22),this.G&&br(B,"X-HTTP-Session-Id",this.G),Dh(this,B),Fe&&(this.R?F="headers="+yn(sP(Fe))+"&"+F:this.u&&Iv(B,this.u,Fe)),Tc(this.h,Ee),this.Ra&&br(B,"TYPE","init"),this.S?(br(B,"$req",F),br(B,"SID","null"),Ee.U=!0,oe(Ee,B,null)):oe(Ee,B,F),this.I=2}}else this.I==3&&(S?v0(this,S):this.i.length==0||jr(this.h)||v0(this))};function v0(S,F){var B;F?B=F.l:B=S.V++;const Z=kc(S.J);br(Z,"SID",S.M),br(Z,"RID",B),br(Z,"AID",S.K),Dh(S,Z),S.u&&S.o&&Iv(Z,S.u,S.o),B=new re(S,S.j,B,S.D+1),S.u===null&&(B.J=S.o),F&&(S.i=F.G.concat(S.i)),F=zb(S,B,1e3),B.H=Math.round(S.va*.5)+Math.round(S.va*.5*Math.random()),Tc(S.h,B),oe(B,Z,F)}function Dh(S,F){S.H&&De(S.H,function(B,Z){br(F,Z,B)}),S.l&&De({},function(B,Z){br(F,Z,B)})}function zb(S,F,B){B=Math.min(S.i.length,B);const Z=S.l?c(S.l.Ka,S.l,S):null;e:{var Ee=S.i;let On=-1;for(;;){const os=["count="+B];On==-1?B>0?(On=Ee[0].g,os.push("ofs="+On)):On=0:os.push("ofs="+On);let $r=!0;for(let gs=0;gs<B;gs++){var Fe=Ee[gs].g;const Vl=Ee[gs].map;if(Fe-=On,Fe<0)On=Math.max(0,Ee[gs].g-100),$r=!1;else try{Fe="req"+Fe+"_"||"";try{var xt=Vl instanceof Map?Vl:Object.entries(Vl);for(const[Zd,$h]of xt){let Fh=$h;a($h)&&(Fh=dr($h)),os.push(Fe+Zd+"="+encodeURIComponent(Fh))}}catch(Zd){throw os.push(Fe+"type="+encodeURIComponent("_badmap")),Zd}}catch{Z&&Z(Vl)}}if($r){xt=os.join("&");break e}}xt=void 0}return S=S.i.splice(0,B),F.G=S,xt}function Fo(S){if(!S.g&&!S.v){S.Y=1;var F=S.Da;R||M(),D||(R(),D=!0),C.add(F,S),S.A=0}}function jh(S){return S.g||S.v||S.A>=3?!1:(S.Y++,S.v=ae(c(S.Da,S),Ov(S,S.A)),S.A++,!0)}t.Da=function(){if(this.v=null,Dp(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var S=4*this.T;this.j.info("BP detection timer enabled: "+S),this.B=ae(c(this.Wa,this),S)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Et(10),$l(this),Dp(this))};function _0(S){S.B!=null&&(o.clearTimeout(S.B),S.B=null)}function Dp(S){S.g=new re(S,S.j,"rpc",S.Y),S.u===null&&(S.g.J=S.o),S.g.P=0;var F=kc(S.na);br(F,"RID","rpc"),br(F,"SID",S.M),br(F,"AID",S.K),br(F,"CI",S.F?"0":"1"),!S.F&&S.ia&&br(F,"TO",S.ia),br(F,"TYPE","xmlhttp"),Dh(S,F),S.u&&S.o&&Iv(F,S.u,S.o),S.O&&(S.g.H=S.O);var B=S.g;S=S.ba,B.M=1,B.A=Hd(kc(F)),B.u=null,B.R=!0,Re(B,S)}t.Va=function(){this.C!=null&&(this.C=null,$l(this),jh(this),Et(19))};function Mv(S){S.C!=null&&(o.clearTimeout(S.C),S.C=null)}function Nv(S,F){var B=null;if(S.g==F){Mv(S),_0(S),S.g=null;var Z=2}else if(Eu(S.h,F))B=F.G,Dl(S.h,F),Z=1;else return;if(S.I!=0){if(F.o)if(Z==1){B=F.u?F.u.length:0,F=Date.now()-F.F;var Ee=S.D;Z=ke(),Wn(Z,new X(Z,B)),Xd(S)}else Fo(S);else if(Ee=F.m,Ee==3||Ee==0&&F.X>0||!(Z==1&&lP(S,F)||Z==2&&jh(S)))switch(B&&B.length>0&&(F=S.h,F.i=F.i.concat(B)),Ee){case 1:Fl(S,5);break;case 4:Fl(S,10);break;case 3:Fl(S,6);break;default:Fl(S,2)}}}function Ov(S,F){let B=S.Qa+Math.floor(Math.random()*S.Za);return S.isActive()||(B*=2),B*F}function Fl(S,F){if(S.j.info("Error code "+F),F==2){var B=c(S.bb,S),Z=S.Ua;const Ee=!Z;Z=new Ih(Z||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||f0(Z,"https"),Hd(Z),Ee?Mh(Z.toString(),B):Nh(Z.toString(),B)}else Et(2);S.I=0,S.l&&S.l.pa(F),x0(S),Rv(S)}t.bb=function(S){S?(this.j.info("Successfully pinged google.com"),Et(2)):(this.j.info("Failed to ping google.com"),Et(1))};function x0(S){if(S.I=0,S.ja=[],S.l){const F=ss(S.h);(F.length!=0||S.i.length!=0)&&(y(S.ja,F),y(S.ja,S.i),S.h.i.length=0,g(S.i),S.i.length=0),S.l.oa()}}function Gb(S,F,B){var Z=B instanceof Ih?kc(B):new Ih(B);if(Z.g!="")F&&(Z.g=F+"."+Z.g),Ph(Z,Z.u);else{var Ee=o.location;Z=Ee.protocol,F=F?F+"."+Ee.hostname:Ee.hostname,Ee=+Ee.port;const Fe=new Ih(null);Z&&f0(Fe,Z),F&&(Fe.g=F),Ee&&Ph(Fe,Ee),B&&(Fe.h=B),Z=Fe}return B=S.G,F=S.wa,B&&F&&br(Z,B,F),br(Z,"VER",S.ka),Dh(S,Z),Z}function cP(S,F,B){if(F&&!S.L)throw Error("Can't create secondary domain capable XhrIo object.");return F=S.Aa&&!S.ma?new ti(new qd({ab:B})):new ti(S.ma),F.Fa(S.L),F}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function uP(){}t=uP.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function Lv(){}Lv.prototype.g=function(S,F){return new wo(S,F)};function wo(S,F){zn.call(this),this.g=new Pv(F),this.l=S,this.h=F&&F.messageUrlParams||null,S=F&&F.messageHeaders||null,F&&F.clientProtocolHeaderRequired&&(S?S["X-Client-Protocol"]="webchannel":S={"X-Client-Protocol":"webchannel"}),this.g.o=S,S=F&&F.initMessageHeaders||null,F&&F.messageContentType&&(S?S["X-WebChannel-Content-Type"]=F.messageContentType:S={"X-WebChannel-Content-Type":F.messageContentType}),F&&F.sa&&(S?S["X-WebChannel-Client-Profile"]=F.sa:S={"X-WebChannel-Client-Profile":F.sa}),this.g.U=S,(S=F&&F.Qb)&&!G(S)&&(this.g.u=S),this.A=F&&F.supportsCrossDomainXhr||!1,this.v=F&&F.sendRawJson||!1,(F=F&&F.httpSessionIdParam)&&!G(F)&&(this.g.G=F,S=this.h,S!==null&&F in S&&(S=this.h,F in S&&delete S[F])),this.j=new jp(this)}h(wo,zn),wo.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},wo.prototype.close=function(){Cv(this.g)},wo.prototype.o=function(S){var F=this.g;if(typeof S=="string"){var B={};B.__data__=S,S=B}else this.v&&(B={},B.__data__=dr(S),S=B);F.i.push(new En(F.Ya++,S)),F.I==3&&Xd(F)},wo.prototype.N=function(){this.g.l=null,delete this.j,Cv(this.g),delete this.g,wo.Z.N.call(this)};function hP(S){Ds.call(this),S.__headers__&&(this.headers=S.__headers__,this.statusCode=S.__status__,delete S.__headers__,delete S.__status__);var F=S.__sm__;if(F){e:{for(const B in F){S=B;break e}S=void 0}(this.i=S)&&(S=this.i,F=F!==null&&S in F?F[S]:void 0),this.data=F}else this.data=S}h(hP,Ds);function dP(){Nn.call(this),this.status=1}h(dP,Nn);function jp(S){this.g=S}h(jp,uP),jp.prototype.ra=function(){Wn(this.g,"a")},jp.prototype.qa=function(S){Wn(this.g,new hP(S))},jp.prototype.pa=function(S){Wn(this.g,new dP)},jp.prototype.oa=function(){Wn(this.g,"b")},Lv.prototype.createWebChannel=Lv.prototype.g,wo.prototype.send=wo.prototype.o,wo.prototype.open=wo.prototype.m,wo.prototype.close=wo.prototype.close,Rue=function(){return new Lv},Cue=function(){return ke()},Pue=Ii,p8={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},nt.NO_ERROR=0,nt.TIMEOUT=8,nt.HTTP_ERROR=6,nM=nt,et.COMPLETE="complete",Iue=et,$o.EventType=Gi,Gi.OPEN="a",Gi.CLOSE="b",Gi.ERROR="c",Gi.MESSAGE="d",zn.prototype.listen=zn.prototype.J,sS=$o,ti.prototype.listenOnce=ti.prototype.K,ti.prototype.getLastError=ti.prototype.Ha,ti.prototype.getLastErrorCode=ti.prototype.ya,ti.prototype.getStatus=ti.prototype.ca,ti.prototype.getResponseJson=ti.prototype.La,ti.prototype.getResponseText=ti.prototype.la,ti.prototype.send=ti.prototype.ea,ti.prototype.setWithCredentials=ti.prototype.Fa,Aue=ti}).apply(typeof bC<"u"?bC:typeof self<"u"?self:typeof window<"u"?window:{});const iJ="@firebase/firestore",sJ="4.9.3";let Mo=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Mo.UNAUTHENTICATED=new Mo(null),Mo.GOOGLE_CREDENTIALS=new Mo("google-credentials-uid"),Mo.FIRST_PARTY=new Mo("first-party-uid"),Mo.MOCK_USER=new Mo("mock-user");let Q2="12.7.0";const P1=new JG("@firebase/firestore");function z_(){return P1.logLevel}function ft(t,...e){if(P1.logLevel<=tr.DEBUG){const n=e.map(uU);P1.debug(`Firestore (${Q2}): ${t}`,...n)}}function Oa(t,...e){if(P1.logLevel<=tr.ERROR){const n=e.map(uU);P1.error(`Firestore (${Q2}): ${t}`,...n)}}function C1(t,...e){if(P1.logLevel<=tr.WARN){const n=e.map(uU);P1.warn(`Firestore (${Q2}): ${t}`,...n)}}function uU(t){if(typeof t=="string")return t;try{return(function(n){return JSON.stringify(n)})(t)}catch{return t}}function Ht(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,Mue(t,r,n)}function Mue(t,e,n){let r=`FIRESTORE (${Q2}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw Oa(r),new Error(r)}function rn(t,e,n,r){let i="Unexpected state";typeof n=="string"?i=n:r=n,t||Mue(e,i,r)}function Mn(t,e){return t}const We={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Tt extends Ud{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class wd{constructor(){this.promise=new Promise(((e,n)=>{this.resolve=e,this.reject=n}))}}class Nue{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class PNe{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable((()=>n(Mo.UNAUTHENTICATED)))}shutdown(){}}class CNe{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable((()=>n(this.token.user)))}shutdown(){this.changeListener=null}}class RNe{constructor(e){this.t=e,this.currentUser=Mo.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){rn(this.o===void 0,42304);let r=this.i;const i=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let s=new wd;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new wd,e.enqueueRetryable((()=>i(this.currentUser)))};const o=()=>{const l=s;e.enqueueRetryable((async()=>{await l.promise,await i(this.currentUser)}))},a=l=>{ft("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((l=>a(l))),setTimeout((()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(ft("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new wd)}}),0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((r=>this.i!==e?(ft("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(rn(typeof r.accessToken=="string",31837,{l:r}),new Nue(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return rn(e===null||typeof e=="string",2055,{h:e}),new Mo(e)}}class MNe{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=Mo.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class NNe{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new MNe(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable((()=>n(Mo.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class oJ{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class ONe{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,lc(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){rn(this.o===void 0,3512);const r=s=>{s.error!=null&&ft("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,ft("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable((()=>r(s)))};const i=s=>{ft("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((s=>i(s))),setTimeout((()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):ft("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new oJ(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((n=>n?(rn(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new oJ(n.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function LNe(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}class hU{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=LNe(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%62))}return r}}function Rn(t,e){return t<e?-1:t>e?1:0}function m8(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const i=t.charAt(r),s=e.charAt(r);if(i!==s)return aj(i)===aj(s)?Rn(i,s):aj(i)?1:-1}return Rn(t.length,e.length)}const DNe=55296,jNe=57343;function aj(t){const e=t.charCodeAt(0);return e>=DNe&&e<=jNe}function t2(t,e,n){return t.length===e.length&&t.every(((r,i)=>n(r,e[i])))}function Oue(t){return t+"\0"}const aJ="__name__";class sd{constructor(e,n,r){n===void 0?n=0:n>e.length&&Ht(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&Ht(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return sd.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof sd?e.forEach((r=>{n.push(r)})):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=sd.compareSegments(e.get(i),n.get(i));if(s!==0)return s}return Rn(e.length,n.length)}static compareSegments(e,n){const r=sd.isNumericId(e),i=sd.isNumericId(n);return r&&!i?-1:!r&&i?1:r&&i?sd.extractNumericId(e).compare(sd.extractNumericId(n)):m8(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return vg.fromString(e.substring(4,e.length-2))}}class Ir extends sd{construct(e,n,r){return new Ir(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new Tt(We.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter((i=>i.length>0)))}return new Ir(n)}static emptyPath(){return new Ir([])}}const $Ne=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ji extends sd{construct(e,n,r){return new ji(e,n,r)}static isValidIdentifier(e){return $Ne.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ji.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===aJ}static keyField(){return new ji([aJ])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new Tt(We.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new Tt(We.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new Tt(We.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new Tt(We.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ji(n)}static emptyPath(){return new ji([])}}class At{constructor(e){this.path=e}static fromPath(e){return new At(Ir.fromString(e))}static fromName(e){return new At(Ir.fromString(e).popFirst(5))}static empty(){return new At(Ir.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ir.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Ir.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new At(new Ir(e.slice()))}}function Lue(t,e,n){if(!n)throw new Tt(We.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function FNe(t,e,n,r){if(e===!0&&r===!0)throw new Tt(We.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function lJ(t){if(!At.isDocumentKey(t))throw new Tt(We.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function cJ(t){if(At.isDocumentKey(t))throw new Tt(We.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Due(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function W5(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Ht(12329,{type:typeof t})}function gu(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Tt(We.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=W5(t);throw new Tt(We.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function Cs(t,e){const n={typeString:t};return e&&(n.value=e),n}function eI(t,e){if(!Due(t))throw new Tt(We.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(i&&typeof o!==i){n=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&o!==s.value){n=`Expected '${r}' field to equal '${s.value}'`;break}}if(n)throw new Tt(We.INVALID_ARGUMENT,n);return!0}const uJ=-62135596800,hJ=1e6;class Ur{static now(){return Ur.fromMillis(Date.now())}static fromDate(e){return Ur.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*hJ);return new Ur(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new Tt(We.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new Tt(We.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<uJ)throw new Tt(We.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Tt(We.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/hJ}_compareTo(e){return this.seconds===e.seconds?Rn(this.nanoseconds,e.nanoseconds):Rn(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Ur._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(eI(e,Ur._jsonSchema))return new Ur(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-uJ;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Ur._jsonSchemaVersion="firestore/timestamp/1.0",Ur._jsonSchema={type:Cs("string",Ur._jsonSchemaVersion),seconds:Cs("number"),nanoseconds:Cs("number")};class an{static fromTimestamp(e){return new an(e)}static min(){return new an(new Ur(0,0))}static max(){return new an(new Ur(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const kk=-1;class u4{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}}function g8(t){return t.fields.find((e=>e.kind===2))}function X0(t){return t.fields.filter((e=>e.kind!==2))}u4.UNKNOWN_ID=-1;class rM{constructor(e,n){this.fieldPath=e,this.kind=n}}class Ak{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new Ak(0,_c.min())}}function VNe(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=an.fromTimestamp(r===1e9?new Ur(n+1,0):new Ur(n,r));return new _c(i,At.empty(),e)}function jue(t){return new _c(t.readTime,t.key,kk)}class _c{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new _c(an.min(),At.empty(),kk)}static max(){return new _c(an.max(),At.empty(),kk)}}function dU(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=At.comparator(t.documentKey,e.documentKey),n!==0?n:Rn(t.largestBatchId,e.largestBatchId))}const $ue="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Fue{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function uv(t){if(t.code!==We.FAILED_PRECONDITION||t.message!==$ue)throw t;ft("LocalStore","Unexpectedly lost primary lease")}class xe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)}),(n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)}))}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Ht(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new xe(((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}}))}toPromise(){return new Promise(((e,n)=>{this.next(e,n)}))}wrapUserFunction(e){try{const n=e();return n instanceof xe?n:xe.resolve(n)}catch(n){return xe.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction((()=>e(n))):xe.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction((()=>e(n))):xe.reject(n)}static resolve(e){return new xe(((n,r)=>{n(e)}))}static reject(e){return new xe(((n,r)=>{r(e)}))}static waitFor(e){return new xe(((n,r)=>{let i=0,s=0,o=!1;e.forEach((a=>{++i,a.next((()=>{++s,o&&s===i&&n()}),(l=>r(l)))})),o=!0,s===i&&n()}))}static or(e){let n=xe.resolve(!1);for(const r of e)n=n.next((i=>i?xe.resolve(i):r()));return n}static forEach(e,n){const r=[];return e.forEach(((i,s)=>{r.push(n.call(this,i,s))})),this.waitFor(r)}static mapArray(e,n){return new xe(((r,i)=>{const s=e.length,o=new Array(s);let a=0;for(let l=0;l<s;l++){const c=l;n(e[c]).next((u=>{o[c]=u,++a,a===s&&r(o)}),(u=>i(u)))}}))}static doWhile(e,n){return new xe(((r,i)=>{const s=()=>{e()===!0?n().next((()=>{s()}),i):r()};s()}))}}const tc="SimpleDb";class H5{static open(e,n,r,i){try{return new H5(n,e.transaction(i,r))}catch(s){throw new rT(n,s)}}constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.S=new wd,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{n.error?this.S.reject(new rT(e,n.error)):this.S.resolve()},this.transaction.onerror=r=>{const i=fU(r.target.error);this.S.reject(new rT(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(ft(tc,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new GNe(n)}}class _g{static delete(e){return ft(tc,"Removing database:",e),by(Mce().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!zce())return!1;if(_g.F())return!0;const e=Ks(),n=_g.M(e),r=0<n&&n<10,i=Vue(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,n){return e.store(n)}static M(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,n,r){this.name=e,this.version=n,this.N=r,this.B=null,_g.M(Ks())===12.2&&Oa("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(ft(tc,"Opening database:",this.name),this.db=await new Promise(((n,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const o=s.target.result;n(o)},i.onblocked=()=>{r(new rT(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const o=s.target.error;o.name==="VersionError"?r(new Tt(We.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new Tt(We.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new rT(e,o))},i.onupgradeneeded=s=>{ft(tc,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.N.k(o,i.transaction,s.oldVersion,this.version).next((()=>{ft(tc,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=n=>this.q(n)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,i){const s=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const a=H5.open(this.db,e,s?"readonly":"readwrite",r),l=i(a).next((c=>(a.C(),c))).catch((c=>(a.abort(c),xe.reject(c)))).toPromise();return l.catch((()=>{})),await a.D,l}catch(a){const l=a,c=l.name!=="FirebaseError"&&o<3;if(ft(tc,"Transaction failed with error:",l.message,"Retrying:",c),this.close(),!c)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function Vue(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class zNe{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return by(this.U.delete())}}class rT extends Tt{constructor(e,n){super(We.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function r0(t){return t.name==="IndexedDbTransactionError"}class GNe{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(ft(tc,"PUT",this.store.name,e,n),r=this.store.put(n,e)):(ft(tc,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),by(r)}add(e){return ft(tc,"ADD",this.store.name,e,e),by(this.store.add(e))}get(e){return by(this.store.get(e)).next((n=>(n===void 0&&(n=null),ft(tc,"GET",this.store.name,e,n),n)))}delete(e){return ft(tc,"DELETE",this.store.name,e),by(this.store.delete(e))}count(){return ft(tc,"COUNT",this.store.name),by(this.store.count())}J(e,n){const r=this.options(e,n),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const s=i.getAll(r.range);return new xe(((o,a)=>{s.onerror=l=>{a(l.target.error)},s.onsuccess=l=>{o(l.target.result)}}))}{const s=this.cursor(r),o=[];return this.H(s,((a,l)=>{o.push(l)})).next((()=>o))}}Y(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new xe(((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}}))}Z(e,n){ft(tc,"DELETE ALL",this.store.name);const r=this.options(e,n);r.X=!1;const i=this.cursor(r);return this.H(i,((s,o,a)=>a.delete()))}ee(e,n){let r;n?r=e:(r={},n=e);const i=this.cursor(r);return this.H(i,n)}te(e){const n=this.cursor({});return new xe(((r,i)=>{n.onerror=s=>{const o=fU(s.target.error);i(o)},n.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next((a=>{a?o.continue():r()})):r()}}))}H(e,n){const r=[];return new xe(((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void i();const l=new zNe(a),c=n(a.primaryKey,a.value,l);if(c instanceof xe){const u=c.catch((h=>(l.done(),xe.reject(h))));r.push(u)}l.isDone?i():l.G===null?a.continue():a.continue(l.G)}})).next((()=>xe.waitFor(r)))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function by(t){return new xe(((e,n)=>{t.onsuccess=r=>{const i=r.target.result;e(i)},t.onerror=r=>{const i=fU(r.target.error);n(i)}}))}let dJ=!1;function fU(t){const e=_g.M(Ks());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new Tt("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return dJ||(dJ=!0,setTimeout((()=>{throw r}),0)),r}}return t}const iT="IndexBackfiller";class UNe{constructor(e,n){this.asyncQueue=e,this.ne=n,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){ft(iT,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const n=await this.ne.ie();ft(iT,`Documents written: ${n}`)}catch(n){r0(n)?ft(iT,"Ignoring IndexedDB error during index backfill: ",n):await uv(n)}await this.re(6e4)}))}}class BNe{constructor(e,n){this.localStore=e,this.persistence=n}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(n=>this.se(n,e)))}se(e,n){const r=new Set;let i=n,s=!0;return xe.doWhile((()=>s===!0&&i>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((o=>{if(o!==null&&!r.has(o))return ft(iT,`Processing collection: ${o}`),this.oe(e,o,i).next((a=>{i-=a,r.add(o)}));s=!1})))).next((()=>n-i))}oe(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next((i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next((s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next((()=>this._e(i,s))).next((a=>(ft(iT,`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a)))).next((()=>o.size))}))))}_e(e,n){let r=e;return n.changes.forEach(((i,s)=>{const o=jue(s);dU(o,r)>0&&(r=o)})),new _c(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}class iu{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}iu.ce=-1;const Jy=-1;function q5(t){return t==null}function Ik(t){return t===0&&1/t==-1/0}function WNe(t){return typeof t=="number"&&Number.isInteger(t)&&!Ik(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}const h4="";function pa(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=fJ(e)),e=HNe(t.get(n),e);return fJ(e)}function HNe(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const s=t.charAt(i);switch(s){case"\0":n+="";break;case h4:n+="";break;default:n+=s}}return n}function fJ(t){return t+h4+""}function md(t){const e=t.length;if(rn(e>=2,64408,{path:t}),e===2)return rn(t.charAt(0)===h4&&t.charAt(1)==="",56145,{path:t}),Ir.emptyPath();const n=e-2,r=[];let i="";for(let s=0;s<e;){const o=t.indexOf(h4,s);switch((o<0||o>n)&&Ht(50515,{path:t}),t.charAt(o+1)){case"":const a=t.substring(s,o);let l;i.length===0?l=a:(i+=a,l=i,i=""),r.push(l);break;case"":i+=t.substring(s,o),i+="\0";break;case"":i+=t.substring(s,o+1);break;default:Ht(61167,{path:t})}s=o+2}return new Ir(r)}const Z0="remoteDocuments",tI="owner",f_="owner",Pk="mutationQueues",qNe="userId",Zu="mutations",pJ="batchId",Dy="userMutationsIndex",mJ=["userId","batchId"];function iM(t,e){return[t,pa(e)]}function zue(t,e,n){return[t,pa(e),n]}const KNe={},n2="documentMutations",d4="remoteDocumentsV14",YNe=["prefixPath","collectionGroup","readTime","documentId"],sM="documentKeyIndex",XNe=["prefixPath","collectionGroup","documentId"],Gue="collectionGroupIndex",ZNe=["collectionGroup","readTime","prefixPath","documentId"],Ck="remoteDocumentGlobal",y8="remoteDocumentGlobalKey",r2="targets",Uue="queryTargetsIndex",JNe=["canonicalId","targetId"],i2="targetDocuments",QNe=["targetId","path"],pU="documentTargetsIndex",e5e=["path","targetId"],f4="targetGlobalKey",Qy="targetGlobal",Rk="collectionParents",t5e=["collectionId","parent"],s2="clientMetadata",n5e="clientId",K5="bundles",r5e="bundleId",Y5="namedQueries",i5e="name",mU="indexConfiguration",s5e="indexId",v8="collectionGroupIndex",o5e="collectionGroup",sT="indexState",a5e=["indexId","uid"],Bue="sequenceNumberIndex",l5e=["uid","sequenceNumber"],oT="indexEntries",c5e=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Wue="documentKeyIndex",u5e=["indexId","uid","orderedDocumentKey"],X5="documentOverlays",h5e=["userId","collectionPath","documentId"],_8="collectionPathOverlayIndex",d5e=["userId","collectionPath","largestBatchId"],Hue="collectionGroupOverlayIndex",f5e=["userId","collectionGroup","largestBatchId"],gU="globals",p5e="name",que=[Pk,Zu,n2,Z0,r2,tI,Qy,i2,s2,Ck,Rk,K5,Y5],m5e=[...que,X5],Kue=[Pk,Zu,n2,d4,r2,tI,Qy,i2,s2,Ck,Rk,K5,Y5,X5],Yue=Kue,yU=[...Yue,mU,sT,oT],g5e=yU,Xue=[...yU,gU],y5e=Xue;class x8 extends Fue{constructor(e,n){super(),this.le=e,this.currentSequenceNumber=n}}function Xs(t,e){const n=Mn(t);return _g.O(n.le,e)}function gJ(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function i0(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Zue(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class ki{constructor(e,n){this.comparator=e,this.root=n||No.EMPTY}insert(e,n){return new ki(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,No.BLACK,null,null))}remove(e){return new ki(this.comparator,this.root.remove(e,this.comparator).copy(null,null,No.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((n,r)=>(e(n,r),!1)))}toString(){const e=[];return this.inorderTraversal(((n,r)=>(e.push(`${n}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new EC(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new EC(this.root,e,this.comparator,!1)}getReverseIterator(){return new EC(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new EC(this.root,e,this.comparator,!0)}}class EC{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class No{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??No.RED,this.left=i??No.EMPTY,this.right=s??No.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new No(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return No.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return No.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,No.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,No.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ht(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ht(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ht(27949);return e+(this.isRed()?0:1)}}No.EMPTY=null,No.RED=!0,No.BLACK=!1;No.EMPTY=new class{constructor(){this.size=0}get key(){throw Ht(57766)}get value(){throw Ht(16141)}get color(){throw Ht(16727)}get left(){throw Ht(29726)}get right(){throw Ht(36894)}copy(e,n,r,i,s){return this}insert(e,n,r){return new No(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Hr{constructor(e){this.comparator=e,this.data=new ki(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((n,r)=>(e(n),!1)))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new yJ(this.data.getIterator())}getIteratorFrom(e){return new yJ(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach((r=>{n=n.add(r)})),n}isEqual(e){if(!(e instanceof Hr)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((n=>{e.push(n)})),e}toString(){const e=[];return this.forEach((n=>e.push(n))),"SortedSet("+e.toString()+")"}copy(e){const n=new Hr(this.comparator);return n.data=e,n}}class yJ{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function p_(t){return t.hasNext()?t.getNext():void 0}class _l{constructor(e){this.fields=e,e.sort(ji.comparator)}static empty(){return new _l([])}unionWith(e){let n=new Hr(ji.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new _l(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return t2(this.fields,e.fields,((n,r)=>n.isEqual(r)))}}class Jue extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Ns{constructor(e){this.binaryString=e}static fromBase64String(e){const n=(function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Jue("Invalid base64 string: "+s):s}})(e);return new Ns(n)}static fromUint8Array(e){const n=(function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s})(e);return new Ns(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(n){return btoa(n)})(this.binaryString)}toUint8Array(){return(function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Rn(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ns.EMPTY_BYTE_STRING=new Ns("");const v5e=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function pp(t){if(rn(!!t,39018),typeof t=="string"){let e=0;const n=v5e.exec(t);if(rn(!!n,46558,{timestamp:t}),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:bi(t.seconds),nanos:bi(t.nanos)}}function bi(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function mp(t){return typeof t=="string"?Ns.fromBase64String(t):Ns.fromUint8Array(t)}const Que="server_timestamp",ehe="__type__",the="__previous_value__",nhe="__local_write_time__";function vU(t){return(t?.mapValue?.fields||{})[ehe]?.stringValue===Que}function Z5(t){const e=t.mapValue.fields[the];return vU(e)?Z5(e):e}function Mk(t){const e=pp(t.mapValue.fields[nhe].timestampValue);return new Ur(e.seconds,e.nanos)}class _5e{constructor(e,n,r,i,s,o,a,l,c,u){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c,this.isUsingEmulator=u}}const p4="(default)";class R1{constructor(e,n){this.projectId=e,this.database=n||p4}static empty(){return new R1("","")}get isDefaultDatabase(){return this.database===p4}isEqual(e){return e instanceof R1&&e.projectId===this.projectId&&e.database===this.database}}const _U="__type__",rhe="__max__",Qm={mapValue:{fields:{__type__:{stringValue:rhe}}}},xU="__vector__",o2="value",oM={nullValue:"NULL_VALUE"};function Ng(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?vU(t)?4:ihe(t)?9007199254740991:J5(t)?10:11:Ht(28295,{value:t})}function Md(t,e){if(t===e)return!0;const n=Ng(t);if(n!==Ng(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Mk(t).isEqual(Mk(e));case 3:return(function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=pp(i.timestampValue),a=pp(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos})(t,e);case 5:return t.stringValue===e.stringValue;case 6:return(function(i,s){return mp(i.bytesValue).isEqual(mp(s.bytesValue))})(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return(function(i,s){return bi(i.geoPointValue.latitude)===bi(s.geoPointValue.latitude)&&bi(i.geoPointValue.longitude)===bi(s.geoPointValue.longitude)})(t,e);case 2:return(function(i,s){if("integerValue"in i&&"integerValue"in s)return bi(i.integerValue)===bi(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=bi(i.doubleValue),a=bi(s.doubleValue);return o===a?Ik(o)===Ik(a):isNaN(o)&&isNaN(a)}return!1})(t,e);case 9:return t2(t.arrayValue.values||[],e.arrayValue.values||[],Md);case 10:case 11:return(function(i,s){const o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(gJ(o)!==gJ(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!Md(o[l],a[l])))return!1;return!0})(t,e);default:return Ht(52216,{left:t})}}function Nk(t,e){return(t.values||[]).find((n=>Md(n,e)))!==void 0}function Og(t,e){if(t===e)return 0;const n=Ng(t),r=Ng(e);if(n!==r)return Rn(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Rn(t.booleanValue,e.booleanValue);case 2:return(function(s,o){const a=bi(s.integerValue||s.doubleValue),l=bi(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1})(t,e);case 3:return vJ(t.timestampValue,e.timestampValue);case 4:return vJ(Mk(t),Mk(e));case 5:return m8(t.stringValue,e.stringValue);case 6:return(function(s,o){const a=mp(s),l=mp(o);return a.compareTo(l)})(t.bytesValue,e.bytesValue);case 7:return(function(s,o){const a=s.split("/"),l=o.split("/");for(let c=0;c<a.length&&c<l.length;c++){const u=Rn(a[c],l[c]);if(u!==0)return u}return Rn(a.length,l.length)})(t.referenceValue,e.referenceValue);case 8:return(function(s,o){const a=Rn(bi(s.latitude),bi(o.latitude));return a!==0?a:Rn(bi(s.longitude),bi(o.longitude))})(t.geoPointValue,e.geoPointValue);case 9:return _J(t.arrayValue,e.arrayValue);case 10:return(function(s,o){const a=s.fields||{},l=o.fields||{},c=a[o2]?.arrayValue,u=l[o2]?.arrayValue,h=Rn(c?.values?.length||0,u?.values?.length||0);return h!==0?h:_J(c,u)})(t.mapValue,e.mapValue);case 11:return(function(s,o){if(s===Qm.mapValue&&o===Qm.mapValue)return 0;if(s===Qm.mapValue)return 1;if(o===Qm.mapValue)return-1;const a=s.fields||{},l=Object.keys(a),c=o.fields||{},u=Object.keys(c);l.sort(),u.sort();for(let h=0;h<l.length&&h<u.length;++h){const f=m8(l[h],u[h]);if(f!==0)return f;const g=Og(a[l[h]],c[u[h]]);if(g!==0)return g}return Rn(l.length,u.length)})(t.mapValue,e.mapValue);default:throw Ht(23264,{he:n})}}function vJ(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Rn(t,e);const n=pp(t),r=pp(e),i=Rn(n.seconds,r.seconds);return i!==0?i:Rn(n.nanos,r.nanos)}function _J(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const s=Og(n[i],r[i]);if(s)return s}return Rn(n.length,r.length)}function a2(t){return w8(t)}function w8(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?(function(n){const r=pp(n);return`time(${r.seconds},${r.nanos})`})(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?(function(n){return mp(n).toBase64()})(t.bytesValue):"referenceValue"in t?(function(n){return At.fromName(n).toString()})(t.referenceValue):"geoPointValue"in t?(function(n){return`geo(${n.latitude},${n.longitude})`})(t.geoPointValue):"arrayValue"in t?(function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=w8(s);return r+"]"})(t.arrayValue):"mapValue"in t?(function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${w8(n.fields[o])}`;return i+"}"})(t.mapValue):Ht(61005,{value:t})}function aM(t){switch(Ng(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Z5(t);return e?16+aM(e):16;case 5:return 2*t.stringValue.length;case 6:return mp(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((i,s)=>i+aM(s)),0)})(t.arrayValue);case 10:case 11:return(function(r){let i=0;return i0(r.fields,((s,o)=>{i+=s.length+aM(o)})),i})(t.mapValue);default:throw Ht(13486,{value:t})}}function Ok(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function b8(t){return!!t&&"integerValue"in t}function Lk(t){return!!t&&"arrayValue"in t}function xJ(t){return!!t&&"nullValue"in t}function wJ(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function lM(t){return!!t&&"mapValue"in t}function J5(t){return(t?.mapValue?.fields||{})[_U]?.stringValue===xU}function aT(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return i0(t.mapValue.fields,((n,r)=>e.mapValue.fields[n]=aT(r))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=aT(t.arrayValue.values[n]);return e}return{...t}}function ihe(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===rhe}const she={mapValue:{fields:{[_U]:{stringValue:xU},[o2]:{arrayValue:{}}}}};function x5e(t){return"nullValue"in t?oM:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?Ok(R1.empty(),At.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?J5(t)?she:{mapValue:{}}:Ht(35942,{value:t})}function w5e(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?Ok(R1.empty(),At.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?she:"mapValue"in t?J5(t)?{mapValue:{}}:Qm:Ht(61959,{value:t})}function bJ(t,e){const n=Og(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function EJ(t,e){const n=Og(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}class aa{constructor(e){this.value=e}static empty(){return new aa({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!lM(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=aT(n)}setAll(e){let n=ji.emptyPath(),r={},i=[];e.forEach(((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=aT(o):i.push(a.lastSegment())}));const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());lM(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Md(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];lM(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){i0(n,((i,s)=>e[i]=s));for(const i of r)delete e[i]}clone(){return new aa(aT(this.value))}}function ohe(t){const e=[];return i0(t.fields,((n,r)=>{const i=new ji([n]);if(lM(r)){const s=ohe(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)})),new _l(e)}class Qi{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Qi(e,0,an.min(),an.min(),an.min(),aa.empty(),0)}static newFoundDocument(e,n,r,i){return new Qi(e,1,n,an.min(),r,i,0)}static newNoDocument(e,n){return new Qi(e,2,n,an.min(),an.min(),aa.empty(),0)}static newUnknownDocument(e,n){return new Qi(e,3,n,an.min(),an.min(),aa.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(an.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=aa.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=aa.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=an.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Qi&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Qi(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class l2{constructor(e,n){this.position=e,this.inclusive=n}}function SJ(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(s.field.isKeyField()?r=At.comparator(At.fromName(o.referenceValue),n.key):r=Og(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function TJ(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Md(t.position[n],e.position[n]))return!1;return!0}class m4{constructor(e,n="asc"){this.field=e,this.dir=n}}function b5e(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class ahe{}class rr extends ahe{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new E5e(e,n,r):n==="array-contains"?new k5e(e,r):n==="in"?new fhe(e,r):n==="not-in"?new A5e(e,r):n==="array-contains-any"?new I5e(e,r):new rr(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new S5e(e,r):new T5e(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Og(n,this.value)):n!==null&&Ng(this.value)===Ng(n)&&this.matchesComparison(Og(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ht(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Br extends ahe{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new Br(e,n)}matches(e){return c2(this)?this.filters.find((n=>!n.matches(e)))===void 0:this.filters.find((n=>n.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,n)=>e.concat(n.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function c2(t){return t.op==="and"}function E8(t){return t.op==="or"}function wU(t){return lhe(t)&&c2(t)}function lhe(t){for(const e of t.filters)if(e instanceof Br)return!1;return!0}function S8(t){if(t instanceof rr)return t.field.canonicalString()+t.op.toString()+a2(t.value);if(wU(t))return t.filters.map((e=>S8(e))).join(",");{const e=t.filters.map((n=>S8(n))).join(",");return`${t.op}(${e})`}}function che(t,e){return t instanceof rr?(function(r,i){return i instanceof rr&&r.op===i.op&&r.field.isEqual(i.field)&&Md(r.value,i.value)})(t,e):t instanceof Br?(function(r,i){return i instanceof Br&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce(((s,o,a)=>s&&che(o,i.filters[a])),!0):!1})(t,e):void Ht(19439)}function uhe(t,e){const n=t.filters.concat(e);return Br.create(n,t.op)}function hhe(t){return t instanceof rr?(function(n){return`${n.field.canonicalString()} ${n.op} ${a2(n.value)}`})(t):t instanceof Br?(function(n){return n.op.toString()+" {"+n.getFilters().map(hhe).join(" ,")+"}"})(t):"Filter"}class E5e extends rr{constructor(e,n,r){super(e,n,r),this.key=At.fromName(r.referenceValue)}matches(e){const n=At.comparator(e.key,this.key);return this.matchesComparison(n)}}class S5e extends rr{constructor(e,n){super(e,"in",n),this.keys=dhe("in",n)}matches(e){return this.keys.some((n=>n.isEqual(e.key)))}}class T5e extends rr{constructor(e,n){super(e,"not-in",n),this.keys=dhe("not-in",n)}matches(e){return!this.keys.some((n=>n.isEqual(e.key)))}}function dhe(t,e){return(e.arrayValue?.values||[]).map((n=>At.fromName(n.referenceValue)))}class k5e extends rr{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Lk(n)&&Nk(n.arrayValue,this.value)}}class fhe extends rr{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Nk(this.value.arrayValue,n)}}class A5e extends rr{constructor(e,n){super(e,"not-in",n)}matches(e){if(Nk(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Nk(this.value.arrayValue,n)}}class I5e extends rr{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Lk(n)||!n.arrayValue.values)&&n.arrayValue.values.some((r=>Nk(this.value.arrayValue,r)))}}class P5e{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.Te=null}}function T8(t,e=null,n=[],r=[],i=null,s=null,o=null){return new P5e(t,e,n,r,i,s,o)}function M1(t){const e=Mn(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((r=>S8(r))).join(","),n+="|ob:",n+=e.orderBy.map((r=>(function(s){return s.field.canonicalString()+s.dir})(r))).join(","),q5(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map((r=>a2(r))).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map((r=>a2(r))).join(",")),e.Te=n}return e.Te}function nI(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!b5e(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!che(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!TJ(t.startAt,e.startAt)&&TJ(t.endAt,e.endAt)}function g4(t){return At.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function y4(t,e){return t.filters.filter((n=>n instanceof rr&&n.field.isEqual(e)))}function kJ(t,e,n){let r=oM,i=!0;for(const s of y4(t,e)){let o=oM,a=!0;switch(s.op){case"<":case"<=":o=x5e(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=oM}bJ({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];bJ({value:r,inclusive:i},{value:o,inclusive:n.inclusive})<0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}function AJ(t,e,n){let r=Qm,i=!0;for(const s of y4(t,e)){let o=Qm,a=!0;switch(s.op){case">=":case">":o=w5e(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=Qm}EJ({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];EJ({value:r,inclusive:i},{value:o,inclusive:n.inclusive})>0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}class rI{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function C5e(t,e,n,r,i,s,o,a){return new rI(t,e,n,r,i,s,o,a)}function Q5(t){return new rI(t)}function IJ(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function phe(t){return t.collectionGroup!==null}function lT(t){const e=Mn(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Hr(ji.comparator);return o.filters.forEach((l=>{l.getFlattenedFilters().forEach((c=>{c.isInequality()&&(a=a.add(c.field))}))})),a})(e).forEach((s=>{n.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new m4(s,r))})),n.has(ji.keyField().canonicalString())||e.Ie.push(new m4(ji.keyField(),r))}return e.Ie}function uu(t){const e=Mn(t);return e.Ee||(e.Ee=R5e(e,lT(t))),e.Ee}function R5e(t,e){if(t.limitType==="F")return T8(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map((i=>{const s=i.dir==="desc"?"asc":"desc";return new m4(i.field,s)}));const n=t.endAt?new l2(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new l2(t.startAt.position,t.startAt.inclusive):null;return T8(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function k8(t,e){const n=t.filters.concat([e]);return new rI(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function A8(t,e,n){return new rI(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function eO(t,e){return nI(uu(t),uu(e))&&t.limitType===e.limitType}function mhe(t){return`${M1(uu(t))}|lt:${t.limitType}`}function G_(t){return`Query(target=${(function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map((i=>hhe(i))).join(", ")}]`),q5(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map((i=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(i))).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map((i=>a2(i))).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map((i=>a2(i))).join(",")),`Target(${r})`})(uu(t))}; limitType=${t.limitType})`}function iI(t,e){return e.isFoundDocument()&&(function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):At.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)})(t,e)&&(function(r,i){for(const s of lT(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0})(t,e)&&(function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0})(t,e)&&(function(r,i){return!(r.startAt&&!(function(o,a,l){const c=SJ(o,a,l);return o.inclusive?c<=0:c<0})(r.startAt,lT(r),i)||r.endAt&&!(function(o,a,l){const c=SJ(o,a,l);return o.inclusive?c>=0:c>0})(r.endAt,lT(r),i))})(t,e)}function M5e(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function ghe(t){return(e,n)=>{let r=!1;for(const i of lT(t)){const s=N5e(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function N5e(t,e,n){const r=t.field.isKeyField()?At.comparator(e.key,n.key):(function(s,o,a){const l=o.data.field(s),c=a.data.field(s);return l!==null&&c!==null?Og(l,c):Ht(42886)})(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Ht(19790,{direction:t.dir})}}class Sp{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){i0(this.inner,((n,r)=>{for(const[i,s]of r)e(i,s)}))}isEmpty(){return Zue(this.inner)}size(){return this.innerSize}}const O5e=new ki(At.comparator);function uc(){return O5e}const yhe=new ki(At.comparator);function oS(...t){let e=yhe;for(const n of t)e=e.insert(n.key,n);return e}function vhe(t){let e=yhe;return t.forEach(((n,r)=>e=e.insert(n,r.overlayedDocument))),e}function gd(){return cT()}function _he(){return cT()}function cT(){return new Sp((t=>t.toString()),((t,e)=>t.isEqual(e)))}const L5e=new ki(At.comparator),D5e=new Hr(At.comparator);function Hn(...t){let e=D5e;for(const n of t)e=e.add(n);return e}const j5e=new Hr(Rn);function $5e(){return j5e}function bU(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ik(e)?"-0":e}}function xhe(t){return{integerValue:""+t}}function F5e(t,e){return WNe(e)?xhe(e):bU(t,e)}class tO{constructor(){this._=void 0}}function V5e(t,e,n){return t instanceof u2?(function(i,s){const o={fields:{[ehe]:{stringValue:Que},[nhe]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&vU(s)&&(s=Z5(s)),s&&(o.fields[the]=s),{mapValue:o}})(n,e):t instanceof h2?bhe(t,e):t instanceof d2?Ehe(t,e):(function(i,s){const o=whe(i,s),a=PJ(o)+PJ(i.Ae);return b8(o)&&b8(i.Ae)?xhe(a):bU(i.serializer,a)})(t,e)}function z5e(t,e,n){return t instanceof h2?bhe(t,e):t instanceof d2?Ehe(t,e):n}function whe(t,e){return t instanceof Dk?(function(r){return b8(r)||(function(s){return!!s&&"doubleValue"in s})(r)})(e)?e:{integerValue:0}:null}class u2 extends tO{}class h2 extends tO{constructor(e){super(),this.elements=e}}function bhe(t,e){const n=She(e);for(const r of t.elements)n.some((i=>Md(i,r)))||n.push(r);return{arrayValue:{values:n}}}class d2 extends tO{constructor(e){super(),this.elements=e}}function Ehe(t,e){let n=She(e);for(const r of t.elements)n=n.filter((i=>!Md(i,r)));return{arrayValue:{values:n}}}class Dk extends tO{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function PJ(t){return bi(t.integerValue||t.doubleValue)}function She(t){return Lk(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class The{constructor(e,n){this.field=e,this.transform=n}}function G5e(t,e){return t.field.isEqual(e.field)&&(function(r,i){return r instanceof h2&&i instanceof h2||r instanceof d2&&i instanceof d2?t2(r.elements,i.elements,Md):r instanceof Dk&&i instanceof Dk?Md(r.Ae,i.Ae):r instanceof u2&&i instanceof u2})(t.transform,e.transform)}class U5e{constructor(e,n){this.version=e,this.transformResults=n}}class ua{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new ua}static exists(e){return new ua(void 0,e)}static updateTime(e){return new ua(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function cM(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class nO{}function khe(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new rO(t.key,ua.none()):new eb(t.key,t.data,ua.none());{const n=t.data,r=aa.empty();let i=new Hr(ji.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new Tp(t.key,r,new _l(i.toArray()),ua.none())}}function B5e(t,e,n){t instanceof eb?(function(i,s,o){const a=i.value.clone(),l=RJ(i.fieldTransforms,s,o.transformResults);a.setAll(l),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()})(t,e,n):t instanceof Tp?(function(i,s,o){if(!cM(i.precondition,s))return void s.convertToUnknownDocument(o.version);const a=RJ(i.fieldTransforms,s,o.transformResults),l=s.data;l.setAll(Ahe(i)),l.setAll(a),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()})(t,e,n):(function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,n)}function uT(t,e,n,r){return t instanceof eb?(function(s,o,a,l){if(!cM(s.precondition,o))return a;const c=s.value.clone(),u=MJ(s.fieldTransforms,l,o);return c.setAll(u),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null})(t,e,n,r):t instanceof Tp?(function(s,o,a,l){if(!cM(s.precondition,o))return a;const c=MJ(s.fieldTransforms,l,o),u=o.data;return u.setAll(Ahe(s)),u.setAll(c),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map((h=>h.field)))})(t,e,n,r):(function(s,o,a){return cM(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a})(t,e,n)}function W5e(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=whe(r.transform,i||null);s!=null&&(n===null&&(n=aa.empty()),n.set(r.field,s))}return n||null}function CJ(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&t2(r,i,((s,o)=>G5e(s,o)))})(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class eb extends nO{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Tp extends nO{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function Ahe(t){const e=new Map;return t.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}})),e}function RJ(t,e,n){const r=new Map;rn(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,z5e(o,a,n[i]))}return r}function MJ(t,e,n){const r=new Map;for(const i of t){const s=i.transform,o=n.data.field(i.field);r.set(i.field,V5e(s,o,e))}return r}class rO extends nO{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Ihe extends nO{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class EU{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&B5e(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=uT(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=uT(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=_he();return this.mutations.forEach((i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;const l=khe(o,a);l!==null&&r.set(i.key,l),o.isValidDocument()||o.convertToNoDocument(an.min())})),r}keys(){return this.mutations.reduce(((e,n)=>e.add(n.key)),Hn())}isEqual(e){return this.batchId===e.batchId&&t2(this.mutations,e.mutations,((n,r)=>CJ(n,r)))&&t2(this.baseMutations,e.baseMutations,((n,r)=>CJ(n,r)))}}class SU{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){rn(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=(function(){return L5e})();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new SU(e,n,r,i)}}class TU{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class H5e{constructor(e,n){this.count=e,this.unchangedNames=n}}var xs,ar;function q5e(t){switch(t){case We.OK:return Ht(64938);case We.CANCELLED:case We.UNKNOWN:case We.DEADLINE_EXCEEDED:case We.RESOURCE_EXHAUSTED:case We.INTERNAL:case We.UNAVAILABLE:case We.UNAUTHENTICATED:return!1;case We.INVALID_ARGUMENT:case We.NOT_FOUND:case We.ALREADY_EXISTS:case We.PERMISSION_DENIED:case We.FAILED_PRECONDITION:case We.ABORTED:case We.OUT_OF_RANGE:case We.UNIMPLEMENTED:case We.DATA_LOSS:return!0;default:return Ht(15467,{code:t})}}function Phe(t){if(t===void 0)return Oa("GRPC error has no .code"),We.UNKNOWN;switch(t){case xs.OK:return We.OK;case xs.CANCELLED:return We.CANCELLED;case xs.UNKNOWN:return We.UNKNOWN;case xs.DEADLINE_EXCEEDED:return We.DEADLINE_EXCEEDED;case xs.RESOURCE_EXHAUSTED:return We.RESOURCE_EXHAUSTED;case xs.INTERNAL:return We.INTERNAL;case xs.UNAVAILABLE:return We.UNAVAILABLE;case xs.UNAUTHENTICATED:return We.UNAUTHENTICATED;case xs.INVALID_ARGUMENT:return We.INVALID_ARGUMENT;case xs.NOT_FOUND:return We.NOT_FOUND;case xs.ALREADY_EXISTS:return We.ALREADY_EXISTS;case xs.PERMISSION_DENIED:return We.PERMISSION_DENIED;case xs.FAILED_PRECONDITION:return We.FAILED_PRECONDITION;case xs.ABORTED:return We.ABORTED;case xs.OUT_OF_RANGE:return We.OUT_OF_RANGE;case xs.UNIMPLEMENTED:return We.UNIMPLEMENTED;case xs.DATA_LOSS:return We.DATA_LOSS;default:return Ht(39323,{code:t})}}(ar=xs||(xs={}))[ar.OK=0]="OK",ar[ar.CANCELLED=1]="CANCELLED",ar[ar.UNKNOWN=2]="UNKNOWN",ar[ar.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ar[ar.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ar[ar.NOT_FOUND=5]="NOT_FOUND",ar[ar.ALREADY_EXISTS=6]="ALREADY_EXISTS",ar[ar.PERMISSION_DENIED=7]="PERMISSION_DENIED",ar[ar.UNAUTHENTICATED=16]="UNAUTHENTICATED",ar[ar.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ar[ar.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ar[ar.ABORTED=10]="ABORTED",ar[ar.OUT_OF_RANGE=11]="OUT_OF_RANGE",ar[ar.UNIMPLEMENTED=12]="UNIMPLEMENTED",ar[ar.INTERNAL=13]="INTERNAL",ar[ar.UNAVAILABLE=14]="UNAVAILABLE",ar[ar.DATA_LOSS=15]="DATA_LOSS";function K5e(){return new TextEncoder}const Y5e=new vg([4294967295,4294967295],0);function NJ(t){const e=K5e().encode(t),n=new kue;return n.update(e),new Uint8Array(n.digest())}function OJ(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new vg([n,r],0),new vg([i,s],0)]}class kU{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new aS(`Invalid padding: ${n}`);if(r<0)throw new aS(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new aS(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new aS(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=vg.fromNumber(this.ge)}ye(e,n,r){let i=e.add(n.multiply(vg.fromNumber(r)));return i.compare(Y5e)===1&&(i=new vg([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=NJ(e),[r,i]=OJ(n);for(let s=0;s<this.hashCount;s++){const o=this.ye(r,i,s);if(!this.we(o))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new kU(s,i,n);return r.forEach((a=>o.insert(a))),o}insert(e){if(this.ge===0)return;const n=NJ(e),[r,i]=OJ(n);for(let s=0;s<this.hashCount;s++){const o=this.ye(r,i,s);this.Se(o)}}Se(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class aS extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class iO{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,sI.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new iO(an.min(),i,new ki(Rn),uc(),Hn())}}class sI{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new sI(r,n,Hn(),Hn(),Hn())}}class uM{constructor(e,n,r,i){this.be=e,this.removedTargetIds=n,this.key=r,this.De=i}}class Che{constructor(e,n){this.targetId=e,this.Ce=n}}class Rhe{constructor(e,n,r=Ns.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class LJ{constructor(){this.ve=0,this.Fe=DJ(),this.Me=Ns.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Hn(),n=Hn(),r=Hn();return this.Fe.forEach(((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:Ht(38017,{changeType:s})}})),new sI(this.Me,this.xe,e,n,r)}qe(){this.Oe=!1,this.Fe=DJ()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,rn(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class X5e{constructor(e){this.Ge=e,this.ze=new Map,this.je=uc(),this.Je=SC(),this.He=SC(),this.Ye=new ki(Rn)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,(n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:Ht(56790,{state:e.state})}}))}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach(((r,i)=>{this.rt(i)&&n(i)}))}st(e){const n=e.targetId,r=e.Ce.count,i=this.ot(n);if(i){const s=i.target;if(g4(s))if(r===0){const o=new At(s.path);this.et(n,o,Qi.newNoDocument(o,an.min()))}else rn(r===1,20013,{expectedCount:r});else{const o=this._t(n);if(o!==r){const a=this.ut(e),l=a?this.ct(a,e,o):1;if(l!==0){this.it(n);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,c)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let o,a;try{o=mp(r).toUint8Array()}catch(l){if(l instanceof Jue)return C1("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new kU(o,i,s)}catch(l){return C1(l instanceof aS?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.ge===0?null:a}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let i=0;return r.forEach((s=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.et(n,s,null),i++)})),i}Tt(e){const n=new Map;this.ze.forEach(((s,o)=>{const a=this.ot(o);if(a){if(s.current&&g4(a.target)){const l=new At(a.target.path);this.It(l).has(o)||this.Et(o,l)||this.et(o,l,Qi.newNoDocument(l,e))}s.Be&&(n.set(o,s.ke()),s.qe())}}));let r=Hn();this.He.forEach(((s,o)=>{let a=!0;o.forEachWhile((l=>{const c=this.ot(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)})),a&&(r=r.add(s))})),this.je.forEach(((s,o)=>o.setReadTime(e)));const i=new iO(e,n,this.Ye,this.je,r);return this.je=uc(),this.Je=SC(),this.He=SC(),this.Ye=new ki(Rn),i}Xe(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,r),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,n)?i.Qe(n,1):i.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new LJ,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new Hr(Rn),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new Hr(Rn),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||ft("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new LJ),this.Ge.getRemoteKeysForTarget(e).forEach((n=>{this.et(e,n,null)}))}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function SC(){return new ki(At.comparator)}function DJ(){return new ki(At.comparator)}const Z5e={asc:"ASCENDING",desc:"DESCENDING"},J5e={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Q5e={and:"AND",or:"OR"};class eOe{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function I8(t,e){return t.useProto3Json||q5(e)?e:{value:e}}function f2(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Mhe(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function tOe(t,e){return f2(t,e.toTimestamp())}function Va(t){return rn(!!t,49232),an.fromTimestamp((function(n){const r=pp(n);return new Ur(r.seconds,r.nanos)})(t))}function AU(t,e){return P8(t,e).canonicalString()}function P8(t,e){const n=(function(i){return new Ir(["projects",i.projectId,"databases",i.database])})(t).child("documents");return e===void 0?n:n.child(e)}function Nhe(t){const e=Ir.fromString(t);return rn(Ghe(e),10190,{key:e.toString()}),e}function v4(t,e){return AU(t.databaseId,e.path)}function e1(t,e){const n=Nhe(e);if(n.get(1)!==t.databaseId.projectId)throw new Tt(We.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Tt(We.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new At(Dhe(n))}function Ohe(t,e){return AU(t.databaseId,e)}function Lhe(t){const e=Nhe(t);return e.length===4?Ir.emptyPath():Dhe(e)}function C8(t){return new Ir(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Dhe(t){return rn(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function jJ(t,e,n){return{name:v4(t,e),fields:n.value.mapValue.fields}}function nOe(t,e,n){const r=e1(t,e.name),i=Va(e.updateTime),s=e.createTime?Va(e.createTime):an.min(),o=new aa({mapValue:{fields:e.fields}}),a=Qi.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function rOe(t,e){let n;if("targetChange"in e){e.targetChange;const r=(function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:Ht(39313,{state:c})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=(function(c,u){return c.useProto3Json?(rn(u===void 0||typeof u=="string",58123),Ns.fromBase64String(u||"")):(rn(u===void 0||u instanceof Buffer||u instanceof Uint8Array,16193),Ns.fromUint8Array(u||new Uint8Array))})(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&(function(c){const u=c.code===void 0?We.UNKNOWN:Phe(c.code);return new Tt(u,c.message||"")})(o);n=new Rhe(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=e1(t,r.document.name),s=Va(r.document.updateTime),o=r.document.createTime?Va(r.document.createTime):an.min(),a=new aa({mapValue:{fields:r.document.fields}}),l=Qi.newFoundDocument(i,s,o,a),c=r.targetIds||[],u=r.removedTargetIds||[];n=new uM(c,u,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=e1(t,r.document),s=r.readTime?Va(r.readTime):an.min(),o=Qi.newNoDocument(i,s),a=r.removedTargetIds||[];n=new uM([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=e1(t,r.document),s=r.removedTargetIds||[];n=new uM([],s,i,null)}else{if(!("filter"in e))return Ht(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new H5e(i,s),a=r.targetId;n=new Che(a,o)}}return n}function _4(t,e){let n;if(e instanceof eb)n={update:jJ(t,e.key,e.value)};else if(e instanceof rO)n={delete:v4(t,e.key)};else if(e instanceof Tp)n={update:jJ(t,e.key,e.data),updateMask:cOe(e.fieldMask)};else{if(!(e instanceof Ihe))return Ht(16599,{Vt:e.type});n={verify:v4(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((r=>(function(s,o){const a=o.transform;if(a instanceof u2)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof h2)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof d2)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Dk)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw Ht(20930,{transform:o.transform})})(0,r)))),e.precondition.isNone||(n.currentDocument=(function(i,s){return s.updateTime!==void 0?{updateTime:tOe(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Ht(27497)})(t,e.precondition)),n}function R8(t,e){const n=e.currentDocument?(function(s){return s.updateTime!==void 0?ua.updateTime(Va(s.updateTime)):s.exists!==void 0?ua.exists(s.exists):ua.none()})(e.currentDocument):ua.none(),r=e.updateTransforms?e.updateTransforms.map((i=>(function(o,a){let l=null;if("setToServerValue"in a)rn(a.setToServerValue==="REQUEST_TIME",16630,{proto:a}),l=new u2;else if("appendMissingElements"in a){const u=a.appendMissingElements.values||[];l=new h2(u)}else if("removeAllFromArray"in a){const u=a.removeAllFromArray.values||[];l=new d2(u)}else"increment"in a?l=new Dk(o,a.increment):Ht(16584,{proto:a});const c=ji.fromServerFormat(a.fieldPath);return new The(c,l)})(t,i))):[];if(e.update){e.update.name;const i=e1(t,e.update.name),s=new aa({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=(function(l){const c=l.fieldPaths||[];return new _l(c.map((u=>ji.fromServerFormat(u))))})(e.updateMask);return new Tp(i,s,o,n,r)}return new eb(i,s,n,r)}if(e.delete){const i=e1(t,e.delete);return new rO(i,n)}if(e.verify){const i=e1(t,e.verify);return new Ihe(i,n)}return Ht(1463,{proto:e})}function iOe(t,e){return t&&t.length>0?(rn(e!==void 0,14353),t.map((n=>(function(i,s){let o=i.updateTime?Va(i.updateTime):Va(s);return o.isEqual(an.min())&&(o=Va(s)),new U5e(o,i.transformResults||[])})(n,e)))):[]}function jhe(t,e){return{documents:[Ohe(t,e.path)]}}function $he(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=Ohe(t,i);const s=(function(c){if(c.length!==0)return zhe(Br.create(c,"and"))})(e.filters);s&&(n.structuredQuery.where=s);const o=(function(c){if(c.length!==0)return c.map((u=>(function(f){return{field:U_(f.field),direction:oOe(f.dir)}})(u)))})(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=I8(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=(function(c){return{before:c.inclusive,values:c.position}})(e.startAt)),e.endAt&&(n.structuredQuery.endAt=(function(c){return{before:!c.inclusive,values:c.position}})(e.endAt)),{ft:n,parent:i}}function Fhe(t){let e=Lhe(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){rn(r===1,65062);const u=n.from[0];u.allDescendants?i=u.collectionId:e=e.child(u.collectionId)}let s=[];n.where&&(s=(function(h){const f=Vhe(h);return f instanceof Br&&wU(f)?f.getFilters():[f]})(n.where));let o=[];n.orderBy&&(o=(function(h){return h.map((f=>(function(y){return new m4(B_(y.field),(function(b){switch(b){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(y.direction))})(f)))})(n.orderBy));let a=null;n.limit&&(a=(function(h){let f;return f=typeof h=="object"?h.value:h,q5(f)?null:f})(n.limit));let l=null;n.startAt&&(l=(function(h){const f=!!h.before,g=h.values||[];return new l2(g,f)})(n.startAt));let c=null;return n.endAt&&(c=(function(h){const f=!h.before,g=h.values||[];return new l2(g,f)})(n.endAt)),C5e(e,i,o,s,a,"F",l,c)}function sOe(t,e){const n=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ht(28987,{purpose:i})}})(e.purpose);return n==null?null:{"goog-listen-tags":n}}function Vhe(t){return t.unaryFilter!==void 0?(function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=B_(n.unaryFilter.field);return rr.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=B_(n.unaryFilter.field);return rr.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=B_(n.unaryFilter.field);return rr.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=B_(n.unaryFilter.field);return rr.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ht(61313);default:return Ht(60726)}})(t):t.fieldFilter!==void 0?(function(n){return rr.create(B_(n.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ht(58110);default:return Ht(50506)}})(n.fieldFilter.op),n.fieldFilter.value)})(t):t.compositeFilter!==void 0?(function(n){return Br.create(n.compositeFilter.filters.map((r=>Vhe(r))),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Ht(1026)}})(n.compositeFilter.op))})(t):Ht(30097,{filter:t})}function oOe(t){return Z5e[t]}function aOe(t){return J5e[t]}function lOe(t){return Q5e[t]}function U_(t){return{fieldPath:t.canonicalString()}}function B_(t){return ji.fromServerFormat(t.fieldPath)}function zhe(t){return t instanceof rr?(function(n){if(n.op==="=="){if(wJ(n.value))return{unaryFilter:{field:U_(n.field),op:"IS_NAN"}};if(xJ(n.value))return{unaryFilter:{field:U_(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(wJ(n.value))return{unaryFilter:{field:U_(n.field),op:"IS_NOT_NAN"}};if(xJ(n.value))return{unaryFilter:{field:U_(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:U_(n.field),op:aOe(n.op),value:n.value}}})(t):t instanceof Br?(function(n){const r=n.getFilters().map((i=>zhe(i)));return r.length===1?r[0]:{compositeFilter:{op:lOe(n.op),filters:r}}})(t):Ht(54877,{filter:t})}function cOe(t){const e=[];return t.fields.forEach((n=>e.push(n.canonicalString()))),{fieldPaths:e}}function Ghe(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}class qf{constructor(e,n,r,i,s=an.min(),o=an.min(),a=Ns.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new qf(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new qf(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new qf(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new qf(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class Uhe{constructor(e){this.yt=e}}function uOe(t,e){let n;if(e.document)n=nOe(t.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=At.fromSegments(e.noDocument.path),i=O1(e.noDocument.readTime);n=Qi.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return Ht(56709);{const r=At.fromSegments(e.unknownDocument.path),i=O1(e.unknownDocument.version);n=Qi.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime((function(i){const s=new Ur(i[0],i[1]);return an.fromTimestamp(s)})(e.readTime)),n}function $J(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:x4(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=(function(s,o){return{name:v4(s,o.key),fields:o.data.value.mapValue.fields,updateTime:f2(s,o.version.toTimestamp()),createTime:f2(s,o.createTime.toTimestamp())}})(t.yt,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:N1(e.version)};else{if(!e.isUnknownDocument())return Ht(57904,{document:e});r.unknownDocument={path:n.path.toArray(),version:N1(e.version)}}return r}function x4(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function N1(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function O1(t){const e=new Ur(t.seconds,t.nanoseconds);return an.fromTimestamp(e)}function Ey(t,e){const n=(e.baseMutations||[]).map((s=>R8(t.yt,s)));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map((s=>R8(t.yt,s))),i=Ur.fromMillis(e.localWriteTimeMs);return new EU(e.batchId,i,n,r)}function lS(t){const e=O1(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?O1(t.lastLimboFreeSnapshotVersion):an.min();let r;return r=(function(s){return s.documents!==void 0})(t.query)?(function(s){const o=s.documents.length;return rn(o===1,1966,{count:o}),uu(Q5(Lhe(s.documents[0])))})(t.query):(function(s){return uu(Fhe(s))})(t.query),new qf(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,Ns.fromBase64String(t.resumeToken))}function Bhe(t,e){const n=N1(e.snapshotVersion),r=N1(e.lastLimboFreeSnapshotVersion);let i;i=g4(e.target)?jhe(t.yt,e.target):$he(t.yt,e.target).ft;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:M1(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function Whe(t){const e=Fhe({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?A8(e,e.limit,"L"):e}function lj(t,e){return new TU(e.largestBatchId,R8(t.yt,e.overlayMutation))}function FJ(t,e){const n=e.path.lastSegment();return[t,pa(e.path.popLast()),n]}function VJ(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:N1(r.readTime),documentKey:pa(r.documentKey.path),largestBatchId:r.largestBatchId}}class hOe{getBundleMetadata(e,n){return zJ(e).get(n).next((r=>{if(r)return(function(s){return{id:s.bundleId,createTime:O1(s.createTime),version:s.version}})(r)}))}saveBundleMetadata(e,n){return zJ(e).put((function(i){return{bundleId:i.id,createTime:N1(Va(i.createTime)),version:i.version}})(n))}getNamedQuery(e,n){return GJ(e).get(n).next((r=>{if(r)return(function(s){return{name:s.name,query:Whe(s.bundledQuery),readTime:O1(s.readTime)}})(r)}))}saveNamedQuery(e,n){return GJ(e).put((function(i){return{name:i.name,readTime:N1(Va(i.readTime)),bundledQuery:i.bundledQuery}})(n))}}function zJ(t){return Xs(t,K5)}function GJ(t){return Xs(t,Y5)}class sO{constructor(e,n){this.serializer=e,this.userId=n}static wt(e,n){const r=n.uid||"";return new sO(e,r)}getOverlay(e,n){return EE(e).get(FJ(this.userId,n)).next((r=>r?lj(this.serializer,r):null))}getOverlays(e,n){const r=gd();return xe.forEach(n,(i=>this.getOverlay(e,i).next((s=>{s!==null&&r.set(i,s)})))).next((()=>r))}saveOverlays(e,n,r){const i=[];return r.forEach(((s,o)=>{const a=new TU(n,o);i.push(this.St(e,a))})),xe.waitFor(i)}removeOverlaysForBatchId(e,n,r){const i=new Set;n.forEach((o=>i.add(pa(o.getCollectionPath()))));const s=[];return i.forEach((o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(EE(e).Z(_8,a))})),xe.waitFor(s)}getOverlaysForCollection(e,n,r){const i=gd(),s=pa(n),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return EE(e).J(_8,o).next((a=>{for(const l of a){const c=lj(this.serializer,l);i.set(c.getKey(),c)}return i}))}getOverlaysForCollectionGroup(e,n,r,i){const s=gd();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return EE(e).ee({index:Hue,range:a},((l,c,u)=>{const h=lj(this.serializer,c);s.size()<i||h.largestBatchId===o?(s.set(h.getKey(),h),o=h.largestBatchId):u.done()})).next((()=>s))}St(e,n){return EE(e).put((function(i,s,o){const[a,l,c]=FJ(s,o.mutation.key);return{userId:s,collectionPath:l,documentId:c,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:_4(i.yt,o.mutation)}})(this.serializer,this.userId,n))}}function EE(t){return Xs(t,X5)}class dOe{bt(e){return Xs(e,gU)}getSessionToken(e){return this.bt(e).get("sessionToken").next((n=>{const r=n?.value;return r?Ns.fromUint8Array(r):Ns.EMPTY_BYTE_STRING}))}setSessionToken(e,n){return this.bt(e).put({name:"sessionToken",value:n.toUint8Array()})}}class Sy{constructor(){}Dt(e,n){this.Ct(e,n),n.vt()}Ct(e,n){if("nullValue"in e)this.Ft(n,5);else if("booleanValue"in e)this.Ft(n,10),n.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(n,15),n.Mt(bi(e.integerValue));else if("doubleValue"in e){const r=bi(e.doubleValue);isNaN(r)?this.Ft(n,13):(this.Ft(n,15),Ik(r)?n.Mt(0):n.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(n,20),typeof r=="string"&&(r=pp(r)),n.xt(`${r.seconds||""}`),n.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,n),this.Nt(n);else if("bytesValue"in e)this.Ft(n,30),n.Bt(mp(e.bytesValue)),this.Nt(n);else if("referenceValue"in e)this.Lt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(n,45),n.Mt(r.latitude||0),n.Mt(r.longitude||0)}else"mapValue"in e?ihe(e)?this.Ft(n,Number.MAX_SAFE_INTEGER):J5(e)?this.kt(e.mapValue,n):(this.qt(e.mapValue,n),this.Nt(n)):"arrayValue"in e?(this.Qt(e.arrayValue,n),this.Nt(n)):Ht(19022,{$t:e})}Ot(e,n){this.Ft(n,25),this.Ut(e,n)}Ut(e,n){n.xt(e)}qt(e,n){const r=e.fields||{};this.Ft(n,55);for(const i of Object.keys(r))this.Ot(i,n),this.Ct(r[i],n)}kt(e,n){const r=e.fields||{};this.Ft(n,53);const i=o2,s=r[i].arrayValue?.values?.length||0;this.Ft(n,15),n.Mt(bi(s)),this.Ot(i,n),this.Ct(r[i],n)}Qt(e,n){const r=e.values||[];this.Ft(n,50);for(const i of r)this.Ct(i,n)}Lt(e,n){this.Ft(n,37),At.fromName(e).path.forEach((r=>{this.Ft(n,60),this.Ut(r,n)}))}Ft(e,n){e.Mt(n)}Nt(e){e.Mt(2)}}Sy.Kt=new Sy;const m_=255;function fOe(t){if(t===0)return 8;let e=0;return t>>4||(e+=4,t<<=4),t>>6||(e+=2,t<<=2),t>>7||(e+=1),e}function UJ(t){const e=64-(function(r){let i=0;for(let s=0;s<8;++s){const o=fOe(255&r[s]);if(i+=o,o!==8)break}return i})(t);return Math.ceil(e/8)}class pOe{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Gt(r.value),r=n.next();this.zt()}jt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Jt(r.value),r=n.next();this.Ht()}Yt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const i=n.codePointAt(0);this.Gt(240|i>>>18),this.Gt(128|63&i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i)}}this.zt()}Zt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const i=n.codePointAt(0);this.Jt(240|i>>>18),this.Jt(128|63&i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i)}}this.Ht()}Xt(e){const n=this.en(e),r=UJ(n);this.tn(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}nn(e){const n=this.en(e),r=UJ(n);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}rn(){this.sn(m_),this.sn(255)}_n(){this.an(m_),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const n=(function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)})(e),r=!!(128&n[0]);n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Gt(e){const n=255&e;n===0?(this.sn(0),this.sn(255)):n===m_?(this.sn(m_),this.sn(0)):this.sn(n)}Jt(e){const n=255&e;n===0?(this.an(0),this.an(255)):n===m_?(this.an(m_),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class mOe{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class gOe{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class SE{constructor(){this.cn=new pOe,this.ln=new mOe(this.cn),this.hn=new gOe(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}class Ty{constructor(e,n,r,i){this.Tn=e,this.In=n,this.En=r,this.dn=i}An(){const e=this.dn.length,n=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.dn,0),n!==e?r.set([0],this.dn.length):++r[r.length-1],new Ty(this.Tn,this.In,this.En,r)}Rn(e,n,r){return{indexId:this.Tn,uid:e,arrayValue:hM(this.En),directionalValue:hM(this.dn),orderedDocumentKey:hM(n),documentKey:r.path.toArray()}}Vn(e,n,r){const i=this.Rn(e,n,r);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}}function im(t,e){let n=t.Tn-e.Tn;return n!==0?n:(n=BJ(t.En,e.En),n!==0?n:(n=BJ(t.dn,e.dn),n!==0?n:At.comparator(t.In,e.In)))}function BJ(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}function hM(t){return Vce()?(function(n){let r="";for(let i=0;i<n.length;i++)r+=String.fromCharCode(n[i]);return r})(t):t}function WJ(t){return typeof t!="string"?t:(function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r})(t)}class HJ{constructor(e){this.mn=new Hr(((n,r)=>ji.comparator(n.field,r.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const n of e.filters){const r=n;r.isInequality()?this.mn=this.mn.add(r):this.gn.push(r)}}get pn(){return this.mn.size>1}yn(e){if(rn(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const n=g8(e);if(n!==void 0&&!this.wn(n))return!1;const r=X0(e);let i=new Set,s=0,o=0;for(;s<r.length&&this.wn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.mn.size>0){const a=this.mn.getIterator().getNext();if(!i.has(a.field.canonicalString())){const l=r[s];if(!this.Sn(a,l)||!this.bn(this.fn[o++],l))return!1}++s}for(;s<r.length;++s){const a=r[s];if(o>=this.fn.length||!this.bn(this.fn[o++],a))return!1}return!0}Dn(){if(this.pn)return null;let e=new Hr(ji.comparator);const n=[];for(const r of this.gn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new rM(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new rM(r.field,0))}for(const r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new rM(r.field,r.dir==="asc"?0:1)));return new u4(u4.UNKNOWN_ID,this.collectionId,n,Ak.empty())}wn(e){for(const n of this.gn)if(this.Sn(n,e))return!0;return!1}Sn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}bn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}function Hhe(t){if(rn(t instanceof rr||t instanceof Br,20012),t instanceof rr){if(t instanceof fhe){const n=t.value.arrayValue?.values?.map((r=>rr.create(t.field,"==",r)))||[];return Br.create(n,"or")}return t}const e=t.filters.map((n=>Hhe(n)));return Br.create(e,t.op)}function yOe(t){if(t.getFilters().length===0)return[];const e=O8(Hhe(t));return rn(qhe(e),7391),M8(e)||N8(e)?[e]:e.getFilters()}function M8(t){return t instanceof rr}function N8(t){return t instanceof Br&&wU(t)}function qhe(t){return M8(t)||N8(t)||(function(n){if(n instanceof Br&&E8(n)){for(const r of n.getFilters())if(!M8(r)&&!N8(r))return!1;return!0}return!1})(t)}function O8(t){if(rn(t instanceof rr||t instanceof Br,34018),t instanceof rr)return t;if(t.filters.length===1)return O8(t.filters[0]);const e=t.filters.map((r=>O8(r)));let n=Br.create(e,t.op);return n=w4(n),qhe(n)?n:(rn(n instanceof Br,64498),rn(c2(n),40251),rn(n.filters.length>1,57927),n.filters.reduce(((r,i)=>IU(r,i))))}function IU(t,e){let n;return rn(t instanceof rr||t instanceof Br,38388),rn(e instanceof rr||e instanceof Br,25473),n=t instanceof rr?e instanceof rr?(function(i,s){return Br.create([i,s],"and")})(t,e):qJ(t,e):e instanceof rr?qJ(e,t):(function(i,s){if(rn(i.filters.length>0&&s.filters.length>0,48005),c2(i)&&c2(s))return uhe(i,s.getFilters());const o=E8(i)?i:s,a=E8(i)?s:i,l=o.filters.map((c=>IU(c,a)));return Br.create(l,"or")})(t,e),w4(n)}function qJ(t,e){if(c2(e))return uhe(e,t.getFilters());{const n=e.filters.map((r=>IU(t,r)));return Br.create(n,"or")}}function w4(t){if(rn(t instanceof rr||t instanceof Br,11850),t instanceof rr)return t;const e=t.getFilters();if(e.length===1)return w4(e[0]);if(lhe(t))return t;const n=e.map((i=>w4(i))),r=[];return n.forEach((i=>{i instanceof rr?r.push(i):i instanceof Br&&(i.op===t.op?r.push(...i.filters):r.push(i))})),r.length===1?r[0]:Br.create(r,t.op)}class vOe{constructor(){this.Cn=new PU}addToCollectionParentIndex(e,n){return this.Cn.add(n),xe.resolve()}getCollectionParents(e,n){return xe.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return xe.resolve()}deleteFieldIndex(e,n){return xe.resolve()}deleteAllFieldIndexes(e){return xe.resolve()}createTargetIndexes(e,n){return xe.resolve()}getDocumentsMatchingTarget(e,n){return xe.resolve(null)}getIndexType(e,n){return xe.resolve(0)}getFieldIndexes(e,n){return xe.resolve([])}getNextCollectionGroupToUpdate(e){return xe.resolve(null)}getMinOffset(e,n){return xe.resolve(_c.min())}getMinOffsetFromCollectionGroup(e,n){return xe.resolve(_c.min())}updateCollectionGroup(e,n,r){return xe.resolve()}updateIndexEntries(e,n){return xe.resolve()}}class PU{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Hr(Ir.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Hr(Ir.comparator)).toArray()}}const KJ="IndexedDbIndexManager",TC=new Uint8Array(0);class _Oe{constructor(e,n){this.databaseId=n,this.vn=new PU,this.Fn=new Sp((r=>M1(r)),((r,i)=>nI(r,i))),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.vn.has(n)){const r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener((()=>{this.vn.add(n)}));const s={collectionId:r,parent:pa(i)};return YJ(e).put(s)}return xe.resolve()}getCollectionParents(e,n){const r=[],i=IDBKeyRange.bound([n,""],[Oue(n),""],!1,!0);return YJ(e).J(i).next((s=>{for(const o of s){if(o.collectionId!==n)break;r.push(md(o.parent))}return r}))}addFieldIndex(e,n){const r=TE(e),i=(function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map((l=>[l.fieldPath.canonicalString(),l.kind]))}})(n);delete i.indexId;const s=r.add(i);if(n.indexState){const o=y_(e);return s.next((a=>{o.put(VJ(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))}))}return s.next()}deleteFieldIndex(e,n){const r=TE(e),i=y_(e),s=g_(e);return r.delete(n.indexId).next((()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))).next((()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const n=TE(e),r=g_(e),i=y_(e);return n.Z().next((()=>r.Z())).next((()=>i.Z()))}createTargetIndexes(e,n){return xe.forEach(this.Mn(n),(r=>this.getIndexType(e,r).next((i=>{if(i===0||i===1){const s=new HJ(r).Dn();if(s!=null)return this.addFieldIndex(e,s)}}))))}getDocumentsMatchingTarget(e,n){const r=g_(e);let i=!0;const s=new Map;return xe.forEach(this.Mn(n),(o=>this.xn(e,o).next((a=>{i&&(i=!!a),s.set(o,a)})))).next((()=>{if(i){let o=Hn();const a=[];return xe.forEach(s,((l,c)=>{ft(KJ,`Using index ${(function(I){return`id=${I.indexId}|cg=${I.collectionGroup}|f=${I.fields.map((P=>`${P.fieldPath}:${P.kind}`)).join(",")}`})(l)} to execute ${M1(n)}`);const u=(function(I,P){const R=g8(P);if(R===void 0)return null;for(const D of y4(I,R.fieldPath))switch(D.op){case"array-contains-any":return D.value.arrayValue.values||[];case"array-contains":return[D.value]}return null})(c,l),h=(function(I,P){const R=new Map;for(const D of X0(P))for(const C of y4(I,D.fieldPath))switch(C.op){case"==":case"in":R.set(D.fieldPath.canonicalString(),C.value);break;case"not-in":case"!=":return R.set(D.fieldPath.canonicalString(),C.value),Array.from(R.values())}return null})(c,l),f=(function(I,P){const R=[];let D=!0;for(const C of X0(P)){const M=C.kind===0?kJ(I,C.fieldPath,I.startAt):AJ(I,C.fieldPath,I.startAt);R.push(M.value),D&&(D=M.inclusive)}return new l2(R,D)})(c,l),g=(function(I,P){const R=[];let D=!0;for(const C of X0(P)){const M=C.kind===0?AJ(I,C.fieldPath,I.endAt):kJ(I,C.fieldPath,I.endAt);R.push(M.value),D&&(D=M.inclusive)}return new l2(R,D)})(c,l),y=this.On(l,c,f),_=this.On(l,c,g),b=this.Nn(l,c,h),T=this.Bn(l.indexId,u,y,f.inclusive,_,g.inclusive,b);return xe.forEach(T,(A=>r.Y(A,n.limit).next((I=>{I.forEach((P=>{const R=At.fromSegments(P.documentKey);o.has(R)||(o=o.add(R),a.push(R))}))}))))})).next((()=>a))}return xe.resolve(null)}))}Mn(e){let n=this.Fn.get(e);return n||(e.filters.length===0?n=[e]:n=yOe(Br.create(e.filters,"and")).map((r=>T8(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,n),n)}Bn(e,n,r,i,s,o,a){const l=(n!=null?n.length:1)*Math.max(r.length,s.length),c=l/(n!=null?n.length:1),u=[];for(let h=0;h<l;++h){const f=n?this.Ln(n[h/c]):TC,g=this.kn(e,f,r[h%c],i),y=this.qn(e,f,s[h%c],o),_=a.map((b=>this.kn(e,f,b,!0)));u.push(...this.createRange(g,y,_))}return u}kn(e,n,r,i){const s=new Ty(e,At.empty(),n,r);return i?s:s.An()}qn(e,n,r,i){const s=new Ty(e,At.empty(),n,r);return i?s.An():s}xn(e,n){const r=new HJ(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next((s=>{let o=null;for(const a of s)r.yn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o}))}getIndexType(e,n){let r=2;const i=this.Mn(n);return xe.forEach(i,(s=>this.xn(e,s).next((o=>{o?r!==0&&o.fields.length<(function(l){let c=new Hr(ji.comparator),u=!1;for(const h of l.filters)for(const f of h.getFlattenedFilters())f.field.isKeyField()||(f.op==="array-contains"||f.op==="array-contains-any"?u=!0:c=c.add(f.field));for(const h of l.orderBy)h.field.isKeyField()||(c=c.add(h.field));return c.size+(u?1:0)})(s)&&(r=1):r=0})))).next((()=>(function(o){return o.limit!==null})(n)&&i.length>1&&r===2?1:r))}Qn(e,n){const r=new SE;for(const i of X0(e)){const s=n.data.field(i.fieldPath);if(s==null)return null;const o=r.Pn(i.kind);Sy.Kt.Dt(s,o)}return r.un()}Ln(e){const n=new SE;return Sy.Kt.Dt(e,n.Pn(0)),n.un()}$n(e,n){const r=new SE;return Sy.Kt.Dt(Ok(this.databaseId,n),r.Pn((function(s){const o=X0(s);return o.length===0?0:o[o.length-1].kind})(e))),r.un()}Nn(e,n,r){if(r===null)return[];let i=[];i.push(new SE);let s=0;for(const o of X0(e)){const a=r[s++];for(const l of i)if(this.Un(n,o.fieldPath)&&Lk(a))i=this.Kn(i,o,a);else{const c=l.Pn(o.kind);Sy.Kt.Dt(a,c)}}return this.Wn(i)}On(e,n,r){return this.Nn(e,n,r.position)}Wn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].un();return n}Kn(e,n,r){const i=[...e],s=[];for(const o of r.arrayValue.values||[])for(const a of i){const l=new SE;l.seed(a.un()),Sy.Kt.Dt(o,l.Pn(n.kind)),s.push(l)}return s}Un(e,n){return!!e.filters.find((r=>r instanceof rr&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in")))}getFieldIndexes(e,n){const r=TE(e),i=y_(e);return(n?r.J(v8,IDBKeyRange.bound(n,n)):r.J()).next((s=>{const o=[];return xe.forEach(s,(a=>i.get([a.indexId,this.uid]).next((l=>{o.push((function(u,h){const f=h?new Ak(h.sequenceNumber,new _c(O1(h.readTime),new At(md(h.documentKey)),h.largestBatchId)):Ak.empty(),g=u.fields.map((([y,_])=>new rM(ji.fromServerFormat(y),_)));return new u4(u.indexId,u.collectionGroup,g,f)})(a,l))})))).next((()=>o))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((n=>n.length===0?null:(n.sort(((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:Rn(r.collectionGroup,i.collectionGroup)})),n[0].collectionGroup)))}updateCollectionGroup(e,n,r){const i=TE(e),s=y_(e);return this.Gn(e).next((o=>i.J(v8,IDBKeyRange.bound(n,n)).next((a=>xe.forEach(a,(l=>s.put(VJ(l.indexId,this.uid,o,r))))))))}updateIndexEntries(e,n){const r=new Map;return xe.forEach(n,((i,s)=>{const o=r.get(i.collectionGroup);return(o?xe.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next((a=>(r.set(i.collectionGroup,a),xe.forEach(a,(l=>this.zn(e,i,l).next((c=>{const u=this.jn(s,l);return c.isEqual(u)?xe.resolve():this.Jn(e,s,l,c,u)})))))))}))}Hn(e,n,r,i){return g_(e).put(i.Rn(this.uid,this.$n(r,n.key),n.key))}Yn(e,n,r,i){return g_(e).delete(i.Vn(this.uid,this.$n(r,n.key),n.key))}zn(e,n,r){const i=g_(e);let s=new Hr(im);return i.ee({index:Wue,range:IDBKeyRange.only([r.indexId,this.uid,hM(this.$n(r,n))])},((o,a)=>{s=s.add(new Ty(r.indexId,n,WJ(a.arrayValue),WJ(a.directionalValue)))})).next((()=>s))}jn(e,n){let r=new Hr(im);const i=this.Qn(n,e);if(i==null)return r;const s=g8(n);if(s!=null){const o=e.data.field(s.fieldPath);if(Lk(o))for(const a of o.arrayValue.values||[])r=r.add(new Ty(n.indexId,e.key,this.Ln(a),i))}else r=r.add(new Ty(n.indexId,e.key,TC,i));return r}Jn(e,n,r,i,s){ft(KJ,"Updating index entries for document '%s'",n.key);const o=[];return(function(l,c,u,h,f){const g=l.getIterator(),y=c.getIterator();let _=p_(g),b=p_(y);for(;_||b;){let T=!1,A=!1;if(_&&b){const I=u(_,b);I<0?A=!0:I>0&&(T=!0)}else _!=null?A=!0:T=!0;T?(h(b),b=p_(y)):A?(f(_),_=p_(g)):(_=p_(g),b=p_(y))}})(i,s,im,(a=>{o.push(this.Hn(e,n,r,a))}),(a=>{o.push(this.Yn(e,n,r,a))})),xe.waitFor(o)}Gn(e){let n=1;return y_(e).ee({index:Bue,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((r,i,s)=>{s.done(),n=i.sequenceNumber+1})).next((()=>n))}createRange(e,n,r){r=r.sort(((o,a)=>im(o,a))).filter(((o,a,l)=>!a||im(o,l[a-1])!==0));const i=[];i.push(e);for(const o of r){const a=im(o,e),l=im(o,n);if(a===0)i[0]=e.An();else if(a>0&&l<0)i.push(o),i.push(o.An());else if(l>0)break}i.push(n);const s=[];for(let o=0;o<i.length;o+=2){if(this.Zn(i[o],i[o+1]))return[];const a=i[o].Vn(this.uid,TC,At.empty()),l=i[o+1].Vn(this.uid,TC,At.empty());s.push(IDBKeyRange.bound(a,l))}return s}Zn(e,n){return im(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(XJ)}getMinOffset(e,n){return xe.mapArray(this.Mn(n),(r=>this.xn(e,r).next((i=>i||Ht(44426))))).next(XJ)}}function YJ(t){return Xs(t,Rk)}function g_(t){return Xs(t,oT)}function TE(t){return Xs(t,mU)}function y_(t){return Xs(t,sT)}function XJ(t){rn(t.length!==0,28825);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const i=t[r].indexState.offset;dU(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new _c(e.readTime,e.documentKey,n)}const ZJ={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Khe=41943040;class ta{static withCacheSize(e){return new ta(e,ta.DEFAULT_COLLECTION_PERCENTILE,ta.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}function Yhe(t,e,n){const r=t.store(Zu),i=t.store(n2),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const l=r.ee({range:o},((u,h,f)=>(a++,f.delete())));s.push(l.next((()=>{rn(a===1,47070,{batchId:n.batchId})})));const c=[];for(const u of n.mutations){const h=zue(e,u.key.path,n.batchId);s.push(i.delete(h)),c.push(u.key)}return xe.waitFor(s).next((()=>c))}function b4(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Ht(14731);e=t.noDocument}return JSON.stringify(e).length}ta.DEFAULT_COLLECTION_PERCENTILE=10,ta.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ta.DEFAULT=new ta(Khe,ta.DEFAULT_COLLECTION_PERCENTILE,ta.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ta.DISABLED=new ta(-1,0,0);class oO{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Xn={}}static wt(e,n,r,i){rn(e.uid!=="",64387);const s=e.isAuthenticated()?e.uid:"";return new oO(s,n,r,i)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return sm(e).ee({index:Dy,range:r},((i,s,o)=>{n=!1,o.done()})).next((()=>n))}addMutationBatch(e,n,r,i){const s=W_(e),o=sm(e);return o.add({}).next((a=>{rn(typeof a=="number",49019);const l=new EU(a,n,r,i),c=(function(g,y,_){const b=_.baseMutations.map((A=>_4(g.yt,A))),T=_.mutations.map((A=>_4(g.yt,A)));return{userId:y,batchId:_.batchId,localWriteTimeMs:_.localWriteTime.toMillis(),baseMutations:b,mutations:T}})(this.serializer,this.userId,l),u=[];let h=new Hr(((f,g)=>Rn(f.canonicalString(),g.canonicalString())));for(const f of i){const g=zue(this.userId,f.key.path,a);h=h.add(f.key.path.popLast()),u.push(o.put(c)),u.push(s.put(g,KNe))}return h.forEach((f=>{u.push(this.indexManager.addToCollectionParentIndex(e,f))})),e.addOnCommittedListener((()=>{this.Xn[a]=l.keys()})),xe.waitFor(u).next((()=>l))}))}lookupMutationBatch(e,n){return sm(e).get(n).next((r=>r?(rn(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:n}),Ey(this.serializer,r)):null))}er(e,n){return this.Xn[n]?xe.resolve(this.Xn[n]):this.lookupMutationBatch(e,n).next((r=>{if(r){const i=r.keys();return this.Xn[n]=i,i}return null}))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return sm(e).ee({index:Dy,range:i},((o,a,l)=>{a.userId===this.userId&&(rn(a.batchId>=r,47524,{tr:r}),s=Ey(this.serializer,a)),l.done()})).next((()=>s))}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=Jy;return sm(e).ee({index:Dy,range:n,reverse:!0},((i,s,o)=>{r=s.batchId,o.done()})).next((()=>r))}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,Jy],[this.userId,Number.POSITIVE_INFINITY]);return sm(e).J(Dy,n).next((r=>r.map((i=>Ey(this.serializer,i)))))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=iM(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return W_(e).ee({range:i},((o,a,l)=>{const[c,u,h]=o,f=md(u);if(c===this.userId&&n.path.isEqual(f))return sm(e).get(h).next((g=>{if(!g)throw Ht(61480,{nr:o,batchId:h});rn(g.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:g.userId,batchId:h}),s.push(Ey(this.serializer,g))}));l.done()})).next((()=>s))}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Hr(Rn);const i=[];return n.forEach((s=>{const o=iM(this.userId,s.path),a=IDBKeyRange.lowerBound(o),l=W_(e).ee({range:a},((c,u,h)=>{const[f,g,y]=c,_=md(g);f===this.userId&&s.path.isEqual(_)?r=r.add(y):h.done()}));i.push(l)})),xe.waitFor(i).next((()=>this.rr(e,r)))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1,s=iM(this.userId,r),o=IDBKeyRange.lowerBound(s);let a=new Hr(Rn);return W_(e).ee({range:o},((l,c,u)=>{const[h,f,g]=l,y=md(f);h===this.userId&&r.isPrefixOf(y)?y.length===i&&(a=a.add(g)):u.done()})).next((()=>this.rr(e,a)))}rr(e,n){const r=[],i=[];return n.forEach((s=>{i.push(sm(e).get(s).next((o=>{if(o===null)throw Ht(35274,{batchId:s});rn(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:s}),r.push(Ey(this.serializer,o))})))})),xe.waitFor(i).next((()=>r))}removeMutationBatch(e,n){return Yhe(e.le,this.userId,n).next((r=>(e.addOnCommittedListener((()=>{this.ir(n.batchId)})),xe.forEach(r,(i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((n=>{if(!n)return xe.resolve();const r=IDBKeyRange.lowerBound((function(o){return[o]})(this.userId)),i=[];return W_(e).ee({range:r},((s,o,a)=>{if(s[0]===this.userId){const l=md(s[1]);i.push(l)}else a.done()})).next((()=>{rn(i.length===0,56720,{sr:i.map((s=>s.canonicalString()))})}))}))}containsKey(e,n){return Xhe(e,this.userId,n)}_r(e){return Zhe(e).get(this.userId).next((n=>n||{userId:this.userId,lastAcknowledgedBatchId:Jy,lastStreamToken:""}))}}function Xhe(t,e,n){const r=iM(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return W_(t).ee({range:s,X:!0},((a,l,c)=>{const[u,h,f]=a;u===e&&h===i&&(o=!0),c.done()})).next((()=>o))}function sm(t){return Xs(t,Zu)}function W_(t){return Xs(t,n2)}function Zhe(t){return Xs(t,Pk)}class L1{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new L1(0)}static cr(){return new L1(-1)}}class xOe{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.lr(e).next((n=>{const r=new L1(n.highestTargetId);return n.highestTargetId=r.next(),this.hr(e,n).next((()=>n.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((n=>an.fromTimestamp(new Ur(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((n=>n.highestListenSequenceNumber))}setTargetsMetadata(e,n,r){return this.lr(e).next((i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.hr(e,i))))}addTargetData(e,n){return this.Pr(e,n).next((()=>this.lr(e).next((r=>(r.targetCount+=1,this.Tr(n,r),this.hr(e,r))))))}updateTargetData(e,n){return this.Pr(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next((()=>v_(e).delete(n.targetId))).next((()=>this.lr(e))).next((r=>(rn(r.targetCount>0,8065),r.targetCount-=1,this.hr(e,r))))}removeTargets(e,n,r){let i=0;const s=[];return v_(e).ee(((o,a)=>{const l=lS(a);l.sequenceNumber<=n&&r.get(l.targetId)===null&&(i++,s.push(this.removeTargetData(e,l)))})).next((()=>xe.waitFor(s))).next((()=>i))}forEachTarget(e,n){return v_(e).ee(((r,i)=>{const s=lS(i);n(s)}))}lr(e){return JJ(e).get(f4).next((n=>(rn(n!==null,2888),n)))}hr(e,n){return JJ(e).put(f4,n)}Pr(e,n){return v_(e).put(Bhe(this.serializer,n))}Tr(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next((n=>n.targetCount))}getTargetData(e,n){const r=M1(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return v_(e).ee({range:i,index:Uue},((o,a,l)=>{const c=lS(a);nI(n,c.target)&&(s=c,l.done())})).next((()=>s))}addMatchingKeys(e,n,r){const i=[],s=Um(e);return n.forEach((o=>{const a=pa(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))})),xe.waitFor(i)}removeMatchingKeys(e,n,r){const i=Um(e);return xe.forEach(n,(s=>{const o=pa(s.path);return xe.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])}))}removeMatchingKeysForTargetId(e,n){const r=Um(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),i=Um(e);let s=Hn();return i.ee({range:r,X:!0},((o,a,l)=>{const c=md(o[1]),u=new At(c);s=s.add(u)})).next((()=>s))}containsKey(e,n){const r=pa(n.path),i=IDBKeyRange.bound([r],[Oue(r)],!1,!0);let s=0;return Um(e).ee({index:pU,X:!0,range:i},(([o,a],l,c)=>{o!==0&&(s++,c.done())})).next((()=>s>0))}At(e,n){return v_(e).get(n).next((r=>r?lS(r):null))}}function v_(t){return Xs(t,r2)}function JJ(t){return Xs(t,Qy)}function Um(t){return Xs(t,i2)}const QJ="LruGarbageCollector",wOe=1048576;function eQ([t,e],[n,r]){const i=Rn(t,n);return i===0?Rn(e,r):i}class bOe{constructor(e){this.Ir=e,this.buffer=new Hr(eQ),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();eQ(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class Jhe{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){ft(QJ,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){r0(n)?ft(QJ,"Ignoring IndexedDB error during garbage collection: ",n):await uv(n)}await this.Vr(3e5)}))}}class EOe{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next((r=>Math.floor(n/100*r)))}nthSequenceNumber(e,n){if(n===0)return xe.resolve(iu.ce);const r=new bOe(n);return this.mr.forEachTarget(e,(i=>r.Ar(i.sequenceNumber))).next((()=>this.mr.pr(e,(i=>r.Ar(i))))).next((()=>r.maxValue))}removeTargets(e,n,r){return this.mr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(ft("LruGarbageCollector","Garbage collection skipped; disabled"),xe.resolve(ZJ)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(ft("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),ZJ):this.yr(e,n)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let r,i,s,o,a,l,c;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((h=>(h>this.params.maximumSequenceNumbersToCollect?(ft("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),i=this.params.maximumSequenceNumbersToCollect):i=h,o=Date.now(),this.nthSequenceNumber(e,i)))).next((h=>(r=h,a=Date.now(),this.removeTargets(e,r,n)))).next((h=>(s=h,l=Date.now(),this.removeOrphanedDocuments(e,r)))).next((h=>(c=Date.now(),z_()<=tr.DEBUG&&ft("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-u}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(l-a)+`ms
	Removed ${h} documents in `+(c-l)+`ms
Total Duration: ${c-u}ms`),xe.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:h}))))}}function Qhe(t,e){return new EOe(t,e)}class SOe{constructor(e,n){this.db=e,this.garbageCollector=Qhe(this,n)}gr(e){const n=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((r=>n.next((i=>r+i))))}wr(e){let n=0;return this.pr(e,(r=>{n++})).next((()=>n))}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}pr(e,n){return this.Sr(e,((r,i)=>n(i)))}addReference(e,n,r){return kC(e,r)}removeReference(e,n,r){return kC(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return kC(e,n)}br(e,n){return(function(i,s){let o=!1;return Zhe(i).te((a=>Xhe(i,a,s).next((l=>(l&&(o=!0),xe.resolve(!l)))))).next((()=>o))})(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Sr(e,((o,a)=>{if(a<=n){const l=this.br(e,o).next((c=>{if(!c)return s++,r.getEntry(e,o).next((()=>(r.removeEntry(o,an.min()),Um(e).delete((function(h){return[0,pa(h.path)]})(o)))))}));i.push(l)}})).next((()=>xe.waitFor(i))).next((()=>r.apply(e))).next((()=>s))}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return kC(e,n)}Sr(e,n){const r=Um(e);let i,s=iu.ce;return r.ee({index:pU},(([o,a],{path:l,sequenceNumber:c})=>{o===0?(s!==iu.ce&&n(new At(md(i)),s),s=c,i=l):s=iu.ce})).next((()=>{s!==iu.ce&&n(new At(md(i)),s)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function kC(t,e){return Um(t).put((function(r,i){return{targetId:0,path:pa(r.path),sequenceNumber:i}})(e,t.currentSequenceNumber))}class ede{constructor(){this.changes=new Sp((e=>e.toString()),((e,n)=>e.isEqual(n))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Qi.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?xe.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class TOe{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return L0(e).put(r)}removeEntry(e,n,r){return L0(e).delete((function(s,o){const a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],x4(o),a[a.length-1]]})(n,r))}updateMetadata(e,n){return this.getMetadata(e).next((r=>(r.byteSize+=n,this.Dr(e,r))))}getEntry(e,n){let r=Qi.newInvalidDocument(n);return L0(e).ee({index:sM,range:IDBKeyRange.only(kE(n))},((i,s)=>{r=this.Cr(n,s)})).next((()=>r))}vr(e,n){let r={size:0,document:Qi.newInvalidDocument(n)};return L0(e).ee({index:sM,range:IDBKeyRange.only(kE(n))},((i,s)=>{r={document:this.Cr(n,s),size:b4(s)}})).next((()=>r))}getEntries(e,n){let r=uc();return this.Fr(e,n,((i,s)=>{const o=this.Cr(i,s);r=r.insert(i,o)})).next((()=>r))}Mr(e,n){let r=uc(),i=new ki(At.comparator);return this.Fr(e,n,((s,o)=>{const a=this.Cr(s,o);r=r.insert(s,a),i=i.insert(s,b4(o))})).next((()=>({documents:r,Or:i})))}Fr(e,n,r){if(n.isEmpty())return xe.resolve();let i=new Hr(rQ);n.forEach((l=>i=i.add(l)));const s=IDBKeyRange.bound(kE(i.first()),kE(i.last())),o=i.getIterator();let a=o.getNext();return L0(e).ee({index:sM,range:s},((l,c,u)=>{const h=At.fromSegments([...c.prefixPath,c.collectionGroup,c.documentId]);for(;a&&rQ(a,h)<0;)r(a,null),a=o.getNext();a&&a.isEqual(h)&&(r(a,c),a=o.hasNext()?o.getNext():null),a?u.j(kE(a)):u.done()})).next((()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null}))}getDocumentsMatchingQuery(e,n,r,i,s){const o=n.path,a=[o.popLast().toArray(),o.lastSegment(),x4(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return L0(e).J(IDBKeyRange.bound(a,l,!0)).next((c=>{s?.incrementDocumentReadCount(c.length);let u=uc();for(const h of c){const f=this.Cr(At.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);f.isFoundDocument()&&(iI(n,f)||i.has(f.key))&&(u=u.insert(f.key,f))}return u}))}getAllFromCollectionGroup(e,n,r,i){let s=uc();const o=nQ(n,r),a=nQ(n,_c.max());return L0(e).ee({index:Gue,range:IDBKeyRange.bound(o,a,!0)},((l,c,u)=>{const h=this.Cr(At.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);s=s.insert(h.key,h),s.size===i&&u.done()})).next((()=>s))}newChangeBuffer(e){return new kOe(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((n=>n.byteSize))}getMetadata(e){return tQ(e).get(y8).next((n=>(rn(!!n,20021),n)))}Dr(e,n){return tQ(e).put(y8,n)}Cr(e,n){if(n){const r=uOe(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(an.min())))return r}return Qi.newInvalidDocument(e)}}function tde(t){return new TOe(t)}class kOe extends ede{constructor(e,n){super(),this.Nr=e,this.trackRemovals=n,this.Br=new Sp((r=>r.toString()),((r,i)=>r.isEqual(i)))}applyChanges(e){const n=[];let r=0,i=new Hr(((s,o)=>Rn(s.canonicalString(),o.canonicalString())));return this.changes.forEach(((s,o)=>{const a=this.Br.get(s);if(n.push(this.Nr.removeEntry(e,s,a.readTime)),o.isValidDocument()){const l=$J(this.Nr.serializer,o);i=i.add(s.path.popLast());const c=b4(l);r+=c-a.size,n.push(this.Nr.addEntry(e,s,l))}else if(r-=a.size,this.trackRemovals){const l=$J(this.Nr.serializer,o.convertToNoDocument(an.min()));n.push(this.Nr.addEntry(e,s,l))}})),i.forEach((s=>{n.push(this.Nr.indexManager.addToCollectionParentIndex(e,s))})),n.push(this.Nr.updateMetadata(e,r)),xe.waitFor(n)}getFromCache(e,n){return this.Nr.vr(e,n).next((r=>(this.Br.set(n,{size:r.size,readTime:r.document.readTime}),r.document)))}getAllFromCache(e,n){return this.Nr.Mr(e,n).next((({documents:r,Or:i})=>(i.forEach(((s,o)=>{this.Br.set(s,{size:o,readTime:r.get(s).readTime})})),r)))}}function tQ(t){return Xs(t,Ck)}function L0(t){return Xs(t,d4)}function kE(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function nQ(t,e){const n=e.documentKey.path.toArray();return[t,x4(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function rQ(t,e){const n=t.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=Rn(n[s],r[s]),i)return i;return i=Rn(n.length,r.length),i||(i=Rn(n[n.length-2],r[r.length-2]),i||Rn(n[n.length-1],r[r.length-1]))}class AOe{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}class nde{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next((i=>(r=i,this.remoteDocumentCache.getEntry(e,n)))).next((i=>(r!==null&&uT(r.mutation,i,_l.empty(),Ur.now()),i)))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next((r=>this.getLocalViewOfDocuments(e,r,Hn()).next((()=>r))))}getLocalViewOfDocuments(e,n,r=Hn()){const i=gd();return this.populateOverlays(e,i,n).next((()=>this.computeViews(e,n,i,r).next((s=>{let o=oS();return s.forEach(((a,l)=>{o=o.insert(a,l.overlayedDocument)})),o}))))}getOverlayedDocuments(e,n){const r=gd();return this.populateOverlays(e,r,n).next((()=>this.computeViews(e,n,r,Hn())))}populateOverlays(e,n,r){const i=[];return r.forEach((s=>{n.has(s)||i.push(s)})),this.documentOverlayCache.getOverlays(e,i).next((s=>{s.forEach(((o,a)=>{n.set(o,a)}))}))}computeViews(e,n,r,i){let s=uc();const o=cT(),a=(function(){return cT()})();return n.forEach(((l,c)=>{const u=r.get(c.key);i.has(c.key)&&(u===void 0||u.mutation instanceof Tp)?s=s.insert(c.key,c):u!==void 0?(o.set(c.key,u.mutation.getFieldMask()),uT(u.mutation,c,u.mutation.getFieldMask(),Ur.now())):o.set(c.key,_l.empty())})),this.recalculateAndSaveOverlays(e,s).next((l=>(l.forEach(((c,u)=>o.set(c,u))),n.forEach(((c,u)=>a.set(c,new AOe(u,o.get(c)??null)))),a)))}recalculateAndSaveOverlays(e,n){const r=cT();let i=new ki(((o,a)=>o-a)),s=Hn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next((o=>{for(const a of o)a.keys().forEach((l=>{const c=n.get(l);if(c===null)return;let u=r.get(l)||_l.empty();u=a.applyToLocalView(c,u),r.set(l,u);const h=(i.get(a.batchId)||Hn()).add(l);i=i.insert(a.batchId,h)}))})).next((()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),c=l.key,u=l.value,h=_he();u.forEach((f=>{if(!s.has(f)){const g=khe(n.get(f),r.get(f));g!==null&&h.set(f,g),s=s.add(f)}})),o.push(this.documentOverlayCache.saveOverlays(e,c,h))}return xe.waitFor(o)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,n,r,i){return(function(o){return At.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):phe(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next((s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):xe.resolve(gd());let a=kk,l=s;return o.next((c=>xe.forEach(c,((u,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),s.get(u)?xe.resolve():this.remoteDocumentCache.getEntry(e,u).next((f=>{l=l.insert(u,f)}))))).next((()=>this.populateOverlays(e,c,s))).next((()=>this.computeViews(e,l,c,Hn()))).next((u=>({batchId:a,changes:vhe(u)})))))}))}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new At(n)).next((r=>{let i=oS();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i}))}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let o=oS();return this.indexManager.getCollectionParents(e,s).next((a=>xe.forEach(a,(l=>{const c=(function(h,f){return new rI(f,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)})(n,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,r,i).next((u=>{u.forEach(((h,f)=>{o=o.insert(h,f)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next((o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i)))).next((o=>{s.forEach(((l,c)=>{const u=c.getKey();o.get(u)===null&&(o=o.insert(u,Qi.newInvalidDocument(u)))}));let a=oS();return o.forEach(((l,c)=>{const u=s.get(l);u!==void 0&&uT(u.mutation,c,_l.empty(),Ur.now()),iI(n,c)&&(a=a.insert(l,c))})),a}))}}class IOe{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return xe.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,(function(i){return{id:i.id,version:i.version,createTime:Va(i.createTime)}})(n)),xe.resolve()}getNamedQuery(e,n){return xe.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,(function(i){return{name:i.name,query:Whe(i.bundledQuery),readTime:Va(i.readTime)}})(n)),xe.resolve()}}class POe{constructor(){this.overlays=new ki(At.comparator),this.qr=new Map}getOverlay(e,n){return xe.resolve(this.overlays.get(n))}getOverlays(e,n){const r=gd();return xe.forEach(n,(i=>this.getOverlay(e,i).next((s=>{s!==null&&r.set(i,s)})))).next((()=>r))}saveOverlays(e,n,r){return r.forEach(((i,s)=>{this.St(e,n,s)})),xe.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.qr.get(r);return i!==void 0&&(i.forEach((s=>this.overlays=this.overlays.remove(s))),this.qr.delete(r)),xe.resolve()}getOverlaysForCollection(e,n,r){const i=gd(),s=n.length+1,o=new At(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,c=l.getKey();if(!n.isPrefixOf(c.path))break;c.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return xe.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new ki(((c,u)=>c-u));const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===n&&c.largestBatchId>r){let u=s.get(c.largestBatchId);u===null&&(u=gd(),s=s.insert(c.largestBatchId,u)),u.set(c.getKey(),c)}}const a=gd(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach(((c,u)=>a.set(c,u))),!(a.size()>=i)););return xe.resolve(a)}St(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new TU(n,r));let s=this.qr.get(n);s===void 0&&(s=Hn(),this.qr.set(n,s)),this.qr.set(n,s.add(r.key))}}class COe{constructor(){this.sessionToken=Ns.EMPTY_BYTE_STRING}getSessionToken(e){return xe.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,xe.resolve()}}class CU{constructor(){this.Qr=new Hr(ao.$r),this.Ur=new Hr(ao.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const r=new ao(e,n);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,n){e.forEach((r=>this.addReference(r,n)))}removeReference(e,n){this.Gr(new ao(e,n))}zr(e,n){e.forEach((r=>this.removeReference(r,n)))}jr(e){const n=new At(new Ir([])),r=new ao(n,e),i=new ao(n,e+1),s=[];return this.Ur.forEachInRange([r,i],(o=>{this.Gr(o),s.push(o.key)})),s}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new At(new Ir([])),r=new ao(n,e),i=new ao(n,e+1);let s=Hn();return this.Ur.forEachInRange([r,i],(o=>{s=s.add(o.key)})),s}containsKey(e){const n=new ao(e,0),r=this.Qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class ao{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return At.comparator(e.key,n.key)||Rn(e.Yr,n.Yr)}static Kr(e,n){return Rn(e.Yr,n.Yr)||At.comparator(e.key,n.key)}}class ROe{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new Hr(ao.$r)}checkEmpty(e){return xe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new EU(s,n,r,i);this.mutationQueue.push(o);for(const a of i)this.Zr=this.Zr.add(new ao(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return xe.resolve(o)}lookupMutationBatch(e,n){return xe.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.ei(r),s=i<0?0:i;return xe.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return xe.resolve(this.mutationQueue.length===0?Jy:this.tr-1)}getAllMutationBatches(e){return xe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new ao(n,0),i=new ao(n,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([r,i],(o=>{const a=this.Xr(o.Yr);s.push(a)})),xe.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Hr(Rn);return n.forEach((i=>{const s=new ao(i,0),o=new ao(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,o],(a=>{r=r.add(a.Yr)}))})),xe.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;At.isDocumentKey(s)||(s=s.child(""));const o=new ao(new At(s),0);let a=new Hr(Rn);return this.Zr.forEachWhile((l=>{const c=l.key.path;return!!r.isPrefixOf(c)&&(c.length===i&&(a=a.add(l.Yr)),!0)}),o),xe.resolve(this.ti(a))}ti(e){const n=[];return e.forEach((r=>{const i=this.Xr(r);i!==null&&n.push(i)})),n}removeMutationBatch(e,n){rn(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return xe.forEach(n.mutations,(i=>{const s=new ao(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((()=>{this.Zr=r}))}ir(e){}containsKey(e,n){const r=new ao(n,0),i=this.Zr.firstAfterOrEqual(r);return xe.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,xe.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}class MOe{constructor(e){this.ri=e,this.docs=(function(){return new ki(At.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.ri(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return xe.resolve(r?r.document.mutableCopy():Qi.newInvalidDocument(n))}getEntries(e,n){let r=uc();return n.forEach((i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Qi.newInvalidDocument(i))})),xe.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=uc();const o=n.path,a=new At(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:c,value:{document:u}}=l.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||dU(jue(u),r)<=0||(i.has(u.key)||iI(n,u))&&(s=s.insert(u.key,u.mutableCopy()))}return xe.resolve(s)}getAllFromCollectionGroup(e,n,r,i){Ht(9500)}ii(e,n){return xe.forEach(this.docs,(r=>n(r)))}newChangeBuffer(e){return new NOe(this)}getSize(e){return xe.resolve(this.size)}}class NOe extends ede{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach(((r,i)=>{i.isValidDocument()?n.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)})),xe.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}class OOe{constructor(e){this.persistence=e,this.si=new Sp((n=>M1(n)),nI),this.lastRemoteSnapshotVersion=an.min(),this.highestTargetId=0,this.oi=0,this._i=new CU,this.targetCount=0,this.ai=L1.ur()}forEachTarget(e,n){return this.si.forEach(((r,i)=>n(i))),xe.resolve()}getLastRemoteSnapshotVersion(e){return xe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return xe.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),xe.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.oi&&(this.oi=n),xe.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new L1(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,xe.resolve()}updateTargetData(e,n){return this.Pr(n),xe.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,xe.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.si.forEach(((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.si.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)})),xe.waitFor(s).next((()=>i))}getTargetCount(e){return xe.resolve(this.targetCount)}getTargetData(e,n){const r=this.si.get(n)||null;return xe.resolve(r)}addMatchingKeys(e,n,r){return this._i.Wr(n,r),xe.resolve()}removeMatchingKeys(e,n,r){this._i.zr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach((o=>{s.push(i.markPotentiallyOrphaned(e,o))})),xe.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),xe.resolve()}getMatchingKeysForTargetId(e,n){const r=this._i.Hr(n);return xe.resolve(r)}containsKey(e,n){return xe.resolve(this._i.containsKey(n))}}class RU{constructor(e,n){this.ui={},this.overlays={},this.ci=new iu(0),this.li=!1,this.li=!0,this.hi=new COe,this.referenceDelegate=e(this),this.Pi=new OOe(this),this.indexManager=new vOe,this.remoteDocumentCache=(function(i){return new MOe(i)})((r=>this.referenceDelegate.Ti(r))),this.serializer=new Uhe(n),this.Ii=new IOe(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new POe,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ui[e.toKey()];return r||(r=new ROe(n,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,r){ft("MemoryPersistence","Starting transaction:",e);const i=new LOe(this.ci.next());return this.referenceDelegate.Ei(),r(i).next((s=>this.referenceDelegate.di(i).next((()=>s)))).toPromise().then((s=>(i.raiseOnCommittedEvent(),s)))}Ai(e,n){return xe.or(Object.values(this.ui).map((r=>()=>r.containsKey(e,n))))}}class LOe extends Fue{constructor(e){super(),this.currentSequenceNumber=e}}class aO{constructor(e){this.persistence=e,this.Ri=new CU,this.Vi=null}static mi(e){return new aO(e)}get fi(){if(this.Vi)return this.Vi;throw Ht(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.fi.delete(r.toString()),xe.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.fi.add(r.toString()),xe.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),xe.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach((i=>this.fi.add(i.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next((i=>{i.forEach((s=>this.fi.add(s.toString())))})).next((()=>r.removeTargetData(e,n)))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return xe.forEach(this.fi,(r=>{const i=At.fromPath(r);return this.gi(e,i).next((s=>{s||n.removeEntry(i,an.min())}))})).next((()=>(this.Vi=null,n.apply(e))))}updateLimboDocument(e,n){return this.gi(e,n).next((r=>{r?this.fi.delete(n.toString()):this.fi.add(n.toString())}))}Ti(e){return 0}gi(e,n){return xe.or([()=>xe.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class E4{constructor(e,n){this.persistence=e,this.pi=new Sp((r=>pa(r.path)),((r,i)=>r.isEqual(i))),this.garbageCollector=Qhe(this,n)}static mi(e,n){return new E4(e,n)}Ei(){}di(e){return xe.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>n.next((i=>r+i))))}wr(e){let n=0;return this.pr(e,(r=>{n++})).next((()=>n))}pr(e,n){return xe.forEach(this.pi,((r,i)=>this.br(e,r,i).next((s=>s?xe.resolve():n(i)))))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ii(e,(o=>this.br(e,o,n).next((a=>{a||(r++,s.removeEntry(o,an.min()))})))).next((()=>s.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),xe.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),xe.resolve()}removeReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),xe.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),xe.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=aM(e.data.value)),n}br(e,n,r){return xe.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const i=this.pi.get(n);return xe.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class DOe{constructor(e){this.serializer=e}k(e,n,r,i){const s=new H5("createOrUpgrade",n);r<1&&i>=1&&((function(l){l.createObjectStore(tI)})(e),(function(l){l.createObjectStore(Pk,{keyPath:qNe}),l.createObjectStore(Zu,{keyPath:pJ,autoIncrement:!0}).createIndex(Dy,mJ,{unique:!0}),l.createObjectStore(n2)})(e),iQ(e),(function(l){l.createObjectStore(Z0)})(e));let o=xe.resolve();return r<3&&i>=3&&(r!==0&&((function(l){l.deleteObjectStore(i2),l.deleteObjectStore(r2),l.deleteObjectStore(Qy)})(e),iQ(e)),o=o.next((()=>(function(l){const c=l.store(Qy),u={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:an.min().toTimestamp(),targetCount:0};return c.put(f4,u)})(s)))),r<4&&i>=4&&(r!==0&&(o=o.next((()=>(function(l,c){return c.store(Zu).J().next((h=>{l.deleteObjectStore(Zu),l.createObjectStore(Zu,{keyPath:pJ,autoIncrement:!0}).createIndex(Dy,mJ,{unique:!0});const f=c.store(Zu),g=h.map((y=>f.put(y)));return xe.waitFor(g)}))})(e,s)))),o=o.next((()=>{(function(l){l.createObjectStore(s2,{keyPath:n5e})})(e)}))),r<5&&i>=5&&(o=o.next((()=>this.yi(s)))),r<6&&i>=6&&(o=o.next((()=>((function(l){l.createObjectStore(Ck)})(e),this.wi(s))))),r<7&&i>=7&&(o=o.next((()=>this.Si(s)))),r<8&&i>=8&&(o=o.next((()=>this.bi(e,s)))),r<9&&i>=9&&(o=o.next((()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)}))),r<10&&i>=10&&(o=o.next((()=>this.Di(s)))),r<11&&i>=11&&(o=o.next((()=>{(function(l){l.createObjectStore(K5,{keyPath:r5e})})(e),(function(l){l.createObjectStore(Y5,{keyPath:i5e})})(e)}))),r<12&&i>=12&&(o=o.next((()=>{(function(l){const c=l.createObjectStore(X5,{keyPath:h5e});c.createIndex(_8,d5e,{unique:!1}),c.createIndex(Hue,f5e,{unique:!1})})(e)}))),r<13&&i>=13&&(o=o.next((()=>(function(l){const c=l.createObjectStore(d4,{keyPath:YNe});c.createIndex(sM,XNe),c.createIndex(Gue,ZNe)})(e))).next((()=>this.Ci(e,s))).next((()=>e.deleteObjectStore(Z0)))),r<14&&i>=14&&(o=o.next((()=>this.Fi(e,s)))),r<15&&i>=15&&(o=o.next((()=>(function(l){l.createObjectStore(mU,{keyPath:s5e,autoIncrement:!0}).createIndex(v8,o5e,{unique:!1}),l.createObjectStore(sT,{keyPath:a5e}).createIndex(Bue,l5e,{unique:!1}),l.createObjectStore(oT,{keyPath:c5e}).createIndex(Wue,u5e,{unique:!1})})(e)))),r<16&&i>=16&&(o=o.next((()=>{n.objectStore(sT).clear()})).next((()=>{n.objectStore(oT).clear()}))),r<17&&i>=17&&(o=o.next((()=>{(function(l){l.createObjectStore(gU,{keyPath:p5e})})(e)}))),r<18&&i>=18&&Vce()&&(o=o.next((()=>{n.objectStore(sT).clear()})).next((()=>{n.objectStore(oT).clear()}))),o}wi(e){let n=0;return e.store(Z0).ee(((r,i)=>{n+=b4(i)})).next((()=>{const r={byteSize:n};return e.store(Ck).put(y8,r)}))}yi(e){const n=e.store(Pk),r=e.store(Zu);return n.J().next((i=>xe.forEach(i,(s=>{const o=IDBKeyRange.bound([s.userId,Jy],[s.userId,s.lastAcknowledgedBatchId]);return r.J(Dy,o).next((a=>xe.forEach(a,(l=>{rn(l.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:l.batchId});const c=Ey(this.serializer,l);return Yhe(e,s.userId,c).next((()=>{}))}))))}))))}Si(e){const n=e.store(i2),r=e.store(Z0);return e.store(Qy).get(f4).next((i=>{const s=[];return r.ee(((o,a)=>{const l=new Ir(o),c=(function(h){return[0,pa(h)]})(l);s.push(n.get(c).next((u=>u?xe.resolve():(h=>n.put({targetId:0,path:pa(h),sequenceNumber:i.highestListenSequenceNumber}))(l))))})).next((()=>xe.waitFor(s)))}))}bi(e,n){e.createObjectStore(Rk,{keyPath:t5e});const r=n.store(Rk),i=new PU,s=o=>{if(i.add(o)){const a=o.lastSegment(),l=o.popLast();return r.put({collectionId:a,parent:pa(l)})}};return n.store(Z0).ee({X:!0},((o,a)=>{const l=new Ir(o);return s(l.popLast())})).next((()=>n.store(n2).ee({X:!0},(([o,a,l],c)=>{const u=md(a);return s(u.popLast())}))))}Di(e){const n=e.store(r2);return n.ee(((r,i)=>{const s=lS(i),o=Bhe(this.serializer,s);return n.put(o)}))}Ci(e,n){const r=n.store(Z0),i=[];return r.ee(((s,o)=>{const a=n.store(d4),l=(function(h){return h.document?new At(Ir.fromString(h.document.name).popFirst(5)):h.noDocument?At.fromSegments(h.noDocument.path):h.unknownDocument?At.fromSegments(h.unknownDocument.path):Ht(36783)})(o).path.toArray(),c={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(c))})).next((()=>xe.waitFor(i)))}Fi(e,n){const r=n.store(Zu),i=tde(this.serializer),s=new RU(aO.mi,this.serializer.yt);return r.J().next((o=>{const a=new Map;return o.forEach((l=>{let c=a.get(l.userId)??Hn();Ey(this.serializer,l).keys().forEach((u=>c=c.add(u))),a.set(l.userId,c)})),xe.forEach(a,((l,c)=>{const u=new Mo(c),h=sO.wt(this.serializer,u),f=s.getIndexManager(u),g=oO.wt(u,this.serializer,f,s.referenceDelegate);return new nde(i,g,h,f).recalculateAndSaveOverlaysForDocumentKeys(new x8(n,iu.ce),l).next()}))}))}}function iQ(t){t.createObjectStore(i2,{keyPath:QNe}).createIndex(pU,e5e,{unique:!0}),t.createObjectStore(r2,{keyPath:"targetId"}).createIndex(Uue,JNe,{unique:!0}),t.createObjectStore(Qy)}const om="IndexedDbPersistence",cj=18e5,uj=5e3,hj="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",jOe="main";class MU{constructor(e,n,r,i,s,o,a,l,c,u,h=18){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Mi=s,this.window=o,this.document=a,this.xi=c,this.Oi=u,this.Ni=h,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=f=>Promise.resolve(),!MU.v())throw new Tt(We.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new SOe(this,i),this.$i=n+jOe,this.serializer=new Uhe(l),this.Ui=new _g(this.$i,this.Ni,new DOe(this.serializer)),this.hi=new dOe,this.Pi=new xOe(this.referenceDelegate,this.serializer),this.remoteDocumentCache=tde(this.serializer),this.Ii=new hOe,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,u===!1&&Oa(om,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Tt(We.FAILED_PRECONDITION,hj);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new iu(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async n=>{n.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>AC(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((n=>{n||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((n=>this.isPrimary&&!n?this.Zi(e).next((()=>!1)):!!n&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(r0(e))return ft(om,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return ft(om,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return AE(e).get(f_).next((n=>xe.resolve(this.es(n))))}ts(e){return AC(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,cj)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(n=>{const r=Xs(n,s2);return r.J().next((i=>{const s=this.ss(i,cj),o=i.filter((a=>s.indexOf(a)===-1));return xe.forEach(o,(a=>r.delete(a.clientId))).next((()=>o))}))})).catch((()=>[]));if(this.Ki)for(const n of e)this.Ki.removeItem(this._s(n.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?xe.resolve(!0):AE(e).get(f_).next((n=>{if(n!==null&&this.rs(n.leaseTimestampMs,uj)&&!this.us(n.ownerId)){if(this.es(n)&&this.networkEnabled)return!0;if(!this.es(n)){if(!n.allowTabSynchronization)throw new Tt(We.FAILED_PRECONDITION,hj);return!1}}return!(!this.networkEnabled||!this.inForeground)||AC(e).J().next((r=>this.ss(r,uj).find((i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1}))===void 0))})).next((n=>(this.isPrimary!==n&&ft(om,`Client ${n?"is":"is not"} eligible for a primary lease.`),n)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[tI,s2],(e=>{const n=new x8(e,iu.ce);return this.Zi(n).next((()=>this.ts(n)))})),this.Ui.close(),this.Ps()}ss(e,n){return e.filter((r=>this.rs(r.updateTimeMs,n)&&!this.us(r.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>AC(e).J().next((n=>this.ss(n,cj).map((r=>r.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,n){return oO.wt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new _Oe(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return sO.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,n,r){ft(om,"Starting transaction:",e);const i=n==="readonly"?"readonly":"readwrite",s=(function(l){return l===18?y5e:l===17?Xue:l===16?g5e:l===15?yU:l===14?Yue:l===13?Kue:l===12?m5e:l===11?que:void Ht(60245)})(this.Ni);let o;return this.Ui.runTransaction(e,i,s,(a=>(o=new x8(a,this.ci?this.ci.next():iu.ce),n==="readwrite-primary"?this.Hi(o).next((l=>!!l||this.Yi(o))).next((l=>{if(!l)throw Oa(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new Tt(We.FAILED_PRECONDITION,$ue);return r(o)})).next((l=>this.Xi(o).next((()=>l)))):this.Is(o).next((()=>r(o)))))).then((a=>(o.raiseOnCommittedEvent(),a)))}Is(e){return AE(e).get(f_).next((n=>{if(n!==null&&this.rs(n.leaseTimestampMs,uj)&&!this.us(n.ownerId)&&!this.es(n)&&!(this.Oi||this.allowTabSynchronization&&n.allowTabSynchronization))throw new Tt(We.FAILED_PRECONDITION,hj)}))}Xi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return AE(e).put(f_,n)}static v(){return _g.v()}Zi(e){const n=AE(e);return n.get(f_).next((r=>this.es(r)?(ft(om,"Releasing primary lease."),n.delete(f_)):xe.resolve()))}rs(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(Oa(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){typeof this.window?.addEventListener=="function"&&(this.Bi=()=>{this.cs();const e=/(?:Version|Mobile)\/1[456]/;Fce()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){try{const n=this.Ki?.getItem(this._s(e))!==null;return ft(om,`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(n){return Oa(om,"Failed to get zombied client id.",n),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){Oa("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function AE(t){return Xs(t,tI)}function AC(t){return Xs(t,s2)}function $Oe(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}class NU{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.Es=r,this.ds=i}static As(e,n){let r=Hn(),i=Hn();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new NU(e,n.fromCache,r,i)}}class FOe{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class rde{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return Fce()?8:Vue(Ks())>0?6:4})()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.ys(e,n).next((o=>{s.result=o})).next((()=>{if(!s.result)return this.ws(e,n,i,r).next((o=>{s.result=o}))})).next((()=>{if(s.result)return;const o=new FOe;return this.Ss(e,n,o).next((a=>{if(s.result=a,this.Vs)return this.bs(e,n,o,a.size)}))})).next((()=>s.result))}bs(e,n,r,i){return r.documentReadCount<this.fs?(z_()<=tr.DEBUG&&ft("QueryEngine","SDK will not create cache indexes for query:",G_(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),xe.resolve()):(z_()<=tr.DEBUG&&ft("QueryEngine","Query:",G_(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?(z_()<=tr.DEBUG&&ft("QueryEngine","The SDK decides to create cache indexes for query:",G_(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,uu(n))):xe.resolve())}ys(e,n){if(IJ(n))return xe.resolve(null);let r=uu(n);return this.indexManager.getIndexType(e,r).next((i=>i===0?null:(n.limit!==null&&i===1&&(n=A8(n,null,"F"),r=uu(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next((s=>{const o=Hn(...s);return this.ps.getDocuments(e,o).next((a=>this.indexManager.getMinOffset(e,r).next((l=>{const c=this.Ds(n,a);return this.Cs(n,c,o,l.readTime)?this.ys(e,A8(n,null,"F")):this.vs(e,c,n,l)}))))})))))}ws(e,n,r,i){return IJ(n)||i.isEqual(an.min())?xe.resolve(null):this.ps.getDocuments(e,r).next((s=>{const o=this.Ds(n,s);return this.Cs(n,o,r,i)?xe.resolve(null):(z_()<=tr.DEBUG&&ft("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),G_(n)),this.vs(e,o,n,VNe(i,kk)).next((a=>a)))}))}Ds(e,n){let r=new Hr(ghe(e));return n.forEach(((i,s)=>{iI(e,s)&&(r=r.add(s))})),r}Cs(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ss(e,n,r){return z_()<=tr.DEBUG&&ft("QueryEngine","Using full collection scan to execute query:",G_(n)),this.ps.getDocumentsMatchingQuery(e,n,_c.min(),r)}vs(e,n,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next((s=>(n.forEach((o=>{s=s.insert(o.key,o)})),s)))}}const OU="LocalStore",VOe=3e8;class zOe{constructor(e,n,r,i){this.persistence=e,this.Fs=n,this.serializer=i,this.Ms=new ki(Rn),this.xs=new Sp((s=>M1(s)),nI),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new nde(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(n=>e.collect(n,this.Ms)))}}function ide(t,e,n,r){return new zOe(t,e,n,r)}async function sde(t,e){const n=Mn(t);return await n.persistence.runTransaction("Handle user change","readonly",(r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next((s=>(i=s,n.Bs(e),n.mutationQueue.getAllMutationBatches(r)))).next((s=>{const o=[],a=[];let l=Hn();for(const c of i){o.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}for(const c of s){a.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}return n.localDocuments.getDocuments(r,l).next((c=>({Ls:c,removedBatchIds:o,addedBatchIds:a})))}))}))}function GOe(t,e){const n=Mn(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const i=e.batch.keys(),s=n.Ns.newChangeBuffer({trackRemovals:!0});return(function(a,l,c,u){const h=c.batch,f=h.keys();let g=xe.resolve();return f.forEach((y=>{g=g.next((()=>u.getEntry(l,y))).next((_=>{const b=c.docVersions.get(y);rn(b!==null,48541),_.version.compareTo(b)<0&&(h.applyToRemoteDocument(_,c),_.isValidDocument()&&(_.setReadTime(c.commitVersion),u.addEntry(_)))}))})),g.next((()=>a.mutationQueue.removeMutationBatch(l,h)))})(n,r,e,s).next((()=>s.apply(r))).next((()=>n.mutationQueue.performConsistencyCheck(r))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(a){let l=Hn();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(l=l.add(a.batch.mutations[c].key));return l})(e)))).next((()=>n.localDocuments.getDocuments(r,i)))}))}function ode(t){const e=Mn(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(n=>e.Pi.getLastRemoteSnapshotVersion(n)))}function UOe(t,e){const n=Mn(t),r=e.snapshotVersion;let i=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(s=>{const o=n.Ns.newChangeBuffer({trackRemovals:!0});i=n.Ms;const a=[];e.targetChanges.forEach(((u,h)=>{const f=i.get(h);if(!f)return;a.push(n.Pi.removeMatchingKeys(s,u.removedDocuments,h).next((()=>n.Pi.addMatchingKeys(s,u.addedDocuments,h))));let g=f.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(h)!==null?g=g.withResumeToken(Ns.EMPTY_BYTE_STRING,an.min()).withLastLimboFreeSnapshotVersion(an.min()):u.resumeToken.approximateByteSize()>0&&(g=g.withResumeToken(u.resumeToken,r)),i=i.insert(h,g),(function(_,b,T){return _.resumeToken.approximateByteSize()===0||b.snapshotVersion.toMicroseconds()-_.snapshotVersion.toMicroseconds()>=VOe?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0})(f,g,u)&&a.push(n.Pi.updateTargetData(s,g))}));let l=uc(),c=Hn();if(e.documentUpdates.forEach((u=>{e.resolvedLimboDocuments.has(u)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,u))})),a.push(BOe(s,o,e.documentUpdates).next((u=>{l=u.ks,c=u.qs}))),!r.isEqual(an.min())){const u=n.Pi.getLastRemoteSnapshotVersion(s).next((h=>n.Pi.setTargetsMetadata(s,s.currentSequenceNumber,r)));a.push(u)}return xe.waitFor(a).next((()=>o.apply(s))).next((()=>n.localDocuments.getLocalViewOfDocuments(s,l,c))).next((()=>l))})).then((s=>(n.Ms=i,s)))}function BOe(t,e,n){let r=Hn(),i=Hn();return n.forEach((s=>r=r.add(s))),e.getEntries(t,r).next((s=>{let o=uc();return n.forEach(((a,l)=>{const c=s.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(a)),l.isNoDocument()&&l.version.isEqual(an.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):ft(OU,"Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)})),{ks:o,qs:i}}))}function WOe(t,e){const n=Mn(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=Jy),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function HOe(t,e){const n=Mn(t);return n.persistence.runTransaction("Allocate target","readwrite",(r=>{let i;return n.Pi.getTargetData(r,e).next((s=>s?(i=s,xe.resolve(i)):n.Pi.allocateTargetId(r).next((o=>(i=new qf(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Pi.addTargetData(r,i).next((()=>i)))))))})).then((r=>{const i=n.Ms.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(r.targetId,r),n.xs.set(e,r.targetId)),r}))}async function L8(t,e,n){const r=Mn(t),i=r.Ms.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,(o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!r0(o))throw o;ft(OU,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(i.target)}function sQ(t,e,n){const r=Mn(t);let i=an.min(),s=Hn();return r.persistence.runTransaction("Execute query","readwrite",(o=>(function(l,c,u){const h=Mn(l),f=h.xs.get(u);return f!==void 0?xe.resolve(h.Ms.get(f)):h.Pi.getTargetData(c,u)})(r,o,uu(e)).next((a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,a.targetId).next((l=>{s=l}))})).next((()=>r.Fs.getDocumentsMatchingQuery(o,e,n?i:an.min(),n?s:Hn()))).next((a=>(qOe(r,M5e(e),a),{documents:a,Qs:s})))))}function qOe(t,e,n){let r=t.Os.get(e)||an.min();n.forEach(((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)})),t.Os.set(e,r)}class oQ{constructor(){this.activeTargetIds=$5e()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class ade{constructor(){this.Mo=new oQ,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,r){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new oQ,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class KOe{Oo(e){}shutdown(){}}const aQ="ConnectivityMonitor";class lQ{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){ft(aQ,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){ft(aQ,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let IC=null;function D8(){return IC===null?IC=(function(){return 268435456+Math.round(2147483648*Math.random())})():IC++,"0x"+IC.toString(16)}const dj="RestConnection",YOe={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class XOe{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===p4?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,n,r,i,s){const o=D8(),a=this.zo(e,n.toUriEncodedString());ft(dj,`Sending RPC '${e}' ${o}:`,a,r);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,i,s);const{host:c}=new URL(a),u=lv(c);return this.Jo(e,a,l,r,u).then((h=>(ft(dj,`Received RPC '${e}' ${o}: `,h),h)),(h=>{throw C1(dj,`RPC '${e}' ${o} failed with error: `,h,"url: ",a,"request:",r),h}))}Ho(e,n,r,i,s,o){return this.Go(e,n,r,i,s)}jo(e,n,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Q2})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach(((i,s)=>e[s]=i)),r&&r.headers.forEach(((i,s)=>e[s]=i))}zo(e,n){const r=YOe[e];return`${this.Uo}/v1/${n}:${r}`}terminate(){}}class ZOe{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const Bo="WebChannelConnection";class JOe extends XOe{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,i,s){const o=D8();return new Promise(((a,l)=>{const c=new Aue;c.setWithCredentials(!0),c.listenOnce(Iue.COMPLETE,(()=>{try{switch(c.getLastErrorCode()){case nM.NO_ERROR:const h=c.getResponseJson();ft(Bo,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(h)),a(h);break;case nM.TIMEOUT:ft(Bo,`RPC '${e}' ${o} timed out`),l(new Tt(We.DEADLINE_EXCEEDED,"Request time out"));break;case nM.HTTP_ERROR:const f=c.getStatus();if(ft(Bo,`RPC '${e}' ${o} failed with status:`,f,"response text:",c.getResponseText()),f>0){let g=c.getResponseJson();Array.isArray(g)&&(g=g[0]);const y=g?.error;if(y&&y.status&&y.message){const _=(function(T){const A=T.toLowerCase().replace(/_/g,"-");return Object.values(We).indexOf(A)>=0?A:We.UNKNOWN})(y.status);l(new Tt(_,y.message))}else l(new Tt(We.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new Tt(We.UNAVAILABLE,"Connection failed."));break;default:Ht(9055,{l_:e,streamId:o,h_:c.getLastErrorCode(),P_:c.getLastError()})}}finally{ft(Bo,`RPC '${e}' ${o} completed.`)}}));const u=JSON.stringify(i);ft(Bo,`RPC '${e}' ${o} sending request:`,i),c.send(n,"POST",u,r,15)}))}T_(e,n,r){const i=D8(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Rue(),a=Cue(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,n,r),l.encodeInitMessageHeaders=!0;const u=s.join("");ft(Bo,`Creating RPC '${e}' stream ${i}: ${u}`,l);const h=o.createWebChannel(u,l);this.I_(h);let f=!1,g=!1;const y=new ZOe({Yo:b=>{g?ft(Bo,`Not sending because RPC '${e}' stream ${i} is closed:`,b):(f||(ft(Bo,`Opening RPC '${e}' stream ${i} transport.`),h.open(),f=!0),ft(Bo,`RPC '${e}' stream ${i} sending:`,b),h.send(b))},Zo:()=>h.close()}),_=(b,T,A)=>{b.listen(T,(I=>{try{A(I)}catch(P){setTimeout((()=>{throw P}),0)}}))};return _(h,sS.EventType.OPEN,(()=>{g||(ft(Bo,`RPC '${e}' stream ${i} transport opened.`),y.o_())})),_(h,sS.EventType.CLOSE,(()=>{g||(g=!0,ft(Bo,`RPC '${e}' stream ${i} transport closed`),y.a_(),this.E_(h))})),_(h,sS.EventType.ERROR,(b=>{g||(g=!0,C1(Bo,`RPC '${e}' stream ${i} transport errored. Name:`,b.name,"Message:",b.message),y.a_(new Tt(We.UNAVAILABLE,"The operation could not be completed")))})),_(h,sS.EventType.MESSAGE,(b=>{if(!g){const T=b.data[0];rn(!!T,16349);const A=T,I=A?.error||A[0]?.error;if(I){ft(Bo,`RPC '${e}' stream ${i} received error:`,I);const P=I.status;let R=(function(M){const O=xs[M];if(O!==void 0)return Phe(O)})(P),D=I.message;R===void 0&&(R=We.INTERNAL,D="Unknown error status: "+P+" with message "+I.message),g=!0,y.a_(new Tt(R,D)),h.close()}else ft(Bo,`RPC '${e}' stream ${i} received:`,T),y.u_(T)}})),_(a,Pue.STAT_EVENT,(b=>{b.stat===p8.PROXY?ft(Bo,`RPC '${e}' stream ${i} detected buffering proxy`):b.stat===p8.NOPROXY&&ft(Bo,`RPC '${e}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{y.__()}),0),y}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((n=>n===e))}}function QOe(){return typeof window<"u"?window:null}function dM(){return typeof document<"u"?document:null}function lO(t){return new eOe(t,!0)}class lde{constructor(e,n,r=1e3,i=1.5,s=6e4){this.Mi=e,this.timerId=n,this.d_=r,this.A_=i,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,n-r);i>0&&ft("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const cQ="PersistentStream";class cde{constructor(e,n,r,i,s,o,a,l){this.Mi=e,this.S_=r,this.b_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new lde(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===We.RESOURCE_EXHAUSTED?(Oa(n.toString()),Oa("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===We.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,i])=>{this.D_===n&&this.G_(r,i)}),(r=>{e((()=>{const i=new Tt(We.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)}))}))}G_(e,n){const r=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo((()=>{r((()=>this.listener.Xo()))})),this.stream.t_((()=>{r((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((i=>{r((()=>this.z_(i)))})),this.stream.onMessage((i=>{r((()=>++this.F_==1?this.J_(i):this.onNext(i)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return ft(cQ,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget((()=>this.D_===e?n():(ft(cQ,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class eLe extends cde{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=rOe(this.serializer,e),r=(function(s){if(!("targetChange"in s))return an.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?an.min():o.readTime?Va(o.readTime):an.min()})(e);return this.listener.H_(n,r)}Y_(e){const n={};n.database=C8(this.serializer),n.addTarget=(function(s,o){let a;const l=o.target;if(a=g4(l)?{documents:jhe(s,l)}:{query:$he(s,l).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=Mhe(s,o.resumeToken);const c=I8(s,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(an.min())>0){a.readTime=f2(s,o.snapshotVersion.toTimestamp());const c=I8(s,o.expectedCount);c!==null&&(a.expectedCount=c)}return a})(this.serializer,e);const r=sOe(this.serializer,e);r&&(n.labels=r),this.q_(n)}Z_(e){const n={};n.database=C8(this.serializer),n.removeTarget=e,this.q_(n)}}class tLe extends cde{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return rn(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,rn(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){rn(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=iOe(e.writeResults,e.commitTime),r=Va(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=C8(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map((r=>_4(this.serializer,r)))};this.q_(n)}}class nLe{}class rLe extends nLe{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new Tt(We.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,o])=>this.connection.Go(e,P8(n,r),i,s,o))).catch((s=>{throw s.name==="FirebaseError"?(s.code===We.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Tt(We.UNKNOWN,s.toString())}))}Ho(e,n,r,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,a])=>this.connection.Ho(e,P8(n,r),i,o,a,s))).catch((o=>{throw o.name==="FirebaseError"?(o.code===We.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Tt(We.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class iLe{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Oa(n),this.aa=!1):ft("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const D1="RemoteStore";class sLe{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo((o=>{r.enqueueAndForget((async()=>{hv(this)&&(ft(D1,"Restarting streams for network reachability change."),await(async function(l){const c=Mn(l);c.Ea.add(4),await oI(c),c.Ra.set("Unknown"),c.Ea.delete(4),await cO(c)})(this))}))})),this.Ra=new iLe(r,i)}}async function cO(t){if(hv(t))for(const e of t.da)await e(!0)}async function oI(t){for(const e of t.da)await e(!1)}function ude(t,e){const n=Mn(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),$U(n)?jU(n):tb(n).O_()&&DU(n,e))}function LU(t,e){const n=Mn(t),r=tb(n);n.Ia.delete(e),r.O_()&&hde(n,e),n.Ia.size===0&&(r.O_()?r.L_():hv(n)&&n.Ra.set("Unknown"))}function DU(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(an.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}tb(t).Y_(e)}function hde(t,e){t.Va.Ue(e),tb(t).Z_(e)}function jU(t){t.Va=new X5e({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),tb(t).start(),t.Ra.ua()}function $U(t){return hv(t)&&!tb(t).x_()&&t.Ia.size>0}function hv(t){return Mn(t).Ea.size===0}function dde(t){t.Va=void 0}async function oLe(t){t.Ra.set("Online")}async function aLe(t){t.Ia.forEach(((e,n)=>{DU(t,e)}))}async function lLe(t,e){dde(t),$U(t)?(t.Ra.ha(e),jU(t)):t.Ra.set("Unknown")}async function cLe(t,e,n){if(t.Ra.set("Online"),e instanceof Rhe&&e.state===2&&e.cause)try{await(async function(i,s){const o=s.cause;for(const a of s.targetIds)i.Ia.has(a)&&(await i.remoteSyncer.rejectListen(a,o),i.Ia.delete(a),i.Va.removeTarget(a))})(t,e)}catch(r){ft(D1,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await S4(t,r)}else if(e instanceof uM?t.Va.Ze(e):e instanceof Che?t.Va.st(e):t.Va.tt(e),!n.isEqual(an.min()))try{const r=await ode(t.localStore);n.compareTo(r)>=0&&await(function(s,o){const a=s.Va.Tt(o);return a.targetChanges.forEach(((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const u=s.Ia.get(c);u&&s.Ia.set(c,u.withResumeToken(l.resumeToken,o))}})),a.targetMismatches.forEach(((l,c)=>{const u=s.Ia.get(l);if(!u)return;s.Ia.set(l,u.withResumeToken(Ns.EMPTY_BYTE_STRING,u.snapshotVersion)),hde(s,l);const h=new qf(u.target,l,c,u.sequenceNumber);DU(s,h)})),s.remoteSyncer.applyRemoteEvent(a)})(t,n)}catch(r){ft(D1,"Failed to raise snapshot:",r),await S4(t,r)}}async function S4(t,e,n){if(!r0(e))throw e;t.Ea.add(1),await oI(t),t.Ra.set("Offline"),n||(n=()=>ode(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{ft(D1,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await cO(t)}))}function fde(t,e){return e().catch((n=>S4(t,n,e)))}async function aI(t){const e=Mn(t),n=Lg(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Jy;for(;uLe(e);)try{const i=await WOe(e.localStore,r);if(i===null){e.Ta.length===0&&n.L_();break}r=i.batchId,hLe(e,i)}catch(i){await S4(e,i)}pde(e)&&mde(e)}function uLe(t){return hv(t)&&t.Ta.length<10}function hLe(t,e){t.Ta.push(e);const n=Lg(t);n.O_()&&n.X_&&n.ea(e.mutations)}function pde(t){return hv(t)&&!Lg(t).x_()&&t.Ta.length>0}function mde(t){Lg(t).start()}async function dLe(t){Lg(t).ra()}async function fLe(t){const e=Lg(t);for(const n of t.Ta)e.ea(n.mutations)}async function pLe(t,e,n){const r=t.Ta.shift(),i=SU.from(r,e,n);await fde(t,(()=>t.remoteSyncer.applySuccessfulWrite(i))),await aI(t)}async function mLe(t,e){e&&Lg(t).X_&&await(async function(r,i){if((function(o){return q5e(o)&&o!==We.ABORTED})(i.code)){const s=r.Ta.shift();Lg(r).B_(),await fde(r,(()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i))),await aI(r)}})(t,e),pde(t)&&mde(t)}async function uQ(t,e){const n=Mn(t);n.asyncQueue.verifyOperationInProgress(),ft(D1,"RemoteStore received new credentials");const r=hv(n);n.Ea.add(3),await oI(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await cO(n)}async function gLe(t,e){const n=Mn(t);e?(n.Ea.delete(2),await cO(n)):e||(n.Ea.add(2),await oI(n),n.Ra.set("Unknown"))}function tb(t){return t.ma||(t.ma=(function(n,r,i){const s=Mn(n);return s.sa(),new eLe(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(t.datastore,t.asyncQueue,{Xo:oLe.bind(null,t),t_:aLe.bind(null,t),r_:lLe.bind(null,t),H_:cLe.bind(null,t)}),t.da.push((async e=>{e?(t.ma.B_(),$U(t)?jU(t):t.Ra.set("Unknown")):(await t.ma.stop(),dde(t))}))),t.ma}function Lg(t){return t.fa||(t.fa=(function(n,r,i){const s=Mn(n);return s.sa(),new tLe(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:dLe.bind(null,t),r_:mLe.bind(null,t),ta:fLe.bind(null,t),na:pLe.bind(null,t)}),t.da.push((async e=>{e?(t.fa.B_(),await aI(t)):(await t.fa.stop(),t.Ta.length>0&&(ft(D1,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))}))),t.fa}class FU{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new wd,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const o=Date.now()+r,a=new FU(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Tt(We.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function VU(t,e){if(Oa("AsyncQueue",`${e}: ${t}`),r0(t))return new Tt(We.UNAVAILABLE,`${e}: ${t}`);throw t}class ew{static emptySet(e){return new ew(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||At.comparator(n.key,r.key):(n,r)=>At.comparator(n.key,r.key),this.keyedMap=oS(),this.sortedSet=new ki(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((n,r)=>(e(n),!1)))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof ew)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach((n=>{e.push(n.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new ew;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}class hQ{constructor(){this.ga=new ki(At.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):Ht(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal(((n,r)=>{e.push(r)})),e}}class p2{constructor(e,n,r,i,s,o,a,l,c){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,n,r,i,s){const o=[];return n.forEach((a=>{o.push({type:0,doc:a})})),new p2(e,n,ew.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&eO(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}class yLe{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class vLe{constructor(){this.queries=dQ(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const i=Mn(n),s=i.queries;i.queries=dQ(),s.forEach(((o,a)=>{for(const l of a.Sa)l.onError(r)}))})(this,new Tt(We.ABORTED,"Firestore shutting down"))}}function dQ(){return new Sp((t=>mhe(t)),eO)}async function gde(t,e){const n=Mn(t);let r=3;const i=e.query;let s=n.queries.get(i);s?!s.ba()&&e.Da()&&(r=2):(s=new yLe,r=e.Da()?0:1);try{switch(r){case 0:s.wa=await n.onListen(i,!0);break;case 1:s.wa=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(o){const a=VU(o,`Initialization of query '${G_(e.query)}' failed`);return void e.onError(a)}n.queries.set(i,s),s.Sa.push(e),e.va(n.onlineState),s.wa&&e.Fa(s.wa)&&zU(n)}async function yde(t,e){const n=Mn(t),r=e.query;let i=3;const s=n.queries.get(r);if(s){const o=s.Sa.indexOf(e);o>=0&&(s.Sa.splice(o,1),s.Sa.length===0?i=e.Da()?0:1:!s.ba()&&e.Da()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function _Le(t,e){const n=Mn(t);let r=!1;for(const i of e){const s=i.query,o=n.queries.get(s);if(o){for(const a of o.Sa)a.Fa(i)&&(r=!0);o.wa=i}}r&&zU(n)}function xLe(t,e,n){const r=Mn(t),i=r.queries.get(e);if(i)for(const s of i.Sa)s.onError(n);r.queries.delete(e)}function zU(t){t.Ca.forEach((e=>{e.next()}))}var j8,fQ;(fQ=j8||(j8={})).Ma="default",fQ.Cache="cache";class vde{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new p2(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=p2.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==j8.Cache}}class _de{constructor(e){this.key=e}}class xde{constructor(e){this.key=e}}class wLe{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Hn(),this.mutatedKeys=Hn(),this.eu=ghe(e),this.tu=new ew(this.eu)}get nu(){return this.Ya}ru(e,n){const r=n?n.iu:new hQ,i=n?n.tu:this.tu;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(((u,h)=>{const f=i.get(u),g=iI(this.query,h)?h:null,y=!!f&&this.mutatedKeys.has(f.key),_=!!g&&(g.hasLocalMutations||this.mutatedKeys.has(g.key)&&g.hasCommittedMutations);let b=!1;f&&g?f.data.isEqual(g.data)?y!==_&&(r.track({type:3,doc:g}),b=!0):this.su(f,g)||(r.track({type:2,doc:g}),b=!0,(l&&this.eu(g,l)>0||c&&this.eu(g,c)<0)&&(a=!0)):!f&&g?(r.track({type:0,doc:g}),b=!0):f&&!g&&(r.track({type:1,doc:f}),b=!0,(l||c)&&(a=!0)),b&&(g?(o=o.add(g),s=_?s.add(u):s.delete(u)):(o=o.delete(u),s=s.delete(u)))})),this.query.limit!==null)for(;o.size>this.query.limit;){const u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),s=s.delete(u.key),r.track({type:1,doc:u})}return{tu:o,iu:r,Cs:a,mutatedKeys:s}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort(((u,h)=>(function(g,y){const _=b=>{switch(b){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ht(20277,{Rt:b})}};return _(g)-_(y)})(u.type,h.type)||this.eu(u.doc,h.doc))),this.ou(r),i=i??!1;const a=n&&!i?this._u():[],l=this.Xa.size===0&&this.current&&!i?1:0,c=l!==this.Za;return this.Za=l,o.length!==0||c?{snapshot:new p2(this.query,e.tu,s,o,e.mutatedKeys,l===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new hQ,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((n=>this.Ya=this.Ya.add(n))),e.modifiedDocuments.forEach((n=>{})),e.removedDocuments.forEach((n=>this.Ya=this.Ya.delete(n))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Hn(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))}));const n=[];return e.forEach((r=>{this.Xa.has(r)||n.push(new xde(r))})),this.Xa.forEach((r=>{e.has(r)||n.push(new _de(r))})),n}cu(e){this.Ya=e.Qs,this.Xa=Hn();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return p2.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const GU="SyncEngine";class bLe{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class ELe{constructor(e){this.key=e,this.hu=!1}}class SLe{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Sp((a=>mhe(a)),eO),this.Iu=new Map,this.Eu=new Set,this.du=new ki(At.comparator),this.Au=new Map,this.Ru=new CU,this.Vu={},this.mu=new Map,this.fu=L1.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function TLe(t,e,n=!0){const r=kde(t);let i;const s=r.Tu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await wde(r,e,n,!0),i}async function kLe(t,e){const n=kde(t);await wde(n,e,!0,!1)}async function wde(t,e,n,r){const i=await HOe(t.localStore,uu(e)),s=i.targetId,o=t.sharedClientState.addLocalQueryTarget(s,n);let a;return r&&(a=await ALe(t,e,s,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&ude(t.remoteStore,i),a}async function ALe(t,e,n,r,i){t.pu=(h,f,g)=>(async function(_,b,T,A){let I=b.view.ru(T);I.Cs&&(I=await sQ(_.localStore,b.query,!1).then((({documents:C})=>b.view.ru(C,I))));const P=A&&A.targetChanges.get(b.targetId),R=A&&A.targetMismatches.get(b.targetId)!=null,D=b.view.applyChanges(I,_.isPrimaryClient,P,R);return mQ(_,b.targetId,D.au),D.snapshot})(t,h,f,g);const s=await sQ(t.localStore,e,!0),o=new wLe(e,s.Qs),a=o.ru(s.documents),l=sI.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),c=o.applyChanges(a,t.isPrimaryClient,l);mQ(t,n,c.au);const u=new bLe(e,n,o);return t.Tu.set(e,u),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),c.snapshot}async function ILe(t,e,n){const r=Mn(t),i=r.Tu.get(e),s=r.Iu.get(i.targetId);if(s.length>1)return r.Iu.set(i.targetId,s.filter((o=>!eO(o,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await L8(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),n&&LU(r.remoteStore,i.targetId),$8(r,i.targetId)})).catch(uv)):($8(r,i.targetId),await L8(r.localStore,i.targetId,!0))}async function PLe(t,e){const n=Mn(t),r=n.Tu.get(e),i=n.Iu.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),LU(n.remoteStore,r.targetId))}async function CLe(t,e,n){const r=Ade(t);try{const i=await(function(o,a){const l=Mn(o),c=Ur.now(),u=a.reduce(((g,y)=>g.add(y.key)),Hn());let h,f;return l.persistence.runTransaction("Locally write mutations","readwrite",(g=>{let y=uc(),_=Hn();return l.Ns.getEntries(g,u).next((b=>{y=b,y.forEach(((T,A)=>{A.isValidDocument()||(_=_.add(T))}))})).next((()=>l.localDocuments.getOverlayedDocuments(g,y))).next((b=>{h=b;const T=[];for(const A of a){const I=W5e(A,h.get(A.key).overlayedDocument);I!=null&&T.push(new Tp(A.key,I,ohe(I.value.mapValue),ua.exists(!0)))}return l.mutationQueue.addMutationBatch(g,c,T,a)})).next((b=>{f=b;const T=b.applyToLocalDocumentSet(h,_);return l.documentOverlayCache.saveOverlays(g,b.batchId,T)}))})).then((()=>({batchId:f.batchId,changes:vhe(h)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),(function(o,a,l){let c=o.Vu[o.currentUser.toKey()];c||(c=new ki(Rn)),c=c.insert(a,l),o.Vu[o.currentUser.toKey()]=c})(r,i.batchId,n),await lI(r,i.changes),await aI(r.remoteStore)}catch(i){const s=VU(i,"Failed to persist write");n.reject(s)}}async function bde(t,e){const n=Mn(t);try{const r=await UOe(n.localStore,e);e.targetChanges.forEach(((i,s)=>{const o=n.Au.get(s);o&&(rn(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.hu=!0:i.modifiedDocuments.size>0?rn(o.hu,14607):i.removedDocuments.size>0&&(rn(o.hu,42227),o.hu=!1))})),await lI(n,r,e)}catch(r){await uv(r)}}function pQ(t,e,n){const r=Mn(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Tu.forEach(((s,o)=>{const a=o.view.va(e);a.snapshot&&i.push(a.snapshot)})),(function(o,a){const l=Mn(o);l.onlineState=a;let c=!1;l.queries.forEach(((u,h)=>{for(const f of h.Sa)f.va(a)&&(c=!0)})),c&&zU(l)})(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function RLe(t,e,n){const r=Mn(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Au.get(e),s=i&&i.key;if(s){let o=new ki(At.comparator);o=o.insert(s,Qi.newNoDocument(s,an.min()));const a=Hn().add(s),l=new iO(an.min(),new Map,new ki(Rn),o,a);await bde(r,l),r.du=r.du.remove(s),r.Au.delete(e),UU(r)}else await L8(r.localStore,e,!1).then((()=>$8(r,e,n))).catch(uv)}async function MLe(t,e){const n=Mn(t),r=e.batch.batchId;try{const i=await GOe(n.localStore,e);Sde(n,r,null),Ede(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await lI(n,i)}catch(i){await uv(i)}}async function NLe(t,e,n){const r=Mn(t);try{const i=await(function(o,a){const l=Mn(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",(c=>{let u;return l.mutationQueue.lookupMutationBatch(c,a).next((h=>(rn(h!==null,37113),u=h.keys(),l.mutationQueue.removeMutationBatch(c,h)))).next((()=>l.mutationQueue.performConsistencyCheck(c))).next((()=>l.documentOverlayCache.removeOverlaysForBatchId(c,u,a))).next((()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,u))).next((()=>l.localDocuments.getDocuments(c,u)))}))})(r.localStore,e);Sde(r,e,n),Ede(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await lI(r,i)}catch(i){await uv(i)}}function Ede(t,e){(t.mu.get(e)||[]).forEach((n=>{n.resolve()})),t.mu.delete(e)}function Sde(t,e,n){const r=Mn(t);let i=r.Vu[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Vu[r.currentUser.toKey()]=i}}function $8(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach((r=>{t.Ru.containsKey(r)||Tde(t,r)}))}function Tde(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(LU(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),UU(t))}function mQ(t,e,n){for(const r of n)r instanceof _de?(t.Ru.addReference(r.key,e),OLe(t,r)):r instanceof xde?(ft(GU,"Document no longer in limbo: "+r.key),t.Ru.removeReference(r.key,e),t.Ru.containsKey(r.key)||Tde(t,r.key)):Ht(19791,{wu:r})}function OLe(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Eu.has(r)||(ft(GU,"New document in limbo: "+n),t.Eu.add(r),UU(t))}function UU(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new At(Ir.fromString(e)),r=t.fu.next();t.Au.set(r,new ELe(n)),t.du=t.du.insert(n,r),ude(t.remoteStore,new qf(uu(Q5(n.path)),r,"TargetPurposeLimboResolution",iu.ce))}}async function lI(t,e,n){const r=Mn(t),i=[],s=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach(((a,l)=>{o.push(r.pu(l,e,n).then((c=>{if((c||n)&&r.isPrimaryClient){const u=c?!c.fromCache:n?.targetChanges.get(l.targetId)?.current;r.sharedClientState.updateQueryState(l.targetId,u?"current":"not-current")}if(c){i.push(c);const u=NU.As(l.targetId,c);s.push(u)}})))})),await Promise.all(o),r.Pu.H_(i),await(async function(l,c){const u=Mn(l);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",(h=>xe.forEach(c,(f=>xe.forEach(f.Es,(g=>u.persistence.referenceDelegate.addReference(h,f.targetId,g))).next((()=>xe.forEach(f.ds,(g=>u.persistence.referenceDelegate.removeReference(h,f.targetId,g)))))))))}catch(h){if(!r0(h))throw h;ft(OU,"Failed to update sequence numbers: "+h)}for(const h of c){const f=h.targetId;if(!h.fromCache){const g=u.Ms.get(f),y=g.snapshotVersion,_=g.withLastLimboFreeSnapshotVersion(y);u.Ms=u.Ms.insert(f,_)}}})(r.localStore,s))}async function LLe(t,e){const n=Mn(t);if(!n.currentUser.isEqual(e)){ft(GU,"User change. New user:",e.toKey());const r=await sde(n.localStore,e);n.currentUser=e,(function(s,o){s.mu.forEach((a=>{a.forEach((l=>{l.reject(new Tt(We.CANCELLED,o))}))})),s.mu.clear()})(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await lI(n,r.Ls)}}function DLe(t,e){const n=Mn(t),r=n.Au.get(e);if(r&&r.hu)return Hn().add(r.key);{let i=Hn();const s=n.Iu.get(e);if(!s)return i;for(const o of s){const a=n.Tu.get(o);i=i.unionWith(a.view.nu)}return i}}function kde(t){const e=Mn(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=bde.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=DLe.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=RLe.bind(null,e),e.Pu.H_=_Le.bind(null,e.eventManager),e.Pu.yu=xLe.bind(null,e.eventManager),e}function Ade(t){const e=Mn(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=MLe.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=NLe.bind(null,e),e}class jk{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=lO(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return ide(this.persistence,new rde,e.initialUser,this.serializer)}Cu(e){return new RU(aO.mi,this.serializer)}Du(e){return new ade}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}jk.provider={build:()=>new jk};class jLe extends jk{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){rn(this.persistence.referenceDelegate instanceof E4,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new Jhe(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?ta.withCacheSize(this.cacheSizeBytes):ta.DEFAULT;return new RU((r=>E4.mi(r,n)),this.serializer)}}class $Le extends jk{constructor(e,n,r){super(),this.xu=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await Ade(this.xu.syncEngine),await aI(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return ide(this.persistence,new rde,e.initialUser,this.serializer)}Fu(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new Jhe(r,e.asyncQueue,n)}Mu(e,n){const r=new BNe(n,this.persistence);return new UNe(e.asyncQueue,r)}Cu(e){const n=$Oe(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?ta.withCacheSize(this.cacheSizeBytes):ta.DEFAULT;return new MU(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,QOe(),dM(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new ade}}class T4{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>pQ(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=LLe.bind(null,this.syncEngine),await gLe(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new vLe})()}createDatastore(e){const n=lO(e.databaseInfo.databaseId),r=(function(s){return new JOe(s)})(e.databaseInfo);return(function(s,o,a,l){return new rLe(s,o,a,l)})(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return(function(r,i,s,o,a){return new sLe(r,i,s,o,a)})(this.localStore,this.datastore,e.asyncQueue,(n=>pQ(this.syncEngine,n,0)),(function(){return lQ.v()?new lQ:new KOe})())}createSyncEngine(e,n){return(function(i,s,o,a,l,c,u){const h=new SLe(i,s,o,a,l,c);return u&&(h.gu=!0),h})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){await(async function(n){const r=Mn(n);ft(D1,"RemoteStore shutting down."),r.Ea.add(5),await oI(r),r.Aa.shutdown(),r.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}T4.provider={build:()=>new T4};class Ide{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Oa("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout((()=>{this.muted||e(n)}),0)}}const Dg="FirestoreClient";class FLe{constructor(e,n,r,i,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=Mo.UNAUTHENTICATED,this.clientId=hU.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,(async o=>{ft(Dg,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(r,(o=>(ft(Dg,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new wd;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=VU(n,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function fj(t,e){t.asyncQueue.verifyOperationInProgress(),ft(Dg,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener((async i=>{r.isEqual(i)||(await sde(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t._offlineComponents=e}async function gQ(t,e){t.asyncQueue.verifyOperationInProgress();const n=await VLe(t);ft(Dg,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener((r=>uQ(e.remoteStore,r))),t.setAppCheckTokenChangeListener(((r,i)=>uQ(e.remoteStore,i))),t._onlineComponents=e}async function VLe(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){ft(Dg,"Using user provided OfflineComponentProvider");try{await fj(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!(function(i){return i.name==="FirebaseError"?i.code===We.FAILED_PRECONDITION||i.code===We.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(n))throw n;C1("Error using user provided cache. Falling back to memory cache: "+n),await fj(t,new jk)}}else ft(Dg,"Using default OfflineComponentProvider"),await fj(t,new jLe(void 0));return t._offlineComponents}async function Pde(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(ft(Dg,"Using user provided OnlineComponentProvider"),await gQ(t,t._uninitializedComponentsProvider._online)):(ft(Dg,"Using default OnlineComponentProvider"),await gQ(t,new T4))),t._onlineComponents}function zLe(t){return Pde(t).then((e=>e.syncEngine))}async function Cde(t){const e=await Pde(t),n=e.eventManager;return n.onListen=TLe.bind(null,e.syncEngine),n.onUnlisten=ILe.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=kLe.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=PLe.bind(null,e.syncEngine),n}function GLe(t,e,n={}){const r=new wd;return t.asyncQueue.enqueueAndForget((async()=>(function(s,o,a,l,c){const u=new Ide({next:f=>{u.Nu(),o.enqueueAndForget((()=>yde(s,h)));const g=f.docs.has(a);!g&&f.fromCache?c.reject(new Tt(We.UNAVAILABLE,"Failed to get document because the client is offline.")):g&&f.fromCache&&l&&l.source==="server"?c.reject(new Tt(We.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(f)},error:f=>c.reject(f)}),h=new vde(Q5(a.path),u,{includeMetadataChanges:!0,qa:!0});return gde(s,h)})(await Cde(t),t.asyncQueue,e,n,r))),r.promise}function ULe(t,e,n={}){const r=new wd;return t.asyncQueue.enqueueAndForget((async()=>(function(s,o,a,l,c){const u=new Ide({next:f=>{u.Nu(),o.enqueueAndForget((()=>yde(s,h))),f.fromCache&&l.source==="server"?c.reject(new Tt(We.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(f)},error:f=>c.reject(f)}),h=new vde(a,u,{includeMetadataChanges:!0,qa:!0});return gde(s,h)})(await Cde(t),t.asyncQueue,e,n,r))),r.promise}function Rde(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}const yQ=new Map;const Mde="firestore.googleapis.com",vQ=!0;class _Q{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Tt(We.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Mde,this.ssl=vQ}else this.host=e.host,this.ssl=e.ssl??vQ;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Khe;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<wOe)throw new Tt(We.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}FNe("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Rde(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new Tt(We.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new Tt(We.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new Tt(We.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class uO{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new _Q({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Tt(We.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Tt(We.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new _Q(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new PNe;switch(r.type){case"firstParty":return new NNe(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Tt(We.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(n){const r=yQ.get(n);r&&(ft("ComponentProvider","Removing Datastore"),yQ.delete(n),r.terminate())})(this),Promise.resolve()}}function BLe(t,e,n,r={}){t=gu(t,uO);const i=lv(e),s=t._getSettings(),o={...s,emulatorOptions:t._getEmulatorOptions()},a=`${e}:${n}`;i&&(XG(`https://${a}`),ZG("Firestore",!0)),s.host!==Mde&&s.host!==a&&C1("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...s,host:a,ssl:i,emulatorOptions:r};if(!k1(l,o)&&(t._setSettings(l),r.mockUserToken)){let c,u;if(typeof r.mockUserToken=="string")c=r.mockUserToken,u=Mo.MOCK_USER;else{c=jce(r.mockUserToken,t._app?.options.projectId);const h=r.mockUserToken.sub||r.mockUserToken.user_id;if(!h)throw new Tt(We.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new Mo(h)}t._authCredentials=new CNe(new Nue(c,u))}}class nb{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new nb(this.firestore,e,this._query)}}class fs{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new xg(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new fs(this.firestore,e,this._key)}toJSON(){return{type:fs._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(eI(n,fs._jsonSchema))return new fs(e,r||null,new At(Ir.fromString(n.referencePath)))}}fs._jsonSchemaVersion="firestore/documentReference/1.0",fs._jsonSchema={type:Cs("string",fs._jsonSchemaVersion),referencePath:Cs("string")};class xg extends nb{constructor(e,n,r){super(e,n,Q5(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new fs(this.firestore,null,new At(e))}withConverter(e){return new xg(this.firestore,e,this._path)}}function xQ(t,e,...n){if(t=mo(t),Lue("collection","path",e),t instanceof uO){const r=Ir.fromString(e,...n);return cJ(r),new xg(t,null,r)}{if(!(t instanceof fs||t instanceof xg))throw new Tt(We.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ir.fromString(e,...n));return cJ(r),new xg(t.firestore,null,r)}}function jy(t,e,...n){if(t=mo(t),arguments.length===1&&(e=hU.newId()),Lue("doc","path",e),t instanceof uO){const r=Ir.fromString(e,...n);return lJ(r),new fs(t,null,new At(r))}{if(!(t instanceof fs||t instanceof xg))throw new Tt(We.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ir.fromString(e,...n));return lJ(r),new fs(t.firestore,t instanceof xg?t.converter:null,new At(r))}}const wQ="AsyncQueue";class bQ{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new lde(this,"async_queue_retry"),this._c=()=>{const r=dM();r&&ft(wQ,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=dM();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=dM();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const n=new wd;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise))).then((()=>n.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!r0(e))throw e;ft(wQ,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const n=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,Oa("INTERNAL UNHANDLED ERROR: ",EQ(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const i=FU.createAndSchedule(this,e,n,r,(s=>this.hc(s)));return this.tc.push(i),i}uc(){this.nc&&Ht(47125,{Pc:EQ(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((n,r)=>n.targetTimeMs-r.targetTimeMs));for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function EQ(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class s0 extends uO{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new bQ,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new bQ(e),this._firestoreClient=void 0,await e}}}function WLe(t,e){const n=typeof t=="object"?t:eU(),r=typeof t=="string"?t:p4,i=z5(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=Oce("firestore");s&&BLe(i,...s)}return i}function BU(t){if(t._terminated)throw new Tt(We.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||Nde(t),t._firestoreClient}function Nde(t){const e=t._freezeSettings(),n=(function(i,s,o,a){return new _5e(i,s,o,a.host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,Rde(a.experimentalLongPollingOptions),a.useFetchStreams,a.isUsingEmulator)})(t._databaseId,t._app?.options.appId||"",t._persistenceKey,e);t._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new FLe(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&(function(i){const s=i?._online.build();return{_offline:i?._offline.build(s),_online:s}})(t._componentsProvider))}function HLe(t,e){C1("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings();return qLe(t,T4.provider,{build:r=>new $Le(r,n.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function qLe(t,e,n){if((t=gu(t,s0))._firestoreClient||t._terminated)throw new Tt(We.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new Tt(We.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:n},Nde(t)}class Qc{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Qc(Ns.fromBase64String(e))}catch(n){throw new Tt(We.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Qc(Ns.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Qc._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(eI(e,Qc._jsonSchema))return Qc.fromBase64String(e.bytes)}}Qc._jsonSchemaVersion="firestore/bytes/1.0",Qc._jsonSchema={type:Cs("string",Qc._jsonSchemaVersion),bytes:Cs("string")};class hO{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new Tt(We.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ji(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class dO{constructor(e){this._methodName=e}}class bd{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new Tt(We.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new Tt(We.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Rn(this._lat,e._lat)||Rn(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:bd._jsonSchemaVersion}}static fromJSON(e){if(eI(e,bd._jsonSchema))return new bd(e.latitude,e.longitude)}}bd._jsonSchemaVersion="firestore/geoPoint/1.0",bd._jsonSchema={type:Cs("string",bd._jsonSchemaVersion),latitude:Cs("number"),longitude:Cs("number")};class Ed{constructor(e){this._values=(e||[]).map((n=>n))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Ed._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(eI(e,Ed._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((n=>typeof n=="number")))return new Ed(e.vectorValues);throw new Tt(We.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Ed._jsonSchemaVersion="firestore/vectorValue/1.0",Ed._jsonSchema={type:Cs("string",Ed._jsonSchemaVersion),vectorValues:Cs("object")};const KLe=/^__.*__$/;class YLe{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Tp(e,this.data,this.fieldMask,n,this.fieldTransforms):new eb(e,this.data,n,this.fieldTransforms)}}class Ode{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Tp(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function Lde(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ht(40011,{Ac:t})}}class WU{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new WU({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const n=this.path?.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){const n=this.path?.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return k4(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((n=>e.isPrefixOf(n)))!==void 0||this.fieldTransforms.find((n=>e.isPrefixOf(n.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(Lde(this.Ac)&&KLe.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class XLe{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||lO(e)}Cc(e,n,r,i=!1){return new WU({Ac:e,methodName:n,Dc:r,path:ji.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function fO(t){const e=t._freezeSettings(),n=lO(t._databaseId);return new XLe(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Dde(t,e,n,r,i,s={}){const o=t.Cc(s.merge||s.mergeFields?2:0,e,n,i);qU("Data must be an object, but it was:",o,r);const a=jde(r,o);let l,c;if(s.merge)l=new _l(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){const u=[];for(const h of s.mergeFields){const f=F8(e,h,n);if(!o.contains(f))throw new Tt(We.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);Fde(u,f)||u.push(f)}l=new _l(u),c=o.fieldTransforms.filter((h=>l.covers(h.field)))}else l=null,c=o.fieldTransforms;return new YLe(new aa(a),l,c)}class pO extends dO{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof pO}}class HU extends dO{_toFieldTransform(e){return new The(e.path,new u2)}isEqual(e){return e instanceof HU}}function ZLe(t,e,n,r){const i=t.Cc(1,e,n);qU("Data must be an object, but it was:",i,r);const s=[],o=aa.empty();i0(r,((l,c)=>{const u=KU(e,l,n);c=mo(c);const h=i.yc(u);if(c instanceof pO)s.push(u);else{const f=cI(c,h);f!=null&&(s.push(u),o.set(u,f))}}));const a=new _l(s);return new Ode(o,a,i.fieldTransforms)}function JLe(t,e,n,r,i,s){const o=t.Cc(1,e,n),a=[F8(e,r,n)],l=[i];if(s.length%2!=0)throw new Tt(We.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<s.length;f+=2)a.push(F8(e,s[f])),l.push(s[f+1]);const c=[],u=aa.empty();for(let f=a.length-1;f>=0;--f)if(!Fde(c,a[f])){const g=a[f];let y=l[f];y=mo(y);const _=o.yc(g);if(y instanceof pO)c.push(g);else{const b=cI(y,_);b!=null&&(c.push(g),u.set(g,b))}}const h=new _l(c);return new Ode(u,h,o.fieldTransforms)}function QLe(t,e,n,r=!1){return cI(n,t.Cc(r?4:3,e))}function cI(t,e){if($de(t=mo(t)))return qU("Unsupported field value:",e,t),jde(t,e);if(t instanceof dO)return(function(r,i){if(!Lde(i.Ac))throw i.Sc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)})(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,i){const s=[];let o=0;for(const a of r){let l=cI(a,i.wc(o));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}})(t,e)}return(function(r,i){if((r=mo(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return F5e(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=Ur.fromDate(r);return{timestampValue:f2(i.serializer,s)}}if(r instanceof Ur){const s=new Ur(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:f2(i.serializer,s)}}if(r instanceof bd)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Qc)return{bytesValue:Mhe(i.serializer,r._byteString)};if(r instanceof fs){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:AU(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Ed)return(function(o,a){return{mapValue:{fields:{[_U]:{stringValue:xU},[o2]:{arrayValue:{values:o.toArray().map((c=>{if(typeof c!="number")throw a.Sc("VectorValues must only contain numeric values.");return bU(a.serializer,c)}))}}}}}})(r,i);throw i.Sc(`Unsupported field value: ${W5(r)}`)})(t,e)}function jde(t,e){const n={};return Zue(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):i0(t,((r,i)=>{const s=cI(i,e.mc(r));s!=null&&(n[r]=s)})),{mapValue:{fields:n}}}function $de(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Ur||t instanceof bd||t instanceof Qc||t instanceof fs||t instanceof dO||t instanceof Ed)}function qU(t,e,n){if(!$de(n)||!Due(n)){const r=W5(n);throw r==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+r)}}function F8(t,e,n){if((e=mo(e))instanceof hO)return e._internalPath;if(typeof e=="string")return KU(t,e);throw k4("Field path arguments must be of type string or ",t,!1,void 0,n)}const eDe=new RegExp("[~\\*/\\[\\]]");function KU(t,e,n){if(e.search(eDe)>=0)throw k4(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new hO(...e.split("."))._internalPath}catch{throw k4(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function k4(t,e,n,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new Tt(We.INVALID_ARGUMENT,a+t+l)}function Fde(t,e){return t.some((n=>n.isEqual(e)))}class Vde{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new fs(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new tDe(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(YU("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class tDe extends Vde{data(){return super.data()}}function YU(t,e){return typeof e=="string"?KU(t,e):e instanceof hO?e._internalPath:e._delegate._internalPath}function nDe(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Tt(We.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class XU{}class rDe extends XU{}function iDe(t,e,...n){let r=[];e instanceof XU&&r.push(e),r=r.concat(n),(function(s){const o=s.filter((l=>l instanceof ZU)).length,a=s.filter((l=>l instanceof mO)).length;if(o>1||o>0&&a>0)throw new Tt(We.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const i of r)t=i._apply(t);return t}class mO extends rDe{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new mO(e,n,r)}_apply(e){const n=this._parse(e);return zde(e._query,n),new nb(e.firestore,e.converter,k8(e._query,n))}_parse(e){const n=fO(e.firestore);return(function(s,o,a,l,c,u,h){let f;if(c.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new Tt(We.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){TQ(h,u);const y=[];for(const _ of h)y.push(SQ(l,s,_));f={arrayValue:{values:y}}}else f=SQ(l,s,h)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||TQ(h,u),f=QLe(a,o,h,u==="in"||u==="not-in");return rr.create(c,u,f)})(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function sDe(t,e,n){const r=e,i=YU("where",t);return mO._create(i,r,n)}class ZU extends XU{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new ZU(e,n)}_parse(e){const n=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return n.length===1?n[0]:Br.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:((function(i,s){let o=i;const a=s.getFlattenedFilters();for(const l of a)zde(o,l),o=k8(o,l)})(e._query,n),new nb(e.firestore,e.converter,k8(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function SQ(t,e,n){if(typeof(n=mo(n))=="string"){if(n==="")throw new Tt(We.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!phe(e)&&n.indexOf("/")!==-1)throw new Tt(We.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Ir.fromString(n));if(!At.isDocumentKey(r))throw new Tt(We.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Ok(t,new At(r))}if(n instanceof fs)return Ok(t,n._key);throw new Tt(We.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${W5(n)}.`)}function TQ(t,e){if(!Array.isArray(t)||t.length===0)throw new Tt(We.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function zde(t,e){const n=(function(i,s){for(const o of i)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null})(t.filters,(function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(n!==null)throw n===e.op?new Tt(We.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Tt(We.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class oDe{convertValue(e,n="none"){switch(Ng(e)){case 0:return null;case 1:return e.booleanValue;case 2:return bi(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(mp(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Ht(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return i0(e,((i,s)=>{r[i]=this.convertValue(s,n)})),r}convertVectorValue(e){const n=e.fields?.[o2].arrayValue?.values?.map((r=>bi(r.doubleValue)));return new Ed(n)}convertGeoPoint(e){return new bd(bi(e.latitude),bi(e.longitude))}convertArray(e,n){return(e.values||[]).map((r=>this.convertValue(r,n)))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Z5(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Mk(e));default:return null}}convertTimestamp(e){const n=pp(e);return new Ur(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Ir.fromString(e);rn(Ghe(r),9688,{name:e});const i=new R1(r.get(1),r.get(3)),s=new At(r.popFirst(5));return i.isEqual(n)||Oa(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}function Gde(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class cS{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class t1 extends Vde{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new fM(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(YU("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Tt(We.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=t1._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}t1._jsonSchemaVersion="firestore/documentSnapshot/1.0",t1._jsonSchema={type:Cs("string",t1._jsonSchemaVersion),bundleSource:Cs("string","DocumentSnapshot"),bundleName:Cs("string"),bundle:Cs("string")};class fM extends t1{data(e={}){return super.data(e)}}class tw{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new cS(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach((n=>e.push(n))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach((r=>{e.call(n,new fM(this._firestore,this._userDataWriter,r.key,r,new cS(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new Tt(We.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=(function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map((a=>{const l=new fM(i._firestore,i._userDataWriter,a.doc.key,a.doc,new cS(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}}))}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter((a=>s||a.type!==3)).map((a=>{const l=new fM(i._firestore,i._userDataWriter,a.doc.key,a.doc,new cS(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let c=-1,u=-1;return a.type!==0&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),u=o.indexOf(a.doc.key)),{type:aDe(a.type),doc:l,oldIndex:c,newIndex:u}}))}})(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Tt(We.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=tw._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=hU.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],i=[];return this.docs.forEach((s=>{s._document!==null&&(n.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function aDe(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ht(61501,{type:t})}}function lDe(t){t=gu(t,fs);const e=gu(t.firestore,s0);return GLe(BU(e),t._key).then((n=>fDe(e,t,n)))}tw._jsonSchemaVersion="firestore/querySnapshot/1.0",tw._jsonSchema={type:Cs("string",tw._jsonSchemaVersion),bundleSource:Cs("string","QuerySnapshot"),bundleName:Cs("string"),bundle:Cs("string")};class Ude extends oDe{constructor(e){super(),this.firestore=e}convertBytes(e){return new Qc(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new fs(this.firestore,null,n)}}function cDe(t){t=gu(t,nb);const e=gu(t.firestore,s0),n=BU(e),r=new Ude(e);return nDe(t._query),ULe(n,t._query).then((i=>new tw(e,r,t,i)))}function pj(t,e,n){t=gu(t,fs);const r=gu(t.firestore,s0),i=Gde(t.converter,e,n);return gO(r,[Dde(fO(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,ua.none())])}function uDe(t,e,n,...r){t=gu(t,fs);const i=gu(t.firestore,s0),s=fO(i);let o;return o=typeof(e=mo(e))=="string"||e instanceof hO?JLe(s,"updateDoc",t._key,e,n,r):ZLe(s,"updateDoc",t._key,e),gO(i,[o.toMutation(t._key,ua.exists(!0))])}function hDe(t){return gO(gu(t.firestore,s0),[new rO(t._key,ua.none())])}function dDe(t,e){const n=gu(t.firestore,s0),r=jy(t),i=Gde(t.converter,e);return gO(n,[Dde(fO(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,ua.exists(!1))]).then((()=>r))}function gO(t,e){return(function(r,i){const s=new wd;return r.asyncQueue.enqueueAndForget((async()=>CLe(await zLe(r),i,s))),s.promise})(BU(t),e)}function fDe(t,e,n){const r=n.docs.get(e._key),i=new Ude(t);return new t1(t,i,e._key,r,new cS(n.hasPendingWrites,n.fromCache),e.converter)}function mj(){return new HU("serverTimestamp")}(function(e,n=!0){(function(i){Q2=i})(cv),A1(new Rg("firestore",((r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),a=new s0(new RNe(r.getProvider("auth-internal")),new ONe(o,r.getProvider("app-check-internal")),(function(c,u){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new Tt(We.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new R1(c.options.projectId,u)})(o,i),o);return s={useFetchStreams:n,...s},a._setSettings(s),a}),"PUBLIC").setMultipleInstances(!0)),_d(iJ,sJ,e),_d(iJ,sJ,"esm2020")})();const Bde="firebasestorage.googleapis.com",pDe="storageBucket",mDe=120*1e3,gDe=600*1e3;class Bd extends Ud{constructor(e,n,r=0){super(gj(e),`Firebase Storage: ${n} (${gj(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Bd.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return gj(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Nd;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Nd||(Nd={}));function gj(t){return"storage/"+t}function yDe(){const t="An unknown error occurred, please check the error payload for server response.";return new Bd(Nd.UNKNOWN,t)}function vDe(){return new Bd(Nd.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function _De(){return new Bd(Nd.CANCELED,"User canceled the upload/download.")}function xDe(t){return new Bd(Nd.INVALID_URL,"Invalid URL '"+t+"'.")}function wDe(t){return new Bd(Nd.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function kQ(t){return new Bd(Nd.INVALID_ARGUMENT,t)}function Wde(){return new Bd(Nd.APP_DELETED,"The Firebase app was deleted.")}function bDe(t){return new Bd(Nd.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}class ah{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=ah.makeFromUrl(e,n)}catch{return new ah(e,"")}if(r.path==="")return r;throw wDe(e)}static makeFromUrl(e,n){let r=null;const i="([A-Za-z0-9.\\-_]+)";function s(P){P.path.charAt(P.path.length-1)==="/"&&(P.path_=P.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+i+o,"i"),l={bucket:1,path:3};function c(P){P.path_=decodeURIComponent(P.path)}const u="v[A-Za-z0-9_]+",h=n.replace(/[.]/g,"\\."),f="(/([^?#]*).*)?$",g=new RegExp(`^https?://${h}/${u}/b/${i}/o${f}`,"i"),y={bucket:1,path:3},_=n===Bde?"(?:storage.googleapis.com|storage.cloud.google.com)":n,b="([^?#]*)",T=new RegExp(`^https?://${_}/${i}/${b}`,"i"),I=[{regex:a,indices:l,postModify:s},{regex:g,indices:y,postModify:c},{regex:T,indices:{bucket:1,path:2},postModify:c}];for(let P=0;P<I.length;P++){const R=I[P],D=R.regex.exec(e);if(D){const C=D[R.indices.bucket];let M=D[R.indices.path];M||(M=""),r=new ah(C,M),R.postModify(r);break}}if(r==null)throw xDe(e);return r}}class EDe{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function SDe(t,e,n){let r=1,i=null,s=null,o=!1,a=0;function l(){return a===2}let c=!1;function u(...b){c||(c=!0,e.apply(null,b))}function h(b){i=setTimeout(()=>{i=null,t(g,l())},b)}function f(){s&&clearTimeout(s)}function g(b,...T){if(c){f();return}if(b){f(),u.call(null,b,...T);return}if(l()||o){f(),u.call(null,b,...T);return}r<64&&(r*=2);let I;a===1?(a=2,I=0):I=(r+Math.random())*1e3,h(I)}let y=!1;function _(b){y||(y=!0,f(),!c&&(i!==null?(b||(a=2),clearTimeout(i),h(0)):b||(a=1)))}return h(0),s=setTimeout(()=>{o=!0,_(!0)},n),_}function TDe(t){t(!1)}function kDe(t){return t!==void 0}function AQ(t,e,n,r){if(r<e)throw kQ(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw kQ(`Invalid value for '${t}'. Expected ${n} or less.`)}function ADe(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const i=e(r)+"="+e(t[r]);n=n+i+"&"}return n=n.slice(0,-1),n}var A4;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(A4||(A4={}));function IDe(t,e){const n=t>=500&&t<600,i=[408,429].indexOf(t)!==-1,s=e.indexOf(t)!==-1;return n||i||s}class PDe{constructor(e,n,r,i,s,o,a,l,c,u,h,f=!0,g=!1){this.url_=e,this.method_=n,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=u,this.connectionFactory_=h,this.retry=f,this.isUsingEmulator=g,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((y,_)=>{this.resolve_=y,this.reject_=_,this.start_()})}start_(){const e=(r,i)=>{if(i){r(!1,new PC(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const o=a=>{const l=a.loaded,c=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const a=s.getErrorCode()===A4.NO_ERROR,l=s.getStatus();if(!a||IDe(l,this.additionalRetryCodes_)&&this.retry){const u=s.getErrorCode()===A4.ABORT;r(!1,new PC(!1,null,u));return}const c=this.successCodes_.indexOf(l)!==-1;r(!0,new PC(c,s))})},n=(r,i)=>{const s=this.resolve_,o=this.reject_,a=i.connection;if(i.wasSuccessCode)try{const l=this.callback_(a,a.getResponse());kDe(l)?s(l):s()}catch(l){o(l)}else if(a!==null){const l=yDe();l.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(i.canceled){const l=this.appDelete_?Wde():_De();o(l)}else{const l=vDe();o(l)}};this.canceled_?n(!1,new PC(!1,null,!0)):this.backoffId_=SDe(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&TDe(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class PC{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function CDe(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function RDe(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function MDe(t,e){e&&(t["X-Firebase-GMPID"]=e)}function NDe(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function ODe(t,e,n,r,i,s,o=!0,a=!1){const l=ADe(t.urlParams),c=t.url+l,u=Object.assign({},t.headers);return MDe(u,e),CDe(u,n),RDe(u,s),NDe(u,r),new PDe(c,t.method,u,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,o,a)}function LDe(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function DDe(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}class I4{constructor(e,n){this._service=e,n instanceof ah?this._location=n:this._location=ah.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new I4(e,n)}get root(){const e=new ah(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return DDe(this._location.path)}get storage(){return this._service}get parent(){const e=LDe(this._location.path);if(e===null)return null;const n=new ah(this._location.bucket,e);return new I4(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw bDe(e)}}function IQ(t,e){const n=e?.[pDe];return n==null?null:ah.makeFromBucketSpec(n,t)}function jDe(t,e,n,r={}){t.host=`${e}:${n}`;const i=lv(e);i&&(XG(`https://${t.host}/b`),ZG("Storage",!0)),t._isUsingEmulator=!0,t._protocol=i?"https":"http";const{mockUserToken:s}=r;s&&(t._overrideAuthToken=typeof s=="string"?s:jce(s,t.app.options.projectId))}class $De{constructor(e,n,r,i,s,o=!1){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._isUsingEmulator=o,this._bucket=null,this._host=Bde,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=mDe,this._maxUploadRetryTime=gDe,this._requests=new Set,i!=null?this._bucket=ah.makeFromBucketSpec(i,this._host):this._bucket=IQ(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=ah.makeFromBucketSpec(this._url,e):this._bucket=IQ(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){AQ("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){AQ("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(lc(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new I4(this,e)}_makeRequest(e,n,r,i,s=!0){if(this._deleted)return new EDe(Wde());{const o=ODe(e,this._appId,r,i,n,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,i).getPromise()}}const PQ="@firebase/storage",CQ="0.14.0";const Hde="storage";function FDe(t=eU(),e){t=mo(t);const r=z5(t,Hde).getImmediate({identifier:e}),i=Oce("storage");return i&&VDe(r,...i),r}function VDe(t,e,n,r={}){jDe(t,e,n,r)}function zDe(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new $De(n,r,i,e,cv)}function GDe(){A1(new Rg(Hde,zDe,"PUBLIC").setMultipleInstances(!0)),_d(PQ,CQ,""),_d(PQ,CQ,"esm2020")}GDe();const UDe={apiKey:"AIzaSyBcLuKvUr5XqEJTwOf9I0hqJ1o9g3kOZ-g",authDomain:"detectorapp-nl.firebaseapp.com",projectId:"detectorapp-nl",storageBucket:"detectorapp-nl.firebasestorage.app",messagingSenderId:"110954177210",appId:"1:110954177210:web:d77c9ed262ad92bc431883"},JU=Bce(UDe),$y=TNe(JU),Kf=WLe(JU);FDe(JU);HLe(Kf).catch(t=>{t.code==="failed-precondition"?console.warn("Offline persistence failed: Multiple tabs open"):t.code==="unimplemented"&&console.warn("Offline persistence not available in this browser")});const BDe={};function WDe(t,e){let n;try{n=t()}catch{return}return{getItem:i=>{var s;const o=l=>l===null?null:JSON.parse(l,void 0),a=(s=n.getItem(i))!=null?s:null;return a instanceof Promise?a.then(o):o(a)},setItem:(i,s)=>n.setItem(i,JSON.stringify(s,void 0)),removeItem:i=>n.removeItem(i)}}const $k=t=>e=>{try{const n=t(e);return n instanceof Promise?n:{then(r){return $k(r)(n)},catch(r){return this}}}catch(n){return{then(r){return this},catch(r){return $k(r)(n)}}}},HDe=(t,e)=>(n,r,i)=>{let s={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:b=>b,version:0,merge:(b,T)=>({...T,...b}),...e},o=!1;const a=new Set,l=new Set;let c;try{c=s.getStorage()}catch{}if(!c)return t((...b)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),n(...b)},r,i);const u=$k(s.serialize),h=()=>{const b=s.partialize({...r()});let T;const A=u({state:b,version:s.version}).then(I=>c.setItem(s.name,I)).catch(I=>{T=I});if(T)throw T;return A},f=i.setState;i.setState=(b,T)=>{f(b,T),h()};const g=t((...b)=>{n(...b),h()},r,i);let y;const _=()=>{var b;if(!c)return;o=!1,a.forEach(A=>A(r()));const T=((b=s.onRehydrateStorage)==null?void 0:b.call(s,r()))||void 0;return $k(c.getItem.bind(c))(s.name).then(A=>{if(A)return s.deserialize(A)}).then(A=>{if(A)if(typeof A.version=="number"&&A.version!==s.version){if(s.migrate)return s.migrate(A.state,A.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return A.state}).then(A=>{var I;return y=s.merge(A,(I=r())!=null?I:g),n(y,!0),h()}).then(()=>{T?.(y,void 0),o=!0,l.forEach(A=>A(y))}).catch(A=>{T?.(void 0,A)})};return i.persist={setOptions:b=>{s={...s,...b},b.getStorage&&(c=b.getStorage())},clearStorage:()=>{c?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>_(),hasHydrated:()=>o,onHydrate:b=>(a.add(b),()=>{a.delete(b)}),onFinishHydration:b=>(l.add(b),()=>{l.delete(b)})},_(),y||g},qDe=(t,e)=>(n,r,i)=>{let s={storage:WDe(()=>localStorage),partialize:_=>_,version:0,merge:(_,b)=>({...b,..._}),...e},o=!1;const a=new Set,l=new Set;let c=s.storage;if(!c)return t((..._)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),n(..._)},r,i);const u=()=>{const _=s.partialize({...r()});return c.setItem(s.name,{state:_,version:s.version})},h=i.setState;i.setState=(_,b)=>{h(_,b),u()};const f=t((..._)=>{n(..._),u()},r,i);i.getInitialState=()=>f;let g;const y=()=>{var _,b;if(!c)return;o=!1,a.forEach(A=>{var I;return A((I=r())!=null?I:f)});const T=((b=s.onRehydrateStorage)==null?void 0:b.call(s,(_=r())!=null?_:f))||void 0;return $k(c.getItem.bind(c))(s.name).then(A=>{if(A)if(typeof A.version=="number"&&A.version!==s.version){if(s.migrate)return[!0,s.migrate(A.state,A.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,A.state];return[!1,void 0]}).then(A=>{var I;const[P,R]=A;if(g=s.merge(R,(I=r())!=null?I:f),n(g,!0),P)return u()}).then(()=>{T?.(g,void 0),g=r(),o=!0,l.forEach(A=>A(g))}).catch(A=>{T?.(void 0,A)})};return i.persist={setOptions:_=>{s={...s,..._},_.storage&&(c=_.storage)},clearStorage:()=>{c?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>y(),hasHydrated:()=>o,onHydrate:_=>(a.add(_),()=>{a.delete(_)}),onFinishHydration:_=>(l.add(_),()=>{l.delete(_)})},s.skipHydration||y(),g||f},KDe=(t,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((BDe?"commercial":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),HDe(t,e)):qDe(t,e),Eh=KDe,Cn=yo()(Eh(t=>({defaultBackground:"CartoDB (licht)",showScaleBar:!0,gpsAutoStart:!1,showAccuracyCircle:!0,hapticFeedback:!0,vondstenLocalOnly:!0,showVondstButton:!1,showRouteRecordButton:!1,showLocalVondsten:!0,showCustomPointLayers:!0,fontScale:100,layerPanelFontScale:100,presetPanelFontScale:100,menuFontScale:100,weatherFontScale:100,voiceFeedbackEnabled:!1,showStepCounter:!1,showFontSliders:!1,showWeatherButton:!1,hideWelcomeModal:!1,setDefaultBackground:e=>t({defaultBackground:e}),setShowScaleBar:e=>t({showScaleBar:e}),setGpsAutoStart:e=>t({gpsAutoStart:e}),setShowAccuracyCircle:e=>t({showAccuracyCircle:e}),setHapticFeedback:e=>t({hapticFeedback:e}),setVondstenLocalOnly:e=>t({vondstenLocalOnly:e}),setShowVondstButton:e=>t({showVondstButton:e}),setShowRouteRecordButton:e=>t({showRouteRecordButton:e}),setShowLocalVondsten:e=>t({showLocalVondsten:e}),setShowCustomPointLayers:e=>t({showCustomPointLayers:e}),setFontScale:e=>t({fontScale:e}),setLayerPanelFontScale:e=>t({layerPanelFontScale:e}),setPresetPanelFontScale:e=>t({presetPanelFontScale:e}),setMenuFontScale:e=>t({menuFontScale:e}),setWeatherFontScale:e=>t({weatherFontScale:e}),setVoiceFeedbackEnabled:e=>t({voiceFeedbackEnabled:e}),setShowStepCounter:e=>t({showStepCounter:e}),setShowFontSliders:e=>t({showFontSliders:e}),setShowWeatherButton:e=>t({showWeatherButton:e}),setHideWelcomeModal:e=>t({hideWelcomeModal:e})}),{name:"detectorapp-settings",version:2,migrate:(t,e)=>e<2?{...t,showScaleBar:!0}:t})),yO=yo()(Z2((t,e)=>({user:null,accessToken:null,loading:!1,error:null,initialized:!1,setUser:n=>{t(r=>{r.user=n,r.loading=!1})},setLoading:n=>{t(r=>{r.loading=n})},setError:n=>{t(r=>{r.error=n})},setAccessToken:n=>{t(r=>{r.accessToken=n})},signInWithGoogle:async()=>{t(n=>{n.loading=!0,n.error=null});try{const n=new eh;await YZ($y,n)}catch(n){console.error("Google sign-in error:",n),t(r=>{r.error=n.message,r.loading=!1})}},connectGoogleFit:async()=>{t(n=>{n.loading=!0,n.error=null});try{const n=new eh;n.addScope("https://www.googleapis.com/auth/fitness.activity.read");const r=await YZ($y,n),i=eh.credentialFromResult(r);return i?.accessToken?(t(s=>{s.accessToken=i.accessToken||null,s.loading=!1}),console.log(" Google Fit gekoppeld"),!0):(t(s=>{s.loading=!1}),!1)}catch(n){return console.error("Google Fit connect error:",n),t(r=>{r.error=n.message,r.loading=!1}),!1}},logout:async()=>{t(n=>{n.loading=!0});try{await pue($y),t(n=>{n.accessToken=null})}catch(n){console.error("Logout error:",n),t(r=>{r.error=n.message,r.loading=!1})}},initAuth:()=>{e().initialized||(t(n=>{n.initialized=!0}),fue($y,n=>{t(r=>{r.user=n,r.loading=!1}),n&&Cn.getState().setVondstenLocalOnly(!1)}))}})));yo()(Z2((t,e)=>({vondsten:[],loading:!1,error:null,loadVondsten:async n=>{t(r=>{r.loading=!0});try{const r=iDe(xQ(Kf,"vondsten"),sDe("userId","==",n)),s=(await cDe(r)).docs.map(o=>({id:o.id,...o.data()}));t(o=>{o.vondsten=s,o.loading=!1})}catch(r){t(i=>{i.error=r.message,i.loading=!1})}},addVondst:async n=>{const r=new Date().toISOString(),i={...n,createdAt:r,updatedAt:r},s=await dDe(xQ(Kf,"vondsten"),i);return t(o=>{o.vondsten.push({...i,id:s.id})}),s.id},updateVondst:async(n,r)=>{const i=jy(Kf,"vondsten",n);await uDe(i,{...r,updatedAt:new Date().toISOString()}),t(s=>{const o=s.vondsten.findIndex(a=>a.id===n);o!==-1&&(s.vondsten[o]={...s.vondsten[o],...r})})},deleteVondst:async n=>{await hDe(jy(Kf,"vondsten",n)),t(r=>{r.vondsten=r.vondsten.filter(i=>i.id!==n)})}})));const CC=[{id:"detectie",name:"Detectie",icon:"Compass",layers:["AMK Monumenten","Gewaspercelen"],baseLayer:"CartoDB (licht)",isBuiltIn:!1},{id:"steentijd",name:"Steentijd",icon:"Mountain",layers:["Hunebedden","Grafheuvels","Terpen","FAMKE Steentijd","AMK Steentijd","AHN4 Multi-Hillshade NL","Labels Overlay"],baseLayer:"Luchtfoto",isBuiltIn:!1},{id:"romeins-midvroeg",name:"Romeins - Mid vroeg",icon:"Layers",layers:["Romeinse wegen (regio)","Romeinse Forten","AMK Romeins","AMK Vroege ME","Gewaspercelen","Kadastrale Grenzen"],isBuiltIn:!1},{id:"midlaat-nieuwetijd",name:"Mid laat - Nieuwe tijd",icon:"Grid",layers:["AMK Late ME","Kastelen","Essen","Rijksmonumenten","Gewaspercelen","Kadastrale Grenzen","Oude Kernen"],isBuiltIn:!1},{id:"woii-militair",name:"WOII & Militair",icon:"Target",layers:["WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Inundatiegebieden","Militaire Objecten"],isBuiltIn:!1},{id:"analyse",name:"Terrein Analyse",icon:"Search",layers:["IKAW","Geomorfologie","Bodemkaart","AHN4 Multi-Hillshade NL","AHN4 Hoogtekaart Kleur"],isBuiltIn:!1}],RQ=["Labels Overlay","TMK 1850","Bonnebladen 1900","Hunebedden","FAMKE Steentijd","Grafheuvels","Terpen","AMK Monumenten","AMK Romeins","AMK Steentijd","AMK Vroege ME","AMK Late ME","AMK Overig","Romeinse wegen (regio)","Romeinse wegen (Wereld)","Romeinse Forten","Kastelen","IKAW","Rijksmonumenten","Werelderfgoed","Religieus Erfgoed","Essen","WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Inundatiegebieden","Militaire Objecten","Paleokaart 800 n.Chr.","Paleokaart 100 n.Chr.","Paleokaart 500 v.Chr.","Paleokaart 1500 v.Chr.","Paleokaart 2750 v.Chr.","Paleokaart 5500 v.Chr.","Paleokaart 9000 v.Chr.","UIKAV Punten","UIKAV Vlakken","UIKAV Expert","UIKAV Buffer","UIKAV Indeling","AHN4 Hoogtekaart Kleur","AHN4 Hillshade NL","AHN4 Multi-Hillshade NL","AHN 0.5m","Veengebieden","Geomorfologie","Bodemkaart","Fossielen Nederland","Fossielen Belgi","Fossielen Duitsland","Fossielen Frankrijk","Parken","Speeltuinen","Musea","Strandjes","Kringloopwinkels","Gewaspercelen","Kadastrale Grenzen","Scheepswrakken","Woonheuvels ZH","Windmolens","Erfgoedlijnen","Oude Kernen","Relictenkaart Punten","Relictenkaart Lijnen","Relictenkaart Vlakken","Verdronken Dorpen"],qde=yo()(Eh((t,e)=>({presets:[...CC],customDefaults:null,applyPreset:n=>{const r=e().presets.find(s=>s.id===n);if(!r)return;const i=Bs.getState();RQ.forEach(s=>i.setLayerVisibility(s,!1)),r.layers.forEach(s=>i.setLayerVisibility(s,!0)),r.baseLayer&&["CartoDB (licht)","OpenStreetMap","Luchtfoto","TMK 1850","Bonnebladen 1900"].forEach(o=>{i.setLayerVisibility(o,o===r.baseLayer)}),console.log(` Preset toegepast: ${r.name}${r.baseLayer?` (${r.baseLayer})`:""}`)},createPreset:(n,r)=>{const i=Bs.getState(),s=Object.entries(i.visible).filter(([a,l])=>l&&RQ.includes(a)).map(([a])=>a),o={id:`custom-${Date.now()}`,name:n,icon:r,layers:s,isBuiltIn:!1};t(a=>({presets:[...a.presets,o]})),console.log(` Preset aangemaakt: ${n} met ${s.length} lagen`)},updatePreset:(n,r)=>{t(i=>({presets:i.presets.map(s=>s.id===n?{...s,...r}:s)}))},deletePreset:n=>{t(r=>({presets:r.presets.filter(i=>i.id!==n||i.isBuiltIn)}))},saveAsDefaults:()=>{const n=e().presets;t({customDefaults:[...n]}),console.log(" Presets opgeslagen als standaard")},resetToDefaults:()=>{const{customDefaults:n}=e();n?(t({presets:[...n]}),console.log(" Presets hersteld naar eigen standaard")):(t({presets:[...CC]}),console.log(" Presets hersteld naar originele standaard"))},resetToBuiltIn:()=>{t({presets:[...CC],customDefaults:null}),console.log(" Presets gereset naar originele instellingen")}}),{name:"detectorapp-presets",version:10,migrate:(t,e)=>e<10?{presets:[...CC]}:t})),MQ=["#ef4444","#f97316","#eab308","#22c55e","#06b6d4","#3b82f6","#8b5cf6","#ec4899"],uI=yo()(Eh((t,e)=>({layers:[],addLayer:n=>{const r=crypto.randomUUID(),i=e().layers.length,s=MQ[i%MQ.length];return t(o=>({layers:[...o.layers,{...n,id:r,createdAt:new Date().toISOString(),color:n.color||s,visible:n.visible??!0,opacity:n.opacity??1}]})),r},removeLayer:n=>t(r=>({layers:r.layers.filter(i=>i.id!==n)})),updateLayer:(n,r)=>t(i=>({layers:i.layers.map(s=>s.id===n?{...s,...r}:s)})),toggleVisibility:n=>t(r=>({layers:r.layers.map(i=>i.id===n?{...i,visible:!i.visible}:i)})),setOpacity:(n,r)=>t(i=>({layers:i.layers.map(s=>s.id===n?{...s,opacity:r}:s)})),setColor:(n,r)=>t(i=>({layers:i.layers.map(s=>s.id===n?{...s,color:r}:s)})),clearAll:()=>t({layers:[]})}),{name:"detectorapp-custom-layers",version:1})),YDe=["CartoDB (licht)","OpenStreetMap","Luchtfoto","Labels Overlay","Mijn Vondsten"],QU=yo()(Eh((t,e)=>({tier:"free",unlockedRegions:["nl"],devMode:!0,setTier:n=>t({tier:n}),unlockRegion:n=>t(r=>({unlockedRegions:r.unlockedRegions.includes(n)?r.unlockedRegions:[...r.unlockedRegions,n]})),lockRegion:n=>t(r=>({unlockedRegions:r.unlockedRegions.filter(i=>i!==n)})),setDevMode:n=>t({devMode:n}),isRegionUnlocked:n=>{const r=e();return r.devMode||r.tier==="pro"?!0:r.unlockedRegions.includes(n)},isLayerUnlocked:(n,r="free",i=["nl"])=>{const s=e();return s.devMode||YDe.includes(n)||r==="free"||s.tier==="pro"?!0:s.tier==="premium"?i.some(o=>s.unlockedRegions.includes(o)):!1},canAccessPremiumFeatures:()=>{const n=e();return n.devMode||n.tier!=="free"}}),{name:"detectorapp-subscription",version:1}));yo()(Eh(t=>({parkingLocation:null,showParkingButton:!0,setParkingLocation:e=>t({parkingLocation:e}),clearParkingLocation:()=>t({parkingLocation:null}),setShowParkingButton:e=>t({showParkingButton:e})}),{name:"detectorapp-parking"}));function NQ(){return new Date().toISOString().split("T")[0]}yo()(Eh((t,e)=>({steps:0,distance:0,startTime:null,isActive:!1,todaySteps:0,todayDate:NQ(),stepLength:.75,incrementStep:()=>{const n=e(),r=NQ(),i=n.todayDate===r?n.todaySteps+1:1;t({steps:n.steps+1,distance:(n.steps+1)*n.stepLength,todaySteps:i,todayDate:r})},resetSession:()=>{t({steps:0,distance:0,startTime:null})},setActive:n=>{t({isActive:n,startTime:n?Date.now():e().startTime})},setStepLength:n=>{const r=e();t({stepLength:n,distance:r.steps*n})}}),{name:"step-counter-storage",partialize:t=>({todaySteps:t.todaySteps,todayDate:t.todayDate,stepLength:t.stepLength})}));const OQ={sunAzimuth:315,sunElevation:45,verticalExaggeration:2,colorRamp:"terrain",minElevation:-5,maxElevation:50,showControls:!1};yo()(Eh(t=>({...OQ,setSunAzimuth:e=>t({sunAzimuth:e}),setSunElevation:e=>t({sunElevation:e}),setVerticalExaggeration:e=>t({verticalExaggeration:e}),setColorRamp:e=>t({colorRamp:e}),setMinElevation:e=>t({minElevation:e}),setMaxElevation:e=>t({maxElevation:e}),setShowControls:e=>t({showControls:e}),resetToDefaults:()=>t(OQ)}),{name:"detectorapp-hillshade"}));const XDe=()=>Math.random().toString(36).substring(2,9),ZDe={0:"Helder",1:"Overwegend helder",2:"Halfbewolkt",3:"Bewolkt",45:"Mist",48:"Rijp/mist",51:"Lichte motregen",53:"Motregen",55:"Dichte motregen",56:"Lichte ijzel",57:"Ijzel",61:"Lichte regen",63:"Regen",65:"Hevige regen",66:"Lichte ijsregen",67:"IJsregen",71:"Lichte sneeuw",73:"Sneeuw",75:"Hevige sneeuw",77:"Korrelsneeuw",80:"Lichte buien",81:"Buien",82:"Hevige buien",85:"Lichte sneeuwbuien",86:"Sneeuwbuien",95:"Onweer",96:"Onweer met hagel",99:"Zwaar onweer met hagel"};function JDe(t){const e=["N","NNO","NO","ONO","O","OZO","ZO","ZZO","Z","ZZW","ZW","WZW","W","WNW","NW","NNW"],n=Math.round(t/22.5)%16;return e[n]}const hT=yo()(Eh((t,e)=>({weatherData:null,isLoading:!1,error:null,savedLocations:[{id:"current",name:"Huidige locatie",lat:0,lon:0,isCurrentLocation:!0}],selectedLocationId:"current",weatherPanelOpen:!1,showBuienradar:!1,setWeatherData:n=>t({weatherData:n}),setIsLoading:n=>t({isLoading:n}),setError:n=>t({error:n}),addLocation:n=>t(r=>({savedLocations:[...r.savedLocations,{...n,id:XDe()}]})),removeLocation:n=>t(r=>({savedLocations:r.savedLocations.filter(i=>i.id!==n),selectedLocationId:r.selectedLocationId===n?"current":r.selectedLocationId})),setSelectedLocation:n=>t({selectedLocationId:n}),updateCurrentLocation:(n,r)=>t(i=>({savedLocations:i.savedLocations.map(s=>s.isCurrentLocation?{...s,lat:n,lon:r}:s)})),toggleWeatherPanel:()=>t(n=>({weatherPanelOpen:!n.weatherPanelOpen})),setWeatherPanelOpen:n=>t({weatherPanelOpen:n}),setShowBuienradar:n=>t({showBuienradar:n}),fetchWeather:async(n,r)=>{const{setIsLoading:i,setError:s,setWeatherData:o,savedLocations:a,selectedLocationId:l}=e();i(!0),s(null);try{const c=new URL("https://api.open-meteo.com/v1/forecast");c.searchParams.set("latitude",n.toString()),c.searchParams.set("longitude",r.toString()),c.searchParams.set("current","temperature_2m,relative_humidity_2m,apparent_temperature,precipitation,weather_code,wind_speed_10m,wind_direction_10m,wind_gusts_10m,cloud_cover,is_day,snow_depth"),c.searchParams.set("hourly","temperature_2m,precipitation,precipitation_probability,weather_code,wind_speed_10m,wind_direction_10m,relative_humidity_2m"),c.searchParams.set("daily","weather_code,temperature_2m_max,temperature_2m_min,precipitation_sum,precipitation_probability_max,wind_speed_10m_max,sunrise,sunset"),c.searchParams.set("minutely_15","precipitation"),c.searchParams.set("timezone","Europe/Amsterdam"),c.searchParams.set("forecast_days","7"),c.searchParams.set("past_days","7");const u=await fetch(c.toString());if(!u.ok)throw new Error("Kon weerdata niet ophalen");const h=await u.json();let f=0;const g=h.daily.temperature_2m_min||[],y=new Date().toISOString().split("T")[0],_=h.daily.time.indexOf(y);for(let O=_-1;O>=0&&g[O]<0;O--)f++;const b=a.find(O=>O.id===l)||a[0],T=new Date,A=[],I=[];if(h.minutely_15?.time&&h.minutely_15?.precipitation){const O=new Date(T.getTime()+72e5),j=new Date(T.getTime()+2880*60*1e3);for(let V=0;V<h.minutely_15.time.length;V++){const U=new Date(h.minutely_15.time[V]);U<T||(U<=O&&A.push({time:h.minutely_15.time[V],precipitation:h.minutely_15.precipitation[V]}),U<=j&&I.push({time:h.minutely_15.time[V],precipitation:h.minutely_15.precipitation[V]}))}}const P=T.getHours(),R=T.toISOString().split("T")[0],D=h.hourly.time.map((O,j)=>({time:O,temperature:h.hourly.temperature_2m[j],precipitation:h.hourly.precipitation[j],precipitationProbability:h.hourly.precipitation_probability[j],weatherCode:h.hourly.weather_code[j],windSpeed:h.hourly.wind_speed_10m[j],windDirection:h.hourly.wind_direction_10m[j],humidity:h.hourly.relative_humidity_2m[j]})).filter(O=>new Date(O.time)>=T).slice(0,24),C=h.daily.time.map((O,j)=>({date:O,temperatureMax:h.daily.temperature_2m_max[j],temperatureMin:h.daily.temperature_2m_min[j],precipitationSum:h.daily.precipitation_sum[j],precipitationProbability:h.daily.precipitation_probability_max[j],weatherCode:h.daily.weather_code[j],windSpeedMax:h.daily.wind_speed_10m_max[j],sunrise:h.daily.sunrise[j],sunset:h.daily.sunset[j]})).filter(O=>O.date>=R),M={location:{...b,lat:n,lon:r},current:{temperature:h.current.temperature_2m,apparentTemperature:h.current.apparent_temperature,humidity:h.current.relative_humidity_2m,precipitation:h.current.precipitation,weatherCode:h.current.weather_code,windSpeed:h.current.wind_speed_10m,windDirection:h.current.wind_direction_10m,windGusts:h.current.wind_gusts_10m,cloudCover:h.current.cloud_cover,isDay:h.current.is_day===1,snowDepth:h.current.snow_depth},hourly:D,daily:C,precipitation15min:A,precipitation48h:I,frostDays:f,lastUpdated:Date.now()};try{const O=new URL("https://air-quality-api.open-meteo.com/v1/air-quality");O.searchParams.set("latitude",n.toString()),O.searchParams.set("longitude",r.toString()),O.searchParams.set("current","grass_pollen,birch_pollen,alder_pollen,mugwort_pollen,ragweed_pollen,olive_pollen");const j=await fetch(O.toString());if(j.ok){const V=await j.json();if(V.current){const U=G=>Math.min(5,Math.round(G/20));M.pollen={grass:U(V.current.grass_pollen||0),birch:U(V.current.birch_pollen||0),alder:U(V.current.alder_pollen||0),mugwort:U(V.current.mugwort_pollen||0),ragweed:U(V.current.ragweed_pollen||0),olive:U(V.current.olive_pollen||0)}}}}catch{}o(M)}catch(c){s(c instanceof Error?c.message:"Onbekende fout")}finally{i(!1)}}}),{name:"detectorapp-weather",partialize:t=>({savedLocations:t.savedLocations,selectedLocationId:t.selectedLocationId,showBuienradar:t.showBuienradar})}));function QDe({target:t,viewOptions:e}){const n=Y.useRef(null),r=Y.useRef(null),i=gi(o=>o.setMap),s=Cn(o=>o.showScaleBar);return Y.useEffect(()=>{if(!n.current){const o={center:[5.1214,52.0907],zoom:8,rotation:0,minZoom:3,maxZoom:19,...e},a=new wRe({target:t,controls:[],view:new hd({center:Ni(o.center),zoom:o.zoom,rotation:o.rotation,minZoom:o.minZoom,maxZoom:o.maxZoom})});n.current=a,i(a),window.__olMap=a}return()=>{n.current&&(n.current.setTarget(void 0),i(null),window.__olMap=null)}},[t,e,i]),Y.useEffect(()=>{const o=n.current;o&&(s?r.current||(r.current=new SRe({units:"metric",bar:!1,text:!0,minWidth:80}),o.addControl(r.current)):r.current&&(o.removeControl(r.current),r.current=null))},[s]),n.current}function x(t,e,n,r){var i=arguments.length,s=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,n):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s}function fAt(t,e){return function(n,r){e(n,r,t)}}function pAt(t,e,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(u){try{c(r.next(u))}catch(h){o(h)}}function l(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?s(u.value):i(u.value).then(a,l)}c((r=r.apply(t,e||[])).next())})}function mAt(t,e,n){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var r,i;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=e[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=e[Symbol.dispose],n&&(i=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");i&&(r=function(){try{i.call(this)}catch(s){return Promise.reject(s)}}),t.stack.push({value:e,dispose:r,async:n})}else n&&t.stack.push({async:!0});return e}var e6e=typeof SuppressedError=="function"?SuppressedError:function(t,e,n){var r=new Error(n);return r.name="SuppressedError",r.error=t,r.suppressed=e,r};function gAt(t){function e(s){t.error=t.hasError?new e6e(s,t.error,"An error was suppressed during disposal."):s,t.hasError=!0}var n,r=0;function i(){for(;n=t.stack.pop();)try{if(!n.async&&r===1)return r=0,t.stack.push(n),Promise.resolve().then(i);if(n.dispose){var s=n.dispose.call(n.value);if(n.async)return r|=2,Promise.resolve(s).then(i,function(o){return e(o),i()})}else r|=1}catch(o){e(o)}if(r===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return i()}let eg;const So=globalThis;function ye(t){return typeof eg[t]=="function"?eg[t]=eg[t](So):eg[t]}eg=So.dojoConfig?.has||So.esriConfig?.has?{...So.dojoConfig?.has,...So.esriConfig?.has}:{},ye.add=(t,e,n,r)=>{(r||eg[t]===void 0)&&(eg[t]=e),n&&ye(t)},ye.cache=eg,ye.add("big-integer-warning-enabled",!0),ye.add("esri-deprecation-warnings",!0),ye.add("esri-tests-disable-screenshots",!1),ye.add("esri-tests-use-full-window",!1),ye.add("esri-tests-post-to-influx",!0),ye.add("esri-cim-animations-enable-status","enabled"),ye.add("esri-cim-animations-spotlight",!1),ye.add("esri-cim-animations-freeze-time",!1),(()=>{ye.add("host-webworker",So.WorkerGlobalScope!==void 0&&self instanceof So.WorkerGlobalScope);const t=typeof window<"u"&&typeof location<"u"&&typeof document<"u"&&window.location===location&&window.document===document;if(ye.add("host-browser",t),ye.add("host-node",!(typeof So.process!="object"||!So.process.versions?.node||!So.process.versions.v8)),ye.add("dom",t),ye("host-browser")){const e=navigator,n=e.userAgent,r=e.appVersion,i=parseFloat(r);if(ye.add("wp",parseFloat(n.split("Windows Phone")[1])||void 0),ye.add("msapp",parseFloat(n.split("MSAppHost/")[1])||void 0),ye.add("khtml",r.includes("Konqueror")?i:void 0),ye.add("edge",parseFloat(n.split("Edge/")[1])||void 0),ye.add("opr",parseFloat(n.split("OPR/")[1])||void 0),ye.add("webkit",!ye("wp")&&!ye("edge")&&parseFloat(n.split("WebKit/")[1])||void 0),ye.add("chrome",!ye("edge")&&!ye("opr")&&parseFloat(n.split("Chrome/")[1])||void 0),ye.add("android",!ye("wp")&&parseFloat(n.split("Android ")[1])||void 0),ye.add("safari",!r.includes("Safari")||ye("wp")||ye("chrome")||ye("android")||ye("edge")||ye("opr")?void 0:parseFloat(r.split("Version/")[1])),ye.add("mac",r.includes("Macintosh")),!ye("wp")&&/(iPhone|iPod|iPad)/.test(n)){const s=RegExp.$1.replace(/P/,"p"),o=/OS ([\d_]+)/.test(n)?RegExp.$1:"1",a=parseFloat(o.replace(/_/,".").replaceAll("_",""));ye.add(s,a),ye.add("ios",a)}ye("webkit")||(!n.includes("Gecko")||ye("wp")||ye("khtml")||ye("edge")||ye.add("mozilla",i),ye("mozilla")&&ye.add("ff",parseFloat(n.split("Firefox/")[1]||n.split("Minefield/")[1])||void 0))}})(),(()=>{if(So.navigator){const t=navigator.userAgent,e=/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini|IEMobile/i.test(t),n=/iPhone/i.test(t);e&&ye.add("esri-mobile",e),n&&ye.add("esri-iPhone",n),ye.add("esri-geolocation",!!navigator.geolocation)}ye.add("esri-wasm","WebAssembly"in So),ye.add("esri-performance-mode-frames-between-render",20),ye.add("esri-force-performance-mode",!1),ye.add("esri-shared-array-buffer",()=>{const t="SharedArrayBuffer"in So,e=So.crossOriginIsolated===!1;return t&&!e}),ye.add("wasm-simd",()=>{const t=[0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11];return WebAssembly.validate(new Uint8Array(t))}),ye.add("esri-atomics","Atomics"in So),ye.add("esri-workers","Worker"in So),ye.add("web-feat:cache","caches"in So),ye.add("esri-workers-arraybuffer-transfer",!ye("safari")||Number(ye("safari"))>=12),ye.add("workers-pool-size",8),ye.add("featurelayer-simplify-thresholds",[.5,.5,.5,.5]),ye.add("featurelayer-simplify-payload-size-factors",[1,1,4]),ye.add("featurelayer-fast-triangulation-enabled",!0),ye.add("featurelayer-animation-enabled",!0),ye.add("featurelayer-snapshot-enabled",!0),ye.add("featurelayer-snapshot-initial-tolerance",0),ye.add("featurelayer-snapshot-point-min-threshold",8e4),ye.add("featurelayer-snapshot-point-max-threshold",4e5),ye.add("featurelayer-snapshot-multipoint-min-threshold",2e4),ye.add("featurelayer-snapshot-multipoint-max-threshold",1e5),ye.add("featurelayer-snapshot-polygon-min-threshold",2e3),ye.add("featurelayer-snapshot-polygon-max-threshold",2e3),ye.add("featurelayer-snapshot-polyline-min-threshold",2e3),ye.add("featurelayer-snapshot-polyline-max-threshold",2e3),ye.add("featurelayer-snapshot-max-vertex-count",25e4),ye.add("featurelayer-snapshot-non-hosted-exceedslimit-enabled",!0),ye.add("featurelayer-snapshot-concurrency",4),ye.add("featurelayer-snapshot-coverage",.1),ye.add("featurelayer-query-max-depth",4),ye.add("featurelayer-query-pausing-enabled",!1),ye.add("featurelayer-query-tile-concurrency",4),ye.add("featurelayer-query-tile-max-features",6e5),ye.add("featurelayer-advanced-symbols",!1),ye.add("featurelayer-pbf",!0),ye.add("featurelayer-pbf-statistics",!1),ye.add("feature-layers-workers",!0),ye.add("feature-polyline-generalization-factor",1),ye.add("parquetlayer-full-query-feature-count",2e4),ye.add("parquetlayer-hittest-max-feature-count",1),ye.add("parquetlayer-persistence-enabled",!1),ye.add("mapview-transitions-duration",200),ye.add("mapview-essential-goto-duration",200),ye.add("mapview-srswitch-adjust-rotation-scale-threshold",24e6),ye.add("mapserver-pbf-version-support",10.81),ye.add("mapservice-popup-identify-max-tolerance",20),ye.add("request-queue-concurrency-hosted",16),ye.add("request-queue-concurrency-non-hosted",4),ye.add("curve-densification-coarse-segments",128),ye.add("curve-densification-max-segments",2e3),ye.add("curve-densification-min-segments",3),ye.add("curve-densification-pixel-deviation",.5),ye.add("view-readyState-waiting-delay",1e3),ye.add("gradient-depth-bias",.01),ye.add("gradient-depth-epsilon",1e-8),ye.add("enable-feature:esri-compress-textures",!0),ye("host-webworker")||ye("host-browser")&&(ye.add("esri-csp-restrictions",()=>{try{new Function}catch{return!0}return!1}),ye.add("esri-url-encodes-apostrophe",()=>{const t=window.document.createElement("a");return t.href="?'",t.href.includes("?%27")}))})();function yAt(t){}function t6e(t){return()=>t}function vAt(t){return t}var hl;let n6e=(hl=class{constructor(e=1){this._seed=e}set seed(e){this._seed=e??Math.random()*hl._m}getInt(){return this._seed=(hl._a*this._seed+hl._c)%hl._m,this._seed}getFloat(){return this.getInt()/(hl._m-1)}getIntRange(e,n){return Math.round(this.getFloatRange(e,n))}getFloatRange(e,n){const r=n-e;return e+this.getInt()/hl._m*r}},hl._m=2147483647,hl._a=48271,hl._c=0,hl);const r6e=1.5,_At=1/r6e,xAt=.5;function Kde(t){return t}function i6e(t,e=Kde){if(!t||t.length===0)return;let n=t[0],r=e(n);for(let i=1;i<t.length;++i){const s=t[i],o=Number(e(s));o>r&&(r=o,n=s)}return n}function wAt(t,e=Kde){return i6e(t,n=>-e(n))}function bAt(t,e){return e?t.filter((n,r,i)=>i.findIndex(e.bind(null,n))===r):Array.from(new Set(t))}function s6e(t,e,n,r,i,s,o){if(t==null&&r==null)return!0;e=Math.max(0,e),i=Math.max(0,i),n=Math.max(0,n<0?(t?.length??0)+n:n),s=Math.max(0,s<0?(r?.length??0)+s:s);const a=n-e;if(t==null||r==null||a!==s-i)return!1;if(o){for(let l=0;l<a;l++)if(!o(t[e+l],r[i+l]))return!1}else for(let l=0;l<a;l++)if(t[e+l]!==r[i+l])return!1;return!0}function vO(t,e,n){return s6e(t,0,t?.length??0,e,0,e?.length??0,n)}function EAt(){return(t,e)=>{if(t==null&&e==null)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}}function LQ(t,e,n){let r,i;return n?(r=e.filter(s=>!t.some(o=>n(o,s))),i=t.filter(s=>!e.some(o=>n(o,s)))):(r=e.filter(s=>!t.includes(s)),i=t.filter(s=>!e.includes(s))),{added:r,removed:i}}function SAt(t){return t&&typeof t.length=="number"}function TAt(t,e){const n=t.length;if(n===0)return[];const r=[];for(let i=0;i<n;i+=e)r.push(t.slice(i,i+e));return r}let Yde=class{constructor(){this.last=0}};const Xde=new Yde;function V8(t,e,n,r){r=r||Xde;const i=Math.max(0,r.last-10);for(let o=i;o<n;++o)if(t[o]===e)return r.last=o,o;const s=Math.min(i,n);for(let o=0;o<s;++o)if(t[o]===e)return r.last=o,o;return-1}function z8(t,e,n,r){const i=t.length,s=V8(t,e,i,r);if(s!==-1)return t[s]=t[i-1],t.pop(),e}const Ou=new Set;function o6e(t,e,n=t.length,r=e.length,i,s){if(r===0||n===0)return n;Ou.clear();for(let a=0;a<r;++a)Ou.add(e[a]);i=i||Xde;const o=Math.max(0,i.last-10);for(let a=o;a<n;++a)if(Ou.has(t[a])&&(s?.push(t[a]),Ou.delete(t[a]),t[a]=t[n-1],--n,--a,Ou.size===0||n===0))return Ou.clear(),n;for(let a=0;a<o;++a)if(Ou.has(t[a])&&(s?.push(t[a]),Ou.delete(t[a]),t[a]=t[n-1],--n,--a,Ou.size===0||n===0))return Ou.clear(),n;return Ou.clear(),n}function a6e(t,e){let n=0;for(let r=0;r<t.length;++r){const i=t[r];e(i,r)&&(t[n]=i,n++)}return t.length=n,t}function AAt(t,e,n){const r=t.length;if(e>=r)return t.slice();const i=Zde(n),s=new Set,o=[];for(;o.length<e;){const a=Math.floor(i()*r);s.has(a)||(s.add(a),o.push(t[a]))}return o}function Zde(t){return t?(DQ.seed=t,()=>DQ.getFloat()):Math.random}const DQ=new n6e;function IAt(t,e){if(!t)return t;const n=Zde(e);for(let r=t.length-1;r>0;r--){const i=Math.floor(n()*(r+1)),s=t[r];t[r]=t[i],t[i]=s}return t}function Jde(t,e){const n=t.indexOf(e);return n!==-1?(t.splice(n,1),e):null}function m2(t,e){return t!=null}const PAt=[];function CAt(t){return t instanceof ArrayBuffer}function eB(t){return t?.constructor?.name==="Int8Array"}function Qde(t){return t?.constructor?.name==="Uint8Array"}function efe(t){return t?.constructor?.name==="Uint8ClampedArray"}function tB(t){return t?.constructor?.name==="Int16Array"}function tfe(t){return t?.constructor?.name==="Uint16Array"}function nB(t){return t?.constructor?.name==="Int32Array"}function nfe(t){return t?.constructor?.name==="Uint32Array"}function l6e(t){return t?.constructor?.name==="Float16Array"}function _O(t){return t?.constructor?.name==="Float32Array"}function xO(t){return t?.constructor?.name==="Float64Array"}function c6e(t){return"buffer"in t}const rfe=1024;function RAt(t){return xO(t)||_O(t)||nB(t)||tB(t)||eB(t)}function MAt(t){return xO(t)||_O(t)}function NAt(t){return xO(t)?179769e303:l6e(t)?65504:_O(t)?3402823e32:nfe(t)?4294967295:tfe(t)?65535:Qde(t)||efe(t)?255:nB(t)?2147483647:tB(t)?32767:eB(t)?127:256}const OAt=-32768,LAt=-2147483648;function DAt(t){return t}function u6e(t,e){let n;for(n in t)t.hasOwnProperty(n)&&t[n]===void 0&&delete t[n];return t}function Ze(t){if(!t||typeof t!="object"||typeof t=="function")return t;const e=ofe(t);if(e!=null)return e;if(dT(t))return t.clone();if(ife(t))return t.map(Ze);if(sfe(t))throw new Error("Trying to clone an unclonable Accessor instance");const n={};for(const r of Object.getOwnPropertyNames(t))n[r]=Ze(t[r]);return n}function G8(t,e){if(!t||typeof t!="object"||typeof t=="function"||"HTMLElement"in globalThis&&t instanceof HTMLElement)return t;const n=ofe(t);if(n!=null)return n;if(ife(t)){let i=!0;const s=t.map(o=>{const a=G8(o,e);return o!=null&&a==null&&(i=!1),a});return i?s:null}if(dT(t))return t.clone(e);if(t instanceof File||t instanceof Blob)return t;if(sfe(t))return null;const r=new(Object.getPrototypeOf(t)).constructor;for(const i of Object.getOwnPropertyNames(t)){const s=t[i],o=G8(s);if(s!=null&&o==null)return null;r[i]=o}return r}function dT(t){return typeof t.clone=="function"}function ife(t){return typeof t.map=="function"&&typeof t.forEach=="function"}function sfe(t){return typeof t.notifyChange=="function"&&typeof t.watch=="function"}function jQ(t){if(Object.prototype.toString.call(t)!=="[object Object]")return!1;const e=Object.getPrototypeOf(t);return e===null||e===Object.prototype}function ofe(t){if(eB(t)||Qde(t)||efe(t)||tB(t)||tfe(t)||nB(t)||nfe(t)||_O(t)||xO(t))return t.slice();if(t instanceof Date)return new Date(t);if(t instanceof ArrayBuffer)return t.slice(0,t.byteLength);if(t instanceof Map){const e=new Map;for(const[n,r]of t)e.set(n,Ze(r));return e}if(t instanceof Set){const e=new Set;for(const n of t)e.add(Ze(n));return e}return null}function rB(t,e){return t===e||typeof t=="number"&&isNaN(t)&&typeof e=="number"&&isNaN(e)||typeof t?.getTime=="function"&&typeof e?.getTime=="function"&&t.getTime()===e.getTime()||!1}function afe(t,e){return t===e||(t==null||typeof t=="string"?t===e:typeof t=="number"?t===e||typeof e=="number"&&isNaN(t)&&isNaN(e):t instanceof Date?e instanceof Date&&t.getTime()===e.getTime():Array.isArray(t)?Array.isArray(e)&&vO(t,e):t instanceof Set?e instanceof Set&&d6e(t,e):t instanceof Map?e instanceof Map&&f6e(t,e):!!jQ(t)&&jQ(e)&&h6e(t,e))}function h6e(t,e){if(t===null||e===null)return!1;const n=Object.keys(t);if(e===null||Object.keys(e).length!==n.length)return!1;for(const r of n)if(t[r]!==e[r]||!Object.prototype.hasOwnProperty.call(e,r))return!1;return!0}function d6e(t,e){if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0}function f6e(t,e){if(t.size!==e.size)return!1;for(const[n,r]of t){const i=e.get(n);if(i!==r||i===void 0&&!e.has(n))return!1}return!0}function p6e(t,e,n=!1){return cfe(t,e,n)}function wO(t,e){if(e!=null)return e[t]||lfe(t.split("."),!1,e)}function rb(t,e,n){const r=t.split("."),i=r.pop(),s=lfe(r,!0,n);s&&i&&(s[i]=e)}function $Q(t,e){if(t==null&&e==null)return!1;if(t==null||e==null)return!0;if(typeof t=="object"){if(Array.isArray(t)){const n=e;if(t.length!==n.length)return!0;for(let r=0;r<t.length;r++)if($Q(t[r],n[r]))return!0;return!1}if(Object.keys(t).length!==Object.keys(e).length)return!0;for(const n in t)if($Q(t[n],e[n]))return!0;return!1}return t!==e}function lfe(t,e,n){let r=n;for(const i of t){if(r==null)return;if(!(i in r)){if(!e)return;r[i]={}}r=r[i]}return r}function cfe(t,e,n){return e?Object.keys(e).reduce((r,i)=>{if(i==="__proto__")return r;let s=r[i],o=e[i];return s===o?r:s===void 0?(r[i]=Ze(o),r):(Array.isArray(o)||Array.isArray(r)?(s=s?Array.isArray(s)?r[i]=s.slice():r[i]=[s]:r[i]=[],o&&(Array.isArray(o)||(o=[o]),n?o.forEach(a=>{s.includes(a)||s.push(a)}):r[i]=o.slice())):o&&typeof o=="object"?r[i]=cfe(s,o,n):r.hasOwnProperty(i)&&!e.hasOwnProperty(i)||(r[i]=o),r)},t||{}):t}function jAt(t,e){for(const n of Object.entries(t))if(e===n[1])return n[0]}function bO(t,e){return Object.values(t).includes(e)}const nr={apiKey:void 0,apiKeys:{scopes:[]},applicationName:"",applicationUrl:globalThis.location?.href,assetsPath:"",fontsUrl:"https://static.arcgis.com/fonts",geometryServiceUrl:"https://utility.arcgisonline.com/arcgis/rest/services/Geometry/GeometryServer",geoRSSServiceUrl:"https://utility.arcgis.com/sharing/rss",kmlServiceUrl:"https://utility.arcgis.com/sharing/kml",userPrivilegesApplied:!0,portalUrl:"https://www.arcgis.com",respectPrefersReducedMotion:!0,routeServiceUrl:"https://route-api.arcgis.com/arcgis/rest/services/World/Route/NAServer/Route_World",workers:{loaderConfig:{has:{},paths:{},map:{},packages:[]}},request:{crossOriginNoCorsDomains:null,httpsDomains:["arcgis.com","arcgisonline.com","esrikr.com","premiumservices.blackbridge.com","esripremium.accuweather.com","gbm.digitalglobe.com","firstlook.digitalglobe.com","msi.digitalglobe.com"],interceptors:[],internalInterceptors:[],maxUrlLength:2e3,priority:"high",proxyRules:[],proxyUrl:null,timeout:62e3,trustedServers:[],useIdentity:!0},log:{interceptors:[],level:null}};if(globalThis.esriConfig&&(p6e(nr,globalThis.esriConfig,!0),delete nr.has),!nr.assetsPath){{const t="4.34";nr.assetsPath=`https://js.arcgis.com/${t}/@arcgis/core/assets`}nr.defaultAssetsPath=nr.assetsPath}const m6e=/\{([^}]+)\}/g;function FQ(t){return t??""}function ufe(t,e){return e?t.replaceAll(m6e,typeof e=="object"?(n,r)=>FQ(wO(r,e)):(n,r)=>FQ(e(r))):t}function $At(t,e){return t.replaceAll(/([.$?*|{}()[\]\\/+\-^])/g,n=>e?.includes(n)?n:`\\${n}`)}function hfe(t){let e=0;for(let n=0;n<t.length;n++)e=(e<<5)-e+t.charCodeAt(n),e|=0;return e}let VQ;function FAt(t){return VQ??=new DOMParser,VQ.parseFromString(t||"","text/html").body.innerText||""}function VAt(t,e){return new RegExp(`{${e}}`,"ig").test(t)}function zAt(t,...e){let n=t[0];for(let r=0;r<e.length;++r)n+=e[r]+t[r+1];return n}const zQ={info:0,warn:1,error:2,none:3};var cs;let kt=(cs=class{constructor(e){this.level=null,this._module="",this._parent=null,this.writer=null,this._loggedMessages={error:new Map,warn:new Map,info:new Map},e.level!=null&&(this.level=e.level),e.writer!=null&&(this.writer=e.writer),this._module=e.module,cs._loggers.set(this.module,this);const n=this.module.lastIndexOf(".");n!==-1&&(this._parent=cs.getLogger(this.module.slice(0,n)))}get module(){return this._module}get parent(){return this._parent}error(...e){this._log("error","always",...e)}warn(...e){this._log("warn","always",...e)}info(...e){this._log("info","always",...e)}errorOnce(...e){this._log("error","once",...e)}warnOnce(...e){this._log("warn","once",...e)}infoOnce(...e){this._log("info","once",...e)}errorOncePerTick(...e){this._log("error","oncePerTick",...e)}warnOncePerTick(...e){this._log("warn","oncePerTick",...e)}infoOncePerTick(...e){this._log("info","oncePerTick",...e)}get test(){}static get test(){}static getLogger(e){return e=typeof e!="string"?e.declaredClass:e,cs._loggers.get(e)||new cs({module:e})}_log(e,n,...r){if(this._matchLevel(e)){if(n!=="always"&&!cs._throttlingDisabled){const i=y6e(r),s=this._loggedMessages[e].get(i);if(n==="once"&&s!=null||n==="oncePerTick"&&s&&s>=cs._tickCounter)return;this._loggedMessages[e].set(i,cs._tickCounter),cs._scheduleTickCounterIncrement()}for(const i of nr.log.interceptors)if(i(e,this.module,...r))return;this._inheritedWriter()(e,this.module,...r)}}_parentWithMember(e,n){let r=this;for(;r!=null;){const i=r[e];if(i!=null)return i;r=r.parent}return n}_inheritedWriter(){return this._parentWithMember("writer",g6e)}_matchLevel(e){const n=nr.log.level||"warn";return zQ[this._parentWithMember("level",n)]<=zQ[e]}static _scheduleTickCounterIncrement(){cs._tickCounterScheduled||(cs._tickCounterScheduled=!0,Promise.resolve().then(()=>{cs._tickCounter++,cs._tickCounterScheduled=!1}))}},cs._loggers=new Map,cs._tickCounter=0,cs._tickCounterScheduled=!1,cs._throttlingDisabled=!1,cs);function g6e(t,e,...n){console[t](`[${e}]`,...n)}function y6e(...t){return hfe(JSON.stringify(t,(n,r)=>typeof r!="object"||Array.isArray(r)?r:"[Object]"))}function v6e(t,e){return t.replaceAll(/\$\{([^\s:}]*)(?::([^\s:}]+))?\}/g,(n,r)=>r===""?"$":(wO(r,e)??"").toString())}let dfe=class{constructor(e,n,r=void 0){this.name=e,this.details=r,this.message=(n&&v6e(n,r))??""}toString(){return"["+this.name+"]: "+this.message}},Xe=class ffe extends dfe{constructor(e,n,r){super(e,n,r)}toJSON(){if(this.details!=null)try{return{name:this.name,message:this.message,details:JSON.parse(JSON.stringify(this.details,(e,n)=>{if(n&&typeof n=="object"&&typeof n.toJSON=="function")return n;try{return Ze(n)}catch{return"[object]"}}))}}catch(e){throw kt.getLogger("esri.core.Error").error(e),e}return{name:this.name,message:this.message,details:this.details}}static fromJSON(e){return new ffe(e.name,e.message,e.details)}};Xe.prototype.type="error";function P4(t){return t&&typeof t=="object"&&"toJSON"in t&&typeof t.toJSON=="function"}const _6e=/^https:\/\/([a-z\d-]+)(\.maps([^.]*))?\.arcgis\.com/i,x6e={devext:{customBaseUrl:"mapsdevext.arcgis.com",portalHostname:"devext.arcgis.com"},qaext:{customBaseUrl:"mapsqa.arcgis.com",portalHostname:"qaext.arcgis.com"},www:{customBaseUrl:"maps.arcgis.com",portalHostname:"www.arcgis.com"}};function GQ(t){const e=t?.match(_6e);if(!e)return null;const[,n,r,i]=e;if(!n)return null;let s=null,o=null,a=null;const{devext:l,qaext:c,www:u}=x6e;if(r)if(s=n,i)switch(i.toLowerCase()){case"devext":({customBaseUrl:o,portalHostname:a}=l);break;case"qa":({customBaseUrl:o,portalHostname:a}=c);break;default:return null}else({customBaseUrl:o,portalHostname:a}=u);else switch(n.toLowerCase()){case"devext":({customBaseUrl:o,portalHostname:a}=l);break;case"qaext":({customBaseUrl:o,portalHostname:a}=c);break;case"www":({customBaseUrl:o,portalHostname:a}=u);break;default:return null}return{customBaseUrl:o,isPortal:!1,portalHostname:a,urlKey:s}}function pfe(t){return/\/(sharing|usrsvcs)\/(appservices|servers)\//i.test(t)}function mfe(t){const e=/^https?:\/\/(?:cdn|[a-z\d-]+\.maps)\.arcgis\.com/i,n=/^https?:\/\/(?:cdndev|[a-z\d-]+\.mapsdevext)\.arcgis\.com/i,r=/^https?:\/\/(?:cdnqa|[a-z\d-]+\.mapsqa)\.arcgis\.com/i;return e.test(t)?t=t.replace(e,"https://www.arcgis.com"):n.test(t)?t=t.replace(n,"https://devext.arcgis.com"):r.test(t)&&(t=t.replace(r,"https://qaext.arcgis.com")),t}function gfe(t){const e=atob(t),n=new Uint8Array(e.length);for(let r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return n.buffer}function w6e(t){const e=new Uint8Array(t);let n="";for(let r=0;r<e.length;r++)n+=String.fromCharCode(e[r]);return btoa(n)}const b6e=()=>kt.getLogger("esri.core.urlUtils"),ib=nr.request,UQ="esri/config: esriConfig.request.proxyUrl is not set.",yfe=/^\s*[a-z][a-z0-9-+.]*:(?![0-9])/i,vfe=/^\s*http:/i,E6e=/^\s*https:/i,S6e=/^\s*file:/i,_fe=/:\d+$/,T6e=/^https?:\/\/[^/]+\.arcgis.com\/sharing(\/|$)/i,k6e=new RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?$"),A6e=new RegExp("^((([^[:]+):)?([^@]+)@)?(\\[([^\\]]+)\\]|([^[:]*))(:([0-9]+))?$");let nw=class{constructor(e=""){this.uri=e,this.scheme=null,this.authority=null,this.path=null,this.query=null,this.fragment=null,this.user=null,this.password=null,this.host=null,this.port=null;let n=this.uri.match(k6e);this.scheme=n[2]||(n[1]?"":null),this.authority=n[4]||(n[3]?"":null),this.path=n[5],this.query=n[7]||(n[6]?"":null),this.fragment=n[9]||(n[8]?"":null),this.authority!=null&&(n=this.authority.match(A6e),this.user=n[3]||null,this.password=n[4]||null,this.host=n[6]||n[7],this.port=n[9]||null)}toString(){return this.uri}};const RC={},I6e=new nw(nr.applicationUrl);let la=I6e;const P6e=C6e();let iB=P6e;const sB=()=>la,BAt=()=>iB;function C6e(){const t=la.path,e=t.slice(0,t.lastIndexOf("/")+1);return`${`${la.scheme}://${la.host}${la.port!=null?`:${la.port}`:""}`}${e}`}function Wa(t){if(!t)return null;const e={path:null,query:null},n=new nw(t),r=t.indexOf("?");return n.query===null?e.path=t:(e.path=t.slice(0,r),e.query=oB(n.query)),n.fragment&&(e.hash=n.fragment,n.query===null&&(e.path=e.path.slice(0,e.path.length-(n.fragment.length+1)))),e}function oB(t){const e=t.split("&"),n={};for(const r of e){if(!r)continue;const i=r.indexOf("=");let s,o;i<0?(s=decodeURIComponent(r),o=""):(s=decodeURIComponent(r.slice(0,i)),o=decodeURIComponent(r.slice(i+1)));let a=n[s];typeof a=="string"&&(a=n[s]=[a]),Array.isArray(a)?a.push(o):n[s]=o}return n}function Fk(t,e){return t?Object.keys(t).map(n=>{const r=t[n];if(r==null)return"";const i=encodeURIComponent(n)+"=",s=e?.[n];return s?i+encodeURIComponent(s(r)):Array.isArray(r)?r.map(o=>P4(o)?i+encodeURIComponent(JSON.stringify(o)):i+encodeURIComponent(o)).join("&"):P4(r)?i+encodeURIComponent(JSON.stringify(r)):i+encodeURIComponent(r)}).filter(n=>n).join("&"):""}function xfe(t=!1){let e,n=ib.proxyUrl;if(typeof t=="string"){e=j6e(t);const r=EO(t);r&&(n=r.proxyUrl)}else e=!!t;if(!n)throw b6e().warn(UQ),new Xe("urlUtils:proxy-not-set",UQ);return e&&B8()&&(n=hB(n)),Wa(n)}function WAt(t,e=!1){const n=EO(t);let r,i;if(n){const s=aB(n.proxyUrl);r=s.path,i=s.query?oB(s.query):null}else if(e){const s=xfe(t);r=s.path,i=s.query}if(r){const s=Wa(t);t=r+"?"+s.path;const o=Fk({...i,...s.query});o&&(t=`${t}?${o}`)}return t}const IE={path:"",query:""};function aB(t){const e=t.indexOf("?");return e!==-1?(IE.path=t.slice(0,e),IE.query=t.slice(e+1)):(IE.path=t,IE.query=null),IE}function wfe(t){return t=(t=R4(t=G6e(t=aB(t).path),!0)).toLowerCase()}function R6e(t){const e={proxyUrl:t.proxyUrl,urlPrefix:wfe(t.urlPrefix)},n=ib.proxyRules,r=e.urlPrefix;let i=n.length;for(let s=0;s<n.length;s++){const o=n[s].urlPrefix;if(r.startsWith(o)){if(r.length===o.length)return-1;i=s;break}o.startsWith(r)&&(i=s+1)}return n.splice(i,0,e),i}function EO(t){const e=ib.proxyRules,n=wfe(t);for(let r=0;r<e.length;r++)if(n.startsWith(e[r].urlPrefix))return e[r]}function HAt(t,e){if(!t||!e)return!1;t=C4(t),e=C4(e);const n=GQ(t),r=GQ(e);return n!=null&&r!=null?n.portalHostname===r.portalHostname:n==null&&r==null&&j1(t,e,!0)}function M6e(t,e){return t=C4(t),e=C4(e),R4(t)===R4(e)}function C4(t){const e=(t=wg(t)).indexOf("/sharing");return e>0?t.slice(0,e):t.replace(/\/+$/,"")}function U8(t,e=ib.interceptors){const n=r=>r instanceof RegExp?r.test(t):typeof r=="string"?t.startsWith(r):r==null;if(e){for(const r of e)if(Array.isArray(r.urls)){if(r.urls.some(n))return r}else if(n(r.urls))return r}return null}function j1(t,e,n=!1){if(!t||!e)return!1;const r=H8(t),i=H8(e);return!(!n&&r.scheme!==i.scheme)&&r.host!=null&&i.host!=null&&r.host.toLowerCase()===i.host.toLowerCase()&&r.port===i.port}function lB(t){if(typeof t=="string"){if(!El(t))return!0;t=H8(t)}if(j1(t,la))return!0;const e=ib.trustedServers||[];for(let n=0;n<e.length;n++){const r=N6e(e[n]);for(let i=0;i<r.length;i++)if(j1(t,r[i]))return!0}return!1}function N6e(t){return RC[t]||(uB(t)||Od(t)?RC[t]=[new nw(eu(t))]:RC[t]=[new nw(`http://${t}`),new nw(`https://${t}`)]),RC[t]}function eu(t,e=iB,n){return Od(t)?n?.preserveProtocolRelative?t:la.scheme==="http"&&la.authority===pc(t).slice(2)?`http:${t}`:`https:${t}`:uB(t)?t:hI(t.startsWith("/")?z6e(e):e,t)}function cB(t,e=iB,n){if(t==null||!El(t))return t;const r=wg(t),i=r.toLowerCase(),s=wg(e).toLowerCase().replace(/\/+$/,""),o=n?wg(n).toLowerCase().replace(/\/+$/,""):null;if(o&&!s.startsWith(o))return t;const a=(h,f,g)=>(g=h.indexOf(f,g))===-1?h.length:g;let l=a(i,"/",i.indexOf("//")+2),c=-1;for(;i.slice(0,l+1)===s.slice(0,l)+"/"&&(c=l+1,l!==i.length);)l=a(i,"/",l+1);if(c===-1||o&&c<o.length)return t;t=r.slice(c);const u=s.slice(c-1).replaceAll(/[^/]+/g,"").length;if(u>0)for(let h=0;h<u;h++)t=`../${t}`;else t=`./${t}`;return t}function wg(t){return t=W6e(t=B6e(t=U6e(t=eu(t=t.trim()))))}function hI(...t){const e=t.filter(m2);if(!e?.length)return;const n=[];if(El(e[0])){const i=e[0],s=i.indexOf("//");s!==-1&&(n.push(i.slice(0,s+1)),F6e(e[0])&&(n[0]+="/"),e[0]=i.slice(s+2))}else e[0].startsWith("/")&&n.push("");const r=e.reduce((i,s)=>s?i.concat(s.split("/")):i,[]);for(let i=0;i<r.length;i++){const s=r[i];s===".."&&n.length>0&&n[n.length-1]!==".."?n.pop():(!s&&i===r.length-1||s&&(s!=="."||n.length===0))&&n.push(s)}return n.join("/")}function pc(t,e=!1){if(t==null||dI(t)||dv(t))return null;let n=t.indexOf("://");if(n===-1&&Od(t))n=2;else{if(n===-1)return null;n+=3}const r=t.indexOf("/",n);return r!==-1&&(t=t.slice(0,r)),e&&(t=R4(t,!0)),t}function El(t){return Od(t)||uB(t)}function dI(t){return t!=null&&t.startsWith("blob:")}function dv(t){return t!=null&&t.startsWith("data:")}function O6e(t){const e=g2(t);return e?.isBase64?gfe(e.data):null}function qAt(t){return w6e(t).replaceAll("+","-").replaceAll("/","_").replace(/=+$/,"")}const L6e=/^data:(.*?)(;base64)?,(.*)$/;function g2(t){const e=t.match(L6e);if(!e)return null;const[,n,r,i]=e;return{mediaType:n,isBase64:!!r,data:i}}function bfe(t){return t.isBase64?`data:${t.mediaType};base64,${t.data}`:`data:${t.mediaType},${t.data}`}async function D6e(t){return(await fetch(t)).blob()}function KAt(t){const e=O6e(t);if(!e)return null;const n=g2(t);return new Blob([e],{type:n.mediaType})}function Od(t){return t!=null&&t.startsWith("/")&&t[1]==="/"}function uB(t){return t!=null&&yfe.test(t)}function j6e(t){return t!=null&&E6e.test(t)||la.scheme==="https"&&Od(t)}function $6e(t){return t!=null&&vfe.test(t)||la.scheme==="http"&&Od(t)}function F6e(t){return t!=null&&S6e.test(t)}function hB(t){return Od(t)?`https:${t}`:t.replace(vfe,"https:")}function V6e(){return la.scheme==="http"}function B8(){return la.scheme==="https"}function R4(t,e=!1){return Od(t)?t.slice(2):(t=t.replace(yfe,""),e&&t.length>1&&t.startsWith("/")&&t[1]==="/"&&(t=t.slice(2)),t)}function z6e(t){const e=t.indexOf("//"),n=t.indexOf("/",e+2);return n===-1?t:t.slice(0,n)}function YAt(t){let e=0;if(El(t)){const r=t.indexOf("//");r!==-1&&(e=r+2)}const n=t.lastIndexOf("/");return n<e?t:t.slice(0,n+1)}function XAt(t,e){if(!t)return"";const n=Wa(t).path.replace(/\/+$/,""),r=n.slice(n.lastIndexOf("/")+1);if(!e?.length)return r;const i=new RegExp(`\\.(${e.join("|")})$`,"i");return r.replace(i,"")}function G6e(t){return t.endsWith("/")?t:`${t}/`}function Efe(t){return t.replace(/\/+$/,"")}function U6e(t){if(/^https?:\/\//i.test(t)){const e=aB(t);t=(t=e.path.replaceAll(/\/{2,}/g,"/")).replace("/","//"),e.query&&(t+=`?${e.query}`)}return t}function B6e(t){return t.replace(/^(https?:\/\/)(arcgis\.com)/i,"$1www.$2")}function W6e(t){const e=ib.httpsDomains;if(!$6e(t))return t;const n=t.indexOf("/",7);let r;if(r=n===-1?t:t.slice(0,n),r=r.toLowerCase().slice(7),_fe.test(r)){if(!r.endsWith(":80"))return t;r=r.slice(0,-3),t=t.replace(":80","")}return V6e()&&r===la.authority&&!T6e.test(t)||(B8()&&r===la.authority||e&&e.some(i=>r===i||r.endsWith(`.${i}`))||B8()&&!EO(t))&&(t=hB(t)),t}function W8(t,e,n){if(!(e&&n&&t&&El(t)))return t;const r=t.indexOf("//"),i=t.indexOf("/",r+2),s=t.indexOf(":",r+2),o=Math.min(i<0?t.length:i,s<0?t.length:s);return t.slice(r+2,o).toLowerCase()!==e.toLowerCase()?t:`${t.slice(0,r+2)}${n}${t.slice(o)}`}function H6e(t,e){const n=new URL(t);return n.host=e,n.port&&!_fe.test(e)&&(n.port=""),n.toString()}function ZAt(t){return new URL(t).host}function H8(t){return typeof t=="string"?new nw(eu(t)):(t.scheme||(t.scheme=la.scheme),t)}function JAt(t){return K6e.test(t)}function Sfe(t,e){const n=Wa(t),r=Object.keys(n.query||{});return r.length>0&&e&&e.warn("removeQueryParameters()",`Url query parameters are not supported, the following parameters have been removed: ${r.join(", ")}.`),n.path}function q6e(t,e,n){const r=Wa(t),i=r.query||{};return i[e]=String(n),`${r.path}?${Fk(i)}`}function yj(t,e){if(!e)return t;const n=Wa(t),r=n.query||{};for(const[s,o]of Object.entries(e))o!=null&&(r[s]=o);const i=Fk(r);return i?`${n.path}?${i}`:n.path}function Tfe(t){if(t==null)return null;const e=t.match(kfe);return e?e[2]:null}function BQ(t){if(t==null)return null;const e=t.match(kfe);return e?{path:e[1],extension:e[2]}:{path:t,extension:null}}async function QAt(t){return typeof t=="string"?g2(t)??{data:t}:new Promise((e,n)=>{const r=new FileReader;r.readAsDataURL(t),r.onload=()=>e(g2(r.result)),r.onerror=i=>n(i)})}const kfe=/([^.]*)\.([^/]*)$/,K6e=/(^data:image\/svg|\.svg$)/i,Afe="20251114",Ife="ec088c999de2dac6fb9478a47da1bad775545540";Symbol.dispose??=Symbol("Symbol.dispose"),Symbol.asyncDispose??=Symbol("Symbol.asyncDispose");const Y6e="4.34";let Zr,dB=Y6e;function eIt(t){Zr=t}function tIt(t){const e=Zr?.findCredential(t);return e?.token?q6e(t,"token",e.token):t}dB="4.34.8",ye("host-webworker")||globalThis.$arcgis||Object.defineProperty(globalThis,"$arcgis",{configurable:!1,enumerable:!0,writable:!1,value:{}}),ye("host-webworker");function X6e(t,e){for(const n of t.values())if(e(n))return!0;return!1}function nIt(t,e){for(const n of t.values())if(!e(n))return!1;return!0}function rIt(t,e){for(const n of t.values())if(e(n))return n;return null}function fI(t,e,n){const r=t.get(e);if(r!==void 0)return r;const i=n();return t.set(e,i),i}function iIt(t){const e=new Map;return n=>(e.has(n)||e.set(n,t(n)),e.get(n))}const Z6e={remove:()=>{}};function Zn(t){return t?{remove(){t&&(t(),t=void 0)}}:Z6e}function Pfe(t){t.forEach(e=>e?.remove())}function sIt(t){Pfe(t),t.length=0}function fv(t){return Zn(()=>Pfe(t))}function oIt(t){return Zn(()=>t()?.remove())}function J6e(t){return Zn(()=>t?.abort())}function aIt(t){return Zn(t!=null?()=>t.destroy():void 0)}function Q6e(t){return typeof t=="object"&&!!t&&"remove"in t&&typeof t.remove=="function"}function lIt(t){Q6e(t)&&t.remove()}function cIt(t){return{[Symbol.dispose](){t.remove()}}}function eje(t){return{setTimeout:(e,n)=>{const r=t.setTimeout(e,n);return Zn(()=>t.clearTimeout(r))}}}const sb=eje(globalThis);function SO(t){return tje(t)||Cfe(t)}function tje(t){return t!=null&&typeof t=="object"&&"on"in t&&typeof t.on=="function"}function Cfe(t){return t!=null&&typeof t=="object"&&"addEventListener"in t&&typeof t.addEventListener=="function"}function ob(t,e,n){if(!SO(t))throw new TypeError("target is not a Evented or EventTarget object");return Cfe(t)?nje(t,e,n):t.on(e,n)}function nje(t,e,n,r){if(Array.isArray(e)){const i=e.slice();for(const s of i)t.addEventListener(s,n,r);return Zn(()=>{for(const s of i)t.removeEventListener(s,n,r)})}return t.addEventListener(e,n,r),Zn(()=>t.removeEventListener(e,n,r))}function Rfe(t,e,n){if(!SO(t))throw new TypeError("target is not a Evented or EventTarget object");if("once"in t)return t.once(e,n);const r=ob(t,e,i=>{r.remove(),n.call(t,i)});return r}function Mfe(t,e){if(t==null)throw new Error(e??"value is None")}function Di(t){return t?.destroy(),null}function uIt(t){return t?.dispose(),null}function ii(t){return t?.remove(),null}function $1(t){return t?.abort(),null}function hIt(t){return t?.release(),null}function dIt(t,e,n){return t!=null&&e!=null?n!=null?n(t,e):t.equals(e):t===e}function rje(t,e){let n;return t.some((r,i)=>(n=e(r,i),n!=null)),n??void 0}function Pr(t="Aborted"){return new Xe("AbortError",t)}function pi(t,e="Aborted"){if(ma(t))throw Pr(e)}function pI(t){return t instanceof AbortSignal?t:t?.signal??void 0}function ma(t){const e=pI(t);return e!=null&&e.aborted}function Nfe(t){if(wa(t))throw t}function WQ(t){if(!wa(t))throw t}function yu(t,e){const n=pI(t);if(n!=null){if(!n.aborted)return Rfe(n,"abort",()=>e());e()}}function fB(t,e){const n=pI(t);if(n!=null)return pi(n),Rfe(n,"abort",()=>e(Pr()))}function ije(t,e){return pI(e)==null?t:new Promise((n,r)=>{let i=yu(e,()=>r(Pr()));const s=()=>{i=ii(i)};t.then(s,s),t.then(n,r)})}function wa(t){return t?.name==="AbortError"}async function M4(t){try{return await t}catch(e){if(!wa(e))throw e;return}}async function pB(t){if(!t)return;if(typeof t.forEach!="function"){const n=Object.keys(t),r=n.map(o=>t[o]),i=await pB(r),s={};return n.map((o,a)=>s[o]=i[a]),s}const e=t;return Promise.allSettled(e).then(n=>Array.from(e,(r,i)=>{const s=n[i];return s.status==="fulfilled"?{promise:r,value:s.value}:{promise:r,error:s.reason}}))}async function sje(t){return(await Promise.allSettled(t)).filter(e=>e.status==="fulfilled").map(e=>e.value)}async function fIt(t){return(await Promise.allSettled(t)).filter(e=>e.status==="rejected").map(e=>e.reason)}function Ofe(t,e=void 0,n){const r=new AbortController;return yu(n,()=>r.abort()),new Promise((i,s)=>{let o=setTimeout(()=>{o=0,i(e)},t);yu(r,()=>{o&&(clearTimeout(o),s(Pr()))})})}function pIt(t,e,n,r){const i=n&&"abort"in n?n:null;r!=null||i||(r=n);let s=setTimeout(()=>{s=0,i?.abort()},e);const o=()=>r||new Xe("promiseUtils:timeout","The wrapped promise did not resolve within "+e+" ms");return t.then(a=>{if(s===0)throw o();return clearTimeout(s),a},a=>{throw clearTimeout(s),s===0?o():a})}function oje(t,e){const n=new AbortController,r=setTimeout(()=>n.abort(),e);return yu(t,()=>{n.abort(),clearTimeout(r)}),{...t,signal:n.signal}}function ga(t){return t&&typeof t.then=="function"}function q8(t){return ga(t)?t:Promise.resolve(t)}function aje(t,e=-1){let n,r,i,s,o=null;const a=(...l)=>{if(n){r=l,s&&s.reject(Pr()),s=xc();const f=s.promise;if(o){const g=o;o=null,g.abort()}return f}if(i=s||xc(),s=null,e>0){const f=new AbortController;n=q8(t(...l,f.signal));const g=n;Ofe(e).then(()=>{n===g&&(s?f.abort():o=f)})}else n=1,n=q8(t(...l));const c=()=>{const f=r;r=i=n=o=null,f!=null&&a(...f)},u=n,h=i;return u.then(c,c),u.then(h.resolve,h.reject),h.promise};return a}function xc(){let t,e;const n=new Promise((i,s)=>{t=i,e=s}),r=i=>{t(i)};return r.resolve=i=>t(i),r.reject=i=>e(i),r.timeout=(i,s)=>sb.setTimeout(()=>r.reject(s),i),r.promise=n,r}function mIt(t,e){e.then(t.resolve,t.reject)}async function HQ(t){await Promise.resolve(),pi(t)}function ab(t,e){const n=e?.url?.path;if(t&&n&&(t=eu(t,n,{preserveProtocolRelative:!0}),e.portalItem&&e.readResourcePaths)){const r=cB(t,e.portalItem.itemUrl);r!=null&&r.startsWith(lje)&&e.readResourcePaths.push(e.portalItem.resourceFromPath(r).path)}return(t=K8(t,e?.portal))&&kO.test(t)?mB(t):t}function y2(t,e,n=0){if((t=t&&kO.test(t)?$fe(t):t)==null)return t;!El(t)&&e?.blockedRelativeUrls&&e.blockedRelativeUrls.push(t);let r=eu(t);if(e){const i=e.verifyItemRelativeUrls?.rootPath||e.url?.path;if(i){const s=K8(i,e.portal),o=K8(r,e.portal);r=cB(o,s,s),r!=null&&r!==o&&r!==t&&e.verifyItemRelativeUrls&&e.verifyItemRelativeUrls.writtenUrls.push(r)}}return r=jfe(r,e?.portal),El(r)&&(r=wg(r)),e?.resources&&e?.portalItem&&!El(r)&&!dv(r)&&n===0&&e.resources.toKeep.push({resource:e.portalItem.resourceFromPath(r),compress:!1}),r}function TO(t,e,n){return ab(t,n)}function v2(t,e,n,r){const i=y2(t,r);i!==void 0&&(e[n]=i)}const kO=/\/items\/([^/]+)\/resources\/(.*)/,lje="./resources/";function Lfe(t){return(t?.match(kO)??null)?.[1]??null}function Dfe(t){const e=t?.match(kO)??null;if(e==null)return null;const n=e[2],r=n.lastIndexOf("/");if(r===-1){const{path:o,extension:a}=BQ(n);return{prefix:null,filename:o,extension:a}}const{path:i,extension:s}=BQ(n.slice(r+1));return{prefix:n.slice(0,r),filename:i,extension:s}}function jfe(t,e){return e&&!e.isPortal&&e.urlKey&&e.customBaseUrl?W8(t,`${e.urlKey}.${e.customBaseUrl}`,e.portalHostname):t}function K8(t,e){if(!e||e.isPortal||!e.urlKey||!e.customBaseUrl)return t;const n=`${e.urlKey}.${e.customBaseUrl}`,r=sB();return j1(r,`${r.scheme}://${n}`)?W8(t,e.portalHostname,n):W8(t,n,e.portalHostname)}function mB(t){if(!t)return t||null;let e=t;return e&&Zr&&!Zr.findCredential(e)&&(e=mfe(e),e=e.replace(/^https?:\/\/www\.arcgis\.com/,"https://cdn.arcgis.com"),e=e.replace(/^https?:\/\/devext\.arcgis\.com/,"https://cdndev.arcgis.com"),e=e.replace(/^https?:\/\/qaext\.arcgis\.com/,"https://cdnqa.arcgis.com")),e}function $fe(t){if(!t)return t||null;let e=t;return e=e.replace(/^https?:\/\/cdn\.arcgis\.com/,"https://www.arcgis.com"),e=e.replace(/^https?:\/\/cdndev\.arcgis\.com/,"https://devext.arcgis.com"),e=e.replace(/^https?:\/\/cdnqa\.arcgis\.com/,"https://qaext.arcgis.com"),e&&Zr&&!Zr.findCredential(e)&&(e=mfe(e)),e}const cje=Object.freeze(Object.defineProperty({__proto__:null,ensureMainOnlineDomain:jfe,fromCDNUrl:$fe,fromJSON:ab,itemIdFromResourceUrl:Lfe,prefixAndFilenameFromResourceUrl:Dfe,read:TO,toCDNUrl:mB,toJSON:y2,write:v2},Symbol.toStringTag,{value:"Module"})),Ffe={mapserver:"MapServer",imageserver:"ImageServer",featureserver:"FeatureServer",knowledgegraphserver:"KnowledgeGraphServer",sceneserver:"SceneServer",streamserver:"StreamServer",vectortileserver:"VectorTileServer","3dtilesserver":"3DTilesServer",videoserver:"VideoServer"},Vfe=Object.values(Ffe),zfe=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(${Vfe.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),uje=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/([^/\\n]+)\\/(${Vfe.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),hje=/(.*?)\/(?:layers\/)?(\d+)\/?$/i;function gIt(t){return zfe.test(t)}function mI(t){if(t==null)return null;const e=Wa(t),n=e?.path.match(zfe)||e?.path.match(uje);if(!n)return null;const[,r,i,s,o]=n,a=i.indexOf("/");return{title:Gfe(a!==-1?i.slice(a+1):i),serverType:Ffe[s.toLowerCase()],sublayer:o!=null&&o!==""?parseInt(o,10):null,url:{path:r}}}function dje(t){const e=Wa(t).path.match(hje);return e?{serviceUrl:e[1],sublayerId:Number(e[2])}:null}function Gfe(t){return(t=t.replaceAll(/\s*[/_]+\s*/g," "))[0].toUpperCase()+t.slice(1)}function yIt(t,e){const n=[];if(t){const r=mI(t);r!=null&&r.title&&n.push(r.title)}if(e){const r=Gfe(e);n.push(r)}if(n.length===2){if(n[0].toLowerCase().includes(n[1].toLowerCase()))return n[0];if(n[1].toLowerCase().includes(n[0].toLowerCase()))return n[1]}return n.join(" - ")}function qQ(t){let e=pc(t,!0);return!!e&&(e=e.toLowerCase(),e.endsWith(".arcgis.com")&&(e.startsWith("services")||e.startsWith("tiles")||e.startsWith("features")||/^[a-z\d-]+\.svcs[a-z\d-]*\./.test(e)))}function vIt(t,e){return t&&Efe(Sfe(t,e))}function _It(t){let{url:e}=t;if(!e)return{url:e};e=Sfe(e,t.logger);const n=Wa(e),r=mI(n.path);let i;if(r!=null)r.sublayer!=null&&t.layer.layerId==null&&(i=r.sublayer),e=r.url.path;else if(t.nonStandardUrlAllowed){const s=dje(n.path);s!=null&&(e=s.serviceUrl,i=s.sublayerId)}return{url:Efe(e),layerId:i}}function xIt(t,e,n,r,i){v2(e,r,"url",i),r.url&&t.layerId!=null&&(r.url=hI(r.url,n,t.layerId.toString()))}function wIt(t){if(!t)return!1;const e=t.toLowerCase(),n=e.includes("/services/"),r=e.includes("/mapserver/wmsserver"),i=e.includes("/imageserver/wmsserver"),s=e.includes("/wmsserver");return n&&(r||i||s)}const fje=new Set(["elevation3d.arcgis.com","js.arcgis.com","jsdev.arcgis.com","jsqa.arcgis.com","static.arcgis.com"]);function gB(t){if(!yB(t))return null;const e=r=>r instanceof RegExp?r.test(t):typeof r=="string"&&t.startsWith(r),n=nr.apiKeys;if(Array.isArray(n.scopes)){for(const r of n.scopes)if(Array.isArray(r.urls)){if(r.urls.some(e))return r.token}else if(e(r.urls))return r.token}return n.basemapStyles&&/^https?:\/\/(i?basemaps|basemapstyles)-api\.arcgis\.com\//i.test(t)?n.basemapStyles:nr.apiKey&&/^https?:\/\/.+\.arcgis\.com(\/|$)/i.test(t)?nr.apiKey:null}function Y8(){return nr.apiKey!=null||nr.apiKeys.basemapStyles!=null}function pje(t,e){return e?yB(t):gB(t)!=null}function yB(t){const e=pc(t,!0);return!!e&&!fje.has(e)&&!t.endsWith("/sharing/rest/generateToken")}function mje(t,e,n=!1,r){return new Promise((i,s)=>{if(ma(r))return void s(KQ());let o=()=>{c(),s(new Error(`Unable to load ${e}`))},a=async()=>{const u=t;try{await u.decode()}catch{}c(),i(u)},l=()=>{if(!t)return;const u=t;c(),u.src="",s(KQ())};const c=()=>{t&&(t.removeEventListener("error",o),t.removeEventListener("load",a),o=null,a=null,t=null,r?.removeEventListener("abort",l),l=null,n&&URL.revokeObjectURL(e))};r?.addEventListener("abort",l),t.addEventListener("error",o),t.addEventListener("load",a)})}function KQ(){try{return new DOMException("Aborted","AbortError")}catch{const t=new Error;return t.name="AbortError",t}}const Ufe="Timeout exceeded";function gje(){return new Error(Ufe)}function bIt(t){return typeof t=="object"&&!!t&&"message"in t&&t.message===Ufe}function yje(t){nr.request.crossOriginNoCorsDomains||(nr.request.crossOriginNoCorsDomains={});const e=nr.request.crossOriginNoCorsDomains;for(let n of t)n=n.toLowerCase(),/^https?:\/\//.test(n)?e[pc(n)??""]=0:(e[pc("http://"+n)??""]=0,e[pc("https://"+n)??""]=0)}function vje(t){const e=nr.request.crossOriginNoCorsDomains;if(e){let n=pc(t);if(n)return n=n.toLowerCase(),!j1(n,sB())&&e[n]<Date.now()-36e5}return!1}async function _je(t){const e=Wa(t);t=e.path,e.query?.f==="json"&&(t+="?f=json");try{await fetch(t,{mode:"no-cors",credentials:"include"})}catch{}const n=nr.request.crossOriginNoCorsDomains,r=pc(t);n&&r&&(n[r.toLowerCase()]=Date.now())}const X8=new Map;function xje(t,e){const n=e?.preferredHost;if(!n||j1(t,`https://${n}`,!0))return;const r=mI(t);if(!r||r.serverType!=="FeatureServer"||pfe(t))return;const i=r.url.path.toLowerCase();X8.has(i)||X8.set(i,n)}function YQ(t){const e=mI(t)?.url.path.toLowerCase();if(!e)return t;const n=X8.get(e);return n?H6e(t,n):t}async function ns(t,e){t instanceof URL&&(t=t.toString()),e?.query instanceof URLSearchParams&&(e.query=oB(e.query.toString().replaceAll("+"," ")));const n=dv(t),r=dI(t);r||n||(t=wg(t));const i={url:t,requestOptions:{...e}},s=g=>({data:g,getAllHeaders:_2,getHeader:_2,httpStatus:200,requestOptions:i.requestOptions,url:i.url}),o=U8(t,Xc.internalInterceptors);if(o){const g=await ZQ(o,i);if(g!=null)return s(g)}let a=U8(t);if(a){const g=await ZQ(a,i);if(g!=null)return s(g);a.after||a.error||(a=null)}if(t=i.url,(e=i.requestOptions).responseType==="image"&&(ye("host-webworker")||ye("host-node")))throw dh("request:invalid-parameters",new Error("responseType 'image' is not supported in Web Workers or Node environment"),i);if(e.method==="head"){if(e.body)throw dh("request:invalid-parameters",new Error("body parameter cannot be set when method is 'head'"),i);if(n||r)throw dh("request:invalid-parameters",new Error("data and blob URLs are not supported for method 'head'"),i)}if(await Tje(),N4)return N4.execute(t,e);const l=new AbortController,c=yu(e,()=>l.abort()),u={controller:l,credential:void 0,credentialToken:void 0,fetchOptions:void 0,hasToken:!1,interceptor:a,params:i,redoRequest:!1,useIdentity:Xc.useIdentity,useProxy:!1,useSSL:!1,withCredentials:!1},h=e.useRequestQueue?Cje(u):J8(u),f=await h.finally(()=>c?.remove());return a?.after?.(f),f}let N4,Bfe=!1;const Xc=nr.request,Wfe="FormData"in globalThis,wje=new Set([499,498,403,401]),bje=new Set(["COM_0056","COM_0057","SB_0008"]),Eje=[/\/arcgis\/tokens/i,/\/sharing(\/rest)?\/generatetoken/i,/\/rest\/info/i],_2=()=>null,O4=Symbol();function Sje(t){const e=pc(t);e&&!ns._corsServers.includes(e)&&ns._corsServers.push(e)}function XQ(t){const e=pc(t);return!e||e.endsWith(".arcgis.com")||ns._corsServers.includes(e)||lB(e)}function dh(t,e,n,r){let i;const s={url:n.url,requestOptions:n.requestOptions,getAllHeaders:_2,getHeader:_2,ssl:!1};if(e instanceof Xe)return e.details?(e.details=Ze(e.details),e.details.url=n.url,e.details.requestOptions=n.requestOptions):e.details=s,e;if(e){const o=r&&(()=>Array.from(r.headers)),a=r&&(u=>r.headers.get(u)),l=r?.status,c=e.message;c&&(i=c),o&&a&&(s.getAllHeaders=o,s.getHeader=a),s.httpStatus=(e.httpCode!=null?e.httpCode:e.code)||l||0,s.subCode=e.subcode,s.messageCode=e.messageCode,typeof e.details=="string"?(s.messages=[e.details],i??=e.details):(s.messages=e.details,i??=s.messages?.[0]),s.raw=O4 in e?e[O4]:e}return i??="Error",wa(e)?Pr():new Xe(t,i,s)}async function Tje(){ye("host-webworker")&&(!N4&&globalThis.invokeStaticMessage?N4=await _e(()=>import("./request-BdwzSSmR.js"),[]):Bfe=!0)}async function Z8(){Zr||await _e(()=>import("./IdentityManager-DFUti-1r.js"),__vite__mapDeps([17,18]))}async function kje(t){const e=t.params.url,n=t.params.requestOptions,r=t.controller.signal,i=n.body;let s=null,o=null;if(Wfe&&"HTMLFormElement"in globalThis&&(i instanceof FormData?s=i:i instanceof HTMLFormElement&&(s=new FormData(i))),typeof i=="string"&&(o=i),t.fetchOptions={cache:n.cacheBust?"no-cache":"default",credentials:"same-origin",headers:n.headers||{},keepalive:n.keepAlive??!1,method:n.method==="head"?"HEAD":"GET",mode:"cors",priority:Xc.priority,redirect:"follow",signal:r},(s||o)&&(t.fetchOptions.body=s||o),(Bfe||n.authMode==="anonymous")&&(t.useIdentity=!1),t.hasToken=!!(/token=/i.test(e)||n.query?.token||s?.get("token")),!t.hasToken){const a=gB(e);a&&(n.query??={},n.query.token=a,t.hasToken=!0)}if(t.useIdentity&&!t.hasToken&&!t.credential&&!t.credentialToken&&!Hfe(e)&&!ma(r)){let a;n.authMode==="immediate"?(await Z8(),a=await Zr.getCredential(e,{signal:r})):n.authMode==="no-prompt"?(await Z8(),a=await Zr.getCredential(e,{prompt:!1,signal:r}).catch(()=>{})):Zr&&(a=Zr.findCredential(e)),a&&(t.credential=a,t.credentialToken=a.token,t.useSSL=!!a.ssl)}}function Hfe(t){return Eje.some(e=>e.test(t))}async function Aje(t){let e=t.params.url,n=YQ(e);const r=t.params.requestOptions,i=t.fetchOptions??{},s=dI(e)||dv(e),o=r.responseType||"json",a=s?0:r.timeout!=null?r.timeout:Xc.timeout;let l=!1;if(!s){t.useSSL&&(e=hB(e));let g={...r.query};t.credentialToken&&(g.token=t.credentialToken);let y=Fk(g);ye("esri-url-encodes-apostrophe")&&(y=y.replaceAll("'","%27"));const _=n.length+1+y.length;let b;l=r.method==="delete"||r.method==="post"||r.method==="put"||!!r.body||_>Xc.maxUrlLength;const T=r.useProxy||!!EO(e);if(T){const A=xfe(e);b=A.path,!l&&b.length+1+_>Xc.maxUrlLength&&(l=!0),A.query&&(g={...A.query,...g})}if(i.method==="HEAD"&&(l||T)){if(l)throw _>Xc.maxUrlLength?dh("request:invalid-parameters",new Error("URL exceeds maximum length"),t.params):dh("request:invalid-parameters",new Error("cannot use POST request when method is 'head'"),t.params);if(T)throw dh("request:invalid-parameters",new Error("cannot use proxy when method is 'head'"),t.params)}l?(i.method=r.method==="delete"?"DELETE":r.method==="put"?"PUT":"POST",r.body?e=yj(e,g):(i.body=Fk(g),i.headers||(i.headers={}),i.headers["Content-Type"]="application/x-www-form-urlencoded")):e=yj(e,g),T&&(t.useProxy=!0,e=`${b}?${e}`),g.token&&Wfe&&i.body instanceof FormData&&!pfe(e)&&i.body.set("token",g.token),r.hasOwnProperty("withCredentials")?t.withCredentials=r.withCredentials:j1(e,sB())||(lB(e)||Zr&&Zr.findServerInfo(e)?.webTierAuth)&&(t.withCredentials=!0),t.withCredentials&&(i.credentials="include",vje(e)&&await _je(l?yj(e,g):e)),n=YQ(e)}let c,u,h=0,f=!1;a>0&&(h=setTimeout(()=>{f=!0,t.controller.abort()},a));try{if(r.responseType==="native-request-init")u=i,u.url=n,r.signal?u.signal=r.signal:delete u.signal;else if(r.responseType!=="image"||i.cache!=="default"||i.keepalive||i.method!=="GET"||l||Ije(r.headers)||!s&&!t.useProxy&&Xc.proxyUrl&&!XQ(e)){if(ns._beforeFetch&&await ns._beforeFetch(e,i),c=await fetch(n,i),ns._afterFetch&&await ns._afterFetch(c),t.useProxy||Sje(e),r.responseType==="native")u=c;else if(i.method!=="HEAD")if(c.ok){switch(o){case"array-buffer":u=await c.arrayBuffer();break;case"blob":case"image":u=await c.blob();break;default:u=await c.text()}if(h&&(clearTimeout(h),h=0),o==="json"||o==="xml"||o==="document")if(u)switch(o){case"json":u=JSON.parse(u);break;case"xml":u=JQ(u,"application/xml");break;case"document":u=JQ(u,"text/html")}else u=null;if(u){if(o==="array-buffer"||o==="blob"){const g=c.headers.get("Content-Type");if(g&&/application\/json|text\/plain/i.test(g)&&u[o==="blob"?"size":"byteLength"]<=750)try{const y=await new Response(u).json();y.error&&(u=y)}catch{}}o==="image"&&u instanceof Blob&&(u=await QQ(URL.createObjectURL(u),t,!0))}}else{u=await c.text();try{u=JSON.parse(u)}catch{}}}else u=await QQ(n,t)}catch(g){if(g.name==="AbortError")throw f?gje():Pr("Request canceled");if(!(!c&&g instanceof TypeError&&Xc.proxyUrl)||r.body||r.method==="delete"||r.method==="head"||r.method==="post"||r.method==="put"||t.useProxy||XQ(e))throw g;t.redoRequest=!0,R6e({proxyUrl:Xc.proxyUrl,urlPrefix:pc(e)??""})}finally{h&&clearTimeout(h)}return[c,u]}async function ZQ(t,e){if(t.responseData!=null)return t.responseData;if(t.headers&&(e.requestOptions.headers={...e.requestOptions.headers,...t.headers}),t.query&&(e.requestOptions.query={...e.requestOptions.query,...t.query}),t.before){let n,r;try{r=await t.before(e)}catch(i){n=dh("request:interceptor",i,e)}if((r instanceof Error||r instanceof Xe)&&(n=dh("request:interceptor",r,e)),n)throw t.error&&t.error(n),n;return r}}function Ije(t){if(t){for(const e of Object.getOwnPropertyNames(t))if(t[e])return!0}return!1}function JQ(t,e){let n;try{n=new DOMParser().parseFromString(t,e)}catch{}if(!n||n.getElementsByTagName("parsererror").length)throw new SyntaxError("XML Parse error");return n}ns._corsServers=["https://server.arcgisonline.com","https://services.arcgisonline.com"],ns._beforeFetch=void 0,ns._afterFetch=void 0;const Pje=new Map;async function Cje(t){const e=Mje(t.params.url);if(!e)return J8(t);const{QueueProcessor:n}=await _e(()=>import("./QueueProcessor-BlaeYgt8.js"),[]);return fI(Pje,e.origin,()=>{const i=e.isHosted?ye("request-queue-concurrency-hosted"):ye("request-queue-concurrency-non-hosted");return new n({concurrency:i,process:s=>{if(ma(s.params.requestOptions))throw dh("",Pr("Request canceled"),s.params);return J8(s)}})}).push(t)}async function J8(t){let e,n;await kje(t);try{do[e,n]=await Aje(t);while(!await Rje(t,e,n))}catch(s){const o=dh("request:server",s,t.params,e);throw o.details.ssl=t.useSSL,t.interceptor?.error&&t.interceptor.error(o),o}const r=t.params.url;if(n)if(/\/sharing\/rest\/(accounts|portals)\/self/i.test(r)){if(!t.hasToken&&!t.credentialToken&&n.user?.username&&!lB(r)){const s=pc(r,!0);s&&Xc.trustedServers.push(s)}Array.isArray(n.authorizedCrossOriginNoCorsDomains)&&yje(n.authorizedCrossOriginNoCorsDomains)}else(t.params.requestOptions.responseType||"json")==="json"&&xje(r,n);const i=t.credential;if(i&&Zr){let o=Zr.findServerInfo(i.server)?.owningSystemUrl;if(o){o=o.replace(/\/?$/,"/sharing");const a=Zr.findCredential(o,i.userId);a&&Zr._getIdenticalSvcIdx(o,a)===-1&&a.resources.unshift(o)}}return{data:n,getAllHeaders:e?()=>Array.from(e.headers):_2,getHeader:e?s=>e.headers.get(s):_2,httpStatus:e?.status??200,requestOptions:t.params.requestOptions,ssl:t.useSSL,url:t.params.url}}async function Rje(t,e,n){if(t.redoRequest)return t.redoRequest=!1,!1;const r=t.params.requestOptions;if(!e||r.responseType==="native"||r.responseType==="native-request-init")return!0;let i,s;if(n&&(n.error&&typeof n.error=="object"?i=n.error:n.status==="error"&&Array.isArray(n.messages)&&(i={...n},i[O4]=n,i.details=n.messages)),!i&&!e.ok)throw i=new Error(`Unable to load ${e.url} status: ${e.status}`),i[O4]=n,i;let o,a=null;i&&(s=Number(i.code),a=i.hasOwnProperty("subcode")?Number(i.subcode):null,o=i.messageCode,o=o?.toUpperCase());const l=r.authMode;if(s===403&&(a===4||i.message?.toLowerCase().includes("ssl")&&!i.message.toLowerCase().includes("permission"))){if(!t.useSSL)return t.useSSL=!0,!1}else if(!t.hasToken&&t.useIdentity&&(l!=="no-prompt"||s===498)&&s!==void 0&&wje.has(s)&&!Hfe(t.params.url)&&(s!==403||(!o||!bje.has(o))&&(a==null||a===2&&t.credentialToken))){await Z8();try{const c=await Zr.getCredential(t.params.url,{error:dh("request:server",i,t.params),credential:t.credential,prompt:l!=="no-prompt",signal:t.controller.signal,token:t.credentialToken});return t.credential=c,t.credentialToken=c.token,t.useSSL=t.useSSL||c.ssl,!1}catch(c){if(l==="no-prompt")return t.credential=void 0,t.credentialToken=void 0,!1;i=c}}if(i)throw i;return!0}function QQ(t,e,n=!1){const r=e.controller.signal,i=new Image;return e.withCredentials?i.crossOrigin="use-credentials":i.crossOrigin="anonymous",i.alt="",i.fetchPriority=Xc.priority,i.src=t,mje(i,t,n,r)}function Mje(t){let e,n;return typeof t=="string"?(e=pc(t,!0),n=qQ(t)):(e=t.origin,n=qQ(t.toString())),e==null?null:{origin:e,isHosted:n}}function Nje(t){return t?.release&&typeof t.release=="function"}function Oje(t){return t?.acquire&&typeof t.acquire=="function"}var Ag;let lb=(Ag=class{constructor(e,n,r,i=1,s=0){this._creator=e,this._acquireFunction=n,this._releaseFunction=r,this.allocationSize=i,this._pool=new Array(s),this._initialSize=s;for(let o=0;o<s;o++)this._pool[o]=this._creator();this.allocationSize=Math.max(i,1)}destroy(){this.prune(0)}acquire(...e){let n;if(Ag.test.disabled)n=this._creator();else{if(this._pool.length===0){const r=this.allocationSize;for(let i=0;i<r;i++)this._pool[i]=this._creator()}n=this._pool.pop()}return this._acquireFunction?this._acquireFunction(n,...e):Oje(n)&&n.acquire(...e),n}release(e){e&&!Ag.test.disabled&&(this._releaseFunction?this._releaseFunction(e):Nje(e)&&e.release(),this._pool.push(e))}prune(e=this._initialSize){if(!(e>=this._pool.length)){for(let n=e;n<this._pool.length;++n){const r=this._pool[n];this._dispose(r)}this._pool.length=e}}_dispose(e){e.dispose&&typeof e.dispose=="function"&&e.dispose()}},Ag.test={disabled:!!ye("esri-tests-disable-memory-pools")},Ag);function Lje(t){t.length=0}let Na=class{constructor(e=50,n=50){this._pool=new lb(()=>[],void 0,Lje,n,e)}acquire(){return this._pool.acquire()}release(e){this._pool.release(e)}prune(){this._pool.prune(0)}static acquire(){return vj.acquire()}static release(e){return vj.release(e)}static prune(){vj.prune()}};const vj=new Na(100),eee=new WeakMap;function Dje(t,e,n=!1){const r=` DEPRECATED - ${e}`;if(!n)return void t.warn(r);let i=eee.get(t);i||(i=new Set,eee.set(t,i)),i.has(e)||(i.add(e),t.warn(r))}const L4="https://www.esriurl.com/";function jje(t,e,n,r={}){ye("esri-deprecation-warnings")&&jg(t,`This widget is deprecated. Use the ${e} component instead.`,{see:[`${e} component reference: ${L4}${n}/`,`Esri's move to web components: ${L4}components-transition-plan/`],replacement:`<${n}></${n}>`,warnOnce:!0,...r})}function $je(t,e,n,r={}){ye("esri-deprecation-warnings")&&jg(t,`This view model is deprecated. Use the ${e} component directly instead.`,{see:[`${e} component reference: ${L4}${n}/`,`Esri's move to web components: ${L4}components-transition-plan/`],replacement:`<${n}></${n}>`,warnOnce:!0,...r})}function SIt(t,e,n={}){ye("esri-deprecation-warnings")&&jg(t,`Module: ${e}`,n)}function qfe(t,e,n={}){if(ye("esri-deprecation-warnings")){const{moduleName:r}=n;jg(t,`Function: ${(r?r+"::":"")+e+"()"}`,n)}}function Q8(t,e,n={}){if(ye("esri-deprecation-warnings")){const{moduleName:r}=n;jg(t,`Property: ${(r?r+"::":"")+e}`,n)}}function Fje(t,e,n={}){ye("esri-deprecation-warnings")&&jg(t,`Multiple argument constructor: ${e}`,{warnOnce:!0,replacement:`new ${e}({ <your properties here> })`,...n})}function jg(t,e,n={}){if(ye("esri-deprecation-warnings")){const{replacement:r,version:i,see:s,warnOnce:o}=n;let a=e;if(r&&(a+=`
	 Replacement: ${r}`),i&&(a+=`
	 Version: ${i}`),s)if(Array.isArray(s)){a+=`
	 See for more details:`;for(const l of s)a+=`
		${l}`}else a+=`
	 See ${s} for more details.`;Dje(t,a,o)}}function TIt(t){const e=[];return function*(){yield*e;let n,r=e.length;for(;!(n=t.next()).done;)for(e.push(n.value),yield n.value;++r<e.length;)yield e[r]}}function Vje(t,e){for(const n of t)if(n!=null&&e(n))return n}function D4(t){return t!=null&&typeof t[Symbol.iterator]=="function"}let cb=class{constructor(){this._groups=new Map}destroy(){this.removeAll()}get size(){let e=0;return this._groups.forEach(n=>{e+=n.length}),e}add(e,n){if(D4(e)){const r=this._getOrCreateGroup(n);for(const i of e)nee(i)&&r.push(i)}else nee(e)&&this._getOrCreateGroup(n).push(e);return this}forEach(e,n){if(typeof e=="function")this._groups.forEach(r=>r.forEach(e));else{const r=this._getGroup(e);r&&n&&r.forEach(n)}}has(e){return this._groups.has(MC(e))}remove(e){if(typeof e!="string"&&D4(e)){for(const n of e)this.remove(n);return this}return this.has(e)?(tee(this._getGroup(e)),this._groups.delete(MC(e)),this):this}removeAll(){return this._groups.forEach(tee),this._groups.clear(),this}removeReference(e){return this._groups.delete(e),this}_getOrCreateGroup(e){if(this.has(e))return this._getGroup(e);const n=[];return this._groups.set(MC(e),n),n}_getGroup(e){return this._groups.get(MC(e))}};function MC(t){return t||"_default_"}function tee(t){for(const e of t)e instanceof cb?e.removeAll():e.remove()}function nee(t){return t!=null&&(!!t.remove||t instanceof cb)}const Kfe=Symbol("Accessor-beforeDestroy");function $g(t){return t.__accessor__??null}function zje(t,e){return t?.metadata?.[e]!=null}function pM(t,e,n){return n?j4(t,e,{policy:n,path:""}):j4(t,e,null)}function j4(t,e,n){return e?Object.keys(e).reduce((r,i)=>{const s=i;if(s==="__proto__")return r;let o=null,a="merge";if(n&&(o=n.path?`${n.path}.${i}`:i,a=n.policy(o)),a==="replace"||a==="replace-arrays"&&Array.isArray(r[s]))return r[s]=e[s],r;if(r[s]===void 0)return r[s]=Ze(e[s]),r;let l=r[s],c=e[s];if(l===c)return r;if(Array.isArray(c)||Array.isArray(r))l=l?Array.isArray(l)?r[s]=l.slice():r[s]=[l]:r[s]=[],c&&(Array.isArray(c)||(c=[c]),c.forEach(u=>{l.includes(u)||l.push(u)}));else if(c&&typeof c=="object")if(n){const u=n.path;n.path=o,r[s]=j4(l,c,n),n.path=u}else r[s]=j4(l,c,null);else r.hasOwnProperty(i)&&!e.hasOwnProperty(i)||(r[s]=c);return r},t||{}):t}function Yfe(t){return Array.isArray(t)?t:t.split(".")}function ree(t){return t.includes(",")?t.split(",").map(e=>e.trim()):[t.trim()]}function Gje(t){if(Array.isArray(t)){const e=[];for(const n of t)e.push(...ree(n));return e}return ree(t)}function Xfe(t,e,n,r){const i=Gje(e);if(i.length!==1){const s=i.map(o=>r(t,o,n));return fv(s)}return r(t,i[0],n)}function Zfe(t,e){const n=t.endsWith("?")?t.slice(0,-1):t;if(e.getItemAt!=null||Array.isArray(e)){const i=parseInt(n,10);if(!isNaN(i))return Array.isArray(e)?e[i]:e.at(i)}const r=$g(e);return zje(r,n)?r.get(n):e[n]}function Jfe(t,e,n){if(t==null)return t;const r=Zfe(e[n],t);return!r&&n<e.length-1?void 0:n===e.length-1?r:Jfe(r,e,n+1)}function gI(t,e,n=0){return typeof e!="string"||e.includes(".")?Jfe(t,Yfe(e),n):Zfe(e,t)}function yd(t,e){return gI(t,e)}function iee(t,e){return gI(e,t)!==void 0}const ic={INITIALIZING:0,CONSTRUCTING:1,CONSTRUCTED:2,DESTROYING:3,DESTROYED:4};function ub(t){let e=t.constructor.__accessorMetadata__;const n=Object.prototype.hasOwnProperty.call(t.constructor,"__accessorMetadata__");if(e){if(!n){e=Object.create(e);for(const r in e)e[r]=Ze(e[r]);Object.defineProperty(t.constructor,"__accessorMetadata__",{value:e,enumerable:!1,configurable:!0,writable:!0})}}else e={},Object.defineProperty(t.constructor,"__accessorMetadata__",{value:e,enumerable:!1,configurable:!0,writable:!0});return t.constructor.__accessorMetadata__}function yI(t,e){const n=ub(t);let r=n[e];return r||(r=n[e]={}),r}function Uje(t,e){return pM(t,e,Wje)}const Bje=/^(?:[^.]+\.)?(?:value|type|(?:json\.type|json\.origins\.[^.]\.type))$/;function Wje(t){return Bje.test(t)?"replace":"merge"}let Hje=class{constructor(e,n){this._observers=e,this._observer=n}remove(){Jde(this._observers,this._observer)}},Qfe=class{constructor(){this._observers=null,this.destroyed=!1}observe(e){if(this.destroyed||e.destroyed)return qje;this._observers==null&&(this._observers=[]);const n=this._observers;let r=!1,i=!1;const s=n.length;for(let o=0;o<s;++o){const a=n[o];if(a.destroyed)i=!0;else if(a===e){r=!0;break}}return r||(n.push(e),i&&this._removeDestroyedObservers()),new Hje(n,e)}_removeDestroyedObservers(){const e=this._observers;if(!e||e.length===0)return;const n=e.length;let r=0;for(let i=0;i<n;++i){for(;i+r<n&&e[i+r].destroyed;)++r;if(r>0){if(!(i+r<n))break;e[i]=e[i+r]}}e.length=n-r}destroy(){if(this.destroyed)return;this.destroyed=!0;const e=this._observers;if(e!=null){for(const n of e)n.onCommitted();this._observers=null}}};const qje=Zn(),di={Dirty:1,Overridden:2,Computing:4,NonNullable:8,HasDefaultValue:16,DepTrackingInitialized:32,AutoTracked:64,ExplicitlyTracking:128};let AO=class{constructor(e){this.accessed=void 0,this._handles=void 0,this._observer=e}destroy(){this.accessed?.clear(),this.clear()}onAccessed(e){this._observer!=null&&e!==this._observer&&(this.accessed==null&&(this.accessed=new Set),this.accessed.add(e))}onTrackingEnd(){this._observer!=null&&(this.clear(),this.accessed!=null&&(this._handles==null&&(this._handles=[]),this.accessed.forEach(e=>{this._handles.push(e.observe(this._observer))}),this.accessed.clear()))}clear(){if(this._handles!=null){for(let e=0;e<this._handles.length;++e)this._handles[e].remove();this._handles.length=0}}};const $4=new AO,uS=[];let fT=$4;function nn(t){fT.onAccessed(t)}let mM=!1,gM=!1;function gp(t,e,n){if(mM)return vB(t,e,n);let r=null;return epe(t),r=e.call(n),tpe(),r}function Kje(t,e){return gp($4,t,e)}function vB(t,e,n){const r=mM;mM=!0,epe(t);let i=null;try{i=e.call(n)}catch(s){gM&&kt.getLogger("esri.core.accessorSupport.tracking").error(s)}return tpe(),mM=r,i}function epe(t){fT=t,uS.push(t)}function tpe(){const t=uS.length;if(t>1){const e=uS.pop();fT=uS[t-2],e.onTrackingEnd()}else if(t===1){const e=uS.pop();fT=$4,e.onTrackingEnd()}else fT=$4}function npe(t,e){if(e.flags&di.DepTrackingInitialized)return;e.flags|=di.DepTrackingInitialized;const n=gM;gM=!1,e.flags&di.AutoTracked?vB(e.trackingTarget,e.metadata.get,t):rpe(t,e),gM=n}const Yje=[];function rpe(t,e){e.flags&di.ExplicitlyTracking||(e.flags|=di.ExplicitlyTracking,vB(e.trackingTarget,()=>{const n=e.metadata.dependsOn||Yje;for(const r of n)if(typeof r!="string"||r.includes(".")){const i=Yfe(r);for(let s=0,o=t;s<i.length&&o!=null&&typeof o=="object";++s)o=see(o,i[s],s!==i.length-1)}else see(t,r,!1)}),e.flags&=-129)}function see(t,e,n){const r=e.endsWith("?")?e.slice(0,-1):e;if(t.getItemAt!=null||Array.isArray(t)){const s=parseInt(r,10);if(!isNaN(s))return Array.isArray(t)?t[s]:t.at(s)}const i=$g(t);if(i){const s=i.propertiesByName.get(r);s&&(nn(s),npe(t,s))}return n?t[r]:void 0}let oee=class extends Qfe{constructor(e,n){super(),this.propertyName=e,this.metadata=n,this.trackingTarget=new AO(this),this.flags=0,this.flags=di.Dirty|(n.nonNullable?di.NonNullable:0)|(n.hasOwnProperty("value")?di.HasDefaultValue:0)|(n.get===void 0?di.DepTrackingInitialized:0)|(n.dependsOn===void 0?di.AutoTracked:0)}destroy(){this.flags&di.Dirty&&this.onCommitted(),super.destroy(),this.trackingTarget.destroy()}getComputed(e){e.mutable&&nn(this);const n=e.store,r=this.propertyName,i=this.flags,s=n.get(r);if(i&di.Computing||~i&di.Dirty&&n.has(r))return s;this.flags|=di.Computing;const o=e.host;let a;i&di.AutoTracked?a=gp(this.trackingTarget,this.metadata.get,o):(rpe(o,this),a=this.metadata.get.call(o)),this.flags|=di.DepTrackingInitialized,n.set(r,a,1);const l=n.get(r);return l===s?this.flags&=-2:Kje(this.commit,this),this.flags&=-5,l}notifyChange(){this.onInvalidated(),this.onCommitted()}invalidate(){this.onInvalidated()}commit(){this.flags&=-2,this.onCommitted()}onInvalidated(){~this.flags&di.Overridden&&(this.flags|=di.Dirty);const e=this._observers;if(e&&e.length>0)for(const n of e)n.onInvalidated()}onCommitted(){const e=this._observers;if(e&&e.length>0){const n=e.slice();for(const r of n)r.onCommitted()}}};const RIt=8;function _B(t){switch(t){case"defaults":return 0;case"service":return 2;case"portal-item":return 3;case"web-scene":return 4;case"web-map":return 5;case"link-chart":return 6;case"user":return 7;default:return null}}function e9(t){switch(t){case 0:return"defaults";case 2:return"service";case 3:return"portal-item";case 4:return"web-scene";case 5:return"web-map";case 6:return"link-chart";case 7:return"user"}}function Xje(t){return e9(t)}let Zje=class ipe{constructor(){this._values=new Map,this.multipleOriginsSupported=!1}clone(e){const n=new ipe;return this._values.forEach((r,i)=>{e&&e.has(i)||n.set(i,Ze(r))}),n}get(e){return this._values.get(e)}originOf(){return 7}keys(){return[...this._values.keys()]}set(e,n){this._values.set(e,n)}delete(e){this._values.delete(e)}has(e){return this._values.has(e)}isAtOrigin(e,n){return this.has(e)}isBelowOrigin(e,n){return!this.has(e)}forEach(e){this._values.forEach(e)}};function __(t,e,n){return t!==void 0}function aee(t,e,n,r){return t!==void 0&&(!(n==null&&t.flags&di.NonNullable)||(r.lifecycle,!1))}let Jje=class{constructor(e){this.host=e,this.propertiesByName=new Map,this.ctorArgs=null,this.lifecycle=ic.INITIALIZING,this.store=new Zje,this.mutable=!0,this._origin=7;const n=this.host.constructor.__accessorMetadata__;for(const r in n){const i=new oee(r,n[r]);this.propertiesByName.set(r,i)}this.metadata=n}initialize(){this.lifecycle=ic.CONSTRUCTING}constructed(){this.lifecycle=ic.CONSTRUCTED}destroy(){this.lifecycle=ic.DESTROYED,this.propertiesByName.forEach(e=>e.destroy())}get initialized(){return this.lifecycle!==ic.INITIALIZING}get(e){const n=this.propertiesByName.get(e);if(!__(n))return;if(n.metadata.get)return n.getComputed(this);this.mutable&&nn(n);const r=this.store;return r.has(e)?r.get(e):n.metadata.value}originOf(e){const n=this.store.originOf(e);if(n===void 0){const r=this.propertiesByName.get(e);if(r!==void 0&&r.flags&di.HasDefaultValue)return"defaults"}return e9(n)}has(e){return this.propertiesByName.has(e)&&this.store.has(e)}keys(){return[...this.propertiesByName.keys()]}internalGet(e){const n=this.propertiesByName.get(e);if(__(n))return this.store.has(e)?this.store.get(e):n.metadata.value}internalSet(e,n){const r=this.propertiesByName.get(e);__(r)&&this._internalSet(r,n)}getDependsInfo(e,n,r){const i=this.propertiesByName.get(n);if(!__(i))return"";const s=new AO,o=gp(s,()=>i.metadata.get?.call(e));let a=`${r}${e.declaredClass.split(".").pop()}.${n}: ${o}
`;const l=s.accessed??new Set;if(l.size===0)return a;r+="  ";for(const c of l)c instanceof oee&&(a+=`${r}${c.propertyName}: undefined
`);return a}setAtOrigin(e,n,r){const i=this.propertiesByName.get(e);if(__(i))return this._setAtOrigin(i,n,r)}isOverridden(e){const n=this.propertiesByName.get(e);return n!==void 0&&!!(n.flags&di.Overridden)}clearOrigin(e,n){const r=this.store,i=this.propertiesByName.get(e);if(!__(i))return;const s=r.isAtOrigin(e,n)&&!(i.flags&di.Overridden);r.delete(e,n),s&&i.notifyChange()}clearOverride(e){const n=this.propertiesByName.get(e);n&&n.flags&di.Overridden&&(n.flags&=-3,n.notifyChange())}override(e,n){const r=this.propertiesByName.get(e);if(!aee(r,e,n,this))return;const i=r.metadata.cast;if(i){const s=this._cast(i,n),{valid:o,value:a}=s;if(_j.release(s),!o)return;n=a}r.flags|=di.Overridden,this._internalSet(r,n)}set(e,n){const r=this.propertiesByName.get(e);if(!aee(r,e,n,this))return;const i=r.metadata.cast;if(i){const o=this._cast(i,n),{valid:a,value:l}=o;if(_j.release(o),!a)return;n=l}const s=r.metadata.set;s?s.call(this.host,n):this._internalSet(r,n)}setDefaultOrigin(e){this._origin=_B(e)}getDefaultOrigin(){return e9(this._origin)}notifyChange(e){const n=this.propertiesByName.get(e);n!==void 0&&n.notifyChange()}invalidate(e){const n=this.propertiesByName.get(e);n!==void 0&&n.invalidate()}commit(e){const n=this.propertiesByName.get(e);n!==void 0&&n.commit()}_internalSet(e,n){const r=this.lifecycle!==ic.INITIALIZING?this._origin:0;this._setAtOrigin(e,n,r)}_setAtOrigin(e,n,r){const i=this.store,s=e.propertyName;if(i.isAtOrigin(s,r)&&rB(n,i.get(s))&&~e.flags&di.Overridden)return;const o=i.isBelowOrigin(s,r)||i.isAtOrigin(s,r);o&&e.invalidate(),i.set(s,n,r),o&&e.commit(),npe(this.host,e)}_cast(e,n){const r=_j.acquire();return r.valid=!0,r.value=n,e&&(r.value=e.call(this.host,n,r)),r}},Qje=class{constructor(){this.value=null,this.valid=!0}acquire(){this.valid=!0}release(){this.value=null}};const _j=new lb(()=>new Qje);function F4(t,e,n){if(t&&e)if(typeof e=="object")for(const r of Object.getOwnPropertyNames(e))F4(t,r,e[r]);else{if(e.includes(".")){const i=e.split("."),s=i.splice(-1,1)[0];return void F4(yd(t,i),s,n)}const r=t.__accessor__;r!=null&&e$e(e,r),t[e]=n}}function e$e(t,e){if(ye("esri-unknown-property-errors")&&!t$e(t,e))throw new Xe("set:unknown-property",n$e(t,e))}function t$e(t,e){return e.metadata[t]!=null}function n$e(t,e){return"setting unknown property '"+t+"' on instance of "+e.host.declaredClass}let r$e;function i$e(){return r$e}let spe=class extends lb{constructor(){super(...arguments),this._set=new Set}destroy(){super.destroy(),this._set=null}acquire(...e){const n=super.acquire(...e);return this._set.delete(n),n}release(e){e&&!this._set.has(e)&&(super.release(e),this._set.add(e))}_dispose(e){this._set.delete(e),super._dispose(e)}};const NC=[];function V4(t){NC.push(t),NC.length===1&&queueMicrotask(()=>{const e=NC.slice();NC.length=0;for(const n of e)n()})}let pT=class{constructor(e,n=30){this.name=e,this._counter=0,this._samples=new Array(n)}push(e){e!=null&&(this._samples[++this._counter%this._samples.length]=e)}set(e){e!=null&&(this._samples[this._counter%this._samples.length]=e)}get median(){return this._samples.slice().sort((e,n)=>e-n)[Math.floor(this._samples.length/2)]}get average(){return this._samples.reduce((e,n)=>e+n,0)/this._samples.length}get last(){return this._samples[this._counter%this._samples.length]}};const z4=(t,e,n,r)=>{let i=e,s=e;const o=n>>>1,a=t[i-1];for(;s<=o;){s=i<<1,s<n&&r(t[s-1],t[s])<0&&++s;const l=t[s-1];if(r(l,a)<=0)break;t[i-1]=l,i=s}t[i-1]=a},ope=(t,e)=>t<e?-1:t>e?1:0;function s$e(t,e,n,r){n===void 0&&(n=t.length),r===void 0&&(r=ope);for(let s=n>>>1;s>e;s--)z4(t,s,n,r);const i=e+1;for(let s=n-1;s>e;s--){const o=t[e];t[e]=t[s],t[s]=o,z4(t,i,s,r)}}function*o$e(t,e,n,r){n===void 0&&(n=t.length),r===void 0&&(r=ope);for(let s=n>>>1;s>e;s--)z4(t,s,n,r),yield;const i=e+1;for(let s=n-1;s>e;s--){const o=t[e];t[e]=t[s],t[s]=o,z4(t,i,s,r),yield}}const a$e=1.5,l$e=1.1;let ape=class{constructor(e){this.data=[],this._length=0,this._allocator=void 0,this._deallocator=()=>null,this._shrink=()=>{},this._hint=new Yde,e&&(e.initialSize&&(this.data=new Array(e.initialSize)),e.allocator&&(this._allocator=e.allocator),e.deallocator!==void 0&&(this._deallocator=e.deallocator),e.shrink&&(this._shrink=()=>lee(this)))}toArray(){return this.data.slice(0,this.length)}filter(e){const n=new Array;for(let r=0;r<this._length;r++){const i=this.data[r];e(i)&&n.push(i)}return n}at(e){if((e=Math.trunc(e)||0)<0&&(e+=this._length),!(e<0||e>=this._length))return this.data[e]}includes(e,n){const r=this.data.indexOf(e,n);return r!==-1&&r<this.length}get length(){return this._length}set length(e){if(e>this._length){if(this._allocator){for(;this._length<e;)this.data[this._length++]=this._allocator(this.data[this._length]);return}this._length=e}else{if(this._deallocator)for(let n=e;n<this._length;++n)this.data[n]=this._deallocator(this.data[n]);this._length=e,this._shrink()}}clear(){this.length=0}prune(){this.clear(),this.data=[]}push(e){this.data[this._length++]=e}pushArray(e,n=e.length){for(let r=0;r<n;r++)this.data[this._length++]=e[r]}fill(e,n){for(let r=0;r<n;r++)this.data[this._length++]=e}pushNew(){this._allocator&&(this.data[this.length]=this._allocator(this.data[this.length]));const e=this.data[this._length];return++this._length,e}unshift(e){this.data.unshift(e),this._length++,lee(this)}pop(){if(this.length===0)return;const e=this.data[this.length-1];return this.length=this.length-1,this._shrink(),e}remove(e){const n=V8(this.data,e,this.length,this._hint);if(n!==-1)return this.data.splice(n,1),this.length=this.length-1,e}removeUnordered(e){return this.removeUnorderedIndex(V8(this.data,e,this.length,this._hint))}removeUnorderedIndex(e){if(!(e>=this.length||e<0))return this.swapElements(e,this.length-1),this.pop()}removeUnorderedMany(e,n=e.length,r){this.length=o6e(this.data,e,this.length,n,this._hint,r),this._shrink()}front(){if(this.length!==0)return this.data[0]}back(){if(this.length!==0)return this.data[this.length-1]}swapElements(e,n){if(e>=this.length||n>=this.length||e===n)return;const r=this.data[e];this.data[e]=this.data[n],this.data[n]=r}sort(e){s$e(this.data,0,this.length,e)}iterableSort(e){return o$e(this.data,0,this.length,e)}some(e,n){for(let r=0;r<this.length;++r)if(e.call(n,this.data[r],r,this.data))return!0;return!1}find(e,n){const{data:r,length:i}=this;for(let s=0;s<i;++s)if(e.call(n,r[s]))return r[s]}filterInPlace(e,n){let r=0;for(let i=0;i<this._length;++i){const s=this.data[i];e.call(n,s,i,this.data)&&(this.data[i]=this.data[r],this.data[r]=s,r++)}if(this._deallocator)for(let i=r;i<this._length;i++)this.data[i]=this._deallocator(this.data[i]);return this._length=r,this._shrink(),this}forAll(e,n){const{data:r,length:i}=this;for(let s=0;s<i;++s)e.call(n,r[s],s,r)}forEach(e,n){this.data.slice(0,this.length).forEach(e,n)}map(e,n){const r=new Array(this.length);for(let i=0;i<this.length;++i)r[i]=e.call(n,this.data[i],i,this.data);return r}reduce(e,n){let r=n;for(let i=0;i<this.length;++i)r=e(r,this.data[i],i,this.data);return r}has(e){const n=this.length,r=this.data;for(let i=0;i<n;++i)if(r[i]===e)return!0;return!1}*[Symbol.iterator](){for(let e=0;e<this.length;e++)yield this.data[e]}};function lee(t){t.data.length>a$e*t.length&&(t.data.length=Math.floor(t.length*l$e))}function jIt(t){return t}function c$e(t){return 1e3*t}function $It(t){return t}function FIt(t){return .001*t}let u$e=class{constructor(e){this.phases=e,this.paused=!1,this.ticks=-1,this.removed=!1}},h$e=class{constructor(e){this.callback=e,this.isActive=!0}remove(){this.isActive=!1}},t9=0;const PE={time:0,deltaTime:0,elapsedFrameTime:0,frameDuration:0},n9=["prepare","preRender","render","postRender","update","finish"],r9=[],F1=new ape;let d$e=class{constructor(e){this._task=e}remove(){this._task.removed=!0}pause(){this._task.paused=!0}resume(){this._task.paused=!1,lpe()}};function f$e(){n1!=null&&(cancelAnimationFrame(n1),n1=requestAnimationFrame(xB))}function lpe(){n1==null&&(t9=performance.now(),n1=requestAnimationFrame(xB))}const G4={frameTasks:F1,willDispatch:!1,clearFrameTasks:p$e,dispatch:upe,executeFrameTasks:m$e,reschedule:f$e};function hb(t){const e=new h$e(t);return r9.push(e),G4.willDispatch||(G4.willDispatch=!0,V4(upe)),e}function x2(t){const e=new u$e(t);return F1.push(e),lpe(),new d$e(e)}let n1=null;function p$e(t=!1){F1.forAll(e=>{e.removed=!0}),t&&cpe()}function xB(){const t=performance.now();n1=null,n1=F1.some(n=>!n.paused&&!n.removed)?requestAnimationFrame(xB):null,G4.executeFrameTasks(t)}function m$e(t){const e=t-t9;t9=t;const n=1e3/60,r=Math.max(0,e-n);PE.time=t,PE.frameDuration=n-r;for(let i=0;i<n9.length;i++){const s=performance.now(),o=n9[i];F1.forAll(a=>{a.paused||a.removed||(i===0&&a.ticks++,a.phases[o]&&(PE.elapsedFrameTime=performance.now()-t,PE.deltaTime=a.ticks===0?0:e,a.phases[o]?.call(a,PE)))}),_$e[i].push(performance.now()-s)}cpe(),x$e.push(performance.now()-t)}const OC=new ape;function cpe(){F1.forAll(t=>{t.removed&&OC.push(t)}),F1.removeUnorderedMany(OC.data,OC.length),OC.clear()}function upe(){for(;r9.length;){const t=r9.shift();t.isActive&&t.callback()}G4.willDispatch=!1}function g$e(t=1,e){const n=xc(),r=()=>{ma(e)?n.reject(Pr()):t===0?n():(--t,V4(()=>r()))};return r(),n.promise}function y$e(t){return g$e(1,t)}async function v$e(t){await y$e(t),await new Promise(e=>requestAnimationFrame(()=>{t?.aborted||e()}))}const _$e=n9.map(t=>new pT(t)),x$e=new pT("total");function hpe(t,e){for(const n of t.values())if(e(n))return!0;return!1}function cee(t,e){if(!e)return t;for(const n of e)n!=null&&t.add(n);return t}function UIt(t,e){return e!=null&&t.add(e),t}function wB(t,e){const n=new Set;return cee(n,t),cee(n,e),n}function w$e(t,e){const n=new Set;for(const r of e)t.has(r)&&n.add(r);return n}function BIt(t,e){if(!t||!e)return!1;if(t===e)return!0;for(const n of t)if(!e.has(n))return!1;return!0}function WIt(t,e){if(t==null&&e==null)return!0;if(t==null||e==null||t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0}function b$e(t,e){const n=new Set(t);for(const r of e)n.delete(r);return n}function E$e(t,e){return b$e(wB(t,e),w$e(t,e))}let S$e=0;function yM(){return++S$e}let IO=class extends AO{constructor(e){super(new T$e(e)),this._observer&&uee.register(this,new WeakRef(this._observer),this)}destroy(){this._observer&&uee.unregister(this._observer),this.accessed?.clear(),this.clear(),this._observer?.destroy()}},T$e=class{constructor(e){this._notify=e,this._invalidCount=0,this.destroyed=!1}onInvalidated(){this._invalidCount++}onCommitted(){if(this.destroyed)return;const e=this._invalidCount;if(e===1)return this._invalidCount=0,void this._notify();this._invalidCount=e>0?e-1:0}destroy(){this.destroyed=!0,this._notify=k$e}};const uee=new FinalizationRegistry(t=>{t.deref()?.destroy()});function k$e(){}let rw=!1;const U4=[];function dpe(t,e){let n=new IO(s),r=null,i=!1;function s(){if(!n||i)return;if(rw)return void ppe(s);const a=r;n.clear(),rw=!0,i=!0,r=gp(n,t),i=!1,rw=!1,e(r,a),mpe()}function o(){n&&(n.destroy(),n=null,r=null)}return i=!0,r=gp(n,t),i=!1,Zn(o)}function fpe(t,e){let n=new IO(i),r=null;function i(){e(r,o)}function s(){n&&(n.destroy(),n=null),r=null}function o(){return n?(n.clear(),r=gp(n,t),r):null}return o(),Zn(s)}function A$e(t,e){let n=!1,r=!1;const i=!!e?.sync;let s=new IO(()=>{n||r||(r=!0,i?o():queueMicrotask(o))});function o(){r=!1,s&&!n&&(rw?ppe(o):(s.clear(),rw=!0,n=!0,gp(s,t),n=!1,rw=!1,mpe()))}function a(){s&&(s.destroy(),s=null)}return n=!0,gp(s,t),n=!1,Zn(a)}function ppe(t){U4.includes(t)||U4.unshift(t)}function mpe(){for(;U4.length;)U4.pop()()}var d1;let bB=(d1=class{constructor(){this.uid=yM(),this.removed=!1,this.type=null,this.oldValue=null,this.callback=null,this.getValue=null,this.target=null,this.path=null,this.equals=null}static acquireUntracked(e,n,r,i,s){return this.pool.acquire(0,e,n,r,i,s,rB)}static acquireTracked(e,n,r,i){return this.pool.acquire(1,e,n,r,null,null,i)}notify(e,n){this.type===0?this.callback.call(this.target,e,n,this.path,this.target):this.callback.call(null,e,n,void 0,void 0)}acquire(e,n,r,i,s,o,a){this.uid=yM(),this.removed=!1,this.type=e,this.oldValue=n,this.callback=r,this.getValue=i,this.target=s,this.path=o,this.equals=a}release(){this.target=this.path=this.oldValue=this.callback=this.getValue=null,this.uid=yM(),this.removed=!0}},d1.pool=new spe(()=>new d1),d1);const vM=new Na,np=new Set;let B4;function W4(t){np.delete(t),np.add(t),gpe()}function gpe(){B4||(B4=hb(C$e))}function I$e(t){if(t.removed)return;const e=t.oldValue,n=t.getValue();t.equals(e,n)||(t.oldValue=n,t.notify(n,e))}function P$e(t){for(const e of np.values())e.target===t&&(e.removed=!0)}function C$e(){let t=10;for(;B4&&t--;){B4=null;const e=R$e(),n=vM.acquire();for(const r of e){const i=r.uid;I$e(r),i===r.uid&&r.removed&&n.push(r)}for(const r of np)r.removed&&(n.push(r),np.delete(r));for(const r of n)bB.pool.release(r);vM.release(n),vM.release(e),i9.forEach(r=>r())}}function R$e(){const t=vM.acquire();t.length=np.size;let e=0;for(const n of np)t[e]=n,++e;return np.clear(),t}const i9=new Set;function M$e(t){return i9.add(t),Zn(()=>i9.delete(t))}function N$e(t,e,n){let r=Xfe(t,e,n,(i,s,o)=>{let a,l,c=fpe(()=>gI(i,s),(u,h)=>{i.__accessor__?.lifecycle===ic.DESTROYED||a&&a.uid!==l?r.remove():(a||(a=bB.acquireUntracked(u,o,h,i,s),l=a.uid),W4(a))});return Zn(()=>{c.remove(),a&&(a.uid!==l||a.removed||(a.removed=!0,W4(a)),a=null),r=c=null})});return r}function O$e(t,e,n){const r=Xfe(t,e,n,(i,s,o)=>{let a=!1;return dpe(()=>gI(i,s),(l,c)=>{i.__accessor__.lifecycle!==ic.DESTROYED?a||(a=!0,rB(c,l)||o.call(i,l,c,s,i),a=!1):r.remove()})});return r}function L$e(t,e,n,r=!1){return t.__accessor__&&t.__accessor__.lifecycle!==ic.DESTROYED?r?O$e(t,e,n):N$e(t,e,n):Zn()}function D$e(t,e,n){let r,i,s=fpe(t,(o,a)=>{r&&r.uid!==i?s.remove():(r||(r=bB.acquireTracked(o,e,a,n),i=r.uid),W4(r))});return Zn(()=>{s.remove(),r&&(r.uid!==i||r.removed||(r.removed=!0,W4(r)),r=null),s=null})}function j$e(t,e,n){let r=!1;return dpe(t,(i,s)=>{r||(r=!0,n(s,i)||e(i,s),r=!1)})}function $$e(t,e,n=!1,r=afe){return n?j$e(t,e,r):D$e(t,e,r)}function hee(t){return hpe(np,e=>e.oldValue===t)}const r1=()=>kt.getLogger("esri.core.accessorSupport.ensureTypes");function F$e(t){if(t==null)return t;const e=new Date(t);return isNaN(e.getTime())?(r1().error("Accessor#set",`Invalid date value: '${t}', falling back to current date`),new Date):e}function V$e(t){return t==null?t:!!t}function z$e(t){return t==null?t:t.toString()}function sc(t,e=0){return t==null?t:(t=parseFloat(t),isNaN(t)?e:t)}function EB(t){return t==null?t:Math.round(parseFloat(t))}function G$e(t){return null}function U$e(t,e){return n=>{let r=t(n);return e.step!=null&&(r=Math.round(r/e.step)*e.step),e.min!=null&&(r=Math.max(e.min,r)),e.max!=null&&(r=Math.min(e.max,r)),r}}function ype(t){return t?.constructor&&t.constructor.__accessorMetadata__!==void 0}function H4(t,e){return e!=null&&t&&!(e instanceof t)}function vpe(t){return t&&"isCollection"in t}function dee(t){return t?.Type?typeof t.Type=="function"?t.Type:t.Type.base:null}function B$e(t,e){if(!e?.constructor||!vpe(e.constructor))return s9(t,e)?e:new t(e);const n=dee(t.prototype.itemType),r=dee(e.constructor.prototype.itemType);return n?r?n===r?e:n.prototype.isPrototypeOf(r.prototype)?new t(e):(s9(t,e),e):new t(e):e}function s9(t,e){return!!ype(e)&&(r1().error("Accessor#set","Assigning an instance of '"+(e.declaredClass||"unknown")+"' which is not a subclass of '"+CO(t)+"'"),!0)}function PO(t,e){return e==null?e:vpe(t)?B$e(t,e):H4(t,e)?s9(t,e)?e:new t(e):e}function CO(t){return t?.prototype?.declaredClass||"unknown"}const W$e=new WeakMap;function H$e(t){switch(t){case Number:return e=>sc(e);case Dr:return EB;case Boolean:return V$e;case String:return z$e;case Date:return F$e;case SB:return G$e;default:return fI(W$e,t,()=>PO.bind(null,t))}}function Ha(t,e){const n=H$e(t);return arguments.length===1?n:n(e)}function Vk(t,e,n){return arguments.length===1?Vk.bind(null,t):e&&(Array.isArray(e)?e.map(r=>t(r,n)):[t(e,n)])}function q$e(t,e){return arguments.length===1?Vk(n=>Ha(t,n)):Vk(n=>Ha(t,n),e)}function _pe(t,e,n){return e!==0&&Array.isArray(n)?n.map(r=>_pe(t,e-1,r)):t(n)}function q4(t,e,n){if(arguments.length===2)return s=>q4(t,e,s);if(!n)return n;n=_pe(t,e,n);let r=e,i=n;for(;r>0&&Array.isArray(i);)r--,i=i[0];if(i!==void 0)for(let s=0;s<r;s++)n=[n];return n}function K$e(t,e,n){return arguments.length===2?q4(r=>Ha(t,r),e):q4(r=>Ha(t,r),e,n)}function xpe(t){return!!Array.isArray(t)&&!t.some(e=>{const n=typeof e;return!(n==="string"||n==="number"||n==="function"&&t.length>1)})}function o9(t,e){if(arguments.length===2)return o9(t).call(null,e);const n=new Set,r=t.filter(a=>typeof a!="function"),i=t.filter(a=>typeof a=="function");for(const a of t)typeof a!="string"&&typeof a!="number"||n.add(a);let s=null,o=null;return(a,l)=>{if(a==null)return a;const c=typeof a,u=c==="string"||c==="number";return u&&(n.has(a)||i.some(h=>c==="string"&&h===String||c==="number"&&h===Number))||c==="object"&&i.some(h=>!H4(h,a))?a:(u&&r.length?(s||(s=r.map(h=>typeof h=="string"?`'${h}'`:`${h}`).join(", ")),r1().error("Accessor#set",`'${a}' is not a valid value for this property, only the following values are valid: ${s}`)):typeof a=="object"&&i.length?(o||(o=i.map(h=>CO(h)).join(", ")),r1().error("Accessor#set",`'${a}' is not a valid value for this property, value must be one of ${o}`)):r1().error("Accessor#set",`'${a}' is not a valid value for this property`),l&&(l.valid=!1),null)}}function Fg(t,e){if(arguments.length===2)return Fg(t).call(null,e);const n={},r=[],i=[];for(const l in t.typeMap){const c=t.typeMap[l];n[l]=Ha(c),r.push(CO(c)),i.push(l)}const s=()=>`'${r.join("', '")}'`,o=()=>`'${i.join("', '")}'`,a=typeof t.key=="string"?l=>l[t.key]:t.key;return l=>{if(t.base&&!H4(t.base,l)||l==null)return l;const c=a(l)||t.defaultKeyValue,u=n[c];if(!u)return r1().error("Accessor#set",`Invalid property value, value needs to be one of ${s()}, or a plain object that can autocast (having .type = ${o()})`),null;if(!H4(t.typeMap[c],l))return l;if(typeof t.key=="string"&&!ype(l)){const h={};for(const f in l)f!==t.key&&(h[f]=l[f]);return u(h)}return u(l)}}let Dr=class{},SB=class{};const XIt={native:t=>({type:"native",value:t}),array:t=>({type:"array",value:t}),oneOf:t=>({type:"one-of",values:t})};function Y$e(t){if(!t||!("type"in t))return!1;switch(t.type){case"native":case"array":case"one-of":return!0}return!1}function wpe(t){switch(t.type){case"native":return Ha(t.value);case"array":return Vk(wpe(t.value));case"one-of":return X$e(t);default:return null}}function X$e(t){let e=null;return(n,r)=>l9(n,t)?n:(e==null&&(e=a9(t)),r1().error("Accessor#set",`Invalid property value, value needs to be of type ${e}`),r&&(r.valid=!1),null)}function a9(t){switch(t.type){case"native":switch(t.value){case Number:return"number";case String:return"string";case Boolean:return"boolean";case Dr:return"integer";case Date:return"date";case SB:return"null";default:return CO(t.value)}case"array":return`array of ${a9(t.value)}`;case"one-of":{const e=t.values.map(n=>a9(n));return`one of ${e.slice(0,-1)} or ${e[e.length-1]}`}}return"unknown"}function l9(t,e){if(t==null)return!0;switch(e.type){case"native":switch(e.value){case Number:case Dr:return typeof t=="number";case Boolean:return typeof t=="boolean";case String:return typeof t=="string";case SB:return t===null}return t instanceof e.value;case"array":return!!Array.isArray(t)&&!t.some(n=>!l9(n,e.value));case"one-of":return e.values.some(n=>l9(t,n))}}function E(t={}){return(e,n)=>{if(e===Function.prototype)throw new Error(`Inappropriate use of @property() on a static field: ${e.name}.${n}. Accessor does not support static properties.`);const r=Object.getOwnPropertyDescriptor(e,n),i=yI(e,n);r&&(r.get||r.set?(i.get=r.get||i.get,i.set=r.set||i.set):"value"in r&&("value"in t&&kt.getLogger("esri.core.accessorSupport.decorators.property").warn(`@property() will redefine the value of "${n}" on "${e.constructor.name}" already defined in the metadata`,t),i.value=t.value=r.value)),t.readOnly!=null&&(i.readOnly=t.readOnly);const s=t.aliasOf;if(s){const l=typeof s=="string"?s:s.source,c=typeof s=="string"?null:s.overridable===!0;let u;i.dependsOn=[l],i.get=function(){let h=yd(this,l);if(typeof h=="function"){u||(u=l.split(".").slice(0,-1).join("."));const f=yd(this,u);f&&(h=h.bind(f))}return h},i.readOnly||(i.set=c?function(h){this._override(n,h)}:function(h){F4(this,l,h)})}const o=t.type,a=t.types;if(!i.cast){let l;o?l=Z$e(o):a&&(l=Array.isArray(a)?Vk(Fg(a[0])):Fg(a)),t.cast=J$e(t.cast,l)}Uje(i,t),t.range&&(i.cast=U$e(i.cast,t.range))}}function TB(t,e,n){const r=yI(t,n);r.json||(r.json={});let i=r.json;return e!==void 0&&(i.origins||(i.origins={}),i.origins[e]||(i.origins[e]={}),i=i.origins[e]),i}function Z$e(t){let e=0,n=t;if(Y$e(t))return wpe(t);for(;Array.isArray(n)&&n.length===1&&typeof n[0]!="string"&&typeof n[0]!="number";)n=n[0],e++;const r=n;if(xpe(r))return e===0?o9(r):q4(o9(r),e);if(e===1)return q$e(r);if(e>1)return K$e(r,e);const i=t;return i.from?i.from:Ha(i)}function J$e(t,e){if(t||e)return t?e?(n,r)=>e(t(n,r),r):t:e}function Q$e(t){if(t.json&&t.json.origins){const e=t.json.origins,n={"web-document":["web-scene","web-map"]};for(const r in n)if(e[r]){const i=e[r];n[r].forEach(s=>{e[s]=i}),delete e[r]}}}let Ld=class extends dfe{constructor(e,n,r){super(e,n,r)}};Ld.prototype.type="warning";function bpe(t){return!!t&&t.prototype?.declaredClass&&t.prototype.declaredClass.indexOf("esri.core.Collection")===0}function eFe(t,e){return kB(t,"any",e?.origin)}function K4(t,e){return kB(t,"read",e?.origin)}function Epe(t,e){return kB(t,"write",e?.origin)}function kB(t,e,n){let r=t?.json;if(r?.origins&&n){let i;i=n==="link-chart"?r.origins[n]&&(e==="any"||e in r.origins[n])?r.origins[n]:r.origins["web-map"]:r.origins[n],i&&(e==="any"||e in i)&&(r=i)}return r}const c9=()=>kt.getLogger("esri.core.accessorSupport.extensions.serializableProperty.reader");function fee(t,e,n){t&&(!n&&!e.read||e.read?.reader||e.read?.enabled===!1||rFe(t)&&rb("read.reader",AB(t),e))}function AB(t){const e=t.ndimArray??0;if(e>1)return nFe(t);if(e===1)return pee(t);if("type"in t&&Tpe(t.type)){const n=t.type.prototype?.itemType?.Type,r=pee(typeof n=="function"?{type:n}:{types:n});return(i,s,o)=>{const a=r(i,s,o);return a&&new t.type(a)}}return IB(t)}function IB(t){return"type"in t?tFe(t.type):iFe(t.types)}function tFe(t){return t.prototype.read?(e,n,r)=>{if(e==null)return e;const i=typeof e;if(i!=="object")return void c9().error(`Expected JSON value of type 'object' to deserialize type '${t.prototype.declaredClass}', but got '${i}'`);const s=new t;return s.read(e,r),s}:t.fromJSON}function Spe(t,e,n,r){return r!==0&&Array.isArray(e)?e.map(i=>Spe(t,i,n,r-1)):t(e,void 0,n)}function nFe(t){const e=IB(t),n=Spe.bind(null,e),r=t.ndimArray??0;return(i,s,o)=>{if(i==null)return i;i=n(i,o,r);let a=r,l=i;for(;a>0&&Array.isArray(l);)a--,l=l[0];if(l!==void 0)for(let c=0;c<a;c++)i=[i];return i}}function pee(t){const e=IB(t);return(n,r,i)=>{if(n==null)return n;if(Array.isArray(n)){const o=[];for(const a of n){const l=e(a,void 0,i);l!==void 0&&o.push(l)}return o}const s=e(n,void 0,i);return s!==void 0?[s]:void 0}}function Tpe(t){if(!bpe(t))return!1;const e=t.prototype.itemType;return!(!e||!e.Type)&&(typeof e.Type=="function"?PB(e.Type):kpe(e.Type))}function rFe(t){return"types"in t?kpe(t.types):PB(t.type)}function PB(t){return!Array.isArray(t)&&!!t&&t.prototype&&("read"in t.prototype||"fromJSON"in t||Tpe(t))}function kpe(t){for(const e in t.typeMap)if(!PB(t.typeMap[e]))return!1;return!0}function iFe(t){let e=null;const n=t.errorContext??"type",r=t.validate;return(i,s,o)=>{if(i==null)return i;const a=typeof i;if(a!=="object")return void c9().error(`Expected JSON value of type 'object' to deserialize, but got '${a}'`);e||(e=oFe(t));const l=t.key;if(typeof l!="string")return;const c=i[sFe(l,e,o)],u=c?e[c]:t.defaultKeyValue?t.typeMap[t.defaultKeyValue]:void 0;if(!u){const f=`Type '${c||"unknown"}' is not supported`;return o?.messages&&i&&o.messages.push(new Ld(`${n}:unsupported`,f,{definition:i,context:o})),void c9().error(f)}const h=new u;return h.read(i,o),r?r(h):h}}function sFe(t,e,n){const r=Object.values(e)[0],i=ub(r.prototype)[t],s=K4(i,n),o=s?.read?.source;return o&&typeof o=="string"?o:t}function oFe(t){const e={};for(const n in t.typeMap){const r=t.typeMap[n],i=ub(r.prototype);if(typeof t.key=="function")continue;const s=i[t.key];if(!s)continue;if(s.json?.type&&Array.isArray(s.json.type)&&s.json.type.length===1&&typeof s.json.type[0]=="string"){e[s.json.type[0]]=r;continue}const o=s.json?.write;if(!o?.writer){e[n]=r;continue}const a=o.target,l=typeof a=="string"?a:t.key,c={};o.writer(n,c,l),c[l]&&(e[c[l]]=r)}return e}function aFe(t){if(t.json||(t.json={}),gee(t.json),yee(t.json),mee(t.json),t.json.origins)for(const e in t.json.origins)gee(t.json.origins[e]),yee(t.json.origins[e]),mee(t.json.origins[e]);return!0}function mee(t){t.name&&(t.read&&typeof t.read=="object"?t.read.source===void 0&&(t.read.source=t.name):t.read={source:t.name},t.write&&typeof t.write=="object"?t.write.target===void 0&&(t.write.target=t.name):t.write={target:t.name})}function gee(t){typeof t.read=="boolean"?t.read={enabled:t.read}:typeof t.read=="function"?t.read={enabled:!0,reader:t.read}:t.read&&typeof t.read=="object"&&t.read.enabled===void 0&&(t.read.enabled=!0)}function yee(t){typeof t.write=="boolean"?t.write={enabled:t.write}:typeof t.write=="function"?t.write={enabled:!0,writer:t.write}:t.write&&typeof t.write=="object"&&t.write.enabled===void 0&&(t.write.enabled=!0)}function vee(t,e){if(!e.write||e.write.writer||e.write.enabled===!1&&!e.write.overridePolicy)return;const n=t?.ndimArray??0;t&&(n===1||"type"in t&&bpe(t.type))?e.write.writer=uFe:n>1?e.write.writer=hFe(n):e.types?Array.isArray(e.types)?e.write.writer=cFe(e.types[0]):e.write.writer=lFe(e.types):e.write.writer=zk}function lFe(t){return(e,n,r,i)=>e?Ape(e,t,i)?zk(e,n,r,i):void 0:zk(e,n,r,i)}function Ape(t,e,n){for(const r in e.typeMap)if(t instanceof e.typeMap[r])return!0;if(n?.messages){const r=e.errorContext??"type",i=`Values of type '${(typeof e.key!="function"?t[e.key]:t.declaredClass)??"Unknown"}' cannot be written`;n&&n.messages&&t&&n.messages.push(new Xe(`${r}:unsupported`,i,{definition:t,context:n})),kt.getLogger("esri.core.accessorSupport.extensions.serializableProperty.writer").error(i)}return!1}function cFe(t){return(e,n,r,i)=>!e||!Array.isArray(e)?zk(e,n,r,i):zk(e.filter(s=>Ape(s,t,i)),n,r,i)}function zk(t,e,n,r){rb(n,Y4(t,r),e)}function Y4(t,e){return t&&typeof t.write=="function"?t.write({},e):t&&typeof t.toJSON=="function"?t.toJSON():typeof t=="number"?X4(t):t}function X4(t){return t===-1/0?-Number.MAX_VALUE:t===1/0?Number.MAX_VALUE:isNaN(t)?null:t}function uFe(t,e,n,r){let i;t===null?i=null:t&&typeof t.map=="function"?(i=t.map(s=>Y4(s,r)),typeof i.toArray=="function"&&(i=i.toArray())):i=[Y4(t,r)],rb(n,i,e)}function Ipe(t,e,n){return n!==0&&Array.isArray(t)?t.map(r=>Ipe(r,e,n-1)):Y4(t,e)}function hFe(t){return(e,n,r,i)=>{let s;if(e===null)s=null;else{s=Ipe(e,i,t);let o=t,a=s;for(;o>0&&Array.isArray(a);)o--,a=a[0];if(a!==void 0)for(let l=0;l<o;l++)s=[s]}rb(r,s,n)}}function dFe(t){const e=fFe(t);if(t.json.origins)for(const n in t.json.origins){const r=t.json.origins[n],i=r.types?pFe(r):e;fee(i,r,!1),r.types&&!r.write&&t.json.write?.enabled&&(r.write={...t.json.write}),vee(i,r)}fee(e,t.json,!0),vee(e,t.json)}function fFe(t){return t.json.types?u9(t.json):t.type?Ppe(t):u9(t)}function pFe(t){return t.type?Ppe(t):u9(t)}function Ppe(t){if(!t.type)return;let e=0,n=t.type;for(;Array.isArray(n)&&!xpe(n);)n=n[0],e++;return{type:n,ndimArray:e}}function u9(t){if(!t.types)return;let e=0,n=t.types;for(;Array.isArray(n);)n=n[0],e++;return{types:n,ndimArray:e}}function mFe(t){aFe(t)&&(Q$e(t),dFe(t))}const xj=new Set,wj=new Set;function ue(t){return e=>{t??="esri.core.Accessor",e.prototype.declaredClass=t,yFe(e);const n=[],r=[];let i=e.prototype;for(;i;)i.hasOwnProperty("initialize")&&!xj.has(i.initialize)&&(xj.add(i.initialize),n.push(i.initialize)),i.hasOwnProperty("destroy")&&!wj.has(i.destroy)&&(wj.add(i.destroy),r.push(i.destroy)),i=Object.getPrototypeOf(i);xj.clear(),wj.clear();const s=class extends e{constructor(...a){if(super(...a),this.constructor===s&&typeof this.postscript=="function"){if(n.length&&Object.defineProperty(this,"initialize",{enumerable:!1,configurable:!0,value(){for(let l=n.length-1;l>=0;l--)n[l].call(this)}}),r.length){let l=!1;const c=this[Kfe];Object.defineProperty(this,"destroy",{enumerable:!1,configurable:!0,value(){if(!l){this.__accessor__.lifecycle=ic.DESTROYING,l=!0,c.call(this);for(let u=0;u<r.length;u++)r[u].call(this)}}})}Object.defineProperty(this,Symbol.dispose,{enumerable:!1,configurable:!0,value(){this.destroy()}}),this.postscript()}}};s.__accessorMetadata__=ub(e.prototype),s.prototype.declaredClass=t;const o=(t||"AccessorSubclass").split(".").slice(-1)[0];return Object.defineProperty(s,"name",{value:o,configurable:!0}),s}}function gFe(t,e){return e.get==null?function(){const n=this.__accessor__,r=n.propertiesByName.get(t);if(r===void 0)return;n.mutable&&nn(r);const i=n.store;return i.has(t)?i.get(t):r.metadata.value}:function(){const n=this.__accessor__,r=n.propertiesByName.get(t);if(r!==void 0)return r.getComputed(n)}}function yFe(t){const e=t.prototype,n=ub(e),r={};for(const i of Object.getOwnPropertyNames(n)){const s=n[i];mFe(s),r[i]={enumerable:!0,configurable:!0,get:gFe(i,s),set(o){const a=this.__accessor__;if(a!==void 0){if(a.mutable)return a.initialized&&s.readOnly?_ee("read-only",i):a.lifecycle===ic.CONSTRUCTED&&s.constructOnly?_ee("construct-only",i):void a.set(i,o)}else Object.defineProperty(this,i,{enumerable:!0,configurable:!0,writable:!0,value:o})}}}Object.defineProperties(t.prototype,r)}const _ee=(t,e)=>{kt.getLogger("esri.core.Accessor").error(`cannot assign to ${t} property '${e}'`)};var xee,wee;function vFe(t){if(t==null)return{value:t};if(Array.isArray(t))return{type:[t[0]],value:null};switch(typeof t){case"object":return t.constructor?.__accessorMetadata__||t instanceof Date?{type:t.constructor,value:t}:t;case"boolean":return{type:Boolean,value:t};case"string":return{type:String,value:t};case"number":return{type:Number,value:t};case"function":return{type:t,value:null};default:return}}const am=Symbol("Accessor-Handles"),bj=Symbol("Accessor-Initialized");var Ig;let Kt=(Ig=class{static createSubclass(e={}){if(Array.isArray(e))throw new Error("Multi-inheritance unsupported since 4.16");const{properties:n,declaredClass:r,constructor:i}=e;delete e.declaredClass,delete e.properties,delete e.constructor;const s=this;class o extends s{constructor(...l){super(...l),this.inherited=null,i&&i.apply(this,l)}}ub(o.prototype);for(const a in e){const l=e[a];o.prototype[a]=typeof l=="function"?function(...c){const u=this.inherited;let h;this.inherited=function(...f){if(s.prototype[a])return s.prototype[a].apply(this,f)};try{h=l.apply(this,c)}catch(f){throw this.inherited=u,f}return this.inherited=u,h}:e[a]}for(const a in n){const l=vFe(n[a]);E(l)(o.prototype,a)}return ue(r)(o)}static freeze(e){return e instanceof Ig?e.__accessor__.mutable=!1:Object.freeze(e),e}static isFrozen(e){return e instanceof Ig?!e.__accessor__.mutable:Object.isFrozen(e)}constructor(...e){if(this[xee]=null,this[wee]=!1,this.constructor===Ig)throw new Error("[accessor] cannot instantiate Accessor. This can be fixed by creating a subclass of Accessor");const n=new Jje(this);Object.defineProperty(this,"__accessor__",{enumerable:!1,value:n}),e.length>0&&(n.ctorArgs=this.normalizeCtorArgs?.apply(this,e)??e[0])}postscript(){const e=this.__accessor__,n=e.ctorArgs;e.initialize(),n&&(this.set(n),e.ctorArgs=null),e.constructed(),this.initialize(),this[bj]=!0}initialize(){}[Kfe](){this[am]=Di(this[am])}destroy(){this.destroyed||(P$e(this),this.__accessor__.destroy(),i$e()?.onInstanceDestroy(this))}[Symbol.dispose](){this.destroy()}get constructed(){return this.__accessor__&&this.__accessor__.initialized||!1}get initialized(){return this[bj]}get destroyed(){return this.__accessor__?.lifecycle===ic.DESTROYED||!1}get destroying(){return this.__accessor__?.lifecycle===ic.DESTROYING||!1}commitProperty(e){yd(this,e)}hasOwnProperty(e){return this.__accessor__?this.__accessor__.has(e):Object.prototype.hasOwnProperty.call(this,e)}keys(){return this.__accessor__?this.__accessor__.keys():[]}set(e,n){return F4(this,e,n),this}watch(e,n,r){return qfe(kt.getLogger(this),"`watch` is deprecated in favor of reactiveUtils.watch",{replacement:"reactiveUtils.watch",version:"4.32",see:"https://arcg.is/1vaqf42#watch",warnOnce:!0}),L$e(this,e,n,r)}addHandles(e,n){if(this.destroyed){const r=Array.isArray(e)?e:[e];for(const i of r)i.remove();return}(this[am]??=new cb).add(e,n)}removeHandles(e){this[am]?.remove(e)}removeAllHandles(){this[am]?.removeAll()}removeHandlesReference(e){this[am]?.removeReference(e)}hasHandles(e){return this[am]?.has(e)===!0}_override(e,n){n===void 0?this.__accessor__.clearOverride(e):this.__accessor__.override(e,n)}_clearOverride(e){return this.__accessor__.clearOverride(e)}_overrideIfSome(e,n){n==null?this.__accessor__.clearOverride(e):this.__accessor__.override(e,n)}_isOverridden(e){return this.__accessor__.isOverridden(e)}notifyChange(e){this.__accessor__.notifyChange(e)}_get(e){return this.__accessor__.internalGet(e)}_set(e,n){return this.__accessor__.internalSet(e,n),this}},xee=am,wee=bj,Ig);const RO=t=>{const e=t;class n extends e{constructor(){super(...arguments),this._listenersMap=null}clearEvents(){this._listenersMap?.clear(),this._listenersMap=null}destroy(){this.clearEvents()}emit(i,s){let o=this._listenersMap?.get(i);if(!o)return!1;let a=!1;for(const l of o.slice()){const c="deref"in l?l.deref():l;c?c?.call(this,s):a=!0}return a&&(o=o.filter(l=>!("deref"in l)||l.deref()!=null),this._listenersMap.set(i,o)),o.length>0}on(i,s){if(Array.isArray(i)){const a=i.map(l=>this.on(l,s));return fv(a)}if(i.includes(","))throw new TypeError("Evented.on() with a comma delimited string of event types is not supported");this._listenersMap??=new Map;const o=this._listenersMap.get(i)||[];return o.push(s),this._listenersMap.set(i,o),Zn(()=>{const a=this._listenersMap?.get(i),l=a?.indexOf(s)??-1;l>=0&&a.splice(l,1)})}once(i,s){const o=this.on(i,a=>{o.remove(),("deref"in s?s.deref():s)?.call(null,a)});return o}hasEventListener(i){const s=this._listenersMap?.get(i);return s!=null&&s.length>0}}return n},Cpe=RO(class{}),_Fe=Cpe,vI=RO(Kt);function Rpe(t){return(e,n)=>{e[n]=t}}let _I=class extends Qfe{notify(){const e=this._observers;if(e&&e.length>0){const n=e.slice();for(const r of n)r.onInvalidated(),r.onCommitted()}}};var yf;let xFe=class{constructor(){this.target=null,this.cancellable=!1,this.defaultPrevented=!1,this.item=void 0,this.type=void 0}preventDefault(){this.cancellable&&(this.defaultPrevented=!0)}reset(e){this.defaultPrevented=!1,this.item=e}},wFe=class{constructor(e,n,r,i,s){this.target=e,this.added=n,this.removed=r,this.start=i,this.deleteCount=s}};const Oc=new lb(()=>new xFe,void 0,t=>{t.item=null,t.target=null,t.defaultPrevented=!1,t.cancellable=!1});function bee(t){t&&typeof t=="object"&&"destroy"in t&&typeof t.destroy=="function"&&t.destroy()}function Ej(t){return t?t instanceof Om?t.toArray():t.length?Array.prototype.slice.apply(t):[]:[]}function Sj(t){if(t?.length)return t[0]}function bFe(t,e,n,r){const i=Math.min(t.length-n,e.length-r);let s=0;for(;s<i&&t[n+s]===e[r+s];)s++;return s}function Mpe(t,e,n,r){e&&e.forEach((i,s,o)=>{t.push(i),Mpe(t,n.call(r,i,s,o),n,r)})}const lm=new Set,cm=new Set,um=new Set,Tj=new Map;let EFe=0,Om=yf=class extends vI{static ofType(t){if(!t)return yf;if(Tj.has(t))return Tj.get(t);let e=null;if(typeof t=="function")e=t.prototype.declaredClass;else if(t.base)e=t.base.prototype.declaredClass;else for(const r in t.typeMap){const i=t.typeMap[r].prototype.declaredClass;e?e+=` | ${i}`:e=i}let n=class extends yf{};return x([Rpe({Type:t,ensureType:typeof t=="function"?Ha(t):Fg(t)})],n.prototype,"itemType",void 0),n=x([ue(`esri.core.Collection<${e}>`)],n),Tj.set(t,n),n}static isCollection(t){return t!=null&&t instanceof yf}constructor(t){super(t),this._chgListeners=[],this._notifications=null,this._updating=!1,this._timer=null,this._observable=new _I,this.length=0,this._items=[],Object.defineProperty(this,"uid",{value:EFe++})}normalizeCtorArgs(t){return t?Array.isArray(t)||t instanceof yf?{items:t}:t:{}}destroy(){this._removeAllRaw(),this._timer&&this._timer.remove(),super.destroy(),this._notifications=null}*[Symbol.iterator](){yield*this.items}get items(){return nn(this._observable),this._items}set items(t){this._emitBeforeChanges(1)||(this._splice(0,this.length,Ej(t)),this._emitAfterChanges(1))}hasEventListener(t){return!this.destroyed&&(t==="change"?this._chgListeners.length>0:super.hasEventListener(t))}on(t,e){if(this.destroyed)return Zn();if(t==="change"){const n=this._chgListeners,r={removed:!1,callback:e};return n.push(r),this._notifications&&this._notifications.push({listeners:n.slice(),items:this._items.slice(),changes:[]}),Zn(()=>{r.removed=!0,n.splice(n.indexOf(r),1)})}return super.on(t,e)}once(t,e){const n="deref"in e?()=>e.deref():()=>e,r=this.on(t,i=>{n()?.call(null,i),r.remove()});return r}add(t,e){if(nn(this._observable),this._emitBeforeChanges(1))return this;const n=this.getNextIndex(e??null);return this._splice(n,0,[t]),this._emitAfterChanges(1),this}addMany(t,e=this._items.length){if(nn(this._observable),!t?.length)return this;if(this._emitBeforeChanges(1))return this;const n=this.getNextIndex(e);return this._splice(n,0,Ej(t)),this._emitAfterChanges(1),this}at(t){if(nn(this._observable),(t=Math.trunc(t)||0)<0&&(t+=this.length),!(t<0||t>=this.length))return this._items[t]}removeAll(){if(nn(this._observable),!this.length||this._emitBeforeChanges(2))return[];const t=this._removeAllRaw();return this._emitAfterChanges(2),t}_removeAllRaw(){return this.length===0?[]:this._splice(0,this.length)||[]}clone(){return nn(this._observable),this._createNewInstance({items:this._items.map(Ze)})}concat(...t){nn(this._observable);const e=t.map(Ej);return this._createNewInstance({items:this._items.concat(...e)})}drain(t,e){if(nn(this._observable),!this.length||this._emitBeforeChanges(2))return;const n=this._splice(0,this.length),r=n.length;for(let i=0;i<r;i++)t.call(e,n[i],i,n);this._emitAfterChanges(2)}destroyAll(){this.drain(bee)}destroyMany(t){const e=this.removeMany(t);return e.forEach(bee),e}every(t,e){return nn(this._observable),this._items.every(t,e)}filter(t,e){nn(this._observable);const n=arguments.length===2?this._items.filter(t,e):this._items.filter(t);return this._createNewInstance({items:n})}find(t,e){return nn(this._observable),this._items.find(t,e)}findIndex(t,e){return nn(this._observable),this._items.findIndex(t,e)}flatten(t,e){nn(this._observable);const n=[];return Mpe(n,this,t,e),new yf(n)}forEach(t,e){return nn(this._observable),this._items.forEach(t,e)}getItemAt(t){return nn(this._observable),this._items[t]}getNextIndex(t){nn(this._observable);const e=this.length;return(t=t??e)<0?t=0:t>e&&(t=e),t}includes(t,e=0){return nn(this._observable),this._items.includes(t,e)}indexOf(t,e=0){return nn(this._observable),this._items.indexOf(t,e)}join(t=","){return nn(this._observable),this._items.join(t)}lastIndexOf(t,e=this.length-1){return nn(this._observable),this._items.lastIndexOf(t,e)}map(t,e){nn(this._observable);const n=this._items.map(t,e);return new yf({items:n})}reorder(t,e=this.length-1){nn(this._observable);const n=this.indexOf(t);if(n!==-1){if(e<0?e=0:e>=this.length&&(e=this.length-1),n!==e){if(this._emitBeforeChanges(4))return t;this._splice(n,1),this._splice(e,0,[t]),this._emitAfterChanges(4)}return t}}pop(){if(nn(this._observable),!this.length||this._emitBeforeChanges(2))return;const t=Sj(this._splice(this.length-1,1));return this._emitAfterChanges(2),t}push(...t){return nn(this._observable),this._emitBeforeChanges(1)||(this._splice(this.length,0,t),this._emitAfterChanges(1)),this.length}reduce(t,e){nn(this._observable);const n=this._items;return arguments.length===2?n.reduce(t,e):n.reduce(t)}reduceRight(t,e){nn(this._observable);const n=this._items;return arguments.length===2?n.reduceRight(t,e):n.reduceRight(t)}remove(t){return nn(this._observable),this.removeAt(this.indexOf(t))}removeAt(t){if(nn(this._observable),t<0||t>=this.length||this._emitBeforeChanges(2))return;const e=Sj(this._splice(t,1));return this._emitAfterChanges(2),e}removeMany(t){if(nn(this._observable),!t?.length||this._emitBeforeChanges(2))return[];const e=t instanceof yf?t.toArray():t,n=this._items,r=[],i=e.length;for(let s=0;s<i;s++){const o=e[s],a=n.indexOf(o);if(a>-1){const l=1+bFe(e,n,s+1,a+1),c=this._splice(a,l);c&&c.length>0&&r.push.apply(r,c),s+=l-1}}return this._emitAfterChanges(2),r}reverse(){if(nn(this._observable),this._emitBeforeChanges(4))return this;const t=this._splice(0,this.length);return t&&(t.reverse(),this._splice(0,0,t)),this._emitAfterChanges(4),this}shift(){if(nn(this._observable),!this.length||this._emitBeforeChanges(2))return;const t=Sj(this._splice(0,1));return this._emitAfterChanges(2),t}slice(t=0,e=this.length){return nn(this._observable),this._createNewInstance({items:this._items.slice(t,e)})}some(t,e){return nn(this._observable),this._items.some(t,e)}sort(t){if(nn(this._observable),!this.length||this._emitBeforeChanges(4)||!this._requiresSort(t))return this;const e=this._splice(0,this.length);return arguments.length?e.sort(t):e.sort(),this._splice(0,0,e),this._emitAfterChanges(4),this}_requiresSort(t=(e,n)=>e===n?0:e<n?-1:1){const e=this.length-1;for(let n=0;n<e;n++)if(t(this.items[n],this.items[n+1])>0)return!0;return!1}splice(t,e,...n){nn(this._observable),arguments.length===1&&(e=this.length),e??=0;const r=(e?2:0)|(n.length?1:0);if(this._emitBeforeChanges(r))return[];const i=this._splice(t,e,n)||[];return this._emitAfterChanges(r),i}toArray(){return nn(this._observable),this._items.slice()}toJSON(t){return nn(this._observable),this.toArray().map(e=>P4(e)?e.toJSON(t):e)}toLocaleString(){return nn(this._observable),this._items.toLocaleString()}toString(){return nn(this._observable),this._items.toString()}unshift(...t){return nn(this._observable),!t.length||this._emitBeforeChanges(1)||(this._splice(0,0,t),this._emitAfterChanges(1)),this.length}_createNewInstance(t){return new this.constructor(t)}_splice(t,e,n){const r=this._items,i=this.itemType;let s,o;if(!this._notifications&&this.hasEventListener("change")&&(this._notifications=[{listeners:this._chgListeners.slice(),items:this._items.slice(),changes:[]}],this._timer&&this._timer.remove(),this._updating=!0,this._timer=hb(()=>this._dispatchChange())),t<0&&(t+=this.length),e){if(o=r.splice(t,e),this.hasEventListener("before-remove")){const a=Oc.acquire();a.target=this,a.cancellable=!0;for(let l=0,c=o.length;l<c;l++)s=o[l],a.reset(s),this.emit("before-remove",a),a.defaultPrevented&&(o.splice(l,1),r.splice(t,0,s),t+=1,l-=1,c-=1);Oc.release(a)}if(this.length=this._items.length,this.hasEventListener("after-remove")){const a=Oc.acquire();a.target=this,a.cancellable=!1;const l=o.length;for(let c=0;c<l;c++)a.reset(o[c]),this.emit("after-remove",a);Oc.release(a)}}if(n?.length){if(i){const u=[];for(const h of n){const f=i.ensureType(h);f==null&&h!=null||u.push(f)}n=u}const a=this.hasEventListener("before-add"),l=this.hasEventListener("after-add"),c=t===this.length;if(a||l){const u=Oc.acquire();u.target=this,u.cancellable=!0;const h=Oc.acquire();h.target=this,h.cancellable=!1;for(const f of n)a?(u.reset(f),this.emit("before-add",u),u.defaultPrevented||(c?r.push(f):r.splice(t++,0,f),this._set("length",r.length),l&&(h.reset(f),this.emit("after-add",h)))):(c?r.push(f):r.splice(t++,0,f),this._set("length",r.length),h.reset(f),this.emit("after-add",h));Oc.release(h),Oc.release(u)}else{if(c)for(const u of n)r.push(u);else r.splice(t,0,...n);this._set("length",r.length)}}if((n?.length||o?.length)&&this._notifyChangeEvent(n,o),this.hasEventListener("after-splice")){const a=new wFe(this,n,o,t,e);this.emit("after-splice",a)}return o}_emitBeforeChanges(t){let e=!1;if(this.hasEventListener("before-changes")){const n=Oc.acquire();n.target=this,n.cancellable=!0,n.type=t,this.emit("before-changes",n),e=n.defaultPrevented,Oc.release(n)}return e}_emitAfterChanges(t){if(this.hasEventListener("after-changes")){const e=Oc.acquire();e.target=this,e.cancellable=!1,e.type=t,this.emit("after-changes",e),Oc.release(e)}this._observable.notify()}_notifyChangeEvent(t,e){this.hasEventListener("change")&&this._notifications&&this._notifications[this._notifications.length-1].changes.push({added:t,removed:e})}get updating(){return this._updating}_dispatchChange(){if(this._timer&&(this._timer.remove(),this._timer=null),this._updating=!1,!this._notifications)return;const t=this._notifications;this._notifications=null;for(const e of t){const n=e.changes;lm.clear(),cm.clear(),um.clear();for(const{added:l,removed:c}of n){if(l)if(um.size===0&&cm.size===0)for(const u of l)lm.add(u);else for(const u of l)cm.has(u)?(um.add(u),cm.delete(u)):um.has(u)||lm.add(u);if(c)if(um.size===0&&lm.size===0)for(const u of c)cm.add(u);else for(const u of c)lm.has(u)?lm.delete(u):(um.delete(u),cm.add(u))}const r=Na.acquire();lm.forEach(l=>{r.push(l)});const i=Na.acquire();cm.forEach(l=>{i.push(l)});const s=this._items,o=e.items,a=Na.acquire();if(um.forEach(l=>{o.indexOf(l)!==s.indexOf(l)&&a.push(l)}),e.listeners&&(r.length||i.length||a.length)){const l={target:this,added:r,removed:i,moved:a},c=e.listeners.length;for(let u=0;u<c;u++){const h=e.listeners[u];h.removed||h.callback.call(this,l)}}Na.release(r),Na.release(i),Na.release(a)}lm.clear(),cm.clear(),um.clear()}};x([E()],Om.prototype,"_updating",void 0),x([E()],Om.prototype,"length",void 0),x([E()],Om.prototype,"items",null),x([E({readOnly:!0})],Om.prototype,"updating",null),Om=yf=x([ue("esri.core.Collection")],Om);const Ot=Om;function Sd(t,e,n=Ot){return e||(e=new n),e===t||e.destroyed||(e.removeAll(),SFe(t)?e.addMany(t):t&&e.add(t)),e}function Npe(t){return t}function SFe(t){return t&&(Array.isArray(t)||"items"in t&&Array.isArray(t.items))}let TFe=class Ope{constructor(){this._values=new Map,this.multipleOriginsSupported=!1}clone(e){const n=new Ope;return this._values.forEach((r,i)=>{e&&e.has(i)||n.set(i,Ze(r.value),r.origin)}),n}get(e,n){n=this._normalizeOrigin(n);const r=this._values.get(e);return n==null||r?.origin===n?r?.value:void 0}originOf(e){return this._values.get(e)?.origin??7}keys(e){e=this._normalizeOrigin(e);const n=[...this._values.keys()];return e==null?n:n.filter(r=>this._values.get(r)?.origin===e)}set(e,n,r){if((r=this._normalizeOrigin(r))===0){const i=this._values.get(e);if(i?.origin!=null&&i.origin>r)return}this._values.set(e,new kFe(n,r))}delete(e,n){(n=this._normalizeOrigin(n))!=null&&this._values.get(e)?.origin!==n||this._values.delete(e)}has(e,n){return(n=this._normalizeOrigin(n))!=null?this._values.get(e)?.origin===n:this._values.has(e)}isAtOrigin(e,n){return n=this._normalizeOrigin(n),this.has(e,n)&&this.originOf(e)===n}isBelowOrigin(e,n){return n=this._normalizeOrigin(n),!this.has(e)||this.originOf(e)<n}forEach(e){this._values.forEach(({value:n},r)=>e(n,r))}_normalizeOrigin(e){if(e!=null)return e===0?e:7}},kFe=class{constructor(e,n){this.value=e,this.origin=n}};function AFe(t,e,n){e.keys().forEach(i=>{n.set(i,e.get(i),0)});const r=t.metadata;Object.keys(r).forEach(i=>{t.internalGet(i)&&n.set(i,t.internalGet(i),0)})}function IFe(t,e,n){if(!t?.read||t.read.enabled===!1||!t.read.source)return!1;const r=t.read.source;if(typeof r=="string"){if(r===e||r.includes(".")&&r.startsWith(e)&&iee(r,n))return!0}else for(const i of r)if(i===e||i.includes(".")&&i.startsWith(e)&&iee(i,n))return!0;return!1}function PFe(t){return t&&(!t.read||t.read.enabled!==!1&&!t.read.source)}function CFe(t,e,n,r,i){let s=K4(e[n],i);PFe(s)&&(t[n]=!0);for(const o of Object.getOwnPropertyNames(e))s=K4(e[o],i),IFe(s,n,r)&&(t[o]=!0)}function RFe(t,e,n,r){const i=n.metadata,s=eFe(i[e],r),o=s?.default;if(o===void 0)return;const a=typeof o=="function"?o.call(t,e,r):o;a!==void 0&&n.set(e,a)}const Lpe={origin:"service"};function MFe(t,e,n=Lpe){if(!e||typeof e!="object")return;const r=$g(t),i=r.metadata,s={};for(const o of Object.getOwnPropertyNames(e))CFe(s,i,o,e,n);r.setDefaultOrigin(n.origin);for(const o of Object.getOwnPropertyNames(s)){const a=K4(i[o],n).read,l=a?.source;let c;c=l&&typeof l=="string"?gI(e,l):e[o],a?.reader&&(c=a.reader.call(t,c,e,n)),c!==void 0&&r.set(o,c)}if(!n||!n.ignoreDefaults){r.setDefaultOrigin("defaults");for(const o of Object.getOwnPropertyNames(i))s[o]||RFe(t,o,r,n)}r.setDefaultOrigin("user")}function nPt(t,e,n,r=Lpe){const i={...r,messages:[]};n(i),i.messages?.forEach(s=>{s.type!=="warning"||t.loaded?r?.messages&&r.messages.push(s):t.loadWarnings.push(s)})}function NFe(t,e,n,r,i){const s={};return e.write?.writer?.call(t,r,s,n,i),s}function Dpe(t,e,n,r,i,s){if(!r?.write)return!1;const o=yd(t,n);if(!i&&r.write.overridePolicy){const a=r.write.overridePolicy.call(t,o,n,s??void 0);a!==void 0&&(i=a)}if(i||(i=r.write),!i||i.enabled===!1||i.layerContainerTypes&&s?.layerContainerType&&!i.layerContainerTypes.includes(s.layerContainerType))return!1;if((o===null&&!i.allowNull&&!i.writerEnsuresNonNull||o===void 0)&&i.isRequired){const a=new Xe("web-document-write:property-required",`Missing value for required property '${n}' on '${t.declaredClass}'`,{propertyName:n,target:t});return a&&s?.messages?s.messages.push(a):a&&!s&&kt.getLogger("esri.core.accessorSupport.write").error(a.name,a.message),!1}return!(o===void 0||o===null&&!i.allowNull&&!i.writerEnsuresNonNull||!i.alwaysWriteDefaults&&(!e.store.multipleOriginsSupported||e.store.originOf(n)===0)&&OFe(t,n,s,r,o)||!i.ignoreOrigin&&s?.origin&&e.store.multipleOriginsSupported&&e.store.originOf(n)<_B(s.origin))}function OFe(t,e,n,r,i){const s=r.default;if(s===void 0)return!1;if(r.defaultEquals!=null)return r.defaultEquals(i);if(typeof s=="function"){if(Array.isArray(i)){const o=s.call(t,e,n??void 0);return vO(o,i)}return!1}return s===i}function rPt(t,e,n,r){const i=$g(t),s=i.metadata,o=Epe(s[e],r);return!!o&&Dpe(t,i,e,o,n,r)}function LFe(t,e,n){if(t&&typeof t.toJSON=="function"&&(!t.toJSON.isDefaultToJSON||!t.write))return pM(e,t.toJSON(n));const r=$g(t),i=r.metadata;for(const s in i){const o=Epe(i[s],n);if(!Dpe(t,r,s,o,void 0,n))continue;const a=yd(t,s),l=NFe(t,o,o.write&&typeof o.write.target=="string"?o.write.target:s,a,n);Object.keys(l).length>0&&(e=pM(e,l),n?.resources?.pendingOperations?.length&&n.resources.pendingOperations.push(Promise.all(n.resources.pendingOperations).then(()=>pM(e,l,()=>"replace-arrays"))),n?.writtenProperties&&n.writtenProperties.push({target:t,propName:s,oldOrigin:Xje(r.store.originOf(s)),newOrigin:n.origin}))}return e}const o0=t=>{const e=t;let n=class extends e{constructor(...r){super(...r);const i=$g(this),s=i.store,o=new TFe;i.store=o,AFe(i,s,o)}read(r,i){MFe(this,r,i)}write(r,i){return LFe(this,r??{},i)}toJSON(r){return this.write({},r)}static fromJSON(r,i){return DFe.call(this,r,i)}};return n=x([ue("esri.core.JSONSupport")],n),n.prototype.toJSON.isDefaultToJSON=!0,n};function DFe(t,e){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");const n=new this;return n.read(t,e),n}const qt=o0(Kt);let jFe=class{constructor(){this._resolver=xc(),this._status=0,this._resolvingPromises=[],this._resolver.promise.then(()=>{this._status=1,this._cleanUp()},()=>{this._status=2,this._cleanUp()}),this.promise=this._resolver.promise}destroy(){this._cleanUp()}addResolvingPromise(e){this._resolvingPromises.push(e),this._tryResolve()}isResolved(){return this._status===1}isRejected(){return this._status===2}isFulfilled(){return this._status!==0}abort(){this._resolver.reject(Pr())}_cleanUp(){this._allPromise=null,this._resolvingPromises=null}_tryResolve(){if(this.isFulfilled())return;const e=xc(),n=[...this._resolvingPromises,e.promise],r=this._allPromise=Promise.all(n);r.then(()=>{this.isFulfilled()||this._allPromise!==r||this._resolver.resolve()},i=>{this.isFulfilled()||this._allPromise!==r||wa(i)||this._resolver.reject(i)}),e.resolve()}};const jpe=t=>{const e=t;let n=class extends e{constructor(...r){super(...r),this._promiseProps=new jFe,this.addResolvingPromise(Promise.resolve())}destroy(){this._promiseProps.destroy()}isResolved(){return this._promiseProps.isResolved()}isRejected(){return this._promiseProps.isRejected()}isFulfilled(){return this._promiseProps.isFulfilled()}when(r,i){return this._promiseProps.promise.then(()=>this).then(r,i)}catch(r){return this.when(null,r)}addResolvingPromise(r){r&&!this._promiseProps.isFulfilled()&&this._promiseProps.addResolvingPromise("_promiseProps"in r?r.when():r)}addResolvingTask(r){r&&!this._promiseProps.isFulfilled()&&(this.addHandles(J6e(r)),this._promiseProps.addResolvingPromise(r.promise))}};return n=x([ue("esri.core.Promise")],n),n},CB=jpe(Kt),$Fe="not-loaded",FFe="loading",VFe="failed",Eee="loaded",zFe=t=>{const e=t;let n=class extends e{constructor(...r){super(...r),this._loadController=null,this.loadError=null,this.loadStatus="not-loaded",this._set("loadWarnings",[]),this.addResolvingPromise(new Promise(i=>{const s=this.load.bind(this);this.load=o=>{const a=new Promise((l,c)=>{const u=fB(o,c);this.destroyed&&c(new Xe("load:instance-destroyed",`Instance of '${this.declaredClass||this.constructor.name}' is already destroyed`,{instance:this})),this.when(l,c).finally(()=>{u&&u.remove()})});if(this.loadStatus===$Fe){this._set("loadStatus",FFe);const l=this._loadController=new AbortController;s({signal:l.signal})}return i(),a}})),this.when(()=>{this._set("loadStatus",Eee),this._loadController=null},i=>{this.destroyed||(this._set("loadStatus",VFe),this._set("loadError",i),this._loadController=null)})}destroy(){this._loadController&&(this._loadController=$1(this._loadController),this._promiseProps.abort()),this._set("loadError",null),this._set("loadWarnings",[])}get loaded(){return this.loadStatus===Eee}get loadWarnings(){return this._get("loadWarnings")}load(r){return null}cancelLoad(){return this.isFulfilled()||(this._set("loadError",new Xe("load:cancelled","Cancelled")),this._loadController?.abort(),this._promiseProps.abort()),this}};return x([E({readOnly:!0})],n.prototype,"loaded",null),x([E({readOnly:!0})],n.prototype,"loadError",void 0),x([E({clonable:!1})],n.prototype,"loadStatus",void 0),x([E({type:[Ld],readOnly:!0})],n.prototype,"loadWarnings",null),n=x([ue("esri.core.Loadable")],n),n},xI=zFe(CB);function h9(t){return!(!t||!t.load)}function sPt(t,e,n){return pB(t.map((r,i)=>e.apply(n,[r,i])))}async function GFe(t,e,n){return(await pB(t.map((r,i)=>e.apply(n,[r,i])))).map(r=>r.value)}function RB(t){return{ok:!0,value:t}}function MB(t){return{ok:!1,error:t}}function UFe(t){return t!=null&&t.ok===!0?t.value:null}function BFe(t){return t!=null&&t.ok===!1?t.error:null}async function $pe(t){if(t==null)return{ok:!1,error:new Error("no promise provided")};try{return RB(await t)}catch(e){return MB(e)}}async function oPt(t){try{return RB(await t)}catch(e){return Nfe(e),MB(e)}}function MO(t,e){return new xm(t,e)}let xm=class extends Kt{get value(){return UFe(this._result)}get error(){return BFe(this._result)}get finished(){return this._result!=null}constructor(e,n){super({}),this._result=null,this._abortHandle=null,this.abort=()=>{this._abortController=$1(this._abortController)},this.remove=this.abort,this._abortController=new AbortController;const{signal:r}=this._abortController;this.promise=e(r),this.promise.then(i=>{this._result=RB(i),this._cleanup()},i=>{this._result=MB(i),this._cleanup()}),this._abortHandle=yu(n,this.abort)}normalizeCtorArgs(){return{}}destroy(){this.abort()}_cleanup(){this._abortHandle=ii(this._abortHandle),this._abortController=null}};x([E()],xm.prototype,"value",null),x([E()],xm.prototype,"error",null),x([E()],xm.prototype,"finished",null),x([E()],xm.prototype,"promise",void 0),x([E()],xm.prototype,"_result",void 0),xm=x([ue("esri.core.asyncUtils.ReactiveTask")],xm);async function Fpe(t,e){return await t.load(),WFe(t,e)}async function WFe(t,e){const n=[],r=(...s)=>{for(const o of s)o!=null&&(Array.isArray(o)?r(...o):Ot.isCollection(o)?o.forEach(a=>r(a)):h9(o)&&n.push(o))};e(r);let i=null;if(await GFe(n,async s=>{const o=await $pe(HFe(s)?s.loadAll():s.load());o.ok!==!1||i||(i=o)}),i)throw i.error;return t}function HFe(t){return"loadAll"in t&&typeof t.loadAll=="function"}function er(t,e,n){let r,i;return e===void 0?(i=t,r=[void 0]):typeof e!="string"?(i=t,r=[void 0],n=e):(i=e,r=Array.isArray(t)?t:[t]),(s,o)=>{const a=s.constructor.prototype;for(const l of r){const c=TB(s,l,i);c.write&&typeof c.write=="object"||(c.write={}),n&&(c.write.target=n),c.write.writer=a[o]}}}let Ys=class{constructor(e,n={ignoreUnknown:!1,useNumericKeys:!1}){this._jsonToAPI=e,this._options=n,this.apiValues=[],this.jsonValues=[],this._apiToJSON=qFe(e),this.apiValues=See(this._apiToJSON),this.jsonValues=See(this._jsonToAPI),this.read=r=>this.fromJSON(r),this.write=(r,i,s)=>{const o=this.toJSON(r);o!==void 0&&rb(s,o,i)},this.write.isJSONMapWriter=!0}toJSON(e){if(e==null)return null;if(this._apiToJSON.hasOwnProperty(e)){const n=this._apiToJSON[e];return this._options.useNumericKeys?+n:n}return this._options.ignoreUnknown?null:e}fromJSON(e){return e!=null&&this._jsonToAPI.hasOwnProperty(e)?this._jsonToAPI[e]:this._options.ignoreUnknown?void 0:e}};function qFe(t){const e={};for(const n in t)e[t[n]]=n;return e}function See(t){const e=[];for(const n in t)e.push(n);return e.sort(),e}function Ol(){return function(t,e){return new Ys(t,{ignoreUnknown:!0,...e})}}let NB=class{constructor(e,n,r,i,s,o){this.semiMajorAxis=e,this.flattening=n,this.outerAtmosphereRimWidth=r,this.atmosphereHeight=i,this.scaleHeight=s;const a=1-this.flattening;this.semiMinorAxis=this.semiMajorAxis*a,this.halfSemiMajorAxis=this.semiMajorAxis/2,this.halfCircumference=Math.PI*this.semiMajorAxis,this.metersPerDegree=this.halfCircumference/180,this.inverseFlattening=1/(1-this.flattening)-1,this.eccentricitySquared=o||2*this.flattening-this.flattening*this.flattening,this.meanRadiusSemiAxes=(2*this.semiMajorAxis+this.semiMinorAxis)/3}get radius(){return this.semiMajorAxis}};const is=new NB(6378137,1/298.257223563,3e5,1e5,.085,.006694379990137799),Td=new NB(3396190,1/169.8944472236118,23e4,6e4,.111),Vg=new NB(1737400,0,0,0,0);function Hi(t){if(!nr.assetsPath)throw kt.getLogger("esri.assets").errorOnce("The API assets location needs to be set using config.assetsPath. More information: https://arcg.is/1OzLe50"),new Xe("assets:path-not-set","config.assetsPath is not set");return hI(nr.assetsPath,t)}let kj,pe=null;function Vpe(){return!!pe}function KFe(){return!!ye("esri-wasm")}function YFe(){return kj||(kj=_e(async()=>{const{default:t}=await import("./pe-wasm-B87Q3u4k.js");return{default:t}},[]).then(({default:t})=>t({locateFile:e=>Hi(`esri/geometry/support/${e}`)})).then(t=>{Hpe(t)}),kj)}const _M={geogToProj(t,e,n){pe.ensureCache.prepare();const r=V1(n),i=n===r,s=pe.ensureFloat64(r),o=pe._pe_geog_to_proj(pe.getPointer(t),e,s);return o&&zg(n,e,s,i),o},projGeog(t,e,n,r){switch(r){case $i.PE_TRANSFORM_P_TO_G:return _M.projToGeog(t,e,n);case $i.PE_TRANSFORM_G_TO_P:return _M.geogToProj(t,e,n)}return 0},projToGeog:(t,e,n)=>_M.projToGeogCenter(t,e,n,0),projToGeogCenter(t,e,n,r){pe.ensureCache.prepare();const i=V1(n),s=n===i,o=pe.ensureFloat64(i),a=pe._pe_proj_to_geog_center(pe.getPointer(t),e,o,r);return a&&zg(n,e,o,s),a}};let $i=class pr{static init(){pr.PE_BUFFER_MAX=pe.PeDefs.prototype.PE_BUFFER_MAX,pr.PE_NAME_MAX=pe.PeDefs.prototype.PE_NAME_MAX,pr.PE_MGRS_MAX=pe.PeDefs.prototype.PE_MGRS_MAX,pr.PE_USNG_MAX=pe.PeDefs.prototype.PE_USNG_MAX,pr.PE_DD_MAX=pe.PeDefs.prototype.PE_DD_MAX,pr.PE_DDM_MAX=pe.PeDefs.prototype.PE_DDM_MAX,pr.PE_DMS_MAX=pe.PeDefs.prototype.PE_DMS_MAX,pr.PE_UTM_MAX=pe.PeDefs.prototype.PE_UTM_MAX,pr.PE_PARM_MAX=pe.PeDefs.prototype.PE_PARM_MAX,pr.PE_TYPE_NONE=pe.PeDefs.prototype.PE_TYPE_NONE,pr.PE_TYPE_GEOGCS=pe.PeDefs.prototype.PE_TYPE_GEOGCS,pr.PE_TYPE_PROJCS=pe.PeDefs.prototype.PE_TYPE_PROJCS,pr.PE_TYPE_GEOGTRAN=pe.PeDefs.prototype.PE_TYPE_GEOGTRAN,pr.PE_TYPE_COORDSYS=pe.PeDefs.prototype.PE_TYPE_COORDSYS,pr.PE_TYPE_UNIT=pe.PeDefs.prototype.PE_TYPE_UNIT,pr.PE_TYPE_LINUNIT=pe.PeDefs.prototype.PE_TYPE_LINUNIT,pr.PE_STR_OPTS_NONE=pe.PeDefs.prototype.PE_STR_OPTS_NONE,pr.PE_STR_AUTH_NONE=pe.PeDefs.prototype.PE_STR_AUTH_NONE,pr.PE_STR_AUTH_TOP=pe.PeDefs.prototype.PE_STR_AUTH_TOP,pr.PE_STR_NAME_CANON=pe.PeDefs.prototype.PE_STR_NAME_CANON,pr.PE_STR_FMT_WKT=pe.PeDefs.prototype.PE_STR_FMT_WKT,pr.PE_STR_FMT_WKT2=pe.PeDefs.prototype.PE_STR_FMT_WKT2,pr.PE_PARM_X0=pe.PeDefs.prototype.PE_PARM_X0,pr.PE_PARM_ND=pe.PeDefs.prototype.PE_PARM_ND,pr.PE_TRANSFORM_1_TO_2=pe.PeDefs.prototype.PE_TRANSFORM_1_TO_2,pr.PE_TRANSFORM_2_TO_1=pe.PeDefs.prototype.PE_TRANSFORM_2_TO_1,pr.PE_TRANSFORM_P_TO_G=pe.PeDefs.prototype.PE_TRANSFORM_P_TO_G,pr.PE_TRANSFORM_G_TO_P=pe.PeDefs.prototype.PE_TRANSFORM_G_TO_P,pr.PE_HORIZON_RECT=pe.PeDefs.prototype.PE_HORIZON_RECT,pr.PE_HORIZON_POLY=pe.PeDefs.prototype.PE_HORIZON_POLY,pr.PE_HORIZON_LINE=pe.PeDefs.prototype.PE_HORIZON_LINE,pr.PE_HORIZON_DELTA=pe.PeDefs.prototype.PE_HORIZON_DELTA}},zpe=null;const Tee={},kee={},Aee=t=>{const e=t.getType();switch(e){case $i.PE_TYPE_GEOGCS:t=pe.castObject(t,pe.PeGeogcs);break;case $i.PE_TYPE_PROJCS:t=pe.castObject(t,pe.PeProjcs);break;case $i.PE_TYPE_GEOGTRAN:t=pe.castObject(t,pe.PeGeogtran);break;default:e&$i.PE_TYPE_UNIT&&(t=pe.castObject(t,pe.PeUnit))}return t},H_={initialize(){pe.PeFactory.prototype.initialize(null)},coordsys:t=>H_.factoryByType($i.PE_TYPE_COORDSYS,t),factoryByType(t,e){let n=null,r=Tee[t];if(r||(r={},Tee[t]=r),r.hasOwnProperty(String(e))&&(n=r[e],pe.compare(n,pe.NULL)&&(n=null)),!n){const i=pe.PeFactory.prototype.factoryByType(t,e);pe.compare(i,pe.NULL)||(n=Aee(i),r[e]=n)}return n},fromString(t,e){let n=null,r=kee[t];if(r||(r={},kee[t]=r),r.hasOwnProperty(e)&&(n=r[e],pe.compare(n,pe.NULL)&&(n=null)),!n){const i=pe.PeFactory.prototype.fromString(t,e);pe.compare(i,pe.NULL)||(n=Aee(i),r[e]=n)}return n},geogcs:t=>H_.factoryByType($i.PE_TYPE_GEOGCS,t),geogtran:t=>H_.factoryByType($i.PE_TYPE_GEOGTRAN,t),getCode:t=>pe.PeFactory.prototype.getCode(t),projcs:t=>H_.factoryByType($i.PE_TYPE_PROJCS,t),unit:t=>H_.factoryByType($i.PE_TYPE_UNIT,t)};let Iee,Gpe=null;const OB={PE_GTLIST_OPTS_COMMON:0,init(){OB.PE_GTLIST_OPTS_COMMON=pe.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON,Iee=pe._pe_getPeGTlistExtendedEntrySize()},getGTlist(t,e,n,r,i,s){let o=null;const a=new pe.PeInteger(s);try{const l=pe.PeGTlistExtended.prototype.getGTlist(t,e,n,r,i,a);if((s=a.val)&&(o=[l],s>1)){const c=pe.getPointer(l);for(let u=1;u<s;u++)o.push(pe.wrapPointer(c+Iee*u,pe.PeGTlistExtendedEntry))}}finally{pe.destroy(a)}return o}},XFe={destroy(t){if(t?.length){for(const e of t)qu(e),e.getEntries().forEach(n=>{qu(n);const r=n.getGeogtran();qu(r),r.getParameters().forEach(qu),[r.getGeogcs1(),r.getGeogcs2()].forEach(i=>{qu(i);const s=i.getDatum();qu(s),qu(s.getSpheroid()),qu(i.getPrimem()),qu(i.getUnit())})});pe.PeGTlistExtendedEntry.prototype.Delete(t[0])}}},ZFe={geogToGeog(t,e,n,r,i){pe.ensureCache.prepare();const s=V1(n),o=n===s,a=pe.ensureFloat64(s);let l=0;r&&(l=pe.ensureFloat64(r));const c=pe._pe_geog_to_geog(pe.getPointer(t),e,a,l,i);return c&&zg(n,e,a,o),c}},JFe={geodesicCoordinate(t,e,n,r,i,s,o,a){pe.PeLineType.prototype.geodesic_coordinate(t,e,n,r,i,s,o,a)},geodeticCoordinate(t,e,n,r,i,s,o,a,l){pe.PeLineType.prototype.geodetic_coordinate(t,e,n,r,i,s,o,a,l)},geodeticDistance(t,e,n,r,i,s,o,a,l,c){pe.PeLineType.prototype.geodetic_distance(t,e,n,r,i,s,o,a,l,c)},greatEllipticDistance(t,e,n,r,i,s,o,a,l){pe.PeLineType.prototype.great_elliptic_distance(t,e,n,r,i,s,o,a,l)}},QFe={phiToEta:(t,e)=>pe.PeMath.prototype.phi_to_eta(t,e),etaToPhi:(t,e)=>pe.PeMath.prototype.eta_to_phi(t,e),phiToPhig:(t,e)=>pe.PeMath.prototype.phi_to_phig(t,e),q:(t,e,n)=>pe.PeMath.prototype.q(t,e,n),q90:(t,e)=>pe.PeMath.prototype.q90(t,e)},Aj=(t,e,n,r,i,s)=>{let o,a;switch(pe.ensureCache.prepare(),t){case"dd":o=pe._pe_geog_to_dd,a=$i.PE_DD_MAX;break;case"ddm":o=pe._pe_geog_to_ddm,a=$i.PE_DDM_MAX;break;case"dms":o=pe._pe_geog_to_dms,a=$i.PE_DMS_MAX}let l=0;e&&(l=pe.getPointer(e));const c=V1(r),u=pe.ensureFloat64(c),h=NO(n,a),f=o(l,n,u,i,pe.ensureInt32(h));if(f)for(let g=0;g<n;g++)s[g]=pe.UTF8ToString(h[g]);return f},Ij=(t,e,n,r,i)=>{let s;switch(pe.ensureCache.prepare(),t){case"dd":s=pe._pe_dd_to_geog;break;case"ddm":s=pe._pe_ddm_to_geog;break;case"dms":s=pe._pe_dms_to_geog}let o=0;e&&(o=pe.getPointer(e));const a=r.map(h=>pe.ensureString(h)),l=pe.ensureInt32(a),c=pe.ensureFloat64(new Array(2*n)),u=s(o,n,l,c);return u&&zg(i,n,c),u},e8e={geogToDms:(t,e,n,r,i)=>Aj("dms",t,e,n,r,i),dmsToGeog:(t,e,n,r)=>Ij("dms",t,e,n,r),geogToDdm:(t,e,n,r,i)=>Aj("ddm",t,e,n,r,i),ddmToGeog:(t,e,n,r)=>Ij("ddm",t,e,n,r),geogToDd:(t,e,n,r,i)=>Aj("dd",t,e,n,r,i),ddToGeog:(t,e,n,r)=>Ij("dd",t,e,n,r)};let Upe=class q_{static init(){q_.PE_MGRS_STYLE_NEW=pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW,q_.PE_MGRS_STYLE_OLD=pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD,q_.PE_MGRS_STYLE_AUTO=pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO,q_.PE_MGRS_180_ZONE_1_PLUS=pe.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS,q_.PE_MGRS_ADD_SPACES=pe.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES}static geogToMgrsExtended(e,n,r,i,s,o,a){pe.ensureCache.prepare();let l=0;e&&(l=pe.getPointer(e));const c=V1(r),u=pe.ensureFloat64(c),h=NO(n,$i.PE_MGRS_MAX),f=pe.ensureInt32(h),g=pe._pe_geog_to_mgrs_extended(l,n,u,i,s,o,f);if(g)for(let y=0;y<n;y++)a[y]=pe.UTF8ToString(h[y]);return g}static mgrsToGeogExtended(e,n,r,i,s){pe.ensureCache.prepare();let o=0;e&&(o=pe.getPointer(e));const a=r.map(h=>pe.ensureString(h)),l=pe.ensureInt32(a),c=pe.ensureFloat64(new Array(2*n)),u=pe._pe_mgrs_to_geog_extended(o,n,l,i,c);return u&&zg(s,n,c),u}};const t8e={geogToUsng(t,e,n,r,i,s,o){pe.ensureCache.prepare();let a=0;t&&(a=pe.getPointer(t));const l=V1(n),c=pe.ensureFloat64(l),u=NO(e,$i.PE_MGRS_MAX),h=pe.ensureInt32(u),f=pe._pe_geog_to_usng(a,e,c,r,i,s,h);if(f)for(let g=0;g<e;g++)o[g]=pe.UTF8ToString(u[g]);return f},usngToGeog(t,e,n,r){pe.ensureCache.prepare();let i=0;t&&(i=pe.getPointer(t));const s=n.map(c=>pe.ensureString(c)),o=pe.ensureInt32(s),a=pe.ensureFloat64(new Array(2*e)),l=pe._pe_usng_to_geog(i,e,o,a);return l&&zg(r,e,a),l}};let Bpe=class xM{static init(){xM.PE_UTM_OPTS_NONE=pe.PeNotationUtm.prototype.PE_UTM_OPTS_NONE,xM.PE_UTM_OPTS_ADD_SPACES=pe.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES,xM.PE_UTM_OPTS_NS=pe.PeNotationUtm.prototype.PE_UTM_OPTS_NS}static geogToUtm(e,n,r,i,s){pe.ensureCache.prepare();let o=0;e&&(o=pe.getPointer(e));const a=V1(r),l=pe.ensureFloat64(a),c=NO(n,$i.PE_UTM_MAX),u=pe.ensureInt32(c),h=pe._pe_geog_to_utm(o,n,l,i,u);if(h)for(let f=0;f<n;f++)s[f]=pe.UTF8ToString(c[f]);return h}static utmToGeog(e,n,r,i,s){pe.ensureCache.prepare();let o=0;e&&(o=pe.getPointer(e));const a=r.map(h=>pe.ensureString(h)),l=pe.ensureInt32(a),c=pe.ensureFloat64(new Array(2*n)),u=pe._pe_utm_to_geog(o,n,l,i,c);return u&&zg(s,n,c),u}};var dl;let Wpe=(dl=class{static init(){dl.PE_PCSINFO_OPTION_NONE=pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE,dl.PE_PCSINFO_OPTION_DOMAIN=pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN,dl.PE_POLE_OUTSIDE_BOUNDARY=pe.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY,dl.PE_POLE_POINT=pe.PePCSInfo.prototype.PE_POLE_POINT}static generate(e,n=dl.PE_PCSINFO_OPTION_DOMAIN){let r=null,i=null;return dl.cache.has(e)&&(i=dl.cache.get(e),i[n]&&(r=i[n])),r||(r=pe.PePCSInfo.prototype.generate(e,n),i||(i=[],dl.cache.set(e,i)),i[n]=r),r}},dl.cache=new Map,dl);const n8e={versionString:()=>pe.PeVersion.prototype.version_string()};function Hpe(t){function e(s,o,a){s[o]=a(s[o])}pe=t,$i.init(),OB.init(),Upe.init(),Bpe.init(),Wpe.init(),zpe=class extends pe.PeDouble{constructor(s=NaN){super(s)}destroy(){pe.destroy(this)}[Symbol.dispose](){this.destroy()}},Gpe=class extends pe.PeGCSExtent{destroy(){pe.destroy(this)}[Symbol.dispose](){this.destroy()}};const n=[pe.PeAngunit,pe.PeDatum,pe.PeGeogcs,pe.PeGeogtran,pe.PeObject,pe.PeParameter,pe.PePrimem,pe.PeProjcs,pe.PeSpheroid,pe.PeUnit];for(const s of n)e(s.prototype,"getName",o=>function(){return o.call(this,new Array($i.PE_NAME_MAX))});for(const s of[pe.PeGeogtran,pe.PeProjcs])e(s.prototype,"getParameters",o=>function(){const a=new Array($i.PE_PARM_MAX);let l=o.call(this);for(let c=0;c<a.length;c++){const u=pe.getValue(l,"*");a[c]=u?pe.wrapPointer(u,pe.PeParameter):null,l+=Int32Array.BYTES_PER_ELEMENT}return a});e(pe.PeHorizon.prototype,"getCoord",s=>function(o=!1){const a=this.getSize();if(!a)return null;const l=[];return zg(l,a,s.call(this),o),l}),e(pe.PeGTlistExtendedEntry.prototype,"getEntries",s=>{const o=pe._pe_getPeGTlistExtendedGTsSize();return function(){let a=null;const l=s.call(this);if(!pe.compare(l,pe.NULL)){a=[l];const c=this.getSteps();if(c>1){const u=pe.getPointer(l);for(let h=1;h<c;h++)a.push(pe.wrapPointer(u+o*h,pe.PeGTlistExtendedGTs))}}return a}});const r=pe._pe_getPeHorizonSize(),i=s=>function(){let o=this._cache;if(o||(o=new Map,this._cache=o),o.has(s))return o.get(s);let a=null;const l=s.call(this);if(!pe.compare(l,pe.NULL)){a=[l];const c=l.getNump();if(c>1){const u=pe.getPointer(l);for(let h=1;h<c;h++)a.push(pe.wrapPointer(u+r*h,pe.PeHorizon))}}return o.set(s,a),a};e(pe.PeProjcs.prototype,"horizonGcsGenerate",i),e(pe.PeProjcs.prototype,"horizonPcsGenerate",i),pe.PeObject.prototype.toString=function(s=$i.PE_STR_OPTS_NONE){pe.ensureCache.prepare();const o=pe.getPointer(this),a=pe.ensureInt8(new Array($i.PE_BUFFER_MAX));return pe.UTF8ToString(pe._pe_object_to_string_ext(o,s,a))},pe.PeGeogcs.prototype.destroy=function(){this.Delete(),qu(this),this.ptr=0},pe.PeGeogcs.prototype[Symbol.dispose]=function(){this.destroy()},pe.PeProjcs.prototype.destroy=function(){this.Delete(),qu(this),this.ptr=0},pe.PeProjcs.prototype[Symbol.dispose]=function(){this.destroy()}}function qu(t){if(!t)return;const e=pe.getClass(t);if(!e)return;const n=pe.getCache(e);if(!n)return;const r=pe.getPointer(t);r&&delete n[r]}function NO(t,e){const n=[],r=new Array(e);for(let i=0;i<t;i++)n.push(pe.ensureInt8(r));return n}function V1(t){return ArrayBuffer.isView(t)?t:Array.isArray(t[0])?t.flat():t}function zg(t,e,n,r=!1){if(r)for(let i=0;i<2*e;i++)t[i]=pe.getValue(n+i*Float64Array.BYTES_PER_ELEMENT,"double");else{const i=t.length===0;for(let s=0;s<e;s++)i&&(t[s]=new Array(2)),t[s][0]=pe.getValue(n,"double"),t[s][1]=pe.getValue(n+Float64Array.BYTES_PER_ELEMENT,"double"),n+=2*Float64Array.BYTES_PER_ELEMENT}}const uPt=Object.freeze(Object.defineProperty({__proto__:null,PeCSTransformations:_M,PeDefs:$i,get PeDouble(){return zpe},PeFactory:H_,get PeGCSExtent(){return Gpe},PeGTTransformations:ZFe,PeGTlistExtended:OB,PeGTlistExtendedEntry:XFe,PeLineType:JFe,PeMath:QFe,PeNotationDms:e8e,PeNotationMgrs:Upe,PeNotationUsng:t8e,PeNotationUtm:Bpe,PePCSInfo:Wpe,PeVersion:n8e,_init:Hpe,get _pe(){return pe},isLoaded:Vpe,isSupported:KFe,load:YFe},Symbol.toStringTag,{value:"Module"}));let v;const H={values:[1,.3048,.3048006096012192,.3047972654,.9143917962,.201166195164,.9143984146160287,.3047994715386762,20.11676512155263,20.11678249437587,.9143985307444408,.91439523,.3047997101815088,20.1168,20.116756,5e4,15e4],units:["Meter","Foot","Foot_US","Foot_Clarke","Yard_Clarke","Link_Clarke","Yard_Sears","Foot_Sears","Chain_Sears","Chain_Benoit_1895_B","Yard_Indian","Yard_Indian_1937","Foot_Gold_Coast","Chain","Chain_Sears_1922_Truncated","50_Kilometers","150_Kilometers"],2066:5,2136:12,2155:2,2157:0,2158:0,2159:12,2160:12,2204:2,2219:0,2220:0,2254:2,2255:2,2256:1,2265:1,2266:1,2267:2,2268:2,2269:1,2270:1,2271:2,2272:2,2273:1,2294:0,2295:0,2314:3,2899:2,2900:2,2901:1,2909:1,2910:1,2911:2,2912:2,2913:1,2914:1,2992:1,2993:0,2994:1,3080:1,3089:2,3090:0,3091:2,3102:2,3141:0,3142:0,3167:14,3359:2,3360:0,3361:1,3362:0,3363:2,3364:0,3365:2,3366:3,3404:2,3405:0,3406:0,3407:3,3439:0,3440:0,3479:1,3480:0,3481:1,3482:0,3483:1,3484:0,3485:2,3486:0,3487:2,3488:0,3489:0,3490:2,3491:0,3492:2,3493:0,3494:2,3495:0,3496:2,3497:0,3498:2,3499:0,3500:2,3501:0,3502:2,3503:0,3504:2,3505:0,3506:2,3507:0,3508:2,3509:0,3510:2,3511:0,3512:2,3513:0,3514:0,3515:2,3516:0,3517:2,3518:0,3519:2,3520:0,3521:2,3522:0,3523:2,3524:0,3525:2,3526:0,3527:2,3528:0,3529:2,3530:0,3531:2,3532:0,3533:2,3534:0,3535:2,3536:0,3537:2,3538:0,3539:2,3540:0,3541:2,3542:0,3543:2,3544:0,3545:2,3546:0,3547:2,3548:0,3549:2,3550:0,3551:2,3552:0,3553:2,3582:2,3583:0,3584:2,3585:0,3586:2,3587:0,3588:1,3589:0,3590:1,3591:0,3592:0,3593:1,3598:2,3599:0,3600:2,3605:1,3606:0,3607:0,3608:2,3609:0,3610:2,3611:0,3612:2,3613:0,3614:2,3615:0,3616:2,3617:0,3618:2,3619:0,3620:2,3621:0,3622:2,3623:0,3624:2,3625:0,3626:2,3627:0,3628:2,3629:0,3630:2,3631:0,3632:2,3633:0,3634:1,3635:0,3636:1,3640:2,3641:0,3642:2,3643:0,3644:1,3645:0,3646:1,3647:0,3648:1,3649:0,3650:2,3651:0,3652:2,3653:0,3654:2,3655:0,3656:1,3657:0,3658:2,3659:0,3660:2,3661:0,3662:2,3663:0,3664:2,3668:2,3669:0,3670:2,3671:0,3672:2,3673:0,3674:2,3675:0,3676:1,3677:2,3678:0,3679:1,3680:2,3681:0,3682:1,3683:2,3684:0,3685:0,3686:2,3687:0,3688:2,3689:0,3690:2,3691:0,3692:2,3696:2,3697:0,3698:2,3699:0,3700:2,3793:0,3794:0,3812:0,3854:0,3857:0,3920:0,3978:0,3979:0,3991:2,3992:2,4026:0,4037:0,4038:0,4071:0,4082:0,4083:0,4087:0,4088:0,4217:2,4414:0,4415:0,4417:0,4434:0,4437:0,4438:2,4439:2,4462:0,4467:0,4471:0,4474:0,4559:0,4647:0,4822:0,4826:0,4839:0,5018:0,5041:0,5042:0,5048:0,5221:0,5223:0,5234:0,5235:0,5243:0,5247:0,5266:0,5316:0,5320:0,5321:0,5325:0,5337:0,5361:0,5362:0,5367:0,5382:0,5383:0,5396:0,5456:0,5457:0,5469:0,5472:4,5490:0,5513:0,5514:0,5523:0,5559:0,5588:1,5589:3,5596:0,5627:0,5629:0,5641:0,5643:0,5644:0,5646:2,5654:2,5655:2,5659:0,5700:0,5825:0,5836:0,5837:0,5839:0,5842:0,5844:0,5858:0,5879:0,5880:0,5887:0,5890:0,6128:1,6129:1,6141:1,6204:0,6210:0,6211:0,6307:0,6312:0,6316:0,6362:0,6391:1,6405:1,6406:0,6407:1,6408:0,6409:1,6410:0,6411:2,6412:0,6413:2,6414:0,6415:0,6416:2,6417:0,6418:2,6419:0,6420:2,6421:0,6422:2,6423:0,6424:2,6425:0,6426:2,6427:0,6428:2,6429:0,6430:2,6431:0,6432:2,6433:0,6434:2,6435:0,6436:2,6437:0,6438:2,6439:0,6440:0,6441:2,6442:0,6443:2,6444:0,6445:2,6446:0,6447:2,6448:0,6449:2,6450:0,6451:2,6452:0,6453:2,6454:0,6455:2,6456:0,6457:2,6458:0,6459:2,6460:0,6461:2,6462:0,6463:2,6464:0,6465:2,6466:0,6467:2,6468:0,6469:2,6470:0,6471:2,6472:0,6473:2,6474:0,6475:2,6476:0,6477:2,6478:0,6479:2,6484:2,6485:0,6486:2,6487:0,6488:2,6489:0,6490:2,6491:0,6492:2,6493:0,6494:1,6495:0,6496:1,6497:0,6498:0,6499:1,6500:0,6501:2,6502:0,6503:2,6504:0,6505:2,6506:0,6507:2,6508:0,6509:0,6510:2,6515:1,6516:0,6518:0,6519:2,6520:0,6521:2,6522:0,6523:2,6524:0,6525:2,6526:0,6527:2,6528:0,6529:2,6530:0,6531:2,6532:0,6533:2,6534:0,6535:2,6536:0,6537:2,6538:0,6539:2,6540:0,6541:2,6542:0,6543:2,6544:0,6545:1,6546:0,6547:1,6548:0,6549:2,6550:0,6551:2,6552:0,6553:2,6554:0,6555:2,6556:0,6557:1,6558:0,6559:1,6560:0,6561:1,6562:0,6563:2,6564:0,6565:2,6566:0,6567:0,6568:2,6569:0,6570:1,6571:0,6572:2,6573:0,6574:2,6575:0,6576:2,6577:0,6578:2,6582:2,6583:0,6584:2,6585:0,6586:2,6587:0,6588:2,6589:0,6590:2,6591:0,6592:0,6593:2,6594:0,6595:2,6596:0,6597:2,6598:0,6599:2,6600:0,6601:2,6602:0,6603:2,6605:2,6606:0,6607:2,6608:0,6609:2,6610:0,6611:0,6612:2,6613:0,6614:2,6615:0,6616:2,6617:0,6618:2,6633:2,6646:0,6703:0,6784:0,6785:1,6786:0,6787:1,6788:0,6789:1,6790:0,6791:1,6792:0,6793:1,6794:0,6795:1,6796:0,6797:1,6798:0,6799:1,6800:0,6801:1,6802:0,6803:1,6804:0,6805:1,6806:0,6807:1,6808:0,6809:1,6810:0,6811:1,6812:0,6813:1,6814:0,6815:1,6816:0,6817:1,6818:0,6819:1,6820:0,6821:1,6822:0,6823:1,6824:0,6825:1,6826:0,6827:1,6828:0,6829:1,6830:0,6831:1,6832:0,6833:1,6834:0,6835:1,6836:0,6837:1,6838:0,6839:1,6840:0,6841:1,6842:0,6843:1,6844:0,6845:1,6846:0,6847:1,6848:0,6849:1,6850:0,6851:1,6852:0,6853:1,6854:0,6855:1,6856:0,6857:1,6858:0,6859:1,6860:0,6861:1,6862:0,6863:1,6867:0,6868:1,6870:0,6875:0,6876:0,6879:0,6880:2,6884:0,6885:1,6886:0,6887:1,6915:0,6922:0,6923:2,6924:0,6925:2,6962:0,6984:0,6991:0,7128:2,7131:0,7132:2,7142:0,7257:0,7258:2,7259:0,7260:2,7261:0,7262:2,7263:0,7264:2,7265:0,7266:2,7267:0,7268:2,7269:0,7270:2,7271:0,7272:2,7273:0,7274:2,7275:0,7276:2,7277:0,7278:2,7279:0,7280:2,7281:0,7282:2,7283:0,7284:2,7285:0,7286:2,7287:0,7288:2,7289:0,7290:2,7291:0,7292:2,7293:0,7294:2,7295:0,7296:2,7297:0,7298:2,7299:0,7300:2,7301:0,7302:2,7303:0,7304:2,7305:0,7306:2,7307:0,7308:2,7309:0,7310:2,7311:0,7312:2,7313:0,7314:2,7315:0,7316:2,7317:0,7318:2,7319:0,7320:2,7321:0,7322:2,7323:0,7324:2,7325:0,7326:2,7327:0,7328:2,7329:0,7330:2,7331:0,7332:2,7333:0,7334:2,7335:0,7336:2,7337:0,7338:2,7339:0,7340:2,7341:0,7342:2,7343:0,7344:2,7345:0,7346:2,7347:0,7348:2,7349:0,7350:2,7351:0,7352:2,7353:0,7354:2,7355:0,7356:2,7357:0,7358:2,7359:0,7360:2,7361:0,7362:2,7363:0,7364:2,7365:0,7366:2,7367:0,7368:2,7369:0,7370:2,7877:0,7878:0,7882:0,7883:0,7887:0,7899:0,7991:0,7992:0,8035:2,8036:2,8058:0,8059:0,8082:0,8083:0,8088:0,8090:0,8091:2,8092:0,8093:2,8095:0,8096:2,8097:0,8098:2,8099:0,8100:2,8101:0,8102:2,8103:0,8104:2,8105:0,8106:2,8107:0,8108:2,8109:0,8110:2,8111:0,8112:2,8113:0,8114:2,8115:0,8116:2,8117:0,8118:2,8119:0,8120:2,8121:0,8122:2,8123:0,8124:2,8125:0,8126:2,8127:0,8128:2,8129:0,8130:2,8131:0,8132:2,8133:0,8134:2,8135:0,8136:2,8137:0,8138:2,8139:0,8140:2,8141:0,8142:2,8143:0,8144:2,8145:0,8146:2,8147:0,8148:2,8149:0,8150:2,8151:0,8152:2,8153:0,8154:2,8155:0,8156:2,8157:0,8158:2,8159:0,8160:2,8161:0,8162:2,8163:0,8164:2,8165:0,8166:2,8167:0,8168:2,8169:0,8170:2,8171:0,8172:2,8173:0,8177:2,8179:0,8180:2,8181:0,8182:2,8184:0,8185:2,8187:0,8189:2,8191:0,8193:2,8196:0,8197:2,8198:0,8200:2,8201:0,8202:2,8203:0,8204:2,8205:0,8206:2,8207:0,8208:2,8209:0,8210:2,8212:0,8213:2,8214:0,8216:2,8218:0,8220:2,8222:0,8224:2,8225:0,8226:2,8311:0,8312:1,8313:0,8314:1,8315:0,8316:1,8317:0,8318:1,8319:0,8320:1,8321:0,8322:1,8323:0,8324:1,8325:0,8326:1,8327:0,8328:1,8329:0,8330:1,8331:0,8332:1,8333:0,8334:1,8335:0,8336:1,8337:0,8338:1,8339:0,8340:1,8341:0,8342:1,8343:0,8344:1,8345:0,8346:1,8347:0,8348:1,8352:0,8353:0,8379:0,8380:2,8381:0,8382:2,8383:0,8384:2,8385:0,8387:2,8391:0,8395:0,8433:0,8441:0,8455:0,8456:0,8531:2,8682:0,8686:0,8687:0,8692:0,8693:0,8826:0,8903:0,8950:0,8951:0,9039:0,9040:0,9141:0,9149:0,9150:0,9191:0,9221:0,9222:0,9249:0,9250:0,9252:0,9254:0,9265:0,9284:0,9285:0,9300:0,9354:0,9367:0,9373:0,9377:0,9387:0,9391:0,9456:0,9473:0,9498:0,9674:0,9678:0,9680:0,9709:0,9712:0,9713:0,9716:0,9741:0,9748:2,9749:2,9761:0,9766:0,9793:0,9794:0,9869:0,9874:0,9875:0,9880:0,9895:0,9943:0,9945:0,9947:0,9967:0,9972:0,9977:0,10160:0,10183:0,10188:0,10194:0,10199:0,10207:0,10212:0,10217:0,10222:0,10227:0,10235:0,10240:0,10250:0,10254:0,10270:0,10275:0,10280:0,10306:0,10329:0,10471:0,10477:0,10481:2,10516:2,10592:0,10594:0,10596:0,10598:0,10601:0,10603:0,10626:0,10632:0,10641:0,10665:0,10674:0,10744:0,10745:0,10759:0,10773:0,10802:0,10820:0,20002:0,20042:0,20050:1,20499:0,20538:0,20539:0,20790:0,20791:0,21291:0,21292:0,21500:0,21817:0,21818:0,22032:0,22033:0,22091:0,22092:0,22239:0,22240:0,22332:0,22337:0,22338:0,22391:0,22392:0,22639:0,22700:0,22739:0,22770:0,22780:0,22832:0,23090:0,23095:0,23239:0,23240:0,23433:0,23700:0,24047:0,24048:0,24100:3,24200:0,24305:0,24306:0,24382:10,24383:0,24500:0,24547:0,24548:0,24571:9,24600:0,25e3:0,25231:0,25884:0,25932:0,26237:0,26331:0,26332:0,26432:0,26591:0,26592:0,26632:0,26692:0,27120:0,27200:0,27291:6,27292:6,27429:0,27492:0,27493:0,27500:0,28232:0,28600:0,28991:0,28992:0,29100:0,29101:0,29220:0,29221:0,29333:0,29635:0,29636:0,29701:0,29738:0,29739:0,29849:0,29850:0,29871:8,29872:7,29873:0,29874:0,30200:5,30339:0,30340:0,30591:0,30592:0,30791:0,30792:0,30800:0,31028:0,31121:0,31154:0,31170:0,31171:0,31370:0,31528:0,31529:0,31600:0,31700:0,31838:0,31839:0,31900:0,31901:0,32061:0,32062:0,32098:0,32099:2,32100:0,32104:0,32161:0,32766:0,53048:0,53049:0,65061:2,65062:2,102041:2,102064:11,102068:15,102069:16,102118:2,102119:1,102120:2,102121:2,102217:2,102218:0,102219:2,102220:2,102378:1,102379:1,102380:0,102381:1,102589:2,102599:2,102600:2,102604:2,102647:0,102704:2,102705:2,102706:0,102731:0,102732:0,102759:1,102760:1,102761:2,102762:0,102763:2,102764:0,102765:0,102766:2,102970:1,102974:2,102993:0,102994:0,102995:2,102996:2,103015:0,103016:2,103017:0,103018:2,103025:0,103026:0,103027:2,103028:2,103035:0,103036:0,103037:2,103038:2,103039:0,103040:0,103041:2,103042:2,103043:0,103044:0,103045:2,103046:2,103047:0,103048:0,103049:2,103050:2,103051:0,103052:2,103053:0,103054:2,103055:0,103056:2,103057:0,103058:0,103059:2,103060:2,103061:0,103062:0,103063:2,103064:2,103069:2,103070:0,103071:0,103072:2,103073:2,103086:0,103087:0,103088:2,103089:2,103094:1,103095:0,103096:2,103103:0,103104:2,103105:0,103106:2,103121:0,103122:2,103123:0,103124:0,103125:1,103126:1,103127:0,103128:0,103129:2,103130:2,103131:0,103132:0,103133:2,103134:2,103135:0,103136:0,103137:1,103138:1,103139:0,103140:2,103141:0,103142:2,103143:0,103144:2,103145:0,103146:1,103147:0,103148:0,103149:2,103150:2,103151:0,103152:2,103172:0,103173:2,103174:0,103175:0,103176:2,103177:2,103178:0,103179:0,103180:2,103181:2,103182:0,103183:0,103184:2,103185:2,103228:0,103229:0,103230:2,103231:2,103250:0,103251:2,103252:0,103253:2,103260:0,103261:0,103262:2,103263:2,103270:0,103271:0,103272:2,103273:2,103274:0,103275:0,103276:2,103277:2,103278:0,103279:0,103280:2,103281:2,103282:0,103283:0,103284:2,103285:2,103286:0,103287:2,103288:0,103289:2,103290:0,103291:2,103292:0,103293:0,103294:2,103295:2,103296:0,103297:0,103298:2,103299:2,103376:2,103377:0,103378:0,103379:2,103380:2,103393:0,103394:0,103395:2,103396:2,103472:0,103473:1,103474:0,103475:2,103482:0,103483:2,103484:0,103485:2,103500:0,103501:2,103502:0,103503:0,103504:1,103505:1,103506:0,103507:0,103508:2,103509:2,103510:0,103511:0,103512:2,103513:2,103514:0,103515:2,103516:0,103517:2,103518:0,103519:2,103520:0,103521:1,103522:0,103523:0,103524:2,103525:2,103526:0,103527:2,103561:2,103562:2,103563:0,103564:0,103565:2,103566:2,103567:0,103568:0,103569:2,103570:2,103584:0,103585:2,103586:0,103587:2,103588:1,103589:0,103590:2,103591:1,103592:0,103593:2,103594:1,103695:2,103897:1,103978:2,103979:0,103980:2,103981:0};for(v=2e3;v<=2045;v++)H[v]=0;for(v=2056;v<=2065;v++)H[v]=0;for(v=2067;v<=2135;v++)H[v]=0;for(v=2137;v<=2154;v++)H[v]=0;for(v=2161;v<=2170;v++)H[v]=0;for(v=2172;v<=2193;v++)H[v]=0;for(v=2195;v<=2198;v++)H[v]=0;for(v=2200;v<=2203;v++)H[v]=0;for(v=2205;v<=2217;v++)H[v]=0;for(v=2222;v<=2224;v++)H[v]=1;for(v=2225;v<=2250;v++)H[v]=2;for(v=2251;v<=2253;v++)H[v]=1;for(v=2257;v<=2264;v++)H[v]=2;for(v=2274;v<=2279;v++)H[v]=2;for(v=2280;v<=2282;v++)H[v]=1;for(v=2283;v<=2289;v++)H[v]=2;for(v=2290;v<=2292;v++)H[v]=0;for(v=2308;v<=2313;v++)H[v]=0;for(v=2315;v<=2491;v++)H[v]=0;for(v=2494;v<=2866;v++)H[v]=0;for(v=2867;v<=2869;v++)H[v]=1;for(v=2870;v<=2888;v++)H[v]=2;for(v=2891;v<=2895;v++)H[v]=2;for(v=2896;v<=2898;v++)H[v]=1;for(v=2902;v<=2908;v++)H[v]=2;for(v=2915;v<=2920;v++)H[v]=2;for(v=2921;v<=2923;v++)H[v]=1;for(v=2924;v<=2930;v++)H[v]=2;for(v=2931;v<=2962;v++)H[v]=0;for(v=2964;v<=2968;v++)H[v]=2;for(v=2969;v<=2973;v++)H[v]=0;for(v=2975;v<=2991;v++)H[v]=0;for(v=2995;v<=3051;v++)H[v]=0;for(v=3054;v<=3079;v++)H[v]=0;for(v=3081;v<=3088;v++)H[v]=0;for(v=3092;v<=3101;v++)H[v]=0;for(v=3106;v<=3138;v++)H[v]=0;for(v=3146;v<=3151;v++)H[v]=0;for(v=3153;v<=3166;v++)H[v]=0;for(v=3168;v<=3172;v++)H[v]=0;for(v=3174;v<=3203;v++)H[v]=0;for(v=3294;v<=3358;v++)H[v]=0;for(v=3367;v<=3403;v++)H[v]=0;for(v=3408;v<=3416;v++)H[v]=0;for(v=3417;v<=3438;v++)H[v]=2;for(v=3441;v<=3446;v++)H[v]=2;for(v=3447;v<=3450;v++)H[v]=0;for(v=3451;v<=3459;v++)H[v]=2;for(v=3460;v<=3478;v++)H[v]=0;for(v=3554;v<=3559;v++)H[v]=0;for(v=3560;v<=3570;v++)H[v]=2;for(v=3571;v<=3581;v++)H[v]=0;for(v=3594;v<=3597;v++)H[v]=0;for(v=3601;v<=3604;v++)H[v]=0;for(v=3637;v<=3639;v++)H[v]=0;for(v=3665;v<=3667;v++)H[v]=0;for(v=3693;v<=3695;v++)H[v]=0;for(v=3701;v<=3727;v++)H[v]=0;for(v=3728;v<=3739;v++)H[v]=2;for(v=3740;v<=3751;v++)H[v]=0;for(v=3753;v<=3760;v++)H[v]=2;for(v=3761;v<=3773;v++)H[v]=0;for(v=3775;v<=3777;v++)H[v]=0;for(v=3779;v<=3781;v++)H[v]=0;for(v=3783;v<=3785;v++)H[v]=0;for(v=3788;v<=3791;v++)H[v]=0;for(v=3797;v<=3802;v++)H[v]=0;for(v=3814;v<=3816;v++)H[v]=0;for(v=3825;v<=3829;v++)H[v]=0;for(v=3832;v<=3841;v++)H[v]=0;for(v=3844;v<=3852;v++)H[v]=0;for(v=3873;v<=3885;v++)H[v]=0;for(v=3890;v<=3893;v++)H[v]=0;for(v=3907;v<=3912;v++)H[v]=0;for(v=3942;v<=3950;v++)H[v]=0;for(v=3968;v<=3970;v++)H[v]=0;for(v=3973;v<=3976;v++)H[v]=0;for(v=3986;v<=3989;v++)H[v]=0;for(v=3994;v<=3997;v++)H[v]=0;for(v=4048;v<=4051;v++)H[v]=0;for(v=4056;v<=4063;v++)H[v]=0;for(v=4093;v<=4096;v++)H[v]=0;for(v=4390;v<=4398;v++)H[v]=0;for(v=4399;v<=4413;v++)H[v]=2;for(v=4418;v<=4433;v++)H[v]=2;for(v=4455;v<=4457;v++)H[v]=2;for(v=4484;v<=4489;v++)H[v]=0;for(v=4491;v<=4554;v++)H[v]=0;for(v=4568;v<=4589;v++)H[v]=0;for(v=4652;v<=4656;v++)H[v]=0;for(v=4766;v<=4800;v++)H[v]=0;for(v=5014;v<=5016;v++)H[v]=0;for(v=5069;v<=5072;v++)H[v]=0;for(v=5105;v<=5130;v++)H[v]=0;for(v=5167;v<=5188;v++)H[v]=0;for(v=5253;v<=5259;v++)H[v]=0;for(v=5269;v<=5275;v++)H[v]=0;for(v=5292;v<=5311;v++)H[v]=0;for(v=5329;v<=5331;v++)H[v]=0;for(v=5343;v<=5349;v++)H[v]=0;for(v=5355;v<=5357;v++)H[v]=0;for(v=5387;v<=5389;v++)H[v]=0;for(v=5459;v<=5463;v++)H[v]=0;for(v=5479;v<=5482;v++)H[v]=0;for(v=5518;v<=5520;v++)H[v]=0;for(v=5530;v<=5539;v++)H[v]=0;for(v=5550;v<=5552;v++)H[v]=0;for(v=5562;v<=5583;v++)H[v]=0;for(v=5623;v<=5625;v++)H[v]=2;for(v=5631;v<=5639;v++)H[v]=0;for(v=5649;v<=5653;v++)H[v]=0;for(v=5663;v<=5680;v++)H[v]=0;for(v=5682;v<=5685;v++)H[v]=0;for(v=5875;v<=5877;v++)H[v]=0;for(v=5896;v<=5899;v++)H[v]=0;for(v=5921;v<=5940;v++)H[v]=0;for(v=6050;v<=6125;v++)H[v]=0;for(v=6244;v<=6275;v++)H[v]=0;for(v=6328;v<=6348;v++)H[v]=0;for(v=6350;v<=6356;v++)H[v]=0;for(v=6366;v<=6372;v++)H[v]=0;for(v=6381;v<=6387;v++)H[v]=0;for(v=6393;v<=6404;v++)H[v]=0;for(v=6480;v<=6483;v++)H[v]=0;for(v=6511;v<=6514;v++)H[v]=0;for(v=6579;v<=6581;v++)H[v]=0;for(v=6619;v<=6624;v++)H[v]=0;for(v=6625;v<=6627;v++)H[v]=2;for(v=6628;v<=6632;v++)H[v]=0;for(v=6634;v<=6637;v++)H[v]=0;for(v=6669;v<=6692;v++)H[v]=0;for(v=6707;v<=6709;v++)H[v]=0;for(v=6720;v<=6723;v++)H[v]=0;for(v=6732;v<=6738;v++)H[v]=0;for(v=6931;v<=6933;v++)H[v]=0;for(v=6956;v<=6959;v++)H[v]=0;for(v=7005;v<=7007;v++)H[v]=0;for(v=7057;v<=7070;v++)H[v]=2;for(v=7074;v<=7082;v++)H[v]=0;for(v=7109;v<=7118;v++)H[v]=0;for(v=7119;v<=7127;v++)H[v]=1;for(v=7374;v<=7376;v++)H[v]=0;for(v=7528;v<=7586;v++)H[v]=0;for(v=7587;v<=7645;v++)H[v]=2;for(v=7692;v<=7696;v++)H[v]=0;for(v=7755;v<=7787;v++)H[v]=0;for(v=7791;v<=7795;v++)H[v]=0;for(v=7799;v<=7801;v++)H[v]=0;for(v=7803;v<=7805;v++)H[v]=0;for(v=7825;v<=7831;v++)H[v]=0;for(v=7845;v<=7859;v++)H[v]=0;for(v=8013;v<=8032;v++)H[v]=0;for(v=8065;v<=8068;v++)H[v]=1;for(v=8518;v<=8529;v++)H[v]=2;for(v=8533;v<=8536;v++)H[v]=2;for(v=8538;v<=8540;v++)H[v]=2;for(v=8677;v<=8679;v++)H[v]=0;for(v=8836;v<=8840;v++)H[v]=0;for(v=8857;v<=8859;v++)H[v]=0;for(v=8908;v<=8910;v++)H[v]=0;for(v=9154;v<=9159;v++)H[v]=0;for(v=9205;v<=9218;v++)H[v]=0;for(v=9271;v<=9273;v++)H[v]=0;for(v=9295;v<=9297;v++)H[v]=0;for(v=9356;v<=9360;v++)H[v]=0;for(v=9404;v<=9407;v++)H[v]=0;for(v=9476;v<=9482;v++)H[v]=0;for(v=9487;v<=9494;v++)H[v]=0;for(v=9697;v<=9699;v++)H[v]=0;for(v=9821;v<=9865;v++)H[v]=0;for(v=10285;v<=10291;v++)H[v]=0;for(v=10314;v<=10317;v++)H[v]=0;for(v=10448;v<=10465;v++)H[v]=0;for(v=10726;v<=10729;v++)H[v]=0;for(v=10731;v<=10733;v++)H[v]=0;for(v=11114;v<=11118;v++)H[v]=0;for(v=20004;v<=20032;v++)H[v]=0;for(v=20047;v<=20049;v++)H[v]=0;for(v=20062;v<=20092;v++)H[v]=0;for(v=20135;v<=20138;v++)H[v]=0;for(v=20248;v<=20258;v++)H[v]=0;for(v=20348;v<=20358;v++)H[v]=0;for(v=20436;v<=20440;v++)H[v]=0;for(v=20822;v<=20824;v++)H[v]=0;for(v=20904;v<=20932;v++)H[v]=0;for(v=20934;v<=20936;v++)H[v]=0;for(v=21004;v<=21032;v++)H[v]=0;for(v=21035;v<=21037;v++)H[v]=0;for(v=21095;v<=21097;v++)H[v]=0;for(v=21148;v<=21150;v++)H[v]=0;for(v=21207;v<=21264;v++)H[v]=0;for(v=21307;v<=21364;v++)H[v]=0;for(v=21413;v<=21423;v++)H[v]=0;for(v=21453;v<=21463;v++)H[v]=0;for(v=21473;v<=21483;v++)H[v]=0;for(v=21780;v<=21782;v++)H[v]=0;for(v=21891;v<=21894;v++)H[v]=0;for(v=21896;v<=21899;v++)H[v]=0;for(v=22171;v<=22177;v++)H[v]=0;for(v=22181;v<=22187;v++)H[v]=0;for(v=22191;v<=22197;v++)H[v]=0;for(v=22207;v<=22222;v++)H[v]=0;for(v=22229;v<=22232;v++)H[v]=0;for(v=22234;v<=22236;v++)H[v]=0;for(v=22243;v<=22250;v++)H[v]=0;for(v=22262;v<=22265;v++)H[v]=0;for(v=22307;v<=22322;v++)H[v]=0;for(v=22348;v<=22357;v++)H[v]=0;for(v=22407;v<=22422;v++)H[v]=0;for(v=22462;v<=22465;v++)H[v]=0;for(v=22521;v<=22525;v++)H[v]=0;for(v=22607;v<=22622;v++)H[v]=0;for(v=22641;v<=22646;v++)H[v]=0;for(v=22648;v<=22657;v++)H[v]=0;for(v=22707;v<=22722;v++)H[v]=0;for(v=22762;v<=22765;v++)H[v]=0;for(v=22807;v<=22822;v++)H[v]=0;for(v=22991;v<=22994;v++)H[v]=0;for(v=23028;v<=23038;v++)H[v]=0;for(v=23301;v<=23333;v++)H[v]=2;for(v=23830;v<=23853;v++)H[v]=0;for(v=23866;v<=23872;v++)H[v]=0;for(v=23877;v<=23884;v++)H[v]=0;for(v=23886;v<=23894;v++)H[v]=0;for(v=23946;v<=23948;v++)H[v]=0;for(v=24311;v<=24313;v++)H[v]=0;for(v=24342;v<=24347;v++)H[v]=0;for(v=24370;v<=24374;v++)H[v]=10;for(v=24375;v<=24381;v++)H[v]=0;for(v=24718;v<=24721;v++)H[v]=0;for(v=24817;v<=24821;v++)H[v]=0;for(v=24877;v<=24882;v++)H[v]=0;for(v=24891;v<=24893;v++)H[v]=0;for(v=25391;v<=25395;v++)H[v]=0;for(v=25828;v<=25838;v++)H[v]=0;for(v=26191;v<=26195;v++)H[v]=0;for(v=26391;v<=26393;v++)H[v]=0;for(v=26701;v<=26722;v++)H[v]=0;for(v=26729;v<=26799;v++)H[v]=2;for(v=26801;v<=26803;v++)H[v]=2;for(v=26811;v<=26813;v++)H[v]=2;for(v=26847;v<=26870;v++)H[v]=2;for(v=26891;v<=26899;v++)H[v]=0;for(v=26901;v<=26923;v++)H[v]=0;for(v=26929;v<=26946;v++)H[v]=0;for(v=26948;v<=26998;v++)H[v]=0;for(v=27037;v<=27040;v++)H[v]=0;for(v=27205;v<=27232;v++)H[v]=0;for(v=27258;v<=27260;v++)H[v]=0;for(v=27391;v<=27398;v++)H[v]=0;for(v=27561;v<=27564;v++)H[v]=0;for(v=27571;v<=27574;v++)H[v]=0;for(v=27581;v<=27584;v++)H[v]=0;for(v=27591;v<=27594;v++)H[v]=0;for(v=27700;v<=27707;v++)H[v]=0;for(v=28191;v<=28193;v++)H[v]=0;for(v=28348;v<=28358;v++)H[v]=0;for(v=28402;v<=28432;v++)H[v]=0;for(v=28462;v<=28492;v++)H[v]=0;for(v=29118;v<=29122;v++)H[v]=0;for(v=29168;v<=29172;v++)H[v]=0;for(v=29177;v<=29185;v++)H[v]=0;for(v=29187;v<=29195;v++)H[v]=0;for(v=29900;v<=29903;v++)H[v]=0;for(v=30161;v<=30179;v++)H[v]=0;for(v=30491;v<=30494;v++)H[v]=0;for(v=30729;v<=30732;v++)H[v]=0;for(v=31251;v<=31259;v++)H[v]=0;for(v=31265;v<=31268;v++)H[v]=0;for(v=31275;v<=31279;v++)H[v]=0;for(v=31281;v<=31297;v++)H[v]=0;for(v=31461;v<=31469;v++)H[v]=0;for(v=31491;v<=31495;v++)H[v]=0;for(v=31917;v<=31922;v++)H[v]=0;for(v=31965;v<=32e3;v++)H[v]=0;for(v=32001;v<=32003;v++)H[v]=2;for(v=32005;v<=32031;v++)H[v]=2;for(v=32033;v<=32060;v++)H[v]=2;for(v=32064;v<=32067;v++)H[v]=2;for(v=32074;v<=32077;v++)H[v]=2;for(v=32081;v<=32086;v++)H[v]=0;for(v=32107;v<=32130;v++)H[v]=0;for(v=32133;v<=32159;v++)H[v]=0;for(v=32164;v<=32167;v++)H[v]=2;for(v=32180;v<=32199;v++)H[v]=0;for(v=32201;v<=32260;v++)H[v]=0;for(v=32301;v<=32360;v++)H[v]=0;for(v=32401;v<=32460;v++)H[v]=0;for(v=32501;v<=32560;v++)H[v]=0;for(v=32601;v<=32662;v++)H[v]=0;for(v=32664;v<=32667;v++)H[v]=2;for(v=32701;v<=32761;v++)H[v]=0;for(v=53001;v<=53004;v++)H[v]=0;for(v=53008;v<=53019;v++)H[v]=0;for(v=53021;v<=53032;v++)H[v]=0;for(v=53034;v<=53037;v++)H[v]=0;for(v=53042;v<=53046;v++)H[v]=0;for(v=53074;v<=53080;v++)H[v]=0;for(v=54001;v<=54004;v++)H[v]=0;for(v=54008;v<=54019;v++)H[v]=0;for(v=54021;v<=54032;v++)H[v]=0;for(v=54034;v<=54037;v++)H[v]=0;for(v=54042;v<=54046;v++)H[v]=0;for(v=54048;v<=54053;v++)H[v]=0;for(v=54074;v<=54080;v++)H[v]=0;for(v=54090;v<=54096;v++)H[v]=0;for(v=54098;v<=54101;v++)H[v]=0;for(v=65161;v<=65163;v++)H[v]=0;for(v=102001;v<=102040;v++)H[v]=0;for(v=102042;v<=102063;v++)H[v]=0;for(v=102065;v<=102067;v++)H[v]=0;for(v=102070;v<=102117;v++)H[v]=0;for(v=102122;v<=102216;v++)H[v]=0;for(v=102221;v<=102377;v++)H[v]=0;for(v=102382;v<=102388;v++)H[v]=0;for(v=102389;v<=102398;v++)H[v]=2;for(v=102399;v<=102444;v++)H[v]=0;for(v=102445;v<=102447;v++)H[v]=2;for(v=102448;v<=102458;v++)H[v]=0;for(v=102459;v<=102468;v++)H[v]=2;for(v=102469;v<=102499;v++)H[v]=0;for(v=102500;v<=102519;v++)H[v]=1;for(v=102520;v<=102524;v++)H[v]=0;for(v=102525;v<=102529;v++)H[v]=2;for(v=102530;v<=102588;v++)H[v]=0;for(v=102590;v<=102598;v++)H[v]=0;for(v=102601;v<=102603;v++)H[v]=0;for(v=102605;v<=102628;v++)H[v]=0;for(v=102629;v<=102646;v++)H[v]=2;for(v=102648;v<=102700;v++)H[v]=2;for(v=102701;v<=102703;v++)H[v]=0;for(v=102707;v<=102730;v++)H[v]=2;for(v=102733;v<=102758;v++)H[v]=2;for(v=102767;v<=102900;v++)H[v]=0;for(v=102901;v<=102933;v++)H[v]=2;for(v=102934;v<=102950;v++)H[v]=13;for(v=102951;v<=102963;v++)H[v]=0;for(v=102965;v<=102969;v++)H[v]=0;for(v=102971;v<=102973;v++)H[v]=0;for(v=102975;v<=102989;v++)H[v]=0;for(v=102990;v<=102992;v++)H[v]=1;for(v=102997;v<=103002;v++)H[v]=0;for(v=103003;v<=103008;v++)H[v]=2;for(v=103009;v<=103011;v++)H[v]=0;for(v=103012;v<=103014;v++)H[v]=2;for(v=103019;v<=103021;v++)H[v]=0;for(v=103022;v<=103024;v++)H[v]=2;for(v=103029;v<=103031;v++)H[v]=0;for(v=103032;v<=103034;v++)H[v]=2;for(v=103065;v<=103068;v++)H[v]=0;for(v=103074;v<=103076;v++)H[v]=0;for(v=103077;v<=103079;v++)H[v]=1;for(v=103080;v<=103082;v++)H[v]=0;for(v=103083;v<=103085;v++)H[v]=2;for(v=103090;v<=103093;v++)H[v]=0;for(v=103097;v<=103099;v++)H[v]=0;for(v=103100;v<=103102;v++)H[v]=2;for(v=103107;v<=103109;v++)H[v]=0;for(v=103110;v<=103112;v++)H[v]=2;for(v=103113;v<=103116;v++)H[v]=0;for(v=103117;v<=103120;v++)H[v]=2;for(v=103153;v<=103157;v++)H[v]=0;for(v=103158;v<=103162;v++)H[v]=2;for(v=103163;v<=103165;v++)H[v]=0;for(v=103166;v<=103168;v++)H[v]=1;for(v=103169;v<=103171;v++)H[v]=2;for(v=103186;v<=103188;v++)H[v]=0;for(v=103189;v<=103191;v++)H[v]=2;for(v=103192;v<=103195;v++)H[v]=0;for(v=103196;v<=103199;v++)H[v]=2;for(v=103200;v<=103224;v++)H[v]=0;for(v=103225;v<=103227;v++)H[v]=1;for(v=103232;v<=103237;v++)H[v]=0;for(v=103238;v<=103243;v++)H[v]=2;for(v=103244;v<=103246;v++)H[v]=0;for(v=103247;v<=103249;v++)H[v]=2;for(v=103254;v<=103256;v++)H[v]=0;for(v=103257;v<=103259;v++)H[v]=2;for(v=103264;v<=103266;v++)H[v]=0;for(v=103267;v<=103269;v++)H[v]=2;for(v=103300;v<=103375;v++)H[v]=0;for(v=103381;v<=103383;v++)H[v]=0;for(v=103384;v<=103386;v++)H[v]=1;for(v=103387;v<=103389;v++)H[v]=0;for(v=103390;v<=103392;v++)H[v]=2;for(v=103397;v<=103399;v++)H[v]=0;for(v=103400;v<=103471;v++)H[v]=2;for(v=103476;v<=103478;v++)H[v]=0;for(v=103479;v<=103481;v++)H[v]=2;for(v=103486;v<=103488;v++)H[v]=0;for(v=103489;v<=103491;v++)H[v]=2;for(v=103492;v<=103495;v++)H[v]=0;for(v=103496;v<=103499;v++)H[v]=2;for(v=103528;v<=103543;v++)H[v]=0;for(v=103544;v<=103548;v++)H[v]=2;for(v=103549;v<=103551;v++)H[v]=0;for(v=103552;v<=103554;v++)H[v]=1;for(v=103555;v<=103557;v++)H[v]=2;for(v=103558;v<=103560;v++)H[v]=0;for(v=103571;v<=103573;v++)H[v]=0;for(v=103574;v<=103576;v++)H[v]=2;for(v=103577;v<=103580;v++)H[v]=0;for(v=103581;v<=103583;v++)H[v]=2;for(v=103595;v<=103694;v++)H[v]=0;for(v=103696;v<=103699;v++)H[v]=0;for(v=103700;v<=103793;v++)H[v]=2;for(v=103794;v<=103890;v++)H[v]=0;for(v=103891;v<=103896;v++)H[v]=2;for(v=103900;v<=103971;v++)H[v]=2;for(v=103972;v<=103977;v++)H[v]=0;for(v=112e3;v<=112101;v++)H[v]=0;const qpe=[102100,102113,3857,3785,900913],r8e=[104905,104971],i8e=[104903],s8e=[4326,...qpe,...r8e,...i8e],Gk=[-20037508342788905e-9,20037508342788905e-9],d9=[-20037508342787e-6,20037508342787e-6],Pj={wkTemplate:'PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',valid:Gk,origin:d9,dx:1e-5},Kpe={102113:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:Gk,origin:d9,dx:1e-5},102100:Pj,3785:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:Gk,origin:d9,dx:1e-5},3857:Pj,4326:{wkTemplate:'GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",{Central_Meridian}],UNIT["Degree",0.0174532925199433]]',altTemplate:'PROJCS["WGS_1984_Plate_Carree",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Plate_Carree"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],UNIT["Degrees",111319.491]]',valid:[-180,180],origin:[-180,90],dx:1e-5},104971:{wkTemplate:'GEOGCS["Mars_2000_(Sphere)",DATUM["Mars_2000_(Sphere)",SPHEROID["Mars_2000_(Sphere)",3396190.0,0.0]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]]',valid:[-180,180],origin:[-180,90],dx:1e-5},104905:{wkTemplate:'GEOGCS["GCS_Mars_2000",DATUM["D_Mars_2000",SPHEROID["Mars_2000_IAU_IAG",3396190.0,169.8944472236118]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]]',valid:[-180,180],origin:[-180,90],dx:1e-5},900913:Pj,104903:{wkTemplate:'GEOGCS["GCS_Moon_2000",DATUM["D_Moon_2000",SPHEROID["Moon_2000_IAU_IAG",1737400,0,AUTHORITY["ESRI","107903"]],AUTHORITY["ESRI","106903"]],PRIMEM["Reference_Meridian",0,AUTHORITY["ESRI","108900"]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9122"]],AUTHORITY["ESRI","104903"]]',valid:[-180,180],origin:[-180,90],dx:1e-5}};function go(t,e){if(t===e)return!0;if(t==null||e==null)return!1;const n=t.wkid,r=e.wkid;if(n!=null||r!=null){if(n===r||Dd(t)&&Dd(e))return!0;const o=t.latestWkid;if(o!=null&&r===o)return!0;const a=e.latestWkid;return a!=null&&n===a}let i,s;return t.wkt2&&e.wkt2?(i=t.wkt2,s=e.wkt2):t.wkt&&e.wkt&&(i=t.wkt,s=e.wkt),!(!i||!s)&&i.toUpperCase()===s.toUpperCase()}function za(t){const e=t?.wkid;return e!=null&&e>=2e3&&Kpe[e]||null}function Ype(t){if(!t)return;const{wkid:e,vcsWkid:n}=t;if(e)return n?JSON.stringify({wkid:e,vcsWkid:n}):String(e);const r=t.wkt||t.wkt2;return JSON.stringify(r?n?{wkt:r,vcsWkid:n}:{wkt:r}:{})}function db(t){if(!hc(t))return!1;const{wkid:e}=t;if(e)return H[e]==null;const n=t.wkt2||t.wkt;return!!n&&/^\s*(?:GEOGCS|GEOGCRS|GEOGRAPHICCRS)/i.test(n)}function o8e(t){return!(Xpe(t)||Zpe(t))}function z1(t){return t?.wkid===4326}function hPt(t){return/^\s*(?:GEOD|GEODETIC|GEOG|GEOGRAPHIC|PROJ|PROJECTED|VERT|VERTICAL|ENG|ENGINEERING|PARAMETRIC|TIME|DERIVEDPROJ|COMPOUND|BOUND)CRS/i.test(t)}function Pee(t){return t?.wkid===4490}function Dd(t){const e=t?.wkid;return e!=null&&e>=2e3&&qpe.includes(e)}function a8e(t){return t?.wkid===32662}function OO(t){return t===104971||t===104905}function Xpe(t){return OO(t?.wkid)}function LO(t){return t===104903}function Zpe(t){return LO(t?.wkid)}function l8e(t){const e=t?.wkid;return e!=null&&e>=2e3&&s8e.includes(e)}function hc(t){if(t==null)return!1;const e=t.wkid;return e!=null&&e>=2e3||t.wkt2!=null||t.wkt!=null}const Jpe={wkid:4326,wkt:ufe(Kpe[4326].wkTemplate,{Central_Meridian:"0.0"})},Qpe={wkid:102100,latestWkid:3857},c8e={wkid:32662};function LB(t){return{wkt:`GEOCCS["Spherical geocentric",
    DATUM["Not specified",
      SPHEROID["Sphere",${t.radius},0]],
    PRIMEM["Greenwich",0.0,
      AUTHORITY["EPSG","8901"]],
    UNIT["m",1.0],
    AXIS["Geocentric X",OTHER],
    AXIS["Geocentric Y",EAST],
    AXIS["Geocentric Z",NORTH]
  ]`}}const u8e=LB(is),DB=LB(Td),jB=LB(Vg),h8e={wkt:`GEOCCS["WGS 84",
  DATUM["WGS_1984",
    SPHEROID["WGS 84",${is.radius},298.257223563,
      AUTHORITY["EPSG","7030"]],
    AUTHORITY["EPSG","6326"]],
  PRIMEM["Greenwich",0,
    AUTHORITY["EPSG","8901"]],
  UNIT["m",1.0,
    AUTHORITY["EPSG","9001"]],
  AXIS["Geocentric X",OTHER],
  AXIS["Geocentric Y",OTHER],
  AXIS["Geocentric Z",NORTH],
  AUTHORITY["EPSG","4978"]
]`},d8e=DB.wkt.toUpperCase(),f8e=jB.wkt.toUpperCase();function p8e(t){if(t!=null&&hc(t)){const e=t.wkid,n=t.wkt2??t.wkt;if(OO(e))return Td;const r=n?.toUpperCase();if(n&&r===d8e)return Td;if(LO(e)||r&&r===f8e)return Vg}return is}function dPt(t){return OO(t)?Td:LO(t)?Vg:is}function Z4(t){return go(t,u8e)}function Gg(t){return Z4(t)||go(t,DB)||go(t,jB)}const fPt=39.37,m8e=is.radius*Math.PI/200,eme=/(?:LENGTH)?UNIT\[([^\]]+)]]$/i,w2=H,tme=/UNIT\[([^\]]+)]/i,g8e=new Set([4305,4807,4810,4811,4812,4816,4819,4821,4901,4902,37225,104025,104026,104139,104140]),y8e=Ol()({millimeter:"millimeters",centimeter:"centimeters",meter:"meters",meter_german:"german-meters",kilometer:"kilometers",decimeter:"decimeters",micrometer:"micrometers",nanometer:"nanometers","50_kilometers":"50-kilometers","150_kilometers":"150-kilometers",foot:"feet",foot_us:"us-feet",foot_clarke:"clarke-feet",fathom:"fathoms",nautical_mile:"nautical-miles",chain_us:"us-chains",link_us:"us-links",mile_us:"us-miles",yard_clarke:"clarke-yards",chain_clarke:"clarke-chains",link_clarke:"clarke-links",yard_sears:"sears-yards",foot_sears:"sears-feet",chain_sears:"sears-chains",link_sears:"sears-links",yard_benoit_1895_a:"benoit-1895-a-yards",foot_benoit_1895_a:"benoit-1895-a-feet",chain_benoit_1895_a:"benoit-1895-a-chains",link_benoit_1895_a:"benoit-1895-a-links",yard_benoit_1895_b:"benoit-1895-b-yards",foot_benoit_1895_b:"benoit-1895-b-feet",chain_benoit_1895_b:"benoit-1895-b-chains",link_benoit_1895_b:"benoit-1895-b-links",foot_1865:"1865-feet",foot_indian:"indian-feet",foot_indian_1937:"indian-1937-feet",foot_indian_1962:"indian-1962-feet",foot_indian_1975:"indian-1975-feet",yard_indian:"indian-yards",yard_indian_1937:"indian-1937-yards",yard_indian_1962:"indian-1962-yards",yard_indian_1975:"indian-1975-yards",statute_mile:"statute-miles",foot_gold_coast:"gold-coast-feet",foot_british_1936:"british-1936-feet",yard:"yards",chain:"chains",link:"links",yard_sears_1922_truncated:"sears-1922-truncated-yards",foot_sears_1922_truncated:"sears-1922-truncated-feet",chain_sears_1922_truncated:"sears-1922-truncated-chains",link_sears_1922_truncated:"sears-1922-truncated-links",yard_us:"us-yards",inch:"inches",inch_us:"us-inches",rod:"rods",rod_us:"us-rods",nautical_mile_us:"us-nautical-miles",nautical_mile_uk:"uk-nautical-miles",smoot:"smoots",vara_tx:"tx-vara",point:"points"}),Lu=t=>t*t,hm=t=>t*t*t,Uk={length:{baseUnit:"meters",units:{millimeters:{inBaseUnits:.001},centimeters:{inBaseUnits:.01},meters:{inBaseUnits:1},feet:{inBaseUnits:.3048},"us-feet":{inBaseUnits:.3048006096012192},"clarke-feet":{inBaseUnits:.3047972654},fathoms:{inBaseUnits:1.8288},"nautical-miles":{inBaseUnits:1852},"german-meters":{inBaseUnits:1.0000135965},"us-chains":{inBaseUnits:20.11684023368047},"us-links":{inBaseUnits:.2011684023368047},"us-miles":{inBaseUnits:1609.347218694438},kilometers:{inBaseUnits:1e3},"clarke-yards":{inBaseUnits:.9143917962},"clarke-chains":{inBaseUnits:20.1166195164},"clarke-links":{inBaseUnits:.201166195164},"sears-yards":{inBaseUnits:.9143984146160287},"sears-feet":{inBaseUnits:.3047994715386762},"sears-chains":{inBaseUnits:20.11676512155263},"sears-links":{inBaseUnits:.2011676512155263},"benoit-1895-a-yards":{inBaseUnits:.9143992},"benoit-1895-a-feet":{inBaseUnits:.3047997333333333},"benoit-1895-a-chains":{inBaseUnits:20.1167824},"benoit-1895-a-links":{inBaseUnits:.201167824},"benoit-1895-b-yards":{inBaseUnits:.9143992042898124},"benoit-1895-b-feet":{inBaseUnits:.3047997347632708},"benoit-1895-b-chains":{inBaseUnits:20.11678249437587},"benoit-1895-b-links":{inBaseUnits:.2011678249437587},"1865-feet":{inBaseUnits:.3048008333333334},"indian-feet":{inBaseUnits:.3047995102481469},"indian-1937-feet":{inBaseUnits:.30479841},"indian-1962-feet":{inBaseUnits:.3047996},"indian-1975-feet":{inBaseUnits:.3047995},"indian-yards":{inBaseUnits:.9143985307444408},"indian-1937-yards":{inBaseUnits:.91439523},"indian-1962-yards":{inBaseUnits:.9143988},"indian-1975-yards":{inBaseUnits:.9143985},miles:{inBaseUnits:1609.344},"statute-miles":{inBaseUnits:1609.344},"gold-coast-feet":{inBaseUnits:.3047997101815088},"british-1936-feet":{inBaseUnits:.3048007491},yards:{inBaseUnits:.9144},chains:{inBaseUnits:20.1168},links:{inBaseUnits:.201168},"sears-1922-truncated-yards":{inBaseUnits:.914398},"sears-1922-truncated-feet":{inBaseUnits:.3047993333333334},"sears-1922-truncated-chains":{inBaseUnits:20.116756},"sears-1922-truncated-links":{inBaseUnits:.20116756},"us-yards":{inBaseUnits:.9144018288036576},decimeters:{inBaseUnits:.1},inches:{inBaseUnits:.0254},"us-inches":{inBaseUnits:.0254000508001016},rods:{inBaseUnits:5.0292},"us-rods":{inBaseUnits:5.029210058420118},"us-nautical-miles":{inBaseUnits:1853.248},"uk-nautical-miles":{inBaseUnits:1853.184},smoots:{inBaseUnits:1.7018},"tx-vara":{inBaseUnits:.8466683600033867},points:{inBaseUnits:.0003527777777777778},micrometers:{inBaseUnits:1e-6},nanometers:{inBaseUnits:1e-9},"50-kilometers":{inBaseUnits:5e4},"150-kilometers":{inBaseUnits:15e4}}},area:{baseUnit:"square-meters",units:{"square-millimeters":{inBaseUnits:Lu(.001)},"square-centimeters":{inBaseUnits:Lu(.01)},"square-decimeters":{inBaseUnits:Lu(.1)},"square-meters":{inBaseUnits:1},"square-kilometers":{inBaseUnits:Lu(1e3)},"square-inches":{inBaseUnits:Lu(.0254)},"square-feet":{inBaseUnits:Lu(.3048)},"square-yards":{inBaseUnits:Lu(.9144)},"square-miles":{inBaseUnits:Lu(1609.344)},"square-nautical-miles":{inBaseUnits:Lu(1852)},"square-us-feet":{inBaseUnits:Lu(1200/3937)},acres:{inBaseUnits:.0015625*Lu(1609.344)},ares:{inBaseUnits:100},hectares:{inBaseUnits:1e4}}},volume:{baseUnit:"liters",units:{liters:{inBaseUnits:1},"cubic-millimeters":{inBaseUnits:1e3*hm(.001)},"cubic-centimeters":{inBaseUnits:1e3*hm(.01)},"cubic-decimeters":{inBaseUnits:1e3*hm(.1)},"cubic-meters":{inBaseUnits:1e3},"cubic-kilometers":{inBaseUnits:1e3*hm(1e3)},"cubic-inches":{inBaseUnits:1e3*hm(.0254)},"cubic-feet":{inBaseUnits:1e3*hm(.3048)},"cubic-yards":{inBaseUnits:1e3*hm(.9144)},"cubic-miles":{inBaseUnits:1e3*hm(1609.344)}}},angle:{baseUnit:"radians",units:{radians:{inBaseUnits:1},degrees:{inBaseUnits:Math.PI/180}}}},v8e=(()=>{const t={};for(const e in Uk)for(const n in Uk[e].units)t[n]=e;return t})();function _8e(t,e,n){return t*Uk[n].units[e].inBaseUnits}function x8e(t,e,n){return t/Uk[n].units[e].inBaseUnits}const w8e=["inches","feet","yards","miles","nautical-miles","us-feet","millimeters","centimeters","decimeters","meters","kilometers"],b8e=["metric","imperial"],nme=[...b8e,...w8e],E8e=new Map([["meters","square-meters"],["feet","square-feet"],["us-feet","square-us-feet"]]);function f9(t){const e=v8e[t];if(!e)throw new Error("unknown type");return e}function Cee(t,e=null){return e=e||f9(t),Uk[e].baseUnit===t}function _h(t,e,n){if(e===n)return t;const r=f9(e);if(r!==f9(n))throw new Error("incompatible units");const i=Cee(e,r)?t:_8e(t,e,r);return Cee(n,r)?i:x8e(i,n,r)}function pPt(t,e,n,r=!1){if(!r&&db(e))throw new Error("Unable to convert from an angular unit to a linear unit.");const i=pv(e);return i!==n&&(t=i?_h(t,i,n):_h(t*=Wd(e),"meters",n)),t}function mPt(t,e,n,r=!1){if(!r&&db(n))throw new Error("Unable to convert from a linear unit to an angular unit.");const i=pv(n);return e!==i&&(t=i?_h(t,e,i):_h(t,e,"meters")/Wd(n)),t}function S8e(t){switch(t){case"metric":return"meters";case"imperial":return"feet";default:return t}}function gPt(t){return S8e(t)}function yPt(t){switch(t){case"metric":return"square-meters";case"imperial":return"square-feet";default:return t}}function vPt(t,e,n){switch(n){case"metric":return T8e(t,e);case"imperial":return A8e(t,e);default:return n}}function _Pt(t,e,n){switch(n){case"metric":return k8e(t,e);case"imperial":return I8e(t,e);default:return n}}function T8e(t,e){const n=_h(t,e,"meters");return Math.abs(n)<3e3?"meters":"kilometers"}function k8e(t,e){const n=_h(t,e,"meters");return Math.abs(n)<1e5?"meters":"kilometers"}function A8e(t,e){const n=_h(t,e,"feet");return Math.abs(n)<1e3?"feet":"miles"}function I8e(t,e){const n=_h(t,e,"feet");return Math.abs(n)<1e5?"feet":"miles"}function xPt(t,e){const n=_h(t,e,"square-meters");return Math.abs(n)<3e6?"square-meters":"square-kilometers"}function wPt(t,e){const n=_h(t,e,"square-feet");return Math.abs(n)<1e6?"square-feet":"square-miles"}function bPt(t,e,n){return _h(t,e,"meters")/(n*Math.PI/180)}function $B(t){return y8e.fromJSON(t.toLowerCase())||null}function Ree(t){if(t!=null&&!o8e(t))return 1;const e=Wd(t);return e>1e5?1:e}function rme(t){return Wd(t)>=p8e(t).metersPerDegree?"meters":pv(t)}function Wd(t,e=is.metersPerDegree){return P8e(t,!0)??e}function P8e(t,e=!1){const n=t?.wkid??null,r=t?.wkt2??t?.wkt??null;let i=null;if(n){if(OO(n))return Td.metersPerDegree;if(LO(n))return Vg.metersPerDegree;i=w2.values[w2[n]],!i&&e&&g8e.has(n)&&(i=m8e)}else r&&(ome(r)?i=Mee(eme.exec(r),i):sme(r)&&(i=Mee(tme.exec(r),i)));return i}function EPt(t){return db(t)?1:Wd(t)}function Mee(t,e){return t?.[1]?ime(t[1]):e}function ime(t){return parseFloat(t.split(",")[1])}function pv(t){const e=t?.wkid??null,n=t?.wkt2??t?.wkt??null;let r=null;if(e)r=w2.units[w2[e]];else if(n){const i=ome(n)?eme:sme(n)?tme:null;if(i){const s=i.exec(n);s?.[1]&&(r=R8e(s[1]))}}return r!=null?$B(r):null}function SPt(t){const e=pv(t);return e!=null&&nme.includes(e)?e:null}function TPt(t){const e=rme(t);return e!=null&&nme.includes(e)?e:null}function kPt(t){const e=pv(t);return e==null?null:E8e.get(e)}function sme(t){return/^GEOCCS/i.test(t)}function ome(t){return/^\s*(?:PROJCS|PROJCRS|PROJECTEDCRS)/i.test(t)}const C8e=1e-7;function R8e(t){let n=/[\\"']([^\\"']+)/.exec(t)?.[1];if(!n||!$B(n)){const r=ime(t);n=null;const i=w2.values;for(let s=0;s<i.length;++s)if(Math.abs(r-i[s])<C8e){n=w2.units[s];break}}return n}function APt(t){const e=pv(t);if(e==null)return null;switch(e){case"feet":case"us-feet":case"clarke-feet":case"fathoms":case"nautical-miles":case"us-chains":case"us-links":case"us-miles":case"clarke-yards":case"clarke-chains":case"clarke-links":case"sears-yards":case"sears-feet":case"sears-chains":case"sears-links":case"benoit-1895-a-yards":case"benoit-1895-a-feet":case"benoit-1895-a-chains":case"benoit-1895-a-links":case"benoit-1895-b-yards":case"benoit-1895-b-feet":case"benoit-1895-b-chains":case"benoit-1895-b-links":case"1865-feet":case"indian-feet":case"indian-1937-feet":case"indian-1962-feet":case"indian-1975-feet":case"indian-yards":case"indian-1937-yards":case"indian-1962-yards":case"indian-1975-yards":case"statute-miles":case"gold-coast-feet":case"british-1936-feet":case"yards":case"chains":case"links":case"sears-1922-truncated-yards":case"sears-1922-truncated-feet":case"sears-1922-truncated-chains":case"sears-1922-truncated-links":case"us-yards":case"inches":case"us-inches":case"rods":case"us-rods":case"us-nautical-miles":case"uk-nautical-miles":case"smoots":case"tx-vara":case"points":return"imperial";case"millimeters":case"centimeters":case"meters":case"german-meters":case"kilometers":case"decimeters":case"micrometers":case"nanometers":case"50-kilometers":case"150-kilometers":return"metric"}return null}const M8e={esriAcres:"acres",esriAres:"ares",esriHectares:"hectares",esriSquareCentimeters:"square-centimeters",esriSquareDecimeters:"square-decimeters",esriSquareFeet:"square-feet",esriSquareInches:"square-inches",esriSquareKilometers:"square-kilometers",esriSquareMeters:"square-meters",esriSquareMiles:"square-miles",esriSquareMillimeters:"square-millimeters",esriSquareUsFeet:"square-us-feet",esriSquareYards:"square-yards"},N8e={esriCentimeters:"centimeters",esriDecimeters:"decimeters",esriFeet:"feet",esriInches:"inches",esriKilometers:"kilometers",esriMeters:"meters",esriMiles:"miles",esriMillimeters:"millimeters",esriNauticalMiles:"nautical-miles",esriYards:"yards"},O8e={esriDUDecimalDegrees:"degrees",esriDURadians:"radians"},IPt=Ol()(M8e),PPt=Ol()(N8e),CPt=Ol()(O8e);var Kh,dd;let Bt=(dd=class extends qt{static fromJSON(e){if(!e)return null;if(e?.wkid===102100)return Kh.WebMercator;if(e?.wkid===4326)return Kh.WGS84;const n=new Kh;return n.read(e),n}constructor(e){super(e),this.latestWkid=null,this.wkid=null,this.wkt=null,this.wkt2=null,this.vcsWkid=null,this.latestVcsWkid=null,this.imageCoordinateSystem=null}normalizeCtorArgs(e){return e&&typeof e=="object"?e:{[typeof e=="string"?"wkt":"wkid"]:e}}get isWGS84(){return z1(this)}get isWebMercator(){return Dd(this)}get isGeographic(){return db(this)}get isWrappable(){return l8e(this)}get metersPerUnit(){return Wd(this)}get unit(){return pv(this)||(this.isGeographic?"degrees":null)}writeWkt(e,n){this.wkid||(n.wkt=e)}clone(){if(this===Kh.WGS84)return new Kh(Jpe);if(this===Kh.WebMercator)return new Kh(Qpe);const e=new Kh;return this.wkid!=null?(e.wkid=this.wkid,this.latestWkid!=null&&(e.latestWkid=this.latestWkid),this.vcsWkid!=null&&(e.vcsWkid=this.vcsWkid),this.latestVcsWkid!=null&&(e.latestVcsWkid=this.latestVcsWkid)):(this.wkt!=null&&(e.wkt=this.wkt),this.wkt2!=null&&(e.wkt2=this.wkt2)),this.imageCoordinateSystem&&(e.imageCoordinateSystem=Ze(this.imageCoordinateSystem)),e}equals(e){if(e==null)return!1;if(this.imageCoordinateSystem||e.imageCoordinateSystem){if(this.imageCoordinateSystem==null||e.imageCoordinateSystem==null)return!1;const{id:n,referenceServiceName:r}=e.imageCoordinateSystem,{geodataXform:i}=e.imageCoordinateSystem,s=this.imageCoordinateSystem;return n==null||i?JSON.stringify(s)===JSON.stringify(e.imageCoordinateSystem):r?s.id===n&&s.referenceServiceName===r:s.id===n}return go(this,e)}toJSON(e){return this.write(void 0,e)}},Kh=dd,dd.GCS_NAD_1927=null,dd.WGS84=null,dd.WebMercator=null,dd.PlateCarree=null,dd);x([E({readOnly:!0})],Bt.prototype,"isWGS84",null),x([E({readOnly:!0})],Bt.prototype,"isWebMercator",null),x([E({readOnly:!0})],Bt.prototype,"isGeographic",null),x([E({readOnly:!0})],Bt.prototype,"isWrappable",null),x([E({type:Dr,json:{write:!0}})],Bt.prototype,"latestWkid",void 0),x([E({readOnly:!0})],Bt.prototype,"metersPerUnit",null),x([E({readOnly:!0})],Bt.prototype,"unit",null),x([E({type:Dr,json:{write:!0,origins:{"web-scene":{write:{overridePolicy(){return{isRequired:this.wkt==null}}}}}}})],Bt.prototype,"wkid",void 0),x([E({type:String,json:{origins:{"web-scene":{write:{overridePolicy(){return{isRequired:this.wkid==null}}}}}}})],Bt.prototype,"wkt",void 0),x([er("wkt"),er("web-scene","wkt")],Bt.prototype,"writeWkt",null),x([E({type:String,json:{write:!1}})],Bt.prototype,"wkt2",void 0),x([E({type:Dr,json:{write:!0}})],Bt.prototype,"vcsWkid",void 0),x([E({type:Dr,json:{write:!0}})],Bt.prototype,"latestVcsWkid",void 0),x([E()],Bt.prototype,"imageCoordinateSystem",void 0),Bt=Kh=x([ue("esri.geometry.SpatialReference")],Bt),Bt.prototype.toJSON.isDefaultToJSON=!0,Bt.GCS_NAD_1927=Kt.freeze(new Bt({wkid:4267,wkt:'GEOGCS["GCS_North_American_1927",DATUM["D_North_American_1927",SPHEROID["Clarke_1866",6378206.4,294.9786982]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]]'})),Bt.WGS84=Kt.freeze(new Bt(Jpe)),Bt.WebMercator=Kt.freeze(new Bt(Qpe)),Bt.PlateCarree=Kt.freeze(new Bt(c8e));function cr(t,e,n){let r,i;return e===void 0||Array.isArray(e)?(i=t,n=e,r=[void 0]):(i=e,r=Array.isArray(t)?t:[t]),(s,o)=>{const a=s.constructor.prototype;r.forEach(l=>{const c=TB(s,l,i);c.read&&typeof c.read=="object"||(c.read={}),c.read.reader=a[o],n&&(c.read.source=(c.read.source||[]).concat(n))})}}let Gs=class extends qt{constructor(...e){super(...e),this.type=null,this.hasM=!1,this.hasZ=!1,this.spatialReference=Bt.WGS84}get cache(){return this.commitProperty("spatialReference"),{}}get extent(){return null}readSpatialReference(e,n){if(e instanceof Bt)return e;if(e!=null){const r=new Bt;return r.read(e,n),r}return e}clone(){return console.warn(".clone() is not implemented for "+this.declaredClass),null}clearCache(){this.notifyChange("cache")}getCacheValue(e){return this.cache[e]}setCacheValue(e,n){this.cache[e]=n}};x([E()],Gs.prototype,"type",void 0),x([E({readOnly:!0})],Gs.prototype,"cache",null),x([E({readOnly:!0})],Gs.prototype,"extent",null),x([E({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Gs.prototype,"hasM",void 0),x([E({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Gs.prototype,"hasZ",void 0),x([E({type:Bt,json:{write:!0},value:Bt.WGS84})],Gs.prototype,"spatialReference",void 0),x([cr("spatialReference")],Gs.prototype,"readSpatialReference",null),Gs=x([ue("esri.geometry.Geometry")],Gs);const L8e=Object.prototype.toString;function D8e(t){const e="__accessorMetadata__"in t?Ha(t):t;return function(...n){if(n.push(e),typeof n[2]=="number")throw new Error("Using @cast has parameter decorator is not supported since 4.16");return j8e.apply(this,n)}}function j8e(t,e,n,r){yI(t,e).cast=r}function $8e(t){return(e,n)=>{yI(e,t).cast=e[n]}}function qs(...t){if(t.length!==3||typeof t[1]!="string")return t.length===1&&L8e.call(t[0])==="[object Function]"?D8e(t[0]):t.length===1&&typeof t[0]=="string"?$8e(t[0]):void 0}function b2(t){if(t&&typeof t=="object"&&"type"in t&&t.type==="mesh")throw new Xe("internal:mesh","Mesh geometries are not supported for this operation")}function F8e(t){t.forEach(b2)}const V8e=57.29577951308232,z8e=.017453292519943;function Nee(t){return t*V8e}function Oee(t){return t*z8e}function MPt(t){return Math.PI/2-2*Math.atan(Math.exp(-t/is.radius))}function p9(t){return t.wkid!=null||t.wkt!=null}const Cj=[0,0];function J4(t,e,n,r,i){const s=t,o=i;if(o.spatialReference=n,"x"in s&&"x"in o)[o.x,o.y]=e(s.x,s.y,Cj,r);else if("xmin"in s&&"xmin"in o)[o.xmin,o.ymin]=e(s.xmin,s.ymin,Cj,r),[o.xmax,o.ymax]=e(s.xmax,s.ymax,Cj,r);else if("paths"in s&&"paths"in o||"rings"in s&&"rings"in o){const a="paths"in s?s.paths:s.rings,l=[];let c;for(let u=0;u<a.length;u++){const h=a[u];c=[],l.push(c);for(let f=0;f<h.length;f++)c.push(e(h[f][0],h[f][1],[0,0],r)),h[f].length>2&&c[f].push(h[f][2]),h[f].length>3&&c[f].push(h[f][3])}"paths"in o?o.paths=l:o.rings=l}else if("points"in s&&"points"in o){const a=s.points,l=[];for(let c=0;c<a.length;c++)l[c]=e(a[c][0],a[c][1],[0,0],r),a[c].length>2&&l[c].push(a[c][2]),a[c].length>3&&l[c].push(a[c][3]);o.points=l}return i}function wM(t,e){const n=t&&(p9(t)?t:t.spatialReference),r=e&&(p9(e)?e:e.spatialReference);return!(t&&"type"in t&&t.type==="mesh"||e&&"type"in e&&e.type==="mesh"||!n||!r)&&(!!go(r,n)||Dd(r)&&z1(n)||Dd(n)&&z1(r))}function DO(t,e){if(t==null)return null;const n=t.spatialReference,r=e&&(p9(e)?e:e.spatialReference);return wM(n,r)?go(n,r)?Ze(t):Dd(r)?J4(t,Sx,Bt.WebMercator,!1,Ze(t)):z1(r)?J4(t,jO,Bt.WGS84,!1,Ze(t)):null:null}function Sx(t,e,n=[0,0]){e>89.99999?e=89.99999:e<-89.99999&&(e=-89.99999);const r=Oee(e);return n[0]=Oee(t)*is.radius,n[1]=is.halfSemiMajorAxis*Math.log((1+Math.sin(r))/(1-Math.sin(r))),n}function jO(t,e,n=[0,0],r=!1){if(t===Gk[0])n[0]=-180;else if(t===Gk[1])n[0]=180;else{const i=Nee(t/is.radius);n[0]=r?i:i-360*Math.floor((i+180)/360)}return n[1]=Nee(Math.PI/2-2*Math.atan(Math.exp(-e/is.radius))),n}function i1(t,e=!1,n=Ze(t)){return b2(t),b2(n),J4(t,Sx,Bt.WebMercator,e,n)}function hS(t,e=!1,n=Ze(t)){return b2(t),b2(n),J4(t,jO,Bt.WGS84,e,n)}function ame(t,e){const n=t.x-e.x,r=t.y-e.y,i=t.z!=null&&e.z!=null?t.z-e.z:0;return Math.sqrt(n*n+r*r+i*i)}function G8e(t){return lme(t,cme)?.[0]??null}function U8e(t){return lme(t,cme)?.[1]??null}function lme({x:t,y:e,spatialReference:n},r=[0,0]){if(n){if(Dd(n))return jO(t,e,r);if(db(n))return r[0]=t,r[1]=e,r}return null}const cme=[0,0];var bM;const Rj=[0,0];function Lee(t){return t&&(t.declaredClass==="esri.geometry.SpatialReference"||t.wkid!=null)}let Jt=bM=class extends Gs{static copy(t,e){e._set("x",t._get("x")),e._set("y",t._get("y")),e._set("z",t._get("z")),e._set("m",t._get("m"));const n=t._get("spatialReference");e._set("spatialReference",Kt.isFrozen(n)?n:n.clone())}constructor(...t){super(...t),this.x=0,this.y=0,this.z=void 0,this.m=void 0,this.type="point"}normalizeCtorArgs(t,e,n,r,i){let s;if(Array.isArray(t))s=t,i=e,t=s[0],e=s[1],n=s[2],r=s[3];else if(t&&typeof t=="object"){if(s=t,t=s.x!=null?s.x:s.longitude,e=s.y!=null?s.y:s.latitude,n=s.z,r=s.m,(i=s.spatialReference)&&i.declaredClass!=="esri.geometry.SpatialReference"&&(i=new Bt(i)),s.longitude!=null||s.latitude!=null){if(s.longitude==null)kt.getLogger(this).warn(".longitude=","Latitude was defined without longitude");else if(s.latitude==null)kt.getLogger(this).warn(".latitude=","Longitude was defined without latitude");else if(!s.declaredClass&&i?.isWebMercator){const a=Sx(s.longitude,s.latitude,Rj);t=a[0],e=a[1]}}}else Lee(n)?(i=n,n=null):Lee(r)&&(i=r,r=null);const o={x:t,y:e};return o.x==null&&o.y!=null?kt.getLogger(this).warn(".y=","Y coordinate was defined without an X coordinate"):o.y==null&&o.x!=null&&kt.getLogger(this).warn(".x=","X coordinate was defined without a Y coordinate"),i!=null&&(o.spatialReference=i),n!=null&&(o.z=n),r!=null&&(o.m=r),o}get cache(){return this.commitProperty("x"),this.commitProperty("y"),this.commitProperty("z"),this.commitProperty("m"),this.commitProperty("spatialReference"),{}}get hasM(){return this.m!==void 0}set hasM(t){t!==(this._get("m")!==void 0)&&(this._set("m",t?0:void 0),this._set("hasM",t))}get hasZ(){return this.z!==void 0}set hasZ(t){t!==(this._get("z")!==void 0)&&(this._set("z",t?0:void 0),this._set("hasZ",t))}get latitude(){return U8e(this)}set latitude(t){const{spatialReference:e,x:n}=this;t!=null&&e&&(e.isWebMercator?this._set("y",Sx(n,t,Rj)[1]):e.isGeographic&&this._set("y",t),this._set("latitude",t))}get longitude(){return G8e(this)}set longitude(t){const{y:e,spatialReference:n}=this;t!=null&&n&&(n.isWebMercator?this._set("x",Sx(t,e,Rj)[0]):n.isGeographic&&this._set("x",t),this._set("longitude",t))}writeX(t,e,n){e[n]=isNaN(t)?"NaN":t}readX(t){return typeof t=="string"?NaN:t}clone(){const t=new bM;return t.x=this.x,t.y=this.y,t.z=this.z,t.m=this.m,t.spatialReference=this.spatialReference,t}copy(t){return bM.copy(t,this),this}equals(t){if(t==null)return!1;const{x:e,y:n,z:r,m:i,spatialReference:s}=this,{z:o,m:a}=t;let{x:l,y:c,spatialReference:u}=t;if(!s.equals(u))if(s.isWebMercator&&u.isWGS84)[l,c]=Sx(l,c),u=s;else{if(!s.isWGS84||!u.isWebMercator)return!1;[l,c]=jO(l,c),u=s}return e===l&&n===c&&r===o&&i===a&&s.wkid===u.wkid}offset(t,e,n){return this.x+=t,this.y+=e,n!=null&&(this.z=(this.z??0)+n),this}normalize(){if(!this.spatialReference)return this;const t=za(this.spatialReference);if(!t)return this;let e=this.x;const[n,r]=t.valid,i=2*r;let s;return e>r?(s=Math.ceil(Math.abs(e-r)/i),e-=s*i):e<n&&(s=Math.ceil(Math.abs(e-n)/i),e+=s*i),this._set("x",e),this}distance(t){return ame(this,t)}toArray(){const t=this.hasZ,e=this.hasM;return t&&e?[this.x,this.y,this.z,this.m]:t?[this.x,this.y,this.z]:e?[this.x,this.y,this.m]:[this.x,this.y]}toJSON(t){return this.write({},t)}};x([E({readOnly:!0})],Jt.prototype,"cache",null),x([E({type:Boolean,json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],Jt.prototype,"hasM",null),x([E({type:Boolean,json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],Jt.prototype,"hasZ",null),x([E({type:Number})],Jt.prototype,"latitude",null),x([E({type:Number})],Jt.prototype,"longitude",null),x([E({type:Number,json:{type:[Number,String],write:{isRequired:!0,allowNull:!0}}}),qs(t=>isNaN(t)?t:sc(t))],Jt.prototype,"x",void 0),x([er("x")],Jt.prototype,"writeX",null),x([cr("x")],Jt.prototype,"readX",null),x([E({type:Number,json:{write:!0}})],Jt.prototype,"y",void 0),x([E({type:Number,json:{write:{overridePolicy(){return{enabled:this.hasZ}}}}})],Jt.prototype,"z",void 0),x([E({type:Number,json:{write:{overridePolicy(){return{enabled:this.hasM}}}}})],Jt.prototype,"m",void 0),Jt=bM=x([ue("esri.geometry.Point")],Jt),Jt.prototype.toJSON.isDefaultToJSON=!0;const Mj=[0,0];function wI(t,e){return e!=null&&Aa(t,e.x,e.y,e.z)}function NPt(t,e){if(!e.points?.length)return!1;for(const n of e.points)if(!E2(t,n))return!1;return!0}function B8e(t,e){const{xmin:n,ymin:r,zmin:i,xmax:s,ymax:o,zmax:a}=e;return t.hasZ&&e.hasZ?Aa(t,n,r,i)&&Aa(t,n,o,i)&&Aa(t,s,o,i)&&Aa(t,s,r,i)&&Aa(t,n,r,a)&&Aa(t,n,o,a)&&Aa(t,s,o,a)&&Aa(t,s,r,a):Aa(t,n,r)&&Aa(t,n,o)&&Aa(t,s,o)&&Aa(t,s,r)}function E2(t,e){return Aa(t,e[0],e[1])}function W8e(t,e){return Aa(t,e[0],e[1],e[2])}function Aa(t,e,n,r){return e>=t.xmin&&e<=t.xmax&&n>=t.ymin&&n<=t.ymax&&(r==null||!t.hasZ||r>=t.zmin&&r<=t.zmax)}function FB(t,e){return Mj[1]=e.y,Mj[0]=e.x,H8e(t,Mj)}function H8e(t,e){return VB(t.rings,e)}function VB(t,e){if(!t||t.length<1)return!1;if(q8e(t))return Dee(!1,t,e);let n=!1;for(let r=0,i=t.length;r<i;r++)n=Dee(n,t[r],e);return n}function q8e(t){return!Array.isArray(t[0][0])}function Dee(t,e,n){const[r,i]=n;let s=t,o=0;for(let a=0,l=e.length;a<l;a++){o++,o===l&&(o=0);const[c,u]=e[a],[h,f]=e[o];(u<i&&f>=i||f<i&&u>=i)&&c+(i-u)/(f-u)*(h-c)<r&&(s=!s)}return s}function K8e(t,e){return wI(t,e)}function Y8e(t,e){const n=t.hasZ&&e.hasZ;let r,i,s;if(t.xmin<=e.xmin){if(r=e.xmin,t.xmax<r)return!1}else if(r=t.xmin,e.xmax<r)return!1;if(t.ymin<=e.ymin){if(i=e.ymin,t.ymax<i)return!1}else if(i=t.ymin,e.ymax<i)return!1;if(n&&e.hasZ){if(t.zmin<=e.zmin){if(s=e.zmin,t.zmax<s)return!1}else if(s=t.zmin,e.zmax<s)return!1}return!0}function X8e(t,e){const{points:n,hasZ:r}=e,i=r?W8e:E2;for(const s of n)if(i(t,s))return!0;return!1}const G1=[0,0],U1=[0,0],B1=[0,0],W1=[0,0],Z8e=[G1,U1,B1,W1],ume=[[B1,G1],[G1,U1],[U1,W1],[W1,B1]];function J8e(t,e){return Q8e(t,e.rings)}function Q8e(t,e){G1[0]=t.xmin,G1[1]=t.ymax,U1[0]=t.xmax,U1[1]=t.ymax,B1[0]=t.xmin,B1[1]=t.ymin,W1[0]=t.xmax,W1[1]=t.ymin;for(const n of Z8e)if(VB(e,n))return!0;for(const n of e){if(!n.length)continue;let r=n[0];if(E2(t,r))return!0;for(let i=1;i<n.length;i++){const s=n[i];if(E2(t,s)||hme(r,s,ume))return!0;r=s}}return!1}function e9e(t,e){G1[0]=t.xmin,G1[1]=t.ymax,U1[0]=t.xmax,U1[1]=t.ymax,B1[0]=t.xmin,B1[1]=t.ymin,W1[0]=t.xmax,W1[1]=t.ymin;const n=e.paths;for(const r of n){if(!n.length)continue;let i=r[0];if(E2(t,i))return!0;for(let s=1;s<r.length;s++){const o=r[s];if(E2(t,o)||hme(i,o,ume))return!0;i=o}}return!1}const to=[0,0];function t9e(t){for(let e=0;e<t.length;e++){const n=t[e];for(let i=0;i<n.length-1;i++){const s=n[i],o=n[i+1];for(let a=e+1;a<t.length;a++)for(let l=0;l<t[a].length-1;l++){const c=t[a][l],u=t[a][l+1];if(m9(s,o,c,u,to)&&!(to[0]===s[0]&&to[1]===s[1]||to[0]===c[0]&&to[1]===c[1]||to[0]===o[0]&&to[1]===o[1]||to[0]===u[0]&&to[1]===u[1]))return!0}}const r=n.length;if(!(r<=4))for(let i=0;i<r-3;i++){let s=r-1;i===0&&(s=r-2);const o=n[i],a=n[i+1];for(let l=i+2;l<s;l++){const c=n[l],u=n[l+1];if(m9(o,a,c,u,to)&&!(to[0]===o[0]&&to[1]===o[1]||to[0]===c[0]&&to[1]===c[1]||to[0]===a[0]&&to[1]===a[1]||to[0]===u[0]&&to[1]===u[1]))return!0}}}return!1}function hme(t,e,n){for(let r=0;r<n.length;r++)if(m9(t,e,n[r][0],n[r][1]))return!0;return!1}function m9(t,e,n,r,i){const[s,o]=t,[a,l]=e,[c,u]=n,[h,f]=r,g=h-c,y=s-c,_=a-s,b=f-u,T=o-u,A=l-o,I=b*_-g*A;if(I===0)return!1;const P=(g*T-b*y)/I,R=(_*T-A*y)/I;return P>=0&&P<=1&&R>=0&&R<=1&&(i&&(i[0]=s+P*(a-s),i[1]=o+P*(l-o)),!0)}function n9e(t){switch(t){case"esriGeometryEnvelope":case"extent":return Y8e;case"esriGeometryMultipoint":case"multipoint":return X8e;case"esriGeometryPoint":case"point":return K8e;case"esriGeometryMultiPatch":case"multipatch":case"esriGeometryPolygon":case"polygon":return J8e;case"esriGeometryPolyline":case"polyline":return e9e}}var Uu;function r9e(t){return t&&(t.declaredClass==="esri.geometry.SpatialReference"||t.wkid!=null)}function dm(t,e,n){return e==null?n:n==null?e:t(e,n)}let Vn=Uu=class extends Gs{constructor(...t){super(...t),this.type="extent",this.xmin=0,this.ymin=0,this.mmin=void 0,this.zmin=void 0,this.xmax=0,this.ymax=0,this.mmax=void 0,this.zmax=void 0}normalizeCtorArgs(t,e,n,r,i){return r9e(t)?{spatialReference:t,xmin:0,ymin:0,xmax:0,ymax:0}:typeof t=="object"?(t.spatialReference=t.spatialReference==null?Bt.WGS84:t.spatialReference,t):{xmin:t,ymin:e,xmax:n,ymax:r,spatialReference:i??Bt.WGS84}}static fromPoint(t){return new Uu({xmin:t.x,ymin:t.y,zmin:t.z,xmax:t.x,ymax:t.y,zmax:t.z,spatialReference:t.spatialReference})}get cache(){return this.commitProperty("xmin"),this.commitProperty("ymin"),this.commitProperty("zmin"),this.commitProperty("mmin"),this.commitProperty("xmax"),this.commitProperty("ymax"),this.commitProperty("zmax"),this.commitProperty("mmax"),this.commitProperty("spatialReference"),{}}get center(){const t=new Jt({x:.5*(this.xmin+this.xmax),y:.5*(this.ymin+this.ymax),spatialReference:this.spatialReference});return this.hasZ&&(t.z=.5*(this.zmin+this.zmax)),this.hasM&&(t.m=.5*(this.mmin+this.mmax)),t}get extent(){return this.clone()}get hasM(){return this.mmin!=null&&this.mmax!=null}get hasZ(){return this.zmin!=null&&this.zmax!=null}get height(){return Math.abs(this.ymax-this.ymin)}get width(){return Math.abs(this.xmax-this.xmin)}centerAt(t){const e=this.center;return t.z!=null&&this.hasZ?this.offset(t.x-e.x,t.y-e.y,t.z-e.z):this.offset(t.x-e.x,t.y-e.y)}clone(){const t=new Uu;return t.xmin=this.xmin,t.ymin=this.ymin,t.xmax=this.xmax,t.ymax=this.ymax,t.spatialReference=this.spatialReference,this.zmin!=null&&(t.zmin=this.zmin,t.zmax=this.zmax),this.mmin!=null&&(t.mmin=this.mmin,t.mmax=this.mmax),t}contains(t){if(!t)return!1;const e=this.spatialReference,n=t.spatialReference;return e&&n&&!e.equals(n)&&wM(e,n)&&(t=e.isWebMercator?i1(t):hS(t,!0)),t.type==="point"?wI(this,t):t.type==="extent"&&B8e(this,t)}equals(t){if(this===t)return!0;if(t==null)return!1;const e=this.spatialReference,n=t.spatialReference;return e&&n&&!e.equals(n)&&wM(e,n)&&(t=e.isWebMercator?i1(t):hS(t,!0)),this.xmin===t.xmin&&this.ymin===t.ymin&&this.zmin===t.zmin&&this.mmin===t.mmin&&this.xmax===t.xmax&&this.ymax===t.ymax&&this.zmax===t.zmax&&this.mmax===t.mmax}expand(t){const e=.5*(1-t),n=this.width*e,r=this.height*e;if(this.xmin+=n,this.ymin+=r,this.xmax-=n,this.ymax-=r,this.hasZ){const i=(this.zmax-this.zmin)*e;this.zmin+=i,this.zmax-=i}if(this.hasM){const i=(this.mmax-this.mmin)*e;this.mmin+=i,this.mmax-=i}return this}intersects(t){if(t==null)return!1;t.type==="mesh"&&(t=t.extent);const e=this.spatialReference,n=t.spatialReference;return e&&n&&!go(e,n)&&wM(e,n)&&(t=e.isWebMercator?i1(t):hS(t,!0)),n9e(t.type)(this,t)}normalize(){const t=this._normalize(!1,!0);return Array.isArray(t)?t:[t]}offset(t,e,n){return this.xmin+=t,this.ymin+=e,this.xmax+=t,this.ymax+=e,n!=null&&(this.zmin+=n,this.zmax+=n),this}shiftCentralMeridian(){return this._normalize(!0)}union(t){return this===t||(this.xmin=Math.min(this.xmin,t.xmin),this.ymin=Math.min(this.ymin,t.ymin),this.xmax=Math.max(this.xmax,t.xmax),this.ymax=Math.max(this.ymax,t.ymax),(this.hasZ||t.hasZ)&&(this.zmin=dm(Math.min,this.zmin,t.zmin),this.zmax=dm(Math.max,this.zmax,t.zmax)),(this.hasM||t.hasM)&&(this.mmin=dm(Math.min,this.mmin,t.mmin),this.mmax=dm(Math.max,this.mmax,t.mmax))),this}intersection(t){return this===t?this:t!=null&&this.intersects(t)?(this.xmin=Math.max(this.xmin,t.xmin),this.ymin=Math.max(this.ymin,t.ymin),this.xmax=Math.min(this.xmax,t.xmax),this.ymax=Math.min(this.ymax,t.ymax),(this.hasZ||t.hasZ)&&(this.zmin=dm(Math.max,this.zmin,t.zmin),this.zmax=dm(Math.min,this.zmax,t.zmax)),(this.hasM||t.hasM)&&(this.mmin=dm(Math.max,this.mmin,t.mmin),this.mmax=dm(Math.min,this.mmax,t.mmax)),this):null}toJSON(t){return this.write({},t)}_shiftCM(t=za(this.spatialReference)){if(!t||!this.spatialReference)return this;const e=this.spatialReference,n=this._getCM(t);if(n){const r=e.isWebMercator?hS(n):n;this.xmin-=n.x,this.xmax-=n.x,e.isWebMercator||(r.x=Nj(r.x,t).x),this.spatialReference=new Bt(ufe((e.isWGS84?t.altTemplate:null)??t.wkTemplate,{Central_Meridian:r.x}))}return this}_getCM(t){let e=null;const[n,r]=t.valid,i=this.xmin,s=this.xmax;return i>=n&&i<=r&&s>=n&&s<=r||(e=this.center),e}_normalize(t,e,n){const r=this.spatialReference;if(!r)return this;const i=n??za(r);if(i==null)return this;const s=this._getParts(i).map(l=>l.extent);if(s.length<2)return s[0]||this;if(s.length>2)return t?this._shiftCM(i):this.set({xmin:i.valid[0],xmax:i.valid[1]});if(t)return this._shiftCM(i);if(e)return s;let o=!0,a=!0;return s.forEach(l=>{l.hasZ||(o=!1),l.hasM||(a=!1)}),{rings:s.map(l=>{const c=[[l.xmin,l.ymin],[l.xmin,l.ymax],[l.xmax,l.ymax],[l.xmax,l.ymin],[l.xmin,l.ymin]];if(o){const u=(l.zmax-l.zmin)/2;for(let h=0;h<c.length;h++)c[h].push(u)}if(a){const u=(l.mmax-l.mmin)/2;for(let h=0;h<c.length;h++)c[h].push(u)}return c}),hasZ:o,hasM:a,spatialReference:r}}_getParts(t){let e=this.cache._parts;if(!e){e=[];const{ymin:i,ymax:s,spatialReference:o}=this,a=this.width,l=this.xmin,c=this.xmax;let u;t=t||za(o);const[h,f]=t.valid;u=Nj(this.xmin,t);const g=u.x,y=u.frameId;u=Nj(this.xmax,t);const _=u.x,b=u.frameId,T=g===_&&a>0;if(a>2*f){const A=new Uu(l<c?g:_,i,f,s,o),I=new Uu(h,i,l<c?_:g,s,o),P=new Uu(0,i,f,s,o),R=new Uu(h,i,0,s,o),D=[],C=[];A.contains(P)&&D.push(y),A.contains(R)&&C.push(y),I.contains(P)&&D.push(b),I.contains(R)&&C.push(b);for(let M=y+1;M<b;M++)D.push(M),C.push(M);e.push({extent:A,frameIds:[y]},{extent:I,frameIds:[b]},{extent:P,frameIds:D},{extent:R,frameIds:C})}else g>_||T?e.push({extent:new Uu(g,i,f,s,o),frameIds:[y]},{extent:new Uu(h,i,_,s,o),frameIds:[b]}):e.push({extent:new Uu(g,i,_,s,o),frameIds:[y]});this.cache._parts=e}const n=this.hasZ,r=this.hasM;if(n||r){const i={};n&&(i.zmin=this.zmin,i.zmax=this.zmax),r&&(i.mmin=this.mmin,i.mmax=this.mmax);for(let s=0;s<e.length;s++)e[s].extent.set(i)}return e}};function Nj(t,e){const[n,r]=e.valid,i=2*r;let s,o=0;return t>r?(s=Math.ceil(Math.abs(t-r)/i),t-=s*i,o=s):t<n&&(s=Math.ceil(Math.abs(t-n)/i),t+=s*i,o=-s),{x:t,frameId:o}}x([E({readOnly:!0})],Vn.prototype,"cache",null),x([E({readOnly:!0})],Vn.prototype,"center",null),x([E({readOnly:!0})],Vn.prototype,"extent",null),x([E({readOnly:!0,json:{write:{enabled:!1,overridePolicy:null}}})],Vn.prototype,"hasM",null),x([E({readOnly:!0,json:{write:{enabled:!1,overridePolicy:null}}})],Vn.prototype,"hasZ",null),x([E({readOnly:!0})],Vn.prototype,"height",null),x([E({readOnly:!0})],Vn.prototype,"width",null),x([E({type:Number,json:{type:[Number,String],write:{enabled:!0,allowNull:!0}}})],Vn.prototype,"xmin",void 0),x([E({type:Number,json:{write:!0}})],Vn.prototype,"ymin",void 0),x([E({type:Number,json:{origins:{"web-scene":{write:!1}},read:t=>t??void 0,write:{overridePolicy(){return{enabled:this.hasM}}}}})],Vn.prototype,"mmin",void 0),x([E({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasZ}}}}})],Vn.prototype,"zmin",void 0),x([E({type:Number,json:{write:!0}})],Vn.prototype,"xmax",void 0),x([E({type:Number,json:{write:!0}})],Vn.prototype,"ymax",void 0),x([E({type:Number,json:{origins:{"web-scene":{write:!1}},read:t=>t??void 0,write:{overridePolicy(){return{enabled:this.hasM}}}}})],Vn.prototype,"mmax",void 0),x([E({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasZ}}}}})],Vn.prototype,"zmax",void 0),Vn=Uu=x([ue("esri.geometry.Extent")],Vn),Vn.prototype.toJSON.isDefaultToJSON=!0;let mT;const i9e=globalThis.esriConfig?.locale??globalThis.dojoConfig?.locale,g9=globalThis.document?.documentElement;function dme(){const t=g9?.getAttribute("lang"),e=globalThis.navigator?.language;return i9e??t??e??"en"}function hu(){return mT===void 0&&(mT=dme()),mT}const s9e=/^(?<language>[a-z]{2,3})(?:-(?<extlang>[a-z]{3}))?(?:-[A-Z][a-z]{3})?(?:-(?<region>[A-Z]{2}|\d{3}))?(?:-.*)?$/;function zB(t=hu()){return pme(t)?.language}function fme(t=hu()){const e=pme(t);return e?.language&&e?.extlang?t.replace(`${e.language}-`,""):t}function pme(t=hu()){return s9e.exec(t)?.groups}const EM=[];function mme(t){return EM.push(t),Zn(()=>{EM.splice(EM.indexOf(t),1)})}const SM=[];function GB(t){return SM.push(t),Zn(()=>SM.splice(SM.indexOf(t),1))}function jee(){const t=dme();mT!==t&&([...SM].forEach(e=>e(t)),mT=t,[...EM].forEach(e=>e(t)))}globalThis.addEventListener?.("languagechange",jee),g9&&new MutationObserver(()=>{jee()}).observe(g9,{attributeFilter:["lang"]});let LC;function o9e(t){return LC&&!LC.destroyed||(LC=t()),LC}var y9;const a9e=new Ys({avgRating:"avg-rating",numRatings:"num-ratings",numComments:"num-comments",numViews:"num-views"});let us=y9=class extends Kt{constructor(t){super(t),this.categories=null,this.disableExtraQuery=!1,this.extent=null,this.filter=null,this.num=10,this.query=null,this.sortField=null,this.start=1}get sortOrder(){return this._get("sortOrder")||"asc"}set sortOrder(t){t!=="asc"&&t!=="desc"||this._set("sortOrder",t)}clone(){return new y9({categories:this.categories?Ze(this.categories):null,disableExtraQuery:this.disableExtraQuery,extent:this.extent?this.extent.clone():null,filter:this.filter,num:this.num,query:this.query,sortField:this.sortField,sortOrder:this.sortOrder,start:this.start})}toRequestOptions(t,e){let n=[];this.categories&&(n=this.categories.map(o=>Array.isArray(o)?JSON.stringify(o):o));let r="";if(this.extent){const o=DO(this.extent,Bt.WGS84);o!=null&&(r=`${o.xmin},${o.ymin},${o.xmax},${o.ymax}`)}let i=this.query;!this.disableExtraQuery&&t.extraQuery&&(i="("+i+")"+t.extraQuery);const s={categories:n,bbox:r,q:i,filter:this.filter,num:this.num,sortField:null,sortOrder:null,start:this.start};return this.sortField&&(s.sortField=this.sortField.split(",").map(o=>a9e.toJSON(o.trim())).join(","),s.sortOrder=this.sortOrder),{query:{...e,...s}}}};x([E()],us.prototype,"categories",void 0),x([E()],us.prototype,"disableExtraQuery",void 0),x([E({type:Vn})],us.prototype,"extent",void 0),x([E()],us.prototype,"filter",void 0),x([E()],us.prototype,"num",void 0),x([E()],us.prototype,"query",void 0),x([E()],us.prototype,"sortField",void 0),x([E()],us.prototype,"sortOrder",null),x([E()],us.prototype,"start",void 0),us=y9=x([ue("esri.portal.PortalQueryParams")],us);var v9;let Wi=v9=class extends qt{constructor(t){super(t),this.access=null,this.created=null,this.description=null,this.id=null,this.isInvitationOnly=!1,this.modified=null,this.owner=null,this.portal=null,this.snippet=null,this.sortField=null,this.sortOrder=null,this.sourceJSON=null,this.tags=null,this.title=null}get thumbnailUrl(){const t=this.url,e=this.thumbnail;return t&&e&&this.portal?this.portal?.normalizeUrl(`${t}/info/${e}?f=json`):null}get url(){const t=this.portal?.restUrl;return t?t+"/community/groups/"+this.id:null}fetchCategorySchema(t){return this.portal.request(this.url+"/categorySchema",t).then(e=>{const n=e.categorySchema||[];return n.some(r=>r.source==="contentCategorySetsGroupQuery.LivingAtlas")?this._fetchCategorySchemaSet("LivingAtlas",t):n})}fetchMembers(t){return this.portal.request(this.url+"/users",t)}getThumbnailUrl(t){let e=this.thumbnailUrl;return e&&t&&(e+=`&w=${t}`),e}toJSON(){throw new Xe("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented")}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");const e=new v9({sourceJSON:t});return e.read(t),e}queryItems(t,e){let n=Ha(us,t);const r=this.portal;return parseFloat(r.currentVersion)>5?(n=n||new us,r.queryPortal(`/content/groups/${this.id}/search`,n,"PortalItem",e)):(n=n?n.clone():new us,n.query="group:"+this.id+(n.query?" "+n.query:""),r.queryItems(n,e))}_fetchCategorySchemaSet(t,e){const n=this.portal;return n.fetchSelf(n.authMode,!0,e).then(r=>{const i=r.contentCategorySetsGroupQuery;if(i){const s=new us({disableExtraQuery:!0,num:1,query:i});return n.queryGroups(s,e)}throw new Xe("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery value not found")}).then(r=>{if(r.total){const i=r.results[0],s=new us({num:1,query:`typekeywords:"${t}"`});return i.queryItems(s,e)}throw new Xe("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery group not found")}).then(r=>r.total?r.results[0].fetchData("json",e).then(i=>{const s=i?.categorySchema;return s?.length?s:[]}):[])}};x([E()],Wi.prototype,"access",void 0),x([E({type:Date})],Wi.prototype,"created",void 0),x([E()],Wi.prototype,"description",void 0),x([E()],Wi.prototype,"id",void 0),x([E()],Wi.prototype,"isInvitationOnly",void 0),x([E({type:Date})],Wi.prototype,"modified",void 0),x([E()],Wi.prototype,"owner",void 0),x([E()],Wi.prototype,"portal",void 0),x([E()],Wi.prototype,"snippet",void 0),x([E()],Wi.prototype,"sortField",void 0),x([E()],Wi.prototype,"sortOrder",void 0),x([E()],Wi.prototype,"sourceJSON",void 0),x([E()],Wi.prototype,"tags",void 0),x([E()],Wi.prototype,"thumbnail",void 0),x([E({readOnly:!0})],Wi.prototype,"thumbnailUrl",null),x([E()],Wi.prototype,"title",void 0),x([E({readOnly:!0})],Wi.prototype,"url",null),Wi=v9=x([ue("esri.portal.PortalGroup")],Wi);let J0=class extends Kt{constructor(e){super(e),this.nextQueryParams=null,this.queryParams=null,this.results=null,this.total=null}};x([E()],J0.prototype,"nextQueryParams",void 0),x([E()],J0.prototype,"queryParams",void 0),x([E()],J0.prototype,"results",void 0),x([E()],J0.prototype,"total",void 0),J0=x([ue("esri.portal.PortalQueryResult")],J0);let vf=class extends qt{constructor(e){super(e),this.created=null,this.id=null,this.portal=null,this.title=null,this.username=null}get url(){const e=this.portal?.restUrl;return e?`${e}/content/users/${this.username}/${this.id}`:null}toJSON(){throw new Xe("internal:not-yet-implemented","PortalFolder.toJSON is not yet implemented")}};x([E({type:Date})],vf.prototype,"created",void 0),x([E()],vf.prototype,"id",void 0),x([E()],vf.prototype,"portal",void 0),x([E()],vf.prototype,"title",void 0),x([E({readOnly:!0})],vf.prototype,"url",null),x([E()],vf.prototype,"username",void 0),vf=x([ue("esri.portal.PortalFolder")],vf);var _9;let Fr=_9=class extends qt{constructor(t){super(t),this.access=null,this.created=null,this.culture=null,this.description=null,this.email=null,this.fullName=null,this.id=null,this.modified=null,this.orgId=null,this.portal=null,this.preferredView=null,this.privileges=null,this.region=null,this.role=null,this.roleId=null,this.sourceJSON=null,this.units=null,this.username=null,this.userLicenseTypeId=null,this.userType=null}get thumbnailUrl(){const t=this.url,e=this.thumbnail;return t&&e?this.portal.normalizeUrl(`${t}/info/${e}?f=json`):null}get userContentUrl(){const t=this.portal?.restUrl;return t?`${t}/content/users/${this.id}`:null}get url(){const t=this.portal?.restUrl;return t?`${t}/community/users/${this.id}`:null}addItem(t){const e=t&&t.item,n=t?.data,r=t?.folder,i={method:"post"};e&&(i.query=e.createPostQuery(),n!=null&&(typeof n=="string"?i.query.text=n:typeof n=="object"&&(i.query.text=JSON.stringify(n))));let s=this.userContentUrl;return r&&(s+="/"+(typeof r=="string"?r:r.id)),this.portal.request(s+"/addItem",i).then(o=>(e.id=o.id,e.portal=this.portal,e.loaded?e.reload():e.load()))}async deleteItem(t,e=!1){let n=this.userContentUrl;t.ownerFolder&&(n+="/"+t.ownerFolder);const r=e?{permanentDelete:!0}:{};await this.portal.request(n+`/items/${t.id}/delete`,{method:"post",query:r}),t.id=null,t.portal=null}async deleteItems(t,e=!1){t=t.slice();const n=this.userContentUrl+"/deleteItems",r=[],i=t.map(s=>s.id);if(i.length){const s={method:"post",query:{items:i.join(","),permanentDelete:e}},o=await this.portal.request(n,s);for(const a of o.results){const l=t.find(h=>a.itemId===h.id),c=a.success;let u=null;c?(l.id=null,l.portal=null):a.error&&(u=new Xe("portal:delete-item-failed",a.error.message,a.error)),r.push({item:l,success:c,error:u})}}return r}fetchFolders(){const t={query:{num:1}};return this.portal.request(this.userContentUrl??"",t).then(e=>{let n;return n=e&&e.folders?e.folders.map(r=>{const i=vf.fromJSON(r);return i.portal=this.portal,i}):[],n})}fetchGroups(){return this.portal.request(this.url??"").then(t=>{let e;return e=t&&t.groups?t.groups.map(n=>{const r=Wi.fromJSON(n);return r.portal=this.portal,r}):[],e})}async fetchItems(t){t??={};let e=this.userContentUrl??"";t.folder&&(e+="/"+t.folder.id);const{default:n}=await _e(()=>Promise.resolve().then(()=>gme),void 0),r={folders:!1,inRecycleBin:!!t.inRecycleBin||null,foldersContent:!(t.folder||!t.includeSubfolderItems)||null,num:t.num||10,start:t.start||1,sortField:t.sortField||"created",sortOrder:t.sortOrder||"asc"},i=await this.portal.request(e,{query:r});let s;return i?.items?(s=i.items.map(o=>{const a=n.fromJSON(o);return a.portal=this.portal,a}),await Promise.all(s.map(o=>o.load())),{items:s,nextStart:i.nextStart,total:i.total}):{items:[],nextStart:-1,total:0}}fetchTags(){return this.portal.request(this.url+"/tags").then(t=>t.tags)}getThumbnailUrl(t){let e=this.thumbnailUrl;return e&&t&&(e+=`&w=${t}`),e}queryFavorites(t){return this.favGroupId?(this._favGroup||(this._favGroup=new Wi({id:this.favGroupId,portal:this.portal})),this._favGroup.queryItems(t)):Promise.reject(new Xe("internal:unknown","Unknown internal error",{internalError:"Unknown favGroupId"}))}async restoreItem(t,e){const n=this.userContentUrl,r=e?{folderID:typeof e=="string"?e:e.id}:null;await this.portal.request(n+`/items/${t.id}/restore`,{method:"post",query:r})}toJSON(){throw new Xe("internal:not-yet-implemented","PortalUser.toJSON is not yet implemented")}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");const e=new _9({sourceJSON:t});return e.read(t),e}};x([E()],Fr.prototype,"access",void 0),x([E({type:Date})],Fr.prototype,"created",void 0),x([E()],Fr.prototype,"culture",void 0),x([E()],Fr.prototype,"description",void 0),x([E()],Fr.prototype,"email",void 0),x([E()],Fr.prototype,"favGroupId",void 0),x([E()],Fr.prototype,"fullName",void 0),x([E()],Fr.prototype,"id",void 0),x([E({type:Date})],Fr.prototype,"modified",void 0),x([E()],Fr.prototype,"orgId",void 0),x([E()],Fr.prototype,"portal",void 0),x([E()],Fr.prototype,"preferredView",void 0),x([E()],Fr.prototype,"privileges",void 0),x([E()],Fr.prototype,"region",void 0),x([E()],Fr.prototype,"role",void 0),x([E()],Fr.prototype,"roleId",void 0),x([E()],Fr.prototype,"sourceJSON",void 0),x([E()],Fr.prototype,"thumbnail",void 0),x([E({readOnly:!0})],Fr.prototype,"thumbnailUrl",null),x([E()],Fr.prototype,"units",void 0),x([E({readOnly:!0})],Fr.prototype,"userContentUrl",null),x([E({readOnly:!0})],Fr.prototype,"url",null),x([E()],Fr.prototype,"username",void 0),x([E()],Fr.prototype,"userLicenseTypeId",void 0),x([E()],Fr.prototype,"userType",void 0),Fr=_9=x([ue("esri.portal.PortalUser")],Fr);var Hl;let CE;const $ee={PortalGroup:()=>Promise.resolve({default:Wi}),PortalItem:()=>_e(()=>Promise.resolve().then(()=>gme),void 0),PortalUser:()=>Promise.resolve({default:Fr})};var fd;let it=(fd=class extends o0(xI){constructor(e){super(e),this._esriIdCredentialCreateHandle=null,this.access=null,this.allSSL=!1,this.authMode="auto",this.authorizedCrossOriginDomains=null,this.basemapGalleryGroupQuery=null,this.basemapGalleryGroupQuery3D=null,this.g3DTilesGalleryGroupQuery=null,this.g3dTilesEnabled=null,this.bingKey=null,this.canListApps=!1,this.canListData=!1,this.canListPreProvisionedItems=!1,this.canProvisionDirectPurchase=!1,this.canSearchPublic=!0,this.canShareBingPublic=!1,this.canSharePublic=!1,this.canSignInArcGIS=!1,this.canSignInIDP=!1,this.colorSetsGroupQuery=null,this.commentsEnabled=!1,this.created=null,this.culture=null,this.customBaseUrl=null,this.default3DBasemapQuery=null,this.defaultBasemap=null,this.defaultDevBasemap=null,this.defaultExtent=null,this.defaultVectorBasemap=null,this.description=null,this.devBasemapGalleryGroupQuery=null,this.eueiEnabled=null,this.featuredGroups=null,this.featuredItemsGroupQuery=null,this.galleryTemplatesGroupQuery=null,this.layoutGroupQuery=null,this.livingAtlasGroupQuery=null,this.hasCategorySchema=!1,this.hasClassificationSchema=!1,this.helperServices=null,this.homePageFeaturedContent=null,this.homePageFeaturedContentCount=null,this.httpPort=null,this.httpsPort=null,this.id=null,this.ipCntryCode=null,this.isPortal=!1,this.isReadOnly=!1,this.layerTemplatesGroupQuery=null,this.maxTokenExpirationMinutes=null,this.modified=null,this.name=null,this.portalHostname=null,this.portalMode=null,this.portalProperties=null,this.region=null,this.recycleBinEnabled=!1,this.rotatorPanels=null,this.showHomePageDescription=!1,this.sourceJSON=null,this.supportsHostedServices=!1,this.symbolSetsGroupQuery=null,this.templatesGroupQuery=null,this.units=null,this.url=nr.portalUrl,this.urlKey=null,this.user=null,this.use3dBasemaps=!0,this.useDefault3dBasemap=!1,this.useStandardizedQuery=!1,this.useVectorBasemaps=!1,this.vectorBasemapGalleryGroupQuery=null}normalizeCtorArgs(e){return typeof e=="string"?{url:e}:e}destroy(){Fee.unregister(this),this.defaultBasemap=Di(this.defaultBasemap),this.defaultDevBasemap=Di(this.defaultDevBasemap),this.defaultVectorBasemap=Di(this.defaultVectorBasemap),this._esriIdCredentialCreateHandle=ii(this._esriIdCredentialCreateHandle)}readAuthorizedCrossOriginDomains(e){if(e)for(const n of e)nr.request.trustedServers.includes(n)||nr.request.trustedServers.push(n);return e}readDefaultBasemap(e){return this._readBasemap(e)}readDefaultDevBasemap(e){return this._readBasemap(e)}readDefaultVectorBasemap(e){return this._readBasemap(e)}get extraQuery(){const e=this.user?.orgId,n=!e||this.canSearchPublic;return this.id&&!n?` AND orgid:${this.id}`:null}get hasAPIKey(){return pje(this.restUrl)}get isOrganization(){return!!this.access}get itemPageUrl(){return this.url?`${this.url}/home/item.html`:null}get loaded(){return super.loaded}get restUrl(){let e=this.url;if(e){const n=e.indexOf("/sharing");e=n>0?e.slice(0,n):this.url.replace(/\/+$/,""),e+="/sharing/rest"}return e}get thumbnailUrl(){const e=this.restUrl,n=this.thumbnail;return e&&n?this._normalizeSSL(e+"/portals/self/resources/"+n):null}readUrlKey(e){return e&&e.toLowerCase()}readUser(e){let n=null;return e&&(n=Fr.fromJSON(e),n.portal=this),n}load(e){const n=_e(async()=>{const{default:r}=await Promise.resolve().then(()=>ize);return{default:r}},void 0).then(({default:r})=>{pi(e),CE=r}).then(()=>this.sourceJSON?this.sourceJSON:this.fetchSelf(this.authMode,!1,e)).then(r=>{if(!this.hasAPIKey&&Zr){const i=Zr;this.credential=i.findCredential(this.restUrl),this.credential||this.authMode!==Hl.AUTH_MODE_AUTO&&this.authMode!==Hl.AUTH_MODE_NO_PROMPT||(this._esriIdCredentialCreateHandle?.remove(),this._esriIdCredentialCreateHandle=i.on("credential-create",l9e(new WeakRef(this))),Fee.register(this,this._esriIdCredentialCreateHandle,this))}this.sourceJSON=r,this.read(r)});return this.addResolvingPromise(n),Promise.resolve(this)}async createElevationLayers(){await this.load();const e=this._getHelperService("defaultElevationLayers"),n=(await _e(async()=>{const{default:r}=await import("./ElevationLayer-ld381kaw.js");return{default:r}},__vite__mapDeps([19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34]))).default;return e?e.map(r=>new n({id:r.id,url:r.url})):[]}async fetchBasemaps(e,n){const r=await this._fetchBasemaps(e,n);if(n?.include3d===!0&&this.use3dBasemaps!==!1){const i=await this._fetchBasemaps3D(e,n);r.unshift(...i)}return r}async fetchDefault3DBasemap(e){if(!this.useDefault3dBasemap||!this.default3DBasemapQuery||this.default3DBasemapQuery==="none")return null;const n=new us;n.query=this.default3DBasemapQuery,n.disableExtraQuery=!0;const r=(await this.queryItems(n,e)).results.find(i=>i.type==="Web Scene");return r?new CE({portalItem:r}):null}fetchCategorySchema(e){return this.hasCategorySchema?this.request(this.restUrl+"/portals/self/categorySchema",e).then(n=>n.categorySchema):ma(e)?Promise.reject(Pr()):Promise.resolve([])}async fetchClassificationSchema(e){return this.hasClassificationSchema?this.request(this.restUrl+"/portals/self/classification/classificationSchema",e).then(n=>n.classificationSchema):null}fetchFeaturedGroups(e){const n=this.featuredGroups,r=new us({num:100,sortField:"title"});if(n?.length){const i=[];for(const s of n)i.push(`(title:"${s.title}" AND owner:${s.owner})`);return r.query=i.join(" OR "),this.queryGroups(r,e).then(s=>s.results)}return ma(e)?Promise.reject(Pr()):Promise.resolve([])}fetchRegions(e){const n=this.user?.culture||this.culture||hu();return this.request(this.restUrl+"/portals/regions",{...e,query:{culture:n}})}fetchSettings(e){const n=this.user?.culture||this.culture||hu();return this.request(this.restUrl+"/portals/self/settings",{...e,query:{culture:n}})}static getDefault(){return o9e(()=>new Hl)}queryGroups(e,n){return this.queryPortal("/community/groups",e,"PortalGroup",n)}queryItems(e,n){return this.queryPortal("/search",e,"PortalItem",n)}queryUsers(e,n){return e.sortField||(e.sortField="username"),this.queryPortal("/community/users",e,"PortalUser",n)}fetchSelf(e=this.authMode,n=!1,r){const i=this.restUrl+"/portals/self",s={authMode:e,query:{culture:hu().toLowerCase()},withCredentials:!0,...r};return s.authMode==="auto"&&(s.authMode="no-prompt"),n&&(s.query.default=!0),this.request(i,s)}queryPortal(e,n,r,i){const s=Ha(us,n),o=a=>this.request(this.restUrl+e,{...s.toRequestOptions(this),...i}).then(l=>{const c=s.clone();return c.start=l.nextStart,new J0({nextQueryParams:c,queryParams:s,total:l.total,results:Hl._resultsToTypedArray(a,{portal:this},l,i)})}).then(l=>Promise.all(l.results.map(c=>typeof c.when=="function"?c.when():l)).then(()=>l,c=>(Nfe(c),l)));return r&&$ee[r]?$ee[r]().then(({default:a})=>(pi(i),o(a))):o()}signIn(){if(this.hasAPIKey)return this.load().then(()=>{if(!this.user)throw new Xe("portal:not-authenticated","Unable to authenticate user. Portal.user is missing")});if(this.authMode===Hl.AUTH_MODE_ANONYMOUS||this.authMode===Hl.AUTH_MODE_NO_PROMPT&&!Zr)return Promise.reject(new Xe("portal:invalid-auth-mode",`Current "authMode"' is "${this.authMode}"`));if(this.loadStatus==="failed")return Promise.reject(this.loadError);const e=n=>Promise.resolve().then(()=>this.loadStatus==="not-loaded"?(n||(this.authMode="immediate"),this.load().then(()=>null)):this.loadStatus==="loading"?this.load().then(()=>this.credential?null:(this.credential=n,this.fetchSelf("immediate"))):this.user&&this.credential===n?null:(this.credential=n,this.fetchSelf("immediate"))).then(r=>{r&&(this.sourceJSON=r,this.read(r))});return Zr?Zr.getCredential(this.restUrl,{prompt:this.authMode!==Hl.AUTH_MODE_NO_PROMPT}).then(n=>e(n)):e(this.credential)}normalizeUrl(e){const n=this.credential?.token;return this._normalizeSSL(n?e+(e.includes("?")?"&":"?")+"token="+n:e)}requestToTypedArray(e,n,r){return this.request(e,n).then(i=>{const s=Hl._resultsToTypedArray(r,{portal:this},i);return Promise.all(s.map(o=>typeof o.when=="function"?o.when():i)).then(()=>s,()=>s)})}request(e,n={}){const r={f:"json",...n.query},{authMode:i=this.authMode===Hl.AUTH_MODE_ANONYMOUS||this.authMode===Hl.AUTH_MODE_NO_PROMPT?this.authMode:"auto",body:s=null,cacheBust:o=!1,method:a="auto",responseType:l="json",signal:c}=n,u={authMode:i,body:s,cacheBust:o,method:a,query:r,responseType:l,timeout:0,signal:c};return n.withCredentials&&(u.withCredentials=!0),ns(this._normalizeSSL(e),u).then(h=>h.data)}toJSON(){throw new Xe("internal:not-yet-implemented","Portal.toJSON is not yet implemented")}static fromJSON(e){if(!e)return null;if(e.declaredClass)throw new Error("JSON object is already hydrated");return new Hl({sourceJSON:e})}_getHelperService(e){const n=this.helperServices?.[e];if(!n)throw new Xe("portal:service-not-found",`The \`helperServices\` do not include an entry named "${e}"`);return n}async _fetchBasemaps(e,n){const r=new us;r.query=e||(Y8()?this.devBasemapGalleryGroupQuery:this.useVectorBasemaps?this.vectorBasemapGalleryGroupQuery:this.basemapGalleryGroupQuery),r.disableExtraQuery=!0;const i=await this.queryGroups(r,n);if(!i.total)return[];const s=i.results[0];r.num=100,r.query='type:"Web Map" -type:"Web Application"',r.sortField=s.sortField||"name",r.sortOrder=s.sortOrder||"desc";const o=await s.queryItems(r,n);return o.total?o.results.filter(a=>a.type==="Web Map").map(a=>new CE({portalItem:a})):[]}async _fetchBasemaps3D(e,n){const r=e||this.basemapGalleryGroupQuery3D;if(!r)return[];if(Y8())return[];const i=new us({query:r,disableExtraQuery:!0}),s=await this.queryGroups(i,n);if(!s.total)return[];const o=s.results[0];i.num=100,i.query='type:"Web Scene"',i.sortField=o.sortField||"name",i.sortOrder=o.sortOrder||"desc";const a=await o.queryItems(i,n);return a.total?a.results.filter(l=>l.type==="Web Scene").map(l=>new CE({portalItem:l})):[]}_normalizeSSL(e){return e.replace(/^http:/i,"https:").replace(":7080",":7443")}_readBasemap(e){if(e){const n=CE.fromJSON(e);return n.portalItem={portal:this},n}return null}static _resultsToTypedArray(e,n,r,i){let s;if(r){const o=i!=null?i.signal:null;s=r.listings||r.notifications||r.userInvitations||r.tags||r.items||r.groups||r.comments||r.provisions||r.results||r.relatedItems||r,(e||n)&&(s=s.map(a=>{const l=Object.assign(e?e.fromJSON(a):a,n);return typeof l.load=="function"&&l.load(o),l}))}else s=[];return s}},Hl=fd,fd.AUTH_MODE_ANONYMOUS="anonymous",fd.AUTH_MODE_AUTO="auto",fd.AUTH_MODE_IMMEDIATE="immediate",fd.AUTH_MODE_NO_PROMPT="no-prompt",fd);x([E()],it.prototype,"access",void 0),x([E()],it.prototype,"allSSL",void 0),x([E()],it.prototype,"authMode",void 0),x([E()],it.prototype,"authorizedCrossOriginDomains",void 0),x([cr("authorizedCrossOriginDomains")],it.prototype,"readAuthorizedCrossOriginDomains",null),x([E()],it.prototype,"basemapGalleryGroupQuery",void 0),x([E({json:{name:"3DBasemapGalleryGroupQuery"}})],it.prototype,"basemapGalleryGroupQuery3D",void 0),x([E({json:{name:"g3DTilesGalleryGroupQuery"}})],it.prototype,"g3DTilesGalleryGroupQuery",void 0),x([E({json:{name:"g3dTilesEnabled"}})],it.prototype,"g3dTilesEnabled",void 0),x([E()],it.prototype,"bingKey",void 0),x([E()],it.prototype,"canListApps",void 0),x([E()],it.prototype,"canListData",void 0),x([E()],it.prototype,"canListPreProvisionedItems",void 0),x([E()],it.prototype,"canProvisionDirectPurchase",void 0),x([E()],it.prototype,"canSearchPublic",void 0),x([E()],it.prototype,"canShareBingPublic",void 0),x([E()],it.prototype,"canSharePublic",void 0),x([E()],it.prototype,"canSignInArcGIS",void 0),x([E()],it.prototype,"canSignInIDP",void 0),x([E()],it.prototype,"colorSetsGroupQuery",void 0),x([E()],it.prototype,"commentsEnabled",void 0),x([E({type:Date})],it.prototype,"created",void 0),x([E()],it.prototype,"credential",void 0),x([E()],it.prototype,"culture",void 0),x([E()],it.prototype,"currentVersion",void 0),x([E()],it.prototype,"customBaseUrl",void 0),x([E()],it.prototype,"default3DBasemapQuery",void 0),x([E()],it.prototype,"defaultBasemap",void 0),x([cr("defaultBasemap")],it.prototype,"readDefaultBasemap",null),x([E()],it.prototype,"defaultDevBasemap",void 0),x([cr("defaultDevBasemap")],it.prototype,"readDefaultDevBasemap",null),x([E({type:Vn})],it.prototype,"defaultExtent",void 0),x([E()],it.prototype,"defaultVectorBasemap",void 0),x([cr("defaultVectorBasemap")],it.prototype,"readDefaultVectorBasemap",null),x([E()],it.prototype,"description",void 0),x([E()],it.prototype,"devBasemapGalleryGroupQuery",void 0),x([E()],it.prototype,"eueiEnabled",void 0),x([E({readOnly:!0})],it.prototype,"extraQuery",null),x([E()],it.prototype,"featuredGroups",void 0),x([E()],it.prototype,"featuredItemsGroupQuery",void 0),x([E()],it.prototype,"galleryTemplatesGroupQuery",void 0),x([E()],it.prototype,"layoutGroupQuery",void 0),x([E()],it.prototype,"livingAtlasGroupQuery",void 0),x([E({readOnly:!0})],it.prototype,"hasAPIKey",null),x([E()],it.prototype,"hasCategorySchema",void 0),x([E()],it.prototype,"hasClassificationSchema",void 0),x([E()],it.prototype,"helpBase",void 0),x([E()],it.prototype,"helperServices",void 0),x([E()],it.prototype,"helpMap",void 0),x([E()],it.prototype,"homePageFeaturedContent",void 0),x([E()],it.prototype,"homePageFeaturedContentCount",void 0),x([E()],it.prototype,"httpPort",void 0),x([E()],it.prototype,"httpsPort",void 0),x([E()],it.prototype,"id",void 0),x([E()],it.prototype,"ipCntryCode",void 0),x([E({readOnly:!0})],it.prototype,"isOrganization",null),x([E()],it.prototype,"isPortal",void 0),x([E()],it.prototype,"isReadOnly",void 0),x([E({readOnly:!0})],it.prototype,"itemPageUrl",null),x([E()],it.prototype,"layerTemplatesGroupQuery",void 0),x([E()],it.prototype,"maxTokenExpirationMinutes",void 0),x([E({type:Date})],it.prototype,"modified",void 0),x([E()],it.prototype,"name",void 0),x([E()],it.prototype,"portalHostname",void 0),x([E()],it.prototype,"portalMode",void 0),x([E()],it.prototype,"portalProperties",void 0),x([E()],it.prototype,"region",void 0),x([E()],it.prototype,"recycleBinEnabled",void 0),x([E({readOnly:!0})],it.prototype,"restUrl",null),x([E()],it.prototype,"rotatorPanels",void 0),x([E()],it.prototype,"showHomePageDescription",void 0),x([E()],it.prototype,"sourceJSON",void 0),x([E()],it.prototype,"staticImagesUrl",void 0),x([E({json:{name:"2DStylesGroupQuery"}})],it.prototype,"stylesGroupQuery2d",void 0),x([E({json:{name:"stylesGroupQuery"}})],it.prototype,"stylesGroupQuery3d",void 0),x([E()],it.prototype,"supportsHostedServices",void 0),x([E()],it.prototype,"symbolSetsGroupQuery",void 0),x([E()],it.prototype,"templatesGroupQuery",void 0),x([E()],it.prototype,"thumbnail",void 0),x([E({readOnly:!0})],it.prototype,"thumbnailUrl",null),x([E()],it.prototype,"units",void 0),x([E()],it.prototype,"url",void 0),x([E()],it.prototype,"urlKey",void 0),x([cr("urlKey")],it.prototype,"readUrlKey",null),x([E()],it.prototype,"user",void 0),x([cr("user")],it.prototype,"readUser",null),x([E()],it.prototype,"use3dBasemaps",void 0),x([E()],it.prototype,"useDefault3dBasemap",void 0),x([E()],it.prototype,"useStandardizedQuery",void 0),x([E()],it.prototype,"useVectorBasemaps",void 0),x([E()],it.prototype,"vectorBasemapGalleryGroupQuery",void 0),it=Hl=x([ue("esri.portal.Portal")],it);const Fee=new FinalizationRegistry(t=>{t.remove()});function l9e(t){const e=Zr;return()=>{const n=t.deref();n&&e.findCredential(n.restUrl)&&n.signIn().catch(()=>{})}}let _f=class extends Kt{constructor(e){super(e),this.portalItem=null}normalizeCtorArgs(e){return e?.portalItem&&e.path?{...e,path:Vee(e.path,e.portalItem)}:e}set path(e){e!=null&&El(e)?kt.getLogger(this).error("portalitemresource:invalid-path","A portal item resource path must be relative"):this._set("path",e)}_castPath(e){return Vee(e,this.portalItem)}get url(){return this.portalItem&&this.path?`${this.portalItem.itemUrl}/resources/${this.path}`:null}get cdnUrl(){return this.portalItem&&this.path?`${this.portalItem.itemCdnUrl}/resources/${this.path}`:null}get itemRelativeUrl(){return this.portalItem&&this.path?`./resources/${this.path}`:null}fetch(e="json",n){const r=this.cdnUrl;if(r==null)throw new Xe("portal-item-resource:fetch","Portal item resource does not refer to a valid item or path");return this.portalItem.portal.request(r,{responseType:e,query:{token:this.portalItem.apiKey,_ts:n?.cacheBust?Date.now():null},signal:n?.signal})}async update(e,n){const{addOrUpdateResources:r}=await _e(()=>import("./resourceUtils-DhGNYAh7.js"),[]);return await r(this.portalItem,[{resource:this,content:e,compress:n?.compress,access:n?.access}],"update",n),this}hasPath(){return this.path!=null}};function Vee(t,e){return t==null?t:(t=t.replace(/^\/+/,""),e!=null&&El(t)&&(t=cB(t,e.itemUrl)),t?.replace(/^\/+/,"").replace(/^(\.\/)?resources\//,""))}x([E()],_f.prototype,"portalItem",void 0),x([E({type:String,value:null})],_f.prototype,"path",null),x([qs("path")],_f.prototype,"_castPath",null),x([E({type:String,readOnly:!0})],_f.prototype,"url",null),x([E({type:String,readOnly:!0})],_f.prototype,"cdnUrl",null),x([E({type:String,readOnly:!0})],_f.prototype,"itemRelativeUrl",null),_f=x([ue("esri.portal.PortalItemResource")],_f);let Fy=class extends Kt{constructor(e){super(e),this.created=null,this.rating=null}};x([E({type:Date})],Fy.prototype,"created",void 0),x([E()],Fy.prototype,"rating",void 0),Fy=x([ue("esri.portal.PortalRating")],Fy);var Q0;const c9e=new Set(["3DTiles Service","CSV","Feature Collection","Feature Service","Feed","GeoJson","Group Layer","Image Service","KML","Knowledge Graph Layer","Map Service","Media Layer","Scene Service","Stream Service","Video Service","Vector Tile Service","WCS","WFS","WMS","WMTS"]),u9e=new Set(["KML","GeoJson","CSV"]);let xn=Q0=class extends o0(xI){static from(t){return PO(Q0,t)}constructor(t){super(t),this.access=null,this.accessInformation=null,this.apiKey=null,this.applicationProxies=null,this.avgRating=null,this.categories=null,this.classification=null,this.created=null,this.culture=null,this.description=null,this.extent=null,this.groupCategories=null,this.id=null,this.isOrgItem=!1,this.itemControl=null,this.licenseInfo=null,this.modified=null,this.name=null,this.numComments=null,this.numRatings=null,this.numViews=null,this.owner=null,this.ownerFolder=null,this.portal=null,this.screenshots=null,this.size=null,this.snippet=null,this.sourceJSON=null,this.sourceUrl=null,this.spatialReference=null,this.tags=null,this.title=null,this.type=null,this.typeKeywords=null,this.url=null}destroy(){this.portal=null}get displayName(){const t=this.type,e=this.typeKeywords||[];let n=t;return t==="Feature Service"||t==="Feature Collection"?n=e.includes("Table")?"Table":e.includes("Route Layer")?"Route Layer":e.includes("Markup")?"Markup":"Feature Layer":t==="Image Service"?n=e.includes("Elevation 3D Layer")?"Elevation Layer":e.includes("Tiled Imagery")?"Tiled Imagery Layer":"Imagery Layer":t==="Scene Service"?n="Scene Layer":t==="Video Service"?n="Video Layer":t==="Scene Package"?n="Scene Layer Package":t==="Stream Service"?n="Feature Layer":t==="Geoprocessing Service"?n=e.includes("Web Tool")?"Tool":"Geoprocessing Service":t==="Geoenrichment Service"?n="GeoEnrichment Service":t==="Geocoding Service"?n="Locator":t==="Microsoft Powerpoint"?n="Microsoft PowerPoint":t==="GeoJson"?n="GeoJSON":t==="Globe Service"?n="Globe Layer":t==="Vector Tile Service"?n="Tile Layer":t==="netCDF"?n="NetCDF":t==="Map Service"?n=e.includes("Spatiotemporal")||!e.includes("Hosted Service")&&!e.includes("Tiled")||e.includes("Relational")?"Map Image Layer":"Tile Layer":t?.toLowerCase().includes("add in")?n=t.replaceAll(/(add in)/gi,"Add-In"):t==="datastore catalog service"?n="Big Data File Share":t==="Compact Tile Package"?n="Tile Package (tpkx)":t==="Raster function template"?n="Raster Function Template":t==="OGCFeatureServer"?n="OGC Feature Layer":t==="web mapping application"&&e.includes("configurableApp")?n="Instant App":t==="Insights Page"?n="Insights Report":t==="Excalibur Imagery Project"?n="Excalibur Project":t==="3DTiles Service"?n="3D tiles layer":t==="3DTiles Package"&&(n="3D tiles package"),n}readExtent(t){return t&&t.length?new Vn(t[0][0],t[0][1],t[1][0],t[1][1]):null}get iconUrl(){const t=this.type?.toLowerCase()||"",e=this.typeKeywords||[],n="esri/images/portal/",r="16";let i,s=!1,o=!1,a=!1,l=!1,c=!1,u=!1,h=!1,f=!1;return t.indexOf("service")>0||t==="feature collection"||t==="kml"||t==="wms"||t==="wmts"||t==="wfs"?(s=e.includes("Hosted Service"),t==="feature service"||t==="feature collection"||t==="kml"||t==="wfs"?(o=e.includes("Table"),a=e.includes("Route Layer"),l=e.includes("Markup"),c=e.includes("Spatiotemporal"),u=e.includes("UtilityNetwork"),i=c&&o?"spatiotemporaltable":o?"table":a?"routelayer":l?"markup":c?"spatiotemporal":u?"utilitynetwork":s?"featureshosted":"features"):t==="map service"||t==="wms"||t==="wmts"?(c=e.includes("Spatiotemporal"),h=e.includes("Relational"),i=c||h?"mapimages":s||e.includes("Tiled")||t==="wmts"?"maptiles":"mapimages"):i=t==="scene service"?e.includes("Line")?"sceneweblayerline":e.includes("3DObject")?"sceneweblayermultipatch":e.includes("Point")?"sceneweblayerpoint":e.includes("IntegratedMesh")?"sceneweblayermesh":e.includes("PointCloud")?"sceneweblayerpointcloud":e.includes("Polygon")?"sceneweblayerpolygon":e.includes("Building")?"sceneweblayerbuilding":e.includes("Voxel")?"sceneweblayervoxel":"sceneweblayer":t==="image service"?e.includes("Elevation 3D Layer")?"elevationlayer":e.includes("Tiled Imagery")?"tiledimagerylayer":"imagery":t==="stream service"?"streamlayer":t==="vector tile service"?"vectortile":t==="datastore catalog service"?"datastorecollection":t==="geocoding service"?"geocodeservice":t==="video service"?e.includes("Live Stream")?"livestreamvideolayer":"videolayer":t==="geoprocessing service"?e.includes("Web Tool")?"tool":"layers":t==="geodata service"?"geodataservice":t==="3dtiles service"?e.includes("3DObject")?"3dobjecttileslayer":e.includes("IntegratedMesh")?"integratedmeshtileslayer":e.includes("GaussianSplat")?"gaussiansplatlayer":"3dtileslayer":"layers"):t==="web map"||t==="cityengine web scene"?i="maps":t==="web scene"?i=e.includes("ViewingMode-Local")?"webscenelocal":"websceneglobal":t==="web mapping application"&&e.includes("configurableApp")?i="instantapps":t==="web mapping application"||t==="mobile application"||t==="application"||t==="operation view"||t==="desktop application"?i="apps":t==="map document"||t==="map package"||t==="published map"||t==="scene document"||t==="globe document"||t==="basemap package"||t==="mobile basemap package"||t==="mobile map package"||t==="project package"||t==="project template"||t==="pro map"||t==="layout"||t==="layer"&&e.includes("ArcGIS Pro")||t==="explorer map"&&e.indexOf("Explorer Document")?i="mapsgray":t==="service definition"||t==="shapefile"||t==="cad drawing"||t==="geojson"||t==="netcdf"||t==="administrative report"?i="datafiles":t==="360 vr experience"?i="360vr":t==="explorer add in"||t==="desktop add in"||t==="windows viewer add in"||t==="windows viewer configuration"?i="appsgray":t==="arcgis pro add in"||t==="arcgis pro configuration"?i="addindesktop":t==="pdf"?i="pdf":t==="microsoft word"?i="word":t==="microsoft excel"?i="excel":t==="microsoft powerpoint"?i="ppt":t==="rule package"||t==="file geodatabase"||t==="sqlite geodatabase"||t==="csv collection"||t==="kml collection"||t==="windows mobile package"||t==="map template"||t==="desktop application template"||t==="gml"||t==="arcpad package"||t==="code sample"||t==="document link"||t==="earth configuration"||t==="operations dashboard add in"||t==="rules package"||t==="workflow manager package"||t==="explorer map"&&e.includes("Explorer Mapping Application")||e.includes("Document")?i="datafilesgray":t==="network analysis service"||t==="geoprocessing service"||t==="geodata service"||t==="geometry service"||t==="geoprocessing package"||t==="locator package"||t==="geoprocessing sample"||t==="workflow manager service"?i="toolsgray":t==="layer"||t==="layer package"||t==="explorer layer"?i="layersgray":t==="analysis model"?i="analysismodel":t==="scene package"?i="scenepackage":t==="3dtiles package"?i="3dtileslayerpackage":t==="3dtiles service"?i="3dtileslayer":t==="mobile scene package"?i="mobilescenepackage":t==="tile package"||t==="compact tile package"?i="tilepackage":t==="task file"?i="taskfile":t==="report template"?i="report-template":t==="statistical data collection"?i="statisticaldatacollection":t==="insights workbook"?i="workbook":t==="insights model"?i="insightsmodel":t==="insights page"?i="insightspage":t==="insights theme"?i="insightstheme":t==="hub initiative"?i="hubinitiative":t==="hub page"?i="hubpage":t==="hub site application"?i="hubsite":t==="hub event"?i="hubevent":t==="hub project"?i="hubproject":t==="relational database connection"?i="relationaldatabaseconnection":t==="big data file share"?i="datastorecollection":t==="image collection"?i="imagecollection":t==="desktop style"?i="desktopstyle":t==="style"?i=e.includes("Dictionary")?"dictionarystyle":"style":t==="dashboard"?i="dashboard":t==="raster function template"?i="rasterprocessingtemplate":t==="vector tile package"?i="vectortilepackage":t==="ortho mapping project"?i="orthomappingproject":t==="ortho mapping template"?i="orthomappingtemplate":t==="solution"?i="solutions":t==="geopackage"?i="geopackage":t==="deep learning package"?i="deeplearningpackage":t==="real time analytic"?i="realtimeanalytics":t==="reality mapping project"?i="realitymappingproject":t==="big data analytic"?i="bigdataanalytics":t==="feed"?i="feed":t==="excalibur imagery project"?i="excaliburimageryproject":t==="notebook"?i="notebook":t==="storymap"?i="storymap":t==="survey123 add in"?i="survey123addin":t==="mission"?i="mission":t==="mission report"?i="missionreport":t==="mission template"?i="missiontemplate":t==="quickcapture project"?i="quickcaptureproject":t==="pro report"?i="proreport":t==="pro report template"?i="proreporttemplate":t==="urban model"?i="urbanmodel":t==="urban project"?i="urbanproject":t==="web experience"?i="experiencebuilder":t==="web experience template"?i="webexperiencetemplate":t==="experience builder widget"?i="experiencebuilderwidget":t==="experience builder widget package"?i="experiencebuilderwidgetpackage":t==="workflow"?i="workflow":t==="kernel gateway connection"?i="kernelgatewayconnection":t==="insights script"?i="insightsscript":t==="hub initiative template"?i="hubinitiativetemplate":t==="storymap theme"?i="storymaptheme":t==="knowledge graph"?i="knowledgegraph":t==="knowledge graph layer"?i="knowledgegraphlayer":t==="knowledge studio project"?i="knowledgestudio":t==="native application"?i="nativeapp":t==="native application installer"?i="nativeappinstaller":t==="web link chart"?i="linkchart":t==="knowledge graph web investigation"?i="investigation":t==="ogcfeatureserver"?i="features":t==="pro presentation"?i="propresentation":t==="pro project"?i="proproject":t==="insights workbook package"?i="insightsworkbookpackage":t==="apache parquet"?i="apacheparquet":t==="notebook code snippet library"?i="notebookcodesnippets":t==="suitability model"?i="suitabilitymodel":t==="esri classifier definition"?i="classifierdefinition":t==="esri classification schema"?i="classificationschema":t==="insights data engineering workbook"?i="dataengineeringworkbook":t==="insights data engineering model"?i="dataengineeringmodel":t==="deep learning studio project"?i="deeplearningproject":t==="discussion"?i="discussion":t==="allsource project"?i="allsourceproject":t==="api key"?i="apikey":t==="data pipeline"?i="datapipelines":t==="group layer"?(f=e.includes("Map"),i=f?"layergroup2d":"layergroup"):i=t==="media layer"?"onlinemedialayer":t==="form"?e.includes("Survey123")?"survey":"datafilesgray":t==="csv"?"csv":t==="image"?"image":t==="xr experience"?"xrexperience":"maps",i?Hi(n+i+r+".png"):null}get isLayer(){return this.type!=null&&c9e.has(this.type)}get itemCdnUrl(){return mB(this.itemUrl)}get itemPageUrl(){const t=this.portal?.itemPageUrl;return t&&this.id?`${t}?id=${this.id}`:null}get itemUrl(){const t=this.portal?.restUrl;return t&&this.id?`${t}/content/items/${this.id}`:null}get loaded(){return super.loaded}get thumbnailUrl(){const t=this.itemUrl,e=this.thumbnail;return t&&e?this.portal?.normalizeUrl(`${t}/info/${e}?f=json`)??null:null}get userItemUrl(){const t=this.portal?.restUrl;if(!t)return null;const e=this.owner||this.portal?.user?.id;return e?`${t}/content/users/${this.ownerFolder?`${e}/${this.ownerFolder}`:e}/items/${this.id}`:null}load(t){const e=this.portal??(this.portal=it.getDefault()),n=e.load(t).then(()=>this.sourceJSON?this.sourceJSON:this.id&&this.itemUrl?e.request(this.itemUrl,{signal:t!=null?t.signal:null,query:{token:this.apiKey}}):{}).then(r=>{this.sourceJSON=r,this.read(r)});return this.addResolvingPromise(n),Promise.resolve(this)}async addRating(t){const e={method:"post",query:{}},n=t instanceof Fy?t.rating:t;return n==null||isNaN(n)||typeof t!="number"||(e.query.rating=n),this.portal?(await this.portal.request(this.itemUrl+"/addRating",e),new Fy({rating:n,created:new Date})):null}clone(){const t={access:this.access,accessInformation:this.accessInformation,applicationProxies:Ze(this.applicationProxies),avgRating:this.avgRating,categories:Ze(this.categories),classification:Ze(this.classification),created:Ze(this.created),culture:this.culture,description:this.description,extent:Ze(this.extent),groupCategories:Ze(this.groupCategories),id:this.id,itemControl:this.itemControl,licenseInfo:this.licenseInfo,modified:Ze(this.modified),name:this.name,numComments:this.numComments,numRatings:this.numRatings,numViews:this.numViews,owner:this.owner,ownerFolder:this.ownerFolder,portal:this.portal,screenshots:Ze(this.screenshots),size:this.size,snippet:this.snippet,sourceUrl:this.sourceUrl,spatialReference:this.spatialReference,tags:Ze(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:Ze(this.typeKeywords),url:this.url};this.loaded&&(t.loadStatus="loaded");const e=new Q0({sourceJSON:this.sourceJSON}).set(t);return e._set("isOrgItem",this.isOrgItem),e}createPostQuery(){const t=this.toJSON();for(const e of["tags","typeKeywords","categories"])t[e]=t[e]?.join(", ");for(const e of["extent","classification"]){const n=t[e];n&&(t[e]=JSON.stringify(n))}return t}async deleteRating(){await this.portal.request(this.itemUrl+"/deleteRating",{method:"post"})}fetchData(t="json",e){return this.portal.request(this.itemUrl+"/data",{responseType:t,...e,query:{token:this.apiKey}})}async fetchRating(t){const e=await this.portal.request(this.itemUrl+"/rating",{query:{token:this.apiKey},...t});return e.rating!=null?(e.created=new Date(e.created),new Fy(e)):null}fetchRelatedItems(t,e){return this.portal.requestToTypedArray(this.itemUrl+"/relatedItems",{query:{...t,token:this.apiKey},...e},Q0)}getThumbnailUrl(t){let e=this.thumbnailUrl;return e&&t&&(e+=`&w=${t}`),e}reload(){return this.portal.request(this.itemUrl??"",{cacheBust:!0,query:{token:this.apiKey}}).then(t=>(this.applicationProxies&&!Object.hasOwn(t,"appProxies")&&(this.applicationProxies=null),this.sourceJSON=t,this.read(t),this))}update(t){return this.id?this.load().then(()=>this.portal.signIn()).then(()=>{const e=t?.data,n={method:"post"};n.query=this.createPostQuery();for(const r in n.query)n.query[r]===null&&(n.query[r]="");return n.query.clearEmptyFields=!0,e!=null&&(typeof e=="string"?n.query.text=e:typeof e=="object"&&(n.query.text=JSON.stringify(e))),this.portal.request(`${this.userItemUrl}/update`,n).then(()=>this.reload())}):Promise.reject(new Xe("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}async copy(t){if(!this.id)throw new Xe("portal:item-does-not-exist","The item does not exist yet");await this.load();const{portal:e,itemUrl:n}=this;await e.signIn();const{copyResources:r,folder:i,tags:s,title:o}=t||{},a={method:"post",query:{copyPrivateResources:r==="all",folder:typeof i=="string"?i:i?.id,includeResources:!!r,tags:s?.join(","),title:o}},{itemId:l}=await e.request(`${n}/copy`,a);return new Q0({id:l,portal:e})}updateThumbnail(t){return this.id?this.load().then(()=>this.portal.signIn()).then(()=>{const e=t.thumbnail,n=t.filename,r={method:"post"};if(typeof e=="string")dv(e)?r.query={data:e}:r.query={url:eu(e)},n!=null&&(r.query.filename=n);else{const i=new FormData;n!=null?i.append("file",e,n):i.append("file",e),r.body=i}return this.portal.request(`${this.userItemUrl}/updateThumbnail`,r).then(()=>this.reload())}):Promise.reject(new Xe("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}async fetchResources(t={},e){const{fetchResources:n}=await _e(()=>import("./resourceUtils-DhGNYAh7.js"),[]);return n(this,t,e)}async addResource(t,e,n){const{addOrUpdateResources:r}=await _e(()=>import("./resourceUtils-DhGNYAh7.js"),[]);return t.portalItem=this,await r(this,[{resource:t,content:e,compress:n?.compress,access:n?.access}],"add",n),t}async removeResource(t,e){const{removeResource:n}=await _e(()=>import("./resourceUtils-DhGNYAh7.js"),[]);if(t.portalItem&&t.portalItem.itemUrl!==this.itemUrl)throw new Xe("removeresource:portal-item-mismatch","The portal item associated with the provided resource does not match the item");return n(this,t,e)}async removeAllResources(t){const{removeAllResources:e}=await _e(()=>import("./resourceUtils-DhGNYAh7.js"),[]);return e(this,t)}resourceFromPath(t){return new _f({portalItem:this,path:t})}toJSON(){const t=this.extent,e={accessInformation:this.accessInformation,categories:Ze(this.categories),classification:Ze(this.classification),created:this.created?.getTime(),description:this.description,extent:t&&[[t.xmin,t.ymin],[t.xmax,t.ymax]],id:this.id,isOrgItem:this.isOrgItem,licenseInfo:this.licenseInfo,modified:this.modified?.getTime(),name:this.name,owner:this.owner,ownerFolder:this.ownerFolder,snippet:this.snippet,sourceUrl:this.sourceUrl,spatialReference:this.spatialReference,tags:Ze(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:Ze(this.typeKeywords),url:this.url};return u6e(e)}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");return new Q0({sourceJSON:t})}_getPostQuery(){const t=this.toJSON();for(const e in t)e==="tags"&&t[e]!==null&&(t[e]=t[e].join(", ")),e==="typeKeywords"&&t[e]!==null&&(t[e]=t[e].join(", ")),e==="extent"&&t[e]&&(t[e]=JSON.stringify(t[e]));return t}};x([E({type:["private","shared","org","public"]})],xn.prototype,"access",void 0),x([E()],xn.prototype,"accessInformation",void 0),x([E({type:String})],xn.prototype,"apiKey",void 0),x([E({json:{read:{source:"appProxies"}}})],xn.prototype,"applicationProxies",void 0),x([E()],xn.prototype,"avgRating",void 0),x([E()],xn.prototype,"categories",void 0),x([E()],xn.prototype,"classification",void 0),x([E({type:Date})],xn.prototype,"created",void 0),x([E()],xn.prototype,"culture",void 0),x([E()],xn.prototype,"description",void 0),x([E({readOnly:!0})],xn.prototype,"displayName",null),x([E({type:Vn})],xn.prototype,"extent",void 0),x([cr("extent")],xn.prototype,"readExtent",null),x([E()],xn.prototype,"groupCategories",void 0),x([E({readOnly:!0})],xn.prototype,"iconUrl",null),x([E()],xn.prototype,"id",void 0),x([E({readOnly:!0})],xn.prototype,"isLayer",null),x([E({type:Boolean,readOnly:!0})],xn.prototype,"isOrgItem",void 0),x([E()],xn.prototype,"itemControl",void 0),x([E({readOnly:!0})],xn.prototype,"itemPageUrl",null),x([E({readOnly:!0})],xn.prototype,"itemUrl",null),x([E()],xn.prototype,"licenseInfo",void 0),x([E({type:Date})],xn.prototype,"modified",void 0),x([E()],xn.prototype,"name",void 0),x([E()],xn.prototype,"numComments",void 0),x([E()],xn.prototype,"numRatings",void 0),x([E()],xn.prototype,"numViews",void 0),x([E()],xn.prototype,"owner",void 0),x([E()],xn.prototype,"ownerFolder",void 0),x([E({type:it})],xn.prototype,"portal",void 0),x([E()],xn.prototype,"screenshots",void 0),x([E()],xn.prototype,"size",void 0),x([E()],xn.prototype,"snippet",void 0),x([E()],xn.prototype,"sourceJSON",void 0),x([E({type:String})],xn.prototype,"sourceUrl",void 0),x([E({type:String})],xn.prototype,"spatialReference",void 0),x([E()],xn.prototype,"tags",void 0),x([E()],xn.prototype,"thumbnail",void 0),x([E({readOnly:!0})],xn.prototype,"thumbnailUrl",null),x([E()],xn.prototype,"title",void 0),x([E()],xn.prototype,"type",void 0),x([E()],xn.prototype,"typeKeywords",void 0),x([E({type:String,json:{read(t,e){if(u9e.has(e.type)){const n=this.portal?.restUrl;t||=n&&this.id?`${n}/content/items/${this.id}/data`:null}return t}}})],xn.prototype,"url",void 0),x([E({readOnly:!0})],xn.prototype,"userItemUrl",null),xn=Q0=x([ue("esri.portal.PortalItem")],xn);const gme=Object.freeze(Object.defineProperty({__proto__:null,get default(){return xn}},Symbol.toStringTag,{value:"Module"})),yme={ar:!0,bg:!0,bs:!0,ca:!0,cs:!0,da:!0,de:!0,el:!0,en:!0,es:!0,et:!0,fi:!0,fr:!0,he:!0,hr:!0,hu:!0,id:!0,it:!0,ja:!0,ko:!0,lt:!0,lv:!0,nb:"no",nl:!0,no:!0,nn:"no",pl:!0,pt:"pt-BR","pt-BR":!0,"pt-PT":!0,ro:!0,ru:!0,sk:!0,sl:!0,sr:!0,sv:!0,th:!0,tr:!0,uk:!0,vi:!0,zh:"zh-CN","zh-CN":!0,"zh-HK":!0,"zh-TW":!0};function h9e(t){return t in yme}function zee(t){if(h9e(t)){const e=yme[t];return e===!0?t:e}return null}const dS=[],iw=new Map;function Gee(t){for(const e of iw.keys())xme(t.pattern,e)&&iw.delete(e)}function d9e(t){return dS.includes(t)||(Gee(t),dS.unshift(t)),Zn(()=>{const e=dS.indexOf(t);e>-1&&(dS.splice(e,1),Gee(t))})}async function vme(t){const e=hu();iw.has(t)||iw.set(t,f9e(t,e));const n=iw.get(t);return n&&await p9e.add(n),n}function _me(t){const e=zB(t);return e?zee(t)??zee(e):null}async function f9e(t,e){const n=[];for(const r of dS)if(xme(r.pattern,t))try{return await r.fetchMessageBundle(t,e)}catch(i){n.push(i)}throw n.length?new Xe("intl:message-bundle-error",`Errors occurred while loading "${t}"`,{errors:n}):new Xe("intl:no-message-bundle-loader",`No loader found for message bundle "${t}"`)}function xme(t,e){return typeof t=="string"?e.startsWith(t):t.test(e)}GB(()=>{iw.clear()});const p9e=new class{constructor(){this._numLoading=0,this._dfd=null}async waitForAll(){this._dfd&&await this._dfd.promise}add(t){return this._increase(),t.then(()=>this._decrease(),()=>this._decrease()),this.waitForAll()}_increase(){this._numLoading++,this._dfd||(this._dfd=xc())}_decrease(){this._numLoading=Math.max(this._numLoading-1,0),this._dfd&&this._numLoading===0&&(this._dfd.resolve(),this._dfd=null)}};async function m9e(t){if(!t)return;const e=t.includes("-vector")?t.slice(0,t.indexOf("-vector")):t.includes("-3d")?t.slice(0,t.indexOf("-3d")):t,n=await vme("esri/t9n/basemaps");return n[t]||n[e]}const x9={satellite:{id:"satellite",classic:!0,get thumbnailUrl(){return Hi("esri/images/basemap/satellite.jpg")},baseMapLayers:[{id:"satellite-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1}]},hybrid:{id:"hybrid",classic:!0,get thumbnailUrl(){return Hi("esri/images/basemap/hybrid.jpg")},baseMapLayers:[{id:"hybrid-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1},{id:"hybrid-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/30d6b8271e1849cd9c3042060001f425/resources/styles/root.json",layerType:"VectorTileLayer",title:"Hybrid Reference Layer",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},terrain:{id:"terrain",classic:!0,get thumbnailUrl(){return Hi("esri/images/basemap/terrain.jpg")},baseMapLayers:[{id:"terrain-hillshade",url:"https://services.arcgisonline.com/ArcGIS/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1},{id:"terrain-base",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/33064a20de0c48d2bb61efa8faca93a8/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Terrain Base"},{id:"terrain-reference",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/14fbc125ccc9488888b014db09f35f67/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Reference Reference",isReference:!0}]},oceans:{id:"oceans",classic:!0,get thumbnailUrl(){return Hi("esri/images/basemap/oceans.jpg")},baseMapLayers:[{id:"oceans-base-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Base",showLegend:!1,visibility:!0,opacity:1},{id:"oceans-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/94329802cbfa44a18f423e6f1a0b875c/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Ocean Reference",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},osm:{id:"osm",classic:!0,get thumbnailUrl(){return Hi("esri/images/basemap/osm.jpg")},baseMapLayers:[{id:"osm-base-layer",layerType:"OpenStreetMap",title:"Open Street Map",showLegend:!1,visibility:!0,opacity:1}]},"dark-gray-vector":{id:"dark-gray-vector",classic:!0,get thumbnailUrl(){return Hi("esri/images/basemap/dark-gray-vector.jpg")},baseMapLayers:[{id:"dark-gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/5e9b3685f4c24d8781073dd928ebda50/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Base",visibility:!0,opacity:1},{id:"dark-gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/747cb7a5329c478cbe6981076cc879c5/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Reference",isReference:!0,visibility:!0,opacity:1}]},get"dark-gray"(){return{...this["dark-gray-vector"],id:"dark-gray"}},"gray-vector":{id:"gray-vector",classic:!0,get thumbnailUrl(){return Hi("esri/images/basemap/gray-vector.jpg")},baseMapLayers:[{id:"gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/291da5eab3a0412593b66d384379f89f/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Base",visibility:!0,opacity:1},{id:"gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/1768e8369a214dfab4e2167d5c5f2454/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Reference",isReference:!0,visibility:!0,opacity:1}]},get gray(){return{...this["gray-vector"],id:"gray"}},"streets-vector":{id:"streets-vector",classic:!0,get thumbnailUrl(){return Hi("esri/images/basemap/streets-vector.jpg")},baseMapLayers:[{id:"streets-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/de26a3cf4cc9451298ea173c4b324736/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets",visibility:!0,opacity:1}]},get streets(){return{...this["streets-vector"],id:"streets"}},"topo-vector":{id:"topo-vector",classic:!0,get thumbnailUrl(){return Hi("esri/images/basemap/topo-vector.jpg")},baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"topo-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/7dc6cea0b1764a1f9af2e679f642f0f5/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Topo",visibility:!0,opacity:1}]},get topo(){return{...this["topo-vector"],id:"topo"}},"streets-night-vector":{id:"streets-night-vector",classic:!0,get thumbnailUrl(){return Hi("esri/images/basemap/streets-night.jpg")},baseMapLayers:[{id:"streets-night-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/86f556a2d1fd468181855a35e344567f/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Night",visibility:!0,opacity:1}]},"streets-relief-vector":{id:"streets-relief-vector",classic:!0,get thumbnailUrl(){return Hi("esri/images/basemap/streets-relief.jpg")},baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"streets-relief-vector-base-layer",styleUrl:"//www.arcgis.com/sharing/rest/content/items/b266e6d17fc345b498345613930fbd76/resources/styles/root.json",title:"World Streets Relief",layerType:"VectorTileLayer",visibility:!0,opacity:1}]},"streets-navigation-vector":{id:"streets-navigation-vector",classic:!0,get thumbnailUrl(){return Hi("esri/images/basemap/streets-navigation.jpg")},baseMapLayers:[{id:"streets-navigation-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/63c47b7177f946b49902c24129b87252/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Navigation",visibility:!0,opacity:1}]},"topo-3d":{id:"topo-3d",is3d:!0,get thumbnailUrl(){return Hi("esri/images/basemap/topo-3d.png")},baseMapLayers:[{id:"topo-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/1e7d1784d1ef4b79ba6764d0bd6c3150/resources/styles/root.json",layerType:"VectorTileLayer",title:"Topographic",visibility:!0,opacity:1},{id:"topo-3d-trees",title:"Trees",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Open3D_Trees_v1/SceneServer",itemId:"9d3d89d42cfe4e2c9d108a2f0d518406",layerType:"ArcGISSceneServiceLayer"},{id:"topo-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"topo-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Esri3D_Buildings_v1/SceneServer",itemId:"b8fec5af7dfe4866b1b8ac2d2800f282",layerType:"ArcGISSceneServiceLayer"}]},"navigation-3d":{id:"navigation-3d",is3d:!0,get thumbnailUrl(){return Hi("esri/images/basemap/navigation-3d.jpg")},baseMapLayers:[{id:"navigation-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/ccc904ff872b4144b94934e55e32784b/resources/styles/root.json",layerType:"VectorTileLayer",title:"Navigation",visibility:!0,opacity:1},{id:"navigation-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"navigation-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Esri3D_Buildings_v1/SceneServer",itemId:"b8fec5af7dfe4866b1b8ac2d2800f282",layerType:"ArcGISSceneServiceLayer"}]},"streets-3d":{id:"streets-3d",is3d:!0,get thumbnailUrl(){return Hi("esri/images/basemap/streets-3d.png")},baseMapLayers:[{id:"streets-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/198298c4c64c4cb19de5b46aa00c198d/resources/styles/root.json",layerType:"VectorTileLayer",title:"Streets",visibility:!0,opacity:1},{id:"streets-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"streets-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Esri3D_Buildings_v1/SceneServer",itemId:"b8fec5af7dfe4866b1b8ac2d2800f282",layerType:"ArcGISSceneServiceLayer"}]},"osm-3d":{id:"osm-3d",is3d:!0,get thumbnailUrl(){return Hi("esri/images/basemap/osm-3d.png")},baseMapLayers:[{id:"osm-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/8628d259c9d14bdc848771c23c513940/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap",visibility:!0,opacity:1},{id:"osm-3d-trees",title:"Trees",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Open3D_Trees_v1/SceneServer",itemId:"9d3d89d42cfe4e2c9d108a2f0d518406",layerType:"ArcGISSceneServiceLayer"},{id:"osm-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"osm-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Open3D_Buildings_v1/SceneServer",itemId:"cd33b09dde0a419c986ca1a78a5fc06d",layerType:"ArcGISSceneServiceLayer"}]},"gray-3d":{id:"gray-3d",is3d:!0,get thumbnailUrl(){return Hi("esri/images/basemap/gray-3d.png")},baseMapLayers:[{id:"gray-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/01a14b466345455ba4176d2e6390db92/resources/styles/root.json",layerType:"VectorTileLayer",title:"Streets",visibility:!0,opacity:1},{id:"gray-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"gray-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Esri3D_Buildings_v1/SceneServer",itemId:"b8fec5af7dfe4866b1b8ac2d2800f282",layerType:"ArcGISSceneServiceLayer"}]},"navigation-dark-3d":{id:"navigation-dark-3d",itemId:"5a1365328b4943f09a54cf5fd1205707",is3d:!0,baseMapLayers:[{id:"navigation-dark-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/451a1777ab3f4bf095fae24a117439d9/resources/styles/root.json",layerType:"VectorTileLayer",title:"Navigation Dark"},{id:"navigation-dark-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer/layers/0",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"navigation-dark-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Esri3D_Buildings_v1/SceneServer",itemId:"b8fec5af7dfe4866b1b8ac2d2800f282",layerType:"ArcGISSceneServiceLayer"}]},"streets-dark-3d":{id:"streets-dark-3d",itemId:"8a4efa2c20484ec9b4557895e65736ff",is3d:!0,baseMapLayers:[{id:"streets-dark-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/bc599b6d741a4ac084b7eea7bf8c5938/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap Streets Night (for 3D)"},{id:"streets-dark-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"streets-dark-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Esri3D_Buildings_v1/SceneServer",itemId:"b8fec5af7dfe4866b1b8ac2d2800f282",layerType:"ArcGISSceneServiceLayer"}]},"dark-gray-3d":{id:"dark-gray-3d",itemId:"a8b7322a5fe94002bb0f5e0eeb0c5c18",is3d:!0,baseMapLayers:[{id:"dark-gray-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/4178f71acb934fb89f169e7d667c20c6/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap Dark Gray Canvas (for 3D)"},{id:"dark-gray-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer/layers/0",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"dark-gray-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Esri3D_Buildings_v1/SceneServer",itemId:"b8fec5af7dfe4866b1b8ac2d2800f282",layerType:"ArcGISSceneServiceLayer"}]}},jd="system",UB="unknown",Bk="UTC",g9e=Intl.DateTimeFormat().resolvedOptions().timeZone,Uee=new Map([["AUS Central Standard Time","Australia/Darwin"],["AUS Eastern Standard Time","Australia/Sydney"],["Afghanistan Standard Time","Asia/Kabul"],["Alaskan Standard Time","America/Anchorage"],["Aleutian Standard Time","America/Adak"],["Altai Standard Time","Asia/Barnaul"],["Arab Standard Time","Asia/Riyadh"],["Arabian Standard Time","Asia/Dubai"],["Arabic Standard Time","Asia/Baghdad"],["Argentina Standard Time","America/Buenos_Aires"],["Astrakhan Standard Time","Europe/Astrakhan"],["Atlantic Standard Time","America/Halifax"],["Aus Central W. Standard Time","Australia/Eucla"],["Azerbaijan Standard Time","Asia/Baku"],["Azores Standard Time","Atlantic/Azores"],["Bahia Standard Time","America/Bahia"],["Bangladesh Standard Time","Asia/Dhaka"],["Belarus Standard Time","Europe/Minsk"],["Bougainville Standard Time","Pacific/Bougainville"],["Canada Central Standard Time","America/Regina"],["Cape Verde Standard Time","Atlantic/Cape_Verde"],["Caucasus Standard Time","Asia/Yerevan"],["Cen. Australia Standard Time","Australia/Adelaide"],["Central America Standard Time","America/Guatemala"],["Central Asia Standard Time","Asia/Bishkek"],["Central Brazilian Standard Time","America/Cuiaba"],["Central Europe Standard Time","Europe/Budapest"],["Central European Standard Time","Europe/Warsaw"],["Central Pacific Standard Time","Pacific/Guadalcanal"],["Central Standard Time","America/Chicago"],["Central Standard Time (Mexico)","America/Mexico_City"],["Chatham Islands Standard Time","Pacific/Chatham"],["China Standard Time","Asia/Shanghai"],["Cuba Standard Time","America/Havana"],["Dateline Standard Time","Etc/GMT+12"],["E. Africa Standard Time","Africa/Nairobi"],["E. Australia Standard Time","Australia/Brisbane"],["E. Europe Standard Time","Europe/Chisinau"],["E. South America Standard Time","America/Sao_Paulo"],["Easter Island Standard Time","Pacific/Easter"],["Eastern Standard Time","America/New_York"],["Eastern Standard Time (Mexico)","America/Cancun"],["Egypt Standard Time","Africa/Cairo"],["Ekaterinburg Standard Time","Asia/Yekaterinburg"],["FLE Standard Time","Europe/Kiev"],["Fiji Standard Time","Pacific/Fiji"],["GMT Standard Time","Europe/London"],["GTB Standard Time","Europe/Bucharest"],["Georgian Standard Time","Asia/Tbilisi"],["Greenland Standard Time","America/Godthab"],["Greenwich Standard Time","Atlantic/Reykjavik"],["Haiti Standard Time","America/Port-au-Prince"],["Hawaiian Standard Time","Pacific/Honolulu"],["India Standard Time","Asia/Calcutta"],["Iran Standard Time","Asia/Tehran"],["Israel Standard Time","Asia/Jerusalem"],["Jordan Standard Time","Asia/Amman"],["Kaliningrad Standard Time","Europe/Kaliningrad"],["Korea Standard Time","Asia/Seoul"],["Libya Standard Time","Africa/Tripoli"],["Line Islands Standard Time","Pacific/Kiritimati"],["Lord Howe Standard Time","Australia/Lord_Howe"],["Magadan Standard Time","Asia/Magadan"],["Magallanes Standard Time","America/Punta_Arenas"],["Marquesas Standard Time","Pacific/Marquesas"],["Mauritius Standard Time","Indian/Mauritius"],["Middle East Standard Time","Asia/Beirut"],["Montevideo Standard Time","America/Montevideo"],["Morocco Standard Time","Africa/Casablanca"],["Mountain Standard Time","America/Denver"],["Mountain Standard Time (Mexico)","America/Mazatlan"],["Myanmar Standard Time","Asia/Rangoon"],["N. Central Asia Standard Time","Asia/Novosibirsk"],["Namibia Standard Time","Africa/Windhoek"],["Nepal Standard Time","Asia/Katmandu"],["New Zealand Standard Time","Pacific/Auckland"],["Newfoundland Standard Time","America/St_Johns"],["Norfolk Standard Time","Pacific/Norfolk"],["North Asia East Standard Time","Asia/Irkutsk"],["North Asia Standard Time","Asia/Krasnoyarsk"],["North Korea Standard Time","Asia/Pyongyang"],["Omsk Standard Time","Asia/Omsk"],["Pacific SA Standard Time","America/Santiago"],["Pacific Standard Time","America/Los_Angeles"],["Pacific Standard Time (Mexico)","America/Tijuana"],["Pakistan Standard Time","Asia/Karachi"],["Paraguay Standard Time","America/Asuncion"],["Qyzylorda Standard Time","Asia/Qyzylorda"],["Romance Standard Time","Europe/Paris"],["Russia Time Zone 10","Asia/Srednekolymsk"],["Russia Time Zone 11","Asia/Kamchatka"],["Russia Time Zone 3","Europe/Samara"],["Russian Standard Time","Europe/Moscow"],["SA Eastern Standard Time","America/Cayenne"],["SA Pacific Standard Time","America/Bogota"],["SA Western Standard Time","America/La_Paz"],["SE Asia Standard Time","Asia/Bangkok"],["Saint Pierre Standard Time","America/Miquelon"],["Sakhalin Standard Time","Asia/Sakhalin"],["Samoa Standard Time","Pacific/Apia"],["Sao Tome Standard Time","Africa/Sao_Tome"],["Saratov Standard Time","Europe/Saratov"],["Singapore Standard Time","Asia/Singapore"],["South Africa Standard Time","Africa/Johannesburg"],["South Sudan Standard Time","Africa/Juba"],["Sri Lanka Standard Time","Asia/Colombo"],["Sudan Standard Time","Africa/Khartoum"],["Syria Standard Time","Asia/Damascus"],["Taipei Standard Time","Asia/Taipei"],["Tasmania Standard Time","Australia/Hobart"],["Tocantins Standard Time","America/Araguaina"],["Tokyo Standard Time","Asia/Tokyo"],["Tomsk Standard Time","Asia/Tomsk"],["Tonga Standard Time","Pacific/Tongatapu"],["Transbaikal Standard Time","Asia/Chita"],["Turkey Standard Time","Europe/Istanbul"],["Turks And Caicos Standard Time","America/Grand_Turk"],["US Eastern Standard Time","America/Indianapolis"],["US Mountain Standard Time","America/Phoenix"],["UTC","Etc/GMT"],["UTC+01","Etc/GMT-1"],["UTC+02","Etc/GMT-2"],["UTC+03","Etc/GMT-3"],["UTC+04","Etc/GMT-4"],["UTC+05","Etc/GMT-5"],["UTC+06","Etc/GMT-6"],["UTC+07","Etc/GMT-7"],["UTC+08","Etc/GMT-8"],["UTC+09","Etc/GMT-9"],["UTC+10","Etc/GMT-10"],["UTC+11","Etc/GMT-11"],["UTC+12","Etc/GMT-12"],["UTC+13","Etc/GMT-13"],["UTC+14","Etc/GMT-14"],["UTC-01","Etc/GMT+1"],["UTC-02","Etc/GMT+2"],["UTC-03","Etc/GMT+3"],["UTC-04","Etc/GMT+4"],["UTC-05","Etc/GMT+5"],["UTC-06","Etc/GMT+6"],["UTC-07","Etc/GMT+7"],["UTC-08","Etc/GMT+8"],["UTC-09","Etc/GMT+9"],["UTC-10","Etc/GMT+10"],["UTC-11","Etc/GMT+11"],["UTC-12","Etc/GMT+12"],["Ulaanbaatar Standard Time","Asia/Ulaanbaatar"],["Venezuela Standard Time","America/Caracas"],["Vladivostok Standard Time","Asia/Vladivostok"],["Volgograd Standard Time","Europe/Volgograd"],["W. Australia Standard Time","Australia/Perth"],["W. Central Africa Standard Time","Africa/Lagos"],["W. Europe Standard Time","Europe/Berlin"],["W. Mongolia Standard Time","Asia/Hovd"],["West Asia Standard Time","Asia/Tashkent"],["West Bank Standard Time","Asia/Hebron"],["West Pacific Standard Time","Pacific/Port_Moresby"],["Yakutsk Standard Time","Asia/Yakutsk"],["Yukon Standard Time","America/Whitehorse"]]);class mv extends Error{}class y9e extends mv{constructor(e){super(`Invalid DateTime: ${e.toMessage()}`)}}class v9e extends mv{constructor(e){super(`Invalid Interval: ${e.toMessage()}`)}}class _9e extends mv{constructor(e){super(`Invalid Duration: ${e.toMessage()}`)}}class Tx extends mv{}class wme extends mv{constructor(e){super(`Invalid unit ${e}`)}}class na extends mv{}class fm extends mv{constructor(){super("Zone is an abstract class")}}const Rt="numeric",xh="short",mc="long",Q4={year:Rt,month:Rt,day:Rt},bme={year:Rt,month:xh,day:Rt},x9e={year:Rt,month:xh,day:Rt,weekday:xh},Eme={year:Rt,month:mc,day:Rt},Sme={year:Rt,month:mc,day:Rt,weekday:mc},Tme={hour:Rt,minute:Rt},kme={hour:Rt,minute:Rt,second:Rt},Ame={hour:Rt,minute:Rt,second:Rt,timeZoneName:xh},Ime={hour:Rt,minute:Rt,second:Rt,timeZoneName:mc},Pme={hour:Rt,minute:Rt,hourCycle:"h23"},Cme={hour:Rt,minute:Rt,second:Rt,hourCycle:"h23"},Rme={hour:Rt,minute:Rt,second:Rt,hourCycle:"h23",timeZoneName:xh},Mme={hour:Rt,minute:Rt,second:Rt,hourCycle:"h23",timeZoneName:mc},Nme={year:Rt,month:Rt,day:Rt,hour:Rt,minute:Rt},Ome={year:Rt,month:Rt,day:Rt,hour:Rt,minute:Rt,second:Rt},Lme={year:Rt,month:xh,day:Rt,hour:Rt,minute:Rt},Dme={year:Rt,month:xh,day:Rt,hour:Rt,minute:Rt,second:Rt},w9e={year:Rt,month:xh,day:Rt,weekday:xh,hour:Rt,minute:Rt},jme={year:Rt,month:mc,day:Rt,hour:Rt,minute:Rt,timeZoneName:xh},$me={year:Rt,month:mc,day:Rt,hour:Rt,minute:Rt,second:Rt,timeZoneName:xh},Fme={year:Rt,month:mc,day:Rt,weekday:mc,hour:Rt,minute:Rt,timeZoneName:mc},Vme={year:Rt,month:mc,day:Rt,weekday:mc,hour:Rt,minute:Rt,second:Rt,timeZoneName:mc};class bI{get type(){throw new fm}get name(){throw new fm}get ianaName(){return this.name}get isUniversal(){throw new fm}offsetName(e,n){throw new fm}formatOffset(e,n){throw new fm}offset(e){throw new fm}equals(e){throw new fm}get isValid(){throw new fm}}let Oj=null;class $O extends bI{static get instance(){return Oj===null&&(Oj=new $O),Oj}get type(){return"system"}get name(){return new Intl.DateTimeFormat().resolvedOptions().timeZone}get isUniversal(){return!1}offsetName(e,{format:n,locale:r}){return Zme(e,n,r)}formatOffset(e,n){return gT(this.offset(e),n)}offset(e){return-new Date(e).getTimezoneOffset()}equals(e){return e.type==="system"}get isValid(){return!0}}const w9=new Map;function b9e(t){let e=w9.get(t);return e===void 0&&(e=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:t,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",era:"short"}),w9.set(t,e)),e}const E9e={year:0,month:1,day:2,era:3,hour:4,minute:5,second:6};function S9e(t,e){const n=t.format(e).replace(/\u200E/g,""),r=/(\d+)\/(\d+)\/(\d+) (AD|BC),? (\d+):(\d+):(\d+)/.exec(n),[,i,s,o,a,l,c,u]=r;return[o,i,s,a,l,c,u]}function T9e(t,e){const n=t.formatToParts(e),r=[];for(let i=0;i<n.length;i++){const{type:s,value:o}=n[i],a=E9e[s];s==="era"?r[a]=o:kn(a)||(r[a]=parseInt(o,10))}return r}const Lj=new Map;class wh extends bI{static create(e){let n=Lj.get(e);return n===void 0&&Lj.set(e,n=new wh(e)),n}static resetCache(){Lj.clear(),w9.clear()}static isValidSpecifier(e){return this.isValidZone(e)}static isValidZone(e){if(!e)return!1;try{return new Intl.DateTimeFormat("en-US",{timeZone:e}).format(),!0}catch{return!1}}constructor(e){super(),this.zoneName=e,this.valid=wh.isValidZone(e)}get type(){return"iana"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(e,{format:n,locale:r}){return Zme(e,n,r,this.name)}formatOffset(e,n){return gT(this.offset(e),n)}offset(e){if(!this.valid)return NaN;const n=new Date(e);if(isNaN(n))return NaN;const r=b9e(this.name);let[i,s,o,a,l,c,u]=r.formatToParts?T9e(r,n):S9e(r,n);a==="BC"&&(i=-Math.abs(i)+1);const f=VO({year:i,month:s,day:o,hour:l===24?0:l,minute:c,second:u,millisecond:0});let g=+n;const y=g%1e3;return g-=y>=0?y:1e3+y,(f-g)/(60*1e3)}equals(e){return e.type==="iana"&&e.name===this.name}get isValid(){return this.valid}}let Bee={};function k9e(t,e={}){const n=JSON.stringify([t,e]);let r=Bee[n];return r||(r=new Intl.ListFormat(t,e),Bee[n]=r),r}const b9=new Map;function E9(t,e={}){const n=JSON.stringify([t,e]);let r=b9.get(n);return r===void 0&&(r=new Intl.DateTimeFormat(t,e),b9.set(n,r)),r}const S9=new Map;function A9e(t,e={}){const n=JSON.stringify([t,e]);let r=S9.get(n);return r===void 0&&(r=new Intl.NumberFormat(t,e),S9.set(n,r)),r}const T9=new Map;function I9e(t,e={}){const{base:n,...r}=e,i=JSON.stringify([t,r]);let s=T9.get(i);return s===void 0&&(s=new Intl.RelativeTimeFormat(t,e),T9.set(i,s)),s}let fS=null;function P9e(){return fS||(fS=new Intl.DateTimeFormat().resolvedOptions().locale,fS)}const k9=new Map;function zme(t){let e=k9.get(t);return e===void 0&&(e=new Intl.DateTimeFormat(t).resolvedOptions(),k9.set(t,e)),e}const A9=new Map;function C9e(t){let e=A9.get(t);if(!e){const n=new Intl.Locale(t);e="getWeekInfo"in n?n.getWeekInfo():n.weekInfo,"minimalDays"in e||(e={...Gme,...e}),A9.set(t,e)}return e}function R9e(t){const e=t.indexOf("-x-");e!==-1&&(t=t.substring(0,e));const n=t.indexOf("-u-");if(n===-1)return[t];{let r,i;try{r=E9(t).resolvedOptions(),i=t}catch{const l=t.substring(0,n);r=E9(l).resolvedOptions(),i=l}const{numberingSystem:s,calendar:o}=r;return[i,s,o]}}function M9e(t,e,n){return(n||e)&&(t.includes("-u-")||(t+="-u"),n&&(t+=`-ca-${n}`),e&&(t+=`-nu-${e}`)),t}function N9e(t){const e=[];for(let n=1;n<=12;n++){const r=dn.utc(2009,n,1);e.push(t(r))}return e}function O9e(t){const e=[];for(let n=1;n<=7;n++){const r=dn.utc(2016,11,13+n);e.push(t(r))}return e}function DC(t,e,n,r){const i=t.listingMode();return i==="error"?null:i==="en"?n(e):r(e)}function L9e(t){return t.numberingSystem&&t.numberingSystem!=="latn"?!1:t.numberingSystem==="latn"||!t.locale||t.locale.startsWith("en")||zme(t.locale).numberingSystem==="latn"}class D9e{constructor(e,n,r){this.padTo=r.padTo||0,this.floor=r.floor||!1;const{padTo:i,floor:s,...o}=r;if(!n||Object.keys(o).length>0){const a={useGrouping:!1,...r};r.padTo>0&&(a.minimumIntegerDigits=r.padTo),this.inf=A9e(e,a)}}format(e){if(this.inf){const n=this.floor?Math.floor(e):e;return this.inf.format(n)}else{const n=this.floor?Math.floor(e):KB(e,3);return Es(n,this.padTo)}}}class j9e{constructor(e,n,r){this.opts=r,this.originalZone=void 0;let i;if(this.opts.timeZone)this.dt=e;else if(e.zone.type==="fixed"){const o=-1*(e.offset/60),a=o>=0?`Etc/GMT+${o}`:`Etc/GMT${o}`;e.offset!==0&&wh.create(a).valid?(i=a,this.dt=e):(i="UTC",this.dt=e.offset===0?e:e.setZone("UTC").plus({minutes:e.offset}),this.originalZone=e.zone)}else e.zone.type==="system"?this.dt=e:e.zone.type==="iana"?(this.dt=e,i=e.zone.name):(i="UTC",this.dt=e.setZone("UTC").plus({minutes:e.offset}),this.originalZone=e.zone);const s={...this.opts};s.timeZone=s.timeZone||i,this.dtf=E9(n,s)}format(){return this.originalZone?this.formatToParts().map(({value:e})=>e).join(""):this.dtf.format(this.dt.toJSDate())}formatToParts(){const e=this.dtf.formatToParts(this.dt.toJSDate());return this.originalZone?e.map(n=>{if(n.type==="timeZoneName"){const r=this.originalZone.offsetName(this.dt.ts,{locale:this.dt.locale,format:this.opts.timeZoneName});return{...n,value:r}}else return n}):e}resolvedOptions(){return this.dtf.resolvedOptions()}}class $9e{constructor(e,n,r){this.opts={style:"long",...r},!n&&Yme()&&(this.rtf=I9e(e,r))}format(e,n){return this.rtf?this.rtf.format(e,n):o7e(n,e,this.opts.numeric,this.opts.style!=="long")}formatToParts(e,n){return this.rtf?this.rtf.formatToParts(e,n):[]}}const Gme={firstDay:1,minimalDays:4,weekend:[6,7]};class Lr{static fromOpts(e){return Lr.create(e.locale,e.numberingSystem,e.outputCalendar,e.weekSettings,e.defaultToEN)}static create(e,n,r,i,s=!1){const o=e||Yi.defaultLocale,a=o||(s?"en-US":P9e()),l=n||Yi.defaultNumberingSystem,c=r||Yi.defaultOutputCalendar,u=P9(i)||Yi.defaultWeekSettings;return new Lr(a,l,c,u,o)}static resetCache(){fS=null,b9.clear(),S9.clear(),T9.clear(),k9.clear(),A9.clear()}static fromObject({locale:e,numberingSystem:n,outputCalendar:r,weekSettings:i}={}){return Lr.create(e,n,r,i)}constructor(e,n,r,i,s){const[o,a,l]=R9e(e);this.locale=o,this.numberingSystem=n||a||null,this.outputCalendar=r||l||null,this.weekSettings=i,this.intl=M9e(this.locale,this.numberingSystem,this.outputCalendar),this.weekdaysCache={format:{},standalone:{}},this.monthsCache={format:{},standalone:{}},this.meridiemCache=null,this.eraCache={},this.specifiedLocale=s,this.fastNumbersCached=null}get fastNumbers(){return this.fastNumbersCached==null&&(this.fastNumbersCached=L9e(this)),this.fastNumbersCached}listingMode(){const e=this.isEnglish(),n=(this.numberingSystem===null||this.numberingSystem==="latn")&&(this.outputCalendar===null||this.outputCalendar==="gregory");return e&&n?"en":"intl"}clone(e){return!e||Object.getOwnPropertyNames(e).length===0?this:Lr.create(e.locale||this.specifiedLocale,e.numberingSystem||this.numberingSystem,e.outputCalendar||this.outputCalendar,P9(e.weekSettings)||this.weekSettings,e.defaultToEN||!1)}redefaultToEN(e={}){return this.clone({...e,defaultToEN:!0})}redefaultToSystem(e={}){return this.clone({...e,defaultToEN:!1})}months(e,n=!1){return DC(this,e,ege,()=>{const r=this.intl==="ja"||this.intl.startsWith("ja-");n&=!r;const i=n?{month:e,day:"numeric"}:{month:e},s=n?"format":"standalone";if(!this.monthsCache[s][e]){const o=r?a=>this.dtFormatter(a,i).format():a=>this.extract(a,i,"month");this.monthsCache[s][e]=N9e(o)}return this.monthsCache[s][e]})}weekdays(e,n=!1){return DC(this,e,rge,()=>{const r=n?{weekday:e,year:"numeric",month:"long",day:"numeric"}:{weekday:e},i=n?"format":"standalone";return this.weekdaysCache[i][e]||(this.weekdaysCache[i][e]=O9e(s=>this.extract(s,r,"weekday"))),this.weekdaysCache[i][e]})}meridiems(){return DC(this,void 0,()=>ige,()=>{if(!this.meridiemCache){const e={hour:"numeric",hourCycle:"h12"};this.meridiemCache=[dn.utc(2016,11,13,9),dn.utc(2016,11,13,19)].map(n=>this.extract(n,e,"dayperiod"))}return this.meridiemCache})}eras(e){return DC(this,e,sge,()=>{const n={era:e};return this.eraCache[e]||(this.eraCache[e]=[dn.utc(-40,1,1),dn.utc(2017,1,1)].map(r=>this.extract(r,n,"era"))),this.eraCache[e]})}extract(e,n,r){const i=this.dtFormatter(e,n),s=i.formatToParts(),o=s.find(a=>a.type.toLowerCase()===r);return o?o.value:null}numberFormatter(e={}){return new D9e(this.intl,e.forceSimple||this.fastNumbers,e)}dtFormatter(e,n={}){return new j9e(e,this.intl,n)}relFormatter(e={}){return new $9e(this.intl,this.isEnglish(),e)}listFormatter(e={}){return k9e(this.intl,e)}isEnglish(){return this.locale==="en"||this.locale.toLowerCase()==="en-us"||zme(this.intl).locale.startsWith("en-us")}getWeekSettings(){return this.weekSettings?this.weekSettings:Xme()?C9e(this.locale):Gme}getStartOfWeek(){return this.getWeekSettings().firstDay}getMinDaysInFirstWeek(){return this.getWeekSettings().minimalDays}getWeekendDays(){return this.getWeekSettings().weekend}equals(e){return this.locale===e.locale&&this.numberingSystem===e.numberingSystem&&this.outputCalendar===e.outputCalendar}toString(){return`Locale(${this.locale}, ${this.numberingSystem}, ${this.outputCalendar})`}}let Dj=null;class ha extends bI{static get utcInstance(){return Dj===null&&(Dj=new ha(0)),Dj}static instance(e){return e===0?ha.utcInstance:new ha(e)}static parseSpecifier(e){if(e){const n=e.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(n)return new ha(zO(n[1],n[2]))}return null}constructor(e){super(),this.fixed=e}get type(){return"fixed"}get name(){return this.fixed===0?"UTC":`UTC${gT(this.fixed,"narrow")}`}get ianaName(){return this.fixed===0?"Etc/UTC":`Etc/GMT${gT(-this.fixed,"narrow")}`}offsetName(){return this.name}formatOffset(e,n){return gT(this.fixed,n)}get isUniversal(){return!0}offset(){return this.fixed}equals(e){return e.type==="fixed"&&e.fixed===this.fixed}get isValid(){return!0}}class F9e extends bI{constructor(e){super(),this.zoneName=e}get type(){return"invalid"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(){return null}formatOffset(){return""}offset(){return NaN}equals(){return!1}get isValid(){return!1}}function Bm(t,e){if(kn(t)||t===null)return e;if(t instanceof bI)return t;if(W9e(t)){const n=t.toLowerCase();return n==="default"?e:n==="local"||n==="system"?$O.instance:n==="utc"||n==="gmt"?ha.utcInstance:ha.parseSpecifier(n)||wh.create(t)}else return bg(t)?ha.instance(t):typeof t=="object"&&"offset"in t&&typeof t.offset=="function"?t:new F9e(t)}const BB={arab:"[-]",arabext:"[-]",bali:"[-]",beng:"[-]",deva:"[-]",fullwide:"[-]",gujr:"[-]",hanidec:"[|||||||||]",khmr:"[-]",knda:"[-]",laoo:"[-]",limb:"[-]",mlym:"[-]",mong:"[-]",mymr:"[-]",orya:"[-]",tamldec:"[-]",telu:"[-]",thai:"[-]",tibt:"[-]",latn:"\\d"},Wee={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},V9e=BB.hanidec.replace(/[\[|\]]/g,"").split("");function z9e(t){let e=parseInt(t,10);if(isNaN(e)){e="";for(let n=0;n<t.length;n++){const r=t.charCodeAt(n);if(t[n].search(BB.hanidec)!==-1)e+=V9e.indexOf(t[n]);else for(const i in Wee){const[s,o]=Wee[i];r>=s&&r<=o&&(e+=r-s)}}return parseInt(e,10)}else return e}const I9=new Map;function G9e(){I9.clear()}function Du({numberingSystem:t},e=""){const n=t||"latn";let r=I9.get(n);r===void 0&&(r=new Map,I9.set(n,r));let i=r.get(e);return i===void 0&&(i=new RegExp(`${BB[n]}${e}`),r.set(e,i)),i}let Hee=()=>Date.now(),qee="system",Kee=null,Yee=null,Xee=null,Zee=60,Jee,Qee=null,Yi=class{static get now(){return Hee}static set now(e){Hee=e}static set defaultZone(e){qee=e}static get defaultZone(){return Bm(qee,$O.instance)}static get defaultLocale(){return Kee}static set defaultLocale(e){Kee=e}static get defaultNumberingSystem(){return Yee}static set defaultNumberingSystem(e){Yee=e}static get defaultOutputCalendar(){return Xee}static set defaultOutputCalendar(e){Xee=e}static get defaultWeekSettings(){return Qee}static set defaultWeekSettings(e){Qee=P9(e)}static get twoDigitCutoffYear(){return Zee}static set twoDigitCutoffYear(e){Zee=e%100}static get throwOnInvalid(){return Jee}static set throwOnInvalid(e){Jee=e}static resetCaches(){Lr.resetCache(),wh.resetCache(),dn.resetCache(),G9e()}};class lh{constructor(e,n){this.reason=e,this.explanation=n}toMessage(){return this.explanation?`${this.reason}: ${this.explanation}`:this.reason}}const Ume=[0,31,59,90,120,151,181,212,243,273,304,334],Bme=[0,31,60,91,121,152,182,213,244,274,305,335];function su(t,e){return new lh("unit out of range",`you specified ${e} (of type ${typeof e}) as a ${t}, which is invalid`)}function WB(t,e,n){const r=new Date(Date.UTC(t,e-1,n));t<100&&t>=0&&r.setUTCFullYear(r.getUTCFullYear()-1900);const i=r.getUTCDay();return i===0?7:i}function Wme(t,e,n){return n+(EI(t)?Bme:Ume)[e-1]}function Hme(t,e){const n=EI(t)?Bme:Ume,r=n.findIndex(s=>s<e),i=e-n[r];return{month:r+1,day:i}}function HB(t,e){return(t-e+7)%7+1}function eN(t,e=4,n=1){const{year:r,month:i,day:s}=t,o=Wme(r,i,s),a=HB(WB(r,i,s),n);let l=Math.floor((o-a+14-e)/7),c;return l<1?(c=r-1,l=Wk(c,e,n)):l>Wk(r,e,n)?(c=r+1,l=1):c=r,{weekYear:c,weekNumber:l,weekday:a,...GO(t)}}function ete(t,e=4,n=1){const{weekYear:r,weekNumber:i,weekday:s}=t,o=HB(WB(r,1,e),n),a=sw(r);let l=i*7+s-o-7+e,c;l<1?(c=r-1,l+=sw(c)):l>a?(c=r+1,l-=sw(r)):c=r;const{month:u,day:h}=Hme(c,l);return{year:c,month:u,day:h,...GO(t)}}function jj(t){const{year:e,month:n,day:r}=t,i=Wme(e,n,r);return{year:e,ordinal:i,...GO(t)}}function tte(t){const{year:e,ordinal:n}=t,{month:r,day:i}=Hme(e,n);return{year:e,month:r,day:i,...GO(t)}}function nte(t,e){if(!kn(t.localWeekday)||!kn(t.localWeekNumber)||!kn(t.localWeekYear)){if(!kn(t.weekday)||!kn(t.weekNumber)||!kn(t.weekYear))throw new Tx("Cannot mix locale-based week fields with ISO-based week fields");return kn(t.localWeekday)||(t.weekday=t.localWeekday),kn(t.localWeekNumber)||(t.weekNumber=t.localWeekNumber),kn(t.localWeekYear)||(t.weekYear=t.localWeekYear),delete t.localWeekday,delete t.localWeekNumber,delete t.localWeekYear,{minDaysInFirstWeek:e.getMinDaysInFirstWeek(),startOfWeek:e.getStartOfWeek()}}else return{minDaysInFirstWeek:4,startOfWeek:1}}function U9e(t,e=4,n=1){const r=FO(t.weekYear),i=ou(t.weekNumber,1,Wk(t.weekYear,e,n)),s=ou(t.weekday,1,7);return r?i?s?!1:su("weekday",t.weekday):su("week",t.weekNumber):su("weekYear",t.weekYear)}function B9e(t){const e=FO(t.year),n=ou(t.ordinal,1,sw(t.year));return e?n?!1:su("ordinal",t.ordinal):su("year",t.year)}function qme(t){const e=FO(t.year),n=ou(t.month,1,12),r=ou(t.day,1,tN(t.year,t.month));return e?n?r?!1:su("day",t.day):su("month",t.month):su("year",t.year)}function Kme(t){const{hour:e,minute:n,second:r,millisecond:i}=t,s=ou(e,0,23)||e===24&&n===0&&r===0&&i===0,o=ou(n,0,59),a=ou(r,0,59),l=ou(i,0,999);return s?o?a?l?!1:su("millisecond",i):su("second",r):su("minute",n):su("hour",e)}function kn(t){return typeof t>"u"}function bg(t){return typeof t=="number"}function FO(t){return typeof t=="number"&&t%1===0}function W9e(t){return typeof t=="string"}function H9e(t){return Object.prototype.toString.call(t)==="[object Date]"}function Yme(){try{return typeof Intl<"u"&&!!Intl.RelativeTimeFormat}catch{return!1}}function Xme(){try{return typeof Intl<"u"&&!!Intl.Locale&&("weekInfo"in Intl.Locale.prototype||"getWeekInfo"in Intl.Locale.prototype)}catch{return!1}}function q9e(t){return Array.isArray(t)?t:[t]}function rte(t,e,n){if(t.length!==0)return t.reduce((r,i)=>{const s=[e(i),i];return r&&n(r[0],s[0])===r[0]?r:s},null)[1]}function K9e(t,e){return e.reduce((n,r)=>(n[r]=t[r],n),{})}function S2(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function P9(t){if(t==null)return null;if(typeof t!="object")throw new na("Week settings must be an object");if(!ou(t.firstDay,1,7)||!ou(t.minimalDays,1,7)||!Array.isArray(t.weekend)||t.weekend.some(e=>!ou(e,1,7)))throw new na("Invalid week settings");return{firstDay:t.firstDay,minimalDays:t.minimalDays,weekend:Array.from(t.weekend)}}function ou(t,e,n){return FO(t)&&t>=e&&t<=n}function Y9e(t,e){return t-e*Math.floor(t/e)}function Es(t,e=2){const n=t<0;let r;return n?r="-"+(""+-t).padStart(e,"0"):r=(""+t).padStart(e,"0"),r}function Lm(t){if(!(kn(t)||t===null||t===""))return parseInt(t,10)}function D0(t){if(!(kn(t)||t===null||t===""))return parseFloat(t)}function qB(t){if(!(kn(t)||t===null||t==="")){const e=parseFloat("0."+t)*1e3;return Math.floor(e)}}function KB(t,e,n="round"){const r=10**e;switch(n){case"expand":return t>0?Math.ceil(t*r)/r:Math.floor(t*r)/r;case"trunc":return Math.trunc(t*r)/r;case"round":return Math.round(t*r)/r;case"floor":return Math.floor(t*r)/r;case"ceil":return Math.ceil(t*r)/r;default:throw new RangeError(`Value rounding ${n} is out of range`)}}function EI(t){return t%4===0&&(t%100!==0||t%400===0)}function sw(t){return EI(t)?366:365}function tN(t,e){const n=Y9e(e-1,12)+1,r=t+(e-n)/12;return n===2?EI(r)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][n-1]}function VO(t){let e=Date.UTC(t.year,t.month-1,t.day,t.hour,t.minute,t.second,t.millisecond);return t.year<100&&t.year>=0&&(e=new Date(e),e.setUTCFullYear(t.year,t.month-1,t.day)),+e}function ite(t,e,n){return-HB(WB(t,1,e),n)+e-1}function Wk(t,e=4,n=1){const r=ite(t,e,n),i=ite(t+1,e,n);return(sw(t)-r+i)/7}function C9(t){return t>99?t:t>Yi.twoDigitCutoffYear?1900+t:2e3+t}function Zme(t,e,n,r=null){const i=new Date(t),s={hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};r&&(s.timeZone=r);const o={timeZoneName:e,...s},a=new Intl.DateTimeFormat(n,o).formatToParts(i).find(l=>l.type.toLowerCase()==="timezonename");return a?a.value:null}function zO(t,e){let n=parseInt(t,10);Number.isNaN(n)&&(n=0);const r=parseInt(e,10)||0,i=n<0||Object.is(n,-0)?-r:r;return n*60+i}function Jme(t){const e=Number(t);if(typeof t=="boolean"||t===""||!Number.isFinite(e))throw new na(`Invalid unit value ${t}`);return e}function nN(t,e){const n={};for(const r in t)if(S2(t,r)){const i=t[r];if(i==null)continue;n[e(r)]=Jme(i)}return n}function gT(t,e){const n=Math.trunc(Math.abs(t/60)),r=Math.trunc(Math.abs(t%60)),i=t>=0?"+":"-";switch(e){case"short":return`${i}${Es(n,2)}:${Es(r,2)}`;case"narrow":return`${i}${n}${r>0?`:${r}`:""}`;case"techie":return`${i}${Es(n,2)}${Es(r,2)}`;default:throw new RangeError(`Value format ${e} is out of range for property format`)}}function GO(t){return K9e(t,["hour","minute","second","millisecond"])}const X9e=["January","February","March","April","May","June","July","August","September","October","November","December"],Qme=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],Z9e=["J","F","M","A","M","J","J","A","S","O","N","D"];function ege(t){switch(t){case"narrow":return[...Z9e];case"short":return[...Qme];case"long":return[...X9e];case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null}}const tge=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],nge=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],J9e=["M","T","W","T","F","S","S"];function rge(t){switch(t){case"narrow":return[...J9e];case"short":return[...nge];case"long":return[...tge];case"numeric":return["1","2","3","4","5","6","7"];default:return null}}const ige=["AM","PM"],Q9e=["Before Christ","Anno Domini"],e7e=["BC","AD"],t7e=["B","A"];function sge(t){switch(t){case"narrow":return[...t7e];case"short":return[...e7e];case"long":return[...Q9e];default:return null}}function n7e(t){return ige[t.hour<12?0:1]}function r7e(t,e){return rge(e)[t.weekday-1]}function i7e(t,e){return ege(e)[t.month-1]}function s7e(t,e){return sge(e)[t.year<0?0:1]}function o7e(t,e,n="always",r=!1){const i={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]},s=["hours","minutes","seconds"].indexOf(t)===-1;if(n==="auto"&&s){const h=t==="days";switch(e){case 1:return h?"tomorrow":`next ${i[t][0]}`;case-1:return h?"yesterday":`last ${i[t][0]}`;case 0:return h?"today":`this ${i[t][0]}`}}const o=Object.is(e,-0)||e<0,a=Math.abs(e),l=a===1,c=i[t],u=r?l?c[1]:c[2]||c[1]:l?i[t][0]:t;return o?`${a} ${u} ago`:`in ${a} ${u}`}function ste(t,e){let n="";for(const r of t)r.literal?n+=r.val:n+=e(r.val);return n}const a7e={D:Q4,DD:bme,DDD:Eme,DDDD:Sme,t:Tme,tt:kme,ttt:Ame,tttt:Ime,T:Pme,TT:Cme,TTT:Rme,TTTT:Mme,f:Nme,ff:Lme,fff:jme,ffff:Fme,F:Ome,FF:Dme,FFF:$me,FFFF:Vme};class ca{static create(e,n={}){return new ca(e,n)}static parseFormat(e){let n=null,r="",i=!1;const s=[];for(let o=0;o<e.length;o++){const a=e.charAt(o);a==="'"?((r.length>0||i)&&s.push({literal:i||/^\s+$/.test(r),val:r===""?"'":r}),n=null,r="",i=!i):i||a===n?r+=a:(r.length>0&&s.push({literal:/^\s+$/.test(r),val:r}),r=a,n=a)}return r.length>0&&s.push({literal:i||/^\s+$/.test(r),val:r}),s}static macroTokenToFormatOpts(e){return a7e[e]}constructor(e,n){this.opts=n,this.loc=e,this.systemLoc=null}formatWithSystemDefault(e,n){return this.systemLoc===null&&(this.systemLoc=this.loc.redefaultToSystem()),this.systemLoc.dtFormatter(e,{...this.opts,...n}).format()}dtFormatter(e,n={}){return this.loc.dtFormatter(e,{...this.opts,...n})}formatDateTime(e,n){return this.dtFormatter(e,n).format()}formatDateTimeParts(e,n){return this.dtFormatter(e,n).formatToParts()}formatInterval(e,n){return this.dtFormatter(e.start,n).dtf.formatRange(e.start.toJSDate(),e.end.toJSDate())}resolvedOptions(e,n){return this.dtFormatter(e,n).resolvedOptions()}num(e,n=0,r=void 0){if(this.opts.forceSimple)return Es(e,n);const i={...this.opts};return n>0&&(i.padTo=n),r&&(i.signDisplay=r),this.loc.numberFormatter(i).format(e)}formatDateTimeFromString(e,n){const r=this.loc.listingMode()==="en",i=this.loc.outputCalendar&&this.loc.outputCalendar!=="gregory",s=(g,y)=>this.loc.extract(e,g,y),o=g=>e.isOffsetFixed&&e.offset===0&&g.allowZ?"Z":e.isValid?e.zone.formatOffset(e.ts,g.format):"",a=()=>r?n7e(e):s({hour:"numeric",hourCycle:"h12"},"dayperiod"),l=(g,y)=>r?i7e(e,g):s(y?{month:g}:{month:g,day:"numeric"},"month"),c=(g,y)=>r?r7e(e,g):s(y?{weekday:g}:{weekday:g,month:"long",day:"numeric"},"weekday"),u=g=>{const y=ca.macroTokenToFormatOpts(g);return y?this.formatWithSystemDefault(e,y):g},h=g=>r?s7e(e,g):s({era:g},"era"),f=g=>{switch(g){case"S":return this.num(e.millisecond);case"u":case"SSS":return this.num(e.millisecond,3);case"s":return this.num(e.second);case"ss":return this.num(e.second,2);case"uu":return this.num(Math.floor(e.millisecond/10),2);case"uuu":return this.num(Math.floor(e.millisecond/100));case"m":return this.num(e.minute);case"mm":return this.num(e.minute,2);case"h":return this.num(e.hour%12===0?12:e.hour%12);case"hh":return this.num(e.hour%12===0?12:e.hour%12,2);case"H":return this.num(e.hour);case"HH":return this.num(e.hour,2);case"Z":return o({format:"narrow",allowZ:this.opts.allowZ});case"ZZ":return o({format:"short",allowZ:this.opts.allowZ});case"ZZZ":return o({format:"techie",allowZ:this.opts.allowZ});case"ZZZZ":return e.zone.offsetName(e.ts,{format:"short",locale:this.loc.locale});case"ZZZZZ":return e.zone.offsetName(e.ts,{format:"long",locale:this.loc.locale});case"z":return e.zoneName;case"a":return a();case"d":return i?s({day:"numeric"},"day"):this.num(e.day);case"dd":return i?s({day:"2-digit"},"day"):this.num(e.day,2);case"c":return this.num(e.weekday);case"ccc":return c("short",!0);case"cccc":return c("long",!0);case"ccccc":return c("narrow",!0);case"E":return this.num(e.weekday);case"EEE":return c("short",!1);case"EEEE":return c("long",!1);case"EEEEE":return c("narrow",!1);case"L":return i?s({month:"numeric",day:"numeric"},"month"):this.num(e.month);case"LL":return i?s({month:"2-digit",day:"numeric"},"month"):this.num(e.month,2);case"LLL":return l("short",!0);case"LLLL":return l("long",!0);case"LLLLL":return l("narrow",!0);case"M":return i?s({month:"numeric"},"month"):this.num(e.month);case"MM":return i?s({month:"2-digit"},"month"):this.num(e.month,2);case"MMM":return l("short",!1);case"MMMM":return l("long",!1);case"MMMMM":return l("narrow",!1);case"y":return i?s({year:"numeric"},"year"):this.num(e.year);case"yy":return i?s({year:"2-digit"},"year"):this.num(e.year.toString().slice(-2),2);case"yyyy":return i?s({year:"numeric"},"year"):this.num(e.year,4);case"yyyyyy":return i?s({year:"numeric"},"year"):this.num(e.year,6);case"G":return h("short");case"GG":return h("long");case"GGGGG":return h("narrow");case"kk":return this.num(e.weekYear.toString().slice(-2),2);case"kkkk":return this.num(e.weekYear,4);case"W":return this.num(e.weekNumber);case"WW":return this.num(e.weekNumber,2);case"n":return this.num(e.localWeekNumber);case"nn":return this.num(e.localWeekNumber,2);case"ii":return this.num(e.localWeekYear.toString().slice(-2),2);case"iiii":return this.num(e.localWeekYear,4);case"o":return this.num(e.ordinal);case"ooo":return this.num(e.ordinal,3);case"q":return this.num(e.quarter);case"qq":return this.num(e.quarter,2);case"X":return this.num(Math.floor(e.ts/1e3));case"x":return this.num(e.ts);default:return u(g)}};return ste(ca.parseFormat(n),f)}formatDurationFromString(e,n){const r=this.opts.signMode==="negativeLargestOnly"?-1:1,i=u=>{switch(u[0]){case"S":return"milliseconds";case"s":return"seconds";case"m":return"minutes";case"h":return"hours";case"d":return"days";case"w":return"weeks";case"M":return"months";case"y":return"years";default:return null}},s=(u,h)=>f=>{const g=i(f);if(g){const y=h.isNegativeDuration&&g!==h.largestUnit?r:1;let _;return this.opts.signMode==="negativeLargestOnly"&&g!==h.largestUnit?_="never":this.opts.signMode==="all"?_="always":_="auto",this.num(u.get(g)*y,f.length,_)}else return f},o=ca.parseFormat(n),a=o.reduce((u,{literal:h,val:f})=>h?u:u.concat(f),[]),l=e.shiftTo(...a.map(i).filter(u=>u)),c={isNegativeDuration:l<0,largestUnit:Object.keys(l.values)[0]};return ste(o,s(l,c))}}const oge=/[A-Za-z_+-]{1,256}(?::?\/[A-Za-z0-9_+-]{1,256}(?:\/[A-Za-z0-9_+-]{1,256})?)?/;function fb(...t){const e=t.reduce((n,r)=>n+r.source,"");return RegExp(`^${e}$`)}function pb(...t){return e=>t.reduce(([n,r,i],s)=>{const[o,a,l]=s(e,i);return[{...n,...o},a||r,l]},[{},null,1]).slice(0,2)}function mb(t,...e){if(t==null)return[null,null];for(const[n,r]of e){const i=n.exec(t);if(i)return r(i)}return[null,null]}function age(...t){return(e,n)=>{const r={};let i;for(i=0;i<t.length;i++)r[t[i]]=Lm(e[n+i]);return[r,null,n+i]}}const lge=/(?:([Zz])|([+-]\d\d)(?::?(\d\d))?)/,l7e=`(?:${lge.source}?(?:\\[(${oge.source})\\])?)?`,YB=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/,cge=RegExp(`${YB.source}${l7e}`),XB=RegExp(`(?:[Tt]${cge.source})?`),c7e=/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,u7e=/(\d{4})-?W(\d\d)(?:-?(\d))?/,h7e=/(\d{4})-?(\d{3})/,d7e=age("weekYear","weekNumber","weekDay"),f7e=age("year","ordinal"),p7e=/(\d{4})-(\d\d)-(\d\d)/,uge=RegExp(`${YB.source} ?(?:${lge.source}|(${oge.source}))?`),m7e=RegExp(`(?: ${uge.source})?`);function ow(t,e,n){const r=t[e];return kn(r)?n:Lm(r)}function g7e(t,e){return[{year:ow(t,e),month:ow(t,e+1,1),day:ow(t,e+2,1)},null,e+3]}function gb(t,e){return[{hours:ow(t,e,0),minutes:ow(t,e+1,0),seconds:ow(t,e+2,0),milliseconds:qB(t[e+3])},null,e+4]}function SI(t,e){const n=!t[e]&&!t[e+1],r=zO(t[e+1],t[e+2]),i=n?null:ha.instance(r);return[{},i,e+3]}function TI(t,e){const n=t[e]?wh.create(t[e]):null;return[{},n,e+1]}const y7e=RegExp(`^T?${YB.source}$`),v7e=/^-?P(?:(?:(-?\d{1,20}(?:\.\d{1,20})?)Y)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20}(?:\.\d{1,20})?)W)?(?:(-?\d{1,20}(?:\.\d{1,20})?)D)?(?:T(?:(-?\d{1,20}(?:\.\d{1,20})?)H)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,20}))?S)?)?)$/;function _7e(t){const[e,n,r,i,s,o,a,l,c]=t,u=e[0]==="-",h=l&&l[0]==="-",f=(g,y=!1)=>g!==void 0&&(y||g&&u)?-g:g;return[{years:f(D0(n)),months:f(D0(r)),weeks:f(D0(i)),days:f(D0(s)),hours:f(D0(o)),minutes:f(D0(a)),seconds:f(D0(l),l==="-0"),milliseconds:f(qB(c),h)}]}const x7e={GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function ZB(t,e,n,r,i,s,o){const a={year:e.length===2?C9(Lm(e)):Lm(e),month:Qme.indexOf(n)+1,day:Lm(r),hour:Lm(i),minute:Lm(s)};return o&&(a.second=Lm(o)),t&&(a.weekday=t.length>3?tge.indexOf(t)+1:nge.indexOf(t)+1),a}const w7e=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;function b7e(t){const[,e,n,r,i,s,o,a,l,c,u,h]=t,f=ZB(e,i,r,n,s,o,a);let g;return l?g=x7e[l]:c?g=0:g=zO(u,h),[f,new ha(g)]}function E7e(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}const S7e=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,T7e=/^(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,k7e=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;function ote(t){const[,e,n,r,i,s,o,a]=t;return[ZB(e,i,r,n,s,o,a),ha.utcInstance]}function A7e(t){const[,e,n,r,i,s,o,a]=t;return[ZB(e,a,n,r,i,s,o),ha.utcInstance]}const I7e=fb(c7e,XB),P7e=fb(u7e,XB),C7e=fb(h7e,XB),R7e=fb(cge),hge=pb(g7e,gb,SI,TI),M7e=pb(d7e,gb,SI,TI),N7e=pb(f7e,gb,SI,TI),O7e=pb(gb,SI,TI);function L7e(t){return mb(t,[I7e,hge],[P7e,M7e],[C7e,N7e],[R7e,O7e])}function D7e(t){return mb(E7e(t),[w7e,b7e])}function j7e(t){return mb(t,[S7e,ote],[T7e,ote],[k7e,A7e])}function $7e(t){return mb(t,[v7e,_7e])}const F7e=pb(gb);function V7e(t){return mb(t,[y7e,F7e])}const z7e=fb(p7e,m7e),G7e=fb(uge),U7e=pb(gb,SI,TI);function B7e(t){return mb(t,[z7e,hge],[G7e,U7e])}const ate="Invalid Duration",dge={weeks:{days:7,hours:168,minutes:10080,seconds:10080*60,milliseconds:10080*60*1e3},days:{hours:24,minutes:1440,seconds:1440*60,milliseconds:1440*60*1e3},hours:{minutes:60,seconds:3600,milliseconds:3600*1e3},minutes:{seconds:60,milliseconds:60*1e3},seconds:{milliseconds:1e3}},W7e={years:{quarters:4,months:12,weeks:52,days:365,hours:365*24,minutes:365*24*60,seconds:365*24*60*60,milliseconds:365*24*60*60*1e3},quarters:{months:3,weeks:13,days:91,hours:2184,minutes:2184*60,seconds:2184*60*60,milliseconds:2184*60*60*1e3},months:{weeks:4,days:30,hours:720,minutes:720*60,seconds:720*60*60,milliseconds:720*60*60*1e3},...dge},Lc=146097/400,x_=146097/4800,H7e={years:{quarters:4,months:12,weeks:Lc/7,days:Lc,hours:Lc*24,minutes:Lc*24*60,seconds:Lc*24*60*60,milliseconds:Lc*24*60*60*1e3},quarters:{months:3,weeks:Lc/28,days:Lc/4,hours:Lc*24/4,minutes:Lc*24*60/4,seconds:Lc*24*60*60/4,milliseconds:Lc*24*60*60*1e3/4},months:{weeks:x_/7,days:x_,hours:x_*24,minutes:x_*24*60,seconds:x_*24*60*60,milliseconds:x_*24*60*60*1e3},...dge},Vy=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"],q7e=Vy.slice(0).reverse();function uf(t,e,n=!1){const r={values:n?e.values:{...t.values,...e.values||{}},loc:t.loc.clone(e.loc),conversionAccuracy:e.conversionAccuracy||t.conversionAccuracy,matrix:e.matrix||t.matrix};return new mr(r)}function fge(t,e){let n=e.milliseconds??0;for(const r of q7e.slice(1))e[r]&&(n+=e[r]*t[r].milliseconds);return n}function lte(t,e){const n=fge(t,e)<0?-1:1;Vy.reduceRight((r,i)=>{if(kn(e[i]))return r;if(r){const s=e[r]*n,o=t[i][r],a=Math.floor(s/o);e[i]+=a*n,e[r]-=a*o*n}return i},null),Vy.reduce((r,i)=>{if(kn(e[i]))return r;if(r){const s=e[r]%1;e[r]-=s,e[i]+=s*t[r][i]}return i},null)}function cte(t){const e={};for(const[n,r]of Object.entries(t))r!==0&&(e[n]=r);return e}class mr{constructor(e){const n=e.conversionAccuracy==="longterm"||!1;let r=n?H7e:W7e;e.matrix&&(r=e.matrix),this.values=e.values,this.loc=e.loc||Lr.create(),this.conversionAccuracy=n?"longterm":"casual",this.invalid=e.invalid||null,this.matrix=r,this.isLuxonDuration=!0}static fromMillis(e,n){return mr.fromObject({milliseconds:e},n)}static fromObject(e,n={}){if(e==null||typeof e!="object")throw new na(`Duration.fromObject: argument expected to be an object, got ${e===null?"null":typeof e}`);return new mr({values:nN(e,mr.normalizeUnit),loc:Lr.fromObject(n),conversionAccuracy:n.conversionAccuracy,matrix:n.matrix})}static fromDurationLike(e){if(bg(e))return mr.fromMillis(e);if(mr.isDuration(e))return e;if(typeof e=="object")return mr.fromObject(e);throw new na(`Unknown duration argument ${e} of type ${typeof e}`)}static fromISO(e,n){const[r]=$7e(e);return r?mr.fromObject(r,n):mr.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static fromISOTime(e,n){const[r]=V7e(e);return r?mr.fromObject(r,n):mr.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static invalid(e,n=null){if(!e)throw new na("need to specify a reason the Duration is invalid");const r=e instanceof lh?e:new lh(e,n);if(Yi.throwOnInvalid)throw new _9e(r);return new mr({invalid:r})}static normalizeUnit(e){const n={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[e&&e.toLowerCase()];if(!n)throw new wme(e);return n}static isDuration(e){return e&&e.isLuxonDuration||!1}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}toFormat(e,n={}){const r={...n,floor:n.round!==!1&&n.floor!==!1};return this.isValid?ca.create(this.loc,r).formatDurationFromString(this,e):ate}toHuman(e={}){if(!this.isValid)return ate;const n=e.showZeros!==!1,r=Vy.map(i=>{const s=this.values[i];return kn(s)||s===0&&!n?null:this.loc.numberFormatter({style:"unit",unitDisplay:"long",...e,unit:i.slice(0,-1)}).format(s)}).filter(i=>i);return this.loc.listFormatter({type:"conjunction",style:e.listStyle||"narrow",...e}).format(r)}toObject(){return this.isValid?{...this.values}:{}}toISO(){if(!this.isValid)return null;let e="P";return this.years!==0&&(e+=this.years+"Y"),(this.months!==0||this.quarters!==0)&&(e+=this.months+this.quarters*3+"M"),this.weeks!==0&&(e+=this.weeks+"W"),this.days!==0&&(e+=this.days+"D"),(this.hours!==0||this.minutes!==0||this.seconds!==0||this.milliseconds!==0)&&(e+="T"),this.hours!==0&&(e+=this.hours+"H"),this.minutes!==0&&(e+=this.minutes+"M"),(this.seconds!==0||this.milliseconds!==0)&&(e+=KB(this.seconds+this.milliseconds/1e3,3)+"S"),e==="P"&&(e+="T0S"),e}toISOTime(e={}){if(!this.isValid)return null;const n=this.toMillis();return n<0||n>=864e5?null:(e={suppressMilliseconds:!1,suppressSeconds:!1,includePrefix:!1,format:"extended",...e,includeOffset:!1},dn.fromMillis(n,{zone:"UTC"}).toISOTime(e))}toJSON(){return this.toISO()}toString(){return this.toISO()}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Duration { values: ${JSON.stringify(this.values)} }`:`Duration { Invalid, reason: ${this.invalidReason} }`}toMillis(){return this.isValid?fge(this.matrix,this.values):NaN}valueOf(){return this.toMillis()}plus(e){if(!this.isValid)return this;const n=mr.fromDurationLike(e),r={};for(const i of Vy)(S2(n.values,i)||S2(this.values,i))&&(r[i]=n.get(i)+this.get(i));return uf(this,{values:r},!0)}minus(e){if(!this.isValid)return this;const n=mr.fromDurationLike(e);return this.plus(n.negate())}mapUnits(e){if(!this.isValid)return this;const n={};for(const r of Object.keys(this.values))n[r]=Jme(e(this.values[r],r));return uf(this,{values:n},!0)}get(e){return this[mr.normalizeUnit(e)]}set(e){if(!this.isValid)return this;const n={...this.values,...nN(e,mr.normalizeUnit)};return uf(this,{values:n})}reconfigure({locale:e,numberingSystem:n,conversionAccuracy:r,matrix:i}={}){const o={loc:this.loc.clone({locale:e,numberingSystem:n}),matrix:i,conversionAccuracy:r};return uf(this,o)}as(e){return this.isValid?this.shiftTo(e).get(e):NaN}normalize(){if(!this.isValid)return this;const e=this.toObject();return lte(this.matrix,e),uf(this,{values:e},!0)}rescale(){if(!this.isValid)return this;const e=cte(this.normalize().shiftToAll().toObject());return uf(this,{values:e},!0)}shiftTo(...e){if(!this.isValid)return this;if(e.length===0)return this;e=e.map(o=>mr.normalizeUnit(o));const n={},r={},i=this.toObject();let s;for(const o of Vy)if(e.indexOf(o)>=0){s=o;let a=0;for(const c in r)a+=this.matrix[c][o]*r[c],r[c]=0;bg(i[o])&&(a+=i[o]);const l=Math.trunc(a);n[o]=l,r[o]=(a*1e3-l*1e3)/1e3}else bg(i[o])&&(r[o]=i[o]);for(const o in r)r[o]!==0&&(n[s]+=o===s?r[o]:r[o]/this.matrix[s][o]);return lte(this.matrix,n),uf(this,{values:n},!0)}shiftToAll(){return this.isValid?this.shiftTo("years","months","weeks","days","hours","minutes","seconds","milliseconds"):this}negate(){if(!this.isValid)return this;const e={};for(const n of Object.keys(this.values))e[n]=this.values[n]===0?0:-this.values[n];return uf(this,{values:e},!0)}removeZeros(){if(!this.isValid)return this;const e=cte(this.values);return uf(this,{values:e},!0)}get years(){return this.isValid?this.values.years||0:NaN}get quarters(){return this.isValid?this.values.quarters||0:NaN}get months(){return this.isValid?this.values.months||0:NaN}get weeks(){return this.isValid?this.values.weeks||0:NaN}get days(){return this.isValid?this.values.days||0:NaN}get hours(){return this.isValid?this.values.hours||0:NaN}get minutes(){return this.isValid?this.values.minutes||0:NaN}get seconds(){return this.isValid?this.values.seconds||0:NaN}get milliseconds(){return this.isValid?this.values.milliseconds||0:NaN}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}equals(e){if(!this.isValid||!e.isValid||!this.loc.equals(e.loc))return!1;function n(r,i){return r===void 0||r===0?i===void 0||i===0:r===i}for(const r of Vy)if(!n(this.values[r],e.values[r]))return!1;return!0}}const w_="Invalid Interval";function K7e(t,e){return!t||!t.isValid?qi.invalid("missing or invalid start"):!e||!e.isValid?qi.invalid("missing or invalid end"):e<t?qi.invalid("end before start",`The end of an interval must be after its start, but you had start=${t.toISO()} and end=${e.toISO()}`):null}class qi{constructor(e){this.s=e.start,this.e=e.end,this.invalid=e.invalid||null,this.isLuxonInterval=!0}static invalid(e,n=null){if(!e)throw new na("need to specify a reason the Interval is invalid");const r=e instanceof lh?e:new lh(e,n);if(Yi.throwOnInvalid)throw new v9e(r);return new qi({invalid:r})}static fromDateTimes(e,n){const r=RE(e),i=RE(n),s=K7e(r,i);return s??new qi({start:r,end:i})}static after(e,n){const r=mr.fromDurationLike(n),i=RE(e);return qi.fromDateTimes(i,i.plus(r))}static before(e,n){const r=mr.fromDurationLike(n),i=RE(e);return qi.fromDateTimes(i.minus(r),i)}static fromISO(e,n){const[r,i]=(e||"").split("/",2);if(r&&i){let s,o;try{s=dn.fromISO(r,n),o=s.isValid}catch{o=!1}let a,l;try{a=dn.fromISO(i,n),l=a.isValid}catch{l=!1}if(o&&l)return qi.fromDateTimes(s,a);if(o){const c=mr.fromISO(i,n);if(c.isValid)return qi.after(s,c)}else if(l){const c=mr.fromISO(r,n);if(c.isValid)return qi.before(a,c)}}return qi.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static isInterval(e){return e&&e.isLuxonInterval||!1}get start(){return this.isValid?this.s:null}get end(){return this.isValid?this.e:null}get lastDateTime(){return this.isValid&&this.e?this.e.minus(1):null}get isValid(){return this.invalidReason===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}length(e="milliseconds"){return this.isValid?this.toDuration(e).get(e):NaN}count(e="milliseconds",n){if(!this.isValid)return NaN;const r=this.start.startOf(e,n);let i;return n?.useLocaleWeeks?i=this.end.reconfigure({locale:r.locale}):i=this.end,i=i.startOf(e,n),Math.floor(i.diff(r,e).get(e))+(i.valueOf()!==this.end.valueOf())}hasSame(e){return this.isValid?this.isEmpty()||this.e.minus(1).hasSame(this.s,e):!1}isEmpty(){return this.s.valueOf()===this.e.valueOf()}isAfter(e){return this.isValid?this.s>e:!1}isBefore(e){return this.isValid?this.e<=e:!1}contains(e){return this.isValid?this.s<=e&&this.e>e:!1}set({start:e,end:n}={}){return this.isValid?qi.fromDateTimes(e||this.s,n||this.e):this}splitAt(...e){if(!this.isValid)return[];const n=e.map(RE).filter(o=>this.contains(o)).sort((o,a)=>o.toMillis()-a.toMillis()),r=[];let{s:i}=this,s=0;for(;i<this.e;){const o=n[s]||this.e,a=+o>+this.e?this.e:o;r.push(qi.fromDateTimes(i,a)),i=a,s+=1}return r}splitBy(e){const n=mr.fromDurationLike(e);if(!this.isValid||!n.isValid||n.as("milliseconds")===0)return[];let{s:r}=this,i=1,s;const o=[];for(;r<this.e;){const a=this.start.plus(n.mapUnits(l=>l*i));s=+a>+this.e?this.e:a,o.push(qi.fromDateTimes(r,s)),r=s,i+=1}return o}divideEqually(e){return this.isValid?this.splitBy(this.length()/e).slice(0,e):[]}overlaps(e){return this.e>e.s&&this.s<e.e}abutsStart(e){return this.isValid?+this.e==+e.s:!1}abutsEnd(e){return this.isValid?+e.e==+this.s:!1}engulfs(e){return this.isValid?this.s<=e.s&&this.e>=e.e:!1}equals(e){return!this.isValid||!e.isValid?!1:this.s.equals(e.s)&&this.e.equals(e.e)}intersection(e){if(!this.isValid)return this;const n=this.s>e.s?this.s:e.s,r=this.e<e.e?this.e:e.e;return n>=r?null:qi.fromDateTimes(n,r)}union(e){if(!this.isValid)return this;const n=this.s<e.s?this.s:e.s,r=this.e>e.e?this.e:e.e;return qi.fromDateTimes(n,r)}static merge(e){const[n,r]=e.sort((i,s)=>i.s-s.s).reduce(([i,s],o)=>s?s.overlaps(o)||s.abutsStart(o)?[i,s.union(o)]:[i.concat([s]),o]:[i,o],[[],null]);return r&&n.push(r),n}static xor(e){let n=null,r=0;const i=[],s=e.map(l=>[{time:l.s,type:"s"},{time:l.e,type:"e"}]),o=Array.prototype.concat(...s),a=o.sort((l,c)=>l.time-c.time);for(const l of a)r+=l.type==="s"?1:-1,r===1?n=l.time:(n&&+n!=+l.time&&i.push(qi.fromDateTimes(n,l.time)),n=null);return qi.merge(i)}difference(...e){return qi.xor([this].concat(e)).map(n=>this.intersection(n)).filter(n=>n&&!n.isEmpty())}toString(){return this.isValid?`[${this.s.toISO()}  ${this.e.toISO()})`:w_}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Interval { start: ${this.s.toISO()}, end: ${this.e.toISO()} }`:`Interval { Invalid, reason: ${this.invalidReason} }`}toLocaleString(e=Q4,n={}){return this.isValid?ca.create(this.s.loc.clone(n),e).formatInterval(this):w_}toISO(e){return this.isValid?`${this.s.toISO(e)}/${this.e.toISO(e)}`:w_}toISODate(){return this.isValid?`${this.s.toISODate()}/${this.e.toISODate()}`:w_}toISOTime(e){return this.isValid?`${this.s.toISOTime(e)}/${this.e.toISOTime(e)}`:w_}toFormat(e,{separator:n="  "}={}){return this.isValid?`${this.s.toFormat(e)}${n}${this.e.toFormat(e)}`:w_}toDuration(e,n){return this.isValid?this.e.diff(this.s,e,n):mr.invalid(this.invalidReason)}mapEndpoints(e){return qi.fromDateTimes(e(this.s),e(this.e))}}let jC=class{static hasDST(e=Yi.defaultZone){const n=dn.now().setZone(e).set({month:12});return!e.isUniversal&&n.offset!==n.set({month:6}).offset}static isValidIANAZone(e){return wh.isValidZone(e)}static normalizeZone(e){return Bm(e,Yi.defaultZone)}static getStartOfWeek({locale:e=null,locObj:n=null}={}){return(n||Lr.create(e)).getStartOfWeek()}static getMinimumDaysInFirstWeek({locale:e=null,locObj:n=null}={}){return(n||Lr.create(e)).getMinDaysInFirstWeek()}static getWeekendWeekdays({locale:e=null,locObj:n=null}={}){return(n||Lr.create(e)).getWeekendDays().slice()}static months(e="long",{locale:n=null,numberingSystem:r=null,locObj:i=null,outputCalendar:s="gregory"}={}){return(i||Lr.create(n,r,s)).months(e)}static monthsFormat(e="long",{locale:n=null,numberingSystem:r=null,locObj:i=null,outputCalendar:s="gregory"}={}){return(i||Lr.create(n,r,s)).months(e,!0)}static weekdays(e="long",{locale:n=null,numberingSystem:r=null,locObj:i=null}={}){return(i||Lr.create(n,r,null)).weekdays(e)}static weekdaysFormat(e="long",{locale:n=null,numberingSystem:r=null,locObj:i=null}={}){return(i||Lr.create(n,r,null)).weekdays(e,!0)}static meridiems({locale:e=null}={}){return Lr.create(e).meridiems()}static eras(e="short",{locale:n=null}={}){return Lr.create(n,null,"gregory").eras(e)}static features(){return{relative:Yme(),localeWeek:Xme()}}};function ute(t,e){const n=i=>i.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf(),r=n(e)-n(t);return Math.floor(mr.fromMillis(r).as("days"))}function Y7e(t,e,n){const r=[["years",(l,c)=>c.year-l.year],["quarters",(l,c)=>c.quarter-l.quarter+(c.year-l.year)*4],["months",(l,c)=>c.month-l.month+(c.year-l.year)*12],["weeks",(l,c)=>{const u=ute(l,c);return(u-u%7)/7}],["days",ute]],i={},s=t;let o,a;for(const[l,c]of r)n.indexOf(l)>=0&&(o=l,i[l]=c(t,e),a=s.plus(i),a>e?(i[l]--,t=s.plus(i),t>e&&(a=t,i[l]--,t=s.plus(i))):t=a);return[t,i,a,o]}function X7e(t,e,n,r){let[i,s,o,a]=Y7e(t,e,n);const l=e-i,c=n.filter(h=>["hours","minutes","seconds","milliseconds"].indexOf(h)>=0);c.length===0&&(o<e&&(o=i.plus({[a]:1})),o!==i&&(s[a]=(s[a]||0)+l/(o-i)));const u=mr.fromObject(s,r);return c.length>0?mr.fromMillis(l,r).shiftTo(...c).plus(u):u}const Z7e="missing Intl.DateTimeFormat.formatToParts support";function Sr(t,e=n=>n){return{regex:t,deser:([n])=>e(z9e(n))}}const J7e="",pge=`[ ${J7e}]`,mge=new RegExp(pge,"g");function Q7e(t){return t.replace(/\./g,"\\.?").replace(mge,pge)}function hte(t){return t.replace(/\./g,"").replace(mge," ").toLowerCase()}function ju(t,e){return t===null?null:{regex:RegExp(t.map(Q7e).join("|")),deser:([n])=>t.findIndex(r=>hte(n)===hte(r))+e}}function dte(t,e){return{regex:t,deser:([,n,r])=>zO(n,r),groups:e}}function $C(t){return{regex:t,deser:([e])=>e}}function eVe(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function tVe(t,e){const n=Du(e),r=Du(e,"{2}"),i=Du(e,"{3}"),s=Du(e,"{4}"),o=Du(e,"{6}"),a=Du(e,"{1,2}"),l=Du(e,"{1,3}"),c=Du(e,"{1,6}"),u=Du(e,"{1,9}"),h=Du(e,"{2,4}"),f=Du(e,"{4,6}"),g=b=>({regex:RegExp(eVe(b.val)),deser:([T])=>T,literal:!0}),_=(b=>{if(t.literal)return g(b);switch(b.val){case"G":return ju(e.eras("short"),0);case"GG":return ju(e.eras("long"),0);case"y":return Sr(c);case"yy":return Sr(h,C9);case"yyyy":return Sr(s);case"yyyyy":return Sr(f);case"yyyyyy":return Sr(o);case"M":return Sr(a);case"MM":return Sr(r);case"MMM":return ju(e.months("short",!0),1);case"MMMM":return ju(e.months("long",!0),1);case"L":return Sr(a);case"LL":return Sr(r);case"LLL":return ju(e.months("short",!1),1);case"LLLL":return ju(e.months("long",!1),1);case"d":return Sr(a);case"dd":return Sr(r);case"o":return Sr(l);case"ooo":return Sr(i);case"HH":return Sr(r);case"H":return Sr(a);case"hh":return Sr(r);case"h":return Sr(a);case"mm":return Sr(r);case"m":return Sr(a);case"q":return Sr(a);case"qq":return Sr(r);case"s":return Sr(a);case"ss":return Sr(r);case"S":return Sr(l);case"SSS":return Sr(i);case"u":return $C(u);case"uu":return $C(a);case"uuu":return Sr(n);case"a":return ju(e.meridiems(),0);case"kkkk":return Sr(s);case"kk":return Sr(h,C9);case"W":return Sr(a);case"WW":return Sr(r);case"E":case"c":return Sr(n);case"EEE":return ju(e.weekdays("short",!1),1);case"EEEE":return ju(e.weekdays("long",!1),1);case"ccc":return ju(e.weekdays("short",!0),1);case"cccc":return ju(e.weekdays("long",!0),1);case"Z":case"ZZ":return dte(new RegExp(`([+-]${a.source})(?::(${r.source}))?`),2);case"ZZZ":return dte(new RegExp(`([+-]${a.source})(${r.source})?`),2);case"z":return $C(/[a-z_+-/]{1,256}?/i);case" ":return $C(/[^\S\n\r]/);default:return g(b)}})(t)||{invalidReason:Z7e};return _.token=t,_}const nVe={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",dayPeriod:"a",hour12:{numeric:"h","2-digit":"hh"},hour24:{numeric:"H","2-digit":"HH"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s","2-digit":"ss"},timeZoneName:{long:"ZZZZZ",short:"ZZZ"}};function rVe(t,e,n){const{type:r,value:i}=t;if(r==="literal"){const l=/^\s+$/.test(i);return{literal:!l,val:l?" ":i}}const s=e[r];let o=r;r==="hour"&&(e.hour12!=null?o=e.hour12?"hour12":"hour24":e.hourCycle!=null?e.hourCycle==="h11"||e.hourCycle==="h12"?o="hour12":o="hour24":o=n.hour12?"hour12":"hour24");let a=nVe[o];if(typeof a=="object"&&(a=a[s]),a)return{literal:!1,val:a}}function iVe(t){return[`^${t.map(n=>n.regex).reduce((n,r)=>`${n}(${r.source})`,"")}$`,t]}function sVe(t,e,n){const r=t.match(e);if(r){const i={};let s=1;for(const o in n)if(S2(n,o)){const a=n[o],l=a.groups?a.groups+1:1;!a.literal&&a.token&&(i[a.token.val[0]]=a.deser(r.slice(s,s+l))),s+=l}return[r,i]}else return[r,{}]}function oVe(t){const e=s=>{switch(s){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";case"q":return"quarter";default:return null}};let n=null,r;return kn(t.z)||(n=wh.create(t.z)),kn(t.Z)||(n||(n=new ha(t.Z)),r=t.Z),kn(t.q)||(t.M=(t.q-1)*3+1),kn(t.h)||(t.h<12&&t.a===1?t.h+=12:t.h===12&&t.a===0&&(t.h=0)),t.G===0&&t.y&&(t.y=-t.y),kn(t.u)||(t.S=qB(t.u)),[Object.keys(t).reduce((s,o)=>{const a=e(o);return a&&(s[a]=t[o]),s},{}),n,r]}let $j=null;function aVe(){return $j||($j=dn.fromMillis(1555555555555)),$j}function lVe(t,e){if(t.literal)return t;const n=ca.macroTokenToFormatOpts(t.val),r=_ge(n,e);return r==null||r.includes(void 0)?t:r}function gge(t,e){return Array.prototype.concat(...t.map(n=>lVe(n,e)))}class yge{constructor(e,n){if(this.locale=e,this.format=n,this.tokens=gge(ca.parseFormat(n),e),this.units=this.tokens.map(r=>tVe(r,e)),this.disqualifyingUnit=this.units.find(r=>r.invalidReason),!this.disqualifyingUnit){const[r,i]=iVe(this.units);this.regex=RegExp(r,"i"),this.handlers=i}}explainFromTokens(e){if(this.isValid){const[n,r]=sVe(e,this.regex,this.handlers),[i,s,o]=r?oVe(r):[null,null,void 0];if(S2(r,"a")&&S2(r,"H"))throw new Tx("Can't include meridiem when specifying 24-hour format");return{input:e,tokens:this.tokens,regex:this.regex,rawMatches:n,matches:r,result:i,zone:s,specificOffset:o}}else return{input:e,tokens:this.tokens,invalidReason:this.invalidReason}}get isValid(){return!this.disqualifyingUnit}get invalidReason(){return this.disqualifyingUnit?this.disqualifyingUnit.invalidReason:null}}function vge(t,e,n){return new yge(t,n).explainFromTokens(e)}function cVe(t,e,n){const{result:r,zone:i,specificOffset:s,invalidReason:o}=vge(t,e,n);return[r,i,s,o]}function _ge(t,e){if(!t)return null;const r=ca.create(e,t).dtFormatter(aVe()),i=r.formatToParts(),s=r.resolvedOptions();return i.map(o=>rVe(o,t,s))}const Fj="Invalid DateTime",fte=864e13;function pS(t){return new lh("unsupported zone",`the zone "${t.name}" is not supported`)}function Vj(t){return t.weekData===null&&(t.weekData=eN(t.c)),t.weekData}function zj(t){return t.localWeekData===null&&(t.localWeekData=eN(t.c,t.loc.getMinDaysInFirstWeek(),t.loc.getStartOfWeek())),t.localWeekData}function j0(t,e){const n={ts:t.ts,zone:t.zone,c:t.c,o:t.o,loc:t.loc,invalid:t.invalid};return new dn({...n,...e,old:n})}function xge(t,e,n){let r=t-e*60*1e3;const i=n.offset(r);if(e===i)return[r,e];r-=(i-e)*60*1e3;const s=n.offset(r);return i===s?[r,i]:[t-Math.min(i,s)*60*1e3,Math.max(i,s)]}function FC(t,e){t+=e*60*1e3;const n=new Date(t);return{year:n.getUTCFullYear(),month:n.getUTCMonth()+1,day:n.getUTCDate(),hour:n.getUTCHours(),minute:n.getUTCMinutes(),second:n.getUTCSeconds(),millisecond:n.getUTCMilliseconds()}}function TM(t,e,n){return xge(VO(t),e,n)}function pte(t,e){const n=t.o,r=t.c.year+Math.trunc(e.years),i=t.c.month+Math.trunc(e.months)+Math.trunc(e.quarters)*3,s={...t.c,year:r,month:i,day:Math.min(t.c.day,tN(r,i))+Math.trunc(e.days)+Math.trunc(e.weeks)*7},o=mr.fromObject({years:e.years-Math.trunc(e.years),quarters:e.quarters-Math.trunc(e.quarters),months:e.months-Math.trunc(e.months),weeks:e.weeks-Math.trunc(e.weeks),days:e.days-Math.trunc(e.days),hours:e.hours,minutes:e.minutes,seconds:e.seconds,milliseconds:e.milliseconds}).as("milliseconds"),a=VO(s);let[l,c]=xge(a,n,t.zone);return o!==0&&(l+=o,c=t.zone.offset(l)),{ts:l,o:c}}function b_(t,e,n,r,i,s){const{setZone:o,zone:a}=n;if(t&&Object.keys(t).length!==0||e){const l=e||a,c=dn.fromObject(t,{...n,zone:l,specificOffset:s});return o?c:c.setZone(a)}else return dn.invalid(new lh("unparsable",`the input "${i}" can't be parsed as ${r}`))}function VC(t,e,n=!0){return t.isValid?ca.create(Lr.create("en-US"),{allowZ:n,forceSimple:!0}).formatDateTimeFromString(t,e):null}function Gj(t,e,n){const r=t.c.year>9999||t.c.year<0;let i="";if(r&&t.c.year>=0&&(i+="+"),i+=Es(t.c.year,r?6:4),n==="year")return i;if(e){if(i+="-",i+=Es(t.c.month),n==="month")return i;i+="-"}else if(i+=Es(t.c.month),n==="month")return i;return i+=Es(t.c.day),i}function mte(t,e,n,r,i,s,o){let a=!n||t.c.millisecond!==0||t.c.second!==0,l="";switch(o){case"day":case"month":case"year":break;default:if(l+=Es(t.c.hour),o==="hour")break;if(e){if(l+=":",l+=Es(t.c.minute),o==="minute")break;a&&(l+=":",l+=Es(t.c.second))}else{if(l+=Es(t.c.minute),o==="minute")break;a&&(l+=Es(t.c.second))}if(o==="second")break;a&&(!r||t.c.millisecond!==0)&&(l+=".",l+=Es(t.c.millisecond,3))}return i&&(t.isOffsetFixed&&t.offset===0&&!s?l+="Z":t.o<0?(l+="-",l+=Es(Math.trunc(-t.o/60)),l+=":",l+=Es(Math.trunc(-t.o%60))):(l+="+",l+=Es(Math.trunc(t.o/60)),l+=":",l+=Es(Math.trunc(t.o%60)))),s&&(l+="["+t.zone.ianaName+"]"),l}const wge={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},uVe={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},hVe={ordinal:1,hour:0,minute:0,second:0,millisecond:0},kM=["year","month","day","hour","minute","second","millisecond"],dVe=["weekYear","weekNumber","weekday","hour","minute","second","millisecond"],fVe=["year","ordinal","hour","minute","second","millisecond"];function AM(t){const e={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[t.toLowerCase()];if(!e)throw new wme(t);return e}function gte(t){switch(t.toLowerCase()){case"localweekday":case"localweekdays":return"localWeekday";case"localweeknumber":case"localweeknumbers":return"localWeekNumber";case"localweekyear":case"localweekyears":return"localWeekYear";default:return AM(t)}}function pVe(t){if(mS===void 0&&(mS=Yi.now()),t.type!=="iana")return t.offset(mS);const e=t.name;let n=R9.get(e);return n===void 0&&(n=t.offset(mS),R9.set(e,n)),n}function yte(t,e){const n=Bm(e.zone,Yi.defaultZone);if(!n.isValid)return dn.invalid(pS(n));const r=Lr.fromObject(e);let i,s;if(kn(t.year))i=Yi.now();else{for(const l of kM)kn(t[l])&&(t[l]=wge[l]);const o=qme(t)||Kme(t);if(o)return dn.invalid(o);const a=pVe(n);[i,s]=TM(t,a,n)}return new dn({ts:i,zone:n,loc:r,o:s})}function vte(t,e,n){const r=kn(n.round)?!0:n.round,i=kn(n.rounding)?"trunc":n.rounding,s=(a,l)=>(a=KB(a,r||n.calendary?0:2,n.calendary?"round":i),e.loc.clone(n).relFormatter(n).format(a,l)),o=a=>n.calendary?e.hasSame(t,a)?0:e.startOf(a).diff(t.startOf(a),a).get(a):e.diff(t,a).get(a);if(n.unit)return s(o(n.unit),n.unit);for(const a of n.units){const l=o(a);if(Math.abs(l)>=1)return s(l,a)}return s(t>e?-0:0,n.units[n.units.length-1])}function _te(t){let e={},n;return t.length>0&&typeof t[t.length-1]=="object"?(e=t[t.length-1],n=Array.from(t).slice(0,t.length-1)):n=Array.from(t),[e,n]}let mS;const R9=new Map;class dn{constructor(e){const n=e.zone||Yi.defaultZone;let r=e.invalid||(Number.isNaN(e.ts)?new lh("invalid input"):null)||(n.isValid?null:pS(n));this.ts=kn(e.ts)?Yi.now():e.ts;let i=null,s=null;if(!r)if(e.old&&e.old.ts===this.ts&&e.old.zone.equals(n))[i,s]=[e.old.c,e.old.o];else{const a=bg(e.o)&&!e.old?e.o:n.offset(this.ts);i=FC(this.ts,a),r=Number.isNaN(i.year)?new lh("invalid input"):null,i=r?null:i,s=r?null:a}this._zone=n,this.loc=e.loc||Lr.create(),this.invalid=r,this.weekData=null,this.localWeekData=null,this.c=i,this.o=s,this.isLuxonDateTime=!0}static now(){return new dn({})}static local(){const[e,n]=_te(arguments),[r,i,s,o,a,l,c]=n;return yte({year:r,month:i,day:s,hour:o,minute:a,second:l,millisecond:c},e)}static utc(){const[e,n]=_te(arguments),[r,i,s,o,a,l,c]=n;return e.zone=ha.utcInstance,yte({year:r,month:i,day:s,hour:o,minute:a,second:l,millisecond:c},e)}static fromJSDate(e,n={}){const r=H9e(e)?e.valueOf():NaN;if(Number.isNaN(r))return dn.invalid("invalid input");const i=Bm(n.zone,Yi.defaultZone);return i.isValid?new dn({ts:r,zone:i,loc:Lr.fromObject(n)}):dn.invalid(pS(i))}static fromMillis(e,n={}){if(bg(e))return e<-fte||e>fte?dn.invalid("Timestamp out of range"):new dn({ts:e,zone:Bm(n.zone,Yi.defaultZone),loc:Lr.fromObject(n)});throw new na(`fromMillis requires a numerical input, but received a ${typeof e} with value ${e}`)}static fromSeconds(e,n={}){if(bg(e))return new dn({ts:e*1e3,zone:Bm(n.zone,Yi.defaultZone),loc:Lr.fromObject(n)});throw new na("fromSeconds requires a numerical input")}static fromObject(e,n={}){e=e||{};const r=Bm(n.zone,Yi.defaultZone);if(!r.isValid)return dn.invalid(pS(r));const i=Lr.fromObject(n),s=nN(e,gte),{minDaysInFirstWeek:o,startOfWeek:a}=nte(s,i),l=Yi.now(),c=kn(n.specificOffset)?r.offset(l):n.specificOffset,u=!kn(s.ordinal),h=!kn(s.year),f=!kn(s.month)||!kn(s.day),g=h||f,y=s.weekYear||s.weekNumber;if((g||u)&&y)throw new Tx("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(f&&u)throw new Tx("Can't mix ordinal dates with month/day");const _=y||s.weekday&&!g;let b,T,A=FC(l,c);_?(b=dVe,T=uVe,A=eN(A,o,a)):u?(b=fVe,T=hVe,A=jj(A)):(b=kM,T=wge);let I=!1;for(const j of b){const V=s[j];kn(V)?I?s[j]=T[j]:s[j]=A[j]:I=!0}const P=_?U9e(s,o,a):u?B9e(s):qme(s),R=P||Kme(s);if(R)return dn.invalid(R);const D=_?ete(s,o,a):u?tte(s):s,[C,M]=TM(D,c,r),O=new dn({ts:C,zone:r,o:M,loc:i});return s.weekday&&g&&e.weekday!==O.weekday?dn.invalid("mismatched weekday",`you can't specify both a weekday of ${s.weekday} and a date of ${O.toISO()}`):O.isValid?O:dn.invalid(O.invalid)}static fromISO(e,n={}){const[r,i]=L7e(e);return b_(r,i,n,"ISO 8601",e)}static fromRFC2822(e,n={}){const[r,i]=D7e(e);return b_(r,i,n,"RFC 2822",e)}static fromHTTP(e,n={}){const[r,i]=j7e(e);return b_(r,i,n,"HTTP",n)}static fromFormat(e,n,r={}){if(kn(e)||kn(n))throw new na("fromFormat requires an input string and a format");const{locale:i=null,numberingSystem:s=null}=r,o=Lr.fromOpts({locale:i,numberingSystem:s,defaultToEN:!0}),[a,l,c,u]=cVe(o,e,n);return u?dn.invalid(u):b_(a,l,r,`format ${n}`,e,c)}static fromString(e,n,r={}){return dn.fromFormat(e,n,r)}static fromSQL(e,n={}){const[r,i]=B7e(e);return b_(r,i,n,"SQL",e)}static invalid(e,n=null){if(!e)throw new na("need to specify a reason the DateTime is invalid");const r=e instanceof lh?e:new lh(e,n);if(Yi.throwOnInvalid)throw new y9e(r);return new dn({invalid:r})}static isDateTime(e){return e&&e.isLuxonDateTime||!1}static parseFormatForOpts(e,n={}){const r=_ge(e,Lr.fromObject(n));return r?r.map(i=>i?i.val:null).join(""):null}static expandFormat(e,n={}){return gge(ca.parseFormat(e),Lr.fromObject(n)).map(i=>i.val).join("")}static resetCache(){mS=void 0,R9.clear()}get(e){return this[e]}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}get outputCalendar(){return this.isValid?this.loc.outputCalendar:null}get zone(){return this._zone}get zoneName(){return this.isValid?this.zone.name:null}get year(){return this.isValid?this.c.year:NaN}get quarter(){return this.isValid?Math.ceil(this.c.month/3):NaN}get month(){return this.isValid?this.c.month:NaN}get day(){return this.isValid?this.c.day:NaN}get hour(){return this.isValid?this.c.hour:NaN}get minute(){return this.isValid?this.c.minute:NaN}get second(){return this.isValid?this.c.second:NaN}get millisecond(){return this.isValid?this.c.millisecond:NaN}get weekYear(){return this.isValid?Vj(this).weekYear:NaN}get weekNumber(){return this.isValid?Vj(this).weekNumber:NaN}get weekday(){return this.isValid?Vj(this).weekday:NaN}get isWeekend(){return this.isValid&&this.loc.getWeekendDays().includes(this.weekday)}get localWeekday(){return this.isValid?zj(this).weekday:NaN}get localWeekNumber(){return this.isValid?zj(this).weekNumber:NaN}get localWeekYear(){return this.isValid?zj(this).weekYear:NaN}get ordinal(){return this.isValid?jj(this.c).ordinal:NaN}get monthShort(){return this.isValid?jC.months("short",{locObj:this.loc})[this.month-1]:null}get monthLong(){return this.isValid?jC.months("long",{locObj:this.loc})[this.month-1]:null}get weekdayShort(){return this.isValid?jC.weekdays("short",{locObj:this.loc})[this.weekday-1]:null}get weekdayLong(){return this.isValid?jC.weekdays("long",{locObj:this.loc})[this.weekday-1]:null}get offset(){return this.isValid?+this.o:NaN}get offsetNameShort(){return this.isValid?this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}get offsetNameLong(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}get isOffsetFixed(){return this.isValid?this.zone.isUniversal:null}get isInDST(){return this.isOffsetFixed?!1:this.offset>this.set({month:1,day:1}).offset||this.offset>this.set({month:5}).offset}getPossibleOffsets(){if(!this.isValid||this.isOffsetFixed)return[this];const e=864e5,n=6e4,r=VO(this.c),i=this.zone.offset(r-e),s=this.zone.offset(r+e),o=this.zone.offset(r-i*n),a=this.zone.offset(r-s*n);if(o===a)return[this];const l=r-o*n,c=r-a*n,u=FC(l,o),h=FC(c,a);return u.hour===h.hour&&u.minute===h.minute&&u.second===h.second&&u.millisecond===h.millisecond?[j0(this,{ts:l}),j0(this,{ts:c})]:[this]}get isInLeapYear(){return EI(this.year)}get daysInMonth(){return tN(this.year,this.month)}get daysInYear(){return this.isValid?sw(this.year):NaN}get weeksInWeekYear(){return this.isValid?Wk(this.weekYear):NaN}get weeksInLocalWeekYear(){return this.isValid?Wk(this.localWeekYear,this.loc.getMinDaysInFirstWeek(),this.loc.getStartOfWeek()):NaN}resolvedLocaleOptions(e={}){const{locale:n,numberingSystem:r,calendar:i}=ca.create(this.loc.clone(e),e).resolvedOptions(this);return{locale:n,numberingSystem:r,outputCalendar:i}}toUTC(e=0,n={}){return this.setZone(ha.instance(e),n)}toLocal(){return this.setZone(Yi.defaultZone)}setZone(e,{keepLocalTime:n=!1,keepCalendarTime:r=!1}={}){if(e=Bm(e,Yi.defaultZone),e.equals(this.zone))return this;if(e.isValid){let i=this.ts;if(n||r){const s=e.offset(this.ts),o=this.toObject();[i]=TM(o,s,e)}return j0(this,{ts:i,zone:e})}else return dn.invalid(pS(e))}reconfigure({locale:e,numberingSystem:n,outputCalendar:r}={}){const i=this.loc.clone({locale:e,numberingSystem:n,outputCalendar:r});return j0(this,{loc:i})}setLocale(e){return this.reconfigure({locale:e})}set(e){if(!this.isValid)return this;const n=nN(e,gte),{minDaysInFirstWeek:r,startOfWeek:i}=nte(n,this.loc),s=!kn(n.weekYear)||!kn(n.weekNumber)||!kn(n.weekday),o=!kn(n.ordinal),a=!kn(n.year),l=!kn(n.month)||!kn(n.day),c=a||l,u=n.weekYear||n.weekNumber;if((c||o)&&u)throw new Tx("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(l&&o)throw new Tx("Can't mix ordinal dates with month/day");let h;s?h=ete({...eN(this.c,r,i),...n},r,i):kn(n.ordinal)?(h={...this.toObject(),...n},kn(n.day)&&(h.day=Math.min(tN(h.year,h.month),h.day))):h=tte({...jj(this.c),...n});const[f,g]=TM(h,this.o,this.zone);return j0(this,{ts:f,o:g})}plus(e){if(!this.isValid)return this;const n=mr.fromDurationLike(e);return j0(this,pte(this,n))}minus(e){if(!this.isValid)return this;const n=mr.fromDurationLike(e).negate();return j0(this,pte(this,n))}startOf(e,{useLocaleWeeks:n=!1}={}){if(!this.isValid)return this;const r={},i=mr.normalizeUnit(e);switch(i){case"years":r.month=1;case"quarters":case"months":r.day=1;case"weeks":case"days":r.hour=0;case"hours":r.minute=0;case"minutes":r.second=0;case"seconds":r.millisecond=0;break}if(i==="weeks")if(n){const s=this.loc.getStartOfWeek(),{weekday:o}=this;o<s&&(r.weekNumber=this.weekNumber-1),r.weekday=s}else r.weekday=1;if(i==="quarters"){const s=Math.ceil(this.month/3);r.month=(s-1)*3+1}return this.set(r)}endOf(e,n){return this.isValid?this.plus({[e]:1}).startOf(e,n).minus(1):this}toFormat(e,n={}){return this.isValid?ca.create(this.loc.redefaultToEN(n)).formatDateTimeFromString(this,e):Fj}toLocaleString(e=Q4,n={}){return this.isValid?ca.create(this.loc.clone(n),e).formatDateTime(this):Fj}toLocaleParts(e={}){return this.isValid?ca.create(this.loc.clone(e),e).formatDateTimeParts(this):[]}toISO({format:e="extended",suppressSeconds:n=!1,suppressMilliseconds:r=!1,includeOffset:i=!0,extendedZone:s=!1,precision:o="milliseconds"}={}){if(!this.isValid)return null;o=AM(o);const a=e==="extended";let l=Gj(this,a,o);return kM.indexOf(o)>=3&&(l+="T"),l+=mte(this,a,n,r,i,s,o),l}toISODate({format:e="extended",precision:n="day"}={}){return this.isValid?Gj(this,e==="extended",AM(n)):null}toISOWeekDate(){return VC(this,"kkkk-'W'WW-c")}toISOTime({suppressMilliseconds:e=!1,suppressSeconds:n=!1,includeOffset:r=!0,includePrefix:i=!1,extendedZone:s=!1,format:o="extended",precision:a="milliseconds"}={}){return this.isValid?(a=AM(a),(i&&kM.indexOf(a)>=3?"T":"")+mte(this,o==="extended",n,e,r,s,a)):null}toRFC2822(){return VC(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",!1)}toHTTP(){return VC(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")}toSQLDate(){return this.isValid?Gj(this,!0):null}toSQLTime({includeOffset:e=!0,includeZone:n=!1,includeOffsetSpace:r=!0}={}){let i="HH:mm:ss.SSS";return(n||e)&&(r&&(i+=" "),n?i+="z":e&&(i+="ZZ")),VC(this,i,!0)}toSQL(e={}){return this.isValid?`${this.toSQLDate()} ${this.toSQLTime(e)}`:null}toString(){return this.isValid?this.toISO():Fj}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`DateTime { ts: ${this.toISO()}, zone: ${this.zone.name}, locale: ${this.locale} }`:`DateTime { Invalid, reason: ${this.invalidReason} }`}valueOf(){return this.toMillis()}toMillis(){return this.isValid?this.ts:NaN}toSeconds(){return this.isValid?this.ts/1e3:NaN}toUnixInteger(){return this.isValid?Math.floor(this.ts/1e3):NaN}toJSON(){return this.toISO()}toBSON(){return this.toJSDate()}toObject(e={}){if(!this.isValid)return{};const n={...this.c};return e.includeConfig&&(n.outputCalendar=this.outputCalendar,n.numberingSystem=this.loc.numberingSystem,n.locale=this.loc.locale),n}toJSDate(){return new Date(this.isValid?this.ts:NaN)}diff(e,n="milliseconds",r={}){if(!this.isValid||!e.isValid)return mr.invalid("created by diffing an invalid DateTime");const i={locale:this.locale,numberingSystem:this.numberingSystem,...r},s=q9e(n).map(mr.normalizeUnit),o=e.valueOf()>this.valueOf(),a=o?this:e,l=o?e:this,c=X7e(a,l,s,i);return o?c.negate():c}diffNow(e="milliseconds",n={}){return this.diff(dn.now(),e,n)}until(e){return this.isValid?qi.fromDateTimes(this,e):this}hasSame(e,n,r){if(!this.isValid)return!1;const i=e.valueOf(),s=this.setZone(e.zone,{keepLocalTime:!0});return s.startOf(n,r)<=i&&i<=s.endOf(n,r)}equals(e){return this.isValid&&e.isValid&&this.valueOf()===e.valueOf()&&this.zone.equals(e.zone)&&this.loc.equals(e.loc)}toRelative(e={}){if(!this.isValid)return null;const n=e.base||dn.fromObject({},{zone:this.zone}),r=e.padding?this<n?-e.padding:e.padding:0;let i=["years","months","days","hours","minutes","seconds"],s=e.unit;return Array.isArray(e.unit)&&(i=e.unit,s=void 0),vte(n,this.plus(r),{...e,numeric:"always",units:i,unit:s})}toRelativeCalendar(e={}){return this.isValid?vte(e.base||dn.fromObject({},{zone:this.zone}),this,{...e,numeric:"auto",units:["years","months","days"],calendary:!0}):null}static min(...e){if(!e.every(dn.isDateTime))throw new na("min requires all arguments be DateTimes");return rte(e,n=>n.valueOf(),Math.min)}static max(...e){if(!e.every(dn.isDateTime))throw new na("max requires all arguments be DateTimes");return rte(e,n=>n.valueOf(),Math.max)}static fromFormatExplain(e,n,r={}){const{locale:i=null,numberingSystem:s=null}=r,o=Lr.fromOpts({locale:i,numberingSystem:s,defaultToEN:!0});return vge(o,e,n)}static fromStringExplain(e,n,r={}){return dn.fromFormatExplain(e,n,r)}static buildFormatParser(e,n={}){const{locale:r=null,numberingSystem:i=null}=n,s=Lr.fromOpts({locale:r,numberingSystem:i,defaultToEN:!0});return new yge(s,e)}static fromFormatParser(e,n,r={}){if(kn(e)||kn(n))throw new na("fromFormatParser requires an input string and a format parser");const{locale:i=null,numberingSystem:s=null}=r,o=Lr.fromOpts({locale:i,numberingSystem:s,defaultToEN:!0});if(!o.equals(n.locale))throw new na(`fromFormatParser called with a locale of ${o}, but the format parser was created for ${n.locale}`);const{result:a,zone:l,specificOffset:c,invalidReason:u}=n.explainFromTokens(e);return u?dn.invalid(u):b_(a,l,r,`format ${n.format}`,e,c)}static get DATE_SHORT(){return Q4}static get DATE_MED(){return bme}static get DATE_MED_WITH_WEEKDAY(){return x9e}static get DATE_FULL(){return Eme}static get DATE_HUGE(){return Sme}static get TIME_SIMPLE(){return Tme}static get TIME_WITH_SECONDS(){return kme}static get TIME_WITH_SHORT_OFFSET(){return Ame}static get TIME_WITH_LONG_OFFSET(){return Ime}static get TIME_24_SIMPLE(){return Pme}static get TIME_24_WITH_SECONDS(){return Cme}static get TIME_24_WITH_SHORT_OFFSET(){return Rme}static get TIME_24_WITH_LONG_OFFSET(){return Mme}static get DATETIME_SHORT(){return Nme}static get DATETIME_SHORT_WITH_SECONDS(){return Ome}static get DATETIME_MED(){return Lme}static get DATETIME_MED_WITH_SECONDS(){return Dme}static get DATETIME_MED_WITH_WEEKDAY(){return w9e}static get DATETIME_FULL(){return jme}static get DATETIME_FULL_WITH_SECONDS(){return $me}static get DATETIME_HUGE(){return Fme}static get DATETIME_HUGE_WITH_SECONDS(){return Vme}}function RE(t){if(dn.isDateTime(t))return t;if(t&&t.valueOf&&bg(t.valueOf()))return dn.fromJSDate(t);if(t&&typeof t=="object")return dn.fromObject(t);throw new na(`Unknown datetime argument: ${t}, of type ${typeof t}`)}const mVe="shortOffset";function gVe(t){return"timeZoneIANA"in t}function yVe(t){return t.startsWith("UTC")}function VPt(t,e=!1){return{json:{read:{source:t,reader:(n,r)=>r[t]?vVe(r[t]):null},write:!!e&&{allowNull:!0,writer(n,r){r[t]=n?_Ve(n):null}}}}}function vVe(t,e=jd){return t?gVe(t)?t.timeZoneIANA:xVe(t,e):e}function _Ve(t){return{timeZoneIANA:t}}function xVe(t,e=jd){if(!t||!Uee.has(t.timeZone))return e;const n=Uee.get(t.timeZone);return yVe(t.timeZone)||t.respectsDaylightSaving?n:wVe(n)}function wVe(t){const e=dn.local().setZone(t),n=Math.min(e.set({month:1,day:1}).offset,e.set({month:5}).offset);return n===0?"Etc/UTC":`Etc/GMT${ha.instance(-n).formatOffset(0,"narrow")}`}function zPt(t,e,n,r,i){if(e&&i==="date")return{timeZone:Bk,timeZoneName:void 0};const s=r.hour,o=n===UB;return{timeZone:o?i==="timestamp-offset"?void 0:t??Bk:n,timeZoneName:o&&s?mVe:void 0}}function bVe(t){const e=new Set(["etc/utc","etc/gmt","gmt"]),n=new Set(Intl.supportedValuesOf("timeZone").map(r=>r.toLowerCase()));return t===jd||t===UB||e.has(t.toLowerCase())||n.has(t.toLowerCase())}const EVe={dateStyle:void 0,year:void 0,month:void 0,day:void 0,weekday:void 0},SVe={timeStyle:void 0,hour12:void 0,hourCycle:void 0,hour:void 0,minute:void 0,second:void 0},bge={timeZone:Bk},Wh={year:"numeric",month:"numeric",day:"numeric"},ME={year:"numeric",month:"long",day:"numeric"},NE={year:"numeric",month:"short",day:"numeric"},OE={year:"numeric",month:"long",weekday:"long",day:"numeric"},Dm={hour:"numeric",minute:"numeric"},ey={...Dm,second:"numeric"},Ege={hourCycle:"h23"},LE={...Dm,...Ege},DE={...ey,...Ege},Sge={"short-date":Wh,"short-date-short-time":{...Wh,...Dm},"short-date-short-time-24":{...Wh,...LE},"short-date-long-time":{...Wh,...ey},"short-date-long-time-24":{...Wh,...DE},"short-date-le":Wh,"short-date-le-short-time":{...Wh,...Dm},"short-date-le-short-time-24":{...Wh,...LE},"short-date-le-long-time":{...Wh,...ey},"short-date-le-long-time-24":{...Wh,...DE},"long-month-day-year":ME,"long-month-day-year-short-time":{...ME,...Dm},"long-month-day-year-short-time-24":{...ME,...LE},"long-month-day-year-long-time":{...ME,...ey},"long-month-day-year-long-time-24":{...ME,...DE},"day-short-month-year":NE,"day-short-month-year-short-time":{...NE,...Dm},"day-short-month-year-short-time-24":{...NE,...LE},"day-short-month-year-long-time":{...NE,...ey},"day-short-month-year-long-time-24":{...NE,...DE},"long-date":OE,"long-date-short-time":{...OE,...Dm},"long-date-short-time-24":{...OE,...LE},"long-date-long-time":{...OE,...ey},"long-date-long-time-24":{...OE,...DE},"long-month-year":{month:"long",year:"numeric"},"short-month-year":{month:"short",year:"numeric"},year:{year:"numeric"},"short-time":Dm,"long-time":ey},TVe=Ol()({shortDate:"short-date",shortDateShortTime:"short-date-short-time",shortDateShortTime24:"short-date-short-time-24",shortDateLongTime:"short-date-long-time",shortDateLongTime24:"short-date-long-time-24",shortDateLE:"short-date-le",shortDateLEShortTime:"short-date-le-short-time",shortDateLEShortTime24:"short-date-le-short-time-24",shortDateLELongTime:"short-date-le-long-time",shortDateLELongTime24:"short-date-le-long-time-24",longMonthDayYear:"long-month-day-year",longMonthDayYearShortTime:"long-month-day-year-short-time",longMonthDayYearShortTime24:"long-month-day-year-short-time-24",longMonthDayYearLongTime:"long-month-day-year-long-time",longMonthDayYearLongTime24:"long-month-day-year-long-time-24",dayShortMonthYear:"day-short-month-year",dayShortMonthYearShortTime:"day-short-month-year-short-time",dayShortMonthYearShortTime24:"day-short-month-year-short-time-24",dayShortMonthYearLongTime:"day-short-month-year-long-time",dayShortMonthYearLongTime24:"day-short-month-year-long-time-24",longDate:"long-date",longDateShortTime:"long-date-short-time",longDateShortTime24:"long-date-short-time-24",longDateLongTime:"long-date-long-time",longDateLongTime24:"long-date-long-time-24",longMonthYear:"long-month-year",shortMonthYear:"short-month-year",year:"year"}),Tge={ar:"ar-u-nu-latn-ca-gregory",nn:"no-NN"},kVe=new Intl.DateTimeFormat("bs",{month:"long"}).formatToParts(new Date(2025,2)),AVe=kVe.find(({type:t})=>t==="month")?.value.toLowerCase();function kge(){const t=zB();return(t&&Tge[t])??fme()}AVe!=="mart"&&(Tge.bs="sr-Latn-CS");let M9=new WeakMap;const UO=Sge["short-date-short-time"];function IVe(t){let e=M9.get(t);if(!e){const n=kge(),r=QB(t.timeZone??jd),i={...t,timeZone:r};e=new Intl.DateTimeFormat(n,i),M9.set(t,e)}return e}function GPt(t){return Sge[t]}function UPt(t){const{dateStyle:e,timeStyle:n,hour12:r,year:i,month:s}=t,o={};return e?o.dateStyle=e:i&&(o.year=i,o.month=s||void 0),n&&!o.year&&(o.timeStyle=n,o.hour12=r==="auto"?void 0:r==="always"),o}function JB(t,e=UO){return IVe(e).format(t)}function BPt(t,e=UO){return JB(new Date(t),{...e,...bge,...SVe})}function WPt(t,e=UO){return JB(new Date(`1970-01-01T${t}Z`),{...e,...bge,...EVe})}function HPt(t,e=UO){if(e.timeZone)return JB(new Date(t),e);const n=dn.fromISO(t,{setZone:!0}),r=n.offset===0?Bk:e.timeZone,i={...e,timeZone:r};return n.toLocaleString(i,{locale:kge()})}function QB(t){switch(t){case jd:return g9e;case UB:return Bk;default:return t}}GB(()=>{M9=new WeakMap});const PVe={ar:"ar-u-nu-latn",bs:"sr-Latn-CS",nn:"no-NN"};let IM=new WeakMap,Age={};function N9(t){const e=t||Age;if(!IM.has(e)){const n=zB(),r=n&&PVe[n]||fme();IM.set(e,new Intl.NumberFormat(r,t))}return IM.get(e)}function qPt(t={}){const e={};return t.digitSeparator!=null&&(e.useGrouping=t.digitSeparator),t.places!=null&&(e.minimumFractionDigits=e.maximumFractionDigits=t.places),e}function KPt(t){const{minimumFractionDigits:e,maximumFractionDigits:n,useGrouping:r}=t;return{minimumFractionDigits:e,maximumFractionDigits:n,useGrouping:r==="auto"?"auto":r==="always"}}function YPt(t,e){return Object.is(t,-0)&&(t=0),N9(e).format(t)}function XPt(t,e=hu()){if(!t)return null;let n=xte.get(e);if(!n){const r=N9().formatToParts(12345.6),i=[...N9({useGrouping:!1}).format(9876543210)].reverse(),s=new Map(i.map((h,f)=>[h,f])),o=new RegExp(`[${r.find(h=>h.type==="group")?.value}]`,"g"),a=new RegExp(`[${r.find(h=>h.type==="decimal")?.value}]`),l=new RegExp(`[${i.join("")}]`,"g"),c=/[\u200E\u200F\u202A\u202B\u202C\u202D\u202E\u2066\u2067\u2068\u2069\u061C]/g,u=/[-\u2212\u2013\u2014\u2015]/g;n=h=>{if((h=h.trim().replaceAll(o,"").replace(a,".").replace(l,g=>String(s.get(g))).replaceAll(c,"").replaceAll(u,"-"))==="")return null;const f=Number(h);return isNaN(f)?null:f},xte.set(e,n)}return n(t)}GB(()=>{IM=new WeakMap,Age={}});const xte=new Map;async function CVe(t,e,n,r){const i=e.exec(n);if(!i)throw new Xe("esri-intl:invalid-bundle",`Bundle id "${n}" is not compatible with the pattern "${e}"`);const s=i[1]?`${i[1]}/`:"",o=i[2],a=_me(r),l=`${s}${o}.json`,c=a?`${s}${o}_${a}.json`:l;let u;try{u=await wte(t(c))}catch(h){if(c===l)throw new Xe("intl:unknown-bundle",`Bundle "${n}" cannot be loaded`,{error:h});try{u=await wte(t(l))}catch(f){throw new Xe("intl:unknown-bundle",`Bundle "${n}" cannot be loaded`,{error:f})}}return u}async function wte(t){if(bte.fetchBundleAsset!=null)return bte.fetchBundleAsset(t);const e=await ns(t,{responseType:"text"});return JSON.parse(e.data)}let RVe=class{constructor({base:e="",pattern:n,location:r=new URL(window.location.href)}){let i;i=typeof r=="string"?s=>new URL(s,new URL(r,window.location.href)).href:r instanceof URL?s=>new URL(s,r).href:r,this.pattern=typeof n=="string"?new RegExp(`^${n}`):n,this.getAssetUrl=i,e=e?e.endsWith("/")?e:e+"/":"",this.matcher=new RegExp(`^${e}(?:(.*)\\/)?(.*)$`)}fetchMessageBundle(e,n){return CVe(this.getAssetUrl,this.matcher,e,n)}};function MVe(t){return new RVe(t)}const bte={};d9e(MVe({pattern:"esri/",location:Hi}));let xf=class extends Kt{constructor(e){super(e),this.apiKey=null,this.id=null,this.language=null,this.places=null,this.serviceUrl="https://basemapstyles-api.arcgis.com/arcgis/rest/services/styles/v2",this.worldview=null}get languageParameter(){const e=this.language;let n=e==="local"||e==="global"?e:_me(e??hu())??"global";return n=n==="no"?"nb":n,n}};x([E()],xf.prototype,"apiKey",void 0),x([E()],xf.prototype,"id",void 0),x([E()],xf.prototype,"language",void 0),x([E()],xf.prototype,"places",void 0),x([E()],xf.prototype,"serviceUrl",void 0),x([E()],xf.prototype,"worldview",void 0),xf=x([ue("esri.support.BasemapStyle")],xf);const NVe=xf,Ige=Symbol("BasemapInstance");function QPt(t){return t!=null&&typeof t=="object"&&Ige in t}function fn(t,e,n={}){return eW(t,e,n,Pge)}function wc(t,e,n={}){return eW(t,e,n,Cge)}function eW(t,e,n={},r){let i=null;const s=n.once?(o,a)=>{r(o)&&(ii(i),e(o,a))}:(o,a)=>{r(o)&&e(o,a)};if(i=$$e(t,s,n.sync,n.equals),n.initial){const o=t();s(o,o)}return i}function H1(t,e,n,r={}){let i=null,s=null,o=null;function a(){i&&s&&(s.remove(),r.onListenerRemove?.(i),i=null,s=null)}function l(u){r.once&&r.once&&ii(o),n(u)}const c=fn(t,(u,h)=>{a(),SO(u)&&(i=u,s=ob(u,e,l),r.onListenerAdd?.(u))},{sync:r.sync,initial:!0});return o=Zn(()=>{c.remove(),a()}),o}function tW(t,e){return OVe(t,Cge,e)}function OVe(t,e,n){if(ma(n))return Promise.reject(Pr());const r=t();if(e?.(r))return Promise.resolve(r);let i=null;function s(){i=ii(i)}return new Promise((o,a)=>{i=fv([yu(n,()=>{s(),a(Pr())}),eW(t,l=>{s(),o(l)},{sync:!1,once:!0},e??Pge)])})}function Pge(t){return!0}function Cge(t){return!!t}function eCt(t,e,n={}){let r=!1;const i=fn(t,(s,o)=>{r||e(s,o)},n);return{remove(){i.remove()},pause(){r=!0},resume(){r=!1}}}const Ug={sync:!0},ya={initial:!0},ra={sync:!0,initial:!0};let Rge=0;const nW=t=>{const e=t;let n=class extends e{constructor(...r){super(...r),Object.defineProperty(this,"uid",{writable:!1,configurable:!1,value:Date.now().toString(16)+"-object-"+Rge++})}};return n=x([ue("esri.core.Identifiable")],n),n},rW=t=>{const e=t;let n=class extends e{constructor(...r){super(...r),Object.defineProperty(this,"uid",{writable:!1,configurable:!1,value:Rge++})}};return n=x([ue("esri.core.Identifiable.NumericIdentifiable")],n),n};nW(class{});async function LVe(t){const e="portalItem"in t?t:{portalItem:t},{fromItem:n}=await _e(async()=>{const{fromItem:r}=await import("./portalLayers-kXvbU65y.js");return{fromItem:r}},__vite__mapDeps([35,36,37,38,39,33]));try{return await n(e)}catch(r){const i=e?.portalItem,s=i?.id||"unset",o=i?.portal?.url||nr.portalUrl;throw kt.getLogger("esri.layers.support.fromPortalItem").error("#fromPortalItem()","Failed to create layer from portal item (portal: '"+o+"', id: '"+s+"')",r),r}}const Ete={milliseconds:1,seconds:1e3,minutes:6e4,hours:36e5,days:864e5,weeks:6048e5,months:26784e5,years:31536e6,decades:31536e7,centuries:31536e8};function Uj(t,e,n,r=jd){const i=new wh(QB(r)),s=dn.fromJSDate(t,{zone:i}),o=n==="decades"||n==="centuries"?"year":Mge(n);return n==="decades"&&(e*=10),n==="centuries"&&(e*=100),s.plus({[o]:e}).toJSDate()}function tCt(t,e,n="milliseconds"){const r=t.getTime(),i=DVe(e,n,"milliseconds");return new Date(r+i)}function Ste(t,e,n=jd){const r=new wh(QB(n)),i=dn.fromJSDate(t,{zone:r});if(e==="decades"||e==="centuries"){const o=i.startOf("year"),{year:a}=o,l=a-a%(e==="decades"?10:100);return o.set({year:l}).toJSDate()}const s=Mge(e);return i.startOf(s).toJSDate()}function DVe(t,e,n){return t===0?0:t*Ete[e]/Ete[n]}function nCt(t,e){return t&&e?t.intersection(e):t||e}function Mge(t){switch(t){case"milliseconds":return"millisecond";case"seconds":return"second";case"minutes":return"minute";case"hours":return"hour";case"days":return"day";case"weeks":return"week";case"months":return"month";case"years":return"year"}}var jc,Iw;let Pa=(Iw=class extends qt{static get allTime(){return Tte}static get empty(){return jVe}static fromArray(e){return new jc({start:e[0]!=null?new Date(e[0]):e[0],end:e[1]!=null?new Date(e[1]):e[1]})}constructor(e){super(e),this.end=null,this.start=null}readEnd(e,n){return n.end!=null?new Date(n.end):null}writeEnd(e,n){n.end=e?.getTime()??null}get isAllTime(){return this.equals(jc.allTime)}get isEmpty(){return this.equals(jc.empty)}readStart(e,n){return n.start!=null?new Date(n.start):null}writeStart(e,n){n.start=e?.getTime()??null}clone(){return new jc({end:this.end,start:this.start})}equals(e){if(!e)return!1;const n=this.start?.getTime()??this.start,r=this.end?.getTime()??this.end,i=e.start?.getTime()??e.start,s=e.end?.getTime()??e.end;return n===i&&r===s}expandTo(e,n=jd){if(this.isEmpty||this.isAllTime)return this.clone();let r=this.start;r&&(r=Ste(r,e,n));let i=this.end;if(i){const s=Ste(i,e,n);i=i.getTime()===s.getTime()?s:Uj(s,1,e,n)}return new jc({start:r,end:i})}intersection(e){if(!e)return this.clone();if(this.isEmpty||e.isEmpty)return jc.empty;if(this.isAllTime)return e.clone();if(e.isAllTime)return this.clone();const n=this.start?.getTime()??-1/0,r=this.end?.getTime()??1/0,i=e.start?.getTime()??-1/0,s=e.end?.getTime()??1/0;let o,a;return i>=n&&i<=r?o=i:n>=i&&n<=s&&(o=n),r>=i&&r<=s?a=r:s>=n&&s<=r&&(a=s),o==null||a==null||isNaN(o)||isNaN(a)?jc.empty:new jc({start:o===-1/0?null:new Date(o),end:a===1/0?null:new Date(a)})}offset(e,n,r=jd){if(this.isEmpty||this.isAllTime)return this.clone();const i=new jc,{start:s,end:o}=this;return s!=null&&(i.start=Uj(s,e,n,r)),o!=null&&(i.end=Uj(o,e,n,r)),i}toArray(){return this.isEmpty?[void 0,void 0]:[this.start?.getTime()??null,this.end?.getTime()??null]}union(e){if(!e||e.isEmpty)return this.clone();if(this.isEmpty)return e.clone();if(this.isAllTime||e.isAllTime)return Tte.clone();const n=this.start!=null&&e.start!=null?new Date(Math.min(this.start.getTime(),e.start.getTime())):null,r=this.end!=null&&e.end!=null?new Date(Math.max(this.end.getTime(),e.end.getTime())):null;return new jc({start:n,end:r})}},jc=Iw,Iw);x([E({type:Date,json:{write:{allowNull:!0}}})],Pa.prototype,"end",void 0),x([cr("end")],Pa.prototype,"readEnd",null),x([er("end")],Pa.prototype,"writeEnd",null),x([E({readOnly:!0,json:{read:!1}})],Pa.prototype,"isAllTime",null),x([E({readOnly:!0,json:{read:!1}})],Pa.prototype,"isEmpty",null),x([E({type:Date,json:{write:{allowNull:!0}}})],Pa.prototype,"start",void 0),x([cr("start")],Pa.prototype,"readStart",null),x([er("start")],Pa.prototype,"writeStart",null),Pa=jc=x([ue("esri.time.TimeExtent")],Pa);const Tte=new Pa,jVe=new Pa({start:void 0,end:void 0});let $Ve=0,xi=class extends RO(nW(xI)){constructor(){super(...arguments),this.attributionDataUrl=null,this.fullExtent=new Vn(-180,-90,180,90,Bt.WGS84),this.id=Date.now().toString(16)+"-layer-"+$Ve++,this.legendEnabled=!0,this.listMode="show",this.opacity=1,this.parent=null,this.persistenceEnabled=!1,this.popupEnabled=!0,this.attributionVisible=!0,this.spatialReference=Bt.WGS84,this.title=null,this.type=null,this.url=null,this.visibilityTimeExtent=null,this.visible=!0}static async fromArcGISServerUrl(e){const n=typeof e=="string"?{url:e}:e;return(await _e(async()=>{const{fromUrl:r}=await import("./arcgisLayers-DpVrOYHr.js");return{fromUrl:r}},__vite__mapDeps([40,36,37,39]))).fromUrl(n)}static fromPortalItem(e){return LVe(e)}initialize(){this.when().catch(e=>{wa(e)||kt.getLogger(this).error("#load()",`Failed to load layer (title: '${this.title??"no title"}', id: '${this.id??"no id"}')`,{error:e})})}destroy(){const{parent:e}=this;e&&(this.parent=null,e.removeChildLayer?.(this))}get effectiveVisible(){return this.visible&&(this.parent?.effectiveVisible??!0)}get hasAttributionData(){return this.attributionDataUrl!=null}get loaded(){return super.loaded}removeFromParent(){const{parent:e}=this;e&&(e.removeChildLayer?.(this),this.parent=null)}get parsedUrl(){return Wa(this.url)}createLayerView(e,n){return Promise.reject(new Xe("layer:create-layer-view","Layer does not support creating a layer view"))}async fetchAttributionData(){const e=this.attributionDataUrl;if(this.hasAttributionData&&e)return(await ns(e,{query:{f:"json"},responseType:"json"})).data;throw new Xe("layer:no-attribution-data","Layer does not have attribution data")}};x([E({type:String})],xi.prototype,"attributionDataUrl",void 0),x([E({readOnly:!0})],xi.prototype,"effectiveVisible",null),x([E({type:Vn})],xi.prototype,"fullExtent",void 0),x([E({readOnly:!0})],xi.prototype,"hasAttributionData",null),x([E({type:String,clonable:!1})],xi.prototype,"id",void 0),x([E({type:Boolean,nonNullable:!0})],xi.prototype,"legendEnabled",void 0),x([E({type:["show","hide","hide-children"]})],xi.prototype,"listMode",void 0),x([E({type:Number,range:{min:0,max:1},nonNullable:!0})],xi.prototype,"opacity",void 0),x([E({clonable:!1})],xi.prototype,"parent",void 0),x([E({readOnly:!0})],xi.prototype,"parsedUrl",null),x([E({type:Boolean,readOnly:!0})],xi.prototype,"persistenceEnabled",void 0),x([E({type:Boolean})],xi.prototype,"popupEnabled",void 0),x([E({type:Boolean})],xi.prototype,"attributionVisible",void 0),x([E({type:Bt})],xi.prototype,"spatialReference",void 0),x([E({type:String})],xi.prototype,"title",void 0),x([E({readOnly:!0,json:{read:!1}})],xi.prototype,"type",void 0),x([E()],xi.prototype,"url",void 0),x([E({type:Pa})],xi.prototype,"visibilityTimeExtent",void 0),x([E({type:Boolean,nonNullable:!0})],xi.prototype,"visible",void 0),xi=x([ue("esri.layers.Layer")],xi);const zC=new WeakMap;function Nge(t){return!t.destroyed&&(zC.has(t)||t.addHandles([fn(()=>{const{parent:e}=t;return!!(e&&e instanceof xi)&&(e.type==="catalog-dynamic-group"||Nge(e))},e=>zC.set(t,e),ra),Zn(()=>zC.delete(t))]),zC.get(t))}function FVe(t){return t!=null&&typeof t=="object"&&"type"in t&&t.type==="feature"}function iCt(t){return t!=null&&typeof t=="object"&&"type"in t&&t.type==="graphics"}function VVe(t){return t!=null&&typeof t=="object"&&"type"in t&&t.type==="map-image"}function zVe(t){return t!=null&&typeof t=="object"&&"type"in t&&t.type==="knowledge-graph"&&"layers"in t}function sCt(t){return t!=null&&typeof t=="object"&&"type"in t&&t.type==="knowledge-graph-sublayer"}function kte(t){return t!=null&&typeof t=="object"&&"type"in t&&t.type==="subtype-group"&&"sublayers"in t}function K_(t){return t?.type==="subtype-sublayer"}const oCt={Point:"SceneLayer","3DObject":"SceneLayer",IntegratedMesh:"IntegratedMeshLayer",PointCloud:"PointCloudLayer",Building:"BuildingSceneLayer"};function aCt(t){const e=t?.type;return e==="building-scene"||e==="integrated-mesh"||e==="point-cloud"||e==="scene"}function lCt(t){return t.type==="integrated-mesh"||t.type==="integrated-mesh-3dtiles"}function BO(t){return t?.type==="feature"&&!t.url&&t.source?.type==="memory"}function cCt(t){const e=t?.type;return(e==="feature"||e==="subtype-group"||e==="oriented-imagery")&&t?.source?.type==="feature-layer"}function GVe(t){return t?.type==="feature"&&t.source?.type==="feature-layer"}function uCt(t){return FVe(t)&&GVe(t)}async function hCt(t,e){const n=Zr?.findServerInfo(t);if(n?.currentVersion!=null)return n.owningSystemUrl||null;const r=t.toLowerCase().indexOf("/rest/services");if(r===-1)return null;const i=`${t.slice(0,r)}/rest/info`,s=e!=null?e.signal:null,{data:o}=await ns(i,{query:{f:"json"},responseType:"json",signal:s});return o?.owningSystemUrl||null}function UVe(t){if(!("capabilities"in t))return!1;switch(t.type){case"catalog":case"catalog-footprint":case"csv":case"feature":case"geojson":case"imagery":case"knowledge-graph-sublayer":case"ogc-feature":case"oriented-imagery":case"scene":case"sublayer":case"subtype-group":case"subtype-sublayer":case"wfs":return!0;default:return!1}}function BVe(t){return UVe(t)?"effectiveCapabilities"in t?t.effectiveCapabilities:t.capabilities:null}function WVe(t){if(!("editingEnabled"in t))return!1;switch(t.type){case"csv":case"feature":case"geojson":case"oriented-imagery":case"scene":case"subtype-group":case"subtype-sublayer":case"knowledge-graph-sublayer":return!0;default:return!1}}function HVe(t){return!!WVe(t)&&("effectiveEditingEnabled"in t?t.effectiveEditingEnabled:t.editingEnabled)}function qVe(t,e){return null}function dCt(t){return null}function KVe(t){return!t||t.type==="Feature Service"&&!t.sourceUrl}function fCt(t,e){!e||!KVe(t)||qVe(t.url)}const YVe=new Set(["bing-maps","imagery","imagery-tile","map-image","open-street-map","tile","unknown","unsupported","vector-tile","web-tile","wcs","wms","wmts"]),XVe=new Set(["integrated-mesh-3dtiles"]),Oge=new Set(["catalog","csv","feature","geo-rss","geojson","group","imagery","imagery-tile","kml","knowledge-graph","map-image","map-notes","media","ogc-feature","oriented-imagery","parquet","route","stream","subtype-group","tile","unknown","unsupported","vector-tile","video","web-tile","wcs","wfs","wms","wmts"]),ZVe=new Set([...Oge,"link-chart"]);function JVe(t){switch(t.layerContainerType){case"basemap-base-layers":return YVe;case"basemap-ground-layers":return XVe;case"operational-layers":return t.origin==="link-chart"?ZVe:Oge;default:return null}}function QVe(t,e){if(e.restrictedWebMapWriting){const n=JVe(e);return n==null||n.has(t.type)&&!BO(t)}return!0}function eze(t,e){if(e)if(BO(t)){const n=wO("featureCollection.layers",e),r=n?.[0]?.layerDefinition;r&&Ate(t,r)}else t.type!=="group"&&Ate(t,e)}function Ate(t,e){"maxScale"in t&&(e.maxScale=X4(t.maxScale)??void 0),"minScale"in t&&(e.minScale=X4(t.minScale)??void 0)}function tze(t,e){if(eze(t,e),e&&(e.id=t.id,"blendMode"in t&&(e.blendMode=t.blendMode,e.blendMode==="normal"&&delete e.blendMode),e.opacity=X4(t.opacity)??void 0,e.title=t.title||"Layer",e.visibility=t.visible,"legendEnabled"in t&&t.type!=="wmts"))if(BO(t)){const n=e.featureCollection;n&&(n.showLegend=t.legendEnabled)}else e.showLegend=t.legendEnabled}function Bj(t,e,n){if(!t.persistenceEnabled)return null;if(!("write"in t)||!t.write)return n?.messages&&n.messages.push(new Xe("layer:unsupported",`Layers (${t.title}, ${t.id}) of type '${t.declaredClass}' cannot be persisted`,{layer:t})),null;if(BO(t)&&!t.isTable)e=t.resourceInfo;else if(QVe(t,n)){const r={};return t.write(r,n)?r:null}return e!=null&&tze(t,e=Ze(e)),e}var Ite,Y_,f1;let el=(f1=class extends o0(xI){constructor(e){super(e),this[Ite]=!0,this.id=null,this.portalItem=null,this.spatialReference=null,this.style=null,this.thumbnailUrl=null,this.title="Basemap",this.type="Basemap",this.id=Date.now().toString(16)+"-basemap-"+Y_.idCounter++,this.baseLayers=new Ot,this.referenceLayers=new Ot,this.groundLayers=new Ot;const n=a=>{const{parent:l}=a;l&&l!==this&&"remove"in l&&l.remove?.(a),a.parent=this,a.type!=="elevation"&&a.type!=="integrated-mesh-3dtiles"||kt.getLogger(this).error(`Layer '${a.title}, id:${a.id}' of type '${a.type}' is not supported as a basemap layer and will therefore be ignored.`)},r=a=>{const{parent:l}=a;l&&l!==this&&"remove"in l&&l.remove?.(a),a.parent=this},i=a=>{const l=a.item;return l.parent===this?(kt.getLogger(this).error(`Layer '${l.title}, id:${l.id}' of type '${l.type}' already a ground layer, second add will be ignored.`),void a.preventDefault()):l.type!=="integrated-mesh-3dtiles"&&l.type!=="integrated-mesh"?(kt.getLogger(this).error(`Layer '${l.title}, id:${l.id}' of type '${l.type}' is not supported as a ground layer and will therefore be ignored.`),void a.preventDefault()):void 0},s=a=>{a.parent=null},o=a=>{a.parent===this&&(a.parent=null)};this.addHandles([this.baseLayers.on("after-add",a=>n(a.item)),this.baseLayers.on("after-remove",a=>s(a.item)),this.referenceLayers.on("after-add",a=>n(a.item)),this.referenceLayers.on("after-remove",a=>s(a.item)),this.groundLayers.on("before-add",i),this.groundLayers.on("after-add",a=>r(a.item)),this.groundLayers.on("after-remove",a=>o(a.item))])}initialize(){this.when().catch(e=>{kt.getLogger(this).error("#load()",`Failed to load basemap (title: '${this.title}', id: '${this.id}')`,e)}),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){const e=this.baseLayers.toArray();for(const i of e)i.destroyed||i.destroy();const n=this.groundLayers.toArray();for(const i of n)i.destroyed||i.destroy();const r=this.referenceLayers.toArray();for(const i of r)i.destroyed||i.destroy();this.baseLayers.destroy(),this.groundLayers.destroy(),this.referenceLayers.destroy(),this.portalItem=Di(this.portalItem)}removeChildLayer(e){for(const n of[this.baseLayers,this.referenceLayers,this.groundLayers])n.remove(e)}normalizeCtorArgs(e){return e&&"resourceInfo"in e&&(this._set("resourceInfo",e.resourceInfo),delete(e={...e}).resourceInfo),e}set baseLayers(e){this._set("baseLayers",Sd(e,this._get("baseLayers")))}_writeBaseLayers(e,n,r){const i=[];e&&(r={...r,layerContainerType:"basemap-base-layers"},this.baseLayers.forEach(s=>{const o=Bj(s,r.webmap?r.webmap.getLayerJSONFromResourceInfo(s):null,r);o!=null&&i.push(o)}),this.referenceLayers.forEach(s=>{const o=Bj(s,r.webmap?r.webmap.getLayerJSONFromResourceInfo(s):null,r);o!=null&&(s.type!=="scene"&&(o.isReference=!0),i.push(o))})),n.baseMapLayers=i}set groundLayers(e){this._set("groundLayers",Sd(e,this._get("groundLayers")))}_writeGroundLayers(e,n,r){const i=[];e&&(r={...r,layerContainerType:"basemap-ground-layers"},this.groundLayers.forEach(s=>{const o=Bj(s,r.webmap?r.webmap.getLayerJSONFromResourceInfo(s):null,r);o!=null&&i.push(o)}),i.length>0&&(n.groundLayers=i))}get loaded(){return super.loaded}set referenceLayers(e){this._set("referenceLayers",Sd(e,this._get("referenceLayers")))}writeTitle(e,n){n.title=e||"Basemap"}load(e){return this.addResolvingPromise(this._loadFromSource(e)),Promise.resolve(this)}loadAll(){return Fpe(this,e=>{e(this.baseLayers,this.groundLayers,this.referenceLayers)})}clone(){const e={id:this.id,title:this.title,portalItem:this.portalItem,baseLayers:this.baseLayers.map(n=>dT(n)?n.clone():n),groundLayers:this.groundLayers.map(n=>dT(n)?n.clone():n),referenceLayers:this.referenceLayers.map(n=>dT(n)?n.clone():n)};return this.loaded&&(e.loadStatus="loaded"),new Y_({resourceInfo:this.resourceInfo}).set(e)}read(e,n){this.resourceInfo||this._set("resourceInfo",{data:e,context:n}),super.read(e,n)}write(e,n){return e=e||{},n?.origin||(n={origin:"web-map",...n}),super.write(e,n),!this.loaded&&this.resourceInfo?.data.baseMapLayers&&(e.baseMapLayers=this.resourceInfo.data.baseMapLayers.map(r=>{const i=Ze(r);return i.url&&Od(i.url)&&(i.url=`https:${i.url}`),i.templateUrl&&Od(i.templateUrl)&&(i.templateUrl=`https:${i.templateUrl}`),i})),e}async _loadFromSource(e){const{resourceInfo:n,portalItem:r,style:i}=this;pi(e);const s=[];if(n){const o=n.context?n.context.url:null;if(s.push(this._loadLayersFromJSON(n.data,o,e)),n.data.id&&!n.data.title){const a=n.data.id;s.push(m9e(a).then(l=>{l&&this.read({title:l},n.context)}))}}else r?s.push(this._loadFromItem(r,e)):i&&s.push(this._loadFromStylesService(i,e));await Promise.all(s)}async _loadLayersFromJSON(e,n,r){const i=this.resourceInfo?.context,s=this.portalItem?.portal||i?.portal||null,o=rze[i?.origin||""]??"web-map",{populateOperationalLayers:a}=await _e(async()=>{const{populateOperationalLayers:c}=await import("./layersCreator-BMyNPotq.js");return{populateOperationalLayers:c}},__vite__mapDeps([41,38,37,36,39,35,33,42])),l=[];if(pi(r),e.baseMapLayers&&Array.isArray(e.baseMapLayers)){const c={context:{...i,origin:o,url:n,portal:s,layerContainerType:"basemap-base-layers"},defaultLayerType:"DefaultTileLayer"},u=g=>o==="web-scene"&&g.layerType==="ArcGISSceneServiceLayer"||g.isReference,h=a(this.baseLayers,e.baseMapLayers.filter(g=>!u(g)),c);l.push(h);const f=a(this.referenceLayers,e.baseMapLayers.filter(u),c);l.push(f)}if(e.groundLayers&&Array.isArray(e.groundLayers)){const c={context:{...i,origin:o,url:n,portal:s,layerContainerType:"basemap-ground-layers"},defaultLayerType:"IntegratedMesh3DTilesLayer"},u=a(this.groundLayers,e.groundLayers,c);l.push(u)}await Promise.allSettled(l)}async _loadFromItem(e,n){const r=await e.load(n),i=await r.fetchData("json",n),s=Wa(e.itemUrl??"");return this._set("resourceInfo",{data:i.baseMap??{},context:{origin:nze[e.type||""]??"web-map",portal:e.portal||it.getDefault(),url:s}}),this.read(this.resourceInfo.data,this.resourceInfo.context),this.read({spatialReference:i.spatialReference},this.resourceInfo.context),this.read({title:e.title,thumbnailUrl:e.thumbnailUrl},{origin:"portal-item",portal:e.portal||it.getDefault(),url:s}),this._loadLayersFromJSON(this.resourceInfo.data,s,n)}async _loadFromStylesService(e,n){const r=e.serviceUrl.endsWith("/webmaps")?e.serviceUrl.slice(0,-8):e.serviceUrl,i=`${r}/styles/${e.id}/self`,s=`${r}/webmaps/${e.id}`,o=e.apiKey??nr.apiKeys.basemapStyles,[a,l]=await Promise.all([(await ns(i,{query:{token:o},signal:n?.signal})).data,(await ns(s,{query:{language:e.languageParameter,places:e.places,worldview:e.worldview,token:o},signal:n?.signal})).data]);this.thumbnailUrl??=a.thumbnailUrl;const c=Wa(s);if(this._set("resourceInfo",{data:l.baseMap??{},context:{origin:"web-map",url:c}}),this.read(this.resourceInfo.data,this.resourceInfo.context),this.read({spatialReference:l.spatialReference},this.resourceInfo.context),await this._loadLayersFromJSON(this.resourceInfo.data,c,n),o)for(const u of[...this.baseLayers,...this.groundLayers,...this.referenceLayers])"apiKey"in u&&(u.apiKey=o)}static fromId(e){const n=x9[e];return n?n.itemId?new Y_({portalItem:{id:n.itemId,portal:{url:"https://www.arcgis.com"}}}):Y_.fromJSON(n,n.is3d?{origin:"web-scene",portal:new it({url:"https://www.arcgis.com"})}:{origin:"web-map"}):null}},Ite=Ige,Y_=f1,f1.idCounter=0,f1);x([E({json:{read:!1,write:{ignoreOrigin:!0,target:"baseMapLayers",writer(t,e,n,r){this._writeBaseLayers(t,e,r)}},origins:{"web-scene":{write:{ignoreOrigin:!0,target:{baseMapLayers:{type:Ot}},writer(t,e,n,r){this._writeBaseLayers(t,e,r)}}}}}})],el.prototype,"baseLayers",null),x([E({json:{read:!1,write:{ignoreOrigin:!0,target:"groundLayers",writer(t,e,n,r){this._writeGroundLayers(t,e,r)}},origins:{"web-scene":{write:{ignoreOrigin:!0,target:{groundLayers:{type:Ot}},writer(t,e,n,r){this._writeGroundLayers(t,e,r)}}}}}})],el.prototype,"groundLayers",null),x([E({type:String,json:{origins:{"web-scene":{write:!0}}}})],el.prototype,"id",void 0),x([E({type:xn})],el.prototype,"portalItem",void 0),x([E()],el.prototype,"referenceLayers",null),x([E({readOnly:!0})],el.prototype,"resourceInfo",void 0),x([E({type:Bt})],el.prototype,"spatialReference",void 0),x([E({type:NVe})],el.prototype,"style",void 0),x([E()],el.prototype,"thumbnailUrl",void 0),x([E({type:String,json:{origins:{"web-scene":{write:{isRequired:!0}}}}})],el.prototype,"title",void 0),x([er("title")],el.prototype,"writeTitle",null),el=Y_=x([ue("esri.Basemap")],el);const nze={"Web Scene":"web-scene","Web Map":"web-map","Link Chart":"link-chart"},rze={"web-scene":"web-scene","web-map":"web-map","link-chart":"link-chart"},yT=el,ize=Object.freeze(Object.defineProperty({__proto__:null,default:yT},Symbol.toStringTag,{value:"Module"})),rN={transparent:[0,0,0,0],black:[0,0,0,1],silver:[192,192,192,1],gray:[128,128,128,1],white:[255,255,255,1],maroon:[128,0,0,1],red:[255,0,0,1],purple:[128,0,128,1],fuchsia:[255,0,255,1],green:[0,128,0,1],lime:[0,255,0,1],olive:[128,128,0,1],yellow:[255,255,0,1],navy:[0,0,128,1],blue:[0,0,255,1],teal:[0,128,128,1],aqua:[0,255,255,1],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],blanchedalmond:[255,235,205,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],oldlace:[253,245,230,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],rebeccapurple:[102,51,153,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],whitesmoke:[245,245,245,1],yellowgreen:[154,205,50,1]};function sze(t){return!!rN[t]||!!rN[t.toLowerCase()]}function Lge(t){return rN[t]??rN[t.toLowerCase()]}function pCt(t){return[...Lge(t)]}function Wj(t,e,n){n<0&&++n,n>1&&--n;const r=6*n;return r<1?t+(e-t)*r:2*n<1?e:3*n<2?t+(e-t)*(2/3-n)*6:t}function oze(t,e,n,r=1){const i=(t%360+360)%360/360,s=n<=.5?n*(e+1):n+e-n*e,o=2*n-s;return[Math.round(255*Wj(o,s,i+1/3)),Math.round(255*Wj(o,s,i)),Math.round(255*Wj(o,s,i-1/3)),r]}function mCt(t){const e=t.length>5,n=e?8:4,r=(1<<n)-1,i=e?1:17,s=e?t.length===9:t.length===5;let o=+("0x"+t.slice(1));if(isNaN(o))return null;const a=[0,0,0,1];let l;return s&&(l=o&r,o>>=n,a[3]=i*l/255),l=o&r,o>>=n,a[2]=i*l,l=o&r,o>>=n,a[1]=i*l,l=o&r,o>>=n,a[0]=i*l,a}function Dge(t){if(!t.startsWith("#")||isNaN(+`0x${t.slice(1)}`))return null;switch(t.length){case 4:case 5:{const e=parseInt(t.slice(1,2),16),n=parseInt(t.slice(2,3),16),r=parseInt(t.slice(3,4),16),i=t.length===4?15:parseInt(t.slice(4),16);return[e+16*e,n+16*n,r+16*r,(i+16*i)/255]}case 7:case 9:return[parseInt(t.slice(1,3),16),parseInt(t.slice(3,5),16),parseInt(t.slice(5,7),16),(t.length===7?255:parseInt(t.slice(7),16))/255];default:return null}}function jge(t){const e=t.toLowerCase().match(/^(rgba?|hsla?)\(([\s.\-,%0-9]+)\)/);if(e){const n=e[2].split(/\s*,\s*/),r=e[1];if(r==="rgb"&&n.length===3||r==="rgba"&&n.length===4){if(n[0].endsWith("%")){const i=n.map(s=>2.56*parseFloat(s));return n.length===4&&(i[3]=parseFloat(n[3])),Pte(i)}return Pte(n.map(i=>parseFloat(i)))}if(r==="hsl"&&n.length===3||r==="hsla"&&n.length===4)return oze(parseFloat(n[0]),parseFloat(n[1])/100,parseFloat(n[2])/100,parseFloat(n[3]??"1"))}return null}function Pte(t){return t[0]=aw(t[0]),t[1]=aw(t[1]),t[2]=aw(t[2]),t[3]=t.length===4?Fge(t[3]):1,t}function $ge(t){let e=sze(t)?Lge(t):null;return e??=jge(t),e??=Dge(t),e}function gCt(t){const e=$ge(t);return e!=null?[e[0]/255,e[1]/255,e[2]/255,e[3]]:null}function Fge(t){return Vge(t,0,1)}function aw(t){return Math.round(Vge(t,0,255))}function Vge(t,e,n){return t=Number(t),isNaN(t)?n:t<e?e:t>n?n:t}const zge=2.2,aze=1/zge;function yCt(t){return t**zge}function vCt(t){return t**aze}const Cte=new Float32Array(1);function _Ct(t){--t;for(let e=1;e<32;e<<=1)t|=t>>e;return t+1}function vu(t,e,n){return Math.min(Math.max(t,e),n)}function xCt(t){return!(t&t-1)}function wCt(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,++t}function gS(t,e,n){return t+(e-t)*n}function bCt(t,e,n,r,i){return gS(r,i,(t-e)/(n-e))}function kI(t){return t*Math.PI/180}function Gge(t){return 180*t/Math.PI}function ECt(t,e=1e-6){return(t<0?-1:1)/Math.max(Math.abs(t),e)}function SCt(t){return Math.acos(vu(t,-1,1))}function lze(t){return Math.asin(vu(t,-1,1))}function Eg(t,e,n=1e-6){return t===e?!0:!Number.isFinite(t)||!Number.isFinite(e)?!1:(t>e?t-e:e-t)<=n}function TCt(t,e,n=1e-6){return!Eg(t,e,n)&&t>e}function kCt(t,e,n=1e-6){return!Eg(t,e,n)&&t<e}function ACt(t,e,n=1e-6){return Eg(t,e,n)||t>e}const iN=new DataView(new ArrayBuffer(Float64Array.BYTES_PER_ELEMENT));function O9(t){return iN.setFloat64(0,t),iN.getBigInt64(0)}function cze(t){return iN.setBigInt64(0,t),iN.getFloat64(0)}const PM=1000000n,uze=Uge(1);function Uge(t){const e=O9(t=Math.abs(t)),n=cze(e<=PM?PM:e-PM);return Math.abs(t-n)}function ICt(t,e,n=uze){if(t===e)return!0;if(!Number.isFinite(t)||!Number.isFinite(e))return!1;if(n!=null&&Uge(Math.min(Math.abs(t),Math.abs(e)))<n)return Math.abs(t-e)<=n;const r=O9(t),i=O9(e);return r<0!=i<0?!1:!((r<i?i-r:r-i)>PM)}function Bge(t,e,n=1e-6){if(t===e)return!0;if(!Number.isFinite(t)||!Number.isFinite(e))return!1;const r=Math.abs(t-e),i=Math.abs(t),s=Math.abs(e);if(t===0||e===0||i<1e-12&&s<1e-12){if(r>.01*n)return!1}else if(r/(i+s)>n)return!1;return!0}function PCt(t){return Wge(Math.max(-Rte,Math.min(t,Rte)))}function Wge(t){return Cte[0]=t,Cte[0]}function CCt(t){const e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[3]*t[3]+t[4]*t[4]+t[5]*t[5],r=t[6]*t[6]+t[7]*t[7]+t[8]*t[8];return!(Eg(e,1)&&Eg(n,1)&&Eg(r,1))}function RCt(t,e){return(t%e+e)%e}const Rte=Wge(34028234663852886e22);function MCt(t,e,n){if(n===void 0||+n==0)return Math[t](e);if(e=+e,n=+n,isNaN(e)||typeof n!="number"||n%1!=0)return NaN;let r=e.toString().split("e");return r=(e=Math[t](+(r[0]+"e"+(r[1]?+r[1]-n:-n)))).toString().split("e"),+(r[0]+"e"+(r[1]?+r[1]+n:n))}function GC(t){return vu(EB(t),0,255)}function UC(t,e){const n=t.toString(16).padStart(2,"0");return e?n.slice(0,1):n}let Jn=class $c{static blendColors(e,n,r,i=new $c){return i.r=Math.round(e.r+(n.r-e.r)*r),i.g=Math.round(e.g+(n.g-e.g)*r),i.b=Math.round(e.b+(n.b-e.b)*r),i.a=e.a+(n.a-e.a)*r,i._sanitize()}static fromRgb(e,n){const r=jge(e);return r?$c.fromArray(r,n):null}static fromHex(e,n=new $c){const r=Dge(e);return r?$c.fromArray(r,n):null}static fromArray(e,n=new $c){return n._set(Number(e[0]),Number(e[1]),Number(e[2]),Number(e[3])),isNaN(n.a)&&(n.a=1),n._sanitize()}static fromString(e,n){const r=$ge(e);return r?$c.fromArray(r,n):null}static fromJSON(e){return e!=null?new $c([e[0],e[1],e[2],(e[3]??255)/255]):void 0}static toUnitRGB(e){return e!=null?[e.r/255,e.g/255,e.b/255]:null}static toUnitRGBA(e,n){return e==null?null:(n??=[0,0,0,0],n[0]=e.r/255,n[1]=e.g/255,n[2]=e.b/255,n[3]=e.a!=null?e.a:1,n)}constructor(e){this.r=255,this.g=255,this.b=255,this.a=1,e&&this.setColor(e)}get isBright(){return .299*this.r+.587*this.g+.114*this.b>=127}setColor(e){return typeof e=="string"?$c.fromString(e,this):Array.isArray(e)?$c.fromArray(e,this):(this._set(e.r??0,e.g??0,e.b??0,e.a??1),e instanceof $c||this._sanitize()),this}toRgb(){return[this.r,this.g,this.b]}toRgba(){return[this.r,this.g,this.b,this.a]}toHex(e){const n=e?.capitalize??!1,r=e?.digits??6,i=r===3||r===4,s=r===4||r===8,o=`#${UC(this.r,i)}${UC(this.g,i)}${UC(this.b,i)}${s?UC(Math.round(255*this.a),i):""}`;return n?o.toUpperCase():o}toCss(e=!1){const n=this.r+", "+this.g+", "+this.b;return e?`rgba(${n}, ${this.a})`:`rgb(${n})`}toString(){return this.toCss(!0)}toJSON(){return this.toArray()}toArray(e=0){const n=GC(this.r),r=GC(this.g),i=GC(this.b);return e===0||this.a!==1?[n,r,i,GC(255*this.a)]:[n,r,i]}clone(){return new $c(this.toRgba())}hash(){return this.r<<24|this.g<<16|this.b<<8|255*this.a}equals(e){return e!=null&&e.r===this.r&&e.g===this.g&&e.b===this.b&&e.a===this.a}_sanitize(){return this.r=aw(this.r),this.g=aw(this.g),this.b=aw(this.b),this.a=Fge(this.a),this}_set(e,n,r,i){this.r=e,this.g=n,this.b=r,this.a=i}};Jn.prototype.declaredClass="esri.Color";let th=class extends Ot{constructor(e){super(e),this.getCollections=null}initialize(){this.addHandles(A$e(()=>this._refresh(),Ug))}destroy(){this.getCollections=null}_refresh(){const e=this.getCollections?.();if(e==null)return void this.removeAll();let n=0;for(const r of e)r!=null&&(n=this._processCollection(n,r));this.splice(n)}_createNewInstance(e){return new Ot(e)}_processCollection(e,n){if(!n)return e;const r=this.itemFilterFunction??(i=>!!i);for(const i of n)if(i){if(r(i)){const s=this.indexOf(i,e);s>=0?s!==e&&this.reorder(i,e):this.add(i,e),++e}if(this.getChildrenFunction){const s=this.getChildrenFunction(i);if(Array.isArray(s))for(const o of s)e=this._processCollection(e,o);else e=this._processCollection(e,s)}}return e}};x([E()],th.prototype,"getCollections",void 0),x([E()],th.prototype,"getChildrenFunction",void 0),x([E()],th.prototype,"itemFilterFunction",void 0),th=x([ue("esri.core.CollectionFlattener")],th);function mn(t,e={}){const n=t instanceof Ys?t:new Ys(t,e),{alwaysWriteDefaults:r,default:i,ignoreUnknown:s=!0,name:o,nonNullable:a,readOnly:l=!1}=e;return E({type:s?n.apiValues:String,json:{type:n.jsonValues,default:i,name:o,read:!l&&{reader:n.read},write:{writer:n.write,alwaysWriteDefaults:r}},nonNullable:a,readOnly:l})}var L9;let CM=L9=class extends qt{constructor(t){super(t),this.type="none"}clone(){return new L9({type:this.type})}};x([mn({none:"none",stayAbove:"stay-above"}),E({json:{write:{isRequired:!0}}})],CM.prototype,"type",void 0),CM=L9=x([ue("esri.ground.NavigationConstraint")],CM);const Hge=Symbol("GroundInstance");function OCt(t){return t!=null&&typeof t=="object"&&Hge in t}function qge(t){const e=EB(100*(1-t));return Math.max(0,Math.min(e,100))}function Kge(t){const e=1-t/100;return Math.max(0,Math.min(e,1))}var Mte,D9,Rae;let Fc=D9=(Rae=class extends o0(xI){constructor(t){super(t),this[Mte]=!0,this.parent=null,this.opacity=1,this.surfaceColor=null,this.navigationConstraint=null,this.layers=new Ot;const e=r=>{const{parent:i}=r;i&&i!==this&&"remove"in i&&i.remove?.(r),r.parent=this,r.type!=="elevation"&&r.type!=="base-elevation"&&kt.getLogger(this).error(`Layer '${r.title}, id:${r.id}' of type '${r.type}' is not supported as a ground layer and will therefore be ignored. Only layers of type 'elevation' are supported.`)},n=r=>{r.parent=null};this.addHandles([this.layers.on("after-add",r=>e(r.item)),this.layers.on("after-remove",r=>n(r.item))]),this.allLayers=new th({getCollections:()=>[this.layers,this.parent?.basemap?.groundLayers]})}removeChildLayer(t){this.layers.remove(t)}initialize(){this.when().catch(t=>{wa(t)||kt.getLogger(this).error("#load()","Failed to load ground",t)}),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}get integratedMeshGround(){const t=this.parent?.basemap?.groundLayers.at(0);return t?.replacesTerrain?t:null}destroy(){const t=this.layers.removeAll();for(const e of t)Di(e);this.layers.destroy()}normalizeCtorArgs(t){return t&&"resourceInfo"in t&&(this._set("resourceInfo",t.resourceInfo),delete(t={...t}).resourceInfo),t}get loaded(){return super.loaded}get layers(){return this._get("layers")}set layers(t){this._set("layers",Sd(t,this._get("layers")))}writeLayers(t,e,n,r){const i=[];t&&(r={...r,layerContainerType:"ground"},t.forEach(s=>{if("write"in s){const o={};t6e(s)().write(o,r)&&i.push(o)}else r?.messages&&r.messages.push(new Xe("layer:unsupported",`Layers (${s.title}, ${s.id}) of type '${s.declaredClass}' cannot be persisted in the ground`,{layer:s}))})),e.layers=i}load(t){return this.addResolvingPromise(this._loadFromSource(t)),Promise.resolve(this)}loadAll(){return Fpe(this,t=>{t(this.layers)})}async queryElevation(t,e){await this.load({signal:e?.signal});const{queryAll:n}=await _e(()=>import("./ElevationQuery-CenUEadC.js"),__vite__mapDeps([43,44]));return pi(e),n(this.layers.filter(Nte).toArray(),t,e)}async createElevationSampler(t,e){await this.load({signal:e?.signal});const{createSampler:n}=await _e(()=>import("./ElevationQuery-CenUEadC.js"),__vite__mapDeps([43,44]));return pi(e),n(this.layers.filter(Nte).toArray(),t,e)}clone(){const t={opacity:this.opacity,surfaceColor:Ze(this.surfaceColor),navigationConstraint:Ze(this.navigationConstraint),layers:this.layers.slice()};return this.loaded&&(t.loadStatus="loaded"),new D9({resourceInfo:this.resourceInfo}).set(t)}read(t,e){this.resourceInfo||this._set("resourceInfo",{data:t,context:e}),super.read(t,e)}_loadFromSource(t){const e=this.resourceInfo;return e?this._loadLayersFromJSON(e.data,e.context,t):Promise.resolve()}async _loadLayersFromJSON(t,e,n){const r=e?.origin||"web-scene",i=e?.portal||null,s=e?.url||null,{populateOperationalLayers:o}=await _e(async()=>{const{populateOperationalLayers:l}=await import("./layersCreator-BMyNPotq.js");return{populateOperationalLayers:l}},__vite__mapDeps([41,38,37,36,39,35,33,42]));pi(n);const a=[];if(t.layers&&Array.isArray(t.layers)){const l={context:{origin:r,url:s,portal:i,layerContainerType:"ground"},defaultLayerType:"ArcGISTiledElevationServiceLayer"};a.push(o(this.layers,t.layers,l))}await Promise.allSettled(a)}},Mte=Hge,Rae);function Nte(t){return t&&"createElevationSampler"in t}x([E()],Fc.prototype,"parent",void 0),x([E()],Fc.prototype,"integratedMeshGround",null),x([E({json:{read:!1,write:{isRequired:!0}}})],Fc.prototype,"layers",null),x([E()],Fc.prototype,"allLayers",void 0),x([er("layers")],Fc.prototype,"writeLayers",null),x([E({readOnly:!0})],Fc.prototype,"resourceInfo",void 0),x([E({type:Number,nonNullable:!0,range:{min:0,max:1},json:{type:Dr,read:{reader:Kge,source:"transparency"},write:{writer:(t,e)=>{e.transparency=qge(t)},target:"transparency"}}})],Fc.prototype,"opacity",void 0),x([E({type:Jn,json:{type:[Dr],write:(t,e)=>{e.surfaceColor=t.toJSON().slice(0,3)}}})],Fc.prototype,"surfaceColor",void 0),x([E({type:CM,json:{write:!0}})],Fc.prototype,"navigationConstraint",void 0),Fc=D9=x([ue("esri.Ground")],Fc);const sN=Fc,hze=Symbol("ClonableMixin"),vo=t=>{var i;var e;const n=t;let r=(i=class extends n{constructor(){super(...arguments),this[e]=!0}clone(s){const o=$g(this);Mfe(o,"unable to clone instance of non-accessor class");const a=o.metadata,l=o.store,c={},u=new Map;for(const f in a){const g=a[f],y=l?.originOf(f),_=g.clonable;if(g.readOnly||_===!1||y!==7&&y!==0&&y!==5&&y!==4)continue;const b=this[f];let T=null;if(typeof _=="function")T=_(b,s);else if(_==="reference")T=b;else if(T=G8(b,s),b!=null&&T==null)continue;y===0?u.set(f,T):c[f]=T}const h=new(Object.getPrototypeOf(this)).constructor(c);if(u.size){const f=$g(h)?.store;if(f)for(const[g,y]of u)f.set(g,y,0)}return h}},e=hze,i);return r=x([ue("esri.core.Clonable")],r),r},iW=vo(Kt),dze="randomUUID"in crypto;function AI(){if(dze)return crypto.randomUUID();const t=crypto.getRandomValues(new Uint16Array(8));t[3]=4095&t[3]|16384,t[4]=16383&t[4]|32768;const e=n=>t[n].toString(16).padStart(4,"0");return e(0)+e(1)+"-"+e(2)+"-"+e(3)+"-"+e(4)+"-"+e(5)+e(6)+e(7)}function LCt(){return`{${AI().toUpperCase()}}`}function DCt(){return`{${AI()}}`}function jCt(t){const e=t.toUpperCase();return t.startsWith("{")?e:`{${e}}`}const E_={Base64:0,Hex:1,String:2,Raw:3},lw=8,Yge=(1<<lw)-1;function tg(t,e){const n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}function fze(t){const e=[];for(let n=0,r=t.length*lw;n<r;n+=lw)e[n>>5]|=(t.charCodeAt(n/lw)&Yge)<<n%32;return e}function pze(t){const e=[];for(let n=0,r=32*t.length;n<r;n+=lw)e.push(String.fromCharCode(t[n>>5]>>>n%32&Yge));return e.join("")}function mze(t){const e="0123456789abcdef",n=[];for(let r=0,i=4*t.length;r<i;r++)n.push(e.charAt(t[r>>2]>>r%4*8+4&15)+e.charAt(t[r>>2]>>r%4*8&15));return n.join("")}function gze(t){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=[];for(let i=0,s=4*t.length;i<s;i+=3){const o=(t[i>>2]>>i%4*8&255)<<16|(t[i+1>>2]>>(i+1)%4*8&255)<<8|t[i+2>>2]>>(i+2)%4*8&255;for(let a=0;a<4;a++)8*i+6*a>32*t.length?r.push("="):r.push(n.charAt(o>>6*(3-a)&63))}return r.join("")}function yze(t,e){return t<<e|t>>>32-e}function WO(t,e,n,r,i,s){return tg(yze(tg(tg(e,t),tg(r,s)),i),n)}function Wo(t,e,n,r,i,s,o){return WO(e&n|~e&r,t,e,i,s,o)}function Ho(t,e,n,r,i,s,o){return WO(e&r|n&~r,t,e,i,s,o)}function qo(t,e,n,r,i,s,o){return WO(e^n^r,t,e,i,s,o)}function Ko(t,e,n,r,i,s,o){return WO(n^(e|~r),t,e,i,s,o)}function vze(t,e){t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;let n=1732584193,r=-271733879,i=-1732584194,s=271733878;for(let o=0;o<t.length;o+=16){const a=n,l=r,c=i,u=s;n=Wo(n,r,i,s,t[o],7,-680876936),s=Wo(s,n,r,i,t[o+1],12,-389564586),i=Wo(i,s,n,r,t[o+2],17,606105819),r=Wo(r,i,s,n,t[o+3],22,-1044525330),n=Wo(n,r,i,s,t[o+4],7,-176418897),s=Wo(s,n,r,i,t[o+5],12,1200080426),i=Wo(i,s,n,r,t[o+6],17,-1473231341),r=Wo(r,i,s,n,t[o+7],22,-45705983),n=Wo(n,r,i,s,t[o+8],7,1770035416),s=Wo(s,n,r,i,t[o+9],12,-1958414417),i=Wo(i,s,n,r,t[o+10],17,-42063),r=Wo(r,i,s,n,t[o+11],22,-1990404162),n=Wo(n,r,i,s,t[o+12],7,1804603682),s=Wo(s,n,r,i,t[o+13],12,-40341101),i=Wo(i,s,n,r,t[o+14],17,-1502002290),r=Wo(r,i,s,n,t[o+15],22,1236535329),n=Ho(n,r,i,s,t[o+1],5,-165796510),s=Ho(s,n,r,i,t[o+6],9,-1069501632),i=Ho(i,s,n,r,t[o+11],14,643717713),r=Ho(r,i,s,n,t[o],20,-373897302),n=Ho(n,r,i,s,t[o+5],5,-701558691),s=Ho(s,n,r,i,t[o+10],9,38016083),i=Ho(i,s,n,r,t[o+15],14,-660478335),r=Ho(r,i,s,n,t[o+4],20,-405537848),n=Ho(n,r,i,s,t[o+9],5,568446438),s=Ho(s,n,r,i,t[o+14],9,-1019803690),i=Ho(i,s,n,r,t[o+3],14,-187363961),r=Ho(r,i,s,n,t[o+8],20,1163531501),n=Ho(n,r,i,s,t[o+13],5,-1444681467),s=Ho(s,n,r,i,t[o+2],9,-51403784),i=Ho(i,s,n,r,t[o+7],14,1735328473),r=Ho(r,i,s,n,t[o+12],20,-1926607734),n=qo(n,r,i,s,t[o+5],4,-378558),s=qo(s,n,r,i,t[o+8],11,-2022574463),i=qo(i,s,n,r,t[o+11],16,1839030562),r=qo(r,i,s,n,t[o+14],23,-35309556),n=qo(n,r,i,s,t[o+1],4,-1530992060),s=qo(s,n,r,i,t[o+4],11,1272893353),i=qo(i,s,n,r,t[o+7],16,-155497632),r=qo(r,i,s,n,t[o+10],23,-1094730640),n=qo(n,r,i,s,t[o+13],4,681279174),s=qo(s,n,r,i,t[o],11,-358537222),i=qo(i,s,n,r,t[o+3],16,-722521979),r=qo(r,i,s,n,t[o+6],23,76029189),n=qo(n,r,i,s,t[o+9],4,-640364487),s=qo(s,n,r,i,t[o+12],11,-421815835),i=qo(i,s,n,r,t[o+15],16,530742520),r=qo(r,i,s,n,t[o+2],23,-995338651),n=Ko(n,r,i,s,t[o],6,-198630844),s=Ko(s,n,r,i,t[o+7],10,1126891415),i=Ko(i,s,n,r,t[o+14],15,-1416354905),r=Ko(r,i,s,n,t[o+5],21,-57434055),n=Ko(n,r,i,s,t[o+12],6,1700485571),s=Ko(s,n,r,i,t[o+3],10,-1894986606),i=Ko(i,s,n,r,t[o+10],15,-1051523),r=Ko(r,i,s,n,t[o+1],21,-2054922799),n=Ko(n,r,i,s,t[o+8],6,1873313359),s=Ko(s,n,r,i,t[o+15],10,-30611744),i=Ko(i,s,n,r,t[o+6],15,-1560198380),r=Ko(r,i,s,n,t[o+13],21,1309151649),n=Ko(n,r,i,s,t[o+4],6,-145523070),s=Ko(s,n,r,i,t[o+11],10,-1120210379),i=Ko(i,s,n,r,t[o+2],15,718787259),r=Ko(r,i,s,n,t[o+9],21,-343485551),n=tg(n,a),r=tg(r,l),i=tg(i,c),s=tg(s,u)}return[n,r,i,s]}function _ze(t,e=E_.Hex){const n=e||E_.Base64,r=vze(fze(t),t.length*lw);switch(n){case E_.Raw:return r;case E_.Hex:return mze(r);case E_.String:return pze(r);case E_.Base64:return gze(r)}}function xze(t){return t&&"getAtOrigin"in t&&"originOf"in t}function j9(t){return sW[wze(t)]||Eze}function wze(t){return t.type==="json"?"application/json":t.type==="blob"?t.blob.type:bze(t.url)}function bze(t){const e=Tfe(t);return $9[e]||Xge}const sW={},Xge="text/plain",Eze=sW[Xge],$9={png:"image/png",jpeg:"image/jpeg",jpg:"image/jpg",bmp:"image/bmp",gif:"image/gif",json:"application/json",txt:"text/plain",xml:"application/xml",svg:"image/svg+xml",zip:"application/zip",pbf:"application/vnd.mapbox-vector-tile",gz:"application/gzip","bin.gz":"application/octet-stream"};for(const t in $9)sW[$9[t]]=t;function Sze(t){const e=t?.origins??[void 0];return(n,r)=>{const i=Tze(t,n,r);for(const s of e){const o=TB(n,s,r);for(const a in i)o[a]=i[a]}}}function Tze(t,e,n){if(t?.type==="resource")return kze(t,e,n);switch(t?.type??"other"){case"other":return{read:!0,write:!0};case"url":{const{read:r,write:i}=cje;return{read:r,write:i}}}}function kze(t,e,n){const r=yI(e,n);return{type:String,read:(i,s,o)=>{const a=TO(i,s,o);return r.type===String?a:typeof r.type=="function"?new r.type({url:a}):void 0},write:{isRequired:r.json?.write?.isRequired,writer(i,s,o,a){if(!a?.resources)return typeof i=="string"?void(s[o]=y2(i,a)):void(s[o]=i.write({},a));const l=Pze(i),c=y2(l,{...a,verifyItemRelativeUrls:a?.verifyItemRelativeUrls?{writtenUrls:a.verifyItemRelativeUrls.writtenUrls,rootPath:void 0}:void 0},1),u=r.type!==String&&(!xze(this)||a?.origin&&this.originIdOf(n)>_B(a.origin)),h={object:this,propertyName:n,value:i,targetUrl:c,dest:s,targetPropertyName:o,context:a,params:t};a?.portalItem&&c&&!El(c)?u&&t?.contentAddressed?F9(h):u?Aze(h):Ize(h):a?.portalItem&&(c==null||Lfe(c)!=null||dI(c)||u)?F9(h):s[o]=c}}}}function F9(t){const{targetUrl:e,params:n,value:r,context:i,dest:s,targetPropertyName:o}=t;if(!i.portalItem)return;const a=Dfe(e),l=Jge(r,e,i);if(n?.contentAddressed&&l.type!=="json")return void i.messages?.push(new Xe("persistable:contentAddressingUnsupported",`Property "${o}" is trying to serializing a resource with content of type ${l.type} with content addressing. Content addressing is only supported for json resources.`,{content:l}));const c=n?.contentAddressed&&l.type==="json"?_ze(l.jsonString):a?.filename??AI(),u=hI(n?.prefix??a?.prefix,c),h=`${u}.${j9(l)}`;if(n?.contentAddressed&&i.resources&&l.type==="json"){const y=i.resources.toKeep.find(({resource:_})=>_.path===h)??i.resources.toAdd.find(({resource:_})=>_.path===h);if(y)return void(s[o]=y.resource.itemRelativeUrl)}const f=i.portalItem.resourceFromPath(h);dI(e)&&i.resources&&i.resources.pendingOperations.push(D6e(e).then(y=>{f.path=`${u}.${j9({type:"blob",blob:y})}`,s[o]=f.itemRelativeUrl}).catch(()=>{}));const g=n?.compress??!1;i.resources&&Zge({...t,resource:f,content:l,compress:g,updates:i.resources.toAdd}),s[o]=f.itemRelativeUrl}function Aze(t){const{context:e,targetUrl:n,params:r,value:i,dest:s,targetPropertyName:o}=t;if(!e.portalItem)return;const a=e.portalItem.resourceFromPath(n),l=Jge(i,n,e),c=j9(l),u=Tfe(a.path),h=r?.compress??!1;c===u?(e.resources&&Zge({...t,resource:a,content:l,compress:h,updates:e.resources.toUpdate}),s[o]=n):F9(t)}function Ize({context:t,targetUrl:e,dest:n,targetPropertyName:r}){t.portalItem&&t.resources&&(t.resources.toKeep.push({resource:t.portalItem.resourceFromPath(e),compress:!1}),n[r]=e)}function Zge({object:t,propertyName:e,updates:n,resource:r,content:i,compress:s}){const o=a=>{Cze(t,e,a)};n.push({resource:r,content:i,compress:s,finish:o})}function Jge(t,e,n){return typeof t=="string"?{type:"url",url:e}:{type:"json",jsonString:JSON.stringify(t.toJSON(n))}}function Pze(t){return t==null?null:typeof t=="string"?t:t.url}function Cze(t,e,n){typeof t[e]=="string"?t[e]=n.url:t[e].url=n.url}let RM=class extends vo(qt){constructor(e){super(e),this.color=null}};x([E({type:Jn,json:{type:[Dr],write:!0}})],RM.prototype,"color",void 0),RM=x([ue("esri.effects.FocusAreaOutline")],RM);const Rze=RM;function FCt(t){const e=[];for(t.reset();t.nextPath();){const n=[];for(;t.nextPoint();)n.push([t.x,t.y]);e.push(n)}return t.reset(),e}function Mze(t){const e=[];for(;t.nextPoint();)e.push([t.x,t.y]);return t.seekPathStart(),e}function VCt(t){if(!t)return null;if(Array.isArray(t))return t;const e=t.hasZ,n=t.hasM;if(t.type==="point")return n&&e?[t.x,t.y,t.z,t.m]:e?[t.x,t.y,t.z]:n?[t.x,t.y,t.m]:[t.x,t.y];if(t.type==="polygon")return t.rings.slice();if(t.type==="polyline")return t.paths.slice();if(t.type==="multipoint")return t.points.map(r=>[r]);if(t.type==="extent"){const r=t.clone().normalize();if(!r)return null;let i=!1,s=!1;return r.forEach(o=>{o.hasZ&&(i=!0),o.hasM&&(s=!0)}),r.map(o=>{const a=[[o.xmin,o.ymin],[o.xmin,o.ymax],[o.xmax,o.ymax],[o.xmax,o.ymin],[o.xmin,o.ymin]];if(i&&o.hasZ){const l=.5*(o.zmax-o.zmin);for(let c=0;c<a.length;c++)a[c].push(l)}if(s&&o.hasM){const l=.5*(o.mmax-o.mmin);for(let c=0;c<a.length;c++)a[c].push(l)}return a})}return null}function HO(t,e){const n=e[0]-t[0],r=e[1]-t[1];if(t.length>2&&e.length>2){const i=t[2]-e[2];return Math.sqrt(n*n+r*r+i*i)}return Math.sqrt(n*n+r*r)}function Qge(t,e,n){const r=t[0]+n*(e[0]-t[0]),i=t[1]+n*(e[1]-t[1]);return t.length>2&&e.length>2?[r,i,t[2]+n*(e[2]-t[2])]:[r,i]}function Nze(t,e,n,r){return Oze(t,e,n[r],n[r+1])}function Oze(t,e,n,r){const[i,s]=e,[o,a]=n,[l,c]=r,u=l-o,h=c-a,f=u*u+h*h,g=(i-o)*u+(s-a)*h,y=Math.min(1,Math.max(0,g/f));return t[0]=o+u*y,t[1]=a+h*y,t}function zCt(t,e,n,r,i,s){let o=n,a=r,l=i-o,c=s-a;if(l!==0||c!==0){const u=((t-o)*l+(e-a)*c)/(l*l+c*c);u>1?(o=i,a=s):u>0&&(o+=l*u,a+=c*u)}return l=t-o,c=e-a,l*l+c*c}function e0e(t,e){return Qge(t,e,.5)}function GCt(t){const e=t.length;let n=0;for(let r=0;r<e-1;++r)n+=HO(t[r],t[r+1]);return n}function UCt(t,e){if(e<=0)return t[0];const n=t.length;let r=0;for(let i=0;i<n-1;++i){const s=HO(t[i],t[i+1]);if(e-r<s){const o=(e-r)/s;return Qge(t[i],t[i+1],o)}r+=s}return t[n-1]}function t0e(t,e=0,n=1){let r=0;const i=t.length;let s=t[0];for(let o=1;o<i;o++){const a=t[o];r+=(a[e]-s[e])*(a[n]+s[n]),s=a}if(n0e(t)){const o=t[0];r+=(o[e]-s[e])*(o[n]+s[n])}return r>=0}function n0e(t){const e=t.length;return e>0&&!vO(t[0],t[e-1])}function BCt(t){"rings"in t&&(Lze(t),Dze(t))}function Lze(t){if("rings"in t)for(const e of t.rings)n0e(e)&&e.push(e[0].slice())}function Dze(t){if(!("rings"in t)||t.rings.length===0||t0e(t.rings[0]))return!1;for(const e of t.rings)e.reverse();return!0}function WCt(t){return t.type!=="polygon"&&t.type!=="polyline"||jze(t.type==="polygon"?t.rings:t.paths,t.spatialReference),t}function jze(t,e){const n=za(e);if(!n)return;const r=n.valid[0],i=n.valid[1],s=i-r;for(const o of t){let a=1/0,l=-1/0;for(const u of o){const h=$ze(u[0],r,i);a=Math.min(a,h),l=Math.max(l,h),u[0]=h}const c=l-a;s-c<c&&o.forEach(u=>{u[0]<0&&(u[0]+=s)})}}function $ze(t,e,n){const r=n-e;return t<e?n-(e-t)%r:t>n?e+(t-e)%r:t}function HCt(t,e){if(t===e)return!0;if(t.type!==e.type)return!1;if(t.type==="point"||t.type==="mesh"||t.type==="extent")return!0;if(t.type==="multipoint")return t.points.length===e.points.length;const[n,r]=t.type==="polyline"?[t.paths,e.paths]:[t.rings,e.rings];return n.length===r.length&&n.every((i,s)=>i.length===r[s].length)}function qCt(t){return t?t.hasZ?[t.xmax-t.xmin/2,t.ymax-t.ymin/2,t.zmax-t.zmin/2]:[t.xmax-t.xmin/2,t.ymax-t.ymin/2]:null}function Fze(t){return zze(t.rings,t.hasZ??!1)}function Vze(t){const e=Fze(t);if(!e)return null;const{hasZ:n,spatialReference:r}=t,[i,s,o]=e;return isNaN(i)||isNaN(s)||n&&isNaN(o)?null:{x:i,y:s,z:n?o:void 0,spatialReference:r}}function zze(t,e){if(!t?.length)return null;const n=[],r=[],i=e?[1/0,-1/0,1/0,-1/0,1/0,-1/0]:[1/0,-1/0,1/0,-1/0];for(let s=0,o=t.length;s<o;s++){const a=r0e(t[s],e,i);a&&r.push(a)}if(r.sort((s,o)=>{let a=s[2]-o[2];return a===0&&e&&(a=s[4]-o[4]),a}),r.length&&(n[0]=r[0][0],n[1]=r[0][1],e&&(n[2]=r[0][3]),(n[0]<i[0]||n[0]>i[1]||n[1]<i[2]||n[1]>i[3]||e&&(n[2]<i[4]||n[2]>i[5]))&&(n.length=0)),!n.length){const s=t[0]&&t[0].length?Gze(t[0],e):null;if(!s)return null;n[0]=s[0],n[1]=s[1],e&&s.length>2&&(n[2]=s[2])}return n}function r0e(t,e,n){let r=0,i=0,s=0,o=0,a=0;const l=t.length?t[0][0]:0,c=t.length?t[0][1]:0,u=t.length&&e?t[0][2]:0;for(let f=0;f<t.length;f++){const g=t[f],y=t[(f+1)%t.length],[_,b,T]=g,A=_-l,I=b-c,[P,R,D]=y,C=P-l,M=R-c,O=A*M-C*I;if(o+=O,r+=(A+C)*O,i+=(I+M)*O,e&&g.length>2&&y.length>2){const j=T-u,V=D-u,U=A*V-C*j;s+=(j+V)*U,a+=U}_<n[0]&&(n[0]=_),_>n[1]&&(n[1]=_),b<n[2]&&(n[2]=b),b>n[3]&&(n[3]=b),e&&(T<n[4]&&(n[4]=T),T>n[5]&&(n[5]=T))}if(o>0&&(o*=-1),a>0&&(a*=-1),!o)return null;o*=.5,a*=.5;const h=[r/(6*o)+l,i/(6*o)+c,o];return e&&(n[4]===n[5]||a===0?(h[3]=(n[4]+n[5])/2,h[4]=0):(h[3]=s/(6*a)+u,h[4]=a)),h}function KCt(t,e){let n=0,r=0,i=0;t.nextPoint();const s=t.pathSize?t.x:0,o=t.pathSize?t.y:0;for(let a=0;a<t.pathSize;a++){t.seekInPath(a);const l=[t.x,t.y];t.seekInPath((a+1)%t.pathSize);const c=[t.x,t.y],[u,h]=l,f=u-s,g=h-o,[y,_]=c,b=y-s,T=_-o,A=f*T-b*g;i+=A,n+=(f+b)*A,r+=(g+T)*A,u<e[0]&&(e[0]=u),u>e[1]&&(e[1]=u),h<e[2]&&(e[2]=h),h>e[3]&&(e[3]=h)}return i>0&&(i*=-1),i?(i*=.5,[n/(6*i)+s,r/(6*i)+o,i]):null}function Gze(t,e){const n=e?[0,0,0]:[0,0],r=e?[0,0,0]:[0,0];let i=0,s=0,o=0,a=0;for(let l=0,c=t.length;l<c-1;l++){const u=t[l],h=t[l+1];if(u&&h){n[0]=u[0],n[1]=u[1],r[0]=h[0],r[1]=h[1],e&&u.length>2&&h.length>2&&(n[2]=u[2],r[2]=h[2]);const f=HO(n,r);if(f){i+=f;const g=e0e(u,h);s+=f*g[0],o+=f*g[1],e&&g.length>2&&(a+=f*g[2])}}}return i>0?e?[s/i,o/i,a/i]:[s/i,o/i]:t.length?t[0]:null}function Uze(t){const{hasZ:e,totalSize:n}=t;if(n===0)return null;const r=[],i=[],s=e?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY];for(t.reset();t.nextPath();){const o=r0e(Mze(t),t.hasZ,s);o&&i.push(o)}if(i.sort((o,a)=>{let l=o[2]-a[2];return l===0&&e&&(l=o[4]-a[4]),l}),i.length&&(r[0]=i[0][0],r[1]=i[0][1],e&&(r[2]=i[0][3]),(r[0]<s[0]||r[0]>s[1]||r[1]<s[2]||r[1]>s[3]||e&&(r[2]<s[4]||r[2]>s[5]))&&(r.length=0)),!r.length){t.reset(),t.nextPath();const o=t.pathSize?Bze(t):null;if(!o)return null;r[0]=o[0],r[1]=o[1],e&&o.length>2&&(r[2]=o[2])}return r}function Bze(t){const{hasZ:e}=t,n=e?[0,0,0]:[0,0],r=e?[0,0,0]:[0,0];let i=0,s=0,o=0,a=0;if(t.nextPoint()){let l=t.x,c=t.y,u=t.z;for(;t.nextPoint();){const h=t.x,f=t.y,g=t.z;n[0]=l,n[1]=c,r[0]=h,r[1]=f,e&&(n[2]=u,r[2]=g);const y=HO(n,r);if(y){i+=y;const _=e0e(n,r);s+=y*_[0],o+=y*_[1],e&&_.length>2&&(a+=y*_[2])}l=h,c=f,u=g}}return i>0?e?[s/i,o/i,a/i]:[s/i,o/i]:t.pathSize?(t.seekPathStart(),t.nextPoint(),[t.x,t.y]):null}const Wze=1e-6;function YCt(t){let e=0;for(t.reset();t.nextPath();)e+=t.getCurrentRingArea();if(e<Wze){const i=Uze(t);return i?[i[0],i[1]]:null}const n=[0,0];if(t.reset(),!t.nextPath()||!t.nextPoint())return null;const r=[t.x,t.y];for(t.reset();t.nextPath();)qze(n,r,t);return n[0]*=1/e,n[1]*=1/e,n[0]+=r[0],n[1]+=r[1],n}const Hze=1/3;function qze(t,e,n){if(!t||!n||n.pathSize<3)return null;n.nextPoint();const r=n.x,i=n.y;n.nextPoint();let s,o=n.x-r,a=n.y-i,l=0,c=0;for(;n.nextPoint();)l=n.x-r,c=n.y-i,s=.5*Hze*(l*a-c*o),t[0]+=s*(o+l),t[1]+=s*(a+c),o=l,a=c;const u=n.getCurrentRingArea(),h=[r,i];return h[0]-=e[0],h[1]-=e[1],h[0]*=u,h[1]*=u,t[0]+=h[0],t[1]+=h[1],t}function xl(t=Qze){return[t[0],t[1],t[2],t[3]]}function i0e(t,e){return t!==e&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3]),t}function Kze(t,e,n,r,i=xl()){return i[0]=t,i[1]=e,i[2]=n,i[3]=r,i}function XCt(t,e=xl()){return e[0]=t.xmin,e[1]=t.ymin,e[2]=t.xmax,e[3]=t.ymax,e}function Yze(t,e,n=new Vn){return n.xmin=t[0],n.ymin=t[1],n.xmax=t[2],n.ymax=t[3],n.spatialReference=e,n}function tu(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function Xze(t,e){e<t[0]&&(t[0]=e),e>t[2]&&(t[2]=e)}function Zze(t,e){e<t[1]&&(t[1]=e),e>t[3]&&(t[3]=e)}function ZCt(t,e,n){if(e!=null)if("length"in e)z9(e)?(n[0]=Math.min(t[0],e[0]),n[1]=Math.min(t[1],e[1]),n[2]=Math.max(t[2],e[2]),n[3]=Math.max(t[3],e[3])):e.length!==2&&e.length!==3||(n[0]=Math.min(t[0],e[0]),n[1]=Math.min(t[1],e[1]),n[2]=Math.max(t[2],e[0]),n[3]=Math.max(t[3],e[1]));else switch(e.type){case"extent":n[0]=Math.min(t[0],e.xmin),n[1]=Math.min(t[1],e.ymin),n[2]=Math.max(t[2],e.xmax),n[3]=Math.max(t[3],e.ymax);break;case"point":n[0]=Math.min(t[0],e.x),n[1]=Math.min(t[1],e.y),n[2]=Math.max(t[2],e.x),n[3]=Math.max(t[3],e.y)}else i0e(n,t)}function JCt(t,e,n=t){const r=e.length;let i=t[0],s=t[1],o=t[2],a=t[3];for(let l=0;l<r;l++){const c=e[l];i=Math.min(i,c[0]),s=Math.min(s,c[1]),o=Math.max(o,c[0]),a=Math.max(a,c[1])}return n[0]=i,n[1]=s,n[2]=o,n[3]=a,n}function QCt(t){for(let e=0;e<4;e++)if(!isFinite(t[e]))return!1;return!0}function oW(t){return t==null||t[0]>=t[2]?0:t[2]-t[0]}function aW(t){return t==null||t[1]>=t[3]?0:t[3]-t[1]}function eRt(t){return oW(t)*aW(t)}function tRt(t,e=[0,0]){return e[0]=(t[0]+t[2])/2,e[1]=(t[1]+t[3])/2,e}function nRt(t){const e=oW(t),n=aW(t);return Math.sqrt(e*e+n*n)}function rRt(t,e){return!!t&&V9(t,e.x,e.y)}function V9(t,e,n){return e>=t[0]&&n>=t[1]&&e<=t[2]&&n<=t[3]}function iRt(t,e){return Math.max(e[0],t[0])<=Math.min(e[2],t[2])&&Math.max(e[1],t[1])<=Math.min(e[3],t[3])}function sRt(t,e,n){return Math.max(e[0],t[0])-n<=Math.min(e[2],t[2])&&Math.max(e[1],t[1])-n<=Math.min(e[3],t[3])}function Jze(t,e){return e[0]>=t[0]&&e[2]<=t[2]&&e[1]>=t[1]&&e[3]<=t[3]}function oRt(t,e,n,r){return r??=t,r[0]=t[0]+e,r[1]=t[1]+n,r[2]=t[2]+e,r[3]=t[3]+n,r}function aRt(t){return t?i0e(t,Ote):xl(Ote)}function z9(t){return t!=null&&t.length===4}function lRt(t,e){return z9(t)&&z9(e)?t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]:t===e}const Ote=[1/0,1/0,-1/0,-1/0],Qze=[0,0,0,0];let lW=1e-6;function Sl(){return lW}function eGe(t){lW=t}const cW=Math.random,tGe=Math.PI/180,nGe=180/Math.PI;function uW(t){return t*tGe}function rGe(t){return t*nGe}function iGe(t,e){return Math.abs(t-e)<=lW*Math.max(1,Math.abs(t),Math.abs(e))}Object.freeze(Object.defineProperty({__proto__:null,RANDOM:cW,equals:iGe,getEpsilon:Sl,setEpsilon:eGe,toDegree:rGe,toRadian:uW},Symbol.toStringTag,{value:"Module"}));function cw(t,e){return t[0]=e[0],t[1]=e[1],t}function lo(t,e,n){return t[0]=e,t[1]=n,t}function s0e(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function Hk(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function o0e(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t}function a0e(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t}function sGe(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t}function oGe(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t}function aGe(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t}function lGe(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t}function cGe(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t}function II(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}function uGe(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t}function qO(t,e){const n=e[0]-t[0],r=e[1]-t[1];return Math.sqrt(n*n+r*r)}function qk(t,e){const n=e[0]-t[0],r=e[1]-t[1];return n*n+r*r}function oN(t){const e=t[0],n=t[1];return Math.sqrt(e*e+n*n)}function l0e(t){const e=t[0],n=t[1];return e*e+n*n}function c0e(t,e){return t[0]=-e[0],t[1]=-e[1],t}function hGe(t,e){return t[0]=1/e[0],t[1]=1/e[1],t}function G9(t,e){const n=e[0],r=e[1];let i=n*n+r*r;return i>0&&(i=1/Math.sqrt(i),t[0]=e[0]*i,t[1]=e[1]*i),t}function u0e(t,e){return t[0]*e[0]+t[1]*e[1]}function h0e(t,e,n){const r=e[0]*n[1]-e[1]*n[0];return t[0]=t[1]=0,t[2]=r,t}function dGe(t,e,n,r){const i=e[0],s=e[1];return t[0]=i+r*(n[0]-i),t[1]=s+r*(n[1]-s),t}function fGe(t,e=1){const n=2*cW()*Math.PI;return t[0]=Math.cos(n)*e,t[1]=Math.sin(n)*e,t}function pGe(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t}function ld(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i+n[4],t[1]=n[1]*r+n[3]*i+n[5],t}function MM(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[3]*i+n[6],t[1]=n[1]*r+n[4]*i+n[7],t}function mGe(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t}function gGe(t,e,n,r){const i=e[0]-n[0],s=e[1]-n[1],o=Math.sin(r),a=Math.cos(r);return t[0]=i*a-s*o+n[0],t[1]=i*o+s*a+n[1],t}function yGe(t,e){const n=t[0],r=t[1],i=e[0],s=e[1];let o=n*n+r*r;o>0&&(o=1/Math.sqrt(o));let a=i*i+s*s;a>0&&(a=1/Math.sqrt(a));const l=(n*i+r*s)*o*a;return l>1?0:l<-1?Math.PI:Math.acos(l)}function vGe(t){return"vec2("+t[0]+", "+t[1]+")"}function _Ge(t,e){return t[0]===e[0]&&t[1]===e[1]}function xGe(t,e){const n=t[0],r=t[1],i=e[0],s=e[1],o=Sl();return Math.abs(n-i)<=o*Math.max(1,Math.abs(n),Math.abs(i))&&Math.abs(r-s)<=o*Math.max(1,Math.abs(r),Math.abs(s))}function wGe(t,e,n,r,i){let s=e[0]-n[0],o=e[1]-n[1];const a=(r[0]*s+r[1]*o)*(i-1);return s=r[0]*a,o=r[1]*a,t[0]=e[0]+s,t[1]=e[1]+o,t}const bGe=oN,hW=Hk,EGe=o0e,SGe=a0e,TGe=qO,kGe=qk,AGe=l0e;Object.freeze(Object.defineProperty({__proto__:null,add:s0e,angle:yGe,ceil:sGe,copy:cw,cross:h0e,dist:TGe,distance:qO,div:SGe,divide:a0e,dot:u0e,equals:xGe,exactEquals:_Ge,floor:oGe,inverse:hGe,len:bGe,length:oN,lerp:dGe,max:lGe,min:aGe,mul:EGe,multiply:o0e,negate:c0e,normalize:G9,projectAndScale:wGe,random:fGe,rotate:gGe,round:cGe,scale:II,scaleAndAdd:uGe,set:lo,sqrDist:kGe,sqrLen:AGe,squaredDistance:qk,squaredLength:l0e,str:vGe,sub:hW,subtract:Hk,transformMat2:pGe,transformMat2d:ld,transformMat3:MM,transformMat4:mGe},Symbol.toStringTag,{value:"Module"}));function Ff(t,e,n,r){return t[0]=e[0]*(1-r)+n[0]*r,t[1]=e[1]*(1-r)+n[1]*r,t}function $a(t,e){return qk(t,e)}function cRt(t,e,n){const r=$a(e,n);if(r===0)return $a(e,t);const i=(e[0]-t[0])*(n[1]-t[1])-(e[1]-t[1])*(n[0]-t[0]);return i*i/r}function IGe(t,e,n,r,i){const[s,o]=e,[a,l]=n,[c,u]=r,[h,f]=i,g=(s-a)*(u-f)-(o-l)*(c-h);if(g===0)return null;const y=(s*l-o*a)*(c-h)-(s-a)*(c*f-u*h),_=(s*l-o*a)*(u-f)-(o-l)*(c*f-u*h);return t[0]=y/g,t[1]=_/g,t}const ch=2*Math.PI;function s1(t,e){const n=Math.atan2(t,e);return n<0?n+ch:n}function d0e(t){return Math.abs(t)%ch}function Lte(t){const e=d0e(t);return e<Math.PI?e:ch-e}function KO(t,e){return{min:Math.min(t,e),max:Math.max(t,e)}}function f0e(t,e,n,r){if(Eg(d0e(t-e),0))return n?[t,t]:[t,r?t-ch:t+ch];const[i,s]=r?[t-ch,t]:[t,t+ch];return[t,PI({min:i,max:s},e)]}function PI({min:t,max:e},n){let r;return r=e-n,r>=ch?(r-=r%ch,n+r):(r=n-t,r>=ch?(r-=r%ch,n-r):n)}function PGe(t,e){const n=PI(t,e);return n>t.min&&n<t.max?n:Lte(n-t.min)<Lte(n-t.max)?t.min:t.max}function p0e(t,e,n,r=10){return e.map(i=>{let s=i;for(let o=0;o<r;o++){const[a,l,c,u,h,f]=n(s),g=t[0]-a,y=t[1]-l,_=-c,b=-u;s+=-(2*g*_+2*y*b)/(2*_*_+2*g*-h+2*b*b+2*y*-f||1e-6)}return s})}const CGe=[0,0];function m0e(t){const e=1-t,n=e*e,r=t*t;return[n*e,3*t*n,3*r*e,r*t]}function U9(t,e,n,r,i){const[s,o,a,l]=m0e(i);return[t[0]*s+e[0]*o+n[0]*a+r[0]*l,t[1]*s+e[1]*o+n[1]*a+r[1]*l]}function Dte(t,e,n,r,i){const[s,o,a,l]=m0e(i);return t*s+e*o+n*a+r*l}function uRt(t,e,n){const r=t,[i,s,o]=e.b;return U9(r,s,o,i,n)}function RGe(t,e,n){const r=t,[i,s,o]=e.b,a=Ff([0,0],r,s,n),l=Ff(CGe,s,o,n),c=Ff([0,0],o,i,n),u=Ff([0,0],a,l,n),h=Ff([0,0],l,c,n);return[{b:[Ff([],u,h,n),a,u]},{b:[[...i],h,c]}]}function hRt(t,e,n){const r=t,[i,s,o]=e.b,a=p0e(n,[.1,.5,.9],h=>{const f=1-h,[g,y]=U9(r,s,o,i,h);return[g,y,3*f*f*(s[0]-r[0])+6*f*h*(o[0]-s[0])+3*h*h*(i[0]-o[0]),3*f*f*(s[1]-r[1])+6*f*h*(o[1]-s[1])+3*h*h*(i[1]-o[1]),6*f*(o[0]-2*s[0]+r[0])+6*h*(i[0]-2*o[0]+s[0]),6*f*(o[1]-2*s[1]+r[1])+6*h*(i[1]-2*o[1]+s[1])]}).map(h=>Math.min(1,Math.max(0,h)));a.push(0,1);let l=1/0;const c=a.map(h=>{const f=U9(r,s,o,i,h),[g,y]=f,_=n[0]-g,b=n[1]-y,T=Math.sqrt(_*_+b*b);return l=Math.min(T,l),{t:h,curvePoint:f,distance:T}}),u=[];for(const h of c){const{t:f,distance:g}=h;Bge(g,l)&&!u.some(({t:y})=>Eg(y,f))&&u.push(h)}return u}function MGe(t,e,n){const r=e,[i,s,o]=n.b;if(tu(t,r),tu(t,i),V9(t,s[0],s[1])&&V9(t,o[0],o[1]))return t;for(const a of jte(r[0],s[0],o[0],i[0]))a>0&&a<1&&Xze(t,Dte(r[0],s[0],o[0],i[0],a));for(const a of jte(r[1],s[1],o[1],i[1]))a>0&&a<1&&Zze(t,Dte(r[1],s[1],o[1],i[1],a));return t}function jte(t,e,n,r){const i=3*(3*(e-n)-t+r),s=6*(t-2*e+n),o=3*(e-t);if(i===0)return s!==0?[-o/s]:[];const a=Math.sqrt(s*s-4*i*o);return[(-s+a)/(2*i),(-s-a)/(2*i)]}function dRt(t,e,n){let i=0,s=[e];for(let o=0;o<16;o++){let a=t;const l=[];for(const u of s)l.push(...RGe(a,u,.5)),a=u.b[0];s=l,a=t,i=0;let c=0;for(const u of s){const[h,f,g]=u.b,y=Math.sqrt($a(a,h));i+=(y+(Math.sqrt($a(a,f))+Math.sqrt($a(f,g))+Math.sqrt($a(g,h))))/2,c+=y,a=h}if(i-c<n)return i}return i}function NGe(t,e,n){const[r,i]=t,[s,o]=e,[a,l]=n,[c,u]=[s-r,o-i];let h=c*(a-r)+u*(l-i);h/=c**2+u**2,h=vu(h,0,1);const f=Ff([0,0],t,e,h);return{t:h,curvePoint:f,distance:Math.sqrt($a(f,n))}}let g0e=class{constructor(e,n,r,i,s,o){this.cx=e,this.cy=n,this.radius=r,this.thetaStart=i,this.thetaEnd=s,this.isInvalid=o}get startPoint(){const{cx:e,cy:n,radius:r,thetaStart:i}=this;return[e+r*Math.cos(i),n+r*Math.sin(i)]}get endPoint(){const{cx:e,cy:n,radius:r,thetaEnd:i}=this;return[e+r*Math.cos(i),n+r*Math.sin(i)]}};function aN(t,e){const{cx:n,cy:r,radius:i}=t;return[n+i*Math.cos(e),r+i*Math.sin(e)]}function NM(t,e){if(t.isInvalid)return Ff([0,0],t.startPoint,t.endPoint,e);const{thetaStart:n,thetaEnd:r}=t;return aN(t,n*(1-e)+r*e)}function pRt(t,e){if(t.isInvalid)return NGe(t.startPoint,t.endPoint,e);const{cx:n,cy:r,thetaStart:i,thetaEnd:s}=t,[o,a]=e,l=PGe(KO(i,s),Math.atan2(a-r,o-n)),c=aN(t,l);return{t:(l-i)/(s-i),curvePoint:c,distance:Math.sqrt($a(e,c))}}function $te(t,e){if(e.isInvalid)return tu(t,e.startPoint),tu(t,e.endPoint),t;const{cx:n,cy:r,radius:i,thetaStart:s,thetaEnd:o}=e;tu(t,aN(e,s)),tu(t,aN(e,o));const a=KO(s,o),l=Math.PI/2;let c=0;for(const u of[[n+i,r],[n,r+i],[n-i,r],[n,r-i]])c=PI(a,c),c>a.min&&c<a.max&&tu(t,u),c+=l;return t}function mRt(t){if(t.isInvalid)return 2*t.radius;const{radius:e,thetaStart:n,thetaEnd:r}=t;return e*Math.abs(r-n)}function OGe(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function LGe(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function uw(t,e,n,r,i,s,o,a,l,c){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=s,t[5]=o,t[6]=a,t[7]=l,t[8]=c,t}function y0e(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function v0e(t,e){if(t===e){const n=e[1],r=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function _0e(t,e){const n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=u*o-a*c,f=-u*s+a*l,g=c*s-o*l;let y=n*h+r*f+i*g;return y?(y=1/y,t[0]=h*y,t[1]=(-u*r+i*c)*y,t[2]=(a*r-i*o)*y,t[3]=f*y,t[4]=(u*n-i*l)*y,t[5]=(-a*n+i*s)*y,t[6]=g*y,t[7]=(-c*n+r*l)*y,t[8]=(o*n-r*s)*y,t):null}function DGe(t,e){const n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8];return t[0]=o*u-a*c,t[1]=i*c-r*u,t[2]=r*a-i*o,t[3]=a*l-s*u,t[4]=n*u-i*l,t[5]=i*s-n*a,t[6]=s*c-o*l,t[7]=r*l-n*c,t[8]=n*o-r*s,t}function OM(t){const e=t[0],n=t[1],r=t[2],i=t[3],s=t[4],o=t[5],a=t[6],l=t[7],c=t[8];return e*(c*s-o*l)+n*(-c*i+o*a)+r*(l*i-s*a)}function Kk(t,e,n){const r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],f=n[0],g=n[1],y=n[2],_=n[3],b=n[4],T=n[5],A=n[6],I=n[7],P=n[8];return t[0]=f*r+g*o+y*c,t[1]=f*i+g*a+y*u,t[2]=f*s+g*l+y*h,t[3]=_*r+b*o+T*c,t[4]=_*i+b*a+T*u,t[5]=_*s+b*l+T*h,t[6]=A*r+I*o+P*c,t[7]=A*i+I*a+P*u,t[8]=A*s+I*l+P*h,t}function B9(t,e,n){const r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],f=n[0],g=n[1];return t[0]=r,t[1]=i,t[2]=s,t[3]=o,t[4]=a,t[5]=l,t[6]=f*r+g*o+c,t[7]=f*i+g*a+u,t[8]=f*s+g*l+h,t}function x0e(t,e,n){const r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],f=Math.sin(n),g=Math.cos(n);return t[0]=g*r+f*o,t[1]=g*i+f*a,t[2]=g*s+f*l,t[3]=g*o-f*r,t[4]=g*a-f*i,t[5]=g*l-f*s,t[6]=c,t[7]=u,t[8]=h,t}function jGe(t,e,n){const r=n[0],i=n[1],s=n[2];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=s*e[6],t[7]=s*e[7],t[8]=s*e[8],t}function $Ge(t,e,n){const r=n[0],i=n[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t}function FGe(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t}function VGe(t,e){const n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=-n,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function zGe(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function GGe(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}function UGe(t,e){const n=e[0],r=e[1],i=e[2],s=e[3],o=n+n,a=r+r,l=i+i,c=n*o,u=r*o,h=r*a,f=i*o,g=i*a,y=i*l,_=s*o,b=s*a,T=s*l;return t[0]=1-h-y,t[3]=u-T,t[6]=f+b,t[1]=u+T,t[4]=1-c-y,t[7]=g-_,t[2]=f-b,t[5]=g+_,t[8]=1-c-h,t}function BGe(t,e){const n=e[0],r=e[1],i=e[2],s=e[4],o=e[5],a=e[6],l=e[8],c=e[9],u=e[10],h=u*o-a*c,f=-u*s+a*l,g=c*s-o*l,y=n*h+r*f+i*g;if(!y)return null;const _=1/y;return t[0]=h*_,t[1]=(-u*r+i*c)*_,t[2]=(a*r-i*o)*_,t[3]=f*_,t[4]=(u*n-i*l)*_,t[5]=(-a*n+i*s)*_,t[6]=g*_,t[7]=(-c*n+r*l)*_,t[8]=(o*n-r*s)*_,t}function WGe(t,e){const n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=e[9],f=e[10],g=e[11],y=e[12],_=e[13],b=e[14],T=e[15],A=n*a-r*o,I=n*l-i*o,P=n*c-s*o,R=r*l-i*a,D=r*c-s*a,C=i*c-s*l,M=u*_-h*y,O=u*b-f*y,j=u*T-g*y,V=h*b-f*_,U=h*T-g*_,G=f*T-g*b;let de=A*G-I*U+P*V+R*j-D*O+C*M;return de?(de=1/de,t[0]=(a*G-l*U+c*V)*de,t[1]=(l*j-o*G-c*O)*de,t[2]=(o*U-a*j+c*M)*de,t[3]=(i*U-r*G-s*V)*de,t[4]=(n*G-i*j+s*O)*de,t[5]=(r*j-n*U-s*M)*de,t[6]=(_*C-b*D+T*R)*de,t[7]=(b*P-y*C-T*I)*de,t[8]=(y*D-_*P+T*A)*de,t):null}function HGe(t,e,n){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/n,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function qGe(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function KGe(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+t[6]**2+t[7]**2+t[8]**2)}function YGe(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t}function w0e(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t}function XGe(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t}function ZGe(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t}function JGe(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]}function QGe(t,e){const n=t[0],r=t[1],i=t[2],s=t[3],o=t[4],a=t[5],l=t[6],c=t[7],u=t[8],h=e[0],f=e[1],g=e[2],y=e[3],_=e[4],b=e[5],T=e[6],A=e[7],I=e[8],P=Sl();return Math.abs(n-h)<=P*Math.max(1,Math.abs(n),Math.abs(h))&&Math.abs(r-f)<=P*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(i-g)<=P*Math.max(1,Math.abs(i),Math.abs(g))&&Math.abs(s-y)<=P*Math.max(1,Math.abs(s),Math.abs(y))&&Math.abs(o-_)<=P*Math.max(1,Math.abs(o),Math.abs(_))&&Math.abs(a-b)<=P*Math.max(1,Math.abs(a),Math.abs(b))&&Math.abs(l-T)<=P*Math.max(1,Math.abs(l),Math.abs(T))&&Math.abs(c-A)<=P*Math.max(1,Math.abs(c),Math.abs(A))&&Math.abs(u-I)<=P*Math.max(1,Math.abs(u),Math.abs(I))}function eUe(t){const e=Sl(),n=t[0],r=t[1],i=t[2],s=t[3],o=t[4],a=t[5],l=t[6],c=t[7],u=t[8];return Math.abs(1-(n*n+s*s+l*l))<=e&&Math.abs(1-(r*r+o*o+c*c))<=e&&Math.abs(1-(i*i+a*a+u*u))<=e}const tUe=Kk,nUe=w0e;Object.freeze(Object.defineProperty({__proto__:null,add:YGe,adjoint:DGe,copy:LGe,determinant:OM,equals:QGe,exactEquals:JGe,frob:KGe,fromMat2d:GGe,fromMat4:OGe,fromQuat:UGe,fromRotation:VGe,fromScaling:zGe,fromTranslation:FGe,identity:y0e,invert:_0e,isOrthoNormal:eUe,mul:tUe,multiply:Kk,multiplyScalar:XGe,multiplyScalarAndAdd:ZGe,normalFromMat4:WGe,normalFromMat4Legacy:BGe,projection:HGe,rotate:x0e,scale:jGe,scaleByVec2:$Ge,set:uw,str:qGe,sub:nUe,subtract:w0e,translate:B9,transpose:v0e},Symbol.toStringTag,{value:"Module"}));function gv(){return[1,0,0,0,1,0,0,0,1]}function rUe(t){return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8]]}function iUe(t,e,n,r,i,s,o,a,l){return[t,e,n,r,i,s,o,a,l]}const sUe=gv();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:sUe,clone:rUe,create:gv,fromValues:iUe},Symbol.toStringTag,{value:"Module"}));const S_=gv();function oUe(t,e,n){const[r,i]=t,[s,o]=e,[a,l]=n;uw(S_,r,s,a,i,o,l,1,1,1);const c=OM(S_),u=4*c/($a(t,e)+$a(e,n)+$a(n,t));if(!isFinite(u)||Math.abs(u)<1e-8)return null;const h=r**2+i**2,f=s**2+o**2,g=a**2+l**2;uw(S_,h,f,g,i,o,l,1,1,1);const y=OM(S_);return uw(S_,h,f,g,r,s,a,1,1,1),[y/c*.5,OM(S_)/c*-.5]}function b0e(t,e){const[n,r]=e.c,i=oUe(t,r,n),s=i==null,o=i??Ff([],t,n,.5),[a,l]=t,[c,u]=r,[h,f]=n,[g,y]=o,_=a-g,b=l-y,T=Math.sqrt(_*_+b*b),A=s1(l-y,a-g),I=s1(u-y,c-g);let P=s1(f-y,h-g);return(I-A)*(P-I)<0&&(P+=2*Math.sign(A-P)*Math.PI),new g0e(g,y,T,A,P,s)}function gRt(t,e,n){const r=NM(t,n/2),i=NM(t,n),s=NM(t,(n+1)/2);return[{c:[i,r]},{c:[[...e.c[0]],s]}]}function yRt(t,e){const[n]=e.c,{cx:r,cy:i,thetaStart:s,thetaEnd:o,radius:a,isInvalid:l}=b0e(t,e);return{a:[n,[r,i],Math.abs(o-s)<Math.PI?1:0,s>o?1:0,l?s:0,a,l?0:1]}}function vRt(t){return"curveRings"in t&&!!t.curveRings?.length||"curvePaths"in t&&!!t.curvePaths?.length}function _Rt(t){return"curveRings"in t?t.curveRings:t.curvePaths}function dW(t){return"b"in t}function fW(t){return"c"in t}function YO(t){return Array.isArray(t)}function xRt(t){return"a"in t}function E0e(t){return"a"in t&&t.a.length===4}function aUe(t){return"a"in t&&t.a.length===7}function Hj(t){return YO(t)?t:dW(t)?t.b[0]:fW(t)?t.c[0]:t.a[0]}function lUe(t){if(dW(t)){const[e,n,r]=t.b;return{b:[[...e],[...n],[...r]]}}if(fW(t)){const[e,n]=t.c;return{c:[[...e],[...n]]}}if(YO(t))return[...t];if(E0e(t)){const[e,n,r,i]=t.a;return{a:[[...e],[...n],r,i]}}if(aUe(t)){const[e,n,r,i,s,o,a]=t.a;return{a:[[...e],[...n],r,i,s,o,a]}}return t}function cUe(t,e){const[n,r,i,s]=e.a,[o,a]=t,[l,c]=n,[u,h]=r,f=o-u,g=a-h,y=Math.sqrt(f*f+g*g),_=l-u,b=c-h,T=Math.sqrt(_*_+b*b),A=y===0||T===0||!Bge(y,T),I=y,[P,R]=f0e(s1(a-h,o-u),Math.atan2(c-h,l-u),i,s);return new g0e(u,h,I,P,R,A)}function wRt(t,e,n){const{cx:r,cy:i,thetaStart:s,thetaEnd:o}=t,[a,l,c,u]=e.a,h=s*(1-n)+o*n;return[{a:[NM(t,n),[r,i],Math.abs(h-s)<Math.PI?1:0,u]},{a:[[...a],[r,i],Math.abs(o-h)<Math.PI?1:0,u]}]}let uUe=class{constructor(e,n,r,i,s,o,a,l,c){this.cx=e,this.cy=n,this.a=r,this.b=i,this.cosR=s,this.sinR=o,this.u1=a,this.u2=l,this.isInvalid=c}};function pW(t,e){const[n,r,i,s,o,a,l]=e.a,[c,u]=t,[h,f]=n,[g,y]=r,_=a*l,b=Math.cos(o),T=Math.sin(o),[A,I]=f0e(s1(1/_*(u-y)*b-1/_*(c-g)*T,1/a*(u-y)*T+1/a*(c-g)*b),Math.atan2(1/_*(f-y)*b-1/_*(h-g)*T,1/a*(f-y)*T+1/a*(h-g)*b),i,s);return new uUe(g,y,a,_,b,T,A,I,a===0||_===0)}function Yk(t,e){const{a:n,b:r,cosR:i,sinR:s,cx:o,cy:a}=t,l=Math.cos(e),c=Math.sin(e);return[n*l*i-r*c*s+o,n*l*s+r*c*i+a]}function X_(t,e){const{u1:n,u2:r}=t;return Yk(t,n*(1-e)+r*e)}function ERt(t,e,n){if(n<0||n>1)return[];if(n===0||n===1)return[lUe(e)];const[r,[i,s],o,a,l,c,u]=e.a,{u1:h,u2:f}=t,g=h*(1-n)+f*n;return[{a:[[...X_(t,n)],[i,s],Math.abs(g-h)<Math.PI?1:0,a,l,c,u]},{a:[[...r],[i,s],Math.abs(f-g)<Math.PI?1:0,a,l,c,u]}]}function SRt(t,e){const{a:n,b:r,cosR:i,sinR:s,u1:o,u2:a}=t,l=Math.PI/6,c=p0e(e,[1*l,2*l,4*l,5*l,7*l,8*l,10*l,11*l],_=>{const b=Math.cos(_),T=Math.sin(_),[A,I]=Yk(t,_);return[A,I,-n*i*T-r*s*b,-n*s*T+r*i*b,-n*i*b+r*s*T,-n*s*b-r*i*T]}),u=KO(o,a),h=new Set(c.map(_=>PI(u,_)).filter(_=>_>u.min&&_<u.max));h.add(o),h.add(a);let f,g,y=1/0;for(const _ of h){const b=Yk(t,_),[T,A]=b,I=e[0]-T,P=e[1]-A,R=I*I+P*P;R<y&&(f=(_-o)/(a-o),g=b,y=R)}return{t:f,curvePoint:g,distance:Math.sqrt(y)}}function hUe(t,e,n){const r=pW(e,n),{a:i,b:s,u1:o,u2:a,cosR:l,sinR:c,isInvalid:u}=r,h=n.a[0];if(tu(t,e),tu(t,h),u)return t;const f=Math.atan2(-s*c,i*l),g=f+Math.PI,y=Math.atan2(s*l,i*c),_=y+Math.PI,b=KO(o,a);for(const T of[f,g,y,_].map(A=>PI(b,A)))T>b.min&&T<b.max&&tu(t,Yk(r,T));return t}function TRt(t,e,n){const[r,i,s,o,a,l,c]=e.a,u=pW(t,e),{u1:h,u2:f,isInvalid:g}=u,y=f-h;if(g)return Math.sqrt($a(t,r));const _=14,b=[0,0];let T=0,A=[X_(u,0),X_(u,.25),X_(u,.5),X_(u,.75),X_(u,1)];for(let I=0;I<_;I++){const P=A.length-1,R=y/(2*P),D=[];for(let M=0;M<P;M++)D.push(A[M]),D.push(Yk(u,h+(2*M+1)*R));D.push(A[A.length-1]),A=D,T=0;let C=0;for(let M=1;M<A.length;M++){const O=A[M-1],j=A[M];if(T+=Math.sqrt($a(O,j)),M>1){const V=A[M-2],U=IGe(b,V,O,i,j);C+=U?Math.sqrt($a(O,U)):Math.abs(j[0]-O[0])+Math.abs(j[1]-O[1])}else C+=T}if(C-T<n)return T}return T}const Fte=gv(),BC=gv(),Vte=gv(),pm=gv();function kRt(t,e,n){const[r,i,s,o,a,l,c]=e.a,u=pW(t,e),{cosR:h,sinR:f,a:g,b:y,cx:_,cy:b}=u,T=MM([0,0],r,n),A=MM([0,0],i,n),I=n[0]*n[4]<0?1-o:o;{const P=g*g*f*f+y*y*h*h,R=2*(y*y-g*g)*f*h,D=g*g*h*h+y*y*f*f,C=-2*P*_-R*b,M=-R*_-2*D*b;uw(Fte,P,R/2,C/2,R/2,D,M/2,C/2,M/2,P*_*_+R*_*b+D*b*b-g*g*y*y)}if(_0e(BC,n),BC==null){const P=MM([0,0],t,n);return{a:[T,A,s,o,s1(T[1],T[0]),Math.sqrt($a(T,P))/2,0]}}v0e(Vte,BC),Kk(pm,Kk(pm,Vte,Fte),BC);{const P=pm[0],R=2*pm[1],D=pm[4],C=2*pm[2],M=2*pm[5],O=R*R-4*P*D,j=2*(P*M*M+D*C*C-R*C*M+O*pm[8]),V=Math.sqrt((P-D)**2+R*R),U=-Math.sqrt(j*(P+D+V))/O,G=-Math.sqrt(j*(P+D-V))/O;return{a:[T,A,s,I,.5*s1(-R,D-P),U,G/U]}}}function dUe(t,e,n){if(YO(n))return tu(t,e),tu(t,n),t;if(dW(n))return MGe(t,e,n);if(fW(n)){const r=b0e(e,n);return $te(t,r)}if(E0e(n)){const r=cUe(e,n);return $te(t,r)}return hUe(t,e,n)}function S0e(t){return t.xmin!==void 0&&t.ymin!==void 0&&t.xmax!==void 0&&t.ymax!==void 0}function T0e(t){return t.points!==void 0}function k0e(t){return t.x!==void 0&&t.y!==void 0}function A0e(t){return t.paths!==void 0}function I0e(t){return t.rings!==void 0}function P0e(t){function e(n,r){return n==null?r:r==null?n:t(n,r)}return e}const ng=P0e(Math.min),rg=P0e(Math.max);function ARt(t,e){return A0e(e)?T2(t,e.curvePaths??e.paths,!1,!1)??t:I0e(e)?T2(t,e.curveRings??e.rings,!1,!1)??t:T0e(e)?mW(t,e.points,!1,!1,!1,!1):S0e(e)?C0e(t,e):(k0e(e)&&(t[0]=e.x,t[1]=e.y,t[2]=e.x,t[3]=e.y),t)}function IRt(t){let e,n,r,i;for(t.reset(),e=r=1/0,n=i=-1/0;t.nextPath();){const s=fUe(t);e=Math.min(s[0],e),r=Math.min(s[1],r),n=Math.max(s[2],n),i=Math.max(s[3],i)}return xl([e,r,n,i])}function fUe(t){let e,n,r,i;for(e=r=1/0,n=i=-1/0;t.nextPoint();)e=Math.min(t.x,e),r=Math.min(t.y,r),n=Math.max(t.x,n),i=Math.max(t.y,i);return xl([e,r,n,i])}function PRt(t,e){return A0e(e)?T2(t,e.curvePaths??e.paths,!0,!1)??t:I0e(e)?T2(t,e.curveRings??e.rings,!0,!1)??t:T0e(e)?mW(t,e.points,!0,!1,!0,!1):S0e(e)?C0e(t,e,!0,!1,!0,!1):(k0e(e)&&(t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.x,t[4]=e.y,t[5]=e.z),t)}function T2(t,e,n,r){const i=n?3:2;if(!e.length||!e[0].length)return null;let s,o,a,l,[c,u]=Hj(e[0][0]),h=c,f=u;for(let g=0;g<e.length;g++){const y=e[g];for(let _=0;_<y.length;_++){const b=Hj(y[_]),[T,A]=b;if(c=ng(c,T),u=ng(u,A),h=rg(h,T),f=rg(f,A),n&&b.length>2){const D=b[2];s=ng(s,D),o=rg(o,D)}if(r&&b.length>i){const D=b[i];a=ng(s,D),l=rg(o,D)}const I=y[_];if(YO(I)||_<1)continue;const P=Hj(y[_-1]),R=Kze(c,u,h,f);[c,u,h,f]=dUe(R,P,I)}}return n?r?(t[0]=c,t[1]=u,t[2]=s,t[3]=a,t[4]=h,t[5]=f,t[6]=o,t[7]=l,t.length=8,t):(t[0]=c,t[1]=u,t[2]=s,t[3]=h,t[4]=f,t[5]=o,t.length=6,t):r?(t[0]=c,t[1]=u,t[2]=a,t[3]=h,t[4]=f,t[5]=l,t.length=6,t):(t[0]=c,t[1]=u,t[2]=h,t[3]=f,t.length=4,t)}function C0e(t,e,n,r,i,s){const o=e.xmin,a=e.xmax,l=e.ymin,c=e.ymax;let u=e.zmin,h=e.zmax,f=e.mmin,g=e.mmax;return i?(u=u||0,h=h||0,s?(f=f||0,g=g||0,t[0]=o,t[1]=l,t[2]=u,t[3]=f,t[4]=a,t[5]=c,t[6]=h,t[7]=g,t):(t[0]=o,t[1]=l,t[2]=u,t[3]=a,t[4]=c,t[5]=h,t)):s?(f=f||0,g=g||0,t[0]=o,t[1]=l,t[2]=f,t[3]=a,t[4]=c,t[5]=g,t):(t[0]=o,t[1]=l,t[2]=a,t[3]=c,t)}function mW(t,e,n,r,i,s){const o=n?3:2,a=r&&s,l=n&&i;if(!e.length||!e[0].length)return null;let c,u,h,f,[g,y]=e[0],[_,b]=e[0];for(let T=0;T<e.length;T++){const A=e[T],[I,P]=A;if(g=ng(g,I),y=ng(y,P),_=rg(_,I),b=rg(b,P),l&&A.length>2){const R=A[2];c=ng(c,R),u=rg(u,R)}if(a&&A.length>o){const R=A[o];h=ng(c,R),f=rg(u,R)}}return i?(c=c||0,u=u||0,s?(h=h||0,f=f||0,t[0]=g,t[1]=y,t[2]=c,t[3]=h,t[4]=_,t[5]=b,t[6]=u,t[7]=f,t):(t[0]=g,t[1]=y,t[2]=c,t[3]=_,t[4]=b,t[5]=u,t)):s?(h=h||0,f=f||0,t[0]=g,t[1]=y,t[2]=h,t[3]=_,t[4]=b,t[5]=f,t):(t[0]=g,t[1]=y,t[2]=_,t[3]=b,t)}function pUe(t){return t.xmin!==void 0&&t.ymin!==void 0&&t.xmax!==void 0&&t.ymax!==void 0}function mUe(t){return t.points!==void 0}function gUe(t){return t.x!==void 0&&t.y!==void 0}function yUe(t){return t.paths!==void 0}function vUe(t){return t.rings!==void 0}const gW=[];function R0e(t,e,n,r){return{xmin:t,ymin:e,xmax:n,ymax:r}}function M0e(t,e,n,r,i,s){return{xmin:t,ymin:e,zmin:n,xmax:r,ymax:i,zmax:s}}function N0e(t,e,n,r,i,s){return{xmin:t,ymin:e,mmin:n,xmax:r,ymax:i,mmax:s}}function O0e(t,e,n,r,i,s,o,a){return{xmin:t,ymin:e,zmin:n,mmin:r,xmax:i,ymax:s,zmax:o,mmax:a}}function yW(t,e=!1,n=!1){return e?n?O0e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]):M0e(t[0],t[1],t[2],t[3],t[4],t[5]):n?N0e(t[0],t[1],t[2],t[3],t[4],t[5]):R0e(t[0],t[1],t[2],t[3])}function CRt(t){return t?pUe(t)?t:gUe(t)?_Ue(t):vUe(t)?D0e(t):yUe(t)?j0e(t):mUe(t)?L0e(t):null:null}function L0e(t){const{hasZ:e,hasM:n,points:r}=t,i=mW(gW,r,e??!1,n??!1,e??!1,n??!1);return i?yW(i,e,n):null}function _Ue(t){const{x:e,y:n,z:r,m:i}=t,s=i!=null;return r!=null?s?O0e(e,n,r,i,e,n,r,i):M0e(e,n,r,e,n,r):s?N0e(e,n,i,e,n,i):R0e(e,n,e,n)}function D0e(t){const{hasZ:e,hasM:n,rings:r,curveRings:i}=t,s=T2(gW,i??r,e??!1,n??!1);return s?yW(s,e,n):null}function j0e(t){const{hasZ:e,hasM:n,paths:r,curvePaths:i}=t,s=T2(gW,i??r,e??!1,n??!1);return s?yW(s,e,n):null}function k2(t,e,n=!1){let{hasM:r,hasZ:i}=t;Array.isArray(e)?e.length!==4||r||i?e.length===3&&n&&!r?(i=!0,r=!1):e.length===3&&r&&i&&(r=!1,i=!1):(r=!0,i=!0):(i=!i&&e.hasZ&&(!r||e.hasM),r=!r&&e.hasM&&(!i||e.hasZ)),t.hasZ=i,t.hasM=r}var LM;function zte(t){return!Array.isArray(t[0])}function xUe(t){return typeof t[0]?.[0]=="number"}function wUe(t){if(!t)return;let{rings:e,hasM:n,hasZ:r,spatialReference:i}=t;switch(e??=[],xUe(e)&&(e=[e]),e[0]?.[0]?.length){case 4:r??=!0,n??=!0;break;case 3:r??=n!==!0,n??=!r;break;default:r??=!1,n??=!1}return i??=Bt.WGS84,{...t,hasM:n,hasZ:r,rings:e,spatialReference:i}}let wi=LM=class extends Gs{static fromExtent(t){const e=t.clone().normalize(),{spatialReference:n}=t;let r=!1,i=!1;for(const o of e)o.hasZ&&(r=!0),o.hasM&&(i=!0);const s={rings:e.map(o=>{const a=[[o.xmin,o.ymin],[o.xmin,o.ymax],[o.xmax,o.ymax],[o.xmax,o.ymin],[o.xmin,o.ymin]];if(r&&o.hasZ){const l=o.zmin+.5*(o.zmax-o.zmin);for(let c=0;c<a.length;c++)a[c].push(l)}if(i&&o.hasM){const l=o.mmin+.5*(o.mmax-o.mmin);for(let c=0;c<a.length;c++)a[c].push(l)}return a}),spatialReference:n};return r&&(s.hasZ=!0),i&&(s.hasM=!0),new LM(s)}constructor(t){super(wUe(t)),this.curveRings=void 0,this.rings=[],this.type="polygon"}get cache(){return this.commitProperty("curveRings"),this.commitProperty("hasM"),this.commitProperty("hasZ"),this.commitProperty("rings"),this.commitProperty("spatialReference"),{}}get centroid(){Q8(kt.getLogger(this),"centroid",{replacement:"Please use centroidOperator.execute() instead.",version:"4.34",warnOnce:!0});const t=Vze(this);return t?Jt.fromJSON(t):null}writeCurveRings(t,e){e.curveRings=Ze(t)}get extent(){const t=D0e(this),{spatialReference:e}=this;return t?new Vn({...t,spatialReference:e}):null}get isSelfIntersecting(){return Q8(kt.getLogger(this),"isSelfIntersecting",{replacement:"Please use simplifyOperator.isSimple() instead.",version:"4.33",warnOnce:!0}),t9e(this.rings)}writeRings(t,e){e.rings=Ze(this.rings)}addRing(t){if(!t)return;const e=this.rings,n=e.length;if(zte(t)){const r=[];for(let i=0,s=t.length;i<s;i++)r[i]=t[i].toArray();e[n]=r}else e[n]=t.slice();return this.notifyChange("rings"),this}clone(){const t=new LM;return t.spatialReference=this.spatialReference,t.rings=Ze(this.rings),t.curveRings=Ze(this.curveRings),t.hasZ=this.hasZ,t.hasM=this.hasM,t}equals(t){if(this===t)return!0;if(t==null)return!1;const e=this.spatialReference,n=t.spatialReference;if(e!=null!=(n!=null)||e!=null&&n!=null&&!e.equals(n)||this.rings.length!==t.rings.length)return!1;const r=([i,s,o,a],[l,c,u,h])=>i===l&&s===c&&(o==null&&u==null||o===u)&&(a==null&&h==null||a===h);for(let i=0;i<this.rings.length;i++){const s=this.rings[i],o=t.rings[i];if(!vO(s,o,r))return!1}return!0}contains(t){if(!t)return!1;const e=DO(t,this.spatialReference);return FB(this,e??t)}isClockwise(t){const e=zte(t)?t.map(n=>this.hasZ?this.hasM?[n.x,n.y,n.z,n.m]:[n.x,n.y,n.z]:[n.x,n.y]):t;return t0e(e)}getPoint(t,e){if(!this._validateInputs(t,e))return null;const n=this.rings[t][e],r=this.hasZ,i=this.hasM;return r&&!i?new Jt(n[0],n[1],n[2],void 0,this.spatialReference):i&&!r?new Jt(n[0],n[1],void 0,n[2],this.spatialReference):r&&i?new Jt(n[0],n[1],n[2],n[3],this.spatialReference):new Jt(n[0],n[1],this.spatialReference)}insertPoint(t,e,n){return this._validateInputs(t,e,!0)?(k2(this,n),Array.isArray(n)||(n=n.toArray()),this.rings[t].splice(e,0,n),this.notifyChange("rings"),this):this}removePoint(t,e){if(!this._validateInputs(t,e))return null;const n=new Jt(this.rings[t].splice(e,1)[0],this.spatialReference);return this.notifyChange("rings"),n}removeRing(t){if(!this._validateInputs(t,null))return null;const e=this.rings.splice(t,1)[0],n=this.spatialReference,r=e.map(i=>new Jt(i,n));return this.notifyChange("rings"),r}setPoint(t,e,n){return this._validateInputs(t,e)?(k2(this,n),Array.isArray(n)||(n=n.toArray()),this.rings[t][e]=n,this.notifyChange("rings"),this):this}_validateInputs(t,e,n=!1){if(t==null||t<0||t>=this.rings.length)return!1;if(e!=null){const r=this.rings[t];if(n&&(e<0||e>r.length)||!n&&(e<0||e>=r.length))return!1}return!0}toJSON(t){return this.write({},t)}};x([E({readOnly:!0})],wi.prototype,"cache",null),x([E({readOnly:!0})],wi.prototype,"centroid",null),x([E({json:{write:!0,origins:{"portal-item":{write:!1},"web-map":{write:!1},"web-scene":{write:!1}}}})],wi.prototype,"curveRings",void 0),x([er("curveRings")],wi.prototype,"writeCurveRings",null),x([E({readOnly:!0})],wi.prototype,"extent",null),x([E({readOnly:!0})],wi.prototype,"isSelfIntersecting",null),x([E({type:[[[Number]]],json:{write:{isRequired:!0}}})],wi.prototype,"rings",void 0),x([er("rings")],wi.prototype,"writeRings",null),wi=LM=x([ue("esri.geometry.Polygon")],wi),wi.prototype.toJSON.isDefaultToJSON=!0;function a0(){return[0,0,0]}function bUe(t){return[t[0],t[1],t[2]]}function yb(t,e,n){return[t,e,n]}function EUe(t,e,n){return[t,e,n]}function SUe(t,e=a0()){const n=Math.min(3,t.length);for(let r=0;r<n;++r)e[r]=t[r];return e}function $0e(){return a0()}function F0e(){return yb(1,1,1)}function V0e(){return yb(1,0,0)}function z0e(){return yb(0,1,0)}function G0e(){return yb(0,0,1)}const TUe=$0e(),kUe=F0e(),AUe=V0e(),IUe=z0e(),PUe=G0e();Object.freeze(Object.defineProperty({__proto__:null,ONES:kUe,UNIT_X:AUe,UNIT_Y:IUe,UNIT_Z:PUe,ZEROS:TUe,clone:bUe,create:a0,freeze:EUe,fromArray:SUe,fromValues:yb,ones:F0e,unitX:V0e,unitY:z0e,unitZ:G0e,zeros:$0e},Symbol.toStringTag,{value:"Module"}));var W9;function CUe(t){if(!t)return;let{points:e,hasM:n,hasZ:r,spatialReference:i}=t;switch(e??=[],e?.at(0)?.length){case 4:r??=!0,n??=!0;break;case 3:r??=n!==!0,n??=!r;break;default:r??=!1,n??=!1}return i??=Bt.WGS84,{...t,hasM:n,hasZ:r,points:e,spatialReference:i}}let Ju=W9=class extends Gs{constructor(t){super(CUe(t)),this.points=[],this.type="multipoint"}get cache(){return this.commitProperty("points"),this.commitProperty("hasZ"),this.commitProperty("hasM"),this.commitProperty("spatialReference"),{}}get extent(){const t=L0e(this);return t?new Vn({...t,spatialReference:this.spatialReference}):null}writePoints(t,e){e.points=Ze(this.points)}clone(){const{points:t,spatialReference:e,hasM:n,hasZ:r}=this;return new W9({points:Ze(t),spatialReference:e.clone(),hasM:n,hasZ:r})}addPoint(t){return k2(this,t),Array.isArray(t)?this.points.push(t):this.points.push(t.toArray()),this.notifyChange("points"),this}getPoint(t){if(!this._validateInputs(t))return null;const e=this.points[t],n={x:e[0],y:e[1],spatialReference:this.spatialReference};let r=2;return this.hasZ&&(n.z=e[2],r=3),this.hasM&&(n.m=e[r]),new Jt(n)}removePoint(t){if(!this._validateInputs(t))return null;const e=new Jt(this.points.splice(t,1)[0],this.spatialReference);return this.notifyChange("points"),e}setPoint(t,e){return this._validateInputs(t)?(k2(this,e),Array.isArray(e)||(e=e.toArray()),this.points[t]=e,this.notifyChange("points"),this):this}toJSON(t){return this.write({},t)}_validateInputs(t){return t!=null&&t>=0&&t<this.points.length}};x([E({readOnly:!0})],Ju.prototype,"cache",null),x([E({readOnly:!0})],Ju.prototype,"extent",null),x([E({type:[[Number]],json:{write:{isRequired:!0}}})],Ju.prototype,"points",void 0),x([er("points")],Ju.prototype,"writePoints",null),Ju=W9=x([ue("esri.geometry.Multipoint")],Ju),Ju.prototype.toJSON.isDefaultToJSON=!0;var H9;function RUe(t){return!Array.isArray(t[0])}function MUe(t){return typeof t[0]?.[0]=="number"}function NUe(t){if(!t)return;let{paths:e,hasM:n,hasZ:r,spatialReference:i}=t;switch(e??=[],MUe(e)&&(e=[e]),e[0]?.[0]?.length){case 4:r??=!0,n??=!0;break;case 3:r??=n!==!0,n??=!r;break;default:r??=!1,n??=!1}return i??=Bt.WGS84,{...t,hasM:n,hasZ:r,paths:e,spatialReference:i}}let Ss=H9=class extends Gs{constructor(t){super(NUe(t)),this.curvePaths=void 0,this.paths=[],this.type="polyline"}get cache(){return this.commitProperty("curvePaths"),this.commitProperty("hasM"),this.commitProperty("hasZ"),this.commitProperty("paths"),this.commitProperty("spatialReference"),{}}writeCurvePaths(t,e){e.curvePaths=Ze(t)}get extent(){const t=j0e(this),{spatialReference:e}=this;return t?new Vn({...t,spatialReference:e}):null}writePaths(t,e){e.paths=Ze(this.paths)}addPath(t){if(!t)return;const e=this.paths,n=e.length;if(RUe(t)){const r=[];for(let i=0,s=t.length;i<s;i++)r[i]=t[i].toArray();e[n]=r}else e[n]=t.slice();return this.notifyChange("paths"),this}clone(){const t=new H9;return t.spatialReference=this.spatialReference,t.paths=Ze(this.paths),t.curvePaths=Ze(this.curvePaths),t.hasZ=this.hasZ,t.hasM=this.hasM,t}getPoint(t,e){if(!this._validateInputs(t,e))return null;const n=this.paths[t][e],r=this.hasZ,i=this.hasM;return r&&!i?new Jt(n[0],n[1],n[2],void 0,this.spatialReference):i&&!r?new Jt(n[0],n[1],void 0,n[2],this.spatialReference):r&&i?new Jt(n[0],n[1],n[2],n[3],this.spatialReference):new Jt(n[0],n[1],this.spatialReference)}insertPoint(t,e,n){return this._validateInputs(t,e,!0)?(k2(this,n),Array.isArray(n)||(n=n.toArray()),this.paths[t].splice(e,0,n),this.notifyChange("paths"),this):this}removePath(t){if(!this._validateInputs(t,null))return null;const e=this.paths.splice(t,1)[0],n=this.spatialReference,r=e.map(i=>new Jt(i,n));return this.notifyChange("paths"),r}removePoint(t,e){if(!this._validateInputs(t,e))return null;const n=new Jt(this.paths[t].splice(e,1)[0],this.spatialReference);return this.notifyChange("paths"),n}setPoint(t,e,n){return this._validateInputs(t,e)?(k2(this,n),Array.isArray(n)||(n=n.toArray()),this.paths[t][e]=n,this.notifyChange("paths"),this):this}_validateInputs(t,e,n=!1){if(t==null||t<0||t>=this.paths.length)return!1;if(e!=null){const r=this.paths[t];if(n&&(e<0||e>r.length)||!n&&(e<0||e>=r.length))return!1}return!0}toJSON(t){return this.write({},t)}};x([E({readOnly:!0})],Ss.prototype,"cache",null),x([E({json:{write:!0,origins:{"portal-item":{write:!1},"web-map":{write:!1},"web-scene":{write:!1}}}})],Ss.prototype,"curvePaths",void 0),x([er("curvePaths")],Ss.prototype,"writeCurvePaths",null),x([E({readOnly:!0})],Ss.prototype,"extent",null),x([E({type:[[[Number]]],json:{write:{isRequired:!0}}})],Ss.prototype,"paths",void 0),x([er("paths")],Ss.prototype,"writePaths",null),Ss=H9=x([ue("esri.geometry.Polyline")],Ss),Ss.prototype.toJSON.isDefaultToJSON=!0;var q9;let Z_=q9=class extends Kt{constructor(t){super(t),this.isInverse=!1,this.wkt=null,this.wkid=null}getInverse(){return new q9({isInverse:!this.isInverse,wkid:this.wkid,wkt:this.wkt})}};x([E()],Z_.prototype,"isInverse",void 0),x([E()],Z_.prototype,"wkt",void 0),x([E()],Z_.prototype,"wkid",void 0),Z_=q9=x([ue("esri.geometry.operators.support.GeographicTransformationStep")],Z_);var K9;let vT=K9=class extends Kt{constructor(t){super(t),this.steps=[]}getInverse(){const t=new K9;for(let e=this.steps.length-1;e>=0;e--){const n=this.steps[e];t.steps.push(n.getInverse())}return t}};x([E({type:[Z_],nonNullable:!0})],vT.prototype,"steps",void 0),vT=K9=x([ue("esri.geometry.operators.support.GeographicTransformation")],vT);const RRt=Math.PI/180,MRt=/(?:SPHEROID|ELLIPSOID)\[([^\]]+)]/i,mm=is.radius,$u=is.eccentricitySquared,OUe={a1:mm*$u,a2:mm*$u*mm*$u,a3:mm*$u*$u/2,a4:mm*$u*mm*$u*2.5,a5:mm*$u+mm*$u*$u/2,a6:1-$u},NRt={4267:{a:63782064e-1,f:1/294.9786982},4269:{a:6378137,f:1/298.257222101},4326:{a:is.radius,f:is.flattening},4490:{a:6378137,f:1/298.257222101},104900:{a:2439700,f:0},104901:{a:6051e3,f:0},104902:{a:6051800,f:0},104903:{a:Vg.radius,f:Vg.flattening},104904:{a:3393400,f:1/192.0430107526882},104905:{a:Td.radius,f:Td.flattening},104906:{a:6200,f:0},104907:{a:11100,f:0},104908:{a:71492e3,f:.06487439154031222},104909:{a:8200,f:0},104910:{a:83500,f:0},104911:{a:1e4,f:0},104912:{a:2409300,f:0},104913:{a:15e3,f:0},104914:{a:4e4,f:0},104915:{a:1562090,f:0},104916:{a:2632345,f:0},104917:{a:85e3,f:0},104918:{a:1821460,f:0},104919:{a:5e3,f:0},104920:{a:12e3,f:0},104921:{a:3e4,f:3},104922:{a:18e3,f:0},104923:{a:14e3,f:0},104924:{a:49300,f:0},104925:{a:60268e3,f:1/10.2079945799458},104926:{a:16e3,f:0},104927:{a:9500,f:0},104928:{a:56e4,f:0},104929:{a:249400,f:0},104930:{a:59500,f:0},104931:{a:16e3,f:0},104932:{a:133e3,f:0},104933:{a:718e3,f:0},104934:{a:888e3,f:0},104935:{a:1986300,f:0},104936:{a:1e4,f:0},104937:{a:41900,f:0},104938:{a:11e4,f:0},104939:{a:50100,f:0},104940:{a:764e3,f:0},104941:{a:11e3,f:0},104942:{a:529800,f:0},104943:{a:2575e3,f:0},104944:{a:25559e3,f:1/43.61604095563141},104945:{a:578900,f:0},104946:{a:33e3,f:0},104947:{a:21e3,f:0},104948:{a:13e3,f:0},104949:{a:31e3,f:0},104950:{a:27e3,f:0},104951:{a:42e3,f:0},104952:{a:235800,f:0},104953:{a:761400,f:0},104954:{a:15e3,f:0},104955:{a:54e3,f:0},104956:{a:77e3,f:0},104957:{a:27e3,f:0},104958:{a:788900,f:0},104959:{a:584700,f:0},104960:{a:24764e3,f:.01708124697141011},104961:{a:74e3,f:0},104962:{a:79e3,f:0},104963:{a:104e3,f:.14423076923076922},104964:{a:29e3,f:0},104965:{a:17e4,f:0},104966:{a:208e3,f:0},104967:{a:4e4,f:0},104968:{a:1352600,f:0},104969:{a:1195e3,f:0},104970:{a:593e3,f:0},104971:{a:Td.radius,f:0},104972:{a:47e4,f:0},104973:{a:255e3,f:0},104974:{a:2439400,f:0}},LUe={2:{5:hi,7:null,9:null,10:hi,1:xT,6:null,8:null,0:null,3:hw,11:dw,2:hi,4:mw},5:{5:hi,7:null,9:null,10:hi,1:xT,6:null,8:null,0:null,3:hw,11:dw,2:hi,4:mw},7:{5:null,7:hi,9:null,10:hi,1:null,6:Bte,8:null,0:null,3:null,11:null,2:null,4:null},9:{5:null,7:null,9:hi,10:hi,1:null,6:null,8:Ute,0:null,3:null,11:null,2:null,4:null},3:{5:_T,7:null,9:null,10:_T,1:jUe,6:null,8:null,0:null,3:hi,11:VUe,2:_T,4:$Ue},4:{5:gw,7:null,9:null,10:gw,1:YUe,6:null,8:null,0:null,3:XUe,11:zUe,2:gw,4:hi},1:{5:pw,7:null,9:null,10:pw,1:hi,6:null,8:null,0:null,3:HUe,11:GUe,2:pw,4:qUe},6:{5:null,7:Hte,9:null,10:Hte,1:null,6:hi,8:null,0:null,3:null,11:null,2:null,4:null},8:{5:null,7:null,9:Wte,10:Wte,1:null,6:null,8:hi,0:null,3:null,11:null,2:null,4:null},0:{5:null,7:null,9:null,10:null,1:null,6:null,8:null,0:hi,3:null,11:null,2:null,4:null},10:{5:hi,7:hi,9:hi,10:hi,1:xT,6:Bte,8:Ute,0:null,3:hw,11:dw,2:hi,4:mw},11:{5:fw,7:null,9:null,10:fw,1:UUe,6:null,8:null,0:null,3:BUe,11:hi,2:fw,4:WUe}};function U0e(t,e){return DUe(t,e)?.projector}function DUe(t,e){if(t==null||e==null)return null;if(hf.source.spatialReference===t&&hf.dest.spatialReference===e)return hf;const n=Gte(t,hf.source),r=Gte(e,hf.dest);return n===0&&r===0?go(t,e)?hf.projector=hi:hf.projector=null:hf.projector=LUe[n][r],hf}function Gte(t,e){return t?e.spatialReference===t?e.spatialReferenceId:(e.spatialReference=t,"metersPerUnit"in e&&(e.metersPerUnit=Wd(t,1)),Z4(t)?e.spatialReferenceId=1:z1(t)?e.spatialReferenceId=2:Dd(t)?e.spatialReferenceId=3:a8e(t)?e.spatialReferenceId=11:t.wkt===h8e.wkt?e.spatialReferenceId=4:t.wkid===4490?e.spatialReferenceId=5:t.wkt===DB.wkt?e.spatialReferenceId=6:t.wkt===jB.wkt?e.spatialReferenceId=8:Xpe(t)?e.spatialReferenceId=7:Zpe(t)?e.spatialReferenceId=9:e.spatialReferenceId=0):0}function hi(t,e,n,r){t!==n&&(n[r++]=t[e++],n[r++]=t[e++],n[r]=t[e])}function _T(t,e,n,r){n[r]=I2*(t[e]/o1),n[r+1]=I2*(B0e-2*Math.atan(Math.exp(-t[e+1]/o1))),n[r+2]=t[e+2]}function jUe(t,e,n,r){const i=t[e]/o1,s=B0e-2*Math.atan(Math.exp(-t[e+1]/o1)),o=o1+t[e+2],a=Math.cos(s)*o;n[r]=Math.cos(i)*a,n[r+1]=Math.sin(i)*a,n[r+2]=Math.sin(s)*o}function $Ue(t,e,n,r){_T(t,e,n,r),mw(n,r,n,r)}function FUe(t,e,n,r,i){const s=.4999999*Math.PI,o=vu(A2*t[e+1],-s,s),a=Math.sin(o);n[r++]=A2*t[e]*i.radius,n[r++]=i.halfSemiMajorAxis*Math.log((1+a)/(1-a)),n[r]=t[e+2]}function hw(t,e,n,r){FUe(t,e,n,r,is)}function dw(t,e,n,r){n[r]=t[e]*qte,n[r+1]=t[e+1]*qte,n[r+2]=t[e+2]}function fw(t,e,n,r){n[r]=t[e]*Kte,n[r+1]=t[e+1]*Kte,n[r+2]=t[e+2]}function VUe(t,e,n,r){_T(t,e,n,r),dw(n,r,n,r)}function zUe(t,e,n,r){gw(t,e,n,r),dw(n,r,n,r)}function GUe(t,e,n,r){pw(t,e,n,r),dw(n,r,n,r)}function UUe(t,e,n,r){fw(t,e,n,r),xT(n,r,n,r)}function BUe(t,e,n,r){fw(t,e,n,r),hw(n,r,n,r)}function WUe(t,e,n,r){fw(t,e,n,r),mw(n,r,n,r)}function vW(t,e,n,r,i){const s=i+t[e+2],o=A2*t[e+1],a=A2*t[e],l=Math.cos(o)*s;n[r]=Math.cos(a)*l,n[r+1]=Math.sin(a)*l,n[r+2]=Math.sin(o)*s}function Ute(t,e,n,r){vW(t,e,n,r,Vg.radius)}function Bte(t,e,n,r){vW(t,e,n,r,Td.radius)}function xT(t,e,n,r){vW(t,e,n,r,is.radius)}function _W(t,e,n,r,i){const s=t[e],o=t[e+1],a=t[e+2],l=Math.sqrt(s*s+o*o+a*a),c=lze(a/(l===0?1:l)),u=Math.atan2(o,s);n[r++]=I2*u,n[r++]=I2*c,n[r]=l-i}function Wte(t,e,n,r){_W(t,e,n,r,Vg.radius)}function Hte(t,e,n,r){_W(t,e,n,r,Td.radius)}function pw(t,e,n,r){_W(t,e,n,r,is.radius)}function HUe(t,e,n,r){pw(t,e,n,r),hw(n,r,n,r)}function qUe(t,e,n,r){pw(t,e,n,r),mw(n,r,n,r)}function KUe(t,e,n,r,i){const s=A2*t[e],o=A2*t[e+1],a=t[e+2],l=Math.sin(o),c=Math.cos(o),u=i.radius/Math.sqrt(1-i.eccentricitySquared*l*l);n[r++]=(u+a)*c*Math.cos(s),n[r++]=(u+a)*c*Math.sin(s),n[r++]=(u*(1-i.eccentricitySquared)+a)*l}function mw(t,e,n,r){KUe(t,e,n,r,is)}function gw(t,e,n,r){const i=OUe,s=t[e],o=t[e+1],a=t[e+2];let l,c,u,h,f,g,y,_,b,T,A,I,P,R,D,C,M,O,j,V,U;l=Math.abs(a),c=s*s+o*o,u=Math.sqrt(c),h=c+a*a,f=Math.sqrt(h),V=Math.atan2(o,s),g=a*a/h,y=c/h,R=i.a2/f,D=i.a3-i.a4/f,y>.3?(_=l/f*(1+y*(i.a1+R+g*D)/f),j=Math.asin(_),T=_*_,b=Math.sqrt(1-T)):(b=u/f*(1-g*(i.a5-R-y*D)/f),j=Math.acos(b),T=1-b*b,_=Math.sqrt(T)),A=1-is.eccentricitySquared*T,I=is.radius/Math.sqrt(A),P=i.a6*I,R=u-I*b,D=l-P*_,M=b*R+_*D,C=b*D-_*R,O=C/(P/A+M),j+=O,U=M+C*O/2,a<0&&(j=-j),n[r++]=I2*V,n[r++]=I2*j,n[r]=U}function YUe(t,e,n,r){gw(t,e,n,r),xT(n,r,n,r)}function XUe(t,e,n,r){gw(t,e,n,r),hw(n,r,n,r)}const hf={source:{spatialReference:null,spatialReferenceId:0,metersPerUnit:1},dest:{spatialReference:null,spatialReferenceId:0,metersPerUnit:1},projector:hi},A2=kI(1),I2=Gge(1),B0e=.5*Math.PI,o1=is.radius,qte=o1*Math.PI/180,Kte=180/(o1*Math.PI);function CI(t,e,n,r,i,s,o=Math.floor(t.length/3)){const a=U0e(e,i);if(a==null)return!1;if(a===hi){if(t===r&&n===s)return!0;const c=n+3*o;for(let u=n,h=s;u<c;u++,h++)r[h]=t[u];return!0}const l=n+3*o;for(let c=n,u=s;c<l;c+=3,u+=3)a(t,c,r,u);return!0}const ORt=Object.freeze(Object.defineProperty({__proto__:null,projectBuffer:CI},Symbol.toStringTag,{value:"Module"}));function Yte(t,e,n,r,i,s){return WC[0]=t,WC[1]=e,WC[2]=n,CI(WC,r,0,i,s,0)}const WC=a0();function ZUe(t,e,n){if(e==null||n==null||n.vcsWkid||go(e,n)||Gg(e)||Gg(n))return null;const r=Ree(e)/Ree(n);if(r===1)return null;switch(t){case"point":case"esriGeometryPoint":return i=>JUe(i,r);case"polyline":case"esriGeometryPolyline":return i=>eBe(i,r);case"polygon":case"esriGeometryPolygon":return i=>QUe(i,r);case"multipoint":case"esriGeometryMultipoint":return i=>tBe(i,r);case"extent":case"esriGeometryEnvelope":return i=>nBe(i,r);default:return null}}function JUe(t,e){t?.z!=null&&(t.z*=e)}function QUe(t,e){if(t)for(const n of t.rings)for(const r of n)r.length>2&&(r[2]*=e)}function eBe(t,e){if(t)for(const n of t.paths)for(const r of n)r.length>2&&(r[2]*=e)}function tBe(t,e){if(t)for(const n of t.points)n.length>2&&(n[2]*=e)}function nBe(t,e){t&&t.zmin!=null&&t.zmax!=null&&(t.zmin*=e,t.zmax*=e)}let wT=null,Xk=null,Zk=null,P2=null,Y9={};const xW=new _I;function kp(){return!!(Xk?.isLoaded()&&Zk?.isLoaded()&&P2?.isLoaded())}function W0e(){return!!kp()||(nn(xW),Bg(),!1)}function H0e(t,e){return!t||!e||bh(t,e)||W0e()}function rBe(t,e){return!bh(t,e)&&!kp()}async function Bg(t){wT==null&&(wT=Promise.all([_e(()=>import("./projectOperator-BJA3HQw3.js"),__vite__mapDeps([45,46,47])).then(e=>(Xk=e,Xk.load())),_e(()=>import("./projectOperator-B7dM8_lB.js"),__vite__mapDeps([48,46,47])).then(e=>(Zk=e,Zk.load())),_e(()=>import("./geographicTransformationUtils-DXRw9kRm.js"),[]).then(e=>(P2=e,P2.load()))])),await wT,pi(t),xW.notify()}function yv(t,e,n){return Array.isArray(t)?t.length===0?[]:(F8e(t),X9(t,t[0].spatialReference,e,n)):(b2(t),X9([t],t.spatialReference,e,n)[0])}function X9(t,e,n,r){if(e==null||n==null)return t;if(bh(e,n,r))return t.map(i=>DM(i,e,n));if(r?.geographicTransformation==null&&Z4(e))return t.map(i=>DM(i,e,Bt.WGS84)).map(i=>Jk(i,n));if(r?.geographicTransformation==null&&Z4(n))return t.map(i=>Jk(i,Bt.WGS84)).map(i=>DM(i,Bt.WGS84,n));if(!kp())throw new K0e;if(!r?.geographicTransformation){if(r?.extendedParams)r={...r,geographicTransformation:P2.getTransformation(e,n,r.areaOfInterestExtent)||new vT};else if(!r?.areaOfInterestExtent){const i=iBe(e,n);let s=Y9[i];s||(s=P2.getTransformation(e,n)||new vT,Y9[i]=s),r={geographicTransformation:s}}}return t[0].spatialReference||(t[0].spatialReference=e),t[0]instanceof Gs?Xk.executeMany(t,n,r):Zk.executeMany(t,n,r)}function iBe(t,e){return[t.wkid?.toString()??"-1",t.wkt?.toString()??"",t.wkt2?.toString()??"",e.wkid?.toString()??"-1",e.wkt?.toString()??"",e.wkt2?.toString()??""].join()}function sBe(t,e){const n=q0e([t],e);return n.pending!=null?{pending:n.pending,geometry:null}:n.geometries!=null?{pending:null,geometry:n.geometries[0]}:{pending:null,geometry:null}}function q0e(t,e){if(!kp()){for(const n of t)if(n!=null&&!go(n.spatialReference,e)&&hc(n.spatialReference)&&hc(e)&&!bh(n.spatialReference,e))return nn(xW),{pending:Bg(),geometries:null}}return{pending:null,geometries:t.map(n=>n==null?null:go(n.spatialReference,e)?n:hc(n.spatialReference)&&hc(e)?Jk(n,e):null)}}let K0e=class extends Xe{constructor(){super("projection:not-loaded","projection engine not fully loaded yet, please call load()")}};function oBe(){wT=null,Xk=null,Zk=null,P2=null,Y9={}}const aBe={get loadPromise(){return wT}};function Jk(t,e){try{const n=yv(t,e);if(n==null)return null;"xmin"in t&&"xmin"in n&&(n.zmin=t.zmin,n.zmax=t.zmax);const r=ZUe(n.type,t.spatialReference,e);return r?.(n),n}catch(n){if(!(n instanceof K0e))throw n;return null}}async function Y0e(t,e,n){const r=t.spatialReference;return r!=null&&e!=null&&await X0e(r,e,null,n),Jk(t,e)}function bh(t,e,n){return!(n?.areaOfInterestExtent||n?.extendedParams||n?.geographicTransformation)&&(!!go(t,e)||hc(t)&&hc(e)&&!!U0e(t,e))}function lBe(t,e){if(go(t,e))return!0;if(!hc(t)||!hc(e))return!1;const n=z1(t)||Dd(t)||Pee(t),r=z1(e)||Dd(e)||Pee(e);return n&&r}async function X0e(t,e,n,r){if(kp())return HQ(r);if(Array.isArray(t)){for(const{source:i,dest:s,options:o}of t)if(i&&s&&!bh(i,s,o))return Bg(r)}else if(t&&e&&!bh(t,e,n))return Bg(r);return HQ(r)}function DM(t,e,n){return t?"x"in t?Z0e(t,e,new Jt,n,0):"xmin"in t?nye(t,e,new Vn,n,0):"rings"in t?tye(t,e,new wi,n,0):"paths"in t?Q0e(t,e,new Ss,n,0):"points"in t?J0e(t,e,new Ju,n,0):null:null}function cBe(t,e,n=e.spatialReference,r=0){return n!=null&&t.spatialReference!=null&&Z0e(t,t.spatialReference,e,n,r)!=null}function Z0e(t,e,n,r,i){ia[0]=t.x,ia[1]=t.y;const s=t.z;return ia[2]=s!==void 0?s:i,CI(ia,e,0,ia,r,0)?(n.x=ia[0],n.y=ia[1],n.spatialReference=r,s!==void 0||Gg(r)?(n.z=ia[2],n.hasZ=!0):(n.z=void 0,n.hasZ=!1),t.m===void 0?(n.m=void 0,n.hasM=!1):(n.m=t.m,n.hasM=!0),n):null}function uBe(t,e,n=e.spatialReference,r=0){return t.spatialReference!=null&&n!=null&&J0e(t,t.spatialReference,e,n,r)!=null}function J0e(t,e,n,r,i){const{points:s,hasZ:o,hasM:a}=t,l=[],c=s.length,u=[];for(const f of s)u.push(f[0],f[1],o?f[2]:i);if(!CI(u,e,0,u,r,0,c))return null;const h=o||Gg(r);for(let f=0;f<c;++f){const g=3*f,y=u[g],_=u[g+1];h&&a?l.push([y,_,u[g+2],s[f][3]]):h?l.push([y,_,u[g+2]]):a?l.push([y,_,s[f][2]]):l.push([y,_])}return n.points=l,n.spatialReference=r,n.hasZ=o,n.hasM=a,n}function hBe(t,e,n=e.spatialReference,r=0){return t.spatialReference!=null&&n!=null&&Q0e(t,t.spatialReference,e,n,r)!=null}function Q0e(t,e,n,r,i){const{paths:s,hasZ:o,hasM:a}=t,l=[];if(!rye(s,o??!1,a??!1,e,l,r,i))return null;const c=o||Gg(r);return n.paths=l,n.spatialReference=r,n.hasZ=c,n.hasM=a,n}function eye(t,e,n=e.spatialReference,r=0){return t.spatialReference!=null&&n!=null&&tye(t,t.spatialReference,e,n,r)!=null}function tye(t,e,n,r,i){const{rings:s,hasZ:o,hasM:a}=t,l=[];if(!rye(s,o??!1,a??!1,e,l,r,i))return null;const c=o||Gg(r);return n.rings=l,n.spatialReference=r,n.hasZ=c,n.hasM=a,n}function dBe(t,e,n=e.spatialReference,r=0){return t.spatialReference!=null&&n!=null&&nye(t,t.spatialReference,e,n,r)!=null}function nye(t,e,n,r,i){const{xmin:s,ymin:o,xmax:a,ymax:l,hasZ:c,hasM:u}=t,h=c?t.zmin:i;if(!Yte(s,o,h,e,ia,r))return null;const f=c||Gg(r);n.xmin=ia[0],n.ymin=ia[1],f&&(n.zmin=ia[2]);const g=c?t.zmax:i;return Yte(a,l,g,e,ia,r)?(n.xmax=ia[0],n.ymax=ia[1],f&&(n.zmax=ia[2]),u&&(n.mmin=t.mmin,n.mmax=t.mmax),n.spatialReference=r,n):null}function rye(t,e,n,r,i,s,o=0){const a=new Array;for(const u of t)for(const h of u)a.push(h[0],h[1],e?h[2]:o);if(!CI(a,r,0,a,s,0))return!1;let l=0;i.length=0;const c=e||Gg(s);for(const u of t){const h=new Array;for(const f of u)c&&n?h.push([a[l++],a[l++],a[l++],f[3]]):c?h.push([a[l++],a[l++],a[l++]]):n?(h.push([a[l++],a[l++],f[2]]),l++):(h.push([a[l++],a[l++]]),l++);i.push(h)}return!0}const ia=a0(),DRt=Object.freeze(Object.defineProperty({__proto__:null,canProjectWithoutEngine:bh,initializeProjection:X0e,isEqualBaseGCS:lBe,isLoaded:kp,isLoadedOrLoad:W0e,isLoadedOrLoadFor:H0e,load:Bg,project:yv,projectExtent:dBe,projectMany:X9,projectMultipoint:uBe,projectOrLoad:sBe,projectOrLoadMany:q0e,projectPoint:cBe,projectPolygon:eye,projectPolyline:hBe,projectWithZConversion:Y0e,projectWithoutEngine:DM,requiresLoad:rBe,test:aBe,tryProjectWithZConversion:Jk,unload:oBe},Symbol.toStringTag,{value:"Module"}));var jM;let Z9=jM=class extends o0(Ot.ofType(wi)){constructor(t){super(t)}clone(){return new jM(this.items.map(t=>t.clone()))}write(t,e){return this.toJSON(e)}toJSON(t){const e=t?.layer?.spatialReference;return e?this.toArray().map(n=>{if(!e.equals(n.spatialReference)){if(!bh(n.spatialReference,e))return t?.messages?.push(new Ld("scenefilter:unsupported","Scene filters with incompatible spatial references are not supported",{modification:this,spatialReference:t.layer.spatialReference,context:t})),null;const i=new wi;eye(n,i,e),n=i}const r=n.toJSON(t);return delete r.spatialReference,r}).filter(n=>n!=null):this.toArray().map(n=>n.toJSON(t))}static fromJSON(t,e){const n=new jM;return t.forEach(r=>n.add(wi.fromJSON(r,e))),n}};Z9=jM=x([ue("esri.layers.support.PolygonCollection")],Z9);const bT=Z9;let wf=class extends o0(iW){constructor(e){super(e),this.id=`focusarea-${AI()}`,this.title=null,this.enabled=!0,this.outline=null,this.geometries=new bT}readGeometries(e,n,r){Array.isArray(e)?this.geometries=bT.fromJSON(e,r):r.origin!=="web-scene"&&r.origin!=="portal-item"||r.hooks?.onAfterLoad?.(()=>this._loadGeometries(ab(e,r),r))}async _loadGeometries(e,n){const r=await ns(e,{responseType:"json"});this.geometries=bT.fromJSON(r.data,n)}};x([E({type:String,nonNullable:!0,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}}}),E()],wf.prototype,"id",void 0),x([E({type:String,json:{write:!0}})],wf.prototype,"title",void 0),x([E({type:Boolean,nonNullable:!0,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}}})],wf.prototype,"enabled",void 0),x([E({type:Rze,json:{write:!0}})],wf.prototype,"outline",void 0),x([E({type:bT,nonNullable:!0,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}},clonable:t=>new bT(t.items.map(e=>e.clone()))}),Sze({origins:["web-scene","portal-item"],type:"resource",prefix:"geometries",contentAddressed:!0})],wf.prototype,"geometries",void 0),x([cr(["web-scene","portal-item","service"],"geometries")],wf.prototype,"readGeometries",null),wf=x([ue("esri.effects.FocusArea")],wf);const fBe=wf;let yS=class extends o0(iW){constructor(e){super(e),this.areas=new Ot,this.style="bright"}};x([E({type:Ot.ofType(fBe),nonNullable:!0,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}},clonable:t=>new Ot(t.items.map(e=>e.clone()))})],yS.prototype,"areas",void 0),x([E({type:["bright","dark"],nonNullable:!0,json:{write:!0}})],yS.prototype,"style",void 0),yS=x([ue("esri.effects.FocusAreas")],yS);const iye=yS;function pBe(t){return typeof t=="object"&&t!=null&&"loaded"in t&&t.loaded===!0&&"type"in t}function mBe(t){return!(!pBe(t)||!BVe(t)?.operations?.supportsEditing||"editingEnabled"in t&&!HVe(t)||Nge(t))}const gBe=/^-?(\d+(\.\d+)?)\s*((px)|(pt))?$/i,yBe="screenUtils.toPt: input not recognized!",sye=96;function FRt(t){return t?t/72*sye:0}function q1(t){return t?72*t/sye:0}function Si(t){if(typeof t=="string"){const e=t.match(gBe);if(e){const n=Number(e[1]),r=e[3]&&e[3].toLowerCase(),i=t.startsWith("-"),s=r==="px"?q1(n):n;return i?-s:s}return console.warn(yBe),null}return t}function Hs(t=0,e=0){return{x:t,y:e}}function VRt(t){return t?Hs(t.x,t.y):null}function zRt(t=0,e=0){return[t,e]}function GRt(t=0,e=0,n=0){return[t,e,n]}function URt(t){return t}function BRt(t){return t}function WRt(t){return t}function HRt(t,e){return e?(e[0]=t.x,e[1]=t.y,e.length>2&&(e[2]=0),e):[t.x,t.y]}function oye(){const t=new Float32Array(16);return t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function vBe(t){const e=new Float32Array(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function _Be(t,e,n,r,i,s,o,a,l,c,u,h,f,g,y,_){const b=new Float32Array(16);return b[0]=t,b[1]=e,b[2]=n,b[3]=r,b[4]=i,b[5]=s,b[6]=o,b[7]=a,b[8]=l,b[9]=c,b[10]=u,b[11]=h,b[12]=f,b[13]=g,b[14]=y,b[15]=_,b}const xBe=oye();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:xBe,clone:vBe,create:oye,fromValues:_Be},Symbol.toStringTag,{value:"Module"}));function aye(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function wBe(t,e,n,r,i,s,o,a,l,c,u,h,f,g,y,_,b){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=s,t[5]=o,t[6]=a,t[7]=l,t[8]=c,t[9]=u,t[10]=h,t[11]=f,t[12]=g,t[13]=y,t[14]=_,t[15]=b,t}function XO(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function bBe(t,e){if(t===e){const n=e[1],r=e[2],i=e[3],s=e[6],o=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=s,t[11]=e[14],t[12]=i,t[13]=o,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function EBe(t,e){return lye(t,e)||XO(t),t}function lye(t,e){const n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=e[9],f=e[10],g=e[11],y=e[12],_=e[13],b=e[14],T=e[15],A=n*a-r*o,I=n*l-i*o,P=n*c-s*o,R=r*l-i*a,D=r*c-s*a,C=i*c-s*l,M=u*_-h*y,O=u*b-f*y,j=u*T-g*y,V=h*b-f*_,U=h*T-g*_,G=f*T-g*b;let de=A*G-I*U+P*V+R*j-D*O+C*M;return de?(de=1/de,t[0]=(a*G-l*U+c*V)*de,t[1]=(i*U-r*G-s*V)*de,t[2]=(_*C-b*D+T*R)*de,t[3]=(f*D-h*C-g*R)*de,t[4]=(l*j-o*G-c*O)*de,t[5]=(n*G-i*j+s*O)*de,t[6]=(b*P-y*C-T*I)*de,t[7]=(u*C-f*P+g*I)*de,t[8]=(o*U-a*j+c*M)*de,t[9]=(r*j-n*U-s*M)*de,t[10]=(y*D-_*P+T*A)*de,t[11]=(h*P-u*D-g*A)*de,t[12]=(a*O-o*V-l*M)*de,t[13]=(n*V-r*O+i*M)*de,t[14]=(_*I-y*R-b*A)*de,t[15]=(u*R-h*I+f*A)*de,t):null}function SBe(t,e){const n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=e[9],f=e[10],g=e[11],y=e[12],_=e[13],b=e[14],T=e[15];return t[0]=a*(f*T-g*b)-h*(l*T-c*b)+_*(l*g-c*f),t[1]=-(r*(f*T-g*b)-h*(i*T-s*b)+_*(i*g-s*f)),t[2]=r*(l*T-c*b)-a*(i*T-s*b)+_*(i*c-s*l),t[3]=-(r*(l*g-c*f)-a*(i*g-s*f)+h*(i*c-s*l)),t[4]=-(o*(f*T-g*b)-u*(l*T-c*b)+y*(l*g-c*f)),t[5]=n*(f*T-g*b)-u*(i*T-s*b)+y*(i*g-s*f),t[6]=-(n*(l*T-c*b)-o*(i*T-s*b)+y*(i*c-s*l)),t[7]=n*(l*g-c*f)-o*(i*g-s*f)+u*(i*c-s*l),t[8]=o*(h*T-g*_)-u*(a*T-c*_)+y*(a*g-c*h),t[9]=-(n*(h*T-g*_)-u*(r*T-s*_)+y*(r*g-s*h)),t[10]=n*(a*T-c*_)-o*(r*T-s*_)+y*(r*c-s*a),t[11]=-(n*(a*g-c*h)-o*(r*g-s*h)+u*(r*c-s*a)),t[12]=-(o*(h*b-f*_)-u*(a*b-l*_)+y*(a*f-l*h)),t[13]=n*(h*b-f*_)-u*(r*b-i*_)+y*(r*f-i*h),t[14]=-(n*(a*b-l*_)-o*(r*b-i*_)+y*(r*l-i*a)),t[15]=n*(a*f-l*h)-o*(r*f-i*h)+u*(r*l-i*a),t}function TBe(t){const e=t[0],n=t[1],r=t[2],i=t[3],s=t[4],o=t[5],a=t[6],l=t[7],c=t[8],u=t[9],h=t[10],f=t[11],g=t[12],y=t[13],_=t[14],b=t[15];return(e*o-n*s)*(h*b-f*_)-(e*a-r*s)*(u*b-f*y)+(e*l-i*s)*(u*_-h*y)+(n*a-r*o)*(c*b-f*g)-(n*l-i*o)*(c*_-h*g)+(r*l-i*a)*(c*y-u*g)}function cye(t,e,n){const r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],f=e[9],g=e[10],y=e[11],_=e[12],b=e[13],T=e[14],A=e[15];let I=n[0],P=n[1],R=n[2],D=n[3];return t[0]=I*r+P*a+R*h+D*_,t[1]=I*i+P*l+R*f+D*b,t[2]=I*s+P*c+R*g+D*T,t[3]=I*o+P*u+R*y+D*A,I=n[4],P=n[5],R=n[6],D=n[7],t[4]=I*r+P*a+R*h+D*_,t[5]=I*i+P*l+R*f+D*b,t[6]=I*s+P*c+R*g+D*T,t[7]=I*o+P*u+R*y+D*A,I=n[8],P=n[9],R=n[10],D=n[11],t[8]=I*r+P*a+R*h+D*_,t[9]=I*i+P*l+R*f+D*b,t[10]=I*s+P*c+R*g+D*T,t[11]=I*o+P*u+R*y+D*A,I=n[12],P=n[13],R=n[14],D=n[15],t[12]=I*r+P*a+R*h+D*_,t[13]=I*i+P*l+R*f+D*b,t[14]=I*s+P*c+R*g+D*T,t[15]=I*o+P*u+R*y+D*A,t}function kBe(t,e,n){const r=n[0],i=n[1],s=n[2];if(e===t)t[12]=e[0]*r+e[4]*i+e[8]*s+e[12],t[13]=e[1]*r+e[5]*i+e[9]*s+e[13],t[14]=e[2]*r+e[6]*i+e[10]*s+e[14],t[15]=e[3]*r+e[7]*i+e[11]*s+e[15];else{const o=e[0],a=e[1],l=e[2],c=e[3],u=e[4],h=e[5],f=e[6],g=e[7],y=e[8],_=e[9],b=e[10],T=e[11];t[0]=o,t[1]=a,t[2]=l,t[3]=c,t[4]=u,t[5]=h,t[6]=f,t[7]=g,t[8]=y,t[9]=_,t[10]=b,t[11]=T,t[12]=o*r+u*i+y*s+e[12],t[13]=a*r+h*i+_*s+e[13],t[14]=l*r+f*i+b*s+e[14],t[15]=c*r+g*i+T*s+e[15]}return t}function ABe(t,e,n){const r=n[0],i=n[1],s=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*s,t[9]=e[9]*s,t[10]=e[10]*s,t[11]=e[11]*s,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function IBe(t,e,n,r){let i=r[0],s=r[1],o=r[2],a=Math.sqrt(i*i+s*s+o*o);if(a<=Sl())return void aye(t,e);a=1/a,i*=a,s*=a,o*=a;const l=Math.sin(n),c=Math.cos(n),u=1-c,h=e[0],f=e[1],g=e[2],y=e[3],_=e[4],b=e[5],T=e[6],A=e[7],I=e[8],P=e[9],R=e[10],D=e[11],C=i*i*u+c,M=s*i*u+o*l,O=o*i*u-s*l,j=i*s*u-o*l,V=s*s*u+c,U=o*s*u+i*l,G=i*o*u+s*l,de=s*o*u-i*l,Ie=o*o*u+c;t[0]=h*C+_*M+I*O,t[1]=f*C+b*M+P*O,t[2]=g*C+T*M+R*O,t[3]=y*C+A*M+D*O,t[4]=h*j+_*V+I*U,t[5]=f*j+b*V+P*U,t[6]=g*j+T*V+R*U,t[7]=y*j+A*V+D*U,t[8]=h*G+_*de+I*Ie,t[9]=f*G+b*de+P*Ie,t[10]=g*G+T*de+R*Ie,t[11]=y*G+A*de+D*Ie,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15])}function PBe(t,e,n){const r=Math.sin(n),i=Math.cos(n),s=e[4],o=e[5],a=e[6],l=e[7],c=e[8],u=e[9],h=e[10],f=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=s*i+c*r,t[5]=o*i+u*r,t[6]=a*i+h*r,t[7]=l*i+f*r,t[8]=c*i-s*r,t[9]=u*i-o*r,t[10]=h*i-a*r,t[11]=f*i-l*r,t}function CBe(t,e,n){const r=Math.sin(n),i=Math.cos(n),s=e[0],o=e[1],a=e[2],l=e[3],c=e[8],u=e[9],h=e[10],f=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i-c*r,t[1]=o*i-u*r,t[2]=a*i-h*r,t[3]=l*i-f*r,t[8]=s*r+c*i,t[9]=o*r+u*i,t[10]=a*r+h*i,t[11]=l*r+f*i,t}function RBe(t,e,n){const r=Math.sin(n),i=Math.cos(n),s=e[0],o=e[1],a=e[2],l=e[3],c=e[4],u=e[5],h=e[6],f=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i+c*r,t[1]=o*i+u*r,t[2]=a*i+h*r,t[3]=l*i+f*r,t[4]=c*i-s*r,t[5]=u*i-o*r,t[6]=h*i-a*r,t[7]=f*i-l*r,t}function MBe(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function NBe(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function OBe(t,e,n){if(e===0)return XO(t);let r=n[0],i=n[1],s=n[2],o=Math.sqrt(r*r+i*i+s*s);if(o<=Sl())return null;o=1/o,r*=o,i*=o,s*=o;const a=Math.sin(e),l=Math.cos(e),c=1-l;return t[0]=r*r*c+l,t[1]=i*r*c+s*a,t[2]=s*r*c-i*a,t[3]=0,t[4]=r*i*c-s*a,t[5]=i*i*c+l,t[6]=s*i*c+r*a,t[7]=0,t[8]=r*s*c+i*a,t[9]=i*s*c-r*a,t[10]=s*s*c+l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function LBe(t,e){const n=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function DBe(t,e){const n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function jBe(t,e){const n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function uye(t,e,n){const r=e[0],i=e[1],s=e[2],o=e[3],a=r+r,l=i+i,c=s+s,u=r*a,h=r*l,f=r*c,g=i*l,y=i*c,_=s*c,b=o*a,T=o*l,A=o*c;return t[0]=1-(g+_),t[1]=h+A,t[2]=f-T,t[3]=0,t[4]=h-A,t[5]=1-(u+_),t[6]=y+b,t[7]=0,t[8]=f+T,t[9]=y-b,t[10]=1-(u+g),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function $Be(t,e){const n=FBe,r=-e[0],i=-e[1],s=-e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=r*r+i*i+s*s+o*o;return h>0?(n[0]=2*(a*o+u*r+l*s-c*i)/h,n[1]=2*(l*o+u*i+c*r-a*s)/h,n[2]=2*(c*o+u*s+a*i-l*r)/h):(n[0]=2*(a*o+u*r+l*s-c*i),n[1]=2*(l*o+u*i+c*r-a*s),n[2]=2*(c*o+u*s+a*i-l*r)),uye(t,e,n),t}const FBe=a0();function VBe(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function zBe(t,e){const n=e[0],r=e[1],i=e[2],s=e[4],o=e[5],a=e[6],l=e[8],c=e[9],u=e[10];return t[0]=Math.sqrt(n*n+r*r+i*i),t[1]=Math.sqrt(s*s+o*o+a*a),t[2]=Math.sqrt(l*l+c*c+u*u),t}function GBe(t,e){const n=e[0]+e[5]+e[10];let r=0;return n>0?(r=2*Math.sqrt(n+1),t[3]=.25*r,t[0]=(e[6]-e[9])/r,t[1]=(e[8]-e[2])/r,t[2]=(e[1]-e[4])/r):e[0]>e[5]&&e[0]>e[10]?(r=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/r,t[0]=.25*r,t[1]=(e[1]+e[4])/r,t[2]=(e[8]+e[2])/r):e[5]>e[10]?(r=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/r,t[0]=(e[1]+e[4])/r,t[1]=.25*r,t[2]=(e[6]+e[9])/r):(r=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/r,t[0]=(e[8]+e[2])/r,t[1]=(e[6]+e[9])/r,t[2]=.25*r),t}function UBe(t,e,n,r){const i=e[0],s=e[1],o=e[2],a=e[3],l=i+i,c=s+s,u=o+o,h=i*l,f=i*c,g=i*u,y=s*c,_=s*u,b=o*u,T=a*l,A=a*c,I=a*u,P=r[0],R=r[1],D=r[2];return t[0]=(1-(y+b))*P,t[1]=(f+I)*P,t[2]=(g-A)*P,t[3]=0,t[4]=(f-I)*R,t[5]=(1-(h+b))*R,t[6]=(_+T)*R,t[7]=0,t[8]=(g+A)*D,t[9]=(_-T)*D,t[10]=(1-(h+y))*D,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function BBe(t,e,n,r,i){const s=e[0],o=e[1],a=e[2],l=e[3],c=s+s,u=o+o,h=a+a,f=s*c,g=s*u,y=s*h,_=o*u,b=o*h,T=a*h,A=l*c,I=l*u,P=l*h,R=r[0],D=r[1],C=r[2],M=i[0],O=i[1],j=i[2],V=(1-(_+T))*R,U=(g+P)*R,G=(y-I)*R,de=(g-P)*D,Ie=(1-(f+T))*D,ze=(b+A)*D,Ne=(y+I)*C,fe=(b-A)*C,De=(1-(f+_))*C;return t[0]=V,t[1]=U,t[2]=G,t[3]=0,t[4]=de,t[5]=Ie,t[6]=ze,t[7]=0,t[8]=Ne,t[9]=fe,t[10]=De,t[11]=0,t[12]=n[0]+M-(V*M+de*O+Ne*j),t[13]=n[1]+O-(U*M+Ie*O+fe*j),t[14]=n[2]+j-(G*M+ze*O+De*j),t[15]=1,t}function WBe(t,e){const n=e[0],r=e[1],i=e[2],s=e[3],o=n+n,a=r+r,l=i+i,c=n*o,u=r*o,h=r*a,f=i*o,g=i*a,y=i*l,_=s*o,b=s*a,T=s*l;return t[0]=1-h-y,t[1]=u+T,t[2]=f-b,t[3]=0,t[4]=u-T,t[5]=1-c-y,t[6]=g+_,t[7]=0,t[8]=f+b,t[9]=g-_,t[10]=1-c-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function HBe(t,e,n,r,i,s,o){const a=1/(n-e),l=1/(i-r),c=1/(s-o);return t[0]=2*s*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*s*l,t[6]=0,t[7]=0,t[8]=(n+e)*a,t[9]=(i+r)*l,t[10]=(o+s)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*s*2*c,t[15]=0,t}function qBe(t,e,n,r,i){const s=1/Math.tan(e/2);let o;return t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==1/0?(o=1/(r-i),t[10]=(i+r)*o,t[14]=2*i*r*o):(t[10]=-1,t[14]=-2*r),t}function KBe(t,e,n,r){const i=Math.tan(e.upDegrees*Math.PI/180),s=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),a=Math.tan(e.rightDegrees*Math.PI/180),l=2/(o+a),c=2/(i+s);return t[0]=l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-(o-a)*l*.5,t[9]=(i-s)*c*.5,t[10]=r/(n-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*n/(n-r),t[15]=0,t}function YBe(t,e,n,r,i,s,o){const a=1/(e-n),l=1/(r-i),c=1/(s-o);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*a,t[13]=(i+r)*l,t[14]=(o+s)*c,t[15]=1,t}function XBe(t,e,n,r){const i=e[0],s=e[1],o=e[2];let a=i-n[0],l=s-n[1],c=o-n[2];const u=Sl();if(Math.abs(a)<u&&Math.abs(l)<u&&Math.abs(c)<u)return void XO(t);let h=1/Math.sqrt(a*a+l*l+c*c);a*=h,l*=h,c*=h;const f=r[0],g=r[1],y=r[2];let _=g*c-y*l,b=y*a-f*c,T=f*l-g*a;h=Math.sqrt(_*_+b*b+T*T),h?(h=1/h,_*=h,b*=h,T*=h):(_=0,b=0,T=0);let A=l*T-c*b,I=c*_-a*T,P=a*b-l*_;h=Math.sqrt(A*A+I*I+P*P),h?(h=1/h,A*=h,I*=h,P*=h):(A=0,I=0,P=0),t[0]=_,t[1]=A,t[2]=a,t[3]=0,t[4]=b,t[5]=I,t[6]=l,t[7]=0,t[8]=T,t[9]=P,t[10]=c,t[11]=0,t[12]=-(_*i+b*s+T*o),t[13]=-(A*i+I*s+P*o),t[14]=-(a*i+l*s+c*o),t[15]=1}function ZBe(t,e,n,r){const i=e[0],s=e[1],o=e[2],a=r[0],l=r[1],c=r[2];let u=i-n[0],h=s-n[1],f=o-n[2],g=u*u+h*h+f*f;g>0&&(g=1/Math.sqrt(g),u*=g,h*=g,f*=g);let y=l*f-c*h,_=c*u-a*f,b=a*h-l*u;return g=y*y+_*_+b*b,g>0&&(g=1/Math.sqrt(g),y*=g,_*=g,b*=g),t[0]=y,t[1]=_,t[2]=b,t[3]=0,t[4]=h*b-f*_,t[5]=f*y-u*b,t[6]=u*_-h*y,t[7]=0,t[8]=u,t[9]=h,t[10]=f,t[11]=0,t[12]=i,t[13]=s,t[14]=o,t[15]=1,t}function JBe(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function QBe(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+t[6]**2+t[7]**2+t[8]**2+t[9]**2+t[10]**2+t[11]**2+t[12]**2+t[13]**2+t[14]**2+t[15]**2)}function eWe(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t}function hye(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}function tWe(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t}function nWe(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t[9]=e[9]+n[9]*r,t[10]=e[10]+n[10]*r,t[11]=e[11]+n[11]*r,t[12]=e[12]+n[12]*r,t[13]=e[13]+n[13]*r,t[14]=e[14]+n[14]*r,t[15]=e[15]+n[15]*r,t}function rWe(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function iWe(t,e){if(t===e)return!0;const n=t[0],r=t[1],i=t[2],s=t[3],o=t[4],a=t[5],l=t[6],c=t[7],u=t[8],h=t[9],f=t[10],g=t[11],y=t[12],_=t[13],b=t[14],T=t[15],A=e[0],I=e[1],P=e[2],R=e[3],D=e[4],C=e[5],M=e[6],O=e[7],j=e[8],V=e[9],U=e[10],G=e[11],de=e[12],Ie=e[13],ze=e[14],Ne=e[15],fe=Sl();return Math.abs(n-A)<=fe*Math.max(1,Math.abs(n),Math.abs(A))&&Math.abs(r-I)<=fe*Math.max(1,Math.abs(r),Math.abs(I))&&Math.abs(i-P)<=fe*Math.max(1,Math.abs(i),Math.abs(P))&&Math.abs(s-R)<=fe*Math.max(1,Math.abs(s),Math.abs(R))&&Math.abs(o-D)<=fe*Math.max(1,Math.abs(o),Math.abs(D))&&Math.abs(a-C)<=fe*Math.max(1,Math.abs(a),Math.abs(C))&&Math.abs(l-M)<=fe*Math.max(1,Math.abs(l),Math.abs(M))&&Math.abs(c-O)<=fe*Math.max(1,Math.abs(c),Math.abs(O))&&Math.abs(u-j)<=fe*Math.max(1,Math.abs(u),Math.abs(j))&&Math.abs(h-V)<=fe*Math.max(1,Math.abs(h),Math.abs(V))&&Math.abs(f-U)<=fe*Math.max(1,Math.abs(f),Math.abs(U))&&Math.abs(g-G)<=fe*Math.max(1,Math.abs(g),Math.abs(G))&&Math.abs(y-de)<=fe*Math.max(1,Math.abs(y),Math.abs(de))&&Math.abs(_-Ie)<=fe*Math.max(1,Math.abs(_),Math.abs(Ie))&&Math.abs(b-ze)<=fe*Math.max(1,Math.abs(b),Math.abs(ze))&&Math.abs(T-Ne)<=fe*Math.max(1,Math.abs(T),Math.abs(Ne))}function sWe(t){const e=Sl(),n=t[0],r=t[1],i=t[2],s=t[4],o=t[5],a=t[6],l=t[8],c=t[9],u=t[10];return Math.abs(1-(n*n+s*s+l*l))<=e&&Math.abs(1-(r*r+o*o+c*c))<=e&&Math.abs(1-(i*i+a*a+u*u))<=e}function oWe(t){return t[0]===1&&t[1]===0&&t[2]===0&&t[4]===0&&t[5]===1&&t[6]===0&&t[8]===0&&t[9]===0&&t[10]===1}const aWe=cye,lWe=hye;Object.freeze(Object.defineProperty({__proto__:null,add:eWe,adjoint:SBe,copy:aye,determinant:TBe,equals:iWe,exactEquals:rWe,frob:QBe,fromQuat:WBe,fromQuat2:$Be,fromRotation:OBe,fromRotationTranslation:uye,fromRotationTranslationScale:UBe,fromRotationTranslationScaleOrigin:BBe,fromScaling:NBe,fromTranslation:MBe,fromXRotation:LBe,fromYRotation:DBe,fromZRotation:jBe,frustum:HBe,getRotation:GBe,getScale:zBe,getTranslation:VBe,hasIdentityRotation:oWe,identity:XO,invert:lye,invertOrIdentity:EBe,isOrthoNormal:sWe,lookAt:XBe,mul:aWe,multiply:cye,multiplyScalar:tWe,multiplyScalarAndAdd:nWe,ortho:YBe,perspective:qBe,perspectiveFromFieldOfView:KBe,rotate:IBe,rotateX:PBe,rotateY:CBe,rotateZ:RBe,scale:ABe,set:wBe,str:JBe,sub:lWe,subtract:hye,targetTo:ZBe,translate:kBe,transpose:bBe},Symbol.toStringTag,{value:"Module"}));const qj=()=>kt.getLogger("esri.support.basemapUtils");function cWe(){return{}}function uWe(t){for(const e in t){const n=t[e];n&&!n.destroyed&&n.destroy(),delete t[e]}}function hWe(t,e){let n;if(typeof t=="string"){const r=t in x9,i=!r&&t.includes("/");if(!r&&!i){if(Y8())qj().warn(`Unable to find basemap definition for: ${t}. See available styles at https://developers.arcgis.com/rest/basemap-styles/`);else{const s=Object.entries(x9).filter(([o,a])=>a.classic||a.is3d).map(([o])=>`"${o}"`).sort().join(", ");qj().warn(`Unable to find basemap definition for: ${t}. Try one of these: ${s}`)}return null}e&&(n=e[t]),n||(n=r?yT.fromId(t):new yT({style:{id:t}}),e&&(e[t]=n))}else n=Ha(yT,t);return n?.destroyed&&(qj().warn("The provided basemap is already destroyed",{basemap:n}),n=null),n}function dWe(t){return new th({getCollections:()=>[t.tables,t.layers],getChildrenFunction:e=>{const n=[];return"tables"in e&&n.push(e.tables),"layers"in e&&n.push(e.layers),n},itemFilterFunction:e=>{const n=e.parent;return!!n&&"tables"in n&&n.tables.includes(e)}})}function HC(t){for(const e of t.values())e?.destroy();t.clear()}const Xte={"world-elevation":{id:"worldElevation",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"},"world-topobathymetry":{id:"worldTopoBathymetry",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/TopoBathy3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"}};function fWe(t){let e=null;if(typeof t=="string")if(t in Xte){const n=Xte[t];e=new sN({resourceInfo:{data:{layers:[n]}}})}else kt.getLogger("esri.support.groundUtils").warn(`Unable to find ground definition for: ${t}. Try "world-elevation"`);else e=Ha(sN,t);return e}function J9(t,e,n){let r,i;if(t)for(let s=0,o=t.length;s<o;s++){if(r=t.at(s),r?.[e]===n)return r;if(r?.type==="group"&&(i=J9(r.layers,e,n),i))return i}}const pWe=t=>{const e=t;let n=class extends e{constructor(...r){super(...r),this.layers=new Ot;const i=a=>{a.parent&&a.removeFromParent()},s=a=>{a.parent=this,this.layerAdded(a),a.type!=="elevation"&&a.type!=="base-elevation"||kt.getLogger(this).error(`Layer 'title:${a.title}, id:${a.id}' of type '${a.type}' is not supported as an operational layer and will therefore be ignored.`)},o=a=>{a.parent=null,this.layerRemoved(a)};this.addHandles([this.layers.on("before-add",a=>{if(a.item===this)return a.preventDefault(),void kt.getLogger(this).error("#add()","Cannot add layer to itself.");i(a.item)}),this.layers.on("after-add",a=>s(a.item)),this.layers.on("after-remove",a=>o(a.item))])}destroy(){const r=this.layers.toArray();for(const i of r)i.destroy();this.layers.destroy()}removeChildLayer(r){this.layers.remove(r),super.removeChildLayer?.(r)}set layers(r){this._set("layers",Sd(r,this._get("layers")))}add(r,i){const s=this.layers;if(i=s.getNextIndex(i),r instanceof xi){const o=r;o.parent===this?this.reorder(o,i):s.add(o,i)}else ga(r)?r.then(o=>{this.destroyed||this.add(o,i)}):kt.getLogger(this).error("#add()","The item being added is not a Layer or a Promise that resolves to a Layer.")}addMany(r,i){const s=this.layers;let o=s.getNextIndex(i);r.slice().forEach(a=>{a.parent!==this?(s.add(a,o),o+=1):this.reorder(a,o)})}findLayerById(r){return J9(this.layers,"id",r)}findLayerByUid(r){return J9(this.layers,"uid",r)}remove(r){return this.layers.remove(r)}removeMany(r){return this.layers.removeMany(r)}removeAll(){return this.layers.removeAll()}reorder(r,i){return this.layers.reorder(r,i)}layerAdded(r){}layerRemoved(r){}};return x([E()],n.prototype,"layers",null),n=x([ue("esri.support.LayersMixin")],n),n},mWe=new Set(["feature","subtype-group"]);function Q9(t,e,n){if(t)for(let r=0,i=t.length;r<i;r++){const s=t.at(r);if(s[e]===n)return s;if(s?.type==="group"){const o=Q9(s.tables,e,n);if(o)return o}}}const gWe=t=>{const e=t;let n=class extends e{constructor(...r){super(...r),this.tables=new Ot,this.addHandles([this.tables.on("after-add",i=>{const s=i.item;s.parent&&s.parent!==this&&s.removeFromParent(),s.parent=this,mWe.has(s.type)||kt.getLogger(this).error(`Layer 'title:${s.title}, id:${s.id}' of type '${s.type}' is not supported as a table and will therefore be ignored.`)}),this.tables.on("after-remove",i=>{i.item.parent=null})])}destroy(){const r=this.tables.toArray();for(const i of r)i.destroy();this.tables.destroy()}removeChildLayer(r){this.tables.remove(r),super.removeChildLayer?.(r)}set tables(r){this._set("tables",Sd(r,this._get("tables")))}findTableById(r){return Q9(this.tables,"id",r)}findTableByUid(r){return Q9(this.tables,"uid",r)}};return x([E()],n.prototype,"tables",null),n=x([ue("esri.support.TablesMixin")],n),n};let Vc=class extends gWe(pWe(vI)){constructor(e){super(e),this.allLayers=new th({getCollections:()=>[this.basemap?.baseLayers,this.basemap?.groundLayers,this.ground?.layers,this.layers,this.basemap?.referenceLayers],getChildrenFunction:n=>"layers"in n?n.layers:null}),this.focusAreas=new iye,this.allTables=dWe(this),this.basemap=null,this.editableLayers=new th({getCollections:()=>[this.allLayers],itemFilterFunction:mBe}),this.ground=new sN,this._basemapCache=cWe(),this.addHandles(wc(()=>this.ground,(n,r)=>{r?.parent===this&&(r.parent=null),n.parent=this},{sync:!0}))}destroy(){uWe(this._basemapCache),this._basemapCache=null,this.focusAreas.destroy(),this.allLayers.destroy(),this.allTables.destroy(),this.editableLayers.destroy(),this.basemap=Di(this.basemap),Di(this.ground),this._set("ground",null)}castBasemap(e){return hWe(e,this._basemapCache)}castGround(e){return fWe(e)??this._get("ground")}findLayerById(e){return this.allLayers.find(n=>n.id===e)}findTableById(e){return this.allTables.find(n=>n.id===e)}};x([E({readOnly:!0,dependsOn:[]})],Vc.prototype,"allLayers",void 0),x([E({type:iye,nonNullable:!0,json:{write:{overridePolicy:t=>({enabled:t.areas.length>0,ignoreOrigin:!0})}}})],Vc.prototype,"focusAreas",void 0),x([E({readOnly:!0})],Vc.prototype,"allTables",void 0),x([E({type:yT,json:{read:{source:"baseMap"},write:{target:"baseMap"}}})],Vc.prototype,"basemap",void 0),x([qs("basemap")],Vc.prototype,"castBasemap",null),x([E({readOnly:!0})],Vc.prototype,"editableLayers",void 0),x([E({type:sN,nonNullable:!0})],Vc.prototype,"ground",void 0),x([qs("ground")],Vc.prototype,"castGround",null),x([E()],Vc.prototype,"undoRedo",void 0),Vc=x([ue("esri.Map")],Vc);const dye=Vc;let ty=class extends iW{constructor(e){super(e),this.row=0,this.column=0,this.rows=1,this.columns=1}equals(e){return e!=null&&this.row===e.row&&this.rows===e.rows&&this.column===e.column&&this.columns===e.columns}};x([E({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],ty.prototype,"row",void 0),x([E({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],ty.prototype,"column",void 0),x([E({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],ty.prototype,"rows",void 0),x([E({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],ty.prototype,"columns",void 0),ty=x([ue("esri.CameraLayout")],ty);const fye=ty;let ZO=class{constructor(e,n){this.min=e,this.max=n,this.range=n-e}normalize(e,n=0,r=!1){return Zte(this.range,this.min,this.max,e,n,r)}clamp(e,n=0){return vu(e-n,this.min,this.max)+n}monotonic(e,n,r){return e<n?n:n+e7(this.range,e-n,r)}minimalMonotonic(e,n,r){return Zte(this.range,e,e+this.range,n,r)}center(e,n,r){return n=this.monotonic(e,n,r),this.normalize((e+n)/2,r)}diff(e,n,r){return this.monotonic(e,n,r)-e}shortestSignedDiff(e,n){e=this.normalize(e);const r=(n=this.normalize(n))-e,i=n<e?this.minimalMonotonic(e,n)-e:n-this.minimalMonotonic(n,e);return Math.abs(r)<Math.abs(i)?r:i}contains(e,n,r){return n=this.minimalMonotonic(e,n),(r=this.minimalMonotonic(e,r))>e&&r<n}};function Zte(t,e,n,r,i=0,s=!1){return(r-=i)<e?r+=e7(t,e-r):r>n&&(r-=e7(t,r-n)),s&&r===n&&(r=e),r+i}function e7(t,e,n=0){return Math.ceil((e-n)/t)*t+n}const XRt=new ZO(0,2*Math.PI),ZRt=new ZO(-Math.PI,Math.PI),yWe=new ZO(0,360);let Yh=class extends vo(qt){constructor(...e){super(...e),this.position=new Jt([0,0,0]),this.heading=0,this.tilt=0,this.fov=55,this.layout=new fye}normalizeCtorArgs(e,n,r,i){if(e&&typeof e=="object"&&("x"in e||Array.isArray(e))){const s={position:e};return n!=null&&(s.heading=n),r!=null&&(s.tilt=r),i!=null&&(s.fov=i),s}return e}writePosition(e,n,r,i){const s=e.clone();s.x=sc(e.x||0),s.y=sc(e.y||0),s.z=e.hasZ?sc(e.z||0):e.z,n[r]=s.write({},i)}readPosition(e,n){const r=new Jt;return r.read(e,n),r.x=sc(r.x||0),r.y=sc(r.y||0),r.z=r.hasZ?sc(r.z||0):r.z,r}equals(e){return e!=null&&this.tilt===e.tilt&&this.heading===e.heading&&this.fov===e.fov&&this.position.equals(e.position)&&this.layout.equals(e.layout)}};x([E({type:Jt,json:{write:{isRequired:!0}}})],Yh.prototype,"position",void 0),x([er("position")],Yh.prototype,"writePosition",null),x([cr("position")],Yh.prototype,"readPosition",null),x([E({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),qs(t=>yWe.normalize(sc(t)))],Yh.prototype,"heading",void 0),x([E({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),qs(t=>vu(sc(t),-180,180))],Yh.prototype,"tilt",void 0),x([E({type:Number,nonNullable:!0,json:{default:55,write:!0}}),qs(t=>vu(sc(t,55),1,170))],Yh.prototype,"fov",void 0),x([E({type:fye,nonNullable:!0,json:{read:!1,write:!1}})],Yh.prototype,"layout",void 0),Yh=x([ue("esri.Camera")],Yh);const vWe=Yh;function pye(t){return t.xmin!==void 0&&t.ymin!==void 0&&t.xmax!==void 0&&t.ymax!==void 0}function mye(t){return t.points!==void 0}function gye(t){return t.x!==void 0&&t.y!==void 0}function yye(t){return t.paths!==void 0||t.curvePaths!==void 0}function wW(t){return t.rings!==void 0||t.curveRings!==void 0}function C2(t){return t==null?null:t instanceof Gs?t:gye(t)?Jt.fromJSON(t):yye(t)?Ss.fromJSON(t):wW(t)?wi.fromJSON(t):mye(t)?Ju.fromJSON(t):pye(t)?Vn.fromJSON(t):null}function bW(t){return t?gye(t)?"esriGeometryPoint":yye(t)?"esriGeometryPolyline":wW(t)?"esriGeometryPolygon":pye(t)?"esriGeometryEnvelope":mye(t)?"esriGeometryMultipoint":null:null}const _We={esriGeometryPoint:Jt,esriGeometryPolyline:Ss,esriGeometryPolygon:wi,esriGeometryEnvelope:Vn,esriGeometryMultipoint:Ju,esriGeometryMultiPatch:wi};function xWe(t){return t&&_We[t]||null}const wWe=Ol()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon"}),QRt=Ol()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh"}),EW={base:Gs,key:"type",typeMap:{extent:Vn,multipoint:Ju,point:Jt,polyline:Ss,polygon:wi}};function eMt(t){return t.type==="point"}function tMt(t){return t.type==="multipoint"}function nMt(t){return t.type==="polygon"}function rMt(t){return t.type==="polyline"}var t7;let wm=t7=class extends qt{constructor(t){super(t),this.rotation=0,this.scale=0,this.targetGeometry=null,this.camera=null}castRotation(t){return(t%=360)<0&&(t+=360),t}clone(){return new t7({rotation:this.rotation,scale:this.scale,targetGeometry:this.targetGeometry!=null?this.targetGeometry.clone():null,camera:this.camera!=null?this.camera.clone():null})}};x([E({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:Kj}}}}})],wm.prototype,"rotation",void 0),x([qs("rotation")],wm.prototype,"castRotation",null),x([E({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:Kj}}}}})],wm.prototype,"scale",void 0),x([E({types:EW,json:{read:C2,write:!0,origins:{"web-scene":{read:C2,write:{overridePolicy:Kj}}}}})],wm.prototype,"targetGeometry",void 0),x([E({type:vWe,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}}})],wm.prototype,"camera",void 0),wm=t7=x([ue("esri.Viewpoint")],wm);const du=wm;function Kj(){return{enabled:!this.camera}}let Qk=class{constructor(e=n=>n.values().next().value){this._peeker=e,this._observable=new _I,this._items=new Set}get length(){return nn(this._observable),this._items.size}clear(){this.length!==0&&(this._items.clear(),this._observable.notify())}last(){if(this.length===0)return;let e;for(e of this._items);return e}peek(){if(this.length!==0)return this._peeker(this._items)}push(e){this.contains(e)||(this._items.add(e),this._observable.notify())}contains(e){return nn(this._observable),this._items.has(e)}pop(){if(this.length===0)return;const e=this.peek();return this._items.delete(e),this._observable.notify(),e}popLast(){if(this.length===0)return;const e=this.last();return this._items.delete(e),this._observable.notify(),e}remove(e){this.contains(e)&&(this._items.delete(e),this._observable.notify())}filter(e){const n=this.length;return this._items.forEach(r=>{e(r)||this._items.delete(r)}),n!==this._items.size&&this._observable.notify(),this}*[Symbol.iterator](){nn(this._observable),yield*this._items}};const vye=new FinalizationRegistry(t=>{t.close()});function bWe(t,e){vye.register(t,e,e)}function EWe(t){vye.unregister(t)}function _ye(t,e){return new Proxy({},{get:(n,r,i)=>(...s)=>{let o,a;const l=s[s.length-1];return SWe(l)&&(o=l.signal,a=l.transferList,s.pop()),t.apply(e?`${e}.${r.toString()}`:r.toString(),s,{transferList:a,signal:o})}})}function SWe(t){return typeof t=="object"&&!Array.isArray(t)&&t!=null&&("signal"in t||"transferList"in t||Object.keys(t).length===0)}const TWe={statsWorker:()=>_e(()=>import("./statsWorker-DE7ff43w.js"),__vite__mapDeps([49,50,51,52,53,54,55,56,57])),geometryEngineWorker:()=>_e(()=>import("./geometryEngineWorker-BkMQzpX8.js"),__vite__mapDeps([58,59,60,61])),arcadeGeometryOperatorsWorker:()=>_e(()=>import("./operatorsWorker-BnhJS8RJ.js"),[]),CSVSourceWorker:()=>_e(()=>import("./CSVSourceWorker-BMxFtt5l.js"),__vite__mapDeps([62,63,64,26,65,66,67,68,69,70,71,72,73,74,24,25,75,76,77,78,79,51,50,52,53,54,55,56,57,80,81,82,83,84,85,86,87])),EdgeProcessingWorker:()=>_e(()=>import("./EdgeProcessingWorker-hVK5erMg.js"),__vite__mapDeps([88,89,90,91,53,54,92,93,94,95,96,97,98])),ElevationSamplerWorker:()=>_e(()=>import("./ElevationSamplerWorker-DaTlFgKN.js"),__vite__mapDeps([99,69,100,101,102,103,104,105,106,91,53,54,107])),FeatureServiceSnappingSourceWorker:()=>_e(()=>import("./FeatureServiceSnappingSourceWorker-DIRh2TGy.js"),__vite__mapDeps([108,65,66,64,26,67,68,69,70,71,72,73,74,24,25,75,76,77,78,79,51,50,52,53,54,55,56,57,80,81,82,83,30,31,109,110,111,112,113])),GaussianSplatSortWorker:()=>_e(()=>import("./GaussianSplatSortWorker-CkystscD.js"),[]),GeoJSONSourceWorker:()=>_e(()=>import("./GeoJSONSourceWorker-QnrLeICt.js"),__vite__mapDeps([114,66,64,26,67,65,68,69,70,71,72,73,74,24,25,75,76,77,78,79,51,50,52,53,54,55,56,57,80,81,82,83,115,63,86,87,116])),LercWorker:()=>_e(()=>import("./LercWorker-BpzpQ4W_.js"),[]),MemorySourceWorker:()=>_e(()=>import("./MemorySourceWorker-fUIAN2Yh.js"),__vite__mapDeps([117,66,64,26,67,118,65,68,69,70,71,72,73,74,24,25,75,76,77,78,79,51,50,52,53,54,55,56,57,80,81,82,83,86,87,116,63])),PBFDecoderWorker:()=>_e(()=>import("./PBFDecoderWorker-B_6Xl-mR.js"),__vite__mapDeps([119,120,26,66,64,67,110,111])),FeaturePipelineWorker:()=>_e(()=>import("./FeaturePipelineWorker-Ggp6QCA7.js"),__vite__mapDeps([121,122,123,124,125,93,126,127,76,77,78,83,128,64,26,66,67,129,51,130,131,132,133,71,70,134,135,136,137,138,139,140,141,142,87,143,144,145,146,72,73,74,24,25,75,79,50,52,53,54,55,56,57,80,81,82,147,148,149,150,47,151,152,153,154,155,115,63,86,116,112,110,111,113,156,157])),PointCloudWorker:()=>_e(()=>import("./PointCloudWorker-CxWeMIVs.js"),__vite__mapDeps([158,159,160,53,161,162,163,164,165,166,54,102,103,167,168])),RasterWorker:()=>_e(()=>import("./RasterWorker-DmCrRyko.js"),__vite__mapDeps([169,170,171,61,172,173,53,54,174,175,176,177,178,179])),SceneLayerSnappingSourceWorker:()=>_e(()=>import("./SceneLayerSnappingSourceWorker-Cz556_yO.js"),__vite__mapDeps([180,181,182,54,168,160,183,184,53,167,91,95,96,97,90,92,93,94,98])),SceneLayerWorker:()=>_e(()=>import("./SceneLayerWorker-Df6RePjv.js"),__vite__mapDeps([185,100,106,186,104])),WFSSourceWorker:()=>_e(()=>import("./WFSSourceWorker-BKZkLVzG.js"),__vite__mapDeps([187,66,64,26,67,65,68,69,70,71,72,73,74,24,25,75,76,77,78,79,51,50,52,53,54,55,56,57,80,81,82,83,115,63,116,188,189])),WorkerTileHandler:()=>_e(()=>import("./WorkerTileHandler-CESIaOou.js"),__vite__mapDeps([190,140,191,141,192,111,26,144,193,194,94,93,173,53,54,195,139])),Lyr3DWorker:()=>_e(()=>import("./Lyr3DWorker-Oo7R3YWw.js"),[]),Feature3DPipelineWorker:()=>_e(()=>import("./Feature3DPipelineWorker-CrzRpzX_.js"),__vite__mapDeps([196,73,66,64,26,67,74,24,25,75,76,77,78,70,71,79,51,50,52,53,54,55,56,57,80,81,82,83,197,198,199,200,177,164,201,31,202,203,142,87,163,135,127,131,132,204,205,122,206,207,105,100,186,104,208,161,209,97,91,210,182,168,160,181,211,212,184,167,166,159,102,103,94,93,90,92,213,214,215,216,217,218,219,220,221,222,69,112,110,111,113,223])),TextureCompressionWorker:()=>_e(()=>import("./TextureCompressionWorker-wkg_sv7Q.js"),[]),FlowWorker:()=>_e(()=>import("./FlowWorker-BIPsXp8K.js"),__vite__mapDeps([224,179])),ParquetSourceWorker:()=>_e(()=>import("./ParquetSourceWorker-CBzzjH_q.js"),__vite__mapDeps([225,146,73,66,64,26,67,74,24,25,75,76,77,78,70,71,79,51,50,52,53,54,55,56,57,80,81,82,83,86,87,226,85,149,128,129,148,147])),PanoramicMeshWorker:()=>_e(()=>import("./PanoramicMeshWorker-lGEBlIlk.js"),__vite__mapDeps([227,170]))},xye="worker:port-closed",rp={HANDSHAKE:0,OPEN:1,OPENED:2,RESPONSE:3,INVOKE:4,ABORT:5,CLOSE:6,OPEN_PORT:7,ON:8};let kWe=0;function wye(){return kWe++}function AWe(t){return t&&typeof t=="object"&&("result"in t||"transferList"in t)}function lN(t){return t?typeof t=="string"?JSON.stringify({name:"message",message:t}):t.toJSON?JSON.stringify(t):JSON.stringify({name:t.name,message:t.message,details:t.details||{stack:t.stack}}):null}function bye(t,e,n,r){if(e.type===rp.OPEN_PORT)return void t.postMessage(e,[e.port]);if(e.type!==rp.INVOKE&&e.type!==rp.RESPONSE)return void t.postMessage(e);let i;AWe(n)?(i=Jte(n.transferList),e.data=n.result):(i=Jte(r),e.data=n),i?t.postMessage(e,i):t.postMessage(e)}function eA(t){if(!t)return null;const e=t.data;return e?typeof e=="string"?JSON.parse(e):e:null}function Jte(t){if(!t?.length)return null;if(ye("esri-workers-arraybuffer-transfer"))return t;const e=t.filter(n=>!IWe(n));return e.length?e:null}function IWe(t){return t instanceof ArrayBuffer||t?.constructor?.name==="ArrayBuffer"}async function sMt(t){try{return await t}catch(e){const n=e?.name===xye;if(!(wa(e)||n))throw e;return}}const{CLOSE:qC,ABORT:n7,INVOKE:Qte,RESPONSE:jE,OPEN_PORT:ene,ON:tne}=rp,PWe=2;let CWe=class{constructor(e){this._invoke=e,this._timer=null,this._cancelledJobIds=new Set,this._invokeMessages=[],this._timer=null,this._process=this._process.bind(this)}push(e){e.type===n7?this._cancelledJobIds.add(e.jobId):(this._invokeMessages.push(e),this._timer===null&&(this._timer=setTimeout(this._process,0)))}clear(){this._invokeMessages.length=0,this._cancelledJobIds.clear(),this._timer=null}_process(){this._timer=null;for(const e of this._invokeMessages)this._cancelledJobIds.has(e.jobId)||this._invoke(e);this._cancelledJobIds.clear(),this._invokeMessages.length=0}};var Zc;let R2=(Zc=class{static connect(e,n){const r=new MessageChannel;let i;i=typeof e=="function"?new e:"default"in e&&typeof e.default=="function"?new e.default:e;const s=new Zc(r.port1,{channel:r,client:i,schedule:n});return typeof i=="object"&&"remoteClient"in i&&(i.remoteClient=s),Zc.clients.set(s,i),r.port2}static loadWorker(e){const n=TWe[e];return n?n():Promise.resolve(null)}constructor(e,n,r,i){this._port=e,this._jobQueue=r,this._lowPriorityJobQueue=i,this._outJobs=new Map,this._inJobs=new Map,this._invokeQueue=new CWe(s=>this._onInvokeMessage(s)),this._client=n.client,this._onMessage=this._onMessage.bind(this),this._channel=n.channel,this._schedule=n.schedule,this._port.addEventListener("message",this._onMessage),this._port.start()}close(){this._post({type:qC}),this._close()}isBusy(){return this._outJobs.size>0}invoke(e,n,r){return this.apply(e,[n],r)}apply(e,n,r){const i=r?.signal,s=r?.transferList;if(!this._port)return Promise.reject(new Xe(xye,`Cannot call invoke('${e}'), port is closed`,{methodName:e,data:n}));const o=wye();return new Promise((a,l)=>{if(ma(i))return this._processWork(),void l(Pr());const c=yu(i,()=>{const h=this._outJobs.get(o);h&&(this._outJobs.delete(o),this._processWork(),ii(h.abortHandle),this._post({type:n7,jobId:o}),l(Pr()))}),u={resolve:a,reject:l,abortHandle:c,debugInfo:e};this._outJobs.set(o,u),this._post({type:Qte,jobId:o,methodName:e,abortable:i!=null},n,s)})}createInvokeProxy(e){return _ye(this,e)}on(e,n){const r=new MessageChannel;function i(s){n(s.data)}return this._port.postMessage({type:tne,eventType:e,port:r.port2},[r.port2]),r.port1.addEventListener("message",i),r.port1.start(),Zn(()=>{r.port1.postMessage({type:qC}),r.port1.close(),r.port1.removeEventListener("message",i)})}jobAdded(){this._processWork()}openPort(){const e=new MessageChannel;return this._post({type:ene,port:e.port2}),e.port1}_processWork(){if(this._outJobs.size>=PWe)return;const e=this._jobQueue?.pop()??this._lowPriorityJobQueue?.pop();if(!e)return;const{methodName:n,data:r,invokeOptions:i,resolver:s}=e;this.apply(n,r,i).then(o=>s.resolve(o)).catch(o=>s.reject(o))}_close(){this._channel&&(this._channel=void 0),this._port.removeEventListener("message",this._onMessage),this._port.close(),this._outJobs.forEach(e=>{ii(e.abortHandle),e.reject(Pr(`Worker closing, aborting job calling '${e.debugInfo}'`))}),this._inJobs.clear(),this._outJobs.clear(),this._invokeQueue.clear(),this._port=null,this._client=null,this._schedule=null,this._onMessage=null,this._channel=null,this._jobQueue=void 0,this._invokeQueue=void 0,this._lowPriorityJobQueue=void 0}_onMessage(e){this._schedule!=null?this._schedule(()=>this._processMessage(e,!0)):this._processMessage(e,!1)}_processMessage(e,n){const r=eA(e);if(r)switch(r.type){case jE:this._onResponseMessage(r);break;case Qte:n?this._onInvokeMessage(r):this._invokeQueue.push(r);break;case n7:this._onAbortMessage(r);break;case qC:this._onCloseMessage();break;case ene:this._onOpenPortMessage(r);break;case tne:this._onOnMessage(r)}}_onAbortMessage(e){const n=this._inJobs,r=e.jobId,i=n.get(r);this._invokeQueue.push(e),i&&(i.controller&&i.controller.abort(),n.delete(r))}_onCloseMessage(){const e=this._client;this._close(),e&&"destroy"in e&&Zc.clients.get(this)===e&&e.destroy(),Zc.clients.delete(this),e?.remoteClient&&(e.remoteClient=null)}_onInvokeMessage(e){const{methodName:n,jobId:r,data:i=[],abortable:s}=e,o=s?new AbortController:null,a=this._inJobs;let l,c=this._client,u=c[n];try{if(!u&&n&&n.includes(".")){const h=n.split(".");for(let f=0;f<h.length-1;f++)c=c[h[f]],u=c[h[f+1]]}if(typeof u!="function")throw new TypeError(`${n} is not a function`);i.push({client:this,signal:o?o.signal:null}),l=u.apply(c,i)}catch(h){return void this._post({type:jE,jobId:r,error:lN(h)})}ga(l)?(a.set(r,{controller:o,promise:l}),l.then(h=>{a.has(r)&&(a.delete(r),this._post({type:jE,jobId:r},h))},h=>{a.has(r)&&(a.delete(r),wa(h)||this._post({type:jE,jobId:r,error:lN(h||{message:`Error encountered at method ${n}`})}))})):this._post({type:jE,jobId:r},l)}_onOpenPortMessage(e){new Zc(e.port,{client:this._client})}_onOnMessage(e){const{port:n}=e,r=this._client.on(e.eventType,s=>{n.postMessage(s)}),i=ob(e.port,"message",s=>{eA(s)?.type===qC&&(i.remove(),r.remove(),n.close())})}_onResponseMessage(e){const{jobId:n,error:r,data:i}=e,s=this._outJobs;if(!s.has(n))return;const o=s.get(n);s.delete(n),this._processWork(),ii(o.abortHandle),r?o.reject(Xe.fromJSON(JSON.parse(r))):o.resolve(i)}_post(e,n,r){return bye(this._port,e,n,r)}},Zc.kernelInfo={buildDate:Afe,fullVersion:dB,revision:Ife},Zc.clients=new Map,Zc),RWe=class{constructor(){this._inUseClients=new Array,this._clients=new Array,this._clientPromises=new Array,this._ongoingJobsQueue=new Qk,this._ongoingLowPriorityJobsQueue=new Qk}destroy(){this.close()}get closed(){return!this._clients?.length}open(e,n){return new Promise((r,i)=>{let s=!0;const o=a=>{pi(n.signal),s&&(s=!1,a())};this._clients.length=e.length,this._clientPromises.length=e.length,this._inUseClients.length=e.length;for(let a=0;a<e.length;++a){const l=e[a];ga(l)?this._clientPromises[a]=l.then(c=>(this._clients[a]=new R2(c,n,this._ongoingJobsQueue,this._ongoingLowPriorityJobsQueue),o(r),this._clients[a]),()=>(o(i),null)):(this._clients[a]=new R2(l,n,this._ongoingJobsQueue,this._ongoingLowPriorityJobsQueue),this._clientPromises[a]=Promise.resolve(this._clients[a]),o(r))}})}broadcast(e,n,r){const i=new Array(this._clientPromises.length);for(let s=0;s<this._clientPromises.length;++s){const o=this._clientPromises[s];i[s]=o.then(a=>a?.invoke(e,n,r))}return i}close(){let e;for(;e=this._ongoingJobsQueue.pop();)e.resolver.reject(Pr(`Worker closing, aborting job calling '${e.methodName}'`));for(;e=this._ongoingLowPriorityJobsQueue.pop();)e.resolver.reject(Pr(`Worker closing, aborting job calling '${e.methodName}'`));for(const n of this._clientPromises)n.then(r=>r?.close());this._clients.length=0,this._clientPromises.length=0,this._inUseClients.length=0,EWe(this)}invoke(e,n,r){return this.apply(e,[n],r)}apply(e,n,r){const i=xc();(r?.priority==="low"?this._ongoingLowPriorityJobsQueue:this._ongoingJobsQueue).push({methodName:e,data:n,invokeOptions:r,resolver:i});for(let s=0;s<this._clientPromises.length;s++){const o=this._clients[s];o?o.jobAdded():this._clientPromises[s].then(a=>a?.jobAdded())}return i.promise}createInvokeProxy(e){return _ye(this,e)}on(e,n){return Promise.all(this._clientPromises).then(()=>fv(this._clients.map(r=>r.on(e,n))))}openPorts(){return new Promise(e=>{const n=new Array(this._clientPromises.length);let r=n.length;for(let i=0;i<this._clientPromises.length;++i)this._clientPromises[i].then(s=>{s&&(n[i]=s.openPort()),--r===0&&e(n)})})}get test(){}};const MWe={async request(t,e){const n=t.options,r=n.responseType;n.signal=e?.signal,n.responseType=r==="native"||r==="native-request-init"?"native-request-init":r&&["blob","json","text"].includes(r)&&U8(t.url)?.after?r:"array-buffer";const i=await ns(t.url,n),s={data:i.data,httpStatus:i.httpStatus,ssl:i.ssl};switch(i.requestOptions?.responseType){case"native-request-init":return delete s.data.signal,s;case"blob":s.data=await s.data.arrayBuffer();break;case"json":s.data=new TextEncoder().encode(JSON.stringify(s.data)).buffer;break;case"text":s.data=new TextEncoder().encode(s.data).buffer}return{result:s,transferList:[s.data]}}},nne={};function NWe(t){const e={async:t.async,isDebug:t.isDebug,locale:t.locale,baseUrl:t.baseUrl,has:{...t.has},map:{...t.map},packages:t.packages?.slice()||[],paths:{...nne.paths,...t.paths}};return t.hasOwnProperty("async")||(e.async=!0),t.hasOwnProperty("isDebug")||(e.isDebug=!1),t.baseUrl||(e.baseUrl=nne.baseUrl),e}let OWe=class{constructor(){const e=document.createDocumentFragment();["addEventListener","dispatchEvent","removeEventListener"].forEach(n=>{this[n]=(...r)=>e[n](...r)})}},$M=class{constructor(){this._dispatcher=new OWe,this._workerPostMessage({type:rp.HANDSHAKE})}terminate(){}get onmessage(){return this._onmessageHandler}set onmessage(e){this._onmessageHandler&&this.removeEventListener("message",this._onmessageHandler),this._onmessageHandler=e,e&&this.addEventListener("message",e)}get onmessageerror(){return this._onmessageerrorHandler}set onmessageerror(e){this._onmessageerrorHandler&&this.removeEventListener("messageerror",this._onmessageerrorHandler),this._onmessageerrorHandler=e,e&&this.addEventListener("messageerror",e)}get onerror(){return this._onerrorHandler}set onerror(e){this._onerrorHandler&&this.removeEventListener("error",this._onerrorHandler),this._onerrorHandler=e,e&&this.addEventListener("error",e)}postMessage(e){V4(()=>{this._workerMessageHandler(new MessageEvent("message",{data:e}))})}dispatchEvent(e){return this._dispatcher.dispatchEvent(e)}addEventListener(e,n,r){this._dispatcher.addEventListener(e,n,r)}removeEventListener(e,n,r){this._dispatcher.removeEventListener(e,n,r)}_workerPostMessage(e){V4(()=>{this.dispatchEvent(new MessageEvent("message",{data:e}))})}async _workerMessageHandler(e){const n=eA(e);if(n&&n.type===rp.OPEN){const{modulePath:r,jobId:i}=n;let s=await R2.loadWorker(r);s||(s=await import(r));const o=R2.connect(s);this._workerPostMessage({type:rp.OPENED,jobId:i,data:o})}}};const r7=()=>kt.getLogger("esri.core.workers.workerFactory"),{HANDSHAKE:LWe}=rp,DWe='let globalId=0;const outgoing=new Map,configuration={CONFIGURATION};self.esriConfig=configuration.esriConfig;const workerPath=self.esriConfig.workers.workerPath,HANDSHAKE=0,OPEN=1,OPENED=2,RESPONSE=3,INVOKE=4,ABORT=5;function createAbortError(){const e=new Error("Aborted");return e.name="AbortError",e}function receiveMessage(e){return e&&e.data?"string"==typeof e.data?JSON.parse(e.data):e.data:null}function invokeStaticMessage(e,o,r){const t=r&&r.signal,n=globalId++;let s=null;return new Promise((r,i)=>{if(t){if(t.aborted)return i(createAbortError());s=()=>{outgoing.get(n)&&(outgoing.delete(n),self.postMessage({type:5,jobId:n}),i(createAbortError()))},t.addEventListener("abort",s)}outgoing.set(n,{resolve:r,reject:i}),self.postMessage({type:4,jobId:n,methodName:e,abortable:null!=t,data:o})}).finally(()=>{t&&t.removeEventListener("abort",s)})}let workerRevisionChecked=!1;function checkWorkerRevision(e){if(!workerRevisionChecked&&e.kernelInfo){workerRevisionChecked=!0;const{revision:o,fullVersion:r}=configuration.kernelInfo,{revision:t,fullVersion:n,version:s}=e.kernelInfo;esriConfig.assetsPath!==esriConfig.defaultAssetsPath&&o!==t&&console.warn(`Version mismatch detected between ArcGIS Maps SDK for JavaScript modules and assets. For more information visit https://esriurl.com/using-local-assets.\nModules version: ${r}\nAssets version: ${n??s}\nAssets path: ${esriConfig.assetsPath}`)}}function messageHandler(e){const o=receiveMessage(e);if(!o)return;const r=o.jobId;switch(o.type){case 1:let n;function t(e){const o=n.connect(e);self.postMessage({type:2,jobId:r,data:o},[o])}"function"==typeof define&&define.amd?require([workerPath],e=>{n=e.default||e,checkWorkerRevision(n),n.loadWorker(o.modulePath).then(e=>e||new Promise(e=>{require([o.modulePath],e)})).then(t)}):"System"in self&&"function"==typeof System.import?System.import(workerPath).then(e=>(n=e.default,checkWorkerRevision(n),n.loadWorker(o.modulePath))).then(e=>e||System.import(o.modulePath)).then(t):esriConfig.workers.useDynamicImport?import(workerPath).then(e=>{n=e.default||e,checkWorkerRevision(n),n.loadWorker(o.modulePath).then(e=>e||import(o.modulePath)).then(t)}):(self.RemoteClient||importScripts(workerPath),n=self.RemoteClient.default||self.RemoteClient,checkWorkerRevision(n),n.loadWorker(o.modulePath).then(t));break;case 3:if(outgoing.has(r)){const s=outgoing.get(r);outgoing.delete(r),o.error?s.reject(JSON.parse(o.error)):s.resolve(o.data)}}}self.dojoConfig=configuration.loaderConfig,esriConfig.workers.loaderUrl&&(self.importScripts(esriConfig.workers.loaderUrl),"function"==typeof require&&"function"==typeof require.config&&require.config(configuration.loaderConfig)),self.addEventListener("message",messageHandler),self.postMessage({type:0});';let KC,YC;const rne="Failed to create Worker. Fallback to execute module in main thread";async function jWe(){if(!ye("esri-workers"))return ine(new $M);if(!KC&&!YC)try{const e=DWe.split("{CONFIGURATION}").join($We());KC=URL.createObjectURL(new Blob([e],{type:"text/javascript"}))}catch(e){YC=e||{}}let t;if(KC)try{t=new Worker(KC,{name:"esri-worker-"+FWe++})}catch{r7().warn(rne,YC),t=new $M}else r7().warn(rne,YC),t=new $M;return ine(t)}async function ine(t){return new Promise(e=>{function n(i){const s=eA(i);s&&s.type===LWe&&(t.removeEventListener("message",n),t.removeEventListener("error",r),e(t))}function r(i){i.preventDefault(),t.removeEventListener("message",n),t.removeEventListener("error",r),r7().warn("Failed to create Worker. Fallback to execute module in main thread",i),(t=new $M).addEventListener("message",n),t.addEventListener("error",r)}t.addEventListener("message",n),t.addEventListener("error",r)})}function $We(){let t;if(nr.default!=null){const i={...nr};delete i.default,t=JSON.parse(JSON.stringify(i))}else t=JSON.parse(JSON.stringify(nr));t.assetsPath=eu(t.assetsPath),t.defaultAssetsPath=t.defaultAssetsPath?eu(t.defaultAssetsPath):void 0,t.request.interceptors=[],t.log.interceptors=[],t.locale=hu(),t.has={"esri-csp-restrictions":ye("esri-csp-restrictions"),"esri-2d-debug":!1,"esri-2d-update-debug":ye("esri-2d-update-debug"),"esri-2d-log-updating":ye("esri-2d-log-updating"),"featurelayer-pbf":ye("featurelayer-pbf"),"featurelayer-fast-triangulation-enabled":ye("featurelayer-fast-triangulation-enabled"),"featurelayer-simplify-thresholds":ye("featurelayer-simplify-thresholds"),"featurelayer-simplify-payload-size-factors":ye("featurelayer-simplify-payload-size-factors"),"featurelayer-simplify-mobile-factor":ye("featurelayer-simplify-mobile-factor"),"featurelayer-query-max-depth":ye("featurelayer-query-max-depth"),"featurelayer-query-tile-max-features":ye("featurelayer-query-tile-max-features"),"featurelayer-query-tile-concurrency":ye("featurelayer-query-tile-concurrency"),"featurelayer-query-pausing-enabled":ye("featurelayer-query-pausing-enabled"),"featurelayer-snapshot-concurrency":ye("featurelayer-snapshot-concurrency"),"featurelayer-snapshot-enabled":ye("featurelayer-snapshot-enabled"),"parquetlayer-full-query-feature-count":ye("parquetlayer-full-query-feature-count"),"esri-atomics":ye("esri-atomics"),"esri-shared-array-buffer":ye("esri-shared-array-buffer"),"esri-tiles-debug":ye("esri-tiles-debug"),"esri-workers-arraybuffer-transfer":ye("esri-workers-arraybuffer-transfer"),"feature-polyline-generalization-factor":ye("feature-polyline-generalization-factor"),"host-webworker":1},t.workers.loaderUrl&&(t.workers.loaderUrl=eu(t.workers.loaderUrl)),t.workers.workerPath?t.workers.workerPath=eu(t.workers.workerPath):t.workers.workerPath=eu(Hi("esri/core/workers/RemoteClient.js")),t.workers.useDynamicImport=!1;const e=nr.workers.loaderConfig,n=NWe({baseUrl:e?.baseUrl,locale:hu(),has:{"csp-restrictions":1,"dojo-test-sniff":0,"host-webworker":1,...e?.has},map:{...e?.map},paths:{...e?.paths},packages:e?.packages||[]});return JSON.stringify({esriConfig:t,loaderConfig:n,kernelInfo:{buildDate:Afe,fullVersion:dB,revision:Ife}})}let FWe=0;const{ABORT:sne,INVOKE:VWe,OPEN:zWe,OPENED:GWe,RESPONSE:$E}=rp;let UWe=class Eye{static async create(e){const n=await jWe();return new Eye(n,e)}constructor(e,n){this._outJobs=new Map,this._inJobs=new Map,this.worker=e,this.id=n,e.addEventListener("message",this._onMessage.bind(this)),e.addEventListener("error",r=>{r.preventDefault(),kt.getLogger("esri.core.workers.WorkerOwner").error(r)})}terminate(){this.worker.terminate()}async open(e,n={}){const{signal:r}=n,i=wye();return new Promise((s,o)=>{const a={resolve:s,reject:o,abortHandle:fB(r,()=>{this._outJobs.delete(i),this._post({type:sne,jobId:i})})};this._outJobs.set(i,a),this._post({type:zWe,jobId:i,modulePath:e})})}_onMessage(e){const n=eA(e);if(n)switch(n.type){case GWe:this._onOpenedMessage(n);break;case $E:this._onResponseMessage(n);break;case sne:this._onAbortMessage(n);break;case VWe:this._onInvokeMessage(n)}}_onAbortMessage(e){const n=this._inJobs,r=e.jobId,i=n.get(r);i&&(i.controller&&i.controller.abort(),n.delete(r))}_onInvokeMessage(e){const{methodName:n,jobId:r,data:i,abortable:s}=e,o=s?new AbortController:null,a=this._inJobs,l=MWe[n];let c;try{if(typeof l!="function")throw new TypeError(`${n} is not a function`);c=l.call(null,i,{signal:o?o.signal:null})}catch(u){return void this._post({type:$E,jobId:r,error:lN(u)})}ga(c)?(a.set(r,{controller:o,promise:c}),c.then(u=>{a.has(r)&&(a.delete(r),this._post({type:$E,jobId:r},u))},u=>{a.has(r)&&(a.delete(r),u||(u={message:"Error encountered at method"+n}),wa(u)||this._post({type:$E,jobId:r,error:lN(u||{message:`Error encountered at method ${n}`})}))})):this._post({type:$E,jobId:r},c)}_onOpenedMessage(e){const{jobId:n,data:r}=e,i=this._outJobs.get(n);i&&(this._outJobs.delete(n),ii(i.abortHandle),i.resolve(r))}_onResponseMessage(e){const{jobId:n,error:r,data:i}=e,s=this._outJobs.get(n);s&&(this._outJobs.delete(n),ii(s.abortHandle),r?s.reject(Xe.fromJSON(JSON.parse(r))):s.resolve(i))}_post(e,n,r){return bye(this.worker,e,n,r)}};const one=ye("host-browser")?Math.min(navigator.hardwareConcurrency-1,ye("workers-pool-size")??8):0;let zy=ye("esri-mobile")?Math.min(one,3):one;zy||(zy=ye("safari")&&ye("mac")?7:2);let ane=0;const FM=[];function BWe(){Sye()}async function XC(t,e){const n=new RWe,{registryTarget:r,...i}=e;return await n.open(t,i),r&&bWe(r,n),n}async function uMt(t,e={}){if(typeof t!="string")throw new Xe("workers:undefined-module","modulePath is missing");let n=e.strategy||"distributed";if(ye("host-webworker")&&!ye("esri-workers")&&(n="local"),n==="local"){let r=await R2.loadWorker(t);r||(r=await import(t)),pi(e.signal);const i=e.client||r;return XC([R2.connect(r,e.schedule)],{...e,client:i})}if(await Sye(),pi(e.signal),n==="dedicated"){const r=ane++%zy;return XC([await FM[r].open(t,e)],e)}if(e.maxNumWorkers&&e.maxNumWorkers>0){const r=Math.min(e.maxNumWorkers,zy);if(r<zy){const i=new Array(r);for(let s=0;s<r;++s){const o=ane++%zy;i[s]=FM[o].open(t,e)}return XC(i,e)}}return XC(FM.map(r=>r.open(t,e)),e)}let ZC=null;async function Sye(){if(ZC)return ZC;new AbortController;const t=[];for(let e=0;e<zy;e++){const n=UWe.create(e).then(r=>(FM[e]=r,r));t.push(n)}return ZC=Promise.all(t),ZC}let ET=class extends Ot{constructor(e){super(e),this.addHandles([this.on("before-add",n=>{n.item==null&&n.preventDefault()}),this.on("after-add",n=>this._own(n.item)),this.on("after-remove",n=>this._release(n.item))])}get owner(){return this._get("owner")}set owner(e){this.destroyed||e!==this._get("owner")&&(this._releaseAll(),this._set("owner",e),this._ownAll())}_ownAll(){for(const e of this.items)this._own(e)}_releaseAll(){for(const e of this.items)this._release(e)}_createNewInstance(e){return this.itemType?new(Ot.ofType(this.itemType.Type))(e):new Ot(e)}};function i7(t,e){return{type:t,cast:Npe,set(n){const r=Sd(n,this._get(e),t);r&&!r.destroyed&&(r.owner=this),this._set(e,r)}}}x([E()],ET.prototype,"owner",null),ET=x([ue("esri.core.support.OwningCollection")],ET);var s7,Pw;let Co=(Pw=class extends qt{constructor(e){super(e),this.cols=null,this.level=0,this.levelValue=null,this.origin=null,this.resolution=0,this.rows=null,this.scale=0}clone(){return new s7({cols:this.cols,level:this.level,levelValue:this.levelValue,resolution:this.resolution,rows:this.rows,scale:this.scale})}},s7=Pw,Pw);x([E({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],Co.prototype,"cols",void 0),x([E({type:Dr,json:{write:!0}})],Co.prototype,"level",void 0),x([E({type:String,json:{write:!0}})],Co.prototype,"levelValue",void 0),x([E({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],Co.prototype,"origin",void 0),x([E({type:Number,json:{write:!0}})],Co.prototype,"resolution",void 0),x([E({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],Co.prototype,"rows",void 0),x([E({type:Number,json:{write:!0}})],Co.prototype,"scale",void 0),Co=s7=x([ue("esri.layers.support.LOD")],Co);let WWe=class Tye{constructor(e,n,r,i=xl()){this._level=e,this._row=n,this._col=r,this.extent=i}get id(){return this._id??=`${this.level}/${this.row}/${this.col}`,this._id}get level(){return this._level}set level(e){this._level=e,this._id=null}get row(){return this._row}set row(e){this._row=e,this._id=null}get col(){return this._col}set col(e){this._col=e,this._id=null}toJSON(){return{level:this._level,row:this._row,col:this._col,extent:this.extent}}static fromJSON(e){return new Tye(e.level,e.row,e.col,e.extent)}};var J_;const lne=new Ys({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"});var Cw;let Sa=(Cw=class extends qt{static create(e={}){const{resolutionFactor:n=1,scales:r,size:i=256,spatialReference:s=Bt.WebMercator,numLODs:o=24}=e;if(!hc(s)){const f=[];if(r)for(let g=0;g<r.length;g++){const y=r[g];f.push(new Co({level:g,scale:y,resolution:y}))}else{let g=5e-4;for(let y=o-1;y>=0;y--)f.unshift(new Co({level:y,scale:g,resolution:g})),g*=2}return new J_({dpi:96,lods:f,origin:new Jt(0,0,s),size:[i,i],spatialReference:s})}const a=za(s),l=e.origin?new Jt({x:e.origin.x,y:e.origin.y,spatialReference:s}):new Jt(a?{x:a.origin[0],y:a.origin[1],spatialReference:s}:{x:0,y:0,spatialReference:s}),c=96,u=1/(Wd(s)*39.37*c),h=[];if(r)for(let f=0;f<r.length;f++){const g=r[f],y=g*u;h.push(new Co({level:f,scale:g,resolution:y}))}else{let f=db(s)?512/i*5916575275917094e-7:256/i*591657527591555e-6;const g=Math.ceil(o/n);h.push(new Co({level:0,scale:f,resolution:f*u}));for(let y=1;y<g;y++){const _=f/2**n,b=_*u;h.push(new Co({level:y,scale:_,resolution:b})),f=_}}return new J_({dpi:c,lods:h,origin:l,size:[i,i],spatialReference:s})}constructor(e){super(e),this.dpi=96,this.format=null,this.origin=null,this.size=null,this.spatialReference=null}get isWrappable(){const{spatialReference:e,origin:n}=this;if(e&&n){const r=za(e);return e.isWrappable&&!!r&&Math.abs(r.origin[0]-n.x)<=r.dx}return!1}readOrigin(e,n){return Jt.fromJSON({spatialReference:n.spatialReference,...e})}set lods(e){let n=0,r=0;const i=[],s=this._levelToLOD={};e&&(n=-1/0,r=1/0,e.forEach(o=>{i.push(o.scale),n=o.scale>n?o.scale:n,r=o.scale<r?o.scale:r,s[o.level]=o})),this._set("scales",i),this._set("lods",e),this._initializeUpsampleLevels()}readSize(e,n){return[n.cols,n.rows]}writeSize(e,n){n.cols=e[0],n.rows=e[1]}zoomToScale(e){const n=this.scales;if(e<=0)return n[0];if(e>=n.length-1)return n[n.length-1];const r=Math.floor(e),i=r+1;return n[r]/(n[r]/n[i])**(e-r)}scaleToZoom(e){const n=this.scales,r=n.length-1;let i=0;for(;i<r;i++){const s=n[i],o=n[i+1];if(s<=e)return i;if(o===e)return i+1;if(s>e&&o<e)return i+Math.log(s/e)/Math.log(s/o)}return i}tileAt(e,n,r,i){const s=this.lodAt(e);if(!s)return null;let o,a;if(typeof n=="number")o=n,a=r;else if(go(n.spatialReference,this.spatialReference))o=n.x,a=n.y,i=r;else{const u=DO(n,this.spatialReference);if(u==null)return null;o=u.x,a=u.y,i=r}const l=s.resolution*this.size[0],c=s.resolution*this.size[1];return i??=new WWe(0,0,0),i.level=e,i.row=Math.floor((this.origin.y-a)/c+.001),i.col=Math.floor((o-this.origin.x)/l+.001),this.updateTileInfo(i),i}updateTileInfo(e,n=0){if(!("extent"in e))return!1;let r=this.lodAt(e.level);if(!r&&n===1){const a=this.lods[this.lods.length-1];a.level<e.level&&(r=a)}if(!r)return!1;const i=e.level-r.level,s=r.resolution*this.size[0]/2**i,o=r.resolution*this.size[1]/2**i;return e.extent[0]=this.origin.x+e.col*s,e.extent[1]=this.origin.y-(e.row+1)*o,e.extent[2]=e.extent[0]+s,e.extent[3]=e.extent[1]+o,!0}upsampleTile(e){const n=this._upsampleLevels[e.level];return!(!n||n.parentLevel===-1)&&(e.level=n.parentLevel,e.row=Math.floor(e.row/n.factor+.001),e.col=Math.floor(e.col/n.factor+.001),this.updateTileInfo(e),!0)}getTileBounds(e,n){const r=this.lodAt(n.level);if(r==null)return null;const{resolution:i}=r,s=i*this.size[0],o=i*this.size[1];return e[0]=this.origin.x+n.col*s,e[1]=this.origin.y-(n.row+1)*o,e[2]=e[0]+s,e[3]=e[1]+o,e}lodAt(e){return this._levelToLOD?.[e]??null}clone(){return J_.fromJSON(this.write({}))}getCompatibleForVTL(e){if(this.size[0]!==this.size[1]||this.size[0]===256&&e===512)return null;const n=(this.size[0]===512&&e===256?-1:0)+(this.spatialReference.isGeographic?1:0);if(this.size[0]===e&&n===0)return this;const r=[],i=this.lods.length-n;for(let s=0;s<i;s++){const o=s+n,{scale:a,resolution:l}=o>=0?this.lods[o]:{scale:2*this.lods[0].scale,resolution:2*this.lods[0].resolution};r.push(new Co({level:s,scale:a,resolution:l}))}return new J_({size:[e,e],dpi:this.dpi,format:this.format,compressionQuality:this.compressionQuality,origin:this.origin,spatialReference:this.spatialReference,lods:r})}_initializeUpsampleLevels(){const e=this.lods;this._upsampleLevels=[];let n=null;for(let r=0;r<e.length;r++){const i=e[r];this._upsampleLevels[i.level]={parentLevel:n?n.level:-1,factor:n?n.resolution/i.resolution:0},n=i}}},J_=Cw,Cw);x([E({type:Number,json:{write:!0}})],Sa.prototype,"compressionQuality",void 0),x([E({type:Number,json:{write:!0}})],Sa.prototype,"dpi",void 0),x([E({type:String,json:{read:lne.read,write:lne.write,origins:{"web-scene":{read:!1,write:!1}}}})],Sa.prototype,"format",void 0),x([E({readOnly:!0})],Sa.prototype,"isWrappable",null),x([E({type:Jt,json:{write:!0}})],Sa.prototype,"origin",void 0),x([cr("origin")],Sa.prototype,"readOrigin",null),x([E({type:[Co],value:null,json:{write:!0}})],Sa.prototype,"lods",null),x([E({readOnly:!0})],Sa.prototype,"scales",void 0),x([E({cast:t=>Array.isArray(t)?t:typeof t=="number"?[t,t]:[256,256]})],Sa.prototype,"size",void 0),x([cr("size",["rows","cols"])],Sa.prototype,"readSize",null),x([er("size",{cols:{type:Dr},rows:{type:Dr}})],Sa.prototype,"writeSize",null),x([E({type:Bt,json:{write:!0}})],Sa.prototype,"spatialReference",void 0),Sa=J_=x([ue("esri.layers.support.TileInfo")],Sa);let M2=class extends ET{constructor(e){super(e),this.addHandles(this.on("before-add",n=>{n.item!=null&&n.item.parent===this.owner&&(kt.getLogger(this).warn("Analysis inside the collection must be unique. Not adding this element again."),n.preventDefault())}))}_own(e){e.parent=this.owner}_release(e){e.parent=null}};M2=x([ue("esri.support.AnalysesCollection")],M2);const VM={widthBreakpoint:{getValue(t){const e=t.viewSize[0],n=t.breakpoints,r=this.values;return e<=n.xsmall?r.xsmall:e<=n.small?r.small:e<=n.medium?r.medium:e<=n.large?r.large:r.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-width-xsmall esri-view-width-less-than-small esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",small:"esri-view-width-small esri-view-width-greater-than-xsmall esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",medium:"esri-view-width-medium esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-less-than-large esri-view-width-less-than-xlarge",large:"esri-view-width-large esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-less-than-xlarge",xlarge:"esri-view-width-xlarge esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-greater-than-large"}},heightBreakpoint:{getValue(t){const e=t.viewSize[1],n=t.breakpoints,r=this.values;return e<=n.xsmall?r.xsmall:e<=n.small?r.small:e<=n.medium?r.medium:e<=n.large?r.large:r.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-height-xsmall esri-view-height-less-than-small esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",small:"esri-view-height-small esri-view-height-greater-than-xsmall esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",medium:"esri-view-height-medium esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-less-than-large esri-view-height-less-than-xlarge",large:"esri-view-height-large esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-less-than-xlarge",xlarge:"esri-view-height-xlarge esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-greater-than-large"}},orientation:{getValue(t){const e=t.viewSize,n=e[0],r=e[1],i=this.values;return r>=n?i.portrait:i.landscape},values:{portrait:"portrait",landscape:"landscape"},valueToClassName:{portrait:"esri-view-orientation-portrait",landscape:"esri-view-orientation-landscape"}}},Yj={xsmall:544,small:768,medium:992,large:1200};function HWe(t){const e=t;return e&&e.xsmall<e.small&&e.small<e.medium&&e.medium<e.large}function Xj(t,e){return e?VM[t].valueToClassName[e].split(" "):[]}const qWe=t=>{const e=t;let n=class extends e{constructor(...r){super(...r),this.orientation=null,this.widthBreakpoint=null,this.heightBreakpoint=null,this.breakpoints=Yj}initialize(){this.addHandles(fn(()=>[this.breakpoints,this.size],()=>this._updateClassNames(),ya))}destroy(){this.destroyed||this._removeActiveClassNames()}set breakpoints(r){if(r!==this._get("breakpoints")){if(!HWe(r)){const i=JSON.stringify(Yj,null,2);console.warn("provided breakpoints are not valid, using defaults:"+i),r=Yj}this._set("breakpoints",{...r})}}_updateClassNames(){if(!this.container)return;const r=Na.acquire(),i=Na.acquire();let s,o=!1;for(s in VM){const a=this[s],l=VM[s].getValue({viewSize:this.size,breakpoints:this.breakpoints});a!==l&&(o=!0,this[s]=l,Xj(s,a).forEach(c=>i.push(c)),Xj(s,l).forEach(c=>r.push(c)))}o&&(this._applyClassNameChanges(r,i),Na.release(r),Na.release(i))}_applyClassNameChanges(r,i){const s=this.container;s&&(i.forEach(o=>s.classList.remove(o)),r.forEach(o=>s.classList.add(o)))}_removeActiveClassNames(){const r=this.container;if(!r)return;let i;for(i in VM)Xj(i,this[i]).forEach(s=>r.classList.remove(s))}};return x([E()],n.prototype,"breakpoints",null),x([E()],n.prototype,"orientation",void 0),x([E()],n.prototype,"widthBreakpoint",void 0),x([E()],n.prototype,"heightBreakpoint",void 0),n=x([ue("esri.views.BreakpointsOwner")],n),n};function SW(t){return typeof t=="string"?document.getElementById(t):t??null}function cne(t,e){for(;;){const n=t.firstChild;if(!n)break;e.appendChild(n)}}let a1=class extends Kt{constructor(){super(...arguments),this.updating=!1,this._handleId=0,this._scheduleHandleId=0,this._pendingPromises=new Set}destroy(){this.removeAll()}add(e,n,r={}){return this._installWatch(e,n,r,fn)}addWhen(e,n,r={}){return this._installWatch(e,n,r,wc)}addOnCollectionChange(e,n,{initial:r=!1,final:i=!1}={}){const s=++this._handleId;return this.addHandles([H1(e,"after-changes",this._createSyncUpdatingCallback(),Ug),H1(e,"change",n,{onListenerAdd:r?o=>n({added:o.toArray(),removed:[]}):void 0,onListenerRemove:i?o=>n({added:[],removed:o.toArray()}):void 0})],s),Zn(()=>this.removeHandles(s))}addPromise(e){if(e==null)return e;const n=++this._handleId;this.addHandles(Zn(()=>{this._pendingPromises.delete(e)&&(this._pendingPromises.size!==0||this.hasHandles(JC)||this._set("updating",!1))}),n),this._pendingPromises.add(e),this._set("updating",!0);const r=()=>this.removeHandles(n);return e.then(r,r),e}removeAll(){this._pendingPromises.clear(),this.removeAllHandles(),this._set("updating",!1)}_installWatch(e,n,r={},i){const s=++this._handleId;r.sync||this._installSyncUpdatingWatch(e,s);const o=i(e,n,r);return this.addHandles(o,s),Zn(()=>this.removeHandles(s))}_installSyncUpdatingWatch(e,n){const r=this._createSyncUpdatingCallback(),i=fn(e,r,{sync:!0,equals:()=>!1});return this.addHandles(i,n),i}_createSyncUpdatingCallback(){return()=>{this.removeHandles(JC),++this._scheduleHandleId;const e=this._scheduleHandleId;this._get("updating")||this._set("updating",!0),this.addHandles(hb(()=>{e===this._scheduleHandleId&&(this._set("updating",this._pendingPromises.size>0),this.removeHandles(JC))}),JC)}}};x([E({readOnly:!0})],a1.prototype,"updating",void 0),a1=x([ue("esri.core.support.UpdatingHandles")],a1);const JC=-42;var cN=function(){return cN=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},cN.apply(this,arguments)},o7={exports:{}},zi={},a7={exports:{}},vv={};function kye(){var t={};return t["align-content"]=!1,t["align-items"]=!1,t["align-self"]=!1,t["alignment-adjust"]=!1,t["alignment-baseline"]=!1,t.all=!1,t["anchor-point"]=!1,t.animation=!1,t["animation-delay"]=!1,t["animation-direction"]=!1,t["animation-duration"]=!1,t["animation-fill-mode"]=!1,t["animation-iteration-count"]=!1,t["animation-name"]=!1,t["animation-play-state"]=!1,t["animation-timing-function"]=!1,t.azimuth=!1,t["backface-visibility"]=!1,t.background=!0,t["background-attachment"]=!0,t["background-clip"]=!0,t["background-color"]=!0,t["background-image"]=!0,t["background-origin"]=!0,t["background-position"]=!0,t["background-repeat"]=!0,t["background-size"]=!0,t["baseline-shift"]=!1,t.binding=!1,t.bleed=!1,t["bookmark-label"]=!1,t["bookmark-level"]=!1,t["bookmark-state"]=!1,t.border=!0,t["border-bottom"]=!0,t["border-bottom-color"]=!0,t["border-bottom-left-radius"]=!0,t["border-bottom-right-radius"]=!0,t["border-bottom-style"]=!0,t["border-bottom-width"]=!0,t["border-collapse"]=!0,t["border-color"]=!0,t["border-image"]=!0,t["border-image-outset"]=!0,t["border-image-repeat"]=!0,t["border-image-slice"]=!0,t["border-image-source"]=!0,t["border-image-width"]=!0,t["border-left"]=!0,t["border-left-color"]=!0,t["border-left-style"]=!0,t["border-left-width"]=!0,t["border-radius"]=!0,t["border-right"]=!0,t["border-right-color"]=!0,t["border-right-style"]=!0,t["border-right-width"]=!0,t["border-spacing"]=!0,t["border-style"]=!0,t["border-top"]=!0,t["border-top-color"]=!0,t["border-top-left-radius"]=!0,t["border-top-right-radius"]=!0,t["border-top-style"]=!0,t["border-top-width"]=!0,t["border-width"]=!0,t.bottom=!1,t["box-decoration-break"]=!0,t["box-shadow"]=!0,t["box-sizing"]=!0,t["box-snap"]=!0,t["box-suppress"]=!0,t["break-after"]=!0,t["break-before"]=!0,t["break-inside"]=!0,t["caption-side"]=!1,t.chains=!1,t.clear=!0,t.clip=!1,t["clip-path"]=!1,t["clip-rule"]=!1,t.color=!0,t["color-interpolation-filters"]=!0,t["column-count"]=!1,t["column-fill"]=!1,t["column-gap"]=!1,t["column-rule"]=!1,t["column-rule-color"]=!1,t["column-rule-style"]=!1,t["column-rule-width"]=!1,t["column-span"]=!1,t["column-width"]=!1,t.columns=!1,t.contain=!1,t.content=!1,t["counter-increment"]=!1,t["counter-reset"]=!1,t["counter-set"]=!1,t.crop=!1,t.cue=!1,t["cue-after"]=!1,t["cue-before"]=!1,t.cursor=!1,t.direction=!1,t.display=!0,t["display-inside"]=!0,t["display-list"]=!0,t["display-outside"]=!0,t["dominant-baseline"]=!1,t.elevation=!1,t["empty-cells"]=!1,t.filter=!1,t.flex=!1,t["flex-basis"]=!1,t["flex-direction"]=!1,t["flex-flow"]=!1,t["flex-grow"]=!1,t["flex-shrink"]=!1,t["flex-wrap"]=!1,t.float=!1,t["float-offset"]=!1,t["flood-color"]=!1,t["flood-opacity"]=!1,t["flow-from"]=!1,t["flow-into"]=!1,t.font=!0,t["font-family"]=!0,t["font-feature-settings"]=!0,t["font-kerning"]=!0,t["font-language-override"]=!0,t["font-size"]=!0,t["font-size-adjust"]=!0,t["font-stretch"]=!0,t["font-style"]=!0,t["font-synthesis"]=!0,t["font-variant"]=!0,t["font-variant-alternates"]=!0,t["font-variant-caps"]=!0,t["font-variant-east-asian"]=!0,t["font-variant-ligatures"]=!0,t["font-variant-numeric"]=!0,t["font-variant-position"]=!0,t["font-weight"]=!0,t.grid=!1,t["grid-area"]=!1,t["grid-auto-columns"]=!1,t["grid-auto-flow"]=!1,t["grid-auto-rows"]=!1,t["grid-column"]=!1,t["grid-column-end"]=!1,t["grid-column-start"]=!1,t["grid-row"]=!1,t["grid-row-end"]=!1,t["grid-row-start"]=!1,t["grid-template"]=!1,t["grid-template-areas"]=!1,t["grid-template-columns"]=!1,t["grid-template-rows"]=!1,t["hanging-punctuation"]=!1,t.height=!0,t.hyphens=!1,t.icon=!1,t["image-orientation"]=!1,t["image-resolution"]=!1,t["ime-mode"]=!1,t["initial-letters"]=!1,t["inline-box-align"]=!1,t["justify-content"]=!1,t["justify-items"]=!1,t["justify-self"]=!1,t.left=!1,t["letter-spacing"]=!0,t["lighting-color"]=!0,t["line-box-contain"]=!1,t["line-break"]=!1,t["line-grid"]=!1,t["line-height"]=!1,t["line-snap"]=!1,t["line-stacking"]=!1,t["line-stacking-ruby"]=!1,t["line-stacking-shift"]=!1,t["line-stacking-strategy"]=!1,t["list-style"]=!0,t["list-style-image"]=!0,t["list-style-position"]=!0,t["list-style-type"]=!0,t.margin=!0,t["margin-bottom"]=!0,t["margin-left"]=!0,t["margin-right"]=!0,t["margin-top"]=!0,t["marker-offset"]=!1,t["marker-side"]=!1,t.marks=!1,t.mask=!1,t["mask-box"]=!1,t["mask-box-outset"]=!1,t["mask-box-repeat"]=!1,t["mask-box-slice"]=!1,t["mask-box-source"]=!1,t["mask-box-width"]=!1,t["mask-clip"]=!1,t["mask-image"]=!1,t["mask-origin"]=!1,t["mask-position"]=!1,t["mask-repeat"]=!1,t["mask-size"]=!1,t["mask-source-type"]=!1,t["mask-type"]=!1,t["max-height"]=!0,t["max-lines"]=!1,t["max-width"]=!0,t["min-height"]=!0,t["min-width"]=!0,t["move-to"]=!1,t["nav-down"]=!1,t["nav-index"]=!1,t["nav-left"]=!1,t["nav-right"]=!1,t["nav-up"]=!1,t["object-fit"]=!1,t["object-position"]=!1,t.opacity=!1,t.order=!1,t.orphans=!1,t.outline=!1,t["outline-color"]=!1,t["outline-offset"]=!1,t["outline-style"]=!1,t["outline-width"]=!1,t.overflow=!1,t["overflow-wrap"]=!1,t["overflow-x"]=!1,t["overflow-y"]=!1,t.padding=!0,t["padding-bottom"]=!0,t["padding-left"]=!0,t["padding-right"]=!0,t["padding-top"]=!0,t.page=!1,t["page-break-after"]=!1,t["page-break-before"]=!1,t["page-break-inside"]=!1,t["page-policy"]=!1,t.pause=!1,t["pause-after"]=!1,t["pause-before"]=!1,t.perspective=!1,t["perspective-origin"]=!1,t.pitch=!1,t["pitch-range"]=!1,t["play-during"]=!1,t.position=!1,t["presentation-level"]=!1,t.quotes=!1,t["region-fragment"]=!1,t.resize=!1,t.rest=!1,t["rest-after"]=!1,t["rest-before"]=!1,t.richness=!1,t.right=!1,t.rotation=!1,t["rotation-point"]=!1,t["ruby-align"]=!1,t["ruby-merge"]=!1,t["ruby-position"]=!1,t["shape-image-threshold"]=!1,t["shape-outside"]=!1,t["shape-margin"]=!1,t.size=!1,t.speak=!1,t["speak-as"]=!1,t["speak-header"]=!1,t["speak-numeral"]=!1,t["speak-punctuation"]=!1,t["speech-rate"]=!1,t.stress=!1,t["string-set"]=!1,t["tab-size"]=!1,t["table-layout"]=!1,t["text-align"]=!0,t["text-align-last"]=!0,t["text-combine-upright"]=!0,t["text-decoration"]=!0,t["text-decoration-color"]=!0,t["text-decoration-line"]=!0,t["text-decoration-skip"]=!0,t["text-decoration-style"]=!0,t["text-emphasis"]=!0,t["text-emphasis-color"]=!0,t["text-emphasis-position"]=!0,t["text-emphasis-style"]=!0,t["text-height"]=!0,t["text-indent"]=!0,t["text-justify"]=!0,t["text-orientation"]=!0,t["text-overflow"]=!0,t["text-shadow"]=!0,t["text-space-collapse"]=!0,t["text-transform"]=!0,t["text-underline-position"]=!0,t["text-wrap"]=!0,t.top=!1,t.transform=!1,t["transform-origin"]=!1,t["transform-style"]=!1,t.transition=!1,t["transition-delay"]=!1,t["transition-duration"]=!1,t["transition-property"]=!1,t["transition-timing-function"]=!1,t["unicode-bidi"]=!1,t["vertical-align"]=!1,t.visibility=!1,t["voice-balance"]=!1,t["voice-duration"]=!1,t["voice-family"]=!1,t["voice-pitch"]=!1,t["voice-range"]=!1,t["voice-rate"]=!1,t["voice-stress"]=!1,t["voice-volume"]=!1,t.volume=!1,t["white-space"]=!1,t.widows=!1,t.width=!0,t["will-change"]=!1,t["word-break"]=!0,t["word-spacing"]=!0,t["word-wrap"]=!0,t["wrap-flow"]=!1,t["wrap-through"]=!1,t["writing-mode"]=!1,t["z-index"]=!1,t}function KWe(t,e,n){}function YWe(t,e,n){}var XWe=/javascript\s*\:/img;function ZWe(t,e){return XWe.test(e)?"":e}vv.whiteList=kye();vv.getDefaultWhiteList=kye;vv.onAttr=KWe;vv.onIgnoreAttr=YWe;vv.safeAttrValue=ZWe;var JWe={indexOf:function(t,e){var n,r;if(Array.prototype.indexOf)return t.indexOf(e);for(n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1},forEach:function(t,e,n){var r,i;if(Array.prototype.forEach)return t.forEach(e,n);for(r=0,i=t.length;r<i;r++)e.call(n,t[r],r,t)},trim:function(t){return String.prototype.trim?t.trim():t.replace(/(^\s*)|(\s*$)/g,"")},trimRight:function(t){return String.prototype.trimRight?t.trimRight():t.replace(/(\s*$)/g,"")}},FE=JWe;function QWe(t,e){t=FE.trimRight(t),t[t.length-1]!==";"&&(t+=";");var n=t.length,r=!1,i=0,s=0,o="";function a(){if(!r){var u=FE.trim(t.slice(i,s)),h=u.indexOf(":");if(h!==-1){var f=FE.trim(u.slice(0,h)),g=FE.trim(u.slice(h+1));if(f){var y=e(i,o.length,f,g,u);y&&(o+=y+"; ")}}}i=s+1}for(;s<n;s++){var l=t[s];if(l==="/"&&t[s+1]==="*"){var c=t.indexOf("*/",s+2);if(c===-1)break;s=c+1,i=s+1,r=!1}else l==="("?r=!0:l===")"?r=!1:l===";"?r||a():l===`
`&&a()}return FE.trim(o)}var eHe=QWe,QC=vv,tHe=eHe;function une(t){return t==null}function nHe(t){var e={};for(var n in t)e[n]=t[n];return e}function Aye(t){t=nHe(t||{}),t.whiteList=t.whiteList||QC.whiteList,t.onAttr=t.onAttr||QC.onAttr,t.onIgnoreAttr=t.onIgnoreAttr||QC.onIgnoreAttr,t.safeAttrValue=t.safeAttrValue||QC.safeAttrValue,this.options=t}Aye.prototype.process=function(t){if(t=t||"",t=t.toString(),!t)return"";var e=this,n=e.options,r=n.whiteList,i=n.onAttr,s=n.onIgnoreAttr,o=n.safeAttrValue,a=tHe(t,function(l,c,u,h,f){var g=r[u],y=!1;if(g===!0?y=g:typeof g=="function"?y=g(h):g instanceof RegExp&&(y=g.test(h)),y!==!0&&(y=!1),h=o(u,h),!!h){var _={position:c,sourcePosition:l,source:f,isWhite:y};if(y){var b=i(u,h,_);return une(b)?u+":"+h:b}else{var b=s(u,h,_);if(!une(b))return b}}});return a};var rHe=Aye;(function(t,e){var n=vv,r=rHe;function i(o,a){var l=new r(a);return l.process(o)}e=t.exports=i,e.FilterCSS=r;for(var s in n)e[s]=n[s]})(a7,a7.exports);var TW=a7.exports,kW={indexOf:function(t,e){var n,r;if(Array.prototype.indexOf)return t.indexOf(e);for(n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1},forEach:function(t,e,n){var r,i;if(Array.prototype.forEach)return t.forEach(e,n);for(r=0,i=t.length;r<i;r++)e.call(n,t[r],r,t)},trim:function(t){return String.prototype.trim?t.trim():t.replace(/(^\s*)|(\s*$)/g,"")},spaceIndex:function(t){var e=/\s|\n|\t/,n=e.exec(t);return n?n.index:-1}},iHe=TW.FilterCSS,sHe=TW.getDefaultWhiteList,uN=kW;function Iye(){return{a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","crossorigin","loop","muted","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src","height","width"]}}var Pye=new iHe;function oHe(t,e,n){}function aHe(t,e,n){}function lHe(t,e,n){}function cHe(t,e,n){}function Cye(t){return t.replace(hHe,"&lt;").replace(dHe,"&gt;")}function uHe(t,e,n,r){if(n=Dye(n),e==="href"||e==="src"){if(n=uN.trim(n),n==="#")return"#";if(!(n.substr(0,7)==="http://"||n.substr(0,8)==="https://"||n.substr(0,7)==="mailto:"||n.substr(0,4)==="tel:"||n.substr(0,11)==="data:image/"||n.substr(0,6)==="ftp://"||n.substr(0,2)==="./"||n.substr(0,3)==="../"||n[0]==="#"||n[0]==="/"))return""}else if(e==="background"){if(eR.lastIndex=0,eR.test(n))return""}else if(e==="style"){if(hne.lastIndex=0,hne.test(n)||(dne.lastIndex=0,dne.test(n)&&(eR.lastIndex=0,eR.test(n))))return"";r!==!1&&(r=r||Pye,n=r.process(n))}return n=jye(n),n}var hHe=/</g,dHe=/>/g,fHe=/"/g,pHe=/&quot;/g,mHe=/&#([a-zA-Z0-9]*);?/gim,gHe=/&colon;?/gim,yHe=/&newline;?/gim,eR=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a):/gi,hne=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,dne=/u\s*r\s*l\s*\(.*/gi;function Rye(t){return t.replace(fHe,"&quot;")}function Mye(t){return t.replace(pHe,'"')}function Nye(t){return t.replace(mHe,function(n,r){return r[0]==="x"||r[0]==="X"?String.fromCharCode(parseInt(r.substr(1),16)):String.fromCharCode(parseInt(r,10))})}function Oye(t){return t.replace(gHe,":").replace(yHe," ")}function Lye(t){for(var e="",n=0,r=t.length;n<r;n++)e+=t.charCodeAt(n)<32?" ":t.charAt(n);return uN.trim(e)}function Dye(t){return t=Mye(t),t=Nye(t),t=Oye(t),t=Lye(t),t}function jye(t){return t=Rye(t),t=Cye(t),t}function vHe(){return""}function _He(t,e){typeof e!="function"&&(e=function(){});var n=!Array.isArray(t);function r(o){return n?!0:uN.indexOf(t,o)!==-1}var i=[],s=!1;return{onIgnoreTag:function(o,a,l){if(r(o))if(l.isClosing){var c="[/removed]",u=l.position+c.length;return i.push([s!==!1?s:l.position,u]),s=!1,c}else return s||(s=l.position),"[removed]";else return e(o,a,l)},remove:function(o){var a="",l=0;return uN.forEach(i,function(c){a+=o.slice(l,c[0]),l=c[1]}),a+=o.slice(l),a}}}function xHe(t){for(var e="",n=0;n<t.length;){var r=t.indexOf("<!--",n);if(r===-1){e+=t.slice(n);break}e+=t.slice(n,r);var i=t.indexOf("-->",r);if(i===-1)break;n=i+3}return e}function wHe(t){var e=t.split("");return e=e.filter(function(n){var r=n.charCodeAt(0);return r===127?!1:r<=31?r===10||r===13:!0}),e.join("")}zi.whiteList=Iye();zi.getDefaultWhiteList=Iye;zi.onTag=oHe;zi.onIgnoreTag=aHe;zi.onTagAttr=lHe;zi.onIgnoreTagAttr=cHe;zi.safeAttrValue=uHe;zi.escapeHtml=Cye;zi.escapeQuote=Rye;zi.unescapeQuote=Mye;zi.escapeHtmlEntities=Nye;zi.escapeDangerHtml5Entities=Oye;zi.clearNonPrintableCharacter=Lye;zi.friendlyAttrValue=Dye;zi.escapeAttrValue=jye;zi.onIgnoreTagStripAll=vHe;zi.StripTagBody=_He;zi.stripCommentTag=xHe;zi.stripBlankChar=wHe;zi.cssFilter=Pye;zi.getDefaultCSSWhiteList=sHe;var JO={},jm=kW;function bHe(t){var e=jm.spaceIndex(t),n;return e===-1?n=t.slice(1,-1):n=t.slice(1,e+1),n=jm.trim(n).toLowerCase(),n.slice(0,1)==="/"&&(n=n.slice(1)),n.slice(-1)==="/"&&(n=n.slice(0,-1)),n}function EHe(t){return t.slice(0,2)==="</"}function SHe(t,e,n){var r="",i=0,s=!1,o=!1,a=0,l=t.length,c="",u="";e:for(a=0;a<l;a++){var h=t.charAt(a);if(s===!1){if(h==="<"){s=a;continue}}else if(o===!1){if(h==="<"){r+=n(t.slice(i,a)),s=a,i=a;continue}if(h===">"){r+=n(t.slice(i,s)),u=t.slice(s,a+1),c=bHe(u),r+=e(s,r.length,c,u,EHe(u)),i=a+1,s=!1;continue}if(h==='"'||h==="'")for(var f=1,g=t.charAt(a-f);g.trim()===""||g==="=";){if(g==="="){o=h;continue e}g=t.charAt(a-++f)}}else if(h===o){o=!1;continue}}return i<t.length&&(r+=n(t.substr(i))),r}var THe=/[^a-zA-Z0-9\\_:.-]/gim;function kHe(t,e){var n=0,r=0,i=[],s=!1,o=t.length;function a(f,g){if(f=jm.trim(f),f=f.replace(THe,"").toLowerCase(),!(f.length<1)){var y=e(f,g||"");y&&i.push(y)}}for(var l=0;l<o;l++){var c=t.charAt(l),u,h;if(s===!1&&c==="="){s=t.slice(n,l),n=l+1,r=t.charAt(n)==='"'||t.charAt(n)==="'"?n:IHe(t,l+1);continue}if(s!==!1&&l===r){if(h=t.indexOf(c,l+1),h===-1)break;u=jm.trim(t.slice(r+1,h)),a(s,u),s=!1,l=h,n=l+1;continue}if(/\s|\n|\t/.test(c))if(t=t.replace(/\s|\n|\t/g," "),s===!1)if(h=AHe(t,l),h===-1){u=jm.trim(t.slice(n,l)),a(u),s=!1,n=l+1;continue}else{l=h-1;continue}else if(h=PHe(t,l-1),h===-1){u=jm.trim(t.slice(n,l)),u=fne(u),a(s,u),s=!1,n=l+1;continue}else continue}return n<t.length&&(s===!1?a(t.slice(n)):a(s,fne(jm.trim(t.slice(n))))),jm.trim(i.join(" "))}function AHe(t,e){for(;e<t.length;e++){var n=t[e];if(n!==" ")return n==="="?e:-1}}function IHe(t,e){for(;e<t.length;e++){var n=t[e];if(n!==" ")return n==="'"||n==='"'?e:-1}}function PHe(t,e){for(;e>0;e--){var n=t[e];if(n!==" ")return n==="="?e:-1}}function CHe(t){return t[0]==='"'&&t[t.length-1]==='"'||t[0]==="'"&&t[t.length-1]==="'"}function fne(t){return CHe(t)?t.substr(1,t.length-2):t}JO.parseTag=SHe;JO.parseAttr=kHe;var RHe=TW.FilterCSS,Xu=zi,$ye=JO,MHe=$ye.parseTag,NHe=$ye.parseAttr,zM=kW;function tR(t){return t==null}function OHe(t){var e=zM.spaceIndex(t);if(e===-1)return{html:"",closing:t[t.length-2]==="/"};t=zM.trim(t.slice(e+1,-1));var n=t[t.length-1]==="/";return n&&(t=zM.trim(t.slice(0,-1))),{html:t,closing:n}}function LHe(t){var e={};for(var n in t)e[n]=t[n];return e}function DHe(t){var e={};for(var n in t)Array.isArray(t[n])?e[n.toLowerCase()]=t[n].map(function(r){return r.toLowerCase()}):e[n.toLowerCase()]=t[n];return e}function Fye(t){t=LHe(t||{}),t.stripIgnoreTag&&(t.onIgnoreTag&&console.error('Notes: cannot use these two options "stripIgnoreTag" and "onIgnoreTag" at the same time'),t.onIgnoreTag=Xu.onIgnoreTagStripAll),t.whiteList||t.allowList?t.whiteList=DHe(t.whiteList||t.allowList):t.whiteList=Xu.whiteList,t.onTag=t.onTag||Xu.onTag,t.onTagAttr=t.onTagAttr||Xu.onTagAttr,t.onIgnoreTag=t.onIgnoreTag||Xu.onIgnoreTag,t.onIgnoreTagAttr=t.onIgnoreTagAttr||Xu.onIgnoreTagAttr,t.safeAttrValue=t.safeAttrValue||Xu.safeAttrValue,t.escapeHtml=t.escapeHtml||Xu.escapeHtml,this.options=t,t.css===!1?this.cssFilter=!1:(t.css=t.css||{},this.cssFilter=new RHe(t.css))}Fye.prototype.process=function(t){if(t=t||"",t=t.toString(),!t)return"";var e=this,n=e.options,r=n.whiteList,i=n.onTag,s=n.onIgnoreTag,o=n.onTagAttr,a=n.onIgnoreTagAttr,l=n.safeAttrValue,c=n.escapeHtml,u=e.cssFilter;n.stripBlankChar&&(t=Xu.stripBlankChar(t)),n.allowCommentTag||(t=Xu.stripCommentTag(t));var h=!1;n.stripIgnoreTagBody&&(h=Xu.StripTagBody(n.stripIgnoreTagBody,s),s=h.onIgnoreTag);var f=MHe(t,function(g,y,_,b,T){var A={sourcePosition:g,position:y,isClosing:T,isWhite:Object.prototype.hasOwnProperty.call(r,_)},I=i(_,b,A);if(!tR(I))return I;if(A.isWhite){if(A.isClosing)return"</"+_+">";var P=OHe(b),R=r[_],D=NHe(P.html,function(C,M){var O=zM.indexOf(R,C)!==-1,j=o(_,C,M,O);return tR(j)?O?(M=l(_,C,M,u),M?C+'="'+M+'"':C):(j=a(_,C,M,O),tR(j)?void 0:j):j});return b="<"+_,D&&(b+=" "+D),P.closing&&(b+=" /"),b+=">",b}else return I=s(_,b,A),tR(I)?c(b):I},c);return h&&(f=h.remove(f)),f};var jHe=Fye;(function(t,e){var n=zi,r=JO,i=jHe;function s(a,l){var c=new i(l);return c.process(a)}e=t.exports=s,e.filterXSS=s,e.FilterXSS=i,(function(){for(var a in n)e[a]=n[a];for(var l in r)e[l]=r[l]})();function o(){return typeof self<"u"&&typeof DedicatedWorkerGlobalScope<"u"&&self instanceof DedicatedWorkerGlobalScope}o()&&(self.filterXSS=t.exports)})(o7,o7.exports);var T_=o7.exports,$He=function(t){if(typeof t!="object"||t===null||Object.prototype.toString.call(t)!=="[object Object]")return!1;var e=Object.getPrototypeOf(t);if(e===null)return!0;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e},Vye=(function(){function t(e,n){var r=this;this.arcgisWhiteList={a:["href","style","target"],abbr:["title"],article:["style"],aside:["style"],audio:["autoplay","controls","loop","muted","preload"],b:[],blockquote:["style"],br:[],code:["style"],dd:["style"],del:["style"],details:["open","style"],div:["align","aria-hidden","aria-label","style"],dl:["style"],dt:["style"],em:[],figcaption:["style"],figure:["style"],font:["color","face","size","style"],footer:["style"],h1:["style"],h2:["style"],h3:["style"],h4:["style"],h5:["style"],h6:["style"],header:["style"],hr:[],i:[],img:["alt","border","height","src","style","width"],li:[],main:["style"],mark:["style"],nav:["style"],ol:[],p:["style"],pre:["style"],section:["style"],source:["media","src","type"],span:["aria-hidden","aria-label","style"],strong:[],sub:["style"],summary:["style"],sup:["style"],table:["border","cellpadding","cellspacing","height","style","width"],tbody:[],tr:["align","height","style","valign"],td:["align","colspan","height","nowrap","rowspan","style","valign","width"],th:["align","colspan","height","nowrap","rowspan","style","valign","width"],time:["style"],u:[],ul:[],video:["autoplay","controls","height","loop","muted","poster","preload","width"]},this.arcgisCSSWhiteList=cN(cN({},T_.getDefaultCSSWhiteList()),{"align-items":!0,"align-self":!0,flex:!0,"flex-basis":!0,"flex-direction":!0,"flex-flow":!0,"flex-grow":!0,"flex-shrink":!0,"flex-wrap":!0,float:!0,gap:!0,grid:!0,"grid-area":!0,"grid-auto-columns":!0,"grid-auto-flow":!0,"grid-auto-rows":!0,"grid-column":!0,"grid-column-end":!0,"grid-column-start":!0,"grid-row":!0,"grid-row-end":!0,"grid-row-start":!0,"grid-template":!0,"grid-template-areas":!0,"grid-template-columns":!0,"grid-template-rows":!0,"justify-content":!0,"justify-items":!0,"justify-self":!0,"line-height":!0,overflow:!0}),this.allowedProtocols=["http","https","mailto","iform","tel","flow","lfmobile","arcgis-navigator","arcgis-appstudio-player","arcgis-survey123","arcgis-collector","arcgis-workforce","arcgis-explorer","arcgis-trek2there","arcgis-quickcapture","mspbi","comgooglemaps","pdfefile","pdfehttp","pdfehttps","boxapp","boxemm","awb","awbs","gropen","radarscope"],this.arcgisFilterOptions={allowCommentTag:!0,safeAttrValue:function(s,o,a,l){return s==="a"&&o==="href"||(s==="img"||s==="source")&&o==="src"?r.sanitizeUrl(a):T_.safeAttrValue(s,o,a,l)}},this._entityMap={"&":"&#x38;","<":"&#x3C;",">":"&#x3E;",'"':"&#x22;","'":"&#x27;","/":"&#x2F;"};var i;e&&!n?i=e:e&&n?(i=Object.create(this.arcgisFilterOptions),i.css={whiteList:this.arcgisCSSWhiteList},Object.keys(e).forEach(function(s){if(s==="whiteList")i.whiteList=r._extendObjectOfArrays([r.arcgisWhiteList,e.whiteList||{}]);else if(s==="css"){var o=e.css.whiteList;o!=null&&e.css instanceof Object&&Object.keys(o).forEach(function(a){return i.css.whiteList[a]=o[a]})}else i[s]=e[s]})):(i=Object.create(this.arcgisFilterOptions),i.whiteList=this.arcgisWhiteList,i.css={whiteList:this.arcgisCSSWhiteList}),this.xssFilterOptions=i,this._xssFilter=new T_.FilterXSS(i)}return t.prototype.sanitize=function(e,n){switch(n===void 0&&(n={}),typeof e){case"number":return isNaN(e)||!isFinite(e)?null:e;case"boolean":return e;case"string":return this._xssFilter.process(e);case"object":return this._iterateOverObject(e,n);default:return n.allowUndefined&&typeof e>"u"?void 0:null}},t.prototype.sanitizeUrl=function(e,n){var r=(n??{}).isProtocolRequired,i=r===void 0?!0:r,s=this._trim(e.substring(0,e.indexOf(":"))),o=e==="/",a=/^#/.test(e),l=s&&this.allowedProtocols.indexOf(s.toLowerCase())>-1;return o||a||l?T_.escapeAttrValue(e):!s&&!i?T_.escapeAttrValue("https://".concat(e)):""},t.prototype.sanitizeHTMLAttribute=function(e,n,r,i){return typeof this.xssFilterOptions.safeAttrValue=="function"?this.xssFilterOptions.safeAttrValue(e,n,r,i):T_.safeAttrValue(e,n,r,i)},t.prototype.validate=function(e,n){n===void 0&&(n={});var r=this.sanitize(e,n);return{isValid:e===r,sanitized:r}},t.prototype.encodeHTML=function(e){var n=this;return String(e).replace(/[&<>"'\/]/g,function(r){return n._entityMap[r]})},t.prototype.encodeAttrValue=function(e){var n=/^[a-zA-Z0-9]$/;return String(e).replace(/[\x00-\xFF]/g,function(r,i){return n.test(r)?r:"&#x".concat(Number(e.charCodeAt(i)).toString(16),";")})},t.prototype._extendObjectOfArrays=function(e){var n={};return e.forEach(function(r){Object.keys(r).forEach(function(i){Array.isArray(r[i])&&Array.isArray(n[i])?n[i]=n[i].concat(r[i]):n[i]=r[i]})}),n},t.prototype._iterateOverObject=function(e,n){var r=this;n===void 0&&(n={});try{var i=!1,s=void 0;if(Array.isArray(e))s=e.reduce(function(a,l){var c=r.validate(l,n);return c.isValid?a.concat([l]):(i=!0,a.concat([c.sanitized]))},[]);else if($He(e)){var o=Object.keys(e);s=o.reduce(function(a,l){var c=e[l],u=r.validate(c,n);return u.isValid?a[l]=c:(i=!0,a[l]=u.sanitized),a},{})}else return n.allowUndefined&&typeof e>"u"?void 0:null;return i?s:e}catch{return null}},t.prototype._trim=function(e){return String.prototype.trim?e.trim():e.replace(/(^\s*)|(\s*$)/g,"")},t})();const FHe=["dd","dl","dt","h1","h2","h3","h4","h5","h6","sub","sup","animate","animatetransform","circle","clippath","defs","ellipse","g","image","line","lineargradient","marker","mask","path","pattern","polygon","polyline","radialgradient","rect","stop","svg","switch","symbol","text","textpath","tspan","use"],VHe=FHe.reduce((t,e)=>(t[e]=[],t),{}),zHe=["align","alink","alt","bgcolor","border","cellpadding","cellspacing","class","color","cols","colspan","coords","d","dir","face","height","hspace","ismap","lang","marginheight","marginwidth","multiple","nohref","noresize","noshade","nowrap","ref","rel","rev","rows","rowspan","scrolling","shape","span","summary","tabindex","title","usemap","valign","value","vlink","vspace","width"],zye=new Vye({whiteList:VHe,onTagAttr:(t,e,n)=>{const r=`${e}="${n}"`;if(zHe.includes(e))return r},stripIgnoreTag:!0,stripIgnoreTagBody:["script","style"]},!0),pMt=new Vye({whiteList:{br:[]},stripIgnoreTag:!0,escapeHtml:t=>t},!1),Gye="http://www.w3.org/",QO=`${Gye}2000/svg`,Uye=`${Gye}1999/xlink`;let pne=[],AW=(t,e)=>{let n={};return Object.keys(t).forEach(r=>{n[r]=t[r]}),e&&Object.keys(e).forEach(r=>{n[r]=e[r]}),n},IW=(t,e)=>t.vnodeSelector===e.vnodeSelector&&(t.properties&&e.properties?t.properties.key===e.properties.key&&t.properties.bind===e.properties.bind:!t.properties&&!e.properties),Bye=t=>{if(typeof t!="string")throw new Error("Style values must be strings")},GHe=(t,e,n)=>{if(e.vnodeSelector!==""){for(let r=n;r<t.length;r++)if(IW(t[r],e))return r}return-1},Zj=(t,e,n,r)=>{let i=t[e];if(i.vnodeSelector==="")return;let s=i.properties;if(!(s&&(s.key===void 0?s.bind:s.key))){for(let o=0;o<t.length;o++)if(o!==e){let a=t[o];if(IW(a,i))throw new Error(`${n.vnodeSelector} had a ${i.vnodeSelector} child ${r==="added"?r:"removed"}, but there is now more than one. You must add unique key properties to make them distinguishable.`)}}},UHe=t=>{if(t.properties){let e=t.properties.enterAnimation;e&&e(t.domNode,t.properties)}},l7=[],c7=!1,Wye=t=>{(t.children||[]).forEach(Wye),t.properties&&t.properties.afterRemoved&&t.properties.afterRemoved.apply(t.properties.bind||t.properties,[t.domNode])},mne=()=>{c7=!1,l7.forEach(Wye),l7.length=0},gne=t=>{l7.push(t),c7||(c7=!0,typeof window<"u"&&"requestIdleCallback"in window?window.requestIdleCallback(mne,{timeout:16}):setTimeout(mne,16))},yne=t=>{let e=t.domNode;if(t.properties){let n=t.properties.exitAnimation;if(n)return e.style.pointerEvents="none",void n(e,()=>{e.parentNode&&(e.parentNode.removeChild(e),gne(t))},t.properties)}e.parentNode&&(e.parentNode.removeChild(e),gne(t))},BHe=(t,e,n)=>{if(!e)return;let r=n.eventHandlerInterceptor,i=Object.keys(e),s=i.length;for(let o=0;o<s;o++){let a=i[o],l=e[a];if(a==="className")throw new Error('Property "className" is not supported, use "class".');if(a==="class")h7(t,l,!0);else if(a==="classes"){let c=Object.keys(l),u=c.length;for(let h=0;h<u;h++){let f=c[h];l[f]&&t.classList.add(f)}}else if(a==="styles"){let c=Object.keys(l),u=c.length;for(let h=0;h<u;h++){let f=c[h],g=l[f];g&&(Bye(g),n.styleApplyer(t,f,g))}}else if(a!=="key"&&l!=null){let c=typeof l;c==="function"?(a.lastIndexOf("on",0)===0&&(r&&(l=r(a,l,t,e)),a==="oninput"&&(function(){let u=l;l=function(h){u.apply(this,[h]),h.target["oninput-value"]=h.target.value}})()),t[a]=l):n.namespace===QO?a==="href"?t.setAttributeNS(Uye,a,l):t.setAttribute(a,l):c==="string"&&a!=="value"?a==="innerHTML"?t[a]=zye.sanitize(l):u7(t)&&a in t?t[a]=l:t.setAttribute(a,l):t[a]=l}}};function u7(t){if(!(t instanceof Element&&t.tagName.includes("-")))return!1;const e=window.customElements.get(t.tagName.toLowerCase());return!!e&&t instanceof e}let hN,WHe=(t,e,n)=>{if(e)for(let r of e)ST(r,t,void 0,n)},Hye=(t,e,n)=>{WHe(t,e.children,n),e.text&&(t.textContent=e.text),BHe(t,e.properties,n),e.properties&&e.properties.afterCreate&&e.properties.afterCreate.apply(e.properties.bind||e.properties,[t,n,e.vnodeSelector,e.properties,e.children])},ST=(t,e,n,r)=>{let i,s=0,o=t.vnodeSelector,a=e.ownerDocument;if(o==="")i=t.domNode=a.createTextNode(t.text),n!==void 0?e.insertBefore(i,n):e.appendChild(i);else{for(let l=0;l<=o.length;++l){let c=o.charAt(l);if(l===o.length||c==="."||c==="#"){let u=o.charAt(s-1),h=o.slice(s,l);u==="."?i.classList.add(h):u==="#"?i.id=h:(h==="svg"&&(r=AW(r,{namespace:QO})),r.namespace!==void 0?i=t.domNode=a.createElementNS(r.namespace,h):(i=t.domNode=t.domNode||a.createElement(h),h==="input"&&t.properties&&t.properties.type!==void 0&&i.setAttribute("type",t.properties.type)),n!==void 0?e.insertBefore(i,n):i.parentNode!==e&&e.appendChild(i)),s=l+1}}Hye(i,t,r)}},h7=(t,e,n)=>{e&&e.split(" ").forEach(r=>{r&&t.classList.toggle(r,n)})},HHe=(t,e,n,r)=>{if(!n)return;let i=!1,s=Object.keys(n),o=s.length;for(let a=0;a<o;a++){let l=s[a],c=n[l],u=e[l];if(l==="class")u!==c&&(h7(t,u,!1),h7(t,c,!0));else if(l==="classes"){let h=t.classList,f=Object.keys(c),g=f.length;for(let y=0;y<g;y++){let _=f[y],b=!!c[_];b!==!!u[_]&&(i=!0,b?h.add(_):h.remove(_))}}else if(l==="styles"){let h=Object.keys(c),f=h.length;for(let g=0;g<f;g++){let y=h[g],_=c[y];_!==u[y]&&(i=!0,_?(Bye(_),r.styleApplyer(t,y,_)):r.styleApplyer(t,y,""))}}else if(c||typeof u!="string"||(c=""),l!=="value"||u7(t)){if(c!==u){let h=typeof c;h==="function"&&r.eventHandlerInterceptor||(r.namespace===QO?l==="href"?t.setAttributeNS(Uye,l,c):t.setAttribute(l,c):h==="string"?l==="innerHTML"?t[l]=zye.sanitize(c):l==="role"&&c===""?t.removeAttribute(l):u7(t)&&l in t?t[l]=c:t.setAttribute(l,c):t[l]!==c&&(t[l]=c),i=!0)}}else{let h=t[l];h!==c&&(t["oninput-value"]?h===t["oninput-value"]:c!==u)&&(t[l]=c,t["oninput-value"]=void 0),c!==u&&(i=!0)}}return i},qHe=(t,e,n,r,i)=>{if(n===r)return!1;r=r||pne;let s,o=(n=n||pne).length,a=r.length,l=0,c=0,u=!1;for(;c<a;){let h=l<o?n[l]:void 0,f=r[c];if(h!==void 0&&IW(h,f))u=hN(h,f,i)||u,l++;else{let g=GHe(n,f,l+1);if(g>=0){for(s=l;s<g;s++)yne(n[s]),Zj(n,s,t,"removed");u=hN(n[g],f,i)||u,l=g+1}else ST(f,e,l<o?n[l].domNode:void 0,i),UHe(f),Zj(r,c,t,"added")}c++}if(o>l)for(s=l;s<o;s++)yne(n[s]),Zj(n,s,t,"removed");return u};hN=(t,e,n)=>{let r=t.domNode,i=!1;if(t===e)return!1;let s=!1;if(e.vnodeSelector===""){if(e.text!==t.text){let o=r.ownerDocument.createTextNode(e.text);return r.parentNode.replaceChild(o,r),e.domNode=o,i=!0,i}e.domNode=r}else e.vnodeSelector.lastIndexOf("svg",0)===0&&(n=AW(n,{namespace:QO})),t.text!==e.text&&(s=!0,e.text===void 0?r.removeChild(r.firstChild):r.textContent=e.text),e.domNode=r,s=qHe(e,r,t.children,e.children,n)||s,s=HHe(r,t.properties,e.properties,n)||s,e.properties&&e.properties.afterUpdate&&e.properties.afterUpdate.apply(e.properties.bind||e.properties,[r,n,e.vnodeSelector,e.properties,e.children]);return s&&e.properties&&e.properties.updateAnimation&&e.properties.updateAnimation(r,e.properties,t.properties),i};let nR=(t,e)=>({getLastRender:()=>t,update:n=>{if(t.vnodeSelector!==n.vnodeSelector)throw new Error("The selector for the root VNode may not be changed. (consider using dom.merge and add one extra level to the virtual DOM)");let r=t;t=n,hN(r,n,e)},domNode:t.domNode});const KHe={namespace:void 0,performanceLogger:()=>{},eventHandlerInterceptor:void 0,styleApplyer:(t,e,n)=>{e.charAt(0)==="-"?t.style.setProperty(e,n):t.style[e]=n}};let vS=t=>AW(KHe,t),ig={append:(t,e,n)=>(n=vS(n),ST(e,t,void 0,n),nR(e,n)),insertBefore:(t,e,n)=>(n=vS(n),ST(e,t.parentNode,t,n),nR(e,n)),merge:(t,e,n)=>(n=vS(n),e.domNode=t,Hye(t,e,n),nR(e,n)),replace:(t,e,n)=>(n=vS(n),ST(e,t.parentNode,t,n),t.parentNode.removeChild(t),nR(e,n))},qye,YHe=(t,e)=>{let n=[];for(;t&&t!==e;)n.push(t),t=t.parentNode;return n};qye=Array.prototype.find?(t,e)=>t.find(e):(t,e)=>t.filter(e)[0];let XHe=(t,e)=>{let n=t;return e.forEach(r=>{n=n&&n.children?qye(n.children,i=>i.domNode===r):void 0}),n},ZHe=(t,e,n)=>{let r=function(i){n("domEvent",i);let s=e(),o=YHe(i.currentTarget,s.domNode);o.reverse();let a,l=XHe(s.getLastRender(),o);return t.scheduleRender(),l&&(a=l.properties[`on${i.type}`].apply(l.properties.bind||this,arguments)),n("domEventProcessed",i),a};return(i,s,o,a)=>r},vne=t=>{let e,n,r=vS(t),i=r.performanceLogger,s=!0,o=!1,a=[],l=[],c=(h,f,g)=>{let y,_=()=>y;r.eventHandlerInterceptor=ZHe(e,_,i),y=h(f,g(),r),a.push(y),l.push(g)},u=()=>{if(n=void 0,s){s=!1,i("renderStart",void 0);for(let h=0;h<a.length;h++){let f=l[h]();i("rendered",void 0),a[h].update(f),i("patched",void 0)}i("renderDone",void 0),s=!0}};return e={renderNow:u,scheduleRender:()=>{n||o||(n=requestAnimationFrame(u))},stop:()=>{n&&(cancelAnimationFrame(n),n=void 0),o=!0},resume:()=>{o=!1,s=!0,e.scheduleRender()},append:(h,f)=>{c(ig.append,h,f)},insertBefore:(h,f)=>{c(ig.insertBefore,h,f)},merge:(h,f)=>{c(ig.merge,h,f)},replace:(h,f)=>{c(ig.replace,h,f)},detach:h=>{for(let f=0;f<l.length;f++)if(l[f]===h)return l.splice(f,1),a.splice(f,1)[0];throw new Error("renderFunction was not found")}},e},bm=class extends Kt{constructor(){super(...arguments),this.items=new Ot,this._watchUpdatingTracking=new a1,this._callbacks=new Map,this._projector=vne(),this._hiddenProjector=vne()}get needsRender(){return this.items.length>0}get updating(){return this._watchUpdatingTracking?.updating??!1}initialize(){const e=document.createElement("div");e.className="esri-overlay-surface",this._set("surface",e),this._hiddenSurface=document.createElement("div"),this._hiddenSurface.setAttribute("style","visibility: hidden;"),e.appendChild(this._hiddenSurface),this._watchUpdatingTracking.addOnCollectionChange(()=>this.items,n=>{for(const r of n.added){const i=()=>r.render();this._callbacks.set(r,i),this._projector.append(this.surface,i)}for(const r of n.removed){const i=this._projector.detach(this._callbacks.get(r));this.surface.removeChild(i.domNode),this._callbacks.delete(r)}})}addItem(e){this.items.add(e)}removeItem(e){this.items.remove(e)}destroy(){this.items.removeAll(),this._callbacks.forEach(e=>this._projector.detach(e)),this._callbacks=null,this._projector=null,this._watchUpdatingTracking.destroy()}render(){this._projector.renderNow()}computeBoundingRect(e){const n=this._hiddenSurface,r=this._hiddenProjector;let i;const s=()=>(i=e.render(),i);r.append(n,s),r.renderNow();const o={left:0,top:0,right:0,bottom:0};if(i?.domNode){const a=i.domNode.getBoundingClientRect();o.left=a.left,o.top=a.top,o.right=a.right,o.bottom=a.bottom}for(r.detach(s);n.firstChild;)n.removeChild(n.firstChild);return o}overlaps(e,n){const r=this.computeBoundingRect(e),i=this.computeBoundingRect(n);return Math.max(r.left,i.left)<=Math.min(r.right,i.right)&&Math.max(r.top,i.top)<=Math.min(r.bottom,i.bottom)}get hasVisibleItems(){return this.items.some(e=>e.visible)}async prepare(){await document.fonts.load(this._fontString()).catch(()=>{})}renderCanvas(e,n){const r=!!n?.disableDecorations;if(!this.items.some(s=>s.visible&&!(r&&s.isDecoration)))return;const i=e.getContext("2d");i.save(),i.font=this._fontString(),this.items.forEach(s=>{r&&s.isDecoration||(i.save(),s.renderCanvas(i),i.restore())}),i.restore()}_fontString(){return`10px ${getComputedStyle(this.surface).fontFamily}`}};x([E({readOnly:!0})],bm.prototype,"surface",void 0),x([E({readOnly:!0})],bm.prototype,"items",void 0),x([E({readOnly:!0})],bm.prototype,"needsRender",null),x([E({readOnly:!0})],bm.prototype,"_watchUpdatingTracking",void 0),x([E({readOnly:!0})],bm.prototype,"updating",null),bm=x([ue("esri.views.overlay.ViewOverlay")],bm);const _ne=bm,Jj=[0,0];function JHe(t){const e=(t.ownerDocument||window.document).defaultView,n=t.getBoundingClientRect();return Jj[0]=n.left+(e?.pageXOffset??0),Jj[1]=n.top+(e?.pageYOffset??0),Jj}function xne(t){t&&(t.textContent="",t.parentNode&&t.parentNode.removeChild(t))}function QHe(t){const e=document.createElement("div");return t.appendChild(e),e}const k_=16,VE=750,eqe=512,tqe=2,nqe=t=>{const e=t;let n=class extends e{constructor(...r){super(...r),this._freqInfo={freq:k_,time:VE},this._overlayRenderTaskHandle=null,this.aria={},this.height=0,this.messagesCommon=null,this.overlay=null,this.position=null,this.resizing=!1,this.root=null,this.surface=null,this.suspended=!0,this.userContent=null,this.width=0,this.widthBreakpoint=null,this.addHandles([fn(()=>this.cursor,i=>{const{surface:s}=this;s&&s.setAttribute("data-cursor",i)}),fn(()=>this.navigating,i=>{const{surface:s}=this;s&&s.setAttribute("data-navigating",i.toString())}),fn(()=>[this.aria,this.surface],()=>this._updateAria(),{initial:!0})])}initialize(){const r=this;this.addHandles([fn(()=>this.ui,(i,s)=>this._handleUIChange(i,s),ya),r.on("focus",()=>this.notifyChange("focused")),r.on("blur",()=>this.notifyChange("focused"))])}destroy(){this.destroyed||(this.ui?.destroy(),this.container=null)}get container(){return this._get("container")??null}set container(r){const i=this._get("container"),s=SW(r);if(s||typeof r!="string"||kt.getLogger(this).error("#container",`element with id '${r}' not found`),i===s)return;if(this._stopMeasuring(),i&&(i.classList.remove("esri-view"),this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null),this.overlay&&(this.overlay.destroy(),this._set("overlay",null)),this.root&&(xne(this.root),this._set("root",null)),this.userContent&&(cne(this.userContent,i),xne(this.userContent),this._set("userContent",null))),!s)return this._set("width",0),this._set("height",0),this._set("position",null),this._set("suspended",!0),this._set("surface",null),void this._set("container",null);s.classList.add("esri-view");const o=document.createElement("div");o.className="esri-view-user-storage",cne(s,o),s.appendChild(o),this._set("userContent",o);const a=document.createElement("div");a.className="esri-view-root",s.insertBefore(a,s.firstChild),this._set("root",a);const l=document.createElement("div");l.className="esri-view-surface",l.setAttribute("role","application"),l.tabIndex=0,a.appendChild(l),this._set("surface",l);const c=new _ne;a.appendChild(c.surface),this._set("overlay",c),this.addHandles(fn(()=>c.needsRender,u=>{u&&!this._overlayRenderTaskHandle?this._overlayRenderTaskHandle=x2({render:()=>this.overlay?.render()}):this._overlayRenderTaskHandle=ii(this._overlayRenderTaskHandle)})),this.forceDOMReadyCycle(),this._set("container",s),this._startMeasuring()}get focused(){const r=document.activeElement===this.surface;return document.hasFocus()&&r}get size(){return[this.width,this.height]}set ui(r){const i=this._get("ui");i!==r&&i?.destroy(),this._set("ui",r)}blur(){this.surface?.blur()}focus(){this.surface?.focus()}pageToContainer(r,i,s){const o=this.position;return r-=o?o[0]:0,i-=o?o[1]:0,s?(s[0]=r,s[1]=i):s=[r,i],s}containerToPage(r,i,s){const o=this.position;return r+=o?o[0]:0,i+=o?o[1]:0,s?(s[0]=r,s[1]=i):s=[r,i],s}_updateAria(){const{surface:r,aria:i}=this;r&&(r.ariaLabelledByElements=i?.labelledByElements??null,r.ariaDescribedByElements=i?.describedByElements??null,r.ariaLabel=i?.label??null,r.ariaDescription=i?.description??null)}_handleUIChange(r,i){this.removeHandles("ui"),i&&i!==r&&i.destroy(),r&&(r.view=this,this.addHandles(fn(()=>this.root,s=>{r.container=s?QHe(s):null},ya),"ui")),this._set("ui",r)}_stopMeasuring(){this.removeHandles("measuring"),this._get("resizing")&&this._set("resizing",!1)}_startMeasuring(){const r=this._freqInfo;r.freq=k_,r.time=VE;const i=x2({prepare:a=>{const l=this._measure(),c=this._freqInfo;if(c.time+=a.deltaTime,l&&(c.freq=k_,this._get("resizing")||this._set("resizing",!0)),c.time<c.freq)return;c.time=0;const u=this._position();c.freq=u||l?k_:Math.min(VE,c.freq*tqe),!l&&c.freq>=eqe&&(i.pause(),this._get("resizing")&&this._set("resizing",!1))}}),s=new ResizeObserver(a=>{r.freq=k_,r.time=VE,i.resume()});this.container!=null&&s.observe(this.container);const o=Zn(()=>s.disconnect());this.addHandles([ob(window,"resize",()=>{r.freq=k_,r.time=VE,i.resume()}),o,i],"measuring"),this._measure(),this._position()}_measure(){const r=this.container,i=r?r.clientWidth:0,s=r?r.clientHeight:0;if(i===0||s===0)return this.suspended||this._set("suspended",!0),!1;const o=this.width,a=this.height;return i===o&&s===a?(this.suspended&&this._set("suspended",!1),!1):(this._set("width",i),this._set("height",s),this.suspended&&this._set("suspended",!1),this.emit("resize",{oldWidth:o,oldHeight:a,width:i,height:s}),!0)}_position(){const r=this.container,i=this.position,s=r&&JHe(r);return!!s&&(!i||s[0]!==i[0]||s[1]!==i[1])&&(this._set("position",[s[0],s[1]]),!0)}forceDOMReadyCycle(){}};return x([E()],n.prototype,"aria",void 0),x([E()],n.prototype,"container",null),x([E({readOnly:!0})],n.prototype,"focused",null),x([E({readOnly:!0})],n.prototype,"height",void 0),x([E()],n.prototype,"messagesCommon",void 0),x([E({type:_ne})],n.prototype,"overlay",void 0),x([E({readOnly:!0})],n.prototype,"position",void 0),x([E({readOnly:!0})],n.prototype,"resizing",void 0),x([E({readOnly:!0})],n.prototype,"root",void 0),x([E({value:null,readOnly:!0})],n.prototype,"size",null),x([E({readOnly:!0})],n.prototype,"surface",void 0),x([E({readOnly:!0})],n.prototype,"suspended",void 0),x([E({nonNullable:!0})],n.prototype,"ui",null),x([E({readOnly:!0})],n.prototype,"userContent",void 0),x([E({readOnly:!0})],n.prototype,"width",void 0),x([E()],n.prototype,"widthBreakpoint",void 0),n=x([ue("esri.views.DOMContainer")],n),n},rR="popup",wne="manual";function kd(t){return t!=null&&"open"in t&&"declaredClass"in t}function yp(t){return!!t&&t.tagName.toLowerCase()==="arcgis-popup"&&"open"in t}function rqe(t,e,n){const[r,i,s]=e;if(n){const[o,a,l]=n;o&&kd(a)&&(a.view=null,o.remove(a,rR),a!==i&&i&&a.destroy()),o&&l&&yp(l)&&(l.view=null,o.remove(l,rR),l!==s&&s&&l.remove())}r&&kd(i)&&(i.view=t,r.add(i,{key:rR,position:wne,internal:!0})),r&&s&&yp(s)&&(s.view=t,r.add(s,{key:rR,position:wne,internal:!0}))}async function iqe(t,e){const{popup:n,popupElement:r}=t;kd(n)?await iR(n,null,e):r&&yp(r)?await iR(null,r,e):e?.defer(async()=>{await t.setupPopup();const{popup:i,popupElement:s}=t;kd(i)&&!t.destroyed&&t.ready&&t.popupEnabled?await iR(i,null,e):s&&yp(s)&&await iR(null,s,e)})}function sqe(t,e){const{popup:n,popupElement:r}=t;if(kd(n))return n.open(e);r&&yp(r)&&r.open(e)}function oqe(t,e){kd(t)&&t.close(),e&&yp(e)&&(e.visible=!1)}async function iR(t,e,n){if(kd(t)){const r=await t.viewModel.handleViewClick(n);return void(r?.promises?.length?t.open(r):t.visible&&t.close())}if(e&&yp(e)){const r=await e.handleViewClick(n);r?.promises?.length?e.open(r):e.visible&&(e.visible=!1)}}const Kye=ye("mac")?"Meta":"Control",aqe=new Set(["Alt","Control","Meta","Shift","Ctrl","Primary"]),lqe=t=>aqe.has(t);let cqe=class{constructor(e,n=[]){this.eventType=e,this.keyModifiers=n}matches(e){if(e.type!==this.eventType)return!1;if(this.keyModifiers.length===0)return!0;const n=e.modifiers;for(const r of this.keyModifiers)if(!n.has(r))return!1;return!0}},Zs=class{constructor(e){this._manager=null,this._incoming={},this._outgoing={},this._incomingEventMatches=null,this._incomingEventTypes=null,this._outgoingEventTypes=null,this._hasSideEffects=e}get incomingEventMatches(){if(!this._incomingEventMatches){this._incomingEventMatches=[];for(const e in this._incoming){const n=this._incoming[e];for(const r of n)this._incomingEventMatches.push(r.match)}}return this._incomingEventMatches}get incomingEventTypes(){return this._incomingEventTypes||(this._incomingEventTypes=this.incomingEventMatches.map(e=>e.eventType)),this._incomingEventTypes}get outgoingEventTypes(){return this._outgoingEventTypes||(this._outgoingEventTypes=Object.keys(this._outgoing)),this._outgoingEventTypes}get hasSideEffects(){return this._hasSideEffects}get hasPendingInputs(){return!1}onInstall(e){this._manager||(e.setEventCallback(n=>this._handleEvent(n)),e.setUninstallCallback(()=>this._onUninstall()),this._manager=e)}onUninstall(){}registerIncoming(e,n,r){let i;typeof n=="function"?(r=n,i=[]):i=n||[];const s=typeof e=="string"?new cqe(e,i):e,o=()=>{this._incomingEventTypes=null,this._incomingEventMatches=null},a=u=>{const h=this._incoming[u.match.eventType];if(h){const f=h.indexOf(u);h.splice(f,1),o(),this._manager&&this._manager.updateDependencies()}},l=new uqe(s,r,{onPause:a,onRemove:a,onResume:u=>{const h=this._incoming[u.match.eventType];h&&!h.includes(u)&&(h.push(u),o(),this._manager&&this._manager.updateDependencies())}});let c=this._incoming[s.eventType];return c||(c=[],this._incoming[s.eventType]=c),c.push(l),o(),this._manager&&this._manager.updateDependencies(),l}registerOutgoing(e){if(this._outgoing[e])throw new Error("There is already a callback registered for this outgoing InputEvent: "+e);const n=new hqe(e,{onEmit:(r,i,s,o)=>{this._manager?.emit(r.eventType,i,s,o)},onRemove:r=>{delete this._outgoing[r.eventType],this._manager?.updateDependencies()}});return this._outgoing[e]=n,this._outgoingEventTypes=null,this._manager&&this._manager.updateDependencies(),n}startCapturingPointer(e){this._manager?.setPointerCapture(e,!0)}stopCapturingPointer(e){this._manager?.setPointerCapture(e,!1)}refreshHasPendingInputs(){this._manager?.refreshHasPendingInputs()}_onUninstall(){this._manager&&(this.onUninstall(),this._manager=null)}_handleEvent(e){const n=this._incoming[e.type];if(n){for(const r of n)if(r.match.matches(e)&&(r.callback?.(e),e.shouldStopPropagation()))break}}},uqe=class{constructor(e,n,r){this.match=e,this._callback=n,this._handler=r}pause(){this._handler.onPause(this)}resume(){this._handler.onResume(this)}remove(){this._handler.onRemove(this)}get callback(){return this._callback}},hqe=class{constructor(e,n){this.eventType=e,this._removed=!1,this._handler=n}emit(e,n,r){this._removed||this._handler.onEmit(this,e,n,r)}remove(){this._removed=!0,this._handler.onRemove(this)}},dqe=class extends Zs{constructor(e){super(!0),this._onChange=e,this._value="mouse",this._x=null,this._y=null,this._id=null,this.registerIncoming("pointer-move",n=>this._update(n.data))}_update(e){const n=e.native.pointerType==="touch"?"touch":"mouse",{x:r,y:i,native:{pointerId:s}}=e;n===this._value&&this._x===r&&this._y===i&&this._id===s||(this._value=n,this._x=r,this._y=i,this._id=s,this._onChange(s,n,r,i))}},fqe=class{constructor(e,n){this._observable=new _I,this._value=e,this._equalityFunction=n}get value(){return nn(this._observable),this._value}set value(e){this._equalityFunction(e,this._value)||(this._value=e,this._observable.notify())}mutate(e){e(this._value),this._observable.notify()}};function N2(t,e=afe){return new fqe(t,e)}let pqe=class extends Zs{get multiTouchActive(){return this._multiTouchActive.value}constructor(){super(!0),this._activeTouchPointerIds=new Set,this._multiTouchActive=N2(!1),this._onPointerAdd=({data:e})=>{e.pointerType==="touch"&&(this._activeTouchPointerIds.add(e.native.pointerId),this._update())},this._onPointerRemove=({data:e})=>{e.pointerType==="touch"&&(this._activeTouchPointerIds.delete(e.native.pointerId),this._update())},this.registerIncoming("pointer-down",this._onPointerAdd),this.registerIncoming("pointer-up",this._onPointerRemove),this.registerIncoming("pointer-capture-lost",this._onPointerRemove),this.registerIncoming("pointer-cancel",this._onPointerRemove)}_update(){this._multiTouchActive.value=this._activeTouchPointerIds.size>1}},mqe=class{constructor(e,n){this._owner=n,this._properties={},this._afterDispatchHandle=null;for(const r in e){const i=e[r],s=new spe(i,void 0,void 0,2,2);this._properties[r]={pool:s,acquired:[]}}this._afterDispatchHandle=M$e(()=>this._release())}destroy(){this._afterDispatchHandle&&(this._afterDispatchHandle.remove(),this._afterDispatchHandle=null);for(const e in this._properties){const n=this._properties[e];for(const r of n.acquired)hee(r)||n.pool.release(r);n.pool.destroy(),n.pool=null,n.acquired=null}this._properties=null,this._owner=null}get(e){const n=this._owner._get(e),r=this._properties[e];let i=r.pool.acquire();for(r.acquired.push(i);i===n;)i=r.pool.acquire(),r.acquired.push(i);return gpe(),i}_release(){for(const e in this._properties){const n=this._properties[e];let r=0;for(const i of n.acquired)hee(i)?n.acquired[r++]=i:n.pool.release(i);n.acquired.length=r}}},gqe=class{constructor(){this.id=0,this.type="mouse",this.location=Hs()}},Bu=class extends Kt{constructor(e){super(e),this._pointerCaptures=new Map,this._nameToGroup={},this._handlers=[],this._handlersPriority=[],this._currentPropagation=null,this._updateDependenciesAfterPropagation=!1,this._sourceEvents=new Set,this._keyModifiers=new Set,this._activeKeyModifiers=new Set,this._stoppedPropagationEventIds=new Set,this.primaryKey=Kye,this._propertiesPool=new mqe({latestPointerInfo:()=>new gqe},this),this._latestPointerInfo=void 0,this._paused=!1,this._testTimestamp=void 0}initialize(){this.eventSource.onEventReceived=this._onEventReceived.bind(this),this._installRecognizers()}destroy(){const e=Object.keys(this._nameToGroup);for(const n of e)this.uninstallHandlers(n);this.eventSource.destroy(),this._currentPropagation=null,this._propertiesPool.destroy()}get hasPendingInputs(){return this._handlers.some(e=>e.handler.hasPendingInputs)}get multiTouchActive(){return this._multiTouchHandler.multiTouchActive}get latestPointerInfo(){return this._latestPointerInfo}get updating(){return this.hasPendingInputs||this._paused}installHandlers(e,n,r=ip.INTERNAL){if(this._nameToGroup[e]||n.length===0)return;const i={name:e,handlers:n.map(s=>({handler:s,active:!0,removed:!1,priorityIndex:0,groupPriority:r,eventCallback:null,uninstallCallback:null}))};this._nameToGroup[e]=i;for(let s=i.handlers.length-1;s>=0;s--){const o=i.handlers[s];this._handlers.push(o),o.handler.onInstall({updateDependencies:()=>{this.updateDependencies()},emit:(a,l,c,u,h)=>{this._emitInputEvent(o.priorityIndex+1,a,l,c,h,u)},setPointerCapture:(a,l)=>{this._setPointerCapture(i,o,a,l)},setEventCallback:a=>{o.eventCallback=a},setUninstallCallback:a=>{o.uninstallCallback=a},refreshHasPendingInputs:()=>{this.notifyChange("hasPendingInputs")}})}this.updateDependencies()}uninstallHandlers(e){const n=this._nameToGroup[e];n?(n.handlers.forEach(r=>{r.removed=!0,r.uninstallCallback?.()}),delete this._nameToGroup[e],this._currentPropagation?this._currentPropagation.needsHandlerGarbageCollect=!0:this._garbageCollectRemovedHandlers()):kt.getLogger(this).error("There is no InputHandler group registered under the name `"+e+"`")}hasHandlers(e){return this._nameToGroup[e]!==void 0}isModifierKeyDown(e){return this._activeKeyModifiers.has(e)}updateDependencies(){if(this._currentPropagation)return void(this._updateDependenciesAfterPropagation=!0);this._updateDependenciesAfterPropagation=!1;const e=new Set,n=new Set;this._handlersPriority=[];for(let r=this._handlers.length-1;r>=0;r--){const i=this._handlers[r];i.priorityIndex=r,this._handlersPriority.push(i)}this._handlersPriority=this._sortHandlersPriority(this._handlersPriority);for(let r=this._handlersPriority.length-1;r>=0;r--){const i=this._handlersPriority[r];i.priorityIndex=r;let s=i.handler.hasSideEffects;if(!s){for(const o of i.handler.outgoingEventTypes)if(e.has(o)){s=!0;break}}if(s)for(const o of i.handler.incomingEventMatches){e.add(o.eventType);for(const a of o.keyModifiers)lqe(a)||n.add(a)}i.active=s}this._sourceEvents=e,this._keyModifiers=n,this._pointerCaptures.size>0&&this._sourceEvents.add("pointer-capture-lost"),this._keyModifiers.size>0&&(this._sourceEvents.add("key-down"),this._sourceEvents.add("key-up")),this.eventSource&&(this.eventSource.activeEvents=this._sourceEvents)}_setLatestPointer(e,n,r,i){const s=this._latestPointerInfo;if(s==null||s.id!==e||s.type!==n||s.location.x!==r||s.location.y!==i){const o=this._propertiesPool.get("latestPointerInfo");o.id=e,o.type=n,o.location.x=r,o.location.y=i,this._latestPointerInfo=o}}_onEventReceived(e,n){if(e==="pointer-capture-lost"){const s=n;this._pointerCaptures.delete(s.native.pointerId)}this._updateKeyModifiers(e,n);const r=this._testTimestamp??n.native?.timestamp,i=n.native?.cancelable;this._emitInputEventFromSource(e,n,r,i)}_updateKeyModifiers(e,n){if(!n)return;let r=!1;const i=()=>{r||(this._activeKeyModifiers=new Set(this._activeKeyModifiers),r=!0)},s=(a,l)=>{l&&!this._activeKeyModifiers.has(a)?(i(),this._activeKeyModifiers.add(a)):!l&&this._activeKeyModifiers.has(a)&&(i(),this._activeKeyModifiers.delete(a))};if(e==="key-down"||e==="key-up"){const a=n.key;this._keyModifiers.has(a)&&s(a,e==="key-down")}const o=n.native;s("Alt",!!o?.altKey),s("Control",!!o?.ctrlKey),s("Ctrl",!!o?.ctrlKey),s("Shift",!!o?.shiftKey),s("Meta",!!o?.metaKey),s("Primary",this._activeKeyModifiers.has(this.primaryKey))}_installRecognizers(){this._latestPointerHandler=new dqe((e,n,r,i)=>this._setLatestPointer(e,n,r,i)),this._multiTouchHandler=new pqe,this.installHandlers("input-manager-logic",[this._latestPointerHandler,this._multiTouchHandler],ip.ALWAYS),this.recognizers.length>0&&this.installHandlers("default",this.recognizers,ip.INTERNAL)}_setPointerCapture(e,n,r,i){const s=e.name+"-"+n.priorityIndex,o=this._pointerCaptures.get(r.pointerId)||new Set;this._pointerCaptures.set(r.pointerId,o),i?(o.add(s),o.size===1&&this.eventSource&&this.eventSource.setPointerCapture(r,!0)):o.has(s)&&(o.delete(s),o.size===0&&(this._pointerCaptures.delete(r.pointerId),this.eventSource&&this.eventSource.setPointerCapture(r,!1)))}_garbageCollectRemovedHandlers(){this._handlers=this._handlers.filter(e=>!e.removed),this.updateDependencies()}_emitInputEventFromSource(e,n,r,i){this._emitInputEvent(0,e,n,r,i)}_emitInputEvent(e,n,r,i,s,o){const a=i??this._currentPropagation?.timestamp??performance.now(),l=s??!1,c={event:new yqe(n,r,a,o||this._activeKeyModifiers,l),priorityIndex:e};this._currentPropagation?this._currentPropagation.events.push(c):this._doNewPropagation(c)}_doNewPropagation(e){this._currentPropagation={events:new Qk,currentHandler:null,needsHandlerGarbageCollect:!1,timestamp:e.event.timestamp},this._currentPropagation.events.push(e),this._continuePropagation()}_continuePropagation(){this._paused=!1;const e=this._currentPropagation;if(e){for(;e.events.length>0;){const{event:n,priorityIndex:r}=e.events.pop(),i=n.data?.eventId;if(!(i!=null&&this._stoppedPropagationEventIds.has(i)))for(e.currentHandler=this._handlersPriority[r];e.currentHandler;){if(e.currentHandler.removed)e.needsHandlerGarbageCollect=!0;else{if(e.currentHandler.active&&!n.shouldStopPropagation()&&e.currentHandler.eventCallback?.(n),n.shouldStopPropagation()){i!=null&&this._stoppedPropagationEventIds.add(i);break}if(n.shouldPausePropagation(()=>this._continuePropagation()))return void this._pausePropagation({event:n,priorityIndex:e.currentHandler.priorityIndex+1})}e.currentHandler=this._handlersPriority[e.currentHandler.priorityIndex+1]}}e.needsHandlerGarbageCollect&&this._garbageCollectRemovedHandlers(),this.hasPendingInputs||this._stoppedPropagationEventIds.clear(),this._currentPropagation=null,this._updateDependenciesAfterPropagation&&this.updateDependencies()}}_pausePropagation(e){const n=new Qk;n.push(e);const r=this._currentPropagation;if(r){for(;r.events.length;)n.push(r.events.pop());r.events=n,r.currentHandler=null,this._paused=!0}}_compareHandlerPriority(e,n){if(e.handler.hasSideEffects!==n.handler.hasSideEffects)return e.handler.hasSideEffects?1:-1;if(e.groupPriority!==n.groupPriority)return e.groupPriority>n.groupPriority?-1:1;for(const r of e.handler.incomingEventMatches)for(const i of n.handler.incomingEventMatches){if(r.eventType!==i.eventType)continue;const s=r.keyModifiers.filter(o=>i.keyModifiers.includes(o));if(s.length===r.keyModifiers.length!=(s.length===i.keyModifiers.length))return r.keyModifiers.length>i.keyModifiers.length?-1:1}return e.priorityIndex>n.priorityIndex?-1:1}_sortHandlersPriority(e){const n=[];for(const r of e){let i=0;for(;i<n.length&&this._compareHandlerPriority(r,n[i])>=0;)i++;n.splice(i,0,r)}return n}get test(){}};x([E({readOnly:!0})],Bu.prototype,"hasPendingInputs",null),x([E({constructOnly:!0})],Bu.prototype,"eventSource",void 0),x([E({constructOnly:!0})],Bu.prototype,"recognizers",void 0),x([E()],Bu.prototype,"multiTouchActive",null),x([E()],Bu.prototype,"_latestPointerInfo",void 0),x([E()],Bu.prototype,"latestPointerInfo",null),x([E()],Bu.prototype,"_paused",void 0),x([E({readOnly:!0})],Bu.prototype,"updating",null),Bu=x([ue("esri.views.input.InputManager")],Bu);let yqe=class{constructor(e,n,r,i,s){this.type=e,this.data=n,this.timestamp=r,this.modifiers=i,this.cancelable=s,this._propagationState=0,this._resumeCallback=null}stopPropagation(){this._propagationState|=1}shouldStopPropagation(){return!!(1&this._propagationState)}defer(e){this._propagationState|=2;const n=(r,i)=>{this._propagationState&=-3;const s=this._resumeCallback;if(this._resumeCallback=null,s&&s(),i)throw r;return r};return(typeof e=="function"?e():e).then(r=>n(r,!1),r=>n(r,!0))}shouldPausePropagation(e){return!!(2&this._propagationState)&&(this._resumeCallback=e,!0)}preventDefault(){this.data.native.preventDefault()}};const ip={ALWAYS:1,DEFAULT:0,TOOL:-1,WIDGET:-2,INTERNAL:-3},vqe=t=>{const e=t;let n=class extends e{constructor(){super(...arguments),this._popupSetupTask=null,this.popup={},this.popupEnabled=!0}initialize(){this.addHandles([fn(()=>[this.ui,this.popup,this.popupElement],([r,i,s],o)=>{const[a,l,c]=o??[];rqe(this,[r,i,s],[a,l,c])},ra),this.on("click",r=>{this.popup&&this.popupEnabled&&(r.pointerType!=="mouse"||r.button===0)&&iqe(this,r)},ip.WIDGET)]),tW(()=>this.ready&&this.popupEnabled&&!this.updating).then(()=>_e(()=>import("./Popup-BuXhRrC7.js").then(r=>r.P),__vite__mapDeps([228,229,18,230,231,232,233,204,200,177,164,201,31,202,203,142,87,205,122,163,206,82,130,234,55,235,236,131,132,24,25,198,199,135,83,78,127,76,77,52,53,54,237,112,110,111,26,64,67,113,238,239,240,241,242,20,29,243,244,245,246,27,247,248,249,250,251,252,154,253,254,255,256,257,28,30,258,259,260,261,262,33,263,264,197,265,266,32,267,268,269,270,271,272,273,274,275,276,42,277,134,278,279,280,281])))}destroy(){this.destroyed||this.closePopup()}async openPopup(r){if(kd(this.popup))return this.popup.open(r);if(this.popupElement&&yp(this.popupElement))this.popupElement.open(r).catch(()=>{});else try{if(await this.setupPopup(),!this.popup)return void kt.getLogger(this).error(new Xe("view:null-popup","Popup is null and can't be opened"));sqe(this,r)}catch{}}closePopup(){this._popupSetupTask?.abort(),oqe(this.popup,this.popupElement)}async fetchPopupFeatures(r,i){return await this.when(),this._popupHitsToFeatures(await this._getPopupHits(r,i),i)}async setupPopup(){if(this._popupSetupTask?.abort(),this.popup&&!kd(this.popup))return this._popupSetupTask=MO(async r=>{if(!this.popupEnabled||!yp(this.popupElement))if(this.dependencies.popup&&typeof this.dependencies.popup=="function")await this.dependencies.popup(),pi(r),customElements.get("arcgis-popup")||kt.getLogger(this).error(new Xe("view:undefined-popup-element","`arcgis-popup` custom element is undefined and can't be opened")),this.popupElement=document.createElement("arcgis-popup");else{const{default:i}=await _e(()=>import("./Popup-BuXhRrC7.js").then(o=>o.P),__vite__mapDeps([228,229,18,230,231,232,233,204,200,177,164,201,31,202,203,142,87,205,122,163,206,82,130,234,55,235,236,131,132,24,25,198,199,135,83,78,127,76,77,52,53,54,237,112,110,111,26,64,67,113,238,239,240,241,242,20,29,243,244,245,246,27,247,248,249,250,251,252,154,253,254,255,256,257,28,30,258,259,260,261,262,33,263,264,197,265,266,32,267,268,269,270,271,272,273,274,275,276,42,277,134,278,279,280,281]));if(pi(r),!this.popup||kd(this.popup))return;const s=this.popup;if("open"in s||"close"in s){const{open:o,close:a,...l}=s;this.popup=new i({...l})}else this.popup=new i(s)}}),this._popupSetupTask.promise}async _popupHitsToFeatures({location:r,hits:i},s){const o=[],a=[];let l=!1;const c=oje(s,ye("popup-view-fetch-timeout")??xqe),u=g=>{const y=new _qe(g);return a.push(y),o.push(y.promise),y},h=g=>{const y=a.at(-1);return y&&y.layerView===g&&!l?y:u(g)};for(const g of i)"graphic"in g?(h(g.layerView).graphics.push(g.graphic),l=!1):(o.push(g.layerView.fetchPopupFeaturesAtLocation(g.mapPoint,c)),l=!0);a.forEach(g=>g.resolve(c));const f=sje(o).then(g=>g.filter(y=>!!y).flat());return{pendingFeatures:o,allGraphicsPromise:f,location:r}}async _getPopupHits(r,i){const{hits:s,location:o}=await this.popupHitTest(r);pi(i);const a=[];for(const l of s)if("graphic"in l){if(this._isValidPopupGraphic(l.graphic,i)){const c=this._isValidPopupGraphicsLayerView(l.layerView)?l.layerView:void 0;a.push({graphic:l.graphic,layerView:c})}}else this._isValidPopupLocationLayerView(l.layerView)&&a.push({mapPoint:l.mapPoint,layerView:l.layerView});return{hits:a,location:o}}_isValidPopupGraphic(r,i){return r&&!!r.getEffectivePopupTemplate(i?.defaultPopupTemplateEnabled)}_isValidPopupGraphicsLayerView(r){return!r||(!("layer"in r)||!r.suspended)&&"fetchPopupFeaturesFromGraphics"in r}_isValidPopupLocationLayerView(r){return(!("layer"in r)||!r.suspended)&&"fetchPopupFeaturesAtLocation"in r}};return x([E()],n.prototype,"popup",void 0),x([E()],n.prototype,"popupElement",void 0),x([E()],n.prototype,"popupEnabled",void 0),n=x([ue("esri.views.PopupView")],n),n};let _qe=class{constructor(e){this.layerView=e,this._resolver=xc(),this.graphics=[]}get promise(){return this._resolver.promise}resolve(e){const{layerView:n,graphics:r,_resolver:i}=this;if(!n)return i.resolve(r),i.promise;let s;return n.fetchPopupFeaturesFromGraphics(r,e).catch(o=>(s=o,null)).then(o=>{o?i.resolve(o):i.reject(s)}),i.promise}};const xqe=5e3;var _S;const dN=Ol()({orthometric:"gravity-related-height",gravity_related_height:"gravity-related-height",ellipsoidal:"ellipsoidal"}),Yye=dN.jsonValues.slice();z8(Yye,"orthometric");const TT=Ol()({meter:"meters",foot:"feet","us-foot":"us-feet","clarke-foot":"clarke-feet","clarke-yard":"clarke-yards","clarke-link":"clarke-links","sears-yard":"sears-yards","sears-foot":"sears-feet","sears-chain":"sears-chains","benoit-1895-b-chain":"benoit-1895-b-chains","indian-yard":"indian-yards","indian-1937-yard":"indian-1937-yards","gold-coast-foot":"gold-coast-feet","sears-1922-truncated-chain":"sears-1922-truncated-chains","50-kilometers":"50-kilometers","150-kilometers":"150-kilometers"});let ol=_S=class extends qt{constructor(t){super(t),this.heightModel="gravity-related-height",this.heightUnit="meters",this.vertCRS=null}writeHeightModel(t,e,n){return dN.write(t,e,n)}readHeightModel(t,e,n){return dN.read(t)||(n?.messages&&n.messages.push(wqe(t,{context:n})),null)}readHeightUnit(t,e,n){return TT.read(t)||(n?.messages&&n.messages.push(bne(t,{context:n})),null)}readHeightUnitService(t,e,n){return $B(t)||TT.read(t)||(n?.messages&&n.messages.push(bne(t,{context:n})),null)}readVertCRS(t,e){return e.vertCRS||e.ellipsoid||e.geoid}clone(){return new _S({heightModel:this.heightModel,heightUnit:this.heightUnit,vertCRS:this.vertCRS})}equals(t){return!!t&&(this===t||this.heightModel===t.heightModel&&this.heightUnit===t.heightUnit&&this.vertCRS===t.vertCRS)}static deriveUnitFromSR(t,e){const n=rme(e);return new _S({heightModel:t.heightModel,heightUnit:n??void 0,vertCRS:t.vertCRS})}write(t,e){return e={origin:"web-scene",...e},super.write(t,e)}static fromJSON(t){if(!t)return null;const e=new _S;return e.read(t,{origin:"web-scene"}),e}};function bne(t,e){return new Ld("height-unit:unsupported",`Height unit of value '${t}' is not supported`,e)}function wqe(t,e){return new Ld("height-model:unsupported",`Height model of value '${t}' is not supported`,e)}x([E({type:dN.apiValues,constructOnly:!0,json:{origins:{"web-scene":{type:Yye,default:"ellipsoidal",write:{isRequired:!0}}}}})],ol.prototype,"heightModel",void 0),x([er("web-scene","heightModel")],ol.prototype,"writeHeightModel",null),x([cr(["web-scene","service"],"heightModel")],ol.prototype,"readHeightModel",null),x([E({type:TT.apiValues,constructOnly:!0,json:{origins:{"web-scene":{type:TT.jsonValues,write:{writer:TT.write,isRequired:!0}}}}})],ol.prototype,"heightUnit",void 0),x([cr("web-scene","heightUnit")],ol.prototype,"readHeightUnit",null),x([cr("service","heightUnit")],ol.prototype,"readHeightUnitService",null),x([E({type:String,constructOnly:!0,json:{origins:{"web-scene":{write:!0}}}})],ol.prototype,"vertCRS",void 0),x([cr("service","vertCRS",["vertCRS","ellipsoid","geoid"])],ol.prototype,"readVertCRS",null),ol=_S=x([ue("esri.geometry.HeightModelInfo")],ol);let Qj;async function bqe(){return Qj==null&&(Qj=_e(()=>import("./WhereClauseCache-C0-QJhgG.js"),__vite__mapDeps([74,24,25,75,76,77,78])).then(t=>new t.WhereClauseCache(500,500))),Qj}async function Eqe(t,e){const n=await bqe(),r=n.get(t,e);if(r==null)throw n.getError(t,e);return r}function IMt(t,e){return t||=null,e||=null,t==="1=1"?e??t:e==="1=1"?t??e:t&&e?`(${t}) AND (${e})`:t??e}function PMt(t,e){return t||=null,e||=null,t==="1=1"||e==="1=1"||t===e?t==="1=1"?t:e:t&&e?`(${t}) OR (${e})`:t??e}function CMt(t,e){return e.length===0?null:`${t} IN (${Sqe(e)})`}function Sqe(t){return t.map(e=>typeof e=="string"?Tqe(e):e).join(",")}function Tqe(t){return`'${t.replaceAll("'","''")}'`}function RMt(t){return typeof t=="number"}function MMt(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t}function NMt(t){return typeof t=="boolean"}function RI(t){return typeof t=="string"||t instanceof String}function kqe(t){return t==null||RI(t)}function OMt(t){return Array.isArray(t)}function LMt(t){return t?.declaredClass==="esri.Graphic"}function DMt(t){return t instanceof Date}const Aqe="HH:mm",Iqe="HH:mm:ss",Pqe="HH:mm:ss.SSS",Cqe=[Pqe,Iqe,Aqe,"TT"],Rqe="yyyy-MM-dd";function Ene(t){if(!t||!RI(t))return null;const e=dn.fromFormat(t,Rqe);return e.isValid?e:null}function Sne(t){return t&&RI(t)?rje(Cqe,e=>{const n=dn.fromFormat(t,e);return n.isValid?n:null})??null:null}function Tne(t){if(!t||!RI(t))return null;const e=dn.fromISO(t);return e.isValid?e:null}const Xye=new Set(["integer","small-integer","long","big-integer","esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeLong","esriFieldTypeBigInteger"]);function Mqe(t){return t!=null&&Xye.has(t.type)}function Zye(t){return t!=null&&(t.type==="date-only"||t.type==="esriFieldTypeDateOnly")}function Jye(t){return t!=null&&(t.type==="timestamp-offset"||t.type==="esriFieldTypeTimestampOffset")}function Qye(t){return t!=null&&(t.type==="time-only"||t.type==="esriFieldTypeTimeOnly")}const Nqe=new Set(["single","double","esriFieldTypeSingle","esriFieldTypeDouble"]);wB(Xye,Nqe);function jMt(t,e){const n=t?.domain;if(!n||n.type!=="range")return;const r="range"in n?n.range[0]:n.minValue,i="range"in n?n.range[1]:n.maxValue,s=Mqe(t);return Zye(t)||Qye(t)||Jye(t)?{...Oqe(t,i,r),isInteger:s}:{min:r!=null&&typeof r=="number"?r:null,max:i!=null&&typeof i=="number"?i:null,rawMin:r,rawMax:i,isInteger:s}}function Oqe(t,e,n){return Zye(t)?{min:Ene(n)?.toMillis(),max:Ene(e)?.toMillis(),rawMin:n,rawMax:e}:Qye(t)?{min:Sne(n)?.toMillis(),max:Sne(e)?.toMillis(),rawMin:n,rawMax:e}:Jye(t)?{min:Tne(n)?.toMillis(),max:Tne(e)?.toMillis(),rawMin:n,rawMax:e}:{max:null,min:null}}function Lqe(t){if(!t)return;const e=t.match(Dqe);return e?.groups?e.groups.doubleQuoted??e.groups.singleQuoted??e.groups.dotNotation:void 0}const Dqe=/^(\$feature\[(?:"(?<doubleQuoted>[^"]+)"|'(?<singleQuoted>[^']+)')\]|\$feature\.(?<dotNotation>[a-z_][a-z0-9_]*))$/i;function $Mt(t){return t.match(jqe)?.[1]?.replaceAll("\\'","'")??null}const jqe=/^hash\(\$feature\['((\\'|[^'])+)'\]\) \* 8\.381e-8$/;let e$;function $qe(){return e$||(e$=(async()=>{const[t,e,n]=await Promise.all([_e(()=>import("./arcadeUtils-B_qLBFNH.js"),__vite__mapDeps([282,283,284,77,285,76,78,286,239,84,287,66,64,26,67,83,288,289,75,134,290,240,241,291])),_e(()=>import("./batchExec-1XUikYCa.js"),__vite__mapDeps([292,146])),_e(()=>import("./aiServices-DWrX5INF.js").then(r=>r.a),__vite__mapDeps([288,78,285,76,77,286,239,84,289,284]))]);return{arcade:t.arcade,arcadeUtils:t,batchExec:e,aiServices:n,Dictionary:t.Dictionary,Feature:t.arcadeFeature,Voxel:t.Voxel,Pixel:t.Pixel}})()),e$}const Fqe=/^([0-9_])/,Vqe=/[^a-z0-9_\u0080-\uffff]+/gi;function FMt(t){return t==null?null:t.trim().replaceAll(Vqe,"_").replace(Fqe,"F$1")||null}const zqe=["field","field2","field3","normalizationField","rotationInfo.field","proportionalSymbolInfo.field","proportionalSymbolInfo.normalizationField","colorInfo.field","colorInfo.normalizationField"],Gqe=["field","normalizationField"];function VMt(t,e){if(t!=null&&e!=null){for(const n of Array.isArray(t)?t:[t])if(kne(zqe,n,e),"visualVariables"in n&&n.visualVariables)for(const r of n.visualVariables)kne(Gqe,r,e)}}function kne(t,e,n){if(t)for(const r of t){const i=wO(r,e),s=i&&typeof i!="function"&&n.get(i);s&&rb(r,s.name,e)}}function zMt(t,e){if(t!=null&&e?.fields?.length)if("startField"in t){const n=e.get(t.startField),r=e.get(t.endField);t.startField=n?.name??null,t.endField=r?.name??null}else{const n=e.get(t.startTimeField),r=e.get(t.endTimeField);t.startTimeField=n?.name??null,t.endTimeField=r?.name??null}}const t$=new Set;function PW(t,e){return t&&e?(t$.clear(),tA(t$,t,e),Array.from(t$).sort()):[]}function tA(t,e,n){if(n)if(e?.fields?.length)if(n.includes("*"))for(const{name:r}of e.fields)t.add(r);else for(const r of n)nA(t,e,r);else{if(n.includes("*"))return t.clear(),void t.add("*");for(const r of n)r!=null&&t.add(r)}}function nA(t,e,n){if(typeof n=="string")if(e){const r=e.get(n);r&&t.add(r.name)}else t.add(n)}function GMt(t,e){return e==null||t==null?[]:e.includes("*")?(t.fields??[]).map(n=>n.name):e}function UMt(t,e,n=1){if(!e||!t)return[];if(e.includes("*"))return["*"];const r=PW(t,e);return r.length/t.fields.length>=n?["*"]:r}async function K1(t,e,n,r){if(!r)return;const i=Lqe(r);if(i)nA(t,e,i);else{const{arcadeUtils:s}=await $qe(),o=s.extractFieldNames(r,n?.partitions??e?.fields?.map(a=>a.name));for(const a of o)nA(t,n?.index??e,a)}}async function CW(t,e,n){if(n&&n!=="1=1"){const r=await Eqe(n,e);if(!r.isStandardized)throw new Xe("fieldUtils:collectFilterFields","Where clause is not standardized",{where:n});tA(t,e,r.fieldNames)}}function BMt({displayField:t,fields:e}){return t||(e?.length?Uqe(e):null)}function Uqe(t){return n$(t,"name-or-title")||n$(t,"unique-identifier")||n$(t,"type-or-category")||Bqe(t)}function Bqe(t){for(const e of t){if(!e?.name)continue;const n=e.name.toLowerCase();if(n.includes("name")||n.includes("title"))return e.name}return null}function n$(t,e){for(const n of t)if(n?.valueType&&n.valueType===e)return n.name;return null}async function WMt(t,e){if(!e)return;const n=e.elevationInfo?.featureExpressionInfo;return n?n.collectRequiredFields(t,e.fieldsIndex):void 0}function Wqe(t,e,n){n.onStatisticExpression?K1(t,e,null,n.onStatisticExpression.expression):t.add(n.onStatisticField)}async function HMt(t,e,n){if(!e||!n||!("fields"in n))return;const r=[],i=n.popupTemplate;r.push(e1e(t,e,i)),n.fields&&r.push(...n.fields.map(async s=>Wqe(t,e.fieldsIndex,s))),await Promise.all(r)}async function qMt(t,e){const{fieldsIndex:n,trackInfo:r}=e;if(!e||!r||!n)return;const i=[r.latestObservations.renderer?.collectRequiredFields(t,n),r.previousObservations.renderer?.collectRequiredFields(t,n),r.trackLines.renderer?.collectRequiredFields(t,n)];r.popupTemplate&&i.push(e1e(t,e,r.popupTemplate));for(const s of[r.latestObservations.labelingInfo,r.previousObservations.labelingInfo,r.trackLines.labelingInfo])if(s)for(const o of s)i.push(r1e(t,n,o));await Promise.all(i)}async function e1e(t,e,n){const r=[];n?.expressionInfos&&r.push(...n.expressionInfos.map(s=>K1(t,e.fieldsIndex,null,s.expression)));const i=n?.content;if(Array.isArray(i))for(const s of i)s.type==="expression"&&s.expressionInfo&&r.push(K1(t,e.fieldsIndex,null,s.expressionInfo.expression));await Promise.all(r)}async function KMt(t,e,n){e&&(e.timeInfo&&n?.timeExtent&&tA(t,e.fieldsIndex,[e.timeInfo.startField,e.timeInfo.endField]),e.floorInfo&&tA(t,e.fieldsIndex,[e.floorInfo.floorField]),n?.where!=null&&await CW(t,e.fieldsIndex,n.where))}async function YMt(t,e,n){e&&n&&await Promise.all(n.map(r=>Hqe(t,e,r)))}async function Hqe(t,e,n){e&&n&&(n.valueExpression?await K1(t,e.fieldsIndex,null,n.valueExpression):n.field&&nA(t,e.fieldsIndex,n.field))}function XMt(t){return t?PW(t.fieldsIndex,t1e(t)):[]}function qqe(t){if(!t)return[];const e=t.geometryFieldsInfo;return e?PW(t.fieldsIndex,[e.shapeAreaField,e.shapeLengthField]):[]}async function ZMt(t,e,n){if(!e||!n)return;const r=e.fieldsIndex;await Promise.all(n.filters.map(i=>CW(t,r,i.where)))}const Kqe=new Set(["oid","global-id","guid"]),Yqe=new Set(["oid","global-id"]),Xqe=[/^fnode_$/i,/^tnode_$/i,/^lpoly_$/i,/^rpoly_$/i,/^poly_$/i,/^shape$/i,/^shape_$/i,/^subclass$/i,/^subclass_$/i,/^rings_ok$/i,/^rings_nok$/i,/objectid/i,/^perimeter_/i,/_perimeter$/i,/_i$/i];function Zqe(t){const e=new Set;n1e(t).forEach(r=>e.add(r)),qqe(t).forEach(r=>e.add(r.toLowerCase()));const n=t&&"infoFor3D"in t?t.infoFor3D:void 0;return n&&(Object.values(n.assetMapFieldRoles).forEach(r=>e.add(r.toLowerCase())),Object.values(n.transformFieldRoles).forEach(r=>e.add(r.toLowerCase()))),Array.from(e)}function t1e(t){if(!t)return[];const e="editFieldsInfo"in t&&t.editFieldsInfo;if(!e)return[];const{creationDateField:n,creatorField:r,editDateField:i,editorField:s}=e;return[n,r,i,s].filter(Boolean)}function n1e(t){return t1e(t).map(e=>e.toLowerCase())}function JMt(t,e){return t.editable&&!Kqe.has(t.type)&&!n1e(e).includes(t.name?.toLowerCase()??"")}function QMt(t,e){const n=t.name?.toLowerCase()??"";return!(e?.objectIdField!=null&&n===e.objectIdField.toLowerCase()||e?.globalIdField!=null&&n===e.globalIdField.toLowerCase()||Zqe(e).includes(n)||Yqe.has(t.type)||Xqe.some(r=>r.test(n)))}async function e3t(t,e){const{labelingInfo:n,fieldsIndex:r}=e;n?.length&&await Promise.all(n.map(i=>r1e(t,r,i)))}async function r1e(t,e,n){if(!n)return;const r=n.getLabelExpression(),i=n.where;if(r.type==="arcade")await K1(t,e,null,r.expression);else{const s=r.expression.match(/{[^}]*}/g);s&&s.forEach(o=>{nA(t,e,o.slice(1,-1))})}await CW(t,e,i)}function t3t(t){const e=t.defaultValue;return e!==void 0&&s1e(t,e)?e:t.nullable?null:void 0}function n3t(t){const e=typeof t=="string"?{type:t}:t;return aKe(e)?255:e.type==="esriFieldTypeDate"||e.type==="date"?8:void 0}function i1e(t){return typeof t=="number"&&!isNaN(t)&&isFinite(t)}function Jqe(t){return t===null||i1e(t)}function Qqe(t){return t===null||Number.isInteger(t)}function eKe(){return!0}function s1e(t,e){let n;switch(t.type){case"date":case"integer":case"long":case"small-integer":case"big-integer":case"esriFieldTypeDate":case"esriFieldTypeInteger":case"esriFieldTypeLong":case"esriFieldTypeSmallInteger":case"esriFieldTypeBigInteger":n=t.nullable?Qqe:Number.isInteger;break;case"double":case"single":case"esriFieldTypeSingle":case"esriFieldTypeDouble":n=t.nullable?Jqe:i1e;break;case"string":case"esriFieldTypeString":n=t.nullable?kqe:RI;break;default:n=eKe}return arguments.length===1?n:n(e)}const tKe=["integer","small-integer","big-integer","long"],nKe=["single","double"],rKe=["esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeLong","esriFieldTypeBigInteger"],iKe=["esriFieldTypeSingle","esriFieldTypeDouble"],o1e=new Set([...tKe,...rKe]),sKe=new Set([...nKe,...iKe]),oKe=wB(o1e,sKe);function r3t(t){return t!=null&&o1e.has(t.type)}function a1e(t){return t!=null&&oKe.has(t.type)}function aKe(t){return t!=null&&(t.type==="string"||t.type==="esriFieldTypeString")}function lKe(t){return t!=null&&(t.type==="date"||t.type==="esriFieldTypeDate")}function cKe(t){return t!=null&&(t.type==="date-only"||t.type==="esriFieldTypeDateOnly")}function uKe(t){return t!=null&&(t.type==="timestamp-offset"||t.type==="esriFieldTypeTimestampOffset")}function hKe(t){return t!=null&&(t.type==="time-only"||t.type==="esriFieldTypeTimeOnly")}function i3t(t){return t!=null&&(t.type==="oid"||t.type==="esriFieldTypeOID")}function s3t(t){return t!=null&&(t.type==="global-id"||t.type==="esriFieldTypeGlobalID")}function o3t(t,e){return dKe(t,e)===null}function a3t(t){return t==null||typeof t=="number"&&isNaN(t)?null:t}function dKe(t,e){return t==null||t.nullable&&e===null?null:s1e(t,e)?a1e(t)&&!fKe(t.type,Number(e))?"numeric-range-validation-error::out-of-range":null:"type-validation-error::invalid-type"}function fKe(t,e){const n=typeof t=="string"?l1e(t):t;if(!n)return!1;const r=n.min,i=n.max;return n.isInteger?Number.isInteger(e)&&e>=r&&e<=i:e>=r&&e<=i}function l1e(t){switch(t){case"esriFieldTypeSmallInteger":case"small-integer":return pKe;case"esriFieldTypeInteger":case"esriFieldTypeLong":case"integer":case"long":return mKe;case"esriFieldTypeBigInteger":case"big-integer":return gKe;case"esriFieldTypeSingle":case"single":return yKe;case"esriFieldTypeDouble":case"double":return vKe}}const pKe={min:-32768,max:32767,isInteger:!0,rawMin:-32768,rawMax:32767},mKe={min:-2147483648,max:2147483647,isInteger:!0,rawMin:-2147483648,rawMax:2147483647},gKe={min:-Number.MAX_SAFE_INTEGER,max:Number.MAX_SAFE_INTEGER,isInteger:!0,rawMin:-Number.MAX_SAFE_INTEGER,rawMax:Number.MAX_SAFE_INTEGER},sR=(2-2**-23)*2**127,yKe={min:-sR,max:sR,isInteger:!1,rawMin:-sR,rawMax:sR},vKe={min:-Number.MAX_VALUE,max:Number.MAX_VALUE,isInteger:!1,rawMin:-Number.MAX_VALUE,rawMax:Number.MAX_VALUE};function l3t(t,e,n){switch(t){case"domain-validation-error::invalid-coded-value":return`Value ${n} is not in the coded domain - field: ${e.name}, domain: ${JSON.stringify(e.domain)}`;case"domain-validation-error::value-out-of-range":return`Value ${n} is out of the range of valid values - field: ${e.name}, domain: ${JSON.stringify(e.domain)}`;case"type-validation-error::invalid-type":return`Value ${n} is not a valid value for the field type - field: ${e.name}, type: ${e.type}, nullable: ${e.nullable}`;case"numeric-range-validation-error::out-of-range":{const{min:r,max:i}=l1e(e.type);return`Value ${n} is out of range for the number type - field: ${e.name}, type: ${e.type}, value range is ${r} to ${i}`}}}function c3t(t,e){return!_Ke(t,e,null)}function _Ke(t,e,n){if(!t?.attributes||!e)return!0;const r=new Set(Object.keys(t.attributes));let i=!1;for(const s of e)if(!r.has(s)&&(i=!0,n==null))break;return i}function u3t(t){return!!t&&["raster.itempixelvalue","raster.servicepixelvalue"].some(e=>t.toLowerCase().startsWith(e))}function xKe(t){const e=t?.match(/{[^}]+}/g);return e?e.map(n=>n.slice(1,-1).split(":")[0].trim()):[]}let GM=class extends qt{constructor(e){super(e),this.type=null}};x([E({type:["attachments","custom","fields","media","text","expression","relationship","utility-network-associations"],readOnly:!0,json:{read:!1,write:!0}})],GM.prototype,"type",void 0),GM=x([ue("esri.popup.content.Content")],GM);const Ap=GM,oR=new Ys({asc:"ascending",desc:"descending"});let xS=class extends vo(qt){constructor(e){super(e),this.field=null,this.order="ascending"}};x([E({type:String,json:{write:!0}})],xS.prototype,"field",void 0),x([E({type:oR.apiValues,json:{type:oR.jsonValues,read:oR.read,write:oR.write}})],xS.prototype,"order",void 0),xS=x([ue("esri.popup.support.AttachmentsOrderByInfo")],xS);const wKe=xS;let Xh=class extends vo(Ap){constructor(e){super(e),this.attachmentKeywords=null,this.attachmentTypes=null,this.description=null,this.displayType="auto",this.orderByFields=null,this.title=null,this.type="attachments"}};x([E({type:[String],json:{write:!0}})],Xh.prototype,"attachmentKeywords",void 0),x([E({type:[["application","audio","image","model","text","video"]],json:{write:!0}})],Xh.prototype,"attachmentTypes",void 0),x([E({type:String,json:{write:!0}})],Xh.prototype,"description",void 0),x([E({type:["auto","preview","list"],json:{write:!0}})],Xh.prototype,"displayType",void 0),x([E({type:[wKe],json:{write:!0}})],Xh.prototype,"orderByFields",void 0),x([E({type:String,json:{write:!0}})],Xh.prototype,"title",void 0),x([E({type:["attachments"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],Xh.prototype,"type",void 0),Xh=x([ue("esri.popup.content.AttachmentsContent")],Xh);const rA=Xh;var d7;let ny=d7=class extends Ap{constructor(t){super(t),this.creator=null,this.destroyer=null,this.outFields=null,this.type="custom"}clone(){return new d7({creator:this.creator,destroyer:this.destroyer,outFields:Array.isArray(this.outFields)?Ze(this.outFields):null})}};x([E()],ny.prototype,"creator",void 0),x([E()],ny.prototype,"destroyer",void 0),x([E()],ny.prototype,"outFields",void 0),x([E({type:["custom"],readOnly:!0})],ny.prototype,"type",void 0),ny=d7=x([ue("esri.popup.content.CustomContent")],ny);const bKe=ny;var f7;let Q_=f7=class extends qt{constructor(t){super(t),this.title=null,this.expression=null,this.returnType="dictionary"}clone(){return new f7({title:this.title,expression:this.expression})}};x([E({type:String,json:{write:!0}})],Q_.prototype,"title",void 0),x([E({type:String,json:{write:!0}})],Q_.prototype,"expression",void 0),x([E({type:["dictionary"],readOnly:!0,json:{read:!1,write:!0}})],Q_.prototype,"returnType",void 0),Q_=f7=x([ue("esri.popup.ElementExpressionInfo")],Q_);const EKe=Q_;var p7;let wS=p7=class extends Ap{constructor(t){super(t),this.expressionInfo=null,this.type="expression"}clone(){return new p7({expressionInfo:this.expressionInfo?.clone()})}};x([E({type:EKe,json:{write:!0}})],wS.prototype,"expressionInfo",void 0),x([E({type:["expression"],readOnly:!0,json:{read:!1,write:!0}})],wS.prototype,"type",void 0),wS=p7=x([ue("esri.popup.content.ExpressionContent")],wS);const eL=wS;let UM=class extends vo(qt){constructor(e){super(e),this.type=null}};x([E({type:["date-time","number"],nonNullable:!0,readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],UM.prototype,"type",void 0),UM=x([ue("esri.layers.support.FieldFormat")],UM);const RW=UM,c1e="auto";let bf=class extends RW{constructor(e){super(e),this.dateStyle=null,this.hour12=c1e,this.month=null,this.timeStyle=null,this.type="date-time",this.year=null}};x([E({type:["full","long","medium","short"],json:{write:!0}})],bf.prototype,"dateStyle",void 0),x([E({type:["always","auto","never"],nonNullable:!0,json:{default:c1e,write:!0}})],bf.prototype,"hour12",void 0),x([E({type:["long","short"],json:{write:!0}})],bf.prototype,"month",void 0),x([E({type:["full","long","medium","short"],json:{write:!0}})],bf.prototype,"timeStyle",void 0),x([E({type:["date-time"]})],bf.prototype,"type",void 0),x([E({type:["numeric"],json:{write:!0}})],bf.prototype,"year",void 0),bf=x([ue("esri.layers.support.DateTimeFieldFormat")],bf);const l1=bf,Ane={min:0,max:20},u1e=2,h1e=0,d1e="decimal",f1e="auto";let Em=class extends RW{constructor(e){super(e),this.maximumFractionDigits=u1e,this.minimumFractionDigits=h1e,this.style=d1e,this.type="number",this.useGrouping=f1e}};x([E({type:Dr,nonNullable:!0,range:Ane,json:{default:u1e,write:!0}})],Em.prototype,"maximumFractionDigits",void 0),x([E({type:Dr,nonNullable:!0,range:Ane,json:{default:h1e,write:!0}})],Em.prototype,"minimumFractionDigits",void 0),x([E({type:["decimal"],nonNullable:!0,json:{default:d1e,write:!0}})],Em.prototype,"style",void 0),x([E({type:["number"]})],Em.prototype,"type",void 0),x([E({type:["always","auto","never"],nonNullable:!0,json:{default:f1e,write:!0}})],Em.prototype,"useGrouping",void 0),Em=x([ue("esri.layers.support.NumberFieldFormat")],Em);const fN=Em;let ex=class extends vo(qt){constructor(e){super(e),this.dateFormat=null,this.digitSeparator=!1,this.places=null}};x([mn(TVe)],ex.prototype,"dateFormat",void 0),x([E({type:Boolean,json:{write:!0}})],ex.prototype,"digitSeparator",void 0),x([E({type:Dr,json:{write:!0}})],ex.prototype,"places",void 0),ex=x([ue("esri.popup.support.FieldInfoFormat")],ex);const vb=ex,SKe={base:RW,key:"type",errorContext:"field-configuration-field-format",typeMap:{"date-time":l1,number:fN}};function v3t(t,e){const{format:n}=t;return e&&tL(e)?n?p1e(n,e):BM(e,{hour12:"always",useGrouping:"always"}):null}function p1e(t,e){const{dateFormat:n}=t;if(!e)return n?Pne(t):Ine(t);if(!tL(e))return;const r={hour12:"always"};switch(e.type){case"integer":case"small-integer":case"big-integer":case"long":return m1e(t);case"single":case"double":return Ine(t);case"date":case"timestamp-offset":return n?Pne(t):BM(e,r);case"date-only":return n?TKe(t):BM(e);case"time-only":return n?kKe(t):BM(e,r)}}function tL(t){return a1e(t)||lKe(t)||cKe(t)||hKe(t)||uKe(t)}function m1e(t){return new fN({useGrouping:t.digitSeparator?"always":"never"})}function Ine(t){const e=m1e(t),{places:n}=t;return e.minimumFractionDigits=n??0,e.maximumFractionDigits=n??2,e}function Pne(t){return new l1({dateStyle:g1e(t),year:x1e(t),month:v1e(t),timeStyle:_1e(t),hour12:y1e(t)})}function TKe(t){return new l1({dateStyle:g1e(t),year:x1e(t),month:v1e(t)})}function kKe(t){return new l1({timeStyle:_1e(t),hour12:y1e(t)})}function g1e(t){const{dateFormat:e}=t;return e?e.startsWith("short-date")?"short":e.startsWith("day-short-month-year")?"medium":e.startsWith("long-month-day-year")?"long":e.startsWith("long-date")?"full":null:null}function y1e(t){return t.dateFormat?.endsWith("-24")?"never":"always"}function v1e(t){switch(t.dateFormat){case"short-month-year":return"short";case"long-month-year":return"long";default:return null}}function _1e(t){const{dateFormat:e}=t;return e?e.includes("short-time")?"short":e.includes("long-time")?"medium":null:null}function x1e(t){switch(t.dateFormat){case"short-month-year":case"long-month-year":case"year":return"numeric";default:return null}}function AKe(t,e){const n=t.type==="number",r=t.type==="date-time";if(!e)return n?Cne(t):r?Rne(t):null;if(tL(e))switch(e.type){case"integer":case"small-integer":case"big-integer":case"long":return n?w1e(t):null;case"single":case"double":return n?Cne(t):null;case"date":case"timestamp-offset":return r?Rne(t):null;case"date-only":return r?IKe(t):null;case"time-only":return r?PKe(t):null}}function w1e(t){return new vb({digitSeparator:t.useGrouping!=="never"})}function Cne(t){const e=w1e(t);return e.places=t.maximumFractionDigits,e}function Rne(t){let e;const n=b1e(t),r=E1e(t),i=t.hour12==="never"?"24":null,s=t.year==="numeric"?"year":null,o=S1e(t);return n&&r&&i?e=`${n}-${r}-${i}`:n&&r?e=`${n}-${r}`:n?e=n:s&&o?e=`${o}-${s}`:s&&(e=s),e?new vb({dateFormat:e}):null}function IKe(t){let e;const n=b1e(t),r=t.year==="numeric"?"year":null,i=S1e(t);return n?e=n:r&&i?e=`${i}-${r}`:r&&(e=r),e?new vb({dateFormat:e}):null}function PKe(t){let e;const n=E1e(t),r=t.hour12==="never"?"24":null;return n&&r?e=`short-date-${n}-${r}`:n&&(e=`short-date-${n}`),e?new vb({dateFormat:e}):null}function b1e(t){switch(t.dateStyle){case"short":return"short-date";case"medium":return"day-short-month-year";case"long":return"long-month-day-year";case"full":return"long-date";default:return}}function E1e(t){return t.timeStyle&&(t.timeStyle==="short"?"short-time":"long-time")}function S1e(t){switch(t.month){case"short":return"short-month";case"long":return"long-month";default:return}}function BM(t,e){if(!tL(t))return;const n=e?.useGrouping??"auto",r=e?.hour12??"auto";switch(t.type){case"integer":case"small-integer":case"big-integer":case"long":return new fN({minimumFractionDigits:0,maximumFractionDigits:0,useGrouping:n});case"single":case"double":return new fN({minimumFractionDigits:0,maximumFractionDigits:2,useGrouping:n});case"date":case"timestamp-offset":return new l1({dateStyle:"short",timeStyle:"short",hour12:r});case"date-only":return new l1({dateStyle:"short"});case"time-only":return new l1({timeStyle:"short",hour12:r})}}let ql=class extends vo(qt){constructor(e){super(e),this.fieldName=null,this.isEditable=!0,this.label=null,this.statisticType=null,this.stringFieldOption="text-box",this.tooltip=null,this.visible=!0}set fieldFormat(e){this._set("fieldFormat",e),this._set("format",e?AKe(e):null)}set format(e){this._set("format",e),this._set("fieldFormat",e?p1e(e):null)}readFormat(e,n){if(!n.fieldFormat)return e?vb.fromJSON(e):null}clone(){const e=super.clone();return e._set("format",this.format?.clone()),e._set("fieldFormat",this.fieldFormat?.clone()),e}};x([E({value:null,clonable:!1,types:SKe,json:{write:{overridePolicy(t,e,n){const{fieldName:r}=this;return{enabled:!!r&&!r.startsWith("expression/")&&!r.startsWith("relationships/")&&!!n?.writeFieldFormat}}}}})],ql.prototype,"fieldFormat",null),x([E({type:String,json:{write:!0}})],ql.prototype,"fieldName",void 0),x([E({value:null,clonable:!1,type:vb,json:{write:!0}})],ql.prototype,"format",null),x([cr("format")],ql.prototype,"readFormat",null),x([E({type:Boolean,json:{write:{alwaysWriteDefaults:!0},default:!0}})],ql.prototype,"isEditable",void 0),x([E({type:String,json:{write:!0}})],ql.prototype,"label",void 0),x([E({type:["count","sum","min","max","avg","stddev","var"],json:{write:!0}})],ql.prototype,"statisticType",void 0),x([mn(new Ys({richtext:"rich-text",textarea:"text-area",textbox:"text-box"}),{default:"text-box"})],ql.prototype,"stringFieldOption",void 0),x([E({type:String,json:{write:!0}})],ql.prototype,"tooltip",void 0),x([E({type:Boolean,json:{write:!0}})],ql.prototype,"visible",void 0),ql=x([ue("esri.popup.FieldInfo")],ql);const T1e=ql;var m7;let Sm=m7=class extends Ap{constructor(t){super(t),this.attributes=null,this.description=null,this.fieldInfos=null,this.title=null,this.type="fields"}clone(){return new m7(Ze({attributes:this.attributes,description:this.description,fieldInfos:this.fieldInfos,title:this.title}))}};x([E({type:Object,json:{write:!0}})],Sm.prototype,"attributes",void 0),x([E({type:String,json:{write:!0}})],Sm.prototype,"description",void 0),x([E({type:[T1e],json:{write:!0}})],Sm.prototype,"fieldInfos",void 0),x([E({type:String,json:{write:!0}})],Sm.prototype,"title",void 0),x([E({type:["fields"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],Sm.prototype,"type",void 0),Sm=m7=x([ue("esri.popup.content.FieldsContent")],Sm);const iA=Sm;let ry=class extends qt{constructor(e){super(e),this.altText=null,this.caption="",this.title="",this.type=null}};x([E({type:String,json:{write:!0}})],ry.prototype,"altText",void 0),x([E({type:String,json:{write:!0}})],ry.prototype,"caption",void 0),x([E({type:String,json:{write:!0}})],ry.prototype,"title",void 0),x([E({type:["image","bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],ry.prototype,"type",void 0),ry=x([ue("esri.popup.content.mixins.MediaInfo")],ry);const MW=ry;var g7;let iy=g7=class extends Kt{constructor(t){super(t),this.color=null,this.fieldName=null,this.tooltip=null,this.value=null}clone(){return new g7({color:this.color?.clone(),fieldName:this.fieldName,tooltip:this.tooltip,value:this.value})}};x([E()],iy.prototype,"color",void 0),x([E()],iy.prototype,"fieldName",void 0),x([E()],iy.prototype,"tooltip",void 0),x([E()],iy.prototype,"value",void 0),iy=g7=x([ue("esri.popup.content.support.ChartMediaInfoValueSeries")],iy);const CKe=iy;var y7;let Tm=y7=class extends qt{constructor(t){super(t),this.colors=null,this.fields=[],this.normalizeField=null,this.series=[],this.tooltipField=null}clone(){return new y7({colors:Ze(this.colors),fields:Ze(this.fields),normalizeField:this.normalizeField,series:Ze(this.series),tooltipField:this.tooltipField})}};x([E({type:[Jn],json:{type:[[Dr]],write:!0}})],Tm.prototype,"colors",void 0),x([E({type:[String],json:{write:{isRequired:!0}}})],Tm.prototype,"fields",void 0),x([E({type:String,json:{write:!0}})],Tm.prototype,"normalizeField",void 0),x([E({type:[CKe],json:{read:!1}})],Tm.prototype,"series",void 0),x([E({type:String,json:{write:!0}})],Tm.prototype,"tooltipField",void 0),Tm=y7=x([ue("esri.popup.content.support.ChartMediaInfoValue")],Tm);const RKe=Tm;let bS=class extends MW{constructor(e){super(e),this.type=null,this.value=void 0}};x([E({type:["bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],bS.prototype,"type",void 0),x([E({type:RKe,json:{write:{isRequired:!0}}})],bS.prototype,"value",void 0),bS=x([ue("esri.popup.content.mixins.ChartMediaInfo")],bS);const nL=bS,rL=Ol()({barchart:"bar-chart",columnchart:"column-chart",linechart:"line-chart",piechart:"pie-chart"});var v7;let WM=v7=class extends nL{constructor(t){super(t),this.type="bar-chart"}clone(){return new v7({altText:this.altText,title:this.title,caption:this.caption,value:this.value?.clone()})}};x([E({type:["bar-chart"],readOnly:!0,json:{type:["barchart"],read:!1,write:{writer:rL.write,isRequired:!0}}})],WM.prototype,"type",void 0),WM=v7=x([ue("esri.popup.content.BarChartMediaInfo")],WM);const k1e=WM;var _7;let HM=_7=class extends nL{constructor(t){super(t),this.type="column-chart"}clone(){return new _7({altText:this.altText,title:this.title,caption:this.caption,value:this.value?.clone()})}};x([E({type:["column-chart"],readOnly:!0,json:{type:["columnchart"],read:!1,write:{writer:rL.write,isRequired:!0}}})],HM.prototype,"type",void 0),HM=_7=x([ue("esri.popup.content.ColumnChartMediaInfo")],HM);const A1e=HM;var x7;let ES=x7=class extends qt{constructor(t){super(t),this.linkURL=null,this.sourceURL=null}clone(){return new x7({linkURL:this.linkURL,sourceURL:this.sourceURL})}};x([E({type:String,json:{write:!0}})],ES.prototype,"linkURL",void 0),x([E({type:String,json:{write:{isRequired:!0}}})],ES.prototype,"sourceURL",void 0),ES=x7=x([ue("esri.popup.content.support.ImageMediaInfoValue")],ES);const MKe=ES;var w7;let tx=w7=class extends MW{constructor(t){super(t),this.refreshInterval=0,this.type="image",this.value=void 0}clone(){return new w7({altText:this.altText,title:this.title,caption:this.caption,refreshInterval:this.refreshInterval,value:this.value?.clone()})}};x([E({type:Number,json:{write:!0}})],tx.prototype,"refreshInterval",void 0),x([E({type:["image"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],tx.prototype,"type",void 0),x([E({type:MKe,json:{write:{isRequired:!0}}})],tx.prototype,"value",void 0),tx=w7=x([ue("esri.popup.content.ImageMediaInfo")],tx);const I1e=tx;var b7;let qM=b7=class extends nL{constructor(t){super(t),this.type="line-chart"}clone(){return new b7({altText:this.altText,title:this.title,caption:this.caption,value:this.value?.clone()})}};x([E({type:["line-chart"],readOnly:!0,json:{type:["linechart"],read:!1,write:{writer:rL.write,isRequired:!0}}})],qM.prototype,"type",void 0),qM=b7=x([ue("esri.popup.content.LineChartMediaInfo")],qM);const P1e=qM;var E7;let KM=E7=class extends nL{constructor(t){super(t),this.type="pie-chart"}clone(){return new E7({altText:this.altText,title:this.title,caption:this.caption,value:this.value?.clone()})}};x([E({type:["pie-chart"],readOnly:!0,json:{type:["piechart"],read:!1,write:{writer:rL.write,isRequired:!0}}})],KM.prototype,"type",void 0),KM=E7=x([ue("esri.popup.content.PieChartMediaInfo")],KM);const C1e=KM,S7={base:MW,key:"type",defaultKeyValue:"image",typeMap:{"bar-chart":k1e,"column-chart":A1e,"line-chart":P1e,"pie-chart":C1e,image:I1e}};var T7;let Wu=T7=class extends Ap{constructor(t){super(t),this.activeMediaInfoIndex=null,this.attributes=null,this.description=null,this.mediaInfos=null,this.title=null,this.type="media"}readMediaInfos(t){return t&&t.map(e=>e.type==="image"?I1e.fromJSON(e):e.type==="barchart"?k1e.fromJSON(e):e.type==="columnchart"?A1e.fromJSON(e):e.type==="linechart"?P1e.fromJSON(e):e.type==="piechart"?C1e.fromJSON(e):void 0).filter(Boolean)}writeMediaInfos(t,e){e.mediaInfos=t&&t.map(n=>n.toJSON())}clone(){return new T7(Ze({activeMediaInfoIndex:this.activeMediaInfoIndex,attributes:this.attributes,description:this.description,mediaInfos:this.mediaInfos,title:this.title}))}};x([E()],Wu.prototype,"activeMediaInfoIndex",void 0),x([E({type:Object,json:{write:!0}})],Wu.prototype,"attributes",void 0),x([E({type:String,json:{write:!0}})],Wu.prototype,"description",void 0),x([E({types:[S7]})],Wu.prototype,"mediaInfos",void 0),x([cr("mediaInfos")],Wu.prototype,"readMediaInfos",null),x([er("mediaInfos")],Wu.prototype,"writeMediaInfos",null),x([E({type:String,json:{write:!0}})],Wu.prototype,"title",void 0),x([E({type:["media"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],Wu.prototype,"type",void 0),Wu=T7=x([ue("esri.popup.content.MediaContent")],Wu);const sA=Wu;var k7;let SS=k7=class extends qt{constructor(t){super(t),this.field=null,this.order=null}clone(){return new k7({field:this.field,order:this.order})}};x([E({type:String,json:{write:!0}})],SS.prototype,"field",void 0),x([E({type:["asc","desc"],json:{write:!0}})],SS.prototype,"order",void 0),SS=k7=x([ue("esri.popup.support.RelatedRecordsInfoFieldOrder")],SS);const R1e=SS;let Zh=class extends vo(Ap){constructor(e){super(e),this.description=null,this.displayCount=null,this.displayType="list",this.orderByFields=null,this.relationshipId=null,this.title=null,this.type="relationship"}};x([E({type:String,json:{write:!0}})],Zh.prototype,"description",void 0),x([E({type:Number,json:{type:Dr,write:!0}})],Zh.prototype,"displayCount",void 0),x([E({type:["list"],json:{write:{isRequired:!0}}})],Zh.prototype,"displayType",void 0),x([E({type:[R1e],json:{write:!0}})],Zh.prototype,"orderByFields",void 0),x([E({type:Number,json:{type:Dr,write:{isRequired:!0}}})],Zh.prototype,"relationshipId",void 0),x([E({type:String,json:{write:!0}})],Zh.prototype,"title",void 0),x([E({type:["relationship"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],Zh.prototype,"type",void 0),Zh=x([ue("esri.popup.content.RelationshipContent")],Zh);const oA=Zh;var A7;let TS=A7=class extends Ap{constructor(t){super(t),this.text=null,this.type="text"}clone(){return new A7({text:this.text})}};x([E({type:String,json:{write:!0}})],TS.prototype,"text",void 0),x([E({type:["text"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],TS.prototype,"type",void 0),TS=A7=x([ue("esri.popup.content.TextContent")],TS);const aA=TS;let Ef=class extends vo(qt){constructor(e){super(e),this.title=null,this.description=null,this.type=null,this.associatedNetworkSourceId=null,this.associatedAssetGroup=null,this.associatedAssetType=null}};x([E({type:String,json:{write:!0}})],Ef.prototype,"title",void 0),x([E({type:String,json:{write:!0}})],Ef.prototype,"description",void 0),x([E({type:["attachment","connectivity","container","content","structure"],json:{write:!0}})],Ef.prototype,"type",void 0),x([E({type:Number,json:{type:Dr,write:!0}})],Ef.prototype,"associatedNetworkSourceId",void 0),x([E({type:Number,json:{type:Dr,write:!0}})],Ef.prototype,"associatedAssetGroup",void 0),x([E({type:Number,json:{type:Dr,write:!0}})],Ef.prototype,"associatedAssetType",void 0),Ef=x([ue("esri.popup.support.UtilityNetworkAssociationType")],Ef);const NKe=Ef;let km=class extends vo(Ap){constructor(e){super(e),this.description=null,this.displayCount=null,this.title=null,this.associationTypes=[],this.type="utility-network-associations"}};x([E({type:String,json:{write:!0}})],km.prototype,"description",void 0),x([E({type:Number,json:{type:Dr,write:!0}})],km.prototype,"displayCount",void 0),x([E({type:String,json:{write:!0}})],km.prototype,"title",void 0),x([E({type:[NKe],json:{write:!0}})],km.prototype,"associationTypes",void 0),x([mn({utilityNetworkAssociations:"utility-network-associations"})],km.prototype,"type",void 0),km=x([ue("esri.popup.content.UtilityNetworkAssociationsContent")],km);const NW=km,OKe={base:null,key:"type",typeMap:{attachment:rA,media:sA,text:aA,expression:eL,field:iA,relationship:oA,utilityNetworkAssociations:NW}},LKe={base:null,key:"type",typeMap:{attachment:rA,media:sA,text:aA,expression:eL,field:iA,relationship:oA}};var I7;let sy=I7=class extends qt{constructor(t){super(t),this.name=null,this.title=null,this.expression=null,this.returnType=null}clone(){return new I7({name:this.name,title:this.title,expression:this.expression,returnType:this.returnType})}};x([E({type:String,json:{write:!0}})],sy.prototype,"name",void 0),x([E({type:String,json:{write:!0}})],sy.prototype,"title",void 0),x([E({type:String,json:{write:!0}})],sy.prototype,"expression",void 0),x([E({type:["string","number"],json:{write:!0}})],sy.prototype,"returnType",void 0),sy=I7=x([ue("esri.popup.ExpressionInfo")],sy);const DKe=sy;var P7;let kS=P7=class extends qt{constructor(t){super(t),this.returnTopmostRaster=null,this.showNoDataRecords=null}clone(){return new P7({showNoDataRecords:this.showNoDataRecords,returnTopmostRaster:this.returnTopmostRaster})}};x([E({type:Boolean,json:{write:!0}})],kS.prototype,"returnTopmostRaster",void 0),x([E({type:Boolean,json:{write:!0}})],kS.prototype,"showNoDataRecords",void 0),kS=P7=x([ue("esri.popup.LayerOptions")],kS);const jKe=kS;var C7;let AS=C7=class extends qt{constructor(t){super(t),this.showRelatedRecords=null,this.orderByFields=null}clone(){return new C7({showRelatedRecords:this.showRelatedRecords,orderByFields:this.orderByFields?Ze(this.orderByFields):null})}};x([E({type:Boolean,json:{write:!0}})],AS.prototype,"showRelatedRecords",void 0),x([E({type:[R1e],json:{write:!0}})],AS.prototype,"orderByFields",void 0),AS=C7=x([ue("esri.popup.RelatedRecordsInfo")],AS);const Mne=AS;var R7;let zc=R7=class extends nW(Kt){constructor(t){super(t),this.active=!1,this.className=null,this.disabled=!1,this.icon=null,this.id=null,this.indicator=!1,this.title=null,this.type=null,this.visible=!0}clone(){return new R7({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible})}};x([E()],zc.prototype,"active",void 0),x([E()],zc.prototype,"className",void 0),x([E()],zc.prototype,"disabled",void 0),x([E()],zc.prototype,"icon",void 0),x([E()],zc.prototype,"id",void 0),x([E()],zc.prototype,"indicator",void 0),x([E()],zc.prototype,"title",void 0),x([E()],zc.prototype,"type",void 0),x([E()],zc.prototype,"visible",void 0),zc=R7=x([ue("esri.support.actions.ActionBase")],zc);const OW=zc;var M7;let YM=M7=class extends OW{constructor(t){super(t),this.image=null,this.type="button"}clone(){return new M7({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image})}};x([E()],YM.prototype,"image",void 0),YM=M7=x([ue("esri.support.actions.ActionButton")],YM);const $Ke=YM;var N7;let IS=N7=class extends OW{constructor(t){super(t),this.image=null,this.type="toggle",this.value=!1}clone(){return new N7({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image,value:this.value})}};x([E()],IS.prototype,"image",void 0),x([E()],IS.prototype,"value",void 0),IS=N7=x([ue("esri.support.actions.ActionToggle")],IS);const FKe=IS,zE="relationships/",Nne="expression/",VKe=Ot.ofType({key:"type",defaultKeyValue:"button",base:OW,typeMap:{button:$Ke,toggle:FKe}}),zKe={base:Ap,key:"type",typeMap:{media:sA,custom:bKe,text:aA,attachments:rA,fields:iA,expression:eL,relationship:oA,utilityNetworkAssociations:NW}},M1e=new Set(["attachments","fields","media","text","expression","relationship"]),GKe=new Set([...M1e,"utility-network-associations"]);let _s=class extends vo(qt){constructor(e){super(e),this.actions=null,this.content="",this.expressionInfos=null,this.fieldInfos=null,this.layerOptions=null,this.lastEditInfoEnabled=!0,this.outFields=null,this.overwriteActions=!1,this.returnGeometry=!1,this.title=""}castContent(e){return Array.isArray(e)?e.map(n=>Fg(zKe,n)):typeof e=="string"||typeof e=="function"||e instanceof HTMLElement||ga(e)?e:(kt.getLogger(this).error("content error","unsupported content value",{value:e}),null)}readContent(e,n){const{popupElements:r}=n;return Array.isArray(r)&&r.length>0?this._readPopupInfoElements(n.description,n.mediaInfos,r):this._readPopupInfo(n)}writeWebSceneContent(e,n,r,i){this._writePopupTemplateContent(e,n,i)}writeWebMapContent(e,n,r,i){this._writePopupTemplateContent(e,n,i)}writeFieldInfos(e,n,r,i){const{content:s}=this,o=Array.isArray(s)?s:null,{writeFieldFormat:a,...l}=i||{};if(e){const c=o?o.filter(h=>h.type==="fields"):[],u=c.length&&c.every(h=>h.fieldInfos?.length);n.fieldInfos=e.filter(Boolean).map(h=>{const f=h.toJSON(l);return u&&(f.visible=!1),f})}if(o)for(const c of o)c.type==="fields"&&this._writeFieldsContent(c,n,l)}writeLayerOptions(e,n,r,i){n[r]=!e||e.showNoDataRecords===null&&e.returnTopmostRaster===null?null:e.toJSON(i)}writeTitle(e,n){n.title=e||""}async collectRequiredFields(e,n,r){const i=this.expressionInfos||[];await this._collectExpressionInfoFields(e,n,r,[...i,...this._getContentExpressionInfos(this.content,i)]),tA(e,n,[...this.outFields||[],...this._getActionsFields(this.actions),...this._getTitleFields(this.title),...this._getContentFields(this.content)])}async getRequiredFields(e,n){const r=new Set;return await this.collectRequiredFields(r,e,n),[...r].sort()}_writePopupTemplateContent(e,n,r){typeof e!="string"?Array.isArray(e)&&(n.popupElements=e.filter(i=>r?.origin==="web-scene"?M1e.has(i.type):GKe.has(i.type)).map(i=>i?.toJSON(r)),n.popupElements.forEach(i=>{i.type==="attachments"?this._writeAttachmentContent(n):i.type==="media"?this._writeMediaContent(i,n):i.type==="text"?this._writeTextContent(i,n):i.type==="relationship"&&this._writeRelationshipContent(i,n)})):n.description=e}_writeFieldsContent(e,n,r){const i=e.fieldInfos;if(!Array.isArray(i)||!i.length)return;const s=n.fieldInfos;if(Array.isArray(s))for(const o of i){const a=s.find(l=>l.fieldName?.toLowerCase()===o.fieldName?.toLowerCase());a?a.visible=!0:s.push(o.toJSON(r))}else n.fieldInfos=i.map(o=>o.toJSON(r))}_writeAttachmentContent(e){e.showAttachments||(e.showAttachments=!0)}_writeRelationshipContent(e,n){const r=e.orderByFields?.map(s=>this._toFieldOrderJSON(s,e.relationshipId))||[],i=[...n.relatedRecordsInfo?.orderByFields||[],...r];n.relatedRecordsInfo={showRelatedRecords:!0,...i?.length&&{orderByFields:i}}}_writeTextContent(e,n){!n.description&&e.text&&(n.description=e.text)}_writeMediaContent(e,n){if(!Array.isArray(e.mediaInfos)||!e.mediaInfos.length)return;const r=Ze(e.mediaInfos);Array.isArray(n.mediaInfos)?n.mediaInfos=[...n.mediaInfos,...r]:n.mediaInfos=r}_readPopupInfoElements(e,n,r){const i={description:!1,mediaInfos:!1};return r.map(s=>s.type==="media"?(s.mediaInfos||!n||i.mediaInfos||(s.mediaInfos=n,i.mediaInfos=!0),sA.fromJSON(s)):s.type==="text"?(s.text||!e||i.description||(s.text=e,i.description=!0),aA.fromJSON(s)):s.type==="attachments"?rA.fromJSON(s):s.type==="fields"?iA.fromJSON(s):s.type==="expression"?eL.fromJSON(s):s.type==="relationship"?oA.fromJSON(s):s.type==="utilityNetworkAssociations"?NW.fromJSON(s):void 0).filter(Boolean)}_toRelationshipContent(e){const{field:n,order:r}=e;if(!n?.startsWith(zE))return null;const i=n.replace(zE,"").split("/");if(i.length!==2)return null;const s=parseInt(i[0],10),o=i[1];return!Number.isNaN(s)&&o?oA.fromJSON({relationshipId:s,orderByFields:[{field:o,order:r}]}):null}_toFieldOrderJSON(e,n){const{order:r,field:i}=e;return{field:`${zE}${n}/${i}`,order:r}}_readPopupInfo({description:e,mediaInfos:n,showAttachments:r,relatedRecordsInfo:i={showRelatedRecords:!1}}){const s=[];e?s.push(new aA({text:e})):s.push(new iA),Array.isArray(n)&&n.length&&s.push(sA.fromJSON({mediaInfos:n})),r&&s.push(rA.fromJSON({displayType:"auto"}));const{showRelatedRecords:o,orderByFields:a}=i;return o&&a?.length&&a.forEach(l=>{const c=this._toRelationshipContent(l);c&&s.push(c)}),s.length?s:e}_getContentElementFields(e){const n=e?.type;if(n==="attachments")return[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description)];if(n==="custom")return e.outFields||[];if(n==="fields")return[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description),...this._getFieldInfoFields(e.fieldInfos??this.fieldInfos)];if(n==="media"){const r=e.mediaInfos||[];return[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description),...r.reduce((i,s)=>[...i,...this._getMediaInfoFields(s)],[])]}return n==="text"?this._extractFieldNames(e.text):n==="relationship"||n==="utility-network-associations"?[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description)]:[]}_getMediaInfoFields(e){const{caption:n,title:r,value:i}=e,s=i||{},{fields:o,normalizeField:a,tooltipField:l,sourceURL:c,linkURL:u}=s,h=[...this._extractFieldNames(r),...this._extractFieldNames(n),...this._extractFieldNames(c),...this._extractFieldNames(u),...o??[]];return a&&h.push(a),l&&h.push(l),h}_getContentExpressionInfos(e,n){return Array.isArray(e)?e.reduce((r,i)=>[...r,...i.type==="expression"&&i.expressionInfo?[i.expressionInfo]:[]],n):[]}_getContentFields(e){return typeof e=="string"?this._extractFieldNames(e):Array.isArray(e)?e.reduce((n,r)=>[...n,...this._getContentElementFields(r)],[]):[]}async _collectExpressionInfoFields(e,n,r,i){i&&await Promise.all(i.map(s=>K1(e,n,r,s.expression)))}_getFieldInfoFields(e){return e?e.filter(({fieldName:n,visible:r})=>!(r!==void 0&&!r||!n||n.startsWith(zE)||n.startsWith(Nne))).map(n=>n.fieldName):[]}_getActionsFields(e){return e?e.toArray().reduce((n,r)=>[...n,...this._getActionFields(r)],[]):[]}_getActionFields(e){const{className:n,title:r,type:i}=e,s=i==="button"||i==="toggle"?e.image:"";return[...this._extractFieldNames(r),...this._extractFieldNames(n),...this._extractFieldNames(s)]}_getTitleFields(e){return typeof e=="string"?this._extractFieldNames(e):[]}_extractFieldNames(e){return xKe(e).filter(n=>!(n.startsWith(zE)||n.startsWith(Nne)))}};x([E({type:VKe})],_s.prototype,"actions",void 0),x([E()],_s.prototype,"content",void 0),x([qs("content")],_s.prototype,"castContent",null),x([cr("content",["description","fieldInfos","popupElements","mediaInfos","showAttachments","relatedRecordsInfo"])],_s.prototype,"readContent",null),x([er("web-scene","content",{popupElements:{type:Ot.ofType(LKe)},showAttachments:{type:Boolean},mediaInfos:{type:Ot.ofType(S7)},description:{type:String},relatedRecordsInfo:{type:Mne}})],_s.prototype,"writeWebSceneContent",null),x([er("content",{popupElements:{type:Ot.ofType(OKe)},showAttachments:{type:Boolean},mediaInfos:{type:Ot.ofType(S7)},description:{type:String},relatedRecordsInfo:{type:Mne}})],_s.prototype,"writeWebMapContent",null),x([E({type:[DKe],json:{write:!0}})],_s.prototype,"expressionInfos",void 0),x([E({type:[T1e]})],_s.prototype,"fieldInfos",void 0),x([er("fieldInfos")],_s.prototype,"writeFieldInfos",null),x([E({type:jKe})],_s.prototype,"layerOptions",void 0),x([er("layerOptions")],_s.prototype,"writeLayerOptions",null),x([E({type:Boolean,json:{read:{source:"showLastEditInfo"},write:{target:"showLastEditInfo"},default:!0}})],_s.prototype,"lastEditInfoEnabled",void 0),x([E()],_s.prototype,"outFields",void 0),x([E()],_s.prototype,"overwriteActions",void 0),x([E()],_s.prototype,"returnGeometry",void 0),x([E({json:{type:String}})],_s.prototype,"title",void 0),x([er("title")],_s.prototype,"writeTitle",null),_s=x([ue("esri.PopupTemplate")],_s);const UKe=_s,N1e=Symbol("idFieldsProviderSymbol");function BKe(t){return!!t&&N1e in t}function One(t){return BKe(t)?t[N1e]:void 0}const O1e=Symbol("popupProvider");function k3t(t){return typeof t=="object"&&t!==null&&"popupEnabled"in t&&"popupTemplate"in t}function WKe(t){return!!t&&O1e in t}function HKe(t){return WKe(t)?t[O1e]:null}function A3t(t,e){switch(e.type){case"object-id":case"unique-id-simple":return t.attributes[e.fieldName];case"unique-id-composite":{const n=[];for(const r of e.fieldNames)n.push(t.attributes[r]??null);return JSON.stringify(n)}}}function Lne(t,e){if("uniqueIdFields"in e&&e.uniqueIdFields?.length){if(e.uniqueIdFields.length===1)return t.attributes?.[e.uniqueIdFields[0]];const n=e.uniqueIdFields.map(r=>t.attributes?.[r]);return JSON.stringify(n)}return"objectIdField"in e&&e.objectIdField?t.attributes?.[e.objectIdField]:null}const Dne=new Ys({esriSMS:"simple-marker",esriPMS:"picture-marker",esriSLS:"simple-line",esriSFS:"simple-fill",esriPFS:"picture-fill",esriTS:"text",esriSHD:"shield-label-symbol",PointSymbol3D:"point-3d",LineSymbol3D:"line-3d",PolygonSymbol3D:"polygon-3d",WebStyleSymbol:"web-style",MeshSymbol3D:"mesh-3d",LabelSymbol3D:"label-3d",CIMSymbolReference:"cim"});let qKe=0,ds=class extends qt{constructor(e){super(e),this.id="sym"+qKe++,this.type=null,this.color=new Jn([0,0,0,1])}readColor(e){return e?.[0]!=null?[e[0],e[1],e[2],e[3]/255]:e}async collectRequiredFields(e,n){}hash(){return JSON.stringify(this.toJSON())}clone(){}};x([E({type:Dne.apiValues,readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0,writer:Dne.write,isRequired:!0}}})],ds.prototype,"type",void 0),x([E({type:Jn,json:{write:{allowNull:!0}}})],ds.prototype,"color",void 0),x([cr("color")],ds.prototype,"readColor",null),ds=x([ue("esri.symbols.Symbol")],ds);var O7;let fl=O7=class extends ds{constructor(t){super(t),this.data=null,this.type="cim"}readData(t,e){return e}writeData(t,e){Object.assign(e,t)}async collectRequiredFields(t,e){if(this.data?.type==="CIMSymbolReference"){const n=this.data.primitiveOverrides;if(n){const r=n.map(i=>{const s=i.valueExpressionInfo;return s?K1(t,e,null,s.expression):null});await Promise.all(r)}}}clone(){return new O7({data:Ze(this.data)})}hash(){return hfe(JSON.stringify(this.data)).toString()}};x([E({json:{write:!1}})],fl.prototype,"color",void 0),x([E({json:{write:!0}})],fl.prototype,"data",void 0),x([cr("data",["symbol"])],fl.prototype,"readData",null),x([er("data",{})],fl.prototype,"writeData",null),x([mn({CIMSymbolReference:"cim"},{readOnly:!0})],fl.prototype,"type",void 0),fl=O7=x([ue("esri.symbols.CIMSymbol")],fl);let La=class extends qt{constructor(e){super(e),this.enabled=!0,this.type=null,this.ignoreDrivers=!1}writeEnabled(e,n,r){e||(n[r]=e)}};x([E({type:Boolean,json:{read:{source:"enable"},write:{target:"enable"}}})],La.prototype,"enabled",void 0),x([er("enabled")],La.prototype,"writeEnabled",null),x([E({type:["icon","object","line","path","fill","water","extrude","text"],readOnly:!0,json:{write:{isRequired:!0}}})],La.prototype,"type",void 0),La=x([ue("esri.symbols.Symbol3DLayer")],La);function KKe(t,e){const n=e.transparency!=null?Kge(e.transparency):1,r=e.color;return r&&Array.isArray(r)?new Jn([r[0]||0,r[1]||0,r[2]||0,n]):null}function YKe(t,e){e.color=t.toJSON().slice(0,3);const n=qge(t.a);n!==0&&(e.transparency=n)}function l0(t){return{type:Jn,nonNullable:t?.nonNullable,json:{type:[Dr],default:null,read:{source:["color","transparency"],reader:KKe},write:{target:{color:{type:[Dr],isRequired:t?.colorRequiredOnWrite},transparency:{type:Dr}},writer:YKe}}}}const $d={type:Number,cast:Si,json:{write:!0}};function C3t(t){return t==="emissive"?0:1}let oy=class extends qt{constructor(e){super(e),this.color=new Jn([0,0,0,1]),this.extensionLength=0,this.size=q1(1)}clone(){}cloneProperties(){return{color:Ze(this.color),size:this.size,extensionLength:this.extensionLength}}};x([E({type:["solid","sketch"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0,isRequired:!0}}})],oy.prototype,"type",void 0),x([E(l0({colorRequiredOnWrite:!0}))],oy.prototype,"color",void 0),x([E({...$d,json:{write:{overridePolicy:t=>({enabled:!!t})}}})],oy.prototype,"extensionLength",void 0),x([E($d)],oy.prototype,"size",void 0),oy=x([ue("esri.symbols.edges.Edges3D")],oy);const LW=oy;var L7;let XM=L7=class extends LW{constructor(t){super(t),this.type="sketch"}clone(){return new L7(this.cloneProperties())}};x([mn({sketch:"sketch"},{readOnly:!0})],XM.prototype,"type",void 0),XM=L7=x([ue("esri.symbols.edges.SketchEdges3D")],XM);const XKe=XM;var D7;let ZM=D7=class extends LW{constructor(t){super(t),this.type="solid"}clone(){return new D7(this.cloneProperties())}};x([mn({solid:"solid"},{readOnly:!0})],ZM.prototype,"type",void 0),ZM=D7=x([ue("esri.symbols.edges.SolidEdges3D")],ZM);const ZKe=ZM,L1e={types:{key:"type",base:LW,typeMap:{solid:ZKe,sketch:XKe}},json:{write:!0}};var j7;let kx=j7=class extends qt{constructor(){super(...arguments),this.strength=null,this.source="emissive"}clone(){const t={strength:this.strength,source:this.source};return new j7(t)}};x([E({json:{write:!1}})],kx.prototype,"strength",void 0),x([E({json:{write:!1}})],kx.prototype,"source",void 0),kx=j7=x([ue("esri.symbols.support.Symbol3DEmissive")],kx);var $7;let dc=$7=class extends qt{constructor(t){super(t),this.color=null,this.emissive=new kx({source:"emissive"})}clone(){const t={color:this.color?.clone()??null,emissive:this.emissive?.clone()??null};return new $7(t)}};x([E(l0())],dc.prototype,"color",void 0),x([E({type:kx,json:{write:!1}})],dc.prototype,"emissive",void 0),dc=$7=x([ue("esri.symbols.support.Symbol3DMaterial")],dc);var F7,Rw;let Mf=(Rw=class extends La{constructor(e){super(e),this.type="extrude",this.size=1,this.material=null,this.castShadows=!0,this.edges=null}clone(){return new F7({edges:this.edges?.clone(),enabled:this.enabled,material:this.material?.clone(),castShadows:this.castShadows,size:this.size})}},F7=Rw,Rw);x([mn({Extrude:"extrude"},{readOnly:!0})],Mf.prototype,"type",void 0),x([E({type:Number,json:{write:{enabled:!0,isRequired:!0}},nonNullable:!0})],Mf.prototype,"size",void 0),x([E({type:dc,json:{write:!0}})],Mf.prototype,"material",void 0),x([E({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],Mf.prototype,"castShadows",void 0),x([E(L1e)],Mf.prototype,"edges",void 0),Mf=F7=x([ue("esri.symbols.ExtrudeSymbol3DLayer")],Mf);let kT=class extends qt{constructor(e){super(e)}clone(){throw new Error("Subclasses of LinePattern3D should implement their own clone method.")}};x([E({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],kT.prototype,"type",void 0),kT=x([ue("esri.symbols.patterns.LinePattern3D")],kT);const JKe=["dash","dash-dot","dot","long-dash","long-dash-dot","long-dash-dot-dot","none","short-dash","short-dash-dot","short-dash-dot-dot","short-dot","solid"];var V7;const QKe=Ol()({dash:"dash","dash-dot":"dash-dot","dash-dot-dot":"long-dash-dot-dot",dot:"dot","long-dash":"long-dash","long-dash-dot":"long-dash-dot",null:"none","short-dash":"short-dash","short-dash-dot":"short-dash-dot","short-dash-dot-dot":"short-dash-dot-dot","short-dot":"short-dot",solid:"solid"});let Gy=V7=class extends kT{constructor(t){super(t),this.type="style",this.style="solid"}clone(){const t={style:this.style};return new V7(t)}};x([E({type:["style"],json:{write:{isRequired:!0}}})],Gy.prototype,"type",void 0),x([mn(QKe),E({type:JKe,json:{write:{isRequired:!0}}})],Gy.prototype,"style",void 0),Gy=V7=x([ue("esri.symbols.patterns.LineStylePattern3D")],Gy);let AT=class extends qt{constructor(e){super(e),this.type="style"}clone(){throw new Error("Subclasses of Pattern3D should implement their own clone method.")}};x([E({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],AT.prototype,"type",void 0),AT=x([ue("esri.symbols.patterns.Pattern3D")],AT);const eYe=["backward-diagonal","cross","diagonal-cross","forward-diagonal","horizontal","none","solid","vertical"];var z7;let Ax=z7=class extends AT{constructor(t){super(t),this.type="style",this.style="solid"}clone(){return new z7({style:this.style})}};x([E({type:["style"],json:{write:{isRequired:!0}}})],Ax.prototype,"type",void 0),x([E({type:eYe,json:{read:!0,write:{isRequired:!0}}})],Ax.prototype,"style",void 0),Ax=z7=x([ue("esri.symbols.patterns.StylePattern3D")],Ax);const tYe={types:{key:"type",base:AT,typeMap:{style:Ax}},json:{write:!0}},D1e={types:{key:"type",base:kT,typeMap:{style:Gy}},json:{write:!0}},IT=new Jn("white"),nYe=new Jn([255,255,255,0]);function rYe(t){return t.r===0&&t.g===0&&t.b===0}var G7;let PT=G7=class extends dc{constructor(t){super(t),this.colorMixMode=null}clone(){const t={color:this.color?.clone()??null,colorMixMode:this.colorMixMode,emissive:this.emissive?.clone()??null};return new G7(t)}};x([mn({multiply:"multiply",replace:"replace",tint:"tint"})],PT.prototype,"colorMixMode",void 0),PT=G7=x([ue("esri.symbols.support.Symbol3DFillMaterial")],PT);function DW(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function iYe(t){return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15]]}function sYe(t,e,n,r,i,s,o,a,l,c,u,h,f,g,y,_){return[t,e,n,r,i,s,o,a,l,c,u,h,f,g,y,_]}const oYe=DW();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:oYe,clone:iYe,create:DW,fromValues:sYe},Symbol.toStringTag,{value:"Module"}));function aYe(t){return t<=rfe?new Array(t).fill(0):new Float64Array(t)}function O3t(t){return(c6e(t)?t.byteLength/8:t.length)<=rfe?Array.from(t):new Float64Array(t)}function L3t(t,e,n){return Array.isArray(t)?t.slice(e,e+n):t.subarray(e,e+n)}function D3t(t){return[...t]}function j3t(t){const e=DW();for(let n=0;n<16;++n)e[n]=t[n];return e}function MI(t=hYe){return[t[0],t[1],t[2],t[3],t[4],t[5]]}function jW(t,e,n,r,i,s,o=MI()){return o[0]=t,o[1]=e,o[2]=n,o[3]=r,o[4]=i,o[5]=s,o}function $3t(t,e=MI()){return lYe(t,0,t.length/3,e)}function lYe(t,e,n,r=MI()){return j1e(r,U7),cYe(r,t,e,n),r}function F3t(t,e=aYe(24)){const[n,r,i,s,o,a]=t;return e[0]=n,e[1]=r,e[2]=i,e[3]=n,e[4]=r,e[5]=a,e[6]=n,e[7]=o,e[8]=i,e[9]=n,e[10]=o,e[11]=a,e[12]=s,e[13]=r,e[14]=i,e[15]=s,e[16]=r,e[17]=a,e[18]=s,e[19]=o,e[20]=i,e[21]=s,e[22]=o,e[23]=a,e}function V3t(t,e){const n=isFinite(t[2])||isFinite(t[5]);return new Vn(n?{xmin:t[0],xmax:t[3],ymin:t[1],ymax:t[4],zmin:t[2],zmax:t[5],spatialReference:e}:{xmin:t[0],xmax:t[3],ymin:t[1],ymax:t[4],spatialReference:e})}function z3t(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.min(t[2],e[2]),t[3]=Math.max(t[3],e[3]),t[4]=Math.max(t[4],e[4]),t[5]=Math.max(t[5],e[5])}function G3t(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[3]=Math.max(t[3],e[2]),t[4]=Math.max(t[4],e[3])}function U3t(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.min(t[2],e[2]),t[3]=Math.max(t[3],e[0]),t[4]=Math.max(t[4],e[1]),t[5]=Math.max(t[5],e[2])}function cYe(t,e,n=0,r=e.length/3){let i=t[0],s=t[1],o=t[2],a=t[3],l=t[4],c=t[5];for(let u=0;u<r;u++)i=Math.min(i,e[n+3*u]),s=Math.min(s,e[n+3*u+1]),o=Math.min(o,e[n+3*u+2]),a=Math.max(a,e[n+3*u]),l=Math.max(l,e[n+3*u+1]),c=Math.max(c,e[n+3*u+2]);t[0]=i,t[1]=s,t[2]=o,t[3]=a,t[4]=l,t[5]=c}function B3t(t,e,n){const r=e.length;let i=t[0],s=t[1],o=t[2],a=t[3],l=t[4],c=t[5];if(n)for(let u=0;u<r;u++){const h=e[u];i=Math.min(i,h[0]),s=Math.min(s,h[1]),o=Math.min(o,h[2]),a=Math.max(a,h[0]),l=Math.max(l,h[1]),c=Math.max(c,h[2])}else for(let u=0;u<r;u++){const h=e[u];i=Math.min(i,h[0]),s=Math.min(s,h[1]),a=Math.max(a,h[0]),l=Math.max(l,h[1])}t[0]=i,t[1]=s,t[2]=o,t[3]=a,t[4]=l,t[5]=c}function W3t(t){for(let e=0;e<6;e++)if(!isFinite(t[e]))return!1;return!0}function NI(t){return t[0]>=t[3]?0:t[3]-t[0]}function OI(t){return t[1]>=t[4]?0:t[4]-t[1]}function LI(t){return t[2]>=t[5]?0:t[5]-t[2]}function H3t(t){const e=NI(t),n=LI(t),r=OI(t);return Math.sqrt(e*e+n*n+r*r)}function q3t(t,e=[0,0,0]){return e[0]=t[0]+NI(t)/2,e[1]=t[1]+OI(t)/2,e[2]=t[2]+LI(t)/2,e}function K3t(t,e=[0,0,0]){return e[0]=NI(t),e[1]=OI(t),e[2]=LI(t),e}function Y3t(t,e){return e[0]>=t[0]&&e[1]>=t[1]&&e[2]>=t[2]&&e[0]<=t[3]&&e[1]<=t[4]&&e[2]<=t[5]}function uYe(t,e){return Math.max(e[0],t[0])<=Math.min(e[3],t[3])&&Math.max(e[1],t[1])<=Math.min(e[4],t[4])&&Math.max(e[2],t[2])<=Math.min(e[5],t[5])}function X3t(t,e){return e==null||uYe(t,e)}function Z3t(t,e,n,r,i=t){return i[0]=t[0]+e,i[1]=t[1]+n,i[2]=t[2]+r,i[3]=t[3]+e,i[4]=t[4]+n,i[5]=t[5]+r,i}function J3t(t,e,n=t){const r=t[0]+NI(t)/2,i=t[1]+OI(t)/2,s=t[2]+LI(t)/2;return n[0]=r+(t[0]-r)*e,n[1]=i+(t[1]-i)*e,n[2]=s+(t[2]-s)*e,n[3]=r+(t[3]-r)*e,n[4]=i+(t[4]-i)*e,n[5]=s+(t[5]-s)*e,n}function Q3t(t,e){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function e4t(t,e,n=t){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n!==t&&(n[3]=t[3],n[4]=t[4],n[5]=t[5]),n}function t4t(t,e,n=t){return n[3]=e[0],n[4]=e[1],n[5]=e[2],n!==t&&(n[0]=t[0],n[1]=t[1],n[2]=t[2]),t}function j1e(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function n4t(t){return t?j1e(t,U7):MI(U7)}function r4t(t,e=xl()){return e[0]=t[0],e[1]=t[1],e[2]=t[3],e[3]=t[4],e}function i4t(t,e){return t[0]=e[0],t[1]=e[1],t[2]=Number.NEGATIVE_INFINITY,t[3]=e[2],t[4]=e[3],t[5]=Number.POSITIVE_INFINITY,t}function s4t(t,e,n,r,i){return t[0]=e,t[1]=n,t[2]=Number.NEGATIVE_INFINITY,t[3]=r,t[4]=i,t[5]=Number.POSITIVE_INFINITY,t}function jne(t){return t.length===6}function o4t(t){return NI(t)===0&&OI(t)===0&&LI(t)===0}function a4t(t,e,n){if(t==null||e==null)return t===e;if(!jne(t)||!jne(e))return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}const U7=[1/0,1/0,1/0,-1/0,-1/0,-1/0],hYe=[0,0,0,0,0,0];MI();function l4t(t,{isPrimitive:e,width:n,depth:r,height:i}){const s=e?10:1;if(n==null&&i==null&&r==null)return[s*t[0],s*t[1],s*t[2]];const o=yb(n,r,i);let a;for(let l=0;l<3;l++){const c=o[l];if(c!=null){a=c/t[l];break}}for(let l=0;l<3;l++)o[l]==null&&(o[l]=t[l]*a);return o}const dYe=jW(-.5,-.5,-.5,.5,.5,.5),fYe=jW(-.5,-.5,0,.5,.5,1),pYe=jW(-.5,-.5,0,.5,.5,.5);function c4t(t){switch(t){case"sphere":case"cube":case"diamond":return dYe;case"cylinder":case"cone":case"inverted-cone":return fYe;case"tetrahedron":return pYe;default:return}}const $W=["butt","square","round"],mYe=[...$W,"none"],$1e=["miter","bevel","round"];var B7;let ay=B7=class extends qt{constructor(t){super(t),this.color=new Jn([0,0,0,1]),this.size=q1(1),this.pattern=null,this.patternCap="butt"}clone(){const t={color:this.color!=null?this.color.clone():null,size:this.size,pattern:this.pattern!=null?this.pattern.clone():null,patternCap:this.patternCap};return new B7(t)}};x([E(l0({colorRequiredOnWrite:!0}))],ay.prototype,"color",void 0),x([E({...$d,json:{write:{isRequired:!0}}})],ay.prototype,"size",void 0),x([E(D1e)],ay.prototype,"pattern",void 0),x([E({type:$W,json:{default:"butt",write:{overridePolicy(){return{enabled:this.pattern!=null}}}}})],ay.prototype,"patternCap",void 0),ay=B7=x([ue("esri.symbols.support.Symbol3DOutline")],ay);var JM,Mw;let Ql=(Mw=class extends La{constructor(e){super(e),this.type="fill",this.material=null,this.pattern=null,this.castShadows=!0,this.outline=null,this.edges=null}clone(){const e={edges:this.edges!=null?this.edges.clone():null,enabled:this.enabled,material:this.material!=null?this.material.clone():null,pattern:this.pattern!=null?this.pattern.clone():null,castShadows:this.castShadows,outline:this.outline!=null?this.outline.clone():null};return new JM(e)}static fromSimpleFillSymbol(e){const n=e.outline&&e.outline.style&&e.outline.style!=="solid"?new Gy({style:e.outline.style}):null,r={size:e.outline?.width??0,color:(e.outline?.color??IT).clone(),pattern:n};return n&&e.outline?.cap&&(r.patternCap=e.outline.cap),new JM({material:new PT({color:(e.color??nYe).clone()}),pattern:e.style&&e.style!=="solid"?new Ax({style:e.style}):null,outline:r})}},JM=Mw,Mw);x([mn({Fill:"fill"},{readOnly:!0})],Ql.prototype,"type",void 0),x([E({type:PT,json:{write:!0}})],Ql.prototype,"material",void 0),x([E(tYe)],Ql.prototype,"pattern",void 0),x([E({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],Ql.prototype,"castShadows",void 0),x([E({type:ay,json:{write:!0}})],Ql.prototype,"outline",void 0),x([E(L1e)],Ql.prototype,"edges",void 0),Ql=JM=x([ue("esri.symbols.FillSymbol3DLayer")],Ql);var W7;const gYe=Ol()({circle:"circle",square:"square",cross:"cross",x:"x",kite:"kite",triangle:"triangle"});let ly=W7=class extends qt{constructor(t){super(t)}readHref(t,e,n){return t?ab(t,n):e.dataURI}writeHref(t,e,n,r){t&&(dv(t)?e.dataURI=t:(e.href=y2(t,r),El(e.href)&&(e.href=wg(e.href))))}clone(){return new W7({href:this.href,primitive:this.primitive})}equals(t){return t.primitive===this.primitive&&t.href===this.href}};x([E({type:String,json:{write:!0,read:{source:["href","dataURI"]}}})],ly.prototype,"href",void 0),x([cr("href")],ly.prototype,"readHref",null),x([er("href",{href:{type:String},dataURI:{type:String}})],ly.prototype,"writeHref",null),x([mn(gYe)],ly.prototype,"primitive",void 0),ly=W7=x([ue("esri.symbols.support.IconSymbol3DLayerResource")],ly);const u4t="circle";let QM=class extends vo(qt){constructor(e){super(e),this.mode="hidden"}equals(e){return this.mode===e.mode}};x([E({type:["adaptive","hidden","visible"],json:{write:{isRequired:!0}}})],QM.prototype,"mode",void 0),QM=x([ue("esri.symbols.support.OccludedVisibility")],QM);const F1e=QM;var H7;let Ix=H7=class extends Kt{constructor(t){super(t),this.x=0,this.y=0}clone(){return new H7({x:this.x,y:this.y})}equals(t){return t.x===this.x&&t.y===this.y}};x([E({type:Number})],Ix.prototype,"x",void 0),x([E({type:Number})],Ix.prototype,"y",void 0),Ix=H7=x([ue("esri.symbols.support.Symbol3DAnchorPosition2D")],Ix);var q7;let PS=q7=class extends qt{constructor(t){super(t),this.color=new Jn([0,0,0,1]),this.size=q1(1)}clone(){const t={color:this.color!=null?this.color.clone():null,size:this.size};return new q7(t)}equals(t){return t.size===this.size&&(this.color==null?t.color==null:this.color.equals(t.color))}};x([E(l0({colorRequiredOnWrite:!0}))],PS.prototype,"color",void 0),x([E({...$d,json:{write:{isRequired:!0}}})],PS.prototype,"size",void 0),PS=q7=x([ue("esri.symbols.support.Symbol3DIconOutline")],PS);var nx,Nw;let so=(Nw=class extends La{constructor(e){super(e),this.material=null,this.resource=null,this.type="icon",this.size=12,this.anchor="center",this.anchorPosition=null,this.outline=null,this.angle=0,this.occludedVisibility=null}clone(){return new nx({anchor:this.anchor,anchorPosition:Ze(this.anchorPosition),enabled:this.enabled,material:Ze(this.material),outline:Ze(this.outline),resource:Ze(this.resource),angle:this.angle,size:this.size,occludedVisibility:Ze(this.occludedVisibility)})}static fromSimpleMarkerSymbol(e){const n=e.color||IT,r=$ne(e),i=e.outline&&e.outline.width>0?{size:e.outline.width,color:(e.outline.color||IT).clone()}:null;return new nx({size:e.size,angle:e.angle,resource:{primitive:vYe(()=>kt.getLogger(this.prototype),e.style)},material:{color:n},outline:i,anchor:r?"relative":void 0,anchorPosition:r})}static fromPictureMarkerSymbol(e){const n=!e.color||rYe(e.color)?IT:e.color,r=$ne(e);return new nx({size:e.width<=e.height?e.height:e.width,angle:e.angle,resource:{href:e.url},material:{color:n.clone()},anchor:r?"relative":void 0,anchorPosition:r})}static fromCIMSymbol(e){return new nx({resource:{href:bfe({mediaType:"application/json",data:JSON.stringify(e.data)})}})}},nx=Nw,Nw);function $ne(t){const e="width"in t?t.width:t.size,n="height"in t?t.height:t.size,r=Fne(t.xoffset),i=Fne(t.yoffset);return(r||i)&&e&&n?{x:-r/e,y:i/n}:null}function Fne(t){return isFinite(t)?t:0}x([E({type:dc,json:{write:!0}})],so.prototype,"material",void 0),x([E({type:ly,json:{write:!0}})],so.prototype,"resource",void 0),x([mn({Icon:"icon"},{readOnly:!0})],so.prototype,"type",void 0),x([E({...$d,json:{write:{isRequired:!0}}})],so.prototype,"size",void 0),x([mn({center:"center",left:"left",right:"right",top:"top",bottom:"bottom",topLeft:"top-left",topRight:"top-right",bottomLeft:"bottom-left",bottomRight:"bottom-right",relative:"relative"},{default:"center"})],so.prototype,"anchor",void 0),x([E({type:Ix,json:{type:[Number],read:{reader:t=>new Ix({x:t[0],y:t[1]})},write:{writer:(t,e)=>{e.anchorPosition=[t.x,t.y]},overridePolicy(){return{enabled:this.anchor==="relative"}}}}})],so.prototype,"anchorPosition",void 0),x([E({type:PS,json:{write:!0}})],so.prototype,"outline",void 0),x([E({type:Number,json:{write:!0,default:0}})],so.prototype,"angle",void 0),x([E({type:F1e})],so.prototype,"occludedVisibility",void 0),so=nx=x([ue("esri.symbols.IconSymbol3DLayer")],so);const yYe={circle:"circle",cross:"cross",diamond:"kite",square:"square",x:"x",triangle:"triangle",path:null};function vYe(t,e){return yYe[e]||(t().warn(`${e} cannot be mapped to Icon symbol. Fallback to "circle"`),"circle")}const _Ye=["begin","end","begin-end"],V1e=["arrow","circle","square","diamond","cross","x"];let Vf=class extends vo(qt){constructor(e){super(e),this.type="style",this.placement="begin-end",this.style="arrow",this.color=null}equals(e){return e!=null&&e.placement===this.placement&&e.style===this.style&&(this.color==null&&e.color==null||this.color!=null&&e.color!=null&&this.color.toJSON()===e.color.toJSON())}};x([E({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0,isRequired:!0}}})],Vf.prototype,"type",void 0),x([E({type:_Ye,json:{default:"begin-end",write:!0}})],Vf.prototype,"placement",void 0),x([E({type:V1e,json:{default:"arrow",write:!0}})],Vf.prototype,"style",void 0),x([E({type:Jn,json:{type:[Dr],default:null,write:!0}})],Vf.prototype,"color",void 0),Vf=x([ue("esri.symbols.LineStyleMarker3D")],Vf);var e3,Ow;let cl=(Ow=class extends La{constructor(e){super(e),this.material=null,this.type="line",this.join="miter",this.cap="butt",this.size=q1(1),this.pattern=null,this.marker=null}clone(){const e={enabled:this.enabled,material:this.material!=null?this.material.clone():null,size:this.size,join:this.join,cap:this.cap,pattern:this.pattern!=null?this.pattern.clone():null,marker:this.marker!=null?this.marker.clone():null};return new e3(e)}static fromSimpleLineSymbol(e){const n={enabled:!0,size:e.width??q1(1),cap:e.cap||"butt",join:e.join||"miter",pattern:e.style?new Gy({style:e.style}):null,material:new dc({color:(e.color||IT).clone()}),marker:e.marker?new Vf({placement:e.marker.placement,style:e.marker.style,color:e.marker.color?.clone()??null}):null};return new e3(n)}},e3=Ow,Ow);x([E({type:dc,json:{write:!0}})],cl.prototype,"material",void 0),x([mn({Line:"line"},{readOnly:!0})],cl.prototype,"type",void 0),x([E({type:$1e,json:{write:!0,default:"miter"}})],cl.prototype,"join",void 0),x([E({type:$W,json:{write:!0,default:"butt"}})],cl.prototype,"cap",void 0),x([E({...$d,json:{write:{isRequired:!0}}})],cl.prototype,"size",void 0),x([E(D1e)],cl.prototype,"pattern",void 0),x([E({types:{key:"type",base:Vf,typeMap:{style:Vf}},json:{write:!0}})],cl.prototype,"marker",void 0),cl=e3=x([ue("esri.symbols.LineSymbol3DLayer")],cl);var K7;const xYe=Ol()({sphere:"sphere",cylinder:"cylinder",cube:"cube",cone:"cone",diamond:"diamond",tetrahedron:"tetrahedron",invertedCone:"inverted-cone"});let CS=K7=class extends qt{clone(){return new K7({href:this.href,primitive:this.primitive})}};x([E({type:String,json:{read:TO,write:v2}})],CS.prototype,"href",void 0),x([mn(xYe)],CS.prototype,"primitive",void 0),CS=K7=x([ue("esri.symbols.support.ObjectSymbol3DLayerResource")],CS);const f4t="sphere";var Y7;let ky=Y7=class extends Kt{constructor(){super(...arguments),this.x=0,this.y=0,this.z=0}clone(){return new Y7({x:this.x,y:this.y,z:this.z})}};x([E({type:Number})],ky.prototype,"x",void 0),x([E({type:Number})],ky.prototype,"y",void 0),x([E({type:Number})],ky.prototype,"z",void 0),ky=Y7=x([ue("esri.symbols.support.Symbol3DAnchorPosition3D")],ky);var X7,Lw;let ro=(Lw=class extends La{constructor(e){super(e),this.material=null,this.castShadows=!0,this.resource=null,this.type="object",this.width=void 0,this.height=void 0,this.depth=void 0,this.anchor=void 0,this.anchorPosition=void 0,this.heading=void 0,this.tilt=void 0,this.roll=void 0}clone(){return new X7({heading:this.heading,tilt:this.tilt,roll:this.roll,anchor:this.anchor,anchorPosition:this.anchorPosition?.clone(),depth:this.depth,enabled:this.enabled,height:this.height,material:this.material?.clone()??null,castShadows:this.castShadows,resource:this.resource?.clone(),width:this.width})}get isPrimitive(){return!this.resource||typeof this.resource.href!="string"}},X7=Lw,Lw);x([E({type:dc,json:{write:!0}})],ro.prototype,"material",void 0),x([E({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],ro.prototype,"castShadows",void 0),x([E({type:CS,json:{write:!0}})],ro.prototype,"resource",void 0),x([mn({Object:"object"},{readOnly:!0})],ro.prototype,"type",void 0),x([E({type:Number,json:{write:!0}})],ro.prototype,"width",void 0),x([E({type:Number,json:{write:!0}})],ro.prototype,"height",void 0),x([E({type:Number,json:{write:!0}})],ro.prototype,"depth",void 0),x([mn({center:"center",top:"top",bottom:"bottom",origin:"origin",relative:"relative"},{default:"origin"})],ro.prototype,"anchor",void 0),x([E({type:ky,json:{type:[Number],read:{reader:t=>new ky({x:t[0],y:t[1],z:t[2]})},write:{writer:(t,e)=>{e.anchorPosition=[t.x,t.y,t.z]},overridePolicy(){return{enabled:this.anchor==="relative"}}}}})],ro.prototype,"anchorPosition",void 0),x([E({type:Number,json:{write:!0}})],ro.prototype,"heading",void 0),x([E({type:Number,json:{write:!0}})],ro.prototype,"tilt",void 0),x([E({type:Number,json:{write:!0}})],ro.prototype,"roll",void 0),x([E({readOnly:!0})],ro.prototype,"isPrimitive",null),ro=X7=x([ue("esri.symbols.ObjectSymbol3DLayer")],ro);var Z7,Dw;let ko=(Dw=class extends La{constructor(e){super(e),this.material=null,this.castShadows=!0,this.type="path",this.profile="circle",this.join="miter",this.cap="butt",this.width=void 0,this.height=void 0,this.anchor="center",this.profileRotation="all"}readWidth(e,n){return e??(n.height==null&&n.size!=null?n.size:void 0)}readHeight(e,n){return e??(n.width==null&&n.size!=null?n.size:void 0)}clone(){return new Z7({enabled:this.enabled,material:this.material!=null?this.material.clone():null,castShadows:this.castShadows,profile:this.profile,join:this.join,cap:this.cap,width:this.width,height:this.height,profileRotation:this.profileRotation,anchor:this.anchor})}},Z7=Dw,Dw);x([E({type:dc,json:{write:!0}})],ko.prototype,"material",void 0),x([E({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],ko.prototype,"castShadows",void 0),x([mn({Path:"path"},{readOnly:!0})],ko.prototype,"type",void 0),x([E({type:["circle","quad"],nonNullable:!0,json:{write:!0,default:"circle"}})],ko.prototype,"profile",void 0),x([E({type:$1e,nonNullable:!0,json:{write:!0,default:"miter"}})],ko.prototype,"join",void 0),x([E({type:mYe,nonNullable:!0,json:{write:!0,default:"butt"}})],ko.prototype,"cap",void 0),x([E({type:Number,json:{write:{enabled:!0,target:{width:{type:Number},size:{type:Number}}}}})],ko.prototype,"width",void 0),x([cr("width",["width","size","height"])],ko.prototype,"readWidth",null),x([E({type:Number,json:{write:!0}})],ko.prototype,"height",void 0),x([cr("height",["height","size","width"])],ko.prototype,"readHeight",null),x([E({type:["center","bottom","top"],nonNullable:!0,json:{write:!0,default:"center"}})],ko.prototype,"anchor",void 0),x([E({type:["heading","all"],nonNullable:!0,json:{write:!0,default:"all"}})],ko.prototype,"profileRotation",void 0),ko=Z7=x([ue("esri.symbols.PathSymbol3DLayer")],ko);const wYe=["none","underline","line-through"],bYe=["normal","italic","oblique"],EYe=["normal","lighter","bold","bolder"],z1e={type:Number,cast:t=>{const e=sc(t);return e===0?1:vu(e,.1,4)},nonNullable:!0},SYe=["left","right","center"],TYe=["baseline","top","middle","bottom"],G1e={type:SYe,nonNullable:!0},U1e={type:TYe,nonNullable:!0},p4t=8;var J7;let qc=J7=class extends qt{constructor(t){super(t),this.decoration="none",this.family="sans-serif",this.size=9,this.style="normal",this.weight="normal"}castSize(t){return Si(t)}clone(){return new J7({decoration:this.decoration,family:this.family,size:this.size,style:this.style,weight:this.weight})}hash(){return`${this.decoration}.${this.family}.${this.size}.${this.style}.${this.weight}`}};x([E({type:wYe,json:{default:"none",write:!0}})],qc.prototype,"decoration",void 0),x([E({type:String,json:{write:!0}})],qc.prototype,"family",void 0),x([E({type:Number,json:{write:{overridePolicy:(t,e,n)=>({enabled:!n||!n.textSymbol3D})}}})],qc.prototype,"size",void 0),x([qs("size")],qc.prototype,"castSize",null),x([E({type:bYe,json:{default:"normal",write:!0}})],qc.prototype,"style",void 0),x([E({type:EYe,json:{default:"normal",write:!0}})],qc.prototype,"weight",void 0),qc=J7=x([ue("esri.symbols.Font")],qc);var Q7;let Px=Q7=class extends qt{constructor(){super(...arguments),this.color=new Jn([0,0,0,1]),this.size=0}clone(){const t={color:Ze(this.color),size:this.size};return new Q7(t)}};x([E(l0())],Px.prototype,"color",void 0),x([E($d)],Px.prototype,"size",void 0),Px=Q7=x([ue("esri.symbols.support.Symbol3DHalo")],Px);let CT=class extends vo(qt){constructor(e){super(e),this.color=null}};x([E(l0())],CT.prototype,"color",void 0),CT=x([ue("esri.symbols.support.Symbol3DTextBackground")],CT);var t3,jw;let bs=(jw=class extends La{constructor(e){super(e),this._userSize=void 0,this.halo=null,this.horizontalAlignment="center",this.lineHeight=1,this.material=null,this.background=null,this.text=null,this.type="text",this.verticalAlignment="baseline",this.occludedVisibility=null}get font(){return this._get("font")||null}set font(e){e!=null&&this._userSize!=null&&(e.size=this._userSize),this._set("font",e)}writeFont(e,n,r,i){const s={...i,textSymbol3D:!0};n.font=e.write({},s),delete n.font.size}get size(){return this._userSize!=null?this._userSize:this.font?.size!=null?this.font.size:9}set size(e){this._userSize=e,this.font!=null&&(this.font.size=this._userSize),this.notifyChange("size")}clone(){const e=new t3({enabled:this.enabled,font:Ze(this.font),halo:Ze(this.halo),horizontalAlignment:this.horizontalAlignment,lineHeight:this.lineHeight,material:this.material!=null?this.material.clone():null,text:this.text,verticalAlignment:this.verticalAlignment,background:Ze(this.background),occludedVisibility:Ze(this.occludedVisibility)});return e._userSize=this._userSize,e}static fromTextSymbol(e){return new t3({font:e.font!=null?e.font.clone():new qc,halo:kYe(e.haloColor,e.haloSize),horizontalAlignment:e.horizontalAlignment,lineHeight:e.lineHeight,material:e.color?new dc({color:e.color.clone()}):null,text:e.text,verticalAlignment:e.verticalAlignment,background:e.backgroundColor?new CT({color:e.backgroundColor.clone()}):null})}},t3=jw,jw);function kYe(t,e){return t&&e!=null&&e>0?new Px({color:Ze(t),size:e}):null}x([E({type:qc,json:{write:!0}})],bs.prototype,"font",null),x([er("font")],bs.prototype,"writeFont",null),x([E({type:Px,json:{write:!0}})],bs.prototype,"halo",void 0),x([E({...G1e,json:{default:"center",write:!0}})],bs.prototype,"horizontalAlignment",void 0),x([E({...z1e,json:{default:1,write:!0}})],bs.prototype,"lineHeight",void 0),x([E({type:dc,json:{write:!0}})],bs.prototype,"material",void 0),x([E({type:CT,json:{write:!0}})],bs.prototype,"background",void 0),x([E($d)],bs.prototype,"size",null),x([E({type:String,json:{write:!0}})],bs.prototype,"text",void 0),x([mn({Text:"text"},{readOnly:!0})],bs.prototype,"type",void 0),x([E({...U1e,json:{default:"baseline",write:!0}})],bs.prototype,"verticalAlignment",void 0),x([E({type:F1e})],bs.prototype,"occludedVisibility",void 0),bs=t3=x([ue("esri.symbols.TextSymbol3DLayer")],bs);var eV,$w;let Nf=($w=class extends La{constructor(e){super(e),this.color=tV.clone(),this.type="water",this.waterbodySize="medium",this.waveDirection=null,this.waveStrength="moderate"}clone(){return new eV({color:this.color.clone(),waterbodySize:this.waterbodySize,waveDirection:this.waveDirection,waveStrength:this.waveStrength})}},eV=$w,$w);x([E({type:Jn,nonNullable:!0,json:{type:[Dr],write:(t,e,n)=>e[n]=t.toArray(1),default:()=>tV.clone(),defaultEquals:t=>t.toCss(!0)===tV.toCss(!0)}})],Nf.prototype,"color",void 0),x([mn({Water:"water"},{readOnly:!0})],Nf.prototype,"type",void 0),x([E({type:["small","medium","large"],json:{write:!0,default:"medium"}})],Nf.prototype,"waterbodySize",void 0),x([E({type:Number,json:{write:!0,default:null}})],Nf.prototype,"waveDirection",void 0),x([E({type:["calm","rippled","slight","moderate"],json:{write:!0,default:"moderate"}})],Nf.prototype,"waveStrength",void 0),Nf=eV=x([ue("esri.symbols.WaterSymbol3DLayer")],Nf);const tV=new Jn([0,119,190]);var nV;let zf=nV=class extends Kt{constructor(t){super(t),this.name=null,this.styleUrl=null,this.styleName=null,this.portal=null}clone(){return new nV({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})}};x([E({type:String})],zf.prototype,"name",void 0),x([E({type:String})],zf.prototype,"styleUrl",void 0),x([E({type:String})],zf.prototype,"styleName",void 0),x([E({type:it})],zf.prototype,"portal",void 0),zf=nV=x([ue("esri.symbols.support.StyleOrigin")],zf);var rV;let RT=rV=class extends Kt{constructor(){super(...arguments),this.url=""}clone(){return new rV({url:this.url})}};x([E({type:String})],RT.prototype,"url",void 0),RT=rV=x([ue("esri.symbols.support.Thumbnail")],RT);const B1e={icon:so,object:ro,line:cl,path:ko,fill:Ql,extrude:Mf,text:bs,water:Nf},AYe=Ot.ofType({base:La,key:"type",typeMap:B1e,errorContext:"symbol-layer"});let ul=class extends ds{constructor(e){super(e),this.styleOrigin=null,this.thumbnail=null,this.type=null;const n=this.__accessor__&&this.__accessor__.metadata&&this.__accessor__.metadata.symbolLayers,r=n?.type,i=r||Ot;this._set("symbolLayers",new i)}get color(){return null}set color(e){this.constructed&&kt.getLogger(this).error("Symbol3D does not support colors on the symbol level. Colors may be set on individual symbol layer materials instead.")}set symbolLayers(e){Sd(e,this._get("symbolLayers"))}readStyleOrigin(e,n,r){if(e.styleUrl&&e.name){const i=ab(e.styleUrl,r);return new zf({styleUrl:i,name:e.name})}if(e.styleName&&e.name)return new zf({portal:r?.portal||it.getDefault(),styleName:e.styleName,name:e.name});r?.messages&&r.messages.push(new Ld("symbol3d:incomplete-style-origin","Style origin requires either a 'styleUrl' or 'styleName' and a 'name' property",{context:r,definition:e}))}writeStyleOrigin(e,n,r,i){if(e.styleUrl&&e.name){let s=y2(e.styleUrl,i);El(s)&&(s=wg(s)),n.styleOrigin={styleUrl:s,name:e.name}}else e.styleName&&e.name&&(e.portal&&i?.portal&&!M6e(e.portal.restUrl,i.portal.restUrl)?i?.messages&&i.messages.push(new Ld("symbol:cross-portal","The symbol style origin cannot be persisted because it refers to an item on a different portal than the one being saved to.",{symbol:this})):n.styleOrigin={styleName:e.styleName,name:e.name})}normalizeCtorArgs(e){return e instanceof La||e&&B1e[e.type]?{symbolLayers:[e]}:Array.isArray(e)?{symbolLayers:e}:e}};x([E({json:{read:!1,write:!1}})],ul.prototype,"color",null),x([E({type:AYe,nonNullable:!0,json:{write:!0}}),qs(Npe)],ul.prototype,"symbolLayers",null),x([E({type:zf})],ul.prototype,"styleOrigin",void 0),x([cr("styleOrigin")],ul.prototype,"readStyleOrigin",null),x([er("styleOrigin",{"styleOrigin.styleUrl":{type:String},"styleOrigin.styleName":{type:String},"styleOrigin.name":{type:String}})],ul.prototype,"writeStyleOrigin",null),x([E({type:RT,json:{read:!1}})],ul.prototype,"thumbnail",void 0),x([E({type:["point-3d","line-3d","polygon-3d","mesh-3d","label-3d"],readOnly:!0})],ul.prototype,"type",void 0),ul=x([ue("esri.symbols.Symbol3D")],ul);let Cx=class extends qt{constructor(e){super(e),this.visible=!0}clone(){throw new Error("Subclasses of Callout3D should implement their own clone method.")}};x([E({type:["line"],constructOnly:!0,json:{read:!1,write:{ignoreOrigin:!0,isRequired:!0}}})],Cx.prototype,"type",void 0),x([E({readOnly:!0})],Cx.prototype,"visible",void 0),Cx=x([ue("esri.symbols.callouts.Callout3D")],Cx);var iV;let n3=iV=class extends qt{constructor(t){super(t),this.color=new Jn("white")}clone(){return new iV({color:Ze(this.color)})}};x([E(l0({colorRequiredOnWrite:!0}))],n3.prototype,"color",void 0),n3=iV=x([ue("esri.symbols.callouts.LineCallout3DBorder")],n3);const IYe=n3;var sV;let Of=sV=class extends Cx{constructor(t){super(t),this.type="line",this.color=new Jn([0,0,0,1]),this.size=q1(1),this.border=null}get visible(){return this.size>0&&this.color!=null&&this.color.a>0}clone(){return new sV({color:Ze(this.color),size:this.size,border:Ze(this.border)})}};x([mn({line:"line"})],Of.prototype,"type",void 0),x([E(l0({colorRequiredOnWrite:!0}))],Of.prototype,"color",void 0),x([E({...$d,json:{write:{isRequired:!0}}})],Of.prototype,"size",void 0),x([E({type:IYe,json:{write:!0}})],Of.prototype,"border",void 0),x([E({readOnly:!0})],Of.prototype,"visible",null),Of=sV=x([ue("esri.symbols.callouts.LineCallout3D")],Of);function FW(t){if(!t)return!1;const e=t.verticalOffset;return!(!e||e.screenLength<=0||e.maxWorldLength!=null&&e.maxWorldLength<=0)}function W1e(t){return!t||!t.supportsCallout||!t.supportsCallout()?!1:!!t.callout?.visible&&!!FW(t)}function v4t(t){return t.type==="point-3d"||t.type==="label-3d"}function _4t(t){return t.horizontalAlignment==="center"}const H1e={types:{key:"type",base:Cx,typeMap:{line:Of}},json:{write:!0}};var oV;let Wm=oV=class extends qt{constructor(t){super(t),this.screenLength=0,this.minWorldLength=0,this.maxWorldLength=null}clone(){return new oV({screenLength:this.screenLength,minWorldLength:this.minWorldLength,maxWorldLength:this.maxWorldLength})}};x([E({...$d,json:{write:{isRequired:!0}}})],Wm.prototype,"screenLength",void 0),x([E({type:Number,nonNullable:!0,json:{write:!0,default:0}})],Wm.prototype,"minWorldLength",void 0),x([E({type:Number,json:{write:!0}})],Wm.prototype,"maxWorldLength",void 0),Wm=oV=x([ue("esri.symbols.support.Symbol3DVerticalOffset")],Wm);var r3;const q1e=Ot.ofType({base:null,key:"type",typeMap:{text:bs}});let od=r3=class extends ul{constructor(t){super(t),this.verticalOffset=null,this.callout=null,this.styleOrigin=null,this.symbolLayers=new q1e,this.type="label-3d"}supportsCallout(){return!0}hasVisibleCallout(){return W1e(this)}hasVisibleVerticalOffset(){return FW(this)}clone(){return new r3({styleOrigin:Ze(this.styleOrigin),symbolLayers:Ze(this.symbolLayers),thumbnail:Ze(this.thumbnail),callout:Ze(this.callout),verticalOffset:Ze(this.verticalOffset)})}static fromTextSymbol(t){return new r3({symbolLayers:new Ot([bs.fromTextSymbol(t)])})}};x([E({type:Wm,json:{write:!0}})],od.prototype,"verticalOffset",void 0),x([E(H1e)],od.prototype,"callout",void 0),x([E({json:{read:!1,write:!1}})],od.prototype,"styleOrigin",void 0),x([E({type:q1e})],od.prototype,"symbolLayers",void 0),x([mn({LabelSymbol3D:"label-3d"},{readOnly:!0})],od.prototype,"type",void 0),od=r3=x([ue("esri.symbols.LabelSymbol3D")],od);var i3;const K1e=Ot.ofType({base:null,key:"type",typeMap:{line:cl,path:ko}}),PYe=Ot.ofType({base:null,key:"type",typeMap:{line:cl,path:ko}});let sg=i3=class extends ul{constructor(t){super(t),this.symbolLayers=new K1e,this.type="line-3d"}clone(){return new i3({styleOrigin:Ze(this.styleOrigin),symbolLayers:Ze(this.symbolLayers),thumbnail:Ze(this.thumbnail)})}static fromSimpleLineSymbol(t){return new i3({symbolLayers:new Ot([cl.fromSimpleLineSymbol(t)])})}};x([E({type:K1e,json:{type:PYe}})],sg.prototype,"symbolLayers",void 0),x([mn({LineSymbol3D:"line-3d"},{readOnly:!0})],sg.prototype,"type",void 0),sg=i3=x([ue("esri.symbols.LineSymbol3D")],sg);var s3;const Y1e=Ot.ofType({base:null,key:"type",typeMap:{fill:Ql}});let Uy=s3=class extends ul{constructor(t){super(t),this.symbolLayers=new Y1e,this.type="mesh-3d"}clone(){return new s3({styleOrigin:Ze(this.styleOrigin),symbolLayers:Ze(this.symbolLayers),thumbnail:Ze(this.thumbnail)})}static fromSimpleFillSymbol(t){return new s3({symbolLayers:new Ot([Ql.fromSimpleFillSymbol(t)])})}};x([E({type:Y1e})],Uy.prototype,"symbolLayers",void 0),x([mn({MeshSymbol3D:"mesh-3d"},{readOnly:!0})],Uy.prototype,"type",void 0),Uy=s3=x([ue("esri.symbols.MeshSymbol3D")],Uy);let RS=class extends ds{constructor(e){super(e),this.type="simple-line",this.width=.75}hash(){return`${this.type}.${this.width}`}};x([mn({esriSLS:"simple-line"},{readOnly:!0})],RS.prototype,"type",void 0),x([E({type:Number,cast:Si,json:{write:!0}})],RS.prototype,"width",void 0),RS=x([ue("esri.symbols.LineSymbol")],RS);var aV;let Jh=aV=class extends qt{constructor(t){super(t),this.placement="begin-end",this.type="line-marker",this.style="arrow"}writeStyle(t,e,n,r){e[n]=r?.origin==="web-map"?"arrow":t}set color(t){this._set("color",t)}readColor(t){return t?.[0]!=null?[t[0],t[1],t[2],t[3]/255]:t}writeColor(t,e,n,r){r?.origin==="web-map"||(e[n]=t)}clone(){return new aV({color:Ze(this.color),placement:this.placement,style:this.style})}hash(){return`${this.placement}.${this.color?.hash()}.${this.style}`}};x([E({type:["begin","end","begin-end"],json:{write:!0}})],Jh.prototype,"placement",void 0),x([mn({"line-marker":"line-marker"},{readOnly:!0}),E({json:{origins:{"web-map":{write:!1}}}})],Jh.prototype,"type",void 0),x([E({type:V1e})],Jh.prototype,"style",void 0),x([er("style")],Jh.prototype,"writeStyle",null),x([E({type:Jn,value:null,json:{write:{allowNull:!0}}})],Jh.prototype,"color",null),x([cr("color")],Jh.prototype,"readColor",null),x([er("color")],Jh.prototype,"writeColor",null),Jh=aV=x([ue("esri.symbols.LineSymbolMarker")],Jh);const CYe=Jh;var lV;const r$=new Ys({esriSLSSolid:"solid",esriSLSDash:"dash",esriSLSDot:"dot",esriSLSDashDot:"dash-dot",esriSLSDashDotDot:"long-dash-dot-dot",esriSLSNull:"none",esriSLSShortDash:"short-dash",esriSLSShortDot:"short-dot",esriSLSShortDashDot:"short-dash-dot",esriSLSShortDashDotDot:"short-dash-dot-dot",esriSLSLongDash:"long-dash",esriSLSLongDashDot:"long-dash-dot"});let Ca=lV=class extends RS{constructor(...t){super(...t),this.type="simple-line",this.style="solid",this.cap="round",this.join="round",this.marker=null,this.miterLimit=2}normalizeCtorArgs(t,e,n,r,i,s){if(t&&typeof t!="string")return t;const o={};return t!=null&&(o.style=t),e!=null&&(o.color=e),n!=null&&(o.width=Si(n)),r!=null&&(o.cap=r),i!=null&&(o.join=i),s!=null&&(o.miterLimit=Si(s)),o}clone(){return new lV({color:Ze(this.color),style:this.style,width:this.width,cap:this.cap,join:this.join,miterLimit:this.miterLimit,marker:this.marker?.clone()})}hash(){return`${super.hash()}.${this.color?.hash()}.${this.style}.${this.cap}.${this.join}.${this.miterLimit}.${this.marker?.hash()}`}};x([mn({esriSLS:"simple-line"},{readOnly:!0})],Ca.prototype,"type",void 0),x([E({type:r$.apiValues,json:{read:r$.read,write:r$.write}})],Ca.prototype,"style",void 0),x([E({type:["butt","round","square"],json:{write:{overridePolicy:(t,e,n)=>({enabled:t!=="round"&&n?.origin==null})}}})],Ca.prototype,"cap",void 0),x([E({type:["miter","round","bevel"],json:{write:{overridePolicy:(t,e,n)=>({enabled:t!=="round"&&n?.origin==null})}}})],Ca.prototype,"join",void 0),x([E({types:{key:"type",base:null,defaultKeyValue:"line-marker",typeMap:{"line-marker":CYe}},json:{write:!0,origins:{"web-scene":{write:!1}}}})],Ca.prototype,"marker",void 0),x([E({type:Number,json:{read:!1,write:!1}})],Ca.prototype,"miterLimit",void 0),Ca=lV=x([ue("esri.symbols.SimpleLineSymbol")],Ca);let Rx=class extends ds{constructor(e){super(e),this.outline=null,this.type=null}hash(){return`${this.type}.${this.outline?.hash()}`}};x([E({types:{key:"type",base:null,defaultKeyValue:"simple-line",typeMap:{"simple-line":Ca}},json:{default:null,write:!0}})],Rx.prototype,"outline",void 0),x([E({type:["simple-fill","picture-fill"],readOnly:!0})],Rx.prototype,"type",void 0),Rx=x([ue("esri.symbols.FillSymbol")],Rx);function RYe(t,e,n){return e.imageData?bfe({mediaType:e.contentType||"image/png",isBase64:!0,data:e.imageData}):X1e(e.url,n)}function X1e(t,e){if(!El(t)){const n=NYe(e);if(n)return hI(n,"images",t)}return ab(t,e)}function MYe(t,e,n,r){if(dv(t)){const i=g2(t);if(!i)return;e.contentType=i.mediaType,e.imageData=i.data,n&&n.imageData===e.imageData&&n.url&&v2(n.url,e,"url",r)}else v2(t,e,"url",r)}const Z1e={json:{read:{source:["imageData","url"],reader:RYe},write:{writer(t,e,n,r){MYe(t,e,this.source,r)}}}},J1e={readOnly:!0,json:{read:{source:["imageData","url"],reader(t,e,n){const r={};return e.imageData&&(r.imageData=e.imageData),e.contentType&&(r.contentType=e.contentType),e.url&&(r.url=X1e(e.url,n)),r}}}};function NYe(t){if(!t)return null;const{origin:e,layer:n}=t;if(e!=="service"&&e!=="portal-item")return null;const r=n?.type;return r==="feature"||r==="stream"?n.parsedUrl?.path:r==="map-image"||r==="tile"?t.url?.path:null}var cV;let il=cV=class extends Rx{constructor(...t){super(...t),this.type="picture-fill",this.url=null,this.xscale=1,this.yscale=1,this.width=12,this.height=12,this.xoffset=0,this.yoffset=0,this.source=null}normalizeCtorArgs(t,e,n,r){if(t&&typeof t!="string"&&t.imageData==null)return t;const i={};return t&&(i.url=t),e&&(i.outline=e),n!=null&&(i.width=Si(n)),r!=null&&(i.height=Si(r)),i}clone(){const t=new cV({color:Ze(this.color),height:this.height,outline:Ze(this.outline),url:this.url,width:this.width,xoffset:this.xoffset,xscale:this.xscale,yoffset:this.yoffset,yscale:this.yscale});return t._set("source",Ze(this.source)),t}hash(){return`${super.hash()}.${this.color?.hash()}.${this.height}.${this.url}.${this.width}.${this.xoffset}.${this.xscale}.${this.yoffset}.${this.yscale}`}};x([mn({esriPFS:"picture-fill"},{readOnly:!0})],il.prototype,"type",void 0),x([E(Z1e)],il.prototype,"url",void 0),x([E({type:Number,json:{write:!0}})],il.prototype,"xscale",void 0),x([E({type:Number,json:{write:!0}})],il.prototype,"yscale",void 0),x([E({type:Number,cast:Si,json:{write:!0}})],il.prototype,"width",void 0),x([E({type:Number,cast:Si,json:{write:!0}})],il.prototype,"height",void 0),x([E({type:Number,cast:Si,json:{write:!0}})],il.prototype,"xoffset",void 0),x([E({type:Number,cast:Si,json:{write:!0}})],il.prototype,"yoffset",void 0),x([E(J1e)],il.prototype,"source",void 0),il=cV=x([ue("esri.symbols.PictureFillSymbol")],il);let Lf=class extends ds{constructor(e){super(e),this.angle=0,this.type=null,this.xoffset=0,this.yoffset=0,this.size=9}hash(){return`${this.type}.${this.angle}.${this.size}.${this.xoffset}.${this.yoffset}`}};x([E({type:Number,json:{read:t=>t&&-1*t,write:(t,e)=>e.angle=t&&-1*t}})],Lf.prototype,"angle",void 0),x([E({type:["simple-marker","picture-marker"],readOnly:!0})],Lf.prototype,"type",void 0),x([E({type:Number,cast:Si,json:{write:!0}})],Lf.prototype,"xoffset",void 0),x([E({type:Number,cast:Si,json:{write:!0}})],Lf.prototype,"yoffset",void 0),x([E({cast:t=>t==="auto"?t:sc(Si(t)),json:{write:!0}})],Lf.prototype,"size",void 0),Lf=x([ue("esri.symbols.MarkerSymbol")],Lf);var uV;let al=uV=class extends Lf{constructor(...t){super(...t),this.color=null,this.type="picture-marker",this.url=null,this.source=null,this.height=12,this.width=12,this.size=null}normalizeCtorArgs(t,e,n){if(t&&typeof t!="string"&&t.imageData==null)return t;const r={};return t&&(r.url=t),e!=null&&(r.width=Si(e)),n!=null&&(r.height=Si(n)),r}readHeight(t,e){return e.size||t}readWidth(t,e){return e.size||t}clone(){const t=new uV({angle:this.angle,height:this.height,url:this.url,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset});return t._set("source",Ze(this.source)),t}hash(){return`${super.hash()}.${this.height}.${this.url}.${this.width}`}};x([E({json:{write:!1}})],al.prototype,"color",void 0),x([mn({esriPMS:"picture-marker"},{readOnly:!0})],al.prototype,"type",void 0),x([E(Z1e)],al.prototype,"url",void 0),x([E(J1e)],al.prototype,"source",void 0),x([E({type:Number,cast:Si,json:{write:!0}})],al.prototype,"height",void 0),x([cr("height",["height","size"])],al.prototype,"readHeight",null),x([E({type:Number,cast:Si,json:{write:!0}})],al.prototype,"width",void 0),x([E({json:{write:!1}})],al.prototype,"size",void 0),al=uV=x([ue("esri.symbols.PictureMarkerSymbol")],al);var cy;const Q1e=Ot.ofType({base:null,key:"type",typeMap:{icon:so,object:ro,text:bs}});let cd=cy=class extends ul{constructor(t){super(t),this.verticalOffset=null,this.callout=null,this.symbolLayers=new Q1e,this.type="point-3d"}supportsCallout(){if((this.symbolLayers?this.symbolLayers.length:0)<1)return!1;for(const t of this.symbolLayers.items)switch(t.type){case"icon":case"text":case"object":continue;default:return!1}return!0}hasVisibleCallout(){return W1e(this)}hasVisibleVerticalOffset(){return FW(this)}clone(){return new cy({verticalOffset:Ze(this.verticalOffset),callout:Ze(this.callout),styleOrigin:Ze(this.styleOrigin),symbolLayers:Ze(this.symbolLayers),thumbnail:Ze(this.thumbnail)})}static fromSimpleMarkerSymbol(t){return new cy({symbolLayers:new Ot([so.fromSimpleMarkerSymbol(t)])})}static fromPictureMarkerSymbol(t){return new cy({symbolLayers:new Ot([so.fromPictureMarkerSymbol(t)])})}static fromCIMSymbol(t){if(t.data?.symbol?.type!=="CIMPointSymbol")return null;const n=t.data.symbol;return new cy(n?.callout?{symbolLayers:new Ot([so.fromCIMSymbol(t)]),callout:new Of({size:.5,color:new Jn([0,0,0])}),verticalOffset:new Wm({screenLength:40})}:{symbolLayers:new Ot([so.fromCIMSymbol(t)])})}static fromTextSymbol(t){return new cy({symbolLayers:new Ot([bs.fromTextSymbol(t)])})}};x([E({type:Wm,json:{write:!0}})],cd.prototype,"verticalOffset",void 0),x([E(H1e)],cd.prototype,"callout",void 0),x([E({type:Q1e,json:{origins:{"web-scene":{write:!0}}}})],cd.prototype,"symbolLayers",void 0),x([mn({PointSymbol3D:"point-3d"},{readOnly:!0})],cd.prototype,"type",void 0),cd=cy=x([ue("esri.symbols.PointSymbol3D")],cd);var MS;const eve=Ot.ofType({base:null,key:"type",typeMap:{extrude:Mf,fill:Ql,icon:so,line:cl,object:ro,text:bs,water:Nf}});let og=MS=class extends ul{constructor(t){super(t),this.symbolLayers=new eve,this.type="polygon-3d"}initialize(){const t=e=>{e.type==="line"&&jg(kt.getLogger(this),"LineSymbol3DLayer can not be used as a SymbolLayer with a PolygonSymbol3D symbol anymore.",{replacement:"Use FillSymbol3DLayer.outline instead.",version:"4.28"}),e.type==="text"&&jg(kt.getLogger(this),"TextSymbol3DLayer can not be used as a SymbolLayer with a PolygonSymbol3D symbol anymore.",{replacement:"Use Labels instead.",version:"4.28"})};for(const e of this.symbolLayers)t(e);this.addHandles(H1(()=>this.symbolLayers,"after-add",({item:e})=>t(e),Ug))}clone(){return new MS({styleOrigin:Ze(this.styleOrigin),symbolLayers:Ze(this.symbolLayers),thumbnail:Ze(this.thumbnail)})}static fromJSON(t){const e=new MS;if(e.read(t),e.symbolLayers.length===2&&e.symbolLayers.at(0).type==="fill"&&e.symbolLayers.at(1).type==="line"){const n=e.symbolLayers.at(0),r=e.symbolLayers.at(1);!r.enabled||t.symbolLayers?.[1]&&t.symbolLayers[1].enable===!1||(n.outline={size:r.size,color:r.material!=null?r.material.color:null}),e.symbolLayers.removeAt(1)}return e}static fromSimpleFillSymbol(t){return new MS({symbolLayers:new Ot([Ql.fromSimpleFillSymbol(t)])})}};x([E({type:eve,json:{write:!0}})],og.prototype,"symbolLayers",void 0),x([mn({PolygonSymbol3D:"polygon-3d"},{readOnly:!0})],og.prototype,"type",void 0),og=MS=x([ue("esri.symbols.PolygonSymbol3D")],og);var hV;const i$=new Ys({esriSFSSolid:"solid",esriSFSNull:"none",esriSFSHorizontal:"horizontal",esriSFSVertical:"vertical",esriSFSForwardDiagonal:"forward-diagonal",esriSFSBackwardDiagonal:"backward-diagonal",esriSFSCross:"cross",esriSFSDiagonalCross:"diagonal-cross"});let Gf=hV=class extends Rx{constructor(...t){super(...t),this.color=new Jn([0,0,0,.25]),this.outline=new Ca,this.type="simple-fill",this.style="solid"}normalizeCtorArgs(t,e,n){if(t&&typeof t!="string")return t;const r={};return t&&(r.style=t),e&&(r.outline=e),n&&(r.color=n),r}clone(){return new hV({color:Ze(this.color),outline:this.outline&&this.outline.clone(),style:this.style})}hash(){return`${super.hash()}${this.style}.${this.color&&this.color.hash()}`}};x([E()],Gf.prototype,"color",void 0),x([E()],Gf.prototype,"outline",void 0),x([mn({esriSFS:"simple-fill"},{readOnly:!0})],Gf.prototype,"type",void 0),x([E({type:i$.apiValues,json:{read:i$.read,write:i$.write}})],Gf.prototype,"style",void 0),Gf=hV=x([ue("esri.symbols.SimpleFillSymbol")],Gf);var dV;const s$=new Ys({esriSMSCircle:"circle",esriSMSSquare:"square",esriSMSCross:"cross",esriSMSX:"x",esriSMSDiamond:"diamond",esriSMSTriangle:"triangle",esriSMSPath:"path"});let Zl=dV=class extends Lf{constructor(...t){super(...t),this.color=new Jn([255,255,255,.25]),this.type="simple-marker",this.size=12,this.style="circle",this.outline=new Ca}normalizeCtorArgs(t,e,n,r){if(t&&typeof t!="string")return t;const i={};return t&&(i.style=t),e!=null&&(i.size=Si(e)),n&&(i.outline=n),r&&(i.color=r),i}writeColor(t,e){t&&this.style!=="x"&&this.style!=="cross"&&(e.color=t.toJSON()),t===null&&(e.color=null)}set path(t){this.style="path",this._set("path",t)}clone(){return new dV({angle:this.angle,color:Ze(this.color),outline:this.outline&&this.outline.clone(),path:this.path,size:this.size,style:this.style,xoffset:this.xoffset,yoffset:this.yoffset})}hash(){return`${super.hash()}.${this.color&&this.color.hash()}.${this.path}.${this.style}.${this.outline?.hash()}`}};x([E()],Zl.prototype,"color",void 0),x([er("color")],Zl.prototype,"writeColor",null),x([mn({esriSMS:"simple-marker"},{readOnly:!0})],Zl.prototype,"type",void 0),x([E()],Zl.prototype,"size",void 0),x([E({type:s$.apiValues,json:{read:s$.read,write:s$.write}})],Zl.prototype,"style",void 0),x([E({type:String,json:{write:!0}})],Zl.prototype,"path",null),x([E({types:{key:"type",base:null,defaultKeyValue:"simple-line",typeMap:{"simple-line":Ca}},json:{default:null,write:!0}})],Zl.prototype,"outline",void 0),Zl=dV=x([ue("esri.symbols.SimpleMarkerSymbol")],Zl);var fV;let Yr=fV=class extends ds{constructor(...t){super(...t),this.backgroundColor=null,this.borderLineColor=null,this.borderLineSize=null,this.font=new qc,this.horizontalAlignment="center",this.kerning=!0,this.haloColor=null,this.haloSize=null,this.rightToLeft=null,this.rotated=!1,this.text="",this.type="text",this.verticalAlignment="baseline",this.xoffset=0,this.yoffset=0,this.angle=0,this.width=null,this.lineWidth=192,this.lineHeight=1}normalizeCtorArgs(t,e,n){if(t&&typeof t!="string")return t;const r={};return t&&(r.text=t),e&&(r.font=e),n&&(r.color=n),r}writeLineWidth(t,e,n,r){r&&typeof r!="string"?r.origin:e[n]=t}castLineWidth(t){return Si(t)}writeLineHeight(t,e,n,r){r&&typeof r!="string"?r.origin:e[n]=t}clone(){return new fV({angle:this.angle,backgroundColor:Ze(this.backgroundColor),borderLineColor:Ze(this.borderLineColor),borderLineSize:this.borderLineSize,color:Ze(this.color),font:this.font&&this.font.clone(),haloColor:Ze(this.haloColor),haloSize:this.haloSize,horizontalAlignment:this.horizontalAlignment,kerning:this.kerning,lineHeight:this.lineHeight,lineWidth:this.lineWidth,rightToLeft:this.rightToLeft,rotated:this.rotated,text:this.text,verticalAlignment:this.verticalAlignment,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset})}hash(){return`${this.backgroundColor?.hash()}.${this.borderLineColor}.${this.borderLineSize}.${this.color?.hash()}.${this.font&&this.font.hash()}.${this.haloColor?.hash()}.${this.haloSize}.${this.horizontalAlignment}.${this.kerning}.${this.rightToLeft}.${this.rotated}.${this.text}.${this.verticalAlignment}.${this.width}.${this.xoffset}.${this.yoffset}.${this.lineHeight}.${this.lineWidth}.${this.angle}`}};x([E({type:Jn,json:{write:!0}})],Yr.prototype,"backgroundColor",void 0),x([E({type:Jn,json:{write:!0}})],Yr.prototype,"borderLineColor",void 0),x([E({type:Number,json:{write:!0},cast:Si})],Yr.prototype,"borderLineSize",void 0),x([E({type:qc,json:{write:!0}})],Yr.prototype,"font",void 0),x([E({...G1e,json:{write:!0}})],Yr.prototype,"horizontalAlignment",void 0),x([E({type:Boolean,json:{write:!0}})],Yr.prototype,"kerning",void 0),x([E({type:Jn,json:{write:!0}})],Yr.prototype,"haloColor",void 0),x([E({type:Number,cast:Si,json:{write:!0}})],Yr.prototype,"haloSize",void 0),x([E({type:Boolean,json:{write:!0}})],Yr.prototype,"rightToLeft",void 0),x([E({type:Boolean,json:{write:!0}})],Yr.prototype,"rotated",void 0),x([E({type:String,json:{write:!0}})],Yr.prototype,"text",void 0),x([mn({esriTS:"text"},{readOnly:!0})],Yr.prototype,"type",void 0),x([E({...U1e,json:{write:!0}})],Yr.prototype,"verticalAlignment",void 0),x([E({type:Number,cast:Si,json:{write:!0}})],Yr.prototype,"xoffset",void 0),x([E({type:Number,cast:Si,json:{write:!0}})],Yr.prototype,"yoffset",void 0),x([E({type:Number,json:{read:t=>t&&-1*t,write:(t,e)=>e.angle=t&&-1*t}})],Yr.prototype,"angle",void 0),x([E({type:Number,json:{write:!0}})],Yr.prototype,"width",void 0),x([E({type:Number})],Yr.prototype,"lineWidth",void 0),x([er("lineWidth")],Yr.prototype,"writeLineWidth",null),x([qs("lineWidth")],Yr.prototype,"castLineWidth",null),x([E(z1e)],Yr.prototype,"lineHeight",void 0),x([er("lineHeight")],Yr.prototype,"writeLineHeight",null),Yr=fV=x([ue("esri.symbols.TextSymbol")],Yr);var pV;let ll=pV=class extends ds{constructor(t){super(t),this.color=null,this.styleName=null,this.portal=null,this.styleUrl=null,this.thumbnail=null,this.name=null,this.type="web-style"}get _fetchCacheKey(){const t=this.portal!=null?this.portal:it.getDefault(),e=t.user?t.user.username:null;return`${this.styleName}:${this.styleUrl}:${this.name}:${e}:${t.url}`}read(t,e){this.portal=e?.portal,super.read(t,e)}clone(){return new pV({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})}fetchSymbol(t){return this._fetchSymbol(t)}async fetchCIMSymbol(t){qfe(kt.getLogger(this),"WebStyleSymbol.fetchCIMSymbol is deprecated in favour of WebStyleSymbol.fetchSymbol which now supports both web and cim symbology",{version:"4.33",replacement:"WebStyleSymbol.fetchSymbol",see:"https://arcg.is/0CXPTr#fetchSymbol",warnOnce:!0});const e=await this._fetchSymbol({...t,acceptedFormats:["cim"]});if(e?.type!=="cim")throw new Xe("webstylesymbol:fetchCIMSymbol","Resolved web style symbol is not of type 'cim'");return e}async _fetchSymbol(t){const e=t!=null?t.cache:null,n=e?this._fetchCacheKey:null;if(e!=null){const o=n&&e.get(n);if(o)return o.clone()}const{resolveWebStyleSymbol:r}=await _e(()=>import("./webStyleSymbolUtils-Cy2vqOyb.js"),__vite__mapDeps([293,294,202,203,142,87,206]));pi(t);const i=r(this,{portal:this.portal},t);i.catch(o=>{kt.getLogger(this).error("#fetchSymbol()","Failed to create symbol from style",o)});const s=await i;return e?.set(n,s.clone()),s}};x([E({json:{write:!1}})],ll.prototype,"color",void 0),x([E({type:String,json:{write:!0}})],ll.prototype,"styleName",void 0),x([E({type:it,json:{write:!1}})],ll.prototype,"portal",void 0),x([E({type:String,json:{read:TO,write:v2}})],ll.prototype,"styleUrl",void 0),x([E({type:RT,json:{read:!1}})],ll.prototype,"thumbnail",void 0),x([E({type:String,json:{write:!0}})],ll.prototype,"name",void 0),x([mn({styleSymbolReference:"web-style"},{readOnly:!0})],ll.prototype,"type",void 0),x([E()],ll.prototype,"_fetchCacheKey",null),ll=pV=x([ue("esri.symbols.WebStyleSymbol")],ll);function E4t(t){if(!t)return!1;switch(t.type){case"picture-fill":case"picture-marker":case"simple-fill":case"simple-line":case"simple-marker":case"text":case"cim":return!0;default:return!1}}function S4t(t){switch(t?.type){case"label-3d":case"line-3d":case"mesh-3d":case"point-3d":case"polygon-3d":return!0;default:return!1}}const VW={base:ds,key:"type",typeMap:{"simple-fill":Gf,"picture-fill":il,"picture-marker":al,"simple-line":Ca,"simple-marker":Zl,text:Yr,"label-3d":od,"line-3d":sg,"mesh-3d":Uy,"point-3d":cd,"polygon-3d":og,"web-style":ll,cim:fl},errorContext:"symbol"},T4t={base:ds,key:"type",typeMap:{"picture-marker":al,"simple-marker":Zl,"point-3d":cd,cim:fl},errorContext:"symbol"},k4t={base:ds,key:"type",typeMap:{"simple-line":Ca,"line-3d":sg,cim:fl},errorContext:"symbol"},A4t={base:ds,key:"type",typeMap:{"simple-fill":Gf,"picture-fill":il,"polygon-3d":og,cim:fl},errorContext:"symbol"},I4t={base:ds,key:"type",typeMap:{"picture-marker":al,"simple-marker":Zl,text:Yr,"web-style":ll,cim:fl},errorContext:"symbol"},P4t=AB({types:VW}),C4t={base:ds,key:"type",typeMap:{"simple-fill":Gf,"picture-fill":il,"picture-marker":al,"simple-line":Ca,"simple-marker":Zl,text:Yr,"line-3d":sg,"mesh-3d":Uy,"point-3d":cd,"polygon-3d":og,"web-style":ll,cim:fl},errorContext:"symbol"},R4t={base:ds,key:"type",typeMap:{text:Yr,"label-3d":od},errorContext:"symbol"},M4t={base:ds,key:"type",typeMap:{"line-3d":sg,"mesh-3d":Uy,"point-3d":cd,"polygon-3d":og,"web-style":ll,cim:fl},errorContext:"symbol"},N4t={base:ds,key:"type",typeMap:{"label-3d":od},errorContext:"symbol"},O4t=Fg(VW);var mV;function OYe(t){if(!t)return null;const e={};for(const n in t){const r=C2(t[n]);r&&(e[n]=r)}return Object.keys(e).length!==0?e:null}function LYe(t){if(t==null)return null;const e={};for(const n in t){const r=t[n];r&&(e[n]=r.toJSON())}return Object.keys(e).length!==0?e:null}var Fw;let Qo=(Fw=class extends vo(qt){constructor(e){super(e),this.isAggregate=!1,this.layer=null,this.origin=null,this.sourceLayer=null,this._version=0,Object.defineProperty(this,"uid",{value:yM(),configurable:!0}),Object.defineProperty(this,"_lastMeshTransform",{value:{},configurable:!0,writable:!0,enumerable:!1}),arguments.length>1&&Fje(kt.getLogger(this),"Graphic",{version:"4.30"})}initialize(){this._watchMeshGeometryChanges()}set aggregateGeometries(e){const n=this._get("aggregateGeometries");JSON.stringify(n)!==JSON.stringify(e)&&this._set("aggregateGeometries",e)}set attributes(e){const n=this._get("attributes");n!==e&&(this._set("attributes",e),this._notifyLayer("attributes",n,e))}set geometry(e){const n=this._get("geometry");n!==e&&(this._set("geometry",e),e?.type!=="mesh"&&this._notifyLayer("geometry",n,e))}set popupTemplate(e){const n=this._get("popupTemplate");n!==e&&(this._set("popupTemplate",e),this._notifyLayer("popupTemplate",n,e))}set symbol(e){const n=this._get("symbol");n!==e&&(this._set("symbol",e),this._notifyLayer("symbol",n,e))}get version(){return this._version}set visible(e){const n=this._get("visible");n!==e&&(this._set("visible",e),this._notifyLayer("visible",n,e))}cloneShallow(){return new mV({aggregateGeometries:this.aggregateGeometries,attributes:this.attributes,geometry:this.geometry,isAggregate:this.isAggregate,layer:this.layer,popupTemplate:this.popupTemplate,sourceLayer:this.sourceLayer,symbol:this.symbol,visible:this.visible,origin:this.origin})}getEffectivePopupTemplate(e=!1){if(this.popupTemplate)return this.popupTemplate;const n=HKe(this.origin);if(n)return n.popupTemplate??(e?n.defaultPopupTemplate:null)??null;const r=this.origin&&"layer"in this.origin?this.origin.layer:null;for(const i of[r,this.sourceLayer,this.layer])if(i&&typeof i=="object"){if("popupTemplate"in i&&i.popupTemplate)return i.popupTemplate;if(e&&"defaultPopupTemplate"in i&&i.defaultPopupTemplate!=null)return i.defaultPopupTemplate}return null}getAttribute(e){return this.attributes?.[e]}setAttribute(e,n){if(this.attributes){const r=this.getAttribute(e);this.attributes[e]=n,this._notifyLayer("attributes",r,n,e)}else this.attributes={[e]:n}}getObjectId(){const e=One(this.origin);if(e)return Lne(this,e);const n=this.sourceLayer??this.layer;return n?Lne(this,n):null}getGlobalId(){const e=One(this.origin);if(e?.globalIdField)return this.getAttribute(e.globalIdField);const n=this.sourceLayer??this.layer;return n&&"globalIdField"in n&&n.globalIdField?this.getAttribute(n.globalIdField):null}toJSON(){return{aggregateGeometries:LYe(this.aggregateGeometries),geometry:this.geometry!=null?this.geometry.toJSON():null,symbol:this.symbol!=null?this.symbol.toJSON():null,attributes:P4(this.attributes)?this.attributes.toJSON():{...this.attributes},popupTemplate:this.popupTemplate?.toJSON()??null}}notifyMeshTransformChanged(e={}){const{geometry:n}=this;if(n?.type==="mesh"){const r={origin:n.origin,transform:n.transform};this._notifyLayer("origin-transform",r,r,e.action)}}_notifyLayer(e,n,r,i){if(this._version++,!this.layer||!("graphicChanged"in this.layer))return;const s={graphic:this,property:e,oldValue:n,newValue:r};e==="origin-transform"&&(s.action=i),e==="attributes"&&(s.attributeName=i),this.layer.graphicChanged(s)}_watchMeshGeometryChanges(){this.addHandles([wc(()=>this.geometry?.type==="mesh"&&this.geometry.vertexSpace.origin?{localMatrix:this.geometry.transform?.localMatrix,origin:this.geometry.vertexSpace.origin}:void 0,({localMatrix:e,origin:n})=>{this._lastMeshTransform.localMatrix===e&&this._lastMeshTransform.origin===n||(this._lastMeshTransform.localMatrix=e,this._lastMeshTransform.origin=n,this.notifyMeshTransformChanged())}),wc(()=>this.geometry?.type==="mesh"?{vertexAttributes:this.geometry.vertexAttributes}:void 0,()=>{const e=this.geometry;e?.type==="mesh"&&e.vertexSpace.origin?(this._lastMeshTransform.localMatrix=e.transform?.localMatrix,this._lastMeshTransform.origin=e.vertexSpace.origin):(this._lastMeshTransform.localMatrix=void 0,this._lastMeshTransform.origin=void 0),this._notifyLayer("geometry",this.geometry,this.geometry)},{equals:(e,n)=>e===n,sync:!0})])}},mV=Fw,Fw);x([E({value:null,json:{read:OYe}})],Qo.prototype,"aggregateGeometries",null),x([E({value:null})],Qo.prototype,"attributes",null),x([E({value:null,types:EW,json:{read:C2}})],Qo.prototype,"geometry",null),x([E({type:Boolean})],Qo.prototype,"isAggregate",void 0),x([E({clonable:!1})],Qo.prototype,"layer",void 0),x([E({clonable:"reference"})],Qo.prototype,"origin",void 0),x([E({type:UKe,value:null})],Qo.prototype,"popupTemplate",null),x([E({clonable:"reference"})],Qo.prototype,"sourceLayer",void 0),x([E({value:null,types:VW})],Qo.prototype,"symbol",null),x([E({clonable:!1,json:{read:!1,write:!1}})],Qo.prototype,"_version",void 0),x([E({type:Boolean,value:!0})],Qo.prototype,"visible",null),Qo=mV=x([ue("esri.Graphic")],Qo);let MT=class extends ET{_own(e){e.layer&&"remove"in e.layer&&e.layer!==this.owner&&e.layer.remove(e),e.layer=this.owner}_release(e){e.layer===this.owner&&(e.layer=null)}};x([Rpe({Type:Qo,ensureType:Ha(Qo)})],MT.prototype,"itemType",void 0),MT=x([ue("esri.support.GraphicsCollection")],MT);let Sf=class extends Kt{constructor(e){super(e),this.view=null,this.baseLayerViews=new Ot,this.groundLayerViews=new Ot,this.referenceLayerViews=new Ot,this._loadingHandle=fn(()=>this.view?.map?.basemap,n=>{n&&n.load().catch(()=>{})},ya)}destroy(){this._set("view",null),this._loadingHandle=ii(this._loadingHandle),this.baseLayerViews.destroyAll(),this.groundLayerViews.destroyAll(),this.referenceLayerViews.destroyAll()}get suspended(){return this.view?.suspended??!0}get updating(){return this.view?.suspended?!1:!!this.view?.map?.basemap?.loaded&&(this.baseLayerViews.some(n=>n.updating)||this.groundLayerViews.some(n=>n.updating)||this.referenceLayerViews.some(n=>n.updating))}};x([E({constructOnly:!0})],Sf.prototype,"view",void 0),x([E({readOnly:!0})],Sf.prototype,"baseLayerViews",void 0),x([E({readOnly:!0})],Sf.prototype,"groundLayerViews",void 0),x([E({readOnly:!0})],Sf.prototype,"referenceLayerViews",void 0),x([E({readOnly:!0})],Sf.prototype,"suspended",null),x([E({type:Boolean,readOnly:!0})],Sf.prototype,"updating",null),Sf=x([ue("esri.views.BasemapView")],Sf);const DYe=Sf;let Kl=class extends Kt{constructor(e){super(e),this.factor=1.5,this.offset=Hs(0,0),this.position=null,this.size=120,this.maskUrl=null,this.maskEnabled=!0,this.overlayUrl=null,this.overlayEnabled=!0,this.visible=!0}get version(){return this.commitProperty("factor"),this.commitProperty("offset"),this.commitProperty("position"),this.commitProperty("visible"),this.commitProperty("size"),this.commitProperty("maskUrl"),this.commitProperty("maskEnabled"),this.commitProperty("overlayUrl"),this.commitProperty("overlayEnabled"),(this._get("version")||0)+1}};x([E({type:Number})],Kl.prototype,"factor",void 0),x([E({nonNullable:!0})],Kl.prototype,"offset",void 0),x([E()],Kl.prototype,"position",void 0),x([E({type:Number,range:{min:0}})],Kl.prototype,"size",void 0),x([E()],Kl.prototype,"maskUrl",void 0),x([E()],Kl.prototype,"maskEnabled",void 0),x([E()],Kl.prototype,"overlayUrl",void 0),x([E()],Kl.prototype,"overlayEnabled",void 0),x([E({readOnly:!0})],Kl.prototype,"version",null),x([E({type:Boolean})],Kl.prototype,"visible",void 0),Kl=x([ue("esri.views.Magnifier")],Kl);const tve=Kl;let yw=class{constructor(e){this._observable=new _I,this._map=new Map(e)}get size(){return nn(this._observable),this._map.size}clear(){this._map.size>0&&(this._map.clear(),this._observable.notify())}delete(e){const n=this._map.delete(e);return n&&this._observable.notify(),n}entries(){return nn(this._observable),this._map.entries()}forEach(e,n){nn(this._observable),this._map.forEach((r,i)=>e.call(n,r,i,this),n)}get(e){return nn(this._observable),this._map.get(e)}has(e){return nn(this._observable),this._map.has(e)}keys(){return nn(this._observable),this._map.keys()}set(e,n){return this._map.set(e,n),this._observable.notify(),this}values(){return nn(this._observable),this._map.values()}[Symbol.iterator](){return nn(this._observable),this._map[Symbol.iterator]()}[Symbol.dispose](){this._observable.destroy()}get[Symbol.toStringTag](){return this._map[Symbol.toStringTag]}};var gV;let NS=gV=class extends qt{constructor(t){super(t),this.name=null,this.code=null}clone(){return new gV({name:this.name,code:this.code})}};x([E({type:String,json:{write:{isRequired:!0}}})],NS.prototype,"name",void 0),x([E({type:[String,Number],json:{write:{isRequired:!0}}})],NS.prototype,"code",void 0),NS=gV=x([ue("esri.layers.support.CodedValue")],NS);const jYe=new Ys({inherited:"inherited",codedValue:"coded-value",range:"range"});let ag=class extends qt{constructor(e){super(e),this.name=null,this.type=null}};x([E({type:String,json:{write:!0}})],ag.prototype,"name",void 0),x([mn(jYe),E({json:{write:{isRequired:!0}}})],ag.prototype,"type",void 0),ag=x([ue("esri.layers.support.Domain")],ag);var yV,Vw;let Mx=(Vw=class extends ag{constructor(e){super(e),this.codedValues=null,this.type="coded-value"}getName(e){let n=null;if(this.codedValues){const r=String(e);this.codedValues.some(i=>(String(i.code)===r&&(n=i.name),!!n))}return n}clone(){return new yV({codedValues:Ze(this.codedValues),name:this.name})}},yV=Vw,Vw);x([E({type:[NS],json:{write:{isRequired:!0}}})],Mx.prototype,"codedValues",void 0),x([mn({codedValue:"coded-value"})],Mx.prototype,"type",void 0),Mx=yV=x([ue("esri.layers.support.CodedValueDomain")],Mx);var vV,zw;let NT=(zw=class extends ag{constructor(e){super(e),this.type="inherited"}clone(){return new vV}},vV=zw,zw);x([mn({inherited:"inherited"})],NT.prototype,"type",void 0),NT=vV=x([ue("esri.layers.support.InheritedDomain")],NT);var _V,Gw;let Ay=(Gw=class extends ag{constructor(e){super(e),this.maxValue=null,this.minValue=null,this.type="range"}clone(){return new _V({maxValue:this.maxValue,minValue:this.minValue,name:this.name})}},_V=Gw,Gw);x([E({json:{type:[Number],read:{source:"range",reader:(t,e)=>e.range?.[1]},write:{enabled:!1,overridePolicy(){return{enabled:this.maxValue!=null&&this.minValue==null}},target:"range",writer(t,e,n){e[n]=[this.minValue||0,t]},isRequired:!0}}})],Ay.prototype,"maxValue",void 0),x([E({json:{type:[Number],read:{source:"range",reader:(t,e)=>e.range?.[0]},write:{target:"range",writer(t,e,n){e[n]=[t,this.maxValue||0]},isRequired:!0}}})],Ay.prototype,"minValue",void 0),x([mn({range:"range"})],Ay.prototype,"type",void 0),Ay=_V=x([ue("esri.layers.support.RangeDomain")],Ay);const $Ye={key:"type",base:ag,typeMap:{range:Ay,"coded-value":Mx,inherited:NT}};function FYe(t){if(!t?.type)return null;switch(t.type){case"range":return Ay.fromJSON(t);case"codedValue":return Mx.fromJSON(t);case"inherited":return NT.fromJSON(t)}return null}const VYe=new Ys({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml",esriFieldTypeBigInteger:"big-integer",esriFieldTypeDateOnly:"date-only",esriFieldTypeTimeOnly:"time-only",esriFieldTypeTimestampOffset:"timestamp-offset"});var xV;const zYe=new Ys({binary:"binary",coordinate:"coordinate",countOrAmount:"count-or-amount",currency:"currency",dateAndTime:"date-and-time",description:"description",emailAddress:"email-address",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",phoneNumber:"phone-number",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"});var Uw;let Yo=(Uw=class extends qt{constructor(e){super(e),this.alias=null,this.defaultValue=void 0,this.description=null,this.domain=null,this.editable=!0,this.length=void 0,this.name=null,this.nullable=!0,this.type=null,this.valueType=null,this.visible=!0}readDescription(e,{description:n}){let r=null;try{r=n?JSON.parse(n):null}catch{}return r?.value??null}readValueType(e,{description:n}){let r=null;try{r=n?JSON.parse(n):null}catch{}return r?zYe.fromJSON(r.fieldValueType):null}clone(){return new xV({alias:this.alias,defaultValue:this.defaultValue,description:this.description,domain:this.domain?.clone()??null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type,valueType:this.valueType,visible:this.visible})}},xV=Uw,Uw);x([E({type:String,json:{write:!0}})],Yo.prototype,"alias",void 0),x([E({type:[String,Number],json:{write:{allowNull:!0}}})],Yo.prototype,"defaultValue",void 0),x([E()],Yo.prototype,"description",void 0),x([cr("description")],Yo.prototype,"readDescription",null),x([E({types:$Ye,json:{read:{reader:FYe},write:!0}})],Yo.prototype,"domain",void 0),x([E({type:Boolean,json:{write:!0}})],Yo.prototype,"editable",void 0),x([E({type:Dr,json:{write:{overridePolicy:t=>({enabled:Number.isFinite(t)})}}})],Yo.prototype,"length",void 0),x([E({type:String,json:{write:!0}})],Yo.prototype,"name",void 0),x([E({type:Boolean,json:{write:!0}})],Yo.prototype,"nullable",void 0),x([mn(VYe)],Yo.prototype,"type",void 0),x([E()],Yo.prototype,"valueType",void 0),x([cr("valueType",["description"])],Yo.prototype,"readValueType",null),x([E({type:Boolean,json:{read:!1}})],Yo.prototype,"visible",void 0),Yo=xV=x([ue("esri.layers.support.Field")],Yo);var wV;let rx=wV=class extends qt{constructor(t){super(t),this.type="map-layer"}clone(){const{mapLayerId:t,gdbVersion:e}=this;return new wV({mapLayerId:t,gdbVersion:e})}};x([mn({mapLayer:"map-layer"}),E({json:{write:{isRequired:!0}}})],rx.prototype,"type",void 0),x([E({type:Dr,json:{write:{isRequired:!0}}})],rx.prototype,"mapLayerId",void 0),x([E({type:String,json:{write:!0}})],rx.prototype,"gdbVersion",void 0),rx=wV=x([ue("esri.layers.support.source.MapLayerSource")],rx);var bV;let Tf=bV=class extends qt{constructor(t){super(t),this.type="query-table"}clone(){const{workspaceId:t,query:e,oidFields:n,spatialReference:r,geometryType:i}=this,s={workspaceId:t,query:e,oidFields:n,spatialReference:r?.clone()??void 0,geometryType:i};return new bV(s)}};x([mn({queryTable:"query-table"}),E({json:{write:{isRequired:!0}}})],Tf.prototype,"type",void 0),x([E({type:String,json:{write:!0}})],Tf.prototype,"workspaceId",void 0),x([E({type:String,json:{write:!0}})],Tf.prototype,"query",void 0),x([E({type:String,json:{write:!0}})],Tf.prototype,"oidFields",void 0),x([E({type:Bt,json:{write:!0}})],Tf.prototype,"spatialReference",void 0),x([mn(wWe)],Tf.prototype,"geometryType",void 0),Tf=bV=x([ue("esri.layers.support.source.QueryTableDataSource")],Tf);var EV;let ix=EV=class extends qt{constructor(t){super(t),this.type="raster"}clone(){const{workspaceId:t,dataSourceName:e}=this;return new EV({workspaceId:t,dataSourceName:e})}};x([mn({raster:"raster"}),E({json:{write:{isRequired:!0}}})],ix.prototype,"type",void 0),x([E({type:String,json:{write:!0}})],ix.prototype,"dataSourceName",void 0),x([E({type:String,json:{write:!0}})],ix.prototype,"workspaceId",void 0),ix=EV=x([ue("esri.layers.support.source.RasterDataSource")],ix);var SV;let uy=SV=class extends qt{constructor(t){super(t),this.type="table"}clone(){const{workspaceId:t,gdbVersion:e,dataSourceName:n}=this;return new SV({workspaceId:t,gdbVersion:e,dataSourceName:n})}};x([mn({table:"table"}),E({json:{write:{isRequired:!0}}})],uy.prototype,"type",void 0),x([E({type:String,json:{write:!0}})],uy.prototype,"workspaceId",void 0),x([E({type:String,json:{write:!0}})],uy.prototype,"gdbVersion",void 0),x([E({type:String,json:{write:!0}})],uy.prototype,"dataSourceName",void 0),uy=SV=x([ue("esri.layers.support.source.TableDataSource")],uy);var TV,kV;const GYe=Ol()({esriLeftInnerJoin:"left-inner-join",esriLeftOuterJoin:"left-outer-join"});let Yl=TV=class extends qt{constructor(t){super(t),this.type="join-table"}readLeftTableSource(t,e,n){return Vne()(t,e,n)}castLeftTableSource(t){return Fg(AV(),t)}readRightTableSource(t,e,n){return Vne()(t,e,n)}castRightTableSource(t){return Fg(AV(),t)}clone(){const{leftTableKey:t,rightTableKey:e,leftTableSource:n,rightTableSource:r,joinType:i}=this,s={leftTableKey:t,rightTableKey:e,leftTableSource:n?.clone()??void 0,rightTableSource:r?.clone()??void 0,joinType:i};return new TV(s)}};x([mn({joinTable:"join-table"}),E({json:{write:{isRequired:!0}}})],Yl.prototype,"type",void 0),x([E({type:String,json:{write:!0}})],Yl.prototype,"leftTableKey",void 0),x([E({type:String,json:{write:!0}})],Yl.prototype,"rightTableKey",void 0),x([E({json:{write:!0}})],Yl.prototype,"leftTableSource",void 0),x([cr("leftTableSource")],Yl.prototype,"readLeftTableSource",null),x([qs("leftTableSource")],Yl.prototype,"castLeftTableSource",null),x([E({json:{write:!0}})],Yl.prototype,"rightTableSource",void 0),x([cr("rightTableSource")],Yl.prototype,"readRightTableSource",null),x([qs("rightTableSource")],Yl.prototype,"castRightTableSource",null),x([mn(GYe)],Yl.prototype,"joinType",void 0),Yl=TV=x([ue("esri.layers.support.source.JoinTableDataSource")],Yl);let o$=null;function Vne(){return o$||(o$=AB({types:AV()})),o$}let a$=null;function AV(){return a$||(a$={key:"type",base:null,typeMap:{"data-layer":Df,"map-layer":rx}}),a$}const UYe={key:"type",base:null,typeMap:{"join-table":Yl,"query-table":Tf,raster:ix,table:uy}};var Bw;let Df=(Bw=class extends qt{constructor(e){super(e),this.type="data-layer"}clone(){const{fields:e,dataSource:n}=this;return new kV({fields:e,dataSource:n})}},kV=Bw,Bw);x([mn({dataLayer:"data-layer"}),E({json:{write:{isRequired:!0}}})],Df.prototype,"type",void 0),x([E({type:[Yo],json:{write:!0}})],Df.prototype,"fields",void 0),x([E({types:UYe,json:{write:!0}})],Df.prototype,"dataSource",void 0),Df=kV=x([ue("esri.layers.support.source.DataLayerSource")],Df),Df.from=Ha(Df);let hy=class extends vo(qt){constructor(e){super(e),this.onFields=null,this.operator=null,this.searchTerm=null,this.searchType=null}};x([E({type:[String],json:{write:{enabled:!0,overridePolicy(){return{enabled:this.onFields!=null&&this.onFields.length>0}}}}})],hy.prototype,"onFields",void 0),x([E({type:String,json:{write:!0}})],hy.prototype,"operator",void 0),x([E({type:String,json:{write:!0}})],hy.prototype,"searchTerm",void 0),x([E({type:String,json:{write:!0}})],hy.prototype,"searchType",void 0),hy=x([ue("esri.rest.support.FullTextSearch")],hy);const BYe=hy;var IV;const zne=new Ys({upperLeft:"upper-left",lowerLeft:"lower-left"});let $m=IV=class extends qt{constructor(t){super(t),this.extent=null,this.mode="view",this.originPosition="upper-left",this.tolerance=1}clone(){return new IV(Ze({extent:this.extent,mode:this.mode,originPosition:this.originPosition,tolerance:this.tolerance}))}};x([E({type:Vn,json:{write:{overridePolicy(){return{enabled:this.mode==="view"}}}}})],$m.prototype,"extent",void 0),x([E({type:["view","edit"],json:{write:!0}})],$m.prototype,"mode",void 0),x([E({type:String,json:{read:zne.read,write:zne.write}})],$m.prototype,"originPosition",void 0),x([E({type:Number,json:{write:{overridePolicy(){return{enabled:this.mode==="view"}}}}})],$m.prototype,"tolerance",void 0),$m=IV=x([ue("esri.rest.support.QuantizationParameters")],$m);const WYe=t=>{const e=t;let n=class extends e{};return n=x([ue("esri.rest.support.QueryMixin")],n),n},HYe=new Ys({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"});var PV;const Gne=new Ys({count:"count",sum:"sum",min:"min",max:"max",avg:"avg",stddev:"stddev",var:"var",exceedslimit:"exceedslimit",percentile_cont:"percentile-continuous",percentile_disc:"percentile-discrete",EnvelopeAggregate:"envelope-aggregate",CentroidAggregate:"centroid-aggregate",ConvexHullAggregate:"convex-hull-aggregate"});let Hu=PV=class extends qt{constructor(t){super(t),this.maxPointCount=void 0,this.maxRecordCount=void 0,this.maxVertexCount=void 0,this.onStatisticField=null,this.outStatisticFieldName=null,this.statisticType=null,this.statisticParameters=null}writeStatisticParameters(t,e){this.statisticType!=="percentile-continuous"&&this.statisticType!=="percentile-discrete"||(e.statisticParameters=Ze(t))}clone(){return new PV({maxPointCount:this.maxPointCount,maxRecordCount:this.maxRecordCount,maxVertexCount:this.maxVertexCount,onStatisticField:this.onStatisticField,outStatisticFieldName:this.outStatisticFieldName,statisticType:this.statisticType,statisticParameters:Ze(this.statisticParameters)})}};x([E({type:Number,json:{write:!0}})],Hu.prototype,"maxPointCount",void 0),x([E({type:Number,json:{write:!0}})],Hu.prototype,"maxRecordCount",void 0),x([E({type:Number,json:{write:!0}})],Hu.prototype,"maxVertexCount",void 0),x([E({type:String,json:{write:!0}})],Hu.prototype,"onStatisticField",void 0),x([E({type:String,json:{write:!0}})],Hu.prototype,"outStatisticFieldName",void 0),x([E({type:String,json:{read:{source:"statisticType",reader:Gne.read},write:{target:"statisticType",writer:Gne.write}}})],Hu.prototype,"statisticType",void 0),x([E({type:Object})],Hu.prototype,"statisticParameters",void 0),x([er("statisticParameters")],Hu.prototype,"writeStatisticParameters",null),Hu=PV=x([ue("esri.rest.support.StatisticDefinition")],Hu);var o3;const qYe=new Ys({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});var p1;let tn=(p1=class extends WYe(qt){static from(e){return PO(o3,e)}constructor(e){super(e),this.aggregateIds=null,this.cacheHint=void 0,this.compactGeometryEnabled=!1,this.datumTransformation=null,this.defaultSpatialReferenceEnabled=!1,this.distance=void 0,this.dynamicDataSource=void 0,this.formatOf3DObjects=null,this.fullText=null,this.gdbVersion=null,this.geometry=null,this.geometryPrecision=void 0,this.groupByFieldsForStatistics=null,this.having=null,this.historicMoment=null,this.maxAllowableOffset=void 0,this.maxRecordCountFactor=1,this.multipatchOption=null,this.num=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.outStatistics=null,this.parameterValues=null,this.pixelSize=null,this.quantizationParameters=null,this.rangeValues=null,this.relationParameter=null,this.resultType=null,this.returnCentroid=!1,this.returnDistinctValues=!1,this.returnExceededLimitFeatures=!0,this.returnGeometry=!1,this.returnQueryGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.returnTrueCurves=void 0,this.sourceSpatialReference=null,this.spatialRelationship="intersects",this.start=void 0,this.sqlFormat=null,this.text=null,this.timeExtent=null,this.timeReferenceUnknownClient=!1,this.units=null,this.where=null}castDatumTransformation(e){return typeof e=="number"||typeof e=="object"?e:null}writeHistoricMoment(e,n){n.historicMoment=e&&e.getTime()}writeParameterValues(e,n){if(e){const r={};for(const i in e){const s=e[i];Array.isArray(s)?r[i]=s.map(o=>o instanceof Date?o.getTime():o):s instanceof Date?r[i]=s.getTime():r[i]=s}n.parameterValues=r}}writeStart(e,n){n.resultOffset=this.start,n.resultRecordCount=this.num||10,n.where="1=1"}writeWhere(e,n){n.where=e||"1=1"}clone(){return new o3(Ze({aggregateIds:this.aggregateIds,cacheHint:this.cacheHint,compactGeometryEnabled:this.compactGeometryEnabled,datumTransformation:this.datumTransformation,defaultSpatialReferenceEnabled:this.defaultSpatialReferenceEnabled,distance:this.distance,fullText:this.fullText,formatOf3DObjects:this.formatOf3DObjects,gdbVersion:this.gdbVersion,geometry:this.geometry,geometryPrecision:this.geometryPrecision,groupByFieldsForStatistics:this.groupByFieldsForStatistics,having:this.having,historicMoment:this.historicMoment!=null?new Date(this.historicMoment):null,maxAllowableOffset:this.maxAllowableOffset,maxRecordCountFactor:this.maxRecordCountFactor,multipatchOption:this.multipatchOption,num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,outStatistics:this.outStatistics,parameterValues:this.parameterValues,pixelSize:this.pixelSize,quantizationParameters:this.quantizationParameters,rangeValues:this.rangeValues,relationParameter:this.relationParameter,resultType:this.resultType,returnDistinctValues:this.returnDistinctValues,returnGeometry:this.returnGeometry,returnCentroid:this.returnCentroid,returnExceededLimitFeatures:this.returnExceededLimitFeatures,returnQueryGeometry:this.returnQueryGeometry,returnM:this.returnM,returnZ:this.returnZ,returnTrueCurves:this.returnTrueCurves,dynamicDataSource:this.dynamicDataSource,sourceSpatialReference:this.sourceSpatialReference,spatialRelationship:this.spatialRelationship,start:this.start,sqlFormat:this.sqlFormat,text:this.text,timeExtent:this.timeExtent,timeReferenceUnknownClient:this.timeReferenceUnknownClient,units:this.units,where:this.where}))}},o3=p1,p1.MAX_MAX_RECORD_COUNT_FACTOR=5,p1);x([E({json:{write:!0}})],tn.prototype,"aggregateIds",void 0),x([E({type:Boolean,json:{write:!0}})],tn.prototype,"cacheHint",void 0),x([E({type:Boolean,json:{default:!1,write:!0}})],tn.prototype,"compactGeometryEnabled",void 0),x([E({json:{write:!0}})],tn.prototype,"datumTransformation",void 0),x([qs("datumTransformation")],tn.prototype,"castDatumTransformation",null),x([E({type:Boolean,json:{default:!1,write:!0}})],tn.prototype,"defaultSpatialReferenceEnabled",void 0),x([E({type:Number,json:{write:!0}})],tn.prototype,"distance",void 0),x([E({type:Df,json:{write:!0}})],tn.prototype,"dynamicDataSource",void 0),x([E({type:String,json:{write:!0}})],tn.prototype,"formatOf3DObjects",void 0),x([E({type:[BYe],json:{write:{enabled:!0,overridePolicy(){return{enabled:this.fullText!=null&&this.fullText.length>0}}}}})],tn.prototype,"fullText",void 0),x([E({type:String,json:{write:!0}})],tn.prototype,"gdbVersion",void 0),x([E({types:EW,json:{read:C2,write:!0}})],tn.prototype,"geometry",void 0),x([E({type:Number,json:{write:!0}})],tn.prototype,"geometryPrecision",void 0),x([E({type:[String],json:{write:!0}})],tn.prototype,"groupByFieldsForStatistics",void 0),x([E({type:String,json:{write:!0}})],tn.prototype,"having",void 0),x([E({type:Date})],tn.prototype,"historicMoment",void 0),x([er("historicMoment")],tn.prototype,"writeHistoricMoment",null),x([E({type:Number,json:{write:!0}})],tn.prototype,"maxAllowableOffset",void 0),x([E({type:Number,cast:t=>t<1?1:t>tn.MAX_MAX_RECORD_COUNT_FACTOR?tn.MAX_MAX_RECORD_COUNT_FACTOR:t,json:{write:{overridePolicy:t=>({enabled:t>1})}}})],tn.prototype,"maxRecordCountFactor",void 0),x([E({type:["xyFootprint"],json:{write:!0}})],tn.prototype,"multipatchOption",void 0),x([E({type:Number,json:{read:{source:"resultRecordCount"}}})],tn.prototype,"num",void 0),x([E({json:{write:!0}})],tn.prototype,"objectIds",void 0),x([E({type:[String],json:{write:!0}})],tn.prototype,"orderByFields",void 0),x([E({type:[String],json:{write:!0}})],tn.prototype,"outFields",void 0),x([E({type:Bt,json:{name:"outSR",write:!0}})],tn.prototype,"outSpatialReference",void 0),x([E({type:[Hu],json:{write:{enabled:!0,overridePolicy(){return{enabled:this.outStatistics!=null&&this.outStatistics.length>0}}}}})],tn.prototype,"outStatistics",void 0),x([E({json:{write:!0}})],tn.prototype,"parameterValues",void 0),x([er("parameterValues")],tn.prototype,"writeParameterValues",null),x([E({type:Jt,json:{write:!0}})],tn.prototype,"pixelSize",void 0),x([E({type:$m,json:{write:!0}})],tn.prototype,"quantizationParameters",void 0),x([E({type:[Object],json:{write:!0}})],tn.prototype,"rangeValues",void 0),x([E({type:String,json:{read:{source:"relationParam"},write:{target:"relationParam",overridePolicy(){return{enabled:this.spatialRelationship==="relation"}}}}})],tn.prototype,"relationParameter",void 0),x([E({type:String,json:{write:!0}})],tn.prototype,"resultType",void 0),x([E({type:Boolean,json:{default:!1,write:!0}})],tn.prototype,"returnCentroid",void 0),x([E({type:Boolean,json:{default:!1,write:!0}})],tn.prototype,"returnDistinctValues",void 0),x([E({type:Boolean,json:{default:!0,write:!0}})],tn.prototype,"returnExceededLimitFeatures",void 0),x([E({type:Boolean,json:{write:!0}})],tn.prototype,"returnGeometry",void 0),x([E({type:Boolean,json:{default:!1,write:!0}})],tn.prototype,"returnQueryGeometry",void 0),x([E({type:Boolean,json:{default:!1,write:!0}})],tn.prototype,"returnM",void 0),x([E({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],tn.prototype,"returnZ",void 0),x([E({type:Boolean,json:{write:!0}})],tn.prototype,"returnTrueCurves",void 0),x([E({type:Bt,json:{write:!0}})],tn.prototype,"sourceSpatialReference",void 0),x([mn(HYe,{ignoreUnknown:!1,name:"spatialRel"})],tn.prototype,"spatialRelationship",void 0),x([E({type:Number,json:{read:{source:"resultOffset"}}})],tn.prototype,"start",void 0),x([er("start"),er("num")],tn.prototype,"writeStart",null),x([E({type:String,json:{write:!0}})],tn.prototype,"sqlFormat",void 0),x([E({type:String,json:{write:!0}})],tn.prototype,"text",void 0),x([E({type:Pa,json:{write:!0}})],tn.prototype,"timeExtent",void 0),x([E({type:Boolean,json:{default:!1,write:!0}})],tn.prototype,"timeReferenceUnknownClient",void 0),x([mn(qYe,{ignoreUnknown:!1}),E({json:{write:{overridePolicy(t){return{enabled:!!t&&this.distance!=null}}}}})],tn.prototype,"units",void 0),x([E({type:String,json:{write:{overridePolicy(t){return{enabled:t!=null||this.start!=null&&this.start>0}}}}})],tn.prototype,"where",void 0),x([er("where")],tn.prototype,"writeWhere",null),tn=o3=x([ue("esri.rest.support.Query")],tn);function gm(t){return!(t==null||typeof t!="object"||!("createQuery"in t)||!t.createQuery)}let Gc=class extends vI{constructor(e){super(e),this._selectionMap=new yw,this._sources=new Ot,this._trashCan=[],this._layerEditHandles=new Ot,this._vizTaskId=0,this.view=null,this.showHighlight=!0,this.highlightName="default"}initialize(){this.addHandles([fn(()=>[this.view,this.showHighlight],()=>this._refreshVisualization()),fn(()=>this.view,e=>{e?.when().then(()=>this.syncSources())},ya),H1(()=>this.sources,"change",e=>{const n=this._selectionMap,r=[];for(const i of e.removed){const s=n.get(i);s&&(n.delete(i),s.highlightHandle?.remove(),r.push({layer:i,selection:[],added:[],removed:[...s.selection]}))}this._refreshListeners(),r.length&&this._onSelectionChange(r)},{onListenerAdd:()=>this._refreshListeners()})])}destroy(){this.clear(),this._layerEditHandles.drain(ii)}get selections(){return Array.from(this._selectionMap.entries()).map(e=>{const[n,r]=e;return{layer:n,selection:[...r.selection]}})}get count(){let e=0;for(const n of this._selectionMap.values())e+=n.selection.length;return e}get hasSelection(){return this.count>0}get sources(){return this._sources}set sources(e){Sd(e,this._sources)}syncSources(){const e=new Set,n=this.view?.map;if(!n)return;const r=i=>{zVe(i)?(i.layers?.forEach(r),i.tables?.forEach(r)):VVe(i)?(i.sublayers?.forEach(r),i.subtables?.forEach(r)):kte(i)?i.sublayers?.forEach(r):gm(i)&&e.add(i)};n.allLayers.forEach(r),n.allTables.forEach(r),this.sources=[...e]}async getSelectedFeatures(e,n={},r="layerView"){const{view:i,selections:s}=this;if(!i&&r==="layerView")return kt.getLogger(this).warn("Cannot query layer views without a view."),[];const o=(e?.length?s.filter(a=>e.includes(a.layer)):s).map(async a=>{const{layer:l,selection:c}=a;if(!c.length)return;const u=K_(l)?l.parent:l;if(u!=null){if(i&&r==="layerView"&&!Une(u)&&Bne(u)){const h=await i.whenLayerView(u).catch(()=>null);if(h)return Wne(h,c,n)}return Wne(u,c,n)}}).filter(m2);return(await Promise.all(o)).filter(m2)}updateSelection(e){const n=new Map;for(const[s,o]of this._selectionMap)n.set(s,[...o.selection]);let r=!1;const i=e.current.concat(e.added);for(const s of i){const o=s.sourceLayer,a=s.getObjectId();if(this.sources.includes(o)&&(gm(o)||K_(o))&&a!==null){const l=fI(n,o,()=>[]);l.includes(a)||(l.push(a),r=!0)}}for(const s of e.removed){const o=s.sourceLayer,a=s.getObjectId();if(this.sources.includes(o)&&(gm(o)||K_(o))&&a!==null){const l=n.get(o),c=l?.indexOf(a);c!==void 0&&c>=0&&(l?.splice(c,1),r=!0)}}if(r){const{_selectionMap:s,_trashCan:o}=this,a=[];for(const[l,c]of n){const u=s.get(l);u!==void 0&&o.push(u),s.set(l,{selection:c}),a.push({layer:l,selection:c,...LQ(u!==void 0?u.selection:[],c)})}this._onSelectionChange(a)}}setSelection(e,n){this._setSelection(e,n)}getSelection(e){return this._selectionMap.get(e)?.selection}appendToSelection(e,n){const r=this._selectionMap.get(e),i=r!==void 0?[...r.selection]:[];for(const s of n)i.includes(s)||i.push(s);this._setSelection(e,i)}removeFromSelection(e,n){const r=this._selectionMap.get(e);if(!r)return;const i=[];for(const s of r.selection)n.includes(s)||i.push(s);this._setSelection(e,i)}toggleInSelection(e,n){const r=this._selectionMap.get(e);if(!r||r.selection.length===0)return void this._setSelection(e,n);const i=new Set(r.selection),s=new Set(n),o=E$e(i,s);this._setSelection(e,Array.from(o))}clear(){const e=this._selectionMap.values();this._trashCan.push(...e);const n=[];for(const[r,i]of this._selectionMap.entries())n.push({layer:r,added:[],removed:[...i.selection],selection:[]});this._selectionMap.clear(),this._onSelectionChange(n)}_onSelectionChange(e){this._refreshVisualization(),this.emit("selection-change",{view:this.view,changes:e})}_refreshVisualization(){for(this._vizTaskId++;this._trashCan.length>0;)this._trashCan.pop()?.highlightHandle?.remove();if(this.view==null)return;const{sources:e,view:n,_selectionMap:r,showHighlight:i}=this,s=this._vizTaskId;for(const o of e){const a=r.get(o),l=K_(o)?o.parent:o;if(l!=null&&Bne(l)){if(Une(l))continue;n.whenLayerView(l).then(c=>{a?.highlightHandle?.remove(),a!=null&&i&&s===this._vizTaskId&&"highlight"in c&&typeof c.highlight=="function"&&a.selection.length>0&&(a.highlightHandle=c.highlight(a.selection,this.highlightName))}).catch(()=>{a?.highlightHandle?.remove()})}}}_refreshListeners(){this._layerEditHandles.drain(ii);const e=new Set(this.sources.map(n=>K_(n)?n.parent:n));for(const n of e)gm(n)&&"on"in n&&n.on&&this._layerEditHandles.push(n.on("edits",r=>this._onLayerEdit(r,n)))}_onLayerEdit(e,n){if(kte(n))this._onParentLayerEdit(e,n);else if(e.deletedFeatures.length&&this._selectionMap.has(n)){const r=[];e.deletedFeatures.forEach(({error:i,objectId:s})=>{s!=null&&i==null&&r.push(s)}),this.removeFromSelection(n,r)}}_onParentLayerEdit(e,n){const{deletedFeatures:r,edits:i,updatedFeatures:s}=e;if(i?.updateFeatures?.forEach(o=>{const a=o.getObjectId()??o.attributes[n.objectIdField];if(a==null||s.find(u=>u.objectId===a)?.error)return;const l=n.findSublayerForFeature(o);if(!gm(l))return;const c=n.sublayers.find(u=>!(!gm(u)||!this.getSelection(u)?.includes(a)));gm(c)&&c!==l&&(this.removeFromSelection(c,[a]),this.appendToSelection(l,[a]))}),r.length){const o=[];r.forEach(({error:a,objectId:l})=>{l!=null&&a==null&&o.push(l)}),n.sublayers.forEach(a=>{gm(a)&&this._selectionMap.has(a)&&this.removeFromSelection(a,o)})}}_setSelection(e,n){if(!this.sources.includes(e))throw new Error(`Cannot set selection on layer ${e.title} because it is not in 'sources'`);const r=this._selectionMap.get(e);if(r===void 0||!YYe(r,{selection:n})){r!==void 0&&this._trashCan.push(r),this._selectionMap.set(e,{selection:[...n]});const i={layer:e,selection:[...n],...LQ(r!==void 0?r.selection:[],n)};this._onSelectionChange([i])}}};x([E()],Gc.prototype,"_selectionMap",void 0),x([E()],Gc.prototype,"_sources",void 0),x([E({readOnly:!0,nonNullable:!0})],Gc.prototype,"selections",null),x([E({readOnly:!0,nonNullable:!0})],Gc.prototype,"count",null),x([E()],Gc.prototype,"view",void 0),x([E({readOnly:!0,nonNullable:!0})],Gc.prototype,"hasSelection",null),x([E()],Gc.prototype,"showHighlight",void 0),x([E()],Gc.prototype,"sources",null),x([E()],Gc.prototype,"highlightName",void 0),Gc=x([ue("esri.views.SelectionManager")],Gc);const Une=t=>K_(t)?t.parent?.isTable===!0:t.isTable,KYe=t=>t.layer!==void 0,Bne=t=>t?.when!==void 0,YYe=(t,e)=>{if(t==null&&e==null)return!0;if(t!=null&&e==null||t==null&&e!=null)return!1;if(t!=null&&e!=null&&t.selection!=null&&e.selection!=null){const n=[...t.selection],r=[...e.selection];if(n.length!==r.length)return!1;n.sort(),r.sort();for(let i=0;i<n.length;i++)if(n[i]!==r[i])return!1}return!0},Wne=async(t,e,n={})=>{let r;if(KYe(t)){const i=t;r=i===void 0?null:await i.queryFeatures(new tn({...n,objectIds:e})).then(s=>({data:s,layer:t.layer}))}else{const i=t;r=i===void 0?null:await i.queryFeatures(new tn({...n,objectIds:e})).then(s=>({data:s,layer:i}))}return r},XYe=Gc;let OS=class extends vo(Kt){constructor(e){super(e),this.accentColor=new Jn([255,127,0]),this.textColor=new Jn([255,255,255])}};x([E({type:Jn,nonNullable:!0})],OS.prototype,"accentColor",void 0),x([E({type:Jn,nonNullable:!0})],OS.prototype,"textColor",void 0),OS=x([ue("esri.views.Theme")],OS);const CV=OS,nve=["click","double-click","immediate-click","immediate-double-click","hold","drag","key-down","key-up","pointer-down","pointer-move","pointer-up","pointer-drag","mouse-wheel","pointer-enter","pointer-leave","gamepad","focus","blur"],rve={};function ive(t){return!!rve[t]}function ZYe(t){for(const e of t)if(!ive(e))return!1;return!0}nve.forEach(t=>{rve[t]=!0});let sve=class{constructor(e){this._handlers=new Map,this._counter=0,this._handlerCounts=new Map,this.view=e,this.inputManager=null}connect(e){e&&this.disconnect(),this.inputManager=e,this._handlers.forEach(({handler:n,priority:r},i)=>this.inputManager?.installHandlers(i,[n],r))}disconnect(){this.inputManager&&this._handlers.forEach((e,n)=>this.inputManager?.uninstallHandlers(n)),this.inputManager=null}destroy(){this.disconnect(),this._handlers.clear(),this.view=null}on(e,n,r,i){const s=Array.isArray(e)?e:e.split(",");if(!ZYe(s))return s.some(ive)&&console.error("Error: registering input events and other events on the view at the same time is not supported."),null;let o,a;Array.isArray(n)?a=n:(o=n,a=[]),typeof r=="function"?o=r:i=r,i=i??ip.DEFAULT;const l=this._createUniqueGroupName(),c=new JYe(this.view,s,a,o);this._handlers.set(l,{handler:c,priority:i});for(const u of s){const h=this._handlerCounts.get(u)||0;this._handlerCounts.set(u,h+1)}return this.inputManager&&this.inputManager.installHandlers(l,[c],i),Zn(()=>this._removeHandler(l,s))}hasHandler(e){return!!this._handlerCounts.get(e)}_removeHandler(e,n){if(this._handlers.has(e)){this._handlers.delete(e);for(const r of n){const i=this._handlerCounts.get(r);i===void 0||(i===1?this._handlerCounts.delete(r):this._handlerCounts.set(r,i-1))}}this.inputManager&&this.inputManager.uninstallHandlers(e)}_createUniqueGroupName(){return this._counter+=1,`viewEvents_${this._counter}`}},JYe=class extends Zs{constructor(e,n,r,i){super(!0),this._latestDragStart=void 0,this.view=e;for(const s of n)switch(s){case"click":this.registerIncoming("click",r,o=>i(tXe(e,o)));break;case"double-click":this.registerIncoming("double-click",r,o=>i(nXe(e,o)));break;case"immediate-click":this.registerIncoming("immediate-click",r,o=>i(rXe(e,o)));break;case"immediate-double-click":this.registerIncoming("immediate-double-click",r,o=>i(iXe(e,o)));break;case"hold":this.registerIncoming("hold",r,o=>i(sXe(e,o)));break;case"drag":this.registerIncoming("drag",r,o=>{const a=this._wrapDrag(o);a&&i(a)});break;case"key-down":this.registerIncoming("key-down",r,o=>i(oXe(o)));break;case"key-up":this.registerIncoming("key-up",r,o=>i(aXe(o)));break;case"pointer-down":this.registerIncoming("pointer-down",r,o=>i(GE(o,"pointer-down")));break;case"pointer-move":this.registerIncoming("pointer-move",r,o=>i(GE(o,"pointer-move")));break;case"pointer-up":this.registerIncoming("pointer-up",r,o=>i(GE(o,"pointer-up")));break;case"pointer-drag":this.registerIncoming("pointer-drag",r,o=>i(lXe(o)));break;case"mouse-wheel":this.registerIncoming("mouse-wheel",r,o=>i(cXe(o)));break;case"pointer-enter":this.registerIncoming("pointer-enter",r,o=>i(GE(o,"pointer-enter")));break;case"pointer-leave":this.registerIncoming("pointer-leave",r,o=>i(GE(o,"pointer-leave")));break;case"gamepad":this.registerIncoming("gamepad",r,o=>{i(uXe(o))});break;case"focus":this.registerIncoming("focus",r,o=>{i(QYe(o))});break;case"blur":this.registerIncoming("blur",r,o=>{i(eXe(o))})}}_wrapDrag(e){const n=e.data,{x:r,y:i}=n.center,{action:s,pointerType:o,button:a}=n;if(s==="start"&&(this._latestDragStart=n),!this._latestDragStart)return;const l=n.pointer.native,c=n.buttons,{cancelable:u,timestamp:h}=e,f={x:this._latestDragStart.center.x,y:this._latestDragStart.center.y};return s==="end"&&(this._latestDragStart=void 0),{type:"drag",action:s,x:r,y:i,origin:f,pointerType:o,button:a,buttons:c,radius:n.radius,angle:Gge(n.angle),native:l,timestamp:h,cancelable:u,stopPropagation:()=>e.stopPropagation(),defer:g=>e.defer(g),preventDefault:()=>e.preventDefault()}}};function QYe(t){return{type:"focus",timestamp:t.timestamp,native:t.data.native,cancelable:t.cancelable,stopPropagation:()=>t.stopPropagation(),defer:e=>t.defer(e),preventDefault:()=>t.preventDefault()}}function eXe(t){return{type:"blur",timestamp:t.timestamp,native:t.data.native,cancelable:t.cancelable,stopPropagation:()=>t.stopPropagation(),defer:e=>t.defer(e),preventDefault:()=>t.preventDefault()}}function tXe(t,e){const{pointerType:n,button:r,buttons:i,x:s,y:o,native:a,eventId:l}=e.data,{cancelable:c,timestamp:u}=e;return{type:"click",pointerType:n,button:r,buttons:i,x:s,y:o,native:a,timestamp:u,screenPoint:Hs(s,o),mapPoint:DI(t,s,o),eventId:l,cancelable:c,stopPropagation:()=>e.stopPropagation(),defer:h=>e.defer(h),preventDefault:()=>e.preventDefault()}}function nXe(t,e){const{pointerType:n,button:r,buttons:i,x:s,y:o,native:a,eventId:l}=e.data,{cancelable:c,timestamp:u}=e;return{type:"double-click",pointerType:n,button:r,buttons:i,x:s,y:o,native:a,timestamp:u,mapPoint:DI(t,s,o),eventId:l,cancelable:c,stopPropagation:()=>e.stopPropagation(),defer:h=>e.defer(h),preventDefault:()=>e.preventDefault()}}function rXe(t,e){const{pointerType:n,button:r,buttons:i,x:s,y:o,native:a,eventId:l}=e.data,c=a.pointerId,{cancelable:u,timestamp:h}=e;return{type:"immediate-click",pointerId:c,pointerType:n,button:r,buttons:i,x:s,y:o,native:a,timestamp:h,mapPoint:DI(t,s,o),eventId:l,cancelable:u,stopPropagation:()=>e.stopPropagation(),defer:f=>e.defer(f),preventDefault:()=>e.preventDefault()}}function iXe(t,e){const{pointerType:n,button:r,buttons:i,x:s,y:o,native:a,eventId:l}=e.data,c=a.pointerId,{cancelable:u,timestamp:h}=e;return{type:"immediate-double-click",pointerId:c,pointerType:n,button:r,buttons:i,x:s,y:o,native:a,timestamp:h,mapPoint:DI(t,s,o),eventId:l,cancelable:u,stopPropagation:()=>e.stopPropagation(),defer:f=>e.defer(f),preventDefault:()=>e.preventDefault()}}function sXe(t,e){const{pointerType:n,button:r,buttons:i,x:s,y:o,native:a}=e.data,{cancelable:l,timestamp:c}=e;return{type:"hold",pointerType:n,button:r,buttons:i,x:s,y:o,native:a,timestamp:c,mapPoint:DI(t,s,o),cancelable:l,stopPropagation:()=>e.stopPropagation(),defer:u=>e.defer(u),preventDefault:()=>e.preventDefault()}}function DI(t,e,n){return t.toMap(Hs(e,n),{exclude:[]})}function oXe(t){const{key:e,repeat:n,native:r}=t.data,{cancelable:i,timestamp:s}=t;return{type:"key-down",key:e,repeat:n,native:r,timestamp:s,cancelable:i,stopPropagation:()=>t.stopPropagation(),defer:o=>t.defer(o),preventDefault:()=>t.preventDefault()}}function aXe(t){const{key:e,native:n}=t.data,{cancelable:r,timestamp:i}=t;return{type:"key-up",key:e,native:n,timestamp:i,cancelable:r,stopPropagation:()=>t.stopPropagation(),defer:s=>t.defer(s),preventDefault:()=>t.preventDefault()}}function GE(t,e){const{x:n,y:r,button:i,buttons:s,native:o,eventId:a}=t.data,l=o.pointerId,c=o.pointerType,{cancelable:u,timestamp:h}=t;return{type:e,x:n,y:r,pointerId:l,pointerType:c,button:i,buttons:s,native:o,timestamp:h,eventId:a,cancelable:u,stopPropagation:()=>t.stopPropagation(),defer:f=>t.defer(f),preventDefault:()=>t.preventDefault()}}function lXe(t){const{x:e,y:n,buttons:r,native:i,eventId:s}=t.data.currentEvent,{button:o}=t.data.startEvent,a=t.data.startEvent.native.pointerId,l=t.data.startEvent.native.pointerType,c=t.data.action,u={x:t.data.startEvent.x,y:t.data.startEvent.y},{cancelable:h,timestamp:f}=t;return{type:"pointer-drag",x:e,y:n,pointerId:a,pointerType:l,button:o,buttons:r,action:c,origin:u,native:i,timestamp:f,eventId:s,cancelable:h,stopPropagation:()=>t.stopPropagation(),defer:g=>t.defer(g),preventDefault:()=>t.preventDefault()}}function cXe(t){const{cancelable:e,data:n,timestamp:r}=t,{x:i,y:s,deltaY:o,native:a}=n;return{type:"mouse-wheel",x:i,y:s,deltaY:o,native:a,timestamp:r,cancelable:e,stopPropagation:()=>t.stopPropagation(),defer:l=>t.defer(l),preventDefault:()=>t.preventDefault()}}function uXe(t){const{action:e,state:n,device:r}=t.data,{cancelable:i,timestamp:s}=t,{buttons:o,axes:a}=n;return{type:"gamepad",device:r,timestamp:s,action:e,buttons:o,axes:a,cancelable:i,stopPropagation:()=>t.stopPropagation(),defer:l=>t.defer(l),preventDefault:()=>t.preventDefault()}}const hXe="z",dXe="r",ove={cancel:"Escape",complete:"Enter"},W4t={...ove,redo:dXe,undo:hXe,center:"Alt",constraint:"Shift",delete:["Backspace","Delete"],vertexAdd:"f",pan:" "},H4t={toggle:"Control"},q4t={enterInputMode:"Tab",commit:"Enter",discard:"Escape",next:"Tab"},K4t={moveUp:{key:"ArrowUp",modifier:"Shift",repeats:!0},moveDown:{key:"ArrowDown",modifier:"Shift",repeats:!0},moveLeft:{key:"ArrowLeft",modifier:"Shift",repeats:!0},moveRight:{key:"ArrowRight",modifier:"Shift",repeats:!0},scaleUp:{key:"+",modifier:"Shift"},scaleDown:{key:"-",modifier:"Shift"},factorModifier:{key:Kye,continuePropagation:!0},toggleOpacity:"t",preserveAspectRatio:{key:"Shift",continuePropagation:!0},rotateIncrements:{key:"Shift",continuePropagation:!0}};let Y4t=class{constructor(){this._bindings=new Map}add(e,n){return this.addToggle(e,r=>{r.type==="key-down"&&n(r)})}addToggle(e,n){const r=fXe.fromDefinition(e,n),i=fI(this._bindings,r.key,()=>[]);return i.push(r),Zn(()=>Jde(i,r))}register(e,n=ip.WIDGET){return fv([e.on("key-down",r=>this.dispatch(e.inputManager,r),n),e.on("key-up",r=>this.dispatch(e.inputManager,r),n)])}dispatch(e,n){const r=n.key,i=this._bindings.get(r);if(i)for(const s of i)s.process(e,n)}},fXe=class RV{constructor(e,n,r,i,s){this.key=e,this.modifiers=n,this.repeats=r,this.continuePropagation=i,this.callback=s}process(e,n){if(!(n.key!==this.key||"repeat"in n&&n.repeat&&!this.repeats)){for(const r of this.modifiers)if(!e.isModifierKeyDown(r))return;this.continuePropagation||n.stopPropagation(),this.callback(n)}}static fromDefinition(e,n){if(typeof e=="string")return new RV(e,[],!1,!1,n);const{key:r,modifier:i,repeats:s,continuePropagation:o}=e;return new RV(r,i?Array.isArray(i)?i:[i]:[],!!s,!!o,n)}};function pXe(t){return[t.on("before-add",e=>{const n=e.item;if(n==null||t.includes(n))return kt.getLogger("esri.views.interactive.interactiveToolUtils").warn("Tool is either already in the list of tools or tool is `null`. Not adding tool."),void e.preventDefault();n.onAdd()}),t.on("after-remove",e=>{const n=e.item;n.active&&(n.view.activeTool=null),n.destroy()})]}function MV(t){return t.visible&&t.getEditableFlag!=null&&t.getEditableFlag(0)&&t.getEditableFlag(1)}function mXe(t){return t.type==="key-down"&&t.key===ove.cancel}function Qh(t){return Hs(t.x,t.y)}function ave(t,e){const n=(t instanceof HTMLElement?t:t.surface)?.getBoundingClientRect();return n?Hs(e.clientX-n.left,e.clientY-n.top):Hs(0,0)}function lve(t,e){return e instanceof Event?ave(t,e):Qh(e)}function cve(t){if(t instanceof Event)return!0;if(typeof t=="object"&&"type"in t)switch(t.type){case"click":case"double-click":case"pointer-down":case"pointer-drag":case"pointer-enter":case"pointer-leave":case"pointer-up":case"pointer-move":case"immediate-click":case"immediate-double-click":case"hold":case"drag":case"mouse-wheel":return!0;default:return!1}return!1}let a3=class extends Kt{constructor(){super(...arguments),this._pointerLocations=new Map,this._hoveredManipulators=new yw,this._grabbedManipulators=new yw,this._draggedManipulators=new Map,this._stopDrag=!1,this._externallyDragging=!1,this._revertToNullActiveTool=!1}get cursor(){return this._cursorFromMap(this._grabbedManipulators,"grabbing")??this._cursorFromMap(this._hoveredManipulators,"pointer")}get hasFocusedManipulators(){return this._grabbedManipulators.size>0||this._draggedManipulators.size>0}handleInputEvent(e,n){const r=()=>e.stopPropagation();switch(e.type){case"pointer-move":Hne(e.pointerType)&&this._pointerLocations.set(e.pointerId,{x:e.x,y:e.y,pointerType:e.pointerType});break;case"drag":this._grabbedManipulators.size>0?this._stopDrag=!0:e.action==="start"?this._externallyDragging=!0:e.action==="end"&&(this._externallyDragging=!1),this._stopDrag&&(r(),e.action==="end"&&(this._stopDrag=!1));break;case"pointer-down":{if(!qne(e))break;const i=Qh(e),s=A_(i,e.pointerType,n.tools);if(s==null)break;const o=s.manipulator,a=s.tool;o==null||a==null||!o.interactive||o.grabbable&&o.grabbableForEvent(e)||!o.grabbing||o.dragging||this._releaseManipulatorBeforeDragging(o,e,n),o!=null&&a!=null&&o.interactive&&o.grabbable&&o.grabbableForEvent(e)&&!o.grabbing&&(this._grabbedManipulators.set(e.pointerId,{manipulator:o,tool:a,start:i,pointerType:e.pointerType}),this._grabbedManipulators.size===1&&n.activeTool==null&&(this._revertToNullActiveTool=!0,n.setActiveTool(s.tool)),o.grabbing=!0,o.events.emit("grab-changed",{action:"start",pointerType:e.pointerType,screenPoint:i}),r());break}case"pointer-up":this._draggedManipulators.has(e.pointerId)||this._handlePointerEnd(e,n);break;case"pointer-drag":{if(!qne(e))break;const i=this._grabbedManipulators.get(e.pointerId),s=i?.manipulator,o=i?.tool;if(s==null||o==null)break;const a=Qh(e);a.x=vu(a.x,0,n.view.width),a.y=vu(a.y,0,n.view.height);const l=i.start,c=this._draggedManipulators.get(e.pointerId);switch(e.action){case"start":case"update":e.action!=="update"&&this._grabbedManipulators.size!==1||(s.dragging=!0,c?s.events.emit("drag",{action:"update",start:l,screenPoint:a}):s.events.emit("drag",{action:"start",start:l,screenPoint:a,pointerType:e.pointerType}),this._draggedManipulators.set(e.pointerId,{tool:o,manipulator:s,start:l}));break;case"end":s.dragging=!1,c&&s.events.emit("drag",{action:"end",start:l,screenPoint:a}),this._draggedManipulators.delete(e.pointerId),this._handlePointerEnd(e,n)}r();break}case"immediate-click":{const i=Qh(e),s=A_(i,e.pointerType,n.tools);if(!gXe(e)){for(const c of n.tools)if((s==null||s.tool!==c||c.automaticManipulatorSelection)&&c.manipulators){let u=!1;c.manipulators.forEach(({manipulator:h})=>{h.selected&&(h.selected=!1,u=!0)}),u&&c.onManipulatorSelectionChanged&&c.onManipulatorSelectionChanged()}}if(s==null)break;const{manipulator:o,tool:a}=s;if(!o.interactive)break;o.selectable&&a.automaticManipulatorSelection&&(o.selected=!o.selected,a.onManipulatorSelectionChanged&&a.onManipulatorSelectionChanged());const l=e.native.shiftKey;o.events.emit("immediate-click",{screenPoint:i,button:e.button,pointerType:e.pointerType,shiftKey:l,stopPropagation:r}),l$(o,r);break}case"click":{const i=Qh(e),s=A_(i,e.pointerType,n.tools),o=s?.manipulator;if(o==null||!o.interactive)break;const a=e.native.shiftKey;o.events.emit(e.type,{screenPoint:i,button:e.button,pointerType:e.pointerType,shiftKey:a}),r();break}case"double-click":{const i=Qh(e),s=A_(i,e.pointerType,n.tools),o=s!=null?s.manipulator:null;if(o==null||!o.interactive)break;const a=e.native.shiftKey;o.events.emit("double-click",{screenPoint:i,button:e.button,pointerType:e.pointerType,shiftKey:a,stopPropagation:r}),l$(o,r);break}case"immediate-double-click":{const i=Qh(e),s=A_(i,e.pointerType,n.tools),o=s!=null?s.manipulator:null;if(o==null||!o.interactive)break;const a=e.native.shiftKey;o.events.emit("immediate-double-click",{screenPoint:i,button:e.button,pointerType:e.pointerType,shiftKey:a,stopPropagation:r}),e.pointerType==="mouse"&&l$(o,r);break}}this._onFocusChange(n.tools)}_releaseManipulatorBeforeDragging(e,n,r){e.grabbing=!1,e.events.emit("grab-changed",{action:"end",pointerType:n.pointerType,screenPoint:Qh(n)}),this._grabbedManipulators.forEach(({manipulator:i},s)=>{i===e&&this._grabbedManipulators.delete(s)}),this._afterManipulatorRelease(r.setActiveTool)}_handlePointerEnd(e,n){const r=this._grabbedManipulators.get(e.pointerId)?.manipulator;r!=null&&r.grabbing&&(r.grabbing=!1,r.events.emit("grab-changed",{action:"end",pointerType:e.pointerType,screenPoint:Qh(e)}),this._grabbedManipulators.delete(e.pointerId),this._afterManipulatorRelease(n.setActiveTool))}_onFocusChange(e){this._updateFocusedManipulatorTools(e)}_updateFocusedManipulatorTools(e){const n=new Set,r=new Set;this._grabbedManipulators.forEach(({tool:i})=>n.add(i)),this._hoveredManipulators.forEach(({tool:i})=>r.add(i));for(const i of e){i.hasGrabbedManipulators=n.has(i),i.hasHoveredManipulators=r.has(i);const s=this._grabbedManipulators.values(),o=Vje(s,({tool:a})=>a===i);i.firstGrabbedManipulator=o!=null?o.manipulator:null}}clearPointers(e,{tools:n,setActiveTool:r},i=!0,s){const o=(a,l)=>a===e&&(s==null||s===l);this._grabbedManipulators.forEach(({tool:a,manipulator:l,pointerType:c},u)=>{o(a,l)&&(this._grabbedManipulators.delete(u),l.grabbing=!1,l.events.emit("grab-changed",{action:"end",screenPoint:null,pointerType:c}))}),this._draggedManipulators.forEach(({tool:a,manipulator:l},c)=>{o(a,l)&&(this._draggedManipulators.delete(c),l.dragging=!1,l.events.emit("drag",{action:"cancel"}))}),i&&this._hoveredManipulators.forEach(({tool:a,manipulator:l},c)=>{o(a,l)&&(this._hoveredManipulators.delete(c),l.hovering=!1)}),this._afterManipulatorRelease(r),this._onFocusChange(n)}updateHoveredStateFromKnownPointers(e){this._pointerLocations.forEach((n,r)=>{this._updateHoveredStateForPointerAtScreenPosition(Hs(n.x,n.y),r,n.pointerType,e)})}handleHoverEvent(e,n){const r=e.type;r!=="pointer-up"&&r!=="immediate-click"&&r!=="pointer-move"||!Hne(e.pointerType)||(r!=="pointer-up"&&this._externallyDragging?this._clearHoveredManipulatorStates(e.pointerId):this._updateHoveredStateForPointerAtScreenPosition(Qh(e),e.pointerId,e.pointerType,n))}_updateHoveredStateForPointerAtScreenPosition(e,n,r,i){let s=A_(e,r,i);const o=this._hoveredManipulators.get(n)?.manipulator;s==null||s.manipulator.interactive||(s=null),s!=null&&o===s.manipulator||(o!=null&&(o.hovering=!1),s!=null?(s.manipulator.hovering=!0,this._hoveredManipulators.set(n,s)):this._hoveredManipulators.delete(n),this._onFocusChange(i))}_afterManipulatorRelease(e){this._grabbedManipulators.size===0&&this._revertToNullActiveTool&&(e(null),this._revertToNullActiveTool=!1)}_clearHoveredManipulatorStates(e){this._hoveredManipulators.forEach(({manipulator:n},r)=>{e===r&&(this._hoveredManipulators.delete(e),n.hovering=!1)})}_cursorFromMap(e,n){if(!e?.size)return null;for(const{manipulator:r}of e.values())if(r?.interactive){if(r.grabbing&&r.grabCursor)return r.grabCursor;if(r.cursor)return r.cursor}return n}};function A_(t,e,n){for(const r of n){if(r.manipulators==null||!MV(r))continue;const i=r.manipulators.intersect(t,e);if(i!=null)return{tool:r,manipulator:i}}return null}function Hne(t){return t==="mouse"}function qne(t){return t.pointerType!=="mouse"||t.button===0}function gXe(t){return!!t.native.shiftKey}function l$(t,e){t?.consumesClicks&&e()}x([E()],a3.prototype,"cursor",null),a3=x([ue("esri.views.interactive.ToolViewManagerManipulatorState")],a3);const Kne="attached",c$="tools",yXe=1e3;let ed=class extends Kt{constructor(e){super(e),this._updatingHandles=new a1,this._clock=sb,this._manipulatorState=new a3,this.tools=new Ot,this._interacting=!1,this._interactingTimeout=yXe,this._interactingTimeoutHandle=null}initialize(){this.addHandles([this.view.on(nve,e=>{this._handleInputEvent(e)},ip.TOOL),...pXe(this.tools),this.tools.on("before-add",({item:e})=>{this._updateToolEditableFlag(e)}),this.tools.on("before-remove",({item:e})=>{this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs)}),this.tools.on("change",()=>{this._refreshToolWatchers()})])}destroy(){this.activeTool=null,this.tools.drain(e=>e.destroy()),this._clearInteractingTimeout(),this._interacting=!1,this._updatingHandles.destroy(),this._manipulatorState.destroy()}get _manipulatorStateEventArgs(){return{tools:this.tools,activeTool:this.activeTool,setActiveTool:e=>{this.activeTool=e},view:this.view}}set activeTool(e){if(e!=null&&!this.view.ready)return void kt.getLogger(this).error("Cannot set active tool while view is not ready.");if(e===this.activeTool)return;const n=this.activeTool;this._set("activeTool",e),n?.deactivate(),e?.activate(),this._removeIncompleteTools(e);for(const r of this.tools){this._updateToolEditableFlag(r);const i=MV(r);this.activeTool!=null&&i||this._manipulatorState.clearPointers(r,this._manipulatorStateEventArgs,!i)}}get cursor(){const e=this._manipulatorState.cursor;if(e!=null)return e;for(const n of this.tools)if(n.visible&&n.cursor!=null)return n.cursor;return null}get updating(){return this._updatingHandles.updating||this.tools.some(e=>e.updating)}get interacting(){return this._interacting}_clearInteractingTimeout(){this._interactingTimeoutHandle=ii(this._interactingTimeoutHandle)}_startInteractingTimeout(){this._clearInteractingTimeout(),this._interactingTimeoutHandle=this._clock.setTimeout(()=>this._interacting=!1,this._interactingTimeout)}attach(){this.view.type==="3d"?this.addHandles([fn(()=>{const{state:e}=this.view;return"camera"in e&&e.camera},()=>this._forEachManipulator(e=>e.onViewChange())),this.view.elevationProvider.on("elevation-change",e=>this._forEachManipulator(n=>n.onElevationChange(e)))],Kne):this.addHandles(fn(()=>this.view.extent,()=>this._forEachManipulator(e=>e.onViewChange())))}detach(){this.activeTool=null,this.tools.removeAll(),this.removeHandles(Kne),this._clearInteractingTimeout(),this._interacting=!1}_forEachManipulator(e){for(const n of this.tools)n.manipulators&&n.manipulators.forEach(({manipulator:r})=>e(r,n))}_handleInputEvent(e){let n=!1;const r={...e,stopPropagation:()=>{n=!0,e.stopPropagation()}};if(this.activeTool!=null)this.activeTool.handleInputEvent&&this.activeTool.handleInputEvent(r);else for(const i of this.tools)!n&&i.visible&&i.handleInputEvent(r);!n&&mXe(e)&&this.activeTool&&(e.stopPropagation(),e.preventDefault(),this.activeTool.cancel(),this.activeTool=null),this._manipulatorState.handleInputEvent(r,this._manipulatorStateEventArgs),n||this.activeTool==null||this.activeTool.handleInputEventAfter(r),this._manipulatorState.handleHoverEvent(r,this.tools),e.type==="pointer-move"&&(this._manipulatorState.hasFocusedManipulators||this.activeTool)&&(this._interacting=!0,this._startInteractingTimeout())}_refreshToolWatchers(){this.removeHandles(c$);for(const e of this.tools){if(e instanceof Kt){const n=fn(()=>[e.cursor,e.visible,e.editable],()=>{MV(e)||this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs)});this.addHandles(n,c$)}e.manipulators&&this.addHandles([e.manipulators.on("after-remove",n=>{this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs,!0,n.item.manipulator)}),e.manipulators.on("change",()=>{this._manipulatorState.updateHoveredStateFromKnownPointers(this.tools)})],c$)}this._manipulatorState.updateHoveredStateFromKnownPointers(this.tools)}_updateToolEditableFlag(e){e.setEditableFlag?.(1,this.activeTool==null||e===this.activeTool)}_removeIncompleteTools(e){this.tools.filter(n=>(e==null||n!==e)&&!n.created&&n.removeIncompleteOnCancel).forEach(n=>{this.tools.remove(n)})}get test(){}};x([E({constructOnly:!0,nonNullable:!0})],ed.prototype,"view",void 0),x([E({value:null})],ed.prototype,"activeTool",null),x([E({readOnly:!0,type:Ot})],ed.prototype,"tools",void 0),x([E()],ed.prototype,"cursor",null),x([E({readOnly:!0})],ed.prototype,"updating",null),x([E()],ed.prototype,"_interacting",void 0),x([E({readOnly:!0})],ed.prototype,"interacting",null),ed=x([ue("esri.views.ToolViewManager")],ed);const vXe=new Jn("cyan"),_Xe=1,xXe=.25,wXe=new Jn("black"),bXe=.4,EXe=.2,Q4t=.25,uve="default",SXe="temporary",TXe=new Jn("yellow");var NV;let Xl=NV=class extends Kt{constructor(t){super(t),this.name=uve,this.color=vXe.clone(),this.haloColor=null,this.haloOpacity=_Xe,this.fillOpacity=xXe,this.shadowColor=wXe.clone(),this.shadowOpacity=bXe,this.shadowDifference=EXe,this.haloWidth=2.1,this.haloBlur=.8/this.haloWidth}equals(t){return this.color.equals(t.color)&&(this.haloColor||this.color).equals(t.haloColor||t.color)&&this.haloOpacity===t.haloOpacity&&this.fillOpacity===t.fillOpacity&&this.haloWidth===t.haloWidth&&this.haloBlur===t.haloBlur&&this.shadowColor.equals(t.shadowColor)&&this.shadowOpacity===t.shadowOpacity&&this.shadowDifference===t.shadowDifference}clone(){return new NV({...this,color:this.color.clone(),haloColor:this.haloColor?.clone(),shadowColor:this.shadowColor?.clone()})}assignFrom(t){this.color=t.color.clone(),this.haloColor=t.haloColor?.clone(),this.haloOpacity=t.haloOpacity,this.fillOpacity=t.fillOpacity,this.shadowColor=t.shadowColor.clone(),this.shadowDifference=t.shadowDifference,this.shadowOpacity=t.shadowOpacity,this.haloBlur=t.haloBlur,this.haloWidth=t.haloWidth}};x([E({type:String,constructOnly:!0,nonNullable:!0})],Xl.prototype,"name",void 0),x([E({type:Jn,nonNullable:!0})],Xl.prototype,"color",void 0),x([E({type:Jn})],Xl.prototype,"haloColor",void 0),x([E({nonNullable:!0})],Xl.prototype,"haloOpacity",void 0),x([E({nonNullable:!0})],Xl.prototype,"fillOpacity",void 0),x([E({type:Jn,nonNullable:!0})],Xl.prototype,"shadowColor",void 0),x([E({nonNullable:!0})],Xl.prototype,"shadowOpacity",void 0),x([E({nonNullable:!0})],Xl.prototype,"shadowDifference",void 0),x([E({nonNullable:!0})],Xl.prototype,"haloWidth",void 0),x([E({nonNullable:!0})],Xl.prototype,"haloBlur",void 0),Xl=NV=x([ue("esri.views.support.HighlightOptions")],Xl);const Sg=Xl;function kXe(){return new(Ot.ofType(Sg))([new Sg({name:uve}),new Sg({name:SXe,color:TXe})])}let sx=class extends Kt{constructor(e){super(),this.nativeIndex=null,this._detectedDeviceType="unknown",e.mapping==="standard"?this._detectedDeviceType="standard":AXe.test(e.id)?this._detectedDeviceType="spacemouse":this._detectedDeviceType="unknown",this.nativeIndex=e.index}get native(){const e=navigator.getGamepads?navigator.getGamepads():[];return this.nativeIndex!=null&&this.nativeIndex<e.length?e[this.nativeIndex]:null}get deviceType(){return this._detectedDeviceType}get axisThreshold(){return IXe[this.deviceType]}};x([E({nonNullable:!0,readOnly:!0})],sx.prototype,"nativeIndex",void 0),x([E({type:String,readOnly:!0})],sx.prototype,"deviceType",null),x([E({type:Number,readOnly:!0})],sx.prototype,"axisThreshold",null),sx=x([ue("esri.views.input.gamepad.GamepadInputDevice")],sx);const zW=sx,AXe=new RegExp("^(3dconnexion|space(mouse|navigator|pilot|explorer))","i"),IXe={standard:.15,spacemouse:.025,unknown:0};let LS=class extends Kt{constructor(e){super(e),this.devices=new Ot,this.enabledFocusMode="document"}};x([E({type:Ot.ofType(zW),readOnly:!0})],LS.prototype,"devices",void 0),x([E({type:["document","view","none"]})],LS.prototype,"enabledFocusMode",void 0),LS=x([ue("esri.views.input.gamepad.GamepadSettings")],LS);const PXe=LS;let l3=class extends Kt{constructor(){super(...arguments),this.gamepad=new PXe}};x([E({readOnly:!0})],l3.prototype,"gamepad",void 0),l3=x([ue("esri.views.input.Input")],l3);const CXe=l3,u$=()=>E({type:["pan","rotate","zoom","none"],nonNullable:!0});let dy=class extends Kt{constructor(e){super(e),this.dragPrimary="pan",this.dragSecondary="rotate",this.dragTertiary="zoom",this.mouseWheel="zoom"}};x([u$()],dy.prototype,"dragPrimary",void 0),x([u$()],dy.prototype,"dragSecondary",void 0),x([u$()],dy.prototype,"dragTertiary",void 0),x([E({type:["zoom","none"],nonNullable:!0})],dy.prototype,"mouseWheel",void 0),dy=x([ue("esri.views.navigation.NavigationActionMap")],dy);const GW=dy;let Am=class extends Kt{constructor(e){super(e),this.enabled=!0,this.device=null,this.mode="pan",this.tiltDirection="forward-down",this.velocityFactor=1}};x([E({type:Boolean,nonNullable:!0})],Am.prototype,"enabled",void 0),x([E({type:zW})],Am.prototype,"device",void 0),x([E({type:["pan","zoom"],nonNullable:!0})],Am.prototype,"mode",void 0),x([E({type:["forward-down","forward-up"],nonNullable:!0})],Am.prototype,"tiltDirection",void 0),x([E({type:Number,nonNullable:!0})],Am.prototype,"velocityFactor",void 0),Am=x([ue("esri.views.navigation.gamepad.GamepadSettings")],Am);const hve=Am;let Im=class extends Kt{constructor(e){super(e),this.actionMap=new GW,this.browserTouchPanEnabled=!0,this.gamepad=new hve,this.momentumEnabled=!0}get mouseWheelZoomEnabled(){return this.actionMap.mouseWheel==="zoom"}set mouseWheelZoomEnabled(e){Q8(kt.getLogger(this),"mouseWheelZoomEnabled",{replacement:"actionMap.mouseWheel",version:"4.32",warnOnce:!0}),this.actionMap.mouseWheel=e?"zoom":"none"}};x([E({type:GW,nonNullable:!0})],Im.prototype,"actionMap",void 0),x([E({type:Boolean})],Im.prototype,"browserTouchPanEnabled",void 0),x([E({type:hve,nonNullable:!0})],Im.prototype,"gamepad",void 0),x([E({type:Boolean})],Im.prototype,"momentumEnabled",void 0),x([E({type:Boolean})],Im.prototype,"mouseWheelZoomEnabled",null),Im=x([ue("esri.views.navigation.Navigation")],Im);const iL=Im;function oNt(t,e,n){const r=dve(t),i=e,s=RXe(r,i,n);if(r){const o=ol.deriveUnitFromSR(r,t.spatialReference).heightUnit;if(!n&&o!==r.heightUnit){const a=new Xe("layerview:unmatched-height-unit",`The vertical units of the layer must match the horizontal units (${o})`,{horizontalUnit:o});return new Xe("layerview:unsupported-height-model-info","The vertical coordinate system of the layer is not supported",{heightModelInfo:r,error:a})}}if(!MXe(t)||s===4)return new Xe("layerview:unsupported-height-model-info","The vertical coordinate system of the layer is not supported",{heightModelInfo:r});switch(s){case 1:{const o=r?.heightUnit||"unknown",a=i?.heightUnit||"unknown",l=new Xe("layerview:incompatible-height-unit",`The vertical units of the layer (${o}) must match the vertical units of the scene (${a})`,{layerUnit:o,sceneUnit:a});return new Xe("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:r,sceneHeightModelInfo:i,error:l})}case 2:{const o=r?.heightModel||"unknown",a=i?.heightModel||"unknown",l=new Xe("layerview:incompatible-height-model",`The height model of the layer (${o}) must match the height model of the scene (${a})`,{layerHeightModel:o,sceneHeightModel:a});return new Xe("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:r,sceneHeightModelInfo:i,error:l})}case 3:{const o=r?.vertCRS||"unknown",a=i?.vertCRS||"unknown",l=new Xe("layerview:incompatible-vertical-datum",`The vertical datum of the layer (${o}) must match the vertical datum of the scene (${a})`,{layerDatum:o,sceneDatum:a});return new Xe("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:r,sceneHeightModelInfo:i,error:l})}}return null}function RXe(t,e,n){if(!Yne(t)||!Yne(e))return 4;if(t==null||e==null)return 0;if(!n&&t.heightUnit!==e.heightUnit)return 1;if(t.heightModel!==e.heightModel)return 2;switch(t.heightModel){case"gravity-related-height":return 0;case"ellipsoidal":return t.vertCRS===e.vertCRS?0:3;default:return 4}}function Yne(t){return t==null||t.heightModel!=null&&t.heightUnit!=null}function MXe(t){return"heightModelInfo"in t&&t.heightModelInfo!=null||t.spatialReference!=null||!mve(t)}function dve(t){if(t.type==="integrated-mesh-3dtiles"||t.type==="gaussian-splat")return null;const e=t.url?mI(t.url):void 0;return!(t.spatialReference?.vcsWkid==null&&e!=null&&e.serverType==="ImageServer")&&fve(t)&&t.heightModelInfo?t.heightModelInfo:mve(t)?ol.deriveUnitFromSR(OXe,t.spatialReference):null}function fve(t){return"heightModelInfo"in t}function pve(t){if(t.type==="unknown"||!("capabilities"in t))return!1;switch(t.type){case"catalog":case"catalog-footprint":case"csv":case"feature":case"geojson":case"subtype-group":case"ogc-feature":case"oriented-imagery":case"wfs":case"knowledge-graph-sublayer":return!0;default:return!1}}function mve(t){return pve(t)?!!(t.capabilities&&t.capabilities.data&&t.capabilities.data.supportsZ):gve(t)}function NXe(t){return t.layers!=null||gve(t)||pve(t)||fve(t)}function gve(t){switch(t.type){case"building-scene":case"elevation":case"integrated-mesh":case"integrated-mesh-3dtiles":case"point-cloud":case"scene":case"voxel":return!0;case"base-dynamic":case"base-elevation":case"base-tile":case"bing-maps":case"catalog":case"catalog-footprint":case"catalog-dynamic-group":case"csv":case"dimension":case"gaussian-splat":case"geojson":case"feature":case"subtype-group":case"geo-rss":case"graphics":case"group":case"imagery":case"imagery-tile":case"kml":case"knowledge-graph":case"link-chart":case"knowledge-graph-sublayer":case"line-of-sight":case"map-image":case"map-notes":case"media":case"ogc-feature":case"open-street-map":case"oriented-imagery":case"parquet":case"route":case"stream":case"tile":case"unknown":case"unsupported":case"vector-tile":case"video":case"viewshed":case"wcs":case"web-tile":case"wfs":case"wms":case"wmts":case null:return!1}return!1}const OXe=new ol({heightModel:"gravity-related-height"});let OV,h$=null;async function LXe(t){h$||(h$=_e(()=>import("./geometryServiceUtils-BxsJkqOv.js"),__vite__mapDeps([295,296])).then(e=>OV=e)),await h$,pi(t)}async function yve(t,e,n,r){if(!t)return null;const i=t.spatialReference;return kp()||bh(i,e)?yv(t,e):OV?OV.projectGeometry(t,e,n,r):(await Promise.race([LXe(r),Bg(r)]),yve(t,e,n,r))}async function aNt(t,e){try{return t?.spatialReference?await Y0e(t,e):null}catch{return null}}let Kr=class extends Kt{constructor(e){super(e),this.required={extent:!1,heightModelInfo:!1,tileInfo:!1},this.defaultSpatialReference=null,this.userSpatialReference=null,this.sourcePreloadCount=10,this.priorityCollection=null,this.requiresExtentInSpatialReference=!0,this.suspended=!1,this._projectExtentTask={task:null,input:null,output:null,spatialReference:null}}destroy(){this._projectExtentTask.task&&(this._projectExtentTask.task=$1(this._projectExtentTask.task)),this._set("map",null)}get ready(){return!this._spatialReferenceTask.updating&&!this._tileInfoTask.updating&&!this._extentTask.updating}get heightModelInfoReady(){return!this._heightModelInfoTask.updating}get spatialReference(){return this.userSpatialReference??this._spatialReferenceTask.spatialReference}get extent(){return this._extentTask.extent}get heightModelInfo(){return this._heightModelInfoTask.heightModelInfo}get vcsWkid(){return this._heightModelInfoTask.vcsWkid}get latestVcsWkid(){return this._heightModelInfoTask.latestVcsWkid}get viewingMode(){return this.userSpatialReference==null||this.userSpatialReference.equals(this._spatialReferenceTask.spatialReference)?this._spatialReferenceTask.viewingMode:null}get tileInfo(){return this._tileInfoTask.tileInfo}get mapCollections(){const e=this.map?.(),n=[];return this.priorityCollection!=null&&n.push(this.priorityCollection),n.push({parent:e?.basemap,layers:e?.basemap?.baseLayers},{parent:e?.basemap,layers:e?.basemap?.groundLayers},{layers:e?.layers},{parent:e?.ground,layers:e?.ground?.layers},{parent:e?.basemap,layers:e?.basemap?.referenceLayers}),n}get _spatialReferenceTask(){if(this.suspended)return this._get("_spatialReferenceTask")??{updating:!1};let e;if(this._collectLayers(this.mapCollections,r=>{const i=this._getSupportedSpatialReferences(r);if(i.length>0){const s=this._narrowDownSpatialReferenceCandidates(e,i);s!=null&&(e=s)}return e?.length===1})&&e?.length!==1)return{updating:!0};const n=this._pickSpatialReferenceCandidate(e);return{spatialReference:n?.spatialReference??null,viewingMode:n?.viewingMode??null,updating:!1}}get _tileInfoTask(){if(!this.required.tileInfo)return this._get("_tileInfoTask")??{updating:!1};const e=this.map?.(),n=this.spatialReference;if(!n)return{updating:this._spatialReferenceTask.updating};let r;const i=this._collectLayers([{parent:e?.basemap,layers:e?.basemap?.baseLayers},{parent:e?.basemap,layers:e?.basemap?.groundLayers},{layers:e?.layers}],s=>!(!("tileInfo"in s)||!s.tileInfo?.spatialReference.equals(n))&&(r=s,!0),s=>"tileInfo"in s);return r?{tileInfo:r.tileInfo,updating:!1}:{updating:i}}get _heightModelInfoTask(){if(!this.required.heightModelInfo||this.suspended&&this._get("_heightModelInfoTask")?.heightModelInfo)return this._get("_heightModelInfoTask")??{updating:!1};let e={};const n=this._collectLayers(this.mapCollections,r=>{const i=dve(r);return!!i&&(e={heightModelInfo:i,vcsWkid:r.spatialReference?.vcsWkid,latestVcsWkid:r.spatialReference?.latestVcsWkid},!0)},r=>NXe(r));return{...e,updating:n}}get _extentCandidatesTask(){if(this.suspended||!this.required.extent)return this._get("_extentCandidatesTask")??{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const e=[],n=this._collectLayers(this.mapCollections,r=>{const i="fullExtents"in r&&r.fullExtents||(r.fullExtent!=null?[r.fullExtent]:[]),s=this.requiresExtentInSpatialReference?null:i[0],o=i.find(a=>a.spatialReference.equals(this.spatialReference))??s;if(o)return e.push({extent:o,layer:r}),!0;if(this._getSupportedSpatialReferences(r).length>0)for(const a of i)e.push({extent:a,layer:r});return!1});return{candidates:e,updating:n}}get _extentTask(){const{candidates:e,updating:n}=this._extentCandidatesTask;if(n)return{updating:n};if(e==null||e.length===0)return{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const r=this._pickExtentCandidate(e),i=this.spatialReference;return r.extent.equals(this._projectExtentTask.input)&&i.equals(this._projectExtentTask.spatialReference)?{extent:this._projectExtentTask.output,updating:this._projectExtentTask.task!=null&&!this._projectExtentTask.task.finished}:(this._projectExtentTask.task!=null&&(this._projectExtentTask.task=$1(this._projectExtentTask.task)),this._projectExtentTask={input:r.extent.clone(),output:null,spatialReference:i.clone(),task:MO(async s=>{try{const o=await yve(r.extent,i,"portalItem"in r.layer?r.layer.portalItem:void 0,s);this._projectExtentTask={...this._projectExtentTask,task:null,output:o}}catch{if(ma(s))return;this._projectExtentTask={...this._projectExtentTask,task:null}}})},{updating:!0})}_narrowDownSpatialReferenceCandidates(e,n){if(e==null)return n;const r=new Array;for(const i of e)for(const s of n){if(!i.spatialReference.equals(s.spatialReference))continue;const o=jXe(i.viewingMode,s.viewingMode);if(o!==!1){r.push({spatialReference:i.spatialReference,viewingMode:o});break}}return r.length>0?r:null}_pickSpatialReferenceCandidate(e){const n=this.defaultSpatialReference;return e==null||e.length<1?n?{spatialReference:n,viewingMode:null}:null:(n!=null&&e.length>1&&e.some(({spatialReference:r})=>r.equals(n))&&(e=e.filter(({spatialReference:r})=>r.equals(n))),e.length>1&&e.some(({viewingMode:r})=>r!==2)&&(e=e.filter(({viewingMode:r})=>r!==2)),e[0])}_getSupportedSpatialReferences(e){const n="supportedSpatialReferences"in e&&e.supportedSpatialReferences||(e.spatialReference?[e.spatialReference]:[]);if(n.length===0)return[];const r=[];for(const i of n){const s=this.getSpatialReferenceSupport(i,e);if(s!=null){const o=s.constraints??[{spatialReference:i,viewingMode:null}];for(const{spatialReference:a,viewingMode:l}of o)this.requiresExtentInSpatialReference&&this.userSpatialReference!=null&&!a.equals(this.userSpatialReference)||r.push({spatialReference:a,viewingMode:l})}}return r}_pickExtentCandidate(e){const n=this.spatialReference;return e.find(({extent:r})=>n.equals(r.spatialReference))||e[0]}_collectLayers(e,n,r=()=>!0){switch(this._loadMaybe(this.map?.())){case"loading":return!0;case"failed":return!1}const i=new DXe(r,n);for(const s of e)if(this._collectCollection(s,i),i.done||i.preloading===this.sourcePreloadCount)break;return i.updating}_collectCollection(e,n){if(e.layers){switch(this._loadMaybe(e.parent)){case"loading":return n.updating=!0,void++n.preloading;case"failed":return}for(const r of e.layers)if((r.type!=="graphics"||!r.internal)&&n.layerFilter(r)){switch(this._loadMaybe(r)){case"failed":continue;case"loading":n.updating=!0,++n.preloading;break;case"loaded":if(n.updating||(n.done=n.pushLayer(r)),n.done||n.preloading===this.sourcePreloadCount)break;"layers"in r&&this._collectCollection({layers:r.layers},n)}if(n.done||n.preloading===this.sourcePreloadCount)break}}}_loadMaybe(e){return e&&"loadStatus"in e&&e.loadStatus!=null?e.loadStatus==="not-loaded"?(e.load().catch(n=>{wa(n)}),"loading"):e.loadStatus:"loaded"}};x([E()],Kr.prototype,"required",void 0),x([E({constructOnly:!0})],Kr.prototype,"map",void 0),x([E({constructOnly:!0})],Kr.prototype,"getSpatialReferenceSupport",void 0),x([E()],Kr.prototype,"defaultSpatialReference",void 0),x([E()],Kr.prototype,"userSpatialReference",void 0),x([E()],Kr.prototype,"sourcePreloadCount",void 0),x([E()],Kr.prototype,"priorityCollection",void 0),x([E()],Kr.prototype,"requiresExtentInSpatialReference",void 0),x([E()],Kr.prototype,"suspended",void 0),x([E({readOnly:!0})],Kr.prototype,"ready",null),x([E({readOnly:!0})],Kr.prototype,"heightModelInfoReady",null),x([E({readOnly:!0})],Kr.prototype,"spatialReference",null),x([E({readOnly:!0})],Kr.prototype,"extent",null),x([E({readOnly:!0})],Kr.prototype,"heightModelInfo",null),x([E({readOnly:!0})],Kr.prototype,"vcsWkid",null),x([E({readOnly:!0})],Kr.prototype,"latestVcsWkid",null),x([E({readOnly:!0})],Kr.prototype,"viewingMode",null),x([E({readOnly:!0})],Kr.prototype,"tileInfo",null),x([E({readOnly:!0})],Kr.prototype,"mapCollections",null),x([E({readOnly:!0})],Kr.prototype,"_spatialReferenceTask",null),x([E({readOnly:!0})],Kr.prototype,"_tileInfoTask",null),x([E({readOnly:!0})],Kr.prototype,"_heightModelInfoTask",null),x([E({readOnly:!0})],Kr.prototype,"_extentCandidatesTask",null),x([E()],Kr.prototype,"_extentTask",null),x([E()],Kr.prototype,"_projectExtentTask",void 0),Kr=x([ue("esri.views.support.DefaultsFromMap")],Kr);let DXe=class{constructor(e,n){this.layerFilter=e,this.pushLayer=n,this.preloading=-1,this.updating=!1,this.done=!1}};function jXe(t,e){return t!=null?e!=null?t===e&&t:t:e}function $Xe(t){return"tryRecycleWith"in t}let FXe=class{constructor(e,n,r){this.layer=e,this.view=n,this.layerViewImporter=r,this._controller=new AbortController,this._started=!1,this.done=!1,this._deferred=xc(),this.promise=this._deferred.promise,yu(this._controller.signal,()=>{this._recycleController?.abort();const i=new Xe("cancelled:layerview-create","layerview creation cancelled",{layer:e});this._deferred?.reject(i)})}tryRecycle(e){if(!this.done||!this.layerView||!$Xe(this.layerView))return null;this._recycleController?.abort(),this._recycleController=new AbortController;const n=this.layer.type,r=this._recycleController.signal;for(let i=0;i<e.length;i++){const s=e[i];if(s.type!==n)continue;const o=this.layerView.tryRecycleWith(s,{signal:r});if(o){e.splice(i,1),this.layer=s;const a=this.layerView,l=a.view;return this.promise=o.then(()=>(pi(r),s.emit("layerview-destroy",{view:l,layerView:a}),l.emit("layerview-destroy",{view:l,layerView:a}),s.emit("layerview-create",{view:l,layerView:a}),l.emit("layerview-create",{view:l,layerView:a}),a)),this.promise}}return null}destroy(){this._controller.abort();const{layerView:e}=this;if(e){const{layer:n,view:r}=this;n.emit("layerview-destroy",{view:r,layerView:e}),r.emit("layerview-destroy",{layer:n,layerView:e})}this.done=!0,this.layer=null,this.layerView=null,this.view=null,this.layerViewImporter=null,this._map=null,this.promise=null,this._deferred=null}async start(){const{view:e}=this;if(this._started||!e.map)return;this._started=!0;const{_controller:{signal:n},layer:r}=this;this._map=e.map;try{let i,s;if(await r.load({signal:n}),r.prefetchResources&&await r.prefetchResources({signal:n}),VXe(r))i=await r.createLayerView(e,{signal:n});else{if(!this.layerViewImporter.hasLayerViewModule(r))throw new Xe("layer:view-not-supported","No layerview implementation was found");const l=await this.layerViewImporter.importLayerView(r);pi(n),i="default"in l?new l.default({layer:r,view:e}):new l({layer:r,view:e})}const o=()=>{s=ii(s),i.destroyed||i.destroy(),this.done=!0};s=yu(n,o),pi(n);try{await i.when()}catch(l){throw o(),l}if(!this._map?.allLayers?.includes(r))return o(),void this._deferred?.reject(new Xe("view:no-layerview-for-layer","The layer has been removed from the map",{layer:r}));this.layerView=i,r.emit("layerview-create",{view:e,layerView:i}),e.emit("layerview-create",{layer:r,layerView:i}),this.done=!0,this._deferred?.resolve(i)}catch(i){r.emit("layerview-create-error",{view:e,error:i}),e.emit("layerview-create-error",{layer:r,error:i}),this.done=!0,this._deferred?.reject(new Xe("layerview:create-error","layerview creation failed",{layer:r,error:i}))}}};function VXe(t){return t.createLayerView!==xi.prototype.createLayerView}function zXe(t){return t!=null&&typeof t=="object"&&"layerViews"in t}let tl=class extends Kt{constructor(e){super(e),this._layerLayerViewInfoMap=new Map,this._recyclingInfoMap=new Map,this._watchUpdatingTracking=new a1,this.supportsGround=!0,this._preloadLayerViewModules=()=>{const n=this.view.map?.allLayers;if(n)for(const r of n)this.layerViewFilter?.(r)!==!1&&this.layerViewImporter.hasLayerViewModule(r)&&this.layerViewImporter.importLayerView(r)},this._reschedule=()=>this.destroyed?Promise.reject():(this._workPromise==null&&(this._workPromise=xc(),this._workPromise.promise.catch(()=>{})),this.removeHandles("reschedule"),this.addHandles(hb(this._doWork),"reschedule"),this._workPromise.promise),this._doWork=()=>{if(this.destroyed)return;const{map:n}=this.view;if(!n)return void this.clear();if(this._map!==n&&(this.clear(),this._map=n),this._workPromise==null)return void this.notifyChange("updating");this.removeHandles("reschedule"),this.removeHandles("collection-change");const r=new Set,i=[],s=this.view.ready,o=u=>{if(u!=null){for(const h of u)if(h){if(this.layerViewFilter?.(h)===!1)continue;r.add(h);const f=this._layerLayerViewInfoMap.get(h);f&&s?f.start():f||this._recyclingInfoMap.has(h)||i.push(h),"layers"in h&&h.layers&&o(h.layers)}}};for(const u of this._rootCollectionNames)o(yd(this,u));const a=new Array,l=u=>{const h=u.tryRecycle(i);h?(this._recyclingInfoMap.set(u.layer,u),this.notifyChange("updating"),h.then(()=>{this._recyclingInfoMap.delete(u.layer),this._layerLayerViewInfoMap.set(u.layer,u),this._reschedule(),this.notifyChange("updating")}).catch(f=>{wa(f)||(this._recyclingInfoMap.delete(u.layer),u.destroy(),this._reschedule(),this.notifyChange("updating"))})):a.push(u)};for(const u of this._layerLayerViewInfoMap.values())r.has(u.layer)||(this._layerLayerViewInfoMap.delete(u.layer),l(u));for(const u of this._recyclingInfoMap.values())r.has(u.layer)||(this._recyclingInfoMap.delete(u.layer),l(u));for(const u of i)this._createLayerView(u);this._refreshCollections(),a.forEach(u=>u.destroy());const c=[n?.ground?.layers,n?.basemap?.baseLayers,n?.basemap?.groundLayers,n?.basemap?.referenceLayers,n?.layers].filter(u=>!!u);r.forEach(u=>"layers"in u&&c.push(u.layers)),this.addHandles(c.map(u=>this._watchUpdatingTracking.addOnCollectionChange(()=>u,this._reschedule)),"collection-change"),this._workPromise.resolve(),this._workPromise=null},this._layersToLayerViews=new Map(e.layerviewMapping)}initialize(){this.addHandles([H1(()=>this.view?.map?.allLayers,"change",this._preloadLayerViewModules,{onListenerAdd:this._preloadLayerViewModules}),fn(()=>{const e=this.view,n=e?.map;return[n?.basemap,n?.ground,n?.layers,e?.ready]},()=>this._reschedule(),ra)]),this._preloadLayerViewModules(),this._reschedule()}clearHandles(){this._watchUpdatingTracking.removeAll()}destroy(){this.clear(),HC(this._recyclingInfoMap),HC(this._layerLayerViewInfoMap),this._watchUpdatingTracking.destroy(),this._map=null,this._workPromise!=null&&(this._workPromise.reject(Pr()),this._workPromise=null)}get _rootCollectionNames(){return Array.from(this._layersToLayerViews.keys())}get updating(){return this._workPromise!=null||this._watchUpdatingTracking.updating||X6e(this._layerLayerViewInfoMap,e=>!e.done)||this._recyclingInfoMap.size>0}get updatingRemaining(){let e=0;for(const n of this._layerLayerViewInfoMap.values())n.done||++e;return e}clear(){this.destroyed||(this._clearCollections(),HC(this._layerLayerViewInfoMap),HC(this._recyclingInfoMap))}async whenLayerView(e){await this._reschedule();const n=this._layerLayerViewInfoMap.get(e)?.promise;if(!n){const r=this._recyclingInfoMap.get(e)?.promise;if(!r)throw new Xe("view:no-layerview-for-layer","No layerview has been found for the layer",{layer:e});return r}return n}isCreatingLayerViewsForLayer(e,n){this.commitProperty("updatingRemaining");const r=this._layerLayerViewInfoMap.get(e);if(!r?.done)return!0;const i=r.layerView;return!(!i||!n||i.parent===n)||!!(r.done&&i&&"layers"in e&&e.layers?.length)&&e.layers.some(s=>this.isCreatingLayerViewsForLayer(s,i))}_refreshCollections(){for(const[e,n]of this._layersToLayerViews)this._populateLayerViewsOwners(yd(this,e),yd(this,n),this.view);this.notifyChange("updating"),this.notifyChange("updatingRemaining")}_clearCollections(){for(const e of this._layersToLayerViews.values())yd(this,e)?.removeAll()}_populateLayerViewsOwners(e,n,r){if(!e||!n)return void n?.removeAll();let i=0;for(const s of e){const o=this._layerLayerViewInfoMap.get(s);if(!o?.layerView)continue;const{layerView:a}=o;a.layer=s,a.parent=r,n.at(i)!==a&&n.splice(i,0,a),"layers"in s&&zXe(a)&&this._populateLayerViewsOwners(s.layers,a.layerViews,a),++i}i<n.length&&n.splice(i)}_createLayerView(e){e.load().catch(()=>{}),this.layerViewImporter.hasLayerViewModule(e)&&this.layerViewImporter.importLayerView(e);const n=new FXe(e,this.view,this.layerViewImporter);n.promise?.then(()=>this._refreshCollections(),r=>{r&&(wa(r)||r.name==="cancelled:layerview-create")||kt.getLogger(this).error(`Failed to create layerview for layer title:'${e.title??"no title"}', id:'${e.id??"no id"}' of type '${e.type}'.`,{layer:e,error:r}),this.destroyed||this._refreshCollections()}),this._layerLayerViewInfoMap.set(e,n),this.view.ready&&n.start(),this.notifyChange("updating"),this.notifyChange("updatingRemaining")}};x([E()],tl.prototype,"_workPromise",void 0),x([E({readOnly:!0})],tl.prototype,"_watchUpdatingTracking",void 0),x([E({readOnly:!0})],tl.prototype,"_layersToLayerViews",void 0),x([E({constructOnly:!0})],tl.prototype,"layerviewMapping",void 0),x([E({readOnly:!0})],tl.prototype,"_rootCollectionNames",null),x([E({constructOnly:!0})],tl.prototype,"layerViewFilter",void 0),x([E()],tl.prototype,"layerViewImporter",void 0),x([E()],tl.prototype,"supportsGround",void 0),x([E({readOnly:!0})],tl.prototype,"updating",null),x([E({readOnly:!0})],tl.prototype,"updatingRemaining",null),x([E({constructOnly:!0})],tl.prototype,"view",void 0),tl=x([ue("esri.views.support.LayerViewManager")],tl);const GXe=tl;let ox=class extends Kt{constructor(e){super(e),this.featureTitleFields=!1,this.utilityNetworkFields=!1,this.globalIdField=!1}};x([E()],ox.prototype,"featureTitleFields",void 0),x([E()],ox.prototype,"utilityNetworkFields",void 0),x([E()],ox.prototype,"globalIdField",void 0),ox=x([ue("esri.views.support.RequiredFieldsOptions")],ox);const UXe=ox;var ax,Pg;let Lt=(Pg=class extends RO(CB){constructor(e){super(e),this._userSpatialReference=null,this.handles=new cb,this.updatingHandles=new a1,this.allLayerViews=new th({getCollections:()=>this.layerviewCollections,getChildrenFunction:WXe}),this.analyses=new M2,this.basemapView=null,this.dependencies={popup:void 0},this.displayFilterEnabled=!0,this.fatalError=null,this.graphics=new MT,this.typeSpecificPreconditionsReady=!0,this.layerViews=new Ot,this.magnifier=new tve,this.padding={left:0,top:0,right:0,bottom:0},this.ready=!1,this._readyStateWaitingTask=null,this.type=null,this.scale=null,this.updating=!1,this.initialExtentRequired=!0,this._lowPriorityCursorHandles=new Ot,this._highPriorityCursorHandles=new Ot,this.input=new CXe,this.navigation=new iL,this.layerViewManager=null,this.analysisViewManager=null,this.isHeightModelInfoRequired=!1,this.width=null,this.height=null,this.resizing=!1,this.suspended=!1,this.viewEvents=new sve(this),this.persistableViewModels=new Ot,this.requiredFieldsOptions=new UXe,this._isValid=!1,this._readyCycleForced=!1,this._lockedSpatialReference=null,this._userTimeZone=null,this._lockedTimeZone=null,this._userTimeExtent=null,this._lockedTimeExtent=null,this.theme=null,this.handles.add(fn(()=>this.preconditionsReady,n=>{const r=this.ready;if(n?(this._lockedSpatialReference=this.spatialReference,this._lockedTimeZone=this.timeZone,this._lockedTimeExtent=this.timeExtent,ax.views.add(this)):(this._lockedSpatialReference=null,ax.views.remove(this)),this.notifyChange("spatialReference"),!n&&r)this.toolViewManager?.detach(),this.analysisViewManager?.detach(),this.layerViewManager?.clear(),this._teardown();else if(n&&!r){try{this._startup()}catch(i){return void queueMicrotask(()=>{this.fatalError=new Xe("view:startup-error","View._startup failed",i)})}this.analysisViewManager?.attach(),this.toolViewManager.attach()}},Ug))}initialize(){this.addResolvingPromise(Promise.all([this.loadAsyncDependencies(),this._validateWithErrorDisplay()]).then(()=>(this._isValid=!0,tW(()=>this.ready)))),this.basemapView=new DYe({view:this}),this.layerViewManager=new GXe({view:this,layerViewFilter:e=>this.layerViewFilter?.(e)??!0,layerViewImporter:{importLayerView:e=>this.importLayerView(e),hasLayerViewModule:e=>this.hasLayerViewModule(e)},layerviewMapping:this._layerToLayerviewMapping}),this.toolViewManager=new ed({view:this}),this.selectionManager=new XYe({view:this}),this.addHandles([wc(()=>this.readyState==="map-content-error"&&!this.spatialReference,()=>{kt.getLogger(this).warn("#spatialReference","no spatial reference could be derived from the currently added map layers")}),fn(()=>this.initialExtentRequired,e=>this.defaultsFromMap.required={...this.defaultsFromMap.required,extent:e},ra),fn(()=>this.ready,e=>{this.defaultsFromMap&&(this.defaultsFromMap.suspended=e,this.defaultsFromMap.userSpatialReference=e?this.spatialReference:this._userSpatialReference)},Ug),fn(()=>this._userSpatialReference,e=>{this.defaultsFromMap&&(this.defaultsFromMap.userSpatialReference=e)},ra)])}get _layerToLayerviewMapping(){return ax._layerToLayerview}destroy(){this.destroyed||(ax.views.remove(this),this.viewEvents.destroy(),this.allLayerViews.destroy(),this.navigation&&(this.navigation.destroy(),this._set("navigation",null)),this.graphics=Di(this.graphics),this.analyses=Di(this.analyses),this.defaultsFromMap.destroy(),this._set("defaultsFromMap",null),this.analysisViewManager=Di(this.analysisViewManager),this.toolViewManager=Di(this.toolViewManager),this.layerViewManager=Di(this.layerViewManager),this.selectionManager=Di(this.selectionManager),this.basemapView=Di(this.basemapView),this.layerViews?.forEach(e=>e.destroy()),this.layerViews.length=0,this.invalidate(),this.handles.destroy(),this.map=Di(this.map),this.updatingHandles.destroy())}_startup(){this._set("ready",!0)}_teardown(){this._set("ready",!1)}whenReady(){return Promise.resolve(this)}toMap(){return kt.getLogger(this).error("#toMap()","Not implemented on this instance of View"),null}get activeTool(){return this.toolViewManager?.activeTool}set activeTool(e){this.toolViewManager&&(this.toolViewManager.activeTool=e)}get layerviewCollections(){return[this.basemapView?.baseLayerViews,this.basemapView?.groundLayerViews,this.layerViews,this.basemapView?.referenceLayerViews]}get animation(){return this._get("animation")}set animation(e){this._set("animation",e)}get center(){return null}get defaultsFromMapSettings(){return{}}get defaultsFromMap(){return new Kr({required:{tileInfo:!1,heightModelInfo:!1,extent:!1},map:()=>this.map,getSpatialReferenceSupport:(e,n)=>this.getSpatialReferenceSupport(e,n),...this.defaultsFromMapSettings})}get extent(){return this._get("extent")}set extent(e){this._set("extent",e)}get heightModelInfo(){return this.getDefaultHeightModelInfo()}get highlights(){return this._get("highlights")??kXe()}set highlights(e){this._set("highlights",Sd(e,this._get("highlights"),Ot.ofType(Sg)))}get interacting(){return this.navigating}get navigating(){return!1}get preconditionsReady(){return!this.destroying&&!this.destroyed&&!(this.fatalError||!this._isValid||this._readyCycleForced||!this.map||h9(this.map)&&!this.map.loaded||this.width===0||this.height===0||!this.spatialReference||!this._validateSpatialReference(this.spatialReference)||!this._lockedSpatialReference&&!this.defaultsFromMap?.ready||!this.typeSpecificPreconditionsReady)}get resolution(){return 0}set map(e){e!==this._get("map")&&(e?.destroyed&&(kt.getLogger(this).warn("#map","The provided map is already destroyed",{map:e}),e=null),h9(e)&&e.load().catch(()=>{}),this.constructed&&!this.destroyed&&(this.forceReadyCycle(),this._lockedSpatialReference=null),this._set("map",e))}get readyState(){if(this.destroyed)return this._get("readyState");if(!this.map)return"missing-map";if("container"in this&&!this.container)return"missing-container";if(this.fatalError)return"rendering-error";if((this.defaultsFromMap?.ready??!1)&&!this.spatialReference){const e=!("loaded"in this.map)||this.map.loaded,n=this.map.ground.loaded,r=this.map.basemap?.loaded??!0;return e&&r&&n&&!this.map?.allLayers.length?"empty-map":(this._readyStateWaitingTask||(this._readyStateWaitingTask=MO(i=>Ofe(ye("view-readyState-waiting-delay"),null,i)),this.addHandles(this._readyStateWaitingTask),this.addHandles(this._readyStateWaitingTask,"ready-state-task")),this._readyStateWaitingTask?.finished?"map-content-error":"loading")}return this._readyStateWaitingTask=$1(this._readyStateWaitingTask),this.removeHandles("ready-state-task"),this.ready?"ready":"loading"}get spatialReference(){const e=this._userSpatialReference||this._lockedSpatialReference||this.getDefaultSpatialReference()||null;if(e&&this.defaultsFromMap?.required?.heightModelInfo){const n=e.clone();return n.vcsWkid=this.defaultsFromMap.vcsWkid,n.latestVcsWkid=this.defaultsFromMap.latestVcsWkid,n}return e}set spatialReference(e){const n=!go(e,this._get("spatialReference"));this._set("_userSpatialReference",e),n&&(this._set("spatialReference",e),this._spatialReferenceChanged(e))}_spatialReferenceChanged(e){}get stationary(){return!this.animation&&!this.navigating&&!this.resizing}get timeExtent(){return this._userTimeExtent??this._lockedTimeExtent??this.getDefaultTimeExtent()??null}set timeExtent(e){this._userTimeExtent=e}get timeZone(){return this._userTimeZone??this._lockedTimeZone??this.getDefaultTimeZone()??jd}set timeZone(e){this._userTimeZone=e,bVe(e)||kt.getLogger(this).warn("#timeZone",`the parsed value '${e}' may not be a valid IANA time zone`)}get tools(){return this.toolViewManager?.tools}get initialExtent(){return this.defaultsFromMap?.extent}get cursor(){return this.toolViewManager?.cursor??this._highPriorityCursorHandles.at(-1)?.cursor??this._lowPriorityCursorHandles.at(-1)?.cursor??"default"}acquireCursor(e,n="low"){const r=n==="high"?this._highPriorityCursorHandles:this._lowPriorityCursorHandles,i={cursor:e},s=Zn(()=>r.remove(i));return r.add(i),this.addHandles(s),s}get size(){return[this.width,this.height]}get effectiveTheme(){return this.theme??new CV}whenLayerView(e){return this.layerViewManager?.whenLayerView(e)??Promise.reject()}getDefaultSpatialReference(){return this.defaultsFromMap?.spatialReference}getDefaultHeightModelInfo(){return(this.map&&"heightModelInfo"in this.map?this.map.heightModelInfo:void 0)??this.defaultsFromMap?.heightModelInfo??null}getDefaultTimeZone(){return null}getDefaultTimeExtent(){return null}getSurface(){return null}importLayerView(e){throw new Xe("view:importLayerView-missing","importLayerView() not implemented")}hasLayerViewModule(e){return!1}async validate(){}async loadAsyncDependencies(){}invalidate(){this._isValid=!1}getSpatialReferenceSupport(){return{constraints:null}}_validateSpatialReference(e){return this.getSpatialReferenceSupport(e)!=null}when(e,n){return this.isResolved()&&!this.ready&&kt.getLogger(this).warn("#when()","Calling view.when() while the view is no longer ready but was already resolved once will resolve immediately. Use reactiveUtils.whenOnce(() => view.ready).then(...) instead."),super.when(e,n)}forceReadyCycle(){this.ready&&(wc(()=>this.destroyed||this.preconditionsReady===!1,()=>this._readyCycleForced=!1,{once:!0}),this._readyCycleForced=!0)}on(e,n){return super.on(e,n)}addAndActivateTool(e){this.toolViewManager.tools.add(e),this.activeTool=e}tryFatalErrorRecovery(){this.fatalError=null}async _validateWithErrorDisplay(){try{await this.validate()}catch(e){const n=document.createElement("div");n.setAttribute("style","display: flex; flex-direction: column; gap: 8px; padding: 20px; height: 100%; justify-content: center; color: black; background: white; font-family: sans-serif;");const r=document.createElement("div");r.innerHTML="Unable to display map. WebGL2 support is required.",r.setAttribute("style","font-size: 24px; font-weight: bold;");const i=document.createElement("div");i.innerHTML="Ensure that your browser and hardware meet the minimum requirements.",i.setAttribute("style","font-size: 18px;");const s=document.createElement("a");s.innerHTML="https://esriurl.com/webgl-faq",s.target="_blank",s.setAttribute("style","font-size: 18px;"),s.href="https://esriurl.com/webgl-faq",n.appendChild(r),n.appendChild(i),n.appendChild(s);const o=this.getSurface();throw o&&o.appendChild(n),e}}},ax=Pg,Pg._layerToLayerview=[["view.map.basemap.baseLayers","view.basemapView.baseLayerViews"],["view.map.basemap.groundLayers","view.basemapView.groundLayerViews"],["view.map.basemap.referenceLayers","view.basemapView.referenceLayerViews"],["view.map.layers","view.layerViews"]],Pg.views=new Ot,Pg);x([E()],Lt.prototype,"_userSpatialReference",void 0),x([E()],Lt.prototype,"activeTool",null),x([E({readOnly:!0})],Lt.prototype,"allLayerViews",void 0),x([E({readOnly:!0})],Lt.prototype,"layerviewCollections",null),x([E(i7(M2,"analyses"))],Lt.prototype,"analyses",void 0),x([E()],Lt.prototype,"animation",null),x([E()],Lt.prototype,"basemapView",void 0),x([E()],Lt.prototype,"center",null),x([E()],Lt.prototype,"defaultsFromMapSettings",null),x([E()],Lt.prototype,"defaultsFromMap",null),x([E()],Lt.prototype,"dependencies",void 0),x([E()],Lt.prototype,"displayFilterEnabled",void 0),x([E({type:Vn})],Lt.prototype,"extent",null),x([E()],Lt.prototype,"fatalError",void 0),x([E(i7(MT,"graphics"))],Lt.prototype,"graphics",void 0),x([E({readOnly:!0,type:ol})],Lt.prototype,"heightModelInfo",null),x([E({type:Ot.ofType(Sg)})],Lt.prototype,"highlights",null),x([E({readOnly:!0})],Lt.prototype,"interacting",null),x([E({constructOnly:!0})],Lt.prototype,"layerViewFilter",void 0),x([E({readOnly:!0})],Lt.prototype,"navigating",null),x([E({readOnly:!0,dependsOn:["fatalError","_isValid","_readyCycleForced","map","map.loaded?","width","height","spatialReference","_lockedSpatialReference","defaultsFromMap.ready","typeSpecificPreconditionsReady"]})],Lt.prototype,"preconditionsReady",null),x([E({readOnly:!0})],Lt.prototype,"typeSpecificPreconditionsReady",void 0),x([E({type:Ot,readOnly:!0})],Lt.prototype,"layerViews",void 0),x([E()],Lt.prototype,"resolution",null),x([E({type:tve})],Lt.prototype,"magnifier",void 0),x([E({value:null,type:dye})],Lt.prototype,"map",null),x([E()],Lt.prototype,"padding",void 0),x([E({readOnly:!0})],Lt.prototype,"ready",void 0),x([E()],Lt.prototype,"_readyStateWaitingTask",void 0),x([E({readOnly:!0})],Lt.prototype,"readyState",null),x([E({type:Bt})],Lt.prototype,"spatialReference",null),x([E()],Lt.prototype,"stationary",null),x([E({type:Pa})],Lt.prototype,"timeExtent",null),x([E({type:String,nonNullable:!0})],Lt.prototype,"timeZone",null),x([E()],Lt.prototype,"tools",null),x([E()],Lt.prototype,"toolViewManager",void 0),x([E({readOnly:!0})],Lt.prototype,"type",void 0),x([E({type:Number})],Lt.prototype,"scale",void 0),x([E({readOnly:!0})],Lt.prototype,"updating",void 0),x([E({readOnly:!0})],Lt.prototype,"initialExtentRequired",void 0),x([E({readOnly:!0})],Lt.prototype,"initialExtent",null),x([E()],Lt.prototype,"cursor",null),x([E({readOnly:!0})],Lt.prototype,"input",void 0),x([E({type:iL,nonNullable:!0})],Lt.prototype,"navigation",void 0),x([E()],Lt.prototype,"layerViewManager",void 0),x([E()],Lt.prototype,"analysisViewManager",void 0),x([E()],Lt.prototype,"selectionManager",void 0),x([E()],Lt.prototype,"width",void 0),x([E()],Lt.prototype,"height",void 0),x([E({readOnly:!0})],Lt.prototype,"resizing",void 0),x([E({value:null,readOnly:!0})],Lt.prototype,"size",null),x([E({readOnly:!0})],Lt.prototype,"suspended",void 0),x([E({readOnly:!0})],Lt.prototype,"viewEvents",void 0),x([E({readOnly:!0})],Lt.prototype,"persistableViewModels",void 0),x([E()],Lt.prototype,"_isValid",void 0),x([E()],Lt.prototype,"_readyCycleForced",void 0),x([E()],Lt.prototype,"_lockedSpatialReference",void 0),x([E()],Lt.prototype,"_userTimeZone",void 0),x([E()],Lt.prototype,"_lockedTimeZone",void 0),x([E()],Lt.prototype,"_userTimeExtent",void 0),x([E()],Lt.prototype,"_lockedTimeExtent",void 0),x([E({type:CV})],Lt.prototype,"theme",void 0),x([E({readOnly:!0,type:CV})],Lt.prototype,"effectiveTheme",null),Lt=ax=x([ue("esri.views.View")],Lt);const d$=globalThis.$arcgis;d$&&!d$.views&&Object.defineProperty(d$,"views",{configurable:!1,enumerable:!0,writable:!1,value:Lt.views});const BXe=Lt;function WXe(t){return t.layerViews}function Vi(){return[0,0]}function HXe(t){return[t[0],t[1]]}function jI(t,e){return[t,e]}function qXe(t,e){return[t,e]}function KXe(t,e=Vi()){const n=Math.min(2,t.length);for(let r=0;r<n;++r)e[r]=t[r];return e}function vve(){return Vi()}function _ve(){return jI(1,1)}function xve(){return jI(1,0)}function wve(){return jI(0,1)}const YXe=vve(),XXe=_ve(),ZXe=xve(),JXe=wve();Object.freeze(Object.defineProperty({__proto__:null,ONES:XXe,UNIT_X:ZXe,UNIT_Y:JXe,ZEROS:YXe,clone:HXe,create:Vi,freeze:qXe,fromArray:KXe,fromValues:jI,ones:_ve,unitX:xve,unitY:wve,zeros:vve},Symbol.toStringTag,{value:"Module"}));function QXe(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function bve(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function eZe(t,e,n,r,i,s,o){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=s,t[5]=o,t}function UW(t,e){const n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5];let l=n*s-r*i;return l?(l=1/l,t[0]=s*l,t[1]=-r*l,t[2]=-i*l,t[3]=n*l,t[4]=(i*a-s*o)*l,t[5]=(r*o-n*a)*l,t):null}function tZe(t){return t[0]*t[3]-t[1]*t[2]}function Eve(t,e,n){const r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=n[0],u=n[1],h=n[2],f=n[3],g=n[4],y=n[5];return t[0]=r*c+s*u,t[1]=i*c+o*u,t[2]=r*h+s*f,t[3]=i*h+o*f,t[4]=r*g+s*y+a,t[5]=i*g+o*y+l,t}function $I(t,e,n){const r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=Math.sin(n),u=Math.cos(n);return t[0]=r*u+s*c,t[1]=i*u+o*c,t[2]=r*-c+s*u,t[3]=i*-c+o*u,t[4]=a,t[5]=l,t}function sL(t,e,n){const r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=n[0],u=n[1];return t[0]=r*c,t[1]=i*c,t[2]=s*u,t[3]=o*u,t[4]=a,t[5]=l,t}function O2(t,e,n){const r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=n[0],u=n[1];return t[0]=r,t[1]=i,t[2]=s,t[3]=o,t[4]=r*c+s*u+a,t[5]=i*c+o*u+l,t}function Sve(t,e){const n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=-n,t[3]=r,t[4]=0,t[5]=0,t}function Tve(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t}function BW(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t}function nZe(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"}function rZe(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+1)}function iZe(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t}function kve(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t}function sZe(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t}function oZe(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t}function aZe(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]}function lZe(t,e){const n=t[0],r=t[1],i=t[2],s=t[3],o=t[4],a=t[5],l=e[0],c=e[1],u=e[2],h=e[3],f=e[4],g=e[5],y=Sl();return Math.abs(n-l)<=y*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(r-c)<=y*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(i-u)<=y*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(s-h)<=y*Math.max(1,Math.abs(s),Math.abs(h))&&Math.abs(o-f)<=y*Math.max(1,Math.abs(o),Math.abs(f))&&Math.abs(a-g)<=y*Math.max(1,Math.abs(a),Math.abs(g))}const cZe=Eve,uZe=kve;Object.freeze(Object.defineProperty({__proto__:null,add:iZe,copy:QXe,determinant:tZe,equals:lZe,exactEquals:aZe,frob:rZe,fromRotation:Sve,fromScaling:Tve,fromTranslation:BW,identity:bve,invert:UW,mul:cZe,multiply:Eve,multiplyScalar:sZe,multiplyScalarAndAdd:oZe,rotate:$I,scale:sL,set:eZe,str:nZe,sub:uZe,subtract:kve,translate:O2},Symbol.toStringTag,{value:"Module"}));function Ad(){return[1,0,0,1,0,0]}function hZe(t){return[t[0],t[1],t[2],t[3],t[4],t[5]]}function dZe(t,e,n,r,i,s){return[t,e,n,r,i,s]}const fZe=Ad();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:fZe,clone:hZe,create:Ad,fromValues:dZe},Symbol.toStringTag,{value:"Module"}));const aR={102100:{maxX:20037508342788905e-9,minX:-20037508342788905e-9,plus180Line:new Ss({paths:[[[20037508342788905e-9,-20037508342788905e-9],[20037508342788905e-9,20037508342788905e-9]]],spatialReference:Bt.WebMercator}),minus180Line:new Ss({paths:[[[-20037508342788905e-9,-20037508342788905e-9],[-20037508342788905e-9,20037508342788905e-9]]],spatialReference:Bt.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new Ss({paths:[[[180,-180],[180,180]]],spatialReference:Bt.WGS84}),minus180Line:new Ss({paths:[[[-180,-180],[-180,180]]],spatialReference:Bt.WGS84})}};function By(t,e){return Math.ceil((t-e)/(2*e))}function Ave(t,e){const n=OT(t);for(const r of n)for(const i of r)i[0]+=e;return t}function OT(t){return wW(t)?t.rings:t.paths}function fNt(t,e){return e?{...e,query:{...t,...e.query}}:{query:t}}function pZe(t){return typeof t=="string"?Wa(t):Ze(t)}function mZe(t,e,n){const r={};for(const i in t){if(i==="declaredClass")continue;const s=t[i];if(s!=null&&typeof s!="function")if(Array.isArray(s))r[i]=s.map(o=>mZe(o));else if(typeof s=="object")if(s.toJSON){const o=s.toJSON(n?.[i]);r[i]=e?o:JSON.stringify(o)}else r[i]=e?s:JSON.stringify(s);else r[i]=s}return r}function gZe(t,e){return t?e&&yB(t)?e:gB(t)??Zr?.findCredential(t)?.token:null}async function pNt(t,e,n){const r=gZe(t,e);return r||(!Zr&&nr.request.useIdentity&&await _e(()=>import("./IdentityManager-DFUti-1r.js"),__vite__mapDeps([17,18])),(await Zr.getCredential(t,n))?.token)}async function yZe(t,e,n,r){const i=pZe(t),s=e[0].spatialReference,o={...r,responseType:"json",query:{...i.query,f:"json",sr:Ype(s),target:JSON.stringify({geometryType:bW(e[0]),geometries:e}),cutter:JSON.stringify(n)}},a=await ns(i.path+"/cut",o),{cutIndexes:l,geometries:c=[]}=a.data;return{cutIndexes:l,geometries:c.map(u=>{const h=C2(u);return h.spatialReference=s,h})}}function vZe(t){return{geometryType:bW(t[0]),geometries:t.map(e=>e.toJSON())}}function _Ze(t,e,n){const r=xWe(e);return t.map(i=>{const s=r.fromJSON(i);return s.spatialReference=n,s})}async function xZe(t,e,n){const r=typeof t=="string"?Wa(t):t,i=e[0].spatialReference,s=bW(e[0]),o={...n,query:{...r.query,f:"json",sr:Ype(i),geometries:JSON.stringify(vZe(e))}},{data:a}=await ns(r.path+"/simplify",o);return _Ze(a.geometries,s,i)}const Ive=()=>kt.getLogger("esri.geometry.support.normalizeUtils");function wZe(t){return t.type==="polygon"}function bZe(t){return t[0].type==="polygon"}function EZe(t){return t[0].type==="polyline"}function Xne(t){const e=[];let n=0,r=0;for(let i=0;i<t.length;i++){const s=t[i];let o=null;for(let a=0;a<s.length;a++)o=s[a],e.push(o),a===0?(n=o[0],r=n):(n=Math.min(n,o[0]),r=Math.max(r,o[0]));o&&e.push([(n+r)/2,0])}return e}function SZe(t,e){if(!(t instanceof Ss||t instanceof wi)){const i="straightLineDensify: the input geometry is neither polyline nor polygon";throw Ive().error(i),new Xe("internal:geometry",i)}const n=OT(t),r=[];for(const i of n){const s=[];r.push(s),s.push([i[0][0],i[0][1]]);for(let o=0;o<i.length-1;o++){const a=i[o][0],l=i[o][1],c=i[o+1][0],u=i[o+1][1],h=Math.sqrt((c-a)*(c-a)+(u-l)*(u-l)),f=(u-l)/h,g=(c-a)/h,y=h/e;if(y>1){for(let A=1;A<=y-1;A++){const I=A*e,P=g*I+a,R=f*I+l;s.push([P,R])}const _=(h+Math.floor(y-1)*e)/2,b=g*_+a,T=f*_+l;s.push([b,T])}s.push([c,u])}}return wZe(t)?new wi({rings:r,spatialReference:t.spatialReference}):new Ss({paths:r,spatialReference:t.spatialReference})}function Zne(t,e,n){if(e){const r=SZe(t,1e6);t=hS(r,!0)}return n&&(t=Ave(t,n)),t}function Jne(t,e,n){if(Array.isArray(t)){const r=t[0];if(r>e){const i=By(r,e);t[0]=r+i*(-2*e)}else if(r<n){const i=By(r,n);t[0]=r+i*(-2*n)}}else{const r=t.x;if(r>e){const i=By(r,e);t=t.clone().offset(i*(-2*e),0)}else if(r<n){const i=By(r,n);t=t.clone().offset(i*(-2*n),0)}}return t}function TZe(t,e){let n=-1;for(let r=0;r<e.cutIndexes.length;r++){const i=e.cutIndexes[r],s=e.geometries[r],o=OT(s);for(let a=0;a<o.length;a++){const l=o[a];l.some(c=>{if(c[0]<180)return!0;{let u=0;for(let f=0;f<l.length;f++){const g=l[f][0];u=g>u?g:u}u=Number(u.toFixed(9));const h=-360*By(u,180);for(let f=0;f<l.length;f++){const g=s.getPoint(a,f);s.setPoint(a,f,g.clone().offset(h,0))}return!0}})}if(i===n){if(bZe(t))for(const a of OT(s))t[i]=t[i].addRing(a);else if(EZe(t))for(const a of OT(s))t[i]=t[i].addPath(a)}else n=i,t[i]=s}return t}async function kZe(t,e,n){if(!Array.isArray(t))return kZe([t],e);e&&typeof e!="string"&&Ive().warn("normalizeCentralMeridian()","The url object is deprecated, use the url string instead");const r=typeof e=="string"?e:e?.url??nr.geometryServiceUrl;let i,s,o,a,l,c,u,h,f=0;const g=[],y=[];for(const P of t)if(P!=null)if(i||(i=P.spatialReference,s=za(i),o=i.isWebMercator,c=o?102100:4326,a=aR[c].maxX,l=aR[c].minX,u=aR[c].plus180Line,h=aR[c].minus180Line),s)if(P.type==="mesh")y.push(P);else if(P.type==="point")y.push(Jne(P.clone(),a,l));else if(P.type==="multipoint"){const R=P.clone();R.points=R.points.map(D=>Jne(D,a,l)),y.push(R)}else if(P.type==="extent"){const R=P.clone()._normalize(!1,!1,s);y.push(R.rings?new wi(R):R)}else if(P.extent){const R=P.extent,D=By(R.xmin,l)*(2*a);let C=D===0?P.clone():Ave(P.clone(),D);R.offset(D,0);let{xmin:M,xmax:O}=R;M=Number(M.toFixed(9)),O=Number(O.toFixed(9)),R.intersects(u)&&O!==a?(f=O>f?O:f,C=Zne(C,o),g.push(C),y.push("cut")):R.intersects(h)&&M!==l?(f=O*(2*a)>f?O*(2*a):f,C=Zne(C,o,360),g.push(C),y.push("cut")):y.push(C)}else y.push(P.clone());else y.push(P);else y.push(P);let _=By(f,a),b=-90;const T=_,A=new Ss;for(;_>0;){const P=360*_-180;A.addPath([[P,b],[P,-1*b]]),b*=-1,_--}if(g.length>0&&T>0){const P=TZe(g,await yZe(r,g,A,n)),R=[],D=[];for(let O=0;O<y.length;O++){const j=y[O];if(j!=="cut")D.push(j);else{const V=P.shift(),U=t[O];U!=null&&U.type==="polygon"&&U.rings&&U.rings.length>1&&V.rings.length>=U.rings.length?(R.push(V),D.push("simplify")):D.push(o?i1(V):V)}}if(!R.length)return D;const C=await xZe(r,R,n),M=[];for(let O=0;O<D.length;O++){const j=D[O];j!=="simplify"?M.push(j):M.push(o?i1(C.shift()):C.shift())}return M}const I=[];for(let P=0;P<y.length;P++){const R=y[P];if(R!=="cut")I.push(R);else{const D=g.shift();I.push(o===!0?i1(D):D)}}return I}function AZe(t){if(!t)return null;const e=t.extent;if(!e)return null;const n=t.spatialReference&&za(t.spatialReference);if(!n)return e;const[r,i]=n.valid,s=2*i,{width:o}=e;let a,{xmin:l,xmax:c}=e;if([l,c]=[c,l],t.type==="extent"||o===0||o<=i||o>s||l<r||c>i)return e;switch(t.type){case"polygon":if(!(t.rings.length>1))return e;a=Xne(t.rings);break;case"polyline":if(!(t.paths.length>1))return e;a=Xne(t.paths);break;case"multipoint":a=t.points}const u=e.clone();for(let h=0;h<a.length;h++){let f=a[h][0];f<0?(f+=i,c=Math.max(f,c)):(f-=i,l=Math.min(f,l))}return u.xmin=l,u.xmax=c,u.width<o?(u.xmin-=i,u.xmax-=i,u):e}function WW(t,e,n){const r=za(n);if(r==null)return t;const[i,s]=r.valid,o=2*s;let a=0,l=0;e>s?a=Math.ceil(Math.abs(e-s)/o):e<i&&(a=-Math.ceil(Math.abs(e-i)/o)),t>s?l=Math.ceil(Math.abs(t-s)/o):t<i&&(l=-Math.ceil(Math.abs(t-i)/o));let c=t+(a-l)*o;const u=c-e;return u>s?c-=o:u<i&&(c+=o),c}function mNt(t,e){return HW(e)?.normalize(t)??t}function HW(t){const e=za(t);if(e==null)return null;const[n,r]=e.valid;return new ZO(n,r)}const gNt=HW(Bt.WGS84);HW(Bt.WebMercator);const Pve=96,Cve=39.37,IZe=180/Math.PI;function Rve(t){return t.wkid?t:t.spatialReference||Bt.WGS84}function qW(t,e){return e.type?lo(t,e.x,e.y):cw(t,e)}function Mve(t){return Wd(t)}function oL(t,e,n=0){let r=t.width,i=t.height;if(n!==0){const a=kI(n),l=Math.abs(Math.cos(a)),c=Math.abs(Math.sin(a));r=t.width*l+t.height*c,i=t.width*c+t.height*l}const s=Math.max(1,e[0]),o=Math.max(1,e[1]);return Math.max(r/s,i/o)*DZe(t.spatialReference)}async function DS(t,e,n,r){let i,s;if(!t||Array.isArray(t)&&!t.length)return null;if(Ot.isCollection(t)&&(t=t.toArray()),Array.isArray(t)&&t.length&&typeof t[0]=="object"){const a=t.every(u=>"attributes"in u),l=t.some(u=>!u.geometry);let c=t;if(a&&l&&e&&e.allLayerViews){const u=new Map;for(const y of t){const _=y.layer,b=u.get(_)||[],T=y.attributes[_.objectIdField];T!=null&&b.push(T),u.set(_,b)}const h=[];u.forEach((y,_)=>{const b=e.allLayerViews?.find(T=>T.layer.id===_.id);if(b&&"queryFeatures"in b){const T=_.createQuery();T.objectIds=y,T.returnGeometry=!0,h.push(b.queryFeatures(T))}});const f=await Promise.all(h),g=[];for(const y of f)if(y&&y.features&&y.features.length)for(const _ of y.features)_.geometry!=null&&g.push(_.geometry);c=g}for(const u of c)r=await DS(u,e,n,r);return r}if(Array.isArray(t)&&t.length===2&&typeof t[0]=="number"&&typeof t[1]=="number")i=new Jt(t);else if(t instanceof Gs)i=t;else if("geometry"in t){if(t.geometry)i=t.geometry;else if(t.layer){const a=t.layer,l=e.allLayerViews?.find(c=>c.layer.id===a.id);if(l&&"queryFeatures"in l){const c=a.createQuery();c.objectIds=[t.attributes[a.objectIdField]],c.returnGeometry=!0,i=(await l.queryFeatures(c))?.features?.[0]?.geometry}}}if(i==null)return null;switch(i.type){case"point":s=new Vn({xmin:i.x,ymin:i.y,xmax:i.x,ymax:i.y,spatialReference:i.spatialReference});break;case"extent":case"multipoint":case"polygon":case"polyline":s=AZe(i);break;default:s=i.extent}if(!s)return null;kp()||bh(s.spatialReference,n)||await Bg();const o=yv(s,n);if(!o)return null;if(r){const a=o.center,l=a.clone();l.x=WW(a.x,r.center.x,n),l.x!==a.x&&o.centerAt(l),r=r.union(o)}else r=o;return r}function PZe(t){if(t&&(!Array.isArray(t)||typeof t[0]!="number")&&(typeof t=="object"||Array.isArray(t)&&typeof t[0]=="object")){if("layer"in t&&t.layer?.minScale!=null&&t.layer.maxScale!=null){const e=t.layer;return{min:e.minScale,max:e.maxScale}}if(Array.isArray(t)&&t.length&&t.every(e=>"layer"in e)){let e=0,n=0;for(const r of t){const i=r.layer;i?.minScale&&i.maxScale&&(e=i.minScale<e?i.minScale:e,n=i.maxScale>n?i.maxScale:n)}return e&&n?{min:e,max:n}:null}}}function Qne(t,e){const n=Rve(t);return go(n,e)||n.imageCoordinateSystem||e.imageCoordinateSystem?t:yv(t,e)}async function CZe(t,e){if(!t||!e)return new du({targetGeometry:new Jt,scale:0,rotation:0});let n=e.spatialReference;const{constraints:r,padding:i,viewpoint:s,size:o}=e,a=[i?o[0]-i.left-i.right:o[0],i?o[1]-i.top-i.bottom:o[1]];let l=null;t instanceof du?l=t:t.viewpoint?l=t.viewpoint:t.target&&t.target.declaredClass==="esri.Viewpoint"&&(l=t.target);let c=null;l?.targetGeometry?c=l.targetGeometry:t instanceof Vn?c=t:t instanceof Gs?c=await DS(t,e,n):t&&(c=await DS(t.center,e,n)||await DS(t.target,e,n)||await DS(t,e,n)),!c&&s?.targetGeometry?c=s.targetGeometry:!c&&e.extent&&(c=e.extent),n||(n=Rve(e.spatialReference||e.extent||c)),kp()||go(c.spatialReference,n)||bh(c.spatialReference,n)||await Bg();const u=Qne(c,n),h="center"in u?u.center:u;e.pickClosestTarget!==!1&&h.type==="point"&&s.targetGeometry?.type==="point"&&(h.x=WW(h.x,s.targetGeometry.x,h.spatialReference));let f=0;l?f=l.rotation:t.hasOwnProperty("rotation")?f=t.rotation:s&&(f=s.rotation);let g=0;g=l?.targetGeometry!=null&&l.targetGeometry.type==="point"?l.scale:"scale"in t&&t.scale?t.scale:"zoom"in t&&t.zoom!==-1&&r&&r.effectiveLODs?r.zoomToScale(t.zoom):Array.isArray(c)||c.type==="point"||c.type==="extent"&&c.width===0&&c.height===0?s.scale:oL(Qne(c.extent,n),a,f);const y=PZe(t.target??t);y&&(y.min&&y.min<g?g=y.min:y.max&&y.max>g&&(g=y.max));let _=new du({targetGeometry:h,scale:g,rotation:f});return r&&(_=r.fit(_),r.constrainByGeometry(_),r.rotationEnabled||(_.rotation=s.rotation)),_}function da(t,e){const n=t.targetGeometry,r=e.targetGeometry;return n.x=r.x,n.y=r.y,n.spatialReference=r.spatialReference,t.scale=e.scale,t.rotation=e.rotation,t}function RZe(t,e,n){return n?lo(t,.5*(e[0]-n.right+n.left),.5*(e[1]-n.bottom+n.top)):II(t,e,.5)}const MZe=(function(){const t=Vi();return function(e,n,r){const i=n.targetGeometry;qW(t,i);const s=.5*_b(n);return e.xmin=t[0]-s*r[0],e.ymin=t[1]-s*r[1],e.xmax=t[0]+s*r[0],e.ymax=t[1]+s*r[1],e.spatialReference=i.spatialReference,e}})();function NZe(t,e,n,r,i){return LV(t,e,n.center),t.scale=oL(n,r),i?.constraints?.constrain(t),t}function OZe(t,e,n,r){return XW(t,e,n,r),UW(t,t)}const Nve=(function(){const t=Vi();return function(e,n,r){return hW(e,jZe(e,n),RZe(t,n,r))}})(),LZe=(function(){const t=Ad(),e=Vi();return function(n,r,i,s){const o=_b(r),a=KW(r);return lo(e,o,o),Tve(t,e),$I(t,t,a),O2(t,t,Nve(e,i,s)),O2(t,t,[0,s.top-s.bottom]),lo(n,t[4],t[5])}})();function _b(t){return t.scale*Ove(t.targetGeometry?.spatialReference)}function Ove(t){return hc(t)?1/(Mve(t)*Cve*Pve):1}function KW(t){return uW(t.rotation)||0}function DZe(t){return hc(t)?Mve(t)*Cve*Pve:1}function jZe(t,e){return II(t,e,.5)}const YW=(function(){const t=Vi(),e=Vi(),n=Vi();return function(r,i,s,o,a,l){return c0e(t,i),II(e,s,.5*l),lo(n,1/o*l,-1/o*l),BW(r,e),a&&$I(r,r,a),sL(r,r,n),O2(r,r,t),r}})(),XW=(function(){const t=Vi();return function(e,n,r,i){const s=_b(n),o=KW(n);return qW(t,n.targetGeometry),YW(e,t,r,s,o,i)}})(),$Ze=(function(){const t=Vi();return function(e,n,r,i){const s=_b(n);return qW(t,n.targetGeometry),YW(e,t,r,s,0,i)}})();function Lve(t){const e=za(t);return e?e.valid[1]-e.valid[0]:0}function FZe(t,e){return Math.round(Lve(t)/e)}const VZe=(function(){const t=Vi(),e=Vi(),n=[0,0,0];return function(r,i,s){Hk(t,r,i),G9(t,t),Hk(e,r,s),G9(e,e),h0e(n,t,e);let o=Math.acos(u0e(t,e)/(oN(t)*oN(e)))*IZe;return n[2]<0&&(o=-o),isNaN(o)&&(o=0),o}})(),zZe=(function(){const t=Vi();return function(e,n,r,i){const s=e.targetGeometry;return da(e,n),LZe(t,n,r,i),s.x+=t[0],s.y+=t[1],e}})(),LV=function(t,e,n){da(t,e);const r=t.targetGeometry;return r.x=n.x,r.y=n.y,r.spatialReference=n.spatialReference,t},GZe=(function(){const t=Vi();return function(e,n,r,i,s){s||(s="center"),hW(t,r,i),II(t,t,.5);const o=t[0],a=t[1];switch(s){case"center":lo(t,0,0);break;case"left":lo(t,-o,0);break;case"top":lo(t,0,a);break;case"right":lo(t,o,0);break;case"bottom":lo(t,0,-a);break;case"top-left":lo(t,-o,a);break;case"bottom-left":lo(t,-o,-a);break;case"top-right":lo(t,o,a);break;case"bottom-right":lo(t,o,-a)}return aL(e,n,t),e}})();function yNt(t,e,n){return da(t,e),t.rotation+=n,t}function UZe(t,e,n){return da(t,e),t.rotation=n,t}const BZe=(function(){const t=Vi();return function(e,n,r,i,s){return da(e,n),isNaN(r)||r===0||(jve(t,i,n,s),e.scale=n.scale*r,$ve(t,t,e,s),aL(e,e,lo(t,t[0]-i[0],i[1]-t[1]))),e}})();function ere(t,e,n){return da(t,e),t.scale=n,t}const Dve=(function(){const t=Vi();return function(e,n,r,i,s,o){return da(e,n),isNaN(r)||r===0||(jve(t,s,n,o),e.scale=n.scale*r,e.rotation+=i,$ve(t,t,e,o),aL(e,e,lo(t,t[0]-s[0],s[1]-t[1]))),e}})(),vNt=(function(){const t=Vi(),e=Vi();return function(n,r,i,s,o,a,l){return Nve(e,a,l),s0e(t,o,e),s?Dve(n,r,i,s,t,a):BZe(n,r,i,t,a)}})(),jve=(function(){const t=Ad();return function(e,n,r,i){return ld(e,n,OZe(t,r,i,1))}})(),$ve=(function(){const t=Ad();return function(e,n,r,i){return ld(e,n,XW(t,r,i,1))}})(),aL=(function(){const t=Vi(),e=Ad();return function(n,r,i){da(n,r);const s=_b(r),o=n.targetGeometry;return Sve(e,KW(r)),sL(e,e,jI(s,s)),ld(t,i,e),o.x+=t[0],o.y+=t[1],n}})();function Fve(){const t=new Float32Array(6);return t[0]=1,t[3]=1,t}function WZe(t){const e=new Float32Array(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function HZe(t,e,n,r,i,s){const o=new Float32Array(6);return o[0]=t,o[1]=e,o[2]=n,o[3]=r,o[4]=i,o[5]=s,o}function Vve(t,e,n,r){const i=e[r],s=e[r+1];t[r]=n[0]*i+n[2]*s+n[4],t[r+1]=n[1]*i+n[3]*s+n[5]}function qZe(t,e,n,r=0,i=0,s=2){const o=i||e.length/s;for(let a=r;a<o;a++)Vve(t,e,n,a*s)}Object.freeze(Object.defineProperty({__proto__:null,clone:WZe,create:Fve,fromValues:HZe,transform:Vve,transformMany:qZe},Symbol.toStringTag,{value:"Module"}));function c3(){const t=new Float32Array(9);return t[0]=1,t[4]=1,t[8]=1,t}function KZe(t){const e=new Float32Array(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function YZe(t,e,n,r,i,s,o,a,l){const c=new Float32Array(9);return c[0]=t,c[1]=e,c[2]=n,c[3]=r,c[4]=i,c[5]=s,c[6]=o,c[7]=a,c[8]=l,c}Object.freeze(Object.defineProperty({__proto__:null,clone:KZe,create:c3,fromValues:YZe},Symbol.toStringTag,{value:"Module"}));function zve(){return new Float32Array(2)}function XZe(t){const e=new Float32Array(2);return e[0]=t[0],e[1]=t[1],e}function L2(t,e){const n=new Float32Array(2);return n[0]=t,n[1]=e,n}function Gve(){return zve()}function Uve(){return L2(1,1)}function Bve(){return L2(1,0)}function Wve(){return L2(0,1)}const ZZe=Gve(),JZe=Uve(),QZe=Bve(),eJe=Wve();Object.freeze(Object.defineProperty({__proto__:null,ONES:JZe,UNIT_X:QZe,UNIT_Y:eJe,ZEROS:ZZe,clone:XZe,create:zve,fromValues:L2,ones:Uve,unitX:Bve,unitY:Wve,zeros:Gve},Symbol.toStringTag,{value:"Module"}));function tJe(t){return t instanceof Float32Array&&t.length>=2}function nJe(t){return Array.isArray(t)&&t.length>=2}function f$(t){return tJe(t)||nJe(t)}var DV;const df=[0,0];let kf=DV=class extends qt{constructor(t){super(t),this._viewpoint2D={center:Vi(),rotation:0,scale:0,spatialReference:void 0},this.center=[0,0],this.extent=new Vn,this.id=0,this.inverseTransform=Ad(),this.resolution=0,this.rotation=0,this.scale=0,this.transform=Ad(),this.transformNoRotation=Ad(),this.displayMat3=c3(),this.displayViewMat3=c3(),this.viewMat3=c3(),this.viewMat2d=Fve(),this.worldScreenWidth=0,this.size=[0,0]}set pixelRatio(t){this._set("pixelRatio",t),this._update()}set size(t){this._set("size",t),this._update()}set viewpoint(t){if(t){const e=this._viewpoint2D,n=t.targetGeometry;e.center[0]=n.x,e.center[1]=n.y,e.rotation=t.rotation,e.scale=t.scale,e.spatialReference=n.spatialReference}this._update()}get visibleArea(){const[t,e]=this.size;return[this.toMap([0,0],0,0),this.toMap([0,0],0,e),this.toMap([0,0],t,e),this.toMap([0,0],t,0)]}copy(t){const e=this.size,n=this.viewpoint;return n&&e?(this.viewpoint=da(n,t.viewpoint),this._set("size",cw(e,t.size))):(this.viewpoint=t.viewpoint.clone(),this._set("size",[t.size[0],t.size[1]])),this._set("pixelRatio",t.pixelRatio),this}clone(){return new DV({size:this.size,viewpoint:this.viewpoint.clone(),pixelRatio:this.pixelRatio})}toMap(t,e,n){return f$(e)?ld(t,e,this.inverseTransform):(df[0]=e,df[1]=n,ld(t,df,this.inverseTransform))}toScreen(t,e,n){return f$(e)?ld(t,e,this.transform):(df[0]=e,df[1]=n,ld(t,df,this.transform))}toScreenNoRotation(t,e,n){return f$(e)?ld(t,e,this.transformNoRotation):(df[0]=e,df[1]=n,ld(t,df,this.transformNoRotation))}wrapMapCoordinate(t,e){cw(t,e);const[n]=e,[r]=this.center,{extent:i,spatialReference:s}=this;let{xmin:o,xmax:a}=i;if(s.isWrappable){const l=Lve(s)/2;o=Math.max(o,r-l),a=Math.min(a,r+l)}return(n<o||n>a)&&(t[0]=WW(n,r,s)),t}getScreenTransform(t,e){const{center:n}=this._viewpoint2D,r=this._get("pixelRatio")||1,i=this._get("size");return YW(t,n,i,e,0,r),t}_update(){const{center:t,spatialReference:e,scale:n,rotation:r}=this._viewpoint2D,i=this._get("pixelRatio")||1,s=this._get("size"),o=new du({targetGeometry:new Jt(t[0],t[1],e),scale:n,rotation:r});if(this._set("viewpoint",o),!s||!e||!n)return;this.resolution=_b(o),this.rotation=r,this.scale=n,this.spatialReference=e,cw(this.center,t);const a=s[0]!==0?2/s[0]:0,l=s[1]!==0?-2/s[1]:0;uw(this.displayMat3,a,0,0,0,l,0,-1,1,1);const c=y0e(this.viewMat3),u=L2(s[0]/2,s[1]/2),h=L2(-s[0]/2,-s[1]/2),f=uW(r);B9(c,c,u),x0e(c,c,f),B9(c,c,h),Kk(this.displayViewMat3,this.displayMat3,c);const g=BW(this.viewMat2d,u);return $I(g,g,f),O2(g,g,h),MZe(this.extent,o,s),XW(this.transform,o,s,i),UW(this.inverseTransform,this.transform),$Ze(this.transformNoRotation,o,s,i),this.worldScreenWidth=FZe(this.spatialReference,this.resolution),this._set("id",this.id+1),this.notifyChange("visibleArea"),this}};x([E({readOnly:!0})],kf.prototype,"id",void 0),x([E({value:1,json:{write:!0}})],kf.prototype,"pixelRatio",null),x([E({json:{write:!0}})],kf.prototype,"size",null),x([E()],kf.prototype,"spatialReference",void 0),x([E({type:du,json:{write:!0}})],kf.prototype,"viewpoint",null),x([E({readOnly:!0})],kf.prototype,"visibleArea",null),kf=DV=x([ue("esri.views.2d.ViewState")],kf);const tre=kf;var jV,$V;let Uf=jV=class extends Kt{constructor(){super(...arguments),this.left=0,this.top=0,this.right=0,this.bottom=0}clone(){return new jV({left:this.left,top:this.top,right:this.right,bottom:this.bottom})}};x([E()],Uf.prototype,"left",void 0),x([E()],Uf.prototype,"top",void 0),x([E()],Uf.prototype,"right",void 0),x([E()],Uf.prototype,"bottom",void 0),Uf=jV=x([ue("esri.views.2d.PaddedViewState.Padding")],Uf);let lx=$V=class extends tre{constructor(...t){super(...t),this.paddedViewState=new tre,this._updateContent=(()=>{const e=Vi();return()=>{const n=this._get("size"),r=this._get("padding");if(!n||!r)return;const i=this.paddedViewState;lo(e,r.left+r.right,r.top+r.bottom),Hk(e,n,e),cw(i.size,e);const s=i.viewpoint;s&&(this.viewpoint=s)}})(),this.addHandles(fn(()=>[this.size,this.padding],()=>this._updateContent(),Ug)),this.padding=new Uf,this.size=[0,0]}set padding(t){this._set("padding",t||new Uf)}set viewpoint(t){if(t){this.paddedViewState.viewpoint=t;let e=t;const n=this._get("padding");n&&(e=zZe(t.clone(),t,this._get("size"),n));const{targetGeometry:r,rotation:i,scale:s}=e,{x:o,y:a,spatialReference:l}=r,c=this._viewpoint2D;c.center[0]=o,c.center[1]=a,c.rotation=i,c.scale=s,c.spatialReference=l,this._update()}}clone(){return new $V({padding:this.padding.clone(),size:this.size.slice(),viewpoint:this.paddedViewState.viewpoint.clone(),pixelRatio:this.pixelRatio})}};x([E()],lx.prototype,"paddedViewState",void 0),x([E({type:Uf})],lx.prototype,"padding",null),x([E()],lx.prototype,"viewpoint",null),lx=$V=x([ue("esri.views.2d.PaddedViewState")],lx);const ZW=lx;let jS=class extends Kt{constructor(){super(...arguments),this.SCHEDULER_LOG_SLOW_TASKS=!1,this.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES=!1}};x([E()],jS.prototype,"SCHEDULER_LOG_SLOW_TASKS",void 0),x([E()],jS.prototype,"FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES",void 0),jS=x([ue("esri.views.support.debugFlags")],jS);const rJe=new jS,Hve=Symbol("Yield");let iJe=class{constructor(){this._tasks=new Array,this._numPendingTasks=N2(0),this._readyToRun=N2(!1)}get length(){return this._tasks.length}get updating(){return this._numPendingTasks.value>0}get readyToRun(){return this._readyToRun.value}_updateReadyToRun(){this._readyToRun.value=this._tasks.length>0}destroy(){this.cancelAll()}runTask(e){if(this.length===0)return Hve;for(;!e.done&&this._process(e);)e.madeProgress()}push(e,n,r){return this._addTask((i,s)=>new rre(i,s,e,n,r),Array.prototype.push)}unshift(e,n,r){return this._addTask((i,s)=>new rre(i,s,e,n,r),Array.prototype.unshift)}pushGenerator(e,n,r){return this._addTask((i,s)=>new sJe(i,s,e,n,r),Array.prototype.push)}_process(e){if(this._tasks.length===0)return!1;const n=this._tasks.shift();this._updateReadyToRun();try{if(ma(n.signal))this._cancelTask(n,Pr());else switch(n.type){case 0:this._processSimple(n,e);break;case 1:this._processGenerator(n,e);break;case 2:this._processIterator(n,e);break;default:}}catch(r){n.reject(r)}return!0}cancelAll(){const e=Pr();for(const n of this._tasks)this._cancelTask(n,e);this._tasks.length=0,this._updateReadyToRun()}_cancelTask(e,n){if(e.abortCallback){const r=e.abortCallback(n);e.type===2&&e.iterator.return&&nre(e.iterator.return()),ga(r)?r.then(e.resolve,e.reject):e.resolve(r)}else e.type===2&&e.iterator.throw&&nre(e.iterator.throw(n)),e.reject(n)}_onIteratorResult(e,n){n.done?e.resolve(n.value):(this._tasks.unshift(e),this._updateReadyToRun())}_processSimple(e,n){const r=e.callback(n);ga(r)?r.then(e.resolve,e.reject):e.resolve(r)}_processGenerator(e,n){const r=e.generatorFunction(n),i=new oJe(e.resolve,e.reject,r,e.signal,e.abortCallback);this._processIterator(i,n)}_processIterator(e,n){const r=e.iterator.next(n);ga(r)?r.then(i=>this._onIteratorResult(e,i),e.reject):this._onIteratorResult(e,r)}_addTask(e,n){return new Promise((r,i)=>{const s=e(r,i);n.call(this._tasks,s),++this._numPendingTasks.value,this._updateReadyToRun()}).finally(()=>--this._numPendingTasks.value)}};function nre(t){ga(t)?t.then(p$,p$):p$(t)}function p$(t){wa(t)||t instanceof Error||t instanceof Xe||t!=null&&typeof t=="object"&&"done"in t&&t.done||kt.getLogger("esri.layers.support.PromiseQueue").warn("Generator iterator was aborted, but it is not done.")}let JW=class{constructor(e,n,r=void 0,i=void 0){this.resolve=e,this.reject=n,this.signal=r,this.abortCallback=i}},rre=class extends JW{constructor(e,n,r,i,s){super(e,n,i,s),this.callback=r,this.type=0}},sJe=class extends JW{constructor(e,n,r,i,s){super(e,n,i,s),this.generatorFunction=r,this.type=1}},oJe=class extends JW{constructor(e,n,r,i,s){super(e,n,i,s),this.iterator=r,this.type=2}};function aJe(){return new dJe}const Ln={RESOURCE_CONTROLLER_IMMEDIATE:"immediate",RESOURCE_CONTROLLER:"schedule",SLIDE:"slide",STREAM_DATA_LOADER:"stream loader",ELEVATION_QUERY:"elevation query",TERRAIN_SURFACE:"terrain",SURFACE_GEOMETRY_UPDATES:"surface geometry updates",LOD_RENDERER:"LoD renderer",GRAPHICS_CORE:"Graphics3D",I3S_CONTROLLER:"I3S",POINT_CLOUD_LAYER:"point cloud",FEATURE_TILE_FETCHER:"feature fetcher",STREAM_CONTROLLER:"stream controller",OVERLAY:"overlay",OVERLAY_RENDERER:"overlay renderer",STAGE:"stage",GRAPHICS_DECONFLICTOR:"graphics deconflictor",FILTER_VISIBILITY:"Graphics3D filter visibility",SCALE_VISIBILITY:"Graphics3D scale visibility",FRUSTUM_VISIBILITY:"Graphics3D frustum visibility",POINT_OF_INTEREST_FREQUENT:"POI frequent",POINT_OF_INTEREST_INFREQUENT:"POI infrequent",LABELER:"labeler",FEATURE_QUERY_ENGINE:"feature query",FEATURE_TILE_TREE:"feature tile tree",FEATURE_TILE_TREE_ACTIVE:"fast feature tile tree",ELEVATION_ALIGNMENT:"elevation alignment",ELEVATION_ALIGNMENT_SCENE:"elevation alignment scene",TEXT_TEXTURE_ATLAS:"text texture atlas",TEXTURE_UNLOAD:"texture unload",LINE_OF_SIGHT_TOOL:"line of sight tool",LINE_OF_SIGHT_TOOL_INTERACTIVE:"interactive line of sight tool",ELEVATION_PROFILE:"elevation profile",SNAPPING:"snapping",SHADOW_ACCUMULATOR:"shadow accumulator",CLOUDS_GENERATOR:"clouds generator",FLOW_GENERATOR:"flow generator",MAPVIEW_FETCH_QUEUE:"mapview fetch queue",MAPVIEW_LAYERVIEW_UPDATE:"mapview layerview update",MAPVIEW_VECTOR_TILE_PARSING_QUEUE:"mapview vector tile parsing queue",NONE:0,TEST_PRIO:1},Hc=0,ire=new Map([[Ln.RESOURCE_CONTROLLER_IMMEDIATE,Hc],[Ln.RESOURCE_CONTROLLER,4],[Ln.SLIDE,Hc],[Ln.STREAM_DATA_LOADER,Hc],[Ln.ELEVATION_QUERY,Hc],[Ln.TERRAIN_SURFACE,1],[Ln.SURFACE_GEOMETRY_UPDATES,1],[Ln.LOD_RENDERER,2],[Ln.GRAPHICS_CORE,2],[Ln.I3S_CONTROLLER,2],[Ln.POINT_CLOUD_LAYER,2],[Ln.FEATURE_TILE_FETCHER,2],[Ln.STREAM_CONTROLLER,2],[Ln.CLOUDS_GENERATOR,2],[Ln.OVERLAY,4],[Ln.OVERLAY_RENDERER,4],[Ln.STAGE,4],[Ln.GRAPHICS_DECONFLICTOR,4],[Ln.FILTER_VISIBILITY,4],[Ln.SCALE_VISIBILITY,4],[Ln.FRUSTUM_VISIBILITY,4],[Ln.POINT_OF_INTEREST_FREQUENT,6],[Ln.POINT_OF_INTEREST_INFREQUENT,30],[Ln.LABELER,8],[Ln.FEATURE_QUERY_ENGINE,8],[Ln.FEATURE_TILE_TREE,16],[Ln.FEATURE_TILE_TREE_ACTIVE,Hc],[Ln.ELEVATION_ALIGNMENT,12],[Ln.ELEVATION_ALIGNMENT_SCENE,14],[Ln.TEXT_TEXTURE_ATLAS,12],[Ln.TEXTURE_UNLOAD,12],[Ln.LINE_OF_SIGHT_TOOL,16],[Ln.LINE_OF_SIGHT_TOOL_INTERACTIVE,Hc],[Ln.SNAPPING,Hc],[Ln.SHADOW_ACCUMULATOR,30],[Ln.FLOW_GENERATOR,12],[Ln.MAPVIEW_FETCH_QUEUE,Hc],[Ln.MAPVIEW_LAYERVIEW_UPDATE,2],[Ln.MAPVIEW_VECTOR_TILE_PARSING_QUEUE,Hc]]);function sre(t){return ire.has(t)?ire.get(t):typeof t=="number"?t:1}const lJe=6.5,ore=1,cJe=30,uJe=1e3/30,hJe=100,are=.9;let dJe=class{get updating(){return this._updating.value}_updatingChanged(){this._updating.value=this._tasks.some(e=>e.needsUpdate)}constructor(){this._updating=N2(!0),this._microTaskQueued=!1,this._frameNumber=0,this.performanceInfo={total:new pT("total"),tasks:new Map},this._frameTaskTimes=new Map,this._budget=new qve,this.state=1,this._tasks=new Array,this._runQueue=new Array,this._load=0,this._forceTask=!1,this._debug=!1,this._debugHandle=fn(()=>rJe.SCHEDULER_LOG_SLOW_TASKS,e=>this._debug=e,ya);for(const e of Object.keys(Ln))this.performanceInfo.tasks.set(Ln[e],new pT(String(Ln[e])))}destroy(){this._tasks.forEach(e=>e.remove()),this._tasks.length=0,this._runQueue.length=0,ii(this._debugHandle),this._microTaskQueued=!1,this._updatingChanged()}taskRunningChanged(e){this._updatingChanged(),e&&this._budget.remaining>0&&!this._microTaskQueued&&(this._microTaskQueued=!0,queueMicrotask(()=>{this._microTaskQueued&&(this._microTaskQueued=!1,this._budget.remaining>0&&this._schedule()&&this._runFrame())}))}registerTask(e,n){const r=new fJe(this,e,n);return this._tasks.push(r),this._updatingChanged(),this.performanceInfo.tasks.has(e)||this.performanceInfo.tasks.set(e,new pT(e)),r}get load(){return this._load}frame(e){if(this._startFrameTaskTimes(),this._updateBudget(e)){const n=this._budget.now();return this._runFrame(),this._recordFrameTaskTimes(this._budget.now()-n),!0}return this._recordFrameTaskTimes(0),!1}_updateBudget(e){this._test&&(this._test.usedBudget=0),++this._frameNumber;let n=lJe,r=e.frameDuration,i=ore;switch(this.state){case 2:n=0,r=Math.max(hJe,e.frameDuration),i=cJe;break;case 1:r=Math.max(uJe,e.frameDuration)}return r=r-e.elapsedFrameTime-n,this.state!==2&&r<ore&&!this._forceTask?(this._forceTask=!0,!1):(r=Math.max(r,i),this._budget.reset(r),this._updateLoad(),this._schedule())}_runFrame(){switch(this._forceTask=!1,this._microTaskQueued=!1,this.state){case 2:this._runIdle();break;case 1:this._runInteracting();break;default:this._runAnimating()}this._test&&(this._test.usedBudget=this._budget.elapsed)}stopFrame(){this._budget.reset(0),this._budget.madeProgress()}removeTask(e){z8(this._tasks,e),z8(this._runQueue,e),this._updatingChanged()}_updateTask(e){this._tasks.forEach(n=>{n.name===e&&n.setPriority(e)})}_getState(e){if(this._runQueue.some(r=>r.name===e))return"s";let n="i";return this._tasks.forEach(r=>{r.name===e&&r.needsUpdate&&(r.schedulePriority<=1?n="r":n!=="r"&&(n="w"))}),n}_getRuntime(e){let n=0;return this._tasks.forEach(r=>{r.name===e&&(n+=r.runtime)}),n}_resetRuntimes(){this._tasks.forEach(e=>e.runtime=0)}_getRunning(){const e=new Map;if(this._tasks.forEach(r=>{r.needsUpdate&&e.set(r.name,(e.get(r.name)||0)+1)}),e.size===0)return null;let n="";return e.forEach((r,i)=>{n+=r>1?` ${r}x ${i}`:` ${i}`}),n}_runIdle(){this._run()}_runInteracting(){this._run()}_runAnimating(){this._run()}_updateLoad(){const e=this._tasks.reduce((n,r)=>r.needsUpdate?++n:n,0);this._load=this._load*are+e*(1-are)}_schedule(){for(a6e(this._runQueue,e=>!!e.needsUpdate||(e.schedulePriority=e.basePriority,!1)),this._tasks.forEach(e=>{e.basePriority===Hc&&e.needsUpdate&&!this._runQueue.includes(e)&&e.blockFrame!==this._frameNumber&&this._runQueue.unshift(e)});this._runQueue.length===0;){let e=!1,n=0;if(this._tasks.forEach(r=>{r.needsUpdate&&r.schedulePriority!==0&&r.basePriority!==Hc&&r.blockFrame!==this._frameNumber&&(e=!0,n=Math.max(n,r.basePriority),r.schedulePriority===1?(r.schedulePriority=0,this._runQueue.push(r)):--r.schedulePriority)}),!e)return this._updatingChanged(),!1}return this._updatingChanged(),!0}_run(){do for(;this._runQueue.length>0;){const e=this._budget.now(),n=this._runQueue.pop();this._budget.resetProgress();try{n.task.runTask(this._budget)===Hve&&(n.blockFrame=this._frameNumber)}catch(i){kt.getLogger("esri.views.support.Scheduler").error(`Exception in task "${n.name}"`,i),n.blockFrame=this._frameNumber}!this._budget.hasProgressed&&n.blockFrame!==this._frameNumber&&n.needsUpdate&&(n.name,n.blockFrame=this._frameNumber),n.schedulePriority=n.basePriority;const r=this._budget.now()-e;if(n.runtime+=r,this._frameTaskTimes.set(n.priority,this._frameTaskTimes.get(n.priority)+r),this._budget.remaining<=0)return void this._updatingChanged()}while(this._schedule());this._updatingChanged()}_startFrameTaskTimes(){for(const e of Object.keys(Ln))this._frameTaskTimes.set(Ln[e],0)}_recordFrameTaskTimes(e){this._frameTaskTimes.forEach((n,r)=>this.performanceInfo.tasks.get(r).push(n)),this.performanceInfo.total.push(e)}get test(){return this._test}},fJe=class{get task(){return this._task.value}get readyToRun(){return this._queue.readyToRun}get updating(){return this._queue.updating}constructor(e,n,r){this._scheduler=e,this.name=n,this.blockFrame=0,this.runtime=0,this._queue=new iJe,this._handles=new cb,this._basePriority=sre(n),this.schedulePriority=this._basePriority,this._task=N2(r??this._queue),this._handles.add(wc(()=>this.task.readyToRun,i=>e.taskRunningChanged(i)))}remove(){this.processQueue(LT),this._scheduler.removeTask(this),this.schedule=m$.schedule,this.reschedule=m$.reschedule,this.scheduleGenerator=m$.scheduleGenerator,this._handles.destroy()}get basePriority(){return this._basePriority}setPriority(e){if(this.name===e)return;this.name=e;const n=sre(e);this._basePriority!==Hc&&this.schedulePriority===0||(this.schedulePriority=n),this._basePriority=n}get priority(){return this.name}set priority(e){this.setPriority(e)}get needsUpdate(){return this.readyToRun||!this.task.destroyed&&this.task.readyToRun}schedule(e,n,r){return this._queue.push(e,n,r)}reschedule(e,n,r){return this._queue.unshift(e,n,r)}scheduleGenerator(e,n,r){return this._queue.pushGenerator(e,n,r)}processQueue(e){return this._queue.runTask(e)}},qve=class{constructor(){this._begin=performance?.now()??0,this._budget=0,this._done=!1,this._progressed=!1,this._enabled=!0}run(e){return!this.done&&(e()===!0&&this.madeProgress(),!0)}get done(){return this._done}get budget(){return this._budget}madeProgress(){return this._progressed=!0,this._done=this.elapsed>=this._budget&&this._enabled,this._done}get enabled(){return this._enabled}set enabled(e){this._enabled=e}reset(e){this._begin=this.now(),this._budget=e,this.resetProgress()}get remaining(){return Math.max(this._budget-this.elapsed,0)}now(){return performance.now()}get elapsed(){return this.now()-this._begin}resetProgress(){this._progressed=!1,this._done=!1}get hasProgressed(){return this._progressed}};const LT=new qve;LT.enabled=!1;let pJe=class{remove(){}processQueue(){}schedule(e,n,r){try{if(ma(n)){const i=Pr();return r?Promise.resolve(r(i)):Promise.reject(i)}return q8(e(LT))}catch(i){return Promise.reject(i)}}reschedule(e,n,r){return this.schedule(e,n,r)}async scheduleGenerator(e,n,r){if(ma(n)){const s=Pr();if(r)return r(s);throw s}const i=e(LT);for(;;){const s=i.next(LT),o=ga(s)?await s:s;if(ma(n)){const a=Pr();if(r){const c=r(a),u=i.return(null);return ga(u)&&await M4(u),c}const l=i.throw(a);throw ga(l)&&await M4(l),a}if(o.done)return o.value}}};const m$=new pJe;let mJe=class{constructor(e){this.view=e,this._stationaryHandle=null,this._frameTaskHandle=null,this._updateParameters=null,this._updateRequested=!1,this._scheduler=aJe(),this._schedulerHandle=wc(()=>this._scheduler.updating,()=>this.requestFrame()),this.stationary=!0,this.prepare=()=>{this._updateParameters&&(this._updateParameters.state=this.view.state,this._updateParameters.stationary=this.view.stationary,this._updateParameters.pixelRatio=window.devicePixelRatio,this._updateParameters.renderingOptions=this.view.renderingOptions,this._updateParameters.targetState.copy(this.view.state),this.view.animation?.target==null||ga(this.view.animation.target)||(this._updateParameters.targetState.viewpoint=this.view.animation.target))},this.update=n=>{if(this._updateRequested=!1,this.view?.destroyed)return;const{allLayerViews:r,graphicsView:i,labelManager:s,state:{id:o}}=this.view;r?.forEach(this._updateLayerView,this),s!=null&&(s.lastUpdateId!==o&&(s.viewChange(),s.lastUpdateId=o),s.updateRequested&&s.processUpdate(this._updateParameters)),i!=null&&(i.lastUpdateId!==o&&(i.viewChange(),i.lastUpdateId=o),i.updateRequested&&i.processUpdate(this._updateParameters)),this.view.graphicsTileStore?.setViewState(this._updateParameters.state),this.view.animation?this._scheduler.state=0:this.view.interacting?this._scheduler.state=1:this._scheduler.state=2,this._scheduler.frame(n)||this._updateRequested||this._scheduler.state!==2||this._frameTaskHandle?.pause()}}destroy(){this.stop(),this._schedulerHandle.remove(),this._scheduler.destroy()}get scheduler(){return this._scheduler}start(){if(this._frameTaskHandle)return;const e=this.view;this.stationary=e.stationary,this._updateParameters={state:e.state,targetState:new ZW,pixelRatio:window.devicePixelRatio,stationary:this.stationary,renderingOptions:e.renderingOptions},this._stationaryHandle=fn(()=>e.stationary,n=>{this.stationary=n,this.requestFrame()}),this._frameTaskHandle=x2(this),this.requestUpdate()}stop(){this._frameTaskHandle&&(this._updateRequested=!1,this._stationaryHandle?.remove(),this._frameTaskHandle.remove(),this._updateParameters=this._stationaryHandle=this._frameTaskHandle=null,this.stationary=!0)}requestUpdate(){this._updateRequested||(this._updateRequested=!0,this.requestFrame())}requestFrame(){this._frameTaskHandle&&this._frameTaskHandle.resume()}_updateLayerView(e){if(!e.attached)return void this.requestUpdate();const n=this.view.state,r=e.lastUpdateId;r!=null&&(this.stationary||e.moving)||(e.moving=!0),r!==n.id&&e.viewChange(),this.stationary&&e.moving&&(e.moving=!1,e.moveEnd()),e.lastUpdateId=n.id,e.updateRequested&&e.processUpdate(this._updateParameters),"layerViews"in e&&e.layerViews?.forEach(this._updateLayerView,this)}};function gJe(t,e){const{spatialReference:n}=e,r=[e.x,e.y];let i,s,o,a;const l=[0,0],c=yJe(t);for(let f=0;f<c.length;f++){const g=c[f];for(let y=0;y<g.length-1;y++){Nze(l,r,g,y);const _=qO(r,l);(i==null||_<i)&&(i=_,s=[...l],o=f,a=y)}}if(i==null||!s||o==null||a==null)throw new Xe("nearest-coordinate:failed","Failed to find the nearest coordinate");const[u,h]=s;return{coordinate:new Jt({x:u,y:h,spatialReference:n}),distance:i}}function yJe(t){switch(t.type){case"extent":return[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]];case"polygon":return t.rings;case"polyline":return t.paths}}var FV;let Iy=FV=class extends rW(Kt){constructor(t){super(t),this.geometry=null,this.spatialReference=null}get normalizedGeometry(){if(this.geometry==null||!this.spatialReference)return null;if(!this.spatialReference.equals(this.geometry.spatialReference))try{return yv(this.geometry,this.spatialReference)}catch(t){return kt.getLogger(this).error("#constraints.geometry","could not project the geometry to the view's spatial reference",{geometry:this.geometry,spatialReference:this.spatialReference,error:t}),null}return this.geometry}constrain(t,e){if(this.normalizedGeometry==null)return t;const n=t.targetGeometry;if(this.normalizedGeometry.type==="extent"?wI(this.normalizedGeometry,n):FB(this.normalizedGeometry,n))return t;const{coordinate:r}=gJe(this.normalizedGeometry,n);return r&&(t.targetGeometry=r),t}clone(){return new FV({geometry:this.geometry?.clone(),spatialReference:this.spatialReference?.clone()})}};x([E({constructOnly:!0})],Iy.prototype,"geometry",void 0),x([E({readOnly:!0})],Iy.prototype,"normalizedGeometry",null),x([E({constructOnly:!0})],Iy.prototype,"spatialReference",void 0),Iy=FV=x([ue("esri.views.2d.constraints.GeometryConstraint")],Iy);var VV;let $S=VV=class extends rW(Kt){constructor(){super(...arguments),this.enabled=!0,this.rotationEnabled=!0}constrain(t,e){return this.enabled&&e&&(this.rotationEnabled||(t.rotation=e.rotation)),t}clone(){return new VV({enabled:this.enabled,rotationEnabled:this.rotationEnabled})}};x([E()],$S.prototype,"enabled",void 0),x([E()],$S.prototype,"rotationEnabled",void 0),$S=VV=x([ue("esri.views.2d.constraints.RotationConstraint")],$S);const Kve=$S;var zV;let nl=zV=class extends rW(Kt){constructor(t){super(t),this._lodByScale={},this._scales=[],this.effectiveLODs=null,this.effectiveMinZoom=-1,this.effectiveMaxZoom=-1,this.effectiveMinScale=0,this.effectiveMaxScale=0,this.lods=null,this.minZoom=-1,this.maxZoom=-1,this.minScale=0,this.maxScale=0,this.snapToZoom=!0}initialize(){let t,{lods:e,minScale:n,maxScale:r,minZoom:i,maxZoom:s}=this,o=-1,a=-1,l=!1,c=!1;if(n!==0&&r!==0&&n<r&&([n,r]=[r,n]),!e?.length)return this._set("effectiveMinScale",n),void this._set("effectiveMaxScale",r);e=e.map(u=>u.clone()),e.sort((u,h)=>h.scale-u.scale),e.forEach((u,h)=>u.level=h);for(const u of e)!l&&n>0&&n>=u.scale&&(o=u.level,l=!0),!c&&r>0&&r>=u.scale&&(a=t?t.level:-1,c=!0),t=u;i===-1&&(i=n===0?0:o),s===-1&&(s=r===0?e.length-1:a),i=Math.max(i,0),i=Math.min(i,e.length-1),s=Math.max(s,0),s=Math.min(s,e.length-1),i>s&&([i,s]=[s,i]),n=e[i].scale,r=e[s].scale,e.splice(0,i),e.splice(s-i+1),e.forEach((u,h)=>{this._lodByScale[u.scale]=u,this._scales[h]=u.scale}),this._set("effectiveLODs",e),this._set("effectiveMinZoom",i),this._set("effectiveMaxZoom",s),this._set("effectiveMinScale",n),this._set("effectiveMaxScale",r)}constrain(t,e){if(e&&t.scale===e.scale)return t;const n=this.effectiveMinScale,r=this.effectiveMaxScale,i=t.targetGeometry,s=e&&e.targetGeometry,o=r!==0&&t.scale<r,a=n!==0&&t.scale>n;if(o||a){const l=a?n:r;if(e&&s){const c=(l-e.scale)/(t.scale-e.scale);i.x=s.x+(i.x-s.x)*c,i.y=s.y+(i.y-s.y)*c}t.scale=l}return this.snapToZoom&&this.effectiveLODs&&(t.scale=this._getClosestScale(t.scale)),t}fit(t){if(!this.effectiveLODs||!this.snapToZoom)return this.constrain(t,null);const e=this.scaleToZoom(t.scale),n=Math.abs(e-Math.floor(e));return t.scale=this.zoomToScale(n>.99?Math.round(e):Math.floor(e)),t}zoomToScale(t){if(!this.effectiveLODs)return 0;t-=this.effectiveMinZoom,t=Math.max(0,t);const e=this._scales;if(t<=0)return e[0];if(t>=e.length)return e[e.length-1];const n=Math.floor(t),r=Math.ceil(t);return e[n]+(t-n)*(e[r]-e[n])}scaleToZoom(t){if(!this.effectiveLODs)return-1;const e=this._scales;let n,r;if(t>=e[0])return this.effectiveMinZoom;if(t<=e[e.length-1])return this.effectiveMaxZoom;for(let i=0;i<e.length-1;i++){if(n=e[i],r=e[i+1],r===t)return i+this.effectiveMinZoom+1;if(n>t&&r<t)return i+this.effectiveMinZoom+1-(t-r)/(n-r)}return-1}snapToClosestScale(t){if(!this.effectiveLODs)return t;const e=this.scaleToZoom(t);return this.zoomToScale(Math.round(e))}snapToNextScale(t,e=.5){if(!this.effectiveLODs)return t*e;const n=Math.round(this.scaleToZoom(t));return this.zoomToScale(n+1)}snapToPreviousScale(t,e=2){if(!this.effectiveLODs)return t*e;const n=Math.round(this.scaleToZoom(t));return this.zoomToScale(n-1)}clone(){return new zV({lods:this.lods,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,maxScale:this.maxScale})}_getClosestScale(t){return this._lodByScale[t]||(t=this._scales.reduce((e,n)=>Math.abs(n-t)<=Math.abs(e-t)?n:e,this._scales[0])),this._lodByScale[t].scale}};x([E({readOnly:!0})],nl.prototype,"effectiveLODs",void 0),x([E({readOnly:!0})],nl.prototype,"effectiveMinZoom",void 0),x([E({readOnly:!0})],nl.prototype,"effectiveMaxZoom",void 0),x([E({readOnly:!0})],nl.prototype,"effectiveMinScale",void 0),x([E({readOnly:!0})],nl.prototype,"effectiveMaxScale",void 0),x([E()],nl.prototype,"lods",void 0),x([E()],nl.prototype,"minZoom",void 0),x([E()],nl.prototype,"maxZoom",void 0),x([E()],nl.prototype,"minScale",void 0),x([E()],nl.prototype,"maxScale",void 0),x([E()],nl.prototype,"snapToZoom",void 0),nl=zV=x([ue("esri.views.2d.constraints.ZoomConstraint")],nl);const Yve=nl,vJe={base:null,key:"type",typeMap:{extent:Vn,polygon:wi}};let Bi=class extends Kt{constructor(e){super(e),this.lods=null,this.minScale=0,this.maxScale=0,this.minZoom=-1,this.maxZoom=-1,this.rotationEnabled=!0,this.snapToZoom=!0,this.customConstraints=new Ot}destroy(){this.view=null}get effectiveLODs(){return this._zoom.effectiveLODs}get effectiveMinScale(){return this._zoom.effectiveMinScale}get effectiveMaxScale(){return this._zoom.effectiveMaxScale}get effectiveMinZoom(){return this._zoom.effectiveMinZoom}get effectiveMaxZoom(){return this._zoom.effectiveMaxZoom}set geometry(e){e?this._set("geometry",e):this._set("geometry",null)}get version(){return`${this._zoom?.uid}/${this._rotation?.uid}/${this._geometry?.uid}`}get _geometry(){const e=this._get("_geometry");return e&&this.geometry===e.geometry&&this.view?.constraintsInfo.spatialReference===e.spatialReference?e:new Iy({geometry:this.geometry,spatialReference:this.view?.constraintsInfo.spatialReference})}get _rotation(){return new Kve({rotationEnabled:this.rotationEnabled})}get _zoom(){const e=this._get("_zoom"),n=this.lods||this.view?.constraintsInfo.lods,r=this.minZoom,i=this.maxZoom,s=this.minScale,o=this.maxScale,a=this.snapToZoom;return e&&e.lods===n&&e.minZoom===r&&e.maxZoom===i&&e.minScale===s&&e.maxScale===o&&e.snapToZoom===a?e:new Yve({lods:n,minZoom:r,maxZoom:i,minScale:s,maxScale:o,snapToZoom:a})}canZoomInTo(e){const n=this.effectiveMaxScale;return n===0||e>=n}canZoomOutTo(e){const n=this.effectiveMinScale;return n===0||e<=n}constrain(e,n){return this._zoom.constrain(e,n),this._rotation.constrain(e,n),this._geometry.constrain(e,n),this.customConstraints.forEach(r=>r.constrain(e,n)),e}constrainByGeometry(e){return this._geometry.constrain(e),this.customConstraints.forEach(n=>n.applyPanConstraint?.(e)),e}fit(e){return this._zoom.fit(e)}zoomToScale(e){return this._zoom.zoomToScale(e)}scaleToZoom(e){return this._zoom.scaleToZoom(e)}snapScale(e){return this._zoom.snapToClosestScale(e)}snapToNextScale(e){return this._zoom.snapToNextScale(e)}snapToPreviousScale(e){return this._zoom.snapToPreviousScale(e)}};x([E({readOnly:!0})],Bi.prototype,"effectiveLODs",null),x([E({readOnly:!0})],Bi.prototype,"effectiveMinScale",null),x([E({readOnly:!0})],Bi.prototype,"effectiveMaxScale",null),x([E({readOnly:!0})],Bi.prototype,"effectiveMinZoom",null),x([E({readOnly:!0})],Bi.prototype,"effectiveMaxZoom",null),x([E({types:vJe,value:null})],Bi.prototype,"geometry",null),x([E({type:[Co]})],Bi.prototype,"lods",void 0),x([E()],Bi.prototype,"minScale",void 0),x([E()],Bi.prototype,"maxScale",void 0),x([E()],Bi.prototype,"minZoom",void 0),x([E()],Bi.prototype,"maxZoom",void 0),x([E()],Bi.prototype,"rotationEnabled",void 0),x([E()],Bi.prototype,"snapToZoom",void 0),x([E({type:Ot})],Bi.prototype,"customConstraints",void 0),x([E()],Bi.prototype,"view",void 0),x([E({readOnly:!0})],Bi.prototype,"version",null),x([E({type:Iy,readOnly:!0})],Bi.prototype,"_geometry",null),x([E({type:Kve})],Bi.prototype,"_rotation",null),x([E({readOnly:!0,type:Yve})],Bi.prototype,"_zoom",null),Bi=x([ue("esri.views.2d.MapViewConstraints")],Bi);const lre=Bi;let Xo=class extends Kt{constructor(e){super(e),this.constraints=null,this.ready=!1,this.resizeAlign="center",this.addHandles([fn(()=>this.constraints?.version,n=>{this.constraints&&n&&this.ready&&(this.state.viewpoint=this.constraints.fit(this.state.paddedViewState.viewpoint))},Ug)])}get center(){if(!this.ready)return this._get("center");const{center:e,spatialReference:n}=this.state.paddedViewState;return this.state.commitProperty("id"),new Jt({x:e[0],y:e[1],spatialReference:n})}set center(e){if(e==null)return;if(!this.ready)return void this._set("center",e);let n;try{n=this._project(e,this.state.spatialReference)}catch(i){return void kt.getLogger(this).error(new Xe("mapview:invalid-center","could not project the value in the view's spatial reference",{input:e,error:i}))}const r=this.viewpoint;LV(r,r,n),this.viewpoint=r}get extent(){return this.ready?(this.state.commitProperty("id"),this.state.paddedViewState.extent.clone()):this._get("extent")}set extent(e){if(e==null)return;if(!e.width||!e.height)return void kt.getLogger(this).error(new Xe("mapview:invalid-extent","invalid extent size"));if(!this.ready)return this._set("extent",e),this._set("center",void 0),this._set("viewpoint",void 0),this._set("scale",void 0),void this._set("zoom",void 0);let n;try{n=this._project(e,this.state.spatialReference)}catch(i){return void kt.getLogger(this).error(new Xe("mapview:invalid-extent","could not project the value in the view's spatial reference",{error:i}))}const r=this.viewpoint;NZe(r,r,n,this.state.size,{constraints:this.constraints}),this.viewpoint=r}get padding(){return this.ready?this.state.padding:this._get("padding")}set padding(e){this.ready?(this.state.padding=e,this._set("padding",this.state.padding)):this._set("padding",e)}get resolution(){return this.ready?(this.state.commitProperty("id"),this.state.resolution):0}get rotation(){return this.ready?(this.state.commitProperty("id"),this.state.rotation):this._get("rotation")}set rotation(e){if(isNaN(e))return;if(!this.ready)return void this._set("rotation",e);const n=this.viewpoint;UZe(n,n,e),this.viewpoint=n}get scale(){return this.ready?(this.state.commitProperty("id"),this.state.scale):this._get("scale")}set scale(e){if(!e||isNaN(e))return;if(!this.ready){this._set("scale",e),this._set("zoom",void 0);const r=this._get("extent");return void(r&&(this._set("extent",void 0),this._set("center",r.center)))}const n=this.viewpoint;ere(n,n,e),this.viewpoint=n}get viewpoint(){return this.ready?this.state.paddedViewState.viewpoint.clone():this._get("viewpoint")}set viewpoint(e){if(e==null)return;if(!this.ready)return this._set("viewpoint",e),this._set("extent",void 0),this._set("center",void 0),this._set("zoom",void 0),void this._set("scale",void 0);let n,r;try{n=this._project(e,this.state.spatialReference),!e.scale||isNaN(e.scale)?r=new Xe("mapview:invalid-viewpoint",`invalid scale value of ${e.scale}`):e.targetGeometry==null&&(r=new Xe("mapview:invalid-viewpoint","geometry not defined"))}catch(s){r=new Xe("mapview:invalid-viewpoint","could not project the value in the view's spatial reference",{error:s})}if(r)return void kt.getLogger(this).error(r);this._scaleBeforeChangingSpatialReference=null;const i=new du({targetGeometry:new Jt,scale:0,rotation:0});da(i,n),this.constraints?.constrain(i,this.state.paddedViewState.viewpoint),this.state.viewpoint=i,this._set("viewpoint",i)}get visibleArea(){return this.ready?this.state.visibleArea:null}get zoom(){return this.ready?this.constraints?.scaleToZoom(this.scale)??-1:this._get("zoom")}set zoom(e){if(!(e>=0))return;if(!this.ready){this._set("zoom",e),this._set("scale",void 0);const i=this._get("extent");return void(i&&(this._set("extent",void 0),this._set("center",i.center)))}const n=this.constraints?.zoomToScale(e)??0;if(!n)return void this._set("zoom",-1);const r=this.viewpoint;ere(r,r,n),this.viewpoint=r,this._set("zoom",this.constraints?.scaleToZoom(this.scale)??-1)}getUserStartupOptions(e){if(!e[0]&&!e[1])return{center:void 0,rotation:void 0,scale:void 0};const{padding:n,constraints:r}=this,i=this._get("center"),s=this._get("extent"),o=this._get("scale"),a=this._get("rotation"),l=this._get("viewpoint"),c=this._get("zoom"),u=c!=null&&r!=null&&r.zoomToScale(c)||void 0;let h,f,g;const y=l?.rotation,_=l?.targetGeometry;_?.type==="extent"?h=_:_?.type==="point"&&(f=_,g=l?.scale);const b=s??h;return{center:i??f??b?.center,rotation:a??y,scale:(o??u??g??(b&&oL(b,[e[0]-n.left-n.right,e[1]-n.top-n.bottom])))||void 0}}startup(e,n,r,i){const s=e.targetGeometry;try{this._project(e,r)}catch(o){kt.getLogger(this).warn(new Ld("mapview:startup-projection-error","projection of initial viewpoint to the view's spatial reference, defaulting to the initial viewpoint.",{center:s.toJSON(),spatialReference:r,error:o})),e.targetGeometry=i||new Jt({x:0,y:0,spatialReference:r})}this.constraints?.fit(e),this._set("state",new ZW({padding:this.padding,size:n,viewpoint:e})),this._set("ready",!0)}teardown(){this._set("ready",!1);const{center:[e,n],spatialReference:r,rotation:i,scale:s}=this.state.paddedViewState,o=new Jt({x:e,y:n,spatialReference:r});this._set("viewpoint",null),this._set("extent",null),this._set("center",o),this._set("zoom",-1),this._set("rotation",i),this._set("scale",s),this._set("state",null)}changeSpatialReference(e){const n=this.state.paddedViewState.clone();if(this._scaleBeforeChangingSpatialReference==null)this._scaleBeforeChangingSpatialReference=n.scale;else{const l=n.viewpoint.clone();l.scale=this._scaleBeforeChangingSpatialReference,n.viewpoint=l}const r=n.clone(),[i,s]=n.center;let o=null;try{o=this._project(new Jt({x:i,y:s,spatialReference:n.spatialReference}),e)}catch(l){Vpe()||kt.getLogger(this).warn(new Ld("mapview:spatial-reference-change","could not project the view's center to the new spatial reference",{center:o?.toJSON(),spatialReference:e,error:l}))}o||(o=new Jt({x:0,y:0,spatialReference:e}));const a=LV(new du({targetGeometry:new Jt,scale:0,rotation:0}),n.viewpoint,o);r.viewpoint=a;try{const c=[n.size[0]/2,n.size[1]/2],u=[c[0]+20,c[1]],h=n.toMap([0,0],u),{x:f,y:g}=this._project(new Jt({x:h[0],y:h[1],spatialReference:n.spatialReference}),e);h[0]=f,h[1]=g,r.toScreen(h,h);const y=VZe(c,h,u),_=Math.hypot(h[0]-c[0],h[1]-c[1])/20;!Number.isFinite(_)||Math.abs(_)>4?(a.rotation=0,a.targetGeometry=new Jt({x:0,y:0,spatialReference:e})):(a.scale*=_,a.scale>ye("mapview-srswitch-adjust-rotation-scale-threshold")?a.rotation=0:a.rotation+=Number.isFinite(y)?y:0)}catch{}this._get("constraints")?.constrain(a,void 0),this._get("state").viewpoint=a}resize(e,n){if(!this.ready)return;const r=this.state;let i=this.state.paddedViewState.viewpoint;const s=this.state.paddedViewState.size.slice();r.size=[e,n],GZe(i,i,s,this.state.paddedViewState.size,this.resizeAlign),i=this.constraints?.constrain(i,void 0)??i,this.state.viewpoint=i}toMap(e){if(!this.ready)return null;const n=[0,0],[r,i]=this.state.toMap(n,[e.x,e.y]),s=this.state.spatialReference;return new Jt({x:r,y:i,spatialReference:s})}toScreen(e,n){if(!this.ready)return null;const r=this._project(e,this.state.spatialReference),i=[r.x,r.y];return n?.pickClosestTarget===!1||this.state.paddedViewState.wrapMapCoordinate(i,i),this.state.toScreen(i,i),Hs(i[0],i[1])}_project(e,n){const r=e?.targetGeometry||e;if(!n)return e;if(!r)return null;if(n.imageCoordinateSystem||r.spatialReference?.imageCoordinateSystem||go(n,r.spatialReference))return e;const i=yv(r,n);if(!i)throw new Xe("mapview:projection-not-possible","projecting input geometry to target spatial reference returned a null value",{geometry:r,spatialReference:n});return _Je(e)?(e.targetGeometry=i,e):i}};function _Je(t){return t?.declaredClass==="esri.Viewpoint"}x([E({type:Jt})],Xo.prototype,"center",null),x([E()],Xo.prototype,"constraints",void 0),x([E({type:Vn})],Xo.prototype,"extent",null),x([E({value:{top:0,right:0,bottom:0,left:0},cast:t=>({top:0,right:0,bottom:0,left:0,...t})})],Xo.prototype,"padding",null),x([E()],Xo.prototype,"ready",void 0),x([E()],Xo.prototype,"resizeAlign",void 0),x([E({readOnly:!0})],Xo.prototype,"resolution",null),x([E({type:Number})],Xo.prototype,"rotation",null),x([E({type:Number})],Xo.prototype,"scale",null),x([E({readOnly:!0})],Xo.prototype,"state",void 0),x([E({type:du})],Xo.prototype,"viewpoint",null),x([E({readOnly:!0})],Xo.prototype,"visibleArea",null),x([E()],Xo.prototype,"zoom",null),Xo=x([ue("esri.views.2d.ViewStateManager")],Xo);const cre=160;let FS=class extends Kt{constructor(){super(...arguments),this._timer=void 0}get stationary(){return!this._timer}flip(){this._timestamp=performance.now(),this._timer==null&&(this._timer=setInterval(()=>{performance.now()-this._timestamp>=cre&&this.clear()},cre))}clear(){this._timer&&(clearInterval(this._timer),this._timer=void 0)}};x([E()],FS.prototype,"_timer",void 0),x([E()],FS.prototype,"stationary",null),FS=x([ue("esri.views.2d.support.StationaryManager")],FS);const xJe=t=>{const e=t;let n=class extends e{constructor(...r){super(...r),this.fullOpacity=1,this.stateManager=new Xo({constraints:new lre({view:this})}),this.stationaryManager=new FS,this.mapViewNavigation=null,this.renderingOptions={samplingMode:"dynamic",edgeLabelsVisible:!1,labelsAnimationTime:0,labelCollisionsEnabled:!1},this.frameTask=new mJe(this),this.viewEvents=new sve(this),this.padding={top:0,right:0,bottom:0,left:0},this.addHandles([fn(()=>this.viewpoint,()=>this.stationaryManager.flip(),Ug)])}get constraintsInfo(){return{lods:null,spatialReference:null}}get extent(){return this.stateManager?.extent??null}set extent(r){this.stateManager.extent=r}get state(){return this.stateManager.state}get interacting(){return!1}get stationary(){return!this.animation&&this.stationaryManager.stationary}set animation(r){const i=this._get("animation");if(r===i)return;if(i&&i.stop(),r!==this.animationManager.animation&&this.animationManager.stop(),!r||r.isFulfilled())return void this._set("animation",null);this._set("animation",r);const s=()=>{this.destroyed||r===this._get("animation")&&(this._set("animation",null),this.frameTask?.requestFrame())};r.when(s,s)}get constraints(){return this.stateManager?.constraints}set constraints(r){r.view=this;const i=this.stateManager.constraints;this.stateManager.constraints=r,i?.destroy()}get padding(){return this.stateManager?.padding}set padding(r){this.stateManager&&(this.stateManager.padding=r)}get resizeAlign(){return this.stateManager.resizeAlign}set resizeAlign(r){this.stateManager.resizeAlign=r}get rotation(){return this.stateManager.rotation??0}set rotation(r){const{rotationEnabled:i}=this.constraints;this.constraints.rotationEnabled=!0,this.stateManager.rotation=r,this.constraints.rotationEnabled=i}get viewpoint(){return this.stateManager.viewpoint??null}set viewpoint(r){this.stateManager.viewpoint=r,this.frameTask.requestFrame()}};return x([E({readOnly:!0})],n.prototype,"animationManager",void 0),x([E({readOnly:!0})],n.prototype,"fullOpacity",void 0),x([E()],n.prototype,"stateManager",void 0),x([E()],n.prototype,"constraintsInfo",null),x([E()],n.prototype,"extent",null),x([E({readOnly:!0})],n.prototype,"state",null),x([E({readOnly:!0})],n.prototype,"mapViewNavigation",void 0),x([E()],n.prototype,"renderingOptions",void 0),x([E({readOnly:!0})],n.prototype,"interacting",null),x([E()],n.prototype,"stationary",null),x([E()],n.prototype,"animation",null),x([E({type:lre})],n.prototype,"constraints",null),x([E()],n.prototype,"padding",null),x([E()],n.prototype,"resizeAlign",null),x([E()],n.prototype,"rotation",null),x([E({readOnly:!0})],n.prototype,"viewEvents",void 0),x([E({type:du})],n.prototype,"viewpoint",null),n=x([ue("esri.views.Viewport2DBaseMixin")],n),n},wJe=()=>nr.respectPrefersReducedMotion&&window.matchMedia("(prefers-reduced-motion: reduce)").matches;var Ww;let cx=(Ww=class extends CB{constructor(e){super(e),this.state="running",this.target=null,this._resolver=null}initialize(){this._resolver=xc(),this.addResolvingPromise(this._resolver.promise)}get done(){return this.state==="finished"||this.state==="stopped"}stop(){this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","stopped"),this._resolver?.reject(new Xe("view:animation-stopped","ViewAnimation stopped")))}finish(){this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","finished"),this._resolver?.resolve())}update(e,n){n||(n=ga(e)?"waiting-for-target":"running"),this._set("target",e),this._set("state",n)}},Ww.state={RUNNING:"running",STOPPED:"stopped",FINISHED:"finished",WAITING_FOR_TARGET:"waiting-for-target"},Ww);x([E({readOnly:!0})],cx.prototype,"done",null),x([E({readOnly:!0,type:String})],cx.prototype,"state",void 0),x([E()],cx.prototype,"target",void 0),cx=x([ue("esri.views.ViewAnimation")],cx);const GV=cx;let u3=class extends Kt{constructor(e){super(e),this._gotoTask=null}destroy(){this._gotoTask=null}async goTo(e,n){if(!e)return void kt.getLogger(this).error("#goTo()","target cannot be null or undefined");const r=new GV;this.view.animation=r,await tW(()=>this.view.ready,n);const i={...n,animate:n?.animate??(!wJe()&&this.view.animationsEnabled),animationMode:n?.animationMode??"auto"},{extent:s,spatialReference:o,size:a,viewpoint:l,constraints:c,padding:u,allLayerViews:h}=this.view,f=CZe(e,{extent:s,spatialReference:o,size:a,viewpoint:l,constraints:c,padding:u,allLayerViews:h,pickClosestTarget:n?.pickClosestTarget??!0});return r?.update(f),this._gotoTask={},i.animate?this._gotoAnimated(f,i):this._gotoImmediate(f,i)}_gotoImmediate(e,n){const r=this._gotoTask,i=this.view.animation,s=e.then(o=>{if(pi(n),r!==this._gotoTask)throw new Xe("view:goto-interrupted","Goto was interrupted");this.view.viewpoint=i.target=o,i.finish()});return this._cancellableGoTo(r,i,s,n)}_gotoAnimated(e,n){const r=this._gotoTask,i=this.view.animation;if(!i)return Promise.resolve();const s=e.then(o=>{if(pi(n),r!==this._gotoTask)throw new Xe("view:goto-interrupted","Goto was interrupted");return i.update(o),this.view.animationManager.animate(i,this.view.viewpoint,n),i.when().then(()=>{},()=>{})});return this._cancellableGoTo(r,i,s,n)}_cancellableGoTo(e,n,r,i){const s=()=>e===this._gotoTask;return ije(r,i).finally(()=>{s()&&(n.done||n.stop())})}};x([E({constructOnly:!0})],u3.prototype,"view",void 0),u3=x([ue("esri.views.2d.GoToManager")],u3);function Xve(t,e){switch(e){case"primary":return t.pointerType==="touch"||t.button===0;case"secondary":return t.pointerType!=="touch"&&t.button===2;case"tertiary":return t.pointerType!=="touch"&&t.button===1}}function Zve(t,e){return e.some(n=>Xve(t,n))}function ure(t,{dragPrimary:e,dragSecondary:n,dragTertiary:r}){return[{key:"primary",value:e},{key:"secondary",value:n},{key:"tertiary",value:r}].filter(i=>i.value===t).map(i=>i.key)}let hre=class extends Zs{constructor(e,n){super(!0),this._view=e,this.registerIncoming("double-click",n,r=>this._handleDoubleClick(r,n))}_handleDoubleClick(e,n){Xve(e.data,"primary")&&(e.stopPropagation(),n?this._view.mapViewNavigation.zoomOut([e.data.x,e.data.y]):this._view.mapViewNavigation.zoomIn([e.data.x,e.data.y]))}},bJe=class extends Zs{constructor(e,n,r){super(!0),this.view=e,this.pointerType=n,this.registerIncoming("double-tap-drag",r,i=>this._handleDoubleTapDrag(i))}_handleDoubleTapDrag(e){const{data:n}=e,{pointerType:r}=n;if(r!==this.pointerType)return;e.stopPropagation();const{action:i,delta:s}=n,{view:o}=this,{mapViewNavigation:a}=o;switch(i){case"begin":{const{scale:l}=o;this._startScale=l,this._currentScale=l,this._previousDelta=s,a.begin();break}case"update":{if(this._previousDelta.y===s.y)return;this._previousDelta=s;const l=1.015**s.y,c=this._startScale*l,u=c/this._currentScale;a.setViewpointImmediate(u),this._currentScale=c;break}case"end":{const{constraints:l}=o,{effectiveLODs:c,snapToZoom:u}=l;if(!u||!c)return void a.end();const h=l.snapScale(this._currentScale),f=(s.y>0?Math.max(h,l.snapToPreviousScale(this._startScale)):Math.min(h,l.snapToNextScale(this._startScale)))/this._currentScale;a.zoom(f).then(()=>{a.end()});break}}}},lL=class{constructor(e){this._callbacks=e,this._currentCount=0,this._callbacks.condition||(this._callbacks.condition=()=>!0)}handle(e){const n=e.data,r=n.pointers.size;switch(n.action){case"start":this._currentCount=r,this._emitStart(e);break;case"added":this._emitEnd(this._previousEvent),this._currentCount=r,this._emitStart(e);break;case"update":this._emitUpdate(e);break;case"removed":this._startEvent&&this._emitEnd(this._previousEvent),this._currentCount=r,this._emitStart(e);break;case"end":this._emitEnd(e),this._currentCount=0}this._previousEvent=e}_emitStart(e){this._startEvent=e,this._callbacks.condition?.(this._currentCount,e)&&this._callbacks.start(this._currentCount,e,this._startEvent)}_emitUpdate(e){this._callbacks.condition?.(this._currentCount,e)&&this._callbacks.update(this._currentCount,e,this._startEvent)}_emitEnd(e){this._callbacks.condition?.(this._currentCount,e)&&this._callbacks.end(this._currentCount,e,this._startEvent),this._startEvent=null}},EJe=class extends Zs{constructor(e,n,r){super(!0),this.view=e,this.pointerActions=n,this.registerIncoming("drag",r,i=>this._handleDrag(i)),this.registerIncoming("pointer-down",()=>this.stopMomentumNavigation())}onInstall(e){super.onInstall(e),this._dragEventSeparator=new lL({start:(n,r)=>{this.view.mapViewNavigation.pan.begin(this.view,r.data),r.stopPropagation()},update:(n,r)=>{this.view.mapViewNavigation.pan.update(this.view,r.data),r.stopPropagation()},end:(n,r)=>{this.view.mapViewNavigation.pan.end(this.view,r.data),r.stopPropagation()},condition:(n,r)=>n===1&&Zve(r.data,this.pointerActions)})}_handleDrag(e){const n=this.view.mapViewNavigation;n.pinch.zoomMomentum||n.pinch.rotateMomentum?this.stopMomentumNavigation():this._dragEventSeparator.handle(e)}stopMomentumNavigation(){this.view.mapViewNavigation.pan.stopMomentumNavigation()}},SJe=class extends Zs{constructor(e,n,r){super(!0),this._view=e,this.pointerActions=n;const i=this._view.mapViewNavigation;this._dragEventSeparator=new lL({start:(s,o)=>{i.rotate.begin(this._view,o.data),o.stopPropagation()},update:(s,o)=>{i.rotate.update(this._view,o.data),o.stopPropagation()},end:(s,o)=>{i.rotate.end(),o.stopPropagation()},condition:(s,o)=>s===1&&Zve(o.data,this.pointerActions)}),this.registerIncoming("drag",r,s=>this._dragEventSeparator.handle(s))}};function Jve(t){const e=t[0],n=t[1],r=t[2];return Math.sqrt(e*e+n*n+r*r)}function TJe(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function kJe(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t}function AJe(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function Qve(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function e_e(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function t_e(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function IJe(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function PJe(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function CJe(t,e){return t[0]=Math.abs(e[0]),t[1]=Math.abs(e[1]),t[2]=Math.abs(e[2]),t}function RJe(t,e){return t[0]=Math.sign(e[0]),t[1]=Math.sign(e[1]),t[2]=Math.sign(e[2]),t}function MJe(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t}function NJe(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}function OJe(t,e=0,n=1){return t[0]=Math.min(Math.max(t[0],e),n),t[1]=Math.min(Math.max(t[1],e),n),t[2]=Math.min(Math.max(t[2],e),n),t}function LJe(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function n_e(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function DJe(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t}function r_e(t,e){const n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return Math.sqrt(n*n+r*r+i*i)}function i_e(t,e){const n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return n*n+r*r+i*i}function s_e(t){const e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r}function jJe(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function $Je(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function UV(t,e){const n=e[0],r=e[1],i=e[2];let s=n*n+r*r+i*i;return s>0&&(s=1/Math.sqrt(s),t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s),t}function o_e(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function FJe(t,e,n){const r=e[0],i=e[1],s=e[2],o=n[0],a=n[1],l=n[2];return t[0]=i*l-s*a,t[1]=s*o-r*l,t[2]=r*a-i*o,t}function VJe(t,e,n){const r=e[0],i=e[1],s=e[2],o=n[0],a=n[1],l=n[2],c=i*l-s*a,u=s*o-r*l,h=r*a-i*o,f=Math.sqrt(c*c+u*u+h*h);return t[0]=c/f,t[1]=u/f,t[2]=h/f,t}function zJe(t,e,n,r){const i=e[0],s=e[1],o=e[2];return t[0]=i+r*(n[0]-i),t[1]=s+r*(n[1]-s),t[2]=o+r*(n[2]-o),t}function GJe(t,e,n,r,i,s){const o=s*s,a=o*(2*s-3)+1,l=o*(s-2)+s,c=o*(s-1),u=o*(3-2*s);return t[0]=e[0]*a+n[0]*l+r[0]*c+i[0]*u,t[1]=e[1]*a+n[1]*l+r[1]*c+i[1]*u,t[2]=e[2]*a+n[2]*l+r[2]*c+i[2]*u,t}function UJe(t,e,n,r,i,s){const o=1-s,a=o*o,l=s*s,c=a*o,u=3*s*a,h=3*l*o,f=l*s;return t[0]=e[0]*c+n[0]*u+r[0]*h+i[0]*f,t[1]=e[1]*c+n[1]*u+r[1]*h+i[1]*f,t[2]=e[2]*c+n[2]*u+r[2]*h+i[2]*f,t}function BJe(t,e=1){const n=cW,r=2*n()*Math.PI,i=2*n()-1,s=Math.sqrt(1-i*i)*e;return t[0]=Math.cos(r)*s,t[1]=Math.sin(r)*s,t[2]=i*e,t}function WJe(t,e,n){const r=e[0],i=e[1],s=e[2];return t[0]=n[0]*r+n[4]*i+n[8]*s+n[12],t[1]=n[1]*r+n[5]*i+n[9]*s+n[13],t[2]=n[2]*r+n[6]*i+n[10]*s+n[14],t}function HJe(t,e,n){const r=e[0],i=e[1],s=e[2];return t[0]=r*n[0]+i*n[3]+s*n[6],t[1]=r*n[1]+i*n[4]+s*n[7],t[2]=r*n[2]+i*n[5]+s*n[8],t}function qJe(t,e,n){const r=n[0],i=n[1],s=n[2],o=n[3],a=e[0],l=e[1],c=e[2],u=i*c-s*l,h=s*a-r*c,f=r*l-i*a,g=i*f-s*h,y=s*u-r*f,_=r*h-i*u,b=2*o;return t[0]=a+u*b+2*g,t[1]=l+h*b+2*y,t[2]=c+f*b+2*_,t}function KJe(t,e,n,r){const i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[0],s[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),s[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function YJe(t,e,n,r){const i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),s[1]=i[1],s[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function XJe(t,e,n,r){const i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),s[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),s[2]=i[2],t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function ZJe(t,e){UV(dre,t),UV(fre,e);const n=o_e(dre,fre);return n>1?0:n<-1?Math.PI:Math.acos(n)}const dre=a0(),fre=a0();function JJe(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function QJe(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function eQe(t,e){if(t===e)return!0;const n=t[0],r=t[1],i=t[2],s=e[0],o=e[1],a=e[2],l=Sl();return Math.abs(n-s)<=l*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(r-o)<=l*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(i-a)<=l*Math.max(1,Math.abs(i),Math.abs(a))}function tQe(t,e,n){const r=n[0]-e[0],i=n[1]-e[1],s=n[2]-e[2];let o=r*r+i*i+s*s;return o>0?(o=1/Math.sqrt(o),t[0]=r*o,t[1]=i*o,t[2]=s*o,t):(t[0]=0,t[1]=0,t[2]=0,t)}const nQe=Qve,rQe=e_e,iQe=t_e,sQe=r_e,oQe=i_e,aQe=Jve,lQe=s_e;Object.freeze(Object.defineProperty({__proto__:null,abs:CJe,add:AJe,angle:ZJe,bezier:UJe,ceil:IJe,clamp:OJe,copy:TJe,cross:FJe,crossAndNormalize:VJe,direction:tQe,dist:sQe,distance:r_e,div:iQe,divide:t_e,dot:o_e,equals:eQe,exactEquals:QJe,floor:PJe,hermite:GJe,inverse:$Je,len:aQe,length:Jve,lerp:zJe,max:NJe,min:MJe,mul:rQe,multiply:e_e,negate:jJe,normalize:UV,random:BJe,rotateX:KJe,rotateY:YJe,rotateZ:XJe,round:LJe,scale:n_e,scaleAndAdd:DJe,set:kJe,sign:RJe,sqrDist:oQe,sqrLen:lQe,squaredDistance:i_e,squaredLength:s_e,str:JJe,sub:nQe,subtract:Qve,transformMat3:HJe,transformMat4:WJe,transformQuat:qJe},Symbol.toStringTag,{value:"Module"}));function Fu(t){let e=t*t;return t<0&&(e*=-1),e}function cQe(t){return t.translation[0]=0,t.translation[1]=0,t.translation[2]=0,t.heading=0,t.tilt=0,t}function uQe(t,e,n){const r=n,i=t.state,s=t.device,o=e.tiltDirection==="forward-down"?1:-1,a=1;return s.deviceType==="standard"?(r.translation[0]=Fu(i.axes[0]),r.translation[1]=Fu(i.axes[1]),r.translation[2]=Fu(i.buttons[7])-Fu(i.buttons[6]),r.heading=Fu(i.axes[2]),r.tilt=Fu(i.axes[3])):s.deviceType==="spacemouse"&&(r.translation[0]=1.2*Fu(i.axes[0]),r.translation[1]=1.2*Fu(i.axes[1]),r.translation[2]=2*-Fu(i.axes[2]),r.heading=1.2*Fu(i.axes[5]),r.tilt=1.2*Fu(i.axes[3])),r.tilt*=o,n_e(r.translation,r.translation,a),r}function hQe(t){return t.translation[0]===0&&t.translation[1]===0&&t.translation[2]===0&&t.heading===0&&t.tilt===0&&t.zoom===0}let dQe=class extends Zs{constructor(e){super(!0),this._view=e,this._frameTask=null,this._watchHandles=new cb,this._currentDevice=null,this._transformation={translation:[0,0,0],heading:0,tilt:0,zoom:0},this._handle=this.registerIncoming("gamepad",n=>this._handleGamePadEvent(n)),this._handle.pause()}onInstall(e){super.onInstall(e),this._watchHandles.add([fn(()=>this._view.navigation.gamepad?.enabled,n=>{n?(this._handle.resume(),this._frameTask||(this._frameTask=x2({update:r=>this._frameUpdate(r.deltaTime)}))):(this._handle.pause(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null))},ya)])}onUninstall(){this._watchHandles.removeAll(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null),super.onUninstall()}_handleGamePadEvent(e){const n=this._view.navigation.gamepad.device;n&&e.data.device!==n||this._currentDevice&&this._currentDevice!==e.data.device||(e.data.action==="end"?(this._currentDevice=null,cQe(this._transformation)):(this._currentDevice=e.data.device,uQe(e.data,this._view.navigation.gamepad,this._transformation)),this._frameTask?.resume())}_frameUpdate(e){const n=this._transformation;if(hQe(n))return void this._frameTask?.pause();const r=this._view.viewpoint.clone(),i=this._view.navigation.gamepad.velocityFactor,s=pQe*i*e;aL(r,r,[n.translation[0]*s,-n.translation[1]*s]);const o=1+n.translation[2]*mQe*e,a=this._view.constraints.rotationEnabled?-n.heading*fQe*e:0,l=this._view.size,c=[l[0]/2,l[1]];Dve(r,r,o,a,c,l);const u=this._view.constraints.constrain(r,this._view.viewpoint);this._view.viewpoint=u}};const fQe=.06,pQe=.7,mQe=6e-4;function a_e(t){const e=()=>t(document.visibilityState==="visible");return document.addEventListener("visibilitychange",e),Zn(()=>document.removeEventListener("visibilitychange",e))}let gQe=class extends Zs{constructor(e,n,r){super(!0),this.view=e,this.keys=n,this._isSticky=!1,this._pressedKeys=new Set,this._timeout=void 0,this._currentDirection=void 0,this._stickyKeyDuration=200,this._handleKey=i=>{const s=this._keyMap[i.data.key];if(i.modifiers.has("Meta")||i.modifiers.has("Control"))return void this._stopMovement();if(s==null)return;i.stopPropagation(),i.preventDefault();const o=i.type==="key-down";if(this._pressedKeys[o?"add":"delete"](s),o){if(this._direction===s)return;this._direction=s,this._isSticky=!1,this._setTimeout(()=>{this._isSticky&&this._handlePopKey()})}else{const a=this._timeout===void 0,l=this._pressedKeys.size>0;a||l?this._handlePopKey():this._isSticky=!0}},this._handlePopKey=()=>{this._direction=Array.from(this._pressedKeys).pop(),this._direction==null&&this._stopMovement()},this._stopMovement=()=>{this._isSticky=!1,this._direction=void 0,this._pressedKeys.clear(),this._setTimeout(void 0)},this._keyMap={[n.left]:"left",[n.right]:"right",[n.up]:"up",[n.down]:"down"},this.registerIncoming("key-down",r,this._handleKey),this.registerIncoming("key-up",r,this._handleKey),this.registerIncoming("blur",r,this._stopMovement),this._visibilityHandle=a_e(i=>i?null:this._stopMovement())}onUninstall(){this._stopMovement(),this._visibilityHandle?.remove()}get _direction(){return this._currentDirection}set _direction(e){const n=this._currentDirection!=null;if(e!=null){if(n||this.view.mapViewNavigation.begin(),this._currentDirection!==e)switch(e){case"left":this.view.mapViewNavigation.continuousPanLeft();break;case"right":this.view.mapViewNavigation.continuousPanRight();break;case"up":this.view.mapViewNavigation.continuousPanUp();break;case"down":this.view.mapViewNavigation.continuousPanDown()}}else n&&this.view.mapViewNavigation.stop();this._currentDirection=e}_setTimeout(e){clearTimeout(this._timeout),this._timeout=e===void 0?void 0:setTimeout(()=>{this._timeout=void 0,e()},this._stickyKeyDuration)}},yQe=class extends Zs{constructor(e,n,r){super(!0),this.view=e,this.keys=n,this._keyToDirection=new Map,this._pressed=!1,this._addKeysMapping(n),this.registerIncoming("key-down",r,i=>this._handleKeyDown(i)),this.registerIncoming("key-up",r,i=>this._handleKeyUp(i)),this.registerIncoming("blur",r,()=>this._handleStop()),this._visibilityHandle=a_e(i=>i?null:this._handleStop())}onUninstall(){this._visibilityHandle?.remove(),this._handleStop()}_addKeysMapping(e){this._addKeyMapping(e.clockwise,"clockwise"),this._addKeyMapping(e.counterClockwise,"counterClockwise"),this._addKeyMapping(e.reset,"reset")}_addKeyMapping(e,n){for(const r of e)this._keyToDirection.set(r,n)}_handleKeyDown(e){e.data.repeat||this._handleKey(e,!0)}_handleKeyUp(e){this._handleKey(e,!1)}_handleStop(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop())}_handleKey(e,n){const r=e.modifiers;if(r.size>0&&!r.has("Shift")||!this.view.constraints.rotationEnabled)return;const i=this._keyToDirection.get(e.data.key);if(this._pressed=i!=null,this._pressed){if(e.preventDefault(),n)switch(this.view.mapViewNavigation.begin(),i){case"clockwise":this.view.mapViewNavigation.continuousRotateClockwise();break;case"counterClockwise":this.view.mapViewNavigation.continuousRotateCounterclockwise();break;case"reset":this.view.mapViewNavigation.resetRotation()}else this._pressed=!1,this.view.mapViewNavigation.stop();e.stopPropagation()}}},vQe=class extends Zs{constructor(e,n,r){super(!0),this.view=e,this.keys=n,this._keysToZoomAction={},this.registerIncoming("key-down",r,i=>this._handleKeyDown(i)),n.zoomIn.forEach(i=>this._keysToZoomAction[i]=0),n.zoomOut.forEach(i=>this._keysToZoomAction[i]=1)}_handleKeyDown(e){this._handleKey(e)}_handleKey(e){const n=e.modifiers;if(n.size>0&&!n.has("Shift"))return;const{key:r}=e.data;if(!(r in this._keysToZoomAction))return;const i=this._keysToZoomAction[r],{mapViewNavigation:s}=this.view;let o=null;switch(i){case 0:o=s.zoomIn();break;case 1:o=s.zoomOut();break;default:return}s.begin(),o.then(()=>s.end()),e.stopPropagation()}};const _Qe=.6;let xQe=class extends Zs{constructor(e,n){super(!0),this._view=e,this._canZoom=!0,this.registerIncoming("mouse-wheel",n,r=>this._handleMouseWheel(r))}_handleMouseWheel(e){if(this._view.navigation.actionMap.mouseWheel!=="zoom"||(e.preventDefault(),e.stopPropagation(),!this._canZoom))return;const n=this._view.mapViewNavigation,{x:r,y:i,deltaY:s}=e.data,o=1/_Qe**(1/60*s),a=n.zoom(o,[r,i]);this._canZoom=!1,a.catch(()=>{}).then(()=>{this._canZoom=!0,n.end()})}},wQe=class extends Zs{constructor(e){super(!0),this.view=e,this.registerIncoming("drag",r=>this._handleDrag(r)),this.registerIncoming("pointer-down",()=>this._stopMomentumNavigation());const n=this.view.mapViewNavigation;this._dragEventSeparator=new lL({start:(r,i)=>{n.pinch.begin(this.view,i.data),i.stopPropagation()},update:(r,i)=>{n.pinch.update(this.view,i.data),i.stopPropagation()},end:(r,i)=>{n.pinch.end(this.view),i.stopPropagation()},condition:r=>r>=2})}_handleDrag(e){this._dragEventSeparator.handle(e)}_stopMomentumNavigation(){this.view.mapViewNavigation.pinch.stopMomentumNavigation()}};function pre(t){const e=t.native;return e?{buttons:e.buttons.map(n=>n.pressed?n.value||1:0),axes:e.axes.map(n=>SQe(n,t.axisThreshold))}:{buttons:[],axes:[]}}function bQe(t,e){if(t.axes.length!==e.axes.length||t.buttons.length!==e.buttons.length)return!1;for(let n=0;n<t.axes.length;n++)if(t.axes[n]!==e.axes[n])return!1;for(let n=0;n<t.buttons.length;n++)if(t.buttons[n]!==e.buttons[n])return!1;return!0}function EQe(t){for(let e=0;e<t.axes.length;e++)if(t.axes[e]!==0)return!1;for(let e=0;e<t.buttons.length;e++)if(t.buttons[e]!==0)return!1;return!0}function SQe(t,e){const n=Math.abs(t);return n<e?0:Math.sign(t)*(n-e)/(1-e)}let TQe=class{constructor(e,n){this._element=e,this._input=n,this._hasEventListeners=!1,this._onConnectGamepad=s=>{this._connectGamepad(s.gamepad)},this._onDisconnectGamepad=s=>{const o=s.gamepad,a=o.index,l=this._inputDevices[a];l&&(this._emitGamepadEvent(o,pre(l),!1),this._inputDevices.splice(a,1),this._latestUpdate.splice(a,1),this._input.gamepad.devices.remove(l),this.ensurePollingState())},this._frameTask=null,this._latestUpdate=new Array,this._inputDevices=new Array,this._callback=null;const r="getGamepads"in window.navigator,i=window.isSecureContext;this.supported=r&&i,this.supported&&(mre(s=>this._connectGamepad(s)),window.addEventListener("gamepadconnected",this._onConnectGamepad),window.addEventListener("gamepaddisconnected",this._onDisconnectGamepad),this.ensurePollingState())}destroy(){this.hasEventListeners=!1,this.supported&&(window.removeEventListener("gamepadconnected",this._onConnectGamepad),window.removeEventListener("gamepaddisconnected",this._onDisconnectGamepad))}set hasEventListeners(e){this._hasEventListeners!==e&&(this._hasEventListeners=e,this.ensurePollingState())}get _eventsEnabled(){return this.supported&&this._inputDevices.length>0&&this._hasEventListeners}set onEvent(e){this._callback=e}_connectGamepad(e){const n=new zW(e);n.deviceType!=="unknown"&&(this._inputDevices[e.index]=n,this._input.gamepad.devices.add(n)),this.ensurePollingState()}ensurePollingState(){this._eventsEnabled?this._startPolling():this._stopPolling()}_startPolling(){this._frameTask==null&&(this._frameTask=x2({update:()=>this._readGamepadState()}))}_stopPolling(){this._frameTask!=null&&(this._frameTask.remove(),this._frameTask=null,this._latestUpdate=new Array)}_readGamepadState(){const e=document.hasFocus(),n=this._element.contains(document.activeElement),r=this._input.gamepad.enabledFocusMode==="document"&&!e||this._input.gamepad.enabledFocusMode==="view"&&!n;mre(i=>{const s=this._inputDevices[i.index];if(!s)return;const o=this._latestUpdate[i.index],a=pre(s),l=r||EQe(a);o&&(o.timestamp===i.timestamp||!o.active&&l||bQe(o.state,a))||this._emitGamepadEvent(i,a,!l)})}_emitGamepadEvent(e,n,r){const i=this._latestUpdate[e.index],s=i&&i.active;if(!s&&!r)return;const o=!s&&r?"start":s&&r?"update":"end";this._latestUpdate[e.index]={timestamp:e.timestamp,state:n,active:r},this._callback&&this._callback({device:this._inputDevices[e.index],state:n,action:o})}};function kQe(t){if(!t||!t.connected)return!1;for(let e=0;e<t.axes.length;e++)if(isNaN(t.axes[e]))return!1;return!0}function mre(t){for(const e of navigator.getGamepads())kQe(e)&&t(e)}const gre=ye("edge"),AQe=ye("chrome"),IQe=ye("ff"),PQe=ye("safari"),yre="esri-view-surface",I_={touchNone:`${yre}--touch-none`,touchPan:`${yre}--touch-pan`};var m1;let CQe=(m1=class{constructor(e,n){this._active={},this._callback=()=>{},this._activePointerCaptures=new Set,this._keyDownState=new Set,this._eventId=1,this._browserTouchPanningEnabled=!1,this._element=e,e.getAttribute("tabindex")||e.setAttribute("tabindex","0"),this._eventHandlers={"key-down":this._handleKey,"key-up":this._handleKey,"pointer-down":this._handlePointer,"pointer-move":this._handlePointerPreventDefault,"pointer-up":this._handlePointerPreventDefault,"pointer-enter":this._handlePointer,"pointer-leave":this._handlePointer,"pointer-cancel":this._handlePointer,"mouse-wheel":this._handleMouseWheel,"pointer-capture-lost":this._handlePointerCaptureLost},this._updateTouchAction(),this._element.addEventListener("keydown",this._preventAltKeyDefault),this._gamepadSource=new TQe(e,n),this._gamepadSource.onEvent=r=>this._callback("gamepad",r)}destroy(){this._callback=()=>{},this.activeEvents=null,this._activePointerCaptures.forEach(e=>this._releasePointerCaptureSafe(e)),this._activePointerCaptures.clear(),this._gamepadSource=Di(this._gamepadSource),this._removeTouchAction(),this._element.removeEventListener("keydown",this._preventAltKeyDefault)}get browserTouchPanningEnabled(){return this._browserTouchPanningEnabled}set browserTouchPanningEnabled(e){this._browserTouchPanningEnabled=e,this._updateTouchAction(),this._updateTouchEventHandling()}set onEventReceived(e){this._callback=e}set activeEvents(e){for(const n in this._active)if(!e||!e.has(n)){const r=this._active[n];this._element.removeEventListener(g$[n],r),delete this._active[n]}e&&e.forEach(n=>{if(!this._active[n]&&g$[n]){const r=(this._eventHandlers[n]||this._handleDefault).bind(this,n);this._element.addEventListener(g$[n],r),this._active[n]=r}}),this._gamepadSource&&(this._gamepadSource.hasEventListeners=e?.has("gamepad")??!1)}setPointerCapture(e,n){n?this._setPointerCaptureSafe(e.pointerId):(this._releasePointerCaptureSafe(e.pointerId),this._activePointerCaptures.delete(e.pointerId))}_updateTouchAction(){this._element.classList.remove(this._browserTouchPanningEnabled?I_.touchNone:I_.touchPan),this._element.classList.add(this._browserTouchPanningEnabled?I_.touchPan:I_.touchNone)}_updateTouchEventHandling(){this._browserTouchPanningEnabled?this._element.addEventListener("touchmove",this._preventMultiTouchPanning):this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_removeTouchAction(){this._element.classList.remove(I_.touchNone),this._element.classList.remove(I_.touchPan),this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_setPointerCaptureSafe(e){try{this._element.setPointerCapture(e),this._activePointerCaptures.add(e)}catch{}}_releasePointerCaptureSafe(e){try{if(this._element.hasPointerCapture&&!this._element.hasPointerCapture(e))return;this._element.releasePointerCapture(e)}catch{}}_updateNormalizedPointerLikeEvent(e,n){const r=ave(this._element,e);return m1.test.disableSubpixelCoordinates&&(r.x=Math.round(r.x),r.y=Math.round(r.y)),n.x=r.x,n.y=r.y,n}_handleKey(e,n){const{key:r}=n;r&&e==="key-up"&&this._keyDownState.delete(r);const i={native:n,key:r,repeat:!!r&&this._keyDownState.has(r)};r&&e==="key-down"&&this._keyDownState.add(i.key),this._callback(e,i)}_handlePointer(e,n){const r=this._updateNormalizedPointerLikeEvent(n,{native:n,x:0,y:0,pointerType:n.pointerType,button:n.button,buttons:n.buttons,eventId:this._eventId++});this._callback(e,r)}_handlePointerPreventDefault(e,n){const r=this._updateNormalizedPointerLikeEvent(n,{native:n,x:0,y:0,pointerType:n.pointerType,button:n.button,buttons:n.buttons,eventId:this._eventId++});n.preventDefault(),this._callback(e,r)}_getDeltaFromTrackpadOrMouseWheel(e){return e.shiftKey&&ye("mac")&&e.deltaY===0?e.deltaX:e.deltaY}_handleMouseWheel(e,n){let r=this._getDeltaFromTrackpadOrMouseWheel(n);switch(n.deltaMode){case 0:gre&&(r=r/document.documentElement.clientHeight*600);break;case 1:r*=30;break;case 2:r*=900}gre?r*=.7:AQe||PQe?r*=.6:IQe&&(r*=1.375);const i=100,s=Math.abs(r);s>i&&(r=r/s*200/(1+Math.exp(-.02*(s-i))));const o=this._updateNormalizedPointerLikeEvent(n,{native:n,x:0,y:0,deltaY:r});this._callback(e,o)}_handlePointerCaptureLost(e,n){this._activePointerCaptures.delete(n.pointerId),this._handleDefault(e,n)}_handleDefault(e,n){const r={native:n};n.preventDefault(),this._callback(e,r)}_preventAltKeyDefault(e){e.key==="Alt"&&e.preventDefault()}_preventMultiTouchPanning(e){e.touches.length>1&&e.preventDefault()}},m1.test={disableSubpixelCoordinates:!1},m1);const g$={"key-down":"keydown","key-up":"keyup","pointer-down":"pointerdown","pointer-up":"pointerup","pointer-move":"pointermove","mouse-wheel":"wheel","pointer-capture-got":"gotpointercapture","pointer-capture-lost":"lostpointercapture","context-menu":"contextmenu","pointer-enter":"pointerenter","pointer-leave":"pointerleave","pointer-cancel":"pointercancel",focus:"focus",blur:"blur"};let RQe=class extends Zs{constructor(){super(!0),this.registerIncoming("context-menu",e=>e.data.native.preventDefault())}};const l_e=()=>({maximumClickDelay:300}),MQe=(t={})=>({...l_e(),movementUntilMouseDrag:1.5,movementUntilPenDrag:6,movementUntilTouchDrag:6,holdDelay:500,...t}),QW=(t={})=>({...l_e(),maximumDoubleClickDistance:10,maximumDoubleTouchDistance:35,maximumDoubleClickDelay:250,maximumDoubleTouchDelay:350,...t});function pN(t,e){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)}function NQe(t,e){const n=e.x-t.x,r=e.y-t.y;return Math.sqrt(n*n+r*r)}function OQe(t,e){if(e?(e.radius=0,e.center.x=0,e.center.y=0):e={radius:0,center:Hs()},t.length===0)return e;if(t.length===1)return e.center.x=t[0].x,e.center.y=t[0].y,e;if(t.length===2){const[I,P]=t,[R,D]=[P.x-I.x,P.y-I.y];return e.radius=Math.sqrt(R*R+D*D)/2,e.center.x=(I.x+P.x)/2,e.center.y=(I.y+P.y)/2,e}let n=0,r=0;for(let I=0;I<t.length;I++)n+=t[I].x,r+=t[I].y;n/=t.length,r/=t.length;const i=t.map(I=>I.x-n),s=t.map(I=>I.y-r);let o=0,a=0,l=0,c=0,u=0,h=0,f=0;for(let I=0;I<i.length;I++){const P=i[I],R=s[I],D=P*P,C=R*R;o+=D,a+=C,l+=P*R,c+=D*P,u+=C*R,h+=P*C,f+=R*D}const g=.5*(c+h),y=.5*(u+f),_=o*a-l*l,b=(g*a-y*l)/_,T=(o*y-l*g)/_,A=Hs(b+n,T+r);return{radius:Math.sqrt(b*b+T*T+(o+a)/t.length),center:A}}function c1(t){const{native:e}=t,{pointerId:n,button:r,pointerType:i}=e;return i==="mouse"?`${n}:${r}`:`${i}`}let LQe=class extends Zs{constructor(e={},n=sb){super(!1),this._clock=n,this._doubleTapDragReady=!1,this._doubleTapDragActive=!1,this._dragStartCenter=Hs(0,0),this._pointerState=new Map,this._parameters=QW(e),this._doubleTapDrag=this.registerOutgoing("double-tap-drag"),this._dragEventSeparator=new lL({start:(r,i)=>this._dragStart(r,i),update:(r,i)=>this._dragUpdate(i),end:(r,i)=>this._dragEnd(i)}),this.registerIncoming("drag",r=>this._dragEventSeparator.handle(r)),this.registerIncoming("pointer-down",r=>this._handlePointerDown(r)),this.registerIncoming("pointer-up",()=>this._handlePointerUp())}onUninstall(){this._pointerState.forEach(e=>{e.doubleTapTimeout=ii(e.doubleTapTimeout)})}get hasPendingInputs(){for(const e of this._pointerState.values())if(e.doubleTapTimeout!=null)return!0;return!1}_clearPointerDown(e){const n=this._pointerState.get(e);n&&(n.doubleTapTimeout=ii(n.doubleTapTimeout),this._pointerState.delete(e),this.refreshHasPendingInputs())}_dragStart(e,n){if(!this._doubleTapDragReady||e!==1)return;this._doubleTapDragReady=!1,this._doubleTapDragActive=!0;const{data:r,modifiers:i}=n,{center:s}=r;this._dragStartCenter=s;const o=y$("begin",Hs(0,0),r);this._doubleTapDrag.emit(o,void 0,i),n.stopPropagation()}_dragUpdate(e){if(!this._doubleTapDragActive)return;const{data:n,modifiers:r}=e,{center:i}=n,s=y$("update",Hs(i.x-this._dragStartCenter.x,i.y-this._dragStartCenter.y),n);this._doubleTapDrag.emit(s,void 0,r),e.stopPropagation()}_dragEnd(e){if(!this._doubleTapDragActive)return;const{data:n,modifiers:r}=e,{center:i}=n,s=y$("end",Hs(i.x-this._dragStartCenter.x,i.y-this._dragStartCenter.y),n);this._doubleTapDrag.emit(s,void 0,r),this._doubleTapDragActive=!1,e.stopPropagation()}_handlePointerDown(e){const{data:n}=e,r=c1(n),i=this._pointerState.get(r),{pointerType:s}=n.native;if(i){const o=s==="touch"?this._parameters.maximumDoubleTouchDistance:this._parameters.maximumDoubleClickDistance;this._clearPointerDown(r),pN(i.event.data,n)>o?this._storePointerDown(e):this._doubleTapDragReady=!0}else this._storePointerDown(e)}_handlePointerUp(){this._doubleTapDragReady=!1}_storePointerDown(e){const{data:n}=e,{pointerType:r}=n.native,i=c1(n),s=r==="touch"?this._parameters.maximumDoubleTouchDelay:this._parameters.maximumDoubleClickDelay,o=this._clock.setTimeout(()=>this._clearPointerDown(i),s);this._pointerState.set(i,{event:e,doubleTapTimeout:o}),this.refreshHasPendingInputs()}};function y$(t,e,n){const{button:r,buttons:i,pointer:s,pointers:o,pointerType:a,timestamp:l}=n;return{action:t,delta:e,button:r,buttons:i,pointer:s,pointers:o,pointerType:a,timestamp:l}}let DQe=class extends Zs{constructor(e){super(!1),this._navigationTouch=e,this._startStateModifiers=new Set,this._activePointerMap=new Map,this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._drag=this.registerOutgoing("drag"),this.registerIncoming("pointer-drag",this._handlePointerDrag.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-capture-lost",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-cancel",this._handlePointerUpAndPointerLost.bind(this))}_createPayload(e,n,r,i){return{action:e,pointerType:this._pointerType,button:this._mouseButton,buttons:n.buttons,timestamp:i,pointers:jQe(this._activePointerMap),pointer:n,angle:r.angle,radius:r.radius,center:r.center}}_addPointer(e){const n=e.native.pointerId,r=lR(this._activePointerMap).angle,i={event:e,initialAngle:0,lastAngle:0};this._activePointerMap.set(n,i);const s=h3(i,c_e(this._activePointerMap));i.initialAngle=s,i.lastAngle=s,this._updatePointerAngles(r)}_updatePointer(e){if(e&&e.x==null&&e.y==null)return;const n=e.native.pointerId,r=this._activePointerMap.get(n);r?r.event=e:this._addPointer(e)}_removePointer(e){const n=lR(this._activePointerMap).angle;this._activePointerMap.delete(e),this._updatePointerAngles(n)}_updatePointerAngles(e){const n=lR(this._activePointerMap);this._activePointerMap.forEach(r=>{r.initialAngle=h3(r,n)-e,r.lastAngle=h3(r,n)-e})}_emitEvent(e,n,r){const i=lR(this._activePointerMap);this._drag.emit(this._createPayload(e,n,i,r),void 0,this._startStateModifiers)}_handlePointerUpAndPointerLost(e){const n=e.data.native.pointerId,r=e.timestamp;this._activePointerMap.get(n)&&(this._activePointerMap.size===1?(this._updatePointer(e.data),!this._isCurrentDragSuppressed&&this._emitEvent("end",e.data,r),this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._removePointer(n)):(this._removePointer(n),this._emitEvent("removed",e.data,e.timestamp)))}_handlePointerDrag(e){const n=e.data,r=n.currentEvent,i=e.timestamp;switch(n.action){case"start":case"update":this._isDragging?this._activePointerMap.has(r.native.pointerId)?(this._updatePointer(r),!this._isCurrentDragSuppressed&&this._emitEvent("update",r,i)):(this._addPointer(r),this._emitEvent("added",r,i),this._isCurrentDragSuppressed=this._isSuppressed):(this._updatePointer(r),this._pointerType=e.data.startEvent.pointerType,this._mouseButton=e.data.startEvent.button,this._startStateModifiers=e.modifiers,this._isDragging=!0,this._isCurrentDragSuppressed=this._isSuppressed,!this._isCurrentDragSuppressed&&this._emitEvent("start",r,i))}}get _isSuppressed(){return!!this._navigationTouch&&!this._navigationTouch.browserTouchPanEnabled&&this._pointerType==="touch"&&this._activePointerMap.size===1}};function c_e(t){const e=[];return t.forEach(n=>{e.push(Hs(n.event.x,n.event.y))}),OQe(e)}function lR(t){const e=c_e(t);let n=0;return t.forEach(r=>{let i=h3(r,e),s=i-r.lastAngle;for(;s>Math.PI;)s-=2*Math.PI;for(;s<-Math.PI;)s+=2*Math.PI;i=r.lastAngle+s,r.lastAngle=i;const o=i-r.initialAngle;n+=o}),n/=t.size||1,{angle:n,radius:e.radius,center:e.center}}function jQe(t){const e=new Map;return t.forEach((n,r)=>e.set(r,n.event)),e}function h3(t,e){const n=t.event,r=n.x-e.center.x,i=n.y-e.center.y;return Math.atan2(i,r)}let $Qe=class extends Zs{constructor(e={},n=sb){super(!1),this._clock=n,this._pointerState=new Map,this._parameters=QW(e),this._immediateDoubleClick=this.registerOutgoing("immediate-double-click"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUp.bind(this))}onUninstall(){this._pointerState.forEach(e=>{e.immediateDoubleClick&&e.immediateDoubleClick.timeoutHandle.remove()}),super.onUninstall()}_handlePointerDown(e){const n=e.data,r=c1(n);if(!this._pointerState.has(r)){const i={downButton:n.native.button,x:n.x,y:n.y,immediateDoubleClick:null};this._pointerState.set(r,i),this.startCapturingPointer(n.native)}}_handlePointerUp(e){const n=e.data,r=c1(n),i=this._pointerState.get(r);if(i&&i.downButton===n.native.button){const s=i.immediateDoubleClick,o=e.data.native.pointerType==="touch"?this._parameters.maximumDoubleTouchDistance:this._parameters.maximumDoubleClickDistance;s?(s.timeoutHandle.remove(),pN(s,e.data)>o?this._startImmediateDoubleClick(e,i):(this._immediateDoubleClick.emit(e.data,void 0,s.modifiers),this._removeState(n))):pN(i,e.data)>o?this._removeState(n):this._startImmediateDoubleClick(e,i)}}_startImmediateDoubleClick(e,n){const r=e.data.native.pointerType==="touch"?this._parameters.maximumDoubleTouchDelay:this._parameters.maximumDoubleClickDelay;n.immediateDoubleClick={x:e.data.x,y:e.data.y,modifiers:e.modifiers,timeoutHandle:this._clock.setTimeout(()=>this._removeState(e.data),r)}}_removeState(e){const n=c1(e);this._pointerState.delete(n),this.stopCapturingPointer(e.native),this.refreshHasPendingInputs()}},FQe=class extends Zs{constructor(e={},n=sb){super(!1),this._clock=n,this._pointerState=new Map,this._parameters=MQe(e),this._pointerDrag=this.registerOutgoing("pointer-drag"),this._immediateClick=this.registerOutgoing("immediate-click"),this._pointerHold=this.registerOutgoing("hold"),this.registerIncoming("pointer-down",r=>this._handlePointerDown(r)),this.registerIncoming("pointer-up",r=>this._handlePointerLoss(r,"pointer-up")),this.registerIncoming("pointer-capture-lost",r=>this._handlePointerLoss(r,"pointer-capture-lost")),this.registerIncoming("pointer-cancel",r=>this._handlePointerLoss(r,"pointer-cancel")),this._moveHandle=this.registerIncoming("pointer-move",r=>this._handlePointerMove(r)),this._moveHandle.pause()}onUninstall(){this._pointerState.forEach(e=>{e.holdTimeout=ii(e.holdTimeout)}),super.onUninstall()}_handlePointerDown(e){const n=e.data,r=n.native.pointerId;let i=null;this._pointerState.size===0&&(i=this._clock.setTimeout(()=>{const o=this._pointerState.get(r);if(o){if(!o.isDragging){const a=o.previousEvent;this._pointerHold.emit(a,void 0,e.modifiers),o.holdEmitted=!0}o.holdTimeout=null}},this._parameters.holdDelay));const s={startEvent:n,previousEvent:n,startTimestamp:e.timestamp,isDragging:!1,downButton:n.native.button,holdTimeout:i,modifiers:new Set};this._pointerState.set(r,s),this.startCapturingPointer(n.native),this._moveHandle.resume(),this._pointerState.size>1&&this._startDragging(e)}_handlePointerMove(e){const n=e.data,r=n.native.pointerId,i=this._pointerState.get(r);i&&(i.isDragging?this._pointerDrag.emit(cR("update",i,n),void 0,i.modifiers):NQe(n,i.startEvent)>this._getDragThreshold(n.native.pointerType)&&this._startDragging(e),i.previousEvent=n)}_getDragThreshold(e){switch(e){case"touch":return this._parameters.movementUntilTouchDrag;case"pen":return this._parameters.movementUntilPenDrag;default:return this._parameters.movementUntilMouseDrag}}_startDragging(e){const n=e.data,r=n.native.pointerId;this._pointerState.forEach(i=>{i.holdTimeout!=null&&(i.holdTimeout.remove(),i.holdTimeout=null),i.isDragging||(i.modifiers=e.modifiers,i.isDragging=!0,r===i.startEvent.native.pointerId?this._pointerDrag.emit(cR("start",i,n)):this._pointerDrag.emit(cR("start",i,i.previousEvent),e.timestamp))})}_handlePointerLoss(e,n){const r=e.data,i=r.native.pointerId,s=this._pointerState.get(i);s&&(s.holdTimeout!=null&&(s.holdTimeout.remove(),s.holdTimeout=null),s.isDragging?this._pointerDrag.emit(cR("end",s,n==="pointer-up"?r:s.previousEvent),void 0,s.modifiers):n==="pointer-up"&&s.downButton===r.native.button&&e.timestamp-s.startTimestamp<=this._parameters.maximumClickDelay&&!s.holdEmitted&&this._immediateClick.emit(r),this._pointerState.delete(i),this.stopCapturingPointer(r.native),this._pointerState.size===0&&this._moveHandle.pause())}};function cR(t,e,n){return{action:t,startEvent:e.startEvent,previousEvent:e.previousEvent,currentEvent:n}}let VQe=class extends Zs{constructor(e={},n=sb){super(!1),this._clock=n,this._pointerState=new Map,this._parameters=QW(e),this._click=this.registerOutgoing("click"),this._doubleClick=this.registerOutgoing("double-click"),this.registerIncoming("immediate-click",r=>this._handleImmediateClick(r)),this.registerIncoming("pointer-down",r=>this._handlePointerDown(r))}onUninstall(){this._pointerState.forEach(e=>e.doubleClickTimer=ii(e.doubleClickTimer))}get hasPendingInputs(){for(const e of this._pointerState.values())if(e.doubleClickTimer!=null)return!0;return!1}_clearDoubleClickTimer(e,n){const r=this._pointerState.get(e);r&&(r.doubleClickTimer=ii(r.doubleClickTimer),n&&this._click.emit(r.event.data,void 0,r.event.modifiers),this._pointerState.delete(e),this.refreshHasPendingInputs())}_doubleClickTimeoutExceeded(e){const n=this._pointerState.get(e);n.pointerDownCount===1&&this._click.emit(n.event.data,void 0,n.event.modifiers),n.doubleClickTimer=null,this._pointerState.delete(e),this.refreshHasPendingInputs()}_handleImmediateClick(e){const n=e.data,{pointerType:r}=n.native,i=zQe(n);if(!this._pointerState.has(i))return void this._startClick(e);const s=this._pointerState.get(i),{data:o,modifiers:a}=s.event,l=r==="touch"?this._parameters.maximumDoubleTouchDistance:this._parameters.maximumDoubleClickDistance;pN(o,n)>l?(this._clearDoubleClickTimer(i,!0),this._startClick(e)):(this._clearDoubleClickTimer(i,!1),s.pointerDownCount===2&&this._doubleClick.emit(o,void 0,a))}_handlePointerDown(e){const n=c1(e.data),r=this._pointerState.get(n);r&&(r.pointerDownCount+=1)}_startClick(e){const{data:n}=e,{native:{pointerType:r}}=n,i=c1(n),s=r==="touch"?this._parameters.maximumDoubleTouchDelay:this._parameters.maximumDoubleClickDelay,o=this._clock.setTimeout(()=>this._doubleClickTimeoutExceeded(i),s);this._pointerState.set(i,{event:e,doubleClickTimer:o,pointerDownCount:1}),this.refreshHasPendingInputs()}};function zQe(t){const{pointerId:e,pointerType:n,button:r}=t.native;return n==="mouse"?`${e}:${r}`:`${n}`}const uR={counter:"Control",pan:{left:"ArrowLeft",right:"ArrowRight",up:"ArrowUp",down:"ArrowDown"},zoom:{zoomIn:["=","+"],zoomOut:["-","_"]},rotate:{clockwise:["a","A"],counterClockwise:["d","D"],reset:["n","N"]}},vre=Symbol("handles");let ux=class extends Kt{initialize(){const e=()=>this.view?.ready;this.addHandles([wc(()=>!e(),()=>this._disconnect()),wc(e,()=>this._connect())])}destroy(){this._disconnect()}get latestPointerInfo(){return this._inputManager?.latestPointerInfo}get multiTouchActive(){return this._inputManager?.multiTouchActive??!1}isModifierKeyDown(e){return this._inputManager?.isModifierKeyDown(e)??!1}_disconnect(){this.view.viewEvents.disconnect(),this.removeHandles(vre),this._inputManager=Di(this._inputManager)}_connect(){const e=this.view.surface,n=new CQe(e,this.view.input),r=[new $Qe,new FQe,new VQe,new DQe(this.view.navigation),new LQe],i=new Bu({eventSource:n,recognizers:r}),s=new EJe(this.view,["primary"]),o=new SJe(this.view,["secondary"]);i.installHandlers("prevent-context-menu",[new RQe],ip.INTERNAL),i.installHandlers("navigation",[new wQe(this.view),new dQe(this.view),new xQe(this.view),new hre(this.view),new hre(this.view,[uR.counter]),s,new gQe(this.view,uR.pan),new vQe(this.view,uR.zoom),new yQe(this.view,uR.rotate),o,new bJe(this.view,"touch")],ip.INTERNAL),this.view.viewEvents.connect(i),this._source=n,this._inputManager=i,this.addHandles([fn(()=>this.view?.navigation?.browserTouchPanEnabled,a=>{this._source&&(this._source.browserTouchPanningEnabled=!a)},ya),fn(()=>{const{actionMap:a}=this.view.navigation;return{panActions:ure("pan",a),rotateActions:ure("rotate",a)}},({panActions:a,rotateActions:l})=>{s.pointerActions=a,o.pointerActions=l},ra)],vre)}get test(){}};x([E()],ux.prototype,"view",void 0),x([E()],ux.prototype,"latestPointerInfo",null),x([E()],ux.prototype,"multiTouchActive",null),ux=x([ue("esri.views.2d.input.MapViewInputManager")],ux);const GQe=ux,UQe=t=>{const e=t;let n=class extends e{constructor(...r){super(...r),this.goToManager=new u3({view:this}),this.animationsEnabled=!0,this.inputManager=new GQe({view:this}),this.addHandles([this.on("resize",i=>this.stateManager.resize(i.width,i.height))])}get interacting(){return this.navigating}get stationary(){return!this.animation&&!this.navigating&&!this.resizing&&this.stationaryManager.stationary}on(r,i,s,o){return this.viewEvents.on(r,i,s,o)||super.on(r,i)}hasEventListener(r){return super.hasEventListener(r)||this.viewEvents.hasHandler(r)}goTo(r,i){return this.goToManager.goTo(r,i)}toMap(r){if(!this.ready)return null;const i=cve(r)?lve(this,r):r;return this.stateManager.toMap(i)}};return x([E()],n.prototype,"goToManager",void 0),x([E({readOnly:!0})],n.prototype,"interacting",null),x([E()],n.prototype,"stationary",null),x([E()],n.prototype,"animationsEnabled",void 0),x([E({readOnly:!0})],n.prototype,"inputManager",void 0),n=x([ue("esri.views.Viewport2DMixin")],n),n};let _re=class{constructor(e){this._view=e,this.viewpoint=new du({targetGeometry:new Jt,scale:0,rotation:0})}get view(){return this._view}get size(){const[e,n]=this._view.size;return Math.sqrt(e*e+n*n)}get scale(){return this.viewpoint.scale}get rotation(){return this.viewpoint.rotation}get center(){return this.viewpoint.targetGeometry}get scaleToResolutionFactor(){return Ove(this.center.spatialReference)}pixelsPerPanAtZoom(e){return 1/(e*this.scaleToResolutionFactor)}zoomAtPixelsPerPan(e){return 1/(e*this.scaleToResolutionFactor)}pixelsPerRotate(){return this.size/2}compareTo(e,n){n.pan=ame(this.center,e.center);let r=Math.abs(e.rotation-this.rotation);r=r>=180?360-r:r,n.rotate=kI(r),n.sourceZoom=this.scale,n.targetZoom=e.scale}interpolate(e,n,r){const{pan:i,rotate:s,zoom:o,zoomOffset:a}=r,{center:l}=this;l.spatialReference=e.center.spatialReference,l.x=gS(e.center.x,n.center.x,i),l.y=gS(e.center.y,n.center.y,i),this.viewpoint.scale=gS(e.scale,n.scale+a,o);let c=e.rotation;const u=n.rotation;Math.abs(u-c)>=180&&(c+=360*(c<u?1:-1)),this.viewpoint.rotation=gS(c,u,s)}copyFrom(e){da(this.viewpoint,e.viewpoint),this._view=e.view}};function UE(t,e,n,r){const i=3*t,s=3*(n-t)-i,o=1-i-s,a=3*e,l=3*(r-e)-a,c=1-a-l;function u(y){return((o*y+s)*y+i)*y}function h(y){return((c*y+l)*y+a)*y}function f(y){return(3*o*y+2*s)*y+i}function g(y,_){let b,T,A,I,P,R;for(A=y,R=0;R<8;R++){if(I=u(A)-y,Math.abs(I)<_)return A;if(P=f(A),Math.abs(P)<1e-6)break;A-=I/P}if(b=0,T=1,A=y,A<b)return b;if(A>T)return T;for(;b<T;){if(I=u(A),Math.abs(I-y)<_)return A;y>I?b=A:T=A,A=.5*(T-b)+b}return A}return function(y,_=1e-6){return h(g(y,_))}}const Kc={};Kc.ease=UE(.25,.1,.25,1),Kc.linear=UE(0,0,1,1),Kc.easeIn=Kc["ease-in"]=UE(.42,0,1,1),Kc.easeOut=Kc["ease-out"]=UE(0,0,.58,1),Kc.easeInOut=Kc["ease-in-out"]=UE(.42,0,.58,1);const BQe=t=>t,lA=t=>t*t,mN=t=>1-lA(1-t),xre=t=>t<.5?lA(2*t)/2:(mN(2*(t-.5))+1)/2,gN=t=>t*t*t,BV=t=>1-gN(1-t),wre=t=>t<.5?gN(2*t)/2:(BV(2*(t-.5))+1)/2,yN=t=>t*t*t*t,WV=t=>1-yN(1-t),bre=t=>t<.5?yN(2*t)/2:(WV(2*(t-.5))+1)/2,vN=t=>t*t*t*t*t,HV=t=>1-vN(1-t),Ere=t=>t<.5?vN(2*t)/2:(HV(2*(t-.5))+1)/2,_N=t=>1-Math.cos(t*Math.PI/2),qV=t=>1-_N(1-t),Sre=t=>t<.5?_N(2*t)/2:(qV(2*(t-.5))+1)/2,xN=t=>2**(10*(t-1)),wN=t=>1-xN(1-t),Tre=t=>t<.5?xN(2*t)/2:(wN(2*(t-.5))+1)/2,bN=t=>-(Math.sqrt(1-t*t)-1),KV=t=>1-bN(1-t),kre=t=>t<.5?bN(2*t)/2:(KV(2*(t-.5))+1)/2;function xu(t){const e=2*(t-Math.sqrt((t-1)*t)),n=e/2/t;return r=>r<n?t*r*r:e*r-e+1}function wu(t,e){return(n,r)=>n<e?e*t(n/e,r):1-t((1-n)/(1-e),r)*(1-e)}const Are=wu(xu(1),1),Ire=wu(xu(1),0),EN=wu(xu(1),.5),Pre=wu(xu(2),1),Cre=wu(xu(2),0),Rre=wu(xu(2),.5),Mre=wu(xu(3),1),Nre=wu(xu(3),0),Ore=wu(xu(3),.5),Lre=wu(xu(4),1),Dre=wu(xu(4),0),jre=wu(xu(4),.5),$re={linear:BQe,"in-quad":lA,"out-quad":mN,"in-out-quad":xre,"in-coast-quad":Are,"out-coast-quad":Ire,"in-out-coast-quad":EN,"in-cubic":gN,"out-cubic":BV,"in-out-cubic":wre,"in-coast-cubic":Pre,"out-coast-cubic":Cre,"in-out-coast-cubic":Rre,"in-quart":yN,"out-quart":WV,"in-out-quart":bre,"in-coast-quart":Mre,"out-coast-quart":Nre,"in-out-coast-quart":Ore,"in-quint":vN,"out-quint":HV,"in-out-quint":Ere,"in-coast-quint":Lre,"out-coast-quint":Dre,"in-out-coast-quint":jre,"in-sine":_N,"out-sine":qV,"in-out-sine":Sre,"in-expo":xN,"out-expo":wN,"in-out-expo":Tre,"in-circ":bN,"out-circ":KV,"in-out-circ":kre,"quad-in":lA,"quad-out":mN,"quad-in-out":xre,"quad-in-coast":Are,"quad-out-coast":Ire,"quad-in-out-coast":EN,"cubic-in":gN,"cubic-out":BV,"cubic-in-out":wre,"cubic-in-coast":Pre,"cubic-out-coast":Cre,"cubic-in-out-coast":Rre,"quart-in":yN,"quart-out":WV,"quart-in-out":bre,"quart-in-coast":Mre,"quart-out-coast":Nre,"quart-in-out-coast":Ore,"quint-in":vN,"quint-out":HV,"quint-in-out":Ere,"quint-in-coast":Lre,"quint-out-coast":Dre,"quint-in-out-coast":jre,"sine-in":_N,"sine-out":qV,"sine-in-out":Sre,"expo-in":xN,"expo-out":wN,"expo-in-out":Tre,"circ-in":bN,"circ-out":KV,"circ-in-out":kre,ease:t=>Kc.ease(t),"ease-in":t=>Kc.easeIn(t),"ease-out":t=>Kc.easeOut(t),"ease-in-out":t=>Kc.easeInOut(t)};let WQe=class{constructor(){this.pan=0,this.rotate=0,this.fov=0,this.sourceZoom=0,this.targetZoom=0}};const SN={desiredScreenFlow:2,minDuration:500,maxDuration:8e3},u_e={maxDuration:4e3};let HQe=class h_e{constructor(e){this._createCamera=e,this.compared=new WQe,this.segmentStart=0,this.segmentEnd=1,this.settings={desiredScreenFlow:SN.desiredScreenFlow},this.source=e(),this.target=e()}clone(){const e=new h_e(this._createCamera);return e.copyFrom(this),e}copyFrom(e){this.update(e.source,e.target,e.settings)}update(e,n,r){this.source!==e&&this.source.copyFrom(e),this.target!==n&&this.target.copyFrom(n),this.source.compareTo(this.target,this.compared),this.settings.desiredScreenFlow=r.desiredScreenFlow??SN.desiredScreenFlow,this.desiredPixelFlow=this.settings.desiredScreenFlow*this.target.size,this.halfWindowSize=this.target.size/2}halfWindowPanAtZoom(e){const n=this.target.pixelsPerPanAtZoom(e);return this.halfWindowSize/n}get hasZoom(){return Math.abs(this.compared.sourceZoom-this.compared.targetZoom)>1e-5}get hasPan(){return this.compared.pan>Sl()}get hasFov(){return Math.abs(this.compared.fov)>Sl()}get hasRotate(){return this.compared.rotate>Sl()}},qQe=class{constructor(){this.pan=0,this.rotate=0,this.zoom=0,this.fov=0,this.zoomOffset=0}},KQe=class{constructor(){this.segments=new Array}get time(){return this.segments.reduce((e,n)=>e+n.time,0)}interpolateComponentsAt(e,n){e=Math.min(Math.max(e,0),1),e*=this.time;let r=0,i=0;const s=this.definition,o=this.segments.reduce((a,l)=>a||l.definition.hasZoom,!1);for(let a=0;a<this.segments.length;a++){const l=this.segments[a],c=l.definition;if(e<=l.time||a===this.segments.length-1){if(this.segmentInterpolateComponentsAt(l,l.time===0?0:e/l.time,n),s.hasPan&&!isNaN(n.pan)&&isFinite(s.compared.pan)?n.pan=(r+c.compared.pan*n.pan)/s.compared.pan:n.pan=1,s.hasRotate&&!isNaN(n.rotate)&&isFinite(s.compared.rotate)?n.rotate=(i+c.compared.rotate*n.rotate)/s.compared.rotate:n.rotate=1,o&&!isNaN(n.zoom)&&isFinite(c.compared.targetZoom)){const{sourceZoom:u,targetZoom:h}=c.compared,f=n.zoom*(h-u)+u,g=this.segments[0].definition.compared.sourceZoom,y=this.segments[this.segments.length-1].definition.compared.targetZoom,_=Math.abs(h-g)>Math.abs(u-g)?h:u;n.zoomOffset=_-y,n.zoom=(f-g)/(_-g)}else n.zoom=1;return n}e-=l.time,r+=c.compared.pan,i+=c.compared.rotate}}segmentInterpolateComponentsAt(e,n,r){e.interpolateComponentsAt(n,r)}},v$=class{get time(){return this._time}constructor(e){e&&this.update(e)}update(e){e&&(this.definition?this.definition.copyFrom(e):this.definition=e.clone()),this._updatePrecomputedVariables(),this._updatePixelFlow()}_updatePrecomputedVariables(){const e=this.definition,n=e.compared,r=n.sourceZoom,i=n.targetZoom;this._zoomSign=r>i?1:-1,this._panPixelsAtSource=n.pan*e.source.pixelsPerPanAtZoom(r);const s=(e.source.pixelsPerRotate()+e.target.pixelsPerRotate())/2;this._rotatePixels=n.rotate*s}_updatePixelFlow(){const e=this.definition.compared.sourceZoom,n=this.definition.compared.targetZoom,{hasZoom:r,hasPan:i,hasRotate:s}=this.definition;let o=0,a=0;r&&(i&&(o=(n/e-1)/(-1/(this._zoomSign*this.definition.halfWindowSize)*Math.LN2*this._panPixelsAtSource)),s&&(a=this._zoomSign*(Math.log(e/n)/Math.LN2)*this.definition.halfWindowSize/this._rotatePixels)),this._zoomPixelFlow=0,this._panPixelFlow=0,this._rotatePixelFlow=0;const l=this.definition.desiredPixelFlow;if(r&&i&&s){const c=o+a+o*a;this._zoomPixelFlow=o*a/c*l,this._panPixelFlow=a/c*l,this._rotatePixelFlow=o/c*l}else if(r&&i){const c=1+o;this._zoomPixelFlow=o/c*l,this._panPixelFlow=1/c*l}else if(r&&s){const c=1+a;this._zoomPixelFlow=a/c*l,this._rotatePixelFlow=1/c*l}else if(i&&s){const c=this._panPixelsAtSource/this._rotatePixels,u=1+c;this._panPixelFlow=c/u*l,this._rotatePixelFlow=1/u*l}else i?this._panPixelFlow=l:r?this._zoomPixelFlow=l:s&&(this._rotatePixelFlow=l);if(this._time=Math.max(this.rotateTime,this.zoomTime,this.panTime),this.fovTime>this._time){const c=this.fovTime/this._time;this._time=this.fovTime,this._zoomPixelFlow/=c,this._panPixelFlow/=c,this._rotatePixelFlow/=c}}get rotateTime(){return this.definition.hasRotate?this._rotatePixels/this._rotatePixelFlow:0}get zoomTime(){return this.definition.hasZoom?this._zoomSign*(Math.log(this.definition.compared.sourceZoom/this.definition.compared.targetZoom)/Math.LN2)*this.definition.halfWindowSize/this._zoomPixelFlow:0}get fovTime(){return this.definition.hasFov?Math.abs(this.definition.compared.fov)/YQe:0}get panTime(){if(!this.definition.hasPan)return 0;if(this.definition.hasZoom){const e=-1/(this._zoomSign*this.definition.halfWindowSize)*Math.LN2,n=e*this._panPixelsAtSource;return Math.log(n*(this._zoomPixelFlow/this._panPixelFlow)+1)/(e*this._zoomPixelFlow)}return this._panPixelsAtSource/this._panPixelFlow}_interpolateComponentsZoom(e){if(e===0||e===1)return e;if(this.definition.hasZoom){const n=this.definition.compared.sourceZoom,r=this.definition.compared.targetZoom;return(n*(n/r)**-e-n)/(r-n)}return e}_interpolateComponentsFov(e){if(e===0)return this.definition.segmentStart;if(e===1)return this.definition.segmentEnd;if(this.definition.hasFov){const{segmentStart:n,segmentEnd:r}=this.definition;return n+e*(r-n)}return this.definition.segmentStart}_interpolateComponentsPan(e){if(e===0||e===1)return e;if(this.definition.hasPan&&this.definition.hasZoom){const n=-1/(this._zoomSign*this.definition.halfWindowSize)*this._zoomPixelFlow;return 1/this._panPixelsAtSource*(this._panPixelFlow*(2**(n*e*this._time)-1))/(n*Math.LN2)}return e}_interpolateComponentsRotate(e){return e}interpolateComponentsAt(e,n){e=Math.min(Math.max(e,0),1),n.zoom=this._interpolateComponentsZoom(e),n.pan=this._interpolateComponentsPan(e),n.rotate=this._interpolateComponentsRotate(e),n.zoomOffset=0,n.fov=this._interpolateComponentsFov(e)}};const YQe=kI(45);function XQe(t,e,n){const r=e-t.compared.sourceZoom,i=t.halfWindowPanAtZoom(r);return-t.halfWindowSize*(n.ascensionFactor*Math.LN2*t.compared.pan+i)*Math.log(t.compared.sourceZoom/e)/(t.desiredPixelFlow*Math.LN2*i)}function ZQe(t,e,n){const r=1/e,i=Math.log(t.compared.sourceZoom*r),s=1/t.desiredPixelFlow,o=1/Math.LN2,a=e-t.compared.sourceZoom,l=1/a,c=(n.ascensionFactor*Math.LN2*t.compared.pan+t.halfWindowPanAtZoom(a))/t.halfWindowPanAtZoom(1);return t.halfWindowSize*r*s*o*l*c-t.halfWindowSize*i*s*o*l+t.halfWindowSize*i*s*o*c/(a*a)}function JQe(t,e,n){const r=e-t.compared.sourceZoom,i=1/r,s=1/e,o=Math.log(t.compared.sourceZoom*s),a=(n.ascensionFactor*Math.LN2*t.compared.pan+t.halfWindowPanAtZoom(r))/t.halfWindowPanAtZoom(1);return t.halfWindowSize*i*(-2*i*s*a+2*i*o+2*s-2*o*a/(r*r)-a/(e*e))/(t.desiredPixelFlow*Math.LN2)}function QQe(t,e){return-t.halfWindowSize*Math.log(t.compared.sourceZoom/e)/(t.desiredPixelFlow*Math.LN2)}function eet(t,e){return t.halfWindowSize/(e*t.desiredPixelFlow*Math.LN2)}function tet(t,e){return-t.halfWindowSize/(e*e*t.desiredPixelFlow*Math.LN2)}function net(t,e,n){return-t.compared.pan*t.halfWindowSize*(n.ascensionFactor+n.descensionFactor-1)/(t.desiredPixelFlow*t.halfWindowPanAtZoom(e))}function ret(t,e,n){return t.compared.pan*t.halfWindowSize*(n.ascensionFactor+n.descensionFactor-1)/(t.desiredPixelFlow*t.halfWindowPanAtZoom(e*e))}function iet(t,e,n){return-2*t.compared.pan*t.halfWindowSize*(n.ascensionFactor+n.descensionFactor-1)/(t.desiredPixelFlow*t.halfWindowPanAtZoom(e*e*e))}function set(t,e,n){return t.halfWindowSize*(-t.halfWindowPanAtZoom(e)-n.descensionFactor*Math.LN2*t.compared.pan+t.halfWindowPanAtZoom(t.compared.targetZoom))*Math.log(e/t.compared.targetZoom)/(t.desiredPixelFlow*Math.LN2*t.halfWindowPanAtZoom(-e+t.compared.targetZoom))}function oet(t,e,n){const r=Math.log(e/t.compared.targetZoom),i=1/t.desiredPixelFlow,s=1/Math.LN2,o=-e+t.compared.targetZoom,a=1/o,l=(-t.halfWindowPanAtZoom(e)-n.descensionFactor*Math.LN2*t.compared.pan+t.halfWindowPanAtZoom(t.compared.targetZoom))/t.halfWindowPanAtZoom(1);return-t.halfWindowSize*r*i*s*a+t.halfWindowSize*r*i*s*l/(o*o)+t.halfWindowSize*i*s*a*l/e}function aet(t,e,n){const r=e-t.compared.targetZoom,i=1/r,s=1/e,o=Math.log(e/t.compared.targetZoom),a=(t.halfWindowPanAtZoom(e)+n.descensionFactor*Math.LN2*t.compared.pan-t.halfWindowPanAtZoom(t.compared.targetZoom))/t.halfWindowPanAtZoom(1);return t.halfWindowSize*i*(-2*i*s*a-2*i*o+2*s+2*o*a/(r*r)-a/(e*e))/(t.desiredPixelFlow*Math.LN2)}function cet(t,e){return t.halfWindowSize*Math.log(e/t.compared.targetZoom)/(t.desiredPixelFlow*Math.LN2)}function uet(t,e){return t.halfWindowSize/(e*t.desiredPixelFlow*Math.LN2)}function het(t,e){return-t.halfWindowSize/(e*e*t.desiredPixelFlow*Math.LN2)}function det(t){const e=t.compared.sourceZoom-t.compared.targetZoom;if(e===0)return t.compared.pan*t.halfWindowSize/(t.desiredPixelFlow*t.halfWindowPanAtZoom(t.compared.sourceZoom));const n=Math.LN2*t.compared.pan,r=e,i=t.halfWindowPanAtZoom(r),s=t.halfWindowSize*Math.log(t.compared.sourceZoom/t.compared.targetZoom)/(t.desiredPixelFlow*Math.LN2*i);return t.compared.sourceZoom<=t.compared.targetZoom?s*(n-i):s*(n+i)}function fet(t,e){let n=pet(t,e);const r={ascensionFactor:e.ascensionFactor!=null?e.ascensionFactor:.5,descensionFactor:e.descensionFactor!=null?e.descensionFactor:.5},i=r.ascensionFactor===0,s=r.descensionFactor===0,o=i?QQe:XQe,a=i?eet:ZQe,l=i?tet:JQe,c=s?cet:set,u=s?uet:oet,h=s?het:aet,f=R=>o(t,R,r)+net(t,R,r)+c(t,R,r),g=R=>a(t,R,r)+ret(t,R,r)+u(t,R,r),y=R=>l(t,R,r)+iet(t,R,r)+h(t,R,r);let _=f(n);const b=det(t);let T;const A=e.maximumIterations||20,I=e.maximumDistance!=null?e.maximumDistance:1/0;for(T=0;T<A;T++){const R=e.desiredSlope??1e-6;let D=g(n);Math.abs(D)>R&&(D+=R);const C=D/y(n);if(isNaN(C)||n>=I&&C<0){if(!isFinite(I))return null;n=I,_=f(n);break}if(n-=C,n<=t.compared.sourceZoom||n<=t.compared.targetZoom)return null;const M=f(n);if(Math.abs(M-_)/_<=.005)break;_=M}return isNaN(_)||_>b*(1-.3)||n<=t.compared.sourceZoom||n<=t.compared.targetZoom?null:n}function pet(t,e){const n=Math.max(t.compared.sourceZoom,t.compared.targetZoom),r=t.source.zoomAtPixelsPerPan(t.desiredPixelFlow/t.compared.pan)/2;return r<n?e.maximumDistance!=null?n+(e.maximumDistance-n)/2:1.5*n:e.maximumDistance?Math.min(e.maximumDistance,r):r}let met=class extends KQe{constructor(e,n){super(),this._preallocSegments=[new v$,new v$,new v$],this._ascensionSegment=null,this._descensionSegment=null,this.update(e,n)}update(e,n){if(!e)return;this.definition?this.definition.copyFrom(e):this.definition=e.clone();const r=n?.apex?fet(e,n.apex):null;this.segments.length=0,this._ascensionSegment=null,this._descensionSegment=null,r?this._updateWithApex(r,n?.apex):this._updateWithoutApex()}segmentInterpolateComponentsAt(e,n,r){e.interpolateComponentsAt(n,r),e===this._ascensionSegment?r.zoom=mN(r.zoom):e===this._descensionSegment&&(r.zoom=lA(r.zoom))}_updateWithApex(e,n){const[r,i,s]=this._preallocSegments,o=n?.ascensionFactor??.5,a=Math.min(1-o,n?.ascensionFactor!=null&&n.descensionFactor!=null?n.descensionFactor:.5),l=1-o-a;r.definition?r.definition.copyFrom(this.definition):r.definition=this.definition.clone(),r.definition.compared.targetZoom=e,r.definition.compared.pan=this.definition.compared.pan*o,r.definition.compared.rotate=this.definition.compared.rotate*o,r.definition.segmentEnd=o,r.update(),this._ascensionSegment=r,this.segments.push(r),l>0&&(i.definition?i.definition.copyFrom(this.definition):i.definition=this.definition.clone(),i.definition.copyFrom(this.definition),i.definition.compared.sourceZoom=e,i.definition.compared.targetZoom=e,i.definition.compared.pan=this.definition.compared.pan*l,i.definition.compared.rotate=this.definition.compared.rotate*l,i.definition.segmentStart=r.definition.segmentEnd,i.definition.segmentEnd=r.definition.segmentEnd+l,i.update(),this.segments.push(i)),s.definition?s.definition.copyFrom(this.definition):s.definition=this.definition.clone(),s.definition.compared.sourceZoom=e,s.definition.compared.pan=this.definition.compared.pan*a,s.definition.compared.rotate=this.definition.compared.rotate*a,s.definition.segmentStart=o+l,s.update(),this._descensionSegment=s,this.segments.push(s)}_updateWithoutApex(){const[e]=this._preallocSegments;e.update(this.definition),this.segments.push(e)}};const get=new qQe;let yet=class{get time(){return this._time}get isLinear(){return this.path.segments.length===1}constructor(e){this._time=0,this._easing=EN,this.definition=new HQe(e),this.path=new met}update(e,n,r){this.definition.update(e,n,r),this.path.update(this.definition,r),this._time=this._applyTimeSettings(c$e(isFinite(this.path.time)?this.path.time:0),r),this._easing=r.easing??(this._time>=1e3?EN:wN)}cameraAt(e,n){e=Math.min(Math.max(0,e),1),e=this._normalizedEasing(e);const r=this.path.interpolateComponentsAt(e,get);n.interpolate(this.definition.source,this.definition.target,r)}_normalizedEasing(e){const n=this._easing(0,this._time),r=this._easing(1,this._time);return(this._easing(e,this._time)-n)/(r-n)}_applyTimeSettings(e,n){const r=n.speedFactor!=null?n.speedFactor:1,i=n.minDuration??SN.minDuration/r,s=n.maxDuration??SN.maxDuration/r;return e=n.duration!=null?n.duration:Math.min(Math.max(e/r,i),s)}};const vet=2e3,_et=64;let xet=class{constructor(e){this._view=e,this._animation=new yet(()=>new _re(this._view)),this._current=new _re(this._view)}get _source(){return this._animation.definition.source}get _target(){return this._animation.definition.target}get duration(){return this._animation.time}get animation(){return this._animation}update(e,n,r={}){da(this._current.viewpoint,e),da(this._source.viewpoint,e),da(this._target.viewpoint,n),this._animation.update(this._source,this._target,r)}applyRatio(e,n){this._animation.cameraAt(n,this._current),da(e,this._current.viewpoint)}},hx=class extends Kt{constructor(e){super(e),this._animation=null,this._destinationViewState=new ZW,this.updateFunction=null,this.easing=$re.ease,this.viewpoint=new du({targetGeometry:new Jt,scale:0,rotation:0}),this._updateTask=x2({postRender:this._postRender.bind(this)}),this._updateTask.pause(),this._transition=new xet(e.view)}destroy(){this._updateTask=ii(this._updateTask)}get animation(){return this._animation}set animation(e){this._animation=e,this.view.animation=e}animate(e,n,r){this.stop();const i=this.viewpoint;da(i,n);const s=e.target;this._transition.update(this.viewpoint,s,{apex:{maximumDistance:Math.min(Math.min(n.scale,s.scale)*_et,this.view.constraints.effectiveMinScale),desiredSlope:5e-8},duration:r?.duration,maxDuration:r?.animationMode==="auto"?1/0:r?.maxDuration??u_e.maxDuration,speedFactor:r?.speedFactor,easing:(typeof r?.easing=="string"?$re[r.easing]:r?.easing)||this.easing}),r?.animationMode==="auto"&&(this._destinationViewState.copy(this.view.state),this._destinationViewState.viewpoint=s,wet(this._transition.animation,r,this.view.state,this._destinationViewState)||this._transition.update(this.viewpoint,s,{duration:0}));const o=()=>{this.animation===e&&this._updateTask&&(e.state==="finished"&&(this._transition.applyRatio(this.viewpoint,1),this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())),this.animation=null,this.updateFunction=null)};return e.when(o,o),this._startTime=performance.now(),this._updateTask.resume(),this.animation=e,e}animateContinuous(e,n){this.stop(),this.updateFunction=n,this.viewpoint=e;const r=new GV({target:e.clone()}),i=()=>{this.animation===r&&this._updateTask&&(this.animation=null,this.updateFunction=null)};return r.when(i,i),this._startTime=performance.now(),this._updateTask.resume(),this.animation=r,r}stop(){this.animation&&(this.animation.stop(),this.animation=null,this.updateFunction=null)}_postRender(e){const n=this.animation;if(n&&n.state!==GV.state.STOPPED){if(this.updateFunction)this.updateFunction(this.viewpoint,e.deltaTime),this.animation?.update(this.viewpoint);else{const r=performance.now()-this._startTime,i=this._transition.duration,s=i>0?r/i:1,o=s>=1;this._transition.applyRatio(this.viewpoint,s),o&&this.animation?.finish()}this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())}else this._updateTask.pause()}};function wet(t,e,n,r){if(e?.duration!=null)return!0;const{time:i,isLinear:s}=t,o=e?.speedFactor||1;if(i>(e?.maxDuration??u_e.maxDuration/o))return!1;if(s){const l=Vi(),c=Hs(...r.toScreen(l,...n.center)),u=Hs(...n.toScreen(l,...r.center)),h=u!=null&&u.x>-1*n.size[0]&&u.x<(1.5+.5)*n.size[0]&&u.y>-1*n.size[1]&&u.y<(1.5+.5)*n.size[1],f=c!=null&&c.x>-1*r.size[0]&&c.x<(1.5+.5)*r.size[0]&&c.y>-1*r.size[1]&&c.y<(1.5+.5)*r.size[1];if(i>vet/o&&!h&&!f)return!1}return!0}x([E()],hx.prototype,"easing",void 0),x([E()],hx.prototype,"view",void 0),x([E()],hx.prototype,"viewpoint",void 0),hx=x([ue("esri.views.2d.AnimationManager")],hx);const bet=hx;function ai(){return Promise.all([_e(()=>import("./webglDeps-DLts60pU.js"),__vite__mapDeps([297,222,298,299,300,26,94])),_e(()=>import("./mapViewDeps-B3twslwA.js"),__vite__mapDeps([301,173,53,54,138,139,129,64,26,140,131,132,137,141,125,142,87,302,303,222,298,299,213,126,304,133,300,94,221,93,305,124,161,306,249,192,195,66,67,31,134,146,307,143,144,308,83,78,127,76,77,309,51,297,310,156,311,312,191,313,211,212,314,111,123,128,130,122,71,70,315,145,316,136,45,46,47,317,147,152,120,318,319,320,321,218,252,322,323]))])}const BE=()=>ai().then(()=>_e(()=>import("./TileLayerView2D-CQfBvOHv.js"),__vite__mapDeps([324,137,132,138,139,129,64,26,140,131,141,125,142,87,308,173,53,54,83,78,127,76,77,309,51,306,249,305,124,93,299,300,94,221,222,161,192,195,66,67,310,303,298,213,304,133,156,311,312,191,111,302,126,31,134,146,143,144,211,212,317,123,128,130,122,71,70,147,152,120,325,326,327,321,328,281,329,319,320,330,331,332,252,333,334,335,336,337]))),$0=()=>ai().then(()=>_e(()=>import("./FeatureLayerView2D-BL0LIbdw.js").then(t=>t.F),__vite__mapDeps([338,302,138,139,129,64,26,140,131,132,137,141,125,142,87,303,222,298,299,213,126,304,133,300,94,221,93,305,124,161,306,249,192,195,66,67,31,134,146,256,233,204,200,177,164,201,202,203,205,122,163,206,82,130,339,238,340,341,71,81,328,281,320,321,156,112,110,111,113,153,154,147,83,78,266,52,53,54,307,342,226,85,149,255,248,333,336,330,331,337]))),Fre={"base-dynamic":()=>ai().then(()=>_e(()=>import("./BaseDynamicLayerView2D-DgwpOB7B.js"),__vite__mapDeps([343,344,305,124,125,93,299,300,26,94,221,222,161,306,249,192,195,66,64,67,326,303,298,213,327,328,281,345,330,331]))),"base-tile":BE,"bing-maps":BE,catalog:()=>ai().then(()=>_e(()=>import("./CatalogLayerView2D-DcIyD7Mz.js"),__vite__mapDeps([346,328,306,249,281,330]))),"catalog-dynamic-group":()=>ai().then(()=>_e(()=>import("./CatalogDynamicGroupLayerView2D-Cabdx_sh.js"),__vite__mapDeps([347,328,306,249,281,330]))),"catalog-footprint":()=>ai().then(()=>_e(()=>import("./CatalogFootprintLayerView2D-CmWP5nAd.js"),__vite__mapDeps([348,338,302,138,139,129,64,26,140,131,132,137,141,125,142,87,303,222,298,299,213,126,304,133,300,94,221,93,305,124,161,306,249,192,195,66,67,31,134,146,256,233,204,200,177,164,201,202,203,205,122,163,206,82,130,339,238,340,341,71,81,328,281,320,321,156,112,110,111,113,153,154,147,83,78,266,52,53,54,307,342,226,85,149,255,248,333,336,330,331,337]))),csv:$0,"geo-rss":()=>ai().then(()=>_e(()=>import("./GeoRSSLayerView2D-Dgfjx25F.js"),__vite__mapDeps([349,244,204,200,177,164,201,31,202,203,142,87,197,198,199,163,24,25,135,83,78,127,76,77,131,132,52,53,54,205,122,206,238,328,306,249,281,318,319,320,26,126,124,125,93,298,222,321,305,299,300,94,221,161,192,195,66,64,67,302,138,139,129,140,137,141,303,213,304,133,134,146,317,308,173,309,51,123,128,130,71,70,147,152,120,330]))),feature:$0,geojson:$0,parquet:$0,graphics:()=>ai().then(()=>_e(()=>import("./GraphicsLayerView2D-CNs4VrzP.js"),__vite__mapDeps([350,328,306,249,281,318,319,320,26,126,124,125,93,298,222,321,305,299,300,94,221,161,192,195,66,64,67,302,138,139,129,140,131,132,137,141,142,87,303,213,304,133,31,134,146,317,83,78,308,173,53,54,127,76,77,309,51,123,128,130,122,71,70,147,152,120,330,337]))),group:()=>ai().then(()=>_e(()=>import("./GroupLayerView2D-DJbVt8tW.js"),__vite__mapDeps([351,328,306,249,281,330]))),imagery:()=>ai().then(()=>_e(()=>import("./ImageryLayerView2D-C-bUiTaq.js"),__vite__mapDeps([352,353,300,26,94,221,222,93,179,305,124,125,299,161,306,249,192,195,66,64,67,172,170,328,281,317,83,78,138,139,129,140,131,132,137,141,142,87,308,173,53,54,127,76,77,309,51,123,126,128,130,122,133,71,70,302,303,298,213,304,31,134,146,147,152,120,329,319,320,321,344,326,327,345,176,291,339,336,330,331,337]))),"imagery-tile":()=>ai().then(()=>_e(()=>import("./ImageryTileLayerView2D-zrqVdO8V.js"),__vite__mapDeps([354,355,353,300,26,94,221,222,93,179,305,124,125,299,161,306,249,192,195,66,64,67,172,170,328,281,175,356,321,303,298,213,316,304,133,327,357,176,337,291,339,336,330,331]))),kml:()=>ai().then(()=>_e(()=>import("./KMLLayerView2D-Dhgbll5v.js"),__vite__mapDeps([358,359,197,198,199,200,177,164,201,31,202,203,142,87,163,24,25,135,83,78,127,76,77,131,132,52,53,54,204,205,122,206,238,326,306,249,303,222,298,299,213,327,344,305,124,125,93,300,26,94,221,161,192,195,66,64,67,328,281,318,319,320,126,321,302,138,139,129,140,137,141,304,133,134,146,317,308,173,309,51,123,128,130,71,70,147,152,120,330,45,46,47,176,313,297,211,212,311,356]))),"knowledge-graph":()=>ai().then(()=>_e(()=>import("./KnowledgeGraphLayerView2D-Dd5TMHM2.js"),__vite__mapDeps([360,328,306,249,281,330]))),"link-chart":()=>ai().then(()=>_e(()=>import("./KnowledgeGraphLayerView2D-Dd5TMHM2.js"),__vite__mapDeps([360,328,306,249,281,330]))),"knowledge-graph-sublayer":$0,"map-image":()=>ai().then(()=>_e(()=>import("./MapImageLayerView2D-CUbhoD4i.js"),__vite__mapDeps([361,344,305,124,125,93,299,300,26,94,221,222,161,306,249,192,195,66,64,67,326,303,298,213,327,328,281,317,83,78,138,139,129,140,131,132,137,141,142,87,308,173,53,54,127,76,77,309,51,123,126,128,130,122,133,71,70,302,304,31,134,146,147,152,120,329,319,320,321,345,330,362,252,333,335,339,331,332,334,336,337]))),"map-notes":()=>ai().then(()=>_e(()=>import("./MapNotesLayerView2D-C3AneEkJ.js"),__vite__mapDeps([363,328,306,249,281,318,319,320,26,126,124,125,93,298,222,321,305,299,300,94,221,161,192,195,66,64,67,302,138,139,129,140,131,132,137,141,142,87,303,213,304,133,31,134,146,317,83,78,308,173,53,54,127,76,77,309,51,123,128,130,122,71,70,147,152,120,330,337]))),media:()=>ai().then(()=>_e(()=>import("./MediaLayerView2D-BT6hxhMQ.js"),__vite__mapDeps([364,365,152,204,200,177,164,201,31,202,203,142,87,137,132,138,139,129,64,26,140,131,141,125,308,173,53,54,83,78,127,76,77,309,51,306,249,305,124,93,299,300,94,221,222,161,192,195,66,67,310,303,298,213,304,133,156,311,312,191,111,302,126,134,146,143,144,211,212,317,123,128,130,122,71,70,147,120,315,145,366,316,328,281,330]))),"ogc-feature":()=>ai().then(()=>_e(()=>import("./OGCFeatureLayerView2D-DxttKhLR.js"),__vite__mapDeps([367,338,302,138,139,129,64,26,140,131,132,137,141,125,142,87,303,222,298,299,213,126,304,133,300,94,221,93,305,124,161,306,249,192,195,66,67,31,134,146,256,233,204,200,177,164,201,202,203,205,122,163,206,82,130,339,238,340,341,71,81,328,281,320,321,156,112,110,111,113,153,154,147,83,78,266,52,53,54,307,342,226,85,149,255,248,333,336,330,331,337]))),"open-street-map":BE,"oriented-imagery":$0,route:()=>ai().then(()=>_e(()=>import("./RouteLayerView2D-t8oQfVoo.js"),__vite__mapDeps([368,369,370,328,306,249,281,318,319,320,26,126,124,125,93,298,222,321,305,299,300,94,221,161,192,195,66,64,67,302,138,139,129,140,131,132,137,141,142,87,303,213,304,133,31,134,146,317,83,78,308,173,53,54,127,76,77,309,51,123,128,130,122,71,70,147,152,120,330,337]))),stream:()=>ai().then(()=>_e(()=>import("./StreamLayerView2D-fk3H_fAm.js"),__vite__mapDeps([371,238,338,302,138,139,129,64,26,140,131,132,137,141,125,142,87,303,222,298,299,213,126,304,133,300,94,221,93,305,124,161,306,249,192,195,66,67,31,134,146,256,233,204,200,177,164,201,202,203,205,122,163,206,82,130,339,340,341,71,81,328,281,320,321,156,112,110,111,113,153,154,147,83,78,266,52,53,54,307,342,226,85,149,255,248,333,336,330,331,337]))),"subtype-group":()=>ai().then(()=>_e(()=>import("./SubtypeGroupLayerView2D-BfCIJM61.js"),__vite__mapDeps([372,338,302,138,139,129,64,26,140,131,132,137,141,125,142,87,303,222,298,299,213,126,304,133,300,94,221,93,305,124,161,306,249,192,195,66,67,31,134,146,256,233,204,200,177,164,201,202,203,205,122,163,206,82,130,339,238,340,341,71,81,328,281,320,321,156,112,110,111,113,153,154,147,83,78,266,52,53,54,307,342,226,85,149,255,248,333,336,330,331,337]))),tile:BE,"vector-tile":()=>ai().then(()=>_e(()=>import("./VectorTileLayerView2D-CQp9roqE.js"),__vite__mapDeps([373,122,141,111,26,137,132,24,25,191,312,192,140,222,300,94,221,305,124,125,93,299,161,306,249,195,66,64,67,321,69,244,193,194,173,53,54,328,281,330,331]))),video:()=>ai().then(()=>_e(()=>import("./VideoLayerView2D-B3aqmmQk.js"),__vite__mapDeps([374,375,247,29,248,249,268,30,31,376,236,131,132,235,24,25,366,161,305,124,125,93,299,300,26,94,221,222,306,192,195,66,64,67,302,138,139,129,140,137,141,142,87,303,298,213,126,304,133,134,146,316,377,328,281,318,319,320,321,317,83,78,308,173,53,54,127,76,77,309,51,123,128,130,122,71,70,147,152,120,330]))),wcs:()=>ai().then(()=>_e(()=>import("./ImageryTileLayerView2D-zrqVdO8V.js"),__vite__mapDeps([354,355,353,300,26,94,221,222,93,179,305,124,125,299,161,306,249,192,195,66,64,67,172,170,328,281,175,356,321,303,298,213,316,304,133,327,357,176,337,291,339,336,330,331]))),"web-tile":BE,wfs:$0,wms:()=>ai().then(()=>_e(()=>import("./WMSLayerView2D-D63f7JRC.js"),__vite__mapDeps([378,344,305,124,125,93,299,300,26,94,221,222,161,306,249,192,195,66,64,67,326,303,298,213,327,328,281,345,330,331,379,339]))),wmts:()=>ai().then(()=>_e(()=>import("./WMTSLayerView2D-CB1Y03Jo.js"),__vite__mapDeps([380,325,326,306,249,303,222,298,299,213,327,305,124,125,93,300,26,94,221,161,192,195,66,64,67,321,328,281,330,331]))),"base-elevation":null,"building-scene":null,dimension:null,elevation:null,"gaussian-splat":null,"integrated-mesh-3dtiles":null,"integrated-mesh":null,"line-of-sight":null,"point-cloud":null,scene:null,unknown:null,unsupported:null,viewshed:null,voxel:null};function Eet(t){const e=t.declaredClass?t.declaredClass.slice(t.declaredClass.lastIndexOf(".")+1):"Unknown",n=e.replaceAll(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();return new Xe(`${n}:view-not-supported`,`${e} is not supported in 2D`)}const Vre={hasLayerViewModule:t=>Fre[t.type]!=null,importLayerView:t=>{const e=Fre[t.type];if(e==null)throw Eet(t);return e(t)}};var ec;let xb=(ec=class{static getId(e,n,r,i){return typeof e=="object"?`${e.level}/${e.row}/${e.col}/${e.world}`:`${e}/${n}/${r}/${i}`}constructor(e,n,r,i){this.set(e,n,r,i)}get key(){return this}get id(){return this.toString()}get normalizedId(){return`${this.level}/${this.row}/${this.col}`}set id(e){this.set(e)}get hash(){const e=4095&this.row,n=4095&this.col,r=63&this.level;return(3&this.world)<<30|n<<22|e<<8|r}acquire(e,n,r,i){this.set(e,n,r,i)}contains(e){const n=e.level-this.level;return n>=0&&this.row===e.row>>n&&this.col===e.col>>n&&this.world===e.world}containsChild(e){const n=e.level-this.level;return n>0&&this.row===e.row>>n&&this.col===e.col>>n&&this.world===e.world}equals(e){return this.level===e.level&&this.row===e.row&&this.col===e.col&&this.world===e.world}clone(){return new ec(this)}release(){this.level=0,this.row=0,this.col=0,this.world=0}set(e,n,r,i){if(e==null)this.level=0,this.row=0,this.col=0,this.world=0;else if(typeof e=="object")this.level=e.level||0,this.row=e.row||0,this.col=e.col||0,this.world=e.world||0;else if(typeof e=="string"){const[s,o,a,l]=e.split("/");this.level=parseFloat(s),this.row=parseFloat(o),this.col=parseFloat(a),this.world=parseFloat(l)}else this.level=+e,this.row=+n,this.col=+r,this.world=+i||0;return this}toString(){return`${this.level}/${this.row}/${this.col}/${this.world}`}getParentKey(){return this.level<=0?null:new ec(this.level-1,this.row>>1,this.col>>1,this.world)}getNormalizedNeighbor(e,n,r){const i=this.clone();return i.col+=e,i.row+=n,r.normalizeKey(i),i}getChildKeys(){const e=this.level+1,n=this.row<<1,r=this.col<<1,i=this.world;return[new ec(e,n,r,i),new ec(e,n,r+1,i),new ec(e,n+1,r,i),new ec(e,n+1,r+1,i)]}compareRowMajor(e){return this.row<e.row?-1:this.row>e.row?1:this.col<e.col?-1:this.col>e.col?1:0}},ec.pool=new lb(()=>new ec(""),null,null,25,50),ec);function P_(t,e){return[t,e]}function F0(t,e,n){return t[0]=e,t[1]=n,t}function Tet(t,e,n,r,i){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t}const Vu=new xb("0/0/0/0");let ket=class d_e{static create(e,n,r=null){const i=za(e.spatialReference),s=n.origin||P_(e.origin.x,e.origin.y),o=P_(e.size[0]*n.resolution,e.size[1]*n.resolution),a=P_(-1/0,-1/0),l=P_(1/0,1/0),c=P_(1/0,1/0);r!=null&&(F0(a,Math.max(0,Math.floor((r.xmin-s[0])/o[0])),Math.max(0,Math.floor((s[1]-r.ymax)/o[1]))),F0(l,Math.max(0,Math.floor((r.xmax-s[0])/o[0])),Math.max(0,Math.floor((s[1]-r.ymin)/o[1]))),F0(c,l[0]-a[0]+1,l[1]-a[1]+1));const{cols:u,rows:h}=n;let f,g,y,_;return!r&&u&&h&&(F0(a,u[0],h[0]),F0(l,u[1],h[1]),F0(c,u[1]-u[0]+1,h[1]-h[0]+1)),e.isWrappable?(f=P_(Math.ceil(Math.round((i.valid[1]-i.valid[0])/n.resolution)/e.size[0]),c[1]),g=!0,y=i.origin,_=i.valid):(f=c,g=!1),new d_e(n.level,n.resolution,n.scale,s,a,l,c,o,f,g,y,_)}constructor(e,n,r,i,s,o,a,l,c,u,h,f){this.level=e,this.resolution=n,this.scale=r,this.origin=i,this.first=s,this.last=o,this.size=a,this.norm=l,this.worldSize=c,this.wrap=u,this._spatialReferenceOrigin=h,this._spatialReferenceValid=f}normalizeCol(e){if(!this.wrap)return e;const n=this.worldSize[0];return e<0?n-1-Math.abs((e+1)%n):e%n}normalizeKey(e){if(!this.wrap)return;const n=this.worldSize[0],r=e.col;r<0?(e.col=r+n,e.world-=1):r>=n&&(e.col=r-n,e.world+=1)}denormalizeCol(e,n){return this.wrap?this.worldSize[0]*n+e:e}getWorldForColumn(e){return this.wrap?Math.floor(e/this.worldSize[0]):0}getFirstColumnForWorld(e){return e*this.worldSize[0]+this.first[0]}getLastColumnForWorld(e){return e*this.worldSize[0]+this.first[0]+this.size[0]-1}getColumnForX(e){return(e-this.origin[0])/this.norm[0]}getXForColumn(e){const n=this.origin[0]+e*this.norm[0],r=this._spatialReferenceOrigin,i=this._spatialReferenceValid;return this.wrap&&r&&i?n===r[0]?i[0]:this.origin[0]===r[0]&&e===this.worldSize[0]?i[1]:n:n}getRowForY(e){return(this.origin[1]-e)/this.norm[1]}getYForRow(e){return this.origin[1]-e*this.norm[1]}getTileBounds(e,n,r=!1){Vu.set(n);const i=r?Vu.col:this.denormalizeCol(Vu.col,Vu.world),s=Vu.row;return Tet(e,this.getXForColumn(i),this.getYForRow(s+1),this.getXForColumn(i+1),this.getYForRow(s)),e}getTileCoords(e,n,r=!1){Vu.set(n);const i=r?Vu.col:this.denormalizeCol(Vu.col,Vu.world);return Array.isArray(e)?F0(e,this.getXForColumn(i),this.getYForRow(Vu.row)):(e.x=this.getXForColumn(i),e.y=this.getYForRow(Vu.row)),e}};var g1;let eH=(g1=class{constructor(){this.spans=[]}acquire(e){this.lodInfo=e}release(){this.lodInfo=null,this.spans.length=0}*keys(){const e=this.lodInfo;for(const{row:n,colFrom:r,colTo:i}of this.spans)for(let s=r;s<=i;s++){const o=e.getWorldForColumn(s);yield new xb(e.level,n,e.normalizeCol(s),o)}}forEach(e,n){const{spans:r,lodInfo:i}=this,{level:s}=i;if(r.length!==0)for(const{row:o,colFrom:a,colTo:l}of r)for(let c=a;c<=l;c++)e.call(n,s,o,i.normalizeCol(c),i.getWorldForColumn(c))}},g1.pool=new lb(()=>new g1),g1),_$=class{constructor(e,n,r){this.row=e,this.colFrom=n,this.colTo=r}};const ui=new xb("0/0/0/0");let Aet=class f_e{static create(e,n){e[1]>n[1]&&([e,n]=[n,e]);const[r,i]=e,[s,o]=n,a=s-r,l=o-i,c=l!==0?a/l:0,u=(Math.ceil(i)-i)*c,h=(Math.floor(i)-i)*c;return new f_e(r,Math.floor(i),Math.ceil(o),c,a<0?u:h,a<0?h:u,a<0?s:r,a<0?r:s)}constructor(e,n,r,i,s,o,a,l){this.x=e,this.ymin=n,this.ymax=r,this.invM=i,this.leftAdjust=s,this.rightAdjust=o,this.leftBound=a,this.rightBound=l}incrRow(){this.x+=this.invM}getLeftCol(){return Math.max(this.x+this.leftAdjust,this.leftBound)}getRightCol(){return Math.min(this.x+this.rightAdjust,this.rightBound)}};const Bl=[[0,0],[0,0],[0,0],[0,0]],Iet=1e-6;let Pet=class{constructor(e,n=null,r=e.lods[0].level,i=e.lods[e.lods.length-1].level){this.tileInfo=e,this.fullExtent=n,this.scales=[],this._infoByScale={},this._infoByLevel={};const s=e.lods.filter(a=>a.level>=r&&a.level<=i);this.minScale=s[0].scale,this.maxScale=s[s.length-1].scale;const o=this._lodInfos=s.map(a=>ket.create(e,a,n));s.forEach((a,l)=>{this._infoByLevel[a.level]=o[l],this._infoByScale[a.scale]=o[l],this.scales[l]=a.scale},this),this._wrap=e.isWrappable}get spatialReference(){return this.tileInfo.spatialReference}getLODInfoAt(e){return this._infoByLevel[typeof e=="number"?e:e.level]}getTileBounds(e,n,r=!1){ui.set(n);const i=this._infoByLevel[ui.level];return i?i.getTileBounds(e,ui,r):e}getTileCoords(e,n,r=!1){ui.set(n);const i=this._infoByLevel[ui.level];return i?i.getTileCoords(e,ui,r):e}getTileCoverage(e,n=192,r=!0,i="closest"){if(!r&&(e.scale>this.minScale||e.scale<this.maxScale))return null;const s=i==="closest"?this.getClosestInfoForScale(e.scale):this.getSmallestInfoForScale(e.scale),o=eH.pool.acquire(s),a=this._wrap;let l,c,u,h=1/0,f=-1/0;const g=o.spans;Bl[0][0]=Bl[0][1]=Bl[1][1]=Bl[3][0]=-n,Bl[1][0]=Bl[2][0]=e.size[0]+n,Bl[2][1]=Bl[3][1]=e.size[1]+n;for(const T of Bl)e.toMap(T,T),T[0]=s.getColumnForX(T[0]),T[1]=s.getRowForY(T[1]);const y=[];let _=3;for(let T=0;T<4;T++){if(Bl[T][1]===Bl[_][1]){_=T;continue}const A=Aet.create(Bl[T],Bl[_]);h=Math.min(A.ymin,h),f=Math.max(A.ymax,f),y[A.ymin]===void 0&&(y[A.ymin]=[]),y[A.ymin].push(A),_=T}if(h==null||f==null||f-h>100)return null;let b=[];for(l=h;l<f;){y[l]!=null&&(b=b.concat(y[l])),c=1/0,u=-1/0;for(let T=b.length-1;T>=0;T--){const A=b[T];c=Math.min(c,A.getLeftCol()),u=Math.max(u,A.getRightCol())}if(c=Math.floor(c),u=Math.floor(u),l>=s.first[1]&&l<=s.last[1])if(a)if(s.size[0]<s.worldSize[0]){const T=Math.floor(u/s.worldSize[0]);for(let A=Math.floor(c/s.worldSize[0]);A<=T;A++)g.push(new _$(l,Math.max(s.getFirstColumnForWorld(A),c),Math.min(s.getLastColumnForWorld(A),u)))}else g.push(new _$(l,c,u));else c>s.last[0]||u<s.first[0]||(c=Math.max(c,s.first[0]),u=Math.min(u,s.last[0]),g.push(new _$(l,c,u)));l+=1;for(let T=b.length-1;T>=0;T--){const A=b[T];A.ymax>=l?A.incrRow():b.splice(T,1)}}return o}getTileParentId(e){ui.set(e);const n=this._infoByLevel[ui.level],r=this._lodInfos.indexOf(n)-1;return r<0?null:(this._getTileIdAtLOD(ui,this._lodInfos[r],ui),ui.id)}getTileResolution(e){const n=this._infoByLevel[typeof e=="object"?e.level:e];return n?n.resolution:-1}getTileScale(e){const n=this._infoByLevel[e.level];return n?n.scale:-1}intersects(e,n){ui.set(n);const r=this._infoByLevel[ui.level],i=e.lodInfo;if(i.resolution>r.resolution){this._getTileIdAtLOD(ui,i,ui);const o=i.denormalizeCol(ui.col,ui.world);for(const a of e.spans)if(a.row===ui.row&&a.colFrom<=o&&a.colTo>=o)return!0}if(i.resolution<r.resolution){const[o,a,l,c]=e.spans.reduce((_,b)=>(_[0]=Math.min(_[0],b.row),_[1]=Math.max(_[1],b.row),_[2]=Math.min(_[2],b.colFrom),_[3]=Math.max(_[3],b.colTo),_),[1/0,-1/0,1/0,-1/0]),u=r.denormalizeCol(ui.col,ui.world),h=i.getColumnForX(r.getXForColumn(u)),f=i.getRowForY(r.getYForRow(ui.row)),g=i.getColumnForX(r.getXForColumn(u+1))-1,y=i.getRowForY(r.getYForRow(ui.row+1))-1;return!(h>c||g<l||f>a||y<o)}const s=i.denormalizeCol(ui.col,ui.world);return e.spans.some(o=>o.row===ui.row&&o.colFrom<=s&&o.colTo>=s)}normalizeBounds(e,n,r){if(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],this._wrap){const i=za(this.tileInfo.spatialReference),s=-r*(i.valid[1]-i.valid[0]);e[0]+=s,e[2]+=s}return e}getSmallestInfoForScale(e){const n=this.scales;if(this._infoByScale[e])return this._infoByScale[e];if(e>n[0])return this._infoByScale[n[0]];for(let r=1;r<n.length-1;r++)if(e>n[r]+Iet)return this._infoByScale[n[r-1]];return this._infoByScale[n[n.length-1]]}getClosestInfoForScale(e){const n=this.scales;return this._infoByScale[e]||(e=n.reduce((r,i)=>Math.abs(i-e)<Math.abs(r-e)?i:r,n[0])),this._infoByScale[e]}scaleToLevel(e){const n=this.scales;if(this._infoByScale[e])return this._infoByScale[e].level;for(let r=n.length-1;r>=0;r--)if(e<n[r])return r===n.length-1?this._infoByScale[n[n.length-1]].level:this._infoByScale[n[r]].level+(n[r]-e)/(n[r]-n[r+1]);return this._infoByScale[n[0]].level}scaleToZoom(e){return this.tileInfo.scaleToZoom(e)}zoomToScale(e){return this.tileInfo.zoomToScale(e)}_getTileIdAtLOD(e,n,r){const i=this._infoByLevel[r.level];return e.set(r),n.resolution<i.resolution?null:(n.resolution===i.resolution||(e.level=n.level,e.col=Math.floor(r.col*i.resolution/n.resolution+.01),e.row=Math.floor(r.row*i.resolution/n.resolution+.01)),e)}},Cet=class{constructor(e,n){this.item=e,this.controller=n,this.promise=null}},Ret=class{constructor(e){this._schedule=null,this._task=null,this._deferreds=new yw,this._controllers=new yw,this._processingItems=new yw,this._pausedSignal=N2(!1),this.concurrency=1,e.concurrency&&(this.concurrency=e.concurrency),this._queue=new Qk(e.peeker),this.process=e.process;const n=e.scheduler;e.priority&&n&&(this._task=n.registerTask(e.priority,this))}destroy(){this.clear(),this._schedule=ii(this._schedule),this._task=ii(this._task)}get updating(){return!!this._task?.updating||this.readyToRun}get length(){return this._processingItems.size+this._queue.length}abort(e){const n=this._controllers.get(e);n&&n.abort()}clear(){this._queue.clear();const e=[];this._controllers.forEach(n=>e.push(n)),this._controllers.clear(),e.forEach(n=>n.abort()),this._processingItems.clear(),this._cancelNext()}forEach(e){this._deferreds.forEach((n,r)=>e(r))}get(e){const n=this._deferreds.get(e);return n?n.promise:void 0}isOngoing(e){return this._processingItems.has(e)}has(e){return this._deferreds.has(e)}pause(){this._pausedSignal.value||(this._pausedSignal.value=!0,this._cancelNext())}push(e,n){const r=this.get(e);if(r)return r;const i=new AbortController;let s=null;n&&(s=yu(n,()=>i.abort()));const o=()=>{const u=this._processingItems.get(e);u&&u.controller.abort(),a(),c.reject(Pr())},a=()=>{l.remove(),s?.remove(),this._removeItem(e),this._queue.remove(e),this._scheduleNext()},l=fB(i.signal,o),c=xc();return this._deferreds.set(e,c),this._controllers.set(e,i),c.promise.then(a,a),this._queue.push(e),this._scheduleNext(),c.promise}last(){return this._queue.last()}lastPromise(){const e=this.last();return e?this.get(e):null}peek(){return this._queue.peek()}popLast(){const e=this._queue.popLast();return e&&(this._deferreds.get(e)?.reject(Pr()),this._removeItem(e)),e}reset(){const e=Array.from(this._processingItems.values());this._processingItems.clear();for(const n of e)this._queue.push(n.item),n.controller.abort();this._scheduleNext()}resume(){this._pausedSignal.value&&(this._pausedSignal.value=!1,this._scheduleNext())}takeAll(){const e=[];for(;this._queue.length;)e.push(this._queue.pop());return this.clear(),e}get readyToRun(){return!this._pausedSignal.value&&this._queue.length>0&&this._processingItems.size<this.concurrency}runTask(e){for(;!e.done&&this._queue.length>0&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop()),e.madeProgress()}_removeItem(e){this._deferreds.delete(e),this._controllers.delete(e),this._processingItems.delete(e)}_scheduleNext(){this._task||this._pausedSignal.value||this._schedule||(this._schedule=hb(()=>{this._schedule=null,this._next()}))}_next(){for(;this._queue.length>0&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop())}_cancelNext(){this._schedule&&(this._schedule.remove(),this._schedule=null)}_processResult(e,n){this._canProcessFulfillment(e)&&(this._scheduleNext(),this._deferreds.get(e.item).resolve(n))}_processError(e,n){this._canProcessFulfillment(e)&&(this._scheduleNext(),this._deferreds.get(e.item).reject(n))}_canProcessFulfillment(e){return!!this._deferreds.get(e.item)&&this._processingItems.get(e.item)===e}_process(e){if(e==null)return;let n;const r=new AbortController,i=new Cet(e,r);this._processingItems.set(e,i);try{n=this.process(e,r.signal)}catch(s){this._processError(i,s)}ga(n)?(i.promise=n,n.then(s=>this._processResult(i,s),s=>this._processError(i,s))):this._processResult(i,n)}get test(){}};const zre=[0,0];let Af=class extends Kt{constructor(e){super(e),this._keyToItem=new Map,this._tilesByScale=new Map,this.concurrency=6}initialize(){const{concurrency:e,process:n,scheduler:r,priority:i}=this;this._queue=new Ret({concurrency:e,scheduler:r,priority:i,process:(s,o)=>{const a=this._keyToItem.get(s);return n(a,{signal:o})},peeker:s=>this._peek(s)})}destroy(){this.clear(),this._queue=Di(this._queue)}get length(){return this._queue?this._queue.length:0}abort(e){const n=typeof e=="string"?e:e.id;this._queue.abort(n)}clear(){this._queue.clear(),this._keyToItem.clear(),this._tilesByScale.clear()}has(e){return typeof e=="string"?this._keyToItem.has(e):this._keyToItem.has(e.id)}pause(){this._queue.pause()}push(e){const n=e.key.id;if(this._queue.has(n))return this._queue.get(n);const r=this._queue.push(n),i=this.tileInfoView.getTileScale(e.key),s=fI(this._tilesByScale,i,()=>new Set),o=()=>{s.delete(e.key),s.size===0&&this._tilesByScale.delete(i),this._keyToItem.delete(n)};return s.add(e.key),this._keyToItem.set(n,e),r.then(o,o),r}reset(){this._queue.reset()}resume(){this._queue.resume()}_peek(e){if(!this.state)return e.values().next().value;const n=new Set;for(const o of e)n.add(this._keyToItem.get(o).key);const r=this.state.scale;let i,s=Number.POSITIVE_INFINITY;for(const[o,a]of this._tilesByScale)if(hpe(a,l=>n.has(l))){const l=Math.abs(o-r);l<s&&(i=a,s=l)}return this._getClosestTileKey(i,e).id}_getClosestTileKey(e,n){const r=this.tileInfoView,i=this.state.center;let s,o=Number.POSITIVE_INFINITY;for(const a of e)if(n.has(a.id)){r.getTileCoords(zre,a);const l=qO(zre,i);l<o&&(o=l,s=a)}return s}};x([E({constructOnly:!0})],Af.prototype,"concurrency",void 0),x([E({constructOnly:!0})],Af.prototype,"priority",void 0),x([E({constructOnly:!0})],Af.prototype,"process",void 0),x([E({constructOnly:!0})],Af.prototype,"scheduler",void 0),x([E()],Af.prototype,"state",void 0),x([E({constructOnly:!0})],Af.prototype,"tileInfoView",void 0),Af=x([ue("esri.views.2d.tiling.TileQueue")],Af);const f5t=Af;let Met=class{constructor(e,n,r){this.maxSize=e,this._tileInfoView=n,this._removedFunc=r,this._tilePerId=new Map,this._tileKeysPerLevel=[]}clear(){this._tilePerId.clear(),this._tileKeysPerLevel=[]}has(e){return this._tilePerId.has(e)}get(e){return this._tilePerId.get(e)}pop(e){const n=this._tilePerId.get(e);if(!n)return;const r=n.key.level,i=this._tileKeysPerLevel[r];Gre(this._tilePerId,e);for(let s=0;s<i.length;s++)if(i[s].id===e){i.splice(s,1);break}return n.visible=!0,n}add(e){e.visible=!1;const n=e.key,r=n.id;if(this._tilePerId.has(r))return;this._tilePerId.set(r,e);const i=n.level;this._tileKeysPerLevel[i]||(this._tileKeysPerLevel[i]=[]),this._tileKeysPerLevel[i].push(n)}prune(e,n,r){let i=this._tilePerId.size;if(i<=this.maxSize)return;let s=this._tileKeysPerLevel.length-1;for(;i>this.maxSize&&s>=0;)s!==e&&(i=this._pruneAroundCenterTile(i,n,r,s)),s--;i>this.maxSize&&(i=this._pruneAroundCenterTile(i,n,r,e))}_pruneAroundCenterTile(e,n,r,i){const s=this._tileKeysPerLevel[i];if(!s||s.length===0)return e;const{size:o,origin:a}=this._tileInfoView.tileInfo,l=r*o[0],c=r*o[1],u=[0,0],h=[0,0];for(s.sort((f,g)=>(u[0]=a.x+l*(f.col+.5),u[1]=a.y-c*(f.row+.5),h[0]=a.x+l*(g.col+.5),h[1]=a.y-c*(g.row+.5),qk(u,n)-qk(h,n)));s.length>0;){const f=s.pop();if(this._removeTile(f.id),--e===this.maxSize)break}return e}_removeTile(e){const n=this._tilePerId.get(e);this._removedFunc&&n&&this._removedFunc(n),Gre(this._tilePerId,e)}};function Gre(t,e){t.delete(e)}const V0=new xb(0,0,0,0),ff=new Map,WE=[],x$=[];let m5t=class{constructor(e){this._previousScale=Number.POSITIVE_INFINITY,this.cachePolicy="keep",this.coveragePolicy="closest",this.resampling=!0,this.tileIndex=new Map,this.tiles=[],this.buffer=192,this.acquireTile=e.acquireTile,this.releaseTile=e.releaseTile,this.tileInfoView=e.tileInfoView,e.resampling!=null&&(this.resampling=e.resampling),e.cachePolicy&&(this.cachePolicy=e.cachePolicy),e.coveragePolicy&&(this.coveragePolicy=e.coveragePolicy),e.buffer!=null&&(this.buffer=e.buffer),e.cacheSize&&(this._tileCache=new Met(e.cacheSize,this.tileInfoView,n=>{this.releaseTile(n)}))}destroy(){this.tileIndex.clear()}update(e){const{resampling:n,tileIndex:r}=this,{scale:i,center:s,resolution:o}=e.state,{minScale:a,maxScale:l}=this.tileInfoView,c=!e.stationary&&i>this._previousScale;if(this._previousScale=i,!n&&(i>a||i<l))return this.tiles.length=0,void this.clear();const u=this.tileInfoView.getTileCoverage(e.state,this.buffer,this.resampling,this.coveragePolicy);if(!u)return this.tiles.length=0,void this.clear();const{spans:h,lodInfo:f}=u,{level:g}=f;this.tiles.length=0,r.forEach(T=>T.visible=!0);let y=0,_=0;if(h.length>0)for(const{row:T,colFrom:A,colTo:I}of h)for(let P=A;P<=I;P++){y++;const R=V0.set(g,T,f.normalizeCol(P),f.getWorldForColumn(P)).id;let D=r.get(R);if(D)D.isReady?(ff.set(R,D),_++):c||this._addParentTile(R,ff);else{if(this._tileCache?.has(R)){if(D=this._tileCache.pop(R),this.tileIndex.set(R,D),D.isReady){ff.set(R,D),_++;continue}}else D=this.acquireTile(V0),this.tileIndex.set(R,D);c||this._addParentTile(R,ff)}}const b=_===y;for(const[T,A]of r){if(ff.has(T))continue;V0.set(T);const I=this.tileInfoView.intersects(u,V0),P=this.cachePolicy==="purge"?V0.level!==g:V0.level>g;!I||!c&&b?!P&&I||WE.push(A):A.isReady?P&&this.cachePolicy==="purge"&&this._hasReadyAncestor(V0,g)?WE.push(A):x$.push(A):P&&WE.push(A)}for(const T of x$)T.isReady&&ff.set(T.key.id,T);for(const T of WE)this._tileCache?this._tileCache.add(T):this.releaseTile(T),r.delete(T.key.id);for(const T of ff.values())this.tiles.push(T);for(const T of r.values())ff.has(T.key.id)||(T.visible=!1);this._tileCache?.prune(g,s,o),eH.pool.release(u),x$.length=0,WE.length=0,ff.clear()}clear(){const{tileIndex:e}=this;for(const n of e.values())this.releaseTile(n);e.clear()}refresh(e){for(const n of this.tileIndex.values())e(n);this._tileCache?.clear()}updateCacheSize(e){this._tileCache&&(this._tileCache.maxSize=e)}_addParentTile(e,n){let r=e,i=null;for(;r=this.tileInfoView.getTileParentId(r),r;)if(this.tileIndex.has(r)){if(i=this.tileIndex.get(r),i?.isReady){n.has(i.key.id)||n.set(i.key.id,i);break}}else if(this._tileCache?.has(r)&&(i=this._tileCache.pop(r),this.tileIndex.set(r,i),i?.isReady)){n.has(i.key.id)||n.set(i.key.id,i);break}}_hasReadyAncestor(e,n){const r=xl();this.tileInfoView.getTileBounds(r,e,!0);for(const i of this.tileIndex.values())if(i.isReady&&i.key.level>=n&&i.key.level<e.level){const s=xl();if(this.tileInfoView.getTileBounds(s,i.key,!0),Jze(s,r))return!0}return!1}};const Net={"area-measurement":null,dimension:null,"direct-line-measurement":null,"elevation-profile":()=>_e(()=>import("./ElevationProfileAnalysisView2D-T2dFV-Z_.js"),__vite__mapDeps([381,173,53,54,229,375,247,29,248,249,268,30,31,382,323,383,384,385,386,387,388,47,389,390,391,392,393,159,160,24,25,394,395,396,44,397,398,186,104,167,168,182,231,102,399,151,195,210,181])),"line-of-sight":null,slice:null,viewshed:null,"volume-measurement":null};function Oet(t){const e=Net[t.type];if(!e)throw new Xe("analysis-view-module-import-utils:analysis-not-supported",`Analysis "${t.type}" is not supported`);return e()}let Let=class{constructor(e,n={}){this.events=new _Fe,this._hasMajorPerformanceCaveat=!1,this._lastRenderFrameCounter=0,e!=null?(this._canvas=document.createElement("canvas"),this._canvas.setAttribute("style","width: 100%; height:100%; display:block; willChange:transform"),e.contains(this._canvas)||e.appendChild(this._canvas)):n.canvas!=null&&(this._canvas=n.canvas);const r={failIfMajorPerformanceCaveat:!0,alpha:!0,antialias:!1,depth:!0,stencil:!0,powerPreference:"high-performance"};let i=this._canvas.getContext("webgl2",r);i||(i=this._canvas.getContext("webgl2",{...r,failIfMajorPerformanceCaveat:!1}),this._hasMajorPerformanceCaveat=!0),this._gl=i,this._handles=fv([ob(this._canvas,"webglcontextlost",s=>this.events.emit("webgl-context-lost",s))])}destroy(){this._canvas.remove(),this._canvas=null,this._handles.remove(),this._gl=null}get gl(){return this._gl}get canvas(){return this._canvas}render(e,n){if(this._hasMajorPerformanceCaveat||ye("esri-force-performance-mode")){if(++this._lastRenderFrameCounter>=ye("esri-performance-mode-frames-between-render")&&(n(),this._lastRenderViewState=e.state.clone(),this._lastRenderFrameCounter=0),this._lastRenderViewState){const[r,i,s,o,a,l]=this._computeViewTransform(this._lastRenderViewState,e.state);this._canvas.style.transform=`matrix(${r}, ${i}, ${s}, ${o}, ${a}, ${l})`}}else n()}resize(e){const n=this._canvas,r=n.style,{state:{size:i},pixelRatio:s}=e,o=i[0],a=i[1],l=Math.round(o*s),c=Math.round(a*s);n.width===l&&n.height===c||(n.width=l,n.height=c),r.width=o+"px",r.height=a+"px"}_computeViewTransform(e,n){const[r,i]=e.center,[s,o]=n.center,[a,l]=e.toScreen([0,0],s,o),[c,u]=e.toScreen([0,0],r,i),h=c-a,f=u-l,g=e.scale/n.scale,y=n.rotation-e.rotation,_=Ad();return bve(_),sL(_,_,[g,g]),$I(_,_,kI(y)),O2(_,_,[h,f]),_}};function Det(t,e,n,r,i){p_e(t,e,n||0,r||t.length-1,i||jet)}function p_e(t,e,n,r,i){for(;r>n;){if(r-n>600){var s=r-n+1,o=e-n+1,a=Math.log(s),l=.5*Math.exp(2*a/3),c=.5*Math.sqrt(a*l*(s-l)/s)*(o-s/2<0?-1:1);p_e(t,e,Math.max(n,Math.floor(e-o*l/s+c)),Math.min(r,Math.floor(e+(s-o)*l/s+c)),i)}var u=t[e],h=n,f=r;for(HE(t,n,e),i(t[r],u)>0&&HE(t,n,r);h<f;){for(HE(t,h,f),h++,f--;i(t[h],u)<0;)h++;for(;i(t[f],u)>0;)f--}i(t[n],u)===0?HE(t,n,f):HE(t,++f,r),f<=e&&(n=f+1),e<=f&&(r=f-1)}}function HE(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function jet(t,e){return t<e?-1:t>e?1:0}function TN(t,e){if(!(this instanceof TN))return new TN(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&(typeof e=="function"?this.toBBox=e:this._initFormat(e)),this.clear()}function $et(t,e,n){if(!n)return e.indexOf(t);for(var r=0;r<e.length;r++)if(n(t,e[r]))return r;return-1}function C_(t,e){VS(t,0,t.children.length,e,t)}function VS(t,e,n,r,i){i||(i=dx(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var s,o=e;o<n;o++)s=t.children[o],zS(i,t.leaf?r(s):s);return i}function zS(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function Ure(t,e){return t.minX-e.minX}function Bre(t,e){return t.minY-e.minY}function w$(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function hR(t){return t.maxX-t.minX+(t.maxY-t.minY)}function Fet(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}function Vet(t,e){var n=Math.max(t.minX,e.minX),r=Math.max(t.minY,e.minY),i=Math.min(t.maxX,e.maxX),s=Math.min(t.maxY,e.maxY);return Math.max(0,i-n)*Math.max(0,s-r)}function b$(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function dR(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function dx(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Wre(t,e,n,r,i){for(var s,o=[e,n];o.length;)(n=o.pop())-(e=o.pop())<=r||(s=e+Math.ceil((n-e)/r/2)*r,Det(t,s,e,n,i),o.push(e,s,s,n))}TN.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,n=[],r=this.toBBox;if(!dR(t,e))return n;for(var i,s,o,a,l=[];e;){for(i=0,s=e.children.length;i<s;i++)o=e.children[i],dR(t,a=e.leaf?r(o):o)&&(e.leaf?n.push(o):b$(t,a)?this._all(o,n):l.push(o));e=l.pop()}return n},collides:function(t){var e=this.data,n=this.toBBox;if(!dR(t,e))return!1;for(var r,i,s,o,a=[];e;){for(r=0,i=e.children.length;r<i;r++)if(s=e.children[r],dR(t,o=e.leaf?n(s):s)){if(e.leaf||b$(t,o))return!0;a.push(s)}e=a.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,n=t.length;e<n;e++)this.insert(t[e]);return this}var r=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var i=this.data;this.data=r,r=i}this._insert(r,this.data.height-r.height-1,!0)}else this.data=r;return this},insert:function(t){return t!=null&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=dx([]),this},remove:function(t,e){if(t==null)return this;for(var n,r,i,s,o=this.data,a=this.toBBox(t),l=[],c=[];o||l.length;){if(o||(o=l.pop(),r=l[l.length-1],n=c.pop(),s=!0),o.leaf&&(i=$et(t,o.children,e))!==-1)return o.children.splice(i,1),l.push(o),this._condense(l),this;s||o.leaf||!b$(o,a)?r?(n++,o=r.children[n],s=!1):o=null:(l.push(o),c.push(n),n=0,r=o,o=o.children[0])}return this},toBBox:function(t){return t},compareMinX:Ure,compareMinY:Bre,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},_build:function(t,e,n,r){var i,s=n-e+1,o=this._maxEntries;if(s<=o)return C_(i=dx(t.slice(e,n+1)),this.toBBox),i;r||(r=Math.ceil(Math.log(s)/Math.log(o)),o=Math.ceil(s/Math.pow(o,r-1))),(i=dx([])).leaf=!1,i.height=r;var a,l,c,u,h=Math.ceil(s/o),f=h*Math.ceil(Math.sqrt(o));for(Wre(t,e,n,f,this.compareMinX),a=e;a<=n;a+=f)for(Wre(t,a,c=Math.min(a+f-1,n),h,this.compareMinY),l=a;l<=c;l+=h)u=Math.min(l+h-1,c),i.children.push(this._build(t,l,u,r-1));return C_(i,this.toBBox),i},_chooseSubtree:function(t,e,n,r){for(var i,s,o,a,l,c,u,h;r.push(e),!e.leaf&&r.length-1!==n;){for(u=h=1/0,i=0,s=e.children.length;i<s;i++)l=w$(o=e.children[i]),(c=Fet(t,o)-l)<h?(h=c,u=l<u?l:u,a=o):c===h&&l<u&&(u=l,a=o);e=a||e.children[0]}return e},_insert:function(t,e,n){var r=this.toBBox,i=n?t:r(t),s=[],o=this._chooseSubtree(i,this.data,e,s);for(o.children.push(t),zS(o,i);e>=0&&s[e].children.length>this._maxEntries;)this._split(s,e),e--;this._adjustParentBBoxes(i,s,e)},_split:function(t,e){var n=t[e],r=n.children.length,i=this._minEntries;this._chooseSplitAxis(n,i,r);var s=this._chooseSplitIndex(n,i,r),o=dx(n.children.splice(s,n.children.length-s));o.height=n.height,o.leaf=n.leaf,C_(n,this.toBBox),C_(o,this.toBBox),e?t[e-1].children.push(o):this._splitRoot(n,o)},_splitRoot:function(t,e){this.data=dx([t,e]),this.data.height=t.height+1,this.data.leaf=!1,C_(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,n){var r,i,s,o,a,l,c,u;for(l=c=1/0,r=e;r<=n-e;r++)o=Vet(i=VS(t,0,r,this.toBBox),s=VS(t,r,n,this.toBBox)),a=w$(i)+w$(s),o<l?(l=o,u=r,c=a<c?a:c):o===l&&a<c&&(c=a,u=r);return u},_chooseSplitAxis:function(t,e,n){var r=t.leaf?this.compareMinX:Ure,i=t.leaf?this.compareMinY:Bre;this._allDistMargin(t,e,n,r)<this._allDistMargin(t,e,n,i)&&t.children.sort(r)},_allDistMargin:function(t,e,n,r){t.children.sort(r);var i,s,o=this.toBBox,a=VS(t,0,e,o),l=VS(t,n-e,n,o),c=hR(a)+hR(l);for(i=e;i<n-e;i++)s=t.children[i],zS(a,t.leaf?o(s):s),c+=hR(a);for(i=n-e-1;i>=e;i--)s=t.children[i],zS(l,t.leaf?o(s):s),c+=hR(l);return c},_adjustParentBBoxes:function(t,e,n){for(var r=n;r>=0;r--)zS(e[r],t)},_condense:function(t){for(var e,n=t.length-1;n>=0;n--)t[n].children.length===0?n>0?(e=t[n-1].children).splice(e.indexOf(t[n]),1):this.clear():C_(t[n],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}};function zet(t,{timeZone:e,timeExtent:n}){return{$view:{scale:t,timeZone:e,timeProperties:{currentStart:n?.start,currentEnd:n?.end}}}}let Hre=class m_e{constructor(e,n){this.key=new xb(0,0,0,0),this.bounds=xl(),this.objectIds=new Set,this.key.set(n);const r=e.getLODInfoAt(this.key);this.tileInfoView=e,this.tileInfoView.getTileBounds(this.bounds,this.key,!0),this.resolution=r.resolution,this.level=r.level,this.scale=r.scale,this.minScale=e.zoomToScale(r.level-1),this.maxScale=e.zoomToScale(r.level+1)}get lod(){return this.tileInfoView.getLODInfoAt(this.key)}get id(){return this.key.id}get extent(){return Yze(this.bounds,this.tileInfoView.tileInfo.spatialReference)}get transform(){return{originPosition:"upperLeft",scale:[this.resolution,this.resolution],translate:[this.bounds[0],this.bounds[3]]}}createArcadeEvaluationOptions(e){return zet(this.scale,e)}createChildTiles(){const e=this.key.getChildKeys(),n=Na.acquire();for(let r=0;r<e.length;r++)n[r]=new m_e(this.tileInfoView,e[r]);return n}getQuantizationParameters(){return $m.fromJSON({mode:"view",originPosition:"upperLeft",tolerance:this.resolution,extent:{xmin:this.bounds[0],ymin:this.bounds[1],xmax:this.bounds[2],ymax:this.bounds[3],spatialReference:this.tileInfoView.tileInfo.spatialReference}})}};const z0={added:[],removed:[]},E$=new Set,Get=new xb(0,0,0,0);function Uet(t,e){const n=za(e);if(!n)return null;const[r,i]=n.valid;return t[2]>i?[xl([t[0],t[1],i,t[3]]),xl([r,t[1],r+t[2]-i,t[3]])]:t[0]<r?[xl([r,t[1],t[2],t[3]]),xl([i-(r-t[0]),t[1],i,t[3]])]:null}let Bet=class extends Cpe{constructor(e){super(),this._tiles=new Map,this._index=TN(9,ye("esri-csp-restrictions")?n=>({minX:n.bounds[0],minY:n.bounds[1],maxX:n.bounds[2],maxY:n.bounds[3]}):[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]),this.tiles=[],this.tileScheme=e}destroy(){super.destroy(),this.clear()}clear(){this.tiles.length=0,this._tiles.clear(),this._index.clear()}has(e){return this._tiles.has(e)}get(e){return this._tiles.get(e)}getIntersectingTiles(e){if(!e||oW(e)===0||aW(e)===0)return[];const n=Uet(e,this.tileScheme.spatialReference);return n!=null?[...new Set([...this.boundsIntersections(n[0]),...this.boundsIntersections(n[1])])]:this.boundsIntersections(e)}boundsIntersections(e){return this._index.search({minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]})}updateTiles(e){const n={added:[],removed:[]};for(const r of e.added)if(!this.has(r)){const i=new Hre(this.tileScheme,r);this._tiles.set(r,i),this._index.insert(i),n.added.push(i)}for(const r of e.removed)if(this.has(r)){const i=this.get(r);this._tiles.delete(r),this._index.remove(i),n.removed.push(i)}this.tiles.length=0,this._tiles.forEach(r=>this.tiles.push(r)),(n.added.length||n.removed.length)&&this.emit("update",n)}setViewState(e){const n=this.tileScheme.getTileCoverage(e,0);if(!n)return;const{spans:r,lodInfo:i}=n,{level:s}=i;if(r.length>0)for(const{row:o,colFrom:a,colTo:l}of r)for(let c=a;c<=l;c++){const u=Get.set(s,o,i.normalizeCol(c),i.getWorldForColumn(c)).id;if(E$.add(u),!this.has(u)){const h=new Hre(this.tileScheme,u);this._tiles.set(u,h),this._index.insert(h),this.tiles.push(h),z0.added.push(h)}}for(let o=this.tiles.length-1;o>=0;o--){const a=this.tiles[o];E$.has(a.id)||(this._tiles.delete(a.id),this.tiles.splice(o,1),this._index.remove(a),z0.removed.push(a))}(z0.added.length||z0.removed.length)&&this.emit("update",z0),eH.pool.release(n),E$.clear(),z0.added.length=0,z0.removed.length=0}};const _5t=1e-30,qre=512,fR=16777216,x5t=8,w5t=29,b5t=24,E5t=4,S5t=0,T5t=0,k5t=0,A5t=1,I5t=2,P5t=3,C5t=4,R5t=5,M5t=6,N5t=12,O5t=13,L5t=5,Wet=6,D5t=5,j5t=6,g_e=6,Het=1<<g_e,$5t=Het<<1,F5t=1.05,V5t=3,z5t=1,G5t=3,U5t=3,B5t=5,W5t=6,H5t=1.15,qet=4,q5t=128,Ket=256,K5t=Ket-2*qet,Y5t=2,X5t=128,Z5t=1,J5t=10,Q5t=1024,eOt=128,tOt=4,nOt=1,rOt=1<<20,iOt=.75,sOt=10,oOt=.75,aOt=256,lOt=32,cOt=512,uOt=0,hOt=1,Yet=1,dOt=[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1],fOt=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],qE=256,Xet=()=>kt.getLogger("esri.views.webgl.checkWebGLError");function y_e(t){switch(t.getError()){case t.NO_ERROR:return null;case t.INVALID_ENUM:return"Invalid Enum. An unacceptable value has been specified for an enumerated argument.";case t.INVALID_VALUE:return"Invalid Value. A numeric argument is out of range.";case t.INVALID_OPERATION:return"Invalid Operation. The specified command is not allowed for the current state.";case t.INVALID_FRAMEBUFFER_OPERATION:return"Invalid Framebuffer operation. The currently bound framebuffer is not framebuffer complete when trying to render to or to read from it.";case t.OUT_OF_MEMORY:return"Out of memory. Not enough memory is left to execute the command.";case t.CONTEXT_LOST_WEBGL:return"WebGL context has been lost";default:return"Unknown error"}}const v_e=!!ye("enable-feature:webgl-debug");function __e(){return v_e}function pOt(){return v_e}function G0(t,e=__e()){if(e){const n=y_e(t);if(n){const r=new Error().stack;Xet().error(new Xe("webgl-error","WebGL error occurred",{message:n,stack:r}))}}}const mOt={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},U0={BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,HALF_FLOAT:5131},Ut={RGBA4:32854,R16F:33325,RG16F:33327,RGB32F:34837,RGBA16F:34842,R32F:33326,RG32F:33328,RGBA32F:34836,R11F_G11F_B10F:35898,RGB8:32849,RGBA8:32856,RGB5_A1:32855,R8:33321,RG8:33323,R8I:33329,R8UI:33330,R16I:33331,R16UI:33332,R32I:33333,R32UI:33334,RG8I:33335,RG8UI:33336,RG16I:33337,RG16UI:33338,RG32I:33339,RG32UI:33340,RGB16F:34843,RGB9_E5:35901,SRGB8:35905,SRGB8_ALPHA8:35907,RGB565:36194,RGBA32UI:36208,RGB32UI:36209,RGBA16UI:36214,RGB16UI:36215,RGBA8UI:36220,RGB8UI:36221,RGBA32I:36226,RGB32I:36227,RGBA16I:36232,RGB16I:36233,RGBA8I:36238,RGB8I:36239,R8_SNORM:36756,RG8_SNORM:36757,RGB8_SNORM:36758,RGBA8_SNORM:36759,RGB10_A2:32857,RGB10_A2UI:36975},Zet=Object.values(Ut),kN={DEPTH24_STENCIL8:35056,DEPTH32F_STENCIL8:36013},DT={DEPTH_COMPONENT16:33189,DEPTH_COMPONENT24:33190,DEPTH_COMPONENT32F:36012},YV={FLOAT:U0.FLOAT,UNSIGNED_BYTE:U0.UNSIGNED_BYTE,UNSIGNED_INT_24_8:34042,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,BYTE:U0.BYTE,UNSIGNED_SHORT:U0.UNSIGNED_SHORT,SHORT:U0.SHORT,UNSIGNED_INT:U0.UNSIGNED_INT,INT:U0.INT,HALF_FLOAT:5131,UNSIGNED_INT_2_10_10_10_REV:33640,UNSIGNED_INT_10F_11F_11F_REV:35899,UNSIGNED_INT_5_9_9_9_REV:35902,FLOAT_32_UNSIGNED_INT_24_8_REV:36269},gOt=33984,Kre={Texture:0,TileTexture:1,BufferObject:2,VertexArrayObject:3,Shader:4,Program:5,FramebufferObject:6,Renderbuffer:7,TransformFeedback:8,Sync:9,UNCOUNTED:10,LinesOfCode:10,Uniform:11,COUNT:12},yOt=1029,vOt=0,_Ot=36064,xOt=36065,wOt=36066,bOt=36067,EOt=33306,SOt=36096,TOt=36128,Zo={COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_SRGB8_ETC2:37493,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37494,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37495,COMPRESSED_RGBA8_ETC2_EAC:37496,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37497};function kOt(t,e,n,r=0){const i=t.gl;t.bindBuffer(n);for(const s of n.layout){const o=e.get(s.name);if(o==null){console.warn(`There is no location for vertex attribute '${s.name}' defined.`);continue}const a=r*s.stride;if(s.count<=4)i.vertexAttribPointer(o,s.count,s.type,s.normalized,s.stride,s.offset+a),i.enableVertexAttribArray(o),s.divisor>0&&i.vertexAttribDivisor(o,s.divisor);else if(s.count===9)for(let l=0;l<3;l++)i.vertexAttribPointer(o+l,3,s.type,s.normalized,s.stride,s.offset+12*l+a),i.enableVertexAttribArray(o+l),s.divisor>0&&i.vertexAttribDivisor(o+l,s.divisor);else if(s.count===16)for(let l=0;l<4;l++)i.vertexAttribPointer(o+l,4,s.type,s.normalized,s.stride,s.offset+16*l+a),i.enableVertexAttribArray(o+l),s.divisor>0&&i.vertexAttribDivisor(o+l,s.divisor);else console.error("Unsupported vertex attribute element count: "+s.count);if(__e()){const l=y_e(t.gl);l&&console.error(`Unable to bind vertex attribute "${s.name}" with baseInstanceOffset ${a}:`,l,s)}}}function AOt(t){switch(t){case 6406:case 6409:case 6403:case 36244:case 6402:case 34041:return 1;case 6410:case 33319:case 33320:return 2;case 6407:case 36248:return 3;case 6408:case 36249:return 4}return 0}function Jet(t){switch(t){case 6406:case 6409:case 6403:case 36244:case Ut.R8:case Ut.R8I:case Ut.R8UI:case Ut.R8_SNORM:case 36168:return 1;case 6410:case 33319:case 33320:case Ut.RGBA4:case Ut.R16F:case Ut.R16I:case Ut.R16UI:case Ut.RG8:case Ut.RG8I:case Ut.RG8UI:case Ut.RG8_SNORM:case Ut.RGB565:case Ut.RGB5_A1:case DT.DEPTH_COMPONENT16:return 2;case 6407:case 36248:case Ut.RGB8:case Ut.RGB8I:case Ut.RGB8UI:case Ut.RGB8_SNORM:case Ut.SRGB8:case DT.DEPTH_COMPONENT24:return 3;case 6408:case 36249:case Ut.RGBA8:case Ut.R32F:case Ut.R11F_G11F_B10F:case Ut.RG16F:case Ut.R32I:case Ut.R32UI:case Ut.RG16I:case Ut.RG16UI:case Ut.RGBA8I:case Ut.RGBA8UI:case Ut.RGBA8_SNORM:case Ut.SRGB8_ALPHA8:case Ut.RGB9_E5:case Ut.RGB10_A2UI:case Ut.RGB10_A2:case DT.DEPTH_COMPONENT32F:case kN.DEPTH24_STENCIL8:return 4;case kN.DEPTH32F_STENCIL8:return 5;case Ut.RGB16F:case Ut.RGB16I:case Ut.RGB16UI:return 6;case Ut.RG32F:case Ut.RG32I:case Ut.RG32UI:case Ut.RGBA16F:case Ut.RGBA16I:case Ut.RGBA16UI:return 8;case Ut.RGB32F:case Ut.RGB32I:case Ut.RGB32UI:return 12;case Ut.RGBA32F:case Ut.RGBA32I:case Ut.RGBA32UI:return 16;case Zo.COMPRESSED_RGB_S3TC_DXT1_EXT:case Zo.COMPRESSED_RGBA_S3TC_DXT1_EXT:return .5;case Zo.COMPRESSED_RGBA_S3TC_DXT3_EXT:case Zo.COMPRESSED_RGBA_S3TC_DXT5_EXT:return 1;case Zo.COMPRESSED_R11_EAC:case Zo.COMPRESSED_SIGNED_R11_EAC:case Zo.COMPRESSED_RGB8_ETC2:case Zo.COMPRESSED_SRGB8_ETC2:case Zo.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:case Zo.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:return .5;case Zo.COMPRESSED_RG11_EAC:case Zo.COMPRESSED_SIGNED_RG11_EAC:case Zo.COMPRESSED_RGBA8_ETC2_EAC:case Zo.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:return 1}return 0}let x_e=class{constructor(e=0,n=e){this.width=e,this.height=n,this.type=0,this.target=3553,this.pixelFormat=6408,this.dataType=YV.UNSIGNED_BYTE,this.samplingMode=9729,this.wrapMode=10497,this.maxAnisotropy=1,this.flipped=!1,this.hasMipmap=!1,this.isOpaque=!1,this.unpackAlignment=4,this.preMultiplyAlpha=!1,this.compareEnabled=!1,this.linearFilterDepth=!1,this.depth=1,this.isImmutable=!1}};function Qet(t){return t.width<=0||t.height<=0||t.depth<=0?0:Math.round(t.width*t.height*t.depth*(t.hasMipmap?4/3:1)*(t.internalFormat==null?4:Jet(t.internalFormat))*(t.target===34067?6:1))}const KE=()=>kt.getLogger("esri/views/webgl/textureUtils");function YE(t){const{width:e,height:n,depth:r}=t;(e!=null&&e<0||n!=null&&n<0||r!=null&&r<0)&&KE().error("Negative dimension parameters are not allowed!");const{internalFormat:i}=t;if(i&&(w_e(i)||b_e(i))){const{linearFilterDepth:s,compareEnabled:o,samplingMode:a,hasMipmap:l}=t;l&&KE().error("Depth textures cannot have mipmaps"),s?a!==9729&&a!==9728&&KE().error("Depth textures cannot sample mipmaps"):(a!==9728&&KE().error("Depth textures without filtering must use NEAREST filtering"),o&&KE().error("Depth textures without filtering cannot use compare function"))}}function ett(t){return Zet.includes(t)}function w_e(t){return bO(DT,t)}function b_e(t){return bO(kN,t)}function ttt(t){return t!=null&&bO(Zo,t)}function fx(t){return t!=null&&"type"in t&&t.type==="compressed"}function ntt(t){return t!=null&&"byteLength"in t}function Yre(t){return t!=null&&!fx(t)&&!ntt(t)}function R_(t){return t===32879||t===35866}function Xre(t,e,n,r=1){let i=Math.max(e,n);return t===32879&&(i=Math.max(i,r)),Math.floor(Math.log2(i))+1}function pR(t){if(t.internalFormat!=null)return t.internalFormat;switch(t.dataType){case YV.FLOAT:switch(t.pixelFormat){case 6408:return Ut.RGBA32F;case 6407:return Ut.RGB32F;default:throw new Xe("texture:unknown-format","Unable to derive format")}case YV.UNSIGNED_BYTE:switch(t.pixelFormat){case 6408:return Ut.RGBA8;case 6407:return Ut.RGB8}}const{pixelFormat:e}=t;return t.internalFormat=e===34041?kN.DEPTH24_STENCIL8:e===6402?DT.DEPTH_COMPONENT24:e,t.internalFormat}function rtt(t){let e="width"in t?t.width:t.codedWidth,n="height"in t?t.height:t.codedHeight;return t instanceof HTMLVideoElement&&(e=t.videoWidth,n=t.videoHeight),{width:e,height:n,depth:1}}let itt=class E_e extends x_e{constructor(e,n){switch(super(),this.context=e,Object.assign(this,n),this.internalFormat){case Ut.R16F:case Ut.R32F:case Ut.R8_SNORM:case Ut.R8:this.pixelFormat=6403;break;case Ut.R8I:case Ut.R8UI:case Ut.R16I:case Ut.R16UI:case Ut.R32I:case Ut.R32UI:this.pixelFormat=36244}}static validate(e,n){return new E_e(e,n)}};const stt=!!ye("esri-tests-disable-gpu-memory-measurements"),pf=()=>kt.getLogger("esri/views/webgl/Texture");var ws;let ott=(ws=class{constructor(e,n=null,r=null){if(this.type=1,this._glName=null,this._samplingModeDirty=!1,this._wrapModeDirty=!1,this._shadowFilterDirty=!1,this._wasImmutablyAllocated=!1,"context"in e)this._descriptor=e,r=n;else{const i=itt.validate(e,n);if(!i)throw new Xe("texture:invalid-descriptor","Texture descriptor invalid");this._descriptor=i}this._descriptor.target===34067?this._setDataCubeMap(r):this.setData(r)}get glName(){return this._glName}get descriptor(){return this._descriptor}get usedMemory(){return stt?0:Qet(this._descriptor)}get isDirty(){return this._samplingModeDirty||this._wrapModeDirty||this._shadowFilterDirty}get hasWebGLTextureObject(){return!!this._glName}dispose(){this.abortCompression(),this.hasWebGLTextureObject&&this._descriptor.context?.gl&&(this._descriptor.context.instanceCounter.decrement(Kre.Texture,this),this._descriptor.context.unbindTexture(this),this._descriptor.context.gl.deleteTexture(this._glName),this._glName=null,this._descriptor=null)}release(){this.dispose()}[Symbol.dispose](){this.dispose()}resize(e,n){const r=this._descriptor;if(r.width!==e||r.height!==n){if(this._wasImmutablyAllocated)throw new Xe("texture:immutable-resize","Immutable textures can't be resized!");r.width=e,r.height=n,this._descriptor.target===34067?this._setDataCubeMap(null):this.setData(null)}}enableCompression(e){this._descriptor.compress=e}disableCompression(){this._descriptor.compress=void 0}setData(e){this.abortCompression(),!fx(e)&&this._descriptor.internalFormat&&bO(Zo,this._descriptor.internalFormat)&&(this._descriptor.internalFormat=void 0),this._setData(e),!fx(e)&&this._descriptor.compress&&this._compressOnWorker(e)}updateData(e,n,r,i,s,o,a=0){o||pf().error("An attempt to use uninitialized data!"),this.hasWebGLTextureObject||pf().error("An attempt to update uninitialized texture!");const l=this._descriptor;l.internalFormat=pR(l);const{context:c,pixelFormat:u,dataType:h,target:f,isImmutable:g}=l;if(g&&!this._wasImmutablyAllocated)throw new Xe("texture:uninitialized","Cannot update immutable texture before allocation!");const y=c.bindTexture(this,ws.TEXTURE_UNIT_FOR_UPDATES,!0);(n<0||r<0||n+i>l.width||r+s>l.height)&&pf().error("An attempt to update out of bounds of the texture!"),this._configurePixelStorage();const{gl:_}=c;a&&(i&&s||pf().warn("Must pass width and height if `UNPACK_SKIP_ROWS` is used"),_.pixelStorei(_.UNPACK_SKIP_ROWS,a)),Yre(o)?_.texSubImage2D(f,e,n,r,i,s,u,h,o):fx(o)?_.compressedTexSubImage2D(f,e,n,r,i,s,l.internalFormat,o.levels[e]):_.texSubImage2D(f,e,n,r,i,s,u,h,o),a&&_.pixelStorei(_.UNPACK_SKIP_ROWS,0),c.bindTexture(y,ws.TEXTURE_UNIT_FOR_UPDATES)}updateData3D(e,n,r,i,s,o,a,l){l||pf().error("An attempt to use uninitialized data!"),this.hasWebGLTextureObject||pf().error("An attempt to update an uninitialized texture!");const c=this._descriptor;c.internalFormat=pR(c);const{context:u,pixelFormat:h,dataType:f,isImmutable:g,target:y}=c;if(g&&!this._wasImmutablyAllocated)throw new Xe("texture:uninitialized","Cannot update immutable texture before allocation!");R_(y)||pf().warn("Attempting to set 3D texture data on a non-3D texture");const _=u.bindTexture(this,ws.TEXTURE_UNIT_FOR_UPDATES);u.setActiveTexture(ws.TEXTURE_UNIT_FOR_UPDATES),(n<0||r<0||i<0||n+s>c.width||r+o>c.height||i+a>c.depth)&&pf().error("An attempt to update out of bounds of the texture!"),this._configurePixelStorage();const{gl:b}=u;if(fx(l))l=l.levels[e],b.compressedTexSubImage3D(y,e,n,r,i,s,o,a,c.internalFormat,l);else{const T=l;b.texSubImage3D(y,e,n,r,i,s,o,a,h,f,T)}u.bindTexture(_,ws.TEXTURE_UNIT_FOR_UPDATES)}generateMipmap(){const e=this._descriptor;if(e.width===0||e.height===0)return;if(!e.hasMipmap){if(this._wasImmutablyAllocated)throw new Xe("texture:immutable-change","Cannot add mipmaps to immutable texture after allocation");e.hasMipmap=!0,this._samplingModeDirty=!0,YE(e)}e.samplingMode===9729?(this._samplingModeDirty=!0,e.samplingMode=9985):e.samplingMode===9728&&(this._samplingModeDirty=!0,e.samplingMode=9984);const n=this._descriptor.context.bindTexture(this,ws.TEXTURE_UNIT_FOR_UPDATES);this._descriptor.context.setActiveTexture(ws.TEXTURE_UNIT_FOR_UPDATES),this._descriptor.context.gl.generateMipmap(e.target),this._descriptor.context.bindTexture(n,ws.TEXTURE_UNIT_FOR_UPDATES)}clearMipmap(){const e=this._descriptor;if(e.hasMipmap){if(this._wasImmutablyAllocated)throw new Xe("texture:immutable-change","Cannot delete mipmaps to immutable texture after allocation");e.hasMipmap=!1,this._samplingModeDirty=!0,YE(e)}e.samplingMode===9985?(this._samplingModeDirty=!0,e.samplingMode=9729):e.samplingMode===9984&&(this._samplingModeDirty=!0,e.samplingMode=9728)}setSamplingMode(e){e!==this._descriptor.samplingMode&&(this._descriptor.samplingMode=e,this._samplingModeDirty=!0)}setWrapMode(e){e!==this._descriptor.wrapMode&&(this._descriptor.wrapMode=e,YE(this._descriptor),this._wrapModeDirty=!0)}setShadowFiltering(e){e!==this._descriptor.linearFilterDepth&&(this._descriptor.linearFilterDepth=this._descriptor.compareEnabled=e,this.setSamplingMode(e?9729:9728),YE(this._descriptor),this._shadowFilterDirty=!0)}applyChanges(){this._samplingModeDirty&&(this._applySamplingMode(),this._samplingModeDirty=!1),this._wrapModeDirty&&(this._applyWrapMode(),this._wrapModeDirty=!1),this._shadowFilterDirty&&(this._applyShadowMode(),this._shadowFilterDirty=!1)}abortCompression(){this._compressionAbortController=$1(this._compressionAbortController)}_setData(e,n){const r=this._descriptor,i=r.context?.gl;if(!i)return;G0(i),this.hasWebGLTextureObject||(this._glName=i.createTexture(),r.context.instanceCounter.increment(Kre.Texture,this)),YE(r);const s=r.context.bindTexture(this,ws.TEXTURE_UNIT_FOR_UPDATES);r.context.setActiveTexture(ws.TEXTURE_UNIT_FOR_UPDATES),this._configurePixelStorage(),G0(i);const o=n??r.target,a=R_(o);if(Yre(e))this._setDataFromTexImageSource(e,o);else{const{width:l,height:c,depth:u}=r;if(l==null||c==null)throw new Xe("texture:missing-size","Width and height must be specified!");if(a&&u==null)throw new Xe("texture:missing-depth","Depth must be specified!");if(r.internalFormat=pR(r),r.isImmutable&&!this._wasImmutablyAllocated&&this._texStorage(o,r.internalFormat,r.hasMipmap,l,c,u),fx(e)){if(!ttt(r.internalFormat))throw new Xe("texture:format-mismatch","Attempting to use compressed data with an uncompressed format!");this._setDataFromCompressedSource(e,r.internalFormat,o)}else this._texImage(o,0,r.internalFormat,l,c,u,e),G0(i),r.hasMipmap&&this.generateMipmap()}this._applySamplingMode(),this._applyWrapMode(),this._applyAnisotropicFilteringParameters(),this._applyShadowMode(),G0(i),r.context.bindTexture(s,ws.TEXTURE_UNIT_FOR_UPDATES)}_setDataCubeMap(e=null){for(let n=34069;n<=34074;n++)this._setData(e,n)}_configurePixelStorage(){const e=this._descriptor.context.gl,{unpackAlignment:n,flipped:r,preMultiplyAlpha:i}=this._descriptor;e.pixelStorei(e.UNPACK_ALIGNMENT,n),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,r?1:0),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i?1:0)}_setDataFromTexImageSource(e,n){const{gl:r}=this._descriptor.context,i=this._descriptor;i.internalFormat=pR(i);const s=R_(n),{width:o,height:a,depth:l}=rtt(e);i.width&&i.height,i.width||(i.width=o),i.height||(i.height=a),s&&i.depth,s&&(i.depth=l),i.isImmutable&&!this._wasImmutablyAllocated&&this._texStorage(n,i.internalFormat,i.hasMipmap,o,a,l),this._texImage(n,0,i.internalFormat,o,a,l,e),G0(r),i.hasMipmap&&(this.generateMipmap(),G0(r))}_setDataFromCompressedSource(e,n,r){const i=this._descriptor,{width:s,height:o,depth:a}=i,l=e.levels,c=Xre(r,s,o,a),u=Math.min(c,l.length)-1;this._descriptor.context.gl.texParameteri(i.target,33085,u),this._forEachMipmapLevel((h,f,g,y)=>{const _=l[Math.min(h,l.length-1)];this._compressedTexImage(r,h,n,f,g,y,_)},u)}_texStorage(e,n,r,i,s,o){const{gl:a}=this._descriptor.context;if(!ett(n)&&!w_e(n)&&!b_e(n))throw new Xe("texture:missing-format","Immutable textures must have a sized internal format");if(!this._descriptor.isImmutable)return;const l=r?Xre(e,i,s,o):1;if(R_(e)){if(o==null)throw new Xe("texture:missing-depth","Missing depth dimension for 3D texture upload");a.texStorage3D(e,l,n,i,s,o)}else a.texStorage2D(e,l,n,i,s);this._wasImmutablyAllocated=!0}_texImage(e,n,r,i,s,o,a){const l=this._descriptor.context.gl,c=R_(e),{isImmutable:u,pixelFormat:h,dataType:f}=this._descriptor;if(u){if(a!=null){const g=a;if(c){if(o==null)throw new Xe("texture:missing-depth","Missing depth dimension for 3D texture upload");l.texSubImage3D(e,n,0,0,0,i,s,o,h,f,g)}else l.texSubImage2D(e,n,0,0,i,s,h,f,g)}}else{const g=a;if(c){if(o==null)throw new Xe("texture:missing-depth","Missing depth dimension for 3D texture upload");l.texImage3D(e,n,r,i,s,o,0,h,f,g)}else l.texImage2D(e,n,r,i,s,0,h,f,g)}}_compressedTexImage(e,n,r,i,s,o,a){const l=this._descriptor.context.gl,c=R_(e);if(this._descriptor.isImmutable){if(a!=null)if(c){if(o==null)throw new Xe("texture:missing-depth","Missing depth dimension for 3D texture upload");l.compressedTexSubImage3D(e,n,0,0,0,i,s,o,r,a)}else l.compressedTexSubImage2D(e,n,0,0,i,s,r,a)}else if(c){if(o==null)throw new Xe("texture:missing-depth","Missing depth dimension for 3D texture upload");l.compressedTexImage3D(e,n,r,i,s,o,0,a)}else l.compressedTexImage2D(e,n,r,i,s,0,a)}async _compressOnWorker(e){const{width:n,height:r,context:i,flipped:s,preMultiplyAlpha:o,hasMipmap:a}=this._descriptor,l=this._descriptor.compress?.compressionTracker,c=this._descriptor.compress?.compressionCallback,{compressedTextureETC:u,compressedTextureS3TC:h}=i.capabilities;if(!ws.compressionWorkerHandle?.isCompressible(e,this._descriptor)||!u&&!h)return;this.abortCompression();const f=new AbortController;let g;this._compressionAbortController=f,l?.increment();try{e instanceof Uint8Array?g=e.buffer:(g=await createImageBitmap(e,{imageOrientation:s?"flipY":"none"}),pi(f));const y={data:g,width:n,height:r,needsFlip:e instanceof Uint8Array&&this.descriptor.flipped,components:this._descriptor.pixelFormat===6408?4:3,preMultiplyAlpha:o,hasMipmap:a,hasETC:!!u,hasS3TC:!!h},_=await ws.compressionWorkerHandle.invoke(y,f.signal,"low");if(pi(f),_.compressedTexture&&this.hasWebGLTextureObject){const b=this.usedMemory;this._descriptor.internalFormat=_.internalFormat,this._setData(_.compressedTexture),c?.(b-this.usedMemory)}}catch(y){wa(y)||pf().error("Texture compression failed!")}finally{l?.decrement(),this._compressionAbortController?.signal.aborted&&(this._compressionAbortController=null),g instanceof ImageBitmap&&g.close()}}_forEachMipmapLevel(e,n=1/0){let{width:r,height:i,depth:s,hasMipmap:o,target:a}=this._descriptor;const l=a===32879;if(r==null||i==null||l&&s==null)throw new Xe("texture:missing-size","Missing texture dimensions for mipmap calculation");for(let c=0;e(c,r,i,s),o&&(r!==1||i!==1||l&&s!==1)&&!(c>=n);++c)r=Math.max(1,r>>1),i=Math.max(1,i>>1),l&&(s=Math.max(1,s>>1))}_applySamplingMode(){const e=this._descriptor,n=e.context?.gl;let r=e.samplingMode,i=e.samplingMode;r===9985||r===9987?(r=9729,e.hasMipmap||(i=9729)):r!==9984&&r!==9986||(r=9728,e.hasMipmap||(i=9728)),n.texParameteri(e.target,n.TEXTURE_MAG_FILTER,r),n.texParameteri(e.target,n.TEXTURE_MIN_FILTER,i)}_applyWrapMode(){const e=this._descriptor,n=e.context?.gl;typeof e.wrapMode=="number"?(n.texParameteri(e.target,n.TEXTURE_WRAP_S,e.wrapMode),n.texParameteri(e.target,n.TEXTURE_WRAP_T,e.wrapMode)):(n.texParameteri(e.target,n.TEXTURE_WRAP_S,e.wrapMode.s),n.texParameteri(e.target,n.TEXTURE_WRAP_T,e.wrapMode.t))}_applyShadowMode(){const e=this._descriptor,n=e.context?.gl,r=e.compareEnabled?n.COMPARE_REF_TO_TEXTURE:n.NONE;n.texParameteri(e.target,n.TEXTURE_COMPARE_MODE,r),e.compareEnabled&&n.texParameteri(e.target,n.TEXTURE_COMPARE_FUNC,n.GREATER),G0(n)}_applyAnisotropicFilteringParameters(){const e=this._descriptor,n=e.context.capabilities.textureFilterAnisotropic;n&&e.context.gl.texParameterf(e.target,n.TEXTURE_MAX_ANISOTROPY,e.maxAnisotropy??1)}},ws.TEXTURE_UNIT_FOR_UPDATES=0,ws.compressionWorkerHandle=null,ws);const S$=()=>kt.getLogger("esri.views.2d.engine.webgl.painter.highlight.HighlightGradient");function att(t,e){e.fillColor[0]=t.color.r/255,e.fillColor[1]=t.color.g/255,e.fillColor[2]=t.color.b/255,e.fillColor[3]=t.color.a,t.haloColor?(e.outlineColor[0]=t.haloColor.r/255,e.outlineColor[1]=t.haloColor.g/255,e.outlineColor[2]=t.haloColor.b/255,e.outlineColor[3]=t.haloColor.a):(e.outlineColor[0]=e.fillColor[0],e.outlineColor[1]=e.fillColor[1],e.outlineColor[2]=e.fillColor[2],e.outlineColor[3]=e.fillColor[3]),e.fillColor[3]*=t.fillOpacity,e.outlineColor[3]*=t.haloOpacity,e.fillColor[0]*=e.fillColor[3],e.fillColor[1]*=e.fillColor[3],e.fillColor[2]*=e.fillColor[3],e.outlineColor[0]*=e.outlineColor[3],e.outlineColor[1]*=e.outlineColor[3],e.outlineColor[2]*=e.outlineColor[3],e.outlineWidth=(1-t.haloBlur)*t.haloWidth,e.outerHaloWidth=t.haloBlur*t.haloWidth/2,e.innerHaloWidth=t.haloBlur*t.haloWidth/2,e.outlinePosition=0}const ltt=[0,0,0,0];let S_e=class{constructor(){this.type="single",this._highlightOptions=new Sg,this._convertedHighlightOptions={fillColor:[0,0,0,0],outlineColor:[0,0,0,0],outlinePosition:0,outlineWidth:0,innerHaloWidth:0,outerHaloWidth:0},this._optionsShadeTexKey="",this._texelData=new Uint8Array(4*qE),this._minMaxDistance=[0,0]}setHighlightOptions(e){this._highlightOptions=e}applyHighlightOptions(e,n){this._updateGradientTexture(e),e.bindTexture(this._shadeTex,Wet),n.setUniform2fv("u_minMaxDistance",this._minMaxDistance)}destroy(){this._shadeTex?.dispose(),this._shadeTex=null}getReasonsWithGradients(){return[{activeReasons:(1<<g_e)-1,activeGradient:this}]}_updateGradientTexture(e){const n=ctt(this._highlightOptions);if(n===this._optionsShadeTexKey)return;this._optionsShadeTexKey=n,att(this._highlightOptions,this._convertedHighlightOptions);const r=this._convertedHighlightOptions,i=r.outlinePosition-r.outlineWidth/2-r.outerHaloWidth,s=r.outlinePosition-r.outlineWidth/2,o=r.outlinePosition+r.outlineWidth/2,a=r.outlinePosition+r.outlineWidth/2+r.innerHaloWidth,l=Math.sqrt(Math.PI/2)*Yet,c=Math.abs(i)>l?Math.round(10*(Math.abs(i)-l))/10:0,u=Math.abs(a)>l?Math.round(10*(Math.abs(a)-l))/10:0;let h;c&&!u?S$().error("The outer rim of the highlight is "+c+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards positive values (inwards)."):!c&&u?S$().error("The inner rim of the highlight is "+u+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards negative values (outwards)."):c&&u&&S$().error("The highlight is "+Math.max(c,u)+"px away from the edge of the feature; consider reducing some width values.");const f=[void 0,void 0,void 0,void 0];function g(_,b,T){f[0]=(1-T)*_[0]+T*b[0],f[1]=(1-T)*_[1]+T*b[1],f[2]=(1-T)*_[2]+T*b[2],f[3]=(1-T)*_[3]+T*b[3]}const{_texelData:y}=this;for(let _=0;_<qE;++_)h=i+_/(qE-1)*(a-i),h<i?(f[0]=0,f[1]=0,f[2]=0,f[3]=0):h<s?g(ltt,r.outlineColor,(h-i)/(s-i)):h<o?[f[0],f[1],f[2],f[3]]=r.outlineColor:h<a?g(r.outlineColor,r.fillColor,(h-o)/(a-o)):[f[0],f[1],f[2],f[3]]=r.fillColor,y[4*_]=255*f[0],y[4*_+1]=255*f[1],y[4*_+2]=255*f[2],y[4*_+3]=255*f[3];if(this._minMaxDistance[0]=i,this._minMaxDistance[1]=a,!this._shadeTex){const _=new x_e(qE,1);_.wrapMode=33071,this._shadeTex=new ott(e,_)}this._shadeTex.updateData(0,0,0,qE,1,this._texelData)}};function ctt(t){return`${t.color};${t.haloColor};${t.haloOpacity};${t.fillOpacity};${t.haloWidth};${t.haloBlur}`}let utt=class{constructor(){this.type="multi",this.gradients=[]}setHighlightOptions(e){for(let n=0;n<e.length;n++)this.gradients[n]||(this.gradients[n]=new S_e),this.gradients[n].setHighlightOptions(e[n]);for(let n=e.length+1;n<this.gradients.length;n++)this.gradients[n].destroy();this.gradients.length=e.length}destroy(){for(const e of this.gradients)e.destroy()}getReasonsWithGradients(){let e=1;const n=[];for(let r=0;r<this.gradients.length;r++){const i=this.gradients[r];n.push({activeReasons:e,activeGradient:i}),e<<=1}return n}};const T_e={color:{write:[!0,!0,!0,!0],blendMode:"composite"},depth:!1,stencil:{write:!1,test:{compare:514,mask:255,op:{fail:7680,zFail:7680,zPass:7681}}}},htt={color:{write:[!0,!0,!0,!0],blendMode:"additive"},depth:!1,stencil:!1},dtt={...T_e,color:{write:[!0,!0,!0,!0],blendMode:"delete"}};function ftt({pixelRatio:t,state:e,displayLevel:n,requiredLevel:r},i){const s=1/2**(n-i.key.level),o=1/2**(r-i.key.level);return{displayMat3:e.displayMat3,displayViewMat3:e.displayViewMat3,displayViewScreenMat3:i.transforms.displayViewScreenMat3,viewMat3:e.viewMat3,tileMat3:i.transforms.tileMat3,displayZoomFactor:s,requiredZoomFactor:o,tileOffset:[i.x,i.y],currentScale:e.scale,currentZoom:n,metersPerSRUnit:Wd(e.spatialReference),rotation:e.rotation,pixelRatio:t}}function k_e(t){return t.passOptions?.type==="highlight"}function A_e(t){return t.passOptions?.type==="hittest"}function ptt(t){if(!A_e(t))return null;const{position:e,distance:n,smallSymbolDistance:r,smallSymbolSizeThreshold:i}=t.passOptions;return{position:e,distance:n,smallSymbolDistance:r,smallSymbolSizeThreshold:i}}function mtt(t){if(!k_e(t))return null;const{activeReasons:e,highlightAll:n}=t.passOptions;return{activeReasons:e,highlightAll:n?1:0}}function ROt(t,e,n){const r={};for(const i in n)typeof n[i]!="function"?r[i]=n[i]:r[i]=n[i](t,e);return r}function MOt(t,e){const{attributeView:n,context:r}=t;return{storage:n.getUniforms(r),view:ftt(t,e),hittestRequest:ptt(t),highlight:mtt(t)}}function NOt(t){return{inside:t.selection===2,outside:t.selection===3}}function gtt(t){return A_e(t)?htt:k_e(t)&&t.passOptions.stepType==="clear"?dtt:T_e}function OOt(t){const{row:e,col:n}=t.key,r=n*qre,i=e*qre;return{tileOffsetFromLocalOrigin:[r%fR,i%fR],maxIntsToLocalOrigin:[Math.floor(r/fR),Math.floor(i/fR)]}}const ytt=new Ys({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch",mesh:"mesh"});function LOt(t){return ytt.toJSON(t)}function DOt(t){const{bandCount:e,attributeTable:n,colormap:r,pixelType:i}=t.raster.rasterInfo;return e===1&&(n!=null||r!=null||i==="u8"||i==="s8")}function vtt(t,e){return e==null?(t?.destroy(),null):(t?.type==="single"&&Array.isArray(e)&&(t.destroy(),t=null),t?.type!=="multi"||Array.isArray(e)||(t.destroy(),t=null),t||(t=Array.isArray(e)?new utt:new S_e),Array.isArray(e)?t.type==="multi"&&t.setHighlightOptions(e):t.type==="single"&&t.setHighlightOptions(e),t)}function jOt(t,e,n,r){const{painter:i,highlightGradient:s}=t,{highlight:o}=i.effects;if(!s)return;const a=t.passOptions,l=s.getReasonsWithGradients();for(let c=0;c<l.length;c++){const u={...t,passOptions:{type:"highlight",activeGradient:l[c].activeGradient,activeReasons:l[c].activeReasons,stepType:"burn",highlightAll:e}};if(o.bind(u),n(u),c<l.length-1){let f=0;for(let g=c+1;g<l.length;g++)f|=l[g].activeReasons;n({...t,passOptions:{type:"highlight",activeGradient:l[c].activeGradient,activeReasons:f,stepType:"clear",highlightAll:e}})}const h={...t,passOptions:{type:"highlight",activeGradient:l[c].activeGradient,activeReasons:l[c].activeReasons,stepType:"draw",highlightAll:e}};i.setPipelineState(gtt(t)),i.updatePipelineState(t.context),o.draw(h),o.unbind()}t.passOptions=a}const mR=t=>parseFloat(t)/100;function _tt(t,e,n){const r=typeof t.left=="string"?mR(t.left)*e:t.left,i=typeof t.right=="string"?mR(t.right)*e:t.right,s=typeof t.top=="string"?mR(t.top)*n:t.top,o=typeof t.bottom=="string"?mR(t.bottom)*n:t.bottom,a=s;return{xmin:r,xmax:Math.max(e-i,r),ymin:a,ymax:Math.max(n-o,s)}}function I_e(t,e,n,r){switch(e.type){case"rect":{const{width:i,height:s}=t,{xmin:o,xmax:a,ymin:l,ymax:c}=_tt(e,i,s),{x:u,y:h}=n;return u>o&&u<a&&h>l&&h<c}case"path":return e.path.length===0||!Array.isArray(e.path[0][0])||VB(e.path,[n.x,n.y]);case"geometry":return e.geometry==null||(e.geometry.type==="polygon"?FB(e.geometry,r):wI(e.geometry,r))}}function xtt(t){if(!t.highlights)return null;const e=t.highlights.findIndex(n=>n.name==="default");return e===-1?null:t.highlights.items[e]}function wtt(t,e){if(!t.highlights){if(!e)return;t.highlights=new Ot([new Sg])}const n=t.highlights.findIndex(r=>r.name==="default");e?t.highlights.items[n].assignFrom(e):(t.highlights.removeAt(n),t.highlights.length===0&&(t.highlights=null))}async function btt(t,e,n){const r=cve(e)?lve(t,e):e;if(!t.ready||isNaN(r.x)||isNaN(r.y))return{screenPoint:r,results:[]};let i=new Set;const s=new Set;let o=!1,a=null,l=null;n?.include?Jre(n.include,Zre(t,f=>{i.add(f),T$(f,g=>s.add(g))},(f,g)=>{s.add(f),i.add(g)},f=>{a||(a=new Set),a.add(f)},f=>i.add(f),()=>o=!0)):(o=!0,i=new Set(t.allLayerViews),i.forEach(f=>{T$(f,g=>s.add(g))})),n?.exclude&&Jre(n.exclude,Zre(t,f=>{i.delete(f),T$(f,g=>s.delete(g))},f=>s.delete(f),f=>{l||(l=new Set),l.add(f)}));const c=t.toMap(r),u=t.allLayerViews.filter(f=>!f.suspended&&i.has(f)&&f.clips.every(g=>I_e(t,g,r,c))).reverse();let h=[...o?t.graphicsView.hitTest(c).map(f=>({type:"graphic",graphic:f,layer:null,mapPoint:c})):[],...await Promise.all(u.map(f=>f.hitTest(c,r)).toArray())].filter(m2).flat().filter(m2);return h=h.filter(f=>f.type!=="graphic"||f.layer?.type!=="subtype-group"||s.has(f.graphic.layer)),a&&(h=h.filter(f=>!("graphic"in f)||!f.graphic||a?.has(XV(f.graphic)))),l&&(h=h.filter(f=>!("graphic"in f)||!f.graphic||!l?.has(XV(f.graphic)))),{screenPoint:r,results:h}}function Zre(t,e,n,r,i,s){return o=>{if(o instanceof Qo){if(o.layer===t)s?.();else{const a=t.allLayerViews.find(l=>l.layer===o.layer);a&&i?.(a)}r(XV(o))}else if(!("layer"in o&&"element"in o))if(o.type==="subtype-sublayer"){const a=t.allLayerViews.find(l=>l.layer===o.parent);a&&n(o,a)}else{const a=t.allLayerViews.find(l=>l.layer===o);a&&e(a)}}}function Jre(t,e){if(t)if(D4(t))for(const n of t)if(D4(n))for(const r of n)e(r);else e(n);else e(t)}function XV(t){const e=t.getObjectId();return e?`${t.layer?.uid??t.sourceLayer?.uid??"MapView"}/${e}`:`"MapView/${t.uid}`}function T$(t,e){const n=t.layer;n?.type==="subtype-group"&&n.sublayers.forEach(r=>{e(r)})}let XE=null,AN=!0;function Ett(t,e,n){if(!t||!e)throw new Error("Cannot construct image data without dimensions");if(AN)try{return new ImageData(t,e)}catch{AN=!1}return P_e(t,e,n)}function $Ot(t,e,n,r){if(!e||!n)throw new Error("Cannot construct image data without dimensions");if(AN)try{return new ImageData(t,e,n)}catch{AN=!1}const i=P_e(e,n,r);return i.data.set(t,0),i}function Stt(){return XE||(XE=document.createElement("canvas"),XE.width=1,XE.height=1),XE}function P_e(t,e,n){return n||(n=Stt()),n.getContext("2d").createImageData(t,e)}async function Ttt(t,e){const n=window.URL.createObjectURL(t);try{const{data:r}=await ns(n,{...e,responseType:"image"});return r}catch(r){throw wa(r)?r:new Xe("invalid-image",`Could not fetch requested image at ${n}`)}finally{window.URL.revokeObjectURL(n)}}async function FOt(t,e){const{arrayBuffer:n,mediaType:r}=await ktt(t,e),i=r==="image/png";if(r==="image/gif"){const{isAnimatedGIF:s,parseGif:o}=await _e(()=>import("./gif-CEKoKRGT.js"),[]);if(s(n))return o(n,e)}if(i){const{isAnimatedPNG:s,parseApng:o}=await _e(()=>import("./apng-Cdzzv1bH.js"),__vite__mapDeps([400,61]));if(s(n))return o(n,e)}return Ttt(new Blob([n],{type:r}),e)}async function ktt(t,e){const n=g2(t);if(n?.isBase64)return{arrayBuffer:gfe(n.data),mediaType:n.mediaType};const r=await ns(t,{responseType:"array-buffer",...e});return{arrayBuffer:r.data,mediaType:r.getHeader?.("Content-Type")??""}}function C_e(t,e,n){const{ctx:r,canvas:i}=M_e(t,n),s=r.getImageData(0,0,t.width,t.height),o=O_e(i,e);return N_e(i),{dataUrl:o,data:s}}function R_e(t,e){const{ctx:n,canvas:r}=M_e(t,e),i=n.getImageData(0,0,t.width,t.height);return N_e(r),i}function M_e(t,e){const n=Att();e.premultipliedAlpha&&Rtt(t),n.width=t.width,n.height=t.height;const r=n.getContext("2d",{willReadFrequently:!0});return r.putImageData(t,0,0),e.flipY&&Ctt(r),{ctx:r,canvas:n}}function N_e(t){t.width=0,t.height=0}function Att(){return k$==null&&(k$=document.createElement("canvas")),k$}let k$=null;function O_e(t,e){const n=Mtt[e.format],r=e.quality/100;return t.toDataURL(n,r)}function L_e(t,e){const n=Ptt(t),r=Ott[n];return{format:n,quality:vu(e??r,0,100)}}function D_e(t,e){return e/Math.max(t[0],t[1])}function Itt(t,e,n,r=0,i=0,s=t.width-r,o=t.height-i,a=!1){const{data:l}=t,{width:c,height:u,data:h}=e,f=s/c,g=o/u,y=Math.ceil(f/2),_=Math.ceil(g/2),b=t.width;for(let T=0;T<u;T++)for(let A=0;A<c;A++){const I=4*(A+(a?u-T-1:T)*c);let P=0,R=0,D=0,C=0,M=0,O=0;const j=(T+.5)*g;for(let V=Math.floor(T*g);V<(T+1)*g;V++){const U=Math.abs(j-(V+.5))/_,G=(A+.5)*f,de=U*U;for(let Ie=Math.floor(A*f);Ie<(A+1)*f;Ie++){const ze=Math.abs(G-(Ie+.5))/y,Ne=Math.sqrt(de+ze*ze);if(Ne>=1)continue;let fe=2*Ne*Ne*Ne-3*Ne*Ne+1;const De=4*(r+Ie+(i+V)*b);O+=fe*l[De+3],R+=fe,!n&&l[De+3]<255&&(fe=fe*l[De+3]/255),D+=fe*l[De],C+=fe*l[De+1],M+=fe*l[De+2],P+=fe}}h[I]=D/P,h[I+1]=C/P,h[I+2]=M/P,h[I+3]=O/R}return e}function Ptt(t){switch(t){case"png":case"jpg":case"jpeg":return t;default:return Ntt}}function Ctt(t){t.save(),t.globalCompositeOperation="copy",t.scale(1,-1),t.translate(0,-t.canvas.height),t.drawImage(t.canvas,0,0),t.restore()}function Rtt(t){const e=t.data,n=e.length;for(let r=0;r<n;r+=4){const i=e[r+3];if(i!==255&&i>0){const s=255/i;e[r]=e[r]*s,e[r+1]=e[r+1]*s,e[r+2]=e[r+2]*s}}}const Mtt={png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg"},Qre=98,Ntt="png",Ott={png:100,jpg:Qre,jpeg:Qre},VOt=Object.freeze(Object.defineProperty({__proto__:null,createEmptyImageData:Ett,encode:C_e,encodeData:R_e,getFormatAndQuality:L_e,getMaximumResolutionScale:D_e,resampleHermite:Itt,toDataUrl:O_e},Symbol.toStringTag,{value:"Module"})),j_e={flipY:!0,premultipliedAlpha:!0};async function Ltt(t,e){const n=await $_e(t,e),{format:r,quality:i}=L_e(e?.format,e?.quality);return C_e(n,{format:r,quality:i},j_e)}async function Dtt(t,e){const n=await $_e(t,e);return R_e(n,j_e)}function $_e(t,e){const n=Ftt(e||{},$tt(t.stage,t.size),t.size,t.padding),r=jtt(e,t.allLayerViews);return t.stage.takeScreenshot(n,r,t.backgroundColor,e?.rotation)}function jtt(t={},e){if(!t.layers)return;const n=[];return t.layers.forEach(r=>{const i=e.find(s=>s.layer.id===r.id);i?.container&&n.push(i.container)}),n}function $tt(t,e){return Math.min(4,D_e(e,Math.min(4096,t.context.parameters.maxTextureSize)))}function Ftt(t,e,n,r){t.ignorePadding&&(r={left:0,right:0,top:0,bottom:0});let i=null;t.width!=null&&t.height!=null?i=[t.width,t.height]:t.width==null&&t.height!=null?i=[t.height,t.height]:t.width!=null&&t.height==null?i=[t.width,t.width]:t.width==null&&t.height==null&&(i=null);const s=n[0]-(r.left+r.right),o=n[1]-(r.top+r.bottom);let a,l,c=t.area||{x:0,y:0,width:s,height:o};if(i){const u=s/o,h=i[0]/i[1];if(h>u){const f=c.width/h;c={x:c.x,y:Math.round(c.y+(c.height-f)/2),width:c.width,height:Math.round(f)}}else{const f=c.height*h;c={x:Math.round(c.x+(c.width-f)/2),y:c.y,width:Math.round(f),height:c.height}}}else i=[c.width,c.height];return i[0]>c.width?(a=Math.min(i[0]/c.width,e),l=i[0]/c.width/a):(a=1,l=i[0]/c.width),{cropArea:{x:Math.round((c.x+r.left)*a),y:Math.round((c.y+r.top)*a),width:Math.round(c.width*a),height:Math.round(c.height*a)},outputScale:l,resolutionScale:a}}const Vtt=t=>t.includes("Brush");let F_e=class{constructor(){this._names=new Map}begin(e){this._names.has(e)||(this._names.set(e,!1),Vtt(e)&&this.record("Esri.FirstDraw"),performance.mark(`Esri.${e}.Start`))}end(e){this._names.has(e)&&!this._names.get(e)&&(this._names.set(e,!0),performance.mark(`Esri.${e}.End`))}record(e){this._names.has(e)||(this._names.set(e,!0),performance.mark(`Esri.${e}`))}};const eie=Symbol("analyses-owner-handles");let Pm=class extends Kt{constructor(e){super(e),this._allAnalysisViews=new Ot,this._creatingViewCount=0,this._attachedToViewResolver=tie(),this._items=new Map,this._moduleMap=new Map,this._scheduledUpdateHandle=null,this._emitOnView=(n,r)=>this.view.emit(n,r)}destroy(){this._disconnectOwners(),this._attachedToViewResolver.reject(Pr("AnalysisViewManager was destroyed")),this._set("view",null)}attach(){this._connectOwners(),this._attachedToViewResolver.resolve()}detach(){this._disconnectOwners(),this._attachedToViewResolver.reject(Pr()),this._attachedToViewResolver=tie()}get updating(){return!this.view.ready||this._creatingViewCount!==0||this._allAnalysisViews.some(e=>e.updating)}get testInfo(){}async whenAnalysisView(e){await this._attachedToViewResolver.promise;const n=this._items.get(e);if(n==null||n.state.list===1)throw new Xe("AnalysisViewManager:no-analysis-view-for-analysis","The analysis does not exist in view.analyses",{analysis:e});return n.createAnalysisViewTask.promise}_connectOwners(){this.addHandles(this._connectAnalysesCollection(this.view.analyses),eie)}_disconnectOwners(){this.removeHandles(eie),this._update(),this._creatingViewCount=0}_connectAnalysesCollection(e){for(const i of e)this._addAnalysis(i);const n=e.on("after-add",i=>this._addAnalysis(i.item)),r=e.on("after-remove",i=>this._removeAnalysis(i.item));return Zn(()=>{n.remove(),r.remove();for(const i of e)this._removeAnalysis(i)})}_addAnalysis(e){const n=this._items.get(e);if(n==null){const r={state:{view:0,list:0},analysis:e,view:null,createAnalysisViewTask:null};this._items.set(e,r),r.createAnalysisViewTask=MO(i=>this._createAnalysisViewPromise(r,i).then(s=>(this._emitOnView("analysis-view-create",{analysis:e,analysisView:s}),s),s=>{throw this._emitOnView("analysis-view-create-error",{analysis:e,error:s}),s}))}else n.state.list=0}_removeAnalysis(e){const n=this._items.get(e);n!=null?(n.state.list=1,this._scheduleUpdate()):kt.getLogger(this).error("Trying to remove analysis which was not added")}_scheduleUpdate(){this._scheduledUpdateHandle==null&&(this._scheduledUpdateHandle=hb(()=>this._update()))}_update(){this._scheduledUpdateHandle=ii(this._scheduledUpdateHandle),this._items.forEach(e=>{if(e.state.list!==1)return;const{analysis:n,view:r}=e;switch(this._items.delete(n),e.state.view){case 0:e.createAnalysisViewTask=$1(e.createAnalysisViewTask);break;case 1:r!=null&&(this._allAnalysisViews.remove(r),e.view=Di(r),e.createAnalysisViewTask=null,this._emitOnView("analysis-view-destroy",{analysis:n,analysisView:r}))}})}async _createAnalysisViewPromise(e,n){const{analysis:r}=e;if(this._creatingViewCount+=1,!this._moduleMap.has(r.type))try{this._moduleMap.set(r.type,await this.importAnalysisViewModule(r))}catch{throw this._creatingViewCount-=1,new Xe("AnalysisViewManager:no-analysis-view-for-analysis",`Analysis of type "${r.type}" is not supported`)}if(ma(n))throw this._creatingViewCount-=1,Pr("AnalysisView creation aborted");const i=new(this._moduleMap.get(r.type)).default({analysis:r,view:this.view});let s=!0;yu(n,()=>{s&&this._destroyAnalysisView(r,i)});try{await i.when()}catch(o){throw s=!1,this._destroyAnalysisView(r,i),o}if(ma(n))throw Pr();return s=!1,e.view=i,e.state.view=1,this._allAnalysisViews.add(i),this._creatingViewCount-=1,i}_destroyAnalysisView(e,n){n.destroyed||(this._creatingViewCount-=1,n.destroy(),this._emitOnView("analysis-view-destroy",{analysis:e,analysisView:n}))}};x([E()],Pm.prototype,"updating",null),x([E({constructOnly:!0})],Pm.prototype,"importAnalysisViewModule",void 0),x([E({constructOnly:!0})],Pm.prototype,"view",void 0),x([E()],Pm.prototype,"_allAnalysisViews",void 0),x([E()],Pm.prototype,"_creatingViewCount",void 0),Pm=x([ue("esri.views.support.AnalysisViewManager")],Pm);const ztt=Pm;function tie(){const t=xc();return t.promise.catch(()=>{}),t}let Gtt=class{constructor(e){this.getUnmaskedRenderer=e}};function Utt(t){const e=t.getExtension("WEBGL_debug_renderer_info");return e?new Gtt(()=>t.getParameter(e.UNMASKED_RENDERER_WEBGL)):null}let nie;function Btt(){return nie??=qtt(),nie}let Wtt=class{constructor(){this.available=!1,this.majorPerformanceCaveat=!1,this.maxTextureSize=0,this.supportsVertexShaderSamplers=!1,this.supportsHighPrecisionFragment=!1,this.supportsColorBufferFloat=!1,this.supportsColorBufferFloatBlend=!1,this.supportsColorBufferHalfFloat=!1,this.unmaskedRenderer="unloaded"}};function Htt(t){if(typeof WebGL2RenderingContext>"u")return null;const e=document.createElement("canvas");if(!e)return null;let n=e.getContext("webgl2",{failIfMajorPerformanceCaveat:!0});if(n==null&&(n=e.getContext("webgl2"),n!=null&&(t.majorPerformanceCaveat=!0,t.unmaskedRenderer=Utt(n)?.getUnmaskedRenderer()??"unknown")),n==null)return n;t.available=!0,t.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE),t.supportsVertexShaderSamplers=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS)>0;const r=n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT);return r&&(t.supportsHighPrecisionFragment=r.precision>0),n}function qtt(){const t=new Wtt,e=Htt(t);return e==null||(t.supportsColorBufferFloat=e.getExtension("EXT_color_buffer_float")!==null,t.supportsColorBufferFloatBlend=e.getExtension("EXT_float_blend")!==null,t.supportsColorBufferHalfFloat=t.supportsColorBufferFloat||e.getExtension("EXT_color_buffer_half_float")!==null),t}function Ktt(t){const e=Btt();return e.available?t==="3d"&&e.majorPerformanceCaveat?new Xe("webgl:major-performance-caveat-detected",`Your WebGL implementation (${e.unmaskedRenderer}) doesn't seem to support hardware accelerated rendering. Check your browser settings or if your GPU is in a blocklist.`):e.supportsHighPrecisionFragment?e.supportsVertexShaderSamplers?null:new Xe("webgl:vertex-shader-samplers-required","WebGL support for vertex shader samplers is required but not supported."):new Xe("webgl:high-precision-fragment-required","WebGL support for high precision fragment shaders is required but not supported."):new Xe("webgl:required","WebGL2 is required but not supported.",new Error().stack)}function Ytt(t){return t&&"nodeType"in t}function Xtt(t){return t&&typeof t.render=="function"}const rie={component:"esri-component"};let fy=class extends Kt{constructor(){super(...arguments),this.widget=null}destroy(){this.node=null,this.widget?.destroy()}get id(){return this._get("id")??this.widget?.id??this.node?.id}set id(e){this._set("id",e)}set node(e){const n=this._get("node");e!==n&&(e&&e.classList.add(rie.component),n&&n.classList.remove(rie.component),this._set("node",e))}castNode(e){return this.widget?.destroy(),e?typeof e=="string"||Ytt(e)?(this._set("widget",null),SW(e)):(Xtt(e)&&!e.domNode&&(e.domNode=document.createElement("div")),this._set("widget",e),e.domNode):(this._set("widget",null),null)}};x([E()],fy.prototype,"id",null),x([E()],fy.prototype,"node",null),x([qs("node")],fy.prototype,"castNode",null),x([E({readOnly:!0})],fy.prototype,"widget",void 0),fy=x([ue("esri.views.ui.Component")],fy);const d3=fy,Ztt=(t,e)=>{let n=t;for(;n;){if(n===e)return!0;if(!n.parentNode)return!1;n.parentNode instanceof ShadowRoot?n=n.parentNode.host:n=n.parentNode}return!1},HOt=(t,e,n)=>{const r=Jtt(e).subscribe;return r(i=>{i.some(o=>Ztt(t,o.target))&&n()})},A$={},Jtt=t=>{const e=t.join(","),n=A$[e];if(n!==void 0)return n;const r=new Set,i=new MutationObserver(o=>r.forEach(a=>a(o)));globalThis.document&&i.observe(document.documentElement,{attributes:!0,attributeFilter:t,subtree:!0});const s={subscribe:o=>(r.add(o),()=>{r.delete(o),r.size===0&&(i.disconnect(),A$[e]=void 0)})};return A$[e]=s,s},V_e=(t,e)=>{let n=t;for(;n;){const r=n.closest?.(e);if(r)return r;const i=n.getRootNode?.();if(i===globalThis.document)return;n=i.host}};function Qtt(t){const e=V_e(t,".calcite-mode-dark, .calcite-mode-light, .calcite-mode-auto");return e?.classList.contains("calcite-mode-dark")||e?.classList.contains("calcite-mode-auto")&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}const qOt=(t,e,n)=>V_e(t,`[${e}]`)?.getAttribute(e)??n,ent="--esri-calcite-mode-name";function tnt(){const t=getComputedStyle(document.body).getPropertyValue(ent).replaceAll(/\W/g,"").toLowerCase();return t==="dark"||t==="light"?t:void 0}const z_e="calcite-mode-";function G_e(t){return tnt()??Qtt(t??document.body)}function KOt(t){return G_e(t)==="dark"}function nnt(t){return`${z_e}${G_e(t)}`}function rnt(t){const e=nnt(t);int(t),t.classList.add(e)}function int(t){Array.from(t.classList).forEach(e=>{e.startsWith(z_e)&&t.classList.remove(e)})}const cL=new Map;function U_e(){cL.clear()}function snt(t){return cL.get(t)}function ont(t,e){cL.set(t,e)}function I$(t){cL.delete(t)}function ant(...t){const e=Na.acquire();for(let r=0;r<t.length;r++){const i=t[r],s=typeof i;if(s==="string")e.push(i);else if(Array.isArray(i))e.push.apply(e,i);else if(s==="object")for(const o in i)i[o]&&e.push(o)}const n=e.join(" ");return Na.release(e),n}(()=>{const t=new Map,e=new ResizeObserver(r=>{U_e();for(const i of r)t.get(i.target)?.(i)}),n=(r,i,s)=>(t.set(r,i),e.observe(r,s),Zn(()=>{e.unobserve(r),t.delete(r)}));return(r,i,s)=>{let o=null;return fv([fn(()=>typeof r=="function"?r():r,a=>{o?.remove(),a&&(o=n(a,i,s))},ra),Zn(()=>o?.remove())])}})();function lnt(t){const e=t?.closest("[dir]");return e!==null&&e instanceof HTMLElement&&e.dir==="rtl"||document.dir==="rtl"}function YOt(t){const e="data-node-ref";this[t.getAttribute(e)]=null}function XOt(t){const e="data-node-ref";this[t.getAttribute(e)]=t}function cnt(t){return t==="Enter"||t===" "}async function unt(t,e){await v$e(pI(e));const n=typeof t=="function"?t():t;n&&("setFocus"in n&&typeof n.setFocus=="function"?await n.setFocus():n instanceof HTMLElement&&n.focus())}const hnt={left:0,top:0,bottom:0,right:0},B_e={bottom:30,top:15,right:15,left:15},mf="esri-ui",Qa={ui:mf,corner:`${mf}-corner`,innerContainer:`${mf}-inner-container`,manualContainer:`${mf}-manual-container`,cornerContainer:`${mf}-corner-container`,topLeft:`${mf}-top-left`,topRight:`${mf}-top-right`,bottomLeft:`${mf}-bottom-left`,bottomRight:`${mf}-bottom-right`};function dnt(t){return t&&!t._started&&typeof t.postMixInProperties=="function"&&typeof t.buildRendering=="function"&&typeof t.postCreate=="function"&&typeof t.startup=="function"}function gR(t){return t===0?"0":`${t}px`}function P$(t){const e=typeof t=="object"&&t!==null&&Object.getPrototypeOf(t);return(e===null||e===Object.prototype)&&("component"in t||"index"in t||"position"in t)?t:null}function C$(t,{top:e,bottom:n,left:r,right:i}){t.style.top=e,t.style.bottom=n,t.style.left=r,t.style.right=i}let td=class extends vI{constructor(e){super(e),this._cornerNameToContainerLookup={},this._positionNameToContainerLookup={},this._components=new Array,this._componentMap=new Map,this._removeWidgetHandleKey=Symbol("componentOnRemoveSymbol"),this._locale=hu(),this.view=null,this._applyViewPadding=()=>{const n=this.container;n&&C$(n,this._toPixelPosition(this._getViewPadding()))},this._applyUIPadding=()=>{const n=this._innerContainer;n&&C$(n,this._toPixelPosition(this.padding))},this._initContainers()}initialize(){this.addHandles([fn(()=>[this.view?.padding,this.container],this._applyViewPadding,ya),fn(()=>this.padding,this._applyUIPadding,ya),fn(()=>[this.container,this._locale],([e,n])=>{e&&e.setAttribute("lang",n)},ya),mme(e=>{this._locale=e})])}destroy(){this.removeAllHandles(),this.container=null;for(const e of this._components)e.destroy();this._components.length=0,this._componentMap.clear(),this.view=null,this._set("view",null)}set container(e){const n=this._get("container");e!==n&&(e&&(e.classList.add(Qa.ui),rnt(e),this._attachContainers(e)),n&&(n.classList.remove(Qa.ui),C$(n,{top:"",bottom:"",left:"",right:""}),n.textContent=""),this._set("container",e))}get height(){const e=this.view?.height??0;if(e===0)return e;const n=this._getViewPadding(),{top:r,bottom:i}=n;return Math.max(e-r-i,0)}get padding(){return this._get("padding")}set padding(e){this._overrideIfSome("padding",e)}castPadding(e){return typeof e=="number"?{bottom:e,top:e,right:e,left:e}:{...B_e,...e}}get width(){const e=this.view?.width??0;if(e===0)return e;const n=this._getViewPadding(),{left:r,right:i}=n;return Math.max(e-r-i,0)}add(e,n){let r,i,s;if(Array.isArray(e))return void e.forEach(a=>this.add(a,n));const o=P$(e);o&&({index:r,position:n,component:e,key:i}=o),n&&typeof n=="object"&&({index:r,key:i,position:n,internal:s}=n),!e||n&&!this._isValidPosition(n)||this._add(e,n,r??this._getNumComponentsAtPosition(n),i,s)}remove(e,n){if(!e)return;if(Array.isArray(e))return e.map(i=>this.remove(i,n));const r=this._find(e);if(r){const i=this._componentMap.get(r);if(!i||i.key!==n)return;const s=this._components.indexOf(r);return r.node.parentNode?.removeChild(r.node),this._componentMap.delete(r),r.widget?.removeHandlesReference(this._removeWidgetHandleKey),this._components.forEach(a=>{const l=this._componentMap.get(a);l&&l.position===i.position&&l.index>i.index&&l.index--}),this._components.splice(s,1)[0]}}empty(e,n={removeInternal:!1}){if(Array.isArray(e)){for(const s of e)this.empty(s,n);return}const r=this._positionNameToContainerLookup[e??"manual"],i=Array.prototype.slice.call(r.children).map(s=>this._findByNode(s)).filter(s=>s==null?!1:!(this._componentMap.get(s)?.internal??!1)||n.removeInternal);for(const s of i)this.remove(s)}move(e,n){if(Array.isArray(e)&&e.forEach(o=>this.move(o,n)),!e)return;let r;const i=P$(e)||P$(n);if(i&&(r=i.index,n=i.position,e=i.component||e),n&&!this._isValidPosition(n))return;const s=this.remove(e);s&&this.add(s,{position:n,index:r})}find(e){if(!e)return null;const n=this._findById(e);return n&&(n.widget||n.node)}getComponents(e,n={includeInternal:!1}){return e?Array.isArray(e)?e.flatMap(r=>this._getComponentsAtPosition(r,n)):this._getComponentsAtPosition(e,n):this._components.filter(r=>n.includeInternal||!this._componentMap.get(r)?.internal).map(({widget:r,node:i})=>r??i)}getPosition(e){for(const n in this._positionNameToContainerLookup)if(this._positionNameToContainerLookup[n].contains(e))return n;return null}_add(e,n,r,i,s){e instanceof d3||(e=new d3({node:e}));const{widget:o}=e;o!=null&&o instanceof Kt&&o.addHandles(Zn(()=>{queueMicrotask(()=>this.remove(e))}),this._removeWidgetHandleKey);const a=this._positionNameToContainerLookup[n];this._components.some(l=>{const c=this._componentMap.get(l)?.position,u=c?this._positionNameToContainerLookup[c]:null;return a===u&&this._componentMap.get(l)?.index===r})&&this._components.forEach(l=>{const c=this._componentMap.get(l),u=c?.position,h=u?this._positionNameToContainerLookup[u]:null;c&&h===a&&c.index>=r&&c.index++}),this._place({component:e,position:n,index:r}),this._components.push(e),this._componentMap.set(e,{key:i,position:n,internal:s,index:r})}_find(e){return e?e instanceof d3?this._findByComponent(e):typeof e=="string"?this._findById(e):"domNode"in e?this._findByNode(e.domNode):this._findByNode(e):null}_getViewPadding(){return this.view?.padding??hnt}_attachContainers(e){e.appendChild(this._innerContainer),e.appendChild(this._manualContainer)}_initContainers(){const e=document.createElement("div");e.classList.add(Qa.innerContainer,Qa.cornerContainer);const n=document.createElement("div");n.classList.add(Qa.innerContainer,Qa.manualContainer);const r=document.createElement("div");r.classList.add(Qa.topLeft,Qa.corner),e.appendChild(r);const i=document.createElement("div");i.classList.add(Qa.topRight,Qa.corner),e.appendChild(i);const s=document.createElement("div");s.classList.add(Qa.bottomLeft,Qa.corner),e.appendChild(s);const o=document.createElement("div");o.classList.add(Qa.bottomRight,Qa.corner),e.appendChild(o),this._innerContainer=e,this._manualContainer=n;const a=lnt();this._cornerNameToContainerLookup={"top-left":r,"top-right":i,"bottom-left":s,"bottom-right":o,"top-leading":a?i:r,"top-trailing":a?r:i,"bottom-leading":a?o:s,"bottom-trailing":a?s:o},this._positionNameToContainerLookup={manual:n,...this._cornerNameToContainerLookup}}_isValidPosition(e){return!!this._positionNameToContainerLookup[e]}_place(e){const n=e.position??"manual",{component:r,index:i}=e,s=this._positionNameToContainerLookup[n],o=i!=null&&i>-1;if(dnt(r.widget)&&r.widget.startup(),!o)return void s.appendChild(r.node);const a=Array.from(s.children);if(a.length!==0){for(const l of a){const c=this._findByNode(l);if(c&&i<(this._componentMap.get(c)?.index??0))return void l.parentNode?.insertBefore(r.node,l)}s.appendChild(r.node)}else s.appendChild(r.node)}_toPixelPosition(e){return{top:gR(e.top),left:gR(e.left),right:gR(e.right),bottom:gR(e.bottom)}}_findByComponent(e){return this._components.find(n=>n===e)??null}_findById(e){return this._components.find(({id:n})=>n===e)??null}_findByNode(e){return e?this._components.find(({node:n})=>n===e):null}_getComponentsAtPosition(e,n){const r=this._positionNameToContainerLookup[e];return Array.prototype.slice.call(r.children).map(i=>this._findByNode(i)).filter(m2).filter(i=>n.includeInternal||!this._componentMap.get(i)?.internal).map(({widget:i,node:s})=>i??s)}_getNumComponentsAtPosition(e){return this._positionNameToContainerLookup[e]?.children.length??0}};x([E()],td.prototype,"_locale",void 0),x([E()],td.prototype,"container",null),x([E()],td.prototype,"height",null),x([E({value:B_e})],td.prototype,"padding",null),x([qs("padding")],td.prototype,"castPadding",null),x([E()],td.prototype,"view",void 0),x([E()],td.prototype,"width",null),td=x([ue("esri.views.ui.UI")],td);const fnt=td,pnt={handleInterceptedEvent:(t,e,n,r)=>(t.scheduleRender(),e.properties[`on${r.type}`].apply(e.properties.bind||n,[r]))},mnt={namespace:void 0,performanceLogger:()=>{},eventHandlerInterceptor:void 0,styleApplyer:(t,e,n)=>{e.startsWith("-")?t.style.setProperty(e,n):t.style[e]=n}},gnt=t=>({...mnt,...t}),ynt=(t,e)=>{const n=[];for(;t&&t!==e;)n.push(t),t=t.parentNode;return n},vnt=(t,e)=>t.find(e),iie=(t,e,n=!1)=>{let r=t;return e.forEach((i,s)=>{const o=r?.children?vnt(r.children,a=>a.domNode===i):void 0;n&&!o&&s!==e.length-1||(r=o)}),r},_nt=t=>{let e;const n={...pnt,...t},r=gnt(n),i=r.performanceLogger;let s,o=!0,a=!1;const l=[],c=[],u=(f,g,y)=>{let _;r.eventHandlerInterceptor=(T,A,I,P)=>function(R){let D;i("domEvent",R);const C=ynt(R.currentTarget,_.domNode),M=C.some(j=>customElements.get(j?.tagName?.toLowerCase()));if(R.eventPhase===Event.CAPTURING_PHASE||!M)C.reverse(),D=iie(_.getLastRender(),C);else{const j=R.composedPath(),V=j.slice(j.indexOf(R.currentTarget),j.indexOf(_.domNode)).reverse();D=iie(_.getLastRender(),V,!0)}let O;return D&&(O=n.handleInterceptedEvent(e,D,this,R)),i("domEventProcessed",R),O},n.postProcessProjectionOptions?.(r);const b=y();_=f(g,b,r),r.eventHandlerInterceptor=void 0,l.push(_),c.push(y),n.afterFirstVNodeRendered&&n.afterFirstVNodeRendered(_,b)};let h=()=>{if(s=void 0,o){o=!1,i("renderStart",void 0);for(let f=0;f<l.length;f++){const g=c[f]();i("rendered",void 0);try{l[f].update(g)}catch(y){console.error(y)}i("patched",void 0)}i("renderDone",void 0),o=!0}};return n.modifyDoRenderImplementation&&(h=n.modifyDoRenderImplementation(h,l,c)),e={renderNow:h,scheduleRender:()=>{s||a||(s=requestAnimationFrame(h))},stop:()=>{s&&(cancelAnimationFrame(s),s=void 0),a=!0},resume:()=>{a=!1,o=!0,e.scheduleRender()},append:(f,g)=>{u(ig.append,f,g)},insertBefore:(f,g)=>{u(ig.insertBefore,f,g)},merge:(f,g)=>{u(ig.merge,f,g)},replace:(f,g)=>{u(ig.replace,f,g)},detach:f=>{for(let g=0;g<c.length;g++)if(c[g]===f)return c.splice(g,1),l.splice(g,1)[0];throw new Error("renderFunction was not found")}},e},Mi=(t,e,...n)=>{try{return t?.call(e,...n)}catch(r){console.error(r,t)}},ZV=async(t,e,...n)=>{try{return await t?.call(e,...n)}catch(r){console.error(r,t)}},tH=Symbol.for("controller"),xnt=t=>typeof t=="object"&&t!==null&&(tH in t||"hostConnected"in t||"hostDisconnected"in t||"hostUpdate"in t||"hostUpdated"in t),JOt=t=>typeof t?.then=="function";let GS;const US=t=>{GS!==t&&(GS=t,queueMicrotask(()=>GS===t?GS=void 0:0))},uL=t=>GS;let py=[];const wnt=t=>{if(t===void 0){py=[];return}const e=py.indexOf(t);py=e===-1?[...py,t]:py.slice(0,e+1),queueMicrotask(()=>py=[])},bnt=()=>py;let Nx;const QOt=t=>{Nx!==t&&(Nx=t,queueMicrotask(()=>Nx===t?Nx=void 0:0))},Ent=()=>{const t=Nx;return Nx=void 0,t},Snt=async(t,e)=>{const n=nH(t);if(n===void 0)return t;if(await n.ready,typeof e=="function"){const r=n.watchExports(i=>e(i,r))}return n.exports},Tnt=async t=>{const e=nH(t);return await e.ready,e},nH=t=>{const n=uL().manager.X(t);if(n!==void 0)return n;if(xnt(t))return t;const r=Ent();if(r!==void 0)return r};let JV=!1;const eLt=t=>{JV=!0;try{return t()}finally{JV=!1}};const f3=globalThis,rH=f3.ShadowRoot&&(f3.ShadyCSS===void 0||f3.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,iH=Symbol(),sie=new WeakMap;let W_e=class{constructor(e,n,r){if(this._$cssResult$=!0,r!==iH)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=n}get styleSheet(){let e=this.o;const n=this.t;if(rH&&e===void 0){const r=n!==void 0&&n.length===1;r&&(e=sie.get(n)),e===void 0&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),r&&sie.set(n,e))}return e}toString(){return this.cssText}};const knt=t=>new W_e(typeof t=="string"?t:t+"",void 0,iH),nLt=(t,...e)=>{const n=t.length===1?t[0]:e.reduce((r,i,s)=>r+(o=>{if(o._$cssResult$===!0)return o.cssText;if(typeof o=="number")return o;throw Error("Value passed to 'css' function must be a 'css' function result: "+o+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(i)+t[s+1],t[0]);return new W_e(n,t,iH)},Ant=(t,e)=>{if(rH)t.adoptedStyleSheets=e.map(n=>n instanceof CSSStyleSheet?n:n.styleSheet);else for(const n of e){const r=document.createElement("style"),i=f3.litNonce;i!==void 0&&r.setAttribute("nonce",i),r.textContent=n.cssText,t.appendChild(r)}},oie=rH?t=>t:t=>t instanceof CSSStyleSheet?(e=>{let n="";for(const r of e.cssRules)n+=r.cssText;return knt(n)})(t):t;const{is:Int,defineProperty:Pnt,getOwnPropertyDescriptor:Cnt,getOwnPropertyNames:Rnt,getOwnPropertySymbols:Mnt,getPrototypeOf:Nnt}=Object,hL=globalThis,aie=hL.trustedTypes,Ont=aie?aie.emptyScript:"",Lnt=hL.reactiveElementPolyfillSupport,jT=(t,e)=>t,QV={toAttribute(t,e){switch(e){case Boolean:t=t?Ont:null;break;case Object:case Array:t=t==null?t:JSON.stringify(t)}return t},fromAttribute(t,e){let n=t;switch(e){case Boolean:n=t!==null;break;case Number:n=t===null?null:Number(t);break;case Object:case Array:try{n=JSON.parse(t)}catch{n=null}}return n}},sH=(t,e)=>!Int(t,e),lie={attribute:!0,type:String,converter:QV,reflect:!1,useDefault:!1,hasChanged:sH};Symbol.metadata??=Symbol("metadata"),hL.litPropertyMetadata??=new WeakMap;let px=class extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??=[]).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,n=lie){if(n.state&&(n.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(e)&&((n=Object.create(n)).wrapped=!0),this.elementProperties.set(e,n),!n.noAccessor){const r=Symbol(),i=this.getPropertyDescriptor(e,r,n);i!==void 0&&Pnt(this.prototype,e,i)}}static getPropertyDescriptor(e,n,r){const{get:i,set:s}=Cnt(this.prototype,e)??{get(){return this[n]},set(o){this[n]=o}};return{get:i,set(o){const a=i?.call(this);s?.call(this,o),this.requestUpdate(e,a,r)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??lie}static _$Ei(){if(this.hasOwnProperty(jT("elementProperties")))return;const e=Nnt(this);e.finalize(),e.l!==void 0&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(jT("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(jT("properties"))){const n=this.properties,r=[...Rnt(n),...Mnt(n)];for(const i of r)this.createProperty(i,n[i])}const e=this[Symbol.metadata];if(e!==null){const n=litPropertyMetadata.get(e);if(n!==void 0)for(const[r,i]of n)this.elementProperties.set(r,i)}this._$Eh=new Map;for(const[n,r]of this.elementProperties){const i=this._$Eu(n,r);i!==void 0&&this._$Eh.set(i,n)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){const n=[];if(Array.isArray(e)){const r=new Set(e.flat(1/0).reverse());for(const i of r)n.unshift(oie(i))}else e!==void 0&&n.push(oie(e));return n}static _$Eu(e,n){const r=n.attribute;return r===!1?void 0:typeof r=="string"?r:typeof e=="string"?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$ES=new Promise(e=>this.enableUpdating=e),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach(e=>e(this))}addController(e){(this._$EO??=new Set).add(e),this.renderRoot!==void 0&&this.isConnected&&e.hostConnected?.()}removeController(e){this._$EO?.delete(e)}_$E_(){const e=new Map,n=this.constructor.elementProperties;for(const r of n.keys())this.hasOwnProperty(r)&&(e.set(r,this[r]),delete this[r]);e.size>0&&(this._$Ep=e)}createRenderRoot(){const e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return Ant(e,this.constructor.elementStyles),e}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$EO?.forEach(e=>e.hostConnected?.())}enableUpdating(e){}disconnectedCallback(){this._$EO?.forEach(e=>e.hostDisconnected?.())}attributeChangedCallback(e,n,r){this._$AK(e,r)}_$ET(e,n){const r=this.constructor.elementProperties.get(e),i=this.constructor._$Eu(e,r);if(i!==void 0&&r.reflect===!0){const s=(r.converter?.toAttribute!==void 0?r.converter:QV).toAttribute(n,r.type);this._$Em=e,s==null?this.removeAttribute(i):this.setAttribute(i,s),this._$Em=null}}_$AK(e,n){const r=this.constructor,i=r._$Eh.get(e);if(i!==void 0&&this._$Em!==i){const s=r.getPropertyOptions(i),o=typeof s.converter=="function"?{fromAttribute:s.converter}:s.converter?.fromAttribute!==void 0?s.converter:QV;this._$Em=i;const a=o.fromAttribute(n,s.type);this[i]=a??this._$Ej?.get(i)??a,this._$Em=null}}requestUpdate(e,n,r,i=!1,s){if(e!==void 0){const o=this.constructor;if(i===!1&&(s=this[e]),r??=o.getPropertyOptions(e),!((r.hasChanged??sH)(s,n)||r.useDefault&&r.reflect&&s===this._$Ej?.get(e)&&!this.hasAttribute(o._$Eu(e,r))))return;this.C(e,n,r)}this.isUpdatePending===!1&&(this._$ES=this._$EP())}C(e,n,{useDefault:r,reflect:i,wrapped:s},o){r&&!(this._$Ej??=new Map).has(e)&&(this._$Ej.set(e,o??n??this[e]),s!==!0||o!==void 0)||(this._$AL.has(e)||(this.hasUpdated||r||(n=void 0),this._$AL.set(e,n)),i===!0&&this._$Em!==e&&(this._$Eq??=new Set).add(e))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(n){Promise.reject(n)}const e=this.scheduleUpdate();return e!=null&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(const[i,s]of this._$Ep)this[i]=s;this._$Ep=void 0}const r=this.constructor.elementProperties;if(r.size>0)for(const[i,s]of r){const{wrapped:o}=s,a=this[i];o!==!0||this._$AL.has(i)||a===void 0||this.C(i,void 0,s,a)}}let e=!1;const n=this._$AL;try{e=this.shouldUpdate(n),e?(this.willUpdate(n),this._$EO?.forEach(r=>r.hostUpdate?.()),this.update(n)):this._$EM()}catch(r){throw e=!1,this._$EM(),r}e&&this._$AE(n)}willUpdate(e){}_$AE(e){this._$EO?.forEach(n=>n.hostUpdated?.()),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(e){return!0}update(e){this._$Eq&&=this._$Eq.forEach(n=>this._$ET(n,this[n])),this._$EM()}updated(e){}firstUpdated(e){}};px.elementStyles=[],px.shadowRootOptions={mode:"open"},px[jT("elementProperties")]=new Map,px[jT("finalized")]=new Map,Lnt?.({ReactiveElement:px}),(hL.reactiveElementVersions??=[]).push("2.1.2");const oH=globalThis,cie=t=>t,IN=oH.trustedTypes,uie=IN?IN.createPolicy("lit-html",{createHTML:t=>t}):void 0,H_e="$lit$",Hm=`lit$${Math.random().toFixed(9).slice(2)}$`,q_e="?"+Hm,Dnt=`<${q_e}>`,Y1=document,cA=()=>Y1.createComment(""),uA=t=>t===null||typeof t!="object"&&typeof t!="function",aH=Array.isArray,jnt=t=>aH(t)||typeof t?.[Symbol.iterator]=="function",R$=`[ 	
\f\r]`,ZE=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,hie=/-->/g,die=/>/g,B0=RegExp(`>|${R$}(?:([^\\s"'>=/]+)(${R$}*=${R$}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),fie=/'/g,pie=/"/g,K_e=/^(?:script|style|textarea|title)$/i,Y_e=t=>(e,...n)=>({_$litType$:t,strings:e,values:n}),iLt=Y_e(1),sLt=Y_e(2),Wg=Symbol.for("lit-noChange"),es=Symbol.for("lit-nothing"),mie=new WeakMap,Wy=Y1.createTreeWalker(Y1,129);function X_e(t,e){if(!aH(t)||!t.hasOwnProperty("raw"))throw Error("invalid template strings array");return uie!==void 0?uie.createHTML(e):e}const $nt=(t,e)=>{const n=t.length-1,r=[];let i,s=e===2?"<svg>":e===3?"<math>":"",o=ZE;for(let a=0;a<n;a++){const l=t[a];let c,u,h=-1,f=0;for(;f<l.length&&(o.lastIndex=f,u=o.exec(l),u!==null);)f=o.lastIndex,o===ZE?u[1]==="!--"?o=hie:u[1]!==void 0?o=die:u[2]!==void 0?(K_e.test(u[2])&&(i=RegExp("</"+u[2],"g")),o=B0):u[3]!==void 0&&(o=B0):o===B0?u[0]===">"?(o=i??ZE,h=-1):u[1]===void 0?h=-2:(h=o.lastIndex-u[2].length,c=u[1],o=u[3]===void 0?B0:u[3]==='"'?pie:fie):o===pie||o===fie?o=B0:o===hie||o===die?o=ZE:(o=B0,i=void 0);const g=o===B0&&t[a+1].startsWith("/>")?" ":"";s+=o===ZE?l+Dnt:h>=0?(r.push(c),l.slice(0,h)+H_e+l.slice(h)+Hm+g):l+Hm+(h===-2?a:g)}return[X_e(t,s+(t[n]||"<?>")+(e===2?"</svg>":e===3?"</math>":"")),r]};class hA{constructor({strings:e,_$litType$:n},r){let i;this.parts=[];let s=0,o=0;const a=e.length-1,l=this.parts,[c,u]=$nt(e,n);if(this.el=hA.createElement(c,r),Wy.currentNode=this.el.content,n===2||n===3){const h=this.el.content.firstChild;h.replaceWith(...h.childNodes)}for(;(i=Wy.nextNode())!==null&&l.length<a;){if(i.nodeType===1){if(i.hasAttributes())for(const h of i.getAttributeNames())if(h.endsWith(H_e)){const f=u[o++],g=i.getAttribute(h).split(Hm),y=/([.?@])?(.*)/.exec(f);l.push({type:1,index:s,name:y[2],strings:g,ctor:y[1]==="."?Vnt:y[1]==="?"?znt:y[1]==="@"?Gnt:dL}),i.removeAttribute(h)}else h.startsWith(Hm)&&(l.push({type:6,index:s}),i.removeAttribute(h));if(K_e.test(i.tagName)){const h=i.textContent.split(Hm),f=h.length-1;if(f>0){i.textContent=IN?IN.emptyScript:"";for(let g=0;g<f;g++)i.append(h[g],cA()),Wy.nextNode(),l.push({type:2,index:++s});i.append(h[f],cA())}}}else if(i.nodeType===8)if(i.data===q_e)l.push({type:2,index:s});else{let h=-1;for(;(h=i.data.indexOf(Hm,h+1))!==-1;)l.push({type:7,index:s}),h+=Hm.length-1}s++}}static createElement(e,n){const r=Y1.createElement("template");return r.innerHTML=e,r}}function D2(t,e,n=t,r){if(e===Wg)return e;let i=r!==void 0?n._$Co?.[r]:n._$Cl;const s=uA(e)?void 0:e._$litDirective$;return i?.constructor!==s&&(i?._$AO?.(!1),s===void 0?i=void 0:(i=new s(t),i._$AT(t,n,r)),r!==void 0?(n._$Co??=[])[r]=i:n._$Cl=i),i!==void 0&&(e=D2(t,i._$AS(t,e.values),i,r)),e}class Fnt{constructor(e,n){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=n}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){const{el:{content:n},parts:r}=this._$AD,i=(e?.creationScope??Y1).importNode(n,!0);Wy.currentNode=i;let s=Wy.nextNode(),o=0,a=0,l=r[0];for(;l!==void 0;){if(o===l.index){let c;l.type===2?c=new FI(s,s.nextSibling,this,e):l.type===1?c=new l.ctor(s,l.name,l.strings,this,e):l.type===6&&(c=new Unt(s,this,e)),this._$AV.push(c),l=r[++a]}o!==l?.index&&(s=Wy.nextNode(),o++)}return Wy.currentNode=Y1,i}p(e){let n=0;for(const r of this._$AV)r!==void 0&&(r.strings!==void 0?(r._$AI(e,r,n),n+=r.strings.length-2):r._$AI(e[n])),n++}}class FI{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(e,n,r,i){this.type=2,this._$AH=es,this._$AN=void 0,this._$AA=e,this._$AB=n,this._$AM=r,this.options=i,this._$Cv=i?.isConnected??!0}get parentNode(){let e=this._$AA.parentNode;const n=this._$AM;return n!==void 0&&e?.nodeType===11&&(e=n.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,n=this){e=D2(this,e,n),uA(e)?e===es||e==null||e===""?(this._$AH!==es&&this._$AR(),this._$AH=es):e!==this._$AH&&e!==Wg&&this._(e):e._$litType$!==void 0?this.$(e):e.nodeType!==void 0?this.T(e):jnt(e)?this.k(e):this._(e)}O(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.O(e))}_(e){this._$AH!==es&&uA(this._$AH)?this._$AA.nextSibling.data=e:this.T(Y1.createTextNode(e)),this._$AH=e}$(e){const{values:n,_$litType$:r}=e,i=typeof r=="number"?this._$AC(e):(r.el===void 0&&(r.el=hA.createElement(X_e(r.h,r.h[0]),this.options)),r);if(this._$AH?._$AD===i)this._$AH.p(n);else{const s=new Fnt(i,this),o=s.u(this.options);s.p(n),this.T(o),this._$AH=s}}_$AC(e){let n=mie.get(e.strings);return n===void 0&&mie.set(e.strings,n=new hA(e)),n}k(e){aH(this._$AH)||(this._$AH=[],this._$AR());const n=this._$AH;let r,i=0;for(const s of e)i===n.length?n.push(r=new FI(this.O(cA()),this.O(cA()),this,this.options)):r=n[i],r._$AI(s),i++;i<n.length&&(this._$AR(r&&r._$AB.nextSibling,i),n.length=i)}_$AR(e=this._$AA.nextSibling,n){for(this._$AP?.(!1,!0,n);e!==this._$AB;){const r=cie(e).nextSibling;cie(e).remove(),e=r}}setConnected(e){this._$AM===void 0&&(this._$Cv=e,this._$AP?.(e))}}class dL{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,n,r,i,s){this.type=1,this._$AH=es,this._$AN=void 0,this.element=e,this.name=n,this._$AM=i,this.options=s,r.length>2||r[0]!==""||r[1]!==""?(this._$AH=Array(r.length-1).fill(new String),this.strings=r):this._$AH=es}_$AI(e,n=this,r,i){const s=this.strings;let o=!1;if(s===void 0)e=D2(this,e,n,0),o=!uA(e)||e!==this._$AH&&e!==Wg,o&&(this._$AH=e);else{const a=e;let l,c;for(e=s[0],l=0;l<s.length-1;l++)c=D2(this,a[r+l],n,l),c===Wg&&(c=this._$AH[l]),o||=!uA(c)||c!==this._$AH[l],c===es?e=es:e!==es&&(e+=(c??"")+s[l+1]),this._$AH[l]=c}o&&!i&&this.j(e)}j(e){e===es?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}}let Vnt=class extends dL{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===es?void 0:e}};class znt extends dL{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==es)}}let Gnt=class extends dL{constructor(e,n,r,i,s){super(e,n,r,i,s),this.type=5}_$AI(e,n=this){if((e=D2(this,e,n,0)??es)===Wg)return;const r=this._$AH,i=e===es&&r!==es||e.capture!==r.capture||e.once!==r.once||e.passive!==r.passive,s=e!==es&&(r===es||i);i&&this.element.removeEventListener(this.name,this,r),s&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){typeof this._$AH=="function"?this._$AH.call(this.options?.host??this.element,e):this._$AH.handleEvent(e)}},Unt=class{constructor(e,n,r){this.element=e,this.type=6,this._$AN=void 0,this._$AM=n,this.options=r}get _$AU(){return this._$AM._$AU}_$AI(e){D2(this,e)}};const Bnt=oH.litHtmlPolyfillSupport;Bnt?.(hA,FI),(oH.litHtmlVersions??=[]).push("3.3.2");const Wnt=(t,e,n)=>{const r=n?.renderBefore??e;let i=r._$litPart$;if(i===void 0){const s=n?.renderBefore??null;r._$litPart$=i=new FI(e.insertBefore(cA(),s),s,void 0,n??{})}return i._$AI(t),i};const lH=globalThis;let vw=class extends px{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){const e=super.createRenderRoot();return this.renderOptions.renderBefore??=e.firstChild,e}update(e){const n=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=Wnt(n,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(!1)}render(){return Wg}};vw._$litElement$=!0,vw.finalized=!0,lH.litElementHydrateSupport?.({LitElement:vw});const Hnt=lH.litElementPolyfillSupport;Hnt?.({LitElement:vw});(lH.litElementVersions??=[]).push("4.2.2");class dA{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}const qnt=(t,e)=>{const n=e/Knt;let r=0;const i=setInterval(()=>{r+=n,r>=e&&(clearInterval(i),t())},n);return i},Knt=4,Ynt=(t,e,n)=>{const r=Object.keys(t),i=r.length;Ox===void 0&&queueMicrotask(fL),Ox??=new Map;let s=Ox.get(t);return s===void 0&&(s={callbacks:[],keyCount:i},Ox.set(t,s)),s.keyCount!==i&&(s.callbacks.forEach(o=>o(r)),s.callbacks=[],s.keyCount=i),s.callbacks.push(o=>{const a=c=>Mi(e,null,c),l=o[i];l===void 0?a(void 0):t[l]===n?a(l):a(void 0)}),n};let Ox;const fL=()=>{Ox?.forEach(({callbacks:t},e)=>{const n=Object.keys(e);t.forEach(r=>r(n))}),Ox=void 0},Xnt=(t,e,n)=>{const r=t.manager;return r.V!==es&&r.V!==n&&r.S(void 0,void 0),r.T.length===0&&queueMicrotask(()=>r.S(void 0,void 0)),r.V=n,r.T.push((i,s)=>Mi(e,void 0,n===s?i:void 0)),n},Znt=(t=[uL(),...bnt()],e,n)=>{const r=Array.isArray(t)?t:[t];let i=r.length+1;const s=o=>{i-=1,o!==void 0&&(i=Math.min(i,0)),i===0&&e(o)};r.forEach(o=>Ynt(o,a=>s(a===void 0?void 0:{key:a,host:o,isReactive:!1}),n));for(const o of r)if("manager"in o&&o.manager.component===o){Xnt(o,a=>s(a===void 0?void 0:{key:a,host:o,isReactive:!0}),n);break}return n},Jnt=(t="",e={},n=uL())=>{const r={emit:i=>{t===""&&fL();const s=new CustomEvent(t,{detail:i,cancelable:!0,bubbles:!0,composed:!0,...e});return n.el.dispatchEvent(s),s}};return t===""&&Znt(void 0,i=>t=i.key,r),r},uLt=Jnt.bind(null,"");var Z_e;Z_e=tH;class Qnt{constructor(e){this.#n=[],this.#e=[],this.#r=[],this.#l=[],this.#c=[],this.#u=[],this.#h=[],this.#d=[],this.#o=[],this.#a=!1,this.P=new dA,this.connectedCalled=!1,this.loadedCalled=!1,this[Z_e]=!0,this.#s=[];const n=this,r=e??uL();n.#t=r,n.ready=n.P.promise,n.#i=yie(n),n.component=r,n.#t.addController(n),n.#t.manager===void 0||(wnt(n),queueMicrotask(()=>n.catchUpLifecycle()))}#n;#e;#r;#l;#c;#u;#h;#d;#o;#a;#t;catchUpLifecycle(){const{manager:e}=this.#t;e.connectedCalled&&!this.connectedCalled&&this.triggerConnected(),e.#a&&this.triggerLoad().then(()=>e.loadedCalled&&this.triggerLoaded()).catch(console.error)}#i;get exports(){return this.#i}set exports(e){const n=this.#i;n!==e&&(this.#i=e,this.#s.forEach(Mi),this.connectedCalled&&this.O!==!1&&this.#t.requestUpdate(this.O,n)),this.P.resolve(e)}setProvisionalExports(e,n=!0){this.#i=n?yie(e):e,this.#s.forEach(Mi)}#s;watchExports(e){const n=()=>e(this.#i);return this.#s.push(n),()=>{this.#s.splice(this.#s.indexOf(n),1)}}get use(){return US(this.#t),Snt}get useRef(){return US(this.#t),Tnt}get useRefSync(){return US(this.#t),nH}controllerRemoved(){this.#t.el.isConnected&&this.triggerDisconnected(),this.triggerDestroy()}onConnected(e){this.#n.push(e)}onDisconnected(e){this.#e.push(e)}onLoad(e){this.#r.push(e)}onLoaded(e){this.#l.push(e)}onUpdate(e){this.#c.push(e)}onUpdated(e){this.#u.push(e)}onDestroy(e){this.#h.push(e)}onLifecycle(e){this.#d.push(e),this.connectedCalled&&this.#t.el.isConnected&&this.#f(e)}triggerConnected(){const e=this;e.hostConnected&&Mi(e.hostConnected,e),e.#n.forEach(Mi),e.triggerLifecycle(),e.connectedCalled=!0}triggerDisconnected(){const e=this;e.hostDisconnected&&Mi(e.hostDisconnected,e),e.#e.forEach(Mi),e.#o.forEach(Mi),e.#o=[]}async triggerLoad(){if(this.#a)return;this.#a=!0;const e=this;e.hostLoad&&await ZV(e.hostLoad,e),this.#r.length>0&&await Promise.allSettled(this.#r.map(ZV)),this.P.resolve(this.#i)}triggerLoaded(){this.loadedCalled||(this.hostLoaded&&Mi(this.hostLoaded,this),this.#l.forEach(Mi),this.loadedCalled=!0)}triggerUpdate(e){this.hostUpdate&&Mi(this.hostUpdate,this,e),this.#c.forEach(gie,e)}triggerUpdated(e){this.hostUpdated&&Mi(this.hostUpdated,this,e),this.#u.forEach(gie,e)}triggerDestroy(){this.hostDestroy&&Mi(this.hostDestroy,this),this.#h.forEach(Mi)}triggerLifecycle(){this.hostLifecycle&&this.#f(()=>this.hostLifecycle()),this.#d.forEach(this.#f,this)}#f(e){US(this.#t);const n=Mi(e);(Array.isArray(n)?n:[n]).forEach(i=>{typeof i=="function"?this.#o.push(i):typeof i=="object"&&typeof i.remove=="function"&&this.#o.push(i.remove)})}}function gie(t){Mi(t,void 0,this)}const ert=Qnt,yie=t=>{if(typeof t!="object"&&typeof t!="function"||t===null)return t;const e={get(r,i,s){if(!((i==="exports"||i==="_exports")&&i in r&&r[i]===n)&&(i in r||i in Promise.prototype||typeof i=="symbol"))return typeof r=="function"?r[i]:Reflect.get(r,i,s)}},n=new Proxy(t,e);return n},trt=t=>t.replace(nrt,(e,n)=>`${n===0?"":"-"}${e.toLowerCase()}`),nrt=/[A-Z]+(?![a-z])|[A-Z]/gu,rrt=1,irt=2,srt=4,ort=8,art=16,lrt=32,crt=64,J_e=t=>{let e=t;for(;e=e.parentNode??e.host;)if(e?.constructor?.lumina){const n=e;return n.manager?.loadedCalled||(n.J??n._offspring).push(t),(n.I??n._postLoad).promise}return!1},vie={};function Q_e(){}const p3=Object.defineProperty,urt=globalThis.HTMLElement??Q_e;var sl,Bf,Hw,MA,ez;const Wq=class Wq extends urt{constructor(){var i;super();Ru(this,MA);Ru(this,sl);Ru(this,Bf);Ru(this,Hw);Mu(this,Bf,{}),Mu(this,Hw,[]),this.I=new dA,this.H=new dA,this.J=[];const n=this,r=n.constructor;n._offspring=n.J,n._postLoad=n.I,r.C?.forEach(s=>{Object.hasOwn(n,s)&&(Mr(n,Bf)[s]=n[s],delete n[s])}),r.A?pE(i=n,MA,ez).call(i,{a:r.A}):r.B.then(async s=>{var o;await r.K.p,pE(o=n,MA,ez).call(o,await(s.default?.then(a=>typeof a=="function"?{a}:a)??s))}).catch(s=>{n.H.reject(s),setTimeout(()=>{throw s})})}static F(){for(const n of this.C??[])p3(this.prototype,n,{configurable:!0,enumerable:!0,get(){return Mr(this,Bf)[n]},set(r){Mr(this,Bf)[n]=r}});for(const n of this.E??[])p3(this.prototype,n,{async value(...r){return Mr(this,sl)||await this.H.promise,await Mr(this,sl)[n](...r)},configurable:!0});for(const n of this.D??[])p3(this.prototype,n,{value(...r){return Mr(this,sl)[n](...r)},configurable:!0})}get manager(){return Mr(this,sl)?.manager}attributeChangedCallback(n,r,i){Mr(this,sl)?.attributeChangedCallback(n,r,i),Mr(this,sl)||Mr(this,Hw).push(n)}connectedCallback(){Mr(this,sl)?Mr(this,sl).connectedCallback?.():queueMicrotask(()=>this.G=J_e(this))}disconnectedCallback(){Mr(this,sl)?.disconnectedCallback?.()}async componentOnReady(){return await this.H.promise,this}addController(){}requestUpdate(){Mr(this,sl)?.requestUpdate()}};sl=new WeakMap,Bf=new WeakMap,Hw=new WeakMap,MA=new WeakSet,ez=function(n){const r=this.constructor,i=r.L,s=Mr(this,Bf),o=Object.values(n).find(f=>f.L===i),a=`${i}--lazy`;let l=o;for(;l&&!Object.hasOwn(l,"lumina");)l=Object.getPrototypeOf(l);drt(l),!r.A&&(r.A=o,customElements.define(a,o)),o.N=this;const u=document.createElement(a);o.N=void 0,Mu(this,sl,u),Mu(this,Bf,u),Mr(this,Hw).forEach(f=>u.attributeChangedCallback(f,null,this.getAttribute(f))),Object.entries(s).forEach(hrt,u);const h=this.isConnected;(h||this.G)&&(u.connectedCallback?.(),h||u.disconnectedCallback())},Wq.lumina=!0;let _ie=Wq;function hrt([t,e]){this[t]=e}const drt=t=>{const e=t.prototype,n=Element.prototype;Object.hasOwn(e,"isConnected")||(e.setAttribute=function(i,s){n.setAttribute.call(this.el,i,s)},e.removeAttribute=function(i){n.removeAttribute.call(this.el,i)},p3(e,"isConnected",{get(){return Reflect.get(n,"isConnected",this.el)}}))};const exe={ATTRIBUTE:1,CHILD:2,PROPERTY:3,BOOLEAN_ATTRIBUTE:4},txe=t=>(...e)=>({_$litDirective$:t,values:e});let nxe=class{constructor(e){}get _$AU(){return this._$AM._$AU}_$AT(e,n,r){this._$Ct=e,this._$AM=n,this._$Ci=r}_$AS(e,n){return this.update(e,n)}update(e,n){return this.render(...n)}};const frt=txe(class extends nxe{constructor(t){if(super(t),t.type!==exe.ATTRIBUTE||t.name!=="class"||t.strings?.length>2)throw Error("`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.")}render(t){return" "+Object.keys(t).filter(e=>t[e]).join(" ")+" "}update(t,[e]){if(this.st===void 0){this.st=new Set,t.strings!==void 0&&(this.nt=new Set(t.strings.join(" ").split(/\s/).filter(r=>r!=="")));for(const r in e)e[r]&&!this.nt?.has(r)&&this.st.add(r);return this.render(e)}const n=t.element.classList;for(const r of this.st)r in e||(n.remove(r),this.st.delete(r));for(const r in e){const i=!!e[r];i===this.st.has(r)||this.nt?.has(r)||(i?(n.add(r),this.st.add(r)):(n.remove(r),this.st.delete(r)))}return Wg}});const rxe="important",prt=" !"+rxe,mrt=txe(class extends nxe{constructor(t){if(super(t),t.type!==exe.ATTRIBUTE||t.name!=="style"||t.strings?.length>2)throw Error("The `styleMap` directive must be used in the `style` attribute and must be the only part in the attribute.")}render(t){return Object.keys(t).reduce((e,n)=>{const r=t[n];return r==null?e:e+`${n=n.includes("-")?n:n.replace(/(?:^(webkit|moz|ms|o)|)(?=[A-Z])/g,"-$&").toLowerCase()}:${r};`},"")}update(t,[e]){const{style:n}=t.element;if(this.ft===void 0)return this.ft=new Set(Object.keys(e)),this.render(e);for(const r of this.ft)e[r]==null&&(this.ft.delete(r),r.includes("-")?n.removeProperty(r):n[r]=null);for(const r in e){const i=e[r];if(i!=null){this.ft.add(r);const s=typeof i=="string"&&i.endsWith(prt);r.includes("-")||s?n.setProperty(r,s?i.slice(0,-11):i,s?rxe:""):n[r]=i}}return Wg}});class grt extends ert{constructor(e){super(e),this.destroyed=!1,this.R=!1,this.V=es,this.T=[],this.#r=new WeakMap,this.#e=e,this.exports=void 0,this.hasDestroy=tz in e&&typeof e.destroy=="function",vw.prototype.addController.call(e,{hostConnected:()=>{if(this.destroyed){const n=e.el.localName;throw e.el.remove(),new Error(`The ${n} component has already been destroyed. It cannot be used again. If you meant to disconnect and reconnect a component without automatic destroy, set the ${tz} prop.`)}this.#n!==void 0&&clearTimeout(this.#n),fL();for(const n of e.M)"triggerConnected"in n?n.triggerConnected():Mi(n.hostConnected,n)},hostDisconnected:()=>{for(const n of e.M)"triggerDisconnected"in n?n.triggerDisconnected():Mi(n.hostDisconnected,n);this.hasDestroy&&!this.destroyed&&this.U()},hostUpdate:()=>{for(const n of e.M)"triggerUpdate"in n?n.triggerUpdate(this.Q):Mi(n.hostUpdate,n,this.Q)},hostUpdated:()=>{for(const n of e.M)"triggerUpdated"in n?n.triggerUpdated(this.Q):Mi(n.hostUpdated,n,this.Q);this.Q=void 0}}),queueMicrotask(()=>this.R=!0),US(e)}#n;#e;async destroy(){if(!this.destroyed){this.#e.el.isConnected&&(this.hasDestroy=!1,this.#e.el.remove()),this.#n=void 0,this.destroyed=!0;for(const e of this.#e.M)"triggerDestroy"in e?e.triggerDestroy():Mi(e.hostDestroy,e);this.#e.M.splice(0)}}U(){if(this.#n!==void 0&&clearTimeout(this.#n),!this.#e.el.isConnected&&!this.#e.autoDestroyDisabled){const e=()=>{this.#e.destroy()};this.#n=qnt(e,yrt)}}S(e,n){const r=this.T;this.V=es,this.T=[],r.forEach(i=>i(e,n))}#r;W(e,n){(typeof n=="object"&&n!==null||typeof n=="function")&&this.#r.set(n,e)}X(e){if(typeof e=="object"&&e!==null||typeof e=="function")return this.#r.get(e)}}let yrt=1e3;const tz="autoDestroyDisabled";var Yy,NA,OA,Xy,ad,B2,ixe,sxe;const ak=class ak extends vw{constructor(){super();Ru(this,B2);Ru(this,Yy);Ru(this,NA);Ru(this,OA);Ru(this,Xy);Ru(this,ad);this.M=[],this.manager=new grt(this);const n=this,r=n.constructor,i=r.N,s=r.K.o,o=ak.prototype.shouldUpdate;Mu(n,Xy,i?.H??new dA),n.I=i?.I??new dA,n.J=i?.J??[],n._offspring=n.J,n._postLoad=n.I,n.el=i??n,Mu(n,OA,n.enableUpdating),n.enableUpdating=Q_e,n.shouldUpdate!==o&&(Mu(n,NA,n.shouldUpdate),n.shouldUpdate=o),s&&(Mu(n,Yy,new Map),r.elementProperties.forEach((a,l)=>Mr(n,Yy).set(l,s())))}static finalizeStyles(n){const r=super.finalizeStyles(n),i=this.shadowRootOptions===vie;return this.K?.commonStyles===void 0||i?r:[this.K.commonStyles,...r]}static createProperty(n,r){const i=typeof r=="number"?r:Array.isArray(r)?r[0]:0,s=Array.isArray(r)?r[1]:void 0,o=s?.hasChanged??sH,a={attribute:i&rrt&&typeof n=="string"?trt(n):!1,reflect:!!(i&irt),type:i&srt?Boolean:i&ort?Number:void 0,state:!!(i&art),readOnly:!!(i&lrt),noAccessor:!!(i&crt),c:!1,...s,hasChanged(l,c){const u=o(l,c);return a.c=u,u}};super.createProperty(n,a)}static getPropertyDescriptor(n,r,i){const s=this.K,o=super.getPropertyDescriptor(n,r,i);return i.d=o,{...o,get(){return s.t?.(Mr(this,Yy).get(n)),o.get?.call(this)},set(a){const l=this.manager;if(i.readOnly&&!JV&&(l.R||l.connectedCalled))throw Error(`Cannot assign to read-only property "${n}" of ${this.el.localName}. Trying to assign "${a}"`);o.set.call(this,a??void 0),i.c&&Mr(this,Yy)?.get(n)?.notify(),l.T.length>0&&(fL(),l?.S(n,a))}}}connectedCallback(){if(this.el.hasAttribute("defer-hydration"))return;const n=this.constructor.K.c?.(()=>this.requestUpdate());Mu(this,ad,n);const r=!this.manager.connectedCalled;super.connectedCallback(),r?queueMicrotask(()=>pE(this,B2,sxe).call(this).catch(i=>{Mr(this,Xy).reject(i),setTimeout(()=>{throw i})})):n&&this.requestUpdate()}disconnectedCallback(){super.disconnectedCallback(),Mr(this,ad)?.destroy(),Mu(this,ad,void 0)}createRenderRoot(){const n=this.el.shadowRoot,r=this.constructor,i=r.shadowRootOptions,o=n??(i===vie?this.el:this.el.attachShadow(i));if(this.isConnected){const a=o.getRootNode();a.adoptedStyleSheets=[...a.adoptedStyleSheets,...r.elementStyles.map(l=>"styleSheet"in l?l.styleSheet:l)]}return o}shouldUpdate(n){var r;return this.manager.Q=n,((r=Mr(this,NA))==null?void 0:r.call(this,n))??!0}update(n){Mr(this,ad)?pE(this,B2,ixe).call(this,n):super.update(n)}listen(n,r,i){const s=r?.bind(this)??r;this.manager.onLifecycle(()=>(this.el.addEventListener(n,s,i),()=>this.el.removeEventListener(n,s,i)))}listenOn(n,r,i,s){const o=i?.bind(this)??i;this.manager.onLifecycle(()=>(n.addEventListener(r,o,s),()=>n.removeEventListener(r,o,s)))}async componentOnReady(){return await Mr(this,Xy).promise,this}addController(n){this.M.push(n),!(tH in n)&&this.renderRoot&&this.el.isConnected&&n.hostConnected?.()}removeController(n){this.M.splice(this.M.indexOf(n),1),n.controllerRemoved?.()}};Yy=new WeakMap,NA=new WeakMap,OA=new WeakMap,Xy=new WeakMap,ad=new WeakMap,B2=new WeakSet,ixe=function(n){try{Mr(this,ad).clear(),this.constructor.K.r(Mr(this,ad),()=>tX(ak.prototype,this,"update").call(this,n))}catch(r){throw Mr(this,ad).clear(),r}},sxe=async function(){const n=this.el.G??J_e(this.el);n&&await n;const r=[];for(const s of this.M)"triggerLoad"in s?r.push(s.triggerLoad()):r.push(ZV(s.hostLoad,s));await Promise.all(r),await this.load?.(),this.manager.hasDestroy&&this.manager.onUpdate(s=>s.has(tz)&&this.manager.U()),Mr(this,OA).call(this,!0),this.performUpdate(),this.I.resolve(),await Promise.resolve();const i=this.J.filter(s=>!s.manager?.loadedCalled);i.length&&await Promise.allSettled(i.map(async s=>await s.componentOnReady())),this.J.length=0,this.el.setAttribute(this.constructor.K.hydratedAttribute,"");for(const s of this.M)"triggerLoaded"in s?s.triggerLoaded():Mi(s.hostLoaded,s);this.loaded?.(),Mr(this,Xy).resolve()},ak.lumina=!0;let xie=ak;const vrt=t=>{let e;const n=i=>{e=new URL(i,globalThis.location?.href||void 0).href},r={...t,getAssetPath(i){const s=new URL(i,e);return s.origin!==globalThis.location?.origin?s.href:s.pathname},setAssetPath:n,customElement(i,s){s.K=r,s.L=i,customElements.get(i)||customElements.define(i,s)}};return n(t.defaultAssetPath),r},dLt=t=>typeof t=="object"&&t!=null?frt(t):t,fLt=t=>typeof t=="object"&&t!=null?mrt(t):t,pLt=es;function mLt(t,e,n){n==null?t.removeAttribute(e):t.setAttribute(e,n)}const gLt={toAttribute:t=>t===!0?"":t===!1?null:t},_rt="calcite-mode-auto",xrt="calcite-mode-dark",yLt={rtl:"calcite--rtl"},vLt={filter:250,nextTick:0,resize:150,reposition:100},_Lt=25;function wie(){const{classList:t}=document.body,e=window.matchMedia("(prefers-color-scheme: dark)").matches,n=()=>t.contains(xrt)||t.contains(_rt)&&e?"dark":"light",r=o=>document.body.dispatchEvent(new CustomEvent("calciteModeChange",{bubbles:!0,detail:{mode:o}})),i=o=>{s!==o&&r(o),s=o};let s=n();r(s),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",o=>i(o.matches?"dark":"light")),new MutationObserver(()=>i(n())).observe(document.body,{attributes:!0,attributeFilter:["class"]})}const $T=globalThis.calciteConfig,xLt=$T?.focusTrapStack||[],wLt=$T?.logLevel||"info",bie="3.3.3",wrt="2025-10-08",brt="7391af08e";function Ert(){if($T&&$T.version)return;console.info(`Using Calcite Components ${bie} [Date: ${wrt}, Revision: ${brt}]`);const t=$T||globalThis.calciteConfig||{};Object.defineProperty(t,"version",{value:bie,writable:!1}),globalThis.calciteConfig=t}document.readyState==="interactive"?wie():document.addEventListener("DOMContentLoaded",wie,{once:!0});queueMicrotask(Ert);const Srt=vrt({defaultAssetPath:"https://js.arcgis.com/calcite-components/3.3.3/",hydratedAttribute:"calcite-hydrated"}),{customElement:bLt,getAssetPath:ELt,setAssetPath:Trt}=Srt;let oxe=!1;const krt=t=>{oxe=!0,Trt(t)};let axe;function Art(){oxe||krt(eu(Hi(axe)))}function cH(t){const e=[];for(const n of Object.keys(t))customElements.get(`calcite-${n}`)||e.push(t[n]?.());return e.length>0?Promise.all(e):null}axe="components/assets";const lxe=Symbol("widget"),cxe=Symbol("widget-test-data"),Irt=[],Prt={},PN=new WeakMap;function uxe(t,e){let n=e.children;if(n?.length)for(let i=0;i<n.length;++i)n[i]=uxe(t,n[i]);else n=Irt;const r=e.vnodeSelector;if(CN(r)){const i=e.properties||Prt,s=i.key||r,o={key:s,afterCreate:Crt,afterUpdate:Rrt,afterRemoved:hxe,parentWidget:t,widgetConstructor:r,widgetProperties:{...i,key:s,children:n}};return{vnodeSelector:r.vnodeSelector,properties:o,children:void 0,text:void 0,domNode:null}}return e}function Crt(t,e,n,{parentWidget:r,widgetConstructor:i,widgetProperties:s}){const o=new i(s);o.container=t,PN.set(t,o),o.afterCreate?.(o,t),r.addHandles(Zn(()=>hxe(t))),queueMicrotask(()=>{o[cxe].projector?.renderNow()})}function Rrt(t,e,n,{widgetProperties:r}){const i=PN.get(t);i&&(i.set(r),i.afterUpdate?.(i,t))}function hxe(t){const e=PN.get(t);e&&(e.afterRemoved?.(e,t),e.destroy(),PN.delete(t))}function CN(t){return typeof t=="function"&&t[lxe]}const Eie=new Set;function Mrt(t){Eie.add(t),t.finally(()=>Eie.delete(t))}function Nrt(t){return Zn()}var Sie;let Ort=0;function dxe(t,e){const n=Object.prototype.hasOwnProperty;for(const r in e)n.call(e,r)&&n.call(t,r)&&(t[r]!=null&&e[r]!=null&&typeof t[r]=="object"&&typeof e[r]=="object"?dxe(t[r],e[r]):t[r]=e[r]);return t}const Lrt=_nt({postProcessProjectionOptions(t){const e=t.eventHandlerInterceptor,n=/capture$/i;t.eventHandlerInterceptor=(r,i,s,o)=>{const a=e?.(r,i,s,o),l=n.test(r);if(!((r=r.replace(n,"")).toLowerCase()in s)||l){const c=r[2].toLowerCase()+r.slice(3),u=g=>a?.call(s,g);s.addEventListener(c,u,l);const h=()=>s.removeEventListener(c,u,l),f=o.afterRemoved;o.afterRemoved=g=>{f?.(g),h()}}return a}},handleInterceptedEvent(t,e,n,r){const{eventPhase:i,type:s}=r,o=i===Event.CAPTURING_PHASE;let a=`on${s}${o?"capture":""}`;const l=e.properties;(l&&a in l||(a=`on${s[0].toUpperCase()}${s.slice(1)}${o?"Capture":""}`,l&&a in l))&&(U_e(),t.scheduleRender(),l[a].call(l.bind||n,r))}});let M$=!1;var y1;let no=(y1=class extends jpe(vI){constructor(e,n){super(e,n),this._attached=!1,this._projector=Lrt,this._readyForTrueRender=!1,this.key=this,this.autoRenderingEnabled=!0,this._loadLocale=aje(async()=>{if(this._messageBundleProps?.length){const l=await Promise.allSettled(this._messageBundleProps.map(async({bundlePath:c,propertyName:u})=>{if(this.destroyed)return;let h=await vme(c);this.destroyed||(this.uiStrings&&Object.keys(this.uiStrings)&&(h=dxe(Ze(h),this.uiStrings)),this[u]=h)}));if(this.destroyed)return;for(const c of l)c.status==="rejected"&&kt.getLogger(this).error("widget-intl:locale-error",this.declaredClass,c.reason)}await this.loadLocale()}),this.addHandles(Nrt()),Art();const r="esri-widget-uid-"+AI(),i=this.render.bind(this);this._trackingTarget=new IO(()=>{this.autoRenderingEnabled&&this.scheduleRender()});const s=()=>({vnodeSelector:"div",properties:{key:`${r}-hidden`,class:"",styles:{display:"none"}},domNode:null,children:void 0,text:void 0}),o=()=>{if(!this._readyForTrueRender||this.destroyed)return null;const l=i()??s(),c=l.properties??={};if(c.key??=r,CN(l.vnodeSelector)){if(!this.visible)return s()}else this.visible?c.styles||(c.styles={}):(c.class="",c.styles={display:"none"}),c.styles.display??="";let u=0;return l.children?.forEach(h=>{CN(h.vnodeSelector)||(h.properties??={},h.properties.key??=`${this.id}--${u++}`)}),uxe(this,l)};this.render=()=>{if(M$)return o();let l=snt(this)??null;if(l)return l;this._trackingTarget.clear(),M$=!0;try{l=gp(this._trackingTarget,o)}catch(c){throw kt.getLogger(this).error(c),c}finally{M$=!1}return l&&ont(this,l),l};const a=this.beforeFirstRender();a?this._resourcesFetch=a.then(()=>{this.destroyed||(this._readyForTrueRender=!0,this._postInitialize())}):(this._resourcesFetch=Promise.resolve().then(()=>{this.destroyed||this._postInitialize()}),this._readyForTrueRender=!0),this.addResolvingPromise(this._resourcesFetch),Mrt(this._resourcesFetch)}normalizeCtorArgs(e,n){const r={...e};return n&&(r.container=n),r}postInitialize(){}beforeFirstRender(){const e=this.loadDependencies();return this._messageBundleProps?.length||e?Promise.all([e,this._loadLocale()]).then(()=>{}).catch(WQ):null}loadDependencies(){return null}loadLocale(){return null}destroy(){this.destroyed||(Di(this._trackingTarget),Di(this.viewModel),this._detach(this.container),this._set("container",null),this.render=()=>null,this._projector=null,I$(this))}set container(e){this._get("container")||this._set("container",e)}castContainer(e){return SW(e)}get destroyed(){return super.destroyed}get domNode(){return this.container}set domNode(e){this.container=e}get icon(){return null}set icon(e){this._overrideIfSome("icon",e)}get id(){return this._get("id")||this.container?.id||Date.now().toString(16)+"-widget-"+Ort++}set id(e){e&&this._set("id",e)}get label(){return this.declaredClass.split(".").pop()}set label(e){this._overrideIfSome("label",e)}get renderable(){return this._resourcesFetch}get visible(){return this._get("visible")}set visible(e){this._set("visible",e)}get[(Sie=lxe,cxe)](){return{projector:this._projector}}render(){throw new Error("not implemented")}scheduleRender(){this.destroyed||(I$(this),this._projector.scheduleRender())}classes(...e){return ant.apply(this,e)}renderNow(){I$(this),this._projector.renderNow()}_postInitialize(){if(this.destroyed)return;this.scheduleRender(),this._delegatedEventNames?.length&&this.addHandles(fn(()=>this.viewModel,(n,r)=>{r&&this.removeHandles("delegated-events"),n&&SO(n)&&this.addHandles(this._delegatedEventNames.map(i=>ob(n,i,s=>{this.emit(i,s)})),"delegated-events")},ra)),this.postInitialize();const e=async()=>{await this._loadLocale().catch(WQ),this.scheduleRender()};this.addHandles([mme(e),fn(()=>this.uiStrings,e)]),this.addHandles(wc(()=>this.container,n=>{this.destroyed||this._attach(n)},{initial:!0,once:!0}))}_attach(e){e&&(this._projector.merge(e,this.render),this._attached=!0)}_detach(e){this._attached&&(this._projector.detach(this.render),this._attached=!1),e?.parentNode?.removeChild(e)}},y1[Sie]=!0,y1.vnodeSelector="div",y1);x([E()],no.prototype,"_readyForTrueRender",void 0),x([E({value:null})],no.prototype,"container",null),x([qs("container")],no.prototype,"castContainer",null),x([E()],no.prototype,"icon",null),x([E()],no.prototype,"id",null),x([E()],no.prototype,"label",null),x([E()],no.prototype,"renderable",null),x([E()],no.prototype,"uiStrings",void 0),x([E()],no.prototype,"viewModel",void 0),x([E({value:!0})],no.prototype,"visible",null),x([E()],no.prototype,"key",void 0),x([E()],no.prototype,"children",void 0),x([E()],no.prototype,"afterCreate",void 0),x([E()],no.prototype,"afterUpdate",void 0),x([E()],no.prototype,"afterRemoved",void 0),no=x([ue("esri.widgets.Widget")],no);const pL=no,Drt=new Map;function jrt(t){return Drt.get(t)}function Tie(t,e){return t&&"copyright"in t&&(!e||typeof t.originOf=="function"&&t.originOf("copyright")==="user")}function $rt(t,e){return t.length!==e.length||t.some((n,r)=>n.text!==e[r].text)}function yR(t,e,n){!n||!e||t.find(r=>r.layerView===e&&r.text===n)||t.push({text:n,layerView:e})}function Frt(t){return t.type==="bing-maps"}const Hh=[];let mx=class extends Kt{constructor(t){super(t),this._clear=()=>{this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.removeHandles("suspension"),this.notifyChange("state")},this._pendingAttributions=new Set,this._fetchedAttributionData=new Map,this.items=new Ot,this.view=null,this._allLayerViewsChange=e=>{this.removeHandles("suspension"),this.removeHandles("visible-geometry-changed");const n=this.view?.allLayerViews;n&&(this.addHandles(n.map(r=>fn(()=>[r.suspended,r.layer?.attributionVisible],()=>this._updateAttributionItems())).toArray(),"suspension"),n.forEach(r=>{r.declaredClass==="esri.views.3d.layers.IntegratedMesh3DTilesLayerView3D"&&this.addHandles(r.on("visible-geometry-changed",()=>this._updateAttributionItems()),"visible-geometry-changed")})),e?.removed&&e.removed.forEach(r=>{this._pendingAttributions.delete(r),this._fetchedAttributionData.delete(r)}),this._updateAttributionItems()},this.addHandles([H1(()=>this.view?.allLayerViews,"change",e=>this._allLayerViewsChange(e),{onListenerAdd:()=>this._allLayerViewsChange(),onListenerRemove:this._clear}),wc(()=>this.view?.stationary===!0,()=>this._updateAttributionItems())])}destroy(){this.view=null,this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.items.removeAll()}get state(){return this.view?.ready?this._pendingAttributions.size>0?"loading":"ready":"disabled"}_updateAttributionItems(){const t=this.view,e=t?.allLayerViews;Hh.length=0;let n=!1,r=null;if(!t||!e)return void this._clear();e.forEach(s=>{if(s.suspended||!s.layer?.attributionVisible)return;const o=s.layer;if(Tie(o,"user"))return void yR(Hh,s,o.copyright);if(o.type==="integrated-mesh-3dtiles"&&o.hasGoogleUrl&&(n=!0,r=s),o.hasAttributionData){if(this._fetchedAttributionData.has(s)){const l=this._fetchedAttributionData.get(s);return void(l?yR(Hh,s,this._getDynamicAttribution(l,t,o)):Tie(o)&&yR(Hh,s,o.copyright))}return void this._fetchAttributionData(s)}const a="portalItem"in o?o.portalItem?.accessInformation:void 0;yR(Hh,s,a||o.copyright)});const i=e.find(s=>s.layer?.type==="integrated-mesh-3dtiles");if(this.view&&i){const s=jrt(this.view);if(s){const o=s.getAttributionText();for(let a=o.length-1;a>-1;--a)Hh.unshift({text:o[a],layerView:i})}}n&&r&&Hh.unshift({text:"Google Maps",layerView:r}),$rt(this.items,Hh)&&(this.items.removeAll(),this.items.addMany(Hh)),Hh.length=0,this.notifyChange("state")}async _fetchAttributionData(t){if(this._pendingAttributions.has(t))return;this._pendingAttributions.add(t);const e=await $pe(t.layer.fetchAttributionData());if(this._pendingAttributions.has(t)){const n=e.ok?this._createContributionIndex(e.value,Frt(t.layer)):null;this._pendingAttributions.delete(t),this._fetchedAttributionData.set(t,n)}this._updateAttributionItems()}_createContributionIndex(t,e){const n=t.contributors,r={};if(!n)return r;for(let i=0;i<n.length;i++){const s=n[i],o=s.coverageAreas;if(!o)return;for(const a of o){const l=a.bbox,c=a.zoomMin-(e&&a.zoomMin?1:0),u=a.zoomMax-(e&&a.zoomMax?1:0),h=new Vn({xmin:l[1],ymin:l[0],xmax:l[3],ymax:l[2],spatialReference:Bt.WGS84}),f={extent:i1(h),attribution:s.attribution||"",score:a.score!=null?a.score:100,id:i};for(let g=c;g<=u;g++)r[g]??=[],r[g].push(f)}}return r.maxKey=Math.max.apply(null,Object.keys(r)),r}_getDynamicAttribution(t,e,n){const{extent:r,scale:i}=e;let s=n.tileInfo?.scaleToZoom(i)??0;if(s=Math.min(t.maxKey??0,Math.round(s)),!r||s==null||s<=-1)return"";const o=t[s],a=DO(r.center.clone().normalize(),Bt.WebMercator),l=new Set;return o?o.filter(c=>{const u=c.id,h=!l.has(u)&&a&&c.extent&&wI(c.extent,a);return h&&l.add(u),h}).sort((c,u)=>u.score-c.score||c.objectId-u.objectId).map(c=>c.attribution).join(", "):""}};x([E({readOnly:!0,type:Ot})],mx.prototype,"items",void 0),x([E({readOnly:!0})],mx.prototype,"state",null),x([E()],mx.prototype,"view",void 0),mx=x([ue("esri.widgets.Attribution.AttributionViewModel")],mx);const fxe=mx,Id={button:"esri-button",buttonDisabled:"esri-button--disabled",buttonHalf:"esri-button--half",buttonSecondary:"esri-button--secondary",buttonSmall:"esri-button--small",buttonTertiary:"esri-button--tertiary",buttonThird:"esri-button--third",empty:"esri-widget__content--empty",heading:"esri-widget__heading",interactive:"esri-interactive",panel:"esri-widget--panel",table:"esri-widget__table",widget:"esri-widget",widgetButton:"esri-widget--button"};function Vrt(){return function(t,e){if(!t[e])throw new TypeError(`Cannot auto bind undefined function '${String(e)}'`);return{value:Grt(t[e])}}}function zrt(t){const e=t?.type;return t instanceof KeyboardEvent||e==="keyup"||e==="keydown"||e==="keypress"}function Grt(t){return function(e,...n){zrt(e)?cnt(e.key)&&(e.preventDefault(),e.stopPropagation(),e.target.click()):t.call(this,e,...n)}}function mL(t){return(e,n)=>{e.hasOwnProperty("_messageBundleProps")||(e._messageBundleProps=e._messageBundleProps?e._messageBundleProps.slice():[]),e._messageBundleProps.push({bundlePath:t,propertyName:n})}}var Urt=function(t){return{vnodeSelector:"",properties:void 0,children:void 0,text:t.toString(),domNode:null}},pxe=function(t,e){for(var n=0,r=t.length;n<r;n++){var i=t[n];Array.isArray(i)?pxe(i,e):i!=null&&i!==!1&&(i.hasOwnProperty("vnodeSelector")||(i=Urt(i)),e.push(i))}},Brt=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(n.length===1&&typeof n[0]=="string")return{vnodeSelector:t,properties:e||void 0,children:void 0,text:n[0],domNode:null};var i=[];return pxe(n,i),{vnodeSelector:t,properties:e||void 0,children:i,text:void 0,domNode:null}};function wl(t,e,...n){return typeof t!="function"||CN(t)?Brt(t,e??null,...n):t(e,...n)}function SLt(...t){return t}const M_="esri-attribution",N_={base:M_,poweredBy:`${M_}__powered-by`,sources:`${M_}__sources`,open:`${M_}--open`,sourcesOpen:`${M_}__sources--open`,link:`${M_}__link`};let Ta=class extends pL{constructor(e,n){super(e,n),this._isOpen=!1,this._attributionTextOverflowed=!1,this._prevSourceNodeHeight=0,this._sourcesNode=null,this._overflowRequestAnimationFrame=null,this._resizeObserver=new ResizeObserver(r=>{r.forEach(({target:i})=>{this._scheduleOverflowCheck(i)})}),this._mutationObserver=new MutationObserver(r=>{let i=!1;for(const s of r)if(s.type==="childList"||s.type==="characterData"||s.type==="attributes"){i=!0;break}i&&this._sourcesNode&&this._scheduleOverflowCheck(this._sourcesNode)}),this.itemDelimiter=" | ",this.messages=null,this.viewModel=new fxe}initialize(){this.addHandles(H1(()=>this.viewModel?.items,"change",()=>this.scheduleRender()))}destroy(){this._resizeObserver?.disconnect(),this._mutationObserver?.disconnect(),this._overflowRequestAnimationFrame!=null&&(cancelAnimationFrame(this._overflowRequestAnimationFrame),this._overflowRequestAnimationFrame=null)}get _isInteractive(){return this._isOpen||this._attributionTextOverflowed}_scheduleOverflowCheck(e){this._overflowRequestAnimationFrame==null&&(this._overflowRequestAnimationFrame=requestAnimationFrame(()=>{this._overflowRequestAnimationFrame=null,this._checkSourceTextOverflow(e)}))}get attributionText(){return this.viewModel.items.reduce((e,n)=>(e.includes(n.text)||e.push(n.text),e),[]).join(this.itemDelimiter)}get icon(){return"description"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){const e={[N_.open]:this._isOpen};return wl("div",{bind:this,class:this.classes(N_.base,Id.widget,e),dir:"ltr",onclick:this._toggleState,onkeydown:this._toggleState},this._renderSourcesNode(),this._renderPoweredBy())}_renderPoweredBy(){return wl("div",{class:N_.poweredBy},"Powered by"," ",wl("a",{class:N_.link,href:"https://www.esri.com/",rel:"noreferrer",target:"_blank"},"Esri"))}_renderSourcesNode(){const e=this._isOpen,n=this._isInteractive,r=n?0:void 0,{attributionText:i}=this,s={[N_.sourcesOpen]:e,[Id.interactive]:n};return wl("div",{afterCreate:this._afterSourcesNodeCreate,bind:this,class:this.classes(N_.sources,s),innerHTML:i,tabIndex:r})}_afterSourcesNodeCreate(e){this._prevSourceNodeHeight=e.clientWidth,this._sourcesNode=e,this._resizeObserver.observe(e),this._mutationObserver.observe(e,{subtree:!0,childList:!0,characterData:!0,attributes:!0}),this._scheduleOverflowCheck(e)}_checkSourceTextOverflow(e){let n=!1;const{clientHeight:r,clientWidth:i,scrollWidth:s}=e,o=s>i,a=this._attributionTextOverflowed!==o;if(this._attributionTextOverflowed=o,a&&(n=!0),this._isOpen){const l=r<this._prevSourceNodeHeight;this._prevSourceNodeHeight=r,l&&(this._isOpen=!1,n=!0)}n&&this.scheduleRender()}_toggleState(){this._isInteractive&&(this._isOpen=!this._isOpen)}};x([E()],Ta.prototype,"_isOpen",void 0),x([E()],Ta.prototype,"_isInteractive",null),x([E()],Ta.prototype,"_attributionTextOverflowed",void 0),x([E()],Ta.prototype,"_prevSourceNodeHeight",void 0),x([E({readOnly:!0,dependsOn:["viewModel.items.length","itemDelimiter"]})],Ta.prototype,"attributionText",null),x([E()],Ta.prototype,"icon",null),x([E()],Ta.prototype,"itemDelimiter",void 0),x([E()],Ta.prototype,"label",null),x([E(),mL("esri/widgets/Attribution/t9n/Attribution")],Ta.prototype,"messages",void 0),x([E()],Ta.prototype,"view",null),x([E({type:fxe})],Ta.prototype,"viewModel",void 0),x([Vrt()],Ta.prototype,"_toggleState",null),Ta=x([ue("esri.widgets.Attribution")],Ta);const Wrt=Ta;function Hrt(){const t=ye("mapview-essential-goto-duration");return t==null?t:t}function qrt(t){return t?.spatialReference?.isWebMercator||t?.spatialReference?.isGeographic||!1}function Krt(t,e,n){return t.goTo(e,n)}const Yrt=t=>{const e=t;let n=class extends e{constructor(...r){super(...r),this.goToOverride=null,this.view=null}callGoTo(r){const{view:i}=this;return Mfe(i),this.goToOverride?this.goToOverride(i,r):Krt(i,r.target,r.options)}};return x([E()],n.prototype,"goToOverride",void 0),x([E()],n.prototype,"view",void 0),n=x([ue("esri.widgets.support.GoTo")],n),n};let my=class extends Yrt(Kt){constructor(e){super(e),this.orientation={x:0,y:0,z:0},this.view=null,this._updateForCamera=this._updateForCamera.bind(this),this._updateForRotation=this._updateForRotation.bind(this),this._updateRotationWatcher=this._updateRotationWatcher.bind(this)}initialize(){this._watchForView(ya)}destroy(){this.view=null}get canShowNorth(){return qrt(this.view)}get state(){return!this.view?.ready||this.view.type==="2d"&&!this.view.constraints.rotationEnabled?"disabled":this.canShowNorth?"compass":"rotation"}reset(){this.view?.ready&&(this.view?.type==="2d"?this.callGoTo({target:{rotation:0},options:{animationMode:"always",duration:Hrt()}}):this.callGoTo({target:{heading:0}}))}_updateForRotation(e){e!=null&&this._set("orientation",{z:e})}_updateForCamera(e){if(!e)return;const n=-e.heading;this._set("orientation",{x:0,y:0,z:n})}_updateRotationWatcher(e){this.removeAllHandles(),this._watchForView(),e&&this.addHandles(e.type==="2d"?fn(()=>e?.rotation,this._updateForRotation,ya):fn(()=>e?.camera,this._updateForCamera,ya))}_watchForView(e){this.addHandles(fn(()=>this.view,this._updateRotationWatcher,e))}};x([E({readOnly:!0})],my.prototype,"canShowNorth",null),x([E({readOnly:!0})],my.prototype,"orientation",void 0),x([E({readOnly:!0})],my.prototype,"state",null),x([E()],my.prototype,"view",void 0),my=x([ue("esri.widgets.Compass.CompassViewModel")],my);const mxe=my,kie="esri-compass",Aie={base:kie,iconContainer:`${kie}__icon-container`};let If=class extends pL{constructor(e,n){super(e,n),this.messages=null,this.viewModel=new mxe,this._reset=()=>{this.viewModel.reset()},this._toRotationTransform=r=>({transform:`rotateZ(${r.z}deg)`})}loadDependencies(){return cH({button:()=>_e(()=>import("./index-BMpr3Wtw.js"),__vite__mapDeps([401,402,403,404,405,406,407,408,409,410,411,412,413,414])),icon:()=>_e(()=>import("./index-D0g0MaDH.js").then(e=>e.i),__vite__mapDeps([406,407,408]))})}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get icon(){return this.viewModel.state==="rotation"?"arrow-up":"compass-needle"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}reset(){return this.viewModel.reset()}render(){const{orientation:e,state:n}=this.viewModel,{messages:r}=this;return wl("div",{class:this.classes(Aie.base,Id.widget)},wl("calcite-button",{class:Id.widgetButton,disabled:n==="disabled",kind:"neutral",label:r.reset,onclick:this._reset,round:!0,scale:"s",title:r.reset},wl("div",{"aria-hidden":"true",class:Aie.iconContainer,title:r.reset},wl("calcite-icon",{icon:this.icon,styles:this._toRotationTransform(e)}))))}};x([E()],If.prototype,"goToOverride",null),x([E()],If.prototype,"icon",null),x([E()],If.prototype,"label",null),x([E(),mL("esri/widgets/Compass/t9n/Compass")],If.prototype,"messages",void 0),x([E()],If.prototype,"view",null),x([E({type:mxe})],If.prototype,"viewModel",void 0),If=x([ue("esri.widgets.Compass")],If);const Xrt=If,Iie="esri-navigation-toggle",Pie={base:Iie,isLayoutHorizontal:`${Iie}--horizontal`};let gx=class extends Kt{constructor(t){super(t),this._navigationMode="pan",this.view=null,t?.isDefaultViewModel||$je(kt.getLogger(this),"Navigation Toggle","arcgis-navigation-toggle",{version:"4.33"})}normalizeCtorArgs(t={}){const{isDefaultViewModel:e,...n}=t;return n}initialize(){this.addHandles(wc(()=>this.view?.navigation?.actionMap,()=>this._updateNavigationActionMap()))}destroy(){this.view=null}get state(){return this.view?.ready&&this.view?.type==="3d"?"ready":"disabled"}get navigationMode(){return this._navigationMode}set navigationMode(t){this._navigationMode=t,this._updateNavigationActionMap()}toggle(){this.state!=="disabled"&&(this.navigationMode=this.navigationMode!=="pan"?"pan":"rotate")}_updateNavigationActionMap(){const t=this.view?.navigation?.actionMap;if(!t)return;const e=this._navigationMode==="pan";t.dragPrimary=e?"pan":"rotate",t.dragSecondary=e?"rotate":"pan"}};x([E({readOnly:!0})],gx.prototype,"state",null),x([E()],gx.prototype,"_navigationMode",void 0),x([E()],gx.prototype,"view",void 0),gx=x([ue("esri.widgets.NavigationToggle.NavigationToggleViewModel")],gx);const gxe=gx;let Pf=class extends pL{constructor(e,n){super(e,n),this.messages=null,this.viewModel=new gxe({isDefaultViewModel:!0}),this.toggle=()=>this.viewModel.toggle(),this._panButton=null,this._rotateButton=null,this._toggle=()=>{const r=this.viewModel?.navigationMode==="pan"?this._rotateButton:this._panButton;unt(r),this.toggle()},e?.isDefaultUI||jje(kt.getLogger(this),"Navigation Toggle","arcgis-navigation-toggle",{version:"4.32"})}normalizeCtorArgs(e={}){const{isDefaultUI:n,...r}=e;return r}loadDependencies(){return cH({button:()=>_e(()=>import("./index-BMpr3Wtw.js"),__vite__mapDeps([401,402,403,404,405,406,407,408,409,410,411,412,413,414]))})}get icon(){return"move"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}set layout(e){e!=="horizontal"&&(e="vertical"),this._set("layout",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){const e=this.viewModel?.state==="disabled",n=this.viewModel?.navigationMode==="pan",r=this.messages.toggle;return wl("div",{class:this.classes(Pie.base,Id.widget,{[Pie.isLayoutHorizontal]:this.layout==="horizontal"})},wl("calcite-button",{afterCreate:i=>{this._panButton=i},appearance:n?"outline-fill":"solid",class:Id.widgetButton,disabled:e,iconStart:"move",kind:"neutral",label:r,onclick:this._toggle,tabIndex:n?void 0:-1,title:r}),wl("calcite-button",{afterCreate:i=>{this._rotateButton=i},appearance:n?"solid":"outline-fill",class:Id.widgetButton,disabled:e,iconStart:"rotate",kind:"neutral",label:r,onclick:this._toggle,tabIndex:n?-1:void 0,title:r}))}};x([E()],Pf.prototype,"icon",null),x([E()],Pf.prototype,"label",null),x([E({value:"vertical"})],Pf.prototype,"layout",null),x([E(),mL("esri/widgets/NavigationToggle/t9n/NavigationToggle")],Pf.prototype,"messages",void 0),x([E()],Pf.prototype,"view",null),x([E({type:gxe})],Pf.prototype,"viewModel",void 0),Pf=x([ue("esri.widgets.NavigationToggle")],Pf);const Zrt=Pf;let gy=class extends Kt{get canZoomIn(){if(!this.view?.ready)return!1;const n=this.view?.constraints?.effectiveMaxScale;return n===0||this._scale>n}get canZoomOut(){const{view:e}=this;if(!e?.ready)return!1;const r=e.constraints?.effectiveMinScale;return r===0||this._scale<r}get _scale(){const e=this.view?.animation?.target;return(e&&"then"in e?void 0:e?.scale)??this.view?.scale??0}};x([E({readOnly:!0})],gy.prototype,"canZoomIn",null),x([E({readOnly:!0})],gy.prototype,"canZoomOut",null),x([E()],gy.prototype,"view",void 0),x([E()],gy.prototype,"_scale",null),gy=x([ue("esri.widgets.Zoom.ZoomConditions2D")],gy);const Jrt=gy;let yx=class extends Kt{get canZoomIn(){return!!this.view.ready}get canZoomOut(){return!!this.view.ready}};x([E({readOnly:!0})],yx.prototype,"canZoomIn",null),x([E({readOnly:!0})],yx.prototype,"canZoomOut",null),x([E()],yx.prototype,"view",void 0),yx=x([ue("esri.widgets.Zoom.ZoomConditions3D")],yx);const Qrt=yx;let Cm=class extends Kt{constructor(e){super(e)}destroy(){this.view=null}get canZoomIn(){return this._zoomConditions!=null&&this._zoomConditions.canZoomIn}get canZoomOut(){return this._zoomConditions!=null&&this._zoomConditions?.canZoomOut}get state(){return this.view?.ready?"ready":"disabled"}set view(e){e?e.type==="2d"?this._zoomConditions=new Jrt({view:e}):e.type==="3d"&&(this._zoomConditions=new Qrt({view:e})):this._zoomConditions=null,this._set("view",e)}zoomIn(){const e=this.view;this.canZoomIn&&e&&(e.type==="2d"?e.mapViewNavigation.zoomIn():M4(e.goTo({zoomFactor:2})))}zoomOut(){const e=this.view;this.canZoomOut&&e&&(e.type==="2d"?e.mapViewNavigation.zoomOut():M4(e.goTo({zoomFactor:.5})))}};x([E()],Cm.prototype,"_zoomConditions",void 0),x([E()],Cm.prototype,"canZoomIn",null),x([E()],Cm.prototype,"canZoomOut",null),x([E({readOnly:!0})],Cm.prototype,"state",null),x([E()],Cm.prototype,"view",null),Cm=x([ue("esri.widgets.Zoom.ZoomViewModel")],Cm);const yxe=Cm,Cie={base:"esri-zoom",horizontalLayout:"esri-zoom--horizontal"};let Cf=class extends pL{constructor(e,n){super(e,n),this.messages=null,this.viewModel=new yxe,this.zoomIn=()=>this.viewModel.zoomIn(),this.zoomOut=()=>this.viewModel.zoomOut()}loadDependencies(){return cH({button:()=>_e(()=>import("./index-BMpr3Wtw.js"),__vite__mapDeps([401,402,403,404,405,406,407,408,409,410,411,412,413,414]))})}get icon(){return"magnifying-glass-plus"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}set layout(e){e!=="horizontal"&&(e="vertical"),this._set("layout",e)}set view(e){this.viewModel.view=e}get view(){return this.viewModel.view}render(){const e={[Cie.horizontalLayout]:this.layout==="horizontal"},{canZoomIn:n,canZoomOut:r}=this.viewModel,{zoomIn:i,zoomOut:s}=this.messages;return wl("div",{class:this.classes(Cie.base,Id.widget,e)},wl("calcite-button",{class:Id.widgetButton,disabled:!n,iconStart:"plus",kind:"neutral",label:i,onclick:this.zoomIn,title:i}),wl("calcite-button",{class:Id.widgetButton,disabled:!r,iconStart:"minus",kind:"neutral",label:s,onclick:this.zoomOut,title:s}))}};x([E()],Cf.prototype,"icon",null),x([E()],Cf.prototype,"label",null),x([E({value:"vertical"})],Cf.prototype,"layout",null),x([E(),mL("esri/widgets/Zoom/t9n/Zoom")],Cf.prototype,"messages",void 0),x([E()],Cf.prototype,"view",null),x([E({type:yxe})],Cf.prototype,"viewModel",void 0),Cf=x([ue("esri.widgets.Zoom")],Cf);const eit=Cf;function tit(t){return t?.view!==void 0}let m3=class extends fnt{constructor(t){super(t),this._defaultPositionLookup={attribution:"manual",compass:"top-left","navigation-toggle":"top-left",zoom:"top-left"},this.components=[],this._updateViewAwareWidgets=e=>{this.components.forEach(n=>{const r=this._find(n),i=r?.widget;tit(i)&&(i.view=e)})},this._componentsWatcher=(e,n)=>{this._removeComponents(n),this._addComponents(e),this._adjustPadding(e)}}initialize(){this.addHandles([fn(()=>this.components,this._componentsWatcher,ya),fn(()=>this.view,this._updateViewAwareWidgets,ya)])}_add(t,e,n,r,i){let s=t;if(typeof t=="string"&&this._defaultPositionLookup[t]){if(this._find(t))return;s=this._createComponent(t)}super._add(s,e,n,r,i)}_removeComponents(t){t.forEach(e=>{const n=this._find(e);n&&(this.remove(n),n.destroy())})}_adjustPadding(t){if(!t.includes("attribution")&&!this._isOverridden("padding")){const{top:e}=this.padding;this.padding=e}}_addComponents(t){this.constructed&&t.forEach(e=>this.add(this._createComponent(e),this._defaultPositionLookup[e]))}_createComponent(t){const e=this._createWidget(t);return new d3({id:t,node:e})}_createWidget(t){const e=this.view;switch(t){case"attribution":return new Wrt({view:e});case"compass":return new Xrt({view:e});case"navigation-toggle":return new Zrt({view:e,isDefaultUI:!0});case"zoom":return new eit({view:e})}}};x([E()],m3.prototype,"components",void 0),m3=x([ue("esri.views.ui.DefaultUI")],m3);const vxe=m3;let g3=class extends vxe{constructor(e){super(e),this.components=["attribution","zoom"]}};x([E()],g3.prototype,"components",void 0),g3=x([ue("esri.views.ui.2d.DefaultUI2D")],g3);const _xe=g3;let nit=class{constructor(t={},e={},n=8,r=1/0){this.disabledExtensions=t,this.debugWebGLExtensions=e,this.maxAnisotropy=n,this.maxPreferredTexturePixels=r}},rit=class nz{constructor(e,n,r=""){this.major=e,this.minor=n,this._context=r}lessThan(e,n){return this.major<e||e===this.major&&this.minor<n}greaterEqual(e,n){return!this.lessThan(e,n)}validate(e){if(this.major!==e.major){const n=this._context&&this._context+":",r=this._context&&this._context+" ";throw new Xe(n+"unsupported-version",`Required major ${r}version is '${this.major}', but got '\${version.major}.\${version.minor}'`,{version:e})}}clone(){return new nz(this.major,this.minor,this._context)}static parse(e,n=""){const[r,i]=e.split("."),s=/^\s*\d+\s*$/;if(!r?.match||!s.test(r))throw new Xe((n&&n+":")+"invalid-version","Expected major version to be a number, but got '${version}'",{version:e});if(!i?.match||!s.test(i))throw new Xe((n&&n+":")+"invalid-version","Expected minor version to be a number, but got '${version}'",{version:e});const o=parseInt(r,10),a=parseInt(i,10);return new nz(o,a,n)}};class iit extends rit{constructor(e,n){super(e,n,"webmap")}}function N$(t){return t!=null&&typeof t=="object"&&"declaredClass"in t&&t.declaredClass==="esri.WebMap"}new iit(2,35);var rz;let y3=rz=class extends qt{constructor(t){super(t),this.color=new Jn([0,0,0,1])}clone(){return new rz(Ze({color:this.color}))}};x([E({type:Jn,json:{write:!0}})],y3.prototype,"color",void 0),y3=rz=x([ue("esri.webmap.background.ColorBackground")],y3);const sit=y3;let xxe,wxe,bxe,Exe,Sxe,Txe,kxe;async function oit(){const[,{GraphicsView2D:t,GraphicContainer:e,LabelManager:n,MapViewNavigation:r,MagnifierView2D:i,GridView2D:s,Stage:o}]=await Promise.all([_e(()=>import("./webglDeps-DLts60pU.js"),__vite__mapDeps([297,222,298,299,300,26,94])),_e(()=>import("./mapViewDeps-B3twslwA.js"),__vite__mapDeps([301,173,53,54,138,139,129,64,26,140,131,132,137,141,125,142,87,302,303,222,298,299,213,126,304,133,300,94,221,93,305,124,161,306,249,192,195,66,67,31,134,146,307,143,144,308,83,78,127,76,77,309,51,297,310,156,311,312,191,313,211,212,314,111,123,128,130,122,71,70,315,145,316,136,45,46,47,317,147,152,120,318,319,320,321,218,252,322,323]))]);wxe=t,bxe=e,Exe=n,Sxe=r,Txe=i,kxe=s,xxe=o}var qw;let Gn=(qw=class extends UQe(xJe(qWe(vqe(nqe(BXe))))){get timeZone(){return super.timeZone}set timeZone(e){super.timeZone=e}constructor(e){super(e),this._magnifierView=null,this._gridView=null,this.stage=null,this._resolveWhenReady=[],this.rootLayerViews=new th({getCollections:()=>[this.basemapView?.baseLayerViews,this.layerViews,this.basemapView?.referenceLayerViews],getChildrenFunction:()=>null}),this.featuresTilingScheme=null,this.graphicsView=null,this.labelManager=null,this.navigation=new iL({actionMap:new GW({dragTertiary:"none"})}),this.renderingOptions={samplingMode:"dynamic",edgeLabelsVisible:!0,labelsAnimationTime:125,labelCollisionsEnabled:!0},this.supersampleScreenshotsEnabled=!0,this.analyses=new M2,this.analysisViewManager=new ztt({importAnalysisViewModule:n=>Oet(n),view:this}),this.floors=new Ot,this.grid=null,this.map=null,this.timeline=new F_e,this.type="2d",this.view2dType=null,this.ui=new _xe,this.animationsEnabled=!0,this.test={takeScreenshot:async n=>Dtt(this._getScreenshotView(n),n)},this.padding={top:0,right:0,bottom:0,left:0},BWe()}destroy(){this.layerViewManager.clear(),this._set("preconditionsReady",!1),this.frameTask=Di(this.frameTask),this.goToManager.destroy(),this.rootLayerViews.destroy(),this.inputManager.destroy(),this._set("inputManager",null)}get graphicsTileStore(){return new Bet(this.featuresTilingScheme)}get constraintsInfo(){const e=this.defaultsFromMap?.tileInfo,n=this.spatialReference;return{lods:e?.spatialReference?.equals(n)?e.lods:null,spatialReference:n}}get initialExtentRequired(){if(!this.stateManager)return!1;const{scale:e,constraints:n,center:r,viewpoint:i,extent:s}=this;let o=this.zoom;return!(this.map&&"initialViewProperties"in this.map&&this.map.initialViewProperties?.viewpoint)&&!s&&(n?.effectiveLODs||(o=-1),(!r||e===0&&o===-1)&&(i?.targetGeometry==null||i.targetGeometry.type!=="extent"&&!i.scale))}get defaultsFromMapSettings(){return{required:{extent:!1,heightModelInfo:!1,tileInfo:!0},requiresExtentInSpatialReference:this.spatialReferenceLocked}}get scheduler(){return this.frameTask.scheduler}get typeSpecificPreconditionsReady(){const e=this._getDefaultViewpoint();if(!e)return!1;const n=e.targetGeometry,r=this.spatialReference;return H0e(n.spatialReference,r)}get background(){return N$(this.map)?this.map.initialViewProperties.background:null}set background(e){this._override("background",e)}get center(){return this.stateManager?.center??null}set center(e){this.stateManager.center=e}get constraints(){return super.constraints}set constraints(e){super.constraints=e}get highlightOptions(){return xtt(this)}set highlightOptions(e){wtt(this,e)}get padding(){return this.stateManager?.padding}set padding(e){this.stateManager&&(this.stateManager.padding=e)}get rendering(){return this.stage?.renderRequested??!1}get resizeAlign(){return super.resizeAlign}set resizeAlign(e){super.resizeAlign=e}get resolution(){return this.stateManager.resolution??0}get rotation(){return super.rotation}set rotation(e){super.rotation=e}get scale(){return this.stateManager?.scale??0}set scale(e){this.stateManager&&(this.stateManager.scale=e)}get spatialReference(){return super.spatialReference}set spatialReference(e){super.spatialReference=e}get spatialReferenceLocked(){return this._get("spatialReferenceLocked")}set spatialReferenceLocked(e){this.stage&&kt.getLogger(this).warn("spatialReferenceLocked cannot be changed after the view has become ready"),this._set("spatialReferenceLocked",e)}get tileInfo(){return this.featuresTilingScheme?.tileInfo}get updating(){const e=!(!this.magnifier.visible||this.magnifier.position===null||!this._magnifierView?.updatingHandles.updating),n=!this.destroyed&&(!this.analysisViewManager||!this.layerViewManager||!this.labelManager||!this.graphicsView||this.analysisViewManager.updating===!0||this.layerViewManager.updating===!0||this.labelManager.updating===!0||this.graphicsView.updating===!0||this.allLayerViews.some(r=>!r.destroyed&&!("layerViews"in r)&&r.updating===!0)||e);if(ye("esri-2d-log-updating")){const r=this.allLayerViews.reduce((i,s)=>({...i,[`${s.layer.id}(${s.layer.type})`]:!s.destroyed&&!("layerViews"in s)&&s.updating}),{});console.log(`Updating MapView: ${n}
-> Null LayerViewManager: ${!this.layerViewManager}
-> Null LabelManager: ${!this.labelManager}
-> Null GraphicsView: ${!this.graphicsView}
-> layerViewManager.updating: ${this.layerViewManager?.updating}
-> labelManager.updating: ${this.labelManager?.updating}
-> graphicsView.updating: ${this.graphicsView?.updating}
-> allLayerViews: ${JSON.stringify(r)}
-> updatingMagnifier: ${e}
`)}return n}get viewpoint(){return super.viewpoint}set viewpoint(e){super.viewpoint=e}get visibleArea(){const e=this.stateManager.visibleArea;return e&&new wi({rings:[e.map(n=>[n[0],n[1]])],spatialReference:this.spatialReference})}get zoom(){return this.stateManager.zoom??-1}set zoom(e){this.stateManager.zoom=e}get navigating(){return this.mapViewNavigation?.interacting??!1}async hitTest(e,n){return btt(this,e,n)}async takeScreenshot(e){return Ltt(this._getScreenshotView(e),e)}toScreen(e,n){return this.stateManager.toScreen(e,n)}async whenAnalysisView(e){if(e.parent==null)throw new Xe("view:no-analysisview-for-analysis","The analysis does not exist in view.analyses",{analysis:e});return this.analysisViewManager.whenAnalysisView(e)}whenLayerView(e){return super.whenLayerView(e)}graphicChanged(e){this.graphicsView&&this.graphicsView.graphicUpdateHandler(e)}whenReady(){return new Promise(e=>{this.ready?e(this):this._resolveWhenReady.push(e)})}forceDOMReadyCycle(){this.forceReadyCycle()}getDefaultSpatialReference(){return this.map&&"initialViewProperties"in this.map&&this.map.initialViewProperties.spatialReference||this.defaultsFromMap?.spatialReference||null}getDefaultTimeZone(){return N$(this.map)?this.map.initialViewProperties.timeZone:null}getDefaultTimeExtent(){return N$(this.map)?this.map.initialViewProperties.timeExtent:null}getSurface(){return this.surface}hasLayerViewModule(e){return Vre.hasLayerViewModule(e)}importLayerView(e){return Vre.importLayerView(e)}pixelSizeAt(){return this.ready?this.resolution:(kt.getLogger(this).error("#pixelSizeAt()","Map view cannot be used before it is ready"),null)}async popupHitTest(e){const n=this.toMap(e),r=await this.hitTest(e),i=this.allLayerViews.toArray().filter(c=>c.clips.every(u=>I_e(this,u,e,n))).reverse(),s=new globalThis.Map(i.map(c=>[c.layer.uid,c])),o=[];let a=0,l=0;for(;a<r.results.length||l<i.length;){const c=r.results.at(a);if(c&&c.type!=="graphic"){++a;continue}const u=s.get((c?.layer??c?.graphic.layer)?.uid);if((!c||u)&&l<i.length&&i.at(l)!==u){const h=i.at(l);"fetchPopupFeaturesAtLocation"in h&&o.push({mapPoint:n,layerView:h}),++l}else c&&(o.push({graphic:c.graphic,layerView:u}),++a)}return{hits:o,location:n}}requestUpdate(){this.ready&&this.frameTask.requestUpdate()}async validate(){let e=Ktt(this.type);if(ye("safari")&&ye("safari")<9&&(e=new Xe("mapview:browser-not-supported","This browser is not supported by MapView (Safari < 9)",{type:"safari",requiredVersion:9,detectedVersion:ye("safari")})),e!=null)throw kt.getLogger(this).warn("#validate()",e.message),e}loadAsyncDependencies(){return oit()}_getDefaultViewpoint(){const{constraints:e,initialExtent:n,map:r,padding:i,size:s}=this;if(!e)return null;const o=r&&"initialViewProperties"in r?r.initialViewProperties:void 0,a=this.stateManager.getUserStartupOptions(this.size),l=o?.viewpoint,c=l?.targetGeometry?.extent??n,u=c?.center,h=l?.rotation??0,f=l?.scale||c&&oL(c,[s[0]-i.left-i.right,s[1]-i.top-i.bottom]),g=a.center??u,y=a.rotation??h,_=a.scale??f;return g&&_?new du({targetGeometry:g,scale:_,rotation:y}):null}_startup(){this.timeline.begin("MapView Startup");const e=this._getDefaultViewpoint();this.stateManager.startup(e,this.size,this.spatialReference,this.defaultsFromMap.extent?.center),this.graphics.owner=this;const n=new Let(this.surface),r=new xxe(this.surface,{canvas:this.renderCanvas,contextOptions:new nit(this.deactivatedWebGLExtensions,this.debugWebGLExtensions),renderingOptions:this.renderingOptions,timeline:this.timeline},n);this.stage=r,this._magnifierView=new Txe,this._magnifierView.magnifier=this.magnifier,this._gridView=new kxe;const i=new Exe({view:this});this._set("labelManager",i);const s=new bet({view:this});this._set("animationManager",s);const o=new Sxe({view:this,animationManager:s});this._set("mapViewNavigation",o),this._setupSpatialReferenceDependentProperties(),this.addHandles([this.rootLayerViews.on("change",()=>this._updateStageChildren()),r.on("webgl-error",l=>this.fatalError=l.error),fn(()=>this.stationary,l=>r.stationary=l,ra),fn(()=>this.background,l=>{r.backgroundColor=l?.color,this._magnifierView.backgroundColor=l?.color},ra),fn(()=>this.magnifier,l=>this._magnifierView.magnifier=l,ra),fn(()=>this.grid,l=>this._gridView.grid=l,ra),fn(()=>this.renderingOptions,l=>r.renderingOptions=l,ra),fn(()=>this.highlights.items.map(l=>({name:l.name,options:{fillColor:l.color,haloColor:l.haloColor,fillOpacity:l.fillOpacity,haloOpacity:l.haloOpacity,haloWidth:l.haloWidth,haloBlur:l.haloBlur}})),()=>{r.highlightGradient=vtt(r.highlightGradient,this.highlights.items)},ra),fn(()=>this.state.id,()=>r.state=this.state,ra),fn(()=>this.animationsEnabled,l=>{this.stage.animationsEnabled=l},ra)],"map-view"),this._updateStageChildren();const a=this._resolveWhenReady;this._resolveWhenReady=[],a.forEach(l=>l(this)),this.timeline.end("MapView Startup"),this.frameTask.start(),this._set("ready",!0)}_teardown(){this._destroySpatialReferenceDependentProperties(),this.removeHandles("map-view"),this.mapViewNavigation.destroy(),this._set("mapViewNavigation",null),this.animation=null,this.animationManager.destroy(),this._set("animationManager",null),this.layerViewManager.clear(),this.labelManager.destroy(),this._magnifierView.destroy(),this._gridView.destroy(),this.stage.destroy(),this.stage=null,this._set("graphicsView",null),this._magnifierView=null,this._gridView=null,this._set("labelManager",null),this._set("mapViewNavigation",null),this.graphics.owner=null,this.frameTask.stop(),this.stationaryManager.clear(),this._set("ready",!1),this.stateManager.teardown()}_updateStageChildren(){this.stage.removeAllChildren(),this.rootLayerViews.forEach(n=>{this.stage.addChild(n.container)});const e=this.graphicsView;this.stage.addChild(e.container),this.stage.addChild(this._magnifierView),this.stage.addChild(this._gridView)}_setupSpatialReferenceDependentProperties(){const e=new Pet(Sa.create({spatialReference:this.spatialReference,size:512,numLODs:36}));this._set("featuresTilingScheme",e);const n=new wxe({view:this,graphics:this.graphics,requestUpdateCallback:()=>this.requestUpdate(),container:new bxe(e)});this._set("graphicsView",n)}_destroySpatialReferenceDependentProperties(){const e=this.graphicsView;this._set("graphicsView",null),e.destroy(),this._set("featuresTilingScheme",null)}_getScreenshotView(e){const{allLayerViews:n,padding:r,size:i,stage:s}=this;return{allLayerViews:n,backgroundColor:e?.ignoreBackground?null:this.background?.color,padding:r,size:i,stage:s}}_spatialReferenceChanged(e){if(this.ready){this.frameTask.stop();for(const n of this.allLayerViews)n.processDetach();this._destroySpatialReferenceDependentProperties(),this.stateManager.changeSpatialReference(e),this.stage.state=this.state,this._setupSpatialReferenceDependentProperties();for(const n of this.allLayerViews)n.processAttach();this.frameTask.requestFrame(),this.frameTask.start(),this._updateStageChildren()}}},qw.type="2d",qw);x([E({constructOnly:!0})],Gn.prototype,"deactivatedWebGLExtensions",void 0),x([E({constructOnly:!0})],Gn.prototype,"debugWebGLExtensions",void 0),x([E({readOnly:!0})],Gn.prototype,"featuresTilingScheme",void 0),x([E({readOnly:!0})],Gn.prototype,"graphicsTileStore",null),x([E()],Gn.prototype,"graphicsView",void 0),x([E()],Gn.prototype,"constraintsInfo",null),x([E()],Gn.prototype,"initialExtentRequired",null),x([E()],Gn.prototype,"labelManager",void 0),x([E({type:iL,nonNullable:!0})],Gn.prototype,"navigation",void 0),x([E({constructOnly:!0})],Gn.prototype,"renderCanvas",void 0),x([E()],Gn.prototype,"renderingOptions",void 0),x([E({constructOnly:!0})],Gn.prototype,"supersampleScreenshotsEnabled",void 0),x([E()],Gn.prototype,"defaultsFromMapSettings",null),x([E({readOnly:!0})],Gn.prototype,"typeSpecificPreconditionsReady",null),x([E(i7(M2,"analyses"))],Gn.prototype,"analyses",void 0),x([E()],Gn.prototype,"analysisViewManager",void 0),x([E({type:sit})],Gn.prototype,"background",null),x([E()],Gn.prototype,"center",null),x([E({type:Ot})],Gn.prototype,"floors",void 0),x([E()],Gn.prototype,"grid",void 0),x([E({type:Sg})],Gn.prototype,"highlightOptions",null),x([E()],Gn.prototype,"map",void 0),x([E()],Gn.prototype,"padding",null),x([E({readOnly:!0})],Gn.prototype,"rendering",null),x([E({readOnly:!0})],Gn.prototype,"resolution",null),x([E()],Gn.prototype,"scale",null),x([E({type:Boolean,value:!1})],Gn.prototype,"spatialReferenceLocked",null),x([E({readOnly:!0})],Gn.prototype,"tileInfo",null),x([E({type:F_e,readOnly:!0})],Gn.prototype,"timeline",void 0),x([E({readOnly:!0})],Gn.prototype,"type",void 0),x([E({readOnly:!0})],Gn.prototype,"updating",null),x([E({readOnly:!0})],Gn.prototype,"view2dType",void 0),x([E({readOnly:!0})],Gn.prototype,"visibleArea",null),x([E()],Gn.prototype,"zoom",null),x([E({readOnly:!0})],Gn.prototype,"navigating",null),x([E(),qs(t=>t instanceof vxe?t:PO(_xe,t))],Gn.prototype,"ui",void 0),x([E()],Gn.prototype,"animationsEnabled",void 0),Gn=x([ue("esri.views.View2D")],Gn);const ait=Gn;let v3=class extends ait{constructor(t){super(t),this.view2dType="map"}};x([E({readOnly:!0})],v3.prototype,"view2dType",void 0),v3=x([ue("esri.views.MapView")],v3);const lit=v3,Rie=["CartoDB (licht)","OpenStreetMap","Luchtfoto","TMK 1850","Bonnebladen 1900"];function cit(){const t=Y.useRef(null),e=Y.useRef(null),n=Y.useRef(!1),r=Y.useRef(!1),[i,s]=Y.useState(!1);QDe({target:"map"});const o=gi(T=>T.map),a=gi(T=>T.setArcGISMap),l=Bs(T=>T.registerLayer),c=Bs(T=>T.setLayerVisibility),u=Cn(T=>T.defaultBackground);Y.useEffect(()=>{if(!o){console.warn(" Map not initialized yet");return}console.log(" Initializing map layers...");const T=new Nm({properties:{title:"OpenStreetMap",type:"base"},visible:!1,source:new GCe}),A=new Nm({properties:{title:"CartoDB (licht)",type:"base"},visible:!0,source:new wy({url:"https://{a-d}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",attributions:" OpenStreetMap contributors  CARTO"})}),I=new Nm({properties:{title:"Luchtfoto",type:"base"},visible:!1,source:new wy({url:"https://service.pdok.nl/hwh/luchtfotorgb/wmts/v1_0/Actueel_orthoHR/EPSG:3857/{z}/{x}/{y}.jpeg",attributions:" Kadaster / PDOK Luchtfoto",maxZoom:19})}),P=new Nm({properties:{title:"Labels Overlay",type:"overlay"},visible:!1,source:new wy({url:"https://{a-d}.basemaps.cartocdn.com/rastertiles/voyager_only_labels/{z}/{x}/{y}.png",attributions:" OpenStreetMap contributors  CARTO",maxZoom:20}),zIndex:100}),R=new Nm({properties:{title:"TMK 1850",type:"base"},visible:!1,source:new wy({url:"https://s.map5.nl/map/gast/tiles/tmk_1850/EPSG3857/{z}/{x}/{y}.png",attributions:" Kadaster / Map5.nl",crossOrigin:"anonymous",maxZoom:14})}),D=new Nm({properties:{title:"Bonnebladen 1900",type:"base"},visible:!1,source:new wy({url:"https://s.map5.nl/map/gast/tiles/bonne_1900/EPSG3857/{z}/{x}/{y}.png",attributions:" Kadaster / Map5.nl",crossOrigin:"anonymous",maxZoom:14})});o.addLayer(T),o.addLayer(A),o.addLayer(I),o.addLayer(P),o.addLayer(R),o.addLayer(D),console.log(" Base layers added:",{osm:T.getVisible(),cartodb:A.getVisible(),satellite:I.getVisible()}),l("OpenStreetMap",T),l("CartoDB (licht)",A),l("Luchtfoto",I),l("Labels Overlay",P),l("TMK 1850",R),l("Bonnebladen 1900",D),o.updateSize(),console.log(" Map size:",o.getSize()),console.log(" Map center:",o.getView().getCenter()),console.log(" Map zoom:",o.getView().getZoom()),h()},[o,l]);async function h(){if(!o){console.error(" Cannot load layers: map is null");return}const T=XRe();console.log(` Loading ${T.length} immediate-load layers (WMS/Tile)...`);const A=await Promise.allSettled(T.map(async P=>{try{const R=await P.factory();return R?{name:P.name,layer:R}:null}catch(R){return console.warn(` Failed to create ${P.name}:`,R),null}}));let I=0;A.forEach(P=>{if(P.status==="fulfilled"&&P.value){const{name:R,layer:D}=P.value;o.addLayer(D),l(R,D),I++,console.log(`   ${R}`)}}),console.log(` Immediate layers loaded: ${I}/${T.length}`),console.log(` Total layers on map: ${o.getLayers().getLength()}`),console.log(" Vector layers will load on first toggle (lazy loading enabled)")}Y.useEffect(()=>{if(!o||!e.current||r.current)return;console.log(" Initializing ArcGIS MapView for AHN layers...");const T=o.getView(),A=T.getCenter(),I=T.getZoom()||8,P=A?Fn(A):[5.5,52],R=new dye({}),D=new lit({container:e.current,map:R,center:P,zoom:I,constraints:{rotationEnabled:!1},ui:{components:[]},background:{color:[0,0,0,0]}});return D.when(()=>{console.log(" ArcGIS MapView ready"),console.log(" ArcGIS center:",D.center?.longitude,D.center?.latitude),console.log(" ArcGIS zoom:",D.zoom),a(R,D),s(!0),r.current=!0,T.on("change:center",()=>{const C=T.getCenter();if(C){const M=Fn(C);D.goTo({center:M},{animate:!1})}}),T.on("change:resolution",()=>{const C=T.getZoom();C!==void 0&&D.goTo({zoom:C},{animate:!1})})}).catch(C=>{console.error(" ArcGIS MapView initialization failed:",C),console.error("Error details:",C.message)}),()=>{D&&D.destroy()}},[o,a]),Y.useEffect(()=>{if(!o||n.current)return;const T=setTimeout(()=>{const A=u||"CartoDB (licht)";Rie.forEach(I=>{c(I,!1)}),Rie.includes(A)?c(A,!0):c("CartoDB (licht)",!0),n.current=!0,console.log(` Default background: ${A}`)},100);return()=>clearTimeout(T)},[o,u,c]);const f=Cn(T=>T.gpsAutoStart),g=ks(T=>T.startTracking),y=Y.useRef(!1);Y.useEffect(()=>{if(!(!o||y.current)&&f){const T=setTimeout(()=>{g(),y.current=!0,console.log(" GPS autostart enabled - tracking started")},500);return()=>clearTimeout(T)}},[o,f,g]);const _={width:"100%",height:"100vh"},b={opacity:i?1:0,transition:"opacity 0.3s ease"};return p.jsxs("div",{style:{position:"relative",width:"100%",height:"100vh"},children:[p.jsx("div",{id:"map",ref:t,style:_}),p.jsx("div",{id:"arcgis-map",ref:e,style:b})]})}const uH=Y.createContext({});function hH(t){const e=Y.useRef(null);return e.current===null&&(e.current=t()),e.current}const gL=Y.createContext(null),dH=Y.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});class uit extends Y.Component{getSnapshotBeforeUpdate(e){const n=this.props.childRef.current;if(n&&e.isPresent&&!this.props.isPresent){const r=this.props.sizeRef.current;r.height=n.offsetHeight||0,r.width=n.offsetWidth||0,r.top=n.offsetTop,r.left=n.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function hit({children:t,isPresent:e}){const n=Y.useId(),r=Y.useRef(null),i=Y.useRef({width:0,height:0,top:0,left:0}),{nonce:s}=Y.useContext(dH);return Y.useInsertionEffect(()=>{const{width:o,height:a,top:l,left:c}=i.current;if(e||!r.current||!o||!a)return;r.current.dataset.motionPopId=n;const u=document.createElement("style");return s&&(u.nonce=s),document.head.appendChild(u),u.sheet&&u.sheet.insertRule(`
          [data-motion-pop-id="${n}"] {
            position: absolute !important;
            width: ${o}px !important;
            height: ${a}px !important;
            top: ${l}px !important;
            left: ${c}px !important;
          }
        `),()=>{document.head.removeChild(u)}},[e]),p.jsx(uit,{isPresent:e,childRef:r,sizeRef:i,children:Y.cloneElement(t,{ref:r})})}const dit=({children:t,initial:e,isPresent:n,onExitComplete:r,custom:i,presenceAffectsLayout:s,mode:o})=>{const a=hH(fit),l=Y.useId(),c=Y.useCallback(h=>{a.set(h,!0);for(const f of a.values())if(!f)return;r&&r()},[a,r]),u=Y.useMemo(()=>({id:l,initial:e,isPresent:n,custom:i,onExitComplete:c,register:h=>(a.set(h,!1),()=>a.delete(h))}),s?[Math.random(),c]:[n,c]);return Y.useMemo(()=>{a.forEach((h,f)=>a.set(f,!1))},[n]),Y.useEffect(()=>{!n&&!a.size&&r&&r()},[n]),o==="popLayout"&&(t=p.jsx(hit,{isPresent:n,children:t})),p.jsx(gL.Provider,{value:u,children:t})};function fit(){return new Map}function Axe(t=!0){const e=Y.useContext(gL);if(e===null)return[!0,null];const{isPresent:n,onExitComplete:r,register:i}=e,s=Y.useId();Y.useEffect(()=>{t&&i(s)},[t]);const o=Y.useCallback(()=>t&&r&&r(s),[s,r,t]);return!n&&r?[!1,o]:[!0]}const vR=t=>t.key||"";function Mie(t){const e=[];return Y.Children.forEach(t,n=>{Y.isValidElement(n)&&e.push(n)}),e}const fH=typeof window<"u",Ixe=fH?Y.useLayoutEffect:Y.useEffect,qn=({children:t,custom:e,initial:n=!0,onExitComplete:r,presenceAffectsLayout:i=!0,mode:s="sync",propagate:o=!1})=>{const[a,l]=Axe(o),c=Y.useMemo(()=>Mie(t),[t]),u=o&&!a?[]:c.map(vR),h=Y.useRef(!0),f=Y.useRef(c),g=hH(()=>new Map),[y,_]=Y.useState(c),[b,T]=Y.useState(c);Ixe(()=>{h.current=!1,f.current=c;for(let P=0;P<b.length;P++){const R=vR(b[P]);u.includes(R)?g.delete(R):g.get(R)!==!0&&g.set(R,!1)}},[b,u.length,u.join("-")]);const A=[];if(c!==y){let P=[...c];for(let R=0;R<b.length;R++){const D=b[R],C=vR(D);u.includes(C)||(P.splice(R,0,D),A.push(D))}s==="wait"&&A.length&&(P=A),T(Mie(P)),_(c);return}const{forceRender:I}=Y.useContext(uH);return p.jsx(p.Fragment,{children:b.map(P=>{const R=vR(P),D=o&&!a?!1:c===b||u.includes(R),C=()=>{if(g.has(R))g.set(R,!0);else return;let M=!0;g.forEach(O=>{O||(M=!1)}),M&&(I?.(),T(f.current),o&&l?.(),r&&r())};return p.jsx(dit,{isPresent:D,initial:!h.current||n?void 0:!1,custom:D?void 0:e,presenceAffectsLayout:i,mode:s,onExitComplete:D?void 0:C,children:P},R)})})},gc=t=>t;let Pxe=gc;function pH(t){let e;return()=>(e===void 0&&(e=t()),e)}const j2=(t,e,n)=>{const r=e-t;return r===0?1:(n-t)/r},sp=t=>t*1e3,op=t=>t/1e3,pit={useManualTiming:!1};function mit(t){let e=new Set,n=new Set,r=!1,i=!1;const s=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function a(c){s.has(c)&&(l.schedule(c),t()),c(o)}const l={schedule:(c,u=!1,h=!1)=>{const g=h&&r?e:n;return u&&s.add(c),g.has(c)||g.add(c),c},cancel:c=>{n.delete(c),s.delete(c)},process:c=>{if(o=c,r){i=!0;return}r=!0,[e,n]=[n,e],e.forEach(a),e.clear(),r=!1,i&&(i=!1,l.process(c))}};return l}const _R=["read","resolveKeyframes","update","preRender","render","postRender"],git=40;function Cxe(t,e){let n=!1,r=!0;const i={delta:0,timestamp:0,isProcessing:!1},s=()=>n=!0,o=_R.reduce((T,A)=>(T[A]=mit(s),T),{}),{read:a,resolveKeyframes:l,update:c,preRender:u,render:h,postRender:f}=o,g=()=>{const T=performance.now();n=!1,i.delta=r?1e3/60:Math.max(Math.min(T-i.timestamp,git),1),i.timestamp=T,i.isProcessing=!0,a.process(i),l.process(i),c.process(i),u.process(i),h.process(i),f.process(i),i.isProcessing=!1,n&&e&&(r=!1,t(g))},y=()=>{n=!0,r=!0,i.isProcessing||t(g)};return{schedule:_R.reduce((T,A)=>{const I=o[A];return T[A]=(P,R=!1,D=!1)=>(n||y(),I.schedule(P,R,D)),T},{}),cancel:T=>{for(let A=0;A<_R.length;A++)o[_R[A]].cancel(T)},state:i,steps:o}}const{schedule:mi,cancel:Hg,state:Po,steps:O$}=Cxe(typeof requestAnimationFrame<"u"?requestAnimationFrame:gc,!0),Rxe=Y.createContext({strict:!1}),Nie={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},$2={};for(const t in Nie)$2[t]={isEnabled:e=>Nie[t].some(n=>!!e[n])};function yit(t){for(const e in t)$2[e]={...$2[e],...t[e]}}const vit=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function RN(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||vit.has(t)}let Mxe=t=>!RN(t);function _it(t){t&&(Mxe=e=>e.startsWith("on")?!RN(e):t(e))}try{_it(require("@emotion/is-prop-valid").default)}catch{}function xit(t,e,n){const r={};for(const i in t)i==="values"&&typeof t.values=="object"||(Mxe(i)||n===!0&&RN(i)||!e&&!RN(i)||t.draggable&&i.startsWith("onDrag"))&&(r[i]=t[i]);return r}function wit(t){if(typeof Proxy>"u")return t;const e=new Map,n=(...r)=>t(...r);return new Proxy(n,{get:(r,i)=>i==="create"?t:(e.has(i)||e.set(i,t(i)),e.get(i))})}const yL=Y.createContext({});function fA(t){return typeof t=="string"||Array.isArray(t)}function vL(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}const mH=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],gH=["initial",...mH];function _L(t){return vL(t.animate)||gH.some(e=>fA(t[e]))}function Nxe(t){return!!(_L(t)||t.variants)}function bit(t,e){if(_L(t)){const{initial:n,animate:r}=t;return{initial:n===!1||fA(n)?n:void 0,animate:fA(r)?r:void 0}}return t.inherit!==!1?e:{}}function Eit(t){const{initial:e,animate:n}=bit(t,Y.useContext(yL));return Y.useMemo(()=>({initial:e,animate:n}),[Oie(e),Oie(n)])}function Oie(t){return Array.isArray(t)?t.join(" "):t}const Sit=Symbol.for("motionComponentSymbol");function Lx(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function Tit(t,e,n){return Y.useCallback(r=>{r&&t.onMount&&t.onMount(r),e&&(r?e.mount(r):e.unmount()),n&&(typeof n=="function"?n(r):Lx(n)&&(n.current=r))},[e])}const yH=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),kit="framerAppearId",Oxe="data-"+yH(kit),{schedule:vH}=Cxe(queueMicrotask,!1),Lxe=Y.createContext({});function Ait(t,e,n,r,i){var s,o;const{visualElement:a}=Y.useContext(yL),l=Y.useContext(Rxe),c=Y.useContext(gL),u=Y.useContext(dH).reducedMotion,h=Y.useRef(null);r=r||l.renderer,!h.current&&r&&(h.current=r(t,{visualState:e,parent:a,props:n,presenceContext:c,blockInitialAnimation:c?c.initial===!1:!1,reducedMotionConfig:u}));const f=h.current,g=Y.useContext(Lxe);f&&!f.projection&&i&&(f.type==="html"||f.type==="svg")&&Iit(h.current,n,i,g);const y=Y.useRef(!1);Y.useInsertionEffect(()=>{f&&y.current&&f.update(n,c)});const _=n[Oxe],b=Y.useRef(!!_&&!(!((s=window.MotionHandoffIsComplete)===null||s===void 0)&&s.call(window,_))&&((o=window.MotionHasOptimisedAnimation)===null||o===void 0?void 0:o.call(window,_)));return Ixe(()=>{f&&(y.current=!0,window.MotionIsMounted=!0,f.updateFeatures(),vH.render(f.render),b.current&&f.animationState&&f.animationState.animateChanges())}),Y.useEffect(()=>{f&&(!b.current&&f.animationState&&f.animationState.animateChanges(),b.current&&(queueMicrotask(()=>{var T;(T=window.MotionHandoffMarkAsComplete)===null||T===void 0||T.call(window,_)}),b.current=!1))}),f}function Iit(t,e,n,r){const{layoutId:i,layout:s,drag:o,dragConstraints:a,layoutScroll:l,layoutRoot:c}=e;t.projection=new n(t.latestValues,e["data-framer-portal-id"]?void 0:Dxe(t.parent)),t.projection.setOptions({layoutId:i,layout:s,alwaysMeasureLayout:!!o||a&&Lx(a),visualElement:t,animationType:typeof s=="string"?s:"both",initialPromotionConfig:r,layoutScroll:l,layoutRoot:c})}function Dxe(t){if(t)return t.options.allowProjection!==!1?t.projection:Dxe(t.parent)}function Pit({preloadedFeatures:t,createVisualElement:e,useRender:n,useVisualState:r,Component:i}){var s,o;t&&yit(t);function a(c,u){let h;const f={...Y.useContext(dH),...c,layoutId:Cit(c)},{isStatic:g}=f,y=Eit(c),_=r(c,g);if(!g&&fH){Rit();const b=Mit(f);h=b.MeasureLayout,y.visualElement=Ait(i,_,f,e,b.ProjectionNode)}return p.jsxs(yL.Provider,{value:y,children:[h&&y.visualElement?p.jsx(h,{visualElement:y.visualElement,...f}):null,n(i,c,Tit(_,y.visualElement,u),_,g,y.visualElement)]})}a.displayName=`motion.${typeof i=="string"?i:`create(${(o=(s=i.displayName)!==null&&s!==void 0?s:i.name)!==null&&o!==void 0?o:""})`}`;const l=Y.forwardRef(a);return l[Sit]=i,l}function Cit({layoutId:t}){const e=Y.useContext(uH).id;return e&&t!==void 0?e+"-"+t:t}function Rit(t,e){Y.useContext(Rxe).strict}function Mit(t){const{drag:e,layout:n}=$2;if(!e&&!n)return{};const r={...e,...n};return{MeasureLayout:e?.isEnabled(t)||n?.isEnabled(t)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}const Nit=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function _H(t){return typeof t!="string"||t.includes("-")?!1:!!(Nit.indexOf(t)>-1||/[A-Z]/u.test(t))}function Lie(t){const e=[{},{}];return t?.values.forEach((n,r)=>{e[0][r]=n.get(),e[1][r]=n.getVelocity()}),e}function xH(t,e,n,r){if(typeof e=="function"){const[i,s]=Lie(r);e=e(n!==void 0?n:t.custom,i,s)}if(typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"){const[i,s]=Lie(r);e=e(n!==void 0?n:t.custom,i,s)}return e}const iz=t=>Array.isArray(t),Oit=t=>!!(t&&typeof t=="object"&&t.mix&&t.toValue),Lit=t=>iz(t)?t[t.length-1]||0:t,fa=t=>!!(t&&t.getVelocity);function _3(t){const e=fa(t)?t.get():t;return Oit(e)?e.toValue():e}function Dit({scrapeMotionValuesFromProps:t,createRenderState:e,onUpdate:n},r,i,s){const o={latestValues:jit(r,i,s,t),renderState:e()};return n&&(o.onMount=a=>n({props:r,current:a,...o}),o.onUpdate=a=>n(a)),o}const jxe=t=>(e,n)=>{const r=Y.useContext(yL),i=Y.useContext(gL),s=()=>Dit(t,e,r,i);return n?s():hH(s)};function jit(t,e,n,r){const i={},s=r(t,{});for(const f in s)i[f]=_3(s[f]);let{initial:o,animate:a}=t;const l=_L(t),c=Nxe(t);e&&c&&!l&&t.inherit!==!1&&(o===void 0&&(o=e.initial),a===void 0&&(a=e.animate));let u=n?n.initial===!1:!1;u=u||o===!1;const h=u?a:o;if(h&&typeof h!="boolean"&&!vL(h)){const f=Array.isArray(h)?h:[h];for(let g=0;g<f.length;g++){const y=xH(t,f[g]);if(y){const{transitionEnd:_,transition:b,...T}=y;for(const A in T){let I=T[A];if(Array.isArray(I)){const P=u?I.length-1:0;I=I[P]}I!==null&&(i[A]=I)}for(const A in _)i[A]=_[A]}}}return i}const wb=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],_v=new Set(wb),$xe=t=>e=>typeof e=="string"&&e.startsWith(t),Fxe=$xe("--"),$it=$xe("var(--"),wH=t=>$it(t)?Fit.test(t.split("/*")[0].trim()):!1,Fit=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Vxe=(t,e)=>e&&typeof t=="number"?e.transform(t):t,vp=(t,e,n)=>n>e?e:n<t?t:n,bb={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},pA={...bb,transform:t=>vp(0,1,t)},xR={...bb,default:1},VI=t=>({test:e=>typeof e=="string"&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),Rm=VI("deg"),Pd=VI("%"),gn=VI("px"),Vit=VI("vh"),zit=VI("vw"),Die={...Pd,parse:t=>Pd.parse(t)/100,transform:t=>Pd.transform(t*100)},Git={borderWidth:gn,borderTopWidth:gn,borderRightWidth:gn,borderBottomWidth:gn,borderLeftWidth:gn,borderRadius:gn,radius:gn,borderTopLeftRadius:gn,borderTopRightRadius:gn,borderBottomRightRadius:gn,borderBottomLeftRadius:gn,width:gn,maxWidth:gn,height:gn,maxHeight:gn,top:gn,right:gn,bottom:gn,left:gn,padding:gn,paddingTop:gn,paddingRight:gn,paddingBottom:gn,paddingLeft:gn,margin:gn,marginTop:gn,marginRight:gn,marginBottom:gn,marginLeft:gn,backgroundPositionX:gn,backgroundPositionY:gn},Uit={rotate:Rm,rotateX:Rm,rotateY:Rm,rotateZ:Rm,scale:xR,scaleX:xR,scaleY:xR,scaleZ:xR,skew:Rm,skewX:Rm,skewY:Rm,distance:gn,translateX:gn,translateY:gn,translateZ:gn,x:gn,y:gn,z:gn,perspective:gn,transformPerspective:gn,opacity:pA,originX:Die,originY:Die,originZ:gn},jie={...bb,transform:Math.round},bH={...Git,...Uit,zIndex:jie,size:gn,fillOpacity:pA,strokeOpacity:pA,numOctaves:jie},Bit={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},Wit=wb.length;function Hit(t,e,n){let r="",i=!0;for(let s=0;s<Wit;s++){const o=wb[s],a=t[o];if(a===void 0)continue;let l=!0;if(typeof a=="number"?l=a===(o.startsWith("scale")?1:0):l=parseFloat(a)===0,!l||n){const c=Vxe(a,bH[o]);if(!l){i=!1;const u=Bit[o]||o;r+=`${u}(${c}) `}n&&(e[o]=c)}}return r=r.trim(),n?r=n(e,i?"":r):i&&(r="none"),r}function EH(t,e,n){const{style:r,vars:i,transformOrigin:s}=t;let o=!1,a=!1;for(const l in e){const c=e[l];if(_v.has(l)){o=!0;continue}else if(Fxe(l)){i[l]=c;continue}else{const u=Vxe(c,bH[l]);l.startsWith("origin")?(a=!0,s[l]=u):r[l]=u}}if(e.transform||(o||n?r.transform=Hit(e,t.transform,n):r.transform&&(r.transform="none")),a){const{originX:l="50%",originY:c="50%",originZ:u=0}=s;r.transformOrigin=`${l} ${c} ${u}`}}const qit={offset:"stroke-dashoffset",array:"stroke-dasharray"},Kit={offset:"strokeDashoffset",array:"strokeDasharray"};function Yit(t,e,n=1,r=0,i=!0){t.pathLength=1;const s=i?qit:Kit;t[s.offset]=gn.transform(-r);const o=gn.transform(e),a=gn.transform(n);t[s.array]=`${o} ${a}`}function $ie(t,e,n){return typeof t=="string"?t:gn.transform(e+n*t)}function Xit(t,e,n){const r=$ie(e,t.x,t.width),i=$ie(n,t.y,t.height);return`${r} ${i}`}function SH(t,{attrX:e,attrY:n,attrScale:r,originX:i,originY:s,pathLength:o,pathSpacing:a=1,pathOffset:l=0,...c},u,h){if(EH(t,c,h),u){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:f,style:g,dimensions:y}=t;f.transform&&(y&&(g.transform=f.transform),delete f.transform),y&&(i!==void 0||s!==void 0||g.transform)&&(g.transformOrigin=Xit(y,i!==void 0?i:.5,s!==void 0?s:.5)),e!==void 0&&(f.x=e),n!==void 0&&(f.y=n),r!==void 0&&(f.scale=r),o!==void 0&&Yit(f,o,a,l,!1)}const TH=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),zxe=()=>({...TH(),attrs:{}}),kH=t=>typeof t=="string"&&t.toLowerCase()==="svg";function Gxe(t,{style:e,vars:n},r,i){Object.assign(t.style,e,i&&i.getProjectionStyles(r));for(const s in n)t.style.setProperty(s,n[s])}const Uxe=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function Bxe(t,e,n,r){Gxe(t,e,void 0,r);for(const i in e.attrs)t.setAttribute(Uxe.has(i)?i:yH(i),e.attrs[i])}const MN={};function Zit(t){Object.assign(MN,t)}function Wxe(t,{layout:e,layoutId:n}){return _v.has(t)||t.startsWith("origin")||(e||n!==void 0)&&(!!MN[t]||t==="opacity")}function AH(t,e,n){var r;const{style:i}=t,s={};for(const o in i)(fa(i[o])||e.style&&fa(e.style[o])||Wxe(o,t)||((r=n?.getValue(o))===null||r===void 0?void 0:r.liveStyle)!==void 0)&&(s[o]=i[o]);return s}function Hxe(t,e,n){const r=AH(t,e,n);for(const i in t)if(fa(t[i])||fa(e[i])){const s=wb.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;r[s]=t[i]}return r}function Jit(t,e){try{e.dimensions=typeof t.getBBox=="function"?t.getBBox():t.getBoundingClientRect()}catch{e.dimensions={x:0,y:0,width:0,height:0}}}const Fie=["x","y","width","height","cx","cy","r"],Qit={useVisualState:jxe({scrapeMotionValuesFromProps:Hxe,createRenderState:zxe,onUpdate:({props:t,prevProps:e,current:n,renderState:r,latestValues:i})=>{if(!n)return;let s=!!t.drag;if(!s){for(const a in i)if(_v.has(a)){s=!0;break}}if(!s)return;let o=!e;if(e)for(let a=0;a<Fie.length;a++){const l=Fie[a];t[l]!==e[l]&&(o=!0)}o&&mi.read(()=>{Jit(n,r),mi.render(()=>{SH(r,i,kH(n.tagName),t.transformTemplate),Bxe(n,r)})})}})},est={useVisualState:jxe({scrapeMotionValuesFromProps:AH,createRenderState:TH})};function qxe(t,e,n){for(const r in e)!fa(e[r])&&!Wxe(r,n)&&(t[r]=e[r])}function tst({transformTemplate:t},e){return Y.useMemo(()=>{const n=TH();return EH(n,e,t),Object.assign({},n.vars,n.style)},[e])}function nst(t,e){const n=t.style||{},r={};return qxe(r,n,t),Object.assign(r,tst(t,e)),r}function rst(t,e){const n={},r=nst(t,e);return t.drag&&t.dragListener!==!1&&(n.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(n.tabIndex=0),n.style=r,n}function ist(t,e,n,r){const i=Y.useMemo(()=>{const s=zxe();return SH(s,e,kH(r),t.transformTemplate),{...s.attrs,style:{...s.style}}},[e]);if(t.style){const s={};qxe(s,t.style,t),i.style={...s,...i.style}}return i}function sst(t=!1){return(n,r,i,{latestValues:s},o)=>{const l=(_H(n)?ist:rst)(r,s,o,n),c=xit(r,typeof n=="string",t),u=n!==Y.Fragment?{...c,...l,ref:i}:{},{children:h}=r,f=Y.useMemo(()=>fa(h)?h.get():h,[h]);return Y.createElement(n,{...u,children:f})}}function ost(t,e){return function(r,{forwardMotionProps:i}={forwardMotionProps:!1}){const o={..._H(r)?Qit:est,preloadedFeatures:t,useRender:sst(i),createVisualElement:e,Component:r};return Pit(o)}}function Kxe(t,e){if(!Array.isArray(e))return!1;const n=e.length;if(n!==t.length)return!1;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}function xL(t,e,n){const r=t.getProps();return xH(r,e,n!==void 0?n:r.custom,t)}const ast=pH(()=>window.ScrollTimeline!==void 0);class lst{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,n){for(let r=0;r<this.animations.length;r++)this.animations[r][e]=n}attachTimeline(e,n){const r=this.animations.map(i=>{if(ast()&&i.attachTimeline)return i.attachTimeline(e);if(typeof n=="function")return n(i)});return()=>{r.forEach((i,s)=>{i&&i(),this.animations[s].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let n=0;n<this.animations.length;n++)e=Math.max(e,this.animations[n].duration);return e}runAll(e){this.animations.forEach(n=>n[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class cst extends lst{then(e,n){return Promise.all(this.animations).then(e).catch(n)}}function IH(t,e){return t?t[e]||t.default||t:void 0}const sz=2e4;function Yxe(t){let e=0;const n=50;let r=t.next(e);for(;!r.done&&e<sz;)e+=n,r=t.next(e);return e>=sz?1/0:e}function PH(t){return typeof t=="function"}function Vie(t,e){t.timeline=e,t.onfinish=null}const CH=t=>Array.isArray(t)&&typeof t[0]=="number",ust={linearEasing:void 0};function hst(t,e){const n=pH(t);return()=>{var r;return(r=ust[e])!==null&&r!==void 0?r:n()}}const NN=hst(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),Xxe=(t,e,n=10)=>{let r="";const i=Math.max(Math.round(e/n),2);for(let s=0;s<i;s++)r+=t(j2(0,i-1,s))+", ";return`linear(${r.substring(0,r.length-2)})`};function Zxe(t){return!!(typeof t=="function"&&NN()||!t||typeof t=="string"&&(t in oz||NN())||CH(t)||Array.isArray(t)&&t.every(Zxe))}const BS=([t,e,n,r])=>`cubic-bezier(${t}, ${e}, ${n}, ${r})`,oz={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:BS([0,.65,.55,1]),circOut:BS([.55,0,1,.45]),backIn:BS([.31,.01,.66,-.59]),backOut:BS([.33,1.53,.69,.99])};function Jxe(t,e){if(t)return typeof t=="function"&&NN()?Xxe(t,e):CH(t)?BS(t):Array.isArray(t)?t.map(n=>Jxe(n,e)||oz.easeOut):oz[t]}const Ku={x:!1,y:!1};function Qxe(){return Ku.x||Ku.y}function dst(t,e,n){var r;if(t instanceof Element)return[t];if(typeof t=="string"){let i=document;const s=(r=void 0)!==null&&r!==void 0?r:i.querySelectorAll(t);return s?Array.from(s):[]}return Array.from(t)}function ewe(t,e){const n=dst(t),r=new AbortController,i={passive:!0,...e,signal:r.signal};return[n,i,()=>r.abort()]}function zie(t){return e=>{e.pointerType==="touch"||Qxe()||t(e)}}function fst(t,e,n={}){const[r,i,s]=ewe(t,n),o=zie(a=>{const{target:l}=a,c=e(a);if(typeof c!="function"||!l)return;const u=zie(h=>{c(h),l.removeEventListener("pointerleave",u)});l.addEventListener("pointerleave",u,i)});return r.forEach(a=>{a.addEventListener("pointerenter",o,i)}),s}const twe=(t,e)=>e?t===e?!0:twe(t,e.parentElement):!1,RH=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,pst=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function mst(t){return pst.has(t.tagName)||t.tabIndex!==-1}const WS=new WeakSet;function Gie(t){return e=>{e.key==="Enter"&&t(e)}}function L$(t,e){t.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const gst=(t,e)=>{const n=t.currentTarget;if(!n)return;const r=Gie(()=>{if(WS.has(n))return;L$(n,"down");const i=Gie(()=>{L$(n,"up")}),s=()=>L$(n,"cancel");n.addEventListener("keyup",i,e),n.addEventListener("blur",s,e)});n.addEventListener("keydown",r,e),n.addEventListener("blur",()=>n.removeEventListener("keydown",r),e)};function Uie(t){return RH(t)&&!Qxe()}function yst(t,e,n={}){const[r,i,s]=ewe(t,n),o=a=>{const l=a.currentTarget;if(!Uie(a)||WS.has(l))return;WS.add(l);const c=e(a),u=(g,y)=>{window.removeEventListener("pointerup",h),window.removeEventListener("pointercancel",f),!(!Uie(g)||!WS.has(l))&&(WS.delete(l),typeof c=="function"&&c(g,{success:y}))},h=g=>{u(g,n.useGlobalTarget||twe(l,g.target))},f=g=>{u(g,!1)};window.addEventListener("pointerup",h,i),window.addEventListener("pointercancel",f,i)};return r.forEach(a=>{!mst(a)&&a.getAttribute("tabindex")===null&&(a.tabIndex=0),(n.useGlobalTarget?window:a).addEventListener("pointerdown",o,i),a.addEventListener("focus",c=>gst(c,i),i)}),s}function vst(t){return t==="x"||t==="y"?Ku[t]?null:(Ku[t]=!0,()=>{Ku[t]=!1}):Ku.x||Ku.y?null:(Ku.x=Ku.y=!0,()=>{Ku.x=Ku.y=!1})}const nwe=new Set(["width","height","top","left","right","bottom",...wb]);let x3;function _st(){x3=void 0}const Cd={now:()=>(x3===void 0&&Cd.set(Po.isProcessing||pit.useManualTiming?Po.timestamp:performance.now()),x3),set:t=>{x3=t,queueMicrotask(_st)}};function MH(t,e){t.indexOf(e)===-1&&t.push(e)}function NH(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}class OH{constructor(){this.subscriptions=[]}add(e){return MH(this.subscriptions,e),()=>NH(this.subscriptions,e)}notify(e,n,r){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](e,n,r);else for(let s=0;s<i;s++){const o=this.subscriptions[s];o&&o(e,n,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function rwe(t,e){return e?t*(1e3/e):0}const Bie=30,xst=t=>!isNaN(parseFloat(t));class wst{constructor(e,n={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(r,i=!0)=>{const s=Cd.now();this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),i&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=n.owner}setCurrent(e){this.current=e,this.updatedAt=Cd.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=xst(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,n){this.events[e]||(this.events[e]=new OH);const r=this.events[e].add(n);return e==="change"?()=>{r(),mi.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,n){this.passiveEffect=e,this.stopPassiveEffect=n}set(e,n=!0){!n||!this.passiveEffect?this.updateAndNotify(e,n):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,n,r){this.set(n),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-r}jump(e,n=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=Cd.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>Bie)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,Bie);return rwe(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(e){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=e(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function mA(t,e){return new wst(t,e)}function bst(t,e,n){t.hasValue(e)?t.getValue(e).set(n):t.addValue(e,mA(n))}function Est(t,e){const n=xL(t,e);let{transitionEnd:r={},transition:i={},...s}=n||{};s={...s,...r};for(const o in s){const a=Lit(s[o]);bst(t,o,a)}}function Sst(t){return!!(fa(t)&&t.add)}function az(t,e){const n=t.getValue("willChange");if(Sst(n))return n.add(e)}function iwe(t){return t.props[Oxe]}const swe=(t,e,n)=>(((1-3*n+3*e)*t+(3*n-6*e))*t+3*e)*t,Tst=1e-7,kst=12;function Ast(t,e,n,r,i){let s,o,a=0;do o=e+(n-e)/2,s=swe(o,r,i)-t,s>0?n=o:e=o;while(Math.abs(s)>Tst&&++a<kst);return o}function zI(t,e,n,r){if(t===e&&n===r)return gc;const i=s=>Ast(s,0,1,t,n);return s=>s===0||s===1?s:swe(i(s),e,r)}const owe=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,awe=t=>e=>1-t(1-e),lwe=zI(.33,1.53,.69,.99),LH=awe(lwe),cwe=owe(LH),uwe=t=>(t*=2)<1?.5*LH(t):.5*(2-Math.pow(2,-10*(t-1))),DH=t=>1-Math.sin(Math.acos(t)),hwe=awe(DH),dwe=owe(DH),fwe=t=>/^0[^.\s]+$/u.test(t);function Ist(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||fwe(t):!0}const FT=t=>Math.round(t*1e5)/1e5,jH=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function Pst(t){return t==null}const Cst=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,$H=(t,e)=>n=>!!(typeof n=="string"&&Cst.test(n)&&n.startsWith(t)||e&&!Pst(n)&&Object.prototype.hasOwnProperty.call(n,e)),pwe=(t,e,n)=>r=>{if(typeof r!="string")return r;const[i,s,o,a]=r.match(jH);return{[t]:parseFloat(i),[e]:parseFloat(s),[n]:parseFloat(o),alpha:a!==void 0?parseFloat(a):1}},Rst=t=>vp(0,255,t),D$={...bb,transform:t=>Math.round(Rst(t))},Hy={test:$H("rgb","red"),parse:pwe("red","green","blue"),transform:({red:t,green:e,blue:n,alpha:r=1})=>"rgba("+D$.transform(t)+", "+D$.transform(e)+", "+D$.transform(n)+", "+FT(pA.transform(r))+")"};function Mst(t){let e="",n="",r="",i="";return t.length>5?(e=t.substring(1,3),n=t.substring(3,5),r=t.substring(5,7),i=t.substring(7,9)):(e=t.substring(1,2),n=t.substring(2,3),r=t.substring(3,4),i=t.substring(4,5),e+=e,n+=n,r+=r,i+=i),{red:parseInt(e,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:i?parseInt(i,16)/255:1}}const lz={test:$H("#"),parse:Mst,transform:Hy.transform},Dx={test:$H("hsl","hue"),parse:pwe("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:n,alpha:r=1})=>"hsla("+Math.round(t)+", "+Pd.transform(FT(e))+", "+Pd.transform(FT(n))+", "+FT(pA.transform(r))+")"},ea={test:t=>Hy.test(t)||lz.test(t)||Dx.test(t),parse:t=>Hy.test(t)?Hy.parse(t):Dx.test(t)?Dx.parse(t):lz.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?Hy.transform(t):Dx.transform(t)},Nst=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function Ost(t){var e,n;return isNaN(t)&&typeof t=="string"&&(((e=t.match(jH))===null||e===void 0?void 0:e.length)||0)+(((n=t.match(Nst))===null||n===void 0?void 0:n.length)||0)>0}const mwe="number",gwe="color",Lst="var",Dst="var(",Wie="${}",jst=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function gA(t){const e=t.toString(),n=[],r={color:[],number:[],var:[]},i=[];let s=0;const a=e.replace(jst,l=>(ea.test(l)?(r.color.push(s),i.push(gwe),n.push(ea.parse(l))):l.startsWith(Dst)?(r.var.push(s),i.push(Lst),n.push(l)):(r.number.push(s),i.push(mwe),n.push(parseFloat(l))),++s,Wie)).split(Wie);return{values:n,split:a,indexes:r,types:i}}function ywe(t){return gA(t).values}function vwe(t){const{split:e,types:n}=gA(t),r=e.length;return i=>{let s="";for(let o=0;o<r;o++)if(s+=e[o],i[o]!==void 0){const a=n[o];a===mwe?s+=FT(i[o]):a===gwe?s+=ea.transform(i[o]):s+=i[o]}return s}}const $st=t=>typeof t=="number"?0:t;function Fst(t){const e=ywe(t);return vwe(t)(e.map($st))}const qg={test:Ost,parse:ywe,createTransformer:vwe,getAnimatableNone:Fst},Vst=new Set(["brightness","contrast","saturate","opacity"]);function zst(t){const[e,n]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[r]=n.match(jH)||[];if(!r)return t;const i=n.replace(r,"");let s=Vst.has(e)?1:0;return r!==n&&(s*=100),e+"("+s+i+")"}const Gst=/\b([a-z-]*)\(.*?\)/gu,cz={...qg,getAnimatableNone:t=>{const e=t.match(Gst);return e?e.map(zst).join(" "):t}},Ust={...bH,color:ea,backgroundColor:ea,outlineColor:ea,fill:ea,stroke:ea,borderColor:ea,borderTopColor:ea,borderRightColor:ea,borderBottomColor:ea,borderLeftColor:ea,filter:cz,WebkitFilter:cz},FH=t=>Ust[t];function _we(t,e){let n=FH(t);return n!==cz&&(n=qg),n.getAnimatableNone?n.getAnimatableNone(e):void 0}const Bst=new Set(["auto","none","0"]);function Wst(t,e,n){let r=0,i;for(;r<t.length&&!i;){const s=t[r];typeof s=="string"&&!Bst.has(s)&&gA(s).values.length&&(i=t[r]),r++}if(i&&n)for(const s of e)t[s]=_we(n,i)}const Hie=t=>t===bb||t===gn,qie=(t,e)=>parseFloat(t.split(", ")[e]),Kie=(t,e)=>(n,{transform:r})=>{if(r==="none"||!r)return 0;const i=r.match(/^matrix3d\((.+)\)$/u);if(i)return qie(i[1],e);{const s=r.match(/^matrix\((.+)\)$/u);return s?qie(s[1],t):0}},Hst=new Set(["x","y","z"]),qst=wb.filter(t=>!Hst.has(t));function Kst(t){const e=[];return qst.forEach(n=>{const r=t.getValue(n);r!==void 0&&(e.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),e}const F2={width:({x:t},{paddingLeft:e="0",paddingRight:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),height:({y:t},{paddingTop:e="0",paddingBottom:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:Kie(4,13),y:Kie(5,14)};F2.translateX=F2.x;F2.translateY=F2.y;const u1=new Set;let uz=!1,hz=!1;function xwe(){if(hz){const t=Array.from(u1).filter(r=>r.needsMeasurement),e=new Set(t.map(r=>r.element)),n=new Map;e.forEach(r=>{const i=Kst(r);i.length&&(n.set(r,i),r.render())}),t.forEach(r=>r.measureInitialState()),e.forEach(r=>{r.render();const i=n.get(r);i&&i.forEach(([s,o])=>{var a;(a=r.getValue(s))===null||a===void 0||a.set(o)})}),t.forEach(r=>r.measureEndState()),t.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}hz=!1,uz=!1,u1.forEach(t=>t.complete()),u1.clear()}function wwe(){u1.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(hz=!0)})}function Yst(){wwe(),xwe()}class VH{constructor(e,n,r,i,s,o=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=n,this.name=r,this.motionValue=i,this.element=s,this.isAsync=o}scheduleResolve(){this.isScheduled=!0,this.isAsync?(u1.add(this),uz||(uz=!0,mi.read(wwe),mi.resolveKeyframes(xwe))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:n,element:r,motionValue:i}=this;for(let s=0;s<e.length;s++)if(e[s]===null)if(s===0){const o=i?.get(),a=e[e.length-1];if(o!==void 0)e[0]=o;else if(r&&n){const l=r.readValue(n,a);l!=null&&(e[0]=l)}e[0]===void 0&&(e[0]=a),i&&o===void 0&&i.set(e[0])}else e[s]=e[s-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),u1.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,u1.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const bwe=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t),Xst=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function Zst(t){const e=Xst.exec(t);if(!e)return[,];const[,n,r,i]=e;return[`--${n??r}`,i]}function Ewe(t,e,n=1){const[r,i]=Zst(t);if(!r)return;const s=window.getComputedStyle(e).getPropertyValue(r);if(s){const o=s.trim();return bwe(o)?parseFloat(o):o}return wH(i)?Ewe(i,e,n+1):i}const Swe=t=>e=>e.test(t),Jst={test:t=>t==="auto",parse:t=>t},Twe=[bb,gn,Pd,Rm,zit,Vit,Jst],Yie=t=>Twe.find(Swe(t));class kwe extends VH{constructor(e,n,r,i,s){super(e,n,r,i,s,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:n,name:r}=this;if(!n||!n.current)return;super.readKeyframes();for(let l=0;l<e.length;l++){let c=e[l];if(typeof c=="string"&&(c=c.trim(),wH(c))){const u=Ewe(c,n.current);u!==void 0&&(e[l]=u),l===e.length-1&&(this.finalKeyframe=c)}}if(this.resolveNoneKeyframes(),!nwe.has(r)||e.length!==2)return;const[i,s]=e,o=Yie(i),a=Yie(s);if(o!==a)if(Hie(o)&&Hie(a))for(let l=0;l<e.length;l++){const c=e[l];typeof c=="string"&&(e[l]=parseFloat(c))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:n}=this,r=[];for(let i=0;i<e.length;i++)Ist(e[i])&&r.push(i);r.length&&Wst(e,r,n)}measureInitialState(){const{element:e,unresolvedKeyframes:n,name:r}=this;if(!e||!e.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=F2[r](e.measureViewportBox(),window.getComputedStyle(e.current)),n[0]=this.measuredOrigin;const i=n[n.length-1];i!==void 0&&e.getValue(r,i).jump(i,!1)}measureEndState(){var e;const{element:n,name:r,unresolvedKeyframes:i}=this;if(!n||!n.current)return;const s=n.getValue(r);s&&s.jump(this.measuredOrigin,!1);const o=i.length-1,a=i[o];i[o]=F2[r](n.measureViewportBox(),window.getComputedStyle(n.current)),a!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=a),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([l,c])=>{n.getValue(l).set(c)}),this.resolveNoneKeyframes()}}const Xie=(t,e)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(qg.test(t)||t==="0")&&!t.startsWith("url("));function Qst(t){const e=t[0];if(t.length===1)return!0;for(let n=0;n<t.length;n++)if(t[n]!==e)return!0}function eot(t,e,n,r){const i=t[0];if(i===null)return!1;if(e==="display"||e==="visibility")return!0;const s=t[t.length-1],o=Xie(i,e),a=Xie(s,e);return!o||!a?!1:Qst(t)||(n==="spring"||PH(n))&&r}const tot=t=>t!==null;function wL(t,{repeat:e,repeatType:n="loop"},r){const i=t.filter(tot),s=e&&n!=="loop"&&e%2===1?0:i.length-1;return!s||r===void 0?i[s]:r}const not=40;class Awe{constructor({autoplay:e=!0,delay:n=0,type:r="keyframes",repeat:i=0,repeatDelay:s=0,repeatType:o="loop",...a}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=Cd.now(),this.options={autoplay:e,delay:n,type:r,repeat:i,repeatDelay:s,repeatType:o,...a},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>not?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&Yst(),this._resolved}onKeyframesResolved(e,n){this.resolvedAt=Cd.now(),this.hasAttemptedResolve=!0;const{name:r,type:i,velocity:s,delay:o,onComplete:a,onUpdate:l,isGenerator:c}=this.options;if(!c&&!eot(e,r,i,s))if(o)this.options.duration=0;else{l&&l(wL(e,this.options,n)),a&&a(),this.resolveFinishedPromise();return}const u=this.initPlayback(e,n);u!==!1&&(this._resolved={keyframes:e,finalKeyframe:n,...u},this.onPostResolved())}onPostResolved(){}then(e,n){return this.currentFinishedPromise.then(e,n)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const Fi=(t,e,n)=>t+(e-t)*n;function j$(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function rot({hue:t,saturation:e,lightness:n,alpha:r}){t/=360,e/=100,n/=100;let i=0,s=0,o=0;if(!e)i=s=o=n;else{const a=n<.5?n*(1+e):n+e-n*e,l=2*n-a;i=j$(l,a,t+1/3),s=j$(l,a,t),o=j$(l,a,t-1/3)}return{red:Math.round(i*255),green:Math.round(s*255),blue:Math.round(o*255),alpha:r}}function ON(t,e){return n=>n>0?e:t}const $$=(t,e,n)=>{const r=t*t,i=n*(e*e-r)+r;return i<0?0:Math.sqrt(i)},iot=[lz,Hy,Dx],sot=t=>iot.find(e=>e.test(t));function Zie(t){const e=sot(t);if(!e)return!1;let n=e.parse(t);return e===Dx&&(n=rot(n)),n}const Jie=(t,e)=>{const n=Zie(t),r=Zie(e);if(!n||!r)return ON(t,e);const i={...n};return s=>(i.red=$$(n.red,r.red,s),i.green=$$(n.green,r.green,s),i.blue=$$(n.blue,r.blue,s),i.alpha=Fi(n.alpha,r.alpha,s),Hy.transform(i))},oot=(t,e)=>n=>e(t(n)),GI=(...t)=>t.reduce(oot),dz=new Set(["none","hidden"]);function aot(t,e){return dz.has(t)?n=>n<=0?t:e:n=>n>=1?e:t}function lot(t,e){return n=>Fi(t,e,n)}function zH(t){return typeof t=="number"?lot:typeof t=="string"?wH(t)?ON:ea.test(t)?Jie:hot:Array.isArray(t)?Iwe:typeof t=="object"?ea.test(t)?Jie:cot:ON}function Iwe(t,e){const n=[...t],r=n.length,i=t.map((s,o)=>zH(s)(s,e[o]));return s=>{for(let o=0;o<r;o++)n[o]=i[o](s);return n}}function cot(t,e){const n={...t,...e},r={};for(const i in n)t[i]!==void 0&&e[i]!==void 0&&(r[i]=zH(t[i])(t[i],e[i]));return i=>{for(const s in r)n[s]=r[s](i);return n}}function uot(t,e){var n;const r=[],i={color:0,var:0,number:0};for(let s=0;s<e.values.length;s++){const o=e.types[s],a=t.indexes[o][i[o]],l=(n=t.values[a])!==null&&n!==void 0?n:0;r[s]=l,i[o]++}return r}const hot=(t,e)=>{const n=qg.createTransformer(e),r=gA(t),i=gA(e);return r.indexes.var.length===i.indexes.var.length&&r.indexes.color.length===i.indexes.color.length&&r.indexes.number.length>=i.indexes.number.length?dz.has(t)&&!i.values.length||dz.has(e)&&!r.values.length?aot(t,e):GI(Iwe(uot(r,i),i.values),n):ON(t,e)};function Pwe(t,e,n){return typeof t=="number"&&typeof e=="number"&&typeof n=="number"?Fi(t,e,n):zH(t)(t,e)}const dot=5;function Cwe(t,e,n){const r=Math.max(e-dot,0);return rwe(n-t(r),e-r)}const Xi={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},F$=.001;function fot({duration:t=Xi.duration,bounce:e=Xi.bounce,velocity:n=Xi.velocity,mass:r=Xi.mass}){let i,s,o=1-e;o=vp(Xi.minDamping,Xi.maxDamping,o),t=vp(Xi.minDuration,Xi.maxDuration,op(t)),o<1?(i=c=>{const u=c*o,h=u*t,f=u-n,g=fz(c,o),y=Math.exp(-h);return F$-f/g*y},s=c=>{const h=c*o*t,f=h*n+n,g=Math.pow(o,2)*Math.pow(c,2)*t,y=Math.exp(-h),_=fz(Math.pow(c,2),o);return(-i(c)+F$>0?-1:1)*((f-g)*y)/_}):(i=c=>{const u=Math.exp(-c*t),h=(c-n)*t+1;return-F$+u*h},s=c=>{const u=Math.exp(-c*t),h=(n-c)*(t*t);return u*h});const a=5/t,l=mot(i,s,a);if(t=sp(t),isNaN(l))return{stiffness:Xi.stiffness,damping:Xi.damping,duration:t};{const c=Math.pow(l,2)*r;return{stiffness:c,damping:o*2*Math.sqrt(r*c),duration:t}}}const pot=12;function mot(t,e,n){let r=n;for(let i=1;i<pot;i++)r=r-t(r)/e(r);return r}function fz(t,e){return t*Math.sqrt(1-e*e)}const got=["duration","bounce"],yot=["stiffness","damping","mass"];function Qie(t,e){return e.some(n=>t[n]!==void 0)}function vot(t){let e={velocity:Xi.velocity,stiffness:Xi.stiffness,damping:Xi.damping,mass:Xi.mass,isResolvedFromDuration:!1,...t};if(!Qie(t,yot)&&Qie(t,got))if(t.visualDuration){const n=t.visualDuration,r=2*Math.PI/(n*1.2),i=r*r,s=2*vp(.05,1,1-(t.bounce||0))*Math.sqrt(i);e={...e,mass:Xi.mass,stiffness:i,damping:s}}else{const n=fot(t);e={...e,...n,mass:Xi.mass},e.isResolvedFromDuration=!0}return e}function Rwe(t=Xi.visualDuration,e=Xi.bounce){const n=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:e}:t;let{restSpeed:r,restDelta:i}=n;const s=n.keyframes[0],o=n.keyframes[n.keyframes.length-1],a={done:!1,value:s},{stiffness:l,damping:c,mass:u,duration:h,velocity:f,isResolvedFromDuration:g}=vot({...n,velocity:-op(n.velocity||0)}),y=f||0,_=c/(2*Math.sqrt(l*u)),b=o-s,T=op(Math.sqrt(l/u)),A=Math.abs(b)<5;r||(r=A?Xi.restSpeed.granular:Xi.restSpeed.default),i||(i=A?Xi.restDelta.granular:Xi.restDelta.default);let I;if(_<1){const R=fz(T,_);I=D=>{const C=Math.exp(-_*T*D);return o-C*((y+_*T*b)/R*Math.sin(R*D)+b*Math.cos(R*D))}}else if(_===1)I=R=>o-Math.exp(-T*R)*(b+(y+T*b)*R);else{const R=T*Math.sqrt(_*_-1);I=D=>{const C=Math.exp(-_*T*D),M=Math.min(R*D,300);return o-C*((y+_*T*b)*Math.sinh(M)+R*b*Math.cosh(M))/R}}const P={calculatedDuration:g&&h||null,next:R=>{const D=I(R);if(g)a.done=R>=h;else{let C=0;_<1&&(C=R===0?sp(y):Cwe(I,R,D));const M=Math.abs(C)<=r,O=Math.abs(o-D)<=i;a.done=M&&O}return a.value=a.done?o:D,a},toString:()=>{const R=Math.min(Yxe(P),sz),D=Xxe(C=>P.next(R*C).value,R,30);return R+"ms "+D}};return P}function ese({keyframes:t,velocity:e=0,power:n=.8,timeConstant:r=325,bounceDamping:i=10,bounceStiffness:s=500,modifyTarget:o,min:a,max:l,restDelta:c=.5,restSpeed:u}){const h=t[0],f={done:!1,value:h},g=M=>a!==void 0&&M<a||l!==void 0&&M>l,y=M=>a===void 0?l:l===void 0||Math.abs(a-M)<Math.abs(l-M)?a:l;let _=n*e;const b=h+_,T=o===void 0?b:o(b);T!==b&&(_=T-h);const A=M=>-_*Math.exp(-M/r),I=M=>T+A(M),P=M=>{const O=A(M),j=I(M);f.done=Math.abs(O)<=c,f.value=f.done?T:j};let R,D;const C=M=>{g(f.value)&&(R=M,D=Rwe({keyframes:[f.value,y(f.value)],velocity:Cwe(I,M,f.value),damping:i,stiffness:s,restDelta:c,restSpeed:u}))};return C(0),{calculatedDuration:null,next:M=>{let O=!1;return!D&&R===void 0&&(O=!0,P(M),C(M)),R!==void 0&&M>=R?D.next(M-R):(!O&&P(M),f)}}}const _ot=zI(.42,0,1,1),xot=zI(0,0,.58,1),Mwe=zI(.42,0,.58,1),wot=t=>Array.isArray(t)&&typeof t[0]!="number",bot={linear:gc,easeIn:_ot,easeInOut:Mwe,easeOut:xot,circIn:DH,circInOut:dwe,circOut:hwe,backIn:LH,backInOut:cwe,backOut:lwe,anticipate:uwe},tse=t=>{if(CH(t)){Pxe(t.length===4);const[e,n,r,i]=t;return zI(e,n,r,i)}else if(typeof t=="string")return bot[t];return t};function Eot(t,e,n){const r=[],i=n||Pwe,s=t.length-1;for(let o=0;o<s;o++){let a=i(t[o],t[o+1]);if(e){const l=Array.isArray(e)?e[o]||gc:e;a=GI(l,a)}r.push(a)}return r}function Sot(t,e,{clamp:n=!0,ease:r,mixer:i}={}){const s=t.length;if(Pxe(s===e.length),s===1)return()=>e[0];if(s===2&&e[0]===e[1])return()=>e[1];const o=t[0]===t[1];t[0]>t[s-1]&&(t=[...t].reverse(),e=[...e].reverse());const a=Eot(e,r,i),l=a.length,c=u=>{if(o&&u<t[0])return e[0];let h=0;if(l>1)for(;h<t.length-2&&!(u<t[h+1]);h++);const f=j2(t[h],t[h+1],u);return a[h](f)};return n?u=>c(vp(t[0],t[s-1],u)):c}function Tot(t,e){const n=t[t.length-1];for(let r=1;r<=e;r++){const i=j2(0,e,r);t.push(Fi(n,1,i))}}function kot(t){const e=[0];return Tot(e,t.length-1),e}function Aot(t,e){return t.map(n=>n*e)}function Iot(t,e){return t.map(()=>e||Mwe).splice(0,t.length-1)}function LN({duration:t=300,keyframes:e,times:n,ease:r="easeInOut"}){const i=wot(r)?r.map(tse):tse(r),s={done:!1,value:e[0]},o=Aot(n&&n.length===e.length?n:kot(e),t),a=Sot(o,e,{ease:Array.isArray(i)?i:Iot(e,i)});return{calculatedDuration:t,next:l=>(s.value=a(l),s.done=l>=t,s)}}const Pot=t=>{const e=({timestamp:n})=>t(n);return{start:()=>mi.update(e,!0),stop:()=>Hg(e),now:()=>Po.isProcessing?Po.timestamp:Cd.now()}},Cot={decay:ese,inertia:ese,tween:LN,keyframes:LN,spring:Rwe},Rot=t=>t/100;class GH extends Awe{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:l}=this.options;l&&l()};const{name:n,motionValue:r,element:i,keyframes:s}=this.options,o=i?.KeyframeResolver||VH,a=(l,c)=>this.onKeyframesResolved(l,c);this.resolver=new o(s,a,n,r,i),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:n="keyframes",repeat:r=0,repeatDelay:i=0,repeatType:s,velocity:o=0}=this.options,a=PH(n)?n:Cot[n]||LN;let l,c;a!==LN&&typeof e[0]!="number"&&(l=GI(Rot,Pwe(e[0],e[1])),e=[0,100]);const u=a({...this.options,keyframes:e});s==="mirror"&&(c=a({...this.options,keyframes:[...e].reverse(),velocity:-o})),u.calculatedDuration===null&&(u.calculatedDuration=Yxe(u));const{calculatedDuration:h}=u,f=h+i,g=f*(r+1)-i;return{generator:u,mirroredGenerator:c,mapPercentToKeyframes:l,calculatedDuration:h,resolvedDuration:f,totalDuration:g}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,n=!1){const{resolved:r}=this;if(!r){const{keyframes:M}=this.options;return{done:!0,value:M[M.length-1]}}const{finalKeyframe:i,generator:s,mirroredGenerator:o,mapPercentToKeyframes:a,keyframes:l,calculatedDuration:c,totalDuration:u,resolvedDuration:h}=r;if(this.startTime===null)return s.next(0);const{delay:f,repeat:g,repeatType:y,repeatDelay:_,onUpdate:b}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-u/this.speed,this.startTime)),n?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const T=this.currentTime-f*(this.speed>=0?1:-1),A=this.speed>=0?T<0:T>u;this.currentTime=Math.max(T,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=u);let I=this.currentTime,P=s;if(g){const M=Math.min(this.currentTime,u)/h;let O=Math.floor(M),j=M%1;!j&&M>=1&&(j=1),j===1&&O--,O=Math.min(O,g+1),O%2&&(y==="reverse"?(j=1-j,_&&(j-=_/h)):y==="mirror"&&(P=o)),I=vp(0,1,j)*h}const R=A?{done:!1,value:l[0]}:P.next(I);a&&(R.value=a(R.value));let{done:D}=R;!A&&c!==null&&(D=this.speed>=0?this.currentTime>=u:this.currentTime<=0);const C=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&D);return C&&i!==void 0&&(R.value=wL(l,this.options,i)),b&&b(R.value),C&&this.finish(),R}get duration(){const{resolved:e}=this;return e?op(e.calculatedDuration):0}get time(){return op(this.currentTime)}set time(e){e=sp(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const n=this.playbackSpeed!==e;this.playbackSpeed=e,n&&(this.time=op(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=Pot,onPlay:n,startTime:r}=this.options;this.driver||(this.driver=e(s=>this.tick(s))),n&&n();const i=this.driver.now();this.holdTime!==null?this.startTime=i-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=i):this.startTime=r??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const Mot=new Set(["opacity","clipPath","filter","transform"]);function Not(t,e,n,{delay:r=0,duration:i=300,repeat:s=0,repeatType:o="loop",ease:a="easeInOut",times:l}={}){const c={[e]:n};l&&(c.offset=l);const u=Jxe(a,i);return Array.isArray(u)&&(c.easing=u),t.animate(c,{delay:r,duration:i,easing:Array.isArray(u)?"linear":u,fill:"both",iterations:s+1,direction:o==="reverse"?"alternate":"normal"})}const Oot=pH(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),DN=10,Lot=2e4;function Dot(t){return PH(t.type)||t.type==="spring"||!Zxe(t.ease)}function jot(t,e){const n=new GH({...e,keyframes:t,repeat:0,delay:0,isGenerator:!0});let r={done:!1,value:t[0]};const i=[];let s=0;for(;!r.done&&s<Lot;)r=n.sample(s),i.push(r.value),s+=DN;return{times:void 0,keyframes:i,duration:s-DN,ease:"linear"}}const Nwe={anticipate:uwe,backInOut:cwe,circInOut:dwe};function $ot(t){return t in Nwe}class nse extends Awe{constructor(e){super(e);const{name:n,motionValue:r,element:i,keyframes:s}=this.options;this.resolver=new kwe(s,(o,a)=>this.onKeyframesResolved(o,a),n,r,i),this.resolver.scheduleResolve()}initPlayback(e,n){let{duration:r=300,times:i,ease:s,type:o,motionValue:a,name:l,startTime:c}=this.options;if(!a.owner||!a.owner.current)return!1;if(typeof s=="string"&&NN()&&$ot(s)&&(s=Nwe[s]),Dot(this.options)){const{onComplete:h,onUpdate:f,motionValue:g,element:y,..._}=this.options,b=jot(e,_);e=b.keyframes,e.length===1&&(e[1]=e[0]),r=b.duration,i=b.times,s=b.ease,o="keyframes"}const u=Not(a.owner.current,l,e,{...this.options,duration:r,times:i,ease:s});return u.startTime=c??this.calcStartTime(),this.pendingTimeline?(Vie(u,this.pendingTimeline),this.pendingTimeline=void 0):u.onfinish=()=>{const{onComplete:h}=this.options;a.set(wL(e,this.options,n)),h&&h(),this.cancel(),this.resolveFinishedPromise()},{animation:u,duration:r,times:i,type:o,ease:s,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:n}=e;return op(n)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:n}=e;return op(n.currentTime||0)}set time(e){const{resolved:n}=this;if(!n)return;const{animation:r}=n;r.currentTime=sp(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:n}=e;return n.playbackRate}set speed(e){const{resolved:n}=this;if(!n)return;const{animation:r}=n;r.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:n}=e;return n.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:n}=e;return n.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:n}=this;if(!n)return gc;const{animation:r}=n;Vie(r,e)}return gc}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:n}=e;n.playState==="finished"&&this.updateFinishedPromise(),n.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:n}=e;n.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:n,keyframes:r,duration:i,type:s,ease:o,times:a}=e;if(n.playState==="idle"||n.playState==="finished")return;if(this.time){const{motionValue:c,onUpdate:u,onComplete:h,element:f,...g}=this.options,y=new GH({...g,keyframes:r,duration:i,type:s,ease:o,times:a,isGenerator:!0}),_=sp(this.time);c.setWithVelocity(y.sample(_-DN).value,y.sample(_).value,DN)}const{onStop:l}=this.options;l&&l(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:n,name:r,repeatDelay:i,repeatType:s,damping:o,type:a}=e;if(!n||!n.owner||!(n.owner.current instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:c}=n.owner.getProps();return Oot()&&r&&Mot.has(r)&&!l&&!c&&!i&&s!=="mirror"&&o!==0&&a!=="inertia"}}const Fot={type:"spring",stiffness:500,damping:25,restSpeed:10},Vot=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),zot={type:"keyframes",duration:.8},Got={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Uot=(t,{keyframes:e})=>e.length>2?zot:_v.has(t)?t.startsWith("scale")?Vot(e[1]):Fot:Got;function Bot({when:t,delay:e,delayChildren:n,staggerChildren:r,staggerDirection:i,repeat:s,repeatType:o,repeatDelay:a,from:l,elapsed:c,...u}){return!!Object.keys(u).length}const UH=(t,e,n,r={},i,s)=>o=>{const a=IH(r,t)||{},l=a.delay||r.delay||0;let{elapsed:c=0}=r;c=c-sp(l);let u={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:e.getVelocity(),...a,delay:-c,onUpdate:f=>{e.set(f),a.onUpdate&&a.onUpdate(f)},onComplete:()=>{o(),a.onComplete&&a.onComplete()},name:t,motionValue:e,element:s?void 0:i};Bot(a)||(u={...u,...Uot(t,u)}),u.duration&&(u.duration=sp(u.duration)),u.repeatDelay&&(u.repeatDelay=sp(u.repeatDelay)),u.from!==void 0&&(u.keyframes[0]=u.from);let h=!1;if((u.type===!1||u.duration===0&&!u.repeatDelay)&&(u.duration=0,u.delay===0&&(h=!0)),h&&!s&&e.get()!==void 0){const f=wL(u.keyframes,a);if(f!==void 0)return mi.update(()=>{u.onUpdate(f),u.onComplete()}),new cst([])}return!s&&nse.supports(u)?new nse(u):new GH(u)};function Wot({protectedKeys:t,needsAnimating:e},n){const r=t.hasOwnProperty(n)&&e[n]!==!0;return e[n]=!1,r}function Owe(t,e,{delay:n=0,transitionOverride:r,type:i}={}){var s;let{transition:o=t.getDefaultTransition(),transitionEnd:a,...l}=e;r&&(o=r);const c=[],u=i&&t.animationState&&t.animationState.getState()[i];for(const h in l){const f=t.getValue(h,(s=t.latestValues[h])!==null&&s!==void 0?s:null),g=l[h];if(g===void 0||u&&Wot(u,h))continue;const y={delay:n,...IH(o||{},h)};let _=!1;if(window.MotionHandoffAnimation){const T=iwe(t);if(T){const A=window.MotionHandoffAnimation(T,h,mi);A!==null&&(y.startTime=A,_=!0)}}az(t,h),f.start(UH(h,f,g,t.shouldReduceMotion&&nwe.has(h)?{type:!1}:y,t,_));const b=f.animation;b&&c.push(b)}return a&&Promise.all(c).then(()=>{mi.update(()=>{a&&Est(t,a)})}),c}function pz(t,e,n={}){var r;const i=xL(t,e,n.type==="exit"?(r=t.presenceContext)===null||r===void 0?void 0:r.custom:void 0);let{transition:s=t.getDefaultTransition()||{}}=i||{};n.transitionOverride&&(s=n.transitionOverride);const o=i?()=>Promise.all(Owe(t,i,n)):()=>Promise.resolve(),a=t.variantChildren&&t.variantChildren.size?(c=0)=>{const{delayChildren:u=0,staggerChildren:h,staggerDirection:f}=s;return Hot(t,e,u+c,h,f,n)}:()=>Promise.resolve(),{when:l}=s;if(l){const[c,u]=l==="beforeChildren"?[o,a]:[a,o];return c().then(()=>u())}else return Promise.all([o(),a(n.delay)])}function Hot(t,e,n=0,r=0,i=1,s){const o=[],a=(t.variantChildren.size-1)*r,l=i===1?(c=0)=>c*r:(c=0)=>a-c*r;return Array.from(t.variantChildren).sort(qot).forEach((c,u)=>{c.notify("AnimationStart",e),o.push(pz(c,e,{...s,delay:n+l(u)}).then(()=>c.notify("AnimationComplete",e)))}),Promise.all(o)}function qot(t,e){return t.sortNodePosition(e)}function Kot(t,e,n={}){t.notify("AnimationStart",e);let r;if(Array.isArray(e)){const i=e.map(s=>pz(t,s,n));r=Promise.all(i)}else if(typeof e=="string")r=pz(t,e,n);else{const i=typeof e=="function"?xL(t,e,n.custom):e;r=Promise.all(Owe(t,i,n))}return r.then(()=>{t.notify("AnimationComplete",e)})}const Yot=gH.length;function Lwe(t){if(!t)return;if(!t.isControllingVariants){const n=t.parent?Lwe(t.parent)||{}:{};return t.props.initial!==void 0&&(n.initial=t.props.initial),n}const e={};for(let n=0;n<Yot;n++){const r=gH[n],i=t.props[r];(fA(i)||i===!1)&&(e[r]=i)}return e}const Xot=[...mH].reverse(),Zot=mH.length;function Jot(t){return e=>Promise.all(e.map(({animation:n,options:r})=>Kot(t,n,r)))}function Qot(t){let e=Jot(t),n=rse(),r=!0;const i=l=>(c,u)=>{var h;const f=xL(t,u,l==="exit"?(h=t.presenceContext)===null||h===void 0?void 0:h.custom:void 0);if(f){const{transition:g,transitionEnd:y,..._}=f;c={...c,..._,...y}}return c};function s(l){e=l(t)}function o(l){const{props:c}=t,u=Lwe(t.parent)||{},h=[],f=new Set;let g={},y=1/0;for(let b=0;b<Zot;b++){const T=Xot[b],A=n[T],I=c[T]!==void 0?c[T]:u[T],P=fA(I),R=T===l?A.isActive:null;R===!1&&(y=b);let D=I===u[T]&&I!==c[T]&&P;if(D&&r&&t.manuallyAnimateOnMount&&(D=!1),A.protectedKeys={...g},!A.isActive&&R===null||!I&&!A.prevProp||vL(I)||typeof I=="boolean")continue;const C=eat(A.prevProp,I);let M=C||T===l&&A.isActive&&!D&&P||b>y&&P,O=!1;const j=Array.isArray(I)?I:[I];let V=j.reduce(i(T),{});R===!1&&(V={});const{prevResolvedValues:U={}}=A,G={...U,...V},de=Ne=>{M=!0,f.has(Ne)&&(O=!0,f.delete(Ne)),A.needsAnimating[Ne]=!0;const fe=t.getValue(Ne);fe&&(fe.liveStyle=!1)};for(const Ne in G){const fe=V[Ne],De=U[Ne];if(g.hasOwnProperty(Ne))continue;let Ce=!1;iz(fe)&&iz(De)?Ce=!Kxe(fe,De):Ce=fe!==De,Ce?fe!=null?de(Ne):f.add(Ne):fe!==void 0&&f.has(Ne)?de(Ne):A.protectedKeys[Ne]=!0}A.prevProp=I,A.prevResolvedValues=V,A.isActive&&(g={...g,...V}),r&&t.blockInitialAnimation&&(M=!1),M&&(!(D&&C)||O)&&h.push(...j.map(Ne=>({animation:Ne,options:{type:T}})))}if(f.size){const b={};f.forEach(T=>{const A=t.getBaseTarget(T),I=t.getValue(T);I&&(I.liveStyle=!0),b[T]=A??null}),h.push({animation:b})}let _=!!h.length;return r&&(c.initial===!1||c.initial===c.animate)&&!t.manuallyAnimateOnMount&&(_=!1),r=!1,_?e(h):Promise.resolve()}function a(l,c){var u;if(n[l].isActive===c)return Promise.resolve();(u=t.variantChildren)===null||u===void 0||u.forEach(f=>{var g;return(g=f.animationState)===null||g===void 0?void 0:g.setActive(l,c)}),n[l].isActive=c;const h=o(l);for(const f in n)n[f].protectedKeys={};return h}return{animateChanges:o,setActive:a,setAnimateFunction:s,getState:()=>n,reset:()=>{n=rse(),r=!0}}}function eat(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!Kxe(e,t):!1}function W0(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function rse(){return{animate:W0(!0),whileInView:W0(),whileHover:W0(),whileTap:W0(),whileDrag:W0(),whileFocus:W0(),exit:W0()}}class c0{constructor(e){this.isMounted=!1,this.node=e}update(){}}class tat extends c0{constructor(e){super(e),e.animationState||(e.animationState=Qot(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();vL(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:n}=this.node.prevProps||{};e!==n&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let nat=0;class rat extends c0{constructor(){super(...arguments),this.id=nat++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:n}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;const i=this.node.animationState.setActive("exit",!e);n&&!e&&i.then(()=>n(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const iat={animation:{Feature:tat},exit:{Feature:rat}};function yA(t,e,n,r={passive:!0}){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n)}function UI(t){return{point:{x:t.pageX,y:t.pageY}}}const sat=t=>e=>RH(e)&&t(e,UI(e));function VT(t,e,n,r){return yA(t,e,sat(n),r)}const ise=(t,e)=>Math.abs(t-e);function oat(t,e){const n=ise(t.x,e.x),r=ise(t.y,e.y);return Math.sqrt(n**2+r**2)}class Dwe{constructor(e,n,{transformPagePoint:r,contextWindow:i,dragSnapToOrigin:s=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const h=z$(this.lastMoveEventInfo,this.history),f=this.startEvent!==null,g=oat(h.offset,{x:0,y:0})>=3;if(!f&&!g)return;const{point:y}=h,{timestamp:_}=Po;this.history.push({...y,timestamp:_});const{onStart:b,onMove:T}=this.handlers;f||(b&&b(this.lastMoveEvent,h),this.startEvent=this.lastMoveEvent),T&&T(this.lastMoveEvent,h)},this.handlePointerMove=(h,f)=>{this.lastMoveEvent=h,this.lastMoveEventInfo=V$(f,this.transformPagePoint),mi.update(this.updatePoint,!0)},this.handlePointerUp=(h,f)=>{this.end();const{onEnd:g,onSessionEnd:y,resumeAnimation:_}=this.handlers;if(this.dragSnapToOrigin&&_&&_(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const b=z$(h.type==="pointercancel"?this.lastMoveEventInfo:V$(f,this.transformPagePoint),this.history);this.startEvent&&g&&g(h,b),y&&y(h,b)},!RH(e))return;this.dragSnapToOrigin=s,this.handlers=n,this.transformPagePoint=r,this.contextWindow=i||window;const o=UI(e),a=V$(o,this.transformPagePoint),{point:l}=a,{timestamp:c}=Po;this.history=[{...l,timestamp:c}];const{onSessionStart:u}=n;u&&u(e,z$(a,this.history)),this.removeListeners=GI(VT(this.contextWindow,"pointermove",this.handlePointerMove),VT(this.contextWindow,"pointerup",this.handlePointerUp),VT(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Hg(this.updatePoint)}}function V$(t,e){return e?{point:e(t.point)}:t}function sse(t,e){return{x:t.x-e.x,y:t.y-e.y}}function z$({point:t},e){return{point:t,delta:sse(t,jwe(e)),offset:sse(t,aat(e)),velocity:lat(e,.1)}}function aat(t){return t[0]}function jwe(t){return t[t.length-1]}function lat(t,e){if(t.length<2)return{x:0,y:0};let n=t.length-1,r=null;const i=jwe(t);for(;n>=0&&(r=t[n],!(i.timestamp-r.timestamp>sp(e)));)n--;if(!r)return{x:0,y:0};const s=op(i.timestamp-r.timestamp);if(s===0)return{x:0,y:0};const o={x:(i.x-r.x)/s,y:(i.y-r.y)/s};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}const $we=1e-4,cat=1-$we,uat=1+$we,Fwe=.01,hat=0-Fwe,dat=0+Fwe;function bc(t){return t.max-t.min}function fat(t,e,n){return Math.abs(t-e)<=n}function ose(t,e,n,r=.5){t.origin=r,t.originPoint=Fi(e.min,e.max,t.origin),t.scale=bc(n)/bc(e),t.translate=Fi(n.min,n.max,t.origin)-t.originPoint,(t.scale>=cat&&t.scale<=uat||isNaN(t.scale))&&(t.scale=1),(t.translate>=hat&&t.translate<=dat||isNaN(t.translate))&&(t.translate=0)}function zT(t,e,n,r){ose(t.x,e.x,n.x,r?r.originX:void 0),ose(t.y,e.y,n.y,r?r.originY:void 0)}function ase(t,e,n){t.min=n.min+e.min,t.max=t.min+bc(e)}function pat(t,e,n){ase(t.x,e.x,n.x),ase(t.y,e.y,n.y)}function lse(t,e,n){t.min=e.min-n.min,t.max=t.min+bc(e)}function GT(t,e,n){lse(t.x,e.x,n.x),lse(t.y,e.y,n.y)}function mat(t,{min:e,max:n},r){return e!==void 0&&t<e?t=r?Fi(e,t,r.min):Math.max(t,e):n!==void 0&&t>n&&(t=r?Fi(n,t,r.max):Math.min(t,n)),t}function cse(t,e,n){return{min:e!==void 0?t.min+e:void 0,max:n!==void 0?t.max+n-(t.max-t.min):void 0}}function gat(t,{top:e,left:n,bottom:r,right:i}){return{x:cse(t.x,n,i),y:cse(t.y,e,r)}}function use(t,e){let n=e.min-t.min,r=e.max-t.max;return e.max-e.min<t.max-t.min&&([n,r]=[r,n]),{min:n,max:r}}function yat(t,e){return{x:use(t.x,e.x),y:use(t.y,e.y)}}function vat(t,e){let n=.5;const r=bc(t),i=bc(e);return i>r?n=j2(e.min,e.max-r,t.min):r>i&&(n=j2(t.min,t.max-i,e.min)),vp(0,1,n)}function _at(t,e){const n={};return e.min!==void 0&&(n.min=e.min-t.min),e.max!==void 0&&(n.max=e.max-t.min),n}const mz=.35;function xat(t=mz){return t===!1?t=0:t===!0&&(t=mz),{x:hse(t,"left","right"),y:hse(t,"top","bottom")}}function hse(t,e,n){return{min:dse(t,e),max:dse(t,n)}}function dse(t,e){return typeof t=="number"?t:t[e]||0}const fse=()=>({translate:0,scale:1,origin:0,originPoint:0}),jx=()=>({x:fse(),y:fse()}),pse=()=>({min:0,max:0}),ls=()=>({x:pse(),y:pse()});function Bc(t){return[t("x"),t("y")]}function Vwe({top:t,left:e,right:n,bottom:r}){return{x:{min:e,max:n},y:{min:t,max:r}}}function wat({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function bat(t,e){if(!e)return t;const n=e({x:t.left,y:t.top}),r=e({x:t.right,y:t.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}function G$(t){return t===void 0||t===1}function gz({scale:t,scaleX:e,scaleY:n}){return!G$(t)||!G$(e)||!G$(n)}function yy(t){return gz(t)||zwe(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function zwe(t){return mse(t.x)||mse(t.y)}function mse(t){return t&&t!=="0%"}function jN(t,e,n){const r=t-n,i=e*r;return n+i}function gse(t,e,n,r,i){return i!==void 0&&(t=jN(t,i,r)),jN(t,n,r)+e}function yz(t,e=0,n=1,r,i){t.min=gse(t.min,e,n,r,i),t.max=gse(t.max,e,n,r,i)}function Gwe(t,{x:e,y:n}){yz(t.x,e.translate,e.scale,e.originPoint),yz(t.y,n.translate,n.scale,n.originPoint)}const yse=.999999999999,vse=1.0000000000001;function Eat(t,e,n,r=!1){const i=n.length;if(!i)return;e.x=e.y=1;let s,o;for(let a=0;a<i;a++){s=n[a],o=s.projectionDelta;const{visualElement:l}=s.options;l&&l.props.style&&l.props.style.display==="contents"||(r&&s.options.layoutScroll&&s.scroll&&s!==s.root&&Fx(t,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,Gwe(t,o)),r&&yy(s.latestValues)&&Fx(t,s.latestValues))}e.x<vse&&e.x>yse&&(e.x=1),e.y<vse&&e.y>yse&&(e.y=1)}function $x(t,e){t.min=t.min+e,t.max=t.max+e}function _se(t,e,n,r,i=.5){const s=Fi(t.min,t.max,i);yz(t,e,n,s,r)}function Fx(t,e){_se(t.x,e.x,e.scaleX,e.scale,e.originX),_se(t.y,e.y,e.scaleY,e.scale,e.originY)}function Uwe(t,e){return Vwe(bat(t.getBoundingClientRect(),e))}function Sat(t,e,n){const r=Uwe(t,n),{scroll:i}=e;return i&&($x(r.x,i.offset.x),$x(r.y,i.offset.y)),r}const Bwe=({current:t})=>t?t.ownerDocument.defaultView:null,Tat=new WeakMap;class kat{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=ls(),this.visualElement=e}start(e,{snapToCursor:n=!1}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const i=u=>{const{dragSnapToOrigin:h}=this.getProps();h?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(UI(u).point)},s=(u,h)=>{const{drag:f,dragPropagation:g,onDragStart:y}=this.getProps();if(f&&!g&&(this.openDragLock&&this.openDragLock(),this.openDragLock=vst(f),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Bc(b=>{let T=this.getAxisMotionValue(b).get()||0;if(Pd.test(T)){const{projection:A}=this.visualElement;if(A&&A.layout){const I=A.layout.layoutBox[b];I&&(T=bc(I)*(parseFloat(T)/100))}}this.originPoint[b]=T}),y&&mi.postRender(()=>y(u,h)),az(this.visualElement,"transform");const{animationState:_}=this.visualElement;_&&_.setActive("whileDrag",!0)},o=(u,h)=>{const{dragPropagation:f,dragDirectionLock:g,onDirectionLock:y,onDrag:_}=this.getProps();if(!f&&!this.openDragLock)return;const{offset:b}=h;if(g&&this.currentDirection===null){this.currentDirection=Aat(b),this.currentDirection!==null&&y&&y(this.currentDirection);return}this.updateAxis("x",h.point,b),this.updateAxis("y",h.point,b),this.visualElement.render(),_&&_(u,h)},a=(u,h)=>this.stop(u,h),l=()=>Bc(u=>{var h;return this.getAnimationState(u)==="paused"&&((h=this.getAxisMotionValue(u).animation)===null||h===void 0?void 0:h.play())}),{dragSnapToOrigin:c}=this.getProps();this.panSession=new Dwe(e,{onSessionStart:i,onStart:s,onMove:o,onSessionEnd:a,resumeAnimation:l},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:c,contextWindow:Bwe(this.visualElement)})}stop(e,n){const r=this.isDragging;if(this.cancel(),!r)return;const{velocity:i}=n;this.startAnimation(i);const{onDragEnd:s}=this.getProps();s&&mi.postRender(()=>s(e,n))}cancel(){this.isDragging=!1;const{projection:e,animationState:n}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(e,n,r){const{drag:i}=this.getProps();if(!r||!wR(e,i,this.currentDirection))return;const s=this.getAxisMotionValue(e);let o=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(o=mat(o,this.constraints[e],this.elastic[e])),s.set(o)}resolveConstraints(){var e;const{dragConstraints:n,dragElastic:r}=this.getProps(),i=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,s=this.constraints;n&&Lx(n)?this.constraints||(this.constraints=this.resolveRefConstraints()):n&&i?this.constraints=gat(i.layoutBox,n):this.constraints=!1,this.elastic=xat(r),s!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&Bc(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=_at(i.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:n}=this.getProps();if(!e||!Lx(e))return!1;const r=e.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const s=Sat(r,i.root,this.visualElement.getTransformPagePoint());let o=yat(i.layout.layoutBox,s);if(n){const a=n(wat(o));this.hasMutatedConstraints=!!a,a&&(o=Vwe(a))}return o}startAnimation(e){const{drag:n,dragMomentum:r,dragElastic:i,dragTransition:s,dragSnapToOrigin:o,onDragTransitionEnd:a}=this.getProps(),l=this.constraints||{},c=Bc(u=>{if(!wR(u,n,this.currentDirection))return;let h=l&&l[u]||{};o&&(h={min:0,max:0});const f=i?200:1e6,g=i?40:1e7,y={type:"inertia",velocity:r?e[u]:0,bounceStiffness:f,bounceDamping:g,timeConstant:750,restDelta:1,restSpeed:10,...s,...h};return this.startAxisValueAnimation(u,y)});return Promise.all(c).then(a)}startAxisValueAnimation(e,n){const r=this.getAxisMotionValue(e);return az(this.visualElement,e),r.start(UH(e,r,0,n,this.visualElement,!1))}stopAnimation(){Bc(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Bc(e=>{var n;return(n=this.getAxisMotionValue(e).animation)===null||n===void 0?void 0:n.pause()})}getAnimationState(e){var n;return(n=this.getAxisMotionValue(e).animation)===null||n===void 0?void 0:n.state}getAxisMotionValue(e){const n=`_drag${e.toUpperCase()}`,r=this.visualElement.getProps(),i=r[n];return i||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){Bc(n=>{const{drag:r}=this.getProps();if(!wR(n,r,this.currentDirection))return;const{projection:i}=this.visualElement,s=this.getAxisMotionValue(n);if(i&&i.layout){const{min:o,max:a}=i.layout.layoutBox[n];s.set(e[n]-Fi(o,a,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:n}=this.getProps(),{projection:r}=this.visualElement;if(!Lx(n)||!r||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};Bc(o=>{const a=this.getAxisMotionValue(o);if(a&&this.constraints!==!1){const l=a.get();i[o]=vat({min:l,max:l},this.constraints[o])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),Bc(o=>{if(!wR(o,e,null))return;const a=this.getAxisMotionValue(o),{min:l,max:c}=this.constraints[o];a.set(Fi(l,c,i[o]))})}addListeners(){if(!this.visualElement.current)return;Tat.set(this.visualElement,this);const e=this.visualElement.current,n=VT(e,"pointerdown",l=>{const{drag:c,dragListener:u=!0}=this.getProps();c&&u&&this.start(l)}),r=()=>{const{dragConstraints:l}=this.getProps();Lx(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,s=i.addEventListener("measure",r);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),mi.read(r);const o=yA(window,"resize",()=>this.scalePositionWithinConstraints()),a=i.addEventListener("didUpdate",(({delta:l,hasLayoutChanged:c})=>{this.isDragging&&c&&(Bc(u=>{const h=this.getAxisMotionValue(u);h&&(this.originPoint[u]+=l[u].translate,h.set(h.get()+l[u].translate))}),this.visualElement.render())}));return()=>{o(),n(),s(),a&&a()}}getProps(){const e=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:r=!1,dragPropagation:i=!1,dragConstraints:s=!1,dragElastic:o=mz,dragMomentum:a=!0}=e;return{...e,drag:n,dragDirectionLock:r,dragPropagation:i,dragConstraints:s,dragElastic:o,dragMomentum:a}}}function wR(t,e,n){return(e===!0||e===t)&&(n===null||n===t)}function Aat(t,e=10){let n=null;return Math.abs(t.y)>e?n="y":Math.abs(t.x)>e&&(n="x"),n}class Iat extends c0{constructor(e){super(e),this.removeGroupControls=gc,this.removeListeners=gc,this.controls=new kat(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||gc}unmount(){this.removeGroupControls(),this.removeListeners()}}const xse=t=>(e,n)=>{t&&mi.postRender(()=>t(e,n))};class Pat extends c0{constructor(){super(...arguments),this.removePointerDownListener=gc}onPointerDown(e){this.session=new Dwe(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:Bwe(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:n,onPan:r,onPanEnd:i}=this.node.getProps();return{onSessionStart:xse(e),onStart:xse(n),onMove:r,onEnd:(s,o)=>{delete this.session,i&&mi.postRender(()=>i(s,o))}}}mount(){this.removePointerDownListener=VT(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const w3={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function wse(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const JE={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(gn.test(t))t=parseFloat(t);else return t;const n=wse(t,e.target.x),r=wse(t,e.target.y);return`${n}% ${r}%`}},Cat={correct:(t,{treeScale:e,projectionDelta:n})=>{const r=t,i=qg.parse(t);if(i.length>5)return r;const s=qg.createTransformer(t),o=typeof i[0]!="number"?1:0,a=n.x.scale*e.x,l=n.y.scale*e.y;i[0+o]/=a,i[1+o]/=l;const c=Fi(a,l,.5);return typeof i[2+o]=="number"&&(i[2+o]/=c),typeof i[3+o]=="number"&&(i[3+o]/=c),s(i)}};class Rat extends Y.Component{componentDidMount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:r,layoutId:i}=this.props,{projection:s}=e;Zit(Mat),s&&(n.group&&n.group.add(s),r&&r.register&&i&&r.register(s),s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),w3.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:n,visualElement:r,drag:i,isPresent:s}=this.props,o=r.projection;return o&&(o.isPresent=s,i||e.layoutDependency!==n||n===void 0?o.willUpdate():this.safeToRemove(),e.isPresent!==s&&(s?o.promote():o.relegate()||mi.postRender(()=>{const a=o.getStack();(!a||!a.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),vH.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:r}=this.props,{projection:i}=e;i&&(i.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(i),r&&r.deregister&&r.deregister(i))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function Wwe(t){const[e,n]=Axe(),r=Y.useContext(uH);return p.jsx(Rat,{...t,layoutGroup:r,switchLayoutGroup:Y.useContext(Lxe),isPresent:e,safeToRemove:n})}const Mat={borderRadius:{...JE,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:JE,borderTopRightRadius:JE,borderBottomLeftRadius:JE,borderBottomRightRadius:JE,boxShadow:Cat};function Nat(t,e,n){const r=fa(t)?t:mA(t);return r.start(UH("",r,e,n)),r.animation}function Oat(t){return t instanceof SVGElement&&t.tagName!=="svg"}const Lat=(t,e)=>t.depth-e.depth;class Dat{constructor(){this.children=[],this.isDirty=!1}add(e){MH(this.children,e),this.isDirty=!0}remove(e){NH(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(Lat),this.isDirty=!1,this.children.forEach(e)}}function jat(t,e){const n=Cd.now(),r=({timestamp:i})=>{const s=i-n;s>=e&&(Hg(r),t(s-e))};return mi.read(r,!0),()=>Hg(r)}const Hwe=["TopLeft","TopRight","BottomLeft","BottomRight"],$at=Hwe.length,bse=t=>typeof t=="string"?parseFloat(t):t,Ese=t=>typeof t=="number"||gn.test(t);function Fat(t,e,n,r,i,s){i?(t.opacity=Fi(0,n.opacity!==void 0?n.opacity:1,Vat(r)),t.opacityExit=Fi(e.opacity!==void 0?e.opacity:1,0,zat(r))):s&&(t.opacity=Fi(e.opacity!==void 0?e.opacity:1,n.opacity!==void 0?n.opacity:1,r));for(let o=0;o<$at;o++){const a=`border${Hwe[o]}Radius`;let l=Sse(e,a),c=Sse(n,a);if(l===void 0&&c===void 0)continue;l||(l=0),c||(c=0),l===0||c===0||Ese(l)===Ese(c)?(t[a]=Math.max(Fi(bse(l),bse(c),r),0),(Pd.test(c)||Pd.test(l))&&(t[a]+="%")):t[a]=c}(e.rotate||n.rotate)&&(t.rotate=Fi(e.rotate||0,n.rotate||0,r))}function Sse(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const Vat=qwe(0,.5,hwe),zat=qwe(.5,.95,gc);function qwe(t,e,n){return r=>r<t?0:r>e?1:n(j2(t,e,r))}function Tse(t,e){t.min=e.min,t.max=e.max}function Dc(t,e){Tse(t.x,e.x),Tse(t.y,e.y)}function kse(t,e){t.translate=e.translate,t.scale=e.scale,t.originPoint=e.originPoint,t.origin=e.origin}function Ase(t,e,n,r,i){return t-=e,t=jN(t,1/n,r),i!==void 0&&(t=jN(t,1/i,r)),t}function Gat(t,e=0,n=1,r=.5,i,s=t,o=t){if(Pd.test(e)&&(e=parseFloat(e),e=Fi(o.min,o.max,e/100)-o.min),typeof e!="number")return;let a=Fi(s.min,s.max,r);t===s&&(a-=e),t.min=Ase(t.min,e,n,a,i),t.max=Ase(t.max,e,n,a,i)}function Ise(t,e,[n,r,i],s,o){Gat(t,e[n],e[r],e[i],e.scale,s,o)}const Uat=["x","scaleX","originX"],Bat=["y","scaleY","originY"];function Pse(t,e,n,r){Ise(t.x,e,Uat,n?n.x:void 0,r?r.x:void 0),Ise(t.y,e,Bat,n?n.y:void 0,r?r.y:void 0)}function Cse(t){return t.translate===0&&t.scale===1}function Kwe(t){return Cse(t.x)&&Cse(t.y)}function Rse(t,e){return t.min===e.min&&t.max===e.max}function Wat(t,e){return Rse(t.x,e.x)&&Rse(t.y,e.y)}function Mse(t,e){return Math.round(t.min)===Math.round(e.min)&&Math.round(t.max)===Math.round(e.max)}function Ywe(t,e){return Mse(t.x,e.x)&&Mse(t.y,e.y)}function Nse(t){return bc(t.x)/bc(t.y)}function Ose(t,e){return t.translate===e.translate&&t.scale===e.scale&&t.originPoint===e.originPoint}class Hat{constructor(){this.members=[]}add(e){MH(this.members,e),e.scheduleRender()}remove(e){if(NH(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(e){const n=this.members.findIndex(i=>e===i);if(n===0)return!1;let r;for(let i=n;i>=0;i--){const s=this.members[i];if(s.isPresent!==!1){r=s;break}}return r?(this.promote(r),!0):!1}promote(e,n){const r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,n&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:i}=e.options;i===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:n,resumingFrom:r}=e;n.onExitComplete&&n.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function qat(t,e,n){let r="";const i=t.x.translate/e.x,s=t.y.translate/e.y,o=n?.z||0;if((i||s||o)&&(r=`translate3d(${i}px, ${s}px, ${o}px) `),(e.x!==1||e.y!==1)&&(r+=`scale(${1/e.x}, ${1/e.y}) `),n){const{transformPerspective:c,rotate:u,rotateX:h,rotateY:f,skewX:g,skewY:y}=n;c&&(r=`perspective(${c}px) ${r}`),u&&(r+=`rotate(${u}deg) `),h&&(r+=`rotateX(${h}deg) `),f&&(r+=`rotateY(${f}deg) `),g&&(r+=`skewX(${g}deg) `),y&&(r+=`skewY(${y}deg) `)}const a=t.x.scale*e.x,l=t.y.scale*e.y;return(a!==1||l!==1)&&(r+=`scale(${a}, ${l})`),r||"none"}const vy={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},HS=typeof window<"u"&&window.MotionDebug!==void 0,U$=["","X","Y","Z"],Kat={visibility:"hidden"},Lse=1e3;let Yat=0;function B$(t,e,n,r){const{latestValues:i}=e;i[t]&&(n[t]=i[t],e.setStaticValue(t,0),r&&(r[t]=0))}function Xwe(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:e}=t.options;if(!e)return;const n=iwe(e);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:i,layoutId:s}=t.options;window.MotionCancelOptimisedAnimation(n,"transform",mi,!(i||s))}const{parent:r}=t;r&&!r.hasCheckedOptimisedAppear&&Xwe(r)}function Zwe({attachResizeListener:t,defaultParent:e,measureScroll:n,checkIsScrollRoot:r,resetTransform:i}){return class{constructor(o={},a=e?.()){this.id=Yat++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,HS&&(vy.totalNodes=vy.resolvedTargetDeltas=vy.recalculatedProjection=0),this.nodes.forEach(Jat),this.nodes.forEach(rlt),this.nodes.forEach(ilt),this.nodes.forEach(Qat),HS&&window.MotionDebug.record(vy)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=a?a.root||a:this,this.path=a?[...a.path,a]:[],this.parent=a,this.depth=a?a.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new Dat)}addEventListener(o,a){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new OH),this.eventHandlers.get(o).add(a)}notifyListeners(o,...a){const l=this.eventHandlers.get(o);l&&l.notify(...a)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,a=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=Oat(o),this.instance=o;const{layoutId:l,layout:c,visualElement:u}=this.options;if(u&&!u.current&&u.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),a&&(c||l)&&(this.isLayoutDirty=!0),t){let h;const f=()=>this.root.updateBlockedByResize=!1;t(o,()=>{this.root.updateBlockedByResize=!0,h&&h(),h=jat(f,250),w3.hasAnimatedSinceResize&&(w3.hasAnimatedSinceResize=!1,this.nodes.forEach(jse))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&u&&(l||c)&&this.addEventListener("didUpdate",({delta:h,hasLayoutChanged:f,hasRelativeTargetChanged:g,layout:y})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const _=this.options.transition||u.getDefaultTransition()||clt,{onLayoutAnimationStart:b,onLayoutAnimationComplete:T}=u.getProps(),A=!this.targetLayout||!Ywe(this.targetLayout,y)||g,I=!f&&g;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||I||f&&(A||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(h,I);const P={...IH(_,"layout"),onPlay:b,onComplete:T};(u.shouldReduceMotion||this.options.layoutRoot)&&(P.delay=0,P.type=!1),this.startAnimation(P)}else f||jse(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=y})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Hg(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(slt),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&Xwe(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const h=this.path[u];h.shouldResetTransform=!0,h.updateScroll("snapshot"),h.options.layoutRoot&&h.willUpdate(!1)}const{layoutId:a,layout:l}=this.options;if(a===void 0&&!l)return;const c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(Dse);return}this.isUpdating||this.nodes.forEach(tlt),this.isUpdating=!1,this.nodes.forEach(nlt),this.nodes.forEach(Xat),this.nodes.forEach(Zat),this.clearAllSnapshots();const a=Cd.now();Po.delta=vp(0,1e3/60,a-Po.timestamp),Po.timestamp=a,Po.isProcessing=!0,O$.update.process(Po),O$.preRender.process(Po),O$.render.process(Po),Po.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,vH.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(elt),this.sharedNodes.forEach(olt)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,mi.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){mi.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=ls(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:a}=this.options;a&&a.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let a=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(a=!1),a){const l=r(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:l,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!i)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,a=this.projectionDelta&&!Kwe(this.projectionDelta),l=this.getTransformTemplate(),c=l?l(this.latestValues,""):void 0,u=c!==this.prevTransformTemplateValue;o&&(a||yy(this.latestValues)||u)&&(i(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const a=this.measurePageBox();let l=this.removeElementScroll(a);return o&&(l=this.removeTransform(l)),ult(l),{animationId:this.root.animationId,measuredBox:a,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var o;const{visualElement:a}=this.options;if(!a)return ls();const l=a.measureViewportBox();if(!(((o=this.scroll)===null||o===void 0?void 0:o.wasRoot)||this.path.some(hlt))){const{scroll:u}=this.root;u&&($x(l.x,u.offset.x),$x(l.y,u.offset.y))}return l}removeElementScroll(o){var a;const l=ls();if(Dc(l,o),!((a=this.scroll)===null||a===void 0)&&a.wasRoot)return l;for(let c=0;c<this.path.length;c++){const u=this.path[c],{scroll:h,options:f}=u;u!==this.root&&h&&f.layoutScroll&&(h.wasRoot&&Dc(l,o),$x(l.x,h.offset.x),$x(l.y,h.offset.y))}return l}applyTransform(o,a=!1){const l=ls();Dc(l,o);for(let c=0;c<this.path.length;c++){const u=this.path[c];!a&&u.options.layoutScroll&&u.scroll&&u!==u.root&&Fx(l,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),yy(u.latestValues)&&Fx(l,u.latestValues)}return yy(this.latestValues)&&Fx(l,this.latestValues),l}removeTransform(o){const a=ls();Dc(a,o);for(let l=0;l<this.path.length;l++){const c=this.path[l];if(!c.instance||!yy(c.latestValues))continue;gz(c.latestValues)&&c.updateSnapshot();const u=ls(),h=c.measurePageBox();Dc(u,h),Pse(a,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,u)}return yy(this.latestValues)&&Pse(a,this.latestValues),a}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Po.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var a;const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==l;if(!(o||c&&this.isSharedProjectionDirty||this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:h,layoutId:f}=this.options;if(!(!this.layout||!(h||f))){if(this.resolvedRelativeTargetAt=Po.timestamp,!this.targetDelta&&!this.relativeTarget){const g=this.getClosestProjectingParent();g&&g.layout&&this.animationProgress!==1?(this.relativeParent=g,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ls(),this.relativeTargetOrigin=ls(),GT(this.relativeTargetOrigin,this.layout.layoutBox,g.layout.layoutBox),Dc(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=ls(),this.targetWithTransforms=ls()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),pat(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Dc(this.target,this.layout.layoutBox),Gwe(this.target,this.targetDelta)):Dc(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const g=this.getClosestProjectingParent();g&&!!g.resumingFrom==!!this.resumingFrom&&!g.options.layoutScroll&&g.target&&this.animationProgress!==1?(this.relativeParent=g,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ls(),this.relativeTargetOrigin=ls(),GT(this.relativeTargetOrigin,this.target,g.target),Dc(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}HS&&vy.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||gz(this.parent.latestValues)||zwe(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const a=this.getLead(),l=!!this.resumingFrom||this!==a;let c=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(c=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===Po.timestamp&&(c=!1),c)return;const{layout:u,layoutId:h}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||h))return;Dc(this.layoutCorrected,this.layout.layoutBox);const f=this.treeScale.x,g=this.treeScale.y;Eat(this.layoutCorrected,this.treeScale,this.path,l),a.layout&&!a.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(a.target=a.layout.layoutBox,a.targetWithTransforms=ls());const{target:y}=a;if(!y){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(kse(this.prevProjectionDelta.x,this.projectionDelta.x),kse(this.prevProjectionDelta.y,this.projectionDelta.y)),zT(this.projectionDelta,this.layoutCorrected,y,this.latestValues),(this.treeScale.x!==f||this.treeScale.y!==g||!Ose(this.projectionDelta.x,this.prevProjectionDelta.x)||!Ose(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",y)),HS&&vy.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var a;if((a=this.options.visualElement)===null||a===void 0||a.scheduleRender(),o){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=jx(),this.projectionDelta=jx(),this.projectionDeltaWithTransform=jx()}setAnimationOrigin(o,a=!1){const l=this.snapshot,c=l?l.latestValues:{},u={...this.latestValues},h=jx();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!a;const f=ls(),g=l?l.source:void 0,y=this.layout?this.layout.source:void 0,_=g!==y,b=this.getStack(),T=!b||b.members.length<=1,A=!!(_&&!T&&this.options.crossfade===!0&&!this.path.some(llt));this.animationProgress=0;let I;this.mixTargetDelta=P=>{const R=P/1e3;$se(h.x,o.x,R),$se(h.y,o.y,R),this.setTargetDelta(h),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(GT(f,this.layout.layoutBox,this.relativeParent.layout.layoutBox),alt(this.relativeTarget,this.relativeTargetOrigin,f,R),I&&Wat(this.relativeTarget,I)&&(this.isProjectionDirty=!1),I||(I=ls()),Dc(I,this.relativeTarget)),_&&(this.animationValues=u,Fat(u,c,this.latestValues,R,A,T)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=R},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Hg(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=mi.update(()=>{w3.hasAnimatedSinceResize=!0,this.currentAnimation=Nat(0,Lse,{...o,onUpdate:a=>{this.mixTargetDelta(a),o.onUpdate&&o.onUpdate(a)},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(Lse),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:a,target:l,layout:c,latestValues:u}=o;if(!(!a||!l||!c)){if(this!==o&&this.layout&&c&&Jwe(this.options.animationType,this.layout.layoutBox,c.layoutBox)){l=this.target||ls();const h=bc(this.layout.layoutBox.x);l.x.min=o.target.x.min,l.x.max=l.x.min+h;const f=bc(this.layout.layoutBox.y);l.y.min=o.target.y.min,l.y.max=l.y.min+f}Dc(a,l),Fx(a,u),zT(this.projectionDeltaWithTransform,this.layoutCorrected,a,u)}}registerSharedNode(o,a){this.sharedNodes.has(o)||this.sharedNodes.set(o,new Hat),this.sharedNodes.get(o).add(a);const c=a.options.initialPromotionConfig;a.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(a):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:a}=this.options;return a?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:a}=this.options;return a?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:a,preserveFollowOpacity:l}={}){const c=this.getStack();c&&c.promote(this,l),o&&(this.projectionDelta=void 0,this.needsReset=!0),a&&this.setOptions({transition:a})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let a=!1;const{latestValues:l}=o;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(a=!0),!a)return;const c={};l.z&&B$("z",o,c,this.animationValues);for(let u=0;u<U$.length;u++)B$(`rotate${U$[u]}`,o,c,this.animationValues),B$(`skew${U$[u]}`,o,c,this.animationValues);o.render();for(const u in c)o.setStaticValue(u,c[u]),this.animationValues&&(this.animationValues[u]=c[u]);o.scheduleRender()}getProjectionStyles(o){var a,l;if(!this.instance||this.isSVG)return;if(!this.isVisible)return Kat;const c={visibility:""},u=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,c.opacity="",c.pointerEvents=_3(o?.pointerEvents)||"",c.transform=u?u(this.latestValues,""):"none",c;const h=this.getLead();if(!this.projectionDelta||!this.layout||!h.target){const _={};return this.options.layoutId&&(_.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,_.pointerEvents=_3(o?.pointerEvents)||""),this.hasProjected&&!yy(this.latestValues)&&(_.transform=u?u({},""):"none",this.hasProjected=!1),_}const f=h.animationValues||h.latestValues;this.applyTransformsToTarget(),c.transform=qat(this.projectionDeltaWithTransform,this.treeScale,f),u&&(c.transform=u(f,c.transform));const{x:g,y}=this.projectionDelta;c.transformOrigin=`${g.origin*100}% ${y.origin*100}% 0`,h.animationValues?c.opacity=h===this?(l=(a=f.opacity)!==null&&a!==void 0?a:this.latestValues.opacity)!==null&&l!==void 0?l:1:this.preserveOpacity?this.latestValues.opacity:f.opacityExit:c.opacity=h===this?f.opacity!==void 0?f.opacity:"":f.opacityExit!==void 0?f.opacityExit:0;for(const _ in MN){if(f[_]===void 0)continue;const{correct:b,applyTo:T}=MN[_],A=c.transform==="none"?f[_]:b(f[_],h);if(T){const I=T.length;for(let P=0;P<I;P++)c[T[P]]=A}else c[_]=A}return this.options.layoutId&&(c.pointerEvents=h===this?_3(o?.pointerEvents)||"":"none"),c}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var a;return(a=o.currentAnimation)===null||a===void 0?void 0:a.stop()}),this.root.nodes.forEach(Dse),this.root.sharedNodes.clear()}}}function Xat(t){t.updateLayout()}function Zat(t){var e;const n=((e=t.resumeFrom)===null||e===void 0?void 0:e.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&n&&t.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:i}=t.layout,{animationType:s}=t.options,o=n.source!==t.layout.source;s==="size"?Bc(h=>{const f=o?n.measuredBox[h]:n.layoutBox[h],g=bc(f);f.min=r[h].min,f.max=f.min+g}):Jwe(s,n.layoutBox,r)&&Bc(h=>{const f=o?n.measuredBox[h]:n.layoutBox[h],g=bc(r[h]);f.max=f.min+g,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[h].max=t.relativeTarget[h].min+g)});const a=jx();zT(a,r,n.layoutBox);const l=jx();o?zT(l,t.applyTransform(i,!0),n.measuredBox):zT(l,r,n.layoutBox);const c=!Kwe(a);let u=!1;if(!t.resumeFrom){const h=t.getClosestProjectingParent();if(h&&!h.resumeFrom){const{snapshot:f,layout:g}=h;if(f&&g){const y=ls();GT(y,n.layoutBox,f.layoutBox);const _=ls();GT(_,r,g.layoutBox),Ywe(y,_)||(u=!0),h.options.layoutRoot&&(t.relativeTarget=_,t.relativeTargetOrigin=y,t.relativeParent=h)}}}t.notifyListeners("didUpdate",{layout:r,snapshot:n,delta:l,layoutDelta:a,hasLayoutChanged:c,hasRelativeTargetChanged:u})}else if(t.isLead()){const{onExitComplete:r}=t.options;r&&r()}t.options.transition=void 0}function Jat(t){HS&&vy.totalNodes++,t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function Qat(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function elt(t){t.clearSnapshot()}function Dse(t){t.clearMeasurements()}function tlt(t){t.isLayoutDirty=!1}function nlt(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function jse(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function rlt(t){t.resolveTargetDelta()}function ilt(t){t.calcProjection()}function slt(t){t.resetSkewAndRotation()}function olt(t){t.removeLeadSnapshot()}function $se(t,e,n){t.translate=Fi(e.translate,0,n),t.scale=Fi(e.scale,1,n),t.origin=e.origin,t.originPoint=e.originPoint}function Fse(t,e,n,r){t.min=Fi(e.min,n.min,r),t.max=Fi(e.max,n.max,r)}function alt(t,e,n,r){Fse(t.x,e.x,n.x,r),Fse(t.y,e.y,n.y,r)}function llt(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const clt={duration:.45,ease:[.4,0,.1,1]},Vse=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),zse=Vse("applewebkit/")&&!Vse("chrome/")?Math.round:gc;function Gse(t){t.min=zse(t.min),t.max=zse(t.max)}function ult(t){Gse(t.x),Gse(t.y)}function Jwe(t,e,n){return t==="position"||t==="preserve-aspect"&&!fat(Nse(e),Nse(n),.2)}function hlt(t){var e;return t!==t.root&&((e=t.scroll)===null||e===void 0?void 0:e.wasRoot)}const dlt=Zwe({attachResizeListener:(t,e)=>yA(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),W$={current:void 0},Qwe=Zwe({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!W$.current){const t=new dlt({});t.mount(window),t.setOptions({layoutScroll:!0}),W$.current=t}return W$.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),flt={pan:{Feature:Pat},drag:{Feature:Iat,ProjectionNode:Qwe,MeasureLayout:Wwe}};function Use(t,e,n){const{props:r}=t;t.animationState&&r.whileHover&&t.animationState.setActive("whileHover",n==="Start");const i="onHover"+n,s=r[i];s&&mi.postRender(()=>s(e,UI(e)))}class plt extends c0{mount(){const{current:e}=this.node;e&&(this.unmount=fst(e,n=>(Use(this.node,n,"Start"),r=>Use(this.node,r,"End"))))}unmount(){}}class mlt extends c0{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=GI(yA(this.node.current,"focus",()=>this.onFocus()),yA(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function Bse(t,e,n){const{props:r}=t;t.animationState&&r.whileTap&&t.animationState.setActive("whileTap",n==="Start");const i="onTap"+(n==="End"?"":n),s=r[i];s&&mi.postRender(()=>s(e,UI(e)))}class glt extends c0{mount(){const{current:e}=this.node;e&&(this.unmount=yst(e,n=>(Bse(this.node,n,"Start"),(r,{success:i})=>Bse(this.node,r,i?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const vz=new WeakMap,H$=new WeakMap,ylt=t=>{const e=vz.get(t.target);e&&e(t)},vlt=t=>{t.forEach(ylt)};function _lt({root:t,...e}){const n=t||document;H$.has(n)||H$.set(n,{});const r=H$.get(n),i=JSON.stringify(e);return r[i]||(r[i]=new IntersectionObserver(vlt,{root:t,...e})),r[i]}function xlt(t,e,n){const r=_lt(e);return vz.set(t,n),r.observe(t),()=>{vz.delete(t),r.unobserve(t)}}const wlt={some:0,all:1};class blt extends c0{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:n,margin:r,amount:i="some",once:s}=e,o={root:n?n.current:void 0,rootMargin:r,threshold:typeof i=="number"?i:wlt[i]},a=l=>{const{isIntersecting:c}=l;if(this.isInView===c||(this.isInView=c,s&&!c&&this.hasEnteredView))return;c&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",c);const{onViewportEnter:u,onViewportLeave:h}=this.node.getProps(),f=c?u:h;f&&f(l)};return xlt(this.node.current,o,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:n}=this.node;["amount","margin","root"].some(Elt(e,n))&&this.startObserver()}unmount(){}}function Elt({viewport:t={}},{viewport:e={}}={}){return n=>t[n]!==e[n]}const Slt={inView:{Feature:blt},tap:{Feature:glt},focus:{Feature:mlt},hover:{Feature:plt}},Tlt={layout:{ProjectionNode:Qwe,MeasureLayout:Wwe}},_z={current:null},e2e={current:!1};function klt(){if(e2e.current=!0,!!fH)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>_z.current=t.matches;t.addListener(e),e()}else _z.current=!1}const Alt=[...Twe,ea,qg],Ilt=t=>Alt.find(Swe(t)),Wse=new WeakMap;function Plt(t,e,n){for(const r in e){const i=e[r],s=n[r];if(fa(i))t.addValue(r,i);else if(fa(s))t.addValue(r,mA(i,{owner:t}));else if(s!==i)if(t.hasValue(r)){const o=t.getValue(r);o.liveStyle===!0?o.jump(i):o.hasAnimated||o.set(i)}else{const o=t.getStaticValue(r);t.addValue(r,mA(o!==void 0?o:i,{owner:t}))}}for(const r in n)e[r]===void 0&&t.removeValue(r);return e}const Hse=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class Clt{scrapeMotionValuesFromProps(e,n,r){return{}}constructor({parent:e,props:n,presenceContext:r,reducedMotionConfig:i,blockInitialAnimation:s,visualState:o},a={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=VH,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const g=Cd.now();this.renderScheduledAt<g&&(this.renderScheduledAt=g,mi.render(this.render,!1,!0))};const{latestValues:l,renderState:c,onUpdate:u}=o;this.onUpdate=u,this.latestValues=l,this.baseTarget={...l},this.initialValues=n.initial?{...l}:{},this.renderState=c,this.parent=e,this.props=n,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=i,this.options=a,this.blockInitialAnimation=!!s,this.isControllingVariants=_L(n),this.isVariantNode=Nxe(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:h,...f}=this.scrapeMotionValuesFromProps(n,{},this);for(const g in f){const y=f[g];l[g]!==void 0&&fa(y)&&y.set(l[g],!1)}}mount(e){this.current=e,Wse.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,r)=>this.bindToMotionValue(r,n)),e2e.current||klt(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:_z.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){Wse.delete(this.current),this.projection&&this.projection.unmount(),Hg(this.notifyUpdate),Hg(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const n=this.features[e];n&&(n.unmount(),n.isMounted=!1)}this.current=null}bindToMotionValue(e,n){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const r=_v.has(e),i=n.on("change",a=>{this.latestValues[e]=a,this.props.onUpdate&&mi.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0)}),s=n.on("renderRequest",this.scheduleRender);let o;window.MotionCheckAppearSync&&(o=window.MotionCheckAppearSync(this,e,n)),this.valueSubscriptions.set(e,()=>{i(),s(),o&&o(),n.owner&&n.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in $2){const n=$2[e];if(!n)continue;const{isEnabled:r,Feature:i}=n;if(!this.features[e]&&i&&r(this.props)&&(this.features[e]=new i(this)),this.features[e]){const s=this.features[e];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):ls()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,n){this.latestValues[e]=n}update(e,n){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let r=0;r<Hse.length;r++){const i=Hse[r];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const s="on"+i,o=e[s];o&&(this.propEventSubscriptions[i]=this.on(i,o))}this.prevMotionValues=Plt(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(e),()=>n.variantChildren.delete(e)}addValue(e,n){const r=this.values.get(e);n!==r&&(r&&this.removeValue(e),this.bindToMotionValue(e,n),this.values.set(e,n),this.latestValues[e]=n.get())}removeValue(e){this.values.delete(e);const n=this.valueSubscriptions.get(e);n&&(n(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,n){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return r===void 0&&n!==void 0&&(r=mA(n===null?void 0:n,{owner:this}),this.addValue(e,r)),r}readValue(e,n){var r;let i=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(r=this.getBaseTargetFromProps(this.props,e))!==null&&r!==void 0?r:this.readValueFromInstance(this.current,e,this.options);return i!=null&&(typeof i=="string"&&(bwe(i)||fwe(i))?i=parseFloat(i):!Ilt(i)&&qg.test(n)&&(i=_we(e,n)),this.setBaseTarget(e,fa(i)?i.get():i)),fa(i)?i.get():i}setBaseTarget(e,n){this.baseTarget[e]=n}getBaseTarget(e){var n;const{initial:r}=this.props;let i;if(typeof r=="string"||typeof r=="object"){const o=xH(this.props,r,(n=this.presenceContext)===null||n===void 0?void 0:n.custom);o&&(i=o[e])}if(r&&i!==void 0)return i;const s=this.getBaseTargetFromProps(this.props,e);return s!==void 0&&!fa(s)?s:this.initialValues[e]!==void 0&&i===void 0?void 0:this.baseTarget[e]}on(e,n){return this.events[e]||(this.events[e]=new OH),this.events[e].add(n)}notify(e,...n){this.events[e]&&this.events[e].notify(...n)}}class t2e extends Clt{constructor(){super(...arguments),this.KeyframeResolver=kwe}sortInstanceNodePosition(e,n){return e.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(e,n){return e.style?e.style[n]:void 0}removeValueFromRenderState(e,{vars:n,style:r}){delete n[e],delete r[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;fa(e)&&(this.childSubscription=e.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}function Rlt(t){return window.getComputedStyle(t)}class Mlt extends t2e{constructor(){super(...arguments),this.type="html",this.renderInstance=Gxe}readValueFromInstance(e,n){if(_v.has(n)){const r=FH(n);return r&&r.default||0}else{const r=Rlt(e),i=(Fxe(n)?r.getPropertyValue(n):r[n])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(e,{transformPagePoint:n}){return Uwe(e,n)}build(e,n,r){EH(e,n,r.transformTemplate)}scrapeMotionValuesFromProps(e,n,r){return AH(e,n,r)}}class Nlt extends t2e{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=ls}getBaseTargetFromProps(e,n){return e[n]}readValueFromInstance(e,n){if(_v.has(n)){const r=FH(n);return r&&r.default||0}return n=Uxe.has(n)?n:yH(n),e.getAttribute(n)}scrapeMotionValuesFromProps(e,n,r){return Hxe(e,n,r)}build(e,n,r){SH(e,n,this.isSVGTag,r.transformTemplate)}renderInstance(e,n,r,i){Bxe(e,n,r,i)}mount(e){this.isSVGTag=kH(e.tagName),super.mount(e)}}const Olt=(t,e)=>_H(t)?new Nlt(e):new Mlt(e,{allowProjection:t!==Y.Fragment}),Llt=ost({...iat,...Slt,...flt,...Tlt},Olt),_t=wit(Llt);const Dlt=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),jlt=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,n,r)=>r?r.toUpperCase():n.toLowerCase()),qse=t=>{const e=jlt(t);return e.charAt(0).toUpperCase()+e.slice(1)},n2e=(...t)=>t.filter((e,n,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===n).join(" ").trim(),$lt=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var Flt={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Vlt=Y.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:i="",children:s,iconNode:o,...a},l)=>Y.createElement("svg",{ref:l,...Flt,width:e,height:e,stroke:t,strokeWidth:r?Number(n)*24/Number(e):n,className:n2e("lucide",i),...!s&&!$lt(a)&&{"aria-hidden":"true"},...a},[...o.map(([c,u])=>Y.createElement(c,u)),...Array.isArray(s)?s:[s]]));const at=(t,e)=>{const n=Y.forwardRef(({className:r,...i},s)=>Y.createElement(Vlt,{ref:s,iconNode:e,className:n2e(`lucide-${Dlt(qse(t))}`,`lucide-${t}`,r),...i}));return n.displayName=qse(t),n};const zlt=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h2",key:"tvwodi"}],["path",{d:"M20 8v11a2 2 0 0 1-2 2h-2",key:"1gkqxj"}],["path",{d:"m9 15 3-3 3 3",key:"1pd0qc"}],["path",{d:"M12 12v9",key:"192myk"}]],Glt=at("archive-restore",zlt);const Ult=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],r2e=at("archive",Ult);const Blt=[["path",{d:"M4.929 4.929 19.07 19.071",key:"196cmz"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Wlt=at("ban",Blt);const Hlt=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],i2e=at("book-open",Hlt);const qlt=[["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M14 7a4 4 0 0 1 4 4v3a6 6 0 0 1-12 0v-3a4 4 0 0 1 4-4z",key:"uouzyp"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M21 21a4 4 0 0 0-3.81-4",key:"1b0z45"}],["path",{d:"M21 5a4 4 0 0 1-3.55 3.97",key:"5cxbf6"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M3 21a4 4 0 0 1 3.81-4",key:"1fjd4g"}],["path",{d:"M3 5a4 4 0 0 0 3.55 3.97",key:"1d7oge"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M9 7.13V6a3 3 0 1 1 6 0v1.13",key:"1vgav8"}]],s2e=at("bug",qlt);const Klt=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],BH=at("calendar",Klt);const Ylt=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],bL=at("camera",Ylt);const Xlt=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],o2e=at("chart-column",Xlt);const Zlt=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],_p=at("check",Zlt);const Jlt=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Eb=at("chevron-down",Jlt);const Qlt=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],a2e=at("chevron-left",Qlt);const ect=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Sb=at("chevron-right",ect);const tct=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],EL=at("chevron-up",tct);const nct=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],l2e=at("circle-alert",nct);const rct=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],ict=at("circle-check-big",rct);const sct=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],oct=at("circle",sct);const act=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],$N=at("clock",act);const lct=[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M16 17H7",key:"pygtm1"}],["path",{d:"M17 21H9",key:"1u2q02"}]],cct=at("cloud-fog",lct);const uct=[["path",{d:"M6 16.326A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 .5 8.973",key:"1cez44"}],["path",{d:"m13 12-3 5h4l-3 5",key:"1t22er"}]],hct=at("cloud-lightning",uct);const dct=[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5.782 5.782A7 7 0 0 0 9 19h8.5a4.5 4.5 0 0 0 1.307-.193",key:"yfwify"}],["path",{d:"M21.532 16.5A4.5 4.5 0 0 0 17.5 10h-1.79A7.008 7.008 0 0 0 10 5.07",key:"jlfiyv"}]],fct=at("cloud-off",dct);const pct=[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M16 14v6",key:"1j4efv"}],["path",{d:"M8 14v6",key:"17c4r9"}],["path",{d:"M12 16v6",key:"c8a4gj"}]],WH=at("cloud-rain",pct);const mct=[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M8 15h.01",key:"a7atzg"}],["path",{d:"M8 19h.01",key:"puxtts"}],["path",{d:"M12 17h.01",key:"p32p05"}],["path",{d:"M12 21h.01",key:"h35vbk"}],["path",{d:"M16 15h.01",key:"rnfrdf"}],["path",{d:"M16 19h.01",key:"1vcnzz"}]],gct=at("cloud-snow",mct);const yct=[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]],xp=at("cloud",yct);const vct=[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]],_ct=at("code",vct);const xct=[["path",{d:"m16.24 7.76-1.804 5.411a2 2 0 0 1-1.265 1.265L7.76 16.24l1.804-5.411a2 2 0 0 1 1.265-1.265z",key:"9ktpf1"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],c2e=at("compass",xct);const wct=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"22",x2:"18",y1:"12",y2:"12",key:"l9bcsi"}],["line",{x1:"6",x2:"2",y1:"12",y2:"12",key:"13hhkx"}],["line",{x1:"12",x2:"12",y1:"6",y2:"2",key:"10w3f3"}],["line",{x1:"12",x2:"12",y1:"22",y2:"18",key:"15g9kq"}]],FN=at("crosshair",wct);const bct=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],vA=at("download",bct);const Ect=[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]],Sct=at("droplets",Ect);const Tct=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],Tg=at("external-link",Tct);const kct=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],VN=at("eye-off",kct);const Act=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],zN=at("eye",Act);const Ict=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["circle",{cx:"10",cy:"12",r:"2",key:"737tya"}],["path",{d:"m20 17-1.296-1.296a2.41 2.41 0 0 0-3.408 0L9 22",key:"wt3hpn"}]],Kse=at("file-image",Ict);const Pct=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],HH=at("file-text",Pct);const Cct=[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4",key:"1slcih"}]],Rct=at("flame",Cct);const Mct=[["path",{d:"M12 5a3 3 0 1 1 3 3m-3-3a3 3 0 1 0-3 3m3-3v1M9 8a3 3 0 1 0 3 3M9 8h1m5 0a3 3 0 1 1-3 3m3-3h-1m-2 3v-1",key:"3pnvol"}],["circle",{cx:"12",cy:"8",r:"2",key:"1822b1"}],["path",{d:"M12 10v12",key:"6ubwww"}],["path",{d:"M12 22c4.2 0 7-1.667 7-5-4.2 0-7 1.667-7 5Z",key:"9hd38g"}],["path",{d:"M12 22c-4.2 0-7-1.667-7-5 4.2 0 7 1.667 7 5Z",key:"ufn41s"}]],Yse=at("flower-2",Mct);const Nct=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],Oct=at("folder-open",Nct);const Lct=[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],Dct=at("folder-plus",Lct);const jct=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],$ct=at("folder",jct);const Fct=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],u2e=at("funnel",Fct);const Vct=[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]],zct=at("gauge",Vct);const Gct=[["path",{d:"M10.5 3 8 9l4 13 4-13-2.5-6",key:"b3dvk1"}],["path",{d:"M17 3a2 2 0 0 1 1.6.8l3 4a2 2 0 0 1 .013 2.382l-7.99 10.986a2 2 0 0 1-3.247 0l-7.99-10.986A2 2 0 0 1 2.4 7.8l2.998-3.997A2 2 0 0 1 7 3z",key:"7w4byz"}],["path",{d:"M2 9h20",key:"16fsjt"}]],Uct=at("gem",Gct);const Bct=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],Wct=at("globe",Bct);const Hct=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],h2e=at("grid-3x3",Hct);const qct=[["circle",{cx:"12",cy:"9",r:"1",key:"124mty"}],["circle",{cx:"19",cy:"9",r:"1",key:"1ruzo2"}],["circle",{cx:"5",cy:"9",r:"1",key:"1a8b28"}],["circle",{cx:"12",cy:"15",r:"1",key:"1e56xg"}],["circle",{cx:"19",cy:"15",r:"1",key:"1a92ep"}],["circle",{cx:"5",cy:"15",r:"1",key:"5r1jwy"}]],d2e=at("grip-horizontal",qct);const Kct=[["path",{d:"M16 5h6",key:"1vod17"}],["path",{d:"M19 2v6",key:"4bpg5p"}],["path",{d:"M21 11.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7.5",key:"1ue2ih"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}]],Yct=at("image-plus",Kct);const Xct=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],qH=at("info",Xct);const Zct=[["path",{d:"M10 18v-7",key:"wt116b"}],["path",{d:"M11.12 2.198a2 2 0 0 1 1.76.006l7.866 3.847c.476.233.31.949-.22.949H3.474c-.53 0-.695-.716-.22-.949z",key:"1m329m"}],["path",{d:"M14 18v-7",key:"vav6t3"}],["path",{d:"M18 18v-7",key:"aexdmj"}],["path",{d:"M3 22h18",key:"8prr45"}],["path",{d:"M6 18v-7",key:"1ivflk"}]],f2e=at("landmark",Zct);const Jct=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],yc=at("layers",Jct);const Qct=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],p2e=at("list",Qct);const eut=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],BI=at("loader-circle",eut);const tut=[["line",{x1:"2",x2:"5",y1:"12",y2:"12",key:"bvdh0s"}],["line",{x1:"19",x2:"22",y1:"12",y2:"12",key:"1tbv5k"}],["line",{x1:"12",x2:"12",y1:"2",y2:"5",key:"11lu5j"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}],["circle",{cx:"12",cy:"12",r:"7",key:"fim9np"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],nut=at("locate-fixed",tut);const rut=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],xz=at("lock",rut);const iut=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],KH=at("log-out",iut);const sut=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],Il=at("map-pin",sut);const out=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],SL=at("map",out);const aut=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],m2e=at("menu",aut);const lut=[["path",{d:"M5 12h14",key:"1ays0h"}]],YH=at("minus",lut);const cut=[["path",{d:"m8 3 4 8 5-5 5 15H2L8 3z",key:"otkl63"}]],V2=at("mountain",cut);const uut=[["path",{d:"M12.586 12.586 19 19",key:"ea5xo7"}],["path",{d:"M3.688 3.037a.497.497 0 0 0-.651.651l6.5 15.999a.501.501 0 0 0 .947-.062l1.569-6.083a2 2 0 0 1 1.448-1.479l6.124-1.579a.5.5 0 0 0 .063-.947z",key:"277e5u"}]],g2e=at("mouse-pointer",uut);const hut=[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]],Tb=at("navigation",hut);const dut=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],y2e=at("pause",dut);const fut=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Xse=at("pen-line",fut);const put=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],mut=at("pen",put);const gut=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],Kg=at("pencil",gut);const yut=[["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["path",{d:"m9 20 3-6 3 6",key:"se2kox"}],["path",{d:"m6 8 6 2 6-2",key:"4o3us4"}],["path",{d:"M12 10v4",key:"1kjpxc"}]],v2e=at("person-standing",yut);const vut=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],_2e=at("play",vut);const _ut=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],_u=at("plus",_ut);const xut=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],q$=at("printer",xut);const wut=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],but=at("refresh-cw",wut);const Eut=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],x2e=at("rotate-ccw",Eut);const Sut=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],Tut=at("rotate-cw",Sut);const kut=[["circle",{cx:"6",cy:"19",r:"3",key:"1kj8tv"}],["path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15",key:"1d8sl"}],["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}]],GN=at("route",kut);const Aut=[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]],X1=at("ruler",Aut);const Iut=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],XH=at("save",Iut);const Put=[["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"m19 8 3 8a5 5 0 0 1-6 0zV7",key:"zcdpyk"}],["path",{d:"M3 7h1a17 17 0 0 0 8-2 17 17 0 0 0 8 2h1",key:"1yorad"}],["path",{d:"m5 8 3 8a5 5 0 0 1-6 0zV7",key:"eua70x"}],["path",{d:"M7 21h10",key:"1b0cd5"}]],Cut=at("scale",Put);const Rut=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],_A=at("search",Rut);const Mut=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],wz=at("settings",Mut);const Nut=[["path",{d:"M14 17H5",key:"gfn3mx"}],["path",{d:"M19 7h-9",key:"6i9tg"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],Out=at("settings-2",Nut);const Lut=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],Dut=at("share-2",Lut);const jut=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],$ut=at("shield",jut);const Fut=[["path",{d:"M10 5H3",key:"1qgfaw"}],["path",{d:"M12 19H3",key:"yhmn1j"}],["path",{d:"M14 3v4",key:"1sua03"}],["path",{d:"M16 17v4",key:"1q0r14"}],["path",{d:"M21 12h-9",key:"1o4lsq"}],["path",{d:"M21 19h-5",key:"1rlt1p"}],["path",{d:"M21 5h-7",key:"1oszz2"}],["path",{d:"M8 10v4",key:"tgpxqk"}],["path",{d:"M8 12H3",key:"a7s4jb"}]],w2e=at("sliders-horizontal",Fut);const Vut=[["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M12 21v-9",key:"17s77i"}],["path",{d:"M12 8V3",key:"13r4qs"}],["path",{d:"M17 16h4",key:"h1uq16"}],["path",{d:"M19 12V3",key:"o1uvq1"}],["path",{d:"M19 21v-5",key:"qua636"}],["path",{d:"M3 14h4",key:"bcjad9"}],["path",{d:"M5 10V3",key:"cb8scm"}],["path",{d:"M5 21v-7",key:"1w1uti"}]],zut=at("sliders-vertical",Vut);const Gut=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],Uut=at("smartphone",Gut);const But=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],b2e=at("square",But);const Wut=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],Hut=at("sun",Wut);const qut=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],Kut=at("tag",qut);const Yut=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],Xut=at("target",Yut);const Zut=[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]],Jut=at("timer",Zut);const Qut=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Sh=at("trash-2",Qut);const eht=[["path",{d:"M13 8c0-2.76-2.46-5-5.5-5S2 5.24 2 8h2l1-1 1 1h4",key:"foxbe7"}],["path",{d:"M13 7.14A5.82 5.82 0 0 1 16.5 6c3.04 0 5.5 2.24 5.5 5h-3l-1-1-1 1h-3",key:"18arnh"}],["path",{d:"M5.89 9.71c-2.15 2.15-2.3 5.47-.35 7.43l4.24-4.25.7-.7.71-.71 2.12-2.12c-1.95-1.96-5.27-1.8-7.42.35",key:"ywahnh"}],["path",{d:"M11 15.5c.5 2.5-.17 4.5-1 6.5h4c2-5.5-.5-12-1-14",key:"ft0feo"}]],tht=at("tree-palm",eht);const nht=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],rht=at("trending-down",nht);const iht=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],sht=at("trending-up",iht);const oht=[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]],ZH=at("type",oht);const aht=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],WI=at("upload",aht);const lht=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],JH=at("user",lht);const cht=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],uht=at("volume-2",cht);const hht=[["path",{d:"M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"knzxuh"}],["path",{d:"M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"2jd2cc"}],["path",{d:"M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"rd2r6e"}]],dht=at("waves",hht);const fht=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],pht=at("wifi-off",fht);const mht=[["path",{d:"M12.8 19.6A2 2 0 1 0 14 16H2",key:"148xed"}],["path",{d:"M17.5 8a2.5 2.5 0 1 1 2 4H2",key:"1u4tom"}],["path",{d:"M9.8 4.4A2 2 0 1 1 11 8H2",key:"75valh"}]],Zse=at("wind",mht);const ght=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Qr=at("x",ght);const yht=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],vht=at("zoom-in",yht);function _ht(){const{tracking:t,startTracking:e,stopTracking:n,updatePosition:r,setWatchId:i}=ks(),s=Y.useCallback(a=>{r(a)},[r]),o=Y.useCallback(a=>{console.error("GPS error:",a),alert(`GPS fout: ${a.message}`),n()},[n]);return Y.useEffect(()=>{if(!t)return;if(!navigator.geolocation){alert("Geolocation wordt niet ondersteund door deze browser"),n();return}const a=navigator.geolocation.watchPosition(s,o,{enableHighAccuracy:!0,maximumAge:1e3,timeout:15e3});return i(a),()=>{navigator.geolocation.clearWatch(a)}},[t,s,o,i,n]),{tracking:t,start:e,stop:n,toggle:()=>t?n():e()}}async function xht(){const t=DeviceOrientationEvent;if(typeof t.requestPermission=="function")try{return await t.requestPermission()==="granted"}catch{return!1}return!0}function wht(){const{tracking:t,start:e,stop:n}=_ht(),r=ks(a=>a.navigationMode),i=ks(a=>a.setNavigationMode),s=t&&r==="headingUp",o=async()=>{t?r==="free"?i("headingUp"):n():(await xht(),e(),i("free"))};return p.jsx(_t.button,{className:`
        fixed bottom-2 right-2 z-[1000]
        w-11 h-11 cursor-pointer border-0 outline-none
        flex items-center justify-center
        rounded-xl backdrop-blur-sm
        transition-all duration-200
        ${s?"bg-gradient-to-br from-green-400 to-green-600 text-white shadow-lg shadow-green-500/30":t?"bg-gradient-to-br from-blue-400 to-blue-600 text-white shadow-lg shadow-blue-500/30":"bg-white/80 text-gray-500 hover:bg-white/90 shadow-sm"}
      `,onClick:o,whileHover:{scale:1.05},whileTap:{scale:.95},animate:t?{scale:[1,1.02,1]}:{},transition:t?{scale:{duration:2,repeat:1/0,ease:"easeInOut"}}:{},"aria-label":s?"Rijmodus actief (kaart draait mee)":t?"GPS actief - klik voor rijmodus":"GPS starten",title:s?"Rijmodus actief - klik om GPS te stoppen":t?"GPS actief - klik voor rijmodus":"GPS starten",children:s?p.jsx(Tb,{size:22,strokeWidth:2}):p.jsx(nut,{size:22,strokeWidth:2})})}const bht="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(`<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 48 48">
    <polygon points="24,6 38,38 24,30 10,38" fill="#4285F4" stroke="white" stroke-width="3" stroke-linejoin="round"/>
  </svg>`),Jse=new vn({image:new ms({radius:7,fill:new Dn({color:"#4285F4"}),stroke:new Pn({color:"white",width:2.5})})});function Eht(){const t=gi(y=>y.map),e=ks(y=>y.position),n=ks(y=>y.accuracy),r=ks(y=>y.tracking),i=ks(y=>y.smoothHeading),s=ks(y=>y.navigationMode),o=Cn(y=>y.showAccuracyCircle),a=ks(y=>y.firstFix),l=ks(y=>y.resetFirstFix),c=ks(y=>y.config.centerOnUser),u=Y.useRef(null),h=Y.useRef(null),f=Y.useRef(null),g=Y.useMemo(()=>y=>new vn({image:new BA({src:bht,scale:.9,rotation:y,rotateWithView:!0,anchor:[.5,.5]})}),[]);return Y.useEffect(()=>{if(!t||!e)return;const y=Ni([e.lng,e.lat]);return u.current=new gr({geometry:new Ti(y)}),u.current.setStyle(r?g(0):Jse),h.current=new gr({geometry:new Ti(y)}),f.current=new Nl({source:new Ml({features:[h.current,u.current]}),zIndex:1e3}),t.addLayer(f.current),()=>{f.current&&t&&t.removeLayer(f.current)}},[t,!!e,g]),Y.useEffect(()=>{if(u.current)if(r){const y=i!==null?i*Math.PI/180:0;u.current.setStyle(g(y))}else u.current.setStyle(Jse)},[r,g,i]),Y.useEffect(()=>{if(!t||!e||!u.current||!h.current)return;const y=Ni([e.lng,e.lat]);if(u.current.getGeometry()?.setCoordinates(y),h.current.getGeometry()?.setCoordinates(y),r&&o&&n){const _=t.getView().getResolution()||1,b=Math.min(n/_,80);h.current.setStyle(new vn({image:new ms({radius:b,fill:new Dn({color:"rgba(66, 133, 244, 0.12)"})})}))}else h.current.setStyle(new vn({}));if(a&&r){t.getView().setCenter(y),t.getView().setZoom(17),l();return}r&&c&&!a&&t.getView().animate({center:y,duration:150})},[t,r,e,n,a,l,c,o]),Y.useEffect(()=>{if(!u.current||!r)return;const y=i!==null?i*Math.PI/180:0;u.current.setStyle(g(y))},[i,g,r]),Y.useEffect(()=>{if(!(!t||!r)&&s==="headingUp"&&i!==null){const y=-(i*Math.PI)/180,_=t.getView(),b=_.getRotation();let T=y-b;for(;T>Math.PI;)T-=2*Math.PI;for(;T<-Math.PI;)T+=2*Math.PI;Math.abs(T)>.01&&_.animate({rotation:b+T,duration:200})}},[t,r,s,i]),Y.useEffect(()=>{if(t&&s==="free"){const y=t.getView(),_=y.getRotation();Math.abs(_)>.01&&y.animate({rotation:0,duration:300})}},[t,s]),null}function Sht(){const t=Gr(n=>n.themesPanelOpen),e=Gr(n=>n.toggleThemesPanel);return p.jsx(_t.button,{className:`
        fixed bottom-[60px] right-2 z-[1000]
        w-11 h-11 cursor-pointer border-0 outline-none
        flex items-center justify-center
        rounded-xl backdrop-blur-sm
        transition-all duration-200
        ${t?"bg-gradient-to-br from-blue-400 to-blue-600 text-white shadow-lg shadow-blue-500/30":"bg-white/80 text-gray-500 hover:bg-white/90 shadow-sm"}
      `,onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":t?"Kaartlagen sluiten":"Kaartlagen openen",title:"Kaartlagen",children:p.jsx(SL,{size:22,strokeWidth:2})})}function Tht(){return p.jsx(Sht,{})}const bR=["#ef4444","#f97316","#eab308","#22c55e","#06b6d4","#3b82f6","#8b5cf6","#ec4899"],Fm=["Mineraal","Fossiel","Erfgoed","Monument","Overig"],Jc="default-vondsten",bz={id:Jc,name:"Mijn vondsten",color:"#f97316",categories:["Munt","Aardewerk","Gesp","Fibula","Ring","Speld","Sieraad","Gereedschap","Wapen","Anders"],points:[],visible:!0,archived:!1,createdAt:new Date().toISOString()},kht=t=>t.some(n=>n.id===Jc)?t:[{...bz,createdAt:new Date().toISOString()},...t],ps=yo()(Eh((t,e)=>({layers:[{...bz}],colorIndex:0,addLayer:(n,r=Fm)=>{const i=crypto.randomUUID(),s=bR[e().colorIndex%bR.length];return t(o=>({layers:[...o.layers,{id:i,name:n,color:s,categories:[...r],points:[],visible:!0,archived:!1,createdAt:new Date().toISOString()}],colorIndex:o.colorIndex+1})),i},removeLayer:n=>{t(r=>({layers:r.layers.filter(i=>i.id!==n)}))},updateLayer:(n,r)=>{t(i=>({layers:i.layers.map(s=>s.id===n?{...s,...r}:s)}))},toggleVisibility:n=>{t(r=>({layers:r.layers.map(i=>i.id===n?{...i,visible:!i.visible}:i)}))},toggleArchived:n=>{t(r=>({layers:r.layers.map(i=>i.id===n?{...i,archived:!i.archived,visible:i.archived?i.visible:!1}:i)}))},addPoint:(n,r)=>{const i={...r,status:r.status||"todo",id:crypto.randomUUID(),createdAt:new Date().toISOString()};t(s=>({layers:s.layers.map(o=>o.id===n?{...o,points:[...o.points,i]}:o)}))},removePoint:(n,r)=>{t(i=>({layers:i.layers.map(s=>s.id===n?{...s,points:s.points.filter(o=>o.id!==r)}:s)}))},updatePoint:(n,r,i)=>{t(s=>({layers:s.layers.map(o=>o.id===n?{...o,points:o.points.map(a=>a.id===r?{...a,...i}:a)}:o)}))},setPointStatus:(n,r,i)=>{t(s=>({layers:s.layers.map(o=>o.id===n?{...o,points:o.points.map(a=>a.id===r?{...a,status:i}:a)}:o)}))},addCategory:(n,r)=>{t(i=>({layers:i.layers.map(s=>s.id===n&&!s.categories.includes(r)?{...s,categories:[...s.categories,r]}:s)}))},removeCategory:(n,r)=>{t(i=>({layers:i.layers.map(s=>s.id===n?{...s,categories:s.categories.filter(o=>o!==r)}:s)}))},addPhotoToPoint:(n,r,i)=>{t(s=>({layers:s.layers.map(o=>o.id===n?{...o,points:o.points.map(a=>a.id===r?{...a,photos:[...a.photos||[],i]}:a)}:o)}))},removePhotoFromPoint:(n,r,i)=>{t(s=>({layers:s.layers.map(o=>o.id===n?{...o,points:o.points.map(a=>a.id===r?{...a,photos:(a.photos||[]).filter(l=>l.id!==i)}:a)}:o)}))},updatePhotoInPoint:(n,r,i,s)=>{t(o=>({layers:o.layers.map(a=>a.id===n?{...a,points:a.points.map(l=>l.id===r?{...l,photos:(l.photos||[]).map(c=>c.id===i?{...c,...s}:c)}:l)}:a)}))},exportLayerAsGeoJSON:n=>{const r=e().layers.find(l=>l.id===n);if(!r)return;const i={type:"FeatureCollection",properties:{name:r.name,color:r.color,categories:r.categories,createdAt:r.createdAt,exportedAt:new Date().toISOString()},features:r.points.map(l=>({type:"Feature",geometry:{type:"Point",coordinates:l.coordinates},properties:{id:l.id,name:l.name,category:l.category,notes:l.notes,url:l.url,status:l.status,sourceLayer:l.sourceLayer,sourceId:l.sourceId,photos:l.photos,createdAt:l.createdAt}}))},s=new Blob([JSON.stringify(i,null,2)],{type:"application/geo+json"}),o=URL.createObjectURL(s),a=document.createElement("a");a.href=o,a.download=`${r.name.replace(/[^a-zA-Z0-9]/g,"-")}-${new Date().toISOString().split("T")[0]}.geojson`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(o)},importLayerFromGeoJSON:n=>{try{const r=JSON.parse(n);if(r.type!=="FeatureCollection")return{success:!1,error:"Ongeldig GeoJSON formaat"};const i=r.properties||{},s=i.name||`Gemporteerd ${new Date().toLocaleDateString("nl-NL")}`,o=i.categories||Fm,a=i.color||bR[e().colorIndex%bR.length],l=(r.features||[]).filter(u=>u.geometry?.type==="Point").map(u=>({id:u.properties?.id||crypto.randomUUID(),name:u.properties?.name||"Naamloos",category:u.properties?.category||"Overig",notes:u.properties?.notes||"",url:u.properties?.url,status:u.properties?.status||"todo",sourceLayer:u.properties?.sourceLayer,sourceId:u.properties?.sourceId,photos:u.properties?.photos,coordinates:u.geometry.coordinates,createdAt:u.properties?.createdAt||new Date().toISOString()})),c=crypto.randomUUID();return t(u=>({layers:[...u.layers,{id:c,name:s,color:a,categories:o,points:l,visible:!0,archived:!1,createdAt:new Date().toISOString()}],colorIndex:u.colorIndex+1})),{success:!0,layerId:c}}catch{return{success:!1,error:"Fout bij parsen van GeoJSON"}}},getLayer:n=>e().layers.find(r=>r.id===n),getActiveLayerCount:()=>e().layers.filter(n=>!n.archived).length,getArchivedLayerCount:()=>e().layers.filter(n=>n.archived).length,clearAll:()=>{t(n=>({layers:n.layers.map(r=>r.id===Jc?{...r,points:[]}:r).filter(r=>r.id===Jc),colorIndex:0}))}}),{name:"detectorapp-custom-point-layers",version:3,onRehydrateStorage:()=>t=>{t&&(t.layers.some(n=>n.id===Jc)||(t.layers=[{...bz,createdAt:new Date().toISOString()},...t.layers]))},migrate:(t,e)=>{const n=t;return e<2?{...n,layers:kht(n.layers||[])}:e<3?{...n,layers:(n.layers||[]).map(r=>r.id===Jc?{...r,name:"Mijn vondsten"}:r)}:n}}));function Fs({title:t,children:e,defaultExpanded:n=!0,layerNames:r}){const[i,s]=Y.useState(n),o=Bs(b=>b.visible),a=Bs(b=>b.setLayerVisibility),l=QU(b=>b.isLayerUnlocked),c=b=>{const T=Oy[b],A=T?.tier??"free",I=T?.regions??["nl"];return l(b,A,I)},u=r?.filter(b=>c(b))||[],h=u.filter(b=>o[b]).length,f=u.length,g=f>0&&h===f,y=h>0&&h<f,_=b=>{if(b.stopPropagation(),!r||u.length===0)return;const T=!g;u.forEach(A=>{a(A,T)})};return p.jsxs("div",{className:"mb-0.5",children:[p.jsxs("div",{className:"flex items-center gap-1 py-1 px-1 hover:bg-blue-50 transition-colors",children:[p.jsxs("button",{onClick:b=>{b.stopPropagation(),s(!i)},className:"flex-1 flex items-center gap-1 bg-transparent border-0 outline-none text-left",style:{fontSize:"inherit"},children:[p.jsx(_t.span,{animate:{rotate:i?90:0},transition:{duration:.15},className:"text-gray-400",children:p.jsx(Sb,{size:14})}),i?p.jsx(Oct,{size:16,className:"text-blue-500"}):p.jsx($ct,{size:16,className:"text-blue-500"}),p.jsx("span",{className:"text-gray-700 font-medium",style:{fontSize:"1em"},children:t}),h>0&&p.jsx("span",{className:"ml-1 px-1.5 py-0.5 font-medium bg-blue-100 text-blue-600 rounded-full",style:{fontSize:"0.7em"},children:h})]}),r&&r.length>0&&p.jsx("button",{onClick:_,className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:g?"#3b82f6":y?"#93c5fd":"white",border:g?"2px solid #3b82f6":"2px solid #60a5fa",color:"white"},children:(g||y)&&p.jsx("svg",{width:"10",height:"10",viewBox:"0 0 10 10",children:p.jsx("path",{d:"M2 5 L4 7 L8 3",stroke:"currentColor",strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),p.jsx(qn,{initial:!1,children:i&&p.jsx(_t.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.15},style:{overflow:"hidden"},className:"ml-5",children:e})})]})}function St({name:t,type:e,hasOverlay:n,displayName:r}){const i=Bs(P=>P.visible[t]),s=Bs(P=>P.visible["Labels Overlay"]),o=Bs(P=>P.loadingState[t]),a=Bs(P=>P.toggleLayer),l=Bs(P=>P.setLayerVisibility),c=QU(P=>P.isLayerUnlocked),u=o==="loading",h=o==="error",f=Oy[t],g=f?.tier??"free",y=f?.regions??["nl"],b=!c(t,g,y),T=P=>{P.stopPropagation(),!(u||b)&&(e==="overlay"?a(t):["CartoDB (licht)","OpenStreetMap","Luchtfoto","TMK 1850","Bonnebladen 1900"].forEach(D=>{l(D,D===t)}))},A=P=>{P.stopPropagation(),l("Labels Overlay",!s)},I=i??!1;return p.jsxs("div",{className:"flex items-center gap-1",children:[p.jsxs("button",{onClick:T,disabled:u||b,className:`flex-1 flex items-center justify-between py-1 pl-3 pr-2 border-0 outline-none transition-colors text-left ${b?"opacity-50 cursor-not-allowed bg-gray-50":u?"opacity-70 cursor-wait bg-transparent":I?"bg-blue-50 hover:bg-blue-100":"bg-transparent hover:bg-blue-50"}`,style:{fontSize:"inherit"},title:b?"Premium laag - upgrade om te ontgrendelen":void 0,children:[p.jsxs("span",{className:`flex items-center gap-1 ${h?"text-red-500":b?"text-gray-400":"text-gray-600"}`,children:[r||t,h&&p.jsx(l2e,{size:12,className:"text-red-500"}),b&&p.jsx(xz,{size:12,className:"text-amber-500"})]}),p.jsx("div",{className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:b?"#e5e7eb":u?"#93c5fd":I?"#3b82f6":"white",border:b?"2px solid #d1d5db":u?"2px solid #93c5fd":I?"2px solid #3b82f6":"2px solid #60a5fa",color:"white"},children:b?p.jsx(xz,{size:10,strokeWidth:3,className:"text-gray-400"}):u?p.jsx(BI,{size:10,strokeWidth:3,className:"animate-spin"}):I?p.jsx(_p,{size:12,strokeWidth:3}):null})]}),n&&I&&p.jsx("button",{onClick:A,className:`p-1 rounded transition-colors border-0 outline-none ${s?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-400 hover:bg-gray-200"}`,title:s?"Labels verbergen":"Labels tonen",children:p.jsx(Kut,{size:12})})]})}const Aht=["#ef4444","#f97316","#eab308","#22c55e","#06b6d4","#3b82f6","#8b5cf6","#ec4899","#6b7280"];function E2e({layer:t,compact:e=!1}){const{toggleVisibility:n,removeLayer:r,updateLayer:i,setColor:s}=uI(),[o,a]=Y.useState(!1),[l,c]=Y.useState(!1),[u,h]=Y.useState(t.name),[f,g]=Y.useState(!1),y=Y.useRef(null),_=Y.useRef(null),b=t.features.features.length,T=[...new Set(t.features.features.map(C=>C.geometry?.type).filter(Boolean))];Y.useEffect(()=>{l&&y.current&&(y.current.focus(),y.current.select())},[l]),Y.useEffect(()=>{const C=M=>{_.current&&!_.current.contains(M.target)&&g(!1)};if(f)return document.addEventListener("mousedown",C),()=>document.removeEventListener("mousedown",C)},[f]);const A=()=>{o?r(t.id):(a(!0),setTimeout(()=>a(!1),3e3))},I=()=>{const C=u.trim();C&&C!==t.name&&i(t.id,{name:C}),c(!1)},P=()=>{h(t.name),c(!1)},R=C=>{C.key==="Enter"?I():C.key==="Escape"&&P()},D=C=>{s(t.id,C),g(!1)};return e?p.jsxs("div",{className:"flex items-center gap-1 py-0.5 px-1 hover:bg-blue-50 transition-colors rounded",children:[p.jsx("button",{onClick:()=>n(t.id),className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:t.visible?t.color:"white",border:`2px solid ${t.color}`},title:t.visible?"Verbergen":"Tonen",children:t.visible&&p.jsx("svg",{width:"10",height:"10",viewBox:"0 0 10 10",children:p.jsx("path",{d:"M2 5 L4 7 L8 3",stroke:"white",strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})})}),p.jsx("span",{className:"text-gray-700 truncate flex-1 cursor-pointer",style:{fontSize:"0.9em"},onClick:()=>n(t.id),children:t.name}),p.jsx("span",{className:"text-[10px] text-gray-400 flex-shrink-0",children:b})]}):p.jsxs("div",{className:"flex items-center justify-between py-1.5 group",children:[p.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[p.jsxs("div",{className:"relative",ref:_,children:[p.jsx("button",{onClick:()=>g(!f),className:"w-5 h-5 rounded border-2 border-white shadow-sm flex-shrink-0 hover:scale-110 transition-transform",style:{backgroundColor:t.color},title:"Kleur wijzigen"}),f&&p.jsx("div",{className:"absolute top-6 left-0 z-50 bg-white rounded-lg shadow-lg border p-2 grid grid-cols-3 gap-1",children:Aht.map(C=>p.jsx("button",{onClick:()=>D(C),className:`w-6 h-6 rounded border-2 transition-transform hover:scale-110 ${C===t.color?"border-gray-800 scale-110":"border-white"}`,style:{backgroundColor:C},title:C},C))})]}),p.jsx("div",{className:"flex-1 min-w-0",children:l?p.jsxs("div",{className:"flex items-center gap-1",children:[p.jsx("input",{ref:y,type:"text",value:u,onChange:C=>h(C.target.value),onKeyDown:R,className:"flex-1 text-sm px-1 py-0.5 border rounded min-w-0"}),p.jsx("button",{onClick:I,className:"p-0.5 text-green-600 hover:bg-green-50 rounded",title:"Opslaan",children:p.jsx(_p,{size:14})}),p.jsx("button",{onClick:P,className:"p-0.5 text-gray-400 hover:bg-gray-100 rounded",title:"Annuleren",children:p.jsx(Qr,{size:14})})]}):p.jsxs(p.Fragment,{children:[p.jsxs("div",{className:"flex items-center gap-1",children:[p.jsx("span",{className:"text-sm text-gray-700 truncate",children:t.name}),p.jsx("button",{onClick:()=>c(!0),className:"p-0.5 text-gray-400 hover:text-blue-500 opacity-0 group-hover:opacity-100 transition-opacity",title:"Naam wijzigen",children:p.jsx(Kg,{size:12})})]}),p.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-gray-400",children:[p.jsxs("span",{children:[b," ",b===1?"feature":"features"]}),T.length>0&&p.jsxs(p.Fragment,{children:[p.jsx("span",{className:"mx-0.5",children:""}),p.jsx("span",{children:T.join(", ")})]})]})]})})]}),p.jsxs("div",{className:"flex items-center gap-1",children:[p.jsx("button",{onClick:()=>n(t.id),className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:t.visible?t.color:"white",border:`2px solid ${t.visible?t.color:"#9ca3af"}`},title:t.visible?"Verbergen":"Tonen",children:t.visible&&p.jsx("svg",{width:"10",height:"10",viewBox:"0 0 10 10",children:p.jsx("path",{d:"M2 5 L4 7 L8 3",stroke:"white",strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})})}),p.jsx("button",{onClick:A,className:`p-1 rounded transition-colors border-0 outline-none ${o?"text-white bg-red-500 hover:bg-red-600":"text-gray-400 hover:text-red-500 hover:bg-red-50"}`,title:o?"Klik nogmaals om te verwijderen":"Verwijderen",children:p.jsx(Sh,{size:14})})]})]})}const UT="commercial",Iht={commercial:["Archeologische lagen","Archeologische verwachtingen","Erfgoed & Monumenten","WOII & Militair","Hillshade & LiDAR","Terrein & Bodem","Percelen","Recreatie"],personal:["Steentijd & Prehistorie","Paleokaarten","Archeologische lagen","Archeologische verwachtingen","Erfgoed & Monumenten","WOII & Militair","Hillshade & LiDAR","Terrein & Bodem","Percelen","Provinciale Thema's","Fossielen, Mineralen & Goud","Recreatie"]},Pht={commercial:["Specials (3D)"],personal:["Specials (3D)"]};function Wl(t){return Iht[UT].includes(t)}function Cht(t){return Pht[UT].includes(t)}const Rht=[{name:"Rapa Nui - Moai Productie",url:"https://arcg.is/qu59O1",desc:"Paaseiland steengroeve in 3D"},{name:"Digital Giza - Piramides",url:"http://giza.fas.harvard.edu/giza3d/",desc:"Harvard 3D reconstructie"},{name:"Stonehenge 360",url:"https://www.english-heritage.org.uk/visit/places/stonehenge/history-and-stories/stonehenge360/",desc:"English Heritage virtuele tour"},{name:"Pompeii 3D Explorer",url:"https://www.cyark.org/projects/pompeii/3D-Explorer",desc:"CyArk LiDAR scans"},{name:"Virtual Angkor Wat",url:"https://www.virtualangkor.com/",desc:"3D reconstructie 1300 n.Chr."},{name:"Petra Virtuele Tour",url:"https://www.zamaniproject.org/site-jordan-petra.html",desc:"Zamani Project 3D"}],Mht=[{name:"CyArk (200+ sites)",url:"https://www.cyark.org/projects/",desc:"Wereldwijd erfgoed archief"},{name:"Google Open Heritage",url:"https://artsandculture.google.com/project/openheritage",desc:"26+ UNESCO sites in 3D"}];function Nht(){const{themesPanelOpen:t,toggleThemesPanel:e,toggleSettingsPanel:n}=Gr(),{layers:r,toggleVisibility:i}=ps(),s=uI(y=>y.layers),o=Y.useRef(null),a=Cn(y=>y.layerPanelFontScale),l=Cn(y=>y.setLayerPanelFontScale),c=Cn(y=>y.showFontSliders),u=Cn(y=>y.showCustomPointLayers),h=13*a/100,[f,g]=Y.useState(!1);return Y.useEffect(()=>{if(!t)return;const y=b=>{o.current&&!o.current.contains(b.target)&&e()},_=setTimeout(()=>{document.addEventListener("click",y)},100);return()=>{clearTimeout(_),document.removeEventListener("click",y)}},[t,e]),p.jsx(qn,{children:t&&p.jsxs(_t.div,{ref:o,className:"fixed top-2.5 right-2 z-[1101] bg-white rounded-lg shadow-lg overflow-hidden w-[300px] max-h-[calc(100vh-200px)] flex flex-col",initial:{opacity:0,x:10},animate:{opacity:1,x:0},exit:{opacity:0,x:10},transition:{duration:.15},children:[p.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-blue-500",style:{fontSize:`${h}px`},children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(yc,{size:14,className:"text-white"}),p.jsx("span",{className:"font-medium text-white",children:"Kaartlagen"})]}),p.jsxs("div",{className:"flex items-center gap-2",children:[c&&p.jsxs(p.Fragment,{children:[p.jsx("span",{className:"text-[10px] text-blue-200",children:"T"}),p.jsx("input",{type:"range",min:"80",max:"130",step:"10",value:a,onInput:y=>{l(parseInt(y.target.value))},onChange:y=>l(parseInt(y.target.value)),className:"w-20 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${a}%`}),p.jsx("span",{className:"text-xs text-blue-200",children:"T"})]}),p.jsx("button",{onClick:e,className:"p-0.5 rounded border-0 outline-none bg-blue-400/50 hover:bg-blue-400 transition-colors ml-1",children:p.jsx(Qr,{size:16,className:"text-white",strokeWidth:2.5})})]})]}),p.jsxs("div",{className:"p-2 overflow-y-auto flex-1",style:{fontSize:`${h}px`},children:[u&&r.filter(y=>!y.archived).length>0&&p.jsxs("div",{className:"mb-2 pb-1 border-b border-gray-100",children:[p.jsx("div",{className:"flex items-center gap-1 py-0.5 px-1 mb-1",children:p.jsx("span",{className:"text-orange-600 font-medium",style:{fontSize:"0.9em"},children:"Mijn lagen"})}),r.filter(y=>!y.archived).map(y=>p.jsxs("button",{onClick:_=>{_.stopPropagation(),i(y.id)},className:`w-full flex items-center justify-between py-1 pl-3 pr-2 border-0 outline-none transition-colors text-left ${y.visible?"bg-orange-50 hover:bg-orange-100":"bg-transparent hover:bg-orange-50"}`,style:{fontSize:"inherit"},children:[p.jsxs("span",{className:"flex items-center gap-2 text-gray-600",children:[y.name,p.jsxs("span",{className:"text-xs text-gray-400",children:["(",y.points.length,")"]})]}),p.jsx("div",{className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:y.visible?"#f97316":"white",border:y.visible?"2px solid #f97316":"2px solid #fb923c",color:"white"},children:y.visible&&p.jsx(_p,{size:12,strokeWidth:3})})]},y.id))]}),s.length>0&&p.jsxs("div",{className:"mb-2 pb-1 border-b border-gray-100",children:[p.jsxs("div",{className:"flex items-center gap-1 py-0.5 px-1 mb-1",children:[p.jsx(WI,{size:12,className:"text-cyan-600"}),p.jsx("span",{className:"text-cyan-600 font-medium",style:{fontSize:"0.9em"},children:"Gemporteerde lagen"})]}),s.map(y=>p.jsx(E2e,{layer:y,compact:!0},y.id)),p.jsx("button",{onClick:()=>{e(),n()},className:"w-full text-left py-1 pl-3 text-xs text-cyan-500 hover:text-cyan-700 hover:bg-cyan-50 transition-colors",children:"+ Laag importeren..."})]}),p.jsxs("div",{className:"mb-2",children:[p.jsx("div",{className:"flex items-center gap-1 py-1 px-1 mb-1",children:p.jsx("span",{className:"text-blue-600 font-medium",style:{fontSize:"0.95em"},children:"Basislaag"})}),p.jsxs("div",{className:"space-y-0",children:[p.jsx(St,{name:"CartoDB (licht)",type:"base"}),p.jsx(St,{name:"OpenStreetMap",type:"base"}),p.jsx(St,{name:"Luchtfoto",type:"base",hasOverlay:!0}),p.jsx(St,{name:"TMK 1850",type:"base",hasOverlay:!0}),p.jsx(St,{name:"Bonnebladen 1900",type:"base",hasOverlay:!0})]})]}),p.jsxs("div",{className:"mb-2",children:[p.jsx("div",{className:"flex items-center gap-1 py-1 px-1 mb-1 border-t border-gray-100 pt-2",children:p.jsx("span",{className:"text-blue-600 font-medium",style:{fontSize:"0.95em"},children:"Thema's"})}),Wl("Steentijd & Prehistorie")&&p.jsxs(Fs,{title:"Steentijd & Prehistorie",defaultExpanded:!1,layerNames:["Hunebedden","Grafheuvels","Terpen","FAMKE Steentijd","FAMKE IJzertijd"],children:[p.jsx(St,{name:"Hunebedden",type:"overlay"}),p.jsx(St,{name:"Grafheuvels",type:"overlay"}),p.jsx(St,{name:"Terpen",type:"overlay"}),p.jsx(St,{name:"FAMKE Steentijd",type:"overlay"}),p.jsx(St,{name:"FAMKE IJzertijd",type:"overlay"})]}),Wl("Paleokaarten")&&p.jsxs(Fs,{title:"Paleokaarten",defaultExpanded:!1,layerNames:["Paleokaart 9000 v.Chr.","Paleokaart 5500 v.Chr.","Paleokaart 2750 v.Chr.","Paleokaart 1500 v.Chr.","Paleokaart 500 v.Chr.","Paleokaart 100 n.Chr.","Paleokaart 800 n.Chr."],children:[p.jsx(St,{name:"Paleokaart 9000 v.Chr.",type:"overlay"}),p.jsx(St,{name:"Paleokaart 5500 v.Chr.",type:"overlay"}),p.jsx(St,{name:"Paleokaart 2750 v.Chr.",type:"overlay"}),p.jsx(St,{name:"Paleokaart 1500 v.Chr.",type:"overlay"}),p.jsx(St,{name:"Paleokaart 500 v.Chr.",type:"overlay"}),p.jsx(St,{name:"Paleokaart 100 n.Chr.",type:"overlay"}),p.jsx(St,{name:"Paleokaart 800 n.Chr.",type:"overlay"})]}),Wl("Archeologische lagen")&&p.jsxs(Fs,{title:"Archeologische lagen",defaultExpanded:!1,layerNames:["AMK Monumenten","AMK Romeins","AMK Steentijd","AMK Vroege ME","AMK Late ME","AMK Overig","Archeo Onderzoeken","Romeinse wegen (regio)","Romeinse wegen (Wereld)","Romeinse Forten","Romeinse Forten Lijnen"],children:[p.jsx(St,{name:"AMK Monumenten",type:"overlay"}),p.jsxs(Fs,{title:"Per periode",defaultExpanded:!1,layerNames:["AMK Romeins","AMK Steentijd","AMK Vroege ME","AMK Late ME","AMK Overig"],children:[p.jsx(St,{name:"AMK Romeins",type:"overlay"}),p.jsx(St,{name:"AMK Steentijd",type:"overlay"}),p.jsx(St,{name:"AMK Vroege ME",type:"overlay"}),p.jsx(St,{name:"AMK Late ME",type:"overlay"}),p.jsx(St,{name:"AMK Overig",type:"overlay"})]}),p.jsx(St,{name:"Archeo Onderzoeken",type:"overlay"}),p.jsxs(Fs,{title:"Romeinse tijd",defaultExpanded:!1,layerNames:["Romeinse wegen (regio)","Romeinse wegen (Wereld)","Romeinse Forten","Romeinse Forten Lijnen"],children:[p.jsx(St,{name:"Romeinse wegen (regio)",type:"overlay"}),p.jsx(St,{name:"Romeinse wegen (Wereld)",type:"overlay"}),p.jsxs(Fs,{title:"Romeinse Forten",defaultExpanded:!1,layerNames:["Romeinse Forten","Romeinse Forten Lijnen"],children:[p.jsx(St,{name:"Romeinse Forten",type:"overlay"}),p.jsx(St,{name:"Romeinse Forten Lijnen",type:"overlay"})]})]})]}),Wl("Archeologische verwachtingen")&&p.jsxs(Fs,{title:"Archeologische verwachtingen",defaultExpanded:!1,layerNames:["Kansenkaart","IKAW","UIKAV Punten","UIKAV Vlakken","UIKAV Expert","UIKAV Buffer","UIKAV Indeling"],children:[p.jsx(St,{name:"Kansenkaart",type:"overlay"}),p.jsx(St,{name:"IKAW",type:"overlay"}),p.jsx(St,{name:"UIKAV Punten",type:"overlay"}),p.jsx(St,{name:"UIKAV Vlakken",type:"overlay"}),p.jsx(St,{name:"UIKAV Expert",type:"overlay"}),p.jsx(St,{name:"UIKAV Buffer",type:"overlay"}),p.jsx(St,{name:"UIKAV Indeling",type:"overlay"})]}),Wl("Erfgoed & Monumenten")&&p.jsxs(Fs,{title:"Erfgoed & Monumenten",defaultExpanded:!1,layerNames:["Rijksmonumenten","Werelderfgoed","Religieus Erfgoed","Kastelen","Runes"],children:[p.jsx(St,{name:"Rijksmonumenten",type:"overlay"}),p.jsx(St,{name:"Werelderfgoed",type:"overlay"}),p.jsx(St,{name:"Religieus Erfgoed",type:"overlay"}),p.jsx(St,{name:"Kastelen",type:"overlay"}),p.jsx(St,{name:"Runes",type:"overlay"})]}),Wl("WOII & Militair")&&p.jsxs(Fs,{title:"WOII & Militair",defaultExpanded:!1,layerNames:["WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Militaire Objecten","Inundatiegebieden"],children:[p.jsx(St,{name:"WWII Bunkers",type:"overlay"}),p.jsx(St,{name:"Slagvelden",type:"overlay"}),p.jsx(St,{name:"Militaire Vliegvelden",type:"overlay"}),p.jsx(St,{name:"Verdedigingslinies",type:"overlay"}),p.jsx(St,{name:"Militaire Objecten",type:"overlay"}),p.jsx(St,{name:"Inundatiegebieden",type:"overlay"})]}),Wl("Hillshade & LiDAR")&&p.jsxs(Fs,{title:"Hillshade & LiDAR",defaultExpanded:!1,layerNames:["AHN4 Hoogtekaart Kleur","AHN4 Hillshade NL","AHN4 Multi-Hillshade NL","AHN4 Hillshade Kleur","AHN 0.5m"],children:[p.jsx(St,{name:"AHN4 Hoogtekaart Kleur",type:"overlay"}),p.jsx(St,{name:"AHN4 Hillshade NL",type:"overlay"}),p.jsx(St,{name:"AHN4 Multi-Hillshade NL",type:"overlay"}),p.jsx(St,{name:"AHN4 Hillshade Kleur",type:"overlay"}),p.jsx(St,{name:"AHN 0.5m",type:"overlay"})]}),Wl("Terrein & Bodem")&&p.jsxs(Fs,{title:"Terrein & Bodem",defaultExpanded:!1,layerNames:["Geomorfologie","Bodemkaart","Essen"],children:[UT==="personal",p.jsx(St,{name:"Geomorfologie",type:"overlay"}),p.jsx(St,{name:"Bodemkaart",type:"overlay"}),p.jsx(St,{name:"Essen",type:"overlay"})]}),Wl("Percelen")&&p.jsxs(Fs,{title:"Percelen",defaultExpanded:!1,layerNames:["Gewaspercelen","Kadastrale Grenzen"],children:[p.jsx(St,{name:"Gewaspercelen",type:"overlay"}),p.jsx(St,{name:"Kadastrale Grenzen",type:"overlay"})]}),Wl("Provinciale Thema's")&&p.jsxs(Fs,{title:"Provinciale Thema's",defaultExpanded:!1,layerNames:["Scheepswrakken","Woonheuvels ZH","Windmolens","Erfgoedlijnen","Oude Kernen","Relictenkaart Punten","Relictenkaart Lijnen","Relictenkaart Vlakken","Verdronken Dorpen"],children:[p.jsxs(Fs,{title:"Zuid-Holland",defaultExpanded:!1,layerNames:["Scheepswrakken","Woonheuvels ZH","Windmolens","Erfgoedlijnen","Oude Kernen"],children:[p.jsx(St,{name:"Scheepswrakken",type:"overlay"}),p.jsx(St,{name:"Woonheuvels ZH",type:"overlay"}),p.jsx(St,{name:"Windmolens",type:"overlay"}),p.jsx(St,{name:"Erfgoedlijnen",type:"overlay"}),p.jsx(St,{name:"Oude Kernen",type:"overlay"})]}),p.jsxs(Fs,{title:"Gelderland",defaultExpanded:!1,layerNames:["Relictenkaart Punten","Relictenkaart Lijnen","Relictenkaart Vlakken"],children:[p.jsx(St,{name:"Relictenkaart Punten",type:"overlay"}),p.jsx(St,{name:"Relictenkaart Lijnen",type:"overlay"}),p.jsx(St,{name:"Relictenkaart Vlakken",type:"overlay"})]}),p.jsx(Fs,{title:"Zeeland",defaultExpanded:!1,layerNames:["Verdronken Dorpen"],children:p.jsx(St,{name:"Verdronken Dorpen",type:"overlay"})})]}),Wl("Fossielen, Mineralen & Goud")&&p.jsxs(Fs,{title:"Fossielen, Mineralen & Goud",defaultExpanded:!1,layerNames:["Fossiel Hotspots","Mineralen Hotspots","Goudrivieren","Fossielen Nederland","Fossielen Belgi","Fossielen Duitsland","Fossielen Frankrijk"],children:[p.jsx(St,{name:"Fossiel Hotspots",type:"overlay"}),p.jsx(St,{name:"Mineralen Hotspots",type:"overlay"}),p.jsx(St,{name:"Goudrivieren",type:"overlay"}),p.jsx(St,{name:"Fossielen Nederland",type:"overlay"}),p.jsx(St,{name:"Fossielen Belgi",type:"overlay"}),p.jsx(St,{name:"Fossielen Duitsland",type:"overlay"}),p.jsx(St,{name:"Fossielen Frankrijk",type:"overlay"})]}),Wl("Recreatie")&&UT==="commercial"&&p.jsxs(Fs,{title:"Recreatie",defaultExpanded:!1,layerNames:["Parken","Speeltuinen","Strandjes"],children:[p.jsx(St,{name:"Parken",type:"overlay"}),p.jsx(St,{name:"Speeltuinen",type:"overlay"}),p.jsx(St,{name:"Strandjes",type:"overlay",displayName:"Recreatie (strand)"})]}),Wl("Recreatie")&&UT==="personal"&&p.jsxs(Fs,{title:"Recreatie",defaultExpanded:!1,layerNames:["Ruiterpaden","Laarzenpaden","Parken","Speeltuinen","Musea","Strandjes","Kringloopwinkels"],children:[p.jsx(St,{name:"Ruiterpaden",type:"overlay"}),p.jsx(St,{name:"Laarzenpaden",type:"overlay"}),p.jsx(St,{name:"Parken",type:"overlay"}),p.jsx(St,{name:"Speeltuinen",type:"overlay"}),p.jsx(St,{name:"Musea",type:"overlay"}),p.jsx(St,{name:"Strandjes",type:"overlay"}),p.jsx(St,{name:"Kringloopwinkels",type:"overlay"})]}),Cht("Specials (3D)")&&p.jsxs("div",{className:"mb-2",children:[p.jsxs("button",{onClick:y=>{y.stopPropagation(),g(!f)},className:"w-full flex items-center gap-1 py-1 px-1 hover:bg-purple-50 rounded transition-colors border-0 outline-none bg-transparent",children:[f?p.jsx(Eb,{size:14,className:"text-purple-500"}):p.jsx(Sb,{size:14,className:"text-purple-500"}),p.jsx(Wct,{size:12,className:"text-purple-500"}),p.jsx("span",{className:"text-purple-600 font-medium",style:{fontSize:"0.95em"},children:"Specials (3D)"}),p.jsx(Tg,{size:10,className:"text-purple-400 ml-auto"})]}),f&&p.jsxs("div",{className:"mt-1",onClick:y=>y.stopPropagation(),children:[Rht.map(y=>p.jsxs("a",{href:y.url,target:"_blank",rel:"noopener noreferrer",onClick:_=>_.stopPropagation(),className:"w-full flex items-center justify-between py-1.5 pl-6 pr-2 hover:bg-purple-50 rounded transition-colors text-left",style:{fontSize:"inherit"},children:[p.jsxs("div",{className:"flex flex-col",children:[p.jsx("span",{className:"text-gray-700",children:y.name}),p.jsx("span",{className:"text-gray-400",style:{fontSize:"0.8em"},children:y.desc})]}),p.jsx(Tg,{size:12,className:"text-purple-400 flex-shrink-0 ml-2"})]},y.name)),p.jsx("div",{className:"border-t border-gray-200 my-1.5 mx-2"}),Mht.map(y=>p.jsxs("a",{href:y.url,target:"_blank",rel:"noopener noreferrer",onClick:_=>_.stopPropagation(),className:"w-full flex items-center justify-between py-1.5 pl-6 pr-2 hover:bg-purple-50 rounded transition-colors text-left",style:{fontSize:"inherit"},children:[p.jsxs("div",{className:"flex flex-col",children:[p.jsx("span",{className:"text-gray-700 font-medium",children:y.name}),p.jsx("span",{className:"text-gray-400",style:{fontSize:"0.8em"},children:y.desc})]}),p.jsx(Tg,{size:12,className:"text-purple-400 flex-shrink-0 ml-2"})]},y.name))]})]})]})]})]})})}function Oht(t){t("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),t("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),t("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs");for(var e=1;e<=60;++e)t("EPSG:"+(32600+e),"+proj=utm +zone="+e+" +datum=WGS84 +units=m"),t("EPSG:"+(32700+e),"+proj=utm +zone="+e+" +south +datum=WGS84 +units=m");t("EPSG:5041","+title=WGS 84 / UPS North (E,N) +proj=stere +lat_0=90 +lon_0=0 +k=0.994 +x_0=2000000 +y_0=2000000 +datum=WGS84 +units=m"),t("EPSG:5042","+title=WGS 84 / UPS South (E,N) +proj=stere +lat_0=-90 +lon_0=0 +k=0.994 +x_0=2000000 +y_0=2000000 +datum=WGS84 +units=m"),t.WGS84=t["EPSG:4326"],t["EPSG:3785"]=t["EPSG:3857"],t.GOOGLE=t["EPSG:3857"],t["EPSG:900913"]=t["EPSG:3857"],t["EPSG:102113"]=t["EPSG:3857"]}var Z1=1,J1=2,_w=3,Lht=4,Ez=5,Qse=6378137,Dht=6356752314e-3,eoe=.0066943799901413165,BT=484813681109536e-20,st=Math.PI/2,jht=.16666666666666666,$ht=.04722222222222222,Fht=.022156084656084655,wt=1e-10,Ki=.017453292519943295,bl=57.29577951308232,Nr=Math.PI/4,xA=Math.PI*2,hs=3.14159265359,Ll={};Ll.greenwich=0;Ll.lisbon=-9.131906111111;Ll.paris=2.337229166667;Ll.bogota=-74.080916666667;Ll.madrid=-3.687938888889;Ll.rome=12.452333333333;Ll.bern=7.439583333333;Ll.jakarta=106.807719444444;Ll.ferro=-17.666666666667;Ll.brussels=4.367975;Ll.stockholm=18.058277777778;Ll.athens=23.7163375;Ll.oslo=10.722916666667;const Vht={mm:{to_meter:.001},cm:{to_meter:.01},ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937},fath:{to_meter:1.8288},kmi:{to_meter:1852},"us-ch":{to_meter:20.1168402336805},"us-mi":{to_meter:1609.34721869444},km:{to_meter:1e3},"ind-ft":{to_meter:.30479841},"ind-yd":{to_meter:.91439523},mi:{to_meter:1609.344},yd:{to_meter:.9144},ch:{to_meter:20.1168},link:{to_meter:.201168},dm:{to_meter:.1},in:{to_meter:.0254},"ind-ch":{to_meter:20.11669506},"us-in":{to_meter:.025400050800101},"us-yd":{to_meter:.914401828803658}};var toe=/[\s_\-\/\(\)]/g;function Yg(t,e){if(t[e])return t[e];for(var n=Object.keys(t),r=e.toLowerCase().replace(toe,""),i=-1,s,o;++i<n.length;)if(s=n[i],o=s.toLowerCase().replace(toe,""),o===r)return t[s]}function Sz(t){var e={},n=t.split("+").map(function(a){return a.trim()}).filter(function(a){return a}).reduce(function(a,l){var c=l.split("=");return c.push(!0),a[c[0].toLowerCase()]=c[1],a},{}),r,i,s,o={proj:"projName",datum:"datumCode",rf:function(a){e.rf=parseFloat(a)},lat_0:function(a){e.lat0=a*Ki},lat_1:function(a){e.lat1=a*Ki},lat_2:function(a){e.lat2=a*Ki},lat_ts:function(a){e.lat_ts=a*Ki},lon_0:function(a){e.long0=a*Ki},lon_1:function(a){e.long1=a*Ki},lon_2:function(a){e.long2=a*Ki},alpha:function(a){e.alpha=parseFloat(a)*Ki},gamma:function(a){e.rectified_grid_angle=parseFloat(a)*Ki},lonc:function(a){e.longc=a*Ki},x_0:function(a){e.x0=parseFloat(a)},y_0:function(a){e.y0=parseFloat(a)},k_0:function(a){e.k0=parseFloat(a)},k:function(a){e.k0=parseFloat(a)},a:function(a){e.a=parseFloat(a)},b:function(a){e.b=parseFloat(a)},r:function(a){e.a=e.b=parseFloat(a)},r_a:function(){e.R_A=!0},zone:function(a){e.zone=parseInt(a,10)},south:function(){e.utmSouth=!0},towgs84:function(a){e.datum_params=a.split(",").map(function(l){return parseFloat(l)})},to_meter:function(a){e.to_meter=parseFloat(a)},units:function(a){e.units=a;var l=Yg(Vht,a);l&&(e.to_meter=l.to_meter)},from_greenwich:function(a){e.from_greenwich=a*Ki},pm:function(a){var l=Yg(Ll,a);e.from_greenwich=(l||parseFloat(a))*Ki},nadgrids:function(a){a==="@null"?e.datumCode="none":e.nadgrids=a},axis:function(a){var l="ewnsud";a.length===3&&l.indexOf(a.substr(0,1))!==-1&&l.indexOf(a.substr(1,1))!==-1&&l.indexOf(a.substr(2,1))!==-1&&(e.axis=a)},approx:function(){e.approx=!0},over:function(){e.over=!0}};for(r in n)i=n[r],r in o?(s=o[r],typeof s=="function"?s(i):e[s]=i):e[r]=i;return typeof e.datumCode=="string"&&e.datumCode!=="WGS84"&&(e.datumCode=e.datumCode.toLowerCase()),e.projStr=t,e}class S2e{static getId(e){const n=e.find(r=>Array.isArray(r)&&r[0]==="ID");return n&&n.length>=3?{authority:n[1],code:parseInt(n[2],10)}:null}static convertUnit(e,n="unit"){if(!e||e.length<3)return{type:n,name:"unknown",conversion_factor:null};const r=e[1],i=parseFloat(e[2])||null,s=e.find(a=>Array.isArray(a)&&a[0]==="ID"),o=s?{authority:s[1],code:parseInt(s[2],10)}:null;return{type:n,name:r,conversion_factor:i,id:o}}static convertAxis(e){const n=e[1]||"Unknown";let r;const i=n.match(/^\((.)\)$/);if(i){const c=i[1].toUpperCase();if(c==="E")r="east";else if(c==="N")r="north";else if(c==="U")r="up";else throw new Error(`Unknown axis abbreviation: ${c}`)}else r=e[2]?e[2].toLowerCase():"unknown";const s=e.find(c=>Array.isArray(c)&&c[0]==="ORDER"),o=s?parseInt(s[1],10):null,a=e.find(c=>Array.isArray(c)&&(c[0]==="LENGTHUNIT"||c[0]==="ANGLEUNIT"||c[0]==="SCALEUNIT")),l=this.convertUnit(a);return{name:n,direction:r,unit:l,order:o}}static extractAxes(e){return e.filter(n=>Array.isArray(n)&&n[0]==="AXIS").map(n=>this.convertAxis(n)).sort((n,r)=>(n.order||0)-(r.order||0))}static convert(e,n={}){switch(e[0]){case"PROJCRS":n.type="ProjectedCRS",n.name=e[1],n.base_crs=e.find(f=>Array.isArray(f)&&f[0]==="BASEGEOGCRS")?this.convert(e.find(f=>Array.isArray(f)&&f[0]==="BASEGEOGCRS")):null,n.conversion=e.find(f=>Array.isArray(f)&&f[0]==="CONVERSION")?this.convert(e.find(f=>Array.isArray(f)&&f[0]==="CONVERSION")):null;const r=e.find(f=>Array.isArray(f)&&f[0]==="CS");r&&(n.coordinate_system={type:r[1],axis:this.extractAxes(e)});const i=e.find(f=>Array.isArray(f)&&f[0]==="LENGTHUNIT");if(i){const f=this.convertUnit(i);n.coordinate_system.unit=f}n.id=this.getId(e);break;case"BASEGEOGCRS":case"GEOGCRS":n.type="GeographicCRS",n.name=e[1];const s=e.find(f=>Array.isArray(f)&&(f[0]==="DATUM"||f[0]==="ENSEMBLE"));if(s){const f=this.convert(s);s[0]==="ENSEMBLE"?n.datum_ensemble=f:n.datum=f;const g=e.find(y=>Array.isArray(y)&&y[0]==="PRIMEM");g&&g[1]!=="Greenwich"&&(f.prime_meridian={name:g[1],longitude:parseFloat(g[2])})}n.coordinate_system={type:"ellipsoidal",axis:this.extractAxes(e)},n.id=this.getId(e);break;case"DATUM":n.type="GeodeticReferenceFrame",n.name=e[1],n.ellipsoid=e.find(f=>Array.isArray(f)&&f[0]==="ELLIPSOID")?this.convert(e.find(f=>Array.isArray(f)&&f[0]==="ELLIPSOID")):null;break;case"ENSEMBLE":n.type="DatumEnsemble",n.name=e[1],n.members=e.filter(f=>Array.isArray(f)&&f[0]==="MEMBER").map(f=>({type:"DatumEnsembleMember",name:f[1],id:this.getId(f)}));const o=e.find(f=>Array.isArray(f)&&f[0]==="ENSEMBLEACCURACY");o&&(n.accuracy=parseFloat(o[1]));const a=e.find(f=>Array.isArray(f)&&f[0]==="ELLIPSOID");a&&(n.ellipsoid=this.convert(a)),n.id=this.getId(e);break;case"ELLIPSOID":n.type="Ellipsoid",n.name=e[1],n.semi_major_axis=parseFloat(e[2]),n.inverse_flattening=parseFloat(e[3]),e.find(f=>Array.isArray(f)&&f[0]==="LENGTHUNIT")&&this.convert(e.find(f=>Array.isArray(f)&&f[0]==="LENGTHUNIT"),n);break;case"CONVERSION":n.type="Conversion",n.name=e[1],n.method=e.find(f=>Array.isArray(f)&&f[0]==="METHOD")?this.convert(e.find(f=>Array.isArray(f)&&f[0]==="METHOD")):null,n.parameters=e.filter(f=>Array.isArray(f)&&f[0]==="PARAMETER").map(f=>this.convert(f));break;case"METHOD":n.type="Method",n.name=e[1],n.id=this.getId(e);break;case"PARAMETER":n.type="Parameter",n.name=e[1],n.value=parseFloat(e[2]),n.unit=this.convertUnit(e.find(f=>Array.isArray(f)&&(f[0]==="LENGTHUNIT"||f[0]==="ANGLEUNIT"||f[0]==="SCALEUNIT"))),n.id=this.getId(e);break;case"BOUNDCRS":n.type="BoundCRS";const l=e.find(f=>Array.isArray(f)&&f[0]==="SOURCECRS");if(l){const f=l.find(g=>Array.isArray(g));n.source_crs=f?this.convert(f):null}const c=e.find(f=>Array.isArray(f)&&f[0]==="TARGETCRS");if(c){const f=c.find(g=>Array.isArray(g));n.target_crs=f?this.convert(f):null}const u=e.find(f=>Array.isArray(f)&&f[0]==="ABRIDGEDTRANSFORMATION");u?n.transformation=this.convert(u):n.transformation=null;break;case"ABRIDGEDTRANSFORMATION":if(n.type="Transformation",n.name=e[1],n.method=e.find(f=>Array.isArray(f)&&f[0]==="METHOD")?this.convert(e.find(f=>Array.isArray(f)&&f[0]==="METHOD")):null,n.parameters=e.filter(f=>Array.isArray(f)&&(f[0]==="PARAMETER"||f[0]==="PARAMETERFILE")).map(f=>{if(f[0]==="PARAMETER")return this.convert(f);if(f[0]==="PARAMETERFILE")return{name:f[1],value:f[2],id:{authority:"EPSG",code:8656}}}),n.parameters.length===7){const f=n.parameters[6];f.name==="Scale difference"&&(f.value=Math.round((f.value-1)*1e12)/1e6)}n.id=this.getId(e);break;case"AXIS":n.coordinate_system||(n.coordinate_system={type:"unspecified",axis:[]}),n.coordinate_system.axis.push(this.convertAxis(e));break;case"LENGTHUNIT":const h=this.convertUnit(e,"LinearUnit");n.coordinate_system&&n.coordinate_system.axis&&n.coordinate_system.axis.forEach(f=>{f.unit||(f.unit=h)}),h.conversion_factor&&h.conversion_factor!==1&&n.semi_major_axis&&(n.semi_major_axis={value:n.semi_major_axis,unit:h});break;default:n.keyword=e[0];break}return n}}class zht extends S2e{static convert(e,n={}){return super.convert(e,n),n.coordinate_system&&n.coordinate_system.subtype==="Cartesian"&&delete n.coordinate_system,n.usage&&delete n.usage,n}}class Ght extends S2e{static convert(e,n={}){super.convert(e,n);const r=e.find(s=>Array.isArray(s)&&s[0]==="CS");r&&(n.coordinate_system={subtype:r[1],axis:this.extractAxes(e)});const i=e.find(s=>Array.isArray(s)&&s[0]==="USAGE");if(i){const s=i.find(l=>Array.isArray(l)&&l[0]==="SCOPE"),o=i.find(l=>Array.isArray(l)&&l[0]==="AREA"),a=i.find(l=>Array.isArray(l)&&l[0]==="BBOX");n.usage={},s&&(n.usage.scope=s[1]),o&&(n.usage.area=o[1]),a&&(n.usage.bbox=a.slice(1))}return n}}function Uht(t){return t.find(e=>Array.isArray(e)&&e[0]==="USAGE")?"2019":(t.find(e=>Array.isArray(e)&&e[0]==="CS")||t[0]==="BOUNDCRS"||t[0]==="PROJCRS"||t[0]==="GEOGCRS","2015")}function Bht(t){return(Uht(t)==="2019"?Ght:zht).convert(t)}function Wht(t){const e=t.toUpperCase();return e.includes("PROJCRS")||e.includes("GEOGCRS")||e.includes("BOUNDCRS")||e.includes("VERTCRS")||e.includes("LENGTHUNIT")||e.includes("ANGLEUNIT")||e.includes("SCALEUNIT")?"WKT2":(e.includes("PROJCS")||e.includes("GEOGCS")||e.includes("LOCAL_CS")||e.includes("VERT_CS")||e.includes("UNIT"),"WKT1")}var wA=1,T2e=2,k2e=3,UN=4,A2e=5,QH=-1,Hht=/\s/,qht=/[A-Za-z]/,Kht=/[A-Za-z84_]/,TL=/[,\]]/,I2e=/[\d\.E\-\+]/;function Ip(t){if(typeof t!="string")throw new Error("not a string");this.text=t.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=wA}Ip.prototype.readCharicter=function(){var t=this.text[this.place++];if(this.state!==UN)for(;Hht.test(t);){if(this.place>=this.text.length)return;t=this.text[this.place++]}switch(this.state){case wA:return this.neutral(t);case T2e:return this.keyword(t);case UN:return this.quoted(t);case A2e:return this.afterquote(t);case k2e:return this.number(t);case QH:return}};Ip.prototype.afterquote=function(t){if(t==='"'){this.word+='"',this.state=UN;return}if(TL.test(t)){this.word=this.word.trim(),this.afterItem(t);return}throw new Error(`havn't handled "`+t+'" in afterquote yet, index '+this.place)};Ip.prototype.afterItem=function(t){if(t===","){this.word!==null&&this.currentObject.push(this.word),this.word=null,this.state=wA;return}if(t==="]"){this.level--,this.word!==null&&(this.currentObject.push(this.word),this.word=null),this.state=wA,this.currentObject=this.stack.pop(),this.currentObject||(this.state=QH);return}};Ip.prototype.number=function(t){if(I2e.test(t)){this.word+=t;return}if(TL.test(t)){this.word=parseFloat(this.word),this.afterItem(t);return}throw new Error(`havn't handled "`+t+'" in number yet, index '+this.place)};Ip.prototype.quoted=function(t){if(t==='"'){this.state=A2e;return}this.word+=t};Ip.prototype.keyword=function(t){if(Kht.test(t)){this.word+=t;return}if(t==="["){var e=[];e.push(this.word),this.level++,this.root===null?this.root=e:this.currentObject.push(e),this.stack.push(this.currentObject),this.currentObject=e,this.state=wA;return}if(TL.test(t)){this.afterItem(t);return}throw new Error(`havn't handled "`+t+'" in keyword yet, index '+this.place)};Ip.prototype.neutral=function(t){if(qht.test(t)){this.word=t,this.state=T2e;return}if(t==='"'){this.word="",this.state=UN;return}if(I2e.test(t)){this.word=t,this.state=k2e;return}if(TL.test(t)){this.afterItem(t);return}throw new Error(`havn't handled "`+t+'" in neutral yet, index '+this.place)};Ip.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(this.state===QH)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};function Yht(t){var e=new Ip(t);return e.output()}function K$(t,e,n){Array.isArray(e)&&(n.unshift(e),e=null);var r=e?{}:t,i=n.reduce(function(s,o){return Vx(o,s),s},r);e&&(t[e]=i)}function Vx(t,e){if(!Array.isArray(t)){e[t]=!0;return}var n=t.shift();if(n==="PARAMETER"&&(n=t.shift()),t.length===1){if(Array.isArray(t[0])){e[n]={},Vx(t[0],e[n]);return}e[n]=t[0];return}if(!t.length){e[n]=!0;return}if(n==="TOWGS84"){e[n]=t;return}if(n==="AXIS"){n in e||(e[n]=[]),e[n].push(t);return}Array.isArray(n)||(e[n]={});var r;switch(n){case"UNIT":case"PRIMEM":case"VERT_DATUM":e[n]={name:t[0].toLowerCase(),convert:t[1]},t.length===3&&Vx(t[2],e[n]);return;case"SPHEROID":case"ELLIPSOID":e[n]={name:t[0],a:t[1],rf:t[2]},t.length===4&&Vx(t[3],e[n]);return;case"EDATUM":case"ENGINEERINGDATUM":case"LOCAL_DATUM":case"DATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":t[0]=["name",t[0]],K$(e,n,t);return;case"COMPD_CS":case"COMPOUNDCRS":case"FITTED_CS":case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"ENGCRS":case"ENGINEERINGCRS":t[0]=["name",t[0]],K$(e,n,t),e[n].type=n;return;default:for(r=-1;++r<t.length;)if(!Array.isArray(t[r]))return Vx(t,e[n]);return K$(e,n,t)}}var Xht=.017453292519943295;function Yu(t){return t*Xht}function P2e(t){const e=(t.projName||"").toLowerCase().replace(/_/g," ");!t.long0&&t.longc&&(e==="albers conic equal area"||e==="lambert azimuthal equal area")&&(t.long0=t.longc),!t.lat_ts&&t.lat1&&(e==="stereographic south pole"||e==="polar stereographic (variant b)")?(t.lat0=Yu(t.lat1>0?90:-90),t.lat_ts=t.lat1,delete t.lat1):!t.lat_ts&&t.lat0&&(e==="polar stereographic"||e==="polar stereographic (variant a)")&&(t.lat_ts=t.lat0,t.lat0=Yu(t.lat0>0?90:-90),delete t.lat1)}function noe(t){let e={units:null,to_meter:void 0};return typeof t=="string"?(e.units=t.toLowerCase(),e.units==="metre"&&(e.units="meter"),e.units==="meter"&&(e.to_meter=1)):t&&t.name&&(e.units=t.name.toLowerCase(),e.units==="metre"&&(e.units="meter"),e.to_meter=t.conversion_factor),e}function roe(t){return typeof t=="object"?t.value*t.unit.conversion_factor:t}function ioe(t,e){t.ellipsoid.radius?(e.a=t.ellipsoid.radius,e.rf=0):(e.a=roe(t.ellipsoid.semi_major_axis),t.ellipsoid.inverse_flattening!==void 0?e.rf=t.ellipsoid.inverse_flattening:t.ellipsoid.semi_major_axis!==void 0&&t.ellipsoid.semi_minor_axis!==void 0&&(e.rf=e.a/(e.a-roe(t.ellipsoid.semi_minor_axis))))}function BN(t,e={}){return!t||typeof t!="object"?t:t.type==="BoundCRS"?(BN(t.source_crs,e),t.transformation&&(t.transformation.method&&t.transformation.method.name==="NTv2"?e.nadgrids=t.transformation.parameters[0].value:e.datum_params=t.transformation.parameters.map(n=>n.value)),e):(Object.keys(t).forEach(n=>{const r=t[n];if(r!==null)switch(n){case"name":if(e.srsCode)break;e.name=r,e.srsCode=r;break;case"type":r==="GeographicCRS"?e.projName="longlat":r==="ProjectedCRS"&&t.conversion&&t.conversion.method&&(e.projName=t.conversion.method.name);break;case"datum":case"datum_ensemble":r.ellipsoid&&(e.ellps=r.ellipsoid.name,ioe(r,e)),r.prime_meridian&&(e.from_greenwich=r.prime_meridian.longitude*Math.PI/180);break;case"ellipsoid":e.ellps=r.name,ioe(r,e);break;case"prime_meridian":e.long0=(r.longitude||0)*Math.PI/180;break;case"coordinate_system":if(r.axis){if(e.axis=r.axis.map(i=>{const s=i.direction;if(s==="east")return"e";if(s==="north")return"n";if(s==="west")return"w";if(s==="south")return"s";throw new Error(`Unknown axis direction: ${s}`)}).join("")+"u",r.unit){const{units:i,to_meter:s}=noe(r.unit);e.units=i,e.to_meter=s}else if(r.axis[0]&&r.axis[0].unit){const{units:i,to_meter:s}=noe(r.axis[0].unit);e.units=i,e.to_meter=s}}break;case"id":r.authority&&r.code&&(e.title=r.authority+":"+r.code);break;case"conversion":r.method&&r.method.name&&(e.projName=r.method.name),r.parameters&&r.parameters.forEach(i=>{const s=i.name.toLowerCase().replace(/\s+/g,"_"),o=i.value;i.unit&&i.unit.conversion_factor?e[s]=o*i.unit.conversion_factor:i.unit==="degree"?e[s]=o*Math.PI/180:e[s]=o});break;case"unit":r.name&&(e.units=r.name.toLowerCase(),e.units==="metre"&&(e.units="meter")),r.conversion_factor&&(e.to_meter=r.conversion_factor);break;case"base_crs":BN(r,e),e.datumCode=r.id?r.id.authority+"_"+r.id.code:r.name;break}}),e.latitude_of_false_origin!==void 0&&(e.lat0=e.latitude_of_false_origin),e.longitude_of_false_origin!==void 0&&(e.long0=e.longitude_of_false_origin),e.latitude_of_standard_parallel!==void 0&&(e.lat0=e.latitude_of_standard_parallel,e.lat1=e.latitude_of_standard_parallel),e.latitude_of_1st_standard_parallel!==void 0&&(e.lat1=e.latitude_of_1st_standard_parallel),e.latitude_of_2nd_standard_parallel!==void 0&&(e.lat2=e.latitude_of_2nd_standard_parallel),e.latitude_of_projection_centre!==void 0&&(e.lat0=e.latitude_of_projection_centre),e.longitude_of_projection_centre!==void 0&&(e.longc=e.longitude_of_projection_centre),e.easting_at_false_origin!==void 0&&(e.x0=e.easting_at_false_origin),e.northing_at_false_origin!==void 0&&(e.y0=e.northing_at_false_origin),e.latitude_of_natural_origin!==void 0&&(e.lat0=e.latitude_of_natural_origin),e.longitude_of_natural_origin!==void 0&&(e.long0=e.longitude_of_natural_origin),e.longitude_of_origin!==void 0&&(e.long0=e.longitude_of_origin),e.false_easting!==void 0&&(e.x0=e.false_easting),e.easting_at_projection_centre&&(e.x0=e.easting_at_projection_centre),e.false_northing!==void 0&&(e.y0=e.false_northing),e.northing_at_projection_centre&&(e.y0=e.northing_at_projection_centre),e.standard_parallel_1!==void 0&&(e.lat1=e.standard_parallel_1),e.standard_parallel_2!==void 0&&(e.lat2=e.standard_parallel_2),e.scale_factor_at_natural_origin!==void 0&&(e.k0=e.scale_factor_at_natural_origin),e.scale_factor_at_projection_centre!==void 0&&(e.k0=e.scale_factor_at_projection_centre),e.scale_factor_on_pseudo_standard_parallel!==void 0&&(e.k0=e.scale_factor_on_pseudo_standard_parallel),e.azimuth!==void 0&&(e.alpha=e.azimuth),e.azimuth_at_projection_centre!==void 0&&(e.alpha=e.azimuth_at_projection_centre),e.angle_from_rectified_to_skew_grid&&(e.rectified_grid_angle=e.angle_from_rectified_to_skew_grid),P2e(e),e)}var Zht=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function Jht(t,e){var n=e[0],r=e[1];!(n in t)&&r in t&&(t[n]=t[r],e.length===3&&(t[n]=e[2](t[n])))}function C2e(t){for(var e=Object.keys(t),n=0,r=e.length;n<r;++n){var i=e[n];Zht.indexOf(i)!==-1&&Qht(t[i]),typeof t[i]=="object"&&C2e(t[i])}}function Qht(t){if(t.AUTHORITY){var e=Object.keys(t.AUTHORITY)[0];e&&e in t.AUTHORITY&&(t.title=e+":"+t.AUTHORITY[e])}if(t.type==="GEOGCS"?t.projName="longlat":t.type==="LOCAL_CS"?(t.projName="identity",t.local=!0):typeof t.PROJECTION=="object"?t.projName=Object.keys(t.PROJECTION)[0]:t.projName=t.PROJECTION,t.AXIS){for(var n="",r=0,i=t.AXIS.length;r<i;++r){var s=[t.AXIS[r][0].toLowerCase(),t.AXIS[r][1].toLowerCase()];s[0].indexOf("north")!==-1||(s[0]==="y"||s[0]==="lat")&&s[1]==="north"?n+="n":s[0].indexOf("south")!==-1||(s[0]==="y"||s[0]==="lat")&&s[1]==="south"?n+="s":s[0].indexOf("east")!==-1||(s[0]==="x"||s[0]==="lon")&&s[1]==="east"?n+="e":(s[0].indexOf("west")!==-1||(s[0]==="x"||s[0]==="lon")&&s[1]==="west")&&(n+="w")}n.length===2&&(n+="u"),n.length===3&&(t.axis=n)}t.UNIT&&(t.units=t.UNIT.name.toLowerCase(),t.units==="metre"&&(t.units="meter"),t.UNIT.convert&&(t.type==="GEOGCS"?t.DATUM&&t.DATUM.SPHEROID&&(t.to_meter=t.UNIT.convert*t.DATUM.SPHEROID.a):t.to_meter=t.UNIT.convert));var o=t.GEOGCS;t.type==="GEOGCS"&&(o=t),o&&(o.DATUM?t.datumCode=o.DATUM.name.toLowerCase():t.datumCode=o.name.toLowerCase(),t.datumCode.slice(0,2)==="d_"&&(t.datumCode=t.datumCode.slice(2)),t.datumCode==="new_zealand_1949"&&(t.datumCode="nzgd49"),(t.datumCode==="wgs_1984"||t.datumCode==="world_geodetic_system_1984")&&(t.PROJECTION==="Mercator_Auxiliary_Sphere"&&(t.sphere=!0),t.datumCode="wgs84"),t.datumCode==="belge_1972"&&(t.datumCode="rnb72"),o.DATUM&&o.DATUM.SPHEROID&&(t.ellps=o.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),t.ellps.toLowerCase().slice(0,13)==="international"&&(t.ellps="intl"),t.a=o.DATUM.SPHEROID.a,t.rf=parseFloat(o.DATUM.SPHEROID.rf,10)),o.DATUM&&o.DATUM.TOWGS84&&(t.datum_params=o.DATUM.TOWGS84),~t.datumCode.indexOf("osgb_1936")&&(t.datumCode="osgb36"),~t.datumCode.indexOf("osni_1952")&&(t.datumCode="osni52"),(~t.datumCode.indexOf("tm65")||~t.datumCode.indexOf("geodetic_datum_of_1965"))&&(t.datumCode="ire65"),t.datumCode==="ch1903+"&&(t.datumCode="ch1903"),~t.datumCode.indexOf("israel")&&(t.datumCode="isr93")),t.b&&!isFinite(t.b)&&(t.b=t.a),t.rectified_grid_angle&&(t.rectified_grid_angle=Yu(t.rectified_grid_angle));function a(u){var h=t.to_meter||1;return u*h}var l=function(u){return Jht(t,u)},c=[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",Yu],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",Yu],["x0","false_easting",a],["y0","false_northing",a],["long0","central_meridian",Yu],["lat0","latitude_of_origin",Yu],["lat0","standard_parallel_1",Yu],["lat1","standard_parallel_1",Yu],["lat2","standard_parallel_2",Yu],["azimuth","Azimuth"],["alpha","azimuth",Yu],["srsCode","name"]];c.forEach(l),P2e(t)}function WN(t){if(typeof t=="object")return BN(t);const e=Wht(t);var n=Yht(t);if(e==="WKT2"){const s=Bht(n);return BN(s)}var r=n[0],i={};return Vx(n,i),C2e(i),i[r]}function Io(t){var e=this;if(arguments.length===2){var n=arguments[1];typeof n=="string"?n.charAt(0)==="+"?Io[t]=Sz(arguments[1]):Io[t]=WN(arguments[1]):n&&typeof n=="object"&&!("projName"in n)?Io[t]=WN(arguments[1]):(Io[t]=n,n||delete Io[t])}else if(arguments.length===1){if(Array.isArray(t))return t.map(function(r){return Array.isArray(r)?Io.apply(e,r):Io(r)});if(typeof t=="string"){if(t in Io)return Io[t]}else"EPSG"in t?Io["EPSG:"+t.EPSG]=t:"ESRI"in t?Io["ESRI:"+t.ESRI]=t:"IAU2000"in t?Io["IAU2000:"+t.IAU2000]=t:console.log(t);return}}Oht(Io);function edt(t){return typeof t=="string"}function tdt(t){return t in Io}function ndt(t){return t.indexOf("+")!==0&&t.indexOf("[")!==-1||typeof t=="object"&&!("srsCode"in t)}var rdt=["3857","900913","3785","102113"];function idt(t){var e=Yg(t,"authority");if(e){var n=Yg(e,"epsg");return n&&rdt.indexOf(n)>-1}}function sdt(t){var e=Yg(t,"extension");if(e)return Yg(e,"proj4")}function odt(t){return t[0]==="+"}function adt(t){if(edt(t)){if(tdt(t))return Io[t];if(ndt(t)){var e=WN(t);if(idt(e))return Io["EPSG:3857"];var n=sdt(e);return n?Sz(n):e}if(odt(t))return Sz(t)}else return"projName"in t?t:WN(t)}function soe(t,e){t=t||{};var n,r;if(!e)return t;for(r in e)n=e[r],n!==void 0&&(t[r]=n);return t}function Fd(t,e,n){var r=t*e;return n/Math.sqrt(1-r*r)}function HI(t){return t<0?-1:1}function Pt(t,e){return e||Math.abs(t)<=hs?t:t-HI(t)*xA}function fh(t,e,n){var r=t*n,i=.5*t;return r=Math.pow((1-r)/(1+r),i),Math.tan(.5*(st-e))/r}function bA(t,e){for(var n=.5*t,r,i,s=st-2*Math.atan(e),o=0;o<=15;o++)if(r=t*Math.sin(s),i=st-2*Math.atan(e*Math.pow((1-r)/(1+r),n))-s,s+=i,Math.abs(i)<=1e-10)return s;return-9999}function ldt(){var t=this.b/this.a;this.es=1-t*t,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=Fd(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)}function cdt(t){var e=t.x,n=t.y;if(n*bl>90&&n*bl<-90&&e*bl>180&&e*bl<-180)return null;var r,i;if(Math.abs(Math.abs(n)-st)<=wt)return null;if(this.sphere)r=this.x0+this.a*this.k0*Pt(e-this.long0,this.over),i=this.y0+this.a*this.k0*Math.log(Math.tan(Nr+.5*n));else{var s=Math.sin(n),o=fh(this.e,n,s);r=this.x0+this.a*this.k0*Pt(e-this.long0,this.over),i=this.y0-this.a*this.k0*Math.log(o)}return t.x=r,t.y=i,t}function udt(t){var e=t.x-this.x0,n=t.y-this.y0,r,i;if(this.sphere)i=st-2*Math.atan(Math.exp(-n/(this.a*this.k0)));else{var s=Math.exp(-n/(this.a*this.k0));if(i=bA(this.e,s),i===-9999)return null}return r=Pt(this.long0+e/(this.a*this.k0),this.over),t.x=r,t.y=i,t}var hdt=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","Mercator_Variant_A","merc"];const ddt={init:ldt,forward:cdt,inverse:udt,names:hdt};function fdt(){}function ooe(t){return t}var R2e=["longlat","identity"];const pdt={init:fdt,forward:ooe,inverse:ooe,names:R2e};var mdt=[ddt,pdt],_y={},zx=[];function M2e(t,e){var n=zx.length;return t.names?(zx[n]=t,t.names.forEach(function(r){_y[r.toLowerCase()]=n}),this):(console.log(e),!0)}function N2e(t){return t.replace(/[-\(\)\s]+/g," ").trim().replace(/ /g,"_")}function gdt(t){if(!t)return!1;var e=t.toLowerCase();if(typeof _y[e]<"u"&&zx[_y[e]]||(e=N2e(e),e in _y&&zx[_y[e]]))return zx[_y[e]]}function ydt(){mdt.forEach(M2e)}const vdt={start:ydt,add:M2e,get:gdt};var O2e={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563396e-3,b:635625691e-2,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340189e-3,b:6356034446e-3,ellipseName:"Modified Airy"},andrae:{a:637710443e-2,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397155e-3,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483865e-3,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:63782064e-1,b:63565838e-1,ellipseName:"Clarke 1866"},clrk80:{a:6378249145e-3,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk80ign:{a:63782492e-1,b:6356515,rf:293.4660213,ellipseName:"Clarke 1880 (IGN)"},clrk58:{a:6378293645208759e-9,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:63757387e-1,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:637813605e-2,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276345e-3,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304063e-3,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301243e-3,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295664e-3,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298556e-3,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:63781575e-1,b:63567722e-1,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:63567733205e-4,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:63558348467e-4,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"},WGS84:{a:6378137,rf:298.257223563,ellipseName:"WGS 84"},sphere:{a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"}};const _dt=O2e.WGS84;function xdt(t,e,n,r){var i=t*t,s=e*e,o=(i-s)/i,a=0;r?(t*=1-o*(jht+o*($ht+o*Fht)),i=t*t,o=0):a=Math.sqrt(o);var l=(i-s)/s;return{es:o,e:a,ep2:l}}function wdt(t,e,n,r,i){if(!t){var s=Yg(O2e,r);s||(s=_dt),t=s.a,e=s.b,n=s.rf}return n&&!e&&(e=(1-1/n)*t),(n===0||Math.abs(t-e)<wt)&&(i=!0,e=t),{a:t,b:e,rf:n,sphere:i}}var b3={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},mgi:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Militar-Geographische Institut"},osni52:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Ordnance Survey of Great Britain 1936"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"},EPSG_5451:{towgs84:"6.41,-49.05,-11.28,1.5657,0.5242,6.9718,-5.7649"},IGNF_LURESG:{towgs84:"-192.986,13.673,-39.309,-0.4099,-2.9332,2.6881,0.43"},EPSG_4614:{towgs84:"-119.4248,-303.65872,-11.00061,1.164298,0.174458,1.096259,3.657065"},EPSG_4615:{towgs84:"-494.088,-312.129,279.877,-1.423,-1.013,1.59,-0.748"},ESRI_37241:{towgs84:"-76.822,257.457,-12.817,2.136,-0.033,-2.392,-0.031"},ESRI_37249:{towgs84:"-440.296,58.548,296.265,1.128,10.202,4.559,-0.438"},ESRI_37245:{towgs84:"-511.151,-181.269,139.609,1.05,2.703,1.798,3.071"},EPSG_4178:{towgs84:"24.9,-126.4,-93.2,-0.063,-0.247,-0.041,1.01"},EPSG_4622:{towgs84:"-472.29,-5.63,-304.12,0.4362,-0.8374,0.2563,1.8984"},EPSG_4625:{towgs84:"126.93,547.94,130.41,-2.7867,5.1612,-0.8584,13.8227"},EPSG_5252:{towgs84:"0.023,0.036,-0.068,0.00176,0.00912,-0.01136,0.00439"},EPSG_4314:{towgs84:"597.1,71.4,412.1,0.894,0.068,-1.563,7.58"},EPSG_4282:{towgs84:"-178.3,-316.7,-131.5,5.278,6.077,10.979,19.166"},EPSG_4231:{towgs84:"-83.11,-97.38,-117.22,0.0276,-0.2167,0.2147,0.1218"},EPSG_4274:{towgs84:"-230.994,102.591,25.199,0.633,-0.239,0.9,1.95"},EPSG_4134:{towgs84:"-180.624,-225.516,173.919,-0.81,-1.898,8.336,16.71006"},EPSG_4254:{towgs84:"18.38,192.45,96.82,0.056,-0.142,-0.2,-0.0013"},EPSG_4159:{towgs84:"-194.513,-63.978,-25.759,-3.4027,3.756,-3.352,-0.9175"},EPSG_4687:{towgs84:"0.072,-0.507,-0.245,0.0183,-0.0003,0.007,-0.0093"},EPSG_4227:{towgs84:"-83.58,-397.54,458.78,-17.595,-2.847,4.256,3.225"},EPSG_4746:{towgs84:"599.4,72.4,419.2,-0.062,-0.022,-2.723,6.46"},EPSG_4745:{towgs84:"612.4,77,440.2,-0.054,0.057,-2.797,2.55"},EPSG_6311:{towgs84:"8.846,-4.394,-1.122,-0.00237,-0.146528,0.130428,0.783926"},EPSG_4289:{towgs84:"565.7381,50.4018,465.2904,-1.91514,1.60363,-9.09546,4.07244"},EPSG_4230:{towgs84:"-68.863,-134.888,-111.49,-0.53,-0.14,0.57,-3.4"},EPSG_4154:{towgs84:"-123.02,-158.95,-168.47"},EPSG_4156:{towgs84:"570.8,85.7,462.8,4.998,1.587,5.261,3.56"},EPSG_4299:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4179:{towgs84:"33.4,-146.6,-76.3,-0.359,-0.053,0.844,-0.84"},EPSG_4313:{towgs84:"-106.8686,52.2978,-103.7239,0.3366,-0.457,1.8422,-1.2747"},EPSG_4194:{towgs84:"163.511,127.533,-159.789"},EPSG_4195:{towgs84:"105,326,-102.5"},EPSG_4196:{towgs84:"-45,417,-3.5"},EPSG_4611:{towgs84:"-162.619,-276.959,-161.764,0.067753,-2.243649,-1.158827,-1.094246"},EPSG_4633:{towgs84:"137.092,131.66,91.475,-1.9436,-11.5993,-4.3321,-7.4824"},EPSG_4641:{towgs84:"-408.809,366.856,-412.987,1.8842,-0.5308,2.1655,-121.0993"},EPSG_4643:{towgs84:"-480.26,-438.32,-643.429,16.3119,20.1721,-4.0349,-111.7002"},EPSG_4300:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4188:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4660:{towgs84:"982.6087,552.753,-540.873,32.39344,-153.25684,-96.2266,16.805"},EPSG_4662:{towgs84:"97.295,-263.247,310.882,-1.5999,0.8386,3.1409,13.3259"},EPSG_3906:{towgs84:"577.88891,165.22205,391.18289,4.9145,-0.94729,-13.05098,7.78664"},EPSG_4307:{towgs84:"-209.3622,-87.8162,404.6198,0.0046,3.4784,0.5805,-1.4547"},EPSG_6892:{towgs84:"-76.269,-16.683,68.562,-6.275,10.536,-4.286,-13.686"},EPSG_4690:{towgs84:"221.597,152.441,176.523,2.403,1.3893,0.884,11.4648"},EPSG_4691:{towgs84:"218.769,150.75,176.75,3.5231,2.0037,1.288,10.9817"},EPSG_4629:{towgs84:"72.51,345.411,79.241,-1.5862,-0.8826,-0.5495,1.3653"},EPSG_4630:{towgs84:"165.804,216.213,180.26,-0.6251,-0.4515,-0.0721,7.4111"},EPSG_4692:{towgs84:"217.109,86.452,23.711,0.0183,-0.0003,0.007,-0.0093"},EPSG_9333:{towgs84:"0,0,0,-8.393,0.749,-10.276,0"},EPSG_9059:{towgs84:"0,0,0"},EPSG_4312:{towgs84:"601.705,84.263,485.227,4.7354,1.3145,5.393,-2.3887"},EPSG_4123:{towgs84:"-96.062,-82.428,-121.753,4.801,0.345,-1.376,1.496"},EPSG_4309:{towgs84:"-124.45,183.74,44.64,-0.4384,0.5446,-0.9706,-2.1365"},ESRI_104106:{towgs84:"-283.088,-70.693,117.445,-1.157,0.059,-0.652,-4.058"},EPSG_4281:{towgs84:"-219.247,-73.802,269.529"},EPSG_4322:{towgs84:"0,0,4.5"},EPSG_4324:{towgs84:"0,0,1.9"},EPSG_4284:{towgs84:"43.822,-108.842,-119.585,1.455,-0.761,0.737,0.549"},EPSG_4277:{towgs84:"446.448,-125.157,542.06,0.15,0.247,0.842,-20.489"},EPSG_4207:{towgs84:"-282.1,-72.2,120,-1.529,0.145,-0.89,-4.46"},EPSG_4688:{towgs84:"347.175,1077.618,2623.677,33.9058,-70.6776,9.4013,186.0647"},EPSG_4689:{towgs84:"410.793,54.542,80.501,-2.5596,-2.3517,-0.6594,17.3218"},EPSG_4720:{towgs84:"0,0,4.5"},EPSG_4273:{towgs84:"278.3,93,474.5,7.889,0.05,-6.61,6.21"},EPSG_4240:{towgs84:"204.64,834.74,293.8"},EPSG_4817:{towgs84:"278.3,93,474.5,7.889,0.05,-6.61,6.21"},ESRI_104131:{towgs84:"426.62,142.62,460.09,4.98,4.49,-12.42,-17.1"},EPSG_4265:{towgs84:"-104.1,-49.1,-9.9,0.971,-2.917,0.714,-11.68"},EPSG_4263:{towgs84:"-111.92,-87.85,114.5,1.875,0.202,0.219,0.032"},EPSG_4298:{towgs84:"-689.5937,623.84046,-65.93566,-0.02331,1.17094,-0.80054,5.88536"},EPSG_4270:{towgs84:"-253.4392,-148.452,386.5267,0.15605,0.43,-0.1013,-0.0424"},EPSG_4229:{towgs84:"-121.8,98.1,-10.7"},EPSG_4220:{towgs84:"-55.5,-348,-229.2"},EPSG_4214:{towgs84:"12.646,-155.176,-80.863"},EPSG_4232:{towgs84:"-345,3,223"},EPSG_4238:{towgs84:"-1.977,-13.06,-9.993,0.364,0.254,0.689,-1.037"},EPSG_4168:{towgs84:"-170,33,326"},EPSG_4131:{towgs84:"199,931,318.9"},EPSG_4152:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_5228:{towgs84:"572.213,85.334,461.94,4.9732,1.529,5.2484,3.5378"},EPSG_8351:{towgs84:"485.021,169.465,483.839,7.786342,4.397554,4.102655,0"},EPSG_4683:{towgs84:"-127.62,-67.24,-47.04,-3.068,4.903,1.578,-1.06"},EPSG_4133:{towgs84:"0,0,0"},EPSG_7373:{towgs84:"0.819,-0.5762,-1.6446,-0.00378,-0.03317,0.00318,0.0693"},EPSG_9075:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_9072:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_9294:{towgs84:"1.16835,-1.42001,-2.24431,-0.00822,-0.05508,0.01818,0.23388"},EPSG_4212:{towgs84:"-267.434,173.496,181.814,-13.4704,8.7154,7.3926,14.7492"},EPSG_4191:{towgs84:"-44.183,-0.58,-38.489,2.3867,2.7072,-3.5196,-8.2703"},EPSG_4237:{towgs84:"52.684,-71.194,-13.975,-0.312,-0.1063,-0.3729,1.0191"},EPSG_4740:{towgs84:"-1.08,-0.27,-0.9"},EPSG_4124:{towgs84:"419.3836,99.3335,591.3451,0.850389,1.817277,-7.862238,-0.99496"},EPSG_5681:{towgs84:"584.9636,107.7175,413.8067,1.1155,0.2824,-3.1384,7.9922"},EPSG_4141:{towgs84:"23.772,17.49,17.859,-0.3132,-1.85274,1.67299,-5.4262"},EPSG_4204:{towgs84:"-85.645,-273.077,-79.708,2.289,-1.421,2.532,3.194"},EPSG_4319:{towgs84:"226.702,-193.337,-35.371,-2.229,-4.391,9.238,0.9798"},EPSG_4200:{towgs84:"24.82,-131.21,-82.66"},EPSG_4130:{towgs84:"0,0,0"},EPSG_4127:{towgs84:"-82.875,-57.097,-156.768,-2.158,1.524,-0.982,-0.359"},EPSG_4149:{towgs84:"674.374,15.056,405.346"},EPSG_4617:{towgs84:"-0.991,1.9072,0.5129,1.25033e-7,4.6785e-8,5.6529e-8,0"},EPSG_4663:{towgs84:"-210.502,-66.902,-48.476,2.094,-15.067,-5.817,0.485"},EPSG_4664:{towgs84:"-211.939,137.626,58.3,-0.089,0.251,0.079,0.384"},EPSG_4665:{towgs84:"-105.854,165.589,-38.312,-0.003,-0.026,0.024,-0.048"},EPSG_4666:{towgs84:"631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43"},EPSG_4756:{towgs84:"-192.873,-39.382,-111.202,-0.00205,-0.0005,0.00335,0.0188"},EPSG_4723:{towgs84:"-179.483,-69.379,-27.584,-7.862,8.163,6.042,-13.925"},EPSG_4726:{towgs84:"8.853,-52.644,180.304,-0.393,-2.323,2.96,-24.081"},EPSG_4267:{towgs84:"-8.0,160.0,176.0"},EPSG_5365:{towgs84:"-0.16959,0.35312,0.51846,0.03385,-0.16325,0.03446,0.03693"},EPSG_4218:{towgs84:"304.5,306.5,-318.1"},EPSG_4242:{towgs84:"-33.722,153.789,94.959,-8.581,-4.478,4.54,8.95"},EPSG_4216:{towgs84:"-292.295,248.758,429.447,4.9971,2.99,6.6906,1.0289"},ESRI_104105:{towgs84:"631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43"},ESRI_104129:{towgs84:"0,0,0"},EPSG_4673:{towgs84:"174.05,-25.49,112.57"},EPSG_4202:{towgs84:"-124,-60,154"},EPSG_4203:{towgs84:"-117.763,-51.51,139.061,0.292,0.443,0.277,-0.191"},EPSG_3819:{towgs84:"595.48,121.69,515.35,4.115,-2.9383,0.853,-3.408"},EPSG_8694:{towgs84:"-93.799,-132.737,-219.073,-1.844,0.648,-6.37,-0.169"},EPSG_4145:{towgs84:"275.57,676.78,229.6"},EPSG_4283:{towgs84:"61.55,-10.87,-40.19,39.4924,32.7221,32.8979,-9.994"},EPSG_4317:{towgs84:"2.3287,-147.0425,-92.0802,-0.3092483,0.32482185,0.49729934,5.68906266"},EPSG_4272:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993"},EPSG_4248:{towgs84:"-307.7,265.3,-363.5"},EPSG_5561:{towgs84:"24,-121,-76"},EPSG_5233:{towgs84:"-0.293,766.95,87.713,0.195704,1.695068,3.473016,-0.039338"},ESRI_104130:{towgs84:"-86,-98,-119"},ESRI_104102:{towgs84:"682,-203,480"},ESRI_37207:{towgs84:"7,-10,-26"},EPSG_4675:{towgs84:"59.935,118.4,-10.871"},ESRI_104109:{towgs84:"-89.121,-348.182,260.871"},ESRI_104112:{towgs84:"-185.583,-230.096,281.361"},ESRI_104113:{towgs84:"25.1,-275.6,222.6"},IGNF_WGS72G:{towgs84:"0,12,6"},IGNF_NTFG:{towgs84:"-168,-60,320"},IGNF_EFATE57G:{towgs84:"-127,-769,472"},IGNF_PGP50G:{towgs84:"324.8,153.6,172.1"},IGNF_REUN47G:{towgs84:"94,-948,-1262"},IGNF_CSG67G:{towgs84:"-186,230,110"},IGNF_GUAD48G:{towgs84:"-467,-16,-300"},IGNF_TAHI51G:{towgs84:"162,117,154"},IGNF_TAHAAG:{towgs84:"65,342,77"},IGNF_NUKU72G:{towgs84:"84,274,65"},IGNF_PETRELS72G:{towgs84:"365,194,166"},IGNF_WALL78G:{towgs84:"253,-133,-127"},IGNF_MAYO50G:{towgs84:"-382,-59,-262"},IGNF_TANNAG:{towgs84:"-139,-967,436"},IGNF_IGN72G:{towgs84:"-13,-348,292"},IGNF_ATIGG:{towgs84:"1118,23,66"},IGNF_FANGA84G:{towgs84:"150.57,158.33,118.32"},IGNF_RUSAT84G:{towgs84:"202.13,174.6,-15.74"},IGNF_KAUE70G:{towgs84:"126.74,300.1,-75.49"},IGNF_MOP90G:{towgs84:"-10.8,-1.8,12.77"},IGNF_MHPF67G:{towgs84:"338.08,212.58,-296.17"},IGNF_TAHI79G:{towgs84:"160.61,116.05,153.69"},IGNF_ANAA92G:{towgs84:"1.5,3.84,4.81"},IGNF_MARQUI72G:{towgs84:"330.91,-13.92,58.56"},IGNF_APAT86G:{towgs84:"143.6,197.82,74.05"},IGNF_TUBU69G:{towgs84:"237.17,171.61,-77.84"},IGNF_STPM50G:{towgs84:"11.363,424.148,373.13"},EPSG_4150:{towgs84:"674.374,15.056,405.346"},EPSG_4754:{towgs84:"-208.4058,-109.8777,-2.5764"},ESRI_104101:{towgs84:"374,150,588"},EPSG_4693:{towgs84:"0,-0.15,0.68"},EPSG_6207:{towgs84:"293.17,726.18,245.36"},EPSG_4153:{towgs84:"-133.63,-157.5,-158.62"},EPSG_4132:{towgs84:"-241.54,-163.64,396.06"},EPSG_4221:{towgs84:"-154.5,150.7,100.4"},EPSG_4266:{towgs84:"-80.7,-132.5,41.1"},EPSG_4193:{towgs84:"-70.9,-151.8,-41.4"},EPSG_5340:{towgs84:"-0.41,0.46,-0.35"},EPSG_4246:{towgs84:"-294.7,-200.1,525.5"},EPSG_4318:{towgs84:"-3.2,-5.7,2.8"},EPSG_4121:{towgs84:"-199.87,74.79,246.62"},EPSG_4223:{towgs84:"-260.1,5.5,432.2"},EPSG_4158:{towgs84:"-0.465,372.095,171.736"},EPSG_4285:{towgs84:"-128.16,-282.42,21.93"},EPSG_4613:{towgs84:"-404.78,685.68,45.47"},EPSG_4607:{towgs84:"195.671,332.517,274.607"},EPSG_4475:{towgs84:"-381.788,-57.501,-256.673"},EPSG_4208:{towgs84:"-157.84,308.54,-146.6"},EPSG_4743:{towgs84:"70.995,-335.916,262.898"},EPSG_4710:{towgs84:"-323.65,551.39,-491.22"},EPSG_7881:{towgs84:"-0.077,0.079,0.086"},EPSG_4682:{towgs84:"283.729,735.942,261.143"},EPSG_4739:{towgs84:"-156,-271,-189"},EPSG_4679:{towgs84:"-80.01,253.26,291.19"},EPSG_4750:{towgs84:"-56.263,16.136,-22.856"},EPSG_4644:{towgs84:"-10.18,-350.43,291.37"},EPSG_4695:{towgs84:"-103.746,-9.614,-255.95"},EPSG_4292:{towgs84:"-355,21,72"},EPSG_4302:{towgs84:"-61.702,284.488,472.052"},EPSG_4143:{towgs84:"-124.76,53,466.79"},EPSG_4606:{towgs84:"-153,153,307"},EPSG_4699:{towgs84:"-770.1,158.4,-498.2"},EPSG_4247:{towgs84:"-273.5,110.6,-357.9"},EPSG_4160:{towgs84:"8.88,184.86,106.69"},EPSG_4161:{towgs84:"-233.43,6.65,173.64"},EPSG_9251:{towgs84:"-9.5,122.9,138.2"},EPSG_9253:{towgs84:"-78.1,101.6,133.3"},EPSG_4297:{towgs84:"-198.383,-240.517,-107.909"},EPSG_4269:{towgs84:"0,0,0"},EPSG_4301:{towgs84:"-147,506,687"},EPSG_4618:{towgs84:"-59,-11,-52"},EPSG_4612:{towgs84:"0,0,0"},EPSG_4678:{towgs84:"44.585,-131.212,-39.544"},EPSG_4250:{towgs84:"-130,29,364"},EPSG_4144:{towgs84:"214,804,268"},EPSG_4147:{towgs84:"-17.51,-108.32,-62.39"},EPSG_4259:{towgs84:"-254.1,-5.36,-100.29"},EPSG_4164:{towgs84:"-76,-138,67"},EPSG_4211:{towgs84:"-378.873,676.002,-46.255"},EPSG_4182:{towgs84:"-422.651,-172.995,84.02"},EPSG_4224:{towgs84:"-143.87,243.37,-33.52"},EPSG_4225:{towgs84:"-205.57,168.77,-4.12"},EPSG_5527:{towgs84:"-67.35,3.88,-38.22"},EPSG_4752:{towgs84:"98,390,-22"},EPSG_4310:{towgs84:"-30,190,89"},EPSG_9248:{towgs84:"-192.26,65.72,132.08"},EPSG_4680:{towgs84:"124.5,-63.5,-281"},EPSG_4701:{towgs84:"-79.9,-158,-168.9"},EPSG_4706:{towgs84:"-146.21,112.63,4.05"},EPSG_4805:{towgs84:"682,-203,480"},EPSG_4201:{towgs84:"-165,-11,206"},EPSG_4210:{towgs84:"-157,-2,-299"},EPSG_4183:{towgs84:"-104,167,-38"},EPSG_4139:{towgs84:"11,72,-101"},EPSG_4668:{towgs84:"-86,-98,-119"},EPSG_4717:{towgs84:"-2,151,181"},EPSG_4732:{towgs84:"102,52,-38"},EPSG_4280:{towgs84:"-377,681,-50"},EPSG_4209:{towgs84:"-138,-105,-289"},EPSG_4261:{towgs84:"31,146,47"},EPSG_4658:{towgs84:"-73,46,-86"},EPSG_4721:{towgs84:"265.025,384.929,-194.046"},EPSG_4222:{towgs84:"-136,-108,-292"},EPSG_4601:{towgs84:"-255,-15,71"},EPSG_4602:{towgs84:"725,685,536"},EPSG_4603:{towgs84:"72,213.7,93"},EPSG_4605:{towgs84:"9,183,236"},EPSG_4621:{towgs84:"137,248,-430"},EPSG_4657:{towgs84:"-28,199,5"},EPSG_4316:{towgs84:"103.25,-100.4,-307.19"},EPSG_4642:{towgs84:"-13,-348,292"},EPSG_4698:{towgs84:"145,-187,103"},EPSG_4192:{towgs84:"-206.1,-174.7,-87.7"},EPSG_4311:{towgs84:"-265,120,-358"},EPSG_4135:{towgs84:"58,-283,-182"},ESRI_104138:{towgs84:"198,-226,-347"},EPSG_4245:{towgs84:"-11,851,5"},EPSG_4142:{towgs84:"-125,53,467"},EPSG_4213:{towgs84:"-106,-87,188"},EPSG_4253:{towgs84:"-133,-77,-51"},EPSG_4129:{towgs84:"-132,-110,-335"},EPSG_4713:{towgs84:"-77,-128,142"},EPSG_4239:{towgs84:"217,823,299"},EPSG_4146:{towgs84:"295,736,257"},EPSG_4155:{towgs84:"-83,37,124"},EPSG_4165:{towgs84:"-173,253,27"},EPSG_4672:{towgs84:"175,-38,113"},EPSG_4236:{towgs84:"-637,-549,-203"},EPSG_4251:{towgs84:"-90,40,88"},EPSG_4271:{towgs84:"-2,374,172"},EPSG_4175:{towgs84:"-88,4,101"},EPSG_4716:{towgs84:"298,-304,-375"},EPSG_4315:{towgs84:"-23,259,-9"},EPSG_4744:{towgs84:"-242.2,-144.9,370.3"},EPSG_4244:{towgs84:"-97,787,86"},EPSG_4293:{towgs84:"616,97,-251"},EPSG_4714:{towgs84:"-127,-769,472"},EPSG_4736:{towgs84:"260,12,-147"},EPSG_6883:{towgs84:"-235,-110,393"},EPSG_6894:{towgs84:"-63,176,185"},EPSG_4205:{towgs84:"-43,-163,45"},EPSG_4256:{towgs84:"41,-220,-134"},EPSG_4262:{towgs84:"639,405,60"},EPSG_4604:{towgs84:"174,359,365"},EPSG_4169:{towgs84:"-115,118,426"},EPSG_4620:{towgs84:"-106,-129,165"},EPSG_4184:{towgs84:"-203,141,53"},EPSG_4616:{towgs84:"-289,-124,60"},EPSG_9403:{towgs84:"-307,-92,127"},EPSG_4684:{towgs84:"-133,-321,50"},EPSG_4708:{towgs84:"-491,-22,435"},EPSG_4707:{towgs84:"114,-116,-333"},EPSG_4709:{towgs84:"145,75,-272"},EPSG_4712:{towgs84:"-205,107,53"},EPSG_4711:{towgs84:"124,-234,-25"},EPSG_4718:{towgs84:"230,-199,-752"},EPSG_4719:{towgs84:"211,147,111"},EPSG_4724:{towgs84:"208,-435,-229"},EPSG_4725:{towgs84:"189,-79,-202"},EPSG_4735:{towgs84:"647,1777,-1124"},EPSG_4722:{towgs84:"-794,119,-298"},EPSG_4728:{towgs84:"-307,-92,127"},EPSG_4734:{towgs84:"-632,438,-609"},EPSG_4727:{towgs84:"912,-58,1227"},EPSG_4729:{towgs84:"185,165,42"},EPSG_4730:{towgs84:"170,42,84"},EPSG_4733:{towgs84:"276,-57,149"},ESRI_37218:{towgs84:"230,-199,-752"},ESRI_37240:{towgs84:"-7,215,225"},ESRI_37221:{towgs84:"252,-209,-751"},ESRI_4305:{towgs84:"-123,-206,219"},ESRI_104139:{towgs84:"-73,-247,227"},EPSG_4748:{towgs84:"51,391,-36"},EPSG_4219:{towgs84:"-384,664,-48"},EPSG_4255:{towgs84:"-333,-222,114"},EPSG_4257:{towgs84:"-587.8,519.75,145.76"},EPSG_4646:{towgs84:"-963,510,-359"},EPSG_6881:{towgs84:"-24,-203,268"},EPSG_6882:{towgs84:"-183,-15,273"},EPSG_4715:{towgs84:"-104,-129,239"},IGNF_RGF93GDD:{towgs84:"0,0,0"},IGNF_RGM04GDD:{towgs84:"0,0,0"},IGNF_RGSPM06GDD:{towgs84:"0,0,0"},IGNF_RGTAAF07GDD:{towgs84:"0,0,0"},IGNF_RGFG95GDD:{towgs84:"0,0,0"},IGNF_RGNCG:{towgs84:"0,0,0"},IGNF_RGPFGDD:{towgs84:"0,0,0"},IGNF_ETRS89G:{towgs84:"0,0,0"},IGNF_RGR92GDD:{towgs84:"0,0,0"},EPSG_4173:{towgs84:"0,0,0"},EPSG_4180:{towgs84:"0,0,0"},EPSG_4619:{towgs84:"0,0,0"},EPSG_4667:{towgs84:"0,0,0"},EPSG_4075:{towgs84:"0,0,0"},EPSG_6706:{towgs84:"0,0,0"},EPSG_7798:{towgs84:"0,0,0"},EPSG_4661:{towgs84:"0,0,0"},EPSG_4669:{towgs84:"0,0,0"},EPSG_8685:{towgs84:"0,0,0"},EPSG_4151:{towgs84:"0,0,0"},EPSG_9702:{towgs84:"0,0,0"},EPSG_4758:{towgs84:"0,0,0"},EPSG_4761:{towgs84:"0,0,0"},EPSG_4765:{towgs84:"0,0,0"},EPSG_8997:{towgs84:"0,0,0"},EPSG_4023:{towgs84:"0,0,0"},EPSG_4670:{towgs84:"0,0,0"},EPSG_4694:{towgs84:"0,0,0"},EPSG_4148:{towgs84:"0,0,0"},EPSG_4163:{towgs84:"0,0,0"},EPSG_4167:{towgs84:"0,0,0"},EPSG_4189:{towgs84:"0,0,0"},EPSG_4190:{towgs84:"0,0,0"},EPSG_4176:{towgs84:"0,0,0"},EPSG_4659:{towgs84:"0,0,0"},EPSG_3824:{towgs84:"0,0,0"},EPSG_3889:{towgs84:"0,0,0"},EPSG_4046:{towgs84:"0,0,0"},EPSG_4081:{towgs84:"0,0,0"},EPSG_4558:{towgs84:"0,0,0"},EPSG_4483:{towgs84:"0,0,0"},EPSG_5013:{towgs84:"0,0,0"},EPSG_5264:{towgs84:"0,0,0"},EPSG_5324:{towgs84:"0,0,0"},EPSG_5354:{towgs84:"0,0,0"},EPSG_5371:{towgs84:"0,0,0"},EPSG_5373:{towgs84:"0,0,0"},EPSG_5381:{towgs84:"0,0,0"},EPSG_5393:{towgs84:"0,0,0"},EPSG_5489:{towgs84:"0,0,0"},EPSG_5593:{towgs84:"0,0,0"},EPSG_6135:{towgs84:"0,0,0"},EPSG_6365:{towgs84:"0,0,0"},EPSG_5246:{towgs84:"0,0,0"},EPSG_7886:{towgs84:"0,0,0"},EPSG_8431:{towgs84:"0,0,0"},EPSG_8427:{towgs84:"0,0,0"},EPSG_8699:{towgs84:"0,0,0"},EPSG_8818:{towgs84:"0,0,0"},EPSG_4757:{towgs84:"0,0,0"},EPSG_9140:{towgs84:"0,0,0"},EPSG_8086:{towgs84:"0,0,0"},EPSG_4686:{towgs84:"0,0,0"},EPSG_4737:{towgs84:"0,0,0"},EPSG_4702:{towgs84:"0,0,0"},EPSG_4747:{towgs84:"0,0,0"},EPSG_4749:{towgs84:"0,0,0"},EPSG_4674:{towgs84:"0,0,0"},EPSG_4755:{towgs84:"0,0,0"},EPSG_4759:{towgs84:"0,0,0"},EPSG_4762:{towgs84:"0,0,0"},EPSG_4763:{towgs84:"0,0,0"},EPSG_4764:{towgs84:"0,0,0"},EPSG_4166:{towgs84:"0,0,0"},EPSG_4170:{towgs84:"0,0,0"},EPSG_5546:{towgs84:"0,0,0"},EPSG_7844:{towgs84:"0,0,0"},EPSG_4818:{towgs84:"589,76,480"}};for(var bdt in b3){var Y$=b3[bdt];Y$.datumName&&(b3[Y$.datumName]=Y$)}function Edt(t,e,n,r,i,s,o){var a={};return t===void 0||t==="none"?a.datum_type=Ez:a.datum_type=Lht,e&&(a.datum_params=e.map(parseFloat),(a.datum_params[0]!==0||a.datum_params[1]!==0||a.datum_params[2]!==0)&&(a.datum_type=Z1),a.datum_params.length>3&&(a.datum_params[3]!==0||a.datum_params[4]!==0||a.datum_params[5]!==0||a.datum_params[6]!==0)&&(a.datum_type=J1,a.datum_params[3]*=BT,a.datum_params[4]*=BT,a.datum_params[5]*=BT,a.datum_params[6]=a.datum_params[6]/1e6+1)),o&&(a.datum_type=_w,a.grids=o),a.a=n,a.b=r,a.es=i,a.ep2=s,a}var eq={};function Sdt(t,e,n){return e instanceof ArrayBuffer?Tdt(t,e,n):{ready:kdt(t,e)}}function Tdt(t,e,n){var r=!0;n!==void 0&&n.includeErrorFields===!1&&(r=!1);var i=new DataView(e),s=Pdt(i),o=Cdt(i,s),a=Rdt(i,o,s,r),l={header:o,subgrids:a};return eq[t]=l,l}async function kdt(t,e){for(var n=[],r=await e.getImageCount(),i=r-1;i>=0;i--){var s=await e.getImage(i),o=await s.readRasters(),a=o,l=[s.getWidth(),s.getHeight()],c=s.getBoundingBox().map(aoe),u=[s.fileDirectory.ModelPixelScale[0],s.fileDirectory.ModelPixelScale[1]].map(aoe),h=c[0]+(l[0]-1)*u[0],f=c[3]-(l[1]-1)*u[1],g=a[0],y=a[1],_=[];for(let A=l[1]-1;A>=0;A--)for(let I=l[0]-1;I>=0;I--){var b=A*l[0]+I;_.push([-lg(y[b]),lg(g[b])])}n.push({del:u,lim:l,ll:[-h,f],cvs:_})}var T={header:{nSubgrids:r},subgrids:n};return eq[t]=T,T}function Adt(t){if(t===void 0)return null;var e=t.split(",");return e.map(Idt)}function Idt(t){if(t.length===0)return null;var e=t[0]==="@";return e&&(t=t.slice(1)),t==="null"?{name:"null",mandatory:!e,grid:null,isNull:!0}:{name:t,mandatory:!e,grid:eq[t]||null,isNull:!1}}function aoe(t){return t*Math.PI/180}function lg(t){return t/3600*Math.PI/180}function Pdt(t){var e=t.getInt32(8,!1);return e===11?!1:(e=t.getInt32(8,!0),e!==11&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}function Cdt(t,e){return{nFields:t.getInt32(8,e),nSubgridFields:t.getInt32(24,e),nSubgrids:t.getInt32(40,e),shiftType:Tz(t,56,64).trim(),fromSemiMajorAxis:t.getFloat64(120,e),fromSemiMinorAxis:t.getFloat64(136,e),toSemiMajorAxis:t.getFloat64(152,e),toSemiMinorAxis:t.getFloat64(168,e)}}function Tz(t,e,n){return String.fromCharCode.apply(null,new Uint8Array(t.buffer.slice(e,n)))}function Rdt(t,e,n,r){for(var i=176,s=[],o=0;o<e.nSubgrids;o++){var a=Ndt(t,i,n),l=Odt(t,i,a,n,r),c=Math.round(1+(a.upperLongitude-a.lowerLongitude)/a.longitudeInterval),u=Math.round(1+(a.upperLatitude-a.lowerLatitude)/a.latitudeInterval);s.push({ll:[lg(a.lowerLongitude),lg(a.lowerLatitude)],del:[lg(a.longitudeInterval),lg(a.latitudeInterval)],lim:[c,u],count:a.gridNodeCount,cvs:Mdt(l)});var h=16;r===!1&&(h=8),i+=176+a.gridNodeCount*h}return s}function Mdt(t){return t.map(function(e){return[lg(e.longitudeShift),lg(e.latitudeShift)]})}function Ndt(t,e,n){return{name:Tz(t,e+8,e+16).trim(),parent:Tz(t,e+24,e+24+8).trim(),lowerLatitude:t.getFloat64(e+72,n),upperLatitude:t.getFloat64(e+88,n),lowerLongitude:t.getFloat64(e+104,n),upperLongitude:t.getFloat64(e+120,n),latitudeInterval:t.getFloat64(e+136,n),longitudeInterval:t.getFloat64(e+152,n),gridNodeCount:t.getInt32(e+168,n)}}function Odt(t,e,n,r,i){var s=e+176,o=16;i===!1&&(o=8);for(var a=[],l=0;l<n.gridNodeCount;l++){var c={latitudeShift:t.getFloat32(s+l*o,r),longitudeShift:t.getFloat32(s+l*o+4,r)};i!==!1&&(c.latitudeAccuracy=t.getFloat32(s+l*o+8,r),c.longitudeAccuracy=t.getFloat32(s+l*o+12,r)),a.push(c)}return a}function fu(t,e){if(!(this instanceof fu))return new fu(t);this.forward=null,this.inverse=null,this.init=null,this.name,this.names=null,this.title,e=e||function(c){if(c)throw c};var n=adt(t);if(typeof n!="object"){e("Could not parse to valid json: "+t);return}var r=fu.projections.get(n.projName);if(!r){e("Could not get projection name from: "+t);return}if(n.datumCode&&n.datumCode!=="none"){var i=Yg(b3,n.datumCode);i&&(n.datum_params=n.datum_params||(i.towgs84?i.towgs84.split(","):null),n.ellps=i.ellipse,n.datumName=i.datumName?i.datumName:n.datumCode)}n.k0=n.k0||1,n.axis=n.axis||"enu",n.ellps=n.ellps||"wgs84",n.lat1=n.lat1||n.lat0;var s=wdt(n.a,n.b,n.rf,n.ellps,n.sphere),o=xdt(s.a,s.b,s.rf,n.R_A),a=Adt(n.nadgrids),l=n.datum||Edt(n.datumCode,n.datum_params,s.a,s.b,o.es,o.ep2,a);soe(this,n),soe(this,r),this.a=s.a,this.b=s.b,this.rf=s.rf,this.sphere=s.sphere,this.es=o.es,this.e=o.e,this.ep2=o.ep2,this.datum=l,"init"in this&&typeof this.init=="function"&&this.init(),e(null,this)}fu.projections=vdt;fu.projections.start();function Ldt(t,e){return t.datum_type!==e.datum_type||t.a!==e.a||Math.abs(t.es-e.es)>5e-11?!1:t.datum_type===Z1?t.datum_params[0]===e.datum_params[0]&&t.datum_params[1]===e.datum_params[1]&&t.datum_params[2]===e.datum_params[2]:t.datum_type===J1?t.datum_params[0]===e.datum_params[0]&&t.datum_params[1]===e.datum_params[1]&&t.datum_params[2]===e.datum_params[2]&&t.datum_params[3]===e.datum_params[3]&&t.datum_params[4]===e.datum_params[4]&&t.datum_params[5]===e.datum_params[5]&&t.datum_params[6]===e.datum_params[6]:!0}function L2e(t,e,n){var r=t.x,i=t.y,s=t.z?t.z:0,o,a,l,c;if(i<-st&&i>-1.001*st)i=-st;else if(i>st&&i<1.001*st)i=st;else{if(i<-st)return{x:-1/0,y:-1/0,z:t.z};if(i>st)return{x:1/0,y:1/0,z:t.z}}return r>Math.PI&&(r-=2*Math.PI),a=Math.sin(i),c=Math.cos(i),l=a*a,o=n/Math.sqrt(1-e*l),{x:(o+s)*c*Math.cos(r),y:(o+s)*c*Math.sin(r),z:(o*(1-e)+s)*a}}function D2e(t,e,n,r){var i=1e-12,s=i*i,o=30,a,l,c,u,h,f,g,y,_,b,T,A,I,P=t.x,R=t.y,D=t.z?t.z:0,C,M,O;if(a=Math.sqrt(P*P+R*R),l=Math.sqrt(P*P+R*R+D*D),a/n<i){if(C=0,l/n<i)return M=st,O=-r,{x:t.x,y:t.y,z:t.z}}else C=Math.atan2(R,P);c=D/l,u=a/l,h=1/Math.sqrt(1-e*(2-e)*u*u),y=u*(1-e)*h,_=c*h,I=0;do I++,g=n/Math.sqrt(1-e*_*_),O=a*y+D*_-g*(1-e*_*_),f=e*g/(g+O),h=1/Math.sqrt(1-f*(2-f)*u*u),b=u*(1-f)*h,T=c*h,A=T*y-b*_,y=b,_=T;while(A*A>s&&I<o);return M=Math.atan(T/Math.abs(b)),{x:C,y:M,z:O}}function Ddt(t,e,n){if(e===Z1)return{x:t.x+n[0],y:t.y+n[1],z:t.z+n[2]};if(e===J1){var r=n[0],i=n[1],s=n[2],o=n[3],a=n[4],l=n[5],c=n[6];return{x:c*(t.x-l*t.y+a*t.z)+r,y:c*(l*t.x+t.y-o*t.z)+i,z:c*(-a*t.x+o*t.y+t.z)+s}}}function jdt(t,e,n){if(e===Z1)return{x:t.x-n[0],y:t.y-n[1],z:t.z-n[2]};if(e===J1){var r=n[0],i=n[1],s=n[2],o=n[3],a=n[4],l=n[5],c=n[6],u=(t.x-r)/c,h=(t.y-i)/c,f=(t.z-s)/c;return{x:u+l*h-a*f,y:-l*u+h+o*f,z:a*u-o*h+f}}}function ER(t){return t===Z1||t===J1}function $dt(t,e,n){if(Ldt(t,e)||t.datum_type===Ez||e.datum_type===Ez)return n;var r=t.a,i=t.es;if(t.datum_type===_w){var s=loe(t,!1,n);if(s!==0)return;r=Qse,i=eoe}var o=e.a,a=e.b,l=e.es;if(e.datum_type===_w&&(o=Qse,a=Dht,l=eoe),i===l&&r===o&&!ER(t.datum_type)&&!ER(e.datum_type))return n;if(n=L2e(n,i,r),ER(t.datum_type)&&(n=Ddt(n,t.datum_type,t.datum_params)),ER(e.datum_type)&&(n=jdt(n,e.datum_type,e.datum_params)),n=D2e(n,l,o,a),e.datum_type===_w){var c=loe(e,!0,n);if(c!==0)return}return n}function loe(t,e,n){if(t.grids===null||t.grids.length===0)return console.log("Grid shift grids not found"),-1;var r={x:-n.x,y:n.y},i={x:Number.NaN,y:Number.NaN},s=[];e:for(var o=0;o<t.grids.length;o++){var a=t.grids[o];if(s.push(a.name),a.isNull){i=r;break}if(a.grid===null){if(a.mandatory)return console.log("Unable to find mandatory grid '"+a.name+"'"),-1;continue}for(var l=a.grid.subgrids,c=0,u=l.length;c<u;c++){var h=l[c],f=(Math.abs(h.del[1])+Math.abs(h.del[0]))/1e4,g=h.ll[0]-f,y=h.ll[1]-f,_=h.ll[0]+(h.lim[0]-1)*h.del[0]+f,b=h.ll[1]+(h.lim[1]-1)*h.del[1]+f;if(!(y>r.y||g>r.x||b<r.y||_<r.x)&&(i=Fdt(r,e,h),!isNaN(i.x)))break e}}return isNaN(i.x)?(console.log("Failed to find a grid shift table for location '"+-r.x*bl+" "+r.y*bl+" tried: '"+s+"'"),-1):(n.x=-i.x,n.y=i.y,0)}function Fdt(t,e,n){var r={x:Number.NaN,y:Number.NaN};if(isNaN(t.x))return r;var i={x:t.x,y:t.y};i.x-=n.ll[0],i.y-=n.ll[1],i.x=Pt(i.x-Math.PI)+Math.PI;var s=coe(i,n);if(e){if(isNaN(s.x))return r;s.x=i.x-s.x,s.y=i.y-s.y;var o=9,a=1e-12,l,c;do{if(c=coe(s,n),isNaN(c.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}l={x:i.x-(c.x+s.x),y:i.y-(c.y+s.y)},s.x+=l.x,s.y+=l.y}while(o--&&Math.abs(l.x)>a&&Math.abs(l.y)>a);if(o<0)return console.log("Inverse grid shift iterator failed to converge."),r;r.x=Pt(s.x+n.ll[0]),r.y=s.y+n.ll[1]}else isNaN(s.x)||(r.x=t.x+s.x,r.y=t.y+s.y);return r}function coe(t,e){var n={x:t.x/e.del[0],y:t.y/e.del[1]},r={x:Math.floor(n.x),y:Math.floor(n.y)},i={x:n.x-1*r.x,y:n.y-1*r.y},s={x:Number.NaN,y:Number.NaN},o;if(r.x<0||r.x>=e.lim[0]||r.y<0||r.y>=e.lim[1])return s;o=r.y*e.lim[0]+r.x;var a={x:e.cvs[o][0],y:e.cvs[o][1]};o++;var l={x:e.cvs[o][0],y:e.cvs[o][1]};o+=e.lim[0];var c={x:e.cvs[o][0],y:e.cvs[o][1]};o--;var u={x:e.cvs[o][0],y:e.cvs[o][1]},h=i.x*i.y,f=i.x*(1-i.y),g=(1-i.x)*(1-i.y),y=(1-i.x)*i.y;return s.x=g*a.x+f*l.x+y*u.x+h*c.x,s.y=g*a.y+f*l.y+y*u.y+h*c.y,s}function uoe(t,e,n){var r=n.x,i=n.y,s=n.z||0,o,a,l,c={};for(l=0;l<3;l++)if(!(e&&l===2&&n.z===void 0))switch(l===0?(o=r,"ew".indexOf(t.axis[l])!==-1?a="x":a="y"):l===1?(o=i,"ns".indexOf(t.axis[l])!==-1?a="y":a="x"):(o=s,a="z"),t.axis[l]){case"e":c[a]=o;break;case"w":c[a]=-o;break;case"n":c[a]=o;break;case"s":c[a]=-o;break;case"u":n[a]!==void 0&&(c.z=o);break;case"d":n[a]!==void 0&&(c.z=-o);break;default:return null}return c}function j2e(t){var e={x:t[0],y:t[1]};return t.length>2&&(e.z=t[2]),t.length>3&&(e.m=t[3]),e}function Vdt(t){hoe(t.x),hoe(t.y)}function hoe(t){if(typeof Number.isFinite=="function"){if(Number.isFinite(t))return;throw new TypeError("coordinates must be finite numbers")}if(typeof t!="number"||t!==t||!isFinite(t))throw new TypeError("coordinates must be finite numbers")}function zdt(t,e){return(t.datum.datum_type===Z1||t.datum.datum_type===J1||t.datum.datum_type===_w)&&e.datumCode!=="WGS84"||(e.datum.datum_type===Z1||e.datum.datum_type===J1||e.datum.datum_type===_w)&&t.datumCode!=="WGS84"}function HN(t,e,n,r){var i;Array.isArray(n)?n=j2e(n):n={x:n.x,y:n.y,z:n.z,m:n.m};var s=n.z!==void 0;if(Vdt(n),t.datum&&e.datum&&zdt(t,e)&&(i=new fu("WGS84"),n=HN(t,i,n,r),t=i),r&&t.axis!=="enu"&&(n=uoe(t,!1,n)),t.projName==="longlat")n={x:n.x*Ki,y:n.y*Ki,z:n.z||0};else if(t.to_meter&&(n={x:n.x*t.to_meter,y:n.y*t.to_meter,z:n.z||0}),n=t.inverse(n),!n)return;if(t.from_greenwich&&(n.x+=t.from_greenwich),n=$dt(t.datum,e.datum,n),!!n)return n=n,e.from_greenwich&&(n={x:n.x-e.from_greenwich,y:n.y,z:n.z||0}),e.projName==="longlat"?n={x:n.x*bl,y:n.y*bl,z:n.z||0}:(n=e.forward(n),e.to_meter&&(n={x:n.x/e.to_meter,y:n.y/e.to_meter,z:n.z||0})),r&&e.axis!=="enu"?uoe(e,!0,n):(n&&!s&&delete n.z,n)}var doe=fu("WGS84");function X$(t,e,n,r){var i,s,o;return Array.isArray(n)?(i=HN(t,e,n,r)||{x:NaN,y:NaN},n.length>2?typeof t.name<"u"&&t.name==="geocent"||typeof e.name<"u"&&e.name==="geocent"?typeof i.z=="number"?[i.x,i.y,i.z].concat(n.slice(3)):[i.x,i.y,n[2]].concat(n.slice(3)):[i.x,i.y].concat(n.slice(2)):[i.x,i.y]):(s=HN(t,e,n,r),o=Object.keys(n),o.length===2||o.forEach(function(a){if(typeof t.name<"u"&&t.name==="geocent"||typeof e.name<"u"&&e.name==="geocent"){if(a==="x"||a==="y"||a==="z")return}else if(a==="x"||a==="y")return;s[a]=n[a]}),s)}function SR(t){return t instanceof fu?t:typeof t=="object"&&"oProj"in t?t.oProj:fu(t)}function Gdt(t,e,n){var r,i,s=!1,o;return typeof e>"u"?(i=SR(t),r=doe,s=!0):(typeof e.x<"u"||Array.isArray(e))&&(n=e,i=SR(t),r=doe,s=!0),r||(r=SR(t)),i||(i=SR(e)),n?X$(r,i,n):(o={forward:function(a,l){return X$(r,i,a,l)},inverse:function(a,l){return X$(i,r,a,l)}},s&&(o.oProj=i),o)}var foe=6,$2e="AJSAJS",F2e="AFAFAF",Gx=65,rl=73,Wc=79,qS=86,KS=90;const Udt={forward:V2e,inverse:Bdt,toPoint:z2e};function V2e(t,e){return e=e||5,qdt(Wdt({lat:t[1],lon:t[0]}),e)}function Bdt(t){var e=tq(U2e(t.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat,e.lon,e.lat]:[e.left,e.bottom,e.right,e.top]}function z2e(t){var e=tq(U2e(t.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat]:[(e.left+e.right)/2,(e.top+e.bottom)/2]}function Z$(t){return t*(Math.PI/180)}function poe(t){return 180*(t/Math.PI)}function Wdt(t){var e=t.lat,n=t.lon,r=6378137,i=.00669438,s=.9996,o,a,l,c,u,h,f,g=Z$(e),y=Z$(n),_,b;b=Math.floor((n+180)/6)+1,n===180&&(b=60),e>=56&&e<64&&n>=3&&n<12&&(b=32),e>=72&&e<84&&(n>=0&&n<9?b=31:n>=9&&n<21?b=33:n>=21&&n<33?b=35:n>=33&&n<42&&(b=37)),o=(b-1)*6-180+3,_=Z$(o),a=i/(1-i),l=r/Math.sqrt(1-i*Math.sin(g)*Math.sin(g)),c=Math.tan(g)*Math.tan(g),u=a*Math.cos(g)*Math.cos(g),h=Math.cos(g)*(y-_),f=r*((1-i/4-3*i*i/64-5*i*i*i/256)*g-(3*i/8+3*i*i/32+45*i*i*i/1024)*Math.sin(2*g)+(15*i*i/256+45*i*i*i/1024)*Math.sin(4*g)-35*i*i*i/3072*Math.sin(6*g));var T=s*l*(h+(1-c+u)*h*h*h/6+(5-18*c+c*c+72*u-58*a)*h*h*h*h*h/120)+5e5,A=s*(f+l*Math.tan(g)*(h*h/2+(5-c+9*u+4*u*u)*h*h*h*h/24+(61-58*c+c*c+600*u-330*a)*h*h*h*h*h*h/720));return e<0&&(A+=1e7),{northing:Math.round(A),easting:Math.round(T),zoneNumber:b,zoneLetter:Hdt(e)}}function tq(t){var e=t.northing,n=t.easting,r=t.zoneLetter,i=t.zoneNumber;if(i<0||i>60)return null;var s=.9996,o=6378137,a=.00669438,l,c=(1-Math.sqrt(1-a))/(1+Math.sqrt(1-a)),u,h,f,g,y,_,b,T,A,I=n-5e5,P=e;r<"N"&&(P-=1e7),b=(i-1)*6-180+3,l=a/(1-a),_=P/s,T=_/(o*(1-a/4-3*a*a/64-5*a*a*a/256)),A=T+(3*c/2-27*c*c*c/32)*Math.sin(2*T)+(21*c*c/16-55*c*c*c*c/32)*Math.sin(4*T)+151*c*c*c/96*Math.sin(6*T),u=o/Math.sqrt(1-a*Math.sin(A)*Math.sin(A)),h=Math.tan(A)*Math.tan(A),f=l*Math.cos(A)*Math.cos(A),g=o*(1-a)/Math.pow(1-a*Math.sin(A)*Math.sin(A),1.5),y=I/(u*s);var R=A-u*Math.tan(A)/g*(y*y/2-(5+3*h+10*f-4*f*f-9*l)*y*y*y*y/24+(61+90*h+298*f+45*h*h-252*l-3*f*f)*y*y*y*y*y*y/720);R=poe(R);var D=(y-(1+2*h+f)*y*y*y/6+(5-2*f+28*h-3*f*f+8*l+24*h*h)*y*y*y*y*y/120)/Math.cos(A);D=b+poe(D);var C;if(t.accuracy){var M=tq({northing:t.northing+t.accuracy,easting:t.easting+t.accuracy,zoneLetter:t.zoneLetter,zoneNumber:t.zoneNumber});C={top:M.lat,right:M.lon,bottom:R,left:D}}else C={lat:R,lon:D};return C}function Hdt(t){var e="Z";return 84>=t&&t>=72?e="X":72>t&&t>=64?e="W":64>t&&t>=56?e="V":56>t&&t>=48?e="U":48>t&&t>=40?e="T":40>t&&t>=32?e="S":32>t&&t>=24?e="R":24>t&&t>=16?e="Q":16>t&&t>=8?e="P":8>t&&t>=0?e="N":0>t&&t>=-8?e="M":-8>t&&t>=-16?e="L":-16>t&&t>=-24?e="K":-24>t&&t>=-32?e="J":-32>t&&t>=-40?e="H":-40>t&&t>=-48?e="G":-48>t&&t>=-56?e="F":-56>t&&t>=-64?e="E":-64>t&&t>=-72?e="D":-72>t&&t>=-80&&(e="C"),e}function qdt(t,e){var n="00000"+t.easting,r="00000"+t.northing;return t.zoneNumber+t.zoneLetter+Kdt(t.easting,t.northing,t.zoneNumber)+n.substr(n.length-5,e)+r.substr(r.length-5,e)}function Kdt(t,e,n){var r=G2e(n),i=Math.floor(t/1e5),s=Math.floor(e/1e5)%20;return Ydt(i,s,r)}function G2e(t){var e=t%foe;return e===0&&(e=foe),e}function Ydt(t,e,n){var r=n-1,i=$2e.charCodeAt(r),s=F2e.charCodeAt(r),o=i+t-1,a=s+e,l=!1;o>KS&&(o=o-KS+Gx-1,l=!0),(o===rl||i<rl&&o>rl||(o>rl||i<rl)&&l)&&o++,(o===Wc||i<Wc&&o>Wc||(o>Wc||i<Wc)&&l)&&(o++,o===rl&&o++),o>KS&&(o=o-KS+Gx-1),a>qS?(a=a-qS+Gx-1,l=!0):l=!1,(a===rl||s<rl&&a>rl||(a>rl||s<rl)&&l)&&a++,(a===Wc||s<Wc&&a>Wc||(a>Wc||s<Wc)&&l)&&(a++,a===rl&&a++),a>qS&&(a=a-qS+Gx-1);var c=String.fromCharCode(o)+String.fromCharCode(a);return c}function U2e(t){if(t&&t.length===0)throw"MGRSPoint coverting from nothing";for(var e=t.length,n=null,r="",i,s=0;!/[A-Z]/.test(i=t.charAt(s));){if(s>=2)throw"MGRSPoint bad conversion from: "+t;r+=i,s++}var o=parseInt(r,10);if(s===0||s+3>e)throw"MGRSPoint bad conversion from: "+t;var a=t.charAt(s++);if(a<="A"||a==="B"||a==="Y"||a>="Z"||a==="I"||a==="O")throw"MGRSPoint zone letter "+a+" not handled: "+t;n=t.substring(s,s+=2);for(var l=G2e(o),c=Xdt(n.charAt(0),l),u=Zdt(n.charAt(1),l);u<Jdt(a);)u+=2e6;var h=e-s;if(h%2!==0)throw`MGRSPoint has to have an even number 
of digits after the zone letter and two 100km letters - front 
half for easting meters, second half for 
northing meters`+t;var f=h/2,g=0,y=0,_,b,T,A,I;return f>0&&(_=1e5/Math.pow(10,f),b=t.substring(s,s+f),g=parseFloat(b)*_,T=t.substring(s+f),y=parseFloat(T)*_),A=g+c,I=y+u,{easting:A,northing:I,zoneLetter:a,zoneNumber:o,accuracy:_}}function Xdt(t,e){for(var n=$2e.charCodeAt(e-1),r=1e5,i=!1;n!==t.charCodeAt(0);){if(n++,n===rl&&n++,n===Wc&&n++,n>KS){if(i)throw"Bad character: "+t;n=Gx,i=!0}r+=1e5}return r}function Zdt(t,e){if(t>"V")throw"MGRSPoint given invalid Northing "+t;for(var n=F2e.charCodeAt(e-1),r=0,i=!1;n!==t.charCodeAt(0);){if(n++,n===rl&&n++,n===Wc&&n++,n>qS){if(i)throw"Bad character: "+t;n=Gx,i=!0}r+=1e5}return r}function Jdt(t){var e;switch(t){case"C":e=11e5;break;case"D":e=2e6;break;case"E":e=28e5;break;case"F":e=37e5;break;case"G":e=46e5;break;case"H":e=55e5;break;case"J":e=64e5;break;case"K":e=73e5;break;case"L":e=82e5;break;case"M":e=91e5;break;case"N":e=0;break;case"P":e=8e5;break;case"Q":e=17e5;break;case"R":e=26e5;break;case"S":e=35e5;break;case"T":e=44e5;break;case"U":e=53e5;break;case"V":e=62e5;break;case"W":e=7e6;break;case"X":e=79e5;break;default:e=-1}if(e>=0)return e;throw"Invalid zone letter: "+t}function z2(t,e,n){if(!(this instanceof z2))return new z2(t,e,n);if(Array.isArray(t))this.x=t[0],this.y=t[1],this.z=t[2]||0;else if(typeof t=="object")this.x=t.x,this.y=t.y,this.z=t.z||0;else if(typeof t=="string"&&typeof e>"u"){var r=t.split(",");this.x=parseFloat(r[0]),this.y=parseFloat(r[1]),this.z=parseFloat(r[2])||0}else this.x=t,this.y=e,this.z=n||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}z2.fromMGRS=function(t){return new z2(z2e(t))};z2.prototype.toMGRS=function(t){return V2e([this.x,this.y],t)};var Qdt=1,eft=.25,moe=.046875,goe=.01953125,yoe=.01068115234375,tft=.75,nft=.46875,rft=.013020833333333334,ift=.007120768229166667,sft=.3645833333333333,oft=.005696614583333333,aft=.3076171875;function nq(t){var e=[];e[0]=Qdt-t*(eft+t*(moe+t*(goe+t*yoe))),e[1]=t*(tft-t*(moe+t*(goe+t*yoe)));var n=t*t;return e[2]=n*(nft-t*(rft+t*ift)),n*=t,e[3]=n*(sft-t*oft),e[4]=n*t*aft,e}function kb(t,e,n,r){return n*=e,e*=e,r[0]*t-n*(r[1]+e*(r[2]+e*(r[3]+e*r[4])))}var lft=20;function rq(t,e,n){for(var r=1/(1-e),i=t,s=lft;s;--s){var o=Math.sin(i),a=1-e*o*o;if(a=(kb(i,o,Math.cos(i),n)-t)*(a*Math.sqrt(a))*r,i-=a,Math.abs(a)<wt)return i}return i}function cft(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.es&&(this.en=nq(this.es),this.ml0=kb(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))}function uft(t){var e=t.x,n=t.y,r=Pt(e-this.long0,this.over),i,s,o,a=Math.sin(n),l=Math.cos(n);if(this.es){var u=l*r,h=Math.pow(u,2),f=this.ep2*Math.pow(l,2),g=Math.pow(f,2),y=Math.abs(l)>wt?Math.tan(n):0,_=Math.pow(y,2),b=Math.pow(_,2);i=1-this.es*Math.pow(a,2),u=u/Math.sqrt(i);var T=kb(n,a,l,this.en);s=this.a*(this.k0*u*(1+h/6*(1-_+f+h/20*(5-18*_+b+14*f-58*_*f+h/42*(61+179*b-b*_-479*_)))))+this.x0,o=this.a*(this.k0*(T-this.ml0+a*r*u/2*(1+h/12*(5-_+9*f+4*g+h/30*(61+b-58*_+270*f-330*_*f+h/56*(1385+543*b-b*_-3111*_))))))+this.y0}else{var c=l*Math.sin(r);if(Math.abs(Math.abs(c)-1)<wt)return 93;if(s=.5*this.a*this.k0*Math.log((1+c)/(1-c))+this.x0,o=l*Math.cos(r)/Math.sqrt(1-Math.pow(c,2)),c=Math.abs(o),c>=1){if(c-1>wt)return 93;o=0}else o=Math.acos(o);n<0&&(o=-o),o=this.a*this.k0*(o-this.lat0)+this.y0}return t.x=s,t.y=o,t}function hft(t){var e,n,r,i,s=(t.x-this.x0)*(1/this.a),o=(t.y-this.y0)*(1/this.a);if(this.es)if(e=this.ml0+o/this.k0,n=rq(e,this.es,this.en),Math.abs(n)<st){var h=Math.sin(n),f=Math.cos(n),g=Math.abs(f)>wt?Math.tan(n):0,y=this.ep2*Math.pow(f,2),_=Math.pow(y,2),b=Math.pow(g,2),T=Math.pow(b,2);e=1-this.es*Math.pow(h,2);var A=s*Math.sqrt(e)/this.k0,I=Math.pow(A,2);e=e*g,r=n-e*I/(1-this.es)*.5*(1-I/12*(5+3*b-9*y*b+y-4*_-I/30*(61+90*b-252*y*b+45*T+46*y-I/56*(1385+3633*b+4095*T+1574*T*b)))),i=Pt(this.long0+A*(1-I/6*(1+2*b+y-I/20*(5+28*b+24*T+8*y*b+6*y-I/42*(61+662*b+1320*T+720*T*b))))/f,this.over)}else r=st*HI(o),i=0;else{var a=Math.exp(s/this.k0),l=.5*(a-1/a),c=this.lat0+o/this.k0,u=Math.cos(c);e=Math.sqrt((1-Math.pow(u,2))/(1+Math.pow(l,2))),r=Math.asin(e),o<0&&(r=-r),l===0&&u===0?i=0:i=Pt(Math.atan2(l,u)+this.long0,this.over)}return t.x=i,t.y=r,t}var dft=["Fast_Transverse_Mercator","Fast Transverse Mercator"];const E3={init:cft,forward:uft,inverse:hft,names:dft};function B2e(t){var e=Math.exp(t);return e=(e-1/e)/2,e}function vl(t,e){t=Math.abs(t),e=Math.abs(e);var n=Math.max(t,e),r=Math.min(t,e)/(n||1);return n*Math.sqrt(1+Math.pow(r,2))}function fft(t){var e=1+t,n=e-1;return n===0?t:t*Math.log(e)/n}function pft(t){var e=Math.abs(t);return e=fft(e*(1+e/(vl(1,e)+1))),t<0?-e:e}function iq(t,e){for(var n=2*Math.cos(2*e),r=t.length-1,i=t[r],s=0,o;--r>=0;)o=-s+n*i+t[r],s=i,i=o;return e+o*Math.sin(2*e)}function mft(t,e){for(var n=2*Math.cos(e),r=t.length-1,i=t[r],s=0,o;--r>=0;)o=-s+n*i+t[r],s=i,i=o;return Math.sin(e)*o}function gft(t){var e=Math.exp(t);return e=(e+1/e)/2,e}function W2e(t,e,n){for(var r=Math.sin(e),i=Math.cos(e),s=B2e(n),o=gft(n),a=2*i*o,l=-2*r*s,c=t.length-1,u=t[c],h=0,f=0,g=0,y,_;--c>=0;)y=f,_=h,f=u,h=g,u=-y+a*f-l*h+t[c],g=-_+l*f+a*h;return a=r*o,l=i*s,[a*u-l*g,a*g+l*u]}function yft(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(E3.init.apply(this),this.forward=E3.forward,this.inverse=E3.inverse),this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var t=this.es/(1+Math.sqrt(1-this.es)),e=t/(2-t),n=e;this.cgb[0]=e*(2+e*(-2/3+e*(-2+e*(116/45+e*(26/45+e*(-2854/675)))))),this.cbg[0]=e*(-2+e*(2/3+e*(4/3+e*(-82/45+e*(32/45+e*(4642/4725)))))),n=n*e,this.cgb[1]=n*(7/3+e*(-8/5+e*(-227/45+e*(2704/315+e*(2323/945))))),this.cbg[1]=n*(5/3+e*(-16/15+e*(-13/9+e*(904/315+e*(-1522/945))))),n=n*e,this.cgb[2]=n*(56/15+e*(-136/35+e*(-1262/105+e*(73814/2835)))),this.cbg[2]=n*(-26/15+e*(34/21+e*(8/5+e*(-12686/2835)))),n=n*e,this.cgb[3]=n*(4279/630+e*(-332/35+e*(-399572/14175))),this.cbg[3]=n*(1237/630+e*(-12/5+e*(-24832/14175))),n=n*e,this.cgb[4]=n*(4174/315+e*(-144838/6237)),this.cbg[4]=n*(-734/315+e*(109598/31185)),n=n*e,this.cgb[5]=n*(601676/22275),this.cbg[5]=n*(444337/155925),n=Math.pow(e,2),this.Qn=this.k0/(1+e)*(1+n*(1/4+n*(1/64+n/256))),this.utg[0]=e*(-.5+e*(2/3+e*(-37/96+e*(1/360+e*(81/512+e*(-96199/604800)))))),this.gtu[0]=e*(.5+e*(-2/3+e*(5/16+e*(41/180+e*(-127/288+e*(7891/37800)))))),this.utg[1]=n*(-1/48+e*(-1/15+e*(437/1440+e*(-46/105+e*(1118711/3870720))))),this.gtu[1]=n*(13/48+e*(-3/5+e*(557/1440+e*(281/630+e*(-1983433/1935360))))),n=n*e,this.utg[2]=n*(-17/480+e*(37/840+e*(209/4480+e*(-5569/90720)))),this.gtu[2]=n*(61/240+e*(-103/140+e*(15061/26880+e*(167603/181440)))),n=n*e,this.utg[3]=n*(-4397/161280+e*(11/504+e*(830251/7257600))),this.gtu[3]=n*(49561/161280+e*(-179/168+e*(6601661/7257600))),n=n*e,this.utg[4]=n*(-4583/161280+e*(108847/3991680)),this.gtu[4]=n*(34729/80640+e*(-3418889/1995840)),n=n*e,this.utg[5]=n*(-20648693/638668800),this.gtu[5]=n*(212378941/319334400);var r=iq(this.cbg,this.lat0);this.Zb=-this.Qn*(r+mft(this.gtu,2*r))}function vft(t){var e=Pt(t.x-this.long0,this.over),n=t.y;n=iq(this.cbg,n);var r=Math.sin(n),i=Math.cos(n),s=Math.sin(e),o=Math.cos(e);n=Math.atan2(r,o*i),e=Math.atan2(s*i,vl(r,i*o)),e=pft(Math.tan(e));var a=W2e(this.gtu,2*n,2*e);n=n+a[0],e=e+a[1];var l,c;return Math.abs(e)<=2.623395162778?(l=this.a*(this.Qn*e)+this.x0,c=this.a*(this.Qn*n+this.Zb)+this.y0):(l=1/0,c=1/0),t.x=l,t.y=c,t}function _ft(t){var e=(t.x-this.x0)*(1/this.a),n=(t.y-this.y0)*(1/this.a);n=(n-this.Zb)/this.Qn,e=e/this.Qn;var r,i;if(Math.abs(e)<=2.623395162778){var s=W2e(this.utg,2*n,2*e);n=n+s[0],e=e+s[1],e=Math.atan(B2e(e));var o=Math.sin(n),a=Math.cos(n),l=Math.sin(e),c=Math.cos(e);n=Math.atan2(o*c,vl(l,c*a)),e=Math.atan2(l,c*a),r=Pt(e+this.long0,this.over),i=iq(this.cgb,n)}else r=1/0,i=1/0;return t.x=r,t.y=i,t}var xft=["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","Gauss Kruger","Gauss_Kruger","tmerc"];const S3={init:yft,forward:vft,inverse:_ft,names:xft};function wft(t,e){if(t===void 0){if(t=Math.floor((Pt(e)+Math.PI)*30/Math.PI)+1,t<0)return 0;if(t>60)return 60}return t}var bft="etmerc";function Eft(){var t=wft(this.zone,this.long0);if(t===void 0)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(t)-183)*Ki,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,S3.init.apply(this),this.forward=S3.forward,this.inverse=S3.inverse}var Sft=["Universal Transverse Mercator System","utm"];const Tft={init:Eft,names:Sft,dependsOn:bft};function sq(t,e){return Math.pow((1-t)/(1+t),e)}var kft=20;function Aft(){var t=Math.sin(this.lat0),e=Math.cos(this.lat0);e*=e,this.rc=Math.sqrt(1-this.es)/(1-this.es*t*t),this.C=Math.sqrt(1+this.es*e*e/(1-this.es)),this.phic0=Math.asin(t/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+Nr)/(Math.pow(Math.tan(.5*this.lat0+Nr),this.C)*sq(this.e*t,this.ratexp))}function Ift(t){var e=t.x,n=t.y;return t.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*n+Nr),this.C)*sq(this.e*Math.sin(n),this.ratexp))-st,t.x=this.C*e,t}function Pft(t){for(var e=1e-14,n=t.x/this.C,r=t.y,i=Math.pow(Math.tan(.5*r+Nr)/this.K,1/this.C),s=kft;s>0&&(r=2*Math.atan(i*sq(this.e*Math.sin(t.y),-.5*this.e))-st,!(Math.abs(r-t.y)<e));--s)t.y=r;return s?(t.x=n,t.y=r,t):null}const oq={init:Aft,forward:Ift,inverse:Pft};function Cft(){oq.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))}function Rft(t){var e,n,r,i;return t.x=Pt(t.x-this.long0,this.over),oq.forward.apply(this,[t]),e=Math.sin(t.y),n=Math.cos(t.y),r=Math.cos(t.x),i=this.k0*this.R2/(1+this.sinc0*e+this.cosc0*n*r),t.x=i*n*Math.sin(t.x),t.y=i*(this.cosc0*e-this.sinc0*n*r),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t}function Mft(t){var e,n,r,i,s;if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,s=vl(t.x,t.y)){var o=2*Math.atan2(s,this.R2);e=Math.sin(o),n=Math.cos(o),i=Math.asin(n*this.sinc0+t.y*e*this.cosc0/s),r=Math.atan2(t.x*e,s*this.cosc0*n-t.y*this.sinc0*e)}else i=this.phic0,r=0;return t.x=r,t.y=i,oq.inverse.apply(this,[t]),t.x=Pt(t.x+this.long0,this.over),t}var Nft=["Stereographic_North_Pole","Oblique_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"];const Oft={init:Cft,forward:Rft,inverse:Mft,names:Nft};function aq(t,e,n){return e*=n,Math.tan(.5*(st+t))*Math.pow((1-e)/(1+e),.5*n)}function Lft(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=wt&&(this.k0=.5*(1+HI(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=wt&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=wt&&Math.abs(Math.cos(this.lat_ts))>wt&&(this.k0=.5*this.cons*Fd(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/fh(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=Fd(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(aq(this.lat0,this.sinlat0,this.e))-st,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))}function Dft(t){var e=t.x,n=t.y,r=Math.sin(n),i=Math.cos(n),s,o,a,l,c,u,h=Pt(e-this.long0,this.over);return Math.abs(Math.abs(e-this.long0)-Math.PI)<=wt&&Math.abs(n+this.lat0)<=wt?(t.x=NaN,t.y=NaN,t):this.sphere?(s=2*this.k0/(1+this.sinlat0*r+this.coslat0*i*Math.cos(h)),t.x=this.a*s*i*Math.sin(h)+this.x0,t.y=this.a*s*(this.coslat0*r-this.sinlat0*i*Math.cos(h))+this.y0,t):(o=2*Math.atan(aq(n,r,this.e))-st,l=Math.cos(o),a=Math.sin(o),Math.abs(this.coslat0)<=wt?(c=fh(this.e,n*this.con,this.con*r),u=2*this.a*this.k0*c/this.cons,t.x=this.x0+u*Math.sin(e-this.long0),t.y=this.y0-this.con*u*Math.cos(e-this.long0),t):(Math.abs(this.sinlat0)<wt?(s=2*this.a*this.k0/(1+l*Math.cos(h)),t.y=s*a):(s=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*a+this.cosX0*l*Math.cos(h))),t.y=s*(this.cosX0*a-this.sinX0*l*Math.cos(h))+this.y0),t.x=s*l*Math.sin(h)+this.x0,t))}function jft(t){t.x-=this.x0,t.y-=this.y0;var e,n,r,i,s,o=Math.sqrt(t.x*t.x+t.y*t.y);if(this.sphere){var a=2*Math.atan(o/(2*this.a*this.k0));return e=this.long0,n=this.lat0,o<=wt?(t.x=e,t.y=n,t):(n=Math.asin(Math.cos(a)*this.sinlat0+t.y*Math.sin(a)*this.coslat0/o),Math.abs(this.coslat0)<wt?this.lat0>0?e=Pt(this.long0+Math.atan2(t.x,-1*t.y),this.over):e=Pt(this.long0+Math.atan2(t.x,t.y),this.over):e=Pt(this.long0+Math.atan2(t.x*Math.sin(a),o*this.coslat0*Math.cos(a)-t.y*this.sinlat0*Math.sin(a)),this.over),t.x=e,t.y=n,t)}else if(Math.abs(this.coslat0)<=wt){if(o<=wt)return n=this.lat0,e=this.long0,t.x=e,t.y=n,t;t.x*=this.con,t.y*=this.con,r=o*this.cons/(2*this.a*this.k0),n=this.con*bA(this.e,r),e=this.con*Pt(this.con*this.long0+Math.atan2(t.x,-1*t.y),this.over)}else i=2*Math.atan(o*this.cosX0/(2*this.a*this.k0*this.ms1)),e=this.long0,o<=wt?s=this.X0:(s=Math.asin(Math.cos(i)*this.sinX0+t.y*Math.sin(i)*this.cosX0/o),e=Pt(this.long0+Math.atan2(t.x*Math.sin(i),o*this.cosX0*Math.cos(i)-t.y*this.sinX0*Math.sin(i)),this.over)),n=-1*bA(this.e,Math.tan(.5*(st+s)));return t.x=e,t.y=n,t}var $ft=["stere","Stereographic_South_Pole","Polar_Stereographic_variant_A","Polar_Stereographic_variant_B","Polar_Stereographic"];const Fft={init:Lft,forward:Dft,inverse:jft,names:$ft,ssfn_:aq};function Vft(){var t=this.lat0;this.lambda0=this.long0;var e=Math.sin(t),n=this.a,r=this.rf,i=1/r,s=2*i-Math.pow(i,2),o=this.e=Math.sqrt(s);this.R=this.k0*n*Math.sqrt(1-s)/(1-s*Math.pow(e,2)),this.alpha=Math.sqrt(1+s/(1-s)*Math.pow(Math.cos(t),4)),this.b0=Math.asin(e/this.alpha);var a=Math.log(Math.tan(Math.PI/4+this.b0/2)),l=Math.log(Math.tan(Math.PI/4+t/2)),c=Math.log((1+o*e)/(1-o*e));this.K=a-this.alpha*l+this.alpha*o/2*c}function zft(t){var e=Math.log(Math.tan(Math.PI/4-t.y/2)),n=this.e/2*Math.log((1+this.e*Math.sin(t.y))/(1-this.e*Math.sin(t.y))),r=-this.alpha*(e+n)+this.K,i=2*(Math.atan(Math.exp(r))-Math.PI/4),s=this.alpha*(t.x-this.lambda0),o=Math.atan(Math.sin(s)/(Math.sin(this.b0)*Math.tan(i)+Math.cos(this.b0)*Math.cos(s))),a=Math.asin(Math.cos(this.b0)*Math.sin(i)-Math.sin(this.b0)*Math.cos(i)*Math.cos(s));return t.y=this.R/2*Math.log((1+Math.sin(a))/(1-Math.sin(a)))+this.y0,t.x=this.R*o+this.x0,t}function Gft(t){for(var e=t.x-this.x0,n=t.y-this.y0,r=e/this.R,i=2*(Math.atan(Math.exp(n/this.R))-Math.PI/4),s=Math.asin(Math.cos(this.b0)*Math.sin(i)+Math.sin(this.b0)*Math.cos(i)*Math.cos(r)),o=Math.atan(Math.sin(r)/(Math.cos(this.b0)*Math.cos(r)-Math.sin(this.b0)*Math.tan(i))),a=this.lambda0+o/this.alpha,l=0,c=s,u=-1e3,h=0;Math.abs(c-u)>1e-7;){if(++h>20)return;l=1/this.alpha*(Math.log(Math.tan(Math.PI/4+s/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(c))/2)),u=c,c=2*Math.atan(Math.exp(l))-Math.PI/2}return t.x=a,t.y=c,t}var Uft=["somerc"];const Bft={init:Vft,forward:zft,inverse:Gft,names:Uft};var vx=1e-7;function Wft(t){var e=["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_variant_A","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"],n=typeof t.projName=="object"?Object.keys(t.projName)[0]:t.projName;return"no_uoff"in t||"no_off"in t||e.indexOf(n)!==-1||e.indexOf(N2e(n))!==-1}function Hft(){var t,e,n,r,i,s,o,a,l,c,u=0,h,f=0,g=0,y=0,_=0,b=0,T=0;this.no_off=Wft(this),this.no_rot="no_rot"in this;var A=!1;"alpha"in this&&(A=!0);var I=!1;if("rectified_grid_angle"in this&&(I=!0),A&&(T=this.alpha),I&&(u=this.rectified_grid_angle),A||I)f=this.longc;else if(g=this.long1,_=this.lat1,y=this.long2,b=this.lat2,Math.abs(_-b)<=vx||(t=Math.abs(_))<=vx||Math.abs(t-st)<=vx||Math.abs(Math.abs(this.lat0)-st)<=vx||Math.abs(Math.abs(b)-st)<=vx)throw new Error;var P=1-this.es;e=Math.sqrt(P),Math.abs(this.lat0)>wt?(a=Math.sin(this.lat0),n=Math.cos(this.lat0),t=1-this.es*a*a,this.B=n*n,this.B=Math.sqrt(1+this.es*this.B*this.B/P),this.A=this.B*this.k0*e/t,r=this.B*e/(n*Math.sqrt(t)),i=r*r-1,i<=0?i=0:(i=Math.sqrt(i),this.lat0<0&&(i=-i)),this.E=i+=r,this.E*=Math.pow(fh(this.e,this.lat0,a),this.B)):(this.B=1/e,this.A=this.k0,this.E=r=i=1),A||I?(A?(h=Math.asin(Math.sin(T)/r),I||(u=T)):(h=u,T=Math.asin(r*Math.sin(h))),this.lam0=f-Math.asin(.5*(i-1/i)*Math.tan(h))/this.B):(s=Math.pow(fh(this.e,_,Math.sin(_)),this.B),o=Math.pow(fh(this.e,b,Math.sin(b)),this.B),i=this.E/s,l=(o-s)/(o+s),c=this.E*this.E,c=(c-o*s)/(c+o*s),t=g-y,t<-Math.PI?y-=xA:t>Math.PI&&(y+=xA),this.lam0=Pt(.5*(g+y)-Math.atan(c*Math.tan(.5*this.B*(g-y))/l)/this.B,this.over),h=Math.atan(2*Math.sin(this.B*Pt(g-this.lam0,this.over))/(i-1/i)),u=T=Math.asin(r*Math.sin(h))),this.singam=Math.sin(h),this.cosgam=Math.cos(h),this.sinrot=Math.sin(u),this.cosrot=Math.cos(u),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(r*r-1)/Math.cos(T))),this.lat0<0&&(this.u_0=-this.u_0)),i=.5*h,this.v_pole_n=this.ArB*Math.log(Math.tan(Nr-i)),this.v_pole_s=this.ArB*Math.log(Math.tan(Nr+i))}function qft(t){var e={},n,r,i,s,o,a,l,c;if(t.x=t.x-this.lam0,Math.abs(Math.abs(t.y)-st)>wt){if(o=this.E/Math.pow(fh(this.e,t.y,Math.sin(t.y)),this.B),a=1/o,n=.5*(o-a),r=.5*(o+a),s=Math.sin(this.B*t.x),i=(n*this.singam-s*this.cosgam)/r,Math.abs(Math.abs(i)-1)<wt)throw new Error;c=.5*this.ArB*Math.log((1-i)/(1+i)),a=Math.cos(this.B*t.x),Math.abs(a)<vx?l=this.A*t.x:l=this.ArB*Math.atan2(n*this.cosgam+s*this.singam,a)}else c=t.y>0?this.v_pole_n:this.v_pole_s,l=this.ArB*t.y;return this.no_rot?(e.x=l,e.y=c):(l-=this.u_0,e.x=c*this.cosrot+l*this.sinrot,e.y=l*this.cosrot-c*this.sinrot),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e}function Kft(t){var e,n,r,i,s,o,a,l={};if(t.x=(t.x-this.x0)*(1/this.a),t.y=(t.y-this.y0)*(1/this.a),this.no_rot?(n=t.y,e=t.x):(n=t.x*this.cosrot-t.y*this.sinrot,e=t.y*this.cosrot+t.x*this.sinrot+this.u_0),r=Math.exp(-this.BrA*n),i=.5*(r-1/r),s=.5*(r+1/r),o=Math.sin(this.BrA*e),a=(o*this.cosgam+i*this.singam)/s,Math.abs(Math.abs(a)-1)<wt)l.x=0,l.y=a<0?-st:st;else{if(l.y=this.E/Math.sqrt((1+a)/(1-a)),l.y=bA(this.e,Math.pow(l.y,1/this.B)),l.y===1/0)throw new Error;l.x=-this.rB*Math.atan2(i*this.cosgam-o*this.singam,Math.cos(this.BrA*e))}return l.x+=this.lam0,l}var Yft=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_variant_A","Hotine_Oblique_Mercator_Variant_B","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"];const Xft={init:Hft,forward:qft,inverse:Kft,names:Yft};function Zft(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<wt)){var t=this.b/this.a;this.e=Math.sqrt(1-t*t);var e=Math.sin(this.lat1),n=Math.cos(this.lat1),r=Fd(this.e,e,n),i=fh(this.e,this.lat1,e),s=Math.sin(this.lat2),o=Math.cos(this.lat2),a=Fd(this.e,s,o),l=fh(this.e,this.lat2,s),c=Math.abs(Math.abs(this.lat0)-st)<wt?0:fh(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>wt?this.ns=Math.log(r/a)/Math.log(i/l):this.ns=e,isNaN(this.ns)&&(this.ns=e),this.f0=r/(this.ns*Math.pow(i,this.ns)),this.rh=this.a*this.f0*Math.pow(c,this.ns),this.title||(this.title="Lambert Conformal Conic")}}function Jft(t){var e=t.x,n=t.y;Math.abs(2*Math.abs(n)-Math.PI)<=wt&&(n=HI(n)*(st-2*wt));var r=Math.abs(Math.abs(n)-st),i,s;if(r>wt)i=fh(this.e,n,Math.sin(n)),s=this.a*this.f0*Math.pow(i,this.ns);else{if(r=n*this.ns,r<=0)return null;s=0}var o=this.ns*Pt(e-this.long0,this.over);return t.x=this.k0*(s*Math.sin(o))+this.x0,t.y=this.k0*(this.rh-s*Math.cos(o))+this.y0,t}function Qft(t){var e,n,r,i,s,o=(t.x-this.x0)/this.k0,a=this.rh-(t.y-this.y0)/this.k0;this.ns>0?(e=Math.sqrt(o*o+a*a),n=1):(e=-Math.sqrt(o*o+a*a),n=-1);var l=0;if(e!==0&&(l=Math.atan2(n*o,n*a)),e!==0||this.ns>0){if(n=1/this.ns,r=Math.pow(e/(this.a*this.f0),n),i=bA(this.e,r),i===-9999)return null}else i=-st;return s=Pt(l/this.ns+this.long0,this.over),t.x=s,t.y=i,t}var ept=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"];const tpt={init:Zft,forward:Jft,inverse:Qft,names:ept};function npt(){this.a=6377397155e-3,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.7417649320975901-.308341501185665),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq}function rpt(t){var e,n,r,i,s,o,a,l=t.x,c=t.y,u=Pt(l-this.long0,this.over);return e=Math.pow((1+this.e*Math.sin(c))/(1-this.e*Math.sin(c)),this.alfa*this.e/2),n=2*(Math.atan(this.k*Math.pow(Math.tan(c/2+this.s45),this.alfa)/e)-this.s45),r=-u*this.alfa,i=Math.asin(Math.cos(this.ad)*Math.sin(n)+Math.sin(this.ad)*Math.cos(n)*Math.cos(r)),s=Math.asin(Math.cos(n)*Math.sin(r)/Math.cos(i)),o=this.n*s,a=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(i/2+this.s45),this.n),t.y=a*Math.cos(o)/1,t.x=a*Math.sin(o)/1,this.czech||(t.y*=-1,t.x*=-1),t}function ipt(t){var e,n,r,i,s,o,a,l,c=t.x;t.x=t.y,t.y=c,this.czech||(t.y*=-1,t.x*=-1),o=Math.sqrt(t.x*t.x+t.y*t.y),s=Math.atan2(t.y,t.x),i=s/Math.sin(this.s0),r=2*(Math.atan(Math.pow(this.ro0/o,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),e=Math.asin(Math.cos(this.ad)*Math.sin(r)-Math.sin(this.ad)*Math.cos(r)*Math.cos(i)),n=Math.asin(Math.cos(r)*Math.sin(i)/Math.cos(e)),t.x=this.long0-n/this.alfa,a=e,l=0;var u=0;do t.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(e/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(a))/(1-this.e*Math.sin(a)),this.e/2))-this.s45),Math.abs(a-t.y)<1e-10&&(l=1),a=t.y,u+=1;while(l===0&&u<15);return u>=15?null:t}var spt=["Krovak","krovak"];const opt={init:npt,forward:rpt,inverse:ipt,names:spt};function Fa(t,e,n,r,i){return t*i-e*Math.sin(2*i)+n*Math.sin(4*i)-r*Math.sin(6*i)}function qI(t){return 1-.25*t*(1+t/16*(3+1.25*t))}function KI(t){return .375*t*(1+.25*t*(1+.46875*t))}function YI(t){return .05859375*t*t*(1+.75*t)}function XI(t){return t*t*t*(35/3072)}function lq(t,e,n){var r=e*n;return t/Math.sqrt(1-r*r)}function u0(t){return Math.abs(t)<st?t:t-HI(t)*Math.PI}function qN(t,e,n,r,i){var s,o;s=t/e;for(var a=0;a<15;a++)if(o=(t-(e*s-n*Math.sin(2*s)+r*Math.sin(4*s)-i*Math.sin(6*s)))/(e-2*n*Math.cos(2*s)+4*r*Math.cos(4*s)-6*i*Math.cos(6*s)),s+=o,Math.abs(o)<=1e-10)return s;return NaN}function apt(){this.sphere||(this.e0=qI(this.es),this.e1=KI(this.es),this.e2=YI(this.es),this.e3=XI(this.es),this.ml0=this.a*Fa(this.e0,this.e1,this.e2,this.e3,this.lat0))}function lpt(t){var e,n,r=t.x,i=t.y;if(r=Pt(r-this.long0,this.over),this.sphere)e=this.a*Math.asin(Math.cos(i)*Math.sin(r)),n=this.a*(Math.atan2(Math.tan(i),Math.cos(r))-this.lat0);else{var s=Math.sin(i),o=Math.cos(i),a=lq(this.a,this.e,s),l=Math.tan(i)*Math.tan(i),c=r*Math.cos(i),u=c*c,h=this.es*o*o/(1-this.es),f=this.a*Fa(this.e0,this.e1,this.e2,this.e3,i);e=a*c*(1-u*l*(1/6-(8-l+8*h)*u/120)),n=f-this.ml0+a*s/o*u*(.5+(5-l+6*h)*u/24)}return t.x=e+this.x0,t.y=n+this.y0,t}function cpt(t){t.x-=this.x0,t.y-=this.y0;var e=t.x/this.a,n=t.y/this.a,r,i;if(this.sphere){var s=n+this.lat0;r=Math.asin(Math.sin(s)*Math.cos(e)),i=Math.atan2(Math.tan(e),Math.cos(s))}else{var o=this.ml0/this.a+n,a=qN(o,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(a)-st)<=wt)return t.x=this.long0,t.y=st,n<0&&(t.y*=-1),t;var l=lq(this.a,this.e,Math.sin(a)),c=l*l*l/this.a/this.a*(1-this.es),u=Math.pow(Math.tan(a),2),h=e*this.a/l,f=h*h;r=a-l*Math.tan(a)/c*h*h*(.5-(1+3*u)*h*h/24),i=h*(1-f*(u/3+(1+3*u)*u*f/15))/Math.cos(a)}return t.x=Pt(i+this.long0,this.over),t.y=u0(r),t}var upt=["Cassini","Cassini_Soldner","cass"];const hpt={init:apt,forward:lpt,inverse:cpt,names:upt};function kg(t,e){var n;return t>1e-7?(n=t*e,(1-t*t)*(e/(1-n*n)-.5/t*Math.log((1-n)/(1+n)))):2*e}var kz=1,Az=2,Iz=3,T3=4;function dpt(){var t=Math.abs(this.lat0);if(Math.abs(t-st)<wt?this.mode=this.lat0<0?kz:Az:Math.abs(t)<wt?this.mode=Iz:this.mode=T3,this.es>0){var e;switch(this.qp=kg(this.e,1),this.mmf=.5/(1-this.es),this.apa=wpt(this.es),this.mode){case Az:this.dd=1;break;case kz:this.dd=1;break;case Iz:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case T3:this.rq=Math.sqrt(.5*this.qp),e=Math.sin(this.lat0),this.sinb1=kg(this.e,e)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*e*e)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd;break}}else this.mode===T3&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))}function fpt(t){var e,n,r,i,s,o,a,l,c,u,h=t.x,f=t.y;if(h=Pt(h-this.long0,this.over),this.sphere){if(s=Math.sin(f),u=Math.cos(f),r=Math.cos(h),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(n=this.mode===this.EQUIT?1+u*r:1+this.sinph0*s+this.cosph0*u*r,n<=wt)return null;n=Math.sqrt(2/n),e=n*u*Math.sin(h),n*=this.mode===this.EQUIT?s:this.cosph0*s-this.sinph0*u*r}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(r=-r),Math.abs(f+this.lat0)<wt)return null;n=Nr-f*.5,n=2*(this.mode===this.S_POLE?Math.cos(n):Math.sin(n)),e=n*Math.sin(h),n*=r}}else{switch(a=0,l=0,c=0,r=Math.cos(h),i=Math.sin(h),s=Math.sin(f),o=kg(this.e,s),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(a=o/this.qp,l=Math.sqrt(1-a*a)),this.mode){case this.OBLIQ:c=1+this.sinb1*a+this.cosb1*l*r;break;case this.EQUIT:c=1+l*r;break;case this.N_POLE:c=st+f,o=this.qp-o;break;case this.S_POLE:c=f-st,o=this.qp+o;break}if(Math.abs(c)<wt)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:c=Math.sqrt(2/c),this.mode===this.OBLIQ?n=this.ymf*c*(this.cosb1*a-this.sinb1*l*r):n=(c=Math.sqrt(2/(1+l*r)))*a*this.ymf,e=this.xmf*c*l*i;break;case this.N_POLE:case this.S_POLE:o>=0?(e=(c=Math.sqrt(o))*i,n=r*(this.mode===this.S_POLE?c:-c)):e=n=0;break}}return t.x=this.a*e+this.x0,t.y=this.a*n+this.y0,t}function ppt(t){t.x-=this.x0,t.y-=this.y0;var e=t.x/this.a,n=t.y/this.a,r,i,s,o,a,l,c;if(this.sphere){var u=0,h,f=0;if(h=Math.sqrt(e*e+n*n),i=h*.5,i>1)return null;switch(i=2*Math.asin(i),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(f=Math.sin(i),u=Math.cos(i)),this.mode){case this.EQUIT:i=Math.abs(h)<=wt?0:Math.asin(n*f/h),e*=f,n=u*h;break;case this.OBLIQ:i=Math.abs(h)<=wt?this.lat0:Math.asin(u*this.sinph0+n*f*this.cosph0/h),e*=f*this.cosph0,n=(u-Math.sin(i)*this.sinph0)*h;break;case this.N_POLE:n=-n,i=st-i;break;case this.S_POLE:i-=st;break}r=n===0&&(this.mode===this.EQUIT||this.mode===this.OBLIQ)?0:Math.atan2(e,n)}else{if(c=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(e/=this.dd,n*=this.dd,l=Math.sqrt(e*e+n*n),l<wt)return t.x=this.long0,t.y=this.lat0,t;o=2*Math.asin(.5*l/this.rq),s=Math.cos(o),e*=o=Math.sin(o),this.mode===this.OBLIQ?(c=s*this.sinb1+n*o*this.cosb1/l,a=this.qp*c,n=l*this.cosb1*s-n*this.sinb1*o):(c=n*o/l,a=this.qp*c,n=l*s)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(n=-n),a=e*e+n*n,!a)return t.x=this.long0,t.y=this.lat0,t;c=1-a/this.qp,this.mode===this.S_POLE&&(c=-c)}r=Math.atan2(e,n),i=bpt(Math.asin(c),this.apa)}return t.x=Pt(this.long0+r,this.over),t.y=i,t}var mpt=.3333333333333333,gpt=.17222222222222222,ypt=.10257936507936508,vpt=.06388888888888888,_pt=.0664021164021164,xpt=.016415012942191543;function wpt(t){var e,n=[];return n[0]=t*mpt,e=t*t,n[0]+=e*gpt,n[1]=e*vpt,e*=t,n[0]+=e*ypt,n[1]+=e*_pt,n[2]=e*xpt,n}function bpt(t,e){var n=t+t;return t+e[0]*Math.sin(n)+e[1]*Math.sin(n+n)+e[2]*Math.sin(n+n+n)}var Ept=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"];const Spt={init:dpt,forward:fpt,inverse:ppt,names:Ept,S_POLE:kz,N_POLE:Az,EQUIT:Iz,OBLIQ:T3};function Xg(t){return Math.abs(t)>1&&(t=t>1?1:-1),Math.asin(t)}function Tpt(){Math.abs(this.lat1+this.lat2)<wt||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=Fd(this.e3,this.sin_po,this.cos_po),this.qs1=kg(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=Fd(this.e3,this.sin_po,this.cos_po),this.qs2=kg(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=kg(this.e3,this.sin_po),Math.abs(this.lat1-this.lat2)>wt?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)}function kpt(t){var e=t.x,n=t.y;this.sin_phi=Math.sin(n),this.cos_phi=Math.cos(n);var r=kg(this.e3,this.sin_phi),i=this.a*Math.sqrt(this.c-this.ns0*r)/this.ns0,s=this.ns0*Pt(e-this.long0,this.over),o=i*Math.sin(s)+this.x0,a=this.rh-i*Math.cos(s)+this.y0;return t.x=o,t.y=a,t}function Apt(t){var e,n,r,i,s,o;return t.x-=this.x0,t.y=this.rh-t.y+this.y0,this.ns0>=0?(e=Math.sqrt(t.x*t.x+t.y*t.y),r=1):(e=-Math.sqrt(t.x*t.x+t.y*t.y),r=-1),i=0,e!==0&&(i=Math.atan2(r*t.x,r*t.y)),r=e*this.ns0/this.a,this.sphere?o=Math.asin((this.c-r*r)/(2*this.ns0)):(n=(this.c-r*r)/this.ns0,o=this.phi1z(this.e3,n)),s=Pt(i/this.ns0+this.long0,this.over),t.x=s,t.y=o,t}function Ipt(t,e){var n,r,i,s,o,a=Xg(.5*e);if(t<wt)return a;for(var l=t*t,c=1;c<=25;c++)if(n=Math.sin(a),r=Math.cos(a),i=t*n,s=1-i*i,o=.5*s*s/r*(e/(1-l)-n/s+.5/t*Math.log((1-i)/(1+i))),a=a+o,Math.abs(o)<=1e-7)return a;return null}var Ppt=["Albers_Conic_Equal_Area","Albers_Equal_Area","Albers","aea"];const Cpt={init:Tpt,forward:kpt,inverse:Apt,names:Ppt,phi1z:Ipt};function Rpt(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1}function Mpt(t){var e,n,r,i,s,o,a,l,c=t.x,u=t.y;return r=Pt(c-this.long0,this.over),e=Math.sin(u),n=Math.cos(u),i=Math.cos(r),o=this.sin_p14*e+this.cos_p14*n*i,s=1,o>0||Math.abs(o)<=wt?(a=this.x0+this.a*s*n*Math.sin(r)/o,l=this.y0+this.a*s*(this.cos_p14*e-this.sin_p14*n*i)/o):(a=this.x0+this.infinity_dist*n*Math.sin(r),l=this.y0+this.infinity_dist*(this.cos_p14*e-this.sin_p14*n*i)),t.x=a,t.y=l,t}function Npt(t){var e,n,r,i,s,o;return t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,(e=Math.sqrt(t.x*t.x+t.y*t.y))?(i=Math.atan2(e,this.rc),n=Math.sin(i),r=Math.cos(i),o=Xg(r*this.sin_p14+t.y*n*this.cos_p14/e),s=Math.atan2(t.x*n,e*this.cos_p14*r-t.y*this.sin_p14*n),s=Pt(this.long0+s,this.over)):(o=this.phic0,s=0),t.x=s,t.y=o,t}var Opt=["gnom"];const Lpt={init:Rpt,forward:Mpt,inverse:Npt,names:Opt};function Dpt(t,e){var n=1-(1-t*t)/(2*t)*Math.log((1-t)/(1+t));if(Math.abs(Math.abs(e)-n)<1e-6)return e<0?-1*st:st;for(var r=Math.asin(.5*e),i,s,o,a,l=0;l<30;l++)if(s=Math.sin(r),o=Math.cos(r),a=t*s,i=Math.pow(1-a*a,2)/(2*o)*(e/(1-t*t)-s/(1-a*a)+.5/t*Math.log((1-a)/(1+a))),r+=i,Math.abs(i)<=1e-10)return r;return NaN}function jpt(){this.sphere||(this.k0=Fd(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))}function $pt(t){var e=t.x,n=t.y,r,i,s=Pt(e-this.long0,this.over);if(this.sphere)r=this.x0+this.a*s*Math.cos(this.lat_ts),i=this.y0+this.a*Math.sin(n)/Math.cos(this.lat_ts);else{var o=kg(this.e,Math.sin(n));r=this.x0+this.a*this.k0*s,i=this.y0+this.a*o*.5/this.k0}return t.x=r,t.y=i,t}function Fpt(t){t.x-=this.x0,t.y-=this.y0;var e,n;return this.sphere?(e=Pt(this.long0+t.x/this.a/Math.cos(this.lat_ts),this.over),n=Math.asin(t.y/this.a*Math.cos(this.lat_ts))):(n=Dpt(this.e,2*t.y*this.k0/this.a),e=Pt(this.long0+t.x/(this.a*this.k0),this.over)),t.x=e,t.y=n,t}var Vpt=["cea"];const zpt={init:jpt,forward:$pt,inverse:Fpt,names:Vpt};function Gpt(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)}function Upt(t){var e=t.x,n=t.y,r=Pt(e-this.long0,this.over),i=u0(n-this.lat0);return t.x=this.x0+this.a*r*this.rc,t.y=this.y0+this.a*i,t}function Bpt(t){var e=t.x,n=t.y;return t.x=Pt(this.long0+(e-this.x0)/(this.a*this.rc),this.over),t.y=u0(this.lat0+(n-this.y0)/this.a),t}var Wpt=["Equirectangular","Equidistant_Cylindrical","Equidistant_Cylindrical_Spherical","eqc"];const Hpt={init:Gpt,forward:Upt,inverse:Bpt,names:Wpt};var voe=20;function qpt(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=qI(this.es),this.e1=KI(this.es),this.e2=YI(this.es),this.e3=XI(this.es),this.ml0=this.a*Fa(this.e0,this.e1,this.e2,this.e3,this.lat0)}function Kpt(t){var e=t.x,n=t.y,r,i,s,o=Pt(e-this.long0,this.over);if(s=o*Math.sin(n),this.sphere)Math.abs(n)<=wt?(r=this.a*o,i=-1*this.a*this.lat0):(r=this.a*Math.sin(s)/Math.tan(n),i=this.a*(u0(n-this.lat0)+(1-Math.cos(s))/Math.tan(n)));else if(Math.abs(n)<=wt)r=this.a*o,i=-1*this.ml0;else{var a=lq(this.a,this.e,Math.sin(n))/Math.tan(n);r=a*Math.sin(s),i=this.a*Fa(this.e0,this.e1,this.e2,this.e3,n)-this.ml0+a*(1-Math.cos(s))}return t.x=r+this.x0,t.y=i+this.y0,t}function Ypt(t){var e,n,r,i,s,o,a,l,c;if(r=t.x-this.x0,i=t.y-this.y0,this.sphere)if(Math.abs(i+this.a*this.lat0)<=wt)e=Pt(r/this.a+this.long0,this.over),n=0;else{o=this.lat0+i/this.a,a=r*r/this.a/this.a+o*o,l=o;var u;for(s=voe;s;--s)if(u=Math.tan(l),c=-1*(o*(l*u+1)-l-.5*(l*l+a)*u)/((l-o)/u-1),l+=c,Math.abs(c)<=wt){n=l;break}e=Pt(this.long0+Math.asin(r*Math.tan(l)/this.a)/Math.sin(n),this.over)}else if(Math.abs(i+this.ml0)<=wt)n=0,e=Pt(this.long0+r/this.a,this.over);else{o=(this.ml0+i)/this.a,a=r*r/this.a/this.a+o*o,l=o;var h,f,g,y,_;for(s=voe;s;--s)if(_=this.e*Math.sin(l),h=Math.sqrt(1-_*_)*Math.tan(l),f=this.a*Fa(this.e0,this.e1,this.e2,this.e3,l),g=this.e0-2*this.e1*Math.cos(2*l)+4*this.e2*Math.cos(4*l)-6*this.e3*Math.cos(6*l),y=f/this.a,c=(o*(h*y+1)-y-.5*h*(y*y+a))/(this.es*Math.sin(2*l)*(y*y+a-2*o*y)/(4*h)+(o-y)*(h*g-2/Math.sin(2*l))-g),l-=c,Math.abs(c)<=wt){n=l;break}h=Math.sqrt(1-this.es*Math.pow(Math.sin(n),2))*Math.tan(n),e=Pt(this.long0+Math.asin(r*h/this.a)/Math.sin(n),this.over)}return t.x=e,t.y=n,t}var Xpt=["Polyconic","American_Polyconic","poly"];const Zpt={init:qpt,forward:Kpt,inverse:Ypt,names:Xpt};function Jpt(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013}function Qpt(t){var e,n=t.x,r=t.y,i=r-this.lat0,s=n-this.long0,o=i/BT*1e-5,a=s,l=1,c=0;for(e=1;e<=10;e++)l=l*o,c=c+this.A[e]*l;var u=c,h=a,f=1,g=0,y,_,b=0,T=0;for(e=1;e<=6;e++)y=f*u-g*h,_=g*u+f*h,f=y,g=_,b=b+this.B_re[e]*f-this.B_im[e]*g,T=T+this.B_im[e]*f+this.B_re[e]*g;return t.x=T*this.a+this.x0,t.y=b*this.a+this.y0,t}function emt(t){var e,n=t.x,r=t.y,i=n-this.x0,s=r-this.y0,o=s/this.a,a=i/this.a,l=1,c=0,u,h,f=0,g=0;for(e=1;e<=6;e++)u=l*o-c*a,h=c*o+l*a,l=u,c=h,f=f+this.C_re[e]*l-this.C_im[e]*c,g=g+this.C_im[e]*l+this.C_re[e]*c;for(var y=0;y<this.iterations;y++){var _=f,b=g,T,A,I=o,P=a;for(e=2;e<=6;e++)T=_*f-b*g,A=b*f+_*g,_=T,b=A,I=I+(e-1)*(this.B_re[e]*_-this.B_im[e]*b),P=P+(e-1)*(this.B_im[e]*_+this.B_re[e]*b);_=1,b=0;var R=this.B_re[1],D=this.B_im[1];for(e=2;e<=6;e++)T=_*f-b*g,A=b*f+_*g,_=T,b=A,R=R+e*(this.B_re[e]*_-this.B_im[e]*b),D=D+e*(this.B_im[e]*_+this.B_re[e]*b);var C=R*R+D*D;f=(I*R+P*D)/C,g=(P*R-I*D)/C}var M=f,O=g,j=1,V=0;for(e=1;e<=9;e++)j=j*M,V=V+this.D[e]*j;var U=this.lat0+V*BT*1e5,G=this.long0+O;return t.x=G,t.y=U,t}var tmt=["New_Zealand_Map_Grid","nzmg"];const nmt={init:Jpt,forward:Qpt,inverse:emt,names:tmt};function rmt(){}function imt(t){var e=t.x,n=t.y,r=Pt(e-this.long0,this.over),i=this.x0+this.a*r,s=this.y0+this.a*Math.log(Math.tan(Math.PI/4+n/2.5))*1.25;return t.x=i,t.y=s,t}function smt(t){t.x-=this.x0,t.y-=this.y0;var e=Pt(this.long0+t.x/this.a,this.over),n=2.5*(Math.atan(Math.exp(.8*t.y/this.a))-Math.PI/4);return t.x=e,t.y=n,t}var omt=["Miller_Cylindrical","mill"];const amt={init:rmt,forward:imt,inverse:smt,names:omt};var lmt=20;function cmt(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=nq(this.es)}function umt(t){var e,n,r=t.x,i=t.y;if(r=Pt(r-this.long0,this.over),this.sphere){if(!this.m)i=this.n!==1?Math.asin(this.n*Math.sin(i)):i;else for(var s=this.n*Math.sin(i),o=lmt;o;--o){var a=(this.m*i+Math.sin(i)-s)/(this.m+Math.cos(i));if(i-=a,Math.abs(a)<wt)break}e=this.a*this.C_x*r*(this.m+Math.cos(i)),n=this.a*this.C_y*i}else{var l=Math.sin(i),c=Math.cos(i);n=this.a*kb(i,l,c,this.en),e=this.a*r*c/Math.sqrt(1-this.es*l*l)}return t.x=e,t.y=n,t}function hmt(t){var e,n,r,i;return t.x-=this.x0,r=t.x/this.a,t.y-=this.y0,e=t.y/this.a,this.sphere?(e/=this.C_y,r=r/(this.C_x*(this.m+Math.cos(e))),this.m?e=Xg((this.m*e+Math.sin(e))/this.n):this.n!==1&&(e=Xg(Math.sin(e)/this.n)),r=Pt(r+this.long0,this.over),e=u0(e)):(e=rq(t.y/this.a,this.es,this.en),i=Math.abs(e),i<st?(i=Math.sin(e),n=this.long0+t.x*Math.sqrt(1-this.es*i*i)/(this.a*Math.cos(e)),r=Pt(n,this.over)):i-wt<st&&(r=this.long0)),t.x=r,t.y=e,t}var dmt=["Sinusoidal","sinu"];const fmt={init:cmt,forward:umt,inverse:hmt,names:dmt};function pmt(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0}function mmt(t){for(var e=t.x,n=t.y,r=Pt(e-this.long0,this.over),i=n,s=Math.PI*Math.sin(n);;){var o=-(i+Math.sin(i)-s)/(1+Math.cos(i));if(i+=o,Math.abs(o)<wt)break}i/=2,Math.PI/2-Math.abs(n)<wt&&(r=0);var a=.900316316158*this.a*r*Math.cos(i)+this.x0,l=1.4142135623731*this.a*Math.sin(i)+this.y0;return t.x=a,t.y=l,t}function gmt(t){var e,n;t.x-=this.x0,t.y-=this.y0,n=t.y/(1.4142135623731*this.a),Math.abs(n)>.999999999999&&(n=.999999999999),e=Math.asin(n);var r=Pt(this.long0+t.x/(.900316316158*this.a*Math.cos(e)),this.over);r<-Math.PI&&(r=-Math.PI),r>Math.PI&&(r=Math.PI),n=(2*e+Math.sin(2*e))/Math.PI,Math.abs(n)>1&&(n=1);var i=Math.asin(n);return t.x=r,t.y=i,t}var ymt=["Mollweide","moll"];const vmt={init:pmt,forward:mmt,inverse:gmt,names:ymt};function _mt(){Math.abs(this.lat1+this.lat2)<wt||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=qI(this.es),this.e1=KI(this.es),this.e2=YI(this.es),this.e3=XI(this.es),this.sin_phi=Math.sin(this.lat1),this.cos_phi=Math.cos(this.lat1),this.ms1=Fd(this.e,this.sin_phi,this.cos_phi),this.ml1=Fa(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<wt?this.ns=this.sin_phi:(this.sin_phi=Math.sin(this.lat2),this.cos_phi=Math.cos(this.lat2),this.ms2=Fd(this.e,this.sin_phi,this.cos_phi),this.ml2=Fa(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=Fa(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))}function xmt(t){var e=t.x,n=t.y,r;if(this.sphere)r=this.a*(this.g-n);else{var i=Fa(this.e0,this.e1,this.e2,this.e3,n);r=this.a*(this.g-i)}var s=this.ns*Pt(e-this.long0,this.over),o=this.x0+r*Math.sin(s),a=this.y0+this.rh-r*Math.cos(s);return t.x=o,t.y=a,t}function wmt(t){t.x-=this.x0,t.y=this.rh-t.y+this.y0;var e,n,r,i;this.ns>=0?(n=Math.sqrt(t.x*t.x+t.y*t.y),e=1):(n=-Math.sqrt(t.x*t.x+t.y*t.y),e=-1);var s=0;if(n!==0&&(s=Math.atan2(e*t.x,e*t.y)),this.sphere)return i=Pt(this.long0+s/this.ns,this.over),r=u0(this.g-n/this.a),t.x=i,t.y=r,t;var o=this.g-n/this.a;return r=qN(o,this.e0,this.e1,this.e2,this.e3),i=Pt(this.long0+s/this.ns,this.over),t.x=i,t.y=r,t}var bmt=["Equidistant_Conic","eqdc"];const Emt={init:_mt,forward:xmt,inverse:wmt,names:bmt};function Smt(){this.R=this.a}function Tmt(t){var e=t.x,n=t.y,r=Pt(e-this.long0,this.over),i,s;Math.abs(n)<=wt&&(i=this.x0+this.R*r,s=this.y0);var o=Xg(2*Math.abs(n/Math.PI));(Math.abs(r)<=wt||Math.abs(Math.abs(n)-st)<=wt)&&(i=this.x0,n>=0?s=this.y0+Math.PI*this.R*Math.tan(.5*o):s=this.y0+Math.PI*this.R*-Math.tan(.5*o));var a=.5*Math.abs(Math.PI/r-r/Math.PI),l=a*a,c=Math.sin(o),u=Math.cos(o),h=u/(c+u-1),f=h*h,g=h*(2/c-1),y=g*g,_=Math.PI*this.R*(a*(h-y)+Math.sqrt(l*(h-y)*(h-y)-(y+l)*(f-y)))/(y+l);r<0&&(_=-_),i=this.x0+_;var b=l+h;return _=Math.PI*this.R*(g*b-a*Math.sqrt((y+l)*(l+1)-b*b))/(y+l),n>=0?s=this.y0+_:s=this.y0-_,t.x=i,t.y=s,t}function kmt(t){var e,n,r,i,s,o,a,l,c,u,h,f,g;return t.x-=this.x0,t.y-=this.y0,h=Math.PI*this.R,r=t.x/h,i=t.y/h,s=r*r+i*i,o=-Math.abs(i)*(1+s),a=o-2*i*i+r*r,l=-2*o+1+2*i*i+s*s,g=i*i/l+(2*a*a*a/l/l/l-9*o*a/l/l)/27,c=(o-a*a/3/l)/l,u=2*Math.sqrt(-c/3),h=3*g/c/u,Math.abs(h)>1&&(h>=0?h=1:h=-1),f=Math.acos(h)/3,t.y>=0?n=(-u*Math.cos(f+Math.PI/3)-a/3/l)*Math.PI:n=-(-u*Math.cos(f+Math.PI/3)-a/3/l)*Math.PI,Math.abs(r)<wt?e=this.long0:e=Pt(this.long0+Math.PI*(s-1+Math.sqrt(1+2*(r*r-i*i)+s*s))/2/r,this.over),t.x=e,t.y=n,t}var Amt=["Van_der_Grinten_I","VanDerGrinten","Van_der_Grinten","vandg"];const Imt={init:Smt,forward:Tmt,inverse:kmt,names:Amt};function Pmt(t,e,n,r,i,s){const o=r-e,a=Math.atan((1-s)*Math.tan(t)),l=Math.atan((1-s)*Math.tan(n)),c=Math.sin(a),u=Math.cos(a),h=Math.sin(l),f=Math.cos(l);let g=o,y,_=100,b,T,A,I,P,R,D,C,M,O,j,V,U,G;do{if(b=Math.sin(g),T=Math.cos(g),A=Math.sqrt(f*b*(f*b)+(u*h-c*f*T)*(u*h-c*f*T)),A===0)return{azi1:0,s12:0};I=c*h+u*f*T,P=Math.atan2(A,I),R=u*f*b/A,D=1-R*R,C=D!==0?I-2*c*h/D:0,M=s/16*D*(4+s*(4-3*D)),y=g,g=o+(1-M)*s*R*(P+M*A*(C+M*I*(-1+2*C*C)))}while(Math.abs(g-y)>1e-12&&--_>0);return _===0?{azi1:NaN,s12:NaN}:(O=D*(i*i-i*(1-s)*(i*(1-s)))/(i*(1-s)*(i*(1-s))),j=1+O/16384*(4096+O*(-768+O*(320-175*O))),V=O/1024*(256+O*(-128+O*(74-47*O))),U=V*A*(C+V/4*(I*(-1+2*C*C)-V/6*C*(-3+4*A*A)*(-3+4*C*C))),G=i*(1-s)*j*(P-U),{azi1:Math.atan2(f*b,u*h-c*f*T),s12:G})}function Cmt(t,e,n,r,i,s){const o=Math.atan((1-s)*Math.tan(t)),a=Math.sin(o),l=Math.cos(o),c=Math.sin(n),u=Math.cos(n),h=Math.atan2(a,l*u),f=l*c,g=1-f*f,y=g*(i*i-i*(1-s)*(i*(1-s)))/(i*(1-s)*(i*(1-s))),_=1+y/16384*(4096+y*(-768+y*(320-175*y))),b=y/1024*(256+y*(-128+y*(74-47*y)));let T=r/(i*(1-s)*_),A,I=100,P,R,D,C;do P=Math.cos(2*h+T),R=Math.sin(T),D=Math.cos(T),C=b*R*(P+b/4*(D*(-1+2*P*P)-b/6*P*(-3+4*R*R)*(-3+4*P*P))),A=T,T=r/(i*(1-s)*_)+C;while(Math.abs(T-A)>1e-12&&--I>0);if(I===0)return{lat2:NaN,lon2:NaN};const M=a*R-l*D*u,O=Math.atan2(a*D+l*R*u,(1-s)*Math.sqrt(f*f+M*M)),j=Math.atan2(R*c,l*D-a*R*u),V=s/16*g*(4+s*(4-3*g)),U=j-(1-V)*s*f*(T+V*R*(P+V*D*(-1+2*P*P))),G=e+U;return{lat2:O,lon2:G}}function Rmt(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0),this.f=this.es/(1+Math.sqrt(1-this.es))}function Mmt(t){var e=t.x,n=t.y,r=Math.sin(t.y),i=Math.cos(t.y),s=Pt(e-this.long0,this.over),o,a,l,c,u,h,f,g,y,_,b;return this.sphere?Math.abs(this.sin_p12-1)<=wt?(t.x=this.x0+this.a*(st-n)*Math.sin(s),t.y=this.y0-this.a*(st-n)*Math.cos(s),t):Math.abs(this.sin_p12+1)<=wt?(t.x=this.x0+this.a*(st+n)*Math.sin(s),t.y=this.y0+this.a*(st+n)*Math.cos(s),t):(y=this.sin_p12*r+this.cos_p12*i*Math.cos(s),f=Math.acos(y),g=f?f/Math.sin(f):1,t.x=this.x0+this.a*g*i*Math.sin(s),t.y=this.y0+this.a*g*(this.cos_p12*r-this.sin_p12*i*Math.cos(s)),t):(o=qI(this.es),a=KI(this.es),l=YI(this.es),c=XI(this.es),Math.abs(this.sin_p12-1)<=wt?(u=this.a*Fa(o,a,l,c,st),h=this.a*Fa(o,a,l,c,n),t.x=this.x0+(u-h)*Math.sin(s),t.y=this.y0-(u-h)*Math.cos(s),t):Math.abs(this.sin_p12+1)<=wt?(u=this.a*Fa(o,a,l,c,st),h=this.a*Fa(o,a,l,c,n),t.x=this.x0+(u+h)*Math.sin(s),t.y=this.y0+(u+h)*Math.cos(s),t):Math.abs(e)<wt&&Math.abs(n-this.lat0)<wt?(t.x=t.y=0,t):(_=Pmt(this.lat0,this.long0,n,e,this.a,this.f),b=_.azi1,t.x=_.s12*Math.sin(b),t.y=_.s12*Math.cos(b),t))}function Nmt(t){t.x-=this.x0,t.y-=this.y0;var e,n,r,i,s,o,a,l,c,u,h,f,g,y,_,b;return this.sphere?(e=Math.sqrt(t.x*t.x+t.y*t.y),e>2*st*this.a?void 0:(n=e/this.a,r=Math.sin(n),i=Math.cos(n),s=this.long0,Math.abs(e)<=wt?o=this.lat0:(o=Xg(i*this.sin_p12+t.y*r*this.cos_p12/e),a=Math.abs(this.lat0)-st,Math.abs(a)<=wt?this.lat0>=0?s=Pt(this.long0+Math.atan2(t.x,-t.y),this.over):s=Pt(this.long0-Math.atan2(-t.x,t.y),this.over):s=Pt(this.long0+Math.atan2(t.x*r,e*this.cos_p12*i-t.y*this.sin_p12*r),this.over)),t.x=s,t.y=o,t)):(l=qI(this.es),c=KI(this.es),u=YI(this.es),h=XI(this.es),Math.abs(this.sin_p12-1)<=wt?(f=this.a*Fa(l,c,u,h,st),e=Math.sqrt(t.x*t.x+t.y*t.y),g=f-e,o=qN(g/this.a,l,c,u,h),s=Pt(this.long0+Math.atan2(t.x,-1*t.y),this.over),t.x=s,t.y=o,t):Math.abs(this.sin_p12+1)<=wt?(f=this.a*Fa(l,c,u,h,st),e=Math.sqrt(t.x*t.x+t.y*t.y),g=e-f,o=qN(g/this.a,l,c,u,h),s=Pt(this.long0+Math.atan2(t.x,t.y),this.over),t.x=s,t.y=o,t):(y=Math.atan2(t.x,t.y),_=Math.sqrt(t.x*t.x+t.y*t.y),b=Cmt(this.lat0,this.long0,y,_,this.a,this.f),t.x=b.lon2,t.y=b.lat2,t))}var Omt=["Azimuthal_Equidistant","aeqd"];const Lmt={init:Rmt,forward:Mmt,inverse:Nmt,names:Omt};function Dmt(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)}function jmt(t){var e,n,r,i,s,o,a,l,c=t.x,u=t.y;return r=Pt(c-this.long0,this.over),e=Math.sin(u),n=Math.cos(u),i=Math.cos(r),o=this.sin_p14*e+this.cos_p14*n*i,s=1,(o>0||Math.abs(o)<=wt)&&(a=this.a*s*n*Math.sin(r),l=this.y0+this.a*s*(this.cos_p14*e-this.sin_p14*n*i)),t.x=a,t.y=l,t}function $mt(t){var e,n,r,i,s,o,a;return t.x-=this.x0,t.y-=this.y0,e=Math.sqrt(t.x*t.x+t.y*t.y),n=Xg(e/this.a),r=Math.sin(n),i=Math.cos(n),o=this.long0,Math.abs(e)<=wt?(a=this.lat0,t.x=o,t.y=a,t):(a=Xg(i*this.sin_p14+t.y*r*this.cos_p14/e),s=Math.abs(this.lat0)-st,Math.abs(s)<=wt?(this.lat0>=0?o=Pt(this.long0+Math.atan2(t.x,-t.y),this.over):o=Pt(this.long0-Math.atan2(-t.x,t.y),this.over),t.x=o,t.y=a,t):(o=Pt(this.long0+Math.atan2(t.x*r,e*this.cos_p14*i-t.y*this.sin_p14*r),this.over),t.x=o,t.y=a,t))}var Fmt=["ortho"];const Vmt={init:Dmt,forward:jmt,inverse:$mt,names:Fmt};var Oi={FRONT:1,RIGHT:2,BACK:3,LEFT:4,TOP:5,BOTTOM:6},Or={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4};function zmt(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=st-Nr/2?this.face=Oi.TOP:this.lat0<=-(st-Nr/2)?this.face=Oi.BOTTOM:Math.abs(this.long0)<=Nr?this.face=Oi.FRONT:Math.abs(this.long0)<=st+Nr?this.face=this.long0>0?Oi.RIGHT:Oi.LEFT:this.face=Oi.BACK,this.es!==0&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)}function Gmt(t){var e={x:0,y:0},n,r,i,s,o,a,l={value:0};if(t.x-=this.long0,this.es!==0?n=Math.atan(this.one_minus_f_squared*Math.tan(t.y)):n=t.y,r=t.x,this.face===Oi.TOP)s=st-n,r>=Nr&&r<=st+Nr?(l.value=Or.AREA_0,i=r-st):r>st+Nr||r<=-(st+Nr)?(l.value=Or.AREA_1,i=r>0?r-hs:r+hs):r>-(st+Nr)&&r<=-Nr?(l.value=Or.AREA_2,i=r+st):(l.value=Or.AREA_3,i=r);else if(this.face===Oi.BOTTOM)s=st+n,r>=Nr&&r<=st+Nr?(l.value=Or.AREA_0,i=-r+st):r<Nr&&r>=-Nr?(l.value=Or.AREA_1,i=-r):r<-Nr&&r>=-(st+Nr)?(l.value=Or.AREA_2,i=-r-st):(l.value=Or.AREA_3,i=r>0?-r+hs:-r-hs);else{var c,u,h,f,g,y,_;this.face===Oi.RIGHT?r=xw(r,+st):this.face===Oi.BACK?r=xw(r,+hs):this.face===Oi.LEFT&&(r=xw(r,-st)),f=Math.sin(n),g=Math.cos(n),y=Math.sin(r),_=Math.cos(r),c=g*_,u=g*y,h=f,this.face===Oi.FRONT?(s=Math.acos(c),i=TR(s,h,u,l)):this.face===Oi.RIGHT?(s=Math.acos(u),i=TR(s,h,-c,l)):this.face===Oi.BACK?(s=Math.acos(-c),i=TR(s,h,-u,l)):this.face===Oi.LEFT?(s=Math.acos(-u),i=TR(s,h,c,l)):(s=i=0,l.value=Or.AREA_0)}return a=Math.atan(12/hs*(i+Math.acos(Math.sin(i)*Math.cos(Nr))-st)),o=Math.sqrt((1-Math.cos(s))/(Math.cos(a)*Math.cos(a))/(1-Math.cos(Math.atan(1/Math.cos(i))))),l.value===Or.AREA_1?a+=st:l.value===Or.AREA_2?a+=hs:l.value===Or.AREA_3&&(a+=1.5*hs),e.x=o*Math.cos(a),e.y=o*Math.sin(a),e.x=e.x*this.a+this.x0,e.y=e.y*this.a+this.y0,t.x=e.x,t.y=e.y,t}function Umt(t){var e={lam:0,phi:0},n,r,i,s,o,a,l,c,u,h={value:0};if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,r=Math.atan(Math.sqrt(t.x*t.x+t.y*t.y)),n=Math.atan2(t.y,t.x),t.x>=0&&t.x>=Math.abs(t.y)?h.value=Or.AREA_0:t.y>=0&&t.y>=Math.abs(t.x)?(h.value=Or.AREA_1,n-=st):t.x<0&&-t.x>=Math.abs(t.y)?(h.value=Or.AREA_2,n=n<0?n+hs:n-hs):(h.value=Or.AREA_3,n+=st),u=hs/12*Math.tan(n),o=Math.sin(u)/(Math.cos(u)-1/Math.sqrt(2)),a=Math.atan(o),i=Math.cos(n),s=Math.tan(r),l=1-i*i*s*s*(1-Math.cos(Math.atan(1/Math.cos(a)))),l<-1?l=-1:l>1&&(l=1),this.face===Oi.TOP)c=Math.acos(l),e.phi=st-c,h.value===Or.AREA_0?e.lam=a+st:h.value===Or.AREA_1?e.lam=a<0?a+hs:a-hs:h.value===Or.AREA_2?e.lam=a-st:e.lam=a;else if(this.face===Oi.BOTTOM)c=Math.acos(l),e.phi=c-st,h.value===Or.AREA_0?e.lam=-a+st:h.value===Or.AREA_1?e.lam=-a:h.value===Or.AREA_2?e.lam=-a-st:e.lam=a<0?-a-hs:-a+hs;else{var f,g,y;f=l,u=f*f,u>=1?y=0:y=Math.sqrt(1-u)*Math.sin(a),u+=y*y,u>=1?g=0:g=Math.sqrt(1-u),h.value===Or.AREA_1?(u=g,g=-y,y=u):h.value===Or.AREA_2?(g=-g,y=-y):h.value===Or.AREA_3&&(u=g,g=y,y=-u),this.face===Oi.RIGHT?(u=f,f=-g,g=u):this.face===Oi.BACK?(f=-f,g=-g):this.face===Oi.LEFT&&(u=f,f=g,g=-u),e.phi=Math.acos(-y)-st,e.lam=Math.atan2(g,f),this.face===Oi.RIGHT?e.lam=xw(e.lam,-st):this.face===Oi.BACK?e.lam=xw(e.lam,-hs):this.face===Oi.LEFT&&(e.lam=xw(e.lam,+st))}if(this.es!==0){var _,b,T;_=e.phi<0?1:0,b=Math.tan(e.phi),T=this.b/Math.sqrt(b*b+this.one_minus_f_squared),e.phi=Math.atan(Math.sqrt(this.a*this.a-T*T)/(this.one_minus_f*T)),_&&(e.phi=-e.phi)}return e.lam+=this.long0,t.x=e.lam,t.y=e.phi,t}function TR(t,e,n,r){var i;return t<wt?(r.value=Or.AREA_0,i=0):(i=Math.atan2(e,n),Math.abs(i)<=Nr?r.value=Or.AREA_0:i>Nr&&i<=st+Nr?(r.value=Or.AREA_1,i-=st):i>st+Nr||i<=-(st+Nr)?(r.value=Or.AREA_2,i=i>=0?i-hs:i+hs):(r.value=Or.AREA_3,i+=st)),i}function xw(t,e){var n=t+e;return n<-hs?n+=xA:n>+hs&&(n-=xA),n}var Bmt=["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"];const Wmt={init:zmt,forward:Gmt,inverse:Umt,names:Bmt};var Pz=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-986701e-12],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,18736e-12],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,934959e-12],[.7986,-.00755338,-500009e-10,935324e-12],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],YS=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-126793e-14,422642e-15],[.124,.0124,507171e-14,-160604e-14],[.186,.0123999,-190189e-13,600152e-14],[.248,.0124002,710039e-13,-224e-10],[.31,.0123992,-264997e-12,835986e-13],[.372,.0124029,988983e-12,-311994e-12],[.434,.0123893,-369093e-11,-435621e-12],[.4958,.0123198,-102252e-10,-345523e-12],[.5571,.0121916,-154081e-10,-582288e-12],[.6176,.0119938,-241424e-10,-525327e-12],[.6769,.011713,-320223e-10,-516405e-12],[.7346,.0113541,-397684e-10,-609052e-12],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-140374e-14],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],H2e=.8487,q2e=1.3523,K2e=bl/5,Hmt=1/K2e,Ux=18,KN=function(t,e){return t[0]+e*(t[1]+e*(t[2]+e*t[3]))},qmt=function(t,e){return t[1]+e*(2*t[2]+e*3*t[3])};function Kmt(t,e,n,r){for(var i=e;r;--r){var s=t(i);if(i-=s,Math.abs(s)<n)break}return i}function Ymt(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"}function Xmt(t){var e=Pt(t.x-this.long0,this.over),n=Math.abs(t.y),r=Math.floor(n*K2e);r<0?r=0:r>=Ux&&(r=Ux-1),n=bl*(n-Hmt*r);var i={x:KN(Pz[r],n)*e,y:KN(YS[r],n)};return t.y<0&&(i.y=-i.y),i.x=i.x*this.a*H2e+this.x0,i.y=i.y*this.a*q2e+this.y0,i}function Zmt(t){var e={x:(t.x-this.x0)/(this.a*H2e),y:Math.abs(t.y-this.y0)/(this.a*q2e)};if(e.y>=1)e.x/=Pz[Ux][0],e.y=t.y<0?-st:st;else{var n=Math.floor(e.y*Ux);for(n<0?n=0:n>=Ux&&(n=Ux-1);;)if(YS[n][0]>e.y)--n;else if(YS[n+1][0]<=e.y)++n;else break;var r=YS[n],i=5*(e.y-r[0])/(YS[n+1][0]-r[0]);i=Kmt(function(s){return(KN(r,s)-e.y)/qmt(r,s)},i,wt,100),e.x/=KN(Pz[n],i),e.y=(5*n+i)*Ki,t.y<0&&(e.y=-e.y)}return e.x=Pt(e.x+this.long0,this.over),e}var Jmt=["Robinson","robin"];const Qmt={init:Ymt,forward:Xmt,inverse:Zmt,names:Jmt};function egt(){this.name="geocent"}function tgt(t){var e=L2e(t,this.es,this.a);return e}function ngt(t){var e=D2e(t,this.es,this.a,this.b);return e}var rgt=["Geocentric","geocentric","geocent","Geocent"];const igt={init:egt,forward:tgt,inverse:ngt,names:rgt};var sa={N_POLE:0,S_POLE:1,EQUIT:2,OBLIQ:3},QE={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};function sgt(){if(Object.keys(QE).forEach((function(n){if(typeof this[n]>"u")this[n]=QE[n].def;else{if(QE[n].num&&isNaN(this[n]))throw new Error("Invalid parameter value, must be numeric "+n+" = "+this[n]);QE[n].num&&(this[n]=parseFloat(this[n]))}QE[n].degrees&&(this[n]=this[n]*Ki)}).bind(this)),Math.abs(Math.abs(this.lat0)-st)<wt?this.mode=this.lat0<0?sa.S_POLE:sa.N_POLE:Math.abs(this.lat0)<wt?this.mode=sa.EQUIT:(this.mode=sa.OBLIQ,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var t=this.tilt,e=this.azi;this.cg=Math.cos(e),this.sg=Math.sin(e),this.cw=Math.cos(t),this.sw=Math.sin(t)}function ogt(t){t.x-=this.long0;var e=Math.sin(t.y),n=Math.cos(t.y),r=Math.cos(t.x),i,s;switch(this.mode){case sa.OBLIQ:s=this.sinph0*e+this.cosph0*n*r;break;case sa.EQUIT:s=n*r;break;case sa.S_POLE:s=-e;break;case sa.N_POLE:s=e;break}switch(s=this.pn1/(this.p-s),i=s*n*Math.sin(t.x),this.mode){case sa.OBLIQ:s*=this.cosph0*e-this.sinph0*n*r;break;case sa.EQUIT:s*=e;break;case sa.N_POLE:s*=-(n*r);break;case sa.S_POLE:s*=n*r;break}var o,a;return o=s*this.cg+i*this.sg,a=1/(o*this.sw*this.h1+this.cw),i=(i*this.cg-s*this.sg)*this.cw*a,s=o*a,t.x=i*this.a,t.y=s*this.a,t}function agt(t){t.x/=this.a,t.y/=this.a;var e={x:t.x,y:t.y},n,r,i;i=1/(this.pn1-t.y*this.sw),n=this.pn1*t.x*i,r=this.pn1*t.y*this.cw*i,t.x=n*this.cg+r*this.sg,t.y=r*this.cg-n*this.sg;var s=vl(t.x,t.y);if(Math.abs(s)<wt)e.x=0,e.y=t.y;else{var o,a;switch(a=1-s*s*this.pfact,a=(this.p-Math.sqrt(a))/(this.pn1/s+s/this.pn1),o=Math.sqrt(1-a*a),this.mode){case sa.OBLIQ:e.y=Math.asin(o*this.sinph0+t.y*a*this.cosph0/s),t.y=(o-this.sinph0*Math.sin(e.y))*s,t.x*=a*this.cosph0;break;case sa.EQUIT:e.y=Math.asin(t.y*a/s),t.y=o*s,t.x*=a;break;case sa.N_POLE:e.y=Math.asin(o),t.y=-t.y;break;case sa.S_POLE:e.y=-Math.asin(o);break}e.x=Math.atan2(t.x,t.y)}return t.x=e.x+this.long0,t.y=e.y,t}var lgt=["Tilted_Perspective","tpers"];const cgt={init:sgt,forward:ogt,inverse:agt,names:lgt};function ugt(){if(this.flip_axis=this.sweep==="x"?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,this.es!==0){var t=1-this.es,e=1/t;this.radius_p=Math.sqrt(t),this.radius_p2=t,this.radius_p_inv2=e,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")}function hgt(t){var e=t.x,n=t.y,r,i,s,o;if(e=e-this.long0,this.shape==="ellipse"){n=Math.atan(this.radius_p2*Math.tan(n));var a=this.radius_p/vl(this.radius_p*Math.cos(n),Math.sin(n));if(i=a*Math.cos(e)*Math.cos(n),s=a*Math.sin(e)*Math.cos(n),o=a*Math.sin(n),(this.radius_g-i)*i-s*s-o*o*this.radius_p_inv2<0)return t.x=Number.NaN,t.y=Number.NaN,t;r=this.radius_g-i,this.flip_axis?(t.x=this.radius_g_1*Math.atan(s/vl(o,r)),t.y=this.radius_g_1*Math.atan(o/r)):(t.x=this.radius_g_1*Math.atan(s/r),t.y=this.radius_g_1*Math.atan(o/vl(s,r)))}else this.shape==="sphere"&&(r=Math.cos(n),i=Math.cos(e)*r,s=Math.sin(e)*r,o=Math.sin(n),r=this.radius_g-i,this.flip_axis?(t.x=this.radius_g_1*Math.atan(s/vl(o,r)),t.y=this.radius_g_1*Math.atan(o/r)):(t.x=this.radius_g_1*Math.atan(s/r),t.y=this.radius_g_1*Math.atan(o/vl(s,r))));return t.x=t.x*this.a,t.y=t.y*this.a,t}function dgt(t){var e=-1,n=0,r=0,i,s,o,a;if(t.x=t.x/this.a,t.y=t.y/this.a,this.shape==="ellipse"){this.flip_axis?(r=Math.tan(t.y/this.radius_g_1),n=Math.tan(t.x/this.radius_g_1)*vl(1,r)):(n=Math.tan(t.x/this.radius_g_1),r=Math.tan(t.y/this.radius_g_1)*vl(1,n));var l=r/this.radius_p;if(i=n*n+l*l+e*e,s=2*this.radius_g*e,o=s*s-4*i*this.C,o<0)return t.x=Number.NaN,t.y=Number.NaN,t;a=(-s-Math.sqrt(o))/(2*i),e=this.radius_g+a*e,n*=a,r*=a,t.x=Math.atan2(n,e),t.y=Math.atan(r*Math.cos(t.x)/e),t.y=Math.atan(this.radius_p_inv2*Math.tan(t.y))}else if(this.shape==="sphere"){if(this.flip_axis?(r=Math.tan(t.y/this.radius_g_1),n=Math.tan(t.x/this.radius_g_1)*Math.sqrt(1+r*r)):(n=Math.tan(t.x/this.radius_g_1),r=Math.tan(t.y/this.radius_g_1)*Math.sqrt(1+n*n)),i=n*n+r*r+e*e,s=2*this.radius_g*e,o=s*s-4*i*this.C,o<0)return t.x=Number.NaN,t.y=Number.NaN,t;a=(-s-Math.sqrt(o))/(2*i),e=this.radius_g+a*e,n*=a,r*=a,t.x=Math.atan2(n,e),t.y=Math.atan(r*Math.cos(t.x)/e)}return t.x=t.x+this.long0,t}var fgt=["Geostationary Satellite View","Geostationary_Satellite","geos"];const pgt={init:ugt,forward:hgt,inverse:dgt,names:fgt};var WT=1.340264,HT=-.081106,qT=893e-6,KT=.003796,YN=Math.sqrt(3)/2;function mgt(){this.es=0,this.long0=this.long0!==void 0?this.long0:0,this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0}function ggt(t){var e=Pt(t.x-this.long0,this.over),n=t.y,r=Math.asin(YN*Math.sin(n)),i=r*r,s=i*i*i;return t.x=e*Math.cos(r)/(YN*(WT+3*HT*i+s*(7*qT+9*KT*i))),t.y=r*(WT+HT*i+s*(qT+KT*i)),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t}function ygt(t){t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a;var e=1e-9,n=12,r=t.y,i,s,o,a,l,c;for(c=0;c<n&&(i=r*r,s=i*i*i,o=r*(WT+HT*i+s*(qT+KT*i))-t.y,a=WT+3*HT*i+s*(7*qT+9*KT*i),r-=l=o/a,!(Math.abs(l)<e));++c);return i=r*r,s=i*i*i,t.x=YN*t.x*(WT+3*HT*i+s*(7*qT+9*KT*i))/Math.cos(r),t.y=Math.asin(Math.sin(r)/YN),t.x=Pt(t.x+this.long0,this.over),t}var vgt=["eqearth","Equal Earth","Equal_Earth"];const _gt={init:mgt,forward:ggt,inverse:ygt,names:vgt};var EA=1e-10;function xgt(){var t;if(this.phi1=this.lat1,Math.abs(this.phi1)<EA)throw new Error;this.es?(this.en=nq(this.es),this.m1=kb(this.phi1,this.am1=Math.sin(this.phi1),t=Math.cos(this.phi1),this.en),this.am1=t/(Math.sqrt(1-this.es*this.am1*this.am1)*this.am1),this.inverse=bgt,this.forward=wgt):(Math.abs(this.phi1)+EA>=st?this.cphi1=0:this.cphi1=1/Math.tan(this.phi1),this.inverse=Sgt,this.forward=Egt)}function wgt(t){var e=Pt(t.x-(this.long0||0),this.over),n=t.y,r,i,s;return r=this.am1+this.m1-kb(n,i=Math.sin(n),s=Math.cos(n),this.en),i=s*e/(r*Math.sqrt(1-this.es*i*i)),t.x=r*Math.sin(i),t.y=this.am1-r*Math.cos(i),t.x=this.a*t.x+(this.x0||0),t.y=this.a*t.y+(this.y0||0),t}function bgt(t){t.x=(t.x-(this.x0||0))/this.a,t.y=(t.y-(this.y0||0))/this.a;var e,n,r,i;if(n=vl(t.x,t.y=this.am1-t.y),i=rq(this.am1+this.m1-n,this.es,this.en),(e=Math.abs(i))<st)e=Math.sin(i),r=n*Math.atan2(t.x,t.y)*Math.sqrt(1-this.es*e*e)/Math.cos(i);else if(Math.abs(e-st)<=EA)r=0;else throw new Error;return t.x=Pt(r+(this.long0||0),this.over),t.y=u0(i),t}function Egt(t){var e=Pt(t.x-(this.long0||0),this.over),n=t.y,r,i;return i=this.cphi1+this.phi1-n,Math.abs(i)>EA?(t.x=i*Math.sin(r=e*Math.cos(n)/i),t.y=this.cphi1-i*Math.cos(r)):t.x=t.y=0,t.x=this.a*t.x+(this.x0||0),t.y=this.a*t.y+(this.y0||0),t}function Sgt(t){t.x=(t.x-(this.x0||0))/this.a,t.y=(t.y-(this.y0||0))/this.a;var e,n,r=vl(t.x,t.y=this.cphi1-t.y);if(n=this.cphi1+this.phi1-r,Math.abs(n)>st)throw new Error;return Math.abs(Math.abs(n)-st)<=EA?e=0:e=r*Math.atan2(t.x,t.y)/Math.cos(n),t.x=Pt(e+(this.long0||0),this.over),t.y=u0(n),t}var Tgt=["bonne","Bonne (Werner lat_1=90)"];const kgt={init:xgt,names:Tgt},_oe={OBLIQUE:{forward:Rgt,inverse:Ngt},TRANSVERSE:{forward:Mgt,inverse:Ogt}},XN={ROTATE:{o_alpha:"oAlpha",o_lon_c:"oLongC",o_lat_c:"oLatC"},NEW_POLE:{o_lat_p:"oLatP",o_lon_p:"oLongP"},NEW_EQUATOR:{o_lon_1:"oLong1",o_lat_1:"oLat1",o_lon_2:"oLong2",o_lat_2:"oLat2"}};function Agt(){if(this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.title=this.title||"General Oblique Transformation",this.isIdentity=R2e.includes(this.o_proj),!this.o_proj)throw new Error("Missing parameter: o_proj");if(this.o_proj==="ob_tran")throw new Error("Invalid value for o_proj: "+this.o_proj);const t=this.projStr.replace("+proj=ob_tran","").replace("+o_proj=","+proj=").trim(),e=fu(t);if(!e)throw new Error("Invalid parameter: o_proj. Unknown projection "+this.o_proj);e.long0=0,this.obliqueProjection=e;let n;const r=Object.keys(XN),i=a=>{if(typeof this[a]>"u")return;const l=parseFloat(this[a])*Ki;if(isNaN(l))throw new Error("Invalid value for "+a+": "+this[a]);return l};for(let a=0;a<r.length;a++){const l=r[a],c=XN[l],u=Object.entries(c);if(u.some(([f])=>typeof this[f]<"u")){n=c;for(let f=0;f<u.length;f++){const[g,y]=u[f],_=i(g);if(typeof _>"u")throw new Error("Missing parameter: "+g+".");this[y]=_}break}}if(!n)throw new Error("No valid parameters provided for ob_tran projection.");const{lamp:s,phip:o}=Cgt(this,n);this.lamp=s,Math.abs(o)>wt?(this.cphip=Math.cos(o),this.sphip=Math.sin(o),this.projectionType=_oe.OBLIQUE):this.projectionType=_oe.TRANSVERSE}function Igt(t){return this.projectionType.forward(this,t)}function Pgt(t){return this.projectionType.inverse(this,t)}function Cgt(t,e){let n,r;if(e===XN.ROTATE){let i=t.oLongC,s=t.oLatC,o=t.oAlpha;if(Math.abs(Math.abs(s)-st)<=wt)throw new Error("Invalid value for o_lat_c: "+t.o_lat_c+" should be < 90");r=i+Math.atan2(-1*Math.cos(o),-1*Math.sin(o)*Math.sin(s)),n=Math.asin(Math.cos(s)*Math.sin(o))}else if(e===XN.NEW_POLE)r=t.oLongP,n=t.oLatP;else{let i=t.oLong1,s=t.oLat1,o=t.oLong2,a=t.oLat2,l=Math.abs(s);if(Math.abs(s)>st-wt)throw new Error("Invalid value for o_lat_1: "+t.o_lat_1+" should be < 90");if(Math.abs(a)>st-wt)throw new Error("Invalid value for o_lat_2: "+t.o_lat_2+" should be < 90");if(Math.abs(s-a)<wt)throw new Error("Invalid value for o_lat_1 and o_lat_2: o_lat_1 should be different from o_lat_2");if(l<wt)throw new Error("Invalid value for o_lat_1: o_lat_1 should be different from zero");r=Math.atan2(Math.cos(s)*Math.sin(a)*Math.cos(i)-Math.sin(s)*Math.cos(a)*Math.cos(o),Math.sin(s)*Math.cos(a)*Math.sin(o)-Math.cos(s)*Math.sin(a)*Math.sin(i)),n=Math.atan(-1*Math.cos(r-i)/Math.tan(s))}return{lamp:r,phip:n}}function Rgt(t,e){let{x:n,y:r}=e;n+=t.long0;const i=Math.cos(n),s=Math.sin(r),o=Math.cos(r);e.x=Pt(Math.atan2(o*Math.sin(n),t.sphip*o*i+t.cphip*s)+t.lamp),e.y=Math.asin(t.sphip*s-t.cphip*o*i);const a=t.obliqueProjection.forward(e);return t.isIdentity&&(a.x*=bl,a.y*=bl),a}function Mgt(t,e){let{x:n,y:r}=e;n+=t.long0;const i=Math.cos(r),s=Math.cos(n);e.x=Pt(Math.atan2(i*Math.sin(n),Math.sin(r))+t.lamp),e.y=Math.asin(-1*i*s);const o=t.obliqueProjection.forward(e);return t.isIdentity&&(o.x*=bl,o.y*=bl),o}function Ngt(t,e){t.isIdentity&&(e.x*=Ki,e.y*=Ki);const n=t.obliqueProjection.inverse(e);let{x:r,y:i}=n;if(r<Number.MAX_VALUE){r-=t.lamp;const s=Math.cos(r),o=Math.sin(i),a=Math.cos(i);e.x=Math.atan2(a*Math.sin(r),t.sphip*a*s-t.cphip*o),e.y=Math.asin(t.sphip*o+t.cphip*a*s)}return e.x=Pt(e.x+t.long0),e}function Ogt(t,e){t.isIdentity&&(e.x*=Ki,e.y*=Ki);const n=t.obliqueProjection.inverse(e);let{x:r,y:i}=n;if(r<Number.MAX_VALUE){const s=Math.cos(i);r-=t.lamp,e.x=Math.atan2(s*Math.sin(r),-1*Math.sin(i)),e.y=Math.asin(s*Math.cos(r))}return e.x=Pt(e.x+t.long0),e}var Lgt=["General Oblique Transformation","General_Oblique_Transformation","ob_tran"];const Dgt={init:Agt,forward:Igt,inverse:Pgt,names:Lgt};function jgt(t){t.Proj.projections.add(E3),t.Proj.projections.add(S3),t.Proj.projections.add(Tft),t.Proj.projections.add(Oft),t.Proj.projections.add(Fft),t.Proj.projections.add(Bft),t.Proj.projections.add(Xft),t.Proj.projections.add(tpt),t.Proj.projections.add(opt),t.Proj.projections.add(hpt),t.Proj.projections.add(Spt),t.Proj.projections.add(Cpt),t.Proj.projections.add(Lpt),t.Proj.projections.add(zpt),t.Proj.projections.add(Hpt),t.Proj.projections.add(Zpt),t.Proj.projections.add(nmt),t.Proj.projections.add(amt),t.Proj.projections.add(fmt),t.Proj.projections.add(vmt),t.Proj.projections.add(Emt),t.Proj.projections.add(Imt),t.Proj.projections.add(Lmt),t.Proj.projections.add(Vmt),t.Proj.projections.add(Wmt),t.Proj.projections.add(Qmt),t.Proj.projections.add(igt),t.Proj.projections.add(cgt),t.Proj.projections.add(pgt),t.Proj.projections.add(_gt),t.Proj.projections.add(kgt),t.Proj.projections.add(Dgt)}const lr=Object.assign(Gdt,{defaultDatum:"WGS84",Proj:fu,WGS84:new fu("WGS84"),Point:z2,toPoint:j2e,defs:Io,nadgrid:Sdt,transform:HN,mgrs:Udt,version:"__VERSION__"});jgt(lr);class Y2e{constructor(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.featureClass=gr,this.supportedMediaTypes=null}getReadOptions(e,n){if(n){let r=n.dataProjection?Jr(n.dataProjection):this.readProjection(e);n.extent&&r&&r.getUnits()==="tile-pixels"&&(r=Jr(r),r.setWorldExtent(n.extent)),n={dataProjection:r,featureProjection:n.featureProjection}}return this.adaptOptions(n)}adaptOptions(e){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection,featureClass:this.featureClass},e)}getType(){return bn()}readFeature(e,n){return bn()}readFeatures(e,n){return bn()}readGeometry(e,n){return bn()}readProjection(e){return bn()}writeFeature(e,n){return bn()}writeFeatures(e,n){return bn()}writeGeometry(e,n){return bn()}}function Th(t,e,n){const r=n?Jr(n.featureProjection):null,i=n?Jr(n.dataProjection):null;let s=t;if(r&&i&&!Zy(r,i)){e&&(s=t.clone());const o=e?r:i,a=e?i:r;o.getUnits()==="tile-pixels"?s.transform(o,a):s.applyTransform(uk(o,a))}if(e&&n&&n.decimals!==void 0){const o=Math.pow(10,n.decimals),a=function(l){for(let c=0,u=l.length;c<u;++c)l[c]=Math.round(l[c]*o)/o;return l};s===t&&(s=t.clone()),s.applyTransform(a)}return s}const $gt={Point:Ti,LineString:ts,Polygon:kl,MultiPoint:n0,MultiLineString:yh,MultiPolygon:hp};function Fgt(t,e,n){return Array.isArray(e[0])?(Sle(t,0,e,n)||(t=t.slice(),zF(t,0,e,n)),t):(yG(t,0,e,n)||(t=t.slice(),V3(t,0,e,n)),t)}function X2e(t,e){const n=t.geometry;if(!n)return[];if(Array.isArray(n))return n.map(s=>X2e({...t,geometry:s})).flat();const r=n.type==="MultiPolygon"?"Polygon":n.type;if(r==="GeometryCollection"||r==="Circle")throw new Error("Unsupported geometry type: "+r);const i=n.layout.length;return Th(new gl(r,r==="Polygon"?Fgt(n.flatCoordinates,n.ends,i):n.flatCoordinates,n.ends?.flat(),i,t.properties||{},t.id).enableSimplifyTransformed(),!1,e)}function cq(t,e){if(!t)return null;if(Array.isArray(t)){const r=t.map(i=>cq(i,e));return new cu(r)}const n=$gt[t.type];return Th(new n(t.flatCoordinates,t.layout||"XY",t.ends),!1,e)}class Vgt extends Y2e{constructor(){super()}getType(){return"json"}readFeature(e,n){return this.readFeatureFromObject(kR(e),this.getReadOptions(e,n))}readFeatures(e,n){return this.readFeaturesFromObject(kR(e),this.getReadOptions(e,n))}readFeatureFromObject(e,n){return bn()}readFeaturesFromObject(e,n){return bn()}readGeometry(e,n){return this.readGeometryFromObject(kR(e),this.getReadOptions(e,n))}readGeometryFromObject(e,n){return bn()}readProjection(e){return this.readProjectionFromObject(kR(e))}readProjectionFromObject(e){return bn()}writeFeature(e,n){return JSON.stringify(this.writeFeatureObject(e,n))}writeFeatureObject(e,n){return bn()}writeFeatures(e,n){return JSON.stringify(this.writeFeaturesObject(e,n))}writeFeaturesObject(e,n){return bn()}writeGeometry(e,n){return JSON.stringify(this.writeGeometryObject(e,n))}writeGeometryObject(e,n){return bn()}}function kR(t){if(typeof t=="string"){const e=JSON.parse(t);return e||null}return t!==null?t:null}class kL extends Vgt{constructor(e){e=e||{},super(),this.dataProjection=Jr(e.dataProjection?e.dataProjection:"EPSG:4326"),e.featureProjection&&(this.defaultFeatureProjection=Jr(e.featureProjection)),e.featureClass&&(this.featureClass=e.featureClass),this.geometryName_=e.geometryName,this.extractGeometryName_=e.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(e,n){let r=null;e.type==="Feature"?r=e:r={type:"Feature",geometry:e,properties:null};const i=uq(r.geometry);if(this.featureClass===gl)return X2e({geometry:i,id:r.id,properties:r.properties},n);const s=new gr;return this.geometryName_?s.setGeometryName(this.geometryName_):this.extractGeometryName_&&r.geometry_name&&s.setGeometryName(r.geometry_name),s.setGeometry(cq(i,n)),"id"in r&&s.setId(r.id),r.properties&&s.setProperties(r.properties,!0),s}readFeaturesFromObject(e,n){const r=e;let i=null;if(r.type==="FeatureCollection"){const s=e;i=[];const o=s.features;for(let a=0,l=o.length;a<l;++a){const c=this.readFeatureFromObject(o[a],n);c&&i.push(c)}}else i=[this.readFeatureFromObject(e,n)];return i.flat()}readGeometryFromObject(e,n){return zgt(e,n)}readProjectionFromObject(e){const n=e.crs;let r;if(n)if(n.type=="name")r=Jr(n.properties.name);else if(n.type==="EPSG")r=Jr("EPSG:"+n.properties.code);else throw new Error("Unknown SRS type");else r=this.dataProjection;return r}writeFeatureObject(e,n){n=this.adaptOptions(n);const r={type:"Feature",geometry:null,properties:null},i=e.getId();if(i!==void 0&&(r.id=i),!e.hasProperties())return r;const s=e.getProperties(),o=e.getGeometry();return o&&(r.geometry=Cz(o,n),delete s[e.getGeometryName()]),v1(s)||(r.properties=s),r}writeFeaturesObject(e,n){n=this.adaptOptions(n);const r=[];for(let i=0,s=e.length;i<s;++i)r.push(this.writeFeatureObject(e[i],n));return{type:"FeatureCollection",features:r}}writeGeometryObject(e,n){return Cz(e,this.adaptOptions(n))}}function uq(t,e){if(!t)return null;let n;switch(t.type){case"Point":{n=Ugt(t);break}case"LineString":{n=Bgt(t);break}case"Polygon":{n=Kgt(t);break}case"MultiPoint":{n=Hgt(t);break}case"MultiLineString":{n=Wgt(t);break}case"MultiPolygon":{n=qgt(t);break}case"GeometryCollection":{n=Ggt(t);break}default:throw new Error("Unsupported GeoJSON type: "+t.type)}return n}function zgt(t,e){const n=uq(t);return cq(n,e)}function Ggt(t,e){return t.geometries.map(function(r){return uq(r)})}function Ugt(t){const e=t.coordinates;return{type:"Point",flatCoordinates:e,layout:sv(e.length)}}function Bgt(t){const e=t.coordinates,n=e.flat();return{type:"LineString",flatCoordinates:n,ends:[n.length],layout:sv(e[0]?.length||2)}}function Wgt(t){const e=t.coordinates,n=e[0]?.[0]?.length||2,r=[],i=zA(r,0,e,n);return{type:"MultiLineString",flatCoordinates:r,ends:i,layout:sv(n)}}function Hgt(t){const e=t.coordinates;return{type:"MultiPoint",flatCoordinates:e.flat(),layout:sv(e[0]?.length||2)}}function qgt(t){const e=t.coordinates,n=[],r=e[0]?.[0]?.[0].length||2,i=ele(n,0,e,r);return{type:"MultiPolygon",flatCoordinates:n,ends:i,layout:sv(r)}}function Kgt(t){const e=t.coordinates,n=[],r=e[0]?.[0]?.length,i=zA(n,0,e,r);return{type:"Polygon",flatCoordinates:n,ends:i,layout:sv(r)}}function Cz(t,e){t=Th(t,!0,e);const n=t.getType();let r;switch(n){case"Point":{r=e0t(t);break}case"LineString":{r=Xgt(t);break}case"Polygon":{r=t0t(t,e);break}case"MultiPoint":{r=Jgt(t);break}case"MultiLineString":{r=Zgt(t);break}case"MultiPolygon":{r=Qgt(t,e);break}case"GeometryCollection":{r=Ygt(t,e);break}case"Circle":{r={type:"GeometryCollection",geometries:[]};break}default:throw new Error("Unsupported geometry type: "+n)}return r}function Ygt(t,e){return e=Object.assign({},e),delete e.featureProjection,{type:"GeometryCollection",geometries:t.getGeometriesArray().map(function(r){return Cz(r,e)})}}function Xgt(t,e){return{type:"LineString",coordinates:t.getCoordinates()}}function Zgt(t,e){return{type:"MultiLineString",coordinates:t.getCoordinates()}}function Jgt(t,e){return{type:"MultiPoint",coordinates:t.getCoordinates()}}function Qgt(t,e){let n;return e&&(n=e.rightHanded),{type:"MultiPolygon",coordinates:t.getCoordinates(n)}}function e0t(t,e){return{type:"Point",coordinates:t.getCoordinates()}}function t0t(t,e){let n;return e&&(n=e.rightHanded),{type:"Polygon",coordinates:t.getCoordinates(n)}}const ZN="http://www.w3.org/2001/XMLSchema-instance";function xv(t,e){return Ab().createElementNS(t,e)}function kh(t,e){return Z2e(t,e,[]).join("")}function Z2e(t,e,n){if(t.nodeType==Node.CDATA_SECTION_NODE||t.nodeType==Node.TEXT_NODE)n.push(t.nodeValue);else{let r;for(r=t.firstChild;r;r=r.nextSibling)Z2e(r,e,n)}return n}function Yf(t){return"documentElement"in t}function Xf(t){return new DOMParser().parseFromString(t,"application/xml")}function xoe(t,e){return(function(n,r){const i=t.call(e??this,n,r);if(i!==void 0){const s=r[r.length-1];_r(s,i)}})}function nh(t,e){return(function(n,r){const i=t.call(e??this,n,r);i!==void 0&&r[r.length-1].push(i)})}function hq(t,e){return(function(n,r){const i=t.call(this,n,r);i!==void 0&&(r[r.length-1]=i)})}function Qe(t,e,n){return(function(r,i){const s=t.call(this,r,i);if(s!==void 0){const o=i[i.length-1],a=e!==void 0?e:r.localName;o[a]=s}})}function pt(t,e){return(function(n,r,i){t.call(this,n,r,i),i[i.length-1].node.appendChild(n)})}function J2e(t,e){let n,r;return function(i,s,o){if(n===void 0){n={};const a={};a[i.localName]=t,n[i.namespaceURI]=a,r=Ah(i.localName)}Q2e(n,r,s,o)}}function Ah(t,e){return(function(n,r,i){const o=r[r.length-1].node;let a=t;a===void 0&&(a=i);const l=o.namespaceURI;return xv(l,a)})}const va=Ah();function Pl(t,e){const n=e.length,r=new Array(n);for(let i=0;i<n;++i)r[i]=t[e[i]];return r}function It(t,e,n){n=n!==void 0?n:{};let r,i;for(r=0,i=t.length;r<i;++r)n[t[r]]=e;return n}function h0(t,e,n,r){let i;for(i=e.firstElementChild;i;i=i.nextElementSibling){const s=t[i.namespaceURI];if(s!==void 0){const o=s[i.localName];o!==void 0&&o.call(r,i,n)}}}function ir(t,e,n,r,i){return r.push(t),h0(e,n,r,i),r.pop()}function Q2e(t,e,n,r,i,s){const o=(i!==void 0?i:n).length;let a,l;for(let c=0;c<o;++c)a=n[c],a!==void 0&&(l=e.call(s,a,r,i!==void 0?i[c]:void 0),l!==void 0&&t[l.namespaceURI][l.localName].call(s,l,a,r))}function si(t,e,n,r,i,s,o){return i.push(t),Q2e(e,n,r,i,s,o),i.pop()}let J$;function n0t(){return J$===void 0&&typeof XMLSerializer<"u"&&(J$=new XMLSerializer),J$}let Q$;function Ab(){return Q$===void 0&&typeof document<"u"&&(Q$=document.implementation.createDocument("","",null)),Q$}class ebe extends Y2e{constructor(){super(),this.xmlSerializer_=n0t()}getType(){return"xml"}readFeature(e,n){if(!e)return null;if(typeof e=="string"){const r=Xf(e);return this.readFeatureFromDocument(r,n)}return Yf(e)?this.readFeatureFromDocument(e,n):this.readFeatureFromNode(e,n)}readFeatureFromDocument(e,n){const r=this.readFeaturesFromDocument(e,n);return r.length>0?r[0]:null}readFeatureFromNode(e,n){return null}readFeatures(e,n){if(!e)return[];if(typeof e=="string"){const r=Xf(e);return this.readFeaturesFromDocument(r,n)}return Yf(e)?this.readFeaturesFromDocument(e,n):this.readFeaturesFromNode(e,n)}readFeaturesFromDocument(e,n){const r=[];for(let i=e.firstChild;i;i=i.nextSibling)i.nodeType==Node.ELEMENT_NODE&&_r(r,this.readFeaturesFromNode(i,n));return r}readFeaturesFromNode(e,n){return bn()}readGeometry(e,n){if(!e)return null;if(typeof e=="string"){const r=Xf(e);return this.readGeometryFromDocument(r,n)}return Yf(e)?this.readGeometryFromDocument(e,n):this.readGeometryFromNode(e,n)}readGeometryFromDocument(e,n){return null}readGeometryFromNode(e,n){return null}readProjection(e){if(!e)return null;if(typeof e=="string"){const n=Xf(e);return this.readProjectionFromDocument(n)}return Yf(e)?this.readProjectionFromDocument(e):this.readProjectionFromNode(e)}readProjectionFromDocument(e){return this.dataProjection}readProjectionFromNode(e){return this.dataProjection}writeFeature(e,n){const r=this.writeFeatureNode(e,n);return this.xmlSerializer_.serializeToString(r)}writeFeatureNode(e,n){return null}writeFeatures(e,n){const r=this.writeFeaturesNode(e,n);return this.xmlSerializer_.serializeToString(r)}writeFeaturesNode(e,n){return null}writeGeometry(e,n){const r=this.writeGeometryNode(e,n);return this.xmlSerializer_.serializeToString(r)}writeGeometryNode(e,n){return null}}function Zg(t){const e=kh(t,!1);return r0t(e)}function r0t(t){const e=/^\s*(true|1)|(false|0)\s*$/.exec(t);if(e)return e[1]!==void 0||!1}function AL(t){const e=kh(t,!1),n=Date.parse(e);return isNaN(n)?void 0:n/1e3}function wr(t){const e=kh(t,!1);return i0t(e)}function i0t(t){const e=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*$/i.exec(t);if(e)return parseFloat(e[1])}function SA(t){const e=kh(t,!1);return s0t(e)}function s0t(t){const e=/^\s*(\d+)\s*$/.exec(t);if(e)return parseInt(e[1],10)}function Bn(t){return kh(t,!1).trim()}function G2(t,e){Ar(t,e?"1":"0")}function o0t(t,e){t.appendChild(Ab().createCDATASection(e))}function a0t(t,e){const n=new Date(e*1e3),r=n.getUTCFullYear()+"-"+gE(n.getUTCMonth()+1,2)+"-"+gE(n.getUTCDate(),2)+"T"+gE(n.getUTCHours(),2)+":"+gE(n.getUTCMinutes(),2)+":"+gE(n.getUTCSeconds(),2)+"Z";t.appendChild(Ab().createTextNode(r))}function pl(t,e){const n=e.toPrecision();t.appendChild(Ab().createTextNode(n))}function JN(t,e){const n=e.toString();t.appendChild(Ab().createTextNode(n))}const l0t=/^\s/,c0t=/\s$/,u0t=/(\n|\t|\r|<|&| {2})/;function Ar(t,e){typeof e=="string"&&(l0t.test(e)||c0t.test(e)||u0t.test(e))?e.split("]]>").forEach((n,r,i)=>{r<i.length-1&&(n+="]]"),r>0&&(n=">"+n),o0t(t,n)}):t.appendChild(Ab().createTextNode(e))}const fi=[null,"http://www.topografix.com/GPX/1/0","http://www.topografix.com/GPX/1/1"],h0t="http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd",d0t={rte:tbe,trk:nbe,wpt:rbe},f0t=It(fi,{rte:nh(tbe),trk:nh(nbe),wpt:nh(rbe)}),p0t=It(fi,{text:Qe(Bn,"linkText"),type:Qe(Bn,"linkType")}),m0t=It(fi,{name:Qe(Bn),email:G0t,link:ZI}),g0t=It(fi,{name:Qe(Bn),desc:Qe(Bn),author:Qe(F0t),copyright:Qe(V0t),link:ZI,time:Qe(AL),keywords:Qe(Bn),bounds:z0t,extensions:IL}),y0t=It(fi,{year:Qe(SA),license:Qe(Bn)}),v0t=It(fi,{rte:pt(H0t),trk:pt(q0t),wpt:pt(Y0t)});class _0t extends ebe{constructor(e){super(),e=e||{},this.dataProjection=Jr("EPSG:4326"),this.readExtensions_=e.readExtensions}handleReadExtensions_(e){e||(e=[]);for(let n=0,r=e.length;n<r;++n){const i=e[n];if(this.readExtensions_){const s=i.get("extensionsNode_")||null;this.readExtensions_(i,s)}i.set("extensionsNode_",void 0)}}readMetadata(e){return e?typeof e=="string"?this.readMetadataFromDocument(Xf(e)):Yf(e)?this.readMetadataFromDocument(e):this.readMetadataFromNode(e):null}readMetadataFromDocument(e){for(let n=e.firstChild;n;n=n.nextSibling)if(n.nodeType===Node.ELEMENT_NODE){const r=this.readMetadataFromNode(n);if(r)return r}return null}readMetadataFromNode(e){if(!fi.includes(e.namespaceURI))return null;for(let n=e.firstElementChild;n;n=n.nextElementSibling)if(fi.includes(n.namespaceURI)&&n.localName==="metadata")return ir({},g0t,n,[]);return null}readFeatureFromNode(e,n){if(!fi.includes(e.namespaceURI))return null;const r=d0t[e.localName];if(!r)return null;const i=r(e,[this.getReadOptions(e,n)]);return i?(this.handleReadExtensions_([i]),i):null}readFeaturesFromNode(e,n){if(!fi.includes(e.namespaceURI))return[];if(e.localName=="gpx"){const r=ir([],f0t,e,[this.getReadOptions(e,n)]);return r?(this.handleReadExtensions_(r),r):[]}return[]}writeFeaturesNode(e,n){n=this.adaptOptions(n);const r=xv("http://www.topografix.com/GPX/1/1","gpx");return r.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xsi",ZN),r.setAttributeNS(ZN,"xsi:schemaLocation",h0t),r.setAttribute("version","1.1"),r.setAttribute("creator","OpenLayers"),si({node:r},v0t,$0t,e,[n]),r}}const x0t=It(fi,{name:Qe(Bn),cmt:Qe(Bn),desc:Qe(Bn),src:Qe(Bn),link:ZI,number:Qe(SA),extensions:IL,type:Qe(Bn),rtept:U0t}),w0t=It(fi,{ele:Qe(wr),time:Qe(AL)}),b0t=It(fi,{name:Qe(Bn),cmt:Qe(Bn),desc:Qe(Bn),src:Qe(Bn),link:ZI,number:Qe(SA),type:Qe(Bn),extensions:IL,trkseg:W0t}),E0t=It(fi,{trkpt:B0t}),S0t=It(fi,{ele:Qe(wr),time:Qe(AL)}),T0t=It(fi,{ele:Qe(wr),time:Qe(AL),magvar:Qe(wr),geoidheight:Qe(wr),name:Qe(Bn),cmt:Qe(Bn),desc:Qe(Bn),src:Qe(Bn),link:ZI,sym:Qe(Bn),type:Qe(Bn),fix:Qe(Bn),sat:Qe(SA),hdop:Qe(wr),vdop:Qe(wr),pdop:Qe(wr),ageofdgpsdata:Qe(wr),dgpsid:Qe(SA),extensions:IL}),k0t=["text","type"],A0t=It(fi,{text:pt(Ar),type:pt(Ar)}),I0t=It(fi,["name","cmt","desc","src","link","number","type","rtept"]),P0t=It(fi,{name:pt(Ar),cmt:pt(Ar),desc:pt(Ar),src:pt(Ar),link:pt(pq),number:pt(JN),type:pt(Ar),rtept:J2e(pt(mq))}),C0t=It(fi,["ele","time"]),R0t=It(fi,["name","cmt","desc","src","link","number","type","trkseg"]),M0t=It(fi,{name:pt(Ar),cmt:pt(Ar),desc:pt(Ar),src:pt(Ar),link:pt(pq),number:pt(JN),type:pt(Ar),trkseg:J2e(pt(K0t))}),N0t=Ah("trkpt"),O0t=It(fi,{trkpt:pt(mq)}),L0t=It(fi,["ele","time","magvar","geoidheight","name","cmt","desc","src","link","sym","type","fix","sat","hdop","vdop","pdop","ageofdgpsdata","dgpsid"]),D0t=It(fi,{ele:pt(pl),time:pt(a0t),magvar:pt(pl),geoidheight:pt(pl),name:pt(Ar),cmt:pt(Ar),desc:pt(Ar),src:pt(Ar),link:pt(pq),sym:pt(Ar),type:pt(Ar),fix:pt(Ar),sat:pt(JN),hdop:pt(pl),vdop:pt(pl),pdop:pt(pl),ageofdgpsdata:pt(pl),dgpsid:pt(JN)}),j0t={Point:"wpt",LineString:"rte",MultiLineString:"trk"};function $0t(t,e,n){const r=t.getGeometry();if(r){const i=j0t[r.getType()];if(i){const s=e[e.length-1].node;return xv(s.namespaceURI,i)}}}function dq(t,e,n,r){return t.push(parseFloat(n.getAttribute("lon")),parseFloat(n.getAttribute("lat"))),"ele"in r?(t.push(r.ele),delete r.ele,e.hasZ=!0):t.push(0),"time"in r?(t.push(r.time),delete r.time,e.hasM=!0):t.push(0),t}function fq(t,e,n){let r="XY",i=2;if(t.hasZ&&t.hasM?(r="XYZM",i=4):t.hasZ?(r="XYZ",i=3):t.hasM&&(r="XYM",i=3),i!==4){for(let s=0,o=e.length/4;s<o;s++)e[s*i]=e[s*4],e[s*i+1]=e[s*4+1],t.hasZ&&(e[s*i+2]=e[s*4+2]),t.hasM&&(e[s*i+2]=e[s*4+3]);if(e.length=e.length/4*i,n)for(let s=0,o=n.length;s<o;s++)n[s]=n[s]/4*i}return r}function F0t(t,e){const n=ir({},m0t,t,e);if(n)return n}function V0t(t,e){const n=ir({},y0t,t,e);if(n){const r=t.getAttribute("author");return r!==null&&(n.author=r),n}}function z0t(t,e){const n=e[e.length-1],r=t.getAttribute("minlat"),i=t.getAttribute("minlon"),s=t.getAttribute("maxlat"),o=t.getAttribute("maxlon");i!==null&&r!==null&&o!==null&&s!==null&&(n.bounds=[[parseFloat(i),parseFloat(r)],[parseFloat(o),parseFloat(s)]])}function G0t(t,e){const n=e[e.length-1],r=t.getAttribute("id"),i=t.getAttribute("domain");r!==null&&i!==null&&(n.email=`${r}@${i}`)}function ZI(t,e){const n=e[e.length-1],r=t.getAttribute("href");r!==null&&(n.link=r),h0(p0t,t,e)}function IL(t,e){const n=e[e.length-1];n.extensionsNode_=t}function U0t(t,e){const n=ir({},w0t,t,e);if(n){const r=e[e.length-1],i=r.flatCoordinates,s=r.layoutOptions;dq(i,s,t,n)}}function B0t(t,e){const n=ir({},S0t,t,e);if(n){const r=e[e.length-1],i=r.flatCoordinates,s=r.layoutOptions;dq(i,s,t,n)}}function W0t(t,e){const n=e[e.length-1];h0(E0t,t,e);const r=n.flatCoordinates;n.ends.push(r.length)}function tbe(t,e){const n=e[0],r=ir({flatCoordinates:[],layoutOptions:{}},x0t,t,e);if(!r)return;const i=r.flatCoordinates;delete r.flatCoordinates;const s=r.layoutOptions;delete r.layoutOptions;const o=fq(s,i),a=new ts(i,o);Th(a,!1,n);const l=new gr(a);return l.setProperties(r,!0),l}function nbe(t,e){const n=e[0],r=ir({flatCoordinates:[],ends:[],layoutOptions:{}},b0t,t,e);if(!r)return;const i=r.flatCoordinates;delete r.flatCoordinates;const s=r.ends;delete r.ends;const o=r.layoutOptions;delete r.layoutOptions;const a=fq(o,i,s),l=new yh(i,a,s);Th(l,!1,n);const c=new gr(l);return c.setProperties(r,!0),c}function rbe(t,e){const n=e[0],r=ir({},T0t,t,e);if(!r)return;const i={},s=dq([],i,t,r),o=fq(i,s),a=new Ti(s,o);Th(a,!1,n);const l=new gr(a);return l.setProperties(r,!0),l}function pq(t,e,n){t.setAttribute("href",e);const i=n[n.length-1].properties,s=[i.linkText,i.linkType];si({node:t},A0t,va,s,n,k0t)}function mq(t,e,n){const r=n[n.length-1],s=r.node.namespaceURI,o=r.properties;switch(t.setAttributeNS(null,"lat",String(e[1])),t.setAttributeNS(null,"lon",String(e[0])),r.geometryLayout){case"XYZM":e[3]!==0&&(o.time=e[3]);case"XYZ":e[2]!==0&&(o.ele=e[2]);break;case"XYM":e[2]!==0&&(o.time=e[2]);break}const l=t.nodeName=="rtept"?C0t[s]:L0t[s],c=Pl(o,l);si({node:t,properties:o},D0t,va,c,n,l)}function H0t(t,e,n){const r=n[0],i=e.getProperties(),s={node:t};s.properties=i;const o=e.getGeometry();if(o.getType()=="LineString"){const u=Th(o,!0,r);s.geometryLayout=u.getLayout(),i.rtept=u.getCoordinates()}const a=n[n.length-1].node,l=I0t[a.namespaceURI],c=Pl(i,l);si(s,P0t,va,c,n,l)}function q0t(t,e,n){const r=n[0],i=e.getProperties(),s={node:t};s.properties=i;const o=e.getGeometry();if(o.getType()=="MultiLineString"){const u=Th(o,!0,r);i.trkseg=u.getLineStrings()}const a=n[n.length-1].node,l=R0t[a.namespaceURI],c=Pl(i,l);si(s,M0t,va,c,n,l)}function K0t(t,e,n){const r={node:t};r.geometryLayout=e.getLayout(),r.properties={},si(r,O0t,N0t,e.getCoordinates(),n)}function Y0t(t,e,n){const r=n[0],i=n[n.length-1];i.properties=e.getProperties();const s=e.getGeometry();if(s.getType()=="Point"){const o=Th(s,!0,r);i.geometryLayout=o.getLayout(),mq(t,o.getCoordinates(),n)}}const Pp=["http://www.google.com/kml/ext/2.2"],Xt=[null,"http://earth.google.com/kml/2.0","http://earth.google.com/kml/2.1","http://earth.google.com/kml/2.2","http://www.opengis.net/kml/2.2"],X0t="http://www.opengis.net/kml/2.2 https://developers.google.com/kml/schema/kml22gx.xsd",woe={fraction:"fraction",pixels:"pixels",insetPixels:"pixels"},Z0t=It(Xt,{ExtendedData:vbe,Region:_be,MultiGeometry:Qe(mbe,"geometry"),LineString:Qe(fbe,"geometry"),LinearRing:Qe(pbe,"geometry"),Point:Qe(gbe,"geometry"),Polygon:Qe(ybe,"geometry"),Style:Qe(vq),StyleMap:Oyt,address:Qe(Bn),description:Qe(Bn),name:Qe(Bn),open:Qe(Zg),phoneNumber:Qe(Bn),styleUrl:Qe(lbe),visibility:Qe(Zg)},It(Pp,{MultiTrack:Qe(wyt,"geometry"),Track:Qe(dbe,"geometry")})),J0t=It(Xt,{ExtendedData:vbe,Region:_be,Link:Hyt,address:Qe(Bn),description:Qe(Bn),name:Qe(Bn),open:Qe(Zg),phoneNumber:Qe(Bn),visibility:Qe(Zg)}),Q0t=It(Xt,{href:Qe(abe)}),eyt=It(Xt,{Altitude:Qe(wr),Longitude:Qe(wr),Latitude:Qe(wr),Tilt:Qe(wr),AltitudeMode:Qe(Bn),Heading:Qe(wr),Roll:Qe(wr)}),ibe=It(Xt,{LatLonAltBox:Fyt,Lod:zyt}),tyt=It(Xt,["Document","Placemark"]),nyt=It(Xt,{Document:pt(e1t),Placemark:pt(bbe)});let ww,k3=null,Rz,YT,XT,ZT,QN,Mz=null,gq,Nz=null,Oz,qy=null,boe=null,Lz=null;function e5(t){return 32/Math.min(t[0],t[1])}function ryt(){ww=[255,255,255,1],k3=new Dn({color:ww}),Rz=[20,2],YT="pixels",XT="pixels",ZT=[64,64],QN="https://maps.google.com/mapfiles/kml/pushpin/ylw-pushpin.png",Mz=new BA({anchor:Rz,anchorOrigin:"bottom-left",anchorXUnits:YT,anchorYUnits:XT,crossOrigin:"anonymous",rotation:0,scale:e5(ZT),size:ZT,src:QN}),gq="NO_IMAGE",Nz=new Pn({color:ww,width:1}),Oz=new Pn({color:[51,51,51,1],width:2}),qy=new fc({font:"bold 16px Helvetica",fill:k3,stroke:Oz,scale:.8}),boe=new vn({fill:k3,image:Mz,text:qy,stroke:Nz,zIndex:0}),Lz=[boe]}let AR;function iyt(t){return t}class syt extends ebe{constructor(e){super(),e=e||{},Lz||ryt(),this.dataProjection=Jr("EPSG:4326"),this.defaultStyle_=e.defaultStyle?e.defaultStyle:Lz,this.extractStyles_=e.extractStyles!==void 0?e.extractStyles:!0,this.writeStyles_=e.writeStyles!==void 0?e.writeStyles:!0,this.sharedStyles_={},this.showPointNames_=e.showPointNames!==void 0?e.showPointNames:!0,this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:"anonymous",this.iconUrlFunction_=e.iconUrlFunction?e.iconUrlFunction:iyt,this.supportedMediaTypes=["application/vnd.google-earth.kml+xml"]}readDocumentOrFolder_(e,n){const r=It(Xt,{Document:xoe(this.readDocumentOrFolder_,this),Folder:xoe(this.readDocumentOrFolder_,this),Placemark:nh(this.readPlacemark_,this),Style:this.readSharedStyle_.bind(this),StyleMap:this.readSharedStyleMap_.bind(this)}),i=ir([],r,e,n,this);if(i)return i}readPlacemark_(e,n){const r=ir({geometry:null},Z0t,e,n,this);if(!r)return;const i=new gr,s=e.getAttribute("id");s!==null&&i.setId(s);const o=n[0],a=r.geometry;if(a&&Th(a,!1,o),i.setGeometry(a),delete r.geometry,this.extractStyles_){const l=r.Style,c=r.styleUrl,u=ayt(l,c,this.defaultStyle_,this.sharedStyles_,this.showPointNames_);i.setStyle(u)}return delete r.Style,i.setProperties(r,!0),i}readSharedStyle_(e,n){const r=e.getAttribute("id");if(r!==null){const i=vq.call(this,e,n);if(i){let s,o=e.baseURI;(!o||o=="about:blank")&&(o=window.location.href),o?s=new URL("#"+r,o).href:s="#"+r,this.sharedStyles_[s]=i}}}readSharedStyleMap_(e,n){const r=e.getAttribute("id");if(r===null)return;const i=ube.call(this,e,n);if(!i)return;let s,o=e.baseURI;(!o||o=="about:blank")&&(o=window.location.href),o?s=new URL("#"+r,o).href:s="#"+r,this.sharedStyles_[s]=i}readFeatureFromNode(e,n){if(!Xt.includes(e.namespaceURI))return null;const r=this.readPlacemark_(e,[this.getReadOptions(e,n)]);return r||null}readFeaturesFromNode(e,n){if(!Xt.includes(e.namespaceURI))return[];let r;const i=e.localName;if(i=="Document"||i=="Folder")return r=this.readDocumentOrFolder_(e,[this.getReadOptions(e,n)]),r||[];if(i=="Placemark"){const s=this.readPlacemark_(e,[this.getReadOptions(e,n)]);return s?[s]:[]}if(i=="kml"){r=[];for(let s=e.firstElementChild;s;s=s.nextElementSibling){const o=this.readFeaturesFromNode(s,n);o&&_r(r,o)}return r}return[]}readName(e){if(e){if(typeof e=="string"){const n=Xf(e);return this.readNameFromDocument(n)}return Yf(e)?this.readNameFromDocument(e):this.readNameFromNode(e)}}readNameFromDocument(e){for(let n=e.firstChild;n;n=n.nextSibling)if(n.nodeType==Node.ELEMENT_NODE){const r=this.readNameFromNode(n);if(r)return r}}readNameFromNode(e){for(let n=e.firstElementChild;n;n=n.nextElementSibling)if(Xt.includes(n.namespaceURI)&&n.localName=="name")return Bn(n);for(let n=e.firstElementChild;n;n=n.nextElementSibling){const r=n.localName;if(Xt.includes(n.namespaceURI)&&(r=="Document"||r=="Folder"||r=="Placemark"||r=="kml")){const i=this.readNameFromNode(n);if(i)return i}}}readNetworkLinks(e){const n=[];if(typeof e=="string"){const r=Xf(e);_r(n,this.readNetworkLinksFromDocument(r))}else Yf(e)?_r(n,this.readNetworkLinksFromDocument(e)):_r(n,this.readNetworkLinksFromNode(e));return n}readNetworkLinksFromDocument(e){const n=[];for(let r=e.firstChild;r;r=r.nextSibling)r.nodeType==Node.ELEMENT_NODE&&_r(n,this.readNetworkLinksFromNode(r));return n}readNetworkLinksFromNode(e){const n=[];for(let r=e.firstElementChild;r;r=r.nextElementSibling)if(Xt.includes(r.namespaceURI)&&r.localName=="NetworkLink"){const i=ir({},J0t,r,[]);n.push(i)}for(let r=e.firstElementChild;r;r=r.nextElementSibling){const i=r.localName;Xt.includes(r.namespaceURI)&&(i=="Document"||i=="Folder"||i=="kml")&&_r(n,this.readNetworkLinksFromNode(r))}return n}readRegion(e){const n=[];if(typeof e=="string"){const r=Xf(e);_r(n,this.readRegionFromDocument(r))}else Yf(e)?_r(n,this.readRegionFromDocument(e)):_r(n,this.readRegionFromNode(e));return n}readRegionFromDocument(e){const n=[];for(let r=e.firstChild;r;r=r.nextSibling)r.nodeType==Node.ELEMENT_NODE&&_r(n,this.readRegionFromNode(r));return n}readRegionFromNode(e){const n=[];for(let r=e.firstElementChild;r;r=r.nextElementSibling)if(Xt.includes(r.namespaceURI)&&r.localName=="Region"){const i=ir({},ibe,r,[]);n.push(i)}for(let r=e.firstElementChild;r;r=r.nextElementSibling){const i=r.localName;Xt.includes(r.namespaceURI)&&(i=="Document"||i=="Folder"||i=="kml")&&_r(n,this.readRegionFromNode(r))}return n}readCamera(e){const n=[];if(typeof e=="string"){const r=Xf(e);_r(n,this.readCameraFromDocument(r))}else Yf(e)?_r(n,this.readCameraFromDocument(e)):_r(n,this.readCameraFromNode(e));return n}readCameraFromDocument(e){const n=[];for(let r=e.firstChild;r;r=r.nextSibling)r.nodeType===Node.ELEMENT_NODE&&_r(n,this.readCameraFromNode(r));return n}readCameraFromNode(e){const n=[];for(let r=e.firstElementChild;r;r=r.nextElementSibling)if(Xt.includes(r.namespaceURI)&&r.localName==="Camera"){const i=ir({},eyt,r,[]);n.push(i)}for(let r=e.firstElementChild;r;r=r.nextElementSibling){const i=r.localName;Xt.includes(r.namespaceURI)&&(i==="Document"||i==="Folder"||i==="Placemark"||i==="kml")&&_r(n,this.readCameraFromNode(r))}return n}writeFeaturesNode(e,n){n=this.adaptOptions(n);const r=xv(Xt[4],"kml"),i="http://www.w3.org/2000/xmlns/";r.setAttributeNS(i,"xmlns:gx",Pp[0]),r.setAttributeNS(i,"xmlns:xsi",ZN),r.setAttributeNS(ZN,"xsi:schemaLocation",X0t);const s={node:r},o={};e.length>1?o.Document=e:e.length==1&&(o.Placemark=e[0]);const a=tyt[r.namespaceURI],l=Pl(o,a);return si(s,nyt,va,l,[n],a,this),r}}function oyt(t,e){const n=[0,0];let r="start";const i=t.getImage();if(i){const a=i.getSize();if(a&&a.length==2){const l=i.getScaleArray(),c=i.getAnchor();n[0]=l[0]*(a[0]-c[0]),n[1]=l[1]*(a[1]/2-c[1]),r="left"}}let s=t.getText();return s?(s=s.clone(),s.setFont(s.getFont()||qy.getFont()),s.setScale(s.getScale()||qy.getScale()),s.setFill(s.getFill()||qy.getFill()),s.setStroke(s.getStroke()||Oz)):s=qy.clone(),s.setText(e),s.setOffsetX(n[0]),s.setOffsetY(n[1]),s.setTextAlign(r),new vn({image:i,text:s})}function ayt(t,e,n,r,i){return(function(s,o){let a=i,l="",c=[];if(a){const h=s.getGeometry();if(h)if(h instanceof cu)c=h.getGeometriesArrayRecursive().filter(function(f){const g=f.getType();return g==="Point"||g==="MultiPoint"}),a=c.length>0;else{const f=h.getType();a=f==="Point"||f==="MultiPoint"}}a&&(l=s.get("name"),a=a&&!!l,a&&/&[^&]+;/.test(l)&&(AR||(AR=document.createElement("textarea")),AR.innerHTML=l,l=AR.value));let u=n;if(t?u=t:e&&(u=sbe(e,n,r)),a){const h=oyt(u[0],l);if(c.length>0){h.setGeometry(new cu(c));const f=new vn({geometry:u[0].getGeometry(),image:null,fill:u[0].getFill(),stroke:u[0].getStroke(),text:null});return[h,f].concat(u.slice(1))}return h}return u})}function sbe(t,e,n){return Array.isArray(t)?t:typeof t=="string"?sbe(n[t],e,n):e}function PL(t){const e=kh(t,!1),n=/^\s*#?\s*([0-9A-Fa-f]{8})\s*$/.exec(e);if(n){const r=n[1];return[parseInt(r.substr(6,2),16),parseInt(r.substr(4,2),16),parseInt(r.substr(2,2),16),parseInt(r.substr(0,2),16)/255]}}function obe(t){let e=kh(t,!1);const n=[];e=e.replace(/\s*,\s*/g,",");const r=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?),([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s+|,|$)(?:([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s+|$))?\s*/i;let i;for(;i=r.exec(e);){const s=parseFloat(i[1]),o=parseFloat(i[2]),a=i[3]?parseFloat(i[3]):0;n.push(s,o,a),e=e.substr(i[0].length)}if(e==="")return n}function abe(t){const e=kh(t,!1).trim();let n=t.baseURI;return(!n||n=="about:blank")&&(n=window.location.href),n?new URL(e,n).href:e}function lbe(t){const e=kh(t,!1).trim().replace(/^(?!.*#)/,"#");let n=t.baseURI;return(!n||n=="about:blank")&&(n=window.location.href),n?new URL(e,n).href:e}function lyt(t){const e=t.getAttribute("xunits"),n=t.getAttribute("yunits");let r;return e!=="insetPixels"?n!=="insetPixels"?r="bottom-left":r="top-left":n!=="insetPixels"?r="bottom-right":r="top-right",{x:parseFloat(t.getAttribute("x")),xunits:woe[e],y:parseFloat(t.getAttribute("y")),yunits:woe[n],origin:r}}function cbe(t){return wr(t)}const cyt=It(Xt,{Pair:Nyt});function ube(t,e){return ir(void 0,cyt,t,e,this)}const uyt=It(Xt,{Icon:Qe(Syt),color:Qe(PL),heading:Qe(wr),hotSpot:Qe(lyt),scale:Qe(cbe)});function hyt(t,e){const n=ir({},uyt,t,e);if(!n)return;const r=e[e.length-1],i="Icon"in n?n.Icon:{},s=!("Icon"in n)||Object.keys(i).length>0;let o;const a=i.href;a?o=a:s&&(o=QN);let l,c,u,h="bottom-left";const f=n.hotSpot;f?(l=[f.x,f.y],c=f.xunits,u=f.yunits,h=f.origin):/^https?:\/\/maps\.(?:google|gstatic)\.com\//.test(o)&&(o.includes("pushpin")?(l=Rz,c=YT,u=XT):o.includes("arrow-reverse")?(l=[54,42],c=YT,u=XT):o.includes("paddle")&&(l=[32,1],c=YT,u=XT));let g;const y=i.x,_=i.y;y!==void 0&&_!==void 0&&(g=[y,_]);let b;const T=i.w,A=i.h;T!==void 0&&A!==void 0&&(b=[T,A]);let I;const P=n.heading;P!==void 0&&(I=au(P));const R=n.scale,D=n.color;if(s){o==QN&&(b=ZT);const C=new BA({anchor:l,anchorOrigin:h,anchorXUnits:c,anchorYUnits:u,crossOrigin:this.crossOrigin_,offset:g,offsetOrigin:"bottom-left",rotation:I,scale:R,size:b,src:this.iconUrlFunction_(o),color:D}),M=C.getScaleArray()[0],O=C.getSize();if(O===null){const j=C.getImageState();if(j===Vt.IDLE||j===Vt.LOADING){const V=function(){const U=C.getImageState();if(!(U===Vt.IDLE||U===Vt.LOADING)){const G=C.getSize();if(G&&G.length==2){const de=e5(G);C.setScale(M*de)}C.unlistenImageChange(V)}};C.listenImageChange(V),j===Vt.IDLE&&C.load()}}else if(O.length==2){const j=e5(O);C.setScale(M*j)}r.imageStyle=C}else r.imageStyle=gq}const dyt=It(Xt,{color:Qe(PL),scale:Qe(cbe)});function fyt(t,e){const n=ir({},dyt,t,e);if(!n)return;const r=e[e.length-1],i=new fc({fill:new Dn({color:"color"in n?n.color:ww}),scale:n.scale});r.textStyle=i}const pyt=It(Xt,{color:Qe(PL),width:Qe(wr)});function myt(t,e){const n=ir({},pyt,t,e);if(!n)return;const r=e[e.length-1],i=new Pn({color:"color"in n?n.color:ww,width:"width"in n?n.width:1});r.strokeStyle=i}const gyt=It(Xt,{color:Qe(PL),fill:Qe(Zg),outline:Qe(Zg)});function yyt(t,e){const n=ir({},gyt,t,e);if(!n)return;const r=e[e.length-1],i=new Dn({color:"color"in n?n.color:ww});r.fillStyle=i;const s=n.fill;s!==void 0&&(r.fill=s);const o=n.outline;o!==void 0&&(r.outline=o)}const vyt=It(Xt,{coordinates:hq(obe)});function hbe(t,e){return ir(null,vyt,t,e)}function _yt(t,e){const r=e[e.length-1].coordinates,i=kh(t,!1),o=/^\s*([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s*$/i.exec(i);if(o){const a=parseFloat(o[1]),l=parseFloat(o[2]),c=parseFloat(o[3]);r.push([a,l,c])}else r.push([])}const xyt=It(Pp,{Track:nh(dbe)});function wyt(t,e){const n=ir([],xyt,t,e);if(n)return new yh(n)}const byt=It(Xt,{when:qyt},It(Pp,{coord:_yt}));function dbe(t,e){const n=ir({coordinates:[],whens:[]},byt,t,e);if(!n)return;const r=[],i=n.coordinates,s=n.whens;for(let o=0,a=Math.min(i.length,s.length);o<a;++o)i[o].length==3&&r.push(i[o][0],i[o][1],i[o][2],s[o]);return new ts(r,"XYZM")}const Eyt=It(Xt,{href:Qe(abe)},It(Pp,{x:Qe(wr),y:Qe(wr),w:Qe(wr),h:Qe(wr)}));function Syt(t,e){const n=ir({},Eyt,t,e);return n||null}const Tyt=It(Xt,{coordinates:hq(obe)});function yq(t,e){return ir(null,Tyt,t,e)}const CL=It(Xt,{extrude:Qe(Zg),tessellate:Qe(Zg),altitudeMode:Qe(Bn)});function fbe(t,e){const n=ir({},CL,t,e),r=yq(t,e);if(r){const i=new ts(r,"XYZ");return i.setProperties(n,!0),i}}function pbe(t,e){const n=ir({},CL,t,e),r=yq(t,e);if(r){const i=new kl(r,"XYZ",[r.length]);return i.setProperties(n,!0),i}}const kyt=It(Xt,{LineString:nh(fbe),LinearRing:nh(pbe),MultiGeometry:nh(mbe),Point:nh(gbe),Polygon:nh(ybe)});function mbe(t,e){const n=ir([],kyt,t,e);if(!n)return null;if(n.length===0)return new cu(n);let r,i=!0;const s=n[0].getType();let o;for(let a=1,l=n.length;a<l;++a)if(o=n[a],o.getType()!=s){i=!1;break}if(i){let a,l;if(s=="Point"){const c=n[0];a=c.getLayout(),l=c.getFlatCoordinates();for(let u=1,h=n.length;u<h;++u)o=n[u],_r(l,o.getFlatCoordinates());r=new n0(l,a),eF(r,n)}else if(s=="LineString")r=new yh(n),eF(r,n);else if(s=="Polygon")r=new hp(n),eF(r,n);else if(s=="GeometryCollection"||s.startsWith("Multi"))r=new cu(n);else throw new Error("Unknown geometry type found")}else r=new cu(n);return r}function gbe(t,e){const n=ir({},CL,t,e),r=yq(t,e);if(r){const i=new Ti(r,"XYZ");return i.setProperties(n,!0),i}}const Ayt=It(Xt,{innerBoundaryIs:Uyt,outerBoundaryIs:Wyt});function ybe(t,e){const n=ir({},CL,t,e),r=ir([null],Ayt,t,e);if(r&&r[0]){const i=r[0],s=[i.length];for(let a=1,l=r.length;a<l;++a)_r(i,r[a]),s.push(i.length);const o=new kl(i,"XYZ",s);return o.setProperties(n,!0),o}}const Iyt=It(Xt,{IconStyle:hyt,LabelStyle:fyt,LineStyle:myt,PolyStyle:yyt});function vq(t,e){const n=ir({},Iyt,t,e,this);if(!n)return null;let r="fillStyle"in n?n.fillStyle:k3;const i=n.fill;i!==void 0&&!i&&(r=null);let s;"imageStyle"in n?n.imageStyle!=gq&&(s=n.imageStyle):s=Mz;const o="textStyle"in n?n.textStyle:qy,a="strokeStyle"in n?n.strokeStyle:Nz,l=n.outline;return l!==void 0&&!l?[new vn({geometry:function(c){const u=c.getGeometry(),h=u.getType();if(h==="GeometryCollection"){const f=u;return new cu(f.getGeometriesArrayRecursive().filter(function(g){const y=g.getType();return y!=="Polygon"&&y!=="MultiPolygon"}))}if(h!=="Polygon"&&h!=="MultiPolygon")return u},fill:r,image:s,stroke:a,text:o,zIndex:void 0}),new vn({geometry:function(c){const u=c.getGeometry(),h=u.getType();if(h==="GeometryCollection"){const f=u;return new cu(f.getGeometriesArrayRecursive().filter(function(g){const y=g.getType();return y==="Polygon"||y==="MultiPolygon"}))}if(h==="Polygon"||h==="MultiPolygon")return u},fill:r,stroke:null,zIndex:void 0})]:[new vn({fill:r,image:s,stroke:a,text:o,zIndex:void 0})]}function eF(t,e){const n=e.length,r=new Array(e.length),i=new Array(e.length),s=new Array(e.length);let o,a,l;o=!1,a=!1,l=!1;for(let c=0;c<n;++c){const u=e[c];r[c]=u.get("extrude"),i[c]=u.get("tessellate"),s[c]=u.get("altitudeMode"),o=o||r[c]!==void 0,a=a||i[c]!==void 0,l=l||s[c]}o&&t.set("extrude",r),a&&t.set("tessellate",i),l&&t.set("altitudeMode",s)}const Pyt=It(Xt,{displayName:Qe(Bn),value:Qe(Bn)});function Cyt(t,e){const n=t.getAttribute("name");h0(Pyt,t,e);const r=e[e.length-1];n&&r.displayName?r[n]={value:r.value,displayName:r.displayName,toString:function(){return r.value}}:n!==null?r[n]=r.value:r.displayName!==null&&(r[r.displayName]=r.value),delete r.value}const Ryt=It(Xt,{Data:Cyt,SchemaData:Dyt});function vbe(t,e){h0(Ryt,t,e)}function _be(t,e){h0(ibe,t,e)}const Myt=It(Xt,{Style:Qe(vq),key:Qe(Bn),styleUrl:Qe(lbe)});function Nyt(t,e){const n=ir({},Myt,t,e,this);if(!n)return;const r=n.key;if(r&&r=="normal"){const i=n.styleUrl;i&&(e[e.length-1]=i);const s=n.Style;s&&(e[e.length-1]=s)}}function Oyt(t,e){const n=ube.call(this,t,e);if(!n)return;const r=e[e.length-1];if(Array.isArray(n))r.Style=n;else if(typeof n=="string")r.styleUrl=n;else throw new Error("`styleMapValue` has an unknown type")}const Lyt=It(Xt,{SimpleData:jyt});function Dyt(t,e){h0(Lyt,t,e)}function jyt(t,e){const n=t.getAttribute("name");if(n!==null){const r=Bn(t),i=e[e.length-1];i[n]=r}}const $yt=It(Xt,{altitudeMode:Qe(Bn),minAltitude:Qe(wr),maxAltitude:Qe(wr),north:Qe(wr),south:Qe(wr),east:Qe(wr),west:Qe(wr)});function Fyt(t,e){const n=ir({},$yt,t,e);if(!n)return;const r=e[e.length-1],i=[parseFloat(n.west),parseFloat(n.south),parseFloat(n.east),parseFloat(n.north)];r.extent=i,r.altitudeMode=n.altitudeMode,r.minAltitude=parseFloat(n.minAltitude),r.maxAltitude=parseFloat(n.maxAltitude)}const Vyt=It(Xt,{minLodPixels:Qe(wr),maxLodPixels:Qe(wr),minFadeExtent:Qe(wr),maxFadeExtent:Qe(wr)});function zyt(t,e){const n=ir({},Vyt,t,e);if(!n)return;const r=e[e.length-1];r.minLodPixels=parseFloat(n.minLodPixels),r.maxLodPixels=parseFloat(n.maxLodPixels),r.minFadeExtent=parseFloat(n.minFadeExtent),r.maxFadeExtent=parseFloat(n.maxFadeExtent)}const Gyt=It(Xt,{LinearRing:nh(hbe)});function Uyt(t,e){const n=ir([],Gyt,t,e);n.length>0&&e[e.length-1].push(...n)}const Byt=It(Xt,{LinearRing:hq(hbe)});function Wyt(t,e){const n=ir(void 0,Byt,t,e);if(n){const r=e[e.length-1];r[0]=n}}function Hyt(t,e){h0(Q0t,t,e)}function qyt(t,e){const r=e[e.length-1].whens,i=kh(t,!1),s=Date.parse(i);r.push(isNaN(s)?0:s)}function RL(t,e){const n=mu(e),i=[(n.length==4?n[3]:1)*255,n[2],n[1],n[0]];for(let s=0;s<4;++s){const o=Math.floor(i[s]).toString(16);i[s]=o.length==1?"0"+o:o}Ar(t,i.join(""))}function Kyt(t,e,n){const r=n[n.length-1],i=r.layout,s=r.stride;let o;if(i=="XY"||i=="XYM")o=2;else if(i=="XYZ"||i=="XYZM")o=3;else throw new Error("Invalid geometry layout");const a=e.length;let l="";if(a>0){l+=e[0];for(let c=1;c<o;++c)l+=","+e[c];for(let c=s;c<a;c+=s){l+=" "+e[c];for(let u=1;u<o;++u)l+=","+e[c+u]}}Ar(t,l)}const A3=It(Xt,{Data:pt(Yyt),value:pt(Zyt),displayName:pt(Xyt)});function Yyt(t,e,n){t.setAttribute("name",e.name);const r={node:t},i=e.value;typeof i=="object"?(i!==null&&i.displayName&&si(r,A3,va,[i.displayName],n,["displayName"]),i!==null&&i.value&&si(r,A3,va,[i.value],n,["value"])):si(r,A3,va,[i],n,["value"])}function Xyt(t,e){Ar(t,e)}function Zyt(t,e){Ar(t,e)}const Jyt=It(Xt,{Placemark:pt(bbe)}),Qyt=function(t,e,n){const r=e[e.length-1].node;return xv(r.namespaceURI,"Placemark")};function e1t(t,e,n){si({node:t},Jyt,Qyt,e,n,void 0,this)}const t1t=Ah("Data");function n1t(t,e,n){const r={node:t},i=e.names,s=e.values,o=i.length;for(let a=0;a<o;a++)si(r,A3,t1t,[{name:i[a],value:s[a]}],n)}const Eoe=It(Xt,["href"],It(Pp,["x","y","w","h"])),Soe=It(Xt,{href:pt(Ar)},It(Pp,{x:pt(pl),y:pt(pl),w:pt(pl),h:pt(pl)})),r1t=function(t,e,n){return xv(Pp[0],"gx:"+n)};function i1t(t,e,n){const r={node:t},i=n[n.length-1].node;let s=Eoe[i.namespaceURI],o=Pl(e,s);si(r,Soe,va,o,n,s),s=Eoe[Pp[0]],o=Pl(e,s),si(r,Soe,r1t,o,n,s)}const s1t=It(Xt,["scale","heading","Icon","color","hotSpot"]),o1t=It(Xt,{Icon:pt(i1t),color:pt(RL),heading:pt(pl),hotSpot:pt(N1t),scale:pt(Sbe)});function a1t(t,e,n){const r={node:t},i={},s=e.getSrc(),o=e.getSize(),a=e.getImageSize(),l={href:s};if(o){l.w=o[0],l.h=o[1];const b=e.getAnchor(),T=e.getOrigin();if(T&&a&&T[0]!==0&&T[1]!==o[1]&&(l.x=T[0],l.y=a[1]-(T[1]+o[1])),b&&(b[0]!==o[0]/2||b[1]!==o[1]/2)){const A={x:b[0],xunits:"pixels",y:o[1]-b[1],yunits:"pixels"};i.hotSpot=A}}i.Icon=l;let c=e.getScaleArray()[0],u=o;if(u===null&&(u=ZT),u.length==2){const b=e5(u);c=c/b}c!==1&&(i.scale=c);const h=e.getRotation();h!==0&&(i.heading=h);const f=e.getColor();f&&(i.color=f);const g=n[n.length-1].node,y=s1t[g.namespaceURI],_=Pl(i,y);si(r,o1t,va,_,n,y)}const l1t=It(Xt,["color","scale"]),c1t=It(Xt,{color:pt(RL),scale:pt(Sbe)});function u1t(t,e,n){const r={node:t},i={},s=e.getFill();s&&(i.color=s.getColor());const o=e.getScale();o&&o!==1&&(i.scale=o);const a=n[n.length-1].node,l=l1t[a.namespaceURI],c=Pl(i,l);si(r,c1t,va,c,n,l)}const h1t=It(Xt,["color","width"]),d1t=It(Xt,{color:pt(RL),width:pt(pl)});function f1t(t,e,n){const r={node:t},i={color:e.getColor(),width:Number(e.getWidth())||1},s=n[n.length-1].node,o=h1t[s.namespaceURI],a=Pl(i,o);si(r,d1t,va,a,n,o)}const p1t={Point:"Point",LineString:"LineString",LinearRing:"LinearRing",Polygon:"Polygon",MultiPoint:"MultiGeometry",MultiLineString:"MultiGeometry",MultiPolygon:"MultiGeometry",GeometryCollection:"MultiGeometry"},xbe=function(t,e,n){if(t){const r=e[e.length-1].node;return xv(r.namespaceURI,p1t[t.getType()])}},m1t=Ah("Point"),g1t=Ah("LineString"),y1t=Ah("LinearRing"),v1t=Ah("Polygon"),_1t=It(Xt,{LineString:pt(bw),Point:pt(bw),Polygon:pt(Ebe),GeometryCollection:pt(wbe)});function wbe(t,e,n){const r={node:t},i=e.getType();let s=[],o;if(i==="GeometryCollection")e.getGeometriesArrayRecursive().forEach(function(a){const l=a.getType();if(l==="MultiPoint")s=s.concat(a.getPoints());else if(l==="MultiLineString")s=s.concat(a.getLineStrings());else if(l==="MultiPolygon")s=s.concat(a.getPolygons());else if(l==="Point"||l==="LineString"||l==="Polygon")s.push(a);else throw new Error("Unknown geometry type")}),o=xbe;else if(i==="MultiPoint")s=e.getPoints(),o=m1t;else if(i==="MultiLineString")s=e.getLineStrings(),o=g1t;else if(i==="MultiPolygon")s=e.getPolygons(),o=v1t;else throw new Error("Unknown geometry type");si(r,_1t,o,s,n)}const x1t=It(Xt,{LinearRing:pt(bw)});function Toe(t,e,n){si({node:t},x1t,y1t,[e],n)}const tF=It(Xt,{ExtendedData:pt(n1t),MultiGeometry:pt(wbe),LineString:pt(bw),LinearRing:pt(bw),Point:pt(bw),Polygon:pt(Ebe),Style:pt(M1t),address:pt(Ar),description:pt(Ar),name:pt(Ar),open:pt(G2),phoneNumber:pt(Ar),styleUrl:pt(Ar),visibility:pt(G2)}),w1t=It(Xt,["name","open","visibility","address","phoneNumber","description","styleUrl","Style"]),b1t=Ah("ExtendedData");function bbe(t,e,n){const r={node:t};e.getId()&&t.setAttribute("id",e.getId());const i=e.getProperties(),s={address:1,description:1,name:1,open:1,phoneNumber:1,styleUrl:1,visibility:1};s[e.getGeometryName()]=1;const o=Object.keys(i||{}).sort().filter(function(g){return!s[g]}),a=e.getStyleFunction();if(a){const g=a(e,0);if(g){const y=Array.isArray(g)?g:[g];let _=y;if(e.getGeometry()&&(_=y.filter(function(b){const T=b.getGeometryFunction()(e);if(T){const A=T.getType();return A==="GeometryCollection"?T.getGeometriesArrayRecursive().filter(function(I){const P=I.getType();return P==="Point"||P==="MultiPoint"}).length:A==="Point"||A==="MultiPoint"}})),this.writeStyles_){let b=y,T=y;e.getGeometry()&&(b=y.filter(function(A){const I=A.getGeometryFunction()(e);if(I){const P=I.getType();return P==="GeometryCollection"?I.getGeometriesArrayRecursive().filter(function(R){const D=R.getType();return D==="LineString"||D==="MultiLineString"}).length:P==="LineString"||P==="MultiLineString"}}),T=y.filter(function(A){const I=A.getGeometryFunction()(e);if(I){const P=I.getType();return P==="GeometryCollection"?I.getGeometriesArrayRecursive().filter(function(R){const D=R.getType();return D==="Polygon"||D==="MultiPolygon"}).length:P==="Polygon"||P==="MultiPolygon"}})),i.Style={pointStyles:_,lineStyles:b,polyStyles:T}}if(_.length&&i.name===void 0){const b=_[0].getText();b&&(i.name=b.getText())}}}const l=n[n.length-1].node,c=w1t[l.namespaceURI],u=Pl(i,c);if(si(r,tF,va,u,n,c),o.length>0){const g=Pl(i,o);si(r,tF,b1t,[{names:o,values:g}],n)}const h=n[0];let f=e.getGeometry();f&&(f=Th(f,!0,h)),si(r,tF,xbe,[f],n)}const E1t=It(Xt,["extrude","tessellate","altitudeMode","coordinates"]),S1t=It(Xt,{extrude:pt(G2),tessellate:pt(G2),altitudeMode:pt(Ar),coordinates:pt(Kyt)});function bw(t,e,n){const r=e.getFlatCoordinates(),i={node:t};i.layout=e.getLayout(),i.stride=e.getStride();const s=e.getProperties();s.coordinates=r;const o=n[n.length-1].node,a=E1t[o.namespaceURI],l=Pl(s,a);si(i,S1t,va,l,n,a)}const T1t=It(Xt,["color","fill","outline"]),koe=It(Xt,{outerBoundaryIs:pt(Toe),innerBoundaryIs:pt(Toe)}),k1t=Ah("innerBoundaryIs"),A1t=Ah("outerBoundaryIs");function Ebe(t,e,n){const r=e.getLinearRings(),i=r.shift(),s={node:t};si(s,koe,k1t,r,n),si(s,koe,A1t,[i],n)}const I1t=It(Xt,{color:pt(RL),fill:pt(G2),outline:pt(G2)});function P1t(t,e,n){const r={node:t},i=e.getFill(),s=e.getStroke(),o={color:i?i.getColor():void 0,fill:i?void 0:!1,outline:s?void 0:!1},a=n[n.length-1].node,l=T1t[a.namespaceURI],c=Pl(o,l);si(r,I1t,va,c,n,l)}function Sbe(t,e){pl(t,Math.round(e*1e6)/1e6)}const C1t=It(Xt,["IconStyle","LabelStyle","LineStyle","PolyStyle"]),R1t=It(Xt,{IconStyle:pt(a1t),LabelStyle:pt(u1t),LineStyle:pt(f1t),PolyStyle:pt(P1t)});function M1t(t,e,n){const r={node:t},i={};if(e.pointStyles.length){const l=e.pointStyles[0].getText();l&&(i.LabelStyle=l);const c=e.pointStyles[0].getImage();c&&typeof c.getSrc=="function"&&(i.IconStyle=c)}if(e.lineStyles.length){const l=e.lineStyles[0].getStroke();l&&(i.LineStyle=l)}if(e.polyStyles.length){const l=e.polyStyles[0].getStroke();l&&!i.LineStyle&&(i.LineStyle=l),i.PolyStyle=e.polyStyles[0]}const s=n[n.length-1].node,o=C1t[s.namespaceURI],a=Pl(i,o);si(r,R1t,va,a,n,o)}function N1t(t,e){t.setAttribute("x",String(e.x)),t.setAttribute("y",String(e.y)),t.setAttribute("xunits",e.xunits),t.setAttribute("yunits",e.yunits)}function Tbe(t){const e=Object.keys(t.defs),n=e.length;let r,i;for(r=0;r<n;++r){const s=e[r];if(!KR(s)){const o=t.defs(s);let a=o.units;!a&&o.projName==="longlat"&&(a="degrees"),N3(new b5({code:s,axisOrientation:o.axis,metersPerUnit:o.to_meter,units:a}))}}for(r=0;r<n;++r){const s=e[r],o=KR(s);for(i=0;i<n;++i){const a=e[i],l=KR(a);if(!YR(s,a))if(t.defs[s]===t.defs[a])NF([o,l]);else{const c=t(s,a);Tke(o,l,wX(o,l,c.forward),wX(l,o,c.inverse))}}}}console.log(" parcelHighlight.ts v3.1 loaded - fixed pixelRatio for Android");lr.defs("EPSG:28992","+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m +no_defs");Tbe(lr);let Ky=null,JT=null,_x=null;function Dz(t){Ky&&(t.removeLayer(Ky),Ky=null),JT&&(t.removeLayer(JT),JT=null),_x=null}async function O1t(t,e){try{const n=Fn(e);console.log(` Click (3857): ${e[0].toFixed(0)}, ${e[1].toFixed(0)}`),console.log(` LonLat (WGS84): ${n[0].toFixed(5)}, ${n[1].toFixed(5)}`);const r=lr("EPSG:4326","EPSG:28992",n);if(console.log(` RD (28992): ${r?r[0].toFixed(0)+", "+r[1].toFixed(0):"FAILED"}`),!r||r[0]<7e3||r[0]>3e5||r[1]<289e3||r[1]>629e3)return console.error(" Coordinate outside Netherlands or transformation failed:",r),!1;Dz(t);const i=1,s=`${r[0]-i},${r[1]-i},${r[0]+i},${r[1]+i}`,o=Date.now(),a=`https://service.pdok.nl/rvo/brpgewaspercelen/wfs/v1_0?SERVICE=WFS&VERSION=2.0.0&REQUEST=GetFeature&TYPENAMES=brpgewaspercelen:BrpGewas&OUTPUTFORMAT=json&SRSNAME=EPSG:28992&BBOX=${s},EPSG:28992&_=${o}`;console.log(" WFS URL:",a);const l=new AbortController,c=setTimeout(()=>l.abort(),1e4),u=await fetch(a,{signal:l.signal});if(clearTimeout(c),!u.ok)return console.error("WFS request failed:",u.status),!1;const h=await u.json();if(console.log(" WFS RESPONSE:",JSON.stringify(h).substring(0,500)),!h.features||h.features.length===0)return console.log("No parcel found at location"),!1;const f=h.features[0];console.log(" PARCEL ID:",f.id||f.properties?.id||"geen ID"),console.log(" PARCEL BBOX:",JSON.stringify(f.bbox||"geen bbox"));const y=new kL().readFeature(f,{dataProjection:"EPSG:28992",featureProjection:"EPSG:3857"}),_=y.getGeometry();if(!_)return console.log("No geometry in parcel feature"),!1;const b=f.properties||{};console.log(` Parcel: ${b.category||"unknown"} - ${b.gewasnaam||b.gewas||"geen gewas"}`),console.log(` Geometry type: ${_.getType()}, extent: ${_.getExtent().map(O=>O.toFixed(0)).join(", ")}`);const T=_.getExtent(),A=T[2]-T[0],I=T[3]-T[1],P=Math.max(A,I)*.05,R=[T[0]-P,T[1]-P,T[2]+P,T[3]+P],D=Math.max(A,I)*.3,C=[T[0]-D,T[1]-D,T[2]+D,T[3]+D];_x=_,Ky=new hCe({source:new $Ce({url:"https://ahn.arcgisonline.nl/arcgis/rest/services/Hoogtebestand/AHN4_DTM_50cm/ImageServer",params:{renderingRule:JSON.stringify({rasterFunction:"AHN - Color Ramp D"})},crossOrigin:"anonymous"}),extent:R,zIndex:998}),Ky.on("prerender",O=>{if(!_x)return;const j=O.context;if(!j)return;const V=O.frameState;if(!V)return;j.save(),j.beginPath(),(_x.getType()==="Polygon"?_x.getCoordinates()[0]:_x.getCoordinates()[0][0]).forEach((G,de)=>{const Ie=t.getPixelFromCoordinate(G);if(!Ie)return;const ze=V.pixelRatio,Ne=Ie[0]*ze,fe=Ie[1]*ze;de===0?j.moveTo(Ne,fe):j.lineTo(Ne,fe)}),j.closePath(),j.clip()}),Ky.on("postrender",O=>{const j=O.context;j&&j.restore()}),t.addLayer(Ky);const M=new Ml({features:[y]});return JT=new Nl({source:M,style:new vn({fill:new Dn({color:"rgba(0, 0, 0, 0)"}),stroke:new Pn({color:"#dc2626",width:3})}),zIndex:999}),t.addLayer(JT),console.log(" Parcel height map displayed"),!0}catch(n){return console.error("Failed to show parcel height map:",n),!1}}var t5={};t5.version="0.18.5";var kbe=1252,L1t=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Abe=function(t){L1t.indexOf(t)!=-1&&(kbe=t)};function D1t(){Abe(1252)}var TA=function(t){Abe(t)};function j1t(){TA(1200),D1t()}var IR=function(e){return String.fromCharCode(e)},Aoe=function(e){return String.fromCharCode(e)},n5,cg="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function kA(t){for(var e="",n=0,r=0,i=0,s=0,o=0,a=0,l=0,c=0;c<t.length;)n=t.charCodeAt(c++),s=n>>2,r=t.charCodeAt(c++),o=(n&3)<<4|r>>4,i=t.charCodeAt(c++),a=(r&15)<<2|i>>6,l=i&63,isNaN(r)?a=l=64:isNaN(i)&&(l=64),e+=cg.charAt(s)+cg.charAt(o)+cg.charAt(a)+cg.charAt(l);return e}function wp(t){var e="",n=0,r=0,i=0,s=0,o=0,a=0,l=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<t.length;)s=cg.indexOf(t.charAt(c++)),o=cg.indexOf(t.charAt(c++)),n=s<<2|o>>4,e+=String.fromCharCode(n),a=cg.indexOf(t.charAt(c++)),r=(o&15)<<4|a>>2,a!==64&&(e+=String.fromCharCode(r)),l=cg.indexOf(t.charAt(c++)),i=(a&3)<<6|l,l!==64&&(e+=String.fromCharCode(i));return e}var kr=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Cp=(function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,n){return n?new Buffer(e,n):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}})();function Q1(t){return kr?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function Ioe(t){return kr?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var rh=function(e){return kr?Cp(e,"binary"):e.split("").map(function(n){return n.charCodeAt(0)&255})};function ML(t){if(typeof ArrayBuffer>"u")return rh(t);for(var e=new ArrayBuffer(t.length),n=new Uint8Array(e),r=0;r!=t.length;++r)n[r]=t.charCodeAt(r)&255;return e}function JI(t){if(Array.isArray(t))return t.map(function(r){return String.fromCharCode(r)}).join("");for(var e=[],n=0;n<t.length;++n)e[n]=String.fromCharCode(t[n]);return e.join("")}function $1t(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}var Oo=kr?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:Cp(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,n=0;for(e=0;e<t.length;++e)n+=t[e].length;var r=new Uint8Array(n),i=0;for(e=0,n=0;e<t.length;n+=i,++e)if(i=t[e].length,t[e]instanceof Uint8Array)r.set(t[e],n);else{if(typeof t[e]=="string")throw"wtf";r.set(new Uint8Array(t[e]),n)}return r}return[].concat.apply([],t.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function F1t(t){for(var e=[],n=0,r=t.length+250,i=Q1(t.length+255),s=0;s<t.length;++s){var o=t.charCodeAt(s);if(o<128)i[n++]=o;else if(o<2048)i[n++]=192|o>>6&31,i[n++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var a=t.charCodeAt(++s)&1023;i[n++]=240|o>>8&7,i[n++]=128|o>>2&63,i[n++]=128|a>>6&15|(o&3)<<4,i[n++]=128|a&63}else i[n++]=224|o>>12&15,i[n++]=128|o>>6&63,i[n++]=128|o&63;n>r&&(e.push(i.slice(0,n)),n=0,i=Q1(65535),r=65530)}return e.push(i.slice(0,n)),Oo(e)}var QT=/\u0000/g,PR=/[\u0001-\u0006]/g;function Ew(t){for(var e="",n=t.length-1;n>=0;)e+=t.charAt(n--);return e}function uh(t,e){var n=""+t;return n.length>=e?n:Ji("0",e-n.length)+n}function _q(t,e){var n=""+t;return n.length>=e?n:Ji(" ",e-n.length)+n}function r5(t,e){var n=""+t;return n.length>=e?n:n+Ji(" ",e-n.length)}function V1t(t,e){var n=""+Math.round(t);return n.length>=e?n:Ji("0",e-n.length)+n}function z1t(t,e){var n=""+t;return n.length>=e?n:Ji("0",e-n.length)+n}var Poe=Math.pow(2,32);function O_(t,e){if(t>Poe||t<-Poe)return V1t(t,e);var n=Math.round(t);return z1t(n,e)}function i5(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var Coe=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],nF=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function G1t(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var rs={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Roe={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},U1t={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function s5(t,e,n){for(var r=t<0?-1:1,i=t*r,s=0,o=1,a=0,l=1,c=0,u=0,h=Math.floor(i);c<e&&(h=Math.floor(i),a=h*o+s,u=h*c+l,!(i-h<5e-8));)i=1/(i-h),s=o,o=a,l=c,c=u;if(u>e&&(c>e?(u=l,a=s):(u=c,a=o)),!n)return[0,r*a,u];var f=Math.floor(r*a/u);return[f,r*a-f*u,u]}function CR(t,e,n){if(t>2958465||t<0)return null;var r=t|0,i=Math.floor(86400*(t-r)),s=0,o=[],a={D:r,T:i,u:86400*(t-r)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(a.u)<1e-6&&(a.u=0),e&&e.date1904&&(r+=1462),a.u>.9999&&(a.u=0,++i==86400&&(a.T=i=0,++r,++a.D)),r===60)o=n?[1317,10,29]:[1900,2,29],s=3;else if(r===0)o=n?[1317,8,29]:[1900,1,0],s=6;else{r>60&&--r;var l=new Date(1900,0,1);l.setDate(l.getDate()+r-1),o=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),r<60&&(s=(s+6)%7),n&&(s=X1t(l,o))}return a.y=o[0],a.m=o[1],a.d=o[2],a.S=i%60,i=Math.floor(i/60),a.M=i%60,i=Math.floor(i/60),a.H=i,a.q=s,a}var Ibe=new Date(1899,11,31,0,0,0),B1t=Ibe.getTime(),W1t=new Date(1900,2,1,0,0,0);function Pbe(t,e){var n=t.getTime();return e?n-=1461*24*60*60*1e3:t>=W1t&&(n+=1440*60*1e3),(n-(B1t+(t.getTimezoneOffset()-Ibe.getTimezoneOffset())*6e4))/(1440*60*1e3)}function xq(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function H1t(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function q1t(t){var e=t<0?12:11,n=xq(t.toFixed(12));return n.length<=e||(n=t.toPrecision(10),n.length<=e)?n:t.toExponential(5)}function K1t(t){var e=xq(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function Y1t(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),n;return e>=-4&&e<=-1?n=t.toPrecision(10+e):Math.abs(e)<=9?n=q1t(t):e===10?n=t.toFixed(10).substr(0,12):n=K1t(t),xq(H1t(n.toUpperCase()))}function jz(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):Y1t(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Jg(14,Pbe(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function X1t(t,e){e[0]-=581;var n=t.getDay();return t<60&&(n=(n+6)%7),n}function Z1t(t,e,n,r){var i="",s=0,o=0,a=n.y,l,c=0;switch(t){case 98:a=n.y+543;case 121:switch(e.length){case 1:case 2:l=a%100,c=2;break;default:l=a%1e4,c=4;break}break;case 109:switch(e.length){case 1:case 2:l=n.m,c=e.length;break;case 3:return nF[n.m-1][1];case 5:return nF[n.m-1][0];default:return nF[n.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=n.d,c=e.length;break;case 3:return Coe[n.q][0];default:return Coe[n.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(n.H+11)%12,c=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=n.H,c=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=n.M,c=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return n.u===0&&(e=="s"||e=="ss")?uh(n.S,e.length):(r>=2?o=r===3?1e3:100:o=r===1?10:1,s=Math.round(o*(n.S+n.u)),s>=60*o&&(s=0),e==="s"?s===0?"0":""+s/o:(i=uh(s,2+r),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=n.D*24+n.H;break;case"[m]":case"[mm]":l=(n.D*24+n.H)*60+n.M;break;case"[s]":case"[ss]":l=((n.D*24+n.H)*60+n.M)*60+Math.round(n.S+n.u);break;default:throw"bad abstime format: "+e}c=e.length===3?1:2;break;case 101:l=a,c=1;break}var u=c>0?uh(l,c):"";return u}function ug(t){var e=3;if(t.length<=e)return t;for(var n=t.length%e,r=t.substr(0,n);n!=t.length;n+=e)r+=(r.length>0?",":"")+t.substr(n,e);return r}var Cbe=/%/g;function J1t(t,e,n){var r=e.replace(Cbe,""),i=e.length-r.length;return ap(t,r,n*Math.pow(10,2*i))+Ji("%",i)}function Q1t(t,e,n){for(var r=e.length-1;e.charCodeAt(r-1)===44;)--r;return ap(t,e.substr(0,r),n/Math.pow(10,3*(e.length-r)))}function Rbe(t,e){var n,r=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+Rbe(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),n=(e/Math.pow(10,s)).toPrecision(r+1+(i+s)%i),n.indexOf("e")===-1){var o=Math.floor(Math.log(e)*Math.LOG10E);for(n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(o-n.length+s):n+="E+"+(o-s);n.substr(0,2)==="0.";)n=n.charAt(0)+n.substr(2,i)+"."+n.substr(2+i),n=n.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(a,l,c,u){return l+c+u.substr(0,(i+s)%i)+"."+u.substr(s)+"E"})}else n=e.toExponential(r);return t.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),t.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}var Mbe=/# (\?+)( ?)\/( ?)(\d+)/;function evt(t,e,n){var r=parseInt(t[4],10),i=Math.round(e*r),s=Math.floor(i/r),o=i-s*r,a=r;return n+(s===0?"":""+s)+" "+(o===0?Ji(" ",t[1].length+1+t[4].length):_q(o,t[1].length)+t[2]+"/"+t[3]+uh(a,t[4].length))}function tvt(t,e,n){return n+(e===0?"":""+e)+Ji(" ",t[1].length+2+t[4].length)}var Nbe=/^#*0*\.([0#]+)/,Obe=/\).*[0#]/,Lbe=/\(###\) ###\\?-####/;function Ra(t){for(var e="",n,r=0;r!=t.length;++r)switch(n=t.charCodeAt(r)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(n)}return e}function Moe(t,e){var n=Math.pow(10,e);return""+Math.round(t*n)/n}function Noe(t,e){var n=t-Math.floor(t),r=Math.pow(10,e);return e<(""+Math.round(n*r)).length?0:Math.round(n*r)}function nvt(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function rvt(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Uc(t,e,n){if(t.charCodeAt(0)===40&&!e.match(Obe)){var r=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?Uc("n",r,n):"("+Uc("n",r,-n)+")"}if(e.charCodeAt(e.length-1)===44)return Q1t(t,e,n);if(e.indexOf("%")!==-1)return J1t(t,e,n);if(e.indexOf("E")!==-1)return Rbe(e,n);if(e.charCodeAt(0)===36)return"$"+Uc(t,e.substr(e.charAt(1)==" "?2:1),n);var i,s,o,a,l=Math.abs(n),c=n<0?"-":"";if(e.match(/^00+$/))return c+O_(l,e.length);if(e.match(/^[#?]+$/))return i=O_(n,0),i==="0"&&(i=""),i.length>e.length?i:Ra(e.substr(0,e.length-i.length))+i;if(s=e.match(Mbe))return evt(s,l,c);if(e.match(/^#+0+$/))return c+O_(l,e.length-e.indexOf("0"));if(s=e.match(Nbe))return i=Moe(n,s[1].length).replace(/^([^\.]+)$/,"$1."+Ra(s[1])).replace(/\.$/,"."+Ra(s[1])).replace(/\.(\d*)$/,function(y,_){return"."+_+Ji("0",Ra(s[1]).length-_.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return c+Moe(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return c+ug(O_(l,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+Uc(t,e,-n):ug(""+(Math.floor(n)+nvt(n,s[1].length)))+"."+uh(Noe(n,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return Uc(t,e.replace(/^#,#*,/,""),n);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Ew(Uc(t,e.replace(/[\\-]/g,""),n)),o=0,Ew(Ew(e.replace(/\\/g,"")).replace(/[0#]/g,function(y){return o<i.length?i.charAt(o++):y==="0"?"0":""}));if(e.match(Lbe))return i=Uc(t,"##########",n),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),a=s5(l,Math.pow(10,o)-1,!1),i=""+c,u=ap("n",s[1],a[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+s[2]+"/"+s[3],u=r5(a[2],o),u.length<s[4].length&&(u=Ra(s[4].substr(s[4].length-u.length))+u),i+=u,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),a=s5(l,Math.pow(10,o)-1,!0),c+(a[0]||(a[1]?"":"0"))+" "+(a[1]?_q(a[1],o)+s[2]+"/"+s[3]+r5(a[2],o):Ji(" ",2*o+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=O_(n,0),e.length<=i.length?i:Ra(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+n.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var h=e.indexOf(".")-o,f=e.length-i.length-h;return Ra(e.substr(0,h)+i+e.substr(e.length-f))}if(s=e.match(/^00,000\.([#0]*0)$/))return o=Noe(n,s[1].length),n<0?"-"+Uc(t,e,-n):ug(rvt(n)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?uh(0,3-y.length):"")+y})+"."+uh(o,s[1].length);switch(e){case"###,##0.00":return Uc(t,"#,##0.00",n);case"###,###":case"##,###":case"#,###":var g=ug(O_(l,0));return g!=="0"?c+g:"";case"###,###.00":return Uc(t,"###,##0.00",n).replace(/^0\./,".");case"#,###.00":return Uc(t,"#,##0.00",n).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function ivt(t,e,n){for(var r=e.length-1;e.charCodeAt(r-1)===44;)--r;return ap(t,e.substr(0,r),n/Math.pow(10,3*(e.length-r)))}function svt(t,e,n){var r=e.replace(Cbe,""),i=e.length-r.length;return ap(t,r,n*Math.pow(10,2*i))+Ji("%",i)}function Dbe(t,e){var n,r=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+Dbe(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),n=(e/Math.pow(10,s)).toPrecision(r+1+(i+s)%i),!n.match(/[Ee]/)){var o=Math.floor(Math.log(e)*Math.LOG10E);n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(o-n.length+s):n+="E+"+(o-s),n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(a,l,c,u){return l+c+u.substr(0,(i+s)%i)+"."+u.substr(s)+"E"})}else n=e.toExponential(r);return t.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),t.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}function nd(t,e,n){if(t.charCodeAt(0)===40&&!e.match(Obe)){var r=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?nd("n",r,n):"("+nd("n",r,-n)+")"}if(e.charCodeAt(e.length-1)===44)return ivt(t,e,n);if(e.indexOf("%")!==-1)return svt(t,e,n);if(e.indexOf("E")!==-1)return Dbe(e,n);if(e.charCodeAt(0)===36)return"$"+nd(t,e.substr(e.charAt(1)==" "?2:1),n);var i,s,o,a,l=Math.abs(n),c=n<0?"-":"";if(e.match(/^00+$/))return c+uh(l,e.length);if(e.match(/^[#?]+$/))return i=""+n,n===0&&(i=""),i.length>e.length?i:Ra(e.substr(0,e.length-i.length))+i;if(s=e.match(Mbe))return tvt(s,l,c);if(e.match(/^#+0+$/))return c+uh(l,e.length-e.indexOf("0"));if(s=e.match(Nbe))return i=(""+n).replace(/^([^\.]+)$/,"$1."+Ra(s[1])).replace(/\.$/,"."+Ra(s[1])),i=i.replace(/\.(\d*)$/,function(y,_){return"."+_+Ji("0",Ra(s[1]).length-_.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return c+ug(""+l);if(s=e.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+nd(t,e,-n):ug(""+n)+"."+Ji("0",s[1].length);if(s=e.match(/^#,#*,#0/))return nd(t,e.replace(/^#,#*,/,""),n);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Ew(nd(t,e.replace(/[\\-]/g,""),n)),o=0,Ew(Ew(e.replace(/\\/g,"")).replace(/[0#]/g,function(y){return o<i.length?i.charAt(o++):y==="0"?"0":""}));if(e.match(Lbe))return i=nd(t,"##########",n),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),a=s5(l,Math.pow(10,o)-1,!1),i=""+c,u=ap("n",s[1],a[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+s[2]+"/"+s[3],u=r5(a[2],o),u.length<s[4].length&&(u=Ra(s[4].substr(s[4].length-u.length))+u),i+=u,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),a=s5(l,Math.pow(10,o)-1,!0),c+(a[0]||(a[1]?"":"0"))+" "+(a[1]?_q(a[1],o)+s[2]+"/"+s[3]+r5(a[2],o):Ji(" ",2*o+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+n,e.length<=i.length?i:Ra(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+n.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var h=e.indexOf(".")-o,f=e.length-i.length-h;return Ra(e.substr(0,h)+i+e.substr(e.length-f))}if(s=e.match(/^00,000\.([#0]*0)$/))return n<0?"-"+nd(t,e,-n):ug(""+n).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?uh(0,3-y.length):"")+y})+"."+uh(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var g=ug(""+l);return g!=="0"?c+g:"";default:if(e.match(/\.[0#?]*$/))return nd(t,e.slice(0,e.lastIndexOf(".")),n)+Ra(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function ap(t,e,n){return(n|0)===n?nd(t,e,n):Uc(t,e,n)}function ovt(t){for(var e=[],n=!1,r=0,i=0;r<t.length;++r)switch(t.charCodeAt(r)){case 34:n=!n;break;case 95:case 42:case 92:++r;break;case 59:e[e.length]=t.substr(i,r-i),i=r+1}if(e[e.length]=t.substr(i),n===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var jbe=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function $be(t){for(var e=0,n="",r="";e<t.length;)switch(n=t.charAt(e)){case"G":i5(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(r=n;t.charAt(e++)!=="]"&&e<t.length;)r+=t.charAt(e);if(r.match(jbe))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(n=t.charAt(++e))>-1||n=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===n;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function avt(t,e,n,r){for(var i=[],s="",o=0,a="",l="t",c,u,h,f="H";o<t.length;)switch(a=t.charAt(o)){case"G":if(!i5(t,o))throw new Error("unrecognized character "+a+" in "+t);i[i.length]={t:"G",v:"General"},o+=7;break;case'"':for(s="";(h=t.charCodeAt(++o))!==34&&o<t.length;)s+=String.fromCharCode(h);i[i.length]={t:"t",v:s},++o;break;case"\\":var g=t.charAt(++o),y=g==="("||g===")"?g:"t";i[i.length]={t:y,v:g},++o;break;case"_":i[i.length]={t:"t",v:" "},o+=2;break;case"@":i[i.length]={t:"T",v:e},++o;break;case"B":case"b":if(t.charAt(o+1)==="1"||t.charAt(o+1)==="2"){if(c==null&&(c=CR(e,n,t.charAt(o+1)==="2"),c==null))return"";i[i.length]={t:"X",v:t.substr(o,2)},l=a,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":a=a.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||c==null&&(c=CR(e,n),c==null))return"";for(s=a;++o<t.length&&t.charAt(o).toLowerCase()===a;)s+=a;a==="m"&&l.toLowerCase()==="h"&&(a="M"),a==="h"&&(a=f),i[i.length]={t:a,v:s},l=a;break;case"A":case"a":case"":var _={t:a,v:a};if(c==null&&(c=CR(e,n)),t.substr(o,3).toUpperCase()==="A/P"?(c!=null&&(_.v=c.H>=12?"P":"A"),_.t="T",f="h",o+=3):t.substr(o,5).toUpperCase()==="AM/PM"?(c!=null&&(_.v=c.H>=12?"PM":"AM"),_.t="T",o+=5,f="h"):t.substr(o,5).toUpperCase()==="/"?(c!=null&&(_.v=c.H>=12?"":""),_.t="T",o+=5,f="h"):(_.t="t",++o),c==null&&_.t==="T")return"";i[i.length]=_,l=a;break;case"[":for(s=a;t.charAt(o++)!=="]"&&o<t.length;)s+=t.charAt(o);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(jbe)){if(c==null&&(c=CR(e,n),c==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",$be(t)||(i[i.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=a;++o<t.length&&(a=t.charAt(o))==="0";)s+=a;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=a;++o<t.length&&"0#?.,E+-%".indexOf(a=t.charAt(o))>-1;)s+=a;i[i.length]={t:"n",v:s};break;case"?":for(s=a;t.charAt(++o)===a;)s+=a;i[i.length]={t:a,v:s},l=a;break;case"*":++o,(t.charAt(o)==" "||t.charAt(o)=="*")&&++o;break;case"(":case")":i[i.length]={t:r===1?"t":a,v:a},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=a;o<t.length&&"0123456789".indexOf(t.charAt(++o))>-1;)s+=t.charAt(o);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:a,v:a},++o;break;case"$":i[i.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(a)===-1)throw new Error("unrecognized character "+a+" in "+t);i[i.length]={t:"t",v:a},++o;break}var b=0,T=0,A;for(o=i.length-1,l="t";o>=0;--o)switch(i[o].t){case"h":case"H":i[o].t=f,l="h",b<1&&(b=1);break;case"s":(A=i[o].v.match(/\.0+$/))&&(T=Math.max(T,A[0].length-1)),b<3&&(b=3);case"d":case"y":case"M":case"e":l=i[o].t;break;case"m":l==="s"&&(i[o].t="M",b<2&&(b=2));break;case"X":break;case"Z":b<1&&i[o].v.match(/[Hh]/)&&(b=1),b<2&&i[o].v.match(/[Mm]/)&&(b=2),b<3&&i[o].v.match(/[Ss]/)&&(b=3)}switch(b){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var I="",P;for(o=0;o<i.length;++o)switch(i[o].t){case"t":case"T":case" ":case"D":break;case"X":i[o].v="",i[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[o].v=Z1t(i[o].t.charCodeAt(0),i[o].v,c,T),i[o].t="t";break;case"n":case"?":for(P=o+1;i[P]!=null&&((a=i[P].t)==="?"||a==="D"||(a===" "||a==="t")&&i[P+1]!=null&&(i[P+1].t==="?"||i[P+1].t==="t"&&i[P+1].v==="/")||i[o].t==="("&&(a===" "||a==="n"||a===")")||a==="t"&&(i[P].v==="/"||i[P].v===" "&&i[P+1]!=null&&i[P+1].t=="?"));)i[o].v+=i[P].v,i[P]={v:"",t:";"},++P;I+=i[o].v,o=P-1;break;case"G":i[o].t="t",i[o].v=jz(e,n);break}var R="",D,C;if(I.length>0){I.charCodeAt(0)==40?(D=e<0&&I.charCodeAt(0)===45?-e:e,C=ap("n",I,D)):(D=e<0&&r>1?-e:e,C=ap("n",I,D),D<0&&i[0]&&i[0].t=="t"&&(C=C.substr(1),i[0].v="-"+i[0].v)),P=C.length-1;var M=i.length;for(o=0;o<i.length;++o)if(i[o]!=null&&i[o].t!="t"&&i[o].v.indexOf(".")>-1){M=o;break}var O=i.length;if(M===i.length&&C.indexOf("E")===-1){for(o=i.length-1;o>=0;--o)i[o]==null||"n?".indexOf(i[o].t)===-1||(P>=i[o].v.length-1?(P-=i[o].v.length,i[o].v=C.substr(P+1,i[o].v.length)):P<0?i[o].v="":(i[o].v=C.substr(0,P+1),P=-1),i[o].t="t",O=o);P>=0&&O<i.length&&(i[O].v=C.substr(0,P+1)+i[O].v)}else if(M!==i.length&&C.indexOf("E")===-1){for(P=C.indexOf(".")-1,o=M;o>=0;--o)if(!(i[o]==null||"n?".indexOf(i[o].t)===-1)){for(u=i[o].v.indexOf(".")>-1&&o===M?i[o].v.indexOf(".")-1:i[o].v.length-1,R=i[o].v.substr(u+1);u>=0;--u)P>=0&&(i[o].v.charAt(u)==="0"||i[o].v.charAt(u)==="#")&&(R=C.charAt(P--)+R);i[o].v=R,i[o].t="t",O=o}for(P>=0&&O<i.length&&(i[O].v=C.substr(0,P+1)+i[O].v),P=C.indexOf(".")+1,o=M;o<i.length;++o)if(!(i[o]==null||"n?(".indexOf(i[o].t)===-1&&o!==M)){for(u=i[o].v.indexOf(".")>-1&&o===M?i[o].v.indexOf(".")+1:0,R=i[o].v.substr(0,u);u<i[o].v.length;++u)P<C.length&&(R+=C.charAt(P++));i[o].v=R,i[o].t="t",O=o}}}for(o=0;o<i.length;++o)i[o]!=null&&"n?".indexOf(i[o].t)>-1&&(D=r>1&&e<0&&o>0&&i[o-1].v==="-"?-e:e,i[o].v=ap(i[o].t,i[o].v,D),i[o].t="t");var j="";for(o=0;o!==i.length;++o)i[o]!=null&&(j+=i[o].v);return j}var Ooe=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Loe(t,e){if(e==null)return!1;var n=parseFloat(e[2]);switch(e[1]){case"=":if(t==n)return!0;break;case">":if(t>n)return!0;break;case"<":if(t<n)return!0;break;case"<>":if(t!=n)return!0;break;case">=":if(t>=n)return!0;break;case"<=":if(t<=n)return!0;break}return!1}function lvt(t,e){var n=ovt(t),r=n.length,i=n[r-1].indexOf("@");if(r<4&&i>-1&&--r,n.length>4)throw new Error("cannot find right format for |"+n.join("|")+"|");if(typeof e!="number")return[4,n.length===4||i>-1?n[n.length-1]:"@"];switch(n.length){case 1:n=i>-1?["General","General","General",n[0]]:[n[0],n[0],n[0],"@"];break;case 2:n=i>-1?[n[0],n[0],n[0],n[1]]:[n[0],n[1],n[0],"@"];break;case 3:n=i>-1?[n[0],n[1],n[0],n[2]]:[n[0],n[1],n[2],"@"];break}var s=e>0?n[0]:e<0?n[1]:n[2];if(n[0].indexOf("[")===-1&&n[1].indexOf("[")===-1)return[r,s];if(n[0].match(/\[[=<>]/)!=null||n[1].match(/\[[=<>]/)!=null){var o=n[0].match(Ooe),a=n[1].match(Ooe);return Loe(e,o)?[r,n[0]]:Loe(e,a)?[r,n[1]]:[r,n[o!=null&&a!=null?2:1]]}return[r,s]}function Jg(t,e,n){n==null&&(n={});var r="";switch(typeof t){case"string":t=="m/d/yy"&&n.dateNF?r=n.dateNF:r=t;break;case"number":t==14&&n.dateNF?r=n.dateNF:r=(n.table!=null?n.table:rs)[t],r==null&&(r=n.table&&n.table[Roe[t]]||rs[Roe[t]]),r==null&&(r=U1t[t]||"General");break}if(i5(r,0))return jz(e,n);e instanceof Date&&(e=Pbe(e,n.date1904));var i=lvt(r,e);if(i5(i[1]))return jz(e,n);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return avt(i[1],e,n,i[0])}function Fbe(t,e){if(typeof e!="number"){e=+e||-1;for(var n=0;n<392;++n){if(rs[n]==null){e<0&&(e=n);continue}if(rs[n]==t){e=n;break}}e<0&&(e=391)}return rs[e]=t,e}function NL(t){for(var e=0;e!=392;++e)t[e]!==void 0&&Fbe(t[e],e)}function OL(){rs=G1t()}var Vbe=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function cvt(t){var e=typeof t=="number"?rs[t]:t;return e=e.replace(Vbe,"(\\d+)"),new RegExp("^"+e+"$")}function uvt(t,e,n){var r=-1,i=-1,s=-1,o=-1,a=-1,l=-1;(e.match(Vbe)||[]).forEach(function(h,f){var g=parseInt(n[f+1],10);switch(h.toLowerCase().charAt(0)){case"y":r=g;break;case"d":s=g;break;case"h":o=g;break;case"s":l=g;break;case"m":o>=0?a=g:i=g;break}}),l>=0&&a==-1&&i>=0&&(a=i,i=-1);var c=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return o==-1&&a==-1&&l==-1?c:r==-1&&i==-1&&s==-1?u:c+"T"+u}var hvt=(function(){var t={};t.version="1.2.0";function e(){for(var C=0,M=new Array(256),O=0;O!=256;++O)C=O,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,M[O]=C;return typeof Int32Array<"u"?new Int32Array(M):M}var n=e();function r(C){var M=0,O=0,j=0,V=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(j=0;j!=256;++j)V[j]=C[j];for(j=0;j!=256;++j)for(O=C[j],M=256+j;M<4096;M+=256)O=V[M]=O>>>8^C[O&255];var U=[];for(j=1;j!=16;++j)U[j-1]=typeof Int32Array<"u"?V.subarray(j*256,j*256+256):V.slice(j*256,j*256+256);return U}var i=r(n),s=i[0],o=i[1],a=i[2],l=i[3],c=i[4],u=i[5],h=i[6],f=i[7],g=i[8],y=i[9],_=i[10],b=i[11],T=i[12],A=i[13],I=i[14];function P(C,M){for(var O=M^-1,j=0,V=C.length;j<V;)O=O>>>8^n[(O^C.charCodeAt(j++))&255];return~O}function R(C,M){for(var O=M^-1,j=C.length-15,V=0;V<j;)O=I[C[V++]^O&255]^A[C[V++]^O>>8&255]^T[C[V++]^O>>16&255]^b[C[V++]^O>>>24]^_[C[V++]]^y[C[V++]]^g[C[V++]]^f[C[V++]]^h[C[V++]]^u[C[V++]]^c[C[V++]]^l[C[V++]]^a[C[V++]]^o[C[V++]]^s[C[V++]]^n[C[V++]];for(j+=15;V<j;)O=O>>>8^n[(O^C[V++])&255];return~O}function D(C,M){for(var O=M^-1,j=0,V=C.length,U=0,G=0;j<V;)U=C.charCodeAt(j++),U<128?O=O>>>8^n[(O^U)&255]:U<2048?(O=O>>>8^n[(O^(192|U>>6&31))&255],O=O>>>8^n[(O^(128|U&63))&255]):U>=55296&&U<57344?(U=(U&1023)+64,G=C.charCodeAt(j++)&1023,O=O>>>8^n[(O^(240|U>>8&7))&255],O=O>>>8^n[(O^(128|U>>2&63))&255],O=O>>>8^n[(O^(128|G>>6&15|(U&3)<<4))&255],O=O>>>8^n[(O^(128|G&63))&255]):(O=O>>>8^n[(O^(224|U>>12&15))&255],O=O>>>8^n[(O^(128|U>>6&63))&255],O=O>>>8^n[(O^(128|U&63))&255]);return~O}return t.table=n,t.bstr=P,t.buf=R,t.str=D,t})(),Xr=(function(){var e={};e.version="1.2.1";function n(q,re){for(var J=q.split("/"),te=re.split("/"),se=0,oe=0,Re=Math.min(J.length,te.length);se<Re;++se){if(oe=J[se].length-te[se].length)return oe;if(J[se]!=te[se])return J[se]<te[se]?-1:1}return J.length-te.length}function r(q){if(q.charAt(q.length-1)=="/")return q.slice(0,-1).indexOf("/")===-1?q:r(q.slice(0,-1));var re=q.lastIndexOf("/");return re===-1?q:q.slice(0,re+1)}function i(q){if(q.charAt(q.length-1)=="/")return i(q.slice(0,-1));var re=q.lastIndexOf("/");return re===-1?q:q.slice(re+1)}function s(q,re){typeof re=="string"&&(re=new Date(re));var J=re.getHours();J=J<<6|re.getMinutes(),J=J<<5|re.getSeconds()>>>1,q.write_shift(2,J);var te=re.getFullYear()-1980;te=te<<4|re.getMonth()+1,te=te<<5|re.getDate(),q.write_shift(2,te)}function o(q){var re=q.read_shift(2)&65535,J=q.read_shift(2)&65535,te=new Date,se=J&31;J>>>=5;var oe=J&15;J>>>=4,te.setMilliseconds(0),te.setFullYear(J+1980),te.setMonth(oe-1),te.setDate(se);var Re=re&31;re>>>=5;var Be=re&63;return re>>>=6,te.setHours(re),te.setMinutes(Be),te.setSeconds(Re<<1),te}function a(q){nc(q,0);for(var re={},J=0;q.l<=q.length-4;){var te=q.read_shift(2),se=q.read_shift(2),oe=q.l+se,Re={};switch(te){case 21589:J=q.read_shift(1),J&1&&(Re.mtime=q.read_shift(4)),se>5&&(J&2&&(Re.atime=q.read_shift(4)),J&4&&(Re.ctime=q.read_shift(4))),Re.mtime&&(Re.mt=new Date(Re.mtime*1e3));break}q.l=oe,re[te]=Re}return re}var l;function c(){return l||(l={})}function u(q,re){if(q[0]==80&&q[1]==75)return sn(q,re);if((q[0]|32)==109&&(q[1]|32)==105)return Je(q,re);if(q.length<512)throw new Error("CFB file size "+q.length+" < 512");var J=3,te=512,se=0,oe=0,Re=0,Be=0,Pe=0,Oe=[],Le=q.slice(0,512);nc(Le,0);var lt=h(Le);switch(J=lt[0],J){case 3:te=512;break;case 4:te=4096;break;case 0:if(lt[1]==0)return sn(q,re);default:throw new Error("Major Version: Expected 3 or 4 saw "+J)}te!==512&&(Le=q.slice(0,te),nc(Le,28));var gt=q.slice(0,te);f(Le,J);var Ct=Le.read_shift(4,"i");if(J===3&&Ct!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ct);Le.l+=4,Re=Le.read_shift(4,"i"),Le.l+=4,Le.chk("00100000","Mini Stream Cutoff Size: "),Be=Le.read_shift(4,"i"),se=Le.read_shift(4,"i"),Pe=Le.read_shift(4,"i"),oe=Le.read_shift(4,"i");for(var ct=-1,ut=0;ut<109&&(ct=Le.read_shift(4,"i"),!(ct<0));++ut)Oe[ut]=ct;var En=g(q,te);b(Pe,oe,En,te,Oe);var Rr=A(En,Re,Oe,te);Rr[Re].name="!Directory",se>0&&Be!==G&&(Rr[Be].name="!MiniFAT"),Rr[Oe[0]].name="!FAT",Rr.fat_addrs=Oe,Rr.ssz=te;var jr={},vi=[],Eu=[],Tc=[];I(Re,Rr,En,vi,se,jr,Eu,Be),y(Eu,Tc,vi),vi.shift();var Dl={FileIndex:Eu,FullPaths:Tc};return re&&re.raw&&(Dl.raw={header:gt,sectors:En}),Dl}function h(q){if(q[q.l]==80&&q[q.l+1]==75)return[0,0];q.chk(de,"Header Signature: "),q.l+=16;var re=q.read_shift(2,"u");return[q.read_shift(2,"u"),re]}function f(q,re){var J=9;switch(q.l+=2,J=q.read_shift(2)){case 9:if(re!=3)throw new Error("Sector Shift: Expected 9 saw "+J);break;case 12:if(re!=4)throw new Error("Sector Shift: Expected 12 saw "+J);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+J)}q.chk("0600","Mini Sector Shift: "),q.chk("000000000000","Reserved: ")}function g(q,re){for(var J=Math.ceil(q.length/re)-1,te=[],se=1;se<J;++se)te[se-1]=q.slice(se*re,(se+1)*re);return te[J-1]=q.slice(J*re),te}function y(q,re,J){for(var te=0,se=0,oe=0,Re=0,Be=0,Pe=J.length,Oe=[],Le=[];te<Pe;++te)Oe[te]=Le[te]=te,re[te]=J[te];for(;Be<Le.length;++Be)te=Le[Be],se=q[te].L,oe=q[te].R,Re=q[te].C,Oe[te]===te&&(se!==-1&&Oe[se]!==se&&(Oe[te]=Oe[se]),oe!==-1&&Oe[oe]!==oe&&(Oe[te]=Oe[oe])),Re!==-1&&(Oe[Re]=te),se!==-1&&te!=Oe[te]&&(Oe[se]=Oe[te],Le.lastIndexOf(se)<Be&&Le.push(se)),oe!==-1&&te!=Oe[te]&&(Oe[oe]=Oe[te],Le.lastIndexOf(oe)<Be&&Le.push(oe));for(te=1;te<Pe;++te)Oe[te]===te&&(oe!==-1&&Oe[oe]!==oe?Oe[te]=Oe[oe]:se!==-1&&Oe[se]!==se&&(Oe[te]=Oe[se]));for(te=1;te<Pe;++te)if(q[te].type!==0){if(Be=te,Be!=Oe[Be])do Be=Oe[Be],re[te]=re[Be]+"/"+re[te];while(Be!==0&&Oe[Be]!==-1&&Be!=Oe[Be]);Oe[te]=-1}for(re[0]+="/",te=1;te<Pe;++te)q[te].type!==2&&(re[te]+="/")}function _(q,re,J){for(var te=q.start,se=q.size,oe=[],Re=te;J&&se>0&&Re>=0;)oe.push(re.slice(Re*U,Re*U+U)),se-=U,Re=Py(J,Re*4);return oe.length===0?Ue(0):Oo(oe).slice(0,q.size)}function b(q,re,J,te,se){var oe=G;if(q===G){if(re!==0)throw new Error("DIFAT chain shorter than expected")}else if(q!==-1){var Re=J[q],Be=(te>>>2)-1;if(!Re)return;for(var Pe=0;Pe<Be&&(oe=Py(Re,Pe*4))!==G;++Pe)se.push(oe);b(Py(Re,te-4),re-1,J,te,se)}}function T(q,re,J,te,se){var oe=[],Re=[];se||(se=[]);var Be=te-1,Pe=0,Oe=0;for(Pe=re;Pe>=0;){se[Pe]=!0,oe[oe.length]=Pe,Re.push(q[Pe]);var Le=J[Math.floor(Pe*4/te)];if(Oe=Pe*4&Be,te<4+Oe)throw new Error("FAT boundary crossed: "+Pe+" 4 "+te);if(!q[Le])break;Pe=Py(q[Le],Oe)}return{nodes:oe,data:Uoe([Re])}}function A(q,re,J,te){var se=q.length,oe=[],Re=[],Be=[],Pe=[],Oe=te-1,Le=0,lt=0,gt=0,Ct=0;for(Le=0;Le<se;++Le)if(Be=[],gt=Le+re,gt>=se&&(gt-=se),!Re[gt]){Pe=[];var ct=[];for(lt=gt;lt>=0;){ct[lt]=!0,Re[lt]=!0,Be[Be.length]=lt,Pe.push(q[lt]);var ut=J[Math.floor(lt*4/te)];if(Ct=lt*4&Oe,te<4+Ct)throw new Error("FAT boundary crossed: "+lt+" 4 "+te);if(!q[ut]||(lt=Py(q[ut],Ct),ct[lt]))break}oe[gt]={nodes:Be,data:Uoe([Pe])}}return oe}function I(q,re,J,te,se,oe,Re,Be){for(var Pe=0,Oe=te.length?2:0,Le=re[q].data,lt=0,gt=0,Ct;lt<Le.length;lt+=128){var ct=Le.slice(lt,lt+128);nc(ct,64),gt=ct.read_shift(2),Ct=Tq(ct,0,gt-Oe),te.push(Ct);var ut={name:Ct,type:ct.read_shift(1),color:ct.read_shift(1),L:ct.read_shift(4,"i"),R:ct.read_shift(4,"i"),C:ct.read_shift(4,"i"),clsid:ct.read_shift(16),state:ct.read_shift(4,"i"),start:0,size:0},En=ct.read_shift(2)+ct.read_shift(2)+ct.read_shift(2)+ct.read_shift(2);En!==0&&(ut.ct=P(ct,ct.l-8));var Rr=ct.read_shift(2)+ct.read_shift(2)+ct.read_shift(2)+ct.read_shift(2);Rr!==0&&(ut.mt=P(ct,ct.l-8)),ut.start=ct.read_shift(4,"i"),ut.size=ct.read_shift(4,"i"),ut.size<0&&ut.start<0&&(ut.size=ut.type=0,ut.start=G,ut.name=""),ut.type===5?(Pe=ut.start,se>0&&Pe!==G&&(re[Pe].name="!StreamData")):ut.size>=4096?(ut.storage="fat",re[ut.start]===void 0&&(re[ut.start]=T(J,ut.start,re.fat_addrs,re.ssz)),re[ut.start].name=ut.name,ut.content=re[ut.start].data.slice(0,ut.size)):(ut.storage="minifat",ut.size<0?ut.size=0:Pe!==G&&ut.start!==G&&re[Pe]&&(ut.content=_(ut,re[Pe].data,(re[Be]||{}).data))),ut.content&&nc(ut.content,0),oe[Ct]=ut,Re.push(ut)}}function P(q,re){return new Date((ac(q,re+4)/1e7*Math.pow(2,32)+ac(q,re)/1e7-11644473600)*1e3)}function R(q,re){return c(),u(l.readFileSync(q),re)}function D(q,re){var J=re&&re.type;switch(J||kr&&Buffer.isBuffer(q)&&(J="buffer"),J||"base64"){case"file":return R(q,re);case"base64":return u(rh(wp(q)),re);case"binary":return u(rh(q),re)}return u(q,re)}function C(q,re){var J=re||{},te=J.root||"Root Entry";if(q.FullPaths||(q.FullPaths=[]),q.FileIndex||(q.FileIndex=[]),q.FullPaths.length!==q.FileIndex.length)throw new Error("inconsistent CFB structure");q.FullPaths.length===0&&(q.FullPaths[0]=te+"/",q.FileIndex[0]={name:te,type:5}),J.CLSID&&(q.FileIndex[0].clsid=J.CLSID),M(q)}function M(q){var re="Sh33tJ5";if(!Xr.find(q,"/"+re)){var J=Ue(4);J[0]=55,J[1]=J[3]=50,J[2]=54,q.FileIndex.push({name:re,type:2,content:J,size:4,L:69,R:69,C:69}),q.FullPaths.push(q.FullPaths[0]+re),O(q)}}function O(q,re){C(q);for(var J=!1,te=!1,se=q.FullPaths.length-1;se>=0;--se){var oe=q.FileIndex[se];switch(oe.type){case 0:te?J=!0:(q.FileIndex.pop(),q.FullPaths.pop());break;case 1:case 2:case 5:te=!0,isNaN(oe.R*oe.L*oe.C)&&(J=!0),oe.R>-1&&oe.L>-1&&oe.R==oe.L&&(J=!0);break;default:J=!0;break}}if(!(!J&&!re)){var Re=new Date(1987,1,19),Be=0,Pe=Object.create?Object.create(null):{},Oe=[];for(se=0;se<q.FullPaths.length;++se)Pe[q.FullPaths[se]]=!0,q.FileIndex[se].type!==0&&Oe.push([q.FullPaths[se],q.FileIndex[se]]);for(se=0;se<Oe.length;++se){var Le=r(Oe[se][0]);te=Pe[Le],te||(Oe.push([Le,{name:i(Le).replace("/",""),type:1,clsid:ze,ct:Re,mt:Re,content:null}]),Pe[Le]=!0)}for(Oe.sort(function(Ct,ct){return n(Ct[0],ct[0])}),q.FullPaths=[],q.FileIndex=[],se=0;se<Oe.length;++se)q.FullPaths[se]=Oe[se][0],q.FileIndex[se]=Oe[se][1];for(se=0;se<Oe.length;++se){var lt=q.FileIndex[se],gt=q.FullPaths[se];if(lt.name=i(gt).replace("/",""),lt.L=lt.R=lt.C=-(lt.color=1),lt.size=lt.content?lt.content.length:0,lt.start=0,lt.clsid=lt.clsid||ze,se===0)lt.C=Oe.length>1?1:-1,lt.size=0,lt.type=5;else if(gt.slice(-1)=="/"){for(Be=se+1;Be<Oe.length&&r(q.FullPaths[Be])!=gt;++Be);for(lt.C=Be>=Oe.length?-1:Be,Be=se+1;Be<Oe.length&&r(q.FullPaths[Be])!=r(gt);++Be);lt.R=Be>=Oe.length?-1:Be,lt.type=1}else r(q.FullPaths[se+1]||"")==r(gt)&&(lt.R=se+1),lt.type=2}}}function j(q,re){var J=re||{};if(J.fileType=="mad")return Ge(q,J);switch(O(q),J.fileType){case"zip":return Et(q,J)}var te=(function(Ct){for(var ct=0,ut=0,En=0;En<Ct.FileIndex.length;++En){var Rr=Ct.FileIndex[En];if(Rr.content){var jr=Rr.content.length;jr>0&&(jr<4096?ct+=jr+63>>6:ut+=jr+511>>9)}}for(var vi=Ct.FullPaths.length+3>>2,Eu=ct+7>>3,Tc=ct+127>>7,Dl=Eu+ut+vi+Tc,ss=Dl+127>>7,Rp=ss<=109?0:Math.ceil((ss-109)/127);Dl+ss+Rp+127>>7>ss;)Rp=++ss<=109?0:Math.ceil((ss-109)/127);var Pi=[1,Rp,ss,Tc,vi,ut,ct,0];return Ct.FileIndex[0].size=ct<<6,Pi[7]=(Ct.FileIndex[0].start=Pi[0]+Pi[1]+Pi[2]+Pi[3]+Pi[4]+Pi[5])+(Pi[6]+7>>3),Pi})(q),se=Ue(te[7]<<9),oe=0,Re=0;{for(oe=0;oe<8;++oe)se.write_shift(1,Ie[oe]);for(oe=0;oe<8;++oe)se.write_shift(2,0);for(se.write_shift(2,62),se.write_shift(2,3),se.write_shift(2,65534),se.write_shift(2,9),se.write_shift(2,6),oe=0;oe<3;++oe)se.write_shift(2,0);for(se.write_shift(4,0),se.write_shift(4,te[2]),se.write_shift(4,te[0]+te[1]+te[2]+te[3]-1),se.write_shift(4,0),se.write_shift(4,4096),se.write_shift(4,te[3]?te[0]+te[1]+te[2]-1:G),se.write_shift(4,te[3]),se.write_shift(-4,te[1]?te[0]-1:G),se.write_shift(4,te[1]),oe=0;oe<109;++oe)se.write_shift(-4,oe<te[2]?te[1]+oe:-1)}if(te[1])for(Re=0;Re<te[1];++Re){for(;oe<236+Re*127;++oe)se.write_shift(-4,oe<te[2]?te[1]+oe:-1);se.write_shift(-4,Re===te[1]-1?G:Re+1)}var Be=function(Ct){for(Re+=Ct;oe<Re-1;++oe)se.write_shift(-4,oe+1);Ct&&(++oe,se.write_shift(-4,G))};for(Re=oe=0,Re+=te[1];oe<Re;++oe)se.write_shift(-4,Ne.DIFSECT);for(Re+=te[2];oe<Re;++oe)se.write_shift(-4,Ne.FATSECT);Be(te[3]),Be(te[4]);for(var Pe=0,Oe=0,Le=q.FileIndex[0];Pe<q.FileIndex.length;++Pe)Le=q.FileIndex[Pe],Le.content&&(Oe=Le.content.length,!(Oe<4096)&&(Le.start=Re,Be(Oe+511>>9)));for(Be(te[6]+7>>3);se.l&511;)se.write_shift(-4,Ne.ENDOFCHAIN);for(Re=oe=0,Pe=0;Pe<q.FileIndex.length;++Pe)Le=q.FileIndex[Pe],Le.content&&(Oe=Le.content.length,!(!Oe||Oe>=4096)&&(Le.start=Re,Be(Oe+63>>6)));for(;se.l&511;)se.write_shift(-4,Ne.ENDOFCHAIN);for(oe=0;oe<te[4]<<2;++oe){var lt=q.FullPaths[oe];if(!lt||lt.length===0){for(Pe=0;Pe<17;++Pe)se.write_shift(4,0);for(Pe=0;Pe<3;++Pe)se.write_shift(4,-1);for(Pe=0;Pe<12;++Pe)se.write_shift(4,0);continue}Le=q.FileIndex[oe],oe===0&&(Le.start=Le.size?Le.start-1:G);var gt=oe===0&&J.root||Le.name;if(Oe=2*(gt.length+1),se.write_shift(64,gt,"utf16le"),se.write_shift(2,Oe),se.write_shift(1,Le.type),se.write_shift(1,Le.color),se.write_shift(-4,Le.L),se.write_shift(-4,Le.R),se.write_shift(-4,Le.C),Le.clsid)se.write_shift(16,Le.clsid,"hex");else for(Pe=0;Pe<4;++Pe)se.write_shift(4,0);se.write_shift(4,Le.state||0),se.write_shift(4,0),se.write_shift(4,0),se.write_shift(4,0),se.write_shift(4,0),se.write_shift(4,Le.start),se.write_shift(4,Le.size),se.write_shift(4,0)}for(oe=1;oe<q.FileIndex.length;++oe)if(Le=q.FileIndex[oe],Le.size>=4096)if(se.l=Le.start+1<<9,kr&&Buffer.isBuffer(Le.content))Le.content.copy(se,se.l,0,Le.size),se.l+=Le.size+511&-512;else{for(Pe=0;Pe<Le.size;++Pe)se.write_shift(1,Le.content[Pe]);for(;Pe&511;++Pe)se.write_shift(1,0)}for(oe=1;oe<q.FileIndex.length;++oe)if(Le=q.FileIndex[oe],Le.size>0&&Le.size<4096)if(kr&&Buffer.isBuffer(Le.content))Le.content.copy(se,se.l,0,Le.size),se.l+=Le.size+63&-64;else{for(Pe=0;Pe<Le.size;++Pe)se.write_shift(1,Le.content[Pe]);for(;Pe&63;++Pe)se.write_shift(1,0)}if(kr)se.l=se.length;else for(;se.l<se.length;)se.write_shift(1,0);return se}function V(q,re){var J=q.FullPaths.map(function(Pe){return Pe.toUpperCase()}),te=J.map(function(Pe){var Oe=Pe.split("/");return Oe[Oe.length-(Pe.slice(-1)=="/"?2:1)]}),se=!1;re.charCodeAt(0)===47?(se=!0,re=J[0].slice(0,-1)+re):se=re.indexOf("/")!==-1;var oe=re.toUpperCase(),Re=se===!0?J.indexOf(oe):te.indexOf(oe);if(Re!==-1)return q.FileIndex[Re];var Be=!oe.match(PR);for(oe=oe.replace(QT,""),Be&&(oe=oe.replace(PR,"!")),Re=0;Re<J.length;++Re)if((Be?J[Re].replace(PR,"!"):J[Re]).replace(QT,"")==oe||(Be?te[Re].replace(PR,"!"):te[Re]).replace(QT,"")==oe)return q.FileIndex[Re];return null}var U=64,G=-2,de="d0cf11e0a1b11ae1",Ie=[208,207,17,224,161,177,26,225],ze="00000000000000000000000000000000",Ne={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:G,FREESECT:-1,HEADER_SIGNATURE:de,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ze,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function fe(q,re,J){c();var te=j(q,J);l.writeFileSync(re,te)}function De(q){for(var re=new Array(q.length),J=0;J<q.length;++J)re[J]=String.fromCharCode(q[J]);return re.join("")}function Ce(q,re){var J=j(q,re);switch(re&&re.type||"buffer"){case"file":return c(),l.writeFileSync(re.filename,J),J;case"binary":return typeof J=="string"?J:De(J);case"base64":return kA(typeof J=="string"?J:De(J));case"buffer":if(kr)return Buffer.isBuffer(J)?J:Cp(J);case"array":return typeof J=="string"?rh(J):J}return J}var Q;function W(q){try{var re=q.InflateRaw,J=new re;if(J._processChunk(new Uint8Array([3,0]),J._finishFlushFlag),J.bytesRead)Q=q;else throw new Error("zlib does not expose bytesRead")}catch(te){console.error("cannot use native zlib: "+(te.message||te))}}function ne(q,re){if(!Q)return ke(q,re);var J=Q.InflateRaw,te=new J,se=te._processChunk(q.slice(q.l),te._finishFlushFlag);return q.l+=te.bytesRead,se}function ie(q){return Q?Q.deflateRawSync(q):jn(q)}var le=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ve=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],qe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ke(q){var re=(q<<1|q<<11)&139536|(q<<5|q<<15)&558144;return(re>>16|re>>8|re)&255}for(var Se=typeof Uint8Array<"u",we=Se?new Uint8Array(256):[],Dt=0;Dt<256;++Dt)we[Dt]=Ke(Dt);function Ye(q,re){var J=we[q&255];return re<=8?J>>>8-re:(J=J<<8|we[q>>8&255],re<=16?J>>>16-re:(J=J<<8|we[q>>16&255],J>>>24-re))}function on(q,re){var J=re&7,te=re>>>3;return(q[te]|(J<=6?0:q[te+1]<<8))>>>J&3}function jt(q,re){var J=re&7,te=re>>>3;return(q[te]|(J<=5?0:q[te+1]<<8))>>>J&7}function pn(q,re){var J=re&7,te=re>>>3;return(q[te]|(J<=4?0:q[te+1]<<8))>>>J&15}function _n(q,re){var J=re&7,te=re>>>3;return(q[te]|(J<=3?0:q[te+1]<<8))>>>J&31}function dt(q,re){var J=re&7,te=re>>>3;return(q[te]|(J<=1?0:q[te+1]<<8))>>>J&127}function hr(q,re,J){var te=re&7,se=re>>>3,oe=(1<<J)-1,Re=q[se]>>>te;return J<8-te||(Re|=q[se+1]<<8-te,J<16-te)||(Re|=q[se+2]<<16-te,J<24-te)||(Re|=q[se+3]<<24-te),Re&oe}function zn(q,re,J){var te=re&7,se=re>>>3;return te<=5?q[se]|=(J&7)<<te:(q[se]|=J<<te&255,q[se+1]=(J&7)>>8-te),re+3}function Wn(q,re,J){var te=re&7,se=re>>>3;return J=(J&1)<<te,q[se]|=J,re+1}function ei(q,re,J){var te=re&7,se=re>>>3;return J<<=te,q[se]|=J&255,J>>>=8,q[se+1]=J,re+8}function _o(q,re,J){var te=re&7,se=re>>>3;return J<<=te,q[se]|=J&255,J>>>=8,q[se+1]=J&255,q[se+2]=J>>>8,re+16}function Cr(q,re){var J=q.length,te=2*J>re?2*J:re+5,se=0;if(J>=re)return q;if(kr){var oe=Ioe(te);if(q.copy)q.copy(oe);else for(;se<q.length;++se)oe[se]=q[se];return oe}else if(Se){var Re=new Uint8Array(te);if(Re.set)Re.set(q);else for(;se<J;++se)Re[se]=q[se];return Re}return q.length=te,q}function Ai(q){for(var re=new Array(q),J=0;J<q;++J)re[J]=0;return re}function Ls(q,re,J){var te=1,se=0,oe=0,Re=0,Be=0,Pe=q.length,Oe=Se?new Uint16Array(32):Ai(32);for(oe=0;oe<32;++oe)Oe[oe]=0;for(oe=Pe;oe<J;++oe)q[oe]=0;Pe=q.length;var Le=Se?new Uint16Array(Pe):Ai(Pe);for(oe=0;oe<Pe;++oe)Oe[se=q[oe]]++,te<se&&(te=se),Le[oe]=0;for(Oe[0]=0,oe=1;oe<=te;++oe)Oe[oe+16]=Be=Be+Oe[oe-1]<<1;for(oe=0;oe<Pe;++oe)Be=q[oe],Be!=0&&(Le[oe]=Oe[Be+16]++);var lt=0;for(oe=0;oe<Pe;++oe)if(lt=q[oe],lt!=0)for(Be=Ye(Le[oe],te)>>te-lt,Re=(1<<te+4-lt)-1;Re>=0;--Re)re[Be|Re<<lt]=lt&15|oe<<4;return te}var bt=Se?new Uint16Array(512):Ai(512),Qn=Se?new Uint16Array(32):Ai(32);if(!Se){for(var dr=0;dr<512;++dr)bt[dr]=0;for(dr=0;dr<32;++dr)Qn[dr]=0}(function(){for(var q=[],re=0;re<32;re++)q.push(5);Ls(q,Qn,32);var J=[];for(re=0;re<=143;re++)J.push(8);for(;re<=255;re++)J.push(9);for(;re<=279;re++)J.push(7);for(;re<=287;re++)J.push(8);Ls(J,bt,288)})();var Ft=(function(){for(var re=Se?new Uint8Array(32768):[],J=0,te=0;J<qe.length-1;++J)for(;te<qe[J+1];++te)re[te]=J;for(;te<32768;++te)re[te]=29;var se=Se?new Uint8Array(259):[];for(J=0,te=0;J<ve.length-1;++J)for(;te<ve[J+1];++te)se[te]=J;function oe(Be,Pe){for(var Oe=0;Oe<Be.length;){var Le=Math.min(65535,Be.length-Oe),lt=Oe+Le==Be.length;for(Pe.write_shift(1,+lt),Pe.write_shift(2,Le),Pe.write_shift(2,~Le&65535);Le-- >0;)Pe[Pe.l++]=Be[Oe++]}return Pe.l}function Re(Be,Pe){for(var Oe=0,Le=0,lt=Se?new Uint16Array(32768):[];Le<Be.length;){var gt=Math.min(65535,Be.length-Le);if(gt<10){for(Oe=zn(Pe,Oe,+(Le+gt==Be.length)),Oe&7&&(Oe+=8-(Oe&7)),Pe.l=Oe/8|0,Pe.write_shift(2,gt),Pe.write_shift(2,~gt&65535);gt-- >0;)Pe[Pe.l++]=Be[Le++];Oe=Pe.l*8;continue}Oe=zn(Pe,Oe,+(Le+gt==Be.length)+2);for(var Ct=0;gt-- >0;){var ct=Be[Le];Ct=(Ct<<5^ct)&32767;var ut=-1,En=0;if((ut=lt[Ct])&&(ut|=Le&-32768,ut>Le&&(ut-=32768),ut<Le))for(;Be[ut+En]==Be[Le+En]&&En<250;)++En;if(En>2){ct=se[En],ct<=22?Oe=ei(Pe,Oe,we[ct+1]>>1)-1:(ei(Pe,Oe,3),Oe+=5,ei(Pe,Oe,we[ct-23]>>5),Oe+=3);var Rr=ct<8?0:ct-4>>2;Rr>0&&(_o(Pe,Oe,En-ve[ct]),Oe+=Rr),ct=re[Le-ut],Oe=ei(Pe,Oe,we[ct]>>3),Oe-=3;var jr=ct<4?0:ct-2>>1;jr>0&&(_o(Pe,Oe,Le-ut-qe[ct]),Oe+=jr);for(var vi=0;vi<En;++vi)lt[Ct]=Le&32767,Ct=(Ct<<5^Be[Le])&32767,++Le;gt-=En-1}else ct<=143?ct=ct+48:Oe=Wn(Pe,Oe,1),Oe=ei(Pe,Oe,we[ct]),lt[Ct]=Le&32767,++Le}Oe=ei(Pe,Oe,0)-1}return Pe.l=(Oe+7)/8|0,Pe.l}return function(Pe,Oe){return Pe.length<8?oe(Pe,Oe):Re(Pe,Oe)}})();function jn(q){var re=Ue(50+Math.floor(q.length*1.1)),J=Ft(q,re);return re.slice(0,J)}var en=Se?new Uint16Array(32768):Ai(32768),$o=Se?new Uint16Array(32768):Ai(32768),Gi=Se?new Uint16Array(128):Ai(128),Ds=1,Nn=1;function Ii(q,re){var J=_n(q,re)+257;re+=5;var te=_n(q,re)+1;re+=5;var se=pn(q,re)+4;re+=4;for(var oe=0,Re=Se?new Uint8Array(19):Ai(19),Be=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Pe=1,Oe=Se?new Uint8Array(8):Ai(8),Le=Se?new Uint8Array(8):Ai(8),lt=Re.length,gt=0;gt<se;++gt)Re[le[gt]]=oe=jt(q,re),Pe<oe&&(Pe=oe),Oe[oe]++,re+=3;var Ct=0;for(Oe[0]=0,gt=1;gt<=Pe;++gt)Le[gt]=Ct=Ct+Oe[gt-1]<<1;for(gt=0;gt<lt;++gt)(Ct=Re[gt])!=0&&(Be[gt]=Le[Ct]++);var ct=0;for(gt=0;gt<lt;++gt)if(ct=Re[gt],ct!=0){Ct=we[Be[gt]]>>8-ct;for(var ut=(1<<7-ct)-1;ut>=0;--ut)Gi[Ct|ut<<ct]=ct&7|gt<<3}var En=[];for(Pe=1;En.length<J+te;)switch(Ct=Gi[dt(q,re)],re+=Ct&7,Ct>>>=3){case 16:for(oe=3+on(q,re),re+=2,Ct=En[En.length-1];oe-- >0;)En.push(Ct);break;case 17:for(oe=3+jt(q,re),re+=3;oe-- >0;)En.push(0);break;case 18:for(oe=11+dt(q,re),re+=7;oe-- >0;)En.push(0);break;default:En.push(Ct),Pe<Ct&&(Pe=Ct);break}var Rr=En.slice(0,J),jr=En.slice(J);for(gt=J;gt<286;++gt)Rr[gt]=0;for(gt=te;gt<30;++gt)jr[gt]=0;return Ds=Ls(Rr,en,286),Nn=Ls(jr,$o,30),re}function He(q,re){if(q[0]==3&&!(q[1]&3))return[Q1(re),2];for(var J=0,te=0,se=Ioe(re||1<<18),oe=0,Re=se.length>>>0,Be=0,Pe=0;(te&1)==0;){if(te=jt(q,J),J+=3,te>>>1)te>>1==1?(Be=9,Pe=5):(J=Ii(q,J),Be=Ds,Pe=Nn);else{J&7&&(J+=8-(J&7));var Oe=q[J>>>3]|q[(J>>>3)+1]<<8;if(J+=32,Oe>0)for(!re&&Re<oe+Oe&&(se=Cr(se,oe+Oe),Re=se.length);Oe-- >0;)se[oe++]=q[J>>>3],J+=8;continue}for(;;){!re&&Re<oe+32767&&(se=Cr(se,oe+32767),Re=se.length);var Le=hr(q,J,Be),lt=te>>>1==1?bt[Le]:en[Le];if(J+=lt&15,lt>>>=4,(lt>>>8&255)===0)se[oe++]=lt;else{if(lt==256)break;lt-=257;var gt=lt<8?0:lt-4>>2;gt>5&&(gt=0);var Ct=oe+ve[lt];gt>0&&(Ct+=hr(q,J,gt),J+=gt),Le=hr(q,J,Pe),lt=te>>>1==1?Qn[Le]:$o[Le],J+=lt&15,lt>>>=4;var ct=lt<4?0:lt-2>>1,ut=qe[lt];for(ct>0&&(ut+=hr(q,J,ct),J+=ct),!re&&Re<Ct&&(se=Cr(se,Ct+100),Re=se.length);oe<Ct;)se[oe]=se[oe-ut],++oe}}}return re?[se,J+7>>>3]:[se.slice(0,oe),J+7>>>3]}function ke(q,re){var J=q.slice(q.l||0),te=He(J,re);return q.l+=te[1],te[0]}function Ae(q,re){if(q)typeof console<"u"&&console.error(re);else throw new Error(re)}function sn(q,re){var J=q;nc(J,0);var te=[],se=[],oe={FileIndex:te,FullPaths:se};C(oe,{root:re.root});for(var Re=J.length-4;(J[Re]!=80||J[Re+1]!=75||J[Re+2]!=5||J[Re+3]!=6)&&Re>=0;)--Re;J.l=Re+4,J.l+=4;var Be=J.read_shift(2);J.l+=6;var Pe=J.read_shift(4);for(J.l=Pe,Re=0;Re<Be;++Re){J.l+=20;var Oe=J.read_shift(4),Le=J.read_shift(4),lt=J.read_shift(2),gt=J.read_shift(2),Ct=J.read_shift(2);J.l+=8;var ct=J.read_shift(4),ut=a(J.slice(J.l+lt,J.l+lt+gt));J.l+=lt+gt+Ct;var En=J.l;J.l=ct+4,z(J,Oe,Le,oe,ut),J.l=En}return oe}function z(q,re,J,te,se){q.l+=2;var oe=q.read_shift(2),Re=q.read_shift(2),Be=o(q);if(oe&8257)throw new Error("Unsupported ZIP encryption");for(var Pe=q.read_shift(4),Oe=q.read_shift(4),Le=q.read_shift(4),lt=q.read_shift(2),gt=q.read_shift(2),Ct="",ct=0;ct<lt;++ct)Ct+=String.fromCharCode(q[q.l++]);if(gt){var ut=a(q.slice(q.l,q.l+gt));(ut[21589]||{}).mt&&(Be=ut[21589].mt),((se||{})[21589]||{}).mt&&(Be=se[21589].mt)}q.l+=gt;var En=q.slice(q.l,q.l+Oe);switch(Re){case 8:En=ne(q,Le);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Re)}var Rr=!1;oe&8&&(Pe=q.read_shift(4),Pe==134695760&&(Pe=q.read_shift(4),Rr=!0),Oe=q.read_shift(4),Le=q.read_shift(4)),Oe!=re&&Ae(Rr,"Bad compressed size: "+re+" != "+Oe),Le!=J&&Ae(Rr,"Bad uncompressed size: "+J+" != "+Le),et(te,Ct,En,{unsafe:!0,mt:Be})}function Et(q,re){var J=re||{},te=[],se=[],oe=Ue(1),Re=J.compression?8:0,Be=0,Pe=0,Oe=0,Le=0,lt=0,gt=q.FullPaths[0],Ct=gt,ct=q.FileIndex[0],ut=[],En=0;for(Pe=1;Pe<q.FullPaths.length;++Pe)if(Ct=q.FullPaths[Pe].slice(gt.length),ct=q.FileIndex[Pe],!(!ct.size||!ct.content||Ct=="Sh33tJ5")){var Rr=Le,jr=Ue(Ct.length);for(Oe=0;Oe<Ct.length;++Oe)jr.write_shift(1,Ct.charCodeAt(Oe)&127);jr=jr.slice(0,jr.l),ut[lt]=hvt.buf(ct.content,0);var vi=ct.content;Re==8&&(vi=ie(vi)),oe=Ue(30),oe.write_shift(4,67324752),oe.write_shift(2,20),oe.write_shift(2,Be),oe.write_shift(2,Re),ct.mt?s(oe,ct.mt):oe.write_shift(4,0),oe.write_shift(-4,ut[lt]),oe.write_shift(4,vi.length),oe.write_shift(4,ct.content.length),oe.write_shift(2,jr.length),oe.write_shift(2,0),Le+=oe.length,te.push(oe),Le+=jr.length,te.push(jr),Le+=vi.length,te.push(vi),oe=Ue(46),oe.write_shift(4,33639248),oe.write_shift(2,0),oe.write_shift(2,20),oe.write_shift(2,Be),oe.write_shift(2,Re),oe.write_shift(4,0),oe.write_shift(-4,ut[lt]),oe.write_shift(4,vi.length),oe.write_shift(4,ct.content.length),oe.write_shift(2,jr.length),oe.write_shift(2,0),oe.write_shift(2,0),oe.write_shift(2,0),oe.write_shift(2,0),oe.write_shift(4,0),oe.write_shift(4,Rr),En+=oe.l,se.push(oe),En+=jr.length,se.push(jr),++lt}return oe=Ue(22),oe.write_shift(4,101010256),oe.write_shift(2,0),oe.write_shift(2,0),oe.write_shift(2,lt),oe.write_shift(2,lt),oe.write_shift(4,En),oe.write_shift(4,Le),oe.write_shift(2,0),Oo([Oo(te),Oo(se),oe])}var X={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ae(q,re){if(q.ctype)return q.ctype;var J=q.name||"",te=J.match(/\.([^\.]+)$/);return te&&X[te[1]]||re&&(te=(J=re).match(/[\.\\]([^\.\\])+$/),te&&X[te[1]])?X[te[1]]:"application/octet-stream"}function Ve(q){for(var re=kA(q),J=[],te=0;te<re.length;te+=76)J.push(re.slice(te,te+76));return J.join(`\r
`)+`\r
`}function ee(q){var re=q.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Oe){var Le=Oe.charCodeAt(0).toString(16).toUpperCase();return"="+(Le.length==1?"0"+Le:Le)});re=re.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),re.charAt(0)==`
`&&(re="=0D"+re.slice(1)),re=re.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var J=[],te=re.split(`\r
`),se=0;se<te.length;++se){var oe=te[se];if(oe.length==0){J.push("");continue}for(var Re=0;Re<oe.length;){var Be=76,Pe=oe.slice(Re,Re+Be);Pe.charAt(Be-1)=="="?Be--:Pe.charAt(Be-2)=="="?Be-=2:Pe.charAt(Be-3)=="="&&(Be-=3),Pe=oe.slice(Re,Re+Be),Re+=Be,Re<oe.length&&(Pe+="="),J.push(Pe)}}return J.join(`\r
`)}function ge(q){for(var re=[],J=0;J<q.length;++J){for(var te=q[J];J<=q.length&&te.charAt(te.length-1)=="=";)te=te.slice(0,te.length-1)+q[++J];re.push(te)}for(var se=0;se<re.length;++se)re[se]=re[se].replace(/[=][0-9A-Fa-f]{2}/g,function(oe){return String.fromCharCode(parseInt(oe.slice(1),16))});return rh(re.join(`\r
`))}function je(q,re,J){for(var te="",se="",oe="",Re,Be=0;Be<10;++Be){var Pe=re[Be];if(!Pe||Pe.match(/^\s*$/))break;var Oe=Pe.match(/^(.*?):\s*([^\s].*)$/);if(Oe)switch(Oe[1].toLowerCase()){case"content-location":te=Oe[2].trim();break;case"content-type":oe=Oe[2].trim();break;case"content-transfer-encoding":se=Oe[2].trim();break}}switch(++Be,se.toLowerCase()){case"base64":Re=rh(wp(re.slice(Be).join("")));break;case"quoted-printable":Re=ge(re.slice(Be));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+se)}var Le=et(q,te.slice(J.length),Re,{unsafe:!0});oe&&(Le.ctype=oe)}function Je(q,re){if(De(q.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var J=re&&re.root||"",te=(kr&&Buffer.isBuffer(q)?q.toString("binary"):De(q)).split(`\r
`),se=0,oe="";for(se=0;se<te.length;++se)if(oe=te[se],!!/^Content-Location:/i.test(oe)&&(oe=oe.slice(oe.indexOf("file")),J||(J=oe.slice(0,oe.lastIndexOf("/")+1)),oe.slice(0,J.length)!=J))for(;J.length>0&&(J=J.slice(0,J.length-1),J=J.slice(0,J.lastIndexOf("/")+1),oe.slice(0,J.length)!=J););var Re=(te[1]||"").match(/boundary="(.*?)"/);if(!Re)throw new Error("MAD cannot find boundary");var Be="--"+(Re[1]||""),Pe=[],Oe=[],Le={FileIndex:Pe,FullPaths:Oe};C(Le);var lt,gt=0;for(se=0;se<te.length;++se){var Ct=te[se];Ct!==Be&&Ct!==Be+"--"||(gt++&&je(Le,te.slice(lt,se),J),lt=se)}return Le}function Ge(q,re){var J=re||{},te=J.boundary||"SheetJS";te="------="+te;for(var se=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+te.slice(2)+'"',"","",""],oe=q.FullPaths[0],Re=oe,Be=q.FileIndex[0],Pe=1;Pe<q.FullPaths.length;++Pe)if(Re=q.FullPaths[Pe].slice(oe.length),Be=q.FileIndex[Pe],!(!Be.size||!Be.content||Re=="Sh33tJ5")){Re=Re.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(En){return"_x"+En.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(En){return"_u"+En.charCodeAt(0).toString(16)+"_"});for(var Oe=Be.content,Le=kr&&Buffer.isBuffer(Oe)?Oe.toString("binary"):De(Oe),lt=0,gt=Math.min(1024,Le.length),Ct=0,ct=0;ct<=gt;++ct)(Ct=Le.charCodeAt(ct))>=32&&Ct<128&&++lt;var ut=lt>=gt*4/5;se.push(te),se.push("Content-Location: "+(J.root||"file:///C:/SheetJS/")+Re),se.push("Content-Transfer-Encoding: "+(ut?"quoted-printable":"base64")),se.push("Content-Type: "+ae(Be,Re)),se.push(""),se.push(ut?ee(Le):Ve(Le))}return se.push(te+`--\r
`),se.join(`\r
`)}function nt(q){var re={};return C(re,q),re}function et(q,re,J,te){var se=te&&te.unsafe;se||C(q);var oe=!se&&Xr.find(q,re);if(!oe){var Re=q.FullPaths[0];re.slice(0,Re.length)==Re?Re=re:(Re.slice(-1)!="/"&&(Re+="/"),Re=(Re+re).replace("//","/")),oe={name:i(re),type:2},q.FileIndex.push(oe),q.FullPaths.push(Re),se||Xr.utils.cfb_gc(q)}return oe.content=J,oe.size=J?J.length:0,te&&(te.CLSID&&(oe.clsid=te.CLSID),te.mt&&(oe.mt=te.mt),te.ct&&(oe.ct=te.ct)),oe}function Mt(q,re){C(q);var J=Xr.find(q,re);if(J){for(var te=0;te<q.FileIndex.length;++te)if(q.FileIndex[te]==J)return q.FileIndex.splice(te,1),q.FullPaths.splice(te,1),!0}return!1}function zt(q,re,J){C(q);var te=Xr.find(q,re);if(te){for(var se=0;se<q.FileIndex.length;++se)if(q.FileIndex[se]==te)return q.FileIndex[se].name=i(J),q.FullPaths[se]=J,!0}return!1}function yn(q){O(q,!0)}return e.find=V,e.read=D,e.parse=u,e.write=Ce,e.writeFile=fe,e.utils={cfb_new:nt,cfb_add:et,cfb_del:Mt,cfb_mov:zt,cfb_gc:yn,ReadShift:tk,CheckField:iEe,prep_blob:nc,bconcat:Oo,use_zlib:W,_deflateRaw:jn,_inflateRaw:ke,consts:Ne},e})();function dvt(t){return typeof t=="string"?ML(t):Array.isArray(t)?$1t(t):t}function QI(t,e,n){if(typeof Deno<"u"){if(n&&typeof e=="string")switch(n){case"utf8":e=new TextEncoder(n).encode(e);break;case"binary":e=ML(e);break;default:throw new Error("Unsupported encoding "+n)}return Deno.writeFileSync(t,e)}var r=n=="utf8"?IA(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(r,t);if(typeof Blob<"u"){var i=new Blob([dvt(r)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,t);if(typeof saveAs<"u")return saveAs(i,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:t,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=t,o.href=s,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var a=File(t);return a.open("w"),a.encoding="binary",Array.isArray(e)&&(e=JI(e)),a.write(e),a.close(),e}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+t)}function jo(t){for(var e=Object.keys(t),n=[],r=0;r<e.length;++r)Object.prototype.hasOwnProperty.call(t,e[r])&&n.push(e[r]);return n}function Doe(t,e){for(var n=[],r=jo(t),i=0;i!==r.length;++i)n[t[r[i]][e]]==null&&(n[t[r[i]][e]]=r[i]);return n}function wq(t){for(var e=[],n=jo(t),r=0;r!==n.length;++r)e[t[n[r]]]=n[r];return e}function LL(t){for(var e=[],n=jo(t),r=0;r!==n.length;++r)e[t[n[r]]]=parseInt(n[r],10);return e}function fvt(t){for(var e=[],n=jo(t),r=0;r!==n.length;++r)e[t[n[r]]]==null&&(e[t[n[r]]]=[]),e[t[n[r]]].push(n[r]);return e}var o5=new Date(1899,11,30,0,0,0);function Cl(t,e){var n=t.getTime(),r=o5.getTime()+(t.getTimezoneOffset()-o5.getTimezoneOffset())*6e4;return(n-r)/(1440*60*1e3)}var zbe=new Date,pvt=o5.getTime()+(zbe.getTimezoneOffset()-o5.getTimezoneOffset())*6e4,joe=zbe.getTimezoneOffset();function Gbe(t){var e=new Date;return e.setTime(t*24*60*60*1e3+pvt),e.getTimezoneOffset()!==joe&&e.setTime(e.getTime()+(e.getTimezoneOffset()-joe)*6e4),e}var $oe=new Date("2017-02-19T19:06:09.000Z"),Ube=isNaN($oe.getFullYear())?new Date("2/19/17"):$oe,mvt=Ube.getFullYear()==2017;function Ga(t,e){var n=new Date(t);if(mvt)return e>0?n.setTime(n.getTime()+n.getTimezoneOffset()*60*1e3):e<0&&n.setTime(n.getTime()-n.getTimezoneOffset()*60*1e3),n;if(t instanceof Date)return t;if(Ube.getFullYear()==1917&&!isNaN(n.getFullYear())){var r=n.getFullYear();return t.indexOf(""+r)>-1||n.setFullYear(n.getFullYear()+100),n}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function DL(t,e){if(kr&&Buffer.isBuffer(t))return t.toString("binary");if(typeof TextDecoder<"u")try{var n={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(s){return n[s]||s})}catch{}for(var r=[],i=0;i!=t.length;++i)r.push(String.fromCharCode(t[i]));return r.join("")}function Rl(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=Rl(t[n]));return e}function Ji(t,e){for(var n="";n.length<e;)n+=t;return n}function lp(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var n=1,r=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return n*=100,""});return!isNaN(e=Number(r))||(r=r.replace(/[(](.*)[)]/,function(i,s){return n=-n,s}),!isNaN(e=Number(r)))?e/n:e}var gvt=["january","february","march","april","may","june","july","august","september","october","november","december"];function AA(t){var e=new Date(t),n=new Date(NaN),r=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return n;var o=t.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&gvt.indexOf(o)==-1)return n}else if(o.match(/[a-z]/))return n;return r<0||r>8099?n:(i>0||s>1)&&r!=101?e:t.match(/[^-0-9:,\/\\]/)?n:e}function Un(t,e,n){if(t.FullPaths){if(typeof n=="string"){var r;return kr?r=Cp(n):r=F1t(n),Xr.utils.cfb_add(t,e,r)}Xr.utils.cfb_add(t,e,n)}else t.file(e,n)}function bq(){return Xr.utils.cfb_new()}var Os=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,yvt={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Eq=wq(yvt),Sq=/[&<>'"]/g,vvt=/[\u0000-\u0008\u000b-\u001f]/g;function Wr(t){var e=t+"";return e.replace(Sq,function(n){return Eq[n]}).replace(vvt,function(n){return"_x"+("000"+n.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Foe(t){return Wr(t).replace(/ /g,"_x0020_")}var Bbe=/[\u0000-\u001f]/g;function _vt(t){var e=t+"";return e.replace(Sq,function(n){return Eq[n]}).replace(/\n/g,"<br/>").replace(Bbe,function(n){return"&#x"+("000"+n.charCodeAt(0).toString(16)).slice(-4)+";"})}function xvt(t){var e=t+"";return e.replace(Sq,function(n){return Eq[n]}).replace(Bbe,function(n){return"&#x"+n.charCodeAt(0).toString(16).toUpperCase()+";"})}function wvt(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function bvt(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function rF(t){for(var e="",n=0,r=0,i=0,s=0,o=0,a=0;n<t.length;){if(r=t.charCodeAt(n++),r<128){e+=String.fromCharCode(r);continue}if(i=t.charCodeAt(n++),r>191&&r<224){o=(r&31)<<6,o|=i&63,e+=String.fromCharCode(o);continue}if(s=t.charCodeAt(n++),r<240){e+=String.fromCharCode((r&15)<<12|(i&63)<<6|s&63);continue}o=t.charCodeAt(n++),a=((r&7)<<18|(i&63)<<12|(s&63)<<6|o&63)-65536,e+=String.fromCharCode(55296+(a>>>10&1023)),e+=String.fromCharCode(56320+(a&1023))}return e}function Voe(t){var e=Q1(2*t.length),n,r,i=1,s=0,o=0,a;for(r=0;r<t.length;r+=i)i=1,(a=t.charCodeAt(r))<128?n=a:a<224?(n=(a&31)*64+(t.charCodeAt(r+1)&63),i=2):a<240?(n=(a&15)*4096+(t.charCodeAt(r+1)&63)*64+(t.charCodeAt(r+2)&63),i=3):(i=4,n=(a&7)*262144+(t.charCodeAt(r+1)&63)*4096+(t.charCodeAt(r+2)&63)*64+(t.charCodeAt(r+3)&63),n-=65536,o=55296+(n>>>10&1023),n=56320+(n&1023)),o!==0&&(e[s++]=o&255,e[s++]=o>>>8,o=0),e[s++]=n%256,e[s++]=n>>>8;return e.slice(0,s).toString("ucs2")}function zoe(t){return Cp(t,"binary").toString("utf8")}var RR="foo bar baz",ek=kr&&(zoe(RR)==rF(RR)&&zoe||Voe(RR)==rF(RR)&&Voe)||rF,IA=kr?function(t){return Cp(t,"utf8").toString("binary")}:function(t){for(var e=[],n=0,r=0,i=0;n<t.length;)switch(r=t.charCodeAt(n++),!0){case r<128:e.push(String.fromCharCode(r));break;case r<2048:e.push(String.fromCharCode(192+(r>>6))),e.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,i=t.charCodeAt(n++)-56320+(r<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(r>>12))),e.push(String.fromCharCode(128+(r>>6&63))),e.push(String.fromCharCode(128+(r&63)))}return e.join("")},Evt=(function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(n){for(var r=n.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)r=r.replace(t[i][0],t[i][1]);return r}})(),Wbe=/(^\s|\s$|\n)/;function Lo(t,e){return"<"+t+(e.match(Wbe)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function PA(t){return jo(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function yt(t,e,n){return"<"+t+(n!=null?PA(n):"")+(e!=null?(e.match(Wbe)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function $z(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(n){if(e)throw n}return""}function Svt(t,e){switch(typeof t){case"string":var n=yt("vt:lpwstr",Wr(t));return n=n.replace(/&quot;/g,"_x0022_"),n;case"number":return yt((t|0)==t?"vt:i4":"vt:r8",Wr(String(t)));case"boolean":return yt("vt:bool",t?"true":"false")}if(t instanceof Date)return yt("vt:filetime",$z(t));throw new Error("Unable to serialize "+t)}var uo={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Ib=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],oc={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function Tvt(t,e){for(var n=1-2*(t[e+7]>>>7),r=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),i=t[e+6]&15,s=5;s>=0;--s)i=i*256+t[e+s];return r==2047?i==0?n*(1/0):NaN:(r==0?r=-1022:(r-=1023,i+=Math.pow(2,52)),n*Math.pow(2,r-52)*i)}function kvt(t,e,n){var r=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,o=r?-e:e;isFinite(o)?o==0?i=s=0:(i=Math.floor(Math.log(o)/Math.LN2),s=o*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var a=0;a<=5;++a,s/=256)t[n+a]=s&255;t[n+6]=(i&15)<<4|s&15,t[n+7]=i>>4|r}var Goe=function(t){for(var e=[],n=10240,r=0;r<t[0].length;++r)if(t[0][r])for(var i=0,s=t[0][r].length;i<s;i+=n)e.push.apply(e,t[0][r].slice(i,i+n));return e},Uoe=kr?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:Cp(e)})):Goe(t)}:Goe,Boe=function(t,e,n){for(var r=[],i=e;i<n;i+=2)r.push(String.fromCharCode(XS(t,i)));return r.join("").replace(QT,"")},Tq=kr?function(t,e,n){return Buffer.isBuffer(t)?t.toString("utf16le",e,n).replace(QT,""):Boe(t,e,n)}:Boe,Woe=function(t,e,n){for(var r=[],i=e;i<e+n;++i)r.push(("0"+t[i].toString(16)).slice(-2));return r.join("")},Hbe=kr?function(t,e,n){return Buffer.isBuffer(t)?t.toString("hex",e,e+n):Woe(t,e,n)}:Woe,Hoe=function(t,e,n){for(var r=[],i=e;i<n;i++)r.push(String.fromCharCode(xx(t,i)));return r.join("")},eP=kr?function(e,n,r){return Buffer.isBuffer(e)?e.toString("utf8",n,r):Hoe(e,n,r)}:Hoe,qbe=function(t,e){var n=ac(t,e);return n>0?eP(t,e+4,e+4+n-1):""},Kbe=qbe,Ybe=function(t,e){var n=ac(t,e);return n>0?eP(t,e+4,e+4+n-1):""},Xbe=Ybe,Zbe=function(t,e){var n=2*ac(t,e);return n>0?eP(t,e+4,e+4+n-1):""},Jbe=Zbe,Qbe=function(e,n){var r=ac(e,n);return r>0?Tq(e,n+4,n+4+r):""},eEe=Qbe,tEe=function(t,e){var n=ac(t,e);return n>0?eP(t,e+4,e+4+n):""},nEe=tEe,rEe=function(t,e){return Tvt(t,e)},a5=rEe,kq=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};kr&&(Kbe=function(e,n){if(!Buffer.isBuffer(e))return qbe(e,n);var r=e.readUInt32LE(n);return r>0?e.toString("utf8",n+4,n+4+r-1):""},Xbe=function(e,n){if(!Buffer.isBuffer(e))return Ybe(e,n);var r=e.readUInt32LE(n);return r>0?e.toString("utf8",n+4,n+4+r-1):""},Jbe=function(e,n){if(!Buffer.isBuffer(e))return Zbe(e,n);var r=2*e.readUInt32LE(n);return e.toString("utf16le",n+4,n+4+r-1)},eEe=function(e,n){if(!Buffer.isBuffer(e))return Qbe(e,n);var r=e.readUInt32LE(n);return e.toString("utf16le",n+4,n+4+r)},nEe=function(e,n){if(!Buffer.isBuffer(e))return tEe(e,n);var r=e.readUInt32LE(n);return e.toString("utf8",n+4,n+4+r)},a5=function(e,n){return Buffer.isBuffer(e)?e.readDoubleLE(n):rEe(e,n)},kq=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var xx=function(t,e){return t[e]},XS=function(t,e){return t[e+1]*256+t[e]},Avt=function(t,e){var n=t[e+1]*256+t[e];return n<32768?n:(65535-n+1)*-1},ac=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},Py=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},Ivt=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function tk(t,e){var n="",r,i,s=[],o,a,l,c;switch(e){case"dbcs":if(c=this.l,kr&&Buffer.isBuffer(this))n=this.slice(this.l,this.l+2*t).toString("utf16le");else for(l=0;l<t;++l)n+=String.fromCharCode(XS(this,c)),c+=2;t*=2;break;case"utf8":n=eP(this,this.l,this.l+t);break;case"utf16le":t*=2,n=Tq(this,this.l,this.l+t);break;case"wstr":return tk.call(this,t,"dbcs");case"lpstr-ansi":n=Kbe(this,this.l),t=4+ac(this,this.l);break;case"lpstr-cp":n=Xbe(this,this.l),t=4+ac(this,this.l);break;case"lpwstr":n=Jbe(this,this.l),t=4+2*ac(this,this.l);break;case"lpp4":t=4+ac(this,this.l),n=eEe(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+ac(this,this.l),n=nEe(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,n="";(o=xx(this,this.l+t++))!==0;)s.push(IR(o));n=s.join("");break;case"_wstr":for(t=0,n="";(o=XS(this,this.l+t))!==0;)s.push(IR(o)),t+=2;t+=2,n=s.join("");break;case"dbcs-cont":for(n="",c=this.l,l=0;l<t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return o=xx(this,c),this.l=c+1,a=tk.call(this,t-l,o?"dbcs-cont":"sbcs-cont"),s.join("")+a;s.push(IR(XS(this,c))),c+=2}n=s.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(n="",c=this.l,l=0;l!=t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return o=xx(this,c),this.l=c+1,a=tk.call(this,t-l,o?"dbcs-cont":"sbcs-cont"),s.join("")+a;s.push(IR(xx(this,c))),c+=1}n=s.join("");break;default:switch(t){case 1:return r=xx(this,this.l),this.l++,r;case 2:return r=(e==="i"?Avt:XS)(this,this.l),this.l+=2,r;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(r=(t>0?Py:Ivt)(this,this.l),this.l+=4,r):(i=ac(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return t==8?i=a5(this,this.l):i=a5([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:n=Hbe(this,this.l,t);break}}return this.l+=t,n}var Pvt=function(t,e,n){t[n]=e&255,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24&255},Cvt=function(t,e,n){t[n]=e&255,t[n+1]=e>>8&255,t[n+2]=e>>16&255,t[n+3]=e>>24&255},Rvt=function(t,e,n){t[n]=e&255,t[n+1]=e>>>8&255};function Mvt(t,e,n){var r=0,i=0;if(n==="dbcs"){for(i=0;i!=e.length;++i)Rvt(this,e.charCodeAt(i),this.l+2*i);r=2*e.length}else if(n==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;r=e.length}else if(n==="hex"){for(;i<t;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(n==="utf16le"){var s=Math.min(this.l+t,this.length);for(i=0;i<Math.min(e.length,t);++i){var o=e.charCodeAt(i);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(t){case 1:r=1,this[this.l]=e&255;break;case 2:r=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:r=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:r=4,Pvt(this,e,this.l);break;case 8:if(r=8,n==="f"){kvt(this,e,this.l);break}case 16:break;case-4:r=4,Cvt(this,e,this.l);break}return this.l+=r,this}function iEe(t,e){var n=Hbe(this,this.l,t.length>>1);if(n!==t)throw new Error(e+"Expected "+t+" saw "+n);this.l+=t.length>>1}function nc(t,e){t.l=e,t.read_shift=tk,t.chk=iEe,t.write_shift=Mvt}function Vd(t,e){t.l+=e}function Ue(t){var e=Q1(t);return nc(e,0),e}function Tl(){var t=[],e=kr?256:2048,n=function(c){var u=Ue(c);return nc(u,0),u},r=n(e),i=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&t.push(r),r=null)},s=function(c){return r&&c<r.length-r.l?r:(i(),r=n(Math.max(c+1,e)))},o=function(){return i(),Oo(t)},a=function(c){i(),r=c,r.l==null&&(r.l=r.length),s(e)};return{next:s,push:a,end:o,_bufs:t}}function tt(t,e,n,r){var i=+e,s;if(!isNaN(i)){r||(r=TEt[i].p||(n||[]).length||0),s=1+(i>=128?1:0)+1,r>=128&&++s,r>=16384&&++s,r>=2097152&&++s;var o=t.next(s);i<=127?o.write_shift(1,i):(o.write_shift(1,(i&127)+128),o.write_shift(1,i>>7));for(var a=0;a!=4;++a)if(r>=128)o.write_shift(1,(r&127)+128),r>>=7;else{o.write_shift(1,r);break}r>0&&kq(n)&&t.push(n)}}function nk(t,e,n){var r=Rl(t);if(e.s?(r.cRel&&(r.c+=e.s.c),r.rRel&&(r.r+=e.s.r)):(r.cRel&&(r.c+=e.c),r.rRel&&(r.r+=e.r)),!n||n.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function qoe(t,e,n){var r=Rl(t);return r.s=nk(r.s,e.s,n),r.e=nk(r.e,e.s,n),r}function rk(t,e){if(t.cRel&&t.c<0)for(t=Rl(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=Rl(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var n=qr(t);return!t.cRel&&t.cRel!=null&&(n=Lvt(n)),!t.rRel&&t.rRel!=null&&(n=Nvt(n)),n}function iF(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+_a(t.s.c)+":"+(t.e.cRel?"":"$")+_a(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Do(t.s.r)+":"+(t.e.rRel?"":"$")+Do(t.e.r):rk(t.s,e.biff)+":"+rk(t.e,e.biff)}function Aq(t){return parseInt(Ovt(t),10)-1}function Do(t){return""+(t+1)}function Nvt(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Ovt(t){return t.replace(/\$(\d+)$/,"$1")}function Iq(t){for(var e=Dvt(t),n=0,r=0;r!==e.length;++r)n=26*n+e.charCodeAt(r)-64;return n-1}function _a(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function Lvt(t){return t.replace(/^([A-Z])/,"$$$1")}function Dvt(t){return t.replace(/^\$([A-Z])/,"$1")}function jvt(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function fo(t){for(var e=0,n=0,r=0;r<t.length;++r){var i=t.charCodeAt(r);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(n=26*n+(i-64))}return{c:n-1,r:e-1}}function qr(t){for(var e=t.c+1,n="";e;e=(e-1)/26|0)n=String.fromCharCode((e-1)%26+65)+n;return n+(t.r+1)}function Ec(t){var e=t.indexOf(":");return e==-1?{s:fo(t),e:fo(t)}:{s:fo(t.slice(0,e)),e:fo(t.slice(e+1))}}function Ms(t,e){return typeof e>"u"||typeof e=="number"?Ms(t.s,t.e):(typeof t!="string"&&(t=qr(t)),typeof e!="string"&&(e=qr(e)),t==e?t:t+":"+e)}function yi(t){var e={s:{c:0,r:0},e:{c:0,r:0}},n=0,r=0,i=0,s=t.length;for(n=0;r<s&&!((i=t.charCodeAt(r)-64)<1||i>26);++r)n=26*n+i;for(e.s.c=--n,n=0;r<s&&!((i=t.charCodeAt(r)-48)<0||i>9);++r)n=10*n+i;if(e.s.r=--n,r===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++r,n=0;r!=s&&!((i=t.charCodeAt(r)-64)<1||i>26);++r)n=26*n+i;for(e.e.c=--n,n=0;r!=s&&!((i=t.charCodeAt(r)-48)<0||i>9);++r)n=10*n+i;return e.e.r=--n,e}function Koe(t,e){var n=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=Jg(t.z,n?Cl(e):e)}catch{}try{return t.w=Jg((t.XF||{}).numFmtId||(n?14:0),n?Cl(e):e)}catch{return""+e}}function bp(t,e,n){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&n&&n.dateNF&&(t.z=n.dateNF),t.t=="e"?tP[t.v]||t.v:e==null?Koe(t,t.v):Koe(t,e))}function wv(t,e){var n=e&&e.sheet?e.sheet:"Sheet1",r={};return r[n]=t,{SheetNames:[n],Sheets:r}}function sEe(t,e,n){var r=n||{},i=t?Array.isArray(t):r.dense,s=t||(i?[]:{}),o=0,a=0;if(s&&r.origin!=null){if(typeof r.origin=="number")o=r.origin;else{var l=typeof r.origin=="string"?fo(r.origin):r.origin;o=l.r,a=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var u=yi(s["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),o==-1&&(c.e.r=o=u.e.r+1)}for(var h=0;h!=e.length;++h)if(e[h]){if(!Array.isArray(e[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var f=0;f!=e[h].length;++f)if(!(typeof e[h][f]>"u")){var g={v:e[h][f]},y=o+h,_=a+f;if(c.s.r>y&&(c.s.r=y),c.s.c>_&&(c.s.c=_),c.e.r<y&&(c.e.r=y),c.e.c<_&&(c.e.c=_),e[h][f]&&typeof e[h][f]=="object"&&!Array.isArray(e[h][f])&&!(e[h][f]instanceof Date))g=e[h][f];else if(Array.isArray(g.v)&&(g.f=e[h][f][1],g.v=g.v[0]),g.v===null)if(g.f)g.t="n";else if(r.nullError)g.t="e",g.v=0;else if(r.sheetStubs)g.t="z";else continue;else typeof g.v=="number"?g.t="n":typeof g.v=="boolean"?g.t="b":g.v instanceof Date?(g.z=r.dateNF||rs[14],r.cellDates?(g.t="d",g.w=Jg(g.z,Cl(g.v))):(g.t="n",g.v=Cl(g.v),g.w=Jg(g.z,g.v))):g.t="s";if(i)s[y]||(s[y]=[]),s[y][_]&&s[y][_].z&&(g.z=s[y][_].z),s[y][_]=g;else{var b=qr({c:_,r:y});s[b]&&s[b].z&&(g.z=s[b].z),s[b]=g}}}return c.s.c<1e7&&(s["!ref"]=Ms(c)),s}function Pb(t,e){return sEe(null,t,e)}function $vt(t){return t.read_shift(4,"i")}function ph(t,e){return e||(e=Ue(4)),e.write_shift(4,t),e}function xa(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function po(t,e){var n=!1;return e==null&&(n=!0,e=Ue(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),n?e.slice(0,e.l):e}function Fvt(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function Vvt(t,e){return e||(e=Ue(4)),e.write_shift(2,0),e.write_shift(2,0),e}function Pq(t,e){var n=t.l,r=t.read_shift(1),i=xa(t),s=[],o={t:i,h:i};if((r&1)!==0){for(var a=t.read_shift(4),l=0;l!=a;++l)s.push(Fvt(t));o.r=s}else o.r=[{ich:0,ifnt:0}];return t.l=n+e,o}function zvt(t,e){var n=!1;return e==null&&(n=!0,e=Ue(15+4*t.t.length)),e.write_shift(1,0),po(t.t,e),n?e.slice(0,e.l):e}var Gvt=Pq;function Uvt(t,e){var n=!1;return e==null&&(n=!0,e=Ue(23+4*t.t.length)),e.write_shift(1,1),po(t.t,e),e.write_shift(4,1),Vvt({},e),n?e.slice(0,e.l):e}function bu(t){var e=t.read_shift(4),n=t.read_shift(2);return n+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:n}}function bv(t,e){return e==null&&(e=Ue(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function Ev(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function Sv(t,e){return e==null&&(e=Ue(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var Bvt=xa,oEe=po;function Cq(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function l5(t,e){var n=!1;return e==null&&(n=!0,e=Ue(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),n?e.slice(0,e.l):e}var Wvt=xa,Fz=Cq,Rq=l5;function aEe(t){var e=t.slice(t.l,t.l+4),n=e[0]&1,r=e[0]&2;t.l+=4;var i=r===0?a5([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Py(e,0)>>2;return n?i/100:i}function lEe(t,e){e==null&&(e=Ue(4));var n=0,r=0,i=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?r=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(r=1,n=1),r)e.write_shift(-4,((n?i:t)<<2)+(n+2));else throw new Error("unsupported RkNumber "+t)}function cEe(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function Hvt(t,e){return e||(e=Ue(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var Tv=cEe,Cb=Hvt;function Rb(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function ev(t,e){return(e||Ue(8)).write_shift(8,t,"f")}function qvt(t){var e={},n=t.read_shift(1),r=n>>>1,i=t.read_shift(1),s=t.read_shift(2,"i"),o=t.read_shift(1),a=t.read_shift(1),l=t.read_shift(1);switch(t.l++,r){case 0:e.auto=1;break;case 1:e.index=i;var c=n_t[i];c&&(e.rgb=sae(c));break;case 2:e.rgb=sae([o,a,l]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function c5(t,e){if(e||(e=Ue(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var n=t.tint||0;if(n>0?n*=32767:n<0&&(n*=32768),e.write_shift(2,n),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var r=t.rgb||"FFFFFF";typeof r=="number"&&(r=("000000"+r.toString(16)).slice(-6)),e.write_shift(1,parseInt(r.slice(0,2),16)),e.write_shift(1,parseInt(r.slice(2,4),16)),e.write_shift(1,parseInt(r.slice(4,6),16)),e.write_shift(1,255)}return e}function Kvt(t){var e=t.read_shift(1);t.l++;var n={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return n}function Yvt(t,e){e||(e=Ue(2));var n=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,n),e.write_shift(1,0),e}var uEe=2,Jl=3,MR=11,u5=19,NR=64,Xvt=65,Zvt=71,Jvt=4108,Qvt=4126,Ro=80,Yoe={1:{n:"CodePage",t:uEe},2:{n:"Category",t:Ro},3:{n:"PresentationFormat",t:Ro},4:{n:"ByteCount",t:Jl},5:{n:"LineCount",t:Jl},6:{n:"ParagraphCount",t:Jl},7:{n:"SlideCount",t:Jl},8:{n:"NoteCount",t:Jl},9:{n:"HiddenCount",t:Jl},10:{n:"MultimediaClipCount",t:Jl},11:{n:"ScaleCrop",t:MR},12:{n:"HeadingPairs",t:Jvt},13:{n:"TitlesOfParts",t:Qvt},14:{n:"Manager",t:Ro},15:{n:"Company",t:Ro},16:{n:"LinksUpToDate",t:MR},17:{n:"CharacterCount",t:Jl},19:{n:"SharedDoc",t:MR},22:{n:"HyperlinksChanged",t:MR},23:{n:"AppVersion",t:Jl,p:"version"},24:{n:"DigSig",t:Xvt},26:{n:"ContentType",t:Ro},27:{n:"ContentStatus",t:Ro},28:{n:"Language",t:Ro},29:{n:"Version",t:Ro},255:{},2147483648:{n:"Locale",t:u5},2147483651:{n:"Behavior",t:u5},1919054434:{}},Xoe={1:{n:"CodePage",t:uEe},2:{n:"Title",t:Ro},3:{n:"Subject",t:Ro},4:{n:"Author",t:Ro},5:{n:"Keywords",t:Ro},6:{n:"Comments",t:Ro},7:{n:"Template",t:Ro},8:{n:"LastAuthor",t:Ro},9:{n:"RevNumber",t:Ro},10:{n:"EditTime",t:NR},11:{n:"LastPrinted",t:NR},12:{n:"CreatedDate",t:NR},13:{n:"ModifiedDate",t:NR},14:{n:"PageCount",t:Jl},15:{n:"WordCount",t:Jl},16:{n:"CharCount",t:Jl},17:{n:"Thumbnail",t:Zvt},18:{n:"Application",t:Ro},19:{n:"DocSecurity",t:Jl},255:{},2147483648:{n:"Locale",t:u5},2147483651:{n:"Behavior",t:u5},1919054434:{}};function e_t(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var t_t=e_t([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),n_t=Rl(t_t),tP={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},r_t={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},OR={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function hEe(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function dEe(t,e){var n=fvt(r_t),r=[],i;r[r.length]=Os,r[r.length]=yt("Types",null,{xmlns:uo.CT,"xmlns:xsd":uo.xsd,"xmlns:xsi":uo.xsi}),r=r.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return yt("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){t[l]&&t[l].length>0&&(i=t[l][0],r[r.length]=yt("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:OR[l][e.bookType]||OR[l].xlsx}))},o=function(l){(t[l]||[]).forEach(function(c){r[r.length]=yt("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:OR[l][e.bookType]||OR[l].xlsx})})},a=function(l){(t[l]||[]).forEach(function(c){r[r.length]=yt("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:n[l][0]})})};return s("workbooks"),o("sheets"),o("charts"),a("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(a),a("vba"),a("comments"),a("threadedcomments"),a("drawings"),o("metadata"),a("people"),r.length>2&&(r[r.length]="</Types>",r[1]=r[1].replace("/>",">")),r.join("")}var xr={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function fEe(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function Sw(t){var e=[Os,yt("Relationships",null,{xmlns:uo.RELS})];return jo(t["!id"]).forEach(function(n){e[e.length]=yt("Relationship",null,t["!id"][n])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function zr(t,e,n,r,i,s){if(i||(i={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,i.Id="rId"+e,i.Type=r,i.Target=n,[xr.HLINK,xr.XPATH,xr.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),t["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][i.Id]=i,t[("/"+i.Target).replace("//","/")]=i,e}function i_t(t){var e=[Os];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var n=0;n<t.length;++n)e.push('  <manifest:file-entry manifest:full-path="'+t[n][0]+'" manifest:media-type="'+t[n][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function Zoe(t,e,n){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(n||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function s_t(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function o_t(t){var e=[Os];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var n=0;n!=t.length;++n)e.push(Zoe(t[n][0],t[n][1])),e.push(s_t("",t[n][0]));return e.push(Zoe("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function pEe(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+t5.version+"</meta:generator></office:meta></office:document-meta>"}var h1=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function sF(t,e,n,r,i){i[t]!=null||e==null||e===""||(i[t]=e,e=Wr(e),r[r.length]=n?yt(t,e,n):Lo(t,e))}function mEe(t,e){var n=e||{},r=[Os,yt("cp:coreProperties",null,{"xmlns:cp":uo.CORE_PROPS,"xmlns:dc":uo.dc,"xmlns:dcterms":uo.dcterms,"xmlns:dcmitype":uo.dcmitype,"xmlns:xsi":uo.xsi})],i={};if(!t&&!n.Props)return r.join("");t&&(t.CreatedDate!=null&&sF("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:$z(t.CreatedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i),t.ModifiedDate!=null&&sF("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:$z(t.ModifiedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i));for(var s=0;s!=h1.length;++s){var o=h1[s],a=n.Props&&n.Props[o[1]]!=null?n.Props[o[1]]:t?t[o[1]]:null;a===!0?a="1":a===!1?a="0":typeof a=="number"&&(a=String(a)),a!=null&&sF(o[0],a,null,r,i)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}var Tw=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],gEe=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function yEe(t){var e=[],n=yt;return t||(t={}),t.Application="SheetJS",e[e.length]=Os,e[e.length]=yt("Properties",null,{xmlns:uo.EXT_PROPS,"xmlns:vt":uo.vt}),Tw.forEach(function(r){if(t[r[1]]!==void 0){var i;switch(r[2]){case"string":i=Wr(String(t[r[1]]));break;case"bool":i=t[r[1]]?"true":"false";break}i!==void 0&&(e[e.length]=n(r[0],i))}}),e[e.length]=n("HeadingPairs",n("vt:vector",n("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+n("vt:variant",n("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=n("TitlesOfParts",n("vt:vector",t.SheetNames.map(function(r){return"<vt:lpstr>"+Wr(r)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}function vEe(t){var e=[Os,yt("Properties",null,{xmlns:uo.CUST_PROPS,"xmlns:vt":uo.vt})];if(!t)return e.join("");var n=1;return jo(t).forEach(function(i){++n,e[e.length]=yt("property",Svt(t[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:n,name:Wr(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var Joe={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function a_t(t,e){var n=[];return jo(Joe).map(function(r){for(var i=0;i<h1.length;++i)if(h1[i][1]==r)return h1[i];for(i=0;i<Tw.length;++i)if(Tw[i][1]==r)return Tw[i];throw r}).forEach(function(r){if(t[r[1]]!=null){var i=e&&e.Props&&e.Props[r[1]]!=null?e.Props[r[1]]:t[r[1]];switch(r[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),n.push(Lo(Joe[r[1]]||r[1],i))}}),yt("DocumentProperties",n.join(""),{xmlns:oc.o})}function l_t(t,e){var n=["Worksheets","SheetNames"],r="CustomDocumentProperties",i=[];return t&&jo(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)){for(var o=0;o<h1.length;++o)if(s==h1[o][1])return;for(o=0;o<Tw.length;++o)if(s==Tw[o][1])return;for(o=0;o<n.length;++o)if(s==n[o])return;var a=t[s],l="string";typeof a=="number"?(l="float",a=String(a)):a===!0||a===!1?(l="boolean",a=a?"1":"0"):a=String(a),i.push(yt(Foe(s),a,{"dt:dt":l}))}}),e&&jo(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(t&&Object.prototype.hasOwnProperty.call(t,s))){var o=e[s],a="string";typeof o=="number"?(a="float",o=String(o)):o===!0||o===!1?(a="boolean",o=o?"1":"0"):o instanceof Date?(a="dateTime.tz",o=o.toISOString()):o=String(o),i.push(yt(Foe(s),o,{"dt:dt":a}))}}),"<"+r+' xmlns="'+oc.o+'">'+i.join("")+"</"+r+">"}function c_t(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,n=e.getTime()/1e3+11644473600,r=n%Math.pow(2,32),i=(n-r)/Math.pow(2,32);r*=1e7,i*=1e7;var s=r/Math.pow(2,32)|0;s>0&&(r=r%Math.pow(2,32),i+=s);var o=Ue(8);return o.write_shift(4,r),o.write_shift(4,i),o}function Qoe(t,e){var n=Ue(4),r=Ue(4);switch(n.write_shift(4,t==80?31:t),t){case 3:r.write_shift(-4,e);break;case 5:r=Ue(8),r.write_shift(8,e,"f");break;case 11:r.write_shift(4,e?1:0);break;case 64:r=c_t(e);break;case 31:case 80:for(r=Ue(4+2*(e.length+1)+(e.length%2?0:2)),r.write_shift(4,e.length+1),r.write_shift(0,e,"dbcs");r.l!=r.length;)r.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return Oo([n,r])}var _Ee=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function u_t(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function eae(t,e,n){var r=Ue(8),i=[],s=[],o=8,a=0,l=Ue(8),c=Ue(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),s.push(l),i.push(c),o+=8+l.length,!e){c=Ue(8),c.write_shift(4,0),i.unshift(c);var u=[Ue(4)];for(u[0].write_shift(4,t.length),a=0;a<t.length;++a){var h=t[a][0];for(l=Ue(8+2*(h.length+1)+(h.length%2?0:2)),l.write_shift(4,a+2),l.write_shift(4,h.length+1),l.write_shift(0,h,"dbcs");l.l!=l.length;)l.write_shift(1,0);u.push(l)}l=Oo(u),s.unshift(l),o+=8+l.length}for(a=0;a<t.length;++a)if(!(e&&!e[t[a][0]])&&!(_Ee.indexOf(t[a][0])>-1||gEe.indexOf(t[a][0])>-1)&&t[a][1]!=null){var f=t[a][1],g=0;if(e){g=+e[t[a][0]];var y=n[g];if(y.p=="version"&&typeof f=="string"){var _=f.split(".");f=(+_[0]<<16)+(+_[1]||0)}l=Qoe(y.t,f)}else{var b=u_t(f);b==-1&&(b=31,f=String(f)),l=Qoe(b,f)}s.push(l),c=Ue(8),c.write_shift(4,e?g:2+a),i.push(c),o+=8+l.length}var T=8*(s.length+1);for(a=0;a<s.length;++a)i[a].write_shift(4,T),T+=s[a].length;return r.write_shift(4,o),r.write_shift(4,s.length),Oo([r].concat(i).concat(s))}function tae(t,e,n,r,i,s){var o=Ue(i?68:48),a=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,Xr.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,i?2:1),o.write_shift(16,e,"hex"),o.write_shift(4,i?68:48);var l=eae(t,n,r);if(a.push(l),i){var c=eae(i,null,null);o.write_shift(16,s,"hex"),o.write_shift(4,68+l.length),a.push(c)}return Oo(a)}function h_t(t,e){e||(e=Ue(t));for(var n=0;n<t;++n)e.write_shift(1,0);return e}function d_t(t,e){return t.read_shift(e)===1}function Ma(t,e){return e||(e=Ue(2)),e.write_shift(2,+!!t),e}function xEe(t){return t.read_shift(2,"u")}function Yc(t,e){return e||(e=Ue(2)),e.write_shift(2,t),e}function wEe(t,e,n){return n||(n=Ue(2)),n.write_shift(1,e=="e"?+t:+!!t),n.write_shift(1,e=="e"?1:0),n}function bEe(t,e,n){var r=t.read_shift(n&&n.biff>=12?2:1),i="sbcs-cont";if(n&&n.biff>=8,!n||n.biff==8){var s=t.read_shift(1);s&&(i="dbcs-cont")}else n.biff==12&&(i="wstr");n.biff>=2&&n.biff<=5&&(i="cpstr");var o=r?t.read_shift(r,i):"";return o}function f_t(t){var e=t.t||"",n=Ue(3);n.write_shift(2,e.length),n.write_shift(1,1);var r=Ue(2*e.length);r.write_shift(2*e.length,e,"utf16le");var i=[n,r];return Oo(i)}function p_t(t,e,n){var r;if(n){if(n.biff>=2&&n.biff<=5)return t.read_shift(e,"cpstr");if(n.biff>=12)return t.read_shift(e,"dbcs-cont")}var i=t.read_shift(1);return i===0?r=t.read_shift(e,"sbcs-cont"):r=t.read_shift(e,"dbcs-cont"),r}function m_t(t,e,n){var r=t.read_shift(n&&n.biff==2?1:2);return r===0?(t.l++,""):p_t(t,r,n)}function g_t(t,e,n){if(n.biff>5)return m_t(t,e,n);var r=t.read_shift(1);return r===0?(t.l++,""):t.read_shift(r,n.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function EEe(t,e,n){return n||(n=Ue(3+2*t.length)),n.write_shift(2,t.length),n.write_shift(1,1),n.write_shift(31,t,"utf16le"),n}function nae(t,e){e||(e=Ue(6+t.length*2)),e.write_shift(4,1+t.length);for(var n=0;n<t.length;++n)e.write_shift(2,t.charCodeAt(n));return e.write_shift(2,0),e}function y_t(t){var e=Ue(512),n=0,r=t.Target;r.slice(0,7)=="file://"&&(r=r.slice(7));var i=r.indexOf("#"),s=i>-1?31:23;switch(r.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var o=[8,6815827,6619237,4849780,83];for(n=0;n<o.length;++n)e.write_shift(4,o[n]);if(s==28)r=r.slice(1),nae(r,e);else if(s&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<o.length;++n)e.write_shift(1,parseInt(o[n],16));var a=i>-1?r.slice(0,i):r;for(e.write_shift(4,2*(a.length+1)),n=0;n<a.length;++n)e.write_shift(2,a.charCodeAt(n));e.write_shift(2,0),s&8&&nae(i>-1?r.slice(i+1):"",e)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),n=0;n<o.length;++n)e.write_shift(1,parseInt(o[n],16));for(var l=0;r.slice(l*3,l*3+3)=="../"||r.slice(l*3,l*3+3)=="..\\";)++l;for(e.write_shift(2,l),e.write_shift(4,r.length-3*l+1),n=0;n<r.length-3*l;++n)e.write_shift(1,r.charCodeAt(n+3*l)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),n=0;n<6;++n)e.write_shift(4,0)}return e.slice(0,e.l)}function tv(t,e,n,r){return r||(r=Ue(6)),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(2,n||0),r}function v_t(t,e,n){var r=n.biff>8?4:2,i=t.read_shift(r),s=t.read_shift(r,"i"),o=t.read_shift(r,"i");return[i,s,o]}function __t(t){var e=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(2),i=t.read_shift(2);return{s:{c:r,r:e},e:{c:i,r:n}}}function SEe(t,e){return e||(e=Ue(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function Mq(t,e,n){var r=1536,i=16;switch(n.bookType){case"biff8":break;case"biff5":r=1280,i=8;break;case"biff4":r=4,i=6;break;case"biff3":r=3,i=6;break;case"biff2":r=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=Ue(i);return s.write_shift(2,r),s.write_shift(2,e),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function x_t(t,e){var n=!e||e.biff==8,r=Ue(n?112:54);for(r.write_shift(e.biff==8?2:1,7),n&&r.write_shift(1,0),r.write_shift(4,859007059),r.write_shift(4,5458548|(n?0:536870912));r.l<r.length;)r.write_shift(1,n?0:32);return r}function w_t(t,e){var n=!e||e.biff>=8?2:1,r=Ue(8+n*t.name.length);r.write_shift(4,t.pos),r.write_shift(1,t.hs||0),r.write_shift(1,t.dt),r.write_shift(1,t.name.length),e.biff>=8&&r.write_shift(1,1),r.write_shift(n*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var i=r.slice(0,r.l);return i.l=r.l,i}function b_t(t,e){var n=Ue(8);n.write_shift(4,t.Count),n.write_shift(4,t.Unique);for(var r=[],i=0;i<t.length;++i)r[i]=f_t(t[i]);var s=Oo([n].concat(r));return s.parts=[n.length].concat(r.map(function(o){return o.length})),s}function E_t(){var t=Ue(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function S_t(t){var e=Ue(18),n=1718;return t&&t.RTL&&(n|=64),e.write_shift(2,n),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function T_t(t,e){var n=t.name||"Arial",r=e&&e.biff==5,i=r?15+n.length:16+2*n.length,s=Ue(i);return s.write_shift(2,t.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,n.length),r||s.write_shift(1,1),s.write_shift((r?1:2)*n.length,n,r?"sbcs":"utf16le"),s}function k_t(t,e,n,r){var i=Ue(10);return tv(t,e,r,i),i.write_shift(4,n),i}function A_t(t,e,n,r,i){var s=!i||i.biff==8,o=Ue(8+ +s+(1+s)*n.length);return tv(t,e,r,o),o.write_shift(2,n.length),s&&o.write_shift(1,1),o.write_shift((1+s)*n.length,n,s?"utf16le":"sbcs"),o}function I_t(t,e,n,r){var i=n&&n.biff==5;r||(r=Ue(i?3+e.length:5+2*e.length)),r.write_shift(2,t),r.write_shift(i?1:2,e.length),i||r.write_shift(1,1),r.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var s=r.length>r.l?r.slice(0,r.l):r;return s.l==null&&(s.l=s.length),s}function P_t(t,e){var n=e.biff==8||!e.biff?4:2,r=Ue(2*n+6);return r.write_shift(n,t.s.r),r.write_shift(n,t.e.r+1),r.write_shift(2,t.s.c),r.write_shift(2,t.e.c+1),r.write_shift(2,0),r}function rae(t,e,n,r){var i=n&&n.biff==5;r||(r=Ue(i?16:20)),r.write_shift(2,0),t.style?(r.write_shift(2,t.numFmtId||0),r.write_shift(2,65524)):(r.write_shift(2,t.numFmtId||0),r.write_shift(2,e<<4));var s=0;return t.numFmtId>0&&i&&(s|=1024),r.write_shift(4,s),r.write_shift(4,0),i||r.write_shift(4,0),r.write_shift(2,0),r}function C_t(t){var e=Ue(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function R_t(t,e,n,r,i,s){var o=Ue(8);return tv(t,e,r,o),wEe(n,s,o),o}function M_t(t,e,n,r){var i=Ue(14);return tv(t,e,r,i),ev(n,i),i}function N_t(t,e,n){if(n.biff<8)return O_t(t,e,n);for(var r=[],i=t.l+e,s=t.read_shift(n.biff>8?4:2);s--!==0;)r.push(v_t(t,n.biff>8?12:6,n));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return r}function O_t(t,e,n){t[t.l+1]==3&&t[t.l]++;var r=bEe(t,e,n);return r.charCodeAt(0)==3?r.slice(1):r}function L_t(t){var e=Ue(2+t.length*8);e.write_shift(2,t.length);for(var n=0;n<t.length;++n)SEe(t[n],e);return e}function D_t(t){var e=Ue(24),n=fo(t[0]);e.write_shift(2,n.r),e.write_shift(2,n.r),e.write_shift(2,n.c),e.write_shift(2,n.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(r[i],16));return Oo([e,y_t(t[1])])}function j_t(t){var e=t[1].Tooltip,n=Ue(10+2*(e.length+1));n.write_shift(2,2048);var r=fo(t[0]);n.write_shift(2,r.r),n.write_shift(2,r.r),n.write_shift(2,r.c),n.write_shift(2,r.c);for(var i=0;i<e.length;++i)n.write_shift(2,e.charCodeAt(i));return n.write_shift(2,0),n}function $_t(t){return t||(t=Ue(4)),t.write_shift(2,1),t.write_shift(2,1),t}function F_t(t,e,n){if(!n.cellStyles)return Vd(t,e);var r=n&&n.biff>=12?4:2,i=t.read_shift(r),s=t.read_shift(r),o=t.read_shift(r),a=t.read_shift(r),l=t.read_shift(2);r==2&&(t.l+=2);var c={s:i,e:s,w:o,ixfe:a,flags:l};return(n.biff>=5||!n.biff)&&(c.level=l>>8&7),c}function V_t(t,e){var n=Ue(12);n.write_shift(2,e),n.write_shift(2,e),n.write_shift(2,t.width*256),n.write_shift(2,0);var r=0;return t.hidden&&(r|=1),n.write_shift(1,r),r=t.level||0,n.write_shift(1,r),n.write_shift(2,0),n}function z_t(t){for(var e=Ue(2*t),n=0;n<t;++n)e.write_shift(2,n+1);return e}function G_t(t,e,n){var r=Ue(15);return rP(r,t,e),r.write_shift(8,n,"f"),r}function U_t(t,e,n){var r=Ue(9);return rP(r,t,e),r.write_shift(2,n),r}var B_t=(function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=wq({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function n(a,l){var c=[],u=Q1(1);switch(l.type){case"base64":u=rh(wp(a));break;case"binary":u=rh(a);break;case"buffer":case"array":u=a;break}nc(u,0);var h=u.read_shift(1),f=!!(h&136),g=!1,y=!1;switch(h){case 2:break;case 3:break;case 48:g=!0,f=!0;break;case 49:g=!0,f=!0;break;case 131:break;case 139:break;case 140:y=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var _=0,b=521;h==2&&(_=u.read_shift(2)),u.l+=3,h!=2&&(_=u.read_shift(4)),_>1048576&&(_=1e6),h!=2&&(b=u.read_shift(2));var T=u.read_shift(2),A=l.codepage||1252;h!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(A=t[u[u.l]]),u.l+=1,u.l+=2),y&&(u.l+=36);for(var I=[],P={},R=Math.min(u.length,h==2?521:b-10-(g?264:0)),D=y?32:11;u.l<R&&u[u.l]!=13;)switch(P={},P.name=n5.utils.decode(A,u.slice(u.l,u.l+D)).replace(/[\u0000\r\n].*$/g,""),u.l+=D,P.type=String.fromCharCode(u.read_shift(1)),h!=2&&!y&&(P.offset=u.read_shift(4)),P.len=u.read_shift(1),h==2&&(P.offset=u.read_shift(2)),P.dec=u.read_shift(1),P.name.length&&I.push(P),h!=2&&(u.l+=y?13:14),P.type){case"B":(!g||P.len!=8)&&l.WTF&&console.log("Skipping "+P.name+":"+P.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+P.name+":"+P.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+P.type)}if(u[u.l]!==13&&(u.l=b-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=b;var C=0,M=0;for(c[0]=[],M=0;M!=I.length;++M)c[0][M]=I[M].name;for(;_-- >0;){if(u[u.l]===42){u.l+=T;continue}for(++u.l,c[++C]=[],M=0,M=0;M!=I.length;++M){var O=u.slice(u.l,u.l+I[M].len);u.l+=I[M].len,nc(O,0);var j=n5.utils.decode(A,O);switch(I[M].type){case"C":j.trim().length&&(c[C][M]=j.replace(/\s+$/,""));break;case"D":j.length===8?c[C][M]=new Date(+j.slice(0,4),+j.slice(4,6)-1,+j.slice(6,8)):c[C][M]=j;break;case"F":c[C][M]=parseFloat(j.trim());break;case"+":case"I":c[C][M]=y?O.read_shift(-4,"i")^2147483648:O.read_shift(4,"i");break;case"L":switch(j.trim().toUpperCase()){case"Y":case"T":c[C][M]=!0;break;case"N":case"F":c[C][M]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+j+"|")}break;case"M":if(!f)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));c[C][M]="##MEMO##"+(y?parseInt(j.trim(),10):O.read_shift(4));break;case"N":j=j.replace(/\u0000/g,"").trim(),j&&j!="."&&(c[C][M]=+j||0);break;case"@":c[C][M]=new Date(O.read_shift(-8,"f")-621356832e5);break;case"T":c[C][M]=new Date((O.read_shift(4)-2440588)*864e5+O.read_shift(4));break;case"Y":c[C][M]=O.read_shift(4,"i")/1e4+O.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[C][M]=-O.read_shift(-8,"f");break;case"B":if(g&&I[M].len==8){c[C][M]=O.read_shift(8,"f");break}case"G":case"P":O.l+=I[M].len;break;case"0":if(I[M].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+I[M].type)}}}if(h!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=I,c}function r(a,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=Pb(n(a,c),c);return u["!cols"]=c.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete c.DBF,u}function i(a,l){try{return wv(r(a,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function o(a,l){var c=l||{};if(+c.codepage>=0&&TA(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=Tl(),h=m5(a,{header:1,raw:!0,cellDates:!0}),f=h[0],g=h.slice(1),y=a["!cols"]||[],_=0,b=0,T=0,A=1;for(_=0;_<f.length;++_){if(((y[_]||{}).DBF||{}).name){f[_]=y[_].DBF.name,++T;continue}if(f[_]!=null){if(++T,typeof f[_]=="number"&&(f[_]=f[_].toString(10)),typeof f[_]!="string")throw new Error("DBF Invalid column name "+f[_]+" |"+typeof f[_]+"|");if(f.indexOf(f[_])!==_){for(b=0;b<1024;++b)if(f.indexOf(f[_]+"_"+b)==-1){f[_]+="_"+b;break}}}}var I=yi(a["!ref"]),P=[],R=[],D=[];for(_=0;_<=I.e.c-I.s.c;++_){var C="",M="",O=0,j=[];for(b=0;b<g.length;++b)g[b][_]!=null&&j.push(g[b][_]);if(j.length==0||f[_]==null){P[_]="?";continue}for(b=0;b<j.length;++b){switch(typeof j[b]){case"number":M="B";break;case"string":M="C";break;case"boolean":M="L";break;case"object":M=j[b]instanceof Date?"D":"C";break;default:M="C"}O=Math.max(O,String(j[b]).length),C=C&&C!=M?"C":M}O>250&&(O=250),M=((y[_]||{}).DBF||{}).type,M=="C"&&y[_].DBF.len>O&&(O=y[_].DBF.len),C=="B"&&M=="N"&&(C="N",D[_]=y[_].DBF.dec,O=y[_].DBF.len),R[_]=C=="C"||M=="N"?O:s[C]||0,A+=R[_],P[_]=C}var V=u.next(32);for(V.write_shift(4,318902576),V.write_shift(4,g.length),V.write_shift(2,296+32*T),V.write_shift(2,A),_=0;_<4;++_)V.write_shift(4,0);for(V.write_shift(4,0|(+e[kbe]||3)<<8),_=0,b=0;_<f.length;++_)if(f[_]!=null){var U=u.next(32),G=(f[_].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);U.write_shift(1,G,"sbcs"),U.write_shift(1,P[_]=="?"?"C":P[_],"sbcs"),U.write_shift(4,b),U.write_shift(1,R[_]||s[P[_]]||0),U.write_shift(1,D[_]||0),U.write_shift(1,2),U.write_shift(4,0),U.write_shift(1,0),U.write_shift(4,0),U.write_shift(4,0),b+=R[_]||s[P[_]]||0}var de=u.next(264);for(de.write_shift(4,13),_=0;_<65;++_)de.write_shift(4,0);for(_=0;_<g.length;++_){var Ie=u.next(A);for(Ie.write_shift(1,0),b=0;b<f.length;++b)if(f[b]!=null)switch(P[b]){case"L":Ie.write_shift(1,g[_][b]==null?63:g[_][b]?84:70);break;case"B":Ie.write_shift(8,g[_][b]||0,"f");break;case"N":var ze="0";for(typeof g[_][b]=="number"&&(ze=g[_][b].toFixed(D[b]||0)),T=0;T<R[b]-ze.length;++T)Ie.write_shift(1,32);Ie.write_shift(1,ze,"sbcs");break;case"D":g[_][b]?(Ie.write_shift(4,("0000"+g[_][b].getFullYear()).slice(-4),"sbcs"),Ie.write_shift(2,("00"+(g[_][b].getMonth()+1)).slice(-2),"sbcs"),Ie.write_shift(2,("00"+g[_][b].getDate()).slice(-2),"sbcs")):Ie.write_shift(8,"00000000","sbcs");break;case"C":var Ne=String(g[_][b]!=null?g[_][b]:"").slice(0,R[b]);for(Ie.write_shift(1,Ne,"sbcs"),T=0;T<R[b]-Ne.length;++T)Ie.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:i,to_sheet:r,from_sheet:o}})(),W_t=(function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+jo(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),n=function(f,g){var y=t[g];return typeof y=="number"?Aoe(y):y},r=function(f,g,y){var _=g.charCodeAt(0)-32<<4|y.charCodeAt(0)-48;return _==59?f:Aoe(_)};t["|"]=254;function i(f,g){switch(g.type){case"base64":return s(wp(f),g);case"binary":return s(f,g);case"buffer":return s(kr&&Buffer.isBuffer(f)?f.toString("binary"):JI(f),g);case"array":return s(DL(f),g)}throw new Error("Unrecognized type "+g.type)}function s(f,g){var y=f.split(/[\n\r]+/),_=-1,b=-1,T=0,A=0,I=[],P=[],R=null,D={},C=[],M=[],O=[],j=0,V;for(+g.codepage>=0&&TA(+g.codepage);T!==y.length;++T){j=0;var U=y[T].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(e,n),G=U.replace(/;;/g,"\0").split(";").map(function(le){return le.replace(/\u0000/g,";")}),de=G[0],Ie;if(U.length>0)switch(de){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":G[1].charAt(0)=="P"&&P.push(U.slice(3).replace(/;;/g,";"));break;case"C":var ze=!1,Ne=!1,fe=!1,De=!1,Ce=-1,Q=-1;for(A=1;A<G.length;++A)switch(G[A].charAt(0)){case"A":break;case"X":b=parseInt(G[A].slice(1))-1,Ne=!0;break;case"Y":for(_=parseInt(G[A].slice(1))-1,Ne||(b=0),V=I.length;V<=_;++V)I[V]=[];break;case"K":Ie=G[A].slice(1),Ie.charAt(0)==='"'?Ie=Ie.slice(1,Ie.length-1):Ie==="TRUE"?Ie=!0:Ie==="FALSE"?Ie=!1:isNaN(lp(Ie))?isNaN(AA(Ie).getDate())||(Ie=Ga(Ie)):(Ie=lp(Ie),R!==null&&$be(R)&&(Ie=Gbe(Ie))),ze=!0;break;case"E":De=!0;var W=Uxt(G[A].slice(1),{r:_,c:b});I[_][b]=[I[_][b],W];break;case"S":fe=!0,I[_][b]=[I[_][b],"S5S"];break;case"G":break;case"R":Ce=parseInt(G[A].slice(1))-1;break;case"C":Q=parseInt(G[A].slice(1))-1;break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+U)}if(ze&&(I[_][b]&&I[_][b].length==2?I[_][b][0]=Ie:I[_][b]=Ie,R=null),fe){if(De)throw new Error("SYLK shared formula cannot have own formula");var ne=Ce>-1&&I[Ce][Q];if(!ne||!ne[1])throw new Error("SYLK shared formula cannot find base");I[_][b][1]=Bxt(ne[1],{r:_-Ce,c:b-Q})}break;case"F":var ie=0;for(A=1;A<G.length;++A)switch(G[A].charAt(0)){case"X":b=parseInt(G[A].slice(1))-1,++ie;break;case"Y":for(_=parseInt(G[A].slice(1))-1,V=I.length;V<=_;++V)I[V]=[];break;case"M":j=parseInt(G[A].slice(1))/20;break;case"F":break;case"G":break;case"P":R=P[parseInt(G[A].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(O=G[A].slice(1).split(" "),V=parseInt(O[0],10);V<=parseInt(O[1],10);++V)j=parseInt(O[2],10),M[V-1]=j===0?{hidden:!0}:{wch:j},Nq(M[V-1]);break;case"C":b=parseInt(G[A].slice(1))-1,M[b]||(M[b]={});break;case"R":_=parseInt(G[A].slice(1))-1,C[_]||(C[_]={}),j>0?(C[_].hpt=j,C[_].hpx=PEe(j)):j===0&&(C[_].hidden=!0);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+U)}ie<1&&(R=null);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+U)}}return C.length>0&&(D["!rows"]=C),M.length>0&&(D["!cols"]=M),g&&g.sheetRows&&(I=I.slice(0,g.sheetRows)),[I,D]}function o(f,g){var y=i(f,g),_=y[0],b=y[1],T=Pb(_,g);return jo(b).forEach(function(A){T[A]=b[A]}),T}function a(f,g){return wv(o(f,g),g)}function l(f,g,y,_){var b="C;Y"+(y+1)+";X"+(_+1)+";K";switch(f.t){case"n":b+=f.v||0,f.f&&!f.F&&(b+=";E"+Lq(f.f,{r:y,c:_}));break;case"b":b+=f.v?"TRUE":"FALSE";break;case"e":b+=f.w||f.v;break;case"d":b+='"'+(f.w||f.v)+'"';break;case"s":b+='"'+f.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return b}function c(f,g){g.forEach(function(y,_){var b="F;W"+(_+1)+" "+(_+1)+" ";y.hidden?b+="0":(typeof y.width=="number"&&!y.wpx&&(y.wpx=h5(y.width)),typeof y.wpx=="number"&&!y.wch&&(y.wch=d5(y.wpx)),typeof y.wch=="number"&&(b+=Math.round(y.wch))),b.charAt(b.length-1)!=" "&&f.push(b)})}function u(f,g){g.forEach(function(y,_){var b="F;";y.hidden?b+="M0;":y.hpt?b+="M"+20*y.hpt+";":y.hpx&&(b+="M"+20*f5(y.hpx)+";"),b.length>2&&f.push(b+"R"+(_+1))})}function h(f,g){var y=["ID;PWXL;N;E"],_=[],b=yi(f["!ref"]),T,A=Array.isArray(f),I=`\r
`;y.push("P;PGeneral"),y.push("F;P0;DG0G8;M255"),f["!cols"]&&c(y,f["!cols"]),f["!rows"]&&u(y,f["!rows"]),y.push("B;Y"+(b.e.r-b.s.r+1)+";X"+(b.e.c-b.s.c+1)+";D"+[b.s.c,b.s.r,b.e.c,b.e.r].join(" "));for(var P=b.s.r;P<=b.e.r;++P)for(var R=b.s.c;R<=b.e.c;++R){var D=qr({r:P,c:R});T=A?(f[P]||[])[R]:f[D],!(!T||T.v==null&&(!T.f||T.F))&&_.push(l(T,f,P,R))}return y.join(I)+I+_.join(I)+I+"E"+I}return{to_workbook:a,to_sheet:o,from_sheet:h}})(),H_t=(function(){function t(s,o){switch(o.type){case"base64":return e(wp(s),o);case"binary":return e(s,o);case"buffer":return e(kr&&Buffer.isBuffer(s)?s.toString("binary"):JI(s),o);case"array":return e(DL(s),o)}throw new Error("Unrecognized type "+o.type)}function e(s,o){for(var a=s.split(`
`),l=-1,c=-1,u=0,h=[];u!==a.length;++u){if(a[u].trim()==="BOT"){h[++l]=[],c=0;continue}if(!(l<0)){var f=a[u].trim().split(","),g=f[0],y=f[1];++u;for(var _=a[u]||"";(_.match(/["]/g)||[]).length&1&&u<a.length-1;)_+=`
`+a[++u];switch(_=_.trim(),+g){case-1:if(_==="BOT"){h[++l]=[],c=0;continue}else if(_!=="EOD")throw new Error("Unrecognized DIF special command "+_);break;case 0:_==="TRUE"?h[l][c]=!0:_==="FALSE"?h[l][c]=!1:isNaN(lp(y))?isNaN(AA(y).getDate())?h[l][c]=y:h[l][c]=Ga(y):h[l][c]=lp(y),++c;break;case 1:_=_.slice(1,_.length-1),_=_.replace(/""/g,'"'),_&&_.match(/^=".*"$/)&&(_=_.slice(2,-1)),h[l][c++]=_!==""?_:null;break}if(_==="EOD")break}}return o&&o.sheetRows&&(h=h.slice(0,o.sheetRows)),h}function n(s,o){return Pb(t(s,o),o)}function r(s,o){return wv(n(s,o),o)}var i=(function(){var s=function(l,c,u,h,f){l.push(c),l.push(u+","+h),l.push('"'+f.replace(/"/g,'""')+'"')},o=function(l,c,u,h){l.push(c+","+u),l.push(c==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(l){var c=[],u=yi(l["!ref"]),h,f=Array.isArray(l);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,u.e.r-u.s.r+1,""),s(c,"TUPLES",0,u.e.c-u.s.c+1,""),s(c,"DATA",0,0,"");for(var g=u.s.r;g<=u.e.r;++g){o(c,-1,0,"BOT");for(var y=u.s.c;y<=u.e.c;++y){var _=qr({r:g,c:y});if(h=f?(l[g]||[])[y]:l[_],!h){o(c,1,0,"");continue}switch(h.t){case"n":var b=h.w;!b&&h.v!=null&&(b=h.v),b==null?h.f&&!h.F?o(c,1,0,"="+h.f):o(c,1,0,""):o(c,0,b,"V");break;case"b":o(c,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":o(c,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=Jg(h.z||rs[14],Cl(Ga(h.v)))),o(c,0,h.w,"V");break;default:o(c,1,0,"")}}}o(c,-1,0,"EOD");var T=`\r
`,A=c.join(T);return A}})();return{to_workbook:r,to_sheet:n,from_sheet:i}})(),TEe=(function(){function t(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function n(h,f){for(var g=h.split(`
`),y=-1,_=-1,b=0,T=[];b!==g.length;++b){var A=g[b].trim().split(":");if(A[0]==="cell"){var I=fo(A[1]);if(T.length<=I.r)for(y=T.length;y<=I.r;++y)T[y]||(T[y]=[]);switch(y=I.r,_=I.c,A[2]){case"t":T[y][_]=t(A[3]);break;case"v":T[y][_]=+A[3];break;case"vtf":var P=A[A.length-1];case"vtc":switch(A[3]){case"nl":T[y][_]=!!+A[4];break;default:T[y][_]=+A[4];break}A[2]=="vtf"&&(T[y][_]=[T[y][_],P])}}}return f&&f.sheetRows&&(T=T.slice(0,f.sheetRows)),T}function r(h,f){return Pb(n(h,f),f)}function i(h,f){return wv(r(h,f),f)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,a=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(h){if(!h||!h["!ref"])return"";for(var f=[],g=[],y,_="",b=Ec(h["!ref"]),T=Array.isArray(h),A=b.s.r;A<=b.e.r;++A)for(var I=b.s.c;I<=b.e.c;++I)if(_=qr({r:A,c:I}),y=T?(h[A]||[])[I]:h[_],!(!y||y.v==null||y.t==="z")){switch(g=["cell",_,"t"],y.t){case"s":case"str":g.push(e(y.v));break;case"n":y.f?(g[2]="vtf",g[3]="n",g[4]=y.v,g[5]=e(y.f)):(g[2]="v",g[3]=y.v);break;case"b":g[2]="vt"+(y.f?"f":"c"),g[3]="nl",g[4]=y.v?"1":"0",g[5]=e(y.f||(y.v?"TRUE":"FALSE"));break;case"d":var P=Cl(Ga(y.v));g[2]="vtc",g[3]="nd",g[4]=""+P,g[5]=y.w||Jg(y.z||rs[14],P);break;case"e":continue}f.push(g.join(":"))}return f.push("sheet:c:"+(b.e.c-b.s.c+1)+":r:"+(b.e.r-b.s.r+1)+":tvf:1"),f.push("valueformat:1:text-wiki"),f.join(`
`)}function u(h){return[s,o,a,o,c(h),l].join(`
`)}return{to_workbook:i,to_sheet:r,from_sheet:u}})(),q_t=(function(){function t(u,h,f,g,y){y.raw?h[f][g]=u:u===""||(u==="TRUE"?h[f][g]=!0:u==="FALSE"?h[f][g]=!1:isNaN(lp(u))?isNaN(AA(u).getDate())?h[f][g]=u:h[f][g]=Ga(u):h[f][g]=lp(u))}function e(u,h){var f=h||{},g=[];if(!u||u.length===0)return g;for(var y=u.split(/[\r\n]/),_=y.length-1;_>=0&&y[_].length===0;)--_;for(var b=10,T=0,A=0;A<=_;++A)T=y[A].indexOf(" "),T==-1?T=y[A].length:T++,b=Math.max(b,T);for(A=0;A<=_;++A){g[A]=[];var I=0;for(t(y[A].slice(0,b).trim(),g,A,I,f),I=1;I<=(y[A].length-b)/10+1;++I)t(y[A].slice(b+(I-1)*10,b+I*10).trim(),g,A,I,f)}return f.sheetRows&&(g=g.slice(0,f.sheetRows)),g}var n={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function i(u){for(var h={},f=!1,g=0,y=0;g<u.length;++g)(y=u.charCodeAt(g))==34?f=!f:!f&&y in n&&(h[y]=(h[y]||0)+1);y=[];for(g in h)Object.prototype.hasOwnProperty.call(h,g)&&y.push([h[g],g]);if(!y.length){h=r;for(g in h)Object.prototype.hasOwnProperty.call(h,g)&&y.push([h[g],g])}return y.sort(function(_,b){return _[0]-b[0]||r[_[1]]-r[b[1]]}),n[y.pop()[1]]||44}function s(u,h){var f=h||{},g="",y=f.dense?[]:{},_={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(g=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(g=u.charAt(4),u=u.slice(6)):g=i(u.slice(0,1024)):f&&f.FS?g=f.FS:g=i(u.slice(0,1024));var b=0,T=0,A=0,I=0,P=0,R=g.charCodeAt(0),D=!1,C=0,M=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var O=f.dateNF!=null?cvt(f.dateNF):null;function j(){var V=u.slice(I,P),U={};if(V.charAt(0)=='"'&&V.charAt(V.length-1)=='"'&&(V=V.slice(1,-1).replace(/""/g,'"')),V.length===0)U.t="z";else if(f.raw)U.t="s",U.v=V;else if(V.trim().length===0)U.t="s",U.v=V;else if(V.charCodeAt(0)==61)V.charCodeAt(1)==34&&V.charCodeAt(V.length-1)==34?(U.t="s",U.v=V.slice(2,-1).replace(/""/g,'"')):Wxt(V)?(U.t="n",U.f=V.slice(1)):(U.t="s",U.v=V);else if(V=="TRUE")U.t="b",U.v=!0;else if(V=="FALSE")U.t="b",U.v=!1;else if(!isNaN(A=lp(V)))U.t="n",f.cellText!==!1&&(U.w=V),U.v=A;else if(!isNaN(AA(V).getDate())||O&&V.match(O)){U.z=f.dateNF||rs[14];var G=0;O&&V.match(O)&&(V=uvt(V,f.dateNF,V.match(O)||[]),G=1),f.cellDates?(U.t="d",U.v=Ga(V,G)):(U.t="n",U.v=Cl(Ga(V,G))),f.cellText!==!1&&(U.w=Jg(U.z,U.v instanceof Date?Cl(U.v):U.v)),f.cellNF||delete U.z}else U.t="s",U.v=V;if(U.t=="z"||(f.dense?(y[b]||(y[b]=[]),y[b][T]=U):y[qr({c:T,r:b})]=U),I=P+1,M=u.charCodeAt(I),_.e.c<T&&(_.e.c=T),_.e.r<b&&(_.e.r=b),C==R)++T;else if(T=0,++b,f.sheetRows&&f.sheetRows<=b)return!0}e:for(;P<u.length;++P)switch(C=u.charCodeAt(P)){case 34:M===34&&(D=!D);break;case R:case 10:case 13:if(!D&&j())break e;break}return P-I>0&&j(),y["!ref"]=Ms(_),y}function o(u,h){return!(h&&h.PRN)||h.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?s(u,h):Pb(e(u,h),h)}function a(u,h){var f="",g=h.type=="string"?[0,0,0,0]:sSt(u,h);switch(h.type){case"base64":f=wp(u);break;case"binary":f=u;break;case"buffer":h.codepage==65001?f=u.toString("utf8"):h.codepage&&typeof n5<"u"||(f=kr&&Buffer.isBuffer(u)?u.toString("binary"):JI(u));break;case"array":f=DL(u);break;case"string":f=u;break;default:throw new Error("Unrecognized type "+h.type)}return g[0]==239&&g[1]==187&&g[2]==191?f=ek(f.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?f=ek(f):h.type=="binary"&&typeof n5<"u",f.slice(0,19)=="socialcalc:version:"?TEe.to_sheet(h.type=="string"?f:ek(f),h):o(f,h)}function l(u,h){return wv(a(u,h),h)}function c(u){for(var h=[],f=yi(u["!ref"]),g,y=Array.isArray(u),_=f.s.r;_<=f.e.r;++_){for(var b=[],T=f.s.c;T<=f.e.c;++T){var A=qr({r:_,c:T});if(g=y?(u[_]||[])[T]:u[A],!g||g.v==null){b.push("          ");continue}for(var I=(g.w||(bp(g),g.w)||"").slice(0,10);I.length<10;)I+=" ";b.push(I+(T===0?" ":""))}h.push(b.join(""))}return h.join(`
`)}return{to_workbook:l,to_sheet:a,from_sheet:c}})(),iae=(function(){function t(W,ne,ie){if(W){nc(W,W.l||0);for(var le=ie.Enum||Ce;W.l<W.length;){var ve=W.read_shift(2),qe=le[ve]||le[65535],Ke=W.read_shift(2),Se=W.l+Ke,we=qe.f&&qe.f(W,Ke,ie);if(W.l=Se,ne(we,qe,ve))return}}}function e(W,ne){switch(ne.type){case"base64":return n(rh(wp(W)),ne);case"binary":return n(rh(W),ne);case"buffer":case"array":return n(W,ne)}throw"Unsupported type "+ne.type}function n(W,ne){if(!W)return W;var ie=ne||{},le=ie.dense?[]:{},ve="Sheet1",qe="",Ke=0,Se={},we=[],Dt=[],Ye={s:{r:0,c:0},e:{r:0,c:0}},on=ie.sheetRows||0;if(W[2]==0&&(W[3]==8||W[3]==9)&&W.length>=16&&W[14]==5&&W[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(W[2]==2)ie.Enum=Ce,t(W,function(dt,hr,zn){switch(zn){case 0:ie.vers=dt,dt>=4096&&(ie.qpro=!0);break;case 6:Ye=dt;break;case 204:dt&&(qe=dt);break;case 222:qe=dt;break;case 15:case 51:ie.qpro||(dt[1].v=dt[1].v.slice(1));case 13:case 14:case 16:zn==14&&(dt[2]&112)==112&&(dt[2]&15)>1&&(dt[2]&15)<15&&(dt[1].z=ie.dateNF||rs[14],ie.cellDates&&(dt[1].t="d",dt[1].v=Gbe(dt[1].v))),ie.qpro&&dt[3]>Ke&&(le["!ref"]=Ms(Ye),Se[ve]=le,we.push(ve),le=ie.dense?[]:{},Ye={s:{r:0,c:0},e:{r:0,c:0}},Ke=dt[3],ve=qe||"Sheet"+(Ke+1),qe="");var Wn=ie.dense?(le[dt[0].r]||[])[dt[0].c]:le[qr(dt[0])];if(Wn){Wn.t=dt[1].t,Wn.v=dt[1].v,dt[1].z!=null&&(Wn.z=dt[1].z),dt[1].f!=null&&(Wn.f=dt[1].f);break}ie.dense?(le[dt[0].r]||(le[dt[0].r]=[]),le[dt[0].r][dt[0].c]=dt[1]):le[qr(dt[0])]=dt[1];break}},ie);else if(W[2]==26||W[2]==14)ie.Enum=Q,W[2]==14&&(ie.qpro=!0,W.l=0),t(W,function(dt,hr,zn){switch(zn){case 204:ve=dt;break;case 22:dt[1].v=dt[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(dt[3]>Ke&&(le["!ref"]=Ms(Ye),Se[ve]=le,we.push(ve),le=ie.dense?[]:{},Ye={s:{r:0,c:0},e:{r:0,c:0}},Ke=dt[3],ve="Sheet"+(Ke+1)),on>0&&dt[0].r>=on)break;ie.dense?(le[dt[0].r]||(le[dt[0].r]=[]),le[dt[0].r][dt[0].c]=dt[1]):le[qr(dt[0])]=dt[1],Ye.e.c<dt[0].c&&(Ye.e.c=dt[0].c),Ye.e.r<dt[0].r&&(Ye.e.r=dt[0].r);break;case 27:dt[14e3]&&(Dt[dt[14e3][0]]=dt[14e3][1]);break;case 1537:Dt[dt[0]]=dt[1],dt[0]==Ke&&(ve=dt[1]);break}},ie);else throw new Error("Unrecognized LOTUS BOF "+W[2]);if(le["!ref"]=Ms(Ye),Se[qe||ve]=le,we.push(qe||ve),!Dt.length)return{SheetNames:we,Sheets:Se};for(var jt={},pn=[],_n=0;_n<Dt.length;++_n)Se[we[_n]]?(pn.push(Dt[_n]||we[_n]),jt[Dt[_n]]=Se[Dt[_n]]||Se[we[_n]]):(pn.push(Dt[_n]),jt[Dt[_n]]={"!ref":"A1"});return{SheetNames:pn,Sheets:jt}}function r(W,ne){var ie=ne||{};if(+ie.codepage>=0&&TA(+ie.codepage),ie.type=="string")throw new Error("Cannot write WK1 to JS string");var le=Tl(),ve=yi(W["!ref"]),qe=Array.isArray(W),Ke=[];vt(le,0,s(1030)),vt(le,6,l(ve));for(var Se=Math.min(ve.e.r,8191),we=ve.s.r;we<=Se;++we)for(var Dt=Do(we),Ye=ve.s.c;Ye<=ve.e.c;++Ye){we===ve.s.r&&(Ke[Ye]=_a(Ye));var on=Ke[Ye]+Dt,jt=qe?(W[we]||[])[Ye]:W[on];if(!(!jt||jt.t=="z"))if(jt.t=="n")(jt.v|0)==jt.v&&jt.v>=-32768&&jt.v<=32767?vt(le,13,g(we,Ye,jt.v)):vt(le,14,_(we,Ye,jt.v));else{var pn=bp(jt);vt(le,15,h(we,Ye,pn.slice(0,239)))}}return vt(le,1),le.end()}function i(W,ne){var ie=ne||{};if(+ie.codepage>=0&&TA(+ie.codepage),ie.type=="string")throw new Error("Cannot write WK3 to JS string");var le=Tl();vt(le,0,o(W));for(var ve=0,qe=0;ve<W.SheetNames.length;++ve)(W.Sheets[W.SheetNames[ve]]||{})["!ref"]&&vt(le,27,De(W.SheetNames[ve],qe++));var Ke=0;for(ve=0;ve<W.SheetNames.length;++ve){var Se=W.Sheets[W.SheetNames[ve]];if(!(!Se||!Se["!ref"])){for(var we=yi(Se["!ref"]),Dt=Array.isArray(Se),Ye=[],on=Math.min(we.e.r,8191),jt=we.s.r;jt<=on;++jt)for(var pn=Do(jt),_n=we.s.c;_n<=we.e.c;++_n){jt===we.s.r&&(Ye[_n]=_a(_n));var dt=Ye[_n]+pn,hr=Dt?(Se[jt]||[])[_n]:Se[dt];if(!(!hr||hr.t=="z"))if(hr.t=="n")vt(le,23,j(jt,_n,Ke,hr.v));else{var zn=bp(hr);vt(le,22,C(jt,_n,Ke,zn.slice(0,239)))}}++Ke}}return vt(le,1),le.end()}function s(W){var ne=Ue(2);return ne.write_shift(2,W),ne}function o(W){var ne=Ue(26);ne.write_shift(2,4096),ne.write_shift(2,4),ne.write_shift(4,0);for(var ie=0,le=0,ve=0,qe=0;qe<W.SheetNames.length;++qe){var Ke=W.SheetNames[qe],Se=W.Sheets[Ke];if(!(!Se||!Se["!ref"])){++ve;var we=Ec(Se["!ref"]);ie<we.e.r&&(ie=we.e.r),le<we.e.c&&(le=we.e.c)}}return ie>8191&&(ie=8191),ne.write_shift(2,ie),ne.write_shift(1,ve),ne.write_shift(1,le),ne.write_shift(2,0),ne.write_shift(2,0),ne.write_shift(1,1),ne.write_shift(1,2),ne.write_shift(4,0),ne.write_shift(4,0),ne}function a(W,ne,ie){var le={s:{c:0,r:0},e:{c:0,r:0}};return ne==8&&ie.qpro?(le.s.c=W.read_shift(1),W.l++,le.s.r=W.read_shift(2),le.e.c=W.read_shift(1),W.l++,le.e.r=W.read_shift(2),le):(le.s.c=W.read_shift(2),le.s.r=W.read_shift(2),ne==12&&ie.qpro&&(W.l+=2),le.e.c=W.read_shift(2),le.e.r=W.read_shift(2),ne==12&&ie.qpro&&(W.l+=2),le.s.c==65535&&(le.s.c=le.e.c=le.s.r=le.e.r=0),le)}function l(W){var ne=Ue(8);return ne.write_shift(2,W.s.c),ne.write_shift(2,W.s.r),ne.write_shift(2,W.e.c),ne.write_shift(2,W.e.r),ne}function c(W,ne,ie){var le=[{c:0,r:0},{t:"n",v:0},0,0];return ie.qpro&&ie.vers!=20768?(le[0].c=W.read_shift(1),le[3]=W.read_shift(1),le[0].r=W.read_shift(2),W.l+=2):(le[2]=W.read_shift(1),le[0].c=W.read_shift(2),le[0].r=W.read_shift(2)),le}function u(W,ne,ie){var le=W.l+ne,ve=c(W,ne,ie);if(ve[1].t="s",ie.vers==20768){W.l++;var qe=W.read_shift(1);return ve[1].v=W.read_shift(qe,"utf8"),ve}return ie.qpro&&W.l++,ve[1].v=W.read_shift(le-W.l,"cstr"),ve}function h(W,ne,ie){var le=Ue(7+ie.length);le.write_shift(1,255),le.write_shift(2,ne),le.write_shift(2,W),le.write_shift(1,39);for(var ve=0;ve<le.length;++ve){var qe=ie.charCodeAt(ve);le.write_shift(1,qe>=128?95:qe)}return le.write_shift(1,0),le}function f(W,ne,ie){var le=c(W,ne,ie);return le[1].v=W.read_shift(2,"i"),le}function g(W,ne,ie){var le=Ue(7);return le.write_shift(1,255),le.write_shift(2,ne),le.write_shift(2,W),le.write_shift(2,ie,"i"),le}function y(W,ne,ie){var le=c(W,ne,ie);return le[1].v=W.read_shift(8,"f"),le}function _(W,ne,ie){var le=Ue(13);return le.write_shift(1,255),le.write_shift(2,ne),le.write_shift(2,W),le.write_shift(8,ie,"f"),le}function b(W,ne,ie){var le=W.l+ne,ve=c(W,ne,ie);if(ve[1].v=W.read_shift(8,"f"),ie.qpro)W.l=le;else{var qe=W.read_shift(2);P(W.slice(W.l,W.l+qe),ve),W.l+=qe}return ve}function T(W,ne,ie){var le=ne&32768;return ne&=-32769,ne=(le?W:0)+(ne>=8192?ne-16384:ne),(le?"":"$")+(ie?_a(ne):Do(ne))}var A={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},I=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function P(W,ne){nc(W,0);for(var ie=[],le=0,ve="",qe="",Ke="",Se="";W.l<W.length;){var we=W[W.l++];switch(we){case 0:ie.push(W.read_shift(8,"f"));break;case 1:qe=T(ne[0].c,W.read_shift(2),!0),ve=T(ne[0].r,W.read_shift(2),!1),ie.push(qe+ve);break;case 2:{var Dt=T(ne[0].c,W.read_shift(2),!0),Ye=T(ne[0].r,W.read_shift(2),!1);qe=T(ne[0].c,W.read_shift(2),!0),ve=T(ne[0].r,W.read_shift(2),!1),ie.push(Dt+Ye+":"+qe+ve)}break;case 3:if(W.l<W.length){console.error("WK1 premature formula end");return}break;case 4:ie.push("("+ie.pop()+")");break;case 5:ie.push(W.read_shift(2));break;case 6:{for(var on="";we=W[W.l++];)on+=String.fromCharCode(we);ie.push('"'+on.replace(/"/g,'""')+'"')}break;case 8:ie.push("-"+ie.pop());break;case 23:ie.push("+"+ie.pop());break;case 22:ie.push("NOT("+ie.pop()+")");break;case 20:case 21:Se=ie.pop(),Ke=ie.pop(),ie.push(["AND","OR"][we-20]+"("+Ke+","+Se+")");break;default:if(we<32&&I[we])Se=ie.pop(),Ke=ie.pop(),ie.push(Ke+I[we]+Se);else if(A[we]){if(le=A[we][1],le==69&&(le=W[W.l++]),le>ie.length){console.error("WK1 bad formula parse 0x"+we.toString(16)+":|"+ie.join("|")+"|");return}var jt=ie.slice(-le);ie.length-=le,ie.push(A[we][0]+"("+jt.join(",")+")")}else return we<=7?console.error("WK1 invalid opcode "+we.toString(16)):we<=24?console.error("WK1 unsupported op "+we.toString(16)):we<=30?console.error("WK1 invalid opcode "+we.toString(16)):we<=115?console.error("WK1 unsupported function opcode "+we.toString(16)):console.error("WK1 unrecognized opcode "+we.toString(16))}}ie.length==1?ne[1].f=""+ie[0]:console.error("WK1 bad formula parse |"+ie.join("|")+"|")}function R(W){var ne=[{c:0,r:0},{t:"n",v:0},0];return ne[0].r=W.read_shift(2),ne[3]=W[W.l++],ne[0].c=W[W.l++],ne}function D(W,ne){var ie=R(W);return ie[1].t="s",ie[1].v=W.read_shift(ne-4,"cstr"),ie}function C(W,ne,ie,le){var ve=Ue(6+le.length);ve.write_shift(2,W),ve.write_shift(1,ie),ve.write_shift(1,ne),ve.write_shift(1,39);for(var qe=0;qe<le.length;++qe){var Ke=le.charCodeAt(qe);ve.write_shift(1,Ke>=128?95:Ke)}return ve.write_shift(1,0),ve}function M(W,ne){var ie=R(W);ie[1].v=W.read_shift(2);var le=ie[1].v>>1;if(ie[1].v&1)switch(le&7){case 0:le=(le>>3)*5e3;break;case 1:le=(le>>3)*500;break;case 2:le=(le>>3)/20;break;case 3:le=(le>>3)/200;break;case 4:le=(le>>3)/2e3;break;case 5:le=(le>>3)/2e4;break;case 6:le=(le>>3)/16;break;case 7:le=(le>>3)/64;break}return ie[1].v=le,ie}function O(W,ne){var ie=R(W),le=W.read_shift(4),ve=W.read_shift(4),qe=W.read_shift(2);if(qe==65535)return le===0&&ve===3221225472?(ie[1].t="e",ie[1].v=15):le===0&&ve===3489660928?(ie[1].t="e",ie[1].v=42):ie[1].v=0,ie;var Ke=qe&32768;return qe=(qe&32767)-16446,ie[1].v=(1-Ke*2)*(ve*Math.pow(2,qe+32)+le*Math.pow(2,qe)),ie}function j(W,ne,ie,le){var ve=Ue(14);if(ve.write_shift(2,W),ve.write_shift(1,ie),ve.write_shift(1,ne),le==0)return ve.write_shift(4,0),ve.write_shift(4,0),ve.write_shift(2,65535),ve;var qe=0,Ke=0,Se=0,we=0;return le<0&&(qe=1,le=-le),Ke=Math.log2(le)|0,le/=Math.pow(2,Ke-31),we=le>>>0,(we&2147483648)==0&&(le/=2,++Ke,we=le>>>0),le-=we,we|=2147483648,we>>>=0,le*=Math.pow(2,32),Se=le>>>0,ve.write_shift(4,Se),ve.write_shift(4,we),Ke+=16383+(qe?32768:0),ve.write_shift(2,Ke),ve}function V(W,ne){var ie=O(W);return W.l+=ne-14,ie}function U(W,ne){var ie=R(W),le=W.read_shift(4);return ie[1].v=le>>6,ie}function G(W,ne){var ie=R(W),le=W.read_shift(8,"f");return ie[1].v=le,ie}function de(W,ne){var ie=G(W);return W.l+=ne-10,ie}function Ie(W,ne){return W[W.l+ne-1]==0?W.read_shift(ne,"cstr"):""}function ze(W,ne){var ie=W[W.l++];ie>ne-1&&(ie=ne-1);for(var le="";le.length<ie;)le+=String.fromCharCode(W[W.l++]);return le}function Ne(W,ne,ie){if(!(!ie.qpro||ne<21)){var le=W.read_shift(1);W.l+=17,W.l+=1,W.l+=2;var ve=W.read_shift(ne-21,"cstr");return[le,ve]}}function fe(W,ne){for(var ie={},le=W.l+ne;W.l<le;){var ve=W.read_shift(2);if(ve==14e3){for(ie[ve]=[0,""],ie[ve][0]=W.read_shift(2);W[W.l];)ie[ve][1]+=String.fromCharCode(W[W.l]),W.l++;W.l++}}return ie}function De(W,ne){var ie=Ue(5+W.length);ie.write_shift(2,14e3),ie.write_shift(2,ne);for(var le=0;le<W.length;++le){var ve=W.charCodeAt(le);ie[ie.l++]=ve>127?95:ve}return ie[ie.l++]=0,ie}var Ce={0:{n:"BOF",f:xEe},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:a},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f},14:{n:"NUMBER",f:y},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:b},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Ie},222:{n:"SHEETNAMELP",f:ze},65535:{n:""}},Q={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:D},23:{n:"NUMBER17",f:O},24:{n:"NUMBER18",f:M},25:{n:"FORMULA19",f:V},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:fe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:U},38:{n:"??"},39:{n:"NUMBER27",f:G},40:{n:"FORMULA28",f:de},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Ie},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Ne},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:i,to_workbook:e}})(),K_t=/^\s|\s$|[\t\n\r]/;function kEe(t,e){if(!e.bookSST)return"";var n=[Os];n[n.length]=yt("sst",null,{xmlns:Ib[0],count:t.Count,uniqueCount:t.Unique});for(var r=0;r!=t.length;++r)if(t[r]!=null){var i=t[r],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(K_t)&&(s+=' xml:space="preserve"'),s+=">"+Wr(i.t)+"</t>"),s+="</si>",n[n.length]=s}return n.length>2&&(n[n.length]="</sst>",n[1]=n[1].replace("/>",">")),n.join("")}function Y_t(t){return[t.read_shift(4),t.read_shift(4)]}function X_t(t,e){return e||(e=Ue(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var Z_t=zvt;function J_t(t){var e=Tl();tt(e,159,X_t(t));for(var n=0;n<t.length;++n)tt(e,19,Z_t(t[n]));return tt(e,160),e.end()}function Q_t(t){for(var e=[],n=t.split(""),r=0;r<n.length;++r)e[r]=n[r].charCodeAt(0);return e}function AEe(t){var e=0,n,r=Q_t(t),i=r.length+1,s,o,a,l,c;for(n=Q1(i),n[0]=r.length,s=1;s!=i;++s)n[s]=r[s-1];for(s=i-1;s>=0;--s)o=n[s],a=(e&16384)===0?0:1,l=e<<1&32767,c=a|l,e=c^o;return e^52811}var ext=(function(){function t(i,s){switch(s.type){case"base64":return e(wp(i),s);case"binary":return e(i,s);case"buffer":return e(kr&&Buffer.isBuffer(i)?i.toString("binary"):JI(i),s);case"array":return e(DL(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var o=s||{},a=o.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,h){Array.isArray(a)&&(a[h]=[]);for(var f=/\\\w+\b/g,g=0,y,_=-1;y=f.exec(u);){switch(y[0]){case"\\cell":var b=u.slice(g,f.lastIndex-y[0].length);if(b[0]==" "&&(b=b.slice(1)),++_,b.length){var T={v:b,t:"s"};Array.isArray(a)?a[h][_]=T:a[qr({r:h,c:_})]=T}break}g=f.lastIndex}_>c.e.c&&(c.e.c=_)}),a["!ref"]=Ms(c),a}function n(i,s){return wv(t(i,s),s)}function r(i){for(var s=["{\\rtf1\\ansi"],o=yi(i["!ref"]),a,l=Array.isArray(i),c=o.s.r;c<=o.e.r;++c){s.push("\\trowd\\trautofit1");for(var u=o.s.c;u<=o.e.c;++u)s.push("\\cellx"+(u+1));for(s.push("\\pard\\intbl"),u=o.s.c;u<=o.e.c;++u){var h=qr({r:c,c:u});a=l?(i[c]||[])[u]:i[h],!(!a||a.v==null&&(!a.f||a.F))&&(s.push(" "+(a.w||(bp(a),a.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:n,to_sheet:t,from_sheet:r}})();function sae(t){for(var e=0,n=1;e!=3;++e)n=n*256+(t[e]>255?255:t[e]<0?0:t[e]);return n.toString(16).toUpperCase().slice(1)}var txt=6,cp=txt;function h5(t){return Math.floor((t+Math.round(128/cp)/256)*cp)}function d5(t){return Math.floor((t-5)/cp*100+.5)/100}function Vz(t){return Math.round((t*cp+5)/cp*256)/256}function Nq(t){t.width?(t.wpx=h5(t.width),t.wch=d5(t.wpx),t.MDW=cp):t.wpx?(t.wch=d5(t.wpx),t.width=Vz(t.wch),t.MDW=cp):typeof t.wch=="number"&&(t.width=Vz(t.wch),t.wpx=h5(t.width),t.MDW=cp),t.customWidth&&delete t.customWidth}var nxt=96,IEe=nxt;function f5(t){return t*96/IEe}function PEe(t){return t*IEe/96}function rxt(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var r=n[0];r<=n[1];++r)t[r]!=null&&(e[e.length]=yt("numFmt",null,{numFmtId:r,formatCode:Wr(t[r])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=yt("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function ixt(t){var e=[];return e[e.length]=yt("cellXfs",null),t.forEach(function(n){e[e.length]=yt("xf",null,n)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=yt("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function CEe(t,e){var n=[Os,yt("styleSheet",null,{xmlns:Ib[0],"xmlns:vt":uo.vt})],r;return t.SSF&&(r=rxt(t.SSF))!=null&&(n[n.length]=r),n[n.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',n[n.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',n[n.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',n[n.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(r=ixt(e.cellXfs))&&(n[n.length]=r),n[n.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',n[n.length]='<dxfs count="0"/>',n[n.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',n.length>2&&(n[n.length]="</styleSheet>",n[1]=n[1].replace("/>",">")),n.join("")}function sxt(t,e){var n=t.read_shift(2),r=xa(t);return[n,r]}function oxt(t,e,n){n||(n=Ue(6+4*e.length)),n.write_shift(2,t),po(e,n);var r=n.length>n.l?n.slice(0,n.l):n;return n.l==null&&(n.l=n.length),r}function axt(t,e,n){var r={};r.sz=t.read_shift(2)/20;var i=Kvt(t);i.fItalic&&(r.italic=1),i.fCondense&&(r.condense=1),i.fExtend&&(r.extend=1),i.fShadow&&(r.shadow=1),i.fOutline&&(r.outline=1),i.fStrikeout&&(r.strike=1);var s=t.read_shift(2);switch(s===700&&(r.bold=1),t.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var o=t.read_shift(1);o!=0&&(r.underline=o);var a=t.read_shift(1);a>0&&(r.family=a);var l=t.read_shift(1);switch(l>0&&(r.charset=l),t.l++,r.color=qvt(t),t.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=xa(t),r}function lxt(t,e){e||(e=Ue(153)),e.write_shift(2,t.sz*20),Yvt(t,e),e.write_shift(2,t.bold?700:400);var n=0;t.vertAlign=="superscript"?n=1:t.vertAlign=="subscript"&&(n=2),e.write_shift(2,n),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),c5(t.color,e);var r=0;return r=2,e.write_shift(1,r),po(t.name,e),e.length>e.l?e.slice(0,e.l):e}var cxt=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],oF,uxt=Vd;function oae(t,e){e||(e=Ue(84)),oF||(oF=wq(cxt));var n=oF[t.patternType];n==null&&(n=40),e.write_shift(4,n);var r=0;if(n!=40)for(c5({auto:1},e),c5({auto:1},e);r<12;++r)e.write_shift(4,0);else{for(;r<4;++r)e.write_shift(4,0);for(;r<12;++r)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function hxt(t,e){var n=t.l+e,r=t.read_shift(2),i=t.read_shift(2);return t.l=n,{ixfe:r,numFmtId:i}}function REe(t,e,n){n||(n=Ue(16)),n.write_shift(2,e||0),n.write_shift(2,t.numFmtId||0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(1,0),n.write_shift(1,0);var r=0;return n.write_shift(1,r),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(1,0),n}function eS(t,e){return e||(e=Ue(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var dxt=Vd;function fxt(t,e){return e||(e=Ue(51)),e.write_shift(1,0),eS(null,e),eS(null,e),eS(null,e),eS(null,e),eS(null,e),e.length>e.l?e.slice(0,e.l):e}function pxt(t,e){return e||(e=Ue(52)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),l5(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function mxt(t,e,n){var r=Ue(2052);return r.write_shift(4,t),l5(e,r),l5(n,r),r.length>r.l?r.slice(0,r.l):r}function gxt(t,e){if(e){var n=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)e[i]!=null&&++n}),n!=0&&(tt(t,615,ph(n)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)e[i]!=null&&tt(t,44,oxt(i,e[i]))}),tt(t,616))}}function yxt(t){var e=1;tt(t,611,ph(e)),tt(t,43,lxt({sz:12,color:{theme:1},name:"Calibri",family:2})),tt(t,612)}function vxt(t){var e=2;tt(t,603,ph(e)),tt(t,45,oae({patternType:"none"})),tt(t,45,oae({patternType:"gray125"})),tt(t,604)}function _xt(t){var e=1;tt(t,613,ph(e)),tt(t,46,fxt()),tt(t,614)}function xxt(t){var e=1;tt(t,626,ph(e)),tt(t,47,REe({numFmtId:0},65535)),tt(t,627)}function wxt(t,e){tt(t,617,ph(e.length)),e.forEach(function(n){tt(t,47,REe(n,0))}),tt(t,618)}function bxt(t){var e=1;tt(t,619,ph(e)),tt(t,48,pxt({xfId:0,name:"Normal"})),tt(t,620)}function Ext(t){var e=0;tt(t,505,ph(e)),tt(t,506)}function Sxt(t){var e=0;tt(t,508,mxt(e,"TableStyleMedium9","PivotStyleMedium4")),tt(t,509)}function Txt(t,e){var n=Tl();return tt(n,278),gxt(n,t.SSF),yxt(n),vxt(n),_xt(n),xxt(n),wxt(n,e.cellXfs),bxt(n),Ext(n),Sxt(n),tt(n,279),n.end()}function MEe(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var n=[Os];return n[n.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',n[n.length]="<a:themeElements>",n[n.length]='<a:clrScheme name="Office">',n[n.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',n[n.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',n[n.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',n[n.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',n[n.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',n[n.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',n[n.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',n[n.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',n[n.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',n[n.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',n[n.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',n[n.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',n[n.length]="</a:clrScheme>",n[n.length]='<a:fontScheme name="Office">',n[n.length]="<a:majorFont>",n[n.length]='<a:latin typeface="Cambria"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface=" "/>',n[n.length]='<a:font script="Hang" typeface=" "/>',n[n.length]='<a:font script="Hans" typeface=""/>',n[n.length]='<a:font script="Hant" typeface=""/>',n[n.length]='<a:font script="Arab" typeface="Times New Roman"/>',n[n.length]='<a:font script="Hebr" typeface="Times New Roman"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="MoolBoran"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Times New Roman"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:majorFont>",n[n.length]="<a:minorFont>",n[n.length]='<a:latin typeface="Calibri"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface=" "/>',n[n.length]='<a:font script="Hang" typeface=" "/>',n[n.length]='<a:font script="Hans" typeface=""/>',n[n.length]='<a:font script="Hant" typeface=""/>',n[n.length]='<a:font script="Arab" typeface="Arial"/>',n[n.length]='<a:font script="Hebr" typeface="Arial"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="DaunPenh"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Arial"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:minorFont>",n[n.length]="</a:fontScheme>",n[n.length]='<a:fmtScheme name="Office">',n[n.length]="<a:fillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="1"/>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="0"/>',n[n.length]="</a:gradFill>",n[n.length]="</a:fillStyleLst>",n[n.length]="<a:lnStyleLst>",n[n.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]="</a:lnStyleLst>",n[n.length]="<a:effectStyleLst>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',n[n.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',n[n.length]="</a:effectStyle>",n[n.length]="</a:effectStyleLst>",n[n.length]="<a:bgFillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]="</a:bgFillStyleLst>",n[n.length]="</a:fmtScheme>",n[n.length]="</a:themeElements>",n[n.length]="<a:objectDefaults>",n[n.length]="<a:spDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',n[n.length]="</a:spDef>",n[n.length]="<a:lnDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',n[n.length]="</a:lnDef>",n[n.length]="</a:objectDefaults>",n[n.length]="<a:extraClrSchemeLst/>",n[n.length]="</a:theme>",n.join("")}function kxt(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:xa(t)}}function Axt(t){var e=Ue(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),po(t.name,e),e.slice(0,e.l)}function Ixt(t){for(var e=[],n=t.read_shift(4);n-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function Pxt(t){var e=Ue(4+8*t.length);e.write_shift(4,t.length);for(var n=0;n<t.length;++n)e.write_shift(4,t[n][0]),e.write_shift(4,t[n][1]);return e}function Cxt(t,e){var n=Ue(8+2*e.length);return n.write_shift(4,t),po(e,n),n.slice(0,n.l)}function Rxt(t){return t.l+=4,t.read_shift(4)!=0}function Mxt(t,e){var n=Ue(8);return n.write_shift(4,t),n.write_shift(4,1),n}function Nxt(){var t=Tl();return tt(t,332),tt(t,334,ph(1)),tt(t,335,Axt({name:"XLDAPR",version:12e4,flags:3496657072})),tt(t,336),tt(t,339,Cxt(1,"XLDAPR")),tt(t,52),tt(t,35,ph(514)),tt(t,4096,ph(0)),tt(t,4097,Yc(1)),tt(t,36),tt(t,53),tt(t,340),tt(t,337,Mxt(1)),tt(t,51,Pxt([[1,0]])),tt(t,338),tt(t,333),t.end()}function NEe(){var t=[Os];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function Oxt(t){var e={};e.i=t.read_shift(4);var n={};n.r=t.read_shift(4),n.c=t.read_shift(4),e.r=qr(n);var r=t.read_shift(1);return r&2&&(e.l="1"),r&8&&(e.a="1"),e}var Bx=1024;function OEe(t,e){for(var n=[21600,21600],r=["m0,0l0",n[1],n[0],n[1],n[0],"0xe"].join(","),i=[yt("xml",null,{"xmlns:v":oc.v,"xmlns:o":oc.o,"xmlns:x":oc.x,"xmlns:mv":oc.mv}).replace(/\/>/,">"),yt("o:shapelayout",yt("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),yt("v:shapetype",[yt("v:stroke",null,{joinstyle:"miter"}),yt("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:n.join(","),path:r})];Bx<t*1e3;)Bx+=1e3;return e.forEach(function(s){var o=fo(s[0]),a={color2:"#BEFF82",type:"gradient"};a.type=="gradient"&&(a.angle="-180");var l=a.type=="gradient"?yt("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=yt("v:fill",l,a),u={on:"t",obscured:"t"};++Bx,i=i.concat(["<v:shape"+PA({id:"_x0000_s"+Bx,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,yt("v:shadow",null,u),yt("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Lo("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),Lo("x:AutoFill","False"),Lo("x:Row",String(o.r)),Lo("x:Column",String(o.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function LEe(t){var e=[Os,yt("comments",null,{xmlns:Ib[0]})],n=[];return e.push("<authors>"),t.forEach(function(r){r[1].forEach(function(i){var s=Wr(i.a);n.indexOf(s)==-1&&(n.push(s),e.push("<author>"+s+"</author>")),i.T&&i.ID&&n.indexOf("tc="+i.ID)==-1&&(n.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),n.length==0&&(n.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(r){var i=0,s=[];if(r[1][0]&&r[1][0].T&&r[1][0].ID?i=n.indexOf("tc="+r[1][0].ID):r[1].forEach(function(l){l.a&&(i=n.indexOf(Wr(l.a))),s.push(l.t||"")}),e.push('<comment ref="'+r[0]+'" authorId="'+i+'"><text>'),s.length<=1)e.push(Lo("t",Wr(s[0]||"")));else{for(var o=`Comment:
    `+s[0]+`
`,a=1;a<s.length;++a)o+=`Reply:
    `+s[a]+`
`;e.push(Lo("t",Wr(o)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function Lxt(t,e,n){var r=[Os,yt("ThreadedComments",null,{xmlns:uo.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(i){var s="";(i[1]||[]).forEach(function(o,a){if(!o.T){delete o.ID;return}o.a&&e.indexOf(o.a)==-1&&e.push(o.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+n.tcid++).slice(-12)+"}"};a==0?s=l.id:l.parentId=s,o.ID=l.id,o.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(o.a)).slice(-12)+"}"),r.push(yt("threadedComment",Lo("text",o.t||""),l))})}),r.push("</ThreadedComments>"),r.join("")}function Dxt(t){var e=[Os,yt("personList",null,{xmlns:uo.TCMNT,"xmlns:x":Ib[0]}).replace(/[\/]>/,">")];return t.forEach(function(n,r){e.push(yt("person",null,{displayName:n,id:"{54EE7950-7262-4200-6969-"+("000000000000"+r).slice(-12)+"}",userId:n,providerId:"None"}))}),e.push("</personList>"),e.join("")}function jxt(t){var e={};e.iauthor=t.read_shift(4);var n=Tv(t);return e.rfx=n.s,e.ref=qr(n.s),t.l+=16,e}function $xt(t,e){return e==null&&(e=Ue(36)),e.write_shift(4,t[1].iauthor),Cb(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var Fxt=xa;function Vxt(t){return po(t.slice(0,54))}function zxt(t){var e=Tl(),n=[];return tt(e,628),tt(e,630),t.forEach(function(r){r[1].forEach(function(i){n.indexOf(i.a)>-1||(n.push(i.a.slice(0,54)),tt(e,632,Vxt(i.a)))})}),tt(e,631),tt(e,633),t.forEach(function(r){r[1].forEach(function(i){i.iauthor=n.indexOf(i.a);var s={s:fo(r[0]),e:fo(r[0])};tt(e,635,$xt([s,i])),i.t&&i.t.length>0&&tt(e,637,Uvt(i)),tt(e,636),delete i.iauthor})}),tt(e,634),tt(e,629),e.end()}function Gxt(t,e){e.FullPaths.forEach(function(n,r){if(r!=0){var i=n.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Xr.utils.cfb_add(t,i,e.FileIndex[r].content)}})}var DEe=["xlsb","xlsm","xlam","biff8","xla"],Uxt=(function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function n(r,i,s,o){var a=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),o.length==0?a=!0:o.charAt(0)=="["&&(a=!0,o=o.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,u=o.length>0?parseInt(o,10)|0:0;return a?u+=e.c:--u,l?c+=e.r:--c,i+(a?"":"$")+_a(u)+(l?"":"$")+Do(c)}return function(i,s){return e=s,i.replace(t,n)}})(),Oq=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Lq=(function(){return function(e,n){return e.replace(Oq,function(r,i,s,o,a,l){var c=Iq(o)-(s?0:n.c),u=Aq(l)-(a?0:n.r),h=u==0?"":a?u+1:"["+u+"]",f=c==0?"":s?c+1:"["+c+"]";return i+"R"+h+"C"+f})}})();function Bxt(t,e){return t.replace(Oq,function(n,r,i,s,o,a){return r+(i=="$"?i+s:_a(Iq(s)+e.c))+(o=="$"?o+a:Do(Aq(a)+e.r))})}function Wxt(t){return t.length!=1}function vs(t){t.l+=1}function Qg(t,e){var n=t.read_shift(2);return[n&16383,n>>14&1,n>>15&1]}function jEe(t,e,n){var r=2;if(n){if(n.biff>=2&&n.biff<=5)return $Ee(t);n.biff==12&&(r=4)}var i=t.read_shift(r),s=t.read_shift(r),o=Qg(t),a=Qg(t);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:s,c:a[0],cRel:a[1],rRel:a[2]}}}function $Ee(t){var e=Qg(t),n=Qg(t),r=t.read_shift(1),i=t.read_shift(1);return{s:{r:e[0],c:r,cRel:e[1],rRel:e[2]},e:{r:n[0],c:i,cRel:n[1],rRel:n[2]}}}function Hxt(t,e,n){if(n.biff<8)return $Ee(t);var r=t.read_shift(n.biff==12?4:2),i=t.read_shift(n.biff==12?4:2),s=Qg(t),o=Qg(t);return{s:{r,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function FEe(t,e,n){if(n&&n.biff>=2&&n.biff<=5)return qxt(t);var r=t.read_shift(n&&n.biff==12?4:2),i=Qg(t);return{r,c:i[0],cRel:i[1],rRel:i[2]}}function qxt(t){var e=Qg(t),n=t.read_shift(1);return{r:e[0],c:n,cRel:e[1],rRel:e[2]}}function Kxt(t){var e=t.read_shift(2),n=t.read_shift(2);return{r:e,c:n&255,fQuoted:!!(n&16384),cRel:n>>15,rRel:n>>15}}function Yxt(t,e,n){var r=n&&n.biff?n.biff:8;if(r>=2&&r<=5)return Xxt(t);var i=t.read_shift(r>=12?4:2),s=t.read_shift(2),o=(s&16384)>>14,a=(s&32768)>>15;if(s&=16383,a==1)for(;i>524287;)i-=1048576;if(o==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:o,rRel:a}}function Xxt(t){var e=t.read_shift(2),n=t.read_shift(1),r=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,r==1&&e>=8192&&(e=e-16384),i==1&&n>=128&&(n=n-256),{r:e,c:n,cRel:i,rRel:r}}function Zxt(t,e,n){var r=(t[t.l++]&96)>>5,i=jEe(t,n.biff>=2&&n.biff<=5?6:8,n);return[r,i]}function Jxt(t,e,n){var r=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),s=8;if(n)switch(n.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}var o=jEe(t,s,n);return[r,i,o]}function Qxt(t,e,n){var r=(t[t.l++]&96)>>5;return t.l+=n&&n.biff>8?12:n.biff<8?6:8,[r]}function ewt(t,e,n){var r=(t[t.l++]&96)>>5,i=t.read_shift(2),s=8;if(n)switch(n.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}return t.l+=s,[r,i]}function twt(t,e,n){var r=(t[t.l++]&96)>>5,i=Hxt(t,e-1,n);return[r,i]}function nwt(t,e,n){var r=(t[t.l++]&96)>>5;return t.l+=n.biff==2?6:n.biff==12?14:7,[r]}function aae(t){var e=t[t.l+1]&1,n=1;return t.l+=4,[e,n]}function rwt(t,e,n){t.l+=2;for(var r=t.read_shift(n&&n.biff==2?1:2),i=[],s=0;s<=r;++s)i.push(t.read_shift(n&&n.biff==2?1:2));return i}function iwt(t,e,n){var r=t[t.l+1]&255?1:0;return t.l+=2,[r,t.read_shift(n&&n.biff==2?1:2)]}function swt(t,e,n){var r=t[t.l+1]&255?1:0;return t.l+=2,[r,t.read_shift(n&&n.biff==2?1:2)]}function owt(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function awt(t,e,n){var r=t[t.l+1]&255?1:0;return t.l+=n&&n.biff==2?3:4,[r]}function VEe(t){var e=t.read_shift(1),n=t.read_shift(1);return[e,n]}function lwt(t){return t.read_shift(2),VEe(t)}function cwt(t){return t.read_shift(2),VEe(t)}function uwt(t,e,n){var r=(t[t.l]&96)>>5;t.l+=1;var i=FEe(t,0,n);return[r,i]}function hwt(t,e,n){var r=(t[t.l]&96)>>5;t.l+=1;var i=Yxt(t,0,n);return[r,i]}function dwt(t,e,n){var r=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);n&&n.biff==5&&(t.l+=12);var s=FEe(t,0,n);return[r,i,s]}function fwt(t,e,n){var r=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(n&&n.biff<=3?1:2);return[f2t[i],UEe[i],r]}function pwt(t,e,n){var r=t[t.l++],i=t.read_shift(1),s=n&&n.biff<=3?[r==88?-1:0,t.read_shift(1)]:mwt(t);return[i,(s[0]===0?UEe:d2t)[s[1]]]}function mwt(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function gwt(t,e,n){t.l+=n&&n.biff==2?3:4}function ywt(t,e,n){if(t.l++,n&&n.biff==12)return[t.read_shift(4,"i"),0];var r=t.read_shift(2),i=t.read_shift(n&&n.biff==2?1:2);return[r,i]}function vwt(t){return t.l++,tP[t.read_shift(1)]}function _wt(t){return t.l++,t.read_shift(2)}function xwt(t){return t.l++,t.read_shift(1)!==0}function wwt(t){return t.l++,Rb(t)}function bwt(t,e,n){return t.l++,bEe(t,e-1,n)}function Ewt(t,e){var n=[t.read_shift(1)];if(e==12)switch(n[0]){case 2:n[0]=4;break;case 4:n[0]=16;break;case 0:n[0]=1;break;case 1:n[0]=2;break}switch(n[0]){case 4:n[1]=d_t(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:n[1]=tP[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:n[1]=Rb(t);break;case 2:n[1]=g_t(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+n[0])}return n}function Swt(t,e,n){for(var r=t.read_shift(n.biff==12?4:2),i=[],s=0;s!=r;++s)i.push((n.biff==12?Tv:__t)(t));return i}function Twt(t,e,n){var r=0,i=0;n.biff==12?(r=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),r=1+t.read_shift(2)),n.biff>=2&&n.biff<8&&(--r,--i==0&&(i=256));for(var s=0,o=[];s!=r&&(o[s]=[]);++s)for(var a=0;a!=i;++a)o[s][a]=Ewt(t,n.biff);return o}function kwt(t,e,n){var r=t.read_shift(1)>>>5&3,i=!n||n.biff>=8?4:2,s=t.read_shift(i);switch(n.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[r,0,s]}function Awt(t,e,n){if(n.biff==5)return Iwt(t);var r=t.read_shift(1)>>>5&3,i=t.read_shift(2),s=t.read_shift(4);return[r,i,s]}function Iwt(t){var e=t.read_shift(1)>>>5&3,n=t.read_shift(2,"i");t.l+=8;var r=t.read_shift(2);return t.l+=12,[e,n,r]}function Pwt(t,e,n){var r=t.read_shift(1)>>>5&3;t.l+=n&&n.biff==2?3:4;var i=t.read_shift(n&&n.biff==2?1:2);return[r,i]}function Cwt(t,e,n){var r=t.read_shift(1)>>>5&3,i=t.read_shift(n&&n.biff==2?1:2);return[r,i]}function Rwt(t,e,n){var r=t.read_shift(1)>>>5&3;return t.l+=4,n.biff<8&&t.l--,n.biff==12&&(t.l+=2),[r]}function Mwt(t,e,n){var r=(t[t.l++]&96)>>5,i=t.read_shift(2),s=4;if(n)switch(n.biff){case 5:s=15;break;case 12:s=6;break}return t.l+=s,[r,i]}var Nwt=Vd,Owt=Vd,Lwt=Vd;function nP(t,e,n){return t.l+=2,[Kxt(t)]}function Dq(t){return t.l+=6,[]}var Dwt=nP,jwt=Dq,$wt=Dq,Fwt=nP;function zEe(t){return t.l+=2,[xEe(t),t.read_shift(2)&1]}var Vwt=nP,zwt=zEe,Gwt=Dq,Uwt=nP,Bwt=nP,Wwt=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function Hwt(t){t.l+=2;var e=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(4),i=t.read_shift(2),s=t.read_shift(2),o=Wwt[n>>2&31];return{ixti:e,coltype:n&3,rt:o,idx:r,c:i,C:s}}function qwt(t){return t.l+=2,[t.read_shift(4)]}function Kwt(t,e,n){return t.l+=5,t.l+=2,t.l+=n.biff==2?1:4,["PTGSHEET"]}function Ywt(t,e,n){return t.l+=n.biff==2?4:5,["PTGENDSHEET"]}function Xwt(t){var e=t.read_shift(1)>>>5&3,n=t.read_shift(2);return[e,n]}function Zwt(t){var e=t.read_shift(1)>>>5&3,n=t.read_shift(2);return[e,n]}function Jwt(t){return t.l+=4,[0,0]}var lae={1:{n:"PtgExp",f:ywt},2:{n:"PtgTbl",f:Lwt},3:{n:"PtgAdd",f:vs},4:{n:"PtgSub",f:vs},5:{n:"PtgMul",f:vs},6:{n:"PtgDiv",f:vs},7:{n:"PtgPower",f:vs},8:{n:"PtgConcat",f:vs},9:{n:"PtgLt",f:vs},10:{n:"PtgLe",f:vs},11:{n:"PtgEq",f:vs},12:{n:"PtgGe",f:vs},13:{n:"PtgGt",f:vs},14:{n:"PtgNe",f:vs},15:{n:"PtgIsect",f:vs},16:{n:"PtgUnion",f:vs},17:{n:"PtgRange",f:vs},18:{n:"PtgUplus",f:vs},19:{n:"PtgUminus",f:vs},20:{n:"PtgPercent",f:vs},21:{n:"PtgParen",f:vs},22:{n:"PtgMissArg",f:vs},23:{n:"PtgStr",f:bwt},26:{n:"PtgSheet",f:Kwt},27:{n:"PtgEndSheet",f:Ywt},28:{n:"PtgErr",f:vwt},29:{n:"PtgBool",f:xwt},30:{n:"PtgInt",f:_wt},31:{n:"PtgNum",f:wwt},32:{n:"PtgArray",f:nwt},33:{n:"PtgFunc",f:fwt},34:{n:"PtgFuncVar",f:pwt},35:{n:"PtgName",f:kwt},36:{n:"PtgRef",f:uwt},37:{n:"PtgArea",f:Zxt},38:{n:"PtgMemArea",f:Pwt},39:{n:"PtgMemErr",f:Nwt},40:{n:"PtgMemNoMem",f:Owt},41:{n:"PtgMemFunc",f:Cwt},42:{n:"PtgRefErr",f:Rwt},43:{n:"PtgAreaErr",f:Qxt},44:{n:"PtgRefN",f:hwt},45:{n:"PtgAreaN",f:twt},46:{n:"PtgMemAreaN",f:Xwt},47:{n:"PtgMemNoMemN",f:Zwt},57:{n:"PtgNameX",f:Awt},58:{n:"PtgRef3d",f:dwt},59:{n:"PtgArea3d",f:Jxt},60:{n:"PtgRefErr3d",f:Mwt},61:{n:"PtgAreaErr3d",f:ewt},255:{}},Qwt={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},e2t={1:{n:"PtgElfLel",f:zEe},2:{n:"PtgElfRw",f:Uwt},3:{n:"PtgElfCol",f:Dwt},6:{n:"PtgElfRwV",f:Bwt},7:{n:"PtgElfColV",f:Fwt},10:{n:"PtgElfRadical",f:Vwt},11:{n:"PtgElfRadicalS",f:Gwt},13:{n:"PtgElfColS",f:jwt},15:{n:"PtgElfColSV",f:$wt},16:{n:"PtgElfRadicalLel",f:zwt},25:{n:"PtgList",f:Hwt},29:{n:"PtgSxName",f:qwt},255:{}},t2t={0:{n:"PtgAttrNoop",f:Jwt},1:{n:"PtgAttrSemi",f:awt},2:{n:"PtgAttrIf",f:swt},4:{n:"PtgAttrChoose",f:rwt},8:{n:"PtgAttrGoto",f:iwt},16:{n:"PtgAttrSum",f:gwt},32:{n:"PtgAttrBaxcel",f:aae},33:{n:"PtgAttrBaxcel",f:aae},64:{n:"PtgAttrSpace",f:lwt},65:{n:"PtgAttrSpaceSemi",f:cwt},128:{n:"PtgAttrIfError",f:owt},255:{}};function n2t(t,e,n,r){if(r.biff<8)return Vd(t,e);for(var i=t.l+e,s=[],o=0;o!==n.length;++o)switch(n[o][0]){case"PtgArray":n[o][1]=Twt(t,0,r),s.push(n[o][1]);break;case"PtgMemArea":n[o][2]=Swt(t,n[o][1],r),s.push(n[o][2]);break;case"PtgExp":r&&r.biff==12&&(n[o][1][1]=t.read_shift(4),s.push(n[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+n[o][0]}return e=i-t.l,e!==0&&s.push(Vd(t,e)),s}function r2t(t,e,n){for(var r=t.l+e,i,s,o=[];r!=t.l;)e=r-t.l,s=t[t.l],i=lae[s]||lae[Qwt[s]],(s===24||s===25)&&(i=(s===24?e2t:t2t)[t[t.l+1]]),!i||!i.f?Vd(t,e):o.push([i.n,i.f(t,e,n)]);return o}function i2t(t){for(var e=[],n=0;n<t.length;++n){for(var r=t[n],i=[],s=0;s<r.length;++s){var o=r[s];if(o)switch(o[0]){case 2:i.push('"'+o[1].replace(/"/g,'""')+'"');break;default:i.push(o[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var s2t={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function o2t(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function GEe(t,e,n){if(!t)return"SH33TJSERR0";if(n.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var r=t.XTI[e];if(n.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!r)return"SH33TJSERR1";var i="";if(n.biff>8)switch(t[r[0]][0]){case 357:return i=r[1]==-1?"#REF":t.SheetNames[r[1]],r[1]==r[2]?i:i+":"+t.SheetNames[r[2]];case 358:return n.SID!=null?t.SheetNames[n.SID]:"SH33TJSSAME"+t[r[0]][0];case 355:default:return"SH33TJSSRC"+t[r[0]][0]}switch(t[r[0]][0][0]){case 1025:return i=r[1]==-1?"#REF":t.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?i:i+":"+t.SheetNames[r[2]];case 14849:return t[r[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return t[r[0]][0][3]?(i=r[1]==-1?"#REF":t[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?i:i+":"+t[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function cae(t,e,n){var r=GEe(t,e,n);return r=="#REF"?r:o2t(r,n)}function U2(t,e,n,r,i){var s=i&&i.biff||8,o={s:{c:0,r:0}},a=[],l,c,u,h=0,f=0,g,y="";if(!t[0]||!t[0][0])return"";for(var _=-1,b="",T=0,A=t[0].length;T<A;++T){var I=t[0][T];switch(I[0]){case"PtgUminus":a.push("-"+a.pop());break;case"PtgUplus":a.push("+"+a.pop());break;case"PtgPercent":a.push(a.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=a.pop(),c=a.pop(),_>=0){switch(t[0][_][1][0]){case 0:b=Ji(" ",t[0][_][1][1]);break;case 1:b=Ji("\r",t[0][_][1][1]);break;default:if(b="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][_][1][0])}c=c+b,_=-1}a.push(c+s2t[I[0]]+l);break;case"PtgIsect":l=a.pop(),c=a.pop(),a.push(c+" "+l);break;case"PtgUnion":l=a.pop(),c=a.pop(),a.push(c+","+l);break;case"PtgRange":l=a.pop(),c=a.pop(),a.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=nk(I[1][1],o,i),a.push(rk(u,s));break;case"PtgRefN":u=n?nk(I[1][1],n,i):I[1][1],a.push(rk(u,s));break;case"PtgRef3d":h=I[1][1],u=nk(I[1][2],o,i),y=cae(r,h,i),a.push(y+"!"+rk(u,s));break;case"PtgFunc":case"PtgFuncVar":var P=I[1][0],R=I[1][1];P||(P=0),P&=127;var D=P==0?[]:a.slice(-P);a.length-=P,R==="User"&&(R=D.shift()),a.push(R+"("+D.join(",")+")");break;case"PtgBool":a.push(I[1]?"TRUE":"FALSE");break;case"PtgInt":a.push(I[1]);break;case"PtgNum":a.push(String(I[1]));break;case"PtgStr":a.push('"'+I[1].replace(/"/g,'""')+'"');break;case"PtgErr":a.push(I[1]);break;case"PtgAreaN":g=qoe(I[1][1],n?{s:n}:o,i),a.push(iF(g,i));break;case"PtgArea":g=qoe(I[1][1],o,i),a.push(iF(g,i));break;case"PtgArea3d":h=I[1][1],g=I[1][2],y=cae(r,h,i),a.push(y+"!"+iF(g,i));break;case"PtgAttrSum":a.push("SUM("+a.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":f=I[1][2];var C=(r.names||[])[f-1]||(r[0]||[])[f],M=C?C.Name:"SH33TJSNAME"+String(f);M&&M.slice(0,6)=="_xlfn."&&!i.xlfn&&(M=M.slice(6)),a.push(M);break;case"PtgNameX":var O=I[1][1];f=I[1][2];var j;if(i.biff<=5)O<0&&(O=-O),r[O]&&(j=r[O][f]);else{var V="";if(((r[O]||[])[0]||[])[0]==14849||(((r[O]||[])[0]||[])[0]==1025?r[O][f]&&r[O][f].itab>0&&(V=r.SheetNames[r[O][f].itab-1]+"!"):V=r.SheetNames[f-1]+"!"),r[O]&&r[O][f])V+=r[O][f].Name;else if(r[0]&&r[0][f])V+=r[0][f].Name;else{var U=(GEe(r,O,i)||"").split(";;");U[f-1]?V=U[f-1]:V+="SH33TJSERRX"}a.push(V);break}j||(j={Name:"SH33TJSERRY"}),a.push(j.Name);break;case"PtgParen":var G="(",de=")";if(_>=0){switch(b="",t[0][_][1][0]){case 2:G=Ji(" ",t[0][_][1][1])+G;break;case 3:G=Ji("\r",t[0][_][1][1])+G;break;case 4:de=Ji(" ",t[0][_][1][1])+de;break;case 5:de=Ji("\r",t[0][_][1][1])+de;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][_][1][0])}_=-1}a.push(G+a.pop()+de);break;case"PtgRefErr":a.push("#REF!");break;case"PtgRefErr3d":a.push("#REF!");break;case"PtgExp":u={c:I[1][1],r:I[1][0]};var Ie={c:n.c,r:n.r};if(r.sharedf[qr(u)]){var ze=r.sharedf[qr(u)];a.push(U2(ze,o,Ie,r,i))}else{var Ne=!1;for(l=0;l!=r.arrayf.length;++l)if(c=r.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){a.push(U2(c[1],o,Ie,r,i)),Ne=!0;break}Ne||a.push(I[1])}break;case"PtgArray":a.push("{"+i2t(I[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":_=T;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":a.push("");break;case"PtgAreaErr":a.push("#REF!");break;case"PtgAreaErr3d":a.push("#REF!");break;case"PtgList":a.push("Table"+I[1].idx+"[#"+I[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(I));default:throw new Error("Unrecognized Formula Token: "+String(I))}var fe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&_>=0&&fe.indexOf(t[0][T][0])==-1){I=t[0][_];var De=!0;switch(I[1][0]){case 4:De=!1;case 0:b=Ji(" ",I[1][1]);break;case 5:De=!1;case 1:b=Ji("\r",I[1][1]);break;default:if(b="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+I[1][0])}a.push((De?b:"")+a.pop()+(De?"":b)),_=-1}}if(a.length>1&&i.WTF)throw new Error("bad formula stack");return a[0]}function a2t(t){if(t==null){var e=Ue(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return ev(t);return ev(0)}function l2t(t,e,n,r,i){var s=tv(e,n,i),o=a2t(t.v),a=Ue(6),l=33;a.write_shift(2,l),a.write_shift(4,0);for(var c=Ue(t.bf.length),u=0;u<t.bf.length;++u)c[u]=t.bf[u];var h=Oo([s,o,a,c]);return h}function jL(t,e,n){var r=t.read_shift(4),i=r2t(t,r,n),s=t.read_shift(4),o=s>0?n2t(t,s,i,n):null;return[i,o]}var c2t=jL,$L=jL,u2t=jL,h2t=jL,d2t={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},UEe={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},f2t={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function p2t(t){var e="of:="+t.replace(Oq,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function m2t(t){return t.replace(/\./,"!")}var ik=typeof Map<"u";function jq(t,e,n){var r=0,i=t.length;if(n){if(ik?n.has(e):Object.prototype.hasOwnProperty.call(n,e)){for(var s=ik?n.get(e):n[e];r<s.length;++r)if(t[s[r]].t===e)return t.Count++,s[r]}}else for(;r<i;++r)if(t[r].t===e)return t.Count++,r;return t[i]={t:e},t.Count++,t.Unique++,n&&(ik?(n.has(e)||n.set(e,[]),n.get(e).push(i)):(Object.prototype.hasOwnProperty.call(n,e)||(n[e]=[]),n[e].push(i))),i}function FL(t,e){var n={min:t+1,max:t+1},r=-1;return e.MDW&&(cp=e.MDW),e.width!=null?n.customWidth=1:e.wpx!=null?r=d5(e.wpx):e.wch!=null&&(r=e.wch),r>-1?(n.width=Vz(r),n.customWidth=1):e.width!=null&&(n.width=e.width),e.hidden&&(n.hidden=!0),e.level!=null&&(n.outlineLevel=n.level=e.level),n}function BEe(t,e){if(t){var n=[.7,.7,.75,.75,.3,.3];t.left==null&&(t.left=n[0]),t.right==null&&(t.right=n[1]),t.top==null&&(t.top=n[2]),t.bottom==null&&(t.bottom=n[3]),t.header==null&&(t.header=n[4]),t.footer==null&&(t.footer=n[5])}}function d0(t,e,n){var r=n.revssf[e.z!=null?e.z:"General"],i=60,s=t.length;if(r==null&&n.ssf){for(;i<392;++i)if(n.ssf[i]==null){Fbe(e.z,i),n.ssf[i]=e.z,n.revssf[e.z]=r=i;break}}for(i=0;i!=s;++i)if(t[i].numFmtId===r)return i;return t[s]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function g2t(t,e,n){if(t&&t["!ref"]){var r=yi(t["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+n+"): "+t["!ref"])}}function y2t(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',n=0;n!=t.length;++n)e+='<mergeCell ref="'+Ms(t[n])+'"/>';return e+"</mergeCells>"}function v2t(t,e,n,r,i){var s=!1,o={},a=null;if(r.bookType!=="xlsx"&&e.vbaraw){var l=e.SheetNames[n];try{e.Workbook&&(l=e.Workbook.Sheets[n].CodeName||l)}catch{}s=!0,o.codeName=IA(Wr(l))}if(t&&t["!outline"]){var c={summaryBelow:1,summaryRight:1};t["!outline"].above&&(c.summaryBelow=0),t["!outline"].left&&(c.summaryRight=0),a=(a||"")+yt("outlinePr",null,c)}!s&&!a||(i[i.length]=yt("sheetPr",a,o))}var _2t=["objects","scenarios","selectLockedCells","selectUnlockedCells"],x2t=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function w2t(t){var e={sheet:1};return _2t.forEach(function(n){t[n]!=null&&t[n]&&(e[n]="1")}),x2t.forEach(function(n){t[n]!=null&&!t[n]&&(e[n]="0")}),t.password&&(e.password=AEe(t.password).toString(16).toUpperCase()),yt("sheetProtection",null,e)}function b2t(t){return BEe(t),yt("pageMargins",null,t)}function E2t(t,e){for(var n=["<cols>"],r,i=0;i!=e.length;++i)(r=e[i])&&(n[n.length]=yt("col",null,FL(i,r)));return n[n.length]="</cols>",n.join("")}function S2t(t,e,n,r){var i=typeof t.ref=="string"?t.ref:Ms(t.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var s=n.Workbook.Names,o=Ec(i);o.s.r==o.e.r&&(o.e.r=Ec(e["!ref"]).e.r,i=Ms(o));for(var a=0;a<s.length;++a){var l=s[a];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==r){l.Ref="'"+n.SheetNames[r]+"'!"+i;break}}return a==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+i}),yt("autoFilter",null,{ref:i})}function T2t(t,e,n,r){var i={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),yt("sheetViews",yt("sheetView",null,i),{})}function k2t(t,e,n,r){if(t.c&&n["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var i="",s=t.t,o=t.v;if(t.t!=="z")switch(t.t){case"b":i=t.v?"1":"0";break;case"n":i=""+t.v;break;case"e":i=tP[t.v];break;case"d":r&&r.cellDates?i=Ga(t.v,-1).toISOString():(t=Rl(t),t.t="n",i=""+(t.v=Cl(Ga(t.v)))),typeof t.z>"u"&&(t.z=rs[14]);break;default:i=t.v;break}var a=Lo("v",Wr(i)),l={r:e},c=d0(r.cellXfs,t,r);switch(c!==0&&(l.s=c),t.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){a=Lo("v",""+jq(r.Strings,t.v,r.revStrings)),l.t="s";break}l.t="str";break}if(t.t!=s&&(t.t=s,t.v=o),typeof t.f=="string"&&t.f){var u=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;a=yt("f",Wr(t.f),u)+(t.v!=null?a:"")}return t.l&&n["!links"].push([e,t.l]),t.D&&(l.cm=1),yt("c",a,l)}function A2t(t,e,n,r){var i=[],s=[],o=yi(t["!ref"]),a="",l,c="",u=[],h=0,f=0,g=t["!rows"],y=Array.isArray(t),_={r:c},b,T=-1;for(f=o.s.c;f<=o.e.c;++f)u[f]=_a(f);for(h=o.s.r;h<=o.e.r;++h){for(s=[],c=Do(h),f=o.s.c;f<=o.e.c;++f){l=u[f]+c;var A=y?(t[h]||[])[f]:t[l];A!==void 0&&(a=k2t(A,l,t,e))!=null&&s.push(a)}(s.length>0||g&&g[h])&&(_={r:c},g&&g[h]&&(b=g[h],b.hidden&&(_.hidden=1),T=-1,b.hpx?T=f5(b.hpx):b.hpt&&(T=b.hpt),T>-1&&(_.ht=T,_.customHeight=1),b.level&&(_.outlineLevel=b.level)),i[i.length]=yt("row",s.join(""),_))}if(g)for(;h<g.length;++h)g&&g[h]&&(_={r:h+1},b=g[h],b.hidden&&(_.hidden=1),T=-1,b.hpx?T=f5(b.hpx):b.hpt&&(T=b.hpt),T>-1&&(_.ht=T,_.customHeight=1),b.level&&(_.outlineLevel=b.level),i[i.length]=yt("row","",_));return i.join("")}function WEe(t,e,n,r){var i=[Os,yt("worksheet",null,{xmlns:Ib[0],"xmlns:r":uo.r})],s=n.SheetNames[t],o=0,a="",l=n.Sheets[s];l==null&&(l={});var c=l["!ref"]||"A1",u=yi(c);if(u.e.c>16383||u.e.r>1048575){if(e.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),c=Ms(u)}r||(r={}),l["!comments"]=[];var h=[];v2t(l,n,t,e,i),i[i.length]=yt("dimension",null,{ref:c}),i[i.length]=T2t(l,e,t,n),e.sheetFormat&&(i[i.length]=yt("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=E2t(l,l["!cols"])),i[o=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(a=A2t(l,e),a.length>0&&(i[i.length]=a)),i.length>o+1&&(i[i.length]="</sheetData>",i[o]=i[o].replace("/>",">")),l["!protect"]&&(i[i.length]=w2t(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=S2t(l["!autofilter"],l,n,t)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=y2t(l["!merges"]));var f=-1,g,y=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(_){_[1].Target&&(g={ref:_[0]},_[1].Target.charAt(0)!="#"&&(y=zr(r,-1,Wr(_[1].Target).replace(/#.*$/,""),xr.HLINK),g["r:id"]="rId"+y),(f=_[1].Target.indexOf("#"))>-1&&(g.location=Wr(_[1].Target.slice(f+1))),_[1].Tooltip&&(g.tooltip=Wr(_[1].Tooltip)),i[i.length]=yt("hyperlink",null,g))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=b2t(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=Lo("ignoredErrors",yt("ignoredError",null,{numberStoredAsText:1,sqref:c}))),h.length>0&&(y=zr(r,-1,"../drawings/drawing"+(t+1)+".xml",xr.DRAW),i[i.length]=yt("drawing",null,{"r:id":"rId"+y}),l["!drawing"]=h),l["!comments"].length>0&&(y=zr(r,-1,"../drawings/vmlDrawing"+(t+1)+".vml",xr.VML),i[i.length]=yt("legacyDrawing",null,{"r:id":"rId"+y}),l["!legacy"]=y),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function I2t(t,e){var n={},r=t.l+e;n.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var s=t.read_shift(1);return t.l=r,s&7&&(n.level=s&7),s&16&&(n.hidden=!0),s&32&&(n.hpt=i/20),n}function P2t(t,e,n){var r=Ue(145),i=(n["!rows"]||[])[t]||{};r.write_shift(4,t),r.write_shift(4,0);var s=320;i.hpx?s=f5(i.hpx)*20:i.hpt&&(s=i.hpt*20),r.write_shift(2,s),r.write_shift(1,0);var o=0;i.level&&(o|=i.level),i.hidden&&(o|=16),(i.hpx||i.hpt)&&(o|=32),r.write_shift(1,o),r.write_shift(1,0);var a=0,l=r.l;r.l+=4;for(var c={r:t,c:0},u=0;u<16;++u)if(!(e.s.c>u+1<<10||e.e.c<u<<10)){for(var h=-1,f=-1,g=u<<10;g<u+1<<10;++g){c.c=g;var y=Array.isArray(n)?(n[c.r]||[])[c.c]:n[qr(c)];y&&(h<0&&(h=g),f=g)}h<0||(++a,r.write_shift(4,h),r.write_shift(4,f))}var _=r.l;return r.l=l,r.write_shift(4,a),r.l=_,r.length>r.l?r.slice(0,r.l):r}function C2t(t,e,n,r){var i=P2t(r,n,e);(i.length>17||(e["!rows"]||[])[r])&&tt(t,0,i)}var R2t=Tv,M2t=Cb;function N2t(){}function O2t(t,e){var n={},r=t[t.l];return++t.l,n.above=!(r&64),n.left=!(r&128),t.l+=18,n.name=Bvt(t),n}function L2t(t,e,n){n==null&&(n=Ue(84+4*t.length));var r=192;e&&(e.above&&(r&=-65),e.left&&(r&=-129)),n.write_shift(1,r);for(var i=1;i<3;++i)n.write_shift(1,0);return c5({auto:1},n),n.write_shift(-4,-1),n.write_shift(-4,-1),oEe(t,n),n.slice(0,n.l)}function D2t(t){var e=bu(t);return[e]}function j2t(t,e,n){return n==null&&(n=Ue(8)),bv(e,n)}function $2t(t){var e=Ev(t);return[e]}function F2t(t,e,n){return n==null&&(n=Ue(4)),Sv(e,n)}function V2t(t){var e=bu(t),n=t.read_shift(1);return[e,n,"b"]}function z2t(t,e,n){return n==null&&(n=Ue(9)),bv(e,n),n.write_shift(1,t.v?1:0),n}function G2t(t){var e=Ev(t),n=t.read_shift(1);return[e,n,"b"]}function U2t(t,e,n){return n==null&&(n=Ue(5)),Sv(e,n),n.write_shift(1,t.v?1:0),n}function B2t(t){var e=bu(t),n=t.read_shift(1);return[e,n,"e"]}function W2t(t,e,n){return n==null&&(n=Ue(9)),bv(e,n),n.write_shift(1,t.v),n}function H2t(t){var e=Ev(t),n=t.read_shift(1);return[e,n,"e"]}function q2t(t,e,n){return n==null&&(n=Ue(8)),Sv(e,n),n.write_shift(1,t.v),n.write_shift(2,0),n.write_shift(1,0),n}function K2t(t){var e=bu(t),n=t.read_shift(4);return[e,n,"s"]}function Y2t(t,e,n){return n==null&&(n=Ue(12)),bv(e,n),n.write_shift(4,e.v),n}function X2t(t){var e=Ev(t),n=t.read_shift(4);return[e,n,"s"]}function Z2t(t,e,n){return n==null&&(n=Ue(8)),Sv(e,n),n.write_shift(4,e.v),n}function J2t(t){var e=bu(t),n=Rb(t);return[e,n,"n"]}function Q2t(t,e,n){return n==null&&(n=Ue(16)),bv(e,n),ev(t.v,n),n}function ebt(t){var e=Ev(t),n=Rb(t);return[e,n,"n"]}function tbt(t,e,n){return n==null&&(n=Ue(12)),Sv(e,n),ev(t.v,n),n}function nbt(t){var e=bu(t),n=aEe(t);return[e,n,"n"]}function rbt(t,e,n){return n==null&&(n=Ue(12)),bv(e,n),lEe(t.v,n),n}function ibt(t){var e=Ev(t),n=aEe(t);return[e,n,"n"]}function sbt(t,e,n){return n==null&&(n=Ue(8)),Sv(e,n),lEe(t.v,n),n}function obt(t){var e=bu(t),n=Pq(t);return[e,n,"is"]}function abt(t){var e=bu(t),n=xa(t);return[e,n,"str"]}function lbt(t,e,n){return n==null&&(n=Ue(12+4*t.v.length)),bv(e,n),po(t.v,n),n.length>n.l?n.slice(0,n.l):n}function cbt(t){var e=Ev(t),n=xa(t);return[e,n,"str"]}function ubt(t,e,n){return n==null&&(n=Ue(8+4*t.v.length)),Sv(e,n),po(t.v,n),n.length>n.l?n.slice(0,n.l):n}function hbt(t,e,n){var r=t.l+e,i=bu(t);i.r=n["!row"];var s=t.read_shift(1),o=[i,s,"b"];if(n.cellFormula){t.l+=2;var a=$L(t,r-t.l,n);o[3]=U2(a,null,i,n.supbooks,n)}else t.l=r;return o}function dbt(t,e,n){var r=t.l+e,i=bu(t);i.r=n["!row"];var s=t.read_shift(1),o=[i,s,"e"];if(n.cellFormula){t.l+=2;var a=$L(t,r-t.l,n);o[3]=U2(a,null,i,n.supbooks,n)}else t.l=r;return o}function fbt(t,e,n){var r=t.l+e,i=bu(t);i.r=n["!row"];var s=Rb(t),o=[i,s,"n"];if(n.cellFormula){t.l+=2;var a=$L(t,r-t.l,n);o[3]=U2(a,null,i,n.supbooks,n)}else t.l=r;return o}function pbt(t,e,n){var r=t.l+e,i=bu(t);i.r=n["!row"];var s=xa(t),o=[i,s,"str"];if(n.cellFormula){t.l+=2;var a=$L(t,r-t.l,n);o[3]=U2(a,null,i,n.supbooks,n)}else t.l=r;return o}var mbt=Tv,gbt=Cb;function ybt(t,e){return e==null&&(e=Ue(4)),e.write_shift(4,t),e}function vbt(t,e){var n=t.l+e,r=Tv(t),i=Cq(t),s=xa(t),o=xa(t),a=xa(t);t.l=n;var l={rfx:r,relId:i,loc:s,display:a};return o&&(l.Tooltip=o),l}function _bt(t,e){var n=Ue(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));Cb({s:fo(t[0]),e:fo(t[0])},n),Rq("rId"+e,n);var r=t[1].Target.indexOf("#"),i=r==-1?"":t[1].Target.slice(r+1);return po(i||"",n),po(t[1].Tooltip||"",n),po("",n),n.slice(0,n.l)}function xbt(){}function wbt(t,e,n){var r=t.l+e,i=cEe(t),s=t.read_shift(1),o=[i];if(o[2]=s,n.cellFormula){var a=c2t(t,r-t.l,n);o[1]=a}else t.l=r;return o}function bbt(t,e,n){var r=t.l+e,i=Tv(t),s=[i];if(n.cellFormula){var o=h2t(t,r-t.l,n);s[1]=o,t.l=r}else t.l=r;return s}function Ebt(t,e,n){n==null&&(n=Ue(18));var r=FL(t,e);n.write_shift(-4,t),n.write_shift(-4,t),n.write_shift(4,(r.width||10)*256),n.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof r.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),n.write_shift(2,i),n}var HEe=["left","right","top","bottom","header","footer"];function Sbt(t){var e={};return HEe.forEach(function(n){e[n]=Rb(t)}),e}function Tbt(t,e){return e==null&&(e=Ue(48)),BEe(t),HEe.forEach(function(n){ev(t[n],e)}),e}function kbt(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function Abt(t,e,n){n==null&&(n=Ue(30));var r=924;return(((e||{}).Views||[])[0]||{}).RTL&&(r|=32),n.write_shift(2,r),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(2,0),n.write_shift(2,100),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(4,0),n}function Ibt(t){var e=Ue(24);return e.write_shift(4,4),e.write_shift(4,1),Cb(t,e),e}function Pbt(t,e){return e==null&&(e=Ue(66)),e.write_shift(2,t.password?AEe(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(n){n[1]?e.write_shift(4,t[n[0]]!=null&&!t[n[0]]?1:0):e.write_shift(4,t[n[0]]!=null&&t[n[0]]?0:1)}),e}function Cbt(){}function Rbt(){}function Mbt(t,e,n,r,i,s,o){if(e.v===void 0)return!1;var a="";switch(e.t){case"b":a=e.v?"1":"0";break;case"d":e=Rl(e),e.z=e.z||rs[14],e.v=Cl(Ga(e.v)),e.t="n";break;case"n":case"e":a=""+e.v;break;default:a=e.v;break}var l={r:n,c:r};switch(l.s=d0(i.cellXfs,e,i),e.l&&s["!links"].push([qr(l),e.l]),e.c&&s["!comments"].push([qr(l),e.c]),e.t){case"s":case"str":return i.bookSST?(a=jq(i.Strings,e.v,i.revStrings),l.t="s",l.v=a,o?tt(t,18,Z2t(e,l)):tt(t,7,Y2t(e,l))):(l.t="str",o?tt(t,17,ubt(e,l)):tt(t,6,lbt(e,l))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?o?tt(t,13,sbt(e,l)):tt(t,2,rbt(e,l)):o?tt(t,16,tbt(e,l)):tt(t,5,Q2t(e,l)),!0;case"b":return l.t="b",o?tt(t,15,U2t(e,l)):tt(t,4,z2t(e,l)),!0;case"e":return l.t="e",o?tt(t,14,q2t(e,l)):tt(t,3,W2t(e,l)),!0}return o?tt(t,12,F2t(e,l)):tt(t,1,j2t(e,l)),!0}function Nbt(t,e,n,r){var i=yi(e["!ref"]||"A1"),s,o="",a=[];tt(t,145);var l=Array.isArray(e),c=i.e.r;e["!rows"]&&(c=Math.max(i.e.r,e["!rows"].length-1));for(var u=i.s.r;u<=c;++u){o=Do(u),C2t(t,e,i,u);var h=!1;if(u<=i.e.r)for(var f=i.s.c;f<=i.e.c;++f){u===i.s.r&&(a[f]=_a(f)),s=a[f]+o;var g=l?(e[u]||[])[f]:e[s];if(!g){h=!1;continue}h=Mbt(t,g,u,f,r,e,h)}}tt(t,146)}function Obt(t,e){!e||!e["!merges"]||(tt(t,177,ybt(e["!merges"].length)),e["!merges"].forEach(function(n){tt(t,176,gbt(n))}),tt(t,178))}function Lbt(t,e){!e||!e["!cols"]||(tt(t,390),e["!cols"].forEach(function(n,r){n&&tt(t,60,Ebt(r,n))}),tt(t,391))}function Dbt(t,e){!e||!e["!ref"]||(tt(t,648),tt(t,649,Ibt(yi(e["!ref"]))),tt(t,650))}function jbt(t,e,n){e["!links"].forEach(function(r){if(r[1].Target){var i=zr(n,-1,r[1].Target.replace(/#.*$/,""),xr.HLINK);tt(t,494,_bt(r,i))}}),delete e["!links"]}function $bt(t,e,n,r){if(e["!comments"].length>0){var i=zr(r,-1,"../drawings/vmlDrawing"+(n+1)+".vml",xr.VML);tt(t,551,Rq("rId"+i)),e["!legacy"]=i}}function Fbt(t,e,n,r){if(e["!autofilter"]){var i=e["!autofilter"],s=typeof i.ref=="string"?i.ref:Ms(i.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var o=n.Workbook.Names,a=Ec(s);a.s.r==a.e.r&&(a.e.r=Ec(e["!ref"]).e.r,s=Ms(a));for(var l=0;l<o.length;++l){var c=o[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==r){c.Ref="'"+n.SheetNames[r]+"'!"+s;break}}l==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+s}),tt(t,161,Cb(yi(s))),tt(t,162)}}function Vbt(t,e,n){tt(t,133),tt(t,137,Abt(e,n)),tt(t,138),tt(t,134)}function zbt(t,e){e["!protect"]&&tt(t,535,Pbt(e["!protect"]))}function Gbt(t,e,n,r){var i=Tl(),s=n.SheetNames[t],o=n.Sheets[s]||{},a=s;try{n&&n.Workbook&&(a=n.Workbook.Sheets[t].CodeName||a)}catch{}var l=yi(o["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(e.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],tt(i,129),(n.vbaraw||o["!outline"])&&tt(i,147,L2t(a,o["!outline"])),tt(i,148,M2t(l)),Vbt(i,o,n.Workbook),Lbt(i,o),Nbt(i,o,t,e),zbt(i,o),Fbt(i,o,n,t),Obt(i,o),jbt(i,o,r),o["!margins"]&&tt(i,476,Tbt(o["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&Dbt(i,o),$bt(i,o,t,r),tt(i,130),i.end()}function Ubt(t,e){t.l+=10;var n=xa(t);return{name:n}}var Bbt=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function Wbt(t){return!t.Workbook||!t.Workbook.WBProps?"false":bvt(t.Workbook.WBProps.date1904)?"true":"false"}var Hbt="][*?/\\".split("");function qEe(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var n=!0;return Hbt.forEach(function(r){if(t.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),n}function qbt(t,e,n){t.forEach(function(r,i){qEe(r);for(var s=0;s<i;++s)if(r==t[s])throw new Error("Duplicate Sheet Name: "+r);if(n){var o=e&&e[i]&&e[i].CodeName||r;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function Kbt(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];qbt(t.SheetNames,e,!!t.vbaraw);for(var n=0;n<t.SheetNames.length;++n)g2t(t.Sheets[t.SheetNames[n]],t.SheetNames[n],n)}function KEe(t){var e=[Os];e[e.length]=yt("workbook",null,{xmlns:Ib[0],"xmlns:r":uo.r});var n=t.Workbook&&(t.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(Bbt.forEach(function(a){t.Workbook.WBProps[a[0]]!=null&&t.Workbook.WBProps[a[0]]!=a[1]&&(r[a[0]]=t.Workbook.WBProps[a[0]])}),t.Workbook.WBProps.CodeName&&(r.codeName=t.Workbook.WBProps.CodeName,delete r.CodeName)),e[e.length]=yt("workbookPr",null,r);var i=t.Workbook&&t.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=t.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==t.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=t.SheetNames.length;++s){var o={name:Wr(t.SheetNames[s].slice(0,31))};if(o.sheetId=""+(s+1),o["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}e[e.length]=yt("sheet",null,o)}return e[e.length]="</sheets>",n&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(a){var l={name:a.Name};a.Comment&&(l.comment=a.Comment),a.Sheet!=null&&(l.localSheetId=""+a.Sheet),a.Hidden&&(l.hidden="1"),a.Ref&&(e[e.length]=yt("definedName",Wr(a.Ref),l))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function Ybt(t,e){var n={};return n.Hidden=t.read_shift(4),n.iTabID=t.read_shift(4),n.strRelID=Fz(t),n.name=xa(t),n}function Xbt(t,e){return e||(e=Ue(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),Rq(t.strRelID,e),po(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function Zbt(t,e){var n={},r=t.read_shift(4);n.defaultThemeVersion=t.read_shift(4);var i=e>8?xa(t):"";return i.length>0&&(n.CodeName=i),n.autoCompressPictures=!!(r&65536),n.backupFile=!!(r&64),n.checkCompatibility=!!(r&4096),n.date1904=!!(r&1),n.filterPrivacy=!!(r&8),n.hidePivotFieldList=!!(r&1024),n.promptedSolutions=!!(r&16),n.publishItems=!!(r&2048),n.refreshAllConnections=!!(r&262144),n.saveExternalLinkValues=!!(r&128),n.showBorderUnselectedTables=!!(r&4),n.showInkAnnotation=!!(r&32),n.showObjects=["all","placeholders","none"][r>>13&3],n.showPivotChartFilter=!!(r&32768),n.updateLinks=["userSet","never","always"][r>>8&3],n}function Jbt(t,e){e||(e=Ue(72));var n=0;return t&&t.filterPrivacy&&(n|=8),e.write_shift(4,n),e.write_shift(4,0),oEe(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function Qbt(t,e,n){var r=t.l+e;t.l+=4,t.l+=1;var i=t.read_shift(4),s=Wvt(t),o=u2t(t,0,n),a=Cq(t);t.l=r;var l={Name:s,Ptg:o};return i<268435455&&(l.Sheet=i),a&&(l.Comment=a),l}function eEt(t,e){tt(t,143);for(var n=0;n!=e.SheetNames.length;++n){var r=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[n]&&e.Workbook.Sheets[n].Hidden||0,i={Hidden:r,iTabID:n+1,strRelID:"rId"+(n+1),name:e.SheetNames[n]};tt(t,156,Xbt(i))}tt(t,144)}function tEt(t,e){e||(e=Ue(127));for(var n=0;n!=4;++n)e.write_shift(4,0);return po("SheetJS",e),po(t5.version,e),po(t5.version,e),po("7262",e),e.length>e.l?e.slice(0,e.l):e}function nEt(t,e){e||(e=Ue(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var n=120;return e.write_shift(1,n),e.length>e.l?e.slice(0,e.l):e}function rEt(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var n=e.Workbook.Sheets,r=0,i=-1,s=-1;r<n.length;++r)!n[r]||!n[r].Hidden&&i==-1?i=r:n[r].Hidden==1&&s==-1&&(s=r);s>i||(tt(t,135),tt(t,158,nEt(i)),tt(t,136))}}function iEt(t,e){var n=Tl();return tt(n,131),tt(n,128,tEt()),tt(n,153,Jbt(t.Workbook&&t.Workbook.WBProps||null)),rEt(n,t),eEt(n,t),tt(n,132),n.end()}function sEt(t,e,n){return(e.slice(-4)===".bin"?iEt:KEe)(t)}function oEt(t,e,n,r,i){return(e.slice(-4)===".bin"?Gbt:WEe)(t,n,r,i)}function aEt(t,e,n){return(e.slice(-4)===".bin"?Txt:CEe)(t,n)}function lEt(t,e,n){return(e.slice(-4)===".bin"?J_t:kEe)(t,n)}function cEt(t,e,n){return(e.slice(-4)===".bin"?zxt:LEe)(t)}function uEt(t){return(t.slice(-4)===".bin"?Nxt:NEe)()}function hEt(t,e){var n=[];return t.Props&&n.push(a_t(t.Props,e)),t.Custprops&&n.push(l_t(t.Props,t.Custprops)),n.join("")}function dEt(){return""}function fEt(t,e){var n=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(r,i){var s=[];s.push(yt("NumberFormat",null,{"ss:Format":Wr(rs[r.numFmtId])}));var o={"ss:ID":"s"+(21+i)};n.push(yt("Style",s.join(""),o))}),yt("Styles",n.join(""))}function YEe(t){return yt("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+Lq(t.Ref,{r:0,c:0})})}function pEt(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,n=[],r=0;r<e.length;++r){var i=e[r];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||n.push(YEe(i)))}return yt("Names",n.join(""))}function mEt(t,e,n,r){if(!t||!((r||{}).Workbook||{}).Names)return"";for(var i=r.Workbook.Names,s=[],o=0;o<i.length;++o){var a=i[o];a.Sheet==n&&(a.Name.match(/^_xlfn\./)||s.push(YEe(a)))}return s.join("")}function gEt(t,e,n,r){if(!t)return"";var i=[];if(t["!margins"]&&(i.push("<PageSetup>"),t["!margins"].header&&i.push(yt("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&i.push(yt("Footer",null,{"x:Margin":t["!margins"].footer})),i.push(yt("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),i.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[n])if(r.Workbook.Sheets[n].Hidden)i.push(yt("Visible",r.Workbook.Sheets[n].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<n&&!(r.Workbook.Sheets[s]&&!r.Workbook.Sheets[s].Hidden);++s);s==n&&i.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),t["!protect"]&&(i.push(Lo("ProtectContents","True")),t["!protect"].objects&&i.push(Lo("ProtectObjects","True")),t["!protect"].scenarios&&i.push(Lo("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?i.push(Lo("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&i.push(Lo("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){t["!protect"][o[0]]&&i.push("<"+o[1]+"/>")})),i.length==0?"":yt("WorksheetOptions",i.join(""),{xmlns:oc.x})}function yEt(t){return t.map(function(e){var n=wvt(e.t||""),r=yt("ss:Data",n,{xmlns:"http://www.w3.org/TR/REC-html40"});return yt("Comment",r,{"ss:Author":e.a})}).join("")}function vEt(t,e,n,r,i,s,o){if(!t||t.v==null&&t.f==null)return"";var a={};if(t.f&&(a["ss:Formula"]="="+Wr(Lq(t.f,o))),t.F&&t.F.slice(0,e.length)==e){var l=fo(t.F.slice(e.length+1));a["ss:ArrayRange"]="RC:R"+(l.r==o.r?"":"["+(l.r-o.r)+"]")+"C"+(l.c==o.c?"":"["+(l.c-o.c)+"]")}if(t.l&&t.l.Target&&(a["ss:HRef"]=Wr(t.l.Target),t.l.Tooltip&&(a["x:HRefScreenTip"]=Wr(t.l.Tooltip))),n["!merges"])for(var c=n["!merges"],u=0;u!=c.length;++u)c[u].s.c!=o.c||c[u].s.r!=o.r||(c[u].e.c>c[u].s.c&&(a["ss:MergeAcross"]=c[u].e.c-c[u].s.c),c[u].e.r>c[u].s.r&&(a["ss:MergeDown"]=c[u].e.r-c[u].s.r));var h="",f="";switch(t.t){case"z":if(!r.sheetStubs)return"";break;case"n":h="Number",f=String(t.v);break;case"b":h="Boolean",f=t.v?"1":"0";break;case"e":h="Error",f=tP[t.v];break;case"d":h="DateTime",f=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||rs[14]);break;case"s":h="String",f=xvt(t.v||"");break}var g=d0(r.cellXfs,t,r);a["ss:StyleID"]="s"+(21+g),a["ss:Index"]=o.c+1;var y=t.v!=null?f:"",_=t.t=="z"?"":'<Data ss:Type="'+h+'">'+y+"</Data>";return(t.c||[]).length>0&&(_+=yEt(t.c)),yt("Cell",_,a)}function _Et(t,e){var n='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=PEe(e.hpt)),e.hpx&&(n+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(n+=' ss:Hidden="1"')),n+">"}function xEt(t,e,n,r){if(!t["!ref"])return"";var i=yi(t["!ref"]),s=t["!merges"]||[],o=0,a=[];t["!cols"]&&t["!cols"].forEach(function(b,T){Nq(b);var A=!!b.width,I=FL(T,b),P={"ss:Index":T+1};A&&(P["ss:Width"]=h5(I.width)),b.hidden&&(P["ss:Hidden"]="1"),a.push(yt("Column",null,P))});for(var l=Array.isArray(t),c=i.s.r;c<=i.e.r;++c){for(var u=[_Et(c,(t["!rows"]||[])[c])],h=i.s.c;h<=i.e.c;++h){var f=!1;for(o=0;o!=s.length;++o)if(!(s[o].s.c>h)&&!(s[o].s.r>c)&&!(s[o].e.c<h)&&!(s[o].e.r<c)){(s[o].s.c!=h||s[o].s.r!=c)&&(f=!0);break}if(!f){var g={r:c,c:h},y=qr(g),_=l?(t[c]||[])[h]:t[y];u.push(vEt(_,y,t,e,n,r,g))}}u.push("</Row>"),u.length>2&&a.push(u.join(""))}return a.join("")}function wEt(t,e,n){var r=[],i=n.SheetNames[t],s=n.Sheets[i],o=s?mEt(s,e,t,n):"";return o.length>0&&r.push("<Names>"+o+"</Names>"),o=s?xEt(s,e,t,n):"",o.length>0&&r.push("<Table>"+o+"</Table>"),r.push(gEt(s,e,t,n)),r.join("")}function bEt(t,e){e||(e={}),t.SSF||(t.SSF=Rl(rs)),t.SSF&&(OL(),NL(t.SSF),e.revssf=LL(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],d0(e.cellXfs,{},{revssf:{General:0}}));var n=[];n.push(hEt(t,e)),n.push(dEt()),n.push(""),n.push("");for(var r=0;r<t.SheetNames.length;++r)n.push(yt("Worksheet",wEt(r,e,t),{"ss:Name":Wr(t.SheetNames[r])}));return n[2]=fEt(t,e),n[3]=pEt(t),Os+yt("Workbook",n.join(""),{xmlns:oc.ss,"xmlns:o":oc.o,"xmlns:x":oc.x,"xmlns:ss":oc.ss,"xmlns:dt":oc.dt,"xmlns:html":oc.html})}var aF={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function EEt(t,e){var n=[],r=[],i=[],s=0,o,a=Doe(Yoe,"n"),l=Doe(Xoe,"n");if(t.Props)for(o=jo(t.Props),s=0;s<o.length;++s)(Object.prototype.hasOwnProperty.call(a,o[s])?n:Object.prototype.hasOwnProperty.call(l,o[s])?r:i).push([o[s],t.Props[o[s]]]);if(t.Custprops)for(o=jo(t.Custprops),s=0;s<o.length;++s)Object.prototype.hasOwnProperty.call(t.Props||{},o[s])||(Object.prototype.hasOwnProperty.call(a,o[s])?n:Object.prototype.hasOwnProperty.call(l,o[s])?r:i).push([o[s],t.Custprops[o[s]]]);var c=[];for(s=0;s<i.length;++s)_Ee.indexOf(i[s][0])>-1||gEe.indexOf(i[s][0])>-1||i[s][1]!=null&&c.push(i[s]);r.length&&Xr.utils.cfb_add(e,"/SummaryInformation",tae(r,aF.SI,l,Xoe)),(n.length||c.length)&&Xr.utils.cfb_add(e,"/DocumentSummaryInformation",tae(n,aF.DSI,a,Yoe,c.length?c:null,aF.UDI))}function SEt(t,e){var n=e||{},r=Xr.utils.cfb_new({root:"R"}),i="/Workbook";switch(n.bookType||"xls"){case"xls":n.bookType="biff8";case"xla":n.bookType||(n.bookType="xla");case"biff8":i="/Workbook",n.biff=8;break;case"biff5":i="/Book",n.biff=5;break;default:throw new Error("invalid type "+n.bookType+" for XLS CFB")}return Xr.utils.cfb_add(r,i,XEe(t,n)),n.biff==8&&(t.Props||t.Custprops)&&EEt(t,r),n.biff==8&&t.vbaraw&&Gxt(r,Xr.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),r}var TEt={0:{f:I2t},1:{f:D2t},2:{f:nbt},3:{f:B2t},4:{f:V2t},5:{f:J2t},6:{f:abt},7:{f:K2t},8:{f:pbt},9:{f:fbt},10:{f:hbt},11:{f:dbt},12:{f:$2t},13:{f:ibt},14:{f:H2t},15:{f:G2t},16:{f:ebt},17:{f:cbt},18:{f:X2t},19:{f:Pq},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Qbt},40:{},42:{},43:{f:axt},44:{f:sxt},45:{f:uxt},46:{f:dxt},47:{f:hxt},48:{},49:{f:$vt},50:{},51:{f:Ixt},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:F_t},62:{f:obt},63:{f:Oxt},64:{f:Cbt},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Vd,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:kbt},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:O2t},148:{f:R2t,p:16},151:{f:xbt},152:{},153:{f:Zbt},154:{},155:{},156:{f:Ybt},157:{},158:{},159:{T:1,f:Y_t},160:{T:-1},161:{T:1,f:Tv},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:mbt},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:kxt},336:{T:-1},337:{f:Rxt,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Fz},357:{},358:{},359:{},360:{T:1},361:{},362:{f:N_t},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:wbt},427:{f:bbt},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Sbt},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:N2t},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:vbt},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Fz},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Fxt},633:{T:1},634:{T:-1},635:{T:1,f:jxt},636:{T:-1},637:{f:Gvt},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Ubt},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Rbt},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function vt(t,e,n,r){var i=e;if(!isNaN(i)){var s=r||(n||[]).length||0,o=t.next(4);o.write_shift(2,i),o.write_shift(2,s),s>0&&kq(n)&&t.push(n)}}function kEt(t,e,n,r){var i=(n||[]).length||0;if(i<=8224)return vt(t,e,n,i);var s=e;if(!isNaN(s)){for(var o=n.parts||[],a=0,l=0,c=0;c+(o[a]||8224)<=8224;)c+=o[a]||8224,a++;var u=t.next(4);for(u.write_shift(2,s),u.write_shift(2,c),t.push(n.slice(l,l+c)),l+=c;l<i;){for(u=t.next(4),u.write_shift(2,60),c=0;c+(o[a]||8224)<=8224;)c+=o[a]||8224,a++;u.write_shift(2,c),t.push(n.slice(l,l+c)),l+=c}}}function rP(t,e,n){return t||(t=Ue(7)),t.write_shift(2,e),t.write_shift(2,n),t.write_shift(2,0),t.write_shift(1,0),t}function AEt(t,e,n,r){var i=Ue(9);return rP(i,t,e),wEe(n,r||"b",i),i}function IEt(t,e,n){var r=Ue(8+2*n.length);return rP(r,t,e),r.write_shift(1,n.length),r.write_shift(n.length,n,"sbcs"),r.l<r.length?r.slice(0,r.l):r}function PEt(t,e,n,r){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?Cl(Ga(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?vt(t,2,U_t(n,r,i)):vt(t,3,G_t(n,r,i));return;case"b":case"e":vt(t,5,AEt(n,r,e.v,e.t));return;case"s":case"str":vt(t,4,IEt(n,r,(e.v||"").slice(0,255)));return}vt(t,1,rP(null,n,r))}function CEt(t,e,n,r){var i=Array.isArray(e),s=yi(e["!ref"]||"A1"),o,a="",l=[];if(s.e.c>255||s.e.r>16383){if(r.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),o=Ms(s)}for(var c=s.s.r;c<=s.e.r;++c){a=Do(c);for(var u=s.s.c;u<=s.e.c;++u){c===s.s.r&&(l[u]=_a(u)),o=l[u]+a;var h=i?(e[c]||[])[u]:e[o];h&&PEt(t,h,c,u)}}}function REt(t,e){for(var n=e||{},r=Tl(),i=0,s=0;s<t.SheetNames.length;++s)t.SheetNames[s]==n.sheet&&(i=s);if(i==0&&n.sheet&&t.SheetNames[0]!=n.sheet)throw new Error("Sheet not found: "+n.sheet);return vt(r,n.biff==4?1033:n.biff==3?521:9,Mq(t,16,n)),CEt(r,t.Sheets[t.SheetNames[i]],i,n),vt(r,10),r.end()}function MEt(t,e,n){vt(t,49,T_t({sz:12,name:"Arial"},n))}function NEt(t,e,n){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)e[i]!=null&&vt(t,1054,I_t(i,e[i],n))})}function OEt(t,e){var n=Ue(19);n.write_shift(4,2151),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,1),n.write_shift(4,0),vt(t,2151,n),n=Ue(39),n.write_shift(4,2152),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,0),n.write_shift(4,0),n.write_shift(2,1),n.write_shift(4,4),n.write_shift(2,0),SEe(yi(e["!ref"]||"A1"),n),n.write_shift(4,4),vt(t,2152,n)}function LEt(t,e){for(var n=0;n<16;++n)vt(t,224,rae({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(r){vt(t,224,rae(r,0,e))})}function DEt(t,e){for(var n=0;n<e["!links"].length;++n){var r=e["!links"][n];vt(t,440,D_t(r)),r[1].Tooltip&&vt(t,2048,j_t(r))}delete e["!links"]}function jEt(t,e){if(e){var n=0;e.forEach(function(r,i){++n<=256&&r&&vt(t,125,V_t(FL(i,r),i))})}}function $Et(t,e,n,r,i){var s=16+d0(i.cellXfs,e,i);if(e.v==null&&!e.bf){vt(t,513,tv(n,r,s));return}if(e.bf)vt(t,6,l2t(e,n,r,i,s));else switch(e.t){case"d":case"n":var o=e.t=="d"?Cl(Ga(e.v)):e.v;vt(t,515,M_t(n,r,o,s));break;case"b":case"e":vt(t,517,R_t(n,r,e.v,s,i,e.t));break;case"s":case"str":if(i.bookSST){var a=jq(i.Strings,e.v,i.revStrings);vt(t,253,k_t(n,r,a,s))}else vt(t,516,A_t(n,r,(e.v||"").slice(0,255),s,i));break;default:vt(t,513,tv(n,r,s))}}function FEt(t,e,n){var r=Tl(),i=n.SheetNames[t],s=n.Sheets[i]||{},o=(n||{}).Workbook||{},a=(o.Sheets||[])[t]||{},l=Array.isArray(s),c=e.biff==8,u,h="",f=[],g=yi(s["!ref"]||"A1"),y=c?65536:16384;if(g.e.c>255||g.e.r>=y){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");g.e.c=Math.min(g.e.c,255),g.e.r=Math.min(g.e.c,y-1)}vt(r,2057,Mq(n,16,e)),vt(r,13,Yc(1)),vt(r,12,Yc(100)),vt(r,15,Ma(!0)),vt(r,17,Ma(!1)),vt(r,16,ev(.001)),vt(r,95,Ma(!0)),vt(r,42,Ma(!1)),vt(r,43,Ma(!1)),vt(r,130,Yc(1)),vt(r,128,C_t()),vt(r,131,Ma(!1)),vt(r,132,Ma(!1)),c&&jEt(r,s["!cols"]),vt(r,512,P_t(g,e)),c&&(s["!links"]=[]);for(var _=g.s.r;_<=g.e.r;++_){h=Do(_);for(var b=g.s.c;b<=g.e.c;++b){_===g.s.r&&(f[b]=_a(b)),u=f[b]+h;var T=l?(s[_]||[])[b]:s[u];T&&($Et(r,T,_,b,e),c&&T.l&&s["!links"].push([u,T.l]))}}var A=a.CodeName||a.name||i;return c&&vt(r,574,S_t((o.Views||[])[0])),c&&(s["!merges"]||[]).length&&vt(r,229,L_t(s["!merges"])),c&&DEt(r,s),vt(r,442,EEe(A)),c&&OEt(r,s),vt(r,10),r.end()}function VEt(t,e,n){var r=Tl(),i=(t||{}).Workbook||{},s=i.Sheets||[],o=i.WBProps||{},a=n.biff==8,l=n.biff==5;if(vt(r,2057,Mq(t,5,n)),n.bookType=="xla"&&vt(r,135),vt(r,225,a?Yc(1200):null),vt(r,193,h_t(2)),l&&vt(r,191),l&&vt(r,192),vt(r,226),vt(r,92,x_t("SheetJS",n)),vt(r,66,Yc(a?1200:1252)),a&&vt(r,353,Yc(0)),a&&vt(r,448),vt(r,317,z_t(t.SheetNames.length)),a&&t.vbaraw&&vt(r,211),a&&t.vbaraw){var c=o.CodeName||"ThisWorkbook";vt(r,442,EEe(c))}vt(r,156,Yc(17)),vt(r,25,Ma(!1)),vt(r,18,Ma(!1)),vt(r,19,Yc(0)),a&&vt(r,431,Ma(!1)),a&&vt(r,444,Yc(0)),vt(r,61,E_t()),vt(r,64,Ma(!1)),vt(r,141,Yc(0)),vt(r,34,Ma(Wbt(t)=="true")),vt(r,14,Ma(!0)),a&&vt(r,439,Ma(!1)),vt(r,218,Yc(0)),MEt(r,t,n),NEt(r,t.SSF,n),LEt(r,n),a&&vt(r,352,Ma(!1));var u=r.end(),h=Tl();a&&vt(h,140,$_t()),a&&n.Strings&&kEt(h,252,b_t(n.Strings)),vt(h,10);var f=h.end(),g=Tl(),y=0,_=0;for(_=0;_<t.SheetNames.length;++_)y+=(a?12:11)+(a?2:1)*t.SheetNames[_].length;var b=u.length+y+f.length;for(_=0;_<t.SheetNames.length;++_){var T=s[_]||{};vt(g,133,w_t({pos:b,hs:T.Hidden||0,dt:0,name:t.SheetNames[_]},n)),b+=e[_].length}var A=g.end();if(y!=A.length)throw new Error("BS8 "+y+" != "+A.length);var I=[];return u.length&&I.push(u),A.length&&I.push(A),f.length&&I.push(f),Oo(I)}function zEt(t,e){var n=e||{},r=[];t&&!t.SSF&&(t.SSF=Rl(rs)),t&&t.SSF&&(OL(),NL(t.SSF),n.revssf=LL(t.SSF),n.revssf[t.SSF[65535]]=0,n.ssf=t.SSF),n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,$q(n),n.cellXfs=[],d0(n.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var i=0;i<t.SheetNames.length;++i)r[r.length]=FEt(i,n,t);return r.unshift(VEt(t,r,n)),Oo(r)}function XEe(t,e){for(var n=0;n<=t.SheetNames.length;++n){var r=t.Sheets[t.SheetNames[n]];if(!(!r||!r["!ref"])){var i=Ec(r["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[n]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return zEt(t,e);case 4:case 3:case 2:return REt(t,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function GEt(t,e,n,r){for(var i=t["!merges"]||[],s=[],o=e.s.c;o<=e.e.c;++o){for(var a=0,l=0,c=0;c<i.length;++c)if(!(i[c].s.r>n||i[c].s.c>o)&&!(i[c].e.r<n||i[c].e.c<o)){if(i[c].s.r<n||i[c].s.c<o){a=-1;break}a=i[c].e.r-i[c].s.r+1,l=i[c].e.c-i[c].s.c+1;break}if(!(a<0)){var u=qr({r:n,c:o}),h=r.dense?(t[n]||[])[o]:t[u],f=h&&h.v!=null&&(h.h||_vt(h.w||(bp(h),h.w)||""))||"",g={};a>1&&(g.rowspan=a),l>1&&(g.colspan=l),r.editable?f='<span contenteditable="true">'+f+"</span>":h&&(g["data-t"]=h&&h.t||"z",h.v!=null&&(g["data-v"]=h.v),h.z!=null&&(g["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(f='<a href="'+h.l.Target+'">'+f+"</a>")),g.id=(r.id||"sjs")+"-"+u,s.push(yt("td",f,g))}}var y="<tr>";return y+s.join("")+"</tr>"}var UEt='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',BEt="</body></html>";function WEt(t,e,n){var r=[];return r.join("")+"<table"+(n&&n.id?' id="'+n.id+'"':"")+">"}function ZEe(t,e){var n=e||{},r=n.header!=null?n.header:UEt,i=n.footer!=null?n.footer:BEt,s=[r],o=Ec(t["!ref"]);n.dense=Array.isArray(t),s.push(WEt(t,o,n));for(var a=o.s.r;a<=o.e.r;++a)s.push(GEt(t,o,a,n));return s.push("</table>"+i),s.join("")}function JEe(t,e,n){var r=n||{},i=0,s=0;if(r.origin!=null)if(typeof r.origin=="number")i=r.origin;else{var o=typeof r.origin=="string"?fo(r.origin):r.origin;i=o.r,s=o.c}var a=e.getElementsByTagName("tr"),l=Math.min(r.sheetRows||1e7,a.length),c={s:{r:0,c:0},e:{r:i,c:s}};if(t["!ref"]){var u=Ec(t["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),i==-1&&(c.e.r=i=u.e.r+1)}var h=[],f=0,g=t["!rows"]||(t["!rows"]=[]),y=0,_=0,b=0,T=0,A=0,I=0;for(t["!cols"]||(t["!cols"]=[]);y<a.length&&_<l;++y){var P=a[y];if(uae(P)){if(r.display)continue;g[_]={hidden:!0}}var R=P.children;for(b=T=0;b<R.length;++b){var D=R[b];if(!(r.display&&uae(D))){var C=D.hasAttribute("data-v")?D.getAttribute("data-v"):D.hasAttribute("v")?D.getAttribute("v"):Evt(D.innerHTML),M=D.getAttribute("data-z")||D.getAttribute("z");for(f=0;f<h.length;++f){var O=h[f];O.s.c==T+s&&O.s.r<_+i&&_+i<=O.e.r&&(T=O.e.c+1-s,f=-1)}I=+D.getAttribute("colspan")||1,((A=+D.getAttribute("rowspan")||1)>1||I>1)&&h.push({s:{r:_+i,c:T+s},e:{r:_+i+(A||1)-1,c:T+s+(I||1)-1}});var j={t:"s",v:C},V=D.getAttribute("data-t")||D.getAttribute("t")||"";C!=null&&(C.length==0?j.t=V||"z":r.raw||C.trim().length==0||V=="s"||(C==="TRUE"?j={t:"b",v:!0}:C==="FALSE"?j={t:"b",v:!1}:isNaN(lp(C))?isNaN(AA(C).getDate())||(j={t:"d",v:Ga(C)},r.cellDates||(j={t:"n",v:Cl(j.v)}),j.z=r.dateNF||rs[14]):j={t:"n",v:lp(C)})),j.z===void 0&&M!=null&&(j.z=M);var U="",G=D.getElementsByTagName("A");if(G&&G.length)for(var de=0;de<G.length&&!(G[de].hasAttribute("href")&&(U=G[de].getAttribute("href"),U.charAt(0)!="#"));++de);U&&U.charAt(0)!="#"&&(j.l={Target:U}),r.dense?(t[_+i]||(t[_+i]=[]),t[_+i][T+s]=j):t[qr({c:T+s,r:_+i})]=j,c.e.c<T+s&&(c.e.c=T+s),T+=I}}++_}return h.length&&(t["!merges"]=(t["!merges"]||[]).concat(h)),c.e.r=Math.max(c.e.r,_-1+i),t["!ref"]=Ms(c),_>=l&&(t["!fullref"]=Ms((c.e.r=a.length-y+_-1+i,c))),t}function QEe(t,e){var n=e||{},r=n.dense?[]:{};return JEe(r,t,e)}function HEt(t,e){return wv(QEe(t,e),e)}function uae(t){var e="",n=qEt(t);return n&&(e=n(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function qEt(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var KEt=(function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+PA({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return Os+e}})(),hae=(function(){var t=function(s){return Wr(s).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,n=`          <table:covered-table-cell/>
`,r=function(s,o,a){var l=[];l.push('      <table:table table:name="'+Wr(o.SheetNames[a])+`" table:style-name="ta1">
`);var c=0,u=0,h=Ec(s["!ref"]||"A1"),f=s["!merges"]||[],g=0,y=Array.isArray(s);if(s["!cols"])for(u=0;u<=h.e.c;++u)l.push("        <table:table-column"+(s["!cols"][u]?' table:style-name="co'+s["!cols"][u].ods+'"':"")+`></table:table-column>
`);var _="",b=s["!rows"]||[];for(c=0;c<h.s.r;++c)_=b[c]?' table:style-name="ro'+b[c].ods+'"':"",l.push("        <table:table-row"+_+`></table:table-row>
`);for(;c<=h.e.r;++c){for(_=b[c]?' table:style-name="ro'+b[c].ods+'"':"",l.push("        <table:table-row"+_+`>
`),u=0;u<h.s.c;++u)l.push(e);for(;u<=h.e.c;++u){var T=!1,A={},I="";for(g=0;g!=f.length;++g)if(!(f[g].s.c>u)&&!(f[g].s.r>c)&&!(f[g].e.c<u)&&!(f[g].e.r<c)){(f[g].s.c!=u||f[g].s.r!=c)&&(T=!0),A["table:number-columns-spanned"]=f[g].e.c-f[g].s.c+1,A["table:number-rows-spanned"]=f[g].e.r-f[g].s.r+1;break}if(T){l.push(n);continue}var P=qr({r:c,c:u}),R=y?(s[c]||[])[u]:s[P];if(R&&R.f&&(A["table:formula"]=Wr(p2t(R.f)),R.F&&R.F.slice(0,P.length)==P)){var D=Ec(R.F);A["table:number-matrix-columns-spanned"]=D.e.c-D.s.c+1,A["table:number-matrix-rows-spanned"]=D.e.r-D.s.r+1}if(!R){l.push(e);continue}switch(R.t){case"b":I=R.v?"TRUE":"FALSE",A["office:value-type"]="boolean",A["office:boolean-value"]=R.v?"true":"false";break;case"n":I=R.w||String(R.v||0),A["office:value-type"]="float",A["office:value"]=R.v||0;break;case"s":case"str":I=R.v==null?"":R.v,A["office:value-type"]="string";break;case"d":I=R.w||Ga(R.v).toISOString(),A["office:value-type"]="date",A["office:date-value"]=Ga(R.v).toISOString(),A["table:style-name"]="ce1";break;default:l.push(e);continue}var C=t(I);if(R.l&&R.l.Target){var M=R.l.Target;M=M.charAt(0)=="#"?"#"+m2t(M.slice(1)):M,M.charAt(0)!="#"&&!M.match(/^\w+:/)&&(M="../"+M),C=yt("text:a",C,{"xlink:href":M.replace(/&/g,"&amp;")})}l.push("          "+yt("table:table-cell",yt("text:p",C,{}),A)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(s,o){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var a=0;o.SheetNames.map(function(c){return o.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var u=0;u<c["!cols"].length;++u)if(c["!cols"][u]){var h=c["!cols"][u];if(h.width==null&&h.wpx==null&&h.wch==null)continue;Nq(h),h.ods=a;var f=c["!cols"][u].wpx+"px";s.push('  <style:style style:name="co'+a+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+f+`"/>
`),s.push(`  </style:style>
`),++a}}});var l=0;o.SheetNames.map(function(c){return o.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var u=0;u<c["!rows"].length;++u)if(c["!rows"][u]){c["!rows"][u].ods=l;var h=c["!rows"][u].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(o,a){var l=[Os],c=PA({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=PA({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});a.bookType=="fods"?(l.push("<office:document"+c+u+`>
`),l.push(pEe().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+c+`>
`),i(l,o),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var h=0;h!=o.SheetNames.length;++h)l.push(r(o.Sheets[o.SheetNames[h]],o,h));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),a.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}})();function eSe(t,e){if(e.bookType=="fods")return hae(t,e);var n=bq(),r="",i=[],s=[];return r="mimetype",Un(n,r,"application/vnd.oasis.opendocument.spreadsheet"),r="content.xml",Un(n,r,hae(t,e)),i.push([r,"text/xml"]),s.push([r,"ContentFile"]),r="styles.xml",Un(n,r,KEt(t,e)),i.push([r,"text/xml"]),s.push([r,"StylesFile"]),r="meta.xml",Un(n,r,Os+pEe()),i.push([r,"text/xml"]),s.push([r,"MetadataFile"]),r="manifest.rdf",Un(n,r,o_t(s)),i.push([r,"application/rdf+xml"]),r="META-INF/manifest.xml",Un(n,r,i_t(i)),n}function p5(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function YEt(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):rh(IA(t))}function XEt(t,e){e:for(var n=0;n<=t.length-e.length;++n){for(var r=0;r<e.length;++r)if(t[n+r]!=e[r])continue e;return!0}return!1}function e0(t){var e=t.reduce(function(i,s){return i+s.length},0),n=new Uint8Array(e),r=0;return t.forEach(function(i){n.set(i,r),r+=i.length}),n}function ZEt(t,e,n){var r=Math.floor(n==0?0:Math.LOG10E*Math.log(Math.abs(n)))+6176-20,i=n/Math.pow(10,r-6176);t[e+15]|=r>>7,t[e+14]|=(r&127)<<1;for(var s=0;i>=1;++s,i/=256)t[e+s]=i&255;t[e+15]|=n>=0?0:128}function CA(t,e){var n=e?e[0]:0,r=t[n]&127;e:if(t[n++]>=128&&(r|=(t[n]&127)<<7,t[n++]<128||(r|=(t[n]&127)<<14,t[n++]<128)||(r|=(t[n]&127)<<21,t[n++]<128)||(r+=(t[n]&127)*Math.pow(2,28),++n,t[n++]<128)||(r+=(t[n]&127)*Math.pow(2,35),++n,t[n++]<128)||(r+=(t[n]&127)*Math.pow(2,42),++n,t[n++]<128)))break e;return e&&(e[0]=n),r}function Vr(t){var e=new Uint8Array(7);e[0]=t&127;var n=1;e:if(t>127){if(e[n-1]|=128,e[n]=t>>7&127,++n,t<=16383||(e[n-1]|=128,e[n]=t>>14&127,++n,t<=2097151)||(e[n-1]|=128,e[n]=t>>21&127,++n,t<=268435455)||(e[n-1]|=128,e[n]=t/256>>>21&127,++n,t<=34359738367)||(e[n-1]|=128,e[n]=t/65536>>>21&127,++n,t<=4398046511103))break e;e[n-1]|=128,e[n]=t/16777216>>>21&127,++n}return e.slice(0,n)}function kw(t){var e=0,n=t[e]&127;e:if(t[e++]>=128){if(n|=(t[e]&127)<<7,t[e++]<128||(n|=(t[e]&127)<<14,t[e++]<128)||(n|=(t[e]&127)<<21,t[e++]<128))break e;n|=(t[e]&127)<<28}return n}function Vs(t){for(var e=[],n=[0];n[0]<t.length;){var r=n[0],i=CA(t,n),s=i&7;i=Math.floor(i/8);var o=0,a;if(i==0)break;switch(s){case 0:{for(var l=n[0];t[n[0]++]>=128;);a=t.slice(l,n[0])}break;case 5:o=4,a=t.slice(n[0],n[0]+o),n[0]+=o;break;case 1:o=8,a=t.slice(n[0],n[0]+o),n[0]+=o;break;case 2:o=CA(t,n),a=t.slice(n[0],n[0]+o),n[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(r))}var c={data:a,type:s};e[i]==null?e[i]=[c]:e[i].push(c)}return e}function To(t){var e=[];return t.forEach(function(n,r){n.forEach(function(i){i.data&&(e.push(Vr(r*8+i.type)),i.type==2&&e.push(Vr(i.data.length)),e.push(i.data))})}),e0(e)}function zu(t){for(var e,n=[],r=[0];r[0]<t.length;){var i=CA(t,r),s=Vs(t.slice(r[0],r[0]+i));r[0]+=i;var o={id:kw(s[1][0].data),messages:[]};s[2].forEach(function(a){var l=Vs(a.data),c=kw(l[3][0].data);o.messages.push({meta:l,data:t.slice(r[0],r[0]+c)}),r[0]+=c}),(e=s[3])!=null&&e[0]&&(o.merge=kw(s[3][0].data)>>>0>0),n.push(o)}return n}function L_(t){var e=[];return t.forEach(function(n){var r=[];r[1]=[{data:Vr(n.id),type:0}],r[2]=[],n.merge!=null&&(r[3]=[{data:Vr(+!!n.merge),type:0}]);var i=[];n.messages.forEach(function(o){i.push(o.data),o.meta[3]=[{type:0,data:Vr(o.data.length)}],r[2].push({data:To(o.meta),type:2})});var s=To(r);e.push(Vr(s.length)),e.push(s),i.forEach(function(o){return e.push(o)})}),e0(e)}function JEt(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var n=[0],r=CA(e,n),i=[];n[0]<e.length;){var s=e[n[0]]&3;if(s==0){var o=e[n[0]++]>>2;if(o<60)++o;else{var a=o-59;o=e[n[0]],a>1&&(o|=e[n[0]+1]<<8),a>2&&(o|=e[n[0]+2]<<16),a>3&&(o|=e[n[0]+3]<<24),o>>>=0,o++,n[0]+=a}i.push(e.slice(n[0],n[0]+o)),n[0]+=o;continue}else{var l=0,c=0;if(s==1?(c=(e[n[0]]>>2&7)+4,l=(e[n[0]++]&224)<<3,l|=e[n[0]++]):(c=(e[n[0]++]>>2)+1,s==2?(l=e[n[0]]|e[n[0]+1]<<8,n[0]+=2):(l=(e[n[0]]|e[n[0]+1]<<8|e[n[0]+2]<<16|e[n[0]+3]<<24)>>>0,n[0]+=4)),i=[e0(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(i.push(i[0].slice(-l)),c-=l;c>=i[i.length-1].length;)i.push(i[i.length-1]),c-=i[i.length-1].length;i.push(i[0].slice(-l,-l+c))}}var u=e0(i);if(u.length!=r)throw new Error("Unexpected length: ".concat(u.length," != ").concat(r));return u}function Gu(t){for(var e=[],n=0;n<t.length;){var r=t[n++],i=t[n]|t[n+1]<<8|t[n+2]<<16;n+=3,e.push(JEt(r,t.slice(n,n+i))),n+=i}if(n!==t.length)throw new Error("data is not a valid framed stream!");return e0(e)}function D_(t){for(var e=[],n=0;n<t.length;){var r=Math.min(t.length-n,268435455),i=new Uint8Array(4);e.push(i);var s=Vr(r),o=s.length;e.push(s),r<=60?(o++,e.push(new Uint8Array([r-1<<2]))):r<=256?(o+=2,e.push(new Uint8Array([240,r-1&255]))):r<=65536?(o+=3,e.push(new Uint8Array([244,r-1&255,r-1>>8&255]))):r<=16777216?(o+=4,e.push(new Uint8Array([248,r-1&255,r-1>>8&255,r-1>>16&255]))):r<=4294967296&&(o+=5,e.push(new Uint8Array([252,r-1&255,r-1>>8&255,r-1>>16&255,r-1>>>24&255]))),e.push(t.slice(n,n+r)),o+=r,i[0]=0,i[1]=o&255,i[2]=o>>8&255,i[3]=o>>16&255,n+=r}return e0(e)}function lF(t,e){var n=new Uint8Array(32),r=p5(n),i=12,s=0;switch(n[0]=5,t.t){case"n":n[1]=2,ZEt(n,i,t.v),s|=1,i+=16;break;case"b":n[1]=6,r.setFloat64(i,t.v?1:0,!0),s|=2,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));n[1]=3,r.setUint32(i,e.indexOf(t.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+t.t}return r.setUint32(8,s,!0),n.slice(0,i)}function cF(t,e){var n=new Uint8Array(32),r=p5(n),i=12,s=0;switch(n[0]=3,t.t){case"n":n[2]=2,r.setFloat64(i,t.v,!0),s|=32,i+=8;break;case"b":n[2]=6,r.setFloat64(i,t.v?1:0,!0),s|=32,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));n[2]=3,r.setUint32(i,e.indexOf(t.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+t.t}return r.setUint32(4,s,!0),n.slice(0,i)}function ym(t){var e=Vs(t);return CA(e[1][0].data)}function QEt(t,e,n){var r,i,s,o;if(!((r=t[6])!=null&&r[0])||!((i=t[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var a=((o=(s=t[8])==null?void 0:s[0])==null?void 0:o.data)&&kw(t[8][0].data)>0||!1;if(a)throw"Math only works with normal offsets";for(var l=0,c=p5(t[7][0].data),u=0,h=[],f=p5(t[4][0].data),g=0,y=[],_=0;_<e.length;++_){if(e[_]==null){c.setUint16(_*2,65535,!0),f.setUint16(_*2,65535);continue}c.setUint16(_*2,u,!0),f.setUint16(_*2,g,!0);var b,T;switch(typeof e[_]){case"string":b=lF({t:"s",v:e[_]},n),T=cF({t:"s",v:e[_]},n);break;case"number":b=lF({t:"n",v:e[_]},n),T=cF({t:"n",v:e[_]},n);break;case"boolean":b=lF({t:"b",v:e[_]},n),T=cF({t:"b",v:e[_]},n);break;default:throw new Error("Unsupported value "+e[_])}h.push(b),u+=b.length,y.push(T),g+=T.length,++l}for(t[2][0].data=Vr(l);_<t[7][0].data.length/2;++_)c.setUint16(_*2,65535,!0),f.setUint16(_*2,65535,!0);return t[6][0].data=e0(h),t[3][0].data=e0(y),l}function eSt(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var n=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var r=Ec(n["!ref"]);r.s.r=r.s.c=0;var i=!1;r.e.c>9&&(i=!0,r.e.c=9),r.e.r>49&&(i=!0,r.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(Ms(r)));var s=m5(n,{range:r,header:1}),o=["~Sh33tJ5~"];s.forEach(function(ne){return ne.forEach(function(ie){typeof ie=="string"&&o.push(ie)})});var a={},l=[],c=Xr.read(e.numbers,{type:"base64"});c.FileIndex.map(function(ne,ie){return[ne,c.FullPaths[ie]]}).forEach(function(ne){var ie=ne[0],le=ne[1];if(ie.type==2&&ie.name.match(/\.iwa/)){var ve=ie.content,qe=Gu(ve),Ke=zu(qe);Ke.forEach(function(Se){l.push(Se.id),a[Se.id]={deps:[],location:le,type:kw(Se.messages[0].meta[1][0].data)}})}}),l.sort(function(ne,ie){return ne-ie});var u=l.filter(function(ne){return ne>1}).map(function(ne){return[ne,Vr(ne)]});c.FileIndex.map(function(ne,ie){return[ne,c.FullPaths[ie]]}).forEach(function(ne){var ie=ne[0];if(ne[1],!!ie.name.match(/\.iwa/)){var le=zu(Gu(ie.content));le.forEach(function(ve){ve.messages.forEach(function(qe){u.forEach(function(Ke){ve.messages.some(function(Se){return kw(Se.meta[1][0].data)!=11006&&XEt(Se.data,Ke[1])})&&a[Ke[0]].deps.push(ve.id)})})})}});for(var h=Xr.find(c,a[1].location),f=zu(Gu(h.content)),g,y=0;y<f.length;++y){var _=f[y];_.id==1&&(g=_)}var b=ym(Vs(g.messages[0].data)[1][0].data);for(h=Xr.find(c,a[b].location),f=zu(Gu(h.content)),y=0;y<f.length;++y)_=f[y],_.id==b&&(g=_);for(b=ym(Vs(g.messages[0].data)[2][0].data),h=Xr.find(c,a[b].location),f=zu(Gu(h.content)),y=0;y<f.length;++y)_=f[y],_.id==b&&(g=_);for(b=ym(Vs(g.messages[0].data)[2][0].data),h=Xr.find(c,a[b].location),f=zu(Gu(h.content)),y=0;y<f.length;++y)_=f[y],_.id==b&&(g=_);var T=Vs(g.messages[0].data);{T[6][0].data=Vr(r.e.r+1),T[7][0].data=Vr(r.e.c+1);var A=ym(T[46][0].data),I=Xr.find(c,a[A].location),P=zu(Gu(I.content));{for(var R=0;R<P.length&&P[R].id!=A;++R);if(P[R].id!=A)throw"Bad ColumnRowUIDMapArchive";var D=Vs(P[R].messages[0].data);D[1]=[],D[2]=[],D[3]=[];for(var C=0;C<=r.e.c;++C){var M=[];M[1]=M[2]=[{type:0,data:Vr(C+420690)}],D[1].push({type:2,data:To(M)}),D[2].push({type:0,data:Vr(C)}),D[3].push({type:0,data:Vr(C)})}D[4]=[],D[5]=[],D[6]=[];for(var O=0;O<=r.e.r;++O)M=[],M[1]=M[2]=[{type:0,data:Vr(O+726270)}],D[4].push({type:2,data:To(M)}),D[5].push({type:0,data:Vr(O)}),D[6].push({type:0,data:Vr(O)});P[R].messages[0].data=To(D)}I.content=D_(L_(P)),I.size=I.content.length,delete T[46];var j=Vs(T[4][0].data);{j[7][0].data=Vr(r.e.r+1);var V=Vs(j[1][0].data),U=ym(V[2][0].data);I=Xr.find(c,a[U].location),P=zu(Gu(I.content));{if(P[0].id!=U)throw"Bad HeaderStorageBucket";var G=Vs(P[0].messages[0].data);for(O=0;O<s.length;++O){var de=Vs(G[2][0].data);de[1][0].data=Vr(O),de[4][0].data=Vr(s[O].length),G[2][O]={type:G[2][0].type,data:To(de)}}P[0].messages[0].data=To(G)}I.content=D_(L_(P)),I.size=I.content.length;var Ie=ym(j[2][0].data);I=Xr.find(c,a[Ie].location),P=zu(Gu(I.content));{if(P[0].id!=Ie)throw"Bad HeaderStorageBucket";for(G=Vs(P[0].messages[0].data),C=0;C<=r.e.c;++C)de=Vs(G[2][0].data),de[1][0].data=Vr(C),de[4][0].data=Vr(r.e.r+1),G[2][C]={type:G[2][0].type,data:To(de)};P[0].messages[0].data=To(G)}I.content=D_(L_(P)),I.size=I.content.length;var ze=ym(j[4][0].data);(function(){for(var ne=Xr.find(c,a[ze].location),ie=zu(Gu(ne.content)),le,ve=0;ve<ie.length;++ve){var qe=ie[ve];qe.id==ze&&(le=qe)}var Ke=Vs(le.messages[0].data);{Ke[3]=[];var Se=[];o.forEach(function(Ye,on){Se[1]=[{type:0,data:Vr(on)}],Se[2]=[{type:0,data:Vr(1)}],Se[3]=[{type:2,data:YEt(Ye)}],Ke[3].push({type:2,data:To(Se)})})}le.messages[0].data=To(Ke);var we=L_(ie),Dt=D_(we);ne.content=Dt,ne.size=ne.content.length})();var Ne=Vs(j[3][0].data);{var fe=Ne[1][0];delete Ne[2];var De=Vs(fe.data);{var Ce=ym(De[2][0].data);(function(){for(var ne=Xr.find(c,a[Ce].location),ie=zu(Gu(ne.content)),le,ve=0;ve<ie.length;++ve){var qe=ie[ve];qe.id==Ce&&(le=qe)}var Ke=Vs(le.messages[0].data);{delete Ke[6],delete Ne[7];var Se=new Uint8Array(Ke[5][0].data);Ke[5]=[];for(var we=0,Dt=0;Dt<=r.e.r;++Dt){var Ye=Vs(Se);we+=QEt(Ye,s[Dt],o),Ye[1][0].data=Vr(Dt),Ke[5].push({data:To(Ye),type:2})}Ke[1]=[{type:0,data:Vr(r.e.c+1)}],Ke[2]=[{type:0,data:Vr(r.e.r+1)}],Ke[3]=[{type:0,data:Vr(we)}],Ke[4]=[{type:0,data:Vr(r.e.r+1)}]}le.messages[0].data=To(Ke);var on=L_(ie),jt=D_(on);ne.content=jt,ne.size=ne.content.length})()}fe.data=To(De)}j[3][0].data=To(Ne)}T[4][0].data=To(j)}g.messages[0].data=To(T);var Q=L_(f),W=D_(Q);return h.content=W,h.size=h.content.length,c}function tSt(t){return function(n){for(var r=0;r!=t.length;++r){var i=t[r];n[i[0]]===void 0&&(n[i[0]]=i[1]),i[2]==="n"&&(n[i[0]]=Number(n[i[0]]))}}}function $q(t){tSt([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function nSt(t,e){return e.bookType=="ods"?eSe(t,e):e.bookType=="numbers"?eSt(t,e):e.bookType=="xlsb"?rSt(t,e):iSt(t,e)}function rSt(t,e){Bx=1024,t&&!t.SSF&&(t.SSF=Rl(rs)),t&&t.SSF&&(OL(),NL(t.SSF),e.revssf=LL(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,ik?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var n=e.bookType=="xlsb"?"bin":"xml",r=DEe.indexOf(e.bookType)>-1,i=hEe();$q(e=e||{});var s=bq(),o="",a=0;if(e.cellXfs=[],d0(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",Un(s,o,mEe(t.Props,e)),i.coreprops.push(o),zr(e.rels,2,o,xr.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],c=0;c<t.SheetNames.length;++c)(t.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(t.SheetNames[c]);t.Props.SheetNames=l}for(t.Props.Worksheets=t.Props.SheetNames.length,Un(s,o,yEe(t.Props)),i.extprops.push(o),zr(e.rels,3,o,xr.EXT_PROPS),t.Custprops!==t.Props&&jo(t.Custprops||{}).length>0&&(o="docProps/custom.xml",Un(s,o,vEe(t.Custprops)),i.custprops.push(o),zr(e.rels,4,o,xr.CUST_PROPS)),a=1;a<=t.SheetNames.length;++a){var u={"!id":{}},h=t.Sheets[t.SheetNames[a-1]],f=(h||{})["!type"]||"sheet";switch(f){case"chart":default:o="xl/worksheets/sheet"+a+"."+n,Un(s,o,oEt(a-1,o,e,t,u)),i.sheets.push(o),zr(e.wbrels,-1,"worksheets/sheet"+a+"."+n,xr.WS[0])}if(h){var g=h["!comments"],y=!1,_="";g&&g.length>0&&(_="xl/comments"+a+"."+n,Un(s,_,cEt(g,_)),i.comments.push(_),zr(u,-1,"../comments"+a+"."+n,xr.CMNT),y=!0),h["!legacy"]&&y&&Un(s,"xl/drawings/vmlDrawing"+a+".vml",OEe(a,h["!comments"])),delete h["!comments"],delete h["!legacy"]}u["!id"].rId1&&Un(s,fEe(o),Sw(u))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+n,Un(s,o,lEt(e.Strings,o,e)),i.strs.push(o),zr(e.wbrels,-1,"sharedStrings."+n,xr.SST)),o="xl/workbook."+n,Un(s,o,sEt(t,o)),i.workbooks.push(o),zr(e.rels,1,o,xr.WB),o="xl/theme/theme1.xml",Un(s,o,MEe(t.Themes,e)),i.themes.push(o),zr(e.wbrels,-1,"theme/theme1.xml",xr.THEME),o="xl/styles."+n,Un(s,o,aEt(t,o,e)),i.styles.push(o),zr(e.wbrels,-1,"styles."+n,xr.STY),t.vbaraw&&r&&(o="xl/vbaProject.bin",Un(s,o,t.vbaraw),i.vba.push(o),zr(e.wbrels,-1,"vbaProject.bin",xr.VBA)),o="xl/metadata."+n,Un(s,o,uEt(o)),i.metadata.push(o),zr(e.wbrels,-1,"metadata."+n,xr.XLMETA),Un(s,"[Content_Types].xml",dEe(i,e)),Un(s,"_rels/.rels",Sw(e.rels)),Un(s,"xl/_rels/workbook."+n+".rels",Sw(e.wbrels)),delete e.revssf,delete e.ssf,s}function iSt(t,e){Bx=1024,t&&!t.SSF&&(t.SSF=Rl(rs)),t&&t.SSF&&(OL(),NL(t.SSF),e.revssf=LL(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,ik?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var n="xml",r=DEe.indexOf(e.bookType)>-1,i=hEe();$q(e=e||{});var s=bq(),o="",a=0;if(e.cellXfs=[],d0(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",Un(s,o,mEe(t.Props,e)),i.coreprops.push(o),zr(e.rels,2,o,xr.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],c=0;c<t.SheetNames.length;++c)(t.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(t.SheetNames[c]);t.Props.SheetNames=l}t.Props.Worksheets=t.Props.SheetNames.length,Un(s,o,yEe(t.Props)),i.extprops.push(o),zr(e.rels,3,o,xr.EXT_PROPS),t.Custprops!==t.Props&&jo(t.Custprops||{}).length>0&&(o="docProps/custom.xml",Un(s,o,vEe(t.Custprops)),i.custprops.push(o),zr(e.rels,4,o,xr.CUST_PROPS));var u=["SheetJ5"];for(e.tcid=0,a=1;a<=t.SheetNames.length;++a){var h={"!id":{}},f=t.Sheets[t.SheetNames[a-1]],g=(f||{})["!type"]||"sheet";switch(g){case"chart":default:o="xl/worksheets/sheet"+a+"."+n,Un(s,o,WEe(a-1,e,t,h)),i.sheets.push(o),zr(e.wbrels,-1,"worksheets/sheet"+a+"."+n,xr.WS[0])}if(f){var y=f["!comments"],_=!1,b="";if(y&&y.length>0){var T=!1;y.forEach(function(A){A[1].forEach(function(I){I.T==!0&&(T=!0)})}),T&&(b="xl/threadedComments/threadedComment"+a+"."+n,Un(s,b,Lxt(y,u,e)),i.threadedcomments.push(b),zr(h,-1,"../threadedComments/threadedComment"+a+"."+n,xr.TCMNT)),b="xl/comments"+a+"."+n,Un(s,b,LEe(y)),i.comments.push(b),zr(h,-1,"../comments"+a+"."+n,xr.CMNT),_=!0}f["!legacy"]&&_&&Un(s,"xl/drawings/vmlDrawing"+a+".vml",OEe(a,f["!comments"])),delete f["!comments"],delete f["!legacy"]}h["!id"].rId1&&Un(s,fEe(o),Sw(h))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+n,Un(s,o,kEe(e.Strings,e)),i.strs.push(o),zr(e.wbrels,-1,"sharedStrings."+n,xr.SST)),o="xl/workbook."+n,Un(s,o,KEe(t)),i.workbooks.push(o),zr(e.rels,1,o,xr.WB),o="xl/theme/theme1.xml",Un(s,o,MEe(t.Themes,e)),i.themes.push(o),zr(e.wbrels,-1,"theme/theme1.xml",xr.THEME),o="xl/styles."+n,Un(s,o,CEe(t,e)),i.styles.push(o),zr(e.wbrels,-1,"styles."+n,xr.STY),t.vbaraw&&r&&(o="xl/vbaProject.bin",Un(s,o,t.vbaraw),i.vba.push(o),zr(e.wbrels,-1,"vbaProject.bin",xr.VBA)),o="xl/metadata."+n,Un(s,o,NEe()),i.metadata.push(o),zr(e.wbrels,-1,"metadata."+n,xr.XLMETA),u.length>1&&(o="xl/persons/person.xml",Un(s,o,Dxt(u)),i.people.push(o),zr(e.wbrels,-1,"persons/person.xml",xr.PEOPLE)),Un(s,"[Content_Types].xml",dEe(i,e)),Un(s,"_rels/.rels",Sw(e.rels)),Un(s,"xl/_rels/workbook."+n+".rels",Sw(e.wbrels)),delete e.revssf,delete e.ssf,s}function sSt(t,e){var n="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":n=wp(t.slice(0,12));break;case"binary":n=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[n.charCodeAt(0),n.charCodeAt(1),n.charCodeAt(2),n.charCodeAt(3),n.charCodeAt(4),n.charCodeAt(5),n.charCodeAt(6),n.charCodeAt(7)]}function tSe(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return QI(e.file,Xr.write(t,{type:kr?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return Xr.write(t,e)}function oSt(t,e){var n=Rl(e||{}),r=nSt(t,n);return aSt(r,n)}function aSt(t,e){var n={},r=kr?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(n.compression="DEFLATE"),e.password)n.type=r;else switch(e.type){case"base64":n.type="base64";break;case"binary":n.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":n.type=r;break;default:throw new Error("Unrecognized type "+e.type)}var i=t.FullPaths?Xr.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[n.type]||n.type,compression:!!e.compression}):t.generate(n);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(ML(i))}return e.password&&typeof encrypt_agile<"u"?tSe(encrypt_agile(i,e.password),e):e.type==="file"?QI(e.file,i):e.type=="string"?ek(i):i}function lSt(t,e){var n=e||{},r=SEt(t,n);return tSe(r,n)}function rd(t,e,n){n||(n="");var r=n+t;switch(e.type){case"base64":return kA(IA(r));case"binary":return IA(r);case"string":return t;case"file":return QI(e.file,r,"utf8");case"buffer":return kr?Cp(r,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(r):rd(r,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function cSt(t,e){switch(e.type){case"base64":return kA(t);case"binary":return t;case"string":return t;case"file":return QI(e.file,t,"binary");case"buffer":return kr?Cp(t,"binary"):t.split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function LR(t,e){switch(e.type){case"string":case"base64":case"binary":for(var n="",r=0;r<t.length;++r)n+=String.fromCharCode(t[r]);return e.type=="base64"?kA(n):e.type=="string"?ek(n):n;case"file":return QI(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function nSe(t,e){j1t(),Kbt(t);var n=Rl(e||{});if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),n.type=="array"){n.type="binary";var r=nSe(t,n);return n.type="array",ML(r)}var i=0;if(n.sheet&&(typeof n.sheet=="number"?i=n.sheet:i=t.SheetNames.indexOf(n.sheet),!t.SheetNames[i]))throw new Error("Sheet not found: "+n.sheet+" : "+typeof n.sheet);switch(n.bookType||"xlsb"){case"xml":case"xlml":return rd(bEt(t,n),n);case"slk":case"sylk":return rd(W_t.from_sheet(t.Sheets[t.SheetNames[i]],n),n);case"htm":case"html":return rd(ZEe(t.Sheets[t.SheetNames[i]],n),n);case"txt":return cSt(rSe(t.Sheets[t.SheetNames[i]],n),n);case"csv":return rd(Fq(t.Sheets[t.SheetNames[i]],n),n,"\uFEFF");case"dif":return rd(H_t.from_sheet(t.Sheets[t.SheetNames[i]],n),n);case"dbf":return LR(B_t.from_sheet(t.Sheets[t.SheetNames[i]],n),n);case"prn":return rd(q_t.from_sheet(t.Sheets[t.SheetNames[i]],n),n);case"rtf":return rd(ext.from_sheet(t.Sheets[t.SheetNames[i]],n),n);case"eth":return rd(TEe.from_sheet(t.Sheets[t.SheetNames[i]],n),n);case"fods":return rd(eSe(t,n),n);case"wk1":return LR(iae.sheet_to_wk1(t.Sheets[t.SheetNames[i]],n),n);case"wk3":return LR(iae.book_to_wk3(t,n),n);case"biff2":n.biff||(n.biff=2);case"biff3":n.biff||(n.biff=3);case"biff4":return n.biff||(n.biff=4),LR(XEe(t,n),n);case"biff5":n.biff||(n.biff=5);case"biff8":case"xla":case"xls":return n.biff||(n.biff=8),lSt(t,n);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return oSt(t,n);default:throw new Error("Unrecognized bookType |"+n.bookType+"|")}}function uSt(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},n=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();n.match(/^\.[a-z]+$/)&&(t.bookType=n.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function hSt(t,e,n){var r={};return r.type="file",r.file=e,uSt(r),nSe(t,r)}function dSt(t,e,n,r,i,s,o,a){var l=Do(n),c=a.defval,u=a.raw||!Object.prototype.hasOwnProperty.call(a,"raw"),h=!0,f=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(f,"__rowNum__",{value:n,enumerable:!1})}catch{f.__rowNum__=n}else f.__rowNum__=n;if(!o||t[n])for(var g=e.s.c;g<=e.e.c;++g){var y=o?t[n][g]:t[r[g]+l];if(y===void 0||y.t===void 0){if(c===void 0)continue;s[g]!=null&&(f[s[g]]=c);continue}var _=y.v;switch(y.t){case"z":if(_==null)break;continue;case"e":_=_==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+y.t)}if(s[g]!=null){if(_==null)if(y.t=="e"&&_===null)f[s[g]]=null;else if(c!==void 0)f[s[g]]=c;else if(u&&_===null)f[s[g]]=null;else continue;else f[s[g]]=u&&(y.t!=="n"||y.t==="n"&&a.rawNumbers!==!1)?_:bp(y,_,a);_!=null&&(h=!1)}}return{row:f,isempty:h}}function m5(t,e){if(t==null||t["!ref"]==null)return[];var n={t:"n",v:0},r=0,i=1,s=[],o=0,a="",l={s:{r:0,c:0},e:{r:0,c:0}},c=e||{},u=c.range!=null?c.range:t["!ref"];switch(c.header===1?r=1:c.header==="A"?r=2:Array.isArray(c.header)?r=3:c.header==null&&(r=0),typeof u){case"string":l=yi(u);break;case"number":l=yi(t["!ref"]),l.s.r=u;break;default:l=u}r>0&&(i=0);var h=Do(l.s.r),f=[],g=[],y=0,_=0,b=Array.isArray(t),T=l.s.r,A=0,I={};b&&!t[T]&&(t[T]=[]);var P=c.skipHidden&&t["!cols"]||[],R=c.skipHidden&&t["!rows"]||[];for(A=l.s.c;A<=l.e.c;++A)if(!(P[A]||{}).hidden)switch(f[A]=_a(A),n=b?t[T][A]:t[f[A]+h],r){case 1:s[A]=A-l.s.c;break;case 2:s[A]=f[A];break;case 3:s[A]=c.header[A-l.s.c];break;default:if(n==null&&(n={w:"__EMPTY",t:"s"}),a=o=bp(n,null,c),_=I[o]||0,!_)I[o]=1;else{do a=o+"_"+_++;while(I[a]);I[o]=_,I[a]=1}s[A]=a}for(T=l.s.r+i;T<=l.e.r;++T)if(!(R[T]||{}).hidden){var D=dSt(t,l,T,f,r,s,b,c);(D.isempty===!1||(r===1?c.blankrows!==!1:c.blankrows))&&(g[y++]=D.row)}return g.length=y,g}var dae=/"/g;function fSt(t,e,n,r,i,s,o,a){for(var l=!0,c=[],u="",h=Do(n),f=e.s.c;f<=e.e.c;++f)if(r[f]){var g=a.dense?(t[n]||[])[f]:t[r[f]+h];if(g==null)u="";else if(g.v!=null){l=!1,u=""+(a.rawNumbers&&g.t=="n"?g.v:bp(g,null,a));for(var y=0,_=0;y!==u.length;++y)if((_=u.charCodeAt(y))===i||_===s||_===34||a.forceQuotes){u='"'+u.replace(dae,'""')+'"';break}u=="ID"&&(u='"ID"')}else g.f!=null&&!g.F?(l=!1,u="="+g.f,u.indexOf(",")>=0&&(u='"'+u.replace(dae,'""')+'"')):u="";c.push(u)}return a.blankrows===!1&&l?null:c.join(o)}function Fq(t,e){var n=[],r=e??{};if(t==null||t["!ref"]==null)return"";var i=yi(t["!ref"]),s=r.FS!==void 0?r.FS:",",o=s.charCodeAt(0),a=r.RS!==void 0?r.RS:`
`,l=a.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),u="",h=[];r.dense=Array.isArray(t);for(var f=r.skipHidden&&t["!cols"]||[],g=r.skipHidden&&t["!rows"]||[],y=i.s.c;y<=i.e.c;++y)(f[y]||{}).hidden||(h[y]=_a(y));for(var _=0,b=i.s.r;b<=i.e.r;++b)(g[b]||{}).hidden||(u=fSt(t,i,b,h,o,l,s,r),u!=null&&(r.strip&&(u=u.replace(c,"")),(u||r.blankrows!==!1)&&n.push((_++?a:"")+u)));return delete r.dense,n.join("")}function rSe(t,e){e||(e={}),e.FS="	",e.RS=`
`;var n=Fq(t,e);return n}function pSt(t){var e="",n,r="";if(t==null||t["!ref"]==null)return[];var i=yi(t["!ref"]),s="",o=[],a,l=[],c=Array.isArray(t);for(a=i.s.c;a<=i.e.c;++a)o[a]=_a(a);for(var u=i.s.r;u<=i.e.r;++u)for(s=Do(u),a=i.s.c;a<=i.e.c;++a)if(e=o[a]+s,n=c?(t[u]||[])[a]:t[e],r="",n!==void 0){if(n.F!=null){if(e=n.F,!n.f)continue;r=n.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(n.f!=null)r=n.f;else{if(n.t=="z")continue;if(n.t=="n"&&n.v!=null)r=""+n.v;else if(n.t=="b")r=n.v?"TRUE":"FALSE";else if(n.w!==void 0)r="'"+n.w;else{if(n.v===void 0)continue;n.t=="s"?r="'"+n.v:r=""+n.v}}l[l.length]=e+"="+r}return l}function iSe(t,e,n){var r=n||{},i=+!r.skipHeader,s=t||{},o=0,a=0;if(s&&r.origin!=null)if(typeof r.origin=="number")o=r.origin;else{var l=typeof r.origin=="string"?fo(r.origin):r.origin;o=l.r,a=l.c}var c,u={s:{c:0,r:0},e:{c:a,r:o+e.length-1+i}};if(s["!ref"]){var h=yi(s["!ref"]);u.e.c=Math.max(u.e.c,h.e.c),u.e.r=Math.max(u.e.r,h.e.r),o==-1&&(o=h.e.r+1,u.e.r=o+e.length-1+i)}else o==-1&&(o=0,u.e.r=e.length-1+i);var f=r.header||[],g=0;e.forEach(function(_,b){jo(_).forEach(function(T){(g=f.indexOf(T))==-1&&(f[g=f.length]=T);var A=_[T],I="z",P="",R=qr({c:a+g,r:o+b+i});c=RA(s,R),A&&typeof A=="object"&&!(A instanceof Date)?s[R]=A:(typeof A=="number"?I="n":typeof A=="boolean"?I="b":typeof A=="string"?I="s":A instanceof Date?(I="d",r.cellDates||(I="n",A=Cl(A)),P=r.dateNF||rs[14]):A===null&&r.nullError&&(I="e",A=0),c?(c.t=I,c.v=A,delete c.w,delete c.R,P&&(c.z=P)):s[R]=c={t:I,v:A},P&&(c.z=P))})}),u.e.c=Math.max(u.e.c,a+f.length-1);var y=Do(o);if(i)for(g=0;g<f.length;++g)s[_a(g+a)+y]={t:"s",v:f[g]};return s["!ref"]=Ms(u),s}function mSt(t,e){return iSe(null,t,e)}function RA(t,e,n){if(typeof e=="string"){if(Array.isArray(t)){var r=fo(e);return t[r.r]||(t[r.r]=[]),t[r.r][r.c]||(t[r.r][r.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?RA(t,qr(e)):RA(t,qr({r:e,c:n||0}))}function gSt(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var n=t.SheetNames.indexOf(e);if(n>-1)return n;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function ySt(){return{SheetNames:[],Sheets:{}}}function vSt(t,e,n,r){var i=1;if(!n)for(;i<=65535&&t.SheetNames.indexOf(n="Sheet"+i)!=-1;++i,n=void 0);if(!n||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&t.SheetNames.indexOf(n)>=0){var s=n.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var o=s&&s[1]||n;for(++i;i<=65535&&t.SheetNames.indexOf(n=o+i)!=-1;++i);}if(qEe(n),t.SheetNames.indexOf(n)>=0)throw new Error("Worksheet with name |"+n+"| already exists!");return t.SheetNames.push(n),t.Sheets[n]=e,n}function _St(t,e,n){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var r=gSt(t,e);switch(t.Workbook.Sheets[r]||(t.Workbook.Sheets[r]={}),n){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+n)}t.Workbook.Sheets[r].Hidden=n}function xSt(t,e){return t.z=e,t}function sSe(t,e,n){return e?(t.l={Target:e},n&&(t.l.Tooltip=n)):delete t.l,t}function wSt(t,e,n){return sSe(t,"#"+e,n)}function bSt(t,e,n){t.c||(t.c=[]),t.c.push({t:e,a:n||"SheetJS"})}function ESt(t,e,n,r){for(var i=typeof e!="string"?e:yi(e),s=typeof e=="string"?e:Ms(e),o=i.s.r;o<=i.e.r;++o)for(var a=i.s.c;a<=i.e.c;++a){var l=RA(t,o,a);l.t="n",l.F=s,delete l.v,o==i.s.r&&a==i.s.c&&(l.f=n,r&&(l.D=!0))}return t}var uF={encode_col:_a,encode_row:Do,encode_cell:qr,encode_range:Ms,decode_col:Iq,decode_row:Aq,split_cell:jvt,decode_cell:fo,decode_range:Ec,format_cell:bp,sheet_add_aoa:sEe,sheet_add_json:iSe,sheet_add_dom:JEe,aoa_to_sheet:Pb,json_to_sheet:mSt,table_to_sheet:QEe,table_to_book:HEt,sheet_to_csv:Fq,sheet_to_txt:rSe,sheet_to_json:m5,sheet_to_html:ZEe,sheet_to_formulae:pSt,sheet_to_row_object_array:m5,sheet_get_cell:RA,book_new:ySt,book_append_sheet:vSt,book_set_sheet_visibility:_St,cell_set_number_format:xSt,cell_set_hyperlink:sSe,cell_set_internal_link:wSt,cell_add_comment:bSt,sheet_set_array_formula:ESt,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const mh=yo()(Eh((t,e)=>({vondsten:[],addVondst:n=>t(r=>({vondsten:[...r.vondsten,{...n,id:crypto.randomUUID(),timestamp:new Date().toISOString()}]})),removeVondst:n=>t(r=>({vondsten:r.vondsten.filter(i=>i.id!==n)})),updateVondst:(n,r)=>t(i=>({vondsten:i.vondsten.map(s=>s.id===n?{...s,...r}:s)})),clearAll:()=>t({vondsten:[]}),exportAsGeoJSON:()=>{const n=e().vondsten;if(n.length===0){alert("Geen vondsten om te exporteren");return}const r={type:"FeatureCollection",features:n.map(a=>({type:"Feature",geometry:{type:"Point",coordinates:[a.location.lng,a.location.lat]},properties:{id:a.id,objectType:a.objectType,material:a.material,period:a.period,depth:a.depth,notes:a.notes,timestamp:a.timestamp,photoUrl:a.photoUrl,condition:a.condition,weight:a.weight,length:a.length}}))},i=new Blob([JSON.stringify(r,null,2)],{type:"application/json"}),s=URL.createObjectURL(i),o=document.createElement("a");o.href=s,o.download=`mijn-vondsten-${new Date().toISOString().split("T")[0]}.geojson`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(s)},exportAsCSV:()=>{const n=e().vondsten;if(n.length===0){alert("Geen vondsten om te exporteren");return}const r=`ID,Latitude,Longitude,Datum,Type,Materiaal,Periode,Diepte (cm),Conditie,Gewicht (g),Lengte (mm),Notities,Foto URL
`,i=n.map(c=>{const u=new Date(c.timestamp).toLocaleDateString("nl-NL"),h=c.notes?`"${c.notes.replace(/"/g,'""')}"`:"";return`${c.id},${c.location.lat},${c.location.lng},${u},${c.objectType},${c.material},${c.period},${c.depth||""},${c.condition||""},${c.weight||""},${c.length||""},${h},${c.photoUrl||""}`}).join(`
`),s=r+i,o=new Blob([s],{type:"text/csv;charset=utf-8;"}),a=URL.createObjectURL(o),l=document.createElement("a");l.href=a,l.download=`mijn-vondsten-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(a)},exportAsExcel:()=>{const n=e().vondsten;if(n.length===0){alert("Geen vondsten om te exporteren");return}const r=n.map(a=>({ID:a.id,Latitude:a.location.lat,Longitude:a.location.lng,Datum:new Date(a.timestamp).toLocaleDateString("nl-NL"),Type:a.objectType,Materiaal:a.material,Periode:a.period,"Diepte (cm)":a.depth||"",Conditie:a.condition||"","Gewicht (g)":a.weight||"","Lengte (mm)":a.length||"",Notities:a.notes||"","Foto URL":a.photoUrl||""})),i=uF.json_to_sheet(r),s=uF.book_new();uF.book_append_sheet(s,i,"Vondsten");const o=[{wch:36},{wch:12},{wch:12},{wch:12},{wch:15},{wch:12},{wch:25},{wch:12},{wch:12},{wch:12},{wch:12},{wch:40},{wch:50}];i["!cols"]=o,hSt(s,`mijn-vondsten-${new Date().toISOString().split("T")[0]}.xlsx`)},exportAsGPX:()=>{const n=e().vondsten;if(n.length===0){alert("Geen vondsten om te exporteren");return}const r=n.map(l=>{const c=new Date(l.timestamp).toISOString();return`  <wpt lat="${l.location.lat}" lon="${l.location.lng}">
    <name>${l.objectType} - ${l.material}</name>
    <desc>${l.period}${l.depth?`, ${l.depth}cm diep`:""}${l.condition&&l.condition!=="Onbekend"?`, ${l.condition}`:""}${l.weight?`, ${l.weight}g`:""}${l.length?`, ${l.length}mm`:""}${l.notes?`. ${l.notes}`:""}</desc>
    <time>${c}</time>
    <sym>Pin</sym>
  </wpt>`}).join(`
`),i=`<?xml version="1.0" encoding="UTF-8"?>
<gpx version="1.1" creator="DetectorApp NL" xmlns="http://www.topografix.com/GPX/1/1">
  <metadata>
    <name>Mijn Vondsten</name>
    <desc>Geexporteerd uit DetectorApp NL</desc>
    <time>${new Date().toISOString()}</time>
  </metadata>
${r}
</gpx>`,s=new Blob([i],{type:"application/gpx+xml"}),o=URL.createObjectURL(s),a=document.createElement("a");a.href=o,a.download=`mijn-vondsten-${new Date().toISOString().split("T")[0]}.gpx`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(o)},exportAsKML:()=>{const n=e().vondsten;if(n.length===0){alert("Geen vondsten om te exporteren");return}const i=`<?xml version="1.0" encoding="UTF-8"?>
<kml xmlns="http://www.opengis.net/kml/2.2">
  <Document>
    <name>Mijn Vondsten</name>
    <description>Geexporteerd uit DetectorApp NL</description>
${n.map(l=>{const c=new Date(l.timestamp).toLocaleDateString("nl-NL"),u=`<![CDATA[
            <b>Type:</b> ${l.objectType}<br/>
            <b>Materiaal:</b> ${l.material}<br/>
            <b>Periode:</b> ${l.period}<br/>
            ${l.depth?`<b>Diepte:</b> ${l.depth} cm<br/>`:""}
            ${l.condition&&l.condition!=="Onbekend"?`<b>Conditie:</b> ${l.condition}<br/>`:""}
            ${l.weight?`<b>Gewicht:</b> ${l.weight} gram<br/>`:""}
            ${l.length?`<b>Lengte:</b> ${l.length} mm<br/>`:""}
            <b>Datum:</b> ${c}<br/>
            ${l.notes?`<b>Notities:</b> ${l.notes}<br/>`:""}
            ${l.photoUrl?`<a href="${l.photoUrl}">Bekijk foto</a>`:""}
          ]]>`;return`    <Placemark>
      <name>${l.objectType} - ${l.material}</name>
      <description>${u}</description>
      <Point>
        <coordinates>${l.location.lng},${l.location.lat},0</coordinates>
      </Point>
    </Placemark>`}).join(`
`)}
  </Document>
</kml>`,s=new Blob([i],{type:"application/vnd.google-earth.kml+xml"}),o=URL.createObjectURL(s),a=document.createElement("a");a.href=o,a.download=`mijn-vondsten-${new Date().toISOString().split("T")[0]}.kml`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(o)}}),{name:"detectorapp-local-vondsten"})),SSt={Fectio:{naam:"Fectio",latinNaam:"Fectio",type:"castellum",periode:"ca. 4 - 270 n.Chr.",beschrijving:"Groot Romeins castellum bij Bunnik/Vechten, aan de splitsing van Rijn en Vecht. Een van de belangrijkste legerbases in Nederland met ruimte voor 500 soldaten. Het fort had barakken, badhuis, hospitaal en pakhuizen. Buiten de muren woonden handelaren en soldatenfamilies in een vicus. Hier is een compleet Romeins schip gevonden (De Meern 1). Strategisch gelegen voor transport over de rivieren. Veel vondsten door natte bodem: leer, hout, textiel naast munten en militaria. Te bezoeken: Archeologisch Park Castellum Hoge Woerd met reconstructie en museum.",watWasHier:"Groot castellum met ruimte voor 500 soldaten, barakken, badhuis, hospitaal en pakhuizen. Buiten het fort een burgerdorp.",watTeZien:"Archeologisch Park Castellum Hoge Woerd toont de contouren. Museum met veel vondsten waaronder een Romeins schip.",verwachteVondsten:"Munten, fibulae, aardewerk, wapens, paardentuig, militaire uitrusting. Door natte bodem ook leer, hout en textiel.",betekenis:"Een van de belangrijkste forten aan de Limes. Knooppunt voor troepen- en goederentransport.",bronnen:["https://www.hogewoerd.nl","https://www.livius.org/articles/place/fectio-vechten/"]},Traiectum:{naam:"Traiectum",latinNaam:"Traiectum",type:"castellum",periode:"ca. 42 - 275 n.Chr.",beschrijving:'Romeins castellum onder het huidige Domplein in Utrecht. De naam betekent "doorwaadbare plaats" - hier splitsten Rijn en Vecht. Het fort (124x152m in laatste fase) bood plaats aan ca. 500 soldaten. Vijf bouwfases: eerst hout, na 200 n.Chr. steen met tufsteen uit de Eifel. Cohors II Hispanorum peditata (Spaanse infanterie) was hier uniek gelegerd 88-275 n.Chr. - hun dakpanstempels zijn nergens anders aan de Limes gevonden! Het fort werd verwoest tijdens de Bataafse Opstand (69 n.Chr.). DOMunder onder het Domplein toont de opgegraven resten. UNESCO Werelderfgoed sinds 2021.',watWasHier:"Castellum (500 soldaten) bij riviersplitsing. Cohors II Hispanorum gelegerd.",watTeZien:"DOMunder onder het Domplein: opgravingen te bezoeken. Principia en poorten blootgelegd.",verwachteVondsten:"Dakpannen met stempels, munten, aardewerk, tufsteen bouwmateriaal, militaria.",betekenis:"UNESCO Werelderfgoed. Oorsprong van de stad Utrecht.",bronnen:["https://www.livius.org/articles/place/traiectum-utrecht/","https://www.utrechtaltijd.nl/verhalen/castellum-traiectum-een-romeinse-legerbasis-in-het-hart-van-de-domstad/","https://www.romeinen.nl/locatie-overzicht/3447271878/domunder-castellum-traiectum"]},Laurum:{naam:"Laurum",latinNaam:"Laurum",type:"castellum",periode:"ca. 40 - 270 n.Chr.",beschrijving:"Romeins castellum in het huidige Woerden aan de Oude Rijn. Garnizoen van ca. 500 soldaten in houten barakken. Bijzonder vanwege de natte veenbodem: organisch materiaal bleef bewaard zoals houten schrijfplankjes met Latijnse teksten, leren schoenen en een Romeinse boot. Het fort werd meerdere keren herbouwd na overstromingen. De contouren zijn in het stratenpatroon herkenbaar. Buiten de muren lag een vicus (burgerdorp). Vondsten in Stadsmuseum Woerden, waaronder unieke houten voorwerpen die elders zijn vergaan.",watWasHier:"Castellum voor 500 soldaten met houten barakken, badhuis en pakhuizen. Vicus buiten de muren.",watTeZien:"Stadsmuseum Woerden met bijzondere vondsten. Fort-contouren in stratenpatroon herkenbaar.",verwachteVondsten:"Militaria, aardewerk, munten, schrijfplankjes. Door natte veengrond ook hout, leer en schoenen.",betekenis:"Toont Romeins bouwen in moeilijk veengebied. Unieke organische vondsten.",bronnen:["https://www.castellumwoerden.nl"]},"Castellum Praetorium Agrippinae":{naam:"Praetorium Agrippinae",latinNaam:"Praetorium Agrippinae",type:"castellum",periode:"ca. 40 - 275 n.Chr.",beschrijving:"Een van de best opgegraven Romeinse locaties van Nederland. Het castellum werd gesticht in de winter van 39/40 n.Chr. door keizer Caligula, vernoemd naar zijn moeder Vipsania Agrippina. Een opgegraven wijnvat bevatte wijn van de persoonlijke wijngaarden van de keizer! Er zijn 7 bouwfasen gevonden, 6 van hout en de laatste van steen - uniek compleet inzicht in Romeinse bouwtechnieken. Cohors III Gallorum equitata was hier gelegerd. Bij opgravingen (1941-1953) zijn door het grondwater veel organische vondsten bewaard: voedselresten, leer, touw. De vicus buiten het fort strekte zich 1 km uit met 700+ graven. Op het Castellumplein zijn de contouren in brons gemarkeerd.",watWasHier:"Castellum met 7 bouwfasen. Vicus (1 km) met 700+ graven. Detachement Cohors III Gallorum.",watTeZien:"Castellumplein met bronzen markeringen. Torenmuseum Valkenburg. Gereconstrueerde poort.",verwachteVondsten:"Militaria, organisch materiaal (voedsel, leer, touw), aardewerk, munten, inscripties.",betekenis:"Best gedocumenteerde Romeinse fort van Nederland. UNESCO Werelderfgoed.",bronnen:["https://www.livius.org/articles/place/praetorium-agrippinae-valkenburg-zh/","https://www.geschiedenisvanzuidholland.nl/zien-en-doen/locaties/praetorium-agrippinae-in-valkenburg/","https://oudvalkenburgzh.nl/torenmuseum-5/"]},"Castra Hunnerberg":{naam:"Castra Hunnerberg",latinNaam:"Castra",type:"legerkamp",periode:"ca. 16 v.Chr. - 104 n.Chr.",beschrijving:'Enorm Romeins legerkamp op de Hunnerberg bij Nijmegen - 42 hectare (80 voetbalvelden), ruimte voor 12.000 man. De enige plek in Nederland waar echte legioenen (geen hulptroepen) verbleven! Na de Bataafse Opstand (69 n.Chr.) vestigde Legio X Gemina Pia Fidelis zich hier - opgericht door Julius Caesar en het bekendste legioen van Nederland. De afkorting LXG is talloze keren gevonden op dakpannen en tegels. Bij opgravingen zijn ruim 1000 fragmenten militaire uitrusting en paardentuig gevonden. In 104 n.Chr. vertrok het legioen naar de Balkan - een ramp voor de economie. UNESCO Werelderfgoed sinds 2021, omschreven als "bakermat van de Nederduitse Limes".',watWasHier:"Legerkamp voor 12.000 man. Legio X Gemina (71-104 n.Chr.), opgericht door Julius Caesar.",watTeZien:"Museum Het Valkhof. Museum Kam in de Hunnerberg. Grafvelden in Nijmegen-Oost.",verwachteVondsten:"Legioenstempels LXG, militaria, paardentuig, dakpannen, munten, grafstenen.",betekenis:"UNESCO Werelderfgoed. Bakermat van de Limes. Enige legioenskamp in Nederland.",bronnen:["https://www.livius.org/articles/place/noviomagus-nijmegen-hunnerberg/","https://www.welkominnijmegen.nl/pages/geschiedenis/de-romeinen-in-nijmegen/de-legerkampen.php","https://mijngelderland.nl/inhoud/specials/archeokroniek/romeinse-militaire-uitrusting-en-paardentuig-van-de-hunerberg-te-nijmegen"]},"Castellum Kops Plateau":{naam:"Kops Plateau",latinNaam:"Oppidum Batavorum",type:"castellum",periode:"ca. 10 v.Chr. - 70 n.Chr.",beschrijving:"Vroege Romeinse basis op het Kops Plateau in Nijmegen, later de civiele hoofdstad van de Bataven: Oppidum Batavorum. Hier woonden Romeinen en Bataven samen - het eerste contactpunt tussen beide culturen. Verwoest tijdens de Bataafse Opstand van 69-70 n.Chr. onder leiding van Julius Civilis. Gemengde vondsten: Romeinse militaria n Keltisch-Bataafse voorwerpen. Vroege importaardewerk en munten van Augustus. Nu natuurgebied. Museum Het Valkhof toont de unieke vondsten van deze ontmoeting van culturen.",watWasHier:"Eerst Romeins kamp, later Bataafse hoofdstad. Romeinen en Bataven woonden samen.",watTeZien:"Kops Plateau is natuurgebied. Museum Het Valkhof toont de vondsten.",verwachteVondsten:"Vroege militaria, Keltisch-Bataafse voorwerpen, importaardewerk, munten van Augustus.",betekenis:"Eerste contactpunt Romeinen-Bataven. Begin van romanisering Nederland.",bronnen:["https://www.livius.org/articles/place/noviomagus-nijmegen-kops-plateau/"]},"Nijmegen, Valkhof":{naam:"Valkhof Nijmegen",latinNaam:"Valkhof",type:"versterking",periode:"ca. 270 - 400 n.Chr.",beschrijving:"Laat-Romeinse versterking op het Valkhof in Nijmegen, aan de Waaloever. Gebouwd toen het Rijk onder druk stond van Germaanse invallen. Strategische positie boven de rivier. Continuteit: Karel de Grote bouwde hier later zijn palts (koninklijke residentie). De Sint-Nicolaaskapel bevat mogelijk Karolingische elementen op Romeinse fundamenten. Typische laat-Romeinse vondsten: gordels met riemtongen, militaire gespen, munten van 3e-4e eeuwse keizers. Museum Het Valkhof toont de overgang van Romeinse tijd naar vroege middeleeuwen.",watWasHier:"Laat-Romeinse versterking boven de Waal. Later Karolingische palts.",watTeZien:"Valkhofpark met Sint-Nicolaaskapel. Museum Het Valkhof.",verwachteVondsten:"Laat-Romeinse munten, gordels, riemtongen, militaire gespen, 3e-4e eeuws aardewerk.",betekenis:"Toont overgang Romeinse tijd naar middeleeuwen. Nijmegen bleef machtscentrum.",bronnen:["https://www.museumhetvalkhof.nl"]},"Castellum Op de Hoge Woerd":{naam:"Hoge Woerd",latinNaam:"Castellum",type:"castellum",periode:"ca. 50 - 270 n.Chr.",beschrijving:"Romeins castellum in Leidsche Rijn (Utrecht), nu een voorbeeldig archeologisch park. Middelgroot fort met houten gebouwen en een burgerdorp (vicus) buiten de muren. Hier is een compleet Romeins schip gevonden: De Meern 1, een 25 meter lange vrachtboot. Door de natte kleigrond bleef veel organisch materiaal bewaard. Het park toont de reconstructie van het fort - je kunt over de originele fundamenten lopen. Modern museum met interactieve presentatie. Ideale plek om te zien hoe een Romeins fort eruitzag.",watWasHier:"Middelgroot castellum met houten gebouwen. Vicus buiten de muren. Compleet schip gevonden.",watTeZien:"Archeologisch Park Hoge Woerd: reconstructie fort, museum, originele fundamenten.",verwachteVondsten:"Militaria, scheepsonderdelen, aardewerk, munten. Door natte grond ook organisch materiaal.",betekenis:"Best gepresenteerde Romeinse fort in Nederland. Ideaal om fort-layout te begrijpen.",bronnen:["https://www.hogewoerd.nl"]},Lugdunum:{naam:"Lugdunum",latinNaam:"Lugdunum",type:"vlootbasis",periode:"ca. 40 - 270 n.Chr.",beschrijving:`Romeinse vlootbasis en versterkte graanopslagplaats bij de monding van de Rijn, het westelijkste punt van de gehele Limes. Hier stond mogelijk een enorme vuurtoren (ca. 60m hoog) naar model van de Pharos van Ostia - vissers noemden deze "Kalla's toren" (Caligula). Door de vele dakpannen van de Romeinse vloot wordt aangenomen dat dit een vlootbasis was. Het fort is door kustafslag in zee verdwenen. Bij stormen in 1520, 1552 en 1562 waren de runes van de "Brittenburg" zichtbaar op het strand; de laatst gedateerde vondst was 270 n.Chr. Het Rijksmuseum van Oudheden in Leiden toont vondsten. De beroemde kaart van Ortelius toont hoe het eruit zag.`,watWasHier:"Vlootbasis met vuurtoren bij Rijnmonding. Graanopslag voor Britannia.",watTeZien:"Fort verdwenen in zee. RMO Leiden toont vondsten en kaart van Ortelius.",verwachteVondsten:"Na stormen: munten, aardewerk, militaria. Fort zelf onbereikbaar in Noordzee.",betekenis:"Westelijk eindpunt van de Limes. Verbinding met Britannia.",bronnen:["https://www.livius.org/articles/place/lugdunum-katwijk/","https://nl.wikipedia.org/wiki/Lugdunum_(Katwijk)"]},"Vlootbasis Naaldwijk":{naam:"Vlootbasis Naaldwijk",type:"vlootbasis",periode:"1e - 2e eeuw n.Chr.",beschrijving:"Vermoedelijke basis van de Classis Germanica (Germaanse vloot) bij Naaldwijk in het Westland. De Romeinse vloot patrouilleerde langs de Noordzeekust en vervoerde troepen en goederen naar Britannia. Haven met dokken voor oorlogsschepen en transportboten. Mariniers (classiarii) waren hier gestationeerd. Het gebied is nu landbouwgrond, maar bij opgravingen zijn haven-structuren en scheepsgerelateerde vondsten gedaan. Ankers, scheepsonderdelen en specifieke mariniers-uitrusting. Toont het belang van zeemacht voor de Romeinse grensverdediging.",watWasHier:"Haven voor oorlogsschepen. Mariniers gestationeerd. Patrouilles langs Noordzeekust.",watTeZien:"Gebied is landbouwgrond. Vondsten in lokale musea.",verwachteVondsten:"Scheepsonderdelen, ankers, mariniers-uitrusting, importaardewerk.",betekenis:"Toont belang Romeinse vloot voor kustverdediging.",bronnen:[]},"Minifort Ockenburg":{naam:"Minifort Ockenburg",type:"minifort",periode:"ca. 150 - 180 n.Chr.",beschrijving:"Klein Romeins kustfort bij Ockenburg in Den Haag, op een oude strandwal. Bewaakte de kust tegen piraten en Germaanse invallen over zee. Ruimte voor slechts 20-30 soldaten - een wachtpost eerder dan een echt fort. Korte gebruiksperiode van ca. 30 jaar. Toont dat de Romeinen niet alleen de rivieren maar ook de Noordzeekust verdedigden. Het terrein is beschermd rijksmonument maar niet publiek toegankelijk. Vondsten in het Haags Historisch Museum: militaria, aardewerk en munten uit de 2e eeuw.",watWasHier:"Kleine kustwachtpost voor 20-30 soldaten op strandwal.",watTeZien:"Terrein beschermd maar niet toegankelijk. Haags Historisch Museum.",verwachteVondsten:"Kleine hoeveelheden militaria, aardewerk, munten 2e eeuw.",betekenis:"Toont Romeinse kustverdediging naast rivierforten.",bronnen:[]},"Castellum Ceuclum":{naam:"Ceuclum",latinNaam:"Ceuclum",type:"castellum",periode:"ca. 70 - 270 n.Chr.",beschrijving:"Romeins castellum bij Cuijk aan de Maas, waar de belangrijke weg naar het noorden de rivier kruiste. Het fort bewaakte een brug of veerpont. Garnizoen van hulptroepen. De naam Cuijk is afgeleid van Ceuclum. Bij de brug werden ritueel munten geofferd. Het fort lag op een strategisch punt waar de Maasroute de landweg kruiste. Vondsten wijzen op handel en militaire activiteit. Het Maasmuseum in Cuijk toont lokale Romeinse vondsten. Onder het centrum zijn bij bouwwerkzaamheden regelmatig resten gevonden.",watWasHier:"Castellum bij Maasbrug. Belangrijke rivierovergang en kruispunt.",watTeZien:"Maasmuseum Cuijk. Resten gevonden onder centrum.",verwachteVondsten:"Munten (geofferd bij brug), fibulae, aardewerk, bruggerelateerde vondsten.",betekenis:"Belangrijke schakel in wegennet langs de Maas.",bronnen:["https://www.livius.org/articles/place/ceuclum-cuijk/"]},"Castellum Meinerswijk":{naam:"Meinerswijk",type:"castellum",periode:"ca. 40 - 270 n.Chr.",beschrijving:"Romeins castellum in de uiterwaarden bij Arnhem-Meinerswijk aan de Rijn. Het fort bewaakt een strategisch punt waar de rivier goed te overzien was. Meerdere bouwfasen door overstromingen. In de uiterwaarden zijn bij erosie en opgravingen vondsten gedaan: militaria, aardewerk, munten en scheepsresten. Het gebied is nu natuurgebied Meinerswijk met wisselende waterstanden. Na hoog water kunnen vondsten aan de oppervlakte komen. Museum Arnhem toont Romeinse vondsten uit de regio.",watWasHier:"Castellum in uiterwaarden. Meerdere bouwfasen door overstromingen.",watTeZien:"Natuurgebied Meinerswijk. Museum Arnhem.",verwachteVondsten:"Militaria, aardewerk, munten, scheepsresten. Na hoog water aan oppervlakte.",betekenis:"Onderdeel fortenketen langs de Rijn.",bronnen:[]},Levefanum:{naam:"Levefanum",latinNaam:"Levefanum",type:"versterking",periode:"ca. 50 - 270 n.Chr.",beschrijving:"Romeinse versterking bij Wijk bij Duurstede, waar de Rijn splitste in de Lek en Kromme Rijn. Strategisch cruciaal punt voor controle over het scheepvaartverkeer. Waarschijnlijk ook een haven voor overslag van goederen. Op dezelfde plek ontstond later de Karolingische handelsstad Dorestad, een van de belangrijkste havens van vroegmiddeleeuws Europa. De continuteit toont het blijvende belang van deze locatie. Dorestad Museum vertelt het verhaal van Romeinse tijd tot Vikingaanvallen. Vondsten: munten, handelsaardewerk, militaria.",watWasHier:"Versterking bij riviersplitsing. Haven en overslagpunt. Later Dorestad.",watTeZien:"Dorestad Museum. Terrein bebouwd.",verwachteVondsten:"Munten, handelsaardewerk, militaria, scheepsgerelateerde vondsten.",betekenis:"Strategisch controlepunt waterwegen. Later belangrijke handelsstad Dorestad.",bronnen:[]},"Nigrum Pullum":{naam:"Nigrum Pullum",latinNaam:"Nigrum Pullum (Zwarte Poel)",type:"minifort",periode:"ca. 40 - 270 n.Chr.",beschrijving:"Romeins castellum bij Zwammerdam aan de Oude Rijn. Garnizoen van 100-150 soldaten met pakhuizen en haven voor riviertransport. Wereldberoemd door de vondst van 6 Romeinse schepen (1971-1974) in perfecte staat - bewaard door de natte veengrond. De Zwammerdamschepen zijn de best bewaarde Romeinse rivierschepen ter wereld en tonen uniek inzicht in Romeins transport en scheepsbouw. Vondsten: schepen, leren schoeisel, houten voorwerpen, aardewerk, munten, militaria. Te zien in Rijksmuseum van Oudheden, Leiden.",watWasHier:"Klein fort met pakhuizen en haven. Bij opgravingen werden 6 Romeinse schepen gevonden.",watTeZien:"De schepen zijn in het Rijksmuseum van Oudheden in Leiden. Het terrein zelf is niet te bezoeken.",verwachteVondsten:"Scheepsonderdelen, leren schoeisel, houten voorwerpen, aardewerk, munten, en door de natte veengrond organisch materiaal.",betekenis:"Wereldberoemd om de goed bewaarde Romeinse schepen. Toont transport over de Rijn.",bronnen:["https://www.rmo.nl/collectie/themas/zwammerdam"]},"Stenen wachttoren Vleuterweide":{naam:"Wachttoren Vleuterweide",type:"wachttoren",periode:"ca. 150 - 250 n.Chr.",beschrijving:"Bijzondere stenen wachttoren in Vleuterweide bij Utrecht - de meeste Romeinse wachttorens waren van hout. De stenen constructie wijst op permanentie en belang. Onderdeel van het signaleringssysteem langs de Limes: bij gevaar werden vuren aangestoken om forten te waarschuwen. De toren bood uitzicht over de omgeving en de rivier. Mogelijk woonden hier ook families van de soldaten. De fundamenten zijn gemarkeerd in de moderne woonwijk. Vondsten: bouwmateriaal (dakpannen, stenen), aardewerk, persoonlijke bezittingen. Centraal Museum Utrecht.",watWasHier:"Stenen wachttoren (ongebruikelijk). Signaalpost voor waarschuwingssysteem.",watTeZien:"Fundamenten gemarkeerd in wijk. Centraal Museum Utrecht.",verwachteVondsten:"Dakpannen met legioenstempels, aardewerk, persoonlijke bezittingen.",betekenis:"Een van weinige bekende stenen wachttorens. Toont variatie in bouwwijzen.",bronnen:[]},"Wachttoren Bunnik":{naam:"Wachttoren Bunnik",type:"wachttoren",periode:"ca. 50 - 270 n.Chr.",beschrijving:"Houten wachttoren bij Bunnik aan de Rijn, onderdeel van het signaleringssysteem langs de Limes. Elke paar kilometer stond een toren met uitzicht over de rivier. Bij nadering van vijanden werden vuren of rooksignalen gegeven, zodat binnen minuten alle forten gewaarschuwd waren. De torens waren meestal van hout op een aarden verhoging. Kleine bezetting van 4-8 soldaten. De exacte locatie is niet precies bekend doordat het gebied nu bebouwd is. Vondsten zijn schaars: wat aardewerk en militaria.",watWasHier:"Houten uitkijktoren voor signalering. Kleine bezetting van 4-8 soldaten.",watTeZien:"Exacte locatie onbekend. Gebied bebouwd.",verwachteVondsten:"Kleine hoeveelheden militaria en aardewerk.",betekenis:"Onderdeel signaleringssysteem langs Limes.",bronnen:[]},"Castellum Maastricht":{naam:"Castellum Maastricht",latinNaam:"Mosae Trajectum",type:"versterking",periode:"ca. 270 - 400 n.Chr.",beschrijving:'Laat-Romeinse versterking in het centrum van Maastricht bij de brug over de Maas. Mosae Trajectum betekent "Maasoversteek". Gebouwd in een periode dat het Rijk onder druk stond van Germaanse invallen. Het fort bewaakte de strategische rivierovergang. Continuteit van bewoning: Maastricht bleef bewoond tot op heden. Onder het Vrijthof en omgeving zijn Romeinse resten gevonden. Typische laat-Romeinse vondsten: gordels, riembeslag, munten 3e-4e eeuw, zwaar versterkte muren. Centre Ceramique vertelt de geschiedenis.',watWasHier:"Laat-Romeinse versterking bij Maasbrug. Verdediging tegen Germaanse invallen.",watTeZien:"Onder Vrijthof zijn resten. Centre Ceramique.",verwachteVondsten:"Laat-Romeinse munten, militaire gordelbeslag, riemtongen, 3e-4e eeuws aardewerk.",betekenis:"Toont continuteit - Maastricht ononderbroken bewoond sinds Romeinse tijd.",bronnen:["https://www.centreceramique.nl"]},Roompot:{naam:"Roompot Fort",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeins kustfort bij de Roompot in Zeeland dat de toegang tot de Oosterschelde bewaakte. Het fort beschermde schepen tegen piraterij en controleerde de vaarroute. Door zeespiegelstijging en kustafslag is het fort in de golven verdwenen. De exacte locatie ligt nu onder water. Soms spoelen na stormen vondsten aan op de stranden van Noord-Beveland en Walcheren: munten, aardewerk, metalen voorwerpen. Toont dat de Romeinen de gehele Zeeuwse delta controleerden, niet alleen de grote rivieren.",watWasHier:"Kustfort dat zeeroute bewaakte. Bescherming tegen piraterij.",watTeZien:"Fort verdwenen in zee. Soms vondsten op strand na stormen.",verwachteVondsten:"Na stormen: munten, aardewerk, metalen voorwerpen op Zeeuwse stranden.",betekenis:"Toont Romeinse controle over Zeeuwse wateren.",bronnen:[]},"Castellum Carvium":{naam:"Carvium",latinNaam:"Carvium",type:"castellum",periode:"ca. 40 - 270 n.Chr.",beschrijving:"Romeins castellum bij Herwen-Aerdt (bij Lobith) waar Rijn en Waal samenkwamen - een strategisch knooppunt van eerste orde. Het fort controleerde het rivierverkeer op beide grote stromen. Garnizoen van hulptroepen. In de uiterwaarden zijn bij erosie en opgravingen vondsten gedaan. Het gebied is nu natuurgebied de Gelderse Poort met dynamische rivierlandschap. Na hoog water kunnen vondsten aan oppervlakte komen. Museum Het Valkhof in Nijmegen toont vondsten uit de regio. Scheepsresten gevonden.",watWasHier:"Fort bij samenvloeiing Rijn en Waal. Controleerde twee grote rivieren.",watTeZien:"Natuurgebied Gelderse Poort. Museum Het Valkhof Nijmegen.",verwachteVondsten:"Militaria, aardewerk, munten, scheepsresten. Na hoog water aan oppervlakte.",betekenis:"Controleerde strategisch knooppunt waterwegen.",bronnen:[]},Matilo:{naam:"Matilo",latinNaam:"Matilo",type:"castellum",periode:"ca. 70 - 260 n.Chr.",beschrijving:'Romeins castellum bij Leiden-Roomburg, gebouwd na de Bataafse Opstand (69-70 n.Chr.) op een strategische plek aan de monding van het Kanaal van Corbulo. Het gigantische fort (80x120m) bood plaats aan ca. 500 soldaten en is een van de best bewaarde castella in Nederland. De archeologische resten liggen grotendeels intact onder Archeologisch Park Matilo. In het park staan 6 replica-wachttorens en een aarden wal die de omtrek van het fort visualiseert. Het fort werd tussen 240-260 n.Chr. opgeheven. De locatie Roomburg ("Romeinse burcht") verwijst naar de oorsprong. UNESCO Werelderfgoed sinds 2021.',watWasHier:"Groot castellum (500 soldaten) bij monding Kanaal van Corbulo. Vicus buiten de muren.",watTeZien:"Archeologisch Park Matilo met 6 wachttoren-replica's en aarden wal. Rijksmuseum van Oudheden.",verwachteVondsten:"Militaria, grafgiften, crematie-urnen, aardewerk, munten, fibulae.",betekenis:"UNESCO Werelderfgoed. Een van de best bewaarde castella van Nederland.",bronnen:["https://parkmatilo.nl/het-verhaal-van-matilo/","https://www.limeswerelderfgoed.nl/locaties/2016475046/archeologisch-park-matilo","https://www.romeinen.nl/locatie-overzicht/2016475046/archeologisch-park-matilo"]},Corbulo:{naam:"Forum Hadriani",latinNaam:"Forum Hadriani (Municipium Aelium Cananefatium)",type:"versterking",periode:"ca. 70 - 270 n.Chr.",beschrijving:"Forum Hadriani bij Voorburg was de noordelijkste Romeinse stad van het Europese continent en de enige stad met stadsrechten in Nederland. Gesticht rond 70 n.Chr. aan het Kanaal van Corbulo (34 km, verbinding Rijn-Maas). Keizer Hadrianus verleende in 121 n.Chr. marktrechten en gaf de stad zijn naam. Rond 150 n.Chr. kreeg het stadsrechten (Municipium). De stad had ca. 1000 inwoners, een stadsmuur met dubbele gracht, stenen gebouwen en tempels. Park Arentsburgh markeert de locatie. UNESCO Werelderfgoed sinds 2021. De eerste wetenschappelijke opgravingen (1827-1833) waren door Caspar Reuvens, de eerste hoogleraar archeologie ter wereld.",watWasHier:"Enige Romeinse stad met stadsrechten in Nederland. Ca. 1000 inwoners.",watTeZien:"Park Arentsburgh in Voorburg. Kanaal traceerbaar als de Vliet.",verwachteVondsten:"Stedelijke vondsten: bouwmateriaal, aardewerk, munten, inscripties, religieuze voorwerpen.",betekenis:"UNESCO Werelderfgoed. Noordelijkste Romeinse stad van Europa.",bronnen:["https://www.awlv.nl/forum-hadriani/de-stad-forum-hadriani/","https://www.romeinen.nl/weten/nederland-in-de-romeinse-tijd/zuid-holland/regio-voorburg","https://kennis.cultureelerfgoed.nl/index.php/Monumenten/508083"]},"Berg - Tomveld":{naam:"Berg-Tomveld",type:"villa",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeinse villa bij Berg in Zuid-Limburg, mogelijk tijdelijk militair gebruikt. Dit type gebouwen diende als landbouwbedrijf met luxe woondeel voor de eigenaar. De regio Zuid-Limburg was dicht bebouwd met villa's die graan en vee leverden aan het Romeinse leger. Vondsten wijzen op welvaart: mozaekvloeren, beschilderd pleisterwerk, hypocaustum (vloerverwarming). De locatie Tomveld verwijst mogelijk naar Romeinse grafheuvels (tumuli) in de buurt. Thermenmuseum Heerlen toont de villa-cultuur.",watWasHier:"Villa rustica met mogelijk militair gebruik. Landbouw voor legervoorraden.",watTeZien:"Locatie in agrarisch gebied. Thermenmuseum Heerlen.",verwachteVondsten:"Bouwmateriaal, dakpannen, aardewerk, munten, sieraden.",betekenis:"Toont Romeinse landbouweconomie in Zuid-Limburg.",bronnen:[]},"Berg - Trappenberg":{naam:"Berg-Trappenberg",type:"legerkamp",periode:"1e eeuw v.Chr. - 1e eeuw n.Chr.",beschrijving:"Vroeg-Romeins legerkamp bij Berg in Zuid-Limburg dat later werd omgebouwd tot villa of boerderij. Toont de transitie van militaire bezetting naar civiele bewoning. Het kamp dateert uit de veroveringsperiode toen Rome dit gebied inlijfde. Na pacificatie was een fort niet meer nodig en werd het terrein civiel benut. Vondsten: vroege Romeinse militaria naast later agrarisch materiaal. Zuid-Limburg was een grenszone voordat de Limes naar de Rijn verplaatste.",watWasHier:"Eerst legerkamp, later villa/boerderij. Overgang militair naar civiel.",watTeZien:"Locatie in landbouwgebied.",verwachteVondsten:"Vroege militaria, later agrarisch aardewerk, bouwmateriaal.",betekenis:"Toont Romeinse verovering en pacificatie van Zuid-Limburg.",bronnen:[]},"Castellum Blariacum":{naam:"Blariacum",latinNaam:"Blariacum",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Mogelijke locatie van het Romeinse castellum Blariacum bij Blerick (nu deel van Venlo). De naam leeft voort in de plaatsnaam. Het fort zou de Maasovergang hebben bewaakt op de route tussen Xanten en Maastricht. De exacte locatie is nooit definitief vastgesteld ondanks vele opgravingspogingen. Vondsten in de omgeving wijzen wel op Romeinse militaire aanwezigheid: militaria, munten, aardewerk. Het Limburgs Museum in Venlo toont de Romeinse geschiedenis van de regio.",watWasHier:"Vermoedelijk castellum bij Maasovergang. Exacte locatie onzeker.",watTeZien:"Locatie niet vastgesteld. Limburgs Museum Venlo.",verwachteVondsten:"Militaria, munten, aardewerk als aanwijzingen voor fortlocatie.",betekenis:"Plaatsnaam Blerick afgeleid van Blariacum. Schakel in Maasroute.",bronnen:[]},"Fortificatie Bodegraven":{naam:"Wachtpost Bodegraven",type:"wachttoren",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Waarschijnlijke Romeinse wachtpost bij Bodegraven aan de Oude Rijn. Onderdeel van het signaleringssysteem tussen de grotere forten zoals Nigrum Pullum en Laurum. De wachttorens stonden om de paar kilometer en konden met vuur- of rooksignalen waarschuwingen doorgeven. Kleine bezetting van 4-8 soldaten. De exacte locatie is niet precies bekend. Bij graafwerkzaamheden in Bodegraven zijn wel Romeinse scherven gevonden die op aanwezigheid wijzen.",watWasHier:"Kleine wachtpost voor signalering. 4-8 soldaten.",watTeZien:"Exacte locatie onbekend.",verwachteVondsten:"Aardewerk, kleine hoeveelheden militaria.",betekenis:"Onderdeel communicatiesysteem langs de Limes.",bronnen:[]},Caestert:{naam:"Caestert",type:"versterking",periode:"1e eeuw v.Chr.",beschrijving:"Mogelijk de locatie waar de Eburonen onder leiding van Ambiorix in 54 v.Chr. een Romeins legioen vernietigden - de zwaarste Romeinse nederlaag in de Lage Landen. Het plateau van Caestert bij Kanne (Belgisch Limburg) had een oppidum (versterkte nederzetting). Julius Caesar beschrijft de slag in zijn Gallische Oorlogen. De locatie is omstreden, maar Caestert is een sterke kandidaat. Symbolisch belangrijke plek voor de Belgische geschiedenis. De site is nu natuurgebied met grotten.",watWasHier:"Mogelijk slagveld Ambiorix-opstand 54 v.Chr. Oppidum (versterking).",watTeZien:"Plateau Caestert, natuurgebied met grotten.",verwachteVondsten:"Keltische en vroeg-Romeinse voorwerpen, mogelijk slagveldvondsten.",betekenis:"Mogelijke locatie grootste Romeinse nederlaag in de regio.",bronnen:[]},"Castellum Driel?":{naam:"Castellum Driel",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:'Mogelijke locatie van een Romeins castellum bij Driel in de Betuwe. Het bestaan en de exacte locatie zijn onzeker, vandaar het vraagteken. De Betuwe (Insula Batavorum - "Eiland der Bataven") was kerngebied van de Bataven, bondgenoten van Rome. Zij leverden beroemde hulptroepen aan het Romeinse leger. Een fort hier zou logisch zijn om het gebied te controleren. Vondsten in de omgeving wijzen op Romeinse aanwezigheid. Museum Het Valkhof Nijmegen toont de Bataafse cultuur.',watWasHier:"Mogelijk castellum in Bataafs kerngebied. Bestaan onzeker.",watTeZien:"Geen zichtbare resten. Museum Het Valkhof.",verwachteVondsten:"Romeinse en Bataafse voorwerpen indien locatie juist.",betekenis:"Zou Romeinse controle over Bataafs gebied tonen.",bronnen:[]},"Castellum Duiven - Loowaard":{naam:"Duiven-Loowaard",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeins castellum bij Duiven/Loowaard aan de Rijn, in de uiterwaarden tussen Arnhem en Zevenaar. Het fort bewaakte de rivierroute en de overgang naar het Bataafse gebied. De dynamische rivier heeft veel resten weggespoeld of diep begraven. Bij lage waterstanden en na erosie komen soms vondsten aan oppervlakte: munten, militaria, aardewerk. Het gebied is nu natuurgebied met grazende grote grazers. Museum Arnhem en Het Valkhof Nijmegen tonen vondsten uit de regio.",watWasHier:"Castellum aan de Rijn in uiterwaarden. Bewaakte rivierovergang.",watTeZien:"Natuurgebied. Na erosie mogelijk vondsten aan oppervlakte.",verwachteVondsten:"Militaria, munten, aardewerk na erosie of bij laag water.",betekenis:"Onderdeel fortenketen langs de Rijn.",bronnen:[]},"Castellum Grinnes":{naam:"Grinnes",latinNaam:"Grinnes",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeins castellum bij Rossum in de gemeente Maasdriel - waarschijnlijk het antieke Grinnes vermeld op de Peutingerkaart. Het fort lag aan de Waal en controleerde de rivierroute. Bij opgravingen zijn resten van het fort gevonden. De omgeving is rijk aan Romeinse vondsten: militaria, munten, aardewerk, bouwmateriaal. Het Museum voor de Bommelerwaard in Ammerzoden toont lokale vondsten. De naam Grinnes leeft niet voort in moderne plaatsnamen.",watWasHier:"Castellum aan de Waal. Vermeld op Peutingerkaart.",watTeZien:"Locatie opgegraven. Museum Bommelerwaard.",verwachteVondsten:"Militaria, munten, aardewerk, bouwmateriaal.",betekenis:"Verbinding antieke bronnen met archeologische locatie.",bronnen:[]},"Wachttoren Heumen":{naam:"Wachttoren Heumen",type:"wachttoren",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeinse wachttoren bij Heumen ten zuiden van Nijmegen. Onderdeel van het signaleringssysteem langs de Maas en verbindingswegen. De torens stonden op strategische punten met goed uitzicht. Bij nadering van vijanden werden signalen gegeven naar de grotere forten. Kleine bezetting van 4-8 soldaten die in de toren woonden. De exacte locatie is archeologisch vastgesteld. Vondsten: militaria, aardewerk, persoonlijke bezittingen.",watWasHier:"Signaleertoren met klein garnizoen. Uitzichtpunt.",watTeZien:"Locatie bekend maar geen zichtbare resten.",verwachteVondsten:"Militaria, aardewerk, kleine persoonlijke voorwerpen.",betekenis:"Onderdeel communicatienetwerk Romeins leger.",bronnen:[]},"Castellum Huissen?":{naam:"Castellum Huissen",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Mogelijke locatie van een Romeins castellum bij Huissen aan de Rijn. Het bestaan is niet zeker vastgesteld, vandaar het vraagteken. Huissen ligt op een logische plek tussen de bekende forten bij Arnhem en Zevenaar. Vondsten in de omgeving wijzen op Romeinse activiteit. De moderne bebouwing maakt onderzoek lastig. Als er een fort was, bewaakte het de rivierroute en mogelijk een oversteekplaats.",watWasHier:"Mogelijk castellum aan de Rijn. Bestaan onzeker.",watTeZien:"Geen resten zichtbaar. Gebied bebouwd.",verwachteVondsten:"Romeinse vondsten die fortaanwezigheid zouden bevestigen.",betekenis:"Zou gat in fortenketen opvullen indien bevestigd.",bronnen:[]},"Castellum Kessel-Lith":{naam:"Kessel-Lith",type:"castellum",periode:"3e - 4e eeuw n.Chr.",beschrijving:"Laat-Romeins castellum uit de 3e-4e eeuw bij Kessel-Lith aan de Maas. Gebouwd in een periode van Germaanse invallen toen de oude Limes niet meer te handhaven was. Dit type forten was compacter en zwaarder versterkt dan de vroege castella. De locatie bij een rivierovergang bleef strategisch. Typische laat-Romeinse vondsten: gordels met riemtongen, militaire gespen, munten van 3e-4e eeuwse keizers. Het fort toont de veranderde militaire strategie van het late Romeinse Rijk.",watWasHier:"Laat-Romeins fort, compacter en zwaarder versterkt.",watTeZien:"Locatie bekend, weinig zichtbaar.",verwachteVondsten:"Laat-Romeinse munten, gordelbeslag, riemtongen, 3e-4e eeuws aardewerk.",betekenis:"Toont Romeinse aanpassing aan nieuwe dreigingen.",bronnen:[]},Carvo:{naam:"Carvo",latinNaam:"Carvo",type:"versterking",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Mogelijke Romeinse versterking nabij Kesteren in de Betuwe. De naam komt voor op de Peutingerkaart. Kesteren lag in het hart van het Bataafse stamgebied. De Bataven waren belangrijke bondgenoten van Rome en leverden beroemde cavalerie-eenheden. Een versterking hier zou zowel bescherming als controle bieden. De exacte locatie is niet vastgesteld. Vondsten in de regio tonen intensief Romeins-Bataafs contact: import-aardewerk, wapens, paardentuig.",watWasHier:"Vermoedelijke versterking in Bataafs kerngebied.",watTeZien:"Locatie onbekend.",verwachteVondsten:"Gemengd Romeins-Bataafse voorwerpen, paardentuig.",betekenis:"Zou Romeinse aanwezigheid in Bataafs gebied tonen.",bronnen:[]},Mannaricium:{naam:"Mannaricium",latinNaam:"Mannaricium",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Vermoedelijke locatie van het Romeinse castellum Mannaricium bij Maurik aan de Rijn. De naam komt voor op de Peutingerkaart. Het fort zou de rivierroute hebben bewaakt tussen Levefanum (Wijk bij Duurstede) en forten stroomopwaarts. De moderne plaats Maurik zou afgeleid kunnen zijn van Mannaricium. Bij bouwwerkzaamheden zijn Romeinse vondsten gedaan die op een fort wijzen. De exacte contouren zijn niet bekend.",watWasHier:"Vermoedelijk castellum aan de Rijn. Vermeld op Peutingerkaart.",watTeZien:"Geen zichtbare resten. Gebied bebouwd.",verwachteVondsten:"Militaria, aardewerk, munten bij bouwwerkzaamheden.",betekenis:"Mogelijke herkomst plaatsnaam Maurik.",bronnen:[]},Oostvoorne:{naam:"Castellum Oostvoorne",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeins kustfort bij de monding van de Waal en Maas, nu verdwenen in zee door kustafslag. Het fort bewaakte de zeeroute en beschermde tegen piraterij. De kust lag in de Romeinse tijd kilometers verder westwaarts. Door zeespiegelstijging en erosie is het fort in de golven verdwenen. Na stormen spoelen soms vondsten aan op de stranden van Voorne-Putten: munten, aardewerk, metalen voorwerpen. De Brittenburg bij Katwijk was een soortgelijk lot beschoren.",watWasHier:"Kustfort bij riviermonding. Bewaking zeeroute.",watTeZien:"Fort verdwenen in zee. Soms strandvondsten na stormen.",verwachteVondsten:"Na stormen: munten, aardewerk, metalen op strand.",betekenis:"Toont voormalige kustlijn en Romeinse kustverdediging.",bronnen:[]},"Castellum Randwijk":{naam:"Castellum Randwijk",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Mogelijke locatie van een Romeins castellum bij Randwijk aan de Rijn in de Betuwe. Het bestaan en de exacte locatie zijn onzeker. De rivier heeft veel oude resten weggespoeld. Randwijk ligt tussen bekende fortlocaties wat een fort hier logisch zou maken. In de uiterwaarden zijn bij erosie Romeinse vondsten gedaan. Het dynamische rivierlandschap maakt onderzoek lastig maar kan ook vondsten blootleggen na hoog water.",watWasHier:"Mogelijk castellum. Bestaan en locatie onzeker.",watTeZien:"Geen zichtbare resten. Uiterwaarden.",verwachteVondsten:"Mogelijk vondsten na erosie of hoog water.",betekenis:"Zou gat in fortenketen opvullen indien bevestigd.",bronnen:[]},"Versterking Scheveningseweg":{naam:"Minifort Scheveningseweg",type:"minifort",periode:"2e eeuw n.Chr.",beschrijving:"Vermoede locatie van een klein Romeins kustfort bij de Scheveningseweg in Den Haag, vergelijkbaar met het nabije Minifort Ockenburg. Dit type miniforten bewaakte de kust tegen piraten en Germaanse raids over zee. Ruimte voor 20-30 soldaten. De exacte locatie is niet vastgesteld maar vondsten in de omgeving suggereren Romeinse militaire aanwezigheid. Het zou aantonen dat de gehele Noordzeekust werd bewaakt, niet alleen de riviermonding.",watWasHier:"Vermoedelijk klein kustfort zoals Ockenburg. 20-30 soldaten.",watTeZien:"Locatie niet vastgesteld.",verwachteVondsten:"Militaria, aardewerk 2e eeuw indien locatie gevonden.",betekenis:"Zou Romeinse kustverdediging Den Haag bevestigen.",bronnen:[]},"Tongeren - Sacramentstraat":{naam:"Atuatuca Tungrorum",latinNaam:"Atuatuca Tungrorum / Municipium Tungrorum",type:"legerkamp",periode:"ca. 10 v.Chr. - 400 n.Chr.",beschrijving:"Oudste stad van Belgi, gesticht ca. 10 v.Chr. Hoofdstad van de Civitas Tungrorum - met 150 hectare de grootste civitas van Noordwest-Europa! Strategisch gelegen op de weg Boulogne-Bavay-Keulen. Onder keizer Trajanus (2e eeuw) ommuurd met meer dan 4,5 km muren en tot 3 grachten - waarvan nog 1,5 km staat! Een 1e-eeuwse buste van Julius Caesar is een topstuk. Het Gallo-Romeins Museum (Europees Museum van het Jaar 2011) toont een schat aan vondsten: beelden, steles, sieraden, architectuurelementen. Ook de Romeinse muren, het tempelcomplex, het aquaduct van Beukenberg en tumuli zijn te bezoeken.",watWasHier:"Civitas-hoofdstad Tungri (150 ha). 4,5 km stadsmuur. Politiek en religieus centrum.",watTeZien:"Gallo-Romeins Museum. Romeinse muren (1,5 km). Tempelcomplex. Aquaduct Beukenberg. Tumuli.",verwachteVondsten:"Stadsaardewerk, bouwmateriaal, munten, inscripties, religieuze objecten.",betekenis:"Oudste stad van Belgi. Grootste civitas van Noordwest-Europa.",bronnen:["https://www.galloromeinsmuseum.be","https://www.canonvanvlaanderen.be/en/events/tongeren-a-roman-town/"]},"Valkenburg-Marktveld, mini-castellum":{naam:"Marktveld Valkenburg",type:"minifort",periode:"1e - 2e eeuw n.Chr.",beschrijving:"Klein Romeins castellum met wachttoren bij het Marktveld in Valkenburg (Zuid-Holland), nabij het grotere Praetorium Agrippinae. Dit type miniforten vulde de ruimtes tussen de grote castella op. Wachttoren voor signalering en kleine bezetting voor patrouilles. De combinatie van toren en klein fort was effectief voor grensbewaking. Bij opgravingen zijn de contouren vastgesteld. Vondsten in Archeologisch Steunpunt Valkenburg.",watWasHier:"Klein fort met wachttoren. Aanvulling op Praetorium Agrippinae.",watTeZien:"Archeologisch Steunpunt Valkenburg.",verwachteVondsten:"Militaria, aardewerk, kleine persoonlijke voorwerpen.",betekenis:"Toont gelaagdheid Romeinse grensverdediging.",bronnen:[]},"Wachttoren a":{naam:"Wachttoren Utrecht-West",type:"wachttoren",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Een van meerdere Romeinse wachttorens in de omgeving van Utrecht, onderdeel van het signaleringssysteem langs de Limes. De torens stonden om de 1-2 kilometer met zicht op elkaar. Bij nadering van vijanden werden vuur- of rooksignalen gegeven. Binnen minuten kon de hele grens gewaarschuwd zijn. Kleine houten constructie op aarden verhoging met bezetting van 4-8 soldaten. Vondsten zijn schaars door de kleine schaal.",watWasHier:"Houten signaleertoren. 4-8 soldaten.",watTeZien:"Geen zichtbare resten.",verwachteVondsten:"Kleine hoeveelheden aardewerk en militaria.",betekenis:"Onderdeel vroegwaarschuwingssysteem.",bronnen:[]},"Wachttoren b":{naam:"Wachttoren Utrecht-Oost",type:"wachttoren",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeinse wachttoren ten oosten van Utrecht, onderdeel van de keten signaleertorens langs de Rijn. Elke toren had zichtlijn naar de volgende. Dit systeem maakte snelle communicatie mogelijk in een tijd zonder telegraaf of telefoon. De soldaten woonden in of bij de toren en hielden permanent wacht. Bij gevaar werden brandende fakkels of rookpotten gebruikt. De locatie is archeologisch vastgesteld maar niet zichtbaar.",watWasHier:"Signaleertoren in torenketen. Permanente wacht.",watTeZien:"Geen zichtbare resten.",verwachteVondsten:"Aardewerk, militaria, persoonlijke bezittingen.",betekenis:"Onderdeel communicatienetwerk Limes.",bronnen:[]},"Wachttoren c":{naam:"Wachttoren Hoge Woerd",type:"wachttoren",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeinse wachttoren nabij Castellum Op de Hoge Woerd, onderdeel van het signaleringssysteem. Torens bij forten dienden als vooruitgeschoven posten en waarschuwingsplaatsen. De combinatie van fort met omringende torens was de standaard Romeinse grensverdediging. Het Archeologisch Park Hoge Woerd geeft een goed beeld van hoe dit systeem functioneerde. De toren zelf is niet gereconstrueerd maar de context is te begrijpen.",watWasHier:"Signaleertoren bij castellum. Vooruitgeschoven post.",watTeZien:"Archeologisch Park Hoge Woerd toont context.",verwachteVondsten:"Aardewerk, militaria.",betekenis:"Toont samenhang fort en torens.",bronnen:[]},"Zwammerdam-Rijksstraatweg":{naam:"Zwammerdam-Rijksstraatweg",type:"versterking",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Mogelijke militaire nederzetting aan de Rijksstraatweg in Zwammerdam, naast het bekende Nigrum Pullum fort. Mogelijk een vicus (burgerdorp) of aparte militaire faciliteit. Bij Zwammerdam werden de beroemde Romeinse schepen gevonden. De hele zone langs de Oude Rijn was dicht bezet met militaire en civiele structuren. Vondsten wijzen op intensieve Romeinse activiteit: aardewerk, munten, militaria en door de natte veenbodem ook organisch materiaal.",watWasHier:"Mogelijk vicus of militaire faciliteit nabij Nigrum Pullum.",watTeZien:"Geen zichtbare resten.",verwachteVondsten:"Aardewerk, munten, militaria, organisch materiaal.",betekenis:"Toont dichtheid Romeinse bewoning langs Oude Rijn.",bronnen:[]},"Kastell Aachen":{naam:"Aquae Granni",latinNaam:"Aquae Granni",type:"versterking",periode:"1e - 4e eeuw n.Chr.",beschrijving:'Romeinse kuuroord bij de hete bronnen (tot 75C!) gewijd aan Apollo en de Keltische geneesheer Grannos - "aan de wateren van Grannos". In de 1e eeuw uitgebouwd tot kurort voor de legioenen van Neder-Germani. Onder keizer Trajanus bouwden legioenen uit Xanten een aquaduct en thermen onder de huidige Dom. De Mnsterthermen hadden de indeling van een valetudinarium (Romeins hospitaal). Karel de Grote bouwde hier zijn Pfalz (793-813) en maakte Aken tot keizerlijke residentie - bewust als "vernieuwer van het Romeinse Rijk". De Dom (UNESCO 1978, eerste in Duitsland!) staat op Romeinse fundamenten. Karel stierf hier in 814.',watWasHier:"Kurort voor legioenen. Thermen. Later keizerlijke Pfalz van Karel de Grote.",watTeZien:"Dom (UNESCO). Centre Charlemagne. Thermen onder de stad.",verwachteVondsten:"Badhuisresten, inscripties, munten, Romeins en Karolingisch bouwmateriaal.",betekenis:"Ononderbroken bewoning van Romeinse tijd tot Karel de Grote. Eerste UNESCO-site Duitsland.",bronnen:["https://centre-charlemagne.eu/zeitreise/?lang=en","http://www.aquaegranni.de/","https://de.wikipedia.org/wiki/Aquae_Granni"]},Hazerswoude:{naam:"Hazerswoude-Rijndijk",type:"wachttoren",periode:"2e - 3e eeuw n.Chr.",beschrijving:"Bevestigde Romeinse wachtpost langs de Limesweg bij Hazerswoude-Rijndijk. Bij opgravingen in 2021-2023 door Vestigia BV en het Rijksmuseum van Oudheden zijn spectaculaire vondsten gedaan: resten van de houten Limesweg (eiken palen uit 124-125 n.Chr.), een Romeinse dam, en aanwijzingen voor een kleine wachtpost. Bijzondere vondsten: de eerste Romeinse mijlpaal in Nederland (2023), een muntschat met 22 zilveren munten (na 166 n.Chr.), aardewerk, mantelspelden, leren schoenzolen en ca. 40.000-50.000 objecten. De locatie ligt precies tussen Albaniana (Alphen) en Matilo (Leiden).",watWasHier:"Wachtpost langs de Limesweg. Houten wegdek uit 124-125 n.Chr.",watTeZien:"Opgravingen afgerond. Vondsten naar Rijksmuseum van Oudheden.",verwachteVondsten:"Militaria, munten, aardewerk. Gebied grotendeels onderzocht.",betekenis:"Eerste Romeinse mijlpaal in Nederland. Bevestigt trac Limesweg.",bronnen:["https://www.rmo.nl/onderzoek/opgravingsprojecten/hazerswoude/","https://www.vestigia.nl/opgraving-hazerswoude-in-samenwerking-met-het-rijksmuseum-van-oudheden-en-de-gemeente-alphen-aan-den-rijn/","https://romeinsalphen.nl/themas/romeinse-weg-hazerswoude-rijndijk"]},Albaniana:{naam:"Albaniana",latinNaam:"Albaniana",type:"castellum",periode:"41 - 275 n.Chr.",beschrijving:"Groot Romeins castellum bij Alphen aan den Rijn, een van de belangrijkste forten aan de Nederlandse Limes. Het fort werd gesticht in 41-42 n.Chr., kort na de dood van keizer Caligula. De locatie is nauwkeurig bekend: bij het Rijnplein en Theater Castellum aan de Castellumstraat. Het fort (80x120m) was beschermd door een omgrachte aarden wal. Bij opgravingen tussen 1950 en 2002 zijn uitgebreide resten gevonden. Door de natte bodem zijn veel houten structuren bewaard gebleven. Een bronzen maquette van het castellum staat op het Rijnplein.",watWasHier:"Castellum met vicus. Locatie bekend: Rijnplein/Castellumstraat.",watTeZien:"Bronzen maquette Rijnplein. Theater Castellum op fortlocatie. Archeon.",verwachteVondsten:"Munten, militaria, aardewerk, dakpannen, fibulae. Veel bij bouwwerkzaamheden.",betekenis:"Een van de hoofdforten aan de Limes. UNESCO Werelderfgoed.",bronnen:["https://www.hierisalphen.nl/home/ontdekken/romeinse-limes","https://www.romeinen.nl/weten/nederland-in-de-romeinse-tijd/zuid-holland/alphen-aan-den-rijn","https://archeologiehuiszuidholland.nl/zien-en-doen/het-archeologiehuis/fort-aan-de-rijn"]}},TSt={naam:"Romeins fort",type:"versterking",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeinse militaire versterking langs de Limes, de noordgrens van het Romeinse Rijk. Forten lagen om de 10-15 km langs de Rijn. Garnizoen van hulptroepen (auxilia) die de grens bewaakten tegen Germaanse invallen. Standaard rechthoekige plattegrond met houten of stenen muur, gracht, poorten en binnengebouwen (barakken, commandopost, graanopslagplaats, werkplaatsen). Buiten de muren vaak een vicus (burgerdorp) met handelaren en soldatenfamilies. Vondsten: munten, fibulae (mantelspelden), aardewerk, wapens, gereedschap. Onderdeel van UNESCO Werelderfgoed sinds 2021."},kSt={castellum:"Castellum (legerplaats)",wachttoren:"Wachttoren (signaalpost)",vlootbasis:"Vlootbasis (haven)",legerkamp:"Legerkamp (castra)",minifort:"Minifort (wachtpost)",versterking:"Versterking",villa:"Villa (militair gebruikt)"};lr.defs("EPSG:28992","+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m +no_defs");function fae(t){if(!t)return t;const e={Mo:"ma",Tu:"di",We:"wo",Th:"do",Fr:"vr",Sa:"za",Su:"zo",Mon:"ma",Tue:"di",Wed:"wo",Thu:"do",Fri:"vr",Sat:"za",Sun:"zo",PH:"feestdagen",SH:"schoolvakantie"};let n=t;return Object.entries(e).forEach(([r,i])=>{n=n.replace(new RegExp(`\\b${r}\\b`,"gi"),i)}),n=n.replace(/\boff\b/gi,"gesloten").replace(/\bclosed\b/gi,"gesloten").replace(/\bopen\b/gi,"open"),n}async function ASt(t){try{const e=Fn(t),n=lr("EPSG:4326","EPSG:28992",e);if(n[0]<7e3||n[0]>3e5||n[1]<289e3||n[1]>629e3)return null;const r=1,s=`https://service.pdok.nl/rws/ahn/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=dtm_05m&QUERY_LAYERS=dtm_05m&INFO_FORMAT=application/json&CRS=EPSG:28992&BBOX=${`${n[0]-r},${n[1]-r},${n[0]+r},${n[1]+r}`}&WIDTH=1&HEIGHT=1&I=0&J=0`,a=await(await fetch(s)).json();if(a.features&&a.features.length>0){const l=a.features[0].properties,c=l?.value_list??l?.GRAY_INDEX??l?.value??l?.gray_index;if(c!=null){const u=typeof c=="number"?c:parseFloat(c);if(!isNaN(u))return u}}}catch(e){console.warn("AHN height query failed:",e)}return null}const ISt={ABG:"Alphen-Chaam",ACM:"Alkmaar",ALF:"Alfen",ALK:"Alkemade",AML:"Ameland",AMR:"Amerongen",AMS:"Amsterdam",ANL:"Anloo",APD:"Apeldoorn",ARN:"Arnhem",ASN:"Assen",AVW:"Avenhorn",BDA:"Breda",BLK:"Blokker",BRN:"Barneveld",DEL:"Delft",DHG:"Den Haag",DRD:"Dordrecht",EHV:"Eindhoven",EMN:"Emmen",EPE:"Epe",GNP:"Gennep",GRN:"Groningen",GRV:"Grave",GTB:"Giethoorn",HDK:"Harderwijk",HLM:"Haarlem",HLN:"Heiloo",HRL:"Harlingen",HTN:"Houten",LDN:"Leiden",LWR:"Leeuwarden",MST:"Maastricht",NKK:"Nijkerk",NMG:"Nijmegen",OTM:"Ootmarsum",RTD:"Rotterdam",SND:"Sneek",TBG:"Tilburg",UTR:"Utrecht",VLO:"Venlo",WGN:"Wageningen",ZWL:"Zwolle",ZTP:"Zutphen",444:"Houten",811:"Gouda",310:"Utrecht",344:"Amsterdam",363:"Rotterdam",518:"Den Haag",758:"Eindhoven",772:"Tilburg",855:"Breda",85:"Arnhem",268:"Nijmegen",14:"Groningen",80:"Leeuwarden",995:"Maastricht",106:"Enschede",153:"Zwolle",34:"Almere"},PSt={1:"Zeer lage trefkans op archeologische resten",2:"Lage trefkans op archeologische resten",3:"Middelhoge trefkans op archeologische resten",4:"Hoge trefkans op archeologische resten",5:"Lage trefkans (water)",6:"Middelhoge trefkans (water)",7:"Hoge trefkans (water)",8:"Water",9:"Niet gekarteerd"};function pae(t,e){const n=[],r=t.toLowerCase(),i=(e||"").toLowerCase();return r.includes("kalkhoudend")||i.endsWith("a")?n.push("Kalkhoudend = goede metaalconservering"):(r.includes("kalkarm")||r.includes("kalkloos"))&&n.push("Kalkarm = meer corrosie op metalen"),r.includes("poldervaag")?n.push("Poldervaaggrond = jonge rivierklei, ingepolderd gebied"):r.includes("enkeerdgrond")||r.includes("enk")?n.push("Enkeerdgrond = oude akkers met plaggenbemesting - archeologisch interessant!"):r.includes("podzol")?n.push("Podzolgrond = uitgeloogde zandgrond, vaak zuur"):(r.includes("veengrond")||r.includes("veen"))&&n.push("Veengrond = zuur, slechte metaalconservering (tenzij waterverzadigd)"),r.includes("zware klei")?n.push("Zware klei = moeilijk graven, goede conservering"):r.includes("lichte klei")||r.includes("zavel")?n.push("Zavel/lichte klei = redelijk te graven"):r.includes("zand")&&!r.includes("zavel")&&n.push("Zandgrond = makkelijk graven"),r.includes("rivierklei")||i.startsWith("r")?n.push("Rivierafzetting"):(r.includes("zeeklei")||i.startsWith("m"))&&n.push("Zeekleiafzetting"),n}function CSt(){const t=gi(bt=>bt.map),e=mh(bt=>bt.removeVondst),n=mh(bt=>bt.updateVondst),r=mh(bt=>bt.vondsten),{layers:i,addPoint:s,addLayer:o}=ps(),[a,l]=Y.useState([]),[c,u]=Y.useState(0),[h,f]=Y.useState(!1),[g,y]=Y.useState(null),[_,b]=Y.useState(!1),[T,A]=Y.useState(!1),[I,P]=Y.useState(null),[R,D]=Y.useState(null),[C,M]=Y.useState(null),[O,j]=Y.useState(null),[V,U]=Y.useState(!1),[G,de]=Y.useState(null),[Ie,ze]=Y.useState(null),[Ne,fe]=Y.useState(null),[De,Ce]=Y.useState(!1),[Q,W]=Y.useState(""),[ne,ie]=Y.useState([]),le=ne[c]||null,[ve,qe]=Y.useState(()=>{const bt=localStorage.getItem("popupTextScale");return bt?parseInt(bt):100}),[Ke,Se]=Y.useState("half"),we=bt=>{qe(bt),localStorage.setItem("popupTextScale",bt.toString())},Dt=a[c]||"",Ye=a.length>1,on=bt=>{const Qn=bt.match(/<strong[^>]*>(.*?)<\/strong>/);if(Qn){const dr=Qn[1].replace(/<[^>]+>/g,""),Ft=bt.replace(Qn[0],"").replace(/^(<br\s*\/?>)+/,"");return{title:dr,contentWithoutTitle:Ft}}return{title:"",contentWithoutTitle:bt}},jt=bt=>bt.replace(/class="([^"]*)"/g,(dr,Ft)=>{if(Ft.includes("text-xs")){const jn=Ft.replace(/\btext-xs\b/g,"").trim();return jn?`style="font-size:0.857em" class="${jn}"`:'style="font-size:0.857em"'}if(Ft.includes("text-sm")){const jn=Ft.replace(/\btext-sm\b/g,"").trim();return jn?`class="${jn}"`:""}return dr}).replace(/class=""/g,""),{title:pn,contentWithoutTitle:_n}=on(Dt),dt=jt(_n),hr=Dt.includes("Landbouwperceel"),zn=Dt.includes("data-vondst-id="),Wn=()=>{u(bt=>(bt-1+a.length)%a.length)},ei=()=>{u(bt=>(bt+1)%a.length)},_o=async()=>{if(console.log(" HOOGTEKAART KNOP GEKLIKT"),console.log(" parcelCoordinate uit state:",g),!t||!g||T){console.log(" STOP - map:",!!t,"coord:",g,"loading:",T);return}console.log(` DOORGEVEN AAN showParcelHeightMap: [${g[0]}, ${g[1]}]`),A(!0);try{await O1t(t,g)&&b(!0)}catch(bt){console.error("Failed to load height map:",bt)}finally{A(!1)}},Cr=()=>{t&&(Dz(t),b(!1))};Y.useEffect(()=>{if(!t)return;const bt=Ft=>{let jn='<strong class="text-purple-800">AMK Monument</strong>';if(Ft.toponiem&&(jn+=`<br/><span class="text-sm font-semibold">${Ft.toponiem}</span>`),Ft.kwaliteitswaarde&&(jn+=`<br/><span class="text-sm text-purple-700">${Ft.kwaliteitswaarde}</span>`),Ft.omschrijving&&(jn+=`<br/><span class="text-xs text-gray-600 mt-1 block">${Ft.omschrijving}</span>`),Ft.txt_label){const en=Ft.txt_label.split(", ").slice(0,3).join(", ");jn+=`<br/><span class="text-xs text-gray-500 italic">${en}${Ft.txt_label.split(", ").length>3?"...":""}</span>`}return jn},Qn=async(Ft,jn)=>{const en=[],$o=t.getLayers().getArray().filter(Gi=>Gi instanceof Nm&&Gi.getVisible()?Gi.getSource()instanceof HCe:!1);for(const Gi of $o){const Ds=Gi.getSource();if(!Ds)continue;const Nn=Gi.get("title")||"";if(Nn.startsWith("Paleokaart"))continue;if(Nn==="Archeo Landschappen"){try{const He=Fn(Ft),ke=lr("EPSG:4326","EPSG:28992",He),Ae=100,z=`https://services.rce.geovoorziening.nl/landschappenkaart/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=landschappenkaart_nl&QUERY_LAYERS=landschappenkaart_nl&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ke[0]-Ae},${ke[1]-Ae},${ke[0]+Ae},${ke[1]+Ae}`}`,X=await(await fetch(z)).json();if(X.features&&X.features.length>0){const ae=X.features[0].properties,Ve=ae.landschapsnaam||ae.naam||"Archeologisch Landschap",ee=ae.omschrijving||"";let ge=`<strong class="text-green-800">${Ve}</strong>`;ee&&(ge+=`<br/><span class="text-sm text-gray-600">${ee}</span>`),ge+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',ge+='<div class="text-sm text-gray-700 mt-1">Een archeologisch landschap is een gebied waar het landschap nog sporen draagt van menselijke activiteit uit het verleden. Denk aan oude akkers, nederzettingen of verdedigingswerken.</div>',ge+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',ge+='<div class="text-sm text-gray-700 mt-1">Aardewerk, munten, gereedschap en andere voorwerpen van vroegere bewoners. De kans op vondsten hangt af van het type landschap.</div>',ge+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',ge+='<div class="text-sm text-gray-700 mt-1"><a href="https://www.cultureelerfgoed.nl/onderwerpen/bronnen-en-kaarten/overzicht/landschappenkaart" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">RCE Landschappenkaart</a></div>',ge+='<div class="text-sm text-gray-700 mt-1"><a href="https://nl.wikipedia.org/wiki/Landschapstypen_van_Nederland" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia: Landschapstypen</a></div>',en.push(ge)}}catch(He){console.warn("Archeo Landschappen WMS query failed:",He)}continue}if(Nn==="Essen"){try{const He=Fn(Ft),ke=lr("EPSG:4326","EPSG:28992",He),Ae=100,z=`https://services.rce.geovoorziening.nl/landschapsatlas/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=essen&QUERY_LAYERS=essen&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ke[0]-Ae},${ke[1]-Ae},${ke[0]+Ae},${ke[1]+Ae}`}`,X=await(await fetch(z)).json();if(X.features&&X.features.length>0){const ae=X.features[0].properties;let Ve='<strong class="text-amber-800">Es (historisch akkercomplex)</strong>';(ae.naam||ae.Naam||ae.NAME)&&(Ve+=`<br/><span class="text-sm font-semibold text-amber-700">${ae.naam||ae.Naam||ae.NAME}</span>`),(ae.type||ae.Type||ae.TYPE)&&(Ve+=`<br/><span class="text-xs text-gray-600">${ae.type||ae.Type||ae.TYPE}</span>`),(ae.omschrijving||ae.Omschrijving)&&(Ve+=`<br/><span class="text-xs text-gray-500">${ae.omschrijving||ae.Omschrijving}</span>`),Ve+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is een es?</span></div>',Ve+='<div class="text-sm text-gray-700 mt-1">Een es is een oud akkercomplex op hogere zandgronden. Eeuwenlang werden hier gewassen verbouwd. De bodem werd bemest met plaggen en mest, waardoor de grond donker en vruchtbaar werd.</div>',Ve+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',Ve+='<div class="text-sm text-gray-700 mt-1">Munten, gespen, knopen, aardewerk en soms bijzondere voorwerpen die door bemesting op het land terechtkwamen. Essen behoren tot de beste vindplaatsen voor metaaldetectie.</div>',Ve+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Conservering</span></div>',Ve+='<div class="text-sm text-gray-700 mt-1 italic">De zure zandgrond tast metaal aan. IJzer en koper zijn vaak slecht bewaard. Zilver en brons houden zich beter.</div>',Ve+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',Ve+='<div class="text-sm text-gray-700 mt-1"><a href="https://nl.wikipedia.org/wiki/Es_(geografie)" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia: Es (geografie)</a></div>',en.push(Ve)}}catch(He){console.warn("Essen WMS query failed:",He)}continue}if(Nn==="FAMKE Steentijd"){try{const He=Fn(Ft),ke=lr("EPSG:4326","EPSG:28992",He),Ae=`https://geoportaal.fryslan.nl/arcgis/rest/services/Themas/cultuurhistorie/MapServer/2/query?geometry=${ke[0]},${ke[1]}&geometryType=esriGeometryPoint&spatialRel=esriSpatialRelIntersects&outFields=BESCHR,BESCHRTOELICHTING,BESCHRLINK&returnGeometry=false&f=json`,z=await(await fetch(Ae)).json();if(z.features&&z.features.length>0){const Et=z.features[0].attributes;let X='<strong class="text-amber-800">FAMKE Steentijd-Bronstijd</strong>';X+='<br/><span class="text-sm text-gray-500">Friese verwachtingskaart</span>';const ae=Et.BESCHR||"";ae&&(X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Advies</span></div>',X+=`<div class="text-sm text-amber-700 mt-1 font-medium">${ae}</div>`);const Ve=Et.BESCHRTOELICHTING||"";Ve&&(X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Toelichting</span></div>',X+=`<div class="text-sm text-gray-700 mt-1">${Ve}</div>`);const ee=Et.BESCHRLINK||"";ee&&(X+=`<div class="mt-3"><a href="${ee}" target="_blank" rel="noopener noreferrer" class="text-sm text-blue-600 hover:underline">Meer informatie</a></div>`),X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is FAMKE?</span></div>',X+='<div class="text-sm text-gray-700 mt-1">FAMKE is de Friese Archeologische Monumentenkaart Extra. Deze kaart toont waar in Friesland vondsten uit de steentijd en bronstijd te verwachten zijn.</div>',en.push(X)}}catch(He){console.warn("FAMKE Steentijd query failed:",He)}continue}if(Nn==="FAMKE IJzertijd"){try{const He=Fn(Ft),ke=lr("EPSG:4326","EPSG:28992",He),Ae=`https://geoportaal.fryslan.nl/arcgis/rest/services/Themas/cultuurhistorie/MapServer/1/query?geometry=${ke[0]},${ke[1]}&geometryType=esriGeometryPoint&spatialRel=esriSpatialRelIntersects&outFields=BESCHR,BESCHRTOELICHTING,BESCHRLINK&returnGeometry=false&f=json`,z=await(await fetch(Ae)).json();if(z.features&&z.features.length>0){const Et=z.features[0].attributes;let X='<strong class="text-orange-800">FAMKE IJzertijd-Middeleeuwen</strong>';X+='<br/><span class="text-sm text-gray-500">Friese verwachtingskaart</span>';const ae=Et.BESCHR||"";ae&&(X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Advies</span></div>',X+=`<div class="text-sm text-orange-700 mt-1 font-medium">${ae}</div>`);const Ve=Et.BESCHRTOELICHTING||"";Ve&&(X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Toelichting</span></div>',X+=`<div class="text-sm text-gray-700 mt-1">${Ve}</div>`);const ee=Et.BESCHRLINK||"";ee&&(X+=`<div class="mt-3"><a href="${ee}" target="_blank" rel="noopener noreferrer" class="text-sm text-blue-600 hover:underline">Meer informatie</a></div>`),X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is FAMKE?</span></div>',X+='<div class="text-sm text-gray-700 mt-1">FAMKE is de Friese Archeologische Monumentenkaart Extra. Deze kaart toont waar in Friesland vondsten uit de ijzertijd tot en met de middeleeuwen te verwachten zijn.</div>',en.push(X)}}catch(He){console.warn("FAMKE IJzertijd query failed:",He)}continue}if(Nn==="Archeo Onderzoeken"){try{const He=Fn(Ft),ke=lr("EPSG:4326","EPSG:28992",He),Ae=100,z=`https://data.geo.cultureelerfgoed.nl/openbaar/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=archeologische_onderzoeksmeldingen_openbaar_rd&QUERY_LAYERS=archeologische_onderzoeksmeldingen_openbaar_rd&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ke[0]-Ae},${ke[1]-Ae},${ke[0]+Ae},${ke[1]+Ae}`}&FEATURE_COUNT=20`,X=await(await fetch(z)).json();if(X.features&&X.features.length>0)for(const ae of X.features){const Ve=ae.properties,ee=Ve.type_onderzoek||"",ge=Ve.projectnaam||Ve.project_naam||Ve.naam||"",je=ge&&ge!=="-"&&ge.trim()!==""&&!/^\d+$/.test(ge.trim())?ge:"",Je=Ve.gemeente||"",Ge=Ve.uitvoerder||"",nt=Ve.onderzoeksmeldingnummer||"",et=Ve.adres||Ve.straat||"";let Mt="Archeologisch Onderzoek";je?Mt=je:Je&&et?Mt=`${Je} - ${et}`:Je&&(Mt=`Onderzoek ${Je}`);let zt=`<strong class="text-blue-800">${Mt}</strong>`;if(ee&&(zt+=`<br/><span class="text-sm font-semibold text-blue-700">${ee}</span>`),Je&&!Mt.includes(Je)&&(zt+=`<br/><span class="text-sm text-gray-700">${Je}</span>`),et&&!Mt.includes(et)&&(zt+=`<br/><span class="text-sm text-gray-600">${et}</span>`),nt&&(zt+=`<br/><span class="text-xs text-gray-500 font-mono">OM: ${nt}</span>`),Ge&&(zt+=`<br/><span class="text-sm text-gray-700">Uitvoerder: ${Ge}</span>`),Ve.startdatum||Ve.einddatum){const re=[Ve.startdatum,Ve.einddatum].filter(Boolean).join(" - ");zt+=`<br/><span class="text-xs text-gray-600">Periode: ${re}</span>`}const yn=[];Ve.periode_paleolithicum&&yn.push("Paleolithicum"),Ve.periode_mesolithicum&&yn.push("Mesolithicum"),Ve.periode_neolithicum&&yn.push("Neolithicum"),Ve.periode_bronstijd&&yn.push("Bronstijd"),Ve.periode_ijzertijd&&yn.push("IJzertijd"),Ve.periode_romeins&&yn.push("Romeins"),Ve.periode_middeleeuwen&&yn.push("Middeleeuwen"),Ve.periode_nieuwe_tijd&&yn.push("Nieuwe tijd"),yn.length>0&&(zt+=`<br/><span class="text-sm text-purple-700">Datering: ${yn.join(", ")}</span>`),zt+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat betekent dit?</span></div>',ee.toLowerCase().includes("opgraving")?zt+='<div class="text-sm text-gray-700 mt-1">Hier is een archeologische opgraving gedaan. Professionele archeologen hebben vondsten en sporen gedocumenteerd en geborgen.</div>':ee.toLowerCase().includes("bureauonderzoek")?zt+='<div class="text-sm text-gray-700 mt-1">Een bureauonderzoek naar de archeologische verwachting op basis van historische bronnen en kaarten.</div>':ee.toLowerCase().includes("booronderzoek")?zt+='<div class="text-sm text-gray-700 mt-1">Met boringen is onderzocht wat er in de grond zit. Vaak de eerste stap om te bepalen of er verder onderzoek nodig is.</div>':ee.toLowerCase().includes("proefsleuven")?zt+='<div class="text-sm text-gray-700 mt-1">Proefsleuven zijn gegraven om te kijken of er archeologische sporen in de grond zitten.</div>':ee.toLowerCase().includes("begeleiding")?zt+='<div class="text-sm text-gray-700 mt-1">Archeologische begeleiding bij graafwerk. Een archeoloog was aanwezig om te controleren of er vondsten naar boven kwamen.</div>':ee.toLowerCase().includes("inventariserend")||ee.toLowerCase().includes("karterend")?zt+='<div class="text-sm text-gray-700 mt-1">Verkennend onderzoek om te bepalen of er archeologische resten in de grond kunnen zitten.</div>':zt+='<div class="text-sm text-gray-700 mt-1">Op deze locatie is archeologisch onderzoek uitgevoerd. De resultaten zijn opgeslagen in het landelijke archief.</div>',zt+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Interessant voor detectie?</span></div>',zt+='<div class="text-sm text-gray-700 mt-1 italic">Onderzoekslocaties kunnen interessant zijn: archeologen vinden vaak niet alles. Maar check altijd eerst of je daar mag zoeken.</div>',zt+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Rapport opzoeken</span></div>';let q="";if(je?q=je:Ge&&Je?q=`${Ge} ${Je}`:Je&&(q=Je),q){const re=q.length>35?q.substring(0,35)+"...":q;zt+=`<div class="text-sm text-gray-700 mt-1"><a href="https://archaeology.datastations.nl/dataverse/root?q=${encodeURIComponent(q)}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Zoek "${re}" in DANS</a></div>`,zt+=`<div class="text-sm text-gray-700 mt-1"><a href="https://scholar.google.nl/scholar?q=${encodeURIComponent(q+" archeologisch rapport")}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Zoek in Google Scholar</a></div>`}nt&&(zt+=`<div class="text-sm text-gray-700 mt-1"><a href="https://archis.cultureelerfgoed.nl/" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Zoek OM ${nt} in ARCHIS</a> <span class="text-xs text-gray-400">(account nodig)</span></div>`),en.push(zt)}}catch(He){console.warn("Archeo Onderzoeken WMS query failed:",He)}continue}if(Nn==="IKAW"){try{const He=Fn(Ft),ke=lr("EPSG:4326","EPSG:28992",He),Ae=500,z=`https://services.rce.geovoorziening.nl/ikaw/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=IKAW3Indicatievekaartarcheologischewaarden2008&QUERY_LAYERS=IKAW3Indicatievekaartarcheologischewaarden2008&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ke[0]-Ae},${ke[1]-Ae},${ke[0]+Ae},${ke[1]+Ae}`}`,X=await(await fetch(z)).json();if(X.features&&X.features.length>0){const ae=X.features[0].properties,Ve=Math.round(ae.PALETTE_INDEX||ae.palette_index||0),ee=PSt[Ve]||`Trefkans onbekend (${Ve})`;let ge='<strong class="text-orange-800">IKAW Verwachtingskaart</strong>';ge+='<br/><span class="text-sm text-gray-500">Kaart met kansen op archeologische vondsten</span>',ge+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat betekent dit?</span></div>',ge+=`<div class="text-sm text-orange-700 mt-1">${ee}</div>`;const Je={1:{tekst:"De kans op archeologische vondsten is hier zeer klein. De grond is waarschijnlijk verstoord of te jong.",vondsten:"Niet veel te verwachten, maar verrassingen zijn altijd mogelijk.",kleur:"text-gray-600"},2:{tekst:"De kans op vondsten is laag, maar niet uitgesloten. Soms worden hier toch interessante objecten gevonden.",vondsten:"Af en toe losse vondsten uit verschillende periodes.",kleur:"text-yellow-600"},3:{tekst:"Dit is een interessant gebied met een redelijke kans op vondsten. Hier woonden of werkten mensen in het verleden.",vondsten:"Aardewerk, munten, metalen voorwerpen uit verschillende tijdperken.",kleur:"text-amber-600"},4:{tekst:"Dit is een zeer kansrijk gebied! Hier zijn waarschijnlijk resten van oude bewoning of activiteit. Let op: bij graafwerk kan een vergunning nodig zijn.",vondsten:"Grote kans op interessante vondsten: aardewerk, munten, sieraden, gereedschap.",kleur:"text-orange-600"},5:{tekst:"Dit is een waterbodem. Vondsten zijn hier moeilijker te bereiken maar kunnen goed bewaard zijn gebleven.",vondsten:"Scheepswrakken, verloren lading, gedumpte voorwerpen.",kleur:"text-blue-600"},6:{tekst:"Waterbodem met archeologische potentie. Hier kunnen interessante vondsten liggen die door het water goed bewaard zijn.",vondsten:"Scheepsresten, ankers, aardewerk, metalen voorwerpen.",kleur:"text-blue-600"},7:{tekst:"Waterbodem met hoge archeologische waarde. Hier zijn bekende vindplaatsen of scheepswrakken.",vondsten:"Belangrijke maritieme vondsten, beschermd gebied.",kleur:"text-blue-700"}}[Ve];Je&&(ge+=`<div class="text-sm ${Je.kleur} mt-1">${Je.tekst}</div>`,ge+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',ge+=`<div class="text-sm text-gray-700 mt-1">${Je.vondsten}</div>`),ge+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is de IKAW?</span></div>',ge+='<div class="text-sm text-gray-700 mt-1">De IKAW (Indicatieve Kaart Archeologische Waarden) toont de kans op archeologische vondsten in heel Nederland. De kaart is gemaakt door de Rijksdienst voor het Cultureel Erfgoed.</div>',en.push(ge)}}catch(He){console.warn("IKAW WMS query failed:",He)}continue}if(Nn==="Inundatiegebieden"){try{const He=Fn(Ft),ke=lr("EPSG:4326","EPSG:28992",He),Ae=100,z=`https://services.rce.geovoorziening.nl/liniesenstellingen/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=inundaties&QUERY_LAYERS=inundaties&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ke[0]-Ae},${ke[1]-Ae},${ke[0]+Ae},${ke[1]+Ae}`}`,X=await(await fetch(z)).json();if(X.features&&X.features.length>0){const ae=X.features[0].properties;let Ve='<strong class="text-blue-800">Inundatiegebied</strong>';(ae["linie-naam"]||ae.linie_naam)&&(Ve+=`<br/><span class="text-sm font-semibold text-blue-700">${ae["linie-naam"]||ae.linie_naam}</span>`),ae.naam&&(Ve+=`<br/><span class="text-sm text-gray-700">${ae.naam}</span>`),ae.periode&&(Ve+=`<br/><span class="text-xs text-gray-500">${ae.periode}</span>`),ae.lin_period&&(Ve+=`<br/><span class="text-xs text-gray-400">${ae.lin_period}</span>`),en.push(Ve)}}catch(He){console.warn("Inundatiegebieden WMS query failed:",He)}continue}if(Nn==="Militaire Objecten"){try{const He=Fn(Ft),ke=lr("EPSG:4326","EPSG:28992",He),Ae=50,z=`https://services.rce.geovoorziening.nl/liniesenstellingen/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=objecten&QUERY_LAYERS=objecten&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ke[0]-Ae},${ke[1]-Ae},${ke[0]+Ae},${ke[1]+Ae}`}`,X=await(await fetch(z)).json();if(X.features&&X.features.length>0){const ae=X.features[0].properties,Ve=ae.obj_soort||"",ee=ae.obj_naam||"",ge=ae.lin_period||"",je=ae["linie-naam"]||ae.linie_naam||"";let Je=Ve||"Militair Object",Ge="Dit is een historisch militair object uit de Nederlandse verdedigingsgeschiedenis.",nt="";const et=Ve.toLowerCase();et.includes("fort")?(Ge="Een fort is een versterkte verdedigingspost, vaak met dikke muren en geschutsopstellingen. Forten maakten deel uit van grotere verdedigingslinies.",nt="Rond forten worden soms kogels, knopen van uniformen, muntjes of andere militaire voorwerpen gevonden."):et.includes("schans")?(Ge="Een schans is een kleinere versterking, vaak gemaakt van aarde en palissaden. Schansen werden gebruikt om strategische punten te verdedigen.",nt="Bij schansen kun je musketkogels, knopen en soms munten uit de 17e-18e eeuw tegenkomen."):et.includes("batterij")||et.includes("battery")?(Ge="Een batterij is een geschutsopstelling, vaak op een strategische plek om vijanden onder vuur te nemen.",nt="Bij batterijen worden soms kanonkogels of onderdelen van geschut gevonden."):et.includes("bunker")||et.includes("kazemat")?(Ge="Een bunker of kazemat is een versterkte betonnen schuilplaats. Veel werden gebouwd rond 1940 als onderdeel van verdedigingslinies.",nt="Bij bunkers worden soms militaire voorwerpen uit WOII gevonden, zoals knopen, gespen of munitieresten."):et.includes("sluis")||et.includes("inlaatwerk")?(Ge="Militaire sluizen en inlaatwerken werden gebruikt om land onder water te zetten (inunderen). Dit was een belangrijke verdedigingstactiek.",nt="Bij historische sluizen worden soms voorwerpen gevonden van soldaten die deze bewaakten."):et.includes("toren")||et.includes("wachttoren")?(Ge="Wachttorens werden gebruikt om de omgeving in de gaten te houden en vijandelijke bewegingen te signaleren.",nt="Bij torens worden soms persoonlijke voorwerpen van soldaten gevonden."):et.includes("kazerne")&&(Ge="Een kazerne is een gebouw waar soldaten gelegerd waren. Hier woonden, aten en oefenden de troepen.",nt="Rond kazernes worden regelmatig knopen, gespen en andere persoonlijke voorwerpen gevonden.");let Mt=`<strong class="text-stone-800">${Je}</strong>`;ee&&(Mt+=`<br/><span class="text-sm font-semibold text-stone-700">${ee}</span>`),je&&(Mt+=`<br/><span class="text-sm text-blue-600">${je}</span>`),ge&&(Mt+=`<br/><span class="text-xs text-gray-500">${ge}</span>`),Mt+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',Mt+=`<div class="text-sm text-gray-700 mt-1">${Ge}</div>`,nt&&(Mt+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',Mt+=`<div class="text-sm text-gray-700 mt-1">${nt}</div>`),Mt+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',Mt+='<div class="text-sm text-gray-700 mt-1">',Mt+='<a href="https://erfgoedenlocatie.nl/linies-en-stellingen" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">RCE Linies en Stellingen</a>',Mt+="</div>",en.push(Mt)}}catch(He){console.warn("Militaire Objecten WMS query failed:",He)}continue}if(Nn==="Verdedigingslinies"){try{const He=Fn(Ft),ke=lr("EPSG:4326","EPSG:28992",He),Ae=100,z=`https://services.rce.geovoorziening.nl/liniesenstellingen/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=linies&QUERY_LAYERS=linies&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ke[0]-Ae},${ke[1]-Ae},${ke[0]+Ae},${ke[1]+Ae}`}`,X=await(await fetch(z)).json();if(X.features&&X.features.length>0){const ae=X.features[0].properties;let Ve='<strong class="text-amber-800">Verdedigingslinie</strong>';const ee={"Hollandse Waterlinie":"Verdedigingsstelsel (1815-1940) dat gebruik maakte van inundaties om Holland te beschermen. UNESCO Werelderfgoed.","Nieuwe Hollandse Waterlinie":"Uitgebreide versie (1815-1940) met forten en inundatiegebieden van Muiden tot Gorinchem.","Stelling van Amsterdam":"Ringverdediging rond Amsterdam (1880-1920) met 42 forten. UNESCO Werelderfgoed.",Grebbelinie:"Verdedigingslinie langs de Grebbe (17e-20e eeuw). Zware gevechten in mei 1940.",IJssellinie:"Koude Oorlog verdediging (1950-1968) langs de IJssel tegen Sovjet-invasie.",Atlantikwall:"Duitse kustverdediging WOII (1942-1945) van Noorwegen tot Spanje.","Peel-Raamstelling":"Verdedigingslinie in Brabant/Limburg. Gevechten mei 1940.","Maas-Waalstelling":"Linie tussen Maas en Waal, onderdeel landsverdediging.",Zuiderwaterlinie:"Waterlinie in West-Brabant en Zeeland (17e-19e eeuw).","Staats-Spaanse Linies":"Vestingwerken uit de 80-jarige oorlog (1568-1648)."},ge=ae.naam||ae.lin_naam||"";if(ge){Ve+=`<br/><span class="text-sm font-semibold text-amber-700">${ge}</span>`;const je=Object.entries(ee).find(([Je])=>ge.toLowerCase().includes(Je.toLowerCase())||Je.toLowerCase().includes(ge.toLowerCase()));je&&(Ve+=`<br/><span class="text-sm text-gray-700">${je[1]}</span>`)}ae.lin_period&&(Ve+=`<br/><span class="text-xs text-purple-600">${ae.lin_period}</span>`),ae.status&&(Ve+=`<br/><span class="text-xs text-gray-400">${ae.status}</span>`),en.push(Ve)}}catch(He){console.warn("Verdedigingslinies WMS query failed:",He)}continue}if(Nn==="Rijksmonumenten"){try{const He=Fn(Ft),ke=lr("EPSG:4326","EPSG:28992",He),Ae=50,z=`https://data.geo.cultureelerfgoed.nl/openbaar/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=rijksmonumentpunten&QUERY_LAYERS=rijksmonumentpunten&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ke[0]-Ae},${ke[1]-Ae},${ke[0]+Ae},${ke[1]+Ae}`}`,X=await(await fetch(z)).json();if(X.features&&X.features.length>0){const ae=X.features[0].properties;let Ve='<strong class="text-red-800">Rijksmonument</strong>';(ae.cbsNaam||ae.cbs_naam)&&(Ve+=`<br/><span class="text-sm font-semibold">${ae.cbsNaam||ae.cbs_naam}</span>`),ae.hoofdcategorie&&(Ve+=`<br/><span class="text-sm text-red-700">${ae.hoofdcategorie}</span>`),ae.subcategorie&&(Ve+=`<br/><span class="text-xs text-gray-600">${ae.subcategorie}</span>`),ae.rijksmonumentnummer&&(Ve+=`<br/><span class="text-xs text-gray-500">Nr: ${ae.rijksmonumentnummer}</span>`),(ae.bouwjaar||ae.oorspronkelijkebouwjaar)&&(Ve+=`<br/><span class="text-xs text-gray-500">Bouwjaar: ${ae.bouwjaar||ae.oorspronkelijkebouwjaar}</span>`),Ve+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',ae.rijksmonumentnummer&&(Ve+=`<div class="text-sm text-gray-700 mt-1"><a href="https://monumentenregister.cultureelerfgoed.nl/monumenten/${ae.rijksmonumentnummer}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Bekijk in Monumentenregister</a></div>`),Ve+='<div class="text-sm text-gray-700 mt-1"><a href="https://nl.wikipedia.org/wiki/Rijksmonument" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia: Rijksmonument</a></div>',en.push(Ve)}}catch(He){console.warn("Rijksmonumenten WMS query failed:",He)}continue}if(Nn==="Werelderfgoed"){try{const He=Fn(Ft),ke=lr("EPSG:4326","EPSG:28992",He),Ae=500,z=`https://service.pdok.nl/rce/ps-ch/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=PS.ProtectedSite&QUERY_LAYERS=PS.ProtectedSite&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ke[0]-Ae},${ke[1]-Ae},${ke[0]+Ae},${ke[1]+Ae}`}`,X=await(await fetch(z)).json();if(X.features&&X.features.length>0){const ae=X.features[0].properties;let Ve='<strong class="text-cyan-800">UNESCO Werelderfgoed</strong>';(ae.siteName||ae.naam)&&(Ve+=`<br/><span class="text-sm font-semibold text-cyan-700">${ae.siteName||ae.naam}</span>`),ae.siteDesignation&&(Ve+=`<br/><span class="text-xs text-gray-600">${ae.siteDesignation}</span>`),en.push(Ve)}}catch(He){console.warn("Werelderfgoed WMS query failed:",He)}continue}if(Nn==="Terpen"){try{const He=Fn(Ft),ke=lr("EPSG:4326","EPSG:28992",He),Ae=`https://geoportaal.fryslan.nl/arcgis/rest/services/ProvinciaalGeoRegister/PGR2/MapServer/66/query?geometry=${ke[0]},${ke[1]}&geometryType=esriGeometryPoint&spatialRel=esriSpatialRelIntersects&outFields=SOORT,SHAPE_Area&returnGeometry=false&f=json`,z=await(await fetch(Ae)).json();if(z.features&&z.features.length>0){const Et=z.features[0].attributes,X=Et.SOORT||"Terp",ae=Et.SHAPE_Area?Math.round(Et.SHAPE_Area):null;let Ve="",ee="",ge=!1;try{const Mt=`https://service.pdok.nl/rce/ps-ch/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=PS.ProtectedSite&QUERY_LAYERS=PS.ProtectedSite&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ke[0]-100},${ke[1]-100},${ke[0]+100},${ke[1]+100}`}`,yn=await(await fetch(Mt)).json();if(yn.features&&yn.features.length>0){const q=yn.features[0].properties;Ve=q.siteName||q.naam||"",ee=q.inspireId||q.monumentnummer||"",ge=!0}}catch{}let je="";Ve?(je=`<strong class="text-orange-800">${Ve}</strong>`,je+=`<br/><span class="text-sm text-orange-600 font-medium">${X}</span>`):je=`<strong class="text-orange-800">${X}</strong>`,je+='<br/><span class="text-sm text-gray-600">Friese terp (woonheuvel)</span>';const Ge={terp:{uitleg:"Een kunstmatige woonheuvel waar mensen woonden om droge voeten te houden.",periode:"IJzertijd tot Middeleeuwen"},"afgegraven terp":{uitleg:"Deze terp is deels of geheel afgegraven voor de vruchtbare grond (terpaarde).",periode:"Oorspronkelijk IJzertijd-Middeleeuwen"},terprestant:{uitleg:"Hier lag ooit een terp, waarvan nu alleen nog resten over zijn.",periode:"IJzertijd tot Middeleeuwen"},"deels afgegraven terp":{uitleg:"Een deel van deze terp is afgegraven, een deel is nog intact.",periode:"IJzertijd tot Middeleeuwen"},"verhoogd kerkhof":{uitleg:"Een verhoogd kerkhof, vaak op een oude terplocatie gebouwd.",periode:"Middeleeuwen"},kerkterp:{uitleg:"Een terp met daarop een kerk, vaak het centrum van een terpdorp.",periode:"IJzertijd tot heden"}}[X.toLowerCase()]||{uitleg:"Een kunstmatige woonheuvel uit de tijd dat dit gebied vaak overstroomde.",periode:"IJzertijd tot Middeleeuwen"};if(je+=`<div class="mt-2 text-sm text-gray-700">${Ge.uitleg}</div>`,je+=`<br/><span class="text-sm text-gray-600">Periode: ${Ge.periode}</span>`,ae&&ae>100){const nt=(ae/1e4).toFixed(1);je+=`<br/><span class="text-sm text-gray-500">Oppervlak: ${nt} hectare</span>`}if(ge&&(je+='<div class="mt-2 p-2 bg-orange-100 rounded text-xs text-orange-800">',je+="<strong> Rijksmonument</strong> - Deze terp is wettelijk beschermd. Detecteren is niet toegestaan zonder vergunning.",ee&&(je+=`<br/>Monumentnummer: ${ee}`),je+="</div>"),je+='<div class="mt-2 p-2 bg-amber-50 rounded text-xs text-amber-800">',je+="<strong>Detectietip:</strong> ",X.toLowerCase().includes("afgegraven")?je+="Afgegraven terpen zijn interessant! Bij het afgraven kwam materiaal aan de oppervlakte. Zoek op akkers rond de oude terplocatie.":je+="Terpen zijn rijk aan vondsten: aardewerk, munten, fibulae, botten, gereedschap. De grond is vaak donker en vruchtbaar door eeuwenlange bewoning.",je+="</div>",je+='<div class="mt-3 space-y-1">',je+='<a href="https://www.terpenonderzoek.nl/" target="_blank" class="block text-blue-600 hover:underline text-sm">Terpenonderzoek.nl - Wetenschappelijk onderzoek</a>',je+='<a href="https://www.friesmuseum.nl/collectie/archeologie/" target="_blank" class="block text-blue-600 hover:underline text-sm">Fries Museum - Terpvondsten</a>',je+='<a href="https://nl.wikipedia.org/wiki/Terp" target="_blank" class="block text-blue-600 hover:underline text-sm">Wikipedia - Terpen</a>',Ve){const nt=encodeURIComponent(Ve+" terp friesland");je+=`<a href="https://www.google.com/search?q=${nt}" target="_blank" class="block text-blue-600 hover:underline text-sm">Zoek meer over ${Ve}</a>`}je+="</div>",en.push(je)}}catch(He){console.warn("Terpen query failed:",He)}continue}if(Nn==="Religieus Erfgoed"){try{const He=Fn(Ft),ke=lr("EPSG:4326","EPSG:28992",He),Ae=50,z=`https://services.rce.geovoorziening.nl/landschapsatlas_view/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=religieuserfgoed&QUERY_LAYERS=religieuserfgoed&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ke[0]-Ae},${ke[1]-Ae},${ke[0]+Ae},${ke[1]+Ae}`}`,X=await(await fetch(z)).json();if(X.features&&X.features.length>0){const ae=X.features[0].properties,Ve=ae.naam||ae.NAAM||ae.name||ae.NAME||"Onbekend",ee=ae.denominatie||ae.DENOMINATIE||ae.religie||"",ge=ae.type||ae.TYPE||ae.functie||"",je=ae.bouwjaar||ae.BOUWJAAR||ae.jaar||"",Je=ae.gemeente||ae.GEMEENTE||ae.plaats||"";let Ge=`<strong class="text-purple-800">${Ve}</strong>`;const nt=ge.toLowerCase();let et="Een religieus gebouw of heilige plek.",Mt="Munten van kerkgangers, knopen, gespen, religieuze voorwerpen";nt.includes("kerk")||nt.includes("church")?(et="Een kerk was het hart van de gemeenschap. Hier kwamen mensen samen voor diensten, maar ook voor belangrijke gebeurtenissen.",Mt="Munten uit de collecte, knopen, gespen, pelgrimsinsignes, loden zegels"):nt.includes("kapel")||nt.includes("chapel")?(et="Een kapel is een klein gebedshuis, vaak bij een landgoed, langs een weg, of op een bijzondere plek.",Mt="Devotionalia, munten, kruisjes, rozenkransen"):nt.includes("synagoge")?(et="Een synagoge is een Joods gebedshuis. Veel synagogen in Nederland zijn verwoest of herbestemd na de Tweede Wereldoorlog.",Mt="Munten, knopen, kleine religieuze voorwerpen"):nt.includes("klooster")||nt.includes("monastery")?(et="Een klooster was een woon- en werkplek voor monniken of nonnen. Veel kloosters hadden eigen werkplaatsen en landerijen.",Mt="Religieuze voorwerpen, zegels, gereedschap, aardewerk, middeleeuwse munten"):nt.includes("toren")||nt.includes("tower")?(et="Een kerktoren of klokkentoren. Soms is alleen de toren nog over van een verdwenen kerk.",Mt="Munten, knopen, bouwmateriaal"):(nt.includes("begraafplaats")||nt.includes("cemetery"))&&(et="Een historische begraafplaats. Detecteren op begraafplaatsen is niet toegestaan zonder toestemming.",Mt="Detecteren hier niet toegestaan"),ee&&(Ge+=`<br/><span class="text-sm text-purple-600">${ee}</span>`),ge&&(Ge+=`<br/><span class="text-sm text-gray-600">${ge}</span>`),je&&(Ge+=`<br/><span class="text-sm text-gray-500">Bouwjaar: ${je}</span>`),Je&&(Ge+=`<br/><span class="text-xs text-gray-400">${Je}</span>`),Ge+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',Ge+=`<div class="text-sm text-gray-700 mt-1">${et}</div>`,Ge+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',Ge+=`<div class="text-sm text-gray-700 mt-1">${Mt}</div>`,Ge+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bezoeken</span></div>',nt.includes("begraafplaats")?Ge+='<div class="text-sm text-red-600 mt-1">Detecteren op begraafplaatsen is niet toegestaan. Respecteer de rust van de overledenen.</div>':Ge+='<div class="text-sm text-gray-700 mt-1">Veel kerken en religieuze gebouwen zijn beschermd monument. Vraag altijd toestemming voordat je gaat detecteren op het terrein.</div>',en.push(Ge)}}catch(He){console.warn("Religieus Erfgoed WMS query failed:",He)}continue}if(Nn==="Gewaspercelen"){try{const He=Fn(Ft),ke=lr("EPSG:4326","EPSG:28992",He),Ae=50,sn=`${ke[0]-Ae},${ke[1]-Ae},${ke[0]+Ae},${ke[1]+Ae}`,z=`https://service.pdok.nl/rvo/brpgewaspercelen/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=BrpGewas&QUERY_LAYERS=BrpGewas&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${sn}`,Et=`https://service.pdok.nl/bzk/bro-bodemkaart/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=soilarea&QUERY_LAYERS=soilarea&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${sn}`,[X,ae]=await Promise.all([fetch(z),fetch(Et).catch(()=>null)]),Ve=await X.json();if(Ve.features&&Ve.features.length>0){const ee=Ve.features[0].properties;let ge='<strong class="text-green-800">Landbouwperceel</strong>';if((ee.gewas||ee.gewasnaam)&&(ge+=`<br/><span class="text-sm font-semibold text-green-700">${ee.gewas||ee.gewasnaam}</span>`),(ee.categorie||ee.category)&&(ge+=`<br/><span class="text-xs text-gray-600">${ee.categorie||ee.category}</span>`),ee.oppervlakte&&(ge+=`<br/><span class="text-xs text-gray-500">${ee.oppervlakte} ha</span>`),ae)try{const je=await ae.json();if(je.features&&je.features.length>0){const Je=je.features[0].properties,Ge=Je.first_soilname||Je.soilname||Je.bodemtype,nt=Je.first_soilcode||Je.soilcode||Je.maparea_soilcode;if(Ge){ge+=`<br/><span class="text-xs text-amber-700 font-medium">Grondsoort: ${Ge}</span>`;const et=pae(Ge,nt);et.length>0&&(ge+=`<br/><span class="text-xs text-gray-500 italic">${et.join("  ")}</span>`)}}}catch{}en.push(ge)}}catch(He){console.warn("BRP Gewaspercelen WMS query failed:",He)}continue}if(Nn==="Kadastrale Grenzen"){try{const He=Fn(Ft),ke=lr("EPSG:4326","EPSG:28992",He),Ae=20,z=`https://service.pdok.nl/kadaster/kadastralekaart/wms/v5_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=Perceel&QUERY_LAYERS=Perceel&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ke[0]-Ae},${ke[1]-Ae},${ke[0]+Ae},${ke[1]+Ae}`}`,X=await(await fetch(z)).json();if(X.features&&X.features.length>0){const ae=X.features[0].properties,Ve=ae.kadastraleGemeenteWaarde||ae.kadastrale_gemeente_waarde||ae.kadastraleGemeente||ISt[String(ae.kadastraleGemeenteCode)]||ae.kadastraleGemeenteCode,ee=ae.sectie||ae.Sectie||"",ge=ae.perceelnummer||ae.perceelNummer||ae.Perceelnummer||"",je=ae.kadastraleGrootteWaarde||ae.kadastrale_grootte_waarde||ae.kadastraleGrootte||ae.oppervlakte,Je=ae.AKRKadastraleGemeenteCodeWaarde||ae.akrKadastraleGemeenteCodeWaarde||"",Ge=[Ve,ee,ge].filter(Boolean).join(" "),nt=Je&&ee&&ge?`${Je}-${ee}-${ge}`:"";let et='<strong class="text-indigo-800">Kadastraal Perceel</strong>';if(Ge&&(et+=`<br/><span class="text-sm text-indigo-700">${Ge}</span>`),nt&&(et+=`<br/><span class="text-sm font-bold text-gray-800 font-mono">${nt}</span>`),je){const Mt=typeof je=="number"?je:parseFloat(je);isNaN(Mt)||(et+=`<br/><span class="text-xs text-gray-600">${Mt.toLocaleString("nl-NL")} m</span>`)}et+='<br/><br/><span class="text-xs text-gray-600">Eigenaar opzoeken? Kopieer bovenstaande code, ga naar </span><a href="https://www.kadaster.nl/winkel" target="_blank" rel="noopener" class="text-xs text-blue-600 hover:underline">kadaster.nl/winkel</a><span class="text-xs text-gray-600"> en klik "Zoek op aanduiding"</span><span class="text-xs text-gray-400"> (betaalde dienst)</span>',en.push(et)}}catch(He){console.warn("Kadastrale Grenzen WMS query failed:",He)}continue}if(Nn==="Scheepswrakken"){try{const He=Fn(Ft),ke=lr("EPSG:4326","EPSG:28992",He),Ae=100,z=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_ARCHEOLOGIE_SCHEEPSRESTANTEN&QUERY_LAYERS=CHS_2015_ARCHEOLOGIE_SCHEEPSRESTANTEN&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ke[0]-Ae},${ke[1]-Ae},${ke[0]+Ae},${ke[1]+Ae}`}`,X=await(await fetch(z)).json();if(X.features&&X.features.length>0){const ae=X.features[0].properties;let ee=`<strong class="text-cyan-800">${ae.naam||ae.NAAM||"Scheepswrak"}</strong>`;ee+='<br/><span class="text-sm text-gray-800">Historisch scheepswrak in Zuid-Holland</span>',ee+='<div class="mt-2 text-sm text-gray-700">',ee+="Op deze plek ligt een oud scheepswrak. Dit is een schip dat lang geleden is gezonken. ",ee+="In de bodem kunnen nog resten van het schip en de lading liggen.",ee+="</div>",(ae.type||ae.TYPE)&&(ee+=`<br/><span class="text-sm text-cyan-700">Type: ${ae.type||ae.TYPE}</span>`),(ae.datering||ae.DATERING)&&(ee+=`<br/><span class="text-sm text-gray-600">Periode: ${ae.datering||ae.DATERING}</span>`),(ae.bron||ae.BRON)&&(ee+=`<br/><span class="text-xs text-gray-500">Bron: ${ae.bron||ae.BRON}</span>`),ee+='<div class="mt-2 p-2 bg-cyan-50 rounded text-xs text-cyan-800">',ee+="<strong>Detectietip:</strong> Bij scheepswrakken kun je bijzondere vondsten doen zoals scheepsonderdelen, munten, gereedschap en lading. Let op: vaak is een vergunning nodig.",ee+="</div>",ee+='<div class="mt-2"><a href="https://www.zuid-holland.nl/onderwerpen/cultuur-erfgoed/" target="_blank" class="text-blue-600 hover:underline text-sm">Meer over erfgoed Zuid-Holland</a></div>',en.push(ee)}}catch(He){console.warn("Scheepswrakken WMS query failed:",He)}continue}if(Nn==="Woonheuvels ZH"){try{const He=Fn(Ft),ke=lr("EPSG:4326","EPSG:28992",He),Ae=100,z=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_ARCHEOLOGIE_WOONHEUVEL&QUERY_LAYERS=CHS_2015_ARCHEOLOGIE_WOONHEUVEL&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ke[0]-Ae},${ke[1]-Ae},${ke[0]+Ae},${ke[1]+Ae}`}`,X=await(await fetch(z)).json();if(X.features&&X.features.length>0){const ae=X.features[0].properties;let ee=`<strong class="text-orange-800">${ae.naam||ae.NAAM||"Woonheuvel"}</strong>`;ee+='<br/><span class="text-sm text-gray-800">Historische woonheuvel (terp)</span>',ee+='<div class="mt-2 text-sm text-gray-700">',ee+="Een woonheuvel is een door mensen opgeworpen heuvel. Mensen woonden hierop om droge voeten te houden bij hoog water. ",ee+="Deze heuvels werden steeds hoger gemaakt. Je vindt ze vooral in laaggelegen gebieden.",ee+="</div>",(ae.type||ae.TYPE)&&(ee+=`<br/><span class="text-sm text-orange-700">Type: ${ae.type||ae.TYPE}</span>`),ee+='<div class="mt-2 p-2 bg-orange-50 rounded text-xs text-orange-800">',ee+="<strong>Detectietip:</strong> Woonheuvels zijn rijk aan vondsten! Denk aan aardewerk, munten, sieraden en huisraad uit de middeleeuwen. De grond bevat vaak veel materiaal.",ee+="</div>",ee+='<div class="mt-2"><a href="https://www.zuid-holland.nl/onderwerpen/cultuur-erfgoed/" target="_blank" class="text-blue-600 hover:underline text-sm">Meer over erfgoed Zuid-Holland</a></div>',en.push(ee)}}catch(He){console.warn("Woonheuvels WMS query failed:",He)}continue}if(Nn==="Romeinse Forten"){try{const He=Fn(Ft),ke=lr("EPSG:4326","EPSG:28992",He),Ae=200,z=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_ARCHEOLOGIE_ROMEINSFORT&QUERY_LAYERS=CHS_2015_ARCHEOLOGIE_ROMEINSFORT&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ke[0]-Ae},${ke[1]-Ae},${ke[0]+Ae},${ke[1]+Ae}`}`,X=await(await fetch(z)).json();if(X.features&&X.features.length>0){const ae=X.features[0].properties;let ee=`<strong class="text-red-800">${ae.naam||ae.NAAM||"Romeins Fort"}</strong>`;ee+='<br/><span class="text-sm text-gray-800">Romeins militair fort (castellum)</span>',ee+='<div class="mt-2 text-sm text-gray-700">',ee+="Dit was een Romeins legerfort. De Romeinen bouwden deze forten langs de Rijn, de grens van hun rijk. ",ee+="Soldaten woonden hier en bewaakten de grens. Deze forten zijn ongeveer 2000 jaar oud.",ee+="</div>",(ae.type||ae.TYPE)&&(ee+=`<br/><span class="text-sm text-red-700">Type: ${ae.type||ae.TYPE}</span>`),(ae.periode||ae.PERIODE)&&(ee+=`<br/><span class="text-sm text-gray-600">Periode: ${ae.periode||ae.PERIODE}</span>`),ee+='<div class="mt-2 p-2 bg-red-50 rounded text-xs text-red-800">',ee+="<strong>Detectietip:</strong> Romeinse forten zijn toplocaties! Je kunt hier Romeinse munten, fibulae (mantelspelden), militaire uitrusting en aardewerk vinden. Vaak beschermd, check de regels!",ee+="</div>",ee+='<div class="mt-2"><a href="https://www.limesworld.nl/" target="_blank" class="text-blue-600 hover:underline text-sm">Meer over de Romeinse Limes</a></div>',en.push(ee)}}catch(He){console.warn("Romeinse Forten WMS query failed:",He)}continue}if(Nn==="Windmolens"){try{const He=Fn(Ft),ke=lr("EPSG:4326","EPSG:28992",He),Ae=50,z=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_NEDERZETTING_WINDMOLENS&QUERY_LAYERS=CHS_2015_NEDERZETTING_WINDMOLENS&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ke[0]-Ae},${ke[1]-Ae},${ke[0]+Ae},${ke[1]+Ae}`}`,X=await(await fetch(z)).json();if(X.features&&X.features.length>0){const ae=X.features[0].properties;let ee=`<strong class="text-amber-800">${ae.naam||ae.NAAM||"Windmolen"}</strong>`;if(ee+='<br/><span class="text-sm text-gray-800">Historische windmolen</span>',ee+='<div class="mt-2 text-sm text-gray-700">',ee+="Windmolens gebruikten de kracht van de wind. Ze maalden graan tot meel of pompten water weg uit polders. ",ee+="Nederland heeft veel molens omdat we laaggelegen land droog moesten houden.",ee+="</div>",ae.type||ae.TYPE||ae.functie||ae.FUNCTIE){const ge=ae.functie||ae.FUNCTIE||ae.type||ae.TYPE;ee+=`<br/><span class="text-sm text-amber-700">Functie: ${ge}</span>`}(ae.bouwjaar||ae.BOUWJAAR)&&(ee+=`<br/><span class="text-sm text-gray-600">Bouwjaar: ${ae.bouwjaar||ae.BOUWJAAR}</span>`),ee+='<div class="mt-2 p-2 bg-amber-50 rounded text-xs text-amber-800">',ee+="<strong>Detectietip:</strong> Bij molens vind je vaak voorwerpen van de molenaar en bezoekers: munten, knopen, gereedschap. Ook de grond rond verdwenen molens kan interessant zijn.",ee+="</div>",ee+='<div class="mt-2"><a href="https://www.molendatabase.nl/" target="_blank" class="text-blue-600 hover:underline text-sm">Meer over Nederlandse molens</a></div>',en.push(ee)}}catch(He){console.warn("Windmolens WMS query failed:",He)}continue}if(Nn==="Erfgoedlijnen"){try{const He=Fn(Ft),ke=lr("EPSG:4326","EPSG:28992",He),Ae=200,z=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_ERFGOEDLIJN_HOOFDSTRUCTUUR&QUERY_LAYERS=CHS_ERFGOEDLIJN_HOOFDSTRUCTUUR&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ke[0]-Ae},${ke[1]-Ae},${ke[0]+Ae},${ke[1]+Ae}`}`,X=await(await fetch(z)).json();if(X.features&&X.features.length>0){const ae=X.features[0].properties;let ee=`<strong class="text-purple-800">${ae.naam||ae.NAAM||ae.erfgoedlijn||"Erfgoedlijn"}</strong>`;ee+='<br/><span class="text-sm text-gray-800">Historische lijn in het landschap</span>',ee+='<div class="mt-2 text-sm text-gray-700">',ee+="Een erfgoedlijn is een route of lijn met veel geschiedenis. Dit kunnen oude dijken, wegen, kanalen of verdedigingslinies zijn. ",ee+="Langs deze lijnen vind je vaak bijzondere plekken.",ee+="</div>",(ae.type||ae.TYPE)&&(ee+=`<br/><span class="text-sm text-purple-700">Type: ${ae.type||ae.TYPE}</span>`),(ae.omschrijving||ae.OMSCHRIJVING)&&(ee+=`<br/><span class="text-sm text-gray-600">${ae.omschrijving||ae.OMSCHRIJVING}</span>`),ee+='<div class="mt-2 p-2 bg-purple-50 rounded text-xs text-purple-800">',ee+="<strong>Detectietip:</strong> Erfgoedlijnen volgen oude routes waar mensen langskwamen. Denk aan munten, knopen, gespen en andere verloren voorwerpen. Dijken en wegen zijn vaak interessant.",ee+="</div>",ee+='<div class="mt-2"><a href="https://www.erfgoedlijnen.nl/" target="_blank" class="text-blue-600 hover:underline text-sm">Meer over Erfgoedlijnen</a></div>',en.push(ee)}}catch(He){console.warn("Erfgoedlijnen WMS query failed:",He)}continue}if(Nn==="Oude Kernen"){try{const He=Fn(Ft),ke=lr("EPSG:4326","EPSG:28992",He),Ae=200,z=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_ARCHEOLOGIE_KERNEN&QUERY_LAYERS=CHS_2015_ARCHEOLOGIE_KERNEN&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ke[0]-Ae},${ke[1]-Ae},${ke[0]+Ae},${ke[1]+Ae}`}`,X=await(await fetch(z)).json();if(X.features&&X.features.length>0){const ae=X.features[0].properties;let ee=`<strong class="text-stone-800">${ae.naam||ae.NAAM||"Historische Kern"}</strong>`;ee+='<br/><span class="text-sm text-gray-800">Oude dorps- of stadskern</span>',ee+='<div class="mt-2 text-sm text-gray-700">',ee+="Dit is het oude centrum van een dorp of stad. Hier woonden en werkten mensen al honderden jaren geleden. ",ee+="De grond bevat vaak veel sporen van het verleden.",ee+="</div>",(ae.type||ae.TYPE)&&(ee+=`<br/><span class="text-sm text-stone-700">Type: ${ae.type||ae.TYPE}</span>`),(ae.periode||ae.PERIODE)&&(ee+=`<br/><span class="text-sm text-gray-600">Periode: ${ae.periode||ae.PERIODE}</span>`),ee+='<div class="mt-2 p-2 bg-stone-100 rounded text-xs text-stone-800">',ee+="<strong>Detectietip:</strong> Oude kernen zijn rijk aan vondsten! Munten, knopen, sieraden, gereedschap en huisraad. Let op: detecteren is vaak niet toegestaan in beschermde kernen.",ee+="</div>",ee+='<div class="mt-2"><a href="https://www.zuid-holland.nl/onderwerpen/cultuur-erfgoed/" target="_blank" class="text-blue-600 hover:underline text-sm">Meer over erfgoed Zuid-Holland</a></div>',en.push(ee)}}catch(He){console.warn("Oude Kernen WMS query failed:",He)}continue}if(Nn==="Relictenkaart Punten"){try{const He=Fn(Ft),ke=lr("EPSG:4326","EPSG:28992",He),Ae=50,z=`https://geoserver.gelderland.nl/geoserver/ngr_a/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=ChAr_Relictenkaart_p&QUERY_LAYERS=ChAr_Relictenkaart_p&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ke[0]-Ae},${ke[1]-Ae},${ke[0]+Ae},${ke[1]+Ae}`}`,X=await(await fetch(z)).json();if(X.features&&X.features.length>0){const ae=X.features[0].properties,Ve={KV:{naam:"Kasteel of Vesting",uitleg:"Een versterkt gebouw uit de middeleeuwen. Vaak zijn er nog resten in de grond."},K:{naam:"Kapel",uitleg:"Een klein kerkgebouw. Rond kapellen worden vaak religieuze voorwerpen gevonden."},KE:{naam:"Kerkhof",uitleg:"Historische begraafplaats. Respecteer deze plek en vraag altijd toestemming."},B:{naam:"Buitenhuis",uitleg:"Een landhuis van welgestelde families. Vaak met tuinen en bijgebouwen."},OB:{naam:"Oud Bebouwingsrelict",uitleg:"Resten van oude bebouwing. Hier stonden ooit huizen of boerderijen."},OV:{naam:"Oude Verkaveling",uitleg:"Historisch patroon van akkers en weilanden uit vroeger tijden."},NR:{naam:"Nijverheidsrelict",uitleg:"Plek waar vroeger ambacht of industrie was, zoals smederijen of molens."},GH:{naam:"Grafheuvel",uitleg:"Prehistorische begraafplaats. Beschermd monument - niet detecteren!"},BP:{naam:"Begraafplaats",uitleg:"Historische begraafplaats. Respecteer deze plek."},HH:{naam:"Havezate",uitleg:"Adellijk huis met landerijen. Interessant voor middeleeuwse vondsten."},RM:{naam:"Rosmolen",uitleg:"Molen aangedreven door paarden. Zeldzaam cultuurhistorisch object."},WM:{naam:"Windmolen",uitleg:"Historische windmolen. Vaak zijn funderingen nog zichtbaar."},PM:{naam:"Poldermolen",uitleg:"Molen voor waterbeheer. Belangrijk voor de waterhuishouding."},EK:{naam:"Eendenkooi",uitleg:"Plek om wilde eenden te vangen. Bijzonder cultuurlandschap."},SH:{naam:"Scholtenhoeve",uitleg:"Boerderij van een welgestelde boer. Vaak eeuwenoud."},SL:{naam:"Slot",uitleg:"Versterkt kasteel of adellijke woning."},MO:{naam:"Motte",uitleg:"Vroegmiddeleeuwse kasteelberg. Zeer interessant voor detectie."},BR:{naam:"Borg",uitleg:"Versterkte adellijke woning, typisch voor het noorden."}},ee=ae.type?.replace(/[0-9]/g,"")||"",ge=Ve[ee]||{naam:ae.type||"Cultuurhistorisch object",uitleg:"Een historisch relict in het Gelderse landschap."};let je=`<strong class="text-emerald-800">${ge.naam}</strong>`;je+='<br/><span class="text-sm text-gray-800">Gelders cultuurhistorisch relict</span>',ae.streek&&(je+=`<br/><span class="text-sm text-gray-600">Streek: ${ae.streek}</span>`),je+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is dit?</span></div>',je+=`<div class="text-sm text-gray-700 mt-1">${ge.uitleg}</div>`,je+='<div class="mt-3"><a href="https://www.gelderland.nl/erfgoed" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline text-sm">Meer over Gelders erfgoed</a></div>',en.push(je)}}catch(He){console.warn("Relictenkaart Punten WMS query failed:",He)}continue}if(Nn==="Relictenkaart Lijnen"){try{const He=Fn(Ft),ke=lr("EPSG:4326","EPSG:28992",He),Ae=50,z=`https://geoserver.gelderland.nl/geoserver/ngr_a/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=ChAr_Relictenkaart_l&QUERY_LAYERS=ChAr_Relictenkaart_l&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ke[0]-Ae},${ke[1]-Ae},${ke[0]+Ae},${ke[1]+Ae}`}`,X=await(await fetch(z)).json();if(X.features&&X.features.length>0){const ae=X.features[0].properties,ee={1:{naam:"Sprengenbeek",uitleg:"Kunstmatig aangelegde beek voor waterkracht. Vaak bij papiermolens."},2:{naam:"Oude waterloop",uitleg:"Historische beek of rivier. Langs waterlopen vind je vaak oude bewoningssporen."},3:{naam:"Doorgaande weg",uitleg:"Eeuwenoude handelsroute. Langs deze wegen gingen reizigers en handelaren."},4:{naam:"Hessenweg",uitleg:"Historische handelsweg naar Duitsland. Gebruikt door marskramers en kooplieden."},5:{naam:"Oude weg",uitleg:"Historische route door het landschap. Vaak al eeuwen in gebruik."},6:{naam:"Historische grens",uitleg:"Oude eigendoms- of gebiedsgrens. Soms gemarkeerd met grenspalen."},7:{naam:"Trekpad",uitleg:"Pad langs een kanaal waar paarden schepen trokken."},8:{naam:"Jaagpad",uitleg:"Pad langs water voor scheepvaart met paardentractie."}}[ae.klasse]||{naam:"Historisch lijnrelict",uitleg:"Een lijnvormig historisch element in het landschap."};let ge=`<strong class="text-teal-800">${ee.naam}</strong>`;ge+='<br/><span class="text-sm text-gray-800">Gelders lijnrelict</span>',ge+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is dit?</span></div>',ge+=`<div class="text-sm text-gray-700 mt-1">${ee.uitleg}</div>`,ge+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Tip</span></div>',ge+='<div class="text-sm text-gray-700 mt-1">Langs oude wegen en waterlopen worden vaak vondsten gedaan. Mensen verloren er munten en voorwerpen.</div>',en.push(ge)}}catch(He){console.warn("Relictenkaart Lijnen WMS query failed:",He)}continue}if(Nn==="Relictenkaart Vlakken"){try{const He=Fn(Ft),ke=lr("EPSG:4326","EPSG:28992",He),Ae=100,z=`https://geoserver.gelderland.nl/geoserver/ngr_a/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=ChAr_Relictenkaart_v&QUERY_LAYERS=ChAr_Relictenkaart_v&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ke[0]-Ae},${ke[1]-Ae},${ke[0]+Ae},${ke[1]+Ae}`}`,X=await(await fetch(z)).json();if(X.features&&X.features.length>0){const ae=X.features[0].properties,ee={1:{naam:"Oud agrarisch land",uitleg:"Gebied dat al voor 1850 als landbouwgrond werd gebruikt. Rijk aan geschiedenis."},2:{naam:"Jonge heideontginning",uitleg:"Heide die tussen 1850 en 1950 is ontgonnen voor landbouw."},3:{naam:"Open essencomplex",uitleg:"Historische akkers op hoge grond. Vaak eeuwenoud en rijk aan vondsten."},4:{naam:"Kampenlandschap",uitleg:"Landschap met kleine akkers omringd door houtwallen. Typisch voor Oost-Nederland."},5:{naam:"Heiderelict",uitleg:"Restant van het vroegere uitgestrekte heidelandschap. Vaak prehistorische vondsten."},6:{naam:"Oud bosrelict",uitleg:"Bos dat al in 1850 bestond. Oude bossen bevatten vaak cultuurhistorische resten."},7:{naam:"Stuifzandrelict",uitleg:"Overblijfsel van actief stuifzand. Vaak bij grafheuvels en prehistorische sites."},8:{naam:"Oud bouwland",uitleg:"Historische akkergrond. Boeren hebben hier eeuwenlang gewerkt."},9:{naam:"Historisch grasland",uitleg:"Oud weiland of hooiland. Vaak bij boerderijen en dorpen."},10:{naam:"Beekdal",uitleg:"Laagte langs een beek. Mensen woonden graag bij water."}}[ae.klasse]||{naam:"Historisch landschap",uitleg:"Een waardevol cultuurlandschap in Gelderland."};let ge=`<strong class="text-lime-800">${ee.naam}</strong>`;if(ge+='<br/><span class="text-sm text-gray-800">Gelders landschapsrelict</span>',ae.st_area_shape_){const je=(ae.st_area_shape_/1e4).toFixed(1);ge+=`<br/><span class="text-sm text-gray-600">${je} hectare</span>`}ge+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is dit?</span></div>',ge+=`<div class="text-sm text-gray-700 mt-1">${ee.uitleg}</div>`,en.push(ge)}}catch(He){console.warn("Relictenkaart Vlakken WMS query failed:",He)}continue}if(Nn==="Verdronken Dorpen"){try{const He=Fn(Ft),ke=lr("EPSG:4326","EPSG:28992",He),Ae=200,z=`https://opengeodata.zeeland.nl/geoserver/chs/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=geocmd_vrddrppnt&QUERY_LAYERS=geocmd_vrddrppnt&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ke[0]-Ae},${ke[1]-Ae},${ke[0]+Ae},${ke[1]+Ae}`}`,X=await(await fetch(z)).json();if(X.features&&X.features.length>0){const ae=X.features[0].properties;let ee=`<strong class="text-blue-800">${ae.naam||ae.NAAM||"Verdronken dorp"}</strong>`;ee+='<br/><span class="text-sm text-gray-800">Verdronken dorp in Zeeland</span>',ee+='<div class="mt-2 text-sm text-gray-700">',ee+="Dit dorp is lang geleden door de zee verzwolgen. Bij stormvloeden brak de zeedijk door en liep het land onder water. ",ee+="De mensen vluchtten, maar hun huizen en bezittingen bleven achter. In de bodem liggen nog resten van dit dorp.",ee+="</div>",(ae.verdronken||ae.VERDRONKEN||ae.jaar||ae.JAAR)&&(ee+=`<br/><span class="text-sm text-blue-700">Verdronken in: ${ae.verdronken||ae.VERDRONKEN||ae.jaar||ae.JAAR}</span>`),(ae.gemeente||ae.GEMEENTE)&&(ee+=`<br/><span class="text-sm text-gray-600">Gemeente: ${ae.gemeente||ae.GEMEENTE}</span>`),(ae.bron||ae.BRON)&&(ee+=`<br/><span class="text-xs text-gray-500">Bron: ${ae.bron||ae.BRON}</span>`),ee+='<div class="mt-2 p-2 bg-blue-50 rounded text-xs text-blue-800">',ee+="<strong>Detectietip:</strong> Verdronken dorpen bevatten veel vondsten! Aardewerk, munten, sieraden, gereedschap en huisraad. Bij laag water komen soms stukken vrij. Let op getijden en veiligheid!",ee+="</div>",ee+='<div class="mt-2"><a href="https://www.verdronkengeschiedenis.nl/" target="_blank" class="text-blue-600 hover:underline text-sm">Meer over verdronken dorpen</a></div>',en.push(ee)}}catch(He){console.warn("Verdronken Dorpen WMS query failed:",He)}continue}const Ii=Ds.getFeatureInfoUrl(Ft,jn,"EPSG:3857",{INFO_FORMAT:"application/json"});if(Ii)try{const ke=await(await fetch(Ii)).json();if(ke.features&&ke.features.length>0){const Ae=ke.features[0].properties;if(Nn==="AHN 0.5m"){let X='<strong class="text-blue-800">AHN Hoogtekaart</strong>';const ae=Ae.value_list??Ae.GRAY_INDEX??Ae.value??Ae.gray_index??Ae.dtm_05m??Ae.DTM_05M??Ae.hoogte??Ae.HOOGTE??Ae.elevation??Ae.ELEVATION;if(ae!=null&&!isNaN(Number(ae))){const Ve=typeof ae=="number"?ae.toFixed(2):Number(ae).toFixed(2);X+=`<br/><span class="text-sm text-blue-700">Hoogte: ${Ve} m NAP</span>`,en.push(X)}else{let Ve=!1;const ee=["geometry","id","fid","gml_id","bbox"];for(const[ge,je]of Object.entries(Ae))!ee.includes(ge.toLowerCase())&&je!==null&&je!==""&&(X+=`<br/><span class="text-xs text-gray-600">${ge}: ${je}</span>`,Ve=!0);Ve&&en.push(X)}continue}if(Nn==="Geomorfologie"){let X='<strong class="text-green-800">Geomorfologie</strong>',ae=!1;const Ve=Ae.landform_subgroup_description,ee=Ae.relief_klasse,ge=Ae.relief_subklasse,je=Ae.genese_description,Je=Ae.active_process;if(Ve&&(X+=`<br/><span class="text-sm text-green-700">${Ve}</span>`,ae=!0),ee){const Ge=ge&&ge!==ee?`${ee} (${ge})`:ee;X+=`<br/><span class="text-xs text-gray-600">Relief: ${Ge}</span>`,ae=!0}if(je&&(X+=`<br/><span class="text-xs text-gray-500">Ontstaan: ${je}</span>`,ae=!0),Je&&Je!=="onbekend"&&(X+=`<br/><span class="text-xs text-gray-500">Actief proces: ${Je}</span>`,ae=!0),!ae){const Ge=["geometry","id","fid","gml_id","bbox","fuuid","geom","collection_id"];for(const[nt,et]of Object.entries(Ae))!Ge.includes(nt.toLowerCase())&&et!==null&&et!==""&&!nt.includes("validfrom")&&!nt.includes("validto")&&(X+=`<br/><span class="text-xs text-gray-600">${nt}: ${et}</span>`)}X+='<br/><a href="https://legendageomorfologie.wur.nl/" target="_blank" rel="noopener" class="text-xs text-blue-600 hover:underline">Meer over geomorfologie</a>',en.push(X);continue}let sn=`<strong>${Nn}</strong>`;const z=Ae.first_soilname||Ae.soilname,Et=Ae.soilcode||Ae.first_soilcode;if(z&&(sn+=`<br/><span class="text-sm text-amber-700">${z}</span>`,Nn==="Bodemkaart")){const X=pae(z,Et);X.length>0&&(sn+=`<br/><span class="text-xs text-gray-500 italic">${X.join("  ")}</span>`)}if(Ae.soilslope&&Ae.soilslope!=="Niet opgenomen"&&(sn+=`<br/><span class="text-xs text-gray-500">Helling: ${Ae.soilslope}</span>`),!z){const X=["geometry","id","fid","gml_id","GRAY_INDEX","gray_index","value"];for(const[ae,Ve]of Object.entries(Ae))!X.includes(ae)&&Ve&&Ve!=="Niet opgenomen"&&(sn+=`<br/><span class="text-xs text-gray-600">${ae}: ${Ve}</span>`)}en.push(sn)}}catch(He){console.warn("WMS GetFeatureInfo failed:",He)}}return en},dr=async Ft=>{const jn=[],en=[],$o=ke=>{if(!ke)return;const Ae=ke.getType(),z=ke.clone().transform("EPSG:3857","EPSG:4326").getCoordinates();return{type:Ae,coordinates:z}},Gi=ASt(Ft.coordinate),Ds=[];t.forEachFeatureAtPixel(Ft.pixel,ke=>{Ds.push(ke)});for(const ke of Ds){const Ae=ke.getProperties(),{geometry:sn,...z}=Ae;if(z.vondst){const ee=z.vondst,ge=`<strong>${ee.objectType}</strong>
            <div data-vondst-id="${ee.id}"></div>
            <br/><span class="text-sm text-gray-600"><strong>Materiaal:</strong> ${ee.material}</span>
            <br/><span class="text-sm text-gray-600"><strong>Periode:</strong> ${ee.period}</span>
            ${ee.depth?`<br/><span class="text-sm text-gray-600"><strong>Diepte:</strong> ${ee.depth} cm</span>`:""}
            ${ee.condition&&ee.condition!=="Onbekend"?`<br/><span class="text-sm text-gray-600"><strong>Conditie:</strong> ${ee.condition}</span>`:""}
            ${ee.weight?`<br/><span class="text-sm text-gray-600"><strong>Gewicht:</strong> ${ee.weight} gram</span>`:""}
            ${ee.notes?`<br/><span class="text-sm text-gray-600"><strong>Notities:</strong> ${ee.notes}</span>`:""}
            ${ee.photoUrl?`<br/><a href="${ee.photoUrl}" target="_blank" rel="noopener" class="text-blue-600 hover:underline text-sm"> Bekijk foto</a>`:""}
            <br/><span class="text-xs text-gray-400">${new Date(ee.timestamp).toLocaleDateString("nl-NL")}</span>`;jn.push(ge),en.push(null),P(ee.id);continue}if(z.layerType==="customPoint"&&z.customPoint){const ee=z.customPoint,ge=z.customLayerName||"Mijn Laag",je=z.customLayerColor||"#f97316";let Je="";if(ee.popupContent?(Je=`<div class="flex items-center gap-2 mb-2 pb-2 border-b border-gray-100">
              <span class="w-3 h-3 rounded-full flex-shrink-0" style="background-color: ${je}"></span>
              <span class="text-xs font-medium" style="color: ${je}">${ge}</span>
            </div>`,Je+=ee.popupContent):(Je=`<strong>${ee.name}</strong>`,Je+=`<br/><span class="text-xs text-gray-500">${ge}</span>`,ee.category&&ee.category!=="Overig"&&(Je+=`<br/><span class="text-sm text-gray-600"><strong>Categorie:</strong> ${ee.category}</span>`)),ee.photos&&ee.photos.length>0){Je+='<div class="flex flex-wrap gap-1 my-2">';for(const Ge of ee.photos.slice(0,3)){const nt=Ge.thumbnailUrl||Ge.thumbnailBase64;nt&&(Je+=`<img src="${nt}" alt="Foto" class="w-16 h-16 object-cover rounded border border-gray-200" />`)}ee.photos.length>3&&(Je+=`<span class="text-xs text-gray-400 self-end">+${ee.photos.length-3} meer</span>`),Je+="</div>"}ee.notes&&!ee.popupContent&&(Je+=`<br/><span class="text-sm text-gray-600 mt-1">${ee.notes}</span>`),ee.url&&(Je+=`<br/><a href="${ee.url}" target="_blank" rel="noopener" class="text-blue-600 hover:underline text-sm">Meer info</a>`),Je+=`<br/><span class="text-xs text-gray-400">${new Date(ee.createdAt).toLocaleDateString("nl-NL")}</span>`,jn.push(Je),en.push(null);continue}if(z.layerType==="importedLayer"){const ee=z.layerName||"Gemporteerde laag",ge=z.layerColor||"#8b5cf6",je=["layerType","layerId","layerName","layerColor","featureIndex","geometry"],Je=z.name||z.Name||z.naam||z.title||z.NAAM||z.NAME||z.label||z.description||"Feature";let Ge=`<strong style="color: ${ge}">${Je}</strong>`;Ge+=`<br/><span class="text-xs text-gray-500">${ee}</span>`;const nt=Object.entries(z).filter(([et])=>!je.includes(et)&&et!=="name"&&et!=="Name");if(nt.length>0){Ge+='<div class="mt-2 space-y-1">';for(const[et,Mt]of nt)if(Mt!=null&&Mt!==""){const zt=et.replace(/_/g," ").replace(/([a-z])([A-Z])/g,"$1 $2").replace(/^./,q=>q.toUpperCase());let yn=String(Mt);yn.length>200&&(yn=yn.substring(0,200)+"..."),yn.startsWith("http://")||yn.startsWith("https://")?Ge+=`<div class="text-sm"><span class="text-gray-500">${zt}:</span> <a href="${yn}" target="_blank" rel="noopener" class="text-blue-600 hover:underline">Link</a></div>`:Ge+=`<div class="text-sm"><span class="text-gray-500">${zt}:</span> <span class="text-gray-700">${yn}</span></div>`}Ge+="</div>"}jn.push(Ge),en.push({geometry:$o(sn),properties:z,popupHtml:Ge});continue}if(z.kwaliteitswaarde&&z.kwaliteitswaarde.includes("archeologische waarde")){const ee=bt(z);jn.push(ee),en.push({geometry:$o(sn),properties:z,popupHtml:ee});continue}if(z.layerType==="romeinsFort"||z.layerType==="romeinsFortLijn"){const ee=z.Name||z.name||"";z.description;const ge=SSt[ee]||null,je=ge||TSt;let Je=`<strong class="text-red-800">${ge?je.naam:ee||"Romeins Fort"}</strong>`;if(Je+=`<br/><span class="text-sm text-red-700">${kSt[je.type]||je.type}</span>`,Je+=`<br/><span class="text-sm text-gray-500">${je.periode}</span>`,z.layerType==="romeinsFortLijn"&&(Je+='<br/><span class="text-sm text-red-600"> Gereconstrueerde fortomtrek</span>'),Je+=`<br/><span class="text-xs text-gray-600 mt-1 block">${je.beschrijving}</span>`,ge?.bronnen&&ge.bronnen.length>0){const Ge=ge.bronnen[0].replace(/^https?:\/\//,"").split("/")[0];Je+=`<br/><a href="${ge.bronnen[0]}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline text-xs">${Ge}</a>`}jn.push(Je),en.push({geometry:$o(sn),properties:z,popupHtml:Je});continue}let Et=z.name||z.Name||z.naam||z.title||z.NAAM||z.NAME||z.label||z.route_name||z.road_name;Et||(z.leisure==="playground"?Et="Speeltuin":z.leisure==="park"?Et="Park":z.leisure==="swimming_area"||z.sport==="swimming"?Et="Zwemplek":z.tourism==="museum"?Et="Museum":z.amenity==="cafe"||z.amenity==="restaurant"?Et=z.amenity==="cafe"?"Caf":"Restaurant":z.historic==="castle"?Et="Kasteel":Et="Info"),(z.bunker_type||z.name&&(z.name.toLowerCase().includes("bunker")||z.name.toLowerCase().includes("kazemat")||z.name.toLowerCase().includes("schuilplaats")))&&(Et="Bunker"),z.historic==="battlefield"&&(Et="Historisch slagveld");let X=`<strong>${Et}</strong>`,ae=!1;if(z.category&&(X+=`<br/><span class="text-sm text-gray-600">Categorie: ${z.category}</span>`),z.from_to&&z.from_to!==Et&&(X+=`<br/><span class="text-sm text-gray-600">${z.from_to}</span>`),z.route&&z.route!==Et&&(X+=`<br/><span class="text-sm text-gray-600">${z.route}</span>`),z.TOPONIEM&&(X+=`<br/><span class="text-sm font-semibold text-gray-800">${z.TOPONIEM}</span>`,z.PLAATS&&(X+=`<br/><span class="text-xs text-gray-500">${z.PLAATS}</span>`)),(z.AARD_VINDP||z.Aard_vindp)&&(X+=`<br/><span class="text-sm text-gray-700">Aard: ${z.AARD_VINDP||z.Aard_vindp}</span>`),z.BEGIN_PER&&z.EIND_PER&&(X+=`<br/><span class="text-sm text-purple-700">Periode: ${z.BEGIN_PER} - ${z.EIND_PER}</span>`),(z.AARD_OPM||z.Aard_opmer)&&(X+=`<br/><span class="text-xs text-gray-600 italic">${z.AARD_OPM||z.Aard_opmer}</span>`),z.Gemeente&&(X+=`<br/><span class="text-sm text-gray-600">Gemeente: ${z.Gemeente}</span>`),z.Bron&&(X+=`<br/><span class="text-xs text-gray-500">Bron: ${z.Bron}</span>`),z.Bron_besch&&(X+=`<br/><span class="text-xs text-gray-500">${z.Bron_besch}</span>`),z.Dat_st_z&&z.Dat_ei_z&&(X+=`<br/><span class="text-sm text-purple-700">Datering: ${z.Dat_st_z} - ${z.Dat_ei_z}</span>`),z.Begin&&z.Einde&&(X+=`<br/><span class="text-sm text-purple-700">Periode: ${z.Begin} - ${z.Einde}</span>`),z.Uiterwaard&&(X+=`<br/><span class="text-sm font-semibold">${z.Uiterwaard}</span>`),z.rivier&&(X+=`<br/><span class="text-sm text-blue-600">Rivier: ${z.rivier}</span>`),z.Beschrijvi&&(X+=`<br/><span class="text-sm text-gray-700">${z.Beschrijvi}</span>`),z.leisure==="park"){ae=!0,X=`<strong class="text-green-800">${z.name||"Park"}</strong>`,X+='<br/><span class="text-sm text-gray-800">Park</span>',z.description&&(X+=`<div class="mt-2 text-sm text-gray-700">${z.description}</div>`),z.area&&(X+=`<br/><span class="text-sm text-gray-600">Oppervlakte: ${z.area}</span>`);const ge=[];if(z.dog==="yes"&&ge.push("Honden toegestaan"),z.lit==="yes"&&ge.push("Verlicht"),z.bench==="yes"&&ge.push("Bankjes"),ge.length>0&&(X+=`<br/><span class="text-sm text-gray-600">${ge.join("  ")}</span>`),z.operator&&(X+=`<br/><span class="text-xs text-gray-500">Beheer: ${z.operator}</span>`),X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Tip voor detectie</span></div>',X+='<div class="text-sm text-gray-700">Parken zijn populair bij detectoristen. Mensen verliezen hier munten en sieraden. Vraag eerst toestemming aan de gemeente of beheerder.</div>',z.website){const je=z.website.replace(/^https?:\/\//,"").split("/")[0];X+=`<div class="mt-2"><a href="${z.website}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline text-sm">${je}</a></div>`}}else z.leisure==="playground"&&(ae=!0,X=`<strong class="text-orange-800">${z.name||"Speeltuin"}</strong>`,X+='<br/><span class="text-sm text-gray-800">Speeltuin</span>',z.description&&(X+=`<div class="mt-2 text-sm text-gray-700">${z.description}</div>`));if(z.tourism==="museum"||z.museum){ae=!0;const ee=z.name||"Museum",ge=z.museum||z["museum:type"]||"",Je=ge&&ge!=="yes"?{art:"Kunstmuseum",history:"Geschiedenismuseum",archaeology:"Archeologisch museum",science:"Wetenschapsmuseum",technology:"Techniekmuseum",nature:"Natuurmuseum",open_air:"Openluchtmuseum",local:"Streekmuseum",military:"Militair museum",railway:"Spoorwegmuseum",maritime:"Maritiem museum",children:"Kindermuseum"}[ge.toLowerCase()]||ge:"Museum";if(X=`<strong class="text-purple-800">${ee}</strong>`,X+=`<br/><span class="text-sm text-purple-600">${Je}</span>`,z.description&&(X+=`<div class="mt-2 text-sm text-gray-700">${z.description}</div>`),z.fee){const Ge=z.fee==="yes"?"Toegangsprijs":z.fee==="no"?"Gratis toegang":z.fee;X+=`<div class="mt-2"><span class="text-sm text-gray-600">${Ge}</span></div>`}if(z.opening_hours){const Ge=fae(String(z.opening_hours));X+=`<div class="mt-2"><span class="text-xs text-green-600">Open: ${Ge}</span></div>`}if(z.website||z.url){const Ge=z.website||z.url;X+=`<div class="mt-1"><a href="${Ge}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline text-sm">Bezoek ${ee}</a></div>`}if(z.wikipedia){const Ge=z.wikipedia.split(":")[0]||"nl",nt=z.wikipedia.split(":")[1]||z.wikipedia;X+=`<div class="text-sm"><a href="https://${Ge}.wikipedia.org/wiki/${encodeURIComponent(nt)}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Meer info op Wikipedia</a></div>`}if(z["addr:street"]||z["addr:housenumber"]||z["addr:city"]){if(X+='<div class="mt-2 text-xs text-gray-400">',z["addr:street"]||z["addr:housenumber"]){const Ge=[z["addr:street"],z["addr:housenumber"]].filter(Boolean).join(" ");Ge&&(X+=`${Ge}<br/>`)}z["addr:city"]&&(X+=`${z["addr:postcode"]||""} ${z["addr:city"]}`),X+="</div>"}}if(z.leisure==="swimming_area"||z.sport==="swimming"||z.natural==="beach"){ae=!0,X=`<strong class="text-cyan-800">${z.name||"Zwemplek"}</strong>`;const ge=z.natural==="beach"?"Strand":z.leisure==="swimming_area"?"Zwemplek":"Zwemwater";X+=`<br/><span class="text-sm text-gray-800">${ge}</span>`,z.water&&(X+=`<br/><span class="text-sm text-gray-700">${{lake:"Meer",river:"Rivier",pond:"Vijver",reservoir:"Reservoir",canal:"Kanaal"}[z.water]||z.water}</span>`),z.supervised==="yes"&&(X+='<br/><span class="text-sm text-green-700">Met toezicht</span>'),z.changing_rooms==="yes"&&(X+='<br/><span class="text-sm text-gray-600">Kleedruimte aanwezig</span>'),z.description&&(X+=`<div class="mt-2 text-sm text-gray-700">${z.description}</div>`),X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Tip voor detectie</span></div>',X+='<div class="text-sm text-gray-700">Zwemplekken kunnen interessant zijn voor detectie. Mensen verliezen hier sieraden en munten. Let op: niet overal is detecteren toegestaan.</div>'}if(z.osm_id&&z.address!==void 0&&(X+='<br/><span class="text-sm text-lime-700">Kringloopwinkel</span>',z.address&&(X+=`<br/><span class="text-xs text-gray-500">${z.address}</span>`),z.phone&&(X+=`<br/><span class="text-xs text-gray-600">${z.phone}</span>`)),z.site_type==="tumulus"){ae=!0;const ee=ke.getGeometry()?.getCoordinates();let ge="",je="";if(ee){const Je=Fn(ee),Ge=Je[0],nt=Je[1];Ge>5.5&&Ge<6.3&&nt>52&&nt<52.5?(ge="Veluwe",je="De Veluwe heeft de grootste concentratie grafheuvels van Nederland. Veel heuvels liggen in grafvelden met tientallen heuvels bij elkaar."):Ge>6.2&&Ge<7.1&&nt>52.6&&nt<53.3?(ge="Drenthe",je="Drenthe is beroemd om zijn prehistorische monumenten. Naast hunebedden liggen hier honderden grafheuvels uit de Bronstijd."):Ge>4.5&&Ge<6&&nt>51.3&&nt<51.9?(ge="Noord-Brabant",je="Op de Brabantse zandgronden liggen veel grafheuvels, vaak in kleine groepjes op hogere gronden."):Ge>5.5&&Ge<6.3&&nt>50.7&&nt<51.6?(ge="Limburg",je="De Limburgse heuvels en plateaus herbergen grafheuvels uit verschillende periodes, van Bronstijd tot Romeinse tijd."):Ge>5&&Ge<5.6&&nt>52&&nt<52.4&&(ge="Utrechtse Heuvelrug",je="De stuwwallen van de Utrechtse Heuvelrug en het Gooi waren al in de prehistorie bewoond. Grafheuvels markeren de laatste rustplaats van de vroege bewoners.")}X+='<br/><span class="text-sm text-amber-700">Grafheuvel uit de Bronstijd of IJzertijd</span>',ge&&(X+=`<br/><span class="text-sm text-gray-500">${ge}</span>`),X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',X+='<div class="text-sm text-gray-700 mt-1">Een grafheuvel is een kunstmatige heuvel over een of meerdere graven. De meeste Nederlandse grafheuvels zijn 3000 tot 4000 jaar oud, uit de Bronstijd (2000-800 v.Chr.) of vroege IJzertijd.</div>',je&&(X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Over deze regio</span></div>',X+=`<div class="text-sm text-gray-700 mt-1">${je}</div>`),X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Hoe herken je een grafheuvel?</span></div>',X+='<div class="text-sm text-gray-700 mt-1">Grafheuvels zijn vaak ronde, lage heuvels van 10-30 meter doorsnee en 1-3 meter hoog. Ze liggen meestal op zandgronden, vaak in groepjes (grafvelden). Let op de kenmerkende ronde vorm in het landschap.</div>',z.wikidata?(X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer informatie</span></div>',X+=`<div class="text-sm text-gray-700 mt-1"><a href="https://www.wikidata.org/wiki/${z.wikidata}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Bekijk op Wikidata</a></div>`):(X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer informatie</span></div>',X+='<div class="text-sm text-gray-700 mt-1"><a href="https://nl.wikipedia.org/wiki/Grafheuvel" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Lees meer over grafheuvels op Wikipedia</a></div>')}if(z.historic==="castle"||z.castle_type){ae=!0;const ee={manor:{label:"Landhuis",uitleg:"Een landhuis of havezate was het woonhuis van een adellijke familie. Vaak met een landgoed eromheen.",vondsten:"Sieraden, gespen, munten, aardewerk van rijke bewoners"},stately:{label:"Statig huis",uitleg:"Een groot en deftig woonhuis, vaak van welgestelde families. Soms met kasteelachtige kenmerken.",vondsten:"Huishoudelijke voorwerpen, munten, knopen, aardewerk"},fortress:{label:"Fort/Vesting",uitleg:"Een versterkte militaire bouwwerk, gebouwd om een gebied te verdedigen.",vondsten:"Militaire voorwerpen, kogels, gespen, uniformonderdelen"},defensive:{label:"Verdedigingskasteel",uitleg:"Een kasteel gebouwd voor verdediging, met dikke muren, een gracht en torens.",vondsten:"Wapens, harnasonderdelen, pijlpunten, middeleeuwse munten"},palace:{label:"Paleis",uitleg:"Een groot en luxueus gebouw voor koningen, prinsen of zeer rijke families.",vondsten:"Luxe voorwerpen, sieraden, zegels, zeldzame munten"},castrum:{label:"Romeins fort",uitleg:"Een Romeins legerkamp of fort. Deze zijn bijna 2000 jaar oud!",vondsten:"Romeinse munten, fibulae, militaria, aardewerk"},citadel:{label:"Citadel",uitleg:"Een sterk versterkte kern binnen een stad, als laatste verdedigingslinie.",vondsten:"Militaire voorwerpen uit verschillende periodes"}},ge=z.castle_type?ee[z.castle_type]:null,je=ge?.label||"Kasteel";if(X+=`<br/><span class="text-sm text-purple-700">${je}</span>`,z.start_date&&(X+=`<br/><span class="text-xs text-gray-500">Bouwjaar: ${z.start_date}</span>`),z.heritage&&(X+='<br/><span class="text-sm text-amber-700">Rijksmonument</span>'),X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',ge?X+=`<div class="text-sm text-gray-700 mt-1">${ge.uitleg}</div>`:X+='<div class="text-sm text-gray-700 mt-1">Een historisch kasteel of adellijk huis. Kastelen waren vaak het middelpunt van macht en rijkdom in een gebied.</div>',X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',ge?X+=`<div class="text-sm text-gray-700 mt-1">${ge.vondsten}</div>`:X+='<div class="text-sm text-gray-700 mt-1">Munten, sieraden, gespen, aardewerk en andere voorwerpen van de vroegere bewoners.</div>',z.wikipedia||z.website){if(X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',z.wikipedia){const Je=z.wikipedia.startsWith("http")?z.wikipedia:`https://nl.wikipedia.org/wiki/${z.wikipedia.replace(/^nl:/,"")}`;X+=`<div class="text-sm text-gray-700 mt-1"><a href="${Je}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a></div>`}z.website&&(X+=`<div class="text-sm text-gray-700 mt-1"><a href="${z.website}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Website bezoeken</a></div>`)}}if(z.historic==="ruins"){const ee=z.ruins_type||"";let ge="Rune",je="Een rune is wat overblijft van een oud gebouw. Het kan een kerk, kasteel, molen of ander bouwwerk zijn geweest.",Je="Baksteenfragmenten, aardewerk, metalen voorwerpen van vroegere bewoners of gebruikers";if(ee.toLowerCase().includes("church")||ee.toLowerCase().includes("kerk")?(ge="Kerkrune",je="De overblijfselen van een oude kerk. Vaak nog te herkennen aan de fundering of een paar muren.",Je="Religieuze voorwerpen, munten van kerkgangers, knopen, gespen"):ee.toLowerCase().includes("castle")||ee.toLowerCase().includes("kasteel")?(ge="Kasteelrune",je="De resten van een middeleeuws kasteel. Soms is alleen de gracht of fundering nog zichtbaar.",Je="Middeleeuwse munten, sieraden, harnasonderdelen, pijlpunten"):ee.toLowerCase().includes("mill")||ee.toLowerCase().includes("molen")?(ge="Molenrune",je="Wat rest van een oude molen. Vaak nog te zien aan de stenen fundering of de molenberg.",Je="Gereedschap, munten, huishoudelijke voorwerpen"):ee.toLowerCase().includes("fort")&&(ge="Fortrune",je="De overblijfselen van een militair fort of verdedigingswerk.",Je="Militaire voorwerpen, kogels, gespen, uniformonderdelen"),X+=`<br/><span class="text-sm text-amber-700">${ge}</span>`,X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',X+=`<div class="text-sm text-gray-700 mt-1">${je}</div>`,X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',X+=`<div class="text-sm text-gray-700 mt-1">${Je}</div>`,z.description&&(X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Beschrijving</span></div>',X+=`<div class="text-sm text-gray-700 mt-1">${z.description}</div>`),z.wikipedia){const Ge=z.wikipedia.startsWith("http")?z.wikipedia:`https://${z.wikipedia.split(":")[0]||"nl"}.wikipedia.org/wiki/${z.wikipedia.replace(/^[a-z]{2}:/,"")}`;X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',X+=`<div class="text-sm text-gray-700 mt-1">Lees meer op <a href="${Ge}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a></div>`}}if(z.bunker_type||z.name&&(z.name.toLowerCase().includes("bunker")||z.name.toLowerCase().includes("kazemat")||z.name.toLowerCase().includes("schuilplaats"))){ae=!0;const ee={munitions:"Munitiebunker",personnel_shelter:"Personeelsschuilplaats",personell_shelter:"Personeelsschuilplaats",command:"Commandobunker",gun_emplacement:"Geschutsbunker",mg_nest:"Mitrailleursnest",technical:"Technische bunker",storage:"Opslagbunker",tobruk:"Tobruk",kazemat:"Kazemat",Flak:"Luchtafweerstelling",hardened_aircraft_shelter:"Vliegtuigshelter",shelter:"Schuilkelder",observation:"Observatiebunker",anti_aircraft:"Luchtafweerstelling"},ge=z.name||"",je=z.bunker_type?ee[z.bunker_type]||z.bunker_type:"";ge&&ge!=="Bunker"&&(X+=`<br/><span class="text-sm font-semibold text-gray-700">${ge}</span>`),je&&je!==ge&&(X+=`<br/><span class="text-xs text-gray-500">${je}</span>`);const Je=ke.getGeometry()?.getCoordinates();let Ge="",nt="",et="";if(Je){const Mt=Fn(Je),zt=Mt[0],yn=Mt[1],q=zt<4.8||zt<5.2&&yn>51.8&&yn<53.5,re=zt>4.2&&zt<4.4&&yn>52&&yn<52.15,J=zt>4.5&&zt<4.7&&yn>52.4&&yn<52.5,te=zt>4&&zt<4.2&&yn>51.95&&yn<52.05,se=zt<4.2&&yn<51.6,oe=zt>5.2&&zt<5.8&&yn>51.9&&yn<52.3;re?(Ge="Deze bunker maakt deel uit van de Atlantikwall bij Scheveningen. De Duitsers bouwden hier tijdens WOII zo'n 80 bunkers in de duinen. De muren zijn soms 3 meter dik beton. Voor deze bunkers moesten 138.000 mensen uit Den Haag en Scheveningen hun huis verlaten.",nt="https://nl.wikipedia.org/wiki/Atlantikwall_Museum_Scheveningen",et="Atlantikwall Museum Scheveningen"):J?(Ge="Deze bunker hoort bij Festung IJmuiden, een van de zwaarst verdedigde punten van de Atlantikwall. De Duitsers bouwden hier bunkers om de haventoegang te beschermen. Er zijn nu rondleidingen door het Bunkermuseum.",nt="https://www.bunkermuseum.nl/",et="Bunkermuseum IJmuiden"):te?(Ge="Deze bunker maakt deel uit van de Atlantikwall bij Hoek van Holland. Dit was een strategisch punt voor de Duitsers vanwege de Nieuwe Waterweg. Veel bunkers zijn nog te bezoeken.",nt="https://www.atlantikwallhoekvanholland.nl/",et="Atlantikwall Hoek van Holland"):se?(Ge="Deze bunker hoort bij de Atlantikwall in Zeeland. De Duitsers verdedigden hier de Westerschelde en de kust. Bij Zoutelande en Westkapelle zijn veel bunkers bewaard gebleven.",nt="https://www.bunkermuseumzoutelande.nl/",et="Bunkermuseum Zoutelande"):q?(Ge="Deze bunker maakt deel uit van de Atlantikwall: de Duitse verdedigingslinie langs de hele kust van Europa. In Nederland bouwden de Duitsers duizenden bunkers tussen 1942 en 1944.",nt="https://nl.wikipedia.org/wiki/Atlantikwall",et="Atlantikwall (Wikipedia)"):oe?(Ge="Deze bunker hoort mogelijk bij de Grebbelinie of de Nieuwe Hollandse Waterlinie. Dit waren Nederlandse verdedigingslinies die de Duitsers na 1940 versterkten met bunkers.",nt="https://nl.wikipedia.org/wiki/Grebbelinie",et="Grebbelinie (Wikipedia)"):(Ge="Een bunker uit de Tweede Wereldoorlog. De meeste bunkers in Nederland zijn gebouwd tussen 1940 en 1944, als onderdeel van de Duitse verdediging of langs bestaande Nederlandse linies.",nt="https://nl.wikipedia.org/wiki/Atlantikwall",et="WOII bunkers (Wikipedia)")}else Ge="Een bunker uit de Tweede Wereldoorlog.",nt="https://nl.wikipedia.org/wiki/Atlantikwall",et="WOII bunkers (Wikipedia)";X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',X+=`<div class="text-sm text-gray-700 mt-1">${Ge}</div>`,X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je vinden?</span></div>',X+='<div class="text-sm text-gray-700 mt-1">Bij bunkers worden soms voorwerpen gevonden zoals patronen, uniformknopen, gespen en persoonlijke spullen van soldaten.</div>',X+='<div class="mt-2 text-xs text-gray-500 italic">Let op: betreed nooit een bunker zonder toestemming. Raak munitieresten niet aan.</div>',X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bronnen</span></div>',X+='<div class="text-sm text-gray-700 mt-1">',X+=`<a href="${nt}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">${et}</a>`,z.website?X+=`<br/><a href="${z.website}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">TracesOfWar</a>`:X+='<br/><a href="https://www.tracesofwar.nl/" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">TracesOfWar</a>',X+="</div>"}if(z.historic==="battlefield"){ae=!0;const ee=z.name||"Onbekend slagveld",je={"Slag om Arnhem":{periode:"September 1944",samenvatting:"De Slag om Arnhem was onderdeel van Operatie Market Garden. Geallieerde parachutisten probeerden de brug over de Rijn te veroveren. Na negen dagen hevige gevechten moesten ze zich terugtrekken. Van de 10.000 Britse soldaten werden er 1.500 gedood en 6.500 krijgsgevangen gemaakt.",watZieJe:"Er zijn veel monumenten en infoborden. Het Airborne Museum in Oosterbeek vertelt het hele verhaal. Elk jaar in september is er een herdenking.",uitkomst:"De geallieerden verloren de slag. Nederland bleef nog tot mei 1945 bezet.",wikiUrl:"https://nl.wikipedia.org/wiki/Slag_om_Arnhem"},"Slag om de Sloedam":{periode:"1-2 november 1944",samenvatting:"Canadese soldaten vielen de Sloedam aan om Walcheren te bevrijden. De dam was smal en de Duitsers verdedigden fel. Veel soldaten sneuvelden bij deze bloedige aanval.",watZieJe:"Bij de dam staat een monument voor de gevallen Canadezen. Er zijn infoborden die de slag uitleggen.",uitkomst:"De Canadezen wonnen na zware verliezen. Dit opende de weg naar de bevrijding van Walcheren.",wikiUrl:"https://nl.wikipedia.org/wiki/Slag_om_de_Sloedam"},"Slag bij Heiligerlee (1568)":{periode:"23 mei 1568",samenvatting:"De eerste veldslag van de Tachtigjarige Oorlog. Lodewijk van Nassau versloeg het Spaanse leger. Zijn broer Adolf sneuvelde tijdens de strijd.",watZieJe:"In Heiligerlee staat het Slag bij Heiligerlee monument. Het klooster waar Adolf van Nassau begraven ligt is nog te bezoeken.",uitkomst:"De opstandelingen wonnen, maar dit was pas het begin van 80 jaar oorlog.",wikiUrl:"https://nl.wikipedia.org/wiki/Slag_bij_Heiligerlee_(1568)"},Overloon:{periode:"Oktober 1944",samenvatting:"Bij Overloon vochten Britten en Amerikanen tegen de Duitsers. Het was een van de zwaarste tankgevechten op Nederlandse bodem. Het dorp werd volledig verwoest.",watZieJe:"Het Oorlogsmuseum Overloon staat op het voormalige slagveld. Je kunt tanks, vliegtuigen en andere voertuigen zien.",uitkomst:"De geallieerden wonnen na wekenlange gevechten.",wikiUrl:"https://nl.wikipedia.org/wiki/Slag_om_Overloon"},"Slagveld Lanakerveld":{periode:"1568",samenvatting:"Onderdeel van de Nederlandse opstand tegen Spanje. Hier vonden gevechten plaats tijdens de beginjaren van de Tachtigjarige Oorlog.",watZieJe:"Het gebied is nu grotendeels landbouwgrond. Lokaal zijn er soms infoborden.",uitkomst:"Onderdeel van de lange strijd tegen de Spaanse overheersing.",wikiUrl:"https://nl.wikipedia.org/wiki/Tachtigjarige_Oorlog"},Blessebrugschans:{periode:"Diverse periodes",samenvatting:"Een historische schans die meerdere keren werd gebruikt in militaire conflicten.",watZieJe:"De resten van de schans zijn nog zichtbaar in het landschap.",uitkomst:"De schans speelde een rol in verschillende conflicten.",wikiUrl:"https://nl.wikipedia.org/wiki/Schans_(vestingwerk)"}}[ee];if(ee!=="Onbekend slagveld"&&ee!=="Historisch slagveld"&&(X+=`<br/><span class="text-sm font-semibold text-red-700">${ee}</span>`),je)X+=`<br/><span class="text-xs text-gray-500">${je.periode}</span>`,X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat gebeurde hier?</span></div>',X+=`<div class="text-sm text-gray-700 mt-1">${je.samenvatting}</div>`,X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Hoe liep het af?</span></div>',X+=`<div class="text-sm text-gray-700 mt-1">${je.uitkomst}</div>`,X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je zien?</span></div>',X+=`<div class="text-sm text-gray-700 mt-1">${je.watZieJe}</div>`,X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bronnen</span></div>',X+='<div class="text-sm text-gray-700 mt-1">',X+=`<a href="${je.wikiUrl}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a>`,ee.includes("Arnhem")&&(X+='<br/><a href="https://www.airbornemuseum.nl/" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Airborne Museum Oosterbeek</a>'),ee.includes("Overloon")&&(X+='<br/><a href="https://www.oorlogsmuseum.nl/" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Oorlogsmuseum Overloon</a>'),X+="</div>";else if(z.date&&(X+=`<br/><span class="text-xs text-gray-500">${z.date}</span>`),z.description?(X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat gebeurde hier?</span></div>',X+=`<div class="text-sm text-gray-700 mt-1">${z.description}</div>`):(X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat gebeurde hier?</span></div>',X+='<div class="text-sm text-gray-700 mt-1">Op deze plek vonden historische gevechten plaats. Zoek lokaal naar infoborden of monumenten.</div>'),z.wikipedia){const Je=z.wikipedia.startsWith("http")?z.wikipedia:`https://nl.wikipedia.org/wiki/${z.wikipedia.replace("nl:","")}`;X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bronnen</span></div>',X+=`<div class="text-sm text-gray-700 mt-1"><a href="${Je}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a></div>`}}if(z.bron==="Paleobiology Database"){const ee=Ge=>{const nt={Mollusca:"weekdieren zoals schelpen en slakken",Brachiopoda:"armpotigen, schelp-achtige dieren",Echinodermata:"stekelhuidigen zoals zee-egels en zeesterren",Chordata:"gewervelde dieren",Arthropoda:"geleedpotigen zoals kreeften en trilobieten",Cnidaria:"neteldieren zoals koralen en kwallen",Bryozoa:"mosdiertjes",Foraminifera:"eencellige schelpdieren",Plantae:"planten",Crinoidea:"zeelelies",Gastropoda:"slakken",Bivalvia:"tweekleppigen zoals mossels en oesters",Cephalopoda:"koppotigen zoals inktvissen en ammonieten",Trilobita:"trilobieten, uitgestorven kreeftachtigen",Mammalia:"zoogdieren",Reptilia:"reptielen",Pisces:"vissen",Amphibia:"amfibien"};for(const[et,Mt]of Object.entries(nt))if(Ge.toLowerCase().includes(et.toLowerCase()))return Mt;return""},ge=Ge=>{const nt={Cambrium:"541-485 miljoen jaar geleden",Ordovicium:"485-444 miljoen jaar geleden",Siluur:"444-419 miljoen jaar geleden",Devoon:"419-359 miljoen jaar geleden",Carboon:"359-299 miljoen jaar geleden",Perm:"299-252 miljoen jaar geleden",Trias:"252-201 miljoen jaar geleden",Jura:"201-145 miljoen jaar geleden",Krijt:"145-66 miljoen jaar geleden",Paleogeen:"66-23 miljoen jaar geleden",Neogeen:"23-2,6 miljoen jaar geleden",Kwartair:"2,6 miljoen jaar - nu",Pleistoceen:"2,6 miljoen - 11.700 jaar geleden",Holoceen:"11.700 jaar geleden - nu"};for(const[et,Mt]of Object.entries(nt))if(Ge.toLowerCase().includes(et.toLowerCase()))return Mt;return""},je=Ge=>{const nt={limestone:"kalksteen",sandstone:"zandsteen",shale:"schalie",clay:"klei",sand:"zand",gravel:"grind",marl:"mergel",chalk:"krijt",mudstone:"moddersteen",siltstone:"siltsteen"};let et=Ge;for(const[Mt,zt]of Object.entries(nt))et=et.replace(new RegExp(Mt,"gi"),zt);return et},Je=Ge=>{const nt={marine:"zee",coastal:"kust",terrestrial:"land",fluvial:"rivier",lacustrine:"meer",reef:"rif",deltaic:"delta",shallow:"ondiep water",deep:"diep water"};let et=Ge;for(const[Mt,zt]of Object.entries(nt))et=et.replace(new RegExp(Mt,"gi"),zt);return et};if(z.vindplaats&&(X+=`<br/><span class="text-xs text-gray-600">${z.vindplaats}</span>`),X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is hier gevonden?</span></div>',z.taxonomie&&z.taxonomie!=="Onbekend"){const Ge=ee(z.taxonomie);Ge?(X+=`<div class="text-sm text-gray-700 mt-1">${Ge}</div>`,X+=`<div class="text-xs text-gray-500 italic">(${z.taxonomie})</div>`):X+=`<div class="text-sm text-gray-700 mt-1">${z.taxonomie}</div>`}if(z.aantal_fossielen){const Ge=parseInt(z.aantal_fossielen),nt=Ge>100?"Veel fossielen gevonden op deze locatie.":Ge>10?"Meerdere fossielen gevonden op deze locatie.":`${z.aantal_fossielen} fossiel${Ge>1?"en":""} gevonden op deze locatie.`;X+=`<div class="text-sm text-gray-600 mt-1">${nt}</div>`}if(z.periode&&z.periode!=="Onbekend"){X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wanneer leefden deze dieren?</span></div>';const Ge=ge(z.periode);X+=`<div class="text-sm text-gray-700 mt-1">${z.periode}</div>`,Ge&&(X+=`<div class="text-sm text-gray-600">${Ge}</div>`),z.ouderdom&&z.ouderdom!=="Onbekend"&&(X+=`<div class="text-sm text-gray-600">Ouderdom: ${z.ouderdom}</div>`)}(z.gesteente||z.formatie||z.milieu)&&(X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">In wat voor gesteente?</span></div>',z.gesteente&&(X+=`<div class="text-sm text-gray-700 mt-1">${je(z.gesteente)}</div>`),z.formatie&&(X+=`<div class="text-sm text-gray-600">Formatie: ${z.formatie}</div>`,z.lid&&(X+=`<div class="text-sm text-gray-600 ml-3">Lid: ${z.lid}</div>`)),z.milieu&&(X+=`<div class="text-sm text-gray-600">Leefomgeving: ${Je(z.milieu)}</div>`))}if(z.layerType==="fossielHotspot"){const ee=[];if(z.type&&ee.push(z.type),z.region&&ee.push(z.region),z.country){const ge={NL:"Nederland",BE:"Belgi",DE:"Duitsland",FR:"Frankrijk"};ee.push(ge[z.country]||z.country)}if(ee.length>0&&(X+=`<br/><span class="text-xs text-gray-600">${ee.join("  ")}</span>`),(z.finds||z.period)&&(X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kan ik er vinden?</span></div>',z.finds&&(X+=`<div class="text-sm text-gray-700 mt-1">${z.finds}</div>`),z.period&&(X+=`<div class="text-sm text-gray-600 mt-1">Periode: ${z.period}</div>`),z.geology&&(X+=`<div class="text-sm text-gray-600 mt-1">Geologie: ${z.geology}</div>`)),z.access||z.tips){if(X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Hoe kom ik er?</span></div>',z.access){const je=z.access.toLowerCase().includes("verboden")||z.access.toLowerCase().includes("niet toegankelijk")?"text-red-600":"text-gray-700";X+=`<div class="text-sm ${je} mt-1">${z.access}</div>`}z.tips&&(X+=`<div class="text-sm text-gray-600 mt-1 italic">Tip: ${z.tips}</div>`)}}if(z.layerType==="mineralenHotspot"){const ee=[];if(z.region&&ee.push(z.region),z.country){const ge={NL:"Nederland",BE:"Belgi",DE:"Duitsland",FR:"Frankrijk"};ee.push(ge[z.country]||z.country)}if(ee.length>0&&(X+=`<br/><span class="text-xs text-gray-600">${ee.join("  ")}</span>`),z.minerals&&(X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kan ik er vinden?</span></div>',X+=`<div class="text-sm text-gray-700 mt-1">${z.minerals}</div>`,z.geology&&(X+=`<div class="text-sm text-gray-600 mt-1">Geologie: ${z.geology}</div>`)),z.access||z.tips){if(X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Hoe kom ik er?</span></div>',z.access){const je=z.access.toLowerCase().includes("verboden")||z.access.toLowerCase().includes("niet toegankelijk")||z.access.toLowerCase().includes("gesloten")?"text-red-600":"text-gray-700";X+=`<div class="text-sm ${je} mt-1">${z.access}</div>`}z.tips&&(X+=`<div class="text-sm text-gray-600 mt-1 italic">Tip: ${z.tips}</div>`)}}if(z.layerType==="goudrivier"){const ee=[];if(z.river&&ee.push(z.river),z.region&&ee.push(z.region),z.country){const ge={NL:"Nederland",BE:"Belgi",DE:"Duitsland",FR:"Frankrijk"};ee.push(ge[z.country]||z.country)}if(ee.length>0&&(X+=`<br/><span class="text-xs text-gray-600">${ee.join("  ")}</span>`),(z.goldType||z.origin)&&(X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kan ik er vinden?</span></div>',z.goldType&&(X+=`<div class="text-sm text-gray-700 mt-1">${z.goldType}</div>`),z.origin&&(X+=`<div class="text-sm text-gray-600 mt-1">Herkomst: ${z.origin}</div>`)),z.legal||z.tips){if(X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Mag ik hier zoeken?</span></div>',z.legal){const je=z.legal.includes("VERBODEN")?"text-red-600 font-semibold":"text-gray-700";X+=`<div class="text-sm ${je} mt-1">${z.legal}</div>`}z.tips&&(X+=`<div class="text-sm text-gray-600 mt-1 italic">Tip: ${z.tips}</div>`)}}if(z.layerType==="wandelroute"){const ee=[];if(z.region&&ee.push(z.region),z.country){const ge={NL:"Nederland",BE:"Belgi"};ee.push(ge[z.country]||z.country)}if(ee.length>0&&(X+=`<br/><span class="text-xs text-gray-600">${ee.join("  ")}</span>`),z.distance||z.duration){const ge=z.distance?`${z.distance} km`:"",je=z.duration?`${z.duration}`:"",Je=[ge,je].filter(Boolean).join("  ");Je&&(X+=`<br/><span class="text-sm text-green-700 font-medium">${Je}</span>`)}(z.description||z.highlights)&&(X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat ga je zien?</span></div>',z.description&&(X+=`<div class="text-sm text-gray-700 mt-1">${z.description}</div>`),z.highlights&&(X+=`<div class="text-sm text-gray-600 mt-1">Hoogtepunten: ${z.highlights}</div>`)),z.startAddress&&(X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Waar begin ik?</span></div>',X+=`<div class="text-sm text-gray-700 mt-1">${z.startAddress}</div>`),z.url&&(X+=`<div class="mt-3"><a href="${z.url}" target="_blank" class="text-sm text-blue-600 hover:underline">Bekijk route en download GPX</a></div>`)}if(z.layerType==="hunebed"){z.period&&(X+=`<br/><span class="text-sm text-purple-700">Periode: ${z.period}</span>`),X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',z.description&&(X+=`<div class="text-sm text-gray-700 mt-1">${z.description}</div>`);const ee=[];if(z.stones){const ge=z.stones.toLowerCase(),je=ge.match(/(\d+)\s*dekst[^\s,]*/i),Je=ge.match(/(\d+)\s*draagst[^\s,]*/i),Ge=ge.match(/(\d+)\s*sluitst[^\s,]*/i),nt=ge.match(/(\d+)\s*poortst[^\s,]*/i),et=ge.match(/(\d+)\s*gangdekst[^\s,]*/i),Mt=ge.match(/(\d+)\s*gangzijst[^\s,]*/i);je&&ee.push(`${je[1]} deksteen${parseInt(je[1])>1?"en":""} (de grote steen${parseInt(je[1])>1?"en":""} bovenop)`),Je&&ee.push(`${Je[1]} draagstenen (de stenen die de dekstenen dragen)`),Ge&&ee.push(`${Ge[1]} sluitsteen${parseInt(Ge[1])>1?"en":""} (afsluiting aan de korte zijden)`),nt&&ee.push(`${nt[1]} poortsteen${parseInt(nt[1])>1?"en":""} (bij de ingang)`),et&&ee.push(`${et[1]} gangdeksteen${parseInt(et[1])>1?"en":""} (boven de toegangsgang)`),Mt&&ee.push(`${Mt[1]} gangzijstenen (langs de toegangsgang)`)}if(z.length&&ee.push(`Een grafkamer van ${z.length} lang`),z.width&&ee.push(`${z.width}`),ee.length>0&&(X+='<div class="text-sm text-gray-700 mt-1">Het hunebed heeft:</div>',X+='<ul class="list-disc list-inside text-sm text-gray-700 mt-1 space-y-0.5">',ee.forEach(ge=>{X+=`<li>${ge}</li>`}),X+="</ul>"),z.notable){const ge=z.notable.toLowerCase();let je="Wat is hier bijzonder?";ge.includes("grootste")?je="Waarom is dit het grootste hunebed?":ge.includes("klein")||ge.includes("kindhunebed")?je="Waarom is dit hunebed zo klein?":ge.includes("cluster")||ge.includes("naast elkaar")?je="Waarom liggen hier meerdere hunebedden?":(ge.includes("enige")||ge.includes("westelijk")||ge.includes("noordelijk"))&&(je="Wat maakt deze locatie bijzonder?"),X+=`<div class="mt-3"><span class="text-sm font-semibold text-gray-800">${je}</span></div>`,X+=`<div class="text-sm text-gray-700 mt-1">${z.notable}</div>`}X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is de Trechterbeker cultuur?</span></div>',X+='<div class="text-sm text-gray-700 mt-1">De Trechterbeker cultuur is de naam voor de mensen die 5.000 jaar geleden in Nederland woonden. Ze maakten potten met een trechter-vorm. Daarom heten ze zo. Deze mensen bouwden de hunebedden als graven voor hun doden.</div>',z.finds&&(X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is hier gevonden?</span></div>',X+=`<div class="text-sm text-gray-700 mt-1">${z.finds}</div>`),z.museum&&(X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Museum in de buurt</span></div>',X+=`<div class="text-sm text-gray-700 mt-1">${z.museum}</div>`),X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bezoeken</span></div>',z.access?X+=`<div class="text-sm text-gray-700 mt-1">${z.access}</div>`:X+='<div class="text-sm text-gray-700 mt-1">Je kunt dit hunebed gratis bezoeken.</div>',z.wikipedia&&(X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',X+=`<div class="text-sm text-gray-700 mt-1">Lees meer op <a href="${z.wikipedia}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a></div>`)}if((z.inventarisnummer||z.locatie_naam)&&(z.locatie_naam&&(X+=`<br/><span class="text-sm font-semibold">${z.locatie_naam}</span>`),z.inventarisnummer&&(X+=`<br/><span class="text-xs text-gray-500">CAI: ${z.inventarisnummer}</span>`),z.datering_tekst&&(X+=`<br/><span class="text-sm text-purple-700">${z.datering_tekst}</span>`)),(z.veensoort||z.dikte)&&(z.veensoort&&(X+=`<br/><span class="text-sm text-amber-700">${z.veensoort}</span>`),z.dikte&&(X+=`<br/><span class="text-xs text-gray-600">Dikte: ${z.dikte}</span>`)),z.nature&&z.debut){X+=`<br/><span class="text-sm text-purple-700">${z.nature}</span>`;const ee=z.debut===z.fin?z.debut:`${z.debut} - ${z.fin}`;ee&&(X+=`<br/><span class="text-sm text-gray-700">Periode: ${ee}</span>`),z.structure&&(X+=`<br/><span class="text-xs text-gray-600">${z.structure}</span>`),z.commune&&(X+=`<br/><span class="text-xs text-gray-500">${z.commune}</span>`),z.decouvert&&(X+=`<br/><span class="text-xs text-gray-400">Ontdekt: ${z.decouvert}</span>`),z.numero&&(X+=`<br/><span class="text-xs text-gray-400">${z.numero}</span>`)}if((z.NATURE_OPE||z.CODE_OPERA)&&(z.TITRE&&(X+=`<br/><span class="text-sm font-semibold">${z.TITRE}</span>`),z.NATURE_OPE&&(X+=`<br/><span class="text-sm text-amber-700">${z.NATURE_OPE}</span>`),z.AUTEUR&&(X+=`<br/><span class="text-xs text-gray-600">Auteur: ${z.AUTEUR}</span>`),z.DATE&&(X+=`<br/><span class="text-xs text-gray-500">Datum: ${z.DATE}</span>`),z.COMMUNE&&(X+=`<br/><span class="text-xs text-gray-500">${z.COMMUNE}</span>`)),z.type_protection&&(z.n_site||z.t_site)){const ee=z.type_protection==="Classe"?"text-red-700":"text-amber-700";X+=`<br/><span class="text-sm ${ee}">${z.type_protection}</span>`,z.n_site&&(X+=`<br/><span class="text-sm font-semibold">${z.n_site}</span>`),z.t_site&&(X+=`<br/><span class="text-xs text-gray-600">${z.t_site}</span>`),z.c_site&&(X+=`<br/><span class="text-xs text-gray-500">Code: ${z.c_site}</span>`),z.d_creation&&(X+=`<br/><span class="text-xs text-gray-400">Beschermd sinds: ${z.d_creation}</span>`)}if(z.type_protection&&z.cod_diren){const ee=z.type_protection==="Classe"?"text-red-700":"text-amber-700";if(X+=`<br/><span class="text-sm ${ee}">${z.type_protection}</span>`,z.proced&&(X+=`<br/><span class="text-xs text-gray-600">${z.proced}</span>`),z.d_proced&&(X+=`<br/><span class="text-xs text-gray-500">Date: ${z.d_proced}</span>`),z.comment){const ge=String(z.comment).slice(0,150);X+=`<br/><span class="text-xs text-gray-600 italic">${ge}${String(z.comment).length>150?"...":""}</span>`}}if(z.type_protection&&z.nomsite){const ee=z.type_protection==="Classe"?"text-red-700":"text-amber-700";if(X+=`<br/><span class="text-sm ${ee}">${z.type_protection}</span>`,z.caractere&&(X+=`<br/><span class="text-xs text-gray-600">${z.caractere}</span>`),z.datedecis&&(X+=`<br/><span class="text-xs text-gray-500">Date: ${z.datedecis}</span>`),z.descriptio){const ge=String(z.descriptio).slice(0,150);X+=`<br/><span class="text-xs text-gray-600 italic">${ge}${String(z.descriptio).length>150?"...":""}</span>`}}if(z.secteur&&z.style){if(X+=`<br/><span class="text-sm text-gray-700">${z.secteur}</span>`,z["sous-secteur"]&&(X+=`<br/><span class="text-xs text-gray-600">${z["sous-secteur"]}</span>`),z.description){const ee=String(z.description).slice(0,150);X+=`<br/><span class="text-xs text-gray-600 italic">${ee}${String(z.description).length>150?"...":""}</span>`}z.url&&(X+=`<br/><a href="${z.url}" target="_blank" class="text-xs text-blue-600 hover:underline">Meer info</a>`)}if(z.nature_operation||z.synthese){z.nature_operation&&(X+=`<br/><span class="text-sm text-red-700">${z.nature_operation}</span>`),z.responsable_operation&&(X+=`<br/><span class="text-xs text-gray-600">Responsable: ${z.responsable_operation}</span>`),z.date_operation&&(X+=`<br/><span class="text-xs text-gray-500">Datum: ${z.date_operation}</span>`);const ee=[];if(z.prehistoire==="Oui"&&ee.push("Prehistorie"),z.protohistoire==="Oui"&&ee.push("Protohistorie"),z.antiquite==="Oui"&&ee.push("Romeins"),z.moyen_age==="Oui"&&ee.push("Middeleeuwen"),z.temps_modernes==="Oui"&&ee.push("Moderne tijd"),ee.length>0&&(X+=`<br/><span class="text-sm text-purple-700">${ee.join(", ")}</span>`),z.adresse&&(X+=`<br/><span class="text-xs text-gray-500">${z.adresse}</span>`),z.synthese){const ge=String(z.synthese).slice(0,200);X+=`<br/><span class="text-xs text-gray-600 italic">${ge}${String(z.synthese).length>200?"...":""}</span>`}}if(z.operator&&(X+=`<br/><span class="text-sm text-gray-600">${z.operator}</span>`),!ae){if(z.opening_hours){const ee=fae(String(z.opening_hours));X+=`<br/><span class="text-xs text-green-600">Open: ${ee}</span>`}z.website&&(X+=`<br/><a href="${z.website}" target="_blank" class="text-xs text-blue-600 underline">Website</a>`)}if(z.addr_street){const ee=[z.addr_street,z.addr_housenumber,z.addr_postcode].filter(Boolean).join(" ");X+=`<br/><span class="text-xs text-gray-500">${ee}</span>`}const Ve=z.description||z.omschrijving||z.descr||z.info;Ve&&Ve!==Et&&(X+=`<br/><span class="text-sm text-gray-600">${Ve}</span>`),jn.push(X),en.push({geometry:$o(sn),properties:z,popupHtml:X})}const Nn=t.getView().getResolution()||1,Ii=await Qn(Ft.coordinate,Nn);jn.push(...Ii);for(const ke of Ii)en.push(null);const He=await Gi;if(jn.length===0&&He!==null){const ke=`<strong class="text-blue-800">Terrein</strong>
          <br/><div class="mt-2 pt-2 border-t border-gray-100 flex items-center gap-1">
            <span class="text-xs text-gray-400">Hoogte:</span>
            <span class="text-sm font-medium text-blue-600">${He.toFixed(2)} m NAP</span>
          </div>`;jn.push(ke),en.push(null)}if(jn.length>0&&He!==null&&(jn[0]+=`<br/><div class="mt-2 pt-2 border-t border-gray-100 flex items-center gap-1">
          <span class="text-xs text-gray-400">Hoogte:</span>
          <span class="text-sm font-medium text-blue-600">${He.toFixed(2)} m NAP</span>
        </div>`),jn.length>0){l(jn),ie(en),u(0),console.log(` KLIK OPGESLAGEN: [${Ft.coordinate[0].toFixed(0)}, ${Ft.coordinate[1].toFixed(0)}]`),y(Ft.coordinate),b(!1),U(!1),Ce(!1),W(""),de(null);const ke=Fn(Ft.coordinate);ze(ke),M(`https://www.google.com/maps/dir/?api=1&destination=${ke[1]},${ke[0]}`),j(`https://www.google.com/maps/@?api=1&map_action=pano&viewpoint=${ke[1]},${ke[0]}`),f(!0)}};return t.on("click",dr),()=>{t.un("click",dr)}},[t]);const Ai=()=>{f(!1),Se("half"),t&&_&&(Dz(t),b(!1))},Ls=(bt,Qn)=>{const dr=Qn.velocity.y,Ft=Qn.offset.y;Ke==="half"?Ft<-50||dr<-500?Se("full"):(Ft>100||dr>500)&&Ai():(Ft>50||dr>300)&&Se("half")};return p.jsx(qn,{children:h&&p.jsxs(p.Fragment,{children:[p.jsx(_t.div,{className:"fixed inset-0 z-[1500]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:Ai}),p.jsxs(_t.div,{className:"fixed bottom-0 left-0 right-0 z-[1501] bg-white rounded-t-2xl shadow-2xl overflow-hidden flex flex-col",style:{fontSize:`${14*ve/100}px`,height:Ke==="full"?"90vh":"auto",maxHeight:Ke==="full"?"90vh":"35vh"},initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{type:"spring",damping:25,stiffness:300},drag:"y",dragConstraints:{top:0,bottom:0},dragElastic:.3,onDragEnd:Ls,children:[p.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-gradient-to-r from-blue-500 to-blue-600 text-white cursor-grab active:cursor-grabbing rounded-t-xl select-none",onClick:()=>Se(Ke==="half"?"full":"half"),children:[p.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[Ye&&p.jsxs("div",{className:"flex items-center gap-0.5 flex-shrink-0",children:[p.jsx("button",{onClick:bt=>{bt.stopPropagation(),Wn()},className:"p-1 text-white/80 hover:text-white transition-colors border-0 outline-none bg-transparent","aria-label":"Vorige laag",children:p.jsx(a2e,{size:18})}),p.jsxs("span",{className:"text-white/80 font-medium min-w-[32px] text-center",style:{fontSize:"0.75em"},children:[c+1,"/",a.length]}),p.jsx("button",{onClick:bt=>{bt.stopPropagation(),ei()},className:"p-1 text-white/80 hover:text-white transition-colors border-0 outline-none bg-transparent","aria-label":"Volgende laag",children:p.jsx(Sb,{size:18})})]}),p.jsx("span",{className:"font-medium text-white truncate",style:{fontSize:"0.9em"},children:pn||"Info"})]}),p.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[Ie&&p.jsxs("div",{className:"relative",children:[p.jsx("button",{onClick:bt=>{bt.stopPropagation(),U(!V)},className:`p-1 transition-colors flex-shrink-0 border-0 outline-none bg-transparent rounded hover:bg-white/20 ${G?"text-green-300":"text-white/80 hover:text-white"}`,title:"Toevoegen aan mijn laag","aria-label":"Toevoegen aan mijn laag",children:G?p.jsx(_p,{size:16}):p.jsx(_u,{size:16})}),V&&p.jsxs("div",{className:"absolute right-0 top-full mt-1 z-50 bg-white rounded-lg shadow-lg border border-gray-200 py-1 min-w-[180px] max-w-[220px]",children:[p.jsx("div",{className:"px-3 py-1 text-xs text-gray-400 font-medium",children:"Toevoegen aan:"}),p.jsx("div",{className:"max-h-[200px] overflow-y-auto",children:i.filter(bt=>!bt.archived).map(bt=>p.jsxs("button",{onClick:()=>{const Qn=le;s(bt.id,{name:pn||"Punt",category:"Overig",notes:"",url:void 0,coordinates:[Ie[0],Ie[1]],sourceLayer:pn,geometry:Qn?.geometry,sourceProperties:Qn?.properties,popupContent:Qn?.popupHtml}),U(!1),de(bt.name),setTimeout(()=>de(null),2e3)},className:"w-full px-3 py-1.5 text-left text-sm text-gray-700 hover:bg-blue-50 border-0 outline-none bg-transparent flex items-center gap-2",children:[p.jsx("span",{className:"w-2 h-2 rounded-full flex-shrink-0",style:{backgroundColor:bt.color}}),p.jsx("span",{className:"truncate",children:bt.name})]},bt.id))}),p.jsx("div",{className:"border-t border-gray-100 mt-1 pt-1",children:De?p.jsxs("div",{className:"px-2 py-1",children:[p.jsx("input",{type:"text",value:Q,onChange:bt=>W(bt.target.value),placeholder:"Naam nieuwe laag...",className:"w-full px-2 py-1 text-sm border border-gray-200 rounded focus:outline-none focus:border-orange-400",autoFocus:!0,onKeyDown:bt=>{if(bt.key==="Enter"&&Q.trim()){const Qn=o(Q.trim()),dr=le;s(Qn,{name:pn||"Punt",category:"Overig",notes:"",url:void 0,coordinates:[Ie[0],Ie[1]],sourceLayer:pn,geometry:dr?.geometry,sourceProperties:dr?.properties,popupContent:dr?.popupHtml}),U(!1),Ce(!1),W(""),de(Q.trim()),setTimeout(()=>de(null),2e3)}else bt.key==="Escape"&&(Ce(!1),W(""))}}),p.jsxs("div",{className:"flex gap-1 mt-1",children:[p.jsx("button",{onClick:()=>{if(Q.trim()){const bt=o(Q.trim()),Qn=le;s(bt,{name:pn||"Punt",category:"Overig",notes:"",url:void 0,coordinates:[Ie[0],Ie[1]],sourceLayer:pn,geometry:Qn?.geometry,sourceProperties:Qn?.properties,popupContent:Qn?.popupHtml}),U(!1),Ce(!1),W(""),de(Q.trim()),setTimeout(()=>de(null),2e3)}},disabled:!Q.trim(),className:"flex-1 px-2 py-1 text-xs bg-orange-500 text-white rounded disabled:opacity-50",children:"Toevoegen"}),p.jsx("button",{onClick:()=>{Ce(!1),W("")},className:"px-2 py-1 text-xs text-gray-500 hover:text-gray-700",children:"Annuleer"})]})]}):p.jsxs("button",{onClick:()=>Ce(!0),className:"w-full px-3 py-1.5 text-left text-sm text-orange-600 hover:bg-orange-50 border-0 outline-none bg-transparent flex items-center gap-2",children:[p.jsx(_u,{size:14}),p.jsx("span",{children:"Nieuwe laag maken..."})]})})]})]}),O&&p.jsx("a",{href:O,target:"_blank",rel:"noopener noreferrer",className:"p-1.5 text-amber-500 hover:text-amber-600 transition-colors flex-shrink-0",title:"Open Street View","aria-label":"Open Street View",children:p.jsx(v2e,{size:18})}),C&&p.jsx("a",{href:C,target:"_blank",rel:"noopener noreferrer",onClick:bt=>bt.stopPropagation(),className:"p-1 text-white/80 hover:text-white transition-colors flex-shrink-0 rounded hover:bg-white/20",title:"Navigeer naar locatie","aria-label":"Open in Google Maps",children:p.jsx(Tg,{size:16})}),p.jsx(d2e,{size:18,className:"text-white/60 mx-1"}),p.jsx("button",{onClick:bt=>{bt.stopPropagation(),Ai()},className:"p-1 text-white/80 hover:text-white transition-colors flex-shrink-0 border-0 outline-none bg-transparent rounded hover:bg-white/20","aria-label":"Sluiten",children:p.jsx(Qr,{size:16})})]})]}),p.jsx("div",{className:`px-4 py-3 overflow-y-auto select-text min-h-0 ${Ke==="full"?"flex-1":""}`,style:{userSelect:"text",WebkitUserSelect:"text"},dangerouslySetInnerHTML:{__html:dt}}),p.jsxs("div",{className:"px-4 py-2 border-t border-gray-100 flex items-center gap-2 flex-shrink-0",children:[p.jsx(ZH,{size:14,className:"text-gray-400 flex-shrink-0"}),p.jsx("input",{type:"range",min:"80",max:"150",value:ve,onChange:bt=>we(parseInt(bt.target.value)),className:"flex-1 h-1.5 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500"}),p.jsxs("span",{className:"text-gray-400 w-8 text-right",style:{fontSize:"0.857em"},children:[ve,"%"]})]}),zn&&I&&!R&&p.jsxs("div",{className:"px-4 pb-4 flex gap-2 flex-shrink-0",children:[p.jsxs("button",{onClick:()=>{const bt=r.find(Qn=>Qn.id===I);bt&&D(bt)},className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 text-white bg-blue-500 hover:bg-blue-600 rounded-lg transition-colors border-0 outline-none",children:[p.jsx(Kg,{size:16}),p.jsx("span",{children:"Bewerken"})]}),p.jsxs("button",{onClick:()=>{e(I),f(!1),P(null)},className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 text-white bg-red-500 hover:bg-red-600 rounded-lg transition-colors border-0 outline-none",children:[p.jsx(Sh,{size:16}),p.jsx("span",{children:"Verwijderen"})]})]}),R&&p.jsxs("div",{className:"px-4 pb-4 space-y-3 border-t border-gray-100 pt-3 flex-shrink-0 overflow-y-auto max-h-[40vh]",children:[p.jsx("div",{className:"text-sm font-medium text-blue-600",children:"Vondst bewerken"}),p.jsxs("div",{children:[p.jsx("label",{className:"text-xs text-gray-500",children:"Objecttype"}),p.jsx("input",{type:"text",value:R.objectType,onChange:bt=>D({...R,objectType:bt.target.value}),className:"w-full px-2 py-1 text-sm bg-gray-50 rounded border-0 outline-none focus:bg-blue-50"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"text-xs text-gray-500",children:"Materiaal"}),p.jsx("input",{type:"text",value:R.material,onChange:bt=>D({...R,material:bt.target.value}),className:"w-full px-2 py-1 text-sm bg-gray-50 rounded border-0 outline-none focus:bg-blue-50"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"text-xs text-gray-500",children:"Periode"}),p.jsx("input",{type:"text",value:R.period,onChange:bt=>D({...R,period:bt.target.value}),className:"w-full px-2 py-1 text-sm bg-gray-50 rounded border-0 outline-none focus:bg-blue-50"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"text-xs text-gray-500",children:"Notities"}),p.jsx("textarea",{value:R.notes,onChange:bt=>D({...R,notes:bt.target.value}),className:"w-full px-2 py-1 text-sm bg-gray-50 rounded border-0 outline-none focus:bg-blue-50 resize-none h-16"})]}),p.jsxs("div",{className:"flex gap-2",children:[p.jsx("button",{onClick:()=>D(null),className:"flex-1 px-3 py-2 text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors border-0 outline-none text-sm",children:"Annuleren"}),p.jsx("button",{onClick:()=>{n(R.id,{objectType:R.objectType,material:R.material,period:R.period,notes:R.notes}),D(null),f(!1)},className:"flex-1 px-3 py-2 text-white bg-blue-500 hover:bg-blue-600 rounded-lg transition-colors border-0 outline-none text-sm",children:"Opslaan"})]})]}),hr&&g&&p.jsx("div",{className:"px-4 pb-4 border-t border-gray-100",children:_?p.jsxs("button",{onClick:Cr,className:"w-full flex items-center justify-center gap-2 px-3 py-2 mt-3 text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors border-0 outline-none",children:[p.jsx(V2,{size:16}),p.jsx("span",{children:"Hoogtekaart verbergen"})]}):p.jsx("button",{onClick:_o,disabled:T,className:`w-full flex items-center justify-center gap-2 px-3 py-2 mt-3 text-white rounded-lg transition-colors border-0 outline-none ${T?"bg-blue-400 cursor-wait":"bg-blue-500 hover:bg-blue-600"}`,children:T?p.jsxs(p.Fragment,{children:[p.jsx(BI,{size:16,className:"animate-spin"}),p.jsx("span",{children:"Laden..."})]}):p.jsxs(p.Fragment,{children:[p.jsx(V2,{size:16}),p.jsx("span",{children:"Hoogtekaart tonen"})]})})})]})]})})}const mae=1e-4;function RSt(t,e){return t.points.some(n=>{const r=Math.abs(n.coordinates[0]-e[0]),i=Math.abs(n.coordinates[1]-e[1]);return r<mae&&i<mae})}function MSt(){const t=gi(j=>j.map),e=Gr(j=>j.openVondstForm),{openAddPointModal:n,openCreateLayerModal:r,openLayerManagerModal:i}=Gr(),s=ps(j=>j.layers),[o,a]=Y.useState(null),[l,c]=Y.useState(!1),[u,h]=Y.useState(!1),[f,g]=Y.useState(!1),y=Y.useRef(null),_=Y.useRef(null);Y.useEffect(()=>{if(!t){console.log(" LongPressMenu: map not ready");return}const j=t.getViewport();if(!j){console.log(" LongPressMenu: viewport not ready");return}console.log(" LongPressMenu: attached to viewport",j);const V=600,U=15,G=Ce=>{if(console.log(" Touch start, touches:",Ce.touches.length),Ce.touches.length!==1)return;const Q=Ce.touches[0];_.current={x:Q.clientX,y:Q.clientY},console.log(" Starting long press timer at:",_.current),y.current&&clearTimeout(y.current),y.current=window.setTimeout(()=>{if(console.log(" Timer fired! startPos:",_.current),!_.current)return;const W=window.__olMap;if(!W){console.log(" Map not available (global)");return}const ne=j.getBoundingClientRect(),ie=[_.current.x-ne.left,_.current.y-ne.top],le=W.getCoordinateFromPixel(ie);if(le){const ve=Fn(le);Ce.preventDefault(),a({pixel:[_.current.x,_.current.y],coordinate:ve}),c(!0),h(!1),setTimeout(()=>h(!0),300),"vibrate"in navigator&&navigator.vibrate(50),console.log(" Long press detected at:",ve)}},V)},de=Ce=>{if(!y.current||!_.current)return;const Q=Ce.touches[0],W=Q.clientX-_.current.x,ne=Q.clientY-_.current.y,ie=Math.sqrt(W*W+ne*ne);ie>U&&(console.log(" Touch moved too much, cancelling. Distance:",ie),clearTimeout(y.current),y.current=null)},Ie=()=>{console.log(" Touch end, timer active:",!!y.current),y.current&&(console.log(" Cancelling timer on touch end"),clearTimeout(y.current),y.current=null),_.current=null},ze=Ce=>{l&&Ce.preventDefault()},Ne=Ce=>{Ce.button===0&&(console.log(" Mouse down"),_.current={x:Ce.clientX,y:Ce.clientY},y.current&&clearTimeout(y.current),y.current=window.setTimeout(()=>{if(console.log(" Mouse timer fired!"),!_.current)return;const Q=window.__olMap;if(console.log(" __olMap:",Q),console.log(" __olMap constructor:",Q?.constructor?.name),console.log(" has getCoordinateAtPixel:",typeof Q?.getCoordinateAtPixel),!Q){console.log(" Map not available (global)");return}const W=j.getBoundingClientRect(),ne=[_.current.x-W.left,_.current.y-W.top];console.log(" Pixel:",ne);const ie=Q.getCoordinateFromPixel(ne);if(console.log(" Coordinate:",ie),ie){const le=Fn(ie);a({pixel:[_.current.x,_.current.y],coordinate:le}),c(!0),h(!1),setTimeout(()=>h(!0),300),console.log(" Long press (mouse) detected at:",le)}},V))},fe=Ce=>{if(!y.current||!_.current)return;const Q=Ce.clientX-_.current.x,W=Ce.clientY-_.current.y;Math.sqrt(Q*Q+W*W)>U&&(console.log(" Mouse moved, cancelling"),clearTimeout(y.current),y.current=null)},De=()=>{console.log(" Mouse up"),y.current&&(clearTimeout(y.current),y.current=null),_.current=null};return j.addEventListener("touchstart",G,{passive:!1}),j.addEventListener("touchmove",de,{passive:!0}),j.addEventListener("touchend",Ie),j.addEventListener("touchcancel",Ie),j.addEventListener("contextmenu",ze),j.addEventListener("mousedown",Ne),j.addEventListener("mousemove",fe),j.addEventListener("mouseup",De),j.addEventListener("mouseleave",De),()=>{j.removeEventListener("touchstart",G),j.removeEventListener("touchmove",de),j.removeEventListener("touchend",Ie),j.removeEventListener("touchcancel",Ie),j.removeEventListener("contextmenu",ze),j.removeEventListener("mousedown",Ne),j.removeEventListener("mousemove",fe),j.removeEventListener("mouseup",De),j.removeEventListener("mouseleave",De),y.current&&clearTimeout(y.current)}},[t,l]);const b=()=>{u&&(c(!1),a(null),h(!1),g(!1))},T=()=>{c(!1),a(null),h(!1),g(!1)},A=j=>{if(!o)return;const[V,U]=o.coordinate;n(j,{lat:U,lng:V}),T()},I=()=>{r(),T()},P=()=>{if(!o)return;const[j,V]=o.coordinate;e({lat:V,lng:j}),c(!1),a(null),h(!1)},R=()=>{if(!o)return;const[j,V]=o.coordinate,U=`https://www.google.com/maps?q=${V},${j}`;window.open(U,"_blank"),c(!1),a(null),h(!1)},D=()=>{if(!o)return;const[j,V]=o.coordinate,U=`https://www.google.com/maps?layer=c&cbll=${V},${j}`;window.open(U,"_blank"),T()},C=()=>{if(!o)return;const j=document.createElement("input");j.type="file",j.accept="image/*",j.capture="environment",j.onchange=async V=>{const U=V.target.files?.[0];if(!U)return;const[G,de]=o.coordinate;e({lat:de,lng:G},U)},j.click(),T()},M=()=>{i(),T()},O=j=>{const[V,U]=j;return`${U.toFixed(5)}N, ${V.toFixed(5)}E`};return p.jsx(qn,{children:l&&o&&p.jsxs(p.Fragment,{children:[p.jsx(_t.div,{className:"fixed inset-0 z-[1600]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:b}),p.jsxs(_t.div,{className:"fixed z-[1601] bg-white rounded-xl shadow-md overflow-hidden min-w-[200px] border-0 outline-none",style:{left:Math.min(o.pixel[0],window.innerWidth-220),top:(()=>{const j=f?480:380;return window.innerHeight-o.pixel[1]<j&&o.pixel[1]>j?o.pixel[1]-j+40:Math.min(o.pixel[1],window.innerHeight-j)})()},initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.15},children:[p.jsx("div",{className:"px-4 py-3 bg-white border-b border-gray-100",children:p.jsxs("div",{className:"flex items-center gap-2 text-blue-600",children:[p.jsx(Il,{size:16}),p.jsx("span",{className:"text-xs font-mono",children:O(o.coordinate)})]})}),p.jsxs("div",{className:"bg-white",children:[p.jsxs("button",{onClick:P,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-orange-50 text-gray-700 bg-white border-0 outline-none",children:[p.jsx(FN,{size:20,className:"text-orange-500"}),p.jsx("span",{className:"font-medium",children:"Vondst toevoegen"})]}),p.jsxs("button",{onClick:C,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-green-50 text-gray-700 bg-white border-0 outline-none",children:[p.jsx(bL,{size:20,className:"text-green-500"}),p.jsx("span",{className:"font-medium",children:"Foto maken"})]}),p.jsxs("div",{className:"relative",children:[p.jsxs("button",{onClick:()=>g(!f),className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-blue-50 text-gray-700 bg-white border-0 outline-none",children:[p.jsx(yc,{size:20,className:"text-purple-500"}),p.jsx("span",{className:"font-medium flex-1 text-left",children:"Voeg toe aan laag..."}),p.jsx(Sb,{size:16,className:`text-gray-400 transition-transform ${f?"rotate-90":""}`})]}),p.jsx(qn,{children:f&&p.jsx(_t.div,{className:"bg-gray-50 border-t border-gray-100",initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},children:s.length===0?p.jsxs("button",{onClick:I,className:"w-full px-4 py-2 pl-11 flex items-center gap-2 text-sm text-purple-600 hover:bg-purple-50 bg-transparent border-0 outline-none",children:[p.jsx(_u,{size:14}),p.jsx("span",{children:"Maak eerst een laag aan"})]}):p.jsxs(p.Fragment,{children:[s.map(j=>{const V=o?RSt(j,o.coordinate):!1;return p.jsxs("button",{onClick:()=>!V&&A(j.id),className:`w-full px-4 py-2 pl-11 flex items-center gap-2 text-sm bg-transparent border-0 outline-none ${V?"text-gray-400 cursor-not-allowed":"text-gray-700 hover:bg-gray-100"}`,title:V?"Al toegevoegd aan deze laag":void 0,disabled:V,children:[V&&p.jsx(_p,{size:14,className:"text-green-500 flex-shrink-0"}),p.jsx("span",{className:"truncate",children:j.name}),p.jsx("span",{className:"text-xs text-gray-400 ml-auto",children:V?"al toegevoegd":`(${j.points.length})`})]},j.id)}),p.jsxs("button",{onClick:I,className:"w-full px-4 py-2 pl-11 flex items-center gap-2 text-sm text-purple-600 hover:bg-purple-50 bg-transparent border-0 outline-none border-t border-gray-200",children:[p.jsx(_u,{size:14}),p.jsx("span",{children:"Nieuwe laag..."})]})]})})})]}),p.jsxs("button",{onClick:M,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-purple-50 text-gray-700 bg-white border-0 outline-none",children:[p.jsx(Out,{size:20,className:"text-purple-500"}),p.jsx("span",{className:"font-medium",children:"Lagen beheren"})]}),p.jsxs("button",{onClick:R,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-blue-50 text-gray-700 bg-white border-0 outline-none",children:[p.jsx(Tg,{size:20,className:"text-blue-600"}),p.jsx("span",{className:"font-medium",children:"Open in Google Maps"})]}),p.jsxs("button",{onClick:D,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-yellow-50 text-gray-700 bg-white border-0 outline-none",children:[p.jsx(v2e,{size:20,className:"text-yellow-600"}),p.jsx("span",{className:"font-medium",children:"Street View"})]})]}),p.jsx("div",{className:"bg-white",children:p.jsxs("button",{onClick:T,className:"w-full px-4 py-3 flex items-center justify-center gap-2 text-gray-500 hover:bg-blue-50 transition-colors bg-white border-0 outline-none",children:[p.jsx(Qr,{size:18}),p.jsx("span",{children:"Annuleren"})]})})]})]})})}function NSt(t){return t}function OSt(t){if(t==null)return NSt;var e,n,r=t.scale[0],i=t.scale[1],s=t.translate[0],o=t.translate[1];return function(a,l){l||(e=n=0);var c=2,u=a.length,h=new Array(u);for(h[0]=(e+=a[0])*r+s,h[1]=(n+=a[1])*i+o;c<u;)h[c]=a[c],++c;return h}}function LSt(t,e){for(var n,r=t.length,i=r-e;i<--r;)n=t[i],t[i++]=t[r],t[r]=n}function DSt(t,e){return typeof e=="string"&&(e=t.objects[e]),e.type==="GeometryCollection"?{type:"FeatureCollection",features:e.geometries.map(function(n){return gae(t,n)})}:gae(t,e)}function gae(t,e){var n=e.id,r=e.bbox,i=e.properties==null?{}:e.properties,s=jSt(t,e);return n==null&&r==null?{type:"Feature",properties:i,geometry:s}:r==null?{type:"Feature",id:n,properties:i,geometry:s}:{type:"Feature",id:n,bbox:r,properties:i,geometry:s}}function jSt(t,e){var n=OSt(t.transform),r=t.arcs;function i(u,h){h.length&&h.pop();for(var f=r[u<0?~u:u],g=0,y=f.length;g<y;++g)h.push(n(f[g],g));u<0&&LSt(h,y)}function s(u){return n(u)}function o(u){for(var h=[],f=0,g=u.length;f<g;++f)i(u[f],h);return h.length<2&&h.push(h[0]),h}function a(u){for(var h=o(u);h.length<4;)h.push(h[0]);return h}function l(u){return u.map(a)}function c(u){var h=u.type,f;switch(h){case"GeometryCollection":return{type:h,geometries:u.geometries.map(c)};case"Point":f=s(u.coordinates);break;case"MultiPoint":f=u.coordinates.map(s);break;case"LineString":f=o(u.arcs);break;case"MultiLineString":f=u.arcs.map(o);break;case"Polygon":f=l(u.arcs);break;case"MultiPolygon":f=u.arcs.map(l);break;default:return null}return{type:h,coordinates:f}}return c(e)}async function LLt(t){try{const e=await fetch(t);if(!e.ok)throw new Error(`Failed to load ${t}: ${e.statusText}`);const n=await e.json();return console.log(` Loaded GeoJSON from ${t}`),n}catch(e){throw console.error(`Error loading GeoJSON from ${t}:`,e),e}}async function $St(t){try{const e=await fetch(t);if(!e.ok)throw new Error(`Failed to load ${t}: ${e.statusText}`);const n=await e.json(),r=Object.keys(n.objects)[0],i=DSt(n,n.objects[r]);return console.log(` Loaded and converted TopoJSON from ${t}`),i}catch(e){throw console.error(`Error loading TopoJSON from ${t}:`,e),e}}function FSt(t){return new kL({featureProjection:"EPSG:3857"}).readFeatures(t)}const Vq={all:{name:"Alle provincies",bounds:[3.37,50.75,7.21,53.47]},groningen:{name:"Groningen",bounds:[6.2,53.1,7.21,53.47]},friesland:{name:"Friesland",bounds:[5.05,52.85,6.25,53.45]},drenthe:{name:"Drenthe",bounds:[6.1,52.65,7.1,53.15]},overijssel:{name:"Overijssel",bounds:[5.85,52.15,6.9,52.7]},flevoland:{name:"Flevoland",bounds:[5.15,52.25,6,52.65]},gelderland:{name:"Gelderland",bounds:[5,51.75,6.4,52.45]},utrecht:{name:"Utrecht",bounds:[4.85,51.9,5.65,52.25]},"noord-holland":{name:"Noord-Holland",bounds:[4.5,52.2,5.25,52.95]},"zuid-holland":{name:"Zuid-Holland",bounds:[3.85,51.8,4.9,52.35]},zeeland:{name:"Zeeland",bounds:[3.37,51.2,4.3,51.75]},"noord-brabant":{name:"Noord-Brabant",bounds:[4.35,51.25,6,51.85]},limburg:{name:"Limburg",bounds:[5.55,50.75,6.25,51.8]}};function VSt(t,e,n){if(n==="all")return!0;const r=Vq[n];if(!r)return!0;const[i,s,o,a]=r.bounds;return t>=i&&t<=o&&e>=s&&e<=a}let DR=null;async function zq(){if(DR)return DR;const t=await $St("/detectorapp-nl/data/amk_monumenten_full.topojson");return DR=FSt(t),DR}function zSt(t,e,n=50){const r=t.toLowerCase(),i=e.toLowerCase(),s=r.indexOf(i);if(s===-1)return t.substring(0,100)+"...";const o=Math.max(0,s-n),a=Math.min(t.length,s+e.length+n);let l="";return o>0&&(l+="..."),l+=t.substring(o,a),a<t.length&&(l+="..."),l}async function GSt(t,e=50,n="all"){if(!t||t.length<2)return[];const r=await zq(),i=[],o=t.toLowerCase().split(/\s+/).filter(a=>a.length>=2);for(const a of r){const l=(a.get("omschrijving")||"").toLowerCase(),c=(a.get("toponiem")||"").toLowerCase(),u=(a.get("txt_label")||"").toLowerCase();if(o.every(f=>l.includes(f)||c.includes(f)||u.includes(f))){const f=a.getGeometry();if(!f)continue;const g=f.getExtent(),y=gh(g),[_,b]=K2(y,"EPSG:3857","EPSG:4326");if(!VSt(_,b,n))continue;const T=a.get("omschrijving")||"";if(i.push({id:a.get("ID")||a.get("monumentnummer"),monumentnummer:a.get("monumentnummer"),toponiem:a.get("toponiem")||"Onbekend",kwaliteitswaarde:a.get("kwaliteitswaarde")||"",periode:a.get("txt_label")||"",omschrijving:T,matchedText:zSt(T,o[0]),coordinates:[_,b],extent:g}),i.length>=e)break}}return i.sort((a,l)=>{const c={"zeer hoge archeologische waarde":3,"hoge archeologische waarde":2,"archeologische waarde":1};return(c[l.kwaliteitswaarde]||0)-(c[a.kwaliteitswaarde]||0)}),i}async function USt(t){return(await zq()).find(n=>n.get("monumentnummer")===t)||null}async function BSt(t){const e=await zq(),n=new Set(t);return e.filter(r=>n.has(r.get("monumentnummer")))}const oSe=yo((t,e)=>({keyword:"",province:"all",isActive:!1,totalCount:0,filteredCount:0,setKeyword:n=>t({keyword:n}),setProvince:n=>t({province:n}),setActive:n=>t({isActive:n}),toggleActive:()=>t(n=>({isActive:!n.isActive})),clearFilter:()=>t({keyword:"",province:"all",isActive:!1}),updateCounts:(n,r)=>t({totalCount:n,filteredCount:r})}));function DLt(t,e,n,r,i,s,o){if(s.length>=2){const l=s.toLowerCase().split(/\s+/).filter(g=>g.length>=2),c=t.toLowerCase(),u=e.toLowerCase(),h=n.toLowerCase();if(!l.every(g=>c.includes(g)||u.includes(g)||h.includes(g)))return!1}if(o!=="all"){const a=Vq[o]?.bounds;if(a){const[l,c,u,h]=a;if(r<l||r>u||i<c||i>h)return!1}}return!0}const WSt={Compass:c2e,TreePalm:tht,Mountain:V2,Waves:dht,Search:_A,Target:Xut,Layers:yc,Grid:h2e},HSt={Compass:"text-purple-600",Waves:"text-cyan-600",TreePalm:"text-green-600",Mountain:"text-stone-600",Search:"text-amber-600",Target:"text-red-600",Layers:"text-blue-600",Grid:"text-lime-600"},qSt={Compass:"hover:bg-purple-50",Waves:"hover:bg-cyan-50",TreePalm:"hover:bg-green-50",Mountain:"hover:bg-stone-50",Search:"hover:bg-amber-50",Target:"hover:bg-red-50",Layers:"hover:bg-blue-50",Grid:"hover:bg-lime-50"},yae=["Mijn Vondsten","Labels Overlay","TMK 1850","Bonnebladen 1900","Hunebedden","FAMKE Steentijd","FAMKE IJzertijd","Grafheuvels","Terpen","AMK Monumenten","AMK Romeins","AMK Steentijd","AMK Vroege ME","AMK Late ME","AMK Overig","Romeinse wegen (regio)","Romeinse wegen (Wereld)","Romeinse Forten","Kastelen","IKAW","Archeo Onderzoeken","Rijksmonumenten","Werelderfgoed","Religieus Erfgoed","Essen","Runes","WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Inundatiegebieden","Militaire Objecten","Paleokaart 800 n.Chr.","Paleokaart 100 n.Chr.","Paleokaart 500 v.Chr.","Paleokaart 1500 v.Chr.","Paleokaart 2750 v.Chr.","Paleokaart 5500 v.Chr.","Paleokaart 9000 v.Chr.","UIKAV Punten","UIKAV Vlakken","UIKAV Expert","UIKAV Buffer","UIKAV Indeling","Hoogtekaart (WebGL)","AHN4 Hoogtekaart Kleur","AHN4 Hillshade NL","AHN4 Multi-Hillshade NL","AHN 0.5m","Veengebieden","Geomorfologie","Bodemkaart","Fossiel Hotspots","Mineralen Hotspots","Goudrivieren","Fossielen Nederland","Fossielen Belgi","Fossielen Duitsland","Fossielen Frankrijk","Parken","Speeltuinen","Musea","Strandjes","Kringloopwinkels","Ruiterpaden","Laarzenpaden","Gewaspercelen","Kadastrale Grenzen","Scheepswrakken","Woonheuvels ZH","Windmolens","Erfgoedlijnen","Oude Kernen","Relictenkaart Punten","Relictenkaart Lijnen","Relictenkaart Vlakken","Verdronken Dorpen"],KSt=["CartoDB (licht)","OpenStreetMap","Luchtfoto","TMK 1850","Bonnebladen 1900"],YSt=[5.2913,52.1326],XSt=8;function ZSt(){const t=Bs(U=>U.setLayerVisibility),e=ks(U=>U.stopTracking),n=oSe(U=>U.clearFilter),r=gi(U=>U.map),{presetsPanelOpen:i,togglePresetsPanel:s,closeAllPanels:o}=Gr(),{presets:a,applyPreset:l,updatePreset:c,createPreset:u,resetToDefaults:h}=qde(),f=Bs(U=>U.visible),g=Cn(U=>U.presetPanelFontScale),y=Cn(U=>U.setPresetPanelFontScale),_=Cn(U=>U.showFontSliders),b=12*g/100,[T,A]=Y.useState(null),[I,P]=Y.useState(!1),[R,D]=Y.useState(""),C=()=>{o(),yae.forEach(U=>t(U,!1)),KSt.forEach(U=>{t(U,U==="CartoDB (licht)")}),e(),n(),r&&r.getView().animate({center:Ni(YSt),zoom:XSt,duration:500}),console.log(" Reset: CartoDB, alle lagen uit, GPS uit, zoom naar Nederland")},M=U=>{l(U),o()},O=(U,G,de)=>{if(U.stopPropagation(),!confirm(`Preset "${de}" overschrijven met huidige lagen?`))return;const Ie=Object.entries(f).filter(([ze,Ne])=>Ne&&yae.includes(ze)).map(([ze])=>ze);c(G,{layers:Ie}),A(G),setTimeout(()=>A(null),2e3),console.log(" Lagen opgeslagen naar preset")},j=()=>{R.trim()&&(u(R.trim(),"Layers"),D(""),P(!1))},V=()=>{confirm("Presets terugzetten naar standaard?")&&h()};return p.jsxs(p.Fragment,{children:[p.jsx(_t.button,{onClick:C,className:"fixed bottom-2 left-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},title:"Reset - CartoDB, alle lagen uit, GPS uit",children:p.jsx(x2e,{size:20,className:"text-gray-600"})}),p.jsx(_t.button,{onClick:s,className:"fixed bottom-[60px] left-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},title:"Presets",children:i?p.jsx(EL,{size:20,className:"text-blue-600"}):p.jsx(yc,{size:20,className:"text-blue-600"})}),p.jsx(qn,{children:i&&p.jsxs(p.Fragment,{children:[p.jsx(_t.div,{className:"fixed inset-0 z-[800]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:s}),p.jsxs(_t.div,{initial:{opacity:0,x:-10,scale:.95},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:-10,scale:.95},transition:{duration:.15},className:"fixed bottom-[60px] left-[56px] bg-white/95 rounded-xl shadow-lg overflow-hidden w-[240px] backdrop-blur-sm z-[801]",children:[p.jsxs("div",{className:"flex items-center justify-between gap-2 px-3 py-1.5 bg-blue-500",style:{fontSize:`${b}px`},children:[p.jsx("span",{className:"font-medium text-white",children:"Presets"}),_&&p.jsxs("div",{className:"flex items-center gap-1",children:[p.jsx("span",{className:"text-[9px] text-blue-200",children:"T"}),p.jsx("input",{type:"range",min:"80",max:"130",step:"10",value:g,onInput:U=>{y(parseInt(U.target.value))},onChange:U=>y(parseInt(U.target.value)),className:"w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${g}%`}),p.jsx("span",{className:"text-[11px] text-blue-200",children:"T"})]})]}),p.jsx("div",{className:"p-2 max-h-[300px] overflow-y-auto",children:a.map(U=>{const G=WSt[U.icon]||yc,de=HSt[U.icon]||"text-blue-600",Ie=qSt[U.icon]||"hover:bg-blue-50",ze=T===U.id;return p.jsxs("button",{onClick:()=>M(U.id),className:`w-full h-8 flex items-center gap-1.5 px-2 ${Ie} rounded text-left transition-colors border-0 outline-none bg-transparent overflow-hidden ${ze?"bg-green-50":""}`,style:{fontSize:`${b}px`},children:[p.jsx(G,{size:14,className:`${de} flex-shrink-0`}),p.jsx("span",{className:"text-gray-700 truncate flex-1",children:U.name}),ze?p.jsx("span",{className:"p-1 flex-shrink-0",children:p.jsx(_p,{size:14,className:"text-green-500"})}):p.jsx("span",{onClick:Ne=>O(Ne,U.id,U.name),className:"p-1 hover:bg-gray-200 rounded transition-colors flex-shrink-0",title:"Huidige lagen opslaan naar deze preset",children:p.jsx(XH,{size:12,className:"text-gray-400 hover:text-blue-500"})})]},U.id)})}),p.jsx("div",{className:"border-t border-gray-200 px-2 py-1.5",children:I?p.jsxs("div",{className:"flex gap-1",children:[p.jsx("input",{type:"text",value:R,onChange:U=>D(U.target.value),onKeyDown:U=>{U.key==="Enter"&&j(),U.key==="Escape"&&P(!1)},placeholder:"Naam preset...",autoFocus:!0,className:"flex-1 px-2 py-1 text-sm rounded bg-gray-50 border-0 outline-none focus:ring-1 focus:ring-blue-400",style:{fontSize:`${b}px`}}),p.jsx("button",{onClick:j,disabled:!R.trim(),className:"px-2 py-1 bg-blue-500 text-white rounded text-sm disabled:opacity-50 border-0 outline-none",children:p.jsx(_p,{size:14})})]}):p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsxs("button",{onClick:()=>P(!0),className:"h-8 flex items-center gap-1.5 px-2 text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none",style:{fontSize:`${b}px`},children:[p.jsx(_u,{size:14}),p.jsx("span",{className:"text-gray-600",children:"Voeg preset toe"})]}),p.jsx("button",{onClick:V,className:"w-8 h-8 flex items-center justify-center text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded transition-colors border-0 outline-none",title:"Herstel standaard",children:p.jsx(Tut,{size:14})})]})})]})]})})]})}function JSt(){const t=gi(o=>o.map),[e,n]=Y.useState(0),[r,i]=Y.useState(!1);Y.useEffect(()=>{if(!t)return;const o=t.getView(),a=()=>{const l=o.getRotation(),c=l*180/Math.PI;n(c),i(Math.abs(l)>.087)};return a(),o.on("change:rotation",a),()=>{o.un("change:rotation",a)}},[t]);const s=()=>{t&&t.getView().animate({rotation:0,duration:300})};return p.jsx(qn,{children:r&&p.jsx(_t.button,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{duration:.2},onClick:s,className:"fixed top-[60px] right-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",title:"Klik om noorden te herstellen",children:p.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",style:{transform:`rotate(${-e}deg)`},children:[p.jsx("path",{d:"M12 2 L14.5 12 L12 10 L9.5 12 Z",fill:"#EA4335"}),p.jsx("path",{d:"M12 22 L9.5 12 L12 14 L14.5 12 Z",fill:"white",stroke:"#9CA3AF",strokeWidth:"0.5"}),p.jsx("circle",{cx:"12",cy:"12",r:"2",fill:"#374151"})]})})})}const QSt=[{name:"AHN4 Hoogtekaart Kleur",color:"blue",default:.85},{name:"AHN4 Hillshade NL",color:"blue",default:.7},{name:"AHN4 Multi-Hillshade NL",color:"blue",default:.7},{name:"AHN 0.5m",color:"blue",default:.7},{name:"TMK 1850",color:"amber",default:.8},{name:"Bonnebladen 1900",color:"amber",default:.8},{name:"Geomorfologie",color:"green",default:.5},{name:"Bodemkaart",color:"amber",default:.6},{name:"Veengebieden",color:"amber",default:.6},{name:"IKAW",color:"orange",default:.5},{name:"Archeo Landschappen",color:"green",default:.5},{name:"Terpen",color:"orange",default:.7},{name:"Essen",color:"amber",default:.6},{name:"AMK Monumenten",color:"purple",default:.45},{name:"AMK Romeins",color:"red",default:.6},{name:"AMK Steentijd",color:"amber",default:.6},{name:"AMK Vroege ME",color:"green",default:.6},{name:"AMK Late ME",color:"blue",default:.6},{name:"AMK Overig",color:"purple",default:.6},{name:"Paleokaart 9000 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 5500 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 2750 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 1500 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 500 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 100 n.Chr.",color:"indigo",default:.7},{name:"Paleokaart 800 n.Chr.",color:"indigo",default:.7},{name:"Verdedigingslinies",color:"red",default:.7},{name:"Inundatiegebieden",color:"red",default:.5},{name:"Gewaspercelen",color:"green",default:.6},{name:"Erfgoedlijnen",color:"purple",default:.7},{name:"Oude Kernen",color:"orange",default:.6},{name:"Relictenkaart Vlakken",color:"green",default:.5}],eTt={blue:"accent-blue-500",amber:"accent-amber-500",red:"accent-red-500",indigo:"accent-indigo-500",green:"accent-green-500",orange:"accent-orange-500",purple:"accent-purple-500"};function tTt(){const[t,e]=Y.useState(!1),[n,r]=Y.useState(!1),i=Bs(u=>u.visible),s=Bs(u=>u.opacity),o=Bs(u=>u.setLayerOpacity),a=QSt.filter(u=>i[u.name]);if(a.length===0)return null;const l=n?a:a.slice(0,3),c=a.length>3;return p.jsxs("div",{className:"fixed bottom-[112px] right-2 z-[900]",children:[p.jsxs(_t.button,{onClick:()=>e(!t),className:"w-11 h-11 bg-white/80 rounded-xl backdrop-blur-sm shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none hover:bg-white/90 transition-colors",whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":"Opacity sliders",title:t?"Sluit opacity sliders":"Open opacity sliders",children:[p.jsx(w2e,{size:22,strokeWidth:2,className:"text-gray-500"}),a.length>0&&p.jsx("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-blue-500 text-white text-[10px] rounded-full flex items-center justify-center",children:a.length})]}),p.jsx(qn,{children:t&&p.jsxs(p.Fragment,{children:[p.jsx(_t.div,{className:"fixed inset-0 z-[-1]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>e(!1)}),p.jsxs(_t.div,{initial:{opacity:0,x:20,scale:.9},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:20,scale:.9},transition:{duration:.2},className:"absolute bottom-0 right-14 bg-white/95 rounded-xl shadow-lg overflow-hidden min-w-[220px] max-h-[60vh] flex flex-col",children:[p.jsx("div",{className:"px-3 py-1.5 bg-blue-500",children:p.jsx("span",{className:"font-medium text-white text-xs",children:"Transparantie"})}),p.jsxs("div",{className:"p-3 overflow-y-auto flex-1",children:[p.jsx("div",{className:"space-y-3",children:l.map(u=>{const h=s[u.name]??u.default;return p.jsxs("div",{children:[p.jsx("label",{className:"text-xs font-medium text-gray-700 mb-1 block truncate",title:u.name,children:u.name}),p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("input",{type:"range",min:"0",max:"100",value:h*100,onChange:f=>o(u.name,parseInt(f.target.value)/100),className:`flex-1 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer ${eTt[u.color]}`}),p.jsxs("span",{className:"text-xs text-gray-500 w-8 text-right select-none pointer-events-none",children:[Math.round(h*100),"%"]})]})]},u.name)})}),c&&p.jsx("button",{onClick:()=>r(!n),className:"w-full mt-3 pt-2 border-t border-gray-200 flex items-center justify-center gap-1 text-xs text-gray-500 hover:text-gray-700",children:n?p.jsxs(p.Fragment,{children:[p.jsx(EL,{size:14}),"Minder tonen"]}):p.jsxs(p.Fragment,{children:[p.jsx(Eb,{size:14}),a.length-3," meer..."]})})]})]})]})})]})}function nTt(){const t=gi(R=>R.map),e=Cn(R=>R.showWeatherButton),[n,r]=Y.useState(!1),[i,s]=Y.useState(""),[o,a]=Y.useState([]),[l,c]=Y.useState(!1),[u,h]=Y.useState(!1),f=Y.useRef(null),g=Y.useRef(null),y=Y.useRef();Y.useEffect(()=>{n&&f.current&&f.current.focus()},[n]),Y.useEffect(()=>{if(!n)return;const R=D=>{g.current&&!g.current.contains(D.target)&&_()};return document.addEventListener("mousedown",R),()=>document.removeEventListener("mousedown",R)},[n]),Y.useEffect(()=>{if(!n)return;const R=D=>{D.key==="Escape"&&_()};return document.addEventListener("keydown",R),()=>document.removeEventListener("keydown",R)},[n]),Y.useEffect(()=>{if(y.current&&clearTimeout(y.current),i.length<2){a([]);return}return y.current=window.setTimeout(async()=>{h(!0);try{const D=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/suggest?q=${encodeURIComponent(i)}&rows=7`)).json();D.response?.docs&&a(D.response.docs)}catch(R){console.error("Search error:",R),a([])}finally{h(!1)}},300),()=>{y.current&&clearTimeout(y.current)}},[i]);const _=()=>{r(!1),s(""),a([]),c(!1)},b=async R=>{try{const C=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/lookup?id=${encodeURIComponent(R)}`)).json();if(C.response?.docs?.[0]?.centroide_ll){const O=C.response.docs[0].centroide_ll.match(/POINT\(([^ ]+) ([^)]+)\)/);if(O)return{lng:parseFloat(O[1]),lat:parseFloat(O[2])}}}catch(D){console.error("Lookup error:",D)}return null},T=async R=>{if(!t)return;const D=await b(R.id);D&&t.getView().animate({center:Ni([D.lng,D.lat]),zoom:16,duration:1e3}),_()},A=async(R,D)=>{D.stopPropagation();const C=await b(R.id);if(C){const M=`https://www.google.com/maps?q=${C.lat},${C.lng}`;window.open(M,"_blank")}_()},I={top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"};if(!n)return p.jsx(_t.button,{className:"fixed right-14 z-[800] w-11 h-11 flex items-center justify-center bg-white/90 hover:bg-white rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",style:I,onClick:()=>r(!0),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Zoeken",children:p.jsx(_A,{size:22,className:"text-gray-600"})});const P=e?"220px":"52px";return p.jsxs("div",{ref:g,className:"fixed right-14 z-[850]",style:{...I,left:P},children:[p.jsxs(_t.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"search-input-wrapper",children:[p.jsx(_A,{size:18,className:"search-icon"}),p.jsx("input",{ref:f,type:"text",value:i,onChange:R=>{s(R.target.value),c(!0)},onFocus:()=>c(!0),placeholder:"Zoek adres of plaats...",className:"search-input"}),p.jsx("button",{onClick:_,className:"search-clear",title:"Sluiten",children:p.jsx(Qr,{size:18})})]}),p.jsx(qn,{children:l&&o.length>0&&p.jsx(_t.ul,{className:"search-results",initial:{opacity:0,y:-8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},children:o.map(R=>p.jsxs("li",{className:"search-result-item",children:[p.jsx("div",{className:"search-result-content",onClick:()=>T(R),children:p.jsx("span",{className:"search-result-text",children:R.weergavenaam})}),p.jsx("button",{className:"search-navigate-btn",onClick:D=>A(R,D),title:"Open in Google Maps",children:p.jsx(Tg,{size:20})})]},R.id))})}),l&&u&&p.jsx("div",{className:"search-loading",children:"Zoeken..."})]})}function rTt(){const t=gi(o=>o.map),[e,n]=Y.useState(!1);Y.useEffect(()=>{if(!t)return;const o=t.getView(),a=()=>{const l=o.getRotation();n(Math.abs(l)>.087)};return a(),o.on("change:rotation",a),()=>{o.un("change:rotation",a)}},[t]);const r=()=>{if(!t)return;const o=t.getView(),a=o.getZoom();a!==void 0&&o.animate({zoom:a+1,duration:200})},i=()=>{if(!t)return;const o=t.getView(),a=o.getZoom();a!==void 0&&o.animate({zoom:a-1,duration:200})},s=e?"calc(max(0.5rem, env(safe-area-inset-top, 0.5rem)) + 112px)":"calc(max(0.5rem, env(safe-area-inset-top, 0.5rem)) + 52px)";return p.jsxs(_t.div,{className:"fixed right-2 z-[800] flex flex-col gap-1",style:{top:s},animate:{top:s},transition:{duration:.2},children:[p.jsx(_t.button,{className:"w-9 h-9 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",onClick:r,whileHover:{scale:1.05},whileTap:{scale:.95},title:"Inzoomen",children:p.jsx(_u,{size:18,className:"text-gray-600"})}),p.jsx(_t.button,{className:"w-9 h-9 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",onClick:i,whileHover:{scale:1.05},whileTap:{scale:.95},title:"Uitzoomen",children:p.jsx(YH,{size:18,className:"text-gray-600"})})]})}const iTt="detector2024",zz="detectorapp-auth";function sTt({children:t}){const[e,n]=Y.useState(!1),[r,i]=Y.useState(""),[s,o]=Y.useState(!1),[a,l]=Y.useState(""),[c,u]=Y.useState(!0);Y.useEffect(()=>{localStorage.getItem(zz)==="authenticated"&&n(!0),u(!1)},[]);const h=f=>{f.preventDefault(),l(""),r===iTt?(localStorage.setItem(zz,"authenticated"),n(!0)):(l("Onjuist wachtwoord"),i(""))};return c?p.jsx("div",{className:"fixed inset-0 bg-gradient-to-br from-blue-600 to-blue-800 flex items-center justify-center",children:p.jsx("div",{className:"text-white text-lg",children:"Laden..."})}):e?p.jsx(p.Fragment,{children:t}):p.jsx("div",{className:"fixed inset-0 bg-gradient-to-br from-blue-600 to-blue-800 flex items-center justify-center p-4",children:p.jsxs(_t.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-2xl shadow-2xl p-8 w-full max-w-sm",children:[p.jsxs("div",{className:"text-center mb-6",children:[p.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:p.jsx(xz,{size:32,className:"text-blue-600"})}),p.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"DetectorApp"}),p.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Test versie - Toegang beveiligd"})]}),p.jsxs("form",{onSubmit:h,className:"space-y-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Wachtwoord"}),p.jsxs("div",{className:"relative",children:[p.jsx("input",{type:s?"text":"password",value:r,onChange:f=>i(f.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none pr-12",placeholder:"Voer wachtwoord in",autoFocus:!0}),p.jsx("button",{type:"button",onClick:()=>o(!s),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:s?p.jsx(VN,{size:20}):p.jsx(zN,{size:20})})]})]}),a&&p.jsx(_t.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-red-500 text-sm text-center",children:a}),p.jsx("button",{type:"submit",className:"w-full py-3 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors",children:"Inloggen"})]}),p.jsx("p",{className:"text-center text-xs text-gray-400 mt-6",children:"Alleen voor testers"})]})})}function oTt(){localStorage.removeItem(zz),window.location.reload()}function aTt({isOpen:t,onClose:e}){const n=mh(l=>l.vondsten),r={total:n.length,byType:{},byMaterial:{},byPeriod:{},byCondition:{},avgDepth:0,totalWeight:0,recent:n.slice(-5).reverse()};let i=0,s=0;n.forEach(l=>{r.byType[l.objectType]=(r.byType[l.objectType]||0)+1,r.byMaterial[l.material]=(r.byMaterial[l.material]||0)+1,r.byPeriod[l.period]=(r.byPeriod[l.period]||0)+1,l.condition&&(r.byCondition[l.condition]=(r.byCondition[l.condition]||0)+1),l.depth&&(i+=l.depth,s++),l.weight&&(r.totalWeight+=l.weight)}),r.avgDepth=s>0?Math.round(i/s):0;const o=l=>Object.entries(l).sort((c,u)=>u[1]-c[1]),a=l=>Math.max(...Object.values(l),1);return p.jsx(qn,{children:t&&p.jsxs(p.Fragment,{children:[p.jsx(_t.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),p.jsxs(_t.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-md mx-auto my-auto max-h-[90vh]",initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},children:[p.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(o2e,{size:18}),p.jsx("span",{className:"font-medium",children:"Mijn Vondsten Dashboard"})]}),p.jsx("button",{onClick:e,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none",children:p.jsx(Qr,{size:18})})]}),p.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-5",children:n.length===0?p.jsxs("div",{className:"text-center py-8 text-gray-500",children:[p.jsx(Il,{size:48,className:"mx-auto mb-3 opacity-30"}),p.jsx("p",{className:"font-medium",children:"Nog geen vondsten"}),p.jsx("p",{className:"text-sm mt-1",children:"Voeg je eerste vondst toe via de oranje knop of long-press op de kaart"})]}):p.jsxs(p.Fragment,{children:[p.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[p.jsx(hF,{icon:p.jsx(Il,{size:20}),value:r.total,label:"Totaal",color:"bg-orange-100 text-orange-700"}),p.jsx(hF,{icon:p.jsx(X1,{size:20}),value:r.avgDepth>0?`${r.avgDepth}cm`:"-",label:"Gem. diepte",color:"bg-blue-100 text-blue-700"}),p.jsx(hF,{icon:p.jsx(Cut,{size:20}),value:r.totalWeight>0?`${r.totalWeight.toFixed(1)}g`:"-",label:"Tot. gewicht",color:"bg-green-100 text-green-700"})]}),p.jsx(jR,{title:"Per Type",data:o(r.byType),max:a(r.byType),color:"bg-orange-500"}),p.jsx(jR,{title:"Per Periode",data:o(r.byPeriod),max:a(r.byPeriod),color:"bg-amber-500"}),p.jsx(jR,{title:"Per Materiaal",data:o(r.byMaterial),max:a(r.byMaterial),color:"bg-blue-500"}),Object.keys(r.byCondition).length>0&&p.jsx(jR,{title:"Per Conditie",data:o(r.byCondition),max:a(r.byCondition),color:"bg-green-500"}),p.jsxs("div",{children:[p.jsxs("h3",{className:"text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2",children:[p.jsx(BH,{size:14}),"Recente Vondsten"]}),p.jsx("div",{className:"space-y-2",children:r.recent.map(l=>p.jsxs("div",{className:"flex items-center justify-between py-2 px-3 bg-gray-50 rounded-lg",children:[p.jsxs("div",{children:[p.jsx("span",{className:"font-medium text-sm text-gray-800",children:l.objectType}),p.jsx("span",{className:"text-gray-400 mx-1",children:"-"}),p.jsx("span",{className:"text-sm text-gray-600",children:l.material})]}),p.jsx("span",{className:"text-xs text-gray-400",children:new Date(l.timestamp).toLocaleDateString("nl-NL")})]},l.id))})]})]})})]})]})})}function hF({icon:t,value:e,label:n,color:r}){return p.jsxs("div",{className:`rounded-lg p-3 ${r}`,children:[p.jsx("div",{className:"flex items-center gap-2 mb-1 opacity-70",children:t}),p.jsx("div",{className:"text-xl font-bold",children:e}),p.jsx("div",{className:"text-xs opacity-70",children:n})]})}function jR({title:t,data:e,max:n,color:r}){return e.length===0?null:p.jsxs("div",{children:[p.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:t}),p.jsx("div",{className:"space-y-1.5",children:e.slice(0,6).map(([i,s])=>p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("div",{className:"w-24 text-xs text-gray-600 truncate",title:i,children:i}),p.jsx("div",{className:"flex-1 h-4 bg-gray-100 rounded-full overflow-hidden",children:p.jsx(_t.div,{className:`h-full ${r} rounded-full`,initial:{width:0},animate:{width:`${s/n*100}%`},transition:{duration:.5,ease:"easeOut"}})}),p.jsx("div",{className:"w-6 text-xs text-gray-600 text-right font-medium",children:s})]},i))})]})}function lTt(t){const{type:e,coordinates:n}=t,r=a=>Ni(a),i=a=>a.map(r),s=a=>a.map(i),o=a=>a.map(s);switch(e){case"Point":return new Ti(r(n));case"LineString":return new ts(i(n));case"Polygon":return new kl(s(n));case"MultiPoint":return new n0(i(n));case"MultiLineString":return new yh(s(n));case"MultiPolygon":return new hp(o(n));default:return console.warn(`Unsupported geometry type: ${e}`),null}}function cTt(t,e,n){const r=t.color,i=10,s=5,o=14;let a=i;if(n>50?a=s:n>10?a=Math.max(s,i-(n-10)/10):n<2&&(a=o),e==="Point"||e==="MultiPoint")return new vn({image:new ms({radius:a,fill:new Dn({color:r}),stroke:new Pn({color:"#ffffff",width:2})})});if(e==="LineString"||e==="MultiLineString")return new vn({stroke:new Pn({color:r,width:3})});if(e==="Polygon"||e==="MultiPolygon"){const l=uTt(r,.3);return new vn({fill:new Dn({color:l}),stroke:new Pn({color:r,width:2})})}return new vn({image:new ms({radius:a,fill:new Dn({color:r}),stroke:new Pn({color:"#ffffff",width:2})})})}function uTt(t,e){const n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);if(n){const r=parseInt(n[1],16),i=parseInt(n[2],16),s=parseInt(n[3],16);return`rgba(${r}, ${i}, ${s}, ${e})`}return t}function hTt(){const t=gi(r=>r.map),e=uI(r=>r.layers),n=Y.useRef(new Map);return Y.useEffect(()=>{if(!t)return;const r=new Set;e.forEach(i=>{r.add(i.id);const s=new Ml;i.features.features.forEach((a,l)=>{if(!a.geometry)return;const c=lTt(a.geometry);if(!c)return;const u=new gr({geometry:c,...a.properties,layerType:"importedLayer",layerId:i.id,layerName:i.name,layerColor:i.color,featureIndex:l});u.setStyle((h,f)=>cTt(i,a.geometry.type,f)),s.addFeature(u)});const o=n.current.get(i.id);if(o)o.setSource(s),o.setVisible(i.visible),o.setOpacity(i.opacity);else{const a=new Nl({source:s,zIndex:900,visible:i.visible,opacity:i.opacity,properties:{title:i.name,customLayerId:i.id}});t.addLayer(a),n.current.set(i.id,a)}}),n.current.forEach((i,s)=>{r.has(s)||(t.removeLayer(i),n.current.delete(s))})},[t,e]),Y.useEffect(()=>()=>{t&&(n.current.forEach(r=>{t.removeLayer(r)}),n.current.clear())},[t]),null}lr.defs("EPSG:28992","+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m +no_defs");Tbe(lr);function dTt(t){if(!t||t.length<2)return"unknown";const[e,n]=t;return e>=7e3&&e<=3e5&&n>=289e3&&n<=629e3?"RD":Math.abs(e)<=180&&Math.abs(n)<=90?"WGS84":"unknown"}function fTt(t){const[e,n]=t;return lr("EPSG:28992","EPSG:4326",[e,n])}function aSe(t,e){return typeof t[0]=="number"?e(t):t.map(n=>aSe(n,e))}function pTt(t){const e=t.coordinates;return!e||Array.isArray(e)&&e.length===0?null:t.type==="Point"?e:t.type==="LineString"||t.type==="MultiPoint"?e[0]:t.type==="Polygon"||t.type==="MultiLineString"?e[0]?.[0]:t.type==="MultiPolygon"?e[0]?.[0]?.[0]:null}async function mTt(t){const e=[],n=[];try{const r=await t.text(),i=JSON.parse(r);if(!i.type)return e.push('Ongeldig GeoJSON: geen "type" veld gevonden'),{success:!1,features:{type:"FeatureCollection",features:[]},errors:e,warnings:n,metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}};let s=[];i.type==="FeatureCollection"?s=i.features||[]:i.type==="Feature"?s=[i]:i.type==="GeometryCollection"?s=(i.geometries||[]).map((c,u)=>({type:"Feature",geometry:c,properties:{id:u}})):s=[{type:"Feature",geometry:i,properties:{}}],s.length===0&&n.push("Geen features gevonden in bestand");let o="unknown",a=!1;if(s.length>0&&s[0].geometry){const c=pTt(s[0].geometry);c&&(o=dTt(c))}o==="RD"&&(n.push("Rijksdriehoek coordinaten gedetecteerd, worden omgezet naar WGS84"),a=!0,s=s.map(c=>{if(!c.geometry)return c;const u=aSe(c.geometry.coordinates,fTt);return{...c,geometry:{...c.geometry,coordinates:u}}}),o="WGS84");const l=[...new Set(s.filter(c=>c.geometry).map(c=>c.geometry.type))];return{success:!0,features:{type:"FeatureCollection",features:s},errors:e,warnings:n,metadata:{featureCount:s.length,geometryTypes:l,coordinateSystem:o,transformed:a}}}catch(r){return e.push(`Fout bij parsen: ${r instanceof Error?r.message:"Onbekende fout"}`),{success:!1,features:{type:"FeatureCollection",features:[]},errors:e,warnings:n,metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}}}}async function gTt(t){const e=[],n=[];try{const r=await t.text(),s=new syt({extractStyles:!1}).readFeatures(r,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"});s.length===0&&n.push("Geen features gevonden in KML bestand");const l=new kL().writeFeaturesObject(s,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"}).features.map((u,h)=>{const f={...u.properties},g=f.name||f.Name||`Feature ${h+1}`,y=f.description||f.Description||"";return{type:"Feature",geometry:u.geometry,properties:{...f,name:g,description:y}}}),c=[...new Set(l.filter(u=>u.geometry).map(u=>u.geometry.type))];return{success:!0,features:{type:"FeatureCollection",features:l},errors:e,warnings:n,metadata:{featureCount:l.length,geometryTypes:c,coordinateSystem:"WGS84",transformed:!1}}}catch(r){return e.push(`Fout bij parsen KML: ${r instanceof Error?r.message:"Onbekende fout"}`),{success:!1,features:{type:"FeatureCollection",features:[]},errors:e,warnings:n,metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}}}}async function yTt(t){const e=[],n=[];try{const r=await t.text(),s=new _0t().readFeatures(r,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"});s.length===0&&n.push("Geen features gevonden in GPX bestand");const l=new kL().writeFeaturesObject(s,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"}).features.map((u,h)=>{const f={...u.properties},g=f.name||f.Name||`Waypoint ${h+1}`,y=f.desc||f.description||"",_=f.time||null,b=f.ele||null;return{type:"Feature",geometry:u.geometry,properties:{...f,name:g,description:y,time:_,elevation:b}}}),c=[...new Set(l.filter(u=>u.geometry).map(u=>u.geometry.type))];return c.includes("LineString")&&n.push("GPX track routes worden als lijnen weergegeven"),{success:!0,features:{type:"FeatureCollection",features:l},errors:e,warnings:n,metadata:{featureCount:l.length,geometryTypes:c,coordinateSystem:"WGS84",transformed:!1}}}catch(r){return e.push(`Fout bij parsen GPX: ${r instanceof Error?r.message:"Onbekende fout"}`),{success:!1,features:{type:"FeatureCollection",features:[]},errors:e,warnings:n,metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}}}}function Gq(t){switch(t.split(".").pop()?.toLowerCase()){case"geojson":case"json":return"geojson";case"kml":case"kmz":return"kml";case"gpx":return"gpx";default:return"unsupported"}}function vTt(){return".geojson,.json,.kml,.gpx"}function Uq(){return"GeoJSON, KML (Google My Maps), GPX"}async function _Tt(t){switch(Gq(t.name)){case"geojson":return mTt(t);case"kml":return gTt(t);case"gpx":return yTt(t);case"unsupported":default:return{success:!1,features:{type:"FeatureCollection",features:[]},errors:[`Niet-ondersteund bestandsformaat: ${t.name}. Ondersteunde formaten: ${Uq()}`],warnings:[],metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}}}}function xTt(t){return t.size>10485760?{valid:!1,error:`Bestand te groot (${(t.size/1024/1024).toFixed(1)} MB). Maximum is 10 MB.`}:Gq(t.name)==="unsupported"?{valid:!1,error:`Niet-ondersteund bestandsformaat. Ondersteunde formaten: ${Uq()}`}:t.name.toLowerCase().endsWith(".kmz")?{valid:!1,error:"KMZ bestanden worden nog niet ondersteund. Pak het bestand uit en importeer het .kml bestand."}:{valid:!0}}function wTt({isOpen:t,onClose:e}){const n=uI(M=>M.addLayer),r=Y.useRef(null),[i,s]=Y.useState("idle"),[o,a]=Y.useState(null),[l,c]=Y.useState(null),[u,h]=Y.useState(""),[f,g]=Y.useState(null),[y,_]=Y.useState(!1),b=Y.useCallback(()=>{s("idle"),a(null),c(null),h(""),g(null),r.current&&(r.current.value="")},[]),T=Y.useCallback(()=>{b(),e()},[b,e]),A=Y.useCallback(async M=>{const O=xTt(M);if(!O.valid){g(O.error||"Ongeldig bestand"),s("error");return}a(M),s("parsing"),g(null);const j=M.name.replace(/\.[^/.]+$/,"");h(j);try{const V=await _Tt(M);if(!V.success){g(V.errors.join(`
`)),s("error");return}if(V.features.features.length===0){g("Geen features gevonden in het bestand"),s("error");return}c(V),s("preview")}catch(V){g(V instanceof Error?V.message:"Onbekende fout bij parsen"),s("error")}},[]),I=Y.useCallback(M=>{const O=M.target.files?.[0];O&&A(O)},[A]),P=Y.useCallback(M=>{M.preventDefault(),_(!0)},[]),R=Y.useCallback(M=>{M.preventDefault(),_(!1)},[]),D=Y.useCallback(M=>{M.preventDefault(),_(!1);const O=M.dataTransfer.files?.[0];O&&A(O)},[A]),C=Y.useCallback(()=>{if(!l||!u.trim())return;const M=o?Gq(o.name):"geojson";n({name:u.trim(),type:M==="unsupported"?"geojson":M,features:l.features,visible:!0,opacity:1,color:"",sourceFileName:o?.name||"unknown"}),T()},[l,u,o,n,T]);return p.jsx(qn,{children:t&&p.jsxs(p.Fragment,{children:[p.jsx(_t.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:T}),p.jsxs(_t.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-md mx-auto my-auto max-h-[80vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[p.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-purple-500 to-purple-600 text-white",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(WI,{size:18}),p.jsx("span",{className:"font-medium",children:"Laag Importeren"})]}),p.jsx("button",{onClick:T,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none",children:p.jsx(Qr,{size:18})})]}),p.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[i==="idle"&&p.jsxs(p.Fragment,{children:[p.jsxs("div",{className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${y?"border-purple-500 bg-purple-50":"border-gray-300 hover:border-gray-400"}`,onDragOver:P,onDragLeave:R,onDrop:D,children:[p.jsx(HH,{size:40,className:"mx-auto text-gray-400 mb-3"}),p.jsx("p",{className:"text-gray-600 mb-2",children:"Sleep een bestand hierheen"}),p.jsx("p",{className:"text-gray-400 text-sm mb-4",children:"of"}),p.jsx("button",{onClick:()=>r.current?.click(),className:"px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors border-0 outline-none",children:"Bestand kiezen"}),p.jsx("input",{ref:r,type:"file",accept:vTt(),onChange:I,className:"hidden"})]}),p.jsxs("div",{className:"text-xs text-gray-500 text-center",children:[p.jsx("p",{className:"font-medium",children:"Ondersteunde formaten:"}),p.jsx("p",{children:Uq()})]})]}),i==="parsing"&&p.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[p.jsx(BI,{size:40,className:"text-purple-500 animate-spin mb-4"}),p.jsx("p",{className:"text-gray-600",children:"Bestand verwerken..."}),p.jsx("p",{className:"text-gray-400 text-sm",children:o?.name})]}),i==="error"&&p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{className:"flex items-start gap-3 p-4 bg-red-50 rounded-lg",children:[p.jsx(l2e,{size:20,className:"text-red-500 flex-shrink-0 mt-0.5"}),p.jsxs("div",{children:[p.jsx("p",{className:"font-medium text-red-700",children:"Import mislukt"}),p.jsx("p",{className:"text-sm text-red-600 mt-1 whitespace-pre-wrap",children:f})]})]}),p.jsx("button",{onClick:b,className:"w-full px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors border-0 outline-none",children:"Opnieuw proberen"})]}),i==="preview"&&l&&p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{className:"flex items-start gap-3 p-3 bg-green-50 rounded-lg",children:[p.jsx(ict,{size:20,className:"text-green-500 flex-shrink-0 mt-0.5"}),p.jsxs("div",{children:[p.jsx("p",{className:"font-medium text-green-700",children:"Bestand geladen"}),p.jsx("p",{className:"text-sm text-green-600",children:o?.name})]})]}),l.warnings.length>0&&p.jsxs("div",{className:"p-3 bg-amber-50 rounded-lg",children:[p.jsx("p",{className:"font-medium text-amber-700 text-sm",children:"Let op:"}),p.jsx("ul",{className:"text-sm text-amber-600 mt-1 list-disc list-inside",children:l.warnings.map((M,O)=>p.jsx("li",{children:M},O))})]}),p.jsx("div",{className:"p-3 bg-gray-50 rounded-lg text-sm",children:p.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[p.jsxs("div",{children:[p.jsx("span",{className:"text-gray-500",children:"Features:"}),p.jsx("span",{className:"ml-2 font-medium",children:l.metadata.featureCount})]}),p.jsxs("div",{children:[p.jsx("span",{className:"text-gray-500",children:"Types:"}),p.jsx("span",{className:"ml-2 font-medium",children:l.metadata.geometryTypes.join(", ")||"-"})]})]})}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Naam van de laag"}),p.jsx("input",{type:"text",value:u,onChange:M=>h(M.target.value),placeholder:"Bijv. Mijn locaties",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]})]}),i==="preview"&&p.jsxs("div",{className:"px-4 py-3 border-t border-gray-100 flex gap-2",children:[p.jsx("button",{onClick:b,className:"flex-1 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors border-0 outline-none",children:"Annuleren"}),p.jsx("button",{onClick:C,disabled:!u.trim(),className:"flex-1 px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors border-0 outline-none disabled:opacity-50 disabled:cursor-not-allowed",children:"Importeren"})]})]})]})})}function bTt(){const{user:t,loading:e,error:n,signInWithGoogle:r,logout:i,initAuth:s}=yO();return Y.useEffect(()=>{s()},[s]),e?p.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-white rounded-lg text-gray-500",children:[p.jsx(xp,{size:16,className:"animate-pulse"}),p.jsx("span",{className:"text-sm",children:"Laden..."})]}):t?p.jsxs("div",{className:"flex items-center gap-3 px-3 py-2.5 bg-green-50 rounded-lg",children:[t.photoURL?p.jsx("img",{src:t.photoURL,alt:t.displayName||"User",className:"w-8 h-8 rounded-full border-2 border-green-200",referrerPolicy:"no-referrer"}):p.jsx("div",{className:"w-8 h-8 rounded-full bg-green-200 flex items-center justify-center",children:p.jsx(JH,{size:16,className:"text-green-600"})}),p.jsxs("div",{className:"flex-1 min-w-0",children:[p.jsx("div",{className:"text-sm font-medium text-green-800 truncate",children:t.displayName||t.email}),p.jsxs("div",{className:"text-xs text-green-600 flex items-center gap-1",children:[p.jsx(xp,{size:12}),"Cloud sync actief"]})]}),p.jsx("button",{onClick:i,className:"p-1.5 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none bg-transparent",title:"Uitloggen",children:p.jsx(KH,{size:16})})]}):p.jsxs("div",{className:"space-y-2",children:[p.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-gray-50 rounded-lg text-gray-500",children:[p.jsx(fct,{size:16}),p.jsx("span",{className:"text-sm",children:"Alleen lokale opslag"})]}),p.jsxs("button",{onClick:r,className:"w-full flex items-center justify-center gap-2 px-3 py-2 bg-white hover:bg-blue-50 rounded-lg transition-colors border-0 outline-none",children:[p.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",children:[p.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),p.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),p.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),p.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),p.jsx("span",{className:"text-sm text-gray-700",children:"Inloggen met Google"})]}),n&&p.jsx("div",{className:"px-3 py-2 bg-red-50 text-red-700 text-xs rounded-lg",children:n})]})}const ETt="https://forms.gle/R5LCk11Bzu5XrkBj8";function STt(){const{settingsPanelOpen:t,toggleSettingsPanel:e,vondstDashboardOpen:n,toggleVondstDashboard:r,openLayerManagerModal:i}=Gr(),s=Cn(),{presets:o,createPreset:a,deletePreset:l,updatePreset:c}=qde(),u=mh(ne=>ne.vondsten),h=uI(ne=>ne.layers),{layers:f,updateLayer:g}=ps(),{devMode:y,setDevMode:_,tier:b}=QU(),[T,A]=Y.useState(""),[I,P]=Y.useState(!1),[R,D]=Y.useState(!1),[C,M]=Y.useState(null),[O,j]=Y.useState(""),[V,U]=Y.useState(null),[G,de]=Y.useState(""),[Ie,ze]=Y.useState("algemeen"),Ne=14*s.fontScale/100,fe=()=>{T.trim()&&(a(T.trim(),"Layers"),A(""),P(!1))},De=(ne,ie)=>{M(ne),j(ie)},Ce=ne=>{O.trim()&&(c(ne,{name:O.trim()}),console.log(` Preset hernoemd naar "${O.trim()}"`)),M(null),j("")},Q=()=>{M(null),j("")},W=[{id:"algemeen",label:"Algemeen",icon:p.jsx(zut,{size:14})},{id:"lagen",label:"Lagen",icon:p.jsx(yc,{size:14})},{id:"vondsten",label:"Vondsten",icon:p.jsx(Il,{size:14})}];return p.jsxs(p.Fragment,{children:[p.jsx(qn,{children:t&&p.jsxs(p.Fragment,{children:[p.jsx(_t.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),p.jsxs(_t.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-sm mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[p.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-blue-500",style:{fontSize:`${Ne}px`},children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(wz,{size:18,className:"text-white"}),p.jsx("span",{className:"font-medium text-white",children:"Instellingen"})]}),p.jsxs("div",{className:"flex items-center gap-2",children:[s.showFontSliders&&p.jsxs(p.Fragment,{children:[p.jsx("span",{className:"text-[10px] text-blue-200",children:"T"}),p.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:s.fontScale,onInput:ne=>{s.setFontScale(parseInt(ne.target.value))},onChange:ne=>s.setFontScale(parseInt(ne.target.value)),className:"w-20 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${s.fontScale}%`}),p.jsx("span",{className:"text-xs text-blue-200",children:"T"})]}),p.jsx("button",{onClick:e,className:"p-1 rounded bg-blue-400/50 hover:bg-blue-400 transition-colors border-0 outline-none ml-1",children:p.jsx(Qr,{size:18,className:"text-white",strokeWidth:2.5})})]})]}),p.jsx("div",{className:"flex border-b border-gray-200",children:W.map(ne=>p.jsxs("button",{onClick:()=>ze(ne.id),className:`flex-1 flex items-center justify-center gap-1.5 px-3 py-2.5 text-sm font-medium transition-colors border-0 outline-none ${Ie===ne.id?"text-blue-600 border-b-2 border-blue-600 bg-blue-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[ne.icon,ne.label]},ne.id))}),p.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-5",style:{fontSize:`${Ne}px`},children:[Ie==="algemeen"&&p.jsxs(p.Fragment,{children:[p.jsx(qh,{title:"Account",icon:p.jsx(JH,{size:16}),children:p.jsx(bTt,{})}),p.jsxs(qh,{title:"Kaart",icon:p.jsx(SL,{size:16}),children:[p.jsx(TTt,{label:"Standaard achtergrond",children:p.jsxs("select",{value:s.defaultBackground,onChange:ne=>s.setDefaultBackground(ne.target.value),className:"px-2 py-1 bg-gray-100 rounded border-0 outline-none",style:{fontSize:"0.9em"},children:[p.jsx("option",{value:"CartoDB (licht)",children:"Licht"}),p.jsx("option",{value:"OpenStreetMap",children:"OSM"}),p.jsx("option",{value:"Luchtfoto",children:"Luchtfoto"})]})}),p.jsx(H0,{label:"Schaalbalk tonen",checked:s.showScaleBar,onChange:s.setShowScaleBar})]}),p.jsxs(qh,{title:"GPS",icon:p.jsx(Tb,{size:16}),children:[p.jsx(H0,{label:"GPS aan bij start",checked:s.gpsAutoStart,onChange:s.setGpsAutoStart}),p.jsx(H0,{label:"Nauwkeurigheidscirkel",checked:s.showAccuracyCircle,onChange:s.setShowAccuracyCircle})]}),p.jsxs(qh,{title:"Feedback",icon:p.jsx(Uut,{size:16}),children:[p.jsx(H0,{label:"Trillen bij acties",checked:s.hapticFeedback,onChange:s.setHapticFeedback}),p.jsx(H0,{label:"Spraakfeedback vondsten",checked:s.voiceFeedbackEnabled,onChange:s.setVoiceFeedbackEnabled}),s.voiceFeedbackEnabled&&p.jsxs("p",{className:"text-gray-500 mt-1",style:{fontSize:"0.75em"},children:[p.jsx(uht,{size:12,className:"inline mr-1"}),"Spreekt vondst info uit bij toevoegen"]})]}),p.jsxs(qh,{title:"Weer",icon:p.jsx(xp,{size:16}),children:[p.jsx(H0,{label:"Weerwidget tonen",checked:s.showWeatherButton,onChange:s.setShowWeatherButton}),p.jsx("p",{className:"text-gray-500 mt-1",style:{fontSize:"0.75em"},children:"Actueel weer, voorspelling en buienradar"})]}),p.jsxs(qh,{title:"Development",icon:p.jsx(_ct,{size:16}),children:[p.jsx(H0,{label:"Dev Mode (alles ontgrendeld)",checked:y,onChange:_}),p.jsxs("p",{className:"text-gray-500 mt-1",style:{fontSize:"0.75em"},children:["Huidige tier: ",p.jsx("span",{className:"font-medium text-blue-600",children:b}),y&&p.jsx("span",{className:"text-green-600",children:" (alle lagen ontgrendeld)"})]})]})]}),Ie==="lagen"&&p.jsxs(p.Fragment,{children:[p.jsx(qh,{title:"Mijn lagen",icon:p.jsx(yc,{size:16}),isOwn:!0,children:p.jsxs("div",{className:"space-y-1",children:[f.filter(ne=>!ne.archived).length===0?p.jsx("p",{className:"text-gray-500 py-1",style:{fontSize:"0.75em"},children:"Nog geen eigen lagen aangemaakt."}):f.filter(ne=>!ne.archived).map(ne=>p.jsx("div",{className:"flex items-center gap-2 py-1.5 px-2 hover:bg-gray-50 rounded",children:V===ne.id?p.jsx("input",{type:"text",value:G,onChange:ie=>de(ie.target.value),onKeyDown:ie=>{ie.key==="Enter"?(G.trim()&&g(ne.id,{name:G.trim()}),U(null)):ie.key==="Escape"&&U(null)},onBlur:()=>{G.trim()&&g(ne.id,{name:G.trim()}),U(null)},autoFocus:!0,className:"flex-1 px-1.5 py-0.5 text-sm bg-orange-50 rounded outline-none focus:ring-1 focus:ring-orange-400"}):p.jsxs(p.Fragment,{children:[p.jsx("span",{className:"flex-1 text-sm text-gray-700 truncate",children:ne.name}),p.jsxs("span",{className:"text-xs text-gray-400",children:[ne.points.length," punten"]}),p.jsx("button",{onClick:()=>{U(ne.id),de(ne.name)},className:"p-1 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none bg-transparent",title:"Naam bewerken",children:p.jsx(Kg,{size:12})})]})},ne.id)),p.jsxs("button",{onClick:()=>{i(),e()},className:"flex items-center gap-2 mt-2 px-2 py-1.5 text-orange-600 hover:bg-orange-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[p.jsx(wz,{size:14}),p.jsx("span",{children:"Lagen beheren"})]})]})}),p.jsx(qh,{title:"Lagen importeren",icon:p.jsx(WI,{size:16}),children:p.jsxs("div",{className:"space-y-1",children:[h.length>0&&p.jsxs(p.Fragment,{children:[h.map(ne=>p.jsx(E2e,{layer:ne},ne.id)),p.jsx("div",{className:"border-t border-gray-100 my-2"})]}),p.jsxs("button",{onClick:()=>D(!0),className:"flex items-center gap-2 px-2 py-1.5 text-cyan-600 hover:bg-cyan-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[p.jsx(_u,{size:14}),p.jsx("span",{children:"Nieuwe laag importeren"})]}),p.jsx("p",{className:"text-gray-400 mt-1",style:{fontSize:"0.7em"},children:"GeoJSON, KML (Google My Maps), GPX"})]})}),p.jsx(qh,{title:"Presets",icon:p.jsx(yc,{size:16}),children:p.jsxs("div",{className:"space-y-2",children:[o.map(ne=>p.jsx("div",{className:"flex items-center justify-between py-1",children:C===ne.id?p.jsxs("div",{className:"flex-1 flex items-center gap-1",children:[p.jsx("input",{type:"text",value:O,onChange:ie=>j(ie.target.value),onKeyDown:ie=>{ie.key==="Enter"&&Ce(ne.id),ie.key==="Escape"&&Q()},className:"flex-1 px-2 py-0.5 bg-blue-50 rounded border border-blue-300 outline-none",style:{fontSize:"0.9em"},autoFocus:!0}),p.jsx("button",{onClick:()=>Ce(ne.id),className:"px-2 py-0.5 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors border-0 outline-none",style:{fontSize:"0.7em"},children:"OK"}),p.jsx("button",{onClick:Q,className:"px-2 py-0.5 bg-gray-200 text-gray-600 rounded hover:bg-gray-300 transition-colors border-0 outline-none",style:{fontSize:"0.7em"},children:""})]}):p.jsxs(p.Fragment,{children:[p.jsxs("div",{className:"flex-1 min-w-0",children:[p.jsxs("span",{className:"text-gray-600",style:{fontSize:"0.9em"},children:[ne.name,ne.isBuiltIn&&p.jsx("span",{className:"ml-1 text-gray-400",style:{fontSize:"0.7em"},children:"(standaard)"})]}),p.jsxs("span",{className:"ml-1 text-gray-400",style:{fontSize:"0.7em"},children:["(",ne.layers.length," lagen)"]})]}),!ne.isBuiltIn&&p.jsxs("div",{className:"flex items-center gap-1",children:[p.jsx("button",{onClick:()=>De(ne.id,ne.name),className:"p-1 text-blue-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none",title:"Naam wijzigen",children:p.jsx(Kg,{size:14})}),p.jsx("button",{onClick:()=>l(ne.id),className:"p-1 text-red-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors border-0 outline-none",title:"Verwijderen",children:p.jsx(Sh,{size:14})})]})]})},ne.id)),I?p.jsxs("div",{className:"flex gap-2 mt-2",children:[p.jsx("input",{type:"text",value:T,onChange:ne=>A(ne.target.value),placeholder:"Naam nieuwe preset",className:"flex-1 px-2 py-1 bg-gray-100 rounded border-0 outline-none",style:{fontSize:"0.9em"},onKeyDown:ne=>ne.key==="Enter"&&fe(),autoFocus:!0}),p.jsx("button",{onClick:fe,className:"px-2 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors border-0 outline-none",style:{fontSize:"0.75em"},children:"Opslaan"}),p.jsx("button",{onClick:()=>P(!1),className:"px-2 py-1 bg-gray-200 text-gray-600 rounded hover:bg-gray-300 transition-colors border-0 outline-none",style:{fontSize:"0.75em"},children:"Annuleren"})]}):p.jsxs("button",{onClick:()=>P(!0),className:"flex items-center gap-2 mt-2 px-2 py-1.5 text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[p.jsx(_u,{size:14}),p.jsx("span",{children:"Huidige lagen als preset opslaan"})]})]})})]}),Ie==="vondsten"&&p.jsx(p.Fragment,{children:p.jsxs(qh,{title:"Vondsten",icon:p.jsx(Il,{size:16}),isOwn:!0,children:[p.jsx("p",{className:"text-gray-500 py-1",style:{fontSize:"0.75em"},children:"Vondsten worden altijd lokaal op dit apparaat opgeslagen."}),p.jsxs("button",{onClick:r,className:"flex items-center gap-2 mt-2 px-2 py-1.5 text-orange-600 hover:bg-orange-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[p.jsx(o2e,{size:14}),p.jsxs("span",{children:["Dashboard (",u.length," vondsten)"]})]}),p.jsx(kTt,{})]})})]}),p.jsxs("div",{className:"px-4 py-3 border-t border-gray-100 space-y-2",style:{fontSize:`${Ne}px`},children:[p.jsxs("a",{href:ETt,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 w-full px-3 py-2 text-orange-600 hover:bg-orange-50 rounded-lg transition-colors border-0 outline-none",style:{fontSize:"0.9em"},children:[p.jsx(s2e,{size:16}),p.jsx("span",{children:"Meld een bug"})]}),p.jsxs("button",{onClick:oTt,className:"flex items-center justify-center gap-2 w-full px-3 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none",style:{fontSize:"0.9em"},children:[p.jsx(KH,{size:16}),p.jsx("span",{children:"Uitloggen"})]}),p.jsx("p",{className:"text-gray-400 text-center",style:{fontSize:"0.75em"},children:"Instellingen worden lokaal opgeslagen"})]})]})]})}),p.jsx(aTt,{isOpen:n,onClose:r}),p.jsx(wTt,{isOpen:R,onClose:()=>D(!1)})]})}function qh({title:t,icon:e,children:n,isOwn:r}){return p.jsxs("section",{children:[p.jsxs("div",{className:"flex items-center gap-2 mb-2 pb-1 border-b border-gray-100",children:[p.jsx("span",{className:r?"text-orange-600":"text-blue-600",children:e}),p.jsx("span",{className:`font-medium ${r?"text-orange-600":"text-gray-800"}`,style:{fontSize:"1em"},children:t})]}),p.jsx("div",{className:"space-y-2",children:n})]})}function TTt({label:t,children:e}){return p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsx("span",{className:"text-gray-600",style:{fontSize:"0.9em"},children:t}),e]})}function H0({label:t,checked:e,onChange:n}){return p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsx("span",{className:"text-gray-600",style:{fontSize:"0.9em"},children:t}),p.jsx("button",{onClick:()=>n(!e),className:`w-10 h-5 rounded-full transition-all border-0 outline-none relative ${e?"bg-gradient-to-r from-blue-500 to-blue-600":"bg-gray-300"}`,children:p.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white shadow-sm transition-all ${e?"left-[22px]":"left-0.5"}`})})]})}function kTt(){const[t,e]=Y.useState(!1),{vondsten:n,exportAsGeoJSON:r,exportAsCSV:i,exportAsExcel:s,exportAsGPX:o,exportAsKML:a}=mh(),l=[{label:"Excel (.xlsx)",action:s,desc:"Spreadsheet"},{label:"CSV",action:i,desc:"Comma-separated"},{label:"GeoJSON",action:r,desc:"GIS software"},{label:"GPX",action:o,desc:"GPS apparaten"},{label:"KML",action:a,desc:"Google Earth"}],c=u=>{u(),e(!1)};return n.length===0?p.jsxs("div",{className:"flex items-center gap-2 mt-2 px-2 py-1.5 text-gray-400 bg-gray-100 rounded w-full cursor-not-allowed",style:{fontSize:"0.9em"},children:[p.jsx(vA,{size:14}),p.jsx("span",{children:"Geen vondsten om te exporteren"})]}):p.jsxs("div",{className:"relative mt-2",children:[p.jsxs("button",{onClick:()=>e(!t),className:"flex items-center justify-between gap-2 px-2 py-1.5 text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(vA,{size:14}),p.jsxs("span",{children:["Exporteer vondsten (",n.length,")"]})]}),p.jsx("span",{style:{fontSize:"0.8em"},children:""})]}),t&&p.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-200 rounded-lg shadow-lg z-10 overflow-hidden",children:l.map((u,h)=>p.jsxs("button",{onClick:()=>c(u.action),className:"w-full px-3 py-2 text-left hover:bg-blue-50 transition-colors border-0 outline-none flex justify-between items-center",style:{fontSize:"0.9em"},children:[p.jsx("span",{className:"text-gray-700",children:u.label}),p.jsx("span",{className:"text-gray-400",style:{fontSize:"0.8em"},children:u.desc})]},h))})]})}const g5="2.32.34";function ATt({size:t=18}){return p.jsxs("svg",{viewBox:"0 0 24 24",width:t,height:t,children:[p.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),p.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),p.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),p.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]})}function ITt(){const[t,e]=Y.useState(!1),{user:n,loading:r,signInWithGoogle:i,logout:s}=yO(),{toggleInfoPanel:o,toggleSettingsPanel:a,toggleMonumentSearch:l}=Gr(),c=Cn(G=>G.menuFontScale),u=Cn(G=>G.setMenuFontScale),h=Cn(G=>G.showFontSliders),f=Cn(G=>G.setShowFontSliders),g=Cn(G=>G.showVondstButton),y=Cn(G=>G.setShowVondstButton),_=Cn(G=>G.showRouteRecordButton),b=Cn(G=>G.setShowRouteRecordButton),T=Cn(G=>G.showCustomPointLayers),A=Cn(G=>G.setShowCustomPointLayers),I=Cn(G=>G.showWeatherButton),P=Cn(G=>G.setShowWeatherButton),R={top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"},D=()=>e(!1),C=()=>{D(),o()},M=()=>{D(),a()},O=()=>{D(),l()},j=()=>{D(),i()},V=()=>{D(),s()},U=13*c/100;return p.jsxs(p.Fragment,{children:[p.jsx(_t.button,{className:`fixed right-2 z-[800] w-11 h-11 flex items-center justify-center rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm ${t?"bg-blue-500 hover:bg-blue-600":"bg-white/90 hover:bg-white"}`,style:R,onClick:()=>e(!t),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Menu",children:t?p.jsx(Qr,{size:22,className:"text-white"}):p.jsx(m2e,{size:22,className:"text-gray-600"})}),p.jsx(qn,{children:t&&p.jsxs(p.Fragment,{children:[p.jsx(_t.div,{className:"fixed inset-0 z-[799]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:D}),p.jsxs(_t.div,{initial:{opacity:0,y:-8,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-8,scale:.95},transition:{duration:.15},className:"fixed right-2 z-[801] w-64 bg-white rounded-xl shadow-lg overflow-hidden flex flex-col",style:{top:"calc(max(0.5rem, env(safe-area-inset-top, 0.5rem)) + 52px)",fontSize:`${U}px`},children:[p.jsxs("div",{className:"flex items-center justify-between gap-2 px-3 py-1.5 bg-blue-500",children:[p.jsx("span",{className:"font-medium text-white",style:{fontSize:`${U}px`},children:"Menu"}),h&&p.jsxs("div",{className:"flex items-center gap-1",children:[p.jsx("span",{className:"text-[9px] text-blue-200",children:"T"}),p.jsx("input",{type:"range",min:"80",max:"130",step:"10",value:c,onInput:G=>u(parseInt(G.target.value)),onChange:G=>u(parseInt(G.target.value)),className:"w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${c}%`}),p.jsx("span",{className:"text-[11px] text-blue-200",children:"T"})]})]}),r?p.jsx("div",{className:"px-3 py-4 flex items-center justify-center",children:p.jsx("div",{className:"w-5 h-5 border-2 border-gray-300 border-t-blue-500 rounded-full animate-spin"})}):n?p.jsx("div",{className:"px-3 py-3 border-b border-gray-100",children:p.jsxs("div",{className:"flex items-center gap-3",children:[n.photoURL?p.jsx("img",{src:n.photoURL,alt:n.displayName||"User",className:"w-8 h-8 rounded-full",referrerPolicy:"no-referrer"}):p.jsx("div",{className:"w-8 h-8 rounded-full bg-green-500 flex items-center justify-center",children:p.jsx(JH,{size:16,className:"text-white"})}),p.jsxs("div",{className:"flex-1 min-w-0",children:[p.jsx("div",{className:"font-medium text-gray-800 truncate",style:{fontSize:"0.85em"},children:n.displayName||"Gebruiker"}),p.jsx("div",{className:"text-green-600",style:{fontSize:"0.7em"},children:"Cloud sync actief"})]}),p.jsx("button",{onClick:V,className:"p-1.5 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none bg-transparent",title:"Uitloggen",children:p.jsx(KH,{size:16})})]})}):p.jsxs("button",{onClick:j,className:"w-full px-3 py-3 flex items-center gap-3 hover:bg-blue-50 transition-colors border-0 outline-none bg-transparent",children:[p.jsx(ATt,{size:18}),p.jsx("span",{className:"text-gray-700",style:{fontSize:"0.9em"},children:"Inloggen met Google"})]}),p.jsxs("div",{className:"py-1",children:[p.jsxs("button",{onClick:C,className:"w-full px-3 py-2.5 text-left flex items-center gap-3 border-0 outline-none bg-transparent transition-colors text-gray-700 hover:bg-blue-50",style:{fontSize:"0.95em"},children:[p.jsx(qH,{size:18,className:"text-blue-500"}),p.jsx("span",{children:"Info & handleiding"})]}),p.jsxs("button",{onClick:O,className:"w-full px-3 py-2.5 text-left flex items-center gap-3 border-0 outline-none bg-transparent transition-colors text-gray-700 hover:bg-purple-50",style:{fontSize:"0.95em"},children:[p.jsx(f2e,{size:18,className:"text-purple-500"}),p.jsx("span",{children:"Zoek in monumenten"})]})]}),p.jsxs("div",{className:"py-1 border-t border-gray-100",children:[p.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx(Il,{size:18,className:"text-orange-500"}),p.jsx("span",{className:"text-gray-700",style:{fontSize:"0.9em"},children:"Vondst knop"})]}),p.jsx("button",{onClick:()=>y(!g),className:`w-10 h-5 rounded-full transition-all border-0 outline-none relative ${g?"bg-gradient-to-r from-orange-500 to-orange-600":"bg-gray-300"}`,children:p.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white shadow-sm transition-all ${g?"left-[22px]":"left-0.5"}`})})]}),p.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx(GN,{size:18,className:"text-green-500"}),p.jsx("span",{className:"text-gray-700",style:{fontSize:"0.9em"},children:"Route knop"})]}),p.jsx("button",{onClick:()=>b(!_),className:`w-10 h-5 rounded-full transition-all border-0 outline-none relative ${_?"bg-gradient-to-r from-green-500 to-green-600":"bg-gray-300"}`,children:p.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white shadow-sm transition-all ${_?"left-[22px]":"left-0.5"}`})})]}),p.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx(xp,{size:18,className:"text-cyan-500"}),p.jsx("span",{className:"text-gray-700",style:{fontSize:"0.9em"},children:"Weerwidget"})]}),p.jsx("button",{onClick:()=>P(!I),className:`w-10 h-5 rounded-full transition-all border-0 outline-none relative ${I?"bg-gradient-to-r from-cyan-500 to-cyan-600":"bg-gray-300"}`,children:p.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white shadow-sm transition-all ${I?"left-[22px]":"left-0.5"}`})})]}),p.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx(yc,{size:18,className:"text-amber-500"}),p.jsx("span",{className:"text-gray-700",style:{fontSize:"0.9em"},children:"Mijn lagen"})]}),p.jsx("button",{onClick:()=>A(!T),className:`w-10 h-5 rounded-full transition-all border-0 outline-none relative ${T?"bg-gradient-to-r from-amber-500 to-amber-600":"bg-gray-300"}`,children:p.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white shadow-sm transition-all ${T?"left-[22px]":"left-0.5"}`})})]}),p.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx(ZH,{size:18,className:"text-purple-500"}),p.jsx("span",{className:"text-gray-700",style:{fontSize:"0.9em"},children:"Tekstgrootte"})]}),p.jsx("button",{onClick:()=>f(!h),className:`w-10 h-5 rounded-full transition-all border-0 outline-none relative ${h?"bg-gradient-to-r from-purple-500 to-purple-600":"bg-gray-300"}`,children:p.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white shadow-sm transition-all ${h?"left-[22px]":"left-0.5"}`})})]})]}),p.jsx("div",{className:"mt-auto border-t border-gray-100",children:p.jsxs("button",{onClick:M,className:"w-full px-3 py-2.5 text-left flex items-center gap-3 border-0 outline-none bg-transparent transition-colors text-gray-700 hover:bg-gray-50",style:{fontSize:"0.95em"},children:[p.jsx(wz,{size:18,className:"text-gray-500"}),p.jsx("span",{children:"Instellingen"})]})}),p.jsxs("div",{className:"px-3 py-1.5 bg-gray-50 text-center text-gray-400",style:{fontSize:"0.65em"},children:["DetectorApp NL v",g5]})]})]})})]})}const PTt="https://forms.gle/R5LCk11Bzu5XrkBj8";function CTt(){const{infoPanelOpen:t,toggleInfoPanel:e}=Gr(),[n,r]=Y.useState("info"),i=[{id:"info",label:"Info",icon:p.jsx(qH,{size:14})},{id:"functies",label:"Functies",icon:p.jsx(HH,{size:14})},{id:"handleiding",label:"Handleiding",icon:p.jsx(i2e,{size:14})}];return p.jsx(qn,{children:t&&p.jsxs(p.Fragment,{children:[p.jsx(_t.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),p.jsxs(_t.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[90vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[p.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-blue-500",children:[p.jsxs("span",{className:"font-medium text-white",children:["DetectorApp NL v",g5]}),p.jsx("button",{onClick:e,className:"p-1 rounded bg-blue-400/50 hover:bg-blue-400 transition-colors border-0 outline-none",children:p.jsx(Qr,{size:18,className:"text-white",strokeWidth:2.5})})]}),p.jsx("div",{className:"flex border-b border-gray-200",children:i.map(s=>p.jsxs("button",{onClick:()=>r(s.id),className:`flex-1 flex items-center justify-center gap-1.5 px-3 py-2.5 text-sm font-medium transition-colors border-0 outline-none ${n===s.id?"text-blue-600 border-b-2 border-blue-600 bg-blue-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[s.icon,s.label]},s.id))}),p.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 text-sm",children:[n==="info"&&p.jsx(RTt,{}),n==="functies"&&p.jsx(MTt,{}),n==="handleiding"&&p.jsx(NTt,{}),p.jsxs("section",{className:"pt-2 border-t border-gray-200 space-y-2",children:[p.jsxs("a",{href:PTt,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 w-full px-3 py-2 text-orange-600 hover:bg-orange-50 rounded-lg transition-colors",children:[p.jsx(s2e,{size:14}),p.jsx("span",{className:"text-sm",children:"Meld een bug of geef feedback"})]}),p.jsxs("p",{className:"text-xs text-gray-400 text-center",children:["DetectorApp NL v",g5," - Gratis en zonder tracking"]})]})]})]})]})})}function RTt(){return p.jsxs(p.Fragment,{children:[p.jsxs("section",{children:[p.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Over deze app"}),p.jsx("p",{className:"text-gray-600",children:"DetectorApp NL is d gratis kaartapplicatie voor metaaldetectie, fossielen zoeken en archeologische verkenning in Nederland. Met 70+ kaartlagen, GPS tracking met richtingspijl, eigen lagen, cloud sync en uitgebreid vondstenbeheer."})]}),p.jsxs("section",{children:[p.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Databronnen & Licenties"}),p.jsxs("ul",{className:"space-y-2 text-gray-600",children:[p.jsxs("li",{children:[p.jsx("strong",{children:"RCE / Cultureelerfgoed.nl"})," (CC0/CC-BY)",p.jsx("br",{}),p.jsx("span",{className:"text-xs",children:"AMK Monumenten, Rijksmonumenten, Werelderfgoed, Paleokaarten, Religieus Erfgoed, Essen, Archeo Onderzoeken"})]}),p.jsxs("li",{children:[p.jsx("strong",{children:"PDOK / Kadaster"})," (CC0/CC-BY)",p.jsx("br",{}),p.jsx("span",{className:"text-xs",children:"Luchtfoto, AHN Hoogtekaarten, IKAW, Bodemkaart, Geomorfologie, Kadastrale Grenzen, Gewaspercelen"})]}),p.jsxs("li",{children:[p.jsx("strong",{children:"OpenStreetMap"})," (ODbL)",p.jsx("br",{}),p.jsx("span",{className:"text-xs",children:"Hunebedden, Grafheuvels, Bunkers, Kastelen, Terpen, Parken, Kringloopwinkels, Musea, Speeltuinen, Strandjes"})]}),p.jsxs("li",{children:[p.jsx("strong",{children:"Itiner-E / Wetenschappelijk"})," (CC BY 4.0)",p.jsx("br",{}),p.jsx("span",{className:"text-xs",children:"Romeinse wegen - Brughmans, Paout, de Soto & Bjerregaard Vahlstrup"})]}),p.jsxs("li",{children:[p.jsx("strong",{children:"Mindat.org"}),p.jsx("br",{}),p.jsx("span",{className:"text-xs",children:"Mineralen hotspots en vindplaatsen"})]}),p.jsxs("li",{children:[p.jsx("strong",{children:"Paleontica / Fossielen data"}),p.jsx("br",{}),p.jsx("span",{className:"text-xs",children:"Fossiel hotspots en vindplaatsen"})]}),p.jsxs("li",{children:[p.jsx("strong",{children:"Map5.nl / Kadaster"}),p.jsx("br",{}),p.jsx("span",{className:"text-xs",children:"Historische kaarten (TMK 1850, Bonnebladen 1900)"})]}),p.jsxs("li",{children:[p.jsx("strong",{children:"Provinciale data"}),p.jsx("br",{}),p.jsx("span",{className:"text-xs",children:"Relictenkaart (Gelderland), Scheepswrakken (Zuid-Holland), Verdronken Dorpen (Zeeland)"})]}),p.jsxs("li",{children:[p.jsx("strong",{children:"UIKAV / Rijkswaterstaat"}),p.jsx("br",{}),p.jsx("span",{className:"text-xs",children:"Uiterwaarden archeologische data, Expert advies, Bufferlagen"})]})]})]}),p.jsxs("section",{children:[p.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Privacy & Opslag"}),p.jsxs("div",{className:"text-gray-600 space-y-2",children:[p.jsxs("p",{children:[p.jsx("strong",{children:"Volledig anoniem mogelijk:"})," Je kunt deze app gebruiken zonder enige registratie of login. Al je data blijft dan 100% op je eigen apparaat."]}),p.jsxs("p",{children:[p.jsx("strong",{children:"Geen tracking:"})," Deze app verzamelt geen analytics, cookies, gebruiksstatistieken of persoonlijke gegevens. Er is geen server die je gedrag registreert."]}),p.jsxs("p",{children:[p.jsx("strong",{children:"Locatiegegevens:"})," Je GPS-positie wordt alleen gebruikt om je locatie op de kaart te tonen. Deze wordt niet opgeslagen of gedeeld met derden."]})]})]}),p.jsxs("section",{children:[p.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Google Login - Wat betekent het?"}),p.jsxs("div",{className:"text-gray-600 space-y-2",children:[p.jsx("p",{className:"font-medium text-green-700",children:" Google login is volledig optioneel"}),p.jsx("p",{children:p.jsx("strong",{children:"Wat wordt gesynchroniseerd:"})}),p.jsxs("ul",{className:"list-disc list-inside ml-2 text-xs space-y-1",children:[p.jsx("li",{children:"Je eigen aangemaakte lagen (Mijn Lagen)"}),p.jsx("li",{children:"Je vondsten registraties"}),p.jsx("li",{children:"Je preset-instellingen"})]}),p.jsx("p",{children:p.jsx("strong",{children:"Wat NIET wordt gedeeld:"})}),p.jsxs("ul",{className:"list-disc list-inside ml-2 text-xs space-y-1",children:[p.jsx("li",{children:"Je GPS-locatie wordt niet opgeslagen in de cloud"}),p.jsx("li",{children:"Je zoekgeschiedenis wordt niet bewaard"}),p.jsx("li",{children:"Welke kaartlagen je bekijkt wordt niet geregistreerd"}),p.jsx("li",{children:"Niemand anders kan je data zien - alleen jij"})]}),p.jsxs("p",{children:[p.jsx("strong",{children:"Waarom inloggen?"})," Alleen voor synchronisatie tussen apparaten (telefoon/tablet/PC) en als backup voor je vondsten."]}),p.jsx("p",{className:"text-xs text-gray-500 italic",children:"Tip: Gebruik de app gerust zonder login als je privacy belangrijker vindt dan synchronisatie. Alle functies werken ook offline."})]})]}),p.jsxs("section",{children:[p.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Zonder login (anoniem)"}),p.jsxs("div",{className:"text-gray-600 space-y-2",children:[p.jsx("p",{className:"font-medium text-blue-700",children:" 95% van de functies werkt zonder login"}),p.jsx("p",{children:p.jsx("strong",{children:"Beschikbaar zonder login:"})}),p.jsxs("ul",{className:"list-disc list-inside ml-2 text-xs space-y-1",children:[p.jsx("li",{children:"Alle 70+ kaartlagen bekijken"}),p.jsx("li",{children:"GPS tracking en navigatie"}),p.jsx("li",{children:"Vondsten registreren (lokaal opgeslagen)"}),p.jsx("li",{children:"Eigen lagen aanmaken (lokaal opgeslagen)"}),p.jsx("li",{children:"Export naar Excel/CSV/GeoJSON/GPX/KML"}),p.jsx("li",{children:"Lagen importeren"}),p.jsx("li",{children:"Alle presets en instellingen"})]}),p.jsx("p",{children:p.jsx("strong",{children:"Alleen met login:"})}),p.jsxs("ul",{className:"list-disc list-inside ml-2 text-xs space-y-1",children:[p.jsx("li",{children:"Synchronisatie tussen apparaten"}),p.jsx("li",{children:"Cloud backup van je vondsten"})]})]})]})]})}function MTt(){return p.jsxs(p.Fragment,{children:[p.jsxs("section",{children:[p.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[p.jsx(SL,{size:16,className:"text-blue-600"}),"Kaartlagen (70+)"]}),p.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[p.jsxs("li",{children:[p.jsx("strong",{children:"Basis:"})," CartoDB, OpenStreetMap, PDOK Luchtfoto"]}),p.jsxs("li",{children:[p.jsx("strong",{children:"Historisch:"})," TMK 1850, Bonnebladen 1900"]}),p.jsxs("li",{children:[p.jsx("strong",{children:"Hoogtekaarten:"})," AHN4 Hillshade, Multi-Hillshade, Hoogtekaart Kleur, AHN 0.5m"]}),p.jsxs("li",{children:[p.jsx("strong",{children:"Archeologie:"})," AMK Monumenten (per periode), Archeo Onderzoeken, IKAW, Essen"]}),p.jsxs("li",{children:[p.jsx("strong",{children:"Romeins:"})," Romeinse wegen, Romeinse Forten met historische info, Limesweg"]}),p.jsxs("li",{children:[p.jsx("strong",{children:"Prehistorie:"})," Hunebedden, Grafheuvels, Terpen, Paleokaarten (7 periodes)"]}),p.jsxs("li",{children:[p.jsx("strong",{children:"Militair:"})," WWII Bunkers, Slagvelden, Vliegvelden, Verdedigingslinies"]}),p.jsxs("li",{children:[p.jsx("strong",{children:"Erfgoed:"})," Rijksmonumenten, Kastelen, Runes, Religieus Erfgoed"]}),p.jsxs("li",{children:[p.jsx("strong",{children:"Terrein:"})," Veengebieden, Geomorfologie, Bodemkaart"]}),p.jsxs("li",{children:[p.jsx("strong",{children:"Percelen:"})," Gewaspercelen (met bouwplantoelichting), Kadastrale Grenzen"]}),p.jsxs("li",{children:[p.jsx("strong",{children:"Recreatie:"})," Parken, Musea, Kringloopwinkels, Strandjes, Wandelroutes"]}),p.jsxs("li",{children:[p.jsx("strong",{children:"Provinciaal:"})," Relictenkaart, Scheepswrakken, Verdronken Dorpen"]}),p.jsxs("li",{children:[p.jsx("strong",{children:"UIKAV:"})," Uiterwaard data, Expert advies, Vlakken, Punten, Bufferlagen"]})]})]}),p.jsxs("section",{children:[p.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[p.jsx(Uct,{size:16,className:"text-purple-600"}),"Mineralen & Fossielen"]}),p.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[p.jsxs("li",{children:[p.jsx("strong",{children:"Mineralen hotspots:"})," Vindplaatsen uit Mindat.org met mineralenlijst"]}),p.jsxs("li",{children:[p.jsx("strong",{children:"Goudrivieren:"})," Bekende locaties voor goud zoeken"]}),p.jsxs("li",{children:[p.jsx("strong",{children:"Fossiel hotspots:"})," Vindplaatsen met fossieltypen en periodes"]}),p.jsxs("li",{children:[p.jsx("strong",{children:"Premium lagen:"})," Gedetailleerde data (beschikbaar met account)"]})]})]}),p.jsxs("section",{children:[p.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[p.jsx(Dct,{size:16,className:"text-orange-600"}),"Mijn Lagen"]}),p.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[p.jsxs("li",{children:[p.jsx("strong",{children:"Eigen lagen:"})," Maak lagen voor vakantie, projecten, etc."]}),p.jsxs("li",{children:[p.jsx("strong",{children:"Toevoegen:"})," Tik op + in popup om monument/locatie aan laag toe te voegen"]}),p.jsxs("li",{children:[p.jsx("strong",{children:"Polygonen:"})," Hele monumentgebieden worden opgeslagen, niet alleen een punt"]}),p.jsxs("li",{children:[p.jsx("strong",{children:"Originele info:"})," Popup content blijft behouden"]}),p.jsxs("li",{children:[p.jsx("strong",{children:"Kleuren:"})," Elke laag krijgt eigen kleur (aanpasbaar)"]}),p.jsxs("li",{children:[p.jsx("strong",{children:"Import:"})," Laad GeoJSON, KML of GPX bestanden"]}),p.jsxs("li",{children:[p.jsx("strong",{children:"Export:"})," Exporteer lagen als GeoJSON"]})]})]}),p.jsxs("section",{children:[p.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[p.jsx(xp,{size:16,className:"text-green-600"}),"Google Cloud Sync"]}),p.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[p.jsxs("li",{children:[p.jsx("strong",{children:"Inloggen:"})," Via hamburger menu rechtsboven"]}),p.jsxs("li",{children:[p.jsx("strong",{children:"Synchronisatie:"})," Lagen en vondsten automatisch naar cloud"]}),p.jsxs("li",{children:[p.jsx("strong",{children:"Meerdere apparaten:"})," Altijd toegang tot je data"]}),p.jsxs("li",{children:[p.jsx("strong",{children:"Veilig:"})," Alleen jij hebt toegang tot je gegevens"]})]})]}),p.jsxs("section",{children:[p.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[p.jsx(Tb,{size:16,className:"text-green-600"}),"GPS & Navigatie"]}),p.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[p.jsx("li",{children:"Live GPS tracking met nauwkeurigheidscirkel"}),p.jsx("li",{children:"Richtingspijl draait mee met je telefoon"}),p.jsx("li",{children:"Kaart handmatig draaien + kompasknop naar noorden"}),p.jsx("li",{children:"Schaalbalk onderaan (aan/uit in Instellingen)"}),p.jsx("li",{children:"Open locatie in Google Maps vanuit popup"}),p.jsx("li",{children:"Zoekbalk voor adressen en plaatsen"})]})]}),p.jsxs("section",{children:[p.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[p.jsx(Il,{size:16,className:"text-orange-600"}),"Vondsten"]}),p.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[p.jsx("li",{children:"Toevoegen via GPS locatie, long-press of handmatig"}),p.jsx("li",{children:"Velden: type, materiaal, periode, diepte, conditie, gewicht"}),p.jsx("li",{children:"Foto's toevoegen (link of upload)"}),p.jsx("li",{children:"Export: Excel, CSV, GeoJSON, GPX, KML"}),p.jsx("li",{children:"Dashboard met statistieken"}),p.jsx("li",{children:"Cloud sync met Google account"})]})]}),p.jsxs("section",{children:[p.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[p.jsx(yc,{size:16,className:"text-purple-600"}),"Presets"]}),p.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[p.jsxs("li",{children:[p.jsx("strong",{children:"Standaard:"})," Detectie, Steentijd, Romeins, Middeleeuwen, WOII, Analyse, Fossielen, Mineralen"]}),p.jsxs("li",{children:[p.jsx("strong",{children:"Aanpasbaar:"})," Overschrijf preset met huidige lagen (diskette-icoon)"]}),p.jsxs("li",{children:[p.jsx("strong",{children:"Eigen presets:"})," Maak nieuwe via Instellingen"]}),p.jsxs("li",{children:[p.jsx("strong",{children:"Tekstgrootte:"})," Aanpasbaar per panel via slider"]})]})]}),p.jsxs("section",{children:[p.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[p.jsx(g2e,{size:16,className:"text-cyan-600"}),"Perceelinformatie"]}),p.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[p.jsx("li",{children:"Kadastrale aanduiding (gemeente, sectie, nummer)"}),p.jsx("li",{children:"Oppervlakte in m en hectare"}),p.jsx("li",{children:"Gewas en bouwplan met uitleg"}),p.jsx("li",{children:"Bodemtype met beschrijving"}),p.jsx("li",{children:"AHN hoogte in meters NAP"}),p.jsx("li",{children:"Hoogtekaart per perceel (bergje-icoon)"}),p.jsx("li",{children:"Link naar eigenaar opzoeken (Kadaster)"})]})]}),p.jsxs("section",{children:[p.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[p.jsx($ut,{size:16,className:"text-red-600"}),"Monumenten & Erfgoed"]}),p.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[p.jsxs("li",{children:[p.jsx("strong",{children:"AMK:"})," Archeologische Monumenten per periode"]}),p.jsxs("li",{children:[p.jsx("strong",{children:"Romeinse Forten:"})," Uitgebreide historische info per fort"]}),p.jsxs("li",{children:[p.jsx("strong",{children:"Rijksmonumenten:"})," Met bescherming en historie"]}),p.jsxs("li",{children:[p.jsx("strong",{children:"Verdedigingswerken:"})," Linies, forten, schansen"]}),p.jsxs("li",{children:[p.jsx("strong",{children:"Popup info:"})," Directe uitleg over archeologische waarde"]})]})]})]})}function NTt(){return p.jsxs(p.Fragment,{children:[p.jsxs("section",{children:[p.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Eerste stappen"}),p.jsxs("ol",{className:"text-gray-600 space-y-2 text-xs list-decimal list-inside",children:[p.jsxs("li",{children:["Tik op de ",p.jsx("strong",{children:"GPS knop"})," (rechtsonder, oranje) om je locatie te zien"]}),p.jsxs("li",{children:["Kies een ",p.jsx("strong",{children:"preset"})," (linksonder, laagjes-icoon) voor een snelle start"]}),p.jsxs("li",{children:["Of open ",p.jsx("strong",{children:"Kaartlagen"})," om individuele lagen aan te zetten"]}),p.jsx("li",{children:"Tik op objecten op de kaart voor gedetailleerde informatie"})]})]}),p.jsxs("section",{children:[p.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Hamburger Menu"}),p.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[p.jsx("p",{children:"Rechtsboven vind je het menu met:"}),p.jsxs("ul",{className:"list-disc list-inside ml-2 space-y-1",children:[p.jsxs("li",{children:[p.jsx("strong",{children:"Google Login:"})," Synchroniseer je data naar de cloud"]}),p.jsxs("li",{children:[p.jsx("strong",{children:"Vondst toevoegen:"})," Registreer een nieuwe vondst"]}),p.jsxs("li",{children:[p.jsx("strong",{children:"Info & Handleiding:"})," Dit scherm"]}),p.jsxs("li",{children:[p.jsx("strong",{children:"Instellingen:"})," Presets, export, weergave"]})]})]})]}),p.jsxs("section",{children:[p.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"GPS & Navigatie"}),p.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[p.jsxs("p",{children:[p.jsx("strong",{children:"GPS knop (oranje):"})," Aan/uit toggle voor locatie tracking."]}),p.jsxs("p",{children:[p.jsx("strong",{children:"Richtingspijl:"})," Blauwe pijl toont de richting van je telefoon."]}),p.jsxs("p",{children:[p.jsx("strong",{children:"Kaart draaien:"})," Met twee vingers of via kompas."]}),p.jsxs("p",{children:[p.jsx("strong",{children:"Kompasknop:"})," Verschijnt rechtsboven als kaart gedraaid is. Tik om naar noorden te draaien."]}),p.jsxs("p",{children:[p.jsx("strong",{children:"Google Maps:"})," Vanuit elke popup kun je direct navigeren."]})]})]}),p.jsxs("section",{children:[p.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Locaties opslaan in Mijn Lagen"}),p.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[p.jsxs("p",{children:[p.jsx("strong",{children:"Stap 1:"})," Tik op een object op de kaart (monument, bunker, etc.)"]}),p.jsxs("p",{children:[p.jsx("strong",{children:"Stap 2:"})," Tik op de ",p.jsx("strong",{children:"oranje +"})," knop in de popup header"]}),p.jsxs("p",{children:[p.jsx("strong",{children:"Stap 3:"})," Kies een bestaande laag of maak een nieuwe aan"]}),p.jsxs("p",{children:[p.jsx("strong",{children:"Resultaat:"})," De locatie inclusief vorm (polygoon) en info wordt opgeslagen!"]}),p.jsx("p",{className:"text-gray-500 italic",children:"Tip: Maak lagen voor vakantiebestemmingen, projecten of interessante locaties."})]})]}),p.jsxs("section",{children:[p.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Vondst registreren"}),p.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[p.jsxs("p",{children:[p.jsx("strong",{children:"Via GPS:"})," Open menu  Vondst toevoegen. Je locatie wordt automatisch ingevuld."]}),p.jsxs("p",{children:[p.jsx("strong",{children:"Via long-press:"}),' Houd je vinger op de kaart  kies "Vondst toevoegen".']}),p.jsxs("p",{children:[p.jsx("strong",{children:"Handmatig:"}),' In het formulier  "Kies op kaart" voor exacte locatie.']}),p.jsxs("p",{children:[p.jsx("strong",{children:"Foto's:"})," Voeg foto-links toe of upload direct."]})]})]}),p.jsxs("section",{children:[p.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Presets gebruiken"}),p.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[p.jsxs("p",{children:[p.jsx("strong",{children:"Toepassen:"})," Linksonder  preset kiezen."]}),p.jsxs("p",{children:[p.jsx("strong",{children:"Aanpassen:"})," Zet gewenste lagen aan  tik diskette-icoon naast preset."]}),p.jsxs("p",{children:[p.jsx("strong",{children:"Nieuw maken:"}),' Instellingen  Presets  "Huidige lagen opslaan".']})]})]}),p.jsxs("section",{children:[p.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Cloud Sync instellen"}),p.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[p.jsxs("p",{children:[p.jsx("strong",{children:"Stap 1:"})," Open hamburger menu rechtsboven"]}),p.jsxs("p",{children:[p.jsx("strong",{children:"Stap 2:"}),' Tik op "Inloggen met Google"']}),p.jsxs("p",{children:[p.jsx("strong",{children:"Stap 3:"})," Kies je Google account"]}),p.jsxs("p",{children:[p.jsx("strong",{children:"Klaar!"})," Je lagen en vondsten worden automatisch gesynchroniseerd."]}),p.jsx("p",{className:"text-gray-500 italic",children:"Je data is veilig en alleen voor jou toegankelijk."})]})]}),p.jsxs("section",{children:[p.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Lagen importeren"}),p.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[p.jsxs("p",{children:[p.jsx("strong",{children:"Stap 1:"})," Ga naar Instellingen (hamburger menu)"]}),p.jsxs("p",{children:[p.jsx("strong",{children:"Stap 2:"}),' Scroll naar "Lagen importeren"']}),p.jsxs("p",{children:[p.jsx("strong",{children:"Stap 3:"})," Kies een GeoJSON, KML of GPX bestand"]}),p.jsxs("p",{children:[p.jsx("strong",{children:"Resultaat:"})," Nieuwe laag met je geimporteerde data!"]}),p.jsx("p",{className:"text-gray-500 italic",children:"Handig voor routes, waypoints of eigen datasets."})]})]}),p.jsxs("section",{children:[p.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Tips voor detectie"}),p.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs list-disc list-inside",children:[p.jsxs("li",{children:["Gebruik ",p.jsx("strong",{children:"AHN Hillshade"})," om relif te zien (grafheuvels, wallen)"]}),p.jsxs("li",{children:["Combineer ",p.jsx("strong",{children:"AMK"})," met ",p.jsx("strong",{children:"Gewaspercelen"})," voor slimme zoeklocaties"]}),p.jsxs("li",{children:["Check ",p.jsx("strong",{children:"IKAW"})," voor archeologische verwachting"]}),p.jsxs("li",{children:["Gebruik ",p.jsx("strong",{children:"historische kaarten"})," (TMK 1850) om oude structuren te vinden"]}),p.jsxs("li",{children:["Bekijk ",p.jsx("strong",{children:"Archeo Onderzoeken"})," voor eerdere vondsten in het gebied"]}),p.jsxs("li",{children:[p.jsx("strong",{children:"Bodemkaart"})," toont of grond geschikt is (popup legt uit)"]})]})]}),p.jsxs("section",{children:[p.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Tips voor fossielen"}),p.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs list-disc list-inside",children:[p.jsxs("li",{children:["Zet ",p.jsx("strong",{children:"Fossiel hotspots"})," aan voor bekende vindplaatsen"]}),p.jsxs("li",{children:["Bekijk ",p.jsx("strong",{children:"Paleokaarten"})," voor historische kustlijnen"]}),p.jsxs("li",{children:["Check ",p.jsx("strong",{children:"Geomorfologie"})," voor oude zeebodems en rivieren"]}),p.jsx("li",{children:"Popup toont welke fossielen op elke locatie gevonden zijn"})]})]}),p.jsxs("section",{children:[p.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Tips voor mineralen"}),p.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs list-disc list-inside",children:[p.jsxs("li",{children:["Zet ",p.jsx("strong",{children:"Mineralen hotspots"})," aan voor vindplaatsen"]}),p.jsxs("li",{children:["Bekijk ",p.jsx("strong",{children:"Goudrivieren"})," voor goudzoekmogelijkheden"]}),p.jsx("li",{children:"Popup toont welke mineralen op elke locatie voorkomen"}),p.jsx("li",{children:"Links naar Mindat.org voor gedetailleerde info"})]})]}),p.jsxs("section",{children:[p.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[p.jsx(Tg,{size:16,className:"text-blue-600"}),"Handige links"]}),p.jsxs("ul",{className:"text-gray-600 space-y-2 text-xs",children:[p.jsxs("li",{children:[p.jsx("a",{href:"https://legendageomorfologie.wur.nl/",target:"_blank",rel:"noopener",className:"text-blue-600 hover:underline font-medium",children:"Geomorfologie legenda (WUR)"}),p.jsx("br",{}),p.jsx("span",{className:"text-gray-500",children:"Uitgebreide uitleg over landvormen"})]}),p.jsxs("li",{children:[p.jsx("a",{href:"https://legenda-bodemkaart.bodemdata.nl/",target:"_blank",rel:"noopener",className:"text-blue-600 hover:underline font-medium",children:"Bodemkaart legenda (BRO)"}),p.jsx("br",{}),p.jsx("span",{className:"text-gray-500",children:"Volledige bodemclassificatie"})]}),p.jsxs("li",{children:[p.jsx("a",{href:"https://www.mindat.org/",target:"_blank",rel:"noopener",className:"text-blue-600 hover:underline font-medium",children:"Mindat.org - Mineralen database"}),p.jsx("br",{}),p.jsx("span",{className:"text-gray-500",children:"Wereldwijde mineralen informatie"})]}),p.jsxs("li",{children:[p.jsx("a",{href:"https://www.cultureelerfgoed.nl/",target:"_blank",rel:"noopener",className:"text-blue-600 hover:underline font-medium",children:"Rijksdienst voor Cultureel Erfgoed"}),p.jsx("br",{}),p.jsx("span",{className:"text-gray-500",children:"Officile monumenten informatie"})]})]})]})]})}function lSe(t,e,n,r){const s=(r-e)*Math.PI/180,o=(n-t)*Math.PI/180,a=Math.sin(s/2)*Math.sin(s/2)+Math.cos(e*Math.PI/180)*Math.cos(r*Math.PI/180)*Math.sin(o/2)*Math.sin(o/2);return 6371e3*(2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)))}function dF(t){let e=0;for(let n=1;n<t.length;n++)e+=lSe(t[n-1].coordinates[0],t[n-1].coordinates[1],t[n].coordinates[0],t[n].coordinates[1]);return e}const Ua=yo()(Eh((t,e)=>({state:"idle",currentPoints:[],startTime:null,pauseStartTime:null,totalPausedTime:0,savedRoutes:[],visibleRouteIds:new Set,heatmapEnabled:!1,gridEnabled:!1,gridCenter:null,gridSize:20,gridCount:10,gridColor:"rgba(139, 92, 246, 0.6)",autoPauseEnabled:!1,autoPauseSeconds:120,startRecording:()=>{t({state:"recording",currentPoints:[],startTime:Date.now(),pauseStartTime:null,totalPausedTime:0})},pauseRecording:()=>{const{state:n}=e();n==="recording"&&t({state:"paused",pauseStartTime:Date.now()})},resumeRecording:()=>{const{state:n,pauseStartTime:r,totalPausedTime:i}=e();if(n!=="paused"||!r)return;const s=Date.now()-r;t({state:"recording",pauseStartTime:null,totalPausedTime:i+s})},stopRecording:n=>{const{state:r,currentPoints:i,startTime:s,totalPausedTime:o,pauseStartTime:a}=e();if(r==="idle"||!s||i.length<2)return t({state:"idle",currentPoints:[],startTime:null,pauseStartTime:null,totalPausedTime:0}),null;const l=Date.now();let c=o;a&&(c+=l-a);const u=l-s-c,h=dF(i),f={id:crypto.randomUUID(),name:n||`Route ${new Date().toLocaleDateString("nl-NL")} ${new Date().toLocaleTimeString("nl-NL",{hour:"2-digit",minute:"2-digit"})}`,points:i,startTime:s,endTime:l,totalDistance:h,totalDuration:u,pausedDuration:c,createdAt:new Date().toISOString()};return t(g=>{const y=new Set(g.visibleRouteIds);return y.add(f.id),{state:"idle",currentPoints:[],startTime:null,pauseStartTime:null,totalPausedTime:0,savedRoutes:[f,...g.savedRoutes],visibleRouteIds:y}}),f},cancelRecording:()=>{t({state:"idle",currentPoints:[],startTime:null,pauseStartTime:null,totalPausedTime:0})},addPoint:(n,r,i)=>{const{state:s,currentPoints:o}=e();if(s!=="recording")return;if(o.length>0){const l=o[o.length-1];if(lSe(l.coordinates[0],l.coordinates[1],n,r)<2)return}const a={coordinates:[n,r],timestamp:Date.now(),accuracy:i};t({currentPoints:[...o,a]})},deleteRoute:n=>{t(r=>({savedRoutes:r.savedRoutes.filter(i=>i.id!==n)}))},renameRoute:(n,r)=>{t(i=>({savedRoutes:i.savedRoutes.map(s=>s.id===n?{...s,name:r}:s)}))},clearAllRoutes:()=>{t({savedRoutes:[],visibleRouteIds:new Set})},toggleRouteVisibility:n=>{t(r=>{const i=new Set(r.visibleRouteIds);return i.has(n)?i.delete(n):i.add(n),{visibleRouteIds:i}})},showRoute:n=>{t(r=>{const i=new Set(r.visibleRouteIds);return i.add(n),{visibleRouteIds:i}})},hideRoute:n=>{t(r=>{const i=new Set(r.visibleRouteIds);return i.delete(n),{visibleRouteIds:i}})},showAllRoutes:()=>{t(n=>({visibleRouteIds:new Set(n.savedRoutes.map(r=>r.id))}))},hideAllRoutes:()=>{t({visibleRouteIds:new Set})},toggleHeatmap:()=>{t(n=>({heatmapEnabled:!n.heatmapEnabled}))},setHeatmapEnabled:n=>{t({heatmapEnabled:n})},toggleGrid:()=>{t(n=>({gridEnabled:!n.gridEnabled}))},setGridEnabled:n=>{t({gridEnabled:n})},setGridCenter:n=>{t({gridCenter:n})},setGridSize:n=>{t({gridSize:n})},setGridCount:n=>{t({gridCount:n})},setGridColor:n=>{t({gridColor:n})},centerGridOnCurrentLocation:()=>{"geolocation"in navigator&&navigator.geolocation.getCurrentPosition(n=>{t({gridCenter:[n.coords.longitude,n.coords.latitude],gridEnabled:!0})},n=>{console.error("Could not get location:",n)})},setAutoPauseEnabled:n=>{t({autoPauseEnabled:n})},setAutoPauseSeconds:n=>{t({autoPauseSeconds:n})},importRouteFromGPX:(n,r)=>{try{const s=new DOMParser().parseFromString(n,"application/xml");if(s.querySelector("parsererror"))return{success:!1,error:"Ongeldig XML formaat"};const a=s.querySelectorAll("trkpt");if(a.length<2&&s.querySelectorAll("wpt").length<2)return{success:!1,error:"Geen route punten gevonden in GPX bestand"};const l=[];if((a.length>0?a:s.querySelectorAll("wpt")).forEach(b=>{const T=parseFloat(b.getAttribute("lat")||"0"),A=parseFloat(b.getAttribute("lon")||"0"),I=b.querySelector("time"),P=I?new Date(I.textContent||"").getTime():Date.now();!isNaN(T)&&!isNaN(A)&&l.push({coordinates:[A,T],timestamp:isNaN(P)?Date.now():P})}),l.length<2)return{success:!1,error:"Niet genoeg geldige punten in GPX bestand"};const u=s.querySelector("trk > name")?.textContent||s.querySelector("metadata > name")?.textContent||r||`Import ${new Date().toLocaleDateString("nl-NL")}`,h=dF(l),f=l[0].timestamp,g=l[l.length-1].timestamp,y=g-f,_={id:crypto.randomUUID(),name:u,points:l,startTime:f,endTime:g,totalDistance:h,totalDuration:y>0?y:0,pausedDuration:0,createdAt:new Date().toISOString()};return t(b=>{const T=new Set(b.visibleRouteIds);return T.add(_.id),{savedRoutes:[_,...b.savedRoutes],visibleRouteIds:T}}),{success:!0,routeId:_.id}}catch(i){return console.error("GPX import error:",i),{success:!1,error:"Fout bij importeren van GPX bestand"}}},updateRouteNotes:(n,r)=>{t(i=>({savedRoutes:i.savedRoutes.map(s=>s.id===n?{...s,notes:r}:s)}))},addPhotoToRoute:(n,r)=>{const i={...r,id:crypto.randomUUID(),timestamp:new Date().toISOString()};t(s=>({savedRoutes:s.savedRoutes.map(o=>o.id===n?{...o,photos:[...o.photos||[],i]}:o)}))},removePhotoFromRoute:(n,r)=>{t(i=>({savedRoutes:i.savedRoutes.map(s=>s.id===n?{...s,photos:(s.photos||[]).filter(o=>o.id!==r)}:s)}))},getCurrentDistance:()=>{const{currentPoints:n}=e();return dF(n)},getCurrentDuration:()=>{const{state:n,startTime:r,totalPausedTime:i,pauseStartTime:s}=e();if(!r)return 0;const o=Date.now();let a=i;return n==="paused"&&s&&(a+=o-s),o-r-a},getAverageSpeed:()=>{const n=e().getCurrentDistance(),r=e().getCurrentDuration();return r===0?0:n/1e3/(r/36e5)}}),{name:"detectorapp-route-recording",version:2,partialize:t=>({savedRoutes:t.savedRoutes,visibleRouteIds:Array.from(t.visibleRouteIds),heatmapEnabled:t.heatmapEnabled,gridEnabled:t.gridEnabled,gridCenter:t.gridCenter,gridSize:t.gridSize,gridCount:t.gridCount,gridColor:t.gridColor,autoPauseEnabled:t.autoPauseEnabled,autoPauseSeconds:t.autoPauseSeconds}),merge:(t,e)=>({...e,...t,visibleRouteIds:new Set(t?.visibleRouteIds||[])})}));function cSe(t){const e=`<?xml version="1.0" encoding="UTF-8"?>
<gpx version="1.1" creator="DetectorApp NL"
  xmlns="http://www.topografix.com/GPX/1/1"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd">
  <metadata>
    <name>${t.name}</name>
    <time>${new Date(t.startTime).toISOString()}</time>
  </metadata>
  <trk>
    <name>${t.name}</name>
    <trkseg>
${t.points.map(s=>`      <trkpt lat="${s.coordinates[1]}" lon="${s.coordinates[0]}">
        <time>${new Date(s.timestamp).toISOString()}</time>
      </trkpt>`).join(`
`)}
    </trkseg>
  </trk>
</gpx>`,n=new Blob([e],{type:"application/gpx+xml"}),r=URL.createObjectURL(n),i=document.createElement("a");i.href=r,i.download=`${t.name.replace(/[^a-zA-Z0-9]/g,"-")}.gpx`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(r)}let hg=null,sk=null;function uSe(){if(typeof window>"u"||!("speechSynthesis"in window))return!1;hg=window.speechSynthesis;const t=()=>{const e=hg?.getVoices()||[];sk=e.find(n=>n.lang.startsWith("nl")||n.name.toLowerCase().includes("dutch")||n.name.toLowerCase().includes("nederland"))||null,!sk&&e.length>0&&(sk=e[0])};return t(),hg&&(hg.onvoiceschanged=t),!0}function OTt(t,e){if(!hg&&!uSe()||!hg)return;hg.cancel();const n=new SpeechSynthesisUtterance(t);sk&&(n.voice=sk),n.lang="nl-NL",n.rate=e?.rate,n.pitch=e?.pitch??1,n.volume=e?.volume??1,hg.speak(n)}function LTt(t){const e=[];e.push(`${t.type} toegevoegd`),t.material&&t.material!=="Onbekend"&&e.push(`Materiaal: ${t.material}`),t.period&&t.period!=="Onbekend"&&e.push(`Periode: ${t.period}`),t.layerName&&t.layerName!=="Vondsten"&&e.push(`Opgeslagen in ${t.layerName}`);const n=e.join(". ");OTt(n,{rate:1.1})}uSe();const DTt="detectorapp-photos",jTt=1,y5="photos",$Tt=1024,FTt=200,VTt=.8,zTt=.7;function GTt(){return new Promise((t,e)=>{const n=indexedDB.open(DTt,jTt);n.onerror=()=>e(n.error),n.onsuccess=()=>t(n.result),n.onupgradeneeded=r=>{const i=r.target.result;i.objectStoreNames.contains(y5)||i.createObjectStore(y5,{keyPath:"id"}).createIndex("createdAt","createdAt",{unique:!1})}})}async function vae(t,e,n){return new Promise((r,i)=>{const s=new Image,o=URL.createObjectURL(t);s.onload=()=>{URL.revokeObjectURL(o);let{width:a,height:l}=s;(a>e||l>e)&&(a>l?(l=Math.round(l*e/a),a=e):(a=Math.round(a*e/l),l=e));const c=document.createElement("canvas");c.width=a,c.height=l;const u=c.getContext("2d");if(!u){i(new Error("Could not get canvas context"));return}u.imageSmoothingEnabled=!0,u.imageSmoothingQuality="high",u.drawImage(s,0,0,a,l),c.toBlob(h=>{h?r({blob:h,width:a,height:l}):i(new Error("Could not create blob"))},"image/jpeg",n)},s.onerror=()=>{URL.revokeObjectURL(o),i(new Error("Could not load image"))},s.src=o})}async function UTt(t,e){const{blob:n,width:r,height:i}=await vae(e,$Tt,VTt),{blob:s}=await vae(e,FTt,zTt),o={id:t,fullImage:n,thumbnail:s,originalName:e.name,mimeType:"image/jpeg",width:r,height:i,size:n.size,createdAt:new Date().toISOString()},a=await GTt();return new Promise((l,c)=>{const u=a.transaction(y5,"readwrite"),f=u.objectStore(y5).put(o);f.onsuccess=()=>l(o),f.onerror=()=>c(f.error),u.oncomplete=()=>a.close()})}function fF({label:t,value:e,onChange:n,options:r,required:i=!1,placeholder:s="Typ hier..."}){const[o,a]=Y.useState(!1),[l,c]=Y.useState(!1),[u,h]=Y.useState(""),f=e&&!r.includes(e),g=()=>{c(!0),h(f?e:""),a(!1)},y=()=>{u.trim()&&n(u.trim()),c(!1)};return l?p.jsxs("div",{children:[p.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:[t,i&&p.jsx("span",{className:"text-orange-500 ml-0.5",children:"*"})]}),p.jsx("input",{type:"text",value:u,onChange:_=>h(_.target.value),onKeyDown:_=>{_.key==="Enter"&&(_.preventDefault(),y()),_.key==="Escape"&&c(!1)},onBlur:y,placeholder:s,autoFocus:!0,className:"w-full px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 focus:bg-white focus:ring-2 focus:ring-orange-500 transition-all",style:{border:"none",outline:"none"}})]}):p.jsxs("div",{className:"relative",children:[p.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:[t,i&&p.jsx("span",{className:"text-orange-500 ml-0.5",children:"*"})]}),p.jsxs("button",{type:"button",onClick:()=>a(!o),className:"w-full flex items-center justify-between px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 hover:bg-gray-100 transition-colors text-left",style:{border:"none",outline:"none"},children:[p.jsxs("span",{className:e?"":"text-gray-400",children:[e||"Selecteer...",f&&p.jsx(Xse,{size:12,className:"inline ml-1 text-orange-500"})]}),p.jsx(Eb,{size:16,className:`text-gray-400 transition-transform ${o?"rotate-180":""}`})]}),o&&p.jsxs("div",{className:"absolute z-50 w-full mt-1 bg-white rounded-lg shadow-lg max-h-48 overflow-y-auto",children:[p.jsxs("button",{type:"button",onClick:g,className:"w-full px-3 py-2 text-left text-sm text-orange-600 hover:bg-orange-50 transition-colors flex items-center gap-2",style:{border:"none",outline:"none"},children:[p.jsx(Xse,{size:12}),"Eigen invoer..."]}),p.jsx("div",{className:"border-t border-gray-100"}),r.map(_=>p.jsx("button",{type:"button",onClick:()=>{n(_),a(!1)},className:`w-full px-3 py-2 text-left text-sm transition-colors ${_===e?"bg-orange-50 text-orange-600":"text-gray-600 hover:bg-gray-50"}`,style:{border:"none",outline:"none"},children:_},_))]})]})}function hSe({onClose:t,initialLocation:e}){const n=ks(Ye=>Ye.position),r=gi(Ye=>Ye.map),i=Gr(Ye=>Ye.vondstFormPhoto),s=ps(Ye=>Ye.layers),o=ps(Ye=>Ye.addPoint);ps(Ye=>Ye.addPhotoToPoint);const a=Cn(Ye=>Ye.voiceFeedbackEnabled),l=Ua(Ye=>Ye.state),c=Ua(Ye=>Ye.startTime);Ua(Ye=>Ye.savedRoutes);const u=()=>l==="idle"||!c?null:`Route ${new Date(c).toLocaleDateString("nl-NL")} ${new Date(c).toLocaleTimeString("nl-NL",{hour:"2-digit",minute:"2-digit"})}`,h=l==="recording"||l==="paused",f=u(),[g,y]=Y.useState(""),[_,b]=Y.useState(""),[T,A]=Y.useState(""),[I,P]=Y.useState(""),[R,D]=Y.useState(!1),[C,M]=Y.useState(void 0),[O,j]=Y.useState(void 0),[V,U]=Y.useState(Jc),[G,de]=Y.useState(i),[Ie,ze]=Y.useState(null);Y.useEffect(()=>{if(G){const Ye=URL.createObjectURL(G);return ze(Ye),()=>URL.revokeObjectURL(Ye)}else ze(null)},[G]);const[Ne,fe]=Y.useState(e?"map-pick":n?"gps":"map-center"),[De,Ce]=Y.useState(e||null),[Q,W]=Y.useState(!1),ne=()=>{if(Ne==="gps"&&n)return{lat:n.lat,lng:n.lng};if(Ne==="map-pick"&&De)return De;if(r){const Ye=r.getView().getCenter();if(Ye){const[on,jt]=Fn(Ye);return{lat:jt,lng:on}}}return null},ie=ne();Y.useEffect(()=>{if(!Q||!r)return;const Ye=on=>{const[jt,pn]=Fn(on.coordinate);Ce({lat:pn,lng:jt}),fe("map-pick"),W(!1)};return r.on("click",Ye),()=>r.un("click",Ye)},[Q,r]);const le=()=>W(!0),ve=()=>{n&&(fe("gps"),Ce(null))},qe=()=>{const Ye=document.createElement("input");Ye.type="file",Ye.accept="image/*",Ye.capture="environment",Ye.onchange=on=>{const jt=on.target.files?.[0];jt&&de(jt)},Ye.click()},Ke=()=>de(null),Se=async Ye=>{Ye.preventDefault();const on=ne();if(!on){alert("Geen locatie beschikbaar");return}if(!_){alert("Vul een naam/type in");return}D(!0);try{let jt=g||"";if(V===Jc){const dt=[];T&&dt.push(`Materiaal: ${T}`),I&&dt.push(`Periode: ${I}`),C&&dt.push(`Gewicht: ${C}g`),O&&dt.push(`Lengte: ${O}mm`),dt.length>0&&(jt=dt.join(" | ")+(g?` | ${g}`:""))}let pn;if(G){const dt=crypto.randomUUID();try{const hr=await UTt(dt,G),zn=await we(hr.thumbnail);pn={id:dt,thumbnailBase64:zn,createdAt:hr.createdAt}}catch(hr){console.error("Failed to save photo:",hr)}}o(V,{coordinates:[on.lng,on.lat],name:_,category:V===Jc?_:"Overig",notes:jt||"",...pn?{photos:[pn]}:{},...h&&c?{routeId:`recording-${c}`,routeName:f||void 0}:{}});const _n=s.find(dt=>dt.id===V)?.name||"Vondsten";a&&LTt({type:_,material:T||void 0,period:I||void 0,layerName:_n}),alert(`Toegevoegd aan ${_n}! ${pn?" (met foto)":""}`),t()}catch(jt){alert("Fout bij opslaan: "+jt.message)}finally{D(!1)}},we=Ye=>new Promise((on,jt)=>{const pn=new FileReader;pn.onloadend=()=>on(pn.result),pn.onerror=jt,pn.readAsDataURL(Ye)}),Dt=Y.useMemo(()=>s.map(Ye=>({id:Ye.id,name:Ye.name,color:Ye.color})),[s]);return Q?p.jsx(_t.div,{className:"fixed bottom-0 left-0 right-0 z-[2000] p-4",initial:{y:100},animate:{y:0},exit:{y:100},children:p.jsxs("div",{className:"bg-orange-500 text-white rounded-xl shadow-xl p-4 flex items-center justify-between max-w-md mx-auto",children:[p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx(FN,{size:24,className:"animate-pulse"}),p.jsxs("div",{children:[p.jsx("div",{className:"font-medium",children:"Tik op de kaart"}),p.jsx("div",{className:"text-sm opacity-90",children:"om locatie te kiezen"})]})]}),p.jsx("button",{onClick:()=>W(!1),className:"px-4 py-2 bg-white/20 hover:bg-white/30 rounded-lg transition-colors border-0 outline-none",children:"Annuleren"})]})}):p.jsx(_t.div,{className:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:p.jsxs(_t.div,{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full max-h-[90vh] overflow-hidden flex flex-col",initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},children:[p.jsxs("div",{className:"bg-gradient-to-r from-orange-500 to-orange-600 text-white px-5 py-4 flex justify-between items-center flex-shrink-0",children:[p.jsx("h2",{className:"text-lg font-semibold",children:"Nieuwe Vondst"}),p.jsx("button",{onClick:t,className:"w-8 h-8 flex items-center justify-center rounded-full hover:bg-white/20 transition-colors border-0 outline-none",children:p.jsx(Qr,{size:20})})]}),p.jsxs("form",{onSubmit:Se,className:"flex-1 overflow-y-auto",children:[p.jsxs("div",{className:"p-5 space-y-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Foto"}),Ie?p.jsxs("div",{className:"relative",children:[p.jsx("img",{src:Ie,alt:"Vondst",className:"w-full h-40 object-cover rounded-xl"}),p.jsx("button",{type:"button",onClick:Ke,className:"absolute top-2 right-2 w-8 h-8 bg-red-500 text-white rounded-full flex items-center justify-center hover:bg-red-600 transition-colors border-0 outline-none shadow-lg",children:p.jsx(Sh,{size:16})})]}):p.jsxs("button",{type:"button",onClick:qe,className:"w-full h-32 bg-gray-50 rounded-xl flex flex-col items-center justify-center gap-2 hover:bg-gray-100 transition-colors text-gray-500 border-2 border-dashed border-gray-200",style:{outline:"none"},children:[p.jsx(bL,{size:32}),p.jsx("span",{className:"text-sm",children:"Maak een foto"})]})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Locatie"}),ie&&p.jsxs("div",{className:"bg-orange-50 rounded-xl px-4 py-3 mb-2",children:[p.jsxs("div",{className:"text-sm text-orange-800 font-mono",children:[ie.lat.toFixed(6),"N, ",ie.lng.toFixed(6),"E"]}),p.jsx("div",{className:"text-xs text-orange-600 mt-1",children:Ne==="gps"?" GPS locatie":Ne==="map-pick"?" Gekozen op kaart":" Kaart midden"})]}),!ie&&p.jsx("div",{className:"bg-red-50 rounded-xl px-4 py-3 mb-2",children:p.jsx("div",{className:"text-sm text-red-600",children:"Geen locatie beschikbaar"})}),p.jsxs("div",{className:"flex gap-2",children:[n&&Ne!=="gps"&&p.jsxs("button",{type:"button",onClick:ve,className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 text-sm bg-green-50 text-green-700 rounded-lg hover:bg-green-100 transition-colors border-0 outline-none",children:[p.jsx(Tb,{size:16}),"GPS"]}),p.jsxs("button",{type:"button",onClick:le,className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 text-sm bg-blue-50 text-blue-700 rounded-lg hover:bg-blue-100 transition-colors border-0 outline-none",children:[p.jsx(FN,{size:16}),"Kies op kaart"]})]})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Opslaan naar"}),p.jsx("div",{className:"flex flex-wrap gap-2",children:Dt.map(Ye=>p.jsx("button",{type:"button",onClick:()=>U(Ye.id),className:`px-3 py-2 rounded-lg text-sm font-medium transition-all border-0 outline-none ${V===Ye.id?"bg-gray-800 text-white shadow-md":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:Ye.name},Ye.id))})]}),V===Jc&&p.jsx(fF,{label:"Type vondst",value:_,onChange:b,options:["Munt","Aardewerk","Gesp","Fibula","Ring","Speld","Sieraad","Gereedschap","Wapen","Anders"],required:!0,placeholder:"Typ type vondst..."}),V!==Jc&&p.jsxs("div",{children:[p.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:["Naam",p.jsx("span",{className:"text-orange-500 ml-0.5",children:"*"})]}),p.jsx("input",{type:"text",value:_,onChange:Ye=>b(Ye.target.value),placeholder:"Naam van het punt...",className:"w-full px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 focus:bg-white focus:ring-2 focus:ring-orange-500 transition-all",style:{border:"none",outline:"none"}})]}),V===Jc&&p.jsxs(p.Fragment,{children:[p.jsx(fF,{label:"Materiaal",value:T,onChange:A,options:["Brons","IJzer","Zilver","Goud","Koper","Lood","Tin","Keramiek","Steen","Glas","Bot","Hout","Leer","Onbekend"],placeholder:"Typ materiaal..."}),p.jsx(fF,{label:"Periode",value:I,onChange:P,options:["Steentijd","Bronstijd","IJzertijd","Romeins","Middeleeuws","Nieuwetijd","Modern","Onbekend"],placeholder:"Typ periode..."}),p.jsxs("div",{className:"flex gap-3",children:[p.jsxs("div",{className:"flex-1",children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Gewicht (g)"}),p.jsx("input",{type:"number",value:C??"",onChange:Ye=>M(Ye.target.value?parseFloat(Ye.target.value):void 0),className:"w-full px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 focus:bg-white focus:ring-2 focus:ring-orange-500 transition-all",style:{border:"none",outline:"none"},min:"0",step:"0.1"})]}),p.jsxs("div",{className:"flex-1",children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Lengte (mm)"}),p.jsx("input",{type:"number",value:O??"",onChange:Ye=>j(Ye.target.value?parseFloat(Ye.target.value):void 0),className:"w-full px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 focus:bg-white focus:ring-2 focus:ring-orange-500 transition-all",style:{border:"none",outline:"none"},min:"0",step:"0.1"})]})]})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Notities"}),p.jsx("textarea",{value:g,onChange:Ye=>y(Ye.target.value),className:"w-full px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 focus:bg-white focus:ring-2 focus:ring-orange-500 transition-all resize-none h-20",style:{border:"none",outline:"none"},placeholder:"Beschrijving, context, vindplaats details..."})]}),p.jsx("div",{className:"rounded-xl px-4 py-3 bg-orange-50",children:p.jsx("p",{className:"text-sm text-orange-700",children:' Opgeslagen in "Mijn Lagen" op dit apparaat'})})]}),p.jsxs("div",{className:"p-5 pt-0 flex gap-3",children:[p.jsx("button",{type:"button",onClick:t,className:"flex-1 px-4 py-3 bg-gray-100 text-gray-700 rounded-xl hover:bg-gray-200 transition-colors font-medium border-0 outline-none",children:"Annuleren"}),p.jsx("button",{type:"submit",disabled:R||!ie||Q||!_,className:"flex-1 px-4 py-3 bg-orange-500 text-white rounded-xl hover:bg-orange-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium border-0 outline-none",children:R?"Opslaan...":"Opslaan"})]})]})]})})}function BTt(){const{user:t,setUser:e,setLoading:n}=yO();return Y.useEffect(()=>{const s=fue($y,o=>{e(o),n(!1)});return()=>s()},[e,n]),{user:t,loginAnonymous:async()=>{try{await u4e($y)}catch(s){console.error("Login failed:",s)}},logout:async()=>{try{await pue($y)}catch(s){console.error("Logout failed:",s)}},isAuthenticated:!!t}}function WTt(){const{isAuthenticated:t,loginAnonymous:e}=BTt(),n=Cn(c=>c.vondstenLocalOnly),r=Cn(c=>c.showVondstButton),i=Gr(c=>c.vondstFormOpen),s=Gr(c=>c.vondstFormLocation),o=Gr(c=>c.openVondstForm),a=Gr(c=>c.closeVondstForm);if(!r)return null;const l=()=>{if(n){o();return}if(!t){confirm("Je moet ingelogd zijn om vondsten in de cloud op te slaan. Anoniem inloggen?")&&e();return}o()};return p.jsxs(p.Fragment,{children:[p.jsx(_t.button,{className:"fixed bottom-2 right-[60px] z-[1000] w-11 h-11 bg-orange-500 hover:bg-orange-600 text-white rounded-xl shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},onClick:l,title:"Vondst toevoegen",children:p.jsx(Il,{size:22,strokeWidth:2})}),p.jsx(qn,{children:i&&p.jsx(hSe,{onClose:a,initialLocation:s||void 0})})]})}function HTt(){const t=Cn(we=>we.showRouteRecordButton),e=Cn(we=>we.showVondstButton),n=Gr(we=>we.toggleRouteDashboard),{state:r,startRecording:i,pauseRecording:s,resumeRecording:o,stopRecording:a,cancelRecording:l,addPoint:c,getCurrentDistance:u,getCurrentDuration:h,getAverageSpeed:f,currentPoints:g,savedRoutes:y,autoPauseEnabled:_,autoPauseSeconds:b}=Ua(),[T,A]=Y.useState(!1),[I,P]=Y.useState(""),[R,D]=Y.useState(!1),[C,M]=Y.useState(!1),O=Y.useRef(null),j=Y.useRef(null),V=Y.useRef(null),U=we=>{const Dt=Math.floor(we/1e3),Ye=Math.floor(Dt/3600),on=Math.floor(Dt%3600/60),jt=Dt%60;return Ye>0?`${Ye}:${on.toString().padStart(2,"0")}:${jt.toString().padStart(2,"0")}`:`${on}:${jt.toString().padStart(2,"0")}`},G=we=>we<1e3?`${Math.round(we)} m`:`${(we/1e3).toFixed(2)} km`,de=we=>`${we.toFixed(1)} km/h`,Ie=(we,Dt,Ye,on)=>{const pn=(on-Dt)*Math.PI/180,_n=(Ye-we)*Math.PI/180,dt=Math.sin(pn/2)*Math.sin(pn/2)+Math.cos(Dt*Math.PI/180)*Math.cos(on*Math.PI/180)*Math.sin(_n/2)*Math.sin(_n/2);return 6371e3*(2*Math.atan2(Math.sqrt(dt),Math.sqrt(1-dt)))};if(Y.useEffect(()=>(r==="recording"?(M(!1),"geolocation"in navigator&&O.current===null&&(O.current=navigator.geolocation.watchPosition(we=>{const Dt=we.coords.longitude,Ye=we.coords.latitude,on=Date.now();c(Dt,Ye,we.coords.accuracy),_&&j.current?Ie(j.current.lon,j.current.lat,Dt,Ye)>3?(j.current={lon:Dt,lat:Ye,time:on},V.current&&(clearTimeout(V.current),V.current=null)):on-j.current.time>=b*1e3&&(s(),M(!0),j.current=null):j.current={lon:Dt,lat:Ye,time:on}},we=>{console.error("GPS error:",we)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:1e3}))):(O.current!==null&&(navigator.geolocation.clearWatch(O.current),O.current=null),V.current&&(clearTimeout(V.current),V.current=null)),()=>{O.current!==null&&(navigator.geolocation.clearWatch(O.current),O.current=null),V.current&&(clearTimeout(V.current),V.current=null)}),[r,c,_,b,s]),!t)return null;const ze=e?"right-[114px]":"right-[60px]",Ne=e?"right-[168px]":"right-[114px]",fe=()=>{i(),D(!0)},De=()=>{s()},Ce=()=>{o()},Q=()=>{P(`Route ${new Date().toLocaleDateString("nl-NL")}`),A(!0)},W=()=>{const we=a(I);A(!1),D(!1),P(""),we&&confirm(`Route "${we.name}" opgeslagen! (${G(we.totalDistance)})

Direct exporteren als GPX?`)&&cSe(we)},ne=()=>{g.length>2&&!confirm("Weet je zeker dat je de opname wilt annuleren? De route wordt niet opgeslagen.")||(l(),A(!1),D(!1))},ie=u(),le=h(),ve=f(),qe=we=>{switch(we){case"recording":return"bg-red-500 hover:bg-red-600";case"paused":return"bg-yellow-500 hover:bg-yellow-600";default:return"bg-green-500 hover:bg-green-600"}},Ke=we=>{switch(we){case"recording":return p.jsx(y2e,{size:22,strokeWidth:2});case"paused":return p.jsx(_2e,{size:22,strokeWidth:2});default:return p.jsx(GN,{size:22,strokeWidth:2})}},Se=()=>{switch(r){case"idle":fe();break;case"recording":De();break;case"paused":Ce();break}};return p.jsxs(p.Fragment,{children:[p.jsxs(_t.button,{className:`fixed bottom-2 ${ze} z-[1000] w-11 h-11 ${qe(r)} text-white rounded-xl shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none backdrop-blur-sm`,whileHover:{scale:1.05},whileTap:{scale:.95},onClick:Se,title:r==="idle"?"Route opnemen":r==="recording"?"Pauzeren":"Hervatten",children:[Ke(r),r==="recording"&&p.jsx(_t.div,{className:"absolute inset-0 rounded-xl bg-red-400",animate:{opacity:[.5,0,.5]},transition:{duration:1.5,repeat:1/0}})]}),p.jsx(qn,{children:r==="idle"&&y.length>0&&p.jsxs(_t.button,{className:`fixed bottom-2 ${Ne} z-[1000] w-11 h-11 bg-green-400 hover:bg-green-500 text-white rounded-xl shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none`,initial:{opacity:0,scale:.8,x:20},animate:{opacity:1,scale:1,x:0},exit:{opacity:0,scale:.8,x:20},whileHover:{scale:1.05},whileTap:{scale:.95},onClick:n,title:`Mijn routes (${y.length})`,children:[p.jsx(p2e,{size:18,strokeWidth:2}),p.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-white text-green-600 text-xs font-bold rounded-full flex items-center justify-center shadow-sm",children:y.length})]})}),p.jsx(qn,{children:(r==="recording"||r==="paused")&&p.jsx(_t.button,{className:`fixed bottom-2 ${Ne} z-[1000] w-11 h-11 bg-gray-700 hover:bg-gray-800 text-white rounded-xl shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none`,initial:{opacity:0,scale:.8,x:20},animate:{opacity:1,scale:1,x:0},exit:{opacity:0,scale:.8,x:20},whileHover:{scale:1.05},whileTap:{scale:.95},onClick:Q,title:"Stoppen en opslaan",children:p.jsx(b2e,{size:18,strokeWidth:2,fill:"currentColor"})})}),p.jsx(qn,{children:R&&r!=="idle"&&p.jsxs(_t.div,{className:"fixed bottom-16 right-2 z-[999] bg-white/95 backdrop-blur-sm rounded-xl shadow-lg p-3 min-w-[180px]",initial:{opacity:0,y:20,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.9},children:[p.jsxs("div",{className:"flex items-center justify-between mb-2",children:[p.jsx("span",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:r==="recording"?" Opname":C?" Auto-pauze":" Gepauzeerd"}),p.jsx("button",{onClick:()=>D(!1),className:"p-0.5 text-gray-400 hover:text-gray-600 border-0 outline-none bg-transparent",children:p.jsx(Qr,{size:14})})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(X1,{size:16,className:"text-green-500"}),p.jsx("span",{className:"text-lg font-semibold text-gray-800",children:G(ie)})]}),p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx($N,{size:16,className:"text-blue-500"}),p.jsx(qTt,{duration:le,recordingState:r,formatTime:U})]}),p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(zct,{size:16,className:"text-green-500"}),p.jsx("span",{className:"text-sm text-gray-600",children:de(ve)})]}),p.jsxs("div",{className:"text-xs text-gray-400 pt-1 border-t border-gray-100",children:[g.length," punten opgenomen"]})]})]})}),p.jsx(qn,{children:T&&p.jsxs(p.Fragment,{children:[p.jsx(_t.div,{className:"fixed inset-0 z-[1500] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>A(!1)}),p.jsxs(_t.div,{className:"fixed left-4 right-4 top-1/2 z-[1501] bg-white rounded-xl shadow-2xl p-4 max-w-sm mx-auto",initial:{opacity:0,scale:.9,y:"-40%"},animate:{opacity:1,scale:1,y:"-50%"},exit:{opacity:0,scale:.9,y:"-40%"},children:[p.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Route opslaan"}),p.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 mb-4 space-y-1",children:[p.jsxs("div",{className:"flex justify-between text-sm",children:[p.jsx("span",{className:"text-gray-500",children:"Afstand:"}),p.jsx("span",{className:"font-medium",children:G(ie)})]}),p.jsxs("div",{className:"flex justify-between text-sm",children:[p.jsx("span",{className:"text-gray-500",children:"Duur:"}),p.jsx("span",{className:"font-medium",children:U(le)})]}),p.jsxs("div",{className:"flex justify-between text-sm",children:[p.jsx("span",{className:"text-gray-500",children:"Gem. snelheid:"}),p.jsx("span",{className:"font-medium",children:de(ve)})]}),p.jsxs("div",{className:"flex justify-between text-sm",children:[p.jsx("span",{className:"text-gray-500",children:"Punten:"}),p.jsx("span",{className:"font-medium",children:g.length})]})]}),p.jsxs("div",{className:"mb-4",children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Naam van de route"}),p.jsx("input",{type:"text",value:I,onChange:we=>P(we.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Route naam...",autoFocus:!0})]}),p.jsxs("div",{className:"flex gap-2",children:[p.jsx("button",{onClick:ne,className:"flex-1 px-4 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none",children:"Annuleren"}),p.jsxs("button",{onClick:W,disabled:g.length<2,className:"flex-1 px-4 py-2 bg-green-500 hover:bg-green-600 disabled:bg-gray-300 text-white rounded-lg transition-colors border-0 outline-none flex items-center justify-center gap-2",children:[p.jsx(XH,{size:16}),"Opslaan"]})]}),g.length<2&&p.jsx("p",{className:"text-xs text-red-500 text-center mt-2",children:"Minimaal 2 punten nodig om op te slaan"})]})]})})]})}function qTt({duration:t,recordingState:e,formatTime:n}){const[r,i]=Y.useState(t);return Y.useEffect(()=>{if(e!=="recording"){i(t);return}const s=setInterval(()=>{i(o=>o+1e3)},1e3);return()=>clearInterval(s)},[e,t]),Y.useEffect(()=>{i(t)},[t]),p.jsx("span",{className:"text-lg font-semibold text-gray-800",children:n(r)})}function KTt(){const t=gi(s=>s.map),{currentPoints:e,state:n}=Ua(),r=Y.useRef(null),i=Y.useRef(null);return Y.useEffect(()=>{if(!t)return;const s=new Ml;i.current=s;const o=new Nl({source:s,zIndex:999,properties:{name:"route-recording-layer"}});return r.current=o,t.addLayer(o),()=>{r.current&&t&&t.removeLayer(r.current)}},[t]),Y.useEffect(()=>{if(!i.current||(i.current.clear(),n==="idle"||e.length===0))return;const s=e.map(o=>Ni(o.coordinates));if(s.length>=2){const o=new gr({geometry:new ts(s)});o.setStyle(new vn({stroke:new Pn({color:n==="paused"?"rgba(234, 179, 8, 0.8)":"rgba(168, 85, 247, 0.8)",width:4,lineCap:"round",lineJoin:"round"})})),i.current.addFeature(o)}if(s.length>=1){const o=new gr({geometry:new Ti(s[0])});o.setStyle(new vn({image:new ms({radius:8,fill:new Dn({color:"rgba(34, 197, 94, 1)"}),stroke:new Pn({color:"white",width:2})})})),i.current.addFeature(o)}if(s.length>=1){const o=new gr({geometry:new Ti(s[s.length-1])});o.setStyle(new vn({image:new ms({radius:6,fill:new Dn({color:n==="paused"?"rgba(234, 179, 8, 1)":"rgba(168, 85, 247, 1)"}),stroke:new Pn({color:"white",width:2})})})),i.current.addFeature(o)}},[e,n]),null}const _ae=["#a855f7","#3b82f6","#22c55e","#f97316","#ec4899","#14b8a6","#eab308","#8b5cf6"];function YTt(){const t=gi(s=>s.map),{savedRoutes:e,visibleRouteIds:n}=Ua(),r=Y.useRef(null),i=Y.useRef(null);return Y.useEffect(()=>{if(!t)return;const s=new Ml;i.current=s;const o=new Nl({source:s,zIndex:998,properties:{name:"saved-routes-layer"}});return r.current=o,t.addLayer(o),()=>{r.current&&t&&t.removeLayer(r.current)}},[t]),Y.useEffect(()=>{if(!i.current)return;i.current.clear(),e.filter(o=>n.has(o.id)).forEach((o,a)=>{const l=_ae[a%_ae.length],c=o.points.map(_=>Ni(_.coordinates));if(c.length<2)return;const u=new gr({geometry:new ts(c),routeId:o.id,routeName:o.name});u.setStyle(new vn({stroke:new Pn({color:l,width:4,lineCap:"round",lineJoin:"round"})})),i.current.addFeature(u);const h=new gr({geometry:new Ti(c[0]),routeId:o.id,type:"start"});h.setStyle(new vn({image:new ms({radius:8,fill:new Dn({color:"#22c55e"}),stroke:new Pn({color:"white",width:2})}),text:new fc({text:"S",font:"bold 10px sans-serif",fill:new Dn({color:"white"}),offsetY:1})})),i.current.addFeature(h);const f=new gr({geometry:new Ti(c[c.length-1]),routeId:o.id,type:"end"});f.setStyle(new vn({image:new ms({radius:8,fill:new Dn({color:"#ef4444"}),stroke:new Pn({color:"white",width:2})}),text:new fc({text:"E",font:"bold 10px sans-serif",fill:new Dn({color:"white"}),offsetY:1})})),i.current.addFeature(f);const g=Math.floor(c.length/2),y=new gr({geometry:new Ti(c[g]),routeId:o.id,type:"label"});y.setStyle(new vn({text:new fc({text:o.name,font:"12px sans-serif",fill:new Dn({color:"#1f2937"}),stroke:new Pn({color:"white",width:3}),offsetY:-15})})),i.current.addFeature(y)})},[e,n]),null}function XTt(){const t=gi(o=>o.map),{savedRoutes:e,visibleRouteIds:n,heatmapEnabled:r}=Ua(),i=Y.useRef(null),s=Y.useRef(null);return Y.useEffect(()=>{if(!t)return;const o=new Ml;s.current=o;const a=new aCe({source:o,blur:15,radius:10,weight:()=>1,gradient:["#00f","#0ff","#0f0","#ff0","#f00"],opacity:.6,zIndex:90});return i.current=a,t.addLayer(a),()=>{t&&i.current&&t.removeLayer(i.current)}},[t]),Y.useEffect(()=>{if(!s.current||!i.current)return;if(s.current.clear(),!r){i.current.setVisible(!1);return}const o=e.filter(l=>n.has(l.id)),a=[];for(const l of o)for(const c of l.points){const u=new gr({geometry:new Ti(Ni(c.coordinates))});a.push(u)}s.current.addFeatures(a),i.current.setVisible(a.length>0)},[e,n,r]),null}function ZTt(t,e,n,r){const i=[],s=e/111e3,o=e/(111e3*Math.cos(t[1]*Math.PI/180)),a=Math.floor(n/2),l=t[0]-a*o,c=t[0]+a*o,u=t[1]-a*s,h=t[1]+a*s;for(let _=-a;_<=a;_++){const b=t[0]+_*o,T=[Ni([b,u]),Ni([b,h])],A=new gr({geometry:new ts(T),type:"grid-line"});A.setStyle(new vn({stroke:new Pn({color:r,width:_===0?2:1,lineDash:_===0?void 0:[5,5]})})),i.push(A)}for(let _=-a;_<=a;_++){const b=t[1]+_*s,T=[Ni([l,b]),Ni([c,b])],A=new gr({geometry:new ts(T),type:"grid-line"});A.setStyle(new vn({stroke:new Pn({color:r,width:_===0?2:1,lineDash:_===0?void 0:[5,5]})})),i.push(A)}const f="ABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let _=-a;_<a;_++)for(let b=-a;b<a;b++){const T=t[0]+(b+.5)*o,A=t[1]+(_+.5)*s,I=_+a,P=b+a;if(I>=0&&I<f.length){const R=`${f[I]}${P+1}`,D=new gr({geometry:new ts([Ni([T,A]),Ni([T,A])]),type:"grid-label"});D.setStyle(new vn({text:new fc({text:R,font:"12px sans-serif",fill:new Dn({color:r}),stroke:new Pn({color:"rgba(255,255,255,0.8)",width:3})})})),i.push(D)}}const g=new gr({geometry:new ts([Ni([t[0]-o*.2,t[1]]),Ni([t[0]+o*.2,t[1]])]),type:"grid-center"});g.setStyle(new vn({stroke:new Pn({color:"#ef4444",width:3})})),i.push(g);const y=new gr({geometry:new ts([Ni([t[0],t[1]-s*.2]),Ni([t[0],t[1]+s*.2])]),type:"grid-center"});return y.setStyle(new vn({stroke:new Pn({color:"#ef4444",width:3})})),i.push(y),i}function JTt(){const t=gi(l=>l.map),{gridEnabled:e,gridCenter:n,gridSize:r,gridCount:i,gridColor:s}=Ua(),o=Y.useRef(null),a=Y.useRef(null);return Y.useEffect(()=>{if(!t)return;const l=new Ml;a.current=l;const c=new Nl({source:l,zIndex:85,properties:{name:"grid-overlay-layer"}});return o.current=c,t.addLayer(c),()=>{o.current&&t&&t.removeLayer(o.current)}},[t]),Y.useEffect(()=>{if(!a.current||!o.current)return;if(a.current.clear(),!e||!n){o.current.setVisible(!1);return}const l=ZTt(n,r,i,s);a.current.addFeatures(l),o.current.setVisible(!0)},[e,n,r,i,s]),null}function QTt(t){const e=[];let n=0;return t.points.forEach((r,i)=>{if(i>0){const a=t.points[i-1],l=6371e3,c=(r.coordinates[1]-a.coordinates[1])*Math.PI/180,u=(r.coordinates[0]-a.coordinates[0])*Math.PI/180,h=Math.sin(c/2)*Math.sin(c/2)+Math.cos(a.coordinates[1]*Math.PI/180)*Math.cos(r.coordinates[1]*Math.PI/180)*Math.sin(u/2)*Math.sin(u/2),f=2*Math.atan2(Math.sqrt(h),Math.sqrt(1-h));n+=l*f}const s=5,o=Math.sin(n/50)*2+Math.sin(n/120)*1.5+Math.sin(n/30+r.coordinates[0]*1e3)*.5;e.push({distance:n,elevation:Math.max(0,s+o)})}),e}function ekt({route:t,onClose:e}){const n=Y.useRef(null),[r,i]=Y.useState([]),[s,o]=Y.useState({min:0,max:0,gain:0,loss:0});Y.useEffect(()=>{const l=QTt(t);if(i(l),l.length>0){const c=l.map(y=>y.elevation),u=Math.min(...c),h=Math.max(...c);let f=0,g=0;for(let y=1;y<l.length;y++){const _=l[y].elevation-l[y-1].elevation;_>0?f+=_:g+=Math.abs(_)}o({min:u,max:h,gain:f,loss:g})}},[t]),Y.useEffect(()=>{const l=n.current;if(!l||r.length<2)return;const c=l.getContext("2d");if(!c)return;const u=l.width,h=l.height,f={top:20,right:20,bottom:30,left:40};c.fillStyle="#f9fafb",c.fillRect(0,0,u,h);const g=Math.max(...r.map(R=>R.distance)),y=Math.min(...r.map(R=>R.elevation))-1,_=Math.max(...r.map(R=>R.elevation))+1,b=R=>f.left+R/g*(u-f.left-f.right),T=R=>h-f.bottom-(R-y)/(_-y)*(h-f.top-f.bottom);c.strokeStyle="#e5e7eb",c.lineWidth=1;const A=5;for(let R=0;R<=A;R++){const D=y+(_-y)*(R/A),C=T(D);c.beginPath(),c.moveTo(f.left,C),c.lineTo(u-f.right,C),c.stroke(),c.fillStyle="#9ca3af",c.font="10px sans-serif",c.textAlign="right",c.fillText(`${D.toFixed(1)}m`,f.left-5,C+3)}const I=5;for(let R=0;R<=I;R++){const D=g/I*R,C=b(D);c.fillStyle="#9ca3af",c.font="10px sans-serif",c.textAlign="center",c.fillText(D<1e3?`${Math.round(D)}m`:`${(D/1e3).toFixed(1)}km`,C,h-10)}c.beginPath(),c.moveTo(b(r[0].distance),h-f.bottom),r.forEach(R=>{c.lineTo(b(R.distance),T(R.elevation))}),c.lineTo(b(r[r.length-1].distance),h-f.bottom),c.closePath();const P=c.createLinearGradient(0,f.top,0,h-f.bottom);P.addColorStop(0,"rgba(139, 92, 246, 0.3)"),P.addColorStop(1,"rgba(139, 92, 246, 0.05)"),c.fillStyle=P,c.fill(),c.strokeStyle="#8b5cf6",c.lineWidth=2,c.lineJoin="round",c.lineCap="round",c.beginPath(),r.forEach((R,D)=>{const C=b(R.distance),M=T(R.elevation);D===0?c.moveTo(C,M):c.lineTo(C,M)}),c.stroke()},[r]);const a=l=>l<1e3?`${Math.round(l)} m`:`${(l/1e3).toFixed(2)} km`;return p.jsxs(_t.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},className:"fixed inset-4 z-[1700] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[70vh]",children:[p.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-purple-500 text-white",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(V2,{size:20}),p.jsx("span",{className:"font-medium",children:"Hoogteprofiel"})]}),p.jsx("button",{onClick:e,className:"p-1 rounded bg-purple-400/50 hover:bg-purple-400 transition-colors border-0 outline-none",children:p.jsx(Qr,{size:18})})]}),p.jsxs("div",{className:"px-4 py-2 bg-purple-50 border-b border-purple-100",children:[p.jsx("h3",{className:"font-medium text-gray-800 truncate",children:t.name}),p.jsx("p",{className:"text-xs text-gray-500",children:a(t.totalDistance)})]}),p.jsxs("div",{className:"grid grid-cols-4 gap-2 p-3 border-b border-gray-100",children:[p.jsxs("div",{className:"text-center",children:[p.jsx("div",{className:"flex items-center justify-center text-blue-500 mb-1",children:p.jsx(YH,{size:14})}),p.jsx("div",{className:"text-xs text-gray-500",children:"Min"}),p.jsxs("div",{className:"text-sm font-medium",children:[s.min.toFixed(1),"m"]})]}),p.jsxs("div",{className:"text-center",children:[p.jsx("div",{className:"flex items-center justify-center text-purple-500 mb-1",children:p.jsx(V2,{size:14})}),p.jsx("div",{className:"text-xs text-gray-500",children:"Max"}),p.jsxs("div",{className:"text-sm font-medium",children:[s.max.toFixed(1),"m"]})]}),p.jsxs("div",{className:"text-center",children:[p.jsx("div",{className:"flex items-center justify-center text-green-500 mb-1",children:p.jsx(sht,{size:14})}),p.jsx("div",{className:"text-xs text-gray-500",children:"Stijging"}),p.jsxs("div",{className:"text-sm font-medium",children:[s.gain.toFixed(1),"m"]})]}),p.jsxs("div",{className:"text-center",children:[p.jsx("div",{className:"flex items-center justify-center text-red-500 mb-1",children:p.jsx(rht,{size:14})}),p.jsx("div",{className:"text-xs text-gray-500",children:"Daling"}),p.jsxs("div",{className:"text-sm font-medium",children:[s.loss.toFixed(1),"m"]})]})]}),p.jsx("div",{className:"flex-1 p-3",children:p.jsx("canvas",{ref:n,width:350,height:200,className:"w-full h-full"})}),p.jsx("div",{className:"px-4 py-2 bg-yellow-50 border-t border-yellow-100",children:p.jsxs("p",{className:"text-xs text-yellow-700",children:[p.jsx("strong",{children:"Let op:"})," Dit zijn gesimuleerde hoogtewaarden. Koppeling met AHN-data komt binnenkort."]})})]})}const tkt=t=>t<1e3?`${Math.round(t)} m`:`${(t/1e3).toFixed(2)} km`,nkt=t=>{const e=Math.floor(t/1e3),n=Math.floor(e/3600),r=Math.floor(e%3600/60);return n>0?`${n}u ${r}m`:`${r} min`},xae=t=>new Date(t).toLocaleDateString("nl-NL",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"});function rkt({route:t,onClose:e}){const{updateRouteNotes:n,addPhotoToRoute:r,removePhotoFromRoute:i}=Ua(),[s,o]=Y.useState(t.notes||""),[a,l]=Y.useState("info"),c=Y.useRef(null),u=()=>{n(t.id,s)},h=async y=>{const _=y.target.files?.[0];if(!_)return;const b=URL.createObjectURL(_);r(t.id,{url:b,caption:_.name}),c.current&&(c.current.value="")},f=y=>{confirm("Foto verwijderen?")&&i(t.id,y)},g=Ua(y=>y.savedRoutes.find(_=>_.id===t.id))||t;return p.jsxs(_t.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[1700] flex items-center justify-center p-4",children:[p.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:e}),p.jsxs(_t.div,{initial:{scale:.95,y:20},animate:{scale:1,y:0},exit:{scale:.95,y:20},className:"relative bg-white rounded-xl shadow-2xl overflow-hidden w-full max-w-md max-h-[85vh] flex flex-col",children:[p.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-purple-500 text-white",children:[p.jsxs("div",{className:"flex-1 min-w-0",children:[p.jsx("h3",{className:"font-medium truncate",children:g.name}),p.jsx("p",{className:"text-xs text-purple-200",children:xae(g.createdAt)})]}),p.jsx("button",{onClick:e,className:"p-1 rounded bg-purple-400/50 hover:bg-purple-400 transition-colors border-0 outline-none ml-2",children:p.jsx(Qr,{size:18})})]}),p.jsxs("div",{className:"flex border-b border-gray-200",children:[p.jsxs("button",{onClick:()=>l("info"),className:`flex-1 py-2 text-sm font-medium border-0 outline-none transition-colors ${a==="info"?"text-purple-600 border-b-2 border-purple-500":"text-gray-500 hover:text-gray-700"}`,children:[p.jsx(Il,{size:16,className:"inline mr-1"}),"Info"]}),p.jsxs("button",{onClick:()=>l("photos"),className:`flex-1 py-2 text-sm font-medium border-0 outline-none transition-colors ${a==="photos"?"text-purple-600 border-b-2 border-purple-500":"text-gray-500 hover:text-gray-700"}`,children:[p.jsx(bL,{size:16,className:"inline mr-1"}),"Foto's (",g.photos?.length||0,")"]}),p.jsxs("button",{onClick:()=>l("notes"),className:`flex-1 py-2 text-sm font-medium border-0 outline-none transition-colors ${a==="notes"?"text-purple-600 border-b-2 border-purple-500":"text-gray-500 hover:text-gray-700"}`,children:[p.jsx(HH,{size:16,className:"inline mr-1"}),"Notities"]})]}),p.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[a==="info"&&p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[p.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[p.jsxs("div",{className:"flex items-center gap-2 text-purple-600 mb-1",children:[p.jsx(X1,{size:16}),p.jsx("span",{className:"text-xs text-gray-500",children:"Afstand"})]}),p.jsx("p",{className:"text-lg font-semibold",children:tkt(g.totalDistance)})]}),p.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[p.jsxs("div",{className:"flex items-center gap-2 text-blue-600 mb-1",children:[p.jsx($N,{size:16}),p.jsx("span",{className:"text-xs text-gray-500",children:"Duur"})]}),p.jsx("p",{className:"text-lg font-semibold",children:nkt(g.totalDuration)})]})]}),p.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[p.jsxs("div",{className:"flex items-center gap-2 text-green-600 mb-1",children:[p.jsx(Il,{size:16}),p.jsx("span",{className:"text-xs text-gray-500",children:"Punten"})]}),p.jsxs("p",{className:"text-lg font-semibold",children:[g.points.length," GPS punten"]})]}),p.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[p.jsxs("div",{className:"flex items-center gap-2 text-orange-600 mb-1",children:[p.jsx(BH,{size:16}),p.jsx("span",{className:"text-xs text-gray-500",children:"Aangemaakt"})]}),p.jsx("p",{className:"text-sm",children:xae(g.createdAt)})]})]}),a==="photos"&&p.jsxs("div",{className:"space-y-4",children:[p.jsx("input",{ref:c,type:"file",accept:"image/*",onChange:h,className:"hidden"}),p.jsxs("button",{onClick:()=>c.current?.click(),className:"w-full py-8 border-2 border-dashed border-purple-300 rounded-lg text-purple-500 hover:bg-purple-50 transition-colors flex flex-col items-center gap-2",children:[p.jsx(_u,{size:24}),p.jsx("span",{className:"text-sm",children:"Foto toevoegen"})]}),g.photos&&g.photos.length>0?p.jsx("div",{className:"grid grid-cols-2 gap-2",children:g.photos.map(y=>p.jsxs("div",{className:"relative aspect-square rounded-lg overflow-hidden bg-gray-100",children:[p.jsx("img",{src:y.url,alt:y.caption||"Route foto",className:"w-full h-full object-cover"}),p.jsx("button",{onClick:()=>f(y.id),className:"absolute top-1 right-1 p-1 bg-red-500 text-white rounded-full hover:bg-red-600 transition-colors border-0 outline-none",children:p.jsx(Sh,{size:12})}),y.caption&&p.jsx("div",{className:"absolute bottom-0 left-0 right-0 px-2 py-1 bg-black/50 text-white text-xs truncate",children:y.caption})]},y.id))}):p.jsx("p",{className:"text-center text-gray-400 text-sm py-4",children:"Nog geen foto's toegevoegd"})]}),a==="notes"&&p.jsxs("div",{className:"space-y-4",children:[p.jsx("textarea",{value:s,onChange:y=>o(y.target.value),placeholder:"Voeg notities toe over deze route...",className:"w-full h-48 p-3 border border-gray-300 rounded-lg outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent resize-none"}),p.jsx("button",{onClick:u,className:"w-full px-4 py-2 bg-purple-500 hover:bg-purple-600 text-white rounded-lg transition-colors border-0 outline-none",children:"Notities opslaan"})]})]})]})]})}function ikt({route:t,size:e=80}){const n=Y.useRef(null);return Y.useEffect(()=>{const r=n.current;if(!r||t.points.length<2)return;const i=r.getContext("2d");if(!i)return;i.fillStyle="#f3f4f6",i.fillRect(0,0,e,e);const s=t.points.map(P=>P.coordinates[0]),o=t.points.map(P=>P.coordinates[1]),a=Math.min(...s),l=Math.max(...s),c=Math.min(...o),u=Math.max(...o),h=8,f=e-h*2,g=e-h*2,y=P=>l===a?e/2:h+(P-a)/(l-a)*f,_=P=>u===c?e/2:h+g-(P-c)/(u-c)*g;i.strokeStyle="#a855f7",i.lineWidth=2,i.lineCap="round",i.lineJoin="round",i.beginPath(),t.points.forEach((P,R)=>{const D=y(P.coordinates[0]),C=_(P.coordinates[1]);R===0?i.moveTo(D,C):i.lineTo(D,C)}),i.stroke();const b=y(t.points[0].coordinates[0]),T=_(t.points[0].coordinates[1]);i.fillStyle="#22c55e",i.beginPath(),i.arc(b,T,4,0,Math.PI*2),i.fill();const A=y(t.points[t.points.length-1].coordinates[0]),I=_(t.points[t.points.length-1].coordinates[1]);i.fillStyle="#ef4444",i.beginPath(),i.arc(A,I,4,0,Math.PI*2),i.fill()},[t,e]),t.points.length<2?p.jsx("div",{className:"bg-gray-100 rounded flex items-center justify-center text-gray-400",style:{width:e,height:e},children:p.jsx(Il,{size:20})}):p.jsx("canvas",{ref:n,width:e,height:e,className:"rounded"})}const pF=t=>t<1e3?`${Math.round(t)} m`:`${(t/1e3).toFixed(2)} km`,mF=t=>{const e=Math.floor(t/1e3),n=Math.floor(e/3600),r=Math.floor(e%3600/60);return n>0?`${n}u ${r}m`:`${r} min`},wae=t=>new Date(t).toLocaleDateString("nl-NL",{day:"numeric",month:"short",year:"numeric"});function skt({isOpen:t,onClose:e,onViewRoute:n}){const{savedRoutes:r,deleteRoute:i,renameRoute:s,clearAllRoutes:o,visibleRouteIds:a,toggleRouteVisibility:l,showAllRoutes:c,hideAllRoutes:u,heatmapEnabled:h,toggleHeatmap:f,gridEnabled:g,toggleGrid:y,centerGridOnCurrentLocation:_,gridSize:b,setGridSize:T,autoPauseEnabled:A,setAutoPauseEnabled:I,autoPauseSeconds:P,setAutoPauseSeconds:R,importRouteFromGPX:D}=Ua(),[C,M]=Y.useState(null),[O,j]=Y.useState(""),[V,U]=Y.useState(!1),[G,de]=Y.useState(!1),[Ie,ze]=Y.useState(null),[Ne,fe]=Y.useState(null),De=Y.useRef(null),Ce=async Se=>{const we=` ${Se.name}

 Afstand: ${pF(Se.totalDistance)}
 Duur: ${mF(Se.totalDuration)}
 ${Se.points.length} GPS punten
 ${wae(Se.createdAt)}

Opgenomen met DetectorApp NL`;if(navigator.share)try{await navigator.share({title:Se.name,text:we});return}catch(Dt){Dt.name!=="AbortError"&&console.error("Share failed:",Dt)}try{await navigator.clipboard.writeText(we),alert("Route info gekopieerd naar klembord!")}catch{prompt("Kopieer de route info:",we)}},Q=async Se=>{const we=Se.target.files?.[0];if(we){try{const Dt=await we.text(),Ye=D(Dt,we.name.replace(".gpx",""));Ye.success?alert(`Route gemporteerd: ${we.name}`):alert(`Import mislukt: ${Ye.error}`)}catch{alert("Fout bij lezen van bestand")}De.current&&(De.current.value="")}},W=Se=>{M(Se.id),j(Se.name)},ne=Se=>{O.trim()&&s(Se,O.trim()),M(null),j("")},ie=Se=>{confirm(`Weet je zeker dat je "${Se.name}" wilt verwijderen?`)&&i(Se.id)},le=()=>{r.length!==0&&confirm(`Weet je zeker dat je alle ${r.length} routes wilt verwijderen? Dit kan niet ongedaan worden gemaakt.`)&&o()},ve=Se=>{l(Se);const we=r.find(Dt=>Dt.id===Se);we&&n&&n(we)},qe=r.reduce((Se,we)=>Se+we.totalDistance,0),Ke=r.reduce((Se,we)=>Se+we.totalDuration,0);return p.jsxs(p.Fragment,{children:[p.jsx(qn,{children:t&&p.jsxs(p.Fragment,{children:[p.jsx(_t.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),p.jsxs(_t.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-md mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[p.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-purple-500 text-white",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(GN,{size:20}),p.jsx("span",{className:"font-medium",children:"Mijn Routes"}),p.jsxs("span",{className:"text-purple-200 text-sm",children:["(",r.length,")"]})]}),p.jsx("button",{onClick:e,className:"p-1 rounded bg-purple-400/50 hover:bg-purple-400 transition-colors border-0 outline-none",children:p.jsx(Qr,{size:18})})]}),r.length>0&&p.jsxs("div",{className:"px-4 py-2 bg-purple-50 border-b border-purple-100 flex items-center justify-between text-sm",children:[p.jsxs("div",{className:"flex gap-4",children:[p.jsxs("div",{className:"flex items-center gap-1.5 text-purple-700",children:[p.jsx(X1,{size:14}),p.jsxs("span",{children:["Totaal: ",pF(qe)]})]}),p.jsxs("div",{className:"flex items-center gap-1.5 text-purple-700",children:[p.jsx($N,{size:14}),p.jsx("span",{children:mF(Ke)})]})]}),p.jsxs("div",{className:"flex gap-1",children:[p.jsx("button",{onClick:()=>de(!G),className:`px-2 py-1 text-xs rounded transition-colors border-0 outline-none ${A?"bg-green-100 text-green-600":"text-purple-600 hover:bg-purple-100"}`,title:A?"Auto-pauze uit":"Auto-pauze aan",children:p.jsx(Jut,{size:14})}),p.jsx("button",{onClick:()=>U(!V),className:`px-2 py-1 text-xs rounded transition-colors border-0 outline-none ${g?"bg-blue-100 text-blue-600":"text-purple-600 hover:bg-purple-100"}`,title:g?"Grid verbergen":"Grid tonen",children:p.jsx(h2e,{size:14})}),p.jsx("button",{onClick:f,className:`px-2 py-1 text-xs rounded transition-colors border-0 outline-none ${h?"bg-orange-100 text-orange-600":"text-purple-600 hover:bg-purple-100"}`,title:h?"Heatmap verbergen":"Heatmap tonen",children:p.jsx(Rct,{size:14})}),p.jsx("button",{onClick:c,className:"px-2 py-1 text-xs text-purple-600 hover:bg-purple-100 rounded transition-colors border-0 outline-none",title:"Alle tonen",children:p.jsx(zN,{size:14})}),p.jsx("button",{onClick:u,className:"px-2 py-1 text-xs text-purple-600 hover:bg-purple-100 rounded transition-colors border-0 outline-none",title:"Alle verbergen",children:p.jsx(VN,{size:14})})]})]}),p.jsx(qn,{children:V&&p.jsx(_t.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden border-b border-purple-100",children:p.jsxs("div",{className:"px-4 py-3 bg-blue-50 space-y-3",children:[p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsx("span",{className:"text-sm font-medium text-blue-800",children:"Grid Assistent"}),p.jsx("button",{onClick:y,className:`px-3 py-1 text-xs rounded-full transition-colors border-0 outline-none ${g?"bg-blue-500 text-white":"bg-blue-200 text-blue-700"}`,children:g?"Aan":"Uit"})]}),p.jsx("div",{className:"flex items-center gap-2",children:p.jsxs("button",{onClick:_,className:"flex-1 px-3 py-2 bg-blue-500 hover:bg-blue-600 text-white text-sm rounded-lg transition-colors border-0 outline-none flex items-center justify-center gap-2",children:[p.jsx(FN,{size:14}),"Centreer op mijn locatie"]})}),p.jsxs("div",{className:"space-y-1",children:[p.jsxs("label",{className:"text-xs text-blue-700",children:["Celgrootte: ",b,"m"]}),p.jsx("input",{type:"range",min:"5",max:"50",step:"5",value:b,onChange:Se=>T(Number(Se.target.value)),className:"w-full h-2 bg-blue-200 rounded-lg appearance-none cursor-pointer"}),p.jsxs("div",{className:"flex justify-between text-xs text-blue-600",children:[p.jsx("span",{children:"5m"}),p.jsx("span",{children:"50m"})]})]}),p.jsx("p",{className:"text-xs text-blue-600",children:"Gebruik het grid om systematisch een veld af te zoeken. Elk vak heeft een label (A1, B2, etc.) voor referentie."})]})})}),p.jsx(qn,{children:G&&p.jsx(_t.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden border-b border-purple-100",children:p.jsxs("div",{className:"px-4 py-3 bg-green-50 space-y-3",children:[p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsx("span",{className:"text-sm font-medium text-green-800",children:"Auto-pauze"}),p.jsx("button",{onClick:()=>I(!A),className:`px-3 py-1 text-xs rounded-full transition-colors border-0 outline-none ${A?"bg-green-500 text-white":"bg-green-200 text-green-700"}`,children:A?"Aan":"Uit"})]}),p.jsxs("div",{className:"space-y-1",children:[p.jsxs("label",{className:"text-xs text-green-700",children:["Pauze na: ",P<60?`${P}s`:`${Math.floor(P/60)}m ${P%60}s`]}),p.jsx("input",{type:"range",min:"30",max:"300",step:"30",value:P,onChange:Se=>R(Number(Se.target.value)),className:"w-full h-2 bg-green-200 rounded-lg appearance-none cursor-pointer"}),p.jsxs("div",{className:"flex justify-between text-xs text-green-600",children:[p.jsx("span",{children:"30s"}),p.jsx("span",{children:"5min"})]})]}),p.jsxs("p",{className:"text-xs text-green-600",children:["De opname pauzeert automatisch als je langer dan ",P<60?`${P} seconden`:`${Math.floor(P/60)} minuten`," stilstaat. Ideaal voor pauzes tijdens het detecteren."]})]})})}),p.jsx("div",{className:"flex-1 overflow-y-auto p-3 space-y-2",children:r.length===0?p.jsxs("div",{className:"text-center py-12 text-gray-500",children:[p.jsx(GN,{size:48,className:"mx-auto mb-3 text-gray-300"}),p.jsx("p",{className:"font-medium",children:"Nog geen routes"}),p.jsx("p",{className:"text-sm mt-1",children:"Start een opname om je eerste route vast te leggen"})]}):r.map(Se=>p.jsxs(_t.div,{layout:!0,className:"bg-gray-50 rounded-lg p-3 flex gap-3",children:[p.jsx(ikt,{route:Se,size:70}),p.jsxs("div",{className:"flex-1 min-w-0",children:[C===Se.id?p.jsx("input",{type:"text",value:O,onChange:we=>j(we.target.value),onKeyDown:we=>{we.key==="Enter"&&ne(Se.id),we.key==="Escape"&&M(null)},onBlur:()=>ne(Se.id),className:"w-full px-2 py-1 text-sm bg-white border border-purple-300 rounded outline-none focus:ring-2 focus:ring-purple-400",autoFocus:!0}):p.jsx("h3",{className:"font-medium text-gray-800 truncate",children:Se.name}),p.jsx("div",{className:"flex items-center gap-3 mt-1 text-xs text-gray-500",children:p.jsxs("span",{className:"flex items-center gap-1",children:[p.jsx(BH,{size:12}),wae(Se.createdAt)]})}),p.jsxs("div",{className:"flex items-center gap-3 mt-1 text-xs text-gray-600",children:[p.jsxs("span",{className:"flex items-center gap-1",children:[p.jsx(X1,{size:12}),pF(Se.totalDistance)]}),p.jsxs("span",{className:"flex items-center gap-1",children:[p.jsx($N,{size:12}),mF(Se.totalDuration)]}),p.jsxs("span",{children:[Se.points.length," punten"]})]})]}),p.jsxs("div",{className:"flex flex-col gap-1",children:[p.jsx("button",{onClick:()=>ve(Se.id),className:`p-1.5 rounded transition-colors border-0 outline-none ${a.has(Se.id)?"bg-purple-100 text-purple-600":"text-gray-400 hover:text-purple-600 hover:bg-purple-50"}`,title:a.has(Se.id)?"Verbergen op kaart":"Tonen op kaart",children:a.has(Se.id)?p.jsx(zN,{size:16}):p.jsx(VN,{size:16})}),p.jsx("button",{onClick:()=>W(Se),className:"p-1.5 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none",title:"Naam wijzigen",children:p.jsx(Kg,{size:16})}),p.jsx("button",{onClick:()=>fe(Se),className:"p-1.5 text-gray-400 hover:text-cyan-600 hover:bg-cyan-50 rounded transition-colors border-0 outline-none",title:"Details & foto's",children:p.jsx(qH,{size:16})}),p.jsx("button",{onClick:()=>ze(Se),className:"p-1.5 text-gray-400 hover:text-orange-600 hover:bg-orange-50 rounded transition-colors border-0 outline-none",title:"Hoogteprofiel",children:p.jsx(V2,{size:16})}),p.jsx("button",{onClick:()=>Ce(Se),className:"p-1.5 text-gray-400 hover:text-pink-600 hover:bg-pink-50 rounded transition-colors border-0 outline-none",title:"Delen",children:p.jsx(Dut,{size:16})}),p.jsx("button",{onClick:()=>cSe(Se),className:"p-1.5 text-gray-400 hover:text-green-600 hover:bg-green-50 rounded transition-colors border-0 outline-none",title:"Exporteer als GPX",children:p.jsx(vA,{size:16})}),p.jsx("button",{onClick:()=>ie(Se),className:"p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors border-0 outline-none",title:"Verwijderen",children:p.jsx(Sh,{size:16})})]})]},Se.id))}),p.jsxs("div",{className:"px-4 py-3 border-t border-gray-100 space-y-2",children:[p.jsx("input",{ref:De,type:"file",accept:".gpx",onChange:Q,className:"hidden"}),p.jsxs("button",{onClick:()=>De.current?.click(),className:"w-full px-3 py-2 text-purple-600 hover:bg-purple-50 rounded-lg transition-colors border-0 outline-none text-sm flex items-center justify-center gap-2",children:[p.jsx(WI,{size:16}),"GPX bestand importeren"]}),r.length>0&&p.jsx("button",{onClick:le,className:"w-full px-3 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none text-sm",children:"Alle routes verwijderen"})]})]})]})}),p.jsx(qn,{children:Ie&&p.jsx(ekt,{route:Ie,onClose:()=>ze(null)})}),p.jsx(qn,{children:Ne&&p.jsx(rkt,{route:Ne,onClose:()=>fe(null)})})]})}const gF={lat:52.1326,lon:5.2913};function dSe({code:t,size:e=18}){return t===0?p.jsx(Hut,{size:e,className:"text-yellow-500"}):t>=1&&t<=3?p.jsx(xp,{size:e,className:"text-gray-400"}):t===45||t===48?p.jsx(cct,{size:e,className:"text-gray-400"}):t>=51&&t<=67||t>=80&&t<=82?p.jsx(WH,{size:e,className:"text-blue-500"}):t>=71&&t<=77||t>=85&&t<=86?p.jsx(gct,{size:e,className:"text-cyan-500"}):t>=95?p.jsx(hct,{size:e,className:"text-purple-500"}):p.jsx(xp,{size:e,className:"text-gray-400"})}function okt({degrees:t,size:e=14}){return p.jsx("div",{style:{transform:`rotate(${t+180}deg)`},className:"inline-flex",children:p.jsx(Tb,{size:e,className:"text-blue-500"})})}function akt({data:t}){if(!t||t.length===0)return null;const e=Math.max(...t.map(r=>r.precipitation),.5),n=t.some(r=>r.precipitation>0);return p.jsxs("div",{className:"space-y-1",children:[p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsx("span",{style:{fontSize:"0.83em"},className:"text-gray-500",children:"Neerslag 2 uur"}),!n&&p.jsx("span",{style:{fontSize:"0.83em"},className:"text-green-600 font-medium",children:"Droog"})]}),p.jsxs("div",{className:"relative h-8 bg-gray-100 rounded-lg overflow-hidden",children:[p.jsx("div",{className:"absolute inset-0 flex items-end px-0.5",children:t.map((r,i)=>{const s=r.precipitation/e*100,o=r.precipitation>2?"bg-blue-600":r.precipitation>.5?"bg-blue-500":r.precipitation>0?"bg-blue-400":"bg-transparent";return p.jsx("div",{className:"flex-1 mx-px",children:p.jsx("div",{className:`w-full rounded-t transition-all ${o}`,style:{height:`${Math.max(s,r.precipitation>0?8:0)}%`}})},i)})}),p.jsxs("div",{className:"absolute bottom-0 left-0 right-0 flex justify-between px-1 text-gray-400",style:{fontSize:"0.67em"},children:[p.jsx("span",{children:"Nu"}),p.jsx("span",{children:"+1u"}),p.jsx("span",{children:"+2u"})]})]})]})}function lkt({pollen:t}){const e=[{name:"Gras",value:t.grass},{name:"Berk",value:t.birch},{name:"Els",value:t.alder},{name:"Bijvoet",value:t.mugwort}].filter(i=>i.value>0).sort((i,s)=>s.value-i.value);if(e.length===0)return p.jsxs("div",{className:"flex items-center gap-1.5 text-green-600",style:{fontSize:"0.83em"},children:[p.jsx(Yse,{size:12}),p.jsx("span",{children:"Lage pollenconcentratie"})]});const n=e[0],r=n.value>=4?"text-red-500":n.value>=3?"text-orange-500":n.value>=2?"text-amber-500":"text-green-600";return p.jsxs("div",{className:`flex items-center gap-1.5 ${r}`,style:{fontSize:"0.83em"},children:[p.jsx(Yse,{size:12}),p.jsxs("span",{children:[n.name,": ",n.value>=4?"Zeer hoog":n.value>=3?"Hoog":n.value>=2?"Matig":"Laag"]})]})}function ckt({hourly:t}){const e=t.slice(0,6);return e.length===0?null:p.jsxs("div",{className:"space-y-1",children:[p.jsx("div",{className:"text-gray-500",style:{fontSize:"0.83em"},children:"Komende uren"}),p.jsx("div",{className:"flex gap-1",children:e.map((n,r)=>{const i=new Date(n.time),s=r===0;return p.jsxs("div",{className:`flex flex-col items-center p-1.5 rounded-lg flex-1 ${s?"bg-blue-100":"bg-gray-50"}`,children:[p.jsx("span",{className:"text-gray-500",style:{fontSize:"0.75em"},children:s?"Nu":`${i.getHours()}u`}),p.jsx(dSe,{code:n.weatherCode,size:14}),p.jsxs("span",{className:"font-medium",style:{fontSize:"0.83em"},children:[Math.round(n.temperature),""]})]},n.time)})})]})}function ukt(){const t=Cn(_=>_.showWeatherButton),e=Cn(_=>_.showFontSliders),n=Cn(_=>_.weatherFontScale),r=Cn(_=>_.setWeatherFontScale),i=ks(),s=hT(),[o,a]=Y.useState(!1),l=12*n/100,c=hT(_=>_.showBuienradar),u=hT(_=>_.setShowBuienradar);if(Y.useEffect(()=>{c&&a(!1)},[c]),Y.useEffect(()=>{if(!t)return;const _=i.position||gF;(!s.weatherData||Date.now()-s.weatherData.lastUpdated>600*1e3)&&s.fetchWeather(_.lat,_.lon)},[t,i.position?.lat]),Y.useEffect(()=>{if(!t)return;const _=setInterval(()=>{const b=i.position||gF;s.fetchWeather(b.lat,b.lon)},600*1e3);return()=>clearInterval(_)},[t,i.position?.lat]),!t)return null;const h=s.weatherData?.current,f=s.weatherData?.hourly||[],g=s.weatherData?.precipitation15min||[],y=s.weatherData?.pollen;return p.jsxs(p.Fragment,{children:[o&&p.jsx("div",{className:"fixed inset-0 z-[1099]",onClick:()=>a(!1)}),p.jsx(_t.div,{className:"fixed left-2 z-[1100] bg-white shadow-lg border border-gray-200 select-none rounded-xl",style:{top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))",width:o?"200px":"auto",maxWidth:"200px"},initial:{opacity:0,x:-20},animate:{opacity:1,x:0},layout:!0,children:s.isLoading&&!h?p.jsxs("div",{className:"p-3 flex items-center gap-2",style:{fontSize:`${l}px`},children:[p.jsx(but,{size:16,className:"animate-spin text-blue-500"}),p.jsx("span",{className:"text-gray-500",style:{fontSize:"1.17em"},children:"Laden..."})]}):h?p.jsxs("div",{className:"p-2.5",style:{fontSize:`${l}px`},children:[p.jsxs("button",{onClick:()=>a(!o),className:"w-full border-0 outline-none bg-transparent p-0",children:[p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(dSe,{code:h.weatherCode,size:24}),p.jsx("div",{className:"flex flex-col leading-tight",children:p.jsxs("span",{className:"font-bold text-gray-800",style:{fontSize:"1.5em"},children:[Math.round(h.temperature),""]})})]}),p.jsxs("div",{className:"flex items-center gap-1",children:[p.jsx(Zse,{size:14,className:"text-gray-400"}),p.jsx("span",{className:"text-gray-600",style:{fontSize:"1.17em"},children:Math.round(h.windSpeed)}),p.jsx(okt,{degrees:h.windDirection,size:12})]}),p.jsx("div",{className:"ml-auto",children:o?p.jsx(EL,{size:16,className:"text-gray-400"}):p.jsx(Eb,{size:16,className:"text-gray-400"})})]}),p.jsxs("div",{className:"text-gray-500 text-left mt-1",style:{fontSize:"0.92em"},children:[ZDe[h.weatherCode]||"Onbekend",p.jsxs("span",{className:"text-gray-400 ml-1",children:[" ",Math.round(h.apparentTemperature),""]})]})]}),p.jsx(qn,{children:o&&p.jsx(_t.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:p.jsxs("div",{className:"pt-2 mt-2 border-t border-gray-200/50 space-y-3",children:[p.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[p.jsxs("div",{className:"bg-blue-50 rounded-lg p-2",children:[p.jsxs("div",{className:"flex items-center gap-1 text-gray-500",style:{fontSize:"0.83em"},children:[p.jsx(Sct,{size:12,className:"text-blue-500"}),p.jsx("span",{children:"Vocht"})]}),p.jsxs("div",{className:"font-bold text-blue-600",style:{fontSize:"1.17em"},children:[h.humidity,"%"]})]}),p.jsxs("div",{className:"bg-gray-50 rounded-lg p-2",children:[p.jsxs("div",{className:"flex items-center gap-1 text-gray-500",style:{fontSize:"0.83em"},children:[p.jsx(Zse,{size:12,className:"text-gray-500"}),p.jsx("span",{children:"Windstoten"})]}),p.jsxs("div",{className:"font-bold text-gray-600",style:{fontSize:"1.17em"},children:[Math.round(h.windGusts)," km/u"]})]}),p.jsxs("div",{className:"bg-cyan-50 rounded-lg p-2",children:[p.jsxs("div",{className:"flex items-center gap-1 text-gray-500",style:{fontSize:"0.83em"},children:[p.jsx(Tb,{size:12,className:"text-cyan-500"}),p.jsx("span",{children:"Wind"})]}),p.jsx("div",{className:"font-bold text-cyan-600",style:{fontSize:"1.17em"},children:JDe(h.windDirection)})]}),p.jsxs("div",{className:"bg-purple-50 rounded-lg p-2",children:[p.jsxs("div",{className:"flex items-center gap-1 text-gray-500",style:{fontSize:"0.83em"},children:[p.jsx(xp,{size:12,className:"text-purple-500"}),p.jsx("span",{children:"Bewolking"})]}),p.jsxs("div",{className:"font-bold text-purple-600",style:{fontSize:"1.17em"},children:[h.cloudCover,"%"]})]})]}),p.jsxs("button",{onClick:()=>u(!c),className:`w-full flex items-center gap-2 p-2 rounded-lg transition-colors border-0 cursor-pointer ${c?"bg-blue-500 hover:bg-blue-600":"bg-blue-50 hover:bg-blue-100"}`,children:[p.jsx(WH,{size:16,className:c?"text-white":"text-blue-500"}),p.jsx("span",{className:`font-medium ${c?"text-white":"text-blue-700"}`,style:{fontSize:"1.17em"},children:"Buienradar"}),p.jsx("span",{className:`ml-auto ${c?"text-blue-100":"text-blue-500"}`,style:{fontSize:"1em"},children:c?"Aan":"Uit"})]}),g.length>0&&p.jsx(akt,{data:g}),f.length>0&&p.jsx(ckt,{hourly:f}),y&&p.jsx(lkt,{pollen:y}),p.jsxs("div",{className:"text-gray-400 text-center pt-1",style:{fontSize:"0.75em"},children:["Bijgewerkt: ",new Date(s.weatherData.lastUpdated).toLocaleTimeString("nl-NL",{hour:"2-digit",minute:"2-digit"})]}),e&&p.jsxs("div",{className:"flex items-center gap-2 pt-2 border-t border-gray-200/50",children:[p.jsx(ZH,{size:12,className:"text-gray-400"}),p.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:n,onChange:_=>r(parseInt(_.target.value)),className:"flex-1 h-1 bg-gray-200 rounded-lg appearance-none cursor-pointer"}),p.jsxs("span",{className:"text-gray-400 w-8",style:{fontSize:"0.83em"},children:[n,"%"]})]})]})})})]}):p.jsxs("button",{onClick:()=>{const _=i.position||gF;s.fetchWeather(_.lat,_.lon)},className:"p-3 flex items-center gap-2 border-0 outline-none bg-transparent",style:{fontSize:`${l}px`},children:[p.jsx(xp,{size:18,className:"text-gray-400"}),p.jsx("span",{className:"text-gray-500",style:{fontSize:"1.17em"},children:"Weer laden"})]})})]})}function hkt({isVisible:t,onClose:e}){const n=gi(R=>R.map),r=Y.useRef(null),i=Y.useRef(null),[s,o]=Y.useState([]),[a,l]=Y.useState(0),[c,u]=Y.useState(!0),[h,f]=Y.useState(!0),[g,y]=Y.useState("normal"),[_,b]=Y.useState(70),T=g==="slow"?800:g==="normal"?500:250,A=Y.useCallback(async()=>{f(!0);try{const D=await(await fetch("https://api.rainviewer.com/public/weather-maps.json")).json(),C=[];D.radar?.past&&D.radar.past.forEach(O=>{C.push({path:O.path,time:O.time*1e3})}),D.radar?.nowcast&&D.radar.nowcast.forEach(O=>{C.push({path:O.path,time:O.time*1e3})}),o(C);const M=D.radar?.past?.length?D.radar.past.length-1:0;l(M)}catch(R){console.error("Failed to fetch radar data:",R)}finally{f(!1)}},[]);Y.useEffect(()=>{if(t){A();const R=setInterval(A,300*1e3);return()=>clearInterval(R)}},[t,A]),Y.useEffect(()=>{if(!n||!t||s.length===0)return;const R=s[a];if(!R)return;const D=`https://tilecache.rainviewer.com${R.path}/256/{z}/{x}/{y}/2/1_1.png`;if(r.current){const C=r.current.getSource();C&&(C.setUrl(D),C.refresh())}else{const C=new wy({url:D,crossOrigin:"anonymous"}),M=new Nm({source:C,opacity:_/100,zIndex:1500,properties:{name:"rain-radar-layer",title:"Buienradar"}});r.current=M,n.addLayer(M)}return()=>{}},[n,t,s,a]),Y.useEffect(()=>{r.current&&r.current.setOpacity(_/100)},[_]),Y.useEffect(()=>{!t&&r.current&&n&&(n.removeLayer(r.current),r.current=null)},[t,n]),Y.useEffect(()=>()=>{r.current&&n&&(n.removeLayer(r.current),r.current=null),i.current&&clearInterval(i.current)},[n]),Y.useEffect(()=>{if(!c||s.length===0||!t){i.current&&(clearInterval(i.current),i.current=null);return}return i.current=setInterval(()=>{l(R=>(R+1)%s.length)},T),()=>{i.current&&(clearInterval(i.current),i.current=null)}},[c,s.length,T,t]);const I=Y.useCallback(()=>{if(s.length===0||!s[a])return"--:--";const R=s[a].time,D=Date.now(),C=Math.round((R-D)/6e4),O=new Date(R).toLocaleTimeString("nl-NL",{hour:"2-digit",minute:"2-digit"});return Math.abs(C)<3?`${O} (nu)`:C<0?`${O} (${C}m)`:`${O} (+${C}m)`},[s,a]),P=R=>{u(!1),l(D=>R==="prev"?D>0?D-1:s.length-1:(D+1)%s.length)};return t?p.jsx(qn,{children:p.jsxs(_t.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},className:"fixed bottom-4 left-2 right-2 z-[1600] bg-white/95 backdrop-blur-sm rounded-xl shadow-xl border border-gray-200",style:{maxWidth:"400px",margin:"0 auto"},children:[p.jsxs("div",{className:"flex items-center justify-between px-3 py-1.5 border-b border-gray-100",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(WH,{size:14,className:"text-blue-500"}),p.jsx("span",{className:"text-xs font-medium text-gray-700",children:h?"Laden...":I()})]}),p.jsx("button",{onClick:e,className:"p-1 hover:bg-gray-100 rounded transition-colors border-0 outline-none bg-transparent",children:p.jsx(Qr,{size:14,className:"text-gray-500"})})]}),p.jsxs("div",{className:"px-3 py-2 flex items-center gap-2",children:[p.jsxs("div",{className:"flex items-center gap-0.5",children:[p.jsx("button",{onClick:()=>P("prev"),className:"p-1.5 hover:bg-gray-100 rounded transition-colors border-0 outline-none bg-transparent",children:p.jsx(a2e,{size:14,className:"text-gray-600"})}),p.jsx("button",{onClick:()=>u(!c),className:`p-1.5 rounded transition-colors border-0 outline-none ${c?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-600"}`,children:c?p.jsx(y2e,{size:14}):p.jsx(_2e,{size:14})}),p.jsx("button",{onClick:()=>P("next"),className:"p-1.5 hover:bg-gray-100 rounded transition-colors border-0 outline-none bg-transparent",children:p.jsx(Sb,{size:14,className:"text-gray-600"})})]}),p.jsxs("div",{className:"flex-1 flex items-center gap-1",children:[p.jsx("span",{className:"text-[9px] text-gray-400 w-6",children:"-2u"}),p.jsx("input",{type:"range",min:"0",max:Math.max(0,s.length-1),value:a,onChange:R=>{u(!1),l(parseInt(R.target.value))},className:"flex-1 h-1.5 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500"}),p.jsx("span",{className:"text-[9px] text-gray-400 w-8 text-right",children:"+30m"})]}),p.jsx("div",{className:"flex items-center gap-0.5 bg-gray-100 rounded p-0.5",children:["slow","normal","fast"].map(R=>p.jsxs("button",{onClick:()=>y(R),className:`px-1.5 py-0.5 text-[9px] rounded transition-colors border-0 outline-none ${g===R?"bg-white text-blue-600 shadow-sm":"text-gray-500 bg-transparent"}`,children:[R==="slow"?"":R==="normal"?"1":"2",""]},R))})]}),p.jsxs("div",{className:"px-3 py-1.5 flex items-center gap-2 border-t border-gray-100",children:[p.jsx("span",{className:"text-[10px] text-gray-500 w-14",children:"Dekking"}),p.jsx("input",{type:"range",min:"10",max:"100",value:_,onChange:R=>b(parseInt(R.target.value)),className:"flex-1 h-1.5 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500"}),p.jsxs("span",{className:"text-[10px] text-gray-500 w-8 text-right",children:[_,"%"]})]}),p.jsxs("div",{className:"px-3 pb-1.5 flex items-center justify-center gap-1.5",children:[p.jsx("span",{className:"text-[8px] text-gray-400",children:"Licht"}),p.jsxs("div",{className:"flex h-1.5 rounded overflow-hidden",children:[p.jsx("div",{className:"w-3",style:{backgroundColor:"#88D0F3"}}),p.jsx("div",{className:"w-3",style:{backgroundColor:"#32B8A4"}}),p.jsx("div",{className:"w-3",style:{backgroundColor:"#F4E61F"}}),p.jsx("div",{className:"w-3",style:{backgroundColor:"#F09D1C"}}),p.jsx("div",{className:"w-3",style:{backgroundColor:"#E12E18"}})]}),p.jsx("span",{className:"text-[8px] text-gray-400",children:"Zwaar"})]})]})}):null}const bae={Munt:"#f59e0b",Aardewerk:"#a16207",Gesp:"#6b7280",Fibula:"#8b5cf6",Ring:"#ec4899",Speld:"#6366f1",Sieraad:"#f43f5e",Gereedschap:"#64748b",Wapen:"#ef4444",Anders:"#3b82f6"},dkt={Munt:"M",Aardewerk:"A",Gesp:"G",Fibula:"F",Ring:"R",Speld:"S",Sieraad:"Si",Gereedschap:"Gr",Wapen:"W",Anders:"?"};function fkt(){const t=gi(i=>i.map),e=mh(i=>i.vondsten),n=Cn(i=>i.showLocalVondsten),r=Y.useRef(null);return Y.useEffect(()=>{if(!t)return;const i=new Ml;return e.forEach(s=>{const o=new gr({geometry:new Ti(Ni([s.location.lng,s.location.lat])),vondst:s}),a=bae[s.objectType]||bae.Anders,l=dkt[s.objectType]||"?";o.setStyle((c,u)=>{let y=12;u>50?y=6:u>10?y=Math.max(6,12-(u-10)/10):u<2&&(y=14);const _=Math.max(8,Math.min(12,y-2));return new vn({image:new ms({radius:y,fill:new Dn({color:a}),stroke:new Pn({color:"#ffffff",width:y>8?2:1})}),text:y>=8?new fc({text:l,font:`bold ${_}px sans-serif`,fill:new Dn({color:"#ffffff"}),offsetY:1}):void 0})}),i.addFeature(o)}),r.current?r.current.setSource(i):(r.current=new Nl({source:i,zIndex:1e3,properties:{title:"Mijn Vondsten"}}),r.current.setVisible(n),t.addLayer(r.current)),()=>{r.current&&t&&(t.removeLayer(r.current),r.current=null)}},[t,e]),Y.useEffect(()=>{r.current&&r.current.setVisible(n)},[n]),null}const pkt={Mineraal:"M",Fossiel:"F",Erfgoed:"E",Monument:"Mo",Overig:""};function mkt(t){const{type:e,coordinates:n}=t,r=s=>typeof s[0]=="number"?Ni(s):s.map(r),i=r(n);switch(e){case"Point":return new Ti(i);case"LineString":return new ts(i);case"Polygon":return new kl(i);case"MultiPoint":return new n0(i);case"MultiLineString":return new yh(i);case"MultiPolygon":return new hp(i);default:return new Ti(Ni(n))}}function gkt(){const t=gi(i=>i.map),e=ps(i=>i.layers),n=Cn(i=>i.showCustomPointLayers),r=Y.useRef(new Map);return Y.useEffect(()=>{if(!t)return;const i=new Set(e.map(s=>s.id));return r.current.forEach((s,o)=>{i.has(o)||(t.removeLayer(s),r.current.delete(o))}),e.forEach(s=>{const o=new Ml;s.points.forEach(l=>{let c;const u=l.geometry&&l.geometry.type!=="Point";l.geometry?c=mkt(l.geometry):c=new Ti(Ni(l.coordinates));const h=new gr({geometry:c,layerType:"customPoint",customPoint:l,customLayerId:s.id,customLayerName:s.name,customLayerColor:s.color}),f=pkt[l.category]||l.category.charAt(0).toUpperCase();if(u){const g=l.geometry.type;h.setStyle(()=>g==="Polygon"||g==="MultiPolygon"?new vn({fill:new Dn({color:s.color+"40"}),stroke:new Pn({color:s.color,width:2})}):g==="LineString"||g==="MultiLineString"?new vn({stroke:new Pn({color:s.color,width:3})}):new vn({image:new ms({radius:8,fill:new Dn({color:s.color}),stroke:new Pn({color:"#ffffff",width:2})})}))}else h.setStyle((g,y)=>{let A=12;y>50?A=6:y>10?A=Math.max(6,12-(y-10)/10):y<2&&(A=14);const I=Math.max(8,Math.min(12,A-2));return new vn({image:new ms({radius:A,fill:new Dn({color:s.color}),stroke:new Pn({color:"#ffffff",width:A>8?2:1})}),text:A>=8?new fc({text:f,font:`bold ${I}px sans-serif`,fill:new Dn({color:"#ffffff"}),offsetY:1}):void 0})});o.addFeature(h)});const a=r.current.get(s.id);if(a)a.setSource(o),a.setVisible(n&&s.visible);else{const l=new Nl({source:o,zIndex:950,properties:{title:s.name,customPointLayerId:s.id},visible:n&&s.visible});t.addLayer(l),r.current.set(s.id,l)}}),()=>{r.current.forEach(s=>{t&&t.removeLayer(s)}),r.current.clear()}},[t,e,n]),null}function ykt(){const{createLayerModalOpen:t,closeCreateLayerModal:e}=Gr(),{addLayer:n}=ps(),r=Cn(),[i,s]=Y.useState(""),[o,a]=Y.useState([...Fm]),[l,c]=Y.useState(""),u=14*r.fontScale/100,h=()=>{const b=l.trim();b&&!o.includes(b)&&(a([...o,b]),c(""))},f=b=>{a(o.filter(T=>T!==b))},g=b=>{o.includes(b)?a(o.filter(T=>T!==b)):a([...o,b])},y=()=>{i.trim()&&(n(i.trim(),o),s(""),a([...Fm]),c(""),e())},_=()=>{s(""),a([...Fm]),c(""),e()};return p.jsx(qn,{children:t&&p.jsxs(p.Fragment,{children:[p.jsx(_t.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:_}),p.jsxs(_t.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-sm mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[p.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(yc,{size:18}),p.jsx("span",{className:"font-medium",children:"Nieuwe laag"})]}),p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("span",{className:"text-[10px] opacity-70",children:"T"}),p.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:r.fontScale,onChange:b=>r.setFontScale(parseInt(b.target.value)),className:"header-slider w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${r.fontScale}%`}),p.jsx("span",{className:"text-xs opacity-70",children:"T"}),p.jsx("button",{onClick:_,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none ml-1",children:p.jsx(Qr,{size:18})})]})]}),p.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",style:{fontSize:`${u}px`},children:[p.jsxs("div",{children:[p.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Naam van de laag"}),p.jsx("input",{type:"text",value:i,onChange:b=>s(b.target.value),placeholder:"bijv. Vakantie Frankrijk 2026",className:"w-full px-3 py-2 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors",style:{fontSize:"1em"},autoFocus:!0})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block font-medium text-gray-700 mb-2",style:{fontSize:"0.9em"},children:"Categorien"}),p.jsx("div",{className:"flex flex-wrap gap-2",children:Fm.map(b=>p.jsx("button",{onClick:()=>g(b),className:`px-3 py-1 rounded-full transition-colors border-0 outline-none ${o.includes(b)?"bg-orange-500 text-white":"bg-white text-gray-600 hover:bg-blue-50"}`,style:{fontSize:"0.9em"},children:b},b))})]}),o.filter(b=>!Fm.includes(b)).length>0&&p.jsxs("div",{children:[p.jsx("label",{className:"block font-medium text-gray-700 mb-2",style:{fontSize:"0.9em"},children:"Eigen categorien"}),p.jsx("div",{className:"flex flex-wrap gap-2",children:o.filter(b=>!Fm.includes(b)).map(b=>p.jsxs("div",{className:"flex items-center",children:[p.jsx("button",{onClick:()=>g(b),className:"px-3 py-1 rounded-l-full bg-orange-500 text-white hover:bg-orange-600 transition-colors border-0 outline-none",style:{fontSize:"0.9em"},children:b}),p.jsx("button",{onClick:()=>f(b),className:"px-2 py-1 rounded-r-full bg-orange-600 text-white hover:bg-orange-700 transition-colors border-0 outline-none",title:"Verwijder categorie",children:p.jsx(Sh,{size:12})})]},b))})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Eigen categorie toevoegen"}),p.jsxs("div",{className:"flex gap-2",children:[p.jsx("input",{type:"text",value:l,onChange:b=>c(b.target.value),placeholder:"bijv. Grot, Bron, ...",className:"flex-1 px-3 py-2 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors",style:{fontSize:"1em"},onKeyDown:b=>b.key==="Enter"&&h()}),p.jsx("button",{onClick:h,disabled:!l.trim(),className:"px-3 py-2 bg-white hover:bg-blue-50 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg transition-colors border-0 outline-none text-gray-600",children:p.jsx(_u,{size:20})})]})]})]}),p.jsxs("div",{className:"p-4 flex gap-3",style:{fontSize:`${u}px`},children:[p.jsx("button",{onClick:_,className:"flex-1 px-4 py-2 bg-white hover:bg-blue-50 rounded-lg transition-colors border-0 outline-none text-gray-600",style:{fontSize:"1em"},children:"Annuleren"}),p.jsx("button",{onClick:y,disabled:!i.trim(),className:"flex-1 px-4 py-2 bg-orange-500 hover:bg-orange-600 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-lg transition-colors border-0 outline-none",style:{fontSize:"1em"},children:"Aanmaken"})]})]})]})})}const fSe=200,vkt=.7;async function _kt(t,e=fSe){return new Promise((n,r)=>{const i=new Image,s=document.createElement("canvas"),o=s.getContext("2d");i.onload=()=>{let a=i.width,l=i.height;a>l?a>e&&(l=Math.round(l*e/a),a=e):l>e&&(a=Math.round(a*e/l),l=e),s.width=a,s.height=l,o?.drawImage(i,0,0,a,l),s.toBlob(c=>{c?n(c):r(new Error("Failed to create blob from canvas"))},"image/jpeg",vkt)},i.onerror=()=>r(new Error("Failed to load image")),i.src=URL.createObjectURL(t)})}function xkt(t){return new Promise((e,n)=>{const r=new FileReader;r.onloadend=()=>{typeof r.result=="string"?e(r.result):n(new Error("Failed to convert blob to base64"))},r.onerror=()=>n(new Error("Failed to read blob")),r.readAsDataURL(t)})}async function wkt(t){const e=await _kt(t,fSe),n=await xkt(e);return{thumbnailBlob:e,thumbnailBase64:n}}function bkt(){return`photo_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}const yF=5;function Ekt({photos:t,onAddPhoto:e,onRemovePhoto:n,disabled:r}){const i=Y.useRef(null),s=Y.useRef(null),o=async l=>{const c=l.target.files;if(!c||c.length===0)return;const u=yF-t.length,h=Array.from(c).slice(0,u);for(const f of h)try{const{thumbnailBase64:g}=await wkt(f),y={id:bkt(),thumbnailBase64:g,createdAt:new Date().toISOString(),pendingUpload:!0};e(y)}catch(g){console.error("Failed to process image:",g)}l.target.value=""},a=t.length<yF;return p.jsxs("div",{className:"space-y-2",children:[p.jsxs("label",{className:"block font-medium text-gray-700",style:{fontSize:"0.9em"},children:["Foto's (",t.length,"/",yF,")"]}),p.jsxs("div",{className:"flex flex-wrap gap-2",children:[t.map(l=>p.jsxs("div",{className:"relative w-16 h-16 rounded-lg overflow-hidden bg-gray-100 border border-gray-200",children:[p.jsx("img",{src:l.thumbnailUrl||l.thumbnailBase64,alt:"Foto",className:"w-full h-full object-cover"}),!r&&p.jsx("button",{type:"button",onClick:()=>n(l.id),className:"absolute top-0.5 right-0.5 w-5 h-5 bg-red-500 rounded-full flex items-center justify-center border-0 outline-none",children:p.jsx(Qr,{size:12,className:"text-white"})}),l.pendingUpload&&p.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-orange-500/80 text-white text-center py-0.5",style:{fontSize:"0.6em"},children:"Wacht..."})]},l.id)),a&&!r&&p.jsxs(p.Fragment,{children:[p.jsxs("button",{type:"button",onClick:()=>s.current?.click(),className:"w-16 h-16 rounded-lg border-2 border-dashed border-gray-300 hover:border-orange-400 hover:bg-orange-50 flex flex-col items-center justify-center gap-1 transition-colors bg-transparent outline-none",title:"Maak foto",children:[p.jsx(bL,{size:20,className:"text-gray-400"}),p.jsx("span",{className:"text-gray-400",style:{fontSize:"0.6em"},children:"Camera"})]}),p.jsxs("button",{type:"button",onClick:()=>i.current?.click(),className:"w-16 h-16 rounded-lg border-2 border-dashed border-gray-300 hover:border-orange-400 hover:bg-orange-50 flex flex-col items-center justify-center gap-1 transition-colors bg-transparent outline-none",title:"Kies foto",children:[p.jsx(Yct,{size:20,className:"text-gray-400"}),p.jsx("span",{className:"text-gray-400",style:{fontSize:"0.6em"},children:"Gallerij"})]})]})]}),p.jsx("input",{ref:s,type:"file",accept:"image/*",capture:"environment",onChange:o,className:"hidden"}),p.jsx("input",{ref:i,type:"file",accept:"image/*",multiple:!0,onChange:o,className:"hidden"})]})}function Skt(){const{addPointModalOpen:t,addPointModalLayerId:e,addPointModalLocation:n,closeAddPointModal:r}=Gr(),{addPoint:i,getLayer:s}=ps(),o=Cn(),[a,l]=Y.useState(""),[c,u]=Y.useState(""),[h,f]=Y.useState(""),[g,y]=Y.useState([]),_=e?s(e):null,b=14*o.fontScale/100,T=()=>{!a.trim()||!e||!n||(i(e,{name:a.trim(),category:"Overig",notes:c.trim(),url:h.trim()||void 0,coordinates:[n.lng,n.lat],photos:g.length>0?g:void 0}),l(""),u(""),f(""),y([]),r())},A=()=>{l(""),u(""),f(""),y([]),r()};return _?p.jsx(qn,{children:t&&p.jsxs(p.Fragment,{children:[p.jsx(_t.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:A}),p.jsxs(_t.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-sm mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[p.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(Il,{size:18}),p.jsx("span",{className:"font-medium",children:"Punt toevoegen"})]}),p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("span",{className:"text-[10px] opacity-70",children:"T"}),p.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:o.fontScale,onChange:I=>o.setFontScale(parseInt(I.target.value)),className:"header-slider w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${o.fontScale}%`}),p.jsx("span",{className:"text-xs opacity-70",children:"T"}),p.jsx("button",{onClick:A,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none ml-1",children:p.jsx(Qr,{size:18})})]})]}),p.jsx("div",{className:"px-4 py-1.5",children:p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:_.color}}),p.jsx("span",{className:"text-sm text-gray-600",children:_.name})]})}),p.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",style:{fontSize:`${b}px`},children:[p.jsxs("div",{children:[p.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Naam *"}),p.jsx("input",{type:"text",value:a,onChange:I=>l(I.target.value),className:"w-full px-3 py-1.5 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors",style:{fontSize:"1em"},autoFocus:!0})]}),p.jsx(Ekt,{photos:g,onAddPhoto:I=>y([...g,I]),onRemovePhoto:I=>y(g.filter(P=>P.id!==I))}),p.jsxs("div",{children:[p.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Notities"}),p.jsx("textarea",{value:c,onChange:I=>u(I.target.value),placeholder:"Beschrijving, tips, opmerkingen...",rows:2,className:"w-full px-3 py-1.5 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors resize-none",style:{fontSize:"1em"}})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Link"}),p.jsx("input",{type:"url",value:h,onChange:I=>f(I.target.value),placeholder:"https://...",className:"w-full px-3 py-1.5 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors",style:{fontSize:"1em"}})]})]}),p.jsxs("div",{className:"p-3 flex gap-3",style:{fontSize:`${b}px`},children:[p.jsx("button",{onClick:A,className:"flex-1 px-4 py-1.5 bg-white hover:bg-blue-50 rounded-lg transition-colors border-0 outline-none text-gray-600",style:{fontSize:"1em"},children:"Annuleren"}),p.jsx("button",{onClick:T,disabled:!a.trim(),className:"flex-1 px-4 py-1.5 bg-orange-500 hover:bg-orange-600 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-lg transition-colors border-0 outline-none",style:{fontSize:"1em"},children:"Toevoegen"})]})]})]})}):null}function Tkt(){const{layerManagerModalOpen:t,closeLayerManagerModal:e,openCreateLayerModal:n,openLayerDashboard:r}=Gr(),{layers:i,removeLayer:s,toggleVisibility:o,toggleArchived:a,exportLayerAsGeoJSON:l,importLayerFromGeoJSON:c}=ps(),u=Cn(),h=14*u.fontScale/100,[f,g]=Y.useState(null),[y,_]=Y.useState(null),[b,T]=Y.useState(null),[A,I]=Y.useState(!1),P=i.filter(G=>!G.archived),R=i.filter(G=>G.archived),D=A?R:P,C=G=>{y===G?(s(G),_(null)):(_(G),setTimeout(()=>_(null),3e3))},M=G=>{l(G)},O=async G=>{const de=G.target.files?.[0];if(de){try{const Ie=await de.text(),ze=c(Ie);ze.success||(T(ze.error||"Import mislukt"),setTimeout(()=>T(null),3e3))}catch{T("Kon bestand niet lezen"),setTimeout(()=>T(null),3e3)}G.target.value=""}},j=()=>{g(null),_(null),T(null),I(!1),e()},V=G=>{r(G)},U=()=>{j(),n()};return p.jsx(qn,{children:t&&p.jsxs(p.Fragment,{children:[p.jsx(_t.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:j}),p.jsxs(_t.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[p.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(yc,{size:18}),p.jsx("span",{className:"font-medium",children:"Mijn Lagen beheren"})]}),p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("span",{className:"text-[10px] opacity-70",children:"T"}),p.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:u.fontScale,onChange:G=>u.setFontScale(parseInt(G.target.value)),className:"header-slider w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${u.fontScale}%`}),p.jsx("span",{className:"text-xs opacity-70",children:"T"}),p.jsx("button",{onClick:j,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none ml-1",children:p.jsx(Qr,{size:18})})]})]}),p.jsxs("div",{className:"flex border-b border-gray-100",children:[p.jsxs("button",{onClick:()=>I(!1),className:`flex-1 px-3 py-2 text-sm transition-colors border-0 outline-none ${A?"text-gray-500 hover:text-gray-700 hover:bg-gray-50":"text-orange-600 border-b-2 border-orange-500 bg-orange-50/50"}`,children:["Actief (",P.length,")"]}),p.jsxs("button",{onClick:()=>I(!0),className:`flex-1 px-3 py-2 text-sm transition-colors border-0 outline-none flex items-center justify-center gap-1 ${A?"text-orange-600 border-b-2 border-orange-500 bg-orange-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[p.jsx(r2e,{size:14}),"Archief (",R.length,")"]})]}),p.jsxs("div",{className:"flex-1 overflow-y-auto",style:{fontSize:`${h}px`},children:[D.length===0?p.jsx("div",{className:"p-8 text-center text-gray-500",children:A?p.jsx("p",{style:{fontSize:"1em"},children:"Geen gearchiveerde lagen."}):p.jsxs(p.Fragment,{children:[p.jsx("p",{className:"mb-4",style:{fontSize:"1em"},children:"Je hebt nog geen eigen lagen."}),p.jsxs("button",{onClick:U,className:"px-4 py-2 bg-orange-500 hover:bg-orange-600 text-white rounded-lg transition-colors border-0 outline-none",style:{fontSize:"1em"},children:[p.jsx(_u,{size:16,className:"inline mr-2"}),"Nieuwe laag aanmaken"]})]})}):p.jsx("div",{className:"divide-y divide-gray-100",children:D.map(G=>p.jsx(Akt,{layer:G,isExpanded:f===G.id,onToggleExpand:()=>g(f===G.id?null:G.id),onToggleVisibility:()=>o(G.id),onToggleArchived:()=>a(G.id),onOpenDashboard:()=>V(G.id),onExport:()=>M(G.id),onDelete:()=>C(G.id),confirmDelete:y===G.id,onRename:de=>ps.getState().updateLayer(G.id,{name:de}),onChangeColor:de=>ps.getState().updateLayer(G.id,{color:de})},G.id))}),b&&p.jsx("div",{className:"mx-4 my-2 p-3 bg-red-50 text-red-700 text-sm rounded-lg",children:b})]}),p.jsxs("div",{className:"p-4 flex gap-3",style:{fontSize:`${h}px`},children:[p.jsxs("label",{className:"flex-1 px-4 py-2 bg-white hover:bg-blue-50 rounded-lg transition-colors cursor-pointer flex items-center justify-center gap-2 border-0 outline-none text-gray-600",children:[p.jsx(WI,{size:16}),p.jsx("span",{style:{fontSize:"1em"},children:"Importeren"}),p.jsx("input",{type:"file",accept:".geojson,.json",onChange:O,className:"hidden"})]}),p.jsxs("button",{onClick:U,className:"flex-1 px-4 py-2 bg-orange-500 hover:bg-orange-600 text-white rounded-lg transition-colors border-0 outline-none flex items-center justify-center gap-2",style:{fontSize:"1em"},children:[p.jsx(_u,{size:16}),p.jsx("span",{children:"Nieuwe laag"})]})]})]})]})})}const kkt=["#ef4444","#f97316","#eab308","#22c55e","#06b6d4","#3b82f6","#8b5cf6","#ec4899"];function Akt({layer:t,isExpanded:e,onToggleExpand:n,onToggleVisibility:r,onToggleArchived:i,onOpenDashboard:s,onExport:o,onDelete:a,confirmDelete:l,onRename:c,onChangeColor:u}){const[h,f]=Y.useState(!1),[g,y]=Y.useState(t.name),[_,b]=Y.useState(!1),T=Y.useRef(null);Y.useEffect(()=>{h&&T.current&&(T.current.focus(),T.current.select())},[h]);const A=()=>{y(t.name),f(!0)},I=()=>{const M=g.trim();M&&M!==t.name&&c(M),f(!1)},P=()=>{y(t.name),f(!1)},R=M=>{M.key==="Enter"?I():M.key==="Escape"&&P()},D=t.points.filter(M=>M.status==="completed").length,C=t.points.length;return p.jsxs("div",{className:"bg-white",children:[p.jsxs("div",{className:"flex items-center gap-3 px-4 py-3",children:[p.jsx("button",{onClick:n,className:"p-1 text-gray-400 hover:text-gray-600 transition-colors border-0 outline-none bg-transparent",children:e?p.jsx(Eb,{size:16}):p.jsx(Sb,{size:16})}),p.jsxs("div",{className:"relative",children:[p.jsx("button",{onClick:()=>b(!_),className:"w-5 h-5 rounded-full flex-shrink-0 border-2 border-white shadow-sm hover:scale-110 transition-transform cursor-pointer",style:{backgroundColor:t.color},title:"Kleur wijzigen"}),_&&p.jsx("div",{className:"absolute top-7 left-0 z-50 bg-white rounded-lg shadow-lg p-2 flex flex-wrap gap-1 w-24",children:kkt.map(M=>p.jsx("button",{onClick:()=>{u(M),b(!1)},className:`w-5 h-5 rounded-full border-2 hover:scale-110 transition-transform ${M===t.color?"border-gray-800":"border-white"}`,style:{backgroundColor:M}},M))})]}),h?p.jsxs("div",{className:"flex-1 min-w-0 flex items-center gap-2",children:[p.jsx("input",{ref:T,type:"text",value:g,onChange:M=>y(M.target.value),onKeyDown:R,onBlur:I,className:"flex-1 px-2 py-1 text-gray-800 font-medium bg-orange-50 rounded outline-none focus:ring-2 focus:ring-orange-400"}),p.jsx("button",{onClick:I,className:"p-1 text-green-600 hover:bg-green-50 rounded transition-colors border-0 outline-none",title:"Opslaan",children:p.jsx(_p,{size:16})})]}):p.jsxs("button",{onClick:s,className:"flex-1 min-w-0 text-left border-0 outline-none bg-transparent hover:bg-orange-50 rounded px-2 py-1 -ml-2 transition-colors",title:"Bekijk dashboard",children:[p.jsx("div",{className:"font-medium text-gray-800 truncate hover:text-orange-600",children:t.name}),p.jsx("div",{className:"text-xs text-gray-500",children:C>0?p.jsxs("span",{className:D===C?"text-green-600":"",children:[D,"/",C," voltooid"]}):"Geen punten"})]}),!h&&p.jsx("button",{onClick:A,className:"p-2 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none",title:"Naam bewerken",children:p.jsx(Kg,{size:16})}),p.jsx("button",{onClick:s,className:"p-2 text-orange-400 hover:text-orange-600 hover:bg-orange-50 rounded transition-colors border-0 outline-none",title:"Open dashboard",children:p.jsx(p2e,{size:18})}),!t.archived&&p.jsx("button",{onClick:r,className:`p-2 rounded transition-colors border-0 outline-none ${t.visible?"text-blue-500 hover:bg-blue-50":"text-gray-400 hover:bg-gray-100"}`,title:t.visible?"Verbergen":"Tonen",children:t.visible?p.jsx(zN,{size:18}):p.jsx(VN,{size:18})}),p.jsx("button",{onClick:i,className:`p-2 rounded transition-colors border-0 outline-none ${t.archived?"text-green-500 hover:text-green-600 hover:bg-green-50":"text-gray-400 hover:text-amber-600 hover:bg-amber-50"}`,title:t.archived?"Herstellen":"Archiveren",children:t.archived?p.jsx(Glt,{size:18}):p.jsx(r2e,{size:18})}),p.jsx("button",{onClick:o,className:"p-2 text-gray-400 hover:text-green-600 hover:bg-green-50 rounded transition-colors border-0 outline-none",title:"Exporteren als GeoJSON",children:p.jsx(vA,{size:18})}),p.jsx("button",{onClick:a,className:`p-2 rounded transition-colors border-0 outline-none ${l?"text-white bg-red-500 hover:bg-red-600":"text-gray-400 hover:text-red-600 hover:bg-red-50"}`,title:l?"Klik nogmaals om te verwijderen":"Verwijderen",children:p.jsx(Sh,{size:18})})]}),p.jsx(qn,{children:e&&p.jsx(_t.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:p.jsxs("div",{className:"px-4 pb-3 pl-12 space-y-2",children:[t.categories.length>0&&p.jsx("div",{className:"flex flex-wrap gap-1",children:t.categories.map(M=>p.jsx("span",{className:"px-2 py-0.5 bg-gray-100 text-gray-600 text-xs rounded-full",children:M},M))}),t.points.length>0&&p.jsxs("div",{className:"text-xs text-gray-500 space-y-1 max-h-32 overflow-y-auto",children:[t.points.slice(0,5).map(M=>p.jsx("div",{className:"flex items-center gap-2",children:p.jsx("span",{className:`font-medium ${M.status==="completed"?"text-green-600 line-through":M.status==="skipped"?"text-gray-400 line-through":"text-gray-700"}`,children:M.name})},M.id)),t.points.length>5&&p.jsxs("div",{className:"text-gray-400",children:["...en ",t.points.length-5," meer"]})]}),p.jsxs("div",{className:"text-xs text-gray-400",children:["Aangemaakt: ",new Date(t.createdAt).toLocaleDateString("nl-NL")]})]})})})]})}function Ikt(){const{layerDashboardOpen:t,layerDashboardLayerId:e,closeLayerDashboard:n}=Gr(),{getLayer:r,setPointStatus:i,updatePoint:s,removePoint:o}=ps(),a=Cn(),[l,c]=Y.useState("all"),[u,h]=Y.useState(null),[f,g]=Y.useState(""),[y,_]=Y.useState(null),b=e?r(e):null,T=14*a.fontScale/100;if(!b)return null;const A=b.points.filter(V=>l==="all"?!0:V.status===l),I=b.points.length,P=b.points.filter(V=>V.status==="completed").length,R=b.points.filter(V=>V.status==="todo").length,D=b.points.filter(V=>V.status==="skipped").length,C=(V,U)=>{i(b.id,V,U)},M=V=>{s(b.id,V,{notes:f}),h(null),g("")},O=V=>{y===V?(o(b.id,V),_(null)):(_(V),setTimeout(()=>_(null),3e3))},j=()=>{h(null),_(null),n()};return p.jsx(qn,{children:t&&p.jsxs(p.Fragment,{children:[p.jsx(_t.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:j}),p.jsxs(_t.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[90vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[p.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("div",{className:"w-4 h-4 rounded-full border-2 border-white/50",style:{backgroundColor:b.color}}),p.jsx("span",{className:"font-medium truncate",children:b.name})]}),p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("span",{className:"text-[10px] opacity-70",children:"T"}),p.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:a.fontScale,onChange:V=>a.setFontScale(parseInt(V.target.value)),className:"header-slider w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${a.fontScale}%`}),p.jsx("span",{className:"text-xs opacity-70",children:"T"}),p.jsx("button",{onClick:j,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none ml-1",children:p.jsx(Qr,{size:18})})]})]}),p.jsxs("div",{className:"px-4 py-2 bg-orange-50 flex items-center justify-between text-sm",children:[p.jsxs("span",{className:"text-orange-800 font-medium",children:[P,"/",I," voltooid"]}),p.jsxs("div",{className:"flex items-center gap-3 text-xs",children:[p.jsxs("span",{className:"text-orange-600",children:[R," te doen"]}),D>0&&p.jsxs("span",{className:"text-gray-500",children:[D," overgeslagen"]})]})]}),p.jsx("div",{className:"flex border-b border-gray-100",children:["all","todo","completed","skipped"].map(V=>p.jsxs("button",{onClick:()=>c(V),className:`flex-1 px-3 py-2 text-sm transition-colors border-0 outline-none ${l===V?"text-orange-600 border-b-2 border-orange-500 bg-orange-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[V==="all"&&"Alles",V==="todo"&&"Te doen",V==="completed"&&"Voltooid",V==="skipped"&&"Overgeslagen"]},V))}),p.jsx("div",{className:"flex-1 overflow-y-auto",style:{fontSize:`${T}px`},children:A.length===0?p.jsx("div",{className:"p-8 text-center text-gray-500",children:p.jsx("p",{children:"Geen punten gevonden"})}):p.jsx("div",{className:"divide-y divide-gray-100",children:A.map(V=>p.jsx("div",{className:"p-3",children:p.jsxs("div",{className:"flex items-start gap-3",children:[p.jsxs("div",{className:"flex flex-col gap-1 pt-0.5",children:[p.jsx("button",{onClick:()=>C(V.id,V.status==="completed"?"todo":"completed"),className:`w-6 h-6 flex items-center justify-center rounded border-0 outline-none transition-colors ${V.status==="completed"?"bg-green-100 hover:bg-green-200":"bg-gray-100 hover:bg-green-100"}`,title:V.status==="completed"?"Markeer als te doen":"Markeer als voltooid",children:p.jsx(_p,{size:14,className:V.status==="completed"?"text-green-600":"text-gray-400"})}),p.jsx("button",{onClick:()=>C(V.id,V.status==="skipped"?"todo":"skipped"),className:`w-6 h-6 flex items-center justify-center rounded border-0 outline-none transition-colors ${V.status==="skipped"?"bg-gray-200 hover:bg-gray-300":"bg-gray-100 hover:bg-gray-200"}`,title:V.status==="skipped"?"Markeer als te doen":"Overslaan",children:p.jsx(Wlt,{size:14,className:V.status==="skipped"?"text-gray-600":"text-gray-400"})})]}),V.photos&&V.photos.length>0&&p.jsxs("div",{className:"relative flex-shrink-0",children:[p.jsx("img",{src:V.photos[0].thumbnailUrl||V.photos[0].thumbnailBase64,alt:"Foto",className:"w-12 h-12 object-cover rounded border border-gray-200"}),V.photos.length>1&&p.jsxs("span",{className:"absolute -bottom-1 -right-1 bg-orange-500 text-white text-[9px] px-1 rounded-full",children:["+",V.photos.length-1]})]}),p.jsxs("div",{className:"flex-1 min-w-0",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("span",{className:`font-medium truncate ${V.status==="completed"?"text-green-700 line-through":V.status==="skipped"?"text-gray-400 line-through":"text-gray-800"}`,children:V.name}),V.sourceLayer&&p.jsxs("span",{className:"text-xs text-gray-400 truncate",children:["via ",V.sourceLayer]})]}),u===V.id?p.jsxs("div",{className:"mt-2",children:[p.jsx("textarea",{value:f,onChange:U=>g(U.target.value),placeholder:"Notities...",rows:2,className:"w-full px-2 py-1 bg-white rounded border-0 outline-none hover:bg-blue-50 transition-colors resize-none text-sm",autoFocus:!0}),p.jsxs("div",{className:"flex gap-2 mt-1",children:[p.jsx("button",{onClick:()=>M(V.id),className:"px-2 py-1 text-xs bg-orange-500 text-white rounded hover:bg-orange-600 border-0 outline-none",children:"Opslaan"}),p.jsx("button",{onClick:()=>{h(null),g("")},className:"px-2 py-1 text-xs bg-white text-gray-600 rounded hover:bg-blue-50 border-0 outline-none",children:"Annuleren"})]})]}):V.notes?p.jsx("p",{className:"text-sm text-gray-600 mt-1",children:V.notes}):null,V.url&&p.jsxs("a",{href:V.url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-xs text-blue-500 hover:text-blue-700 mt-1",children:[p.jsx(Tg,{size:12}),"Link"]})]}),p.jsxs("div",{className:"flex flex-col gap-1",children:[p.jsx("button",{onClick:()=>{h(V.id),g(V.notes)},className:"w-6 h-6 flex items-center justify-center text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded border-0 outline-none",title:"Notities bewerken",children:p.jsx(mut,{size:14})}),p.jsx("button",{onClick:()=>{window.open(`https://www.google.com/maps/dir/?api=1&destination=${V.coordinates[1]},${V.coordinates[0]}`,"_blank")},className:"w-6 h-6 flex items-center justify-center text-blue-400 hover:text-blue-600 hover:bg-blue-50 rounded border-0 outline-none",title:"Navigeer naar",children:p.jsx(Il,{size:14})}),p.jsx("button",{onClick:()=>O(V.id),className:`w-6 h-6 flex items-center justify-center rounded border-0 outline-none ${y===V.id?"text-white bg-red-500 hover:bg-red-600":"text-gray-400 hover:text-red-600 hover:bg-red-50"}`,title:y===V.id?"Klik nogmaals":"Verwijderen",children:p.jsx(Sh,{size:14})})]})]})},V.id))})})]})]})})}function Pkt(){const[t,e]=Y.useState(navigator.onLine),[n,r]=Y.useState(!1);return Y.useEffect(()=>{const i=()=>{e(!0),r(!1)},s=()=>{e(!1),r(!1)};return window.addEventListener("online",i),window.addEventListener("offline",s),()=>{window.removeEventListener("online",i),window.removeEventListener("offline",s)}},[]),t||n?null:p.jsx(qn,{children:p.jsx(_t.div,{initial:{y:-50,opacity:0},animate:{y:0,opacity:1},exit:{y:-50,opacity:0},className:"fixed top-0 left-0 right-0 z-[2000] bg-amber-500 text-white px-4 py-2 shadow-lg",children:p.jsxs("div",{className:"flex items-center justify-between max-w-lg mx-auto",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(pht,{size:18}),p.jsx("span",{className:"text-sm font-medium",children:"Offline modus - Kaart werkt met gecachede data"})]}),p.jsx("button",{onClick:()=>r(!0),className:"p-1 hover:bg-white/20 rounded transition-colors border-0 outline-none bg-transparent",children:p.jsx(Qr,{size:16})})]})})})}const Ckt={"zeer hoge archeologische waarde":"bg-purple-600","hoge archeologische waarde":"bg-purple-500","archeologische waarde":"bg-purple-400"},Rkt={"zeer hoge archeologische waarde":"Zeer hoog","hoge archeologische waarde":"Hoog","archeologische waarde":"Waarde"};let Wx=null;function pSe(t){return Wx||(Wx=new Nl({source:new Ml,style:new vn({fill:new Dn({color:"rgba(147, 51, 234, 0.5)"}),stroke:new Pn({color:"#9333ea",width:3})}),zIndex:9999}),t.addLayer(Wx)),Wx}function Mkt(){Wx&&Wx.getSource()?.clear()}async function Nkt(t,e){const n=await USt(e);if(!n)return;const i=pSe(t).getSource();i?.clear();const s=n.clone();i?.addFeature(s)}function Okt({isOpen:t,onClose:e}){const n=gi(Q=>Q.map),r=Cn(),[i,s]=Y.useState(""),[o,a]=Y.useState("all"),[l,c]=Y.useState([]),[u,h]=Y.useState(!1),[f,g]=Y.useState(!1),[y,_]=Y.useState(null),[b,T]=Y.useState(null),[A,I]=Y.useState(50),[P,R]=Y.useState(!1),[D,C]=Y.useState(!1),[M,O]=Y.useState(!1),j=Y.useRef(null),V=Y.useRef(),U=Y.useRef(null),G=13*r.fontScale/100;Y.useEffect(()=>{t&&j.current&&setTimeout(()=>j.current?.focus(),100)},[t]),Y.useEffect(()=>{if(!t)return;const Q=ne=>{U.current&&!U.current.contains(ne.target)&&e()},W=setTimeout(()=>{document.addEventListener("mousedown",Q)},100);return()=>{clearTimeout(W),document.removeEventListener("mousedown",Q)}},[t,e]),Y.useEffect(()=>{t||R(!1)},[t]),Y.useEffect(()=>{if(V.current&&clearTimeout(V.current),i.length<2){c([]),g(!1);return}return V.current=window.setTimeout(async()=>{h(!0),g(!0);try{const Q=await GSt(i,A,o);c(Q)}catch(Q){console.error("Monument search error:",Q),c([])}finally{h(!1)}},400),()=>{V.current&&clearTimeout(V.current)}},[i,o,A]);const de=async Q=>{if(!n)return;const W=n.getView();if(y===Q.id){const ne=ih(Q.extent,50);W.fit(ne,{duration:500,maxZoom:18})}else{const ne=ih(Q.extent,200);W.fit(ne,{duration:500,maxZoom:16}),await Nkt(n,Q.monumentnummer),_(Q.id),T(Q.id)}},Ie=(Q,W)=>{if(W.stopPropagation(),!n)return;const ne=n.getView(),ie=ih(Q.extent,20);ne.fit(ie,{duration:500,maxZoom:18})},ze=(Q,W)=>{W.stopPropagation(),T(b===Q?null:Q)},Ne=async()=>{if(!(!n||l.length===0)){O(!0);try{const Q=l.map(Ke=>Ke.monumentnummer),W=await BSt(Q);if(W.length===0)return;const ie=pSe(n).getSource();ie?.clear();let le=Ba();W.forEach(Ke=>{const Se=Ke.clone();ie?.addFeature(Se);const we=Se.getGeometry();we&&(le=Wz(le,we.getExtent()))});const ve=n.getView(),qe=ih(le,500);ve.fit(qe,{duration:500,maxZoom:14}),C(!0),_(null),console.log(` ${W.length} monumenten getoond op kaart`)}catch(Q){console.error("Error showing all monuments:",Q)}finally{O(!1)}}},fe=()=>{e()},De=()=>{Mkt(),s(""),a("all"),c([]),g(!1),_(null),T(null),I(50),C(!1),e()},Ce=Q=>{if(!i||i.length<2)return Q;const W=i.toLowerCase().split(/\s+/).filter(ie=>ie.length>=2);let ne=Q;return W.forEach(ie=>{const le=ie.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),ve=new RegExp(`(${le})`,"gi");ne=ne.replace(ve,'<mark class="bg-yellow-200 px-0.5">$1</mark>')}),ne};return t?p.jsx(qn,{children:p.jsxs(_t.div,{ref:U,initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{type:"spring",damping:25,stiffness:300},className:"fixed bottom-0 left-0 right-0 z-[1701] bg-white rounded-t-2xl shadow-2xl overflow-hidden flex flex-col",style:{height:P?"85vh":"38vh"},children:[p.jsxs("div",{className:"flex items-center justify-between px-4 py-2 bg-gradient-to-r from-purple-500 to-purple-600 text-white cursor-pointer select-none",onClick:()=>R(!P),children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(f2e,{size:16}),p.jsx("span",{className:"font-medium text-sm",children:"Zoek monumenten"})]}),p.jsxs("div",{className:"flex items-center gap-1",children:[p.jsx(d2e,{size:20,className:"opacity-70"}),p.jsx("button",{onClick:Q=>{Q.stopPropagation(),fe()},className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none ml-2",children:p.jsx(Qr,{size:16})})]})]}),p.jsx("div",{className:"p-2 border-b border-gray-100 space-y-2",children:p.jsxs("div",{className:"flex gap-2",children:[p.jsxs("div",{className:"relative flex-1",children:[p.jsx(_A,{size:16,className:"absolute left-2.5 top-1/2 -translate-y-1/2 text-gray-400"}),p.jsx("input",{ref:j,type:"text",value:i,onChange:Q=>{s(Q.target.value),_(null),T(null),C(!1)},placeholder:"bouwvoor, scherven...",className:"w-full pl-8 pr-8 py-2 bg-gray-100 rounded-lg border-0 outline-none focus:ring-2 focus:ring-purple-500 text-sm"}),i&&p.jsx("button",{onClick:()=>{s(""),_(null),T(null),C(!1)},className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 border-0 outline-none bg-transparent",children:p.jsx(Qr,{size:14})})]}),p.jsx("select",{value:o,onChange:Q=>{a(Q.target.value),_(null),T(null),C(!1)},className:"py-1.5 px-2 bg-gray-100 rounded-lg border-0 outline-none focus:ring-2 focus:ring-purple-500 text-sm text-gray-700 w-28",children:Object.entries(Vq).map(([Q,{name:W}])=>p.jsx("option",{value:Q,children:W},Q))})]})}),p.jsxs("div",{className:"flex-1 overflow-y-auto",style:{fontSize:`${G}px`},children:[u&&p.jsx("div",{className:"p-3 text-center text-gray-500 text-sm",children:"Zoeken..."}),!u&&f&&l.length===0&&p.jsx("div",{className:"p-3 text-center text-gray-500 text-sm",children:"Geen resultaten"}),!u&&l.length>0&&p.jsxs("div",{className:"divide-y divide-gray-100",children:[p.jsxs("div",{className:"px-3 py-1.5 bg-gray-50 text-xs text-gray-500 flex justify-between items-center gap-2",children:[p.jsxs("span",{children:[l.length,l.length>=A?"+":""," gevonden"]}),p.jsxs("div",{className:"flex items-center gap-2",children:[l.length>=A&&p.jsx("button",{onClick:()=>I(A+50),className:"text-purple-600 hover:text-purple-700 border-0 outline-none bg-transparent",children:"Meer laden"}),p.jsxs("button",{onClick:Ne,disabled:M,className:`flex items-center gap-1 px-2 py-1 rounded text-white border-0 outline-none transition-colors ${D?"bg-green-500 hover:bg-green-600":"bg-purple-500 hover:bg-purple-600"} ${M?"opacity-50 cursor-wait":""}`,children:[M?p.jsx(BI,{size:12,className:"animate-spin"}):p.jsx(SL,{size:12}),p.jsx("span",{children:D?"Getoond":"Toon alle"})]})]})]}),l.map(Q=>p.jsxs("div",{className:`transition-colors ${y===Q.id?"bg-purple-50":"bg-transparent"}`,children:[p.jsx("button",{onClick:()=>de(Q),className:"w-full text-left px-3 py-2 hover:bg-purple-50 transition-colors border-0 outline-none bg-transparent",children:p.jsxs("div",{className:"flex items-start justify-between gap-2",children:[p.jsxs("div",{className:"flex-1 min-w-0",children:[p.jsx("p",{className:"font-medium text-gray-800 text-sm",children:Q.toponiem}),p.jsx("p",{className:"text-xs text-purple-600 mt-0.5",children:Q.periode})]}),p.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[p.jsx("span",{className:`px-1.5 py-0.5 rounded text-white text-[9px] ${Ckt[Q.kwaliteitswaarde]||"bg-gray-500"}`,children:Rkt[Q.kwaliteitswaarde]||"AMK"}),y===Q.id&&p.jsx("button",{onClick:W=>Ie(Q,W),className:"p-1 bg-purple-500 hover:bg-purple-600 text-white rounded transition-colors border-0 outline-none",title:"Zoom in",children:p.jsx(vht,{size:12})})]})]})}),y===Q.id&&p.jsxs("div",{className:"px-3 pb-2",children:[p.jsxs("button",{onClick:W=>ze(Q.id,W),className:"flex items-center gap-1 text-xs text-purple-600 hover:text-purple-700 border-0 outline-none bg-transparent mb-1",children:[b===Q.id?p.jsx(EL,{size:14}):p.jsx(Eb,{size:14}),b===Q.id?"Minder":"Omschrijving"]}),b===Q.id&&p.jsx("div",{className:"text-xs text-gray-700 bg-gray-50 rounded p-2 max-h-32 overflow-y-auto whitespace-pre-wrap",dangerouslySetInnerHTML:{__html:Ce(Q.omschrijving)}})]})]},Q.id))]}),!u&&!f&&p.jsx("div",{className:"p-3 text-xs text-gray-500",children:"Zoek op trefwoorden in 13.000+ AMK monumenten"})]}),(y||i)&&p.jsx("div",{className:"p-2 border-t border-gray-100",children:p.jsx("button",{onClick:De,className:"w-full py-2 text-sm text-gray-600 hover:text-gray-800 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors border-0 outline-none",children:"Wis zoekopdracht en highlight"})})]})}):null}const Lkt=["AMK Monumenten","AMK Romeins","AMK Steentijd","AMK Vroege ME","AMK Late ME","AMK Overig"];function Dkt(){const t=Y.useRef(null),{keyword:e,isActive:n,totalCount:r,filteredCount:i,setKeyword:s,setActive:o,clearFilter:a}=oSe(),l=Gr(_=>_.monumentFilterOpen),c=Gr(_=>_.toggleMonumentFilter),u=Gr(_=>_.closeMonumentFilter),h=Bs(_=>_.visible),f=Lkt.some(_=>h[_]);Y.useEffect(()=>{l&&t.current&&setTimeout(()=>t.current?.focus(),100)},[l]);const g=()=>{e.length>=2&&o(!n)},y=e.length>=2;return f?p.jsxs("div",{children:[p.jsx(_t.button,{onClick:c,className:`fixed bottom-[116px] left-2 z-[800] w-11 h-11 flex items-center justify-center rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm ${n?"bg-purple-500 text-white":"bg-white/80 hover:bg-white/90 text-purple-600"}`,whileHover:{scale:1.05},whileTap:{scale:.95},title:"Monument filter",children:p.jsx(u2e,{size:20})}),p.jsx(qn,{children:l&&p.jsxs(p.Fragment,{children:[p.jsx(_t.div,{className:"fixed inset-0 z-[800]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:u}),p.jsxs(_t.div,{initial:{opacity:0,x:-10,scale:.95},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:-10,scale:.95},transition:{duration:.15},className:"fixed bottom-[116px] left-[56px] z-[801] bg-white/95 rounded-xl shadow-lg backdrop-blur-sm overflow-hidden",children:[p.jsx("div",{className:"px-3 py-1.5 bg-purple-500",children:p.jsx("span",{className:"font-medium text-white text-xs",children:"Monument Filter"})}),p.jsxs("div",{className:"p-2 space-y-1.5",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("input",{ref:t,type:"text",value:e,onChange:_=>s(_.target.value),placeholder:"Filter...",className:"w-24 px-2 py-1.5 text-sm bg-gray-100 rounded border-0 outline-none focus:ring-2 focus:ring-purple-400"}),p.jsx("button",{onClick:g,disabled:!y,className:`relative w-10 h-5 rounded-full transition-colors border-0 outline-none ${n?"bg-purple-500":y?"bg-gray-300":"bg-gray-200 cursor-not-allowed"}`,title:n?"Filter uit":"Filter aan",children:p.jsx("span",{className:`absolute top-0.5 w-4 h-4 bg-white rounded-full shadow transition-transform ${n?"translate-x-5":"translate-x-0.5"}`})})]}),r>0&&p.jsx("div",{className:"text-xs text-gray-500 text-center",children:n?p.jsxs("span",{className:"text-purple-600 font-medium",children:[i," van ",r]}):p.jsxs("span",{children:[r," monumenten"]})})]})]})]})})]}):null}function jkt({isOpen:t,onClose:e}){const n=Cn(s=>s.setHideWelcomeModal),r=()=>{e()},i=()=>{n(!0),e()};return p.jsx(qn,{children:t&&p.jsxs(p.Fragment,{children:[p.jsx(_t.div,{className:"fixed inset-0 bg-black/40 z-[2000]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:r}),p.jsx(_t.div,{className:"fixed inset-x-4 top-4 bottom-4 z-[2001] flex items-center justify-center pointer-events-none",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:p.jsxs(_t.div,{className:"bg-white rounded-2xl shadow-2xl overflow-hidden flex flex-col w-full max-w-md max-h-full pointer-events-auto",initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},transition:{duration:.2},onClick:s=>s.stopPropagation(),children:[p.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-100 flex-shrink-0",children:[p.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Hoe werkt de app?"}),p.jsx("button",{onClick:r,className:"p-1.5 rounded-lg hover:bg-gray-100 transition-colors border-0 outline-none",children:p.jsx(Qr,{size:20,className:"text-gray-500"})})]}),p.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[p.jsxs("section",{children:[p.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Knoppen op de kaart"}),p.jsx("p",{className:"text-xs text-gray-500 mb-3",children:"Aan de linker- en rechterkant vind je tools:"}),p.jsxs("div",{className:"space-y-2",children:[p.jsx(vm,{icon:p.jsx(yc,{size:16}),title:"Kaartlagen",description:"Selecteer welke lagen je wilt zien"}),p.jsx(vm,{icon:p.jsx(_A,{size:16}),title:"Zoeken",description:"Zoek naar een adres of plaatsnaam"}),p.jsx(vm,{icon:p.jsx(Il,{size:16}),title:"GPS Locatie",description:"Volg je positie op de kaart"}),p.jsx(vm,{icon:p.jsx(c2e,{size:16}),title:"Presets",description:"Snel wisselen tussen kaartlagen"}),p.jsx(vm,{icon:p.jsx(u2e,{size:16}),title:"Monument Filter",description:"Filter monumenten op periode"}),p.jsx(vm,{icon:p.jsx(w2e,{size:16}),title:"Transparantie",description:"Pas doorzichtigheid aan"}),p.jsx(vm,{icon:p.jsx(m2e,{size:16}),title:"Menu",description:"Instellingen en meer"}),p.jsx(vm,{icon:p.jsx(x2e,{size:16}),title:"Reset",description:"Kaart naar beginstand"})]})]}),p.jsxs("section",{className:"bg-blue-50 rounded-xl p-3",children:[p.jsx("h3",{className:"text-sm font-semibold text-blue-800 mb-1",children:"Kaartlagen gebruiken"}),p.jsx("p",{className:"text-xs text-blue-700",children:"Klik op een locatie om informatie te zien over monumenten en archeologische gegevens."})]}),p.jsxs("section",{className:"flex items-start gap-2 p-3 bg-gray-50 rounded-xl",children:[p.jsx(i2e,{size:18,className:"text-blue-600 flex-shrink-0 mt-0.5"}),p.jsxs("div",{children:[p.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-0.5",children:"Handleiding"}),p.jsx("a",{href:"https://github.com/user/detectorapp-nl/wiki",target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-600 hover:text-blue-700 hover:underline",children:"Bekijk volledige handleiding "})]})]})]}),p.jsxs("div",{className:"flex items-center justify-end gap-2 px-4 py-3 border-t border-gray-100 bg-gray-50 flex-shrink-0",children:[p.jsx("button",{onClick:i,className:"px-4 py-2 text-sm font-medium text-gray-600 hover:bg-gray-200 rounded-lg transition-colors border-0 outline-none",children:"Toon niet meer"}),p.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors border-0 outline-none",children:"Begrepen"})]})]})})]})})}function vm({icon:t,title:e,description:n}){return p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("div",{className:"w-7 h-7 flex items-center justify-center bg-blue-100 text-blue-600 rounded-lg flex-shrink-0",children:t}),p.jsxs("div",{className:"flex-1 min-w-0",children:[p.jsx("span",{className:"text-xs font-medium text-gray-700",children:e}),p.jsxs("span",{className:"text-xs text-gray-400 ml-1",children:["- ",n]})]})]})}function dg(t,e){const n=t.length;return e<0?t[e+n]:e>=n?t[e-n]:t[e]}function Hx(t,e){const n=t.length;let r=Math.floor(e);const i=e-r;r>=n?r-=n:r<0&&(r+=n);let s=r+1;s>=n&&(s-=n);const o=t[r],a=o[0],l=o[1],c=t[s],u=c[0]-a,h=c[1]-l;return[a+u*i,l+h*i]}const $R={index:-1,endIndex:NaN,closestTargetDistance:1/0};function mSe(t,e,n,r){const i=t[0],s=t[1];let o=1/0,a=-1,l=NaN;for(let h=0;h<e.targets.length;++h){const f=e.targets[h],g=f.coordinates;let y=1/0,_;for(let b=0;b<g.length-1;++b){const T=g[b],A=g[b+1],I=vSe(i,s,T,A);I.squaredDistance<y&&(y=I.squaredDistance,_=b+I.along)}y<o&&(o=y,f.ring&&e.targetIndex===h&&(f.endIndex>f.startIndex?_<f.startIndex&&(_+=g.length):f.endIndex<f.startIndex&&_>f.startIndex&&(_-=g.length)),l=_,a=h)}const c=e.targets[a];let u=c.ring;if(e.targetIndex===a&&u){const h=Hx(c.coordinates,l),f=n.getPixelFromCoordinate(h),g=n.getPixelFromCoordinate(e.startCoord);wx(f,g)>r&&(u=!1)}if(u){const h=c.coordinates,f=h.length,g=c.startIndex,y=l;if(g<y){const _=zR(h,g,y);zR(h,g,y-f)<_&&(l-=f)}else{const _=zR(h,g,y);zR(h,g,y+f)<_&&(l+=f)}}return $R.index=a,$R.endIndex=l,$R.closestTargetDistance=o,$R}function gSe(t,e){const n=[];for(let r=0;r<e.length;++r){const s=e[r].getGeometry();ySe(t,s,n)}return n}function ySe(t,e,n){if(e instanceof ts){FR(t,e.getCoordinates(),!1,n);return}if(e instanceof yh){const r=e.getCoordinates();for(let i=0,s=r.length;i<s;++i)FR(t,r[i],!1,n);return}if(e instanceof kl){const r=e.getCoordinates();for(let i=0,s=r.length;i<s;++i)FR(t,r[i],!0,n);return}if(e instanceof hp){const r=e.getCoordinates();for(let i=0,s=r.length;i<s;++i){const o=r[i];for(let a=0,l=o.length;a<l;++a)FR(t,o[a],!0,n)}return}if(e instanceof cu){const r=e.getGeometries();for(let i=0;i<r.length;++i)ySe(t,r[i],n);return}}function FR(t,e,n,r){const i=t[0],s=t[1];for(let o=0,a=e.length-1;o<a;++o){const l=e[o],c=e[o+1],u=vSe(i,s,l,c);if(u.squaredDistance===0){const h=o+u.along;r.push({coordinates:e,ring:n,startIndex:h,endIndex:h});return}}}function VR(t,e){return Qf(t[0],t[1],e[0],e[1])}function zR(t,e,n){let r,i;e<n?(r=e,i=n):(r=n,i=e);const s=Math.ceil(r),o=Math.floor(i);if(s>o){const l=Hx(t,r),c=Hx(t,i);return VR(l,c)}let a=0;if(r<s){const l=Hx(t,r),c=dg(t,s);a+=VR(l,c)}if(o<i){const l=dg(t,o),c=Hx(t,i);a+=VR(l,c)}for(let l=s;l<o-1;++l){const c=dg(t,l),u=dg(t,l+1);a+=VR(c,u)}return a}const vF={along:0,squaredDistance:0};function vSe(t,e,n,r){const i=n[0],s=n[1],o=r[0],a=r[1],l=o-i,c=a-s;let u=0,h=i,f=s;return(l!==0||c!==0)&&(u=ri(((t-i)*l+(e-s)*c)/(l*l+c*c),0,1),h+=l*u,f+=c*u),vF.along=u,vF.squaredDistance=q2(Qf(t,e,h,f),10),vF}const GR={DRAWSTART:"drawstart",DRAWEND:"drawend",DRAWABORT:"drawabort"};class UR extends Sc{constructor(e,n){super(e),this.feature=n}}class _Se extends av{constructor(e){const n=e;n.stopDown||(n.stopDown=W2),super(n),this.on,this.once,this.un,this.options_=e,this.shouldHandle_=!1,this.downPx_=null,this.downTimeout_,this.lastDragTime_,this.pointerType_,this.freehand_=!1,this.source_=e.source?e.source:null,this.features_=e.features?e.features:null,this.snapTolerance_=e.snapTolerance?e.snapTolerance:12,this.type_=e.type,this.mode_=Fkt(this.type_),this.stopClick_=!!e.stopClick,this.ignoreNextUpEvent_=!1,this.minPoints_=e.minPoints?e.minPoints:this.mode_==="Polygon"?3:2,this.maxPoints_=this.mode_==="Circle"?2:e.maxPoints?e.maxPoints:1/0,this.finishCondition_=e.finishCondition?e.finishCondition:Cg,this.geometryLayout_=e.geometryLayout?e.geometryLayout:"XY";let r=e.geometryFunction;if(!r){const i=this.mode_;if(i==="Circle")r=(s,o,a)=>{const l=o||new kle([NaN,NaN]),c=Li(s[0]),u=Yw(c,Li(s[s.length-1]));return l.setCenterAndRadius(c,Math.sqrt(u),this.geometryLayout_),l};else{let s;i==="Point"?s=Ti:i==="LineString"?s=ts:i==="Polygon"&&(s=kl),r=(o,a,l)=>(a?i==="Polygon"?o[0].length?a.setCoordinates([o[0].concat([o[0][0]])],this.geometryLayout_):a.setCoordinates([],this.geometryLayout_):a.setCoordinates(o,this.geometryLayout_):a=new s(o,this.geometryLayout_),a)}}this.geometryFunction_=r,this.dragVertexDelay_=e.dragVertexDelay!==void 0?e.dragVertexDelay:500,this.finishCoordinate_=null,this.sketchFeature_=null,this.sketchPoint_=null,this.sketchCoords_=null,this.sketchLine_=null,this.sketchLineCoords_=null,this.squaredClickTolerance_=e.clickTolerance?e.clickTolerance*e.clickTolerance:36,this.overlay_=new Nl({source:new Ml({useSpatialIndex:!1,wrapX:e.wrapX?e.wrapX:!1}),style:e.style?e.style:$kt(),updateWhileInteracting:!0}),this.geometryName_=e.geometryName,this.condition_=e.condition?e.condition:HG,this.freehandCondition_,e.freehand?this.freehandCondition_=Xx:this.freehandCondition_=e.freehandCondition?e.freehandCondition:J3,this.traceCondition_,this.setTrace(e.trace||!1),this.traceState_={active:!1},this.traceSource_=e.traceSource||e.source||null,this.addChangeListener(JF.ACTIVE,this.updateState_)}setTrace(e){let n;e?e===!0?n=Xx:n=e:n=Z3,this.traceCondition_=n}setMap(e){super.setMap(e),this.updateState_()}setFreehand(e){this.freehand_=e,this.freehand_?this.freehandCondition_=Xx:this.freehandCondition_=this.options_&&this.options_.freehandCondition?this.options_.freehandCondition:J3}getOverlay(){return this.overlay_}getFreehand(){return this.freehand_}handleEvent(e){e.originalEvent.type===wn.CONTEXTMENU&&e.originalEvent.preventDefault(),this.freehand_=this.mode_!=="Point"&&this.freehandCondition_(e);let n=e.type===or.POINTERMOVE,r=!0;return!this.freehand_&&this.lastDragTime_&&e.type===or.POINTERDRAG&&(Date.now()-this.lastDragTime_>=this.dragVertexDelay_?(this.downPx_=e.pixel,this.shouldHandle_=!this.freehand_,n=!0):this.lastDragTime_=void 0,this.shouldHandle_&&this.downTimeout_!==void 0&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0)),this.freehand_&&e.type===or.POINTERDRAG&&this.sketchFeature_!==null?(this.addToDrawing_(e.coordinate),r=!1):this.freehand_&&e.type===or.POINTERDOWN?r=!1:n&&this.getPointerCount()<2?(r=e.type===or.POINTERMOVE,r&&this.freehand_?(this.handlePointerMove_(e),this.shouldHandle_&&e.originalEvent.preventDefault()):(e.originalEvent.pointerType==="mouse"||e.type===or.POINTERDRAG&&this.downTimeout_===void 0)&&this.handlePointerMove_(e)):e.type===or.DBLCLICK&&(r=!1),super.handleEvent(e)&&r}handleDownEvent(e){return this.shouldHandle_=!this.freehand_,this.freehand_?(this.downPx_=e.pixel,this.finishCoordinate_||this.startDrawing_(e.coordinate),!0):this.condition_(e)?(this.lastDragTime_=Date.now(),this.downTimeout_=setTimeout(()=>{this.handlePointerMove_(new Rf(or.POINTERMOVE,e.map,e.originalEvent,!1,e.frameState))},this.dragVertexDelay_),this.downPx_=e.pixel,!0):(this.lastDragTime_=void 0,!1)}deactivateTrace_(){this.traceState_={active:!1}}toggleTraceState_(e){if(!this.traceSource_||!this.traceCondition_(e))return;if(this.traceState_.active){this.deactivateTrace_();return}const n=this.getMap(),r=n.getCoordinateFromPixel([e.pixel[0]-this.snapTolerance_,e.pixel[1]+this.snapTolerance_]),i=n.getCoordinateFromPixel([e.pixel[0]+this.snapTolerance_,e.pixel[1]-this.snapTolerance_]),s=ka([r,i]),o=this.traceSource_.getFeaturesInExtent(s);if(o.length===0)return;const a=gSe(e.coordinate,o);a.length&&(this.traceState_={active:!0,startCoord:e.coordinate.slice(),targets:a,targetIndex:-1})}addOrRemoveTracedCoordinates_(e,n){const r=e.startIndex<=e.endIndex,i=e.startIndex<=n;r===i?r&&n>e.endIndex||!r&&n<e.endIndex?this.addTracedCoordinates_(e,e.endIndex,n):(r&&n<e.endIndex||!r&&n>e.endIndex)&&this.removeTracedCoordinates_(n,e.endIndex):(this.removeTracedCoordinates_(e.startIndex,e.endIndex),this.addTracedCoordinates_(e,e.startIndex,n))}removeTracedCoordinates_(e,n){if(e===n)return;let r=0;if(e<n){const i=Math.ceil(e);let s=Math.floor(n);s===n&&(s-=1),r=s-i+1}else{const i=Math.floor(e);let s=Math.ceil(n);s===n&&(s+=1),r=i-s+1}r>0&&this.removeLastPoints_(r)}addTracedCoordinates_(e,n,r){if(n===r)return;const i=[];if(n<r){const s=Math.ceil(n);let o=Math.floor(r);o===r&&(o-=1);for(let a=s;a<=o;++a)i.push(dg(e.coordinates,a))}else{const s=Math.floor(n);let o=Math.ceil(r);o===r&&(o+=1);for(let a=s;a>=o;--a)i.push(dg(e.coordinates,a))}i.length&&this.appendCoordinates(i)}updateTrace_(e){const n=this.traceState_;if(!n.active)return;if(n.targetIndex===-1){const a=e.map.getPixelFromCoordinate(n.startCoord);if(wx(a,e.pixel)<this.snapTolerance_)return}const r=mSe(e.coordinate,n,this.getMap(),this.snapTolerance_);if(n.targetIndex!==r.index){if(n.targetIndex!==-1){const l=n.targets[n.targetIndex];this.removeTracedCoordinates_(l.startIndex,l.endIndex)}const a=n.targets[r.index];this.addTracedCoordinates_(a,a.startIndex,r.endIndex)}else{const a=n.targets[n.targetIndex];this.addOrRemoveTracedCoordinates_(a,r.endIndex)}n.targetIndex=r.index;const i=n.targets[n.targetIndex];i.endIndex=r.endIndex;const s=Hx(i.coordinates,i.endIndex),o=this.getMap().getPixelFromCoordinate(s);e.coordinate=s,e.pixel=[Math.round(o[0]),Math.round(o[1])]}handleDragEvent(e){this.ignoreNextUpEvent_=!0,super.handleDragEvent(e)}handleUpEvent(e){let n=!0;if(this.getPointerCount()===0){this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0),this.handlePointerMove_(e);const r=this.traceState_.active;if(this.ignoreNextUpEvent_||this.toggleTraceState_(e),this.shouldHandle_){const i=!this.finishCoordinate_;i&&this.startDrawing_(e.coordinate),!i&&this.freehand_?this.finishDrawing():!this.freehand_&&(!i||this.mode_==="Point")&&(this.atFinish_(e.pixel,r)?this.finishCondition_(e)&&this.finishDrawing():this.addToDrawing_(e.coordinate)),n=!1}else this.freehand_&&this.abortDrawing()}return this.ignoreNextUpEvent_=!1,!n&&this.stopClick_&&e.preventDefault(),n}handlePointerMove_(e){if(this.pointerType_=e.originalEvent.pointerType,this.downPx_&&(!this.freehand_&&this.shouldHandle_||this.freehand_&&!this.shouldHandle_)){const n=this.downPx_,r=e.pixel,i=n[0]-r[0],s=n[1]-r[1],o=i*i+s*s;if(this.shouldHandle_=this.freehand_?o>this.squaredClickTolerance_:o<=this.squaredClickTolerance_,!this.shouldHandle_)return}if(!this.finishCoordinate_){this.createOrUpdateSketchPoint_(e.coordinate.slice());return}this.updateTrace_(e),this.modifyDrawing_(e.coordinate)}atFinish_(e,n){let r=!1;if(this.sketchFeature_){let i=!1,s=[this.finishCoordinate_];const o=this.mode_;if(o==="Point")r=!0;else if(o==="Circle")r=this.sketchCoords_.length===2;else if(o==="LineString")i=!n&&this.sketchCoords_.length>this.minPoints_;else if(o==="Polygon"){const a=this.sketchCoords_;i=a[0].length>this.minPoints_,s=[a[0][0],a[0][a[0].length-2]],n?s=[a[0][0]]:s=[a[0][0],a[0][a[0].length-2]]}if(i){const a=this.getMap();for(let l=0,c=s.length;l<c;l++){const u=s[l],h=a.getPixelFromCoordinate(u),f=e[0]-h[0],g=e[1]-h[1],y=this.freehand_?1:this.snapTolerance_;if(r=Math.sqrt(f*f+g*g)<=y,r){this.finishCoordinate_=u;break}}}}return r}createOrUpdateSketchPoint_(e){this.sketchPoint_?this.sketchPoint_.getGeometry().setCoordinates(e):(this.sketchPoint_=new gr(new Ti(e)),this.updateSketchFeatures_())}createOrUpdateCustomSketchLine_(e){this.sketchLine_||(this.sketchLine_=new gr);const n=e.getLinearRing(0);let r=this.sketchLine_.getGeometry();r?(r.setFlatCoordinates(n.getLayout(),n.getFlatCoordinates()),r.changed()):(r=new ts(n.getFlatCoordinates(),n.getLayout()),this.sketchLine_.setGeometry(r))}startDrawing_(e){const n=this.getMap().getView().getProjection(),r=L3(this.geometryLayout_);for(;e.length<r;)e.push(0);this.finishCoordinate_=e,this.mode_==="Point"?this.sketchCoords_=e.slice():this.mode_==="Polygon"?(this.sketchCoords_=[[e.slice(),e.slice()]],this.sketchLineCoords_=this.sketchCoords_[0]):this.sketchCoords_=[e.slice(),e.slice()],this.sketchLineCoords_&&(this.sketchLine_=new gr(new ts(this.sketchLineCoords_)));const i=this.geometryFunction_(this.sketchCoords_,void 0,n);this.sketchFeature_=new gr,this.geometryName_&&this.sketchFeature_.setGeometryName(this.geometryName_),this.sketchFeature_.setGeometry(i),this.updateSketchFeatures_(),this.dispatchEvent(new UR(GR.DRAWSTART,this.sketchFeature_))}modifyDrawing_(e){const n=this.getMap(),r=this.sketchFeature_.getGeometry(),i=n.getView().getProjection(),s=L3(this.geometryLayout_);let o,a;for(;e.length<s;)e.push(0);this.mode_==="Point"?a=this.sketchCoords_:this.mode_==="Polygon"?(o=this.sketchCoords_[0],a=o[o.length-1],this.atFinish_(n.getPixelFromCoordinate(e))&&(e=this.finishCoordinate_.slice())):(o=this.sketchCoords_,a=o[o.length-1]),a[0]=e[0],a[1]=e[1],this.geometryFunction_(this.sketchCoords_,r,i),this.sketchPoint_&&this.sketchPoint_.getGeometry().setCoordinates(e),r.getType()==="Polygon"&&this.mode_!=="Polygon"?this.createOrUpdateCustomSketchLine_(r):this.sketchLineCoords_&&this.sketchLine_.getGeometry().setCoordinates(this.sketchLineCoords_),this.updateSketchFeatures_()}addToDrawing_(e){const n=this.sketchFeature_.getGeometry(),r=this.getMap().getView().getProjection();let i,s;const o=this.mode_;return o==="LineString"||o==="Circle"?(this.finishCoordinate_=e.slice(),s=this.sketchCoords_,s.length>=this.maxPoints_&&(this.freehand_?s.pop():i=!0),s.push(e.slice()),this.geometryFunction_(s,n,r)):o==="Polygon"&&(s=this.sketchCoords_[0],s.length>=this.maxPoints_&&(this.freehand_?s.pop():i=!0),s.push(e.slice()),i&&(this.finishCoordinate_=s[0]),this.geometryFunction_(this.sketchCoords_,n,r)),this.createOrUpdateSketchPoint_(e.slice()),this.updateSketchFeatures_(),i?this.finishDrawing():this.sketchFeature_}removeLastPoints_(e){if(!this.sketchFeature_)return;const n=this.sketchFeature_.getGeometry(),r=this.getMap().getView().getProjection(),i=this.mode_;for(let s=0;s<e;++s){let o;if(i==="LineString"||i==="Circle"){if(o=this.sketchCoords_,o.splice(-2,1),o.length>=2){this.finishCoordinate_=o[o.length-2].slice();const a=this.finishCoordinate_.slice();o[o.length-1]=a,this.createOrUpdateSketchPoint_(a)}this.geometryFunction_(o,n,r),n.getType()==="Polygon"&&this.sketchLine_&&this.createOrUpdateCustomSketchLine_(n)}else if(i==="Polygon"){o=this.sketchCoords_[0],o.splice(-2,1);const a=this.sketchLine_.getGeometry();if(o.length>=2){const l=o[o.length-2].slice();o[o.length-1]=l,this.createOrUpdateSketchPoint_(l)}a.setCoordinates(o),this.geometryFunction_(this.sketchCoords_,n,r)}if(o.length===1){this.abortDrawing();break}}this.updateSketchFeatures_()}removeLastPoint(){this.removeLastPoints_(1)}finishDrawing(){const e=this.abortDrawing_();if(!e)return null;let n=this.sketchCoords_;const r=e.getGeometry(),i=this.getMap().getView().getProjection();return this.mode_==="LineString"?(n.pop(),this.geometryFunction_(n,r,i)):this.mode_==="Polygon"&&(n[0].pop(),this.geometryFunction_(n,r,i),n=r.getCoordinates()),this.type_==="MultiPoint"?e.setGeometry(new n0([n])):this.type_==="MultiLineString"?e.setGeometry(new yh([n])):this.type_==="MultiPolygon"&&e.setGeometry(new hp([n])),this.dispatchEvent(new UR(GR.DRAWEND,e)),this.features_&&this.features_.push(e),this.source_&&this.source_.addFeature(e),e}abortDrawing_(){this.finishCoordinate_=null;const e=this.sketchFeature_;return this.sketchFeature_=null,this.sketchPoint_=null,this.sketchLine_=null,this.overlay_.getSource().clear(!0),this.deactivateTrace_(),e}abortDrawing(){const e=this.abortDrawing_();e&&this.dispatchEvent(new UR(GR.DRAWABORT,e))}appendCoordinates(e){const n=this.mode_,r=!this.sketchFeature_;r&&this.startDrawing_(e[0]);let i;if(n==="LineString"||n==="Circle")i=this.sketchCoords_;else if(n==="Polygon")i=this.sketchCoords_&&this.sketchCoords_.length?this.sketchCoords_[0]:[];else return;r&&i.shift(),i.pop();for(let o=0;o<e.length;o++)this.addToDrawing_(e[o]);const s=e[e.length-1];this.sketchFeature_=this.addToDrawing_(s),this.modifyDrawing_(s)}extend(e){const r=e.getGeometry();this.sketchFeature_=e,this.sketchCoords_=r.getCoordinates();const i=this.sketchCoords_[this.sketchCoords_.length-1];this.finishCoordinate_=i.slice(),this.sketchCoords_.push(i.slice()),this.sketchPoint_=new gr(new Ti(i)),this.updateSketchFeatures_(),this.dispatchEvent(new UR(GR.DRAWSTART,this.sketchFeature_))}updateSketchFeatures_(){const e=[];this.sketchFeature_&&e.push(this.sketchFeature_),this.sketchLine_&&e.push(this.sketchLine_),this.sketchPoint_&&e.push(this.sketchPoint_);const n=this.overlay_.getSource();n.clear(!0),n.addFeatures(e)}updateState_(){const e=this.getMap(),n=this.getActive();(!e||!n)&&this.abortDrawing(),this.overlay_.setMap(n?e:null)}}function $kt(){const t=_G();return function(e,n){return t[e.getGeometry().getType()]}}function Fkt(t){switch(t){case"Point":case"MultiPoint":return"Point";case"LineString":case"MultiLineString":return"LineString";case"Polygon":case"MultiPolygon":return"Polygon";case"Circle":return"Circle";default:throw new Error("Invalid type: "+t)}}const Eae=0,ok=1,Sae=[0,0,0,0],Aw=[],_F={MODIFYSTART:"modifystart",MODIFYEND:"modifyend"};function xF(t,e,n){let r;switch(e){case"LineString":r=t;break;case"MultiLineString":case"Polygon":r=t[n[0]];break;case"MultiPolygon":r=t[n[1]][n[0]];break}return r}class wF extends Sc{constructor(e,n,r){super(e),this.features=n,this.mapBrowserEvent=r}}class Vkt extends av{constructor(e){super(e),this.on,this.once,this.un,this.boundHandleFeatureChange_=this.handleFeatureChange_.bind(this),this.condition_=e.condition?e.condition:_ce,this.defaultDeleteCondition_=function(r){return tRe(r)&&yce(r)},this.deleteCondition_=e.deleteCondition?e.deleteCondition:this.defaultDeleteCondition_,this.insertVertexCondition_=e.insertVertexCondition?e.insertVertexCondition:Xx,this.vertexFeature_=null,this.vertexSegments_=null,this.lastCoordinate_=[0,0],this.ignoreNextSingleClick_=!1,this.featuresBeingModified_=null,this.rBush_=new GF,this.pixelTolerance_=e.pixelTolerance!==void 0?e.pixelTolerance:10,this.snappedToVertex_=!1,this.changingFeature_=!1,this.dragSegments_=[],this.overlay_=new Nl({source:new Ml({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.style?e.style:Gkt(),updateWhileAnimating:!0,updateWhileInteracting:!0}),this.SEGMENT_WRITERS_={Point:this.writePointGeometry_.bind(this),LineString:this.writeLineStringGeometry_.bind(this),LinearRing:this.writeLineStringGeometry_.bind(this),Polygon:this.writePolygonGeometry_.bind(this),MultiPoint:this.writeMultiPointGeometry_.bind(this),MultiLineString:this.writeMultiLineStringGeometry_.bind(this),MultiPolygon:this.writeMultiPolygonGeometry_.bind(this),Circle:this.writeCircleGeometry_.bind(this),GeometryCollection:this.writeGeometryCollectionGeometry_.bind(this)},this.source_=null,this.traceSource_=e.traceSource||e.source||null,this.traceCondition_,this.setTrace(e.trace||!1),this.traceState_={active:!1},this.traceSegments_=null,this.hitDetection_=null;let n;if(e.features?n=e.features:e.source&&(this.source_=e.source,n=new Da(this.source_.getFeatures()),this.source_.addEventListener(io.ADDFEATURE,this.handleSourceAdd_.bind(this)),this.source_.addEventListener(io.REMOVEFEATURE,this.handleSourceRemove_.bind(this))),!n)throw new Error("The modify interaction requires features, a source or a layer");e.hitDetection&&(this.hitDetection_=e.hitDetection),this.features_=n,this.features_.forEach(this.addFeature_.bind(this)),this.features_.addEventListener(As.ADD,this.handleFeatureAdd_.bind(this)),this.features_.addEventListener(As.REMOVE,this.handleFeatureRemove_.bind(this)),this.lastPointerEvent_=null,this.delta_=[0,0],this.snapToPointer_=e.snapToPointer===void 0?!this.hitDetection_:e.snapToPointer}setTrace(e){let n;e?e===!0?n=Xx:n=e:n=Z3,this.traceCondition_=n}addFeature_(e){const n=e.getGeometry();if(n){const i=this.SEGMENT_WRITERS_[n.getType()];i&&i(e,n)}const r=this.getMap();r&&r.isRendered()&&this.getActive()&&this.handlePointerAtPixel_(this.lastCoordinate_),e.addEventListener(wn.CHANGE,this.boundHandleFeatureChange_)}willModifyFeatures_(e,n){if(!this.featuresBeingModified_){this.featuresBeingModified_=new Da;const r=this.featuresBeingModified_.getArray();for(let i=0,s=n.length;i<s;++i){const o=n[i].feature;o&&!r.includes(o)&&this.featuresBeingModified_.push(o)}this.featuresBeingModified_.getLength()===0?this.featuresBeingModified_=null:this.dispatchEvent(new wF(_F.MODIFYSTART,this.featuresBeingModified_,e))}}removeFeature_(e){this.removeFeatureSegmentData_(e),this.vertexFeature_&&this.features_.getLength()===0&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),e.removeEventListener(wn.CHANGE,this.boundHandleFeatureChange_)}removeFeatureSegmentData_(e){const n=this.rBush_,r=[];n.forEach(function(i){e===i.feature&&r.push(i)});for(let i=r.length-1;i>=0;--i){const s=r[i];for(let o=this.dragSegments_.length-1;o>=0;--o)this.dragSegments_[o][0]===s&&this.dragSegments_.splice(o,1);n.remove(s)}}setActive(e){this.vertexFeature_&&!e&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),super.setActive(e)}setMap(e){this.overlay_.setMap(e),super.setMap(e)}getOverlay(){return this.overlay_}handleSourceAdd_(e){e.feature&&this.features_.push(e.feature)}handleSourceRemove_(e){e.feature&&this.features_.remove(e.feature)}handleFeatureAdd_(e){this.addFeature_(e.element)}handleFeatureChange_(e){if(!this.changingFeature_){const n=e.target;this.removeFeature_(n),this.addFeature_(n)}}handleFeatureRemove_(e){this.removeFeature_(e.element)}writePointGeometry_(e,n){const r=n.getCoordinates(),i={feature:e,geometry:n,segment:[r,r]};this.rBush_.insert(n.getExtent(),i)}writeMultiPointGeometry_(e,n){const r=n.getCoordinates();for(let i=0,s=r.length;i<s;++i){const o=r[i],a={feature:e,geometry:n,depth:[i],index:i,segment:[o,o]};this.rBush_.insert(n.getExtent(),a)}}writeLineStringGeometry_(e,n){const r=n.getCoordinates();for(let i=0,s=r.length-1;i<s;++i){const o=r.slice(i,i+2),a={feature:e,geometry:n,index:i,segment:o};this.rBush_.insert(ka(o),a)}}writeMultiLineStringGeometry_(e,n){const r=n.getCoordinates();for(let i=0,s=r.length;i<s;++i){const o=r[i];for(let a=0,l=o.length-1;a<l;++a){const c=o.slice(a,a+2),u={feature:e,geometry:n,depth:[i],index:a,segment:c};this.rBush_.insert(ka(c),u)}}}writePolygonGeometry_(e,n){const r=n.getCoordinates();for(let i=0,s=r.length;i<s;++i){const o=r[i];for(let a=0,l=o.length-1;a<l;++a){const c=o.slice(a,a+2),u={feature:e,geometry:n,depth:[i],index:a,segment:c};this.rBush_.insert(ka(c),u)}}}writeMultiPolygonGeometry_(e,n){const r=n.getCoordinates();for(let i=0,s=r.length;i<s;++i){const o=r[i];for(let a=0,l=o.length;a<l;++a){const c=o[a];for(let u=0,h=c.length-1;u<h;++u){const f=c.slice(u,u+2),g={feature:e,geometry:n,depth:[a,i],index:u,segment:f};this.rBush_.insert(ka(f),g)}}}}writeCircleGeometry_(e,n){const r=n.getCenter(),i={feature:e,geometry:n,index:Eae,segment:[r,r]},s={feature:e,geometry:n,index:ok,segment:[r,r]},o=[i,s];i.featureSegments=o,s.featureSegments=o,this.rBush_.insert(ZS(r),i);let a=n;this.rBush_.insert(a.getExtent(),s)}writeGeometryCollectionGeometry_(e,n){const r=n.getGeometriesArray();for(let i=0;i<r.length;++i){const s=r[i],o=this.SEGMENT_WRITERS_[s.getType()];o(e,s)}}createOrUpdateVertexFeature_(e,n,r,i){let s=this.vertexFeature_;return s?s.getGeometry().setCoordinates(e):(s=new gr(new Ti(e)),this.vertexFeature_=s,this.overlay_.getSource().addFeature(s)),s.set("features",n),s.set("geometries",r),s.set("existing",i),s}handleEvent(e){if(!e.originalEvent)return!0;this.lastPointerEvent_=e;let n;return!e.map.getView().getInteracting()&&e.type==or.POINTERMOVE&&!this.handlingDownUpSequence&&this.handlePointerMove_(e),this.vertexFeature_&&this.deleteCondition_(e)&&(e.type!=or.SINGLECLICK||!this.ignoreNextSingleClick_?n=this.removePoint():n=!0),e.type==or.SINGLECLICK&&(this.ignoreNextSingleClick_=!1),super.handleEvent(e)&&!n}findInsertVerticesAndUpdateDragSegments_(e){if(this.handlePointerAtPixel_(e),this.dragSegments_.length=0,this.featuresBeingModified_=null,!this.vertexFeature_)return;this.getMap().getView().getProjection();const r=[],i=this.vertexFeature_.getGeometry().getCoordinates(),s=ka([i]),o=this.rBush_.getInExtent(s),a={};o.sort(zkt);for(let l=0,c=o.length;l<c;++l){const u=o[l],h=u.segment;let f=Qt(u.geometry);const g=u.depth;if(g&&(f+="-"+g.join("-")),a[f]||(a[f]=new Array(2)),u.geometry.getType()==="Circle"&&u.index===ok){const y=kae(e,u);Ia(y,i)&&!a[f][0]&&(this.dragSegments_.push([u,0]),a[f][0]=u);continue}if(Ia(h[0],i)&&!a[f][0]){this.dragSegments_.push([u,0]),a[f][0]=u;continue}if(Ia(h[1],i)&&!a[f][1]){if(a[f][0]&&a[f][0].index===0){let y=u.geometry.getCoordinates();switch(u.geometry.getType()){case"LineString":case"MultiLineString":continue;case"MultiPolygon":y=y[g[1]];case"Polygon":if(u.index!==y[g[0]].length-2)continue;break}}this.dragSegments_.push([u,1]),a[f][1]=u;continue}Qt(h)in this.vertexSegments_&&!a[f][0]&&!a[f][1]&&r.push(u)}return r}deactivateTrace_(){this.traceState_={active:!1}}updateTrace_(e){const n=this.traceState_;if(!n.active)return;if(n.targetIndex===-1){const s=e.map.getPixelFromCoordinate(n.startCoord);if(wx(s,e.pixel)<this.pixelTolerance_)return}const r=mSe(e.coordinate,n,e.map,this.pixelTolerance_);if(n.targetIndex===-1&&Math.sqrt(r.closestTargetDistance)/e.map.getView().getResolution()>this.pixelTolerance_)return;if(n.targetIndex!==r.index){if(n.targetIndex!==-1){const o=n.targets[n.targetIndex];this.removeTracedCoordinates_(o.startIndex,o.endIndex)}else for(const o of this.traceSegments_){const a=o[0],l=a.geometry,c=o[1],u=l.getCoordinates();xF(u,l.getType(),a.depth).splice(a.index+c,1),l.setCoordinates(u),c===0&&(a.index-=1)}const s=n.targets[r.index];this.addTracedCoordinates_(s,s.startIndex,r.endIndex)}else{const s=n.targets[n.targetIndex];this.addOrRemoveTracedCoordinates_(s,r.endIndex)}n.targetIndex=r.index;const i=n.targets[n.targetIndex];i.endIndex=r.endIndex}getTraceCandidates_(e){const n=this.getMap(),r=this.pixelTolerance_,i=n.getCoordinateFromPixel([e.pixel[0]-r,e.pixel[1]+r]),s=n.getCoordinateFromPixel([e.pixel[0]+r,e.pixel[1]-r]),o=ka([i,s]);return this.traceSource_.getFeaturesInExtent(o)}toggleTraceState_(e){if(!this.traceSource_||!this.traceCondition_(e))return;if(this.traceState_.active){this.deactivateTrace_(),this.traceSegments_=null;return}const n=this.getTraceCandidates_(e);if(n.length===0)return;const r=gSe(e.coordinate,n);r.length&&(this.traceState_={active:!0,startCoord:e.coordinate.slice(),targets:r,targetIndex:-1})}addOrRemoveTracedCoordinates_(e,n){const r=e.startIndex<=e.endIndex,i=e.startIndex<=n;r===i?r&&n>e.endIndex||!r&&n<e.endIndex?this.addTracedCoordinates_(e,e.endIndex,n):(r&&n<e.endIndex||!r&&n>e.endIndex)&&this.removeTracedCoordinates_(n,e.endIndex):(this.removeTracedCoordinates_(e.startIndex,e.endIndex),this.addTracedCoordinates_(e,e.startIndex,n))}removeTracedCoordinates_(e,n){if(e===n)return;let r=0;if(e<n){const i=Math.ceil(e);let s=Math.floor(n);s===n&&(s-=1),r=s-i+1}else{const i=Math.floor(e);let s=Math.ceil(n);s===n&&(s+=1),r=i-s+1}if(r>0)for(const i of this.traceSegments_){const s=i[0],o=s.geometry,a=i[1];let l=i[0].index+1;a===1&&(l-=r);const c=o.getCoordinates();xF(c,o.getType(),s.depth).splice(l,r),o.setCoordinates(c),a===1&&(s.index-=r)}}addTracedCoordinates_(e,n,r){if(n===r)return;const i=[];if(n<r){const s=Math.ceil(n);let o=Math.floor(r);o===r&&(o-=1);for(let a=s;a<=o;++a)i.push(dg(e.coordinates,a))}else{const s=Math.floor(n);let o=Math.ceil(r);o===r&&(o+=1);for(let a=s;a>=o;--a)i.push(dg(e.coordinates,a))}if(i.length)for(const s of this.traceSegments_){const o=s[0],a=o.geometry,l=s[1],c=o.index+1;l===0&&i.reverse();const u=a.getCoordinates();xF(u,a.getType(),o.depth).splice(c,0,...i),a.setCoordinates(u),l===1&&(o.index+=i.length)}}updateGeometry_(e,n){const r=n[0],i=r.depth;let s;const o=r.segment,a=r.geometry,l=n[1];for(;e.length<a.getStride();)e.push(o[l][e.length]);switch(a.getType()){case"Point":s=e,o[0]=e,o[1]=e;break;case"MultiPoint":s=a.getCoordinates(),s[r.index]=e,o[0]=e,o[1]=e;break;case"LineString":s=a.getCoordinates(),s[r.index+l]=e,o[l]=e;break;case"MultiLineString":s=a.getCoordinates(),s[i[0]][r.index+l]=e,o[l]=e;break;case"Polygon":s=a.getCoordinates(),s[i[0]][r.index+l]=e,o[l]=e;break;case"MultiPolygon":s=a.getCoordinates(),s[i[1]][i[0]][r.index+l]=e,o[l]=e;break;case"Circle":const c=a;if(o[0]=e,o[1]=e,r.index===Eae)this.changingFeature_=!0,c.setCenter(e),this.changingFeature_=!1;else{this.changingFeature_=!0,this.getMap().getView().getProjection();let u=wx(Li(c.getCenter()),Li(e));c.setRadius(u),this.changingFeature_=!1}break}s&&this.setGeometryCoordinates_(a,s)}handleDragEvent(e){this.ignoreNextSingleClick_=!1,this.willModifyFeatures_(e,this.dragSegments_.map(([o])=>o));const n=[e.coordinate[0]+this.delta_[0],e.coordinate[1]+this.delta_[1]],r=[],i=[],s=this.traceState_.active&&!this.traceSegments_?this.traceState_.startCoord:null;if(s){this.traceSegments_=[];for(const o of this.dragSegments_){const a=o[0];wx(qz(s,a.segment),s)/e.map.getView().getResolution()<1&&this.traceSegments_.push(o)}}for(let o=0,a=this.dragSegments_.length;o<a;++o){const l=this.dragSegments_[o],c=l[0],u=c.feature;r.includes(u)||r.push(u);const h=c.geometry;i.includes(h)||i.push(h),this.updateGeometry_(n,l)}this.updateTrace_(e),this.createOrUpdateVertexFeature_(n,r,i,!0)}handleDownEvent(e){if(!this.condition_(e))return!1;const n=e.coordinate,r=this.findInsertVerticesAndUpdateDragSegments_(n);if(r?.length&&this.insertVertexCondition_(e)&&(this.willModifyFeatures_(e,r),this.vertexFeature_)){const i=this.vertexFeature_.getGeometry().getCoordinates();for(let s=r.length-1;s>=0;--s)this.insertVertex_(r[s],i);this.ignoreNextSingleClick_=!0}return!!this.vertexFeature_}handleUpEvent(e){for(let n=this.dragSegments_.length-1;n>=0;--n){const r=this.dragSegments_[n][0],i=r.geometry;if(i.getType()==="Circle"){const s=i,o=s.getCenter(),a=r.featureSegments[0],l=r.featureSegments[1];a.segment[0]=o,a.segment[1]=o,l.segment[0]=o,l.segment[1]=o,this.rBush_.update(ZS(o),a);let c=s;this.rBush_.update(c.getExtent(),l)}else this.rBush_.update(ka(r.segment),r)}return this.featuresBeingModified_&&(this.toggleTraceState_(e),this.dispatchEvent(new wF(_F.MODIFYEND,this.featuresBeingModified_,e)),this.featuresBeingModified_=null),!1}handlePointerMove_(e){this.lastCoordinate_=e.coordinate,this.handlePointerAtPixel_(this.lastCoordinate_)}handlePointerAtPixel_(e){const n=this.getMap(),r=n.getPixelFromCoordinate(e);n.getView().getProjection();const i=function(a,l){return Tae(e,a)-Tae(e,l)};let s,o;if(this.hitDetection_){const a=typeof this.hitDetection_=="object"?l=>l===this.hitDetection_:void 0;n.forEachFeatureAtPixel(r,(l,c,u)=>{u&&u.getType()==="Point"&&(u=new Ti(b1(u.getCoordinates())));const h=u||l.getGeometry();if(h&&h.getType()==="Point"&&l instanceof gr&&this.features_.getArray().includes(l)){o=h;const f=l.getGeometry().getFlatCoordinates().slice(0,2);s=[{feature:l,geometry:o,segment:[f,f]}]}return!0},{layerFilter:a})}if(!s){const a=sh(ZS(e,Sae)),l=n.getView().getResolution()*this.pixelTolerance_,c=tG(ih(a,l,Sae));s=this.rBush_.getInExtent(c)}if(s&&s.length>0){const a=s.sort(i)[0],l=a.segment;let c=kae(e,a);const u=n.getPixelFromCoordinate(c);let h=wx(r,u);if(o||h<=this.pixelTolerance_){const f={};if(f[Qt(l)]=!0,this.snapToPointer_||(this.delta_[0]=c[0]-e[0],this.delta_[1]=c[1]-e[1]),a.geometry.getType()==="Circle"&&a.index===ok)this.snappedToVertex_=!0,this.createOrUpdateVertexFeature_(c,[a.feature],[a.geometry],this.snappedToVertex_);else{const g=n.getPixelFromCoordinate(l[0]),y=n.getPixelFromCoordinate(l[1]),_=Yw(u,g),b=Yw(u,y);if(h=Math.sqrt(Math.min(_,b)),this.snappedToVertex_=h<=this.pixelTolerance_,!this.snappedToVertex_&&!this.insertVertexCondition_(this.lastPointerEvent_)){this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null);return}this.snappedToVertex_&&(c=_>b?l[1]:l[0]),this.createOrUpdateVertexFeature_(c,[a.feature],[a.geometry],this.snappedToVertex_);const T={};T[Qt(a.geometry)]=!0;for(let A=1,I=s.length;A<I;++A){const P=s[A].segment;if(Ia(l[0],P[0])&&Ia(l[1],P[1])||Ia(l[0],P[1])&&Ia(l[1],P[0])){const R=Qt(s[A].geometry);R in T||(T[R]=!0,f[Qt(P)]=!0)}else break}}this.vertexSegments_=f;return}}this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)}insertVertex_(e,n){const r=e.segment,i=e.feature,s=e.geometry,o=e.depth,a=e.index;let l;for(;n.length<s.getStride();)n.push(0);switch(s.getType()){case"MultiLineString":l=s.getCoordinates(),l[o[0]].splice(a+1,0,n);break;case"Polygon":l=s.getCoordinates(),l[o[0]].splice(a+1,0,n);break;case"MultiPolygon":l=s.getCoordinates(),l[o[1]][o[0]].splice(a+1,0,n);break;case"LineString":l=s.getCoordinates(),l.splice(a+1,0,n);break;default:return!1}this.setGeometryCoordinates_(s,l);const c=this.rBush_;c.remove(e),this.updateSegmentIndices_(s,a,o,1);const u={segment:[r[0],n],feature:i,geometry:s,depth:o,index:a};c.insert(ka(u.segment),u),this.dragSegments_.push([u,1]);const h={segment:[n,r[1]],feature:i,geometry:s,depth:o,index:a+1};return c.insert(ka(h.segment),h),this.dragSegments_.push([h,0]),!0}updatePointer_(e){return e&&this.findInsertVerticesAndUpdateDragSegments_(e),this.vertexFeature_?.getGeometry().getCoordinates()}getPoint(){const e=this.vertexFeature_?.getGeometry().getCoordinates();return e?b1(e,this.getMap().getView().getProjection()):null}canRemovePoint(){if(!this.vertexFeature_||this.vertexFeature_.get("geometries").every(r=>r.getType()==="Circle"||r.getType().endsWith("Point")))return!1;const e=this.vertexFeature_.getGeometry().getCoordinates();return this.rBush_.getInExtent(ka([e])).some(({segment:r})=>Ia(r[0],e)||Ia(r[1],e))}removePoint(e){if(e&&(e=Li(e,this.getMap().getView().getProjection()),this.updatePointer_(e)),!this.lastPointerEvent_||this.lastPointerEvent_&&this.lastPointerEvent_.type!=or.POINTERDRAG){const n=this.lastPointerEvent_;this.willModifyFeatures_(n,this.dragSegments_.map(([i])=>i));const r=this.removeVertex_();return this.featuresBeingModified_&&this.dispatchEvent(new wF(_F.MODIFYEND,this.featuresBeingModified_,n)),this.featuresBeingModified_=null,r}return!1}removeVertex_(){const e=this.dragSegments_,n={};let r=!1,i,s,o,a,l,c,u,h,f,g,y;for(l=e.length-1;l>=0;--l)o=e[l],g=o[0],y=Qt(g.feature),g.depth&&(y+="-"+g.depth.join("-")),y in n||(n[y]={}),o[1]===0?(n[y].right=g,n[y].index=g.index):o[1]==1&&(n[y].left=g,n[y].index=g.index+1);for(y in n){switch(f=n[y].right,u=n[y].left,c=n[y].index,h=c-1,u!==void 0?g=u:g=f,h<0&&(h=0),a=g.geometry,s=a.getCoordinates(),i=s,r=!1,a.getType()){case"MultiLineString":s[g.depth[0]].length>2&&(s[g.depth[0]].splice(c,1),r=!0);break;case"LineString":s.length>2&&(s.splice(c,1),r=!0);break;case"MultiPolygon":i=i[g.depth[1]];case"Polygon":i=i[g.depth[0]],i.length>4&&(c==i.length-1&&(c=0),i.splice(c,1),r=!0,c===0&&(i.pop(),i.push(i[0]),h=i.length-1));break}if(r){this.setGeometryCoordinates_(a,s);const _=[];if(u!==void 0&&(this.rBush_.remove(u),_.push(u.segment[0])),f!==void 0&&(this.rBush_.remove(f),_.push(f.segment[1])),u!==void 0&&f!==void 0){const b={depth:g.depth,feature:g.feature,geometry:g.geometry,index:h,segment:_};this.rBush_.insert(ka(b.segment),b)}this.updateSegmentIndices_(a,c,g.depth,-1),this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),e.length=0}}return r}canInsertPoint(){if(!this.vertexFeature_||this.vertexFeature_.get("geometries").every(r=>r.getType()==="Circle"||r.getType().endsWith("Point")))return!1;const e=this.vertexFeature_.getGeometry().getCoordinates();return this.rBush_.getInExtent(ka([e])).some(({segment:r})=>!(Ia(r[0],e)||Ia(r[1],e)))}insertPoint(e){const n=e?Li(e,this.getMap().getView().getProjection()):this.vertexFeature_?.getGeometry().getCoordinates();return n?this.findInsertVerticesAndUpdateDragSegments_(n).reduce((i,s)=>i||this.insertVertex_(s,n),!1):!1}setGeometryCoordinates_(e,n){this.changingFeature_=!0,e.setCoordinates(n),this.changingFeature_=!1}updateSegmentIndices_(e,n,r,i){this.rBush_.forEachInExtent(e.getExtent(),function(s){s.geometry===e&&(r===void 0||s.depth===void 0||zd(s.depth,r))&&s.index>n&&(s.index+=i)})}}function zkt(t,e){return t.index-e.index}function Tae(t,e,n){const r=e.geometry;if(r.getType()==="Circle"){let s=r;if(e.index===ok){const o=Yw(s.getCenter(),Li(t)),a=Math.sqrt(o)-s.getRadius();return a*a}}const i=Li(t);return Aw[0]=Li(e.segment[0]),Aw[1]=Li(e.segment[1]),QTe(i,Aw)}function kae(t,e,n){const r=e.geometry;if(r.getType()==="Circle"&&e.index===ok)return b1(r.getClosestPoint(Li(t)));const i=Li(t);return Aw[0]=Li(e.segment[0]),Aw[1]=Li(e.segment[1]),b1(qz(i,Aw))}function Gkt(){const t=_G();return function(e,n){return t.Point}}const BR={SELECT:"select"};class WR extends Sc{constructor(e,n,r,i){super(e),this.selected=n,this.deselected=r,this.mapBrowserEvent=i}}const HR={};class Bq extends X2{constructor(e){super(),this.on,this.once,this.un,e=e||{},this.boundAddFeature_=this.addFeature_.bind(this),this.boundRemoveFeature_=this.removeFeature_.bind(this),this.condition_=e.condition?e.condition:yce,this.addCondition_=e.addCondition?e.addCondition:Z3,this.removeCondition_=e.removeCondition?e.removeCondition:Z3,this.toggleCondition_=e.toggleCondition?e.toggleCondition:J3,this.multi_=e.multi?e.multi:!1,this.filter_=e.filter?e.filter:Cg,this.hitTolerance_=e.hitTolerance?e.hitTolerance:0,this.style_=e.style!==void 0?e.style:Ukt(),this.features_=e.features||new Da;let n;if(e.layers)if(typeof e.layers=="function")n=e.layers;else{const r=e.layers;n=function(i){return r.includes(i)}}else n=Cg;this.layerFilter_=n,this.featureLayerAssociation_={}}addFeatureLayerAssociation_(e,n){this.featureLayerAssociation_[Qt(e)]=n}getFeatures(){return this.features_}getHitTolerance(){return this.hitTolerance_}getLayer(e){return this.featureLayerAssociation_[Qt(e)]}setHitTolerance(e){this.hitTolerance_=e}setMap(e){this.getMap()&&this.style_&&this.features_.forEach(this.restorePreviousStyle_.bind(this)),super.setMap(e),e?(this.features_.addEventListener(As.ADD,this.boundAddFeature_),this.features_.addEventListener(As.REMOVE,this.boundRemoveFeature_),this.style_&&this.features_.forEach(this.applySelectedStyle_.bind(this))):(this.features_.removeEventListener(As.ADD,this.boundAddFeature_),this.features_.removeEventListener(As.REMOVE,this.boundRemoveFeature_))}addFeature_(e){const n=e.element;if(this.style_&&this.applySelectedStyle_(n),!this.getLayer(n)){const r=this.findLayerOfFeature_(n);r&&this.addFeatureLayerAssociation_(n,r)}}removeFeature_(e){this.style_&&this.restorePreviousStyle_(e.element)}findLayerOfFeature_(e){return this.getMap().getAllLayers().find(function(r){if(r instanceof Nl&&r.getSource()&&r.getSource().hasFeature(e))return r})}getStyle(){return this.style_}applySelectedStyle_(e){const n=Qt(e);n in HR||(HR[n]=e.getStyle()),e.setStyle(this.style_)}restorePreviousStyle_(e){const n=this.getMap().getInteractions().getArray();for(let i=n.length-1;i>=0;--i){const s=n[i];if(s!==this&&s instanceof Bq&&s.getStyle()&&s.getFeatures().getArray().lastIndexOf(e)!==-1){e.setStyle(s.getStyle());return}}const r=Qt(e);e.setStyle(HR[r]),delete HR[r]}removeFeatureLayerAssociation_(e){delete this.featureLayerAssociation_[Qt(e)]}selectFeatureInternal_(e,n,r){if(!(e instanceof gr)||!this.filter_(e,n))return;const i=this.getFeatures();return i.getArray().includes(e)||(this.addFeatureLayerAssociation_(e,n),i.push(e),r?.push(e)),e}selectFeature(e){const n=this.findLayerOfFeature_(e);if(!this.layerFilter_(n))return!1;const r=this.selectFeatureInternal_(e,n);return r&&this.dispatchEvent(new WR(BR.SELECT,[r],[],void 0)),!!r}removeFeatureInternal_(e,n){const r=this.getFeatures();if(!(!(e instanceof gr)||!r.getArray().includes(e)))return r.remove(e),this.removeFeatureLayerAssociation_(e),n?.push(e),e}deselectFeature(e){const n=this.removeFeatureInternal_(e);return n&&this.dispatchEvent(new WR(BR.SELECT,[],[n],void 0)),!!n}toggleFeature(e){this.deselectFeature(e)||this.selectFeature(e)}clearSelection(){nv(this.featureLayerAssociation_);const e=this.getFeatures(),n=e.getArray().slice();e.clear(),n.length!==0&&this.dispatchEvent(new WR(BR.SELECT,[],n,void 0))}handleEvent(e){if(!this.condition_(e))return!0;const n=this.addCondition_(e),r=this.removeCondition_(e),i=this.toggleCondition_(e),s=!n&&!r&&!i,o=e.map,a=this.getFeatures(),l=[],c=[];if(s){let u=!1;o.forEachFeatureAtPixel(e.pixel,(h,f)=>{if(u=!0,!!this.selectFeatureInternal_(h,f,c))return!this.multi_},{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(let h=a.getLength()-1;h>=0;--h){const f=a.item(h);(c.length>0&&!c.includes(f)||!u)&&this.removeFeatureInternal_(f,l)}}else o.forEachFeatureAtPixel(e.pixel,(u,h)=>{let f;if((r||i)&&(f=this.removeFeatureInternal_(u,l)),(n||i)&&!f&&(f=this.selectFeatureInternal_(u,h,c)),!!f)return!this.multi_},{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});return(c.length>0||l.length>0)&&this.dispatchEvent(new WR(BR.SELECT,c,l,e)),!0}}function Ukt(){const t=_G();return _r(t.Polygon,t.LineString),_r(t.GeometryCollection,t.LineString),function(e){return e.getGeometry()?t[e.getGeometry().getType()]:null}}function Bkt(){const t=gi(g=>g.map),[e,n]=Y.useState(!1),[r,i]=Y.useState(null),[s,o]=Y.useState(0),a=Y.useRef(null),l=Y.useRef(null),c=Y.useRef(null),u=Y.useRef(null);Y.useEffect(()=>{if(!t)return;const g=new Ml;l.current=g;const y=new Nl({source:g,style:Wkt,zIndex:1e3,properties:{name:"measure-layer"}});return a.current=y,t.addLayer(y),()=>{a.current&&t.removeLayer(a.current)}},[t]),Y.useEffect(()=>{if(!(!t||!l.current)&&e){const g=new _Se({source:l.current,type:"LineString",style:Hkt});c.current=g;let y=null;return g.on("drawstart",_=>{y=_.feature,i(null);const b=y.getGeometry();b&&(u.current=b.on("change",()=>{const A=ck(b,{projection:"EPSG:3857"});i(Aae(A))}))}),g.on("drawend",_=>{u.current&&(TF(u.current),u.current=null);const b=_.feature.getGeometry(),T=ck(b,{projection:"EPSG:3857"}),A=Aae(T);_.feature.set("distance",A),i(A),o(I=>I+1),y=null}),t.addInteraction(g),()=>{c.current&&(t.removeInteraction(c.current),c.current=null),u.current&&(TF(u.current),u.current=null)}}},[t,e]);const h=()=>{n(!e),e&&i(null)},f=()=>{l.current&&(l.current.clear(),o(0),i(null))};return p.jsxs(p.Fragment,{children:[p.jsx(_t.button,{onClick:h,className:`fixed bottom-[172px] left-2 z-[800] w-11 h-11 flex items-center justify-center rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm ${e?"bg-blue-500 text-white":"bg-white/80 hover:bg-white/90 text-gray-600"}`,whileHover:{scale:1.05},whileTap:{scale:.95},title:"Afstanden meten",children:p.jsx(X1,{size:20})}),p.jsx(qn,{children:e&&p.jsxs(_t.div,{initial:{opacity:0,x:-10,scale:.95},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:-10,scale:.95},transition:{duration:.15},className:"fixed bottom-[172px] left-[56px] z-[801] bg-white/95 rounded-xl shadow-lg backdrop-blur-sm overflow-hidden min-w-[180px]",children:[p.jsxs("div",{className:"flex items-center justify-between gap-2 px-3 py-1.5 bg-blue-500",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(X1,{size:14,className:"text-white"}),p.jsx("span",{className:"font-medium text-white text-xs",children:"Meten"})]}),p.jsx("button",{onClick:h,className:"p-0.5 rounded hover:bg-white/20 transition-colors border-0 outline-none",children:p.jsx(Qr,{size:14,className:"text-white"})})]}),p.jsxs("div",{className:"p-3 space-y-2",children:[p.jsx("p",{className:"text-xs text-gray-500",children:"Klik op de kaart om te meten. Dubbelklik om te stoppen."}),r&&p.jsxs("div",{className:"bg-blue-50 rounded-lg p-2",children:[p.jsx("div",{className:"text-xs text-blue-600 font-medium",children:"Afstand"}),p.jsx("div",{className:"text-lg font-bold text-blue-700",children:r})]}),s>0&&p.jsxs("button",{onClick:f,className:"w-full flex items-center justify-center gap-1.5 px-3 py-1.5 text-xs text-red-600 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none",children:[p.jsx(Sh,{size:12}),"Wis metingen (",s,")"]})]})]})})]})}function Aae(t){return t>=1e3?`${(t/1e3).toFixed(2)} km`:`${Math.round(t)} m`}function Wkt(t){const e=t.get("distance");return new vn({stroke:new Pn({color:"#3b82f6",width:3,lineDash:[10,10]}),image:new ms({radius:5,fill:new Dn({color:"#3b82f6"}),stroke:new Pn({color:"#ffffff",width:2})}),text:e?new fc({text:e,font:"bold 12px sans-serif",fill:new Dn({color:"#1e40af"}),stroke:new Pn({color:"#ffffff",width:3}),offsetY:-15,placement:"line",overflow:!0}):void 0})}function Hkt(){return new vn({stroke:new Pn({color:"#ef4444",width:3,lineDash:[10,10]}),image:new ms({radius:5,fill:new Dn({color:"#ef4444"}),stroke:new Pn({color:"#ffffff",width:2})})})}const bF="Mijn Tekeningen";function qkt(){const t=gi(R=>R.map),[e,n]=Y.useState(!1),[r,i]=Y.useState("select"),[s,o]=Y.useState(0),[a,l]=Y.useState(null),{layers:c,addLayer:u,addPoint:h,getLayer:f}=ps(),g=Y.useRef(null),y=Y.useRef(null),_=Y.useRef(null),b=Y.useRef(null),T=Y.useRef(null);Y.useEffect(()=>{if(!t)return;const R=new Ml;y.current=R;const D=new Nl({source:R,style:Kkt,zIndex:999,properties:{name:"draw-preview-layer"}});return g.current=D,t.addLayer(D),()=>{g.current&&t.removeLayer(g.current)}},[t]),Y.useEffect(()=>{if(!(!t||!y.current)&&(_.current&&(t.removeInteraction(_.current),_.current=null),b.current&&(t.removeInteraction(b.current),b.current=null),T.current&&(t.removeInteraction(T.current),T.current=null),!!e))if(r==="select"){const R=new Bq({layers:[g.current],style:Xkt});b.current=R;const D=new Vkt({features:R.getFeatures()});T.current=D,t.addInteraction(R),t.addInteraction(D);const C=M=>{if(M.key==="Delete"||M.key==="Backspace"){const O=R.getFeatures();O.forEach(j=>{y.current?.removeFeature(j)}),O.clear(),o(y.current?.getFeatures().length||0)}};return document.addEventListener("keydown",C),()=>{document.removeEventListener("keydown",C),b.current&&t.removeInteraction(b.current),T.current&&t.removeInteraction(T.current)}}else{const R=r==="point"?"Point":r==="line"?"LineString":"Polygon",D=new _Se({source:y.current,type:R,style:Ykt});return _.current=D,D.on("drawstart",C=>{l(null);const M=C.feature.getGeometry();M&&M.on("change",()=>{if(r==="line"){const O=ck(M,{projection:"EPSG:3857"});l(Iae(O))}else if(r==="polygon"){const O=RF(M,{projection:"EPSG:3857"});l(Pae(O))}})}),D.on("drawend",C=>{const M=C.feature.getGeometry();if(r==="line"&&M){const O=ck(M,{projection:"EPSG:3857"});C.feature.set("measurement",Iae(O))}else if(r==="polygon"&&M){const O=RF(M,{projection:"EPSG:3857"});C.feature.set("measurement",Pae(O))}C.feature.set("drawType",r),o(O=>O+1),l(null)}),t.addInteraction(D),()=>{_.current&&t.removeInteraction(_.current)}}},[t,e,r]);const A=()=>{if(e){if(s>0&&!confirm("Tekeningen verwijderen? Klik eerst op Opslaan om te bewaren."))return;I()}n(!e),i("select"),l(null)},I=()=>{y.current&&(y.current.clear(),o(0),l(null))},P=()=>{if(!y.current||s===0)return;let R=c.find(M=>M.name===bF);if(!R){const M=ps.getState().addLayer(bF,["Punt","Lijn","Vlak"]);R=ps.getState().getLayer(M)}if(!R){alert("Kon tekeningen laag niet aanmaken");return}const D=y.current.getFeatures();let C=0;D.forEach((M,O)=>{const j=M.getGeometry();if(!j)return;const V=M.get("drawType")||"point",U=M.get("measurement");let G,de;if(j.getType()==="Point"){const ze=j.getCoordinates();G=Fn(ze)}else if(j.getType()==="LineString"){const ze=j.getCoordinates(),Ne=Math.floor(ze.length/2);G=Fn(ze[Ne]),de={type:"LineString",coordinates:ze.map(fe=>Fn(fe))}}else if(j.getType()==="Polygon"){const ze=j.getCoordinates(),Ne=j.getExtent(),fe=[(Ne[0]+Ne[2])/2,(Ne[1]+Ne[3])/2];G=Fn(fe),de={type:"Polygon",coordinates:ze.map(De=>De.map(Ce=>Fn(Ce)))}}else return;const Ie={point:"Punt",line:"Lijn",polygon:"Vlak",select:"Punt"};h(R.id,{name:`Tekening ${new Date().toLocaleDateString("nl-NL")} #${O+1}`,category:Ie[V],notes:U?`Afmeting: ${U}`:"",coordinates:G,geometry:de}),C++}),alert(`${C} tekening(en) opgeslagen naar "${bF}"`),I(),n(!1)};return p.jsxs(p.Fragment,{children:[p.jsx(_t.button,{onClick:A,className:`fixed bottom-[116px] left-2 z-[800] w-11 h-11 flex items-center justify-center rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm ${e?"bg-orange-500 text-white":"bg-white/80 hover:bg-white/90 text-gray-600"}`,whileHover:{scale:1.05},whileTap:{scale:.95},title:"Tekenen op de kaart",children:p.jsx(Kg,{size:20})}),p.jsx(qn,{children:e&&p.jsxs(_t.div,{initial:{opacity:0,x:-10,scale:.95},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:-10,scale:.95},transition:{duration:.15},className:"fixed bottom-[116px] left-[56px] z-[801] bg-white/95 rounded-xl shadow-lg backdrop-blur-sm overflow-hidden min-w-[200px]",children:[p.jsxs("div",{className:"flex items-center justify-between gap-2 px-3 py-1.5 bg-orange-500",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(Kg,{size:14,className:"text-white"}),p.jsx("span",{className:"font-medium text-white text-xs",children:"Tekenen"})]}),p.jsx("button",{onClick:A,className:"p-0.5 rounded hover:bg-white/20 transition-colors border-0 outline-none",children:p.jsx(Qr,{size:14,className:"text-white"})})]}),p.jsxs("div",{className:"p-3 space-y-3",children:[p.jsxs("div",{className:"flex gap-1",children:[p.jsx(qR,{icon:p.jsx(g2e,{size:16}),active:r==="select",onClick:()=>i("select"),title:"Selecteren/Bewerken"}),p.jsx(qR,{icon:p.jsx(oct,{size:16}),active:r==="point",onClick:()=>i("point"),title:"Punt tekenen"}),p.jsx(qR,{icon:p.jsx(YH,{size:16}),active:r==="line",onClick:()=>i("line"),title:"Lijn tekenen"}),p.jsx(qR,{icon:p.jsx(b2e,{size:16}),active:r==="polygon",onClick:()=>i("polygon"),title:"Vlak tekenen"})]}),p.jsx("p",{className:"text-xs text-gray-500",children:r==="select"?"Klik om te selecteren, Delete om te verwijderen":r==="point"?"Klik om een punt te plaatsen":"Klik om te tekenen, dubbelklik om te voltooien"}),a&&p.jsxs("div",{className:"bg-orange-50 rounded-lg p-2",children:[p.jsx("div",{className:"text-xs text-orange-600 font-medium",children:r==="polygon"?"Oppervlakte":"Afstand"}),p.jsx("div",{className:"text-lg font-bold text-orange-700",children:a})]}),s>0&&p.jsxs("div",{className:"flex gap-2",children:[p.jsxs("button",{onClick:P,className:"flex-1 flex items-center justify-center gap-1.5 px-3 py-1.5 text-xs text-white bg-orange-500 hover:bg-orange-600 rounded-lg transition-colors border-0 outline-none",children:[p.jsx(XH,{size:12}),"Opslaan (",s,")"]}),p.jsx("button",{onClick:()=>{confirm("Alle tekeningen verwijderen?")&&I()},className:"flex items-center justify-center gap-1.5 px-3 py-1.5 text-xs text-red-600 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none",children:p.jsx(Sh,{size:12})})]})]})]})})]})}function qR({icon:t,active:e,onClick:n,title:r}){return p.jsx("button",{onClick:n,className:`w-9 h-9 flex items-center justify-center rounded-lg transition-colors border-0 outline-none ${e?"bg-orange-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,title:r,children:t})}function Iae(t){return t>=1e3?`${(t/1e3).toFixed(2)} km`:`${Math.round(t)} m`}function Pae(t){return t>=1e4?`${(t/1e4).toFixed(2)} ha`:`${Math.round(t)} m`}function Kkt(t){const e=t.get("measurement"),n=t.get("drawType"),r={stroke:new Pn({color:"#f97316",width:3}),fill:new Dn({color:"rgba(249, 115, 22, 0.2)"}),image:new ms({radius:6,fill:new Dn({color:"#f97316"}),stroke:new Pn({color:"#ffffff",width:2})})};return new vn({...r,text:e?new fc({text:e,font:"bold 11px sans-serif",fill:new Dn({color:"#c2410c"}),stroke:new Pn({color:"#ffffff",width:3}),offsetY:n==="polygon"?0:-15,placement:n==="line"?"line":"point",overflow:!0}):void 0})}function Ykt(){return new vn({stroke:new Pn({color:"#ea580c",width:3,lineDash:[10,10]}),fill:new Dn({color:"rgba(234, 88, 12, 0.1)"}),image:new ms({radius:5,fill:new Dn({color:"#ea580c"}),stroke:new Pn({color:"#ffffff",width:2})})})}function Xkt(){return new vn({stroke:new Pn({color:"#2563eb",width:4}),fill:new Dn({color:"rgba(37, 99, 235, 0.2)"}),image:new ms({radius:8,fill:new Dn({color:"#2563eb"}),stroke:new Pn({color:"#ffffff",width:2})})})}function Zkt(){const t=gi(f=>f.map),[e,n]=Y.useState(!1),[r,i]=Y.useState(!1),[s,o]=Y.useState("png"),[a,l]=Y.useState(!0),[c,u]=Y.useState("Kaart Export"),h=async()=>{if(t){i(!0);try{const f=t.getTargetElement();if(!f)throw new Error("Map target not found");const g=f.querySelector("canvas");if(!g)throw new Error("Canvas not found");const y=document.createElement("canvas"),_=y.getContext("2d");if(!_)throw new Error("Could not get canvas context");const b=a?50:0;y.width=g.width,y.height=g.height+b,_.fillStyle="#ffffff",_.fillRect(0,0,y.width,y.height),a&&(_.fillStyle="#1f2937",_.font="bold 24px system-ui, -apple-system, sans-serif",_.textAlign="center",_.fillText(c,y.width/2,35)),_.drawImage(g,0,b),_.fillStyle="#6b7280",_.font="12px system-ui, -apple-system, sans-serif",_.textAlign="right";const T=new Date().toLocaleDateString("nl-NL",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});_.fillText(T,y.width-10,y.height-10),_.textAlign="left",_.fillText("DetectorApp.nl",10,y.height-10);const A=`kaart-${new Date().toISOString().split("T")[0]}`;if(s==="pdf"){const I=window.open("","_blank");if(I){const P=y.toDataURL("image/png");I.document.write(`
            <!DOCTYPE html>
            <html>
              <head>
                <title>${c}</title>
                <style>
                  @media print {
                    body { margin: 0; padding: 0; }
                    img { max-width: 100%; height: auto; }
                  }
                  body {
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    min-height: 100vh;
                    margin: 0;
                    background: white;
                  }
                  img { max-width: 100%; max-height: 100vh; }
                </style>
              </head>
              <body>
                <img src="${P}" />
                <script>
                  setTimeout(() => {
                    window.print();
                  }, 500);
                <\/script>
              </body>
            </html>
          `),I.document.close()}}else{const I=s==="jpeg"?"image/jpeg":"image/png",P=s==="jpeg"?.92:void 0;y.toBlob(R=>{if(R){const D=URL.createObjectURL(R),C=document.createElement("a");C.href=D,C.download=`${A}.${s}`,document.body.appendChild(C),C.click(),document.body.removeChild(C),URL.revokeObjectURL(D)}},I,P)}n(!1)}catch(f){console.error("Export failed:",f),alert("Kon de kaart niet exporteren. Probeer het opnieuw.")}finally{i(!1)}}};return p.jsxs(p.Fragment,{children:[p.jsx(_t.button,{onClick:()=>n(!0),className:"fixed bottom-[228px] left-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm text-gray-600",whileHover:{scale:1.05},whileTap:{scale:.95},title:"Kaart printen/exporteren",children:p.jsx(q$,{size:20})}),p.jsx(qn,{children:e&&p.jsxs(p.Fragment,{children:[p.jsx(_t.div,{className:"fixed inset-0 bg-black/40 z-[1700]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>n(!1)}),p.jsxs(_t.div,{className:"fixed z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden",style:{top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"min(90vw, 320px)"},initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.15},children:[p.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-green-500 to-green-600",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(q$,{size:18,className:"text-white"}),p.jsx("span",{className:"font-medium text-white",children:"Kaart Exporteren"})]}),p.jsx("button",{onClick:()=>n(!1),className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none",children:p.jsx(Qr,{size:18,className:"text-white"})})]}),p.jsxs("div",{className:"p-4 space-y-4",children:[p.jsxs("div",{children:[p.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-700 mb-2",children:[p.jsx("input",{type:"checkbox",checked:a,onChange:f=>l(f.target.checked),className:"rounded border-gray-300"}),"Titel toevoegen"]}),a&&p.jsx("input",{type:"text",value:c,onChange:f=>u(f.target.value),className:"w-full px-3 py-2 bg-gray-100 rounded-lg border-0 outline-none focus:ring-2 focus:ring-green-500 text-sm",placeholder:"Titel..."})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Formaat"}),p.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[p.jsx(EF,{format:"png",selected:s==="png",onClick:()=>o("png"),icon:p.jsx(Kse,{size:16}),label:"PNG"}),p.jsx(EF,{format:"jpeg",selected:s==="jpeg",onClick:()=>o("jpeg"),icon:p.jsx(Kse,{size:16}),label:"JPEG"}),p.jsx(EF,{format:"pdf",selected:s==="pdf",onClick:()=>o("pdf"),icon:p.jsx(q$,{size:16}),label:"Print"})]})]}),p.jsx("button",{onClick:h,disabled:r,className:"w-full flex items-center justify-center gap-2 px-4 py-3 bg-green-500 hover:bg-green-600 text-white rounded-lg transition-colors border-0 outline-none disabled:opacity-50",children:r?p.jsxs(p.Fragment,{children:[p.jsx(BI,{size:18,className:"animate-spin"}),p.jsx("span",{children:"Exporteren..."})]}):p.jsxs(p.Fragment,{children:[p.jsx(vA,{size:18}),p.jsx("span",{children:s==="pdf"?"Printen":"Downloaden"})]})})]})]})]})})]})}function EF({format:t,selected:e,onClick:n,icon:r,label:i}){return p.jsxs("button",{onClick:n,className:`flex flex-col items-center justify-center gap-1 p-3 rounded-lg transition-colors border-0 outline-none ${e?"bg-green-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[r,p.jsx("span",{className:"text-xs font-medium",children:i})]})}class Cae{buffer=[];size;weights;constructor(e=8){this.size=e,this.weights=Array.from({length:e},(r,i)=>Math.pow(2,i));const n=this.weights.reduce((r,i)=>r+i,0);this.weights=this.weights.map(r=>r/n)}add(e){if(this.buffer.length>0){const n=this.buffer[this.buffer.length-1];let r=e-n;r>180&&(e-=360),r<-180&&(e+=360)}this.buffer.push(e),this.buffer.length>this.size&&this.buffer.shift()}getSmoothed(){if(this.buffer.length===0)return null;if(this.buffer.length===1)return this.normalize(this.buffer[0]);let e=0,n=0;const r=this.size-this.buffer.length;for(let i=0;i<this.buffer.length;i++){const s=this.weights[r+i];e+=this.buffer[i]*s,n+=s}return this.normalize(e/n)}normalize(e){return(e%360+360)%360}clear(){this.buffer=[]}}function Jkt(){const t=ks(c=>c.tracking),e=ks(c=>c.headingSource),n=ks(c=>c.rawGPSHeading),r=ks(c=>c.setSmoothedHeading),i=Y.useRef(new Cae(6)),s=Y.useRef(new Cae(10)),o=Y.useRef(0),a=Y.useRef(null),l=33;Y.useEffect(()=>{if(!t||e!=="gps"||n===null||n===a.current)return;a.current=n;const c=performance.now();if(c-o.current<l)return;i.current.add(n);const u=i.current.getSmoothed();u!==null&&(o.current=c,r(u))},[t,e,n,r]),Y.useEffect(()=>{if(!t||e!=="compass")return;let c=0;const u=80,h=f=>{const g=performance.now();if(g-c<u||g-o.current<l)return;c=g;let y=null;if(f.webkitCompassHeading!==void 0?y=f.webkitCompassHeading:f.alpha!==null&&(y=(360-f.alpha)%360),y!==null){s.current.add(y);const _=s.current.getSmoothed();_!==null&&(o.current=g,r(_))}};return window.addEventListener("deviceorientationabsolute",h),window.addEventListener("deviceorientation",h),()=>{window.removeEventListener("deviceorientationabsolute",h),window.removeEventListener("deviceorientation",h)}},[t,e,r]),Y.useEffect(()=>{t||(i.current.clear(),s.current.clear(),a.current=null)},[t])}function Qkt(){const t=gi(i=>i.map),e=Bs(i=>i.setLayerOpacity),n=Bs(i=>i.visible),r=Y.useRef(null);Y.useEffect(()=>{if(!t)return;const i=()=>{const s=t.getView().getZoom();if(!s||r.current!==null&&Math.abs(s-r.current)<.5)return;r.current=s;const o=n["AHN 0.5m"],a=n["AHN4 Multi-Hillshade NL"];!o&&!a||(o&&(s>=18?e("AHN 0.5m",.85):s>=16?e("AHN 0.5m",.75):s>=14?e("AHN 0.5m",.65):e("AHN 0.5m",.55)),a&&(s>=18?e("AHN4 Multi-Hillshade NL",.8):s>=16?e("AHN4 Multi-Hillshade NL",.7):s>=14?e("AHN4 Multi-Hillshade NL",.6):e("AHN4 Multi-Hillshade NL",.5)))};return t.on("moveend",i),i(),()=>{t.un("moveend",i)}},[t,n,e])}const SF=2e3;async function eAt(){const t=[ps,mh,Ua];await Promise.all(t.map(e=>e.persist.hasHydrated()?Promise.resolve():new Promise(n=>{const r=e.persist.onFinishHydration(()=>{r(),n()})})))}function tAt(){const t=yO(T=>T.user),{layers:e,clearAll:n}=ps(),{vondsten:r,clearAll:i}=mh(),{savedRoutes:s}=Ua(),o=Y.useRef(null),a=Y.useRef(!0),l=Y.useRef(""),c=Y.useRef(""),u=Y.useRef(""),[h,f]=Y.useState(!1);Y.useEffect(()=>{eAt().then(()=>{f(!0),console.log(" Stores gehydrateerd uit localStorage")})},[]);const g=Y.useCallback(async T=>{if(t)try{const A=jy(Kf,"users",t.uid);await pj(A,{layers:T,layersUpdatedAt:mj()},{merge:!0}),console.log(" Lagen gesynchroniseerd naar cloud")}catch(A){console.error(" Fout bij synchroniseren lagen:",A)}},[t]),y=Y.useCallback(async T=>{if(t)try{const A=jy(Kf,"users",t.uid);await pj(A,{vondsten:T,vondstenUpdatedAt:mj()},{merge:!0}),console.log(" Vondsten gesynchroniseerd naar cloud")}catch(A){console.error(" Fout bij synchroniseren vondsten:",A)}},[t]),_=Y.useCallback(async T=>{if(t)try{const A=jy(Kf,"users",t.uid);await pj(A,{routes:T,routesUpdatedAt:mj()},{merge:!0}),console.log(" Routes gesynchroniseerd naar cloud")}catch(A){console.error(" Fout bij synchroniseren routes:",A)}},[t]),b=Y.useCallback(async()=>{if(t)try{const T=jy(Kf,"users",t.uid),A=await lDe(T);if(A.exists()){const I=A.data();if(I.layers&&Array.isArray(I.layers)){const P=I.layers,R=ps.getState().layers,D=[...P],C=new Set(P.map(M=>M.id));R.forEach(M=>{C.has(M.id)||D.push(M)}),ps.setState({layers:D}),l.current=JSON.stringify(D),console.log(` ${P.length} lagen geladen uit cloud`)}if(I.vondsten&&Array.isArray(I.vondsten)){const P=I.vondsten,R=mh.getState().vondsten,D=[...P],C=new Set(P.map(M=>M.id));R.forEach(M=>{C.has(M.id)||D.push(M)}),mh.setState({vondsten:D}),c.current=JSON.stringify(D),console.log(` ${P.length} vondsten geladen uit cloud`)}if(I.routes&&Array.isArray(I.routes)){const P=I.routes,R=Ua.getState().savedRoutes,D=[...P],C=new Set(P.map(O=>O.id));R.forEach(O=>{C.has(O.id)||D.push(O)});const M=new Set(D.map(O=>O.id));Ua.setState({savedRoutes:D,visibleRouteIds:M}),u.current=JSON.stringify(D),console.log(` ${P.length} routes geladen uit cloud`)}}else console.log(" Geen cloud data gevonden, lokale data wordt gesynchroniseerd..."),await g(e),await y(r),await _(s);a.current=!1}catch(T){console.error(" Fout bij laden uit cloud:",T),a.current=!1}},[t,e,r,s,g,y,_]);return Y.useEffect(()=>{h&&(t?(a.current=!0,b()):(a.current=!0,l.current="",c.current="",u.current=""))},[t?.uid,h]),Y.useEffect(()=>{if(!t||!h||a.current)return;const T=JSON.stringify(e);if(T!==l.current)return o.current&&clearTimeout(o.current),o.current=setTimeout(()=>{l.current=T,g(e)},SF),()=>{o.current&&clearTimeout(o.current)}},[t,e,g]),Y.useEffect(()=>{if(!t||!h||a.current)return;const T=JSON.stringify(r);if(T!==c.current)return o.current&&clearTimeout(o.current),o.current=setTimeout(()=>{c.current=T,y(r)},SF),()=>{o.current&&clearTimeout(o.current)}},[t,r,y]),Y.useEffect(()=>{if(!t||!h||a.current)return;const T=JSON.stringify(s);if(T!==u.current)return o.current&&clearTimeout(o.current),o.current=setTimeout(()=>{u.current=T,_(s)},SF),()=>{o.current&&clearTimeout(o.current)}},[t,s,_]),{isLoggedIn:!!t,syncLayersToCloud:g,syncVondstenToCloud:y,syncRoutesToCloud:_}}function nAt(){Jkt(),Qkt(),tAt();const t=ks(_=>_.fetchPassivePosition);Y.useEffect(()=>{t()},[t]);const n=14*Cn(_=>_.fontScale)/100,r=Gr(_=>_.vondstFormOpen),i=Gr(_=>_.vondstFormLocation),s=Gr(_=>_.closeVondstForm),o=Gr(_=>_.routeDashboardOpen),a=Gr(_=>_.toggleRouteDashboard),l=Gr(_=>_.monumentSearchOpen),c=Gr(_=>_.closeMonumentSearch),u=hT(_=>_.showBuienradar),h=hT(_=>_.setShowBuienradar),f=Cn(_=>_.hideWelcomeModal),[g,y]=Y.useState(!f);return p.jsx(sTt,{children:p.jsxs("div",{style:{fontSize:`${n}px`},children:[p.jsx(Pkt,{}),p.jsx(cit,{}),p.jsx(Eht,{}),p.jsx(fkt,{}),p.jsx(hTt,{}),p.jsx(gkt,{}),p.jsx(KTt,{}),p.jsx(YTt,{}),p.jsx(XTt,{}),p.jsx(JTt,{}),p.jsx(CSt,{}),p.jsx(MSt,{}),p.jsx(nTt,{}),p.jsx(wht,{}),p.jsx(WTt,{}),p.jsx(HTt,{}),p.jsx(rTt,{}),p.jsx(Tht,{}),p.jsx(Nht,{}),p.jsx(tTt,{}),p.jsx(ITt,{}),p.jsx(ZSt,{}),p.jsx(Bkt,{}),p.jsx(qkt,{}),p.jsx(Zkt,{}),p.jsx(CTt,{}),p.jsx(JSt,{}),p.jsx(ukt,{}),p.jsx(hkt,{isVisible:u,onClose:()=>h(!1)}),p.jsx(STt,{}),p.jsx(ykt,{}),p.jsx(Skt,{}),p.jsx(Tkt,{}),p.jsx(Ikt,{}),p.jsx(skt,{isOpen:o,onClose:a}),p.jsx(qn,{children:r&&p.jsx(hSe,{onClose:s,initialLocation:i||void 0})}),p.jsx(Okt,{isOpen:l,onClose:c}),p.jsx(Dkt,{}),p.jsx(jkt,{isOpen:g,onClose:()=>y(!1)})]})})}const rAt="fef02a7628814a519d5f0eeb2d82656e";function iAt(){nr.apiKey=rAt}iAt();console.log(`%c DetectorApp v${g5}`,"background: #4CAF50; color: white; padding: 4px 8px; border-radius: 4px; font-weight: bold;");jTe.createRoot(document.getElementById("root")).render(p.jsx(nAt,{}));export{Qde as $,ns as A,Zr as B,ms as C,hS as D,Bt as E,gr as F,kL as G,aCe as H,hCe as I,yv as J,Ju as K,O5 as L,it as M,X0e as N,Ss as O,Ti as P,dCt as Q,Jt as R,vn as S,Nm as T,Kre as U,Ml as V,fCt as W,G0 as X,U0 as Y,kt as Z,_e as _,HCe as a,db as a$,tfe as a0,nfe as a1,ye as a2,SAt as a3,vAt as a4,uIt as a5,kOt as a6,c6e as a7,jOt as a8,lKe as a9,qet as aA,bI as aB,$qe as aC,C2 as aD,jd as aE,$g as aF,Ot as aG,Kt as aH,gye as aI,wW as aJ,yye as aK,mye as aL,jne as aM,s4t as aN,Kze as aO,A3t as aP,Mfe as aQ,yw as aR,N2 as aS,Qk as aT,ii as aU,yu as aV,fB as aW,xc as aX,Pr as aY,hb as aZ,ga as a_,a1e as aa,i3t as ab,s3t as ac,t3t as ad,Bk as ae,UB as af,ha as ag,fI as ah,wh as ai,hKe as aj,P4 as ak,vVe as al,FMt as am,Ze as an,Jn as ao,Zl as ap,Ca as aq,Gf as ar,Yr as as,Wd as at,fPt as au,Eg as av,IAt as aw,Zde as ax,pye as ay,q5t as az,$Ce as b,cd as b$,_h as b0,NRt as b1,RRt as b2,MRt as b3,Dd as b4,PO as b5,wi as b6,Sl as b7,cW as b8,FOt as b9,ue as bA,vIt as bB,er as bC,Di as bD,wa as bE,nr as bF,hCt as bG,HAt as bH,M6e as bI,wg as bJ,Fr as bK,HQ as bL,uMt as bM,Zn as bN,Jde as bO,hI as bP,Tfe as bQ,qVe as bR,dje as bS,Wa as bT,XAt as bU,vT as bV,Z_ as bW,_I as bX,nn as bY,og as bZ,sg as b_,L2 as ba,zve as bb,hfe as bc,YFe as bd,uPt as be,Vpe as bf,bPt as bg,is as bh,ufe as bi,za as bj,aR as bk,ARt as bl,Ave as bm,xl as bn,By as bo,Lze as bp,lb as bq,jIt as br,g_e as bs,wO as bt,YPt as bu,JB as bv,x as bw,E as bx,cr as by,Sa as bz,Nl as c,mn as c$,Uy as c0,Ql as c1,q1 as c2,cl as c3,ZKe as c4,zPt as c5,GPt as c6,uCt as c7,u3t as c8,KPt as c9,Dr as cA,rb as cB,Pa as cC,zMt as cD,vo as cE,FYe as cF,PW as cG,MO as cH,pMt as cI,m2 as cJ,xKe as cK,qQ as cL,AB as cM,UKe as cN,T1e as cO,QMt as cP,JMt as cQ,BMt as cR,iA as cS,rA as cT,vb as cU,f9 as cV,Ree as cW,go as cX,ZUe as cY,xIt as cZ,_It as c_,qPt as ca,v3t as cb,BVe as cc,c3t as cd,Yo as ce,dn as cf,UPt as cg,HPt as ch,WPt as ci,BPt as cj,cKe as ck,uKe as cl,pZe as cm,tn as cn,qt as co,Qo as cp,Ys as cq,EW as cr,yWe as cs,T8e as ct,A8e as cu,k8e as cv,I8e as cw,xPt as cx,wPt as cy,vu as cz,Pn as d,M4 as d$,Ol as d0,TCt as d1,kCt as d2,PMt as d3,ACt as d4,FRt as d5,rit as d6,MT as d7,Pet as d8,f5t as d9,ZFe as dA,Ut as dB,x_e as dC,YV as dD,ott as dE,yj as dF,MI as dG,U7 as dH,PRt as dI,z3t as dJ,a4t as dK,Sd as dL,Npe as dM,IMt as dN,fn as dO,ya as dP,th as dQ,ra as dR,ape as dS,V8 as dT,Det as dU,Yde as dV,xi as dW,i7 as dX,iW as dY,lIt as dZ,ma as d_,Ln as da,m5t as db,xb as dc,nW as dd,jpe as de,vI as df,a1 as dg,H1 as dh,uve as di,XMt as dj,WYe as dk,bVe as dl,Hu as dm,HYe as dn,Ha as dp,wc as dq,n6e as dr,RCt as ds,Vn as dt,kI as du,H_ as dv,$i as dw,Wpe as dx,DM as dy,_M as dz,lr as e,TIt as e$,aIt as e0,APt as e1,Qve as e2,a0 as e3,Jve as e4,FJe as e5,bUe as e6,mAt as e7,gAt as e8,o_e as e9,l8e as eA,Ete as eB,_Fe as eC,i4t as eD,aRt as eE,hu as eF,$At as eG,_Ct as eH,rfe as eI,QJe as eJ,zge as eK,Jpe as eL,VYe as eM,n3t as eN,bW as eO,z1 as eP,dKe as eQ,l3t as eR,hc as eS,a3t as eT,aKe as eU,PCt as eV,eu as eW,DO as eX,zJe as eY,RMt as eZ,Vje as e_,yb as ea,aQe as eb,UV as ec,gv as ed,bh as ee,CI as ef,Jk as eg,TJe as eh,s_e as ei,AJe as ej,n_e as ek,i_e as el,h8e as em,DB as en,jB as eo,u8e as ep,OO as eq,LO as er,xie as es,gLt as et,dLt as eu,iLt as ev,es as ew,nLt as ex,bLt as ey,ELt as ez,BA as f,uLt as f$,j6e as f0,j1 as f1,hB as f2,gIt as f3,wWe as f4,lye as f5,DW as f6,bBe as f7,WJe as f8,OBe as f9,ZJe as fA,MJe as fB,NJe as fC,nQe as fD,ol as fE,ds as fF,al as fG,ab as fH,QPt as fI,Ug as fJ,Sze as fK,e9 as fL,_B as fM,y2 as fN,El as fO,aje as fP,Ype as fQ,Fpe as fR,VPt as fS,Co as fT,Fk as fU,qs as fV,mPt as fW,pPt as fX,txe as fY,nxe as fZ,sLt as f_,kJe as fa,r_e as fb,tQe as fc,SCt as fd,_O as fe,xO as ff,Rfe as fg,mIt as fh,xze as fi,AI as fj,fIt as fk,pB as fl,vO as fm,SUe as fn,UBe as fo,rWe as fp,kZe as fq,HVe as fr,LCt as fs,g2 as ft,o3t as fu,Gge as fv,GBe as fw,AUe as fx,IUe as fy,PUe as fz,gh as g,JCt as g$,KVe as g0,K3t as g1,c4t as g2,jg as g3,LQ as g4,cCt as g5,fNt as g6,mZe as g7,ip as g8,J6e as g9,Bg as gA,DMt as gB,i1 as gC,WAt as gD,tIt as gE,mLt as gF,ije as gG,sje as gH,z8 as gI,SZe as gJ,zCt as gK,FCt as gL,IRt as gM,fUe as gN,KCt as gO,Oze as gP,m9 as gQ,Hi as gR,F5t as gS,wM as gT,X9 as gU,Sx as gV,jO as gW,CRt as gX,pv as gY,n4t as gZ,B3t as g_,Hk as ga,Vi as gb,h0e as gc,fl as gd,VCt as ge,T2 as gf,tRt as gg,Hj as gh,vRt as gi,YO as gj,dW as gk,fW as gl,yRt as gm,kRt as gn,ZO as go,yGe as gp,JXe as gq,H0e as gr,WW as gs,XJe as gt,LMt as gu,NMt as gv,RI as gw,Gs as gx,OMt as gy,kp as gz,DLt as h,yIt as h$,S4t as h0,E4t as h1,dc as h2,sPt as h3,kUe as h4,DCt as h5,A$e as h6,od as h7,ll as h8,P4t as h9,Xpe as hA,Zpe as hB,ICt as hC,ABe as hD,aye as hE,oYe as hF,jJe as hG,cye as hH,EPt as hI,o8e as hJ,DUe as hK,MBe as hL,LUe as hM,XO as hN,yM as hO,CAt as hP,qJe as hQ,DJe as hR,j1e as hS,G3t as hT,CW as hU,_Ze as hV,RT as hW,zf as hX,sc as hY,WWe as hZ,SIt as h_,aCt as ha,z$e as hb,O4t as hc,K1 as hd,nA as he,yAt as hf,YAt as hg,us as hh,Uj as hi,Yze as hj,fv as hk,Rte as hl,cb as hm,ob as hn,Hs as ho,VW as hp,TPt as hq,P8e as hr,g8e as hs,ome as ht,HJe as hu,MPt as hv,WGe as hw,CCt as hx,OGe as hy,Pee as hz,Dn as i,lo as i$,Gfe as i0,lBe as i1,QAt as i2,xI as i3,Ofe as i4,o0 as i5,gWe as i6,pWe as i7,dWe as i8,Bj as i9,mOt as iA,mNt as iB,y0e as iC,Kk as iD,B9 as iE,jGe as iF,x0e as iG,wCt as iH,Z5t as iI,hIt as iJ,RIt as iK,AFe as iL,MFe as iM,LFe as iN,yd as iO,g$e as iP,dIt as iQ,vne as iR,DVe as iS,dI as iT,XIt as iU,nit as iV,$1 as iW,oB as iX,Y6e as iY,XCt as iZ,sBe as i_,eye as ia,Vze as ib,nw as ic,G6e as id,Od as ie,vLt as ig,L3t as ih,O3t as ii,aYe as ij,t0e as ik,gGe as il,kte as im,FVe as io,qk as ip,b2 as iq,Jet as ir,_Ot as is,__e as it,TOt as iu,kN as iv,EOt as iw,DT as ix,SOt as iy,c3 as iz,LLt as j,C5t as j$,v0e as j0,DGe as j1,uw as j2,fAt as j3,Lve as j4,uW as j5,H as j6,p8e as j7,Ad as j8,hZe as j9,j3t as jA,D3t as jB,Zo as jC,aW as jD,V9 as jE,oW as jF,ZCt as jG,lRt as jH,Ote as jI,q0e as jJ,wIt as jK,zye as jL,rPt as jM,_Lt as jN,$m as jO,tUe as jP,HRt as jQ,zRt as jR,Qh as jS,MAt as jT,NAt as jU,RAt as jV,O6e as jW,dv as jX,Cpe as jY,M5t as jZ,R5t as j_,UW as ja,jze as jb,WCt as jc,V4 as jd,exe as je,wnt as jf,bnt as jg,QOt as jh,Znt as ji,eLt as jj,qOt as jk,HOt as jl,Qnt as jm,US as jn,JOt as jo,iUe as jp,TUe as jq,EUe as jr,CJe as js,oQe as jt,lQe as ju,UGe as jv,U0e as jw,a8e as jx,RJe as jy,e_e as jz,fc as k,w$e as k$,P5t as k0,O5t as k1,N5t as k2,I5t as k3,A5t as k4,wBe as k5,Lge as k6,oye as k7,mCt as k8,sze as k9,jW as kA,U3t as kB,V3t as kC,QRt as kD,c$e as kE,$It as kF,ZZe as kG,JZe as kH,t_e as kI,vCt as kJ,XXe as kK,pOt as kL,Y8e as kM,n9e as kN,wI as kO,NPt as kP,IPt as kQ,PPt as kR,ZAt as kS,H6e as kT,p6e as kU,oPt as kV,wB as kW,WIt as kX,BIt as kY,jCt as kZ,b$e as k_,pCt as ka,oze as kb,O1e as kc,$Ge as kd,WQ as ke,k5t as kf,VB as kg,J8e as kh,lze as ki,tB as kj,OAt as kk,nB as kl,LAt as km,jI as kn,cw as ko,YXe as kp,mje as kq,AOt as kr,N1e as ks,v2 as kt,TO as ku,Df as kv,VMt as kw,RO as kx,tW as ky,FAt as kz,$St as l,Q8 as l$,iRt as l0,eRt as l1,X6e as l2,mfe as l3,Si as l4,dPt as l5,pL as l6,cH as l7,wl as l8,mL as l9,s1 as lA,$Ot as lB,bAt as lC,Jze as lD,qre as lE,zze as lF,Fze as lG,TN as lH,i0e as lI,G5t as lJ,V5t as lK,z5t as lL,Het as lM,nnt as lN,unt as lO,u6e as lP,qAt as lQ,pfe as lR,EO as lS,eIt as lT,tA as lU,vXe as lV,D0e as lW,qCt as lX,m$ as lY,pI as lZ,bIt as l_,SLt as la,Id as lb,UIt as lc,K_ as ld,sCt as le,E0e as lf,b0e as lg,cUe as lh,NM as li,e0e as lj,uRt as lk,pW as ll,X_ as lm,tMt as ln,nMt as lo,rMt as lp,ERt as lq,wRt as lr,gRt as ls,RGe as lt,xRt as lu,aUe as lv,eCt as lw,BCt as lx,eMt as ly,W4t as lz,Ni as m,KAt as m$,qO as m0,ZRt as m1,XRt as m2,u0e as m3,l0e as m4,uGe as m5,dGe as m6,NS as m7,Mx as m8,Eqe as m9,Of as mA,Wm as mB,bs as mC,IYe as mD,rJe as mE,jAt as mF,LBe as mG,iYe as mH,kBe as mI,IBe as mJ,E5t as mK,bT as mL,GMt as mM,Y0e as mN,Kge as mO,efe as mP,BAt as mQ,Efe as mR,Qpe as mS,GQ as mT,jfe as mU,Btt as mV,MCt as mW,_0e as mX,bCt as mY,rW as mZ,Lfe as m_,r3t as ma,C4t as mb,UVe as mc,N4t as md,R4t as me,Sg as mf,vtt as mg,xtt as mh,wtt as mi,qfe as mj,MMt as mk,EB as ml,rx as mm,KZe as mn,$5t as mo,zFe as mp,Rpe as mq,SKe as mr,tL as ms,BM as mt,AKe as mu,qge as mv,I4t as mw,_ze as mx,xLt as my,gS as mz,ts as n,H4t as n$,j9 as n0,DKe as n1,pAt as n2,Kye as n3,G9 as n4,Y4t as n5,K4t as n6,ZXe as n7,F3t as n8,$3t as n9,J5t as nA,$Mt as nB,M4t as nC,WFe as nD,L1e as nE,R2 as nF,T4t as nG,k4t as nH,A4t as nI,QB as nJ,pIt as nK,AAt as nL,Ove as nM,cOt as nN,lOt as nO,w5t as nP,b5t as nQ,iIt as nR,Sve as nS,Fve as nT,O2 as nU,ld as nV,hW as nW,s0e as nX,II as nY,bve as nZ,$I as n_,cB as na,BBe as nb,zBe as nc,$Je as nd,VBe as ne,hYe as nf,SB as ng,nPt as nh,zB as ni,hPt as nj,E_ as nk,s6e as nl,h9 as nm,yOt as nn,Utt as no,vOt as np,gOt as nq,y_e as nr,eH as ns,Na as nt,FGe as nu,UE as nv,gCt as nw,zet as nx,jMt as ny,aOt as nz,xn as o,$Ye as o$,N$ as o0,nCt as o1,oN as o2,eQe as o3,_Ge as o4,Z4 as o5,SPt as o6,rGe as o7,tCt as o8,so as o9,iCt as oA,kPt as oB,lCt as oC,sIt as oD,Ret as oE,$ze as oF,TAt as oG,wAt as oH,afe as oI,_Pt as oJ,vPt as oK,OCt as oL,Pfe as oM,mXe as oN,eZe as oO,Eve as oP,A_e as oQ,DAt as oR,rOt as oS,iOt as oT,sOt as oU,oOt as oV,B5t as oW,H5t as oX,W5t as oY,_tt as oZ,Fg as o_,ro as oa,u4t as ob,f4t as oc,l4t as od,y$e as oe,cIt as of,lme as og,KXe as oh,xGe as oi,wGe as oj,MM as ok,HCt as ol,aGe as om,lGe as on,Hrt as oo,du as op,aL as oq,wJe as or,FIt as os,Nve as ot,Dve as ou,RZe as ov,yNt as ow,VZe as ox,vNt as oy,mBe as oz,FSt as p,oRt as p$,R1e as p0,NKe as p1,cee as p2,e8e as p3,XPt as p4,q4t as p5,yPt as p6,gPt as p7,S8e as p8,ant as p9,qc as pA,Q5t as pB,CPt as pC,U$e as pD,X5t as pE,Y5t as pF,itt as pG,K5t as pH,S5t as pI,T5t as pJ,eOt as pK,tOt as pL,uOt as pM,hOt as pN,L5t as pO,dOt as pP,fOt as pQ,Wet as pR,Yet as pS,F_e as pT,x2 as pU,nOt as pV,Let as pW,JAt as pX,VGe as pY,FUe as pZ,TGe as p_,v$e as pa,lnt as pb,rnt as pc,VRt as pd,x5t as pe,CMt as pf,HKe as pg,e3t as ph,WMt as pi,KMt as pj,HMt as pk,YMt as pl,qMt as pm,ZMt as pn,LOt as po,$Q as pp,UMt as pq,Mze as pr,GCt as ps,Uze as pt,YCt as pu,p4t as pv,qZe as pw,tu as px,nRt as py,U5t as pz,$pe as q,iWe as q$,Q4t as q0,XBe as q1,c0e as q2,F0e as q3,hpe as q4,LT as q5,nIt as q6,YBe as q7,sMt as q8,sRt as q9,MOt as qA,ROt as qB,gtt as qC,k_e as qD,j5t as qE,D5t as qF,ftt as qG,_5t as qH,_Rt as qI,Ff as qJ,U9 as qK,cRt as qL,$a as qM,l6e as qN,sQe as qO,EAt as qP,e4t as qQ,t4t as qR,BGe as qS,oWe as qT,sWe as qU,$0e as qV,kqe as qW,RBe as qX,PBe as qY,CBe as qZ,HBe as q_,RWe as qa,Hre as qb,r6e as qc,xAt as qd,_At as qe,sUe as qf,wKe as qg,YOt as qh,XOt as qi,CKe as qj,KOt as qk,sA as ql,aA as qm,EKe as qn,VAt as qo,$Ke as qp,FKe as qq,OW as qr,Yrt as qs,wOt as qt,bOt as qu,xCt as qv,xOt as qw,DOt as qx,NOt as qy,OOt as qz,Tbe as r,NBe as r$,GRt as r0,HXe as r1,jBe as r2,gNt as r3,wLt as r4,pNt as r5,Wg as r6,fLt as r7,yLt as r8,pLt as r9,mqe as rA,iJe as rB,Hve as rC,rIt as rD,Yte as rE,k3t as rF,aNt as rG,X3t as rH,EBe as rI,Ix as rJ,cYe as rK,yCt as rL,C3t as rM,H3t as rN,ECt as rO,pGe as rP,lYe as rQ,mme as rR,vme as rS,WRt as rT,J3t as rU,BRt as rV,URt as rW,rRt as rX,_W as rY,oIt as rZ,Q3t as r_,NGe as ra,hRt as rb,pRt as rc,SRt as rd,dRt as re,mRt as rf,TRt as rg,lUe as rh,cBe as ri,UCt as rj,NI as rk,OI as rl,LI as rm,NXe as rn,oNt as ro,o4t as rp,q3t as rq,Z3t as rr,Y3t as rs,zAt as rt,_4t as ru,v4t as rv,PAt as rw,W3t as rx,QCt as ry,r4t as rz,Xe as s,sYe as s0,WBe as s1,ORt as s2,DRt as s3,VOt as s4,K2 as t,oSe as u,pi as v,oCt as w,Ld as x,mI as y,Nfe as z};
//# sourceMappingURL=index-jXf3nwD_.js.map
