{"version":3,"mappings":"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","names":["Native","entries","$array.each","entry","x","target","callback","$array.keepIf","Raf","lastTime","loop","currentTime","newSize","size","observer","makeSensor","ResizeSensor","element","$utils.onZoom","InterfaceColors","Entity","NumberFormatter","bns","sns","bs","value","format","precision","$type.isString","formatted","source","$type.isObject","$utils.cleanFormat","info","details","$object.copy","$type.PLACEHOLDER","language","thousandSeparator","decimalSeparator","$type.PLACEHOLDER2","parts","$object.each","_part","item","partFormat","chunks","TextFormatter","i","chunk","matches","mods","a","b","negative","prefix","suffix","ol","exp","decimals","$utils.decimalPlaces","d","res","$type.numberToString","ints","ip","intsr","len","c","decs","prefixes","force","newvalue","applied","k","text","parseDate","timezone","date","year","month","day","hour","minute","second","millisecond","weekday","toUTCDate","Timezone","isReal","offset","userOffset","output","newUserOffset","utc","dtf","DateFormatter","ignoreTimezone","locales","originalDate","$type.isNumber","fullYear","hours","minutes","seconds","milliseconds","timestamp","$utils.getWeekYear","$utils.padString","$utils.getWeek","$utils.getMonthWeek","$utils.getYearDay","$utils.get12Hours","$utils.getTimeZone","$utils.getTimezoneOffset","tz","tzh","tzm","dateFormat","index","reg","parsedIndexes","resValues","indexAdjust","regex","val","$utils.getDayFromWeek","ts","$type.toNumber","zone","match","dir","originalOffset","list","$utils.escapeForRgex","DurationFormatter","dmillisecond","dsecond","dminute","dhour","dday","dweek","dmonth","dyear","asecond","aminute","ahour","aday","aweek","amonth","ayear","base","baseUnit","dirs","tstamp","values","part","unit","unitValue","digits","code","maxValue","maxUnit","currentUnit","ms","$object.eachContinue","key","timeUnit","en","Language","prompt","locale","rest","translation","localeTarget","translations","$array.map","Matrix","tx","ty","y","pivotX","pivotY","rotation","scale","origin","id","matrix","a1","b1","c1","d1","tx1","_slicedToArray","sliceIterator","arr","_arr","_n","_d","_e","_i","_s","err","TAU","mapToEllipse","_ref","rx","ry","cosphi","sinphi","centerx","centery","xp","yp","approxUnitArc","ang1","ang2","x1","y1","x2","y2","vectorAngle","ux","uy","vx","vy","sign","dot","getArcCenter","px","py","cx","cy","largeArcFlag","sweepFlag","pxp","pyp","rxsq","rysq","pxpsq","pypsq","radicant","centerxp","centeryp","vx1","vy1","vx2","vy2","arcToBezier","_ref2","_ref2$xAxisRotation","xAxisRotation","_ref2$largeArcFlag","_ref2$sweepFlag","curves","lambda","_getArcCenter","_getArcCenter2","ratio","segments","curve","_mapToEllipse","_mapToEllipse2","_mapToEllipse3","checkArgs","name","actual","expected","checkMinArgs","checkEvenArgs","splitArcFlags","args","flag","assertBinary","distributeId","rgb","eachTargets","hitTarget","f","onPointerEvent","$utils.addEventListener","$utils.getRendererEvent","event","$utils.getEventTarget","touches","$array.copy","isTainted","image","canvas","context","clearCanvas","view","crisp","CanvasPivot","CanvasDisplayObject","DisposerClass","renderer","status","self","order","margin","$utils.setInteractive","_bounds","child","point","bounds","p0","p1","p2","p3","Disposer","resolution","m","layer","targetGhostLayer","subStatus","layers","ghostLayer","ghostContext","mask","$array.move","_targetGhostLayer","interactive","CanvasContainer","$array.removeFirst","$array.pushOne","deep","setPoint","Op","_context","_forceColor","forceColor","BeginPath","BeginFill","color","EndFill","clearShadow","EndStroke","LineStyle","width","lineJoin","lineCap","LineDash","dash","LineDashOffset","dashOffset","DrawRect","height","l","t","DrawCircle","radius","DrawEllipse","radiusX","radiusY","Arc","startAngle","endAngle","anticlockwise","arcBounds","$math.getArcBounds","$math.DEGREES","ArcTo","LineTo","MoveTo","ClosePath","BezierCurveTo","cpX","cpY","cpX2","cpY2","toX","toY","QuadraticCurveTo","Shadow","blur","offsetX","offsetY","opacity","GraphicsImage","CanvasGraphics","BlendMode","op","alpha","Color","path","cpx","cpy","qcpx","qcpy","SEGMENTS_REGEXP","ARGS_REGEXP","relative","layerDirty","ghostOnly","drawGhost","CanvasText","style","ignoreGhost","ignoreFontWeight","fontStyle","style2","line","_index","thickness","fontSize","oversizedBehavior","metrics","rtl","maxWidth","truncate","wrap","refText","lines","styleRestored","minX","maxX","currentStyle","lineInfo","currentFormat","currentDecoration","currentFill","currentChunkWidth","skipFurtherText","firstTextChunk","leftoverChunks","currentVerticalAlign","$array.eachContinue","chunkWidth","breakWords","ellipsis","ellipsisMetrics","ellipsisWidth","excessWidth","tmpText","$utils.trim","leftBoundMod","rightBoundMod","boundsMod","chunkHeight","Percent","currentChunkOffset","maxW","maxH","w","h","fallbackBreakWords","tmp","fakeMetrics","div","bbox","CanvasTextStyle","percent","CanvasRadialText","deltaAngle","orientation","inward","inside","align","kerning","clockwise","shouldReverse","maxAngle","midAngle","$math.normalizeAngle","textHeight","lineStartAngle","angleShift","char","charWidth","totalWidth","chars","$utils.splitString","CanvasImage","CanvasRendererEvent","originalPoint","$utils.supports","CanvasRenderer","ArrayDisposer","GhostLayer","_key","events","listener","ev","_ev","prevent","obj","radius1","radius2","graphics","background","repetition","realWidth","realHeight","calculatedWidth","calculatedHeight","willReadFrequently","CanvasLayer","length","visible","existingLayer","layerIndex","$array.indexOf","next","root","deferredGhostLayers","layerx","native","originalEvent","adjustPoint","widthScale","heightScale","pixel","colorId","data","dispatched","originalTarget","button","dragged","$utils.setStyle","$utils.getStyle","clickevent","CounterDisposer","timer","clear","MultiDisposer","_","mouseup","pointercancel","mousedown","mousemove","object","options","canvasWidth","canvasHeight","minScale","maxScale","canvases","forceRender","needRerender","extraX","extraY","domWidth","domHeight","rAF","fps","Root","settings","EventDispatcher","VerticalLayout","HorizontalLayout","GridLayout","$utils.getSafeResolution","dom","registry","inner","tooltipContainerBounds","logo","Container","p100","Rectangle","Graphics","rect","rootContainer","DefaultTheme","container","htmlElementContainer","readerAlertElement","focusElementContainer","tooltipElementContainer","eventKey","$utils.getEventKey","focusedSprite","announceText","downEvent","$utils.blur","dragOffsetX","dragOffsetY","dragPoint","moveEvent","upEvent","group","items","lastIndex","$utils.focus","tooltip","Tooltip","running","animation","state","AnimationState","allParents","$object.keys","parent","objects","entity","depths","$order.compare","dirtyPositions","sprite","animationDone","now","timeout","endTime","$utils.removeElement","$array.remove","$utils.stripTags","themes","tooltipContainer","interfaceColors","tooltipContainerSettings","aindex","bindex","groups","focusElement","role","ariaLabel","label","populateString","ariaLive","ariaChecked","ariaCurrent","ariaSelected","ariaOrientation","ariaValueNow","ariaValueMin","ariaValueMax","ariaValueText","ariaControls","disposers","padding","found","focused","el","direction","focusableElements","targetElement","tooltipElement","scaleWidth","scaleHeight","disposer","styles","fontHash","changed","Text","htmlElement","needWrapper","wrapperTarget","htmlElementWrapper","setting","pos","lw","lh","ll","lr","lt","lb","previousBounds","newBounds","originX","isPercent","originY","html","s","__vitePreload","r","o"],"ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12],"sources":["../../node_modules/@amcharts/amcharts5/.internal/core/util/ResizeSensor.js","../../node_modules/@amcharts/amcharts5/.internal/core/util/InterfaceColors.js","../../node_modules/@amcharts/amcharts5/.internal/core/util/NumberFormatter.js","../../node_modules/@amcharts/amcharts5/.internal/core/util/Timezone.js","../../node_modules/@amcharts/amcharts5/.internal/core/util/DateFormatter.js","../../node_modules/@amcharts/amcharts5/.internal/core/util/DurationFormatter.js","../../node_modules/@amcharts/amcharts5/locales/en.js","../../node_modules/@amcharts/amcharts5/.internal/core/util/Language.js","../../node_modules/@amcharts/amcharts5/.internal/core/util/Matrix.js","../../node_modules/svg-arc-to-cubic-bezier/modules/index.js","../../node_modules/@amcharts/amcharts5/.internal/core/render/backend/CanvasRenderer.js","../../node_modules/@amcharts/amcharts5/.internal/core/Root.js","../../node_modules/@arcgis/core/widgets/support/chartUtilsAm5.js"],"sourcesContent":["/** @ignore */ /** */\r\nimport * as $array from \"./Array\";\r\nimport * as $utils from \"./Utils\";\r\n/**\r\n * @ignore\r\n */\r\nclass Native {\r\n    constructor() {\r\n        Object.defineProperty(this, \"_observer\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"_targets\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: []\r\n        });\r\n        this._observer = new ResizeObserver((entries) => {\r\n            $array.each(entries, (entry) => {\r\n                $array.each(this._targets, (x) => {\r\n                    if (x.target === entry.target) {\r\n                        x.callback();\r\n                    }\r\n                });\r\n            });\r\n        });\r\n    }\r\n    addTarget(target, callback) {\r\n        this._observer.observe(target, { box: \"border-box\" });\r\n        this._targets.push({ target, callback });\r\n    }\r\n    removeTarget(target) {\r\n        this._observer.unobserve(target);\r\n        $array.keepIf(this._targets, (x) => {\r\n            return x.target !== target;\r\n        });\r\n    }\r\n}\r\n/**\r\n * @ignore\r\n */\r\nclass Raf {\r\n    constructor() {\r\n        Object.defineProperty(this, \"_timer\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: null\r\n        });\r\n        Object.defineProperty(this, \"_targets\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: []\r\n        });\r\n    }\r\n    addTarget(target, callback) {\r\n        if (this._timer === null) {\r\n            let lastTime = null;\r\n            const loop = () => {\r\n                const currentTime = Date.now();\r\n                if (lastTime === null || currentTime > (lastTime + Raf.delay)) {\r\n                    lastTime = currentTime;\r\n                    $array.each(this._targets, (x) => {\r\n                        let newSize = x.target.getBoundingClientRect();\r\n                        if (newSize.width !== x.size.width || newSize.height !== x.size.height) {\r\n                            x.size = newSize;\r\n                            x.callback();\r\n                        }\r\n                    });\r\n                }\r\n                if (this._targets.length === 0) {\r\n                    this._timer = null;\r\n                }\r\n                else {\r\n                    this._timer = requestAnimationFrame(loop);\r\n                }\r\n            };\r\n            this._timer = requestAnimationFrame(loop);\r\n        }\r\n        // We start off with fake bounds so that sensor always kicks in\r\n        let size = { width: 0, height: 0, left: 0, right: 0, top: 0, bottom: 0, x: 0, y: 0 };\r\n        this._targets.push({ target, callback, size });\r\n    }\r\n    removeTarget(target) {\r\n        $array.keepIf(this._targets, (x) => {\r\n            return x.target !== target;\r\n        });\r\n        if (this._targets.length === 0) {\r\n            if (this._timer !== null) {\r\n                cancelAnimationFrame(this._timer);\r\n                this._timer = null;\r\n            }\r\n        }\r\n    }\r\n}\r\nObject.defineProperty(Raf, \"delay\", {\r\n    enumerable: true,\r\n    configurable: true,\r\n    writable: true,\r\n    value: 200\r\n});\r\n/**\r\n * @ignore\r\n */\r\nlet observer = null;\r\n/**\r\n * @ignore\r\n */\r\nfunction makeSensor() {\r\n    if (observer === null) {\r\n        if (typeof ResizeObserver !== \"undefined\") {\r\n            observer = new Native();\r\n        }\r\n        else {\r\n            observer = new Raf();\r\n        }\r\n    }\r\n    return observer;\r\n}\r\n/**\r\n * @ignore\r\n */\r\nexport class ResizeSensor {\r\n    constructor(element, callback) {\r\n        Object.defineProperty(this, \"_sensor\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"_element\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"_listener\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"_disposed\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: false\r\n        });\r\n        this._sensor = makeSensor();\r\n        this._element = element;\r\n        // This is needed because we need to know when the window is zoomed\r\n        this._listener = $utils.onZoom(callback);\r\n        this._sensor.addTarget(element, callback);\r\n    }\r\n    isDisposed() {\r\n        return this._disposed;\r\n    }\r\n    dispose() {\r\n        if (!this._disposed) {\r\n            this._disposed = true;\r\n            this._sensor.removeTarget(this._element);\r\n            this._listener.dispose();\r\n        }\r\n    }\r\n    get sensor() {\r\n        return this._sensor;\r\n    }\r\n}\r\n//# sourceMappingURL=ResizeSensor.js.map","import { Entity } from \"./Entity\";\r\n/**\r\n * Presets for common UI elements.\r\n */\r\nexport class InterfaceColors extends Entity {\r\n}\r\nObject.defineProperty(InterfaceColors, \"className\", {\r\n    enumerable: true,\r\n    configurable: true,\r\n    writable: true,\r\n    value: \"InterfaceColors\"\r\n});\r\nObject.defineProperty(InterfaceColors, \"classNames\", {\r\n    enumerable: true,\r\n    configurable: true,\r\n    writable: true,\r\n    value: Entity.classNames.concat([InterfaceColors.className])\r\n});\r\n//# sourceMappingURL=InterfaceColors.js.map","import { Entity } from \"./Entity\";\r\nimport { TextFormatter } from \"./TextFormatter\";\r\nimport * as $object from \"./Object\";\r\nimport * as $utils from \"./Utils\";\r\nimport * as $type from \"./Type\";\r\n/**\r\n * Number formatter\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/concepts/formatters/formatting-numbers/} for more info\r\n * @important\r\n */\r\nexport class NumberFormatter extends Entity {\r\n    _setDefaults() {\r\n        // Defaults\r\n        this._setDefault(\"negativeBase\", 0);\r\n        this._setDefault(\"numberFormat\", \"#,###.#####\");\r\n        this._setDefault(\"smallNumberThreshold\", 1.00);\r\n        const bns = \"_big_number_suffix_\";\r\n        const sns = \"_small_number_suffix_\";\r\n        const bs = \"_byte_suffix_\";\r\n        this._setDefault(\"bigNumberPrefixes\", [\r\n            { \"number\": 1e+3, \"suffix\": this._t(bns + \"3\") },\r\n            { \"number\": 1e+6, \"suffix\": this._t(bns + \"6\") },\r\n            { \"number\": 1e+9, \"suffix\": this._t(bns + \"9\") },\r\n            { \"number\": 1e+12, \"suffix\": this._t(bns + \"12\") },\r\n            { \"number\": 1e+15, \"suffix\": this._t(bns + \"15\") },\r\n            { \"number\": 1e+18, \"suffix\": this._t(bns + \"18\") },\r\n            { \"number\": 1e+21, \"suffix\": this._t(bns + \"21\") },\r\n            { \"number\": 1e+24, \"suffix\": this._t(bns + \"24\") }\r\n        ]);\r\n        this._setDefault(\"smallNumberPrefixes\", [\r\n            { \"number\": 1e-24, \"suffix\": this._t(sns + \"24\") },\r\n            { \"number\": 1e-21, \"suffix\": this._t(sns + \"21\") },\r\n            { \"number\": 1e-18, \"suffix\": this._t(sns + \"18\") },\r\n            { \"number\": 1e-15, \"suffix\": this._t(sns + \"15\") },\r\n            { \"number\": 1e-12, \"suffix\": this._t(sns + \"12\") },\r\n            { \"number\": 1e-9, \"suffix\": this._t(sns + \"9\") },\r\n            { \"number\": 1e-6, \"suffix\": this._t(sns + \"6\") },\r\n            { \"number\": 1e-3, \"suffix\": this._t(sns + \"3\") }\r\n        ]);\r\n        this._setDefault(\"bytePrefixes\", [\r\n            { \"number\": 1, suffix: this._t(bs + \"B\") },\r\n            { \"number\": 1024, suffix: this._t(bs + \"KB\") },\r\n            { \"number\": 1048576, suffix: this._t(bs + \"MB\") },\r\n            { \"number\": 1073741824, suffix: this._t(bs + \"GB\") },\r\n            { \"number\": 1099511627776, suffix: this._t(bs + \"TB\") },\r\n            { \"number\": 1125899906842624, suffix: this._t(bs + \"PB\") }\r\n        ]);\r\n        super._setDefaults();\r\n    }\r\n    _beforeChanged() {\r\n        super._beforeChanged();\r\n    }\r\n    /**\r\n     * Formats the number according to specific format.\r\n     *\r\n     * @param value   Value to format\r\n     * @param format  Format to apply\r\n     * @return Formatted number\r\n     */\r\n    format(value, format, precision) {\r\n        // no format passed in or \"Number\"\r\n        if (format == null || ($type.isString(format) && format.toLowerCase() === \"number\")) {\r\n            format = this.get(\"numberFormat\", \"\");\r\n        }\r\n        // Init return value\r\n        let formatted;\r\n        // Cast to number just in case\r\n        // TODO: maybe use better casting\r\n        let source = Number(value);\r\n        // Is it a built-in format or Intl.NumberFormatOptions\r\n        if ($type.isObject(format)) {\r\n            try {\r\n                if (this.get(\"intlLocales\")) {\r\n                    return new Intl.NumberFormat(this.get(\"intlLocales\"), format).format(source);\r\n                }\r\n                else {\r\n                    return new Intl.NumberFormat(undefined, format).format(source);\r\n                }\r\n            }\r\n            catch (e) {\r\n                return \"Invalid\";\r\n            }\r\n        }\r\n        else {\r\n            // Clean format\r\n            format = $utils.cleanFormat(format);\r\n            // Get format info (it will also deal with parser caching)\r\n            let info = this.parseFormat(format, this._root.language);\r\n            // format and replace the number\r\n            let details;\r\n            if (source > this.get(\"negativeBase\")) {\r\n                details = info.positive;\r\n            }\r\n            else if (source < this.get(\"negativeBase\")) {\r\n                details = info.negative;\r\n            }\r\n            else {\r\n                details = info.zero;\r\n            }\r\n            // Adjust precision\r\n            if (precision != null && !details.mod) {\r\n                details = $object.copy(details);\r\n                details.decimals.active = source == 0 ? 0 : precision;\r\n            }\r\n            // Format\r\n            formatted = details.template.split($type.PLACEHOLDER).join(this.applyFormat(source, details));\r\n        }\r\n        if (this.get(\"forceLTR\") === true) {\r\n            formatted = \"\" + formatted;\r\n        }\r\n        return formatted;\r\n    }\r\n    /**\r\n     * Parses supplied format into structured object which can be used to format\r\n     * the number.\r\n     *\r\n     * @param format Format string, i.e. \"#,###.00\"\r\n     * @param language Language\r\n     * @ignore\r\n     */\r\n    parseFormat(format, language) {\r\n        // Check cache\r\n        // TODO\r\n        // let cached = this.getCache(format);\r\n        // if (cached != null) {\r\n        // \treturn cached;\r\n        // }\r\n        const thousandSeparator = language.translateEmpty(\"_thousandSeparator\");\r\n        const decimalSeparator = language.translateEmpty(\"_decimalSeparator\");\r\n        // init format parse info holder\r\n        let info = {\r\n            \"positive\": {\r\n                \"thousands\": {\r\n                    \"active\": -1,\r\n                    \"passive\": -1,\r\n                    \"interval\": -1,\r\n                    \"separator\": thousandSeparator\r\n                },\r\n                \"decimals\": {\r\n                    \"active\": -1,\r\n                    \"passive\": -1,\r\n                    \"separator\": decimalSeparator\r\n                },\r\n                \"template\": \"\",\r\n                \"source\": \"\",\r\n                \"parsed\": false\r\n            },\r\n            \"negative\": {\r\n                \"thousands\": {\r\n                    \"active\": -1,\r\n                    \"passive\": -1,\r\n                    \"interval\": -1,\r\n                    \"separator\": thousandSeparator\r\n                },\r\n                \"decimals\": {\r\n                    \"active\": -1,\r\n                    \"passive\": -1,\r\n                    \"separator\": decimalSeparator\r\n                },\r\n                \"template\": \"\",\r\n                \"source\": \"\",\r\n                \"parsed\": false\r\n            },\r\n            \"zero\": {\r\n                \"thousands\": {\r\n                    \"active\": -1,\r\n                    \"passive\": -1,\r\n                    \"interval\": -1,\r\n                    \"separator\": thousandSeparator\r\n                },\r\n                \"decimals\": {\r\n                    \"active\": -1,\r\n                    \"passive\": -1,\r\n                    \"separator\": decimalSeparator\r\n                },\r\n                \"template\": \"\",\r\n                \"source\": \"\",\r\n                \"parsed\": false\r\n            }\r\n        };\r\n        // Escape double vertical bars (that mean display one vertical bar)\r\n        format = format.replace(\"||\", $type.PLACEHOLDER2);\r\n        // Split it up and deal with different formats\r\n        let parts = format.split(\"|\");\r\n        info.positive.source = parts[0];\r\n        if (typeof parts[2] === \"undefined\") {\r\n            info.zero = info.positive;\r\n        }\r\n        else {\r\n            info.zero.source = parts[2];\r\n        }\r\n        if (typeof parts[1] === \"undefined\") {\r\n            info.negative = info.positive;\r\n        }\r\n        else {\r\n            info.negative.source = parts[1];\r\n        }\r\n        // Parse each\r\n        $object.each(info, (_part, item) => {\r\n            // Already parsed\r\n            if (item.parsed) {\r\n                return;\r\n            }\r\n            // Check cached\r\n            // TODO\r\n            // if (typeof this.getCache(item.source) !== \"undefined\") {\r\n            // \tinfo[part] = this.getCache(item.source);\r\n            // \treturn;\r\n            // }\r\n            // Begin parsing\r\n            let partFormat = item.source;\r\n            // Just \"Number\"?\r\n            if (partFormat.toLowerCase() === \"number\") {\r\n                partFormat = this.get(\"numberFormat\", \"#,###.#####\");\r\n            }\r\n            // Let TextFormatter split into chunks\r\n            let chunks = TextFormatter.chunk(partFormat, true);\r\n            for (let i = 0; i < chunks.length; i++) {\r\n                let chunk = chunks[i];\r\n                // replace back double vertical bar\r\n                chunk.text = chunk.text.replace($type.PLACEHOLDER2, \"|\");\r\n                if (chunk.type === \"value\") {\r\n                    // Parse format\r\n                    // Look for codes\r\n                    let matches = chunk.text.match(/[#0.,]+[ ]?[abespABESP%!]?[abespABESP!]?/);\r\n                    if (matches) {\r\n                        if (matches === null || matches[0] === \"\") {\r\n                            // no codes here - assume string\r\n                            // nothing to do here\r\n                            item.template += chunk.text;\r\n                        }\r\n                        else {\r\n                            // look for the format modifiers at the end\r\n                            let mods = matches[0].match(/[abespABESP%!]{2}|[abespABESP%]{1}$/);\r\n                            if (mods) {\r\n                                item.mod = mods[0].toLowerCase();\r\n                                item.modSpacing = matches[0].match(/[ ]{1}[abespABESP%!]{1}$/) ? true : false;\r\n                            }\r\n                            // break the format up\r\n                            let a = matches[0].split(\".\");\r\n                            // Deal with thousands\r\n                            if (a[0] === \"\") {\r\n                                // No directives for thousands\r\n                                // Leave default settings (no formatting)\r\n                            }\r\n                            else {\r\n                                // Counts\r\n                                item.thousands.active = (a[0].match(/0/g) || []).length;\r\n                                item.thousands.passive = (a[0].match(/\\#/g) || []).length + item.thousands.active;\r\n                                // Separator interval\r\n                                let b = a[0].split(\",\");\r\n                                if (b.length === 1) {\r\n                                    // No thousands separators\r\n                                    // Do nothing\r\n                                }\r\n                                else {\r\n                                    // Use length fo the last chunk as thousands length\r\n                                    item.thousands.interval = (b.pop() || \"\").length;\r\n                                    if (item.thousands.interval === 0) {\r\n                                        item.thousands.interval = -1;\r\n                                    }\r\n                                }\r\n                            }\r\n                            // Deal with decimals\r\n                            if (typeof (a[1]) === \"undefined\") {\r\n                                // No directives for decimals\r\n                                // Leave at defaults (no formatting)\r\n                            }\r\n                            else {\r\n                                // Counts\r\n                                item.decimals.active = (a[1].match(/0/g) || []).length;\r\n                                item.decimals.passive = (a[1].match(/\\#/g) || []).length + item.decimals.active;\r\n                            }\r\n                            // Add special code to template\r\n                            item.template += chunk.text.split(matches[0]).join($type.PLACEHOLDER);\r\n                        }\r\n                    }\r\n                }\r\n                else {\r\n                    // Quoted string - take it as it is\r\n                    item.template += chunk.text;\r\n                }\r\n            }\r\n            // Apply style formatting\r\n            //item.template = getTextFormatter().format(item.template, this.outputFormat);\r\n            // Save cache\r\n            // TODO\r\n            //this.setCache(item.source, item);\r\n            // Mark this as parsed\r\n            item.parsed = true;\r\n        });\r\n        // Save cache (the whole thing)\r\n        // TODO\r\n        //this.setCache(format, info);\r\n        return info;\r\n    }\r\n    /**\r\n     * Applies parsed format to a numeric value.\r\n     *\r\n     * @param value    Value\r\n     * @param details  Parsed format as returned by parseFormat()\r\n     * @return Formatted number\r\n     * @ignore\r\n     */\r\n    applyFormat(value, details) {\r\n        // Use absolute values\r\n        let negative = value < 0;\r\n        value = Math.abs(value);\r\n        // Recalculate according to modifier\r\n        let prefix = \"\", suffix = \"\";\r\n        let mods = details.mod ? details.mod.split(\"\") : [];\r\n        if (mods.indexOf(\"b\") !== -1) {\r\n            let a = this.applyPrefix(value, this.get(\"bytePrefixes\"), mods.indexOf(\"!\") !== -1);\r\n            value = a[0];\r\n            prefix = a[1];\r\n            suffix = a[2];\r\n            if (details.modSpacing) {\r\n                suffix = \" \" + suffix;\r\n            }\r\n        }\r\n        else if (mods.indexOf(\"a\") !== -1) {\r\n            let a = this.applyPrefix(value, value < this.get(\"smallNumberThreshold\") ? this.get(\"smallNumberPrefixes\") : this.get(\"bigNumberPrefixes\"), mods.indexOf(\"!\") !== -1);\r\n            value = a[0];\r\n            prefix = a[1];\r\n            suffix = a[2];\r\n            if (details.modSpacing) {\r\n                suffix = \" \" + suffix;\r\n            }\r\n        }\r\n        else if (mods.indexOf(\"p\") !== -1) {\r\n            let ol = Math.min(value.toString().length + 2, 21);\r\n            //value *= 100;\r\n            value = parseFloat(value.toPrecision(ol));\r\n            prefix = this._root.language.translate(\"_percentPrefix\");\r\n            suffix = this._root.language.translate(\"_percentSuffix\");\r\n            if (prefix == \"\" && suffix == \"\") {\r\n                suffix = \"%\";\r\n            }\r\n        }\r\n        else if (mods.indexOf(\"%\") !== -1) {\r\n            let ol = Math.min(value.toString().length + 2, 21);\r\n            value *= 100;\r\n            value = parseFloat(value.toPrecision(ol));\r\n            suffix = \"%\";\r\n        }\r\n        else if (mods.indexOf(\"\") !== -1) {\r\n            let ol = Math.min(value.toString().length + 3, 21);\r\n            value *= 1000;\r\n            value = parseFloat(value.toPrecision(ol));\r\n            suffix = \"\";\r\n        }\r\n        // Round to passive\r\n        if (mods.indexOf(\"e\") !== -1) {\r\n            // convert the value to exponential\r\n            let exp;\r\n            if (details.decimals.passive >= 0) {\r\n                exp = value.toExponential(details.decimals.passive).split(\"e\");\r\n            }\r\n            else {\r\n                exp = value.toExponential().split(\"e\");\r\n            }\r\n            value = Number(exp[0]);\r\n            suffix = \"e\" + exp[1];\r\n            if (details.modSpacing) {\r\n                suffix = \" \" + suffix;\r\n            }\r\n        }\r\n        else if (details.decimals.passive === 0) {\r\n            value = Math.round(value);\r\n        }\r\n        else if (details.decimals.passive > 0) {\r\n            const decimals = $utils.decimalPlaces(value);\r\n            if (decimals > 0) {\r\n                const d = Math.pow(10, details.decimals.passive);\r\n                value = Math.round(parseFloat((value * d).toFixed(decimals))) / d;\r\n            }\r\n        }\r\n        // Init return value\r\n        let res = \"\";\r\n        // Calc integer and decimal parts\r\n        let a = $type.numberToString(value).split(\".\");\r\n        // Format integers\r\n        let ints = a[0];\r\n        // Pad integers to active length\r\n        if (ints.length < details.thousands.active) {\r\n            ints = Array(details.thousands.active - ints.length + 1).join(\"0\") + ints;\r\n        }\r\n        // Insert thousands separators\r\n        if (details.thousands.interval > 0) {\r\n            let ip = [];\r\n            let intsr = ints.split(\"\").reverse().join(\"\");\r\n            for (let i = 0, len = ints.length; i <= len; i += details.thousands.interval) {\r\n                let c = intsr.substr(i, details.thousands.interval).split(\"\").reverse().join(\"\");\r\n                if (c !== \"\") {\r\n                    ip.unshift(c);\r\n                }\r\n            }\r\n            ints = ip.join(details.thousands.separator);\r\n        }\r\n        // Add integers\r\n        res += ints;\r\n        // Add decimals\r\n        if (a.length === 1) {\r\n            a.push(\"\");\r\n        }\r\n        let decs = a[1];\r\n        // Fill zeros?\r\n        if (decs.length < details.decimals.active) {\r\n            decs += Array(details.decimals.active - decs.length + 1).join(\"0\");\r\n        }\r\n        if (decs !== \"\") {\r\n            res += details.decimals.separator + decs;\r\n        }\r\n        // Can't have empty return value\r\n        if (res === \"\") {\r\n            res = \"0\";\r\n        }\r\n        // Add minus sign back\r\n        if (value !== 0 && negative && (mods.indexOf(\"s\") === -1)) {\r\n            res = \"-\" + res;\r\n        }\r\n        // Add suffixes/prefixes\r\n        if (prefix) {\r\n            res = prefix + res;\r\n        }\r\n        if (suffix) {\r\n            res += suffix;\r\n        }\r\n        return res;\r\n    }\r\n    applyPrefix(value, prefixes, force = false) {\r\n        let newvalue = value;\r\n        let prefix = \"\";\r\n        let suffix = \"\";\r\n        let applied = false;\r\n        let k = 1;\r\n        for (let i = 0, len = prefixes.length; i < len; i++) {\r\n            if (prefixes[i].number <= value) {\r\n                if (prefixes[i].number === 0) {\r\n                    newvalue = 0;\r\n                }\r\n                else {\r\n                    newvalue = value / prefixes[i].number;\r\n                    k = prefixes[i].number;\r\n                }\r\n                prefix = prefixes[i].prefix;\r\n                suffix = prefixes[i].suffix;\r\n                applied = true;\r\n            }\r\n        }\r\n        if (!applied && force && prefixes.length && value != 0) {\r\n            // Prefix was not applied. Use the first prefix.\r\n            newvalue = value / prefixes[0].number;\r\n            prefix = prefixes[0].prefix;\r\n            suffix = prefixes[0].suffix;\r\n            applied = true;\r\n        }\r\n        if (applied) {\r\n            newvalue = parseFloat(newvalue.toPrecision(Math.min(k.toString().length + Math.floor(newvalue).toString().replace(/[^0-9]*/g, \"\").length, 21)));\r\n        }\r\n        return [newvalue, prefix, suffix];\r\n    }\r\n    /**\r\n     * Replaces brackets with temporary placeholders.\r\n     *\r\n     * @ignore Exclude from docs\r\n     * @param text  Input text\r\n     * @return Escaped text\r\n     */\r\n    escape(text) {\r\n        return text.replace(\"||\", $type.PLACEHOLDER2);\r\n    }\r\n    /**\r\n     * Replaces placeholders back to brackets.\r\n     *\r\n     * @ignore Exclude from docs\r\n     * @param text  Escaped text\r\n     * @return Unescaped text\r\n     */\r\n    unescape(text) {\r\n        return text.replace($type.PLACEHOLDER2, \"|\");\r\n    }\r\n}\r\n//# sourceMappingURL=NumberFormatter.js.map","function parseDate(timezone, date) {\r\n    let year = 0;\r\n    let month = 0;\r\n    let day = 1;\r\n    let hour = 0;\r\n    let minute = 0;\r\n    let second = 0;\r\n    let millisecond = 0;\r\n    let weekday = 0;\r\n    timezone.formatToParts(date).forEach((x) => {\r\n        switch (x.type) {\r\n            case \"year\":\r\n                year = +x.value;\r\n                break;\r\n            case \"month\":\r\n                month = (+x.value) - 1;\r\n                break;\r\n            case \"day\":\r\n                day = +x.value;\r\n                break;\r\n            case \"hour\":\r\n                hour = +x.value;\r\n                break;\r\n            case \"minute\":\r\n                minute = +x.value;\r\n                break;\r\n            case \"second\":\r\n                second = +x.value;\r\n                break;\r\n            case \"fractionalSecond\":\r\n                millisecond = +x.value;\r\n                break;\r\n            case \"weekday\":\r\n                switch (x.value) {\r\n                    case \"Sun\":\r\n                        weekday = 0;\r\n                        break;\r\n                    case \"Mon\":\r\n                        weekday = 1;\r\n                        break;\r\n                    case \"Tue\":\r\n                        weekday = 2;\r\n                        break;\r\n                    case \"Wed\":\r\n                        weekday = 3;\r\n                        break;\r\n                    case \"Thu\":\r\n                        weekday = 4;\r\n                        break;\r\n                    case \"Fri\":\r\n                        weekday = 5;\r\n                        break;\r\n                    case \"Sat\":\r\n                        weekday = 6;\r\n                        break;\r\n                }\r\n        }\r\n    });\r\n    if (hour === 24) {\r\n        hour = 0;\r\n    }\r\n    return { year, month, day, hour, minute, second, millisecond, weekday };\r\n}\r\nfunction toUTCDate(timezone, date) {\r\n    const { year, month, day, hour, minute, second, millisecond } = parseDate(timezone, date);\r\n    return Date.UTC(year, month, day, hour, minute, second, millisecond);\r\n}\r\nexport class Timezone {\r\n    constructor(timezone, isReal) {\r\n        Object.defineProperty(this, \"_utc\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"_dtf\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"name\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        if (!isReal) {\r\n            throw new Error(\"You cannot use `new Class()`, instead use `Class.new()`\");\r\n        }\r\n        this.name = timezone;\r\n        this._utc = new Intl.DateTimeFormat(\"en-US\", {\r\n            hour12: false,\r\n            timeZone: \"UTC\",\r\n            year: \"numeric\",\r\n            month: \"2-digit\",\r\n            day: \"2-digit\",\r\n            hour: \"2-digit\",\r\n            minute: \"2-digit\",\r\n            second: \"2-digit\",\r\n            weekday: \"short\",\r\n            fractionalSecondDigits: 3,\r\n        });\r\n        this._dtf = new Intl.DateTimeFormat(\"en-US\", {\r\n            hour12: false,\r\n            timeZone: timezone,\r\n            year: \"numeric\",\r\n            month: \"2-digit\",\r\n            day: \"2-digit\",\r\n            hour: \"2-digit\",\r\n            minute: \"2-digit\",\r\n            second: \"2-digit\",\r\n            weekday: \"short\",\r\n            fractionalSecondDigits: 3,\r\n        });\r\n    }\r\n    /**\r\n     * Use this method to create an instance of this class.\r\n     *\r\n     * @see {@link https://www.amcharts.com/docs/v5/getting-started/#New_element_syntax} for more info\r\n     * @param   timezone  IANA timezone\r\n     * @return            Instantiated object\r\n     */\r\n    static new(timezone) {\r\n        return (new this(timezone, true));\r\n    }\r\n    convertLocal(date) {\r\n        const offset = this.offsetUTC(date);\r\n        const userOffset = date.getTimezoneOffset();\r\n        const output = new Date(date);\r\n        output.setUTCMinutes(output.getUTCMinutes() - (offset - userOffset));\r\n        const newUserOffset = output.getTimezoneOffset();\r\n        if (userOffset != newUserOffset) {\r\n            output.setUTCMinutes(output.getUTCMinutes() + newUserOffset - userOffset);\r\n        }\r\n        return output;\r\n    }\r\n    offsetUTC(date) {\r\n        const utc = toUTCDate(this._utc, date);\r\n        const dtf = toUTCDate(this._dtf, date);\r\n        return (utc - dtf) / 60000;\r\n    }\r\n    parseDate(date) {\r\n        return parseDate(this._dtf, date);\r\n    }\r\n}\r\n//# sourceMappingURL=Timezone.js.map","import { Entity } from \"./Entity\";\r\nimport { TextFormatter } from \"./TextFormatter\";\r\nimport { Timezone } from \"./Timezone\";\r\nimport * as $type from \"./Type\";\r\nimport * as $utils from \"./Utils\";\r\n/**\r\n * Date formatter class.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/concepts/formatters/formatting-dates/} for more info\r\n * @important\r\n */\r\nexport class DateFormatter extends Entity {\r\n    _setDefaults() {\r\n        // Defaults\r\n        this._setDefault(\"capitalize\", true);\r\n        this._setDefault(\"dateFormat\", \"yyyy-MM-dd\");\r\n        super._setDefaults();\r\n    }\r\n    _beforeChanged() {\r\n        super._beforeChanged();\r\n    }\r\n    /**\r\n     * Formats a source `Date` object into string format\r\n     * @param   source          inpout date\r\n     * @param   format          Output format\r\n     * @param   ignoreTimezone  Ignore timezone?\r\n     * @return                  Formatted date\r\n     */\r\n    format(source, format, ignoreTimezone = false) {\r\n        // Locale?\r\n        // TODO\r\n        // No format passed in or it's empty\r\n        if (typeof format === \"undefined\" || format === \"\") {\r\n            format = this.get(\"dateFormat\", \"yyyy-MM-dd\");\r\n        }\r\n        // Init return value\r\n        let formatted;\r\n        // Cast?\r\n        // TODO: decide if we need to cast\r\n        let date = source;\r\n        // Is it a built-in format or Intl.DateTimeFormat\r\n        if ($type.isObject(format)) {\r\n            try {\r\n                const locales = this.get(\"intlLocales\");\r\n                if (locales) {\r\n                    return new Intl.DateTimeFormat(locales, format).format(date);\r\n                }\r\n                else {\r\n                    return new Intl.DateTimeFormat(undefined, format).format(date);\r\n                }\r\n            }\r\n            catch (e) {\r\n                return \"Invalid\";\r\n            }\r\n        }\r\n        // get format info (it will also deal with parser caching)\r\n        let info = this.parseFormat(format);\r\n        // Should we apply custom time zone?\r\n        const timezone = this._root.timezone;\r\n        let originalDate = date;\r\n        if (timezone && !this._root.utc && !ignoreTimezone) {\r\n            date = timezone.convertLocal(date);\r\n        }\r\n        // Check if it's a valid date\r\n        if (!$type.isNumber(date.getTime())) {\r\n            // TODO translation\r\n            //return this._t(\"Invalid date\");\r\n            return \"Invalid date\";\r\n        }\r\n        // Apply format\r\n        formatted = this.applyFormat(date, info, ignoreTimezone, originalDate);\r\n        // Capitalize\r\n        if (this.get(\"capitalize\")) {\r\n            formatted = formatted.replace(/^.{1}/, formatted.substr(0, 1).toUpperCase());\r\n        }\r\n        // We're done\r\n        return formatted;\r\n    }\r\n    /**\r\n     * Applies format to Date.\r\n     *\r\n     * @param date      Date object\r\n     * @param info      Parsed format information\r\n     * @return Formatted date string\r\n     */\r\n    applyFormat(date, info, ignoreTimezone = false, originalDate) {\r\n        // Init return value\r\n        let res = info.template;\r\n        // Get values\r\n        let fullYear, month, weekday, day, hours, minutes, seconds, milliseconds, timestamp = date.getTime();\r\n        if (this._root.utc && !ignoreTimezone) {\r\n            fullYear = date.getUTCFullYear();\r\n            month = date.getUTCMonth();\r\n            weekday = date.getUTCDay();\r\n            day = date.getUTCDate();\r\n            hours = date.getUTCHours();\r\n            minutes = date.getUTCMinutes();\r\n            seconds = date.getUTCSeconds();\r\n            milliseconds = date.getUTCMilliseconds();\r\n        }\r\n        else {\r\n            fullYear = date.getFullYear();\r\n            month = date.getMonth();\r\n            weekday = date.getDay();\r\n            day = date.getDate();\r\n            hours = date.getHours();\r\n            minutes = date.getMinutes();\r\n            seconds = date.getSeconds();\r\n            milliseconds = date.getMilliseconds();\r\n        }\r\n        // Go through each part and format/replace it in template\r\n        for (let i = 0, len = info.parts.length; i < len; i++) {\r\n            let value = \"\";\r\n            switch (info.parts[i]) {\r\n                case \"G\":\r\n                    value = this._t(fullYear < 0\r\n                        ? \"_era_bc\"\r\n                        : \"_era_ad\");\r\n                    break;\r\n                case \"yyyy\":\r\n                    value = Math.abs(fullYear).toString();\r\n                    if (fullYear < 0) {\r\n                        value += this._t(\"_era_bc\");\r\n                    }\r\n                    break;\r\n                case \"yyy\":\r\n                case \"yy\":\r\n                case \"y\":\r\n                    value = Math.abs(fullYear).toString().substr(-info.parts[i].length);\r\n                    if (fullYear < 0) {\r\n                        value += this._t(\"_era_bc\");\r\n                    }\r\n                    break;\r\n                case \"YYYY\":\r\n                case \"YYY\":\r\n                case \"YY\":\r\n                case \"Y\":\r\n                    let year = $utils.getWeekYear(date, this._root.utc);\r\n                    if (info.parts[i] == \"YYYY\") {\r\n                        value = Math.abs(year).toString();\r\n                    }\r\n                    else {\r\n                        value = Math.abs(year).toString().substr(-info.parts[i].length);\r\n                    }\r\n                    if (year < 0) {\r\n                        value += this._t(\"_era_bc\");\r\n                    }\r\n                    break;\r\n                case \"u\":\r\n                    // @todo\r\n                    break;\r\n                case \"q\":\r\n                    value = \"\" + Math.ceil((date.getMonth() + 1) / 3);\r\n                    break;\r\n                case \"MMMMM\":\r\n                    value = this._t(this._getMonth(month)).substr(0, 1);\r\n                    break;\r\n                case \"MMMM\":\r\n                    value = this._t(this._getMonth(month));\r\n                    break;\r\n                case \"MMM\":\r\n                    value = this._t(this._getShortMonth(month));\r\n                    break;\r\n                case \"MM\":\r\n                    value = $utils.padString(month + 1, 2, \"0\");\r\n                    break;\r\n                case \"M\":\r\n                    value = (month + 1).toString();\r\n                    break;\r\n                case \"ww\":\r\n                    value = $utils.padString($utils.getWeek(date, this._root.utc), 2, \"0\");\r\n                    break;\r\n                case \"w\":\r\n                    value = $utils.getWeek(date, this._root.utc).toString();\r\n                    break;\r\n                case \"W\":\r\n                    value = $utils.getMonthWeek(date, this._root.utc).toString();\r\n                    break;\r\n                case \"dd\":\r\n                    value = $utils.padString(day, 2, \"0\");\r\n                    break;\r\n                case \"d\":\r\n                    value = day.toString();\r\n                    break;\r\n                case \"DD\":\r\n                case \"DDD\":\r\n                    value = $utils.padString($utils.getYearDay(date, this._root.utc).toString(), info.parts[i].length, \"0\");\r\n                    break;\r\n                case \"D\":\r\n                    value = $utils.getYearDay(date, this._root.utc).toString();\r\n                    break;\r\n                case \"F\":\r\n                    // @todo\r\n                    break;\r\n                case \"g\":\r\n                    // @todo\r\n                    break;\r\n                case \"t\":\r\n                    value = this._root.language.translateFunc(\"_dateOrd\").call(this, day);\r\n                    break;\r\n                case \"E\":\r\n                    value = (weekday || 7).toString();\r\n                    break;\r\n                case \"EE\":\r\n                    value = $utils.padString((weekday || 7).toString(), 2, \"0\");\r\n                    break;\r\n                case \"EEE\":\r\n                case \"eee\":\r\n                    value = this._t(this._getShortWeekday(weekday));\r\n                    break;\r\n                case \"EEEE\":\r\n                case \"eeee\":\r\n                    value = this._t(this._getWeekday(weekday));\r\n                    break;\r\n                case \"EEEEE\":\r\n                case \"eeeee\":\r\n                    value = this._t(this._getShortWeekday(weekday)).substr(0, 1);\r\n                    break;\r\n                case \"e\":\r\n                case \"ee\":\r\n                    value = (weekday - (this._root.locale.firstDayOfWeek || 1) + 1).toString();\r\n                    if (info.parts[i] == \"ee\") {\r\n                        value = $utils.padString(value, 2, \"0\");\r\n                    }\r\n                    break;\r\n                case \"a\":\r\n                    if (hours >= 12) {\r\n                        value = this._t(\"PM\");\r\n                    }\r\n                    else {\r\n                        value = this._t(\"AM\");\r\n                    }\r\n                    break;\r\n                case \"aa\":\r\n                    if (hours >= 12) {\r\n                        value = this._t(\"P.M.\");\r\n                    }\r\n                    else {\r\n                        value = this._t(\"A.M.\");\r\n                    }\r\n                    break;\r\n                case \"aaa\":\r\n                    if (hours >= 12) {\r\n                        value = this._t(\"P\");\r\n                    }\r\n                    else {\r\n                        value = this._t(\"A\");\r\n                    }\r\n                    break;\r\n                case \"h\":\r\n                    value = $utils.get12Hours(hours).toString();\r\n                    break;\r\n                case \"hh\":\r\n                    value = $utils.padString($utils.get12Hours(hours), 2, \"0\");\r\n                    break;\r\n                case \"H\":\r\n                    value = hours.toString();\r\n                    break;\r\n                case \"HH\":\r\n                    value = $utils.padString(hours, 2, \"0\");\r\n                    break;\r\n                case \"K\":\r\n                    value = $utils.get12Hours(hours, 0).toString();\r\n                    break;\r\n                case \"KK\":\r\n                    value = $utils.padString($utils.get12Hours(hours, 0), 2, \"0\");\r\n                    break;\r\n                case \"k\":\r\n                    value = (hours + 1).toString();\r\n                    break;\r\n                case \"kk\":\r\n                    value = $utils.padString(hours + 1, 2, \"0\");\r\n                    break;\r\n                case \"m\":\r\n                    value = minutes.toString();\r\n                    break;\r\n                case \"mm\":\r\n                    value = $utils.padString(minutes, 2, \"0\");\r\n                    break;\r\n                case \"s\":\r\n                    value = seconds.toString();\r\n                    break;\r\n                case \"ss\":\r\n                    value = $utils.padString(seconds, 2, \"0\");\r\n                    break;\r\n                case \"S\":\r\n                case \"SS\":\r\n                case \"SSS\":\r\n                    value = Math.round((milliseconds / 1000) * Math.pow(10, info.parts[i].length)).toString();\r\n                    break;\r\n                case \"x\":\r\n                    value = timestamp.toString();\r\n                    break;\r\n                case \"n\":\r\n                case \"nn\":\r\n                case \"nnn\":\r\n                    value = $utils.padString(milliseconds, info.parts[i].length, \"0\");\r\n                    break;\r\n                case \"z\":\r\n                    value = $utils.getTimeZone(originalDate || date, false, false, this._root.utc, this._root.timezone ? this._root.timezone.name : undefined).replace(/[+-]+[0-9]+$/, \"\");\r\n                    break;\r\n                case \"zz\":\r\n                    value = $utils.getTimeZone(originalDate || date, true, false, this._root.utc, this._root.timezone ? this._root.timezone.name : undefined);\r\n                    break;\r\n                case \"zzz\":\r\n                    value = $utils.getTimeZone(originalDate || date, false, true, this._root.utc, this._root.timezone ? this._root.timezone.name : undefined).replace(/[+-]+[0-9]+$/, \"\");\r\n                    break;\r\n                case \"zzzz\":\r\n                    value = $utils.getTimeZone(originalDate || date, true, true, this._root.utc, this._root.timezone ? this._root.timezone.name : undefined);\r\n                    break;\r\n                case \"Z\":\r\n                case \"ZZ\":\r\n                    let timezone = this._root.utc ? \"UTC\" : this._root.timezone;\r\n                    if (timezone instanceof Timezone) {\r\n                        timezone = timezone.name;\r\n                    }\r\n                    const offset = timezone ? $utils.getTimezoneOffset(timezone, originalDate || date) : date.getTimezoneOffset();\r\n                    let tz = Math.abs(offset) / 60;\r\n                    let tzh = Math.floor(tz);\r\n                    let tzm = tz * 60 - tzh * 60;\r\n                    if (this._root.utc) {\r\n                        tzh = 0;\r\n                        tzm = 0;\r\n                    }\r\n                    if (info.parts[i] == \"Z\") {\r\n                        value = \"GMT\";\r\n                        value += offset > 0 ? \"-\" : \"+\";\r\n                        value += $utils.padString(tzh, 2) + \":\" + $utils.padString(tzm, 2);\r\n                    }\r\n                    else {\r\n                        value = offset > 0 ? \"-\" : \"+\";\r\n                        value += $utils.padString(tzh, 2) + $utils.padString(tzm, 2);\r\n                    }\r\n                    break;\r\n                case \"i\":\r\n                    value = date.toISOString();\r\n                    break;\r\n                case \"I\":\r\n                    value = date.toUTCString();\r\n                    break;\r\n            }\r\n            res = res.replace($type.PLACEHOLDER, value);\r\n        }\r\n        return res;\r\n    }\r\n    /**\r\n     * Parses format into structured infromation.\r\n     *\r\n     * @param format Format template\r\n     */\r\n    parseFormat(format) {\r\n        // Check cache\r\n        // TODO: implement caching of the parsed format\r\n        // Init format parse info holder\r\n        let info = {\r\n            \"template\": \"\",\r\n            \"parts\": []\r\n        };\r\n        // Let TextFormatter split into chunks\r\n        let chunks = TextFormatter.chunk(format, true);\r\n        for (let i = 0; i < chunks.length; i++) {\r\n            let chunk = chunks[i];\r\n            if (chunk.type === \"value\") {\r\n                // Just \"Date\"?\r\n                if (chunk.text.match(/^date$/i)) {\r\n                    let dateFormat = this.get(\"dateFormat\", \"yyyy-MM-dd\");\r\n                    if (!$type.isString(dateFormat)) {\r\n                        dateFormat = \"yyyy-MM-dd\";\r\n                    }\r\n                    chunk.text = dateFormat;\r\n                }\r\n                // Find all possible parts\r\n                let matches = chunk.text.match(/G|yyyy|yyy|yy|y|YYYY|YYY|YY|Y|u|q|MMMMM|MMMM|MMM|MM|M|ww|w|W|dd|d|DDD|DD|D|F|g|EEEEE|EEEE|EEE|EE|E|eeeee|eeee|eee|ee|e|aaa|aa|a|hh|h|HH|H|KK|K|kk|k|mm|m|ss|s|SSS|SS|S|A|zzzz|zzz|zz|z|ZZ|Z|t|x|nnn|nn|n|i|I/g);\r\n                // Found?\r\n                if (matches) {\r\n                    // Populate template\r\n                    for (let x = 0; x < matches.length; x++) {\r\n                        info.parts.push(matches[x]);\r\n                        chunk.text = chunk.text.replace(matches[x], $type.PLACEHOLDER);\r\n                    }\r\n                }\r\n            }\r\n            // Apply to template\r\n            info.template += chunk.text;\r\n        }\r\n        // Save cache\r\n        // TODO\r\n        return info;\r\n    }\r\n    _months() {\r\n        return [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"];\r\n    }\r\n    _getMonth(index) {\r\n        return this._months()[index];\r\n    }\r\n    _shortMonths() {\r\n        return [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May(short)\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"];\r\n    }\r\n    _getShortMonth(index) {\r\n        return this._shortMonths()[index];\r\n    }\r\n    _weekdays() {\r\n        return [\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"];\r\n    }\r\n    _getWeekday(index) {\r\n        return this._weekdays()[index];\r\n    }\r\n    _shortWeekdays() {\r\n        return [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"];\r\n    }\r\n    _getShortWeekday(index) {\r\n        return this._shortWeekdays()[index];\r\n    }\r\n    parse(source, format, utc) {\r\n        // If UTC is not supplied, use Root setting\r\n        if (typeof utc === \"undefined\") {\r\n            utc = this._root.utc;\r\n        }\r\n        // Is it already a Date\r\n        if (source instanceof Date) {\r\n            return source;\r\n        }\r\n        // Is it a numeric timestamp\r\n        if ($type.isNumber(source)) {\r\n            return new Date(source);\r\n        }\r\n        // Are we parsing a timestamp?\r\n        if (format == \"x\") {\r\n            return new Date(parseInt(source));\r\n        }\r\n        // No? Let's check if it's string, and try converting to it if nec\r\n        if (!$type.isString(source)) {\r\n            source = source.toString();\r\n        }\r\n        // Init return value\r\n        let res;\r\n        // Init RegEx for parsing\r\n        let reg = \"\";\r\n        // Clean format\r\n        format = $utils.cleanFormat(format);\r\n        // Clip format to length of the source string\r\n        format = format.substr(0, source.length);\r\n        // Parse format\r\n        let info = this.parseFormat(format);\r\n        // Init parsed items holder\r\n        let parsedIndexes = {\r\n            \"year\": -1,\r\n            \"year3\": -1,\r\n            \"year2\": -1,\r\n            \"year1\": -1,\r\n            \"month\": -1,\r\n            \"monthShort\": -1,\r\n            \"monthLong\": -1,\r\n            \"weekdayShort\": -1,\r\n            \"weekdayLong\": -1,\r\n            \"day\": -1,\r\n            \"yearDay\": -1,\r\n            \"week\": -1,\r\n            \"hourBase0\": -1,\r\n            \"hour12Base0\": -1,\r\n            \"hourBase1\": -1,\r\n            \"hour12Base1\": -1,\r\n            \"minute\": -1,\r\n            \"second\": -1,\r\n            \"millisecond\": -1,\r\n            \"millisecondDigits\": -1,\r\n            \"am\": -1,\r\n            \"zone\": -1,\r\n            \"timestamp\": -1,\r\n            \"iso\": -1\r\n        };\r\n        // Init values\r\n        let resValues = {\r\n            \"year\": 1970,\r\n            \"month\": 0,\r\n            \"day\": 1,\r\n            \"hour\": 0,\r\n            \"minute\": 0,\r\n            \"second\": 0,\r\n            \"millisecond\": 0,\r\n            \"timestamp\": null,\r\n            \"offset\": 0,\r\n            \"utc\": utc\r\n        };\r\n        // Index adjuster\r\n        let indexAdjust = 0;\r\n        let index = 0;\r\n        // Iterate through all of the parts\r\n        for (let i = 0; i < info.parts.length; i++) {\r\n            // Set current match index\r\n            index = i + indexAdjust + 1;\r\n            switch (info.parts[i]) {\r\n                case \"yyyy\":\r\n                case \"YYYY\":\r\n                    reg += \"([0-9]{4})\";\r\n                    parsedIndexes.year = index;\r\n                    break;\r\n                case \"yyy\":\r\n                case \"YYY\":\r\n                    reg += \"([0-9]{3})\";\r\n                    parsedIndexes.year3 = index;\r\n                    break;\r\n                case \"yy\":\r\n                case \"YY\":\r\n                    reg += \"([0-9]{2})\";\r\n                    parsedIndexes.year2 = index;\r\n                    break;\r\n                case \"y\":\r\n                case \"Y\":\r\n                    reg += \"([0-9]{1})\";\r\n                    parsedIndexes.year1 = index;\r\n                    break;\r\n                case \"MMMM\":\r\n                    reg += \"(\" + this.getStringList(this._months()).join(\"|\") + \")\";\r\n                    parsedIndexes.monthLong = index;\r\n                    break;\r\n                case \"MMM\":\r\n                    reg += \"(\" + this.getStringList(this._shortMonths()).join(\"|\") + \")\";\r\n                    parsedIndexes.monthShort = index;\r\n                    break;\r\n                case \"MM\":\r\n                case \"M\":\r\n                    reg += \"([0-9]{2}|[0-9]{1})\";\r\n                    parsedIndexes.month = index;\r\n                    break;\r\n                case \"ww\":\r\n                case \"w\":\r\n                    reg += \"([0-9]{2}|[0-9]{1})\";\r\n                    parsedIndexes.week = index;\r\n                    break;\r\n                case \"dd\":\r\n                case \"d\":\r\n                    reg += \"([0-9]{2}|[0-9]{1})\";\r\n                    parsedIndexes.day = index;\r\n                    break;\r\n                case \"DDD\":\r\n                case \"DD\":\r\n                case \"D\":\r\n                    reg += \"([0-9]{3}|[0-9]{2}|[0-9]{1})\";\r\n                    parsedIndexes.yearDay = index;\r\n                    break;\r\n                case \"dddd\":\r\n                    reg += \"(\" + this.getStringList(this._weekdays()).join(\"|\") + \")\";\r\n                    parsedIndexes.weekdayLong = index;\r\n                    break;\r\n                case \"ddd\":\r\n                    reg += \"(\" + this.getStringList(this._shortWeekdays()).join(\"|\") + \")\";\r\n                    parsedIndexes.weekdayShort = index;\r\n                    break;\r\n                case \"aaa\":\r\n                case \"aa\":\r\n                case \"a\":\r\n                    // TODO: fix (escape regex)\r\n                    reg += \"(\" + this.getStringList([\"AM\", \"PM\", \"A\\.M\\.\", \"P\\.M\\.\", \"A\", \"P\"]).join(\"|\") + \")\";\r\n                    parsedIndexes.am = index;\r\n                    break;\r\n                case \"hh\":\r\n                case \"h\":\r\n                    reg += \"([0-9]{2}|[0-9]{1})\";\r\n                    parsedIndexes.hour12Base1 = index;\r\n                    break;\r\n                case \"HH\":\r\n                case \"H\":\r\n                    reg += \"([0-9]{2}|[0-9]{1})\";\r\n                    parsedIndexes.hourBase0 = index;\r\n                    break;\r\n                case \"KK\":\r\n                case \"K\":\r\n                    reg += \"([0-9]{2}|[0-9]{1})\";\r\n                    parsedIndexes.hour12Base0 = index;\r\n                    break;\r\n                case \"kk\":\r\n                case \"k\":\r\n                    reg += \"([0-9]{2}|[0-9]{1})\";\r\n                    parsedIndexes.hourBase1 = index;\r\n                    break;\r\n                case \"mm\":\r\n                case \"m\":\r\n                    reg += \"([0-9]{2}|[0-9]{1})\";\r\n                    parsedIndexes.minute = index;\r\n                    break;\r\n                case \"ss\":\r\n                case \"s\":\r\n                    reg += \"([0-9]{2}|[0-9]{1})\";\r\n                    parsedIndexes.second = index;\r\n                    break;\r\n                case \"SSS\":\r\n                case \"SS\":\r\n                case \"S\":\r\n                    reg += \"([0-9]{3}|[0-9]{2}|[0-9]{1})\";\r\n                    parsedIndexes.millisecond = index;\r\n                    parsedIndexes.millisecondDigits = info.parts[i].length;\r\n                    break;\r\n                case \"nnn\":\r\n                case \"nn\":\r\n                case \"n\":\r\n                    reg += \"([0-9]{3}|[0-9]{2}|[0-9]{1})\";\r\n                    parsedIndexes.millisecond = index;\r\n                    break;\r\n                case \"x\":\r\n                    reg += \"([0-9]{1,})\";\r\n                    parsedIndexes.timestamp = index;\r\n                    break;\r\n                case \"Z\":\r\n                    reg += \"GMT([-+]+[0-9]{2}:[0-9]{2})\";\r\n                    parsedIndexes.zone = index;\r\n                    break;\r\n                case \"ZZ\":\r\n                    reg += \"([\\\\-+]+[0-9]{2}[0-9]{2})\";\r\n                    parsedIndexes.zone = index;\r\n                    break;\r\n                case \"i\":\r\n                    reg += \"([0-9]{4})-?([0-9]{2})-?([0-9]{2})T?([0-9]{2}):?([0-9]{2}):?([0-9]{2})\\\\.?([0-9]{0,3})([zZ]|[+\\\\-][0-9]{2}:?[0-9]{2}|$)\";\r\n                    parsedIndexes.iso = index;\r\n                    indexAdjust += 7;\r\n                    break;\r\n                case \"G\":\r\n                case \"YYYY\":\r\n                case \"YYY\":\r\n                case \"YY\":\r\n                case \"Y\":\r\n                case \"MMMMM\":\r\n                case \"W\":\r\n                case \"EEEEE\":\r\n                case \"EEEE\":\r\n                case \"EEE\":\r\n                case \"EE\":\r\n                case \"E\":\r\n                case \"eeeee\":\r\n                case \"eeee\":\r\n                case \"eee\":\r\n                case \"ee\":\r\n                case \"e\":\r\n                case \"zzzz\":\r\n                case \"zzz\":\r\n                case \"zz\":\r\n                case \"z\":\r\n                case \"t\":\r\n                    // Ignore\r\n                    indexAdjust--;\r\n                    break;\r\n            }\r\n            reg += \"[^0-9]*\";\r\n        }\r\n        // Try matching\r\n        let regex = new RegExp(reg);\r\n        let matches = source.match(regex);\r\n        if (matches) {\r\n            // Populate the date object\r\n            // Full year\r\n            if (parsedIndexes.year > -1) {\r\n                resValues.year = parseInt(matches[parsedIndexes.year]);\r\n            }\r\n            // 3-digit year\r\n            if (parsedIndexes.year3 > -1) {\r\n                let val = parseInt(matches[parsedIndexes.year3]);\r\n                val += 1000;\r\n                resValues.year = val;\r\n            }\r\n            // 2-digit year\r\n            if (parsedIndexes.year2 > -1) {\r\n                let val = parseInt(matches[parsedIndexes.year2]);\r\n                if (val > 50) {\r\n                    val += 1000;\r\n                }\r\n                else {\r\n                    val += 2000;\r\n                }\r\n                resValues.year = val;\r\n            }\r\n            // 1-digit year\r\n            if (parsedIndexes.year1 > -1) {\r\n                let val = parseInt(matches[parsedIndexes.year1]);\r\n                val = Math.floor((new Date().getFullYear()) / 10) * 10 + val;\r\n                resValues.year = val;\r\n            }\r\n            // Full month\r\n            if (parsedIndexes.monthLong > -1) {\r\n                resValues.month = this.resolveMonth(matches[parsedIndexes.monthLong]);\r\n            }\r\n            // Short month\r\n            if (parsedIndexes.monthShort > -1) {\r\n                resValues.month = this.resolveShortMonth(matches[parsedIndexes.monthShort]);\r\n            }\r\n            // Numeric month\r\n            if (parsedIndexes.month > -1) {\r\n                resValues.month = parseInt(matches[parsedIndexes.month]) - 1;\r\n            }\r\n            // Weekday\r\n            // @todo\r\n            // Week\r\n            if ((parsedIndexes.week > -1) && (parsedIndexes.day === -1)) {\r\n                // We parse weeks ONLY if day is not explicitly set\r\n                // TODO: this needs work\r\n                // (but maybe later - I can hardly imagine anyone passing their dates in weeks)\r\n                resValues.month = 0;\r\n                resValues.day = $utils.getDayFromWeek(parseInt(matches[parsedIndexes.week]), resValues.year, 1, utc);\r\n            }\r\n            // Day\r\n            if (parsedIndexes.day > -1) {\r\n                resValues.day = parseInt(matches[parsedIndexes.day]);\r\n            }\r\n            // Year day\r\n            if (parsedIndexes.yearDay > -1) {\r\n                resValues.month = 0;\r\n                resValues.day = parseInt(matches[parsedIndexes.yearDay]);\r\n            }\r\n            // 24 Hour (0-23)\r\n            if (parsedIndexes.hourBase0 > -1) {\r\n                resValues.hour = parseInt(matches[parsedIndexes.hourBase0]);\r\n            }\r\n            // 24 Hour (1-24)\r\n            if (parsedIndexes.hourBase1 > -1) {\r\n                resValues.hour = parseInt(matches[parsedIndexes.hourBase1]) - 1;\r\n            }\r\n            // 12 Hour (0-11)\r\n            if (parsedIndexes.hour12Base0 > -1) {\r\n                let val = parseInt(matches[parsedIndexes.hour12Base0]);\r\n                if (val == 11) {\r\n                    val = 0;\r\n                }\r\n                if ((parsedIndexes.am > -1) && !this.isAm(matches[parsedIndexes.am])) {\r\n                    val += 12;\r\n                }\r\n                resValues.hour = val;\r\n            }\r\n            // 12 Hour (1-12)\r\n            if (parsedIndexes.hour12Base1 > -1) {\r\n                let val = parseInt(matches[parsedIndexes.hour12Base1]);\r\n                if (val == 12) {\r\n                    val = 0;\r\n                }\r\n                if ((parsedIndexes.am > -1) && !this.isAm(matches[parsedIndexes.am])) {\r\n                    val += 12;\r\n                }\r\n                resValues.hour = val;\r\n            }\r\n            // Minute\r\n            if (parsedIndexes.minute > -1) {\r\n                resValues.minute = parseInt(matches[parsedIndexes.minute]);\r\n            }\r\n            // Second\r\n            if (parsedIndexes.second > -1) {\r\n                resValues.second = parseInt(matches[parsedIndexes.second]);\r\n            }\r\n            // Millisecond\r\n            if (parsedIndexes.millisecond > -1) {\r\n                let val = parseInt(matches[parsedIndexes.millisecond]);\r\n                if (parsedIndexes.millisecondDigits == 2) {\r\n                    val *= 10;\r\n                }\r\n                else if (parsedIndexes.millisecondDigits == 1) {\r\n                    val *= 100;\r\n                }\r\n                resValues.millisecond = val;\r\n            }\r\n            // Timestamp\r\n            if (parsedIndexes.timestamp > -1) {\r\n                resValues.timestamp = parseInt(matches[parsedIndexes.timestamp]);\r\n                const ts = new Date(resValues.timestamp);\r\n                resValues.year = ts.getUTCFullYear();\r\n                resValues.month = ts.getUTCMonth();\r\n                resValues.day = ts.getUTCDate();\r\n                resValues.hour = ts.getUTCHours();\r\n                resValues.minute = ts.getUTCMinutes();\r\n                resValues.second = ts.getUTCSeconds();\r\n                resValues.millisecond = ts.getUTCMilliseconds();\r\n            }\r\n            // Adjust time zone\r\n            if (parsedIndexes.zone > -1) {\r\n                resValues.offset = this.resolveTimezoneOffset(new Date(resValues.year, resValues.month, resValues.day), matches[parsedIndexes.zone]);\r\n            }\r\n            // ISO\r\n            if (parsedIndexes.iso > -1) {\r\n                resValues.year = $type.toNumber(matches[parsedIndexes.iso + 0]);\r\n                resValues.month = $type.toNumber(matches[parsedIndexes.iso + 1]) - 1;\r\n                resValues.day = $type.toNumber(matches[parsedIndexes.iso + 2]);\r\n                resValues.hour = $type.toNumber(matches[parsedIndexes.iso + 3]);\r\n                resValues.minute = $type.toNumber(matches[parsedIndexes.iso + 4]);\r\n                resValues.second = $type.toNumber(matches[parsedIndexes.iso + 5]);\r\n                resValues.millisecond = $type.toNumber(matches[parsedIndexes.iso + 6]);\r\n                if (matches[parsedIndexes.iso + 7] == \"Z\" || matches[parsedIndexes.iso + 7] == \"z\") {\r\n                    resValues.utc = true;\r\n                }\r\n                else if (matches[parsedIndexes.iso + 7] != \"\") {\r\n                    resValues.offset = this.resolveTimezoneOffset(new Date(resValues.year, resValues.month, resValues.day), matches[parsedIndexes.iso + 7]);\r\n                }\r\n            }\r\n            // Create Date object\r\n            if (resValues.utc) {\r\n                res = new Date(Date.UTC(resValues.year, resValues.month, resValues.day, resValues.hour, resValues.minute, resValues.second, resValues.millisecond));\r\n            }\r\n            else {\r\n                res = new Date(resValues.year, resValues.month, resValues.day, resValues.hour, resValues.minute + resValues.offset, resValues.second, resValues.millisecond);\r\n            }\r\n        }\r\n        else {\r\n            // Didn't match anything\r\n            // Let's try dropping it into Date constructor and hope for the best\r\n            res = new Date(source);\r\n        }\r\n        return res;\r\n    }\r\n    resolveTimezoneOffset(date, zone) {\r\n        let value = zone.match(/([+\\-]?)([0-9]{2}):?([0-9]{2})/);\r\n        if (value) {\r\n            let match = zone.match(/([+\\-]?)([0-9]{2}):?([0-9]{2})/);\r\n            let dir = match[1];\r\n            let hour = match[2];\r\n            let minute = match[3];\r\n            let offset = parseInt(hour) * 60 + parseInt(minute);\r\n            // Adjust offset\r\n            // Making it negative does not seem to make sense, but it's right\r\n            // because of how JavaScript calculates GMT offsets\r\n            if (dir == \"+\") {\r\n                offset *= -1;\r\n            }\r\n            // Check the difference in offset\r\n            let originalOffset = (date || new Date()).getTimezoneOffset();\r\n            let diff = offset - originalOffset;\r\n            return diff;\r\n        }\r\n        return 0;\r\n    }\r\n    /**\r\n     * Resolves month name (i.e. \"December\") into a month number (11).\r\n     *\r\n     * @param value  Month name\r\n     * @return Month number\r\n     */\r\n    resolveMonth(value) {\r\n        // Let's try English first\r\n        let month = this._months().indexOf(value);\r\n        if (month > -1) {\r\n            return month;\r\n        }\r\n        // Try the translation\r\n        if (!this._root.language.isDefault()) {\r\n            month = this._root.language.translateAll(this._months()).indexOf(value);\r\n            if (month > -1) {\r\n                return month;\r\n            }\r\n        }\r\n        return 0;\r\n    }\r\n    /**\r\n     * Resolves short month name (i.e. \"Dec\") into a month number.\r\n     *\r\n     * @param value  Short month name\r\n     * @return Month number\r\n     */\r\n    resolveShortMonth(value) {\r\n        // Let's try English first\r\n        let month = this._shortMonths().indexOf(value);\r\n        if (month > -1) {\r\n            return month;\r\n        }\r\n        // Maybe long month (workaround for May)\r\n        month = this._months().indexOf(value);\r\n        if (month > -1) {\r\n            return month;\r\n        }\r\n        // Try the translation\r\n        if (this._root.language && !this._root.language.isDefault()) {\r\n            month = this._root.language.translateAll(this._shortMonths()).indexOf(value);\r\n            if (month > -1) {\r\n                return month;\r\n            }\r\n        }\r\n        return 0;\r\n    }\r\n    /**\r\n     * Checks if passed in string represents AM/PM notation in many of its\r\n     * versions.\r\n     *\r\n     * @param value  Source string\r\n     * @return Is it AM/PM?\r\n     */\r\n    isAm(value) {\r\n        let list = this.getStringList([\"AM\", \"A.M.\", \"A\"]);\r\n        return list.indexOf(value.toUpperCase()) > -1;\r\n    }\r\n    /**\r\n     * Translates list of strings.\r\n     *\r\n     * @param list  Source strings\r\n     * @return Translated strings\r\n     */\r\n    getStringList(list) {\r\n        let res = [];\r\n        for (let i = 0; i < list.length; i++) {\r\n            // translate?\r\n            if (this._root.language) {\r\n                res.push($utils.escapeForRgex(this._t(list[i])));\r\n            }\r\n            else {\r\n                res.push($utils.escapeForRgex(list[i]));\r\n            }\r\n        }\r\n        return res;\r\n    }\r\n}\r\n//# sourceMappingURL=DateFormatter.js.map","import { Entity } from \"./Entity\";\r\nimport { TextFormatter } from \"./TextFormatter\";\r\nimport * as $object from \"./Object\";\r\nimport * as $utils from \"./Utils\";\r\nimport * as $type from \"./Type\";\r\n/**\r\n * A class used to format numberic values as time duration.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/concepts/formatters/formatting-durations/} for more info\r\n */\r\nexport class DurationFormatter extends Entity {\r\n    constructor() {\r\n        super(...arguments);\r\n        /**\r\n         * Collection of aliases for units.\r\n         */\r\n        Object.defineProperty(this, \"_unitAliases\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: {\r\n                \"Y\": \"y\",\r\n                \"D\": \"d\",\r\n                \"H\": \"h\",\r\n                \"K\": \"h\",\r\n                \"k\": \"h\",\r\n                \"n\": \"S\"\r\n            }\r\n        });\r\n    }\r\n    _setDefaults() {\r\n        const dmillisecond = \"_duration_millisecond\";\r\n        const dsecond = \"_duration_second\";\r\n        const dminute = \"_duration_minute\";\r\n        const dhour = \"_duration_hour\";\r\n        const dday = \"_duration_day\";\r\n        const dweek = \"_duration_week\";\r\n        const dmonth = \"_duration_month\";\r\n        const dyear = \"_duration_year\";\r\n        const asecond = \"_second\";\r\n        const aminute = \"_minute\";\r\n        const ahour = \"_hour\";\r\n        const aday = \"_day\";\r\n        const aweek = \"_week\";\r\n        const amonth = \"_week\";\r\n        const ayear = \"_year\";\r\n        // Defaults\r\n        this._setDefault(\"negativeBase\", 0);\r\n        this._setDefault(\"baseUnit\", \"second\");\r\n        this._setDefault(\"durationFormats\", {\r\n            \"millisecond\": {\r\n                \"millisecond\": this._t(dmillisecond),\r\n                \"second\": this._t((dmillisecond + asecond)),\r\n                \"minute\": this._t((dmillisecond + aminute)),\r\n                \"hour\": this._t((dmillisecond + ahour)),\r\n                \"day\": this._t((dmillisecond + aday)),\r\n                \"week\": this._t((dmillisecond + aweek)),\r\n                \"month\": this._t((dmillisecond + amonth)),\r\n                \"year\": this._t((dmillisecond + ayear))\r\n            },\r\n            \"second\": {\r\n                \"second\": this._t((dsecond)),\r\n                \"minute\": this._t((dsecond + aminute)),\r\n                \"hour\": this._t((dsecond + ahour)),\r\n                \"day\": this._t((dsecond + aday)),\r\n                \"week\": this._t((dsecond + aweek)),\r\n                \"month\": this._t((dsecond + amonth)),\r\n                \"year\": this._t((dsecond + ayear))\r\n            },\r\n            \"minute\": {\r\n                \"minute\": this._t((dminute)),\r\n                \"hour\": this._t((dminute + ahour)),\r\n                \"day\": this._t((dminute + aday)),\r\n                \"week\": this._t((dminute + aweek)),\r\n                \"month\": this._t((dminute + amonth)),\r\n                \"year\": this._t((dminute + ayear))\r\n            },\r\n            \"hour\": {\r\n                \"hour\": this._t((dhour)),\r\n                \"day\": this._t((dhour + aday)),\r\n                \"week\": this._t((dhour + aweek)),\r\n                \"month\": this._t((dhour + amonth)),\r\n                \"year\": this._t((dhour + ayear))\r\n            },\r\n            \"day\": {\r\n                \"day\": this._t((dday)),\r\n                \"week\": this._t((dday + aweek)),\r\n                \"month\": this._t((dday + amonth)),\r\n                \"year\": this._t((dday + ayear))\r\n            },\r\n            \"week\": {\r\n                \"week\": this._t((dweek)),\r\n                \"month\": this._t((dweek + amonth)),\r\n                \"year\": this._t((dweek + ayear))\r\n            },\r\n            \"month\": {\r\n                \"month\": this._t((dmonth)),\r\n                \"year\": this._t((dmonth + ayear))\r\n            },\r\n            \"year\": {\r\n                \"year\": this._t(dyear)\r\n            }\r\n        });\r\n        super._setDefaults();\r\n    }\r\n    _beforeChanged() {\r\n        super._beforeChanged();\r\n    }\r\n    /**\r\n     * Formats the number as duration.\r\n     *\r\n     * For example `1000` (base unit seconds) would be converted to `16:40` as in\r\n     * 16 minutes and 40 seconds.\r\n     *\r\n     * @param value   Value to format\r\n     * @param format  Format to apply\r\n     * @param base    Override base unit\r\n     * @return Formatted number\r\n     */\r\n    format(value, format, base) {\r\n        // no base unit?\r\n        let baseUnit = base || this.get(\"baseUnit\");\r\n        // no format passed in or empty\r\n        if (typeof format === \"undefined\" || format === \"\") {\r\n            if (this.get(\"durationFormat\") != null) {\r\n                format = this.get(\"durationFormat\");\r\n            }\r\n            else {\r\n                format = this.getFormat($type.toNumber(value), undefined, baseUnit);\r\n            }\r\n        }\r\n        // Clean format\r\n        format = $utils.cleanFormat(format);\r\n        // get format info (it will also deal with parser caching)\r\n        let info = this.parseFormat(format, baseUnit);\r\n        // cast to number just in case\r\n        // TODO: maybe use better casting\r\n        let source = Number(value);\r\n        // format and replace the number\r\n        let details;\r\n        if (source > this.get(\"negativeBase\")) {\r\n            details = info.positive;\r\n        }\r\n        else if (source < this.get(\"negativeBase\")) {\r\n            details = info.negative;\r\n        }\r\n        else {\r\n            details = info.zero;\r\n        }\r\n        // Format\r\n        let formatted = this.applyFormat(source, details);\r\n        // Apply color?\r\n        if (details.color !== \"\") {\r\n            formatted = \"[\" + details.color + \"]\" + formatted + \"[/]\";\r\n        }\r\n        return formatted;\r\n    }\r\n    /**\r\n     * Parses supplied format into structured object which can be used to format\r\n     * the number.\r\n     *\r\n     * @param format  Format string, i.e. \"#,###.00\"\r\n     * @param base    Override base unit\r\n     * @return Parsed information\r\n     */\r\n    parseFormat(format, base) {\r\n        // Check cache\r\n        // TODO\r\n        // let cached = this.getCache(format);\r\n        // if (cached != null) {\r\n        // \treturn cached;\r\n        // }\r\n        // no base unit?\r\n        let baseUnit = base || this.get(\"baseUnit\");\r\n        // Initialize duration parsing info\r\n        let info = {\r\n            \"positive\": {\r\n                \"color\": \"\",\r\n                \"template\": \"\",\r\n                \"parts\": [],\r\n                \"source\": \"\",\r\n                \"baseUnit\": baseUnit,\r\n                \"parsed\": false,\r\n                \"absolute\": false\r\n            },\r\n            \"negative\": {\r\n                \"color\": \"\",\r\n                \"template\": \"\",\r\n                \"parts\": [],\r\n                \"source\": \"\",\r\n                \"baseUnit\": baseUnit,\r\n                \"parsed\": false,\r\n                \"absolute\": false\r\n            },\r\n            \"zero\": {\r\n                \"color\": \"\",\r\n                \"template\": \"\",\r\n                \"parts\": [],\r\n                \"source\": \"\",\r\n                \"baseUnit\": baseUnit,\r\n                \"parsed\": false,\r\n                \"absolute\": false\r\n            }\r\n        };\r\n        // Escape double vertical bars (that mean display one vertical bar)\r\n        format = format.replace(\"||\", $type.PLACEHOLDER2);\r\n        // Split it up and deal with different formats\r\n        let parts = format.split(\"|\");\r\n        info.positive.source = parts[0];\r\n        if (typeof parts[2] === \"undefined\") {\r\n            info.zero = info.positive;\r\n        }\r\n        else {\r\n            info.zero.source = parts[2];\r\n        }\r\n        if (typeof parts[1] === \"undefined\") {\r\n            info.negative = info.positive;\r\n        }\r\n        else {\r\n            info.negative.source = parts[1];\r\n        }\r\n        // Parse each\r\n        $object.each(info, (_part, item) => {\r\n            // Already parsed\r\n            if (item.parsed) {\r\n                return;\r\n            }\r\n            // Check cached\r\n            // TODO\r\n            // if (typeof this.getCache(item.source) !== \"undefined\") {\r\n            // \tinfo[part] = this.getCache(item.source);\r\n            // \treturn;\r\n            // }\r\n            // Begin parsing\r\n            let partFormat = item.source;\r\n            // Check for [] directives\r\n            let dirs = [];\r\n            dirs = item.source.match(/^\\[([^\\]]*)\\]/);\r\n            if (dirs && dirs.length && dirs[0] !== \"\") {\r\n                partFormat = item.source.substr(dirs[0].length);\r\n                item.color = dirs[1];\r\n            }\r\n            // Let TextFormatter split into chunks\r\n            let chunks = TextFormatter.chunk(partFormat, true);\r\n            for (let i = 0; i < chunks.length; i++) {\r\n                let chunk = chunks[i];\r\n                // replace back double vertical bar\r\n                chunk.text = chunk.text.replace($type.PLACEHOLDER2, \"|\");\r\n                if (chunk.type === \"value\") {\r\n                    // Just \"Duration\"?\r\n                    // if (chunk.text.toLowerCase() === \"duration\") {\r\n                    // \tchunk.text = durationFormat;\r\n                    // }\r\n                    // Check for \"a\" (absolute) modifier\r\n                    if (chunk.text.match(/[yYMdDwhHKkmsSn]+a/)) {\r\n                        item.absolute = true;\r\n                        chunk.text = chunk.text.replace(/([yYMdDwhHKkmsSn]+)a/, \"$1\");\r\n                    }\r\n                    // Find all possible parts\r\n                    let matches = chunk.text.match(/y+|Y+|M+|d+|D+|w+|h+|H+|K+|k+|m+|s+|S+|n+/g);\r\n                    if (matches) {\r\n                        // Populate template\r\n                        for (let x = 0; x < matches.length; x++) {\r\n                            // Is it an alias?\r\n                            if (matches[x] == null) {\r\n                                matches[x] = this._unitAliases[matches[x]];\r\n                            }\r\n                            item.parts.push(matches[x]);\r\n                            chunk.text = chunk.text.replace(matches[x], $type.PLACEHOLDER);\r\n                        }\r\n                    }\r\n                }\r\n                // Apply to template\r\n                item.template += chunk.text;\r\n            }\r\n            // Apply style formatting\r\n            //item.template = TextFormatter.format(item.template, this.outputFormat);\r\n            // Save cache\r\n            // TODO\r\n            //this.setCache(item.source, item);\r\n            // Mark this as parsed\r\n            item.parsed = true;\r\n        });\r\n        // Save cache (the whole thing)\r\n        // TODO\r\n        //this.setCache(format, info);\r\n        return info;\r\n    }\r\n    /**\r\n     * Applies parsed format to a numeric value.\r\n     *\r\n     * @param value    Value\r\n     * @param details  Parsed format as returned by {parseFormat}\r\n     * @return Formatted duration\r\n     */\r\n    applyFormat(value, details) {\r\n        // Use absolute values\r\n        let negative = !details.absolute && (value < this.get(\"negativeBase\"));\r\n        value = Math.abs(value);\r\n        // Recalculate to milliseconds\r\n        let tstamp = this.toTimeStamp(value, details.baseUnit);\r\n        // Init return value\r\n        let res = details.template;\r\n        const values = {\r\n            millisecond: 0,\r\n            second: 0,\r\n            minute: 0,\r\n            hour: 0,\r\n            day: 0,\r\n            week: 0,\r\n            month: 0,\r\n            year: 0\r\n        };\r\n        // Iterate through duration parts\r\n        for (let i = 0, len = details.parts.length; i < len; i++) {\r\n            // Gather the part\r\n            let part = details.parts[i];\r\n            let unit = this._toTimeUnit(part.substr(0, 1));\r\n            // Calculate current unit value\r\n            let ints;\r\n            const unitValue = this._getUnitValue(unit);\r\n            if (i < (len - 1)) {\r\n                ints = Math.floor(tstamp / unitValue);\r\n            }\r\n            else {\r\n                ints = Math.round(tstamp / unitValue);\r\n            }\r\n            values[unit] += ints;\r\n            // Reduce timestamp\r\n            tstamp -= ints * unitValue;\r\n        }\r\n        // Check if we have full unit that we need to bump up to higher unit\r\n        $object.each(values, (unit, value) => {\r\n            if (unit == \"millisecond\" && value == 1000) {\r\n                values[\"second\"]++;\r\n                values[\"millisecond\"] = 0;\r\n            }\r\n            else if (unit == \"second\" && value == 60) {\r\n                values[\"minute\"]++;\r\n                values[\"second\"] = 0;\r\n            }\r\n            else if (unit == \"minute\" && value == 60) {\r\n                values[\"hour\"]++;\r\n                values[\"minute\"] = 0;\r\n            }\r\n            else if (unit == \"hour\" && value == 24) {\r\n                values[\"day\"]++;\r\n                values[\"hour\"] = 0;\r\n            }\r\n            else if (unit == \"day\" && value == 7 && details.parts.indexOf(\"w\") !== -1) {\r\n                values[\"week\"]++;\r\n                values[\"day\"] = 0;\r\n            }\r\n            else if (unit == \"day\" && value == 30) {\r\n                values[\"month\"]++;\r\n                values[\"day\"] = 0;\r\n            }\r\n            else if (unit == \"month\" && value == 12) {\r\n                values[\"year\"]++;\r\n                values[\"month\"] = 0;\r\n            }\r\n            // if (val > 0) {\r\n            // \tres = res.replace($type.PLACEHOLDER, $utils.padString(val, 2, \"0\"));\r\n            // }\r\n            // else {\r\n            // \tres = res.replace($type.PLACEHOLDER, \"\");\r\n            // }\r\n        });\r\n        // Iterate again\r\n        for (let i = 0, len = details.parts.length; i < len; i++) {\r\n            // Gather the part\r\n            let part = details.parts[i];\r\n            let unit = this._toTimeUnit(part.substr(0, 1));\r\n            let digits = part.length;\r\n            // Calculate current unit value\r\n            res = res.replace($type.PLACEHOLDER, $utils.padString(values[unit], digits, \"0\"));\r\n        }\r\n        // Reapply negative sign\r\n        if (negative) {\r\n            res = \"-\" + res;\r\n        }\r\n        return res;\r\n    }\r\n    /**\r\n     * Converts numeric value to timestamp in milliseconds.\r\n     *\r\n     * @param value     A source value\r\n     * @param baseUnit  Base unit the source value is in: \"q\", \"s\", \"i\", \"h\", \"d\", \"w\", \"m\", \"y\"\r\n     * @return Value representation as a timestamp in milliseconds\r\n     */\r\n    toTimeStamp(value, baseUnit) {\r\n        return value * this._getUnitValue(baseUnit);\r\n    }\r\n    _toTimeUnit(code) {\r\n        switch (code) {\r\n            case \"S\":\r\n                return \"millisecond\";\r\n            case \"s\":\r\n                return \"second\";\r\n            case \"m\":\r\n                return \"minute\";\r\n            case \"h\":\r\n                return \"hour\";\r\n            case \"d\":\r\n                return \"day\";\r\n            case \"w\":\r\n                return \"week\";\r\n            case \"M\":\r\n                return \"month\";\r\n            case \"y\":\r\n                return \"year\";\r\n        }\r\n        ;\r\n    }\r\n    /**\r\n     * Returns appropriate default format for the value.\r\n     *\r\n     * If `maxValue` is sepcified, it will use that value to determine the time\r\n     * unit for the format.\r\n     *\r\n     * For example if your `baseUnit` is `\"second\"` and you pass in `10`, you\r\n     * will get `\"10\"`.\r\n     *\r\n     * However, you might want it to be formatted in the context of bigger scale,\r\n     * say 10 minutes (600 seconds). If you pass in `600` as `maxValue`, all\r\n     * values, including small ones will use format with minutes, e.g.:\r\n     * `00:10`, `00:50`, `12: 30`, etc.\r\n     *\r\n     * @param value     Value to format\r\n     * @param maxValue  Maximum value to be used to determine format\r\n     * @param baseUnit  Base unit of the value\r\n     * @return Format\r\n     */\r\n    getFormat(value, maxValue, baseUnit) {\r\n        // Is format override set?\r\n        if (this.get(\"durationFormat\") != null) {\r\n            return this.get(\"durationFormat\");\r\n        }\r\n        // Get base unit\r\n        if (!baseUnit) {\r\n            baseUnit = this.get(\"baseUnit\");\r\n        }\r\n        if (maxValue != null && value != maxValue) {\r\n            value = Math.abs(value);\r\n            maxValue = Math.abs(maxValue);\r\n            let maxUnit = this.getValueUnit(Math.max(value, maxValue), baseUnit);\r\n            return this.get(\"durationFormats\")[baseUnit][maxUnit];\r\n        }\r\n        else {\r\n            let unit = this.getValueUnit(value, baseUnit);\r\n            return this.get(\"durationFormats\")[baseUnit][unit];\r\n        }\r\n    }\r\n    /**\r\n     * Returns value's closest denominator time unit, e.g 100 seconds is\r\n     * `\"minute\"`, while 59 seconds would still be `second`.\r\n     *\r\n     * @param value     Source duration value\r\n     * @param baseUnit  Base unit\r\n     * @return Denominator\r\n     */\r\n    getValueUnit(value, baseUnit) {\r\n        // Get base unit\r\n        if (!baseUnit) {\r\n            baseUnit = this.get(\"baseUnit\");\r\n        }\r\n        // Convert to milliseconds\r\n        let currentUnit;\r\n        let ms = this.getMilliseconds(value, baseUnit);\r\n        $object.eachContinue(this._getUnitValues(), (key, val) => {\r\n            if (key == baseUnit || currentUnit) {\r\n                let num = ms / val;\r\n                if (num <= 1) {\r\n                    if (!currentUnit) {\r\n                        currentUnit = key;\r\n                    }\r\n                    return false;\r\n                }\r\n                currentUnit = key;\r\n            }\r\n            return true;\r\n        });\r\n        return currentUnit;\r\n    }\r\n    /**\r\n     * Converts value to milliseconds according to `baseUnit`.\r\n     *\r\n     * @param value     Source duration value\r\n     * @param baseUnit  Base unit\r\n     * @return Value in milliseconds\r\n     */\r\n    getMilliseconds(value, baseUnit) {\r\n        // Get base unit\r\n        if (!baseUnit) {\r\n            baseUnit = this.get(\"baseUnit\");\r\n        }\r\n        return value * this._getUnitValue(baseUnit);\r\n    }\r\n    _getUnitValue(timeUnit) {\r\n        return this._getUnitValues()[timeUnit];\r\n    }\r\n    _getUnitValues() {\r\n        return {\r\n            \"millisecond\": 1,\r\n            \"second\": 1000,\r\n            \"minute\": 60000,\r\n            \"hour\": 3600000,\r\n            \"day\": 86400000,\r\n            \"week\": 604800000,\r\n            \"month\": 2592000000,\r\n            \"year\": 31536000000,\r\n        };\r\n    }\r\n}\r\n//# sourceMappingURL=DurationFormatter.js.map","/**\r\n * amCharts 5 locale\r\n *\r\n * Locale: en\r\n * Language: International English\r\n * Author: Martynas Majeris\r\n *\r\n * Follow instructions in [on this page](https://www.amcharts.com/docs/v5/tutorials/creating-translations/) to make corrections or add new translations.\r\n *\r\n * ---\r\n * Edit but leave the header section above this line. You can remove any\r\n * subsequent comment sections.\r\n * ---\r\n *\r\n * Use this file as a template to create translations. Leave the key part in\r\n * English intact. Fill the value with a translation.\r\n *\r\n * Empty string means no translation, so default \"International English\"\r\n * will be used.\r\n *\r\n * If you need the translation to literally be an empty string, use `null`\r\n * instead.\r\n *\r\n * IMPORTANT:\r\n * When translating make good effort to keep the translation length\r\n * at least the same chartcount as the English, especially for short prompts.\r\n *\r\n * Having significantly longer prompts may distort the actual charts.\r\n *\r\n * NOTE:\r\n * Some prompts - like months or weekdays - come in two versions: full and\r\n * shortened.\r\n *\r\n * If there's no official shortened version of these in your language, and it\r\n * would not be possible to invent such short versions that don't seem weird\r\n * to native speakers of that language, fill those with the same as full\r\n * version.\r\n *\r\n * PLACEHOLDERS:\r\n * Some prompts have placeholders like \"%1\". Those will be replaced by actual\r\n * values during translation and should be retained in the translated prompts.\r\n *\r\n * Placeholder positions may be changed to better suit structure of the\r\n * sentence.\r\n *\r\n * For example \"From %1 to %2\", when actually used will replace \"%1\" with an\r\n * actual value representing range start, and \"%2\" will be replaced by end\r\n * value.\r\n *\r\n * E.g. in a Scrollbar for Value axis \"From %1 to %2\" will become\r\n * \"From 100 to 200\". You may translate \"From\" and \"to\", as well as re-arrange\r\n * the order of the prompt itself, but make sure the \"%1\" and \"%2\" remain, in\r\n * places where they will make sense.\r\n *\r\n * Save the file as language_LOCALE, i.e. `en_GB.ts`, `fr_FR.ts`, etc.\r\n */\r\nexport default {\r\n    \"firstDayOfWeek\": 1,\r\n    // Number formatting options.\r\n    // \r\n    // Please check with the local standards which separator is accepted to be\r\n    // used for separating decimals, and which for thousands.\r\n    \"_decimalSeparator\": \".\",\r\n    \"_thousandSeparator\": \",\",\r\n    // Position of the percent sign in numbers\r\n    \"_percentPrefix\": null,\r\n    \"_percentSuffix\": \"%\",\r\n    // Suffixes for numbers\r\n    // When formatting numbers, big or small numers might be reformatted to\r\n    // shorter version, by applying a suffix.\r\n    // \r\n    // For example, 1000000 might become \"1m\".\r\n    // Or 1024 might become \"1KB\" if we're formatting byte numbers.\r\n    // \r\n    // This section defines such suffixes for all such cases.\r\n    \"_big_number_suffix_3\": \"k\",\r\n    \"_big_number_suffix_6\": \"M\",\r\n    \"_big_number_suffix_9\": \"G\",\r\n    \"_big_number_suffix_12\": \"T\",\r\n    \"_big_number_suffix_15\": \"P\",\r\n    \"_big_number_suffix_18\": \"E\",\r\n    \"_big_number_suffix_21\": \"Z\",\r\n    \"_big_number_suffix_24\": \"Y\",\r\n    \"_small_number_suffix_3\": \"m\",\r\n    \"_small_number_suffix_6\": \"\",\r\n    \"_small_number_suffix_9\": \"n\",\r\n    \"_small_number_suffix_12\": \"p\",\r\n    \"_small_number_suffix_15\": \"f\",\r\n    \"_small_number_suffix_18\": \"a\",\r\n    \"_small_number_suffix_21\": \"z\",\r\n    \"_small_number_suffix_24\": \"y\",\r\n    \"_byte_suffix_B\": \"B\",\r\n    \"_byte_suffix_KB\": \"KB\",\r\n    \"_byte_suffix_MB\": \"MB\",\r\n    \"_byte_suffix_GB\": \"GB\",\r\n    \"_byte_suffix_TB\": \"TB\",\r\n    \"_byte_suffix_PB\": \"PB\",\r\n    // Default date formats for various periods.\r\n    // \r\n    // This should reflect official or de facto formatting universally accepted\r\n    // in the country translation is being made for\r\n    // Available format codes here:\r\n    // https://www.amcharts.com/docs/v5/concepts/formatters/formatting-dates/#Format_codes\r\n    // \r\n    // This will be used when formatting date/time for particular granularity,\r\n    // e.g. \"_date_hour\" will be shown whenever we need to show time as hours.\r\n    // \r\n    // \"date\" is used as in default date format when showing standalone dates.\r\n    \"_date\": \"yyyy-MM-dd\",\r\n    \"_date_millisecond\": \"mm:ss SSS\",\r\n    \"_date_millisecond_full\": \"HH:mm:ss SSS\",\r\n    \"_date_second\": \"HH:mm:ss\",\r\n    \"_date_second_full\": \"HH:mm:ss\",\r\n    \"_date_minute\": \"HH:mm\",\r\n    \"_date_minute_full\": \"HH:mm - MMM dd, yyyy\",\r\n    \"_date_hour\": \"HH:mm\",\r\n    \"_date_hour_short\": \"HH\",\r\n    \"_date_hour_full\": \"HH:mm - MMM dd, yyyy\",\r\n    \"_date_day\": \"MMM dd\",\r\n    \"_date_day_full\": \"MMM dd, yyyy\",\r\n    \"_date_week\": \"ww\",\r\n    \"_date_week_full\": \"MMM dd, yyyy\",\r\n    \"_date_month\": \"MMM\",\r\n    \"_date_month_full\": \"MMM, yyyy\",\r\n    \"_date_year\": \"yyyy\",\r\n    // Default duration formats for various base units.\r\n    // \r\n    // This will be used by DurationFormatter to format numeric values into\r\n    // duration.\r\n    // \r\n    // Notice how each duration unit comes in several versions. This is to ensure\r\n    // that each base unit is shown correctly.\r\n    // \r\n    // For example, if we have baseUnit set to \"second\", meaning our duration is\r\n    // in seconds.\r\n    // \r\n    // If we pass in `50` to formatter, it will know that we have just 50 seconds\r\n    // (less than a minute) so it will use format in `\"_duration_second\"` (\"ss\"),\r\n    // and the formatted result will be in like `\"50\"`.\r\n    // \r\n    // If we pass in `70`, which is more than a minute, the formatter will switch\r\n    // to `\"_duration_second_minute\"` (\"mm:ss\"), resulting in \"01:10\" formatted\r\n    // text.\r\n    // \r\n    // Available codes here:\r\n    // https://www.amcharts.com/docs/v4/concepts/formatters/formatting-duration/#Available_Codes\r\n    \"_duration_millisecond\": \"SSS\",\r\n    \"_duration_millisecond_second\": \"ss.SSS\",\r\n    \"_duration_millisecond_minute\": \"mm:ss SSS\",\r\n    \"_duration_millisecond_hour\": \"hh:mm:ss SSS\",\r\n    \"_duration_millisecond_day\": \"d'd' mm:ss SSS\",\r\n    \"_duration_millisecond_week\": \"d'd' mm:ss SSS\",\r\n    \"_duration_millisecond_month\": \"M'm' dd'd' mm:ss SSS\",\r\n    \"_duration_millisecond_year\": \"y'y' MM'm' dd'd' mm:ss SSS\",\r\n    \"_duration_second\": \"ss\",\r\n    \"_duration_second_minute\": \"mm:ss\",\r\n    \"_duration_second_hour\": \"hh:mm:ss\",\r\n    \"_duration_second_day\": \"d'd' hh:mm:ss\",\r\n    \"_duration_second_week\": \"d'd' hh:mm:ss\",\r\n    \"_duration_second_month\": \"M'm' dd'd' hh:mm:ss\",\r\n    \"_duration_second_year\": \"y'y' MM'm' dd'd' hh:mm:ss\",\r\n    \"_duration_minute\": \"mm\",\r\n    \"_duration_minute_hour\": \"hh:mm\",\r\n    \"_duration_minute_day\": \"d'd' hh:mm\",\r\n    \"_duration_minute_week\": \"d'd' hh:mm\",\r\n    \"_duration_minute_month\": \"M'm' dd'd' hh:mm\",\r\n    \"_duration_minute_year\": \"y'y' MM'm' dd'd' hh:mm\",\r\n    \"_duration_hour\": \"hh'h'\",\r\n    \"_duration_hour_day\": \"d'd' hh'h'\",\r\n    \"_duration_hour_week\": \"d'd' hh'h'\",\r\n    \"_duration_hour_month\": \"M'm' dd'd' hh'h'\",\r\n    \"_duration_hour_year\": \"y'y' MM'm' dd'd' hh'h'\",\r\n    \"_duration_day\": \"d'd'\",\r\n    \"_duration_day_week\": \"d'd'\",\r\n    \"_duration_day_month\": \"M'm' dd'd'\",\r\n    \"_duration_day_year\": \"y'y' MM'm' dd'd'\",\r\n    \"_duration_week\": \"w'w'\",\r\n    \"_duration_week_month\": \"w'w'\",\r\n    \"_duration_week_year\": \"w'w'\",\r\n    \"_duration_month\": \"M'm'\",\r\n    \"_duration_month_year\": \"y'y' MM'm'\",\r\n    \"_duration_year\": \"y'y'\",\r\n    // Era translations\r\n    \"_era_ad\": \"AD\",\r\n    \"_era_bc\": \"BC\",\r\n    // Day part, used in 12-hour formats, e.g. 5 P.M.\r\n    // Please note that these come in 3 variants:\r\n    // * one letter (e.g. \"A\")\r\n    // * two letters (e.g. \"AM\")\r\n    // * two letters with dots (e.g. \"A.M.\")\r\n    // \r\n    // All three need to to be translated even if they are all the same. Some\r\n    // users might use one, some the other.\r\n    \"A\": \"\",\r\n    \"P\": \"\",\r\n    \"AM\": \"\",\r\n    \"PM\": \"\",\r\n    \"A.M.\": \"\",\r\n    \"P.M.\": \"\",\r\n    // Date-related stuff.\r\n    // \r\n    // When translating months, if there's a difference, use the form which is\r\n    // best for a full date, e.g. as you would use it in \"2018 January 1\".\r\n    // \r\n    // Note that May is listed twice. This is because in English May is the same\r\n    // in both long and short forms, while in other languages it may not be the\r\n    // case. Translate \"May\" to full word, while \"May(short)\" to shortened\r\n    // version.\r\n    // \r\n    // Should month names and weekdays be capitalized or not?\r\n    // \r\n    // Rule of thumb is this: if the names should always be capitalized,\r\n    // regardless of name position within date (\"January\", \"21st January 2018\",\r\n    // etc.) use capitalized names. Otherwise enter all lowercase.\r\n    // \r\n    // The date formatter will automatically capitalize names if they are the\r\n    // first (or only) word in resulting date.\r\n    \"January\": \"\",\r\n    \"February\": \"\",\r\n    \"March\": \"\",\r\n    \"April\": \"\",\r\n    \"May\": \"\",\r\n    \"June\": \"\",\r\n    \"July\": \"\",\r\n    \"August\": \"\",\r\n    \"September\": \"\",\r\n    \"October\": \"\",\r\n    \"November\": \"\",\r\n    \"December\": \"\",\r\n    \"Jan\": \"\",\r\n    \"Feb\": \"\",\r\n    \"Mar\": \"\",\r\n    \"Apr\": \"\",\r\n    \"May(short)\": \"May\",\r\n    \"Jun\": \"\",\r\n    \"Jul\": \"\",\r\n    \"Aug\": \"\",\r\n    \"Sep\": \"\",\r\n    \"Oct\": \"\",\r\n    \"Nov\": \"\",\r\n    \"Dec\": \"\",\r\n    // Weekdays.\r\n    \"Sunday\": \"\",\r\n    \"Monday\": \"\",\r\n    \"Tuesday\": \"\",\r\n    \"Wednesday\": \"\",\r\n    \"Thursday\": \"\",\r\n    \"Friday\": \"\",\r\n    \"Saturday\": \"\",\r\n    \"Sun\": \"\",\r\n    \"Mon\": \"\",\r\n    \"Tue\": \"\",\r\n    \"Wed\": \"\",\r\n    \"Thu\": \"\",\r\n    \"Fri\": \"\",\r\n    \"Sat\": \"\",\r\n    // Date ordinal function.\r\n    // \r\n    // This is used when adding number ordinal when formatting days in dates.\r\n    // \r\n    // E.g. \"January 1st\", \"February 2nd\".\r\n    // \r\n    // The function accepts day number, and returns a string to be added to the\r\n    // day, like in default English translation, if we pass in 2, we will receive\r\n    // \"nd\" back.\r\n    \"_dateOrd\": function (day) {\r\n        let res = \"th\";\r\n        if ((day < 11) || (day > 13)) {\r\n            switch (day % 10) {\r\n                case 1:\r\n                    res = \"st\";\r\n                    break;\r\n                case 2:\r\n                    res = \"nd\";\r\n                    break;\r\n                case 3:\r\n                    res = \"rd\";\r\n                    break;\r\n            }\r\n        }\r\n        return res;\r\n    },\r\n    // Various chart controls.\r\n    // Shown as a tooltip on zoom out button.\r\n    \"Zoom Out\": \"\",\r\n    // Timeline buttons\r\n    \"Play\": \"\",\r\n    \"Stop\": \"\",\r\n    // Chart's Legend screen reader title.\r\n    \"Legend\": \"\",\r\n    // Legend's item screen reader indicator.\r\n    \"Press ENTER to toggle\": \"\",\r\n    // Shown when the chart is busy loading something.\r\n    \"Loading\": \"\",\r\n    // Shown as the first button in the breadcrumb navigation, e.g.:\r\n    // Home > First level > ...\r\n    \"Home\": \"\",\r\n    // Chart types.\r\n    // Those are used as default screen reader titles for the main chart element\r\n    // unless developer has set some more descriptive title.\r\n    \"Chart\": \"\",\r\n    \"Serial chart\": \"\",\r\n    \"X/Y chart\": \"\",\r\n    \"Pie chart\": \"\",\r\n    \"Gauge chart\": \"\",\r\n    \"Radar chart\": \"\",\r\n    \"Sankey diagram\": \"\",\r\n    \"Flow diagram\": \"\",\r\n    \"Chord diagram\": \"\",\r\n    \"TreeMap chart\": \"\",\r\n    \"Force directed tree\": \"\",\r\n    \"Sliced chart\": \"\",\r\n    // Series types.\r\n    // Used to name series by type for screen readers if they do not have their\r\n    // name set.\r\n    \"Series\": \"\",\r\n    \"Candlestick Series\": \"\",\r\n    \"OHLC Series\": \"\",\r\n    \"Column Series\": \"\",\r\n    \"Line Series\": \"\",\r\n    \"Pie Slice Series\": \"\",\r\n    \"Funnel Series\": \"\",\r\n    \"Pyramid Series\": \"\",\r\n    \"X/Y Series\": \"\",\r\n    // Map-related stuff.\r\n    \"Map\": \"\",\r\n    \"Press ENTER to zoom in\": \"\",\r\n    \"Press ENTER to zoom out\": \"\",\r\n    \"Use arrow keys to zoom in and out\": \"\",\r\n    \"Use plus and minus keys on your keyboard to zoom in and out\": \"\",\r\n    // Export-related stuff.\r\n    // These prompts are used in Export menu labels.\r\n    // \r\n    // \"Export\" is the top-level menu item.\r\n    // \r\n    // \"Image\", \"Data\", \"Print\" as second-level indicating type of export\r\n    // operation.\r\n    // \r\n    // Leave actual format untranslated, unless you absolutely know that they\r\n    // would convey more meaning in some other way.\r\n    \"Export\": \"\",\r\n    \"Image\": \"\",\r\n    \"Data\": \"\",\r\n    \"Print\": \"\",\r\n    \"Press ENTER or use arrow keys to navigate\": \"\",\r\n    \"Press ENTER to open\": \"\",\r\n    \"Press ENTER to print.\": \"\",\r\n    \"Press ENTER to export as %1.\": \"\",\r\n    \"(Press ESC to close this message)\": \"\",\r\n    \"Image Export Complete\": \"\",\r\n    \"Export operation took longer than expected. Something might have gone wrong.\": \"\",\r\n    \"Saved from\": \"\",\r\n    \"PNG\": \"\",\r\n    \"JPG\": \"\",\r\n    \"GIF\": \"\",\r\n    \"SVG\": \"\",\r\n    \"PDF\": \"\",\r\n    \"JSON\": \"\",\r\n    \"CSV\": \"\",\r\n    \"XLSX\": \"\",\r\n    \"HTML\": \"\",\r\n    // Scrollbar-related stuff.\r\n    // \r\n    // Scrollbar is a control which can zoom and pan the axes on the chart.\r\n    // \r\n    // Each scrollbar has two grips: left or right (for horizontal scrollbar) or\r\n    // upper and lower (for vertical one).\r\n    // \r\n    // Prompts change in relation to whether Scrollbar is vertical or horizontal.\r\n    // \r\n    // The final section is used to indicate the current range of selection.\r\n    \"Use TAB to select grip buttons or left and right arrows to change selection\": \"\",\r\n    \"Use left and right arrows to move selection\": \"\",\r\n    \"Use left and right arrows to move left selection\": \"\",\r\n    \"Use left and right arrows to move right selection\": \"\",\r\n    \"Use TAB select grip buttons or up and down arrows to change selection\": \"\",\r\n    \"Use up and down arrows to move selection\": \"\",\r\n    \"Use up and down arrows to move lower selection\": \"\",\r\n    \"Use up and down arrows to move upper selection\": \"\",\r\n    \"From %1 to %2\": \"\",\r\n    \"From %1\": \"\",\r\n    \"To %1\": \"\",\r\n    // Data loader-related.\r\n    \"No parser available for file: %1\": \"\",\r\n    \"Error parsing file: %1\": \"\",\r\n    \"Unable to load file: %1\": \"\",\r\n    \"Invalid date\": \"\",\r\n    // Common actions\r\n    \"Close\": \"\",\r\n    \"Minimize\": \"\",\r\n    \"Confirm\": \"\"\r\n};\r\n//# sourceMappingURL=en.js.map","import { Entity } from \"./Entity\";\r\nimport * as $array from \"./Array\";\r\nimport * as $object from \"./Object\";\r\nimport en from \"../../../locales/en\";\r\n;\r\n/**\r\n * Add localization functionality.\r\n */\r\nexport class Language extends Entity {\r\n    _setDefaults() {\r\n        this.setPrivate(\"defaultLocale\", en);\r\n        super._setDefaults();\r\n    }\r\n    /**\r\n     * Returns a prompt translation.\r\n     *\r\n     * @param   prompt   Prompt to translate\r\n     * @param   locale   Target locale\r\n     * @param   ...rest  Parameters\r\n     * @return           Translation\r\n     */\r\n    translate(prompt, locale, ...rest) {\r\n        // Get langauge\r\n        if (!locale) {\r\n            locale = this._root.locale || this.getPrivate(\"defaultLocale\");\r\n        }\r\n        // Init translation\r\n        let translation = prompt;\r\n        let value = locale[prompt];\r\n        // Try to look for the translation\r\n        if (value === null) {\r\n            translation = \"\";\r\n        }\r\n        else if (value != null) {\r\n            // It might be an empty string\r\n            if (value) {\r\n                translation = value;\r\n            }\r\n        }\r\n        else if (locale !== this.getPrivate(\"defaultLocale\")) {\r\n            // Try to look in default language\r\n            return this.translate(prompt, this.getPrivate(\"defaultLocale\"), ...rest);\r\n        }\r\n        // Replace %1, %2, etc params\r\n        if (rest.length) {\r\n            for (let len = rest.length, i = 0; i < len; ++i) {\r\n                translation = translation.split(\"%\" + (i + 1)).join(rest[i]);\r\n            }\r\n        }\r\n        // Return the translation\r\n        return translation;\r\n    }\r\n    /**\r\n     * Returns a prompt translation, including custom prompts.\r\n     *\r\n     * @param   prompt   Prompt to translate\r\n     * @param   locale   Target locale\r\n     * @param   ...rest  Parameters\r\n     * @return           Translation\r\n     */\r\n    translateAny(prompt, locale, ...rest) {\r\n        return this.translate(prompt, locale, ...rest);\r\n    }\r\n    /**\r\n     * Add a custom prompt to locale.\r\n     *\r\n     * @see {@link https://www.amcharts.com/docs/v5/concepts/locales/creating-translations/#Extending_locale_with_custom_prompts}\r\n     * @param  prompt       Source prompt\r\n     * @param  translation  Tanslation\r\n     * @param  locale       Target locale\r\n     */\r\n    setTranslationAny(prompt, translation, locale) {\r\n        const localeTarget = locale || this._root.locale;\r\n        localeTarget[prompt] = translation;\r\n    }\r\n    /**\r\n     * Add a batch of custom prompts.\r\n     *\r\n     * @since 5.3.3\r\n     * @see {@link https://www.amcharts.com/docs/v5/concepts/locales/creating-translations/#Extending_locale_with_custom_prompts}\r\n     * @param  translations  Translations\r\n     * @param  locale        Target locale\r\n     */\r\n    setTranslationsAny(translations, locale) {\r\n        $object.each(translations, (key, val) => {\r\n            this.setTranslationAny(key, val, locale);\r\n        });\r\n    }\r\n    translateEmpty(prompt, locale, ...rest) {\r\n        let translation = this.translate(prompt, locale, ...rest);\r\n        return translation == prompt ? \"\" : translation;\r\n    }\r\n    translateFunc(prompt, locale) {\r\n        if (this._root.locale[prompt]) {\r\n            return this._root.locale[prompt];\r\n        }\r\n        // Try to look in default language\r\n        if (locale !== this.getPrivate(\"defaultLocale\")) {\r\n            return this.translateFunc(prompt, this.getPrivate(\"defaultLocale\"));\r\n        }\r\n        // Fail - return empty function\r\n        return () => {\r\n            return \"\";\r\n        };\r\n    }\r\n    /**\r\n     * Translates a btach of prompts.\r\n     *\r\n     * @param  list    Array of prompts to translate\r\n     * @param  locale  Target locale\r\n     * @return         Array of translations\r\n     */\r\n    translateAll(list, locale) {\r\n        // Translate all items in the list\r\n        if (!this.isDefault()) {\r\n            return $array.map(list, (x) => this.translate(x, locale));\r\n        }\r\n        else {\r\n            return list;\r\n        }\r\n    }\r\n    /**\r\n     * Returns `true` if the currently selected locale is a default locale.\r\n     *\r\n     * @return `true` if locale is default; `false` if it is not.\r\n     */\r\n    isDefault() {\r\n        return this.getPrivate(\"defaultLocale\") === this._root.locale;\r\n    }\r\n}\r\n//# sourceMappingURL=Language.js.map","/**\r\n * Modified from Pixi:\r\n *\r\n * The MIT License\r\n *\r\n * Copyright (c) 2013-2017 Mathew Groves, Chad Engler\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to deal\r\n * in the Software without restriction, including without limitation the rights\r\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\n * copies of the Software, and to permit persons to whom the Software is\r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n * THE SOFTWARE.\r\n */\r\n/**\r\n * @ignore\r\n */\r\nexport class Matrix {\r\n    constructor(a = 1, b = 0, c = 0, d = 1, tx = 0, ty = 0) {\r\n        Object.defineProperty(this, \"a\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"b\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"c\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"d\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"tx\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"ty\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        this.a = a;\r\n        this.b = b;\r\n        this.c = c;\r\n        this.d = d;\r\n        this.tx = tx;\r\n        this.ty = ty;\r\n    }\r\n    /**\r\n     * Sets the matrix based on all the available properties\r\n     */\r\n    setTransform(x, y, pivotX, pivotY, rotation, scale = 1) {\r\n        this.a = Math.cos(rotation) * scale;\r\n        this.b = Math.sin(rotation) * scale;\r\n        this.c = -Math.sin(rotation) * scale;\r\n        this.d = Math.cos(rotation) * scale;\r\n        this.tx = x - ((pivotX * this.a) + (pivotY * this.c));\r\n        this.ty = y - ((pivotX * this.b) + (pivotY * this.d));\r\n    }\r\n    /**\r\n     * Get a new position with the current transformation applied.\r\n     * Can be used to go from a child's coordinate space to the world coordinate space. (e.g. rendering)\r\n     */\r\n    apply(origin) {\r\n        return {\r\n            x: (this.a * origin.x) + (this.c * origin.y) + this.tx,\r\n            y: (this.b * origin.x) + (this.d * origin.y) + this.ty\r\n        };\r\n    }\r\n    /**\r\n     * Get a new position with the inverse of the current transformation applied.\r\n     * Can be used to go from the world coordinate space to a child's coordinate space. (e.g. input)\r\n     */\r\n    applyInverse(origin) {\r\n        const id = 1 / ((this.a * this.d) + (this.c * -this.b));\r\n        return {\r\n            x: (this.d * id * origin.x) + (-this.c * id * origin.y) + (((this.ty * this.c) - (this.tx * this.d)) * id),\r\n            y: (this.a * id * origin.y) + (-this.b * id * origin.x) + (((-this.ty * this.a) + (this.tx * this.b)) * id)\r\n        };\r\n    }\r\n    /**\r\n     * Appends the given Matrix to this Matrix.\r\n     */\r\n    append(matrix) {\r\n        const a1 = this.a;\r\n        const b1 = this.b;\r\n        const c1 = this.c;\r\n        const d1 = this.d;\r\n        this.a = (matrix.a * a1) + (matrix.b * c1);\r\n        this.b = (matrix.a * b1) + (matrix.b * d1);\r\n        this.c = (matrix.c * a1) + (matrix.d * c1);\r\n        this.d = (matrix.c * b1) + (matrix.d * d1);\r\n        this.tx = (matrix.tx * a1) + (matrix.ty * c1) + this.tx;\r\n        this.ty = (matrix.tx * b1) + (matrix.ty * d1) + this.ty;\r\n    }\r\n    /**\r\n     * Prepends the given Matrix to this Matrix.\r\n     */\r\n    prepend(matrix) {\r\n        const tx1 = this.tx;\r\n        if (matrix.a !== 1 || matrix.b !== 0 || matrix.c !== 0 || matrix.d !== 1) {\r\n            const a1 = this.a;\r\n            const c1 = this.c;\r\n            this.a = (a1 * matrix.a) + (this.b * matrix.c);\r\n            this.b = (a1 * matrix.b) + (this.b * matrix.d);\r\n            this.c = (c1 * matrix.a) + (this.d * matrix.c);\r\n            this.d = (c1 * matrix.b) + (this.d * matrix.d);\r\n        }\r\n        this.tx = (tx1 * matrix.a) + (this.ty * matrix.c) + matrix.tx;\r\n        this.ty = (tx1 * matrix.b) + (this.ty * matrix.d) + matrix.ty;\r\n    }\r\n    /**\r\n     * Copies the other matrix's properties into this matrix\r\n     */\r\n    copyFrom(matrix) {\r\n        this.a = matrix.a;\r\n        this.b = matrix.b;\r\n        this.c = matrix.c;\r\n        this.d = matrix.d;\r\n        this.tx = matrix.tx;\r\n        this.ty = matrix.ty;\r\n    }\r\n}\r\n//# sourceMappingURL=Matrix.js.map","var _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar TAU = Math.PI * 2;\n\nvar mapToEllipse = function mapToEllipse(_ref, rx, ry, cosphi, sinphi, centerx, centery) {\n  var x = _ref.x,\n      y = _ref.y;\n\n  x *= rx;\n  y *= ry;\n\n  var xp = cosphi * x - sinphi * y;\n  var yp = sinphi * x + cosphi * y;\n\n  return {\n    x: xp + centerx,\n    y: yp + centery\n  };\n};\n\nvar approxUnitArc = function approxUnitArc(ang1, ang2) {\n  // If 90 degree circular arc, use a constant\n  // as derived from http://spencermortensen.com/articles/bezier-circle\n  var a = ang2 === 1.5707963267948966 ? 0.551915024494 : ang2 === -1.5707963267948966 ? -0.551915024494 : 4 / 3 * Math.tan(ang2 / 4);\n\n  var x1 = Math.cos(ang1);\n  var y1 = Math.sin(ang1);\n  var x2 = Math.cos(ang1 + ang2);\n  var y2 = Math.sin(ang1 + ang2);\n\n  return [{\n    x: x1 - y1 * a,\n    y: y1 + x1 * a\n  }, {\n    x: x2 + y2 * a,\n    y: y2 - x2 * a\n  }, {\n    x: x2,\n    y: y2\n  }];\n};\n\nvar vectorAngle = function vectorAngle(ux, uy, vx, vy) {\n  var sign = ux * vy - uy * vx < 0 ? -1 : 1;\n\n  var dot = ux * vx + uy * vy;\n\n  if (dot > 1) {\n    dot = 1;\n  }\n\n  if (dot < -1) {\n    dot = -1;\n  }\n\n  return sign * Math.acos(dot);\n};\n\nvar getArcCenter = function getArcCenter(px, py, cx, cy, rx, ry, largeArcFlag, sweepFlag, sinphi, cosphi, pxp, pyp) {\n  var rxsq = Math.pow(rx, 2);\n  var rysq = Math.pow(ry, 2);\n  var pxpsq = Math.pow(pxp, 2);\n  var pypsq = Math.pow(pyp, 2);\n\n  var radicant = rxsq * rysq - rxsq * pypsq - rysq * pxpsq;\n\n  if (radicant < 0) {\n    radicant = 0;\n  }\n\n  radicant /= rxsq * pypsq + rysq * pxpsq;\n  radicant = Math.sqrt(radicant) * (largeArcFlag === sweepFlag ? -1 : 1);\n\n  var centerxp = radicant * rx / ry * pyp;\n  var centeryp = radicant * -ry / rx * pxp;\n\n  var centerx = cosphi * centerxp - sinphi * centeryp + (px + cx) / 2;\n  var centery = sinphi * centerxp + cosphi * centeryp + (py + cy) / 2;\n\n  var vx1 = (pxp - centerxp) / rx;\n  var vy1 = (pyp - centeryp) / ry;\n  var vx2 = (-pxp - centerxp) / rx;\n  var vy2 = (-pyp - centeryp) / ry;\n\n  var ang1 = vectorAngle(1, 0, vx1, vy1);\n  var ang2 = vectorAngle(vx1, vy1, vx2, vy2);\n\n  if (sweepFlag === 0 && ang2 > 0) {\n    ang2 -= TAU;\n  }\n\n  if (sweepFlag === 1 && ang2 < 0) {\n    ang2 += TAU;\n  }\n\n  return [centerx, centery, ang1, ang2];\n};\n\nvar arcToBezier = function arcToBezier(_ref2) {\n  var px = _ref2.px,\n      py = _ref2.py,\n      cx = _ref2.cx,\n      cy = _ref2.cy,\n      rx = _ref2.rx,\n      ry = _ref2.ry,\n      _ref2$xAxisRotation = _ref2.xAxisRotation,\n      xAxisRotation = _ref2$xAxisRotation === undefined ? 0 : _ref2$xAxisRotation,\n      _ref2$largeArcFlag = _ref2.largeArcFlag,\n      largeArcFlag = _ref2$largeArcFlag === undefined ? 0 : _ref2$largeArcFlag,\n      _ref2$sweepFlag = _ref2.sweepFlag,\n      sweepFlag = _ref2$sweepFlag === undefined ? 0 : _ref2$sweepFlag;\n\n  var curves = [];\n\n  if (rx === 0 || ry === 0) {\n    return [];\n  }\n\n  var sinphi = Math.sin(xAxisRotation * TAU / 360);\n  var cosphi = Math.cos(xAxisRotation * TAU / 360);\n\n  var pxp = cosphi * (px - cx) / 2 + sinphi * (py - cy) / 2;\n  var pyp = -sinphi * (px - cx) / 2 + cosphi * (py - cy) / 2;\n\n  if (pxp === 0 && pyp === 0) {\n    return [];\n  }\n\n  rx = Math.abs(rx);\n  ry = Math.abs(ry);\n\n  var lambda = Math.pow(pxp, 2) / Math.pow(rx, 2) + Math.pow(pyp, 2) / Math.pow(ry, 2);\n\n  if (lambda > 1) {\n    rx *= Math.sqrt(lambda);\n    ry *= Math.sqrt(lambda);\n  }\n\n  var _getArcCenter = getArcCenter(px, py, cx, cy, rx, ry, largeArcFlag, sweepFlag, sinphi, cosphi, pxp, pyp),\n      _getArcCenter2 = _slicedToArray(_getArcCenter, 4),\n      centerx = _getArcCenter2[0],\n      centery = _getArcCenter2[1],\n      ang1 = _getArcCenter2[2],\n      ang2 = _getArcCenter2[3];\n\n  // If 'ang2' == 90.0000000001, then `ratio` will evaluate to\n  // 1.0000000001. This causes `segments` to be greater than one, which is an\n  // unecessary split, and adds extra points to the bezier curve. To alleviate\n  // this issue, we round to 1.0 when the ratio is close to 1.0.\n\n\n  var ratio = Math.abs(ang2) / (TAU / 4);\n  if (Math.abs(1.0 - ratio) < 0.0000001) {\n    ratio = 1.0;\n  }\n\n  var segments = Math.max(Math.ceil(ratio), 1);\n\n  ang2 /= segments;\n\n  for (var i = 0; i < segments; i++) {\n    curves.push(approxUnitArc(ang1, ang2));\n    ang1 += ang2;\n  }\n\n  return curves.map(function (curve) {\n    var _mapToEllipse = mapToEllipse(curve[0], rx, ry, cosphi, sinphi, centerx, centery),\n        x1 = _mapToEllipse.x,\n        y1 = _mapToEllipse.y;\n\n    var _mapToEllipse2 = mapToEllipse(curve[1], rx, ry, cosphi, sinphi, centerx, centery),\n        x2 = _mapToEllipse2.x,\n        y2 = _mapToEllipse2.y;\n\n    var _mapToEllipse3 = mapToEllipse(curve[2], rx, ry, cosphi, sinphi, centerx, centery),\n        x = _mapToEllipse3.x,\n        y = _mapToEllipse3.y;\n\n    return { x1: x1, y1: y1, x2: x2, y2: y2, x: x, y: y };\n  });\n};\n\nexport default arcToBezier;","/** @ignore */ /** */\r\nimport { BlendMode } from \"./Renderer\";\r\nimport { Color } from \"../../util/Color\";\r\nimport { Matrix } from \"../../util/Matrix\";\r\nimport { Percent, percent } from \"../../util/Percent\";\r\n//import { Throttler } from \"../../util/Throttler\";\r\nimport { ArrayDisposer, Disposer, DisposerClass, CounterDisposer, MultiDisposer } from \"../../util/Disposer\";\r\nimport { TextFormatter } from \"../../util/TextFormatter\";\r\nimport * as $utils from \"../../util/Utils\";\r\nimport * as $array from \"../../util/Array\";\r\nimport * as $object from \"../../util/Object\";\r\nimport * as $type from \"../../util/Type\";\r\nimport * as $math from \"../../util/Math\";\r\nimport arcToBezier from 'svg-arc-to-cubic-bezier';\r\n/**\r\n * @ignore\r\n */\r\nfunction checkArgs(name, actual, expected) {\r\n    if (actual !== expected) {\r\n        throw new Error(\"Required \" + expected + \" arguments for \" + name + \" but got \" + actual);\r\n    }\r\n}\r\n/**\r\n * @ignore\r\n */\r\nfunction checkMinArgs(name, actual, expected) {\r\n    if (actual < expected) {\r\n        throw new Error(\"Required at least \" + expected + \" arguments for \" + name + \" but got \" + actual);\r\n    }\r\n}\r\n/**\r\n * @ignore\r\n */\r\nfunction checkEvenArgs(name, actual, expected) {\r\n    checkMinArgs(name, actual, expected);\r\n    if ((actual % expected) !== 0) {\r\n        throw new Error(\"Arguments for \" + name + \" must be in pairs of \" + expected);\r\n    }\r\n}\r\n/**\r\n * @ignore\r\n * This splits the flag so that way 0017 will be processed as 0 0 17\r\n *\r\n * This is important for weird paths like `M17 5A1 1 0 0017 30 1 1 0 0017 5`\r\n */\r\nfunction splitArcFlags(args) {\r\n    for (let i = 0; i < args.length; i += 7) {\r\n        let index = i + 3;\r\n        let flag = args[index];\r\n        if (flag.length > 1) {\r\n            const a = /^([01])([01])(.*)$/.exec(flag);\r\n            if (a !== null) {\r\n                args.splice(index, 0, a[1]);\r\n                ++index;\r\n                args.splice(index, 0, a[2]);\r\n                ++index;\r\n                if (a[3].length > 0) {\r\n                    args[index] = a[3];\r\n                }\r\n                else {\r\n                    args.splice(index, 1);\r\n                }\r\n            }\r\n        }\r\n        ++index;\r\n        flag = args[index];\r\n        if (flag.length > 1) {\r\n            const a = /^([01])(.+)$/.exec(flag);\r\n            if (a !== null) {\r\n                args.splice(index, 0, a[1]);\r\n                ++index;\r\n                args[index] = a[2];\r\n            }\r\n        }\r\n    }\r\n}\r\n/**\r\n * @ignore\r\n */\r\nfunction assertBinary(value) {\r\n    if (value === 0 || value === 1) {\r\n        return value;\r\n    }\r\n    else {\r\n        throw new Error(\"Flag must be 0 or 1\");\r\n    }\r\n}\r\n//  1 -> 0xffffff * (2 / 2)\r\n//  2 -> 0xffffff * (1 / 2)\r\n//\r\n//  3 -> 0xffffff * (3 / 4)\r\n//  4 -> 0xffffff * (1 / 4)\r\n//\r\n//  5 -> 0xffffff * (7 / 8)\r\n//  6 -> 0xffffff * (5 / 8)\r\n//  7 -> 0xffffff * (3 / 8)\r\n//  8 -> 0xffffff * (1 / 8)\r\n//\r\n//  9 -> 0xffffff * (15 / 16)\r\n// 10 -> 0xffffff * (13 / 16)\r\n// 11 -> 0xffffff * (11 / 16)\r\n// 12 -> 0xffffff *  (9 / 16)\r\n// 13 -> 0xffffff *  (7 / 16)\r\n// 14 -> 0xffffff *  (5 / 16)\r\n// 15 -> 0xffffff *  (3 / 16)\r\n// 16 -> 0xffffff *  (1 / 16)\r\n// @todo remove this old color distribution algo if the new one pans out\r\n/*function distributeId(id: number): number {\r\n    if (id === 1) {\r\n        return 0x000001;\r\n\r\n    } else {\r\n        // Finds the closest power of 2\r\n        const base = Math.pow(2, Math.ceil(Math.log(id) / Math.log(2)));\r\n\r\n        // Translates the id into an odd fraction index\r\n        const index = ((base - id) * 2) + 1;\r\n\r\n        // TODO is Math.round correct ?\r\n        return Math.round(0xffffff * (index / base));\r\n    }\r\n}*/\r\n/**\r\n * Function by smeans:\r\n * https://lowcode.life/generating-unique-contrasting-colors-in-javascript/\r\n * @ignore\r\n */\r\nfunction distributeId(id) {\r\n    const rgb = [0, 0, 0];\r\n    for (let i = 0; i < 24; i++) {\r\n        rgb[i % 3] <<= 1;\r\n        rgb[i % 3] |= id & 0x01;\r\n        id >>= 1;\r\n    }\r\n    return (rgb[0] | 0) + (rgb[1] << 8) + (rgb[2] << 16);\r\n}\r\n/**\r\n * @ignore\r\n */\r\nfunction eachTargets(hitTarget, f) {\r\n    for (;;) {\r\n        if (hitTarget.interactive) {\r\n            if (!f(hitTarget)) {\r\n                break;\r\n            }\r\n        }\r\n        if (hitTarget._parent) {\r\n            hitTarget = hitTarget._parent;\r\n        }\r\n        else {\r\n            break;\r\n        }\r\n    }\r\n}\r\n// TODO feature detection for mouse/touch/pointer\r\n/**\r\n * @ignore\r\n */\r\nfunction onPointerEvent(element, name, f) {\r\n    return $utils.addEventListener(element, $utils.getRendererEvent(name), (event) => {\r\n        const target = $utils.getEventTarget(event);\r\n        let touches = event.touches;\r\n        if (touches) {\r\n            if (touches.length == 0) {\r\n                touches = event.changedTouches;\r\n            }\r\n            f($array.copy(touches), target);\r\n        }\r\n        else {\r\n            f([event], target);\r\n        }\r\n    });\r\n}\r\n/**\r\n * @ignore\r\n */\r\nfunction isTainted(image) {\r\n    const canvas = document.createElement(\"canvas\");\r\n    canvas.width = 1;\r\n    canvas.height = 1;\r\n    const context = canvas.getContext(\"2d\", { willReadFrequently: true });\r\n    context.drawImage(image, 0, 0, 1, 1);\r\n    try {\r\n        context.getImageData(0, 0, 1, 1);\r\n        return false;\r\n    }\r\n    catch (err) {\r\n        console.warn(\"Image \\\"\" + image.src + \"\\\" is loaded from different host and is not covered by CORS policy. For more information about the implications read here: https://www.amcharts.com/docs/v5/concepts/cors\");\r\n        return true;\r\n    }\r\n}\r\n/**\r\n * This is needed to workaround a bug in iOS which causes it to not GC canvas elements.\r\n *\r\n * @ignore\r\n */\r\nfunction clearCanvas(view) {\r\n    view.width = 0;\r\n    view.height = 0;\r\n    view.style.width = \"0px\";\r\n    view.style.height = \"0px\";\r\n}\r\n/**\r\n * Aligns the coordinate to the pixel, so it renders crisp\r\n *\r\n * @ignore\r\n */\r\nfunction crisp(x) {\r\n    return Math.floor(x) + .5;\r\n}\r\n/**\r\n * @ignore\r\n */\r\nexport class CanvasPivot {\r\n    constructor() {\r\n        Object.defineProperty(this, \"_x\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: 0\r\n        });\r\n        Object.defineProperty(this, \"_y\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: 0\r\n        });\r\n    }\r\n    get x() {\r\n        return this._x;\r\n    }\r\n    get y() {\r\n        return this._y;\r\n    }\r\n    set x(value) {\r\n        this._x = value;\r\n    }\r\n    set y(value) {\r\n        this._y = value;\r\n    }\r\n}\r\n/**\r\n * @ignore\r\n */\r\nexport class CanvasDisplayObject extends DisposerClass {\r\n    constructor(renderer) {\r\n        super();\r\n        Object.defineProperty(this, \"_layer\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"mask\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: null\r\n        });\r\n        Object.defineProperty(this, \"visible\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: true\r\n        });\r\n        Object.defineProperty(this, \"exportable\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: true\r\n        });\r\n        Object.defineProperty(this, \"interactive\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: false\r\n        });\r\n        Object.defineProperty(this, \"inactive\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: null\r\n        });\r\n        Object.defineProperty(this, \"wheelable\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: false\r\n        });\r\n        Object.defineProperty(this, \"cancelTouch\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: false\r\n        });\r\n        Object.defineProperty(this, \"isMeasured\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: false\r\n        });\r\n        Object.defineProperty(this, \"buttonMode\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: false\r\n        });\r\n        Object.defineProperty(this, \"alpha\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: 1\r\n        });\r\n        Object.defineProperty(this, \"compoundAlpha\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: 1\r\n        });\r\n        Object.defineProperty(this, \"angle\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: 0\r\n        });\r\n        Object.defineProperty(this, \"scale\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: 1\r\n        });\r\n        Object.defineProperty(this, \"x\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: 0\r\n        });\r\n        Object.defineProperty(this, \"y\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: 0\r\n        });\r\n        Object.defineProperty(this, \"crisp\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: false\r\n        });\r\n        Object.defineProperty(this, \"pivot\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: new CanvasPivot()\r\n        });\r\n        Object.defineProperty(this, \"filter\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"cursorOverStyle\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"_replacedCursorStyle\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"_localMatrix\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: new Matrix()\r\n        });\r\n        Object.defineProperty(this, \"_matrix\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: new Matrix()\r\n        });\r\n        // TODO can this be replaced with _localMatrix ?\r\n        Object.defineProperty(this, \"_uMatrix\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: new Matrix()\r\n        });\r\n        Object.defineProperty(this, \"_renderer\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"_parent\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"_localBounds\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"_bounds\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"_colorId\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        this._renderer = renderer;\r\n    }\r\n    subStatus(status) {\r\n        return {\r\n            inactive: (this.inactive == null ? status.inactive : this.inactive),\r\n            layer: this._layer || status.layer,\r\n        };\r\n    }\r\n    _dispose() {\r\n        this._renderer._removeObject(this);\r\n        this.getLayer().dirty = true;\r\n    }\r\n    getCanvas() {\r\n        return this.getLayer().view;\r\n    }\r\n    getLayer() {\r\n        let self = this;\r\n        for (;;) {\r\n            if (self._layer) {\r\n                return self._layer;\r\n            }\r\n            else if (self._parent) {\r\n                self = self._parent;\r\n            }\r\n            else {\r\n                return this._renderer.defaultLayer;\r\n            }\r\n        }\r\n    }\r\n    setLayer(order, margin) {\r\n        if (order == null) {\r\n            this._layer = undefined;\r\n        }\r\n        else {\r\n            const visible = true;\r\n            this._layer = this._renderer.getLayer(order, visible);\r\n            this._layer.visible = visible;\r\n            this._layer.margin = margin;\r\n            if (margin) {\r\n                $utils.setInteractive(this._layer.view, false);\r\n            }\r\n            this._renderer._ghostLayer.setMargin(this._renderer.layers);\r\n            if (this._parent) {\r\n                this._parent.registerChildLayer(this._layer);\r\n            }\r\n            this._layer.dirty = true;\r\n            this._renderer.resizeLayer(this._layer);\r\n            this._renderer.resizeGhost();\r\n        }\r\n    }\r\n    markDirtyLayer() {\r\n        this.getLayer().dirty = true;\r\n    }\r\n    clear() {\r\n        this.invalidateBounds();\r\n    }\r\n    invalidateBounds() {\r\n        this._localBounds = undefined;\r\n    }\r\n    _addBounds(_bounds) { }\r\n    _getColorId() {\r\n        if (this._colorId === undefined) {\r\n            this._colorId = this._renderer.paintId(this);\r\n        }\r\n        return this._colorId;\r\n    }\r\n    _isInteractive(status) {\r\n        return !status.inactive && (this.interactive || this._renderer._forceInteractive > 0);\r\n    }\r\n    _isInteractiveMask(status) {\r\n        return this._isInteractive(status);\r\n    }\r\n    contains(child) {\r\n        for (;;) {\r\n            if (child === this) {\r\n                return true;\r\n            }\r\n            else if (child._parent) {\r\n                child = child._parent;\r\n            }\r\n            else {\r\n                return false;\r\n            }\r\n        }\r\n    }\r\n    toGlobal(point) {\r\n        return this._matrix.apply(point);\r\n    }\r\n    toLocal(point) {\r\n        return this._matrix.applyInverse(point);\r\n    }\r\n    getLocalMatrix() {\r\n        this._uMatrix.setTransform(0, 0, this.pivot.x, this.pivot.y, this.angle * Math.PI / 180, this.scale);\r\n        return this._uMatrix;\r\n    }\r\n    getLocalBounds() {\r\n        if (!this._localBounds) {\r\n            const bn = 10000000;\r\n            this._localBounds = {\r\n                left: bn,\r\n                top: bn,\r\n                right: -bn,\r\n                bottom: -bn\r\n            };\r\n            this._addBounds(this._localBounds);\r\n        }\r\n        return this._localBounds;\r\n    }\r\n    getAdjustedBounds(bounds) {\r\n        this._setMatrix();\r\n        const matrix = this.getLocalMatrix();\r\n        const p0 = matrix.apply({ x: bounds.left, y: bounds.top });\r\n        const p1 = matrix.apply({ x: bounds.right, y: bounds.top });\r\n        const p2 = matrix.apply({ x: bounds.right, y: bounds.bottom });\r\n        const p3 = matrix.apply({ x: bounds.left, y: bounds.bottom });\r\n        return {\r\n            left: Math.min(p0.x, p1.x, p2.x, p3.x),\r\n            top: Math.min(p0.y, p1.y, p2.y, p3.y),\r\n            right: Math.max(p0.x, p1.x, p2.x, p3.x),\r\n            bottom: Math.max(p0.y, p1.y, p2.y, p3.y)\r\n        };\r\n    }\r\n    on(key, callback, context) {\r\n        if (this.interactive) {\r\n            return this._renderer._addEvent(this, key, callback, context);\r\n        }\r\n        else {\r\n            return new Disposer(() => { });\r\n        }\r\n    }\r\n    _setMatrix() {\r\n        // TODO only calculate this if it has actually changed\r\n        this._localMatrix.setTransform(this.x, this.y, this.pivot.x, this.pivot.y, \r\n        // Converts degrees to radians\r\n        this.angle * Math.PI / 180, this.scale);\r\n        this._matrix.copyFrom(this._localMatrix);\r\n        if (this._parent) {\r\n            // TODO only calculate this if it has actually changed\r\n            this._matrix.prepend(this._parent._matrix);\r\n        }\r\n    }\r\n    _transform(context, resolution) {\r\n        const m = this._matrix;\r\n        let tx = m.tx * resolution;\r\n        let ty = m.ty * resolution;\r\n        if (this.crisp) {\r\n            tx = crisp(tx);\r\n            ty = crisp(ty);\r\n        }\r\n        context.setTransform(m.a * resolution, m.b * resolution, m.c * resolution, m.d * resolution, tx, ty);\r\n    }\r\n    _transformMargin(context, resolution, margin) {\r\n        const m = this._matrix;\r\n        context.setTransform(m.a * resolution, m.b * resolution, m.c * resolution, m.d * resolution, (m.tx + margin.left) * resolution, (m.ty + margin.top) * resolution);\r\n    }\r\n    _transformLayer(context, resolution, layer) {\r\n        if (layer.margin) {\r\n            this._transformMargin(context, layer.scale || resolution, layer.margin);\r\n        }\r\n        else {\r\n            this._transform(context, layer.scale || resolution);\r\n        }\r\n    }\r\n    render(status, targetGhostLayer = 0) {\r\n        if (this.visible && (this.exportable !== false || !this._renderer._omitTainted)) {\r\n            this._setMatrix();\r\n            const subStatus = this.subStatus(status);\r\n            const resolution = this._renderer.resolution;\r\n            const layers = this._renderer.layers;\r\n            const ghostLayer = this._renderer._ghostLayer;\r\n            const ghostContext = ghostLayer.context;\r\n            const mask = this.mask;\r\n            if (mask) {\r\n                mask._setMatrix();\r\n            }\r\n            // TODO improve this\r\n            $array.each(layers, (layer) => {\r\n                if (layer) {\r\n                    const context = layer.context;\r\n                    context.save();\r\n                    // We must apply the mask before we transform the element\r\n                    if (mask) {\r\n                        mask._transformLayer(context, resolution, layer);\r\n                        mask._runPath(context);\r\n                        context.clip();\r\n                    }\r\n                    context.globalAlpha = this.compoundAlpha * this.alpha;\r\n                    this._transformLayer(context, resolution, layer);\r\n                    if (this.filter) {\r\n                        context.filter = this.filter;\r\n                    }\r\n                }\r\n            });\r\n            ghostContext.save();\r\n            // We must apply the mask before we transform the element\r\n            if (mask && this._isInteractiveMask(subStatus)) {\r\n                mask._transformMargin(ghostContext, resolution, ghostLayer.margin);\r\n                mask._runPath(ghostContext);\r\n                ghostContext.clip();\r\n            }\r\n            this._transformMargin(ghostContext, resolution, ghostLayer.margin);\r\n            if ((subStatus.layer.order > 0) && !targetGhostLayer) {\r\n                $array.move(this._renderer._deferredGhostLayers, subStatus.layer.order);\r\n            }\r\n            this._render(subStatus, targetGhostLayer);\r\n            ghostContext.restore();\r\n            $array.each(layers, (layer) => {\r\n                if (layer) {\r\n                    layer.context.restore();\r\n                }\r\n            });\r\n        }\r\n    }\r\n    _render(status, _targetGhostLayer = 0) {\r\n        if (this.exportable === false) {\r\n            status.layer.tainted = true;\r\n        }\r\n    }\r\n    _ghostOnly(targetGhostLayer = 0) {\r\n        return targetGhostLayer > 0 ? true : false;\r\n    }\r\n    _drawGhost(status, targetGhostLayer = 0) {\r\n        const interactive = this._isInteractive(status);\r\n        const order = status.layer.order || 0;\r\n        return interactive && ((order == 0 && !this._ghostOnly(targetGhostLayer)) || order == targetGhostLayer) ? true : false;\r\n    }\r\n    hovering() {\r\n        return this._renderer._hovering.has(this);\r\n    }\r\n    dragging() {\r\n        return this._renderer._dragging.some((x) => x.value === this);\r\n    }\r\n    shouldCancelTouch() {\r\n        const renderer = this._renderer;\r\n        if (renderer.tapToActivate && !renderer._touchActive) {\r\n            return false;\r\n        }\r\n        if (this.cancelTouch) {\r\n            return true;\r\n        }\r\n        else if (this._parent) {\r\n            return this._parent.shouldCancelTouch();\r\n        }\r\n        return false;\r\n    }\r\n}\r\n/**\r\n * @ignore\r\n */\r\nexport class CanvasContainer extends CanvasDisplayObject {\r\n    constructor() {\r\n        super(...arguments);\r\n        Object.defineProperty(this, \"interactiveChildren\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: true\r\n        });\r\n        Object.defineProperty(this, \"_childLayers\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"_children\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: []\r\n        });\r\n    }\r\n    _isInteractiveMask(status) {\r\n        return this.interactiveChildren || super._isInteractiveMask(status);\r\n    }\r\n    addChild(child) {\r\n        child._parent = this;\r\n        this._children.push(child);\r\n        if (child._layer) {\r\n            this.registerChildLayer(child._layer);\r\n        }\r\n    }\r\n    addChildAt(child, index) {\r\n        child._parent = this;\r\n        this._children.splice(index, 0, child);\r\n        if (child._layer) {\r\n            this.registerChildLayer(child._layer);\r\n        }\r\n    }\r\n    removeChild(child) {\r\n        child._parent = undefined;\r\n        $array.removeFirst(this._children, child);\r\n    }\r\n    _render(status, targetGhostLayer) {\r\n        super._render(status);\r\n        const renderer = this._renderer;\r\n        if (this.interactive && this.interactiveChildren) {\r\n            ++renderer._forceInteractive;\r\n        }\r\n        $array.each(this._children, (child) => {\r\n            child.compoundAlpha = this.compoundAlpha * this.alpha;\r\n            child.render(status, targetGhostLayer);\r\n        });\r\n        if (this.interactive && this.interactiveChildren) {\r\n            --renderer._forceInteractive;\r\n        }\r\n    }\r\n    registerChildLayer(layer) {\r\n        if (!this._childLayers) {\r\n            this._childLayers = [];\r\n        }\r\n        $array.pushOne(this._childLayers, layer);\r\n        if (this._parent) {\r\n            this._parent.registerChildLayer(layer);\r\n        }\r\n    }\r\n    markDirtyLayer(deep = false) {\r\n        super.markDirtyLayer();\r\n        if (deep && this._childLayers) {\r\n            $array.each(this._childLayers, (layer) => layer.dirty = true);\r\n        }\r\n    }\r\n    _dispose() {\r\n        super._dispose();\r\n        if (this._childLayers) {\r\n            $array.each(this._childLayers, (layer) => {\r\n                layer.dirty = true;\r\n            });\r\n        }\r\n    }\r\n}\r\n/**\r\n * @ignore\r\n */\r\nfunction setPoint(bounds, point) {\r\n    bounds.left = Math.min(bounds.left, point.x);\r\n    bounds.top = Math.min(bounds.top, point.y);\r\n    bounds.right = Math.max(bounds.right, point.x);\r\n    bounds.bottom = Math.max(bounds.bottom, point.y);\r\n}\r\n/**\r\n * @ignore\r\n */\r\nclass Op {\r\n    colorize(_context, _forceColor) { }\r\n    colorizeGhost(context, forceColor) {\r\n        this.colorize(context, forceColor);\r\n    }\r\n    path(_context) { }\r\n    pathGhost(context) {\r\n        this.path(context);\r\n    }\r\n    addBounds(_bounds) { }\r\n}\r\n/**\r\n * @ignore\r\n */\r\nclass BeginPath extends Op {\r\n    colorize(context, _forceColor) {\r\n        context.beginPath();\r\n    }\r\n}\r\n/**\r\n * @ignore\r\n */\r\nclass BeginFill extends Op {\r\n    constructor(color) {\r\n        super();\r\n        Object.defineProperty(this, \"color\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: color\r\n        });\r\n    }\r\n    colorize(context, forceColor) {\r\n        if (forceColor !== undefined) {\r\n            context.fillStyle = forceColor;\r\n        }\r\n        else {\r\n            context.fillStyle = this.color;\r\n        }\r\n    }\r\n}\r\n/**\r\n * @ignore\r\n */\r\nclass EndFill extends Op {\r\n    constructor(clearShadow) {\r\n        super();\r\n        Object.defineProperty(this, \"clearShadow\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: clearShadow\r\n        });\r\n    }\r\n    colorize(context, _forceColor) {\r\n        context.fill();\r\n        if (this.clearShadow) {\r\n            context.shadowColor = \"\";\r\n            context.shadowBlur = 0;\r\n            context.shadowOffsetX = 0;\r\n            context.shadowOffsetY = 0;\r\n        }\r\n    }\r\n}\r\n/**\r\n * @ignore\r\n */\r\nclass EndStroke extends Op {\r\n    colorize(context, _forceColor) {\r\n        context.stroke();\r\n    }\r\n}\r\n/**\r\n * @ignore\r\n */\r\nclass LineStyle extends Op {\r\n    constructor(width, color, lineJoin, lineCap) {\r\n        super();\r\n        Object.defineProperty(this, \"width\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: width\r\n        });\r\n        Object.defineProperty(this, \"color\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: color\r\n        });\r\n        Object.defineProperty(this, \"lineJoin\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: lineJoin\r\n        });\r\n        Object.defineProperty(this, \"lineCap\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: lineCap\r\n        });\r\n    }\r\n    colorize(context, forceColor) {\r\n        if (forceColor !== undefined) {\r\n            context.strokeStyle = forceColor;\r\n        }\r\n        else {\r\n            context.strokeStyle = this.color;\r\n        }\r\n        context.lineWidth = this.width;\r\n        if (this.lineJoin) {\r\n            context.lineJoin = this.lineJoin;\r\n        }\r\n        if (this.lineCap) {\r\n            context.lineCap = this.lineCap;\r\n        }\r\n    }\r\n}\r\n/**\r\n * @ignore\r\n */\r\nclass LineDash extends Op {\r\n    constructor(dash) {\r\n        super();\r\n        Object.defineProperty(this, \"dash\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: dash\r\n        });\r\n    }\r\n    colorize(context, _forceColor) {\r\n        context.setLineDash(this.dash);\r\n    }\r\n}\r\n/**\r\n * @ignore\r\n */\r\nclass LineDashOffset extends Op {\r\n    constructor(dashOffset) {\r\n        super();\r\n        Object.defineProperty(this, \"dashOffset\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: dashOffset\r\n        });\r\n    }\r\n    colorize(context, _forceColor) {\r\n        context.lineDashOffset = this.dashOffset;\r\n    }\r\n}\r\n/**\r\n * @ignore\r\n */\r\nclass DrawRect extends Op {\r\n    constructor(x, y, width, height) {\r\n        super();\r\n        Object.defineProperty(this, \"x\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: x\r\n        });\r\n        Object.defineProperty(this, \"y\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: y\r\n        });\r\n        Object.defineProperty(this, \"width\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: width\r\n        });\r\n        Object.defineProperty(this, \"height\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: height\r\n        });\r\n    }\r\n    path(context) {\r\n        context.rect(this.x, this.y, this.width, this.height);\r\n    }\r\n    addBounds(bounds) {\r\n        const l = this.x;\r\n        const t = this.y;\r\n        const r = l + this.width;\r\n        const b = t + this.height;\r\n        setPoint(bounds, { x: l, y: t });\r\n        setPoint(bounds, { x: r, y: t });\r\n        setPoint(bounds, { x: l, y: b });\r\n        setPoint(bounds, { x: r, y: b });\r\n    }\r\n}\r\n/**\r\n * @ignore\r\n */\r\nclass DrawCircle extends Op {\r\n    constructor(x, y, radius) {\r\n        super();\r\n        Object.defineProperty(this, \"x\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: x\r\n        });\r\n        Object.defineProperty(this, \"y\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: y\r\n        });\r\n        Object.defineProperty(this, \"radius\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: radius\r\n        });\r\n    }\r\n    path(context) {\r\n        context.moveTo(this.x + this.radius, this.y);\r\n        context.arc(this.x, this.y, this.radius, 0, 2 * Math.PI);\r\n    }\r\n    // TODO handle skewing and rotation\r\n    addBounds(bounds) {\r\n        setPoint(bounds, { x: this.x - this.radius, y: this.y - this.radius });\r\n        setPoint(bounds, { x: this.x + this.radius, y: this.y + this.radius });\r\n    }\r\n}\r\n/**\r\n * @ignore\r\n */\r\nclass DrawEllipse extends Op {\r\n    constructor(x, y, radiusX, radiusY) {\r\n        super();\r\n        Object.defineProperty(this, \"x\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: x\r\n        });\r\n        Object.defineProperty(this, \"y\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: y\r\n        });\r\n        Object.defineProperty(this, \"radiusX\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: radiusX\r\n        });\r\n        Object.defineProperty(this, \"radiusY\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: radiusY\r\n        });\r\n    }\r\n    path(context) {\r\n        context.ellipse(0, 0, this.radiusX, this.radiusY, 0, 0, Math.PI * 2);\r\n    }\r\n    // TODO handle skewing and rotation\r\n    addBounds(bounds) {\r\n        setPoint(bounds, { x: this.x - this.radiusX, y: this.y - this.radiusY });\r\n        setPoint(bounds, { x: this.x + this.radiusX, y: this.y + this.radiusY });\r\n    }\r\n}\r\n/**\r\n * @ignore\r\n */\r\nclass Arc extends Op {\r\n    constructor(cx, cy, radius, startAngle, endAngle, anticlockwise) {\r\n        super();\r\n        Object.defineProperty(this, \"cx\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: cx\r\n        });\r\n        Object.defineProperty(this, \"cy\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: cy\r\n        });\r\n        Object.defineProperty(this, \"radius\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: radius\r\n        });\r\n        Object.defineProperty(this, \"startAngle\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: startAngle\r\n        });\r\n        Object.defineProperty(this, \"endAngle\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: endAngle\r\n        });\r\n        Object.defineProperty(this, \"anticlockwise\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: anticlockwise\r\n        });\r\n    }\r\n    path(context) {\r\n        if (this.radius > 0) {\r\n            context.arc(this.cx, this.cy, this.radius, this.startAngle, this.endAngle, this.anticlockwise);\r\n        }\r\n    }\r\n    addBounds(bounds) {\r\n        let arcBounds = $math.getArcBounds(this.cx, this.cy, this.startAngle * $math.DEGREES, this.endAngle * $math.DEGREES, this.radius);\r\n        setPoint(bounds, { x: arcBounds.left, y: arcBounds.top });\r\n        setPoint(bounds, { x: arcBounds.right, y: arcBounds.bottom });\r\n    }\r\n}\r\n/**\r\n * @ignore\r\n */\r\nclass ArcTo extends Op {\r\n    constructor(x1, y1, x2, y2, radius) {\r\n        super();\r\n        Object.defineProperty(this, \"x1\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: x1\r\n        });\r\n        Object.defineProperty(this, \"y1\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: y1\r\n        });\r\n        Object.defineProperty(this, \"x2\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: x2\r\n        });\r\n        Object.defineProperty(this, \"y2\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: y2\r\n        });\r\n        Object.defineProperty(this, \"radius\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: radius\r\n        });\r\n    }\r\n    path(context) {\r\n        if (this.radius > 0) {\r\n            context.arcTo(this.x1, this.y1, this.x2, this.y2, this.radius);\r\n        }\r\n    }\r\n    // TODO: add points\r\n    addBounds(_bounds) {\r\n        /*\r\n        // not finished\r\n        https://math.stackexchange.com/questions/1781438/finding-the-center-of-a-circle-given-two-points-and-a-radius-algebraically\r\n\r\n        if (prevPoint) {\r\n            let x1 = prevPoint.x;\r\n            let y1 = prevPoint.y;\r\n            let x2 = this.x2;\r\n            let y2 = this.y2;\r\n            let r = this.radius;\r\n\r\n            let xa = (x2 - x1) / 2;\r\n            let ya = (y2 - y1) / 2;\r\n\r\n            let x0 = x1 + xa;\r\n            let y0 = y1 + ya;\r\n\r\n            let a = Math.hypot(xa, ya);\r\n            let b = Math.sqrt(r * r - a * a);\r\n\r\n            let cx = x0 + b * ya / a;\r\n            let cy = y0 - b * xa / a;\r\n\r\n            console.log(cx, cy);\r\n        }*/\r\n    }\r\n}\r\n/**\r\n * @ignore\r\n */\r\nclass LineTo extends Op {\r\n    constructor(x, y) {\r\n        super();\r\n        Object.defineProperty(this, \"x\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: x\r\n        });\r\n        Object.defineProperty(this, \"y\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: y\r\n        });\r\n    }\r\n    path(context) {\r\n        context.lineTo(this.x, this.y);\r\n    }\r\n    addBounds(bounds) {\r\n        setPoint(bounds, { x: this.x, y: this.y });\r\n    }\r\n}\r\n/**\r\n * @ignore\r\n */\r\nclass MoveTo extends Op {\r\n    constructor(x, y) {\r\n        super();\r\n        Object.defineProperty(this, \"x\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: x\r\n        });\r\n        Object.defineProperty(this, \"y\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: y\r\n        });\r\n    }\r\n    path(context) {\r\n        context.moveTo(this.x, this.y);\r\n    }\r\n    addBounds(bounds) {\r\n        setPoint(bounds, { x: this.x, y: this.y });\r\n    }\r\n}\r\n/**\r\n * @ignore\r\n */\r\nclass ClosePath extends Op {\r\n    path(context) {\r\n        context.closePath();\r\n    }\r\n}\r\n/**\r\n * @ignore\r\n */\r\nclass BezierCurveTo extends Op {\r\n    constructor(cpX, cpY, cpX2, cpY2, toX, toY) {\r\n        super();\r\n        Object.defineProperty(this, \"cpX\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: cpX\r\n        });\r\n        Object.defineProperty(this, \"cpY\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: cpY\r\n        });\r\n        Object.defineProperty(this, \"cpX2\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: cpX2\r\n        });\r\n        Object.defineProperty(this, \"cpY2\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: cpY2\r\n        });\r\n        Object.defineProperty(this, \"toX\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: toX\r\n        });\r\n        Object.defineProperty(this, \"toY\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: toY\r\n        });\r\n    }\r\n    path(context) {\r\n        context.bezierCurveTo(this.cpX, this.cpY, this.cpX2, this.cpY2, this.toX, this.toY);\r\n    }\r\n    // TODO: OK?\r\n    addBounds(bounds) {\r\n        setPoint(bounds, { x: this.cpX, y: this.cpY });\r\n        setPoint(bounds, { x: this.cpX2, y: this.cpY2 });\r\n        setPoint(bounds, { x: this.toX, y: this.toY });\r\n    }\r\n}\r\n/**\r\n * @ignore\r\n */\r\nclass QuadraticCurveTo extends Op {\r\n    constructor(cpX, cpY, toX, toY) {\r\n        super();\r\n        Object.defineProperty(this, \"cpX\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: cpX\r\n        });\r\n        Object.defineProperty(this, \"cpY\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: cpY\r\n        });\r\n        Object.defineProperty(this, \"toX\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: toX\r\n        });\r\n        Object.defineProperty(this, \"toY\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: toY\r\n        });\r\n    }\r\n    path(context) {\r\n        context.quadraticCurveTo(this.cpX, this.cpY, this.toX, this.toY);\r\n    }\r\n    // TODO: OK?\r\n    addBounds(bounds) {\r\n        setPoint(bounds, { x: this.cpX, y: this.cpY });\r\n        setPoint(bounds, { x: this.toX, y: this.toY });\r\n    }\r\n}\r\n/**\r\n * @ignore\r\n */\r\nclass Shadow extends Op {\r\n    constructor(color, blur, offsetX, offsetY, opacity) {\r\n        super();\r\n        Object.defineProperty(this, \"color\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: color\r\n        });\r\n        Object.defineProperty(this, \"blur\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: blur\r\n        });\r\n        Object.defineProperty(this, \"offsetX\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: offsetX\r\n        });\r\n        Object.defineProperty(this, \"offsetY\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: offsetY\r\n        });\r\n        Object.defineProperty(this, \"opacity\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: opacity\r\n        });\r\n    }\r\n    colorize(context, _forceColor) {\r\n        if (this.opacity) {\r\n            context.fillStyle = this.color;\r\n        }\r\n        context.shadowColor = this.color;\r\n        context.shadowBlur = this.blur;\r\n        context.shadowOffsetX = this.offsetX;\r\n        context.shadowOffsetY = this.offsetY;\r\n    }\r\n    colorizeGhost(_context, _forceColor) { }\r\n}\r\n/**\r\n * @ignore\r\n */\r\nclass GraphicsImage extends Op {\r\n    constructor(image, width, height, x, y) {\r\n        super();\r\n        Object.defineProperty(this, \"image\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: image\r\n        });\r\n        Object.defineProperty(this, \"width\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: width\r\n        });\r\n        Object.defineProperty(this, \"height\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: height\r\n        });\r\n        Object.defineProperty(this, \"x\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: x\r\n        });\r\n        Object.defineProperty(this, \"y\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: y\r\n        });\r\n    }\r\n    path(context) {\r\n        context.drawImage(this.image, this.x, this.y, this.width, this.height);\r\n    }\r\n    // TODO: OK?\r\n    addBounds(bounds) {\r\n        setPoint(bounds, { x: this.x, y: this.y });\r\n        setPoint(bounds, { x: this.width, y: this.height });\r\n    }\r\n}\r\n/**\r\n * @ignore\r\n */\r\nexport class CanvasGraphics extends CanvasDisplayObject {\r\n    constructor() {\r\n        super(...arguments);\r\n        Object.defineProperty(this, \"_operations\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: []\r\n        });\r\n        Object.defineProperty(this, \"blendMode\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: BlendMode.NORMAL\r\n        });\r\n        Object.defineProperty(this, \"_hasShadows\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: false\r\n        });\r\n        Object.defineProperty(this, \"_fillAlpha\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"_strokeAlpha\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n    }\r\n    clear() {\r\n        super.clear();\r\n        this._operations.length = 0;\r\n    }\r\n    _pushOp(op) {\r\n        this._operations.push(op);\r\n    }\r\n    beginFill(color, alpha = 1) {\r\n        this._fillAlpha = alpha;\r\n        if (color) {\r\n            if (color instanceof Color) {\r\n                this._pushOp(new BeginFill(color.toCSS(alpha)));\r\n            }\r\n            else {\r\n                this.isMeasured = true;\r\n                this._pushOp(new BeginFill(color));\r\n            }\r\n        }\r\n        else {\r\n            this._pushOp(new BeginFill(\"rgba(0, 0, 0, \" + alpha + \")\"));\r\n        }\r\n    }\r\n    endFill() {\r\n        this._pushOp(new EndFill(this._hasShadows));\r\n    }\r\n    endStroke() {\r\n        this._pushOp(new EndStroke());\r\n    }\r\n    beginPath() {\r\n        this._pushOp(new BeginPath());\r\n    }\r\n    lineStyle(width = 0, color, alpha = 1, lineJoin, lineCap) {\r\n        this._strokeAlpha = alpha;\r\n        if (color) {\r\n            if (color instanceof Color) {\r\n                this._pushOp(new LineStyle(width, color.toCSS(alpha), lineJoin, lineCap));\r\n            }\r\n            else {\r\n                this._pushOp(new LineStyle(width, color, lineJoin, lineCap));\r\n            }\r\n        }\r\n        else {\r\n            this._pushOp(new LineStyle(width, \"rgba(0, 0, 0, \" + alpha + \")\", lineJoin, lineCap));\r\n        }\r\n    }\r\n    setLineDash(dash) {\r\n        this._pushOp(new LineDash(dash ? dash : []));\r\n    }\r\n    setLineDashOffset(dashOffset = 0) {\r\n        this._pushOp(new LineDashOffset(dashOffset));\r\n    }\r\n    drawRect(x, y, width, height) {\r\n        this._pushOp(new DrawRect(x, y, width, height));\r\n    }\r\n    drawCircle(x, y, radius) {\r\n        this._pushOp(new DrawCircle(x, y, radius));\r\n    }\r\n    drawEllipse(x, y, radiusX, radiusY) {\r\n        this._pushOp(new DrawEllipse(x, y, radiusX, radiusY));\r\n    }\r\n    arc(cx, cy, radius, startAngle, endAngle, anticlockwise = false) {\r\n        this._pushOp(new Arc(cx, cy, radius, startAngle, endAngle, anticlockwise));\r\n    }\r\n    arcTo(x1, y1, x2, y2, radius) {\r\n        this._pushOp(new ArcTo(x1, y1, x2, y2, radius));\r\n    }\r\n    lineTo(x, y) {\r\n        this._pushOp(new LineTo(x, y));\r\n    }\r\n    moveTo(x, y) {\r\n        this._pushOp(new MoveTo(x, y));\r\n    }\r\n    bezierCurveTo(cpX, cpY, cpX2, cpY2, toX, toY) {\r\n        this._pushOp(new BezierCurveTo(cpX, cpY, cpX2, cpY2, toX, toY));\r\n    }\r\n    quadraticCurveTo(cpX, cpY, toX, toY) {\r\n        this._pushOp(new QuadraticCurveTo(cpX, cpY, toX, toY));\r\n    }\r\n    closePath() {\r\n        this._pushOp(new ClosePath());\r\n    }\r\n    shadow(color, blur = 0, offsetX = 0, offsetY = 0, opacity) {\r\n        this._hasShadows = true;\r\n        this._pushOp(new Shadow(opacity ? color.toCSS(opacity) : color.toCSS(this._fillAlpha || this._strokeAlpha), blur, offsetX, offsetY));\r\n    }\r\n    image(image, width, height, x, y) {\r\n        this._pushOp(new GraphicsImage(image, width, height, x, y));\r\n    }\r\n    // https://svgwg.org/svg2-draft/paths.html#DProperty\r\n    // TODO better error checking\r\n    svgPath(path) {\r\n        let x = 0;\r\n        let y = 0;\r\n        let cpx = null;\r\n        let cpy = null;\r\n        let qcpx = null;\r\n        let qcpy = null;\r\n        const SEGMENTS_REGEXP = /([MmZzLlHhVvCcSsQqTtAa])([^MmZzLlHhVvCcSsQqTtAa]*)/g;\r\n        const ARGS_REGEXP = /[\\u0009\\u0020\\u000A\\u000C\\u000D]*([\\+\\-]?[0-9]*\\.?[0-9]+(?:[eE][\\+\\-]?[0-9]+)?)[\\u0009\\u0020\\u000A\\u000C\\u000D]*,?/g;\r\n        let match;\r\n        while ((match = SEGMENTS_REGEXP.exec(path)) !== null) {\r\n            const name = match[1];\r\n            const rest = match[2];\r\n            const args = [];\r\n            while ((match = ARGS_REGEXP.exec(rest)) !== null) {\r\n                args.push(match[1]);\r\n            }\r\n            // Reset control point\r\n            if (name !== \"S\" && name !== \"s\" && name !== \"C\" && name !== \"c\") {\r\n                cpx = null;\r\n                cpy = null;\r\n            }\r\n            // Reset control point\r\n            if (name !== \"Q\" && name !== \"q\" && name !== \"T\" && name !== \"t\") {\r\n                qcpx = null;\r\n                qcpy = null;\r\n            }\r\n            switch (name) {\r\n                case \"M\":\r\n                    checkEvenArgs(name, args.length, 2);\r\n                    x = +args[0];\r\n                    y = +args[1];\r\n                    this.moveTo(x, y);\r\n                    for (let i = 2; i < args.length; i += 2) {\r\n                        x = +args[i];\r\n                        y = +args[i + 1];\r\n                        this.lineTo(x, y);\r\n                    }\r\n                    break;\r\n                case \"m\":\r\n                    checkEvenArgs(name, args.length, 2);\r\n                    x += +args[0];\r\n                    y += +args[1];\r\n                    this.moveTo(x, y);\r\n                    for (let i = 2; i < args.length; i += 2) {\r\n                        x += +args[i];\r\n                        y += +args[i + 1];\r\n                        this.lineTo(x, y);\r\n                    }\r\n                    break;\r\n                case \"L\":\r\n                    checkEvenArgs(name, args.length, 2);\r\n                    for (let i = 0; i < args.length; i += 2) {\r\n                        x = +args[i];\r\n                        y = +args[i + 1];\r\n                        this.lineTo(x, y);\r\n                    }\r\n                    break;\r\n                case \"l\":\r\n                    checkEvenArgs(name, args.length, 2);\r\n                    for (let i = 0; i < args.length; i += 2) {\r\n                        x += +args[i];\r\n                        y += +args[i + 1];\r\n                        this.lineTo(x, y);\r\n                    }\r\n                    break;\r\n                case \"H\":\r\n                    checkMinArgs(name, args.length, 1);\r\n                    for (let i = 0; i < args.length; ++i) {\r\n                        x = +args[i];\r\n                        this.lineTo(x, y);\r\n                    }\r\n                    break;\r\n                case \"h\":\r\n                    checkMinArgs(name, args.length, 1);\r\n                    for (let i = 0; i < args.length; ++i) {\r\n                        x += +args[i];\r\n                        this.lineTo(x, y);\r\n                    }\r\n                    break;\r\n                case \"V\":\r\n                    checkMinArgs(name, args.length, 1);\r\n                    for (let i = 0; i < args.length; ++i) {\r\n                        y = +args[i];\r\n                        this.lineTo(x, y);\r\n                    }\r\n                    break;\r\n                case \"v\":\r\n                    checkMinArgs(name, args.length, 1);\r\n                    for (let i = 0; i < args.length; ++i) {\r\n                        y += +args[i];\r\n                        this.lineTo(x, y);\r\n                    }\r\n                    break;\r\n                case \"C\":\r\n                    checkEvenArgs(name, args.length, 6);\r\n                    for (let i = 0; i < args.length; i += 6) {\r\n                        const x1 = +args[i];\r\n                        const y1 = +args[i + 1];\r\n                        cpx = +args[i + 2];\r\n                        cpy = +args[i + 3];\r\n                        x = +args[i + 4];\r\n                        y = +args[i + 5];\r\n                        this.bezierCurveTo(x1, y1, cpx, cpy, x, y);\r\n                    }\r\n                    break;\r\n                case \"c\":\r\n                    checkEvenArgs(name, args.length, 6);\r\n                    for (let i = 0; i < args.length; i += 6) {\r\n                        const x1 = +args[i] + x;\r\n                        const y1 = +args[i + 1] + y;\r\n                        cpx = +args[i + 2] + x;\r\n                        cpy = +args[i + 3] + y;\r\n                        x += +args[i + 4];\r\n                        y += +args[i + 5];\r\n                        this.bezierCurveTo(x1, y1, cpx, cpy, x, y);\r\n                    }\r\n                    break;\r\n                case \"S\":\r\n                    checkEvenArgs(name, args.length, 4);\r\n                    if (cpx === null || cpy === null) {\r\n                        cpx = x;\r\n                        cpy = y;\r\n                    }\r\n                    for (let i = 0; i < args.length; i += 4) {\r\n                        const x1 = 2 * x - cpx;\r\n                        const y1 = 2 * y - cpy;\r\n                        cpx = +args[i];\r\n                        cpy = +args[i + 1];\r\n                        x = +args[i + 2];\r\n                        y = +args[i + 3];\r\n                        this.bezierCurveTo(x1, y1, cpx, cpy, x, y);\r\n                    }\r\n                    break;\r\n                case \"s\":\r\n                    checkEvenArgs(name, args.length, 4);\r\n                    if (cpx === null || cpy === null) {\r\n                        cpx = x;\r\n                        cpy = y;\r\n                    }\r\n                    for (let i = 0; i < args.length; i += 4) {\r\n                        const x1 = 2 * x - cpx;\r\n                        const y1 = 2 * y - cpy;\r\n                        cpx = +args[i] + x;\r\n                        cpy = +args[i + 1] + y;\r\n                        x += +args[i + 2];\r\n                        y += +args[i + 3];\r\n                        this.bezierCurveTo(x1, y1, cpx, cpy, x, y);\r\n                    }\r\n                    break;\r\n                case \"Q\":\r\n                    checkEvenArgs(name, args.length, 4);\r\n                    for (let i = 0; i < args.length; i += 4) {\r\n                        qcpx = +args[i];\r\n                        qcpy = +args[i + 1];\r\n                        x = +args[i + 2];\r\n                        y = +args[i + 3];\r\n                        this.quadraticCurveTo(qcpx, qcpy, x, y);\r\n                    }\r\n                    break;\r\n                case \"q\":\r\n                    checkEvenArgs(name, args.length, 4);\r\n                    for (let i = 0; i < args.length; i += 4) {\r\n                        qcpx = +args[i] + x;\r\n                        qcpy = +args[i + 1] + y;\r\n                        x += +args[i + 2];\r\n                        y += +args[i + 3];\r\n                        this.quadraticCurveTo(qcpx, qcpy, x, y);\r\n                    }\r\n                    break;\r\n                case \"T\":\r\n                    checkEvenArgs(name, args.length, 2);\r\n                    if (qcpx === null || qcpy === null) {\r\n                        qcpx = x;\r\n                        qcpy = y;\r\n                    }\r\n                    for (let i = 0; i < args.length; i += 2) {\r\n                        qcpx = 2 * x - qcpx;\r\n                        qcpy = 2 * y - qcpy;\r\n                        x = +args[i];\r\n                        y = +args[i + 1];\r\n                        this.quadraticCurveTo(qcpx, qcpy, x, y);\r\n                    }\r\n                    break;\r\n                case \"t\":\r\n                    checkEvenArgs(name, args.length, 2);\r\n                    if (qcpx === null || qcpy === null) {\r\n                        qcpx = x;\r\n                        qcpy = y;\r\n                    }\r\n                    for (let i = 0; i < args.length; i += 2) {\r\n                        qcpx = 2 * x - qcpx;\r\n                        qcpy = 2 * y - qcpy;\r\n                        x += +args[i];\r\n                        y += +args[i + 1];\r\n                        this.quadraticCurveTo(qcpx, qcpy, x, y);\r\n                    }\r\n                    break;\r\n                case \"A\":\r\n                case \"a\":\r\n                    const relative = (name === \"a\");\r\n                    splitArcFlags(args);\r\n                    checkEvenArgs(name, args.length, 7);\r\n                    for (let i = 0; i < args.length; i += 7) {\r\n                        let cx = +args[i + 5];\r\n                        let cy = +args[i + 6];\r\n                        if (relative) {\r\n                            cx += x;\r\n                            cy += y;\r\n                        }\r\n                        const bs = arcToBezier({\r\n                            px: x,\r\n                            py: y,\r\n                            rx: +args[i],\r\n                            ry: +args[i + 1],\r\n                            xAxisRotation: +args[i + 2],\r\n                            largeArcFlag: assertBinary(+args[i + 3]),\r\n                            sweepFlag: assertBinary(+args[i + 4]),\r\n                            cx,\r\n                            cy,\r\n                        });\r\n                        $array.each(bs, (b) => {\r\n                            this.bezierCurveTo(b.x1, b.y1, b.x2, b.y2, b.x, b.y);\r\n                            x = b.x;\r\n                            y = b.y;\r\n                        });\r\n                    }\r\n                    break;\r\n                case \"Z\":\r\n                case \"z\":\r\n                    checkArgs(name, args.length, 0);\r\n                    this.closePath();\r\n                    break;\r\n            }\r\n        }\r\n    }\r\n    _runPath(context) {\r\n        context.beginPath();\r\n        $array.each(this._operations, (op) => {\r\n            op.path(context);\r\n        });\r\n    }\r\n    _render(status, targetGhostLayer = 0) {\r\n        super._render(status);\r\n        const layerDirty = status.layer.dirty;\r\n        const interactive = this._isInteractive(status);\r\n        const ghostOnly = this._ghostOnly(targetGhostLayer);\r\n        const drawGhost = this._drawGhost(status, targetGhostLayer);\r\n        if (layerDirty || interactive || ghostOnly) {\r\n            const context = status.layer.context;\r\n            const ghostContext = this._renderer._ghostLayer.context;\r\n            if (layerDirty && !ghostOnly) {\r\n                context.globalCompositeOperation = this.blendMode;\r\n                context.beginPath();\r\n            }\r\n            let color;\r\n            if (drawGhost) {\r\n                ghostContext.beginPath();\r\n                color = this._getColorId();\r\n            }\r\n            $array.each(this._operations, (op) => {\r\n                if (layerDirty && !ghostOnly) {\r\n                    op.path(context);\r\n                    op.colorize(context, undefined);\r\n                }\r\n                if (drawGhost) {\r\n                    op.pathGhost(ghostContext);\r\n                    op.colorizeGhost(ghostContext, color);\r\n                }\r\n            });\r\n        }\r\n    }\r\n    renderDetached(context) {\r\n        if (this.visible) {\r\n            this._setMatrix();\r\n            context.save();\r\n            // We must apply the mask before we transform the element\r\n            const mask = this.mask;\r\n            if (mask) {\r\n                mask._setMatrix();\r\n                mask._transform(context, 1);\r\n                mask._runPath(context);\r\n                context.clip();\r\n            }\r\n            // TODO handle compoundAlpha somehow ?\r\n            context.globalAlpha = this.compoundAlpha * this.alpha;\r\n            this._transform(context, 1);\r\n            if (this.filter) {\r\n                context.filter = this.filter;\r\n            }\r\n            context.globalCompositeOperation = this.blendMode;\r\n            context.beginPath();\r\n            $array.each(this._operations, (op) => {\r\n                op.path(context);\r\n                op.colorize(context, undefined);\r\n            });\r\n            context.restore();\r\n        }\r\n    }\r\n    _addBounds(bounds) {\r\n        if (this.visible && this.isMeasured) {\r\n            $array.each(this._operations, (op) => {\r\n                op.addBounds(bounds);\r\n            });\r\n        }\r\n    }\r\n}\r\n/**\r\n * @ignore\r\n */\r\nexport class CanvasText extends CanvasDisplayObject {\r\n    constructor(renderer, text, style) {\r\n        super(renderer);\r\n        Object.defineProperty(this, \"text\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"style\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"resolution\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: 1\r\n        });\r\n        Object.defineProperty(this, \"textVisible\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: true\r\n        });\r\n        Object.defineProperty(this, \"truncated\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"_textInfo\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"_originalScale\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: 1\r\n        });\r\n        this.text = text;\r\n        this.style = style;\r\n    }\r\n    invalidateBounds() {\r\n        super.invalidateBounds();\r\n        this._textInfo = undefined;\r\n    }\r\n    invalidateVisibility() {\r\n        this.textVisible = true;\r\n        this.scale = this._originalScale || 1;\r\n    }\r\n    _shared(context) {\r\n        if (this.style.textAlign) {\r\n            context.textAlign = this.style.textAlign;\r\n        }\r\n        if (this.style.direction) {\r\n            context.direction = this.style.direction;\r\n        }\r\n        if (this.style.textBaseline) {\r\n            context.textBaseline = this.style.textBaseline;\r\n        }\r\n    }\r\n    _prerender(status, ignoreGhost = false, ignoreFontWeight = false) {\r\n        super._render(status);\r\n        const context = status.layer.context;\r\n        const ghostContext = this._renderer._ghostLayer.context;\r\n        // Font style\r\n        const style = this.style;\r\n        let fontStyle = this._getFontStyle(undefined, ignoreFontWeight);\r\n        context.font = fontStyle;\r\n        if (this._isInteractive(status) && !ignoreGhost) {\r\n            ghostContext.font = fontStyle;\r\n        }\r\n        // Other parameters\r\n        if (style.fill) {\r\n            if (style.fill instanceof Color) {\r\n                context.fillStyle = style.fill.toCSS(style.fillOpacity != undefined ? style.fillOpacity : 1);\r\n            }\r\n            else {\r\n                context.fillStyle = style.fill;\r\n            }\r\n        }\r\n        if (style.shadowColor) {\r\n            status.layer.context.shadowColor = style.shadowColor.toCSS(style.shadowOpacity || 1);\r\n        }\r\n        if (style.shadowBlur) {\r\n            status.layer.context.shadowBlur = style.shadowBlur;\r\n        }\r\n        if (style.shadowOffsetX) {\r\n            status.layer.context.shadowOffsetX = style.shadowOffsetX;\r\n        }\r\n        if (style.shadowOffsetY) {\r\n            status.layer.context.shadowOffsetY = style.shadowOffsetY;\r\n        }\r\n        this._shared(context);\r\n        if (this._isInteractive(status) && !ignoreGhost) {\r\n            ghostContext.fillStyle = this._getColorId();\r\n            this._shared(ghostContext);\r\n        }\r\n    }\r\n    _getFontStyle(style2, ignoreFontWeight = false) {\r\n        // Process defaults\r\n        const style = this.style;\r\n        let fontStyle = [];\r\n        if (style2 && style2.fontVariant) {\r\n            fontStyle.push(style2.fontVariant);\r\n        }\r\n        else if (style.fontVariant) {\r\n            fontStyle.push(style.fontVariant);\r\n        }\r\n        if (!ignoreFontWeight) {\r\n            if (style2 && style2.fontWeight) {\r\n                fontStyle.push(style2.fontWeight);\r\n            }\r\n            else if (style.fontWeight) {\r\n                fontStyle.push(style.fontWeight);\r\n            }\r\n        }\r\n        if (style2 && style2.fontStyle) {\r\n            fontStyle.push(style2.fontStyle);\r\n        }\r\n        else if (style.fontStyle) {\r\n            fontStyle.push(style.fontStyle);\r\n        }\r\n        if (style2 && style2.fontSize) {\r\n            if ($type.isNumber(style2.fontSize)) {\r\n                style2.fontSize = style2.fontSize + \"px\";\r\n            }\r\n            fontStyle.push(style2.fontSize);\r\n        }\r\n        else if (style.fontSize) {\r\n            if ($type.isNumber(style.fontSize)) {\r\n                style.fontSize = style.fontSize + \"px\";\r\n            }\r\n            fontStyle.push(style.fontSize);\r\n        }\r\n        if (style2 && style2.fontFamily) {\r\n            fontStyle.push(style2.fontFamily);\r\n        }\r\n        else if (style.fontFamily) {\r\n            fontStyle.push(style.fontFamily);\r\n        }\r\n        else if (fontStyle.length) {\r\n            fontStyle.push(\"Arial\");\r\n        }\r\n        return fontStyle.join(\" \");\r\n    }\r\n    _render(status, targetGhostLayer = 0) {\r\n        // We need measurements in order to properly position text for alignment\r\n        if (!this._textInfo) {\r\n            this._measure(status);\r\n        }\r\n        if (this.textVisible) {\r\n            const interactive = this._isInteractive(status);\r\n            const context = status.layer.context;\r\n            const layerDirty = status.layer.dirty;\r\n            const ghostContext = this._renderer._ghostLayer.context;\r\n            const ghostOnly = this._ghostOnly(targetGhostLayer);\r\n            const drawGhost = this._drawGhost(status, targetGhostLayer);\r\n            context.save();\r\n            ghostContext.save();\r\n            this._prerender(status);\r\n            // const lines = this.text.toString().replace(/\\r/g, \"\").split(/\\n/);\r\n            // const x = this._localBounds && (this._localBounds.left < 0) ? Math.abs(this._localBounds.left) : 0;\r\n            // Process text info produced by _measure()\r\n            $array.each(this._textInfo, (line, _index) => {\r\n                $array.each(line.textChunks, (chunk, _index) => {\r\n                    // Set style\r\n                    if (chunk.style) {\r\n                        context.save();\r\n                        ghostContext.save();\r\n                        if (!ghostOnly) {\r\n                            context.font = chunk.style;\r\n                        }\r\n                        if (this._isInteractive(status)) {\r\n                            ghostContext.font = chunk.style;\r\n                        }\r\n                    }\r\n                    if (chunk.fill) {\r\n                        context.save();\r\n                        if (!ghostOnly) {\r\n                            context.fillStyle = chunk.fill.toCSS();\r\n                        }\r\n                        // Color does not affect ghostContext so we not set it\r\n                    }\r\n                    // Draw text\r\n                    if (layerDirty && !ghostOnly) {\r\n                        context.fillText(chunk.text, chunk.offsetX, line.offsetY + chunk.offsetY);\r\n                    }\r\n                    // Draw underline\r\n                    if (chunk.textDecoration == \"underline\" || chunk.textDecoration == \"line-through\") {\r\n                        let thickness = 1;\r\n                        let offset = 1;\r\n                        let fontSize = chunk.height;\r\n                        const oversizedBehavior = this.style.oversizedBehavior || \"\";\r\n                        if ([\"truncate\", \"wrap\", \"wrap-no-break\"].indexOf(oversizedBehavior) > -1) {\r\n                            // Measure actual width of the text so the line fits\r\n                            const metrics = this._measureText(chunk.text, context);\r\n                            chunk.width = metrics.actualBoundingBoxLeft + metrics.actualBoundingBoxRight;\r\n                        }\r\n                        let offsetX = chunk.offsetX;\r\n                        switch (this.style.textAlign) {\r\n                            case \"right\":\r\n                            case \"end\":\r\n                                offsetX -= chunk.width;\r\n                                break;\r\n                            case \"center\":\r\n                                offsetX -= chunk.width / 2;\r\n                                break;\r\n                        }\r\n                        if (chunk.style) {\r\n                            const format = TextFormatter.getTextStyle(chunk.style);\r\n                            switch (format.fontWeight) {\r\n                                case \"bolder\":\r\n                                case \"bold\":\r\n                                case \"700\":\r\n                                case \"800\":\r\n                                case \"900\":\r\n                                    thickness = 2;\r\n                                    break;\r\n                            }\r\n                        }\r\n                        if (fontSize) {\r\n                            offset = fontSize / 20;\r\n                        }\r\n                        let y;\r\n                        if (chunk.textDecoration == \"line-through\") {\r\n                            y = thickness + line.offsetY + chunk.offsetY - chunk.height / 2;\r\n                        }\r\n                        else {\r\n                            y = thickness + offset * 1.5 + line.offsetY + chunk.offsetY;\r\n                        }\r\n                        if (!ghostOnly) {\r\n                            context.save();\r\n                            context.beginPath();\r\n                            if (chunk.fill) {\r\n                                context.strokeStyle = chunk.fill.toCSS();\r\n                            }\r\n                            else if (this.style.fill && this.style.fill instanceof Color) {\r\n                                context.strokeStyle = this.style.fill.toCSS();\r\n                            }\r\n                            context.lineWidth = thickness * offset;\r\n                            context.moveTo(offsetX, y);\r\n                            context.lineTo(offsetX + chunk.width, y);\r\n                            context.stroke();\r\n                            context.restore();\r\n                        }\r\n                    }\r\n                    if (interactive && this.interactive && drawGhost) {\r\n                        // Draw text in ghost canvas ONLY if it is set as interactive\r\n                        // explicitly. This way we avoid hit test anomalies caused by anti\r\n                        // aliasing of text.\r\n                        ghostContext.fillText(chunk.text, chunk.offsetX, line.offsetY + chunk.offsetY);\r\n                    }\r\n                    if (chunk.fill) {\r\n                        context.restore();\r\n                        // Color does not affect ghostContext so we not set it\r\n                    }\r\n                    // Reset style\r\n                    if (chunk.style) {\r\n                        context.restore();\r\n                        ghostContext.restore();\r\n                    }\r\n                });\r\n            });\r\n            context.restore();\r\n            ghostContext.restore();\r\n        }\r\n    }\r\n    _addBounds(bounds) {\r\n        if (this.visible && this.isMeasured) {\r\n            //if (this._textVisible) {\r\n            const x = this._measure({\r\n                inactive: this.inactive,\r\n                layer: this.getLayer(),\r\n            });\r\n            setPoint(bounds, { x: x.left, y: x.top });\r\n            setPoint(bounds, { x: x.right, y: x.bottom });\r\n            //}\r\n        }\r\n    }\r\n    _ignoreFontWeight() {\r\n        return /apple/i.test(navigator.vendor);\r\n    }\r\n    _measure(status) {\r\n        const context = status.layer.context;\r\n        const ghostContext = this._renderer._ghostLayer.context;\r\n        const rtl = this.style.direction == \"rtl\";\r\n        // Reset text info\r\n        this._textInfo = [];\r\n        // Init\r\n        const oversizedBehavior = this.style.oversizedBehavior;\r\n        const maxWidth = this.style.maxWidth;\r\n        const truncate = $type.isNumber(maxWidth) && oversizedBehavior == \"truncate\";\r\n        const wrap = $type.isNumber(maxWidth) && (oversizedBehavior == \"wrap\" || oversizedBehavior == \"wrap-no-break\");\r\n        // Pre-render\r\n        context.save();\r\n        ghostContext.save();\r\n        this._prerender(status, true, this._ignoreFontWeight());\r\n        // Get default font metrix\r\n        const refText = \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 \";\r\n        // Split up text into lines\r\n        const lines = this.text.toString().replace(/\\r/g, \"\").split(/\\n/);\r\n        let styleRestored = true;\r\n        let minX = 0;\r\n        let maxX = 0;\r\n        // Iterate through the lines\r\n        let offsetY = 0;\r\n        let currentStyle;\r\n        $array.each(lines, (line, _index) => {\r\n            // Split up line into format/value chunks\r\n            let chunks;\r\n            if (line == \"\") {\r\n                chunks = [{\r\n                        type: \"value\",\r\n                        text: \"\"\r\n                    }];\r\n            }\r\n            else {\r\n                chunks = TextFormatter.chunk(line, false, this.style.ignoreFormatting);\r\n            }\r\n            while (chunks.length > 0) {\r\n                // Init line object\r\n                let lineInfo = {\r\n                    offsetY: offsetY,\r\n                    ascent: 0,\r\n                    width: 0,\r\n                    height: 0,\r\n                    left: 0,\r\n                    right: 0,\r\n                    textChunks: []\r\n                };\r\n                // Measure reference text\r\n                const metrics = this._measureText(refText, context);\r\n                const height = metrics.actualBoundingBoxAscent + metrics.actualBoundingBoxDescent;\r\n                lineInfo.height = height;\r\n                lineInfo.ascent = metrics.actualBoundingBoxAscent;\r\n                let currentFormat;\r\n                let currentDecoration = this.style.textDecoration;\r\n                let currentFill;\r\n                let currentChunkWidth;\r\n                let skipFurtherText = false;\r\n                let firstTextChunk = true;\r\n                let leftoverChunks = [];\r\n                let currentVerticalAlign;\r\n                //let offsetX = 0;\r\n                //let chunk;\r\n                //while(chunk = chunks.shift()) {\r\n                $array.eachContinue(chunks, (chunk, index) => {\r\n                    // Format chunk\r\n                    if (chunk.type == \"format\") {\r\n                        if (chunk.text == \"[/]\") {\r\n                            if (!styleRestored) {\r\n                                context.restore();\r\n                                ghostContext.restore();\r\n                                styleRestored = true;\r\n                            }\r\n                            currentFill = undefined;\r\n                            currentStyle = undefined;\r\n                            currentChunkWidth = undefined;\r\n                            currentDecoration = this.style.textDecoration;\r\n                            currentVerticalAlign = undefined;\r\n                            currentFormat = chunk.text;\r\n                        }\r\n                        else {\r\n                            if (!styleRestored) {\r\n                                context.restore();\r\n                                ghostContext.restore();\r\n                            }\r\n                            let format = TextFormatter.getTextStyle(chunk.text);\r\n                            const fontStyle = this._getFontStyle(format);\r\n                            context.save();\r\n                            ghostContext.save();\r\n                            context.font = fontStyle;\r\n                            currentStyle = fontStyle;\r\n                            currentFormat = chunk.text;\r\n                            if (format.textDecoration) {\r\n                                currentDecoration = format.textDecoration;\r\n                            }\r\n                            if (format.fill) {\r\n                                currentFill = format.fill;\r\n                            }\r\n                            if (format.width) {\r\n                                currentChunkWidth = $type.toNumber(format.width);\r\n                            }\r\n                            if (format.verticalAlign) {\r\n                                currentVerticalAlign = format.verticalAlign;\r\n                            }\r\n                            styleRestored = false;\r\n                            // Measure reference text after change of format\r\n                            const metrics = this._measureText(refText, context);\r\n                            const height = metrics.actualBoundingBoxAscent + metrics.actualBoundingBoxDescent;\r\n                            if (height > lineInfo.height) {\r\n                                lineInfo.height = height;\r\n                            }\r\n                            if (metrics.actualBoundingBoxAscent > lineInfo.ascent) {\r\n                                lineInfo.ascent = metrics.actualBoundingBoxAscent;\r\n                            }\r\n                        }\r\n                    }\r\n                    // Text chunk\r\n                    else if (chunk.type == \"value\" && !skipFurtherText) {\r\n                        // Measure\r\n                        const metrics = this._measureText(chunk.text, context);\r\n                        let chunkWidth = metrics.actualBoundingBoxLeft + metrics.actualBoundingBoxRight;\r\n                        // Check for fit\r\n                        if (truncate) {\r\n                            this.truncated = undefined;\r\n                            // Break words?\r\n                            let breakWords = firstTextChunk || this.style.breakWords || false;\r\n                            // Measure ellipsis and check if it fits\r\n                            const ellipsis = this.style.ellipsis || \"\";\r\n                            const ellipsisMetrics = this._measureText(ellipsis, context);\r\n                            const ellipsisWidth = ellipsisMetrics.actualBoundingBoxLeft + ellipsisMetrics.actualBoundingBoxRight;\r\n                            // Check fit\r\n                            if ((lineInfo.width + chunkWidth) > maxWidth) {\r\n                                const excessWidth = maxWidth - lineInfo.width - ellipsisWidth;\r\n                                chunk.text = this._truncateText(context, chunk.text, excessWidth, breakWords);\r\n                                chunk.text += ellipsis;\r\n                                skipFurtherText = true;\r\n                                this.truncated = true;\r\n                            }\r\n                        }\r\n                        else if (wrap) {\r\n                            // Check fit\r\n                            if ((lineInfo.width + chunkWidth) > maxWidth) {\r\n                                const excessWidth = maxWidth - lineInfo.width;\r\n                                const tmpText = this._truncateText(context, chunk.text, excessWidth, false, (firstTextChunk && this.style.oversizedBehavior != \"wrap-no-break\"));\r\n                                if (tmpText == \"\") {\r\n                                    // Unable to fit a single letter - hide the whole label\r\n                                    this.textVisible = true;\r\n                                    return false;\r\n                                }\r\n                                //skipFurtherText = true;\r\n                                //Add remaining chunks for the next line\r\n                                leftoverChunks = chunks.slice(index + 1);\r\n                                //Add remaining text of current chunk if it was forced-cut\r\n                                if ($utils.trim(tmpText) != $utils.trim(chunk.text)) {\r\n                                    leftoverChunks.unshift({\r\n                                        type: \"value\",\r\n                                        text: chunk.text.substr(tmpText.length)\r\n                                    });\r\n                                    if (currentFormat) {\r\n                                        leftoverChunks.unshift({\r\n                                            type: \"format\",\r\n                                            text: currentFormat\r\n                                        });\r\n                                    }\r\n                                }\r\n                                // Set current chunk (truncated)\r\n                                chunk.text = $utils.trim(tmpText);\r\n                                chunks = [];\r\n                                skipFurtherText = true;\r\n                            }\r\n                        }\r\n                        // Chunk width?\r\n                        let leftBoundMod = 1;\r\n                        let rightBoundMod = 1;\r\n                        if (currentStyle && currentChunkWidth && (currentChunkWidth > chunkWidth)) {\r\n                            // increase horizontal bounding boxes accordingly\r\n                            const boundsMod = chunkWidth / currentChunkWidth;\r\n                            switch (this.style.textAlign) {\r\n                                case \"right\":\r\n                                case \"end\":\r\n                                    leftBoundMod = boundsMod;\r\n                                    break;\r\n                                case \"center\":\r\n                                    leftBoundMod = boundsMod;\r\n                                    rightBoundMod = boundsMod;\r\n                                    break;\r\n                                default:\r\n                                    rightBoundMod = boundsMod;\r\n                            }\r\n                            chunkWidth = currentChunkWidth;\r\n                        }\r\n                        const chunkHeight = metrics.actualBoundingBoxAscent + metrics.actualBoundingBoxDescent;\r\n                        if (chunkHeight > lineInfo.height) {\r\n                            lineInfo.height = chunkHeight;\r\n                        }\r\n                        if (metrics.actualBoundingBoxAscent > lineInfo.ascent) {\r\n                            lineInfo.ascent = metrics.actualBoundingBoxAscent;\r\n                        }\r\n                        lineInfo.width += chunkWidth;\r\n                        lineInfo.left += metrics.actualBoundingBoxLeft / leftBoundMod;\r\n                        lineInfo.right += metrics.actualBoundingBoxRight / rightBoundMod;\r\n                        lineInfo.textChunks.push({\r\n                            style: currentStyle,\r\n                            fill: currentFill,\r\n                            text: chunk.text,\r\n                            width: chunkWidth,\r\n                            height: chunkHeight,\r\n                            left: metrics.actualBoundingBoxLeft,\r\n                            right: metrics.actualBoundingBoxRight,\r\n                            ascent: metrics.actualBoundingBoxAscent,\r\n                            offsetX: 0,\r\n                            offsetY: 0,\r\n                            textDecoration: currentDecoration,\r\n                            verticalAlign: currentVerticalAlign\r\n                        });\r\n                        //offsetX += chunkWidth;\r\n                        firstTextChunk = false;\r\n                    }\r\n                    if (leftoverChunks) {\r\n                        //return false;\r\n                    }\r\n                    return true;\r\n                    //}\r\n                });\r\n                if (this.style.lineHeight instanceof Percent) {\r\n                    lineInfo.height *= this.style.lineHeight.value;\r\n                    lineInfo.ascent *= this.style.lineHeight.value;\r\n                }\r\n                else {\r\n                    lineInfo.height *= this.style.lineHeight || 1.2;\r\n                    lineInfo.ascent *= this.style.lineHeight || 1.2;\r\n                }\r\n                if (minX < lineInfo.left) {\r\n                    minX = lineInfo.left;\r\n                }\r\n                if (maxX < lineInfo.right) {\r\n                    maxX = lineInfo.right;\r\n                }\r\n                this._textInfo.push(lineInfo);\r\n                //lineInfo.offsetY += lineInfo.ascent;\r\n                offsetY += lineInfo.height;\r\n                // Reset chunks so that it can proceed to the next line\r\n                chunks = leftoverChunks || [];\r\n            }\r\n        });\r\n        if (!styleRestored) {\r\n            context.restore();\r\n            ghostContext.restore();\r\n        }\r\n        // Adjust chunk internal offsets\r\n        $array.each(this._textInfo, (lineInfo, _index) => {\r\n            let currentChunkOffset = 0;\r\n            $array.each(lineInfo.textChunks, (chunk) => {\r\n                chunk.offsetX = currentChunkOffset + chunk.left - lineInfo.left;\r\n                chunk.offsetY += lineInfo.height - lineInfo.height * (this.style.baselineRatio || 0.19);\r\n                currentChunkOffset += chunk.width * (rtl ? -1 : 1);\r\n                if (chunk.verticalAlign) {\r\n                    switch (chunk.verticalAlign) {\r\n                        case \"super\":\r\n                            chunk.offsetY -= lineInfo.height / 2 - chunk.height / 2;\r\n                            break;\r\n                        case \"sub\":\r\n                            chunk.offsetY += chunk.height / 2;\r\n                            break;\r\n                    }\r\n                }\r\n            });\r\n        });\r\n        const bounds = {\r\n            left: rtl ? -maxX : -minX,\r\n            top: 0,\r\n            right: rtl ? minX : maxX,\r\n            bottom: offsetY,\r\n        };\r\n        // We need to fit?\r\n        if (oversizedBehavior !== \"none\") {\r\n            const ratio = this._fitRatio(bounds);\r\n            if (ratio < 1) {\r\n                if (oversizedBehavior == \"fit\") {\r\n                    if ($type.isNumber(this.style.minScale) && (ratio < this.style.minScale)) {\r\n                        this.textVisible = false;\r\n                        bounds.left = 0;\r\n                        bounds.top = 0;\r\n                        bounds.right = 0;\r\n                        bounds.bottom = 0;\r\n                    }\r\n                    else {\r\n                        if (!this._originalScale) {\r\n                            this._originalScale = this.scale;\r\n                        }\r\n                        this.scale = ratio;\r\n                        this.textVisible = true;\r\n                    }\r\n                }\r\n                else if (oversizedBehavior == \"hide\") {\r\n                    this.textVisible = false;\r\n                    bounds.left = 0;\r\n                    bounds.top = 0;\r\n                    bounds.right = 0;\r\n                    bounds.bottom = 0;\r\n                }\r\n                else {\r\n                    switch (this.style.textAlign) {\r\n                        case \"right\":\r\n                        case \"end\":\r\n                            bounds.left = rtl ? maxWidth : -maxWidth;\r\n                            bounds.right = 0;\r\n                            break;\r\n                        case \"center\":\r\n                            bounds.left = -maxWidth / 2;\r\n                            bounds.right = maxWidth / 2;\r\n                            break;\r\n                        default:\r\n                            bounds.left = 0;\r\n                            bounds.right = rtl ? -maxWidth : maxWidth;\r\n                    }\r\n                    this.scale = this._originalScale || 1;\r\n                    this._originalScale = undefined;\r\n                    this.textVisible = true;\r\n                }\r\n            }\r\n            else {\r\n                this.scale = this._originalScale || 1;\r\n                this._originalScale = undefined;\r\n                this.textVisible = true;\r\n            }\r\n        }\r\n        context.restore();\r\n        ghostContext.restore();\r\n        return bounds;\r\n    }\r\n    _fitRatio(bounds) {\r\n        const maxW = this.style.maxWidth;\r\n        const maxH = this.style.maxHeight;\r\n        if (!$type.isNumber(maxW) && !$type.isNumber(maxH)) {\r\n            return 1;\r\n        }\r\n        const w = bounds.right - bounds.left;\r\n        const h = bounds.bottom - bounds.top;\r\n        return Math.min(maxW / w || 1, maxH / h || 1);\r\n    }\r\n    _truncateText(context, text, maxWidth, breakWords = false, fallbackBreakWords = true) {\r\n        let width;\r\n        do {\r\n            if (breakWords) {\r\n                text = text.slice(0, -1);\r\n            }\r\n            else {\r\n                let tmp = text.replace(/[^,;:!?\\\\\\/\\s]+[,;:!?\\\\\\/\\s]*$/g, \"\");\r\n                if ((tmp == \"\" || tmp === text) && fallbackBreakWords) {\r\n                    breakWords = true;\r\n                }\r\n                else if (tmp == \"\") {\r\n                    return text;\r\n                }\r\n                else {\r\n                    text = tmp;\r\n                }\r\n            }\r\n            const metrics = this._measureText(text, context);\r\n            width = metrics.actualBoundingBoxLeft + metrics.actualBoundingBoxRight;\r\n        } while ((width > maxWidth) && text != \"\");\r\n        return text;\r\n    }\r\n    _measureText(text, context) {\r\n        let metrics = context.measureText(text);\r\n        let fakeMetrics = {};\r\n        if (metrics.actualBoundingBoxAscent == null) {\r\n            const div = document.createElement(\"div\");\r\n            div.innerText = text;\r\n            div.style.visibility = \"hidden\";\r\n            div.style.position = \"absolute\";\r\n            div.style.top = \"-1000000px;\";\r\n            div.style.fontFamily = this.style.fontFamily || \"\";\r\n            div.style.fontSize = this.style.fontSize + \"\";\r\n            document.body.appendChild(div);\r\n            const bbox = div.getBoundingClientRect();\r\n            document.body.removeChild(div);\r\n            const h = bbox.height;\r\n            const w = metrics.width;\r\n            let left = 0;\r\n            let right = w;\r\n            fakeMetrics = {\r\n                actualBoundingBoxAscent: h,\r\n                actualBoundingBoxDescent: 0,\r\n                actualBoundingBoxLeft: left,\r\n                actualBoundingBoxRight: right,\r\n                fontBoundingBoxAscent: h,\r\n                fontBoundingBoxDescent: 0,\r\n                width: w\r\n            };\r\n            //return fake;\r\n        }\r\n        else {\r\n            fakeMetrics = {\r\n                actualBoundingBoxAscent: metrics.actualBoundingBoxAscent,\r\n                actualBoundingBoxDescent: metrics.actualBoundingBoxDescent,\r\n                actualBoundingBoxLeft: metrics.actualBoundingBoxLeft,\r\n                actualBoundingBoxRight: metrics.actualBoundingBoxRight,\r\n                fontBoundingBoxAscent: metrics.actualBoundingBoxAscent,\r\n                fontBoundingBoxDescent: metrics.actualBoundingBoxDescent,\r\n                width: metrics.width\r\n            };\r\n        }\r\n        const w = metrics.width;\r\n        switch (this.style.textAlign) {\r\n            case \"right\":\r\n            case \"end\":\r\n                fakeMetrics.actualBoundingBoxLeft = w;\r\n                fakeMetrics.actualBoundingBoxRight = 0;\r\n                break;\r\n            case \"center\":\r\n                fakeMetrics.actualBoundingBoxLeft = w / 2;\r\n                fakeMetrics.actualBoundingBoxRight = w / 2;\r\n                break;\r\n            default:\r\n                fakeMetrics.actualBoundingBoxLeft = 0;\r\n                fakeMetrics.actualBoundingBoxRight = w;\r\n        }\r\n        return fakeMetrics;\r\n    }\r\n}\r\n/**\r\n * @ignore\r\n */\r\nexport class CanvasTextStyle {\r\n    constructor() {\r\n        //public wordWrapWidth: number = 100;\r\n        Object.defineProperty(this, \"fill\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"fillOpacity\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"textAlign\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"fontFamily\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"fontSize\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"fontWeight\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"fontStyle\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"fontVariant\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"textDecoration\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"shadowColor\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"shadowBlur\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"shadowOffsetX\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"shadowOffsetY\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"shadowOpacity\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        // leading?: number;\r\n        // letterSpacing?: number;\r\n        Object.defineProperty(this, \"lineHeight\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: percent(120)\r\n        });\r\n        Object.defineProperty(this, \"baselineRatio\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: 0.19\r\n        });\r\n        // padding?: number;\r\n        // stroke?: number;\r\n        // strokeThickness?: number;\r\n        // trim?: number;\r\n        // wordWrap?: boolean;\r\n        Object.defineProperty(this, \"direction\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"textBaseline\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"oversizedBehavior\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: \"none\"\r\n        });\r\n        Object.defineProperty(this, \"breakWords\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: false\r\n        });\r\n        Object.defineProperty(this, \"ellipsis\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: \"\"\r\n        });\r\n        Object.defineProperty(this, \"maxWidth\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"maxHeight\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"minScale\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"ignoreFormatting\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: false\r\n        });\r\n    }\r\n}\r\n/**\r\n * @ignore\r\n */\r\nexport class CanvasRadialText extends CanvasText {\r\n    constructor() {\r\n        super(...arguments);\r\n        Object.defineProperty(this, \"textType\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: \"circular\"\r\n        });\r\n        Object.defineProperty(this, \"radius\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"startAngle\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"inside\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: false\r\n        });\r\n        Object.defineProperty(this, \"orientation\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: \"auto\"\r\n        });\r\n        Object.defineProperty(this, \"kerning\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: 0\r\n        });\r\n        Object.defineProperty(this, \"_textReversed\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: false\r\n        });\r\n    }\r\n    _render(status, targetGhostLayer = 0) {\r\n        switch (this.textType) {\r\n            case \"circular\":\r\n                this._renderCircular(status, targetGhostLayer);\r\n                break;\r\n            default:\r\n                super._render(status, targetGhostLayer);\r\n                break;\r\n        }\r\n    }\r\n    _renderCircular(status, targetGhostLayer = 0) {\r\n        if (this.textVisible) {\r\n            this._prerender(status);\r\n            const interactive = this._isInteractive(status);\r\n            const context = status.layer.context;\r\n            const layerDirty = status.layer.dirty;\r\n            const ghostContext = this._renderer._ghostLayer.context;\r\n            // Savepoint\r\n            context.save();\r\n            if (interactive) {\r\n                ghostContext.save();\r\n            }\r\n            // We need measurements in order to properly position text for alignment\r\n            if (!this._textInfo) {\r\n                this._measure(status);\r\n            }\r\n            // Init\r\n            let radius = (this.radius || 0);\r\n            let startAngle = (this.startAngle || 0);\r\n            let deltaAngle = 0;\r\n            let orientation = this.orientation;\r\n            let inward = orientation == \"auto\" ? \"auto\" : orientation == \"inward\";\r\n            const inside = this.inside;\r\n            const align = this.style.textAlign || \"left\";\r\n            const kerning = this.kerning || 0;\r\n            let clockwise = align == \"left\" ? 1 : -1;\r\n            const shouldReverse = !this._textReversed;\r\n            const ghostOnly = this._ghostOnly(targetGhostLayer);\r\n            const drawGhost = this._drawGhost(status, targetGhostLayer);\r\n            // Check if we need to invert the whole stuff\r\n            if (inward == \"auto\") {\r\n                // Calc max angle so we know whether we need to flip it\r\n                let maxAngle = 0;\r\n                let midAngle = 0;\r\n                $array.each(this._textInfo, (line, _index) => {\r\n                    const deltaAngle = startAngle + (line.width / (radius - line.height)) / 2 * -clockwise;\r\n                    if (deltaAngle > maxAngle) {\r\n                        maxAngle = deltaAngle;\r\n                    }\r\n                });\r\n                if (align == \"left\") {\r\n                    midAngle = (maxAngle + deltaAngle / 2) * $math.DEGREES;\r\n                }\r\n                else if (align == \"right\") {\r\n                    midAngle = (maxAngle - deltaAngle / 2) * $math.DEGREES;\r\n                }\r\n                else {\r\n                    midAngle = startAngle * $math.DEGREES;\r\n                }\r\n                midAngle = $math.normalizeAngle(midAngle);\r\n                inward = (midAngle >= 270) || (midAngle <= 90);\r\n            }\r\n            if (inward == true && shouldReverse) {\r\n                this._textInfo.reverse();\r\n                this._textReversed = true;\r\n            }\r\n            // if ((inward == false && align == \"left\") || (inward == true && align == \"right\")) {\r\n            // \tclockwise *= -1;\r\n            // }\r\n            // Process text info produced by _measure()\r\n            $array.each(this._textInfo, (line, _index) => {\r\n                const textHeight = line.height;\r\n                // Adjust radius (for `inside = false`)\r\n                // Radius adjustment for `inside = false` is below the line calculation\r\n                if (!inside) {\r\n                    radius += textHeight;\r\n                }\r\n                // Reverse letters if we're painting them counter-clockwise\r\n                if (((clockwise == -1 && inward) || (clockwise == 1 && !inward)) && shouldReverse) {\r\n                    line.textChunks.reverse();\r\n                }\r\n                // Init angles\r\n                let lineStartAngle = startAngle;\r\n                deltaAngle = 0;\r\n                // Adjust for center-align\r\n                if (align == \"center\") {\r\n                    lineStartAngle += (line.width / (radius - textHeight)) / 2 * -clockwise;\r\n                    deltaAngle = lineStartAngle - startAngle;\r\n                }\r\n                // if (inward == \"auto\") {\r\n                // \tlet midAngle;\r\n                // \tif (align == \"left\") {\r\n                // \t\tmidAngle = (lineStartAngle + deltaAngle / 2) * $math.DEGREES;\r\n                // \t}\r\n                // \telse if () {\r\n                // \t\tmidAngle = (lineStartAngle - deltaAngle / 2) * $math.DEGREES;\r\n                // \t}\r\n                // \tinward = (midAngle >= 270) || (midAngle <= 90);\r\n                // }\r\n                // Rotate letters if they are facing outward\r\n                lineStartAngle += (Math.PI * (inward ? 0 : 1)); // Rotate 180 if outward\r\n                // Savepoint\r\n                context.save();\r\n                if (interactive) {\r\n                    ghostContext.save();\r\n                }\r\n                // Assume starting angle\r\n                if (!ghostOnly) {\r\n                    context.rotate(lineStartAngle);\r\n                }\r\n                if (interactive) {\r\n                    ghostContext.rotate(lineStartAngle);\r\n                }\r\n                let angleShift = 0;\r\n                $array.each(line.textChunks, (chunk, _index) => {\r\n                    // Draw the letter\r\n                    const char = chunk.text;\r\n                    const charWidth = chunk.width;\r\n                    // Rotate half a letter\r\n                    angleShift = (charWidth / 2) / (radius - textHeight) * clockwise;\r\n                    if (!ghostOnly) {\r\n                        context.rotate(angleShift);\r\n                    }\r\n                    if (interactive) {\r\n                        ghostContext.rotate(angleShift);\r\n                    }\r\n                    // Set style\r\n                    if (chunk.style) {\r\n                        context.save();\r\n                        ghostContext.save();\r\n                        if (!ghostOnly) {\r\n                            context.font = chunk.style;\r\n                        }\r\n                        if (interactive) {\r\n                            ghostContext.font = chunk.style;\r\n                        }\r\n                    }\r\n                    if (chunk.fill) {\r\n                        context.save();\r\n                        if (!ghostOnly) {\r\n                            context.fillStyle = chunk.fill.toCSS();\r\n                        }\r\n                        // Color does not affect ghostContext so we not set it\r\n                    }\r\n                    // Center letters\r\n                    if (!ghostOnly) {\r\n                        context.textBaseline = \"middle\";\r\n                        context.textAlign = \"center\";\r\n                    }\r\n                    if (interactive) {\r\n                        ghostContext.textBaseline = \"middle\";\r\n                        ghostContext.textAlign = \"center\";\r\n                    }\r\n                    // Plop the letter\r\n                    if (layerDirty && !ghostOnly) {\r\n                        context.fillText(char, 0, (inward ? 1 : -1) * (0 - radius + textHeight / 2));\r\n                    }\r\n                    if (interactive && drawGhost) {\r\n                        ghostContext.fillText(char, 0, (inward ? 1 : -1) * (0 - radius + textHeight / 2));\r\n                    }\r\n                    if (chunk.fill) {\r\n                        context.restore();\r\n                        // Color does not affect ghostContext so we not set it\r\n                    }\r\n                    // Reset style\r\n                    if (chunk.style) {\r\n                        context.restore();\r\n                        ghostContext.restore();\r\n                    }\r\n                    // Rotate half a letter and add spacing\r\n                    angleShift = (charWidth / 2 + kerning) / (radius - textHeight) * clockwise;\r\n                    if (!ghostOnly) {\r\n                        context.rotate(angleShift);\r\n                    }\r\n                    if (interactive) {\r\n                        ghostContext.rotate(angleShift);\r\n                    }\r\n                });\r\n                // Restore angle\r\n                context.restore();\r\n                if (interactive) {\r\n                    ghostContext.restore();\r\n                }\r\n                // Adjust radius (for `inside = true`)\r\n                if (inside) {\r\n                    radius -= textHeight;\r\n                }\r\n            });\r\n            // Restore\r\n            context.restore();\r\n            if (interactive) {\r\n                ghostContext.restore();\r\n            }\r\n        }\r\n    }\r\n    _measure(status) {\r\n        switch (this.textType) {\r\n            case \"circular\":\r\n                return this._measureCircular(status);\r\n            default:\r\n                return super._measure(status);\r\n        }\r\n    }\r\n    _measureCircular(status) {\r\n        const context = status.layer.context;\r\n        const ghostContext = this._renderer._ghostLayer.context;\r\n        const rtl = this.style.direction == \"rtl\";\r\n        const oversizedBehavior = this.style.oversizedBehavior;\r\n        const maxWidth = this.style.maxWidth;\r\n        const truncate = $type.isNumber(maxWidth) && oversizedBehavior == \"truncate\";\r\n        const ellipsis = this.style.ellipsis || \"\";\r\n        let ellipsisMetrics;\r\n        //const wrap = $type.isNumber(maxWidth) && (oversizedBehavior == \"wrap\" || oversizedBehavior == \"wrap-no-break\");\r\n        // Reset text info\r\n        this.textVisible = true;\r\n        this._textInfo = [];\r\n        this._textReversed = false;\r\n        // Pre-render\r\n        context.save();\r\n        ghostContext.save();\r\n        this._prerender(status, true);\r\n        // Split up text into lines\r\n        const lines = this.text.toString().replace(/\\r/g, \"\").split(/\\n/);\r\n        let styleRestored = true;\r\n        let totalWidth = 0;\r\n        // Iterate through the lines\r\n        let offsetY = 0;\r\n        $array.each(lines, (line, _index) => {\r\n            // Split up line into format/value chunks\r\n            let chunks = TextFormatter.chunk(line, false, this.style.ignoreFormatting);\r\n            // Init line object\r\n            let lineInfo = {\r\n                offsetY: offsetY,\r\n                ascent: 0,\r\n                width: 0,\r\n                height: 0,\r\n                left: 0,\r\n                right: 0,\r\n                textChunks: []\r\n            };\r\n            let currentStyle;\r\n            let currentFill;\r\n            let currentChunkWidth;\r\n            //while(chunk = chunks.shift()) {\r\n            $array.each(chunks, (chunk, _index) => {\r\n                // Format chunk\r\n                if (chunk.type == \"format\") {\r\n                    if (chunk.text == \"[/]\") {\r\n                        if (!styleRestored) {\r\n                            context.restore();\r\n                            ghostContext.restore();\r\n                            styleRestored = true;\r\n                        }\r\n                        currentFill = undefined;\r\n                        currentStyle = undefined;\r\n                        currentChunkWidth = undefined;\r\n                    }\r\n                    else {\r\n                        let format = TextFormatter.getTextStyle(chunk.text);\r\n                        const fontStyle = this._getFontStyle(format);\r\n                        context.save();\r\n                        ghostContext.save();\r\n                        context.font = fontStyle;\r\n                        currentStyle = fontStyle;\r\n                        if (format.fill) {\r\n                            currentFill = format.fill;\r\n                        }\r\n                        if (format.width) {\r\n                            currentChunkWidth = $type.toNumber(format.width);\r\n                        }\r\n                        styleRestored = false;\r\n                    }\r\n                    if (truncate) {\r\n                        ellipsisMetrics = this._measureText(ellipsis, context);\r\n                    }\r\n                }\r\n                // Text format\r\n                else if (chunk.type == \"value\") {\r\n                    // Measure each letter\r\n                    let chars = chunk.text.match(/./ug) || [];\r\n                    if (rtl) {\r\n                        chars = $utils.splitString(chunk.text);\r\n                        chars.reverse();\r\n                    }\r\n                    for (let i = 0; i < chars.length; i++) {\r\n                        const char = chars[i];\r\n                        // Measure\r\n                        const metrics = this._measureText(char, context);\r\n                        let chunkWidth = metrics.width;\r\n                        // Chunk width?\r\n                        if (currentStyle && currentChunkWidth && (currentChunkWidth > chunkWidth)) {\r\n                            chunkWidth = currentChunkWidth;\r\n                        }\r\n                        const chunkHeight = metrics.actualBoundingBoxAscent + metrics.actualBoundingBoxDescent;\r\n                        if (chunkHeight > lineInfo.height) {\r\n                            lineInfo.height = chunkHeight;\r\n                        }\r\n                        if (metrics.actualBoundingBoxAscent > lineInfo.ascent) {\r\n                            lineInfo.ascent = metrics.actualBoundingBoxAscent;\r\n                        }\r\n                        totalWidth += chunkWidth;\r\n                        // Handle oversized behavior\r\n                        if (truncate) {\r\n                            // Measure ellipsis and check if it fits\r\n                            if (!ellipsisMetrics) {\r\n                                ellipsisMetrics = this._measureText(ellipsis, context);\r\n                            }\r\n                            const ellipsisWidth = ellipsisMetrics.actualBoundingBoxLeft + ellipsisMetrics.actualBoundingBoxRight;\r\n                            //totalWidth += ellipsisWidth;\r\n                            if ((totalWidth + ellipsisWidth) > maxWidth) {\r\n                                if (lineInfo.textChunks.length == 1) {\r\n                                    this.textVisible = false;\r\n                                }\r\n                                else {\r\n                                    lineInfo.width += ellipsisWidth;\r\n                                    lineInfo.left += ellipsisMetrics.actualBoundingBoxLeft;\r\n                                    lineInfo.right += ellipsisMetrics.actualBoundingBoxRight;\r\n                                    lineInfo.textChunks.push({\r\n                                        style: currentStyle,\r\n                                        fill: currentFill,\r\n                                        text: ellipsis,\r\n                                        width: ellipsisWidth,\r\n                                        height: chunkHeight + ellipsisMetrics.actualBoundingBoxDescent,\r\n                                        left: ellipsisMetrics.actualBoundingBoxLeft,\r\n                                        right: ellipsisMetrics.actualBoundingBoxRight,\r\n                                        ascent: ellipsisMetrics.actualBoundingBoxAscent,\r\n                                        offsetX: 0,\r\n                                        offsetY: chunkHeight,\r\n                                        textDecoration: undefined\r\n                                    });\r\n                                }\r\n                                break;\r\n                            }\r\n                        }\r\n                        lineInfo.width += chunkWidth;\r\n                        lineInfo.left += metrics.actualBoundingBoxLeft;\r\n                        lineInfo.right += metrics.actualBoundingBoxRight;\r\n                        lineInfo.textChunks.push({\r\n                            style: currentStyle,\r\n                            fill: currentFill,\r\n                            text: char,\r\n                            width: chunkWidth,\r\n                            height: chunkHeight + metrics.actualBoundingBoxDescent,\r\n                            left: metrics.actualBoundingBoxLeft,\r\n                            right: metrics.actualBoundingBoxRight,\r\n                            ascent: metrics.actualBoundingBoxAscent,\r\n                            offsetX: 0,\r\n                            offsetY: chunkHeight,\r\n                            textDecoration: undefined\r\n                        });\r\n                        if (rtl) {\r\n                            // @todo still needed?\r\n                            //break;\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n            if (this.style.lineHeight instanceof Percent) {\r\n                lineInfo.height *= this.style.lineHeight.value;\r\n            }\r\n            else {\r\n                lineInfo.height *= this.style.lineHeight || 1.2;\r\n            }\r\n            this._textInfo.push(lineInfo);\r\n            //lineInfo.offsetY += lineInfo.ascent;\r\n            offsetY += lineInfo.height;\r\n        });\r\n        if (!styleRestored) {\r\n            context.restore();\r\n            ghostContext.restore();\r\n        }\r\n        if (oversizedBehavior == \"hide\" && (totalWidth > maxWidth)) {\r\n            this.textVisible = false;\r\n        }\r\n        // Adjust chunk internal offsets\r\n        $array.each(this._textInfo, (lineInfo) => {\r\n            $array.each(lineInfo.textChunks, (chunk) => {\r\n                chunk.offsetY += Math.round((lineInfo.height - chunk.height + (lineInfo.ascent - chunk.ascent)) / 2);\r\n            });\r\n        });\r\n        context.restore();\r\n        ghostContext.restore();\r\n        return {\r\n            left: 0,\r\n            top: 0,\r\n            right: 0,\r\n            bottom: 0,\r\n        };\r\n    }\r\n}\r\n/**\r\n * @ignore\r\n */\r\nexport class CanvasImage extends CanvasDisplayObject {\r\n    constructor(renderer, image) {\r\n        super(renderer);\r\n        Object.defineProperty(this, \"width\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"height\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"image\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"tainted\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"shadowColor\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"shadowBlur\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"shadowOffsetX\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"shadowOffsetY\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"shadowOpacity\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"_imageMask\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        this.image = image;\r\n    }\r\n    _dispose() {\r\n        super._dispose();\r\n        if (this._imageMask) {\r\n            clearCanvas(this._imageMask);\r\n        }\r\n    }\r\n    getLocalBounds() {\r\n        if (!this._localBounds) {\r\n            let w = 0;\r\n            let h = 0;\r\n            if (this.width) {\r\n                w = this.width;\r\n            }\r\n            if (this.height) {\r\n                h = this.height;\r\n            }\r\n            this._localBounds = {\r\n                left: 0,\r\n                top: 0,\r\n                right: w,\r\n                bottom: h\r\n            };\r\n            this._addBounds(this._localBounds);\r\n        }\r\n        return this._localBounds;\r\n    }\r\n    _render(status, targetGhostLayer = 0) {\r\n        super._render(status);\r\n        if (this.image) {\r\n            if (this.tainted === undefined) {\r\n                this.tainted = isTainted(this.image);\r\n                status.layer.tainted = true;\r\n            }\r\n            if (this.tainted && this._renderer._omitTainted) {\r\n                return;\r\n            }\r\n            const ghostOnly = this._ghostOnly(targetGhostLayer);\r\n            const drawGhost = this._drawGhost(status, targetGhostLayer);\r\n            if (status.layer.dirty && !ghostOnly) {\r\n                if (this.shadowColor) {\r\n                    status.layer.context.shadowColor = this.shadowColor.toCSS(this.shadowOpacity || 1);\r\n                }\r\n                if (this.shadowBlur) {\r\n                    status.layer.context.shadowBlur = this.shadowBlur;\r\n                }\r\n                if (this.shadowOffsetX) {\r\n                    status.layer.context.shadowOffsetX = this.shadowOffsetX;\r\n                }\r\n                if (this.shadowOffsetY) {\r\n                    status.layer.context.shadowOffsetY = this.shadowOffsetY;\r\n                }\r\n                // TODO should this round ?\r\n                const width = this.width || this.image.naturalWidth;\r\n                const height = this.height || this.image.naturalHeight;\r\n                status.layer.context.drawImage(this.image, 0, 0, width, height);\r\n            }\r\n            if (this.interactive && this._isInteractive(status) && drawGhost) {\r\n                const mask = this._getMask(this.image);\r\n                this._renderer._ghostLayer.context.drawImage(mask, 0, 0);\r\n            }\r\n        }\r\n    }\r\n    clear() {\r\n        super.clear();\r\n        this.image = undefined;\r\n        this._imageMask = undefined;\r\n    }\r\n    _getMask(image) {\r\n        if (this._imageMask === undefined) {\r\n            // TODO should this round ?\r\n            const width = this.width || image.naturalWidth;\r\n            const height = this.height || image.naturalHeight;\r\n            // We need to create a second canvas because destination-in clears out the entire canvas\r\n            const canvas = document.createElement(\"canvas\");\r\n            canvas.width = width;\r\n            canvas.height = height;\r\n            const context = canvas.getContext(\"2d\");\r\n            context.imageSmoothingEnabled = false;\r\n            context.fillStyle = this._getColorId();\r\n            context.fillRect(0, 0, width, height);\r\n            if (!isTainted(image)) {\r\n                context.globalCompositeOperation = \"destination-in\";\r\n                context.drawImage(image, 0, 0, width, height);\r\n            }\r\n            this._imageMask = canvas;\r\n        }\r\n        return this._imageMask;\r\n    }\r\n}\r\n/**\r\n * @ignore\r\n */\r\nexport class CanvasRendererEvent {\r\n    constructor(event, originalPoint, point, bbox) {\r\n        Object.defineProperty(this, \"event\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: event\r\n        });\r\n        Object.defineProperty(this, \"originalPoint\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: originalPoint\r\n        });\r\n        Object.defineProperty(this, \"point\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: point\r\n        });\r\n        Object.defineProperty(this, \"bbox\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: bbox\r\n        });\r\n        Object.defineProperty(this, \"id\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"simulated\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: false\r\n        });\r\n        Object.defineProperty(this, \"native\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: true\r\n        });\r\n        if ($utils.supports(\"touchevents\") && event instanceof Touch) {\r\n            this.id = event.identifier;\r\n        }\r\n        else {\r\n            this.id = null;\r\n        }\r\n    }\r\n}\r\n/**\r\n * @ignore\r\n */\r\nexport class CanvasRenderer extends ArrayDisposer {\r\n    constructor(resolution) {\r\n        super();\r\n        Object.defineProperty(this, \"view\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: document.createElement(\"div\")\r\n        });\r\n        Object.defineProperty(this, \"_layerDom\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: document.createElement(\"div\")\r\n        });\r\n        Object.defineProperty(this, \"layers\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: []\r\n        });\r\n        Object.defineProperty(this, \"_dirtyLayers\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: []\r\n        });\r\n        Object.defineProperty(this, \"defaultLayer\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: this.getLayer(0)\r\n        });\r\n        Object.defineProperty(this, \"_ghostLayer\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: new GhostLayer()\r\n        });\r\n        Object.defineProperty(this, \"_deferredGhostLayers\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: []\r\n        });\r\n        Object.defineProperty(this, \"_patternCanvas\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: document.createElement(\"canvas\")\r\n        });\r\n        Object.defineProperty(this, \"_patternContext\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: this._patternCanvas.getContext(\"2d\")\r\n        });\r\n        Object.defineProperty(this, \"_realWidth\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: 0\r\n        });\r\n        Object.defineProperty(this, \"_realHeight\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: 0\r\n        });\r\n        Object.defineProperty(this, \"_calculatedWidth\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: 0\r\n        });\r\n        Object.defineProperty(this, \"_calculatedHeight\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: 0\r\n        });\r\n        Object.defineProperty(this, \"resolution\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"interactionsEnabled\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: true\r\n        });\r\n        Object.defineProperty(this, \"_listeners\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: {}\r\n        });\r\n        Object.defineProperty(this, \"_events\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: {}\r\n        });\r\n        Object.defineProperty(this, \"_colorId\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: 0\r\n        });\r\n        Object.defineProperty(this, \"_colorMap\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: {}\r\n        });\r\n        Object.defineProperty(this, \"_forceInteractive\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: 0\r\n        });\r\n        Object.defineProperty(this, \"_omitTainted\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: false\r\n        });\r\n        // TODO this should store the Id as well\r\n        Object.defineProperty(this, \"_hovering\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: new Set()\r\n        });\r\n        Object.defineProperty(this, \"_dragging\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: []\r\n        });\r\n        Object.defineProperty(this, \"_mousedown\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: []\r\n        });\r\n        Object.defineProperty(this, \"_lastPointerMoveEvent\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"tapToActivate\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: false\r\n        });\r\n        Object.defineProperty(this, \"tapToActivateTimeout\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: 3000\r\n        });\r\n        Object.defineProperty(this, \"_touchActive\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: false\r\n        });\r\n        Object.defineProperty(this, \"_touchActiveTimeout\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        if (resolution == null) {\r\n            this.resolution = window.devicePixelRatio;\r\n        }\r\n        else {\r\n            this.resolution = resolution;\r\n        }\r\n        this.view.style.position = \"absolute\";\r\n        this.view.setAttribute(\"aria-hidden\", \"true\");\r\n        this.view.appendChild(this._layerDom);\r\n        this._disposers.push(new Disposer(() => {\r\n            $object.each(this._events, (_key, events) => {\r\n                events.disposer.dispose();\r\n            });\r\n            $array.each(this.layers, (layer) => {\r\n                clearCanvas(layer.view);\r\n                if (layer.exportableView) {\r\n                    clearCanvas(layer.exportableView);\r\n                }\r\n            });\r\n            clearCanvas(this._ghostLayer.view);\r\n            clearCanvas(this._patternCanvas);\r\n        }));\r\n        /*\r\n        this._disposers.push($utils.addEventListener(this._ghostLayer.view, \"click\", (originalEvent: MouseEvent) => {\r\n            const event = this.getEvent(originalEvent);\r\n            const target = this._getHitTarget(event.originalPoint, event.bbox);\r\n            console.debug(target);\r\n        }));\r\n        */\r\n        // Monitor for possible pixel ratio changes (when page is zoomed)\r\n        this._disposers.push($utils.onZoom(() => {\r\n            if (resolution == null) {\r\n                this.resolution = window.devicePixelRatio;\r\n            }\r\n        }));\r\n        // We need this in order top prevent default touch gestures when dragging\r\n        // draggable elements\r\n        if ($utils.supports(\"touchevents\")) {\r\n            const listener = (ev) => {\r\n                if (this._dragging.length !== 0) {\r\n                    $array.eachContinue(this._dragging, (item) => {\r\n                        if (item.value.shouldCancelTouch()) {\r\n                            ev.preventDefault();\r\n                            return false;\r\n                        }\r\n                        return true;\r\n                    });\r\n                }\r\n                // If touch down happends, delay touch out\r\n                if (this._touchActiveTimeout) {\r\n                    this._delayTouchDeactivate();\r\n                }\r\n            };\r\n            this._disposers.push($utils.addEventListener(window, \"touchstart\", listener, { passive: false }));\r\n            this._disposers.push($utils.addEventListener(this.view, \"touchstart\", listener, { passive: false }));\r\n            this._disposers.push($utils.addEventListener(this.view, \"touchmove\", () => {\r\n                // If touch is moving, delay touch out\r\n                if (this._touchActiveTimeout) {\r\n                    this._delayTouchDeactivate();\r\n                }\r\n            }, { passive: true }));\r\n            this._disposers.push($utils.addEventListener(window, \"click\", (_ev) => {\r\n                this._touchActive = false;\r\n            }, { passive: true }));\r\n            this._disposers.push($utils.addEventListener(this.view, \"click\", (_ev) => {\r\n                window.setTimeout(() => {\r\n                    this._touchActive = true;\r\n                    this._delayTouchDeactivate();\r\n                }, 100);\r\n            }, { passive: true }));\r\n        }\r\n        // Prevent scrolling of the window when hovering on \"wheelable\" object\r\n        if ($utils.supports(\"wheelevents\")) {\r\n            this._disposers.push($utils.addEventListener(this.view, \"wheel\", (ev) => {\r\n                let prevent = false;\r\n                this._hovering.forEach((obj) => {\r\n                    if (obj.wheelable) {\r\n                        prevent = true;\r\n                        return false;\r\n                    }\r\n                });\r\n                if (prevent) {\r\n                    ev.preventDefault();\r\n                }\r\n            }, { passive: false }));\r\n        }\r\n    }\r\n    /*protected _mouseMoveThrottler: Throttler = new Throttler(() => {\r\n        this._dispatchGlobalMousemove(this._lastPointerMoveEvent.event, this._lastPointerMoveEvent.native);\r\n    });\r\n    */\r\n    resetImageArray() {\r\n        this._ghostLayer.imageArray = undefined;\r\n    }\r\n    _delayTouchDeactivate() {\r\n        if (this._touchActiveTimeout) {\r\n            clearTimeout(this._touchActiveTimeout);\r\n        }\r\n        if (this.tapToActivateTimeout > 0) {\r\n            this._touchActiveTimeout = window.setTimeout(() => {\r\n                this._touchActive = false;\r\n            }, this.tapToActivateTimeout);\r\n        }\r\n    }\r\n    get debugGhostView() {\r\n        return !!this._ghostLayer.view.parentNode;\r\n    }\r\n    set debugGhostView(value) {\r\n        if (value) {\r\n            if (!this._ghostLayer.view.parentNode) {\r\n                this.view.appendChild(this._ghostLayer.view);\r\n            }\r\n        }\r\n        else {\r\n            if (this._ghostLayer.view.parentNode) {\r\n                this._ghostLayer.view.parentNode.removeChild(this._ghostLayer.view);\r\n            }\r\n        }\r\n    }\r\n    createLinearGradient(x1, y1, x2, y2) {\r\n        return this.defaultLayer.context.createLinearGradient(x1, y1, x2, y2);\r\n    }\r\n    createRadialGradient(x1, y1, radius1, x2, y2, radius2) {\r\n        return this.defaultLayer.context.createRadialGradient(x1, y1, radius1, x2, y2, radius2);\r\n    }\r\n    createPattern(graphics, background, repetition, width, height) {\r\n        // const patternCanvas = document.createElement(\"canvas\");\r\n        // const patternContext = patternCanvas.getContext(\"2d\")!;\r\n        // patternCanvas.width = width;\r\n        // patternCanvas.height = height;\r\n        // if (fill) {\r\n        // \tpatternContext.fillStyle = fill.toCSS();\r\n        // \tpatternContext.fillRect(0, 0, patternCanvas.width, patternCanvas.height);\r\n        // }\r\n        // const layer = {\r\n        // \tview: patternCanvas,\r\n        // \tcontext: patternContext,\r\n        // \tvisible: true,\r\n        // \torder: 0,\r\n        // \twidth: width,\r\n        // \theight: height,\r\n        // \tdirty: true\r\n        // };\r\n        // // patternContext.arc(0, 0, 50, 0, .5 * Math.PI);\r\n        // // patternContext.stroke();\r\n        // image.targetLayer = layer;\r\n        // image.render(layer);\r\n        //this._layerDom.appendChild(patternCanvas);\r\n        this._patternCanvas.width = width;\r\n        this._patternCanvas.height = height;\r\n        this._patternContext.clearRect(0, 0, width, height);\r\n        // patternCanvas.style.width = width * this.resolution + \"px\";\r\n        // patternCanvas.style.height = height * this.resolution + \"px\";\r\n        background.renderDetached(this._patternContext);\r\n        graphics.renderDetached(this._patternContext);\r\n        return this._patternContext.createPattern(this._patternCanvas, repetition);\r\n    }\r\n    makeContainer() {\r\n        return new CanvasContainer(this);\r\n    }\r\n    makeGraphics() {\r\n        return new CanvasGraphics(this);\r\n    }\r\n    makeText(text, style) {\r\n        return new CanvasText(this, text, style);\r\n    }\r\n    makeTextStyle() {\r\n        return new CanvasTextStyle();\r\n    }\r\n    makeRadialText(text, style) {\r\n        return new CanvasRadialText(this, text, style);\r\n    }\r\n    makePicture(image) {\r\n        return new CanvasImage(this, image);\r\n    }\r\n    resizeLayer(layer) {\r\n        layer.resize(this._calculatedWidth, this._calculatedHeight, this._calculatedWidth, this._calculatedHeight, this.resolution);\r\n    }\r\n    resizeGhost() {\r\n        this._ghostLayer.resize(this._calculatedWidth, this._calculatedHeight, this._calculatedWidth, this._calculatedHeight, this.resolution);\r\n    }\r\n    resize(realWidth, realHeight, calculatedWidth, calculatedHeight) {\r\n        this._realWidth = realWidth;\r\n        this._realHeight = realHeight;\r\n        this._calculatedWidth = calculatedWidth;\r\n        this._calculatedHeight = calculatedHeight;\r\n        $array.each(this.layers, (layer) => {\r\n            if (layer) {\r\n                layer.dirty = true;\r\n                this.resizeLayer(layer);\r\n            }\r\n        });\r\n        this.resizeGhost();\r\n        this.view.style.width = calculatedWidth + \"px\";\r\n        this.view.style.height = calculatedHeight + \"px\";\r\n    }\r\n    createDetachedLayer(willReadFrequently = false) {\r\n        const view = document.createElement(\"canvas\");\r\n        const context = view.getContext(\"2d\", { willReadFrequently: willReadFrequently });\r\n        const layer = new CanvasLayer(view, context);\r\n        view.style.position = \"absolute\";\r\n        view.style.top = \"0px\";\r\n        view.style.left = \"0px\";\r\n        return layer;\r\n    }\r\n    getLayerByOrder(order) {\r\n        const layers = this.layers;\r\n        const length = layers.length;\r\n        for (let i = 0; i < length; i++) {\r\n            const layer = layers[i];\r\n            if (layer.order == order) {\r\n                return layer;\r\n            }\r\n        }\r\n    }\r\n    getLayer(order, visible = true) {\r\n        let existingLayer = this.getLayerByOrder(order);\r\n        if (existingLayer) {\r\n            return existingLayer;\r\n        }\r\n        const layer = this.createDetachedLayer(order == 99);\r\n        layer.order = order;\r\n        layer.visible = visible;\r\n        layer.view.className = \"am5-layer-\" + order;\r\n        if (layer.visible) {\r\n            this.resizeLayer(layer);\r\n        }\r\n        const layers = this.layers;\r\n        layers.push(layer);\r\n        layers.sort((a, b) => {\r\n            if (a.order > b.order) {\r\n                return 1;\r\n            }\r\n            else if (a.order < b.order) {\r\n                return -1;\r\n            }\r\n            else {\r\n                return 0;\r\n            }\r\n        });\r\n        const length = layers.length;\r\n        const layerIndex = $array.indexOf(layers, layer);\r\n        let next;\r\n        for (let i = layerIndex + 1; i < length; i++) {\r\n            if (layers[i].visible) {\r\n                next = layers[i];\r\n                break;\r\n            }\r\n        }\r\n        if (layer.visible) {\r\n            if (next === undefined) {\r\n                this._layerDom.appendChild(layer.view);\r\n            }\r\n            else {\r\n                this._layerDom.insertBefore(layer.view, next.view);\r\n            }\r\n        }\r\n        return layer;\r\n    }\r\n    render(root) {\r\n        this._dirtyLayers.length = 0;\r\n        this._deferredGhostLayers = [];\r\n        $array.each(this.layers, (layer) => {\r\n            if (layer) {\r\n                if (layer.dirty && layer.visible) {\r\n                    this._dirtyLayers.push(layer);\r\n                    layer.clear();\r\n                }\r\n            }\r\n        });\r\n        this._ghostLayer.clear();\r\n        root.render({\r\n            inactive: null,\r\n            layer: this.defaultLayer,\r\n        });\r\n        const deferredGhostLayers = this._deferredGhostLayers;\r\n        if (deferredGhostLayers.length) {\r\n            deferredGhostLayers.sort((a, b) => a - b);\r\n            $array.each(deferredGhostLayers, (layerx) => {\r\n                root.render({\r\n                    inactive: null,\r\n                    layer: this.defaultLayer\r\n                }, layerx);\r\n            });\r\n        }\r\n        this._ghostLayer.context.restore();\r\n        //setTimeout(() => {\r\n        // Remove this after the Chrome bug is fixed:\r\n        // https://bugs.chromium.org/p/chromium/issues/detail?id=1279394\r\n        $array.each(this.layers, (layer) => {\r\n            if (layer) {\r\n                const context = layer.context;\r\n                context.beginPath();\r\n                context.moveTo(0, 0);\r\n                context.stroke();\r\n            }\r\n        });\r\n        $array.each(this._dirtyLayers, (layer) => {\r\n            layer.context.restore();\r\n            layer.dirty = false;\r\n        });\r\n        //}, 100)\r\n        if (this._hovering.size && this._lastPointerMoveEvent) {\r\n            const { events, target, native } = this._lastPointerMoveEvent;\r\n            //this._mouseMoveThrottler.run();\r\n            $array.each(events, (event) => {\r\n                this._dispatchGlobalMousemove(event, target, native);\r\n            });\r\n        }\r\n    }\r\n    paintId(obj) {\r\n        const id = distributeId(++this._colorId);\r\n        const color = Color.fromHex(id).toCSS();\r\n        this._colorMap[color] = obj;\r\n        return color;\r\n    }\r\n    _removeObject(obj) {\r\n        if (obj._colorId !== undefined) {\r\n            delete this._colorMap[obj._colorId];\r\n        }\r\n    }\r\n    // protected _identifyObjectByColor(colorId: number): CanvasDisplayObject | undefined {\r\n    // \treturn this._colorMap[colorId];\r\n    // }\r\n    _adjustBoundingBox(bbox) {\r\n        const margin = this._ghostLayer.margin;\r\n        return new DOMRect(-margin.left, -margin.top, bbox.width + margin.left + margin.right, bbox.height + margin.top + margin.bottom);\r\n    }\r\n    getEvent(originalEvent, adjustPoint = true) {\r\n        const bbox = this.view.getBoundingClientRect();\r\n        const x = originalEvent.clientX || 0;\r\n        const y = originalEvent.clientY || 0;\r\n        const widthScale = this._calculatedWidth / this._realWidth;\r\n        const heightScale = this._calculatedHeight / this._realHeight;\r\n        const originalPoint = {\r\n            x: x - bbox.left,\r\n            y: y - bbox.top,\r\n        };\r\n        const point = {\r\n            x: (x - (adjustPoint ? bbox.left : 0)) * widthScale,\r\n            y: (y - (adjustPoint ? bbox.top : 0)) * heightScale,\r\n        };\r\n        return new CanvasRendererEvent(originalEvent, originalPoint, point, this._adjustBoundingBox(bbox));\r\n    }\r\n    _getHitTarget(point, bbox, target) {\r\n        if (bbox.width === 0 || bbox.height === 0 || point.x < bbox.left || point.x > bbox.right || point.y < bbox.top || point.y > bbox.bottom) {\r\n            return;\r\n        }\r\n        if (!target || !this._layerDom.contains(target)) {\r\n            return;\r\n        }\r\n        const pixel = this._ghostLayer.getImageData(point, bbox);\r\n        if (pixel.data[0] === 0 && pixel.data[1] === 0 && pixel.data[2] === 0) {\r\n            return false;\r\n        }\r\n        const colorId = Color.fromRGB(pixel.data[0], pixel.data[1], pixel.data[2]).toCSS();\r\n        const hit = this._colorMap[colorId];\r\n        return hit;\r\n    }\r\n    getObjectAtPoint(point) {\r\n        const data = this._ghostLayer.getImageArray(point);\r\n        if (data[0] === 0 && data[1] === 0 && data[2] === 0) {\r\n            return undefined;\r\n        }\r\n        const colorId = Color.fromRGB(data[0], data[1], data[2]).toCSS();\r\n        const hit = this._colorMap[colorId];\r\n        return hit;\r\n    }\r\n    _withEvents(key, f) {\r\n        const events = this._events[key];\r\n        if (events !== undefined) {\r\n            events.dispatching = true;\r\n            try {\r\n                f(events);\r\n            }\r\n            finally {\r\n                events.dispatching = false;\r\n                if (events.cleanup) {\r\n                    events.cleanup = false;\r\n                    $array.keepIf(events.callbacks, (callback) => {\r\n                        return !callback.disposed;\r\n                    });\r\n                    if (events.callbacks.length === 0) {\r\n                        events.disposer.dispose();\r\n                        delete this._events[key];\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    _dispatchEventAll(key, event) {\r\n        if (!this.interactionsEnabled) {\r\n            return;\r\n        }\r\n        this._withEvents(key, (events) => {\r\n            $array.each(events.callbacks, (callback) => {\r\n                if (!callback.disposed) {\r\n                    callback.callback.call(callback.context, event);\r\n                }\r\n            });\r\n        });\r\n    }\r\n    _dispatchEvent(key, target, event) {\r\n        if (!this.interactionsEnabled) {\r\n            return false;\r\n        }\r\n        let dispatched = false;\r\n        this._withEvents(key, (events) => {\r\n            $array.each(events.callbacks, (callback) => {\r\n                if (!callback.disposed && callback.object === target) {\r\n                    callback.callback.call(callback.context, event);\r\n                    dispatched = true;\r\n                }\r\n            });\r\n        });\r\n        return dispatched;\r\n    }\r\n    _dispatchMousedown(originalEvent, originalTarget) {\r\n        const button = originalEvent.button;\r\n        if (button != 0 && button != 2 && button != 1 && button !== undefined) {\r\n            // Ignore non-primary mouse buttons\r\n            return;\r\n        }\r\n        const event = this.getEvent(originalEvent);\r\n        const target = this._getHitTarget(event.originalPoint, event.bbox, originalTarget);\r\n        if (target) {\r\n            const id = event.id;\r\n            let dragged = false;\r\n            eachTargets(target, (obj) => {\r\n                const info = { id: id, value: obj };\r\n                this._mousedown.push(info);\r\n                if (!dragged && this._dispatchEvent(\"pointerdown\", obj, event)) {\r\n                    // Only dispatch the first element which matches\r\n                    dragged = true;\r\n                    const has = this._dragging.some((x) => {\r\n                        return x.value === obj && x.id === id;\r\n                    });\r\n                    if (!has) {\r\n                        this._dragging.push(info);\r\n                    }\r\n                }\r\n                return true;\r\n            });\r\n        }\r\n    }\r\n    _dispatchGlobalMousemove(originalEvent, originalTarget, native) {\r\n        const event = this.getEvent(originalEvent);\r\n        const target = this._getHitTarget(event.originalPoint, event.bbox, originalTarget);\r\n        event.native = native;\r\n        if (target) {\r\n            this._hovering.forEach((obj) => {\r\n                if (!obj.contains(target)) {\r\n                    this._hovering.delete(obj);\r\n                    if (obj.cursorOverStyle) {\r\n                        $utils.setStyle(document.body, \"cursor\", obj._replacedCursorStyle);\r\n                    }\r\n                    this._dispatchEvent(\"pointerout\", obj, event);\r\n                }\r\n            });\r\n            if (event.native) {\r\n                eachTargets(target, (obj) => {\r\n                    if (!this._hovering.has(obj)) {\r\n                        this._hovering.add(obj);\r\n                        if (obj.cursorOverStyle) {\r\n                            obj._replacedCursorStyle = $utils.getStyle(document.body, \"cursor\");\r\n                            $utils.setStyle(document.body, \"cursor\", obj.cursorOverStyle);\r\n                        }\r\n                        this._dispatchEvent(\"pointerover\", obj, event);\r\n                    }\r\n                    return true;\r\n                });\r\n            }\r\n            //} else if (target === false) {\r\n        }\r\n        else {\r\n            this._hovering.forEach((obj) => {\r\n                if (obj.cursorOverStyle) {\r\n                    $utils.setStyle(document.body, \"cursor\", obj._replacedCursorStyle);\r\n                }\r\n                this._dispatchEvent(\"pointerout\", obj, event);\r\n            });\r\n            this._hovering.clear();\r\n        }\r\n        this._dispatchEventAll(\"globalpointermove\", event);\r\n    }\r\n    removeHovering(graphics) {\r\n        this._hovering.delete(graphics);\r\n        if (graphics.cursorOverStyle) {\r\n            $utils.setStyle(document.body, \"cursor\", graphics._replacedCursorStyle);\r\n        }\r\n    }\r\n    _dispatchGlobalMouseup(originalEvent, native) {\r\n        const event = this.getEvent(originalEvent);\r\n        event.native = native;\r\n        //const target = this._getHitTarget(event.originalPoint);\r\n        this._dispatchEventAll(\"globalpointerup\", event);\r\n    }\r\n    _dispatchDragMove(originalEvent) {\r\n        if (this._dragging.length !== 0) {\r\n            const event = this.getEvent(originalEvent);\r\n            const id = event.id;\r\n            this._dragging.forEach((obj) => {\r\n                if (obj.id === id) {\r\n                    this._dispatchEvent(\"pointermove\", obj.value, event);\r\n                }\r\n            });\r\n        }\r\n    }\r\n    _dispatchDragEnd(originalEvent, originalTarget) {\r\n        const button = originalEvent.button;\r\n        let clickevent;\r\n        if (button == 0 || button === undefined) {\r\n            clickevent = \"click\";\r\n        }\r\n        else if (button == 2) {\r\n            clickevent = \"rightclick\";\r\n        }\r\n        else if (button == 1) {\r\n            clickevent = \"middleclick\";\r\n        }\r\n        else {\r\n            // Ignore non-primary mouse buttons\r\n            return;\r\n        }\r\n        const event = this.getEvent(originalEvent);\r\n        const id = event.id;\r\n        if (this._mousedown.length !== 0) {\r\n            const target = this._getHitTarget(event.originalPoint, event.bbox, originalTarget);\r\n            if (target) {\r\n                this._mousedown.forEach((obj) => {\r\n                    if (obj.id === id && obj.value.contains(target)) {\r\n                        this._dispatchEvent(clickevent, obj.value, event);\r\n                    }\r\n                });\r\n            }\r\n            this._mousedown.length = 0;\r\n        }\r\n        if (this._dragging.length !== 0) {\r\n            this._dragging.forEach((obj) => {\r\n                if (obj.id === id) {\r\n                    this._dispatchEvent(\"pointerup\", obj.value, event);\r\n                }\r\n            });\r\n            this._dragging.length = 0;\r\n        }\r\n    }\r\n    _dispatchDoubleClick(originalEvent, originalTarget) {\r\n        const event = this.getEvent(originalEvent);\r\n        const target = this._getHitTarget(event.originalPoint, event.bbox, originalTarget);\r\n        if (target) {\r\n            eachTargets(target, (obj) => {\r\n                if (this._dispatchEvent(\"dblclick\", obj, event)) {\r\n                    return false;\r\n                }\r\n                else {\r\n                    return true;\r\n                }\r\n            });\r\n        }\r\n    }\r\n    _dispatchWheel(originalEvent, originalTarget) {\r\n        const event = this.getEvent(originalEvent);\r\n        const target = this._getHitTarget(event.originalPoint, event.bbox, originalTarget);\r\n        if (target) {\r\n            eachTargets(target, (obj) => {\r\n                if (this._dispatchEvent(\"wheel\", obj, event)) {\r\n                    return false;\r\n                }\r\n                else {\r\n                    return true;\r\n                }\r\n            });\r\n        }\r\n    }\r\n    _makeSharedEvent(key, f) {\r\n        if (this._listeners[key] === undefined) {\r\n            const listener = f();\r\n            this._listeners[key] = new CounterDisposer(() => {\r\n                delete this._listeners[key];\r\n                listener.dispose();\r\n            });\r\n        }\r\n        return this._listeners[key].increment();\r\n    }\r\n    _onPointerEvent(name, f) {\r\n        let native = false;\r\n        let timer = null;\r\n        function clear() {\r\n            timer = null;\r\n            native = false;\r\n        }\r\n        return new MultiDisposer([\r\n            new Disposer(() => {\r\n                if (timer !== null) {\r\n                    clearTimeout(timer);\r\n                }\r\n                clear();\r\n            }),\r\n            $utils.addEventListener(this.view, $utils.getRendererEvent(name), (_) => {\r\n                native = true;\r\n                if (timer !== null) {\r\n                    clearTimeout(timer);\r\n                }\r\n                timer = window.setTimeout(clear, 0);\r\n            }),\r\n            onPointerEvent(window, name, (ev, target) => {\r\n                if (timer !== null) {\r\n                    clearTimeout(timer);\r\n                    timer = null;\r\n                }\r\n                f(ev, target, native);\r\n                native = false;\r\n            }),\r\n        ]);\r\n    }\r\n    // This ensures that only a single DOM event is added (e.g. only a single mousemove event listener)\r\n    _initEvent(key) {\r\n        switch (key) {\r\n            case \"globalpointermove\":\r\n            case \"pointerover\":\r\n            case \"pointerout\":\r\n                return this._makeSharedEvent(\"pointermove\", () => {\r\n                    const listener = (events, target, native) => {\r\n                        this._lastPointerMoveEvent = { events, target, native };\r\n                        $array.each(events, (event) => {\r\n                            this._dispatchGlobalMousemove(event, target, native);\r\n                        });\r\n                    };\r\n                    return new MultiDisposer([\r\n                        this._onPointerEvent(\"pointerdown\", listener),\r\n                        this._onPointerEvent(\"pointermove\", listener),\r\n                    ]);\r\n                });\r\n            case \"globalpointerup\":\r\n                return this._makeSharedEvent(\"pointerup\", () => {\r\n                    const mouseup = this._onPointerEvent(\"pointerup\", (events, target, native) => {\r\n                        $array.each(events, (event) => {\r\n                            this._dispatchGlobalMouseup(event, native);\r\n                        });\r\n                        this._lastPointerMoveEvent = { events, target, native };\r\n                    });\r\n                    const pointercancel = this._onPointerEvent(\"pointercancel\", (events, target, native) => {\r\n                        $array.each(events, (event) => {\r\n                            this._dispatchGlobalMouseup(event, native);\r\n                        });\r\n                        this._lastPointerMoveEvent = { events, target, native };\r\n                    });\r\n                    return new Disposer(() => {\r\n                        mouseup.dispose();\r\n                        pointercancel.dispose();\r\n                    });\r\n                });\r\n            case \"click\":\r\n            case \"rightclick\":\r\n            case \"middleclick\":\r\n            case \"pointerdown\":\r\n            /*\r\n                return this._makeSharedEvent(\"pointerdown\", () => {\r\n                    return this._onPointerEvent(\"pointerdown\", (event, target, native) => {\r\n                        this._lastPointerMoveEvent = { event, target, native };\r\n                        this._dispatchMousedown(event)\r\n                    });\r\n                });\r\n            */\r\n            case \"pointermove\":\r\n            case \"pointerup\":\r\n                return this._makeSharedEvent(\"pointerdown\", () => {\r\n                    //const throttler = new Throttler();\r\n                    const mousedown = this._onPointerEvent(\"pointerdown\", (events, target) => {\r\n                        $array.each(events, (ev) => {\r\n                            this._dispatchMousedown(ev, target);\r\n                        });\r\n                    });\r\n                    // TODO handle throttling properly for multitouch\r\n                    const mousemove = this._onPointerEvent(\"pointermove\", (ev) => {\r\n                        //throttler.throttle(() => {\r\n                        $array.each(ev, (ev) => {\r\n                            this._dispatchDragMove(ev);\r\n                        });\r\n                        //});\r\n                    });\r\n                    const mouseup = this._onPointerEvent(\"pointerup\", (ev, target) => {\r\n                        $array.each(ev, (ev) => {\r\n                            this._dispatchDragEnd(ev, target);\r\n                        });\r\n                    });\r\n                    const pointercancel = this._onPointerEvent(\"pointercancel\", (ev, target) => {\r\n                        $array.each(ev, (ev) => {\r\n                            this._dispatchDragEnd(ev, target);\r\n                        });\r\n                    });\r\n                    return new Disposer(() => {\r\n                        mousedown.dispose();\r\n                        mousemove.dispose();\r\n                        mouseup.dispose();\r\n                        pointercancel.dispose();\r\n                    });\r\n                });\r\n            case \"dblclick\":\r\n                return this._makeSharedEvent(\"dblclick\", () => {\r\n                    return this._onPointerEvent(\"dblclick\", (ev, target) => {\r\n                        $array.each(ev, (ev) => {\r\n                            this._dispatchDoubleClick(ev, target);\r\n                        });\r\n                    });\r\n                });\r\n            case \"wheel\":\r\n                return this._makeSharedEvent(\"wheel\", () => {\r\n                    return $utils.addEventListener(this.view, $utils.getRendererEvent(\"wheel\"), (event) => {\r\n                        this._dispatchWheel(event, $utils.getEventTarget(event));\r\n                    }, { passive: false });\r\n                });\r\n        }\r\n    }\r\n    _addEvent(object, key, callback, context) {\r\n        let events = this._events[key];\r\n        if (events === undefined) {\r\n            events = this._events[key] = {\r\n                disposer: this._initEvent(key),\r\n                callbacks: [],\r\n                dispatching: false,\r\n                cleanup: false,\r\n            };\r\n        }\r\n        const listener = { object, context, callback, disposed: false };\r\n        events.callbacks.push(listener);\r\n        return new Disposer(() => {\r\n            listener.disposed = true;\r\n            if (events.dispatching) {\r\n                events.cleanup = true;\r\n            }\r\n            else {\r\n                $array.removeFirst(events.callbacks, listener);\r\n                if (events.callbacks.length === 0) {\r\n                    events.disposer.dispose();\r\n                    delete this._events[key];\r\n                }\r\n            }\r\n        });\r\n    }\r\n    getCanvas(root, options) {\r\n        // Make sure everything is rendered\r\n        this.render(root);\r\n        if (!options) {\r\n            options = {};\r\n        }\r\n        let scale = this.resolution;\r\n        let canvasWidth = Math.floor(this._calculatedWidth * this.resolution);\r\n        let canvasHeight = Math.floor(this._calculatedHeight * this.resolution);\r\n        // Check if we need to scale\r\n        if (options.minWidth && (options.minWidth > canvasWidth)) {\r\n            let minScale = options.minWidth / canvasWidth;\r\n            if (minScale > scale) {\r\n                scale = minScale * this.resolution;\r\n            }\r\n        }\r\n        if (options.minHeight && (options.minHeight > canvasHeight)) {\r\n            let minScale = options.minHeight / canvasHeight;\r\n            if (minScale > scale) {\r\n                scale = minScale * this.resolution;\r\n            }\r\n        }\r\n        if (options.maxWidth && (options.maxWidth < canvasWidth)) {\r\n            let maxScale = options.maxWidth / canvasWidth;\r\n            if (maxScale < scale) {\r\n                scale = maxScale * this.resolution;\r\n            }\r\n        }\r\n        if (options.maxHeight && (options.maxHeight > canvasHeight)) {\r\n            let maxScale = options.maxHeight / canvasHeight;\r\n            if (maxScale < scale) {\r\n                scale = maxScale * this.resolution;\r\n            }\r\n        }\r\n        // Check if we need to compensate for pixel ratio\r\n        if (options.maintainPixelRatio) {\r\n            scale /= this.resolution;\r\n        }\r\n        // Init list canvases to remove from DOM after export\r\n        const canvases = [];\r\n        // Set up new canvas for export\r\n        let forceRender = false;\r\n        const canvas = document.createElement(\"canvas\");\r\n        if (scale != this.resolution) {\r\n            forceRender = true;\r\n            canvasWidth = canvasWidth * scale / this.resolution;\r\n            canvasHeight = canvasHeight * scale / this.resolution;\r\n        }\r\n        canvas.width = canvasWidth;\r\n        canvas.height = canvasHeight;\r\n        // Add to DOM so it inherits CSS\r\n        canvas.style.position = \"fixed\";\r\n        canvas.style.top = \"-10000px\";\r\n        this.view.appendChild(canvas);\r\n        canvases.push(canvas);\r\n        // Context\r\n        const context = canvas.getContext(\"2d\");\r\n        let width = 0;\r\n        let height = 0;\r\n        let needRerender = false;\r\n        $array.each(this.layers, (layer) => {\r\n            if (layer && layer.visible) {\r\n                if (layer.tainted || forceRender) {\r\n                    needRerender = true;\r\n                    layer.exportableView = layer.view;\r\n                    layer.exportableContext = layer.context;\r\n                    layer.view = document.createElement(\"canvas\");\r\n                    // Add to DOM so it inherits CSS\r\n                    layer.view.style.position = \"fixed\";\r\n                    layer.view.style.top = \"-10000px\";\r\n                    this.view.appendChild(layer.view);\r\n                    canvases.push(layer.view);\r\n                    let extraX = 0;\r\n                    let extraY = 0;\r\n                    if (layer.margin) {\r\n                        extraX += layer.margin.left || 0 + layer.margin.right || 0;\r\n                        extraY += layer.margin.top || 0 + layer.margin.bottom || 0;\r\n                    }\r\n                    layer.view.width = canvasWidth + extraX;\r\n                    layer.view.height = canvasHeight + extraY;\r\n                    layer.context = layer.view.getContext(\"2d\");\r\n                    layer.dirty = true;\r\n                    layer.scale = scale;\r\n                }\r\n            }\r\n        });\r\n        if (needRerender) {\r\n            this._omitTainted = true;\r\n            this.render(root);\r\n            this._omitTainted = false;\r\n        }\r\n        $array.each(this.layers, (layer) => {\r\n            if (layer && layer.visible) {\r\n                // Layer is fine. Just plop it into our target canvas\r\n                let x = 0;\r\n                let y = 0;\r\n                if (layer.margin) {\r\n                    x = -(layer.margin.left || 0) * this.resolution;\r\n                    y = -(layer.margin.top || 0) * this.resolution;\r\n                }\r\n                context.drawImage(layer.view, x, y);\r\n                // Restore layer original canvas\r\n                if (layer.exportableView) {\r\n                    layer.view = layer.exportableView;\r\n                    layer.exportableView = undefined;\r\n                }\r\n                if (layer.exportableContext) {\r\n                    layer.context = layer.exportableContext;\r\n                    layer.exportableContext = undefined;\r\n                }\r\n                if (width < layer.view.clientWidth) {\r\n                    width = layer.view.clientWidth;\r\n                }\r\n                if (height < layer.view.clientHeight) {\r\n                    height = layer.view.clientHeight;\r\n                }\r\n                layer.scale = undefined;\r\n            }\r\n        });\r\n        canvas.style.width = width + \"px\";\r\n        canvas.style.height = height + \"px\";\r\n        $array.each(canvases, (canvas) => {\r\n            canvas.style.position = \"\";\r\n            canvas.style.top = \"\";\r\n            this.view.removeChild(canvas);\r\n        });\r\n        return canvas;\r\n    }\r\n}\r\nclass GhostLayer {\r\n    constructor() {\r\n        Object.defineProperty(this, \"view\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"context\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"margin\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: {\r\n                left: 0,\r\n                right: 0,\r\n                top: 0,\r\n                bottom: 0,\r\n            }\r\n        });\r\n        Object.defineProperty(this, \"_resolution\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: 1\r\n        });\r\n        Object.defineProperty(this, \"_width\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: 0\r\n        });\r\n        Object.defineProperty(this, \"_height\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: 0\r\n        });\r\n        Object.defineProperty(this, \"imageArray\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        this.view = document.createElement(\"canvas\");\r\n        this.context = this.view.getContext(\"2d\", { alpha: false, willReadFrequently: true });\r\n        this.context.imageSmoothingEnabled = false;\r\n        this.view.style.position = \"absolute\";\r\n        this.view.style.top = \"0px\";\r\n        this.view.style.left = \"0px\";\r\n    }\r\n    resize(canvasWidth, canvasHeight, domWidth, domHeight, resolution) {\r\n        this._resolution = resolution;\r\n        canvasWidth += (this.margin.left + this.margin.right);\r\n        canvasHeight += (this.margin.top + this.margin.bottom);\r\n        // TODO this should take into account calculateSize\r\n        domWidth += (this.margin.left + this.margin.right);\r\n        domHeight += (this.margin.top + this.margin.bottom);\r\n        this.view.style.left = -this.margin.left + \"px\";\r\n        this.view.style.top = -this.margin.top + \"px\";\r\n        this._width = Math.floor(canvasWidth * resolution);\r\n        this._height = Math.floor(canvasHeight * resolution);\r\n        this.view.width = this._width;\r\n        this.view.style.width = domWidth + \"px\";\r\n        this.view.height = this._height;\r\n        this.view.style.height = domHeight + \"px\";\r\n    }\r\n    getImageData(point, bbox) {\r\n        return this.context.getImageData(\r\n        // TODO should this round ?\r\n        Math.round(((point.x - bbox.left) / bbox.width) * this._width), Math.round(((point.y - bbox.top) / bbox.height) * this._height), 1, 1);\r\n    }\r\n    getImageArray(point) {\r\n        if (!this.imageArray) {\r\n            this.imageArray = this.context.getImageData(0, 0, this._width, this._height).data;\r\n        }\r\n        const data = this.imageArray;\r\n        const x = Math.round(point.x * this._resolution);\r\n        const y = Math.round(point.y * this._resolution);\r\n        const i = (y * this._width + x) * 4;\r\n        return [data[i], data[i + 1], data[i + 2], data[i + 3]];\r\n    }\r\n    setMargin(layers) {\r\n        this.margin.left = 0;\r\n        this.margin.right = 0;\r\n        this.margin.top = 0;\r\n        this.margin.bottom = 0;\r\n        $array.each(layers, (layer) => {\r\n            if (layer.margin) {\r\n                this.margin.left = Math.max(this.margin.left, layer.margin.left);\r\n                this.margin.right = Math.max(this.margin.right, layer.margin.right);\r\n                this.margin.top = Math.max(this.margin.top, layer.margin.top);\r\n                this.margin.bottom = Math.max(this.margin.bottom, layer.margin.bottom);\r\n            }\r\n        });\r\n    }\r\n    clear() {\r\n        this.context.save();\r\n        this.context.fillStyle = '#000';\r\n        this.context.fillRect(0, 0, this._width, this._height);\r\n    }\r\n}\r\n/**\r\n * @ignore\r\n */\r\nexport class CanvasLayer {\r\n    constructor(view, context) {\r\n        Object.defineProperty(this, \"view\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"context\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"tainted\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: true\r\n        });\r\n        Object.defineProperty(this, \"margin\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"order\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: 0\r\n        });\r\n        Object.defineProperty(this, \"visible\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: true\r\n        });\r\n        Object.defineProperty(this, \"width\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"height\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"scale\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"dirty\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: true\r\n        });\r\n        Object.defineProperty(this, \"exportableView\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"exportableContext\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"_width\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: 0\r\n        });\r\n        Object.defineProperty(this, \"_height\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: 0\r\n        });\r\n        this.view = view;\r\n        this.context = context;\r\n    }\r\n    resize(canvasWidth, canvasHeight, domWidth, domHeight, resolution) {\r\n        // TODO should this take into account calculateSize ?\r\n        if (this.width != null) {\r\n            canvasWidth = this.width;\r\n            domWidth = this.width;\r\n        }\r\n        // TODO should this take into account calculateSize ?\r\n        if (this.height != null) {\r\n            canvasHeight = this.height;\r\n            domHeight = this.height;\r\n        }\r\n        if (this.margin) {\r\n            canvasWidth += (this.margin.left + this.margin.right);\r\n            canvasHeight += (this.margin.top + this.margin.bottom);\r\n            // TODO this should take into account calculateSize\r\n            domWidth += (this.margin.left + this.margin.right);\r\n            domHeight += (this.margin.top + this.margin.bottom);\r\n            this.view.style.left = -this.margin.left + \"px\";\r\n            this.view.style.top = -this.margin.top + \"px\";\r\n        }\r\n        else {\r\n            this.view.style.left = \"0px\";\r\n            this.view.style.top = \"0px\";\r\n        }\r\n        this._width = Math.floor(canvasWidth * resolution);\r\n        this._height = Math.floor(canvasHeight * resolution);\r\n        this.view.width = this._width;\r\n        this.view.style.width = domWidth + \"px\";\r\n        this.view.height = this._height;\r\n        this.view.style.height = domHeight + \"px\";\r\n    }\r\n    clear() {\r\n        this.context.save();\r\n        this.context.clearRect(0, 0, this._width, this._height);\r\n    }\r\n}\r\n//# sourceMappingURL=CanvasRenderer.js.map","import { AnimationState } from \"./util/Animation\";\r\nimport { Container } from \"./render/Container\";\r\nimport { Text } from \"./render/Text\";\r\nimport { HorizontalLayout } from \"./render/HorizontalLayout\";\r\nimport { VerticalLayout } from \"./render/VerticalLayout\";\r\nimport { GridLayout } from \"./render/GridLayout\";\r\nimport { Disposer } from \"./util/Disposer\";\r\nimport { ResizeSensor } from \"./util/ResizeSensor\";\r\nimport { InterfaceColors } from \"./util/InterfaceColors\";\r\nimport { Graphics } from \"./render/Graphics\";\r\nimport { Rectangle } from \"./render/Rectangle\";\r\nimport { Tooltip } from \"./render/Tooltip\";\r\nimport { NumberFormatter } from \"./util/NumberFormatter\";\r\nimport { DateFormatter } from \"./util/DateFormatter\";\r\nimport { DurationFormatter } from \"./util/DurationFormatter\";\r\nimport { Language } from \"./util/Language\";\r\nimport { EventDispatcher } from \"./util/EventDispatcher\";\r\nimport { DefaultTheme } from \"../themes/DefaultTheme\";\r\nimport { CanvasRenderer } from \"./render/backend/CanvasRenderer\";\r\nimport { p100, percent, isPercent, Percent } from \"./util/Percent\";\r\nimport { color } from \"./util/Color\";\r\nimport { populateString } from \"./util/PopulateString\";\r\nimport { registry } from \"./Registry\";\r\nimport * as $order from \"./util/Order\";\r\nimport * as $array from \"./util/Array\";\r\nimport * as $object from \"./util/Object\";\r\nimport * as $utils from \"./util/Utils\";\r\nimport * as $type from \"./util/Type\";\r\nimport en from \"../../locales/en\";\r\nfunction rAF(fps, callback) {\r\n    if (fps == null) {\r\n        requestAnimationFrame(callback);\r\n    }\r\n    else {\r\n        setTimeout(() => {\r\n            requestAnimationFrame(callback);\r\n        }, 1000 / fps);\r\n    }\r\n}\r\n// TODO implement Disposer\r\n/**\r\n * Root element of the chart.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/getting-started/#Root_element} for more info\r\n */\r\nexport class Root {\r\n    constructor(id, settings = {}, isReal) {\r\n        /**\r\n         * A reference to original chart container (div element).\r\n         */\r\n        Object.defineProperty(this, \"dom\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"_inner\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"_settings\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"_isDirty\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: false\r\n        });\r\n        Object.defineProperty(this, \"_isDirtyParents\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: false\r\n        });\r\n        Object.defineProperty(this, \"_isDirtyAnimation\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: false\r\n        });\r\n        Object.defineProperty(this, \"_dirty\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: {}\r\n        });\r\n        Object.defineProperty(this, \"_dirtyParents\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: {}\r\n        });\r\n        Object.defineProperty(this, \"_dirtyBounds\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: {}\r\n        });\r\n        Object.defineProperty(this, \"_dirtyPositions\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: {}\r\n        });\r\n        Object.defineProperty(this, \"_ticker\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: null\r\n        });\r\n        Object.defineProperty(this, \"_tickers\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: []\r\n        });\r\n        Object.defineProperty(this, \"_updateTick\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: true\r\n        });\r\n        /**\r\n         * Root's event dispatcher.\r\n         *\r\n         * @see {@link https://www.amcharts.com/docs/v5/concepts/events/} for more info\r\n         */\r\n        Object.defineProperty(this, \"events\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: new EventDispatcher()\r\n        });\r\n        /**\r\n         * @ignore\r\n         * @todo needs description\r\n         */\r\n        Object.defineProperty(this, \"animationTime\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: null\r\n        });\r\n        Object.defineProperty(this, \"_animations\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: []\r\n        });\r\n        Object.defineProperty(this, \"_renderer\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"_rootContainer\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        /**\r\n         * Main content container.\r\n         */\r\n        Object.defineProperty(this, \"container\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        /**\r\n         * A [[Container]] used to display tooltips in.\r\n         */\r\n        Object.defineProperty(this, \"tooltipContainer\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"_tooltipContainerSettings\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"_tooltip\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        // Locale-related\r\n        /**\r\n         * @ignore\r\n         */\r\n        Object.defineProperty(this, \"language\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: Language.new(this, {})\r\n        });\r\n        /**\r\n         * Locale used by the chart.\r\n         *\r\n         * @see {@link https://www.amcharts.com/docs/v5/concepts/locales/}\r\n         */\r\n        Object.defineProperty(this, \"locale\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: en\r\n        });\r\n        // Date-time related\r\n        /**\r\n         * Use UTC when formatting date/time.\r\n         *\r\n         * @see {@link https://www.amcharts.com/docs/v5/concepts/formatters/formatting-dates/#utc-and-time-zones} for more info\r\n         */\r\n        Object.defineProperty(this, \"utc\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: false\r\n        });\r\n        /**\r\n         * If set, will format date/time in specific time zone.\r\n         *\r\n         * The value should be named time zone, e.g.:\r\n         * `\"America/Vancouver\"`, `\"Australia/Sydney\"`, `\"UTC\"`.\r\n         *\r\n         * NOTE: Using time zone feature may noticeable affect performance of the\r\n         * chart, especially with large data sets, since every single date will need\r\n         * to be recalculated.\r\n         *\r\n         * @see {@link https://www.amcharts.com/docs/v5/getting-started/root-element/#time-zone} for more info\r\n         * @since 5.1.0\r\n         */\r\n        Object.defineProperty(this, \"timezone\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        /**\r\n         * The maximum FPS that the Root will run at.\r\n         *\r\n         * If `undefined` it will run at the highest FPS.\r\n         *\r\n         * @see {@link https://www.amcharts.com/docs/v5/getting-started/root-element/#Performance} for more info\r\n         */\r\n        Object.defineProperty(this, \"fps\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        /**\r\n         * Number formatter.\r\n         *\r\n         * @see {@link https://www.amcharts.com/docs/v5/concepts/formatters/formatting-numbers/} for more info\r\n         */\r\n        Object.defineProperty(this, \"numberFormatter\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: NumberFormatter.new(this, {})\r\n        });\r\n        /**\r\n         * Date/time formatter.\r\n         *\r\n         * @see {@link https://www.amcharts.com/docs/v5/concepts/formatters/formatting-dates/} for more info\r\n         */\r\n        Object.defineProperty(this, \"dateFormatter\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: DateFormatter.new(this, {})\r\n        });\r\n        /**\r\n         * Duration formatter.\r\n         *\r\n         * @see {@link https://www.amcharts.com/docs/v5/concepts/formatters/formatting-dates/} for more info\r\n         */\r\n        Object.defineProperty(this, \"durationFormatter\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: DurationFormatter.new(this, {})\r\n        });\r\n        // Accessibility\r\n        /**\r\n         * Global tab index for using for the whole chart\r\n         *\r\n         * @see {@link https://www.amcharts.com/docs/v5/concepts/accessibility/} for more info\r\n         */\r\n        Object.defineProperty(this, \"tabindex\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: 0\r\n        });\r\n        //@todo maybe make this better\r\n        Object.defineProperty(this, \"_tabindexes\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: []\r\n        });\r\n        Object.defineProperty(this, \"_a11yD\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: false\r\n        });\r\n        Object.defineProperty(this, \"_focusElementDirty\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: false\r\n        });\r\n        Object.defineProperty(this, \"_focusElementContainer\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"_focusedSprite\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"_isShift\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"_keyboardDragPoint\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"_tooltipElementContainer\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"_readerAlertElement\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"_skipNextGroupJump\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: true\r\n        });\r\n        Object.defineProperty(this, \"_logo\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"_tooltipDiv\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        /**\r\n         * Used for dynamically-created CSS and JavaScript with strict source policies.\r\n         */\r\n        Object.defineProperty(this, \"nonce\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        /**\r\n         * Special color set to be used for various controls.\r\n         *\r\n         * @see {@link https://www.amcharts.com/docs/v5/concepts/colors-gradients-and-patterns/#Interface_colors} for more info\r\n         */\r\n        Object.defineProperty(this, \"interfaceColors\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        /**\r\n         * An instance of vertical layout object that can be used to set `layout` setting\r\n         * of a [[Container]].\r\n         *\r\n         * @default VerticalLayout.new()\r\n         */\r\n        Object.defineProperty(this, \"verticalLayout\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: VerticalLayout.new(this, {})\r\n        });\r\n        /**\r\n         * An instance of horizontal layout object that can be used to set `layout` setting\r\n         * of a [[Container]].\r\n         *\r\n         * @default HorizontalLayout.new()\r\n         */\r\n        Object.defineProperty(this, \"horizontalLayout\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: HorizontalLayout.new(this, {})\r\n        });\r\n        /**\r\n         * An instance of grid layout object that can be used to set `layout` setting\r\n         * of a [[Container]].\r\n         *\r\n         * @default VerticalLayout.new()\r\n         */\r\n        Object.defineProperty(this, \"gridLayout\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: GridLayout.new(this, {})\r\n        });\r\n        Object.defineProperty(this, \"_paused\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: false\r\n        });\r\n        /**\r\n         * Indicates whether chart should resized automatically when parent container\r\n         * width and/or height changes.\r\n         *\r\n         * If disabled (`autoResize = false`) you can make the chart resize manually\r\n         * by calling root element's `resize()` method.\r\n         */\r\n        Object.defineProperty(this, \"autoResize\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: true\r\n        });\r\n        Object.defineProperty(this, \"_fontHash\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: \"\"\r\n        });\r\n        Object.defineProperty(this, \"_isDisposed\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: false\r\n        });\r\n        Object.defineProperty(this, \"_disposers\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: []\r\n        });\r\n        Object.defineProperty(this, \"_resizeSensorDisposer\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"_tooltips\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: []\r\n        });\r\n        Object.defineProperty(this, \"_htmlElementContainer\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        Object.defineProperty(this, \"_htmlEnabledContainers\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: []\r\n        });\r\n        /**\r\n         * Entities that have their `id` setting set.\r\n         *\r\n         * @since 5.11.0\r\n         */\r\n        Object.defineProperty(this, \"entitiesById\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: {}\r\n        });\r\n        Object.defineProperty(this, \"_systemTooltip\", {\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true,\r\n            value: void 0\r\n        });\r\n        if (!isReal) {\r\n            throw new Error(\"You cannot use `new Class()`, instead use `Class.new()`\");\r\n        }\r\n        this._settings = settings;\r\n        if (settings.accessible == false) {\r\n            this._a11yD = true;\r\n        }\r\n        if (settings.useSafeResolution == null) {\r\n            settings.useSafeResolution = true;\r\n        }\r\n        let resolution;\r\n        if (settings.useSafeResolution) {\r\n            resolution = $utils.getSafeResolution();\r\n        }\r\n        this._renderer = new CanvasRenderer(resolution);\r\n        let dom;\r\n        if (id instanceof HTMLElement) {\r\n            dom = id;\r\n        }\r\n        else {\r\n            dom = document.getElementById(id);\r\n        }\r\n        $array.each(registry.rootElements, (root) => {\r\n            if (root.dom === dom) {\r\n                if (registry.autoDispose) {\r\n                    root.dispose();\r\n                }\r\n                else {\r\n                    throw new Error(\"You cannot have multiple Roots on the same DOM node\");\r\n                }\r\n            }\r\n        });\r\n        this.interfaceColors = InterfaceColors.new(this, {});\r\n        if (dom === null) {\r\n            throw new Error(\"Could not find HTML element with id `\" + id + \"`\");\r\n        }\r\n        this.dom = dom;\r\n        let inner = document.createElement(\"div\");\r\n        inner.style.position = \"relative\";\r\n        inner.style.width = \"100%\";\r\n        inner.style.height = \"100%\";\r\n        dom.appendChild(inner);\r\n        const tooltipContainerBounds = settings.tooltipContainerBounds;\r\n        if (tooltipContainerBounds) {\r\n            this._tooltipContainerSettings = tooltipContainerBounds;\r\n        }\r\n        this._inner = inner;\r\n        this._updateComputedStyles();\r\n        registry.rootElements.push(this);\r\n    }\r\n    static new(id, settings) {\r\n        const root = new Root(id, settings, true);\r\n        root._init();\r\n        return root;\r\n    }\r\n    moveDOM(id) {\r\n        let dom;\r\n        if (id instanceof HTMLElement) {\r\n            dom = id;\r\n        }\r\n        else {\r\n            dom = document.getElementById(id);\r\n        }\r\n        if (dom) {\r\n            while (this.dom.childNodes.length > 0) {\r\n                dom.appendChild(this.dom.childNodes[0]);\r\n            }\r\n            this.dom = dom;\r\n            this._initResizeSensor();\r\n            this.resize();\r\n        }\r\n    }\r\n    _handleLogo() {\r\n        if (this._logo) {\r\n            const w = this.dom.offsetWidth;\r\n            const h = this.dom.offsetHeight;\r\n            if ((w <= 150) || (h <= 60)) {\r\n                this._logo.hide();\r\n            }\r\n            else {\r\n                this._logo.show();\r\n            }\r\n        }\r\n    }\r\n    _showBranding() {\r\n        if (!this._logo) {\r\n            const logo = this.tooltipContainer.children.push(Container.new(this, {\r\n                interactive: true,\r\n                interactiveChildren: false,\r\n                position: \"absolute\",\r\n                setStateOnChildren: true,\r\n                paddingTop: 9,\r\n                paddingRight: 9,\r\n                paddingBottom: 9,\r\n                paddingLeft: 9,\r\n                scale: .6,\r\n                y: percent(100),\r\n                centerY: p100,\r\n                tooltipY: 10,\r\n                tooltipText: \"Created using amCharts 5\",\r\n                tooltipX: p100,\r\n                cursorOverStyle: \"pointer\",\r\n                background: Rectangle.new(this, {\r\n                    fill: color(0x474758),\r\n                    fillOpacity: 0,\r\n                    tooltipY: 5\r\n                })\r\n            }));\r\n            logo.set(\"tooltip\", this.systemTooltip);\r\n            logo.events.on(\"click\", () => {\r\n                window.open(\"https://www.amcharts.com/\", \"_blank\");\r\n            });\r\n            logo.states.create(\"hover\", {});\r\n            const m = logo.children.push(Graphics.new(this, {\r\n                stroke: color(0xcccccc),\r\n                strokeWidth: 3,\r\n                svgPath: \"M5 25 L13 25h13.6c3.4 0 6 0 10.3-4.3s5.2-12 8.6-12c3.4 0 4.3 8.6 7.7 8.6M83.4 25H79.8c-3.4 0-6 0-10.3-4.3s-5.2-12-8.6-12-4.3 8.6-7.7 8.6\"\r\n            }));\r\n            m.states.create(\"hover\", { stroke: color(0x3CABFF) });\r\n            const a = logo.children.push(Graphics.new(this, {\r\n                stroke: color(0x888888),\r\n                strokeWidth: 3,\r\n                svgPath: \"M83.4 25h-31C37 25 39.5 4.4 28.4 4.4S18.9 24.2 4.3 25H0\"\r\n            }));\r\n            a.states.create(\"hover\", { stroke: color(0x474758) });\r\n            this._logo = logo;\r\n            this._handleLogo();\r\n        }\r\n    }\r\n    _getRealSize() {\r\n        return this.dom.getBoundingClientRect();\r\n    }\r\n    _getCalculatedSize(rect) {\r\n        if (this._settings.calculateSize) {\r\n            return this._settings.calculateSize(rect);\r\n        }\r\n        else {\r\n            return {\r\n                width: rect.width,\r\n                height: rect.height,\r\n            };\r\n        }\r\n    }\r\n    _init() {\r\n        const settings = this._settings;\r\n        if (settings.accessible !== false) {\r\n            if (settings.focusable) {\r\n                this._inner.setAttribute(\"focusable\", \"true\");\r\n                this._inner.setAttribute(\"tabindex\", this.tabindex + \"\");\r\n            }\r\n            if (settings.ariaLabel) {\r\n                this._inner.setAttribute(\"aria-label\", settings.ariaLabel);\r\n            }\r\n            if (settings.role) {\r\n                this._inner.setAttribute(\"role\", settings.role);\r\n            }\r\n        }\r\n        const renderer = this._renderer;\r\n        const rect = this._getRealSize();\r\n        const size = this._getCalculatedSize(rect);\r\n        const width = Math.floor(size.width);\r\n        const height = Math.floor(size.height);\r\n        const realWidth = Math.floor(rect.width);\r\n        const realHeight = Math.floor(rect.height);\r\n        const rootContainer = Container.new(this, {\r\n            visible: true,\r\n            width: width,\r\n            height: height,\r\n        });\r\n        this._rootContainer = rootContainer;\r\n        this._rootContainer._defaultThemes.push(DefaultTheme.new(this));\r\n        const container = rootContainer.children.push(Container.new(this, { visible: true, width: p100, height: p100 }));\r\n        this.container = container;\r\n        renderer.resize(realWidth, realHeight, width, height);\r\n        //@todo: better appendChild - refer\r\n        this._inner.appendChild(renderer.view);\r\n        // TODO: TMP TMP TMP for testing only, remove\r\n        //renderer.debugGhostView = true;\r\n        this._initResizeSensor();\r\n        // HTML content holder\r\n        const htmlElementContainer = document.createElement(\"div\");\r\n        this._htmlElementContainer = htmlElementContainer;\r\n        htmlElementContainer.className = \"am5-html-container\";\r\n        htmlElementContainer.style.position = \"absolute\";\r\n        htmlElementContainer.style.pointerEvents = \"none\";\r\n        if (!this._tooltipContainerSettings) {\r\n            htmlElementContainer.style.overflow = \"hidden\";\r\n        }\r\n        this._inner.appendChild(htmlElementContainer);\r\n        if (this._a11yD !== true) {\r\n            // Create element which is used to make announcements to screen reader\r\n            const readerAlertElement = document.createElement(\"div\");\r\n            readerAlertElement.className = \"am5-reader-container\";\r\n            readerAlertElement.setAttribute(\"role\", \"alert\");\r\n            // readerAlertElement.style.zIndex = \"-100000\";\r\n            // readerAlertElement.style.opacity = \"0\";\r\n            // readerAlertElement.style.top = \"0\";\r\n            readerAlertElement.style.position = \"absolute\";\r\n            readerAlertElement.style.width = \"1px\";\r\n            readerAlertElement.style.height = \"1px\";\r\n            readerAlertElement.style.overflow = \"hidden\";\r\n            readerAlertElement.style.clip = \"rect(1px, 1px, 1px, 1px)\";\r\n            this._readerAlertElement = readerAlertElement;\r\n            this._inner.appendChild(this._readerAlertElement);\r\n            const focusElementContainer = document.createElement(\"div\");\r\n            focusElementContainer.className = \"am5-focus-container\";\r\n            focusElementContainer.style.position = \"absolute\";\r\n            focusElementContainer.style.pointerEvents = \"none\";\r\n            focusElementContainer.style.top = \"0px\";\r\n            focusElementContainer.style.left = \"0px\";\r\n            focusElementContainer.style.overflow = \"hidden\";\r\n            focusElementContainer.style.width = width + \"px\";\r\n            focusElementContainer.style.height = height + \"px\";\r\n            focusElementContainer.setAttribute(\"role\", \"graphics-document\");\r\n            $utils.setInteractive(focusElementContainer, false);\r\n            this._focusElementContainer = focusElementContainer;\r\n            this._inner.appendChild(this._focusElementContainer);\r\n            const tooltipElementContainer = document.createElement(\"div\");\r\n            this._tooltipElementContainer = tooltipElementContainer;\r\n            tooltipElementContainer.className = \"am5-tooltip-container\";\r\n            this._inner.appendChild(tooltipElementContainer);\r\n            // Add keyboard events for accessibility, e.g. simulating drag with arrow\r\n            // keys and click with ENTER\r\n            if ($utils.supports(\"keyboardevents\")) {\r\n                this._disposers.push($utils.addEventListener(window, \"keydown\", (ev) => {\r\n                    const eventKey = $utils.getEventKey(ev);\r\n                    if (eventKey == \"Shift\") {\r\n                        this._isShift = true;\r\n                    }\r\n                    else if (eventKey == \"Tab\") {\r\n                        this._isShift = ev.shiftKey;\r\n                    }\r\n                }));\r\n                this._disposers.push($utils.addEventListener(window, \"keyup\", (ev) => {\r\n                    const eventKey = $utils.getEventKey(ev);\r\n                    if (eventKey == \"Shift\") {\r\n                        this._isShift = false;\r\n                    }\r\n                }));\r\n                this._disposers.push($utils.addEventListener(focusElementContainer, \"click\", () => {\r\n                    // Some screen readers convert ENTER (and some SPACE) press whil on\r\n                    // focused element to a \"click\" event, preventing actual \"keydown\"\r\n                    // event from firing. We're using this \"click\" event to still\r\n                    // generate internal click events.\r\n                    const focusedSprite = this._focusedSprite;\r\n                    if (focusedSprite) {\r\n                        const announceText = focusedSprite.get(\"clickAnnounceText\", \"\");\r\n                        if (announceText !== \"\") {\r\n                            this.readerAlert(announceText);\r\n                        }\r\n                        const downEvent = renderer.getEvent(new MouseEvent(\"click\"));\r\n                        focusedSprite.events.dispatch(\"click\", {\r\n                            type: \"click\",\r\n                            originalEvent: downEvent.event,\r\n                            point: downEvent.point,\r\n                            simulated: true,\r\n                            target: focusedSprite\r\n                        });\r\n                    }\r\n                }));\r\n                this._disposers.push($utils.addEventListener(focusElementContainer, \"keydown\", (ev) => {\r\n                    const focusedSprite = this._focusedSprite;\r\n                    if (focusedSprite) {\r\n                        if (ev.key == \"Escape\") {\r\n                            // ESC pressed - lose current focus\r\n                            $utils.blur();\r\n                            this._focusedSprite = undefined;\r\n                        }\r\n                        let dragOffsetX = 0;\r\n                        let dragOffsetY = 0;\r\n                        // TODO: figure out if using bogus MouseEvent is fine, or it will\r\n                        // fail on some platforms\r\n                        const eventKey = $utils.getEventKey(ev);\r\n                        switch (eventKey) {\r\n                            case \"Enter\":\r\n                            case \" \":\r\n                                const announceText = focusedSprite.get(\"clickAnnounceText\", \"\");\r\n                                if (announceText !== \"\") {\r\n                                    this.readerAlert(announceText);\r\n                                }\r\n                                if (eventKey == \" \" && focusedSprite.get(\"role\") != \"checkbox\") {\r\n                                    return;\r\n                                }\r\n                                ev.preventDefault();\r\n                                const downEvent = renderer.getEvent(new MouseEvent(\"mouse\"));\r\n                                focusedSprite.events.dispatch(\"click\", {\r\n                                    type: \"click\",\r\n                                    originalEvent: downEvent.event,\r\n                                    point: downEvent.point,\r\n                                    simulated: true,\r\n                                    target: focusedSprite\r\n                                });\r\n                                return;\r\n                            case \"ArrowLeft\":\r\n                                dragOffsetX = -6;\r\n                                break;\r\n                            case \"ArrowRight\":\r\n                                dragOffsetX = 6;\r\n                                break;\r\n                            case \"ArrowUp\":\r\n                                dragOffsetY = -6;\r\n                                break;\r\n                            case \"ArrowDown\":\r\n                                dragOffsetY = 6;\r\n                                break;\r\n                            default:\r\n                                return;\r\n                        }\r\n                        if (dragOffsetX != 0 || dragOffsetY != 0) {\r\n                            ev.preventDefault();\r\n                            if (!focusedSprite.isDragging()) {\r\n                                // Start dragging\r\n                                this._keyboardDragPoint = {\r\n                                    x: 0,\r\n                                    y: 0\r\n                                };\r\n                                const downEvent = renderer.getEvent(new MouseEvent(\"mousedown\", {\r\n                                    clientX: 0,\r\n                                    clientY: 0\r\n                                }));\r\n                                downEvent.point = {\r\n                                    x: 0,\r\n                                    y: 0\r\n                                };\r\n                                if (focusedSprite.events.isEnabled(\"pointerdown\")) {\r\n                                    focusedSprite.events.dispatch(\"pointerdown\", {\r\n                                        type: \"pointerdown\",\r\n                                        originalEvent: downEvent.event,\r\n                                        point: downEvent.point,\r\n                                        simulated: true,\r\n                                        target: focusedSprite\r\n                                    });\r\n                                }\r\n                            }\r\n                            else {\r\n                                // Move focus marker\r\n                                //this._positionFocusElement(focusedSprite);\r\n                            }\r\n                            // Move incrementally\r\n                            const dragPoint = this._keyboardDragPoint;\r\n                            dragPoint.x += dragOffsetX;\r\n                            dragPoint.y += dragOffsetY;\r\n                            const moveEvent = renderer.getEvent(new MouseEvent(\"mousemove\", {\r\n                                clientX: dragPoint.x,\r\n                                clientY: dragPoint.y\r\n                            }), false);\r\n                            if (focusedSprite.events.isEnabled(\"globalpointermove\")) {\r\n                                focusedSprite.events.dispatch(\"globalpointermove\", {\r\n                                    type: \"globalpointermove\",\r\n                                    originalEvent: moveEvent.event,\r\n                                    point: moveEvent.point,\r\n                                    simulated: true,\r\n                                    target: focusedSprite\r\n                                });\r\n                            }\r\n                        }\r\n                    }\r\n                }));\r\n                this._disposers.push($utils.addEventListener(focusElementContainer, \"keyup\", (ev) => {\r\n                    if (this._focusedSprite) {\r\n                        const focusedSprite = this._focusedSprite;\r\n                        const eventKey = $utils.getEventKey(ev);\r\n                        switch (eventKey) {\r\n                            case \"ArrowLeft\":\r\n                            case \"ArrowRight\":\r\n                            case \"ArrowUp\":\r\n                            case \"ArrowDown\":\r\n                                if (focusedSprite.isDragging()) {\r\n                                    // Simulate drag stop\r\n                                    const dragPoint = this._keyboardDragPoint;\r\n                                    const upEvent = renderer.getEvent(new MouseEvent(\"mouseup\", {\r\n                                        clientX: dragPoint.x,\r\n                                        clientY: dragPoint.y\r\n                                    }));\r\n                                    if (focusedSprite.events.isEnabled(\"globalpointerup\")) {\r\n                                        focusedSprite.events.dispatch(\"globalpointerup\", {\r\n                                            type: \"globalpointerup\",\r\n                                            originalEvent: upEvent.event,\r\n                                            point: upEvent.point,\r\n                                            simulated: true,\r\n                                            target: focusedSprite\r\n                                        });\r\n                                    }\r\n                                    //this._positionFocusElement(focusedSprite);\r\n                                    this._keyboardDragPoint = undefined;\r\n                                    // @todo dispatch mouseup event instead of calling dragStop?\r\n                                    // this._dispatchEvent(\"globalpointerup\", target, upEvent);\r\n                                    return;\r\n                                }\r\n                                else if (focusedSprite.get(\"focusableGroup\")) {\r\n                                    // Find next item in focusable group\r\n                                    const group = focusedSprite.get(\"focusableGroup\");\r\n                                    const items = this._tabindexes.filter((item) => {\r\n                                        return item.get(\"focusableGroup\") == group && item.getPrivate(\"focusable\") !== false && item.isVisibleDeep() ? true : false;\r\n                                    });\r\n                                    let index = items.indexOf(focusedSprite);\r\n                                    const lastIndex = items.length - 1;\r\n                                    index += (eventKey == \"ArrowRight\" || eventKey == \"ArrowDown\") ? 1 : -1;\r\n                                    if (index < 0) {\r\n                                        index = lastIndex;\r\n                                    }\r\n                                    else if (index > lastIndex) {\r\n                                        index = 0;\r\n                                    }\r\n                                    $utils.focus(items[index].getPrivate(\"focusElement\").dom);\r\n                                }\r\n                                break;\r\n                            case \"Tab\":\r\n                                const group = focusedSprite.get(\"focusableGroup\");\r\n                                if (group && this._isShift) {\r\n                                    if (!this._skipNextGroupJump) {\r\n                                        this._focusNext(focusedSprite.getPrivate(\"focusElement\").dom, -1, group);\r\n                                        this._skipNextGroupJump = true;\r\n                                    }\r\n                                    return;\r\n                                }\r\n                                break;\r\n                        }\r\n                    }\r\n                }));\r\n            }\r\n        }\r\n        this._startTicker();\r\n        this.setThemes([]);\r\n        this._addTooltip();\r\n        if (!this._hasLicense()) {\r\n            this._showBranding();\r\n        }\r\n    }\r\n    /**\r\n     * Returns an instance of a universal [[Tooltip]] instance.\r\n     * @since 5.14.0\r\n     */\r\n    get systemTooltip() {\r\n        if (!this._systemTooltip) {\r\n            const tooltip = Tooltip.new(this, {\r\n                themeTags: [\"system\"]\r\n            });\r\n            this._systemTooltip = tooltip;\r\n        }\r\n        return this._systemTooltip;\r\n    }\r\n    _initResizeSensor() {\r\n        if (this._resizeSensorDisposer) {\r\n            this._resizeSensorDisposer.dispose();\r\n        }\r\n        this._resizeSensorDisposer = new ResizeSensor(this.dom, () => {\r\n            if (this.autoResize) {\r\n                this.resize();\r\n            }\r\n        });\r\n        this._disposers.push(this._resizeSensorDisposer);\r\n    }\r\n    /**\r\n     * If automatic resizing of char is disabled (`root.autoResize = false`), it\r\n     * can be resized manually by calling this method.\r\n     */\r\n    resize() {\r\n        const rect = this._getRealSize();\r\n        const size = this._getCalculatedSize(rect);\r\n        const w = Math.floor(size.width);\r\n        const h = Math.floor(size.height);\r\n        if (w > 0 && h > 0) {\r\n            const realWidth = Math.floor(rect.width);\r\n            const realHeight = Math.floor(rect.height);\r\n            const htmlElementContainer = this._htmlElementContainer;\r\n            htmlElementContainer.style.width = w + \"px\";\r\n            htmlElementContainer.style.height = h + \"px\";\r\n            if (this._a11yD !== true) {\r\n                const focusElementContainer = this._focusElementContainer;\r\n                focusElementContainer.style.width = w + \"px\";\r\n                focusElementContainer.style.height = h + \"px\";\r\n            }\r\n            this._renderer.resize(realWidth, realHeight, w, h);\r\n            const rootContainer = this._rootContainer;\r\n            rootContainer.setPrivate(\"width\", w);\r\n            rootContainer.setPrivate(\"height\", h);\r\n            this._render();\r\n            this._handleLogo();\r\n        }\r\n    }\r\n    _render() {\r\n        this._renderer.render(this._rootContainer._display);\r\n        if (this._focusElementDirty) {\r\n            this._updateCurrentFocus();\r\n            this._focusElementDirty = false;\r\n        }\r\n    }\r\n    _runTickers(currentTime) {\r\n        $array.each(this._tickers, (f) => {\r\n            f(currentTime);\r\n        });\r\n    }\r\n    _runAnimations(currentTime) {\r\n        let running = 0;\r\n        $array.keepIf(this._animations, (animation) => {\r\n            const state = animation._runAnimation(currentTime);\r\n            if (state === AnimationState.Stopped) {\r\n                return false;\r\n            }\r\n            else if (state === AnimationState.Playing) {\r\n                ++running;\r\n                return true;\r\n            }\r\n            else {\r\n                return true;\r\n            }\r\n        });\r\n        this._isDirtyAnimation = false;\r\n        return running === 0;\r\n    }\r\n    _runDirties() {\r\n        //console.log(\"tick **************************************************************\");\r\n        let allParents = {};\r\n        while (this._isDirtyParents) {\r\n            // This must be before calling _prepareChildren\r\n            this._isDirtyParents = false;\r\n            $object.keys(this._dirtyParents).forEach((key) => {\r\n                const parent = this._dirtyParents[key];\r\n                delete this._dirtyParents[key];\r\n                if (!parent.isDisposed()) {\r\n                    allParents[parent.uid] = parent;\r\n                    parent._prepareChildren();\r\n                }\r\n            });\r\n        }\r\n        $object.keys(allParents).forEach((key) => {\r\n            allParents[key]._updateChildren();\r\n        });\r\n        const objects = [];\r\n        //\t\tconsole.log(\"_beforeChanged\")\r\n        $object.keys(this._dirty).forEach((key) => {\r\n            const entity = this._dirty[key];\r\n            if (entity.isDisposed()) {\r\n                delete this._dirty[entity.uid];\r\n            }\r\n            else {\r\n                objects.push(entity);\r\n                entity._beforeChanged();\r\n            }\r\n        });\r\n        //\t\tconsole.log(\"_changed\")\r\n        objects.forEach((entity) => {\r\n            entity._changed();\r\n            delete this._dirty[entity.uid];\r\n            entity._clearDirty();\r\n        });\r\n        this._isDirty = false;\r\n        const depths = {};\r\n        const bounds = [];\r\n        $object.keys(this._dirtyBounds).forEach((key) => {\r\n            const entity = this._dirtyBounds[key];\r\n            delete this._dirtyBounds[key];\r\n            if (!entity.isDisposed()) {\r\n                depths[entity.uid] = entity.depth();\r\n                bounds.push(entity);\r\n            }\r\n        });\r\n        this._positionHTMLElements();\r\n        // High depth -> low depth\r\n        bounds.sort((x, y) => {\r\n            return $order.compare(depths[y.uid], depths[x.uid]);\r\n        });\r\n        //\t\tconsole.log(\"_updateBounds\")\r\n        bounds.forEach((entity) => {\r\n            entity._updateBounds();\r\n        });\r\n        //\t\tconsole.log(\"_updatePosition\")\r\n        const dirtyPositions = this._dirtyPositions;\r\n        $object.keys(dirtyPositions).forEach((key) => {\r\n            const sprite = dirtyPositions[key];\r\n            delete dirtyPositions[key];\r\n            if (!sprite.isDisposed()) {\r\n                sprite._updatePosition();\r\n            }\r\n        });\r\n        //\t\tconsole.log(\"_afterChanged\")\r\n        objects.forEach((entity) => {\r\n            entity._afterChanged();\r\n        });\r\n        $object.keys(allParents).forEach((key) => {\r\n            allParents[key]._childrenPrep = false;\r\n            allParents[key]._childrenUpdt = false;\r\n        });\r\n    }\r\n    _renderFrame(currentTime) {\r\n        if (this._updateTick) {\r\n            if (this.events.isEnabled(\"framestarted\")) {\r\n                this.events.dispatch(\"framestarted\", {\r\n                    type: \"framestarted\",\r\n                    target: this,\r\n                    timestamp: currentTime,\r\n                });\r\n            }\r\n            this._checkComputedStyles();\r\n            this._runTickers(currentTime);\r\n            const animationDone = this._runAnimations(currentTime);\r\n            this._runDirties();\r\n            this._render();\r\n            this._renderer.resetImageArray();\r\n            this._positionHTMLElements();\r\n            if (this.events.isEnabled(\"frameended\")) {\r\n                this.events.dispatch(\"frameended\", {\r\n                    type: \"frameended\",\r\n                    target: this,\r\n                    timestamp: currentTime,\r\n                });\r\n            }\r\n            return this._tickers.length === 0 &&\r\n                animationDone &&\r\n                !this._isDirtyAnimation &&\r\n                !this._isDirty;\r\n        }\r\n        else {\r\n            return true;\r\n        }\r\n    }\r\n    _runTicker(currentTime, now) {\r\n        if (!this.isDisposed()) {\r\n            this.animationTime = currentTime;\r\n            const done = this._renderFrame(currentTime);\r\n            // No more work to do\r\n            if (done) {\r\n                this._ticker = null;\r\n                this.animationTime = null;\r\n            }\r\n            else {\r\n                if (!this._paused) {\r\n                    if (now) {\r\n                        this._ticker;\r\n                    }\r\n                    else {\r\n                        rAF(this.fps, this._ticker);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    _runTickerNow(timeout = 10000) {\r\n        if (!this.isDisposed()) {\r\n            const endTime = performance.now() + timeout;\r\n            for (;;) {\r\n                const currentTime = performance.now();\r\n                if (currentTime >= endTime) {\r\n                    this.animationTime = null;\r\n                    break;\r\n                }\r\n                this.animationTime = currentTime;\r\n                const done = this._renderFrame(currentTime);\r\n                if (done) {\r\n                    this.animationTime = null;\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    _startTicker() {\r\n        if (this._ticker === null) {\r\n            this.animationTime = null;\r\n            this._ticker = (currentTime) => {\r\n                this._runTicker(currentTime);\r\n            };\r\n            rAF(this.fps, this._ticker);\r\n        }\r\n    }\r\n    /**\r\n     * Returns whether the root is updating or not.\r\n     */\r\n    get updateTick() {\r\n        return this._updateTick;\r\n    }\r\n    /**\r\n     * Enables or disables the root updating.\r\n     */\r\n    set updateTick(value) {\r\n        this._updateTick = value;\r\n        if (value) {\r\n            this._startTicker();\r\n        }\r\n    }\r\n    _addDirtyEntity(entity) {\r\n        this._isDirty = true;\r\n        if (this._dirty[entity.uid] === undefined) {\r\n            this._dirty[entity.uid] = entity;\r\n        }\r\n        this._startTicker();\r\n    }\r\n    _addDirtyParent(parent) {\r\n        this._isDirty = true;\r\n        this._isDirtyParents = true;\r\n        if (this._dirtyParents[parent.uid] === undefined) {\r\n            this._dirtyParents[parent.uid] = parent;\r\n        }\r\n        this._startTicker();\r\n    }\r\n    _addDirtyBounds(entity) {\r\n        this._isDirty = true;\r\n        if (this._dirtyBounds[entity.uid] === undefined) {\r\n            this._dirtyBounds[entity.uid] = entity;\r\n        }\r\n        this._startTicker();\r\n    }\r\n    _addDirtyPosition(sprite) {\r\n        this._isDirty = true;\r\n        if (this._dirtyPositions[sprite.uid] === undefined) {\r\n            this._dirtyPositions[sprite.uid] = sprite;\r\n        }\r\n        this._startTicker();\r\n    }\r\n    _addAnimation(animation) {\r\n        this._isDirtyAnimation = true;\r\n        // TODO use numeric id instead\r\n        if (this._animations.indexOf(animation) === -1) {\r\n            this._animations.push(animation);\r\n        }\r\n        this._startTicker();\r\n    }\r\n    _markDirty() {\r\n        this._isDirty = true;\r\n    }\r\n    _markDirtyRedraw() {\r\n        this.events.once(\"frameended\", () => {\r\n            this._isDirty = true;\r\n            this._startTicker();\r\n        });\r\n    }\r\n    eachFrame(f) {\r\n        this._tickers.push(f);\r\n        this._startTicker();\r\n        return new Disposer(() => {\r\n            $array.removeFirst(this._tickers, f);\r\n        });\r\n    }\r\n    markDirtyGlobal(container) {\r\n        if (!container) {\r\n            container = this.container;\r\n        }\r\n        container.walkChildren((child) => {\r\n            if (child instanceof Container) {\r\n                this.markDirtyGlobal(child);\r\n            }\r\n            child.markDirty();\r\n            child.markDirtyBounds();\r\n        });\r\n    }\r\n    /**\r\n     * Returns width of the target container, in pixels.\r\n     *\r\n     * @return Width\r\n     */\r\n    width() {\r\n        // TODO make this more efficient, maybe just return the renderer's width ?\r\n        return Math.floor(this._getCalculatedSize(this._getRealSize()).width);\r\n    }\r\n    /**\r\n     * Returns height of the target container, in pixels.\r\n     *\r\n     * @return Height\r\n     */\r\n    height() {\r\n        // TODO make this more efficient, maybe just return the renderer's height ?\r\n        return Math.floor(this._getCalculatedSize(this._getRealSize()).height);\r\n    }\r\n    /**\r\n     * Disposes root and all the content in it.\r\n     */\r\n    dispose() {\r\n        if (!this._isDisposed) {\r\n            this._isDisposed = true;\r\n            this._rootContainer.dispose();\r\n            this._renderer.dispose();\r\n            this.horizontalLayout.dispose();\r\n            this.verticalLayout.dispose();\r\n            this.interfaceColors.dispose();\r\n            $array.each(this._disposers, (x) => {\r\n                x.dispose();\r\n            });\r\n            if (this._inner) {\r\n                $utils.removeElement(this._inner);\r\n            }\r\n            $array.remove(registry.rootElements, this);\r\n        }\r\n    }\r\n    /**\r\n     * Returns `true` if root element is disposed.\r\n     *\r\n     * @return Disposed?\r\n     */\r\n    isDisposed() {\r\n        return this._isDisposed;\r\n    }\r\n    /**\r\n     * Triggers screen reader read out a message.\r\n     *\r\n     * @see {@link https://www.amcharts.com/docs/v5/concepts/accessibility/} for more info\r\n     * @param  text  Alert text\r\n     */\r\n    readerAlert(text) {\r\n        if (this._a11yD !== true) {\r\n            const element = this._readerAlertElement;\r\n            text = $utils.stripTags(text);\r\n            if (element.innerHTML == text) {\r\n                element.innerHTML = \"\";\r\n            }\r\n            element.innerHTML = text;\r\n        }\r\n    }\r\n    /**\r\n     * Sets themes to be used for the chart.\r\n     *\r\n     * @see {@link https://www.amcharts.com/docs/v5/concepts/themes/} for more info\r\n     * @param  themes  A list of themes\r\n     */\r\n    setThemes(themes) {\r\n        this._rootContainer.set(\"themes\", themes);\r\n        // otherwise new themes are not applied\r\n        const tooltipContainer = this.tooltipContainer;\r\n        if (tooltipContainer) {\r\n            tooltipContainer._applyThemes();\r\n        }\r\n        // @todo review this\r\n        const interfaceColors = this.interfaceColors;\r\n        if (interfaceColors) {\r\n            interfaceColors._applyThemes();\r\n        }\r\n    }\r\n    _addTooltip() {\r\n        if (!this.tooltipContainer) {\r\n            const tooltipContainerSettings = this._tooltipContainerSettings;\r\n            const tooltipContainer = this._rootContainer.children.push(Container.new(this, {\r\n                position: \"absolute\",\r\n                isMeasured: false,\r\n                width: p100,\r\n                height: p100,\r\n                layer: tooltipContainerSettings ? 35 : 30,\r\n                layerMargin: tooltipContainerSettings ? tooltipContainerSettings : undefined\r\n            }));\r\n            this.tooltipContainer = tooltipContainer;\r\n            const tooltip = Tooltip.new(this, {});\r\n            this.container.set(\"tooltip\", tooltip);\r\n            tooltip.hide(0);\r\n            this._tooltip = tooltip;\r\n        }\r\n    }\r\n    /**\r\n     * Accesibility\r\n     */\r\n    _registerTabindexOrder(target) {\r\n        if (this._a11yD == true) {\r\n            return;\r\n        }\r\n        if (target.get(\"focusable\")) {\r\n            $array.pushOne(this._tabindexes, target);\r\n        }\r\n        else {\r\n            $array.remove(this._tabindexes, target);\r\n        }\r\n        this._invalidateTabindexes();\r\n    }\r\n    _unregisterTabindexOrder(target) {\r\n        if (this._a11yD == true) {\r\n            return;\r\n        }\r\n        $array.remove(this._tabindexes, target);\r\n        this._invalidateTabindexes();\r\n    }\r\n    _invalidateTabindexes() {\r\n        if (this._a11yD == true) {\r\n            return;\r\n        }\r\n        this._tabindexes.sort((a, b) => {\r\n            const aindex = a.get(\"tabindexOrder\", 0);\r\n            const bindex = b.get(\"tabindexOrder\", 0);\r\n            if (aindex == bindex) {\r\n                return 0;\r\n            }\r\n            else if (aindex > bindex) {\r\n                return 1;\r\n            }\r\n            else {\r\n                return -1;\r\n            }\r\n        });\r\n        const groups = [];\r\n        $array.each(this._tabindexes, (item, index) => {\r\n            if (!item.getPrivate(\"focusElement\")) {\r\n                this._makeFocusElement(index, item);\r\n            }\r\n            else {\r\n                this._moveFocusElement(index, item);\r\n            }\r\n            const group = item.get(\"focusableGroup\");\r\n            if (group && item.getPrivate(\"focusable\") !== false) {\r\n                if (groups.indexOf(group) !== -1) {\r\n                    // Non-first element in the group, make it not directly focusable\r\n                    item.getPrivate(\"focusElement\").dom.setAttribute(\"tabindex\", \"-1\");\r\n                }\r\n                else {\r\n                    groups.push(group);\r\n                }\r\n            }\r\n        });\r\n    }\r\n    _updateCurrentFocus() {\r\n        if (this._a11yD == true) {\r\n            return;\r\n        }\r\n        if (this._focusedSprite) {\r\n            this._decorateFocusElement(this._focusedSprite);\r\n            this._positionFocusElement(this._focusedSprite);\r\n        }\r\n    }\r\n    _decorateFocusElement(target, focusElement) {\r\n        if (this._a11yD == true) {\r\n            return;\r\n        }\r\n        // Decorate with proper accessibility attributes\r\n        if (!focusElement) {\r\n            focusElement = target.getPrivate(\"focusElement\").dom;\r\n        }\r\n        if (!focusElement) {\r\n            return;\r\n        }\r\n        const role = target.get(\"role\");\r\n        if (role) {\r\n            focusElement.setAttribute(\"role\", role);\r\n        }\r\n        else {\r\n            focusElement.removeAttribute(\"role\");\r\n        }\r\n        const ariaLabel = target.get(\"ariaLabel\");\r\n        if (ariaLabel) {\r\n            const label = populateString(target, ariaLabel);\r\n            focusElement.setAttribute(\"aria-label\", label);\r\n        }\r\n        else {\r\n            focusElement.removeAttribute(\"aria-label\");\r\n        }\r\n        const ariaLive = target.get(\"ariaLive\");\r\n        if (ariaLive) {\r\n            focusElement.setAttribute(\"aria-live\", ariaLive);\r\n        }\r\n        else {\r\n            focusElement.removeAttribute(\"aria-live\");\r\n        }\r\n        const ariaChecked = target.get(\"ariaChecked\");\r\n        if (ariaChecked != null && role && [\"checkbox\", \"option\", \"radio\", \"menuitemcheckbox\", \"menuitemradio\", \"treeitem\"].indexOf(role) !== -1) {\r\n            focusElement.setAttribute(\"aria-checked\", ariaChecked ? \"true\" : \"false\");\r\n        }\r\n        else {\r\n            focusElement.removeAttribute(\"aria-checked\");\r\n        }\r\n        const ariaCurrent = target.get(\"ariaCurrent\");\r\n        if (ariaCurrent != null) {\r\n            focusElement.setAttribute(\"aria-current\", ariaCurrent);\r\n        }\r\n        else {\r\n            focusElement.removeAttribute(\"aria-current\");\r\n        }\r\n        const ariaSelected = target.get(\"ariaSelected\");\r\n        if (ariaSelected != null && role && [\"gridcell\", \"option\", \"row\", \"tab\", \"columnheader\", \"rowheader\", \"treeitem\"].indexOf(role) !== -1) {\r\n            focusElement.setAttribute(\"aria-selected\", ariaSelected ? \"true\" : \"false\");\r\n        }\r\n        else {\r\n            focusElement.removeAttribute(\"aria-selected\");\r\n        }\r\n        if (target.get(\"ariaHidden\")) {\r\n            focusElement.setAttribute(\"aria-hidden\", \"true\");\r\n        }\r\n        else {\r\n            focusElement.removeAttribute(\"aria-hidden\");\r\n        }\r\n        const ariaOrientation = target.get(\"ariaOrientation\");\r\n        if (ariaOrientation) {\r\n            focusElement.setAttribute(\"aria-orientation\", ariaOrientation);\r\n        }\r\n        else {\r\n            focusElement.removeAttribute(\"aria-orientation\");\r\n        }\r\n        const ariaValueNow = target.get(\"ariaValueNow\");\r\n        if (ariaValueNow) {\r\n            focusElement.setAttribute(\"aria-valuenow\", ariaValueNow);\r\n        }\r\n        else {\r\n            focusElement.removeAttribute(\"aria-valuenow\");\r\n        }\r\n        const ariaValueMin = target.get(\"ariaValueMin\");\r\n        if (ariaValueMin) {\r\n            focusElement.setAttribute(\"aria-valuemin\", ariaValueMin);\r\n        }\r\n        else {\r\n            focusElement.removeAttribute(\"aria-valuemin\");\r\n        }\r\n        const ariaValueMax = target.get(\"ariaValueMax\");\r\n        if (ariaValueMax) {\r\n            focusElement.setAttribute(\"aria-valuemax\", ariaValueMax);\r\n        }\r\n        else {\r\n            focusElement.removeAttribute(\"aria-valuemax\");\r\n        }\r\n        const ariaValueText = target.get(\"ariaValueText\");\r\n        if (ariaValueText) {\r\n            focusElement.setAttribute(\"aria-valuetext\", ariaValueText);\r\n        }\r\n        else {\r\n            focusElement.removeAttribute(\"aria-valuetext\");\r\n        }\r\n        const ariaControls = target.get(\"ariaControls\");\r\n        if (ariaControls) {\r\n            focusElement.setAttribute(\"aria-controls\", ariaControls);\r\n        }\r\n        else {\r\n            focusElement.removeAttribute(\"aria-controls\");\r\n        }\r\n        if (target.get(\"visible\") && target.get(\"opacity\") !== 0 && target.get(\"role\") != \"tooltip\" && !target.isHidden() && target.getPrivate(\"focusable\") !== false && (target.height() || target.width())) {\r\n            if (focusElement.getAttribute(\"tabindex\") != \"-1\") {\r\n                focusElement.setAttribute(\"tabindex\", \"\" + this.tabindex);\r\n            }\r\n            focusElement.removeAttribute(\"aria-hidden\");\r\n        }\r\n        else {\r\n            focusElement.removeAttribute(\"tabindex\");\r\n            focusElement.setAttribute(\"aria-hidden\", \"true\");\r\n        }\r\n    }\r\n    _makeFocusElement(index, target) {\r\n        if (target.getPrivate(\"focusElement\") || this._a11yD == true) {\r\n            return;\r\n        }\r\n        // Init\r\n        const focusElement = document.createElement(\"div\");\r\n        if (target.get(\"role\") != \"tooltip\") {\r\n            focusElement.tabIndex = this.tabindex;\r\n        }\r\n        focusElement.style.position = \"absolute\";\r\n        $utils.setInteractive(focusElement, false);\r\n        const disposers = [];\r\n        target.setPrivate(\"focusElement\", {\r\n            dom: focusElement,\r\n            disposers,\r\n        });\r\n        this._decorateFocusElement(target);\r\n        disposers.push($utils.addEventListener(focusElement, \"focus\", (ev) => {\r\n            this._handleFocus(ev);\r\n        }));\r\n        disposers.push($utils.addEventListener(focusElement, \"blur\", (ev) => {\r\n            this._handleBlur(ev);\r\n        }));\r\n        this._moveFocusElement(index, target);\r\n    }\r\n    _removeFocusElement(target) {\r\n        if (this._a11yD == true) {\r\n            return;\r\n        }\r\n        $array.remove(this._tabindexes, target);\r\n        const focusElement = target.getPrivate(\"focusElement\");\r\n        if (focusElement) {\r\n            const container = this._focusElementContainer;\r\n            container.removeChild(focusElement.dom);\r\n            $array.each(focusElement.disposers, (x) => {\r\n                x.dispose();\r\n            });\r\n        }\r\n    }\r\n    _hideFocusElement(target) {\r\n        if (this._a11yD == true) {\r\n            return;\r\n        }\r\n        const focusElement = target.getPrivate(\"focusElement\");\r\n        focusElement.dom.style.display = \"none\";\r\n    }\r\n    _moveFocusElement(index, target) {\r\n        if (this._a11yD == true) {\r\n            return;\r\n        }\r\n        // Get container\r\n        const container = this._focusElementContainer;\r\n        const focusElement = target.getPrivate(\"focusElement\").dom;\r\n        if (focusElement === this._focusElementContainer.children[index]) {\r\n            // Nothing to do\r\n            return;\r\n        }\r\n        const next = this._focusElementContainer.children[index + 1];\r\n        if (next) {\r\n            container.insertBefore(focusElement, next);\r\n        }\r\n        else {\r\n            container.append(focusElement);\r\n        }\r\n    }\r\n    _positionFocusElement(target) {\r\n        if (this._a11yD == true || target == undefined) {\r\n            return;\r\n        }\r\n        this._focusElementContainer.scrollTop = 0;\r\n        const bounds = target.globalBounds();\r\n        let width = bounds.right == bounds.left ? target.width() : bounds.right - bounds.left;\r\n        let height = bounds.top == bounds.bottom ? target.height() : bounds.bottom - bounds.top;\r\n        const padding = this._settings.focusPadding !== undefined ? this._settings.focusPadding : 2;\r\n        let x = bounds.left - padding;\r\n        let y = bounds.top - padding;\r\n        if (width < 0) {\r\n            x += width;\r\n            width = Math.abs(width);\r\n        }\r\n        if (height < 0) {\r\n            y += height;\r\n            height = Math.abs(height);\r\n        }\r\n        const focusElement = target.getPrivate(\"focusElement\").dom;\r\n        focusElement.style.top = y + \"px\";\r\n        focusElement.style.left = x + \"px\";\r\n        focusElement.style.width = (width + padding * 2) + \"px\";\r\n        focusElement.style.height = (height + padding * 2) + \"px\";\r\n    }\r\n    _getSpriteByFocusElement(target) {\r\n        let found;\r\n        $array.eachContinue(this._tabindexes, (item, _index) => {\r\n            if (item.getPrivate(\"focusElement\").dom === target) {\r\n                found = item;\r\n                return false;\r\n            }\r\n            return true;\r\n        });\r\n        return found;\r\n    }\r\n    _handleFocus(ev) {\r\n        if (this._a11yD == true) {\r\n            return;\r\n        }\r\n        // Get element\r\n        //const focused = this._tabindexes[index];\r\n        const focused = this._getSpriteByFocusElement(ev.target);\r\n        if (!focused) {\r\n            return;\r\n        }\r\n        // Jump over hidden elements\r\n        if (!focused.isVisibleDeep()) {\r\n            this._focusNext(ev.target, this._isShift ? -1 : 1);\r\n            return;\r\n        }\r\n        // Size and position\r\n        this._positionFocusElement(focused);\r\n        //this._decorateFocusElement(focused);\r\n        this._focusedSprite = focused;\r\n        if (focused.events.isEnabled(\"focus\")) {\r\n            focused.events.dispatch(\"focus\", {\r\n                type: \"focus\",\r\n                originalEvent: ev,\r\n                target: focused\r\n            });\r\n        }\r\n        if (focused.getPrivate(\"focusElement\").dom.tabIndex == -1) {\r\n            this._skipNextGroupJump = false;\r\n        }\r\n    }\r\n    _focusNext(el, direction, group) {\r\n        if (this._a11yD == true) {\r\n            return;\r\n        }\r\n        const focusableElements = Array.from(document.querySelectorAll([\r\n            'a[href]',\r\n            'area[href]',\r\n            'button:not([disabled])',\r\n            'details',\r\n            'input:not([disabled])',\r\n            'iframe:not([disabled])',\r\n            'select:not([disabled])',\r\n            'textarea:not([disabled])',\r\n            '[contentEditable=\"\"]',\r\n            '[contentEditable=\"true\"]',\r\n            '[contentEditable=\"TRUE\"]',\r\n            '[tabindex]:not([tabindex^=\"-\"])',\r\n            //':not([disabled])'\r\n        ].join(',')));\r\n        let index = focusableElements.indexOf(el) + direction;\r\n        if (index < 0) {\r\n            index = focusableElements.length - 1;\r\n        }\r\n        else if (index >= focusableElements.length) {\r\n            index = 0;\r\n        }\r\n        const targetElement = focusableElements[index];\r\n        if (group && direction == -1) {\r\n            const target = this._getSpriteByFocusElement(targetElement);\r\n            if (target && target.get(\"focusableGroup\") == group) {\r\n                this._focusNext(targetElement, direction);\r\n                return;\r\n            }\r\n        }\r\n        targetElement.focus();\r\n    }\r\n    _handleBlur(ev) {\r\n        if (this._a11yD == true) {\r\n            return;\r\n        }\r\n        const focused = this._focusedSprite;\r\n        if (focused && !focused.isDisposed() && focused.events.isEnabled(\"blur\")) {\r\n            focused.events.dispatch(\"blur\", {\r\n                type: \"blur\",\r\n                originalEvent: ev,\r\n                target: focused\r\n            });\r\n        }\r\n        this._focusedSprite = undefined;\r\n    }\r\n    /**\r\n     * @ignore\r\n     */\r\n    updateTooltip(target) {\r\n        if (this._a11yD == true) {\r\n            return;\r\n        }\r\n        const text = $utils.stripTags(target._getText());\r\n        let tooltipElement = target.getPrivate(\"tooltipElement\");\r\n        if (target.get(\"role\") == \"tooltip\" && text != \"\") {\r\n            if (!tooltipElement) {\r\n                tooltipElement = this._makeTooltipElement(target);\r\n            }\r\n            if (tooltipElement.innerHTML != text) {\r\n                tooltipElement.innerHTML = text;\r\n            }\r\n            tooltipElement.setAttribute(\"aria-hidden\", target.isVisibleDeep() ? \"false\" : \"true\");\r\n        }\r\n        else if (tooltipElement) {\r\n            tooltipElement.remove();\r\n            target.removePrivate(\"tooltipElement\");\r\n        }\r\n    }\r\n    _makeTooltipElement(target) {\r\n        const container = this._tooltipElementContainer;\r\n        const tooltipElement = document.createElement(\"div\");\r\n        tooltipElement.style.position = \"absolute\";\r\n        tooltipElement.style.width = \"1px\";\r\n        tooltipElement.style.height = \"1px\";\r\n        tooltipElement.style.overflow = \"hidden\";\r\n        tooltipElement.style.clip = \"rect(1px, 1px, 1px, 1px)\";\r\n        $utils.setInteractive(tooltipElement, false);\r\n        this._decorateFocusElement(target, tooltipElement);\r\n        container.append(tooltipElement);\r\n        target.setPrivate(\"tooltipElement\", tooltipElement);\r\n        return tooltipElement;\r\n    }\r\n    _removeTooltipElement(target) {\r\n        if (this._a11yD == true) {\r\n            return;\r\n        }\r\n        const tooltipElement = target.getPrivate(\"tooltipElement\");\r\n        if (tooltipElement) {\r\n            const parent = tooltipElement.parentElement;\r\n            if (parent) {\r\n                parent.removeChild(tooltipElement);\r\n            }\r\n        }\r\n    }\r\n    _invalidateAccessibility(target) {\r\n        if (this._a11yD == true) {\r\n            return;\r\n        }\r\n        this._focusElementDirty = true;\r\n        const focusElement = target.getPrivate(\"focusElement\");\r\n        if (target.get(\"focusable\")) {\r\n            if (focusElement) {\r\n                this._decorateFocusElement(target);\r\n                this._positionFocusElement(target);\r\n            }\r\n            // else {\r\n            // \tthis._renderer._makeFocusElement(0, this);\r\n            // }\r\n        }\r\n        else if (focusElement) {\r\n            this._removeFocusElement(target);\r\n        }\r\n        //this.updateCurrentFocus();\r\n    }\r\n    /**\r\n     * Returns `true` if `target` is currently focused.\r\n     *\r\n     * @param   target  Target\r\n     * @return          Focused?\r\n     */\r\n    focused(target) {\r\n        return this._focusedSprite === target;\r\n    }\r\n    /**\r\n     * Converts document coordinates to coordinates withing root element.\r\n     *\r\n     * @param   point  Document point\r\n     * @return         Root point\r\n     */\r\n    documentPointToRoot(point) {\r\n        const rect = this._getRealSize();\r\n        const size = this._getCalculatedSize(rect);\r\n        const scaleWidth = size.width / rect.width;\r\n        const scaleHeight = size.height / rect.height;\r\n        return {\r\n            x: (point.x - rect.left) * scaleWidth,\r\n            y: (point.y - rect.top) * scaleHeight,\r\n        };\r\n    }\r\n    /**\r\n     * Converts root coordinates to document\r\n     *\r\n     * @param   point  Document point\r\n     * @return         Root point\r\n     */\r\n    rootPointToDocument(point) {\r\n        const rect = this._getRealSize();\r\n        const size = this._getCalculatedSize(rect);\r\n        const scaleWidth = size.width / rect.width;\r\n        const scaleHeight = size.height / rect.height;\r\n        return {\r\n            x: (point.x / scaleWidth) + rect.left,\r\n            y: (point.y / scaleHeight) + rect.top\r\n        };\r\n    }\r\n    /**\r\n     * @ignore\r\n     */\r\n    addDisposer(disposer) {\r\n        this._disposers.push(disposer);\r\n        return disposer;\r\n    }\r\n    _updateComputedStyles() {\r\n        const styles = window.getComputedStyle(this.dom);\r\n        let fontHash = \"\";\r\n        $object.each(styles, (key, val) => {\r\n            if ($type.isString(key) && key.match(/^font/)) {\r\n                fontHash += val;\r\n            }\r\n        });\r\n        const changed = fontHash != this._fontHash;\r\n        if (changed) {\r\n            this._fontHash = fontHash;\r\n        }\r\n        return changed;\r\n    }\r\n    _checkComputedStyles() {\r\n        if (this._updateComputedStyles()) {\r\n            this._invalidateLabelBounds(this.container);\r\n        }\r\n    }\r\n    _invalidateLabelBounds(target) {\r\n        if (target instanceof Container) {\r\n            target.children.each((child) => {\r\n                this._invalidateLabelBounds(child);\r\n            });\r\n        }\r\n        else if (target instanceof Text) {\r\n            target.markDirtyBounds();\r\n        }\r\n    }\r\n    /**\r\n     * To all the clever heads out there. Yes, we did not make any attempts to\r\n     * scramble this.\r\n     *\r\n     * This is a part of a tool meant for our users to manage their commercial\r\n     * licenses for removal of amCharts branding from charts.\r\n     *\r\n     * The only legit way to do so is to purchase a commercial license for amCharts:\r\n     * https://www.amcharts.com/online-store/\r\n     *\r\n     * Removing or altering this code, or disabling amCharts branding in any other\r\n     * way is against the license and thus illegal.\r\n     */\r\n    _hasLicense() {\r\n        for (let i = 0; i < registry.licenses.length; i++) {\r\n            if (registry.licenses[i].match(/^AM5C.{5,}/i)) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n    _licenseApplied() {\r\n        if (this._logo) {\r\n            this._logo.set(\"forceHidden\", true);\r\n        }\r\n    }\r\n    /**\r\n     * @ignore\r\n     */\r\n    get debugGhostView() {\r\n        return this._renderer.debugGhostView;\r\n    }\r\n    /**\r\n     * @ignore\r\n     */\r\n    set debugGhostView(value) {\r\n        this._renderer.debugGhostView = value;\r\n    }\r\n    /**\r\n     * Set this to `true` if you need chart to require first a tap onto it before\r\n     * touch gesture related functionality like zoom/pan is turned on.\r\n     *\r\n     * @see {@link https://www.amcharts.com/docs/v5/getting-started/root-element/#Touch_related_options} for more info\r\n     * @default false\r\n     * @since 5.2.9\r\n     * @param  value  Needs a tap to activate touch functions\r\n     */\r\n    set tapToActivate(value) {\r\n        this._renderer.tapToActivate = value;\r\n    }\r\n    /**\r\n     * @return Needs a tap to activate touch functions\r\n     */\r\n    get tapToActivate() {\r\n        return this._renderer.tapToActivate;\r\n    }\r\n    /**\r\n     * If `tapToActivate` is set to `true`, this setting will determine number\r\n     * of milliseconds the chart will stay \"active\", before releasing the\r\n     * controls back to the page.\r\n     *\r\n     * @see {@link https://www.amcharts.com/docs/v5/getting-started/root-element/#Touch_related_options} for more info\r\n     * @default 3000\r\n     * @since 5.2.9\r\n     * @param  value  Timeout\r\n     */\r\n    set tapToActivateTimeout(value) {\r\n        this._renderer.tapToActivateTimeout = value;\r\n    }\r\n    /**\r\n     * @return Timeout\r\n     */\r\n    get tapToActivateTimeout() {\r\n        return this._renderer.tapToActivateTimeout;\r\n    }\r\n    _makeHTMLElement(target) {\r\n        // Get container\r\n        const container = this._htmlElementContainer;\r\n        // Init\r\n        const htmlElement = document.createElement(\"div\");\r\n        target.setPrivate(\"htmlElement\", htmlElement);\r\n        // Should we put this into a wrapper?\r\n        let needWrapper = false;\r\n        let wrapperTarget;\r\n        target._walkParents((parent) => {\r\n            if (parent.get(\"verticalScrollbar\")) {\r\n                needWrapper = true;\r\n                wrapperTarget = parent;\r\n                return false;\r\n            }\r\n        });\r\n        let htmlElementWrapper;\r\n        if (needWrapper) {\r\n            htmlElementWrapper = document.createElement(\"div\");\r\n            target.setPrivate(\"htmlElementWrapper\", htmlElementWrapper);\r\n            target.setPrivate(\"wrapperContainer\", wrapperTarget);\r\n            htmlElementWrapper.style.position = \"absolute\";\r\n            htmlElementWrapper.style.overflow = \"hidden\";\r\n            htmlElementWrapper.style.boxSizing = \"border-box\";\r\n            htmlElementWrapper.style.top = \"0px\";\r\n            htmlElementWrapper.style.left = \"0px\";\r\n            htmlElementWrapper.style.width = \"100%\";\r\n            htmlElementWrapper.style.height = \"100%\";\r\n            wrapperTarget.events.on(\"boundschanged\", () => {\r\n                this._positionHTMLElement(target);\r\n            });\r\n        }\r\n        //htmlElement.tabIndex = this.tabindex;\r\n        htmlElement.style.position = \"absolute\";\r\n        htmlElement.style.overflow = \"auto\";\r\n        htmlElement.style.boxSizing = \"border-box\";\r\n        $utils.setInteractive(htmlElement, target.get(\"interactive\", false));\r\n        // Translate events\r\n        if (target.events.isEnabled(\"click\")) {\r\n            $utils.setInteractive(htmlElement, true);\r\n            this._disposers.push($utils.addEventListener(htmlElement, \"click\", (ev) => {\r\n                const downEvent = this._renderer.getEvent(ev);\r\n                target.events.dispatch(\"click\", {\r\n                    type: \"click\",\r\n                    originalEvent: downEvent.event,\r\n                    point: downEvent.point,\r\n                    simulated: false,\r\n                    target: target\r\n                });\r\n            }));\r\n        }\r\n        this._positionHTMLElement(target);\r\n        if (needWrapper) {\r\n            htmlElementWrapper.append(htmlElement);\r\n            container.append(htmlElementWrapper);\r\n        }\r\n        else {\r\n            container.append(htmlElement);\r\n        }\r\n        $array.pushOne(this._htmlEnabledContainers, target);\r\n        return htmlElement;\r\n    }\r\n    _positionHTMLElements() {\r\n        $array.each(this._htmlEnabledContainers, (target) => {\r\n            this._positionHTMLElement(target);\r\n        });\r\n    }\r\n    _positionHTMLElement(target) {\r\n        const htmlElementWrapper = target.getPrivate(\"htmlElementWrapper\");\r\n        if (htmlElementWrapper) {\r\n            const wrapperTarget = target.getPrivate(\"wrapperContainer\");\r\n            if (wrapperTarget) {\r\n                const bounds = wrapperTarget.globalBounds();\r\n                htmlElementWrapper.style.clipPath = \"rect(\" + bounds.top + \"px \" + bounds.right + \"px \" + bounds.bottom + \"px \" + bounds.left + \"px)\";\r\n            }\r\n        }\r\n        const htmlElement = target.getPrivate(\"htmlElement\");\r\n        if (htmlElement) {\r\n            // Translate settings\r\n            const visualSettings = [\r\n                \"paddingTop\",\r\n                \"paddingRight\",\r\n                \"paddingBottom\",\r\n                \"paddingLeft\",\r\n                \"minWidth\",\r\n                \"minHeight\",\r\n                \"maxWidth\",\r\n                \"maxHeight\"\r\n            ];\r\n            $array.each(visualSettings, (setting) => {\r\n                const value = target.get(setting);\r\n                if (value) {\r\n                    htmlElement.style[setting] = value + \"px\";\r\n                }\r\n                else {\r\n                    htmlElement.style[setting] = \"\";\r\n                }\r\n            });\r\n            const strtingSettings = [\r\n                \"fontFamily\",\r\n                \"fontSize\",\r\n                \"fontStyle\",\r\n                \"fontWeight\",\r\n                \"fontStyle\",\r\n                \"fontVariant\",\r\n                \"textDecoration\"\r\n            ];\r\n            $array.each(strtingSettings, (setting) => {\r\n                const value = target.get(setting);\r\n                if (value) {\r\n                    if (setting == \"fontSize\" && !$type.isString(value)) {\r\n                        htmlElement.style[setting] = value + \"px\";\r\n                    }\r\n                    else {\r\n                        htmlElement.style[setting] = value + \"\";\r\n                    }\r\n                }\r\n                else {\r\n                    htmlElement.style[setting] = \"\";\r\n                }\r\n            });\r\n            // Init and reset scale / rotation\r\n            const scale = target.compositeScale() || 1;\r\n            const rotation = target.compositeRotation() || 0;\r\n            htmlElement.style.transform = \"\";\r\n            htmlElement.style.transformOrigin = \"\";\r\n            // Deal with opacity\r\n            const opacity = target.compositeOpacity();\r\n            setTimeout(() => {\r\n                htmlElement.style.opacity = opacity + \"\";\r\n            }, 10);\r\n            const visible = target.isVisibleDeep();\r\n            if (visible) {\r\n                htmlElement.style.display = \"block\";\r\n            }\r\n            // Deal with position\r\n            // const bounds = target.globalBounds();\r\n            // htmlElement.style.top = (bounds.top) + \"px\";\r\n            // htmlElement.style.left = (bounds.left) + \"px\";\r\n            let pos = {\r\n                x: target.x() + target.get(\"dx\", 0),\r\n                y: target.y() + target.get(\"dy\", 0)\r\n            };\r\n            if (target.parent) {\r\n                pos = target.parent.toGlobal(pos);\r\n            }\r\n            htmlElement.style.top = pos.y + \"px\";\r\n            htmlElement.style.left = pos.x + \"px\";\r\n            // Use width/height if those are set\r\n            const width = target.get(\"width\");\r\n            const height = target.get(\"height\");\r\n            let w = 0;\r\n            let h = 0;\r\n            if (width) {\r\n                w = target.width();\r\n            }\r\n            if (height) {\r\n                h = target.height();\r\n            }\r\n            if (!width || !height) {\r\n                htmlElement.style.position = \"fixed\";\r\n                htmlElement.style.width = \"\";\r\n                htmlElement.style.height = \"\";\r\n                const bbox = htmlElement.getBoundingClientRect();\r\n                htmlElement.style.position = \"absolute\";\r\n                if (!width)\r\n                    w = bbox.width;\r\n                if (!height)\r\n                    h = bbox.height;\r\n                let lw = w / scale;\r\n                let lh = h / scale;\r\n                let cx = target.get(\"centerX\", 0);\r\n                let cy = target.get(\"centerY\", 0);\r\n                let ll = 0;\r\n                let lr = 0;\r\n                let lt = 0;\r\n                let lb = 0;\r\n                if (cx instanceof Percent) {\r\n                    ll = -cx.value * lw;\r\n                    lr = (1 - cx.value) * lw;\r\n                }\r\n                else {\r\n                    ll = -cx;\r\n                    lr = lw - cx;\r\n                }\r\n                if (cy instanceof Percent) {\r\n                    lt = -cy.value * lh;\r\n                    lb = (1 - cy.value) * lh;\r\n                }\r\n                else {\r\n                    lt = -cy;\r\n                    lb = lh - cy;\r\n                }\r\n                target._localBounds = { left: ll, right: lr, top: lt, bottom: lb };\r\n                let previousBounds = target._adjustedLocalBounds;\r\n                let newBounds = target._display.getAdjustedBounds(target._localBounds);\r\n                target._adjustedLocalBounds = newBounds;\r\n                // compare each value of the bounds\r\n                if (previousBounds.left !== newBounds.left || previousBounds.right !== newBounds.right || previousBounds.top !== newBounds.top || previousBounds.bottom !== newBounds.bottom) {\r\n                    target.markDirtyBounds();\r\n                }\r\n            }\r\n            if (w > 0) {\r\n                htmlElement.style.minWidth = (w) + \"px\";\r\n            }\r\n            if (h > 0) {\r\n                htmlElement.style.minHeight = (h) + \"px\";\r\n            }\r\n            // Hide or show\r\n            if (!visible || opacity == 0) {\r\n                htmlElement.style.display = \"none\";\r\n            }\r\n            // Center position\r\n            const x = target.get(\"centerX\", 0);\r\n            const originX = isPercent(x) ? x.percent + \"%\" : x + \"px\";\r\n            const y = target.get(\"centerY\", 0);\r\n            const originY = isPercent(y) ? y.percent + \"%\" : y + \"px\";\r\n            if (x || y) {\r\n                htmlElement.style.transform = \"translate(-\" + originX + \", -\" + originY + \")\" + htmlElement.style.transform;\r\n            }\r\n            // Deal with scale\r\n            if (scale != 1) {\r\n                htmlElement.style.transform += \"scale(\" + scale + \")\";\r\n            }\r\n            if (rotation != 0) {\r\n                htmlElement.style.transform += \" rotate(\" + rotation + \"deg)\";\r\n            }\r\n            if (htmlElement.style.transform != \"\") {\r\n                htmlElement.style.transformOrigin = originX + \" \" + originY;\r\n                //htmlElement.style.transformOrigin = \"0% 0%\";\r\n            }\r\n        }\r\n    }\r\n    _setHTMLContent(target, html) {\r\n        let htmlElement = target.getPrivate(\"htmlElement\");\r\n        if (!htmlElement) {\r\n            htmlElement = this._makeHTMLElement(target);\r\n            if (!this.autoResize) {\r\n                this.resize();\r\n            }\r\n        }\r\n        if (htmlElement.innerHTML != html) {\r\n            htmlElement.innerHTML = html;\r\n        }\r\n    }\r\n    _removeHTMLContent(target) {\r\n        const htmlElementWrapper = target.getPrivate(\"htmlElementWrapper\");\r\n        const htmlElement = target.getPrivate(\"htmlElement\");\r\n        if (htmlElementWrapper) {\r\n            this._htmlElementContainer.removeChild(htmlElementWrapper);\r\n            target.removePrivate(\"htmlElement\");\r\n            target.removePrivate(\"htmlElementWrapper\");\r\n            target.removePrivate(\"wrapperContainer\");\r\n        }\r\n        else if (htmlElement) {\r\n            this._htmlElementContainer.removeChild(htmlElement);\r\n            target.removePrivate(\"htmlElement\");\r\n            target.removePrivate(\"wrapperContainer\");\r\n        }\r\n        $array.remove(this._htmlEnabledContainers, target);\r\n    }\r\n}\r\n//# sourceMappingURL=Root.js.map","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{Root as a,addLicense as s}from\"@amcharts/amcharts5/index.js\";import\"../../intl.js\";import{getLocale as t,getLocaleLanguage as r}from\"../../intl/locale.js\";s(\"AM5C241025748\");const c=\"en-US\",m=new Map([[\"ar\",()=>import(\"@amcharts/amcharts5/locales/ar.js\")],[\"bg-BG\",()=>import(\"@amcharts/amcharts5/locales/bg_BG.js\")],[\"bs-BA\",()=>import(\"@amcharts/amcharts5/locales/bs_BA.js\")],[\"ca-ES\",()=>import(\"@amcharts/amcharts5/locales/ca_ES.js\")],[\"cs-CZ\",()=>import(\"@amcharts/amcharts5/locales/cs_CZ.js\")],[\"da-DK\",()=>import(\"@amcharts/amcharts5/locales/da_DK.js\")],[\"de-DE\",()=>import(\"@amcharts/amcharts5/locales/de_DE.js\")],[\"de-CH\",()=>import(\"@amcharts/amcharts5/locales/de_CH.js\")],[\"el-GR\",()=>import(\"@amcharts/amcharts5/locales/el_GR.js\")],[\"en-US\",()=>import(\"@amcharts/amcharts5/locales/en_US.js\")],[\"en-CA\",()=>import(\"@amcharts/amcharts5/locales/en_CA.js\")],[\"es-ES\",()=>import(\"@amcharts/amcharts5/locales/es_ES.js\")],[\"et-EE\",()=>import(\"@amcharts/amcharts5/locales/et_EE.js\")],[\"fi-FI\",()=>import(\"@amcharts/amcharts5/locales/fi_FI.js\")],[\"fr-FR\",()=>import(\"@amcharts/amcharts5/locales/fr_FR.js\")],[\"he-IL\",()=>import(\"@amcharts/amcharts5/locales/he_IL.js\")],[\"hr-HR\",()=>import(\"@amcharts/amcharts5/locales/hr_HR.js\")],[\"hu-HU\",()=>import(\"@amcharts/amcharts5/locales/hu_HU.js\")],[\"id-ID\",()=>import(\"@amcharts/amcharts5/locales/id_ID.js\")],[\"it-IT\",()=>import(\"@amcharts/amcharts5/locales/it_IT.js\")],[\"ja-JP\",()=>import(\"@amcharts/amcharts5/locales/ja_JP.js\")],[\"ko-KR\",()=>import(\"@amcharts/amcharts5/locales/ko_KR.js\")],[\"lt-LT\",()=>import(\"@amcharts/amcharts5/locales/lt_LT.js\")],[\"lv-LV\",()=>import(\"@amcharts/amcharts5/locales/lv_LV.js\")],[\"no-NO\",()=>import(\"@amcharts/amcharts5/locales/nb_NO.js\")],[\"nb-NO\",()=>import(\"@amcharts/amcharts5/locales/nb_NO.js\")],[\"nl-NL\",()=>import(\"@amcharts/amcharts5/locales/nl_NL.js\")],[\"pl-PL\",()=>import(\"@amcharts/amcharts5/locales/pl_PL.js\")],[\"pt-BR\",()=>import(\"@amcharts/amcharts5/locales/pt_BR.js\")],[\"pt-PT\",()=>import(\"@amcharts/amcharts5/locales/pt_PT.js\")],[\"ro-RO\",()=>import(\"@amcharts/amcharts5/locales/ro_RO.js\")],[\"ru-RU\",()=>import(\"@amcharts/amcharts5/locales/ru_RU.js\")],[\"sk-SK\",()=>import(\"@amcharts/amcharts5/locales/sk_SK.js\")],[\"sl-SL\",()=>import(\"@amcharts/amcharts5/locales/sl_SL.js\")],[\"sr-RS\",()=>import(\"@amcharts/amcharts5/locales/sr_RS.js\")],[\"sv-SE\",()=>import(\"@amcharts/amcharts5/locales/sv_SE.js\")],[\"th-TH\",()=>import(\"@amcharts/amcharts5/locales/th_TH.js\")],[\"tr-TR\",()=>import(\"@amcharts/amcharts5/locales/tr_TR.js\")],[\"uk-UA\",()=>import(\"@amcharts/amcharts5/locales/uk_UA.js\")],[\"vi-VN\",()=>import(\"@amcharts/amcharts5/locales/vi_VN.js\")],[\"zh-CN\",()=>import(\"@amcharts/amcharts5/locales/zh_Hans.js\")],[\"zh-HK\",()=>import(\"@amcharts/amcharts5/locales/zh_Hant.js\")],[\"zh-TW\",()=>import(\"@amcharts/amcharts5/locales/zh_Hant.js\")]]);function l(a){const s=r(a);if(!s)return null;for(const t of m.keys()){if(r(t)===s)return t}return null}function o(a){return a?m.has(a)?a:l(a)??c:c}async function h(s,r=t()){const c=a.new(s);return c.locale=(await m.get(o(r))()).default,c}export{h as createRoot};\n"],"file":"chartUtilsAm5-DxA_Wc8J.js"}