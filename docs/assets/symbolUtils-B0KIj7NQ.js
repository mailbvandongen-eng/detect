const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/visualVariableUtils-CdKCpK8I.js","assets/index-rTQ1u7hy.js","assets/index-GdtOY_-u.css","assets/lengthUtils-B9ItfLyi.js"])))=>i.map(i=>d[i]);
import{aB as g,iR as F,bA as _,z as L,gR as z}from"./index-rTQ1u7hy.js";import{L as c,M as k,N as O}from"./utils-fqHjg4RR.js";import"./vec42-DQwOOmhl.js";import"./vec4f64-DPb6J-GU.js";import"./defaults3D-CQEpaIH_.js";const m=g("android");g("chrome")||m&&m>=4;F();function h(e){return e&&e.opacity!==void 0?e.opacity*("parent"in e?h(e.parent):1):1}async function B(e,a){if(!e)return;const u=e.sourceLayer,y=(a!=null&&a.useSourceLayer?u:e.layer)??u,l=a?.ignoreOpacity?1:h(y);if(e.symbol!=null&&(a==null||a.ignoreGraphicSymbol!==!0)){const r=e.symbol.type==="web-style"?await e.symbol.fetchSymbol({...a,acceptedFormats:a?.webStyleAcceptedFormats,cache:a?.webStyleCache}):e.symbol.clone();return c(r,null,{add:l}),r}const o=a?.renderer??q(y);let i=o&&"getSymbolAsync"in o?await o.getSymbolAsync(e,a):null;if(!i)return;if(i=i.type==="web-style"?await i.fetchSymbol({...a,acceptedFormats:a?.webStyleAcceptedFormats,cache:a?.webStyleCache}):i.clone(),!(o&&"visualVariables"in o&&o.visualVariables?.length&&C(i)))return c(i,null,{add:l}),i;if("arcadeRequiredForVisualVariables"in o&&o.arcadeRequiredForVisualVariables&&a?.arcade==null){const r={...a};r.arcade=await _(),a=r}const{getColor:f,getOpacity:w,getAllSizes:S,getRotationAngle:v}=await L(()=>import("./visualVariableUtils-CdKCpK8I.js").then(r=>r.v),__vite__mapDeps([0,1,2,3])),t=[],n=[],s=[],b=[];for(const r of o.visualVariables)switch(r.type){case"color":t.push(r);break;case"opacity":n.push(r);break;case"rotation":b.push(r);break;case"size":r.target||s.push(r)}const p=!!t.length&&t[t.length-1],V=p?f(p,e,a):null,A=!!a?.ignoreOpacity,d=!!n.length&&n[n.length-1],R=d?w(d,e,a):null;if(c(i,V,A?void 0:{override:R,add:l}),s.length&&a?.ignoreSizeVariables!==!0){const r=S(s,e,a);await k(i,r)}if(a?.ignoreRotationVariables!==!0)for(const r of b)O(i,v(r,e,a),r.axis);return i}function C(e){return!z(e)||e.symbolLayers.at(0)?.type!=="water"}function q(e){if(e)return"renderer"in e?e.renderer:void 0}export{B as F};
//# sourceMappingURL=symbolUtils-B0KIj7NQ.js.map
