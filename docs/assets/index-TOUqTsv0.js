const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/amkOL-Bjx37vW9.js","assets/layerLoaderOL-0TLH2pjL.js","assets/romeinsOL-DxALkPpa.js","assets/kastelenOL-B_6W889U.js","assets/iconStyles-BOv34gqy.js","assets/hunebeddenOL-DFSfrKYL.js","assets/uikavArcheoPuntenOL-DQ3prAUj.js","assets/proj4-maCm0_8C.js","assets/uikavVlakkenOL-BRooJep4.js","assets/uikavBufferlaagOL-D36_satW.js","assets/uikavExpertOL-K2qBB0JZ.js","assets/uikavUiterwaardenOL-CcvxIOcM.js","assets/speeltuinenOL-qsY9d8L-.js","assets/museaOL-Bvfzh4_2.js","assets/strandjesOL-6rs0zR3P.js","assets/parkenOL-D_bjUK6p.js","assets/fossielenOL-ZOiJ5UuO.js","assets/fossielUtils-BNPlCGoK.js","assets/fossielenBelgieOL-BwJfFyy-.js","assets/fossielenDuitslandOL-B4-PI6dT.js","assets/fossielenFrankrijkOL-DVGcZkkD.js","assets/bunkersOL-DfJtaUpb.js","assets/grafheuvelsOL-CJbRndbK.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();function sx(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var a1={exports:{}},Gd={},l1={exports:{}},tt={};var nR;function C5(){if(nR)return tt;nR=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),o=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),g=Symbol.iterator;function m(V){return V===null||typeof V!="object"?null:(V=g&&V[g]||V["@@iterator"],typeof V=="function"?V:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,T={};function E(V,I,de){this.props=V,this.context=I,this.refs=T,this.updater=de||y}E.prototype.isReactComponent={},E.prototype.setState=function(V,I){if(typeof V!="object"&&typeof V!="function"&&V!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,V,I,"setState")},E.prototype.forceUpdate=function(V){this.updater.enqueueForceUpdate(this,V,"forceUpdate")};function P(){}P.prototype=E.prototype;function M(V,I,de){this.props=V,this.context=I,this.refs=T,this.updater=de||y}var N=M.prototype=new P;N.constructor=M,w(N,E.prototype),N.isPureReactComponent=!0;var D=Array.isArray,j=Object.prototype.hasOwnProperty,W={current:null},L={key:!0,ref:!0,__self:!0,__source:!0};function A(V,I,de){var q,fe={},X=null,F=null;if(I!=null)for(q in I.ref!==void 0&&(F=I.ref),I.key!==void 0&&(X=""+I.key),I)j.call(I,q)&&!L.hasOwnProperty(q)&&(fe[q]=I[q]);var te=arguments.length-2;if(te===1)fe.children=de;else if(1<te){for(var Pe=Array(te),Be=0;Be<te;Be++)Pe[Be]=arguments[Be+2];fe.children=Pe}if(V&&V.defaultProps)for(q in te=V.defaultProps,te)fe[q]===void 0&&(fe[q]=te[q]);return{$$typeof:n,type:V,key:X,ref:F,props:fe,_owner:W.current}}function k(V,I){return{$$typeof:n,type:V.type,key:I,ref:V.ref,props:V.props,_owner:V._owner}}function U(V){return typeof V=="object"&&V!==null&&V.$$typeof===n}function B(V){var I={"=":"=0",":":"=2"};return"$"+V.replace(/[=:]/g,function(de){return I[de]})}var z=/\/+/g;function O(V,I){return typeof V=="object"&&V!==null&&V.key!=null?B(""+V.key):I.toString(36)}function oe(V,I,de,q,fe){var X=typeof V;(X==="undefined"||X==="boolean")&&(V=null);var F=!1;if(V===null)F=!0;else switch(X){case"string":case"number":F=!0;break;case"object":switch(V.$$typeof){case n:case e:F=!0}}if(F)return F=V,fe=fe(F),V=q===""?"."+O(F,0):q,D(fe)?(de="",V!=null&&(de=V.replace(z,"$&/")+"/"),oe(fe,I,de,"",function(Be){return Be})):fe!=null&&(U(fe)&&(fe=k(fe,de+(!fe.key||F&&F.key===fe.key?"":(""+fe.key).replace(z,"$&/")+"/")+V)),I.push(fe)),1;if(F=0,q=q===""?".":q+":",D(V))for(var te=0;te<V.length;te++){X=V[te];var Pe=q+O(X,te);F+=oe(X,I,de,Pe,fe)}else if(Pe=m(V),typeof Pe=="function")for(V=Pe.call(V),te=0;!(X=V.next()).done;)X=X.value,Pe=q+O(X,te++),F+=oe(X,I,de,Pe,fe);else if(X==="object")throw I=String(V),Error("Objects are not valid as a React child (found: "+(I==="[object Object]"?"object with keys {"+Object.keys(V).join(", ")+"}":I)+"). If you meant to render a collection of children, use an array instead.");return F}function Te(V,I,de){if(V==null)return V;var q=[],fe=0;return oe(V,q,"","",function(X){return I.call(de,X,fe++)}),q}function we(V){if(V._status===-1){var I=V._result;I=I(),I.then(function(de){(V._status===0||V._status===-1)&&(V._status=1,V._result=de)},function(de){(V._status===0||V._status===-1)&&(V._status=2,V._result=de)}),V._status===-1&&(V._status=0,V._result=I)}if(V._status===1)return V._result.default;throw V._result}var _e={current:null},Q={transition:null},ce={ReactCurrentDispatcher:_e,ReactCurrentBatchConfig:Q,ReactCurrentOwner:W};function K(){throw Error("act(...) is not supported in production builds of React.")}return tt.Children={map:Te,forEach:function(V,I,de){Te(V,function(){I.apply(this,arguments)},de)},count:function(V){var I=0;return Te(V,function(){I++}),I},toArray:function(V){return Te(V,function(I){return I})||[]},only:function(V){if(!U(V))throw Error("React.Children.only expected to receive a single React element child.");return V}},tt.Component=E,tt.Fragment=t,tt.Profiler=r,tt.PureComponent=M,tt.StrictMode=i,tt.Suspense=c,tt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ce,tt.act=K,tt.cloneElement=function(V,I,de){if(V==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+V+".");var q=w({},V.props),fe=V.key,X=V.ref,F=V._owner;if(I!=null){if(I.ref!==void 0&&(X=I.ref,F=W.current),I.key!==void 0&&(fe=""+I.key),V.type&&V.type.defaultProps)var te=V.type.defaultProps;for(Pe in I)j.call(I,Pe)&&!L.hasOwnProperty(Pe)&&(q[Pe]=I[Pe]===void 0&&te!==void 0?te[Pe]:I[Pe])}var Pe=arguments.length-2;if(Pe===1)q.children=de;else if(1<Pe){te=Array(Pe);for(var Be=0;Be<Pe;Be++)te[Be]=arguments[Be+2];q.children=te}return{$$typeof:n,type:V.type,key:fe,ref:X,props:q,_owner:F}},tt.createContext=function(V){return V={$$typeof:o,_currentValue:V,_currentValue2:V,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},V.Provider={$$typeof:s,_context:V},V.Consumer=V},tt.createElement=A,tt.createFactory=function(V){var I=A.bind(null,V);return I.type=V,I},tt.createRef=function(){return{current:null}},tt.forwardRef=function(V){return{$$typeof:a,render:V}},tt.isValidElement=U,tt.lazy=function(V){return{$$typeof:d,_payload:{_status:-1,_result:V},_init:we}},tt.memo=function(V,I){return{$$typeof:h,type:V,compare:I===void 0?null:I}},tt.startTransition=function(V){var I=Q.transition;Q.transition={};try{V()}finally{Q.transition=I}},tt.unstable_act=K,tt.useCallback=function(V,I){return _e.current.useCallback(V,I)},tt.useContext=function(V){return _e.current.useContext(V)},tt.useDebugValue=function(){},tt.useDeferredValue=function(V){return _e.current.useDeferredValue(V)},tt.useEffect=function(V,I){return _e.current.useEffect(V,I)},tt.useId=function(){return _e.current.useId()},tt.useImperativeHandle=function(V,I,de){return _e.current.useImperativeHandle(V,I,de)},tt.useInsertionEffect=function(V,I){return _e.current.useInsertionEffect(V,I)},tt.useLayoutEffect=function(V,I){return _e.current.useLayoutEffect(V,I)},tt.useMemo=function(V,I){return _e.current.useMemo(V,I)},tt.useReducer=function(V,I,de){return _e.current.useReducer(V,I,de)},tt.useRef=function(V){return _e.current.useRef(V)},tt.useState=function(V){return _e.current.useState(V)},tt.useSyncExternalStore=function(V,I,de){return _e.current.useSyncExternalStore(V,I,de)},tt.useTransition=function(){return _e.current.useTransition()},tt.version="18.3.1",tt}var iR;function Mg(){return iR||(iR=1,l1.exports=C5()),l1.exports}var rR;function M5(){if(rR)return Gd;rR=1;var n=Mg(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,r=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function o(a,c,h){var d,g={},m=null,y=null;h!==void 0&&(m=""+h),c.key!==void 0&&(m=""+c.key),c.ref!==void 0&&(y=c.ref);for(d in c)i.call(c,d)&&!s.hasOwnProperty(d)&&(g[d]=c[d]);if(a&&a.defaultProps)for(d in c=a.defaultProps,c)g[d]===void 0&&(g[d]=c[d]);return{$$typeof:e,type:a,key:m,ref:y,props:g,_owner:r.current}}return Gd.Fragment=t,Gd.jsx=o,Gd.jsxs=o,Gd}var sR;function b5(){return sR||(sR=1,a1.exports=M5()),a1.exports}var C=b5(),xp={},c1={exports:{}},Ci={},u1={exports:{}},h1={};var oR;function k5(){return oR||(oR=1,(function(n){function e(Q,ce){var K=Q.length;Q.push(ce);e:for(;0<K;){var V=K-1>>>1,I=Q[V];if(0<r(I,ce))Q[V]=ce,Q[K]=I,K=V;else break e}}function t(Q){return Q.length===0?null:Q[0]}function i(Q){if(Q.length===0)return null;var ce=Q[0],K=Q.pop();if(K!==ce){Q[0]=K;e:for(var V=0,I=Q.length,de=I>>>1;V<de;){var q=2*(V+1)-1,fe=Q[q],X=q+1,F=Q[X];if(0>r(fe,K))X<I&&0>r(F,fe)?(Q[V]=F,Q[X]=K,V=X):(Q[V]=fe,Q[q]=K,V=q);else if(X<I&&0>r(F,K))Q[V]=F,Q[X]=K,V=X;else break e}}return ce}function r(Q,ce){var K=Q.sortIndex-ce.sortIndex;return K!==0?K:Q.id-ce.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var c=[],h=[],d=1,g=null,m=3,y=!1,w=!1,T=!1,E=typeof setTimeout=="function"?setTimeout:null,P=typeof clearTimeout=="function"?clearTimeout:null,M=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function N(Q){for(var ce=t(h);ce!==null;){if(ce.callback===null)i(h);else if(ce.startTime<=Q)i(h),ce.sortIndex=ce.expirationTime,e(c,ce);else break;ce=t(h)}}function D(Q){if(T=!1,N(Q),!w)if(t(c)!==null)w=!0,we(j);else{var ce=t(h);ce!==null&&_e(D,ce.startTime-Q)}}function j(Q,ce){w=!1,T&&(T=!1,P(A),A=-1),y=!0;var K=m;try{for(N(ce),g=t(c);g!==null&&(!(g.expirationTime>ce)||Q&&!B());){var V=g.callback;if(typeof V=="function"){g.callback=null,m=g.priorityLevel;var I=V(g.expirationTime<=ce);ce=n.unstable_now(),typeof I=="function"?g.callback=I:g===t(c)&&i(c),N(ce)}else i(c);g=t(c)}if(g!==null)var de=!0;else{var q=t(h);q!==null&&_e(D,q.startTime-ce),de=!1}return de}finally{g=null,m=K,y=!1}}var W=!1,L=null,A=-1,k=5,U=-1;function B(){return!(n.unstable_now()-U<k)}function z(){if(L!==null){var Q=n.unstable_now();U=Q;var ce=!0;try{ce=L(!0,Q)}finally{ce?O():(W=!1,L=null)}}else W=!1}var O;if(typeof M=="function")O=function(){M(z)};else if(typeof MessageChannel<"u"){var oe=new MessageChannel,Te=oe.port2;oe.port1.onmessage=z,O=function(){Te.postMessage(null)}}else O=function(){E(z,0)};function we(Q){L=Q,W||(W=!0,O())}function _e(Q,ce){A=E(function(){Q(n.unstable_now())},ce)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(Q){Q.callback=null},n.unstable_continueExecution=function(){w||y||(w=!0,we(j))},n.unstable_forceFrameRate=function(Q){0>Q||125<Q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<Q?Math.floor(1e3/Q):5},n.unstable_getCurrentPriorityLevel=function(){return m},n.unstable_getFirstCallbackNode=function(){return t(c)},n.unstable_next=function(Q){switch(m){case 1:case 2:case 3:var ce=3;break;default:ce=m}var K=m;m=ce;try{return Q()}finally{m=K}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(Q,ce){switch(Q){case 1:case 2:case 3:case 4:case 5:break;default:Q=3}var K=m;m=Q;try{return ce()}finally{m=K}},n.unstable_scheduleCallback=function(Q,ce,K){var V=n.unstable_now();switch(typeof K=="object"&&K!==null?(K=K.delay,K=typeof K=="number"&&0<K?V+K:V):K=V,Q){case 1:var I=-1;break;case 2:I=250;break;case 5:I=1073741823;break;case 4:I=1e4;break;default:I=5e3}return I=K+I,Q={id:d++,callback:ce,priorityLevel:Q,startTime:K,expirationTime:I,sortIndex:-1},K>V?(Q.sortIndex=K,e(h,Q),t(c)===null&&Q===t(h)&&(T?(P(A),A=-1):T=!0,_e(D,K-V))):(Q.sortIndex=I,e(c,Q),w||y||(w=!0,we(j))),Q},n.unstable_shouldYield=B,n.unstable_wrapCallback=function(Q){var ce=m;return function(){var K=m;m=ce;try{return Q.apply(this,arguments)}finally{m=K}}}})(h1)),h1}var aR;function L5(){return aR||(aR=1,u1.exports=k5()),u1.exports}var lR;function N5(){if(lR)return Ci;lR=1;var n=Mg(),e=L5();function t(l){for(var u="https://reactjs.org/docs/error-decoder.html?invariant="+l,f=1;f<arguments.length;f++)u+="&args[]="+encodeURIComponent(arguments[f]);return"Minified React error #"+l+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,r={};function s(l,u){o(l,u),o(l+"Capture",u)}function o(l,u){for(r[l]=u,l=0;l<u.length;l++)i.add(u[l])}var a=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),c=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d={},g={};function m(l){return c.call(g,l)?!0:c.call(d,l)?!1:h.test(l)?g[l]=!0:(d[l]=!0,!1)}function y(l,u,f,_){if(f!==null&&f.type===0)return!1;switch(typeof u){case"function":case"symbol":return!0;case"boolean":return _?!1:f!==null?!f.acceptsBooleans:(l=l.toLowerCase().slice(0,5),l!=="data-"&&l!=="aria-");default:return!1}}function w(l,u,f,_){if(u===null||typeof u>"u"||y(l,u,f,_))return!0;if(_)return!1;if(f!==null)switch(f.type){case 3:return!u;case 4:return u===!1;case 5:return isNaN(u);case 6:return isNaN(u)||1>u}return!1}function T(l,u,f,_,v,x,b){this.acceptsBooleans=u===2||u===3||u===4,this.attributeName=_,this.attributeNamespace=v,this.mustUseProperty=f,this.propertyName=l,this.type=u,this.sanitizeURL=x,this.removeEmptyString=b}var E={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(l){E[l]=new T(l,0,!1,l,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(l){var u=l[0];E[u]=new T(u,1,!1,l[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(l){E[l]=new T(l,2,!1,l.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(l){E[l]=new T(l,2,!1,l,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(l){E[l]=new T(l,3,!1,l.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(l){E[l]=new T(l,3,!0,l,null,!1,!1)}),["capture","download"].forEach(function(l){E[l]=new T(l,4,!1,l,null,!1,!1)}),["cols","rows","size","span"].forEach(function(l){E[l]=new T(l,6,!1,l,null,!1,!1)}),["rowSpan","start"].forEach(function(l){E[l]=new T(l,5,!1,l.toLowerCase(),null,!1,!1)});var P=/[\-:]([a-z])/g;function M(l){return l[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(l){var u=l.replace(P,M);E[u]=new T(u,1,!1,l,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(l){var u=l.replace(P,M);E[u]=new T(u,1,!1,l,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(l){var u=l.replace(P,M);E[u]=new T(u,1,!1,l,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(l){E[l]=new T(l,1,!1,l.toLowerCase(),null,!1,!1)}),E.xlinkHref=new T("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(l){E[l]=new T(l,1,!1,l.toLowerCase(),null,!0,!0)});function N(l,u,f,_){var v=E.hasOwnProperty(u)?E[u]:null;(v!==null?v.type!==0:_||!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(w(u,f,v,_)&&(f=null),_||v===null?m(u)&&(f===null?l.removeAttribute(u):l.setAttribute(u,""+f)):v.mustUseProperty?l[v.propertyName]=f===null?v.type===3?!1:"":f:(u=v.attributeName,_=v.attributeNamespace,f===null?l.removeAttribute(u):(v=v.type,f=v===3||v===4&&f===!0?"":""+f,_?l.setAttributeNS(_,u,f):l.setAttribute(u,f))))}var D=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,j=Symbol.for("react.element"),W=Symbol.for("react.portal"),L=Symbol.for("react.fragment"),A=Symbol.for("react.strict_mode"),k=Symbol.for("react.profiler"),U=Symbol.for("react.provider"),B=Symbol.for("react.context"),z=Symbol.for("react.forward_ref"),O=Symbol.for("react.suspense"),oe=Symbol.for("react.suspense_list"),Te=Symbol.for("react.memo"),we=Symbol.for("react.lazy"),_e=Symbol.for("react.offscreen"),Q=Symbol.iterator;function ce(l){return l===null||typeof l!="object"?null:(l=Q&&l[Q]||l["@@iterator"],typeof l=="function"?l:null)}var K=Object.assign,V;function I(l){if(V===void 0)try{throw Error()}catch(f){var u=f.stack.trim().match(/\n( *(at )?)/);V=u&&u[1]||""}return`
`+V+l}var de=!1;function q(l,u){if(!l||de)return"";de=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(u)if(u=function(){throw Error()},Object.defineProperty(u.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(u,[])}catch(ie){var _=ie}Reflect.construct(l,[],u)}else{try{u.call()}catch(ie){_=ie}l.call(u.prototype)}else{try{throw Error()}catch(ie){_=ie}l()}}catch(ie){if(ie&&_&&typeof ie.stack=="string"){for(var v=ie.stack.split(`
`),x=_.stack.split(`
`),b=v.length-1,$=x.length-1;1<=b&&0<=$&&v[b]!==x[$];)$--;for(;1<=b&&0<=$;b--,$--)if(v[b]!==x[$]){if(b!==1||$!==1)do if(b--,$--,0>$||v[b]!==x[$]){var H=`
`+v[b].replace(" at new "," at ");return l.displayName&&H.includes("<anonymous>")&&(H=H.replace("<anonymous>",l.displayName)),H}while(1<=b&&0<=$);break}}}finally{de=!1,Error.prepareStackTrace=f}return(l=l?l.displayName||l.name:"")?I(l):""}function fe(l){switch(l.tag){case 5:return I(l.type);case 16:return I("Lazy");case 13:return I("Suspense");case 19:return I("SuspenseList");case 0:case 2:case 15:return l=q(l.type,!1),l;case 11:return l=q(l.type.render,!1),l;case 1:return l=q(l.type,!0),l;default:return""}}function X(l){if(l==null)return null;if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l;switch(l){case L:return"Fragment";case W:return"Portal";case k:return"Profiler";case A:return"StrictMode";case O:return"Suspense";case oe:return"SuspenseList"}if(typeof l=="object")switch(l.$$typeof){case B:return(l.displayName||"Context")+".Consumer";case U:return(l._context.displayName||"Context")+".Provider";case z:var u=l.render;return l=l.displayName,l||(l=u.displayName||u.name||"",l=l!==""?"ForwardRef("+l+")":"ForwardRef"),l;case Te:return u=l.displayName||null,u!==null?u:X(l.type)||"Memo";case we:u=l._payload,l=l._init;try{return X(l(u))}catch{}}return null}function F(l){var u=l.type;switch(l.tag){case 24:return"Cache";case 9:return(u.displayName||"Context")+".Consumer";case 10:return(u._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return l=u.render,l=l.displayName||l.name||"",u.displayName||(l!==""?"ForwardRef("+l+")":"ForwardRef");case 7:return"Fragment";case 5:return u;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return X(u);case 8:return u===A?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof u=="function")return u.displayName||u.name||null;if(typeof u=="string")return u}return null}function te(l){switch(typeof l){case"boolean":case"number":case"string":case"undefined":return l;case"object":return l;default:return""}}function Pe(l){var u=l.type;return(l=l.nodeName)&&l.toLowerCase()==="input"&&(u==="checkbox"||u==="radio")}function Be(l){var u=Pe(l)?"checked":"value",f=Object.getOwnPropertyDescriptor(l.constructor.prototype,u),_=""+l[u];if(!l.hasOwnProperty(u)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var v=f.get,x=f.set;return Object.defineProperty(l,u,{configurable:!0,get:function(){return v.call(this)},set:function(b){_=""+b,x.call(this,b)}}),Object.defineProperty(l,u,{enumerable:f.enumerable}),{getValue:function(){return _},setValue:function(b){_=""+b},stopTracking:function(){l._valueTracker=null,delete l[u]}}}}function Pt(l){l._valueTracker||(l._valueTracker=Be(l))}function Kn(l){if(!l)return!1;var u=l._valueTracker;if(!u)return!0;var f=u.getValue(),_="";return l&&(_=Pe(l)?l.checked?"true":"false":l.value),l=_,l!==f?(u.setValue(l),!0):!1}function bn(l){if(l=l||(typeof document<"u"?document:void 0),typeof l>"u")return null;try{return l.activeElement||l.body}catch{return l.body}}function xi(l,u){var f=u.checked;return K({},u,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:f??l._wrapperState.initialChecked})}function kn(l,u){var f=u.defaultValue==null?"":u.defaultValue,_=u.checked!=null?u.checked:u.defaultChecked;f=te(u.value!=null?u.value:f),l._wrapperState={initialChecked:_,initialValue:f,controlled:u.type==="checkbox"||u.type==="radio"?u.checked!=null:u.value!=null}}function Ln(l,u){u=u.checked,u!=null&&N(l,"checked",u,!1)}function Si(l,u){Ln(l,u);var f=te(u.value),_=u.type;if(f!=null)_==="number"?(f===0&&l.value===""||l.value!=f)&&(l.value=""+f):l.value!==""+f&&(l.value=""+f);else if(_==="submit"||_==="reset"){l.removeAttribute("value");return}u.hasOwnProperty("value")?Mt(l,u.type,f):u.hasOwnProperty("defaultValue")&&Mt(l,u.type,te(u.defaultValue)),u.checked==null&&u.defaultChecked!=null&&(l.defaultChecked=!!u.defaultChecked)}function ar(l,u,f){if(u.hasOwnProperty("value")||u.hasOwnProperty("defaultValue")){var _=u.type;if(!(_!=="submit"&&_!=="reset"||u.value!==void 0&&u.value!==null))return;u=""+l._wrapperState.initialValue,f||u===l.value||(l.value=u),l.defaultValue=u}f=l.name,f!==""&&(l.name=""),l.defaultChecked=!!l._wrapperState.initialChecked,f!==""&&(l.name=f)}function Mt(l,u,f){(u!=="number"||bn(l.ownerDocument)!==l)&&(f==null?l.defaultValue=""+l._wrapperState.initialValue:l.defaultValue!==""+f&&(l.defaultValue=""+f))}var vt=Array.isArray;function Sn(l,u,f,_){if(l=l.options,u){u={};for(var v=0;v<f.length;v++)u["$"+f[v]]=!0;for(f=0;f<l.length;f++)v=u.hasOwnProperty("$"+l[f].value),l[f].selected!==v&&(l[f].selected=v),v&&_&&(l[f].defaultSelected=!0)}else{for(f=""+te(f),u=null,v=0;v<l.length;v++){if(l[v].value===f){l[v].selected=!0,_&&(l[v].defaultSelected=!0);return}u!==null||l[v].disabled||(u=l[v])}u!==null&&(u.selected=!0)}}function lr(l,u){if(u.dangerouslySetInnerHTML!=null)throw Error(t(91));return K({},u,{value:void 0,defaultValue:void 0,children:""+l._wrapperState.initialValue})}function Gt(l,u){var f=u.value;if(f==null){if(f=u.children,u=u.defaultValue,f!=null){if(u!=null)throw Error(t(92));if(vt(f)){if(1<f.length)throw Error(t(93));f=f[0]}u=f}u==null&&(u=""),f=u}l._wrapperState={initialValue:te(f)}}function Oo(l,u){var f=te(u.value),_=te(u.defaultValue);f!=null&&(f=""+f,f!==l.value&&(l.value=f),u.defaultValue==null&&l.defaultValue!==f&&(l.defaultValue=f)),_!=null&&(l.defaultValue=""+_)}function cr(l){var u=l.textContent;u===l._wrapperState.initialValue&&u!==""&&u!==null&&(l.value=u)}function ts(l){switch(l){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Lr(l,u){return l==null||l==="http://www.w3.org/1999/xhtml"?ts(u):l==="http://www.w3.org/2000/svg"&&u==="foreignObject"?"http://www.w3.org/1999/xhtml":l}var ns,il=(function(l){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(u,f,_,v){MSApp.execUnsafeLocalFunction(function(){return l(u,f,_,v)})}:l})(function(l,u){if(l.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in l)l.innerHTML=u;else{for(ns=ns||document.createElement("div"),ns.innerHTML="<svg>"+u.valueOf().toString()+"</svg>",u=ns.firstChild;l.firstChild;)l.removeChild(l.firstChild);for(;u.firstChild;)l.appendChild(u.firstChild)}});function is(l,u){if(u){var f=l.firstChild;if(f&&f===l.lastChild&&f.nodeType===3){f.nodeValue=u;return}}l.textContent=u}var ur={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Gc=["Webkit","ms","Moz","O"];Object.keys(ur).forEach(function(l){Gc.forEach(function(u){u=u+l.charAt(0).toUpperCase()+l.substring(1),ur[u]=ur[l]})});function rs(l,u,f){return u==null||typeof u=="boolean"||u===""?"":f||typeof u!="number"||u===0||ur.hasOwnProperty(l)&&ur[l]?(""+u).trim():u+"px"}function zs(l,u){l=l.style;for(var f in u)if(u.hasOwnProperty(f)){var _=f.indexOf("--")===0,v=rs(f,u[f],_);f==="float"&&(f="cssFloat"),_?l.setProperty(f,v):l[f]=v}}var Do=K({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function hi(l,u){if(u){if(Do[l]&&(u.children!=null||u.dangerouslySetInnerHTML!=null))throw Error(t(137,l));if(u.dangerouslySetInnerHTML!=null){if(u.children!=null)throw Error(t(60));if(typeof u.dangerouslySetInnerHTML!="object"||!("__html"in u.dangerouslySetInnerHTML))throw Error(t(61))}if(u.style!=null&&typeof u.style!="object")throw Error(t(62))}}function $s(l,u){if(l.indexOf("-")===-1)return typeof u.is=="string";switch(l){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ss=null;function os(l){return l=l.target||l.srcElement||window,l.correspondingUseElement&&(l=l.correspondingUseElement),l.nodeType===3?l.parentNode:l}var di=null,fi=null,Tt=null;function Vo(l){if(l=Id(l)){if(typeof di!="function")throw Error(t(280));var u=l.stateNode;u&&(u=Vm(u),di(l.stateNode,l.type,u))}}function Nr(l){fi?Tt?Tt.push(l):Tt=[l]:fi=l}function en(){if(fi){var l=fi,u=Tt;if(Tt=fi=null,Vo(l),u)for(l=0;l<u.length;l++)Vo(u[l])}}function hr(l,u){return l(u)}function Nn(){}var tn=!1;function On(l,u,f){if(tn)return l(u,f);tn=!0;try{return hr(l,u,f)}finally{tn=!1,(fi!==null||Tt!==null)&&(Nn(),en())}}function Dn(l,u){var f=l.stateNode;if(f===null)return null;var _=Vm(f);if(_===null)return null;f=_[u];e:switch(u){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(_=!_.disabled)||(l=l.type,_=!(l==="button"||l==="input"||l==="select"||l==="textarea")),l=!_;break e;default:l=!1}if(l)return null;if(f&&typeof f!="function")throw Error(t(231,u,typeof f));return f}var In=!1;if(a)try{var dt={};Object.defineProperty(dt,"passive",{get:function(){In=!0}}),window.addEventListener("test",dt,dt),window.removeEventListener("test",dt,dt)}catch{In=!1}function cn(l,u,f,_,v,x,b,$,H){var ie=Array.prototype.slice.call(arguments,3);try{u.apply(f,ie)}catch(ge){this.onError(ge)}}var mn=!1,dr=null,jc=!1,fr=null,mm={onError:function(l){mn=!0,dr=l}};function pm(l,u,f,_,v,x,b,$,H){mn=!1,dr=null,cn.apply(mm,arguments)}function Zh(l,u,f,_,v,x,b,$,H){if(pm.apply(this,arguments),mn){if(mn){var ie=dr;mn=!1,dr=null}else throw Error(t(198));jc||(jc=!0,fr=ie)}}function Or(l){var u=l,f=l;if(l.alternate)for(;u.return;)u=u.return;else{l=u;do u=l,(u.flags&4098)!==0&&(f=u.return),l=u.return;while(l)}return u.tag===3?f:null}function Jh(l){if(l.tag===13){var u=l.memoizedState;if(u===null&&(l=l.alternate,l!==null&&(u=l.memoizedState)),u!==null)return u.dehydrated}return null}function _m(l){if(Or(l)!==l)throw Error(t(188))}function ym(l){var u=l.alternate;if(!u){if(u=Or(l),u===null)throw Error(t(188));return u!==l?null:l}for(var f=l,_=u;;){var v=f.return;if(v===null)break;var x=v.alternate;if(x===null){if(_=v.return,_!==null){f=_;continue}break}if(v.child===x.child){for(x=v.child;x;){if(x===f)return _m(v),l;if(x===_)return _m(v),u;x=x.sibling}throw Error(t(188))}if(f.return!==_.return)f=v,_=x;else{for(var b=!1,$=v.child;$;){if($===f){b=!0,f=v,_=x;break}if($===_){b=!0,_=v,f=x;break}$=$.sibling}if(!b){for($=x.child;$;){if($===f){b=!0,f=x,_=v;break}if($===_){b=!0,_=x,f=v;break}$=$.sibling}if(!b)throw Error(t(189))}}if(f.alternate!==_)throw Error(t(190))}if(f.tag!==3)throw Error(t(188));return f.stateNode.current===f?l:u}function vm(l){return l=ym(l),l!==null?rl(l):null}function rl(l){if(l.tag===5||l.tag===6)return l;for(l=l.child;l!==null;){var u=rl(l);if(u!==null)return u;l=l.sibling}return null}var ed=e.unstable_scheduleCallback,Uc=e.unstable_cancelCallback,sl=e.unstable_shouldYield,Ws=e.unstable_requestPaint,kt=e.unstable_now,Fy=e.unstable_getCurrentPriorityLevel,Bc=e.unstable_ImmediatePriority,td=e.unstable_UserBlockingPriority,ol=e.unstable_NormalPriority,nd=e.unstable_LowPriority,zc=e.unstable_IdlePriority,al=null,Bi=null;function Em(l){if(Bi&&typeof Bi.onCommitFiberRoot=="function")try{Bi.onCommitFiberRoot(al,l,void 0,(l.current.flags&128)===128)}catch{}}var zi=Math.clz32?Math.clz32:ll,as=Math.log,gr=Math.LN2;function ll(l){return l>>>=0,l===0?32:31-(as(l)/gr|0)|0}var ls=64,Fo=4194304;function ft(l){switch(l&-l){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return l&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return l}}function Hs(l,u){var f=l.pendingLanes;if(f===0)return 0;var _=0,v=l.suspendedLanes,x=l.pingedLanes,b=f&268435455;if(b!==0){var $=b&~v;$!==0?_=ft($):(x&=b,x!==0&&(_=ft(x)))}else b=f&~v,b!==0?_=ft(b):x!==0&&(_=ft(x));if(_===0)return 0;if(u!==0&&u!==_&&(u&v)===0&&(v=_&-_,x=u&-u,v>=x||v===16&&(x&4194240)!==0))return u;if((_&4)!==0&&(_|=f&16),u=l.entangledLanes,u!==0)for(l=l.entanglements,u&=_;0<u;)f=31-zi(u),v=1<<f,_|=l[f],u&=~v;return _}function cl(l,u){switch(l){case 1:case 2:case 4:return u+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ul(l,u){for(var f=l.suspendedLanes,_=l.pingedLanes,v=l.expirationTimes,x=l.pendingLanes;0<x;){var b=31-zi(x),$=1<<b,H=v[b];H===-1?(($&f)===0||($&_)!==0)&&(v[b]=cl($,u)):H<=u&&(l.expiredLanes|=$),x&=~$}}function id(l){return l=l.pendingLanes&-1073741825,l!==0?l:l&1073741824?1073741824:0}function rd(){var l=ls;return ls<<=1,(ls&4194240)===0&&(ls=64),l}function sd(l){for(var u=[],f=0;31>f;f++)u.push(l);return u}function hl(l,u,f){l.pendingLanes|=u,u!==536870912&&(l.suspendedLanes=0,l.pingedLanes=0),l=l.eventTimes,u=31-zi(u),l[u]=f}function Gy(l,u){var f=l.pendingLanes&~u;l.pendingLanes=u,l.suspendedLanes=0,l.pingedLanes=0,l.expiredLanes&=u,l.mutableReadLanes&=u,l.entangledLanes&=u,u=l.entanglements;var _=l.eventTimes;for(l=l.expirationTimes;0<f;){var v=31-zi(f),x=1<<v;u[v]=0,_[v]=-1,l[v]=-1,f&=~x}}function od(l,u){var f=l.entangledLanes|=u;for(l=l.entanglements;f;){var _=31-zi(f),v=1<<_;v&u|l[_]&u&&(l[_]|=u),f&=~v}}var rt=0;function cs(l){return l&=-l,1<l?4<l?(l&268435455)!==0?16:536870912:4:1}var ad,$c,ld,cd,ud,us=!1,Wc=[],hs=null,ds=null,Vn=null,dl=new Map,Ks=new Map,$i=[],wm="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Go(l,u){switch(l){case"focusin":case"focusout":hs=null;break;case"dragenter":case"dragleave":ds=null;break;case"mouseover":case"mouseout":Vn=null;break;case"pointerover":case"pointerout":dl.delete(u.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ks.delete(u.pointerId)}}function Dr(l,u,f,_,v,x){return l===null||l.nativeEvent!==x?(l={blockedOn:u,domEventName:f,eventSystemFlags:_,nativeEvent:x,targetContainers:[v]},u!==null&&(u=Id(u),u!==null&&$c(u)),l):(l.eventSystemFlags|=_,u=l.targetContainers,v!==null&&u.indexOf(v)===-1&&u.push(v),l)}function xm(l,u,f,_,v){switch(u){case"focusin":return hs=Dr(hs,l,u,f,_,v),!0;case"dragenter":return ds=Dr(ds,l,u,f,_,v),!0;case"mouseover":return Vn=Dr(Vn,l,u,f,_,v),!0;case"pointerover":var x=v.pointerId;return dl.set(x,Dr(dl.get(x)||null,l,u,f,_,v)),!0;case"gotpointercapture":return x=v.pointerId,Ks.set(x,Dr(Ks.get(x)||null,l,u,f,_,v)),!0}return!1}function Hc(l){var u=pl(l.target);if(u!==null){var f=Or(u);if(f!==null){if(u=f.tag,u===13){if(u=Jh(f),u!==null){l.blockedOn=u,ud(l.priority,function(){ld(f)});return}}else if(u===3&&f.stateNode.current.memoizedState.isDehydrated){l.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}l.blockedOn=null}function At(l){if(l.blockedOn!==null)return!1;for(var u=l.targetContainers;0<u.length;){var f=Kc(l.domEventName,l.eventSystemFlags,u[0],l.nativeEvent);if(f===null){f=l.nativeEvent;var _=new f.constructor(f.type,f);ss=_,f.target.dispatchEvent(_),ss=null}else return u=Id(f),u!==null&&$c(u),l.blockedOn=f,!1;u.shift()}return!0}function Sm(l,u,f){At(l)&&f.delete(u)}function jy(){us=!1,hs!==null&&At(hs)&&(hs=null),ds!==null&&At(ds)&&(ds=null),Vn!==null&&At(Vn)&&(Vn=null),dl.forEach(Sm),Ks.forEach(Sm)}function jo(l,u){l.blockedOn===u&&(l.blockedOn=null,us||(us=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,jy)))}function Uo(l){function u(v){return jo(v,l)}if(0<Wc.length){jo(Wc[0],l);for(var f=1;f<Wc.length;f++){var _=Wc[f];_.blockedOn===l&&(_.blockedOn=null)}}for(hs!==null&&jo(hs,l),ds!==null&&jo(ds,l),Vn!==null&&jo(Vn,l),dl.forEach(u),Ks.forEach(u),f=0;f<$i.length;f++)_=$i[f],_.blockedOn===l&&(_.blockedOn=null);for(;0<$i.length&&(f=$i[0],f.blockedOn===null);)Hc(f),f.blockedOn===null&&$i.shift()}var qs=D.ReactCurrentBatchConfig,Ys=!0;function fs(l,u,f,_){var v=rt,x=qs.transition;qs.transition=null;try{rt=1,hd(l,u,f,_)}finally{rt=v,qs.transition=x}}function Im(l,u,f,_){var v=rt,x=qs.transition;qs.transition=null;try{rt=4,hd(l,u,f,_)}finally{rt=v,qs.transition=x}}function hd(l,u,f,_){if(Ys){var v=Kc(l,u,f,_);if(v===null)Qy(l,u,_,gs,f),Go(l,_);else if(xm(v,l,u,f,_))_.stopPropagation();else if(Go(l,_),u&4&&-1<wm.indexOf(l)){for(;v!==null;){var x=Id(v);if(x!==null&&ad(x),x=Kc(l,u,f,_),x===null&&Qy(l,u,_,gs,f),x===v)break;v=x}v!==null&&_.stopPropagation()}else Qy(l,u,_,null,f)}}var gs=null;function Kc(l,u,f,_){if(gs=null,l=os(_),l=pl(l),l!==null)if(u=Or(l),u===null)l=null;else if(f=u.tag,f===13){if(l=Jh(u),l!==null)return l;l=null}else if(f===3){if(u.stateNode.current.memoizedState.isDehydrated)return u.tag===3?u.stateNode.containerInfo:null;l=null}else u!==l&&(l=null);return gs=l,null}function qc(l){switch(l){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Fy()){case Bc:return 1;case td:return 4;case ol:case nd:return 16;case zc:return 536870912;default:return 16}default:return 16}}var Wi=null,Yc=null,Xs=null;function Tm(){if(Xs)return Xs;var l,u=Yc,f=u.length,_,v="value"in Wi?Wi.value:Wi.textContent,x=v.length;for(l=0;l<f&&u[l]===v[l];l++);var b=f-l;for(_=1;_<=b&&u[f-_]===v[x-_];_++);return Xs=v.slice(l,1<_?1-_:void 0)}function fl(l){var u=l.keyCode;return"charCode"in l?(l=l.charCode,l===0&&u===13&&(l=13)):l=u,l===10&&(l=13),32<=l||l===13?l:0}function ms(){return!0}function dd(){return!1}function qn(l){function u(f,_,v,x,b){this._reactName=f,this._targetInst=v,this.type=_,this.nativeEvent=x,this.target=b,this.currentTarget=null;for(var $ in l)l.hasOwnProperty($)&&(f=l[$],this[$]=f?f(x):x[$]);return this.isDefaultPrevented=(x.defaultPrevented!=null?x.defaultPrevented:x.returnValue===!1)?ms:dd,this.isPropagationStopped=dd,this}return K(u.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=ms)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=ms)},persist:function(){},isPersistent:ms}),u}var ps={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(l){return l.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},gl=qn(ps),Bo=K({},ps,{view:0,detail:0}),Xc=qn(Bo),Qc,Zc,Hi,ml=K({},Bo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Xe,button:0,buttons:0,relatedTarget:function(l){return l.relatedTarget===void 0?l.fromElement===l.srcElement?l.toElement:l.fromElement:l.relatedTarget},movementX:function(l){return"movementX"in l?l.movementX:(l!==Hi&&(Hi&&l.type==="mousemove"?(Qc=l.screenX-Hi.screenX,Zc=l.screenY-Hi.screenY):Zc=Qc=0,Hi=l),Qc)},movementY:function(l){return"movementY"in l?l.movementY:Zc}}),fd=qn(ml),Rm=K({},ml,{dataTransfer:0}),Pm=qn(Rm),Jc=K({},Bo,{relatedTarget:0}),Fn=qn(Jc),Am=K({},ps,{animationName:0,elapsedTime:0,pseudoElement:0}),Cm=qn(Am),zo=K({},ps,{clipboardData:function(l){return"clipboardData"in l?l.clipboardData:window.clipboardData}}),p=qn(zo),S=K({},ps,{data:0}),R=qn(S),G={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ee={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},re={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ve(l){var u=this.nativeEvent;return u.getModifierState?u.getModifierState(l):(l=re[l])?!!u[l]:!1}function Xe(){return ve}var nn=K({},Bo,{key:function(l){if(l.key){var u=G[l.key]||l.key;if(u!=="Unidentified")return u}return l.type==="keypress"?(l=fl(l),l===13?"Enter":String.fromCharCode(l)):l.type==="keydown"||l.type==="keyup"?ee[l.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Xe,charCode:function(l){return l.type==="keypress"?fl(l):0},keyCode:function(l){return l.type==="keydown"||l.type==="keyup"?l.keyCode:0},which:function(l){return l.type==="keypress"?fl(l):l.type==="keydown"||l.type==="keyup"?l.keyCode:0}}),Et=qn(nn),un=K({},ml,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ki=qn(un),Qs=K({},Bo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Xe}),_s=qn(Qs),ys=K({},ps,{propertyName:0,elapsedTime:0,pseudoElement:0}),eu=qn(ys),gd=K({},ml,{deltaX:function(l){return"deltaX"in l?l.deltaX:"wheelDeltaX"in l?-l.wheelDeltaX:0},deltaY:function(l){return"deltaY"in l?l.deltaY:"wheelDeltaY"in l?-l.wheelDeltaY:"wheelDelta"in l?-l.wheelDelta:0},deltaZ:0,deltaMode:0}),S3=qn(gd),I3=[9,13,27,32],Uy=a&&"CompositionEvent"in window,md=null;a&&"documentMode"in document&&(md=document.documentMode);var T3=a&&"TextEvent"in window&&!md,qI=a&&(!Uy||md&&8<md&&11>=md),YI=" ",XI=!1;function QI(l,u){switch(l){case"keyup":return I3.indexOf(u.keyCode)!==-1;case"keydown":return u.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ZI(l){return l=l.detail,typeof l=="object"&&"data"in l?l.data:null}var tu=!1;function R3(l,u){switch(l){case"compositionend":return ZI(u);case"keypress":return u.which!==32?null:(XI=!0,YI);case"textInput":return l=u.data,l===YI&&XI?null:l;default:return null}}function P3(l,u){if(tu)return l==="compositionend"||!Uy&&QI(l,u)?(l=Tm(),Xs=Yc=Wi=null,tu=!1,l):null;switch(l){case"paste":return null;case"keypress":if(!(u.ctrlKey||u.altKey||u.metaKey)||u.ctrlKey&&u.altKey){if(u.char&&1<u.char.length)return u.char;if(u.which)return String.fromCharCode(u.which)}return null;case"compositionend":return qI&&u.locale!=="ko"?null:u.data;default:return null}}var A3={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function JI(l){var u=l&&l.nodeName&&l.nodeName.toLowerCase();return u==="input"?!!A3[l.type]:u==="textarea"}function eT(l,u,f,_){Nr(_),u=Nm(u,"onChange"),0<u.length&&(f=new gl("onChange","change",null,f,_),l.push({event:f,listeners:u}))}var pd=null,_d=null;function C3(l){yT(l,0)}function Mm(l){var u=ou(l);if(Kn(u))return l}function M3(l,u){if(l==="change")return u}var tT=!1;if(a){var By;if(a){var zy="oninput"in document;if(!zy){var nT=document.createElement("div");nT.setAttribute("oninput","return;"),zy=typeof nT.oninput=="function"}By=zy}else By=!1;tT=By&&(!document.documentMode||9<document.documentMode)}function iT(){pd&&(pd.detachEvent("onpropertychange",rT),_d=pd=null)}function rT(l){if(l.propertyName==="value"&&Mm(_d)){var u=[];eT(u,_d,l,os(l)),On(C3,u)}}function b3(l,u,f){l==="focusin"?(iT(),pd=u,_d=f,pd.attachEvent("onpropertychange",rT)):l==="focusout"&&iT()}function k3(l){if(l==="selectionchange"||l==="keyup"||l==="keydown")return Mm(_d)}function L3(l,u){if(l==="click")return Mm(u)}function N3(l,u){if(l==="input"||l==="change")return Mm(u)}function O3(l,u){return l===u&&(l!==0||1/l===1/u)||l!==l&&u!==u}var Vr=typeof Object.is=="function"?Object.is:O3;function yd(l,u){if(Vr(l,u))return!0;if(typeof l!="object"||l===null||typeof u!="object"||u===null)return!1;var f=Object.keys(l),_=Object.keys(u);if(f.length!==_.length)return!1;for(_=0;_<f.length;_++){var v=f[_];if(!c.call(u,v)||!Vr(l[v],u[v]))return!1}return!0}function sT(l){for(;l&&l.firstChild;)l=l.firstChild;return l}function oT(l,u){var f=sT(l);l=0;for(var _;f;){if(f.nodeType===3){if(_=l+f.textContent.length,l<=u&&_>=u)return{node:f,offset:u-l};l=_}e:{for(;f;){if(f.nextSibling){f=f.nextSibling;break e}f=f.parentNode}f=void 0}f=sT(f)}}function aT(l,u){return l&&u?l===u?!0:l&&l.nodeType===3?!1:u&&u.nodeType===3?aT(l,u.parentNode):"contains"in l?l.contains(u):l.compareDocumentPosition?!!(l.compareDocumentPosition(u)&16):!1:!1}function lT(){for(var l=window,u=bn();u instanceof l.HTMLIFrameElement;){try{var f=typeof u.contentWindow.location.href=="string"}catch{f=!1}if(f)l=u.contentWindow;else break;u=bn(l.document)}return u}function $y(l){var u=l&&l.nodeName&&l.nodeName.toLowerCase();return u&&(u==="input"&&(l.type==="text"||l.type==="search"||l.type==="tel"||l.type==="url"||l.type==="password")||u==="textarea"||l.contentEditable==="true")}function D3(l){var u=lT(),f=l.focusedElem,_=l.selectionRange;if(u!==f&&f&&f.ownerDocument&&aT(f.ownerDocument.documentElement,f)){if(_!==null&&$y(f)){if(u=_.start,l=_.end,l===void 0&&(l=u),"selectionStart"in f)f.selectionStart=u,f.selectionEnd=Math.min(l,f.value.length);else if(l=(u=f.ownerDocument||document)&&u.defaultView||window,l.getSelection){l=l.getSelection();var v=f.textContent.length,x=Math.min(_.start,v);_=_.end===void 0?x:Math.min(_.end,v),!l.extend&&x>_&&(v=_,_=x,x=v),v=oT(f,x);var b=oT(f,_);v&&b&&(l.rangeCount!==1||l.anchorNode!==v.node||l.anchorOffset!==v.offset||l.focusNode!==b.node||l.focusOffset!==b.offset)&&(u=u.createRange(),u.setStart(v.node,v.offset),l.removeAllRanges(),x>_?(l.addRange(u),l.extend(b.node,b.offset)):(u.setEnd(b.node,b.offset),l.addRange(u)))}}for(u=[],l=f;l=l.parentNode;)l.nodeType===1&&u.push({element:l,left:l.scrollLeft,top:l.scrollTop});for(typeof f.focus=="function"&&f.focus(),f=0;f<u.length;f++)l=u[f],l.element.scrollLeft=l.left,l.element.scrollTop=l.top}}var V3=a&&"documentMode"in document&&11>=document.documentMode,nu=null,Wy=null,vd=null,Hy=!1;function cT(l,u,f){var _=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;Hy||nu==null||nu!==bn(_)||(_=nu,"selectionStart"in _&&$y(_)?_={start:_.selectionStart,end:_.selectionEnd}:(_=(_.ownerDocument&&_.ownerDocument.defaultView||window).getSelection(),_={anchorNode:_.anchorNode,anchorOffset:_.anchorOffset,focusNode:_.focusNode,focusOffset:_.focusOffset}),vd&&yd(vd,_)||(vd=_,_=Nm(Wy,"onSelect"),0<_.length&&(u=new gl("onSelect","select",null,u,f),l.push({event:u,listeners:_}),u.target=nu)))}function bm(l,u){var f={};return f[l.toLowerCase()]=u.toLowerCase(),f["Webkit"+l]="webkit"+u,f["Moz"+l]="moz"+u,f}var iu={animationend:bm("Animation","AnimationEnd"),animationiteration:bm("Animation","AnimationIteration"),animationstart:bm("Animation","AnimationStart"),transitionend:bm("Transition","TransitionEnd")},Ky={},uT={};a&&(uT=document.createElement("div").style,"AnimationEvent"in window||(delete iu.animationend.animation,delete iu.animationiteration.animation,delete iu.animationstart.animation),"TransitionEvent"in window||delete iu.transitionend.transition);function km(l){if(Ky[l])return Ky[l];if(!iu[l])return l;var u=iu[l],f;for(f in u)if(u.hasOwnProperty(f)&&f in uT)return Ky[l]=u[f];return l}var hT=km("animationend"),dT=km("animationiteration"),fT=km("animationstart"),gT=km("transitionend"),mT=new Map,pT="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function $o(l,u){mT.set(l,u),s(u,[l])}for(var qy=0;qy<pT.length;qy++){var Yy=pT[qy],F3=Yy.toLowerCase(),G3=Yy[0].toUpperCase()+Yy.slice(1);$o(F3,"on"+G3)}$o(hT,"onAnimationEnd"),$o(dT,"onAnimationIteration"),$o(fT,"onAnimationStart"),$o("dblclick","onDoubleClick"),$o("focusin","onFocus"),$o("focusout","onBlur"),$o(gT,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ed="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),j3=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ed));function _T(l,u,f){var _=l.type||"unknown-event";l.currentTarget=f,Zh(_,u,void 0,l),l.currentTarget=null}function yT(l,u){u=(u&4)!==0;for(var f=0;f<l.length;f++){var _=l[f],v=_.event;_=_.listeners;e:{var x=void 0;if(u)for(var b=_.length-1;0<=b;b--){var $=_[b],H=$.instance,ie=$.currentTarget;if($=$.listener,H!==x&&v.isPropagationStopped())break e;_T(v,$,ie),x=H}else for(b=0;b<_.length;b++){if($=_[b],H=$.instance,ie=$.currentTarget,$=$.listener,H!==x&&v.isPropagationStopped())break e;_T(v,$,ie),x=H}}}if(jc)throw l=fr,jc=!1,fr=null,l}function Lt(l,u){var f=u[iv];f===void 0&&(f=u[iv]=new Set);var _=l+"__bubble";f.has(_)||(vT(u,l,2,!1),f.add(_))}function Xy(l,u,f){var _=0;u&&(_|=4),vT(f,l,_,u)}var Lm="_reactListening"+Math.random().toString(36).slice(2);function wd(l){if(!l[Lm]){l[Lm]=!0,i.forEach(function(f){f!=="selectionchange"&&(j3.has(f)||Xy(f,!1,l),Xy(f,!0,l))});var u=l.nodeType===9?l:l.ownerDocument;u===null||u[Lm]||(u[Lm]=!0,Xy("selectionchange",!1,u))}}function vT(l,u,f,_){switch(qc(u)){case 1:var v=fs;break;case 4:v=Im;break;default:v=hd}f=v.bind(null,u,f,l),v=void 0,!In||u!=="touchstart"&&u!=="touchmove"&&u!=="wheel"||(v=!0),_?v!==void 0?l.addEventListener(u,f,{capture:!0,passive:v}):l.addEventListener(u,f,!0):v!==void 0?l.addEventListener(u,f,{passive:v}):l.addEventListener(u,f,!1)}function Qy(l,u,f,_,v){var x=_;if((u&1)===0&&(u&2)===0&&_!==null)e:for(;;){if(_===null)return;var b=_.tag;if(b===3||b===4){var $=_.stateNode.containerInfo;if($===v||$.nodeType===8&&$.parentNode===v)break;if(b===4)for(b=_.return;b!==null;){var H=b.tag;if((H===3||H===4)&&(H=b.stateNode.containerInfo,H===v||H.nodeType===8&&H.parentNode===v))return;b=b.return}for(;$!==null;){if(b=pl($),b===null)return;if(H=b.tag,H===5||H===6){_=x=b;continue e}$=$.parentNode}}_=_.return}On(function(){var ie=x,ge=os(f),me=[];e:{var ue=mT.get(l);if(ue!==void 0){var Re=gl,Ce=l;switch(l){case"keypress":if(fl(f)===0)break e;case"keydown":case"keyup":Re=Et;break;case"focusin":Ce="focus",Re=Fn;break;case"focusout":Ce="blur",Re=Fn;break;case"beforeblur":case"afterblur":Re=Fn;break;case"click":if(f.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Re=fd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Re=Pm;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Re=_s;break;case hT:case dT:case fT:Re=Cm;break;case gT:Re=eu;break;case"scroll":Re=Xc;break;case"wheel":Re=S3;break;case"copy":case"cut":case"paste":Re=p;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Re=Ki}var ke=(u&4)!==0,rn=!ke&&l==="scroll",J=ke?ue!==null?ue+"Capture":null:ue;ke=[];for(var Y=ie,ne;Y!==null;){ne=Y;var ye=ne.stateNode;if(ne.tag===5&&ye!==null&&(ne=ye,J!==null&&(ye=Dn(Y,J),ye!=null&&ke.push(xd(Y,ye,ne)))),rn)break;Y=Y.return}0<ke.length&&(ue=new Re(ue,Ce,null,f,ge),me.push({event:ue,listeners:ke}))}}if((u&7)===0){e:{if(ue=l==="mouseover"||l==="pointerover",Re=l==="mouseout"||l==="pointerout",ue&&f!==ss&&(Ce=f.relatedTarget||f.fromElement)&&(pl(Ce)||Ce[Zs]))break e;if((Re||ue)&&(ue=ge.window===ge?ge:(ue=ge.ownerDocument)?ue.defaultView||ue.parentWindow:window,Re?(Ce=f.relatedTarget||f.toElement,Re=ie,Ce=Ce?pl(Ce):null,Ce!==null&&(rn=Or(Ce),Ce!==rn||Ce.tag!==5&&Ce.tag!==6)&&(Ce=null)):(Re=null,Ce=ie),Re!==Ce)){if(ke=fd,ye="onMouseLeave",J="onMouseEnter",Y="mouse",(l==="pointerout"||l==="pointerover")&&(ke=Ki,ye="onPointerLeave",J="onPointerEnter",Y="pointer"),rn=Re==null?ue:ou(Re),ne=Ce==null?ue:ou(Ce),ue=new ke(ye,Y+"leave",Re,f,ge),ue.target=rn,ue.relatedTarget=ne,ye=null,pl(ge)===ie&&(ke=new ke(J,Y+"enter",Ce,f,ge),ke.target=ne,ke.relatedTarget=rn,ye=ke),rn=ye,Re&&Ce)t:{for(ke=Re,J=Ce,Y=0,ne=ke;ne;ne=ru(ne))Y++;for(ne=0,ye=J;ye;ye=ru(ye))ne++;for(;0<Y-ne;)ke=ru(ke),Y--;for(;0<ne-Y;)J=ru(J),ne--;for(;Y--;){if(ke===J||J!==null&&ke===J.alternate)break t;ke=ru(ke),J=ru(J)}ke=null}else ke=null;Re!==null&&ET(me,ue,Re,ke,!1),Ce!==null&&rn!==null&&ET(me,rn,Ce,ke,!0)}}e:{if(ue=ie?ou(ie):window,Re=ue.nodeName&&ue.nodeName.toLowerCase(),Re==="select"||Re==="input"&&ue.type==="file")var Le=M3;else if(JI(ue))if(tT)Le=N3;else{Le=k3;var Ge=b3}else(Re=ue.nodeName)&&Re.toLowerCase()==="input"&&(ue.type==="checkbox"||ue.type==="radio")&&(Le=L3);if(Le&&(Le=Le(l,ie))){eT(me,Le,f,ge);break e}Ge&&Ge(l,ue,ie),l==="focusout"&&(Ge=ue._wrapperState)&&Ge.controlled&&ue.type==="number"&&Mt(ue,"number",ue.value)}switch(Ge=ie?ou(ie):window,l){case"focusin":(JI(Ge)||Ge.contentEditable==="true")&&(nu=Ge,Wy=ie,vd=null);break;case"focusout":vd=Wy=nu=null;break;case"mousedown":Hy=!0;break;case"contextmenu":case"mouseup":case"dragend":Hy=!1,cT(me,f,ge);break;case"selectionchange":if(V3)break;case"keydown":case"keyup":cT(me,f,ge)}var je;if(Uy)e:{switch(l){case"compositionstart":var ze="onCompositionStart";break e;case"compositionend":ze="onCompositionEnd";break e;case"compositionupdate":ze="onCompositionUpdate";break e}ze=void 0}else tu?QI(l,f)&&(ze="onCompositionEnd"):l==="keydown"&&f.keyCode===229&&(ze="onCompositionStart");ze&&(qI&&f.locale!=="ko"&&(tu||ze!=="onCompositionStart"?ze==="onCompositionEnd"&&tu&&(je=Tm()):(Wi=ge,Yc="value"in Wi?Wi.value:Wi.textContent,tu=!0)),Ge=Nm(ie,ze),0<Ge.length&&(ze=new R(ze,l,null,f,ge),me.push({event:ze,listeners:Ge}),je?ze.data=je:(je=ZI(f),je!==null&&(ze.data=je)))),(je=T3?R3(l,f):P3(l,f))&&(ie=Nm(ie,"onBeforeInput"),0<ie.length&&(ge=new R("onBeforeInput","beforeinput",null,f,ge),me.push({event:ge,listeners:ie}),ge.data=je))}yT(me,u)})}function xd(l,u,f){return{instance:l,listener:u,currentTarget:f}}function Nm(l,u){for(var f=u+"Capture",_=[];l!==null;){var v=l,x=v.stateNode;v.tag===5&&x!==null&&(v=x,x=Dn(l,f),x!=null&&_.unshift(xd(l,x,v)),x=Dn(l,u),x!=null&&_.push(xd(l,x,v))),l=l.return}return _}function ru(l){if(l===null)return null;do l=l.return;while(l&&l.tag!==5);return l||null}function ET(l,u,f,_,v){for(var x=u._reactName,b=[];f!==null&&f!==_;){var $=f,H=$.alternate,ie=$.stateNode;if(H!==null&&H===_)break;$.tag===5&&ie!==null&&($=ie,v?(H=Dn(f,x),H!=null&&b.unshift(xd(f,H,$))):v||(H=Dn(f,x),H!=null&&b.push(xd(f,H,$)))),f=f.return}b.length!==0&&l.push({event:u,listeners:b})}var U3=/\r\n?/g,B3=/\u0000|\uFFFD/g;function wT(l){return(typeof l=="string"?l:""+l).replace(U3,`
`).replace(B3,"")}function Om(l,u,f){if(u=wT(u),wT(l)!==u&&f)throw Error(t(425))}function Dm(){}var Zy=null,Jy=null;function ev(l,u){return l==="textarea"||l==="noscript"||typeof u.children=="string"||typeof u.children=="number"||typeof u.dangerouslySetInnerHTML=="object"&&u.dangerouslySetInnerHTML!==null&&u.dangerouslySetInnerHTML.__html!=null}var tv=typeof setTimeout=="function"?setTimeout:void 0,z3=typeof clearTimeout=="function"?clearTimeout:void 0,xT=typeof Promise=="function"?Promise:void 0,$3=typeof queueMicrotask=="function"?queueMicrotask:typeof xT<"u"?function(l){return xT.resolve(null).then(l).catch(W3)}:tv;function W3(l){setTimeout(function(){throw l})}function nv(l,u){var f=u,_=0;do{var v=f.nextSibling;if(l.removeChild(f),v&&v.nodeType===8)if(f=v.data,f==="/$"){if(_===0){l.removeChild(v),Uo(u);return}_--}else f!=="$"&&f!=="$?"&&f!=="$!"||_++;f=v}while(f);Uo(u)}function Wo(l){for(;l!=null;l=l.nextSibling){var u=l.nodeType;if(u===1||u===3)break;if(u===8){if(u=l.data,u==="$"||u==="$!"||u==="$?")break;if(u==="/$")return null}}return l}function ST(l){l=l.previousSibling;for(var u=0;l;){if(l.nodeType===8){var f=l.data;if(f==="$"||f==="$!"||f==="$?"){if(u===0)return l;u--}else f==="/$"&&u++}l=l.previousSibling}return null}var su=Math.random().toString(36).slice(2),vs="__reactFiber$"+su,Sd="__reactProps$"+su,Zs="__reactContainer$"+su,iv="__reactEvents$"+su,H3="__reactListeners$"+su,K3="__reactHandles$"+su;function pl(l){var u=l[vs];if(u)return u;for(var f=l.parentNode;f;){if(u=f[Zs]||f[vs]){if(f=u.alternate,u.child!==null||f!==null&&f.child!==null)for(l=ST(l);l!==null;){if(f=l[vs])return f;l=ST(l)}return u}l=f,f=l.parentNode}return null}function Id(l){return l=l[vs]||l[Zs],!l||l.tag!==5&&l.tag!==6&&l.tag!==13&&l.tag!==3?null:l}function ou(l){if(l.tag===5||l.tag===6)return l.stateNode;throw Error(t(33))}function Vm(l){return l[Sd]||null}var rv=[],au=-1;function Ho(l){return{current:l}}function Nt(l){0>au||(l.current=rv[au],rv[au]=null,au--)}function bt(l,u){au++,rv[au]=l.current,l.current=u}var Ko={},Yn=Ho(Ko),Ii=Ho(!1),_l=Ko;function lu(l,u){var f=l.type.contextTypes;if(!f)return Ko;var _=l.stateNode;if(_&&_.__reactInternalMemoizedUnmaskedChildContext===u)return _.__reactInternalMemoizedMaskedChildContext;var v={},x;for(x in f)v[x]=u[x];return _&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=u,l.__reactInternalMemoizedMaskedChildContext=v),v}function Ti(l){return l=l.childContextTypes,l!=null}function Fm(){Nt(Ii),Nt(Yn)}function IT(l,u,f){if(Yn.current!==Ko)throw Error(t(168));bt(Yn,u),bt(Ii,f)}function TT(l,u,f){var _=l.stateNode;if(u=u.childContextTypes,typeof _.getChildContext!="function")return f;_=_.getChildContext();for(var v in _)if(!(v in u))throw Error(t(108,F(l)||"Unknown",v));return K({},f,_)}function Gm(l){return l=(l=l.stateNode)&&l.__reactInternalMemoizedMergedChildContext||Ko,_l=Yn.current,bt(Yn,l),bt(Ii,Ii.current),!0}function RT(l,u,f){var _=l.stateNode;if(!_)throw Error(t(169));f?(l=TT(l,u,_l),_.__reactInternalMemoizedMergedChildContext=l,Nt(Ii),Nt(Yn),bt(Yn,l)):Nt(Ii),bt(Ii,f)}var Js=null,jm=!1,sv=!1;function PT(l){Js===null?Js=[l]:Js.push(l)}function q3(l){jm=!0,PT(l)}function qo(){if(!sv&&Js!==null){sv=!0;var l=0,u=rt;try{var f=Js;for(rt=1;l<f.length;l++){var _=f[l];do _=_(!0);while(_!==null)}Js=null,jm=!1}catch(v){throw Js!==null&&(Js=Js.slice(l+1)),ed(Bc,qo),v}finally{rt=u,sv=!1}}return null}var cu=[],uu=0,Um=null,Bm=0,mr=[],pr=0,yl=null,eo=1,to="";function vl(l,u){cu[uu++]=Bm,cu[uu++]=Um,Um=l,Bm=u}function AT(l,u,f){mr[pr++]=eo,mr[pr++]=to,mr[pr++]=yl,yl=l;var _=eo;l=to;var v=32-zi(_)-1;_&=~(1<<v),f+=1;var x=32-zi(u)+v;if(30<x){var b=v-v%5;x=(_&(1<<b)-1).toString(32),_>>=b,v-=b,eo=1<<32-zi(u)+v|f<<v|_,to=x+l}else eo=1<<x|f<<v|_,to=l}function ov(l){l.return!==null&&(vl(l,1),AT(l,1,0))}function av(l){for(;l===Um;)Um=cu[--uu],cu[uu]=null,Bm=cu[--uu],cu[uu]=null;for(;l===yl;)yl=mr[--pr],mr[pr]=null,to=mr[--pr],mr[pr]=null,eo=mr[--pr],mr[pr]=null}var qi=null,Yi=null,jt=!1,Fr=null;function CT(l,u){var f=Er(5,null,null,0);f.elementType="DELETED",f.stateNode=u,f.return=l,u=l.deletions,u===null?(l.deletions=[f],l.flags|=16):u.push(f)}function MT(l,u){switch(l.tag){case 5:var f=l.type;return u=u.nodeType!==1||f.toLowerCase()!==u.nodeName.toLowerCase()?null:u,u!==null?(l.stateNode=u,qi=l,Yi=Wo(u.firstChild),!0):!1;case 6:return u=l.pendingProps===""||u.nodeType!==3?null:u,u!==null?(l.stateNode=u,qi=l,Yi=null,!0):!1;case 13:return u=u.nodeType!==8?null:u,u!==null?(f=yl!==null?{id:eo,overflow:to}:null,l.memoizedState={dehydrated:u,treeContext:f,retryLane:1073741824},f=Er(18,null,null,0),f.stateNode=u,f.return=l,l.child=f,qi=l,Yi=null,!0):!1;default:return!1}}function lv(l){return(l.mode&1)!==0&&(l.flags&128)===0}function cv(l){if(jt){var u=Yi;if(u){var f=u;if(!MT(l,u)){if(lv(l))throw Error(t(418));u=Wo(f.nextSibling);var _=qi;u&&MT(l,u)?CT(_,f):(l.flags=l.flags&-4097|2,jt=!1,qi=l)}}else{if(lv(l))throw Error(t(418));l.flags=l.flags&-4097|2,jt=!1,qi=l}}}function bT(l){for(l=l.return;l!==null&&l.tag!==5&&l.tag!==3&&l.tag!==13;)l=l.return;qi=l}function zm(l){if(l!==qi)return!1;if(!jt)return bT(l),jt=!0,!1;var u;if((u=l.tag!==3)&&!(u=l.tag!==5)&&(u=l.type,u=u!=="head"&&u!=="body"&&!ev(l.type,l.memoizedProps)),u&&(u=Yi)){if(lv(l))throw kT(),Error(t(418));for(;u;)CT(l,u),u=Wo(u.nextSibling)}if(bT(l),l.tag===13){if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(t(317));e:{for(l=l.nextSibling,u=0;l;){if(l.nodeType===8){var f=l.data;if(f==="/$"){if(u===0){Yi=Wo(l.nextSibling);break e}u--}else f!=="$"&&f!=="$!"&&f!=="$?"||u++}l=l.nextSibling}Yi=null}}else Yi=qi?Wo(l.stateNode.nextSibling):null;return!0}function kT(){for(var l=Yi;l;)l=Wo(l.nextSibling)}function hu(){Yi=qi=null,jt=!1}function uv(l){Fr===null?Fr=[l]:Fr.push(l)}var Y3=D.ReactCurrentBatchConfig;function Td(l,u,f){if(l=f.ref,l!==null&&typeof l!="function"&&typeof l!="object"){if(f._owner){if(f=f._owner,f){if(f.tag!==1)throw Error(t(309));var _=f.stateNode}if(!_)throw Error(t(147,l));var v=_,x=""+l;return u!==null&&u.ref!==null&&typeof u.ref=="function"&&u.ref._stringRef===x?u.ref:(u=function(b){var $=v.refs;b===null?delete $[x]:$[x]=b},u._stringRef=x,u)}if(typeof l!="string")throw Error(t(284));if(!f._owner)throw Error(t(290,l))}return l}function $m(l,u){throw l=Object.prototype.toString.call(u),Error(t(31,l==="[object Object]"?"object with keys {"+Object.keys(u).join(", ")+"}":l))}function LT(l){var u=l._init;return u(l._payload)}function NT(l){function u(J,Y){if(l){var ne=J.deletions;ne===null?(J.deletions=[Y],J.flags|=16):ne.push(Y)}}function f(J,Y){if(!l)return null;for(;Y!==null;)u(J,Y),Y=Y.sibling;return null}function _(J,Y){for(J=new Map;Y!==null;)Y.key!==null?J.set(Y.key,Y):J.set(Y.index,Y),Y=Y.sibling;return J}function v(J,Y){return J=na(J,Y),J.index=0,J.sibling=null,J}function x(J,Y,ne){return J.index=ne,l?(ne=J.alternate,ne!==null?(ne=ne.index,ne<Y?(J.flags|=2,Y):ne):(J.flags|=2,Y)):(J.flags|=1048576,Y)}function b(J){return l&&J.alternate===null&&(J.flags|=2),J}function $(J,Y,ne,ye){return Y===null||Y.tag!==6?(Y=t1(ne,J.mode,ye),Y.return=J,Y):(Y=v(Y,ne),Y.return=J,Y)}function H(J,Y,ne,ye){var Le=ne.type;return Le===L?ge(J,Y,ne.props.children,ye,ne.key):Y!==null&&(Y.elementType===Le||typeof Le=="object"&&Le!==null&&Le.$$typeof===we&&LT(Le)===Y.type)?(ye=v(Y,ne.props),ye.ref=Td(J,Y,ne),ye.return=J,ye):(ye=gp(ne.type,ne.key,ne.props,null,J.mode,ye),ye.ref=Td(J,Y,ne),ye.return=J,ye)}function ie(J,Y,ne,ye){return Y===null||Y.tag!==4||Y.stateNode.containerInfo!==ne.containerInfo||Y.stateNode.implementation!==ne.implementation?(Y=n1(ne,J.mode,ye),Y.return=J,Y):(Y=v(Y,ne.children||[]),Y.return=J,Y)}function ge(J,Y,ne,ye,Le){return Y===null||Y.tag!==7?(Y=Pl(ne,J.mode,ye,Le),Y.return=J,Y):(Y=v(Y,ne),Y.return=J,Y)}function me(J,Y,ne){if(typeof Y=="string"&&Y!==""||typeof Y=="number")return Y=t1(""+Y,J.mode,ne),Y.return=J,Y;if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case j:return ne=gp(Y.type,Y.key,Y.props,null,J.mode,ne),ne.ref=Td(J,null,Y),ne.return=J,ne;case W:return Y=n1(Y,J.mode,ne),Y.return=J,Y;case we:var ye=Y._init;return me(J,ye(Y._payload),ne)}if(vt(Y)||ce(Y))return Y=Pl(Y,J.mode,ne,null),Y.return=J,Y;$m(J,Y)}return null}function ue(J,Y,ne,ye){var Le=Y!==null?Y.key:null;if(typeof ne=="string"&&ne!==""||typeof ne=="number")return Le!==null?null:$(J,Y,""+ne,ye);if(typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case j:return ne.key===Le?H(J,Y,ne,ye):null;case W:return ne.key===Le?ie(J,Y,ne,ye):null;case we:return Le=ne._init,ue(J,Y,Le(ne._payload),ye)}if(vt(ne)||ce(ne))return Le!==null?null:ge(J,Y,ne,ye,null);$m(J,ne)}return null}function Re(J,Y,ne,ye,Le){if(typeof ye=="string"&&ye!==""||typeof ye=="number")return J=J.get(ne)||null,$(Y,J,""+ye,Le);if(typeof ye=="object"&&ye!==null){switch(ye.$$typeof){case j:return J=J.get(ye.key===null?ne:ye.key)||null,H(Y,J,ye,Le);case W:return J=J.get(ye.key===null?ne:ye.key)||null,ie(Y,J,ye,Le);case we:var Ge=ye._init;return Re(J,Y,ne,Ge(ye._payload),Le)}if(vt(ye)||ce(ye))return J=J.get(ne)||null,ge(Y,J,ye,Le,null);$m(Y,ye)}return null}function Ce(J,Y,ne,ye){for(var Le=null,Ge=null,je=Y,ze=Y=0,Pn=null;je!==null&&ze<ne.length;ze++){je.index>ze?(Pn=je,je=null):Pn=je.sibling;var ct=ue(J,je,ne[ze],ye);if(ct===null){je===null&&(je=Pn);break}l&&je&&ct.alternate===null&&u(J,je),Y=x(ct,Y,ze),Ge===null?Le=ct:Ge.sibling=ct,Ge=ct,je=Pn}if(ze===ne.length)return f(J,je),jt&&vl(J,ze),Le;if(je===null){for(;ze<ne.length;ze++)je=me(J,ne[ze],ye),je!==null&&(Y=x(je,Y,ze),Ge===null?Le=je:Ge.sibling=je,Ge=je);return jt&&vl(J,ze),Le}for(je=_(J,je);ze<ne.length;ze++)Pn=Re(je,J,ze,ne[ze],ye),Pn!==null&&(l&&Pn.alternate!==null&&je.delete(Pn.key===null?ze:Pn.key),Y=x(Pn,Y,ze),Ge===null?Le=Pn:Ge.sibling=Pn,Ge=Pn);return l&&je.forEach(function(ia){return u(J,ia)}),jt&&vl(J,ze),Le}function ke(J,Y,ne,ye){var Le=ce(ne);if(typeof Le!="function")throw Error(t(150));if(ne=Le.call(ne),ne==null)throw Error(t(151));for(var Ge=Le=null,je=Y,ze=Y=0,Pn=null,ct=ne.next();je!==null&&!ct.done;ze++,ct=ne.next()){je.index>ze?(Pn=je,je=null):Pn=je.sibling;var ia=ue(J,je,ct.value,ye);if(ia===null){je===null&&(je=Pn);break}l&&je&&ia.alternate===null&&u(J,je),Y=x(ia,Y,ze),Ge===null?Le=ia:Ge.sibling=ia,Ge=ia,je=Pn}if(ct.done)return f(J,je),jt&&vl(J,ze),Le;if(je===null){for(;!ct.done;ze++,ct=ne.next())ct=me(J,ct.value,ye),ct!==null&&(Y=x(ct,Y,ze),Ge===null?Le=ct:Ge.sibling=ct,Ge=ct);return jt&&vl(J,ze),Le}for(je=_(J,je);!ct.done;ze++,ct=ne.next())ct=Re(je,J,ze,ct.value,ye),ct!==null&&(l&&ct.alternate!==null&&je.delete(ct.key===null?ze:ct.key),Y=x(ct,Y,ze),Ge===null?Le=ct:Ge.sibling=ct,Ge=ct);return l&&je.forEach(function(A5){return u(J,A5)}),jt&&vl(J,ze),Le}function rn(J,Y,ne,ye){if(typeof ne=="object"&&ne!==null&&ne.type===L&&ne.key===null&&(ne=ne.props.children),typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case j:e:{for(var Le=ne.key,Ge=Y;Ge!==null;){if(Ge.key===Le){if(Le=ne.type,Le===L){if(Ge.tag===7){f(J,Ge.sibling),Y=v(Ge,ne.props.children),Y.return=J,J=Y;break e}}else if(Ge.elementType===Le||typeof Le=="object"&&Le!==null&&Le.$$typeof===we&&LT(Le)===Ge.type){f(J,Ge.sibling),Y=v(Ge,ne.props),Y.ref=Td(J,Ge,ne),Y.return=J,J=Y;break e}f(J,Ge);break}else u(J,Ge);Ge=Ge.sibling}ne.type===L?(Y=Pl(ne.props.children,J.mode,ye,ne.key),Y.return=J,J=Y):(ye=gp(ne.type,ne.key,ne.props,null,J.mode,ye),ye.ref=Td(J,Y,ne),ye.return=J,J=ye)}return b(J);case W:e:{for(Ge=ne.key;Y!==null;){if(Y.key===Ge)if(Y.tag===4&&Y.stateNode.containerInfo===ne.containerInfo&&Y.stateNode.implementation===ne.implementation){f(J,Y.sibling),Y=v(Y,ne.children||[]),Y.return=J,J=Y;break e}else{f(J,Y);break}else u(J,Y);Y=Y.sibling}Y=n1(ne,J.mode,ye),Y.return=J,J=Y}return b(J);case we:return Ge=ne._init,rn(J,Y,Ge(ne._payload),ye)}if(vt(ne))return Ce(J,Y,ne,ye);if(ce(ne))return ke(J,Y,ne,ye);$m(J,ne)}return typeof ne=="string"&&ne!==""||typeof ne=="number"?(ne=""+ne,Y!==null&&Y.tag===6?(f(J,Y.sibling),Y=v(Y,ne),Y.return=J,J=Y):(f(J,Y),Y=t1(ne,J.mode,ye),Y.return=J,J=Y),b(J)):f(J,Y)}return rn}var du=NT(!0),OT=NT(!1),Wm=Ho(null),Hm=null,fu=null,hv=null;function dv(){hv=fu=Hm=null}function fv(l){var u=Wm.current;Nt(Wm),l._currentValue=u}function gv(l,u,f){for(;l!==null;){var _=l.alternate;if((l.childLanes&u)!==u?(l.childLanes|=u,_!==null&&(_.childLanes|=u)):_!==null&&(_.childLanes&u)!==u&&(_.childLanes|=u),l===f)break;l=l.return}}function gu(l,u){Hm=l,hv=fu=null,l=l.dependencies,l!==null&&l.firstContext!==null&&((l.lanes&u)!==0&&(Ri=!0),l.firstContext=null)}function _r(l){var u=l._currentValue;if(hv!==l)if(l={context:l,memoizedValue:u,next:null},fu===null){if(Hm===null)throw Error(t(308));fu=l,Hm.dependencies={lanes:0,firstContext:l}}else fu=fu.next=l;return u}var El=null;function mv(l){El===null?El=[l]:El.push(l)}function DT(l,u,f,_){var v=u.interleaved;return v===null?(f.next=f,mv(u)):(f.next=v.next,v.next=f),u.interleaved=f,no(l,_)}function no(l,u){l.lanes|=u;var f=l.alternate;for(f!==null&&(f.lanes|=u),f=l,l=l.return;l!==null;)l.childLanes|=u,f=l.alternate,f!==null&&(f.childLanes|=u),f=l,l=l.return;return f.tag===3?f.stateNode:null}var Yo=!1;function pv(l){l.updateQueue={baseState:l.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function VT(l,u){l=l.updateQueue,u.updateQueue===l&&(u.updateQueue={baseState:l.baseState,firstBaseUpdate:l.firstBaseUpdate,lastBaseUpdate:l.lastBaseUpdate,shared:l.shared,effects:l.effects})}function io(l,u){return{eventTime:l,lane:u,tag:0,payload:null,callback:null,next:null}}function Xo(l,u,f){var _=l.updateQueue;if(_===null)return null;if(_=_.shared,(at&2)!==0){var v=_.pending;return v===null?u.next=u:(u.next=v.next,v.next=u),_.pending=u,no(l,f)}return v=_.interleaved,v===null?(u.next=u,mv(_)):(u.next=v.next,v.next=u),_.interleaved=u,no(l,f)}function Km(l,u,f){if(u=u.updateQueue,u!==null&&(u=u.shared,(f&4194240)!==0)){var _=u.lanes;_&=l.pendingLanes,f|=_,u.lanes=f,od(l,f)}}function FT(l,u){var f=l.updateQueue,_=l.alternate;if(_!==null&&(_=_.updateQueue,f===_)){var v=null,x=null;if(f=f.firstBaseUpdate,f!==null){do{var b={eventTime:f.eventTime,lane:f.lane,tag:f.tag,payload:f.payload,callback:f.callback,next:null};x===null?v=x=b:x=x.next=b,f=f.next}while(f!==null);x===null?v=x=u:x=x.next=u}else v=x=u;f={baseState:_.baseState,firstBaseUpdate:v,lastBaseUpdate:x,shared:_.shared,effects:_.effects},l.updateQueue=f;return}l=f.lastBaseUpdate,l===null?f.firstBaseUpdate=u:l.next=u,f.lastBaseUpdate=u}function qm(l,u,f,_){var v=l.updateQueue;Yo=!1;var x=v.firstBaseUpdate,b=v.lastBaseUpdate,$=v.shared.pending;if($!==null){v.shared.pending=null;var H=$,ie=H.next;H.next=null,b===null?x=ie:b.next=ie,b=H;var ge=l.alternate;ge!==null&&(ge=ge.updateQueue,$=ge.lastBaseUpdate,$!==b&&($===null?ge.firstBaseUpdate=ie:$.next=ie,ge.lastBaseUpdate=H))}if(x!==null){var me=v.baseState;b=0,ge=ie=H=null,$=x;do{var ue=$.lane,Re=$.eventTime;if((_&ue)===ue){ge!==null&&(ge=ge.next={eventTime:Re,lane:0,tag:$.tag,payload:$.payload,callback:$.callback,next:null});e:{var Ce=l,ke=$;switch(ue=u,Re=f,ke.tag){case 1:if(Ce=ke.payload,typeof Ce=="function"){me=Ce.call(Re,me,ue);break e}me=Ce;break e;case 3:Ce.flags=Ce.flags&-65537|128;case 0:if(Ce=ke.payload,ue=typeof Ce=="function"?Ce.call(Re,me,ue):Ce,ue==null)break e;me=K({},me,ue);break e;case 2:Yo=!0}}$.callback!==null&&$.lane!==0&&(l.flags|=64,ue=v.effects,ue===null?v.effects=[$]:ue.push($))}else Re={eventTime:Re,lane:ue,tag:$.tag,payload:$.payload,callback:$.callback,next:null},ge===null?(ie=ge=Re,H=me):ge=ge.next=Re,b|=ue;if($=$.next,$===null){if($=v.shared.pending,$===null)break;ue=$,$=ue.next,ue.next=null,v.lastBaseUpdate=ue,v.shared.pending=null}}while(!0);if(ge===null&&(H=me),v.baseState=H,v.firstBaseUpdate=ie,v.lastBaseUpdate=ge,u=v.shared.interleaved,u!==null){v=u;do b|=v.lane,v=v.next;while(v!==u)}else x===null&&(v.shared.lanes=0);Sl|=b,l.lanes=b,l.memoizedState=me}}function GT(l,u,f){if(l=u.effects,u.effects=null,l!==null)for(u=0;u<l.length;u++){var _=l[u],v=_.callback;if(v!==null){if(_.callback=null,_=f,typeof v!="function")throw Error(t(191,v));v.call(_)}}}var Rd={},Es=Ho(Rd),Pd=Ho(Rd),Ad=Ho(Rd);function wl(l){if(l===Rd)throw Error(t(174));return l}function _v(l,u){switch(bt(Ad,u),bt(Pd,l),bt(Es,Rd),l=u.nodeType,l){case 9:case 11:u=(u=u.documentElement)?u.namespaceURI:Lr(null,"");break;default:l=l===8?u.parentNode:u,u=l.namespaceURI||null,l=l.tagName,u=Lr(u,l)}Nt(Es),bt(Es,u)}function mu(){Nt(Es),Nt(Pd),Nt(Ad)}function jT(l){wl(Ad.current);var u=wl(Es.current),f=Lr(u,l.type);u!==f&&(bt(Pd,l),bt(Es,f))}function yv(l){Pd.current===l&&(Nt(Es),Nt(Pd))}var $t=Ho(0);function Ym(l){for(var u=l;u!==null;){if(u.tag===13){var f=u.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||f.data==="$?"||f.data==="$!"))return u}else if(u.tag===19&&u.memoizedProps.revealOrder!==void 0){if((u.flags&128)!==0)return u}else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===l)break;for(;u.sibling===null;){if(u.return===null||u.return===l)return null;u=u.return}u.sibling.return=u.return,u=u.sibling}return null}var vv=[];function Ev(){for(var l=0;l<vv.length;l++)vv[l]._workInProgressVersionPrimary=null;vv.length=0}var Xm=D.ReactCurrentDispatcher,wv=D.ReactCurrentBatchConfig,xl=0,Wt=null,pn=null,Tn=null,Qm=!1,Cd=!1,Md=0,X3=0;function Xn(){throw Error(t(321))}function xv(l,u){if(u===null)return!1;for(var f=0;f<u.length&&f<l.length;f++)if(!Vr(l[f],u[f]))return!1;return!0}function Sv(l,u,f,_,v,x){if(xl=x,Wt=u,u.memoizedState=null,u.updateQueue=null,u.lanes=0,Xm.current=l===null||l.memoizedState===null?e5:t5,l=f(_,v),Cd){x=0;do{if(Cd=!1,Md=0,25<=x)throw Error(t(301));x+=1,Tn=pn=null,u.updateQueue=null,Xm.current=n5,l=f(_,v)}while(Cd)}if(Xm.current=ep,u=pn!==null&&pn.next!==null,xl=0,Tn=pn=Wt=null,Qm=!1,u)throw Error(t(300));return l}function Iv(){var l=Md!==0;return Md=0,l}function ws(){var l={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Tn===null?Wt.memoizedState=Tn=l:Tn=Tn.next=l,Tn}function yr(){if(pn===null){var l=Wt.alternate;l=l!==null?l.memoizedState:null}else l=pn.next;var u=Tn===null?Wt.memoizedState:Tn.next;if(u!==null)Tn=u,pn=l;else{if(l===null)throw Error(t(310));pn=l,l={memoizedState:pn.memoizedState,baseState:pn.baseState,baseQueue:pn.baseQueue,queue:pn.queue,next:null},Tn===null?Wt.memoizedState=Tn=l:Tn=Tn.next=l}return Tn}function bd(l,u){return typeof u=="function"?u(l):u}function Tv(l){var u=yr(),f=u.queue;if(f===null)throw Error(t(311));f.lastRenderedReducer=l;var _=pn,v=_.baseQueue,x=f.pending;if(x!==null){if(v!==null){var b=v.next;v.next=x.next,x.next=b}_.baseQueue=v=x,f.pending=null}if(v!==null){x=v.next,_=_.baseState;var $=b=null,H=null,ie=x;do{var ge=ie.lane;if((xl&ge)===ge)H!==null&&(H=H.next={lane:0,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null}),_=ie.hasEagerState?ie.eagerState:l(_,ie.action);else{var me={lane:ge,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null};H===null?($=H=me,b=_):H=H.next=me,Wt.lanes|=ge,Sl|=ge}ie=ie.next}while(ie!==null&&ie!==x);H===null?b=_:H.next=$,Vr(_,u.memoizedState)||(Ri=!0),u.memoizedState=_,u.baseState=b,u.baseQueue=H,f.lastRenderedState=_}if(l=f.interleaved,l!==null){v=l;do x=v.lane,Wt.lanes|=x,Sl|=x,v=v.next;while(v!==l)}else v===null&&(f.lanes=0);return[u.memoizedState,f.dispatch]}function Rv(l){var u=yr(),f=u.queue;if(f===null)throw Error(t(311));f.lastRenderedReducer=l;var _=f.dispatch,v=f.pending,x=u.memoizedState;if(v!==null){f.pending=null;var b=v=v.next;do x=l(x,b.action),b=b.next;while(b!==v);Vr(x,u.memoizedState)||(Ri=!0),u.memoizedState=x,u.baseQueue===null&&(u.baseState=x),f.lastRenderedState=x}return[x,_]}function UT(){}function BT(l,u){var f=Wt,_=yr(),v=u(),x=!Vr(_.memoizedState,v);if(x&&(_.memoizedState=v,Ri=!0),_=_.queue,Pv(WT.bind(null,f,_,l),[l]),_.getSnapshot!==u||x||Tn!==null&&Tn.memoizedState.tag&1){if(f.flags|=2048,kd(9,$T.bind(null,f,_,v,u),void 0,null),Rn===null)throw Error(t(349));(xl&30)!==0||zT(f,u,v)}return v}function zT(l,u,f){l.flags|=16384,l={getSnapshot:u,value:f},u=Wt.updateQueue,u===null?(u={lastEffect:null,stores:null},Wt.updateQueue=u,u.stores=[l]):(f=u.stores,f===null?u.stores=[l]:f.push(l))}function $T(l,u,f,_){u.value=f,u.getSnapshot=_,HT(u)&&KT(l)}function WT(l,u,f){return f(function(){HT(u)&&KT(l)})}function HT(l){var u=l.getSnapshot;l=l.value;try{var f=u();return!Vr(l,f)}catch{return!0}}function KT(l){var u=no(l,1);u!==null&&Br(u,l,1,-1)}function qT(l){var u=ws();return typeof l=="function"&&(l=l()),u.memoizedState=u.baseState=l,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:bd,lastRenderedState:l},u.queue=l,l=l.dispatch=J3.bind(null,Wt,l),[u.memoizedState,l]}function kd(l,u,f,_){return l={tag:l,create:u,destroy:f,deps:_,next:null},u=Wt.updateQueue,u===null?(u={lastEffect:null,stores:null},Wt.updateQueue=u,u.lastEffect=l.next=l):(f=u.lastEffect,f===null?u.lastEffect=l.next=l:(_=f.next,f.next=l,l.next=_,u.lastEffect=l)),l}function YT(){return yr().memoizedState}function Zm(l,u,f,_){var v=ws();Wt.flags|=l,v.memoizedState=kd(1|u,f,void 0,_===void 0?null:_)}function Jm(l,u,f,_){var v=yr();_=_===void 0?null:_;var x=void 0;if(pn!==null){var b=pn.memoizedState;if(x=b.destroy,_!==null&&xv(_,b.deps)){v.memoizedState=kd(u,f,x,_);return}}Wt.flags|=l,v.memoizedState=kd(1|u,f,x,_)}function XT(l,u){return Zm(8390656,8,l,u)}function Pv(l,u){return Jm(2048,8,l,u)}function QT(l,u){return Jm(4,2,l,u)}function ZT(l,u){return Jm(4,4,l,u)}function JT(l,u){if(typeof u=="function")return l=l(),u(l),function(){u(null)};if(u!=null)return l=l(),u.current=l,function(){u.current=null}}function e2(l,u,f){return f=f!=null?f.concat([l]):null,Jm(4,4,JT.bind(null,u,l),f)}function Av(){}function t2(l,u){var f=yr();u=u===void 0?null:u;var _=f.memoizedState;return _!==null&&u!==null&&xv(u,_[1])?_[0]:(f.memoizedState=[l,u],l)}function n2(l,u){var f=yr();u=u===void 0?null:u;var _=f.memoizedState;return _!==null&&u!==null&&xv(u,_[1])?_[0]:(l=l(),f.memoizedState=[l,u],l)}function i2(l,u,f){return(xl&21)===0?(l.baseState&&(l.baseState=!1,Ri=!0),l.memoizedState=f):(Vr(f,u)||(f=rd(),Wt.lanes|=f,Sl|=f,l.baseState=!0),u)}function Q3(l,u){var f=rt;rt=f!==0&&4>f?f:4,l(!0);var _=wv.transition;wv.transition={};try{l(!1),u()}finally{rt=f,wv.transition=_}}function r2(){return yr().memoizedState}function Z3(l,u,f){var _=ea(l);if(f={lane:_,action:f,hasEagerState:!1,eagerState:null,next:null},s2(l))o2(u,f);else if(f=DT(l,u,f,_),f!==null){var v=mi();Br(f,l,_,v),a2(f,u,_)}}function J3(l,u,f){var _=ea(l),v={lane:_,action:f,hasEagerState:!1,eagerState:null,next:null};if(s2(l))o2(u,v);else{var x=l.alternate;if(l.lanes===0&&(x===null||x.lanes===0)&&(x=u.lastRenderedReducer,x!==null))try{var b=u.lastRenderedState,$=x(b,f);if(v.hasEagerState=!0,v.eagerState=$,Vr($,b)){var H=u.interleaved;H===null?(v.next=v,mv(u)):(v.next=H.next,H.next=v),u.interleaved=v;return}}catch{}f=DT(l,u,v,_),f!==null&&(v=mi(),Br(f,l,_,v),a2(f,u,_))}}function s2(l){var u=l.alternate;return l===Wt||u!==null&&u===Wt}function o2(l,u){Cd=Qm=!0;var f=l.pending;f===null?u.next=u:(u.next=f.next,f.next=u),l.pending=u}function a2(l,u,f){if((f&4194240)!==0){var _=u.lanes;_&=l.pendingLanes,f|=_,u.lanes=f,od(l,f)}}var ep={readContext:_r,useCallback:Xn,useContext:Xn,useEffect:Xn,useImperativeHandle:Xn,useInsertionEffect:Xn,useLayoutEffect:Xn,useMemo:Xn,useReducer:Xn,useRef:Xn,useState:Xn,useDebugValue:Xn,useDeferredValue:Xn,useTransition:Xn,useMutableSource:Xn,useSyncExternalStore:Xn,useId:Xn,unstable_isNewReconciler:!1},e5={readContext:_r,useCallback:function(l,u){return ws().memoizedState=[l,u===void 0?null:u],l},useContext:_r,useEffect:XT,useImperativeHandle:function(l,u,f){return f=f!=null?f.concat([l]):null,Zm(4194308,4,JT.bind(null,u,l),f)},useLayoutEffect:function(l,u){return Zm(4194308,4,l,u)},useInsertionEffect:function(l,u){return Zm(4,2,l,u)},useMemo:function(l,u){var f=ws();return u=u===void 0?null:u,l=l(),f.memoizedState=[l,u],l},useReducer:function(l,u,f){var _=ws();return u=f!==void 0?f(u):u,_.memoizedState=_.baseState=u,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:l,lastRenderedState:u},_.queue=l,l=l.dispatch=Z3.bind(null,Wt,l),[_.memoizedState,l]},useRef:function(l){var u=ws();return l={current:l},u.memoizedState=l},useState:qT,useDebugValue:Av,useDeferredValue:function(l){return ws().memoizedState=l},useTransition:function(){var l=qT(!1),u=l[0];return l=Q3.bind(null,l[1]),ws().memoizedState=l,[u,l]},useMutableSource:function(){},useSyncExternalStore:function(l,u,f){var _=Wt,v=ws();if(jt){if(f===void 0)throw Error(t(407));f=f()}else{if(f=u(),Rn===null)throw Error(t(349));(xl&30)!==0||zT(_,u,f)}v.memoizedState=f;var x={value:f,getSnapshot:u};return v.queue=x,XT(WT.bind(null,_,x,l),[l]),_.flags|=2048,kd(9,$T.bind(null,_,x,f,u),void 0,null),f},useId:function(){var l=ws(),u=Rn.identifierPrefix;if(jt){var f=to,_=eo;f=(_&~(1<<32-zi(_)-1)).toString(32)+f,u=":"+u+"R"+f,f=Md++,0<f&&(u+="H"+f.toString(32)),u+=":"}else f=X3++,u=":"+u+"r"+f.toString(32)+":";return l.memoizedState=u},unstable_isNewReconciler:!1},t5={readContext:_r,useCallback:t2,useContext:_r,useEffect:Pv,useImperativeHandle:e2,useInsertionEffect:QT,useLayoutEffect:ZT,useMemo:n2,useReducer:Tv,useRef:YT,useState:function(){return Tv(bd)},useDebugValue:Av,useDeferredValue:function(l){var u=yr();return i2(u,pn.memoizedState,l)},useTransition:function(){var l=Tv(bd)[0],u=yr().memoizedState;return[l,u]},useMutableSource:UT,useSyncExternalStore:BT,useId:r2,unstable_isNewReconciler:!1},n5={readContext:_r,useCallback:t2,useContext:_r,useEffect:Pv,useImperativeHandle:e2,useInsertionEffect:QT,useLayoutEffect:ZT,useMemo:n2,useReducer:Rv,useRef:YT,useState:function(){return Rv(bd)},useDebugValue:Av,useDeferredValue:function(l){var u=yr();return pn===null?u.memoizedState=l:i2(u,pn.memoizedState,l)},useTransition:function(){var l=Rv(bd)[0],u=yr().memoizedState;return[l,u]},useMutableSource:UT,useSyncExternalStore:BT,useId:r2,unstable_isNewReconciler:!1};function Gr(l,u){if(l&&l.defaultProps){u=K({},u),l=l.defaultProps;for(var f in l)u[f]===void 0&&(u[f]=l[f]);return u}return u}function Cv(l,u,f,_){u=l.memoizedState,f=f(_,u),f=f==null?u:K({},u,f),l.memoizedState=f,l.lanes===0&&(l.updateQueue.baseState=f)}var tp={isMounted:function(l){return(l=l._reactInternals)?Or(l)===l:!1},enqueueSetState:function(l,u,f){l=l._reactInternals;var _=mi(),v=ea(l),x=io(_,v);x.payload=u,f!=null&&(x.callback=f),u=Xo(l,x,v),u!==null&&(Br(u,l,v,_),Km(u,l,v))},enqueueReplaceState:function(l,u,f){l=l._reactInternals;var _=mi(),v=ea(l),x=io(_,v);x.tag=1,x.payload=u,f!=null&&(x.callback=f),u=Xo(l,x,v),u!==null&&(Br(u,l,v,_),Km(u,l,v))},enqueueForceUpdate:function(l,u){l=l._reactInternals;var f=mi(),_=ea(l),v=io(f,_);v.tag=2,u!=null&&(v.callback=u),u=Xo(l,v,_),u!==null&&(Br(u,l,_,f),Km(u,l,_))}};function l2(l,u,f,_,v,x,b){return l=l.stateNode,typeof l.shouldComponentUpdate=="function"?l.shouldComponentUpdate(_,x,b):u.prototype&&u.prototype.isPureReactComponent?!yd(f,_)||!yd(v,x):!0}function c2(l,u,f){var _=!1,v=Ko,x=u.contextType;return typeof x=="object"&&x!==null?x=_r(x):(v=Ti(u)?_l:Yn.current,_=u.contextTypes,x=(_=_!=null)?lu(l,v):Ko),u=new u(f,x),l.memoizedState=u.state!==null&&u.state!==void 0?u.state:null,u.updater=tp,l.stateNode=u,u._reactInternals=l,_&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=v,l.__reactInternalMemoizedMaskedChildContext=x),u}function u2(l,u,f,_){l=u.state,typeof u.componentWillReceiveProps=="function"&&u.componentWillReceiveProps(f,_),typeof u.UNSAFE_componentWillReceiveProps=="function"&&u.UNSAFE_componentWillReceiveProps(f,_),u.state!==l&&tp.enqueueReplaceState(u,u.state,null)}function Mv(l,u,f,_){var v=l.stateNode;v.props=f,v.state=l.memoizedState,v.refs={},pv(l);var x=u.contextType;typeof x=="object"&&x!==null?v.context=_r(x):(x=Ti(u)?_l:Yn.current,v.context=lu(l,x)),v.state=l.memoizedState,x=u.getDerivedStateFromProps,typeof x=="function"&&(Cv(l,u,x,f),v.state=l.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(u=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),u!==v.state&&tp.enqueueReplaceState(v,v.state,null),qm(l,f,v,_),v.state=l.memoizedState),typeof v.componentDidMount=="function"&&(l.flags|=4194308)}function pu(l,u){try{var f="",_=u;do f+=fe(_),_=_.return;while(_);var v=f}catch(x){v=`
Error generating stack: `+x.message+`
`+x.stack}return{value:l,source:u,stack:v,digest:null}}function bv(l,u,f){return{value:l,source:null,stack:f??null,digest:u??null}}function kv(l,u){try{console.error(u.value)}catch(f){setTimeout(function(){throw f})}}var i5=typeof WeakMap=="function"?WeakMap:Map;function h2(l,u,f){f=io(-1,f),f.tag=3,f.payload={element:null};var _=u.value;return f.callback=function(){lp||(lp=!0,Kv=_),kv(l,u)},f}function d2(l,u,f){f=io(-1,f),f.tag=3;var _=l.type.getDerivedStateFromError;if(typeof _=="function"){var v=u.value;f.payload=function(){return _(v)},f.callback=function(){kv(l,u)}}var x=l.stateNode;return x!==null&&typeof x.componentDidCatch=="function"&&(f.callback=function(){kv(l,u),typeof _!="function"&&(Zo===null?Zo=new Set([this]):Zo.add(this));var b=u.stack;this.componentDidCatch(u.value,{componentStack:b!==null?b:""})}),f}function f2(l,u,f){var _=l.pingCache;if(_===null){_=l.pingCache=new i5;var v=new Set;_.set(u,v)}else v=_.get(u),v===void 0&&(v=new Set,_.set(u,v));v.has(f)||(v.add(f),l=_5.bind(null,l,u,f),u.then(l,l))}function g2(l){do{var u;if((u=l.tag===13)&&(u=l.memoizedState,u=u!==null?u.dehydrated!==null:!0),u)return l;l=l.return}while(l!==null);return null}function m2(l,u,f,_,v){return(l.mode&1)===0?(l===u?l.flags|=65536:(l.flags|=128,f.flags|=131072,f.flags&=-52805,f.tag===1&&(f.alternate===null?f.tag=17:(u=io(-1,1),u.tag=2,Xo(f,u,1))),f.lanes|=1),l):(l.flags|=65536,l.lanes=v,l)}var r5=D.ReactCurrentOwner,Ri=!1;function gi(l,u,f,_){u.child=l===null?OT(u,null,f,_):du(u,l.child,f,_)}function p2(l,u,f,_,v){f=f.render;var x=u.ref;return gu(u,v),_=Sv(l,u,f,_,x,v),f=Iv(),l!==null&&!Ri?(u.updateQueue=l.updateQueue,u.flags&=-2053,l.lanes&=~v,ro(l,u,v)):(jt&&f&&ov(u),u.flags|=1,gi(l,u,_,v),u.child)}function _2(l,u,f,_,v){if(l===null){var x=f.type;return typeof x=="function"&&!e1(x)&&x.defaultProps===void 0&&f.compare===null&&f.defaultProps===void 0?(u.tag=15,u.type=x,y2(l,u,x,_,v)):(l=gp(f.type,null,_,u,u.mode,v),l.ref=u.ref,l.return=u,u.child=l)}if(x=l.child,(l.lanes&v)===0){var b=x.memoizedProps;if(f=f.compare,f=f!==null?f:yd,f(b,_)&&l.ref===u.ref)return ro(l,u,v)}return u.flags|=1,l=na(x,_),l.ref=u.ref,l.return=u,u.child=l}function y2(l,u,f,_,v){if(l!==null){var x=l.memoizedProps;if(yd(x,_)&&l.ref===u.ref)if(Ri=!1,u.pendingProps=_=x,(l.lanes&v)!==0)(l.flags&131072)!==0&&(Ri=!0);else return u.lanes=l.lanes,ro(l,u,v)}return Lv(l,u,f,_,v)}function v2(l,u,f){var _=u.pendingProps,v=_.children,x=l!==null?l.memoizedState:null;if(_.mode==="hidden")if((u.mode&1)===0)u.memoizedState={baseLanes:0,cachePool:null,transitions:null},bt(yu,Xi),Xi|=f;else{if((f&1073741824)===0)return l=x!==null?x.baseLanes|f:f,u.lanes=u.childLanes=1073741824,u.memoizedState={baseLanes:l,cachePool:null,transitions:null},u.updateQueue=null,bt(yu,Xi),Xi|=l,null;u.memoizedState={baseLanes:0,cachePool:null,transitions:null},_=x!==null?x.baseLanes:f,bt(yu,Xi),Xi|=_}else x!==null?(_=x.baseLanes|f,u.memoizedState=null):_=f,bt(yu,Xi),Xi|=_;return gi(l,u,v,f),u.child}function E2(l,u){var f=u.ref;(l===null&&f!==null||l!==null&&l.ref!==f)&&(u.flags|=512,u.flags|=2097152)}function Lv(l,u,f,_,v){var x=Ti(f)?_l:Yn.current;return x=lu(u,x),gu(u,v),f=Sv(l,u,f,_,x,v),_=Iv(),l!==null&&!Ri?(u.updateQueue=l.updateQueue,u.flags&=-2053,l.lanes&=~v,ro(l,u,v)):(jt&&_&&ov(u),u.flags|=1,gi(l,u,f,v),u.child)}function w2(l,u,f,_,v){if(Ti(f)){var x=!0;Gm(u)}else x=!1;if(gu(u,v),u.stateNode===null)ip(l,u),c2(u,f,_),Mv(u,f,_,v),_=!0;else if(l===null){var b=u.stateNode,$=u.memoizedProps;b.props=$;var H=b.context,ie=f.contextType;typeof ie=="object"&&ie!==null?ie=_r(ie):(ie=Ti(f)?_l:Yn.current,ie=lu(u,ie));var ge=f.getDerivedStateFromProps,me=typeof ge=="function"||typeof b.getSnapshotBeforeUpdate=="function";me||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||($!==_||H!==ie)&&u2(u,b,_,ie),Yo=!1;var ue=u.memoizedState;b.state=ue,qm(u,_,b,v),H=u.memoizedState,$!==_||ue!==H||Ii.current||Yo?(typeof ge=="function"&&(Cv(u,f,ge,_),H=u.memoizedState),($=Yo||l2(u,f,$,_,ue,H,ie))?(me||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount()),typeof b.componentDidMount=="function"&&(u.flags|=4194308)):(typeof b.componentDidMount=="function"&&(u.flags|=4194308),u.memoizedProps=_,u.memoizedState=H),b.props=_,b.state=H,b.context=ie,_=$):(typeof b.componentDidMount=="function"&&(u.flags|=4194308),_=!1)}else{b=u.stateNode,VT(l,u),$=u.memoizedProps,ie=u.type===u.elementType?$:Gr(u.type,$),b.props=ie,me=u.pendingProps,ue=b.context,H=f.contextType,typeof H=="object"&&H!==null?H=_r(H):(H=Ti(f)?_l:Yn.current,H=lu(u,H));var Re=f.getDerivedStateFromProps;(ge=typeof Re=="function"||typeof b.getSnapshotBeforeUpdate=="function")||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||($!==me||ue!==H)&&u2(u,b,_,H),Yo=!1,ue=u.memoizedState,b.state=ue,qm(u,_,b,v);var Ce=u.memoizedState;$!==me||ue!==Ce||Ii.current||Yo?(typeof Re=="function"&&(Cv(u,f,Re,_),Ce=u.memoizedState),(ie=Yo||l2(u,f,ie,_,ue,Ce,H)||!1)?(ge||typeof b.UNSAFE_componentWillUpdate!="function"&&typeof b.componentWillUpdate!="function"||(typeof b.componentWillUpdate=="function"&&b.componentWillUpdate(_,Ce,H),typeof b.UNSAFE_componentWillUpdate=="function"&&b.UNSAFE_componentWillUpdate(_,Ce,H)),typeof b.componentDidUpdate=="function"&&(u.flags|=4),typeof b.getSnapshotBeforeUpdate=="function"&&(u.flags|=1024)):(typeof b.componentDidUpdate!="function"||$===l.memoizedProps&&ue===l.memoizedState||(u.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||$===l.memoizedProps&&ue===l.memoizedState||(u.flags|=1024),u.memoizedProps=_,u.memoizedState=Ce),b.props=_,b.state=Ce,b.context=H,_=ie):(typeof b.componentDidUpdate!="function"||$===l.memoizedProps&&ue===l.memoizedState||(u.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||$===l.memoizedProps&&ue===l.memoizedState||(u.flags|=1024),_=!1)}return Nv(l,u,f,_,x,v)}function Nv(l,u,f,_,v,x){E2(l,u);var b=(u.flags&128)!==0;if(!_&&!b)return v&&RT(u,f,!1),ro(l,u,x);_=u.stateNode,r5.current=u;var $=b&&typeof f.getDerivedStateFromError!="function"?null:_.render();return u.flags|=1,l!==null&&b?(u.child=du(u,l.child,null,x),u.child=du(u,null,$,x)):gi(l,u,$,x),u.memoizedState=_.state,v&&RT(u,f,!0),u.child}function x2(l){var u=l.stateNode;u.pendingContext?IT(l,u.pendingContext,u.pendingContext!==u.context):u.context&&IT(l,u.context,!1),_v(l,u.containerInfo)}function S2(l,u,f,_,v){return hu(),uv(v),u.flags|=256,gi(l,u,f,_),u.child}var Ov={dehydrated:null,treeContext:null,retryLane:0};function Dv(l){return{baseLanes:l,cachePool:null,transitions:null}}function I2(l,u,f){var _=u.pendingProps,v=$t.current,x=!1,b=(u.flags&128)!==0,$;if(($=b)||($=l!==null&&l.memoizedState===null?!1:(v&2)!==0),$?(x=!0,u.flags&=-129):(l===null||l.memoizedState!==null)&&(v|=1),bt($t,v&1),l===null)return cv(u),l=u.memoizedState,l!==null&&(l=l.dehydrated,l!==null)?((u.mode&1)===0?u.lanes=1:l.data==="$!"?u.lanes=8:u.lanes=1073741824,null):(b=_.children,l=_.fallback,x?(_=u.mode,x=u.child,b={mode:"hidden",children:b},(_&1)===0&&x!==null?(x.childLanes=0,x.pendingProps=b):x=mp(b,_,0,null),l=Pl(l,_,f,null),x.return=u,l.return=u,x.sibling=l,u.child=x,u.child.memoizedState=Dv(f),u.memoizedState=Ov,l):Vv(u,b));if(v=l.memoizedState,v!==null&&($=v.dehydrated,$!==null))return s5(l,u,b,_,$,v,f);if(x){x=_.fallback,b=u.mode,v=l.child,$=v.sibling;var H={mode:"hidden",children:_.children};return(b&1)===0&&u.child!==v?(_=u.child,_.childLanes=0,_.pendingProps=H,u.deletions=null):(_=na(v,H),_.subtreeFlags=v.subtreeFlags&14680064),$!==null?x=na($,x):(x=Pl(x,b,f,null),x.flags|=2),x.return=u,_.return=u,_.sibling=x,u.child=_,_=x,x=u.child,b=l.child.memoizedState,b=b===null?Dv(f):{baseLanes:b.baseLanes|f,cachePool:null,transitions:b.transitions},x.memoizedState=b,x.childLanes=l.childLanes&~f,u.memoizedState=Ov,_}return x=l.child,l=x.sibling,_=na(x,{mode:"visible",children:_.children}),(u.mode&1)===0&&(_.lanes=f),_.return=u,_.sibling=null,l!==null&&(f=u.deletions,f===null?(u.deletions=[l],u.flags|=16):f.push(l)),u.child=_,u.memoizedState=null,_}function Vv(l,u){return u=mp({mode:"visible",children:u},l.mode,0,null),u.return=l,l.child=u}function np(l,u,f,_){return _!==null&&uv(_),du(u,l.child,null,f),l=Vv(u,u.pendingProps.children),l.flags|=2,u.memoizedState=null,l}function s5(l,u,f,_,v,x,b){if(f)return u.flags&256?(u.flags&=-257,_=bv(Error(t(422))),np(l,u,b,_)):u.memoizedState!==null?(u.child=l.child,u.flags|=128,null):(x=_.fallback,v=u.mode,_=mp({mode:"visible",children:_.children},v,0,null),x=Pl(x,v,b,null),x.flags|=2,_.return=u,x.return=u,_.sibling=x,u.child=_,(u.mode&1)!==0&&du(u,l.child,null,b),u.child.memoizedState=Dv(b),u.memoizedState=Ov,x);if((u.mode&1)===0)return np(l,u,b,null);if(v.data==="$!"){if(_=v.nextSibling&&v.nextSibling.dataset,_)var $=_.dgst;return _=$,x=Error(t(419)),_=bv(x,_,void 0),np(l,u,b,_)}if($=(b&l.childLanes)!==0,Ri||$){if(_=Rn,_!==null){switch(b&-b){case 4:v=2;break;case 16:v=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:v=32;break;case 536870912:v=268435456;break;default:v=0}v=(v&(_.suspendedLanes|b))!==0?0:v,v!==0&&v!==x.retryLane&&(x.retryLane=v,no(l,v),Br(_,l,v,-1))}return Jv(),_=bv(Error(t(421))),np(l,u,b,_)}return v.data==="$?"?(u.flags|=128,u.child=l.child,u=y5.bind(null,l),v._reactRetry=u,null):(l=x.treeContext,Yi=Wo(v.nextSibling),qi=u,jt=!0,Fr=null,l!==null&&(mr[pr++]=eo,mr[pr++]=to,mr[pr++]=yl,eo=l.id,to=l.overflow,yl=u),u=Vv(u,_.children),u.flags|=4096,u)}function T2(l,u,f){l.lanes|=u;var _=l.alternate;_!==null&&(_.lanes|=u),gv(l.return,u,f)}function Fv(l,u,f,_,v){var x=l.memoizedState;x===null?l.memoizedState={isBackwards:u,rendering:null,renderingStartTime:0,last:_,tail:f,tailMode:v}:(x.isBackwards=u,x.rendering=null,x.renderingStartTime=0,x.last=_,x.tail=f,x.tailMode=v)}function R2(l,u,f){var _=u.pendingProps,v=_.revealOrder,x=_.tail;if(gi(l,u,_.children,f),_=$t.current,(_&2)!==0)_=_&1|2,u.flags|=128;else{if(l!==null&&(l.flags&128)!==0)e:for(l=u.child;l!==null;){if(l.tag===13)l.memoizedState!==null&&T2(l,f,u);else if(l.tag===19)T2(l,f,u);else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===u)break e;for(;l.sibling===null;){if(l.return===null||l.return===u)break e;l=l.return}l.sibling.return=l.return,l=l.sibling}_&=1}if(bt($t,_),(u.mode&1)===0)u.memoizedState=null;else switch(v){case"forwards":for(f=u.child,v=null;f!==null;)l=f.alternate,l!==null&&Ym(l)===null&&(v=f),f=f.sibling;f=v,f===null?(v=u.child,u.child=null):(v=f.sibling,f.sibling=null),Fv(u,!1,v,f,x);break;case"backwards":for(f=null,v=u.child,u.child=null;v!==null;){if(l=v.alternate,l!==null&&Ym(l)===null){u.child=v;break}l=v.sibling,v.sibling=f,f=v,v=l}Fv(u,!0,f,null,x);break;case"together":Fv(u,!1,null,null,void 0);break;default:u.memoizedState=null}return u.child}function ip(l,u){(u.mode&1)===0&&l!==null&&(l.alternate=null,u.alternate=null,u.flags|=2)}function ro(l,u,f){if(l!==null&&(u.dependencies=l.dependencies),Sl|=u.lanes,(f&u.childLanes)===0)return null;if(l!==null&&u.child!==l.child)throw Error(t(153));if(u.child!==null){for(l=u.child,f=na(l,l.pendingProps),u.child=f,f.return=u;l.sibling!==null;)l=l.sibling,f=f.sibling=na(l,l.pendingProps),f.return=u;f.sibling=null}return u.child}function o5(l,u,f){switch(u.tag){case 3:x2(u),hu();break;case 5:jT(u);break;case 1:Ti(u.type)&&Gm(u);break;case 4:_v(u,u.stateNode.containerInfo);break;case 10:var _=u.type._context,v=u.memoizedProps.value;bt(Wm,_._currentValue),_._currentValue=v;break;case 13:if(_=u.memoizedState,_!==null)return _.dehydrated!==null?(bt($t,$t.current&1),u.flags|=128,null):(f&u.child.childLanes)!==0?I2(l,u,f):(bt($t,$t.current&1),l=ro(l,u,f),l!==null?l.sibling:null);bt($t,$t.current&1);break;case 19:if(_=(f&u.childLanes)!==0,(l.flags&128)!==0){if(_)return R2(l,u,f);u.flags|=128}if(v=u.memoizedState,v!==null&&(v.rendering=null,v.tail=null,v.lastEffect=null),bt($t,$t.current),_)break;return null;case 22:case 23:return u.lanes=0,v2(l,u,f)}return ro(l,u,f)}var P2,Gv,A2,C2;P2=function(l,u){for(var f=u.child;f!==null;){if(f.tag===5||f.tag===6)l.appendChild(f.stateNode);else if(f.tag!==4&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===u)break;for(;f.sibling===null;){if(f.return===null||f.return===u)return;f=f.return}f.sibling.return=f.return,f=f.sibling}},Gv=function(){},A2=function(l,u,f,_){var v=l.memoizedProps;if(v!==_){l=u.stateNode,wl(Es.current);var x=null;switch(f){case"input":v=xi(l,v),_=xi(l,_),x=[];break;case"select":v=K({},v,{value:void 0}),_=K({},_,{value:void 0}),x=[];break;case"textarea":v=lr(l,v),_=lr(l,_),x=[];break;default:typeof v.onClick!="function"&&typeof _.onClick=="function"&&(l.onclick=Dm)}hi(f,_);var b;f=null;for(ie in v)if(!_.hasOwnProperty(ie)&&v.hasOwnProperty(ie)&&v[ie]!=null)if(ie==="style"){var $=v[ie];for(b in $)$.hasOwnProperty(b)&&(f||(f={}),f[b]="")}else ie!=="dangerouslySetInnerHTML"&&ie!=="children"&&ie!=="suppressContentEditableWarning"&&ie!=="suppressHydrationWarning"&&ie!=="autoFocus"&&(r.hasOwnProperty(ie)?x||(x=[]):(x=x||[]).push(ie,null));for(ie in _){var H=_[ie];if($=v?.[ie],_.hasOwnProperty(ie)&&H!==$&&(H!=null||$!=null))if(ie==="style")if($){for(b in $)!$.hasOwnProperty(b)||H&&H.hasOwnProperty(b)||(f||(f={}),f[b]="");for(b in H)H.hasOwnProperty(b)&&$[b]!==H[b]&&(f||(f={}),f[b]=H[b])}else f||(x||(x=[]),x.push(ie,f)),f=H;else ie==="dangerouslySetInnerHTML"?(H=H?H.__html:void 0,$=$?$.__html:void 0,H!=null&&$!==H&&(x=x||[]).push(ie,H)):ie==="children"?typeof H!="string"&&typeof H!="number"||(x=x||[]).push(ie,""+H):ie!=="suppressContentEditableWarning"&&ie!=="suppressHydrationWarning"&&(r.hasOwnProperty(ie)?(H!=null&&ie==="onScroll"&&Lt("scroll",l),x||$===H||(x=[])):(x=x||[]).push(ie,H))}f&&(x=x||[]).push("style",f);var ie=x;(u.updateQueue=ie)&&(u.flags|=4)}},C2=function(l,u,f,_){f!==_&&(u.flags|=4)};function Ld(l,u){if(!jt)switch(l.tailMode){case"hidden":u=l.tail;for(var f=null;u!==null;)u.alternate!==null&&(f=u),u=u.sibling;f===null?l.tail=null:f.sibling=null;break;case"collapsed":f=l.tail;for(var _=null;f!==null;)f.alternate!==null&&(_=f),f=f.sibling;_===null?u||l.tail===null?l.tail=null:l.tail.sibling=null:_.sibling=null}}function Qn(l){var u=l.alternate!==null&&l.alternate.child===l.child,f=0,_=0;if(u)for(var v=l.child;v!==null;)f|=v.lanes|v.childLanes,_|=v.subtreeFlags&14680064,_|=v.flags&14680064,v.return=l,v=v.sibling;else for(v=l.child;v!==null;)f|=v.lanes|v.childLanes,_|=v.subtreeFlags,_|=v.flags,v.return=l,v=v.sibling;return l.subtreeFlags|=_,l.childLanes=f,u}function a5(l,u,f){var _=u.pendingProps;switch(av(u),u.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qn(u),null;case 1:return Ti(u.type)&&Fm(),Qn(u),null;case 3:return _=u.stateNode,mu(),Nt(Ii),Nt(Yn),Ev(),_.pendingContext&&(_.context=_.pendingContext,_.pendingContext=null),(l===null||l.child===null)&&(zm(u)?u.flags|=4:l===null||l.memoizedState.isDehydrated&&(u.flags&256)===0||(u.flags|=1024,Fr!==null&&(Xv(Fr),Fr=null))),Gv(l,u),Qn(u),null;case 5:yv(u);var v=wl(Ad.current);if(f=u.type,l!==null&&u.stateNode!=null)A2(l,u,f,_,v),l.ref!==u.ref&&(u.flags|=512,u.flags|=2097152);else{if(!_){if(u.stateNode===null)throw Error(t(166));return Qn(u),null}if(l=wl(Es.current),zm(u)){_=u.stateNode,f=u.type;var x=u.memoizedProps;switch(_[vs]=u,_[Sd]=x,l=(u.mode&1)!==0,f){case"dialog":Lt("cancel",_),Lt("close",_);break;case"iframe":case"object":case"embed":Lt("load",_);break;case"video":case"audio":for(v=0;v<Ed.length;v++)Lt(Ed[v],_);break;case"source":Lt("error",_);break;case"img":case"image":case"link":Lt("error",_),Lt("load",_);break;case"details":Lt("toggle",_);break;case"input":kn(_,x),Lt("invalid",_);break;case"select":_._wrapperState={wasMultiple:!!x.multiple},Lt("invalid",_);break;case"textarea":Gt(_,x),Lt("invalid",_)}hi(f,x),v=null;for(var b in x)if(x.hasOwnProperty(b)){var $=x[b];b==="children"?typeof $=="string"?_.textContent!==$&&(x.suppressHydrationWarning!==!0&&Om(_.textContent,$,l),v=["children",$]):typeof $=="number"&&_.textContent!==""+$&&(x.suppressHydrationWarning!==!0&&Om(_.textContent,$,l),v=["children",""+$]):r.hasOwnProperty(b)&&$!=null&&b==="onScroll"&&Lt("scroll",_)}switch(f){case"input":Pt(_),ar(_,x,!0);break;case"textarea":Pt(_),cr(_);break;case"select":case"option":break;default:typeof x.onClick=="function"&&(_.onclick=Dm)}_=v,u.updateQueue=_,_!==null&&(u.flags|=4)}else{b=v.nodeType===9?v:v.ownerDocument,l==="http://www.w3.org/1999/xhtml"&&(l=ts(f)),l==="http://www.w3.org/1999/xhtml"?f==="script"?(l=b.createElement("div"),l.innerHTML="<script><\/script>",l=l.removeChild(l.firstChild)):typeof _.is=="string"?l=b.createElement(f,{is:_.is}):(l=b.createElement(f),f==="select"&&(b=l,_.multiple?b.multiple=!0:_.size&&(b.size=_.size))):l=b.createElementNS(l,f),l[vs]=u,l[Sd]=_,P2(l,u,!1,!1),u.stateNode=l;e:{switch(b=$s(f,_),f){case"dialog":Lt("cancel",l),Lt("close",l),v=_;break;case"iframe":case"object":case"embed":Lt("load",l),v=_;break;case"video":case"audio":for(v=0;v<Ed.length;v++)Lt(Ed[v],l);v=_;break;case"source":Lt("error",l),v=_;break;case"img":case"image":case"link":Lt("error",l),Lt("load",l),v=_;break;case"details":Lt("toggle",l),v=_;break;case"input":kn(l,_),v=xi(l,_),Lt("invalid",l);break;case"option":v=_;break;case"select":l._wrapperState={wasMultiple:!!_.multiple},v=K({},_,{value:void 0}),Lt("invalid",l);break;case"textarea":Gt(l,_),v=lr(l,_),Lt("invalid",l);break;default:v=_}hi(f,v),$=v;for(x in $)if($.hasOwnProperty(x)){var H=$[x];x==="style"?zs(l,H):x==="dangerouslySetInnerHTML"?(H=H?H.__html:void 0,H!=null&&il(l,H)):x==="children"?typeof H=="string"?(f!=="textarea"||H!=="")&&is(l,H):typeof H=="number"&&is(l,""+H):x!=="suppressContentEditableWarning"&&x!=="suppressHydrationWarning"&&x!=="autoFocus"&&(r.hasOwnProperty(x)?H!=null&&x==="onScroll"&&Lt("scroll",l):H!=null&&N(l,x,H,b))}switch(f){case"input":Pt(l),ar(l,_,!1);break;case"textarea":Pt(l),cr(l);break;case"option":_.value!=null&&l.setAttribute("value",""+te(_.value));break;case"select":l.multiple=!!_.multiple,x=_.value,x!=null?Sn(l,!!_.multiple,x,!1):_.defaultValue!=null&&Sn(l,!!_.multiple,_.defaultValue,!0);break;default:typeof v.onClick=="function"&&(l.onclick=Dm)}switch(f){case"button":case"input":case"select":case"textarea":_=!!_.autoFocus;break e;case"img":_=!0;break e;default:_=!1}}_&&(u.flags|=4)}u.ref!==null&&(u.flags|=512,u.flags|=2097152)}return Qn(u),null;case 6:if(l&&u.stateNode!=null)C2(l,u,l.memoizedProps,_);else{if(typeof _!="string"&&u.stateNode===null)throw Error(t(166));if(f=wl(Ad.current),wl(Es.current),zm(u)){if(_=u.stateNode,f=u.memoizedProps,_[vs]=u,(x=_.nodeValue!==f)&&(l=qi,l!==null))switch(l.tag){case 3:Om(_.nodeValue,f,(l.mode&1)!==0);break;case 5:l.memoizedProps.suppressHydrationWarning!==!0&&Om(_.nodeValue,f,(l.mode&1)!==0)}x&&(u.flags|=4)}else _=(f.nodeType===9?f:f.ownerDocument).createTextNode(_),_[vs]=u,u.stateNode=_}return Qn(u),null;case 13:if(Nt($t),_=u.memoizedState,l===null||l.memoizedState!==null&&l.memoizedState.dehydrated!==null){if(jt&&Yi!==null&&(u.mode&1)!==0&&(u.flags&128)===0)kT(),hu(),u.flags|=98560,x=!1;else if(x=zm(u),_!==null&&_.dehydrated!==null){if(l===null){if(!x)throw Error(t(318));if(x=u.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(t(317));x[vs]=u}else hu(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;Qn(u),x=!1}else Fr!==null&&(Xv(Fr),Fr=null),x=!0;if(!x)return u.flags&65536?u:null}return(u.flags&128)!==0?(u.lanes=f,u):(_=_!==null,_!==(l!==null&&l.memoizedState!==null)&&_&&(u.child.flags|=8192,(u.mode&1)!==0&&(l===null||($t.current&1)!==0?_n===0&&(_n=3):Jv())),u.updateQueue!==null&&(u.flags|=4),Qn(u),null);case 4:return mu(),Gv(l,u),l===null&&wd(u.stateNode.containerInfo),Qn(u),null;case 10:return fv(u.type._context),Qn(u),null;case 17:return Ti(u.type)&&Fm(),Qn(u),null;case 19:if(Nt($t),x=u.memoizedState,x===null)return Qn(u),null;if(_=(u.flags&128)!==0,b=x.rendering,b===null)if(_)Ld(x,!1);else{if(_n!==0||l!==null&&(l.flags&128)!==0)for(l=u.child;l!==null;){if(b=Ym(l),b!==null){for(u.flags|=128,Ld(x,!1),_=b.updateQueue,_!==null&&(u.updateQueue=_,u.flags|=4),u.subtreeFlags=0,_=f,f=u.child;f!==null;)x=f,l=_,x.flags&=14680066,b=x.alternate,b===null?(x.childLanes=0,x.lanes=l,x.child=null,x.subtreeFlags=0,x.memoizedProps=null,x.memoizedState=null,x.updateQueue=null,x.dependencies=null,x.stateNode=null):(x.childLanes=b.childLanes,x.lanes=b.lanes,x.child=b.child,x.subtreeFlags=0,x.deletions=null,x.memoizedProps=b.memoizedProps,x.memoizedState=b.memoizedState,x.updateQueue=b.updateQueue,x.type=b.type,l=b.dependencies,x.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),f=f.sibling;return bt($t,$t.current&1|2),u.child}l=l.sibling}x.tail!==null&&kt()>vu&&(u.flags|=128,_=!0,Ld(x,!1),u.lanes=4194304)}else{if(!_)if(l=Ym(b),l!==null){if(u.flags|=128,_=!0,f=l.updateQueue,f!==null&&(u.updateQueue=f,u.flags|=4),Ld(x,!0),x.tail===null&&x.tailMode==="hidden"&&!b.alternate&&!jt)return Qn(u),null}else 2*kt()-x.renderingStartTime>vu&&f!==1073741824&&(u.flags|=128,_=!0,Ld(x,!1),u.lanes=4194304);x.isBackwards?(b.sibling=u.child,u.child=b):(f=x.last,f!==null?f.sibling=b:u.child=b,x.last=b)}return x.tail!==null?(u=x.tail,x.rendering=u,x.tail=u.sibling,x.renderingStartTime=kt(),u.sibling=null,f=$t.current,bt($t,_?f&1|2:f&1),u):(Qn(u),null);case 22:case 23:return Zv(),_=u.memoizedState!==null,l!==null&&l.memoizedState!==null!==_&&(u.flags|=8192),_&&(u.mode&1)!==0?(Xi&1073741824)!==0&&(Qn(u),u.subtreeFlags&6&&(u.flags|=8192)):Qn(u),null;case 24:return null;case 25:return null}throw Error(t(156,u.tag))}function l5(l,u){switch(av(u),u.tag){case 1:return Ti(u.type)&&Fm(),l=u.flags,l&65536?(u.flags=l&-65537|128,u):null;case 3:return mu(),Nt(Ii),Nt(Yn),Ev(),l=u.flags,(l&65536)!==0&&(l&128)===0?(u.flags=l&-65537|128,u):null;case 5:return yv(u),null;case 13:if(Nt($t),l=u.memoizedState,l!==null&&l.dehydrated!==null){if(u.alternate===null)throw Error(t(340));hu()}return l=u.flags,l&65536?(u.flags=l&-65537|128,u):null;case 19:return Nt($t),null;case 4:return mu(),null;case 10:return fv(u.type._context),null;case 22:case 23:return Zv(),null;case 24:return null;default:return null}}var rp=!1,Zn=!1,c5=typeof WeakSet=="function"?WeakSet:Set,Ae=null;function _u(l,u){var f=l.ref;if(f!==null)if(typeof f=="function")try{f(null)}catch(_){Yt(l,u,_)}else f.current=null}function jv(l,u,f){try{f()}catch(_){Yt(l,u,_)}}var M2=!1;function u5(l,u){if(Zy=Ys,l=lT(),$y(l)){if("selectionStart"in l)var f={start:l.selectionStart,end:l.selectionEnd};else e:{f=(f=l.ownerDocument)&&f.defaultView||window;var _=f.getSelection&&f.getSelection();if(_&&_.rangeCount!==0){f=_.anchorNode;var v=_.anchorOffset,x=_.focusNode;_=_.focusOffset;try{f.nodeType,x.nodeType}catch{f=null;break e}var b=0,$=-1,H=-1,ie=0,ge=0,me=l,ue=null;t:for(;;){for(var Re;me!==f||v!==0&&me.nodeType!==3||($=b+v),me!==x||_!==0&&me.nodeType!==3||(H=b+_),me.nodeType===3&&(b+=me.nodeValue.length),(Re=me.firstChild)!==null;)ue=me,me=Re;for(;;){if(me===l)break t;if(ue===f&&++ie===v&&($=b),ue===x&&++ge===_&&(H=b),(Re=me.nextSibling)!==null)break;me=ue,ue=me.parentNode}me=Re}f=$===-1||H===-1?null:{start:$,end:H}}else f=null}f=f||{start:0,end:0}}else f=null;for(Jy={focusedElem:l,selectionRange:f},Ys=!1,Ae=u;Ae!==null;)if(u=Ae,l=u.child,(u.subtreeFlags&1028)!==0&&l!==null)l.return=u,Ae=l;else for(;Ae!==null;){u=Ae;try{var Ce=u.alternate;if((u.flags&1024)!==0)switch(u.tag){case 0:case 11:case 15:break;case 1:if(Ce!==null){var ke=Ce.memoizedProps,rn=Ce.memoizedState,J=u.stateNode,Y=J.getSnapshotBeforeUpdate(u.elementType===u.type?ke:Gr(u.type,ke),rn);J.__reactInternalSnapshotBeforeUpdate=Y}break;case 3:var ne=u.stateNode.containerInfo;ne.nodeType===1?ne.textContent="":ne.nodeType===9&&ne.documentElement&&ne.removeChild(ne.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(ye){Yt(u,u.return,ye)}if(l=u.sibling,l!==null){l.return=u.return,Ae=l;break}Ae=u.return}return Ce=M2,M2=!1,Ce}function Nd(l,u,f){var _=u.updateQueue;if(_=_!==null?_.lastEffect:null,_!==null){var v=_=_.next;do{if((v.tag&l)===l){var x=v.destroy;v.destroy=void 0,x!==void 0&&jv(u,f,x)}v=v.next}while(v!==_)}}function sp(l,u){if(u=u.updateQueue,u=u!==null?u.lastEffect:null,u!==null){var f=u=u.next;do{if((f.tag&l)===l){var _=f.create;f.destroy=_()}f=f.next}while(f!==u)}}function Uv(l){var u=l.ref;if(u!==null){var f=l.stateNode;switch(l.tag){case 5:l=f;break;default:l=f}typeof u=="function"?u(l):u.current=l}}function b2(l){var u=l.alternate;u!==null&&(l.alternate=null,b2(u)),l.child=null,l.deletions=null,l.sibling=null,l.tag===5&&(u=l.stateNode,u!==null&&(delete u[vs],delete u[Sd],delete u[iv],delete u[H3],delete u[K3])),l.stateNode=null,l.return=null,l.dependencies=null,l.memoizedProps=null,l.memoizedState=null,l.pendingProps=null,l.stateNode=null,l.updateQueue=null}function k2(l){return l.tag===5||l.tag===3||l.tag===4}function L2(l){e:for(;;){for(;l.sibling===null;){if(l.return===null||k2(l.return))return null;l=l.return}for(l.sibling.return=l.return,l=l.sibling;l.tag!==5&&l.tag!==6&&l.tag!==18;){if(l.flags&2||l.child===null||l.tag===4)continue e;l.child.return=l,l=l.child}if(!(l.flags&2))return l.stateNode}}function Bv(l,u,f){var _=l.tag;if(_===5||_===6)l=l.stateNode,u?f.nodeType===8?f.parentNode.insertBefore(l,u):f.insertBefore(l,u):(f.nodeType===8?(u=f.parentNode,u.insertBefore(l,f)):(u=f,u.appendChild(l)),f=f._reactRootContainer,f!=null||u.onclick!==null||(u.onclick=Dm));else if(_!==4&&(l=l.child,l!==null))for(Bv(l,u,f),l=l.sibling;l!==null;)Bv(l,u,f),l=l.sibling}function zv(l,u,f){var _=l.tag;if(_===5||_===6)l=l.stateNode,u?f.insertBefore(l,u):f.appendChild(l);else if(_!==4&&(l=l.child,l!==null))for(zv(l,u,f),l=l.sibling;l!==null;)zv(l,u,f),l=l.sibling}var Gn=null,jr=!1;function Qo(l,u,f){for(f=f.child;f!==null;)N2(l,u,f),f=f.sibling}function N2(l,u,f){if(Bi&&typeof Bi.onCommitFiberUnmount=="function")try{Bi.onCommitFiberUnmount(al,f)}catch{}switch(f.tag){case 5:Zn||_u(f,u);case 6:var _=Gn,v=jr;Gn=null,Qo(l,u,f),Gn=_,jr=v,Gn!==null&&(jr?(l=Gn,f=f.stateNode,l.nodeType===8?l.parentNode.removeChild(f):l.removeChild(f)):Gn.removeChild(f.stateNode));break;case 18:Gn!==null&&(jr?(l=Gn,f=f.stateNode,l.nodeType===8?nv(l.parentNode,f):l.nodeType===1&&nv(l,f),Uo(l)):nv(Gn,f.stateNode));break;case 4:_=Gn,v=jr,Gn=f.stateNode.containerInfo,jr=!0,Qo(l,u,f),Gn=_,jr=v;break;case 0:case 11:case 14:case 15:if(!Zn&&(_=f.updateQueue,_!==null&&(_=_.lastEffect,_!==null))){v=_=_.next;do{var x=v,b=x.destroy;x=x.tag,b!==void 0&&((x&2)!==0||(x&4)!==0)&&jv(f,u,b),v=v.next}while(v!==_)}Qo(l,u,f);break;case 1:if(!Zn&&(_u(f,u),_=f.stateNode,typeof _.componentWillUnmount=="function"))try{_.props=f.memoizedProps,_.state=f.memoizedState,_.componentWillUnmount()}catch($){Yt(f,u,$)}Qo(l,u,f);break;case 21:Qo(l,u,f);break;case 22:f.mode&1?(Zn=(_=Zn)||f.memoizedState!==null,Qo(l,u,f),Zn=_):Qo(l,u,f);break;default:Qo(l,u,f)}}function O2(l){var u=l.updateQueue;if(u!==null){l.updateQueue=null;var f=l.stateNode;f===null&&(f=l.stateNode=new c5),u.forEach(function(_){var v=v5.bind(null,l,_);f.has(_)||(f.add(_),_.then(v,v))})}}function Ur(l,u){var f=u.deletions;if(f!==null)for(var _=0;_<f.length;_++){var v=f[_];try{var x=l,b=u,$=b;e:for(;$!==null;){switch($.tag){case 5:Gn=$.stateNode,jr=!1;break e;case 3:Gn=$.stateNode.containerInfo,jr=!0;break e;case 4:Gn=$.stateNode.containerInfo,jr=!0;break e}$=$.return}if(Gn===null)throw Error(t(160));N2(x,b,v),Gn=null,jr=!1;var H=v.alternate;H!==null&&(H.return=null),v.return=null}catch(ie){Yt(v,u,ie)}}if(u.subtreeFlags&12854)for(u=u.child;u!==null;)D2(u,l),u=u.sibling}function D2(l,u){var f=l.alternate,_=l.flags;switch(l.tag){case 0:case 11:case 14:case 15:if(Ur(u,l),xs(l),_&4){try{Nd(3,l,l.return),sp(3,l)}catch(ke){Yt(l,l.return,ke)}try{Nd(5,l,l.return)}catch(ke){Yt(l,l.return,ke)}}break;case 1:Ur(u,l),xs(l),_&512&&f!==null&&_u(f,f.return);break;case 5:if(Ur(u,l),xs(l),_&512&&f!==null&&_u(f,f.return),l.flags&32){var v=l.stateNode;try{is(v,"")}catch(ke){Yt(l,l.return,ke)}}if(_&4&&(v=l.stateNode,v!=null)){var x=l.memoizedProps,b=f!==null?f.memoizedProps:x,$=l.type,H=l.updateQueue;if(l.updateQueue=null,H!==null)try{$==="input"&&x.type==="radio"&&x.name!=null&&Ln(v,x),$s($,b);var ie=$s($,x);for(b=0;b<H.length;b+=2){var ge=H[b],me=H[b+1];ge==="style"?zs(v,me):ge==="dangerouslySetInnerHTML"?il(v,me):ge==="children"?is(v,me):N(v,ge,me,ie)}switch($){case"input":Si(v,x);break;case"textarea":Oo(v,x);break;case"select":var ue=v._wrapperState.wasMultiple;v._wrapperState.wasMultiple=!!x.multiple;var Re=x.value;Re!=null?Sn(v,!!x.multiple,Re,!1):ue!==!!x.multiple&&(x.defaultValue!=null?Sn(v,!!x.multiple,x.defaultValue,!0):Sn(v,!!x.multiple,x.multiple?[]:"",!1))}v[Sd]=x}catch(ke){Yt(l,l.return,ke)}}break;case 6:if(Ur(u,l),xs(l),_&4){if(l.stateNode===null)throw Error(t(162));v=l.stateNode,x=l.memoizedProps;try{v.nodeValue=x}catch(ke){Yt(l,l.return,ke)}}break;case 3:if(Ur(u,l),xs(l),_&4&&f!==null&&f.memoizedState.isDehydrated)try{Uo(u.containerInfo)}catch(ke){Yt(l,l.return,ke)}break;case 4:Ur(u,l),xs(l);break;case 13:Ur(u,l),xs(l),v=l.child,v.flags&8192&&(x=v.memoizedState!==null,v.stateNode.isHidden=x,!x||v.alternate!==null&&v.alternate.memoizedState!==null||(Hv=kt())),_&4&&O2(l);break;case 22:if(ge=f!==null&&f.memoizedState!==null,l.mode&1?(Zn=(ie=Zn)||ge,Ur(u,l),Zn=ie):Ur(u,l),xs(l),_&8192){if(ie=l.memoizedState!==null,(l.stateNode.isHidden=ie)&&!ge&&(l.mode&1)!==0)for(Ae=l,ge=l.child;ge!==null;){for(me=Ae=ge;Ae!==null;){switch(ue=Ae,Re=ue.child,ue.tag){case 0:case 11:case 14:case 15:Nd(4,ue,ue.return);break;case 1:_u(ue,ue.return);var Ce=ue.stateNode;if(typeof Ce.componentWillUnmount=="function"){_=ue,f=ue.return;try{u=_,Ce.props=u.memoizedProps,Ce.state=u.memoizedState,Ce.componentWillUnmount()}catch(ke){Yt(_,f,ke)}}break;case 5:_u(ue,ue.return);break;case 22:if(ue.memoizedState!==null){G2(me);continue}}Re!==null?(Re.return=ue,Ae=Re):G2(me)}ge=ge.sibling}e:for(ge=null,me=l;;){if(me.tag===5){if(ge===null){ge=me;try{v=me.stateNode,ie?(x=v.style,typeof x.setProperty=="function"?x.setProperty("display","none","important"):x.display="none"):($=me.stateNode,H=me.memoizedProps.style,b=H!=null&&H.hasOwnProperty("display")?H.display:null,$.style.display=rs("display",b))}catch(ke){Yt(l,l.return,ke)}}}else if(me.tag===6){if(ge===null)try{me.stateNode.nodeValue=ie?"":me.memoizedProps}catch(ke){Yt(l,l.return,ke)}}else if((me.tag!==22&&me.tag!==23||me.memoizedState===null||me===l)&&me.child!==null){me.child.return=me,me=me.child;continue}if(me===l)break e;for(;me.sibling===null;){if(me.return===null||me.return===l)break e;ge===me&&(ge=null),me=me.return}ge===me&&(ge=null),me.sibling.return=me.return,me=me.sibling}}break;case 19:Ur(u,l),xs(l),_&4&&O2(l);break;case 21:break;default:Ur(u,l),xs(l)}}function xs(l){var u=l.flags;if(u&2){try{e:{for(var f=l.return;f!==null;){if(k2(f)){var _=f;break e}f=f.return}throw Error(t(160))}switch(_.tag){case 5:var v=_.stateNode;_.flags&32&&(is(v,""),_.flags&=-33);var x=L2(l);zv(l,x,v);break;case 3:case 4:var b=_.stateNode.containerInfo,$=L2(l);Bv(l,$,b);break;default:throw Error(t(161))}}catch(H){Yt(l,l.return,H)}l.flags&=-3}u&4096&&(l.flags&=-4097)}function h5(l,u,f){Ae=l,V2(l)}function V2(l,u,f){for(var _=(l.mode&1)!==0;Ae!==null;){var v=Ae,x=v.child;if(v.tag===22&&_){var b=v.memoizedState!==null||rp;if(!b){var $=v.alternate,H=$!==null&&$.memoizedState!==null||Zn;$=rp;var ie=Zn;if(rp=b,(Zn=H)&&!ie)for(Ae=v;Ae!==null;)b=Ae,H=b.child,b.tag===22&&b.memoizedState!==null?j2(v):H!==null?(H.return=b,Ae=H):j2(v);for(;x!==null;)Ae=x,V2(x),x=x.sibling;Ae=v,rp=$,Zn=ie}F2(l)}else(v.subtreeFlags&8772)!==0&&x!==null?(x.return=v,Ae=x):F2(l)}}function F2(l){for(;Ae!==null;){var u=Ae;if((u.flags&8772)!==0){var f=u.alternate;try{if((u.flags&8772)!==0)switch(u.tag){case 0:case 11:case 15:Zn||sp(5,u);break;case 1:var _=u.stateNode;if(u.flags&4&&!Zn)if(f===null)_.componentDidMount();else{var v=u.elementType===u.type?f.memoizedProps:Gr(u.type,f.memoizedProps);_.componentDidUpdate(v,f.memoizedState,_.__reactInternalSnapshotBeforeUpdate)}var x=u.updateQueue;x!==null&&GT(u,x,_);break;case 3:var b=u.updateQueue;if(b!==null){if(f=null,u.child!==null)switch(u.child.tag){case 5:f=u.child.stateNode;break;case 1:f=u.child.stateNode}GT(u,b,f)}break;case 5:var $=u.stateNode;if(f===null&&u.flags&4){f=$;var H=u.memoizedProps;switch(u.type){case"button":case"input":case"select":case"textarea":H.autoFocus&&f.focus();break;case"img":H.src&&(f.src=H.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(u.memoizedState===null){var ie=u.alternate;if(ie!==null){var ge=ie.memoizedState;if(ge!==null){var me=ge.dehydrated;me!==null&&Uo(me)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Zn||u.flags&512&&Uv(u)}catch(ue){Yt(u,u.return,ue)}}if(u===l){Ae=null;break}if(f=u.sibling,f!==null){f.return=u.return,Ae=f;break}Ae=u.return}}function G2(l){for(;Ae!==null;){var u=Ae;if(u===l){Ae=null;break}var f=u.sibling;if(f!==null){f.return=u.return,Ae=f;break}Ae=u.return}}function j2(l){for(;Ae!==null;){var u=Ae;try{switch(u.tag){case 0:case 11:case 15:var f=u.return;try{sp(4,u)}catch(H){Yt(u,f,H)}break;case 1:var _=u.stateNode;if(typeof _.componentDidMount=="function"){var v=u.return;try{_.componentDidMount()}catch(H){Yt(u,v,H)}}var x=u.return;try{Uv(u)}catch(H){Yt(u,x,H)}break;case 5:var b=u.return;try{Uv(u)}catch(H){Yt(u,b,H)}}}catch(H){Yt(u,u.return,H)}if(u===l){Ae=null;break}var $=u.sibling;if($!==null){$.return=u.return,Ae=$;break}Ae=u.return}}var d5=Math.ceil,op=D.ReactCurrentDispatcher,$v=D.ReactCurrentOwner,vr=D.ReactCurrentBatchConfig,at=0,Rn=null,hn=null,jn=0,Xi=0,yu=Ho(0),_n=0,Od=null,Sl=0,ap=0,Wv=0,Dd=null,Pi=null,Hv=0,vu=1/0,so=null,lp=!1,Kv=null,Zo=null,cp=!1,Jo=null,up=0,Vd=0,qv=null,hp=-1,dp=0;function mi(){return(at&6)!==0?kt():hp!==-1?hp:hp=kt()}function ea(l){return(l.mode&1)===0?1:(at&2)!==0&&jn!==0?jn&-jn:Y3.transition!==null?(dp===0&&(dp=rd()),dp):(l=rt,l!==0||(l=window.event,l=l===void 0?16:qc(l.type)),l)}function Br(l,u,f,_){if(50<Vd)throw Vd=0,qv=null,Error(t(185));hl(l,f,_),((at&2)===0||l!==Rn)&&(l===Rn&&((at&2)===0&&(ap|=f),_n===4&&ta(l,jn)),Ai(l,_),f===1&&at===0&&(u.mode&1)===0&&(vu=kt()+500,jm&&qo()))}function Ai(l,u){var f=l.callbackNode;ul(l,u);var _=Hs(l,l===Rn?jn:0);if(_===0)f!==null&&Uc(f),l.callbackNode=null,l.callbackPriority=0;else if(u=_&-_,l.callbackPriority!==u){if(f!=null&&Uc(f),u===1)l.tag===0?q3(B2.bind(null,l)):PT(B2.bind(null,l)),$3(function(){(at&6)===0&&qo()}),f=null;else{switch(cs(_)){case 1:f=Bc;break;case 4:f=td;break;case 16:f=ol;break;case 536870912:f=zc;break;default:f=ol}f=X2(f,U2.bind(null,l))}l.callbackPriority=u,l.callbackNode=f}}function U2(l,u){if(hp=-1,dp=0,(at&6)!==0)throw Error(t(327));var f=l.callbackNode;if(Eu()&&l.callbackNode!==f)return null;var _=Hs(l,l===Rn?jn:0);if(_===0)return null;if((_&30)!==0||(_&l.expiredLanes)!==0||u)u=fp(l,_);else{u=_;var v=at;at|=2;var x=$2();(Rn!==l||jn!==u)&&(so=null,vu=kt()+500,Tl(l,u));do try{m5();break}catch($){z2(l,$)}while(!0);dv(),op.current=x,at=v,hn!==null?u=0:(Rn=null,jn=0,u=_n)}if(u!==0){if(u===2&&(v=id(l),v!==0&&(_=v,u=Yv(l,v))),u===1)throw f=Od,Tl(l,0),ta(l,_),Ai(l,kt()),f;if(u===6)ta(l,_);else{if(v=l.current.alternate,(_&30)===0&&!f5(v)&&(u=fp(l,_),u===2&&(x=id(l),x!==0&&(_=x,u=Yv(l,x))),u===1))throw f=Od,Tl(l,0),ta(l,_),Ai(l,kt()),f;switch(l.finishedWork=v,l.finishedLanes=_,u){case 0:case 1:throw Error(t(345));case 2:Rl(l,Pi,so);break;case 3:if(ta(l,_),(_&130023424)===_&&(u=Hv+500-kt(),10<u)){if(Hs(l,0)!==0)break;if(v=l.suspendedLanes,(v&_)!==_){mi(),l.pingedLanes|=l.suspendedLanes&v;break}l.timeoutHandle=tv(Rl.bind(null,l,Pi,so),u);break}Rl(l,Pi,so);break;case 4:if(ta(l,_),(_&4194240)===_)break;for(u=l.eventTimes,v=-1;0<_;){var b=31-zi(_);x=1<<b,b=u[b],b>v&&(v=b),_&=~x}if(_=v,_=kt()-_,_=(120>_?120:480>_?480:1080>_?1080:1920>_?1920:3e3>_?3e3:4320>_?4320:1960*d5(_/1960))-_,10<_){l.timeoutHandle=tv(Rl.bind(null,l,Pi,so),_);break}Rl(l,Pi,so);break;case 5:Rl(l,Pi,so);break;default:throw Error(t(329))}}}return Ai(l,kt()),l.callbackNode===f?U2.bind(null,l):null}function Yv(l,u){var f=Dd;return l.current.memoizedState.isDehydrated&&(Tl(l,u).flags|=256),l=fp(l,u),l!==2&&(u=Pi,Pi=f,u!==null&&Xv(u)),l}function Xv(l){Pi===null?Pi=l:Pi.push.apply(Pi,l)}function f5(l){for(var u=l;;){if(u.flags&16384){var f=u.updateQueue;if(f!==null&&(f=f.stores,f!==null))for(var _=0;_<f.length;_++){var v=f[_],x=v.getSnapshot;v=v.value;try{if(!Vr(x(),v))return!1}catch{return!1}}}if(f=u.child,u.subtreeFlags&16384&&f!==null)f.return=u,u=f;else{if(u===l)break;for(;u.sibling===null;){if(u.return===null||u.return===l)return!0;u=u.return}u.sibling.return=u.return,u=u.sibling}}return!0}function ta(l,u){for(u&=~Wv,u&=~ap,l.suspendedLanes|=u,l.pingedLanes&=~u,l=l.expirationTimes;0<u;){var f=31-zi(u),_=1<<f;l[f]=-1,u&=~_}}function B2(l){if((at&6)!==0)throw Error(t(327));Eu();var u=Hs(l,0);if((u&1)===0)return Ai(l,kt()),null;var f=fp(l,u);if(l.tag!==0&&f===2){var _=id(l);_!==0&&(u=_,f=Yv(l,_))}if(f===1)throw f=Od,Tl(l,0),ta(l,u),Ai(l,kt()),f;if(f===6)throw Error(t(345));return l.finishedWork=l.current.alternate,l.finishedLanes=u,Rl(l,Pi,so),Ai(l,kt()),null}function Qv(l,u){var f=at;at|=1;try{return l(u)}finally{at=f,at===0&&(vu=kt()+500,jm&&qo())}}function Il(l){Jo!==null&&Jo.tag===0&&(at&6)===0&&Eu();var u=at;at|=1;var f=vr.transition,_=rt;try{if(vr.transition=null,rt=1,l)return l()}finally{rt=_,vr.transition=f,at=u,(at&6)===0&&qo()}}function Zv(){Xi=yu.current,Nt(yu)}function Tl(l,u){l.finishedWork=null,l.finishedLanes=0;var f=l.timeoutHandle;if(f!==-1&&(l.timeoutHandle=-1,z3(f)),hn!==null)for(f=hn.return;f!==null;){var _=f;switch(av(_),_.tag){case 1:_=_.type.childContextTypes,_!=null&&Fm();break;case 3:mu(),Nt(Ii),Nt(Yn),Ev();break;case 5:yv(_);break;case 4:mu();break;case 13:Nt($t);break;case 19:Nt($t);break;case 10:fv(_.type._context);break;case 22:case 23:Zv()}f=f.return}if(Rn=l,hn=l=na(l.current,null),jn=Xi=u,_n=0,Od=null,Wv=ap=Sl=0,Pi=Dd=null,El!==null){for(u=0;u<El.length;u++)if(f=El[u],_=f.interleaved,_!==null){f.interleaved=null;var v=_.next,x=f.pending;if(x!==null){var b=x.next;x.next=v,_.next=b}f.pending=_}El=null}return l}function z2(l,u){do{var f=hn;try{if(dv(),Xm.current=ep,Qm){for(var _=Wt.memoizedState;_!==null;){var v=_.queue;v!==null&&(v.pending=null),_=_.next}Qm=!1}if(xl=0,Tn=pn=Wt=null,Cd=!1,Md=0,$v.current=null,f===null||f.return===null){_n=1,Od=u,hn=null;break}e:{var x=l,b=f.return,$=f,H=u;if(u=jn,$.flags|=32768,H!==null&&typeof H=="object"&&typeof H.then=="function"){var ie=H,ge=$,me=ge.tag;if((ge.mode&1)===0&&(me===0||me===11||me===15)){var ue=ge.alternate;ue?(ge.updateQueue=ue.updateQueue,ge.memoizedState=ue.memoizedState,ge.lanes=ue.lanes):(ge.updateQueue=null,ge.memoizedState=null)}var Re=g2(b);if(Re!==null){Re.flags&=-257,m2(Re,b,$,x,u),Re.mode&1&&f2(x,ie,u),u=Re,H=ie;var Ce=u.updateQueue;if(Ce===null){var ke=new Set;ke.add(H),u.updateQueue=ke}else Ce.add(H);break e}else{if((u&1)===0){f2(x,ie,u),Jv();break e}H=Error(t(426))}}else if(jt&&$.mode&1){var rn=g2(b);if(rn!==null){(rn.flags&65536)===0&&(rn.flags|=256),m2(rn,b,$,x,u),uv(pu(H,$));break e}}x=H=pu(H,$),_n!==4&&(_n=2),Dd===null?Dd=[x]:Dd.push(x),x=b;do{switch(x.tag){case 3:x.flags|=65536,u&=-u,x.lanes|=u;var J=h2(x,H,u);FT(x,J);break e;case 1:$=H;var Y=x.type,ne=x.stateNode;if((x.flags&128)===0&&(typeof Y.getDerivedStateFromError=="function"||ne!==null&&typeof ne.componentDidCatch=="function"&&(Zo===null||!Zo.has(ne)))){x.flags|=65536,u&=-u,x.lanes|=u;var ye=d2(x,$,u);FT(x,ye);break e}}x=x.return}while(x!==null)}H2(f)}catch(Le){u=Le,hn===f&&f!==null&&(hn=f=f.return);continue}break}while(!0)}function $2(){var l=op.current;return op.current=ep,l===null?ep:l}function Jv(){(_n===0||_n===3||_n===2)&&(_n=4),Rn===null||(Sl&268435455)===0&&(ap&268435455)===0||ta(Rn,jn)}function fp(l,u){var f=at;at|=2;var _=$2();(Rn!==l||jn!==u)&&(so=null,Tl(l,u));do try{g5();break}catch(v){z2(l,v)}while(!0);if(dv(),at=f,op.current=_,hn!==null)throw Error(t(261));return Rn=null,jn=0,_n}function g5(){for(;hn!==null;)W2(hn)}function m5(){for(;hn!==null&&!sl();)W2(hn)}function W2(l){var u=Y2(l.alternate,l,Xi);l.memoizedProps=l.pendingProps,u===null?H2(l):hn=u,$v.current=null}function H2(l){var u=l;do{var f=u.alternate;if(l=u.return,(u.flags&32768)===0){if(f=a5(f,u,Xi),f!==null){hn=f;return}}else{if(f=l5(f,u),f!==null){f.flags&=32767,hn=f;return}if(l!==null)l.flags|=32768,l.subtreeFlags=0,l.deletions=null;else{_n=6,hn=null;return}}if(u=u.sibling,u!==null){hn=u;return}hn=u=l}while(u!==null);_n===0&&(_n=5)}function Rl(l,u,f){var _=rt,v=vr.transition;try{vr.transition=null,rt=1,p5(l,u,f,_)}finally{vr.transition=v,rt=_}return null}function p5(l,u,f,_){do Eu();while(Jo!==null);if((at&6)!==0)throw Error(t(327));f=l.finishedWork;var v=l.finishedLanes;if(f===null)return null;if(l.finishedWork=null,l.finishedLanes=0,f===l.current)throw Error(t(177));l.callbackNode=null,l.callbackPriority=0;var x=f.lanes|f.childLanes;if(Gy(l,x),l===Rn&&(hn=Rn=null,jn=0),(f.subtreeFlags&2064)===0&&(f.flags&2064)===0||cp||(cp=!0,X2(ol,function(){return Eu(),null})),x=(f.flags&15990)!==0,(f.subtreeFlags&15990)!==0||x){x=vr.transition,vr.transition=null;var b=rt;rt=1;var $=at;at|=4,$v.current=null,u5(l,f),D2(f,l),D3(Jy),Ys=!!Zy,Jy=Zy=null,l.current=f,h5(f),Ws(),at=$,rt=b,vr.transition=x}else l.current=f;if(cp&&(cp=!1,Jo=l,up=v),x=l.pendingLanes,x===0&&(Zo=null),Em(f.stateNode),Ai(l,kt()),u!==null)for(_=l.onRecoverableError,f=0;f<u.length;f++)v=u[f],_(v.value,{componentStack:v.stack,digest:v.digest});if(lp)throw lp=!1,l=Kv,Kv=null,l;return(up&1)!==0&&l.tag!==0&&Eu(),x=l.pendingLanes,(x&1)!==0?l===qv?Vd++:(Vd=0,qv=l):Vd=0,qo(),null}function Eu(){if(Jo!==null){var l=cs(up),u=vr.transition,f=rt;try{if(vr.transition=null,rt=16>l?16:l,Jo===null)var _=!1;else{if(l=Jo,Jo=null,up=0,(at&6)!==0)throw Error(t(331));var v=at;for(at|=4,Ae=l.current;Ae!==null;){var x=Ae,b=x.child;if((Ae.flags&16)!==0){var $=x.deletions;if($!==null){for(var H=0;H<$.length;H++){var ie=$[H];for(Ae=ie;Ae!==null;){var ge=Ae;switch(ge.tag){case 0:case 11:case 15:Nd(8,ge,x)}var me=ge.child;if(me!==null)me.return=ge,Ae=me;else for(;Ae!==null;){ge=Ae;var ue=ge.sibling,Re=ge.return;if(b2(ge),ge===ie){Ae=null;break}if(ue!==null){ue.return=Re,Ae=ue;break}Ae=Re}}}var Ce=x.alternate;if(Ce!==null){var ke=Ce.child;if(ke!==null){Ce.child=null;do{var rn=ke.sibling;ke.sibling=null,ke=rn}while(ke!==null)}}Ae=x}}if((x.subtreeFlags&2064)!==0&&b!==null)b.return=x,Ae=b;else e:for(;Ae!==null;){if(x=Ae,(x.flags&2048)!==0)switch(x.tag){case 0:case 11:case 15:Nd(9,x,x.return)}var J=x.sibling;if(J!==null){J.return=x.return,Ae=J;break e}Ae=x.return}}var Y=l.current;for(Ae=Y;Ae!==null;){b=Ae;var ne=b.child;if((b.subtreeFlags&2064)!==0&&ne!==null)ne.return=b,Ae=ne;else e:for(b=Y;Ae!==null;){if($=Ae,($.flags&2048)!==0)try{switch($.tag){case 0:case 11:case 15:sp(9,$)}}catch(Le){Yt($,$.return,Le)}if($===b){Ae=null;break e}var ye=$.sibling;if(ye!==null){ye.return=$.return,Ae=ye;break e}Ae=$.return}}if(at=v,qo(),Bi&&typeof Bi.onPostCommitFiberRoot=="function")try{Bi.onPostCommitFiberRoot(al,l)}catch{}_=!0}return _}finally{rt=f,vr.transition=u}}return!1}function K2(l,u,f){u=pu(f,u),u=h2(l,u,1),l=Xo(l,u,1),u=mi(),l!==null&&(hl(l,1,u),Ai(l,u))}function Yt(l,u,f){if(l.tag===3)K2(l,l,f);else for(;u!==null;){if(u.tag===3){K2(u,l,f);break}else if(u.tag===1){var _=u.stateNode;if(typeof u.type.getDerivedStateFromError=="function"||typeof _.componentDidCatch=="function"&&(Zo===null||!Zo.has(_))){l=pu(f,l),l=d2(u,l,1),u=Xo(u,l,1),l=mi(),u!==null&&(hl(u,1,l),Ai(u,l));break}}u=u.return}}function _5(l,u,f){var _=l.pingCache;_!==null&&_.delete(u),u=mi(),l.pingedLanes|=l.suspendedLanes&f,Rn===l&&(jn&f)===f&&(_n===4||_n===3&&(jn&130023424)===jn&&500>kt()-Hv?Tl(l,0):Wv|=f),Ai(l,u)}function q2(l,u){u===0&&((l.mode&1)===0?u=1:(u=Fo,Fo<<=1,(Fo&130023424)===0&&(Fo=4194304)));var f=mi();l=no(l,u),l!==null&&(hl(l,u,f),Ai(l,f))}function y5(l){var u=l.memoizedState,f=0;u!==null&&(f=u.retryLane),q2(l,f)}function v5(l,u){var f=0;switch(l.tag){case 13:var _=l.stateNode,v=l.memoizedState;v!==null&&(f=v.retryLane);break;case 19:_=l.stateNode;break;default:throw Error(t(314))}_!==null&&_.delete(u),q2(l,f)}var Y2;Y2=function(l,u,f){if(l!==null)if(l.memoizedProps!==u.pendingProps||Ii.current)Ri=!0;else{if((l.lanes&f)===0&&(u.flags&128)===0)return Ri=!1,o5(l,u,f);Ri=(l.flags&131072)!==0}else Ri=!1,jt&&(u.flags&1048576)!==0&&AT(u,Bm,u.index);switch(u.lanes=0,u.tag){case 2:var _=u.type;ip(l,u),l=u.pendingProps;var v=lu(u,Yn.current);gu(u,f),v=Sv(null,u,_,l,v,f);var x=Iv();return u.flags|=1,typeof v=="object"&&v!==null&&typeof v.render=="function"&&v.$$typeof===void 0?(u.tag=1,u.memoizedState=null,u.updateQueue=null,Ti(_)?(x=!0,Gm(u)):x=!1,u.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,pv(u),v.updater=tp,u.stateNode=v,v._reactInternals=u,Mv(u,_,l,f),u=Nv(null,u,_,!0,x,f)):(u.tag=0,jt&&x&&ov(u),gi(null,u,v,f),u=u.child),u;case 16:_=u.elementType;e:{switch(ip(l,u),l=u.pendingProps,v=_._init,_=v(_._payload),u.type=_,v=u.tag=w5(_),l=Gr(_,l),v){case 0:u=Lv(null,u,_,l,f);break e;case 1:u=w2(null,u,_,l,f);break e;case 11:u=p2(null,u,_,l,f);break e;case 14:u=_2(null,u,_,Gr(_.type,l),f);break e}throw Error(t(306,_,""))}return u;case 0:return _=u.type,v=u.pendingProps,v=u.elementType===_?v:Gr(_,v),Lv(l,u,_,v,f);case 1:return _=u.type,v=u.pendingProps,v=u.elementType===_?v:Gr(_,v),w2(l,u,_,v,f);case 3:e:{if(x2(u),l===null)throw Error(t(387));_=u.pendingProps,x=u.memoizedState,v=x.element,VT(l,u),qm(u,_,null,f);var b=u.memoizedState;if(_=b.element,x.isDehydrated)if(x={element:_,isDehydrated:!1,cache:b.cache,pendingSuspenseBoundaries:b.pendingSuspenseBoundaries,transitions:b.transitions},u.updateQueue.baseState=x,u.memoizedState=x,u.flags&256){v=pu(Error(t(423)),u),u=S2(l,u,_,f,v);break e}else if(_!==v){v=pu(Error(t(424)),u),u=S2(l,u,_,f,v);break e}else for(Yi=Wo(u.stateNode.containerInfo.firstChild),qi=u,jt=!0,Fr=null,f=OT(u,null,_,f),u.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling;else{if(hu(),_===v){u=ro(l,u,f);break e}gi(l,u,_,f)}u=u.child}return u;case 5:return jT(u),l===null&&cv(u),_=u.type,v=u.pendingProps,x=l!==null?l.memoizedProps:null,b=v.children,ev(_,v)?b=null:x!==null&&ev(_,x)&&(u.flags|=32),E2(l,u),gi(l,u,b,f),u.child;case 6:return l===null&&cv(u),null;case 13:return I2(l,u,f);case 4:return _v(u,u.stateNode.containerInfo),_=u.pendingProps,l===null?u.child=du(u,null,_,f):gi(l,u,_,f),u.child;case 11:return _=u.type,v=u.pendingProps,v=u.elementType===_?v:Gr(_,v),p2(l,u,_,v,f);case 7:return gi(l,u,u.pendingProps,f),u.child;case 8:return gi(l,u,u.pendingProps.children,f),u.child;case 12:return gi(l,u,u.pendingProps.children,f),u.child;case 10:e:{if(_=u.type._context,v=u.pendingProps,x=u.memoizedProps,b=v.value,bt(Wm,_._currentValue),_._currentValue=b,x!==null)if(Vr(x.value,b)){if(x.children===v.children&&!Ii.current){u=ro(l,u,f);break e}}else for(x=u.child,x!==null&&(x.return=u);x!==null;){var $=x.dependencies;if($!==null){b=x.child;for(var H=$.firstContext;H!==null;){if(H.context===_){if(x.tag===1){H=io(-1,f&-f),H.tag=2;var ie=x.updateQueue;if(ie!==null){ie=ie.shared;var ge=ie.pending;ge===null?H.next=H:(H.next=ge.next,ge.next=H),ie.pending=H}}x.lanes|=f,H=x.alternate,H!==null&&(H.lanes|=f),gv(x.return,f,u),$.lanes|=f;break}H=H.next}}else if(x.tag===10)b=x.type===u.type?null:x.child;else if(x.tag===18){if(b=x.return,b===null)throw Error(t(341));b.lanes|=f,$=b.alternate,$!==null&&($.lanes|=f),gv(b,f,u),b=x.sibling}else b=x.child;if(b!==null)b.return=x;else for(b=x;b!==null;){if(b===u){b=null;break}if(x=b.sibling,x!==null){x.return=b.return,b=x;break}b=b.return}x=b}gi(l,u,v.children,f),u=u.child}return u;case 9:return v=u.type,_=u.pendingProps.children,gu(u,f),v=_r(v),_=_(v),u.flags|=1,gi(l,u,_,f),u.child;case 14:return _=u.type,v=Gr(_,u.pendingProps),v=Gr(_.type,v),_2(l,u,_,v,f);case 15:return y2(l,u,u.type,u.pendingProps,f);case 17:return _=u.type,v=u.pendingProps,v=u.elementType===_?v:Gr(_,v),ip(l,u),u.tag=1,Ti(_)?(l=!0,Gm(u)):l=!1,gu(u,f),c2(u,_,v),Mv(u,_,v,f),Nv(null,u,_,!0,l,f);case 19:return R2(l,u,f);case 22:return v2(l,u,f)}throw Error(t(156,u.tag))};function X2(l,u){return ed(l,u)}function E5(l,u,f,_){this.tag=l,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=u,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=_,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Er(l,u,f,_){return new E5(l,u,f,_)}function e1(l){return l=l.prototype,!(!l||!l.isReactComponent)}function w5(l){if(typeof l=="function")return e1(l)?1:0;if(l!=null){if(l=l.$$typeof,l===z)return 11;if(l===Te)return 14}return 2}function na(l,u){var f=l.alternate;return f===null?(f=Er(l.tag,u,l.key,l.mode),f.elementType=l.elementType,f.type=l.type,f.stateNode=l.stateNode,f.alternate=l,l.alternate=f):(f.pendingProps=u,f.type=l.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=l.flags&14680064,f.childLanes=l.childLanes,f.lanes=l.lanes,f.child=l.child,f.memoizedProps=l.memoizedProps,f.memoizedState=l.memoizedState,f.updateQueue=l.updateQueue,u=l.dependencies,f.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext},f.sibling=l.sibling,f.index=l.index,f.ref=l.ref,f}function gp(l,u,f,_,v,x){var b=2;if(_=l,typeof l=="function")e1(l)&&(b=1);else if(typeof l=="string")b=5;else e:switch(l){case L:return Pl(f.children,v,x,u);case A:b=8,v|=8;break;case k:return l=Er(12,f,u,v|2),l.elementType=k,l.lanes=x,l;case O:return l=Er(13,f,u,v),l.elementType=O,l.lanes=x,l;case oe:return l=Er(19,f,u,v),l.elementType=oe,l.lanes=x,l;case _e:return mp(f,v,x,u);default:if(typeof l=="object"&&l!==null)switch(l.$$typeof){case U:b=10;break e;case B:b=9;break e;case z:b=11;break e;case Te:b=14;break e;case we:b=16,_=null;break e}throw Error(t(130,l==null?l:typeof l,""))}return u=Er(b,f,u,v),u.elementType=l,u.type=_,u.lanes=x,u}function Pl(l,u,f,_){return l=Er(7,l,_,u),l.lanes=f,l}function mp(l,u,f,_){return l=Er(22,l,_,u),l.elementType=_e,l.lanes=f,l.stateNode={isHidden:!1},l}function t1(l,u,f){return l=Er(6,l,null,u),l.lanes=f,l}function n1(l,u,f){return u=Er(4,l.children!==null?l.children:[],l.key,u),u.lanes=f,u.stateNode={containerInfo:l.containerInfo,pendingChildren:null,implementation:l.implementation},u}function x5(l,u,f,_,v){this.tag=u,this.containerInfo=l,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=sd(0),this.expirationTimes=sd(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=sd(0),this.identifierPrefix=_,this.onRecoverableError=v,this.mutableSourceEagerHydrationData=null}function i1(l,u,f,_,v,x,b,$,H){return l=new x5(l,u,f,$,H),u===1?(u=1,x===!0&&(u|=8)):u=0,x=Er(3,null,null,u),l.current=x,x.stateNode=l,x.memoizedState={element:_,isDehydrated:f,cache:null,transitions:null,pendingSuspenseBoundaries:null},pv(x),l}function S5(l,u,f){var _=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:W,key:_==null?null:""+_,children:l,containerInfo:u,implementation:f}}function Q2(l){if(!l)return Ko;l=l._reactInternals;e:{if(Or(l)!==l||l.tag!==1)throw Error(t(170));var u=l;do{switch(u.tag){case 3:u=u.stateNode.context;break e;case 1:if(Ti(u.type)){u=u.stateNode.__reactInternalMemoizedMergedChildContext;break e}}u=u.return}while(u!==null);throw Error(t(171))}if(l.tag===1){var f=l.type;if(Ti(f))return TT(l,f,u)}return u}function Z2(l,u,f,_,v,x,b,$,H){return l=i1(f,_,!0,l,v,x,b,$,H),l.context=Q2(null),f=l.current,_=mi(),v=ea(f),x=io(_,v),x.callback=u??null,Xo(f,x,v),l.current.lanes=v,hl(l,v,_),Ai(l,_),l}function pp(l,u,f,_){var v=u.current,x=mi(),b=ea(v);return f=Q2(f),u.context===null?u.context=f:u.pendingContext=f,u=io(x,b),u.payload={element:l},_=_===void 0?null:_,_!==null&&(u.callback=_),l=Xo(v,u,b),l!==null&&(Br(l,v,b,x),Km(l,v,b)),b}function _p(l){if(l=l.current,!l.child)return null;switch(l.child.tag){case 5:return l.child.stateNode;default:return l.child.stateNode}}function J2(l,u){if(l=l.memoizedState,l!==null&&l.dehydrated!==null){var f=l.retryLane;l.retryLane=f!==0&&f<u?f:u}}function r1(l,u){J2(l,u),(l=l.alternate)&&J2(l,u)}function I5(){return null}var eR=typeof reportError=="function"?reportError:function(l){console.error(l)};function s1(l){this._internalRoot=l}yp.prototype.render=s1.prototype.render=function(l){var u=this._internalRoot;if(u===null)throw Error(t(409));pp(l,u,null,null)},yp.prototype.unmount=s1.prototype.unmount=function(){var l=this._internalRoot;if(l!==null){this._internalRoot=null;var u=l.containerInfo;Il(function(){pp(null,l,null,null)}),u[Zs]=null}};function yp(l){this._internalRoot=l}yp.prototype.unstable_scheduleHydration=function(l){if(l){var u=cd();l={blockedOn:null,target:l,priority:u};for(var f=0;f<$i.length&&u!==0&&u<$i[f].priority;f++);$i.splice(f,0,l),f===0&&Hc(l)}};function o1(l){return!(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11)}function vp(l){return!(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11&&(l.nodeType!==8||l.nodeValue!==" react-mount-point-unstable "))}function tR(){}function T5(l,u,f,_,v){if(v){if(typeof _=="function"){var x=_;_=function(){var ie=_p(b);x.call(ie)}}var b=Z2(u,_,l,0,null,!1,!1,"",tR);return l._reactRootContainer=b,l[Zs]=b.current,wd(l.nodeType===8?l.parentNode:l),Il(),b}for(;v=l.lastChild;)l.removeChild(v);if(typeof _=="function"){var $=_;_=function(){var ie=_p(H);$.call(ie)}}var H=i1(l,0,!1,null,null,!1,!1,"",tR);return l._reactRootContainer=H,l[Zs]=H.current,wd(l.nodeType===8?l.parentNode:l),Il(function(){pp(u,H,f,_)}),H}function Ep(l,u,f,_,v){var x=f._reactRootContainer;if(x){var b=x;if(typeof v=="function"){var $=v;v=function(){var H=_p(b);$.call(H)}}pp(u,b,l,v)}else b=T5(f,u,l,v,_);return _p(b)}ad=function(l){switch(l.tag){case 3:var u=l.stateNode;if(u.current.memoizedState.isDehydrated){var f=ft(u.pendingLanes);f!==0&&(od(u,f|1),Ai(u,kt()),(at&6)===0&&(vu=kt()+500,qo()))}break;case 13:Il(function(){var _=no(l,1);if(_!==null){var v=mi();Br(_,l,1,v)}}),r1(l,1)}},$c=function(l){if(l.tag===13){var u=no(l,134217728);if(u!==null){var f=mi();Br(u,l,134217728,f)}r1(l,134217728)}},ld=function(l){if(l.tag===13){var u=ea(l),f=no(l,u);if(f!==null){var _=mi();Br(f,l,u,_)}r1(l,u)}},cd=function(){return rt},ud=function(l,u){var f=rt;try{return rt=l,u()}finally{rt=f}},di=function(l,u,f){switch(u){case"input":if(Si(l,f),u=f.name,f.type==="radio"&&u!=null){for(f=l;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll("input[name="+JSON.stringify(""+u)+'][type="radio"]'),u=0;u<f.length;u++){var _=f[u];if(_!==l&&_.form===l.form){var v=Vm(_);if(!v)throw Error(t(90));Kn(_),Si(_,v)}}}break;case"textarea":Oo(l,f);break;case"select":u=f.value,u!=null&&Sn(l,!!f.multiple,u,!1)}},hr=Qv,Nn=Il;var R5={usingClientEntryPoint:!1,Events:[Id,ou,Vm,Nr,en,Qv]},Fd={findFiberByHostInstance:pl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},P5={bundleType:Fd.bundleType,version:Fd.version,rendererPackageName:Fd.rendererPackageName,rendererConfig:Fd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:D.ReactCurrentDispatcher,findHostInstanceByFiber:function(l){return l=vm(l),l===null?null:l.stateNode},findFiberByHostInstance:Fd.findFiberByHostInstance||I5,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var wp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!wp.isDisabled&&wp.supportsFiber)try{al=wp.inject(P5),Bi=wp}catch{}}return Ci.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=R5,Ci.createPortal=function(l,u){var f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!o1(u))throw Error(t(200));return S5(l,u,null,f)},Ci.createRoot=function(l,u){if(!o1(l))throw Error(t(299));var f=!1,_="",v=eR;return u!=null&&(u.unstable_strictMode===!0&&(f=!0),u.identifierPrefix!==void 0&&(_=u.identifierPrefix),u.onRecoverableError!==void 0&&(v=u.onRecoverableError)),u=i1(l,1,!1,null,null,f,!1,_,v),l[Zs]=u.current,wd(l.nodeType===8?l.parentNode:l),new s1(u)},Ci.findDOMNode=function(l){if(l==null)return null;if(l.nodeType===1)return l;var u=l._reactInternals;if(u===void 0)throw typeof l.render=="function"?Error(t(188)):(l=Object.keys(l).join(","),Error(t(268,l)));return l=vm(u),l=l===null?null:l.stateNode,l},Ci.flushSync=function(l){return Il(l)},Ci.hydrate=function(l,u,f){if(!vp(u))throw Error(t(200));return Ep(null,l,u,!0,f)},Ci.hydrateRoot=function(l,u,f){if(!o1(l))throw Error(t(405));var _=f!=null&&f.hydratedSources||null,v=!1,x="",b=eR;if(f!=null&&(f.unstable_strictMode===!0&&(v=!0),f.identifierPrefix!==void 0&&(x=f.identifierPrefix),f.onRecoverableError!==void 0&&(b=f.onRecoverableError)),u=Z2(u,null,l,1,f??null,v,!1,x,b),l[Zs]=u.current,wd(l),_)for(l=0;l<_.length;l++)f=_[l],v=f._getVersion,v=v(f._source),u.mutableSourceEagerHydrationData==null?u.mutableSourceEagerHydrationData=[f,v]:u.mutableSourceEagerHydrationData.push(f,v);return new yp(u)},Ci.render=function(l,u,f){if(!vp(u))throw Error(t(200));return Ep(null,l,u,!1,f)},Ci.unmountComponentAtNode=function(l){if(!vp(l))throw Error(t(40));return l._reactRootContainer?(Il(function(){Ep(null,null,l,!1,function(){l._reactRootContainer=null,l[Zs]=null})}),!0):!1},Ci.unstable_batchedUpdates=Qv,Ci.unstable_renderSubtreeIntoContainer=function(l,u,f,_){if(!vp(f))throw Error(t(200));if(l==null||l._reactInternals===void 0)throw Error(t(38));return Ep(l,u,f,!1,_)},Ci.version="18.3.1-next-f1338f8080-20240426",Ci}var cR;function O5(){if(cR)return c1.exports;cR=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),c1.exports=N5(),c1.exports}var uR;function D5(){if(uR)return xp;uR=1;var n=O5();return xp.createRoot=n.createRoot,xp.hydrateRoot=n.hydrateRoot,xp}var V5=D5();const F5=sx(V5);var se=Mg();const G5=sx(se),bi={ADD:"add",REMOVE:"remove"},fh={PROPERTYCHANGE:"propertychange"},Qe={CHANGE:"change",ERROR:"error",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",TOUCHMOVE:"touchmove",WHEEL:"wheel"};class O_{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}function j5(n,e,t){let i,r;t=t||go;let s=0,o=n.length,a=!1;for(;s<o;)i=s+(o-s>>1),r=+t(n[i],e),r<0?s=i+1:(o=i,a=!r);return a?s:~s}function go(n,e){return n>e?1:n<e?-1:0}function U5(n,e){return n<e?1:n>e?-1:0}function ox(n,e,t){if(n[0]<=e)return 0;const i=n.length;if(e<=n[i-1])return i-1;if(typeof t=="function"){for(let r=1;r<i;++r){const s=n[r];if(s===e)return r;if(s<e)return t(e,n[r-1],s)>0?r-1:r}return i-1}if(t>0){for(let r=1;r<i;++r)if(n[r]<e)return r-1;return i-1}if(t<0){for(let r=1;r<i;++r)if(n[r]<=e)return r;return i-1}for(let r=1;r<i;++r){if(n[r]==e)return r;if(n[r]<e)return n[r-1]-e<e-n[r]?r-1:r}return i-1}function B5(n,e,t){for(;e<t;){const i=n[e];n[e]=n[t],n[t]=i,++e,--t}}function Cs(n,e){const t=Array.isArray(e)?e:[e],i=t.length;for(let r=0;r<i;r++)n[n.length]=t[r]}function Za(n,e){const t=n.length;if(t!==e.length)return!1;for(let i=0;i<t;i++)if(n[i]!==e[i])return!1;return!0}function z5(n,e,t){const i=e||go;return n.every(function(r,s){if(s===0)return!0;const o=i(n[s-1],r);return!(o>0||o===0)})}function Bf(){return!0}function D_(){return!1}function zf(){}function _b(n){let e,t,i;return function(){const r=Array.prototype.slice.call(arguments);return(!t||this!==i||!Za(r,t))&&(i=this,t=r,e=n.apply(this,arguments)),e}}function yb(n){function e(){let t;try{t=n()}catch(i){return Promise.reject(i)}return t instanceof Promise?t:Promise.resolve(t)}return e()}function bg(n){for(const e in n)delete n[e]}function sc(n){let e;for(e in n)return!1;return!e}class Ao{constructor(e){this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}let kg=class extends O_{constructor(e){super(),this.eventTarget_=e,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(e,t){if(!e||!t)return;const i=this.listeners_||(this.listeners_={}),r=i[e]||(i[e]=[]);r.includes(t)||r.push(t)}dispatchEvent(e){const t=typeof e=="string",i=t?e:e.type,r=this.listeners_&&this.listeners_[i];if(!r)return;const s=t?new Ao(e):e;s.target||(s.target=this.eventTarget_||this);const o=this.dispatching_||(this.dispatching_={}),a=this.pendingRemovals_||(this.pendingRemovals_={});i in o||(o[i]=0,a[i]=0),++o[i];let c;for(let h=0,d=r.length;h<d;++h)if("handleEvent"in r[h]?c=r[h].handleEvent(s):c=r[h].call(this,s),c===!1||s.propagationStopped){c=!1;break}if(--o[i]===0){let h=a[i];for(delete a[i];h--;)this.removeEventListener(i,zf);delete o[i]}return c}disposeInternal(){this.listeners_&&bg(this.listeners_)}getListeners(e){return this.listeners_&&this.listeners_[e]||void 0}hasListener(e){return this.listeners_?e?e in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(e,t){if(!this.listeners_)return;const i=this.listeners_[e];if(!i)return;const r=i.indexOf(t);r!==-1&&(this.pendingRemovals_&&e in this.pendingRemovals_?(i[r]=zf,++this.pendingRemovals_[e]):(i.splice(r,1),i.length===0&&delete this.listeners_[e]))}};function lt(n,e,t,i,r){if(r){const o=t;t=function(a){return n.removeEventListener(e,t),o.call(i??this,a)}}else i&&i!==n&&(t=t.bind(i));const s={target:n,type:e,listener:t};return n.addEventListener(e,t),s}function T0(n,e,t,i){return lt(n,e,t,i,!0)}function Ot(n){n&&n.target&&(n.target.removeEventListener(n.type,n.listener),bg(n))}class Lg extends kg{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(Qe.CHANGE)}getRevision(){return this.revision_}onInternal(e,t){if(Array.isArray(e)){const i=e.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=lt(this,e[s],t);return r}return lt(this,e,t)}onceInternal(e,t){let i;if(Array.isArray(e)){const r=e.length;i=new Array(r);for(let s=0;s<r;++s)i[s]=T0(this,e[s],t)}else i=T0(this,e,t);return t.ol_key=i,i}unInternal(e,t){const i=t.ol_key;if(i)$5(i);else if(Array.isArray(e))for(let r=0,s=e.length;r<s;++r)this.removeEventListener(e[r],t);else this.removeEventListener(e,t)}}Lg.prototype.on;Lg.prototype.once;Lg.prototype.un;function $5(n){if(Array.isArray(n))for(let e=0,t=n.length;e<t;++e)Ot(n[e]);else Ot(n)}function We(){throw new Error("Unimplemented abstract method.")}let W5=0;function ut(n){return n.ol_uid||(n.ol_uid=String(++W5))}class hR extends Ao{constructor(e,t,i){super(e),this.key=t,this.oldValue=i}}class js extends Lg{constructor(e){super(),this.on,this.once,this.un,ut(this),this.values_=null,e!==void 0&&this.setProperties(e)}get(e){let t;return this.values_&&this.values_.hasOwnProperty(e)&&(t=this.values_[e]),t}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(e,t){let i;i=`change:${e}`,this.hasListener(i)&&this.dispatchEvent(new hR(i,e,t)),i=fh.PROPERTYCHANGE,this.hasListener(i)&&this.dispatchEvent(new hR(i,e,t))}addChangeListener(e,t){this.addEventListener(`change:${e}`,t)}removeChangeListener(e,t){this.removeEventListener(`change:${e}`,t)}set(e,t,i){const r=this.values_||(this.values_={});if(i)r[e]=t;else{const s=r[e];r[e]=t,s!==t&&this.notify(e,s)}}setProperties(e,t){for(const i in e)this.set(i,e[i],t)}applyProperties(e){e.values_&&Object.assign(this.values_||(this.values_={}),e.values_)}unset(e,t){if(this.values_&&e in this.values_){const i=this.values_[e];delete this.values_[e],sc(this.values_)&&(this.values_=null),t||this.notify(e,i)}}}const dR={LENGTH:"length"};class Sp extends Ao{constructor(e,t,i){super(e),this.element=t,this.index=i}}class Rr extends js{constructor(e,t){if(super(),this.on,this.once,this.un,t=t||{},this.unique_=!!t.unique,this.array_=e??[],this.unique_)for(let i=1,r=this.array_.length;i<r;++i)this.assertUnique_(this.array_[i],i);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(e){for(let t=0,i=e.length;t<i;++t)this.push(e[t]);return this}forEach(e){const t=this.array_;for(let i=0,r=t.length;i<r;++i)e(t[i],i,t)}getArray(){return this.array_}item(e){return this.array_[e]}getLength(){return this.get(dR.LENGTH)}insertAt(e,t){if(e<0||e>this.getLength())throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t),this.array_.splice(e,0,t),this.updateLength_(),this.dispatchEvent(new Sp(bi.ADD,t,e))}pop(){return this.removeAt(this.getLength()-1)}push(e){const t=this.getLength();return this.insertAt(t,e),this.getLength()}remove(e){const t=this.array_;for(let i=0,r=t.length;i<r;++i)if(t[i]===e)return this.removeAt(i)}removeAt(e){if(e<0||e>=this.getLength())return;const t=this.array_[e];return this.array_.splice(e,1),this.updateLength_(),this.dispatchEvent(new Sp(bi.REMOVE,t,e)),t}setAt(e,t){const i=this.getLength();if(e>=i){this.insertAt(e,t);return}if(e<0)throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t,e);const r=this.array_[e];this.array_[e]=t,this.dispatchEvent(new Sp(bi.REMOVE,r,e)),this.dispatchEvent(new Sp(bi.ADD,t,e))}updateLength_(){this.set(dR.LENGTH,this.array_.length)}assertUnique_(e,t){const i=this.array_;for(let r=0,s=i.length;r<s;++r)if(i[r]===e&&r!==t)throw new Error("Duplicate item added to a unique collection")}}function yt(n,e){if(!n)throw new Error(e)}let gh=class vb extends js{constructor(e){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),e)if(typeof e.getSimplifiedGeometry=="function"){const t=e;this.setGeometry(t)}else{const t=e;this.setProperties(t)}}clone(){const e=new vb(this.hasProperties()?this.getProperties():null);e.setGeometryName(this.getGeometryName());const t=this.getGeometry();t&&e.setGeometry(t.clone());const i=this.getStyle();return i&&e.setStyle(i),e}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(Ot(this.geometryChangeKey_),this.geometryChangeKey_=null);const e=this.getGeometry();e&&(this.geometryChangeKey_=lt(e,Qe.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(e){this.set(this.geometryName_,e)}setStyle(e){this.style_=e,this.styleFunction_=e?H5(e):void 0,this.changed()}setId(e){this.id_=e,this.changed()}setGeometryName(e){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=e,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}};function H5(n){if(typeof n=="function")return n;let e;return Array.isArray(n)?e=n:(yt(typeof n.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),e=[n]),function(){return e}}const An={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function fR(n){const e=ir();for(let t=0,i=n.length;t<i;++t)vf(e,n[t]);return e}function $f(n,e,t){return t?(t[0]=n[0]-e,t[1]=n[1]-e,t[2]=n[2]+e,t[3]=n[3]+e,t):[n[0]-e,n[1]-e,n[2]+e,n[3]+e]}function Eb(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n.slice()}function Pc(n,e,t){let i,r;return e<n[0]?i=n[0]-e:n[2]<e?i=e-n[2]:i=0,t<n[1]?r=n[1]-t:n[3]<t?r=t-n[3]:r=0,i*i+r*r}function mh(n,e){return ax(n,e[0],e[1])}function ef(n,e){return n[0]<=e[0]&&e[2]<=n[2]&&n[1]<=e[1]&&e[3]<=n[3]}function ax(n,e,t){return n[0]<=e&&e<=n[2]&&n[1]<=t&&t<=n[3]}function xE(n,e){const t=n[0],i=n[1],r=n[2],s=n[3],o=e[0],a=e[1];let c=An.UNKNOWN;return o<t?c=c|An.LEFT:o>r&&(c=c|An.RIGHT),a<i?c=c|An.BELOW:a>s&&(c=c|An.ABOVE),c===An.UNKNOWN&&(c=An.INTERSECTING),c}function ir(){return[1/0,1/0,-1/0,-1/0]}function Ga(n,e,t,i,r){return r?(r[0]=n,r[1]=e,r[2]=t,r[3]=i,r):[n,e,t,i]}function Ng(n){return Ga(1/0,1/0,-1/0,-1/0,n)}function wb(n,e){const t=n[0],i=n[1];return Ga(t,i,t,i,e)}function lx(n,e,t,i,r){const s=Ng(r);return Sb(s,n,e,t,i)}function Wf(n,e){return n[0]==e[0]&&n[2]==e[2]&&n[1]==e[1]&&n[3]==e[3]}function xb(n,e){return e[0]<n[0]&&(n[0]=e[0]),e[2]>n[2]&&(n[2]=e[2]),e[1]<n[1]&&(n[1]=e[1]),e[3]>n[3]&&(n[3]=e[3]),n}function vf(n,e){e[0]<n[0]&&(n[0]=e[0]),e[0]>n[2]&&(n[2]=e[0]),e[1]<n[1]&&(n[1]=e[1]),e[1]>n[3]&&(n[3]=e[1])}function Sb(n,e,t,i,r){for(;t<i;t+=r)K5(n,e[t],e[t+1]);return n}function K5(n,e,t){n[0]=Math.min(n[0],e),n[1]=Math.min(n[1],t),n[2]=Math.max(n[2],e),n[3]=Math.max(n[3],t)}function Ib(n,e){let t;return t=e(V_(n)),t||(t=e(F_(n)),t)||(t=e(G_(n)),t)||(t=e(Ac(n)),t)?t:!1}function SE(n){let e=0;return j_(n)||(e=ht(n)*oi(n)),e}function V_(n){return[n[0],n[1]]}function F_(n){return[n[2],n[1]]}function ja(n){return[(n[0]+n[2])/2,(n[1]+n[3])/2]}function q5(n,e){let t;if(e==="bottom-left")t=V_(n);else if(e==="bottom-right")t=F_(n);else if(e==="top-left")t=Ac(n);else if(e==="top-right")t=G_(n);else throw new Error("Invalid corner");return t}function IE(n,e,t,i,r){const[s,o,a,c,h,d,g,m]=Tb(n,e,t,i);return Ga(Math.min(s,a,h,g),Math.min(o,c,d,m),Math.max(s,a,h,g),Math.max(o,c,d,m),r)}function Tb(n,e,t,i){const r=e*i[0]/2,s=e*i[1]/2,o=Math.cos(t),a=Math.sin(t),c=r*o,h=r*a,d=s*o,g=s*a,m=n[0],y=n[1];return[m-c+g,y-h-d,m-c-g,y-h+d,m+c-g,y+h+d,m+c+g,y+h-d,m-c+g,y-h-d]}function oi(n){return n[3]-n[1]}function Zl(n,e,t){const i=t||ir();return Ni(n,e)?(n[0]>e[0]?i[0]=n[0]:i[0]=e[0],n[1]>e[1]?i[1]=n[1]:i[1]=e[1],n[2]<e[2]?i[2]=n[2]:i[2]=e[2],n[3]<e[3]?i[3]=n[3]:i[3]=e[3]):Ng(i),i}function Ac(n){return[n[0],n[3]]}function G_(n){return[n[2],n[3]]}function ht(n){return n[2]-n[0]}function Ni(n,e){return n[0]<=e[2]&&n[2]>=e[0]&&n[1]<=e[3]&&n[3]>=e[1]}function j_(n){return n[2]<n[0]||n[3]<n[1]}function Y5(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n}function X5(n,e,t){let i=!1;const r=xE(n,e),s=xE(n,t);if(r===An.INTERSECTING||s===An.INTERSECTING)i=!0;else{const o=n[0],a=n[1],c=n[2],h=n[3],d=e[0],g=e[1],m=t[0],y=t[1],w=(y-g)/(m-d);let T,E;s&An.ABOVE&&!(r&An.ABOVE)&&(T=m-(y-h)/w,i=T>=o&&T<=c),!i&&s&An.RIGHT&&!(r&An.RIGHT)&&(E=y-(m-c)*w,i=E>=a&&E<=h),!i&&s&An.BELOW&&!(r&An.BELOW)&&(T=m-(y-a)/w,i=T>=o&&T<=c),!i&&s&An.LEFT&&!(r&An.LEFT)&&(E=y-(m-o)*w,i=E>=a&&E<=h)}return i}function Rb(n,e){const t=e.getExtent(),i=ja(n);if(e.canWrapX()&&(i[0]<t[0]||i[0]>=t[2])){const r=ht(t),o=Math.floor((i[0]-t[0])/r)*r;n[0]-=o,n[2]-=o}return n}function Pb(n,e,t){if(e.canWrapX()){const i=e.getExtent();if(!isFinite(n[0])||!isFinite(n[2]))return[[i[0],n[1],i[2],n[3]]];Rb(n,e);const r=ht(i);if(ht(n)>r&&!t)return[[i[0],n[1],i[2],n[3]]];if(n[0]<i[0])return[[n[0]+r,n[1],i[2],n[3]],[i[0],n[1],n[2],n[3]]];if(n[2]>i[2])return[[n[0],n[1],i[2],n[3]],[i[0],n[1],n[2]-r,n[3]]]}return[n]}function Dt(n,e,t){return Math.min(Math.max(n,e),t)}function Q5(n,e,t,i,r,s){const o=r-t,a=s-i;if(o!==0||a!==0){const c=((n-t)*o+(e-i)*a)/(o*o+a*a);c>1?(t=r,i=s):c>0&&(t+=o*c,i+=a*c)}return Jl(n,e,t,i)}function Jl(n,e,t,i){const r=t-n,s=i-e;return r*r+s*s}function Z5(n){const e=n.length;for(let i=0;i<e;i++){let r=i,s=Math.abs(n[i][i]);for(let a=i+1;a<e;a++){const c=Math.abs(n[a][i]);c>s&&(s=c,r=a)}if(s===0)return null;const o=n[r];n[r]=n[i],n[i]=o;for(let a=i+1;a<e;a++){const c=-n[a][i]/n[i][i];for(let h=i;h<e+1;h++)i==h?n[a][h]=0:n[a][h]+=c*n[i][h]}}const t=new Array(e);for(let i=e-1;i>=0;i--){t[i]=n[i][e]/n[i][i];for(let r=i-1;r>=0;r--)n[r][e]-=n[r][i]*t[i]}return t}function gR(n){return n*180/Math.PI}function Ca(n){return n*Math.PI/180}function Ma(n,e){const t=n%e;return t*e<0?t+e:t}function Zi(n,e,t){return n+t*(e-n)}function Og(n,e){const t=Math.pow(10,e);return Math.round(n*t)/t}function mR(n,e){return Math.round(Og(n,e))}function Ip(n,e){return Math.floor(Og(n,e))}function Tp(n,e){return Math.ceil(Og(n,e))}function TE(n,e,t){if(n>=e&&n<t)return n;const i=t-e;return((n-e)%i+i)%i+e}function Ab(n,e){const t=(""+n).split("."),i=(""+e).split(".");for(let r=0;r<Math.max(t.length,i.length);r++){const s=parseInt(t[r]||"0",10),o=parseInt(i[r]||"0",10);if(s>o)return 1;if(o>s)return-1}return 0}function J5(n,e){return n[0]+=+e[0],n[1]+=+e[1],n}function R0(n,e){let t=!0;for(let i=n.length-1;i>=0;--i)if(n[i]!=e[i]){t=!1;break}return t}function cx(n,e){const t=Math.cos(e),i=Math.sin(e),r=n[0]*t-n[1]*i,s=n[1]*t+n[0]*i;return n[0]=r,n[1]=s,n}function e6(n,e){return n[0]*=e,n[1]*=e,n}function Cb(n,e){if(e.canWrapX()){const t=ht(e.getExtent()),i=Mb(n,e,t);i&&(n[0]-=i*t)}return n}function Mb(n,e,t){const i=e.getExtent();let r=0;return e.canWrapX()&&(n[0]<i[0]||n[0]>i[2])&&(t=t||ht(i),r=Math.floor((n[0]-i[0])/t)),r}function bb(...n){console.warn(...n)}const ph={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};let ux=class{constructor(e){this.code_=e.code,this.units_=e.units,this.extent_=e.extent!==void 0?e.extent:null,this.worldExtent_=e.worldExtent!==void 0?e.worldExtent:null,this.axisOrientation_=e.axisOrientation!==void 0?e.axisOrientation:"enu",this.global_=e.global!==void 0?e.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||ph[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(e){this.global_=e,this.canWrapX_=!!(e&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(e){this.defaultTileGrid_=e}setExtent(e){this.extent_=e,this.canWrapX_=!!(this.global_&&e)}setWorldExtent(e){this.worldExtent_=e}setGetPointResolution(e){this.getPointResolutionFunc_=e}getPointResolutionFunc(){return this.getPointResolutionFunc_}};const Dg=6378137,Wu=Math.PI*Dg,t6=[-Wu,-Wu,Wu,Wu],n6=[-180,-85,180,85],Rp=Dg*Math.log(Math.tan(Math.PI/2));class wu extends ux{constructor(e){super({code:e,units:"m",extent:t6,global:!0,worldExtent:n6,getPointResolution:function(t,i){return t/Math.cosh(i[1]/Dg)}})}}const pR=[new wu("EPSG:3857"),new wu("EPSG:102100"),new wu("EPSG:102113"),new wu("EPSG:900913"),new wu("http://www.opengis.net/def/crs/EPSG/0/3857"),new wu("http://www.opengis.net/gml/srs/epsg.xml#3857")];function i6(n,e,t,i){const r=n.length;t=t>1?t:2,i=i??t,e===void 0&&(t>2?e=n.slice():e=new Array(r));for(let s=0;s<r;s+=i){e[s]=Wu*n[s]/180;let o=Dg*Math.log(Math.tan(Math.PI*(+n[s+1]+90)/360));o>Rp?o=Rp:o<-Rp&&(o=-Rp),e[s+1]=o}return e}function r6(n,e,t,i){const r=n.length;t=t>1?t:2,i=i??t,e===void 0&&(t>2?e=n.slice():e=new Array(r));for(let s=0;s<r;s+=i)e[s]=180*n[s]/Wu,e[s+1]=360*Math.atan(Math.exp(n[s+1]/Dg))/Math.PI-90;return e}const s6=6378137,_R=[-180,-90,180,90],o6=Math.PI*s6/180;class Al extends ux{constructor(e,t){super({code:e,units:"degrees",extent:_R,axisOrientation:t,global:!0,metersPerUnit:o6,worldExtent:_R})}}const yR=[new Al("CRS:84"),new Al("EPSG:4326","neu"),new Al("urn:ogc:def:crs:OGC:1.3:CRS84"),new Al("urn:ogc:def:crs:OGC:2:84"),new Al("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new Al("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new Al("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let RE={};function a6(n){return RE[n]||RE[n.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function l6(n,e){RE[n]=e}let nh={};function oc(n,e,t){const i=n.getCode(),r=e.getCode();i in nh||(nh[i]={}),nh[i][r]=t}function d1(n,e){return n in nh&&e in nh[n]?nh[n][e]:null}const P0=.9996,Mr=.00669438,U_=Mr*Mr,B_=U_*Mr,Hl=Mr/(1-Mr),vR=Math.sqrt(1-Mr),_h=(1-vR)/(1+vR),kb=_h*_h,hx=kb*_h,dx=hx*_h,Lb=dx*_h,Nb=1-Mr/4-3*U_/64-5*B_/256,c6=3*Mr/8+3*U_/32+45*B_/1024,u6=15*U_/256+45*B_/1024,h6=35*B_/3072,d6=3/2*_h-27/32*hx+269/512*Lb,f6=21/16*kb-55/32*dx,g6=151/96*hx-417/128*Lb,m6=1097/512*dx,A0=6378137;function p6(n,e,t){const i=n-5e5,o=(t.north?e:e-1e7)/P0/(A0*Nb),a=o+d6*Math.sin(2*o)+f6*Math.sin(4*o)+g6*Math.sin(6*o)+m6*Math.sin(8*o),c=Math.sin(a),h=c*c,d=Math.cos(a),g=c/d,m=g*g,y=m*m,w=1-Mr*h,T=Math.sqrt(1-Mr*h),E=A0/T,P=(1-Mr)/w,M=Hl*d**2,N=M*M,D=i/(E*P0),j=D*D,W=j*D,L=W*D,A=L*D,k=A*D,U=a-g/P*(j/2-L/24*(5+3*m+10*M-4*N-9*Hl))+k/720*(61+90*m+298*M+45*y-252*Hl-3*N);let B=(D-W/6*(1+2*m+M)+A/120*(5-2*M+28*m-3*N+8*Hl+24*y))/d;return B=TE(B+Ca(Ob(t.number)),-Math.PI,Math.PI),[gR(B),gR(U)]}const ER=-80,wR=84,_6=-180,y6=180;function v6(n,e,t){n=TE(n,_6,y6),e<ER?e=ER:e>wR&&(e=wR);const i=Ca(e),r=Math.sin(i),s=Math.cos(i),o=r/s,a=o*o,c=a*a,h=Ca(n),d=Ob(t.number),g=Ca(d),m=A0/Math.sqrt(1-Mr*r**2),y=Hl*s**2,w=s*TE(h-g,-Math.PI,Math.PI),T=w*w,E=T*w,P=E*w,M=P*w,N=M*w,D=A0*(Nb*i-c6*Math.sin(2*i)+u6*Math.sin(4*i)-h6*Math.sin(6*i)),j=P0*m*(w+E/6*(1-a+y)+M/120*(5-18*a+c+72*y-58*Hl))+5e5;let W=P0*(D+m*o*(T/2+P/24*(5-a+9*y+4*y**2)+N/720*(61-58*a+c+600*y-330*Hl)));return t.north||(W+=1e7),[j,W]}function Ob(n){return(n-1)*6-180+3}const E6=[/^EPSG:(\d+)$/,/^urn:ogc:def:crs:EPSG::(\d+)$/,/^http:\/\/www\.opengis\.net\/def\/crs\/EPSG\/0\/(\d+)$/];function Db(n){let e=0;for(const r of E6){const s=n.match(r);if(s){e=parseInt(s[1]);break}}if(!e)return null;let t=0,i=!1;return e>32700&&e<32761?t=e-32700:e>32600&&e<32661&&(i=!0,t=e-32600),t?{number:t,north:i}:null}function xR(n,e){return function(t,i,r,s){const o=t.length;r=r>1?r:2,s=s??r,i||(r>2?i=t.slice():i=new Array(o));for(let a=0;a<o;a+=s){const c=t[a],h=t[a+1],d=n(c,h,e);i[a]=d[0],i[a+1]=d[1]}return i}}function w6(n){return Db(n)?new ux({code:n,units:"m"}):null}function x6(n){const e=Db(n.getCode());return e?{forward:xR(v6,e),inverse:xR(p6,e)}:null}const S6=63710088e-1;function SR(n,e,t){t=t||S6;const i=Ca(n[1]),r=Ca(e[1]),s=(r-i)/2,o=Ca(e[0]-n[0])/2,a=Math.sin(s)*Math.sin(s)+Math.sin(o)*Math.sin(o)*Math.cos(i)*Math.cos(r);return 2*t*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))}const I6=[x6],T6=[w6];let PE=!0;function Vb(n){PE=!1}function fx(n,e){if(e!==void 0){for(let t=0,i=n.length;t<i;++t)e[t]=n[t];e=e}else e=n.slice();return e}function AE(n){l6(n.getCode(),n),oc(n,n,fx)}function R6(n){n.forEach(AE)}function Vt(n){if(typeof n!="string")return n;const e=a6(n);if(e)return e;for(const t of T6){const i=t(n);if(i)return i}return null}function C0(n,e,t,i){n=Vt(n);let r;const s=n.getPointResolutionFunc();if(s){if(r=s(e,t),i&&i!==n.getUnits()){const o=n.getMetersPerUnit();o&&(r=r*o/ph[i])}}else{const o=n.getUnits();if(o=="degrees"&&!i||i=="degrees")r=e;else{const a=mx(n,Vt("EPSG:4326"));if(!a&&o!=="degrees")r=e*n.getMetersPerUnit();else{let h=[t[0]-e/2,t[1],t[0]+e/2,t[1],t[0],t[1]-e/2,t[0],t[1]+e/2];h=a(h,h,2);const d=SR(h.slice(0,2),h.slice(2,4)),g=SR(h.slice(4,6),h.slice(6,8));r=(d+g)/2}const c=i?ph[i]:n.getMetersPerUnit();c!==void 0&&(r/=c)}}return r}function IR(n){R6(n),n.forEach(function(e){n.forEach(function(t){e!==t&&oc(e,t,fx)})})}function P6(n,e,t,i){n.forEach(function(r){e.forEach(function(s){oc(r,s,t),oc(s,r,i)})})}function gx(n,e){return n?typeof n=="string"?Vt(n):n:Vt(e)}function CE(n){return(function(e,t,i,r){const s=e.length;i=i!==void 0?i:2,r=r??i,t=t!==void 0?t:new Array(s);for(let o=0;o<s;o+=r){const a=n(e.slice(o,o+i)),c=a.length;for(let h=0,d=r;h<d;++h)t[o+h]=h>=c?e[o+h]:a[h]}return t})}function ure(n,e,t,i){const r=Vt(n),s=Vt(e);oc(r,s,CE(t)),oc(s,r,CE(i))}function ac(n,e){return Vb(),Vg(n,"EPSG:4326","EPSG:3857")}function Ct(n,e){const t=Vg(n,"EPSG:3857","EPSG:4326"),i=t[0];return(i<-180||i>180)&&(t[0]=Ma(i+180,360)-180),t}function Ef(n,e){if(n===e)return!0;const t=n.getUnits()===e.getUnits();return(n.getCode()===e.getCode()||mx(n,e)===fx)&&t}function mx(n,e){const t=n.getCode(),i=e.getCode();let r=d1(t,i);if(r)return r;let s=null,o=null;for(const c of I6)s||(s=c(n)),o||(o=c(e));if(!s&&!o)return null;const a="EPSG:4326";if(o)if(s)r=f1(s.inverse,o.forward);else{const c=d1(t,a);c&&(r=f1(c,o.forward))}else{const c=d1(a,i);c&&(r=f1(s.inverse,c))}return r&&(AE(n),AE(e),oc(n,e,r)),r}function f1(n,e){return function(t,i,r,s){return i=n(t,i,r,s),e(i,i,r,s)}}function Hf(n,e){const t=Vt(n),i=Vt(e);return mx(t,i)}function Vg(n,e,t){const i=Hf(e,t);if(!i){const r=Vt(e).getCode(),s=Vt(t).getCode();throw new Error(`No transform available between ${r} and ${s}`)}return i(n,void 0,n.length)}function ME(n,e){return n}function lo(n,e){return PE&&!R0(n,[0,0])&&n[0]>=-180&&n[0]<=180&&n[1]>=-90&&n[1]<=90&&(PE=!1,bb("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),n}function Fb(n,e){return n}function Sa(n,e){return n}function hre(n,e,t){return function(i){let r,s;if(n.canWrapX()){const o=n.getExtent(),a=ht(o);i=i.slice(0),s=Mb(i,n,a),s&&(i[0]=i[0]-s*a),i[0]=Dt(i[0],o[0],o[2]),i[1]=Dt(i[1],o[1],o[3]),r=t(i)}else r=t(i);return s&&e.canWrapX()&&(r[0]+=s*ht(e.getExtent())),r}}function A6(){IR(pR),IR(yR),P6(yR,pR,i6,r6)}A6();new Array(6);function Zr(){return[1,0,0,1,0,0]}function C6(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n}function Mn(n,e){const t=e[0],i=e[1];return e[0]=n[0]*t+n[2]*i+n[4],e[1]=n[1]*t+n[3]*i+n[5],e}function Eo(n,e,t,i,r,s,o,a){const c=Math.sin(s),h=Math.cos(s);return n[0]=i*h,n[1]=r*c,n[2]=-i*c,n[3]=r*h,n[4]=o*i*h-a*i*c+e,n[5]=o*r*c+a*r*h+t,n}function Gb(n,e){const t=M6(e);yt(t!==0,"Transformation matrix cannot be inverted");const i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],c=e[5];return n[0]=o/t,n[1]=-r/t,n[2]=-s/t,n[3]=i/t,n[4]=(s*c-o*a)/t,n[5]=-(i*c-r*a)/t,n}function M6(n){return n[0]*n[3]-n[1]*n[2]}const b6=[1e5,1e5,1e5,1e5,2,2];function k6(n){return"matrix("+n.join(", ")+")"}function bE(n){return n.substring(7,n.length-1).split(",").map(parseFloat)}function L6(n,e){const t=bE(n),i=bE(e);for(let r=0;r<6;++r)if(Math.round((t[r]-i[r])*b6[r])!==0)return!1;return!0}function ba(n,e,t,i,r,s,o){s=s||[],o=o||2;let a=0;for(let c=e;c<t;c+=i){const h=n[c],d=n[c+1];s[a++]=r[0]*h+r[2]*d+r[4],s[a++]=r[1]*h+r[3]*d+r[5];for(let g=2;g<o;g++)s[a++]=n[c+g]}return s&&s.length!=a&&(s.length=a),s}function jb(n,e,t,i,r,s,o){o=o||[];const a=Math.cos(r),c=Math.sin(r),h=s[0],d=s[1];let g=0;for(let m=e;m<t;m+=i){const y=n[m]-h,w=n[m+1]-d;o[g++]=h+y*a-w*c,o[g++]=d+y*c+w*a;for(let T=m+2;T<m+i;++T)o[g++]=n[T]}return o&&o.length!=g&&(o.length=g),o}function N6(n,e,t,i,r,s,o,a){a=a||[];const c=o[0],h=o[1];let d=0;for(let g=e;g<t;g+=i){const m=n[g]-c,y=n[g+1]-h;a[d++]=c+r*m,a[d++]=h+s*y;for(let w=g+2;w<g+i;++w)a[d++]=n[w]}return a&&a.length!=d&&(a.length=d),a}function O6(n,e,t,i,r,s,o){o=o||[];let a=0;for(let c=e;c<t;c+=i){o[a++]=n[c]+r,o[a++]=n[c+1]+s;for(let h=c+2;h<c+i;++h)o[a++]=n[h]}return o&&o.length!=a&&(o.length=a),o}const TR=Zr(),D6=[NaN,NaN];class Ub extends js{constructor(){super(),this.extent_=ir(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=_b((e,t,i)=>{if(!i)return this.getSimplifiedGeometry(t);const r=this.clone();return r.applyTransform(i),r.getSimplifiedGeometry(t)})}simplifyTransformed(e,t){return this.simplifyTransformedInternal(this.getRevision(),e,t)}clone(){return We()}closestPointXY(e,t,i,r){return We()}containsXY(e,t){return this.closestPointXY(e,t,D6,Number.MIN_VALUE)===0}getClosestPoint(e,t){return t=t||[NaN,NaN],this.closestPointXY(e[0],e[1],t,1/0),t}intersectsCoordinate(e){return this.containsXY(e[0],e[1])}computeExtent(e){return We()}getExtent(e){if(this.extentRevision_!=this.getRevision()){const t=this.computeExtent(this.extent_);(isNaN(t[0])||isNaN(t[1]))&&Ng(t),this.extentRevision_=this.getRevision()}return Y5(this.extent_,e)}rotate(e,t){We()}scale(e,t,i){We()}simplify(e){return this.getSimplifiedGeometry(e*e)}getSimplifiedGeometry(e){return We()}getType(){return We()}applyTransform(e){We()}intersectsExtent(e){return We()}translate(e,t){We()}transform(e,t){const i=Vt(e),r=i.getUnits()=="tile-pixels"?function(s,o,a){const c=i.getExtent(),h=i.getWorldExtent(),d=oi(h)/oi(c);Eo(TR,h[0],h[3],d,-d,0,0,0);const g=ba(s,0,s.length,a,TR,o),m=Hf(i,t);return m?m(g,g,a):g}:Hf(i,t);return this.applyTransform(r),this}}class Cc extends Ub{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(e){return lx(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinates(){return We()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const t=this.getSimplifiedGeometryInternal(e);return t.getFlatCoordinates().length<this.flatCoordinates.length?t:(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getSimplifiedGeometryInternal(e){return this}getStride(){return this.stride}setFlatCoordinates(e,t){this.stride=RR(e),this.layout=e,this.flatCoordinates=t}setCoordinates(e,t){We()}setLayout(e,t,i){let r;if(e)r=RR(e);else{for(let s=0;s<i;++s){if(t.length===0){this.layout="XY",this.stride=2;return}t=t[0]}r=t.length,e=Mc(r)}this.layout=e,this.stride=r}applyTransform(e){this.flatCoordinates&&(e(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(e,t){const i=this.getFlatCoordinates();if(i){const r=this.getStride();jb(i,0,i.length,r,e,t,i),this.changed()}}scale(e,t,i){t===void 0&&(t=e),i||(i=ja(this.getExtent()));const r=this.getFlatCoordinates();if(r){const s=this.getStride();N6(r,0,r.length,s,e,t,i,r),this.changed()}}translate(e,t){const i=this.getFlatCoordinates();if(i){const r=this.getStride();O6(i,0,i.length,r,e,t,i),this.changed()}}}function Mc(n){let e;return n==2?e="XY":n==3?e="XYZ":n==4&&(e="XYZM"),e}function RR(n){let e;return n=="XY"?e=2:n=="XYZ"||n=="XYM"?e=3:n=="XYZM"&&(e=4),e}function V6(n,e,t){const i=n.getFlatCoordinates();if(!i)return null;const r=n.getStride();return ba(i,0,i.length,r,e,t)}function PR(n,e,t,i,r,s,o){const a=n[e],c=n[e+1],h=n[t]-a,d=n[t+1]-c;let g;if(h===0&&d===0)g=e;else{const m=((r-a)*h+(s-c)*d)/(h*h+d*d);if(m>1)g=t;else if(m>0){for(let y=0;y<i;++y)o[y]=Zi(n[e+y],n[t+y],m);o.length=i;return}else g=e}for(let m=0;m<i;++m)o[m]=n[g+m];o.length=i}function px(n,e,t,i,r){let s=n[e],o=n[e+1];for(e+=i;e<t;e+=i){const a=n[e],c=n[e+1],h=Jl(s,o,a,c);h>r&&(r=h),s=a,o=c}return r}function _x(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const a=t[s];r=px(n,e,a,i,r),e=a}return r}function F6(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const a=t[s];r=_x(n,e,a,i,r),e=a[a.length-1]}return r}function yx(n,e,t,i,r,s,o,a,c,h,d){if(e==t)return h;let g,m;if(r===0){if(m=Jl(o,a,n[e],n[e+1]),m<h){for(g=0;g<i;++g)c[g]=n[e+g];return c.length=i,m}return h}d=d||[NaN,NaN];let y=e+i;for(;y<t;)if(PR(n,y-i,y,i,o,a,d),m=Jl(o,a,d[0],d[1]),m<h){for(h=m,g=0;g<i;++g)c[g]=d[g];c.length=i,y+=i}else y+=i*Math.max((Math.sqrt(m)-Math.sqrt(h))/r|0,1);if(s&&(PR(n,t-i,e,i,o,a,d),m=Jl(o,a,d[0],d[1]),m<h)){for(h=m,g=0;g<i;++g)c[g]=d[g];c.length=i}return h}function vx(n,e,t,i,r,s,o,a,c,h,d){d=d||[NaN,NaN];for(let g=0,m=t.length;g<m;++g){const y=t[g];h=yx(n,e,y,i,r,s,o,a,c,h,d),e=y}return h}function G6(n,e,t,i,r,s,o,a,c,h,d){d=d||[NaN,NaN];for(let g=0,m=t.length;g<m;++g){const y=t[g];h=vx(n,e,y,i,r,s,o,a,c,h,d),e=y[y.length-1]}return h}function j6(n,e,t,i){for(let r=0,s=t.length;r<s;++r)n[e++]=t[r];return e}function z_(n,e,t,i){for(let r=0,s=t.length;r<s;++r){const o=t[r];for(let a=0;a<i;++a)n[e++]=o[a]}return e}function Fg(n,e,t,i,r){r=r||[];let s=0;for(let o=0,a=t.length;o<a;++o){const c=z_(n,e,t[o],i);r[s++]=c,e=c}return r.length=s,r}function Bb(n,e,t,i,r){r=r||[];let s=0;for(let o=0,a=t.length;o<a;++o){const c=Fg(n,e,t[o],i,r[s]);c.length===0&&(c[0]=e),r[s++]=c,e=c[c.length-1]}return r.length=s,r}function Ia(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=e;o<t;o+=i)r[s++]=n.slice(o,o+i);return r.length=s,r}function Kf(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=0,a=t.length;o<a;++o){const c=t[o];r[s++]=Ia(n,e,c,i,r[s]),e=c}return r.length=s,r}function kE(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=0,a=t.length;o<a;++o){const c=t[o];r[s++]=c.length===1&&c[0]===e?[]:Kf(n,e,c,i,r[s]),e=c[c.length-1]}return r.length=s,r}function M0(n,e,t,i,r,s,o){let a,c;const h=(t-e)/i;if(h===1)a=e;else if(h===2)a=e,c=r;else if(h!==0){let d=n[e],g=n[e+1],m=0;const y=[0];for(let E=e+i;E<t;E+=i){const P=n[E],M=n[E+1];m+=Math.sqrt((P-d)*(P-d)+(M-g)*(M-g)),y.push(m),d=P,g=M}const w=r*m,T=j5(y,w);T<0?(c=(w-y[-T-2])/(y[-T-1]-y[-T-2]),a=e+(-T-2)*i):a=e+T*i}o=o>1?o:2,s=s||new Array(o);for(let d=0;d<o;++d)s[d]=a===void 0?NaN:c===void 0?n[a+d]:Zi(n[a+d],n[a+i+d],c);return s}function LE(n,e,t,i,r,s){if(t==e)return null;let o;if(r<n[e+i-1])return s?(o=n.slice(e,e+i),o[i-1]=r,o):null;if(n[t-1]<r)return s?(o=n.slice(t-i,t),o[i-1]=r,o):null;if(r==n[e+i-1])return n.slice(e,e+i);let a=e/i,c=t/i;for(;a<c;){const m=a+c>>1;r<n[(m+1)*i-1]?c=m:a=m+1}const h=n[a*i-1];if(r==h)return n.slice((a-1)*i,(a-1)*i+i);const d=n[(a+1)*i-1],g=(r-h)/(d-h);o=[];for(let m=0;m<i-1;++m)o.push(Zi(n[(a-1)*i+m],n[a*i+m],g));return o.push(r),o}function U6(n,e,t,i,r,s,o){if(o)return LE(n,e,t[t.length-1],i,r,s);let a;if(r<n[i-1])return s?(a=n.slice(0,i),a[i-1]=r,a):null;if(n[n.length-1]<r)return s?(a=n.slice(n.length-i),a[i-1]=r,a):null;for(let c=0,h=t.length;c<h;++c){const d=t[c];if(e!=d){if(r<n[e+i-1])return null;if(r<=n[d-1])return LE(n,e,d,i,r,!1);e=d}}return null}function B6(n,e,t,i,r){return!Ib(r,function(o){return!Kl(n,e,t,i,o[0],o[1])})}function Kl(n,e,t,i,r,s){let o=0,a=n[t-i],c=n[t-i+1];for(;e<t;e+=i){const h=n[e],d=n[e+1];c<=s?d>s&&(h-a)*(s-c)-(r-a)*(d-c)>0&&o++:d<=s&&(h-a)*(s-c)-(r-a)*(d-c)<0&&o--,a=h,c=d}return o!==0}function Ex(n,e,t,i,r,s){if(t.length===0||!Kl(n,e,t[0],i,r,s))return!1;for(let o=1,a=t.length;o<a;++o)if(Kl(n,t[o-1],t[o],i,r,s))return!1;return!0}function z6(n,e,t,i,r,s){if(t.length===0)return!1;for(let o=0,a=t.length;o<a;++o){const c=t[o];if(Ex(n,e,c,i,r,s))return!0;e=c[c.length-1]}return!1}function zb(n,e,t,i,r){let s;for(e+=i;e<t;e+=i)if(s=r(n.slice(e-i,e),n.slice(e,e+i)),s)return s;return!1}function $_(n,e,t,i,r,s){return s=s??Sb(ir(),n,e,t,i),Ni(r,s)?s[0]>=r[0]&&s[2]<=r[2]||s[1]>=r[1]&&s[3]<=r[3]?!0:zb(n,e,t,i,function(o,a){return X5(r,o,a)}):!1}function $6(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){if($_(n,e,t[s],i,r))return!0;e=t[s]}return!1}function $b(n,e,t,i,r){return!!($_(n,e,t,i,r)||Kl(n,e,t,i,r[0],r[1])||Kl(n,e,t,i,r[0],r[3])||Kl(n,e,t,i,r[2],r[1])||Kl(n,e,t,i,r[2],r[3]))}function Wb(n,e,t,i,r){if(!$b(n,e,t[0],i,r))return!1;if(t.length===1)return!0;for(let s=1,o=t.length;s<o;++s)if(B6(n,t[s-1],t[s],i,r)&&!$_(n,t[s-1],t[s],i,r))return!1;return!0}function W6(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const a=t[s];if(Wb(n,e,a,i,r))return!0;e=a[a.length-1]}return!1}function wx(n,e,t,i){let r=n[e],s=n[e+1],o=0;for(let a=e+i;a<t;a+=i){const c=n[a],h=n[a+1];o+=Math.sqrt((c-r)*(c-r)+(h-s)*(h-s)),r=c,s=h}return o}function W_(n,e,t,i,r,s,o){const a=(t-e)/i;if(a<3){for(;e<t;e+=i)s[o++]=n[e],s[o++]=n[e+1];return o}const c=new Array(a);c[0]=1,c[a-1]=1;const h=[e,t-i];let d=0;for(;h.length>0;){const g=h.pop(),m=h.pop();let y=0;const w=n[m],T=n[m+1],E=n[g],P=n[g+1];for(let M=m+i;M<g;M+=i){const N=n[M],D=n[M+1],j=Q5(N,D,w,T,E,P);j>y&&(d=M,y=j)}y>r&&(c[(d-e)/i]=1,m+i<d&&h.push(m,d),d+i<g&&h.push(d,g))}for(let g=0;g<a;++g)c[g]&&(s[o++]=n[e+g*i],s[o++]=n[e+g*i+1]);return o}function Hb(n,e,t,i,r,s,o,a){for(let c=0,h=t.length;c<h;++c){const d=t[c];o=W_(n,e,d,i,r,s,o),a.push(o),e=d}return o}function kl(n,e){return e*Math.round(n/e)}function H6(n,e,t,i,r,s,o){if(e==t)return o;let a=kl(n[e],r),c=kl(n[e+1],r);e+=i,s[o++]=a,s[o++]=c;let h,d;do if(h=kl(n[e],r),d=kl(n[e+1],r),e+=i,e==t)return s[o++]=h,s[o++]=d,o;while(h==a&&d==c);for(;e<t;){const g=kl(n[e],r),m=kl(n[e+1],r);if(e+=i,g==h&&m==d)continue;const y=h-a,w=d-c,T=g-a,E=m-c;if(y*E==w*T&&(y<0&&T<y||y==T||y>0&&T>y)&&(w<0&&E<w||w==E||w>0&&E>w)){h=g,d=m;continue}s[o++]=h,s[o++]=d,a=h,c=d,h=g,d=m}return s[o++]=h,s[o++]=d,o}function xx(n,e,t,i,r,s,o,a){for(let c=0,h=t.length;c<h;++c){const d=t[c];o=H6(n,e,d,i,r,s,o),a.push(o),e=d}return o}function K6(n,e,t,i,r,s,o,a){for(let c=0,h=t.length;c<h;++c){const d=t[c],g=[];o=xx(n,e,d,i,r,s,o,g),a.push(g),e=d[d.length-1]}return o}class lc extends Cc{constructor(e,t){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,t!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}appendCoordinate(e){Cs(this.flatCoordinates,e),this.changed()}clone(){const e=new lc(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,i,r){return r<Pc(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(px(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),yx(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,e,t,i,r))}forEachSegment(e){return zb(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinateAtM(e,t){return this.layout!="XYM"&&this.layout!="XYZM"?null:(t=t!==void 0?t:!1,LE(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t))}getCoordinates(){return Ia(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(e,t){return M0(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,this.stride)}getLength(){return wx(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_??void 0),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(e){const t=[];return t.length=W_(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new lc(t,"XY")}getType(){return"LineString"}intersectsExtent(e){return $_(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,this.getExtent())}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=z_(this.flatCoordinates,0,e,this.stride),this.changed()}}let cc=class Kb extends Cc{constructor(e,t){super(),this.setCoordinates(e,t)}clone(){const e=new Kb(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,i,r){const s=this.flatCoordinates,o=Jl(e,t,s[0],s[1]);if(o<r){const a=this.stride;for(let c=0;c<a;++c)i[c]=s[c];return i.length=a,o}return r}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(e){return wb(this.flatCoordinates,e)}getType(){return"Point"}intersectsExtent(e){return ax(e,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(e,t){this.setLayout(t,e,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=j6(this.flatCoordinates,0,e,this.stride),this.changed()}};const Pr={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"},uc=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",q6=uc.includes("safari")&&!uc.includes("chrom");q6&&(uc.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(uc));const Y6=uc.includes("webkit")&&!uc.includes("edge"),qb=uc.includes("macintosh"),X6=typeof devicePixelRatio<"u"?devicePixelRatio:1,er=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,Sx=typeof Image<"u"&&Image.prototype.decode,Yb=typeof createImageBitmap=="function",Xb=(function(){let n=!1;try{const e=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch{}return n})(),Ke={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function En(n,e,t,i){let r;return t&&t.length?r=t.shift():er?r=new class extends OffscreenCanvas{style={}}(n??300,e??150):r=document.createElement("canvas"),n&&(r.width=n),e&&(r.height=e),r.getContext("2d",i)}let g1;function b0(){return g1||(g1=En(1,1)),g1}function H_(n){const e=n.canvas;e.width=1,e.height=1,n.clearRect(0,0,1,1)}function AR(n,e){const t=e.parentNode;t&&t.replaceChild(n,e)}function Q6(n){for(;n.lastChild;)n.lastChild.remove()}function Z6(n,e){const t=n.childNodes;for(let i=0;;++i){const r=t[i],s=e[i];if(!r&&!s)break;if(r!==s){if(!r){n.appendChild(s);continue}if(!s){n.removeChild(r),--i;continue}n.insertBefore(s,r)}}}function Qb(){return new Proxy({childNodes:[],appendChild:function(e){return this.childNodes.push(e),e},remove:function(){},removeChild:function(e){const t=this.childNodes.indexOf(e);if(t===-1)throw new Error("Node to remove was not found");return this.childNodes.splice(t,1),e},insertBefore:function(e,t){const i=this.childNodes.indexOf(t);if(i===-1)throw new Error("Reference node not found");return this.childNodes.splice(i,0,e),e},style:{}},{get(e,t,i){return t==="firstElementChild"?e.childNodes.length>0?e.childNodes[0]:null:Reflect.get(e,t,i)}})}function Ta(n){return typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas}const Ix=[NaN,NaN,NaN,0];let m1;function J6(){return m1||(m1=En(1,1,void 0,{willReadFrequently:!0,desynchronized:!0})),m1}const e8=/^rgba?\(\s*(\d+%?)\s+(\d+%?)\s+(\d+%?)(?:\s*\/\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,t8=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,n8=/^rgba?\(\s*(\d+%)\s*,\s*(\d+%)\s*,\s*(\d+%)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,i8=/^#([\da-f]{3,4}|[\da-f]{6}|[\da-f]{8})$/i;function Pp(n,e){return n.endsWith("%")?Number(n.substring(0,n.length-1))/e:Number(n)}function wf(n){throw new Error('failed to parse "'+n+'" as color')}function Zb(n){if(n.toLowerCase().startsWith("rgb")){const s=n.match(t8)||n.match(e8)||n.match(n8);if(s){const o=s[4],a=100/255;return[Dt(Pp(s[1],a)+.5|0,0,255),Dt(Pp(s[2],a)+.5|0,0,255),Dt(Pp(s[3],a)+.5|0,0,255),o!==void 0?Dt(Pp(o,100),0,1):1]}wf(n)}if(n.startsWith("#")){if(i8.test(n)){const s=n.substring(1),o=s.length<=4?1:2,a=[0,0,0,255];for(let c=0,h=s.length;c<h;c+=o){let d=parseInt(s.substring(c,c+o),16);o===1&&(d+=d<<4),a[c/o]=d}return a[3]=a[3]/255,a}wf(n)}const e=J6();e.fillStyle="#abcdef";let t=e.fillStyle;e.fillStyle=n,e.fillStyle===t&&(e.fillStyle="#fedcba",t=e.fillStyle,e.fillStyle=n,e.fillStyle===t&&wf(n));const i=e.fillStyle;if(i.startsWith("#")||i.startsWith("rgba"))return Zb(i);e.clearRect(0,0,1,1),e.fillRect(0,0,1,1);const r=Array.from(e.getImageData(0,0,1,1).data);return r[3]=Og(r[3]/255,3),r}function r8(n){return typeof n=="string"?n:Rx(n)}const s8=1024,jd={};let p1=0;function o8(n){if(n.length===4)return n;const e=n.slice();return e[3]=1,e}function _1(n){return n>.0031308?Math.pow(n,1/2.4)*269.025-14.025:n*3294.6}function y1(n){return n>.2068965?Math.pow(n,3):(n-4/29)*(108/841)}function v1(n){return n>10.314724?Math.pow((n+14.025)/269.025,2.4):n/3294.6}function E1(n){return n>.0088564?Math.pow(n,1/3):n/(108/841)+4/29}function CR(n){const e=v1(n[0]),t=v1(n[1]),i=v1(n[2]),r=E1(e*.222488403+t*.716873169+i*.06060791),s=500*(E1(e*.452247074+t*.399439023+i*.148375274)-r),o=200*(r-E1(e*.016863605+t*.117638439+i*.865350722)),a=Math.atan2(o,s)*(180/Math.PI);return[116*r-16,Math.sqrt(s*s+o*o),a<0?a+360:a,n[3]]}function a8(n){const e=(n[0]+16)/116,t=n[1],i=n[2]*Math.PI/180,r=y1(e),s=y1(e+t/500*Math.cos(i)),o=y1(e-t/200*Math.sin(i)),a=_1(s*3.021973625-r*1.617392459-o*.404875592),c=_1(s*-.943766287+r*1.916279586+o*.027607165),h=_1(s*.069407491-r*.22898585+o*1.159737864);return[Dt(a+.5|0,0,255),Dt(c+.5|0,0,255),Dt(h+.5|0,0,255),n[3]]}function Tx(n){if(n==="none")return Ix;if(jd.hasOwnProperty(n))return jd[n];if(p1>=s8){let t=0;for(const i in jd)(t++&3)===0&&(delete jd[i],--p1)}const e=Zb(n);e.length!==4&&wf(n);for(const t of e)isNaN(t)&&wf(n);return jd[n]=e,++p1,e}function yh(n){return Array.isArray(n)?n:Tx(n)}function Rx(n){let e=n[0];e!=(e|0)&&(e=e+.5|0);let t=n[1];t!=(t|0)&&(t=t+.5|0);let i=n[2];i!=(i|0)&&(i=i+.5|0);const r=n[3]===void 0?1:Math.round(n[3]*1e3)/1e3;return"rgba("+e+","+t+","+i+","+r+")"}class dre extends kg{constructor(e,t,i,r){super(),this.extent=e,this.pixelRatio_=i,this.resolution=t,this.state=typeof r=="function"?Ke.IDLE:r,this.image_=null,this.loader=typeof r=="function"?r:null}changed(){this.dispatchEvent(Qe.CHANGE)}getExtent(){return this.extent}getImage(){return this.image_}getPixelRatio(){return this.pixelRatio_}getResolution(){return this.resolution}getState(){return this.state}load(){if(this.state==Ke.IDLE&&this.loader){this.state=Ke.LOADING,this.changed();const e=this.getResolution(),t=Array.isArray(e)?e[0]:e;yb(()=>this.loader(this.getExtent(),t,this.getPixelRatio())).then(i=>{"image"in i&&(this.image_=i.image),"extent"in i&&(this.extent=i.extent),"resolution"in i&&(this.resolution=i.resolution),"pixelRatio"in i&&(this.pixelRatio_=i.pixelRatio),(i instanceof HTMLImageElement||Yb&&i instanceof ImageBitmap||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement)&&(this.image_=i),this.state=Ke.LOADED}).catch(i=>{this.state=Ke.ERROR,console.error(i)}).finally(()=>this.changed())}}setImage(e){this.image_=e}setResolution(e){this.resolution=e}}function l8(n,e,t){const i=n;let r=!0,s=!1,o=!1;const a=[T0(i,Qe.LOAD,function(){o=!0,s||e()})];return i.src&&Sx?(s=!0,i.decode().then(function(){r&&e()}).catch(function(c){r&&(o?e():t())})):a.push(T0(i,Qe.ERROR,t)),function(){r=!1,a.forEach(Ot)}}function c8(n,e){return new Promise((t,i)=>{function r(){o(),t(n)}function s(){o(),i(new Error("Image load error"))}function o(){n.removeEventListener("load",r),n.removeEventListener("error",s)}n.addEventListener("load",r),n.addEventListener("error",s)})}function Jb(n,e){return e&&(n.src=e),n.src&&Sx?new Promise((t,i)=>n.decode().then(()=>t(n)).catch(r=>n.complete&&n.width?t(n):i(r))):c8(n)}function fre(n,e){return e&&(n.src=e),n.src&&Sx&&Yb?n.decode().then(()=>createImageBitmap(n)).catch(t=>{if(n.complete&&n.width)return n;throw t}):Jb(n)}class u8{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=1024}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let e=0;for(const t in this.cache_){const i=this.cache_[t];(e++&3)===0&&!i.hasListener()&&(delete this.cache_[t],delete this.patternCache_[t],--this.cacheSize_)}}}get(e,t,i){const r=w1(e,t,i);return r in this.cache_?this.cache_[r]:null}getPattern(e,t,i){const r=w1(e,t,i);return r in this.patternCache_?this.patternCache_[r]:null}set(e,t,i,r,s){const o=w1(e,t,i),a=o in this.cache_;this.cache_[o]=r,s&&(r.getImageState()===Ke.IDLE&&r.load(),r.getImageState()===Ke.LOADING?r.ready().then(()=>{this.patternCache_[o]=b0().createPattern(r.getImage(1),"repeat")}):this.patternCache_[o]=b0().createPattern(r.getImage(1),"repeat")),a||++this.cacheSize_}setSize(e){this.maxCacheSize_=e,this.expire()}}function w1(n,e,t){const i=t?yh(t):"null";return e+":"+n+":"+i}const Ar=new u8;let Ud=null;class e4 extends kg{constructor(e,t,i,r,s){super(),this.hitDetectionImage_=null,this.image_=e,this.crossOrigin_=i,this.canvas_={},this.color_=s,this.imageState_=r===void 0?Ke.IDLE:r,this.size_=e&&e.width&&e.height?[e.width,e.height]:null,this.src_=t,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===Ke.LOADED){Ud||(Ud=En(1,1,void 0,{willReadFrequently:!0})),Ud.drawImage(this.image_,0,0);try{Ud.getImageData(0,0,1,1),this.tainted_=!1}catch{Ud=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(Qe.CHANGE)}handleImageError_(){this.imageState_=Ke.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=Ke.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(e){return this.image_||this.initializeImage_(),this.replaceColor_(e),this.canvas_[e]?this.canvas_[e]:this.image_}getPixelRatio(e){return this.replaceColor_(e),this.canvas_[e]?e:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const e=this.size_[0],t=this.size_[1],i=En(e,t);i.fillRect(0,0,e,t),this.hitDetectionImage_=i.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===Ke.IDLE){this.image_||this.initializeImage_(),this.imageState_=Ke.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&Jb(this.image_,this.src_).then(e=>{this.image_=e,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(e){if(!this.color_||this.canvas_[e]||this.imageState_!==Ke.LOADED)return;const t=this.image_,i=En(Math.ceil(t.width*e),Math.ceil(t.height*e)),r=i.canvas;i.scale(e,e),i.drawImage(t,0,0),i.globalCompositeOperation="multiply",i.fillStyle=r8(this.color_),i.fillRect(0,0,r.width/e,r.height/e),i.globalCompositeOperation="destination-in",i.drawImage(t,0,0),this.canvas_[e]=r}ready(){return this.ready_||(this.ready_=new Promise(e=>{if(this.imageState_===Ke.LOADED||this.imageState_===Ke.ERROR)e();else{const t=()=>{(this.imageState_===Ke.LOADED||this.imageState_===Ke.ERROR)&&(this.removeEventListener(Qe.CHANGE,t),e())};this.addEventListener(Qe.CHANGE,t)}})),this.ready_}}function k0(n,e,t,i,r,s){let o=e===void 0?void 0:Ar.get(e,t,r);return o||(o=new e4(n,n&&"src"in n?n.src||void 0:e,t,i,r),Ar.set(e,t,r,o,s)),s&&o&&!Ar.getPattern(e,t,r)&&Ar.set(e,t,r,o,s),o}function Rs(n){return n?Array.isArray(n)?Rx(n):typeof n=="object"&&"src"in n?h8(n):n:null}function h8(n){if(!n.offset||!n.size)return Ar.getPattern(n.src,"anonymous",n.color);const e=n.src+":"+n.offset,t=Ar.getPattern(e,void 0,n.color);if(t)return t;const i=Ar.get(n.src,"anonymous",null);if(i.getImageState()!==Ke.LOADED)return null;const r=En(n.size[0],n.size[1]);return r.drawImage(i.getImage(1),n.offset[0],n.offset[1],n.size[0],n.size[1],0,0,n.size[0],n.size[1]),k0(r.canvas,e,void 0,Ke.LOADED,n.color,!0),Ar.getPattern(e,void 0,n.color)}class t4{drawCustom(e,t,i,r,s){}drawGeometry(e){}setStyle(e){}drawCircle(e,t,i){}drawFeature(e,t,i){}drawGeometryCollection(e,t,i){}drawLineString(e,t,i){}drawMultiLineString(e,t,i){}drawMultiPoint(e,t,i){}drawMultiPolygon(e,t,i){}drawPoint(e,t,i){}drawPolygon(e,t,i){}drawText(e,t,i){}setFillStrokeStyle(e,t){}setImageStyle(e,t){}setTextStyle(e,t){}}const Ap="ol-hidden",Gg="ol-unselectable",Px="ol-control",MR="ol-collapsed",d8=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z0-9]+?)\\s*$`].join(""),"i"),bR=["style","variant","weight","size","lineHeight","family"],NE={normal:400,bold:700},OE=function(n){const e=n.match(d8);if(!e)return null;const t={lineHeight:"normal",size:"1.2em",style:"normal",weight:"400",variant:"normal"};for(let i=0,r=bR.length;i<r;++i){const s=e[i+1];s!==void 0&&(t[bR[i]]=typeof s=="string"?s.trim():s)}return isNaN(Number(t.weight))&&t.weight in NE&&(t.weight=NE[t.weight]),t.families=t.family.split(/,\s?/).map(i=>i.trim().replace(/^['"]|['"]$/g,"")),t},n4="10px sans-serif",ki="#000",vh="round",mo=[],po=0,Eh="round",qf=10,Yf="#000",Xf="center",L0="middle",ql=[0,0,0,0],Qf=1,Nu=new js;let Bd=null,kR;const DE={},f8=new Set(["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","emoji","math","fangsong"]);function g8(n,e,t){return`${n} ${e} 16px "${t}"`}const m8=(function(){let e,t;async function i(s){await t.ready;const o=await t.load(s);if(o.length===0)return!1;const a=OE(s),c=a.families[0].toLowerCase(),h=a.weight;return o.some(d=>{const g=d.family.replace(/^['"]|['"]$/g,"").toLowerCase(),m=NE[d.weight]||d.weight;return g===c&&d.style===a.style&&m==h})}async function r(){await t.ready;let s=!0;const o=Nu.getProperties(),a=Object.keys(o).filter(c=>o[c]<100);for(let c=a.length-1;c>=0;--c){const h=a[c];let d=o[h];d<100&&(await i(h)?(bg(DE),Nu.set(h,100)):(d+=10,Nu.set(h,d,!0),d<100&&(s=!1)))}e=void 0,s||(e=setTimeout(r,100))}return async function(s){t||(t=er?self.fonts:document.fonts);const o=OE(s);if(!o)return;const a=o.families;let c=!1;for(const h of a){if(f8.has(h))continue;const d=g8(o.style,o.weight,h);Nu.get(d)===void 0&&(Nu.set(d,0,!0),c=!0)}c&&(clearTimeout(e),e=setTimeout(r,100))}})(),p8=(function(){let n;return function(e){let t=DE[e];if(t==null){if(er){const i=OE(e),r=i4(e,"g");t=(isNaN(Number(i.lineHeight))?1.2:Number(i.lineHeight))*(r.actualBoundingBoxAscent+r.actualBoundingBoxDescent)}else n||(n=document.createElement("div"),n.innerHTML="M",n.style.minHeight="0",n.style.maxHeight="none",n.style.height="auto",n.style.padding="0",n.style.border="none",n.style.position="absolute",n.style.display="block",n.style.left="-99999px"),n.style.font=e,document.body.appendChild(n),t=n.offsetHeight,document.body.removeChild(n);DE[e]=t}return t}})();function i4(n,e){return Bd||(Bd=En(1,1)),n!=kR&&(Bd.font=n,kR=Bd.font),Bd.measureText(e)}function r4(n,e){return i4(n,e).width}function LR(n,e,t){if(e in t)return t[e];const i=e.split(`
`).reduce((r,s)=>Math.max(r,r4(n,s)),0);return t[e]=i,i}function _8(n,e){const t=[],i=[],r=[];let s=0,o=0,a=0,c=0;for(let h=0,d=e.length;h<=d;h+=2){const g=e[h];if(g===`
`||h===d){s=Math.max(s,o),r.push(o),o=0,a+=c,c=0;continue}const m=e[h+1]||n.font,y=r4(m,g);t.push(y),o+=y;const w=p8(m);i.push(w),c=Math.max(c,w)}return{width:s,height:a,widths:t,heights:i,lineWidths:r}}function y8(n,e,t,i,r,s,o,a,c,h,d){n.save(),t!==1&&(n.globalAlpha===void 0?n.globalAlpha=g=>g.globalAlpha*=t:n.globalAlpha*=t),e&&n.transform.apply(n,e),i.contextInstructions?(n.translate(c,h),n.scale(d[0],d[1]),v8(i,n)):d[0]<0||d[1]<0?(n.translate(c,h),n.scale(d[0],d[1]),n.drawImage(i,r,s,o,a,0,0,o,a)):n.drawImage(i,r,s,o,a,c,h,o*d[0],a*d[1]),n.restore()}function v8(n,e){const t=n.contextInstructions;for(let i=0,r=t.length;i<r;i+=2)Array.isArray(t[i+1])?e[t[i]].apply(e,t[i+1]):e[t[i]]=t[i+1]}class E8 extends t4{constructor(e,t,i,r,s,o,a){super(),this.context_=e,this.pixelRatio_=t,this.extent_=i,this.transform_=r,this.transformRotation_=r?Og(Math.atan2(r[1],r[0]),10):0,this.viewRotation_=s,this.squaredTolerance_=o,this.userTransform_=a,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=Zr()}drawImages_(e,t,i,r){if(!this.image_)return;const s=ba(e,t,i,r,this.transform_,this.pixelCoordinates_),o=this.context_,a=this.tmpLocalTransform_,c=o.globalAlpha;this.imageOpacity_!=1&&(o.globalAlpha=c*this.imageOpacity_);let h=this.imageRotation_;this.transformRotation_===0&&(h-=this.viewRotation_),this.imageRotateWithView_&&(h+=this.viewRotation_);for(let d=0,g=s.length;d<g;d+=2){const m=s[d]-this.imageAnchorX_,y=s[d+1]-this.imageAnchorY_;if(h!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const w=m+this.imageAnchorX_,T=y+this.imageAnchorY_;Eo(a,w,T,1,1,h,-w,-T),o.save(),o.transform.apply(o,a),o.translate(w,T),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.restore()}else o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,m,y,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(o.globalAlpha=c)}drawText_(e,t,i,r){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const s=ba(e,t,i,r,this.transform_,this.pixelCoordinates_),o=this.context_;let a=this.textRotation_;for(this.transformRotation_===0&&(a-=this.viewRotation_),this.textRotateWithView_&&(a+=this.viewRotation_);t<i;t+=r){const c=s[t]+this.textOffsetX_,h=s[t+1]+this.textOffsetY_;a!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(o.save(),o.translate(c-this.textOffsetX_,h-this.textOffsetY_),o.rotate(a),o.translate(this.textOffsetX_,this.textOffsetY_),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.restore()):(this.textStrokeState_&&o.strokeText(this.text_,c,h),this.textFillState_&&o.fillText(this.text_,c,h))}}moveToLineTo_(e,t,i,r,s){const o=this.context_,a=ba(e,t,i,r,this.transform_,this.pixelCoordinates_);o.moveTo(a[0],a[1]);let c=a.length;s&&(c-=2);for(let h=2;h<c;h+=2)o.lineTo(a[h],a[h+1]);return s&&o.closePath(),i}drawRings_(e,t,i,r){for(let s=0,o=i.length;s<o;++s)t=this.moveToLineTo_(e,t,i[s],r,!0);return t}drawCircle(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Ni(this.extent_,e.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=V6(e,this.transform_,this.pixelCoordinates_),i=t[2]-t[0],r=t[3]-t[1],s=Math.sqrt(i*i+r*r),o=this.context_;o.beginPath(),o.arc(t[0],t[1],s,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}this.text_!==""&&this.drawText_(e.getCenter(),0,2,2)}}setStyle(e){this.setFillStrokeStyle(e.getFill(),e.getStroke()),this.setImageStyle(e.getImage()),this.setTextStyle(e.getText())}setTransform(e){this.transform_=e}drawGeometry(e){switch(e.getType()){case"Point":this.drawPoint(e);break;case"LineString":this.drawLineString(e);break;case"Polygon":this.drawPolygon(e);break;case"MultiPoint":this.drawMultiPoint(e);break;case"MultiLineString":this.drawMultiLineString(e);break;case"MultiPolygon":this.drawMultiPolygon(e);break;case"GeometryCollection":this.drawGeometryCollection(e);break;case"Circle":this.drawCircle(e);break}}drawFeature(e,t){const i=t.getGeometryFunction()(e);i&&(this.setStyle(t),this.drawGeometry(i))}drawGeometryCollection(e){const t=e.getGeometriesArray();for(let i=0,r=t.length;i<r;++i)this.drawGeometry(t[i])}drawPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),i=e.getStride();this.image_&&this.drawImages_(t,0,t.length,i),this.text_!==""&&this.drawText_(t,0,t.length,i)}drawMultiPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),i=e.getStride();this.image_&&this.drawImages_(t,0,t.length,i),this.text_!==""&&this.drawText_(t,0,t.length,i)}drawLineString(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Ni(this.extent_,e.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const t=this.context_,i=e.getFlatCoordinates();t.beginPath(),this.moveToLineTo_(i,0,i.length,e.getStride(),!1),t.stroke()}if(this.text_!==""){const t=e.getFlatMidpoint();this.drawText_(t,0,2,2)}}}drawMultiLineString(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getExtent();if(Ni(this.extent_,t)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const i=this.context_,r=e.getFlatCoordinates();let s=0;const o=e.getEnds(),a=e.getStride();i.beginPath();for(let c=0,h=o.length;c<h;++c)s=this.moveToLineTo_(r,s,o[c],a,!1);i.stroke()}if(this.text_!==""){const i=e.getFlatMidpoints();this.drawText_(i,0,i.length,2)}}}drawPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Ni(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_;t.beginPath(),this.drawRings_(e.getOrientedFlatCoordinates(),0,e.getEnds(),e.getStride()),this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoint();this.drawText_(t,0,2,2)}}}drawMultiPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Ni(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_,i=e.getOrientedFlatCoordinates();let r=0;const s=e.getEndss(),o=e.getStride();t.beginPath();for(let a=0,c=s.length;a<c;++a){const h=s[a];r=this.drawRings_(i,r,h,o)}this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoints();this.drawText_(t,0,t.length,2)}}}setContextFillState_(e){const t=this.context_,i=this.contextFillState_;i?i.fillStyle!=e.fillStyle&&(i.fillStyle=e.fillStyle,t.fillStyle=e.fillStyle):(t.fillStyle=e.fillStyle,this.contextFillState_={fillStyle:e.fillStyle})}setContextStrokeState_(e){const t=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=e.lineCap&&(i.lineCap=e.lineCap,t.lineCap=e.lineCap),Za(i.lineDash,e.lineDash)||t.setLineDash(i.lineDash=e.lineDash),i.lineDashOffset!=e.lineDashOffset&&(i.lineDashOffset=e.lineDashOffset,t.lineDashOffset=e.lineDashOffset),i.lineJoin!=e.lineJoin&&(i.lineJoin=e.lineJoin,t.lineJoin=e.lineJoin),i.lineWidth!=e.lineWidth&&(i.lineWidth=e.lineWidth,t.lineWidth=e.lineWidth),i.miterLimit!=e.miterLimit&&(i.miterLimit=e.miterLimit,t.miterLimit=e.miterLimit),i.strokeStyle!=e.strokeStyle&&(i.strokeStyle=e.strokeStyle,t.strokeStyle=e.strokeStyle)):(t.lineCap=e.lineCap,t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset,t.lineJoin=e.lineJoin,t.lineWidth=e.lineWidth,t.miterLimit=e.miterLimit,t.strokeStyle=e.strokeStyle,this.contextStrokeState_={lineCap:e.lineCap,lineDash:e.lineDash,lineDashOffset:e.lineDashOffset,lineJoin:e.lineJoin,lineWidth:e.lineWidth,miterLimit:e.miterLimit,strokeStyle:e.strokeStyle})}setContextTextState_(e){const t=this.context_,i=this.contextTextState_,r=e.textAlign?e.textAlign:Xf;i?(i.font!=e.font&&(i.font=e.font,t.font=e.font),i.textAlign!=r&&(i.textAlign=r,t.textAlign=r),i.textBaseline!=e.textBaseline&&(i.textBaseline=e.textBaseline,t.textBaseline=e.textBaseline)):(t.font=e.font,t.textAlign=r,t.textBaseline=e.textBaseline,this.contextTextState_={font:e.font,textAlign:r,textBaseline:e.textBaseline})}setFillStrokeStyle(e,t){if(!e)this.fillState_=null;else{const i=e.getColor();this.fillState_={fillStyle:Rs(i||ki)}}if(!t)this.strokeState_=null;else{const i=t.getColor(),r=t.getLineCap(),s=t.getLineDash(),o=t.getLineDashOffset(),a=t.getLineJoin(),c=t.getWidth(),h=t.getMiterLimit(),d=s||mo;this.strokeState_={lineCap:r!==void 0?r:vh,lineDash:this.pixelRatio_===1?d:d.map(g=>g*this.pixelRatio_),lineDashOffset:(o||po)*this.pixelRatio_,lineJoin:a!==void 0?a:Eh,lineWidth:(c!==void 0?c:Qf)*this.pixelRatio_,miterLimit:h!==void 0?h:qf,strokeStyle:Rs(i||Yf)}}}setImageStyle(e){let t;if(!e||!(t=e.getSize())){this.image_=null;return}const i=e.getPixelRatio(this.pixelRatio_),r=e.getAnchor(),s=e.getOrigin();this.image_=e.getImage(this.pixelRatio_),this.imageAnchorX_=r[0]*i,this.imageAnchorY_=r[1]*i,this.imageHeight_=t[1]*i,this.imageOpacity_=e.getOpacity(),this.imageOriginX_=s[0],this.imageOriginY_=s[1],this.imageRotateWithView_=e.getRotateWithView(),this.imageRotation_=e.getRotation();const o=e.getScaleArray();this.imageScale_=[o[0]*this.pixelRatio_/i,o[1]*this.pixelRatio_/i],this.imageWidth_=t[0]*i}setTextStyle(e){if(!e)this.text_="";else{const t=e.getFill();if(!t)this.textFillState_=null;else{const y=t.getColor();this.textFillState_={fillStyle:Rs(y||ki)}}const i=e.getStroke();if(!i)this.textStrokeState_=null;else{const y=i.getColor(),w=i.getLineCap(),T=i.getLineDash(),E=i.getLineDashOffset(),P=i.getLineJoin(),M=i.getWidth(),N=i.getMiterLimit();this.textStrokeState_={lineCap:w!==void 0?w:vh,lineDash:T||mo,lineDashOffset:E||po,lineJoin:P!==void 0?P:Eh,lineWidth:M!==void 0?M:Qf,miterLimit:N!==void 0?N:qf,strokeStyle:Rs(y||Yf)}}const r=e.getFont(),s=e.getOffsetX(),o=e.getOffsetY(),a=e.getRotateWithView(),c=e.getRotation(),h=e.getScaleArray(),d=e.getText(),g=e.getTextAlign(),m=e.getTextBaseline();this.textState_={font:r!==void 0?r:n4,textAlign:g!==void 0?g:Xf,textBaseline:m!==void 0?m:L0},this.text_=d!==void 0?Array.isArray(d)?d.reduce((y,w,T)=>y+=T%2?" ":w,""):d:"",this.textOffsetX_=s!==void 0?this.pixelRatio_*s:0,this.textOffsetY_=o!==void 0?this.pixelRatio_*o:0,this.textRotateWithView_=a!==void 0?a:!1,this.textRotation_=c!==void 0?c:0,this.textScale_=[this.pixelRatio_*h[0],this.pixelRatio_*h[1]]}}}const w8=.5,s4={Point:C8,LineString:R8,Polygon:b8,MultiPoint:M8,MultiLineString:P8,MultiPolygon:A8,GeometryCollection:T8,Circle:S8};function x8(n,e){return parseInt(ut(n),10)-parseInt(ut(e),10)}function NR(n,e){const t=o4(n,e);return t*t}function o4(n,e){return w8*n/e}function S8(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(s||o){const c=n.getBuilder(t.getZIndex(),"Circle");c.setFillStrokeStyle(s,o),c.drawCircle(e,i,r)}const a=t.getText();if(a&&a.getText()){const c=n.getBuilder(t.getZIndex(),"Text");c.setTextStyle(a),c.drawText(e,i)}}function OR(n,e,t,i,r,s,o,a){const c=[],h=t.getImage();if(h){let m=!0;const y=h.getImageState();y==Ke.LOADED||y==Ke.ERROR?m=!1:y==Ke.IDLE&&h.load(),m&&c.push(h.ready())}const d=t.getFill();d&&d.loading()&&c.push(d.ready());const g=c.length>0;return g&&Promise.all(c).then(()=>r(null)),I8(n,e,t,i,s,o,a),g}function I8(n,e,t,i,r,s,o){const a=t.getGeometryFunction()(e);if(!a)return;const c=a.simplifyTransformed(i,r);if(t.getRenderer())a4(n,c,t,e,o);else{const d=s4[c.getType()];d(n,c,t,e,o,s)}}function a4(n,e,t,i,r){if(e.getType()=="GeometryCollection"){const o=e.getGeometries();for(let a=0,c=o.length;a<c;++a)a4(n,o[a],t,i,r);return}n.getBuilder(t.getZIndex(),"Default").drawCustom(e,i,t.getRenderer(),t.getHitDetectionRenderer(),r)}function T8(n,e,t,i,r,s){const o=e.getGeometriesArray();let a,c;for(a=0,c=o.length;a<c;++a){const h=s4[o[a].getType()];h(n,o[a],t,i,r,s)}}function R8(n,e,t,i,r){const s=t.getStroke();if(s){const a=n.getBuilder(t.getZIndex(),"LineString");a.setFillStrokeStyle(null,s),a.drawLineString(e,i,r)}const o=t.getText();if(o&&o.getText()){const a=n.getBuilder(t.getZIndex(),"Text");a.setTextStyle(o),a.drawText(e,i,r)}}function P8(n,e,t,i,r){const s=t.getStroke();if(s){const a=n.getBuilder(t.getZIndex(),"LineString");a.setFillStrokeStyle(null,s),a.drawMultiLineString(e,i,r)}const o=t.getText();if(o&&o.getText()){const a=n.getBuilder(t.getZIndex(),"Text");a.setTextStyle(o),a.drawText(e,i,r)}}function A8(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(o||s){const c=n.getBuilder(t.getZIndex(),"Polygon");c.setFillStrokeStyle(s,o),c.drawMultiPolygon(e,i,r)}const a=t.getText();if(a&&a.getText()){const c=n.getBuilder(t.getZIndex(),"Text");c.setTextStyle(a),c.drawText(e,i,r)}}function C8(n,e,t,i,r,s){const o=t.getImage(),a=t.getText(),c=a&&a.getText(),h=s&&o&&c?{}:void 0;if(o){if(o.getImageState()!=Ke.LOADED)return;const d=n.getBuilder(t.getZIndex(),"Image");d.setImageStyle(o,h),d.drawPoint(e,i,r)}if(c){const d=n.getBuilder(t.getZIndex(),"Text");d.setTextStyle(a,h),d.drawText(e,i,r)}}function M8(n,e,t,i,r,s){const o=t.getImage(),a=o&&o.getOpacity()!==0,c=t.getText(),h=c&&c.getText(),d=s&&a&&h?{}:void 0;if(a){if(o.getImageState()!=Ke.LOADED)return;const g=n.getBuilder(t.getZIndex(),"Image");g.setImageStyle(o,d),g.drawMultiPoint(e,i,r)}if(h){const g=n.getBuilder(t.getZIndex(),"Text");g.setTextStyle(c,d),g.drawText(e,i,r)}}function b8(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(s||o){const c=n.getBuilder(t.getZIndex(),"Polygon");c.setFillStrokeStyle(s,o),c.drawPolygon(e,i,r)}const a=t.getText();if(a&&a.getText()){const c=n.getBuilder(t.getZIndex(),"Text");c.setTextStyle(a),c.drawText(e,i,r)}}let k8=!1;function L8(n,e,t,i,r,s,o){const a=new XMLHttpRequest;a.open("GET",typeof n=="function"?n(t,i,r):n,!0),e.getType()=="arraybuffer"&&(a.responseType="arraybuffer"),a.withCredentials=k8,a.onload=function(c){if(!a.status||a.status>=200&&a.status<300){const h=e.getType();try{let d;h=="text"||h=="json"?d=a.responseText:h=="xml"?d=a.responseXML||a.responseText:h=="arraybuffer"&&(d=a.response),d?s(e.readFeatures(d,{extent:t,featureProjection:r}),e.readProjection(d)):o()}catch{o()}}else o()},a.onerror=o,a.send()}function DR(n,e){return function(t,i,r,s,o){L8(n,e,t,i,r,(a,c)=>{this.addFeatures(a),s!==void 0&&s(a)},()=>{this.changed(),o!==void 0&&o()})}}function N8(n,e){return[[-1/0,-1/0,1/0,1/0]]}function l4(n,e,t,i){const r=[];let s=ir();for(let o=0,a=t.length;o<a;++o){const c=t[o];s=lx(n,e,c[0],i),r.push((s[0]+s[2])/2,(s[1]+s[3])/2),e=c[c.length-1]}return r}function Ax(n,e,t,i,r,s,o){let a,c,h,d,g,m,y;const w=r[s+1],T=[];for(let M=0,N=t.length;M<N;++M){const D=t[M];for(d=n[D-i],m=n[D-i+1],a=e;a<D;a+=i)g=n[a],y=n[a+1],(w<=m&&y<=w||m<=w&&w<=y)&&(h=(w-m)/(y-m)*(g-d)+d,T.push(h)),d=g,m=y}let E=NaN,P=-1/0;for(T.sort(go),d=T[0],a=1,c=T.length;a<c;++a){g=T[a];const M=Math.abs(g-d);M>P&&(h=(d+g)/2,Ex(n,e,t,i,h,w)&&(E=h,P=M)),d=g}return isNaN(E)&&(E=r[s]),o?(o.push(E,w,P),o):[E,w,P]}function c4(n,e,t,i,r){let s=[];for(let o=0,a=t.length;o<a;++o){const c=t[o];s=Ax(n,e,c,i,r,2*o,s),e=c[c.length-1]}return s}function O8(n,e,t,i){for(;e<t-i;){for(let r=0;r<i;++r){const s=n[e+r];n[e+r]=n[t-i+r],n[t-i+r]=s}e+=i,t-=i}}function Cx(n,e,t,i){let r=0,s=n[t-i],o=n[t-i+1];for(;e<t;e+=i){const a=n[e],c=n[e+1];r+=(a-s)*(c+o),s=a,o=c}return r===0?void 0:r>0}function Mx(n,e,t,i,r){r=r!==void 0?r:!1;for(let s=0,o=t.length;s<o;++s){const a=t[s],c=Cx(n,e,a,i);if(s===0){if(r&&c||!r&&!c)return!1}else if(r&&!c||!r&&c)return!1;e=a}return!0}function u4(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const a=t[s];if(!Mx(n,e,a,i,r))return!1;a.length&&(e=a[a.length-1])}return!0}function N0(n,e,t,i,r){r=r!==void 0?r:!1;for(let s=0,o=t.length;s<o;++s){const a=t[s],c=Cx(n,e,a,i);(s===0?r&&c||!r&&!c:r&&!c||!r&&c)&&O8(n,e,a,i),e=a}return e}function VE(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s)e=N0(n,e,t[s],i,r);return e}function D8(n,e){const t=[];let i=0,r=0,s;for(let o=0,a=e.length;o<a;++o){const c=e[o],h=Cx(n,i,c,2);if(s===void 0&&(s=h),h===s)t.push(e.slice(r,o+1));else{if(t.length===0)continue;t[t.length-1].push(e[r])}r=o+1,i=c}return t}class O0 extends Ub{constructor(e){super(),this.geometries_=e,this.changeEventsKeys_=[],this.listenGeometriesChange_()}unlistenGeometriesChange_(){this.changeEventsKeys_.forEach(Ot),this.changeEventsKeys_.length=0}listenGeometriesChange_(){const e=this.geometries_;for(let t=0,i=e.length;t<i;++t)this.changeEventsKeys_.push(lt(e[t],Qe.CHANGE,this.changed,this))}clone(){const e=new O0(x1(this.geometries_));return e.applyProperties(this),e}closestPointXY(e,t,i,r){if(r<Pc(this.getExtent(),e,t))return r;const s=this.geometries_;for(let o=0,a=s.length;o<a;++o)r=s[o].closestPointXY(e,t,i,r);return r}containsXY(e,t){const i=this.geometries_;for(let r=0,s=i.length;r<s;++r)if(i[r].containsXY(e,t))return!0;return!1}computeExtent(e){Ng(e);const t=this.geometries_;for(let i=0,r=t.length;i<r;++i)xb(e,t[i].getExtent());return e}getGeometries(){return x1(this.geometries_)}getGeometriesArray(){return this.geometries_}getGeometriesArrayRecursive(){let e=[];const t=this.geometries_;for(let i=0,r=t.length;i<r;++i)t[i].getType()===this.getType()?e=e.concat(t[i].getGeometriesArrayRecursive()):e.push(t[i]);return e}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<this.simplifiedGeometryMaxMinSquaredTolerance)return this;const t=[],i=this.geometries_;let r=!1;for(let s=0,o=i.length;s<o;++s){const a=i[s],c=a.getSimplifiedGeometry(e);t.push(c),c!==a&&(r=!0)}return r?new O0(t):(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getType(){return"GeometryCollection"}intersectsExtent(e){const t=this.geometries_;for(let i=0,r=t.length;i<r;++i)if(t[i].intersectsExtent(e))return!0;return!1}isEmpty(){return this.geometries_.length===0}rotate(e,t){const i=this.geometries_;for(let r=0,s=i.length;r<s;++r)i[r].rotate(e,t);this.changed()}scale(e,t,i){i||(i=ja(this.getExtent()));const r=this.geometries_;for(let s=0,o=r.length;s<o;++s)r[s].scale(e,t,i);this.changed()}setGeometries(e){this.setGeometriesArray(x1(e))}setGeometriesArray(e){this.unlistenGeometriesChange_(),this.geometries_=e,this.listenGeometriesChange_(),this.changed()}applyTransform(e){const t=this.geometries_;for(let i=0,r=t.length;i<r;++i)t[i].applyTransform(e);this.changed()}translate(e,t){const i=this.geometries_;for(let r=0,s=i.length;r<s;++r)i[r].translate(e,t);this.changed()}disposeInternal(){this.unlistenGeometriesChange_(),super.disposeInternal()}}function x1(n){return n.map(e=>e.clone())}function h4(n,e,t,i){let r=0;const s=n[t-i],o=n[t-i+1];let a=0,c=0;for(;e<t;e+=i){const h=n[e]-s,d=n[e+1]-o;r+=c*h-a*d,a=h,c=d}return r/2}function d4(n,e,t,i){let r=0;for(let s=0,o=t.length;s<o;++s){const a=t[s];r+=h4(n,e,a,i),e=a}return r}function V8(n,e,t,i){let r=0;for(let s=0,o=t.length;s<o;++s){const a=t[s];r+=d4(n,e,a,i),e=a[a.length-1]}return r}class Zf extends Cc{constructor(e,t){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,t!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}clone(){return new Zf(this.flatCoordinates.slice(),this.layout)}closestPointXY(e,t,i,r){return r<Pc(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(px(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),yx(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,e,t,i,r))}getArea(){return h4(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return Ia(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(e){const t=[];return t.length=W_(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new Zf(t,"XY")}getType(){return"LinearRing"}intersectsExtent(e){return!1}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=z_(this.flatCoordinates,0,e,this.stride),this.changed()}}class D0 extends Cc{constructor(e,t,i){if(super(),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(e[0]))this.setCoordinates(e,t);else if(t!==void 0&&i)this.setFlatCoordinates(t,e),this.ends_=i;else{const r=e,s=[],o=[];for(let c=0,h=r.length;c<h;++c){const d=r[c];Cs(s,d.getFlatCoordinates()),o.push(s.length)}const a=r.length===0?this.getLayout():r[0].getLayout();this.setFlatCoordinates(a,s),this.ends_=o}}appendLineString(e){Cs(this.flatCoordinates,e.getFlatCoordinates().slice()),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new D0(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,t,i,r){return r<Pc(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(_x(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),vx(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,e,t,i,r))}getCoordinateAtM(e,t,i){return this.layout!="XYM"&&this.layout!="XYZM"||this.flatCoordinates.length===0?null:(t=t!==void 0?t:!1,i=i!==void 0?i:!1,U6(this.flatCoordinates,0,this.ends_,this.stride,e,t,i))}getCoordinates(){return Kf(this.flatCoordinates,0,this.ends_,this.stride)}getEnds(){return this.ends_}getLineString(e){return e<0||this.ends_.length<=e?null:new lc(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLineStrings(){const e=this.flatCoordinates,t=this.ends_,i=this.layout,r=[];let s=0;for(let o=0,a=t.length;o<a;++o){const c=t[o],h=new lc(e.slice(s,c),i);r.push(h),s=c}return r}getLength(){const e=this.ends_;let t=0,i=0;for(let r=0,s=e.length;r<s;++r)i+=wx(this.flatCoordinates,t,e[r],this.stride),t=e[r];return i}getFlatMidpoints(){const e=[],t=this.flatCoordinates;let i=0;const r=this.ends_,s=this.stride;for(let o=0,a=r.length;o<a;++o){const c=r[o],h=M0(t,i,c,s,.5);Cs(e,h),i=c}return e}getSimplifiedGeometryInternal(e){const t=[],i=[];return t.length=Hb(this.flatCoordinates,0,this.ends_,this.stride,e,t,0,i),new D0(t,"XY",i)}getType(){return"MultiLineString"}intersectsExtent(e){return $6(this.flatCoordinates,0,this.ends_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=Fg(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1],this.changed()}}class K_ extends Cc{constructor(e,t){super(),t&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}appendPoint(e){Cs(this.flatCoordinates,e.getFlatCoordinates()),this.changed()}clone(){const e=new K_(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,i,r){if(r<Pc(this.getExtent(),e,t))return r;const s=this.flatCoordinates,o=this.stride;for(let a=0,c=s.length;a<c;a+=o){const h=Jl(e,t,s[a],s[a+1]);if(h<r){r=h;for(let d=0;d<o;++d)i[d]=s[a+d];i.length=o}}return r}getCoordinates(){return Ia(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getPoint(e){const t=this.flatCoordinates.length/this.stride;return e<0||t<=e?null:new cc(this.flatCoordinates.slice(e*this.stride,(e+1)*this.stride),this.layout)}getPoints(){const e=this.flatCoordinates,t=this.layout,i=this.stride,r=[];for(let s=0,o=e.length;s<o;s+=i){const a=new cc(e.slice(s,s+i),t);r.push(a)}return r}getType(){return"MultiPoint"}intersectsExtent(e){const t=this.flatCoordinates,i=this.stride;for(let r=0,s=t.length;r<s;r+=i){const o=t[r],a=t[r+1];if(ax(e,o,a))return!0}return!1}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=z_(this.flatCoordinates,0,e,this.stride),this.changed()}}class Ua extends Cc{constructor(e,t,i){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,t!==void 0&&i?(this.setFlatCoordinates(t,e),this.ends_=i):this.setCoordinates(e,t)}appendLinearRing(e){this.flatCoordinates?Cs(this.flatCoordinates,e.getFlatCoordinates()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new Ua(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,t,i,r){return r<Pc(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(_x(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),vx(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,e,t,i,r))}containsXY(e,t){return Ex(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,t)}getArea(){return d4(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(e){let t;return e!==void 0?(t=this.getOrientedFlatCoordinates().slice(),N0(t,0,this.ends_,this.stride,e)):t=this.flatCoordinates,Kf(t,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const e=ja(this.getExtent());this.flatInteriorPoint_=Ax(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new cc(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(e){return e<0||this.ends_.length<=e?null:new Zf(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLinearRings(){const e=this.layout,t=this.flatCoordinates,i=this.ends_,r=[];let s=0;for(let o=0,a=i.length;o<a;++o){const c=i[o],h=new Zf(t.slice(s,c),e);r.push(h),s=c}return r}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;Mx(e,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=N0(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const t=[],i=[];return t.length=xx(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(e),t,0,i),new Ua(t,"XY",i)}getType(){return"Polygon"}intersectsExtent(e){return Wb(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=Fg(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1],this.changed()}}function VR(n){if(j_(n))throw new Error("Cannot create polygon from empty extent");const e=n[0],t=n[1],i=n[2],r=n[3],s=[e,t,e,r,i,r,i,t,e,t];return new Ua(s,"XY",[s.length])}class V0 extends Cc{constructor(e,t,i){if(super(),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!i&&!Array.isArray(e[0])){const r=e,s=[],o=[];for(let a=0,c=r.length;a<c;++a){const h=r[a],d=s.length,g=h.getEnds();for(let m=0,y=g.length;m<y;++m)g[m]+=d;Cs(s,h.getFlatCoordinates()),o.push(g)}t=r.length===0?this.getLayout():r[0].getLayout(),e=s,i=o}t!==void 0&&i?(this.setFlatCoordinates(t,e),this.endss_=i):this.setCoordinates(e,t)}appendPolygon(e){let t;if(!this.flatCoordinates)this.flatCoordinates=e.getFlatCoordinates().slice(),t=e.getEnds().slice(),this.endss_.push();else{const i=this.flatCoordinates.length;Cs(this.flatCoordinates,e.getFlatCoordinates()),t=e.getEnds().slice();for(let r=0,s=t.length;r<s;++r)t[r]+=i}this.endss_.push(t),this.changed()}clone(){const e=this.endss_.length,t=new Array(e);for(let r=0;r<e;++r)t[r]=this.endss_[r].slice();const i=new V0(this.flatCoordinates.slice(),this.layout,t);return i.applyProperties(this),i}closestPointXY(e,t,i,r){return r<Pc(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(F6(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),G6(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,e,t,i,r))}containsXY(e,t){return z6(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e,t)}getArea(){return V8(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}getCoordinates(e){let t;return e!==void 0?(t=this.getOrientedFlatCoordinates().slice(),VE(t,0,this.endss_,this.stride,e)):t=this.flatCoordinates,kE(t,0,this.endss_,this.stride)}getEndss(){return this.endss_}getFlatInteriorPoints(){if(this.flatInteriorPointsRevision_!=this.getRevision()){const e=l4(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=c4(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}getInteriorPoints(){return new K_(this.getFlatInteriorPoints().slice(),"XYM")}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;u4(e,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=VE(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const t=[],i=[];return t.length=K6(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(e),t,0,i),new V0(t,"XY",i)}getPolygon(e){if(e<0||this.endss_.length<=e)return null;let t;if(e===0)t=0;else{const s=this.endss_[e-1];t=s[s.length-1]}const i=this.endss_[e].slice(),r=i[i.length-1];if(t!==0)for(let s=0,o=i.length;s<o;++s)i[s]-=t;return new Ua(this.flatCoordinates.slice(t,r),this.layout,i)}getPolygons(){const e=this.layout,t=this.flatCoordinates,i=this.endss_,r=[];let s=0;for(let o=0,a=i.length;o<a;++o){const c=i[o].slice(),h=c[c.length-1];if(s!==0)for(let g=0,m=c.length;g<m;++g)c[g]-=s;const d=new Ua(t.slice(s,h),e,c);r.push(d),s=h}return r}getType(){return"MultiPolygon"}intersectsExtent(e){return W6(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,3),this.flatCoordinates||(this.flatCoordinates=[]);const i=Bb(this.flatCoordinates,0,e,this.stride,this.endss_);if(i.length===0)this.flatCoordinates.length=0;else{const r=i[i.length-1];this.flatCoordinates.length=r.length===0?0:r[r.length-1]}this.changed()}}const FR=Zr();class Ji{constructor(e,t,i,r,s,o){this.styleFunction,this.extent_,this.id_=o,this.type_=e,this.flatCoordinates_=t,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=i||null,this.properties_=s,this.squaredTolerance_,this.stride_=r,this.simplifiedGeometry_}get(e){return this.properties_[e]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?wb(this.flatCoordinates_):lx(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const e=ja(this.getExtent());this.flatInteriorPoints_=Ax(this.flatCoordinates_,0,this.ends_,2,e,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const e=D8(this.flatCoordinates_,this.ends_),t=l4(this.flatCoordinates_,0,e,2);this.flatInteriorPoints_=c4(this.flatCoordinates_,0,e,2,t)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=M0(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const e=this.flatCoordinates_;let t=0;const i=this.ends_;for(let r=0,s=i.length;r<s;++r){const o=i[r],a=M0(e,t,o,2,.5);Cs(this.flatMidpoints_,a),t=o}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(e){return this}simplifyTransformed(e,t){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(e){e=Vt(e);const t=e.getExtent(),i=e.getWorldExtent();if(t&&i){const r=oi(i)/oi(t);Eo(FR,i[0],i[3],r,-r,0,0,0),ba(this.flatCoordinates_,0,this.flatCoordinates_.length,2,FR,this.flatCoordinates_)}}applyTransform(e){e(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){return new Ji(this.type_,this.flatCoordinates_.slice(),this.ends_?.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=_b((e,t)=>{if(e===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),t&&this.simplifiedGeometry_.applyTransform(t);const i=this.simplifiedGeometry_.getFlatCoordinates();let r;switch(this.type_){case"LineString":i.length=W_(i,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,e,i,0),r=[i.length];break;case"MultiLineString":r=[],i.length=Hb(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,e,i,0,r);break;case"Polygon":r=[],i.length=xx(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(e),i,0,r);break}return r&&(this.simplifiedGeometry_=new Ji(this.type_,i,r,2,this.properties_,this.id_)),this.squaredTolerance_=e,this.simplifiedGeometry_}),this}}Ji.prototype.getFlatCoordinates=Ji.prototype.getOrientedFlatCoordinates;function f4(n,e,t=0,i=n.length-1,r=F8){for(;i>t;){if(i-t>600){const c=i-t+1,h=e-t+1,d=Math.log(c),g=.5*Math.exp(2*d/3),m=.5*Math.sqrt(d*g*(c-g)/c)*(h-c/2<0?-1:1),y=Math.max(t,Math.floor(e-h*g/c+m)),w=Math.min(i,Math.floor(e+(c-h)*g/c+m));f4(n,e,y,w,r)}const s=n[e];let o=t,a=i;for(zd(n,t,e),r(n[i],s)>0&&zd(n,t,i);o<a;){for(zd(n,o,a),o++,a--;r(n[o],s)<0;)o++;for(;r(n[a],s)>0;)a--}r(n[t],s)===0?zd(n,t,a):(a++,zd(n,a,i)),a<=e&&(t=a+1),e<=a&&(i=a-1)}}function zd(n,e,t){const i=n[e];n[e]=n[t],n[t]=i}function F8(n,e){return n<e?-1:n>e?1:0}let g4=class{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let t=this.data;const i=[];if(!Mp(e,t))return i;const r=this.toBBox,s=[];for(;t;){for(let o=0;o<t.children.length;o++){const a=t.children[o],c=t.leaf?r(a):a;Mp(e,c)&&(t.leaf?i.push(a):I1(e,c)?this._all(a,i):s.push(a))}t=s.pop()}return i}collides(e){let t=this.data;if(!Mp(e,t))return!1;const i=[];for(;t;){for(let r=0;r<t.children.length;r++){const s=t.children[r],o=t.leaf?this.toBBox(s):s;if(Mp(e,o)){if(t.leaf||I1(e,o))return!0;i.push(s)}}t=i.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let i=0;i<e.length;i++)this.insert(e[i]);return this}let t=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=t;else if(this.data.height===t.height)this._splitRoot(this.data,t);else{if(this.data.height<t.height){const i=this.data;this.data=t,t=i}this._insert(t,this.data.height-t.height-1,!0)}return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=Ou([]),this}remove(e,t){if(!e)return this;let i=this.data;const r=this.toBBox(e),s=[],o=[];let a,c,h;for(;i||s.length;){if(i||(i=s.pop(),c=s[s.length-1],a=o.pop(),h=!0),i.leaf){const d=G8(e,i.children,t);if(d!==-1)return i.children.splice(d,1),s.push(i),this._condense(s),this}!h&&!i.leaf&&I1(i,r)?(s.push(i),o.push(a),a=0,c=i,i=i.children[0]):c?(a++,i=c.children[a],h=!1):i=null}return this}toBBox(e){return e}compareMinX(e,t){return e.minX-t.minX}compareMinY(e,t){return e.minY-t.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,t){const i=[];for(;e;)e.leaf?t.push(...e.children):i.push(...e.children),e=i.pop();return t}_build(e,t,i,r){const s=i-t+1;let o=this._maxEntries,a;if(s<=o)return a=Ou(e.slice(t,i+1)),xu(a,this.toBBox),a;r||(r=Math.ceil(Math.log(s)/Math.log(o)),o=Math.ceil(s/Math.pow(o,r-1))),a=Ou([]),a.leaf=!1,a.height=r;const c=Math.ceil(s/o),h=c*Math.ceil(Math.sqrt(o));GR(e,t,i,h,this.compareMinX);for(let d=t;d<=i;d+=h){const g=Math.min(d+h-1,i);GR(e,d,g,c,this.compareMinY);for(let m=d;m<=g;m+=c){const y=Math.min(m+c-1,g);a.children.push(this._build(e,m,y,r-1))}}return xu(a,this.toBBox),a}_chooseSubtree(e,t,i,r){for(;r.push(t),!(t.leaf||r.length-1===i);){let s=1/0,o=1/0,a;for(let c=0;c<t.children.length;c++){const h=t.children[c],d=S1(h),g=B8(e,h)-d;g<o?(o=g,s=d<s?d:s,a=h):g===o&&d<s&&(s=d,a=h)}t=a||t.children[0]}return t}_insert(e,t,i){const r=i?e:this.toBBox(e),s=[],o=this._chooseSubtree(r,this.data,t,s);for(o.children.push(e),nf(o,r);t>=0&&s[t].children.length>this._maxEntries;)this._split(s,t),t--;this._adjustParentBBoxes(r,s,t)}_split(e,t){const i=e[t],r=i.children.length,s=this._minEntries;this._chooseSplitAxis(i,s,r);const o=this._chooseSplitIndex(i,s,r),a=Ou(i.children.splice(o,i.children.length-o));a.height=i.height,a.leaf=i.leaf,xu(i,this.toBBox),xu(a,this.toBBox),t?e[t-1].children.push(a):this._splitRoot(i,a)}_splitRoot(e,t){this.data=Ou([e,t]),this.data.height=e.height+1,this.data.leaf=!1,xu(this.data,this.toBBox)}_chooseSplitIndex(e,t,i){let r,s=1/0,o=1/0;for(let a=t;a<=i-t;a++){const c=tf(e,0,a,this.toBBox),h=tf(e,a,i,this.toBBox),d=z8(c,h),g=S1(c)+S1(h);d<s?(s=d,r=a,o=g<o?g:o):d===s&&g<o&&(o=g,r=a)}return r||i-t}_chooseSplitAxis(e,t,i){const r=e.leaf?this.compareMinX:j8,s=e.leaf?this.compareMinY:U8,o=this._allDistMargin(e,t,i,r),a=this._allDistMargin(e,t,i,s);o<a&&e.children.sort(r)}_allDistMargin(e,t,i,r){e.children.sort(r);const s=this.toBBox,o=tf(e,0,t,s),a=tf(e,i-t,i,s);let c=Cp(o)+Cp(a);for(let h=t;h<i-t;h++){const d=e.children[h];nf(o,e.leaf?s(d):d),c+=Cp(o)}for(let h=i-t-1;h>=t;h--){const d=e.children[h];nf(a,e.leaf?s(d):d),c+=Cp(a)}return c}_adjustParentBBoxes(e,t,i){for(let r=i;r>=0;r--)nf(t[r],e)}_condense(e){for(let t=e.length-1,i;t>=0;t--)e[t].children.length===0?t>0?(i=e[t-1].children,i.splice(i.indexOf(e[t]),1)):this.clear():xu(e[t],this.toBBox)}};function G8(n,e,t){if(!t)return e.indexOf(n);for(let i=0;i<e.length;i++)if(t(n,e[i]))return i;return-1}function xu(n,e){tf(n,0,n.children.length,e,n)}function tf(n,e,t,i,r){r||(r=Ou(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(let s=e;s<t;s++){const o=n.children[s];nf(r,n.leaf?i(o):o)}return r}function nf(n,e){return n.minX=Math.min(n.minX,e.minX),n.minY=Math.min(n.minY,e.minY),n.maxX=Math.max(n.maxX,e.maxX),n.maxY=Math.max(n.maxY,e.maxY),n}function j8(n,e){return n.minX-e.minX}function U8(n,e){return n.minY-e.minY}function S1(n){return(n.maxX-n.minX)*(n.maxY-n.minY)}function Cp(n){return n.maxX-n.minX+(n.maxY-n.minY)}function B8(n,e){return(Math.max(e.maxX,n.maxX)-Math.min(e.minX,n.minX))*(Math.max(e.maxY,n.maxY)-Math.min(e.minY,n.minY))}function z8(n,e){const t=Math.max(n.minX,e.minX),i=Math.max(n.minY,e.minY),r=Math.min(n.maxX,e.maxX),s=Math.min(n.maxY,e.maxY);return Math.max(0,r-t)*Math.max(0,s-i)}function I1(n,e){return n.minX<=e.minX&&n.minY<=e.minY&&e.maxX<=n.maxX&&e.maxY<=n.maxY}function Mp(n,e){return e.minX<=n.maxX&&e.minY<=n.maxY&&e.maxX>=n.minX&&e.maxY>=n.minY}function Ou(n){return{children:n,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function GR(n,e,t,i,r){const s=[e,t];for(;s.length;){if(t=s.pop(),e=s.pop(),t-e<=i)continue;const o=e+Math.ceil((t-e)/i/2)*i;f4(n,o,e,t,r),s.push(e,o,o,t)}}class jR{constructor(e){this.rbush_=new g4(e),this.items_={}}insert(e,t){const i={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:t};this.rbush_.insert(i),this.items_[ut(t)]=i}load(e,t){const i=new Array(t.length);for(let r=0,s=t.length;r<s;r++){const o=e[r],a=t[r],c={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:a};i[r]=c,this.items_[ut(a)]=c}this.rbush_.load(i)}remove(e){const t=ut(e),i=this.items_[t];return delete this.items_[t],this.rbush_.remove(i)!==null}update(e,t){const i=this.items_[ut(t)],r=[i.minX,i.minY,i.maxX,i.maxY];Wf(r,e)||(this.remove(t),this.insert(e,t))}getAll(){return this.rbush_.all().map(function(t){return t.value})}getInExtent(e){const t={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]};return this.rbush_.search(t).map(function(r){return r.value})}forEach(e){return this.forEach_(this.getAll(),e)}forEachInExtent(e,t){return this.forEach_(this.getInExtent(e),t)}forEach_(e,t){let i;for(let r=0,s=e.length;r<s;r++)if(i=t(e[r]),i)return i;return i}isEmpty(){return sc(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(e){const t=this.rbush_.toJSON();return Ga(t.minX,t.minY,t.maxX,t.maxY,e)}concat(e){this.rbush_.load(e.rbush_.all());for(const t in e.items_)this.items_[t]=e.items_[t]}}class m4 extends js{constructor(e){super(),this.projection=Vt(e.projection),this.attributions_=UR(e.attributions),this.attributionsCollapsible_=e.attributionsCollapsible??!0,this.loading=!1,this.state_=e.state!==void 0?e.state:"ready",this.wrapX_=e.wrapX!==void 0?e.wrapX:!1,this.interpolate_=!!e.interpolate,this.viewResolver=null,this.viewRejector=null;const t=this;this.viewPromise_=new Promise(function(i,r){t.viewResolver=i,t.viewRejector=r})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(e){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(e){this.attributions_=UR(e),this.changed()}setState(e){this.state_=e,this.changed()}}function UR(n){return n?typeof n=="function"?n:(Array.isArray(n)||(n=[n]),e=>n):null}const wr={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};class ra extends Ao{constructor(e,t,i){super(e),this.feature=t,this.features=i}}class bx extends m4{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:e.wrapX!==void 0?e.wrapX:!0}),this.on,this.once,this.un,this.loader_=zf,this.format_=e.format||null,this.overlaps_=e.overlaps===void 0?!0:e.overlaps,this.url_=e.url,e.loader!==void 0?this.loader_=e.loader:this.url_!==void 0&&(yt(this.format_,"`format` must be set when `url` is set"),this.loader_=DR(this.url_,this.format_)),this.strategy_=e.strategy!==void 0?e.strategy:N8;const t=e.useSpatialIndex!==void 0?e.useSpatialIndex:!0;this.featuresRtree_=t?new jR:null,this.loadedExtentsRtree_=new jR,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let i,r;Array.isArray(e.features)?r=e.features:e.features&&(i=e.features,r=i.getArray()),!t&&i===void 0&&(i=new Rr(r)),r!==void 0&&this.addFeaturesInternal(r),i!==void 0&&this.bindFeaturesCollection_(i)}addFeature(e){this.addFeatureInternal(e),this.changed()}addFeatureInternal(e){const t=ut(e);if(!this.addToIndex_(t,e)){this.featuresCollection_&&this.featuresCollection_.remove(e);return}this.setupChangeEvents_(t,e);const i=e.getGeometry();if(i){const r=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(r,e)}else this.nullGeometryFeatures_[t]=e;this.dispatchEvent(new ra(wr.ADDFEATURE,e))}setupChangeEvents_(e,t){t instanceof Ji||(this.featureChangeKeys_[e]=[lt(t,Qe.CHANGE,this.handleFeatureChange_,this),lt(t,fh.PROPERTYCHANGE,this.handleFeatureChange_,this)])}addToIndex_(e,t){let i=!0;if(t.getId()!==void 0){const r=String(t.getId());if(!(r in this.idIndex_))this.idIndex_[r]=t;else if(t instanceof Ji){const s=this.idIndex_[r];s instanceof Ji?Array.isArray(s)?s.push(t):this.idIndex_[r]=[s,t]:i=!1}else i=!1}return i&&(yt(!(e in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[e]=t),i}addFeatures(e){this.addFeaturesInternal(e),this.changed()}addFeaturesInternal(e){const t=[],i=[],r=[];for(let s=0,o=e.length;s<o;s++){const a=e[s],c=ut(a);this.addToIndex_(c,a)&&i.push(a)}for(let s=0,o=i.length;s<o;s++){const a=i[s],c=ut(a);this.setupChangeEvents_(c,a);const h=a.getGeometry();if(h){const d=h.getExtent();t.push(d),r.push(a)}else this.nullGeometryFeatures_[c]=a}if(this.featuresRtree_&&this.featuresRtree_.load(t,r),this.hasListener(wr.ADDFEATURE))for(let s=0,o=i.length;s<o;s++)this.dispatchEvent(new ra(wr.ADDFEATURE,i[s]))}bindFeaturesCollection_(e){let t=!1;this.addEventListener(wr.ADDFEATURE,function(i){t||(t=!0,e.push(i.feature),t=!1)}),this.addEventListener(wr.REMOVEFEATURE,function(i){t||(t=!0,e.remove(i.feature),t=!1)}),e.addEventListener(bi.ADD,i=>{t||(t=!0,this.addFeature(i.element),t=!1)}),e.addEventListener(bi.REMOVE,i=>{t||(t=!0,this.removeFeature(i.element),t=!1)}),this.featuresCollection_=e}clear(e){if(e){for(const i in this.featureChangeKeys_)this.featureChangeKeys_[i].forEach(Ot);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(i=>{this.removeFeatureInternal(i)});for(const i in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[i])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const t=new ra(wr.CLEAR);this.dispatchEvent(t),this.changed()}forEachFeature(e){if(this.featuresRtree_)return this.featuresRtree_.forEach(e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureAtCoordinateDirect(e,t){const i=[e[0],e[1],e[0],e[1]];return this.forEachFeatureInExtent(i,function(r){const s=r.getGeometry();if(s instanceof Ji||s.intersectsCoordinate(e))return t(r)})}forEachFeatureInExtent(e,t){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(e,t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureIntersectingExtent(e,t){return this.forEachFeatureInExtent(e,function(i){const r=i.getGeometry();if(r instanceof Ji||r.intersectsExtent(e)){const s=t(i);if(s)return s}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let e;return this.featuresCollection_?e=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(e=this.featuresRtree_.getAll(),sc(this.nullGeometryFeatures_)||Cs(e,Object.values(this.nullGeometryFeatures_))),e}getFeaturesAtCoordinate(e){const t=[];return this.forEachFeatureAtCoordinateDirect(e,function(i){t.push(i)}),t}getFeaturesInExtent(e,t){if(this.featuresRtree_){if(!(t&&t.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(e);const r=Pb(e,t);return[].concat(...r.map(s=>this.featuresRtree_.getInExtent(s)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(e,t){const i=e[0],r=e[1];let s=null;const o=[NaN,NaN];let a=1/0;const c=[-1/0,-1/0,1/0,1/0];return t=t||Bf,this.featuresRtree_.forEachInExtent(c,function(h){if(t(h)){const d=h.getGeometry(),g=a;if(a=d instanceof Ji?0:d.closestPointXY(i,r,o,a),a<g){s=h;const m=Math.sqrt(a);c[0]=i-m,c[1]=r-m,c[2]=i+m,c[3]=r+m}}}),s}getExtent(e){return this.featuresRtree_.getExtent(e)}getFeatureById(e){const t=this.idIndex_[e.toString()];return t!==void 0?t:null}getFeatureByUid(e){const t=this.uidIndex_[e];return t!==void 0?t:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(e){const t=e.target,i=ut(t),r=t.getGeometry();if(!r)i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(t),this.nullGeometryFeatures_[i]=t);else{const o=r.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(o,t)):this.featuresRtree_&&this.featuresRtree_.update(o,t)}const s=t.getId();if(s!==void 0){const o=s.toString();this.idIndex_[o]!==t&&(this.removeFromIdIndex_(t),this.idIndex_[o]=t)}else this.removeFromIdIndex_(t),this.uidIndex_[i]=t;this.changed(),this.dispatchEvent(new ra(wr.CHANGEFEATURE,t))}hasFeature(e){const t=e.getId();return t!==void 0?t in this.idIndex_:ut(e)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&sc(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(e,t,i){const r=this.loadedExtentsRtree_,s=this.strategy_(e,t,i);for(let o=0,a=s.length;o<a;++o){const c=s[o];r.forEachInExtent(c,function(d){return ef(d.extent,c)})||(++this.loadingExtentsCount_,this.dispatchEvent(new ra(wr.FEATURESLOADSTART)),this.loader_.call(this,c,t,i,d=>{--this.loadingExtentsCount_,this.dispatchEvent(new ra(wr.FEATURESLOADEND,void 0,d))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new ra(wr.FEATURESLOADERROR))}),r.insert(c,{extent:c.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(e){const t=this.loadedExtentsRtree_,i=t.forEachInExtent(e,function(r){if(Wf(r.extent,e))return r});i&&t.remove(i)}removeFeatures(e){let t=!1;for(let i=0,r=e.length;i<r;++i)t=this.removeFeatureInternal(e[i])||t;t&&this.changed()}removeFeature(e){if(!e)return;this.removeFeatureInternal(e)&&this.changed()}removeFeatureInternal(e){const t=ut(e);if(!(t in this.uidIndex_))return!1;t in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[t]:this.featuresRtree_&&this.featuresRtree_.remove(e),this.featureChangeKeys_[t]?.forEach(Ot),delete this.featureChangeKeys_[t];const r=e.getId();if(r!==void 0){const s=r.toString(),o=this.idIndex_[s];o===e?delete this.idIndex_[s]:Array.isArray(o)&&(o.splice(o.indexOf(e),1),o.length===1&&(this.idIndex_[s]=o[0]))}return delete this.uidIndex_[t],this.hasListener(wr.REMOVEFEATURE)&&this.dispatchEvent(new ra(wr.REMOVEFEATURE,e)),!0}removeFromIdIndex_(e){for(const t in this.idIndex_)if(this.idIndex_[t]===e){delete this.idIndex_[t];break}}setLoader(e){this.loader_=e}setUrl(e){yt(this.format_,"`format` must be set when `url` is set"),this.url_=e,this.setLoader(DR(e,this.format_))}setOverlaps(e){this.overlaps_=e,this.changed()}}class wo{constructor(e){e=e||{},this.patternImage_=null,this.color_=null,e.color!==void 0&&this.setColor(e.color)}clone(){const e=this.getColor();return new wo({color:Array.isArray(e)?e.slice():e||void 0})}getColor(){return this.color_}setColor(e){if(e!==null&&typeof e=="object"&&"src"in e){const t=k0(null,e.src,"anonymous",void 0,e.offset?null:e.color?e.color:null,!(e.offset&&e.size));t.ready().then(()=>{this.patternImage_=null}),t.getImageState()===Ke.IDLE&&t.load(),t.getImageState()===Ke.LOADING&&(this.patternImage_=t)}this.color_=e}getKey(){const e=this.getColor();return e?e instanceof CanvasPattern||e instanceof CanvasGradient?ut(e):typeof e=="object"&&"src"in e?e.src+":"+e.offset:yh(e).toString():""}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}class ka{constructor(e){e=e||{},this.color_=e.color!==void 0?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=e.lineDash!==void 0?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width}clone(){const e=this.getColor();return new ka({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(e){this.color_=e}setLineCap(e){this.lineCap_=e}setLineDash(e){this.lineDash_=e}setLineDashOffset(e){this.lineDashOffset_=e}setLineJoin(e){this.lineJoin_=e}setMiterLimit(e){this.miterLimit_=e}setWidth(e){this.width_=e}}function BR(n){return n[0]>0&&n[1]>0}function $8(n,e,t){return t===void 0&&(t=[0,0]),t[0]=n[0]*e+.5|0,t[1]=n[1]*e+.5|0,t}function Vi(n,e){return Array.isArray(n)?n:(e===void 0?e=[n,n]:(e[0]=n,e[1]=n),e)}class q_{constructor(e){this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=Vi(e.scale),this.displacement_=e.displacement,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new q_({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return We()}getImage(e){return We()}getHitDetectionImage(){return We()}getPixelRatio(e){return 1}getImageState(){return We()}getImageSize(){return We()}getOrigin(){return We()}getSize(){return We()}setDisplacement(e){this.displacement_=e}setOpacity(e){this.opacity_=e}setRotateWithView(e){this.rotateWithView_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=Vi(e)}listenImageChange(e){We()}load(){We()}unlistenImageChange(e){We()}ready(){return Promise.resolve()}}class Y_ extends q_{constructor(e){super({opacity:1,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,rotation:e.rotation!==void 0?e.rotation:0,scale:e.scale!==void 0?e.scale:1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=e.fill!==void 0?e.fill:null,this.origin_=[0,0],this.points_=e.points,this.radius=e.radius,this.radius2_=e.radius2,this.angle_=e.angle!==void 0?e.angle:0,this.stroke_=e.stroke!==void 0?e.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?Ke.LOADING:Ke.LOADED,this.imageState_===Ke.LOADING&&this.ready().then(()=>this.imageState_=Ke.LOADED),this.render()}clone(){const e=this.getScale(),t=new Y_({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}getAnchor(){const e=this.size_,t=this.getDisplacement(),i=this.getScaleArray();return[e[0]/2-t[0]/i[0],e[1]/2+t[1]/i[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(e){this.fill_=e,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(e){const t=this.fill_?.getKey(),i=`${e},${this.angle_},${this.radius},${this.radius2_},${this.points_},${t}`+Object.values(this.renderOptions_).join(",");let r=Ar.get(i,null,null)?.getImage(1);if(!r){const s=this.renderOptions_,o=Math.ceil(s.size*e),a=En(o,o);this.draw_(s,a,e),r=a.canvas,Ar.set(i,null,null,new e4(r,void 0,null,Ke.LOADED,null))}return r}getPixelRatio(e){return e}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e,this.render()}listenImageChange(e){}load(){}unlistenImageChange(e){}calculateLineJoinSize_(e,t,i){if(t===0||this.points_===1/0||e!=="bevel"&&e!=="miter")return t;let r=this.radius,s=this.radius2_===void 0?r:this.radius2_;if(r<s){const W=r;r=s,s=W}const o=this.radius2_===void 0?this.points_:this.points_*2,a=2*Math.PI/o,c=s*Math.sin(a),h=Math.sqrt(s*s-c*c),d=r-h,g=Math.sqrt(c*c+d*d),m=g/c;if(e==="miter"&&m<=i)return m*t;const y=t/2/m,w=t/2*(d/g),E=Math.sqrt((r+y)*(r+y)+w*w)-r;if(this.radius2_===void 0||e==="bevel")return E*2;const P=r*Math.sin(a),M=Math.sqrt(r*r-P*P),N=s-M,j=Math.sqrt(P*P+N*N)/P;if(j<=i){const W=j*t/2-s-r;return 2*Math.max(E,W)}return E*2}createRenderOptions(){let e=vh,t=Eh,i=0,r=null,s=0,o,a=0;this.stroke_&&(o=Rs(this.stroke_.getColor()??Yf),a=this.stroke_.getWidth()??Qf,r=this.stroke_.getLineDash(),s=this.stroke_.getLineDashOffset()??0,t=this.stroke_.getLineJoin()??Eh,e=this.stroke_.getLineCap()??vh,i=this.stroke_.getMiterLimit()??qf);const c=this.calculateLineJoinSize_(t,a,i),h=Math.max(this.radius,this.radius2_||0),d=Math.ceil(2*h+c);return{strokeStyle:o,strokeWidth:a,size:d,lineCap:e,lineDash:r,lineDashOffset:s,lineJoin:t,miterLimit:i}}render(){this.renderOptions_=this.createRenderOptions();const e=this.renderOptions_.size;this.hitDetectionCanvas_=null,this.size_=[e,e]}draw_(e,t,i){if(t.scale(i,i),t.translate(e.size/2,e.size/2),this.createPath_(t),this.fill_){let r=this.fill_.getColor();r===null&&(r=ki),t.fillStyle=Rs(r),t.fill()}e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineCap=e.lineCap,t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}createHitDetectionCanvas_(e){let t;if(this.fill_){let i=this.fill_.getColor(),r=0;typeof i=="string"&&(i=yh(i)),i===null?r=1:Array.isArray(i)&&(r=i.length===4?i[3]:1),r===0&&(t=En(e.size,e.size),this.drawHitDetectionCanvas_(e,t))}return t?t.canvas:this.getImage(1)}createPath_(e){let t=this.points_;const i=this.radius;if(t===1/0)e.arc(0,0,i,0,2*Math.PI);else{const r=this.radius2_===void 0?i:this.radius2_;this.radius2_!==void 0&&(t*=2);const s=this.angle_-Math.PI/2,o=2*Math.PI/t;for(let a=0;a<t;a++){const c=s+a*o,h=a%2===0?i:r;e.lineTo(h*Math.cos(c),h*Math.sin(c))}e.closePath()}}drawHitDetectionCanvas_(e,t){t.translate(e.size/2,e.size/2),this.createPath_(t),t.fillStyle=ki,t.fill(),e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}class Uh extends Y_{constructor(e){e=e||{radius:5},super({points:1/0,fill:e.fill,radius:e.radius,stroke:e.stroke,scale:e.scale!==void 0?e.scale:1,rotation:e.rotation!==void 0?e.rotation:0,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode})}clone(){const e=this.getScale(),t=new Uh({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}setRadius(e){this.radius=e,this.render()}}class ji{constructor(e){e=e||{},this.geometry_=null,this.geometryFunction_=zR,e.geometry!==void 0&&this.setGeometry(e.geometry),this.fill_=e.fill!==void 0?e.fill:null,this.image_=e.image!==void 0?e.image:null,this.renderer_=e.renderer!==void 0?e.renderer:null,this.hitDetectionRenderer_=e.hitDetectionRenderer!==void 0?e.hitDetectionRenderer:null,this.stroke_=e.stroke!==void 0?e.stroke:null,this.text_=e.text!==void 0?e.text:null,this.zIndex_=e.zIndex}clone(){let e=this.getGeometry();return e&&typeof e=="object"&&(e=e.clone()),new ji({geometry:e??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(e){this.renderer_=e}setHitDetectionRenderer(e){this.hitDetectionRenderer_=e}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(e){this.fill_=e}getImage(){return this.image_}setImage(e){this.image_=e}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e}getText(){return this.text_}setText(e){this.text_=e}getZIndex(){return this.zIndex_}setGeometry(e){typeof e=="function"?this.geometryFunction_=e:typeof e=="string"?this.geometryFunction_=function(t){return t.get(e)}:e?e!==void 0&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=zR,this.geometry_=e}setZIndex(e){this.zIndex_=e}}function W8(n){let e;if(typeof n=="function")e=n;else{let t;Array.isArray(n)?t=n:(yt(typeof n.getZIndex=="function","Expected an `Style` or an array of `Style`"),t=[n]),e=function(){return t}}return e}let T1=null;function p4(n,e){if(!T1){const t=new wo({color:"rgba(255,255,255,0.4)"}),i=new ka({color:"#3399CC",width:1.25});T1=[new ji({image:new Uh({fill:t,stroke:i,radius:5}),fill:t,stroke:i})]}return T1}function zR(n){return n.getGeometry()}const H8="#333";class kx{constructor(e){e=e||{},this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.keepUpright_=e.keepUpright,this.scale_=e.scale,this.scaleArray_=Vi(e.scale!==void 0?e.scale:1),this.text_=e.text,this.textAlign_=e.textAlign,this.justify_=e.justify,this.repeat_=e.repeat,this.textBaseline_=e.textBaseline,this.fill_=e.fill!==void 0?e.fill:new wo({color:H8}),this.maxAngle_=e.maxAngle!==void 0?e.maxAngle:Math.PI/4,this.placement_=e.placement!==void 0?e.placement:"point",this.overflow_=!!e.overflow,this.stroke_=e.stroke!==void 0?e.stroke:null,this.offsetX_=e.offsetX!==void 0?e.offsetX:0,this.offsetY_=e.offsetY!==void 0?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=e.padding===void 0?null:e.padding,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new kx({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),keepUpright:this.getKeepUpright(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()instanceof wo?this.getFill().clone():this.getFill(),stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getKeepUpright(){return this.keepUpright_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(e){this.overflow_=e}setFont(e){this.font_=e}setMaxAngle(e){this.maxAngle_=e}setOffsetX(e){this.offsetX_=e}setOffsetY(e){this.offsetY_=e}setPlacement(e){this.placement_=e}setRepeat(e){this.repeat_=e}setRotateWithView(e){this.rotateWithView_=e}setKeepUpright(e){this.keepUpright_=e}setFill(e){this.fill_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=Vi(e!==void 0?e:1)}setStroke(e){this.stroke_=e}setText(e){this.text_=e}setTextAlign(e){this.textAlign_=e}setJustify(e){this.justify_=e}setTextBaseline(e){this.textBaseline_=e}setBackgroundFill(e){this.backgroundFill_=e}setBackgroundStroke(e){this.backgroundStroke_=e}setPadding(e){this.padding_=e}}const ni={ANIMATING:0,INTERACTING:1},Ve={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},bp=[Ve.FILL],Ra=[Ve.STROKE],Yl=[Ve.BEGIN_PATH],$R=[Ve.CLOSE_PATH];class jg extends t4{constructor(e,t,i,r){super(),this.tolerance=e,this.maxExtent=t,this.pixelRatio=r,this.maxLineWidth=0,this.resolution=i,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(e){const t=this.pixelRatio;return t==1?e:e.map(function(i){return i*t})}appendFlatPointCoordinates(e,t){const i=this.getBufferedMaxExtent(),r=this.tmpCoordinate_,s=this.coordinates;let o=s.length;for(let a=0,c=e.length;a<c;a+=t)r[0]=e[a],r[1]=e[a+1],mh(i,r)&&(s[o++]=r[0],s[o++]=r[1]);return o}appendFlatLineCoordinates(e,t,i,r,s,o){const a=this.coordinates;let c=a.length;const h=this.getBufferedMaxExtent();o&&(t+=r);let d=e[t],g=e[t+1];const m=this.tmpCoordinate_;let y=!0,w,T,E;for(w=t+r;w<i;w+=r)m[0]=e[w],m[1]=e[w+1],E=xE(h,m),E!==T?(y&&(a[c++]=d,a[c++]=g,y=!1),a[c++]=m[0],a[c++]=m[1]):E===An.INTERSECTING?(a[c++]=m[0],a[c++]=m[1],y=!1):y=!0,d=m[0],g=m[1],T=E;return(s&&y||w===t+r)&&(a[c++]=d,a[c++]=g),c}drawCustomCoordinates_(e,t,i,r,s){for(let o=0,a=i.length;o<a;++o){const c=i[o],h=this.appendFlatLineCoordinates(e,t,c,r,!1,!1);s.push(h),t=c}return t}drawCustom(e,t,i,r,s){this.beginGeometry(e,t,s);const o=e.getType(),a=e.getStride(),c=this.coordinates.length;let h,d,g,m,y;switch(o){case"MultiPolygon":h=e.getOrientedFlatCoordinates(),m=[];const w=e.getEndss();y=0;for(let T=0,E=w.length;T<E;++T){const P=[];y=this.drawCustomCoordinates_(h,y,w[T],a,P),m.push(P)}this.instructions.push([Ve.CUSTOM,c,m,e,i,kE,s]),this.hitDetectionInstructions.push([Ve.CUSTOM,c,m,e,r||i,kE,s]);break;case"Polygon":case"MultiLineString":g=[],h=o=="Polygon"?e.getOrientedFlatCoordinates():e.getFlatCoordinates(),y=this.drawCustomCoordinates_(h,0,e.getEnds(),a,g),this.instructions.push([Ve.CUSTOM,c,g,e,i,Kf,s]),this.hitDetectionInstructions.push([Ve.CUSTOM,c,g,e,r||i,Kf,s]);break;case"LineString":case"Circle":h=e.getFlatCoordinates(),d=this.appendFlatLineCoordinates(h,0,h.length,a,!1,!1),this.instructions.push([Ve.CUSTOM,c,d,e,i,Ia,s]),this.hitDetectionInstructions.push([Ve.CUSTOM,c,d,e,r||i,Ia,s]);break;case"MultiPoint":h=e.getFlatCoordinates(),d=this.appendFlatPointCoordinates(h,a),d>c&&(this.instructions.push([Ve.CUSTOM,c,d,e,i,Ia,s]),this.hitDetectionInstructions.push([Ve.CUSTOM,c,d,e,r||i,Ia,s]));break;case"Point":h=e.getFlatCoordinates(),this.coordinates.push(h[0],h[1]),d=this.coordinates.length,this.instructions.push([Ve.CUSTOM,c,d,e,i,void 0,s]),this.hitDetectionInstructions.push([Ve.CUSTOM,c,d,e,r||i,void 0,s]);break}this.endGeometry(t)}beginGeometry(e,t,i){this.beginGeometryInstruction1_=[Ve.BEGIN_GEOMETRY,t,0,e,i],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[Ve.BEGIN_GEOMETRY,t,0,e,i],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const e=this.hitDetectionInstructions;e.reverse();let t;const i=e.length;let r,s,o=-1;for(t=0;t<i;++t)r=e[t],s=r[0],s==Ve.END_GEOMETRY?o=t:s==Ve.BEGIN_GEOMETRY&&(r[2]=t,B5(this.hitDetectionInstructions,o,t),o=-1)}fillStyleToState(e,t={}){if(e){const i=e.getColor();t.fillPatternScale=i&&typeof i=="object"&&"src"in i?this.pixelRatio:1,t.fillStyle=Rs(i||ki)}else t.fillStyle=void 0;return t}strokeStyleToState(e,t={}){if(e){const i=e.getColor();t.strokeStyle=Rs(i||Yf);const r=e.getLineCap();t.lineCap=r!==void 0?r:vh;const s=e.getLineDash();t.lineDash=s?s.slice():mo;const o=e.getLineDashOffset();t.lineDashOffset=o||po;const a=e.getLineJoin();t.lineJoin=a!==void 0?a:Eh;const c=e.getWidth();t.lineWidth=c!==void 0?c:Qf;const h=e.getMiterLimit();t.miterLimit=h!==void 0?h:qf,t.lineWidth>this.maxLineWidth&&(this.maxLineWidth=t.lineWidth,this.bufferedMaxExtent_=null)}else t.strokeStyle=void 0,t.lineCap=void 0,t.lineDash=null,t.lineDashOffset=void 0,t.lineJoin=void 0,t.lineWidth=void 0,t.miterLimit=void 0;return t}setFillStrokeStyle(e,t){const i=this.state;this.fillStyleToState(e,i),this.strokeStyleToState(t,i)}createFill(e){const t=e.fillStyle,i=[Ve.SET_FILL_STYLE,t];return typeof t!="string"&&i.push(e.fillPatternScale),i}applyStroke(e){this.instructions.push(this.createStroke(e))}createStroke(e){return[Ve.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth*this.pixelRatio,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash?this.applyPixelRatio(e.lineDash):null,e.lineDashOffset*this.pixelRatio]}updateFillStyle(e,t){const i=e.fillStyle;(typeof i!="string"||e.currentFillStyle!=i)&&(this.instructions.push(t.call(this,e)),e.currentFillStyle=i)}updateStrokeStyle(e,t){const i=e.strokeStyle,r=e.lineCap,s=e.lineDash,o=e.lineDashOffset,a=e.lineJoin,c=e.lineWidth,h=e.miterLimit;(e.currentStrokeStyle!=i||e.currentLineCap!=r||s!=e.currentLineDash&&!Za(e.currentLineDash,s)||e.currentLineDashOffset!=o||e.currentLineJoin!=a||e.currentLineWidth!=c||e.currentMiterLimit!=h)&&(t.call(this,e),e.currentStrokeStyle=i,e.currentLineCap=r,e.currentLineDash=s,e.currentLineDashOffset=o,e.currentLineJoin=a,e.currentLineWidth=c,e.currentMiterLimit=h)}endGeometry(e){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const t=[Ve.END_GEOMETRY,e];this.instructions.push(t),this.hitDetectionInstructions.push(t)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=Eb(this.maxExtent),this.maxLineWidth>0)){const e=this.resolution*(this.maxLineWidth+1)/2;$f(this.bufferedMaxExtent_,e,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}class K8 extends jg{constructor(e,t,i,r){super(e,t,i,r),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(e,t,i){if(!this.image_||this.maxExtent&&!mh(this.maxExtent,e.getFlatCoordinates()))return;this.beginGeometry(e,t,i);const r=e.getFlatCoordinates(),s=e.getStride(),o=this.coordinates.length,a=this.appendFlatPointCoordinates(r,s);this.instructions.push([Ve.DRAW_IMAGE,o,a,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Ve.DRAW_IMAGE,o,a,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}drawMultiPoint(e,t,i){if(!this.image_)return;this.beginGeometry(e,t,i);const r=e.getFlatCoordinates(),s=[];for(let c=0,h=r.length;c<h;c+=e.getStride())(!this.maxExtent||mh(this.maxExtent,r.slice(c,c+2)))&&s.push(r[c],r[c+1]);const o=this.coordinates.length,a=this.appendFlatPointCoordinates(s,2);this.instructions.push([Ve.DRAW_IMAGE,o,a,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Ve.DRAW_IMAGE,o,a,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(e,t){const i=e.getAnchor(),r=e.getSize(),s=e.getOrigin();this.imagePixelRatio_=e.getPixelRatio(this.pixelRatio),this.anchorX_=i[0],this.anchorY_=i[1],this.hitDetectionImage_=e.getHitDetectionImage(),this.image_=e.getImage(this.pixelRatio),this.height_=r[1],this.opacity_=e.getOpacity(),this.originX_=s[0],this.originY_=s[1],this.rotateWithView_=e.getRotateWithView(),this.rotation_=e.getRotation(),this.scale_=e.getScaleArray(),this.width_=r[0],this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}class q8 extends jg{constructor(e,t,i,r){super(e,t,i,r)}drawFlatCoordinates_(e,t,i,r){const s=this.coordinates.length,o=this.appendFlatLineCoordinates(e,t,i,r,!1,!1),a=[Ve.MOVE_TO_LINE_TO,s,o];return this.instructions.push(a),this.hitDetectionInstructions.push(a),i}drawLineString(e,t,i){const r=this.state,s=r.strokeStyle,o=r.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(e,t,i),this.hitDetectionInstructions.push([Ve.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,mo,po],Yl);const a=e.getFlatCoordinates(),c=e.getStride();this.drawFlatCoordinates_(a,0,a.length,c),this.hitDetectionInstructions.push(Ra),this.endGeometry(t)}drawMultiLineString(e,t,i){const r=this.state,s=r.strokeStyle,o=r.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(e,t,i),this.hitDetectionInstructions.push([Ve.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,mo,po],Yl);const a=e.getEnds(),c=e.getFlatCoordinates(),h=e.getStride();let d=0;for(let g=0,m=a.length;g<m;++g)d=this.drawFlatCoordinates_(c,d,a[g],h);this.hitDetectionInstructions.push(Ra),this.endGeometry(t)}finish(){const e=this.state;return e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&this.instructions.push(Ra),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(e){e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&(this.instructions.push(Ra),e.lastStroke=this.coordinates.length),e.lastStroke=0,super.applyStroke(e),this.instructions.push(Yl)}}class WR extends jg{constructor(e,t,i,r){super(e,t,i,r)}drawFlatCoordinatess_(e,t,i,r){const s=this.state,o=s.fillStyle!==void 0,a=s.strokeStyle!==void 0,c=i.length;this.instructions.push(Yl),this.hitDetectionInstructions.push(Yl);for(let h=0;h<c;++h){const d=i[h],g=this.coordinates.length,m=this.appendFlatLineCoordinates(e,t,d,r,!0,!a),y=[Ve.MOVE_TO_LINE_TO,g,m];this.instructions.push(y),this.hitDetectionInstructions.push(y),a&&(this.instructions.push($R),this.hitDetectionInstructions.push($R)),t=d}return o&&(this.instructions.push(bp),this.hitDetectionInstructions.push(bp)),a&&(this.instructions.push(Ra),this.hitDetectionInstructions.push(Ra)),t}drawCircle(e,t,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([Ve.SET_FILL_STYLE,ki]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Ve.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,mo,po]);const a=e.getFlatCoordinates(),c=e.getStride(),h=this.coordinates.length;this.appendFlatLineCoordinates(a,0,a.length,c,!1,!1);const d=[Ve.CIRCLE,h];this.instructions.push(Yl,d),this.hitDetectionInstructions.push(Yl,d),r.fillStyle!==void 0&&(this.instructions.push(bp),this.hitDetectionInstructions.push(bp)),r.strokeStyle!==void 0&&(this.instructions.push(Ra),this.hitDetectionInstructions.push(Ra)),this.endGeometry(t)}drawPolygon(e,t,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([Ve.SET_FILL_STYLE,ki]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Ve.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,mo,po]);const a=e.getEnds(),c=e.getOrientedFlatCoordinates(),h=e.getStride();this.drawFlatCoordinatess_(c,0,a,h),this.endGeometry(t)}drawMultiPolygon(e,t,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([Ve.SET_FILL_STYLE,ki]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Ve.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,mo,po]);const a=e.getEndss(),c=e.getOrientedFlatCoordinates(),h=e.getStride();let d=0;for(let g=0,m=a.length;g<m;++g)d=this.drawFlatCoordinatess_(c,d,a[g],h);this.endGeometry(t)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const e=this.tolerance;if(e!==0){const t=this.coordinates;for(let i=0,r=t.length;i<r;++i)t[i]=kl(t[i],e)}return super.finish()}setFillStrokeStyles_(){const e=this.state;this.updateFillStyle(e,this.createFill),this.updateStrokeStyle(e,this.applyStroke)}}function Y8(n,e,t,i,r){const s=[];let o=t,a=0,c=e.slice(t,2);for(;a<n&&o+r<i;){const[h,d]=c.slice(-2),g=e[o+r],m=e[o+r+1],y=Math.sqrt((g-h)*(g-h)+(m-d)*(m-d));if(a+=y,a>=n){const w=(n-a+y)/y,T=Zi(h,g,w),E=Zi(d,m,w);c.push(T,E),s.push(c),c=[T,E],a==n&&(o+=r),a=0}else if(a<n)c.push(e[o+r],e[o+r+1]),o+=r;else{const w=y-a,T=Zi(h,g,w/y),E=Zi(d,m,w/y);c.push(T,E),s.push(c),c=[T,E],a=0,o+=r}}return a>0&&s.push(c),s}function X8(n,e,t,i,r){let s=t,o=t,a=0,c=0,h=t,d,g,m,y,w,T,E,P,M,N;for(g=t;g<i;g+=r){const D=e[g],j=e[g+1];w!==void 0&&(M=D-w,N=j-T,y=Math.sqrt(M*M+N*N),E!==void 0&&(c+=m,d=Math.acos((E*M+P*N)/(m*y)),d>n&&(c>a&&(a=c,s=h,o=g),c=0,h=g-r)),m=y,E=M,P=N),w=D,T=j}return c+=y,c>a?[h,g]:[s,o]}const F0={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class Q8 extends jg{constructor(e,t,i,r){super(e,t,i,r),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textKeepUpright_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[ki]={fillStyle:ki},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const e=super.finish();return e.textStates=this.textStates,e.fillStates=this.fillStates,e.strokeStates=this.strokeStates,e}drawText(e,t,i){const r=this.textFillState_,s=this.textStrokeState_,o=this.textState_;if(this.text_===""||!o||!r&&!s)return;const a=this.coordinates;let c=a.length;const h=e.getType();let d=null,g=e.getStride();if(o.placement==="line"&&(h=="LineString"||h=="MultiLineString"||h=="Polygon"||h=="MultiPolygon")){if(!Ni(this.maxExtent,e.getExtent()))return;let m;if(d=e.getFlatCoordinates(),h=="LineString")m=[d.length];else if(h=="MultiLineString")m=e.getEnds();else if(h=="Polygon")m=e.getEnds().slice(0,1);else if(h=="MultiPolygon"){const E=e.getEndss();m=[];for(let P=0,M=E.length;P<M;++P)m.push(E[P][0])}this.beginGeometry(e,t,i);const y=o.repeat,w=y?void 0:o.textAlign;let T=0;for(let E=0,P=m.length;E<P;++E){let M;y?M=Y8(y*this.resolution,d,T,m[E],g):M=[d.slice(T,m[E])];for(let N=0,D=M.length;N<D;++N){const j=M[N];let W=0,L=j.length;if(w==null){const k=X8(o.maxAngle,j,0,j.length,2);W=k[0],L=k[1]}for(let k=W;k<L;k+=g)a.push(j[k],j[k+1]);const A=a.length;T=m[E],this.drawChars_(c,A),c=A}}this.endGeometry(t)}else{let m=o.overflow?null:[];switch(h){case"Point":case"MultiPoint":d=e.getFlatCoordinates();break;case"LineString":d=e.getFlatMidpoint();break;case"Circle":d=e.getCenter();break;case"MultiLineString":d=e.getFlatMidpoints(),g=2;break;case"Polygon":d=e.getFlatInteriorPoint(),o.overflow||m.push(d[2]/this.resolution),g=3;break;case"MultiPolygon":const D=e.getFlatInteriorPoints();d=[];for(let j=0,W=D.length;j<W;j+=3)o.overflow||m.push(D[j+2]/this.resolution),d.push(D[j],D[j+1]);if(d.length===0)return;g=2;break}const y=this.appendFlatPointCoordinates(d,g);if(y===c)return;if(m&&(y-c)/2!==d.length/g){let D=c/2;m=m.filter((j,W)=>{const L=a[(D+W)*2]===d[W*g]&&a[(D+W)*2+1]===d[W*g+1];return L||--D,L})}this.saveTextStates_();const w=o.backgroundFill?this.createFill(this.fillStyleToState(o.backgroundFill)):null,T=o.backgroundStroke?this.createStroke(this.strokeStyleToState(o.backgroundStroke)):null;this.beginGeometry(e,t,i);let E=o.padding;if(E!=ql&&(o.scale[0]<0||o.scale[1]<0)){let D=o.padding[0],j=o.padding[1],W=o.padding[2],L=o.padding[3];o.scale[0]<0&&(j=-j,L=-L),o.scale[1]<0&&(D=-D,W=-W),E=[D,j,W,L]}const P=this.pixelRatio;this.instructions.push([Ve.DRAW_IMAGE,c,y,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,E==ql?ql:E.map(function(D){return D*P}),w,T,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,m]);const M=1/P,N=w?w.slice(0):null;N&&(N[1]=ki),this.hitDetectionInstructions.push([Ve.DRAW_IMAGE,c,y,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[M,M],NaN,this.declutterMode_,this.declutterImageWithText_,E,N,T,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?ki:this.fillKey_,this.textOffsetX_,this.textOffsetY_,m]),this.endGeometry(t)}}saveTextStates_(){const e=this.textStrokeState_,t=this.textState_,i=this.textFillState_,r=this.strokeKey_;e&&(r in this.strokeStates||(this.strokeStates[r]={strokeStyle:e.strokeStyle,lineCap:e.lineCap,lineDashOffset:e.lineDashOffset,lineWidth:e.lineWidth,lineJoin:e.lineJoin,miterLimit:e.miterLimit,lineDash:e.lineDash}));const s=this.textKey_;s in this.textStates||(this.textStates[s]={font:t.font,textAlign:t.textAlign||Xf,justify:t.justify,textBaseline:t.textBaseline||L0,scale:t.scale});const o=this.fillKey_;i&&(o in this.fillStates||(this.fillStates[o]={fillStyle:i.fillStyle}))}drawChars_(e,t){const i=this.textStrokeState_,r=this.textState_,s=this.strokeKey_,o=this.textKey_,a=this.fillKey_;this.saveTextStates_();const c=this.pixelRatio,h=F0[r.textBaseline],d=this.textOffsetY_*c,g=this.text_,m=i?i.lineWidth*Math.abs(r.scale[0])/2:0;this.instructions.push([Ve.DRAW_CHARS,e,t,h,r.overflow,a,r.maxAngle,c,d,s,m*c,g,o,1,this.declutterMode_,this.textKeepUpright_]),this.hitDetectionInstructions.push([Ve.DRAW_CHARS,e,t,h,r.overflow,a&&ki,r.maxAngle,c,d,s,m*c,g,o,1/c,this.declutterMode_,this.textKeepUpright_])}setTextStyle(e,t){let i,r,s;if(!e)this.text_="";else{const o=e.getFill();o?(r=this.textFillState_,r||(r={},this.textFillState_=r),r.fillStyle=Rs(o.getColor()||ki)):(r=null,this.textFillState_=r);const a=e.getStroke();if(!a)s=null,this.textStrokeState_=s;else{s=this.textStrokeState_,s||(s={},this.textStrokeState_=s);const T=a.getLineDash(),E=a.getLineDashOffset(),P=a.getWidth(),M=a.getMiterLimit();s.lineCap=a.getLineCap()||vh,s.lineDash=T?T.slice():mo,s.lineDashOffset=E===void 0?po:E,s.lineJoin=a.getLineJoin()||Eh,s.lineWidth=P===void 0?Qf:P,s.miterLimit=M===void 0?qf:M,s.strokeStyle=Rs(a.getColor()||Yf)}i=this.textState_;const c=e.getFont()||n4;m8(c);const h=e.getScaleArray();i.overflow=e.getOverflow(),i.font=c,i.maxAngle=e.getMaxAngle(),i.placement=e.getPlacement(),i.textAlign=e.getTextAlign(),i.repeat=e.getRepeat(),i.justify=e.getJustify(),i.textBaseline=e.getTextBaseline()||L0,i.backgroundFill=e.getBackgroundFill(),i.backgroundStroke=e.getBackgroundStroke(),i.padding=e.getPadding()||ql,i.scale=h===void 0?[1,1]:h;const d=e.getOffsetX(),g=e.getOffsetY(),m=e.getRotateWithView(),y=e.getKeepUpright(),w=e.getRotation();this.text_=e.getText()||"",this.textOffsetX_=d===void 0?0:d,this.textOffsetY_=g===void 0?0:g,this.textRotateWithView_=m===void 0?!1:m,this.textKeepUpright_=y===void 0?!0:y,this.textRotation_=w===void 0?0:w,this.strokeKey_=s?(typeof s.strokeStyle=="string"?s.strokeStyle:ut(s.strokeStyle))+s.lineCap+s.lineDashOffset+"|"+s.lineWidth+s.lineJoin+s.miterLimit+"["+s.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.repeat||"?")+(i.justify||"?")+(i.textBaseline||"?"),this.fillKey_=r&&r.fillStyle?typeof r.fillStyle=="string"?r.fillStyle:"|"+ut(r.fillStyle):""}this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}const Z8={Circle:WR,Default:jg,Image:K8,LineString:q8,Polygon:WR,Text:Q8};class J8{constructor(e,t,i,r){this.tolerance_=e,this.maxExtent_=t,this.pixelRatio_=r,this.resolution_=i,this.buildersByZIndex_={}}finish(){const e={};for(const t in this.buildersByZIndex_){e[t]=e[t]||{};const i=this.buildersByZIndex_[t];for(const r in i){const s=i[r].finish();e[t][r]=s}}return e}getBuilder(e,t){const i=e!==void 0?e.toString():"0";let r=this.buildersByZIndex_[i];r===void 0&&(r={},this.buildersByZIndex_[i]=r);let s=r[t];if(s===void 0){const o=Z8[t];s=new o(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),r[t]=s}return s}}function eV(n,e,t,i,r,s,o,a,c,h,d,g,m=!0){let y=n[e],w=n[e+1],T=0,E=0,P=0,M=0;function N(){T=y,E=w,e+=i,y=n[e],w=n[e+1],M+=P,P=Math.sqrt((y-T)*(y-T)+(w-E)*(w-E))}do N();while(e<t-i&&M+P<s);let D=P===0?0:(s-M)/P;const j=Zi(T,y,D),W=Zi(E,w,D),L=e-i,A=M,k=s+a*c(h,r,d);for(;e<t-i&&M+P<k;)N();D=P===0?0:(k-M)/P;const U=Zi(T,y,D),B=Zi(E,w,D);let z=!1;if(m)if(g){const _e=[j,W,U,B];jb(_e,0,4,2,g,_e,_e),z=_e[0]>_e[2]}else z=j>U;const O=Math.PI,oe=[],Te=L+i===e;e=L,P=0,M=A,y=n[e],w=n[e+1];let we;if(Te){N(),we=Math.atan2(w-E,y-T),z&&(we+=we>0?-O:O);const _e=(U+j)/2,Q=(B+W)/2;return oe[0]=[_e,Q,(k-s)/2,we,r],oe}r=r.replace(/\n/g," ");for(let _e=0,Q=r.length;_e<Q;){N();let ce=Math.atan2(w-E,y-T);if(z&&(ce+=ce>0?-O:O),we!==void 0){let fe=ce-we;if(fe+=fe>O?-2*O:fe<-O?2*O:0,Math.abs(fe)>o)return null}we=ce;const K=_e;let V=0;for(;_e<Q;++_e){const fe=z?Q-_e-1:_e,X=a*c(h,r[fe],d);if(e+i<t&&M+P<s+V+X/2)break;V+=X}if(_e===K)continue;const I=z?r.substring(Q-K,Q-_e):r.substring(K,_e);D=P===0?0:(s+V/2-M)/P;const de=Zi(T,y,D),q=Zi(E,w,D);oe.push([de,q,V/2,ce,I]),s+=V}return oe}class _4{constructor(){this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(b0(),{get:(e,t)=>{if(typeof b0()[t]=="function")return this.push_(t),this.pushMethodArgs_},set:(e,t,i)=>(this.push_(t,i),!0)})}push_(...e){const t=this.instructions_,i=this.zIndex+this.offset_;t[i]||(t[i]=[]),t[i].push(...e)}pushMethodArgs_=(...e)=>(this.push_(e),this);pushFunction(e){this.push_(e)}getContext(){return this.context_}draw(e){this.instructions_.forEach(t=>{for(let i=0,r=t.length;i<r;++i){const s=t[i];if(typeof s=="function"){s(e);continue}const o=t[++i];if(typeof e[s]=="function")e[s](...o);else{if(typeof o=="function"){e[s]=o(e);continue}e[s]=o}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}}const Su=ir(),sa=[],oo=[],ao=[],oa=[];function HR(n){return n[3].declutterBox}const KR=new RegExp("[-----]");function R1(n,e){return e==="start"?e=KR.test(n)?"right":"left":e==="end"&&(e=KR.test(n)?"left":"right"),F0[e]}function tV(n,e,t){return t>0&&n.push(`
`,""),n.push(e,""),n}function nV(n,e,t){return t%2===0&&(n+=e),n}class iV{constructor(e,t,i,r,s){this.overlaps=i,this.pixelRatio=t,this.resolution=e,this.alignAndScaleFill_,this.instructions=r.instructions,this.coordinates=r.coordinates,this.coordinateCache_={},this.renderedTransform_=Zr(),this.hitDetectionInstructions=r.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=r.fillStates||{},this.strokeStates=r.strokeStates||{},this.textStates=r.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=s?new _4:null}getZIndexContext(){return this.zIndexContext_}createLabel(e,t,i,r){const s=e+t+i+r;if(this.labels_[s])return this.labels_[s];const o=r?this.strokeStates[r]:null,a=i?this.fillStates[i]:null,c=this.textStates[t],h=this.pixelRatio,d=[c.scale[0]*h,c.scale[1]*h],g=c.justify?F0[c.justify]:R1(Array.isArray(e)?e[0]:e,c.textAlign||Xf),m=r&&o.lineWidth?o.lineWidth:0,y=Array.isArray(e)?e:String(e).split(`
`).reduce(tV,[]),{width:w,height:T,widths:E,heights:P,lineWidths:M}=_8(c,y),N=w+m,D=[],j=(N+2)*d[0],W=(T+m)*d[1],L={width:j<0?Math.floor(j):Math.ceil(j),height:W<0?Math.floor(W):Math.ceil(W),contextInstructions:D};(d[0]!=1||d[1]!=1)&&D.push("scale",d),r&&(D.push("strokeStyle",o.strokeStyle),D.push("lineWidth",m),D.push("lineCap",o.lineCap),D.push("lineJoin",o.lineJoin),D.push("miterLimit",o.miterLimit),D.push("setLineDash",[o.lineDash]),D.push("lineDashOffset",o.lineDashOffset)),i&&D.push("fillStyle",a.fillStyle),D.push("textBaseline","middle"),D.push("textAlign","center");const A=.5-g;let k=g*N+A*m;const U=[],B=[];let z=0,O=0,oe=0,Te=0,we;for(let _e=0,Q=y.length;_e<Q;_e+=2){const ce=y[_e];if(ce===`
`){O+=z,z=0,k=g*N+A*m,++Te;continue}const K=y[_e+1]||c.font;K!==we&&(r&&U.push("font",K),i&&B.push("font",K),we=K),z=Math.max(z,P[oe]);const V=[ce,k+A*E[oe]+g*(E[oe]-M[Te]),.5*(m+z)+O];k+=E[oe],r&&U.push("strokeText",V),i&&B.push("fillText",V),++oe}return Array.prototype.push.apply(D,U),Array.prototype.push.apply(D,B),this.labels_[s]=L,L}replayTextBackground_(e,t,i,r,s,o,a){e.beginPath(),e.moveTo.apply(e,t),e.lineTo.apply(e,i),e.lineTo.apply(e,r),e.lineTo.apply(e,s),e.lineTo.apply(e,t),o&&(this.alignAndScaleFill_=o[2],e.fillStyle=o[1],this.fill_(e)),a&&(this.setStrokeStyle_(e,a),e.stroke())}calculateImageOrLabelDimensions_(e,t,i,r,s,o,a,c,h,d,g,m,y,w,T,E){a*=m[0],c*=m[1];let P=i-a,M=r-c;const N=s+h>e?e-h:s,D=o+d>t?t-d:o,j=w[3]+N*m[0]+w[1],W=w[0]+D*m[1]+w[2],L=P-w[3],A=M-w[0];(T||g!==0)&&(sa[0]=L,oa[0]=L,sa[1]=A,oo[1]=A,oo[0]=L+j,ao[0]=oo[0],ao[1]=A+W,oa[1]=ao[1]);let k;return g!==0?(k=Eo(Zr(),i,r,1,1,g,-i,-r),Mn(k,sa),Mn(k,oo),Mn(k,ao),Mn(k,oa),Ga(Math.min(sa[0],oo[0],ao[0],oa[0]),Math.min(sa[1],oo[1],ao[1],oa[1]),Math.max(sa[0],oo[0],ao[0],oa[0]),Math.max(sa[1],oo[1],ao[1],oa[1]),Su)):Ga(Math.min(L,L+j),Math.min(A,A+W),Math.max(L,L+j),Math.max(A,A+W),Su),y&&(P=Math.round(P),M=Math.round(M)),{drawImageX:P,drawImageY:M,drawImageW:N,drawImageH:D,originX:h,originY:d,declutterBox:{minX:Su[0],minY:Su[1],maxX:Su[2],maxY:Su[3],value:E},canvasTransform:k,scale:m}}replayImageOrLabel_(e,t,i,r,s,o,a){const c=!!(o||a),h=r.declutterBox,d=a?a[2]*r.scale[0]/2:0;return h.minX-d<=t[0]&&h.maxX+d>=0&&h.minY-d<=t[1]&&h.maxY+d>=0&&(c&&this.replayTextBackground_(e,sa,oo,ao,oa,o,a),y8(e,r.canvasTransform,s,i,r.originX,r.originY,r.drawImageW,r.drawImageH,r.drawImageX,r.drawImageY,r.scale)),!0}fill_(e){const t=this.alignAndScaleFill_;if(t){const i=Mn(this.renderedTransform_,[0,0]),r=512*this.pixelRatio;e.save(),e.translate(i[0]%r,i[1]%r),t!==1&&e.scale(t,t),e.rotate(this.viewRotation_)}e.fill(),t&&e.restore()}setStrokeStyle_(e,t){e.strokeStyle=t[1],t[1]&&(e.lineWidth=t[2],e.lineCap=t[3],e.lineJoin=t[4],e.miterLimit=t[5],e.lineDashOffset=t[7],e.setLineDash(t[6]))}drawLabelWithPointPlacement_(e,t,i,r){const s=this.textStates[t],o=this.createLabel(e,t,r,i),a=this.strokeStates[i],c=this.pixelRatio,h=R1(Array.isArray(e)?e[0]:e,s.textAlign||Xf),d=F0[s.textBaseline||L0],g=a&&a.lineWidth?a.lineWidth:0,m=o.width/c-2*s.scale[0],y=h*m+2*(.5-h)*g,w=d*o.height/c+2*(.5-d)*g;return{label:o,anchorX:y,anchorY:w}}execute_(e,t,i,r,s,o,a,c){const h=this.zIndexContext_;let d;this.pixelCoordinates_&&Za(i,this.renderedTransform_)?d=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),d=ba(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),C6(this.renderedTransform_,i));let g=0;const m=r.length;let y=0,w,T,E,P,M,N,D,j,W,L,A,k,U,B=0,z=0;const O=this.coordinateCache_,oe=this.viewRotation_,Te=Math.round(Math.atan2(-i[1],i[0])*1e12)/1e12,we={context:e,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:oe},_e=this.instructions!=r||this.overlaps?0:200;let Q,ce,K,V;for(;g<m;){const I=r[g];switch(I[0]){case Ve.BEGIN_GEOMETRY:Q=I[1],V=I[3],Q.getGeometry()?a!==void 0&&!Ni(a,V.getExtent())?g=I[2]+1:++g:g=I[2],h&&(h.zIndex=I[4]);break;case Ve.BEGIN_PATH:B>_e&&(this.fill_(e),B=0),z>_e&&(e.stroke(),z=0),!B&&!z&&(e.beginPath(),M=NaN,N=NaN),++g;break;case Ve.CIRCLE:y=I[1];const q=d[y],fe=d[y+1],X=d[y+2],F=d[y+3],te=X-q,Pe=F-fe,Be=Math.sqrt(te*te+Pe*Pe);e.moveTo(q+Be,fe),e.arc(q,fe,Be,0,2*Math.PI,!0),++g;break;case Ve.CLOSE_PATH:e.closePath(),++g;break;case Ve.CUSTOM:y=I[1],w=I[2];const Pt=I[3],Kn=I[4],bn=I[5];we.geometry=Pt,we.feature=Q,g in O||(O[g]=[]);const xi=O[g];bn?bn(d,y,w,2,xi):(xi[0]=d[y],xi[1]=d[y+1],xi.length=2),h&&(h.zIndex=I[6]),Kn(xi,we),++g;break;case Ve.DRAW_IMAGE:y=I[1],w=I[2],W=I[3],T=I[4],E=I[5];let kn=I[6];const Ln=I[7],Si=I[8],ar=I[9],Mt=I[10];let vt=I[11];const Sn=I[12];let lr=I[13];P=I[14]||"declutter";const Gt=I[15];if(!W&&I.length>=20){L=I[19],A=I[20],k=I[21],U=I[22];const en=this.drawLabelWithPointPlacement_(L,A,k,U);W=en.label,I[3]=W;const hr=I[23];T=(en.anchorX-hr)*this.pixelRatio,I[4]=T;const Nn=I[24];E=(en.anchorY-Nn)*this.pixelRatio,I[5]=E,kn=W.height,I[6]=kn,lr=W.width,I[13]=lr}let Oo;I.length>25&&(Oo=I[25]);let cr,ts,Lr;I.length>17?(cr=I[16],ts=I[17],Lr=I[18]):(cr=ql,ts=null,Lr=null),Mt&&Te?vt+=oe:!Mt&&!Te&&(vt-=oe);let ns=0;for(;y<w;y+=2){if(Oo&&Oo[ns++]<lr/this.pixelRatio)continue;const en=this.calculateImageOrLabelDimensions_(W.width,W.height,d[y],d[y+1],lr,kn,T,E,Si,ar,vt,Sn,s,cr,!!ts||!!Lr,Q),hr=[e,t,W,en,Ln,ts,Lr];if(c){let Nn,tn,On;if(Gt){const dt=w-y;if(!Gt[dt]){Gt[dt]={args:hr,declutterMode:P};continue}const cn=Gt[dt];Nn=cn.args,tn=cn.declutterMode,delete Gt[dt],On=HR(Nn)}let Dn,In;if(Nn&&(tn!=="declutter"||!c.collides(On))&&(Dn=!0),(P!=="declutter"||!c.collides(en.declutterBox))&&(In=!0),tn==="declutter"&&P==="declutter"){const dt=Dn&&In;Dn=dt,In=dt}Dn&&(tn!=="none"&&c.insert(On),this.replayImageOrLabel_.apply(this,Nn)),In&&(P!=="none"&&c.insert(en.declutterBox),this.replayImageOrLabel_.apply(this,hr))}else this.replayImageOrLabel_.apply(this,hr)}++g;break;case Ve.DRAW_CHARS:const il=I[1],is=I[2],ur=I[3],Gc=I[4];U=I[5];const rs=I[6],zs=I[7],Do=I[8];k=I[9];const hi=I[10];L=I[11],Array.isArray(L)&&(L=L.reduce(nV,"")),A=I[12];const $s=[I[13],I[13]];P=I[14]||"declutter";const ss=I[15],os=this.textStates[A],di=os.font,fi=[os.scale[0]*zs,os.scale[1]*zs];let Tt;di in this.widths_?Tt=this.widths_[di]:(Tt={},this.widths_[di]=Tt);const Vo=wx(d,il,is,2),Nr=Math.abs(fi[0])*LR(di,L,Tt);if(Gc||Nr<=Vo){const en=this.textStates[A].textAlign,hr=(Vo-Nr)*R1(L,en),Nn=eV(d,il,is,2,L,hr,rs,Math.abs(fi[0]),LR,di,Tt,Te?0:this.viewRotation_,ss);e:if(Nn){const tn=[];let On,Dn,In,dt,cn;if(k)for(On=0,Dn=Nn.length;On<Dn;++On){cn=Nn[On],In=cn[4],dt=this.createLabel(In,A,"",k),T=cn[2]+(fi[0]<0?-hi:hi),E=ur*dt.height+(.5-ur)*2*hi*fi[1]/fi[0]-Do;const mn=this.calculateImageOrLabelDimensions_(dt.width,dt.height,cn[0],cn[1],dt.width,dt.height,T,E,0,0,cn[3],$s,!1,ql,!1,Q);if(c&&P==="declutter"&&c.collides(mn.declutterBox))break e;tn.push([e,t,dt,mn,1,null,null])}if(U)for(On=0,Dn=Nn.length;On<Dn;++On){cn=Nn[On],In=cn[4],dt=this.createLabel(In,A,U,""),T=cn[2],E=ur*dt.height-Do;const mn=this.calculateImageOrLabelDimensions_(dt.width,dt.height,cn[0],cn[1],dt.width,dt.height,T,E,0,0,cn[3],$s,!1,ql,!1,Q);if(c&&P==="declutter"&&c.collides(mn.declutterBox))break e;tn.push([e,t,dt,mn,1,null,null])}c&&P!=="none"&&c.load(tn.map(HR));for(let mn=0,dr=tn.length;mn<dr;++mn)this.replayImageOrLabel_.apply(this,tn[mn])}}++g;break;case Ve.END_GEOMETRY:if(o!==void 0){Q=I[1];const en=o(Q,V,P);if(en)return en}++g;break;case Ve.FILL:_e?B++:this.fill_(e),++g;break;case Ve.MOVE_TO_LINE_TO:for(y=I[1],w=I[2],ce=d[y],K=d[y+1],e.moveTo(ce,K),M=ce+.5|0,N=K+.5|0,y+=2;y<w;y+=2)ce=d[y],K=d[y+1],D=ce+.5|0,j=K+.5|0,(y==w-2||D!==M||j!==N)&&(e.lineTo(ce,K),M=D,N=j);++g;break;case Ve.SET_FILL_STYLE:this.alignAndScaleFill_=I[2],B&&(this.fill_(e),B=0,z&&(e.stroke(),z=0)),e.fillStyle=I[1],++g;break;case Ve.SET_STROKE_STYLE:z&&(e.stroke(),z=0),this.setStrokeStyle_(e,I),++g;break;case Ve.STROKE:_e?z++:e.stroke(),++g;break;default:++g;break}}B&&this.fill_(e),z&&e.stroke()}execute(e,t,i,r,s,o){this.viewRotation_=r,this.execute_(e,t,i,this.instructions,s,void 0,void 0,o)}executeHitDetection(e,t,i,r,s){return this.viewRotation_=i,this.execute_(e,[e.canvas.width,e.canvas.height],t,this.hitDetectionInstructions,!0,r,s)}}const Ul=["Polygon","Circle","LineString","Image","Text","Default"],y4=["Image","Text"],rV=Ul.filter(n=>!y4.includes(n));class sV{constructor(e,t,i,r,s,o,a){this.maxExtent_=e,this.overlaps_=r,this.pixelRatio_=i,this.resolution_=t,this.renderBuffer_=o,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=Zr(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(s,a)}clip(e,t){const i=this.getClipCoords(t);e.beginPath(),e.moveTo(i[0],i[1]),e.lineTo(i[2],i[3]),e.lineTo(i[4],i[5]),e.lineTo(i[6],i[7]),e.clip()}createExecutors_(e,t){for(const i in e){let r=this.executorsByZIndex_[i];r===void 0&&(r={},this.executorsByZIndex_[i]=r);const s=e[i];for(const o in s){const a=s[o];r[o]=new iV(this.resolution_,this.pixelRatio_,this.overlaps_,a,t)}}}hasExecutors(e){for(const t in this.executorsByZIndex_){const i=this.executorsByZIndex_[t];for(let r=0,s=e.length;r<s;++r)if(e[r]in i)return!0}return!1}forEachFeatureAtCoordinate(e,t,i,r,s,o){r=Math.round(r);const a=r*2+1,c=Eo(this.hitDetectionTransform_,r+.5,r+.5,1/t,-1/t,-i,-e[0],-e[1]),h=!this.hitDetectionContext_;h&&(this.hitDetectionContext_=En(a,a));const d=this.hitDetectionContext_;d.canvas.width!==a||d.canvas.height!==a?(d.canvas.width=a,d.canvas.height=a):h||d.clearRect(0,0,a,a);let g;this.renderBuffer_!==void 0&&(g=ir(),vf(g,e),$f(g,t*(this.renderBuffer_+r),g));const m=oV(r);let y;function w(j,W,L){const A=d.getImageData(0,0,a,a).data;for(let k=0,U=m.length;k<U;k++)if(A[m[k]]>0){if(!o||L==="none"||y!=="Image"&&y!=="Text"||o.includes(j)){const B=(m[k]-3)/4,z=r-B%a,O=r-(B/a|0),oe=s(j,W,z*z+O*O);if(oe)return oe}d.clearRect(0,0,a,a);break}}const T=Object.keys(this.executorsByZIndex_).map(Number);T.sort(go);let E,P,M,N,D;for(E=T.length-1;E>=0;--E){const j=T[E].toString();for(M=this.executorsByZIndex_[j],P=Ul.length-1;P>=0;--P)if(y=Ul[P],N=M[y],N!==void 0&&(D=N.executeHitDetection(d,c,i,w,g),D))return D}}getClipCoords(e){const t=this.maxExtent_;if(!t)return null;const i=t[0],r=t[1],s=t[2],o=t[3],a=[i,r,i,o,s,o,s,r];return ba(a,0,8,2,e,a),a}isEmpty(){return sc(this.executorsByZIndex_)}execute(e,t,i,r,s,o,a){const c=Object.keys(this.executorsByZIndex_).map(Number);c.sort(a?U5:go),o=o||Ul;const h=Ul.length;for(let d=0,g=c.length;d<g;++d){const m=c[d].toString(),y=this.executorsByZIndex_[m];for(let w=0,T=o.length;w<T;++w){const E=o[w],P=y[E];if(P!==void 0){const M=a===null?void 0:P.getZIndexContext(),N=M?M.getContext():e,D=this.maxExtent_&&E!=="Image"&&E!=="Text";if(D&&(N.save(),this.clip(N,i)),!M||E==="Text"||E==="Image"?P.execute(N,t,i,r,s,a):M.pushFunction(j=>P.execute(j,t,i,r,s,a)),D&&N.restore(),M){M.offset();const j=c[d]*h+Ul.indexOf(E);this.deferredZIndexContexts_[j]||(this.deferredZIndexContexts_[j]=[]),this.deferredZIndexContexts_[j].push(M)}}}}this.renderedContext_=e}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const e=this.deferredZIndexContexts_,t=Object.keys(e).map(Number).sort(go);for(let i=0,r=t.length;i<r;++i)e[t[i]].forEach(s=>{s.draw(this.renderedContext_),s.clear()}),e[t[i]].length=0}}const P1={};function oV(n){if(P1[n]!==void 0)return P1[n];const e=n*2+1,t=n*n,i=new Array(t+1);for(let s=0;s<=n;++s)for(let o=0;o<=n;++o){const a=s*s+o*o;if(a>t)break;let c=i[a];c||(c=[],i[a]=c),c.push(((n+s)*e+(n+o))*4+3),s>0&&c.push(((n-s)*e+(n+o))*4+3),o>0&&(c.push(((n+s)*e+(n-o))*4+3),s>0&&c.push(((n-s)*e+(n-o))*4+3))}const r=[];for(let s=0,o=i.length;s<o;++s)i[s]&&r.push(...i[s]);return P1[n]=r,r}function qR(n,e,t,i){return t!==void 0&&i!==void 0?[t/n,i/e]:t!==void 0?t/n:i!==void 0?i/e:1}let G0=class v4 extends q_{constructor(e){e=e||{};const t=e.opacity!==void 0?e.opacity:1,i=e.rotation!==void 0?e.rotation:0,r=e.scale!==void 0?e.scale:1,s=e.rotateWithView!==void 0?e.rotateWithView:!1;super({opacity:t,rotation:i,scale:r,displacement:e.displacement!==void 0?e.displacement:[0,0],rotateWithView:s,declutterMode:e.declutterMode}),this.anchor_=e.anchor!==void 0?e.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=e.anchorOrigin!==void 0?e.anchorOrigin:"top-left",this.anchorXUnits_=e.anchorXUnits!==void 0?e.anchorXUnits:"fraction",this.anchorYUnits_=e.anchorYUnits!==void 0?e.anchorYUnits:"fraction",this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null;const o=e.img!==void 0?e.img:null;let a=e.src;yt(!(a!==void 0&&o),"`image` and `src` cannot be provided at the same time"),(a===void 0||a.length===0)&&o&&(a=o.src||ut(o)),yt(a!==void 0&&a.length>0,"A defined and non-empty `src` or `image` must be provided"),yt(!((e.width!==void 0||e.height!==void 0)&&e.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let c;if(e.src!==void 0?c=Ke.IDLE:o!==void 0&&("complete"in o?o.complete?c=o.src?Ke.LOADED:Ke.IDLE:c=Ke.LOADING:c=Ke.LOADED),this.color_=e.color!==void 0?yh(e.color):null,this.iconImage_=k0(o,a,this.crossOrigin_,c,this.color_),this.offset_=e.offset!==void 0?e.offset:[0,0],this.offsetOrigin_=e.offsetOrigin!==void 0?e.offsetOrigin:"top-left",this.origin_=null,this.size_=e.size!==void 0?e.size:null,this.initialOptions_,e.width!==void 0||e.height!==void 0){let h,d;if(e.size)[h,d]=e.size;else{const g=this.getImage(1);if(g.width&&g.height)h=g.width,d=g.height;else if(g instanceof HTMLImageElement){this.initialOptions_=e;const m=()=>{if(this.unlistenImageChange(m),!this.initialOptions_)return;const y=this.iconImage_.getSize();this.setScale(qR(y[0],y[1],e.width,e.height))};this.listenImageChange(m);return}}h!==void 0&&this.setScale(qR(h,d,e.width,e.height))}}clone(){let e,t,i;return this.initialOptions_?(t=this.initialOptions_.width,i=this.initialOptions_.height):(e=this.getScale(),e=Array.isArray(e)?e.slice():e),new v4({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:e,width:t,height:i,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let e=this.normalizedAnchor_;if(!e){e=this.anchor_;const r=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!r)return null;e=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(e[0]*=r[0]),this.anchorYUnits_=="fraction"&&(e[1]*=r[1])}if(this.anchorOrigin_!="top-left"){if(!r)return null;e===this.anchor_&&(e=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(e[0]=-e[0]+r[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(e[1]=-e[1]+r[1])}this.normalizedAnchor_=e}const t=this.getDisplacement(),i=this.getScaleArray();return[e[0]-t[0]/i[0],e[1]+t[1]/i[1]]}setAnchor(e){this.anchor_=e,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(e){return this.iconImage_.getImage(e)}getPixelRatio(e){return this.iconImage_.getPixelRatio(e)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let e=this.offset_;if(this.offsetOrigin_!="top-left"){const t=this.getSize(),i=this.iconImage_.getSize();if(!t||!i)return null;e=e.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(e[0]=i[0]-t[0]-e[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(e[1]=i[1]-t[1]-e[1])}return this.origin_=e,this.origin_}getSrc(){return this.iconImage_.getSrc()}setSrc(e){this.iconImage_=k0(null,e,this.crossOrigin_,Ke.IDLE,this.color_)}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const e=this.getScaleArray();if(this.size_)return this.size_[0]*e[0];if(this.iconImage_.getImageState()==Ke.LOADED)return this.iconImage_.getSize()[0]*e[0]}getHeight(){const e=this.getScaleArray();if(this.size_)return this.size_[1]*e[1];if(this.iconImage_.getImageState()==Ke.LOADED)return this.iconImage_.getSize()[1]*e[1]}setScale(e){delete this.initialOptions_,super.setScale(e)}listenImageChange(e){this.iconImage_.addEventListener(Qe.CHANGE,e)}load(){this.iconImage_.load()}unlistenImageChange(e){this.iconImage_.removeEventListener(Qe.CHANGE,e)}ready(){return this.iconImage_.ready()}};const Is=.5;function aV(n,e,t,i,r,s,o,a,c){const h=r,d=n[0]*Is,g=n[1]*Is,m=En(d,g);m.imageSmoothingEnabled=!1;const y=m.canvas,w=new E8(m,Is,r,null,o,a,null),T=t.length,E=Math.floor((256*256*256-1)/T),P={};for(let N=1;N<=T;++N){const D=t[N-1],j=D.getStyleFunction()||i;if(!j)continue;let W=j(D,s);if(!W)continue;Array.isArray(W)||(W=[W]);const A=(N*E).toString(16).padStart(7,"#00000");for(let k=0,U=W.length;k<U;++k){const B=W[k],z=B.getGeometryFunction()(D);if(!z||!Ni(h,z.getExtent()))continue;const O=B.clone(),oe=O.getFill();oe&&oe.setColor(A);const Te=O.getStroke();Te&&(Te.setColor(A),Te.setLineDash(null)),O.setText(void 0);const we=B.getImage();if(we){const K=we.getImageSize();if(!K)continue;const V=En(K[0],K[1],void 0,{alpha:!1}),I=V.canvas;V.fillStyle=A,V.fillRect(0,0,I.width,I.height),O.setImage(new G0({img:I,anchor:we.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:we.getOrigin(),opacity:1,size:we.getSize(),scale:we.getScale(),rotation:we.getRotation(),rotateWithView:we.getRotateWithView()}))}const _e=O.getZIndex()||0;let Q=P[_e];Q||(Q={},P[_e]=Q,Q.Polygon=[],Q.Circle=[],Q.LineString=[],Q.Point=[]);const ce=z.getType();if(ce==="GeometryCollection"){const K=z.getGeometriesArrayRecursive();for(let V=0,I=K.length;V<I;++V){const de=K[V];Q[de.getType().replace("Multi","")].push(de,O)}}else Q[ce.replace("Multi","")].push(z,O)}}const M=Object.keys(P).map(Number).sort(go);for(let N=0,D=M.length;N<D;++N){const j=P[M[N]];for(const W in j){const L=j[W];for(let A=0,k=L.length;A<k;A+=2){w.setStyle(L[A+1]);for(let U=0,B=e.length;U<B;++U)w.setTransform(e[U]),w.drawGeometry(L[A])}}}return m.getImageData(0,0,y.width,y.height)}function lV(n,e,t){const i=[];if(t){const r=Math.floor(Math.round(n[0])*Is),s=Math.floor(Math.round(n[1])*Is),o=(Dt(r,0,t.width-1)+Dt(s,0,t.height-1)*t.width)*4,a=t.data[o],c=t.data[o+1],d=t.data[o+2]+256*(c+256*a),g=Math.floor((256*256*256-1)/e.length);d&&d%g===0&&i.push(e[d/g-1])}return i}class E4 extends Ao{constructor(e,t,i,r){super(e),this.inversePixelTransform=t,this.frameState=i,this.context=r}}const cV=5;class uV extends Lg{constructor(e){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=e,this.staleKeys_=new Array,this.maxStaleKeys=cV}getStaleKeys(){return this.staleKeys_}prependStaleKey(e){this.staleKeys_.unshift(e),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(e){return We()}getData(e){return null}prepareFrame(e){return We()}renderFrame(e,t){return We()}forEachFeatureAtCoordinate(e,t,i,r,s){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(e){const t=e.target;(t.getState()===Ke.LOADED||t.getState()===Ke.ERROR)&&this.renderIfReadyAndVisible()}loadImage(e){let t=e.getState();return t!=Ke.LOADED&&t!=Ke.ERROR&&e.addEventListener(Qe.CHANGE,this.boundHandleImageChange_),t==Ke.IDLE&&(e.load(),t=e.getState()),t==Ke.LOADED}renderIfReadyAndVisible(){const e=this.getLayer();e&&e.getVisible()&&e.getSourceState()==="ready"&&e.changed()}renderDeferred(e){}disposeInternal(){delete this.layer_,super.disposeInternal()}}const YR=[];let Du=null;function hV(){Du=En(1,1,void 0,{willReadFrequently:!0})}class w4 extends uV{constructor(e){super(e),this.container=null,this.renderedResolution,this.tempTransform=Zr(),this.pixelTransform=Zr(),this.inversePixelTransform=Zr(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(e,t,i){Du||hV(),Du.clearRect(0,0,1,1);let r;try{Du.drawImage(e,t,i,1,1,0,0,1,1),r=Du.getImageData(0,0,1,1).data}catch{return Du=null,null}return r}getBackground(e){let i=this.getLayer().getBackground();return typeof i=="function"&&(i=i(e.viewState.resolution)),i||void 0}useContainer(e,t,i){const r=this.getLayer().getClassName();let s,o;if(e&&e.className===r&&(!i||e&&e.style.backgroundColor&&Za(yh(e.style.backgroundColor),yh(i)))){const a=e.firstElementChild;Ta(a)&&(o=a.getContext("2d"))}if(o&&L6(o.canvas.style.transform,t)?(this.container=e,this.context=o,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){s=er?Qb():document.createElement("div"),s.className=r;let a=s.style;a.position="absolute",a.width="100%",a.height="100%",o=En();const c=o.canvas;s.appendChild(c),a=c.style,a.position="absolute",a.left="0",a.transformOrigin="top left",this.container=s,this.context=o}!this.containerReused&&i&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=i)}clipUnrotated(e,t,i){const r=Ac(i),s=G_(i),o=F_(i),a=V_(i);Mn(t.coordinateToPixelTransform,r),Mn(t.coordinateToPixelTransform,s),Mn(t.coordinateToPixelTransform,o),Mn(t.coordinateToPixelTransform,a);const c=this.inversePixelTransform;Mn(c,r),Mn(c,s),Mn(c,o),Mn(c,a),e.save(),e.beginPath(),e.moveTo(Math.round(r[0]),Math.round(r[1])),e.lineTo(Math.round(s[0]),Math.round(s[1])),e.lineTo(Math.round(o[0]),Math.round(o[1])),e.lineTo(Math.round(a[0]),Math.round(a[1])),e.clip()}prepareContainer(e,t){const i=e.extent,r=e.viewState.resolution,s=e.viewState.rotation,o=e.pixelRatio,a=Math.round(ht(i)/r*o),c=Math.round(oi(i)/r*o);Eo(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/o,1/o,s,-a/2,-c/2),Gb(this.inversePixelTransform,this.pixelTransform);const h=k6(this.pixelTransform);if(this.useContainer(t,h,this.getBackground(e)),!this.containerReused){const d=this.context.canvas;d.width!=a||d.height!=c?(d.width=a,d.height=c):this.context.clearRect(0,0,a,c),h!==d.style.transform&&(d.style.transform=h)}}dispatchRenderEvent_(e,t,i){const r=this.getLayer();if(r.hasListener(e)){const s=new E4(e,this.inversePixelTransform,i,t);r.dispatchEvent(s)}}preRender(e,t){this.frameState=t,!t.declutter&&this.dispatchRenderEvent_(Pr.PRERENDER,e,t)}postRender(e,t){t.declutter||this.dispatchRenderEvent_(Pr.POSTRENDER,e,t)}renderDeferredInternal(e){}getRenderContext(e){return e.declutter&&!this.deferredContext_&&(this.deferredContext_=new _4),e.declutter?this.deferredContext_.getContext():this.context}renderDeferred(e){e.declutter&&(this.dispatchRenderEvent_(Pr.PRERENDER,this.context,e),e.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(e),this.dispatchRenderEvent_(Pr.POSTRENDER,this.context,e))}getRenderTransform(e,t,i,r,s,o,a){const c=s/2,h=o/2,d=r/t,g=-d,m=-e[0]+a,y=-e[1];return Eo(this.tempTransform,c,h,d,g,-i,m,y)}disposeInternal(){delete this.frameState,super.disposeInternal()}}class dV extends w4{constructor(e){super(e),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipped_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=ir(),this.wrappedRenderedExtent_=ir(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(e,t,i){const r=t.extent,s=t.viewState,o=s.center,a=s.resolution,c=s.projection,h=s.rotation,d=c.getExtent(),g=this.getLayer().getSource(),m=this.getLayer().getDeclutter(),y=t.pixelRatio,w=t.viewHints,T=!(w[ni.ANIMATING]||w[ni.INTERACTING]),E=this.context,P=Math.round(ht(r)/a*y),M=Math.round(oi(r)/a*y),N=g.getWrapX()&&c.canWrapX(),D=N?ht(d):null,j=N?Math.ceil((r[2]-d[2])/D)+1:1;let W=N?Math.floor((r[0]-d[0])/D):0;do{let L=this.getRenderTransform(o,a,0,y,P,M,W*D);t.declutter&&(L=L.slice(0)),e.execute(E,[E.canvas.width,E.canvas.height],L,h,T,i===void 0?Ul:i?y4:rV,i?m&&t.declutter[m]:void 0)}while(++W<j)}setDrawContext_(){this.opacity_!==1&&(this.targetContext_=this.context,this.context=En(this.context.canvas.width,this.context.canvas.height,YR))}resetDrawContext_(){if(this.opacity_!==1&&this.targetContext_){const e=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=e,H_(this.context),YR.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(e){!this.replayGroup_||!this.getLayer().getDeclutter()||this.renderWorlds(this.replayGroup_,e,!0)}renderDeferredInternal(e){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}renderFrame(e,t){const i=e.layerStatesArray[e.layerIndex];this.opacity_=i.opacity;const r=e.viewState;this.prepareContainer(e,t);const s=this.context,o=this.replayGroup_;let a=o&&!o.isEmpty();if(!a&&!(this.getLayer().hasListener(Pr.PRERENDER)||this.getLayer().hasListener(Pr.POSTRENDER)))return this.container;if(this.setDrawContext_(),this.preRender(s,e),r.projection,this.clipped_=!1,a&&i.extent&&this.clipping){const c=Sa(i.extent);a=Ni(c,e.extent),this.clipped_=a&&!ef(c,e.extent),this.clipped_&&this.clipUnrotated(s,e,c)}return a&&this.renderWorlds(o,e,this.getLayer().getDeclutter()?!1:void 0),!e.declutter&&this.clipped_&&s.restore(),this.postRender(s,e),this.renderedRotation_!==r.rotation&&(this.renderedRotation_=r.rotation,this.hitDetectionImageData_=null),e.declutter||this.resetDrawContext_(),this.container}getFeatures(e){return new Promise(t=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const i=this.frameState.size.slice(),r=this.renderedCenter_,s=this.renderedResolution_,o=this.renderedRotation_,a=this.renderedProjection_,c=this.wrappedRenderedExtent_,h=this.getLayer(),d=[],g=i[0]*Is,m=i[1]*Is;d.push(this.getRenderTransform(r,s,o,Is,g,m,0).slice());const y=h.getSource(),w=a.getExtent();if(y.getWrapX()&&a.canWrapX()&&!ef(w,c)){let T=c[0];const E=ht(w);let P=0,M;for(;T<w[0];)--P,M=E*P,d.push(this.getRenderTransform(r,s,o,Is,g,m,M).slice()),T+=E;for(P=0,T=c[2];T>w[2];)++P,M=E*P,d.push(this.getRenderTransform(r,s,o,Is,g,m,M).slice()),T-=E}this.hitDetectionImageData_=aV(i,d,this.renderedFeatures_,h.getStyleFunction(),c,s,o,NR(s,this.renderedPixelRatio_))}t(lV(e,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(e,t,i,r,s){if(!this.replayGroup_)return;const o=t.viewState.resolution,a=t.viewState.rotation,c=this.getLayer(),h={},d=function(m,y,w){const T=ut(m),E=h[T];if(E){if(E!==!0&&w<E.distanceSq){if(w===0)return h[T]=!0,s.splice(s.lastIndexOf(E),1),r(m,c,y);E.geometry=y,E.distanceSq=w}}else{if(w===0)return h[T]=!0,r(m,c,y);s.push(h[T]={feature:m,layer:c,geometry:y,distanceSq:w,callback:r})}},g=this.getLayer().getDeclutter();return this.replayGroup_.forEachFeatureAtCoordinate(e,o,a,i,d,g?t.declutter?.[g]?.all().map(m=>m.value):null)}handleFontsChanged(){const e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}prepareFrame(e){const t=this.getLayer(),i=t.getSource();if(!i)return!1;const r=e.viewHints[ni.ANIMATING],s=e.viewHints[ni.INTERACTING],o=t.getUpdateWhileAnimating(),a=t.getUpdateWhileInteracting();if(this.ready&&!o&&r||!a&&s)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const c=e.extent,h=e.viewState,d=h.projection,g=h.resolution,m=e.pixelRatio,y=t.getRevision(),w=t.getRenderBuffer();let T=t.getRenderOrder();T===void 0&&(T=x8);const E=h.center.slice(),P=$f(c,w*g),M=P.slice(),N=[P.slice()],D=d.getExtent();if(i.getWrapX()&&d.canWrapX()&&!ef(D,e.extent)){const oe=ht(D),Te=Math.max(ht(P)/2,oe);P[0]=D[0]-Te,P[2]=D[2]+Te,Cb(E,d);const we=Rb(N[0],d);we[0]<D[0]&&we[2]<D[2]?N.push([we[0]+oe,we[1],we[2]+oe,we[3]]):we[0]>D[0]&&we[2]>D[2]&&N.push([we[0]-oe,we[1],we[2]-oe,we[3]])}if(this.ready&&this.renderedResolution_==g&&this.renderedRevision_==y&&this.renderedRenderOrder_==T&&this.renderedFrameDeclutter_===!!e.declutter&&ef(this.wrappedRenderedExtent_,P))return Za(this.renderedExtent_,M)||(this.hitDetectionImageData_=null,this.renderedExtent_=M),this.renderedCenter_=E,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const j=new J8(o4(g,m),P,g,m);let W;for(let oe=0,Te=N.length;oe<Te;++oe)i.loadFeatures(N[oe],g,d);const L=NR(g,m);let A=!0;const k=(oe,Te)=>{let we;const _e=oe.getStyleFunction()||t.getStyleFunction();if(_e&&(we=_e(oe,g)),we){const Q=this.renderFeature(oe,L,we,j,W,this.getLayer().getDeclutter(),Te);A=A&&!Q}},U=Fb(P),B=i.getFeaturesInExtent(U);T&&B.sort(T);for(let oe=0,Te=B.length;oe<Te;++oe)k(B[oe],oe);this.renderedFeatures_=B,this.ready=A;const z=j.finish(),O=new sV(P,g,m,i.getOverlaps(),z,t.getRenderBuffer(),!!e.declutter);return this.renderedResolution_=g,this.renderedRevision_=y,this.renderedRenderOrder_=T,this.renderedFrameDeclutter_=!!e.declutter,this.renderedExtent_=M,this.wrappedRenderedExtent_=P,this.renderedCenter_=E,this.renderedProjection_=d,this.renderedPixelRatio_=m,this.replayGroup_=O,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(e,t,i,r,s,o,a){if(!i)return!1;let c=!1;if(Array.isArray(i))for(let h=0,d=i.length;h<d;++h)c=OR(r,e,i[h],t,this.boundHandleStyleImageChange_,s,o,a)||c;else c=OR(r,e,i,t,this.boundHandleStyleImageChange_,s,o,a);return c}}let bc=0;const pi=1<<bc++,st=1<<bc++,Li=1<<bc++,Kr=1<<bc++,hc=1<<bc++,rf=1<<bc++,kp=Math.pow(2,bc)-1,Lx={[pi]:"boolean",[st]:"number",[Li]:"string",[Kr]:"color",[hc]:"number[]",[rf]:"size"},fV=Object.keys(Lx).map(Number).sort(go);function gV(n){return n in Lx}function sf(n){const e=[];for(const t of fV)of(n,t)&&e.push(Lx[t]);return e.length===0?"untyped":e.length<3?e.join(" or "):e.slice(0,-1).join(", ")+", or "+e[e.length-1]}function of(n,e){return(n&e)===e}function aa(n,e){return n===e}class yn{constructor(e,t){if(!gV(e))throw new Error(`literal expressions must have a specific type, got ${sf(e)}`);this.type=e,this.value=t}}class mV{constructor(e,t,...i){this.type=e,this.operator=t,this.args=i}}function x4(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,mapState:!1}}function Hn(n,e,t){switch(typeof n){case"boolean":{if(aa(e,Li))return new yn(Li,n?"true":"false");if(!of(e,pi))throw new Error(`got a boolean, but expected ${sf(e)}`);return new yn(pi,n)}case"number":{if(aa(e,rf))return new yn(rf,Vi(n));if(aa(e,pi))return new yn(pi,!!n);if(aa(e,Li))return new yn(Li,n.toString());if(!of(e,st))throw new Error(`got a number, but expected ${sf(e)}`);return new yn(st,n)}case"string":{if(aa(e,Kr))return new yn(Kr,Tx(n));if(aa(e,pi))return new yn(pi,!!n);if(!of(e,Li))throw new Error(`got a string, but expected ${sf(e)}`);return new yn(Li,n)}}if(!Array.isArray(n))throw new Error("expression must be an array or a primitive value");if(n.length===0)throw new Error("empty expression");if(typeof n[0]=="string")return RV(n,e,t);for(const i of n)if(typeof i!="number")throw new Error("expected an array of numbers");if(aa(e,rf)){if(n.length!==2)throw new Error(`expected an array of two values for a size, got ${n.length}`);return new yn(rf,n)}if(aa(e,Kr)){if(n.length===3)return new yn(Kr,[...n,1]);if(n.length===4)return new yn(Kr,n);throw new Error(`expected an array of 3 or 4 values for a color, got ${n.length}`)}if(!of(e,hc))throw new Error(`got an array of numbers, but expected ${sf(e)}`);return new yn(hc,n)}const le={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",LineMetric:"line-metric",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string",Has:"has"},pV={[le.Get]:$e(Ze(1,1/0),XR),[le.Var]:$e(Ze(1,1),_V),[le.Has]:$e(Ze(1,1/0),XR),[le.Id]:$e(yV,Iu),[le.Concat]:$e(Ze(2,1/0),gt(Li)),[le.GeometryType]:$e(vV,Iu),[le.LineMetric]:$e(Iu),[le.Resolution]:$e(A1,Iu),[le.Zoom]:$e(A1,Iu),[le.Time]:$e(A1,Iu),[le.Any]:$e(Ze(2,1/0),gt(pi)),[le.All]:$e(Ze(2,1/0),gt(pi)),[le.Not]:$e(Ze(1,1),gt(pi)),[le.Equal]:$e(Ze(2,2),gt(kp)),[le.NotEqual]:$e(Ze(2,2),gt(kp)),[le.GreaterThan]:$e(Ze(2,2),gt(st)),[le.GreaterThanOrEqualTo]:$e(Ze(2,2),gt(st)),[le.LessThan]:$e(Ze(2,2),gt(st)),[le.LessThanOrEqualTo]:$e(Ze(2,2),gt(st)),[le.Multiply]:$e(Ze(2,1/0),QR),[le.Coalesce]:$e(Ze(2,1/0),QR),[le.Divide]:$e(Ze(2,2),gt(st)),[le.Add]:$e(Ze(2,1/0),gt(st)),[le.Subtract]:$e(Ze(2,2),gt(st)),[le.Clamp]:$e(Ze(3,3),gt(st)),[le.Mod]:$e(Ze(2,2),gt(st)),[le.Pow]:$e(Ze(2,2),gt(st)),[le.Abs]:$e(Ze(1,1),gt(st)),[le.Floor]:$e(Ze(1,1),gt(st)),[le.Ceil]:$e(Ze(1,1),gt(st)),[le.Round]:$e(Ze(1,1),gt(st)),[le.Sin]:$e(Ze(1,1),gt(st)),[le.Cos]:$e(Ze(1,1),gt(st)),[le.Atan]:$e(Ze(1,2),gt(st)),[le.Sqrt]:$e(Ze(1,1),gt(st)),[le.Match]:$e(Ze(4,1/0),ZR,wV),[le.Between]:$e(Ze(3,3),gt(st)),[le.Interpolate]:$e(Ze(6,1/0),ZR,xV),[le.Case]:$e(Ze(3,1/0),EV,SV),[le.In]:$e(Ze(2,2),IV),[le.Number]:$e(Ze(1,1/0),gt(kp)),[le.String]:$e(Ze(1,1/0),gt(kp)),[le.Array]:$e(Ze(1,1/0),gt(st)),[le.Color]:$e(Ze(1,4),gt(st)),[le.Band]:$e(Ze(1,3),gt(st)),[le.Palette]:$e(Ze(2,2),TV),[le.ToString]:$e(Ze(1,1),gt(pi|st|Li|Kr))};function XR(n,e,t){const i=n.length-1,r=new Array(i);for(let s=0;s<i;++s){const o=n[s+1];switch(typeof o){case"number":{r[s]=new yn(st,o);break}case"string":{r[s]=new yn(Li,o);break}default:throw new Error(`expected a string key or numeric array index for a get operation, got ${o}`)}s===0&&t.properties.add(String(o))}return r}function _V(n,e,t){const i=n[1];if(typeof i!="string")throw new Error("expected a string argument for var operation");return t.variables.add(i),[new yn(Li,i)]}function yV(n,e,t){t.featureId=!0}function vV(n,e,t){t.geometryType=!0}function A1(n,e,t){t.mapState=!0}function Iu(n,e,t){const i=n[0];if(n.length!==1)throw new Error(`expected no arguments for ${i} operation`);return[]}function Ze(n,e){return function(t,i,r){const s=t[0],o=t.length-1;if(n===e){if(o!==n){const a=n===1?"":"s";throw new Error(`expected ${n} argument${a} for ${s}, got ${o}`)}}else if(o<n||o>e){const a=e===1/0?`${n} or more`:`${n} to ${e}`;throw new Error(`expected ${a} arguments for ${s}, got ${o}`)}}}function QR(n,e,t){const i=n.length-1,r=new Array(i);for(let s=0;s<i;++s){const o=Hn(n[s+1],e,t);r[s]=o}return r}function gt(n){return function(e,t,i){const r=e.length-1,s=new Array(r);for(let o=0;o<r;++o){const a=Hn(e[o+1],n,i);s[o]=a}return s}}function EV(n,e,t){const i=n[0],r=n.length-1;if(r%2===0)throw new Error(`expected an odd number of arguments for ${i}, got ${r} instead`)}function ZR(n,e,t){const i=n[0],r=n.length-1;if(r%2===1)throw new Error(`expected an even number of arguments for operation ${i}, got ${r} instead`)}function wV(n,e,t){const i=n.length-1,r=Li|st|pi,s=Hn(n[1],r,t),o=Hn(n[n.length-1],e,t),a=new Array(i-2);for(let c=0;c<i-2;c+=2){try{const h=Hn(n[c+2],s.type,t);a[c]=h}catch(h){throw new Error(`failed to parse argument ${c+1} of match expression: ${h.message}`)}try{const h=Hn(n[c+3],o.type,t);a[c+1]=h}catch(h){throw new Error(`failed to parse argument ${c+2} of match expression: ${h.message}`)}}return[s,...a,o]}function xV(n,e,t){const i=n[1];let r;switch(i[0]){case"linear":r=1;break;case"exponential":const c=i[1];if(typeof c!="number"||c<=0)throw new Error(`expected a number base for exponential interpolation, got ${JSON.stringify(c)} instead`);r=c;break;default:throw new Error(`invalid interpolation type: ${JSON.stringify(i)}`)}const s=new yn(st,r);let o;try{o=Hn(n[2],st,t)}catch(c){throw new Error(`failed to parse argument 1 in interpolate expression: ${c.message}`)}const a=new Array(n.length-3);for(let c=0;c<a.length;c+=2){try{const h=Hn(n[c+3],st,t);a[c]=h}catch(h){throw new Error(`failed to parse argument ${c+2} for interpolate expression: ${h.message}`)}try{const h=Hn(n[c+4],e,t);a[c+1]=h}catch(h){throw new Error(`failed to parse argument ${c+3} for interpolate expression: ${h.message}`)}}return[s,o,...a]}function SV(n,e,t){const i=Hn(n[n.length-1],e,t),r=new Array(n.length-1);for(let s=0;s<r.length-1;s+=2){try{const o=Hn(n[s+1],pi,t);r[s]=o}catch(o){throw new Error(`failed to parse argument ${s} of case expression: ${o.message}`)}try{const o=Hn(n[s+2],i.type,t);r[s+1]=o}catch(o){throw new Error(`failed to parse argument ${s+1} of case expression: ${o.message}`)}}return r[r.length-1]=i,r}function IV(n,e,t){let i=n[2];if(!Array.isArray(i))throw new Error('the second argument for the "in" operator must be an array');let r;if(typeof i[0]=="string"){if(i[0]!=="literal")throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(i[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');i=i[1],r=Li}else r=st;const s=new Array(i.length);for(let a=0;a<s.length;a++)try{const c=Hn(i[a],r,t);s[a]=c}catch(c){throw new Error(`failed to parse haystack item ${a} for "in" expression: ${c.message}`)}return[Hn(n[1],r,t),...s]}function TV(n,e,t){let i;try{i=Hn(n[1],st,t)}catch(o){throw new Error(`failed to parse first argument in palette expression: ${o.message}`)}const r=n[2];if(!Array.isArray(r))throw new Error("the second argument of palette must be an array");const s=new Array(r.length);for(let o=0;o<s.length;o++){let a;try{a=Hn(r[o],Kr,t)}catch(c){throw new Error(`failed to parse color at index ${o} in palette expression: ${c.message}`)}if(!(a instanceof yn))throw new Error(`the palette color at index ${o} must be a literal value`);s[o]=a}return[i,...s]}function $e(...n){return function(e,t,i){const r=e[0];let s;for(let o=0;o<n.length;o++){const a=n[o](e,t,i);if(o==n.length-1){if(!a)throw new Error("expected last argument validator to return the parsed args");s=a}}return new mV(t,r,...s)}}function RV(n,e,t){const i=n[0],r=pV[i];if(!r)throw new Error(`unknown operator: ${i}`);return r(n,e,t)}function S4(n){if(!n)return"";const e=n.getType();switch(e){case"Point":case"LineString":case"Polygon":return e;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return e.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return S4(n.getGeometries()[0]);default:return""}}function I4(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function Co(n,e,t){const i=Hn(n,e,t);return es(i)}function es(n,e){if(n instanceof yn){if(n.type===Kr&&typeof n.value=="string"){const i=Tx(n.value);return function(){return i}}return function(){return n.value}}const t=n.operator;switch(t){case le.Number:case le.String:case le.Coalesce:return PV(n);case le.Get:case le.Var:case le.Has:return AV(n);case le.Id:return i=>i.featureId;case le.GeometryType:return i=>i.geometryType;case le.Concat:{const i=n.args.map(r=>es(r));return r=>"".concat(...i.map(s=>s(r).toString()))}case le.Resolution:return i=>i.resolution;case le.Any:case le.All:case le.Between:case le.In:case le.Not:return MV(n);case le.Equal:case le.NotEqual:case le.LessThan:case le.LessThanOrEqualTo:case le.GreaterThan:case le.GreaterThanOrEqualTo:return CV(n);case le.Multiply:case le.Divide:case le.Add:case le.Subtract:case le.Clamp:case le.Mod:case le.Pow:case le.Abs:case le.Floor:case le.Ceil:case le.Round:case le.Sin:case le.Cos:case le.Atan:case le.Sqrt:return bV(n);case le.Case:return kV(n);case le.Match:return LV(n);case le.Interpolate:return NV(n);case le.ToString:return OV(n);default:throw new Error(`Unsupported operator ${t}`)}}function PV(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=es(n.args[s]);switch(t){case le.Coalesce:return s=>{for(let o=0;o<i;++o){const a=r[o](s);if(typeof a<"u"&&a!==null)return a}throw new Error("Expected one of the values to be non-null")};case le.Number:case le.String:return s=>{for(let o=0;o<i;++o){const a=r[o](s);if(typeof a===t)return a}throw new Error(`Expected one of the values to be a ${t}`)};default:throw new Error(`Unsupported assertion operator ${t}`)}}function AV(n,e){const i=n.args[0].value;switch(n.operator){case le.Get:return r=>{const s=n.args;let o=r.properties[i];for(let a=1,c=s.length;a<c;++a){const d=s[a].value;o=o[d]}return o};case le.Var:return r=>r.variables[i];case le.Has:return r=>{const s=n.args;if(!(i in r.properties))return!1;let o=r.properties[i];for(let a=1,c=s.length;a<c;++a){const d=s[a].value;if(!o||!Object.hasOwn(o,d))return!1;o=o[d]}return!0};default:throw new Error(`Unsupported accessor operator ${n.operator}`)}}function CV(n,e){const t=n.operator,i=es(n.args[0]),r=es(n.args[1]);switch(t){case le.Equal:return s=>i(s)===r(s);case le.NotEqual:return s=>i(s)!==r(s);case le.LessThan:return s=>i(s)<r(s);case le.LessThanOrEqualTo:return s=>i(s)<=r(s);case le.GreaterThan:return s=>i(s)>r(s);case le.GreaterThanOrEqualTo:return s=>i(s)>=r(s);default:throw new Error(`Unsupported comparison operator ${t}`)}}function MV(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=es(n.args[s]);switch(t){case le.Any:return s=>{for(let o=0;o<i;++o)if(r[o](s))return!0;return!1};case le.All:return s=>{for(let o=0;o<i;++o)if(!r[o](s))return!1;return!0};case le.Between:return s=>{const o=r[0](s),a=r[1](s),c=r[2](s);return o>=a&&o<=c};case le.In:return s=>{const o=r[0](s);for(let a=1;a<i;++a)if(o===r[a](s))return!0;return!1};case le.Not:return s=>!r[0](s);default:throw new Error(`Unsupported logical operator ${t}`)}}function bV(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=es(n.args[s]);switch(t){case le.Multiply:return s=>{let o=1;for(let a=0;a<i;++a)o*=r[a](s);return o};case le.Divide:return s=>r[0](s)/r[1](s);case le.Add:return s=>{let o=0;for(let a=0;a<i;++a)o+=r[a](s);return o};case le.Subtract:return s=>r[0](s)-r[1](s);case le.Clamp:return s=>{const o=r[0](s),a=r[1](s);if(o<a)return a;const c=r[2](s);return o>c?c:o};case le.Mod:return s=>r[0](s)%r[1](s);case le.Pow:return s=>Math.pow(r[0](s),r[1](s));case le.Abs:return s=>Math.abs(r[0](s));case le.Floor:return s=>Math.floor(r[0](s));case le.Ceil:return s=>Math.ceil(r[0](s));case le.Round:return s=>Math.round(r[0](s));case le.Sin:return s=>Math.sin(r[0](s));case le.Cos:return s=>Math.cos(r[0](s));case le.Atan:return i===2?s=>Math.atan2(r[0](s),r[1](s)):s=>Math.atan(r[0](s));case le.Sqrt:return s=>Math.sqrt(r[0](s));default:throw new Error(`Unsupported numeric operator ${t}`)}}function kV(n,e){const t=n.args.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=es(n.args[r]);return r=>{for(let s=0;s<t-1;s+=2)if(i[s](r))return i[s+1](r);return i[t-1](r)}}function LV(n,e){const t=n.args.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=es(n.args[r]);return r=>{const s=i[0](r);for(let o=1;o<t-1;o+=2)if(s===i[o](r))return i[o+1](r);return i[t-1](r)}}function NV(n,e){const t=n.args.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=es(n.args[r]);return r=>{const s=i[0](r),o=i[1](r);let a,c;for(let h=2;h<t;h+=2){const d=i[h](r);let g=i[h+1](r);const m=Array.isArray(g);if(m&&(g=o8(g)),d>=o)return h===2?g:m?DV(s,o,a,c,d,g):af(s,o,a,c,d,g);a=d,c=g}return c}}function OV(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=es(n.args[s]);switch(t){case le.ToString:return s=>{const o=r[0](s);return n.args[0].type===Kr?Rx(o):o.toString()};default:throw new Error(`Unsupported convert operator ${t}`)}}function af(n,e,t,i,r,s){const o=r-t;if(o===0)return i;const a=e-t,c=n===1?a/o:(Math.pow(n,a)-1)/(Math.pow(n,o)-1);return i+c*(s-i)}function DV(n,e,t,i,r,s){if(r-t===0)return i;const a=CR(i),c=CR(s);let h=c[2]-a[2];h>180?h-=360:h<-180&&(h+=360);const d=[af(n,e,t,a[0],r,c[0]),af(n,e,t,a[1],r,c[1]),a[2]+af(n,e,t,0,r,h),af(n,e,t,i[3],r,s[3])];return a8(d)}function VV(n){return!0}function FV(n){const e=x4(),t=GV(n,e),i=I4();return function(r,s){if(i.properties=r.getPropertiesInternal(),i.resolution=s,e.featureId){const o=r.getId();o!==void 0?i.featureId=o:i.featureId=null}return e.geometryType&&(i.geometryType=S4(r.getGeometry())),t(i)}}function JR(n){const e=x4(),t=n.length,i=new Array(t);for(let o=0;o<t;++o)i[o]=FE(n[o],e);const r=I4(),s=new Array(t);return function(o,a){if(r.properties=o.getPropertiesInternal(),r.resolution=a,e.featureId){const h=o.getId();h!==void 0?r.featureId=h:r.featureId=null}let c=0;for(let h=0;h<t;++h){const d=i[h](r);d&&(s[c]=d,c+=1)}return s.length=c,s}}function GV(n,e){const t=n.length,i=new Array(t);for(let r=0;r<t;++r){const s=n[r],o="filter"in s?Co(s.filter,pi,e):VV;let a;if(Array.isArray(s.style)){const c=s.style.length;a=new Array(c);for(let h=0;h<c;++h)a[h]=FE(s.style[h],e)}else a=[FE(s.style,e)];i[r]={filter:o,styles:a}}return function(r){const s=[];let o=!1;for(let a=0;a<t;++a){const c=i[a].filter;if(c(r)&&!(n[a].else&&o)){o=!0;for(const h of i[a].styles){const d=h(r);d&&s.push(d)}}}return s}}function FE(n,e){const t=Jf(n,"",e),i=eg(n,"",e),r=jV(n,e),s=UV(n,e),o=Oi(n,"z-index",e);if(!t&&!i&&!r&&!s&&!sc(n))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(n));const a=new ji;return function(c){let h=!0;if(t){const d=t(c);d&&(h=!1),a.setFill(d)}if(i){const d=i(c);d&&(h=!1),a.setStroke(d)}if(r){const d=r(c);d&&(h=!1),a.setText(d)}if(s){const d=s(c);d&&(h=!1),a.setImage(d)}return o&&a.setZIndex(o(c)),h?null:a}}function Jf(n,e,t){let i;if(e+"fill-pattern-src"in n)i=WV(n,e+"fill-",t);else{if(n[e+"fill-color"]==="none")return s=>null;i=Nx(n,e+"fill-color",t)}if(!i)return null;const r=new wo;return function(s){const o=i(s);return o===Ix?null:(r.setColor(o),r)}}function eg(n,e,t){const i=Oi(n,e+"stroke-width",t),r=Nx(n,e+"stroke-color",t);if(!i&&!r)return null;const s=co(n,e+"stroke-line-cap",t),o=co(n,e+"stroke-line-join",t),a=T4(n,e+"stroke-line-dash",t),c=Oi(n,e+"stroke-line-dash-offset",t),h=Oi(n,e+"stroke-miter-limit",t),d=new ka;return function(g){if(r){const m=r(g);if(m===Ix)return null;d.setColor(m)}if(i&&d.setWidth(i(g)),s){const m=s(g);if(m!=="butt"&&m!=="round"&&m!=="square")throw new Error("Expected butt, round, or square line cap");d.setLineCap(m)}if(o){const m=o(g);if(m!=="bevel"&&m!=="round"&&m!=="miter")throw new Error("Expected bevel, round, or miter line join");d.setLineJoin(m)}return a&&d.setLineDash(a(g)),c&&d.setLineDashOffset(c(g)),h&&d.setMiterLimit(h(g)),d}}function jV(n,e){const t="text-",i=co(n,t+"value",e);if(!i)return null;const r=Jf(n,t,e),s=Jf(n,t+"background-",e),o=eg(n,t,e),a=eg(n,t+"background-",e),c=co(n,t+"font",e),h=Oi(n,t+"max-angle",e),d=Oi(n,t+"offset-x",e),g=Oi(n,t+"offset-y",e),m=ih(n,t+"overflow",e),y=co(n,t+"placement",e),w=Oi(n,t+"repeat",e),T=X_(n,t+"scale",e),E=ih(n,t+"rotate-with-view",e),P=Oi(n,t+"rotation",e),M=co(n,t+"align",e),N=co(n,t+"justify",e),D=co(n,t+"baseline",e),j=ih(n,t+"keep-upright",e),W=T4(n,t+"padding",e),L=Q_(n,t+"declutter-mode"),A=new kx({declutterMode:L});return function(k){if(A.setText(i(k)),r&&A.setFill(r(k)),s&&A.setBackgroundFill(s(k)),o&&A.setStroke(o(k)),a&&A.setBackgroundStroke(a(k)),c&&A.setFont(c(k)),h&&A.setMaxAngle(h(k)),d&&A.setOffsetX(d(k)),g&&A.setOffsetY(g(k)),m&&A.setOverflow(m(k)),y){const U=y(k);if(U!=="point"&&U!=="line")throw new Error("Expected point or line for text-placement");A.setPlacement(U)}if(w&&A.setRepeat(w(k)),T&&A.setScale(T(k)),E&&A.setRotateWithView(E(k)),P&&A.setRotation(P(k)),M){const U=M(k);if(U!=="left"&&U!=="center"&&U!=="right"&&U!=="end"&&U!=="start")throw new Error("Expected left, right, center, start, or end for text-align");A.setTextAlign(U)}if(N){const U=N(k);if(U!=="left"&&U!=="right"&&U!=="center")throw new Error("Expected left, right, or center for text-justify");A.setJustify(U)}if(D){const U=D(k);if(U!=="bottom"&&U!=="top"&&U!=="middle"&&U!=="alphabetic"&&U!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");A.setTextBaseline(U)}return W&&A.setPadding(W(k)),j&&A.setKeepUpright(j(k)),A}}function UV(n,e){return"icon-src"in n?BV(n,e):"shape-points"in n?zV(n,e):"circle-radius"in n?$V(n,e):null}function BV(n,e){const t="icon-",i=t+"src",r=R4(n[i],i),s=j0(n,t+"anchor",e),o=X_(n,t+"scale",e),a=Oi(n,t+"opacity",e),c=j0(n,t+"displacement",e),h=Oi(n,t+"rotation",e),d=ih(n,t+"rotate-with-view",e),g=tP(n,t+"anchor-origin"),m=nP(n,t+"anchor-x-units"),y=nP(n,t+"anchor-y-units"),w=YV(n,t+"color"),T=KV(n,t+"cross-origin"),E=qV(n,t+"offset"),P=tP(n,t+"offset-origin"),M=U0(n,t+"width"),N=U0(n,t+"height"),D=HV(n,t+"size"),j=Q_(n,t+"declutter-mode"),W=new G0({src:r,anchorOrigin:g,anchorXUnits:m,anchorYUnits:y,color:w,crossOrigin:T,offset:E,offsetOrigin:P,height:N,width:M,size:D,declutterMode:j});return function(L){return a&&W.setOpacity(a(L)),c&&W.setDisplacement(c(L)),h&&W.setRotation(h(L)),d&&W.setRotateWithView(d(L)),o&&W.setScale(o(L)),s&&W.setAnchor(s(L)),W}}function zV(n,e){const t="shape-",i=t+"points",r=t+"radius",s=GE(n[i],i),o=GE(n[r],r),a=Jf(n,t,e),c=eg(n,t,e),h=X_(n,t+"scale",e),d=j0(n,t+"displacement",e),g=Oi(n,t+"rotation",e),m=ih(n,t+"rotate-with-view",e),y=U0(n,t+"radius2"),w=U0(n,t+"angle"),T=Q_(n,t+"declutter-mode"),E=new Y_({points:s,radius:o,radius2:y,angle:w,declutterMode:T});return function(P){return a&&E.setFill(a(P)),c&&E.setStroke(c(P)),d&&E.setDisplacement(d(P)),g&&E.setRotation(g(P)),m&&E.setRotateWithView(m(P)),h&&E.setScale(h(P)),E}}function $V(n,e){const t="circle-",i=Jf(n,t,e),r=eg(n,t,e),s=Oi(n,t+"radius",e),o=X_(n,t+"scale",e),a=j0(n,t+"displacement",e),c=Oi(n,t+"rotation",e),h=ih(n,t+"rotate-with-view",e),d=Q_(n,t+"declutter-mode"),g=new Uh({radius:5,declutterMode:d});return function(m){return s&&g.setRadius(s(m)),i&&g.setFill(i(m)),r&&g.setStroke(r(m)),a&&g.setDisplacement(a(m)),c&&g.setRotation(c(m)),h&&g.setRotateWithView(h(m)),o&&g.setScale(o(m)),g}}function Oi(n,e,t){if(!(e in n))return;const i=Co(n[e],st,t);return function(r){return GE(i(r),e)}}function co(n,e,t){if(!(e in n))return null;const i=Co(n[e],Li,t);return function(r){return R4(i(r),e)}}function WV(n,e,t){const i=co(n,e+"pattern-src",t),r=eP(n,e+"pattern-offset",t),s=eP(n,e+"pattern-size",t),o=Nx(n,e+"color",t);return function(a){return{src:i(a),offset:r&&r(a),size:s&&s(a),color:o&&o(a)}}}function ih(n,e,t){if(!(e in n))return null;const i=Co(n[e],pi,t);return function(r){const s=i(r);if(typeof s!="boolean")throw new Error(`Expected a boolean for ${e}`);return s}}function Nx(n,e,t){if(!(e in n))return null;const i=Co(n[e],Kr,t);return function(r){return P4(i(r),e)}}function T4(n,e,t){if(!(e in n))return null;const i=Co(n[e],hc,t);return function(r){return Ug(i(r),e)}}function j0(n,e,t){if(!(e in n))return null;const i=Co(n[e],hc,t);return function(r){const s=Ug(i(r),e);if(s.length!==2)throw new Error(`Expected two numbers for ${e}`);return s}}function eP(n,e,t){if(!(e in n))return null;const i=Co(n[e],hc,t);return function(r){return A4(i(r),e)}}function X_(n,e,t){if(!(e in n))return null;const i=Co(n[e],hc|st,t);return function(r){return XV(i(r),e)}}function U0(n,e){const t=n[e];if(t!==void 0){if(typeof t!="number")throw new Error(`Expected a number for ${e}`);return t}}function HV(n,e){const t=n[e];if(t!==void 0){if(typeof t=="number")return Vi(t);if(!Array.isArray(t))throw new Error(`Expected a number or size array for ${e}`);if(t.length!==2||typeof t[0]!="number"||typeof t[1]!="number")throw new Error(`Expected a number or size array for ${e}`);return t}}function KV(n,e){const t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);return t}}function tP(n,e){const t=n[e];if(t!==void 0){if(t!=="bottom-left"&&t!=="bottom-right"&&t!=="top-left"&&t!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${e}`);return t}}function nP(n,e){const t=n[e];if(t!==void 0){if(t!=="pixels"&&t!=="fraction")throw new Error(`Expected pixels or fraction for ${e}`);return t}}function qV(n,e){const t=n[e];if(t!==void 0)return Ug(t,e)}function Q_(n,e){const t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);if(t!=="declutter"&&t!=="obstacle"&&t!=="none")throw new Error(`Expected declutter, obstacle, or none for ${e}`);return t}}function YV(n,e){const t=n[e];if(t!==void 0)return P4(t,e)}function Ug(n,e){if(!Array.isArray(n))throw new Error(`Expected an array for ${e}`);const t=n.length;for(let i=0;i<t;++i)if(typeof n[i]!="number")throw new Error(`Expected an array of numbers for ${e}`);return n}function R4(n,e){if(typeof n!="string")throw new Error(`Expected a string for ${e}`);return n}function GE(n,e){if(typeof n!="number")throw new Error(`Expected a number for ${e}`);return n}function P4(n,e){if(typeof n=="string")return n;const t=Ug(n,e),i=t.length;if(i<3||i>4)throw new Error(`Expected a color with 3 or 4 values for ${e}`);return t}function A4(n,e){const t=Ug(n,e);if(t.length!==2)throw new Error(`Expected an array of two numbers for ${e}`);return t}function XV(n,e){return typeof n=="number"?n:A4(n,e)}const zr={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function iP(n,e,t){return(function(i,r,s,o,a){if(!i)return;if(!r&&!e)return i;const c=e?0:s[0]*r,h=e?0:s[1]*r,d=a?a[0]:0,g=a?a[1]:0;let m=n[0]+c/2+d,y=n[2]-c/2+d,w=n[1]+h/2+g,T=n[3]-h/2+g;m>y&&(m=(y+m)/2,y=m),w>T&&(w=(T+w)/2,T=w);let E=Dt(i[0],m,y),P=Dt(i[1],w,T);if(o&&t&&r){const M=30*r;E+=-M*Math.log(1+Math.max(0,m-i[0])/M)+M*Math.log(1+Math.max(0,i[0]-y)/M),P+=-M*Math.log(1+Math.max(0,w-i[1])/M)+M*Math.log(1+Math.max(0,i[1]-T)/M)}return[E,P]})}function QV(n){return n}function C4(n){return Math.pow(n,3)}function Bh(n){return 1-C4(1-n)}function ZV(n){return 3*n*n-2*n*n*n}function JV(n){return n}function Ox(n,e,t,i){const r=ht(e)/t[0],s=oi(e)/t[1];return i?Math.min(n,Math.max(r,s)):Math.min(n,Math.min(r,s))}function Dx(n,e,t){let i=Math.min(n,e);const r=50;return i*=Math.log(1+r*Math.max(0,n/e-1))/r+1,t&&(i=Math.max(i,t),i/=Math.log(1+r*Math.max(0,t/n-1))/r+1),Dt(i,t/2,e*2)}function eF(n,e,t,i){return e=e!==void 0?e:!0,(function(r,s,o,a){if(r!==void 0){const c=n[0],h=n[n.length-1],d=t?Ox(c,t,o,i):c;if(a)return e?Dx(r,d,h):Dt(r,h,d);const g=Math.min(d,r),m=Math.floor(ox(n,g,s));return n[m]>d&&m<n.length-1?n[m+1]:n[m]}})}function tF(n,e,t,i,r,s){return i=i!==void 0?i:!0,t=t!==void 0?t:0,(function(o,a,c,h){if(o!==void 0){const d=r?Ox(e,r,c,s):e;if(h)return i?Dx(o,d,t):Dt(o,t,d);const g=1e-9,m=Math.ceil(Math.log(e/d)/Math.log(n)-g),y=-a*(.5-g)+.5,w=Math.min(d,o),T=Math.floor(Math.log(e/w)/Math.log(n)+y),E=Math.max(m,T),P=e/Math.pow(n,E);return Dt(P,t,d)}})}function rP(n,e,t,i,r){return t=t!==void 0?t:!0,(function(s,o,a,c){if(s!==void 0){const h=i?Ox(n,i,a,r):n;return!t||!c?Dt(s,e,h):Dx(s,h,e)}})}function Vx(n){if(n!==void 0)return 0}function sP(n){if(n!==void 0)return n}function nF(n){const e=2*Math.PI/n;return(function(t,i){if(i)return t;if(t!==void 0)return t=Math.floor(t/e+.5)*e,t})}function iF(n){const e=Ca(5);return(function(t,i){return i||t===void 0?t:Math.abs(t)<=e?0:t})}const rF=42,Fx=256,C1=0;class Ts extends js{constructor(e){super(),this.on,this.once,this.un,e=Object.assign({},e),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=gx(e.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,e.projection&&Vb(),e.center&&(e.center=lo(e.center,this.projection_)),e.extent&&(e.extent=Sa(e.extent,this.projection_)),this.applyOptions_(e)}applyOptions_(e){const t=Object.assign({},e);for(const a in zr)delete t[a];this.setProperties(t,!0);const i=oF(e);this.maxResolution_=i.maxResolution,this.minResolution_=i.minResolution,this.zoomFactor_=i.zoomFactor,this.resolutions_=e.resolutions,this.padding_=e.padding,this.minZoom_=i.minZoom;const r=sF(e),s=i.constraint,o=aF(e);this.constraints_={center:r,resolution:s,rotation:o},this.setRotation(e.rotation!==void 0?e.rotation:0),this.setCenterInternal(e.center!==void 0?e.center:null),e.resolution!==void 0?this.setResolution(e.resolution):e.zoom!==void 0&&this.setZoom(e.zoom)}get padding(){return this.padding_}set padding(e){let t=this.padding_;this.padding_=e;const i=this.getCenterInternal();if(i){const r=e||[0,0,0,0];t=t||[0,0,0,0];const s=this.getResolution(),o=s/2*(r[3]-t[3]+t[1]-r[1]),a=s/2*(r[0]-t[0]+t[2]-r[2]);this.setCenterInternal([i[0]+o,i[1]-a])}}getUpdatedOptions_(e){const t=this.getProperties();return t.resolution!==void 0?t.resolution=this.getResolution():t.zoom=this.getZoom(),t.center=this.getCenterInternal(),t.rotation=this.getRotation(),Object.assign({},t,e)}animate(e){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const t=new Array(arguments.length);for(let i=0;i<t.length;++i){let r=arguments[i];r.center&&(r=Object.assign({},r),r.center=lo(r.center,this.getProjection())),r.anchor&&(r=Object.assign({},r),r.anchor=lo(r.anchor,this.getProjection())),t[i]=r}this.animateInternal.apply(this,t)}animateInternal(e){let t=arguments.length,i;t>1&&typeof arguments[t-1]=="function"&&(i=arguments[t-1],--t);let r=0;for(;r<t&&!this.isDef();++r){const d=arguments[r];d.center&&this.setCenterInternal(d.center),d.zoom!==void 0?this.setZoom(d.zoom):d.resolution&&this.setResolution(d.resolution),d.rotation!==void 0&&this.setRotation(d.rotation)}if(r===t){i&&Lp(i,!0);return}let s=Date.now(),o=this.targetCenter_.slice(),a=this.targetResolution_,c=this.targetRotation_;const h=[];for(;r<t;++r){const d=arguments[r],g={start:s,complete:!1,anchor:d.anchor,duration:d.duration!==void 0?d.duration:1e3,easing:d.easing||ZV,callback:i};if(d.center&&(g.sourceCenter=o,g.targetCenter=d.center.slice(),o=g.targetCenter),d.zoom!==void 0?(g.sourceResolution=a,g.targetResolution=this.getResolutionForZoom(d.zoom),a=g.targetResolution):d.resolution&&(g.sourceResolution=a,g.targetResolution=d.resolution,a=g.targetResolution),d.rotation!==void 0){g.sourceRotation=c;const m=Ma(d.rotation-c+Math.PI,2*Math.PI)-Math.PI;g.targetRotation=c+m,c=g.targetRotation}lF(g)?g.complete=!0:s+=g.duration,h.push(g)}this.animations_.push(h),this.setHint(ni.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[ni.ANIMATING]>0}getInteracting(){return this.hints_[ni.INTERACTING]>0}cancelAnimations(){this.setHint(ni.ANIMATING,-this.hints_[ni.ANIMATING]);let e;for(let t=0,i=this.animations_.length;t<i;++t){const r=this.animations_[t];if(r[0].callback&&Lp(r[0].callback,!1),!e)for(let s=0,o=r.length;s<o;++s){const a=r[s];if(!a.complete){e=a.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=e,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const e=Date.now();let t=!1;for(let i=this.animations_.length-1;i>=0;--i){const r=this.animations_[i];let s=!0;for(let o=0,a=r.length;o<a;++o){const c=r[o];if(c.complete)continue;const h=e-c.start;let d=c.duration>0?h/c.duration:1;d>=1?(c.complete=!0,d=1):s=!1;const g=c.easing(d);if(c.sourceCenter){const m=c.sourceCenter[0],y=c.sourceCenter[1],w=c.targetCenter[0],T=c.targetCenter[1];this.nextCenter_=c.targetCenter;const E=m+g*(w-m),P=y+g*(T-y);this.targetCenter_=[E,P]}if(c.sourceResolution&&c.targetResolution){const m=g===1?c.targetResolution:c.sourceResolution+g*(c.targetResolution-c.sourceResolution);if(c.anchor){const y=this.getViewportSize_(this.getRotation()),w=this.constraints_.resolution(m,0,y,!0);this.targetCenter_=this.calculateCenterZoom(w,c.anchor)}this.nextResolution_=c.targetResolution,this.targetResolution_=m,this.applyTargetState_(!0)}if(c.sourceRotation!==void 0&&c.targetRotation!==void 0){const m=g===1?Ma(c.targetRotation+Math.PI,2*Math.PI)-Math.PI:c.sourceRotation+g*(c.targetRotation-c.sourceRotation);if(c.anchor){const y=this.constraints_.rotation(m,!0);this.targetCenter_=this.calculateCenterRotate(y,c.anchor)}this.nextRotation_=c.targetRotation,this.targetRotation_=m}if(this.applyTargetState_(!0),t=!0,!c.complete)break}if(s){this.animations_[i]=null,this.setHint(ni.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const o=r[0].callback;o&&Lp(o,!0)}}this.animations_=this.animations_.filter(Boolean),t&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(e,t){let i;const r=this.getCenterInternal();return r!==void 0&&(i=[r[0]-t[0],r[1]-t[1]],cx(i,e-this.getRotation()),J5(i,t)),i}calculateCenterZoom(e,t){let i;const r=this.getCenterInternal(),s=this.getResolution();if(r!==void 0&&s!==void 0){const o=t[0]-e*(t[0]-r[0])/s,a=t[1]-e*(t[1]-r[1])/s;i=[o,a]}return i}getViewportSize_(e){const t=this.viewportSize_;if(e){const i=t[0],r=t[1];return[Math.abs(i*Math.cos(e))+Math.abs(r*Math.sin(e)),Math.abs(i*Math.sin(e))+Math.abs(r*Math.cos(e))]}return t}setViewportSize(e){this.viewportSize_=Array.isArray(e)?e.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const e=this.getCenterInternal();return e&&ME(e,this.getProjection())}getCenterInternal(){return this.get(zr.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(e){return e!==void 0?(e[0]=this.hints_[0],e[1]=this.hints_[1],e):this.hints_.slice()}calculateExtent(e){const t=this.calculateExtentInternal(e);return Fb(t,this.getProjection())}calculateExtentInternal(e){e=e||this.getViewportSizeMinusPadding_();const t=this.getCenterInternal();yt(t,"The view center is not defined");const i=this.getResolution();yt(i!==void 0,"The view resolution is not defined");const r=this.getRotation();return yt(r!==void 0,"The view rotation is not defined"),IE(t,i,r,e)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(e){this.applyOptions_(this.getUpdatedOptions_({maxZoom:e}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(e){this.applyOptions_(this.getUpdatedOptions_({minZoom:e}))}setConstrainResolution(e){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:e}))}getProjection(){return this.projection_}getResolution(){return this.get(zr.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(e,t){return this.getResolutionForExtentInternal(Sa(e,this.getProjection()),t)}getResolutionForExtentInternal(e,t){t=t||this.getViewportSizeMinusPadding_();const i=ht(e)/t[0],r=oi(e)/t[1];return Math.max(i,r)}getResolutionForValueFunction(e){e=e||2;const t=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,r=Math.log(t/i)/Math.log(e);return(function(s){return t/Math.pow(e,s*r)})}getRotation(){return this.get(zr.ROTATION)}getValueForResolutionFunction(e){const t=Math.log(e||2),i=this.getConstrainedResolution(this.maxResolution_),r=this.minResolution_,s=Math.log(i/r)/t;return(function(o){return Math.log(i/o)/t/s})}getViewportSizeMinusPadding_(e){let t=this.getViewportSize_(e);const i=this.padding_;return i&&(t=[t[0]-i[1]-i[3],t[1]-i[0]-i[2]]),t}getState(){const e=this.getProjection(),t=this.getResolution(),i=this.getRotation();let r=this.getCenterInternal();const s=this.padding_;if(s){const o=this.getViewportSizeMinusPadding_();r=M1(r,this.getViewportSize_(),[o[0]/2+s[3],o[1]/2+s[0]],t,i)}return{center:r.slice(0),projection:e!==void 0?e:null,resolution:t,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:i,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let e;const t=this.getResolution();return t!==void 0&&(e=this.getZoomForResolution(t)),e}getZoomForResolution(e){let t=this.minZoom_||0,i,r;if(this.resolutions_){const s=ox(this.resolutions_,e,1);t=s,i=this.resolutions_[s],s==this.resolutions_.length-1?r=2:r=i/this.resolutions_[s+1]}else i=this.maxResolution_,r=this.zoomFactor_;return t+Math.log(i/e)/Math.log(r)}getResolutionForZoom(e){if(this.resolutions_?.length){if(this.resolutions_.length===1)return this.resolutions_[0];const t=Dt(Math.floor(e),0,this.resolutions_.length-2),i=this.resolutions_[t]/this.resolutions_[t+1];return this.resolutions_[t]/Math.pow(i,Dt(e-t,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,e-this.minZoom_)}fit(e,t){let i;if(yt(Array.isArray(e)||typeof e.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(e)){yt(!j_(e),"Cannot fit empty extent provided as `geometry`");const r=Sa(e,this.getProjection());i=VR(r)}else if(e.getType()==="Circle"){const r=Sa(e.getExtent(),this.getProjection());i=VR(r),i.rotate(this.getRotation(),ja(r))}else i=e;this.fitInternal(i,t)}rotatedExtentForGeometry(e){const t=this.getRotation(),i=Math.cos(t),r=Math.sin(-t),s=e.getFlatCoordinates(),o=e.getStride();let a=1/0,c=1/0,h=-1/0,d=-1/0;for(let g=0,m=s.length;g<m;g+=o){const y=s[g]*i-s[g+1]*r,w=s[g]*r+s[g+1]*i;a=Math.min(a,y),c=Math.min(c,w),h=Math.max(h,y),d=Math.max(d,w)}return[a,c,h,d]}fitInternal(e,t){t=t||{};let i=t.size;i||(i=this.getViewportSizeMinusPadding_());const r=t.padding!==void 0?t.padding:[0,0,0,0],s=t.nearest!==void 0?t.nearest:!1;let o;t.minResolution!==void 0?o=t.minResolution:t.maxZoom!==void 0?o=this.getResolutionForZoom(t.maxZoom):o=0;const a=this.rotatedExtentForGeometry(e);let c=this.getResolutionForExtentInternal(a,[i[0]-r[1]-r[3],i[1]-r[0]-r[2]]);c=isNaN(c)?o:Math.max(c,o),c=this.getConstrainedResolution(c,s?0:1);const h=this.getRotation(),d=Math.sin(h),g=Math.cos(h),m=ja(a);m[0]+=(r[1]-r[3])/2*c,m[1]+=(r[0]-r[2])/2*c;const y=m[0]*g-m[1]*d,w=m[1]*g+m[0]*d,T=this.getConstrainedCenter([y,w],c),E=t.callback?t.callback:zf;t.duration!==void 0?this.animateInternal({resolution:c,center:T,duration:t.duration,easing:t.easing},E):(this.targetResolution_=c,this.targetCenter_=T,this.applyTargetState_(!1,!0),Lp(E,!0))}centerOn(e,t,i){this.centerOnInternal(lo(e,this.getProjection()),t,i)}centerOnInternal(e,t,i){this.setCenterInternal(M1(e,t,i,this.getResolution(),this.getRotation()))}calculateCenterShift(e,t,i,r){let s;const o=this.padding_;if(o&&e){const a=this.getViewportSizeMinusPadding_(-i),c=M1(e,r,[a[0]/2+o[3],a[1]/2+o[0]],t,i);s=[e[0]-c[0],e[1]-c[1]]}return s}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(e){const t=ME(this.targetCenter_,this.getProjection());this.setCenter([t[0]+e[0],t[1]+e[1]])}adjustCenterInternal(e){const t=this.targetCenter_;this.setCenterInternal([t[0]+e[0],t[1]+e[1]])}adjustResolution(e,t){t=t&&lo(t,this.getProjection()),this.adjustResolutionInternal(e,t)}adjustResolutionInternal(e,t){const i=this.getAnimating()||this.getInteracting(),r=this.getViewportSize_(this.getRotation()),s=this.constraints_.resolution(this.targetResolution_*e,0,r,i);t&&(this.targetCenter_=this.calculateCenterZoom(s,t)),this.targetResolution_*=e,this.applyTargetState_()}adjustZoom(e,t){this.adjustResolution(Math.pow(this.zoomFactor_,-e),t)}adjustRotation(e,t){t&&(t=lo(t,this.getProjection())),this.adjustRotationInternal(e,t)}adjustRotationInternal(e,t){const i=this.getAnimating()||this.getInteracting(),r=this.constraints_.rotation(this.targetRotation_+e,i);t&&(this.targetCenter_=this.calculateCenterRotate(r,t)),this.targetRotation_+=e,this.applyTargetState_()}setCenter(e){this.setCenterInternal(e&&lo(e,this.getProjection()))}setCenterInternal(e){this.targetCenter_=e,this.applyTargetState_()}setHint(e,t){return this.hints_[e]+=t,this.changed(),this.hints_[e]}setResolution(e){this.targetResolution_=e,this.applyTargetState_()}setRotation(e){this.targetRotation_=e,this.applyTargetState_()}setZoom(e){this.setResolution(this.getResolutionForZoom(e))}applyTargetState_(e,t){const i=this.getAnimating()||this.getInteracting()||t,r=this.constraints_.rotation(this.targetRotation_,i),s=this.getViewportSize_(r),o=this.constraints_.resolution(this.targetResolution_,0,s,i),a=this.constraints_.center(this.targetCenter_,o,s,i,this.calculateCenterShift(this.targetCenter_,o,r,s));this.get(zr.ROTATION)!==r&&this.set(zr.ROTATION,r),this.get(zr.RESOLUTION)!==o&&(this.set(zr.RESOLUTION,o),this.set("zoom",this.getZoom(),!0)),(!a||!this.get(zr.CENTER)||!R0(this.get(zr.CENTER),a))&&this.set(zr.CENTER,a),this.getAnimating()&&!e&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(e,t,i){e=e!==void 0?e:200;const r=t||0,s=this.constraints_.rotation(this.targetRotation_),o=this.getViewportSize_(s),a=this.constraints_.resolution(this.targetResolution_,r,o),c=this.constraints_.center(this.targetCenter_,a,o,!1,this.calculateCenterShift(this.targetCenter_,a,s,o));if(e===0&&!this.cancelAnchor_){this.targetResolution_=a,this.targetRotation_=s,this.targetCenter_=c,this.applyTargetState_();return}i=i||(e===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==a||this.getRotation()!==s||!this.getCenterInternal()||!R0(this.getCenterInternal(),c))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:s,center:c,resolution:a,duration:e,easing:Bh,anchor:i}))}beginInteraction(){this.resolveConstraints(0),this.setHint(ni.INTERACTING,1)}endInteraction(e,t,i){i=i&&lo(i,this.getProjection()),this.endInteractionInternal(e,t,i)}endInteractionInternal(e,t,i){this.getInteracting()&&(this.setHint(ni.INTERACTING,-1),this.resolveConstraints(e,t,i))}getConstrainedCenter(e,t){const i=this.getViewportSize_(this.getRotation());return this.constraints_.center(e,t||this.getResolution(),i)}getConstrainedZoom(e,t){const i=this.getResolutionForZoom(e);return this.getZoomForResolution(this.getConstrainedResolution(i,t))}getConstrainedResolution(e,t){t=t||0;const i=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(e,t,i)}}function Lp(n,e){setTimeout(function(){n(e)},0)}function sF(n){if(n.extent!==void 0){const t=n.smoothExtentConstraint!==void 0?n.smoothExtentConstraint:!0;return iP(n.extent,n.constrainOnlyCenter,t)}const e=gx(n.projection,"EPSG:3857");if(n.multiWorld!==!0&&e.isGlobal()){const t=e.getExtent().slice();return t[0]=-1/0,t[2]=1/0,iP(t,!1,!1)}return QV}function oF(n){let e,t,i,o=n.minZoom!==void 0?n.minZoom:C1,a=n.maxZoom!==void 0?n.maxZoom:28;const c=n.zoomFactor!==void 0?n.zoomFactor:2,h=n.multiWorld!==void 0?n.multiWorld:!1,d=n.smoothResolutionConstraint!==void 0?n.smoothResolutionConstraint:!0,g=n.showFullExtent!==void 0?n.showFullExtent:!1,m=gx(n.projection,"EPSG:3857"),y=m.getExtent();let w=n.constrainOnlyCenter,T=n.extent;if(!h&&!T&&m.isGlobal()&&(w=!1,T=y),n.resolutions!==void 0){const E=n.resolutions;t=E[o],i=E[a]!==void 0?E[a]:E[E.length-1],n.constrainResolution?e=eF(E,d,!w&&T,g):e=rP(t,i,d,!w&&T,g)}else{const P=(y?Math.max(ht(y),oi(y)):360*ph.degrees/m.getMetersPerUnit())/Fx/Math.pow(2,C1),M=P/Math.pow(2,28-C1);t=n.maxResolution,t!==void 0?o=0:t=P/Math.pow(c,o),i=n.minResolution,i===void 0&&(n.maxZoom!==void 0?n.maxResolution!==void 0?i=t/Math.pow(c,a):i=P/Math.pow(c,a):i=M),a=o+Math.floor(Math.log(t/i)/Math.log(c)),i=t/Math.pow(c,a-o),n.constrainResolution?e=tF(c,t,i,d,!w&&T,g):e=rP(t,i,d,!w&&T,g)}return{constraint:e,maxResolution:t,minResolution:i,minZoom:o,zoomFactor:c}}function aF(n){if(n.enableRotation!==void 0?n.enableRotation:!0){const t=n.constrainRotation;return t===void 0||t===!0?iF():t===!1?sP:typeof t=="number"?nF(t):sP}return Vx}function lF(n){return!(n.sourceCenter&&n.targetCenter&&!R0(n.sourceCenter,n.targetCenter)||n.sourceResolution!==n.targetResolution||n.sourceRotation!==n.targetRotation)}function M1(n,e,t,i,r){const s=Math.cos(-r);let o=Math.sin(-r),a=n[0]*s-n[1]*o,c=n[1]*s+n[0]*o;a+=(e[0]/2-t[0])*i,c+=(t[1]-e[1]/2)*i,o=-o;const h=a*s-c*o,d=c*s+a*o;return[h,d]}const wt={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class M4 extends js{constructor(e){super(),this.on,this.once,this.un,this.background_=e.background;const t=Object.assign({},e);typeof e.properties=="object"&&(delete t.properties,Object.assign(t,e.properties)),t[wt.OPACITY]=e.opacity!==void 0?e.opacity:1,yt(typeof t[wt.OPACITY]=="number","Layer opacity must be a number"),t[wt.VISIBLE]=e.visible!==void 0?e.visible:!0,t[wt.Z_INDEX]=e.zIndex,t[wt.MAX_RESOLUTION]=e.maxResolution!==void 0?e.maxResolution:1/0,t[wt.MIN_RESOLUTION]=e.minResolution!==void 0?e.minResolution:0,t[wt.MIN_ZOOM]=e.minZoom!==void 0?e.minZoom:-1/0,t[wt.MAX_ZOOM]=e.maxZoom!==void 0?e.maxZoom:1/0,this.className_=t.className!==void 0?t.className:"ol-layer",delete t.className,this.setProperties(t),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(e){const t=this.state_||{layer:this,managed:e===void 0?!0:e},i=this.getZIndex();return t.opacity=Dt(Math.round(this.getOpacity()*100)/100,0,1),t.visible=this.getVisible(),t.extent=this.getExtent(),t.zIndex=i===void 0&&!t.managed?1/0:i,t.maxResolution=this.getMaxResolution(),t.minResolution=Math.max(this.getMinResolution(),0),t.minZoom=this.getMinZoom(),t.maxZoom=this.getMaxZoom(),this.state_=t,t}getLayersArray(e){return We()}getLayerStatesArray(e){return We()}getExtent(){return this.get(wt.EXTENT)}getMaxResolution(){return this.get(wt.MAX_RESOLUTION)}getMinResolution(){return this.get(wt.MIN_RESOLUTION)}getMinZoom(){return this.get(wt.MIN_ZOOM)}getMaxZoom(){return this.get(wt.MAX_ZOOM)}getOpacity(){return this.get(wt.OPACITY)}getSourceState(){return We()}getVisible(){return this.get(wt.VISIBLE)}getZIndex(){return this.get(wt.Z_INDEX)}setBackground(e){this.background_=e,this.changed()}setExtent(e){this.set(wt.EXTENT,e)}setMaxResolution(e){this.set(wt.MAX_RESOLUTION,e)}setMinResolution(e){this.set(wt.MIN_RESOLUTION,e)}setMaxZoom(e){this.set(wt.MAX_ZOOM,e)}setMinZoom(e){this.set(wt.MIN_ZOOM,e)}setOpacity(e){yt(typeof e=="number","Layer opacity must be a number"),this.set(wt.OPACITY,e)}setVisible(e){this.set(wt.VISIBLE,e)}setZIndex(e){this.set(wt.Z_INDEX,e)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}class Z_ extends M4{constructor(e){const t=Object.assign({},e);delete t.source,super(t),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,e.render&&(this.render=e.render),e.map&&this.setMap(e.map),this.addChangeListener(wt.SOURCE,this.handleSourcePropertyChange_);const i=e.source?e.source:null;this.setSource(i)}getLayersArray(e){return e=e||[],e.push(this),e}getLayerStatesArray(e){return e=e||[],e.push(this.getLayerState()),e}getSource(){return this.get(wt.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const e=this.getSource();return e?e.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(Ot(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const e=this.getSource();e&&(this.sourceChangeKey_=lt(e,Qe.CHANGE,this.handleSourceChange_,this),e.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(e){return this.renderer_?this.renderer_.getFeatures(e):Promise.resolve([])}getData(e){return!this.renderer_||!this.rendered?null:this.renderer_.getData(e)}isVisible(e){let t;const i=this.getMapInternal();!e&&i&&(e=i.getView()),e instanceof Ts?t={viewState:e.getState(),extent:e.calculateExtent()}:t=e,!t.layerStatesArray&&i&&(t.layerStatesArray=i.getLayerGroup().getLayerStatesArray());let r;if(t.layerStatesArray){if(r=t.layerStatesArray.find(o=>o.layer===this),!r)return!1}else r=this.getLayerState();const s=this.getExtent();return Gx(r,t.viewState)&&(!s||Ni(s,t.extent))}getAttributions(e){if(!this.isVisible(e))return[];const t=this.getSource()?.getAttributions();if(!t)return[];const i=e instanceof Ts?e.getViewStateAndExtent():e;let r=t(i);return Array.isArray(r)||(r=[r]),r}render(e,t){const i=this.getRenderer();return i.prepareFrame(e)?(this.rendered=!0,i.renderFrame(e,t)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(e,t){}renderDeferred(e){const t=this.getRenderer();t&&t.renderDeferred(e)}setMapInternal(e){e||this.unrender(),this.set(wt.MAP,e)}getMapInternal(){return this.get(wt.MAP)}setMap(e){this.mapPrecomposeKey_&&(Ot(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),e||this.changed(),this.mapRenderKey_&&(Ot(this.mapRenderKey_),this.mapRenderKey_=null),e&&(this.mapPrecomposeKey_=lt(e,Pr.PRECOMPOSE,this.handlePrecompose_,this),this.mapRenderKey_=lt(this,Qe.CHANGE,e.render,e),this.changed())}handlePrecompose_(e){const t=e.frameState.layerStatesArray,i=this.getLayerState(!1);yt(!t.some(r=>r.layer===i.layer),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),t.push(i)}setSource(e){this.set(wt.SOURCE,e)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}clearRenderer(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_)}disposeInternal(){this.clearRenderer(),this.setSource(null),super.disposeInternal()}}function Gx(n,e){if(!n.visible)return!1;const t=e.resolution;if(t<n.minResolution||t>=n.maxResolution)return!1;const i=e.zoom;return i>n.minZoom&&i<=n.maxZoom}const oP={RENDER_ORDER:"renderOrder"};class b4 extends Z_{constructor(e){e=e||{};const t=Object.assign({},e);delete t.style,delete t.renderBuffer,delete t.updateWhileAnimating,delete t.updateWhileInteracting,super(t),this.declutter_=e.declutter?String(e.declutter):void 0,this.renderBuffer_=e.renderBuffer!==void 0?e.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(e.style),this.updateWhileAnimating_=e.updateWhileAnimating!==void 0?e.updateWhileAnimating:!1,this.updateWhileInteracting_=e.updateWhileInteracting!==void 0?e.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(e){return super.getFeatures(e)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(oP.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(e,t){const i=this.getDeclutter();i in e.declutter||(e.declutter[i]=new g4(9)),this.getRenderer().renderDeclutter(e,t)}setRenderOrder(e){this.set(oP.RENDER_ORDER,e)}setStyle(e){this.style_=e===void 0?p4:e;const t=cF(e);this.styleFunction_=e===null?void 0:W8(t),this.changed()}setDeclutter(e){this.declutter_=e?String(e):void 0,this.changed()}}function cF(n){if(n===void 0)return p4;if(!n)return null;if(typeof n=="function"||n instanceof ji)return n;if(!Array.isArray(n))return JR([n]);if(n.length===0)return[];const e=n.length,t=n[0];if(t instanceof ji){const r=new Array(e);for(let s=0;s<e;++s){const o=n[s];if(!(o instanceof ji))throw new Error("Expected a list of style instances");r[s]=o}return r}if("style"in t){const r=new Array(e);for(let s=0;s<e;++s){const o=n[s];if(!("style"in o))throw new Error("Expected a list of rules with a style property");r[s]=o}return FV(r)}return JR(n)}class jx extends b4{constructor(e){super(e)}createRenderer(){return new dV(this)}}const la={ADDLAYER:"addlayer",REMOVELAYER:"removelayer"};class _a extends Ao{constructor(e,t){super(e),this.layer=t}}const b1={LAYERS:"layers"};let J_=class k4 extends M4{constructor(e){e=e||{};const t=Object.assign({},e);delete t.layers;let i=e.layers;super(t),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(b1.LAYERS,this.handleLayersChanged_),i?Array.isArray(i)?i=new Rr(i.slice(),{unique:!0}):yt(typeof i.getArray=="function","Expected `layers` to be an array or a `Collection`"):i=new Rr(void 0,{unique:!0}),this.setLayers(i)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(Ot),this.layersListenerKeys_.length=0;const e=this.getLayers();this.layersListenerKeys_.push(lt(e,bi.ADD,this.handleLayersAdd_,this),lt(e,bi.REMOVE,this.handleLayersRemove_,this));for(const i in this.listenerKeys_)this.listenerKeys_[i].forEach(Ot);bg(this.listenerKeys_);const t=e.getArray();for(let i=0,r=t.length;i<r;i++){const s=t[i];this.registerLayerListeners_(s),this.dispatchEvent(new _a(la.ADDLAYER,s))}this.changed()}registerLayerListeners_(e){const t=[lt(e,fh.PROPERTYCHANGE,this.handleLayerChange_,this),lt(e,Qe.CHANGE,this.handleLayerChange_,this)];e instanceof k4&&t.push(lt(e,la.ADDLAYER,this.handleLayerGroupAdd_,this),lt(e,la.REMOVELAYER,this.handleLayerGroupRemove_,this)),this.listenerKeys_[ut(e)]=t}handleLayerGroupAdd_(e){this.dispatchEvent(new _a(la.ADDLAYER,e.layer))}handleLayerGroupRemove_(e){this.dispatchEvent(new _a(la.REMOVELAYER,e.layer))}handleLayersAdd_(e){const t=e.element;this.registerLayerListeners_(t),this.dispatchEvent(new _a(la.ADDLAYER,t)),this.changed()}handleLayersRemove_(e){const t=e.element,i=ut(t);this.listenerKeys_[i].forEach(Ot),delete this.listenerKeys_[i],this.dispatchEvent(new _a(la.REMOVELAYER,t)),this.changed()}getLayers(){return this.get(b1.LAYERS)}setLayers(e){const t=this.getLayers();if(t){const i=t.getArray();for(let r=0,s=i.length;r<s;++r)this.dispatchEvent(new _a(la.REMOVELAYER,i[r]))}this.set(b1.LAYERS,e)}getLayersArray(e){return e=e!==void 0?e:[],this.getLayers().forEach(function(t){t.getLayersArray(e)}),e}getLayerStatesArray(e){const t=e!==void 0?e:[],i=t.length;this.getLayers().forEach(function(o){o.getLayerStatesArray(t)});const r=this.getLayerState();let s=r.zIndex;!e&&r.zIndex===void 0&&(s=0);for(let o=i,a=t.length;o<a;o++){const c=t[o];c.opacity*=r.opacity,c.visible=c.visible&&r.visible,c.maxResolution=Math.min(c.maxResolution,r.maxResolution),c.minResolution=Math.max(c.minResolution,r.minResolution),c.minZoom=Math.max(c.minZoom,r.minZoom),c.maxZoom=Math.min(c.maxZoom,r.maxZoom),r.extent!==void 0&&(c.extent!==void 0?c.extent=Zl(c.extent,r.extent):c.extent=r.extent),c.zIndex===void 0&&(c.zIndex=s)}return t}getSourceState(){return"ready"}};const Fe={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};class Ux extends kg{constructor(e,t,i){super(),i=i||{},this.tileCoord=e,this.state=t,this.key="",this.transition_=i.transition===void 0?250:i.transition,this.transitionStarts_={},this.interpolate=!!i.interpolate}changed(){this.dispatchEvent(Qe.CHANGE)}release(){this.setState(Fe.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(e){if(this.state!==Fe.EMPTY){if(this.state!==Fe.ERROR&&this.state>e)throw new Error("Tile load sequence violation");this.state=e,this.changed()}}load(){We()}getAlpha(e,t){if(!this.transition_)return 1;let i=this.transitionStarts_[e];if(!i)i=t,this.transitionStarts_[e]=i;else if(i===-1)return 1;const r=t-i+1e3/60;return r>=this.transition_?1:C4(r/this.transition_)}inTransition(e){return this.transition_?this.transitionStarts_[e]!==-1:!1}endTransition(e){this.transition_&&(this.transitionStarts_[e]=-1)}disposeInternal(){this.release(),super.disposeInternal()}}function jE(n){return n instanceof Image||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageBitmap?n:null}const uF=new Error("disposed"),hF=[256,256];class aP extends Ux{constructor(e){const t=Fe.IDLE;super(e.tileCoord,t,{transition:e.transition,interpolate:e.interpolate}),this.loader_=e.loader,this.data_=null,this.error_=null,this.size_=e.size||null,this.controller_=e.controller||null}getSize(){if(this.size_)return this.size_;const e=jE(this.data_);return e?[e.width,e.height]:hF}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==Fe.IDLE&&this.state!==Fe.ERROR)return;this.state=Fe.LOADING,this.changed();const e=this;this.loader_().then(function(t){e.data_=t,e.state=Fe.LOADED,e.changed()}).catch(function(t){e.error_=t,e.state=Fe.ERROR,e.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(uF),this.controller_=null),super.disposeInternal()}}class L4 extends Ux{constructor(e,t,i,r,s,o){super(e,t,o),this.crossOrigin_=r,this.src_=i,this.key=i,this.image_,er?this.image_=new OffscreenCanvas(1,1):(this.image_=new Image,r!==null&&(this.image_.crossOrigin=r)),this.unlisten_=null,this.tileLoadFunction_=s}getImage(){return this.image_}setImage(e){this.image_=e,this.state=Fe.LOADED,this.unlistenImage_(),this.changed()}getCrossOrigin(){return this.crossOrigin_}handleImageError_(){this.state=Fe.ERROR,this.unlistenImage_(),this.image_=dF(),this.changed()}handleImageLoad_(){if(er)this.state=Fe.LOADED;else{const e=this.image_;e.naturalWidth&&e.naturalHeight?this.state=Fe.LOADED:this.state=Fe.EMPTY}this.unlistenImage_(),this.changed()}load(){this.state==Fe.ERROR&&(this.state=Fe.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==Fe.IDLE&&(this.state=Fe.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=l8(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}}function dF(){const n=En(1,1);return n.fillStyle="rgba(0,0,0,0)",n.fillRect(0,0,1,1),n.canvas}let k1;const rh=[];function lP(n,e,t,i,r){n.beginPath(),n.moveTo(0,0),n.lineTo(e,t),n.lineTo(i,r),n.closePath(),n.save(),n.clip(),n.fillRect(0,0,Math.max(e,i)+1,Math.max(t,r)),n.restore()}function L1(n,e){return Math.abs(n[e*4]-210)>2||Math.abs(n[e*4+3]-.75*255)>2}function fF(){if(k1===void 0){const n=En(6,6,rh);n.globalCompositeOperation="lighter",n.fillStyle="rgba(210, 0, 0, 0.75)",lP(n,4,5,4,0),lP(n,4,5,0,5);const e=n.getImageData(0,0,3,3).data;k1=L1(e,0)||L1(e,4)||L1(e,8),H_(n),rh.push(n.canvas)}return k1}function UE(n,e,t,i){const r=Vg(t,e,n);let s=C0(e,i,t);const o=e.getMetersPerUnit();o!==void 0&&(s*=o);const a=n.getMetersPerUnit();a!==void 0&&(s/=a);const c=n.getExtent();if(!c||mh(c,r)){const h=C0(n,s,r)/s;isFinite(h)&&h>0&&(s/=h)}return s}function gF(n,e,t,i){const r=ja(t);let s=UE(n,e,r,i);return(!isFinite(s)||s<=0)&&Ib(t,function(o){return s=UE(n,e,o,i),isFinite(s)&&s>0}),s}function mF(n,e,t,i,r,s,o,a,c,h,d,g,m,y){const w=En(Math.round(t*n),Math.round(t*e),rh);if(g||(w.imageSmoothingEnabled=!1),c.length===0)return w.canvas;w.scale(t,t);function T(j){return Math.round(j*t)/t}w.globalCompositeOperation="lighter";const E=ir();c.forEach(function(j,W,L){xb(E,j.extent)});let P;const M=t/i,N=(g?1:1+Math.pow(2,-24))/M;(!m||c.length!==1||h!==0)&&(P=En(Math.round(ht(E)*M),Math.round(oi(E)*M),rh),g||(P.imageSmoothingEnabled=!1),c.forEach(function(j,W,L){if(j.image.width>0&&j.image.height>0){if(j.clipExtent){P.save();const z=(j.clipExtent[0]-E[0])*M,O=-(j.clipExtent[3]-E[3])*M,oe=ht(j.clipExtent)*M,Te=oi(j.clipExtent)*M;P.rect(g?z:Math.round(z),g?O:Math.round(O),g?oe:Math.round(z+oe)-Math.round(z),g?Te:Math.round(O+Te)-Math.round(O)),P.clip()}const A=(j.extent[0]-E[0])*M,k=-(j.extent[3]-E[3])*M,U=ht(j.extent)*M,B=oi(j.extent)*M;P.drawImage(j.image,h,h,j.image.width-2*h,j.image.height-2*h,g?A:Math.round(A),g?k:Math.round(k),g?U:Math.round(A+U)-Math.round(A),g?B:Math.round(k+B)-Math.round(k)),j.clipExtent&&P.restore()}}));const D=Ac(o);return a.getTriangles().forEach(function(j,W,L){const A=j.source,k=j.target;let U=A[0][0],B=A[0][1],z=A[1][0],O=A[1][1],oe=A[2][0],Te=A[2][1];const we=T((k[0][0]-D[0])/s),_e=T(-(k[0][1]-D[1])/s),Q=T((k[1][0]-D[0])/s),ce=T(-(k[1][1]-D[1])/s),K=T((k[2][0]-D[0])/s),V=T(-(k[2][1]-D[1])/s),I=U,de=B;U=0,B=0,z-=I,O-=de,oe-=I,Te-=de;const q=[[z,O,0,0,Q-we],[oe,Te,0,0,K-we],[0,0,z,O,ce-_e],[0,0,oe,Te,V-_e]],fe=Z5(q);if(!fe)return;if(w.save(),w.beginPath(),fF()||!g){w.moveTo(Q,ce);const F=4,te=we-Q,Pe=_e-ce;for(let Be=0;Be<F;Be++)w.lineTo(Q+T((Be+1)*te/F),ce+T(Be*Pe/(F-1))),Be!=F-1&&w.lineTo(Q+T((Be+1)*te/F),ce+T((Be+1)*Pe/(F-1)));w.lineTo(K,V)}else w.moveTo(Q,ce),w.lineTo(we,_e),w.lineTo(K,V);w.clip(),w.transform(fe[0],fe[2],fe[1],fe[3],we,_e),w.translate(E[0]-I,E[3]-de);let X;if(P)X=P.canvas,w.scale(N,-N);else{const F=c[0],te=F.extent;X=F.image,w.scale(ht(te)/X.width,-oi(te)/X.height)}w.drawImage(X,0,0),w.restore()}),P&&(H_(P),rh.push(P.canvas)),d&&(w.save(),w.globalCompositeOperation="source-over",w.strokeStyle="black",w.lineWidth=1,a.getTriangles().forEach(function(j,W,L){const A=j.target,k=(A[0][0]-D[0])/s,U=-(A[0][1]-D[1])/s,B=(A[1][0]-D[0])/s,z=-(A[1][1]-D[1])/s,O=(A[2][0]-D[0])/s,oe=-(A[2][1]-D[1])/s;w.beginPath(),w.moveTo(B,z),w.lineTo(k,U),w.lineTo(O,oe),w.closePath(),w.stroke()}),w.restore()),w.canvas}const pF=10,cP=.25;class _F{constructor(e,t,i,r,s,o,a){this.sourceProj_=e,this.targetProj_=t;let c={};const h=a?CE(N=>Mn(a,Vg(N,this.targetProj_,this.sourceProj_))):Hf(this.targetProj_,this.sourceProj_);this.transformInv_=function(N){const D=N[0]+"/"+N[1];return c[D]||(c[D]=h(N)),c[D]},this.maxSourceExtent_=r,this.errorThresholdSquared_=s*s,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!r&&!!this.sourceProj_.getExtent()&&ht(r)>=ht(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?ht(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?ht(this.targetProj_.getExtent()):null;const d=Ac(i),g=G_(i),m=F_(i),y=V_(i),w=this.transformInv_(d),T=this.transformInv_(g),E=this.transformInv_(m),P=this.transformInv_(y),M=pF+(o?Math.max(0,Math.ceil(Math.log2(SE(i)/(o*o*256*256)))):0);if(this.addQuad_(d,g,m,y,w,T,E,P,M),this.wrapsXInSource_){let N=1/0;this.triangles_.forEach(function(D,j,W){N=Math.min(N,D.source[0][0],D.source[1][0],D.source[2][0])}),this.triangles_.forEach(D=>{if(Math.max(D.source[0][0],D.source[1][0],D.source[2][0])-N>this.sourceWorldWidth_/2){const j=[[D.source[0][0],D.source[0][1]],[D.source[1][0],D.source[1][1]],[D.source[2][0],D.source[2][1]]];j[0][0]-N>this.sourceWorldWidth_/2&&(j[0][0]-=this.sourceWorldWidth_),j[1][0]-N>this.sourceWorldWidth_/2&&(j[1][0]-=this.sourceWorldWidth_),j[2][0]-N>this.sourceWorldWidth_/2&&(j[2][0]-=this.sourceWorldWidth_);const W=Math.min(j[0][0],j[1][0],j[2][0]);Math.max(j[0][0],j[1][0],j[2][0])-W<this.sourceWorldWidth_/2&&(D.source=j)}})}c={}}addTriangle_(e,t,i,r,s,o){this.triangles_.push({source:[r,s,o],target:[e,t,i]})}addQuad_(e,t,i,r,s,o,a,c,h){const d=fR([s,o,a,c]),g=this.sourceWorldWidth_?ht(d)/this.sourceWorldWidth_:null,m=this.sourceWorldWidth_,y=this.sourceProj_.canWrapX()&&g>.5&&g<1;let w=!1;if(h>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const E=fR([e,t,i,r]);w=ht(E)/this.targetWorldWidth_>cP||w}!y&&this.sourceProj_.isGlobal()&&g&&(w=g>cP||w)}if(!w&&this.maxSourceExtent_&&isFinite(d[0])&&isFinite(d[1])&&isFinite(d[2])&&isFinite(d[3])&&!Ni(d,this.maxSourceExtent_))return;let T=0;if(!w&&(!isFinite(s[0])||!isFinite(s[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(a[0])||!isFinite(a[1])||!isFinite(c[0])||!isFinite(c[1]))){if(h>0)w=!0;else if(T=(!isFinite(s[0])||!isFinite(s[1])?8:0)+(!isFinite(o[0])||!isFinite(o[1])?4:0)+(!isFinite(a[0])||!isFinite(a[1])?2:0)+(!isFinite(c[0])||!isFinite(c[1])?1:0),T!=1&&T!=2&&T!=4&&T!=8)return}if(h>0){if(!w){const E=[(e[0]+i[0])/2,(e[1]+i[1])/2],P=this.transformInv_(E);let M;y?M=(Ma(s[0],m)+Ma(a[0],m))/2-Ma(P[0],m):M=(s[0]+a[0])/2-P[0];const N=(s[1]+a[1])/2-P[1];w=M*M+N*N>this.errorThresholdSquared_}if(w){if(Math.abs(e[0]-i[0])<=Math.abs(e[1]-i[1])){const E=[(t[0]+i[0])/2,(t[1]+i[1])/2],P=this.transformInv_(E),M=[(r[0]+e[0])/2,(r[1]+e[1])/2],N=this.transformInv_(M);this.addQuad_(e,t,E,M,s,o,P,N,h-1),this.addQuad_(M,E,i,r,N,P,a,c,h-1)}else{const E=[(e[0]+t[0])/2,(e[1]+t[1])/2],P=this.transformInv_(E),M=[(i[0]+r[0])/2,(i[1]+r[1])/2],N=this.transformInv_(M);this.addQuad_(e,E,M,r,s,P,N,c,h-1),this.addQuad_(E,t,i,M,P,o,a,N,h-1)}return}}if(y){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(T&11)==0&&this.addTriangle_(e,i,r,s,a,c),(T&14)==0&&this.addTriangle_(e,i,t,s,a,o),T&&((T&13)==0&&this.addTriangle_(t,r,e,o,c,s),(T&7)==0&&this.addTriangle_(t,r,i,o,c,a))}calculateSourceExtent(){const e=ir();return this.triangles_.forEach(function(t,i,r){const s=t.source;vf(e,s[0]),vf(e,s[1]),vf(e,s[2])}),e}getTriangles(){return this.triangles_}}const yF=.5;class N4 extends Ux{constructor(e,t,i,r,s,o,a,c,h,d,g,m){super(s,Fe.IDLE,m),this.renderEdges_=g!==void 0?g:!1,this.pixelRatio_=a,this.gutter_=c,this.canvas_=null,this.sourceTileGrid_=t,this.targetTileGrid_=r,this.wrappedTileCoord_=o||s,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=e.canWrapX()?e.getExtent():void 0;const y=r.getTileCoordExtent(this.wrappedTileCoord_),w=this.targetTileGrid_.getExtent();let T=this.sourceTileGrid_.getExtent();const E=w?Zl(y,w):y;if(SE(E)===0){this.state=Fe.EMPTY;return}const P=e.getExtent();P&&(T?T=Zl(T,P):T=P);const M=r.getResolution(this.wrappedTileCoord_[0]),N=gF(e,i,E,M);if(!isFinite(N)||N<=0){this.state=Fe.EMPTY;return}const D=d!==void 0?d:yF;if(this.triangulation_=new _F(e,i,E,T,N*D,M),this.triangulation_.getTriangles().length===0){this.state=Fe.EMPTY;return}this.sourceZ_=t.getZForResolution(N);let j=this.triangulation_.calculateSourceExtent();if(T&&(e.canWrapX()?(j[1]=Dt(j[1],T[1],T[3]),j[3]=Dt(j[3],T[1],T[3])):j=Zl(j,T)),!SE(j))this.state=Fe.EMPTY;else{let W=0,L=0;e.canWrapX()&&(W=ht(P),L=Math.floor((j[0]-P[0])/W)),Pb(j.slice(),e,!0).forEach(k=>{const U=t.getTileRangeForExtentAndZ(k,this.sourceZ_);for(let B=U.minX;B<=U.maxX;B++)for(let z=U.minY;z<=U.maxY;z++){const O=h(this.sourceZ_,B,z,a);if(O){const oe=L*W;this.sourceTiles_.push({tile:O,offset:oe})}}++L}),this.sourceTiles_.length===0&&(this.state=Fe.EMPTY)}}getImage(){return this.canvas_}reproject_(){const e=[];if(this.sourceTiles_.forEach(t=>{const i=t.tile;if(i&&i.getState()==Fe.LOADED){const r=this.sourceTileGrid_.getTileCoordExtent(i.tileCoord);r[0]+=t.offset,r[2]+=t.offset;const s=this.clipExtent_?.slice();s&&(s[0]+=t.offset,s[2]+=t.offset),e.push({extent:r,clipExtent:s,image:i.getImage()})}}),this.sourceTiles_.length=0,e.length===0)this.state=Fe.ERROR;else{const t=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(t),r=typeof i=="number"?i:i[0],s=typeof i=="number"?i:i[1],o=this.targetTileGrid_.getResolution(t),a=this.sourceTileGrid_.getResolution(this.sourceZ_),c=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=mF(r,s,this.pixelRatio_,a,this.sourceTileGrid_.getExtent(),o,c,this.triangulation_,e,this.gutter_,this.renderEdges_,this.interpolate),this.state=Fe.LOADED}this.changed()}load(){if(this.state==Fe.IDLE){this.state=Fe.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:t})=>{const i=t.getState();if(i==Fe.IDLE||i==Fe.LOADING){e++;const r=lt(t,Qe.CHANGE,s=>{const o=t.getState();(o==Fe.LOADED||o==Fe.ERROR||o==Fe.EMPTY)&&(Ot(r),e--,e===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(r)}}),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:t},i,r){t.getState()==Fe.IDLE&&t.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(Ot),this.sourcesListenerKeys_=null}release(){this.canvas_&&(H_(this.canvas_.getContext("2d")),rh.push(this.canvas_),this.canvas_=null),super.release()}}class Bx{constructor(e,t,i,r){this.minX=e,this.maxX=t,this.minY=i,this.maxY=r}contains(e){return this.containsXY(e[1],e[2])}containsTileRange(e){return this.minX<=e.minX&&e.maxX<=this.maxX&&this.minY<=e.minY&&e.maxY<=this.maxY}containsXY(e,t){return this.minX<=e&&e<=this.maxX&&this.minY<=t&&t<=this.maxY}equals(e){return this.minX==e.minX&&this.minY==e.minY&&this.maxX==e.maxX&&this.maxY==e.maxY}extend(e){e.minX<this.minX&&(this.minX=e.minX),e.maxX>this.maxX&&(this.maxX=e.maxX),e.minY<this.minY&&(this.minY=e.minY),e.maxY>this.maxY&&(this.maxY=e.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(e){return this.minX<=e.maxX&&this.maxX>=e.minX&&this.minY<=e.maxY&&this.maxY>=e.minY}}function Tu(n,e,t,i,r){return r!==void 0?(r.minX=n,r.maxX=e,r.minY=t,r.maxY=i,r):new Bx(n,e,t,i)}class uP{constructor(e){this.highWaterMark=e!==void 0?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}deleteOldest(){const e=this.pop();e instanceof O_&&e.dispose()}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(e){for(;this.canExpireCache();)this.deleteOldest()}clear(){for(;this.oldest_;)this.deleteOldest()}containsKey(e){return this.entries_.hasOwnProperty(e)}forEach(e){let t=this.oldest_;for(;t;)e(t.value_,t.key_,this),t=t.newer}get(e,t){const i=this.entries_[e];return yt(i!==void 0,"Tried to get a value for a key that does not exist in the cache"),i===this.newest_||(i===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(i.newer.older=i.older,i.older.newer=i.newer),i.newer=null,i.older=this.newest_,this.newest_.newer=i,this.newest_=i),i.value_}remove(e){const t=this.entries_[e];return yt(t!==void 0,"Tried to get a value for a key that does not exist in the cache"),t===this.newest_?(this.newest_=t.older,this.newest_&&(this.newest_.newer=null)):t===this.oldest_?(this.oldest_=t.newer,this.oldest_&&(this.oldest_.older=null)):(t.newer.older=t.older,t.older.newer=t.newer),delete this.entries_[e],--this.count_,t.value_}getCount(){return this.count_}getKeys(){const e=new Array(this.count_);let t=0,i;for(i=this.newest_;i;i=i.older)e[t++]=i.key_;return e}getValues(){const e=new Array(this.count_);let t=0,i;for(i=this.newest_;i;i=i.older)e[t++]=i.value_;return e}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(e){return this.entries_[e]?.value_}pop(){const e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_}replace(e,t){this.get(e),this.entries_[e].value_=t}set(e,t){yt(!(e in this.entries_),"Tried to set a value for a key that is used already");const i={key_:e,newer:null,older:this.newest_,value_:t};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[e]=i,++this.count_}setSize(e){this.highWaterMark=e}}function B0(n,e,t,i){return i!==void 0?(i[0]=n,i[1]=e,i[2]=t,i):[n,e,t]}function vF(n,e,t){return n+"/"+e+"/"+t}function t0(n,e,t,i,r){return`${ut(n)},${e},${vF(t,i,r)}`}function O4(n){return EF(n[0],n[1],n[2])}function EF(n,e,t){return(e<<n)+t}function wF(n,e){const t=n[0],i=n[1],r=n[2];if(e.getMinZoom()>t||t>e.getMaxZoom())return!1;const s=e.getFullTileRange(t);return s?s.containsXY(i,r):!0}function N1(n,e,t){if(!(t in n))return n[t]=new Set([e]),!0;const i=n[t],r=i.has(e);return r||i.add(e),!r}function xF(n,e,t){const i=n[t];return i?i.delete(e):!1}function hP(n,e){const t=n.layerStatesArray[n.layerIndex];t.extent&&(e=Zl(e,Sa(t.extent,n.viewState.projection)));const i=t.layer.getRenderSource();if(!i.getWrapX()){const r=i.getTileGridForProjection(n.viewState.projection).getExtent();r&&(e=Zl(e,r))}return e}class SF extends w4{constructor(e,t){super(e),t=t||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=ir(),this.tempTileRange_=new Bx(0,0,0,0),this.tempTileCoord_=B0(0,0,0);const i=t.cacheSize!==void 0?t.cacheSize:512;this.tileCache_=new uP(i),this.sourceTileCache_=null,this.maxStaleKeys=i*.5}getTileCache(){return this.tileCache_}getSourceTileCache(){return this.sourceTileCache_||(this.sourceTileCache_=new uP(512)),this.sourceTileCache_}getOrCreateTile(e,t,i,r){const s=this.tileCache_,a=this.getLayer().getSource(),c=t0(a,a.getKey(),e,t,i);let h;if(s.containsKey(c))h=s.get(c);else{const d=r.viewState.projection,g=a.getProjection();if(h=a.getTile(e,t,i,r.pixelRatio,d,!g||Ef(g,d)?void 0:this.getSourceTileCache()),!h)return null;s.set(c,h)}return h}getTile(e,t,i,r){const s=this.getOrCreateTile(e,t,i,r);return s||null}getData(e){const t=this.frameState;if(!t)return null;const i=this.getLayer(),r=Mn(t.pixelToCoordinateTransform,e.slice()),s=i.getExtent();if(s&&!mh(s,r))return null;const o=t.viewState,a=i.getRenderSource(),c=a.getTileGridForProjection(o.projection),h=a.getTilePixelRatio(t.pixelRatio);for(let d=c.getZForResolution(o.resolution);d>=c.getMinZoom();--d){const g=c.getTileCoordForCoordAndZ(r,d),m=this.getTile(d,g[1],g[2],t);if(!m||m.getState()!==Fe.LOADED)continue;const y=c.getOrigin(d),w=Vi(c.getTileSize(d)),T=c.getResolution(d);let E;if(m instanceof L4||m instanceof N4)E=m.getImage();else if(m instanceof aP){if(E=jE(m.getData()),!E)continue}else continue;const P=Math.floor(h*((r[0]-y[0])/T-g[1]*w[0])),M=Math.floor(h*((y[1]-r[1])/T-g[2]*w[1])),N=Math.round(h*a.getGutterForProjection(o.projection));return this.getImageData(E,P+N,M+N)}return null}prepareFrame(e){this.renderedProjection?e.viewState.projection!==this.renderedProjection&&(this.tileCache_.clear(),this.renderedProjection=e.viewState.projection):this.renderedProjection=e.viewState.projection;const t=this.getLayer().getSource();if(!t)return!1;const i=t.getRevision();return this.renderedSourceRevision_?this.renderedSourceRevision_!==i&&(this.renderedSourceRevision_=i,this.renderedSourceKey_===t.getKey()&&(this.tileCache_.clear(),this.sourceTileCache_?.clear())):this.renderedSourceRevision_=i,!0}enqueueTilesForNextExtent(){return!0}enqueueTiles(e,t,i,r,s){const o=e.viewState,a=this.getLayer(),c=a.getRenderSource(),h=c.getTileGridForProjection(o.projection),d=ut(c);d in e.wantedTiles||(e.wantedTiles[d]={});const g=e.wantedTiles[d],m=a.getMapInternal(),y=Math.max(i-s,h.getMinZoom(),h.getZForResolution(Math.min(a.getMaxResolution(),m?m.getView().getResolutionForZoom(Math.max(a.getMinZoom(),0)):h.getResolution(0)),c.zDirection)),w=o.rotation,T=w?Tb(o.center,o.resolution,w,e.size):void 0;for(let E=i;E>=y;--E){const P=h.getTileRangeForExtentAndZ(t,E,this.tempTileRange_),M=h.getResolution(E);for(let N=P.minX;N<=P.maxX;++N)for(let D=P.minY;D<=P.maxY;++D){if(w&&!h.tileCoordIntersectsViewport([E,N,D],T))continue;const j=this.getTile(E,N,D,e);if(!j||!N1(r,j,E))continue;const L=j.getKey();if(g[L]=!0,j.getState()===Fe.IDLE&&!e.tileQueue.isKeyQueued(L)){const A=B0(E,N,D,this.tempTileCoord_);e.tileQueue.enqueue([j,d,h.getTileCoordCenter(A),M])}}}}findStaleTile_(e,t){const i=this.tileCache_,r=e[0],s=e[1],o=e[2],a=this.getStaleKeys();for(let c=0;c<a.length;++c){const h=t0(this.getLayer().getSource(),a[c],r,s,o);if(i.containsKey(h)){const d=i.peek(h);if(d.getState()===Fe.LOADED)return d.endTransition(ut(this)),N1(t,d,r),!0}}return!1}findAltTiles_(e,t,i,r){const s=e.getTileRangeForTileCoordAndZ(t,i,this.tempTileRange_);if(!s)return!1;let o=!0;const a=this.tileCache_,c=this.getLayer().getRenderSource(),h=c.getKey();for(let d=s.minX;d<=s.maxX;++d)for(let g=s.minY;g<=s.maxY;++g){const m=t0(c,h,i,d,g);let y=!1;if(a.containsKey(m)){const w=a.peek(m);w.getState()===Fe.LOADED&&(N1(r,w,i),y=!0)}y||(o=!1)}return o}renderFrame(e,t){this.renderComplete=!0;const i=e.layerStatesArray[e.layerIndex],r=e.viewState,s=r.projection,o=r.resolution,a=r.center,c=e.pixelRatio,h=this.getLayer(),d=h.getSource(),g=d.getTileGridForProjection(s),m=g.getZForResolution(o,d.zDirection),y=g.getResolution(m),w=d.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==w&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=w):this.renderedSourceKey_=w;let T=e.extent;const E=d.getTilePixelRatio(c);this.prepareContainer(e,t);const P=this.context.canvas.width,M=this.context.canvas.height,N=i.extent&&Sa(i.extent);N&&(T=Zl(T,Sa(i.extent)));const D=y*P/2/E,j=y*M/2/E,W=[a[0]-D,a[1]-j,a[0]+D,a[1]+j],L={};this.renderedTiles.length=0;const A=h.getPreload();if(e.nextExtent&&this.enqueueTilesForNextExtent()){const Q=g.getZForResolution(r.nextResolution,d.zDirection),ce=hP(e,e.nextExtent);this.enqueueTiles(e,ce,Q,L,A)}const k=hP(e,T);if(this.enqueueTiles(e,k,m,L,0),A>0&&setTimeout(()=>{this.enqueueTiles(e,k,m-1,L,A-1)},0),!(m in L))return this.container;const U=ut(this),B=e.time;for(const Q of L[m]){const ce=Q.getState();if(ce===Fe.EMPTY)continue;const K=Q.tileCoord;if(ce===Fe.LOADED&&Q.getAlpha(U,B)===1){Q.endTransition(U);continue}if(ce!==Fe.ERROR&&(this.renderComplete=!1),this.findStaleTile_(K,L)){xF(L,Q,m),e.animate=!0;continue}if(this.findAltTiles_(g,K,m+1,L))continue;const de=g.getMinZoom();for(let q=m-1;q>=de&&!this.findAltTiles_(g,K,q,L);--q);}const z=y/o*c/E,O=this.getRenderContext(e);Eo(this.tempTransform,P/2,M/2,z,z,0,-P/2,-M/2),i.extent&&this.clipUnrotated(O,e,N),d.getInterpolate()||(O.imageSmoothingEnabled=!1),this.preRender(O,e);const oe=Object.keys(L).map(Number);oe.sort(go);let Te;const we=[],_e=[];for(let Q=oe.length-1;Q>=0;--Q){const ce=oe[Q],K=d.getTilePixelSize(ce,c,s),I=g.getResolution(ce)/y,de=K[0]*I*z,q=K[1]*I*z,fe=g.getTileCoordForCoordAndZ(Ac(W),ce),X=g.getTileCoordExtent(fe),F=Mn(this.tempTransform,[E*(X[0]-W[0])/y,E*(W[3]-X[3])/y]),te=E*d.getGutterForProjection(s);for(const Pe of L[ce]){if(Pe.getState()!==Fe.LOADED)continue;const Be=Pe.tileCoord,Pt=fe[1]-Be[1],Kn=Math.round(F[0]-(Pt-1)*de),bn=fe[2]-Be[2],xi=Math.round(F[1]-(bn-1)*q),kn=Math.round(F[0]-Pt*de),Ln=Math.round(F[1]-bn*q),Si=Kn-kn,ar=xi-Ln,Mt=oe.length===1;let vt=!1;Te=[kn,Ln,kn+Si,Ln,kn+Si,Ln+ar,kn,Ln+ar];for(let Sn=0,lr=we.length;Sn<lr;++Sn)if(!Mt&&ce<_e[Sn]){const Gt=we[Sn];Ni([kn,Ln,kn+Si,Ln+ar],[Gt[0],Gt[3],Gt[4],Gt[7]])&&(vt||(O.save(),vt=!0),O.beginPath(),O.moveTo(Te[0],Te[1]),O.lineTo(Te[2],Te[3]),O.lineTo(Te[4],Te[5]),O.lineTo(Te[6],Te[7]),O.moveTo(Gt[6],Gt[7]),O.lineTo(Gt[4],Gt[5]),O.lineTo(Gt[2],Gt[3]),O.lineTo(Gt[0],Gt[1]),O.clip())}we.push(Te),_e.push(ce),this.drawTile(Pe,e,kn,Ln,Si,ar,te,Mt),vt&&O.restore(),this.renderedTiles.unshift(Pe),this.updateUsedTiles(e.usedTiles,d,Pe)}}if(this.renderedResolution=y,this.extentChanged=!this.renderedExtent_||!Wf(this.renderedExtent_,W),this.renderedExtent_=W,this.renderedPixelRatio=c,this.postRender(this.context,e),i.extent&&O.restore(),O.imageSmoothingEnabled=!0,this.renderComplete){const Q=(ce,K)=>{const V=ut(d),I=K.wantedTiles[V],de=I?Object.keys(I).length:0;this.updateCacheSize(de),this.tileCache_.expireCache(),this.sourceTileCache_?.expireCache()};e.postRenderFunctions.push(Q)}return this.container}updateCacheSize(e){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,e*2)}drawTile(e,t,i,r,s,o,a,c){let h;if(e instanceof aP){if(h=jE(e.getData()),!h)throw new Error("Rendering array data is not yet supported")}else h=this.getTileImage(e);if(!h)return;const d=this.getRenderContext(t),g=ut(this),m=t.layerStatesArray[t.layerIndex],y=m.opacity*(c?e.getAlpha(g,t.time):1),w=y!==d.globalAlpha;w&&(d.save(),d.globalAlpha=y),d.drawImage(h,a,a,h.width-2*a,h.height-2*a,i,r,s,o),w&&d.restore(),y!==m.opacity?t.animate=!0:c&&e.endTransition(g)}getImage(){const e=this.context;return e?e.canvas:null}getTileImage(e){return e.getImage()}updateUsedTiles(e,t,i){const r=ut(t);r in e||(e[r]={}),e[r][i.getKey()]=!0}}const Np={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class IF extends Z_{constructor(e){e=e||{};const t=Object.assign({},e),i=e.cacheSize;delete e.cacheSize,delete t.preload,delete t.useInterimTilesOnError,super(t),this.on,this.once,this.un,this.cacheSize_=i,this.setPreload(e.preload!==void 0?e.preload:0),this.setUseInterimTilesOnError(e.useInterimTilesOnError!==void 0?e.useInterimTilesOnError:!0)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(Np.PRELOAD)}setPreload(e){this.set(Np.PRELOAD,e)}getUseInterimTilesOnError(){return this.get(Np.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(e){this.set(Np.USE_INTERIM_TILES_ON_ERROR,e)}getData(e){return super.getData(e)}}class Ll extends IF{constructor(e){super(e)}createRenderer(){return new SF(this,{cacheSize:this.getCacheSize()})}}const Ru=[0,0,0],ca=5;class D4{constructor(e){this.minZoom=e.minZoom!==void 0?e.minZoom:0,this.resolutions_=e.resolutions,yt(z5(this.resolutions_,(r,s)=>s-r),"`resolutions` must be sorted in descending order");let t;if(!e.origins){for(let r=0,s=this.resolutions_.length-1;r<s;++r)if(!t)t=this.resolutions_[r]/this.resolutions_[r+1];else if(this.resolutions_[r]/this.resolutions_[r+1]!==t){t=void 0;break}}this.zoomFactor_=t,this.maxZoom=this.resolutions_.length-1,this.origin_=e.origin!==void 0?e.origin:null,this.origins_=null,e.origins!==void 0&&(this.origins_=e.origins,yt(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const i=e.extent;i!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=Ac(i)),yt(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,e.tileSizes!==void 0&&(this.tileSizes_=e.tileSizes,yt(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=e.tileSize!==void 0?e.tileSize:this.tileSizes_?null:Fx,yt(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=i!==void 0?i:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],e.sizes!==void 0?this.fullTileRanges_=e.sizes.map((r,s)=>{const o=new Bx(Math.min(0,r[0]),Math.max(r[0]-1,-1),Math.min(0,r[1]),Math.max(r[1]-1,-1));if(i){const a=this.getTileRangeForExtentAndZ(i,s);o.minX=Math.max(a.minX,o.minX),o.maxX=Math.min(a.maxX,o.maxX),o.minY=Math.max(a.minY,o.minY),o.maxY=Math.min(a.maxY,o.maxY)}return o}):i&&this.calculateTileRanges_(i)}forEachTileCoord(e,t,i){const r=this.getTileRangeForExtentAndZ(e,t);for(let s=r.minX,o=r.maxX;s<=o;++s)for(let a=r.minY,c=r.maxY;a<=c;++a)i([t,s,a])}forEachTileCoordParentTileRange(e,t,i,r){let s,o,a,c=null,h=e[0]-1;for(this.zoomFactor_===2?(o=e[1],a=e[2]):c=this.getTileCoordExtent(e,r);h>=this.minZoom;){if(o!==void 0&&a!==void 0?(o=Math.floor(o/2),a=Math.floor(a/2),s=Tu(o,o,a,a,i)):s=this.getTileRangeForExtentAndZ(c,h,i),t(h,s))return!0;--h}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(e){return this.origin_?this.origin_:this.origins_[e]}getResolution(e){return this.resolutions_[e]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(e,t,i){if(e[0]<this.maxZoom){if(this.zoomFactor_===2){const s=e[1]*2,o=e[2]*2;return Tu(s,s+1,o,o+1,t)}const r=this.getTileCoordExtent(e,i||this.tmpExtent_);return this.getTileRangeForExtentAndZ(r,e[0]+1,t)}return null}getTileRangeForTileCoordAndZ(e,t,i){if(t>this.maxZoom||t<this.minZoom)return null;const r=e[0],s=e[1],o=e[2];if(t===r)return Tu(s,o,s,o,i);if(this.zoomFactor_){const c=Math.pow(this.zoomFactor_,t-r),h=Math.floor(s*c),d=Math.floor(o*c);if(t<r)return Tu(h,h,d,d,i);const g=Math.floor(c*(s+1))-1,m=Math.floor(c*(o+1))-1;return Tu(h,g,d,m,i)}const a=this.getTileCoordExtent(e,this.tmpExtent_);return this.getTileRangeForExtentAndZ(a,t,i)}getTileRangeForExtentAndZ(e,t,i){this.getTileCoordForXYAndZ_(e[0],e[3],t,!1,Ru);const r=Ru[1],s=Ru[2];this.getTileCoordForXYAndZ_(e[2],e[1],t,!0,Ru);const o=Ru[1],a=Ru[2];return Tu(r,o,s,a,i)}getTileCoordCenter(e){const t=this.getOrigin(e[0]),i=this.getResolution(e[0]),r=Vi(this.getTileSize(e[0]),this.tmpSize_);return[t[0]+(e[1]+.5)*r[0]*i,t[1]-(e[2]+.5)*r[1]*i]}getTileCoordExtent(e,t){const i=this.getOrigin(e[0]),r=this.getResolution(e[0]),s=Vi(this.getTileSize(e[0]),this.tmpSize_),o=i[0]+e[1]*s[0]*r,a=i[1]-(e[2]+1)*s[1]*r,c=o+s[0]*r,h=a+s[1]*r;return Ga(o,a,c,h,t)}getTileCoordForCoordAndResolution(e,t,i){return this.getTileCoordForXYAndResolution_(e[0],e[1],t,!1,i)}getTileCoordForXYAndResolution_(e,t,i,r,s){const o=this.getZForResolution(i),a=i/this.getResolution(o),c=this.getOrigin(o),h=Vi(this.getTileSize(o),this.tmpSize_);let d=a*(e-c[0])/i/h[0],g=a*(c[1]-t)/i/h[1];return r?(d=Tp(d,ca)-1,g=Tp(g,ca)-1):(d=Ip(d,ca),g=Ip(g,ca)),B0(o,d,g,s)}getTileCoordForXYAndZ_(e,t,i,r,s){const o=this.getOrigin(i),a=this.getResolution(i),c=Vi(this.getTileSize(i),this.tmpSize_);let h=(e-o[0])/a/c[0],d=(o[1]-t)/a/c[1];return r?(h=Tp(h,ca)-1,d=Tp(d,ca)-1):(h=Ip(h,ca),d=Ip(d,ca)),B0(i,h,d,s)}getTileCoordForCoordAndZ(e,t,i){return this.getTileCoordForXYAndZ_(e[0],e[1],t,!1,i)}getTileCoordResolution(e){return this.resolutions_[e[0]]}getTileSize(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]}getFullTileRange(e){return this.fullTileRanges_?this.fullTileRanges_[e]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,e):null}getZForResolution(e,t){const i=ox(this.resolutions_,e,t||0);return Dt(i,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(e,t){return $b(t,0,t.length,2,this.getTileCoordExtent(e))}calculateTileRanges_(e){const t=this.resolutions_.length,i=new Array(t);for(let r=this.minZoom;r<t;++r)i[r]=this.getTileRangeForExtentAndZ(e,r);this.fullTileRanges_=i}}function V4(n){let e=n.getDefaultTileGrid();return e||(e=AF(n),n.setDefaultTileGrid(e)),e}function TF(n,e,t){const i=e[0],r=n.getTileCoordCenter(e),s=zx(t);if(!mh(s,r)){const o=ht(s),a=Math.ceil((s[0]-r[0])/o);return r[0]+=o*a,n.getTileCoordForCoordAndZ(r,i)}return e}function RF(n,e,t,i){i=i!==void 0?i:"top-left";const r=F4(n,e,t);return new D4({extent:n,origin:q5(n,i),resolutions:r,tileSize:t})}function PF(n){const e=n||{},t=e.extent||Vt("EPSG:3857").getExtent(),i={extent:t,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:F4(t,e.maxZoom,e.tileSize,e.maxResolution)};return new D4(i)}function F4(n,e,t,i){e=e!==void 0?e:rF,t=Vi(t!==void 0?t:Fx);const r=oi(n),s=ht(n);i=i>0?i:Math.max(s/t[0],r/t[1]);const o=e+1,a=new Array(o);for(let c=0;c<o;++c)a[c]=i/Math.pow(2,c);return a}function AF(n,e,t,i){const r=zx(n);return RF(r,e,t,i)}function zx(n){n=Vt(n);let e=n.getExtent();if(!e){const t=180*ph.degrees/n.getMetersPerUnit();e=Ga(-t,-t,t,t)}return e}function G4(n,e){const t=[];Object.keys(e).forEach(function(r){e[r]!==null&&e[r]!==void 0&&t.push(r+"="+encodeURIComponent(e[r]))});const i=t.join("&");return n=n.replace(/[?&]$/,""),n+=n.includes("?")?"&":"?",n+i}const CF=/\{z\}/g,MF=/\{x\}/g,bF=/\{y\}/g,kF=/\{-y\}/g;function LF(n,e,t,i,r){return n.replace(CF,e.toString()).replace(MF,t.toString()).replace(bF,i.toString()).replace(kF,function(){if(r===void 0)throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(r-i).toString()})}function NF(n){const e=[];let t=/\{([a-z])-([a-z])\}/.exec(n);if(t){const i=t[1].charCodeAt(0),r=t[2].charCodeAt(0);let s;for(s=i;s<=r;++s)e.push(n.replace(t[0],String.fromCharCode(s)));return e}if(t=/\{(\d+)-(\d+)\}/.exec(n),t){const i=parseInt(t[2],10);for(let r=parseInt(t[1],10);r<=i;r++)e.push(n.replace(t[0],r.toString()));return e}return e.push(n),e}function OF(n,e){return(function(t,i,r){if(!t)return;let s;const o=t[0];if(e){const a=e.getFullTileRange(o);a&&(s=a.getHeight()-1)}return LF(n,o,t[1],t[2],s)})}function DF(n,e){const t=n.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=OF(n[r],e);return VF(i)}function VF(n){return n.length===1?n[0]:(function(e,t,i){if(!e)return;const r=O4(e),s=Ma(r,n.length);return n[s](e,t,i)})}class FF extends m4{constructor(e){super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX,interpolate:e.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=e.tilePixelRatio!==void 0?e.tilePixelRatio:1,this.tileGrid=e.tileGrid!==void 0?e.tileGrid:null;const t=[256,256];this.tileGrid&&Vi(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),t),this.tmpSize=[0,0],this.key_=e.key||ut(this),this.tileOptions={transition:e.transition,interpolate:e.interpolate},this.zDirection=e.zDirection?e.zDirection:0}getGutterForProjection(e){return 0}getKey(){return this.key_}setKey(e){this.key_!==e&&(this.key_=e,this.changed())}getResolutions(e){const t=e?this.getTileGridForProjection(e):this.tileGrid;return t?t.getResolutions():null}getTile(e,t,i,r,s,o){return We()}getTileGrid(){return this.tileGrid}getTileGridForProjection(e){return this.tileGrid?this.tileGrid:V4(e)}getTilePixelRatio(e){return this.tilePixelRatio_}getTilePixelSize(e,t,i){const r=this.getTileGridForProjection(i),s=this.getTilePixelRatio(t),o=Vi(r.getTileSize(e),this.tmpSize);return s==1?o:$8(o,s,this.tmpSize)}getTileCoordForTileUrlFunction(e,t){const i=t!==void 0?t:this.getProjection(),r=t!==void 0?this.getTileGridForProjection(i):this.tileGrid||this.getTileGridForProjection(i);return this.getWrapX()&&i.isGlobal()&&(e=TF(r,e,i)),wF(e,r)?e:null}clear(){}refresh(){this.clear(),super.refresh()}}class GF extends Ao{constructor(e,t){super(e),this.tile=t}}const O1={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};class $x extends FF{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===$x.prototype.tileUrlFunction,this.tileLoadFunction=e.tileLoadFunction,e.tileUrlFunction&&(this.tileUrlFunction=e.tileUrlFunction),this.urls=null,e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(e){const t=e.target,i=ut(t),r=t.getState();let s;r==Fe.LOADING?(this.tileLoadingKeys_[i]=!0,s=O1.TILELOADSTART):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],s=r==Fe.ERROR?O1.TILELOADERROR:r==Fe.LOADED?O1.TILELOADEND:void 0),s!=null&&this.dispatchEvent(new GF(s,t))}setTileLoadFunction(e){this.tileLoadFunction=e,this.changed()}setTileUrlFunction(e,t){this.tileUrlFunction=e,typeof t<"u"?this.setKey(t):this.changed()}setUrl(e){const t=NF(e);this.urls=t,this.setUrls(t)}setUrls(e){this.urls=e;const t=e.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(DF(e,this.tileGrid),t):this.setKey(t)}tileUrlFunction(e,t,i){}}class j4 extends $x{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:U4,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate!==void 0?e.interpolate:!0,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.crossOrigin=e.crossOrigin!==void 0?e.crossOrigin:null,this.tileClass=e.tileClass!==void 0?e.tileClass:L4,this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(e){return this.getProjection()&&e&&!Ef(this.getProjection(),e)?0:this.getGutter()}getGutter(){return 0}getKey(){let e=super.getKey();return this.getInterpolate()||(e+=":disable-interpolation"),e}getTileGridForProjection(e){const t=this.getProjection();if(this.tileGrid&&(!t||Ef(t,e)))return this.tileGrid;const i=ut(e);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=V4(e)),this.tileGridForProjection[i]}createTile_(e,t,i,r,s,o){const a=[e,t,i],c=this.getTileCoordForTileUrlFunction(a,s),h=c?this.tileUrlFunction(c,r,s):void 0,d=new this.tileClass(a,h!==void 0?Fe.IDLE:Fe.EMPTY,h!==void 0?h:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return d.key=o,d.addEventListener(Qe.CHANGE,this.handleTileChange.bind(this)),d}getTile(e,t,i,r,s,o){const a=this.getProjection();if(!a||!s||Ef(a,s))return this.getTileInternal(e,t,i,r,a||s);const c=[e,t,i],h=this.getKey(),d=this.getTileGridForProjection(a),g=this.getTileGridForProjection(s),m=this.getTileCoordForTileUrlFunction(c,s),y=new N4(a,d,s,g,c,m,this.getTilePixelRatio(r),this.getGutter(),(w,T,E,P)=>this.getTileInternal(w,T,E,P,a,o),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return y.key=h,y}getTileInternal(e,t,i,r,s,o){const a=this.getKey(),c=t0(this,a,e,t,i);if(o&&o.containsKey(c))return o.get(c);const h=this.createTile_(e,t,i,r,s,a);return o?.set(c,h),h}setRenderReprojectionEdges(e){this.renderReprojectionEdges_!=e&&(this.renderReprojectionEdges_=e,this.changed())}setTileGridForProjection(e,t){const i=Vt(e);if(i){const r=ut(i);r in this.tileGridForProjection||(this.tileGridForProjection[r]=t)}}}function U4(n,e){if(er){const t=n.getCrossOrigin();let i="same-origin",r="same-origin";t==="anonymous"||t===""?(i="cors",r="omit"):t==="use-credentials"&&(i="cors",r="include"),fetch(e,{mode:i,credentials:r}).then(s=>{if(!s.ok)throw new Error(`HTTP ${s.status}`);return s.blob()}).then(s=>createImageBitmap(s)).then(s=>{const o=n.getImage();o.width=s.width,o.height=s.height,o.getContext("2d").drawImage(s,0,0),s.close?.(),o.dispatchEvent(new Event("load"))}).catch(()=>{n.getImage().dispatchEvent(new Event("error"))});return}n.getImage().src=e}class Vu extends j4{constructor(e){e=e||{};const t=e.projection!==void 0?e.projection:"EPSG:3857",i=e.tileGrid!==void 0?e.tileGrid:PF({extent:zx(t),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize});super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:t,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:i,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0}getGutter(){return this.gutter_}}const jF="modulepreload",UF=function(n){return"/detectorapp-nl/"+n},dP={},Ne=function(e,t,i){let r=Promise.resolve();if(t&&t.length>0){let c=function(h){return Promise.all(h.map(d=>Promise.resolve(d).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=o?.nonce||o?.getAttribute("nonce");r=c(t.map(h=>{if(h=UF(h),h in dP)return;dP[h]=!0;const d=h.endsWith(".css"),g=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${g}`))return;const m=document.createElement("link");if(m.rel=d?"stylesheet":jF,d||(m.as="script"),m.crossOrigin="",m.href=h,a&&m.setAttribute("nonce",a),document.head.appendChild(m),d)return new Promise((y,w)=>{m.addEventListener("load",y),m.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${h}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return r.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return e().catch(s)})},fP=4,BE="1.3.0";function BF(n,e,t,i,r){r.WIDTH=t[0],r.HEIGHT=t[1];const s=i.getAxisOrientation(),o=Ab(r.VERSION,"1.3")>=0;r[o?"CRS":"SRS"]=i.getCode();const a=o&&s.startsWith("ne")?[e[1],e[0],e[3],e[2]]:e;return r.BBOX=a.join(","),G4(n,r)}function zF(n,e,t,i,r,s,o){s=Object.assign({REQUEST:"GetMap"},s);const a=e/t,c=[mR(ht(n)/a,fP),mR(oi(n)/a,fP)];if(t!=1)switch(o){case"geoserver":const d=90*t+.5|0;"FORMAT_OPTIONS"in s?s.FORMAT_OPTIONS+=";dpi:"+d:s.FORMAT_OPTIONS="dpi:"+d;break;case"mapserver":s.MAP_RESOLUTION=90*t;break;case"carmentaserver":case"qgis":s.DPI=90*t;break;default:throw new Error("Unknown `serverType` configured")}return BF(r,n,c,i,s)}function gP(n,e){return Object.assign({REQUEST:e,SERVICE:"WMS",VERSION:BE,FORMAT:"image/png",STYLES:"",TRANSPARENT:"TRUE"},n)}const $F='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.';class WF extends Vu{constructor(e){e=e||{};let t;e.attributions!==void 0?t=e.attributions:t=[$F];const i=e.crossOrigin!==void 0?e.crossOrigin:"anonymous",r=e.url!==void 0?e.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:t,attributionsCollapsible:!1,cacheSize:e.cacheSize,crossOrigin:i,interpolate:e.interpolate,maxZoom:e.maxZoom!==void 0?e.maxZoom:19,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileLoadFunction:(s,o)=>{const a=s.getImage();!er&&a instanceof HTMLImageElement&&(a.referrerPolicy="origin-when-cross-origin"),(e.tileLoadFunction||U4)(s,o)},transition:e.transition,url:r,wrapX:e.wrapX,zDirection:e.zDirection})}}const z0=1/0;class HF{constructor(e,t){this.priorityFunction_=e,this.keyFunction_=t,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,bg(this.queuedElements_)}dequeue(){const e=this.elements_,t=this.priorities_,i=e[0];e.length==1?(e.length=0,t.length=0):(e[0]=e.pop(),t[0]=t.pop(),this.siftUp_(0));const r=this.keyFunction_(i);return delete this.queuedElements_[r],i}enqueue(e){yt(!(this.keyFunction_(e)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const t=this.priorityFunction_(e);return t!=z0?(this.elements_.push(e),this.priorities_.push(t),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(e){return e*2+1}getRightChildIndex_(e){return e*2+2}getParentIndex_(e){return e-1>>1}heapify_(){let e;for(e=(this.elements_.length>>1)-1;e>=0;e--)this.siftUp_(e)}isEmpty(){return this.elements_.length===0}isKeyQueued(e){return e in this.queuedElements_}isQueued(e){return this.isKeyQueued(this.keyFunction_(e))}siftUp_(e){const t=this.elements_,i=this.priorities_,r=t.length,s=t[e],o=i[e],a=e;for(;e<r>>1;){const c=this.getLeftChildIndex_(e),h=this.getRightChildIndex_(e),d=h<r&&i[h]<i[c]?h:c;t[e]=t[d],i[e]=i[d],e=d}t[e]=s,i[e]=o,this.siftDown_(a,e)}siftDown_(e,t){const i=this.elements_,r=this.priorities_,s=i[t],o=r[t];for(;t>e;){const a=this.getParentIndex_(t);if(r[a]>o)i[t]=i[a],r[t]=r[a],t=a;else break}i[t]=s,r[t]=o}reprioritize(){const e=this.priorityFunction_,t=this.elements_,i=this.priorities_;let r=0;const s=t.length;let o,a,c;for(a=0;a<s;++a)o=t[a],c=e(o),c==z0?delete this.queuedElements_[this.keyFunction_(o)]:(i[r]=c,t[r++]=o);t.length=r,i.length=r,this.heapify_()}}class KF extends HF{constructor(e,t){super(i=>e.apply(null,i),i=>i[0].getKey()),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=t,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(e){const t=super.enqueue(e);return t&&e[0].addEventListener(Qe.CHANGE,this.boundHandleTileChange_),t}getTilesLoading(){return this.tilesLoading_}handleTileChange(e){const t=e.target,i=t.getState();if(i===Fe.LOADED||i===Fe.ERROR||i===Fe.EMPTY){i!==Fe.ERROR&&t.removeEventListener(Qe.CHANGE,this.boundHandleTileChange_);const r=t.getKey();r in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[r],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(e,t){let i=0;for(;this.tilesLoading_<e&&i<t&&this.getCount()>0;){const r=this.dequeue()[0],s=r.getKey();r.getState()===Fe.IDLE&&!(s in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[s]=!0,++this.tilesLoading_,++i,r.load())}}}function qF(n,e,t,i,r){if(!n||!(t in n.wantedTiles)||!n.wantedTiles[t][e.getKey()])return z0;const s=n.viewState.center,o=i[0]-s[0],a=i[1]-s[1];return 65536*Math.log(r)+Math.sqrt(o*o+a*a)/r}class YF extends j4{constructor(e){e=e||{};const t=Object.assign({},e.params);super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:e.projection,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileClass:e.tileClass,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0,this.params_=t,this.v13_=!0,this.serverType_=e.serverType,this.hidpi_=e.hidpi!==void 0?e.hidpi:!0,this.tmpExtent_=ir(),this.updateV13_(),this.setKey(this.getKeyForParams_())}getFeatureInfoUrl(e,t,i,r){const s=Vt(i),o=this.getProjection()||s;let a=this.getTileGrid();a||(a=this.getTileGridForProjection(o));const c=Vg(e,s,o),h=UE(o,s,e,t),d=a.getZForResolution(h,this.zDirection),g=a.getResolution(d),m=a.getTileCoordForCoordAndZ(c,d);if(a.getResolutions().length<=m[0])return;let y=a.getTileCoordExtent(m,this.tmpExtent_);const w=this.gutter_;w!==0&&(y=$f(y,g*w,y));const T={QUERY_LAYERS:this.params_.LAYERS};Object.assign(T,gP(this.params_,"GetFeatureInfo"),r);const E=Math.floor((c[0]-y[0])/g),P=Math.floor((y[3]-c[1])/g);return T[this.v13_?"I":"X"]=E,T[this.v13_?"J":"Y"]=P,this.getRequestUrl_(m,y,1,o||s,T)}getLegendUrl(e,t){if(this.urls[0]===void 0)return;const i={SERVICE:"WMS",VERSION:BE,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(t===void 0||t.LAYER===void 0){const r=this.params_.LAYERS;if(!(!Array.isArray(r)||r.length===1))return;i.LAYER=r}if(e!==void 0){const r=this.getProjection()?this.getProjection().getMetersPerUnit():1,s=28e-5;i.SCALE=e*r/s}return Object.assign(i,t),G4(this.urls[0],i)}getGutter(){return this.gutter_}getParams(){return this.params_}getRequestUrl_(e,t,i,r,s){const o=this.urls;if(!o)return;let a;if(o.length==1)a=o[0];else{const c=Ma(O4(e),o.length);a=o[c]}return zF(t,(this.tileGrid||this.getTileGridForProjection(r)).getResolution(e[0]),i,r,a,s,this.serverType_)}getTilePixelRatio(e){return!this.hidpi_||this.serverType_===void 0?1:e}getKeyForParams_(){let e=0;const t=[];for(const i in this.params_)t[e++]=i+"-"+this.params_[i];return t.join("/")}setParams_(e){this.params_=e,this.updateV13_(),this.setKey(this.getKeyForParams_())}setParams(e){this.setParams_(Object.assign({},e))}updateParams(e){this.setParams_(Object.assign(this.params_,e))}updateV13_(){const e=this.params_.VERSION||BE;this.v13_=Ab(e,"1.3")>=0}tileUrlFunction(e,t,i){let r=this.getTileGrid();if(r||(r=this.getTileGridForProjection(i)),r.getResolutions().length<=e[0])return;t!=1&&(!this.hidpi_||this.serverType_===void 0)&&(t=1);const s=r.getResolution(e[0]);let o=r.getTileCoordExtent(e,this.tmpExtent_);const a=this.gutter_;a!==0&&(o=$f(o,s*a,o));const c=Object.assign({},gP(this.params_,"GetMap"));return this.getRequestUrl_(e,o,t,i,c)}}class Fu extends Ao{constructor(e,t,i){super(e),this.map=t,this.frameState=i!==void 0?i:null}}class ga extends Fu{constructor(e,t,i,r,s,o){super(e,t,s),this.originalEvent=i,this.pixel_=null,this.coordinate_=null,this.dragging=r!==void 0?r:!1,this.activePointers=o}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(e){this.pixel_=e}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(e){this.coordinate_=e}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const Xt={SINGLECLICK:"singleclick",CLICK:Qe.CLICK,DBLCLICK:Qe.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},zE={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown"};class XF extends kg{constructor(e,t){super(e),this.map_=e,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=t===void 0?1:t,this.down_=null;const i=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=i,this.pointerdownListenerKey_=lt(i,zE.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=lt(i,zE.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(Qe.TOUCHMOVE,this.boundHandleTouchMove_,Xb?{passive:!1}:!1)}emulateClick_(e){let t=new ga(Xt.CLICK,this.map_,e);this.dispatchEvent(t),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,t=new ga(Xt.DBLCLICK,this.map_,e),this.dispatchEvent(t)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const i=new ga(Xt.SINGLECLICK,this.map_,e);this.dispatchEvent(i)},250)}updateActivePointers_(e){const t=e,i=t.pointerId;if(t.type==Xt.POINTERUP||t.type==Xt.POINTERCANCEL){delete this.trackedTouches_[i];for(const r in this.trackedTouches_)if(this.trackedTouches_[r].target!==t.target){delete this.trackedTouches_[r];break}}else(t.type==Xt.POINTERDOWN||t.type==Xt.POINTERMOVE)&&(this.trackedTouches_[i]=t);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(e){this.updateActivePointers_(e);const t=new ga(Xt.POINTERUP,this.map_,e,void 0,void 0,this.activePointers_);this.dispatchEvent(t),this.emulateClicks_&&!t.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(e)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(Ot),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(e){return e.button===0}handlePointerDown_(e){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(e);const t=new ga(Xt.POINTERDOWN,this.map_,e,void 0,void 0,this.activePointers_);if(this.dispatchEvent(t),this.down_=new PointerEvent(e.type,e),Object.defineProperty(this.down_,"target",{writable:!1,value:e.target}),this.dragListenerKeys_.length===0){const i=this.map_.getOwnerDocument();this.dragListenerKeys_.push(lt(i,Xt.POINTERMOVE,this.handlePointerMove_,this),lt(i,Xt.POINTERUP,this.handlePointerUp_,this),lt(this.element_,Xt.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==i&&this.dragListenerKeys_.push(lt(this.element_.getRootNode(),Xt.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(e){if(this.isMoving_(e)){this.updateActivePointers_(e),this.dragging_=!0;const t=new ga(Xt.POINTERDRAG,this.map_,e,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(t)}}relayMoveEvent_(e){this.originalPointerMoveEvent_=e;const t=!!(this.down_&&this.isMoving_(e));this.dispatchEvent(new ga(Xt.POINTERMOVE,this.map_,e,t))}handleTouchMove_(e){const t=this.originalPointerMoveEvent_;(!t||t.defaultPrevented)&&(typeof e.cancelable!="boolean"||e.cancelable===!0)&&e.preventDefault()}isMoving_(e){return this.dragging_||Math.abs(e.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(e.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(Ot(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(Qe.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(Ot(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(Ot),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const ma={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},ei={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"};class ey extends js{constructor(e){super();const t=e.element;t&&!e.target&&!t.style.pointerEvents&&(t.style.pointerEvents="auto"),this.element=t||null,this.target_=null,this.map_=null,this.listenerKeys=[],e.render&&(this.render=e.render),e.target&&this.setTarget(e.target)}disposeInternal(){this.element?.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(e){this.map_&&this.element?.remove();for(let t=0,i=this.listenerKeys.length;t<i;++t)Ot(this.listenerKeys[t]);if(this.listenerKeys.length=0,this.map_=e,e){const t=this.target_??e.getOverlayContainerStopEvent();this.element&&t.appendChild(this.element),this.render!==zf&&this.listenerKeys.push(lt(e,ma.POSTRENDER,this.render,this)),e.render()}}render(e){}setTarget(e){this.target_=typeof e=="string"?document.getElementById(e):e}}class QF extends ey{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=e.collapsed!==void 0?e.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=e.collapsible!==void 0,this.collapsible_=e.collapsible!==void 0?e.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.attributions_=e.attributions;const t=e.className!==void 0?e.className:"ol-attribution",i=e.tipLabel!==void 0?e.tipLabel:"Attributions",r=e.expandClassName!==void 0?e.expandClassName:t+"-expand",s=e.collapseLabel!==void 0?e.collapseLabel:"",o=e.collapseClassName!==void 0?e.collapseClassName:t+"-collapse";typeof s=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=s,this.collapseLabel_.className=o):this.collapseLabel_=s;const a=e.label!==void 0?e.label:"i";typeof a=="string"?(this.label_=document.createElement("span"),this.label_.textContent=a,this.label_.className=r):this.label_=a;const c=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=i,this.toggleButton_.appendChild(c),this.toggleButton_.addEventListener(Qe.CLICK,this.handleClick_.bind(this),!1);const h=t+" "+Gg+" "+Px+(this.collapsed_&&this.collapsible_?" "+MR:"")+(this.collapsible_?"":" ol-uncollapsible"),d=this.element;d.className=h,d.appendChild(this.toggleButton_),d.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(e){const t=this.getMap().getAllLayers(),i=new Set(t.flatMap(r=>r.getAttributions(e)));if(this.attributions_!==void 0&&(Array.isArray(this.attributions_)?this.attributions_.forEach(r=>i.add(r)):i.add(this.attributions_)),!this.overrideCollapsible_){const r=!t.some(s=>s.getSource()?.getAttributionsCollapsible()===!1);this.setCollapsible(r)}return Array.from(i)}async updateElement_(e){if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=await Promise.all(this.collectSourceAttributions_(e).map(r=>yb(()=>r))),i=t.length>0;if(this.renderedVisible_!=i&&(this.element.style.display=i?"":"none",this.renderedVisible_=i),!Za(t,this.renderedAttributions_)){Q6(this.ulElement_);for(let r=0,s=t.length;r<s;++r){const o=document.createElement("li");o.innerHTML=t[r],this.ulElement_.appendChild(o)}this.renderedAttributions_=t}}handleClick_(e){e.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(MR),this.collapsed_?AR(this.collapseLabel_,this.label_):AR(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(e){this.userCollapsed_=e,!(!this.collapsible_||this.collapsed_===e)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(e){this.updateElement_(e.frameState)}}class ZF extends ey{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target});const t=e.className!==void 0?e.className:"ol-rotate",i=e.label!==void 0?e.label:"",r=e.compassClassName!==void 0?e.compassClassName:"ol-compass";this.label_=null,typeof i=="string"?(this.label_=document.createElement("span"),this.label_.className=r,this.label_.textContent=i):(this.label_=i,this.label_.classList.add(r));const s=e.tipLabel?e.tipLabel:"Reset rotation",o=document.createElement("button");o.className=t+"-reset",o.setAttribute("type","button"),o.title=s,o.appendChild(this.label_),o.addEventListener(Qe.CLICK,this.handleClick_.bind(this),!1);const a=t+" "+Gg+" "+Px,c=this.element;c.className=a,c.appendChild(o),this.callResetNorth_=e.resetNorth?e.resetNorth:void 0,this.duration_=e.duration!==void 0?e.duration:250,this.autoHide_=e.autoHide!==void 0?e.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(Ap)}handleClick_(e){e.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const t=this.getMap().getView();if(!t)return;const i=t.getRotation();i!==void 0&&(this.duration_>0&&i%(2*Math.PI)!==0?t.animate({rotation:0,duration:this.duration_,easing:Bh}):t.setRotation(0))}render(e){const t=e.frameState;if(!t)return;const i=t.viewState.rotation;if(i!=this.rotation_){const r="rotate("+i+"rad)";if(this.autoHide_){const s=this.element.classList.contains(Ap);!s&&i===0?this.element.classList.add(Ap):s&&i!==0&&this.element.classList.remove(Ap)}this.label_.style.transform=r}this.rotation_=i}}class JF extends ey{constructor(e){e=e||{},super({element:document.createElement("div"),target:e.target});const t=e.className!==void 0?e.className:"ol-zoom",i=e.delta!==void 0?e.delta:1,r=e.zoomInClassName!==void 0?e.zoomInClassName:t+"-in",s=e.zoomOutClassName!==void 0?e.zoomOutClassName:t+"-out",o=e.zoomInLabel!==void 0?e.zoomInLabel:"+",a=e.zoomOutLabel!==void 0?e.zoomOutLabel:"",c=e.zoomInTipLabel!==void 0?e.zoomInTipLabel:"Zoom in",h=e.zoomOutTipLabel!==void 0?e.zoomOutTipLabel:"Zoom out",d=document.createElement("button");d.className=r,d.setAttribute("type","button"),d.title=c,d.appendChild(typeof o=="string"?document.createTextNode(o):o),d.addEventListener(Qe.CLICK,this.handleClick_.bind(this,i),!1);const g=document.createElement("button");g.className=s,g.setAttribute("type","button"),g.title=h,g.appendChild(typeof a=="string"?document.createTextNode(a):a),g.addEventListener(Qe.CLICK,this.handleClick_.bind(this,-i),!1);const m=t+" "+Gg+" "+Px,y=this.element;y.className=m,y.appendChild(d),y.appendChild(g),this.duration_=e.duration!==void 0?e.duration:250}handleClick_(e,t){t.preventDefault(),this.zoomByDelta_(e)}zoomByDelta_(e){const i=this.getMap().getView();if(!i)return;const r=i.getZoom();if(r!==void 0){const s=i.getConstrainedZoom(r+e);this.duration_>0?(i.getAnimating()&&i.cancelAnimations(),i.animate({zoom:s,duration:this.duration_,easing:Bh})):i.setZoom(s)}}}function e9(n){n=n||{};const e=new Rr;return(n.zoom===void 0||n.zoom)&&e.push(new JF(n.zoomOptions)),(n.rotate===void 0||n.rotate)&&e.push(new ZF(n.rotateOptions)),(n.attribution===void 0||n.attribution)&&e.push(new QF(n.attributionOptions)),e}class t9{constructor(e,t,i){this.decay_=e,this.minVelocity_=t,this.delay_=i,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(e,t){this.points_.push(e,t,Date.now())}end(){if(this.points_.length<6)return!1;const e=Date.now()-this.delay_,t=this.points_.length-3;if(this.points_[t+2]<e)return!1;let i=t-3;for(;i>0&&this.points_[i+2]>e;)i-=3;const r=this.points_[t+2]-this.points_[i+2];if(r<1e3/60)return!1;const s=this.points_[t]-this.points_[i],o=this.points_[t+1]-this.points_[i+1];return this.angle_=Math.atan2(o,s),this.initialVelocity_=Math.sqrt(s*s+o*o)/r,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}const mP={ACTIVE:"active"};class Bg extends js{constructor(e){super(),this.on,this.once,this.un,e&&e.handleEvent&&(this.handleEvent=e.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(mP.ACTIVE)}getMap(){return this.map_}handleEvent(e){return!0}setActive(e){this.set(mP.ACTIVE,e)}setMap(e){this.map_=e}}function n9(n,e,t){const i=n.getCenterInternal();if(i){const r=[i[0]+e[0],i[1]+e[1]];n.animateInternal({duration:t!==void 0?t:250,easing:JV,center:n.getConstrainedCenter(r)})}}function Wx(n,e,t,i){const r=n.getZoom();if(r===void 0)return;const s=n.getConstrainedZoom(r+e),o=n.getResolutionForZoom(s);n.getAnimating()&&n.cancelAnimations(),n.animate({resolution:o,anchor:t,duration:i!==void 0?i:250,easing:Bh})}class i9 extends Bg{constructor(e){super(),e=e||{},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:250}handleEvent(e){let t=!1;if(e.type==Xt.DBLCLICK){const i=e.originalEvent,r=e.map,s=e.coordinate,o=i.shiftKey?-this.delta_:this.delta_,a=r.getView();Wx(a,o,s,this.duration_),i.preventDefault(),t=!0}return!t}}function $E(n){const e=arguments;return function(t){let i=!0;for(let r=0,s=e.length;r<s&&(i=i&&e[r](t),!!i);++r);return i}}const r9=function(n){const e=n.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},s9=function(n){const e=n.map.getTargetElement(),t=e.getRootNode(),i=n.map.getOwnerDocument().activeElement;return t instanceof ShadowRoot?t.host.contains(i):e.contains(i)},B4=function(n){const e=n.map.getTargetElement(),t=e.getRootNode();return(t instanceof ShadowRoot?t.host:e).hasAttribute("tabindex")?s9(n):!0},o9=Bf,z4=function(n){const e=n.originalEvent;return"pointerId"in e&&e.button==0&&!(Y6&&qb&&e.ctrlKey)},$4=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},a9=function(n){const e=n.originalEvent;return qb?e.metaKey:e.ctrlKey},l9=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},W4=function(n){const e=n.originalEvent,t=e.target.tagName;return t!=="INPUT"&&t!=="SELECT"&&t!=="TEXTAREA"&&!e.target.isContentEditable},D1=function(n){const e=n.originalEvent;return"pointerId"in e&&e.pointerType=="mouse"},c9=function(n){const e=n.originalEvent;return"pointerId"in e&&e.isPrimary&&e.button===0};class zg extends Bg{constructor(e){e=e||{},super(e),e.handleDownEvent&&(this.handleDownEvent=e.handleDownEvent),e.handleDragEvent&&(this.handleDragEvent=e.handleDragEvent),e.handleMoveEvent&&(this.handleMoveEvent=e.handleMoveEvent),e.handleUpEvent&&(this.handleUpEvent=e.handleUpEvent),e.stopDown&&(this.stopDown=e.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(e){return!1}handleDragEvent(e){}handleEvent(e){if(!e.originalEvent)return!0;let t=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence){if(e.type==Xt.POINTERDRAG)this.handleDragEvent(e),e.originalEvent.preventDefault();else if(e.type==Xt.POINTERUP){const i=this.handleUpEvent(e);this.handlingDownUpSequence=i&&this.targetPointers.length>0}}else if(e.type==Xt.POINTERDOWN){const i=this.handleDownEvent(e);this.handlingDownUpSequence=i,t=this.stopDown(i)}else e.type==Xt.POINTERMOVE&&this.handleMoveEvent(e);return!t}handleMoveEvent(e){}handleUpEvent(e){return!1}stopDown(e){return e}updateTrackedPointers_(e){e.activePointers&&(this.targetPointers=e.activePointers)}}function Hx(n){const e=n.length;let t=0,i=0;for(let r=0;r<e;r++)t+=n[r].clientX,i+=n[r].clientY;return{clientX:t/e,clientY:i/e}}class u9 extends zg{constructor(e){super({stopDown:D_}),e=e||{},this.kinetic_=e.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const t=e.condition?e.condition:$E($4,c9);this.condition_=e.onFocusOnly?$E(B4,t):t,this.noKinetic_=!1}handleDragEvent(e){const t=e.map;this.panning_||(this.panning_=!0,t.getView().beginInteraction());const i=this.targetPointers,r=t.getEventPixel(Hx(i));if(i.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(r[0],r[1]),this.lastCentroid){const s=[this.lastCentroid[0]-r[0],r[1]-this.lastCentroid[1]],a=e.map.getView();e6(s,a.getResolution()),cx(s,a.getRotation()),a.adjustCenterInternal(s)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=r,this.lastPointersCount_=i.length,e.originalEvent.preventDefault()}handleUpEvent(e){const t=e.map,i=t.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const r=this.kinetic_.getDistance(),s=this.kinetic_.getAngle(),o=i.getCenterInternal(),a=t.getPixelFromCoordinateInternal(o),c=t.getCoordinateFromPixelInternal([a[0]-r*Math.cos(s),a[1]-r*Math.sin(s)]);i.animateInternal({center:i.getConstrainedCenter(c),duration:500,easing:Bh})}return this.panning_&&(this.panning_=!1,i.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(e){if(this.targetPointers.length>0&&this.condition_(e)){const i=e.map.getView();return this.lastCentroid=null,i.getAnimating()&&i.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}class h9 extends zg{constructor(e){e=e||{},super({stopDown:D_}),this.condition_=e.condition?e.condition:r9,this.lastAngle_=void 0,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){if(!D1(e))return;const t=e.map,i=t.getView();if(i.getConstraints().rotation===Vx)return;const r=t.getSize(),s=e.pixel,o=Math.atan2(r[1]/2-s[1],s[0]-r[0]/2);if(this.lastAngle_!==void 0){const a=o-this.lastAngle_;i.adjustRotationInternal(-a)}this.lastAngle_=o}handleUpEvent(e){return D1(e)?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){return D1(e)&&z4(e)&&this.condition_(e)?(e.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}class d9 extends O_{constructor(e){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+e,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const e=this.startPixel_,t=this.endPixel_,i="px",r=this.element_.style;r.left=Math.min(e[0],t[0])+i,r.top=Math.min(e[1],t[1])+i,r.width=Math.abs(t[0]-e[0])+i,r.height=Math.abs(t[1]-e[1])+i}setMap(e){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const t=this.element_.style;t.left="inherit",t.top="inherit",t.width="inherit",t.height="inherit"}this.map_=e,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(e,t){this.startPixel_=e,this.endPixel_=t,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;const e=this.startPixel_,t=this.endPixel_,r=[e,[e[0],t[1]],t,[t[0],e[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);r[4]=r[0].slice(),this.geometry_?this.geometry_.setCoordinates([r]):this.geometry_=new Ua([r])}getGeometry(){return this.geometry_}}const Pu={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class $d extends Ao{constructor(e,t,i){super(e),this.coordinate=t,this.mapBrowserEvent=i}}class f9 extends zg{constructor(e){super(),this.on,this.once,this.un,e=e??{},this.box_=new d9(e.className||"ol-dragbox"),this.minArea_=e.minArea??64,e.onBoxEnd&&(this.onBoxEnd=e.onBoxEnd),this.startPixel_=null,this.condition_=e.condition??z4,this.boxEndCondition_=e.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(e,t,i){const r=i[0]-t[0],s=i[1]-t[1];return r*r+s*s>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(e){this.startPixel_&&(this.box_.setPixels(this.startPixel_,e.pixel),this.dispatchEvent(new $d(Pu.BOXDRAG,e.coordinate,e)))}handleUpEvent(e){if(!this.startPixel_)return!1;const t=this.boxEndCondition_(e,this.startPixel_,e.pixel);return t&&this.onBoxEnd(e),this.dispatchEvent(new $d(t?Pu.BOXEND:Pu.BOXCANCEL,e.coordinate,e)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(e){return this.condition_(e)?(this.startPixel_=e.pixel,this.box_.setMap(e.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new $d(Pu.BOXSTART,e.coordinate,e)),!0):!1}onBoxEnd(e){}setActive(e){e||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new $d(Pu.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setActive(e)}setMap(e){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new $d(Pu.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setMap(e)}}class g9 extends f9{constructor(e){e=e||{};const t=e.condition?e.condition:l9;super({condition:t,className:e.className||"ol-dragzoom",minArea:e.minArea}),this.duration_=e.duration!==void 0?e.duration:200,this.out_=e.out!==void 0?e.out:!1}onBoxEnd(e){const i=this.getMap().getView();let r=this.getGeometry();if(this.out_){const s=i.rotatedExtentForGeometry(r),o=i.getResolutionForExtentInternal(s),a=i.getResolution()/o;r=r.clone(),r.scale(a*a)}i.fitInternal(r,{duration:this.duration_,easing:Bh})}}const Cl={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};class m9 extends Bg{constructor(e){super(),e=e||{},this.defaultCondition_=function(t){return $4(t)&&W4(t)},this.condition_=e.condition!==void 0?e.condition:this.defaultCondition_,this.duration_=e.duration!==void 0?e.duration:100,this.pixelDelta_=e.pixelDelta!==void 0?e.pixelDelta:128}handleEvent(e){let t=!1;if(e.type==Qe.KEYDOWN){const i=e.originalEvent,r=i.key;if(this.condition_(e)&&(r==Cl.DOWN||r==Cl.LEFT||r==Cl.RIGHT||r==Cl.UP)){const o=e.map.getView(),a=o.getResolution()*this.pixelDelta_;let c=0,h=0;r==Cl.DOWN?h=-a:r==Cl.LEFT?c=-a:r==Cl.RIGHT?c=a:h=a;const d=[c,h];cx(d,o.getRotation()),n9(o,d,this.duration_),i.preventDefault(),t=!0}}return!t}}class p9 extends Bg{constructor(e){super(),e=e||{},this.condition_=e.condition?e.condition:function(t){return!a9(t)&&W4(t)},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:100}handleEvent(e){let t=!1;if(e.type==Qe.KEYDOWN||e.type==Qe.KEYPRESS){const i=e.originalEvent,r=i.key;if(this.condition_(e)&&(r==="+"||r==="-")){const s=e.map,o=r==="+"?this.delta_:-this.delta_,a=s.getView();Wx(a,o,void 0,this.duration_),i.preventDefault(),t=!0}}return!t}}const _9=40,y9=300;class v9 extends Bg{constructor(e){e=e||{},super(e),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=e.maxDelta!==void 0?e.maxDelta:1,this.duration_=e.duration!==void 0?e.duration:250,this.timeout_=e.timeout!==void 0?e.timeout:80,this.useAnchor_=e.useAnchor!==void 0?e.useAnchor:!0,this.constrainResolution_=e.constrainResolution!==void 0?e.constrainResolution:!1;const t=e.condition?e.condition:o9;this.condition_=e.onFocusOnly?$E(B4,t):t,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const e=this.getMap();if(!e)return;e.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null)}handleEvent(e){if(!this.condition_(e)||e.type!==Qe.WHEEL)return!0;const i=e.map,r=e.originalEvent;r.preventDefault(),this.useAnchor_&&(this.lastAnchor_=e.pixel);let s=r.deltaY;switch(r.deltaMode){case WheelEvent.DOM_DELTA_LINE:s*=_9;break;case WheelEvent.DOM_DELTA_PAGE:s*=y9;break}if(s===0)return!1;this.lastDelta_=s;const o=Date.now();this.startTime_===void 0&&(this.startTime_=o),(!this.mode_||o-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(s)<4?"trackpad":"wheel");const a=i.getView();if(this.mode_==="trackpad"&&!(a.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(a.getAnimating()&&a.cancelAnimations(),a.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),a.adjustZoom(-s/this.deltaPerZoom_,this.lastAnchor_?i.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=o,!1;this.totalDelta_+=s;const c=Math.max(this.timeout_-(o-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,i),c),!1}handleWheelZoom_(e){const t=e.getView();t.getAnimating()&&t.cancelAnimations();let i=-Dt(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(t.getConstrainResolution()||this.constrainResolution_)&&(i=i?i>0?1:-1:0),Wx(t,i,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(e){this.useAnchor_=e,e||(this.lastAnchor_=null)}}class E9 extends zg{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=D_),super(t),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=e.threshold!==void 0?e.threshold:.3,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){let t=0;const i=this.targetPointers[0],r=this.targetPointers[1],s=Math.atan2(r.clientY-i.clientY,r.clientX-i.clientX);if(this.lastAngle_!==void 0){const c=s-this.lastAngle_;this.rotationDelta_+=c,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),t=c}this.lastAngle_=s;const o=e.map,a=o.getView();a.getConstraints().rotation!==Vx&&(this.anchor_=o.getCoordinateFromPixelInternal(o.getEventPixel(Hx(this.targetPointers))),this.rotating_&&(o.render(),a.adjustRotationInternal(t,this.anchor_)))}handleUpEvent(e){return this.targetPointers.length<2?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}class w9 extends zg{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=D_),super(t),this.anchor_=null,this.duration_=e.duration!==void 0?e.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(e){let t=1;const i=this.targetPointers[0],r=this.targetPointers[1],s=i.clientX-r.clientX,o=i.clientY-r.clientY,a=Math.sqrt(s*s+o*o);this.lastDistance_!==void 0&&(t=this.lastDistance_/a),this.lastDistance_=a;const c=e.map,h=c.getView();t!=1&&(this.lastScaleDelta_=t),this.anchor_=c.getCoordinateFromPixelInternal(c.getEventPixel(Hx(this.targetPointers))),c.render(),h.adjustResolutionInternal(t,this.anchor_)}handleUpEvent(e){if(this.targetPointers.length<2){const i=e.map.getView(),r=this.lastScaleDelta_>1?1:-1;return i.endInteraction(this.duration_,r),!1}return!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}function x9(n){n=n||{};const e=new Rr,t=new t9(-.005,.05,100);return(n.altShiftDragRotate===void 0||n.altShiftDragRotate)&&e.push(new h9),(n.doubleClickZoom===void 0||n.doubleClickZoom)&&e.push(new i9({delta:n.zoomDelta,duration:n.zoomDuration})),(n.dragPan===void 0||n.dragPan)&&e.push(new u9({onFocusOnly:n.onFocusOnly,kinetic:t})),(n.pinchRotate===void 0||n.pinchRotate)&&e.push(new E9),(n.pinchZoom===void 0||n.pinchZoom)&&e.push(new w9({duration:n.zoomDuration})),(n.keyboard===void 0||n.keyboard)&&(e.push(new m9),e.push(new p9({delta:n.zoomDelta,duration:n.zoomDuration}))),(n.mouseWheelZoom===void 0||n.mouseWheelZoom)&&e.push(new v9({onFocusOnly:n.onFocusOnly,duration:n.zoomDuration})),(n.shiftDragZoom===void 0||n.shiftDragZoom)&&e.push(new g9({duration:n.zoomDuration})),e}class S9 extends O_{constructor(e){super(),this.map_=e}dispatchRenderEvent(e,t){We()}calculateMatrices2D(e){const t=e.viewState,i=e.coordinateToPixelTransform,r=e.pixelToCoordinateTransform;Eo(i,e.size[0]/2,e.size[1]/2,1/t.resolution,-1/t.resolution,-t.rotation,-t.center[0],-t.center[1]),Gb(r,i)}forEachFeatureAtCoordinate(e,t,i,r,s,o,a,c){let h;const d=t.viewState;function g(D,j,W,L){return s.call(o,j,D?W:null,L)}const m=d.projection,y=Cb(e.slice(),m),w=[[0,0]];if(m.canWrapX()&&r){const D=m.getExtent(),j=ht(D);w.push([-j,0],[j,0])}const T=t.layerStatesArray,E=T.length,P=[],M=[];for(let D=0;D<w.length;D++)for(let j=E-1;j>=0;--j){const W=T[j],L=W.layer;if(L.hasRenderer()&&Gx(W,d)&&a.call(c,L)){const A=L.getRenderer(),k=L.getSource();if(A&&k){const U=k.getWrapX()?y:e,B=g.bind(null,W.managed);M[0]=U[0]+w[D][0],M[1]=U[1]+w[D][1],h=A.forEachFeatureAtCoordinate(M,t,i,B,P)}if(h)return h}}if(P.length===0)return;const N=1/P.length;return P.forEach((D,j)=>D.distanceSq+=j*N),P.sort((D,j)=>D.distanceSq-j.distanceSq),P.some(D=>h=D.callback(D.feature,D.layer,D.geometry)),h}hasFeatureAtCoordinate(e,t,i,r,s,o){return this.forEachFeatureAtCoordinate(e,t,i,r,Bf,this,s,o)!==void 0}getMap(){return this.map_}renderFrame(e){We()}scheduleExpireIconCache(e){Ar.canExpireCache()&&e.postRenderFunctions.push(I9)}}function I9(n,e){Ar.expire()}class T9 extends S9{constructor(e){super(e),this.fontChangeListenerKey_=lt(Nu,fh.PROPERTYCHANGE,e.redrawText,e),this.element_=er?Qb():document.createElement("div");const t=this.element_.style;t.position="absolute",t.width="100%",t.height="100%",t.zIndex="0",this.element_.className=Gg+" ol-layers";const i=e.getViewport();i&&i.insertBefore(this.element_,i.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(e,t){const i=this.getMap();if(i.hasListener(e)){const r=new E4(e,void 0,t);i.dispatchEvent(r)}}disposeInternal(){Ot(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(e){if(!e){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(e),this.dispatchRenderEvent(Pr.PRECOMPOSE,e);const t=e.layerStatesArray.sort((h,d)=>h.zIndex-d.zIndex);t.some(h=>h.layer instanceof b4&&h.layer.getDeclutter())&&(e.declutter={});const r=e.viewState;this.children_.length=0;const s=[];let o=null;for(let h=0,d=t.length;h<d;++h){const g=t[h];e.layerIndex=h;const m=g.layer,y=m.getSourceState();if(!Gx(g,r)||y!="ready"&&y!="undefined"){m.unrender();continue}const w=m.render(e,o);w&&(w!==o&&(this.children_.push(w),o=w),s.push(g))}this.declutter(e,s),Z6(this.element_,this.children_);const c=this.getMap().getTargetElement();if(Ta(c)){const h=c.getContext("2d");for(const d of this.children_){const g=d.firstElementChild||d,m=d.style.backgroundColor;if(m&&(!Ta(g)||g.width>0)&&(h.fillStyle=m,h.fillRect(0,0,c.width,c.height)),Ta(g)&&g.width>0){const y=d.style.opacity||g.style.opacity;h.globalAlpha=y===""?1:Number(y);const w=g.style.transform;if(w)h.setTransform(...bE(w));else{const T=parseFloat(g.style.width)/g.width,E=parseFloat(g.style.height)/g.height;h.setTransform(T,0,0,E,0,0)}h.drawImage(g,0,0)}}h.globalAlpha=1,h.setTransform(1,0,0,1,0,0)}this.dispatchRenderEvent(Pr.POSTCOMPOSE,e),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(e)}declutter(e,t){if(e.declutter){for(let i=t.length-1;i>=0;--i){const r=t[i],s=r.layer;s.getDeclutter()&&s.renderDeclutter(e,r)}t.forEach(i=>i.layer.renderDeferred(e))}}}function H4(n){if(n instanceof Z_){n.setMapInternal(null);return}n instanceof J_&&n.getLayers().forEach(H4)}function K4(n,e){if(n instanceof Z_){n.setMapInternal(e);return}if(n instanceof J_){const t=n.getLayers().getArray();for(let i=0,r=t.length;i<r;++i)K4(t[i],e)}}let R9=class extends js{constructor(e){super(),e=e||{},this.on,this.once,this.un;const t=P9(e);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=e.maxTilesLoading!==void 0?e.maxTilesLoading:16,this.pixelRatio_=e.pixelRatio!==void 0?e.pixelRatio:X6,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=Zr(),this.pixelToCoordinateTransform_=Zr(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,er||(this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_)),this.mapBrowserEventHandler_=null,this.moveTolerance_=e.moveTolerance,this.keyboardEventTarget_=t.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,er||(this.resizeObserver_=new ResizeObserver(()=>this.updateSize())),this.controls=t.controls||(er?new Rr:e9()),this.interactions=t.interactions||(er?new Rr:x9({onFocusOnly:!0})),this.overlays_=t.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new KF(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(ei.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(ei.VIEW,this.handleViewChanged_),this.addChangeListener(ei.SIZE,this.handleSizeChanged_),this.addChangeListener(ei.TARGET,this.handleTargetChanged_),this.setProperties(t.values);const i=this;e.view&&!(e.view instanceof Ts)&&e.view.then(function(r){i.setView(new Ts(r))}),this.controls.addEventListener(bi.ADD,r=>{r.element.setMap(this)}),this.controls.addEventListener(bi.REMOVE,r=>{r.element.setMap(null)}),this.interactions.addEventListener(bi.ADD,r=>{r.element.setMap(this)}),this.interactions.addEventListener(bi.REMOVE,r=>{r.element.setMap(null)}),this.overlays_.addEventListener(bi.ADD,r=>{this.addOverlayInternal_(r.element)}),this.overlays_.addEventListener(bi.REMOVE,r=>{const s=r.element.getId();s!==void 0&&delete this.overlayIdIndex_[s.toString()],r.element.setMap(null)}),this.controls.forEach(r=>{r.setMap(this)}),this.interactions.forEach(r=>{r.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(e){this.getControls().push(e)}addInteraction(e){this.getInteractions().push(e)}addLayer(e){this.getLayerGroup().getLayers().push(e)}handleLayerAdd_(e){K4(e.layer,this)}addOverlay(e){this.getOverlays().push(e)}addOverlayInternal_(e){const t=e.getId();t!==void 0&&(this.overlayIdIndex_[t.toString()]=e),e.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_?.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(e,t,i){if(!this.frameState_||!this.renderer_)return;const r=this.getCoordinateFromPixelInternal(e);i=i!==void 0?i:{};const s=i.hitTolerance!==void 0?i.hitTolerance:0,o=i.layerFilter!==void 0?i.layerFilter:Bf,a=i.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(r,this.frameState_,s,a,t,null,o,null)}getFeaturesAtPixel(e,t){const i=[];return this.forEachFeatureAtPixel(e,function(r){i.push(r)},t),i}getAllLayers(){const e=[];function t(i){i.forEach(function(r){r instanceof J_?t(r.getLayers()):e.push(r)})}return t(this.getLayers()),e}hasFeatureAtPixel(e,t){if(!this.frameState_||!this.renderer_)return!1;const i=this.getCoordinateFromPixelInternal(e);t=t!==void 0?t:{};const r=t.layerFilter!==void 0?t.layerFilter:Bf,s=t.hitTolerance!==void 0?t.hitTolerance:0,o=t.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,s,o,r,null)}getEventCoordinate(e){return this.getCoordinateFromPixel(this.getEventPixel(e))}getEventCoordinateInternal(e){return this.getCoordinateFromPixelInternal(this.getEventPixel(e))}getEventPixel(e){const i=this.viewport_.getBoundingClientRect(),r=this.getSize(),s=i.width/r[0],o=i.height/r[1],a="changedTouches"in e?e.changedTouches[0]:e;return[(a.clientX-i.left)/s,(a.clientY-i.top)/o]}getTarget(){return this.get(ei.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(e){return ME(this.getCoordinateFromPixelInternal(e),this.getView().getProjection())}getCoordinateFromPixelInternal(e){const t=this.frameState_;return t?Mn(t.pixelToCoordinateTransform,e.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(e){const t=this.overlayIdIndex_[e.toString()];return t!==void 0?t:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(ei.LAYERGROUP)}setLayers(e){const t=this.getLayerGroup();if(e instanceof Rr){t.setLayers(e);return}const i=t.getLayers();i.clear(),i.extend(e)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const e=this.getLayerGroup().getLayerStatesArray();for(let t=0,i=e.length;t<i;++t){const r=e[t];if(!r.visible)continue;const s=r.layer.getRenderer();if(s&&!s.ready)return!0;const o=r.layer.getSource();if(o&&o.loading)return!0}return!1}getPixelFromCoordinate(e){const t=lo(e,this.getView().getProjection());return this.getPixelFromCoordinateInternal(t)}getPixelFromCoordinateInternal(e){const t=this.frameState_;return t?Mn(t.coordinateToPixelTransform,e.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(ei.SIZE)}getView(){return this.get(ei.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const e=this.getTargetElement();return e?e.ownerDocument:document}getTilePriority(e,t,i,r){return qF(this.frameState_,e,t,i,r)}handleBrowserEvent(e,t){t=t||e.type;const i=new ga(t,this,e);this.handleMapBrowserEvent(i)}handleMapBrowserEvent(e){if(!this.frameState_)return;const t=e.originalEvent,i=t.type;if(i===zE.POINTERDOWN||i===Qe.WHEEL||i===Qe.KEYDOWN){const r=this.getOwnerDocument(),s=this.viewport_.getRootNode?this.viewport_.getRootNode():r,o=t.target,a=s instanceof ShadowRoot?s.host===o?s.host.ownerDocument:s:s===r?r.documentElement:s;if(this.overlayContainerStopEvent_.contains(o)||!a.contains(o))return}if(e.frameState=this.frameState_,this.dispatchEvent(e)!==!1){const r=this.getInteractions().getArray().slice();for(let s=r.length-1;s>=0;s--){const o=r[s];if(o.getMap()!==this||!o.getActive()||!this.getTargetElement())continue;if(!o.handleEvent(e)||e.propagationStopped)break}}}handlePostRender(){const e=this.frameState_,t=this.tileQueue_;if(!t.isEmpty()){let r=this.maxTilesLoading_,s=r;if(e){const o=e.viewHints;if(o[ni.ANIMATING]||o[ni.INTERACTING]){const a=Date.now()-e.time>8;r=a?0:8,s=a?0:2}}t.getTilesLoading()<r&&(t.reprioritize(),t.loadMoreTiles(r,s))}e&&this.renderer_&&!e.animate&&(this.renderComplete_?(this.hasListener(Pr.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(Pr.RENDERCOMPLETE,e),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new Fu(ma.LOADEND,this,e)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new Fu(ma.LOADSTART,this,e))));const i=this.postRenderFunctions_;if(e)for(let r=0,s=i.length;r<s;++r)i[r](this,e);i.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let i=0,r=this.targetChangeHandlerKeys_.length;i<r;++i)Ot(this.targetChangeHandlerKeys_[i]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(Qe.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(Qe.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_&&!Ta(this.targetElement_)){this.resizeObserver_?.unobserve(this.targetElement_);const i=this.targetElement_.getRootNode();i instanceof ShadowRoot&&this.resizeObserver_.unobserve(i.host),this.setSize(void 0)}const e=this.getTarget(),t=typeof e=="string"?document.getElementById(e):e;if(this.targetElement_=t,!t)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{if(Ta(t)||t.appendChild(this.viewport_),this.renderer_||(this.renderer_=new T9(this)),!Ta(t)){this.mapBrowserEventHandler_=new XF(this,this.moveTolerance_);for(const r in Xt)this.mapBrowserEventHandler_.addEventListener(Xt[r],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(Qe.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(Qe.WHEEL,this.boundHandleBrowserEvent_,Xb?{passive:!1}:!1);let i;if(this.keyboardEventTarget_)i=this.keyboardEventTarget_;else{const r=t.getRootNode();i=r instanceof ShadowRoot?r.host:t}if(this.targetChangeHandlerKeys_=[lt(i,Qe.KEYDOWN,this.handleBrowserEvent,this),lt(i,Qe.KEYPRESS,this.handleBrowserEvent,this)],t instanceof HTMLElement){const r=t.getRootNode();r instanceof ShadowRoot&&this.resizeObserver_.observe(r.host),this.resizeObserver_?.observe(t)}}this.updateSize()}}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(Ot(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(Ot(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const e=this.getView();e&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=lt(e,fh.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=lt(e,Qe.CHANGE,this.handleViewPropertyChanged_,this),e.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(Ot),this.layerGroupPropertyListenerKeys_=null);const e=this.getLayerGroup();e&&(this.handleLayerAdd_(new _a("addlayer",e)),this.layerGroupPropertyListenerKeys_=[lt(e,fh.PROPERTYCHANGE,this.render,this),lt(e,Qe.CHANGE,this.render,this),lt(e,"addlayer",this.handleLayerAdd_,this),lt(e,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){if(!this.frameState_)return;const e=this.frameState_.layerStatesArray;for(let t=0,i=e.length;t<i;++t){const r=e[t].layer;r.hasRenderer()&&r.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(e){return this.getControls().remove(e)}removeInteraction(e){return this.getInteractions().remove(e)}removeLayer(e){return this.getLayerGroup().getLayers().remove(e)}handleLayerRemove_(e){H4(e.layer)}removeOverlay(e){return this.getOverlays().remove(e)}renderFrame_(e){const t=this.getSize(),i=this.getView(),r=this.frameState_;let s=null;if(t!==void 0&&BR(t)&&i&&i.isDef()){const o=i.getHints(this.frameState_?this.frameState_.viewHints:void 0),a=i.getState();if(s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:IE(a.center,a.resolution,a.rotation,t),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:t,tileQueue:this.tileQueue_,time:e,usedTiles:{},viewState:a,viewHints:o,wantedTiles:{},mapId:ut(this),renderTargets:{}},a.nextCenter&&a.nextResolution){const c=isNaN(a.nextRotation)?a.rotation:a.nextRotation;s.nextExtent=IE(a.nextCenter,a.nextResolution,c,t)}}this.frameState_=s,this.renderer_.renderFrame(s),s&&(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),r&&(!this.previousExtent_||!j_(this.previousExtent_)&&!Wf(s.extent,this.previousExtent_))&&(this.dispatchEvent(new Fu(ma.MOVESTART,this,r)),this.previousExtent_=Ng(this.previousExtent_)),this.previousExtent_&&!s.viewHints[ni.ANIMATING]&&!s.viewHints[ni.INTERACTING]&&!Wf(s.extent,this.previousExtent_)&&(this.dispatchEvent(new Fu(ma.MOVEEND,this,s)),Eb(s.extent,this.previousExtent_))),this.dispatchEvent(new Fu(ma.POSTRENDER,this,s)),this.renderComplete_=(this.hasListener(ma.LOADSTART)||this.hasListener(ma.LOADEND)||this.hasListener(Pr.RENDERCOMPLETE))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(e){const t=this.getLayerGroup();t&&this.handleLayerRemove_(new _a("removelayer",t)),this.set(ei.LAYERGROUP,e)}setSize(e){this.set(ei.SIZE,e)}setTarget(e){this.set(ei.TARGET,e)}setView(e){if(!e||e instanceof Ts){this.set(ei.VIEW,e);return}this.set(ei.VIEW,new Ts);const t=this;e.then(function(i){t.setView(new Ts(i))})}updateSize(){const e=this.getTargetElement();let t;if(e){let r,s;if(Ta(e))r=e.width,s=e.height;else{const o=getComputedStyle(e);r=e.offsetWidth-parseFloat(o.borderLeftWidth)-parseFloat(o.paddingLeft)-parseFloat(o.paddingRight)-parseFloat(o.borderRightWidth),s=e.offsetHeight-parseFloat(o.borderTopWidth)-parseFloat(o.paddingTop)-parseFloat(o.paddingBottom)-parseFloat(o.borderBottomWidth)}!isNaN(r)&&!isNaN(s)&&(t=[Math.max(0,r),Math.max(0,s)],!BR(t)&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)&&bb("No map visible because the map container's width or height are 0."))}const i=this.getSize();t&&(!i||!Za(t,i))&&(this.setSize(t),this.updateViewportSize_(t))}updateViewportSize_(e){const t=this.getView();t&&t.setViewportSize(e)}};function P9(n){let e=null;n.keyboardEventTarget!==void 0&&(e=typeof n.keyboardEventTarget=="string"?document.getElementById(n.keyboardEventTarget):n.keyboardEventTarget);const t={},i=n.layers&&typeof n.layers.getLayers=="function"?n.layers:new J_({layers:n.layers});t[ei.LAYERGROUP]=i,t[ei.TARGET]=n.target,t[ei.VIEW]=n.view instanceof Ts?n.view:new Ts;let r;n.controls!==void 0&&(Array.isArray(n.controls)?r=new Rr(n.controls.slice()):(yt(typeof n.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),r=n.controls));let s;n.interactions!==void 0&&(Array.isArray(n.interactions)?s=new Rr(n.interactions.slice()):(yt(typeof n.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),s=n.interactions));let o;return n.overlays!==void 0?Array.isArray(n.overlays)?o=new Rr(n.overlays.slice()):(yt(typeof n.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),o=n.overlays):o=new Rr,{controls:r,interactions:s,keyboardEventTarget:e,overlays:o,values:t}}const V1="units",A9=[1,2,5],Wd=25.4/.28;class C9 extends ey{constructor(e){e=e||{};const t=document.createElement("div");t.style.pointerEvents="none",super({element:t,render:e.render,target:e.target}),this.on,this.once,this.un;const i=e.className!==void 0?e.className:e.bar?"ol-scale-bar":"ol-scale-line";this.innerElement_=document.createElement("div"),this.innerElement_.className=i+"-inner",this.element.className=i+" "+Gg,this.element.appendChild(this.innerElement_),this.viewState_=null,this.minWidth_=e.minWidth!==void 0?e.minWidth:64,this.maxWidth_=e.maxWidth,this.renderedVisible_=!1,this.renderedWidth_=void 0,this.renderedHTML_="",this.addChangeListener(V1,this.handleUnitsChanged_),this.setUnits(e.units||"metric"),this.scaleBar_=e.bar||!1,this.scaleBarSteps_=e.steps||4,this.scaleBarText_=e.text||!1,this.dpi_=e.dpi||void 0}getUnits(){return this.get(V1)}handleUnitsChanged_(){this.updateElement_()}setUnits(e){this.set(V1,e)}setDpi(e){this.dpi_=e}updateElement_(){const e=this.viewState_;if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=e.center,i=e.projection,r=this.getUnits(),s=r=="degrees"?"degrees":"m";let o=C0(i,e.resolution,t,s);const a=this.minWidth_*(this.dpi_||Wd)/Wd,c=this.maxWidth_!==void 0?this.maxWidth_*(this.dpi_||Wd)/Wd:void 0;let h=a*o,d="";if(r=="degrees"){const N=ph.degrees;h*=N,h<N/60?(d="",o*=3600):h<N?(d="",o*=60):d=""}else if(r=="imperial")h<.9144?(d="in",o/=.0254):h<1609.344?(d="ft",o/=.3048):(d="mi",o/=1609.344);else if(r=="nautical")o/=1852,d="NM";else if(r=="metric")h<1e-6?(d="nm",o*=1e9):h<.001?(d="m",o*=1e6):h<1?(d="mm",o*=1e3):h<1e3?d="m":(d="km",o/=1e3);else if(r=="us")h<.9144?(d="in",o*=39.37):h<1609.344?(d="ft",o/=.30480061):(d="mi",o/=1609.3472);else throw new Error("Invalid units");let g=3*Math.floor(Math.log(a*o)/Math.log(10)),m,y,w,T=0,E,P;for(;;){w=Math.floor(g/3);const N=Math.pow(10,w);if(m=A9[(g%3+3)%3]*N,y=Math.round(m/o),isNaN(y)){this.element.style.display="none",this.renderedVisible_=!1;return}if(c!==void 0&&y>=c){m=T,y=E,w=P;break}else if(y>=a)break;T=m,E=y,P=w,++g}const M=this.scaleBar_?this.createScaleBar(y,m,d):m.toFixed(w<0?-w:0)+" "+d;this.renderedHTML_!=M&&(this.innerElement_.innerHTML=M,this.renderedHTML_=M),this.renderedWidth_!=y&&(this.innerElement_.style.width=y+"px",this.renderedWidth_=y),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}createScaleBar(e,t,i){const r=this.getScaleForResolution(),s=r<1?Math.round(1/r).toLocaleString()+" : 1":"1 : "+Math.round(r).toLocaleString(),o=this.scaleBarSteps_,a=e/o,c=[this.createMarker("absolute")];for(let d=0;d<o;++d){const g=d%2===0?"ol-scale-singlebar-odd":"ol-scale-singlebar-even";c.push(`<div><div class="ol-scale-singlebar ${g}" style="width: ${a}px;"></div>`+this.createMarker("relative")+(d%2===0||o===2?this.createStepText(d,e,!1,t,i):"")+"</div>")}return c.push(this.createStepText(o,e,!0,t,i)),(this.scaleBarText_?`<div class="ol-scale-text" style="width: ${e}px;">`+s+"</div>":"")+c.join("")}createMarker(e){return`<div class="ol-scale-step-marker" style="position: ${e}; top: ${e==="absolute"?3:-10}px;"></div>`}createStepText(e,t,i,r,s){const a=(e===0?0:Math.round(r/this.scaleBarSteps_*e*100)/100)+(e===0?"":" "+s),c=e===0?-3:t/this.scaleBarSteps_*-1,h=e===0?0:t/this.scaleBarSteps_*2;return`<div class="ol-scale-step-text" style="margin-left: ${c}px;text-align: ${e===0?"left":"center"};min-width: ${h}px;left: ${i?t+"px":"unset"};">`+a+"</div>"}getScaleForResolution(){const e=C0(this.viewState_.projection,this.viewState_.resolution,this.viewState_.center,"m"),t=this.dpi_||Wd,i=1e3/25.4;return e*i*t}render(e){const t=e.frameState;t?this.viewState_=t.viewState:this.viewState_=null,this.updateElement_()}}const M9={},pP=n=>{let e;const t=new Set,i=(d,g)=>{const m=typeof d=="function"?d(e):d;if(!Object.is(m,e)){const y=e;e=g??(typeof m!="object"||m===null)?m:Object.assign({},e,m),t.forEach(w=>w(e,y))}},r=()=>e,c={setState:i,getState:r,getInitialState:()=>h,subscribe:d=>(t.add(d),()=>t.delete(d)),destroy:()=>{(M9?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},h=e=n(i,r,c);return c},b9=n=>n?pP(n):pP;var F1={exports:{}},G1={},j1={exports:{}},U1={};var _P;function k9(){if(_P)return U1;_P=1;var n=Mg();function e(g,m){return g===m&&(g!==0||1/g===1/m)||g!==g&&m!==m}var t=typeof Object.is=="function"?Object.is:e,i=n.useState,r=n.useEffect,s=n.useLayoutEffect,o=n.useDebugValue;function a(g,m){var y=m(),w=i({inst:{value:y,getSnapshot:m}}),T=w[0].inst,E=w[1];return s(function(){T.value=y,T.getSnapshot=m,c(T)&&E({inst:T})},[g,y,m]),r(function(){return c(T)&&E({inst:T}),g(function(){c(T)&&E({inst:T})})},[g]),o(y),y}function c(g){var m=g.getSnapshot;g=g.value;try{var y=m();return!t(g,y)}catch{return!0}}function h(g,m){return m()}var d=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?h:a;return U1.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:d,U1}var yP;function L9(){return yP||(yP=1,j1.exports=k9()),j1.exports}var vP;function N9(){if(vP)return G1;vP=1;var n=Mg(),e=L9();function t(h,d){return h===d&&(h!==0||1/h===1/d)||h!==h&&d!==d}var i=typeof Object.is=="function"?Object.is:t,r=e.useSyncExternalStore,s=n.useRef,o=n.useEffect,a=n.useMemo,c=n.useDebugValue;return G1.useSyncExternalStoreWithSelector=function(h,d,g,m,y){var w=s(null);if(w.current===null){var T={hasValue:!1,value:null};w.current=T}else T=w.current;w=a(function(){function P(W){if(!M){if(M=!0,N=W,W=m(W),y!==void 0&&T.hasValue){var L=T.value;if(y(L,W))return D=L}return D=W}if(L=D,i(N,W))return L;var A=m(W);return y!==void 0&&y(L,A)?(N=W,L):(N=W,D=A)}var M=!1,N,D,j=g===void 0?null:g;return[function(){return P(d())},j===null?void 0:function(){return P(j())}]},[d,g,m,y]);var E=r(h,w[0],w[1]);return o(function(){T.hasValue=!0,T.value=E},[E]),c(E),E},G1}var EP;function O9(){return EP||(EP=1,F1.exports=N9()),F1.exports}var D9=O9();const V9=sx(D9),q4={},{useDebugValue:F9}=G5,{useSyncExternalStoreWithSelector:G9}=V9;let wP=!1;const j9=n=>n;function U9(n,e=j9,t){(q4?"production":void 0)!=="production"&&t&&!wP&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),wP=!0);const i=G9(n.subscribe,n.getState,n.getServerState||n.getInitialState,e,t);return F9(i),i}const B9=n=>{(q4?"production":void 0)!=="production"&&typeof n!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof n=="function"?b9(n):n,t=(i,r)=>U9(e,i,r);return Object.assign(t,e),t},Mo=n=>B9;var Y4=Symbol.for("immer-nothing"),xP=Symbol.for("immer-draftable"),rr=Symbol.for("immer-state");function qr(n,...e){throw new Error(`[Immer] minified error nr: ${n}. Full error at: https://bit.ly/3cXEKWf`)}var tg=Object.getPrototypeOf;function wh(n){return!!n&&!!n[rr]}function dc(n){return n?X4(n)||Array.isArray(n)||!!n[xP]||!!n.constructor?.[xP]||$g(n)||ny(n):!1}var z9=Object.prototype.constructor.toString(),SP=new WeakMap;function X4(n){if(!n||typeof n!="object")return!1;const e=Object.getPrototypeOf(n);if(e===null||e===Object.prototype)return!0;const t=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;if(t===Object)return!0;if(typeof t!="function")return!1;let i=SP.get(t);return i===void 0&&(i=Function.toString.call(t),SP.set(t,i)),i===z9}function $0(n,e,t=!0){ty(n)===0?(t?Reflect.ownKeys(n):Object.keys(n)).forEach(r=>{e(r,n[r],n)}):n.forEach((i,r)=>e(r,i,n))}function ty(n){const e=n[rr];return e?e.type_:Array.isArray(n)?1:$g(n)?2:ny(n)?3:0}function WE(n,e){return ty(n)===2?n.has(e):Object.prototype.hasOwnProperty.call(n,e)}function Q4(n,e,t){const i=ty(n);i===2?n.set(e,t):i===3?n.add(t):n[e]=t}function $9(n,e){return n===e?n!==0||1/n===1/e:n!==n&&e!==e}function $g(n){return n instanceof Map}function ny(n){return n instanceof Set}function Nl(n){return n.copy_||n.base_}function HE(n,e){if($g(n))return new Map(n);if(ny(n))return new Set(n);if(Array.isArray(n))return Array.prototype.slice.call(n);const t=X4(n);if(e===!0||e==="class_only"&&!t){const i=Object.getOwnPropertyDescriptors(n);delete i[rr];let r=Reflect.ownKeys(i);for(let s=0;s<r.length;s++){const o=r[s],a=i[o];a.writable===!1&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(i[o]={configurable:!0,writable:!0,enumerable:a.enumerable,value:n[o]})}return Object.create(tg(n),i)}else{const i=tg(n);if(i!==null&&t)return{...n};const r=Object.create(i);return Object.assign(r,n)}}function Kx(n,e=!1){return iy(n)||wh(n)||!dc(n)||(ty(n)>1&&Object.defineProperties(n,{set:Op,add:Op,clear:Op,delete:Op}),Object.freeze(n),e&&Object.values(n).forEach(t=>Kx(t,!0))),n}function W9(){qr(2)}var Op={value:W9};function iy(n){return n===null||typeof n!="object"?!0:Object.isFrozen(n)}var H9={};function fc(n){const e=H9[n];return e||qr(0,n),e}var ng;function Z4(){return ng}function K9(n,e){return{drafts_:[],parent_:n,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function IP(n,e){e&&(fc("Patches"),n.patches_=[],n.inversePatches_=[],n.patchListener_=e)}function KE(n){qE(n),n.drafts_.forEach(q9),n.drafts_=null}function qE(n){n===ng&&(ng=n.parent_)}function TP(n){return ng=K9(ng,n)}function q9(n){const e=n[rr];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function RP(n,e){e.unfinalizedDrafts_=e.drafts_.length;const t=e.drafts_[0];return n!==void 0&&n!==t?(t[rr].modified_&&(KE(e),qr(4)),dc(n)&&(n=W0(e,n),e.parent_||H0(e,n)),e.patches_&&fc("Patches").generateReplacementPatches_(t[rr].base_,n,e.patches_,e.inversePatches_)):n=W0(e,t,[]),KE(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),n!==Y4?n:void 0}function W0(n,e,t){if(iy(e))return e;const i=n.immer_.shouldUseStrictIteration(),r=e[rr];if(!r)return $0(e,(s,o)=>PP(n,r,e,s,o,t),i),e;if(r.scope_!==n)return e;if(!r.modified_)return H0(n,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const s=r.copy_;let o=s,a=!1;r.type_===3&&(o=new Set(s),s.clear(),a=!0),$0(o,(c,h)=>PP(n,r,s,c,h,t,a),i),H0(n,s,!1),t&&n.patches_&&fc("Patches").generatePatches_(r,t,n.patches_,n.inversePatches_)}return r.copy_}function PP(n,e,t,i,r,s,o){if(r==null||typeof r!="object"&&!o)return;const a=iy(r);if(!(a&&!o)){if(wh(r)){const c=s&&e&&e.type_!==3&&!WE(e.assigned_,i)?s.concat(i):void 0,h=W0(n,r,c);if(Q4(t,i,h),wh(h))n.canAutoFreeze_=!1;else return}else o&&t.add(r);if(dc(r)&&!a){if(!n.immer_.autoFreeze_&&n.unfinalizedDrafts_<1||e&&e.base_&&e.base_[i]===r&&a)return;W0(n,r),(!e||!e.scope_.parent_)&&typeof i!="symbol"&&($g(t)?t.has(i):Object.prototype.propertyIsEnumerable.call(t,i))&&H0(n,r)}}}function H0(n,e,t=!1){!n.parent_&&n.immer_.autoFreeze_&&n.canAutoFreeze_&&Kx(e,t)}function Y9(n,e){const t=Array.isArray(n),i={type_:t?1:0,scope_:e?e.scope_:Z4(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:n,draft_:null,copy_:null,revoke_:null,isManual_:!1};let r=i,s=qx;t&&(r=[i],s=ig);const{revoke:o,proxy:a}=Proxy.revocable(r,s);return i.draft_=a,i.revoke_=o,a}var qx={get(n,e){if(e===rr)return n;const t=Nl(n);if(!WE(t,e))return X9(n,t,e);const i=t[e];return n.finalized_||!dc(i)?i:i===B1(n.base_,e)?(z1(n),n.copy_[e]=XE(i,n)):i},has(n,e){return e in Nl(n)},ownKeys(n){return Reflect.ownKeys(Nl(n))},set(n,e,t){const i=J4(Nl(n),e);if(i?.set)return i.set.call(n.draft_,t),!0;if(!n.modified_){const r=B1(Nl(n),e),s=r?.[rr];if(s&&s.base_===t)return n.copy_[e]=t,n.assigned_[e]=!1,!0;if($9(t,r)&&(t!==void 0||WE(n.base_,e)))return!0;z1(n),YE(n)}return n.copy_[e]===t&&(t!==void 0||e in n.copy_)||Number.isNaN(t)&&Number.isNaN(n.copy_[e])||(n.copy_[e]=t,n.assigned_[e]=!0),!0},deleteProperty(n,e){return B1(n.base_,e)!==void 0||e in n.base_?(n.assigned_[e]=!1,z1(n),YE(n)):delete n.assigned_[e],n.copy_&&delete n.copy_[e],!0},getOwnPropertyDescriptor(n,e){const t=Nl(n),i=Reflect.getOwnPropertyDescriptor(t,e);return i&&{writable:!0,configurable:n.type_!==1||e!=="length",enumerable:i.enumerable,value:t[e]}},defineProperty(){qr(11)},getPrototypeOf(n){return tg(n.base_)},setPrototypeOf(){qr(12)}},ig={};$0(qx,(n,e)=>{ig[n]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});ig.deleteProperty=function(n,e){return ig.set.call(this,n,e,void 0)};ig.set=function(n,e,t){return qx.set.call(this,n[0],e,t,n[0])};function B1(n,e){const t=n[rr];return(t?Nl(t):n)[e]}function X9(n,e,t){const i=J4(e,t);return i?"value"in i?i.value:i.get?.call(n.draft_):void 0}function J4(n,e){if(!(e in n))return;let t=tg(n);for(;t;){const i=Object.getOwnPropertyDescriptor(t,e);if(i)return i;t=tg(t)}}function YE(n){n.modified_||(n.modified_=!0,n.parent_&&YE(n.parent_))}function z1(n){n.copy_||(n.copy_=HE(n.base_,n.scope_.immer_.useStrictShallowCopy_))}var Q9=class{constructor(n){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(e,t,i)=>{if(typeof e=="function"&&typeof t!="function"){const s=t;t=e;const o=this;return function(c=s,...h){return o.produce(c,d=>t.call(this,d,...h))}}typeof t!="function"&&qr(6),i!==void 0&&typeof i!="function"&&qr(7);let r;if(dc(e)){const s=TP(this),o=XE(e,void 0);let a=!0;try{r=t(o),a=!1}finally{a?KE(s):qE(s)}return IP(s,i),RP(r,s)}else if(!e||typeof e!="object"){if(r=t(e),r===void 0&&(r=e),r===Y4&&(r=void 0),this.autoFreeze_&&Kx(r,!0),i){const s=[],o=[];fc("Patches").generateReplacementPatches_(e,r,s,o),i(s,o)}return r}else qr(1,e)},this.produceWithPatches=(e,t)=>{if(typeof e=="function")return(o,...a)=>this.produceWithPatches(o,c=>e(c,...a));let i,r;return[this.produce(e,t,(o,a)=>{i=o,r=a}),i,r]},typeof n?.autoFreeze=="boolean"&&this.setAutoFreeze(n.autoFreeze),typeof n?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(n.useStrictShallowCopy),typeof n?.useStrictIteration=="boolean"&&this.setUseStrictIteration(n.useStrictIteration)}createDraft(n){dc(n)||qr(8),wh(n)&&(n=Z9(n));const e=TP(this),t=XE(n,void 0);return t[rr].isManual_=!0,qE(e),t}finishDraft(n,e){const t=n&&n[rr];(!t||!t.isManual_)&&qr(9);const{scope_:i}=t;return IP(i,e),RP(void 0,i)}setAutoFreeze(n){this.autoFreeze_=n}setUseStrictShallowCopy(n){this.useStrictShallowCopy_=n}setUseStrictIteration(n){this.useStrictIteration_=n}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(n,e){let t;for(t=e.length-1;t>=0;t--){const r=e[t];if(r.path.length===0&&r.op==="replace"){n=r.value;break}}t>-1&&(e=e.slice(t+1));const i=fc("Patches").applyPatches_;return wh(n)?i(n,e):this.produce(n,r=>i(r,e))}};function XE(n,e){const t=$g(n)?fc("MapSet").proxyMap_(n,e):ny(n)?fc("MapSet").proxySet_(n,e):Y9(n,e);return(e?e.scope_:Z4()).drafts_.push(t),t}function Z9(n){return wh(n)||qr(10,n),ek(n)}function ek(n){if(!dc(n)||iy(n))return n;const e=n[rr];let t,i=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,t=HE(n,e.scope_.immer_.useStrictShallowCopy_),i=e.scope_.immer_.shouldUseStrictIteration()}else t=HE(n,!0);return $0(t,(r,s)=>{Q4(t,r,ek(s))},i),e&&(e.finalized_=!1),t}var J9=new Q9,eG=J9.produce;const tG=n=>(e,t,i)=>(i.setState=(r,s,...o)=>{const a=typeof r=="function"?eG(r):r;return e(a,s,...o)},n(i.setState,t,i)),kc=tG,Ut=Mo()(kc((n,e)=>({tracking:!1,navigationMode:"free",position:null,heading:null,smoothHeading:null,accuracy:null,speed:null,headingSource:null,watchId:null,firstFix:!0,config:{smoothingFactor:.2,minRotationSpeed:8,centerOnUser:!0,animationDuration:100},startTracking:()=>{n(t=>{t.tracking=!0})},stopTracking:()=>{n(t=>{const{watchId:i}=e();i!==null&&navigator.geolocation.clearWatch(i),t.tracking=!1,t.speed=null,t.headingSource=null,t.watchId=null})},toggleMode:()=>{n(t=>{t.navigationMode=t.navigationMode==="free"?"drive":"free",console.log(` Navigation mode: ${t.navigationMode}`)})},updatePosition:t=>{n(i=>{i.position={lat:t.coords.latitude,lng:t.coords.longitude},i.accuracy=t.coords.accuracy,i.speed=t.coords.speed;const r=15,s=.5;if(!(t.coords.accuracy!==null&&t.coords.accuracy<r)){i.headingSource=null;return}if(t.coords.heading!==null&&t.coords.speed!==null&&t.coords.speed>s){i.headingSource="gps";const a=t.coords.heading;e().updateHeading(a,"gps")}else i.headingSource="compass"})},updateHeading:(t,i="compass")=>{n(r=>{const{smoothHeading:s,config:o}=e();if(s===null){r.smoothHeading=t,r.heading=t;return}let a=t-s;a>180&&(a-=360),a<-180&&(a+=360);const c=i==="compass"?8:o.minRotationSpeed;if(Math.abs(a)<c)return;const h=s+a*o.smoothingFactor;r.smoothHeading=(h+360)%360,r.heading=t})},setWatchId:t=>{n(i=>{i.watchId=t})},resetFirstFix:()=>{n(t=>{t.firstFix=!1})}}))),tk={"AHN 0.5m":{name:"AHN 0.5m",factory:async()=>{const{createAHNLayerOL:n}=await Ne(async()=>{const{createAHNLayerOL:e}=await import("./pdokWMSLayers-Bk6vdX82.js");return{createAHNLayerOL:e}},[]);return n()},immediateLoad:!0},Geomorfologie:{name:"Geomorfologie",factory:async()=>{const{createGeomorfologieLayerOL:n}=await Ne(async()=>{const{createGeomorfologieLayerOL:e}=await import("./pdokWMSLayers-Bk6vdX82.js");return{createGeomorfologieLayerOL:e}},[]);return n()},immediateLoad:!0},Bodemkaart:{name:"Bodemkaart",factory:async()=>{const{createBodemkaartLayerOL:n}=await Ne(async()=>{const{createBodemkaartLayerOL:e}=await import("./pdokWMSLayers-Bk6vdX82.js");return{createBodemkaartLayerOL:e}},[]);return n()},immediateLoad:!0},IKAW:{name:"IKAW",factory:async()=>{const{createIKAWLayerOL:n}=await Ne(async()=>{const{createIKAWLayerOL:e}=await import("./pdokWMSLayers-Bk6vdX82.js");return{createIKAWLayerOL:e}},[]);return n()},immediateLoad:!0},"FAMKE Steentijd":{name:"FAMKE Steentijd",factory:async()=>{const{createFAMKESteentijdLayerOL:n}=await Ne(async()=>{const{createFAMKESteentijdLayerOL:e}=await import("./pdokWMSLayers-Bk6vdX82.js");return{createFAMKESteentijdLayerOL:e}},[]);return n()},immediateLoad:!0},"Archeo Landschappen":{name:"Archeo Landschappen",factory:async()=>{const{createArcheoLandschappenLayerOL:n}=await Ne(async()=>{const{createArcheoLandschappenLayerOL:e}=await import("./pdokWMSLayers-Bk6vdX82.js");return{createArcheoLandschappenLayerOL:e}},[]);return n()},immediateLoad:!0},Rijksmonumenten:{name:"Rijksmonumenten",factory:async()=>{const{createRijksmonumentenLayerOL:n}=await Ne(async()=>{const{createRijksmonumentenLayerOL:e}=await import("./pdokWMSLayers-Bk6vdX82.js");return{createRijksmonumentenLayerOL:e}},[]);return n()},immediateLoad:!0},"Archeo Onderzoeken":{name:"Archeo Onderzoeken",factory:async()=>{const{createArcheoOnderzoekenLayerOL:n}=await Ne(async()=>{const{createArcheoOnderzoekenLayerOL:e}=await import("./pdokWMSLayers-Bk6vdX82.js");return{createArcheoOnderzoekenLayerOL:e}},[]);return n()},immediateLoad:!0},Werelderfgoed:{name:"Werelderfgoed",factory:async()=>{const{createWerelderfgoedLayerOL:n}=await Ne(async()=>{const{createWerelderfgoedLayerOL:e}=await import("./pdokWMSLayers-Bk6vdX82.js");return{createWerelderfgoedLayerOL:e}},[]);return n()},immediateLoad:!0},Terpen:{name:"Terpen",factory:async()=>{const{createTerpenLayerOL:n}=await Ne(async()=>{const{createTerpenLayerOL:e}=await import("./terpenOL-LqityAIq.js");return{createTerpenLayerOL:e}},[]);return n()},immediateLoad:!0},Verdedigingslinies:{name:"Verdedigingslinies",factory:async()=>{const{createLiniesLayerOL:n}=await Ne(async()=>{const{createLiniesLayerOL:e}=await import("./verdedigingswerkenOL-BozFWH7L.js");return{createLiniesLayerOL:e}},[]);return n()},immediateLoad:!0},Inundatiegebieden:{name:"Inundatiegebieden",factory:async()=>{const{createInundatiesLayerOL:n}=await Ne(async()=>{const{createInundatiesLayerOL:e}=await import("./verdedigingswerkenOL-BozFWH7L.js");return{createInundatiesLayerOL:e}},[]);return n()},immediateLoad:!0},"Militaire Objecten":{name:"Militaire Objecten",factory:async()=>{const{createMilitaireObjectenLayerOL:n}=await Ne(async()=>{const{createMilitaireObjectenLayerOL:e}=await import("./verdedigingswerkenOL-BozFWH7L.js");return{createMilitaireObjectenLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 800 n.Chr.":{name:"Paleokaart 800 n.Chr.",factory:async()=>{const{createPaleo800ncLayerOL:n}=await Ne(async()=>{const{createPaleo800ncLayerOL:e}=await import("./paleokaartOL-OojKQEst.js");return{createPaleo800ncLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 100 n.Chr.":{name:"Paleokaart 100 n.Chr.",factory:async()=>{const{createPaleo100ncLayerOL:n}=await Ne(async()=>{const{createPaleo100ncLayerOL:e}=await import("./paleokaartOL-OojKQEst.js");return{createPaleo100ncLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 500 v.Chr.":{name:"Paleokaart 500 v.Chr.",factory:async()=>{const{createPaleo500vcLayerOL:n}=await Ne(async()=>{const{createPaleo500vcLayerOL:e}=await import("./paleokaartOL-OojKQEst.js");return{createPaleo500vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 1500 v.Chr.":{name:"Paleokaart 1500 v.Chr.",factory:async()=>{const{createPaleo1500vcLayerOL:n}=await Ne(async()=>{const{createPaleo1500vcLayerOL:e}=await import("./paleokaartOL-OojKQEst.js");return{createPaleo1500vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 2750 v.Chr.":{name:"Paleokaart 2750 v.Chr.",factory:async()=>{const{createPaleo2750vcLayerOL:n}=await Ne(async()=>{const{createPaleo2750vcLayerOL:e}=await import("./paleokaartOL-OojKQEst.js");return{createPaleo2750vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 5500 v.Chr.":{name:"Paleokaart 5500 v.Chr.",factory:async()=>{const{createPaleo5500vcLayerOL:n}=await Ne(async()=>{const{createPaleo5500vcLayerOL:e}=await import("./paleokaartOL-OojKQEst.js");return{createPaleo5500vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 9000 v.Chr.":{name:"Paleokaart 9000 v.Chr.",factory:async()=>{const{createPaleo9000vcLayerOL:n}=await Ne(async()=>{const{createPaleo9000vcLayerOL:e}=await import("./paleokaartOL-OojKQEst.js");return{createPaleo9000vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Religieus Erfgoed":{name:"Religieus Erfgoed",factory:async()=>{const{createReligieusErfgoedLayerOL:n}=await Ne(async()=>{const{createReligieusErfgoedLayerOL:e}=await import("./religieusErfgoedOL-BXt5qWUR.js");return{createReligieusErfgoedLayerOL:e}},[]);return n()},immediateLoad:!0},"AHN4 Hillshade NL":{name:"AHN4 Hillshade NL",factory:async()=>{const{createAHN4HillshadeLayerOL:n}=await Ne(async()=>{const{createAHN4HillshadeLayerOL:e}=await import("./hillshadeLayers-5Ep8942d.js");return{createAHN4HillshadeLayerOL:e}},[]);return n()},immediateLoad:!0},"AHN4 Multi-Hillshade NL":{name:"AHN4 Multi-Hillshade NL",factory:async()=>{const{createAHN4MultiHillshadeLayerOL:n}=await Ne(async()=>{const{createAHN4MultiHillshadeLayerOL:e}=await import("./hillshadeLayers-5Ep8942d.js");return{createAHN4MultiHillshadeLayerOL:e}},[]);return n()},immediateLoad:!0},"World Hillshade":{name:"World Hillshade",factory:async()=>{const{createWorldHillshadeLayerOL:n}=await Ne(async()=>{const{createWorldHillshadeLayerOL:e}=await import("./hillshadeLayers-5Ep8942d.js");return{createWorldHillshadeLayerOL:e}},[]);return n()},immediateLoad:!0},Gewaspercelen:{name:"Gewaspercelen",factory:async()=>{const{createGewaspercelenLayerOL:n}=await Ne(async()=>{const{createGewaspercelenLayerOL:e}=await import("./pdokWMSLayers-Bk6vdX82.js");return{createGewaspercelenLayerOL:e}},[]);return n()},immediateLoad:!0},"Kadastrale Grenzen":{name:"Kadastrale Grenzen",factory:async()=>{const{createKadastraleKaartLayerOL:n}=await Ne(async()=>{const{createKadastraleKaartLayerOL:e}=await import("./pdokWMSLayers-Bk6vdX82.js");return{createKadastraleKaartLayerOL:e}},[]);return n()},immediateLoad:!0},Scheepswrakken:{name:"Scheepswrakken",factory:async()=>{const{createScheepswrakkenLayerOL:n}=await Ne(async()=>{const{createScheepswrakkenLayerOL:e}=await import("./pdokWMSLayers-Bk6vdX82.js");return{createScheepswrakkenLayerOL:e}},[]);return n()},immediateLoad:!0},"Woonheuvels ZH":{name:"Woonheuvels ZH",factory:async()=>{const{createWoonheuvelsLayerOL:n}=await Ne(async()=>{const{createWoonheuvelsLayerOL:e}=await import("./pdokWMSLayers-Bk6vdX82.js");return{createWoonheuvelsLayerOL:e}},[]);return n()},immediateLoad:!0},"Romeinse Forten":{name:"Romeinse Forten",factory:async()=>{const{createRomeinseFortenLayerOL:n}=await Ne(async()=>{const{createRomeinseFortenLayerOL:e}=await import("./pdokWMSLayers-Bk6vdX82.js");return{createRomeinseFortenLayerOL:e}},[]);return n()},immediateLoad:!0},Windmolens:{name:"Windmolens",factory:async()=>{const{createWindmolensLayerOL:n}=await Ne(async()=>{const{createWindmolensLayerOL:e}=await import("./pdokWMSLayers-Bk6vdX82.js");return{createWindmolensLayerOL:e}},[]);return n()},immediateLoad:!0},Erfgoedlijnen:{name:"Erfgoedlijnen",factory:async()=>{const{createErfgoedlijnenLayerOL:n}=await Ne(async()=>{const{createErfgoedlijnenLayerOL:e}=await import("./pdokWMSLayers-Bk6vdX82.js");return{createErfgoedlijnenLayerOL:e}},[]);return n()},immediateLoad:!0},"Oude Kernen":{name:"Oude Kernen",factory:async()=>{const{createOudeKernenLayerOL:n}=await Ne(async()=>{const{createOudeKernenLayerOL:e}=await import("./pdokWMSLayers-Bk6vdX82.js");return{createOudeKernenLayerOL:e}},[]);return n()},immediateLoad:!0},"Relictenkaart Punten":{name:"Relictenkaart Punten",factory:async()=>{const{createRelictenkaartPuntenLayerOL:n}=await Ne(async()=>{const{createRelictenkaartPuntenLayerOL:e}=await import("./pdokWMSLayers-Bk6vdX82.js");return{createRelictenkaartPuntenLayerOL:e}},[]);return n()},immediateLoad:!0},"Relictenkaart Lijnen":{name:"Relictenkaart Lijnen",factory:async()=>{const{createRelictenkaartLijnenLayerOL:n}=await Ne(async()=>{const{createRelictenkaartLijnenLayerOL:e}=await import("./pdokWMSLayers-Bk6vdX82.js");return{createRelictenkaartLijnenLayerOL:e}},[]);return n()},immediateLoad:!0},"Relictenkaart Vlakken":{name:"Relictenkaart Vlakken",factory:async()=>{const{createRelictenkaartVlakkenLayerOL:n}=await Ne(async()=>{const{createRelictenkaartVlakkenLayerOL:e}=await import("./pdokWMSLayers-Bk6vdX82.js");return{createRelictenkaartVlakkenLayerOL:e}},[]);return n()},immediateLoad:!0},"Verdronken Dorpen":{name:"Verdronken Dorpen",factory:async()=>{const{createVerdronkenDorpenLayerOL:n}=await Ne(async()=>{const{createVerdronkenDorpenLayerOL:e}=await import("./pdokWMSLayers-Bk6vdX82.js");return{createVerdronkenDorpenLayerOL:e}},[]);return n()},immediateLoad:!0},"AMK Monumenten":{name:"AMK Monumenten",factory:async()=>{const{createAMKLayerOL:n}=await Ne(async()=>{const{createAMKLayerOL:e}=await import("./amkOL-Bjx37vW9.js");return{createAMKLayerOL:e}},__vite__mapDeps([0,1]));return n()},immediateLoad:!1},"Romeinse wegen":{name:"Romeinse wegen",factory:async()=>{const{createRomeinseWegenLayerOL:n}=await Ne(async()=>{const{createRomeinseWegenLayerOL:e}=await import("./romeinsOL-DxALkPpa.js");return{createRomeinseWegenLayerOL:e}},__vite__mapDeps([2,1]));return n()},immediateLoad:!1},Kastelen:{name:"Kastelen",factory:async()=>{const{createKastelenLayerOL:n}=await Ne(async()=>{const{createKastelenLayerOL:e}=await import("./kastelenOL-B_6W889U.js");return{createKastelenLayerOL:e}},__vite__mapDeps([3,4]));return n()},immediateLoad:!1},Veengebieden:{name:"Veengebieden",factory:async()=>{const{createVeengebiedenLayerOL:n}=await Ne(async()=>{const{createVeengebiedenLayerOL:e}=await import("./veengebiedenOL-H6-QuSxq.js");return{createVeengebiedenLayerOL:e}},[]);return n()},immediateLoad:!1},Hunebedden:{name:"Hunebedden",factory:async()=>{const{createHunebeddenLayerOL:n}=await Ne(async()=>{const{createHunebeddenLayerOL:e}=await import("./hunebeddenOL-DFSfrKYL.js");return{createHunebeddenLayerOL:e}},__vite__mapDeps([5,4]));return n()},immediateLoad:!1},"UIKAV Punten":{name:"UIKAV Punten",factory:async()=>{const{createUIKAVArcheoPuntenLayerOL:n}=await Ne(async()=>{const{createUIKAVArcheoPuntenLayerOL:e}=await import("./uikavArcheoPuntenOL-DQ3prAUj.js");return{createUIKAVArcheoPuntenLayerOL:e}},__vite__mapDeps([6,7,1,4]));return n()},immediateLoad:!1},"UIKAV Vlakken":{name:"UIKAV Vlakken",factory:async()=>{const{createUIKAVVlakkenLayerOL:n}=await Ne(async()=>{const{createUIKAVVlakkenLayerOL:e}=await import("./uikavVlakkenOL-BRooJep4.js");return{createUIKAVVlakkenLayerOL:e}},__vite__mapDeps([8,7,1]));return n()},immediateLoad:!1},"UIKAV Buffer":{name:"UIKAV Buffer",factory:async()=>{const{createUIKAVBufferlaagLayerOL:n}=await Ne(async()=>{const{createUIKAVBufferlaagLayerOL:e}=await import("./uikavBufferlaagOL-D36_satW.js");return{createUIKAVBufferlaagLayerOL:e}},__vite__mapDeps([9,7,1]));return n()},immediateLoad:!1},"UIKAV Expert":{name:"UIKAV Expert",factory:async()=>{const{createUIKAVExpertLayerOL:n}=await Ne(async()=>{const{createUIKAVExpertLayerOL:e}=await import("./uikavExpertOL-K2qBB0JZ.js");return{createUIKAVExpertLayerOL:e}},__vite__mapDeps([10,7,1]));return n()},immediateLoad:!1},"UIKAV Indeling":{name:"UIKAV Indeling",factory:async()=>{const{createUIKAVUiterwaardenLayerOL:n}=await Ne(async()=>{const{createUIKAVUiterwaardenLayerOL:e}=await import("./uikavUiterwaardenOL-CcvxIOcM.js");return{createUIKAVUiterwaardenLayerOL:e}},__vite__mapDeps([11,7,1]));return n()},immediateLoad:!1},Speeltuinen:{name:"Speeltuinen",factory:async()=>{const{createSpeeltuinenLayerOL:n}=await Ne(async()=>{const{createSpeeltuinenLayerOL:e}=await import("./speeltuinenOL-qsY9d8L-.js");return{createSpeeltuinenLayerOL:e}},__vite__mapDeps([12,7,1,4]));return n()},immediateLoad:!1},Musea:{name:"Musea",factory:async()=>{const{createMuseaLayerOL:n}=await Ne(async()=>{const{createMuseaLayerOL:e}=await import("./museaOL-Bvfzh4_2.js");return{createMuseaLayerOL:e}},__vite__mapDeps([13,7,1,4]));return n()},immediateLoad:!1},Strandjes:{name:"Strandjes",factory:async()=>{const{createStrandjesLayerOL:n}=await Ne(async()=>{const{createStrandjesLayerOL:e}=await import("./strandjesOL-6rs0zR3P.js");return{createStrandjesLayerOL:e}},__vite__mapDeps([14,7,1]));return n()},immediateLoad:!1},Parken:{name:"Parken",factory:async()=>{const{createParkenLayerOL:n}=await Ne(async()=>{const{createParkenLayerOL:e}=await import("./parkenOL-D_bjUK6p.js");return{createParkenLayerOL:e}},__vite__mapDeps([15,7,1]));return n()},immediateLoad:!1},"Fossielen Nederland":{name:"Fossielen Nederland",factory:async()=>{const{createFossielenLayerOL:n}=await Ne(async()=>{const{createFossielenLayerOL:e}=await import("./fossielenOL-ZOiJ5UuO.js");return{createFossielenLayerOL:e}},__vite__mapDeps([16,17,4]));return n()},immediateLoad:!1},"Fossielen Belgi":{name:"Fossielen Belgi",factory:async()=>{const{createFossielenBelgieLayerOL:n}=await Ne(async()=>{const{createFossielenBelgieLayerOL:e}=await import("./fossielenBelgieOL-BwJfFyy-.js");return{createFossielenBelgieLayerOL:e}},__vite__mapDeps([18,17,4]));return n()},immediateLoad:!1},"Fossielen Duitsland":{name:"Fossielen Duitsland",factory:async()=>{const{createFossielenDuitslandLayerOL:n}=await Ne(async()=>{const{createFossielenDuitslandLayerOL:e}=await import("./fossielenDuitslandOL-B4-PI6dT.js");return{createFossielenDuitslandLayerOL:e}},__vite__mapDeps([19,17,4]));return n()},immediateLoad:!1},"Fossielen Frankrijk":{name:"Fossielen Frankrijk",factory:async()=>{const{createFossielenFrankrijkLayerOL:n}=await Ne(async()=>{const{createFossielenFrankrijkLayerOL:e}=await import("./fossielenFrankrijkOL-DVGcZkkD.js");return{createFossielenFrankrijkLayerOL:e}},__vite__mapDeps([20,17,4]));return n()},immediateLoad:!1},"WWII Bunkers":{name:"WWII Bunkers",factory:async()=>{const{createBunkersLayerOL:n}=await Ne(async()=>{const{createBunkersLayerOL:e}=await import("./bunkersOL-DfJtaUpb.js");return{createBunkersLayerOL:e}},__vite__mapDeps([21,4]));return n()},immediateLoad:!1},Grafheuvels:{name:"Grafheuvels",factory:async()=>{const{createGrafheuvelsLayerOL:n}=await Ne(async()=>{const{createGrafheuvelsLayerOL:e}=await import("./grafheuvelsOL-CJbRndbK.js");return{createGrafheuvelsLayerOL:e}},__vite__mapDeps([22,4]));return n()},immediateLoad:!1},Slagvelden:{name:"Slagvelden",factory:async()=>{const{createSlagveldenLayerOL:n}=await Ne(async()=>{const{createSlagveldenLayerOL:e}=await import("./slagveldenOL-D1Z3mFH1.js");return{createSlagveldenLayerOL:e}},[]);return n()},immediateLoad:!1},"Militaire Vliegvelden":{name:"Militaire Vliegvelden",factory:async()=>{const{createVliegveldenLayerOL:n}=await Ne(async()=>{const{createVliegveldenLayerOL:e}=await import("./vliegveldenOL-BtYj_plZ.js");return{createVliegveldenLayerOL:e}},[]);return n()},immediateLoad:!1}};function nG(){return Object.values(tk).filter(n=>n.immediateLoad)}const Ei=Mo()(kc((n,e)=>({map:null,rotation:0,rotationEnabled:!0,setMap:t=>{n(i=>{i.map=t})},setRotation:t=>{n(i=>{if(i.rotation=t,i.map&&i.rotationEnabled){const r=t*Math.PI/180;i.map.getView().setRotation(r)}})},enableRotation:()=>{n(t=>{t.rotationEnabled=!0})},disableRotation:()=>{n(t=>{t.rotationEnabled=!1,t.rotation=0,t.map&&t.map.getView().animate({rotation:0,duration:500})})}}))),ai=Mo()(kc((n,e)=>({visible:{"CartoDB (licht)":!0,OpenStreetMap:!1,Luchtfoto:!1,"Labels Overlay":!1,"TMK 1850":!1,"Bonnebladen 1900":!1,Hunebedden:!1,"FAMKE Steentijd":!1,Grafheuvels:!1,Terpen:!1,"AMK Monumenten":!1,"Romeinse wegen":!1,Kastelen:!1,IKAW:!1,"Archeo Landschappen":!1,Rijksmonumenten:!1,Werelderfgoed:!1,"WWII Bunkers":!1,Slagvelden:!1,"Militaire Vliegvelden":!1,Verdedigingslinies:!1,Inundatiegebieden:!1,"Militaire Objecten":!1,"Paleokaart 800 n.Chr.":!1,"Paleokaart 100 n.Chr.":!1,"Paleokaart 500 v.Chr.":!1,"Paleokaart 1500 v.Chr.":!1,"Paleokaart 2750 v.Chr.":!1,"Paleokaart 5500 v.Chr.":!1,"Paleokaart 9000 v.Chr.":!1,"Religieus Erfgoed":!1,"UIKAV Punten":!1,"UIKAV Vlakken":!1,"UIKAV Buffer":!1,"UIKAV Expert":!1,"UIKAV Indeling":!1,"AHN4 Hillshade NL":!1,"AHN4 Multi-Hillshade NL":!1,"AHN 0.5m":!1,"World Hillshade":!1,Veengebieden:!1,Geomorfologie:!1,Bodemkaart:!1,"Fossielen Nederland":!1,"Fossielen Belgi":!1,"Fossielen Duitsland":!1,"Fossielen Frankrijk":!1,Parken:!1,Speeltuinen:!1,Musea:!1,Strandjes:!1,Gewaspercelen:!1,"Kadastrale Grenzen":!1,Scheepswrakken:!1,"Woonheuvels ZH":!1,"Romeinse Forten":!1,Windmolens:!1,Erfgoedlijnen:!1,"Oude Kernen":!1,"Relictenkaart Punten":!1,"Relictenkaart Lijnen":!1,"Relictenkaart Vlakken":!1,"Verdronken Dorpen":!1},opacity:{"AHN 0.5m":.7,Geomorfologie:.5,Bodemkaart:.6,IKAW:.5,"Archeo Landschappen":.5,"AHN4 Hillshade NL":.7,"AHN4 Multi-Hillshade NL":.7,"World Hillshade":.7,Terpen:.7,Verdedigingslinies:.7,Inundatiegebieden:.5,"Militaire Objecten":.8,"Paleokaart 800 n.Chr.":.7,"Paleokaart 100 n.Chr.":.7,"Paleokaart 500 v.Chr.":.7,"Paleokaart 1500 v.Chr.":.7,"Paleokaart 2750 v.Chr.":.7,"Paleokaart 5500 v.Chr.":.7,"Paleokaart 9000 v.Chr.":.7,"Religieus Erfgoed":.8,Gewaspercelen:.6,"Kadastrale Grenzen":.7,Erfgoedlijnen:.7,"Oude Kernen":.6,"Relictenkaart Vlakken":.5},loadingState:{},layers:{},toggleLayer:t=>{const i=e(),r=!i.visible[t];n(s=>{s.visible[t]=r}),r&&!i.layers[t]?e().loadLayer(t):i.layers[t]&&i.layers[t].setVisible(r)},setLayerVisibility:(t,i)=>{const r=e();n(s=>{s.visible[t]=i;const o=s.layers[t];o&&o.setVisible(i)}),i&&!r.layers[t]&&e().loadLayer(t)},setLayerOpacity:(t,i)=>{n(r=>{r.opacity[t]=i;const s=r.layers[t];s&&s.setOpacity(i)})},registerLayer:(t,i)=>{n(r=>{r.layers[t]=i,r.loadingState[t]="loaded",r.visible[t]!==void 0&&i.setVisible(r.visible[t]),r.opacity[t]!==void 0&&i.setOpacity(r.opacity[t])})},unregisterLayer:t=>{n(i=>{delete i.layers[t],delete i.loadingState[t]})},loadLayer:async t=>{const i=e();if(i.loadingState[t]==="loading"||i.layers[t])return;const r=tk[t];if(!r){console.warn(` Layer "${t}" not found in registry`);return}const s=Ei.getState().map;if(!s){console.warn(` Cannot load layer "${t}": map not initialized`);return}n(o=>{o.loadingState[t]="loading"}),console.log(` Loading layer: ${t}...`);try{const o=await r.factory();if(!o)throw new Error("Factory returned null");const a=e();o.setVisible(a.visible[t]??!1),a.opacity[t]!==void 0&&o.setOpacity(a.opacity[t]),s.addLayer(o),n(c=>{c.layers[t]=o,c.loadingState[t]="loaded"}),console.log(` Layer loaded: ${t}`)}catch(o){console.error(` Failed to load layer "${t}":`,o),n(a=>{a.loadingState[t]="error"})}}}))),xh=Mo()(kc((n,e)=>({layerControlOpen:!1,legendOpen:!1,backgroundsPanelOpen:!1,themesPanelOpen:!1,settingsPanelOpen:!1,infoPanelOpen:!1,presetsPanelOpen:!1,collapsedCategories:new Set,closeAllPanels:()=>{n(t=>{t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1})},toggleLayerControl:()=>{n(t=>{t.layerControlOpen=!t.layerControlOpen})},toggleLegend:()=>{n(t=>{t.legendOpen=!t.legendOpen})},toggleBackgroundsPanel:()=>{n(t=>{const i=t.backgroundsPanelOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,i||(t.backgroundsPanelOpen=!0)})},toggleThemesPanel:()=>{n(t=>{const i=t.themesPanelOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,i||(t.themesPanelOpen=!0)})},toggleSettingsPanel:()=>{n(t=>{const i=t.settingsPanelOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,i||(t.settingsPanelOpen=!0)})},toggleInfoPanel:()=>{n(t=>{const i=t.infoPanelOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,i||(t.infoPanelOpen=!0)})},togglePresetsPanel:()=>{n(t=>{const i=t.presetsPanelOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,i||(t.presetsPanelOpen=!0)})},toggleCategory:t=>{n(i=>{i.collapsedCategories.has(t)?i.collapsedCategories.delete(t):i.collapsedCategories.add(t)})},setLayerControlOpen:t=>{n(i=>{i.layerControlOpen=t})},setLegendOpen:t=>{n(i=>{i.legendOpen=t})}})));Mo()(kc(n=>({user:null,loading:!0,error:null,setUser:e=>{n(t=>{t.user=e,t.loading=!1})},setLoading:e=>{n(t=>{t.loading=e})},setError:e=>{n(t=>{t.error=e})}})));const iG=()=>{};var AP={};const nk=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},rG=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const r=n[t++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=n[t++];e[i++]=String.fromCharCode((r&31)<<6|s&63)}else if(r>239&&r<365){const s=n[t++],o=n[t++],a=n[t++],c=((r&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[i++]=String.fromCharCode(55296+(c>>10)),e[i++]=String.fromCharCode(56320+(c&1023))}else{const s=n[t++],o=n[t++];e[i++]=String.fromCharCode((r&15)<<12|(s&63)<<6|o&63)}}return e.join("")},ik={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<n.length;r+=3){const s=n[r],o=r+1<n.length,a=o?n[r+1]:0,c=r+2<n.length,h=c?n[r+2]:0,d=s>>2,g=(s&3)<<4|a>>4;let m=(a&15)<<2|h>>6,y=h&63;c||(y=64,o||(m=64)),i.push(t[d],t[g],t[m],t[y])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(nk(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):rG(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<n.length;){const s=t[n.charAt(r++)],a=r<n.length?t[n.charAt(r)]:0;++r;const h=r<n.length?t[n.charAt(r)]:64;++r;const g=r<n.length?t[n.charAt(r)]:64;if(++r,s==null||a==null||h==null||g==null)throw new sG;const m=s<<2|a>>4;if(i.push(m),h!==64){const y=a<<4&240|h>>2;if(i.push(y),g!==64){const w=h<<6&192|g;i.push(w)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class sG extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const oG=function(n){const e=nk(n);return ik.encodeByteArray(e,!0)},K0=function(n){return oG(n).replace(/\./g,"")},rk=function(n){try{return ik.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function sk(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const aG=()=>sk().__FIREBASE_DEFAULTS__,lG=()=>{if(typeof process>"u"||typeof AP>"u")return;const n=AP.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},cG=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&rk(n[1]);return e&&JSON.parse(e)},ry=()=>{try{return iG()||aG()||lG()||cG()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},ok=n=>ry()?.emulatorHosts?.[n],ak=n=>{const e=ok(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},lk=()=>ry()?.config,ck=n=>ry()?.[`_${n}`];class uG{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}function Lc(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Yx(n){return(await fetch(n,{credentials:"include"})).ok}function uk(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",r=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...n};return[K0(JSON.stringify(t)),K0(JSON.stringify(o)),""].join(".")}const xf={};function hG(){const n={prod:[],emulator:[]};for(const e of Object.keys(xf))xf[e]?n.emulator.push(e):n.prod.push(e);return n}function dG(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let CP=!1;function Xx(n,e){if(typeof window>"u"||typeof document>"u"||!Lc(window.location.host)||xf[n]===e||xf[n]||CP)return;xf[n]=e;function t(m){return`__firebase__banner__${m}`}const i="__firebase__banner",s=hG().prod.length>0;function o(){const m=document.getElementById(i);m&&m.remove()}function a(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function c(m,y){m.setAttribute("width","24"),m.setAttribute("id",y),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function h(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{CP=!0,o()},m}function d(m,y){m.setAttribute("id",y),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function g(){const m=dG(i),y=t("text"),w=document.getElementById(y)||document.createElement("span"),T=t("learnmore"),E=document.getElementById(T)||document.createElement("a"),P=t("preprendIcon"),M=document.getElementById(P)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const N=m.element;a(N),d(E,T);const D=h();c(M,P),N.append(M,w,E,D),document.body.appendChild(N)}s?(w.innerText="Preview backend disconnected.",M.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(M.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,w.innerText="Preview backend running in this workspace."),w.setAttribute("id",y)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",g):g()}function wn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function fG(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(wn())}function hk(){const n=ry()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function gG(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function mG(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function pG(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function _G(){const n=wn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function dk(){return!hk()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function fk(){return!hk()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function gk(){try{return typeof indexedDB=="object"}catch{return!1}}function yG(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{e(r.error?.message||"")}}catch(t){e(t)}})}const vG="FirebaseError";class Us extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=vG,Object.setPrototypeOf(this,Us.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Wg.prototype.create)}}class Wg{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},r=`${this.service}/${e}`,s=this.errors[e],o=s?EG(s,i):"Error",a=`${this.serviceName}: ${o} (${r}).`;return new Us(r,a,i)}}function EG(n,e){return n.replace(wG,(t,i)=>{const r=e[i];return r!=null?String(r):`<${i}?>`})}const wG=/\{\$([^}]+)}/g;function xG(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function gc(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const r of t){if(!i.includes(r))return!1;const s=n[r],o=e[r];if(MP(s)&&MP(o)){if(!gc(s,o))return!1}else if(s!==o)return!1}for(const r of i)if(!t.includes(r))return!1;return!0}function MP(n){return n!==null&&typeof n=="object"}function Hg(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function SG(n,e){const t=new IG(n,e);return t.subscribe.bind(t)}class IG{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let r;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");TG(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:i},r.next===void 0&&(r.next=$1),r.error===void 0&&(r.error=$1),r.complete===void 0&&(r.complete=$1);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function TG(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function $1(){}function ui(n){return n&&n._delegate?n._delegate:n}class Ba{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Ol="[DEFAULT]";class RG{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new uG;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(r){if(i)return null;throw r}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(AG(e))try{this.getOrInitializeService({instanceIdentifier:Ol})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:r});i.resolve(s)}catch{}}}}clearInstance(e=Ol){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ol){return this.instances.has(e)}getOptions(e=Ol){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);i===a&&o.resolve(r)}return r}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(i)??new Set;r.add(e),this.onInitCallbacks.set(i,r);const s=this.instances.get(i);return s&&e(s,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const r of i)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:PG(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Ol){return this.component?this.component.multipleInstances?e:Ol:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function PG(n){return n===Ol?void 0:n}function AG(n){return n.instantiationMode==="EAGER"}class CG{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new RG(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var nt;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(nt||(nt={}));const MG={debug:nt.DEBUG,verbose:nt.VERBOSE,info:nt.INFO,warn:nt.WARN,error:nt.ERROR,silent:nt.SILENT},bG=nt.INFO,kG={[nt.DEBUG]:"log",[nt.VERBOSE]:"log",[nt.INFO]:"info",[nt.WARN]:"warn",[nt.ERROR]:"error"},LG=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),r=kG[e];if(r)console[r](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Qx{constructor(e){this.name=e,this._logLevel=bG,this._logHandler=LG,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in nt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?MG[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,nt.DEBUG,...e),this._logHandler(this,nt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,nt.VERBOSE,...e),this._logHandler(this,nt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,nt.INFO,...e),this._logHandler(this,nt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,nt.WARN,...e),this._logHandler(this,nt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,nt.ERROR,...e),this._logHandler(this,nt.ERROR,...e)}}const NG=(n,e)=>e.some(t=>n instanceof t);let bP,kP;function OG(){return bP||(bP=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function DG(){return kP||(kP=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const mk=new WeakMap,QE=new WeakMap,pk=new WeakMap,W1=new WeakMap,Zx=new WeakMap;function VG(n){const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(La(n.result)),r()},o=()=>{i(n.error),r()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&mk.set(t,n)}).catch(()=>{}),Zx.set(e,n),e}function FG(n){if(QE.has(n))return;const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),r()},o=()=>{i(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});QE.set(n,e)}let ZE={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return QE.get(n);if(e==="objectStoreNames")return n.objectStoreNames||pk.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return La(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function GG(n){ZE=n(ZE)}function jG(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(H1(this),e,...t);return pk.set(i,e.sort?e.sort():[e]),La(i)}:DG().includes(n)?function(...e){return n.apply(H1(this),e),La(mk.get(this))}:function(...e){return La(n.apply(H1(this),e))}}function UG(n){return typeof n=="function"?jG(n):(n instanceof IDBTransaction&&FG(n),NG(n,OG())?new Proxy(n,ZE):n)}function La(n){if(n instanceof IDBRequest)return VG(n);if(W1.has(n))return W1.get(n);const e=UG(n);return e!==n&&(W1.set(n,e),Zx.set(e,n)),e}const H1=n=>Zx.get(n);function BG(n,e,{blocked:t,upgrade:i,blocking:r,terminated:s}={}){const o=indexedDB.open(n,e),a=La(o);return i&&o.addEventListener("upgradeneeded",c=>{i(La(o.result),c.oldVersion,c.newVersion,La(o.transaction),c)}),t&&o.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),a.then(c=>{s&&c.addEventListener("close",()=>s()),r&&c.addEventListener("versionchange",h=>r(h.oldVersion,h.newVersion,h))}).catch(()=>{}),a}const zG=["get","getKey","getAll","getAllKeys","count"],$G=["put","add","delete","clear"],K1=new Map;function LP(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(K1.get(e))return K1.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,r=$G.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(r||zG.includes(t)))return;const s=async function(o,...a){const c=this.transaction(o,r?"readwrite":"readonly");let h=c.store;return i&&(h=h.index(a.shift())),(await Promise.all([h[t](...a),r&&c.done]))[0]};return K1.set(e,s),s}GG(n=>({...n,get:(e,t,i)=>LP(e,t)||n.get(e,t,i),has:(e,t)=>!!LP(e,t)||n.has(e,t)}));class WG{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(HG(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function HG(n){return n.getComponent()?.type==="VERSION"}const JE="@firebase/app",NP="0.14.6";const xo=new Qx("@firebase/app"),KG="@firebase/app-compat",qG="@firebase/analytics-compat",YG="@firebase/analytics",XG="@firebase/app-check-compat",QG="@firebase/app-check",ZG="@firebase/auth",JG="@firebase/auth-compat",e7="@firebase/database",t7="@firebase/data-connect",n7="@firebase/database-compat",i7="@firebase/functions",r7="@firebase/functions-compat",s7="@firebase/installations",o7="@firebase/installations-compat",a7="@firebase/messaging",l7="@firebase/messaging-compat",c7="@firebase/performance",u7="@firebase/performance-compat",h7="@firebase/remote-config",d7="@firebase/remote-config-compat",f7="@firebase/storage",g7="@firebase/storage-compat",m7="@firebase/firestore",p7="@firebase/ai",_7="@firebase/firestore-compat",y7="firebase",v7="12.6.0";const ew="[DEFAULT]",E7={[JE]:"fire-core",[KG]:"fire-core-compat",[YG]:"fire-analytics",[qG]:"fire-analytics-compat",[QG]:"fire-app-check",[XG]:"fire-app-check-compat",[ZG]:"fire-auth",[JG]:"fire-auth-compat",[e7]:"fire-rtdb",[t7]:"fire-data-connect",[n7]:"fire-rtdb-compat",[i7]:"fire-fn",[r7]:"fire-fn-compat",[s7]:"fire-iid",[o7]:"fire-iid-compat",[a7]:"fire-fcm",[l7]:"fire-fcm-compat",[c7]:"fire-perf",[u7]:"fire-perf-compat",[h7]:"fire-rc",[d7]:"fire-rc-compat",[f7]:"fire-gcs",[g7]:"fire-gcs-compat",[m7]:"fire-fst",[_7]:"fire-fst-compat",[p7]:"fire-vertex","fire-js":"fire-js",[y7]:"fire-js-all"};const q0=new Map,w7=new Map,tw=new Map;function OP(n,e){try{n.container.addComponent(e)}catch(t){xo.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function mc(n){const e=n.name;if(tw.has(e))return xo.debug(`There were multiple attempts to register component ${e}.`),!1;tw.set(e,n);for(const t of q0.values())OP(t,n);for(const t of w7.values())OP(t,n);return!0}function sy(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Yr(n){return n==null?!1:n.settings!==void 0}const x7={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Na=new Wg("app","Firebase",x7);class S7{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Ba("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Na.create("app-deleted",{appName:this._name})}}const Nc=v7;function _k(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i={name:ew,automaticDataCollectionEnabled:!0,...e},r=i.name;if(typeof r!="string"||!r)throw Na.create("bad-app-name",{appName:String(r)});if(t||(t=lk()),!t)throw Na.create("no-options");const s=q0.get(r);if(s){if(gc(t,s.options)&&gc(i,s.config))return s;throw Na.create("duplicate-app",{appName:r})}const o=new CG(r);for(const c of tw.values())o.addComponent(c);const a=new S7(t,i,o);return q0.set(r,a),a}function Jx(n=ew){const e=q0.get(n);if(!e&&n===ew&&lk())return _k();if(!e)throw Na.create("no-app",{appName:n});return e}function Ms(n,e,t){let i=E7[n]??n;t&&(i+=`-${t}`);const r=i.match(/\s|\//),s=e.match(/\s|\//);if(r||s){const o=[`Unable to register library "${i}" with version "${e}":`];r&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),r&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),xo.warn(o.join(" "));return}mc(new Ba(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const I7="firebase-heartbeat-database",T7=1,rg="firebase-heartbeat-store";let q1=null;function yk(){return q1||(q1=BG(I7,T7,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(rg)}catch(t){console.warn(t)}}}}).catch(n=>{throw Na.create("idb-open",{originalErrorMessage:n.message})})),q1}async function R7(n){try{const t=(await yk()).transaction(rg),i=await t.objectStore(rg).get(vk(n));return await t.done,i}catch(e){if(e instanceof Us)xo.warn(e.message);else{const t=Na.create("idb-get",{originalErrorMessage:e?.message});xo.warn(t.message)}}}async function DP(n,e){try{const i=(await yk()).transaction(rg,"readwrite");await i.objectStore(rg).put(e,vk(n)),await i.done}catch(t){if(t instanceof Us)xo.warn(t.message);else{const i=Na.create("idb-set",{originalErrorMessage:t?.message});xo.warn(i.message)}}}function vk(n){return`${n.name}!${n.options.appId}`}const P7=1024,A7=30;class C7{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new b7(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=VP();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(r=>r.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>A7){const r=k7(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(r,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){xo.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=VP(),{heartbeatsToSend:t,unsentEntries:i}=M7(this._heartbeatsCache.heartbeats),r=K0(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(e){return xo.warn(e),""}}}function VP(){return new Date().toISOString().substring(0,10)}function M7(n,e=P7){const t=[];let i=n.slice();for(const r of n){const s=t.find(o=>o.agent===r.agent);if(s){if(s.dates.push(r.date),FP(t)>e){s.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),FP(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class b7{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return gk()?yG().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await R7(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return DP(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return DP(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function FP(n){return K0(JSON.stringify({version:2,heartbeats:n})).length}function k7(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}function L7(n){mc(new Ba("platform-logger",e=>new WG(e),"PRIVATE")),mc(new Ba("heartbeat",e=>new C7(e),"PRIVATE")),Ms(JE,NP,n),Ms(JE,NP,"esm2020"),Ms("fire-js","")}L7("");var GP=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Oa,Ek;(function(){var n;function e(L,A){function k(){}k.prototype=A.prototype,L.F=A.prototype,L.prototype=new k,L.prototype.constructor=L,L.D=function(U,B,z){for(var O=Array(arguments.length-2),oe=2;oe<arguments.length;oe++)O[oe-2]=arguments[oe];return A.prototype[B].apply(U,O)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(L,A,k){k||(k=0);const U=Array(16);if(typeof A=="string")for(var B=0;B<16;++B)U[B]=A.charCodeAt(k++)|A.charCodeAt(k++)<<8|A.charCodeAt(k++)<<16|A.charCodeAt(k++)<<24;else for(B=0;B<16;++B)U[B]=A[k++]|A[k++]<<8|A[k++]<<16|A[k++]<<24;A=L.g[0],k=L.g[1],B=L.g[2];let z=L.g[3],O;O=A+(z^k&(B^z))+U[0]+3614090360&4294967295,A=k+(O<<7&4294967295|O>>>25),O=z+(B^A&(k^B))+U[1]+3905402710&4294967295,z=A+(O<<12&4294967295|O>>>20),O=B+(k^z&(A^k))+U[2]+606105819&4294967295,B=z+(O<<17&4294967295|O>>>15),O=k+(A^B&(z^A))+U[3]+3250441966&4294967295,k=B+(O<<22&4294967295|O>>>10),O=A+(z^k&(B^z))+U[4]+4118548399&4294967295,A=k+(O<<7&4294967295|O>>>25),O=z+(B^A&(k^B))+U[5]+1200080426&4294967295,z=A+(O<<12&4294967295|O>>>20),O=B+(k^z&(A^k))+U[6]+2821735955&4294967295,B=z+(O<<17&4294967295|O>>>15),O=k+(A^B&(z^A))+U[7]+4249261313&4294967295,k=B+(O<<22&4294967295|O>>>10),O=A+(z^k&(B^z))+U[8]+1770035416&4294967295,A=k+(O<<7&4294967295|O>>>25),O=z+(B^A&(k^B))+U[9]+2336552879&4294967295,z=A+(O<<12&4294967295|O>>>20),O=B+(k^z&(A^k))+U[10]+4294925233&4294967295,B=z+(O<<17&4294967295|O>>>15),O=k+(A^B&(z^A))+U[11]+2304563134&4294967295,k=B+(O<<22&4294967295|O>>>10),O=A+(z^k&(B^z))+U[12]+1804603682&4294967295,A=k+(O<<7&4294967295|O>>>25),O=z+(B^A&(k^B))+U[13]+4254626195&4294967295,z=A+(O<<12&4294967295|O>>>20),O=B+(k^z&(A^k))+U[14]+2792965006&4294967295,B=z+(O<<17&4294967295|O>>>15),O=k+(A^B&(z^A))+U[15]+1236535329&4294967295,k=B+(O<<22&4294967295|O>>>10),O=A+(B^z&(k^B))+U[1]+4129170786&4294967295,A=k+(O<<5&4294967295|O>>>27),O=z+(k^B&(A^k))+U[6]+3225465664&4294967295,z=A+(O<<9&4294967295|O>>>23),O=B+(A^k&(z^A))+U[11]+643717713&4294967295,B=z+(O<<14&4294967295|O>>>18),O=k+(z^A&(B^z))+U[0]+3921069994&4294967295,k=B+(O<<20&4294967295|O>>>12),O=A+(B^z&(k^B))+U[5]+3593408605&4294967295,A=k+(O<<5&4294967295|O>>>27),O=z+(k^B&(A^k))+U[10]+38016083&4294967295,z=A+(O<<9&4294967295|O>>>23),O=B+(A^k&(z^A))+U[15]+3634488961&4294967295,B=z+(O<<14&4294967295|O>>>18),O=k+(z^A&(B^z))+U[4]+3889429448&4294967295,k=B+(O<<20&4294967295|O>>>12),O=A+(B^z&(k^B))+U[9]+568446438&4294967295,A=k+(O<<5&4294967295|O>>>27),O=z+(k^B&(A^k))+U[14]+3275163606&4294967295,z=A+(O<<9&4294967295|O>>>23),O=B+(A^k&(z^A))+U[3]+4107603335&4294967295,B=z+(O<<14&4294967295|O>>>18),O=k+(z^A&(B^z))+U[8]+1163531501&4294967295,k=B+(O<<20&4294967295|O>>>12),O=A+(B^z&(k^B))+U[13]+2850285829&4294967295,A=k+(O<<5&4294967295|O>>>27),O=z+(k^B&(A^k))+U[2]+4243563512&4294967295,z=A+(O<<9&4294967295|O>>>23),O=B+(A^k&(z^A))+U[7]+1735328473&4294967295,B=z+(O<<14&4294967295|O>>>18),O=k+(z^A&(B^z))+U[12]+2368359562&4294967295,k=B+(O<<20&4294967295|O>>>12),O=A+(k^B^z)+U[5]+4294588738&4294967295,A=k+(O<<4&4294967295|O>>>28),O=z+(A^k^B)+U[8]+2272392833&4294967295,z=A+(O<<11&4294967295|O>>>21),O=B+(z^A^k)+U[11]+1839030562&4294967295,B=z+(O<<16&4294967295|O>>>16),O=k+(B^z^A)+U[14]+4259657740&4294967295,k=B+(O<<23&4294967295|O>>>9),O=A+(k^B^z)+U[1]+2763975236&4294967295,A=k+(O<<4&4294967295|O>>>28),O=z+(A^k^B)+U[4]+1272893353&4294967295,z=A+(O<<11&4294967295|O>>>21),O=B+(z^A^k)+U[7]+4139469664&4294967295,B=z+(O<<16&4294967295|O>>>16),O=k+(B^z^A)+U[10]+3200236656&4294967295,k=B+(O<<23&4294967295|O>>>9),O=A+(k^B^z)+U[13]+681279174&4294967295,A=k+(O<<4&4294967295|O>>>28),O=z+(A^k^B)+U[0]+3936430074&4294967295,z=A+(O<<11&4294967295|O>>>21),O=B+(z^A^k)+U[3]+3572445317&4294967295,B=z+(O<<16&4294967295|O>>>16),O=k+(B^z^A)+U[6]+76029189&4294967295,k=B+(O<<23&4294967295|O>>>9),O=A+(k^B^z)+U[9]+3654602809&4294967295,A=k+(O<<4&4294967295|O>>>28),O=z+(A^k^B)+U[12]+3873151461&4294967295,z=A+(O<<11&4294967295|O>>>21),O=B+(z^A^k)+U[15]+530742520&4294967295,B=z+(O<<16&4294967295|O>>>16),O=k+(B^z^A)+U[2]+3299628645&4294967295,k=B+(O<<23&4294967295|O>>>9),O=A+(B^(k|~z))+U[0]+4096336452&4294967295,A=k+(O<<6&4294967295|O>>>26),O=z+(k^(A|~B))+U[7]+1126891415&4294967295,z=A+(O<<10&4294967295|O>>>22),O=B+(A^(z|~k))+U[14]+2878612391&4294967295,B=z+(O<<15&4294967295|O>>>17),O=k+(z^(B|~A))+U[5]+4237533241&4294967295,k=B+(O<<21&4294967295|O>>>11),O=A+(B^(k|~z))+U[12]+1700485571&4294967295,A=k+(O<<6&4294967295|O>>>26),O=z+(k^(A|~B))+U[3]+2399980690&4294967295,z=A+(O<<10&4294967295|O>>>22),O=B+(A^(z|~k))+U[10]+4293915773&4294967295,B=z+(O<<15&4294967295|O>>>17),O=k+(z^(B|~A))+U[1]+2240044497&4294967295,k=B+(O<<21&4294967295|O>>>11),O=A+(B^(k|~z))+U[8]+1873313359&4294967295,A=k+(O<<6&4294967295|O>>>26),O=z+(k^(A|~B))+U[15]+4264355552&4294967295,z=A+(O<<10&4294967295|O>>>22),O=B+(A^(z|~k))+U[6]+2734768916&4294967295,B=z+(O<<15&4294967295|O>>>17),O=k+(z^(B|~A))+U[13]+1309151649&4294967295,k=B+(O<<21&4294967295|O>>>11),O=A+(B^(k|~z))+U[4]+4149444226&4294967295,A=k+(O<<6&4294967295|O>>>26),O=z+(k^(A|~B))+U[11]+3174756917&4294967295,z=A+(O<<10&4294967295|O>>>22),O=B+(A^(z|~k))+U[2]+718787259&4294967295,B=z+(O<<15&4294967295|O>>>17),O=k+(z^(B|~A))+U[9]+3951481745&4294967295,L.g[0]=L.g[0]+A&4294967295,L.g[1]=L.g[1]+(B+(O<<21&4294967295|O>>>11))&4294967295,L.g[2]=L.g[2]+B&4294967295,L.g[3]=L.g[3]+z&4294967295}i.prototype.v=function(L,A){A===void 0&&(A=L.length);const k=A-this.blockSize,U=this.C;let B=this.h,z=0;for(;z<A;){if(B==0)for(;z<=k;)r(this,L,z),z+=this.blockSize;if(typeof L=="string"){for(;z<A;)if(U[B++]=L.charCodeAt(z++),B==this.blockSize){r(this,U),B=0;break}}else for(;z<A;)if(U[B++]=L[z++],B==this.blockSize){r(this,U),B=0;break}}this.h=B,this.o+=A},i.prototype.A=function(){var L=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);L[0]=128;for(var A=1;A<L.length-8;++A)L[A]=0;A=this.o*8;for(var k=L.length-8;k<L.length;++k)L[k]=A&255,A/=256;for(this.v(L),L=Array(16),A=0,k=0;k<4;++k)for(let U=0;U<32;U+=8)L[A++]=this.g[k]>>>U&255;return L};function s(L,A){var k=a;return Object.prototype.hasOwnProperty.call(k,L)?k[L]:k[L]=A(L)}function o(L,A){this.h=A;const k=[];let U=!0;for(let B=L.length-1;B>=0;B--){const z=L[B]|0;U&&z==A||(k[B]=z,U=!1)}this.g=k}var a={};function c(L){return-128<=L&&L<128?s(L,function(A){return new o([A|0],A<0?-1:0)}):new o([L|0],L<0?-1:0)}function h(L){if(isNaN(L)||!isFinite(L))return g;if(L<0)return E(h(-L));const A=[];let k=1;for(let U=0;L>=k;U++)A[U]=L/k|0,k*=4294967296;return new o(A,0)}function d(L,A){if(L.length==0)throw Error("number format error: empty string");if(A=A||10,A<2||36<A)throw Error("radix out of range: "+A);if(L.charAt(0)=="-")return E(d(L.substring(1),A));if(L.indexOf("-")>=0)throw Error('number format error: interior "-" character');const k=h(Math.pow(A,8));let U=g;for(let z=0;z<L.length;z+=8){var B=Math.min(8,L.length-z);const O=parseInt(L.substring(z,z+B),A);B<8?(B=h(Math.pow(A,B)),U=U.j(B).add(h(O))):(U=U.j(k),U=U.add(h(O)))}return U}var g=c(0),m=c(1),y=c(16777216);n=o.prototype,n.m=function(){if(T(this))return-E(this).m();let L=0,A=1;for(let k=0;k<this.g.length;k++){const U=this.i(k);L+=(U>=0?U:4294967296+U)*A,A*=4294967296}return L},n.toString=function(L){if(L=L||10,L<2||36<L)throw Error("radix out of range: "+L);if(w(this))return"0";if(T(this))return"-"+E(this).toString(L);const A=h(Math.pow(L,6));var k=this;let U="";for(;;){const B=D(k,A).g;k=P(k,B.j(A));let z=((k.g.length>0?k.g[0]:k.h)>>>0).toString(L);if(k=B,w(k))return z+U;for(;z.length<6;)z="0"+z;U=z+U}},n.i=function(L){return L<0?0:L<this.g.length?this.g[L]:this.h};function w(L){if(L.h!=0)return!1;for(let A=0;A<L.g.length;A++)if(L.g[A]!=0)return!1;return!0}function T(L){return L.h==-1}n.l=function(L){return L=P(this,L),T(L)?-1:w(L)?0:1};function E(L){const A=L.g.length,k=[];for(let U=0;U<A;U++)k[U]=~L.g[U];return new o(k,~L.h).add(m)}n.abs=function(){return T(this)?E(this):this},n.add=function(L){const A=Math.max(this.g.length,L.g.length),k=[];let U=0;for(let B=0;B<=A;B++){let z=U+(this.i(B)&65535)+(L.i(B)&65535),O=(z>>>16)+(this.i(B)>>>16)+(L.i(B)>>>16);U=O>>>16,z&=65535,O&=65535,k[B]=O<<16|z}return new o(k,k[k.length-1]&-2147483648?-1:0)};function P(L,A){return L.add(E(A))}n.j=function(L){if(w(this)||w(L))return g;if(T(this))return T(L)?E(this).j(E(L)):E(E(this).j(L));if(T(L))return E(this.j(E(L)));if(this.l(y)<0&&L.l(y)<0)return h(this.m()*L.m());const A=this.g.length+L.g.length,k=[];for(var U=0;U<2*A;U++)k[U]=0;for(U=0;U<this.g.length;U++)for(let B=0;B<L.g.length;B++){const z=this.i(U)>>>16,O=this.i(U)&65535,oe=L.i(B)>>>16,Te=L.i(B)&65535;k[2*U+2*B]+=O*Te,M(k,2*U+2*B),k[2*U+2*B+1]+=z*Te,M(k,2*U+2*B+1),k[2*U+2*B+1]+=O*oe,M(k,2*U+2*B+1),k[2*U+2*B+2]+=z*oe,M(k,2*U+2*B+2)}for(L=0;L<A;L++)k[L]=k[2*L+1]<<16|k[2*L];for(L=A;L<2*A;L++)k[L]=0;return new o(k,0)};function M(L,A){for(;(L[A]&65535)!=L[A];)L[A+1]+=L[A]>>>16,L[A]&=65535,A++}function N(L,A){this.g=L,this.h=A}function D(L,A){if(w(A))throw Error("division by zero");if(w(L))return new N(g,g);if(T(L))return A=D(E(L),A),new N(E(A.g),E(A.h));if(T(A))return A=D(L,E(A)),new N(E(A.g),A.h);if(L.g.length>30){if(T(L)||T(A))throw Error("slowDivide_ only works with positive integers.");for(var k=m,U=A;U.l(L)<=0;)k=j(k),U=j(U);var B=W(k,1),z=W(U,1);for(U=W(U,2),k=W(k,2);!w(U);){var O=z.add(U);O.l(L)<=0&&(B=B.add(k),z=O),U=W(U,1),k=W(k,1)}return A=P(L,B.j(A)),new N(B,A)}for(B=g;L.l(A)>=0;){for(k=Math.max(1,Math.floor(L.m()/A.m())),U=Math.ceil(Math.log(k)/Math.LN2),U=U<=48?1:Math.pow(2,U-48),z=h(k),O=z.j(A);T(O)||O.l(L)>0;)k-=U,z=h(k),O=z.j(A);w(z)&&(z=m),B=B.add(z),L=P(L,O)}return new N(B,L)}n.B=function(L){return D(this,L).h},n.and=function(L){const A=Math.max(this.g.length,L.g.length),k=[];for(let U=0;U<A;U++)k[U]=this.i(U)&L.i(U);return new o(k,this.h&L.h)},n.or=function(L){const A=Math.max(this.g.length,L.g.length),k=[];for(let U=0;U<A;U++)k[U]=this.i(U)|L.i(U);return new o(k,this.h|L.h)},n.xor=function(L){const A=Math.max(this.g.length,L.g.length),k=[];for(let U=0;U<A;U++)k[U]=this.i(U)^L.i(U);return new o(k,this.h^L.h)};function j(L){const A=L.g.length+1,k=[];for(let U=0;U<A;U++)k[U]=L.i(U)<<1|L.i(U-1)>>>31;return new o(k,L.h)}function W(L,A){const k=A>>5;A%=32;const U=L.g.length-k,B=[];for(let z=0;z<U;z++)B[z]=A>0?L.i(z+k)>>>A|L.i(z+k+1)<<32-A:L.i(z+k);return new o(B,L.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,Ek=i,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=d,Oa=o}).apply(typeof GP<"u"?GP:typeof self<"u"?self:typeof window<"u"?window:{});var Dp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var wk,lf,xk,n0,nw,Sk,Ik,Tk;(function(){var n,e=Object.defineProperty;function t(p){p=[typeof globalThis=="object"&&globalThis,p,typeof window=="object"&&window,typeof self=="object"&&self,typeof Dp=="object"&&Dp];for(var S=0;S<p.length;++S){var R=p[S];if(R&&R.Math==Math)return R}throw Error("Cannot find global object")}var i=t(this);function r(p,S){if(S)e:{var R=i;p=p.split(".");for(var G=0;G<p.length-1;G++){var ee=p[G];if(!(ee in R))break e;R=R[ee]}p=p[p.length-1],G=R[p],S=S(G),S!=G&&S!=null&&e(R,p,{configurable:!0,writable:!0,value:S})}}r("Symbol.dispose",function(p){return p||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(p){return p||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(p){return p||function(S){var R=[],G;for(G in S)Object.prototype.hasOwnProperty.call(S,G)&&R.push([G,S[G]]);return R}});var s=s||{},o=this||self;function a(p){var S=typeof p;return S=="object"&&p!=null||S=="function"}function c(p,S,R){return p.call.apply(p.bind,arguments)}function h(p,S,R){return h=c,h.apply(null,arguments)}function d(p,S){var R=Array.prototype.slice.call(arguments,1);return function(){var G=R.slice();return G.push.apply(G,arguments),p.apply(this,G)}}function g(p,S){function R(){}R.prototype=S.prototype,p.Z=S.prototype,p.prototype=new R,p.prototype.constructor=p,p.Ob=function(G,ee,re){for(var ve=Array(arguments.length-2),Xe=2;Xe<arguments.length;Xe++)ve[Xe-2]=arguments[Xe];return S.prototype[ee].apply(G,ve)}}var m=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?p=>p&&AsyncContext.Snapshot.wrap(p):p=>p;function y(p){const S=p.length;if(S>0){const R=Array(S);for(let G=0;G<S;G++)R[G]=p[G];return R}return[]}function w(p,S){for(let G=1;G<arguments.length;G++){const ee=arguments[G];var R=typeof ee;if(R=R!="object"?R:ee?Array.isArray(ee)?"array":R:"null",R=="array"||R=="object"&&typeof ee.length=="number"){R=p.length||0;const re=ee.length||0;p.length=R+re;for(let ve=0;ve<re;ve++)p[R+ve]=ee[ve]}else p.push(ee)}}class T{constructor(S,R){this.i=S,this.j=R,this.h=0,this.g=null}get(){let S;return this.h>0?(this.h--,S=this.g,this.g=S.next,S.next=null):S=this.i(),S}}function E(p){o.setTimeout(()=>{throw p},0)}function P(){var p=L;let S=null;return p.g&&(S=p.g,p.g=p.g.next,p.g||(p.h=null),S.next=null),S}class M{constructor(){this.h=this.g=null}add(S,R){const G=N.get();G.set(S,R),this.h?this.h.next=G:this.g=G,this.h=G}}var N=new T(()=>new D,p=>p.reset());class D{constructor(){this.next=this.g=this.h=null}set(S,R){this.h=S,this.g=R,this.next=null}reset(){this.next=this.g=this.h=null}}let j,W=!1,L=new M,A=()=>{const p=Promise.resolve(void 0);j=()=>{p.then(k)}};function k(){for(var p;p=P();){try{p.h.call(p.g)}catch(R){E(R)}var S=N;S.j(p),S.h<100&&(S.h++,p.next=S.g,S.g=p)}W=!1}function U(){this.u=this.u,this.C=this.C}U.prototype.u=!1,U.prototype.dispose=function(){this.u||(this.u=!0,this.N())},U.prototype[Symbol.dispose]=function(){this.dispose()},U.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function B(p,S){this.type=p,this.g=this.target=S,this.defaultPrevented=!1}B.prototype.h=function(){this.defaultPrevented=!0};var z=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var p=!1,S=Object.defineProperty({},"passive",{get:function(){p=!0}});try{const R=()=>{};o.addEventListener("test",R,S),o.removeEventListener("test",R,S)}catch{}return p})();function O(p){return/^[\s\xa0]*$/.test(p)}function oe(p,S){B.call(this,p?p.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,p&&this.init(p,S)}g(oe,B),oe.prototype.init=function(p,S){const R=this.type=p.type,G=p.changedTouches&&p.changedTouches.length?p.changedTouches[0]:null;this.target=p.target||p.srcElement,this.g=S,S=p.relatedTarget,S||(R=="mouseover"?S=p.fromElement:R=="mouseout"&&(S=p.toElement)),this.relatedTarget=S,G?(this.clientX=G.clientX!==void 0?G.clientX:G.pageX,this.clientY=G.clientY!==void 0?G.clientY:G.pageY,this.screenX=G.screenX||0,this.screenY=G.screenY||0):(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0),this.button=p.button,this.key=p.key||"",this.ctrlKey=p.ctrlKey,this.altKey=p.altKey,this.shiftKey=p.shiftKey,this.metaKey=p.metaKey,this.pointerId=p.pointerId||0,this.pointerType=p.pointerType,this.state=p.state,this.i=p,p.defaultPrevented&&oe.Z.h.call(this)},oe.prototype.h=function(){oe.Z.h.call(this);const p=this.i;p.preventDefault?p.preventDefault():p.returnValue=!1};var Te="closure_listenable_"+(Math.random()*1e6|0),we=0;function _e(p,S,R,G,ee){this.listener=p,this.proxy=null,this.src=S,this.type=R,this.capture=!!G,this.ha=ee,this.key=++we,this.da=this.fa=!1}function Q(p){p.da=!0,p.listener=null,p.proxy=null,p.src=null,p.ha=null}function ce(p,S,R){for(const G in p)S.call(R,p[G],G,p)}function K(p,S){for(const R in p)S.call(void 0,p[R],R,p)}function V(p){const S={};for(const R in p)S[R]=p[R];return S}const I="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function de(p,S){let R,G;for(let ee=1;ee<arguments.length;ee++){G=arguments[ee];for(R in G)p[R]=G[R];for(let re=0;re<I.length;re++)R=I[re],Object.prototype.hasOwnProperty.call(G,R)&&(p[R]=G[R])}}function q(p){this.src=p,this.g={},this.h=0}q.prototype.add=function(p,S,R,G,ee){const re=p.toString();p=this.g[re],p||(p=this.g[re]=[],this.h++);const ve=X(p,S,G,ee);return ve>-1?(S=p[ve],R||(S.fa=!1)):(S=new _e(S,this.src,re,!!G,ee),S.fa=R,p.push(S)),S};function fe(p,S){const R=S.type;if(R in p.g){var G=p.g[R],ee=Array.prototype.indexOf.call(G,S,void 0),re;(re=ee>=0)&&Array.prototype.splice.call(G,ee,1),re&&(Q(S),p.g[R].length==0&&(delete p.g[R],p.h--))}}function X(p,S,R,G){for(let ee=0;ee<p.length;++ee){const re=p[ee];if(!re.da&&re.listener==S&&re.capture==!!R&&re.ha==G)return ee}return-1}var F="closure_lm_"+(Math.random()*1e6|0),te={};function Pe(p,S,R,G,ee){if(Array.isArray(S)){for(let re=0;re<S.length;re++)Pe(p,S[re],R,G,ee);return null}return R=ar(R),p&&p[Te]?p.J(S,R,a(G)?!!G.capture:!1,ee):Be(p,S,R,!1,G,ee)}function Be(p,S,R,G,ee,re){if(!S)throw Error("Invalid event type");const ve=a(ee)?!!ee.capture:!!ee;let Xe=Ln(p);if(Xe||(p[F]=Xe=new q(p)),R=Xe.add(S,R,G,ve,re),R.proxy)return R;if(G=Pt(),R.proxy=G,G.src=p,G.listener=R,p.addEventListener)z||(ee=ve),ee===void 0&&(ee=!1),p.addEventListener(S.toString(),G,ee);else if(p.attachEvent)p.attachEvent(xi(S.toString()),G);else if(p.addListener&&p.removeListener)p.addListener(G);else throw Error("addEventListener and attachEvent are unavailable.");return R}function Pt(){function p(R){return S.call(p.src,p.listener,R)}const S=kn;return p}function Kn(p,S,R,G,ee){if(Array.isArray(S))for(var re=0;re<S.length;re++)Kn(p,S[re],R,G,ee);else G=a(G)?!!G.capture:!!G,R=ar(R),p&&p[Te]?(p=p.i,re=String(S).toString(),re in p.g&&(S=p.g[re],R=X(S,R,G,ee),R>-1&&(Q(S[R]),Array.prototype.splice.call(S,R,1),S.length==0&&(delete p.g[re],p.h--)))):p&&(p=Ln(p))&&(S=p.g[S.toString()],p=-1,S&&(p=X(S,R,G,ee)),(R=p>-1?S[p]:null)&&bn(R))}function bn(p){if(typeof p!="number"&&p&&!p.da){var S=p.src;if(S&&S[Te])fe(S.i,p);else{var R=p.type,G=p.proxy;S.removeEventListener?S.removeEventListener(R,G,p.capture):S.detachEvent?S.detachEvent(xi(R),G):S.addListener&&S.removeListener&&S.removeListener(G),(R=Ln(S))?(fe(R,p),R.h==0&&(R.src=null,S[F]=null)):Q(p)}}}function xi(p){return p in te?te[p]:te[p]="on"+p}function kn(p,S){if(p.da)p=!0;else{S=new oe(S,this);const R=p.listener,G=p.ha||p.src;p.fa&&bn(p),p=R.call(G,S)}return p}function Ln(p){return p=p[F],p instanceof q?p:null}var Si="__closure_events_fn_"+(Math.random()*1e9>>>0);function ar(p){return typeof p=="function"?p:(p[Si]||(p[Si]=function(S){return p.handleEvent(S)}),p[Si])}function Mt(){U.call(this),this.i=new q(this),this.M=this,this.G=null}g(Mt,U),Mt.prototype[Te]=!0,Mt.prototype.removeEventListener=function(p,S,R,G){Kn(this,p,S,R,G)};function vt(p,S){var R,G=p.G;if(G)for(R=[];G;G=G.G)R.push(G);if(p=p.M,G=S.type||S,typeof S=="string")S=new B(S,p);else if(S instanceof B)S.target=S.target||p;else{var ee=S;S=new B(G,p),de(S,ee)}ee=!0;let re,ve;if(R)for(ve=R.length-1;ve>=0;ve--)re=S.g=R[ve],ee=Sn(re,G,!0,S)&&ee;if(re=S.g=p,ee=Sn(re,G,!0,S)&&ee,ee=Sn(re,G,!1,S)&&ee,R)for(ve=0;ve<R.length;ve++)re=S.g=R[ve],ee=Sn(re,G,!1,S)&&ee}Mt.prototype.N=function(){if(Mt.Z.N.call(this),this.i){var p=this.i;for(const S in p.g){const R=p.g[S];for(let G=0;G<R.length;G++)Q(R[G]);delete p.g[S],p.h--}}this.G=null},Mt.prototype.J=function(p,S,R,G){return this.i.add(String(p),S,!1,R,G)},Mt.prototype.K=function(p,S,R,G){return this.i.add(String(p),S,!0,R,G)};function Sn(p,S,R,G){if(S=p.i.g[String(S)],!S)return!0;S=S.concat();let ee=!0;for(let re=0;re<S.length;++re){const ve=S[re];if(ve&&!ve.da&&ve.capture==R){const Xe=ve.listener,nn=ve.ha||ve.src;ve.fa&&fe(p.i,ve),ee=Xe.call(nn,G)!==!1&&ee}}return ee&&!G.defaultPrevented}function lr(p,S){if(typeof p!="function")if(p&&typeof p.handleEvent=="function")p=h(p.handleEvent,p);else throw Error("Invalid listener argument");return Number(S)>2147483647?-1:o.setTimeout(p,S||0)}function Gt(p){p.g=lr(()=>{p.g=null,p.i&&(p.i=!1,Gt(p))},p.l);const S=p.h;p.h=null,p.m.apply(null,S)}class Oo extends U{constructor(S,R){super(),this.m=S,this.l=R,this.h=null,this.i=!1,this.g=null}j(S){this.h=arguments,this.g?this.i=!0:Gt(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function cr(p){U.call(this),this.h=p,this.g={}}g(cr,U);var ts=[];function Lr(p){ce(p.g,function(S,R){this.g.hasOwnProperty(R)&&bn(S)},p),p.g={}}cr.prototype.N=function(){cr.Z.N.call(this),Lr(this)},cr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ns=o.JSON.stringify,il=o.JSON.parse,is=class{stringify(p){return o.JSON.stringify(p,void 0)}parse(p){return o.JSON.parse(p,void 0)}};function ur(){}function Gc(){}var rs={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function zs(){B.call(this,"d")}g(zs,B);function Do(){B.call(this,"c")}g(Do,B);var hi={},$s=null;function ss(){return $s=$s||new Mt}hi.Ia="serverreachability";function os(p){B.call(this,hi.Ia,p)}g(os,B);function di(p){const S=ss();vt(S,new os(S))}hi.STAT_EVENT="statevent";function fi(p,S){B.call(this,hi.STAT_EVENT,p),this.stat=S}g(fi,B);function Tt(p){const S=ss();vt(S,new fi(S,p))}hi.Ja="timingevent";function Vo(p,S){B.call(this,hi.Ja,p),this.size=S}g(Vo,B);function Nr(p,S){if(typeof p!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){p()},S)}function en(){this.g=!0}en.prototype.ua=function(){this.g=!1};function hr(p,S,R,G,ee,re){p.info(function(){if(p.g)if(re){var ve="",Xe=re.split("&");for(let Et=0;Et<Xe.length;Et++){var nn=Xe[Et].split("=");if(nn.length>1){const un=nn[0];nn=nn[1];const Ki=un.split("_");ve=Ki.length>=2&&Ki[1]=="type"?ve+(un+"="+nn+"&"):ve+(un+"=redacted&")}}}else ve=null;else ve=re;return"XMLHTTP REQ ("+G+") [attempt "+ee+"]: "+S+`
`+R+`
`+ve})}function Nn(p,S,R,G,ee,re,ve){p.info(function(){return"XMLHTTP RESP ("+G+") [ attempt "+ee+"]: "+S+`
`+R+`
`+re+" "+ve})}function tn(p,S,R,G){p.info(function(){return"XMLHTTP TEXT ("+S+"): "+Dn(p,R)+(G?" "+G:"")})}function On(p,S){p.info(function(){return"TIMEOUT: "+S})}en.prototype.info=function(){};function Dn(p,S){if(!p.g)return S;if(!S)return null;try{const re=JSON.parse(S);if(re){for(p=0;p<re.length;p++)if(Array.isArray(re[p])){var R=re[p];if(!(R.length<2)){var G=R[1];if(Array.isArray(G)&&!(G.length<1)){var ee=G[0];if(ee!="noop"&&ee!="stop"&&ee!="close")for(let ve=1;ve<G.length;ve++)G[ve]=""}}}}return ns(re)}catch{return S}}var In={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},dt={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},cn;function mn(){}g(mn,ur),mn.prototype.g=function(){return new XMLHttpRequest},cn=new mn;function dr(p){return encodeURIComponent(String(p))}function jc(p){var S=1;p=p.split(":");const R=[];for(;S>0&&p.length;)R.push(p.shift()),S--;return p.length&&R.push(p.join(":")),R}function fr(p,S,R,G){this.j=p,this.i=S,this.l=R,this.S=G||1,this.V=new cr(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new mm}function mm(){this.i=null,this.g="",this.h=!1}var pm={},Zh={};function Or(p,S,R){p.M=1,p.A=Hs(gr(S)),p.u=R,p.R=!0,Jh(p,null)}function Jh(p,S){p.F=Date.now(),rl(p),p.B=gr(p.A);var R=p.B,G=p.S;Array.isArray(G)||(G=[String(G)]),cd(R.i,"t",G),p.C=0,R=p.j.L,p.h=new mm,p.g=Rm(p.j,R?S:null,!p.u),p.P>0&&(p.O=new Oo(h(p.Y,p,p.g),p.P)),S=p.V,R=p.g,G=p.ba;var ee="readystatechange";Array.isArray(ee)||(ee&&(ts[0]=ee.toString()),ee=ts);for(let re=0;re<ee.length;re++){const ve=Pe(R,ee[re],G||S.handleEvent,!1,S.h||S);if(!ve)break;S.g[ve.key]=ve}S=p.J?V(p.J):{},p.u?(p.v||(p.v="POST"),S["Content-Type"]="application/x-www-form-urlencoded",p.g.ea(p.B,p.v,p.u,S)):(p.v="GET",p.g.ea(p.B,p.v,null,S)),di(),hr(p.i,p.v,p.B,p.l,p.S,p.u)}fr.prototype.ba=function(p){p=p.target;const S=this.O;S&&fs(p)==3?S.j():this.Y(p)},fr.prototype.Y=function(p){try{if(p==this.g)e:{const Xe=fs(this.g),nn=this.g.ya(),Et=this.g.ca();if(!(Xe<3)&&(Xe!=3||this.g&&(this.h.h||this.g.la()||Im(this.g)))){this.K||Xe!=4||nn==7||(nn==8||Et<=0?di(3):di(2)),Uc(this);var S=this.g.ca();this.X=S;var R=_m(this);if(this.o=S==200,Nn(this.i,this.v,this.B,this.l,this.S,Xe,S),this.o){if(this.U&&!this.L){t:{if(this.g){var G,ee=this.g;if((G=ee.g?ee.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!O(G)){var re=G;break t}}re=null}if(p=re)tn(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,kt(this,p);else{this.o=!1,this.m=3,Tt(12),Ws(this),sl(this);break e}}if(this.R){p=!0;let un;for(;!this.K&&this.C<R.length;)if(un=vm(this,R),un==Zh){Xe==4&&(this.m=4,Tt(14),p=!1),tn(this.i,this.l,null,"[Incomplete Response]");break}else if(un==pm){this.m=4,Tt(15),tn(this.i,this.l,R,"[Invalid Chunk]"),p=!1;break}else tn(this.i,this.l,un,null),kt(this,un);if(ym(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Xe!=4||R.length!=0||this.h.h||(this.m=1,Tt(16),p=!1),this.o=this.o&&p,!p)tn(this.i,this.l,R,"[Invalid Chunked Response]"),Ws(this),sl(this);else if(R.length>0&&!this.W){this.W=!0;var ve=this.j;ve.g==this&&ve.aa&&!ve.P&&(ve.j.info("Great, no buffering proxy detected. Bytes received: "+R.length),gl(ve),ve.P=!0,Tt(11))}}else tn(this.i,this.l,R,null),kt(this,R);Xe==4&&Ws(this),this.o&&!this.K&&(Xe==4?Qc(this.j,this):(this.o=!1,rl(this)))}else hd(this.g),S==400&&R.indexOf("Unknown SID")>0?(this.m=3,Tt(12)):(this.m=0,Tt(13)),Ws(this),sl(this)}}}catch{}};function _m(p){if(!ym(p))return p.g.la();const S=Im(p.g);if(S==="")return"";let R="";const G=S.length,ee=fs(p.g)==4;if(!p.h.i){if(typeof TextDecoder>"u")return Ws(p),sl(p),"";p.h.i=new o.TextDecoder}for(let re=0;re<G;re++)p.h.h=!0,R+=p.h.i.decode(S[re],{stream:!(ee&&re==G-1)});return S.length=0,p.h.g+=R,p.C=0,p.h.g}function ym(p){return p.g?p.v=="GET"&&p.M!=2&&p.j.Aa:!1}function vm(p,S){var R=p.C,G=S.indexOf(`
`,R);return G==-1?Zh:(R=Number(S.substring(R,G)),isNaN(R)?pm:(G+=1,G+R>S.length?Zh:(S=S.slice(G,G+R),p.C=G+R,S)))}fr.prototype.cancel=function(){this.K=!0,Ws(this)};function rl(p){p.T=Date.now()+p.H,ed(p,p.H)}function ed(p,S){if(p.D!=null)throw Error("WatchDog timer not null");p.D=Nr(h(p.aa,p),S)}function Uc(p){p.D&&(o.clearTimeout(p.D),p.D=null)}fr.prototype.aa=function(){this.D=null;const p=Date.now();p-this.T>=0?(On(this.i,this.B),this.M!=2&&(di(),Tt(17)),Ws(this),this.m=2,sl(this)):ed(this,this.T-p)};function sl(p){p.j.I==0||p.K||Qc(p.j,p)}function Ws(p){Uc(p);var S=p.O;S&&typeof S.dispose=="function"&&S.dispose(),p.O=null,Lr(p.V),p.g&&(S=p.g,p.g=null,S.abort(),S.dispose())}function kt(p,S){try{var R=p.j;if(R.I!=0&&(R.g==p||nd(R.h,p))){if(!p.L&&nd(R.h,p)&&R.I==3){try{var G=R.Ba.g.parse(S)}catch{G=null}if(Array.isArray(G)&&G.length==3){var ee=G;if(ee[0]==0){e:if(!R.v){if(R.g)if(R.g.F+3e3<p.F)Xc(R),Wi(R);else break e;ps(R),Tt(18)}}else R.xa=ee[1],0<R.xa-R.K&&ee[2]<37500&&R.F&&R.A==0&&!R.C&&(R.C=Nr(h(R.Va,R),6e3));ol(R.h)<=1&&R.ta&&(R.ta=void 0)}else Hi(R,11)}else if((p.L||R.g==p)&&Xc(R),!O(S))for(ee=R.Ba.g.parse(S),S=0;S<ee.length;S++){let Et=ee[S];const un=Et[0];if(!(un<=R.K))if(R.K=un,Et=Et[1],R.I==2)if(Et[0]=="c"){R.M=Et[1],R.ba=Et[2];const Ki=Et[3];Ki!=null&&(R.ka=Ki,R.j.info("VER="+R.ka));const Qs=Et[4];Qs!=null&&(R.za=Qs,R.j.info("SVER="+R.za));const _s=Et[5];_s!=null&&typeof _s=="number"&&_s>0&&(G=1.5*_s,R.O=G,R.j.info("backChannelRequestTimeoutMs_="+G)),G=R;const ys=p.g;if(ys){const eu=ys.g?ys.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(eu){var re=G.h;re.g||eu.indexOf("spdy")==-1&&eu.indexOf("quic")==-1&&eu.indexOf("h2")==-1||(re.j=re.l,re.g=new Set,re.h&&(zc(re,re.h),re.h=null))}if(G.G){const gd=ys.g?ys.g.getResponseHeader("X-HTTP-Session-Id"):null;gd&&(G.wa=gd,ft(G.J,G.G,gd))}}R.I=3,R.l&&R.l.ra(),R.aa&&(R.T=Date.now()-p.F,R.j.info("Handshake RTT: "+R.T+"ms")),G=R;var ve=p;if(G.na=fd(G,G.L?G.ba:null,G.W),ve.L){al(G.h,ve);var Xe=ve,nn=G.O;nn&&(Xe.H=nn),Xe.D&&(Uc(Xe),rl(Xe)),G.g=ve}else qn(G);R.i.length>0&&Xs(R)}else Et[0]!="stop"&&Et[0]!="close"||Hi(R,7);else R.I==3&&(Et[0]=="stop"||Et[0]=="close"?Et[0]=="stop"?Hi(R,7):qc(R):Et[0]!="noop"&&R.l&&R.l.qa(Et),R.A=0)}}di(4)}catch{}}var Fy=class{constructor(p,S){this.g=p,this.map=S}};function Bc(p){this.l=p||10,o.PerformanceNavigationTiming?(p=o.performance.getEntriesByType("navigation"),p=p.length>0&&(p[0].nextHopProtocol=="hq"||p[0].nextHopProtocol=="h2")):p=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=p?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function td(p){return p.h?!0:p.g?p.g.size>=p.j:!1}function ol(p){return p.h?1:p.g?p.g.size:0}function nd(p,S){return p.h?p.h==S:p.g?p.g.has(S):!1}function zc(p,S){p.g?p.g.add(S):p.h=S}function al(p,S){p.h&&p.h==S?p.h=null:p.g&&p.g.has(S)&&p.g.delete(S)}Bc.prototype.cancel=function(){if(this.i=Bi(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const p of this.g.values())p.cancel();this.g.clear()}};function Bi(p){if(p.h!=null)return p.i.concat(p.h.G);if(p.g!=null&&p.g.size!==0){let S=p.i;for(const R of p.g.values())S=S.concat(R.G);return S}return y(p.i)}var Em=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function zi(p,S){if(p){p=p.split("&");for(let R=0;R<p.length;R++){const G=p[R].indexOf("=");let ee,re=null;G>=0?(ee=p[R].substring(0,G),re=p[R].substring(G+1)):ee=p[R],S(ee,re?decodeURIComponent(re.replace(/\+/g," ")):"")}}}function as(p){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let S;p instanceof as?(this.l=p.l,ll(this,p.j),this.o=p.o,this.g=p.g,ls(this,p.u),this.h=p.h,Fo(this,ud(p.i)),this.m=p.m):p&&(S=String(p).match(Em))?(this.l=!1,ll(this,S[1]||"",!0),this.o=cl(S[2]||""),this.g=cl(S[3]||"",!0),ls(this,S[4]),this.h=cl(S[5]||"",!0),Fo(this,S[6]||"",!0),this.m=cl(S[7]||"")):(this.l=!1,this.i=new rt(null,this.l))}as.prototype.toString=function(){const p=[];var S=this.j;S&&p.push(ul(S,rd,!0),":");var R=this.g;return(R||S=="file")&&(p.push("//"),(S=this.o)&&p.push(ul(S,rd,!0),"@"),p.push(dr(R).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),R=this.u,R!=null&&p.push(":",String(R))),(R=this.h)&&(this.g&&R.charAt(0)!="/"&&p.push("/"),p.push(ul(R,R.charAt(0)=="/"?hl:sd,!0))),(R=this.i.toString())&&p.push("?",R),(R=this.m)&&p.push("#",ul(R,od)),p.join("")},as.prototype.resolve=function(p){const S=gr(this);let R=!!p.j;R?ll(S,p.j):R=!!p.o,R?S.o=p.o:R=!!p.g,R?S.g=p.g:R=p.u!=null;var G=p.h;if(R)ls(S,p.u);else if(R=!!p.h){if(G.charAt(0)!="/")if(this.g&&!this.h)G="/"+G;else{var ee=S.h.lastIndexOf("/");ee!=-1&&(G=S.h.slice(0,ee+1)+G)}if(ee=G,ee==".."||ee==".")G="";else if(ee.indexOf("./")!=-1||ee.indexOf("/.")!=-1){G=ee.lastIndexOf("/",0)==0,ee=ee.split("/");const re=[];for(let ve=0;ve<ee.length;){const Xe=ee[ve++];Xe=="."?G&&ve==ee.length&&re.push(""):Xe==".."?((re.length>1||re.length==1&&re[0]!="")&&re.pop(),G&&ve==ee.length&&re.push("")):(re.push(Xe),G=!0)}G=re.join("/")}else G=ee}return R?S.h=G:R=p.i.toString()!=="",R?Fo(S,ud(p.i)):R=!!p.m,R&&(S.m=p.m),S};function gr(p){return new as(p)}function ll(p,S,R){p.j=R?cl(S,!0):S,p.j&&(p.j=p.j.replace(/:$/,""))}function ls(p,S){if(S){if(S=Number(S),isNaN(S)||S<0)throw Error("Bad port number "+S);p.u=S}else p.u=null}function Fo(p,S,R){S instanceof rt?(p.i=S,Wc(p.i,p.l)):(R||(S=ul(S,Gy)),p.i=new rt(S,p.l))}function ft(p,S,R){p.i.set(S,R)}function Hs(p){return ft(p,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),p}function cl(p,S){return p?S?decodeURI(p.replace(/%25/g,"%2525")):decodeURIComponent(p):""}function ul(p,S,R){return typeof p=="string"?(p=encodeURI(p).replace(S,id),R&&(p=p.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p):null}function id(p){return p=p.charCodeAt(0),"%"+(p>>4&15).toString(16)+(p&15).toString(16)}var rd=/[#\/\?@]/g,sd=/[#\?:]/g,hl=/[#\?]/g,Gy=/[#\?@]/g,od=/#/g;function rt(p,S){this.h=this.g=null,this.i=p||null,this.j=!!S}function cs(p){p.g||(p.g=new Map,p.h=0,p.i&&zi(p.i,function(S,R){p.add(decodeURIComponent(S.replace(/\+/g," ")),R)}))}n=rt.prototype,n.add=function(p,S){cs(this),this.i=null,p=us(this,p);let R=this.g.get(p);return R||this.g.set(p,R=[]),R.push(S),this.h+=1,this};function ad(p,S){cs(p),S=us(p,S),p.g.has(S)&&(p.i=null,p.h-=p.g.get(S).length,p.g.delete(S))}function $c(p,S){return cs(p),S=us(p,S),p.g.has(S)}n.forEach=function(p,S){cs(this),this.g.forEach(function(R,G){R.forEach(function(ee){p.call(S,ee,G,this)},this)},this)};function ld(p,S){cs(p);let R=[];if(typeof S=="string")$c(p,S)&&(R=R.concat(p.g.get(us(p,S))));else for(p=Array.from(p.g.values()),S=0;S<p.length;S++)R=R.concat(p[S]);return R}n.set=function(p,S){return cs(this),this.i=null,p=us(this,p),$c(this,p)&&(this.h-=this.g.get(p).length),this.g.set(p,[S]),this.h+=1,this},n.get=function(p,S){return p?(p=ld(this,p),p.length>0?String(p[0]):S):S};function cd(p,S,R){ad(p,S),R.length>0&&(p.i=null,p.g.set(us(p,S),y(R)),p.h+=R.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const p=[],S=Array.from(this.g.keys());for(let G=0;G<S.length;G++){var R=S[G];const ee=dr(R);R=ld(this,R);for(let re=0;re<R.length;re++){let ve=ee;R[re]!==""&&(ve+="="+dr(R[re])),p.push(ve)}}return this.i=p.join("&")};function ud(p){const S=new rt;return S.i=p.i,p.g&&(S.g=new Map(p.g),S.h=p.h),S}function us(p,S){return S=String(S),p.j&&(S=S.toLowerCase()),S}function Wc(p,S){S&&!p.j&&(cs(p),p.i=null,p.g.forEach(function(R,G){const ee=G.toLowerCase();G!=ee&&(ad(this,G),cd(this,ee,R))},p)),p.j=S}function hs(p,S){const R=new en;if(o.Image){const G=new Image;G.onload=d(Vn,R,"TestLoadImage: loaded",!0,S,G),G.onerror=d(Vn,R,"TestLoadImage: error",!1,S,G),G.onabort=d(Vn,R,"TestLoadImage: abort",!1,S,G),G.ontimeout=d(Vn,R,"TestLoadImage: timeout",!1,S,G),o.setTimeout(function(){G.ontimeout&&G.ontimeout()},1e4),G.src=p}else S(!1)}function ds(p,S){const R=new en,G=new AbortController,ee=setTimeout(()=>{G.abort(),Vn(R,"TestPingServer: timeout",!1,S)},1e4);fetch(p,{signal:G.signal}).then(re=>{clearTimeout(ee),re.ok?Vn(R,"TestPingServer: ok",!0,S):Vn(R,"TestPingServer: server error",!1,S)}).catch(()=>{clearTimeout(ee),Vn(R,"TestPingServer: error",!1,S)})}function Vn(p,S,R,G,ee){try{ee&&(ee.onload=null,ee.onerror=null,ee.onabort=null,ee.ontimeout=null),G(R)}catch{}}function dl(){this.g=new is}function Ks(p){this.i=p.Sb||null,this.h=p.ab||!1}g(Ks,ur),Ks.prototype.g=function(){return new $i(this.i,this.h)};function $i(p,S){Mt.call(this),this.H=p,this.o=S,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}g($i,Mt),n=$i.prototype,n.open=function(p,S){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=p,this.D=S,this.readyState=1,Dr(this)},n.send=function(p){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const S={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};p&&(S.body=p),(this.H||o).fetch(new Request(this.D,S)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Go(this)),this.readyState=0},n.Pa=function(p){if(this.g&&(this.l=p,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=p.headers,this.readyState=2,Dr(this)),this.g&&(this.readyState=3,Dr(this),this.g)))if(this.responseType==="arraybuffer")p.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in p){if(this.j=p.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;wm(this)}else p.text().then(this.Oa.bind(this),this.ga.bind(this))};function wm(p){p.j.read().then(p.Ma.bind(p)).catch(p.ga.bind(p))}n.Ma=function(p){if(this.g){if(this.o&&p.value)this.response.push(p.value);else if(!this.o){var S=p.value?p.value:new Uint8Array(0);(S=this.B.decode(S,{stream:!p.done}))&&(this.response=this.responseText+=S)}p.done?Go(this):Dr(this),this.readyState==3&&wm(this)}},n.Oa=function(p){this.g&&(this.response=this.responseText=p,Go(this))},n.Na=function(p){this.g&&(this.response=p,Go(this))},n.ga=function(){this.g&&Go(this)};function Go(p){p.readyState=4,p.l=null,p.j=null,p.B=null,Dr(p)}n.setRequestHeader=function(p,S){this.A.append(p,S)},n.getResponseHeader=function(p){return this.h&&this.h.get(p.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const p=[],S=this.h.entries();for(var R=S.next();!R.done;)R=R.value,p.push(R[0]+": "+R[1]),R=S.next();return p.join(`\r
`)};function Dr(p){p.onreadystatechange&&p.onreadystatechange.call(p)}Object.defineProperty($i.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(p){this.m=p?"include":"same-origin"}});function xm(p){let S="";return ce(p,function(R,G){S+=G,S+=":",S+=R,S+=`\r
`}),S}function Hc(p,S,R){e:{for(G in R){var G=!1;break e}G=!0}G||(R=xm(R),typeof p=="string"?R!=null&&dr(R):ft(p,S,R))}function At(p){Mt.call(this),this.headers=new Map,this.L=p||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}g(At,Mt);var Sm=/^https?$/i,jy=["POST","PUT"];n=At.prototype,n.Fa=function(p){this.H=p},n.ea=function(p,S,R,G){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+p);S=S?S.toUpperCase():"GET",this.D=p,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():cn.g(),this.g.onreadystatechange=m(h(this.Ca,this));try{this.B=!0,this.g.open(S,String(p),!0),this.B=!1}catch(re){jo(this,re);return}if(p=R||"",R=new Map(this.headers),G)if(Object.getPrototypeOf(G)===Object.prototype)for(var ee in G)R.set(ee,G[ee]);else if(typeof G.keys=="function"&&typeof G.get=="function")for(const re of G.keys())R.set(re,G.get(re));else throw Error("Unknown input type for opt_headers: "+String(G));G=Array.from(R.keys()).find(re=>re.toLowerCase()=="content-type"),ee=o.FormData&&p instanceof o.FormData,!(Array.prototype.indexOf.call(jy,S,void 0)>=0)||G||ee||R.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[re,ve]of R)this.g.setRequestHeader(re,ve);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(p),this.v=!1}catch(re){jo(this,re)}};function jo(p,S){p.h=!1,p.g&&(p.j=!0,p.g.abort(),p.j=!1),p.l=S,p.o=5,Uo(p),Ys(p)}function Uo(p){p.A||(p.A=!0,vt(p,"complete"),vt(p,"error"))}n.abort=function(p){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=p||7,vt(this,"complete"),vt(this,"abort"),Ys(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ys(this,!0)),At.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?qs(this):this.Xa())},n.Xa=function(){qs(this)};function qs(p){if(p.h&&typeof s<"u"){if(p.v&&fs(p)==4)setTimeout(p.Ca.bind(p),0);else if(vt(p,"readystatechange"),fs(p)==4){p.h=!1;try{const re=p.ca();e:switch(re){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var S=!0;break e;default:S=!1}var R;if(!(R=S)){var G;if(G=re===0){let ve=String(p.D).match(Em)[1]||null;!ve&&o.self&&o.self.location&&(ve=o.self.location.protocol.slice(0,-1)),G=!Sm.test(ve?ve.toLowerCase():"")}R=G}if(R)vt(p,"complete"),vt(p,"success");else{p.o=6;try{var ee=fs(p)>2?p.g.statusText:""}catch{ee=""}p.l=ee+" ["+p.ca()+"]",Uo(p)}}finally{Ys(p)}}}}function Ys(p,S){if(p.g){p.m&&(clearTimeout(p.m),p.m=null);const R=p.g;p.g=null,S||vt(p,"ready");try{R.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function fs(p){return p.g?p.g.readyState:0}n.ca=function(){try{return fs(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(p){if(this.g){var S=this.g.responseText;return p&&S.indexOf(p)==0&&(S=S.substring(p.length)),il(S)}};function Im(p){try{if(!p.g)return null;if("response"in p.g)return p.g.response;switch(p.F){case"":case"text":return p.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in p.g)return p.g.mozResponseArrayBuffer}return null}catch{return null}}function hd(p){const S={};p=(p.g&&fs(p)>=2&&p.g.getAllResponseHeaders()||"").split(`\r
`);for(let G=0;G<p.length;G++){if(O(p[G]))continue;var R=jc(p[G]);const ee=R[0];if(R=R[1],typeof R!="string")continue;R=R.trim();const re=S[ee]||[];S[ee]=re,re.push(R)}K(S,function(G){return G.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function gs(p,S,R){return R&&R.internalChannelParams&&R.internalChannelParams[p]||S}function Kc(p){this.za=0,this.i=[],this.j=new en,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=gs("failFast",!1,p),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=gs("baseRetryDelayMs",5e3,p),this.Za=gs("retryDelaySeedMs",1e4,p),this.Ta=gs("forwardChannelMaxRetries",2,p),this.va=gs("forwardChannelRequestTimeoutMs",2e4,p),this.ma=p&&p.xmlHttpFactory||void 0,this.Ua=p&&p.Rb||void 0,this.Aa=p&&p.useFetchStreams||!1,this.O=void 0,this.L=p&&p.supportsCrossDomainXhr||!1,this.M="",this.h=new Bc(p&&p.concurrentRequestLimit),this.Ba=new dl,this.S=p&&p.fastHandshake||!1,this.R=p&&p.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=p&&p.Pb||!1,p&&p.ua&&this.j.ua(),p&&p.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&p&&p.detectBufferingProxy||!1,this.ia=void 0,p&&p.longPollingTimeout&&p.longPollingTimeout>0&&(this.ia=p.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Kc.prototype,n.ka=8,n.I=1,n.connect=function(p,S,R,G){Tt(0),this.W=p,this.H=S||{},R&&G!==void 0&&(this.H.OSID=R,this.H.OAID=G),this.F=this.X,this.J=fd(this,null,this.W),Xs(this)};function qc(p){if(Yc(p),p.I==3){var S=p.V++,R=gr(p.J);if(ft(R,"SID",p.M),ft(R,"RID",S),ft(R,"TYPE","terminate"),ms(p,R),S=new fr(p,p.j,S),S.M=2,S.A=Hs(gr(R)),R=!1,o.navigator&&o.navigator.sendBeacon)try{R=o.navigator.sendBeacon(S.A.toString(),"")}catch{}!R&&o.Image&&(new Image().src=S.A,R=!0),R||(S.g=Rm(S.j,null),S.g.ea(S.A)),S.F=Date.now(),rl(S)}ml(p)}function Wi(p){p.g&&(gl(p),p.g.cancel(),p.g=null)}function Yc(p){Wi(p),p.v&&(o.clearTimeout(p.v),p.v=null),Xc(p),p.h.cancel(),p.m&&(typeof p.m=="number"&&o.clearTimeout(p.m),p.m=null)}function Xs(p){if(!td(p.h)&&!p.m){p.m=!0;var S=p.Ea;j||A(),W||(j(),W=!0),L.add(S,p),p.D=0}}function Tm(p,S){return ol(p.h)>=p.h.j-(p.m?1:0)?!1:p.m?(p.i=S.G.concat(p.i),!0):p.I==1||p.I==2||p.D>=(p.Sa?0:p.Ta)?!1:(p.m=Nr(h(p.Ea,p,S),Zc(p,p.D)),p.D++,!0)}n.Ea=function(p){if(this.m)if(this.m=null,this.I==1){if(!p){this.V=Math.floor(Math.random()*1e5),p=this.V++;const ee=new fr(this,this.j,p);let re=this.o;if(this.U&&(re?(re=V(re),de(re,this.U)):re=this.U),this.u!==null||this.R||(ee.J=re,re=null),this.S)e:{for(var S=0,R=0;R<this.i.length;R++){t:{var G=this.i[R];if("__data__"in G.map&&(G=G.map.__data__,typeof G=="string")){G=G.length;break t}G=void 0}if(G===void 0)break;if(S+=G,S>4096){S=R;break e}if(S===4096||R===this.i.length-1){S=R+1;break e}}S=1e3}else S=1e3;S=dd(this,ee,S),R=gr(this.J),ft(R,"RID",p),ft(R,"CVER",22),this.G&&ft(R,"X-HTTP-Session-Id",this.G),ms(this,R),re&&(this.R?S="headers="+dr(xm(re))+"&"+S:this.u&&Hc(R,this.u,re)),zc(this.h,ee),this.Ra&&ft(R,"TYPE","init"),this.S?(ft(R,"$req",S),ft(R,"SID","null"),ee.U=!0,Or(ee,R,null)):Or(ee,R,S),this.I=2}}else this.I==3&&(p?fl(this,p):this.i.length==0||td(this.h)||fl(this))};function fl(p,S){var R;S?R=S.l:R=p.V++;const G=gr(p.J);ft(G,"SID",p.M),ft(G,"RID",R),ft(G,"AID",p.K),ms(p,G),p.u&&p.o&&Hc(G,p.u,p.o),R=new fr(p,p.j,R,p.D+1),p.u===null&&(R.J=p.o),S&&(p.i=S.G.concat(p.i)),S=dd(p,R,1e3),R.H=Math.round(p.va*.5)+Math.round(p.va*.5*Math.random()),zc(p.h,R),Or(R,G,S)}function ms(p,S){p.H&&ce(p.H,function(R,G){ft(S,G,R)}),p.l&&ce({},function(R,G){ft(S,G,R)})}function dd(p,S,R){R=Math.min(p.i.length,R);const G=p.l?h(p.l.Ka,p.l,p):null;e:{var ee=p.i;let Xe=-1;for(;;){const nn=["count="+R];Xe==-1?R>0?(Xe=ee[0].g,nn.push("ofs="+Xe)):Xe=0:nn.push("ofs="+Xe);let Et=!0;for(let un=0;un<R;un++){var re=ee[un].g;const Ki=ee[un].map;if(re-=Xe,re<0)Xe=Math.max(0,ee[un].g-100),Et=!1;else try{re="req"+re+"_"||"";try{var ve=Ki instanceof Map?Ki:Object.entries(Ki);for(const[Qs,_s]of ve){let ys=_s;a(_s)&&(ys=ns(_s)),nn.push(re+Qs+"="+encodeURIComponent(ys))}}catch(Qs){throw nn.push(re+"type="+encodeURIComponent("_badmap")),Qs}}catch{G&&G(Ki)}}if(Et){ve=nn.join("&");break e}}ve=void 0}return p=p.i.splice(0,R),S.G=p,ve}function qn(p){if(!p.g&&!p.v){p.Y=1;var S=p.Da;j||A(),W||(j(),W=!0),L.add(S,p),p.A=0}}function ps(p){return p.g||p.v||p.A>=3?!1:(p.Y++,p.v=Nr(h(p.Da,p),Zc(p,p.A)),p.A++,!0)}n.Da=function(){if(this.v=null,Bo(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var p=4*this.T;this.j.info("BP detection timer enabled: "+p),this.B=Nr(h(this.Wa,this),p)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Tt(10),Wi(this),Bo(this))};function gl(p){p.B!=null&&(o.clearTimeout(p.B),p.B=null)}function Bo(p){p.g=new fr(p,p.j,"rpc",p.Y),p.u===null&&(p.g.J=p.o),p.g.P=0;var S=gr(p.na);ft(S,"RID","rpc"),ft(S,"SID",p.M),ft(S,"AID",p.K),ft(S,"CI",p.F?"0":"1"),!p.F&&p.ia&&ft(S,"TO",p.ia),ft(S,"TYPE","xmlhttp"),ms(p,S),p.u&&p.o&&Hc(S,p.u,p.o),p.O&&(p.g.H=p.O);var R=p.g;p=p.ba,R.M=1,R.A=Hs(gr(S)),R.u=null,R.R=!0,Jh(R,p)}n.Va=function(){this.C!=null&&(this.C=null,Wi(this),ps(this),Tt(19))};function Xc(p){p.C!=null&&(o.clearTimeout(p.C),p.C=null)}function Qc(p,S){var R=null;if(p.g==S){Xc(p),gl(p),p.g=null;var G=2}else if(nd(p.h,S))R=S.G,al(p.h,S),G=1;else return;if(p.I!=0){if(S.o)if(G==1){R=S.u?S.u.length:0,S=Date.now()-S.F;var ee=p.D;G=ss(),vt(G,new Vo(G,R)),Xs(p)}else qn(p);else if(ee=S.m,ee==3||ee==0&&S.X>0||!(G==1&&Tm(p,S)||G==2&&ps(p)))switch(R&&R.length>0&&(S=p.h,S.i=S.i.concat(R)),ee){case 1:Hi(p,5);break;case 4:Hi(p,10);break;case 3:Hi(p,6);break;default:Hi(p,2)}}}function Zc(p,S){let R=p.Qa+Math.floor(Math.random()*p.Za);return p.isActive()||(R*=2),R*S}function Hi(p,S){if(p.j.info("Error code "+S),S==2){var R=h(p.bb,p),G=p.Ua;const ee=!G;G=new as(G||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||ll(G,"https"),Hs(G),ee?hs(G.toString(),R):ds(G.toString(),R)}else Tt(2);p.I=0,p.l&&p.l.pa(S),ml(p),Yc(p)}n.bb=function(p){p?(this.j.info("Successfully pinged google.com"),Tt(2)):(this.j.info("Failed to ping google.com"),Tt(1))};function ml(p){if(p.I=0,p.ja=[],p.l){const S=Bi(p.h);(S.length!=0||p.i.length!=0)&&(w(p.ja,S),w(p.ja,p.i),p.h.i.length=0,y(p.i),p.i.length=0),p.l.oa()}}function fd(p,S,R){var G=R instanceof as?gr(R):new as(R);if(G.g!="")S&&(G.g=S+"."+G.g),ls(G,G.u);else{var ee=o.location;G=ee.protocol,S=S?S+"."+ee.hostname:ee.hostname,ee=+ee.port;const re=new as(null);G&&ll(re,G),S&&(re.g=S),ee&&ls(re,ee),R&&(re.h=R),G=re}return R=p.G,S=p.wa,R&&S&&ft(G,R,S),ft(G,"VER",p.ka),ms(p,G),G}function Rm(p,S,R){if(S&&!p.L)throw Error("Can't create secondary domain capable XhrIo object.");return S=p.Aa&&!p.ma?new At(new Ks({ab:R})):new At(p.ma),S.Fa(p.L),S}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Pm(){}n=Pm.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Jc(){}Jc.prototype.g=function(p,S){return new Fn(p,S)};function Fn(p,S){Mt.call(this),this.g=new Kc(S),this.l=p,this.h=S&&S.messageUrlParams||null,p=S&&S.messageHeaders||null,S&&S.clientProtocolHeaderRequired&&(p?p["X-Client-Protocol"]="webchannel":p={"X-Client-Protocol":"webchannel"}),this.g.o=p,p=S&&S.initMessageHeaders||null,S&&S.messageContentType&&(p?p["X-WebChannel-Content-Type"]=S.messageContentType:p={"X-WebChannel-Content-Type":S.messageContentType}),S&&S.sa&&(p?p["X-WebChannel-Client-Profile"]=S.sa:p={"X-WebChannel-Client-Profile":S.sa}),this.g.U=p,(p=S&&S.Qb)&&!O(p)&&(this.g.u=p),this.A=S&&S.supportsCrossDomainXhr||!1,this.v=S&&S.sendRawJson||!1,(S=S&&S.httpSessionIdParam)&&!O(S)&&(this.g.G=S,p=this.h,p!==null&&S in p&&(p=this.h,S in p&&delete p[S])),this.j=new zo(this)}g(Fn,Mt),Fn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Fn.prototype.close=function(){qc(this.g)},Fn.prototype.o=function(p){var S=this.g;if(typeof p=="string"){var R={};R.__data__=p,p=R}else this.v&&(R={},R.__data__=ns(p),p=R);S.i.push(new Fy(S.Ya++,p)),S.I==3&&Xs(S)},Fn.prototype.N=function(){this.g.l=null,delete this.j,qc(this.g),delete this.g,Fn.Z.N.call(this)};function Am(p){zs.call(this),p.__headers__&&(this.headers=p.__headers__,this.statusCode=p.__status__,delete p.__headers__,delete p.__status__);var S=p.__sm__;if(S){e:{for(const R in S){p=R;break e}p=void 0}(this.i=p)&&(p=this.i,S=S!==null&&p in S?S[p]:void 0),this.data=S}else this.data=p}g(Am,zs);function Cm(){Do.call(this),this.status=1}g(Cm,Do);function zo(p){this.g=p}g(zo,Pm),zo.prototype.ra=function(){vt(this.g,"a")},zo.prototype.qa=function(p){vt(this.g,new Am(p))},zo.prototype.pa=function(p){vt(this.g,new Cm)},zo.prototype.oa=function(){vt(this.g,"b")},Jc.prototype.createWebChannel=Jc.prototype.g,Fn.prototype.send=Fn.prototype.o,Fn.prototype.open=Fn.prototype.m,Fn.prototype.close=Fn.prototype.close,Tk=function(){return new Jc},Ik=function(){return ss()},Sk=hi,nw={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},In.NO_ERROR=0,In.TIMEOUT=8,In.HTTP_ERROR=6,n0=In,dt.COMPLETE="complete",xk=dt,Gc.EventType=rs,rs.OPEN="a",rs.CLOSE="b",rs.ERROR="c",rs.MESSAGE="d",Mt.prototype.listen=Mt.prototype.J,lf=Gc,At.prototype.listenOnce=At.prototype.K,At.prototype.getLastError=At.prototype.Ha,At.prototype.getLastErrorCode=At.prototype.ya,At.prototype.getStatus=At.prototype.ca,At.prototype.getResponseJson=At.prototype.La,At.prototype.getResponseText=At.prototype.la,At.prototype.send=At.prototype.ea,At.prototype.setWithCredentials=At.prototype.Fa,wk=At}).apply(typeof Dp<"u"?Dp:typeof self<"u"?self:typeof window<"u"?window:{});const jP="@firebase/firestore",UP="4.9.3";class $n{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}$n.UNAUTHENTICATED=new $n(null),$n.GOOGLE_CREDENTIALS=new $n("google-credentials-uid"),$n.FIRST_PARTY=new $n("first-party-uid"),$n.MOCK_USER=new $n("mock-user");let zh="12.7.0";const pc=new Qx("@firebase/firestore");function Gu(){return pc.logLevel}function pe(n,...e){if(pc.logLevel<=nt.DEBUG){const t=e.map(eS);pc.debug(`Firestore (${zh}): ${n}`,...t)}}function _i(n,...e){if(pc.logLevel<=nt.ERROR){const t=e.map(eS);pc.error(`Firestore (${zh}): ${n}`,...t)}}function _c(n,...e){if(pc.logLevel<=nt.WARN){const t=e.map(eS);pc.warn(`Firestore (${zh}): ${n}`,...t)}}function eS(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function Me(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,Rk(n,i,t)}function Rk(n,e,t){let i=`FIRESTORE (${zh}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw _i(i),new Error(i)}function Oe(n,e,t,i){let r="Unexpected state";typeof t=="string"?r=t:i=t,n||Rk(e,r,i)}function Ye(n,e){return n}const ae={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class xe extends Us{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class _o{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class Pk{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class N7{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t($n.UNAUTHENTICATED)))}shutdown(){}}class O7{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class D7{constructor(e){this.t=e,this.currentUser=$n.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Oe(this.o===void 0,42304);let i=this.i;const r=c=>this.i!==i?(i=this.i,t(c)):Promise.resolve();let s=new _o;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new _o,e.enqueueRetryable((()=>r(this.currentUser)))};const o=()=>{const c=s;e.enqueueRetryable((async()=>{await c.promise,await r(this.currentUser)}))},a=c=>{pe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((c=>a(c))),setTimeout((()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?a(c):(pe("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new _o)}}),0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(pe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Oe(typeof i.accessToken=="string",31837,{l:i}),new Pk(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Oe(e===null||typeof e=="string",2055,{h:e}),new $n(e)}}class V7{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=$n.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class F7{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new V7(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t($n.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class BP{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class G7{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Yr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Oe(this.o===void 0,3512);const i=s=>{s.error!=null&&pe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,pe("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable((()=>i(s)))};const r=s=>{pe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((s=>r(s))),setTimeout((()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?r(s):pe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new BP(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Oe(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new BP(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function j7(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}class tS{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const r=j7(40);for(let s=0;s<r.length;++s)i.length<20&&r[s]<t&&(i+=e.charAt(r[s]%62))}return i}}function qe(n,e){return n<e?-1:n>e?1:0}function iw(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++){const r=n.charAt(i),s=e.charAt(i);if(r!==s)return Y1(r)===Y1(s)?qe(r,s):Y1(r)?1:-1}return qe(n.length,e.length)}const U7=55296,B7=57343;function Y1(n){const e=n.charCodeAt(0);return e>=U7&&e<=B7}function Sh(n,e,t){return n.length===e.length&&n.every(((i,r)=>t(i,e[r])))}function Ak(n){return n+"\0"}const zP="__name__";class Ss{constructor(e,t,i){t===void 0?t=0:t>e.length&&Me(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&Me(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return Ss.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Ss?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let r=0;r<i;r++){const s=Ss.compareSegments(e.get(r),t.get(r));if(s!==0)return s}return qe(e.length,t.length)}static compareSegments(e,t){const i=Ss.isNumericId(e),r=Ss.isNumericId(t);return i&&!r?-1:!i&&r?1:i&&r?Ss.extractNumericId(e).compare(Ss.extractNumericId(t)):iw(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Oa.fromString(e.substring(4,e.length-2))}}class mt extends Ss{construct(e,t,i){return new mt(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new xe(ae.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((r=>r.length>0)))}return new mt(t)}static emptyPath(){return new mt([])}}const z7=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Kt extends Ss{construct(e,t,i){return new Kt(e,t,i)}static isValidIdentifier(e){return z7.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Kt.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===zP}static keyField(){return new Kt([zP])}static fromServerFormat(e){const t=[];let i="",r=0;const s=()=>{if(i.length===0)throw new xe(ae.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let o=!1;for(;r<e.length;){const a=e[r];if(a==="\\"){if(r+1===e.length)throw new xe(ae.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[r+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new xe(ae.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=c,r+=2}else a==="`"?(o=!o,r++):a!=="."||o?(i+=a,r++):(s(),r++)}if(s(),o)throw new xe(ae.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Kt(t)}static emptyPath(){return new Kt([])}}class Se{constructor(e){this.path=e}static fromPath(e){return new Se(mt.fromString(e))}static fromName(e){return new Se(mt.fromString(e).popFirst(5))}static empty(){return new Se(mt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&mt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return mt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Se(new mt(e.slice()))}}function Ck(n,e,t){if(!t)throw new xe(ae.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function $7(n,e,t,i){if(e===!0&&i===!0)throw new xe(ae.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function $P(n){if(!Se.isDocumentKey(n))throw new xe(ae.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function WP(n){if(Se.isDocumentKey(n))throw new xe(ae.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Mk(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function oy(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Me(12329,{type:typeof n})}function za(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new xe(ae.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=oy(n);throw new xe(ae.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function fn(n,e){const t={typeString:n};return e&&(t.value=e),t}function Kg(n,e){if(!Mk(n))throw new xe(ae.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const r=e[i].typeString,s="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const o=n[i];if(r&&typeof o!==r){t=`JSON field '${i}' must be a ${r}.`;break}if(s!==void 0&&o!==s.value){t=`Expected '${i}' field to equal '${s.value}'`;break}}if(t)throw new xe(ae.INVALID_ARGUMENT,t);return!0}const HP=-62135596800,KP=1e6;class xt{static now(){return xt.fromMillis(Date.now())}static fromDate(e){return xt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*KP);return new xt(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new xe(ae.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new xe(ae.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<HP)throw new xe(ae.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new xe(ae.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/KP}_compareTo(e){return this.seconds===e.seconds?qe(this.nanoseconds,e.nanoseconds):qe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:xt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Kg(e,xt._jsonSchema))return new xt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-HP;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}xt._jsonSchemaVersion="firestore/timestamp/1.0",xt._jsonSchema={type:fn("string",xt._jsonSchemaVersion),seconds:fn("number"),nanoseconds:fn("number")};class De{static fromTimestamp(e){return new De(e)}static min(){return new De(new xt(0,0))}static max(){return new De(new xt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const sg=-1;class Y0{constructor(e,t,i,r){this.indexId=e,this.collectionGroup=t,this.fields=i,this.indexState=r}}function rw(n){return n.fields.find((e=>e.kind===2))}function Dl(n){return n.fields.filter((e=>e.kind!==2))}Y0.UNKNOWN_ID=-1;class i0{constructor(e,t){this.fieldPath=e,this.kind=t}}class og{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new og(0,sr.min())}}function W7(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=De.fromTimestamp(i===1e9?new xt(t+1,0):new xt(t,i));return new sr(r,Se.empty(),e)}function bk(n){return new sr(n.readTime,n.key,sg)}class sr{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new sr(De.min(),Se.empty(),sg)}static max(){return new sr(De.max(),Se.empty(),sg)}}function nS(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Se.comparator(n.documentKey,e.documentKey),t!==0?t:qe(n.largestBatchId,e.largestBatchId))}const kk="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Lk{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Oc(n){if(n.code!==ae.FAILED_PRECONDITION||n.message!==kk)throw n;pe("LocalStore","Unexpectedly lost primary lease")}class Z{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Me(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Z(((i,r)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(i,r)},this.catchCallback=s=>{this.wrapFailure(t,s).next(i,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof Z?t:Z.resolve(t)}catch(t){return Z.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):Z.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):Z.reject(t)}static resolve(e){return new Z(((t,i)=>{t(e)}))}static reject(e){return new Z(((t,i)=>{i(e)}))}static waitFor(e){return new Z(((t,i)=>{let r=0,s=0,o=!1;e.forEach((a=>{++r,a.next((()=>{++s,o&&s===r&&t()}),(c=>i(c)))})),o=!0,s===r&&t()}))}static or(e){let t=Z.resolve(!1);for(const i of e)t=t.next((r=>r?Z.resolve(r):i()));return t}static forEach(e,t){const i=[];return e.forEach(((r,s)=>{i.push(t.call(this,r,s))})),this.waitFor(i)}static mapArray(e,t){return new Z(((i,r)=>{const s=e.length,o=new Array(s);let a=0;for(let c=0;c<s;c++){const h=c;t(e[h]).next((d=>{o[h]=d,++a,a===s&&i(o)}),(d=>r(d)))}}))}static doWhile(e,t){return new Z(((i,r)=>{const s=()=>{e()===!0?t().next((()=>{s()}),r):i()};s()}))}}const Qi="SimpleDb";class ay{static open(e,t,i,r){try{return new ay(t,e.transaction(r,i))}catch(s){throw new Sf(t,s)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new _o,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new Sf(e,t.error)):this.S.resolve()},this.transaction.onerror=i=>{const r=iS(i.target.error);this.S.reject(new Sf(e,r))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(pe(Qi,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new K7(t)}}class Da{static delete(e){return pe(Qi,"Removing database:",e),Bl(sk().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!gk())return!1;if(Da.F())return!0;const e=wn(),t=Da.M(e),i=0<t&&t<10,r=Nk(e),s=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||i||s)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),i=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(i)}constructor(e,t,i){this.name=e,this.version=t,this.N=i,this.B=null,Da.M(wn())===12.2&&_i("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(pe(Qi,"Opening database:",this.name),this.db=await new Promise(((t,i)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=s=>{const o=s.target.result;t(o)},r.onblocked=()=>{i(new Sf(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=s=>{const o=s.target.error;o.name==="VersionError"?i(new xe(ae.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?i(new xe(ae.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):i(new Sf(e,o))},r.onupgradeneeded=s=>{pe(Qi,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.N.k(o,r.transaction,s.oldVersion,this.version).next((()=>{pe(Qi,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,i,r){const s=t==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const a=ay.open(this.db,e,s?"readonly":"readwrite",i),c=r(a).next((h=>(a.C(),h))).catch((h=>(a.abort(h),Z.reject(h)))).toPromise();return c.catch((()=>{})),await a.D,c}catch(a){const c=a,h=c.name!=="FirebaseError"&&o<3;if(pe(Qi,"Transaction failed with error:",c.message,"Retrying:",h),this.close(),!h)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}function Nk(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class H7{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return Bl(this.U.delete())}}class Sf extends xe{constructor(e,t){super(ae.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Ja(n){return n.name==="IndexedDbTransactionError"}class K7{constructor(e){this.store=e}put(e,t){let i;return t!==void 0?(pe(Qi,"PUT",this.store.name,e,t),i=this.store.put(t,e)):(pe(Qi,"PUT",this.store.name,"<auto-key>",e),i=this.store.put(e)),Bl(i)}add(e){return pe(Qi,"ADD",this.store.name,e,e),Bl(this.store.add(e))}get(e){return Bl(this.store.get(e)).next((t=>(t===void 0&&(t=null),pe(Qi,"GET",this.store.name,e,t),t)))}delete(e){return pe(Qi,"DELETE",this.store.name,e),Bl(this.store.delete(e))}count(){return pe(Qi,"COUNT",this.store.name),Bl(this.store.count())}J(e,t){const i=this.options(e,t),r=i.index?this.store.index(i.index):this.store;if(typeof r.getAll=="function"){const s=r.getAll(i.range);return new Z(((o,a)=>{s.onerror=c=>{a(c.target.error)},s.onsuccess=c=>{o(c.target.result)}}))}{const s=this.cursor(i),o=[];return this.H(s,((a,c)=>{o.push(c)})).next((()=>o))}}Y(e,t){const i=this.store.getAll(e,t===null?void 0:t);return new Z(((r,s)=>{i.onerror=o=>{s(o.target.error)},i.onsuccess=o=>{r(o.target.result)}}))}Z(e,t){pe(Qi,"DELETE ALL",this.store.name);const i=this.options(e,t);i.X=!1;const r=this.cursor(i);return this.H(r,((s,o,a)=>a.delete()))}ee(e,t){let i;t?i=e:(i={},t=e);const r=this.cursor(i);return this.H(r,t)}te(e){const t=this.cursor({});return new Z(((i,r)=>{t.onerror=s=>{const o=iS(s.target.error);r(o)},t.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next((a=>{a?o.continue():i()})):i()}}))}H(e,t){const i=[];return new Z(((r,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void r();const c=new H7(a),h=t(a.primaryKey,a.value,c);if(h instanceof Z){const d=h.catch((g=>(c.done(),Z.reject(g))));i.push(d)}c.isDone?r():c.G===null?a.continue():a.continue(c.G)}})).next((()=>Z.waitFor(i)))}options(e,t){let i;return e!==void 0&&(typeof e=="string"?i=e:t=e),{index:i,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const i=this.store.index(e.index);return e.X?i.openKeyCursor(e.range,t):i.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Bl(n){return new Z(((e,t)=>{n.onsuccess=i=>{const r=i.target.result;e(r)},n.onerror=i=>{const r=iS(i.target.error);t(r)}}))}let qP=!1;function iS(n){const e=Da.M(wn());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const i=new xe("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return qP||(qP=!0,setTimeout((()=>{throw i}),0)),i}}return n}const If="IndexBackfiller";class q7{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){pe(If,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();pe(If,`Documents written: ${t}`)}catch(t){Ja(t)?pe(If,"Ignoring IndexedDB error during index backfill: ",t):await Oc(t)}await this.re(6e4)}))}}class Y7{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const i=new Set;let r=t,s=!0;return Z.doWhile((()=>s===!0&&r>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((o=>{if(o!==null&&!i.has(o))return pe(If,`Processing collection: ${o}`),this.oe(e,o,r).next((a=>{r-=a,i.add(o)}));s=!1})))).next((()=>t-r))}oe(e,t,i){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((r=>this.localStore.localDocuments.getNextDocuments(e,t,r,i).next((s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next((()=>this._e(r,s))).next((a=>(pe(If,`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a)))).next((()=>o.size))}))))}_e(e,t){let i=e;return t.changes.forEach(((r,s)=>{const o=bk(s);nS(o,i)>0&&(i=o)})),new sr(i.readTime,i.documentKey,Math.max(t.batchId,e.largestBatchId))}}class Cr{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Cr.ce=-1;const ec=-1;function ly(n){return n==null}function ag(n){return n===0&&1/n==-1/0}function X7(n){return typeof n=="number"&&Number.isInteger(n)&&!ag(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const X0="";function ci(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=YP(e)),e=Q7(n.get(t),e);return YP(e)}function Q7(n,e){let t=e;const i=n.length;for(let r=0;r<i;r++){const s=n.charAt(r);switch(s){case"\0":t+="";break;case X0:t+="";break;default:t+=s}}return t}function YP(n){return n+X0+""}function Ps(n){const e=n.length;if(Oe(e>=2,64408,{path:n}),e===2)return Oe(n.charAt(0)===X0&&n.charAt(1)==="",56145,{path:n}),mt.emptyPath();const t=e-2,i=[];let r="";for(let s=0;s<e;){const o=n.indexOf(X0,s);switch((o<0||o>t)&&Me(50515,{path:n}),n.charAt(o+1)){case"":const a=n.substring(s,o);let c;r.length===0?c=a:(r+=a,c=r,r=""),i.push(c);break;case"":r+=n.substring(s,o),r+="\0";break;case"":r+=n.substring(s,o+1);break;default:Me(61167,{path:n})}s=o+2}return new mt(i)}const Vl="remoteDocuments",qg="owner",Au="owner",lg="mutationQueues",Z7="userId",Hr="mutations",XP="batchId",Xl="userMutationsIndex",QP=["userId","batchId"];function r0(n,e){return[n,ci(e)]}function Ok(n,e,t){return[n,ci(e),t]}const J7={},Ih="documentMutations",Q0="remoteDocumentsV14",ej=["prefixPath","collectionGroup","readTime","documentId"],s0="documentKeyIndex",tj=["prefixPath","collectionGroup","documentId"],Dk="collectionGroupIndex",nj=["collectionGroup","readTime","prefixPath","documentId"],cg="remoteDocumentGlobal",sw="remoteDocumentGlobalKey",Th="targets",Vk="queryTargetsIndex",ij=["canonicalId","targetId"],Rh="targetDocuments",rj=["targetId","path"],rS="documentTargetsIndex",sj=["path","targetId"],Z0="targetGlobalKey",tc="targetGlobal",ug="collectionParents",oj=["collectionId","parent"],Ph="clientMetadata",aj="clientId",cy="bundles",lj="bundleId",uy="namedQueries",cj="name",sS="indexConfiguration",uj="indexId",ow="collectionGroupIndex",hj="collectionGroup",Tf="indexState",dj=["indexId","uid"],Fk="sequenceNumberIndex",fj=["uid","sequenceNumber"],Rf="indexEntries",gj=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Gk="documentKeyIndex",mj=["indexId","uid","orderedDocumentKey"],hy="documentOverlays",pj=["userId","collectionPath","documentId"],aw="collectionPathOverlayIndex",_j=["userId","collectionPath","largestBatchId"],jk="collectionGroupOverlayIndex",yj=["userId","collectionGroup","largestBatchId"],oS="globals",vj="name",Uk=[lg,Hr,Ih,Vl,Th,qg,tc,Rh,Ph,cg,ug,cy,uy],Ej=[...Uk,hy],Bk=[lg,Hr,Ih,Q0,Th,qg,tc,Rh,Ph,cg,ug,cy,uy,hy],zk=Bk,aS=[...zk,sS,Tf,Rf],wj=aS,$k=[...aS,oS],xj=$k;class lw extends Lk{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function xn(n,e){const t=Ye(n);return Da.O(t.le,e)}function ZP(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function el(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Wk(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class zt{constructor(e,t){this.comparator=e,this.root=t||Wn.EMPTY}insert(e,t){return new zt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Wn.BLACK,null,null))}remove(e){return new zt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Wn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const r=this.comparator(e,i.key);if(r===0)return t+i.left.size;r<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Vp(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Vp(this.root,e,this.comparator,!1)}getReverseIterator(){return new Vp(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Vp(this.root,e,this.comparator,!0)}}class Vp{constructor(e,t,i,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?i(e.key,t):1,t&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Wn{constructor(e,t,i,r,s){this.key=e,this.value=t,this.color=i??Wn.RED,this.left=r??Wn.EMPTY,this.right=s??Wn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,r,s){return new Wn(e??this.key,t??this.value,i??this.color,r??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let r=this;const s=i(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,t,i),null):s===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Wn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return Wn.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Wn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Wn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Me(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Me(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Me(27949);return e+(this.isRed()?0:1)}}Wn.EMPTY=null,Wn.RED=!0,Wn.BLACK=!1;Wn.EMPTY=new class{constructor(){this.size=0}get key(){throw Me(57766)}get value(){throw Me(16141)}get color(){throw Me(16727)}get left(){throw Me(29726)}get right(){throw Me(36894)}copy(e,t,i,r,s){return this}insert(e,t,i){return new Wn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class It{constructor(e){this.comparator=e,this.data=new zt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new JP(this.data.getIterator())}getIteratorFrom(e){return new JP(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof It)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=i.getNext().key;if(this.comparator(r,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new It(this.comparator);return t.data=e,t}}class JP{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Cu(n){return n.hasNext()?n.getNext():void 0}class Fi{constructor(e){this.fields=e,e.sort(Kt.comparator)}static empty(){return new Fi([])}unionWith(e){let t=new It(Kt.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new Fi(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Sh(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}class Hk extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class gn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(r){try{return atob(r)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Hk("Invalid base64 string: "+s):s}})(e);return new gn(t)}static fromUint8Array(e){const t=(function(r){let s="";for(let o=0;o<r.length;++o)s+=String.fromCharCode(r[o]);return s})(e);return new gn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return qe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}gn.EMPTY_BYTE_STRING=new gn("");const Sj=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function So(n){if(Oe(!!n,39018),typeof n=="string"){let e=0;const t=Sj.exec(n);if(Oe(!!t,46558,{timestamp:n}),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Bt(n.seconds),nanos:Bt(n.nanos)}}function Bt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Io(n){return typeof n=="string"?gn.fromBase64String(n):gn.fromUint8Array(n)}const Kk="server_timestamp",qk="__type__",Yk="__previous_value__",Xk="__local_write_time__";function lS(n){return(n?.mapValue?.fields||{})[qk]?.stringValue===Kk}function dy(n){const e=n.mapValue.fields[Yk];return lS(e)?dy(e):e}function hg(n){const e=So(n.mapValue.fields[Xk].timestampValue);return new xt(e.seconds,e.nanos)}class Ij{constructor(e,t,i,r,s,o,a,c,h,d){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=r,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=h,this.isUsingEmulator=d}}const J0="(default)";class yc{constructor(e,t){this.projectId=e,this.database=t||J0}static empty(){return new yc("","")}get isDefaultDatabase(){return this.database===J0}isEqual(e){return e instanceof yc&&e.projectId===this.projectId&&e.database===this.database}}const cS="__type__",Qk="__max__",Pa={mapValue:{fields:{__type__:{stringValue:Qk}}}},uS="__vector__",Ah="value",o0={nullValue:"NULL_VALUE"};function $a(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?lS(n)?4:Zk(n)?9007199254740991:fy(n)?10:11:Me(28295,{value:n})}function Vs(n,e){if(n===e)return!0;const t=$a(n);if(t!==$a(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return hg(n).isEqual(hg(e));case 3:return(function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const o=So(r.timestampValue),a=So(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(r,s){return Io(r.bytesValue).isEqual(Io(s.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(r,s){return Bt(r.geoPointValue.latitude)===Bt(s.geoPointValue.latitude)&&Bt(r.geoPointValue.longitude)===Bt(s.geoPointValue.longitude)})(n,e);case 2:return(function(r,s){if("integerValue"in r&&"integerValue"in s)return Bt(r.integerValue)===Bt(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const o=Bt(r.doubleValue),a=Bt(s.doubleValue);return o===a?ag(o)===ag(a):isNaN(o)&&isNaN(a)}return!1})(n,e);case 9:return Sh(n.arrayValue.values||[],e.arrayValue.values||[],Vs);case 10:case 11:return(function(r,s){const o=r.mapValue.fields||{},a=s.mapValue.fields||{};if(ZP(o)!==ZP(a))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!Vs(o[c],a[c])))return!1;return!0})(n,e);default:return Me(52216,{left:n})}}function dg(n,e){return(n.values||[]).find((t=>Vs(t,e)))!==void 0}function Wa(n,e){if(n===e)return 0;const t=$a(n),i=$a(e);if(t!==i)return qe(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return qe(n.booleanValue,e.booleanValue);case 2:return(function(s,o){const a=Bt(s.integerValue||s.doubleValue),c=Bt(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1})(n,e);case 3:return eA(n.timestampValue,e.timestampValue);case 4:return eA(hg(n),hg(e));case 5:return iw(n.stringValue,e.stringValue);case 6:return(function(s,o){const a=Io(s),c=Io(o);return a.compareTo(c)})(n.bytesValue,e.bytesValue);case 7:return(function(s,o){const a=s.split("/"),c=o.split("/");for(let h=0;h<a.length&&h<c.length;h++){const d=qe(a[h],c[h]);if(d!==0)return d}return qe(a.length,c.length)})(n.referenceValue,e.referenceValue);case 8:return(function(s,o){const a=qe(Bt(s.latitude),Bt(o.latitude));return a!==0?a:qe(Bt(s.longitude),Bt(o.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return tA(n.arrayValue,e.arrayValue);case 10:return(function(s,o){const a=s.fields||{},c=o.fields||{},h=a[Ah]?.arrayValue,d=c[Ah]?.arrayValue,g=qe(h?.values?.length||0,d?.values?.length||0);return g!==0?g:tA(h,d)})(n.mapValue,e.mapValue);case 11:return(function(s,o){if(s===Pa.mapValue&&o===Pa.mapValue)return 0;if(s===Pa.mapValue)return 1;if(o===Pa.mapValue)return-1;const a=s.fields||{},c=Object.keys(a),h=o.fields||{},d=Object.keys(h);c.sort(),d.sort();for(let g=0;g<c.length&&g<d.length;++g){const m=iw(c[g],d[g]);if(m!==0)return m;const y=Wa(a[c[g]],h[d[g]]);if(y!==0)return y}return qe(c.length,d.length)})(n.mapValue,e.mapValue);default:throw Me(23264,{he:t})}}function eA(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return qe(n,e);const t=So(n),i=So(e),r=qe(t.seconds,i.seconds);return r!==0?r:qe(t.nanos,i.nanos)}function tA(n,e){const t=n.values||[],i=e.values||[];for(let r=0;r<t.length&&r<i.length;++r){const s=Wa(t[r],i[r]);if(s)return s}return qe(t.length,i.length)}function Ch(n){return cw(n)}function cw(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=So(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Io(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Se.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",r=!0;for(const s of t.values||[])r?r=!1:i+=",",i+=cw(s);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let r="{",s=!0;for(const o of i)s?s=!1:r+=",",r+=`${o}:${cw(t.fields[o])}`;return r+"}"})(n.mapValue):Me(61005,{value:n})}function a0(n){switch($a(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=dy(n);return e?16+a0(e):16;case 5:return 2*n.stringValue.length;case 6:return Io(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((r,s)=>r+a0(s)),0)})(n.arrayValue);case 10:case 11:return(function(i){let r=0;return el(i.fields,((s,o)=>{r+=s.length+a0(o)})),r})(n.mapValue);default:throw Me(13486,{value:n})}}function fg(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function uw(n){return!!n&&"integerValue"in n}function gg(n){return!!n&&"arrayValue"in n}function nA(n){return!!n&&"nullValue"in n}function iA(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function l0(n){return!!n&&"mapValue"in n}function fy(n){return(n?.mapValue?.fields||{})[cS]?.stringValue===uS}function Pf(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return el(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=Pf(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Pf(n.arrayValue.values[t]);return e}return{...n}}function Zk(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===Qk}const Jk={mapValue:{fields:{[cS]:{stringValue:uS},[Ah]:{arrayValue:{}}}}};function Tj(n){return"nullValue"in n?o0:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?fg(yc.empty(),Se.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?fy(n)?Jk:{mapValue:{}}:Me(35942,{value:n})}function Rj(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?fg(yc.empty(),Se.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?Jk:"mapValue"in n?fy(n)?{mapValue:{}}:Pa:Me(61959,{value:n})}function rA(n,e){const t=Wa(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function sA(n,e){const t=Wa(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class si{constructor(e){this.value=e}static empty(){return new si({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!l0(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Pf(t)}setAll(e){let t=Kt.emptyPath(),i={},r=[];e.forEach(((o,a)=>{if(!t.isImmediateParentOf(a)){const c=this.getFieldsMap(t);this.applyChanges(c,i,r),i={},r=[],t=a.popLast()}o?i[a.lastSegment()]=Pf(o):r.push(a.lastSegment())}));const s=this.getFieldsMap(t);this.applyChanges(s,i,r)}delete(e){const t=this.field(e.popLast());l0(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Vs(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=t.mapValue.fields[e.get(i)];l0(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,i){el(t,((r,s)=>e[r]=s));for(const r of i)delete e[r]}clone(){return new si(Pf(this.value))}}function eL(n){const e=[];return el(n.fields,((t,i)=>{const r=new Kt([t]);if(l0(i)){const s=eL(i.mapValue).fields;if(s.length===0)e.push(r);else for(const o of s)e.push(r.child(o))}else e.push(r)})),new Fi(e)}class Jt{constructor(e,t,i,r,s,o,a){this.key=e,this.documentType=t,this.version=i,this.readTime=r,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Jt(e,0,De.min(),De.min(),De.min(),si.empty(),0)}static newFoundDocument(e,t,i,r){return new Jt(e,1,t,De.min(),i,r,0)}static newNoDocument(e,t){return new Jt(e,2,t,De.min(),De.min(),si.empty(),0)}static newUnknownDocument(e,t){return new Jt(e,3,t,De.min(),De.min(),si.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(De.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=si.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=si.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=De.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Jt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Jt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Mh{constructor(e,t){this.position=e,this.inclusive=t}}function oA(n,e,t){let i=0;for(let r=0;r<n.position.length;r++){const s=e[r],o=n.position[r];if(s.field.isKeyField()?i=Se.comparator(Se.fromName(o.referenceValue),t.key):i=Wa(o,t.data.field(s.field)),s.dir==="desc"&&(i*=-1),i!==0)break}return i}function aA(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Vs(n.position[t],e.position[t]))return!1;return!0}class e_{constructor(e,t="asc"){this.field=e,this.dir=t}}function Pj(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class tL{}class it extends tL{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new Aj(e,t,i):t==="array-contains"?new bj(e,i):t==="in"?new aL(e,i):t==="not-in"?new kj(e,i):t==="array-contains-any"?new Lj(e,i):new it(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new Cj(e,i):new Mj(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Wa(t,this.value)):t!==null&&$a(this.value)===$a(t)&&this.matchesComparison(Wa(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Me(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class St extends tL{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new St(e,t)}matches(e){return bh(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function bh(n){return n.op==="and"}function hw(n){return n.op==="or"}function hS(n){return nL(n)&&bh(n)}function nL(n){for(const e of n.filters)if(e instanceof St)return!1;return!0}function dw(n){if(n instanceof it)return n.field.canonicalString()+n.op.toString()+Ch(n.value);if(hS(n))return n.filters.map((e=>dw(e))).join(",");{const e=n.filters.map((t=>dw(t))).join(",");return`${n.op}(${e})`}}function iL(n,e){return n instanceof it?(function(i,r){return r instanceof it&&i.op===r.op&&i.field.isEqual(r.field)&&Vs(i.value,r.value)})(n,e):n instanceof St?(function(i,r){return r instanceof St&&i.op===r.op&&i.filters.length===r.filters.length?i.filters.reduce(((s,o,a)=>s&&iL(o,r.filters[a])),!0):!1})(n,e):void Me(19439)}function rL(n,e){const t=n.filters.concat(e);return St.create(t,n.op)}function sL(n){return n instanceof it?(function(t){return`${t.field.canonicalString()} ${t.op} ${Ch(t.value)}`})(n):n instanceof St?(function(t){return t.op.toString()+" {"+t.getFilters().map(sL).join(" ,")+"}"})(n):"Filter"}class Aj extends it{constructor(e,t,i){super(e,t,i),this.key=Se.fromName(i.referenceValue)}matches(e){const t=Se.comparator(e.key,this.key);return this.matchesComparison(t)}}class Cj extends it{constructor(e,t){super(e,"in",t),this.keys=oL("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class Mj extends it{constructor(e,t){super(e,"not-in",t),this.keys=oL("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function oL(n,e){return(e.arrayValue?.values||[]).map((t=>Se.fromName(t.referenceValue)))}class bj extends it{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return gg(t)&&dg(t.arrayValue,this.value)}}class aL extends it{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&dg(this.value.arrayValue,t)}}class kj extends it{constructor(e,t){super(e,"not-in",t)}matches(e){if(dg(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!dg(this.value.arrayValue,t)}}class Lj extends it{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!gg(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>dg(this.value.arrayValue,i)))}}class Nj{constructor(e,t=null,i=[],r=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=r,this.limit=s,this.startAt=o,this.endAt=a,this.Te=null}}function fw(n,e=null,t=[],i=[],r=null,s=null,o=null){return new Nj(n,e,t,i,r,s,o)}function vc(n){const e=Ye(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>dw(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(s){return s.field.canonicalString()+s.dir})(i))).join(","),ly(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>Ch(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>Ch(i))).join(",")),e.Te=t}return e.Te}function Yg(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!Pj(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!iL(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!aA(n.startAt,e.startAt)&&aA(n.endAt,e.endAt)}function t_(n){return Se.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function n_(n,e){return n.filters.filter((t=>t instanceof it&&t.field.isEqual(e)))}function lA(n,e,t){let i=o0,r=!0;for(const s of n_(n,e)){let o=o0,a=!0;switch(s.op){case"<":case"<=":o=Tj(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=o0}rA({value:i,inclusive:r},{value:o,inclusive:a})<0&&(i=o,r=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];rA({value:i,inclusive:r},{value:o,inclusive:t.inclusive})<0&&(i=o,r=t.inclusive);break}}return{value:i,inclusive:r}}function cA(n,e,t){let i=Pa,r=!0;for(const s of n_(n,e)){let o=Pa,a=!0;switch(s.op){case">=":case">":o=Rj(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=Pa}sA({value:i,inclusive:r},{value:o,inclusive:a})>0&&(i=o,r=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];sA({value:i,inclusive:r},{value:o,inclusive:t.inclusive})>0&&(i=o,r=t.inclusive);break}}return{value:i,inclusive:r}}class Xg{constructor(e,t=null,i=[],r=[],s=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=r,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function Oj(n,e,t,i,r,s,o,a){return new Xg(n,e,t,i,r,s,o,a)}function dS(n){return new Xg(n)}function uA(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function lL(n){return n.collectionGroup!==null}function Af(n){const e=Ye(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),t.add(s.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new It(Kt.comparator);return o.filters.forEach((c=>{c.getFlattenedFilters().forEach((h=>{h.isInequality()&&(a=a.add(h.field))}))})),a})(e).forEach((s=>{t.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new e_(s,i))})),t.has(Kt.keyField().canonicalString())||e.Ie.push(new e_(Kt.keyField(),i))}return e.Ie}function br(n){const e=Ye(n);return e.Ee||(e.Ee=Dj(e,Af(n))),e.Ee}function Dj(n,e){if(n.limitType==="F")return fw(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((r=>{const s=r.dir==="desc"?"asc":"desc";return new e_(r.field,s)}));const t=n.endAt?new Mh(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Mh(n.startAt.position,n.startAt.inclusive):null;return fw(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function gw(n,e){const t=n.filters.concat([e]);return new Xg(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function mw(n,e,t){return new Xg(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function gy(n,e){return Yg(br(n),br(e))&&n.limitType===e.limitType}function cL(n){return`${vc(br(n))}|lt:${n.limitType}`}function ju(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((r=>sL(r))).join(", ")}]`),ly(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((r=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(r))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((r=>Ch(r))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((r=>Ch(r))).join(",")),`Target(${i})`})(br(n))}; limitType=${n.limitType})`}function Qg(n,e){return e.isFoundDocument()&&(function(i,r){const s=r.key.path;return i.collectionGroup!==null?r.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(s):Se.isDocumentKey(i.path)?i.path.isEqual(s):i.path.isImmediateParentOf(s)})(n,e)&&(function(i,r){for(const s of Af(i))if(!s.field.isKeyField()&&r.data.field(s.field)===null)return!1;return!0})(n,e)&&(function(i,r){for(const s of i.filters)if(!s.matches(r))return!1;return!0})(n,e)&&(function(i,r){return!(i.startAt&&!(function(o,a,c){const h=oA(o,a,c);return o.inclusive?h<=0:h<0})(i.startAt,Af(i),r)||i.endAt&&!(function(o,a,c){const h=oA(o,a,c);return o.inclusive?h>=0:h>0})(i.endAt,Af(i),r))})(n,e)}function Vj(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function uL(n){return(e,t)=>{let i=!1;for(const r of Af(n)){const s=Fj(r,e,t);if(s!==0)return s;i=i||r.field.isKeyField()}return 0}}function Fj(n,e,t){const i=n.field.isKeyField()?Se.comparator(e.key,t.key):(function(s,o,a){const c=o.data.field(s),h=a.data.field(s);return c!==null&&h!==null?Wa(c,h):Me(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return Me(19790,{direction:n.dir})}}class bo{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[r,s]of i)if(this.equalsFn(r,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),r=this.inner[i];if(r===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return void(r[s]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return i.length===1?delete this.inner[t]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){el(this.inner,((t,i)=>{for(const[r,s]of i)e(r,s)}))}isEmpty(){return Wk(this.inner)}size(){return this.innerSize}}const Gj=new zt(Se.comparator);function tr(){return Gj}const hL=new zt(Se.comparator);function cf(...n){let e=hL;for(const t of n)e=e.insert(t.key,t);return e}function dL(n){let e=hL;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function As(){return Cf()}function fL(){return Cf()}function Cf(){return new bo((n=>n.toString()),((n,e)=>n.isEqual(e)))}const jj=new zt(Se.comparator),Uj=new It(Se.comparator);function et(...n){let e=Uj;for(const t of n)e=e.add(t);return e}const Bj=new It(qe);function zj(){return Bj}function fS(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ag(e)?"-0":e}}function gL(n){return{integerValue:""+n}}function $j(n,e){return X7(e)?gL(e):fS(n,e)}class my{constructor(){this._=void 0}}function Wj(n,e,t){return n instanceof mg?(function(r,s){const o={fields:{[qk]:{stringValue:Kk},[Xk]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&lS(s)&&(s=dy(s)),s&&(o.fields[Yk]=s),{mapValue:o}})(t,e):n instanceof kh?pL(n,e):n instanceof Lh?_L(n,e):(function(r,s){const o=mL(r,s),a=hA(o)+hA(r.Ae);return uw(o)&&uw(r.Ae)?gL(a):fS(r.serializer,a)})(n,e)}function Hj(n,e,t){return n instanceof kh?pL(n,e):n instanceof Lh?_L(n,e):t}function mL(n,e){return n instanceof pg?(function(i){return uw(i)||(function(s){return!!s&&"doubleValue"in s})(i)})(e)?e:{integerValue:0}:null}class mg extends my{}class kh extends my{constructor(e){super(),this.elements=e}}function pL(n,e){const t=yL(e);for(const i of n.elements)t.some((r=>Vs(r,i)))||t.push(i);return{arrayValue:{values:t}}}class Lh extends my{constructor(e){super(),this.elements=e}}function _L(n,e){let t=yL(e);for(const i of n.elements)t=t.filter((r=>!Vs(r,i)));return{arrayValue:{values:t}}}class pg extends my{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function hA(n){return Bt(n.integerValue||n.doubleValue)}function yL(n){return gg(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class Kj{constructor(e,t){this.field=e,this.transform=t}}function qj(n,e){return n.field.isEqual(e.field)&&(function(i,r){return i instanceof kh&&r instanceof kh||i instanceof Lh&&r instanceof Lh?Sh(i.elements,r.elements,Vs):i instanceof pg&&r instanceof pg?Vs(i.Ae,r.Ae):i instanceof mg&&r instanceof mg})(n.transform,e.transform)}class Yj{constructor(e,t){this.version=e,this.transformResults=t}}class yi{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new yi}static exists(e){return new yi(void 0,e)}static updateTime(e){return new yi(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function c0(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class py{}function vL(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new _y(n.key,yi.none()):new $h(n.key,n.data,yi.none());{const t=n.data,i=si.empty();let r=new It(Kt.comparator);for(let s of e.fields)if(!r.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?i.delete(s):i.set(s,o),r=r.add(s)}return new ko(n.key,i,new Fi(r.toArray()),yi.none())}}function Xj(n,e,t){n instanceof $h?(function(r,s,o){const a=r.value.clone(),c=fA(r.fieldTransforms,s,o.transformResults);a.setAll(c),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()})(n,e,t):n instanceof ko?(function(r,s,o){if(!c0(r.precondition,s))return void s.convertToUnknownDocument(o.version);const a=fA(r.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(EL(r)),c.setAll(a),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()})(n,e,t):(function(r,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,t)}function Mf(n,e,t,i){return n instanceof $h?(function(s,o,a,c){if(!c0(s.precondition,o))return a;const h=s.value.clone(),d=gA(s.fieldTransforms,c,o);return h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null})(n,e,t,i):n instanceof ko?(function(s,o,a,c){if(!c0(s.precondition,o))return a;const h=gA(s.fieldTransforms,c,o),d=o.data;return d.setAll(EL(s)),d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map((g=>g.field)))})(n,e,t,i):(function(s,o,a){return c0(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a})(n,e,t)}function Qj(n,e){let t=null;for(const i of n.fieldTransforms){const r=e.data.field(i.field),s=mL(i.transform,r||null);s!=null&&(t===null&&(t=si.empty()),t.set(i.field,s))}return t||null}function dA(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,r){return i===void 0&&r===void 0||!(!i||!r)&&Sh(i,r,((s,o)=>qj(s,o)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class $h extends py{constructor(e,t,i,r=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class ko extends py{constructor(e,t,i,r,s=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function EL(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function fA(n,e,t){const i=new Map;Oe(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let r=0;r<t.length;r++){const s=n[r],o=s.transform,a=e.data.field(s.field);i.set(s.field,Hj(o,a,t[r]))}return i}function gA(n,e,t){const i=new Map;for(const r of n){const s=r.transform,o=t.data.field(r.field);i.set(r.field,Wj(s,o,e))}return i}class _y extends py{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class wL extends py{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class gS{constructor(e,t,i,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const s=this.mutations[r];s.key.isEqual(e.key)&&Xj(s,e,i[r])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=Mf(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=Mf(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=fL();return this.mutations.forEach((r=>{const s=e.get(r.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=t.has(r.key)?null:a;const c=vL(o,a);c!==null&&i.set(r.key,c),o.isValidDocument()||o.convertToNoDocument(De.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),et())}isEqual(e){return this.batchId===e.batchId&&Sh(this.mutations,e.mutations,((t,i)=>dA(t,i)))&&Sh(this.baseMutations,e.baseMutations,((t,i)=>dA(t,i)))}}class mS{constructor(e,t,i,r){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=r}static from(e,t,i){Oe(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let r=(function(){return jj})();const s=e.mutations;for(let o=0;o<s.length;o++)r=r.insert(s[o].key,i[o].version);return new mS(e,t,i,r)}}class pS{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class Zj{constructor(e,t){this.count=e,this.unchangedNames=t}}var dn,ot;function Jj(n){switch(n){case ae.OK:return Me(64938);case ae.CANCELLED:case ae.UNKNOWN:case ae.DEADLINE_EXCEEDED:case ae.RESOURCE_EXHAUSTED:case ae.INTERNAL:case ae.UNAVAILABLE:case ae.UNAUTHENTICATED:return!1;case ae.INVALID_ARGUMENT:case ae.NOT_FOUND:case ae.ALREADY_EXISTS:case ae.PERMISSION_DENIED:case ae.FAILED_PRECONDITION:case ae.ABORTED:case ae.OUT_OF_RANGE:case ae.UNIMPLEMENTED:case ae.DATA_LOSS:return!0;default:return Me(15467,{code:n})}}function xL(n){if(n===void 0)return _i("GRPC error has no .code"),ae.UNKNOWN;switch(n){case dn.OK:return ae.OK;case dn.CANCELLED:return ae.CANCELLED;case dn.UNKNOWN:return ae.UNKNOWN;case dn.DEADLINE_EXCEEDED:return ae.DEADLINE_EXCEEDED;case dn.RESOURCE_EXHAUSTED:return ae.RESOURCE_EXHAUSTED;case dn.INTERNAL:return ae.INTERNAL;case dn.UNAVAILABLE:return ae.UNAVAILABLE;case dn.UNAUTHENTICATED:return ae.UNAUTHENTICATED;case dn.INVALID_ARGUMENT:return ae.INVALID_ARGUMENT;case dn.NOT_FOUND:return ae.NOT_FOUND;case dn.ALREADY_EXISTS:return ae.ALREADY_EXISTS;case dn.PERMISSION_DENIED:return ae.PERMISSION_DENIED;case dn.FAILED_PRECONDITION:return ae.FAILED_PRECONDITION;case dn.ABORTED:return ae.ABORTED;case dn.OUT_OF_RANGE:return ae.OUT_OF_RANGE;case dn.UNIMPLEMENTED:return ae.UNIMPLEMENTED;case dn.DATA_LOSS:return ae.DATA_LOSS;default:return Me(39323,{code:n})}}(ot=dn||(dn={}))[ot.OK=0]="OK",ot[ot.CANCELLED=1]="CANCELLED",ot[ot.UNKNOWN=2]="UNKNOWN",ot[ot.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ot[ot.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ot[ot.NOT_FOUND=5]="NOT_FOUND",ot[ot.ALREADY_EXISTS=6]="ALREADY_EXISTS",ot[ot.PERMISSION_DENIED=7]="PERMISSION_DENIED",ot[ot.UNAUTHENTICATED=16]="UNAUTHENTICATED",ot[ot.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ot[ot.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ot[ot.ABORTED=10]="ABORTED",ot[ot.OUT_OF_RANGE=11]="OUT_OF_RANGE",ot[ot.UNIMPLEMENTED=12]="UNIMPLEMENTED",ot[ot.INTERNAL=13]="INTERNAL",ot[ot.UNAVAILABLE=14]="UNAVAILABLE",ot[ot.DATA_LOSS=15]="DATA_LOSS";function eU(){return new TextEncoder}const tU=new Oa([4294967295,4294967295],0);function mA(n){const e=eU().encode(n),t=new Ek;return t.update(e),new Uint8Array(t.digest())}function pA(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),r=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Oa([t,i],0),new Oa([r,s],0)]}class _S{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new uf(`Invalid padding: ${t}`);if(i<0)throw new uf(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new uf(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new uf(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Oa.fromNumber(this.ge)}ye(e,t,i){let r=e.add(t.multiply(Oa.fromNumber(i)));return r.compare(tU)===1&&(r=new Oa([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=mA(e),[i,r]=pA(t);for(let s=0;s<this.hashCount;s++){const o=this.ye(i,r,s);if(!this.we(o))return!1}return!0}static create(e,t,i){const r=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new _S(s,r,t);return i.forEach((a=>o.insert(a))),o}insert(e){if(this.ge===0)return;const t=mA(e),[i,r]=pA(t);for(let s=0;s<this.hashCount;s++){const o=this.ye(i,r,s);this.Se(o)}}Se(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class uf extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class yy{constructor(e,t,i,r,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const r=new Map;return r.set(e,Zg.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new yy(De.min(),r,new zt(qe),tr(),et())}}class Zg{constructor(e,t,i,r,s){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new Zg(i,t,et(),et(),et())}}class u0{constructor(e,t,i,r){this.be=e,this.removedTargetIds=t,this.key=i,this.De=r}}class SL{constructor(e,t){this.targetId=e,this.Ce=t}}class IL{constructor(e,t,i=gn.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=r}}class _A{constructor(){this.ve=0,this.Fe=yA(),this.Me=gn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=et(),t=et(),i=et();return this.Fe.forEach(((r,s)=>{switch(s){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:i=i.add(r);break;default:Me(38017,{changeType:s})}})),new Zg(this.Me,this.xe,e,t,i)}qe(){this.Oe=!1,this.Fe=yA()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Oe(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class nU{constructor(e){this.Ge=e,this.ze=new Map,this.je=tr(),this.Je=Fp(),this.He=Fp(),this.Ye=new zt(qe)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.Ke(),i.Ne||i.qe(),i.Le(e.resumeToken);break;case 2:i.Ke(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.We(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:Me(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((i,r)=>{this.rt(r)&&t(r)}))}st(e){const t=e.targetId,i=e.Ce.count,r=this.ot(t);if(r){const s=r.target;if(t_(s))if(i===0){const o=new Se(s.path);this.et(t,o,Jt.newNoDocument(o,De.min()))}else Oe(i===1,20013,{expectedCount:i});else{const o=this._t(t);if(o!==i){const a=this.ut(e),c=a?this.ct(a,e,o):1;if(c!==0){this.it(t);const h=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,h)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:r=0},hashCount:s=0}=t;let o,a;try{o=Io(i).toUint8Array()}catch(c){if(c instanceof Hk)return _c("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new _S(o,r,s)}catch(c){return _c(c instanceof uf?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.ge===0?null:a}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){const i=this.Ge.getRemoteKeysForTarget(t);let r=0;return i.forEach((s=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.et(t,s,null),r++)})),r}Tt(e){const t=new Map;this.ze.forEach(((s,o)=>{const a=this.ot(o);if(a){if(s.current&&t_(a.target)){const c=new Se(a.target.path);this.It(c).has(o)||this.Et(o,c)||this.et(o,c,Jt.newNoDocument(c,e))}s.Be&&(t.set(o,s.ke()),s.qe())}}));let i=et();this.He.forEach(((s,o)=>{let a=!0;o.forEachWhile((c=>{const h=this.ot(c);return!h||h.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)})),a&&(i=i.add(s))})),this.je.forEach(((s,o)=>o.setReadTime(e)));const r=new yy(e,t,this.Ye,this.je,i);return this.je=tr(),this.Je=Fp(),this.He=Fp(),this.Ye=new zt(qe),r}Xe(e,t){if(!this.rt(e))return;const i=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,i),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;const r=this.nt(e);this.Et(e,t)?r.Qe(t,1):r.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new _A,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new It(qe),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new It(qe),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||pe("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new _A),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Fp(){return new zt(Se.comparator)}function yA(){return new zt(Se.comparator)}const iU={asc:"ASCENDING",desc:"DESCENDING"},rU={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},sU={and:"AND",or:"OR"};class oU{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function pw(n,e){return n.useProto3Json||ly(e)?e:{value:e}}function Nh(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function TL(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function aU(n,e){return Nh(n,e.toTimestamp())}function wi(n){return Oe(!!n,49232),De.fromTimestamp((function(t){const i=So(t);return new xt(i.seconds,i.nanos)})(n))}function yS(n,e){return _w(n,e).canonicalString()}function _w(n,e){const t=(function(r){return new mt(["projects",r.projectId,"databases",r.database])})(n).child("documents");return e===void 0?t:t.child(e)}function RL(n){const e=mt.fromString(n);return Oe(OL(e),10190,{key:e.toString()}),e}function i_(n,e){return yS(n.databaseId,e.path)}function nc(n,e){const t=RL(e);if(t.get(1)!==n.databaseId.projectId)throw new xe(ae.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new xe(ae.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Se(CL(t))}function PL(n,e){return yS(n.databaseId,e)}function AL(n){const e=RL(n);return e.length===4?mt.emptyPath():CL(e)}function yw(n){return new mt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function CL(n){return Oe(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function vA(n,e,t){return{name:i_(n,e),fields:t.value.mapValue.fields}}function lU(n,e,t){const i=nc(n,e.name),r=wi(e.updateTime),s=e.createTime?wi(e.createTime):De.min(),o=new si({mapValue:{fields:e.fields}}),a=Jt.newFoundDocument(i,r,s,o);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function cU(n,e){let t;if("targetChange"in e){e.targetChange;const i=(function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:Me(39313,{state:h})})(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],s=(function(h,d){return h.useProto3Json?(Oe(d===void 0||typeof d=="string",58123),gn.fromBase64String(d||"")):(Oe(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),gn.fromUint8Array(d||new Uint8Array))})(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&(function(h){const d=h.code===void 0?ae.UNKNOWN:xL(h.code);return new xe(d,h.message||"")})(o);t=new IL(i,r,s,a||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const r=nc(n,i.document.name),s=wi(i.document.updateTime),o=i.document.createTime?wi(i.document.createTime):De.min(),a=new si({mapValue:{fields:i.document.fields}}),c=Jt.newFoundDocument(r,s,o,a),h=i.targetIds||[],d=i.removedTargetIds||[];t=new u0(h,d,c.key,c)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const r=nc(n,i.document),s=i.readTime?wi(i.readTime):De.min(),o=Jt.newNoDocument(r,s),a=i.removedTargetIds||[];t=new u0([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const r=nc(n,i.document),s=i.removedTargetIds||[];t=new u0([],s,r,null)}else{if(!("filter"in e))return Me(11601,{Rt:e});{e.filter;const i=e.filter;i.targetId;const{count:r=0,unchangedNames:s}=i,o=new Zj(r,s),a=i.targetId;t=new SL(a,o)}}return t}function r_(n,e){let t;if(e instanceof $h)t={update:vA(n,e.key,e.value)};else if(e instanceof _y)t={delete:i_(n,e.key)};else if(e instanceof ko)t={update:vA(n,e.key,e.data),updateMask:mU(e.fieldMask)};else{if(!(e instanceof wL))return Me(16599,{Vt:e.type});t={verify:i_(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(s,o){const a=o.transform;if(a instanceof mg)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof kh)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Lh)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof pg)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw Me(20930,{transform:o.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(r,s){return s.updateTime!==void 0?{updateTime:aU(r,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Me(27497)})(n,e.precondition)),t}function vw(n,e){const t=e.currentDocument?(function(s){return s.updateTime!==void 0?yi.updateTime(wi(s.updateTime)):s.exists!==void 0?yi.exists(s.exists):yi.none()})(e.currentDocument):yi.none(),i=e.updateTransforms?e.updateTransforms.map((r=>(function(o,a){let c=null;if("setToServerValue"in a)Oe(a.setToServerValue==="REQUEST_TIME",16630,{proto:a}),c=new mg;else if("appendMissingElements"in a){const d=a.appendMissingElements.values||[];c=new kh(d)}else if("removeAllFromArray"in a){const d=a.removeAllFromArray.values||[];c=new Lh(d)}else"increment"in a?c=new pg(o,a.increment):Me(16584,{proto:a});const h=Kt.fromServerFormat(a.fieldPath);return new Kj(h,c)})(n,r))):[];if(e.update){e.update.name;const r=nc(n,e.update.name),s=new si({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=(function(c){const h=c.fieldPaths||[];return new Fi(h.map((d=>Kt.fromServerFormat(d))))})(e.updateMask);return new ko(r,s,o,t,i)}return new $h(r,s,t,i)}if(e.delete){const r=nc(n,e.delete);return new _y(r,t)}if(e.verify){const r=nc(n,e.verify);return new wL(r,t)}return Me(1463,{proto:e})}function uU(n,e){return n&&n.length>0?(Oe(e!==void 0,14353),n.map((t=>(function(r,s){let o=r.updateTime?wi(r.updateTime):wi(s);return o.isEqual(De.min())&&(o=wi(s)),new Yj(o,r.transformResults||[])})(t,e)))):[]}function ML(n,e){return{documents:[PL(n,e.path)]}}function bL(n,e){const t={structuredQuery:{}},i=e.path;let r;e.collectionGroup!==null?(r=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=PL(n,r);const s=(function(h){if(h.length!==0)return NL(St.create(h,"and"))})(e.filters);s&&(t.structuredQuery.where=s);const o=(function(h){if(h.length!==0)return h.map((d=>(function(m){return{field:Uu(m.field),direction:dU(m.dir)}})(d)))})(e.orderBy);o&&(t.structuredQuery.orderBy=o);const a=pw(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=(function(h){return{before:h.inclusive,values:h.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(h){return{before:!h.inclusive,values:h.position}})(e.endAt)),{ft:t,parent:r}}function kL(n){let e=AL(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let r=null;if(i>0){Oe(i===1,65062);const d=t.from[0];d.allDescendants?r=d.collectionId:e=e.child(d.collectionId)}let s=[];t.where&&(s=(function(g){const m=LL(g);return m instanceof St&&hS(m)?m.getFilters():[m]})(t.where));let o=[];t.orderBy&&(o=(function(g){return g.map((m=>(function(w){return new e_(Bu(w.field),(function(E){switch(E){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(w.direction))})(m)))})(t.orderBy));let a=null;t.limit&&(a=(function(g){let m;return m=typeof g=="object"?g.value:g,ly(m)?null:m})(t.limit));let c=null;t.startAt&&(c=(function(g){const m=!!g.before,y=g.values||[];return new Mh(y,m)})(t.startAt));let h=null;return t.endAt&&(h=(function(g){const m=!g.before,y=g.values||[];return new Mh(y,m)})(t.endAt)),Oj(e,r,o,s,a,"F",c,h)}function hU(n,e){const t=(function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Me(28987,{purpose:r})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function LL(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=Bu(t.unaryFilter.field);return it.create(i,"==",{doubleValue:NaN});case"IS_NULL":const r=Bu(t.unaryFilter.field);return it.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Bu(t.unaryFilter.field);return it.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Bu(t.unaryFilter.field);return it.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Me(61313);default:return Me(60726)}})(n):n.fieldFilter!==void 0?(function(t){return it.create(Bu(t.fieldFilter.field),(function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Me(58110);default:return Me(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return St.create(t.compositeFilter.filters.map((i=>LL(i))),(function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return Me(1026)}})(t.compositeFilter.op))})(n):Me(30097,{filter:n})}function dU(n){return iU[n]}function fU(n){return rU[n]}function gU(n){return sU[n]}function Uu(n){return{fieldPath:n.canonicalString()}}function Bu(n){return Kt.fromServerFormat(n.fieldPath)}function NL(n){return n instanceof it?(function(t){if(t.op==="=="){if(iA(t.value))return{unaryFilter:{field:Uu(t.field),op:"IS_NAN"}};if(nA(t.value))return{unaryFilter:{field:Uu(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(iA(t.value))return{unaryFilter:{field:Uu(t.field),op:"IS_NOT_NAN"}};if(nA(t.value))return{unaryFilter:{field:Uu(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Uu(t.field),op:fU(t.op),value:t.value}}})(n):n instanceof St?(function(t){const i=t.getFilters().map((r=>NL(r)));return i.length===1?i[0]:{compositeFilter:{op:gU(t.op),filters:i}}})(n):Me(54877,{filter:n})}function mU(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function OL(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class uo{constructor(e,t,i,r,s=De.min(),o=De.min(),a=gn.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new uo(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new uo(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new uo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new uo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class DL{constructor(e){this.yt=e}}function pU(n,e){let t;if(e.document)t=lU(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const i=Se.fromSegments(e.noDocument.path),r=wc(e.noDocument.readTime);t=Jt.newNoDocument(i,r),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Me(56709);{const i=Se.fromSegments(e.unknownDocument.path),r=wc(e.unknownDocument.version);t=Jt.newUnknownDocument(i,r)}}return e.readTime&&t.setReadTime((function(r){const s=new xt(r[0],r[1]);return De.fromTimestamp(s)})(e.readTime)),t}function EA(n,e){const t=e.key,i={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:s_(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())i.document=(function(s,o){return{name:i_(s,o.key),fields:o.data.value.mapValue.fields,updateTime:Nh(s,o.version.toTimestamp()),createTime:Nh(s,o.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())i.noDocument={path:t.path.toArray(),readTime:Ec(e.version)};else{if(!e.isUnknownDocument())return Me(57904,{document:e});i.unknownDocument={path:t.path.toArray(),version:Ec(e.version)}}return i}function s_(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Ec(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function wc(n){const e=new xt(n.seconds,n.nanoseconds);return De.fromTimestamp(e)}function zl(n,e){const t=(e.baseMutations||[]).map((s=>vw(n.yt,s)));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const i=e.mutations.map((s=>vw(n.yt,s))),r=xt.fromMillis(e.localWriteTimeMs);return new gS(e.batchId,r,t,i)}function hf(n){const e=wc(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?wc(n.lastLimboFreeSnapshotVersion):De.min();let i;return i=(function(s){return s.documents!==void 0})(n.query)?(function(s){const o=s.documents.length;return Oe(o===1,1966,{count:o}),br(dS(AL(s.documents[0])))})(n.query):(function(s){return br(kL(s))})(n.query),new uo(i,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,gn.fromBase64String(n.resumeToken))}function VL(n,e){const t=Ec(e.snapshotVersion),i=Ec(e.lastLimboFreeSnapshotVersion);let r;r=t_(e.target)?ML(n.yt,e.target):bL(n.yt,e.target).ft;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:vc(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:r}}function FL(n){const e=kL({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?mw(e,e.limit,"L"):e}function X1(n,e){return new pS(e.largestBatchId,vw(n.yt,e.overlayMutation))}function wA(n,e){const t=e.path.lastSegment();return[n,ci(e.path.popLast()),t]}function xA(n,e,t,i){return{indexId:n,uid:e,sequenceNumber:t,readTime:Ec(i.readTime),documentKey:ci(i.documentKey.path),largestBatchId:i.largestBatchId}}class _U{getBundleMetadata(e,t){return SA(e).get(t).next((i=>{if(i)return(function(s){return{id:s.bundleId,createTime:wc(s.createTime),version:s.version}})(i)}))}saveBundleMetadata(e,t){return SA(e).put((function(r){return{bundleId:r.id,createTime:Ec(wi(r.createTime)),version:r.version}})(t))}getNamedQuery(e,t){return IA(e).get(t).next((i=>{if(i)return(function(s){return{name:s.name,query:FL(s.bundledQuery),readTime:wc(s.readTime)}})(i)}))}saveNamedQuery(e,t){return IA(e).put((function(r){return{name:r.name,readTime:Ec(wi(r.readTime)),bundledQuery:r.bundledQuery}})(t))}}function SA(n){return xn(n,cy)}function IA(n){return xn(n,uy)}class vy{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const i=t.uid||"";return new vy(e,i)}getOverlay(e,t){return Hd(e).get(wA(this.userId,t)).next((i=>i?X1(this.serializer,i):null))}getOverlays(e,t){const i=As();return Z.forEach(t,(r=>this.getOverlay(e,r).next((s=>{s!==null&&i.set(r,s)})))).next((()=>i))}saveOverlays(e,t,i){const r=[];return i.forEach(((s,o)=>{const a=new pS(t,o);r.push(this.St(e,a))})),Z.waitFor(r)}removeOverlaysForBatchId(e,t,i){const r=new Set;t.forEach((o=>r.add(ci(o.getCollectionPath()))));const s=[];return r.forEach((o=>{const a=IDBKeyRange.bound([this.userId,o,i],[this.userId,o,i+1],!1,!0);s.push(Hd(e).Z(aw,a))})),Z.waitFor(s)}getOverlaysForCollection(e,t,i){const r=As(),s=ci(t),o=IDBKeyRange.bound([this.userId,s,i],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Hd(e).J(aw,o).next((a=>{for(const c of a){const h=X1(this.serializer,c);r.set(h.getKey(),h)}return r}))}getOverlaysForCollectionGroup(e,t,i,r){const s=As();let o;const a=IDBKeyRange.bound([this.userId,t,i],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Hd(e).ee({index:jk,range:a},((c,h,d)=>{const g=X1(this.serializer,h);s.size()<r||g.largestBatchId===o?(s.set(g.getKey(),g),o=g.largestBatchId):d.done()})).next((()=>s))}St(e,t){return Hd(e).put((function(r,s,o){const[a,c,h]=wA(s,o.mutation.key);return{userId:s,collectionPath:c,documentId:h,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:r_(r.yt,o.mutation)}})(this.serializer,this.userId,t))}}function Hd(n){return xn(n,hy)}class yU{bt(e){return xn(e,oS)}getSessionToken(e){return this.bt(e).get("sessionToken").next((t=>{const i=t?.value;return i?gn.fromUint8Array(i):gn.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}class $l{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(Bt(e.integerValue));else if("doubleValue"in e){const i=Bt(e.doubleValue);isNaN(i)?this.Ft(t,13):(this.Ft(t,15),ag(i)?t.Mt(0):t.Mt(i))}else if("timestampValue"in e){let i=e.timestampValue;this.Ft(t,20),typeof i=="string"&&(i=So(i)),t.xt(`${i.seconds||""}`),t.Mt(i.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(Io(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const i=e.geoPointValue;this.Ft(t,45),t.Mt(i.latitude||0),t.Mt(i.longitude||0)}else"mapValue"in e?Zk(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):fy(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):Me(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const i=e.fields||{};this.Ft(t,55);for(const r of Object.keys(i))this.Ot(r,t),this.Ct(i[r],t)}kt(e,t){const i=e.fields||{};this.Ft(t,53);const r=Ah,s=i[r].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(Bt(s)),this.Ot(r,t),this.Ct(i[r],t)}Qt(e,t){const i=e.values||[];this.Ft(t,50);for(const r of i)this.Ct(r,t)}Lt(e,t){this.Ft(t,37),Se.fromName(e).path.forEach((i=>{this.Ft(t,60),this.Ut(i,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}$l.Kt=new $l;const Mu=255;function vU(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function TA(n){const e=64-(function(i){let r=0;for(let s=0;s<8;++s){const o=vU(255&i[s]);if(r+=o,o!==8)break}return r})(n);return Math.ceil(e/8)}class EU{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Gt(i.value),i=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Jt(i.value),i=t.next();this.Ht()}Yt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Gt(i);else if(i<2048)this.Gt(960|i>>>6),this.Gt(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i);else{const r=t.codePointAt(0);this.Gt(240|r>>>18),this.Gt(128|63&r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r)}}this.zt()}Zt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Jt(i);else if(i<2048)this.Jt(960|i>>>6),this.Jt(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i);else{const r=t.codePointAt(0);this.Jt(240|r>>>18),this.Jt(128|63&r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r)}}this.Ht()}Xt(e){const t=this.en(e),i=TA(t);this.tn(1+i),this.buffer[this.position++]=255&i;for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=255&t[r]}nn(e){const t=this.en(e),i=TA(t);this.tn(1+i),this.buffer[this.position++]=~(255&i);for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}rn(){this.sn(Mu),this.sn(255)}_n(){this.an(Mu),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)})(e),i=!!(128&t[0]);t[0]^=i?255:128;for(let r=1;r<t.length;++r)t[r]^=i?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===Mu?(this.sn(Mu),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===Mu?(this.an(Mu),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let i=2*this.buffer.length;i<t&&(i=t);const r=new Uint8Array(i);r.set(this.buffer),this.buffer=r}}class wU{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class xU{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class Kd{constructor(){this.cn=new EU,this.ln=new wU(this.cn),this.hn=new xU(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}class Wl{constructor(e,t,i,r){this.Tn=e,this.In=t,this.En=i,this.dn=r}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,i=new Uint8Array(t);return i.set(this.dn,0),t!==e?i.set([0],this.dn.length):++i[i.length-1],new Wl(this.Tn,this.In,this.En,i)}Rn(e,t,i){return{indexId:this.Tn,uid:e,arrayValue:h0(this.En),directionalValue:h0(this.dn),orderedDocumentKey:h0(t),documentKey:i.path.toArray()}}Vn(e,t,i){const r=this.Rn(e,t,i);return[r.indexId,r.uid,r.arrayValue,r.directionalValue,r.orderedDocumentKey,r.documentKey]}}function ua(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=RA(n.En,e.En),t!==0?t:(t=RA(n.dn,e.dn),t!==0?t:Se.comparator(n.In,e.In)))}function RA(n,e){for(let t=0;t<n.length&&t<e.length;++t){const i=n[t]-e[t];if(i!==0)return i}return n.length-e.length}function h0(n){return fk()?(function(t){let i="";for(let r=0;r<t.length;r++)i+=String.fromCharCode(t[r]);return i})(n):n}function PA(n){return typeof n!="string"?n:(function(t){const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i})(n)}class AA{constructor(e){this.mn=new It(((t,i)=>Kt.comparator(t.field,i.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const i=t;i.isInequality()?this.mn=this.mn.add(i):this.gn.push(i)}}get pn(){return this.mn.size>1}yn(e){if(Oe(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=rw(e);if(t!==void 0&&!this.wn(t))return!1;const i=Dl(e);let r=new Set,s=0,o=0;for(;s<i.length&&this.wn(i[s]);++s)r=r.add(i[s].fieldPath.canonicalString());if(s===i.length)return!0;if(this.mn.size>0){const a=this.mn.getIterator().getNext();if(!r.has(a.field.canonicalString())){const c=i[s];if(!this.Sn(a,c)||!this.bn(this.fn[o++],c))return!1}++s}for(;s<i.length;++s){const a=i[s];if(o>=this.fn.length||!this.bn(this.fn[o++],a))return!1}return!0}Dn(){if(this.pn)return null;let e=new It(Kt.comparator);const t=[];for(const i of this.gn)if(!i.field.isKeyField())if(i.op==="array-contains"||i.op==="array-contains-any")t.push(new i0(i.field,2));else{if(e.has(i.field))continue;e=e.add(i.field),t.push(new i0(i.field,0))}for(const i of this.fn)i.field.isKeyField()||e.has(i.field)||(e=e.add(i.field),t.push(new i0(i.field,i.dir==="asc"?0:1)));return new Y0(Y0.UNKNOWN_ID,this.collectionId,t,og.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const i=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===i}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function GL(n){if(Oe(n instanceof it||n instanceof St,20012),n instanceof it){if(n instanceof aL){const t=n.value.arrayValue?.values?.map((i=>it.create(n.field,"==",i)))||[];return St.create(t,"or")}return n}const e=n.filters.map((t=>GL(t)));return St.create(e,n.op)}function SU(n){if(n.getFilters().length===0)return[];const e=xw(GL(n));return Oe(jL(e),7391),Ew(e)||ww(e)?[e]:e.getFilters()}function Ew(n){return n instanceof it}function ww(n){return n instanceof St&&hS(n)}function jL(n){return Ew(n)||ww(n)||(function(t){if(t instanceof St&&hw(t)){for(const i of t.getFilters())if(!Ew(i)&&!ww(i))return!1;return!0}return!1})(n)}function xw(n){if(Oe(n instanceof it||n instanceof St,34018),n instanceof it)return n;if(n.filters.length===1)return xw(n.filters[0]);const e=n.filters.map((i=>xw(i)));let t=St.create(e,n.op);return t=o_(t),jL(t)?t:(Oe(t instanceof St,64498),Oe(bh(t),40251),Oe(t.filters.length>1,57927),t.filters.reduce(((i,r)=>vS(i,r))))}function vS(n,e){let t;return Oe(n instanceof it||n instanceof St,38388),Oe(e instanceof it||e instanceof St,25473),t=n instanceof it?e instanceof it?(function(r,s){return St.create([r,s],"and")})(n,e):CA(n,e):e instanceof it?CA(e,n):(function(r,s){if(Oe(r.filters.length>0&&s.filters.length>0,48005),bh(r)&&bh(s))return rL(r,s.getFilters());const o=hw(r)?r:s,a=hw(r)?s:r,c=o.filters.map((h=>vS(h,a)));return St.create(c,"or")})(n,e),o_(t)}function CA(n,e){if(bh(e))return rL(e,n.getFilters());{const t=e.filters.map((i=>vS(n,i)));return St.create(t,"or")}}function o_(n){if(Oe(n instanceof it||n instanceof St,11850),n instanceof it)return n;const e=n.getFilters();if(e.length===1)return o_(e[0]);if(nL(n))return n;const t=e.map((r=>o_(r))),i=[];return t.forEach((r=>{r instanceof it?i.push(r):r instanceof St&&(r.op===n.op?i.push(...r.filters):i.push(r))})),i.length===1?i[0]:St.create(i,n.op)}class IU{constructor(){this.Cn=new ES}addToCollectionParentIndex(e,t){return this.Cn.add(t),Z.resolve()}getCollectionParents(e,t){return Z.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return Z.resolve()}deleteFieldIndex(e,t){return Z.resolve()}deleteAllFieldIndexes(e){return Z.resolve()}createTargetIndexes(e,t){return Z.resolve()}getDocumentsMatchingTarget(e,t){return Z.resolve(null)}getIndexType(e,t){return Z.resolve(0)}getFieldIndexes(e,t){return Z.resolve([])}getNextCollectionGroupToUpdate(e){return Z.resolve(null)}getMinOffset(e,t){return Z.resolve(sr.min())}getMinOffsetFromCollectionGroup(e,t){return Z.resolve(sr.min())}updateCollectionGroup(e,t,i){return Z.resolve()}updateIndexEntries(e,t){return Z.resolve()}}class ES{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t]||new It(mt.comparator),s=!r.has(i);return this.index[t]=r.add(i),s}has(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t];return r&&r.has(i)}getEntries(e){return(this.index[e]||new It(mt.comparator)).toArray()}}const MA="IndexedDbIndexManager",Gp=new Uint8Array(0);class TU{constructor(e,t){this.databaseId=t,this.vn=new ES,this.Fn=new bo((i=>vc(i)),((i,r)=>Yg(i,r))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const i=t.lastSegment(),r=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const s={collectionId:i,parent:ci(r)};return bA(e).put(s)}return Z.resolve()}getCollectionParents(e,t){const i=[],r=IDBKeyRange.bound([t,""],[Ak(t),""],!1,!0);return bA(e).J(r).next((s=>{for(const o of s){if(o.collectionId!==t)break;i.push(Ps(o.parent))}return i}))}addFieldIndex(e,t){const i=qd(e),r=(function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map((c=>[c.fieldPath.canonicalString(),c.kind]))}})(t);delete r.indexId;const s=i.add(r);if(t.indexState){const o=ku(e);return s.next((a=>{o.put(xA(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return s.next()}deleteFieldIndex(e,t){const i=qd(e),r=ku(e),s=bu(e);return i.delete(t.indexId).next((()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=qd(e),i=bu(e),r=ku(e);return t.Z().next((()=>i.Z())).next((()=>r.Z()))}createTargetIndexes(e,t){return Z.forEach(this.Mn(t),(i=>this.getIndexType(e,i).next((r=>{if(r===0||r===1){const s=new AA(i).Dn();if(s!=null)return this.addFieldIndex(e,s)}}))))}getDocumentsMatchingTarget(e,t){const i=bu(e);let r=!0;const s=new Map;return Z.forEach(this.Mn(t),(o=>this.xn(e,o).next((a=>{r&&(r=!!a),s.set(o,a)})))).next((()=>{if(r){let o=et();const a=[];return Z.forEach(s,((c,h)=>{pe(MA,`Using index ${(function(N){return`id=${N.indexId}|cg=${N.collectionGroup}|f=${N.fields.map((D=>`${D.fieldPath}:${D.kind}`)).join(",")}`})(c)} to execute ${vc(t)}`);const d=(function(N,D){const j=rw(D);if(j===void 0)return null;for(const W of n_(N,j.fieldPath))switch(W.op){case"array-contains-any":return W.value.arrayValue.values||[];case"array-contains":return[W.value]}return null})(h,c),g=(function(N,D){const j=new Map;for(const W of Dl(D))for(const L of n_(N,W.fieldPath))switch(L.op){case"==":case"in":j.set(W.fieldPath.canonicalString(),L.value);break;case"not-in":case"!=":return j.set(W.fieldPath.canonicalString(),L.value),Array.from(j.values())}return null})(h,c),m=(function(N,D){const j=[];let W=!0;for(const L of Dl(D)){const A=L.kind===0?lA(N,L.fieldPath,N.startAt):cA(N,L.fieldPath,N.startAt);j.push(A.value),W&&(W=A.inclusive)}return new Mh(j,W)})(h,c),y=(function(N,D){const j=[];let W=!0;for(const L of Dl(D)){const A=L.kind===0?cA(N,L.fieldPath,N.endAt):lA(N,L.fieldPath,N.endAt);j.push(A.value),W&&(W=A.inclusive)}return new Mh(j,W)})(h,c),w=this.On(c,h,m),T=this.On(c,h,y),E=this.Nn(c,h,g),P=this.Bn(c.indexId,d,w,m.inclusive,T,y.inclusive,E);return Z.forEach(P,(M=>i.Y(M,t.limit).next((N=>{N.forEach((D=>{const j=Se.fromSegments(D.documentKey);o.has(j)||(o=o.add(j),a.push(j))}))}))))})).next((()=>a))}return Z.resolve(null)}))}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=SU(St.create(e.filters,"and")).map((i=>fw(e.path,e.collectionGroup,e.orderBy,i.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,t),t)}Bn(e,t,i,r,s,o,a){const c=(t!=null?t.length:1)*Math.max(i.length,s.length),h=c/(t!=null?t.length:1),d=[];for(let g=0;g<c;++g){const m=t?this.Ln(t[g/h]):Gp,y=this.kn(e,m,i[g%h],r),w=this.qn(e,m,s[g%h],o),T=a.map((E=>this.kn(e,m,E,!0)));d.push(...this.createRange(y,w,T))}return d}kn(e,t,i,r){const s=new Wl(e,Se.empty(),t,i);return r?s:s.An()}qn(e,t,i,r){const s=new Wl(e,Se.empty(),t,i);return r?s.An():s}xn(e,t){const i=new AA(t),r=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next((s=>{let o=null;for(const a of s)i.yn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o}))}getIndexType(e,t){let i=2;const r=this.Mn(t);return Z.forEach(r,(s=>this.xn(e,s).next((o=>{o?i!==0&&o.fields.length<(function(c){let h=new It(Kt.comparator),d=!1;for(const g of c.filters)for(const m of g.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?d=!0:h=h.add(m.field));for(const g of c.orderBy)g.field.isKeyField()||(h=h.add(g.field));return h.size+(d?1:0)})(s)&&(i=1):i=0})))).next((()=>(function(o){return o.limit!==null})(t)&&r.length>1&&i===2?1:i))}Qn(e,t){const i=new Kd;for(const r of Dl(e)){const s=t.data.field(r.fieldPath);if(s==null)return null;const o=i.Pn(r.kind);$l.Kt.Dt(s,o)}return i.un()}Ln(e){const t=new Kd;return $l.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const i=new Kd;return $l.Kt.Dt(fg(this.databaseId,t),i.Pn((function(s){const o=Dl(s);return o.length===0?0:o[o.length-1].kind})(e))),i.un()}Nn(e,t,i){if(i===null)return[];let r=[];r.push(new Kd);let s=0;for(const o of Dl(e)){const a=i[s++];for(const c of r)if(this.Un(t,o.fieldPath)&&gg(a))r=this.Kn(r,o,a);else{const h=c.Pn(o.kind);$l.Kt.Dt(a,h)}}return this.Wn(r)}On(e,t,i){return this.Nn(e,t,i.position)}Wn(e){const t=[];for(let i=0;i<e.length;++i)t[i]=e[i].un();return t}Kn(e,t,i){const r=[...e],s=[];for(const o of i.arrayValue.values||[])for(const a of r){const c=new Kd;c.seed(a.un()),$l.Kt.Dt(o,c.Pn(t.kind)),s.push(c)}return s}Un(e,t){return!!e.filters.find((i=>i instanceof it&&i.field.isEqual(t)&&(i.op==="in"||i.op==="not-in")))}getFieldIndexes(e,t){const i=qd(e),r=ku(e);return(t?i.J(ow,IDBKeyRange.bound(t,t)):i.J()).next((s=>{const o=[];return Z.forEach(s,(a=>r.get([a.indexId,this.uid]).next((c=>{o.push((function(d,g){const m=g?new og(g.sequenceNumber,new sr(wc(g.readTime),new Se(Ps(g.documentKey)),g.largestBatchId)):og.empty(),y=d.fields.map((([w,T])=>new i0(Kt.fromServerFormat(w),T)));return new Y0(d.indexId,d.collectionGroup,y,m)})(a,c))})))).next((()=>o))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((i,r)=>{const s=i.indexState.sequenceNumber-r.indexState.sequenceNumber;return s!==0?s:qe(i.collectionGroup,r.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,i){const r=qd(e),s=ku(e);return this.Gn(e).next((o=>r.J(ow,IDBKeyRange.bound(t,t)).next((a=>Z.forEach(a,(c=>s.put(xA(c.indexId,this.uid,o,i))))))))}updateIndexEntries(e,t){const i=new Map;return Z.forEach(t,((r,s)=>{const o=i.get(r.collectionGroup);return(o?Z.resolve(o):this.getFieldIndexes(e,r.collectionGroup)).next((a=>(i.set(r.collectionGroup,a),Z.forEach(a,(c=>this.zn(e,r,c).next((h=>{const d=this.jn(s,c);return h.isEqual(d)?Z.resolve():this.Jn(e,s,c,h,d)})))))))}))}Hn(e,t,i,r){return bu(e).put(r.Rn(this.uid,this.$n(i,t.key),t.key))}Yn(e,t,i,r){return bu(e).delete(r.Vn(this.uid,this.$n(i,t.key),t.key))}zn(e,t,i){const r=bu(e);let s=new It(ua);return r.ee({index:Gk,range:IDBKeyRange.only([i.indexId,this.uid,h0(this.$n(i,t))])},((o,a)=>{s=s.add(new Wl(i.indexId,t,PA(a.arrayValue),PA(a.directionalValue)))})).next((()=>s))}jn(e,t){let i=new It(ua);const r=this.Qn(t,e);if(r==null)return i;const s=rw(t);if(s!=null){const o=e.data.field(s.fieldPath);if(gg(o))for(const a of o.arrayValue.values||[])i=i.add(new Wl(t.indexId,e.key,this.Ln(a),r))}else i=i.add(new Wl(t.indexId,e.key,Gp,r));return i}Jn(e,t,i,r,s){pe(MA,"Updating index entries for document '%s'",t.key);const o=[];return(function(c,h,d,g,m){const y=c.getIterator(),w=h.getIterator();let T=Cu(y),E=Cu(w);for(;T||E;){let P=!1,M=!1;if(T&&E){const N=d(T,E);N<0?M=!0:N>0&&(P=!0)}else T!=null?M=!0:P=!0;P?(g(E),E=Cu(w)):M?(m(T),T=Cu(y)):(T=Cu(y),E=Cu(w))}})(r,s,ua,(a=>{o.push(this.Hn(e,t,i,a))}),(a=>{o.push(this.Yn(e,t,i,a))})),Z.waitFor(o)}Gn(e){let t=1;return ku(e).ee({index:Fk,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((i,r,s)=>{s.done(),t=r.sequenceNumber+1})).next((()=>t))}createRange(e,t,i){i=i.sort(((o,a)=>ua(o,a))).filter(((o,a,c)=>!a||ua(o,c[a-1])!==0));const r=[];r.push(e);for(const o of i){const a=ua(o,e),c=ua(o,t);if(a===0)r[0]=e.An();else if(a>0&&c<0)r.push(o),r.push(o.An());else if(c>0)break}r.push(t);const s=[];for(let o=0;o<r.length;o+=2){if(this.Zn(r[o],r[o+1]))return[];const a=r[o].Vn(this.uid,Gp,Se.empty()),c=r[o+1].Vn(this.uid,Gp,Se.empty());s.push(IDBKeyRange.bound(a,c))}return s}Zn(e,t){return ua(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(kA)}getMinOffset(e,t){return Z.mapArray(this.Mn(t),(i=>this.xn(e,i).next((r=>r||Me(44426))))).next(kA)}}function bA(n){return xn(n,ug)}function bu(n){return xn(n,Rf)}function qd(n){return xn(n,sS)}function ku(n){return xn(n,Tf)}function kA(n){Oe(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let i=1;i<n.length;i++){const r=n[i].indexState.offset;nS(r,e)<0&&(e=r),t<r.largestBatchId&&(t=r.largestBatchId)}return new sr(e.readTime,e.documentKey,t)}const LA={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},UL=41943040;class ii{static withCacheSize(e){return new ii(e,ii.DEFAULT_COLLECTION_PERCENTILE,ii.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}function BL(n,e,t){const i=n.store(Hr),r=n.store(Ih),s=[],o=IDBKeyRange.only(t.batchId);let a=0;const c=i.ee({range:o},((d,g,m)=>(a++,m.delete())));s.push(c.next((()=>{Oe(a===1,47070,{batchId:t.batchId})})));const h=[];for(const d of t.mutations){const g=Ok(e,d.key.path,t.batchId);s.push(r.delete(g)),h.push(d.key)}return Z.waitFor(s).next((()=>h))}function a_(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Me(14731);e=n.noDocument}return JSON.stringify(e).length}ii.DEFAULT_COLLECTION_PERCENTILE=10,ii.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ii.DEFAULT=new ii(UL,ii.DEFAULT_COLLECTION_PERCENTILE,ii.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ii.DISABLED=new ii(-1,0,0);class Ey{constructor(e,t,i,r){this.userId=e,this.serializer=t,this.indexManager=i,this.referenceDelegate=r,this.Xn={}}static wt(e,t,i,r){Oe(e.uid!=="",64387);const s=e.isAuthenticated()?e.uid:"";return new Ey(s,t,i,r)}checkEmpty(e){let t=!0;const i=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ha(e).ee({index:Xl,range:i},((r,s,o)=>{t=!1,o.done()})).next((()=>t))}addMutationBatch(e,t,i,r){const s=zu(e),o=ha(e);return o.add({}).next((a=>{Oe(typeof a=="number",49019);const c=new gS(a,t,i,r),h=(function(y,w,T){const E=T.baseMutations.map((M=>r_(y.yt,M))),P=T.mutations.map((M=>r_(y.yt,M)));return{userId:w,batchId:T.batchId,localWriteTimeMs:T.localWriteTime.toMillis(),baseMutations:E,mutations:P}})(this.serializer,this.userId,c),d=[];let g=new It(((m,y)=>qe(m.canonicalString(),y.canonicalString())));for(const m of r){const y=Ok(this.userId,m.key.path,a);g=g.add(m.key.path.popLast()),d.push(o.put(h)),d.push(s.put(y,J7))}return g.forEach((m=>{d.push(this.indexManager.addToCollectionParentIndex(e,m))})),e.addOnCommittedListener((()=>{this.Xn[a]=c.keys()})),Z.waitFor(d).next((()=>c))}))}lookupMutationBatch(e,t){return ha(e).get(t).next((i=>i?(Oe(i.userId===this.userId,48,"Unexpected user for mutation batch",{userId:i.userId,batchId:t}),zl(this.serializer,i)):null))}er(e,t){return this.Xn[t]?Z.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next((i=>{if(i){const r=i.keys();return this.Xn[t]=r,r}return null}))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=IDBKeyRange.lowerBound([this.userId,i]);let s=null;return ha(e).ee({index:Xl,range:r},((o,a,c)=>{a.userId===this.userId&&(Oe(a.batchId>=i,47524,{tr:i}),s=zl(this.serializer,a)),c.done()})).next((()=>s))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let i=ec;return ha(e).ee({index:Xl,range:t,reverse:!0},((r,s,o)=>{i=s.batchId,o.done()})).next((()=>i))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,ec],[this.userId,Number.POSITIVE_INFINITY]);return ha(e).J(Xl,t).next((i=>i.map((r=>zl(this.serializer,r)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const i=r0(this.userId,t.path),r=IDBKeyRange.lowerBound(i),s=[];return zu(e).ee({range:r},((o,a,c)=>{const[h,d,g]=o,m=Ps(d);if(h===this.userId&&t.path.isEqual(m))return ha(e).get(g).next((y=>{if(!y)throw Me(61480,{nr:o,batchId:g});Oe(y.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:y.userId,batchId:g}),s.push(zl(this.serializer,y))}));c.done()})).next((()=>s))}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new It(qe);const r=[];return t.forEach((s=>{const o=r0(this.userId,s.path),a=IDBKeyRange.lowerBound(o),c=zu(e).ee({range:a},((h,d,g)=>{const[m,y,w]=h,T=Ps(y);m===this.userId&&s.path.isEqual(T)?i=i.add(w):g.done()}));r.push(c)})),Z.waitFor(r).next((()=>this.rr(e,i)))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1,s=r0(this.userId,i),o=IDBKeyRange.lowerBound(s);let a=new It(qe);return zu(e).ee({range:o},((c,h,d)=>{const[g,m,y]=c,w=Ps(m);g===this.userId&&i.isPrefixOf(w)?w.length===r&&(a=a.add(y)):d.done()})).next((()=>this.rr(e,a)))}rr(e,t){const i=[],r=[];return t.forEach((s=>{r.push(ha(e).get(s).next((o=>{if(o===null)throw Me(35274,{batchId:s});Oe(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:s}),i.push(zl(this.serializer,o))})))})),Z.waitFor(r).next((()=>i))}removeMutationBatch(e,t){return BL(e.le,this.userId,t).next((i=>(e.addOnCommittedListener((()=>{this.ir(t.batchId)})),Z.forEach(i,(r=>this.referenceDelegate.markPotentiallyOrphaned(e,r))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return Z.resolve();const i=IDBKeyRange.lowerBound((function(o){return[o]})(this.userId)),r=[];return zu(e).ee({range:i},((s,o,a)=>{if(s[0]===this.userId){const c=Ps(s[1]);r.push(c)}else a.done()})).next((()=>{Oe(r.length===0,56720,{sr:r.map((s=>s.canonicalString()))})}))}))}containsKey(e,t){return zL(e,this.userId,t)}_r(e){return $L(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:ec,lastStreamToken:""}))}}function zL(n,e,t){const i=r0(e,t.path),r=i[1],s=IDBKeyRange.lowerBound(i);let o=!1;return zu(n).ee({range:s,X:!0},((a,c,h)=>{const[d,g,m]=a;d===e&&g===r&&(o=!0),h.done()})).next((()=>o))}function ha(n){return xn(n,Hr)}function zu(n){return xn(n,Ih)}function $L(n){return xn(n,lg)}class xc{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new xc(0)}static cr(){return new xc(-1)}}class RU{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next((t=>{const i=new xc(t.highestTargetId);return t.highestTargetId=i.next(),this.hr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((t=>De.fromTimestamp(new xt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,i){return this.lr(e).next((r=>(r.highestListenSequenceNumber=t,i&&(r.lastRemoteSnapshotVersion=i.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.hr(e,r))))}addTargetData(e,t){return this.Pr(e,t).next((()=>this.lr(e).next((i=>(i.targetCount+=1,this.Tr(t,i),this.hr(e,i))))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>Lu(e).delete(t.targetId))).next((()=>this.lr(e))).next((i=>(Oe(i.targetCount>0,8065),i.targetCount-=1,this.hr(e,i))))}removeTargets(e,t,i){let r=0;const s=[];return Lu(e).ee(((o,a)=>{const c=hf(a);c.sequenceNumber<=t&&i.get(c.targetId)===null&&(r++,s.push(this.removeTargetData(e,c)))})).next((()=>Z.waitFor(s))).next((()=>r))}forEachTarget(e,t){return Lu(e).ee(((i,r)=>{const s=hf(r);t(s)}))}lr(e){return NA(e).get(Z0).next((t=>(Oe(t!==null,2888),t)))}hr(e,t){return NA(e).put(Z0,t)}Pr(e,t){return Lu(e).put(VL(this.serializer,t))}Tr(e,t){let i=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,i=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,i=!0),i}getTargetCount(e){return this.lr(e).next((t=>t.targetCount))}getTargetData(e,t){const i=vc(t),r=IDBKeyRange.bound([i,Number.NEGATIVE_INFINITY],[i,Number.POSITIVE_INFINITY]);let s=null;return Lu(e).ee({range:r,index:Vk},((o,a,c)=>{const h=hf(a);Yg(t,h.target)&&(s=h,c.done())})).next((()=>s))}addMatchingKeys(e,t,i){const r=[],s=ya(e);return t.forEach((o=>{const a=ci(o.path);r.push(s.put({targetId:i,path:a})),r.push(this.referenceDelegate.addReference(e,i,o))})),Z.waitFor(r)}removeMatchingKeys(e,t,i){const r=ya(e);return Z.forEach(t,(s=>{const o=ci(s.path);return Z.waitFor([r.delete([i,o]),this.referenceDelegate.removeReference(e,i,s)])}))}removeMatchingKeysForTargetId(e,t){const i=ya(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return i.delete(r)}getMatchingKeysForTargetId(e,t){const i=IDBKeyRange.bound([t],[t+1],!1,!0),r=ya(e);let s=et();return r.ee({range:i,X:!0},((o,a,c)=>{const h=Ps(o[1]),d=new Se(h);s=s.add(d)})).next((()=>s))}containsKey(e,t){const i=ci(t.path),r=IDBKeyRange.bound([i],[Ak(i)],!1,!0);let s=0;return ya(e).ee({index:rS,X:!0,range:r},(([o,a],c,h)=>{o!==0&&(s++,h.done())})).next((()=>s>0))}At(e,t){return Lu(e).get(t).next((i=>i?hf(i):null))}}function Lu(n){return xn(n,Th)}function NA(n){return xn(n,tc)}function ya(n){return xn(n,Rh)}const OA="LruGarbageCollector",PU=1048576;function DA([n,e],[t,i]){const r=qe(n,t);return r===0?qe(e,i):r}class AU{constructor(e){this.Ir=e,this.buffer=new It(DA),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();DA(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class WL{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){pe(OA,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Ja(t)?pe(OA,"Ignoring IndexedDB error during garbage collection: ",t):await Oc(t)}await this.Vr(3e5)}))}}class CU{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return Z.resolve(Cr.ce);const i=new AU(t);return this.mr.forEachTarget(e,(r=>i.Ar(r.sequenceNumber))).next((()=>this.mr.pr(e,(r=>i.Ar(r))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.mr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(pe("LruGarbageCollector","Garbage collection skipped; disabled"),Z.resolve(LA)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(pe("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),LA):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let i,r,s,o,a,c,h;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((g=>(g>this.params.maximumSequenceNumbersToCollect?(pe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${g}`),r=this.params.maximumSequenceNumbersToCollect):r=g,o=Date.now(),this.nthSequenceNumber(e,r)))).next((g=>(i=g,a=Date.now(),this.removeTargets(e,i,t)))).next((g=>(s=g,c=Date.now(),this.removeOrphanedDocuments(e,i)))).next((g=>(h=Date.now(),Gu()<=nt.DEBUG&&pe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${r} in `+(a-o)+`ms
	Removed ${s} targets in `+(c-a)+`ms
	Removed ${g} documents in `+(h-c)+`ms
Total Duration: ${h-d}ms`),Z.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:g}))))}}function HL(n,e){return new CU(n,e)}class MU{constructor(e,t){this.db=e,this.garbageCollector=HL(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((i=>t.next((r=>i+r))))}wr(e){let t=0;return this.pr(e,(i=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,((i,r)=>t(r)))}addReference(e,t,i){return jp(e,i)}removeReference(e,t,i){return jp(e,i)}removeTargets(e,t,i){return this.db.getTargetCache().removeTargets(e,t,i)}markPotentiallyOrphaned(e,t){return jp(e,t)}br(e,t){return(function(r,s){let o=!1;return $L(r).te((a=>zL(r,a,s).next((c=>(c&&(o=!0),Z.resolve(!c)))))).next((()=>o))})(e,t)}removeOrphanedDocuments(e,t){const i=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let s=0;return this.Sr(e,((o,a)=>{if(a<=t){const c=this.br(e,o).next((h=>{if(!h)return s++,i.getEntry(e,o).next((()=>(i.removeEntry(o,De.min()),ya(e).delete((function(g){return[0,ci(g.path)]})(o)))))}));r.push(c)}})).next((()=>Z.waitFor(r))).next((()=>i.apply(e))).next((()=>s))}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,i)}updateLimboDocument(e,t){return jp(e,t)}Sr(e,t){const i=ya(e);let r,s=Cr.ce;return i.ee({index:rS},(([o,a],{path:c,sequenceNumber:h})=>{o===0?(s!==Cr.ce&&t(new Se(Ps(r)),s),s=h,r=c):s=Cr.ce})).next((()=>{s!==Cr.ce&&t(new Se(Ps(r)),s)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function jp(n,e){return ya(n).put((function(i,r){return{targetId:0,path:ci(i.path),sequenceNumber:r}})(e,n.currentSequenceNumber))}class KL{constructor(){this.changes=new bo((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Jt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?Z.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class bU{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,i){return Ml(e).put(i)}removeEntry(e,t,i){return Ml(e).delete((function(s,o){const a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],s_(o),a[a.length-1]]})(t,i))}updateMetadata(e,t){return this.getMetadata(e).next((i=>(i.byteSize+=t,this.Dr(e,i))))}getEntry(e,t){let i=Jt.newInvalidDocument(t);return Ml(e).ee({index:s0,range:IDBKeyRange.only(Yd(t))},((r,s)=>{i=this.Cr(t,s)})).next((()=>i))}vr(e,t){let i={size:0,document:Jt.newInvalidDocument(t)};return Ml(e).ee({index:s0,range:IDBKeyRange.only(Yd(t))},((r,s)=>{i={document:this.Cr(t,s),size:a_(s)}})).next((()=>i))}getEntries(e,t){let i=tr();return this.Fr(e,t,((r,s)=>{const o=this.Cr(r,s);i=i.insert(r,o)})).next((()=>i))}Mr(e,t){let i=tr(),r=new zt(Se.comparator);return this.Fr(e,t,((s,o)=>{const a=this.Cr(s,o);i=i.insert(s,a),r=r.insert(s,a_(o))})).next((()=>({documents:i,Or:r})))}Fr(e,t,i){if(t.isEmpty())return Z.resolve();let r=new It(GA);t.forEach((c=>r=r.add(c)));const s=IDBKeyRange.bound(Yd(r.first()),Yd(r.last())),o=r.getIterator();let a=o.getNext();return Ml(e).ee({index:s0,range:s},((c,h,d)=>{const g=Se.fromSegments([...h.prefixPath,h.collectionGroup,h.documentId]);for(;a&&GA(a,g)<0;)i(a,null),a=o.getNext();a&&a.isEqual(g)&&(i(a,h),a=o.hasNext()?o.getNext():null),a?d.j(Yd(a)):d.done()})).next((()=>{for(;a;)i(a,null),a=o.hasNext()?o.getNext():null}))}getDocumentsMatchingQuery(e,t,i,r,s){const o=t.path,a=[o.popLast().toArray(),o.lastSegment(),s_(i.readTime),i.documentKey.path.isEmpty()?"":i.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Ml(e).J(IDBKeyRange.bound(a,c,!0)).next((h=>{s?.incrementDocumentReadCount(h.length);let d=tr();for(const g of h){const m=this.Cr(Se.fromSegments(g.prefixPath.concat(g.collectionGroup,g.documentId)),g);m.isFoundDocument()&&(Qg(t,m)||r.has(m.key))&&(d=d.insert(m.key,m))}return d}))}getAllFromCollectionGroup(e,t,i,r){let s=tr();const o=FA(t,i),a=FA(t,sr.max());return Ml(e).ee({index:Dk,range:IDBKeyRange.bound(o,a,!0)},((c,h,d)=>{const g=this.Cr(Se.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);s=s.insert(g.key,g),s.size===r&&d.done()})).next((()=>s))}newChangeBuffer(e){return new kU(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return VA(e).get(sw).next((t=>(Oe(!!t,20021),t)))}Dr(e,t){return VA(e).put(sw,t)}Cr(e,t){if(t){const i=pU(this.serializer,t);if(!(i.isNoDocument()&&i.version.isEqual(De.min())))return i}return Jt.newInvalidDocument(e)}}function qL(n){return new bU(n)}class kU extends KL{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new bo((i=>i.toString()),((i,r)=>i.isEqual(r)))}applyChanges(e){const t=[];let i=0,r=new It(((s,o)=>qe(s.canonicalString(),o.canonicalString())));return this.changes.forEach(((s,o)=>{const a=this.Br.get(s);if(t.push(this.Nr.removeEntry(e,s,a.readTime)),o.isValidDocument()){const c=EA(this.Nr.serializer,o);r=r.add(s.path.popLast());const h=a_(c);i+=h-a.size,t.push(this.Nr.addEntry(e,s,c))}else if(i-=a.size,this.trackRemovals){const c=EA(this.Nr.serializer,o.convertToNoDocument(De.min()));t.push(this.Nr.addEntry(e,s,c))}})),r.forEach((s=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,s))})),t.push(this.Nr.updateMetadata(e,i)),Z.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next((i=>(this.Br.set(t,{size:i.size,readTime:i.document.readTime}),i.document)))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next((({documents:i,Or:r})=>(r.forEach(((s,o)=>{this.Br.set(s,{size:o,readTime:i.get(s).readTime})})),i)))}}function VA(n){return xn(n,cg)}function Ml(n){return xn(n,Q0)}function Yd(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function FA(n,e){const t=e.documentKey.path.toArray();return[n,s_(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function GA(n,e){const t=n.path.toArray(),i=e.path.toArray();let r=0;for(let s=0;s<t.length-2&&s<i.length-2;++s)if(r=qe(t[s],i[s]),r)return r;return r=qe(t.length,i.length),r||(r=qe(t[t.length-2],i[i.length-2]),r||qe(t[t.length-1],i[i.length-1]))}class LU{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class YL{constructor(e,t,i,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(i=r,this.remoteDocumentCache.getEntry(e,t)))).next((r=>(i!==null&&Mf(i.mutation,r,Fi.empty(),xt.now()),r)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,et()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=et()){const r=As();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,i).next((s=>{let o=cf();return s.forEach(((a,c)=>{o=o.insert(a,c.overlayedDocument)})),o}))))}getOverlayedDocuments(e,t){const i=As();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,et())))}populateOverlays(e,t,i){const r=[];return i.forEach((s=>{t.has(s)||r.push(s)})),this.documentOverlayCache.getOverlays(e,r).next((s=>{s.forEach(((o,a)=>{t.set(o,a)}))}))}computeViews(e,t,i,r){let s=tr();const o=Cf(),a=(function(){return Cf()})();return t.forEach(((c,h)=>{const d=i.get(h.key);r.has(h.key)&&(d===void 0||d.mutation instanceof ko)?s=s.insert(h.key,h):d!==void 0?(o.set(h.key,d.mutation.getFieldMask()),Mf(d.mutation,h,d.mutation.getFieldMask(),xt.now())):o.set(h.key,Fi.empty())})),this.recalculateAndSaveOverlays(e,s).next((c=>(c.forEach(((h,d)=>o.set(h,d))),t.forEach(((h,d)=>a.set(h,new LU(d,o.get(h)??null)))),a)))}recalculateAndSaveOverlays(e,t){const i=Cf();let r=new zt(((o,a)=>o-a)),s=et();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((o=>{for(const a of o)a.keys().forEach((c=>{const h=t.get(c);if(h===null)return;let d=i.get(c)||Fi.empty();d=a.applyToLocalView(h,d),i.set(c,d);const g=(r.get(a.batchId)||et()).add(c);r=r.insert(a.batchId,g)}))})).next((()=>{const o=[],a=r.getReverseIterator();for(;a.hasNext();){const c=a.getNext(),h=c.key,d=c.value,g=fL();d.forEach((m=>{if(!s.has(m)){const y=vL(t.get(m),i.get(m));y!==null&&g.set(m,y),s=s.add(m)}})),o.push(this.documentOverlayCache.saveOverlays(e,h,g))}return Z.waitFor(o)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,r){return(function(o){return Se.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):lL(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,r):this.getDocumentsMatchingCollectionQuery(e,t,i,r)}getNextDocuments(e,t,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,r).next((s=>{const o=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,r-s.size):Z.resolve(As());let a=sg,c=s;return o.next((h=>Z.forEach(h,((d,g)=>(a<g.largestBatchId&&(a=g.largestBatchId),s.get(d)?Z.resolve():this.remoteDocumentCache.getEntry(e,d).next((m=>{c=c.insert(d,m)}))))).next((()=>this.populateOverlays(e,h,s))).next((()=>this.computeViews(e,c,h,et()))).next((d=>({batchId:a,changes:dL(d)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Se(t)).next((i=>{let r=cf();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,r){const s=t.collectionGroup;let o=cf();return this.indexManager.getCollectionParents(e,s).next((a=>Z.forEach(a,(c=>{const h=(function(g,m){return new Xg(m,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)})(t,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,h,i,r).next((d=>{d.forEach(((g,m)=>{o=o.insert(g,m)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,t,i,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,s,r)))).next((o=>{s.forEach(((c,h)=>{const d=h.getKey();o.get(d)===null&&(o=o.insert(d,Jt.newInvalidDocument(d)))}));let a=cf();return o.forEach(((c,h)=>{const d=s.get(c);d!==void 0&&Mf(d.mutation,h,Fi.empty(),xt.now()),Qg(t,h)&&(a=a.insert(c,h))})),a}))}}class NU{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return Z.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(r){return{id:r.id,version:r.version,createTime:wi(r.createTime)}})(t)),Z.resolve()}getNamedQuery(e,t){return Z.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(r){return{name:r.name,query:FL(r.bundledQuery),readTime:wi(r.readTime)}})(t)),Z.resolve()}}class OU{constructor(){this.overlays=new zt(Se.comparator),this.qr=new Map}getOverlay(e,t){return Z.resolve(this.overlays.get(t))}getOverlays(e,t){const i=As();return Z.forEach(t,(r=>this.getOverlay(e,r).next((s=>{s!==null&&i.set(r,s)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((r,s)=>{this.St(e,t,s)})),Z.resolve()}removeOverlaysForBatchId(e,t,i){const r=this.qr.get(i);return r!==void 0&&(r.forEach((s=>this.overlays=this.overlays.remove(s))),this.qr.delete(i)),Z.resolve()}getOverlaysForCollection(e,t,i){const r=As(),s=t.length+1,o=new Se(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const c=a.getNext().value,h=c.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===s&&c.largestBatchId>i&&r.set(c.getKey(),c)}return Z.resolve(r)}getOverlaysForCollectionGroup(e,t,i,r){let s=new zt(((h,d)=>h-d));const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>i){let d=s.get(h.largestBatchId);d===null&&(d=As(),s=s.insert(h.largestBatchId,d)),d.set(h.getKey(),h)}}const a=As(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach(((h,d)=>a.set(h,d))),!(a.size()>=r)););return Z.resolve(a)}St(e,t,i){const r=this.overlays.get(i.key);if(r!==null){const o=this.qr.get(r.largestBatchId).delete(i.key);this.qr.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(i.key,new pS(t,i));let s=this.qr.get(t);s===void 0&&(s=et(),this.qr.set(t,s)),this.qr.set(t,s.add(i.key))}}class DU{constructor(){this.sessionToken=gn.EMPTY_BYTE_STRING}getSessionToken(e){return Z.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Z.resolve()}}class wS{constructor(){this.Qr=new It(Cn.$r),this.Ur=new It(Cn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const i=new Cn(e,t);this.Qr=this.Qr.add(i),this.Ur=this.Ur.add(i)}Wr(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Gr(new Cn(e,t))}zr(e,t){e.forEach((i=>this.removeReference(i,t)))}jr(e){const t=new Se(new mt([])),i=new Cn(t,e),r=new Cn(t,e+1),s=[];return this.Ur.forEachInRange([i,r],(o=>{this.Gr(o),s.push(o.key)})),s}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new Se(new mt([])),i=new Cn(t,e),r=new Cn(t,e+1);let s=et();return this.Ur.forEachInRange([i,r],(o=>{s=s.add(o.key)})),s}containsKey(e){const t=new Cn(e,0),i=this.Qr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class Cn{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return Se.comparator(e.key,t.key)||qe(e.Yr,t.Yr)}static Kr(e,t){return qe(e.Yr,t.Yr)||Se.comparator(e.key,t.key)}}class VU{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new It(Cn.$r)}checkEmpty(e){return Z.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,r){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new gS(s,t,i,r);this.mutationQueue.push(o);for(const a of r)this.Zr=this.Zr.add(new Cn(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return Z.resolve(o)}lookupMutationBatch(e,t){return Z.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=this.ei(i),s=r<0?0:r;return Z.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return Z.resolve(this.mutationQueue.length===0?ec:this.tr-1)}getAllMutationBatches(e){return Z.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new Cn(t,0),r=new Cn(t,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([i,r],(o=>{const a=this.Xr(o.Yr);s.push(a)})),Z.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new It(qe);return t.forEach((r=>{const s=new Cn(r,0),o=new Cn(r,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,o],(a=>{i=i.add(a.Yr)}))})),Z.resolve(this.ti(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1;let s=i;Se.isDocumentKey(s)||(s=s.child(""));const o=new Cn(new Se(s),0);let a=new It(qe);return this.Zr.forEachWhile((c=>{const h=c.key.path;return!!i.isPrefixOf(h)&&(h.length===r&&(a=a.add(c.Yr)),!0)}),o),Z.resolve(this.ti(a))}ti(e){const t=[];return e.forEach((i=>{const r=this.Xr(i);r!==null&&t.push(r)})),t}removeMutationBatch(e,t){Oe(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Zr;return Z.forEach(t.mutations,(r=>{const s=new Cn(r.key,t.batchId);return i=i.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.Zr=i}))}ir(e){}containsKey(e,t){const i=new Cn(t,0),r=this.Zr.firstAfterOrEqual(i);return Z.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,Z.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class FU{constructor(e){this.ri=e,this.docs=(function(){return new zt(Se.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,r=this.docs.get(i),s=r?r.size:0,o=this.ri(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return Z.resolve(i?i.document.mutableCopy():Jt.newInvalidDocument(t))}getEntries(e,t){let i=tr();return t.forEach((r=>{const s=this.docs.get(r);i=i.insert(r,s?s.document.mutableCopy():Jt.newInvalidDocument(r))})),Z.resolve(i)}getDocumentsMatchingQuery(e,t,i,r){let s=tr();const o=t.path,a=new Se(o.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){const{key:h,value:{document:d}}=c.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||nS(bk(d),i)<=0||(r.has(d.key)||Qg(t,d))&&(s=s.insert(d.key,d.mutableCopy()))}return Z.resolve(s)}getAllFromCollectionGroup(e,t,i,r){Me(9500)}ii(e,t){return Z.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new GU(this)}getSize(e){return Z.resolve(this.size)}}class GU extends KL{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(i)})),Z.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class jU{constructor(e){this.persistence=e,this.si=new bo((t=>vc(t)),Yg),this.lastRemoteSnapshotVersion=De.min(),this.highestTargetId=0,this.oi=0,this._i=new wS,this.targetCount=0,this.ai=xc.ur()}forEachTarget(e,t){return this.si.forEach(((i,r)=>t(r))),Z.resolve()}getLastRemoteSnapshotVersion(e){return Z.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Z.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),Z.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.oi&&(this.oi=t),Z.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new xc(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,Z.resolve()}updateTargetData(e,t){return this.Pr(t),Z.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,Z.resolve()}removeTargets(e,t,i){let r=0;const s=[];return this.si.forEach(((o,a)=>{a.sequenceNumber<=t&&i.get(a.targetId)===null&&(this.si.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),r++)})),Z.waitFor(s).next((()=>r))}getTargetCount(e){return Z.resolve(this.targetCount)}getTargetData(e,t){const i=this.si.get(t)||null;return Z.resolve(i)}addMatchingKeys(e,t,i){return this._i.Wr(t,i),Z.resolve()}removeMatchingKeys(e,t,i){this._i.zr(t,i);const r=this.persistence.referenceDelegate,s=[];return r&&t.forEach((o=>{s.push(r.markPotentiallyOrphaned(e,o))})),Z.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),Z.resolve()}getMatchingKeysForTargetId(e,t){const i=this._i.Hr(t);return Z.resolve(i)}containsKey(e,t){return Z.resolve(this._i.containsKey(t))}}class xS{constructor(e,t){this.ui={},this.overlays={},this.ci=new Cr(0),this.li=!1,this.li=!0,this.hi=new DU,this.referenceDelegate=e(this),this.Pi=new jU(this),this.indexManager=new IU,this.remoteDocumentCache=(function(r){return new FU(r)})((i=>this.referenceDelegate.Ti(i))),this.serializer=new DL(t),this.Ii=new NU(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new OU,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.ui[e.toKey()];return i||(i=new VU(t,this.referenceDelegate),this.ui[e.toKey()]=i),i}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,i){pe("MemoryPersistence","Starting transaction:",e);const r=new UU(this.ci.next());return this.referenceDelegate.Ei(),i(r).next((s=>this.referenceDelegate.di(r).next((()=>s)))).toPromise().then((s=>(r.raiseOnCommittedEvent(),s)))}Ai(e,t){return Z.or(Object.values(this.ui).map((i=>()=>i.containsKey(e,t))))}}class UU extends Lk{constructor(e){super(),this.currentSequenceNumber=e}}class wy{constructor(e){this.persistence=e,this.Ri=new wS,this.Vi=null}static mi(e){return new wy(e)}get fi(){if(this.Vi)return this.Vi;throw Me(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.fi.delete(i.toString()),Z.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.fi.add(i.toString()),Z.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),Z.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((r=>this.fi.add(r.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((r=>{r.forEach((s=>this.fi.add(s.toString())))})).next((()=>i.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Z.forEach(this.fi,(i=>{const r=Se.fromPath(i);return this.gi(e,r).next((s=>{s||t.removeEntry(r,De.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((i=>{i?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return Z.or([()=>Z.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class l_{constructor(e,t){this.persistence=e,this.pi=new bo((i=>ci(i.path)),((i,r)=>i.isEqual(r))),this.garbageCollector=HL(this,t)}static mi(e,t){return new l_(e,t)}Ei(){}di(e){return Z.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((r=>i+r))))}wr(e){let t=0;return this.pr(e,(i=>{t++})).next((()=>t))}pr(e,t){return Z.forEach(this.pi,((i,r)=>this.br(e,i,r).next((s=>s?Z.resolve():t(r)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const r=this.persistence.getRemoteDocumentCache(),s=r.newChangeBuffer();return r.ii(e,(o=>this.br(e,o,t).next((a=>{a||(i++,s.removeEntry(o,De.min()))})))).next((()=>s.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),Z.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.pi.set(i,e.currentSequenceNumber),Z.resolve()}removeReference(e,t,i){return this.pi.set(i,e.currentSequenceNumber),Z.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),Z.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=a0(e.data.value)),t}br(e,t,i){return Z.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const r=this.pi.get(t);return Z.resolve(r!==void 0&&r>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class BU{constructor(e){this.serializer=e}k(e,t,i,r){const s=new ay("createOrUpgrade",t);i<1&&r>=1&&((function(c){c.createObjectStore(qg)})(e),(function(c){c.createObjectStore(lg,{keyPath:Z7}),c.createObjectStore(Hr,{keyPath:XP,autoIncrement:!0}).createIndex(Xl,QP,{unique:!0}),c.createObjectStore(Ih)})(e),jA(e),(function(c){c.createObjectStore(Vl)})(e));let o=Z.resolve();return i<3&&r>=3&&(i!==0&&((function(c){c.deleteObjectStore(Rh),c.deleteObjectStore(Th),c.deleteObjectStore(tc)})(e),jA(e)),o=o.next((()=>(function(c){const h=c.store(tc),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:De.min().toTimestamp(),targetCount:0};return h.put(Z0,d)})(s)))),i<4&&r>=4&&(i!==0&&(o=o.next((()=>(function(c,h){return h.store(Hr).J().next((g=>{c.deleteObjectStore(Hr),c.createObjectStore(Hr,{keyPath:XP,autoIncrement:!0}).createIndex(Xl,QP,{unique:!0});const m=h.store(Hr),y=g.map((w=>m.put(w)));return Z.waitFor(y)}))})(e,s)))),o=o.next((()=>{(function(c){c.createObjectStore(Ph,{keyPath:aj})})(e)}))),i<5&&r>=5&&(o=o.next((()=>this.yi(s)))),i<6&&r>=6&&(o=o.next((()=>((function(c){c.createObjectStore(cg)})(e),this.wi(s))))),i<7&&r>=7&&(o=o.next((()=>this.Si(s)))),i<8&&r>=8&&(o=o.next((()=>this.bi(e,s)))),i<9&&r>=9&&(o=o.next((()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)}))),i<10&&r>=10&&(o=o.next((()=>this.Di(s)))),i<11&&r>=11&&(o=o.next((()=>{(function(c){c.createObjectStore(cy,{keyPath:lj})})(e),(function(c){c.createObjectStore(uy,{keyPath:cj})})(e)}))),i<12&&r>=12&&(o=o.next((()=>{(function(c){const h=c.createObjectStore(hy,{keyPath:pj});h.createIndex(aw,_j,{unique:!1}),h.createIndex(jk,yj,{unique:!1})})(e)}))),i<13&&r>=13&&(o=o.next((()=>(function(c){const h=c.createObjectStore(Q0,{keyPath:ej});h.createIndex(s0,tj),h.createIndex(Dk,nj)})(e))).next((()=>this.Ci(e,s))).next((()=>e.deleteObjectStore(Vl)))),i<14&&r>=14&&(o=o.next((()=>this.Fi(e,s)))),i<15&&r>=15&&(o=o.next((()=>(function(c){c.createObjectStore(sS,{keyPath:uj,autoIncrement:!0}).createIndex(ow,hj,{unique:!1}),c.createObjectStore(Tf,{keyPath:dj}).createIndex(Fk,fj,{unique:!1}),c.createObjectStore(Rf,{keyPath:gj}).createIndex(Gk,mj,{unique:!1})})(e)))),i<16&&r>=16&&(o=o.next((()=>{t.objectStore(Tf).clear()})).next((()=>{t.objectStore(Rf).clear()}))),i<17&&r>=17&&(o=o.next((()=>{(function(c){c.createObjectStore(oS,{keyPath:vj})})(e)}))),i<18&&r>=18&&fk()&&(o=o.next((()=>{t.objectStore(Tf).clear()})).next((()=>{t.objectStore(Rf).clear()}))),o}wi(e){let t=0;return e.store(Vl).ee(((i,r)=>{t+=a_(r)})).next((()=>{const i={byteSize:t};return e.store(cg).put(sw,i)}))}yi(e){const t=e.store(lg),i=e.store(Hr);return t.J().next((r=>Z.forEach(r,(s=>{const o=IDBKeyRange.bound([s.userId,ec],[s.userId,s.lastAcknowledgedBatchId]);return i.J(Xl,o).next((a=>Z.forEach(a,(c=>{Oe(c.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:c.batchId});const h=zl(this.serializer,c);return BL(e,s.userId,h).next((()=>{}))}))))}))))}Si(e){const t=e.store(Rh),i=e.store(Vl);return e.store(tc).get(Z0).next((r=>{const s=[];return i.ee(((o,a)=>{const c=new mt(o),h=(function(g){return[0,ci(g)]})(c);s.push(t.get(h).next((d=>d?Z.resolve():(g=>t.put({targetId:0,path:ci(g),sequenceNumber:r.highestListenSequenceNumber}))(c))))})).next((()=>Z.waitFor(s)))}))}bi(e,t){e.createObjectStore(ug,{keyPath:oj});const i=t.store(ug),r=new ES,s=o=>{if(r.add(o)){const a=o.lastSegment(),c=o.popLast();return i.put({collectionId:a,parent:ci(c)})}};return t.store(Vl).ee({X:!0},((o,a)=>{const c=new mt(o);return s(c.popLast())})).next((()=>t.store(Ih).ee({X:!0},(([o,a,c],h)=>{const d=Ps(a);return s(d.popLast())}))))}Di(e){const t=e.store(Th);return t.ee(((i,r)=>{const s=hf(r),o=VL(this.serializer,s);return t.put(o)}))}Ci(e,t){const i=t.store(Vl),r=[];return i.ee(((s,o)=>{const a=t.store(Q0),c=(function(g){return g.document?new Se(mt.fromString(g.document.name).popFirst(5)):g.noDocument?Se.fromSegments(g.noDocument.path):g.unknownDocument?Se.fromSegments(g.unknownDocument.path):Me(36783)})(o).path.toArray(),h={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};r.push(a.put(h))})).next((()=>Z.waitFor(r)))}Fi(e,t){const i=t.store(Hr),r=qL(this.serializer),s=new xS(wy.mi,this.serializer.yt);return i.J().next((o=>{const a=new Map;return o.forEach((c=>{let h=a.get(c.userId)??et();zl(this.serializer,c).keys().forEach((d=>h=h.add(d))),a.set(c.userId,h)})),Z.forEach(a,((c,h)=>{const d=new $n(h),g=vy.wt(this.serializer,d),m=s.getIndexManager(d),y=Ey.wt(d,this.serializer,m,s.referenceDelegate);return new YL(r,y,g,m).recalculateAndSaveOverlaysForDocumentKeys(new lw(t,Cr.ce),c).next()}))}))}}function jA(n){n.createObjectStore(Rh,{keyPath:rj}).createIndex(rS,sj,{unique:!0}),n.createObjectStore(Th,{keyPath:"targetId"}).createIndex(Vk,ij,{unique:!0}),n.createObjectStore(tc)}const da="IndexedDbPersistence",Q1=18e5,Z1=5e3,J1="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",zU="main";class SS{constructor(e,t,i,r,s,o,a,c,h,d,g=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=i,this.Mi=s,this.window=o,this.document=a,this.xi=h,this.Oi=d,this.Ni=g,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=m=>Promise.resolve(),!SS.v())throw new xe(ae.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new MU(this,r),this.$i=t+zU,this.serializer=new DL(c),this.Ui=new Da(this.$i,this.Ni,new BU(this.serializer)),this.hi=new yU,this.Pi=new RU(this.referenceDelegate,this.serializer),this.remoteDocumentCache=qL(this.serializer),this.Ii=new _U,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,d===!1&&_i(da,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new xe(ae.FAILED_PRECONDITION,J1);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new Cr(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>Up(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((t=>this.isPrimary&&!t?this.Zi(e).next((()=>!1)):!!t&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(Ja(e))return pe(da,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return pe(da,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return Xd(e).get(Au).next((t=>Z.resolve(this.es(t))))}ts(e){return Up(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,Q1)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const i=xn(t,Ph);return i.J().next((r=>{const s=this.ss(r,Q1),o=r.filter((a=>s.indexOf(a)===-1));return Z.forEach(o,(a=>i.delete(a.clientId))).next((()=>o))}))})).catch((()=>[]));if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?Z.resolve(!0):Xd(e).get(Au).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,Z1)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new xe(ae.FAILED_PRECONDITION,J1);return!1}}return!(!this.networkEnabled||!this.inForeground)||Up(e).J().next((i=>this.ss(i,Z1).find((r=>{if(this.clientId!==r.clientId){const s=!this.networkEnabled&&r.networkEnabled,o=!this.inForeground&&r.inForeground,a=this.networkEnabled===r.networkEnabled;if(s||o&&a)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&pe(da,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[qg,Ph],(e=>{const t=new lw(e,Cr.ce);return this.Zi(t).next((()=>this.ts(t)))})),this.Ui.close(),this.Ps()}ss(e,t){return e.filter((i=>this.rs(i.updateTimeMs,t)&&!this.us(i.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>Up(e).J().next((t=>this.ss(t,Q1).map((i=>i.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return Ey.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new TU(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return vy.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,i){pe(da,"Starting transaction:",e);const r=t==="readonly"?"readonly":"readwrite",s=(function(c){return c===18?xj:c===17?$k:c===16?wj:c===15?aS:c===14?zk:c===13?Bk:c===12?Ej:c===11?Uk:void Me(60245)})(this.Ni);let o;return this.Ui.runTransaction(e,r,s,(a=>(o=new lw(a,this.ci?this.ci.next():Cr.ce),t==="readwrite-primary"?this.Hi(o).next((c=>!!c||this.Yi(o))).next((c=>{if(!c)throw _i(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new xe(ae.FAILED_PRECONDITION,kk);return i(o)})).next((c=>this.Xi(o).next((()=>c)))):this.Is(o).next((()=>i(o)))))).then((a=>(o.raiseOnCommittedEvent(),a)))}Is(e){return Xd(e).get(Au).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,Z1)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new xe(ae.FAILED_PRECONDITION,J1)}))}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Xd(e).put(Au,t)}static v(){return Da.v()}Zi(e){const t=Xd(e);return t.get(Au).next((i=>this.es(i)?(pe(da,"Releasing primary lease."),t.delete(Au)):Z.resolve()))}rs(e,t){const i=Date.now();return!(e<i-t)&&(!(e>i)||(_i(`Detected an update time that is in the future: ${e} > ${i}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){typeof this.window?.addEventListener=="function"&&(this.Bi=()=>{this.cs();const e=/(?:Version|Mobile)\/1[456]/;dk()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){try{const t=this.Ki?.getItem(this._s(e))!==null;return pe(da,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return _i(da,"Failed to get zombied client id.",t),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){_i("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Xd(n){return xn(n,qg)}function Up(n){return xn(n,Ph)}function $U(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class IS{constructor(e,t,i,r){this.targetId=e,this.fromCache=t,this.Es=i,this.ds=r}static As(e,t){let i=et(),r=et();for(const s of t.docChanges)switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new IS(e,t.fromCache,i,r)}}class WU{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class XL{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return dk()?8:Nk(wn())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,r){const s={result:null};return this.ys(e,t).next((o=>{s.result=o})).next((()=>{if(!s.result)return this.ws(e,t,r,i).next((o=>{s.result=o}))})).next((()=>{if(s.result)return;const o=new WU;return this.Ss(e,t,o).next((a=>{if(s.result=a,this.Vs)return this.bs(e,t,o,a.size)}))})).next((()=>s.result))}bs(e,t,i,r){return i.documentReadCount<this.fs?(Gu()<=nt.DEBUG&&pe("QueryEngine","SDK will not create cache indexes for query:",ju(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),Z.resolve()):(Gu()<=nt.DEBUG&&pe("QueryEngine","Query:",ju(t),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.gs*r?(Gu()<=nt.DEBUG&&pe("QueryEngine","The SDK decides to create cache indexes for query:",ju(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,br(t))):Z.resolve())}ys(e,t){if(uA(t))return Z.resolve(null);let i=br(t);return this.indexManager.getIndexType(e,i).next((r=>r===0?null:(t.limit!==null&&r===1&&(t=mw(t,null,"F"),i=br(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((s=>{const o=et(...s);return this.ps.getDocuments(e,o).next((a=>this.indexManager.getMinOffset(e,i).next((c=>{const h=this.Ds(t,a);return this.Cs(t,h,o,c.readTime)?this.ys(e,mw(t,null,"F")):this.vs(e,h,t,c)}))))})))))}ws(e,t,i,r){return uA(t)||r.isEqual(De.min())?Z.resolve(null):this.ps.getDocuments(e,i).next((s=>{const o=this.Ds(t,s);return this.Cs(t,o,i,r)?Z.resolve(null):(Gu()<=nt.DEBUG&&pe("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),ju(t)),this.vs(e,o,t,W7(r,sg)).next((a=>a)))}))}Ds(e,t){let i=new It(uL(e));return t.forEach(((r,s)=>{Qg(e,s)&&(i=i.add(s))})),i}Cs(e,t,i,r){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}Ss(e,t,i){return Gu()<=nt.DEBUG&&pe("QueryEngine","Using full collection scan to execute query:",ju(t)),this.ps.getDocumentsMatchingQuery(e,t,sr.min(),i)}vs(e,t,i,r){return this.ps.getDocumentsMatchingQuery(e,i,r).next((s=>(t.forEach((o=>{s=s.insert(o.key,o)})),s)))}}const TS="LocalStore",HU=3e8;class KU{constructor(e,t,i,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new zt(qe),this.xs=new bo((s=>vc(s)),Yg),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(i)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new YL(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function QL(n,e,t,i){return new KU(n,e,t,i)}async function ZL(n,e){const t=Ye(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let r;return t.mutationQueue.getAllMutationBatches(i).next((s=>(r=s,t.Bs(e),t.mutationQueue.getAllMutationBatches(i)))).next((s=>{const o=[],a=[];let c=et();for(const h of r){o.push(h.batchId);for(const d of h.mutations)c=c.add(d.key)}for(const h of s){a.push(h.batchId);for(const d of h.mutations)c=c.add(d.key)}return t.localDocuments.getDocuments(i,c).next((h=>({Ls:h,removedBatchIds:o,addedBatchIds:a})))}))}))}function qU(n,e){const t=Ye(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const r=e.batch.keys(),s=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(a,c,h,d){const g=h.batch,m=g.keys();let y=Z.resolve();return m.forEach((w=>{y=y.next((()=>d.getEntry(c,w))).next((T=>{const E=h.docVersions.get(w);Oe(E!==null,48541),T.version.compareTo(E)<0&&(g.applyToRemoteDocument(T,h),T.isValidDocument()&&(T.setReadTime(h.commitVersion),d.addEntry(T)))}))})),y.next((()=>a.mutationQueue.removeMutationBatch(c,g)))})(t,i,e,s).next((()=>s.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(a){let c=et();for(let h=0;h<a.mutationResults.length;++h)a.mutationResults[h].transformResults.length>0&&(c=c.add(a.batch.mutations[h].key));return c})(e)))).next((()=>t.localDocuments.getDocuments(i,r)))}))}function JL(n){const e=Ye(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function YU(n,e){const t=Ye(n),i=e.snapshotVersion;let r=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(s=>{const o=t.Ns.newChangeBuffer({trackRemovals:!0});r=t.Ms;const a=[];e.targetChanges.forEach(((d,g)=>{const m=r.get(g);if(!m)return;a.push(t.Pi.removeMatchingKeys(s,d.removedDocuments,g).next((()=>t.Pi.addMatchingKeys(s,d.addedDocuments,g))));let y=m.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(g)!==null?y=y.withResumeToken(gn.EMPTY_BYTE_STRING,De.min()).withLastLimboFreeSnapshotVersion(De.min()):d.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(d.resumeToken,i)),r=r.insert(g,y),(function(T,E,P){return T.resumeToken.approximateByteSize()===0||E.snapshotVersion.toMicroseconds()-T.snapshotVersion.toMicroseconds()>=HU?!0:P.addedDocuments.size+P.modifiedDocuments.size+P.removedDocuments.size>0})(m,y,d)&&a.push(t.Pi.updateTargetData(s,y))}));let c=tr(),h=et();if(e.documentUpdates.forEach((d=>{e.resolvedLimboDocuments.has(d)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,d))})),a.push(XU(s,o,e.documentUpdates).next((d=>{c=d.ks,h=d.qs}))),!i.isEqual(De.min())){const d=t.Pi.getLastRemoteSnapshotVersion(s).next((g=>t.Pi.setTargetsMetadata(s,s.currentSequenceNumber,i)));a.push(d)}return Z.waitFor(a).next((()=>o.apply(s))).next((()=>t.localDocuments.getLocalViewOfDocuments(s,c,h))).next((()=>c))})).then((s=>(t.Ms=r,s)))}function XU(n,e,t){let i=et(),r=et();return t.forEach((s=>i=i.add(s))),e.getEntries(n,i).next((s=>{let o=tr();return t.forEach(((a,c)=>{const h=s.get(a);c.isFoundDocument()!==h.isFoundDocument()&&(r=r.add(a)),c.isNoDocument()&&c.version.isEqual(De.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!h.isValidDocument()||c.version.compareTo(h.version)>0||c.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):pe(TS,"Ignoring outdated watch update for ",a,". Current version:",h.version," Watch version:",c.version)})),{ks:o,qs:r}}))}function QU(n,e){const t=Ye(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=ec),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function ZU(n,e){const t=Ye(n);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let r;return t.Pi.getTargetData(i,e).next((s=>s?(r=s,Z.resolve(r)):t.Pi.allocateTargetId(i).next((o=>(r=new uo(e,o,"TargetPurposeListen",i.currentSequenceNumber),t.Pi.addTargetData(i,r).next((()=>r)))))))})).then((i=>{const r=t.Ms.get(i.targetId);return(r===null||i.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(i.targetId,i),t.xs.set(e,i.targetId)),i}))}async function Sw(n,e,t){const i=Ye(n),r=i.Ms.get(e),s=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",s,(o=>i.persistence.referenceDelegate.removeTarget(o,r)))}catch(o){if(!Ja(o))throw o;pe(TS,`Failed to update sequence numbers for target ${e}: ${o}`)}i.Ms=i.Ms.remove(e),i.xs.delete(r.target)}function UA(n,e,t){const i=Ye(n);let r=De.min(),s=et();return i.persistence.runTransaction("Execute query","readwrite",(o=>(function(c,h,d){const g=Ye(c),m=g.xs.get(d);return m!==void 0?Z.resolve(g.Ms.get(m)):g.Pi.getTargetData(h,d)})(i,o,br(e)).next((a=>{if(a)return r=a.lastLimboFreeSnapshotVersion,i.Pi.getMatchingKeysForTargetId(o,a.targetId).next((c=>{s=c}))})).next((()=>i.Fs.getDocumentsMatchingQuery(o,e,t?r:De.min(),t?s:et()))).next((a=>(JU(i,Vj(e),a),{documents:a,Qs:s})))))}function JU(n,e,t){let i=n.Os.get(e)||De.min();t.forEach(((r,s)=>{s.readTime.compareTo(i)>0&&(i=s.readTime)})),n.Os.set(e,i)}class BA{constructor(){this.activeTargetIds=zj()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class eN{constructor(){this.Mo=new BA,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,i){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new BA,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class eB{Oo(e){}shutdown(){}}const zA="ConnectivityMonitor";class $A{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){pe(zA,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){pe(zA,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Bp=null;function Iw(){return Bp===null?Bp=(function(){return 268435456+Math.round(2147483648*Math.random())})():Bp++,"0x"+Bp.toString(16)}const eE="RestConnection",tB={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class nB{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${i}/databases/${r}`,this.Wo=this.databaseId.database===J0?`project_id=${i}`:`project_id=${i}&database_id=${r}`}Go(e,t,i,r,s){const o=Iw(),a=this.zo(e,t.toUriEncodedString());pe(eE,`Sending RPC '${e}' ${o}:`,a,i);const c={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(c,r,s);const{host:h}=new URL(a),d=Lc(h);return this.Jo(e,a,c,i,d).then((g=>(pe(eE,`Received RPC '${e}' ${o}: `,g),g)),(g=>{throw _c(eE,`RPC '${e}' ${o} failed with error: `,g,"url: ",a,"request:",i),g}))}Ho(e,t,i,r,s,o){return this.Go(e,t,i,r,s)}jo(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+zh})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((r,s)=>e[s]=r)),i&&i.headers.forEach(((r,s)=>e[s]=r))}zo(e,t){const i=tB[e];return`${this.Uo}/v1/${t}:${i}`}terminate(){}}class iB{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const Jn="WebChannelConnection";class rB extends nB{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,i,r,s){const o=Iw();return new Promise(((a,c)=>{const h=new wk;h.setWithCredentials(!0),h.listenOnce(xk.COMPLETE,(()=>{try{switch(h.getLastErrorCode()){case n0.NO_ERROR:const g=h.getResponseJson();pe(Jn,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(g)),a(g);break;case n0.TIMEOUT:pe(Jn,`RPC '${e}' ${o} timed out`),c(new xe(ae.DEADLINE_EXCEEDED,"Request time out"));break;case n0.HTTP_ERROR:const m=h.getStatus();if(pe(Jn,`RPC '${e}' ${o} failed with status:`,m,"response text:",h.getResponseText()),m>0){let y=h.getResponseJson();Array.isArray(y)&&(y=y[0]);const w=y?.error;if(w&&w.status&&w.message){const T=(function(P){const M=P.toLowerCase().replace(/_/g,"-");return Object.values(ae).indexOf(M)>=0?M:ae.UNKNOWN})(w.status);c(new xe(T,w.message))}else c(new xe(ae.UNKNOWN,"Server responded with status "+h.getStatus()))}else c(new xe(ae.UNAVAILABLE,"Connection failed."));break;default:Me(9055,{l_:e,streamId:o,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{pe(Jn,`RPC '${e}' ${o} completed.`)}}));const d=JSON.stringify(r);pe(Jn,`RPC '${e}' ${o} sending request:`,r),h.send(t,"POST",d,i,15)}))}T_(e,t,i){const r=Iw(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Tk(),a=Ik(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(c.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(c.useFetchStreams=!0),this.jo(c.initMessageHeaders,t,i),c.encodeInitMessageHeaders=!0;const d=s.join("");pe(Jn,`Creating RPC '${e}' stream ${r}: ${d}`,c);const g=o.createWebChannel(d,c);this.I_(g);let m=!1,y=!1;const w=new iB({Yo:E=>{y?pe(Jn,`Not sending because RPC '${e}' stream ${r} is closed:`,E):(m||(pe(Jn,`Opening RPC '${e}' stream ${r} transport.`),g.open(),m=!0),pe(Jn,`RPC '${e}' stream ${r} sending:`,E),g.send(E))},Zo:()=>g.close()}),T=(E,P,M)=>{E.listen(P,(N=>{try{M(N)}catch(D){setTimeout((()=>{throw D}),0)}}))};return T(g,lf.EventType.OPEN,(()=>{y||(pe(Jn,`RPC '${e}' stream ${r} transport opened.`),w.o_())})),T(g,lf.EventType.CLOSE,(()=>{y||(y=!0,pe(Jn,`RPC '${e}' stream ${r} transport closed`),w.a_(),this.E_(g))})),T(g,lf.EventType.ERROR,(E=>{y||(y=!0,_c(Jn,`RPC '${e}' stream ${r} transport errored. Name:`,E.name,"Message:",E.message),w.a_(new xe(ae.UNAVAILABLE,"The operation could not be completed")))})),T(g,lf.EventType.MESSAGE,(E=>{if(!y){const P=E.data[0];Oe(!!P,16349);const M=P,N=M?.error||M[0]?.error;if(N){pe(Jn,`RPC '${e}' stream ${r} received error:`,N);const D=N.status;let j=(function(A){const k=dn[A];if(k!==void 0)return xL(k)})(D),W=N.message;j===void 0&&(j=ae.INTERNAL,W="Unknown error status: "+D+" with message "+N.message),y=!0,w.a_(new xe(j,W)),g.close()}else pe(Jn,`RPC '${e}' stream ${r} received:`,P),w.u_(P)}})),T(a,Sk.STAT_EVENT,(E=>{E.stat===nw.PROXY?pe(Jn,`RPC '${e}' stream ${r} detected buffering proxy`):E.stat===nw.NOPROXY&&pe(Jn,`RPC '${e}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{w.__()}),0),w}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function sB(){return typeof window<"u"?window:null}function d0(){return typeof document<"u"?document:null}function xy(n){return new oU(n,!0)}class tN{constructor(e,t,i=1e3,r=1.5,s=6e4){this.Mi=e,this.timerId=t,this.d_=i,this.A_=r,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),i=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-i);r>0&&pe("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const WA="PersistentStream";class nN{constructor(e,t,i,r,s,o,a,c){this.Mi=e,this.S_=i,this.b_=r,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new tN(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===ae.RESOURCE_EXHAUSTED?(_i(t.toString()),_i("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===ae.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,r])=>{this.D_===t&&this.G_(i,r)}),(i=>{e((()=>{const r=new xe(ae.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(r)}))}))}G_(e,t){const i=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{i((()=>this.listener.Xo()))})),this.stream.t_((()=>{i((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((r=>{i((()=>this.z_(r)))})),this.stream.onMessage((r=>{i((()=>++this.F_==1?this.J_(r):this.onNext(r)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return pe(WA,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(pe(WA,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class oB extends nN{constructor(e,t,i,r,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,r,o),this.serializer=s}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=cU(this.serializer,e),i=(function(s){if(!("targetChange"in s))return De.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?De.min():o.readTime?wi(o.readTime):De.min()})(e);return this.listener.H_(t,i)}Y_(e){const t={};t.database=yw(this.serializer),t.addTarget=(function(s,o){let a;const c=o.target;if(a=t_(c)?{documents:ML(s,c)}:{query:bL(s,c).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=TL(s,o.resumeToken);const h=pw(s,o.expectedCount);h!==null&&(a.expectedCount=h)}else if(o.snapshotVersion.compareTo(De.min())>0){a.readTime=Nh(s,o.snapshotVersion.toTimestamp());const h=pw(s,o.expectedCount);h!==null&&(a.expectedCount=h)}return a})(this.serializer,e);const i=hU(this.serializer,e);i&&(t.labels=i),this.q_(t)}Z_(e){const t={};t.database=yw(this.serializer),t.removeTarget=e,this.q_(t)}}class aB extends nN{constructor(e,t,i,r,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,r,o),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Oe(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Oe(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Oe(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=uU(e.writeResults,e.commitTime),i=wi(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=yw(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>r_(this.serializer,i)))};this.q_(t)}}class lB{}class cB extends lB{constructor(e,t,i,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new xe(ae.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,i,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,o])=>this.connection.Go(e,_w(t,i),r,s,o))).catch((s=>{throw s.name==="FirebaseError"?(s.code===ae.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new xe(ae.UNKNOWN,s.toString())}))}Ho(e,t,i,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,a])=>this.connection.Ho(e,_w(t,i),r,o,a,s))).catch((o=>{throw o.name==="FirebaseError"?(o.code===ae.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new xe(ae.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class uB{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(_i(t),this.aa=!1):pe("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Sc="RemoteStore";class hB{constructor(e,t,i,r,s){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo((o=>{i.enqueueAndForget((async()=>{Dc(this)&&(pe(Sc,"Restarting streams for network reachability change."),await(async function(c){const h=Ye(c);h.Ea.add(4),await Jg(h),h.Ra.set("Unknown"),h.Ea.delete(4),await Sy(h)})(this))}))})),this.Ra=new uB(i,r)}}async function Sy(n){if(Dc(n))for(const e of n.da)await e(!0)}async function Jg(n){for(const e of n.da)await e(!1)}function iN(n,e){const t=Ye(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),CS(t)?AS(t):Wh(t).O_()&&PS(t,e))}function RS(n,e){const t=Ye(n),i=Wh(t);t.Ia.delete(e),i.O_()&&rN(t,e),t.Ia.size===0&&(i.O_()?i.L_():Dc(t)&&t.Ra.set("Unknown"))}function PS(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(De.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Wh(n).Y_(e)}function rN(n,e){n.Va.Ue(e),Wh(n).Z_(e)}function AS(n){n.Va=new nU({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Wh(n).start(),n.Ra.ua()}function CS(n){return Dc(n)&&!Wh(n).x_()&&n.Ia.size>0}function Dc(n){return Ye(n).Ea.size===0}function sN(n){n.Va=void 0}async function dB(n){n.Ra.set("Online")}async function fB(n){n.Ia.forEach(((e,t)=>{PS(n,e)}))}async function gB(n,e){sN(n),CS(n)?(n.Ra.ha(e),AS(n)):n.Ra.set("Unknown")}async function mB(n,e,t){if(n.Ra.set("Online"),e instanceof IL&&e.state===2&&e.cause)try{await(async function(r,s){const o=s.cause;for(const a of s.targetIds)r.Ia.has(a)&&(await r.remoteSyncer.rejectListen(a,o),r.Ia.delete(a),r.Va.removeTarget(a))})(n,e)}catch(i){pe(Sc,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await c_(n,i)}else if(e instanceof u0?n.Va.Ze(e):e instanceof SL?n.Va.st(e):n.Va.tt(e),!t.isEqual(De.min()))try{const i=await JL(n.localStore);t.compareTo(i)>=0&&await(function(s,o){const a=s.Va.Tt(o);return a.targetChanges.forEach(((c,h)=>{if(c.resumeToken.approximateByteSize()>0){const d=s.Ia.get(h);d&&s.Ia.set(h,d.withResumeToken(c.resumeToken,o))}})),a.targetMismatches.forEach(((c,h)=>{const d=s.Ia.get(c);if(!d)return;s.Ia.set(c,d.withResumeToken(gn.EMPTY_BYTE_STRING,d.snapshotVersion)),rN(s,c);const g=new uo(d.target,c,h,d.sequenceNumber);PS(s,g)})),s.remoteSyncer.applyRemoteEvent(a)})(n,t)}catch(i){pe(Sc,"Failed to raise snapshot:",i),await c_(n,i)}}async function c_(n,e,t){if(!Ja(e))throw e;n.Ea.add(1),await Jg(n),n.Ra.set("Offline"),t||(t=()=>JL(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{pe(Sc,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await Sy(n)}))}function oN(n,e){return e().catch((t=>c_(n,t,e)))}async function em(n){const e=Ye(n),t=Ha(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:ec;for(;pB(e);)try{const r=await QU(e.localStore,i);if(r===null){e.Ta.length===0&&t.L_();break}i=r.batchId,_B(e,r)}catch(r){await c_(e,r)}aN(e)&&lN(e)}function pB(n){return Dc(n)&&n.Ta.length<10}function _B(n,e){n.Ta.push(e);const t=Ha(n);t.O_()&&t.X_&&t.ea(e.mutations)}function aN(n){return Dc(n)&&!Ha(n).x_()&&n.Ta.length>0}function lN(n){Ha(n).start()}async function yB(n){Ha(n).ra()}async function vB(n){const e=Ha(n);for(const t of n.Ta)e.ea(t.mutations)}async function EB(n,e,t){const i=n.Ta.shift(),r=mS.from(i,e,t);await oN(n,(()=>n.remoteSyncer.applySuccessfulWrite(r))),await em(n)}async function wB(n,e){e&&Ha(n).X_&&await(async function(i,r){if((function(o){return Jj(o)&&o!==ae.ABORTED})(r.code)){const s=i.Ta.shift();Ha(i).B_(),await oN(i,(()=>i.remoteSyncer.rejectFailedWrite(s.batchId,r))),await em(i)}})(n,e),aN(n)&&lN(n)}async function HA(n,e){const t=Ye(n);t.asyncQueue.verifyOperationInProgress(),pe(Sc,"RemoteStore received new credentials");const i=Dc(t);t.Ea.add(3),await Jg(t),i&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Sy(t)}async function xB(n,e){const t=Ye(n);e?(t.Ea.delete(2),await Sy(t)):e||(t.Ea.add(2),await Jg(t),t.Ra.set("Unknown"))}function Wh(n){return n.ma||(n.ma=(function(t,i,r){const s=Ye(t);return s.sa(),new oB(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)})(n.datastore,n.asyncQueue,{Xo:dB.bind(null,n),t_:fB.bind(null,n),r_:gB.bind(null,n),H_:mB.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),CS(n)?AS(n):n.Ra.set("Unknown")):(await n.ma.stop(),sN(n))}))),n.ma}function Ha(n){return n.fa||(n.fa=(function(t,i,r){const s=Ye(t);return s.sa(),new aB(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:yB.bind(null,n),r_:wB.bind(null,n),ta:vB.bind(null,n),na:EB.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await em(n)):(await n.fa.stop(),n.Ta.length>0&&(pe(Sc,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class MS{constructor(e,t,i,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=r,this.removalCallback=s,this.deferred=new _o,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,r,s){const o=Date.now()+i,a=new MS(e,t,o,r,s);return a.start(i),a}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new xe(ae.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function bS(n,e){if(_i("AsyncQueue",`${e}: ${n}`),Ja(n))return new xe(ae.UNAVAILABLE,`${e}: ${n}`);throw n}class sh{static emptySet(e){return new sh(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||Se.comparator(t.key,i.key):(t,i)=>Se.comparator(t.key,i.key),this.keyedMap=cf(),this.sortedSet=new zt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof sh)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=i.getNext().key;if(!r.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new sh;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}class KA{constructor(){this.ga=new zt(Se.comparator)}track(e){const t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Me(63341,{Rt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,i)=>{e.push(i)})),e}}class Oh{constructor(e,t,i,r,s,o,a,c,h){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=r,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=h}static fromInitialDocuments(e,t,i,r,s){const o=[];return t.forEach((a=>{o.push({type:0,doc:a})})),new Oh(e,t,sh.emptySet(t),o,i,r,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&gy(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==i[r].type||!t[r].doc.isEqual(i[r].doc))return!1;return!0}}class SB{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class IB{constructor(){this.queries=qA(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const r=Ye(t),s=r.queries;r.queries=qA(),s.forEach(((o,a)=>{for(const c of a.Sa)c.onError(i)}))})(this,new xe(ae.ABORTED,"Firestore shutting down"))}}function qA(){return new bo((n=>cL(n)),gy)}async function TB(n,e){const t=Ye(n);let i=3;const r=e.query;let s=t.queries.get(r);s?!s.ba()&&e.Da()&&(i=2):(s=new SB,i=e.Da()?0:1);try{switch(i){case 0:s.wa=await t.onListen(r,!0);break;case 1:s.wa=await t.onListen(r,!1);break;case 2:await t.onFirstRemoteStoreListen(r)}}catch(o){const a=bS(o,`Initialization of query '${ju(e.query)}' failed`);return void e.onError(a)}t.queries.set(r,s),s.Sa.push(e),e.va(t.onlineState),s.wa&&e.Fa(s.wa)&&kS(t)}async function RB(n,e){const t=Ye(n),i=e.query;let r=3;const s=t.queries.get(i);if(s){const o=s.Sa.indexOf(e);o>=0&&(s.Sa.splice(o,1),s.Sa.length===0?r=e.Da()?0:1:!s.ba()&&e.Da()&&(r=2))}switch(r){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function PB(n,e){const t=Ye(n);let i=!1;for(const r of e){const s=r.query,o=t.queries.get(s);if(o){for(const a of o.Sa)a.Fa(r)&&(i=!0);o.wa=r}}i&&kS(t)}function AB(n,e,t){const i=Ye(n),r=i.queries.get(e);if(r)for(const s of r.Sa)s.onError(t);i.queries.delete(e)}function kS(n){n.Ca.forEach((e=>{e.next()}))}var Tw,YA;(YA=Tw||(Tw={})).Ma="default",YA.Cache="cache";class CB{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const r of e.docChanges)r.type!==3&&i.push(r);e=new Oh(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const i=t!=="Offline";return(!this.options.qa||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Oh.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Tw.Cache}}class cN{constructor(e){this.key=e}}class uN{constructor(e){this.key=e}}class MB{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=et(),this.mutatedKeys=et(),this.eu=uL(e),this.tu=new sh(this.eu)}get nu(){return this.Ya}ru(e,t){const i=t?t.iu:new KA,r=t?t.tu:this.tu;let s=t?t.mutatedKeys:this.mutatedKeys,o=r,a=!1;const c=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,h=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((d,g)=>{const m=r.get(d),y=Qg(this.query,g)?g:null,w=!!m&&this.mutatedKeys.has(m.key),T=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations);let E=!1;m&&y?m.data.isEqual(y.data)?w!==T&&(i.track({type:3,doc:y}),E=!0):this.su(m,y)||(i.track({type:2,doc:y}),E=!0,(c&&this.eu(y,c)>0||h&&this.eu(y,h)<0)&&(a=!0)):!m&&y?(i.track({type:0,doc:y}),E=!0):m&&!y&&(i.track({type:1,doc:m}),E=!0,(c||h)&&(a=!0)),E&&(y?(o=o.add(y),s=T?s.add(d):s.delete(d)):(o=o.delete(d),s=s.delete(d)))})),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),i.track({type:1,doc:d})}return{tu:o,iu:i,Cs:a,mutatedKeys:s}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,r){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort(((d,g)=>(function(y,w){const T=E=>{switch(E){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Me(20277,{Rt:E})}};return T(y)-T(w)})(d.type,g.type)||this.eu(d.doc,g.doc))),this.ou(i),r=r??!1;const a=t&&!r?this._u():[],c=this.Xa.size===0&&this.current&&!r?1:0,h=c!==this.Za;return this.Za=c,o.length!==0||h?{snapshot:new Oh(this.query,e.tu,s,o,e.mutatedKeys,c===0,h,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new KA,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=et(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Xa=this.Xa.add(i.key))}));const t=[];return e.forEach((i=>{this.Xa.has(i)||t.push(new uN(i))})),this.Xa.forEach((i=>{e.has(i)||t.push(new cN(i))})),t}cu(e){this.Ya=e.Qs,this.Xa=et();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Oh.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const LS="SyncEngine";class bB{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class kB{constructor(e){this.key=e,this.hu=!1}}class LB{constructor(e,t,i,r,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new bo((a=>cL(a)),gy),this.Iu=new Map,this.Eu=new Set,this.du=new zt(Se.comparator),this.Au=new Map,this.Ru=new wS,this.Vu={},this.mu=new Map,this.fu=xc.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function NB(n,e,t=!0){const i=pN(n);let r;const s=i.Tu.get(e);return s?(i.sharedClientState.addLocalQueryTarget(s.targetId),r=s.view.lu()):r=await hN(i,e,t,!0),r}async function OB(n,e){const t=pN(n);await hN(t,e,!0,!1)}async function hN(n,e,t,i){const r=await ZU(n.localStore,br(e)),s=r.targetId,o=n.sharedClientState.addLocalQueryTarget(s,t);let a;return i&&(a=await DB(n,e,s,o==="current",r.resumeToken)),n.isPrimaryClient&&t&&iN(n.remoteStore,r),a}async function DB(n,e,t,i,r){n.pu=(g,m,y)=>(async function(T,E,P,M){let N=E.view.ru(P);N.Cs&&(N=await UA(T.localStore,E.query,!1).then((({documents:L})=>E.view.ru(L,N))));const D=M&&M.targetChanges.get(E.targetId),j=M&&M.targetMismatches.get(E.targetId)!=null,W=E.view.applyChanges(N,T.isPrimaryClient,D,j);return QA(T,E.targetId,W.au),W.snapshot})(n,g,m,y);const s=await UA(n.localStore,e,!0),o=new MB(e,s.Qs),a=o.ru(s.documents),c=Zg.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",r),h=o.applyChanges(a,n.isPrimaryClient,c);QA(n,t,h.au);const d=new bB(e,t,o);return n.Tu.set(e,d),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),h.snapshot}async function VB(n,e,t){const i=Ye(n),r=i.Tu.get(e),s=i.Iu.get(r.targetId);if(s.length>1)return i.Iu.set(r.targetId,s.filter((o=>!gy(o,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(r.targetId),i.sharedClientState.isActiveQueryTarget(r.targetId)||await Sw(i.localStore,r.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(r.targetId),t&&RS(i.remoteStore,r.targetId),Rw(i,r.targetId)})).catch(Oc)):(Rw(i,r.targetId),await Sw(i.localStore,r.targetId,!0))}async function FB(n,e){const t=Ye(n),i=t.Tu.get(e),r=t.Iu.get(i.targetId);t.isPrimaryClient&&r.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),RS(t.remoteStore,i.targetId))}async function GB(n,e,t){const i=_N(n);try{const r=await(function(o,a){const c=Ye(o),h=xt.now(),d=a.reduce(((y,w)=>y.add(w.key)),et());let g,m;return c.persistence.runTransaction("Locally write mutations","readwrite",(y=>{let w=tr(),T=et();return c.Ns.getEntries(y,d).next((E=>{w=E,w.forEach(((P,M)=>{M.isValidDocument()||(T=T.add(P))}))})).next((()=>c.localDocuments.getOverlayedDocuments(y,w))).next((E=>{g=E;const P=[];for(const M of a){const N=Qj(M,g.get(M.key).overlayedDocument);N!=null&&P.push(new ko(M.key,N,eL(N.value.mapValue),yi.exists(!0)))}return c.mutationQueue.addMutationBatch(y,h,P,a)})).next((E=>{m=E;const P=E.applyToLocalDocumentSet(g,T);return c.documentOverlayCache.saveOverlays(y,E.batchId,P)}))})).then((()=>({batchId:m.batchId,changes:dL(g)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(r.batchId),(function(o,a,c){let h=o.Vu[o.currentUser.toKey()];h||(h=new zt(qe)),h=h.insert(a,c),o.Vu[o.currentUser.toKey()]=h})(i,r.batchId,t),await tm(i,r.changes),await em(i.remoteStore)}catch(r){const s=bS(r,"Failed to persist write");t.reject(s)}}async function dN(n,e){const t=Ye(n);try{const i=await YU(t.localStore,e);e.targetChanges.forEach(((r,s)=>{const o=t.Au.get(s);o&&(Oe(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1,22616),r.addedDocuments.size>0?o.hu=!0:r.modifiedDocuments.size>0?Oe(o.hu,14607):r.removedDocuments.size>0&&(Oe(o.hu,42227),o.hu=!1))})),await tm(t,i,e)}catch(i){await Oc(i)}}function XA(n,e,t){const i=Ye(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const r=[];i.Tu.forEach(((s,o)=>{const a=o.view.va(e);a.snapshot&&r.push(a.snapshot)})),(function(o,a){const c=Ye(o);c.onlineState=a;let h=!1;c.queries.forEach(((d,g)=>{for(const m of g.Sa)m.va(a)&&(h=!0)})),h&&kS(c)})(i.eventManager,e),r.length&&i.Pu.H_(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function jB(n,e,t){const i=Ye(n);i.sharedClientState.updateQueryState(e,"rejected",t);const r=i.Au.get(e),s=r&&r.key;if(s){let o=new zt(Se.comparator);o=o.insert(s,Jt.newNoDocument(s,De.min()));const a=et().add(s),c=new yy(De.min(),new Map,new zt(qe),o,a);await dN(i,c),i.du=i.du.remove(s),i.Au.delete(e),NS(i)}else await Sw(i.localStore,e,!1).then((()=>Rw(i,e,t))).catch(Oc)}async function UB(n,e){const t=Ye(n),i=e.batch.batchId;try{const r=await qU(t.localStore,e);gN(t,i,null),fN(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await tm(t,r)}catch(r){await Oc(r)}}async function BB(n,e,t){const i=Ye(n);try{const r=await(function(o,a){const c=Ye(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",(h=>{let d;return c.mutationQueue.lookupMutationBatch(h,a).next((g=>(Oe(g!==null,37113),d=g.keys(),c.mutationQueue.removeMutationBatch(h,g)))).next((()=>c.mutationQueue.performConsistencyCheck(h))).next((()=>c.documentOverlayCache.removeOverlaysForBatchId(h,d,a))).next((()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,d))).next((()=>c.localDocuments.getDocuments(h,d)))}))})(i.localStore,e);gN(i,e,t),fN(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await tm(i,r)}catch(r){await Oc(r)}}function fN(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function gN(n,e,t){const i=Ye(n);let r=i.Vu[i.currentUser.toKey()];if(r){const s=r.get(e);s&&(t?s.reject(t):s.resolve(),r=r.remove(e)),i.Vu[i.currentUser.toKey()]=r}}function Rw(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Iu.get(e))n.Tu.delete(i),t&&n.Pu.yu(i,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((i=>{n.Ru.containsKey(i)||mN(n,i)}))}function mN(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(RS(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),NS(n))}function QA(n,e,t){for(const i of t)i instanceof cN?(n.Ru.addReference(i.key,e),zB(n,i)):i instanceof uN?(pe(LS,"Document no longer in limbo: "+i.key),n.Ru.removeReference(i.key,e),n.Ru.containsKey(i.key)||mN(n,i.key)):Me(19791,{wu:i})}function zB(n,e){const t=e.key,i=t.path.canonicalString();n.du.get(t)||n.Eu.has(i)||(pe(LS,"New document in limbo: "+t),n.Eu.add(i),NS(n))}function NS(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new Se(mt.fromString(e)),i=n.fu.next();n.Au.set(i,new kB(t)),n.du=n.du.insert(t,i),iN(n.remoteStore,new uo(br(dS(t.path)),i,"TargetPurposeLimboResolution",Cr.ce))}}async function tm(n,e,t){const i=Ye(n),r=[],s=[],o=[];i.Tu.isEmpty()||(i.Tu.forEach(((a,c)=>{o.push(i.pu(c,e,t).then((h=>{if((h||t)&&i.isPrimaryClient){const d=h?!h.fromCache:t?.targetChanges.get(c.targetId)?.current;i.sharedClientState.updateQueryState(c.targetId,d?"current":"not-current")}if(h){r.push(h);const d=IS.As(c.targetId,h);s.push(d)}})))})),await Promise.all(o),i.Pu.H_(r),await(async function(c,h){const d=Ye(c);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",(g=>Z.forEach(h,(m=>Z.forEach(m.Es,(y=>d.persistence.referenceDelegate.addReference(g,m.targetId,y))).next((()=>Z.forEach(m.ds,(y=>d.persistence.referenceDelegate.removeReference(g,m.targetId,y)))))))))}catch(g){if(!Ja(g))throw g;pe(TS,"Failed to update sequence numbers: "+g)}for(const g of h){const m=g.targetId;if(!g.fromCache){const y=d.Ms.get(m),w=y.snapshotVersion,T=y.withLastLimboFreeSnapshotVersion(w);d.Ms=d.Ms.insert(m,T)}}})(i.localStore,s))}async function $B(n,e){const t=Ye(n);if(!t.currentUser.isEqual(e)){pe(LS,"User change. New user:",e.toKey());const i=await ZL(t.localStore,e);t.currentUser=e,(function(s,o){s.mu.forEach((a=>{a.forEach((c=>{c.reject(new xe(ae.CANCELLED,o))}))})),s.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await tm(t,i.Ls)}}function WB(n,e){const t=Ye(n),i=t.Au.get(e);if(i&&i.hu)return et().add(i.key);{let r=et();const s=t.Iu.get(e);if(!s)return r;for(const o of s){const a=t.Tu.get(o);r=r.unionWith(a.view.nu)}return r}}function pN(n){const e=Ye(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=dN.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=WB.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=jB.bind(null,e),e.Pu.H_=PB.bind(null,e.eventManager),e.Pu.yu=AB.bind(null,e.eventManager),e}function _N(n){const e=Ye(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=UB.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=BB.bind(null,e),e}class _g{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=xy(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return QL(this.persistence,new XL,e.initialUser,this.serializer)}Cu(e){return new xS(wy.mi,this.serializer)}Du(e){return new eN}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}_g.provider={build:()=>new _g};class HB extends _g{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Oe(this.persistence.referenceDelegate instanceof l_,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new WL(i,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?ii.withCacheSize(this.cacheSizeBytes):ii.DEFAULT;return new xS((i=>l_.mi(i,t)),this.serializer)}}class KB extends _g{constructor(e,t,i){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=i,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await _N(this.xu.syncEngine),await em(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return QL(this.persistence,new XL,e.initialUser,this.serializer)}Fu(e,t){const i=this.persistence.referenceDelegate.garbageCollector;return new WL(i,e.asyncQueue,t)}Mu(e,t){const i=new Y7(t,this.persistence);return new q7(e.asyncQueue,i)}Cu(e){const t=$U(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),i=this.cacheSizeBytes!==void 0?ii.withCacheSize(this.cacheSizeBytes):ii.DEFAULT;return new SS(this.synchronizeTabs,t,e.clientId,i,e.asyncQueue,sB(),d0(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new eN}}class u_{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>XA(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=$B.bind(null,this.syncEngine),await xB(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new IB})()}createDatastore(e){const t=xy(e.databaseInfo.databaseId),i=(function(s){return new rB(s)})(e.databaseInfo);return(function(s,o,a,c){return new cB(s,o,a,c)})(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,r,s,o,a){return new hB(i,r,s,o,a)})(this.localStore,this.datastore,e.asyncQueue,(t=>XA(this.syncEngine,t,0)),(function(){return $A.v()?new $A:new eB})())}createSyncEngine(e,t){return(function(r,s,o,a,c,h,d){const g=new LB(r,s,o,a,c,h);return d&&(g.gu=!0),g})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const i=Ye(t);pe(Sc,"RemoteStore shutting down."),i.Ea.add(5),await Jg(i),i.Aa.shutdown(),i.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}u_.provider={build:()=>new u_};class qB{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):_i("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const Ka="FirestoreClient";class YB{constructor(e,t,i,r,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=r,this.user=$n.UNAUTHENTICATED,this.clientId=tS.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(i,(async o=>{pe(Ka,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(i,(o=>(pe(Ka,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new _o;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=bS(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function tE(n,e){n.asyncQueue.verifyOperationInProgress(),pe(Ka,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener((async r=>{i.isEqual(r)||(await ZL(e.localStore,r),i=r)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function ZA(n,e){n.asyncQueue.verifyOperationInProgress();const t=await XB(n);pe(Ka,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((i=>HA(e.remoteStore,i))),n.setAppCheckTokenChangeListener(((i,r)=>HA(e.remoteStore,r))),n._onlineComponents=e}async function XB(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){pe(Ka,"Using user provided OfflineComponentProvider");try{await tE(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(r){return r.name==="FirebaseError"?r.code===ae.FAILED_PRECONDITION||r.code===ae.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11})(t))throw t;_c("Error using user provided cache. Falling back to memory cache: "+t),await tE(n,new _g)}}else pe(Ka,"Using default OfflineComponentProvider"),await tE(n,new HB(void 0));return n._offlineComponents}async function yN(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(pe(Ka,"Using user provided OnlineComponentProvider"),await ZA(n,n._uninitializedComponentsProvider._online)):(pe(Ka,"Using default OnlineComponentProvider"),await ZA(n,new u_))),n._onlineComponents}function QB(n){return yN(n).then((e=>e.syncEngine))}async function ZB(n){const e=await yN(n),t=e.eventManager;return t.onListen=NB.bind(null,e.syncEngine),t.onUnlisten=VB.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=OB.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=FB.bind(null,e.syncEngine),t}function JB(n,e,t={}){const i=new _o;return n.asyncQueue.enqueueAndForget((async()=>(function(s,o,a,c,h){const d=new qB({next:m=>{d.Nu(),o.enqueueAndForget((()=>RB(s,g))),m.fromCache&&c.source==="server"?h.reject(new xe(ae.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(m)},error:m=>h.reject(m)}),g=new CB(a,d,{includeMetadataChanges:!0,qa:!0});return TB(s,g)})(await ZB(n),n.asyncQueue,e,t,i))),i.promise}function vN(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const JA=new Map;const EN="firestore.googleapis.com",eC=!0;class tC{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new xe(ae.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=EN,this.ssl=eC}else this.host=e.host,this.ssl=e.ssl??eC;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=UL;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<PU)throw new xe(ae.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}$7("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=vN(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new xe(ae.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new xe(ae.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new xe(ae.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,r){return i.timeoutSeconds===r.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Iy{constructor(e,t,i,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new tC({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new xe(ae.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new xe(ae.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new tC(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new N7;switch(i.type){case"firstParty":return new F7(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new xe(ae.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=JA.get(t);i&&(pe("ComponentProvider","Removing Datastore"),JA.delete(t),i.terminate())})(this),Promise.resolve()}}function ez(n,e,t,i={}){n=za(n,Iy);const r=Lc(e),s=n._getSettings(),o={...s,emulatorOptions:n._getEmulatorOptions()},a=`${e}:${t}`;r&&(Yx(`https://${a}`),Xx("Firestore",!0)),s.host!==EN&&s.host!==a&&_c("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c={...s,host:a,ssl:r,emulatorOptions:i};if(!gc(c,o)&&(n._setSettings(c),i.mockUserToken)){let h,d;if(typeof i.mockUserToken=="string")h=i.mockUserToken,d=$n.MOCK_USER;else{h=uk(i.mockUserToken,n._app?.options.projectId);const g=i.mockUserToken.sub||i.mockUserToken.user_id;if(!g)throw new xe(ae.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new $n(g)}n._authCredentials=new O7(new Pk(h,d))}}class Hh{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new Hh(this.firestore,e,this._query)}}class vn{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Va(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new vn(this.firestore,e,this._key)}toJSON(){return{type:vn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(Kg(t,vn._jsonSchema))return new vn(e,i||null,new Se(mt.fromString(t.referencePath)))}}vn._jsonSchemaVersion="firestore/documentReference/1.0",vn._jsonSchema={type:fn("string",vn._jsonSchemaVersion),referencePath:fn("string")};class Va extends Hh{constructor(e,t,i){super(e,t,dS(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new vn(this.firestore,null,new Se(e))}withConverter(e){return new Va(this.firestore,e,this._path)}}function nC(n,e,...t){if(n=ui(n),Ck("collection","path",e),n instanceof Iy){const i=mt.fromString(e,...t);return WP(i),new Va(n,null,i)}{if(!(n instanceof vn||n instanceof Va))throw new xe(ae.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(mt.fromString(e,...t));return WP(i),new Va(n.firestore,null,i)}}function Pw(n,e,...t){if(n=ui(n),arguments.length===1&&(e=tS.newId()),Ck("doc","path",e),n instanceof Iy){const i=mt.fromString(e,...t);return $P(i),new vn(n,null,new Se(i))}{if(!(n instanceof vn||n instanceof Va))throw new xe(ae.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(mt.fromString(e,...t));return $P(i),new vn(n.firestore,n instanceof Va?n.converter:null,new Se(i))}}const iC="AsyncQueue";class rC{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new tN(this,"async_queue_retry"),this._c=()=>{const i=d0();i&&pe(iC,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=d0();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=d0();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new _o;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Ja(e))throw e;pe(iC,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,_i("INTERNAL UNHANDLED ERROR: ",sC(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=MS.createAndSchedule(this,e,t,i,(s=>this.hc(s)));return this.tc.push(r),r}uc(){this.nc&&Me(47125,{Pc:sC(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function sC(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class Kh extends Iy{constructor(e,t,i,r){super(e,t,i,r),this.type="firestore",this._queue=new rC,this._persistenceKey=r?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new rC(e),this._firestoreClient=void 0,await e}}}function tz(n,e){const t=typeof n=="object"?n:Jx(),i=typeof n=="string"?n:J0,r=sy(t,"firestore").getImmediate({identifier:i});if(!r._initialized){const s=ak("firestore");s&&ez(r,...s)}return r}function wN(n){if(n._terminated)throw new xe(ae.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||xN(n),n._firestoreClient}function xN(n){const e=n._freezeSettings(),t=(function(r,s,o,a){return new Ij(r,s,o,a.host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,vN(a.experimentalLongPollingOptions),a.useFetchStreams,a.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new YB(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(r){const s=r?._online.build();return{_offline:r?._offline.build(s),_online:s}})(n._componentsProvider))}function nz(n,e){_c("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return iz(n,u_.provider,{build:i=>new KB(i,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function iz(n,e,t){if((n=za(n,Kh))._firestoreClient||n._terminated)throw new xe(ae.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new xe(ae.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},xN(n)}class Tr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Tr(gn.fromBase64String(e))}catch(t){throw new xe(ae.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Tr(gn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Tr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Kg(e,Tr._jsonSchema))return Tr.fromBase64String(e.bytes)}}Tr._jsonSchemaVersion="firestore/bytes/1.0",Tr._jsonSchema={type:fn("string",Tr._jsonSchemaVersion),bytes:fn("string")};class Ty{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new xe(ae.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Kt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class OS{constructor(e){this._methodName=e}}class bs{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new xe(ae.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new xe(ae.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return qe(this._lat,e._lat)||qe(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:bs._jsonSchemaVersion}}static fromJSON(e){if(Kg(e,bs._jsonSchema))return new bs(e.latitude,e.longitude)}}bs._jsonSchemaVersion="firestore/geoPoint/1.0",bs._jsonSchema={type:fn("string",bs._jsonSchemaVersion),latitude:fn("number"),longitude:fn("number")};class ks{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,r){if(i.length!==r.length)return!1;for(let s=0;s<i.length;++s)if(i[s]!==r[s])return!1;return!0})(this._values,e._values)}toJSON(){return{type:ks._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Kg(e,ks._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new ks(e.vectorValues);throw new xe(ae.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ks._jsonSchemaVersion="firestore/vectorValue/1.0",ks._jsonSchema={type:fn("string",ks._jsonSchemaVersion),vectorValues:fn("object")};const rz=/^__.*__$/;class sz{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new ko(e,this.data,this.fieldMask,t,this.fieldTransforms):new $h(e,this.data,t,this.fieldTransforms)}}class SN{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new ko(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function IN(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Me(40011,{Ac:n})}}class DS{constructor(e,t,i,r,s,o){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=r,s===void 0&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new DS({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),i=this.Vc({path:t,fc:!1});return i.gc(e),i}yc(e){const t=this.path?.child(e),i=this.Vc({path:t,fc:!1});return i.Rc(),i}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return h_(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(IN(this.Ac)&&rz.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class oz{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||xy(e)}Cc(e,t,i,r=!1){return new DS({Ac:e,methodName:t,Dc:i,path:Kt.emptyPath(),fc:!1,bc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function VS(n){const e=n._freezeSettings(),t=xy(n._databaseId);return new oz(n._databaseId,!!e.ignoreUndefinedProperties,t)}function az(n,e,t,i,r,s={}){const o=n.Cc(s.merge||s.mergeFields?2:0,e,t,r);FS("Data must be an object, but it was:",o,i);const a=TN(i,o);let c,h;if(s.merge)c=new Fi(o.fieldMask),h=o.fieldTransforms;else if(s.mergeFields){const d=[];for(const g of s.mergeFields){const m=Aw(e,g,t);if(!o.contains(m))throw new xe(ae.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);PN(d,m)||d.push(m)}c=new Fi(d),h=o.fieldTransforms.filter((g=>c.covers(g.field)))}else c=null,h=o.fieldTransforms;return new sz(new si(a),c,h)}class Ry extends OS{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Ry}}function lz(n,e,t,i){const r=n.Cc(1,e,t);FS("Data must be an object, but it was:",r,i);const s=[],o=si.empty();el(i,((c,h)=>{const d=GS(e,c,t);h=ui(h);const g=r.yc(d);if(h instanceof Ry)s.push(d);else{const m=nm(h,g);m!=null&&(s.push(d),o.set(d,m))}}));const a=new Fi(s);return new SN(o,a,r.fieldTransforms)}function cz(n,e,t,i,r,s){const o=n.Cc(1,e,t),a=[Aw(e,i,t)],c=[r];if(s.length%2!=0)throw new xe(ae.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<s.length;m+=2)a.push(Aw(e,s[m])),c.push(s[m+1]);const h=[],d=si.empty();for(let m=a.length-1;m>=0;--m)if(!PN(h,a[m])){const y=a[m];let w=c[m];w=ui(w);const T=o.yc(y);if(w instanceof Ry)h.push(y);else{const E=nm(w,T);E!=null&&(h.push(y),d.set(y,E))}}const g=new Fi(h);return new SN(d,g,o.fieldTransforms)}function uz(n,e,t,i=!1){return nm(t,n.Cc(i?4:3,e))}function nm(n,e){if(RN(n=ui(n)))return FS("Unsupported field value:",e,n),TN(n,e);if(n instanceof OS)return(function(i,r){if(!IN(r.Ac))throw r.Sc(`${i._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Sc(`${i._methodName}() is not currently supported inside arrays`);const s=i._toFieldTransform(r);s&&r.fieldTransforms.push(s)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(i,r){const s=[];let o=0;for(const a of i){let c=nm(a,r.wc(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}})(n,e)}return(function(i,r){if((i=ui(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return $j(r.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const s=xt.fromDate(i);return{timestampValue:Nh(r.serializer,s)}}if(i instanceof xt){const s=new xt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Nh(r.serializer,s)}}if(i instanceof bs)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof Tr)return{bytesValue:TL(r.serializer,i._byteString)};if(i instanceof vn){const s=r.databaseId,o=i.firestore._databaseId;if(!o.isEqual(s))throw r.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:yS(i.firestore._databaseId||r.databaseId,i._key.path)}}if(i instanceof ks)return(function(o,a){return{mapValue:{fields:{[cS]:{stringValue:uS},[Ah]:{arrayValue:{values:o.toArray().map((h=>{if(typeof h!="number")throw a.Sc("VectorValues must only contain numeric values.");return fS(a.serializer,h)}))}}}}}})(i,r);throw r.Sc(`Unsupported field value: ${oy(i)}`)})(n,e)}function TN(n,e){const t={};return Wk(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):el(n,((i,r)=>{const s=nm(r,e.mc(i));s!=null&&(t[i]=s)})),{mapValue:{fields:t}}}function RN(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof xt||n instanceof bs||n instanceof Tr||n instanceof vn||n instanceof OS||n instanceof ks)}function FS(n,e,t){if(!RN(t)||!Mk(t)){const i=oy(t);throw i==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+i)}}function Aw(n,e,t){if((e=ui(e))instanceof Ty)return e._internalPath;if(typeof e=="string")return GS(n,e);throw h_("Field path arguments must be of type string or ",n,!1,void 0,t)}const hz=new RegExp("[~\\*/\\[\\]]");function GS(n,e,t){if(e.search(hz)>=0)throw h_(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Ty(...e.split("."))._internalPath}catch{throw h_(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function h_(n,e,t,i,r){const s=i&&!i.isEmpty(),o=r!==void 0;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${i}`),o&&(c+=` in document ${r}`),c+=")"),new xe(ae.INVALID_ARGUMENT,a+n+c)}function PN(n,e){return n.some((t=>t.isEqual(e)))}class AN{constructor(e,t,i,r,s){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new vn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new dz(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(jS("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class dz extends AN{data(){return super.data()}}function jS(n,e){return typeof e=="string"?GS(n,e):e instanceof Ty?e._internalPath:e._delegate._internalPath}function fz(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new xe(ae.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class US{}class gz extends US{}function mz(n,e,...t){let i=[];e instanceof US&&i.push(e),i=i.concat(t),(function(s){const o=s.filter((c=>c instanceof BS)).length,a=s.filter((c=>c instanceof Py)).length;if(o>1||o>0&&a>0)throw new xe(ae.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const r of i)n=r._apply(n);return n}class Py extends gz{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new Py(e,t,i)}_apply(e){const t=this._parse(e);return CN(e._query,t),new Hh(e.firestore,e.converter,gw(e._query,t))}_parse(e){const t=VS(e.firestore);return(function(s,o,a,c,h,d,g){let m;if(h.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new xe(ae.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){aC(g,d);const w=[];for(const T of g)w.push(oC(c,s,T));m={arrayValue:{values:w}}}else m=oC(c,s,g)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||aC(g,d),m=uz(a,o,g,d==="in"||d==="not-in");return it.create(h,d,m)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function pz(n,e,t){const i=e,r=jS("where",n);return Py._create(r,i,t)}class BS extends US{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new BS(e,t)}_parse(e){const t=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return t.length===1?t[0]:St.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(r,s){let o=r;const a=s.getFlattenedFilters();for(const c of a)CN(o,c),o=gw(o,c)})(e._query,t),new Hh(e.firestore,e.converter,gw(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function oC(n,e,t){if(typeof(t=ui(t))=="string"){if(t==="")throw new xe(ae.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!lL(e)&&t.indexOf("/")!==-1)throw new xe(ae.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(mt.fromString(t));if(!Se.isDocumentKey(i))throw new xe(ae.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return fg(n,new Se(i))}if(t instanceof vn)return fg(n,t._key);throw new xe(ae.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${oy(t)}.`)}function aC(n,e){if(!Array.isArray(n)||n.length===0)throw new xe(ae.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function CN(n,e){const t=(function(r,s){for(const o of r)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null})(n.filters,(function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new xe(ae.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new xe(ae.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class _z{convertValue(e,t="none"){switch($a(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Bt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Io(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Me(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return el(e,((r,s)=>{i[r]=this.convertValue(s,t)})),i}convertVectorValue(e){const t=e.fields?.[Ah].arrayValue?.values?.map((i=>Bt(i.doubleValue)));return new ks(t)}convertGeoPoint(e){return new bs(Bt(e.latitude),Bt(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=dy(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(hg(e));default:return null}}convertTimestamp(e){const t=So(e);return new xt(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=mt.fromString(e);Oe(OL(i),9688,{name:e});const r=new yc(i.get(1),i.get(3)),s=new Se(i.popFirst(5));return r.isEqual(t)||_i(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}function yz(n,e,t){let i;return i=n?n.toFirestore(e):e,i}class zp{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class oh extends AN{constructor(e,t,i,r,s,o){super(e,t,i,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new f0(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(jS("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new xe(ae.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=oh._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}oh._jsonSchemaVersion="firestore/documentSnapshot/1.0",oh._jsonSchema={type:fn("string",oh._jsonSchemaVersion),bundleSource:fn("string","DocumentSnapshot"),bundleName:fn("string"),bundle:fn("string")};class f0 extends oh{data(e={}){return super.data(e)}}class ah{constructor(e,t,i,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new zp(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new f0(this._firestore,this._userDataWriter,i.key,i,new zp(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new xe(ae.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(r,s){if(r._snapshot.oldDocs.isEmpty()){let o=0;return r._snapshot.docChanges.map((a=>{const c=new f0(r._firestore,r._userDataWriter,a.doc.key,a.doc,new zp(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}}))}{let o=r._snapshot.oldDocs;return r._snapshot.docChanges.filter((a=>s||a.type!==3)).map((a=>{const c=new f0(r._firestore,r._userDataWriter,a.doc.key,a.doc,new zp(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter);let h=-1,d=-1;return a.type!==0&&(h=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:vz(a.type),doc:c,oldIndex:h,newIndex:d}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new xe(ae.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=ah._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=tS.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],r=[];return this.docs.forEach((s=>{s._document!==null&&(t.push(s._document),i.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),r.push(s.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function vz(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Me(61501,{type:n})}}ah._jsonSchemaVersion="firestore/querySnapshot/1.0",ah._jsonSchema={type:fn("string",ah._jsonSchemaVersion),bundleSource:fn("string","QuerySnapshot"),bundleName:fn("string"),bundle:fn("string")};class Ez extends _z{constructor(e){super(),this.firestore=e}convertBytes(e){return new Tr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new vn(this.firestore,null,t)}}function wz(n){n=za(n,Hh);const e=za(n.firestore,Kh),t=wN(e),i=new Ez(e);return fz(n._query),JB(t,n._query).then((r=>new ah(e,i,n,r)))}function xz(n,e,t,...i){n=za(n,vn);const r=za(n.firestore,Kh),s=VS(r);let o;return o=typeof(e=ui(e))=="string"||e instanceof Ty?cz(s,"updateDoc",n._key,e,t,i):lz(s,"updateDoc",n._key,e),zS(r,[o.toMutation(n._key,yi.exists(!0))])}function Sz(n){return zS(za(n.firestore,Kh),[new _y(n._key,yi.none())])}function Iz(n,e){const t=za(n.firestore,Kh),i=Pw(n),r=yz(n.converter,e);return zS(t,[az(VS(n.firestore),"addDoc",i._key,r,n.converter!==null,{}).toMutation(i._key,yi.exists(!1))]).then((()=>i))}function zS(n,e){return(function(i,r){const s=new _o;return i.asyncQueue.enqueueAndForget((async()=>GB(await QB(i),r,s))),s.promise})(wN(n),e)}(function(e,t=!0){(function(r){zh=r})(Nc),mc(new Ba("firestore",((i,{instanceIdentifier:r,options:s})=>{const o=i.getProvider("app").getImmediate(),a=new Kh(new D7(i.getProvider("auth-internal")),new G7(o,i.getProvider("app-check-internal")),(function(h,d){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new xe(ae.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new yc(h.options.projectId,d)})(o,r),o);return s={useFetchStreams:t,...s},a._setSettings(s),a}),"PUBLIC").setMultipleInstances(!0)),Ms(jP,UP,e),Ms(jP,UP,"esm2020")})();var Tz="firebase",Rz="12.7.0";Ms(Tz,Rz,"app");function MN(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Pz=MN,bN=new Wg("auth","Firebase",MN());const d_=new Qx("@firebase/auth");function Az(n,...e){d_.logLevel<=nt.WARN&&d_.warn(`Auth (${Nc}): ${n}`,...e)}function g0(n,...e){d_.logLevel<=nt.ERROR&&d_.error(`Auth (${Nc}): ${n}`,...e)}function To(n,...e){throw $S(n,...e)}function Ls(n,...e){return $S(n,...e)}function kN(n,e,t){const i={...Pz(),[e]:t};return new Wg("auth","Firebase",i).create(e,{appName:n.name})}function ic(n){return kN(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function $S(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return bN.create(n,...e)}function He(n,e,...t){if(!n)throw $S(e,...t)}function ho(n){const e="INTERNAL ASSERTION FAILED: "+n;throw g0(e),new Error(e)}function Ro(n,e){n||ho(e)}function Cw(){return typeof self<"u"&&self.location?.href||""}function Cz(){return lC()==="http:"||lC()==="https:"}function lC(){return typeof self<"u"&&self.location?.protocol||null}function Mz(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Cz()||mG()||"connection"in navigator)?navigator.onLine:!0}function bz(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class im{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ro(t>e,"Short delay should be less than long delay!"),this.isMobile=fG()||pG()}get(){return Mz()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function WS(n,e){Ro(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class LN{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ho("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ho("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ho("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const kz={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const Lz=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Nz=new im(3e4,6e4);function HS(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function qh(n,e,t,i,r={}){return NN(n,r,async()=>{let s={},o={};i&&(e==="GET"?o=i:s={body:JSON.stringify(i)});const a=Hg({key:n.config.apiKey,...o}).slice(1),c=await n._getAdditionalHeaders();c["Content-Type"]="application/json",n.languageCode&&(c["X-Firebase-Locale"]=n.languageCode);const h={method:e,headers:c,...s};return gG()||(h.referrerPolicy="no-referrer"),n.emulatorConfig&&Lc(n.emulatorConfig.host)&&(h.credentials="include"),LN.fetch()(await ON(n,n.config.apiHost,t,a),h)})}async function NN(n,e,t){n._canInitEmulator=!1;const i={...kz,...e};try{const r=new Dz(n),s=await Promise.race([t(),r.promise]);r.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw $p(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[c,h]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw $p(n,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw $p(n,"email-already-in-use",o);if(c==="USER_DISABLED")throw $p(n,"user-disabled",o);const d=i[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw kN(n,d,h);To(n,d)}}catch(r){if(r instanceof Us)throw r;To(n,"network-request-failed",{message:String(r)})}}async function Oz(n,e,t,i,r={}){const s=await qh(n,e,t,i,r);return"mfaPendingCredential"in s&&To(n,"multi-factor-auth-required",{_serverResponse:s}),s}async function ON(n,e,t,i){const r=`${e}${t}?${i}`,s=n,o=s.config.emulator?WS(n.config,r):`${n.config.apiScheme}://${r}`;return Lz.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}class Dz{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(Ls(this.auth,"network-request-failed")),Nz.get())})}}function $p(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const r=Ls(n,e,i);return r.customData._tokenResponse=t,r}async function Vz(n,e){return qh(n,"POST","/v1/accounts:delete",e)}async function f_(n,e){return qh(n,"POST","/v1/accounts:lookup",e)}function bf(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Fz(n,e=!1){const t=ui(n),i=await t.getIdToken(e),r=KS(i);He(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");const s=typeof r.firebase=="object"?r.firebase:void 0,o=s?.sign_in_provider;return{claims:r,token:i,authTime:bf(nE(r.auth_time)),issuedAtTime:bf(nE(r.iat)),expirationTime:bf(nE(r.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}}function nE(n){return Number(n)*1e3}function KS(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return g0("JWT malformed, contained fewer than 3 sections"),null;try{const r=rk(t);return r?JSON.parse(r):(g0("Failed to decode base64 JWT payload"),null)}catch(r){return g0("Caught error parsing JWT payload as JSON",r?.toString()),null}}function cC(n){const e=KS(n);return He(e,"internal-error"),He(typeof e.exp<"u","internal-error"),He(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function yg(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof Us&&Gz(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function Gz({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class jz{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Mw{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=bf(this.lastLoginAt),this.creationTime=bf(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function g_(n){const e=n.auth,t=await n.getIdToken(),i=await yg(n,f_(e,{idToken:t}));He(i?.users.length,e,"internal-error");const r=i.users[0];n._notifyReloadListener(r);const s=r.providerUserInfo?.length?DN(r.providerUserInfo):[],o=Bz(n.providerData,s),a=n.isAnonymous,c=!(n.email&&r.passwordHash)&&!o?.length,h=a?c:!1,d={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:o,metadata:new Mw(r.createdAt,r.lastLoginAt),isAnonymous:h};Object.assign(n,d)}async function Uz(n){const e=ui(n);await g_(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Bz(n,e){return[...n.filter(i=>!e.some(r=>r.providerId===i.providerId)),...e]}function DN(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function zz(n,e){const t=await NN(n,{},async()=>{const i=Hg({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:s}=n.config,o=await ON(n,r,"/v1/token",`key=${s}`),a=await n._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:a,body:i};return n.emulatorConfig&&Lc(n.emulatorConfig.host)&&(c.credentials="include"),LN.fetch()(o,c)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function $z(n,e){return qh(n,"POST","/v2/accounts:revokeToken",HS(n,e))}class lh{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){He(e.idToken,"internal-error"),He(typeof e.idToken<"u","internal-error"),He(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):cC(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){He(e.length!==0,"internal-error");const t=cC(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(He(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:r,expiresIn:s}=await zz(e,t);this.updateTokensAndExpiration(i,r,Number(s))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:r,expirationTime:s}=t,o=new lh;return i&&(He(typeof i=="string","internal-error",{appName:e}),o.refreshToken=i),r&&(He(typeof r=="string","internal-error",{appName:e}),o.accessToken=r),s&&(He(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new lh,this.toJSON())}_performRefresh(){return ho("not implemented")}}function fa(n,e){He(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Xr{constructor({uid:e,auth:t,stsTokenManager:i,...r}){this.providerId="firebase",this.proactiveRefresh=new jz(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new Mw(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const t=await yg(this,this.stsTokenManager.getToken(this.auth,e));return He(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return Fz(this,e)}reload(){return Uz(this)}_assign(e){this!==e&&(He(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Xr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){He(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await g_(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Yr(this.auth.app))return Promise.reject(ic(this.auth));const e=await this.getIdToken();return await yg(this,Vz(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,r=t.email??void 0,s=t.phoneNumber??void 0,o=t.photoURL??void 0,a=t.tenantId??void 0,c=t._redirectEventId??void 0,h=t.createdAt??void 0,d=t.lastLoginAt??void 0,{uid:g,emailVerified:m,isAnonymous:y,providerData:w,stsTokenManager:T}=t;He(g&&T,e,"internal-error");const E=lh.fromJSON(this.name,T);He(typeof g=="string",e,"internal-error"),fa(i,e.name),fa(r,e.name),He(typeof m=="boolean",e,"internal-error"),He(typeof y=="boolean",e,"internal-error"),fa(s,e.name),fa(o,e.name),fa(a,e.name),fa(c,e.name),fa(h,e.name),fa(d,e.name);const P=new Xr({uid:g,auth:e,email:r,emailVerified:m,displayName:i,isAnonymous:y,photoURL:o,phoneNumber:s,tenantId:a,stsTokenManager:E,createdAt:h,lastLoginAt:d});return w&&Array.isArray(w)&&(P.providerData=w.map(M=>({...M}))),c&&(P._redirectEventId=c),P}static async _fromIdTokenResponse(e,t,i=!1){const r=new lh;r.updateFromServerResponse(t);const s=new Xr({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:i});return await g_(s),s}static async _fromGetAccountInfoResponse(e,t,i){const r=t.users[0];He(r.localId!==void 0,"internal-error");const s=r.providerUserInfo!==void 0?DN(r.providerUserInfo):[],o=!(r.email&&r.passwordHash)&&!s?.length,a=new lh;a.updateFromIdToken(i);const c=new Xr({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:o}),h={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:s,metadata:new Mw(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!s?.length};return Object.assign(c,h),c}}const uC=new Map;function fo(n){Ro(n instanceof Function,"Expected a class definition");let e=uC.get(n);return e?(Ro(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,uC.set(n,e),e)}class VN{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}VN.type="NONE";const hC=VN;function m0(n,e,t){return`firebase:${n}:${e}:${t}`}class ch{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:r,name:s}=this.auth;this.fullUserKey=m0(this.userKey,r.apiKey,s),this.fullPersistenceKey=m0("persistence",r.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await f_(this.auth,{idToken:e}).catch(()=>{});return t?Xr._fromGetAccountInfoResponse(this.auth,t,e):null}return Xr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new ch(fo(hC),e,i);const r=(await Promise.all(t.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let s=r[0]||fo(hC);const o=m0(i,e.config.apiKey,e.name);let a=null;for(const h of t)try{const d=await h._get(o);if(d){let g;if(typeof d=="string"){const m=await f_(e,{idToken:d}).catch(()=>{});if(!m)break;g=await Xr._fromGetAccountInfoResponse(e,m,d)}else g=Xr._fromJSON(e,d);h!==s&&(a=g),s=h;break}}catch{}const c=r.filter(h=>h._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new ch(s,e,i):(s=c[0],a&&await s._set(o,a.toJSON()),await Promise.all(t.map(async h=>{if(h!==s)try{await h._remove(o)}catch{}})),new ch(s,e,i))}}function dC(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(UN(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(FN(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(zN(e))return"Blackberry";if($N(e))return"Webos";if(GN(e))return"Safari";if((e.includes("chrome/")||jN(e))&&!e.includes("edge/"))return"Chrome";if(BN(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if(i?.length===2)return i[1]}return"Other"}function FN(n=wn()){return/firefox\//i.test(n)}function GN(n=wn()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function jN(n=wn()){return/crios\//i.test(n)}function UN(n=wn()){return/iemobile/i.test(n)}function BN(n=wn()){return/android/i.test(n)}function zN(n=wn()){return/blackberry/i.test(n)}function $N(n=wn()){return/webos/i.test(n)}function qS(n=wn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function Wz(n=wn()){return qS(n)&&!!window.navigator?.standalone}function Hz(){return _G()&&document.documentMode===10}function WN(n=wn()){return qS(n)||BN(n)||$N(n)||zN(n)||/windows phone/i.test(n)||UN(n)}function HN(n,e=[]){let t;switch(n){case"Browser":t=dC(wn());break;case"Worker":t=`${dC(wn())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Nc}/${i}`}class Kz{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=s=>new Promise((o,a)=>{try{const c=e(s);o(c)}catch(c){a(c)}});i.onAbort=t,this.queue.push(i);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function qz(n,e={}){return qh(n,"GET","/v2/passwordPolicy",HS(n,e))}const Yz=6;class Xz{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??Yz,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let r=0;r<e.length;r++)i=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,r,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}class Qz{constructor(e,t,i,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new fC(this),this.idTokenSubscription=new fC(this),this.beforeStateQueue=new Kz(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=bN,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=fo(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await ch.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await f_(this,{idToken:e}),i=await Xr._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Yr(this.app)){const s=this.app.settings.authIdToken;return s?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(s).then(o,o))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const s=this.redirectUser?._redirectEventId,o=i?._redirectEventId,a=await this.tryRedirectSignIn(e);(!s||s===o)&&a?.user&&(i=a.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(s){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return He(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await g_(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=bz()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Yr(this.app))return Promise.reject(ic(this));const t=e?ui(e):null;return t&&He(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&He(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Yr(this.app)?Promise.reject(ic(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Yr(this.app)?Promise.reject(ic(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(fo(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await qz(this),t=new Xz(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Wg("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await $z(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&fo(e)||this._popupRedirectResolver;He(t,this,"argument-error"),this.redirectPersistenceManager=await ch.create(this,[fo(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,r){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(He(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof t=="function"){const c=e.addObserver(t,i,r);return()=>{o=!0,c()}}else{const c=e.addObserver(t);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return He(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=HN(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(Yr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&Az(`Error while retrieving App Check token: ${e.error}`),e?.token}}function YS(n){return ui(n)}class fC{constructor(e){this.auth=e,this.observer=null,this.addObserver=SG(t=>this.observer=t)}get next(){return He(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let XS={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Zz(n){XS=n}function Jz(n){return XS.loadJS(n)}function e$(){return XS.gapiScript}function t$(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function n$(n,e){const t=sy(n,"auth");if(t.isInitialized()){const r=t.getImmediate(),s=t.getOptions();if(gc(s,e??{}))return r;To(r,"already-initialized")}return t.initialize({options:e})}function i$(n,e){const t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(fo);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e?.popupRedirectResolver)}function r$(n,e,t){const i=YS(n);He(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const r=!1,s=KN(e),{host:o,port:a}=s$(e),c=a===null?"":`:${a}`,h={url:`${s}//${o}${c}/`},d=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!i._canInitEmulator){He(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),He(gc(h,i.config.emulator)&&gc(d,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=h,i.emulatorConfig=d,i.settings.appVerificationDisabledForTesting=!0,Lc(o)?(Yx(`${s}//${o}${c}`),Xx("Auth",!0)):o$()}function KN(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function s$(n){const e=KN(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const s=r[1];return{host:s,port:gC(i.substr(s.length+1))}}else{const[s,o]=i.split(":");return{host:s,port:gC(o)}}}function gC(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function o$(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class qN{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return ho("not implemented")}_getIdTokenResponse(e){return ho("not implemented")}_linkToIdToken(e,t){return ho("not implemented")}_getReauthenticationResolver(e){return ho("not implemented")}}async function uh(n,e){return Oz(n,"POST","/v1/accounts:signInWithIdp",HS(n,e))}const a$="http://localhost";class Ic extends qN{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Ic(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):To("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:r,...s}=t;if(!i||!r)return null;const o=new Ic(i,r);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return uh(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,uh(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,uh(e,t)}buildRequest(){const e={requestUri:a$,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Hg(t)}return e}}class YN{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class rm extends YN{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class va extends rm{constructor(){super("facebook.com")}static credential(e){return Ic._fromParams({providerId:va.PROVIDER_ID,signInMethod:va.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return va.credentialFromTaggedObject(e)}static credentialFromError(e){return va.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return va.credential(e.oauthAccessToken)}catch{return null}}}va.FACEBOOK_SIGN_IN_METHOD="facebook.com";va.PROVIDER_ID="facebook.com";class Ea extends rm{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Ic._fromParams({providerId:Ea.PROVIDER_ID,signInMethod:Ea.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ea.credentialFromTaggedObject(e)}static credentialFromError(e){return Ea.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return Ea.credential(t,i)}catch{return null}}}Ea.GOOGLE_SIGN_IN_METHOD="google.com";Ea.PROVIDER_ID="google.com";class wa extends rm{constructor(){super("github.com")}static credential(e){return Ic._fromParams({providerId:wa.PROVIDER_ID,signInMethod:wa.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return wa.credentialFromTaggedObject(e)}static credentialFromError(e){return wa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return wa.credential(e.oauthAccessToken)}catch{return null}}}wa.GITHUB_SIGN_IN_METHOD="github.com";wa.PROVIDER_ID="github.com";class xa extends rm{constructor(){super("twitter.com")}static credential(e,t){return Ic._fromParams({providerId:xa.PROVIDER_ID,signInMethod:xa.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return xa.credentialFromTaggedObject(e)}static credentialFromError(e){return xa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return xa.credential(t,i)}catch{return null}}}xa.TWITTER_SIGN_IN_METHOD="twitter.com";xa.PROVIDER_ID="twitter.com";class Dh{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,r=!1){const s=await Xr._fromIdTokenResponse(e,i,r),o=mC(i);return new Dh({user:s,providerId:o,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const r=mC(i);return new Dh({user:e,providerId:r,_tokenResponse:i,operationType:t})}}function mC(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class m_ extends Us{constructor(e,t,i,r){super(t.code,t.message),this.operationType=i,this.user=r,Object.setPrototypeOf(this,m_.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,r){return new m_(e,t,i,r)}}function XN(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?m_._fromErrorAndOperation(n,s,e,i):s})}async function l$(n,e,t=!1){const i=await yg(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Dh._forOperation(n,"link",i)}async function c$(n,e,t=!1){const{auth:i}=n;if(Yr(i.app))return Promise.reject(ic(i));const r="reauthenticate";try{const s=await yg(n,XN(i,r,e,n),t);He(s.idToken,i,"internal-error");const o=KS(s.idToken);He(o,i,"internal-error");const{sub:a}=o;return He(n.uid===a,i,"user-mismatch"),Dh._forOperation(n,r,s)}catch(s){throw s?.code==="auth/user-not-found"&&To(i,"user-mismatch"),s}}async function u$(n,e,t=!1){if(Yr(n.app))return Promise.reject(ic(n));const i="signIn",r=await XN(n,i,e),s=await Dh._fromIdTokenResponse(n,i,r);return t||await n._updateCurrentUser(s.user),s}function h$(n,e,t,i){return ui(n).onIdTokenChanged(e,t,i)}function d$(n,e,t){return ui(n).beforeAuthStateChanged(e,t)}const p_="__sak";class QN{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(p_,"1"),this.storage.removeItem(p_),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const f$=1e3,g$=10;class ZN extends QN{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=WN(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),r=this.localCache[t];i!==r&&e(t,r,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,a,c)=>{this.notifyListeners(o,c)});return}const i=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const o=this.storage.getItem(i);!t&&this.localCache[i]===o||this.notifyListeners(i,o)},s=this.storage.getItem(i);Hz()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,g$):r()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},f$)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}ZN.type="LOCAL";const m$=ZN;class JN extends QN{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}JN.type="SESSION";const eO=JN;function p$(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class Ay{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(r=>r.isListeningto(e));if(t)return t;const i=new Ay(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:r,data:s}=t.data,o=this.handlersMap[r];if(!o?.size)return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:r});const a=Array.from(o).map(async h=>h(t.origin,s)),c=await p$(a);t.ports[0].postMessage({status:"done",eventId:i,eventType:r,response:c})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Ay.receivers=[];function QS(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}class _${constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let s,o;return new Promise((a,c)=>{const h=QS("",20);r.port1.start();const d=setTimeout(()=>{c(new Error("unsupported_event"))},i);o={messageChannel:r,onMessage(g){const m=g;if(m.data.eventId===h)switch(m.data.status){case"ack":clearTimeout(d),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(m.data.response);break;default:clearTimeout(d),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:h,data:t},[r.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}function Ns(){return window}function y$(n){Ns().location.href=n}function tO(){return typeof Ns().WorkerGlobalScope<"u"&&typeof Ns().importScripts=="function"}async function v$(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function E$(){return navigator?.serviceWorker?.controller||null}function w$(){return tO()?self:null}const nO="firebaseLocalStorageDb",x$=1,__="firebaseLocalStorage",iO="fbase_key";class sm{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Cy(n,e){return n.transaction([__],e?"readwrite":"readonly").objectStore(__)}function S$(){const n=indexedDB.deleteDatabase(nO);return new sm(n).toPromise()}function bw(){const n=indexedDB.open(nO,x$);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(__,{keyPath:iO})}catch(r){t(r)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(__)?e(i):(i.close(),await S$(),e(await bw()))})})}async function pC(n,e,t){const i=Cy(n,!0).put({[iO]:e,value:t});return new sm(i).toPromise()}async function I$(n,e){const t=Cy(n,!1).get(e),i=await new sm(t).toPromise();return i===void 0?null:i.value}function _C(n,e){const t=Cy(n,!0).delete(e);return new sm(t).toPromise()}const T$=800,R$=3;class rO{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await bw(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>R$)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return tO()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Ay._getInstance(w$()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await v$(),!this.activeServiceWorker)return;this.sender=new _$(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||E$()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await bw();return await pC(e,p_,"1"),await _C(e,p_),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>pC(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>I$(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>_C(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const s=Cy(r,!1).getAll();return new sm(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:r,value:s}of e)i.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(s)&&(this.notifyListeners(r,s),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!i.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),T$)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}rO.type="LOCAL";const P$=rO;new im(3e4,6e4);function A$(n,e){return e?fo(e):(He(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class ZS extends qN{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return uh(e,this._buildIdpRequest())}_linkToIdToken(e,t){return uh(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return uh(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function C$(n){return u$(n.auth,new ZS(n),n.bypassAuthState)}function M$(n){const{auth:e,user:t}=n;return He(t,e,"internal-error"),c$(t,new ZS(n),n.bypassAuthState)}async function b$(n){const{auth:e,user:t}=n;return He(t,e,"internal-error"),l$(t,new ZS(n),n.bypassAuthState)}class sO{constructor(e,t,i,r,s=!1){this.auth=e,this.resolver=i,this.user=r,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:r,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:t,sessionId:i,tenantId:s||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(c))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return C$;case"linkViaPopup":case"linkViaRedirect":return b$;case"reauthViaPopup":case"reauthViaRedirect":return M$;default:To(this.auth,"internal-error")}}resolve(e){Ro(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ro(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const k$=new im(2e3,1e4);class Hu extends sO{constructor(e,t,i,r,s){super(e,t,r,s),this.provider=i,this.authWindow=null,this.pollId=null,Hu.currentPopupAction&&Hu.currentPopupAction.cancel(),Hu.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return He(e,this.auth,"internal-error"),e}async onExecution(){Ro(this.filter.length===1,"Popup operations only handle one event");const e=QS();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Ls(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Ls(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Hu.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ls(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,k$.get())};e()}}Hu.currentPopupAction=null;const L$="pendingRedirect",p0=new Map;class N$ extends sO{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=p0.get(this.auth._key());if(!e){try{const i=await O$(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}p0.set(this.auth._key(),e)}return this.bypassAuthState||p0.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function O$(n,e){const t=F$(e),i=V$(n);if(!await i._isAvailable())return!1;const r=await i._get(t)==="true";return await i._remove(t),r}function D$(n,e){p0.set(n._key(),e)}function V$(n){return fo(n._redirectPersistence)}function F$(n){return m0(L$,n.config.apiKey,n.name)}async function G$(n,e,t=!1){if(Yr(n.app))return Promise.reject(ic(n));const i=YS(n),r=A$(i,e),o=await new N$(i,r,t).execute();return o&&!t&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,e)),o}const j$=600*1e3;class U${constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!B$(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!oO(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Ls(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=j$&&this.cachedEventUids.clear(),this.cachedEventUids.has(yC(e))}saveEventToCache(e){this.cachedEventUids.add(yC(e)),this.lastProcessedEventTime=Date.now()}}function yC(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function oO({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function B$(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return oO(n);default:return!1}}async function z$(n,e={}){return qh(n,"GET","/v1/projects",e)}const $$=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,W$=/^https?/;async function H$(n){if(n.config.emulator)return;const{authorizedDomains:e}=await z$(n);for(const t of e)try{if(K$(t))return}catch{}To(n,"unauthorized-domain")}function K$(n){const e=Cw(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===i}if(!W$.test(t))return!1;if($$.test(n))return i===n;const r=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}const q$=new im(3e4,6e4);function vC(){const n=Ns().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function Y$(n){return new Promise((e,t)=>{function i(){vC(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{vC(),t(Ls(n,"network-request-failed"))},timeout:q$.get()})}if(Ns().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Ns().gapi?.load)i();else{const r=t$("iframefcb");return Ns()[r]=()=>{gapi.load?i():t(Ls(n,"network-request-failed"))},Jz(`${e$()}?onload=${r}`).catch(s=>t(s))}}).catch(e=>{throw _0=null,e})}let _0=null;function X$(n){return _0=_0||Y$(n),_0}const Q$=new im(5e3,15e3),Z$="__/auth/iframe",J$="emulator/auth/iframe",eW={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},tW=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function nW(n){const e=n.config;He(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?WS(e,J$):`https://${n.config.authDomain}/${Z$}`,i={apiKey:e.apiKey,appName:n.name,v:Nc},r=tW.get(n.config.apiHost);r&&(i.eid=r);const s=n._getFrameworks();return s.length&&(i.fw=s.join(",")),`${t}?${Hg(i).slice(1)}`}async function iW(n){const e=await X$(n),t=Ns().gapi;return He(t,n,"internal-error"),e.open({where:document.body,url:nW(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:eW,dontclear:!0},i=>new Promise(async(r,s)=>{await i.restyle({setHideOnLeave:!1});const o=Ls(n,"network-request-failed"),a=Ns().setTimeout(()=>{s(o)},Q$.get());function c(){Ns().clearTimeout(a),r(i)}i.ping(c).then(c,()=>{s(o)})}))}const rW={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},sW=500,oW=600,aW="_blank",lW="http://localhost";class EC{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function cW(n,e,t,i=sW,r=oW){const s=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString();let a="";const c={...rW,width:i.toString(),height:r.toString(),top:s,left:o},h=wn().toLowerCase();t&&(a=jN(h)?aW:t),FN(h)&&(e=e||lW,c.scrollbars="yes");const d=Object.entries(c).reduce((m,[y,w])=>`${m}${y}=${w},`,"");if(Wz(h)&&a!=="_self")return uW(e||"",a),new EC(null);const g=window.open(e||"",a,d);He(g,n,"popup-blocked");try{g.focus()}catch{}return new EC(g)}function uW(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}const hW="__/auth/handler",dW="emulator/auth/handler",fW=encodeURIComponent("fac");async function wC(n,e,t,i,r,s){He(n.config.authDomain,n,"auth-domain-config-required"),He(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:Nc,eventId:r};if(e instanceof YN){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",xG(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,g]of Object.entries({}))o[d]=g}if(e instanceof rm){const d=e.getScopes().filter(g=>g!=="");d.length>0&&(o.scopes=d.join(","))}n.tenantId&&(o.tid=n.tenantId);const a=o;for(const d of Object.keys(a))a[d]===void 0&&delete a[d];const c=await n._getAppCheckToken(),h=c?`#${fW}=${encodeURIComponent(c)}`:"";return`${gW(n)}?${Hg(a).slice(1)}${h}`}function gW({config:n}){return n.emulator?WS(n,dW):`https://${n.authDomain}/${hW}`}const iE="webStorageSupport";class mW{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=eO,this._completeRedirectFn=G$,this._overrideRedirectResult=D$}async _openPopup(e,t,i,r){Ro(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const s=await wC(e,t,i,Cw(),r);return cW(e,s,QS())}async _openRedirect(e,t,i,r){await this._originValidation(e);const s=await wC(e,t,i,Cw(),r);return y$(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:r,promise:s}=this.eventManagers[t];return r?Promise.resolve(r):(Ro(s,"If manager is not set, promise should be"),s)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await iW(e),i=new U$(e);return t.register("authEvent",r=>(He(r?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(iE,{type:iE},r=>{const s=r?.[0]?.[iE];s!==void 0&&t(!!s),To(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=H$(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return WN()||GN()||qS()}}const pW=mW;var xC="@firebase/auth",SC="1.12.0";class _W{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){He(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function yW(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function vW(n){mc(new Ba("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=i.options;He(o&&!o.includes(":"),"invalid-api-key",{appName:i.name});const c={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:HN(n)},h=new Qz(i,r,s,c);return i$(h,t),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),mc(new Ba("auth-internal",e=>{const t=YS(e.getProvider("auth").getImmediate());return(i=>new _W(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ms(xC,SC,yW(n)),Ms(xC,SC,"esm2020")}const EW=300,wW=ck("authIdTokenMaxAge")||EW;let IC=null;const xW=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>wW)return;const r=t?.token;IC!==r&&(IC=r,await fetch(n,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function SW(n=Jx()){const e=sy(n,"auth");if(e.isInitialized())return e.getImmediate();const t=n$(n,{popupRedirectResolver:pW,persistence:[P$,m$,eO]}),i=ck("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(i,location.origin);if(location.origin===s.origin){const o=xW(s.toString());d$(t,o,()=>o(t.currentUser)),h$(t,a=>o(a))}}const r=ok("auth");return r&&r$(t,`http://${r}`),t}function IW(){return document.getElementsByTagName("head")?.[0]??document}Zz({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=r=>{const s=Ls("internal-error");s.customData=r,t(s)},i.type="text/javascript",i.charset="UTF-8",IW().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});vW("Browser");const aO="firebasestorage.googleapis.com",TW="storageBucket",RW=120*1e3,PW=600*1e3;class Bs extends Us{constructor(e,t,i=0){super(rE(e),`Firebase Storage: ${t} (${rE(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Bs.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return rE(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Fs;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Fs||(Fs={}));function rE(n){return"storage/"+n}function AW(){const n="An unknown error occurred, please check the error payload for server response.";return new Bs(Fs.UNKNOWN,n)}function CW(){return new Bs(Fs.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function MW(){return new Bs(Fs.CANCELED,"User canceled the upload/download.")}function bW(n){return new Bs(Fs.INVALID_URL,"Invalid URL '"+n+"'.")}function kW(n){return new Bs(Fs.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function TC(n){return new Bs(Fs.INVALID_ARGUMENT,n)}function lO(){return new Bs(Fs.APP_DELETED,"The Firebase app was deleted.")}function LW(n){return new Bs(Fs.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}class Qr{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=Qr.makeFromUrl(e,t)}catch{return new Qr(e,"")}if(i.path==="")return i;throw kW(e)}static makeFromUrl(e,t){let i=null;const r="([A-Za-z0-9.\\-_]+)";function s(D){D.path.charAt(D.path.length-1)==="/"&&(D.path_=D.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+r+o,"i"),c={bucket:1,path:3};function h(D){D.path_=decodeURIComponent(D.path)}const d="v[A-Za-z0-9_]+",g=t.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",y=new RegExp(`^https?://${g}/${d}/b/${r}/o${m}`,"i"),w={bucket:1,path:3},T=t===aO?"(?:storage.googleapis.com|storage.cloud.google.com)":t,E="([^?#]*)",P=new RegExp(`^https?://${T}/${r}/${E}`,"i"),N=[{regex:a,indices:c,postModify:s},{regex:y,indices:w,postModify:h},{regex:P,indices:{bucket:1,path:2},postModify:h}];for(let D=0;D<N.length;D++){const j=N[D],W=j.regex.exec(e);if(W){const L=W[j.indices.bucket];let A=W[j.indices.path];A||(A=""),i=new Qr(L,A),j.postModify(i);break}}if(i==null)throw bW(e);return i}}class NW{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function OW(n,e,t){let i=1,r=null,s=null,o=!1,a=0;function c(){return a===2}let h=!1;function d(...E){h||(h=!0,e.apply(null,E))}function g(E){r=setTimeout(()=>{r=null,n(y,c())},E)}function m(){s&&clearTimeout(s)}function y(E,...P){if(h){m();return}if(E){m(),d.call(null,E,...P);return}if(c()||o){m(),d.call(null,E,...P);return}i<64&&(i*=2);let N;a===1?(a=2,N=0):N=(i+Math.random())*1e3,g(N)}let w=!1;function T(E){w||(w=!0,m(),!h&&(r!==null?(E||(a=2),clearTimeout(r),g(0)):E||(a=1)))}return g(0),s=setTimeout(()=>{o=!0,T(!0)},t),T}function DW(n){n(!1)}function VW(n){return n!==void 0}function RC(n,e,t,i){if(i<e)throw TC(`Invalid value for '${n}'. Expected ${e} or greater.`);if(i>t)throw TC(`Invalid value for '${n}'. Expected ${t} or less.`)}function FW(n){const e=encodeURIComponent;let t="?";for(const i in n)if(n.hasOwnProperty(i)){const r=e(i)+"="+e(n[i]);t=t+r+"&"}return t=t.slice(0,-1),t}var y_;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(y_||(y_={}));function GW(n,e){const t=n>=500&&n<600,r=[408,429].indexOf(n)!==-1,s=e.indexOf(n)!==-1;return t||r||s}class jW{constructor(e,t,i,r,s,o,a,c,h,d,g,m=!0,y=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=r,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=c,this.timeout_=h,this.progressCallback_=d,this.connectionFactory_=g,this.retry=m,this.isUsingEmulator=y,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((w,T)=>{this.resolve_=w,this.reject_=T,this.start_()})}start_(){const e=(i,r)=>{if(r){i(!1,new Wp(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const o=a=>{const c=a.loaded,h=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,h)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const a=s.getErrorCode()===y_.NO_ERROR,c=s.getStatus();if(!a||GW(c,this.additionalRetryCodes_)&&this.retry){const d=s.getErrorCode()===y_.ABORT;i(!1,new Wp(!1,null,d));return}const h=this.successCodes_.indexOf(c)!==-1;i(!0,new Wp(h,s))})},t=(i,r)=>{const s=this.resolve_,o=this.reject_,a=r.connection;if(r.wasSuccessCode)try{const c=this.callback_(a,a.getResponse());VW(c)?s(c):s()}catch(c){o(c)}else if(a!==null){const c=AW();c.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,c)):o(c)}else if(r.canceled){const c=this.appDelete_?lO():MW();o(c)}else{const c=CW();o(c)}};this.canceled_?t(!1,new Wp(!1,null,!0)):this.backoffId_=OW(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&DW(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Wp{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function UW(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function BW(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function zW(n,e){e&&(n["X-Firebase-GMPID"]=e)}function $W(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function WW(n,e,t,i,r,s,o=!0,a=!1){const c=FW(n.urlParams),h=n.url+c,d=Object.assign({},n.headers);return zW(d,e),UW(d,t),BW(d,s),$W(d,i),new jW(h,n.method,d,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,r,o,a)}function HW(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function KW(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}class v_{constructor(e,t){this._service=e,t instanceof Qr?this._location=t:this._location=Qr.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new v_(e,t)}get root(){const e=new Qr(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return KW(this._location.path)}get storage(){return this._service}get parent(){const e=HW(this._location.path);if(e===null)return null;const t=new Qr(this._location.bucket,e);return new v_(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw LW(e)}}function PC(n,e){const t=e?.[TW];return t==null?null:Qr.makeFromBucketSpec(t,n)}function qW(n,e,t,i={}){n.host=`${e}:${t}`;const r=Lc(e);r&&(Yx(`https://${n.host}/b`),Xx("Storage",!0)),n._isUsingEmulator=!0,n._protocol=r?"https":"http";const{mockUserToken:s}=i;s&&(n._overrideAuthToken=typeof s=="string"?s:uk(s,n.app.options.projectId))}class YW{constructor(e,t,i,r,s,o=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=r,this._firebaseVersion=s,this._isUsingEmulator=o,this._bucket=null,this._host=aO,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=RW,this._maxUploadRetryTime=PW,this._requests=new Set,r!=null?this._bucket=Qr.makeFromBucketSpec(r,this._host):this._bucket=PC(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Qr.makeFromBucketSpec(this._url,e):this._bucket=PC(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){RC("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){RC("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Yr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new v_(this,e)}_makeRequest(e,t,i,r,s=!0){if(this._deleted)return new NW(lO());{const o=WW(e,this._appId,i,r,t,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,t){const[i,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,r).getPromise()}}const AC="@firebase/storage",CC="0.14.0";const cO="storage";function XW(n=Jx(),e){n=ui(n);const i=sy(n,cO).getImmediate({identifier:e}),r=ak("storage");return r&&QW(i,...r),i}function QW(n,e,t,i={}){qW(n,e,t,i)}function ZW(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),i=n.getProvider("auth-internal"),r=n.getProvider("app-check-internal");return new YW(t,i,r,e,Nc)}function JW(){mc(new Ba(cO,ZW,"PUBLIC").setMultipleInstances(!0)),Ms(AC,CC,""),Ms(AC,CC,"esm2020")}JW();const eH={apiKey:"REPLACE_WITH_YOUR_API_KEY",authDomain:"your-project.firebaseapp.com",projectId:"your-project-id",storageBucket:"your-project.appspot.com",messagingSenderId:"123456789",appId:"1:123456789:web:abcdef"},JS=_k(eH);SW(JS);const df=tz(JS);XW(JS);nz(df).catch(n=>{n.code==="failed-precondition"?console.warn("Offline persistence failed: Multiple tabs open"):n.code==="unimplemented"&&console.warn("Offline persistence not available in this browser")});Mo()(kc((n,e)=>({vondsten:[],loading:!1,error:null,loadVondsten:async t=>{n(i=>{i.loading=!0});try{const i=mz(nC(df,"vondsten"),pz("userId","==",t)),s=(await wz(i)).docs.map(o=>({id:o.id,...o.data()}));n(o=>{o.vondsten=s,o.loading=!1})}catch(i){n(r=>{r.error=i.message,r.loading=!1})}},addVondst:async t=>{const i=new Date().toISOString(),r={...t,createdAt:i,updatedAt:i},s=await Iz(nC(df,"vondsten"),r);return n(o=>{o.vondsten.push({...r,id:s.id})}),s.id},updateVondst:async(t,i)=>{const r=Pw(df,"vondsten",t);await xz(r,{...i,updatedAt:new Date().toISOString()}),n(s=>{const o=s.vondsten.findIndex(a=>a.id===t);o!==-1&&(s.vondsten[o]={...s.vondsten[o],...i})})},deleteVondst:async t=>{await Sz(Pw(df,"vondsten",t)),n(i=>{i.vondsten=i.vondsten.filter(r=>r.id!==t)})}})));const tH={};function nH(n,e){let t;try{t=n()}catch{return}return{getItem:r=>{var s;const o=c=>c===null?null:JSON.parse(c,void 0),a=(s=t.getItem(r))!=null?s:null;return a instanceof Promise?a.then(o):o(a)},setItem:(r,s)=>t.setItem(r,JSON.stringify(s,void 0)),removeItem:r=>t.removeItem(r)}}const vg=n=>e=>{try{const t=n(e);return t instanceof Promise?t:{then(i){return vg(i)(t)},catch(i){return this}}}catch(t){return{then(i){return this},catch(i){return vg(i)(t)}}}},iH=(n,e)=>(t,i,r)=>{let s={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:E=>E,version:0,merge:(E,P)=>({...P,...E}),...e},o=!1;const a=new Set,c=new Set;let h;try{h=s.getStorage()}catch{}if(!h)return n((...E)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(...E)},i,r);const d=vg(s.serialize),g=()=>{const E=s.partialize({...i()});let P;const M=d({state:E,version:s.version}).then(N=>h.setItem(s.name,N)).catch(N=>{P=N});if(P)throw P;return M},m=r.setState;r.setState=(E,P)=>{m(E,P),g()};const y=n((...E)=>{t(...E),g()},i,r);let w;const T=()=>{var E;if(!h)return;o=!1,a.forEach(M=>M(i()));const P=((E=s.onRehydrateStorage)==null?void 0:E.call(s,i()))||void 0;return vg(h.getItem.bind(h))(s.name).then(M=>{if(M)return s.deserialize(M)}).then(M=>{if(M)if(typeof M.version=="number"&&M.version!==s.version){if(s.migrate)return s.migrate(M.state,M.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return M.state}).then(M=>{var N;return w=s.merge(M,(N=i())!=null?N:y),t(w,!0),g()}).then(()=>{P?.(w,void 0),o=!0,c.forEach(M=>M(w))}).catch(M=>{P?.(void 0,M)})};return r.persist={setOptions:E=>{s={...s,...E},E.getStorage&&(h=E.getStorage())},clearStorage:()=>{h?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>T(),hasHydrated:()=>o,onHydrate:E=>(a.add(E),()=>{a.delete(E)}),onFinishHydration:E=>(c.add(E),()=>{c.delete(E)})},T(),w||y},rH=(n,e)=>(t,i,r)=>{let s={storage:nH(()=>localStorage),partialize:T=>T,version:0,merge:(T,E)=>({...E,...T}),...e},o=!1;const a=new Set,c=new Set;let h=s.storage;if(!h)return n((...T)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(...T)},i,r);const d=()=>{const T=s.partialize({...i()});return h.setItem(s.name,{state:T,version:s.version})},g=r.setState;r.setState=(T,E)=>{g(T,E),d()};const m=n((...T)=>{t(...T),d()},i,r);r.getInitialState=()=>m;let y;const w=()=>{var T,E;if(!h)return;o=!1,a.forEach(M=>{var N;return M((N=i())!=null?N:m)});const P=((E=s.onRehydrateStorage)==null?void 0:E.call(s,(T=i())!=null?T:m))||void 0;return vg(h.getItem.bind(h))(s.name).then(M=>{if(M)if(typeof M.version=="number"&&M.version!==s.version){if(s.migrate)return[!0,s.migrate(M.state,M.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,M.state];return[!1,void 0]}).then(M=>{var N;const[D,j]=M;if(y=s.merge(j,(N=i())!=null?N:m),t(y,!0),D)return d()}).then(()=>{P?.(y,void 0),y=i(),o=!0,c.forEach(M=>M(y))}).catch(M=>{P?.(void 0,M)})};return r.persist={setOptions:T=>{s={...s,...T},T.storage&&(h=T.storage)},clearStorage:()=>{h?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>w(),hasHydrated:()=>o,onHydrate:T=>(a.add(T),()=>{a.delete(T)}),onFinishHydration:T=>(c.add(T),()=>{c.delete(T)})},s.skipHydration||w(),y||m},sH=(n,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((tH?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),iH(n,e)):rH(n,e),uO=sH,eI=Mo()(uO(n=>({defaultBackground:"CartoDB (licht)",showScaleBar:!0,gpsAutoStart:!1,headingUpMode:!1,showAccuracyCircle:!0,hapticFeedback:!0,setDefaultBackground:e=>n({defaultBackground:e}),setShowScaleBar:e=>n({showScaleBar:e}),setGpsAutoStart:e=>n({gpsAutoStart:e}),setHeadingUpMode:e=>n({headingUpMode:e}),setShowAccuracyCircle:e=>n({showAccuracyCircle:e}),setHapticFeedback:e=>n({hapticFeedback:e})}),{name:"detectorapp-settings"})),MC=[{id:"detectie",name:"Detectie",icon:"Compass",layers:["AHN4 Multi-Hillshade NL","AHN 0.5m","Geomorfologie","AMK Monumenten"],isBuiltIn:!0},{id:"uiterwaarden",name:"Uiterwaarden",icon:"Waves",layers:["UIKAV Punten","UIKAV Vlakken","UIKAV Expert","UIKAV Buffer","UIKAV Indeling"],isBuiltIn:!0},{id:"recreatie",name:"Recreatie",icon:"TreePalm",layers:["Parken","Speeltuinen","Strandjes"],isBuiltIn:!0},{id:"hillshade",name:"Hillshade",icon:"Mountain",layers:["AHN 0.5m","Geomorfologie","AHN4 Multi-Hillshade NL"],isBuiltIn:!0},{id:"analyse",name:"Analyse",icon:"Search",layers:["IKAW","Geomorfologie","Bodemkaart","AHN4 Multi-Hillshade NL","AMK Monumenten"],isBuiltIn:!0},{id:"woii",name:"WOII",icon:"Target",layers:["WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Militaire Objecten"],isBuiltIn:!0},{id:"percelen",name:"Percelen",icon:"Grid",layers:["Gewaspercelen","Kadastrale Grenzen","AMK Monumenten"],isBuiltIn:!0}],bC=["Hunebedden","FAMKE Steentijd","Grafheuvels","Terpen","AMK Monumenten","Romeinse wegen","Kastelen","IKAW","Archeo Landschappen","Rijksmonumenten","Werelderfgoed","WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Inundatiegebieden","Militaire Objecten","Paleokaart 800 n.Chr.","Paleokaart 100 n.Chr.","Paleokaart 500 v.Chr.","Paleokaart 1500 v.Chr.","Paleokaart 2750 v.Chr.","Paleokaart 5500 v.Chr.","Paleokaart 9000 v.Chr.","Religieus Erfgoed","UIKAV Punten","UIKAV Vlakken","UIKAV Buffer","UIKAV Expert","UIKAV Indeling","AHN4 Hillshade NL","AHN4 Multi-Hillshade NL","AHN 0.5m","World Hillshade","Veengebieden","Geomorfologie","Bodemkaart","Fossielen Nederland","Fossielen Belgi","Fossielen Duitsland","Fossielen Frankrijk","Parken","Speeltuinen","Musea","Strandjes","Gewaspercelen","Kadastrale Grenzen","Scheepswrakken","Woonheuvels ZH","Romeinse Forten","Windmolens","Erfgoedlijnen","Oude Kernen","Relictenkaart Punten","Relictenkaart Lijnen","Relictenkaart Vlakken","Verdronken Dorpen"],hO=Mo()(uO((n,e)=>({presets:[...MC],applyPreset:t=>{const i=e().presets.find(s=>s.id===t);if(!i)return;const r=ai.getState();bC.forEach(s=>r.setLayerVisibility(s,!1)),i.layers.forEach(s=>r.setLayerVisibility(s,!0)),console.log(` Preset toegepast: ${i.name}`)},createPreset:(t,i)=>{const r=ai.getState(),s=Object.entries(r.visible).filter(([a,c])=>c&&bC.includes(a)).map(([a])=>a),o={id:`custom-${Date.now()}`,name:t,icon:i,layers:s,isBuiltIn:!1};n(a=>({presets:[...a.presets,o]})),console.log(` Preset aangemaakt: ${t} met ${s.length} lagen`)},updatePreset:(t,i)=>{n(r=>({presets:r.presets.map(s=>s.id===t&&!s.isBuiltIn?{...s,...i}:s)}))},deletePreset:t=>{n(i=>({presets:i.presets.filter(r=>r.id!==t||r.isBuiltIn)}))},resetToDefaults:()=>{n({presets:[...MC]})}}),{name:"detectorapp-presets"}));function oH({target:n,viewOptions:e}){const t=se.useRef(null),i=se.useRef(null),r=Ei(o=>o.setMap),s=eI(o=>o.showScaleBar);return se.useEffect(()=>{if(!t.current){const o={center:[5.1214,52.0907],zoom:8,rotation:0,minZoom:3,maxZoom:19,...e},a=new R9({target:n,controls:[],view:new Ts({center:ac(o.center),zoom:o.zoom,rotation:o.rotation,minZoom:o.minZoom,maxZoom:o.maxZoom})});t.current=a,r(a),window.__olMap=a}return()=>{t.current&&(t.current.setTarget(void 0),r(null),window.__olMap=null)}},[n,e,r]),se.useEffect(()=>{const o=t.current;o&&(s?i.current||(i.current=new C9({units:"metric",bar:!1,text:!0,minWidth:80}),o.addControl(i.current)):i.current&&(o.removeControl(i.current),i.current=null))},[s]),t.current}const aH="https://router.project-osrm.org/route/v1/driving";function lH(n,e){const t={depart:"Start de route",arrive:"U bent aangekomen","turn-left":"Sla linksaf","turn-right":"Sla rechtsaf","turn-slight-left":"Houd links aan","turn-slight-right":"Houd rechts aan","turn-sharp-left":"Sla scherp linksaf","turn-sharp-right":"Sla scherp rechtsaf",uturn:"Keer om",straight:"Ga rechtdoor",merge:"Voeg in","on-ramp":"Neem de oprit","off-ramp":"Neem de afrit","fork-left":"Houd links aan bij de splitsing","fork-right":"Houd rechts aan bij de splitsing","end-of-road-left":"Sla linksaf aan het einde van de weg","end-of-road-right":"Sla rechtsaf aan het einde van de weg",roundabout:"Neem de rotonde",rotary:"Neem de rotonde",continue:"Blijf de weg volgen",notification:"Let op"},i=e?`${n}-${e}`:n;return t[i]||t[n]||"Volg de route"}function kC(n,e){const i=(e.lat-n.lat)*Math.PI/180,r=(e.lng-n.lng)*Math.PI/180,s=Math.sin(i/2)*Math.sin(i/2)+Math.cos(n.lat*Math.PI/180)*Math.cos(e.lat*Math.PI/180)*Math.sin(r/2)*Math.sin(r/2);return 6371e3*(2*Math.atan2(Math.sqrt(s),Math.sqrt(1-s)))}const on=Mo()(kc((n,e)=>({isNavigating:!1,destination:null,destinationName:null,routeCoordinates:null,distance:null,duration:null,loading:!1,error:null,steps:[],currentStepIndex:0,voiceEnabled:!0,lastSpokenStep:-1,lastSpokenTime:0,lastSpokenDistance:-1,startNavigation:async(t,i,r)=>{n(s=>{s.loading=!0,s.error=null});try{const s=`${aH}/${r.lng},${r.lat};${t.lng},${t.lat}?overview=full&geometries=geojson&steps=true`,o=await fetch(s);if(!o.ok)throw new Error("Route berekening mislukt");const a=await o.json();if(a.code==="Ok"&&a.routes&&a.routes.length>0){const c=a.routes[0],h=c.geometry.coordinates.map(g=>({lng:g[0],lat:g[1]})),d=[];if(c.legs&&c.legs[0]&&c.legs[0].steps)for(const g of c.legs[0].steps){const m=g.maneuver?.type||"continue",y=g.maneuver?.modifier;d.push({instruction:lH(m,y),maneuver:y?`${m}-${y}`:m,distance:g.distance||0,duration:g.duration||0,location:{lng:g.maneuver?.location?.[0]||r.lng,lat:g.maneuver?.location?.[1]||r.lat}})}if(n(g=>{g.isNavigating=!0,g.destination=t,g.destinationName=i,g.routeCoordinates=h,g.distance=c.distance,g.duration=c.duration,g.steps=d,g.currentStepIndex=0,g.lastSpokenStep=-1,g.loading=!1}),d.length>0){const g=d[0],m=g.distance>1e3?`${(g.distance/1e3).toFixed(1)} kilometer`:`${Math.round(g.distance)} meter`;e().speakInstruction(`${g.instruction}. Over ${m}.`)}console.log(` Navigation started to ${i}`),console.log(` Distance: ${(c.distance/1e3).toFixed(1)} km`),console.log(` Duration: ${Math.round(c.duration/60)} min`),console.log(` Steps: ${d.length}`)}else throw new Error(a.message||"Geen route gevonden")}catch(s){console.error("Navigation error:",s),n(o=>{o.loading=!1,o.error=s.message||"Navigatie fout"})}},stopNavigation:()=>{"speechSynthesis"in window&&window.speechSynthesis.cancel(),n(t=>{t.isNavigating=!1,t.destination=null,t.destinationName=null,t.routeCoordinates=null,t.distance=null,t.duration=null,t.error=null,t.steps=[],t.currentStepIndex=0,t.lastSpokenStep=-1,t.lastSpokenTime=0,t.lastSpokenDistance=-1}),console.log(" Navigation stopped")},clearError:()=>{n(t=>{t.error=null})},updateCurrentStep:t=>{const{steps:i,currentStepIndex:r,lastSpokenStep:s,lastSpokenTime:o,lastSpokenDistance:a,voiceEnabled:c}=e();if(i.length===0)return;const h=Date.now(),d=5e3;let g=r;for(let m=r;m<i.length;m++){const y=i[m].location;kC(t,y)<30&&(g=Math.min(m+1,i.length-1))}if(g!==r&&(n(m=>{m.currentStepIndex=g}),c&&g!==s&&g<i.length&&h-o>d)){const m=i[g],y=m.distance>1e3?`${(m.distance/1e3).toFixed(1)} kilometer`:`${Math.round(m.distance)} meter`;e().speakInstruction(`${m.instruction}. Over ${y}.`),n(w=>{w.lastSpokenStep=g,w.lastSpokenTime=h,w.lastSpokenDistance=-1})}if(c&&r<i.length){const m=i[r],y=kC(t,m.location);if(h-o<d)return;const w=[200,100,50];for(const T of w)if(y<=T&&y>T-30&&(a===-1||Math.abs(a-T)>30)&&m.maneuver!=="depart"&&m.maneuver!=="arrive"){e().speakInstruction(`Over ${T} meter, ${m.instruction.toLowerCase()}.`),n(E=>{E.lastSpokenTime=h,E.lastSpokenDistance=T});break}}},setVoiceEnabled:t=>{n(i=>{i.voiceEnabled=t}),!t&&"speechSynthesis"in window&&window.speechSynthesis.cancel()},speakInstruction:t=>{if(e().voiceEnabled&&"speechSynthesis"in window){window.speechSynthesis.cancel();const i=new SpeechSynthesisUtterance(t);i.lang="nl-NL",i.rate=1,i.pitch=1,i.volume=1;const s=window.speechSynthesis.getVoices().find(o=>o.lang.startsWith("nl"));s&&(i.voice=s),window.speechSynthesis.speak(i),console.log(` Speaking: ${t}`)}}}))),cH=["CartoDB (licht)","OpenStreetMap","Luchtfoto","TMK 1850","Bonnebladen 1900"];function uH(){const n=se.useRef(null),e=se.useRef(!1);oH({target:"map"});const t=Ei(h=>h.map),i=ai(h=>h.registerLayer),r=ai(h=>h.setLayerVisibility),s=on(h=>h.isNavigating),o=eI(h=>h.defaultBackground);se.useEffect(()=>{if(!t){console.warn(" Map not initialized yet");return}console.log(" Initializing map layers...");const h=new Ll({properties:{title:"OpenStreetMap",type:"base"},visible:!1,source:new WF}),d=new Ll({properties:{title:"CartoDB (licht)",type:"base"},visible:!0,source:new Vu({url:"https://{a-d}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",attributions:" OpenStreetMap contributors  CARTO"})}),g=new Ll({properties:{title:"Luchtfoto",type:"base"},visible:!1,source:new Vu({url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",attributions:" Esri, Maxar, Earthstar Geographics",maxZoom:19})}),m=new Ll({properties:{title:"Labels Overlay",type:"overlay"},visible:!1,source:new Vu({url:"https://{a-d}.basemaps.cartocdn.com/rastertiles/voyager_only_labels/{z}/{x}/{y}.png",attributions:" OpenStreetMap contributors  CARTO",maxZoom:20}),zIndex:100}),y=new Ll({properties:{title:"TMK 1850",type:"base"},visible:!1,source:new Vu({url:"https://s.map5.nl/map/gast/tiles/tmk_1850/EPSG3857/{z}/{x}/{y}.png",attributions:" Kadaster / Map5.nl",crossOrigin:"anonymous",maxZoom:14})}),w=new Ll({properties:{title:"Bonnebladen 1900",type:"base"},visible:!1,source:new Vu({url:"https://s.map5.nl/map/gast/tiles/bonne_1900/EPSG3857/{z}/{x}/{y}.png",attributions:" Kadaster / Map5.nl",crossOrigin:"anonymous",maxZoom:14})});t.addLayer(h),t.addLayer(d),t.addLayer(g),t.addLayer(m),t.addLayer(y),t.addLayer(w),console.log(" Base layers added:",{osm:h.getVisible(),cartodb:d.getVisible(),satellite:g.getVisible()}),i("OpenStreetMap",h),i("CartoDB (licht)",d),i("Luchtfoto",g),i("Labels Overlay",m),i("TMK 1850",y),i("Bonnebladen 1900",w),t.updateSize(),console.log(" Map size:",t.getSize()),console.log(" Map center:",t.getView().getCenter()),console.log(" Map zoom:",t.getView().getZoom()),a()},[t,i]);async function a(){if(!t){console.error(" Cannot load layers: map is null");return}const h=nG();console.log(` Loading ${h.length} immediate-load layers (WMS/Tile)...`);const d=await Promise.allSettled(h.map(async m=>{try{const y=await m.factory();return y?{name:m.name,layer:y}:null}catch(y){return console.warn(` Failed to create ${m.name}:`,y),null}}));let g=0;d.forEach(m=>{if(m.status==="fulfilled"&&m.value){const{name:y,layer:w}=m.value;t.addLayer(w),i(y,w),g++,console.log(`   ${y}`)}}),console.log(` Immediate layers loaded: ${g}/${h.length}`),console.log(` Total layers on map: ${t.getLayers().getLength()}`),console.log(" Vector layers will load on first toggle (lazy loading enabled)")}se.useEffect(()=>{if(!t||e.current)return;const h=setTimeout(()=>{cH.forEach(d=>{r(d,d===o)}),e.current=!0,console.log(` Default background: ${o}`)},100);return()=>clearTimeout(h)},[t,o,r]);const c={width:"100%",height:"100vh",transition:"transform 0.5s ease-out",transformOrigin:"center bottom",...s?{transform:"perspective(1000px) rotateX(25deg) scale(1.1)"}:{}};return C.jsx("div",{id:"map",ref:n,style:c})}const tI=se.createContext({});function nI(n){const e=se.useRef(null);return e.current===null&&(e.current=n()),e.current}const My=se.createContext(null),iI=se.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"});class hH extends se.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const i=this.props.sizeRef.current;i.height=t.offsetHeight||0,i.width=t.offsetWidth||0,i.top=t.offsetTop,i.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function dH({children:n,isPresent:e}){const t=se.useId(),i=se.useRef(null),r=se.useRef({width:0,height:0,top:0,left:0}),{nonce:s}=se.useContext(iI);return se.useInsertionEffect(()=>{const{width:o,height:a,top:c,left:h}=r.current;if(e||!i.current||!o||!a)return;i.current.dataset.motionPopId=t;const d=document.createElement("style");return s&&(d.nonce=s),document.head.appendChild(d),d.sheet&&d.sheet.insertRule(`
          [data-motion-pop-id="${t}"] {
            position: absolute !important;
            width: ${o}px !important;
            height: ${a}px !important;
            top: ${c}px !important;
            left: ${h}px !important;
          }
        `),()=>{document.head.removeChild(d)}},[e]),C.jsx(hH,{isPresent:e,childRef:i,sizeRef:r,children:se.cloneElement(n,{ref:i})})}const fH=({children:n,initial:e,isPresent:t,onExitComplete:i,custom:r,presenceAffectsLayout:s,mode:o})=>{const a=nI(gH),c=se.useId(),h=se.useCallback(g=>{a.set(g,!0);for(const m of a.values())if(!m)return;i&&i()},[a,i]),d=se.useMemo(()=>({id:c,initial:e,isPresent:t,custom:r,onExitComplete:h,register:g=>(a.set(g,!1),()=>a.delete(g))}),s?[Math.random(),h]:[t,h]);return se.useMemo(()=>{a.forEach((g,m)=>a.set(m,!1))},[t]),se.useEffect(()=>{!t&&!a.size&&i&&i()},[t]),o==="popLayout"&&(n=C.jsx(dH,{isPresent:t,children:n})),C.jsx(My.Provider,{value:d,children:n})};function gH(){return new Map}function dO(n=!0){const e=se.useContext(My);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:i,register:r}=e,s=se.useId();se.useEffect(()=>{n&&r(s)},[n]);const o=se.useCallback(()=>n&&i&&i(s),[s,i,n]);return!t&&i?[!1,o]:[!0]}const Hp=n=>n.key||"";function LC(n){const e=[];return se.Children.forEach(n,t=>{se.isValidElement(t)&&e.push(t)}),e}const rI=typeof window<"u",fO=rI?se.useLayoutEffect:se.useEffect,Lo=({children:n,custom:e,initial:t=!0,onExitComplete:i,presenceAffectsLayout:r=!0,mode:s="sync",propagate:o=!1})=>{const[a,c]=dO(o),h=se.useMemo(()=>LC(n),[n]),d=o&&!a?[]:h.map(Hp),g=se.useRef(!0),m=se.useRef(h),y=nI(()=>new Map),[w,T]=se.useState(h),[E,P]=se.useState(h);fO(()=>{g.current=!1,m.current=h;for(let D=0;D<E.length;D++){const j=Hp(E[D]);d.includes(j)?y.delete(j):y.get(j)!==!0&&y.set(j,!1)}},[E,d.length,d.join("-")]);const M=[];if(h!==w){let D=[...h];for(let j=0;j<E.length;j++){const W=E[j],L=Hp(W);d.includes(L)||(D.splice(j,0,W),M.push(W))}s==="wait"&&M.length&&(D=M),P(LC(D)),T(h);return}const{forceRender:N}=se.useContext(tI);return C.jsx(C.Fragment,{children:E.map(D=>{const j=Hp(D),W=o&&!a?!1:h===E||d.includes(j),L=()=>{if(y.has(j))y.set(j,!0);else return;let A=!0;y.forEach(k=>{k||(A=!1)}),A&&(N?.(),P(m.current),o&&c?.(),i&&i())};return C.jsx(fH,{isPresent:W,initial:!g.current||t?void 0:!1,custom:W?void 0:e,presenceAffectsLayout:r,mode:s,onExitComplete:W?void 0:L,children:D},j)})})},nr=n=>n;let gO=nr;function sI(n){let e;return()=>(e===void 0&&(e=n()),e)}const Vh=(n,e,t)=>{const i=e-n;return i===0?1:(t-n)/i},yo=n=>n*1e3,vo=n=>n/1e3,mH={useManualTiming:!1};function pH(n){let e=new Set,t=new Set,i=!1,r=!1;const s=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function a(h){s.has(h)&&(c.schedule(h),n()),h(o)}const c={schedule:(h,d=!1,g=!1)=>{const y=g&&i?e:t;return d&&s.add(h),y.has(h)||y.add(h),h},cancel:h=>{t.delete(h),s.delete(h)},process:h=>{if(o=h,i){r=!0;return}i=!0,[e,t]=[t,e],e.forEach(a),e.clear(),i=!1,r&&(r=!1,c.process(h))}};return c}const Kp=["read","resolveKeyframes","update","preRender","render","postRender"],_H=40;function mO(n,e){let t=!1,i=!0;const r={delta:0,timestamp:0,isProcessing:!1},s=()=>t=!0,o=Kp.reduce((P,M)=>(P[M]=pH(s),P),{}),{read:a,resolveKeyframes:c,update:h,preRender:d,render:g,postRender:m}=o,y=()=>{const P=performance.now();t=!1,r.delta=i?1e3/60:Math.max(Math.min(P-r.timestamp,_H),1),r.timestamp=P,r.isProcessing=!0,a.process(r),c.process(r),h.process(r),d.process(r),g.process(r),m.process(r),r.isProcessing=!1,t&&e&&(i=!1,n(y))},w=()=>{t=!0,i=!0,r.isProcessing||n(y)};return{schedule:Kp.reduce((P,M)=>{const N=o[M];return P[M]=(D,j=!1,W=!1)=>(t||w(),N.schedule(D,j,W)),P},{}),cancel:P=>{for(let M=0;M<Kp.length;M++)o[Kp[M]].cancel(P)},state:r,steps:o}}const{schedule:Ft,cancel:qa,state:zn,steps:sE}=mO(typeof requestAnimationFrame<"u"?requestAnimationFrame:nr,!0),pO=se.createContext({strict:!1}),NC={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Fh={};for(const n in NC)Fh[n]={isEnabled:e=>NC[n].some(t=>!!e[t])};function yH(n){for(const e in n)Fh[e]={...Fh[e],...n[e]}}const vH=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function E_(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||vH.has(n)}let _O=n=>!E_(n);function EH(n){n&&(_O=e=>e.startsWith("on")?!E_(e):n(e))}try{EH(require("@emotion/is-prop-valid").default)}catch{}function wH(n,e,t){const i={};for(const r in n)r==="values"&&typeof n.values=="object"||(_O(r)||t===!0&&E_(r)||!e&&!E_(r)||n.draggable&&r.startsWith("onDrag"))&&(i[r]=n[r]);return i}function xH(n){if(typeof Proxy>"u")return n;const e=new Map,t=(...i)=>n(...i);return new Proxy(t,{get:(i,r)=>r==="create"?n:(e.has(r)||e.set(r,n(r)),e.get(r))})}const by=se.createContext({});function Eg(n){return typeof n=="string"||Array.isArray(n)}function ky(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}const oI=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],aI=["initial",...oI];function Ly(n){return ky(n.animate)||aI.some(e=>Eg(n[e]))}function yO(n){return!!(Ly(n)||n.variants)}function SH(n,e){if(Ly(n)){const{initial:t,animate:i}=n;return{initial:t===!1||Eg(t)?t:void 0,animate:Eg(i)?i:void 0}}return n.inherit!==!1?e:{}}function IH(n){const{initial:e,animate:t}=SH(n,se.useContext(by));return se.useMemo(()=>({initial:e,animate:t}),[OC(e),OC(t)])}function OC(n){return Array.isArray(n)?n.join(" "):n}const TH=Symbol.for("motionComponentSymbol");function Ku(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function RH(n,e,t){return se.useCallback(i=>{i&&n.onMount&&n.onMount(i),e&&(i?e.mount(i):e.unmount()),t&&(typeof t=="function"?t(i):Ku(t)&&(t.current=i))},[e])}const lI=n=>n.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),PH="framerAppearId",vO="data-"+lI(PH),{schedule:cI}=mO(queueMicrotask,!1),EO=se.createContext({});function AH(n,e,t,i,r){var s,o;const{visualElement:a}=se.useContext(by),c=se.useContext(pO),h=se.useContext(My),d=se.useContext(iI).reducedMotion,g=se.useRef(null);i=i||c.renderer,!g.current&&i&&(g.current=i(n,{visualState:e,parent:a,props:t,presenceContext:h,blockInitialAnimation:h?h.initial===!1:!1,reducedMotionConfig:d}));const m=g.current,y=se.useContext(EO);m&&!m.projection&&r&&(m.type==="html"||m.type==="svg")&&CH(g.current,t,r,y);const w=se.useRef(!1);se.useInsertionEffect(()=>{m&&w.current&&m.update(t,h)});const T=t[vO],E=se.useRef(!!T&&!(!((s=window.MotionHandoffIsComplete)===null||s===void 0)&&s.call(window,T))&&((o=window.MotionHasOptimisedAnimation)===null||o===void 0?void 0:o.call(window,T)));return fO(()=>{m&&(w.current=!0,window.MotionIsMounted=!0,m.updateFeatures(),cI.render(m.render),E.current&&m.animationState&&m.animationState.animateChanges())}),se.useEffect(()=>{m&&(!E.current&&m.animationState&&m.animationState.animateChanges(),E.current&&(queueMicrotask(()=>{var P;(P=window.MotionHandoffMarkAsComplete)===null||P===void 0||P.call(window,T)}),E.current=!1))}),m}function CH(n,e,t,i){const{layoutId:r,layout:s,drag:o,dragConstraints:a,layoutScroll:c,layoutRoot:h}=e;n.projection=new t(n.latestValues,e["data-framer-portal-id"]?void 0:wO(n.parent)),n.projection.setOptions({layoutId:r,layout:s,alwaysMeasureLayout:!!o||a&&Ku(a),visualElement:n,animationType:typeof s=="string"?s:"both",initialPromotionConfig:i,layoutScroll:c,layoutRoot:h})}function wO(n){if(n)return n.options.allowProjection!==!1?n.projection:wO(n.parent)}function MH({preloadedFeatures:n,createVisualElement:e,useRender:t,useVisualState:i,Component:r}){var s,o;n&&yH(n);function a(h,d){let g;const m={...se.useContext(iI),...h,layoutId:bH(h)},{isStatic:y}=m,w=IH(h),T=i(h,y);if(!y&&rI){kH();const E=LH(m);g=E.MeasureLayout,w.visualElement=AH(r,T,m,e,E.ProjectionNode)}return C.jsxs(by.Provider,{value:w,children:[g&&w.visualElement?C.jsx(g,{visualElement:w.visualElement,...m}):null,t(r,h,RH(T,w.visualElement,d),T,y,w.visualElement)]})}a.displayName=`motion.${typeof r=="string"?r:`create(${(o=(s=r.displayName)!==null&&s!==void 0?s:r.name)!==null&&o!==void 0?o:""})`}`;const c=se.forwardRef(a);return c[TH]=r,c}function bH({layoutId:n}){const e=se.useContext(tI).id;return e&&n!==void 0?e+"-"+n:n}function kH(n,e){se.useContext(pO).strict}function LH(n){const{drag:e,layout:t}=Fh;if(!e&&!t)return{};const i={...e,...t};return{MeasureLayout:e?.isEnabled(n)||t?.isEnabled(n)?i.MeasureLayout:void 0,ProjectionNode:i.ProjectionNode}}const NH=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function uI(n){return typeof n!="string"||n.includes("-")?!1:!!(NH.indexOf(n)>-1||/[A-Z]/u.test(n))}function DC(n){const e=[{},{}];return n?.values.forEach((t,i)=>{e[0][i]=t.get(),e[1][i]=t.getVelocity()}),e}function hI(n,e,t,i){if(typeof e=="function"){const[r,s]=DC(i);e=e(t!==void 0?t:n.custom,r,s)}if(typeof e=="string"&&(e=n.variants&&n.variants[e]),typeof e=="function"){const[r,s]=DC(i);e=e(t!==void 0?t:n.custom,r,s)}return e}const kw=n=>Array.isArray(n),OH=n=>!!(n&&typeof n=="object"&&n.mix&&n.toValue),DH=n=>kw(n)?n[n.length-1]||0:n,li=n=>!!(n&&n.getVelocity);function y0(n){const e=li(n)?n.get():n;return OH(e)?e.toValue():e}function VH({scrapeMotionValuesFromProps:n,createRenderState:e,onUpdate:t},i,r,s){const o={latestValues:FH(i,r,s,n),renderState:e()};return t&&(o.onMount=a=>t({props:i,current:a,...o}),o.onUpdate=a=>t(a)),o}const xO=n=>(e,t)=>{const i=se.useContext(by),r=se.useContext(My),s=()=>VH(n,e,i,r);return t?s():nI(s)};function FH(n,e,t,i){const r={},s=i(n,{});for(const m in s)r[m]=y0(s[m]);let{initial:o,animate:a}=n;const c=Ly(n),h=yO(n);e&&h&&!c&&n.inherit!==!1&&(o===void 0&&(o=e.initial),a===void 0&&(a=e.animate));let d=t?t.initial===!1:!1;d=d||o===!1;const g=d?a:o;if(g&&typeof g!="boolean"&&!ky(g)){const m=Array.isArray(g)?g:[g];for(let y=0;y<m.length;y++){const w=hI(n,m[y]);if(w){const{transitionEnd:T,transition:E,...P}=w;for(const M in P){let N=P[M];if(Array.isArray(N)){const D=d?N.length-1:0;N=N[D]}N!==null&&(r[M]=N)}for(const M in T)r[M]=T[M]}}}return r}const Yh=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Vc=new Set(Yh),SO=n=>e=>typeof e=="string"&&e.startsWith(n),IO=SO("--"),GH=SO("var(--"),dI=n=>GH(n)?jH.test(n.split("/*")[0].trim()):!1,jH=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,TO=(n,e)=>e&&typeof n=="number"?e.transform(n):n,Po=(n,e,t)=>t>e?e:t<n?n:t,Xh={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},wg={...Xh,transform:n=>Po(0,1,n)},qp={...Xh,default:1},om=n=>({test:e=>typeof e=="string"&&e.endsWith(n)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${n}`}),pa=om("deg"),Os=om("%"),Ue=om("px"),UH=om("vh"),BH=om("vw"),VC={...Os,parse:n=>Os.parse(n)/100,transform:n=>Os.transform(n*100)},zH={borderWidth:Ue,borderTopWidth:Ue,borderRightWidth:Ue,borderBottomWidth:Ue,borderLeftWidth:Ue,borderRadius:Ue,radius:Ue,borderTopLeftRadius:Ue,borderTopRightRadius:Ue,borderBottomRightRadius:Ue,borderBottomLeftRadius:Ue,width:Ue,maxWidth:Ue,height:Ue,maxHeight:Ue,top:Ue,right:Ue,bottom:Ue,left:Ue,padding:Ue,paddingTop:Ue,paddingRight:Ue,paddingBottom:Ue,paddingLeft:Ue,margin:Ue,marginTop:Ue,marginRight:Ue,marginBottom:Ue,marginLeft:Ue,backgroundPositionX:Ue,backgroundPositionY:Ue},$H={rotate:pa,rotateX:pa,rotateY:pa,rotateZ:pa,scale:qp,scaleX:qp,scaleY:qp,scaleZ:qp,skew:pa,skewX:pa,skewY:pa,distance:Ue,translateX:Ue,translateY:Ue,translateZ:Ue,x:Ue,y:Ue,z:Ue,perspective:Ue,transformPerspective:Ue,opacity:wg,originX:VC,originY:VC,originZ:Ue},FC={...Xh,transform:Math.round},fI={...zH,...$H,zIndex:FC,size:Ue,fillOpacity:wg,strokeOpacity:wg,numOctaves:FC},WH={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},HH=Yh.length;function KH(n,e,t){let i="",r=!0;for(let s=0;s<HH;s++){const o=Yh[s],a=n[o];if(a===void 0)continue;let c=!0;if(typeof a=="number"?c=a===(o.startsWith("scale")?1:0):c=parseFloat(a)===0,!c||t){const h=TO(a,fI[o]);if(!c){r=!1;const d=WH[o]||o;i+=`${d}(${h}) `}t&&(e[o]=h)}}return i=i.trim(),t?i=t(e,r?"":i):r&&(i="none"),i}function gI(n,e,t){const{style:i,vars:r,transformOrigin:s}=n;let o=!1,a=!1;for(const c in e){const h=e[c];if(Vc.has(c)){o=!0;continue}else if(IO(c)){r[c]=h;continue}else{const d=TO(h,fI[c]);c.startsWith("origin")?(a=!0,s[c]=d):i[c]=d}}if(e.transform||(o||t?i.transform=KH(e,n.transform,t):i.transform&&(i.transform="none")),a){const{originX:c="50%",originY:h="50%",originZ:d=0}=s;i.transformOrigin=`${c} ${h} ${d}`}}const qH={offset:"stroke-dashoffset",array:"stroke-dasharray"},YH={offset:"strokeDashoffset",array:"strokeDasharray"};function XH(n,e,t=1,i=0,r=!0){n.pathLength=1;const s=r?qH:YH;n[s.offset]=Ue.transform(-i);const o=Ue.transform(e),a=Ue.transform(t);n[s.array]=`${o} ${a}`}function GC(n,e,t){return typeof n=="string"?n:Ue.transform(e+t*n)}function QH(n,e,t){const i=GC(e,n.x,n.width),r=GC(t,n.y,n.height);return`${i} ${r}`}function mI(n,{attrX:e,attrY:t,attrScale:i,originX:r,originY:s,pathLength:o,pathSpacing:a=1,pathOffset:c=0,...h},d,g){if(gI(n,h,g),d){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:m,style:y,dimensions:w}=n;m.transform&&(w&&(y.transform=m.transform),delete m.transform),w&&(r!==void 0||s!==void 0||y.transform)&&(y.transformOrigin=QH(w,r!==void 0?r:.5,s!==void 0?s:.5)),e!==void 0&&(m.x=e),t!==void 0&&(m.y=t),i!==void 0&&(m.scale=i),o!==void 0&&XH(m,o,a,c,!1)}const pI=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),RO=()=>({...pI(),attrs:{}}),_I=n=>typeof n=="string"&&n.toLowerCase()==="svg";function PO(n,{style:e,vars:t},i,r){Object.assign(n.style,e,r&&r.getProjectionStyles(i));for(const s in t)n.style.setProperty(s,t[s])}const AO=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function CO(n,e,t,i){PO(n,e,void 0,i);for(const r in e.attrs)n.setAttribute(AO.has(r)?r:lI(r),e.attrs[r])}const w_={};function ZH(n){Object.assign(w_,n)}function MO(n,{layout:e,layoutId:t}){return Vc.has(n)||n.startsWith("origin")||(e||t!==void 0)&&(!!w_[n]||n==="opacity")}function yI(n,e,t){var i;const{style:r}=n,s={};for(const o in r)(li(r[o])||e.style&&li(e.style[o])||MO(o,n)||((i=t?.getValue(o))===null||i===void 0?void 0:i.liveStyle)!==void 0)&&(s[o]=r[o]);return s}function bO(n,e,t){const i=yI(n,e,t);for(const r in n)if(li(n[r])||li(e[r])){const s=Yh.indexOf(r)!==-1?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r;i[s]=n[r]}return i}function JH(n,e){try{e.dimensions=typeof n.getBBox=="function"?n.getBBox():n.getBoundingClientRect()}catch{e.dimensions={x:0,y:0,width:0,height:0}}}const jC=["x","y","width","height","cx","cy","r"],eK={useVisualState:xO({scrapeMotionValuesFromProps:bO,createRenderState:RO,onUpdate:({props:n,prevProps:e,current:t,renderState:i,latestValues:r})=>{if(!t)return;let s=!!n.drag;if(!s){for(const a in r)if(Vc.has(a)){s=!0;break}}if(!s)return;let o=!e;if(e)for(let a=0;a<jC.length;a++){const c=jC[a];n[c]!==e[c]&&(o=!0)}o&&Ft.read(()=>{JH(t,i),Ft.render(()=>{mI(i,r,_I(t.tagName),n.transformTemplate),CO(t,i)})})}})},tK={useVisualState:xO({scrapeMotionValuesFromProps:yI,createRenderState:pI})};function kO(n,e,t){for(const i in e)!li(e[i])&&!MO(i,t)&&(n[i]=e[i])}function nK({transformTemplate:n},e){return se.useMemo(()=>{const t=pI();return gI(t,e,n),Object.assign({},t.vars,t.style)},[e])}function iK(n,e){const t=n.style||{},i={};return kO(i,t,n),Object.assign(i,nK(n,e)),i}function rK(n,e){const t={},i=iK(n,e);return n.drag&&n.dragListener!==!1&&(t.draggable=!1,i.userSelect=i.WebkitUserSelect=i.WebkitTouchCallout="none",i.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(t.tabIndex=0),t.style=i,t}function sK(n,e,t,i){const r=se.useMemo(()=>{const s=RO();return mI(s,e,_I(i),n.transformTemplate),{...s.attrs,style:{...s.style}}},[e]);if(n.style){const s={};kO(s,n.style,n),r.style={...s,...r.style}}return r}function oK(n=!1){return(t,i,r,{latestValues:s},o)=>{const c=(uI(t)?sK:rK)(i,s,o,t),h=wH(i,typeof t=="string",n),d=t!==se.Fragment?{...h,...c,ref:r}:{},{children:g}=i,m=se.useMemo(()=>li(g)?g.get():g,[g]);return se.createElement(t,{...d,children:m})}}function aK(n,e){return function(i,{forwardMotionProps:r}={forwardMotionProps:!1}){const o={...uI(i)?eK:tK,preloadedFeatures:n,useRender:oK(r),createVisualElement:e,Component:i};return MH(o)}}function LO(n,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==n.length)return!1;for(let i=0;i<t;i++)if(e[i]!==n[i])return!1;return!0}function Ny(n,e,t){const i=n.getProps();return hI(i,e,t!==void 0?t:i.custom,n)}const lK=sI(()=>window.ScrollTimeline!==void 0);class cK{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,t){for(let i=0;i<this.animations.length;i++)this.animations[i][e]=t}attachTimeline(e,t){const i=this.animations.map(r=>{if(lK()&&r.attachTimeline)return r.attachTimeline(e);if(typeof t=="function")return t(r)});return()=>{i.forEach((r,s)=>{r&&r(),this.animations[s].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let t=0;t<this.animations.length;t++)e=Math.max(e,this.animations[t].duration);return e}runAll(e){this.animations.forEach(t=>t[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class uK extends cK{then(e,t){return Promise.all(this.animations).then(e).catch(t)}}function vI(n,e){return n?n[e]||n.default||n:void 0}const Lw=2e4;function NO(n){let e=0;const t=50;let i=n.next(e);for(;!i.done&&e<Lw;)e+=t,i=n.next(e);return e>=Lw?1/0:e}function EI(n){return typeof n=="function"}function UC(n,e){n.timeline=e,n.onfinish=null}const wI=n=>Array.isArray(n)&&typeof n[0]=="number",hK={linearEasing:void 0};function dK(n,e){const t=sI(n);return()=>{var i;return(i=hK[e])!==null&&i!==void 0?i:t()}}const x_=dK(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),OO=(n,e,t=10)=>{let i="";const r=Math.max(Math.round(e/t),2);for(let s=0;s<r;s++)i+=n(Vh(0,r-1,s))+", ";return`linear(${i.substring(0,i.length-2)})`};function DO(n){return!!(typeof n=="function"&&x_()||!n||typeof n=="string"&&(n in Nw||x_())||wI(n)||Array.isArray(n)&&n.every(DO))}const ff=([n,e,t,i])=>`cubic-bezier(${n}, ${e}, ${t}, ${i})`,Nw={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:ff([0,.65,.55,1]),circOut:ff([.55,0,1,.45]),backIn:ff([.31,.01,.66,-.59]),backOut:ff([.33,1.53,.69,.99])};function VO(n,e){if(n)return typeof n=="function"&&x_()?OO(n,e):wI(n)?ff(n):Array.isArray(n)?n.map(t=>VO(t,e)||Nw.easeOut):Nw[n]}const $r={x:!1,y:!1};function FO(){return $r.x||$r.y}function fK(n,e,t){var i;if(n instanceof Element)return[n];if(typeof n=="string"){let r=document;const s=(i=void 0)!==null&&i!==void 0?i:r.querySelectorAll(n);return s?Array.from(s):[]}return Array.from(n)}function GO(n,e){const t=fK(n),i=new AbortController,r={passive:!0,...e,signal:i.signal};return[t,r,()=>i.abort()]}function BC(n){return e=>{e.pointerType==="touch"||FO()||n(e)}}function gK(n,e,t={}){const[i,r,s]=GO(n,t),o=BC(a=>{const{target:c}=a,h=e(a);if(typeof h!="function"||!c)return;const d=BC(g=>{h(g),c.removeEventListener("pointerleave",d)});c.addEventListener("pointerleave",d,r)});return i.forEach(a=>{a.addEventListener("pointerenter",o,r)}),s}const jO=(n,e)=>e?n===e?!0:jO(n,e.parentElement):!1,xI=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1,mK=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function pK(n){return mK.has(n.tagName)||n.tabIndex!==-1}const gf=new WeakSet;function zC(n){return e=>{e.key==="Enter"&&n(e)}}function oE(n,e){n.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const _K=(n,e)=>{const t=n.currentTarget;if(!t)return;const i=zC(()=>{if(gf.has(t))return;oE(t,"down");const r=zC(()=>{oE(t,"up")}),s=()=>oE(t,"cancel");t.addEventListener("keyup",r,e),t.addEventListener("blur",s,e)});t.addEventListener("keydown",i,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",i),e)};function $C(n){return xI(n)&&!FO()}function yK(n,e,t={}){const[i,r,s]=GO(n,t),o=a=>{const c=a.currentTarget;if(!$C(a)||gf.has(c))return;gf.add(c);const h=e(a),d=(y,w)=>{window.removeEventListener("pointerup",g),window.removeEventListener("pointercancel",m),!(!$C(y)||!gf.has(c))&&(gf.delete(c),typeof h=="function"&&h(y,{success:w}))},g=y=>{d(y,t.useGlobalTarget||jO(c,y.target))},m=y=>{d(y,!1)};window.addEventListener("pointerup",g,r),window.addEventListener("pointercancel",m,r)};return i.forEach(a=>{!pK(a)&&a.getAttribute("tabindex")===null&&(a.tabIndex=0),(t.useGlobalTarget?window:a).addEventListener("pointerdown",o,r),a.addEventListener("focus",h=>_K(h,r),r)}),s}function vK(n){return n==="x"||n==="y"?$r[n]?null:($r[n]=!0,()=>{$r[n]=!1}):$r.x||$r.y?null:($r.x=$r.y=!0,()=>{$r.x=$r.y=!1})}const UO=new Set(["width","height","top","left","right","bottom",...Yh]);let v0;function EK(){v0=void 0}const Ds={now:()=>(v0===void 0&&Ds.set(zn.isProcessing||mH.useManualTiming?zn.timestamp:performance.now()),v0),set:n=>{v0=n,queueMicrotask(EK)}};function SI(n,e){n.indexOf(e)===-1&&n.push(e)}function II(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}class TI{constructor(){this.subscriptions=[]}add(e){return SI(this.subscriptions,e),()=>II(this.subscriptions,e)}notify(e,t,i){const r=this.subscriptions.length;if(r)if(r===1)this.subscriptions[0](e,t,i);else for(let s=0;s<r;s++){const o=this.subscriptions[s];o&&o(e,t,i)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function BO(n,e){return e?n*(1e3/e):0}const WC=30,wK=n=>!isNaN(parseFloat(n));class xK{constructor(e,t={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(i,r=!0)=>{const s=Ds.now();this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(i),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),r&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=Ds.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=wK(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new TI);const i=this.events[e].add(t);return e==="change"?()=>{i(),Ft.read(()=>{this.events.change.getSize()||this.stop()})}:i}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e,t=!0){!t||!this.passiveEffect?this.updateAndNotify(e,t):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,t,i){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-i}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=Ds.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>WC)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,WC);return BO(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function xg(n,e){return new xK(n,e)}function SK(n,e,t){n.hasValue(e)?n.getValue(e).set(t):n.addValue(e,xg(t))}function IK(n,e){const t=Ny(n,e);let{transitionEnd:i={},transition:r={},...s}=t||{};s={...s,...i};for(const o in s){const a=DH(s[o]);SK(n,o,a)}}function TK(n){return!!(li(n)&&n.add)}function Ow(n,e){const t=n.getValue("willChange");if(TK(t))return t.add(e)}function zO(n){return n.props[vO]}const $O=(n,e,t)=>(((1-3*t+3*e)*n+(3*t-6*e))*n+3*e)*n,RK=1e-7,PK=12;function AK(n,e,t,i,r){let s,o,a=0;do o=e+(t-e)/2,s=$O(o,i,r)-n,s>0?t=o:e=o;while(Math.abs(s)>RK&&++a<PK);return o}function am(n,e,t,i){if(n===e&&t===i)return nr;const r=s=>AK(s,0,1,n,t);return s=>s===0||s===1?s:$O(r(s),e,i)}const WO=n=>e=>e<=.5?n(2*e)/2:(2-n(2*(1-e)))/2,HO=n=>e=>1-n(1-e),KO=am(.33,1.53,.69,.99),RI=HO(KO),qO=WO(RI),YO=n=>(n*=2)<1?.5*RI(n):.5*(2-Math.pow(2,-10*(n-1))),PI=n=>1-Math.sin(Math.acos(n)),XO=HO(PI),QO=WO(PI),ZO=n=>/^0[^.\s]+$/u.test(n);function CK(n){return typeof n=="number"?n===0:n!==null?n==="none"||n==="0"||ZO(n):!0}const kf=n=>Math.round(n*1e5)/1e5,AI=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function MK(n){return n==null}const bK=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,CI=(n,e)=>t=>!!(typeof t=="string"&&bK.test(t)&&t.startsWith(n)||e&&!MK(t)&&Object.prototype.hasOwnProperty.call(t,e)),JO=(n,e,t)=>i=>{if(typeof i!="string")return i;const[r,s,o,a]=i.match(AI);return{[n]:parseFloat(r),[e]:parseFloat(s),[t]:parseFloat(o),alpha:a!==void 0?parseFloat(a):1}},kK=n=>Po(0,255,n),aE={...Xh,transform:n=>Math.round(kK(n))},Ql={test:CI("rgb","red"),parse:JO("red","green","blue"),transform:({red:n,green:e,blue:t,alpha:i=1})=>"rgba("+aE.transform(n)+", "+aE.transform(e)+", "+aE.transform(t)+", "+kf(wg.transform(i))+")"};function LK(n){let e="",t="",i="",r="";return n.length>5?(e=n.substring(1,3),t=n.substring(3,5),i=n.substring(5,7),r=n.substring(7,9)):(e=n.substring(1,2),t=n.substring(2,3),i=n.substring(3,4),r=n.substring(4,5),e+=e,t+=t,i+=i,r+=r),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(i,16),alpha:r?parseInt(r,16)/255:1}}const Dw={test:CI("#"),parse:LK,transform:Ql.transform},qu={test:CI("hsl","hue"),parse:JO("hue","saturation","lightness"),transform:({hue:n,saturation:e,lightness:t,alpha:i=1})=>"hsla("+Math.round(n)+", "+Os.transform(kf(e))+", "+Os.transform(kf(t))+", "+kf(wg.transform(i))+")"},ti={test:n=>Ql.test(n)||Dw.test(n)||qu.test(n),parse:n=>Ql.test(n)?Ql.parse(n):qu.test(n)?qu.parse(n):Dw.parse(n),transform:n=>typeof n=="string"?n:n.hasOwnProperty("red")?Ql.transform(n):qu.transform(n)},NK=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function OK(n){var e,t;return isNaN(n)&&typeof n=="string"&&(((e=n.match(AI))===null||e===void 0?void 0:e.length)||0)+(((t=n.match(NK))===null||t===void 0?void 0:t.length)||0)>0}const eD="number",tD="color",DK="var",VK="var(",HC="${}",FK=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Sg(n){const e=n.toString(),t=[],i={color:[],number:[],var:[]},r=[];let s=0;const a=e.replace(FK,c=>(ti.test(c)?(i.color.push(s),r.push(tD),t.push(ti.parse(c))):c.startsWith(VK)?(i.var.push(s),r.push(DK),t.push(c)):(i.number.push(s),r.push(eD),t.push(parseFloat(c))),++s,HC)).split(HC);return{values:t,split:a,indexes:i,types:r}}function nD(n){return Sg(n).values}function iD(n){const{split:e,types:t}=Sg(n),i=e.length;return r=>{let s="";for(let o=0;o<i;o++)if(s+=e[o],r[o]!==void 0){const a=t[o];a===eD?s+=kf(r[o]):a===tD?s+=ti.transform(r[o]):s+=r[o]}return s}}const GK=n=>typeof n=="number"?0:n;function jK(n){const e=nD(n);return iD(n)(e.map(GK))}const Ya={test:OK,parse:nD,createTransformer:iD,getAnimatableNone:jK},UK=new Set(["brightness","contrast","saturate","opacity"]);function BK(n){const[e,t]=n.slice(0,-1).split("(");if(e==="drop-shadow")return n;const[i]=t.match(AI)||[];if(!i)return n;const r=t.replace(i,"");let s=UK.has(e)?1:0;return i!==t&&(s*=100),e+"("+s+r+")"}const zK=/\b([a-z-]*)\(.*?\)/gu,Vw={...Ya,getAnimatableNone:n=>{const e=n.match(zK);return e?e.map(BK).join(" "):n}},$K={...fI,color:ti,backgroundColor:ti,outlineColor:ti,fill:ti,stroke:ti,borderColor:ti,borderTopColor:ti,borderRightColor:ti,borderBottomColor:ti,borderLeftColor:ti,filter:Vw,WebkitFilter:Vw},MI=n=>$K[n];function rD(n,e){let t=MI(n);return t!==Vw&&(t=Ya),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const WK=new Set(["auto","none","0"]);function HK(n,e,t){let i=0,r;for(;i<n.length&&!r;){const s=n[i];typeof s=="string"&&!WK.has(s)&&Sg(s).values.length&&(r=n[i]),i++}if(r&&t)for(const s of e)n[s]=rD(t,r)}const KC=n=>n===Xh||n===Ue,qC=(n,e)=>parseFloat(n.split(", ")[e]),YC=(n,e)=>(t,{transform:i})=>{if(i==="none"||!i)return 0;const r=i.match(/^matrix3d\((.+)\)$/u);if(r)return qC(r[1],e);{const s=i.match(/^matrix\((.+)\)$/u);return s?qC(s[1],n):0}},KK=new Set(["x","y","z"]),qK=Yh.filter(n=>!KK.has(n));function YK(n){const e=[];return qK.forEach(t=>{const i=n.getValue(t);i!==void 0&&(e.push([t,i.get()]),i.set(t.startsWith("scale")?1:0))}),e}const Gh={width:({x:n},{paddingLeft:e="0",paddingRight:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),height:({y:n},{paddingTop:e="0",paddingBottom:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),top:(n,{top:e})=>parseFloat(e),left:(n,{left:e})=>parseFloat(e),bottom:({y:n},{top:e})=>parseFloat(e)+(n.max-n.min),right:({x:n},{left:e})=>parseFloat(e)+(n.max-n.min),x:YC(4,13),y:YC(5,14)};Gh.translateX=Gh.x;Gh.translateY=Gh.y;const rc=new Set;let Fw=!1,Gw=!1;function sD(){if(Gw){const n=Array.from(rc).filter(i=>i.needsMeasurement),e=new Set(n.map(i=>i.element)),t=new Map;e.forEach(i=>{const r=YK(i);r.length&&(t.set(i,r),i.render())}),n.forEach(i=>i.measureInitialState()),e.forEach(i=>{i.render();const r=t.get(i);r&&r.forEach(([s,o])=>{var a;(a=i.getValue(s))===null||a===void 0||a.set(o)})}),n.forEach(i=>i.measureEndState()),n.forEach(i=>{i.suspendedScrollY!==void 0&&window.scrollTo(0,i.suspendedScrollY)})}Gw=!1,Fw=!1,rc.forEach(n=>n.complete()),rc.clear()}function oD(){rc.forEach(n=>{n.readKeyframes(),n.needsMeasurement&&(Gw=!0)})}function XK(){oD(),sD()}class bI{constructor(e,t,i,r,s,o=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=i,this.motionValue=r,this.element=s,this.isAsync=o}scheduleResolve(){this.isScheduled=!0,this.isAsync?(rc.add(this),Fw||(Fw=!0,Ft.read(oD),Ft.resolveKeyframes(sD))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:i,motionValue:r}=this;for(let s=0;s<e.length;s++)if(e[s]===null)if(s===0){const o=r?.get(),a=e[e.length-1];if(o!==void 0)e[0]=o;else if(i&&t){const c=i.readValue(t,a);c!=null&&(e[0]=c)}e[0]===void 0&&(e[0]=a),r&&o===void 0&&r.set(e[0])}else e[s]=e[s-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),rc.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,rc.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const aD=n=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(n),QK=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function ZK(n){const e=QK.exec(n);if(!e)return[,];const[,t,i,r]=e;return[`--${t??i}`,r]}function lD(n,e,t=1){const[i,r]=ZK(n);if(!i)return;const s=window.getComputedStyle(e).getPropertyValue(i);if(s){const o=s.trim();return aD(o)?parseFloat(o):o}return dI(r)?lD(r,e,t+1):r}const cD=n=>e=>e.test(n),JK={test:n=>n==="auto",parse:n=>n},uD=[Xh,Ue,Os,pa,BH,UH,JK],XC=n=>uD.find(cD(n));class hD extends bI{constructor(e,t,i,r,s){super(e,t,i,r,s,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:i}=this;if(!t||!t.current)return;super.readKeyframes();for(let c=0;c<e.length;c++){let h=e[c];if(typeof h=="string"&&(h=h.trim(),dI(h))){const d=lD(h,t.current);d!==void 0&&(e[c]=d),c===e.length-1&&(this.finalKeyframe=h)}}if(this.resolveNoneKeyframes(),!UO.has(i)||e.length!==2)return;const[r,s]=e,o=XC(r),a=XC(s);if(o!==a)if(KC(o)&&KC(a))for(let c=0;c<e.length;c++){const h=e[c];typeof h=="string"&&(e[c]=parseFloat(h))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,i=[];for(let r=0;r<e.length;r++)CK(e[r])&&i.push(r);i.length&&HK(e,i,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:i}=this;if(!e||!e.current)return;i==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Gh[i](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const r=t[t.length-1];r!==void 0&&e.getValue(i,r).jump(r,!1)}measureEndState(){var e;const{element:t,name:i,unresolvedKeyframes:r}=this;if(!t||!t.current)return;const s=t.getValue(i);s&&s.jump(this.measuredOrigin,!1);const o=r.length-1,a=r[o];r[o]=Gh[i](t.measureViewportBox(),window.getComputedStyle(t.current)),a!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=a),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([c,h])=>{t.getValue(c).set(h)}),this.resolveNoneKeyframes()}}const QC=(n,e)=>e==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&(Ya.test(n)||n==="0")&&!n.startsWith("url("));function eq(n){const e=n[0];if(n.length===1)return!0;for(let t=0;t<n.length;t++)if(n[t]!==e)return!0}function tq(n,e,t,i){const r=n[0];if(r===null)return!1;if(e==="display"||e==="visibility")return!0;const s=n[n.length-1],o=QC(r,e),a=QC(s,e);return!o||!a?!1:eq(n)||(t==="spring"||EI(t))&&i}const nq=n=>n!==null;function Oy(n,{repeat:e,repeatType:t="loop"},i){const r=n.filter(nq),s=e&&t!=="loop"&&e%2===1?0:r.length-1;return!s||i===void 0?r[s]:i}const iq=40;class dD{constructor({autoplay:e=!0,delay:t=0,type:i="keyframes",repeat:r=0,repeatDelay:s=0,repeatType:o="loop",...a}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=Ds.now(),this.options={autoplay:e,delay:t,type:i,repeat:r,repeatDelay:s,repeatType:o,...a},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>iq?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&XK(),this._resolved}onKeyframesResolved(e,t){this.resolvedAt=Ds.now(),this.hasAttemptedResolve=!0;const{name:i,type:r,velocity:s,delay:o,onComplete:a,onUpdate:c,isGenerator:h}=this.options;if(!h&&!tq(e,i,r,s))if(o)this.options.duration=0;else{c&&c(Oy(e,this.options,t)),a&&a(),this.resolveFinishedPromise();return}const d=this.initPlayback(e,t);d!==!1&&(this._resolved={keyframes:e,finalKeyframe:t,...d},this.onPostResolved())}onPostResolved(){}then(e,t){return this.currentFinishedPromise.then(e,t)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const qt=(n,e,t)=>n+(e-n)*t;function lE(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function rq({hue:n,saturation:e,lightness:t,alpha:i}){n/=360,e/=100,t/=100;let r=0,s=0,o=0;if(!e)r=s=o=t;else{const a=t<.5?t*(1+e):t+e-t*e,c=2*t-a;r=lE(c,a,n+1/3),s=lE(c,a,n),o=lE(c,a,n-1/3)}return{red:Math.round(r*255),green:Math.round(s*255),blue:Math.round(o*255),alpha:i}}function S_(n,e){return t=>t>0?e:n}const cE=(n,e,t)=>{const i=n*n,r=t*(e*e-i)+i;return r<0?0:Math.sqrt(r)},sq=[Dw,Ql,qu],oq=n=>sq.find(e=>e.test(n));function ZC(n){const e=oq(n);if(!e)return!1;let t=e.parse(n);return e===qu&&(t=rq(t)),t}const JC=(n,e)=>{const t=ZC(n),i=ZC(e);if(!t||!i)return S_(n,e);const r={...t};return s=>(r.red=cE(t.red,i.red,s),r.green=cE(t.green,i.green,s),r.blue=cE(t.blue,i.blue,s),r.alpha=qt(t.alpha,i.alpha,s),Ql.transform(r))},aq=(n,e)=>t=>e(n(t)),lm=(...n)=>n.reduce(aq),jw=new Set(["none","hidden"]);function lq(n,e){return jw.has(n)?t=>t<=0?n:e:t=>t>=1?e:n}function cq(n,e){return t=>qt(n,e,t)}function kI(n){return typeof n=="number"?cq:typeof n=="string"?dI(n)?S_:ti.test(n)?JC:dq:Array.isArray(n)?fD:typeof n=="object"?ti.test(n)?JC:uq:S_}function fD(n,e){const t=[...n],i=t.length,r=n.map((s,o)=>kI(s)(s,e[o]));return s=>{for(let o=0;o<i;o++)t[o]=r[o](s);return t}}function uq(n,e){const t={...n,...e},i={};for(const r in t)n[r]!==void 0&&e[r]!==void 0&&(i[r]=kI(n[r])(n[r],e[r]));return r=>{for(const s in i)t[s]=i[s](r);return t}}function hq(n,e){var t;const i=[],r={color:0,var:0,number:0};for(let s=0;s<e.values.length;s++){const o=e.types[s],a=n.indexes[o][r[o]],c=(t=n.values[a])!==null&&t!==void 0?t:0;i[s]=c,r[o]++}return i}const dq=(n,e)=>{const t=Ya.createTransformer(e),i=Sg(n),r=Sg(e);return i.indexes.var.length===r.indexes.var.length&&i.indexes.color.length===r.indexes.color.length&&i.indexes.number.length>=r.indexes.number.length?jw.has(n)&&!r.values.length||jw.has(e)&&!i.values.length?lq(n,e):lm(fD(hq(i,r),r.values),t):S_(n,e)};function gD(n,e,t){return typeof n=="number"&&typeof e=="number"&&typeof t=="number"?qt(n,e,t):kI(n)(n,e)}const fq=5;function mD(n,e,t){const i=Math.max(e-fq,0);return BO(t-n(i),e-i)}const Zt={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},uE=.001;function gq({duration:n=Zt.duration,bounce:e=Zt.bounce,velocity:t=Zt.velocity,mass:i=Zt.mass}){let r,s,o=1-e;o=Po(Zt.minDamping,Zt.maxDamping,o),n=Po(Zt.minDuration,Zt.maxDuration,vo(n)),o<1?(r=h=>{const d=h*o,g=d*n,m=d-t,y=Uw(h,o),w=Math.exp(-g);return uE-m/y*w},s=h=>{const g=h*o*n,m=g*t+t,y=Math.pow(o,2)*Math.pow(h,2)*n,w=Math.exp(-g),T=Uw(Math.pow(h,2),o);return(-r(h)+uE>0?-1:1)*((m-y)*w)/T}):(r=h=>{const d=Math.exp(-h*n),g=(h-t)*n+1;return-uE+d*g},s=h=>{const d=Math.exp(-h*n),g=(t-h)*(n*n);return d*g});const a=5/n,c=pq(r,s,a);if(n=yo(n),isNaN(c))return{stiffness:Zt.stiffness,damping:Zt.damping,duration:n};{const h=Math.pow(c,2)*i;return{stiffness:h,damping:o*2*Math.sqrt(i*h),duration:n}}}const mq=12;function pq(n,e,t){let i=t;for(let r=1;r<mq;r++)i=i-n(i)/e(i);return i}function Uw(n,e){return n*Math.sqrt(1-e*e)}const _q=["duration","bounce"],yq=["stiffness","damping","mass"];function eM(n,e){return e.some(t=>n[t]!==void 0)}function vq(n){let e={velocity:Zt.velocity,stiffness:Zt.stiffness,damping:Zt.damping,mass:Zt.mass,isResolvedFromDuration:!1,...n};if(!eM(n,yq)&&eM(n,_q))if(n.visualDuration){const t=n.visualDuration,i=2*Math.PI/(t*1.2),r=i*i,s=2*Po(.05,1,1-(n.bounce||0))*Math.sqrt(r);e={...e,mass:Zt.mass,stiffness:r,damping:s}}else{const t=gq(n);e={...e,...t,mass:Zt.mass},e.isResolvedFromDuration=!0}return e}function pD(n=Zt.visualDuration,e=Zt.bounce){const t=typeof n!="object"?{visualDuration:n,keyframes:[0,1],bounce:e}:n;let{restSpeed:i,restDelta:r}=t;const s=t.keyframes[0],o=t.keyframes[t.keyframes.length-1],a={done:!1,value:s},{stiffness:c,damping:h,mass:d,duration:g,velocity:m,isResolvedFromDuration:y}=vq({...t,velocity:-vo(t.velocity||0)}),w=m||0,T=h/(2*Math.sqrt(c*d)),E=o-s,P=vo(Math.sqrt(c/d)),M=Math.abs(E)<5;i||(i=M?Zt.restSpeed.granular:Zt.restSpeed.default),r||(r=M?Zt.restDelta.granular:Zt.restDelta.default);let N;if(T<1){const j=Uw(P,T);N=W=>{const L=Math.exp(-T*P*W);return o-L*((w+T*P*E)/j*Math.sin(j*W)+E*Math.cos(j*W))}}else if(T===1)N=j=>o-Math.exp(-P*j)*(E+(w+P*E)*j);else{const j=P*Math.sqrt(T*T-1);N=W=>{const L=Math.exp(-T*P*W),A=Math.min(j*W,300);return o-L*((w+T*P*E)*Math.sinh(A)+j*E*Math.cosh(A))/j}}const D={calculatedDuration:y&&g||null,next:j=>{const W=N(j);if(y)a.done=j>=g;else{let L=0;T<1&&(L=j===0?yo(w):mD(N,j,W));const A=Math.abs(L)<=i,k=Math.abs(o-W)<=r;a.done=A&&k}return a.value=a.done?o:W,a},toString:()=>{const j=Math.min(NO(D),Lw),W=OO(L=>D.next(j*L).value,j,30);return j+"ms "+W}};return D}function tM({keyframes:n,velocity:e=0,power:t=.8,timeConstant:i=325,bounceDamping:r=10,bounceStiffness:s=500,modifyTarget:o,min:a,max:c,restDelta:h=.5,restSpeed:d}){const g=n[0],m={done:!1,value:g},y=A=>a!==void 0&&A<a||c!==void 0&&A>c,w=A=>a===void 0?c:c===void 0||Math.abs(a-A)<Math.abs(c-A)?a:c;let T=t*e;const E=g+T,P=o===void 0?E:o(E);P!==E&&(T=P-g);const M=A=>-T*Math.exp(-A/i),N=A=>P+M(A),D=A=>{const k=M(A),U=N(A);m.done=Math.abs(k)<=h,m.value=m.done?P:U};let j,W;const L=A=>{y(m.value)&&(j=A,W=pD({keyframes:[m.value,w(m.value)],velocity:mD(N,A,m.value),damping:r,stiffness:s,restDelta:h,restSpeed:d}))};return L(0),{calculatedDuration:null,next:A=>{let k=!1;return!W&&j===void 0&&(k=!0,D(A),L(A)),j!==void 0&&A>=j?W.next(A-j):(!k&&D(A),m)}}}const Eq=am(.42,0,1,1),wq=am(0,0,.58,1),_D=am(.42,0,.58,1),xq=n=>Array.isArray(n)&&typeof n[0]!="number",Sq={linear:nr,easeIn:Eq,easeInOut:_D,easeOut:wq,circIn:PI,circInOut:QO,circOut:XO,backIn:RI,backInOut:qO,backOut:KO,anticipate:YO},nM=n=>{if(wI(n)){gO(n.length===4);const[e,t,i,r]=n;return am(e,t,i,r)}else if(typeof n=="string")return Sq[n];return n};function Iq(n,e,t){const i=[],r=t||gD,s=n.length-1;for(let o=0;o<s;o++){let a=r(n[o],n[o+1]);if(e){const c=Array.isArray(e)?e[o]||nr:e;a=lm(c,a)}i.push(a)}return i}function Tq(n,e,{clamp:t=!0,ease:i,mixer:r}={}){const s=n.length;if(gO(s===e.length),s===1)return()=>e[0];if(s===2&&e[0]===e[1])return()=>e[1];const o=n[0]===n[1];n[0]>n[s-1]&&(n=[...n].reverse(),e=[...e].reverse());const a=Iq(e,i,r),c=a.length,h=d=>{if(o&&d<n[0])return e[0];let g=0;if(c>1)for(;g<n.length-2&&!(d<n[g+1]);g++);const m=Vh(n[g],n[g+1],d);return a[g](m)};return t?d=>h(Po(n[0],n[s-1],d)):h}function Rq(n,e){const t=n[n.length-1];for(let i=1;i<=e;i++){const r=Vh(0,e,i);n.push(qt(t,1,r))}}function Pq(n){const e=[0];return Rq(e,n.length-1),e}function Aq(n,e){return n.map(t=>t*e)}function Cq(n,e){return n.map(()=>e||_D).splice(0,n.length-1)}function I_({duration:n=300,keyframes:e,times:t,ease:i="easeInOut"}){const r=xq(i)?i.map(nM):nM(i),s={done:!1,value:e[0]},o=Aq(t&&t.length===e.length?t:Pq(e),n),a=Tq(o,e,{ease:Array.isArray(r)?r:Cq(e,r)});return{calculatedDuration:n,next:c=>(s.value=a(c),s.done=c>=n,s)}}const Mq=n=>{const e=({timestamp:t})=>n(t);return{start:()=>Ft.update(e,!0),stop:()=>qa(e),now:()=>zn.isProcessing?zn.timestamp:Ds.now()}},bq={decay:tM,inertia:tM,tween:I_,keyframes:I_,spring:pD},kq=n=>n/100;class LI extends dD{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:c}=this.options;c&&c()};const{name:t,motionValue:i,element:r,keyframes:s}=this.options,o=r?.KeyframeResolver||bI,a=(c,h)=>this.onKeyframesResolved(c,h);this.resolver=new o(s,a,t,i,r),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:t="keyframes",repeat:i=0,repeatDelay:r=0,repeatType:s,velocity:o=0}=this.options,a=EI(t)?t:bq[t]||I_;let c,h;a!==I_&&typeof e[0]!="number"&&(c=lm(kq,gD(e[0],e[1])),e=[0,100]);const d=a({...this.options,keyframes:e});s==="mirror"&&(h=a({...this.options,keyframes:[...e].reverse(),velocity:-o})),d.calculatedDuration===null&&(d.calculatedDuration=NO(d));const{calculatedDuration:g}=d,m=g+r,y=m*(i+1)-r;return{generator:d,mirroredGenerator:h,mapPercentToKeyframes:c,calculatedDuration:g,resolvedDuration:m,totalDuration:y}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,t=!1){const{resolved:i}=this;if(!i){const{keyframes:A}=this.options;return{done:!0,value:A[A.length-1]}}const{finalKeyframe:r,generator:s,mirroredGenerator:o,mapPercentToKeyframes:a,keyframes:c,calculatedDuration:h,totalDuration:d,resolvedDuration:g}=i;if(this.startTime===null)return s.next(0);const{delay:m,repeat:y,repeatType:w,repeatDelay:T,onUpdate:E}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-d/this.speed,this.startTime)),t?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const P=this.currentTime-m*(this.speed>=0?1:-1),M=this.speed>=0?P<0:P>d;this.currentTime=Math.max(P,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=d);let N=this.currentTime,D=s;if(y){const A=Math.min(this.currentTime,d)/g;let k=Math.floor(A),U=A%1;!U&&A>=1&&(U=1),U===1&&k--,k=Math.min(k,y+1),k%2&&(w==="reverse"?(U=1-U,T&&(U-=T/g)):w==="mirror"&&(D=o)),N=Po(0,1,U)*g}const j=M?{done:!1,value:c[0]}:D.next(N);a&&(j.value=a(j.value));let{done:W}=j;!M&&h!==null&&(W=this.speed>=0?this.currentTime>=d:this.currentTime<=0);const L=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&W);return L&&r!==void 0&&(j.value=Oy(c,this.options,r)),E&&E(j.value),L&&this.finish(),j}get duration(){const{resolved:e}=this;return e?vo(e.calculatedDuration):0}get time(){return vo(this.currentTime)}set time(e){e=yo(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=vo(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=Mq,onPlay:t,startTime:i}=this.options;this.driver||(this.driver=e(s=>this.tick(s))),t&&t();const r=this.driver.now();this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=r):this.startTime=i??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const Lq=new Set(["opacity","clipPath","filter","transform"]);function Nq(n,e,t,{delay:i=0,duration:r=300,repeat:s=0,repeatType:o="loop",ease:a="easeInOut",times:c}={}){const h={[e]:t};c&&(h.offset=c);const d=VO(a,r);return Array.isArray(d)&&(h.easing=d),n.animate(h,{delay:i,duration:r,easing:Array.isArray(d)?"linear":d,fill:"both",iterations:s+1,direction:o==="reverse"?"alternate":"normal"})}const Oq=sI(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),T_=10,Dq=2e4;function Vq(n){return EI(n.type)||n.type==="spring"||!DO(n.ease)}function Fq(n,e){const t=new LI({...e,keyframes:n,repeat:0,delay:0,isGenerator:!0});let i={done:!1,value:n[0]};const r=[];let s=0;for(;!i.done&&s<Dq;)i=t.sample(s),r.push(i.value),s+=T_;return{times:void 0,keyframes:r,duration:s-T_,ease:"linear"}}const yD={anticipate:YO,backInOut:qO,circInOut:QO};function Gq(n){return n in yD}class iM extends dD{constructor(e){super(e);const{name:t,motionValue:i,element:r,keyframes:s}=this.options;this.resolver=new hD(s,(o,a)=>this.onKeyframesResolved(o,a),t,i,r),this.resolver.scheduleResolve()}initPlayback(e,t){let{duration:i=300,times:r,ease:s,type:o,motionValue:a,name:c,startTime:h}=this.options;if(!a.owner||!a.owner.current)return!1;if(typeof s=="string"&&x_()&&Gq(s)&&(s=yD[s]),Vq(this.options)){const{onComplete:g,onUpdate:m,motionValue:y,element:w,...T}=this.options,E=Fq(e,T);e=E.keyframes,e.length===1&&(e[1]=e[0]),i=E.duration,r=E.times,s=E.ease,o="keyframes"}const d=Nq(a.owner.current,c,e,{...this.options,duration:i,times:r,ease:s});return d.startTime=h??this.calcStartTime(),this.pendingTimeline?(UC(d,this.pendingTimeline),this.pendingTimeline=void 0):d.onfinish=()=>{const{onComplete:g}=this.options;a.set(Oy(e,this.options,t)),g&&g(),this.cancel(),this.resolveFinishedPromise()},{animation:d,duration:i,times:r,type:o,ease:s,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:t}=e;return vo(t)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:t}=e;return vo(t.currentTime||0)}set time(e){const{resolved:t}=this;if(!t)return;const{animation:i}=t;i.currentTime=yo(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:t}=e;return t.playbackRate}set speed(e){const{resolved:t}=this;if(!t)return;const{animation:i}=t;i.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:t}=e;return t.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:t}=e;return t.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:t}=this;if(!t)return nr;const{animation:i}=t;UC(i,e)}return nr}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.playState==="finished"&&this.updateFinishedPromise(),t.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:t,keyframes:i,duration:r,type:s,ease:o,times:a}=e;if(t.playState==="idle"||t.playState==="finished")return;if(this.time){const{motionValue:h,onUpdate:d,onComplete:g,element:m,...y}=this.options,w=new LI({...y,keyframes:i,duration:r,type:s,ease:o,times:a,isGenerator:!0}),T=yo(this.time);h.setWithVelocity(w.sample(T-T_).value,w.sample(T).value,T_)}const{onStop:c}=this.options;c&&c(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:t,name:i,repeatDelay:r,repeatType:s,damping:o,type:a}=e;if(!t||!t.owner||!(t.owner.current instanceof HTMLElement))return!1;const{onUpdate:c,transformTemplate:h}=t.owner.getProps();return Oq()&&i&&Lq.has(i)&&!c&&!h&&!r&&s!=="mirror"&&o!==0&&a!=="inertia"}}const jq={type:"spring",stiffness:500,damping:25,restSpeed:10},Uq=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),Bq={type:"keyframes",duration:.8},zq={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},$q=(n,{keyframes:e})=>e.length>2?Bq:Vc.has(n)?n.startsWith("scale")?Uq(e[1]):jq:zq;function Wq({when:n,delay:e,delayChildren:t,staggerChildren:i,staggerDirection:r,repeat:s,repeatType:o,repeatDelay:a,from:c,elapsed:h,...d}){return!!Object.keys(d).length}const NI=(n,e,t,i={},r,s)=>o=>{const a=vI(i,n)||{},c=a.delay||i.delay||0;let{elapsed:h=0}=i;h=h-yo(c);let d={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...a,delay:-h,onUpdate:m=>{e.set(m),a.onUpdate&&a.onUpdate(m)},onComplete:()=>{o(),a.onComplete&&a.onComplete()},name:n,motionValue:e,element:s?void 0:r};Wq(a)||(d={...d,...$q(n,d)}),d.duration&&(d.duration=yo(d.duration)),d.repeatDelay&&(d.repeatDelay=yo(d.repeatDelay)),d.from!==void 0&&(d.keyframes[0]=d.from);let g=!1;if((d.type===!1||d.duration===0&&!d.repeatDelay)&&(d.duration=0,d.delay===0&&(g=!0)),g&&!s&&e.get()!==void 0){const m=Oy(d.keyframes,a);if(m!==void 0)return Ft.update(()=>{d.onUpdate(m),d.onComplete()}),new uK([])}return!s&&iM.supports(d)?new iM(d):new LI(d)};function Hq({protectedKeys:n,needsAnimating:e},t){const i=n.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,i}function vD(n,e,{delay:t=0,transitionOverride:i,type:r}={}){var s;let{transition:o=n.getDefaultTransition(),transitionEnd:a,...c}=e;i&&(o=i);const h=[],d=r&&n.animationState&&n.animationState.getState()[r];for(const g in c){const m=n.getValue(g,(s=n.latestValues[g])!==null&&s!==void 0?s:null),y=c[g];if(y===void 0||d&&Hq(d,g))continue;const w={delay:t,...vI(o||{},g)};let T=!1;if(window.MotionHandoffAnimation){const P=zO(n);if(P){const M=window.MotionHandoffAnimation(P,g,Ft);M!==null&&(w.startTime=M,T=!0)}}Ow(n,g),m.start(NI(g,m,y,n.shouldReduceMotion&&UO.has(g)?{type:!1}:w,n,T));const E=m.animation;E&&h.push(E)}return a&&Promise.all(h).then(()=>{Ft.update(()=>{a&&IK(n,a)})}),h}function Bw(n,e,t={}){var i;const r=Ny(n,e,t.type==="exit"?(i=n.presenceContext)===null||i===void 0?void 0:i.custom:void 0);let{transition:s=n.getDefaultTransition()||{}}=r||{};t.transitionOverride&&(s=t.transitionOverride);const o=r?()=>Promise.all(vD(n,r,t)):()=>Promise.resolve(),a=n.variantChildren&&n.variantChildren.size?(h=0)=>{const{delayChildren:d=0,staggerChildren:g,staggerDirection:m}=s;return Kq(n,e,d+h,g,m,t)}:()=>Promise.resolve(),{when:c}=s;if(c){const[h,d]=c==="beforeChildren"?[o,a]:[a,o];return h().then(()=>d())}else return Promise.all([o(),a(t.delay)])}function Kq(n,e,t=0,i=0,r=1,s){const o=[],a=(n.variantChildren.size-1)*i,c=r===1?(h=0)=>h*i:(h=0)=>a-h*i;return Array.from(n.variantChildren).sort(qq).forEach((h,d)=>{h.notify("AnimationStart",e),o.push(Bw(h,e,{...s,delay:t+c(d)}).then(()=>h.notify("AnimationComplete",e)))}),Promise.all(o)}function qq(n,e){return n.sortNodePosition(e)}function Yq(n,e,t={}){n.notify("AnimationStart",e);let i;if(Array.isArray(e)){const r=e.map(s=>Bw(n,s,t));i=Promise.all(r)}else if(typeof e=="string")i=Bw(n,e,t);else{const r=typeof e=="function"?Ny(n,e,t.custom):e;i=Promise.all(vD(n,r,t))}return i.then(()=>{n.notify("AnimationComplete",e)})}const Xq=aI.length;function ED(n){if(!n)return;if(!n.isControllingVariants){const t=n.parent?ED(n.parent)||{}:{};return n.props.initial!==void 0&&(t.initial=n.props.initial),t}const e={};for(let t=0;t<Xq;t++){const i=aI[t],r=n.props[i];(Eg(r)||r===!1)&&(e[i]=r)}return e}const Qq=[...oI].reverse(),Zq=oI.length;function Jq(n){return e=>Promise.all(e.map(({animation:t,options:i})=>Yq(n,t,i)))}function eY(n){let e=Jq(n),t=rM(),i=!0;const r=c=>(h,d)=>{var g;const m=Ny(n,d,c==="exit"?(g=n.presenceContext)===null||g===void 0?void 0:g.custom:void 0);if(m){const{transition:y,transitionEnd:w,...T}=m;h={...h,...T,...w}}return h};function s(c){e=c(n)}function o(c){const{props:h}=n,d=ED(n.parent)||{},g=[],m=new Set;let y={},w=1/0;for(let E=0;E<Zq;E++){const P=Qq[E],M=t[P],N=h[P]!==void 0?h[P]:d[P],D=Eg(N),j=P===c?M.isActive:null;j===!1&&(w=E);let W=N===d[P]&&N!==h[P]&&D;if(W&&i&&n.manuallyAnimateOnMount&&(W=!1),M.protectedKeys={...y},!M.isActive&&j===null||!N&&!M.prevProp||ky(N)||typeof N=="boolean")continue;const L=tY(M.prevProp,N);let A=L||P===c&&M.isActive&&!W&&D||E>w&&D,k=!1;const U=Array.isArray(N)?N:[N];let B=U.reduce(r(P),{});j===!1&&(B={});const{prevResolvedValues:z={}}=M,O={...z,...B},oe=_e=>{A=!0,m.has(_e)&&(k=!0,m.delete(_e)),M.needsAnimating[_e]=!0;const Q=n.getValue(_e);Q&&(Q.liveStyle=!1)};for(const _e in O){const Q=B[_e],ce=z[_e];if(y.hasOwnProperty(_e))continue;let K=!1;kw(Q)&&kw(ce)?K=!LO(Q,ce):K=Q!==ce,K?Q!=null?oe(_e):m.add(_e):Q!==void 0&&m.has(_e)?oe(_e):M.protectedKeys[_e]=!0}M.prevProp=N,M.prevResolvedValues=B,M.isActive&&(y={...y,...B}),i&&n.blockInitialAnimation&&(A=!1),A&&(!(W&&L)||k)&&g.push(...U.map(_e=>({animation:_e,options:{type:P}})))}if(m.size){const E={};m.forEach(P=>{const M=n.getBaseTarget(P),N=n.getValue(P);N&&(N.liveStyle=!0),E[P]=M??null}),g.push({animation:E})}let T=!!g.length;return i&&(h.initial===!1||h.initial===h.animate)&&!n.manuallyAnimateOnMount&&(T=!1),i=!1,T?e(g):Promise.resolve()}function a(c,h){var d;if(t[c].isActive===h)return Promise.resolve();(d=n.variantChildren)===null||d===void 0||d.forEach(m=>{var y;return(y=m.animationState)===null||y===void 0?void 0:y.setActive(c,h)}),t[c].isActive=h;const g=o(c);for(const m in t)t[m].protectedKeys={};return g}return{animateChanges:o,setActive:a,setAnimateFunction:s,getState:()=>t,reset:()=>{t=rM(),i=!0}}}function tY(n,e){return typeof e=="string"?e!==n:Array.isArray(e)?!LO(e,n):!1}function bl(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function rM(){return{animate:bl(!0),whileInView:bl(),whileHover:bl(),whileTap:bl(),whileDrag:bl(),whileFocus:bl(),exit:bl()}}class tl{constructor(e){this.isMounted=!1,this.node=e}update(){}}class nY extends tl{constructor(e){super(e),e.animationState||(e.animationState=eY(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();ky(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let iY=0;class rY extends tl{constructor(){super(...arguments),this.id=iY++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:i}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===i)return;const r=this.node.animationState.setActive("exit",!e);t&&!e&&r.then(()=>t(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const sY={animation:{Feature:nY},exit:{Feature:rY}};function Ig(n,e,t,i={passive:!0}){return n.addEventListener(e,t,i),()=>n.removeEventListener(e,t)}function cm(n){return{point:{x:n.pageX,y:n.pageY}}}const oY=n=>e=>xI(e)&&n(e,cm(e));function Lf(n,e,t,i){return Ig(n,e,oY(t),i)}const sM=(n,e)=>Math.abs(n-e);function aY(n,e){const t=sM(n.x,e.x),i=sM(n.y,e.y);return Math.sqrt(t**2+i**2)}class wD{constructor(e,t,{transformPagePoint:i,contextWindow:r,dragSnapToOrigin:s=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const g=dE(this.lastMoveEventInfo,this.history),m=this.startEvent!==null,y=aY(g.offset,{x:0,y:0})>=3;if(!m&&!y)return;const{point:w}=g,{timestamp:T}=zn;this.history.push({...w,timestamp:T});const{onStart:E,onMove:P}=this.handlers;m||(E&&E(this.lastMoveEvent,g),this.startEvent=this.lastMoveEvent),P&&P(this.lastMoveEvent,g)},this.handlePointerMove=(g,m)=>{this.lastMoveEvent=g,this.lastMoveEventInfo=hE(m,this.transformPagePoint),Ft.update(this.updatePoint,!0)},this.handlePointerUp=(g,m)=>{this.end();const{onEnd:y,onSessionEnd:w,resumeAnimation:T}=this.handlers;if(this.dragSnapToOrigin&&T&&T(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const E=dE(g.type==="pointercancel"?this.lastMoveEventInfo:hE(m,this.transformPagePoint),this.history);this.startEvent&&y&&y(g,E),w&&w(g,E)},!xI(e))return;this.dragSnapToOrigin=s,this.handlers=t,this.transformPagePoint=i,this.contextWindow=r||window;const o=cm(e),a=hE(o,this.transformPagePoint),{point:c}=a,{timestamp:h}=zn;this.history=[{...c,timestamp:h}];const{onSessionStart:d}=t;d&&d(e,dE(a,this.history)),this.removeListeners=lm(Lf(this.contextWindow,"pointermove",this.handlePointerMove),Lf(this.contextWindow,"pointerup",this.handlePointerUp),Lf(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),qa(this.updatePoint)}}function hE(n,e){return e?{point:e(n.point)}:n}function oM(n,e){return{x:n.x-e.x,y:n.y-e.y}}function dE({point:n},e){return{point:n,delta:oM(n,xD(e)),offset:oM(n,lY(e)),velocity:cY(e,.1)}}function lY(n){return n[0]}function xD(n){return n[n.length-1]}function cY(n,e){if(n.length<2)return{x:0,y:0};let t=n.length-1,i=null;const r=xD(n);for(;t>=0&&(i=n[t],!(r.timestamp-i.timestamp>yo(e)));)t--;if(!i)return{x:0,y:0};const s=vo(r.timestamp-i.timestamp);if(s===0)return{x:0,y:0};const o={x:(r.x-i.x)/s,y:(r.y-i.y)/s};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}const SD=1e-4,uY=1-SD,hY=1+SD,ID=.01,dY=0-ID,fY=0+ID;function or(n){return n.max-n.min}function gY(n,e,t){return Math.abs(n-e)<=t}function aM(n,e,t,i=.5){n.origin=i,n.originPoint=qt(e.min,e.max,n.origin),n.scale=or(t)/or(e),n.translate=qt(t.min,t.max,n.origin)-n.originPoint,(n.scale>=uY&&n.scale<=hY||isNaN(n.scale))&&(n.scale=1),(n.translate>=dY&&n.translate<=fY||isNaN(n.translate))&&(n.translate=0)}function Nf(n,e,t,i){aM(n.x,e.x,t.x,i?i.originX:void 0),aM(n.y,e.y,t.y,i?i.originY:void 0)}function lM(n,e,t){n.min=t.min+e.min,n.max=n.min+or(e)}function mY(n,e,t){lM(n.x,e.x,t.x),lM(n.y,e.y,t.y)}function cM(n,e,t){n.min=e.min-t.min,n.max=n.min+or(e)}function Of(n,e,t){cM(n.x,e.x,t.x),cM(n.y,e.y,t.y)}function pY(n,{min:e,max:t},i){return e!==void 0&&n<e?n=i?qt(e,n,i.min):Math.max(n,e):t!==void 0&&n>t&&(n=i?qt(t,n,i.max):Math.min(n,t)),n}function uM(n,e,t){return{min:e!==void 0?n.min+e:void 0,max:t!==void 0?n.max+t-(n.max-n.min):void 0}}function _Y(n,{top:e,left:t,bottom:i,right:r}){return{x:uM(n.x,t,r),y:uM(n.y,e,i)}}function hM(n,e){let t=e.min-n.min,i=e.max-n.max;return e.max-e.min<n.max-n.min&&([t,i]=[i,t]),{min:t,max:i}}function yY(n,e){return{x:hM(n.x,e.x),y:hM(n.y,e.y)}}function vY(n,e){let t=.5;const i=or(n),r=or(e);return r>i?t=Vh(e.min,e.max-i,n.min):i>r&&(t=Vh(n.min,n.max-r,e.min)),Po(0,1,t)}function EY(n,e){const t={};return e.min!==void 0&&(t.min=e.min-n.min),e.max!==void 0&&(t.max=e.max-n.min),t}const zw=.35;function wY(n=zw){return n===!1?n=0:n===!0&&(n=zw),{x:dM(n,"left","right"),y:dM(n,"top","bottom")}}function dM(n,e,t){return{min:fM(n,e),max:fM(n,t)}}function fM(n,e){return typeof n=="number"?n:n[e]||0}const gM=()=>({translate:0,scale:1,origin:0,originPoint:0}),Yu=()=>({x:gM(),y:gM()}),mM=()=>({min:0,max:0}),sn=()=>({x:mM(),y:mM()});function Sr(n){return[n("x"),n("y")]}function TD({top:n,left:e,right:t,bottom:i}){return{x:{min:e,max:t},y:{min:n,max:i}}}function xY({x:n,y:e}){return{top:e.min,right:n.max,bottom:e.max,left:n.min}}function SY(n,e){if(!e)return n;const t=e({x:n.left,y:n.top}),i=e({x:n.right,y:n.bottom});return{top:t.y,left:t.x,bottom:i.y,right:i.x}}function fE(n){return n===void 0||n===1}function $w({scale:n,scaleX:e,scaleY:t}){return!fE(n)||!fE(e)||!fE(t)}function Fl(n){return $w(n)||RD(n)||n.z||n.rotate||n.rotateX||n.rotateY||n.skewX||n.skewY}function RD(n){return pM(n.x)||pM(n.y)}function pM(n){return n&&n!=="0%"}function R_(n,e,t){const i=n-t,r=e*i;return t+r}function _M(n,e,t,i,r){return r!==void 0&&(n=R_(n,r,i)),R_(n,t,i)+e}function Ww(n,e=0,t=1,i,r){n.min=_M(n.min,e,t,i,r),n.max=_M(n.max,e,t,i,r)}function PD(n,{x:e,y:t}){Ww(n.x,e.translate,e.scale,e.originPoint),Ww(n.y,t.translate,t.scale,t.originPoint)}const yM=.999999999999,vM=1.0000000000001;function IY(n,e,t,i=!1){const r=t.length;if(!r)return;e.x=e.y=1;let s,o;for(let a=0;a<r;a++){s=t[a],o=s.projectionDelta;const{visualElement:c}=s.options;c&&c.props.style&&c.props.style.display==="contents"||(i&&s.options.layoutScroll&&s.scroll&&s!==s.root&&Qu(n,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,PD(n,o)),i&&Fl(s.latestValues)&&Qu(n,s.latestValues))}e.x<vM&&e.x>yM&&(e.x=1),e.y<vM&&e.y>yM&&(e.y=1)}function Xu(n,e){n.min=n.min+e,n.max=n.max+e}function EM(n,e,t,i,r=.5){const s=qt(n.min,n.max,r);Ww(n,e,t,s,i)}function Qu(n,e){EM(n.x,e.x,e.scaleX,e.scale,e.originX),EM(n.y,e.y,e.scaleY,e.scale,e.originY)}function AD(n,e){return TD(SY(n.getBoundingClientRect(),e))}function TY(n,e,t){const i=AD(n,t),{scroll:r}=e;return r&&(Xu(i.x,r.offset.x),Xu(i.y,r.offset.y)),i}const CD=({current:n})=>n?n.ownerDocument.defaultView:null,RY=new WeakMap;class PY{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=sn(),this.visualElement=e}start(e,{snapToCursor:t=!1}={}){const{presenceContext:i}=this.visualElement;if(i&&i.isPresent===!1)return;const r=d=>{const{dragSnapToOrigin:g}=this.getProps();g?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(cm(d).point)},s=(d,g)=>{const{drag:m,dragPropagation:y,onDragStart:w}=this.getProps();if(m&&!y&&(this.openDragLock&&this.openDragLock(),this.openDragLock=vK(m),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Sr(E=>{let P=this.getAxisMotionValue(E).get()||0;if(Os.test(P)){const{projection:M}=this.visualElement;if(M&&M.layout){const N=M.layout.layoutBox[E];N&&(P=or(N)*(parseFloat(P)/100))}}this.originPoint[E]=P}),w&&Ft.postRender(()=>w(d,g)),Ow(this.visualElement,"transform");const{animationState:T}=this.visualElement;T&&T.setActive("whileDrag",!0)},o=(d,g)=>{const{dragPropagation:m,dragDirectionLock:y,onDirectionLock:w,onDrag:T}=this.getProps();if(!m&&!this.openDragLock)return;const{offset:E}=g;if(y&&this.currentDirection===null){this.currentDirection=AY(E),this.currentDirection!==null&&w&&w(this.currentDirection);return}this.updateAxis("x",g.point,E),this.updateAxis("y",g.point,E),this.visualElement.render(),T&&T(d,g)},a=(d,g)=>this.stop(d,g),c=()=>Sr(d=>{var g;return this.getAnimationState(d)==="paused"&&((g=this.getAxisMotionValue(d).animation)===null||g===void 0?void 0:g.play())}),{dragSnapToOrigin:h}=this.getProps();this.panSession=new wD(e,{onSessionStart:r,onStart:s,onMove:o,onSessionEnd:a,resumeAnimation:c},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:h,contextWindow:CD(this.visualElement)})}stop(e,t){const i=this.isDragging;if(this.cancel(),!i)return;const{velocity:r}=t;this.startAnimation(r);const{onDragEnd:s}=this.getProps();s&&Ft.postRender(()=>s(e,t))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:i}=this.getProps();!i&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,i){const{drag:r}=this.getProps();if(!i||!Yp(e,r,this.currentDirection))return;const s=this.getAxisMotionValue(e);let o=this.originPoint[e]+i[e];this.constraints&&this.constraints[e]&&(o=pY(o,this.constraints[e],this.elastic[e])),s.set(o)}resolveConstraints(){var e;const{dragConstraints:t,dragElastic:i}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,s=this.constraints;t&&Ku(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&r?this.constraints=_Y(r.layoutBox,t):this.constraints=!1,this.elastic=wY(i),s!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&Sr(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=EY(r.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!Ku(e))return!1;const i=e.current,{projection:r}=this.visualElement;if(!r||!r.layout)return!1;const s=TY(i,r.root,this.visualElement.getTransformPagePoint());let o=yY(r.layout.layoutBox,s);if(t){const a=t(xY(o));this.hasMutatedConstraints=!!a,a&&(o=TD(a))}return o}startAnimation(e){const{drag:t,dragMomentum:i,dragElastic:r,dragTransition:s,dragSnapToOrigin:o,onDragTransitionEnd:a}=this.getProps(),c=this.constraints||{},h=Sr(d=>{if(!Yp(d,t,this.currentDirection))return;let g=c&&c[d]||{};o&&(g={min:0,max:0});const m=r?200:1e6,y=r?40:1e7,w={type:"inertia",velocity:i?e[d]:0,bounceStiffness:m,bounceDamping:y,timeConstant:750,restDelta:1,restSpeed:10,...s,...g};return this.startAxisValueAnimation(d,w)});return Promise.all(h).then(a)}startAxisValueAnimation(e,t){const i=this.getAxisMotionValue(e);return Ow(this.visualElement,e),i.start(NI(e,i,0,t,this.visualElement,!1))}stopAnimation(){Sr(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Sr(e=>{var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.pause()})}getAnimationState(e){var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,i=this.visualElement.getProps(),r=i[t];return r||this.visualElement.getValue(e,(i.initial?i.initial[e]:void 0)||0)}snapToCursor(e){Sr(t=>{const{drag:i}=this.getProps();if(!Yp(t,i,this.currentDirection))return;const{projection:r}=this.visualElement,s=this.getAxisMotionValue(t);if(r&&r.layout){const{min:o,max:a}=r.layout.layoutBox[t];s.set(e[t]-qt(o,a,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:i}=this.visualElement;if(!Ku(t)||!i||!this.constraints)return;this.stopAnimation();const r={x:0,y:0};Sr(o=>{const a=this.getAxisMotionValue(o);if(a&&this.constraints!==!1){const c=a.get();r[o]=vY({min:c,max:c},this.constraints[o])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",i.root&&i.root.updateScroll(),i.updateLayout(),this.resolveConstraints(),Sr(o=>{if(!Yp(o,e,null))return;const a=this.getAxisMotionValue(o),{min:c,max:h}=this.constraints[o];a.set(qt(c,h,r[o]))})}addListeners(){if(!this.visualElement.current)return;RY.set(this.visualElement,this);const e=this.visualElement.current,t=Lf(e,"pointerdown",c=>{const{drag:h,dragListener:d=!0}=this.getProps();h&&d&&this.start(c)}),i=()=>{const{dragConstraints:c}=this.getProps();Ku(c)&&c.current&&(this.constraints=this.resolveRefConstraints())},{projection:r}=this.visualElement,s=r.addEventListener("measure",i);r&&!r.layout&&(r.root&&r.root.updateScroll(),r.updateLayout()),Ft.read(i);const o=Ig(window,"resize",()=>this.scalePositionWithinConstraints()),a=r.addEventListener("didUpdate",(({delta:c,hasLayoutChanged:h})=>{this.isDragging&&h&&(Sr(d=>{const g=this.getAxisMotionValue(d);g&&(this.originPoint[d]+=c[d].translate,g.set(g.get()+c[d].translate))}),this.visualElement.render())}));return()=>{o(),t(),s(),a&&a()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:i=!1,dragPropagation:r=!1,dragConstraints:s=!1,dragElastic:o=zw,dragMomentum:a=!0}=e;return{...e,drag:t,dragDirectionLock:i,dragPropagation:r,dragConstraints:s,dragElastic:o,dragMomentum:a}}}function Yp(n,e,t){return(e===!0||e===n)&&(t===null||t===n)}function AY(n,e=10){let t=null;return Math.abs(n.y)>e?t="y":Math.abs(n.x)>e&&(t="x"),t}class CY extends tl{constructor(e){super(e),this.removeGroupControls=nr,this.removeListeners=nr,this.controls=new PY(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||nr}unmount(){this.removeGroupControls(),this.removeListeners()}}const wM=n=>(e,t)=>{n&&Ft.postRender(()=>n(e,t))};class MY extends tl{constructor(){super(...arguments),this.removePointerDownListener=nr}onPointerDown(e){this.session=new wD(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:CD(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:i,onPanEnd:r}=this.node.getProps();return{onSessionStart:wM(e),onStart:wM(t),onMove:i,onEnd:(s,o)=>{delete this.session,r&&Ft.postRender(()=>r(s,o))}}}mount(){this.removePointerDownListener=Lf(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const E0={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function xM(n,e){return e.max===e.min?0:n/(e.max-e.min)*100}const Qd={correct:(n,e)=>{if(!e.target)return n;if(typeof n=="string")if(Ue.test(n))n=parseFloat(n);else return n;const t=xM(n,e.target.x),i=xM(n,e.target.y);return`${t}% ${i}%`}},bY={correct:(n,{treeScale:e,projectionDelta:t})=>{const i=n,r=Ya.parse(n);if(r.length>5)return i;const s=Ya.createTransformer(n),o=typeof r[0]!="number"?1:0,a=t.x.scale*e.x,c=t.y.scale*e.y;r[0+o]/=a,r[1+o]/=c;const h=qt(a,c,.5);return typeof r[2+o]=="number"&&(r[2+o]/=h),typeof r[3+o]=="number"&&(r[3+o]/=h),s(r)}};class kY extends se.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:i,layoutId:r}=this.props,{projection:s}=e;ZH(LY),s&&(t.group&&t.group.add(s),i&&i.register&&r&&i.register(s),s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),E0.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:i,drag:r,isPresent:s}=this.props,o=i.projection;return o&&(o.isPresent=s,r||e.layoutDependency!==t||t===void 0?o.willUpdate():this.safeToRemove(),e.isPresent!==s&&(s?o.promote():o.relegate()||Ft.postRender(()=>{const a=o.getStack();(!a||!a.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),cI.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:i}=this.props,{projection:r}=e;r&&(r.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(r),i&&i.deregister&&i.deregister(r))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function MD(n){const[e,t]=dO(),i=se.useContext(tI);return C.jsx(kY,{...n,layoutGroup:i,switchLayoutGroup:se.useContext(EO),isPresent:e,safeToRemove:t})}const LY={borderRadius:{...Qd,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Qd,borderTopRightRadius:Qd,borderBottomLeftRadius:Qd,borderBottomRightRadius:Qd,boxShadow:bY};function NY(n,e,t){const i=li(n)?n:xg(n);return i.start(NI("",i,e,t)),i.animation}function OY(n){return n instanceof SVGElement&&n.tagName!=="svg"}const DY=(n,e)=>n.depth-e.depth;class VY{constructor(){this.children=[],this.isDirty=!1}add(e){SI(this.children,e),this.isDirty=!0}remove(e){II(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(DY),this.isDirty=!1,this.children.forEach(e)}}function FY(n,e){const t=Ds.now(),i=({timestamp:r})=>{const s=r-t;s>=e&&(qa(i),n(s-e))};return Ft.read(i,!0),()=>qa(i)}const bD=["TopLeft","TopRight","BottomLeft","BottomRight"],GY=bD.length,SM=n=>typeof n=="string"?parseFloat(n):n,IM=n=>typeof n=="number"||Ue.test(n);function jY(n,e,t,i,r,s){r?(n.opacity=qt(0,t.opacity!==void 0?t.opacity:1,UY(i)),n.opacityExit=qt(e.opacity!==void 0?e.opacity:1,0,BY(i))):s&&(n.opacity=qt(e.opacity!==void 0?e.opacity:1,t.opacity!==void 0?t.opacity:1,i));for(let o=0;o<GY;o++){const a=`border${bD[o]}Radius`;let c=TM(e,a),h=TM(t,a);if(c===void 0&&h===void 0)continue;c||(c=0),h||(h=0),c===0||h===0||IM(c)===IM(h)?(n[a]=Math.max(qt(SM(c),SM(h),i),0),(Os.test(h)||Os.test(c))&&(n[a]+="%")):n[a]=h}(e.rotate||t.rotate)&&(n.rotate=qt(e.rotate||0,t.rotate||0,i))}function TM(n,e){return n[e]!==void 0?n[e]:n.borderRadius}const UY=kD(0,.5,XO),BY=kD(.5,.95,nr);function kD(n,e,t){return i=>i<n?0:i>e?1:t(Vh(n,e,i))}function RM(n,e){n.min=e.min,n.max=e.max}function xr(n,e){RM(n.x,e.x),RM(n.y,e.y)}function PM(n,e){n.translate=e.translate,n.scale=e.scale,n.originPoint=e.originPoint,n.origin=e.origin}function AM(n,e,t,i,r){return n-=e,n=R_(n,1/t,i),r!==void 0&&(n=R_(n,1/r,i)),n}function zY(n,e=0,t=1,i=.5,r,s=n,o=n){if(Os.test(e)&&(e=parseFloat(e),e=qt(o.min,o.max,e/100)-o.min),typeof e!="number")return;let a=qt(s.min,s.max,i);n===s&&(a-=e),n.min=AM(n.min,e,t,a,r),n.max=AM(n.max,e,t,a,r)}function CM(n,e,[t,i,r],s,o){zY(n,e[t],e[i],e[r],e.scale,s,o)}const $Y=["x","scaleX","originX"],WY=["y","scaleY","originY"];function MM(n,e,t,i){CM(n.x,e,$Y,t?t.x:void 0,i?i.x:void 0),CM(n.y,e,WY,t?t.y:void 0,i?i.y:void 0)}function bM(n){return n.translate===0&&n.scale===1}function LD(n){return bM(n.x)&&bM(n.y)}function kM(n,e){return n.min===e.min&&n.max===e.max}function HY(n,e){return kM(n.x,e.x)&&kM(n.y,e.y)}function LM(n,e){return Math.round(n.min)===Math.round(e.min)&&Math.round(n.max)===Math.round(e.max)}function ND(n,e){return LM(n.x,e.x)&&LM(n.y,e.y)}function NM(n){return or(n.x)/or(n.y)}function OM(n,e){return n.translate===e.translate&&n.scale===e.scale&&n.originPoint===e.originPoint}class KY{constructor(){this.members=[]}add(e){SI(this.members,e),e.scheduleRender()}remove(e){if(II(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(r=>e===r);if(t===0)return!1;let i;for(let r=t;r>=0;r--){const s=this.members[r];if(s.isPresent!==!1){i=s;break}}return i?(this.promote(i),!0):!1}promote(e,t){const i=this.lead;if(e!==i&&(this.prevLead=i,this.lead=e,e.show(),i)){i.instance&&i.scheduleRender(),e.scheduleRender(),e.resumeFrom=i,t&&(e.resumeFrom.preserveOpacity=!0),i.snapshot&&(e.snapshot=i.snapshot,e.snapshot.latestValues=i.animationValues||i.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:r}=e.options;r===!1&&i.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:i}=e;t.onExitComplete&&t.onExitComplete(),i&&i.options.onExitComplete&&i.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function qY(n,e,t){let i="";const r=n.x.translate/e.x,s=n.y.translate/e.y,o=t?.z||0;if((r||s||o)&&(i=`translate3d(${r}px, ${s}px, ${o}px) `),(e.x!==1||e.y!==1)&&(i+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:h,rotate:d,rotateX:g,rotateY:m,skewX:y,skewY:w}=t;h&&(i=`perspective(${h}px) ${i}`),d&&(i+=`rotate(${d}deg) `),g&&(i+=`rotateX(${g}deg) `),m&&(i+=`rotateY(${m}deg) `),y&&(i+=`skewX(${y}deg) `),w&&(i+=`skewY(${w}deg) `)}const a=n.x.scale*e.x,c=n.y.scale*e.y;return(a!==1||c!==1)&&(i+=`scale(${a}, ${c})`),i||"none"}const Gl={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},mf=typeof window<"u"&&window.MotionDebug!==void 0,gE=["","X","Y","Z"],YY={visibility:"hidden"},DM=1e3;let XY=0;function mE(n,e,t,i){const{latestValues:r}=e;r[n]&&(t[n]=r[n],e.setStaticValue(n,0),i&&(i[n]=0))}function OD(n){if(n.hasCheckedOptimisedAppear=!0,n.root===n)return;const{visualElement:e}=n.options;if(!e)return;const t=zO(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:r,layoutId:s}=n.options;window.MotionCancelOptimisedAnimation(t,"transform",Ft,!(r||s))}const{parent:i}=n;i&&!i.hasCheckedOptimisedAppear&&OD(i)}function DD({attachResizeListener:n,defaultParent:e,measureScroll:t,checkIsScrollRoot:i,resetTransform:r}){return class{constructor(o={},a=e?.()){this.id=XY++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,mf&&(Gl.totalNodes=Gl.resolvedTargetDeltas=Gl.recalculatedProjection=0),this.nodes.forEach(JY),this.nodes.forEach(rX),this.nodes.forEach(sX),this.nodes.forEach(eX),mf&&window.MotionDebug.record(Gl)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=a?a.root||a:this,this.path=a?[...a.path,a]:[],this.parent=a,this.depth=a?a.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new VY)}addEventListener(o,a){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new TI),this.eventHandlers.get(o).add(a)}notifyListeners(o,...a){const c=this.eventHandlers.get(o);c&&c.notify(...a)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,a=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=OY(o),this.instance=o;const{layoutId:c,layout:h,visualElement:d}=this.options;if(d&&!d.current&&d.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),a&&(h||c)&&(this.isLayoutDirty=!0),n){let g;const m=()=>this.root.updateBlockedByResize=!1;n(o,()=>{this.root.updateBlockedByResize=!0,g&&g(),g=FY(m,250),E0.hasAnimatedSinceResize&&(E0.hasAnimatedSinceResize=!1,this.nodes.forEach(FM))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&d&&(c||h)&&this.addEventListener("didUpdate",({delta:g,hasLayoutChanged:m,hasRelativeTargetChanged:y,layout:w})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const T=this.options.transition||d.getDefaultTransition()||uX,{onLayoutAnimationStart:E,onLayoutAnimationComplete:P}=d.getProps(),M=!this.targetLayout||!ND(this.targetLayout,w)||y,N=!m&&y;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||N||m&&(M||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(g,N);const D={...vI(T,"layout"),onPlay:E,onComplete:P};(d.shouldReduceMotion||this.options.layoutRoot)&&(D.delay=0,D.type=!1),this.startAnimation(D)}else m||FM(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=w})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,qa(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(oX),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&OD(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let d=0;d<this.path.length;d++){const g=this.path[d];g.shouldResetTransform=!0,g.updateScroll("snapshot"),g.options.layoutRoot&&g.willUpdate(!1)}const{layoutId:a,layout:c}=this.options;if(a===void 0&&!c)return;const h=this.getTransformTemplate();this.prevTransformTemplateValue=h?h(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(VM);return}this.isUpdating||this.nodes.forEach(nX),this.isUpdating=!1,this.nodes.forEach(iX),this.nodes.forEach(QY),this.nodes.forEach(ZY),this.clearAllSnapshots();const a=Ds.now();zn.delta=Po(0,1e3/60,a-zn.timestamp),zn.timestamp=a,zn.isProcessing=!0,sE.update.process(zn),sE.preRender.process(zn),sE.render.process(zn),zn.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,cI.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(tX),this.sharedNodes.forEach(aX)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Ft.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Ft.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=sn(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:a}=this.options;a&&a.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let a=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(a=!1),a){const c=i(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:c,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:c}}}resetTransform(){if(!r)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,a=this.projectionDelta&&!LD(this.projectionDelta),c=this.getTransformTemplate(),h=c?c(this.latestValues,""):void 0,d=h!==this.prevTransformTemplateValue;o&&(a||Fl(this.latestValues)||d)&&(r(this.instance,h),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const a=this.measurePageBox();let c=this.removeElementScroll(a);return o&&(c=this.removeTransform(c)),hX(c),{animationId:this.root.animationId,measuredBox:a,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){var o;const{visualElement:a}=this.options;if(!a)return sn();const c=a.measureViewportBox();if(!(((o=this.scroll)===null||o===void 0?void 0:o.wasRoot)||this.path.some(dX))){const{scroll:d}=this.root;d&&(Xu(c.x,d.offset.x),Xu(c.y,d.offset.y))}return c}removeElementScroll(o){var a;const c=sn();if(xr(c,o),!((a=this.scroll)===null||a===void 0)&&a.wasRoot)return c;for(let h=0;h<this.path.length;h++){const d=this.path[h],{scroll:g,options:m}=d;d!==this.root&&g&&m.layoutScroll&&(g.wasRoot&&xr(c,o),Xu(c.x,g.offset.x),Xu(c.y,g.offset.y))}return c}applyTransform(o,a=!1){const c=sn();xr(c,o);for(let h=0;h<this.path.length;h++){const d=this.path[h];!a&&d.options.layoutScroll&&d.scroll&&d!==d.root&&Qu(c,{x:-d.scroll.offset.x,y:-d.scroll.offset.y}),Fl(d.latestValues)&&Qu(c,d.latestValues)}return Fl(this.latestValues)&&Qu(c,this.latestValues),c}removeTransform(o){const a=sn();xr(a,o);for(let c=0;c<this.path.length;c++){const h=this.path[c];if(!h.instance||!Fl(h.latestValues))continue;$w(h.latestValues)&&h.updateSnapshot();const d=sn(),g=h.measurePageBox();xr(d,g),MM(a,h.latestValues,h.snapshot?h.snapshot.layoutBox:void 0,d)}return Fl(this.latestValues)&&MM(a,this.latestValues),a}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==zn.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var a;const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const h=!!this.resumingFrom||this!==c;if(!(o||h&&this.isSharedProjectionDirty||this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:g,layoutId:m}=this.options;if(!(!this.layout||!(g||m))){if(this.resolvedRelativeTargetAt=zn.timestamp,!this.targetDelta&&!this.relativeTarget){const y=this.getClosestProjectingParent();y&&y.layout&&this.animationProgress!==1?(this.relativeParent=y,this.forceRelativeParentToResolveTarget(),this.relativeTarget=sn(),this.relativeTargetOrigin=sn(),Of(this.relativeTargetOrigin,this.layout.layoutBox,y.layout.layoutBox),xr(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=sn(),this.targetWithTransforms=sn()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),mY(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):xr(this.target,this.layout.layoutBox),PD(this.target,this.targetDelta)):xr(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const y=this.getClosestProjectingParent();y&&!!y.resumingFrom==!!this.resumingFrom&&!y.options.layoutScroll&&y.target&&this.animationProgress!==1?(this.relativeParent=y,this.forceRelativeParentToResolveTarget(),this.relativeTarget=sn(),this.relativeTargetOrigin=sn(),Of(this.relativeTargetOrigin,this.target,y.target),xr(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}mf&&Gl.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||$w(this.parent.latestValues)||RD(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const a=this.getLead(),c=!!this.resumingFrom||this!==a;let h=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(h=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(h=!1),this.resolvedRelativeTargetAt===zn.timestamp&&(h=!1),h)return;const{layout:d,layoutId:g}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(d||g))return;xr(this.layoutCorrected,this.layout.layoutBox);const m=this.treeScale.x,y=this.treeScale.y;IY(this.layoutCorrected,this.treeScale,this.path,c),a.layout&&!a.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(a.target=a.layout.layoutBox,a.targetWithTransforms=sn());const{target:w}=a;if(!w){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(PM(this.prevProjectionDelta.x,this.projectionDelta.x),PM(this.prevProjectionDelta.y,this.projectionDelta.y)),Nf(this.projectionDelta,this.layoutCorrected,w,this.latestValues),(this.treeScale.x!==m||this.treeScale.y!==y||!OM(this.projectionDelta.x,this.prevProjectionDelta.x)||!OM(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",w)),mf&&Gl.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var a;if((a=this.options.visualElement)===null||a===void 0||a.scheduleRender(),o){const c=this.getStack();c&&c.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Yu(),this.projectionDelta=Yu(),this.projectionDeltaWithTransform=Yu()}setAnimationOrigin(o,a=!1){const c=this.snapshot,h=c?c.latestValues:{},d={...this.latestValues},g=Yu();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!a;const m=sn(),y=c?c.source:void 0,w=this.layout?this.layout.source:void 0,T=y!==w,E=this.getStack(),P=!E||E.members.length<=1,M=!!(T&&!P&&this.options.crossfade===!0&&!this.path.some(cX));this.animationProgress=0;let N;this.mixTargetDelta=D=>{const j=D/1e3;GM(g.x,o.x,j),GM(g.y,o.y,j),this.setTargetDelta(g),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Of(m,this.layout.layoutBox,this.relativeParent.layout.layoutBox),lX(this.relativeTarget,this.relativeTargetOrigin,m,j),N&&HY(this.relativeTarget,N)&&(this.isProjectionDirty=!1),N||(N=sn()),xr(N,this.relativeTarget)),T&&(this.animationValues=d,jY(d,h,this.latestValues,j,M,P)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=j},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(qa(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Ft.update(()=>{E0.hasAnimatedSinceResize=!0,this.currentAnimation=NY(0,DM,{...o,onUpdate:a=>{this.mixTargetDelta(a),o.onUpdate&&o.onUpdate(a)},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(DM),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:a,target:c,layout:h,latestValues:d}=o;if(!(!a||!c||!h)){if(this!==o&&this.layout&&h&&VD(this.options.animationType,this.layout.layoutBox,h.layoutBox)){c=this.target||sn();const g=or(this.layout.layoutBox.x);c.x.min=o.target.x.min,c.x.max=c.x.min+g;const m=or(this.layout.layoutBox.y);c.y.min=o.target.y.min,c.y.max=c.y.min+m}xr(a,c),Qu(a,d),Nf(this.projectionDeltaWithTransform,this.layoutCorrected,a,d)}}registerSharedNode(o,a){this.sharedNodes.has(o)||this.sharedNodes.set(o,new KY),this.sharedNodes.get(o).add(a);const h=a.options.initialPromotionConfig;a.promote({transition:h?h.transition:void 0,preserveFollowOpacity:h&&h.shouldPreserveFollowOpacity?h.shouldPreserveFollowOpacity(a):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:a}=this.options;return a?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:a}=this.options;return a?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:a,preserveFollowOpacity:c}={}){const h=this.getStack();h&&h.promote(this,c),o&&(this.projectionDelta=void 0,this.needsReset=!0),a&&this.setOptions({transition:a})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let a=!1;const{latestValues:c}=o;if((c.z||c.rotate||c.rotateX||c.rotateY||c.rotateZ||c.skewX||c.skewY)&&(a=!0),!a)return;const h={};c.z&&mE("z",o,h,this.animationValues);for(let d=0;d<gE.length;d++)mE(`rotate${gE[d]}`,o,h,this.animationValues),mE(`skew${gE[d]}`,o,h,this.animationValues);o.render();for(const d in h)o.setStaticValue(d,h[d]),this.animationValues&&(this.animationValues[d]=h[d]);o.scheduleRender()}getProjectionStyles(o){var a,c;if(!this.instance||this.isSVG)return;if(!this.isVisible)return YY;const h={visibility:""},d=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,h.opacity="",h.pointerEvents=y0(o?.pointerEvents)||"",h.transform=d?d(this.latestValues,""):"none",h;const g=this.getLead();if(!this.projectionDelta||!this.layout||!g.target){const T={};return this.options.layoutId&&(T.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,T.pointerEvents=y0(o?.pointerEvents)||""),this.hasProjected&&!Fl(this.latestValues)&&(T.transform=d?d({},""):"none",this.hasProjected=!1),T}const m=g.animationValues||g.latestValues;this.applyTransformsToTarget(),h.transform=qY(this.projectionDeltaWithTransform,this.treeScale,m),d&&(h.transform=d(m,h.transform));const{x:y,y:w}=this.projectionDelta;h.transformOrigin=`${y.origin*100}% ${w.origin*100}% 0`,g.animationValues?h.opacity=g===this?(c=(a=m.opacity)!==null&&a!==void 0?a:this.latestValues.opacity)!==null&&c!==void 0?c:1:this.preserveOpacity?this.latestValues.opacity:m.opacityExit:h.opacity=g===this?m.opacity!==void 0?m.opacity:"":m.opacityExit!==void 0?m.opacityExit:0;for(const T in w_){if(m[T]===void 0)continue;const{correct:E,applyTo:P}=w_[T],M=h.transform==="none"?m[T]:E(m[T],g);if(P){const N=P.length;for(let D=0;D<N;D++)h[P[D]]=M}else h[T]=M}return this.options.layoutId&&(h.pointerEvents=g===this?y0(o?.pointerEvents)||"":"none"),h}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var a;return(a=o.currentAnimation)===null||a===void 0?void 0:a.stop()}),this.root.nodes.forEach(VM),this.root.sharedNodes.clear()}}}function QY(n){n.updateLayout()}function ZY(n){var e;const t=((e=n.resumeFrom)===null||e===void 0?void 0:e.snapshot)||n.snapshot;if(n.isLead()&&n.layout&&t&&n.hasListeners("didUpdate")){const{layoutBox:i,measuredBox:r}=n.layout,{animationType:s}=n.options,o=t.source!==n.layout.source;s==="size"?Sr(g=>{const m=o?t.measuredBox[g]:t.layoutBox[g],y=or(m);m.min=i[g].min,m.max=m.min+y}):VD(s,t.layoutBox,i)&&Sr(g=>{const m=o?t.measuredBox[g]:t.layoutBox[g],y=or(i[g]);m.max=m.min+y,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[g].max=n.relativeTarget[g].min+y)});const a=Yu();Nf(a,i,t.layoutBox);const c=Yu();o?Nf(c,n.applyTransform(r,!0),t.measuredBox):Nf(c,i,t.layoutBox);const h=!LD(a);let d=!1;if(!n.resumeFrom){const g=n.getClosestProjectingParent();if(g&&!g.resumeFrom){const{snapshot:m,layout:y}=g;if(m&&y){const w=sn();Of(w,t.layoutBox,m.layoutBox);const T=sn();Of(T,i,y.layoutBox),ND(w,T)||(d=!0),g.options.layoutRoot&&(n.relativeTarget=T,n.relativeTargetOrigin=w,n.relativeParent=g)}}}n.notifyListeners("didUpdate",{layout:i,snapshot:t,delta:c,layoutDelta:a,hasLayoutChanged:h,hasRelativeTargetChanged:d})}else if(n.isLead()){const{onExitComplete:i}=n.options;i&&i()}n.options.transition=void 0}function JY(n){mf&&Gl.totalNodes++,n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function eX(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function tX(n){n.clearSnapshot()}function VM(n){n.clearMeasurements()}function nX(n){n.isLayoutDirty=!1}function iX(n){const{visualElement:e}=n.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),n.resetTransform()}function FM(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function rX(n){n.resolveTargetDelta()}function sX(n){n.calcProjection()}function oX(n){n.resetSkewAndRotation()}function aX(n){n.removeLeadSnapshot()}function GM(n,e,t){n.translate=qt(e.translate,0,t),n.scale=qt(e.scale,1,t),n.origin=e.origin,n.originPoint=e.originPoint}function jM(n,e,t,i){n.min=qt(e.min,t.min,i),n.max=qt(e.max,t.max,i)}function lX(n,e,t,i){jM(n.x,e.x,t.x,i),jM(n.y,e.y,t.y,i)}function cX(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const uX={duration:.45,ease:[.4,0,.1,1]},UM=n=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(n),BM=UM("applewebkit/")&&!UM("chrome/")?Math.round:nr;function zM(n){n.min=BM(n.min),n.max=BM(n.max)}function hX(n){zM(n.x),zM(n.y)}function VD(n,e,t){return n==="position"||n==="preserve-aspect"&&!gY(NM(e),NM(t),.2)}function dX(n){var e;return n!==n.root&&((e=n.scroll)===null||e===void 0?void 0:e.wasRoot)}const fX=DD({attachResizeListener:(n,e)=>Ig(n,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),pE={current:void 0},FD=DD({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!pE.current){const n=new fX({});n.mount(window),n.setOptions({layoutScroll:!0}),pE.current=n}return pE.current},resetTransform:(n,e)=>{n.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),gX={pan:{Feature:MY},drag:{Feature:CY,ProjectionNode:FD,MeasureLayout:MD}};function $M(n,e,t){const{props:i}=n;n.animationState&&i.whileHover&&n.animationState.setActive("whileHover",t==="Start");const r="onHover"+t,s=i[r];s&&Ft.postRender(()=>s(e,cm(e)))}class mX extends tl{mount(){const{current:e}=this.node;e&&(this.unmount=gK(e,t=>($M(this.node,t,"Start"),i=>$M(this.node,i,"End"))))}unmount(){}}class pX extends tl{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=lm(Ig(this.node.current,"focus",()=>this.onFocus()),Ig(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function WM(n,e,t){const{props:i}=n;n.animationState&&i.whileTap&&n.animationState.setActive("whileTap",t==="Start");const r="onTap"+(t==="End"?"":t),s=i[r];s&&Ft.postRender(()=>s(e,cm(e)))}class _X extends tl{mount(){const{current:e}=this.node;e&&(this.unmount=yK(e,t=>(WM(this.node,t,"Start"),(i,{success:r})=>WM(this.node,i,r?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const Hw=new WeakMap,_E=new WeakMap,yX=n=>{const e=Hw.get(n.target);e&&e(n)},vX=n=>{n.forEach(yX)};function EX({root:n,...e}){const t=n||document;_E.has(t)||_E.set(t,{});const i=_E.get(t),r=JSON.stringify(e);return i[r]||(i[r]=new IntersectionObserver(vX,{root:n,...e})),i[r]}function wX(n,e,t){const i=EX(e);return Hw.set(n,t),i.observe(n),()=>{Hw.delete(n),i.unobserve(n)}}const xX={some:0,all:1};class SX extends tl{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:i,amount:r="some",once:s}=e,o={root:t?t.current:void 0,rootMargin:i,threshold:typeof r=="number"?r:xX[r]},a=c=>{const{isIntersecting:h}=c;if(this.isInView===h||(this.isInView=h,s&&!h&&this.hasEnteredView))return;h&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",h);const{onViewportEnter:d,onViewportLeave:g}=this.node.getProps(),m=h?d:g;m&&m(c)};return wX(this.node.current,o,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(IX(e,t))&&this.startObserver()}unmount(){}}function IX({viewport:n={}},{viewport:e={}}={}){return t=>n[t]!==e[t]}const TX={inView:{Feature:SX},tap:{Feature:_X},focus:{Feature:pX},hover:{Feature:mX}},RX={layout:{ProjectionNode:FD,MeasureLayout:MD}},Kw={current:null},GD={current:!1};function PX(){if(GD.current=!0,!!rI)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),e=()=>Kw.current=n.matches;n.addListener(e),e()}else Kw.current=!1}const AX=[...uD,ti,Ya],CX=n=>AX.find(cD(n)),HM=new WeakMap;function MX(n,e,t){for(const i in e){const r=e[i],s=t[i];if(li(r))n.addValue(i,r);else if(li(s))n.addValue(i,xg(r,{owner:n}));else if(s!==r)if(n.hasValue(i)){const o=n.getValue(i);o.liveStyle===!0?o.jump(r):o.hasAnimated||o.set(r)}else{const o=n.getStaticValue(i);n.addValue(i,xg(o!==void 0?o:r,{owner:n}))}}for(const i in t)e[i]===void 0&&n.removeValue(i);return e}const KM=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class bX{scrapeMotionValuesFromProps(e,t,i){return{}}constructor({parent:e,props:t,presenceContext:i,reducedMotionConfig:r,blockInitialAnimation:s,visualState:o},a={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=bI,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const y=Ds.now();this.renderScheduledAt<y&&(this.renderScheduledAt=y,Ft.render(this.render,!1,!0))};const{latestValues:c,renderState:h,onUpdate:d}=o;this.onUpdate=d,this.latestValues=c,this.baseTarget={...c},this.initialValues=t.initial?{...c}:{},this.renderState=h,this.parent=e,this.props=t,this.presenceContext=i,this.depth=e?e.depth+1:0,this.reducedMotionConfig=r,this.options=a,this.blockInitialAnimation=!!s,this.isControllingVariants=Ly(t),this.isVariantNode=yO(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:g,...m}=this.scrapeMotionValuesFromProps(t,{},this);for(const y in m){const w=m[y];c[y]!==void 0&&li(w)&&w.set(c[y],!1)}}mount(e){this.current=e,HM.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((t,i)=>this.bindToMotionValue(i,t)),GD.current||PX(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:Kw.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){HM.delete(this.current),this.projection&&this.projection.unmount(),qa(this.notifyUpdate),qa(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const i=Vc.has(e),r=t.on("change",a=>{this.latestValues[e]=a,this.props.onUpdate&&Ft.preRender(this.notifyUpdate),i&&this.projection&&(this.projection.isTransformDirty=!0)}),s=t.on("renderRequest",this.scheduleRender);let o;window.MotionCheckAppearSync&&(o=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{r(),s(),o&&o(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in Fh){const t=Fh[e];if(!t)continue;const{isEnabled:i,Feature:r}=t;if(!this.features[e]&&r&&i(this.props)&&(this.features[e]=new r(this)),this.features[e]){const s=this.features[e];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):sn()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let i=0;i<KM.length;i++){const r=KM[i];this.propEventSubscriptions[r]&&(this.propEventSubscriptions[r](),delete this.propEventSubscriptions[r]);const s="on"+r,o=e[s];o&&(this.propEventSubscriptions[r]=this.on(r,o))}this.prevMotionValues=MX(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const i=this.values.get(e);t!==i&&(i&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let i=this.values.get(e);return i===void 0&&t!==void 0&&(i=xg(t===null?void 0:t,{owner:this}),this.addValue(e,i)),i}readValue(e,t){var i;let r=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(i=this.getBaseTargetFromProps(this.props,e))!==null&&i!==void 0?i:this.readValueFromInstance(this.current,e,this.options);return r!=null&&(typeof r=="string"&&(aD(r)||ZO(r))?r=parseFloat(r):!CX(r)&&Ya.test(t)&&(r=rD(e,t)),this.setBaseTarget(e,li(r)?r.get():r)),li(r)?r.get():r}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var t;const{initial:i}=this.props;let r;if(typeof i=="string"||typeof i=="object"){const o=hI(this.props,i,(t=this.presenceContext)===null||t===void 0?void 0:t.custom);o&&(r=o[e])}if(i&&r!==void 0)return r;const s=this.getBaseTargetFromProps(this.props,e);return s!==void 0&&!li(s)?s:this.initialValues[e]!==void 0&&r===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new TI),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}}class jD extends bX{constructor(){super(...arguments),this.KeyframeResolver=hD}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:i}){delete t[e],delete i[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;li(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function kX(n){return window.getComputedStyle(n)}class LX extends jD{constructor(){super(...arguments),this.type="html",this.renderInstance=PO}readValueFromInstance(e,t){if(Vc.has(t)){const i=MI(t);return i&&i.default||0}else{const i=kX(e),r=(IO(t)?i.getPropertyValue(t):i[t])||0;return typeof r=="string"?r.trim():r}}measureInstanceViewportBox(e,{transformPagePoint:t}){return AD(e,t)}build(e,t,i){gI(e,t,i.transformTemplate)}scrapeMotionValuesFromProps(e,t,i){return yI(e,t,i)}}class NX extends jD{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=sn}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(Vc.has(t)){const i=MI(t);return i&&i.default||0}return t=AO.has(t)?t:lI(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,i){return bO(e,t,i)}build(e,t,i){mI(e,t,this.isSVGTag,i.transformTemplate)}renderInstance(e,t,i,r){CO(e,t,i,r)}mount(e){this.isSVGTag=_I(e.tagName),super.mount(e)}}const OX=(n,e)=>uI(n)?new NX(e):new LX(e,{allowProjection:n!==se.Fragment}),DX=aK({...sY,...TX,...gX,...RX},OX),ln=xH(DX);const VX=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),FX=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,i)=>i?i.toUpperCase():t.toLowerCase()),qM=n=>{const e=FX(n);return e.charAt(0).toUpperCase()+e.slice(1)},UD=(...n)=>n.filter((e,t,i)=>!!e&&e.trim()!==""&&i.indexOf(e)===t).join(" ").trim(),GX=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var jX={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const UX=se.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:i,className:r="",children:s,iconNode:o,...a},c)=>se.createElement("svg",{ref:c,...jX,width:e,height:e,stroke:n,strokeWidth:i?Number(t)*24/Number(e):t,className:UD("lucide",r),...!s&&!GX(a)&&{"aria-hidden":"true"},...a},[...o.map(([h,d])=>se.createElement(h,d)),...Array.isArray(s)?s:[s]]));const Je=(n,e)=>{const t=se.forwardRef(({className:i,...r},s)=>se.createElement(UX,{ref:s,iconNode:e,className:UD(`lucide-${VX(qM(n))}`,`lucide-${n}`,i),...r}));return t.displayName=qM(n),t};const BX=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],zX=Je("arrow-left",BX);const $X=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],WX=Je("arrow-right",$X);const HX=[["path",{d:"M7 17V7h10",key:"11bw93"}],["path",{d:"M17 17 7 7",key:"2786uv"}]],KX=Je("arrow-up-left",HX);const qX=[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]],YX=Je("arrow-up-right",qX);const XX=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],QX=Je("arrow-up",XX);const ZX=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],JX=Je("check",ZX);const eQ=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],tQ=Je("chevron-down",eQ);const nQ=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],iQ=Je("chevron-left",nQ);const rQ=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],BD=Je("chevron-right",rQ);const sQ=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],zD=Je("chevron-up",sQ);const oQ=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],aQ=Je("circle-alert",oQ);const lQ=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],cQ=Je("circle",lQ);const uQ=[["path",{d:"m16.24 7.76-1.804 5.411a2 2 0 0 1-1.265 1.265L7.76 16.24l1.804-5.411a2 2 0 0 1 1.265-1.265z",key:"9ktpf1"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],hQ=Je("compass",uQ);const dQ=[["path",{d:"M20 20v-7a4 4 0 0 0-4-4H4",key:"1nkjon"}],["path",{d:"M9 14 4 9l5-5",key:"102s5s"}]],fQ=Je("corner-up-left",dQ);const gQ=[["path",{d:"m15 14 5-5-5-5",key:"12vg1m"}],["path",{d:"M4 20v-7a4 4 0 0 1 4-4h12",key:"1lu4f8"}]],mQ=Je("corner-up-right",gQ);const pQ=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],_Q=Je("folder-open",pQ);const yQ=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],vQ=Je("folder",yQ);const EQ=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],wQ=Je("grid-3x3",EQ);const xQ=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],SQ=Je("info",xQ);const IQ=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],Tg=Je("layers",IQ);const TQ=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],$D=Je("loader-circle",TQ);const RQ=[["line",{x1:"2",x2:"5",y1:"12",y2:"12",key:"bvdh0s"}],["line",{x1:"19",x2:"22",y1:"12",y2:"12",key:"1tbv5k"}],["line",{x1:"12",x2:"12",y1:"2",y2:"5",key:"11lu5j"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}],["circle",{cx:"12",cy:"12",r:"7",key:"fim9np"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],PQ=Je("locate-fixed",RQ);const AQ=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],WD=Je("map-pin",AQ);const CQ=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],HD=Je("map",CQ);const MQ=[["path",{d:"M5 12h14",key:"1ays0h"}]],bQ=Je("minus",MQ);const kQ=[["path",{d:"m8 3 4 8 5-5 5 15H2L8 3z",key:"otkl63"}]],qw=Je("mountain",kQ);const LQ=[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]],Dy=Je("navigation",LQ);const NQ=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],KD=Je("plus",NQ);const OQ=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],Yw=Je("rotate-ccw",OQ);const DQ=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],qD=Je("search",DQ);const VQ=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],YD=Je("settings",VQ);const FQ=[["path",{d:"M10 5H3",key:"1qgfaw"}],["path",{d:"M12 19H3",key:"yhmn1j"}],["path",{d:"M14 3v4",key:"1sua03"}],["path",{d:"M16 17v4",key:"1q0r14"}],["path",{d:"M21 12h-9",key:"1o4lsq"}],["path",{d:"M21 19h-5",key:"1rlt1p"}],["path",{d:"M21 5h-7",key:"1oszz2"}],["path",{d:"M8 10v4",key:"tgpxqk"}],["path",{d:"M8 12H3",key:"a7s4jb"}]],GQ=Je("sliders-horizontal",FQ);const jQ=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],UQ=Je("smartphone",jQ);const BQ=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],zQ=Je("target",BQ);const $Q=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],WQ=Je("trash-2",$Q);const HQ=[["path",{d:"M13 8c0-2.76-2.46-5-5.5-5S2 5.24 2 8h2l1-1 1 1h4",key:"foxbe7"}],["path",{d:"M13 7.14A5.82 5.82 0 0 1 16.5 6c3.04 0 5.5 2.24 5.5 5h-3l-1-1-1 1h-3",key:"18arnh"}],["path",{d:"M5.89 9.71c-2.15 2.15-2.3 5.47-.35 7.43l4.24-4.25.7-.7.71-.71 2.12-2.12c-1.95-1.96-5.27-1.8-7.42.35",key:"ywahnh"}],["path",{d:"M11 15.5c.5 2.5-.17 4.5-1 6.5h4c2-5.5-.5-12-1-14",key:"ft0feo"}]],KQ=Je("tree-palm",HQ);const qQ=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],YQ=Je("volume-2",qQ);const XQ=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]],QQ=Je("volume-x",XQ);const ZQ=[["path",{d:"M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"knzxuh"}],["path",{d:"M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"2jd2cc"}],["path",{d:"M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"rd2r6e"}]],JQ=Je("waves",ZQ);const eZ=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Fc=Je("x",eZ);function tZ(){const{tracking:n,startTracking:e,stopTracking:t,updatePosition:i,setWatchId:r,resetFirstFix:s}=Ut(),o=se.useCallback(c=>{i(c)},[i]),a=se.useCallback(c=>{console.error("GPS error:",c),alert(`GPS fout: ${c.message}`),t()},[t]);return se.useEffect(()=>{if(!n)return;if(!navigator.geolocation){alert("Geolocation wordt niet ondersteund door deze browser"),t();return}const c=navigator.geolocation.watchPosition(o,a,{enableHighAccuracy:!0,maximumAge:1e3,timeout:15e3});return r(c),()=>{navigator.geolocation.clearWatch(c)}},[n,o,a,r,t]),{tracking:n,start:e,stop:t,toggle:()=>n?t():e()}}function nZ(){const{tracking:n,toggle:e}=tZ();return C.jsx(ln.button,{className:`
        fixed bottom-[30px] md:bottom-10 right-2.5 z-[1000]
        w-11 h-11 cursor-pointer border-0 outline-none
        flex items-center justify-center
        rounded-xl backdrop-blur-sm
        transition-all duration-200
        ${n?"bg-gradient-to-br from-blue-400 to-blue-600 text-white shadow-lg shadow-blue-500/30":"bg-white/80 text-gray-500 hover:bg-white/90 shadow-sm"}
      `,onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},animate:n?{scale:[1,1.02,1]}:{},transition:n?{scale:{duration:2,repeat:1/0,ease:"easeInOut"}}:{},"aria-label":n?"GPS tracking actief":"GPS tracking starten",title:n?"GPS tracking actief":"GPS tracking starten",children:C.jsx(PQ,{size:22,strokeWidth:2})})}const YM="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(`<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40">
    <polygon points="20,4 32,32 20,26 8,32" fill="#4285F4" stroke="white" stroke-width="2.5" stroke-linejoin="round"/>
  </svg>`);function iZ(){const n=Ei(E=>E.map),e=Ei(E=>E.rotation),t=Ut(E=>E.position),i=Ut(E=>E.accuracy),r=Ut(E=>E.tracking),s=Ut(E=>E.navigationMode),o=Ut(E=>E.smoothHeading),a=Ut(E=>E.firstFix),c=Ut(E=>E.resetFirstFix),h=Ut(E=>E.config.centerOnUser),d=Ut(E=>E.config.animationDuration),g=se.useRef(null),m=se.useRef(null),y=se.useRef(null),w=se.useRef(0),T=se.useMemo(()=>new ji({image:new G0({src:YM,scale:1,rotation:0,rotateWithView:!1,anchor:[.5,.5]})}),[]);return se.useEffect(()=>{if(!n||!r&&!t)return;const E=ac([5.1214,52.0907]);return g.current=new gh({geometry:new cc(E)}),g.current.setStyle(T),m.current=new gh({geometry:new cc(E)}),y.current=new jx({source:new bx({features:[m.current,g.current]}),zIndex:1e3}),n.addLayer(y.current),()=>{y.current&&n&&n.removeLayer(y.current)}},[n,r,t,T]),se.useEffect(()=>{if(!n||!t||!g.current||!m.current)return;const E=ac([t.lng,t.lat]);if(g.current.getGeometry()?.setCoordinates(E),m.current.getGeometry()?.setCoordinates(E),i){const P=n.getView().getResolution()||1,M=i/P;m.current.setStyle(new ji({image:new Uh({radius:Math.min(M,100),fill:new wo({color:"rgba(66, 133, 244, 0.1)"})})}))}a&&r&&(n.getView().setCenter(E),n.getView().setZoom(17),c(),console.log(" GPS locked - jumped to position + street level")),r&&h&&!a&&n.getView().animate({center:E,duration:d})},[n,r,t,i,a,c,h,d]),se.useEffect(()=>{if(!n||!g.current)return;const P=n.getView().getRotation();let M;s==="free"?M=o!==null?o*Math.PI/180:0:M=-P;const N=5*Math.PI/180;let D=M-w.current;D>Math.PI&&(D-=2*Math.PI),D<-Math.PI&&(D+=2*Math.PI),!(Math.abs(D)<N)&&(w.current=M,g.current.setStyle(new ji({image:new G0({src:YM,scale:1,rotation:M,rotateWithView:!1,anchor:[.5,.5]})})))},[n,s,o,e]),null}function rZ(){const n=xh(t=>t.themesPanelOpen),e=xh(t=>t.toggleThemesPanel);return C.jsx(ln.button,{className:`
        fixed bottom-[85px] md:bottom-[95px] right-2.5 z-[1000]
        w-10 h-10 cursor-pointer border-0 outline-none
        flex items-center justify-center
        rounded-xl backdrop-blur-sm
        transition-all duration-200
        ${n?"bg-gradient-to-br from-blue-400 to-blue-600 text-white shadow-lg shadow-blue-500/30":"bg-white/80 text-gray-500 hover:bg-white/90 shadow-sm"}
      `,onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":n?"Kaartlagen sluiten":"Kaartlagen openen",title:"Kaartlagen",children:C.jsx(HD,{size:20,strokeWidth:2})})}function sZ(){return C.jsx(rZ,{})}function Un({title:n,children:e,defaultExpanded:t=!0}){const[i,r]=se.useState(t);return C.jsxs("div",{className:"mb-0.5",children:[C.jsxs("button",{onClick:()=>r(!i),className:"w-full flex items-center gap-1 py-1 px-1 bg-transparent border-0 outline-none hover:bg-blue-100 transition-colors text-left",children:[C.jsx(ln.span,{animate:{rotate:i?90:0},transition:{duration:.15},className:"text-gray-400",children:C.jsx(BD,{size:14})}),i?C.jsx(_Q,{size:16,className:"text-blue-500"}):C.jsx(vQ,{size:16,className:"text-blue-500"}),C.jsx("span",{className:"text-sm text-gray-700 font-medium",children:n})]}),C.jsx(Lo,{initial:!1,children:i&&C.jsx(ln.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.15},style:{overflow:"hidden"},className:"ml-5",children:e})})]})}function be({name:n,type:e}){const t=ai(d=>d.visible[n]),i=ai(d=>d.loadingState[n]),r=ai(d=>d.toggleLayer),s=ai(d=>d.setLayerVisibility),o=i==="loading",a=i==="error",c=()=>{o||(e==="overlay"?r(n):["CartoDB (licht)","OpenStreetMap","Luchtfoto","TMK 1850","Bonnebladen 1900"].forEach(g=>{s(g,g===n)}))},h=t??!1;return C.jsxs("button",{onClick:c,disabled:o,className:`w-full flex items-center justify-between py-1 pl-3 pr-2 bg-transparent border-0 outline-none transition-colors text-left ${o?"opacity-70 cursor-wait":"hover:bg-blue-100"}`,children:[C.jsxs("span",{className:`text-sm ${a?"text-red-500":"text-gray-600"}`,children:[n,a&&C.jsx(aQ,{size:12,className:"inline ml-1 text-red-500"})]}),C.jsx("div",{className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:o?"#93c5fd":h?"#3b82f6":"white",border:o?"2px solid #93c5fd":h?"2px solid #3b82f6":"2px solid #60a5fa",color:"white"},children:o?C.jsx($D,{size:10,strokeWidth:3,className:"animate-spin"}):h?C.jsx(JX,{size:12,strokeWidth:3}):null})]})}function oZ(){const{themesPanelOpen:n,toggleThemesPanel:e}=xh();return C.jsx(Lo,{children:n&&C.jsxs(C.Fragment,{children:[C.jsx(ln.div,{className:"fixed inset-0 z-[998]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),C.jsxs(ln.div,{className:"fixed top-2.5 right-2.5 z-[999] bg-white rounded-lg shadow-lg overflow-hidden w-[240px] max-h-[calc(100vh-200px)] flex flex-col",initial:{opacity:0,x:10},animate:{opacity:1,x:0},exit:{opacity:0,x:10},transition:{duration:.15},children:[C.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-gradient-to-r from-blue-500 to-blue-600 text-white",children:[C.jsxs("div",{className:"flex items-center gap-2",children:[C.jsx(Tg,{size:14}),C.jsx("span",{className:"font-medium text-sm",children:"Kaartlagen"})]}),C.jsx("button",{onClick:e,className:"p-0.5 rounded border-0 outline-none hover:bg-white/20 transition-colors",children:C.jsx(Fc,{size:16})})]}),C.jsxs("div",{className:"p-2 overflow-y-auto flex-1",children:[C.jsxs(Un,{title:"Achtergronden",defaultExpanded:!0,children:[C.jsx(be,{name:"CartoDB (licht)",type:"base"}),C.jsx(be,{name:"OpenStreetMap",type:"base"}),C.jsx(be,{name:"Luchtfoto",type:"base"}),C.jsx(be,{name:"Labels Overlay",type:"overlay"}),C.jsx(be,{name:"TMK 1850",type:"base"}),C.jsx(be,{name:"Bonnebladen 1900",type:"base"})]}),C.jsxs(Un,{title:"Thema's",defaultExpanded:!1,children:[C.jsxs(Un,{title:"Steentijd & Prehistorie",defaultExpanded:!1,children:[C.jsx(be,{name:"Hunebedden",type:"overlay"}),C.jsx(be,{name:"FAMKE Steentijd",type:"overlay"}),C.jsx(be,{name:"Grafheuvels",type:"overlay"}),C.jsx(be,{name:"Terpen",type:"overlay"})]}),C.jsxs(Un,{title:"Archeologische lagen",defaultExpanded:!1,children:[C.jsx(be,{name:"AMK Monumenten",type:"overlay"}),C.jsx(be,{name:"Romeinse wegen",type:"overlay"}),C.jsx(be,{name:"IKAW",type:"overlay"}),C.jsx(be,{name:"Archeo Landschappen",type:"overlay"})]}),C.jsxs(Un,{title:"Erfgoed & Monumenten",defaultExpanded:!1,children:[C.jsx(be,{name:"Rijksmonumenten",type:"overlay"}),C.jsx(be,{name:"Werelderfgoed",type:"overlay"}),C.jsx(be,{name:"Religieus Erfgoed",type:"overlay"}),C.jsx(be,{name:"Kastelen",type:"overlay"})]}),C.jsxs(Un,{title:"WOII & Militair",defaultExpanded:!1,children:[C.jsx(be,{name:"WWII Bunkers",type:"overlay"}),C.jsx(be,{name:"Slagvelden",type:"overlay"}),C.jsx(be,{name:"Militaire Vliegvelden",type:"overlay"}),C.jsx(be,{name:"Verdedigingslinies",type:"overlay"}),C.jsx(be,{name:"Militaire Objecten",type:"overlay"}),C.jsx(be,{name:"Inundatiegebieden",type:"overlay"})]}),C.jsxs(Un,{title:"Paleokaarten (tijdreizen)",defaultExpanded:!1,children:[C.jsx(be,{name:"Paleokaart 800 n.Chr.",type:"overlay"}),C.jsx(be,{name:"Paleokaart 100 n.Chr.",type:"overlay"}),C.jsx(be,{name:"Paleokaart 500 v.Chr.",type:"overlay"}),C.jsx(be,{name:"Paleokaart 1500 v.Chr.",type:"overlay"}),C.jsx(be,{name:"Paleokaart 2750 v.Chr.",type:"overlay"}),C.jsx(be,{name:"Paleokaart 5500 v.Chr.",type:"overlay"}),C.jsx(be,{name:"Paleokaart 9000 v.Chr.",type:"overlay"})]}),C.jsxs(Un,{title:"Uiterwaarden (UIKAV)",defaultExpanded:!1,children:[C.jsx(be,{name:"UIKAV Punten",type:"overlay"}),C.jsx(be,{name:"UIKAV Vlakken",type:"overlay"}),C.jsx(be,{name:"UIKAV Expert",type:"overlay"}),C.jsx(be,{name:"UIKAV Buffer",type:"overlay"}),C.jsx(be,{name:"UIKAV Indeling",type:"overlay"})]}),C.jsxs(Un,{title:"Hillshade & LiDAR",defaultExpanded:!1,children:[C.jsx(be,{name:"AHN4 Hillshade NL",type:"overlay"}),C.jsx(be,{name:"AHN4 Multi-Hillshade NL",type:"overlay"}),C.jsx(be,{name:"AHN 0.5m",type:"overlay"}),C.jsx(be,{name:"World Hillshade",type:"overlay"})]}),C.jsxs(Un,{title:"Terrein & Bodem",defaultExpanded:!1,children:[C.jsx(be,{name:"Veengebieden",type:"overlay"}),C.jsx(be,{name:"Geomorfologie",type:"overlay"}),C.jsx(be,{name:"Bodemkaart",type:"overlay"})]}),C.jsxs(Un,{title:"Percelen",defaultExpanded:!1,children:[C.jsx(be,{name:"Gewaspercelen",type:"overlay"}),C.jsx(be,{name:"Kadastrale Grenzen",type:"overlay"})]}),C.jsxs(Un,{title:"Provinciale Kaarten",defaultExpanded:!1,children:[C.jsxs(Un,{title:"Zuid-Holland",defaultExpanded:!1,children:[C.jsx(be,{name:"Scheepswrakken",type:"overlay"}),C.jsx(be,{name:"Woonheuvels ZH",type:"overlay"}),C.jsx(be,{name:"Romeinse Forten",type:"overlay"}),C.jsx(be,{name:"Windmolens",type:"overlay"}),C.jsx(be,{name:"Erfgoedlijnen",type:"overlay"}),C.jsx(be,{name:"Oude Kernen",type:"overlay"})]}),C.jsxs(Un,{title:"Gelderland",defaultExpanded:!1,children:[C.jsx(be,{name:"Relictenkaart Punten",type:"overlay"}),C.jsx(be,{name:"Relictenkaart Lijnen",type:"overlay"}),C.jsx(be,{name:"Relictenkaart Vlakken",type:"overlay"})]}),C.jsx(Un,{title:"Zeeland",defaultExpanded:!1,children:C.jsx(be,{name:"Verdronken Dorpen",type:"overlay"})})]}),C.jsxs(Un,{title:"Fossielen (vondsten)",defaultExpanded:!1,children:[C.jsx(be,{name:"Fossielen Nederland",type:"overlay"}),C.jsx(be,{name:"Fossielen Belgi",type:"overlay"}),C.jsx(be,{name:"Fossielen Duitsland",type:"overlay"}),C.jsx(be,{name:"Fossielen Frankrijk",type:"overlay"})]}),C.jsxs(Un,{title:"Recreatie",defaultExpanded:!1,children:[C.jsx(be,{name:"Parken",type:"overlay"}),C.jsx(be,{name:"Speeltuinen",type:"overlay"}),C.jsx(be,{name:"Musea",type:"overlay"}),C.jsx(be,{name:"Strandjes",type:"overlay"})]})]})]})]})]})})}function aZ(n){n("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),n("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),n("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs");for(var e=1;e<=60;++e)n("EPSG:"+(32600+e),"+proj=utm +zone="+e+" +datum=WGS84 +units=m"),n("EPSG:"+(32700+e),"+proj=utm +zone="+e+" +south +datum=WGS84 +units=m");n("EPSG:5041","+title=WGS 84 / UPS North (E,N) +proj=stere +lat_0=90 +lon_0=0 +k=0.994 +x_0=2000000 +y_0=2000000 +datum=WGS84 +units=m"),n("EPSG:5042","+title=WGS 84 / UPS South (E,N) +proj=stere +lat_0=-90 +lon_0=0 +k=0.994 +x_0=2000000 +y_0=2000000 +datum=WGS84 +units=m"),n.WGS84=n["EPSG:4326"],n["EPSG:3785"]=n["EPSG:3857"],n.GOOGLE=n["EPSG:3857"],n["EPSG:900913"]=n["EPSG:3857"],n["EPSG:102113"]=n["EPSG:3857"]}var Tc=1,Rc=2,hh=3,lZ=4,Xw=5,XM=6378137,cZ=6356752314e-3,QM=.0066943799901413165,Df=484813681109536e-20,he=Math.PI/2,uZ=.16666666666666666,hZ=.04722222222222222,dZ=.022156084656084655,Ee=1e-10,Qt=.017453292519943295,Gi=57.29577951308232,pt=Math.PI/4,Rg=Math.PI*2,an=3.14159265359,Ui={};Ui.greenwich=0;Ui.lisbon=-9.131906111111;Ui.paris=2.337229166667;Ui.bogota=-74.080916666667;Ui.madrid=-3.687938888889;Ui.rome=12.452333333333;Ui.bern=7.439583333333;Ui.jakarta=106.807719444444;Ui.ferro=-17.666666666667;Ui.brussels=4.367975;Ui.stockholm=18.058277777778;Ui.athens=23.7163375;Ui.oslo=10.722916666667;const fZ={mm:{to_meter:.001},cm:{to_meter:.01},ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937},fath:{to_meter:1.8288},kmi:{to_meter:1852},"us-ch":{to_meter:20.1168402336805},"us-mi":{to_meter:1609.34721869444},km:{to_meter:1e3},"ind-ft":{to_meter:.30479841},"ind-yd":{to_meter:.91439523},mi:{to_meter:1609.344},yd:{to_meter:.9144},ch:{to_meter:20.1168},link:{to_meter:.201168},dm:{to_meter:.1},in:{to_meter:.0254},"ind-ch":{to_meter:20.11669506},"us-in":{to_meter:.025400050800101},"us-yd":{to_meter:.914401828803658}};var ZM=/[\s_\-\/\(\)]/g;function Xa(n,e){if(n[e])return n[e];for(var t=Object.keys(n),i=e.toLowerCase().replace(ZM,""),r=-1,s,o;++r<t.length;)if(s=t[r],o=s.toLowerCase().replace(ZM,""),o===i)return n[s]}function Qw(n){var e={},t=n.split("+").map(function(a){return a.trim()}).filter(function(a){return a}).reduce(function(a,c){var h=c.split("=");return h.push(!0),a[h[0].toLowerCase()]=h[1],a},{}),i,r,s,o={proj:"projName",datum:"datumCode",rf:function(a){e.rf=parseFloat(a)},lat_0:function(a){e.lat0=a*Qt},lat_1:function(a){e.lat1=a*Qt},lat_2:function(a){e.lat2=a*Qt},lat_ts:function(a){e.lat_ts=a*Qt},lon_0:function(a){e.long0=a*Qt},lon_1:function(a){e.long1=a*Qt},lon_2:function(a){e.long2=a*Qt},alpha:function(a){e.alpha=parseFloat(a)*Qt},gamma:function(a){e.rectified_grid_angle=parseFloat(a)*Qt},lonc:function(a){e.longc=a*Qt},x_0:function(a){e.x0=parseFloat(a)},y_0:function(a){e.y0=parseFloat(a)},k_0:function(a){e.k0=parseFloat(a)},k:function(a){e.k0=parseFloat(a)},a:function(a){e.a=parseFloat(a)},b:function(a){e.b=parseFloat(a)},r:function(a){e.a=e.b=parseFloat(a)},r_a:function(){e.R_A=!0},zone:function(a){e.zone=parseInt(a,10)},south:function(){e.utmSouth=!0},towgs84:function(a){e.datum_params=a.split(",").map(function(c){return parseFloat(c)})},to_meter:function(a){e.to_meter=parseFloat(a)},units:function(a){e.units=a;var c=Xa(fZ,a);c&&(e.to_meter=c.to_meter)},from_greenwich:function(a){e.from_greenwich=a*Qt},pm:function(a){var c=Xa(Ui,a);e.from_greenwich=(c||parseFloat(a))*Qt},nadgrids:function(a){a==="@null"?e.datumCode="none":e.nadgrids=a},axis:function(a){var c="ewnsud";a.length===3&&c.indexOf(a.substr(0,1))!==-1&&c.indexOf(a.substr(1,1))!==-1&&c.indexOf(a.substr(2,1))!==-1&&(e.axis=a)},approx:function(){e.approx=!0},over:function(){e.over=!0}};for(i in t)r=t[i],i in o?(s=o[i],typeof s=="function"?s(r):e[s]=r):e[i]=r;return typeof e.datumCode=="string"&&e.datumCode!=="WGS84"&&(e.datumCode=e.datumCode.toLowerCase()),e.projStr=n,e}class XD{static getId(e){const t=e.find(i=>Array.isArray(i)&&i[0]==="ID");return t&&t.length>=3?{authority:t[1],code:parseInt(t[2],10)}:null}static convertUnit(e,t="unit"){if(!e||e.length<3)return{type:t,name:"unknown",conversion_factor:null};const i=e[1],r=parseFloat(e[2])||null,s=e.find(a=>Array.isArray(a)&&a[0]==="ID"),o=s?{authority:s[1],code:parseInt(s[2],10)}:null;return{type:t,name:i,conversion_factor:r,id:o}}static convertAxis(e){const t=e[1]||"Unknown";let i;const r=t.match(/^\((.)\)$/);if(r){const h=r[1].toUpperCase();if(h==="E")i="east";else if(h==="N")i="north";else if(h==="U")i="up";else throw new Error(`Unknown axis abbreviation: ${h}`)}else i=e[2]?e[2].toLowerCase():"unknown";const s=e.find(h=>Array.isArray(h)&&h[0]==="ORDER"),o=s?parseInt(s[1],10):null,a=e.find(h=>Array.isArray(h)&&(h[0]==="LENGTHUNIT"||h[0]==="ANGLEUNIT"||h[0]==="SCALEUNIT")),c=this.convertUnit(a);return{name:t,direction:i,unit:c,order:o}}static extractAxes(e){return e.filter(t=>Array.isArray(t)&&t[0]==="AXIS").map(t=>this.convertAxis(t)).sort((t,i)=>(t.order||0)-(i.order||0))}static convert(e,t={}){switch(e[0]){case"PROJCRS":t.type="ProjectedCRS",t.name=e[1],t.base_crs=e.find(m=>Array.isArray(m)&&m[0]==="BASEGEOGCRS")?this.convert(e.find(m=>Array.isArray(m)&&m[0]==="BASEGEOGCRS")):null,t.conversion=e.find(m=>Array.isArray(m)&&m[0]==="CONVERSION")?this.convert(e.find(m=>Array.isArray(m)&&m[0]==="CONVERSION")):null;const i=e.find(m=>Array.isArray(m)&&m[0]==="CS");i&&(t.coordinate_system={type:i[1],axis:this.extractAxes(e)});const r=e.find(m=>Array.isArray(m)&&m[0]==="LENGTHUNIT");if(r){const m=this.convertUnit(r);t.coordinate_system.unit=m}t.id=this.getId(e);break;case"BASEGEOGCRS":case"GEOGCRS":t.type="GeographicCRS",t.name=e[1];const s=e.find(m=>Array.isArray(m)&&(m[0]==="DATUM"||m[0]==="ENSEMBLE"));if(s){const m=this.convert(s);s[0]==="ENSEMBLE"?t.datum_ensemble=m:t.datum=m;const y=e.find(w=>Array.isArray(w)&&w[0]==="PRIMEM");y&&y[1]!=="Greenwich"&&(m.prime_meridian={name:y[1],longitude:parseFloat(y[2])})}t.coordinate_system={type:"ellipsoidal",axis:this.extractAxes(e)},t.id=this.getId(e);break;case"DATUM":t.type="GeodeticReferenceFrame",t.name=e[1],t.ellipsoid=e.find(m=>Array.isArray(m)&&m[0]==="ELLIPSOID")?this.convert(e.find(m=>Array.isArray(m)&&m[0]==="ELLIPSOID")):null;break;case"ENSEMBLE":t.type="DatumEnsemble",t.name=e[1],t.members=e.filter(m=>Array.isArray(m)&&m[0]==="MEMBER").map(m=>({type:"DatumEnsembleMember",name:m[1],id:this.getId(m)}));const o=e.find(m=>Array.isArray(m)&&m[0]==="ENSEMBLEACCURACY");o&&(t.accuracy=parseFloat(o[1]));const a=e.find(m=>Array.isArray(m)&&m[0]==="ELLIPSOID");a&&(t.ellipsoid=this.convert(a)),t.id=this.getId(e);break;case"ELLIPSOID":t.type="Ellipsoid",t.name=e[1],t.semi_major_axis=parseFloat(e[2]),t.inverse_flattening=parseFloat(e[3]),e.find(m=>Array.isArray(m)&&m[0]==="LENGTHUNIT")&&this.convert(e.find(m=>Array.isArray(m)&&m[0]==="LENGTHUNIT"),t);break;case"CONVERSION":t.type="Conversion",t.name=e[1],t.method=e.find(m=>Array.isArray(m)&&m[0]==="METHOD")?this.convert(e.find(m=>Array.isArray(m)&&m[0]==="METHOD")):null,t.parameters=e.filter(m=>Array.isArray(m)&&m[0]==="PARAMETER").map(m=>this.convert(m));break;case"METHOD":t.type="Method",t.name=e[1],t.id=this.getId(e);break;case"PARAMETER":t.type="Parameter",t.name=e[1],t.value=parseFloat(e[2]),t.unit=this.convertUnit(e.find(m=>Array.isArray(m)&&(m[0]==="LENGTHUNIT"||m[0]==="ANGLEUNIT"||m[0]==="SCALEUNIT"))),t.id=this.getId(e);break;case"BOUNDCRS":t.type="BoundCRS";const c=e.find(m=>Array.isArray(m)&&m[0]==="SOURCECRS");if(c){const m=c.find(y=>Array.isArray(y));t.source_crs=m?this.convert(m):null}const h=e.find(m=>Array.isArray(m)&&m[0]==="TARGETCRS");if(h){const m=h.find(y=>Array.isArray(y));t.target_crs=m?this.convert(m):null}const d=e.find(m=>Array.isArray(m)&&m[0]==="ABRIDGEDTRANSFORMATION");d?t.transformation=this.convert(d):t.transformation=null;break;case"ABRIDGEDTRANSFORMATION":if(t.type="Transformation",t.name=e[1],t.method=e.find(m=>Array.isArray(m)&&m[0]==="METHOD")?this.convert(e.find(m=>Array.isArray(m)&&m[0]==="METHOD")):null,t.parameters=e.filter(m=>Array.isArray(m)&&(m[0]==="PARAMETER"||m[0]==="PARAMETERFILE")).map(m=>{if(m[0]==="PARAMETER")return this.convert(m);if(m[0]==="PARAMETERFILE")return{name:m[1],value:m[2],id:{authority:"EPSG",code:8656}}}),t.parameters.length===7){const m=t.parameters[6];m.name==="Scale difference"&&(m.value=Math.round((m.value-1)*1e12)/1e6)}t.id=this.getId(e);break;case"AXIS":t.coordinate_system||(t.coordinate_system={type:"unspecified",axis:[]}),t.coordinate_system.axis.push(this.convertAxis(e));break;case"LENGTHUNIT":const g=this.convertUnit(e,"LinearUnit");t.coordinate_system&&t.coordinate_system.axis&&t.coordinate_system.axis.forEach(m=>{m.unit||(m.unit=g)}),g.conversion_factor&&g.conversion_factor!==1&&t.semi_major_axis&&(t.semi_major_axis={value:t.semi_major_axis,unit:g});break;default:t.keyword=e[0];break}return t}}class gZ extends XD{static convert(e,t={}){return super.convert(e,t),t.coordinate_system&&t.coordinate_system.subtype==="Cartesian"&&delete t.coordinate_system,t.usage&&delete t.usage,t}}class mZ extends XD{static convert(e,t={}){super.convert(e,t);const i=e.find(s=>Array.isArray(s)&&s[0]==="CS");i&&(t.coordinate_system={subtype:i[1],axis:this.extractAxes(e)});const r=e.find(s=>Array.isArray(s)&&s[0]==="USAGE");if(r){const s=r.find(c=>Array.isArray(c)&&c[0]==="SCOPE"),o=r.find(c=>Array.isArray(c)&&c[0]==="AREA"),a=r.find(c=>Array.isArray(c)&&c[0]==="BBOX");t.usage={},s&&(t.usage.scope=s[1]),o&&(t.usage.area=o[1]),a&&(t.usage.bbox=a.slice(1))}return t}}function pZ(n){return n.find(e=>Array.isArray(e)&&e[0]==="USAGE")?"2019":(n.find(e=>Array.isArray(e)&&e[0]==="CS")||n[0]==="BOUNDCRS"||n[0]==="PROJCRS"||n[0]==="GEOGCRS","2015")}function _Z(n){return(pZ(n)==="2019"?mZ:gZ).convert(n)}function yZ(n){const e=n.toUpperCase();return e.includes("PROJCRS")||e.includes("GEOGCRS")||e.includes("BOUNDCRS")||e.includes("VERTCRS")||e.includes("LENGTHUNIT")||e.includes("ANGLEUNIT")||e.includes("SCALEUNIT")?"WKT2":(e.includes("PROJCS")||e.includes("GEOGCS")||e.includes("LOCAL_CS")||e.includes("VERT_CS")||e.includes("UNIT"),"WKT1")}var Pg=1,QD=2,ZD=3,P_=4,JD=5,OI=-1,vZ=/\s/,EZ=/[A-Za-z]/,wZ=/[A-Za-z84_]/,Vy=/[,\]]/,e3=/[\d\.E\-\+]/;function No(n){if(typeof n!="string")throw new Error("not a string");this.text=n.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=Pg}No.prototype.readCharicter=function(){var n=this.text[this.place++];if(this.state!==P_)for(;vZ.test(n);){if(this.place>=this.text.length)return;n=this.text[this.place++]}switch(this.state){case Pg:return this.neutral(n);case QD:return this.keyword(n);case P_:return this.quoted(n);case JD:return this.afterquote(n);case ZD:return this.number(n);case OI:return}};No.prototype.afterquote=function(n){if(n==='"'){this.word+='"',this.state=P_;return}if(Vy.test(n)){this.word=this.word.trim(),this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in afterquote yet, index '+this.place)};No.prototype.afterItem=function(n){if(n===","){this.word!==null&&this.currentObject.push(this.word),this.word=null,this.state=Pg;return}if(n==="]"){this.level--,this.word!==null&&(this.currentObject.push(this.word),this.word=null),this.state=Pg,this.currentObject=this.stack.pop(),this.currentObject||(this.state=OI);return}};No.prototype.number=function(n){if(e3.test(n)){this.word+=n;return}if(Vy.test(n)){this.word=parseFloat(this.word),this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in number yet, index '+this.place)};No.prototype.quoted=function(n){if(n==='"'){this.state=JD;return}this.word+=n};No.prototype.keyword=function(n){if(wZ.test(n)){this.word+=n;return}if(n==="["){var e=[];e.push(this.word),this.level++,this.root===null?this.root=e:this.currentObject.push(e),this.stack.push(this.currentObject),this.currentObject=e,this.state=Pg;return}if(Vy.test(n)){this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in keyword yet, index '+this.place)};No.prototype.neutral=function(n){if(EZ.test(n)){this.word=n,this.state=QD;return}if(n==='"'){this.word="",this.state=P_;return}if(e3.test(n)){this.word=n,this.state=ZD;return}if(Vy.test(n)){this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in neutral yet, index '+this.place)};No.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(this.state===OI)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};function xZ(n){var e=new No(n);return e.output()}function yE(n,e,t){Array.isArray(e)&&(t.unshift(e),e=null);var i=e?{}:n,r=t.reduce(function(s,o){return Zu(o,s),s},i);e&&(n[e]=r)}function Zu(n,e){if(!Array.isArray(n)){e[n]=!0;return}var t=n.shift();if(t==="PARAMETER"&&(t=n.shift()),n.length===1){if(Array.isArray(n[0])){e[t]={},Zu(n[0],e[t]);return}e[t]=n[0];return}if(!n.length){e[t]=!0;return}if(t==="TOWGS84"){e[t]=n;return}if(t==="AXIS"){t in e||(e[t]=[]),e[t].push(n);return}Array.isArray(t)||(e[t]={});var i;switch(t){case"UNIT":case"PRIMEM":case"VERT_DATUM":e[t]={name:n[0].toLowerCase(),convert:n[1]},n.length===3&&Zu(n[2],e[t]);return;case"SPHEROID":case"ELLIPSOID":e[t]={name:n[0],a:n[1],rf:n[2]},n.length===4&&Zu(n[3],e[t]);return;case"EDATUM":case"ENGINEERINGDATUM":case"LOCAL_DATUM":case"DATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":n[0]=["name",n[0]],yE(e,t,n);return;case"COMPD_CS":case"COMPOUNDCRS":case"FITTED_CS":case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"ENGCRS":case"ENGINEERINGCRS":n[0]=["name",n[0]],yE(e,t,n),e[t].type=t;return;default:for(i=-1;++i<n.length;)if(!Array.isArray(n[i]))return Zu(n,e[t]);return yE(e,t,n)}}var SZ=.017453292519943295;function Wr(n){return n*SZ}function t3(n){const e=(n.projName||"").toLowerCase().replace(/_/g," ");!n.long0&&n.longc&&(e==="albers conic equal area"||e==="lambert azimuthal equal area")&&(n.long0=n.longc),!n.lat_ts&&n.lat1&&(e==="stereographic south pole"||e==="polar stereographic (variant b)")?(n.lat0=Wr(n.lat1>0?90:-90),n.lat_ts=n.lat1,delete n.lat1):!n.lat_ts&&n.lat0&&(e==="polar stereographic"||e==="polar stereographic (variant a)")&&(n.lat_ts=n.lat0,n.lat0=Wr(n.lat0>0?90:-90),delete n.lat1)}function JM(n){let e={units:null,to_meter:void 0};return typeof n=="string"?(e.units=n.toLowerCase(),e.units==="metre"&&(e.units="meter"),e.units==="meter"&&(e.to_meter=1)):n&&n.name&&(e.units=n.name.toLowerCase(),e.units==="metre"&&(e.units="meter"),e.to_meter=n.conversion_factor),e}function eb(n){return typeof n=="object"?n.value*n.unit.conversion_factor:n}function tb(n,e){n.ellipsoid.radius?(e.a=n.ellipsoid.radius,e.rf=0):(e.a=eb(n.ellipsoid.semi_major_axis),n.ellipsoid.inverse_flattening!==void 0?e.rf=n.ellipsoid.inverse_flattening:n.ellipsoid.semi_major_axis!==void 0&&n.ellipsoid.semi_minor_axis!==void 0&&(e.rf=e.a/(e.a-eb(n.ellipsoid.semi_minor_axis))))}function A_(n,e={}){return!n||typeof n!="object"?n:n.type==="BoundCRS"?(A_(n.source_crs,e),n.transformation&&(n.transformation.method&&n.transformation.method.name==="NTv2"?e.nadgrids=n.transformation.parameters[0].value:e.datum_params=n.transformation.parameters.map(t=>t.value)),e):(Object.keys(n).forEach(t=>{const i=n[t];if(i!==null)switch(t){case"name":if(e.srsCode)break;e.name=i,e.srsCode=i;break;case"type":i==="GeographicCRS"?e.projName="longlat":i==="ProjectedCRS"&&n.conversion&&n.conversion.method&&(e.projName=n.conversion.method.name);break;case"datum":case"datum_ensemble":i.ellipsoid&&(e.ellps=i.ellipsoid.name,tb(i,e)),i.prime_meridian&&(e.from_greenwich=i.prime_meridian.longitude*Math.PI/180);break;case"ellipsoid":e.ellps=i.name,tb(i,e);break;case"prime_meridian":e.long0=(i.longitude||0)*Math.PI/180;break;case"coordinate_system":if(i.axis){if(e.axis=i.axis.map(r=>{const s=r.direction;if(s==="east")return"e";if(s==="north")return"n";if(s==="west")return"w";if(s==="south")return"s";throw new Error(`Unknown axis direction: ${s}`)}).join("")+"u",i.unit){const{units:r,to_meter:s}=JM(i.unit);e.units=r,e.to_meter=s}else if(i.axis[0]&&i.axis[0].unit){const{units:r,to_meter:s}=JM(i.axis[0].unit);e.units=r,e.to_meter=s}}break;case"id":i.authority&&i.code&&(e.title=i.authority+":"+i.code);break;case"conversion":i.method&&i.method.name&&(e.projName=i.method.name),i.parameters&&i.parameters.forEach(r=>{const s=r.name.toLowerCase().replace(/\s+/g,"_"),o=r.value;r.unit&&r.unit.conversion_factor?e[s]=o*r.unit.conversion_factor:r.unit==="degree"?e[s]=o*Math.PI/180:e[s]=o});break;case"unit":i.name&&(e.units=i.name.toLowerCase(),e.units==="metre"&&(e.units="meter")),i.conversion_factor&&(e.to_meter=i.conversion_factor);break;case"base_crs":A_(i,e),e.datumCode=i.id?i.id.authority+"_"+i.id.code:i.name;break}}),e.latitude_of_false_origin!==void 0&&(e.lat0=e.latitude_of_false_origin),e.longitude_of_false_origin!==void 0&&(e.long0=e.longitude_of_false_origin),e.latitude_of_standard_parallel!==void 0&&(e.lat0=e.latitude_of_standard_parallel,e.lat1=e.latitude_of_standard_parallel),e.latitude_of_1st_standard_parallel!==void 0&&(e.lat1=e.latitude_of_1st_standard_parallel),e.latitude_of_2nd_standard_parallel!==void 0&&(e.lat2=e.latitude_of_2nd_standard_parallel),e.latitude_of_projection_centre!==void 0&&(e.lat0=e.latitude_of_projection_centre),e.longitude_of_projection_centre!==void 0&&(e.longc=e.longitude_of_projection_centre),e.easting_at_false_origin!==void 0&&(e.x0=e.easting_at_false_origin),e.northing_at_false_origin!==void 0&&(e.y0=e.northing_at_false_origin),e.latitude_of_natural_origin!==void 0&&(e.lat0=e.latitude_of_natural_origin),e.longitude_of_natural_origin!==void 0&&(e.long0=e.longitude_of_natural_origin),e.longitude_of_origin!==void 0&&(e.long0=e.longitude_of_origin),e.false_easting!==void 0&&(e.x0=e.false_easting),e.easting_at_projection_centre&&(e.x0=e.easting_at_projection_centre),e.false_northing!==void 0&&(e.y0=e.false_northing),e.northing_at_projection_centre&&(e.y0=e.northing_at_projection_centre),e.standard_parallel_1!==void 0&&(e.lat1=e.standard_parallel_1),e.standard_parallel_2!==void 0&&(e.lat2=e.standard_parallel_2),e.scale_factor_at_natural_origin!==void 0&&(e.k0=e.scale_factor_at_natural_origin),e.scale_factor_at_projection_centre!==void 0&&(e.k0=e.scale_factor_at_projection_centre),e.scale_factor_on_pseudo_standard_parallel!==void 0&&(e.k0=e.scale_factor_on_pseudo_standard_parallel),e.azimuth!==void 0&&(e.alpha=e.azimuth),e.azimuth_at_projection_centre!==void 0&&(e.alpha=e.azimuth_at_projection_centre),e.angle_from_rectified_to_skew_grid&&(e.rectified_grid_angle=e.angle_from_rectified_to_skew_grid),t3(e),e)}var IZ=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function TZ(n,e){var t=e[0],i=e[1];!(t in n)&&i in n&&(n[t]=n[i],e.length===3&&(n[t]=e[2](n[t])))}function n3(n){for(var e=Object.keys(n),t=0,i=e.length;t<i;++t){var r=e[t];IZ.indexOf(r)!==-1&&RZ(n[r]),typeof n[r]=="object"&&n3(n[r])}}function RZ(n){if(n.AUTHORITY){var e=Object.keys(n.AUTHORITY)[0];e&&e in n.AUTHORITY&&(n.title=e+":"+n.AUTHORITY[e])}if(n.type==="GEOGCS"?n.projName="longlat":n.type==="LOCAL_CS"?(n.projName="identity",n.local=!0):typeof n.PROJECTION=="object"?n.projName=Object.keys(n.PROJECTION)[0]:n.projName=n.PROJECTION,n.AXIS){for(var t="",i=0,r=n.AXIS.length;i<r;++i){var s=[n.AXIS[i][0].toLowerCase(),n.AXIS[i][1].toLowerCase()];s[0].indexOf("north")!==-1||(s[0]==="y"||s[0]==="lat")&&s[1]==="north"?t+="n":s[0].indexOf("south")!==-1||(s[0]==="y"||s[0]==="lat")&&s[1]==="south"?t+="s":s[0].indexOf("east")!==-1||(s[0]==="x"||s[0]==="lon")&&s[1]==="east"?t+="e":(s[0].indexOf("west")!==-1||(s[0]==="x"||s[0]==="lon")&&s[1]==="west")&&(t+="w")}t.length===2&&(t+="u"),t.length===3&&(n.axis=t)}n.UNIT&&(n.units=n.UNIT.name.toLowerCase(),n.units==="metre"&&(n.units="meter"),n.UNIT.convert&&(n.type==="GEOGCS"?n.DATUM&&n.DATUM.SPHEROID&&(n.to_meter=n.UNIT.convert*n.DATUM.SPHEROID.a):n.to_meter=n.UNIT.convert));var o=n.GEOGCS;n.type==="GEOGCS"&&(o=n),o&&(o.DATUM?n.datumCode=o.DATUM.name.toLowerCase():n.datumCode=o.name.toLowerCase(),n.datumCode.slice(0,2)==="d_"&&(n.datumCode=n.datumCode.slice(2)),n.datumCode==="new_zealand_1949"&&(n.datumCode="nzgd49"),(n.datumCode==="wgs_1984"||n.datumCode==="world_geodetic_system_1984")&&(n.PROJECTION==="Mercator_Auxiliary_Sphere"&&(n.sphere=!0),n.datumCode="wgs84"),n.datumCode==="belge_1972"&&(n.datumCode="rnb72"),o.DATUM&&o.DATUM.SPHEROID&&(n.ellps=o.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),n.ellps.toLowerCase().slice(0,13)==="international"&&(n.ellps="intl"),n.a=o.DATUM.SPHEROID.a,n.rf=parseFloat(o.DATUM.SPHEROID.rf,10)),o.DATUM&&o.DATUM.TOWGS84&&(n.datum_params=o.DATUM.TOWGS84),~n.datumCode.indexOf("osgb_1936")&&(n.datumCode="osgb36"),~n.datumCode.indexOf("osni_1952")&&(n.datumCode="osni52"),(~n.datumCode.indexOf("tm65")||~n.datumCode.indexOf("geodetic_datum_of_1965"))&&(n.datumCode="ire65"),n.datumCode==="ch1903+"&&(n.datumCode="ch1903"),~n.datumCode.indexOf("israel")&&(n.datumCode="isr93")),n.b&&!isFinite(n.b)&&(n.b=n.a),n.rectified_grid_angle&&(n.rectified_grid_angle=Wr(n.rectified_grid_angle));function a(d){var g=n.to_meter||1;return d*g}var c=function(d){return TZ(n,d)},h=[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",Wr],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",Wr],["x0","false_easting",a],["y0","false_northing",a],["long0","central_meridian",Wr],["lat0","latitude_of_origin",Wr],["lat0","standard_parallel_1",Wr],["lat1","standard_parallel_1",Wr],["lat2","standard_parallel_2",Wr],["azimuth","Azimuth"],["alpha","azimuth",Wr],["srsCode","name"]];h.forEach(c),t3(n)}function C_(n){if(typeof n=="object")return A_(n);const e=yZ(n);var t=xZ(n);if(e==="WKT2"){const s=_Z(t);return A_(s)}var i=t[0],r={};return Zu(t,r),n3(r),r[i]}function Bn(n){var e=this;if(arguments.length===2){var t=arguments[1];typeof t=="string"?t.charAt(0)==="+"?Bn[n]=Qw(arguments[1]):Bn[n]=C_(arguments[1]):t&&typeof t=="object"&&!("projName"in t)?Bn[n]=C_(arguments[1]):(Bn[n]=t,t||delete Bn[n])}else if(arguments.length===1){if(Array.isArray(n))return n.map(function(i){return Array.isArray(i)?Bn.apply(e,i):Bn(i)});if(typeof n=="string"){if(n in Bn)return Bn[n]}else"EPSG"in n?Bn["EPSG:"+n.EPSG]=n:"ESRI"in n?Bn["ESRI:"+n.ESRI]=n:"IAU2000"in n?Bn["IAU2000:"+n.IAU2000]=n:console.log(n);return}}aZ(Bn);function PZ(n){return typeof n=="string"}function AZ(n){return n in Bn}function CZ(n){return n.indexOf("+")!==0&&n.indexOf("[")!==-1||typeof n=="object"&&!("srsCode"in n)}var MZ=["3857","900913","3785","102113"];function bZ(n){var e=Xa(n,"authority");if(e){var t=Xa(e,"epsg");return t&&MZ.indexOf(t)>-1}}function kZ(n){var e=Xa(n,"extension");if(e)return Xa(e,"proj4")}function LZ(n){return n[0]==="+"}function NZ(n){if(PZ(n)){if(AZ(n))return Bn[n];if(CZ(n)){var e=C_(n);if(bZ(e))return Bn["EPSG:3857"];var t=kZ(e);return t?Qw(t):e}if(LZ(n))return Qw(n)}else return"projName"in n?n:C_(n)}function nb(n,e){n=n||{};var t,i;if(!e)return n;for(i in e)t=e[i],t!==void 0&&(n[i]=t);return n}function Gs(n,e,t){var i=n*e;return t/Math.sqrt(1-i*i)}function um(n){return n<0?-1:1}function Ie(n,e){return e||Math.abs(n)<=an?n:n-um(n)*Rg}function Jr(n,e,t){var i=n*t,r=.5*n;return i=Math.pow((1-i)/(1+i),r),Math.tan(.5*(he-e))/i}function Ag(n,e){for(var t=.5*n,i,r,s=he-2*Math.atan(e),o=0;o<=15;o++)if(i=n*Math.sin(s),r=he-2*Math.atan(e*Math.pow((1-i)/(1+i),t))-s,s+=r,Math.abs(r)<=1e-10)return s;return-9999}function OZ(){var n=this.b/this.a;this.es=1-n*n,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=Gs(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)}function DZ(n){var e=n.x,t=n.y;if(t*Gi>90&&t*Gi<-90&&e*Gi>180&&e*Gi<-180)return null;var i,r;if(Math.abs(Math.abs(t)-he)<=Ee)return null;if(this.sphere)i=this.x0+this.a*this.k0*Ie(e-this.long0,this.over),r=this.y0+this.a*this.k0*Math.log(Math.tan(pt+.5*t));else{var s=Math.sin(t),o=Jr(this.e,t,s);i=this.x0+this.a*this.k0*Ie(e-this.long0,this.over),r=this.y0-this.a*this.k0*Math.log(o)}return n.x=i,n.y=r,n}function VZ(n){var e=n.x-this.x0,t=n.y-this.y0,i,r;if(this.sphere)r=he-2*Math.atan(Math.exp(-t/(this.a*this.k0)));else{var s=Math.exp(-t/(this.a*this.k0));if(r=Ag(this.e,s),r===-9999)return null}return i=Ie(this.long0+e/(this.a*this.k0),this.over),n.x=i,n.y=r,n}var FZ=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","Mercator_Variant_A","merc"];const GZ={init:OZ,forward:DZ,inverse:VZ,names:FZ};function jZ(){}function ib(n){return n}var i3=["longlat","identity"];const UZ={init:jZ,forward:ib,inverse:ib,names:i3};var BZ=[GZ,UZ],jl={},Ju=[];function r3(n,e){var t=Ju.length;return n.names?(Ju[t]=n,n.names.forEach(function(i){jl[i.toLowerCase()]=t}),this):(console.log(e),!0)}function s3(n){return n.replace(/[-\(\)\s]+/g," ").trim().replace(/ /g,"_")}function zZ(n){if(!n)return!1;var e=n.toLowerCase();if(typeof jl[e]<"u"&&Ju[jl[e]]||(e=s3(e),e in jl&&Ju[jl[e]]))return Ju[jl[e]]}function $Z(){BZ.forEach(r3)}const WZ={start:$Z,add:r3,get:zZ};var o3={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563396e-3,b:635625691e-2,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340189e-3,b:6356034446e-3,ellipseName:"Modified Airy"},andrae:{a:637710443e-2,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397155e-3,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483865e-3,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:63782064e-1,b:63565838e-1,ellipseName:"Clarke 1866"},clrk80:{a:6378249145e-3,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk80ign:{a:63782492e-1,b:6356515,rf:293.4660213,ellipseName:"Clarke 1880 (IGN)"},clrk58:{a:6378293645208759e-9,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:63757387e-1,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:637813605e-2,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276345e-3,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304063e-3,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301243e-3,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295664e-3,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298556e-3,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:63781575e-1,b:63567722e-1,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:63567733205e-4,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:63558348467e-4,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"},WGS84:{a:6378137,rf:298.257223563,ellipseName:"WGS 84"},sphere:{a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"}};const HZ=o3.WGS84;function KZ(n,e,t,i){var r=n*n,s=e*e,o=(r-s)/r,a=0;i?(n*=1-o*(uZ+o*(hZ+o*dZ)),r=n*n,o=0):a=Math.sqrt(o);var c=(r-s)/s;return{es:o,e:a,ep2:c}}function qZ(n,e,t,i,r){if(!n){var s=Xa(o3,i);s||(s=HZ),n=s.a,e=s.b,t=s.rf}return t&&!e&&(e=(1-1/t)*n),(t===0||Math.abs(n-e)<Ee)&&(r=!0,e=n),{a:n,b:e,rf:t,sphere:r}}var w0={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},mgi:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Militar-Geographische Institut"},osni52:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Ordnance Survey of Great Britain 1936"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"},EPSG_5451:{towgs84:"6.41,-49.05,-11.28,1.5657,0.5242,6.9718,-5.7649"},IGNF_LURESG:{towgs84:"-192.986,13.673,-39.309,-0.4099,-2.9332,2.6881,0.43"},EPSG_4614:{towgs84:"-119.4248,-303.65872,-11.00061,1.164298,0.174458,1.096259,3.657065"},EPSG_4615:{towgs84:"-494.088,-312.129,279.877,-1.423,-1.013,1.59,-0.748"},ESRI_37241:{towgs84:"-76.822,257.457,-12.817,2.136,-0.033,-2.392,-0.031"},ESRI_37249:{towgs84:"-440.296,58.548,296.265,1.128,10.202,4.559,-0.438"},ESRI_37245:{towgs84:"-511.151,-181.269,139.609,1.05,2.703,1.798,3.071"},EPSG_4178:{towgs84:"24.9,-126.4,-93.2,-0.063,-0.247,-0.041,1.01"},EPSG_4622:{towgs84:"-472.29,-5.63,-304.12,0.4362,-0.8374,0.2563,1.8984"},EPSG_4625:{towgs84:"126.93,547.94,130.41,-2.7867,5.1612,-0.8584,13.8227"},EPSG_5252:{towgs84:"0.023,0.036,-0.068,0.00176,0.00912,-0.01136,0.00439"},EPSG_4314:{towgs84:"597.1,71.4,412.1,0.894,0.068,-1.563,7.58"},EPSG_4282:{towgs84:"-178.3,-316.7,-131.5,5.278,6.077,10.979,19.166"},EPSG_4231:{towgs84:"-83.11,-97.38,-117.22,0.0276,-0.2167,0.2147,0.1218"},EPSG_4274:{towgs84:"-230.994,102.591,25.199,0.633,-0.239,0.9,1.95"},EPSG_4134:{towgs84:"-180.624,-225.516,173.919,-0.81,-1.898,8.336,16.71006"},EPSG_4254:{towgs84:"18.38,192.45,96.82,0.056,-0.142,-0.2,-0.0013"},EPSG_4159:{towgs84:"-194.513,-63.978,-25.759,-3.4027,3.756,-3.352,-0.9175"},EPSG_4687:{towgs84:"0.072,-0.507,-0.245,0.0183,-0.0003,0.007,-0.0093"},EPSG_4227:{towgs84:"-83.58,-397.54,458.78,-17.595,-2.847,4.256,3.225"},EPSG_4746:{towgs84:"599.4,72.4,419.2,-0.062,-0.022,-2.723,6.46"},EPSG_4745:{towgs84:"612.4,77,440.2,-0.054,0.057,-2.797,2.55"},EPSG_6311:{towgs84:"8.846,-4.394,-1.122,-0.00237,-0.146528,0.130428,0.783926"},EPSG_4289:{towgs84:"565.7381,50.4018,465.2904,-1.91514,1.60363,-9.09546,4.07244"},EPSG_4230:{towgs84:"-68.863,-134.888,-111.49,-0.53,-0.14,0.57,-3.4"},EPSG_4154:{towgs84:"-123.02,-158.95,-168.47"},EPSG_4156:{towgs84:"570.8,85.7,462.8,4.998,1.587,5.261,3.56"},EPSG_4299:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4179:{towgs84:"33.4,-146.6,-76.3,-0.359,-0.053,0.844,-0.84"},EPSG_4313:{towgs84:"-106.8686,52.2978,-103.7239,0.3366,-0.457,1.8422,-1.2747"},EPSG_4194:{towgs84:"163.511,127.533,-159.789"},EPSG_4195:{towgs84:"105,326,-102.5"},EPSG_4196:{towgs84:"-45,417,-3.5"},EPSG_4611:{towgs84:"-162.619,-276.959,-161.764,0.067753,-2.243649,-1.158827,-1.094246"},EPSG_4633:{towgs84:"137.092,131.66,91.475,-1.9436,-11.5993,-4.3321,-7.4824"},EPSG_4641:{towgs84:"-408.809,366.856,-412.987,1.8842,-0.5308,2.1655,-121.0993"},EPSG_4643:{towgs84:"-480.26,-438.32,-643.429,16.3119,20.1721,-4.0349,-111.7002"},EPSG_4300:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4188:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4660:{towgs84:"982.6087,552.753,-540.873,32.39344,-153.25684,-96.2266,16.805"},EPSG_4662:{towgs84:"97.295,-263.247,310.882,-1.5999,0.8386,3.1409,13.3259"},EPSG_3906:{towgs84:"577.88891,165.22205,391.18289,4.9145,-0.94729,-13.05098,7.78664"},EPSG_4307:{towgs84:"-209.3622,-87.8162,404.6198,0.0046,3.4784,0.5805,-1.4547"},EPSG_6892:{towgs84:"-76.269,-16.683,68.562,-6.275,10.536,-4.286,-13.686"},EPSG_4690:{towgs84:"221.597,152.441,176.523,2.403,1.3893,0.884,11.4648"},EPSG_4691:{towgs84:"218.769,150.75,176.75,3.5231,2.0037,1.288,10.9817"},EPSG_4629:{towgs84:"72.51,345.411,79.241,-1.5862,-0.8826,-0.5495,1.3653"},EPSG_4630:{towgs84:"165.804,216.213,180.26,-0.6251,-0.4515,-0.0721,7.4111"},EPSG_4692:{towgs84:"217.109,86.452,23.711,0.0183,-0.0003,0.007,-0.0093"},EPSG_9333:{towgs84:"0,0,0,-8.393,0.749,-10.276,0"},EPSG_9059:{towgs84:"0,0,0"},EPSG_4312:{towgs84:"601.705,84.263,485.227,4.7354,1.3145,5.393,-2.3887"},EPSG_4123:{towgs84:"-96.062,-82.428,-121.753,4.801,0.345,-1.376,1.496"},EPSG_4309:{towgs84:"-124.45,183.74,44.64,-0.4384,0.5446,-0.9706,-2.1365"},ESRI_104106:{towgs84:"-283.088,-70.693,117.445,-1.157,0.059,-0.652,-4.058"},EPSG_4281:{towgs84:"-219.247,-73.802,269.529"},EPSG_4322:{towgs84:"0,0,4.5"},EPSG_4324:{towgs84:"0,0,1.9"},EPSG_4284:{towgs84:"43.822,-108.842,-119.585,1.455,-0.761,0.737,0.549"},EPSG_4277:{towgs84:"446.448,-125.157,542.06,0.15,0.247,0.842,-20.489"},EPSG_4207:{towgs84:"-282.1,-72.2,120,-1.529,0.145,-0.89,-4.46"},EPSG_4688:{towgs84:"347.175,1077.618,2623.677,33.9058,-70.6776,9.4013,186.0647"},EPSG_4689:{towgs84:"410.793,54.542,80.501,-2.5596,-2.3517,-0.6594,17.3218"},EPSG_4720:{towgs84:"0,0,4.5"},EPSG_4273:{towgs84:"278.3,93,474.5,7.889,0.05,-6.61,6.21"},EPSG_4240:{towgs84:"204.64,834.74,293.8"},EPSG_4817:{towgs84:"278.3,93,474.5,7.889,0.05,-6.61,6.21"},ESRI_104131:{towgs84:"426.62,142.62,460.09,4.98,4.49,-12.42,-17.1"},EPSG_4265:{towgs84:"-104.1,-49.1,-9.9,0.971,-2.917,0.714,-11.68"},EPSG_4263:{towgs84:"-111.92,-87.85,114.5,1.875,0.202,0.219,0.032"},EPSG_4298:{towgs84:"-689.5937,623.84046,-65.93566,-0.02331,1.17094,-0.80054,5.88536"},EPSG_4270:{towgs84:"-253.4392,-148.452,386.5267,0.15605,0.43,-0.1013,-0.0424"},EPSG_4229:{towgs84:"-121.8,98.1,-10.7"},EPSG_4220:{towgs84:"-55.5,-348,-229.2"},EPSG_4214:{towgs84:"12.646,-155.176,-80.863"},EPSG_4232:{towgs84:"-345,3,223"},EPSG_4238:{towgs84:"-1.977,-13.06,-9.993,0.364,0.254,0.689,-1.037"},EPSG_4168:{towgs84:"-170,33,326"},EPSG_4131:{towgs84:"199,931,318.9"},EPSG_4152:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_5228:{towgs84:"572.213,85.334,461.94,4.9732,1.529,5.2484,3.5378"},EPSG_8351:{towgs84:"485.021,169.465,483.839,7.786342,4.397554,4.102655,0"},EPSG_4683:{towgs84:"-127.62,-67.24,-47.04,-3.068,4.903,1.578,-1.06"},EPSG_4133:{towgs84:"0,0,0"},EPSG_7373:{towgs84:"0.819,-0.5762,-1.6446,-0.00378,-0.03317,0.00318,0.0693"},EPSG_9075:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_9072:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_9294:{towgs84:"1.16835,-1.42001,-2.24431,-0.00822,-0.05508,0.01818,0.23388"},EPSG_4212:{towgs84:"-267.434,173.496,181.814,-13.4704,8.7154,7.3926,14.7492"},EPSG_4191:{towgs84:"-44.183,-0.58,-38.489,2.3867,2.7072,-3.5196,-8.2703"},EPSG_4237:{towgs84:"52.684,-71.194,-13.975,-0.312,-0.1063,-0.3729,1.0191"},EPSG_4740:{towgs84:"-1.08,-0.27,-0.9"},EPSG_4124:{towgs84:"419.3836,99.3335,591.3451,0.850389,1.817277,-7.862238,-0.99496"},EPSG_5681:{towgs84:"584.9636,107.7175,413.8067,1.1155,0.2824,-3.1384,7.9922"},EPSG_4141:{towgs84:"23.772,17.49,17.859,-0.3132,-1.85274,1.67299,-5.4262"},EPSG_4204:{towgs84:"-85.645,-273.077,-79.708,2.289,-1.421,2.532,3.194"},EPSG_4319:{towgs84:"226.702,-193.337,-35.371,-2.229,-4.391,9.238,0.9798"},EPSG_4200:{towgs84:"24.82,-131.21,-82.66"},EPSG_4130:{towgs84:"0,0,0"},EPSG_4127:{towgs84:"-82.875,-57.097,-156.768,-2.158,1.524,-0.982,-0.359"},EPSG_4149:{towgs84:"674.374,15.056,405.346"},EPSG_4617:{towgs84:"-0.991,1.9072,0.5129,1.25033e-7,4.6785e-8,5.6529e-8,0"},EPSG_4663:{towgs84:"-210.502,-66.902,-48.476,2.094,-15.067,-5.817,0.485"},EPSG_4664:{towgs84:"-211.939,137.626,58.3,-0.089,0.251,0.079,0.384"},EPSG_4665:{towgs84:"-105.854,165.589,-38.312,-0.003,-0.026,0.024,-0.048"},EPSG_4666:{towgs84:"631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43"},EPSG_4756:{towgs84:"-192.873,-39.382,-111.202,-0.00205,-0.0005,0.00335,0.0188"},EPSG_4723:{towgs84:"-179.483,-69.379,-27.584,-7.862,8.163,6.042,-13.925"},EPSG_4726:{towgs84:"8.853,-52.644,180.304,-0.393,-2.323,2.96,-24.081"},EPSG_4267:{towgs84:"-8.0,160.0,176.0"},EPSG_5365:{towgs84:"-0.16959,0.35312,0.51846,0.03385,-0.16325,0.03446,0.03693"},EPSG_4218:{towgs84:"304.5,306.5,-318.1"},EPSG_4242:{towgs84:"-33.722,153.789,94.959,-8.581,-4.478,4.54,8.95"},EPSG_4216:{towgs84:"-292.295,248.758,429.447,4.9971,2.99,6.6906,1.0289"},ESRI_104105:{towgs84:"631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43"},ESRI_104129:{towgs84:"0,0,0"},EPSG_4673:{towgs84:"174.05,-25.49,112.57"},EPSG_4202:{towgs84:"-124,-60,154"},EPSG_4203:{towgs84:"-117.763,-51.51,139.061,0.292,0.443,0.277,-0.191"},EPSG_3819:{towgs84:"595.48,121.69,515.35,4.115,-2.9383,0.853,-3.408"},EPSG_8694:{towgs84:"-93.799,-132.737,-219.073,-1.844,0.648,-6.37,-0.169"},EPSG_4145:{towgs84:"275.57,676.78,229.6"},EPSG_4283:{towgs84:"61.55,-10.87,-40.19,39.4924,32.7221,32.8979,-9.994"},EPSG_4317:{towgs84:"2.3287,-147.0425,-92.0802,-0.3092483,0.32482185,0.49729934,5.68906266"},EPSG_4272:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993"},EPSG_4248:{towgs84:"-307.7,265.3,-363.5"},EPSG_5561:{towgs84:"24,-121,-76"},EPSG_5233:{towgs84:"-0.293,766.95,87.713,0.195704,1.695068,3.473016,-0.039338"},ESRI_104130:{towgs84:"-86,-98,-119"},ESRI_104102:{towgs84:"682,-203,480"},ESRI_37207:{towgs84:"7,-10,-26"},EPSG_4675:{towgs84:"59.935,118.4,-10.871"},ESRI_104109:{towgs84:"-89.121,-348.182,260.871"},ESRI_104112:{towgs84:"-185.583,-230.096,281.361"},ESRI_104113:{towgs84:"25.1,-275.6,222.6"},IGNF_WGS72G:{towgs84:"0,12,6"},IGNF_NTFG:{towgs84:"-168,-60,320"},IGNF_EFATE57G:{towgs84:"-127,-769,472"},IGNF_PGP50G:{towgs84:"324.8,153.6,172.1"},IGNF_REUN47G:{towgs84:"94,-948,-1262"},IGNF_CSG67G:{towgs84:"-186,230,110"},IGNF_GUAD48G:{towgs84:"-467,-16,-300"},IGNF_TAHI51G:{towgs84:"162,117,154"},IGNF_TAHAAG:{towgs84:"65,342,77"},IGNF_NUKU72G:{towgs84:"84,274,65"},IGNF_PETRELS72G:{towgs84:"365,194,166"},IGNF_WALL78G:{towgs84:"253,-133,-127"},IGNF_MAYO50G:{towgs84:"-382,-59,-262"},IGNF_TANNAG:{towgs84:"-139,-967,436"},IGNF_IGN72G:{towgs84:"-13,-348,292"},IGNF_ATIGG:{towgs84:"1118,23,66"},IGNF_FANGA84G:{towgs84:"150.57,158.33,118.32"},IGNF_RUSAT84G:{towgs84:"202.13,174.6,-15.74"},IGNF_KAUE70G:{towgs84:"126.74,300.1,-75.49"},IGNF_MOP90G:{towgs84:"-10.8,-1.8,12.77"},IGNF_MHPF67G:{towgs84:"338.08,212.58,-296.17"},IGNF_TAHI79G:{towgs84:"160.61,116.05,153.69"},IGNF_ANAA92G:{towgs84:"1.5,3.84,4.81"},IGNF_MARQUI72G:{towgs84:"330.91,-13.92,58.56"},IGNF_APAT86G:{towgs84:"143.6,197.82,74.05"},IGNF_TUBU69G:{towgs84:"237.17,171.61,-77.84"},IGNF_STPM50G:{towgs84:"11.363,424.148,373.13"},EPSG_4150:{towgs84:"674.374,15.056,405.346"},EPSG_4754:{towgs84:"-208.4058,-109.8777,-2.5764"},ESRI_104101:{towgs84:"374,150,588"},EPSG_4693:{towgs84:"0,-0.15,0.68"},EPSG_6207:{towgs84:"293.17,726.18,245.36"},EPSG_4153:{towgs84:"-133.63,-157.5,-158.62"},EPSG_4132:{towgs84:"-241.54,-163.64,396.06"},EPSG_4221:{towgs84:"-154.5,150.7,100.4"},EPSG_4266:{towgs84:"-80.7,-132.5,41.1"},EPSG_4193:{towgs84:"-70.9,-151.8,-41.4"},EPSG_5340:{towgs84:"-0.41,0.46,-0.35"},EPSG_4246:{towgs84:"-294.7,-200.1,525.5"},EPSG_4318:{towgs84:"-3.2,-5.7,2.8"},EPSG_4121:{towgs84:"-199.87,74.79,246.62"},EPSG_4223:{towgs84:"-260.1,5.5,432.2"},EPSG_4158:{towgs84:"-0.465,372.095,171.736"},EPSG_4285:{towgs84:"-128.16,-282.42,21.93"},EPSG_4613:{towgs84:"-404.78,685.68,45.47"},EPSG_4607:{towgs84:"195.671,332.517,274.607"},EPSG_4475:{towgs84:"-381.788,-57.501,-256.673"},EPSG_4208:{towgs84:"-157.84,308.54,-146.6"},EPSG_4743:{towgs84:"70.995,-335.916,262.898"},EPSG_4710:{towgs84:"-323.65,551.39,-491.22"},EPSG_7881:{towgs84:"-0.077,0.079,0.086"},EPSG_4682:{towgs84:"283.729,735.942,261.143"},EPSG_4739:{towgs84:"-156,-271,-189"},EPSG_4679:{towgs84:"-80.01,253.26,291.19"},EPSG_4750:{towgs84:"-56.263,16.136,-22.856"},EPSG_4644:{towgs84:"-10.18,-350.43,291.37"},EPSG_4695:{towgs84:"-103.746,-9.614,-255.95"},EPSG_4292:{towgs84:"-355,21,72"},EPSG_4302:{towgs84:"-61.702,284.488,472.052"},EPSG_4143:{towgs84:"-124.76,53,466.79"},EPSG_4606:{towgs84:"-153,153,307"},EPSG_4699:{towgs84:"-770.1,158.4,-498.2"},EPSG_4247:{towgs84:"-273.5,110.6,-357.9"},EPSG_4160:{towgs84:"8.88,184.86,106.69"},EPSG_4161:{towgs84:"-233.43,6.65,173.64"},EPSG_9251:{towgs84:"-9.5,122.9,138.2"},EPSG_9253:{towgs84:"-78.1,101.6,133.3"},EPSG_4297:{towgs84:"-198.383,-240.517,-107.909"},EPSG_4269:{towgs84:"0,0,0"},EPSG_4301:{towgs84:"-147,506,687"},EPSG_4618:{towgs84:"-59,-11,-52"},EPSG_4612:{towgs84:"0,0,0"},EPSG_4678:{towgs84:"44.585,-131.212,-39.544"},EPSG_4250:{towgs84:"-130,29,364"},EPSG_4144:{towgs84:"214,804,268"},EPSG_4147:{towgs84:"-17.51,-108.32,-62.39"},EPSG_4259:{towgs84:"-254.1,-5.36,-100.29"},EPSG_4164:{towgs84:"-76,-138,67"},EPSG_4211:{towgs84:"-378.873,676.002,-46.255"},EPSG_4182:{towgs84:"-422.651,-172.995,84.02"},EPSG_4224:{towgs84:"-143.87,243.37,-33.52"},EPSG_4225:{towgs84:"-205.57,168.77,-4.12"},EPSG_5527:{towgs84:"-67.35,3.88,-38.22"},EPSG_4752:{towgs84:"98,390,-22"},EPSG_4310:{towgs84:"-30,190,89"},EPSG_9248:{towgs84:"-192.26,65.72,132.08"},EPSG_4680:{towgs84:"124.5,-63.5,-281"},EPSG_4701:{towgs84:"-79.9,-158,-168.9"},EPSG_4706:{towgs84:"-146.21,112.63,4.05"},EPSG_4805:{towgs84:"682,-203,480"},EPSG_4201:{towgs84:"-165,-11,206"},EPSG_4210:{towgs84:"-157,-2,-299"},EPSG_4183:{towgs84:"-104,167,-38"},EPSG_4139:{towgs84:"11,72,-101"},EPSG_4668:{towgs84:"-86,-98,-119"},EPSG_4717:{towgs84:"-2,151,181"},EPSG_4732:{towgs84:"102,52,-38"},EPSG_4280:{towgs84:"-377,681,-50"},EPSG_4209:{towgs84:"-138,-105,-289"},EPSG_4261:{towgs84:"31,146,47"},EPSG_4658:{towgs84:"-73,46,-86"},EPSG_4721:{towgs84:"265.025,384.929,-194.046"},EPSG_4222:{towgs84:"-136,-108,-292"},EPSG_4601:{towgs84:"-255,-15,71"},EPSG_4602:{towgs84:"725,685,536"},EPSG_4603:{towgs84:"72,213.7,93"},EPSG_4605:{towgs84:"9,183,236"},EPSG_4621:{towgs84:"137,248,-430"},EPSG_4657:{towgs84:"-28,199,5"},EPSG_4316:{towgs84:"103.25,-100.4,-307.19"},EPSG_4642:{towgs84:"-13,-348,292"},EPSG_4698:{towgs84:"145,-187,103"},EPSG_4192:{towgs84:"-206.1,-174.7,-87.7"},EPSG_4311:{towgs84:"-265,120,-358"},EPSG_4135:{towgs84:"58,-283,-182"},ESRI_104138:{towgs84:"198,-226,-347"},EPSG_4245:{towgs84:"-11,851,5"},EPSG_4142:{towgs84:"-125,53,467"},EPSG_4213:{towgs84:"-106,-87,188"},EPSG_4253:{towgs84:"-133,-77,-51"},EPSG_4129:{towgs84:"-132,-110,-335"},EPSG_4713:{towgs84:"-77,-128,142"},EPSG_4239:{towgs84:"217,823,299"},EPSG_4146:{towgs84:"295,736,257"},EPSG_4155:{towgs84:"-83,37,124"},EPSG_4165:{towgs84:"-173,253,27"},EPSG_4672:{towgs84:"175,-38,113"},EPSG_4236:{towgs84:"-637,-549,-203"},EPSG_4251:{towgs84:"-90,40,88"},EPSG_4271:{towgs84:"-2,374,172"},EPSG_4175:{towgs84:"-88,4,101"},EPSG_4716:{towgs84:"298,-304,-375"},EPSG_4315:{towgs84:"-23,259,-9"},EPSG_4744:{towgs84:"-242.2,-144.9,370.3"},EPSG_4244:{towgs84:"-97,787,86"},EPSG_4293:{towgs84:"616,97,-251"},EPSG_4714:{towgs84:"-127,-769,472"},EPSG_4736:{towgs84:"260,12,-147"},EPSG_6883:{towgs84:"-235,-110,393"},EPSG_6894:{towgs84:"-63,176,185"},EPSG_4205:{towgs84:"-43,-163,45"},EPSG_4256:{towgs84:"41,-220,-134"},EPSG_4262:{towgs84:"639,405,60"},EPSG_4604:{towgs84:"174,359,365"},EPSG_4169:{towgs84:"-115,118,426"},EPSG_4620:{towgs84:"-106,-129,165"},EPSG_4184:{towgs84:"-203,141,53"},EPSG_4616:{towgs84:"-289,-124,60"},EPSG_9403:{towgs84:"-307,-92,127"},EPSG_4684:{towgs84:"-133,-321,50"},EPSG_4708:{towgs84:"-491,-22,435"},EPSG_4707:{towgs84:"114,-116,-333"},EPSG_4709:{towgs84:"145,75,-272"},EPSG_4712:{towgs84:"-205,107,53"},EPSG_4711:{towgs84:"124,-234,-25"},EPSG_4718:{towgs84:"230,-199,-752"},EPSG_4719:{towgs84:"211,147,111"},EPSG_4724:{towgs84:"208,-435,-229"},EPSG_4725:{towgs84:"189,-79,-202"},EPSG_4735:{towgs84:"647,1777,-1124"},EPSG_4722:{towgs84:"-794,119,-298"},EPSG_4728:{towgs84:"-307,-92,127"},EPSG_4734:{towgs84:"-632,438,-609"},EPSG_4727:{towgs84:"912,-58,1227"},EPSG_4729:{towgs84:"185,165,42"},EPSG_4730:{towgs84:"170,42,84"},EPSG_4733:{towgs84:"276,-57,149"},ESRI_37218:{towgs84:"230,-199,-752"},ESRI_37240:{towgs84:"-7,215,225"},ESRI_37221:{towgs84:"252,-209,-751"},ESRI_4305:{towgs84:"-123,-206,219"},ESRI_104139:{towgs84:"-73,-247,227"},EPSG_4748:{towgs84:"51,391,-36"},EPSG_4219:{towgs84:"-384,664,-48"},EPSG_4255:{towgs84:"-333,-222,114"},EPSG_4257:{towgs84:"-587.8,519.75,145.76"},EPSG_4646:{towgs84:"-963,510,-359"},EPSG_6881:{towgs84:"-24,-203,268"},EPSG_6882:{towgs84:"-183,-15,273"},EPSG_4715:{towgs84:"-104,-129,239"},IGNF_RGF93GDD:{towgs84:"0,0,0"},IGNF_RGM04GDD:{towgs84:"0,0,0"},IGNF_RGSPM06GDD:{towgs84:"0,0,0"},IGNF_RGTAAF07GDD:{towgs84:"0,0,0"},IGNF_RGFG95GDD:{towgs84:"0,0,0"},IGNF_RGNCG:{towgs84:"0,0,0"},IGNF_RGPFGDD:{towgs84:"0,0,0"},IGNF_ETRS89G:{towgs84:"0,0,0"},IGNF_RGR92GDD:{towgs84:"0,0,0"},EPSG_4173:{towgs84:"0,0,0"},EPSG_4180:{towgs84:"0,0,0"},EPSG_4619:{towgs84:"0,0,0"},EPSG_4667:{towgs84:"0,0,0"},EPSG_4075:{towgs84:"0,0,0"},EPSG_6706:{towgs84:"0,0,0"},EPSG_7798:{towgs84:"0,0,0"},EPSG_4661:{towgs84:"0,0,0"},EPSG_4669:{towgs84:"0,0,0"},EPSG_8685:{towgs84:"0,0,0"},EPSG_4151:{towgs84:"0,0,0"},EPSG_9702:{towgs84:"0,0,0"},EPSG_4758:{towgs84:"0,0,0"},EPSG_4761:{towgs84:"0,0,0"},EPSG_4765:{towgs84:"0,0,0"},EPSG_8997:{towgs84:"0,0,0"},EPSG_4023:{towgs84:"0,0,0"},EPSG_4670:{towgs84:"0,0,0"},EPSG_4694:{towgs84:"0,0,0"},EPSG_4148:{towgs84:"0,0,0"},EPSG_4163:{towgs84:"0,0,0"},EPSG_4167:{towgs84:"0,0,0"},EPSG_4189:{towgs84:"0,0,0"},EPSG_4190:{towgs84:"0,0,0"},EPSG_4176:{towgs84:"0,0,0"},EPSG_4659:{towgs84:"0,0,0"},EPSG_3824:{towgs84:"0,0,0"},EPSG_3889:{towgs84:"0,0,0"},EPSG_4046:{towgs84:"0,0,0"},EPSG_4081:{towgs84:"0,0,0"},EPSG_4558:{towgs84:"0,0,0"},EPSG_4483:{towgs84:"0,0,0"},EPSG_5013:{towgs84:"0,0,0"},EPSG_5264:{towgs84:"0,0,0"},EPSG_5324:{towgs84:"0,0,0"},EPSG_5354:{towgs84:"0,0,0"},EPSG_5371:{towgs84:"0,0,0"},EPSG_5373:{towgs84:"0,0,0"},EPSG_5381:{towgs84:"0,0,0"},EPSG_5393:{towgs84:"0,0,0"},EPSG_5489:{towgs84:"0,0,0"},EPSG_5593:{towgs84:"0,0,0"},EPSG_6135:{towgs84:"0,0,0"},EPSG_6365:{towgs84:"0,0,0"},EPSG_5246:{towgs84:"0,0,0"},EPSG_7886:{towgs84:"0,0,0"},EPSG_8431:{towgs84:"0,0,0"},EPSG_8427:{towgs84:"0,0,0"},EPSG_8699:{towgs84:"0,0,0"},EPSG_8818:{towgs84:"0,0,0"},EPSG_4757:{towgs84:"0,0,0"},EPSG_9140:{towgs84:"0,0,0"},EPSG_8086:{towgs84:"0,0,0"},EPSG_4686:{towgs84:"0,0,0"},EPSG_4737:{towgs84:"0,0,0"},EPSG_4702:{towgs84:"0,0,0"},EPSG_4747:{towgs84:"0,0,0"},EPSG_4749:{towgs84:"0,0,0"},EPSG_4674:{towgs84:"0,0,0"},EPSG_4755:{towgs84:"0,0,0"},EPSG_4759:{towgs84:"0,0,0"},EPSG_4762:{towgs84:"0,0,0"},EPSG_4763:{towgs84:"0,0,0"},EPSG_4764:{towgs84:"0,0,0"},EPSG_4166:{towgs84:"0,0,0"},EPSG_4170:{towgs84:"0,0,0"},EPSG_5546:{towgs84:"0,0,0"},EPSG_7844:{towgs84:"0,0,0"},EPSG_4818:{towgs84:"589,76,480"}};for(var YZ in w0){var vE=w0[YZ];vE.datumName&&(w0[vE.datumName]=vE)}function XZ(n,e,t,i,r,s,o){var a={};return n===void 0||n==="none"?a.datum_type=Xw:a.datum_type=lZ,e&&(a.datum_params=e.map(parseFloat),(a.datum_params[0]!==0||a.datum_params[1]!==0||a.datum_params[2]!==0)&&(a.datum_type=Tc),a.datum_params.length>3&&(a.datum_params[3]!==0||a.datum_params[4]!==0||a.datum_params[5]!==0||a.datum_params[6]!==0)&&(a.datum_type=Rc,a.datum_params[3]*=Df,a.datum_params[4]*=Df,a.datum_params[5]*=Df,a.datum_params[6]=a.datum_params[6]/1e6+1)),o&&(a.datum_type=hh,a.grids=o),a.a=t,a.b=i,a.es=r,a.ep2=s,a}var DI={};function QZ(n,e,t){return e instanceof ArrayBuffer?ZZ(n,e,t):{ready:JZ(n,e)}}function ZZ(n,e,t){var i=!0;t!==void 0&&t.includeErrorFields===!1&&(i=!1);var r=new DataView(e),s=nJ(r),o=iJ(r,s),a=rJ(r,o,s,i),c={header:o,subgrids:a};return DI[n]=c,c}async function JZ(n,e){for(var t=[],i=await e.getImageCount(),r=i-1;r>=0;r--){var s=await e.getImage(r),o=await s.readRasters(),a=o,c=[s.getWidth(),s.getHeight()],h=s.getBoundingBox().map(rb),d=[s.fileDirectory.ModelPixelScale[0],s.fileDirectory.ModelPixelScale[1]].map(rb),g=h[0]+(c[0]-1)*d[0],m=h[3]-(c[1]-1)*d[1],y=a[0],w=a[1],T=[];for(let M=c[1]-1;M>=0;M--)for(let N=c[0]-1;N>=0;N--){var E=M*c[0]+N;T.push([-Aa(w[E]),Aa(y[E])])}t.push({del:d,lim:c,ll:[-g,m],cvs:T})}var P={header:{nSubgrids:i},subgrids:t};return DI[n]=P,P}function eJ(n){if(n===void 0)return null;var e=n.split(",");return e.map(tJ)}function tJ(n){if(n.length===0)return null;var e=n[0]==="@";return e&&(n=n.slice(1)),n==="null"?{name:"null",mandatory:!e,grid:null,isNull:!0}:{name:n,mandatory:!e,grid:DI[n]||null,isNull:!1}}function rb(n){return n*Math.PI/180}function Aa(n){return n/3600*Math.PI/180}function nJ(n){var e=n.getInt32(8,!1);return e===11?!1:(e=n.getInt32(8,!0),e!==11&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}function iJ(n,e){return{nFields:n.getInt32(8,e),nSubgridFields:n.getInt32(24,e),nSubgrids:n.getInt32(40,e),shiftType:Zw(n,56,64).trim(),fromSemiMajorAxis:n.getFloat64(120,e),fromSemiMinorAxis:n.getFloat64(136,e),toSemiMajorAxis:n.getFloat64(152,e),toSemiMinorAxis:n.getFloat64(168,e)}}function Zw(n,e,t){return String.fromCharCode.apply(null,new Uint8Array(n.buffer.slice(e,t)))}function rJ(n,e,t,i){for(var r=176,s=[],o=0;o<e.nSubgrids;o++){var a=oJ(n,r,t),c=aJ(n,r,a,t,i),h=Math.round(1+(a.upperLongitude-a.lowerLongitude)/a.longitudeInterval),d=Math.round(1+(a.upperLatitude-a.lowerLatitude)/a.latitudeInterval);s.push({ll:[Aa(a.lowerLongitude),Aa(a.lowerLatitude)],del:[Aa(a.longitudeInterval),Aa(a.latitudeInterval)],lim:[h,d],count:a.gridNodeCount,cvs:sJ(c)});var g=16;i===!1&&(g=8),r+=176+a.gridNodeCount*g}return s}function sJ(n){return n.map(function(e){return[Aa(e.longitudeShift),Aa(e.latitudeShift)]})}function oJ(n,e,t){return{name:Zw(n,e+8,e+16).trim(),parent:Zw(n,e+24,e+24+8).trim(),lowerLatitude:n.getFloat64(e+72,t),upperLatitude:n.getFloat64(e+88,t),lowerLongitude:n.getFloat64(e+104,t),upperLongitude:n.getFloat64(e+120,t),latitudeInterval:n.getFloat64(e+136,t),longitudeInterval:n.getFloat64(e+152,t),gridNodeCount:n.getInt32(e+168,t)}}function aJ(n,e,t,i,r){var s=e+176,o=16;r===!1&&(o=8);for(var a=[],c=0;c<t.gridNodeCount;c++){var h={latitudeShift:n.getFloat32(s+c*o,i),longitudeShift:n.getFloat32(s+c*o+4,i)};r!==!1&&(h.latitudeAccuracy=n.getFloat32(s+c*o+8,i),h.longitudeAccuracy=n.getFloat32(s+c*o+12,i)),a.push(h)}return a}function kr(n,e){if(!(this instanceof kr))return new kr(n);this.forward=null,this.inverse=null,this.init=null,this.name,this.names=null,this.title,e=e||function(h){if(h)throw h};var t=NZ(n);if(typeof t!="object"){e("Could not parse to valid json: "+n);return}var i=kr.projections.get(t.projName);if(!i){e("Could not get projection name from: "+n);return}if(t.datumCode&&t.datumCode!=="none"){var r=Xa(w0,t.datumCode);r&&(t.datum_params=t.datum_params||(r.towgs84?r.towgs84.split(","):null),t.ellps=r.ellipse,t.datumName=r.datumName?r.datumName:t.datumCode)}t.k0=t.k0||1,t.axis=t.axis||"enu",t.ellps=t.ellps||"wgs84",t.lat1=t.lat1||t.lat0;var s=qZ(t.a,t.b,t.rf,t.ellps,t.sphere),o=KZ(s.a,s.b,s.rf,t.R_A),a=eJ(t.nadgrids),c=t.datum||XZ(t.datumCode,t.datum_params,s.a,s.b,o.es,o.ep2,a);nb(this,t),nb(this,i),this.a=s.a,this.b=s.b,this.rf=s.rf,this.sphere=s.sphere,this.es=o.es,this.e=o.e,this.ep2=o.ep2,this.datum=c,"init"in this&&typeof this.init=="function"&&this.init(),e(null,this)}kr.projections=WZ;kr.projections.start();function lJ(n,e){return n.datum_type!==e.datum_type||n.a!==e.a||Math.abs(n.es-e.es)>5e-11?!1:n.datum_type===Tc?n.datum_params[0]===e.datum_params[0]&&n.datum_params[1]===e.datum_params[1]&&n.datum_params[2]===e.datum_params[2]:n.datum_type===Rc?n.datum_params[0]===e.datum_params[0]&&n.datum_params[1]===e.datum_params[1]&&n.datum_params[2]===e.datum_params[2]&&n.datum_params[3]===e.datum_params[3]&&n.datum_params[4]===e.datum_params[4]&&n.datum_params[5]===e.datum_params[5]&&n.datum_params[6]===e.datum_params[6]:!0}function a3(n,e,t){var i=n.x,r=n.y,s=n.z?n.z:0,o,a,c,h;if(r<-he&&r>-1.001*he)r=-he;else if(r>he&&r<1.001*he)r=he;else{if(r<-he)return{x:-1/0,y:-1/0,z:n.z};if(r>he)return{x:1/0,y:1/0,z:n.z}}return i>Math.PI&&(i-=2*Math.PI),a=Math.sin(r),h=Math.cos(r),c=a*a,o=t/Math.sqrt(1-e*c),{x:(o+s)*h*Math.cos(i),y:(o+s)*h*Math.sin(i),z:(o*(1-e)+s)*a}}function l3(n,e,t,i){var r=1e-12,s=r*r,o=30,a,c,h,d,g,m,y,w,T,E,P,M,N,D=n.x,j=n.y,W=n.z?n.z:0,L,A,k;if(a=Math.sqrt(D*D+j*j),c=Math.sqrt(D*D+j*j+W*W),a/t<r){if(L=0,c/t<r)return A=he,k=-i,{x:n.x,y:n.y,z:n.z}}else L=Math.atan2(j,D);h=W/c,d=a/c,g=1/Math.sqrt(1-e*(2-e)*d*d),w=d*(1-e)*g,T=h*g,N=0;do N++,y=t/Math.sqrt(1-e*T*T),k=a*w+W*T-y*(1-e*T*T),m=e*y/(y+k),g=1/Math.sqrt(1-m*(2-m)*d*d),E=d*(1-m)*g,P=h*g,M=P*w-E*T,w=E,T=P;while(M*M>s&&N<o);return A=Math.atan(P/Math.abs(E)),{x:L,y:A,z:k}}function cJ(n,e,t){if(e===Tc)return{x:n.x+t[0],y:n.y+t[1],z:n.z+t[2]};if(e===Rc){var i=t[0],r=t[1],s=t[2],o=t[3],a=t[4],c=t[5],h=t[6];return{x:h*(n.x-c*n.y+a*n.z)+i,y:h*(c*n.x+n.y-o*n.z)+r,z:h*(-a*n.x+o*n.y+n.z)+s}}}function uJ(n,e,t){if(e===Tc)return{x:n.x-t[0],y:n.y-t[1],z:n.z-t[2]};if(e===Rc){var i=t[0],r=t[1],s=t[2],o=t[3],a=t[4],c=t[5],h=t[6],d=(n.x-i)/h,g=(n.y-r)/h,m=(n.z-s)/h;return{x:d+c*g-a*m,y:-c*d+g+o*m,z:a*d-o*g+m}}}function Xp(n){return n===Tc||n===Rc}function hJ(n,e,t){if(lJ(n,e)||n.datum_type===Xw||e.datum_type===Xw)return t;var i=n.a,r=n.es;if(n.datum_type===hh){var s=sb(n,!1,t);if(s!==0)return;i=XM,r=QM}var o=e.a,a=e.b,c=e.es;if(e.datum_type===hh&&(o=XM,a=cZ,c=QM),r===c&&i===o&&!Xp(n.datum_type)&&!Xp(e.datum_type))return t;if(t=a3(t,r,i),Xp(n.datum_type)&&(t=cJ(t,n.datum_type,n.datum_params)),Xp(e.datum_type)&&(t=uJ(t,e.datum_type,e.datum_params)),t=l3(t,c,o,a),e.datum_type===hh){var h=sb(e,!0,t);if(h!==0)return}return t}function sb(n,e,t){if(n.grids===null||n.grids.length===0)return console.log("Grid shift grids not found"),-1;var i={x:-t.x,y:t.y},r={x:Number.NaN,y:Number.NaN},s=[];e:for(var o=0;o<n.grids.length;o++){var a=n.grids[o];if(s.push(a.name),a.isNull){r=i;break}if(a.grid===null){if(a.mandatory)return console.log("Unable to find mandatory grid '"+a.name+"'"),-1;continue}for(var c=a.grid.subgrids,h=0,d=c.length;h<d;h++){var g=c[h],m=(Math.abs(g.del[1])+Math.abs(g.del[0]))/1e4,y=g.ll[0]-m,w=g.ll[1]-m,T=g.ll[0]+(g.lim[0]-1)*g.del[0]+m,E=g.ll[1]+(g.lim[1]-1)*g.del[1]+m;if(!(w>i.y||y>i.x||E<i.y||T<i.x)&&(r=dJ(i,e,g),!isNaN(r.x)))break e}}return isNaN(r.x)?(console.log("Failed to find a grid shift table for location '"+-i.x*Gi+" "+i.y*Gi+" tried: '"+s+"'"),-1):(t.x=-r.x,t.y=r.y,0)}function dJ(n,e,t){var i={x:Number.NaN,y:Number.NaN};if(isNaN(n.x))return i;var r={x:n.x,y:n.y};r.x-=t.ll[0],r.y-=t.ll[1],r.x=Ie(r.x-Math.PI)+Math.PI;var s=ob(r,t);if(e){if(isNaN(s.x))return i;s.x=r.x-s.x,s.y=r.y-s.y;var o=9,a=1e-12,c,h;do{if(h=ob(s,t),isNaN(h.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}c={x:r.x-(h.x+s.x),y:r.y-(h.y+s.y)},s.x+=c.x,s.y+=c.y}while(o--&&Math.abs(c.x)>a&&Math.abs(c.y)>a);if(o<0)return console.log("Inverse grid shift iterator failed to converge."),i;i.x=Ie(s.x+t.ll[0]),i.y=s.y+t.ll[1]}else isNaN(s.x)||(i.x=n.x+s.x,i.y=n.y+s.y);return i}function ob(n,e){var t={x:n.x/e.del[0],y:n.y/e.del[1]},i={x:Math.floor(t.x),y:Math.floor(t.y)},r={x:t.x-1*i.x,y:t.y-1*i.y},s={x:Number.NaN,y:Number.NaN},o;if(i.x<0||i.x>=e.lim[0]||i.y<0||i.y>=e.lim[1])return s;o=i.y*e.lim[0]+i.x;var a={x:e.cvs[o][0],y:e.cvs[o][1]};o++;var c={x:e.cvs[o][0],y:e.cvs[o][1]};o+=e.lim[0];var h={x:e.cvs[o][0],y:e.cvs[o][1]};o--;var d={x:e.cvs[o][0],y:e.cvs[o][1]},g=r.x*r.y,m=r.x*(1-r.y),y=(1-r.x)*(1-r.y),w=(1-r.x)*r.y;return s.x=y*a.x+m*c.x+w*d.x+g*h.x,s.y=y*a.y+m*c.y+w*d.y+g*h.y,s}function ab(n,e,t){var i=t.x,r=t.y,s=t.z||0,o,a,c,h={};for(c=0;c<3;c++)if(!(e&&c===2&&t.z===void 0))switch(c===0?(o=i,"ew".indexOf(n.axis[c])!==-1?a="x":a="y"):c===1?(o=r,"ns".indexOf(n.axis[c])!==-1?a="y":a="x"):(o=s,a="z"),n.axis[c]){case"e":h[a]=o;break;case"w":h[a]=-o;break;case"n":h[a]=o;break;case"s":h[a]=-o;break;case"u":t[a]!==void 0&&(h.z=o);break;case"d":t[a]!==void 0&&(h.z=-o);break;default:return null}return h}function c3(n){var e={x:n[0],y:n[1]};return n.length>2&&(e.z=n[2]),n.length>3&&(e.m=n[3]),e}function fJ(n){lb(n.x),lb(n.y)}function lb(n){if(typeof Number.isFinite=="function"){if(Number.isFinite(n))return;throw new TypeError("coordinates must be finite numbers")}if(typeof n!="number"||n!==n||!isFinite(n))throw new TypeError("coordinates must be finite numbers")}function gJ(n,e){return(n.datum.datum_type===Tc||n.datum.datum_type===Rc||n.datum.datum_type===hh)&&e.datumCode!=="WGS84"||(e.datum.datum_type===Tc||e.datum.datum_type===Rc||e.datum.datum_type===hh)&&n.datumCode!=="WGS84"}function M_(n,e,t,i){var r;Array.isArray(t)?t=c3(t):t={x:t.x,y:t.y,z:t.z,m:t.m};var s=t.z!==void 0;if(fJ(t),n.datum&&e.datum&&gJ(n,e)&&(r=new kr("WGS84"),t=M_(n,r,t,i),n=r),i&&n.axis!=="enu"&&(t=ab(n,!1,t)),n.projName==="longlat")t={x:t.x*Qt,y:t.y*Qt,z:t.z||0};else if(n.to_meter&&(t={x:t.x*n.to_meter,y:t.y*n.to_meter,z:t.z||0}),t=n.inverse(t),!t)return;if(n.from_greenwich&&(t.x+=n.from_greenwich),t=hJ(n.datum,e.datum,t),!!t)return t=t,e.from_greenwich&&(t={x:t.x-e.from_greenwich,y:t.y,z:t.z||0}),e.projName==="longlat"?t={x:t.x*Gi,y:t.y*Gi,z:t.z||0}:(t=e.forward(t),e.to_meter&&(t={x:t.x/e.to_meter,y:t.y/e.to_meter,z:t.z||0})),i&&e.axis!=="enu"?ab(e,!0,t):(t&&!s&&delete t.z,t)}var cb=kr("WGS84");function EE(n,e,t,i){var r,s,o;return Array.isArray(t)?(r=M_(n,e,t,i)||{x:NaN,y:NaN},t.length>2?typeof n.name<"u"&&n.name==="geocent"||typeof e.name<"u"&&e.name==="geocent"?typeof r.z=="number"?[r.x,r.y,r.z].concat(t.slice(3)):[r.x,r.y,t[2]].concat(t.slice(3)):[r.x,r.y].concat(t.slice(2)):[r.x,r.y]):(s=M_(n,e,t,i),o=Object.keys(t),o.length===2||o.forEach(function(a){if(typeof n.name<"u"&&n.name==="geocent"||typeof e.name<"u"&&e.name==="geocent"){if(a==="x"||a==="y"||a==="z")return}else if(a==="x"||a==="y")return;s[a]=t[a]}),s)}function Qp(n){return n instanceof kr?n:typeof n=="object"&&"oProj"in n?n.oProj:kr(n)}function mJ(n,e,t){var i,r,s=!1,o;return typeof e>"u"?(r=Qp(n),i=cb,s=!0):(typeof e.x<"u"||Array.isArray(e))&&(t=e,r=Qp(n),i=cb,s=!0),i||(i=Qp(n)),r||(r=Qp(e)),t?EE(i,r,t):(o={forward:function(a,c){return EE(i,r,a,c)},inverse:function(a,c){return EE(r,i,a,c)}},s&&(o.oProj=r),o)}var ub=6,u3="AJSAJS",h3="AFAFAF",eh=65,Mi=73,Ir=79,pf=86,_f=90;const pJ={forward:d3,inverse:_J,toPoint:f3};function d3(n,e){return e=e||5,EJ(yJ({lat:n[1],lon:n[0]}),e)}function _J(n){var e=VI(m3(n.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat,e.lon,e.lat]:[e.left,e.bottom,e.right,e.top]}function f3(n){var e=VI(m3(n.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat]:[(e.left+e.right)/2,(e.top+e.bottom)/2]}function wE(n){return n*(Math.PI/180)}function hb(n){return 180*(n/Math.PI)}function yJ(n){var e=n.lat,t=n.lon,i=6378137,r=.00669438,s=.9996,o,a,c,h,d,g,m,y=wE(e),w=wE(t),T,E;E=Math.floor((t+180)/6)+1,t===180&&(E=60),e>=56&&e<64&&t>=3&&t<12&&(E=32),e>=72&&e<84&&(t>=0&&t<9?E=31:t>=9&&t<21?E=33:t>=21&&t<33?E=35:t>=33&&t<42&&(E=37)),o=(E-1)*6-180+3,T=wE(o),a=r/(1-r),c=i/Math.sqrt(1-r*Math.sin(y)*Math.sin(y)),h=Math.tan(y)*Math.tan(y),d=a*Math.cos(y)*Math.cos(y),g=Math.cos(y)*(w-T),m=i*((1-r/4-3*r*r/64-5*r*r*r/256)*y-(3*r/8+3*r*r/32+45*r*r*r/1024)*Math.sin(2*y)+(15*r*r/256+45*r*r*r/1024)*Math.sin(4*y)-35*r*r*r/3072*Math.sin(6*y));var P=s*c*(g+(1-h+d)*g*g*g/6+(5-18*h+h*h+72*d-58*a)*g*g*g*g*g/120)+5e5,M=s*(m+c*Math.tan(y)*(g*g/2+(5-h+9*d+4*d*d)*g*g*g*g/24+(61-58*h+h*h+600*d-330*a)*g*g*g*g*g*g/720));return e<0&&(M+=1e7),{northing:Math.round(M),easting:Math.round(P),zoneNumber:E,zoneLetter:vJ(e)}}function VI(n){var e=n.northing,t=n.easting,i=n.zoneLetter,r=n.zoneNumber;if(r<0||r>60)return null;var s=.9996,o=6378137,a=.00669438,c,h=(1-Math.sqrt(1-a))/(1+Math.sqrt(1-a)),d,g,m,y,w,T,E,P,M,N=t-5e5,D=e;i<"N"&&(D-=1e7),E=(r-1)*6-180+3,c=a/(1-a),T=D/s,P=T/(o*(1-a/4-3*a*a/64-5*a*a*a/256)),M=P+(3*h/2-27*h*h*h/32)*Math.sin(2*P)+(21*h*h/16-55*h*h*h*h/32)*Math.sin(4*P)+151*h*h*h/96*Math.sin(6*P),d=o/Math.sqrt(1-a*Math.sin(M)*Math.sin(M)),g=Math.tan(M)*Math.tan(M),m=c*Math.cos(M)*Math.cos(M),y=o*(1-a)/Math.pow(1-a*Math.sin(M)*Math.sin(M),1.5),w=N/(d*s);var j=M-d*Math.tan(M)/y*(w*w/2-(5+3*g+10*m-4*m*m-9*c)*w*w*w*w/24+(61+90*g+298*m+45*g*g-252*c-3*m*m)*w*w*w*w*w*w/720);j=hb(j);var W=(w-(1+2*g+m)*w*w*w/6+(5-2*m+28*g-3*m*m+8*c+24*g*g)*w*w*w*w*w/120)/Math.cos(M);W=E+hb(W);var L;if(n.accuracy){var A=VI({northing:n.northing+n.accuracy,easting:n.easting+n.accuracy,zoneLetter:n.zoneLetter,zoneNumber:n.zoneNumber});L={top:A.lat,right:A.lon,bottom:j,left:W}}else L={lat:j,lon:W};return L}function vJ(n){var e="Z";return 84>=n&&n>=72?e="X":72>n&&n>=64?e="W":64>n&&n>=56?e="V":56>n&&n>=48?e="U":48>n&&n>=40?e="T":40>n&&n>=32?e="S":32>n&&n>=24?e="R":24>n&&n>=16?e="Q":16>n&&n>=8?e="P":8>n&&n>=0?e="N":0>n&&n>=-8?e="M":-8>n&&n>=-16?e="L":-16>n&&n>=-24?e="K":-24>n&&n>=-32?e="J":-32>n&&n>=-40?e="H":-40>n&&n>=-48?e="G":-48>n&&n>=-56?e="F":-56>n&&n>=-64?e="E":-64>n&&n>=-72?e="D":-72>n&&n>=-80&&(e="C"),e}function EJ(n,e){var t="00000"+n.easting,i="00000"+n.northing;return n.zoneNumber+n.zoneLetter+wJ(n.easting,n.northing,n.zoneNumber)+t.substr(t.length-5,e)+i.substr(i.length-5,e)}function wJ(n,e,t){var i=g3(t),r=Math.floor(n/1e5),s=Math.floor(e/1e5)%20;return xJ(r,s,i)}function g3(n){var e=n%ub;return e===0&&(e=ub),e}function xJ(n,e,t){var i=t-1,r=u3.charCodeAt(i),s=h3.charCodeAt(i),o=r+n-1,a=s+e,c=!1;o>_f&&(o=o-_f+eh-1,c=!0),(o===Mi||r<Mi&&o>Mi||(o>Mi||r<Mi)&&c)&&o++,(o===Ir||r<Ir&&o>Ir||(o>Ir||r<Ir)&&c)&&(o++,o===Mi&&o++),o>_f&&(o=o-_f+eh-1),a>pf?(a=a-pf+eh-1,c=!0):c=!1,(a===Mi||s<Mi&&a>Mi||(a>Mi||s<Mi)&&c)&&a++,(a===Ir||s<Ir&&a>Ir||(a>Ir||s<Ir)&&c)&&(a++,a===Mi&&a++),a>pf&&(a=a-pf+eh-1);var h=String.fromCharCode(o)+String.fromCharCode(a);return h}function m3(n){if(n&&n.length===0)throw"MGRSPoint coverting from nothing";for(var e=n.length,t=null,i="",r,s=0;!/[A-Z]/.test(r=n.charAt(s));){if(s>=2)throw"MGRSPoint bad conversion from: "+n;i+=r,s++}var o=parseInt(i,10);if(s===0||s+3>e)throw"MGRSPoint bad conversion from: "+n;var a=n.charAt(s++);if(a<="A"||a==="B"||a==="Y"||a>="Z"||a==="I"||a==="O")throw"MGRSPoint zone letter "+a+" not handled: "+n;t=n.substring(s,s+=2);for(var c=g3(o),h=SJ(t.charAt(0),c),d=IJ(t.charAt(1),c);d<TJ(a);)d+=2e6;var g=e-s;if(g%2!==0)throw`MGRSPoint has to have an even number 
of digits after the zone letter and two 100km letters - front 
half for easting meters, second half for 
northing meters`+n;var m=g/2,y=0,w=0,T,E,P,M,N;return m>0&&(T=1e5/Math.pow(10,m),E=n.substring(s,s+m),y=parseFloat(E)*T,P=n.substring(s+m),w=parseFloat(P)*T),M=y+h,N=w+d,{easting:M,northing:N,zoneLetter:a,zoneNumber:o,accuracy:T}}function SJ(n,e){for(var t=u3.charCodeAt(e-1),i=1e5,r=!1;t!==n.charCodeAt(0);){if(t++,t===Mi&&t++,t===Ir&&t++,t>_f){if(r)throw"Bad character: "+n;t=eh,r=!0}i+=1e5}return i}function IJ(n,e){if(n>"V")throw"MGRSPoint given invalid Northing "+n;for(var t=h3.charCodeAt(e-1),i=0,r=!1;t!==n.charCodeAt(0);){if(t++,t===Mi&&t++,t===Ir&&t++,t>pf){if(r)throw"Bad character: "+n;t=eh,r=!0}i+=1e5}return i}function TJ(n){var e;switch(n){case"C":e=11e5;break;case"D":e=2e6;break;case"E":e=28e5;break;case"F":e=37e5;break;case"G":e=46e5;break;case"H":e=55e5;break;case"J":e=64e5;break;case"K":e=73e5;break;case"L":e=82e5;break;case"M":e=91e5;break;case"N":e=0;break;case"P":e=8e5;break;case"Q":e=17e5;break;case"R":e=26e5;break;case"S":e=35e5;break;case"T":e=44e5;break;case"U":e=53e5;break;case"V":e=62e5;break;case"W":e=7e6;break;case"X":e=79e5;break;default:e=-1}if(e>=0)return e;throw"Invalid zone letter: "+n}function jh(n,e,t){if(!(this instanceof jh))return new jh(n,e,t);if(Array.isArray(n))this.x=n[0],this.y=n[1],this.z=n[2]||0;else if(typeof n=="object")this.x=n.x,this.y=n.y,this.z=n.z||0;else if(typeof n=="string"&&typeof e>"u"){var i=n.split(",");this.x=parseFloat(i[0]),this.y=parseFloat(i[1]),this.z=parseFloat(i[2])||0}else this.x=n,this.y=e,this.z=t||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}jh.fromMGRS=function(n){return new jh(f3(n))};jh.prototype.toMGRS=function(n){return d3([this.x,this.y],n)};var RJ=1,PJ=.25,db=.046875,fb=.01953125,gb=.01068115234375,AJ=.75,CJ=.46875,MJ=.013020833333333334,bJ=.007120768229166667,kJ=.3645833333333333,LJ=.005696614583333333,NJ=.3076171875;function FI(n){var e=[];e[0]=RJ-n*(PJ+n*(db+n*(fb+n*gb))),e[1]=n*(AJ-n*(db+n*(fb+n*gb)));var t=n*n;return e[2]=t*(CJ-n*(MJ+n*bJ)),t*=n,e[3]=t*(kJ-n*LJ),e[4]=t*n*NJ,e}function Qh(n,e,t,i){return t*=e,e*=e,i[0]*n-t*(i[1]+e*(i[2]+e*(i[3]+e*i[4])))}var OJ=20;function GI(n,e,t){for(var i=1/(1-e),r=n,s=OJ;s;--s){var o=Math.sin(r),a=1-e*o*o;if(a=(Qh(r,o,Math.cos(r),t)-n)*(a*Math.sqrt(a))*i,r-=a,Math.abs(a)<Ee)return r}return r}function DJ(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.es&&(this.en=FI(this.es),this.ml0=Qh(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))}function VJ(n){var e=n.x,t=n.y,i=Ie(e-this.long0,this.over),r,s,o,a=Math.sin(t),c=Math.cos(t);if(this.es){var d=c*i,g=Math.pow(d,2),m=this.ep2*Math.pow(c,2),y=Math.pow(m,2),w=Math.abs(c)>Ee?Math.tan(t):0,T=Math.pow(w,2),E=Math.pow(T,2);r=1-this.es*Math.pow(a,2),d=d/Math.sqrt(r);var P=Qh(t,a,c,this.en);s=this.a*(this.k0*d*(1+g/6*(1-T+m+g/20*(5-18*T+E+14*m-58*T*m+g/42*(61+179*E-E*T-479*T)))))+this.x0,o=this.a*(this.k0*(P-this.ml0+a*i*d/2*(1+g/12*(5-T+9*m+4*y+g/30*(61+E-58*T+270*m-330*T*m+g/56*(1385+543*E-E*T-3111*T))))))+this.y0}else{var h=c*Math.sin(i);if(Math.abs(Math.abs(h)-1)<Ee)return 93;if(s=.5*this.a*this.k0*Math.log((1+h)/(1-h))+this.x0,o=c*Math.cos(i)/Math.sqrt(1-Math.pow(h,2)),h=Math.abs(o),h>=1){if(h-1>Ee)return 93;o=0}else o=Math.acos(o);t<0&&(o=-o),o=this.a*this.k0*(o-this.lat0)+this.y0}return n.x=s,n.y=o,n}function FJ(n){var e,t,i,r,s=(n.x-this.x0)*(1/this.a),o=(n.y-this.y0)*(1/this.a);if(this.es)if(e=this.ml0+o/this.k0,t=GI(e,this.es,this.en),Math.abs(t)<he){var g=Math.sin(t),m=Math.cos(t),y=Math.abs(m)>Ee?Math.tan(t):0,w=this.ep2*Math.pow(m,2),T=Math.pow(w,2),E=Math.pow(y,2),P=Math.pow(E,2);e=1-this.es*Math.pow(g,2);var M=s*Math.sqrt(e)/this.k0,N=Math.pow(M,2);e=e*y,i=t-e*N/(1-this.es)*.5*(1-N/12*(5+3*E-9*w*E+w-4*T-N/30*(61+90*E-252*w*E+45*P+46*w-N/56*(1385+3633*E+4095*P+1574*P*E)))),r=Ie(this.long0+M*(1-N/6*(1+2*E+w-N/20*(5+28*E+24*P+8*w*E+6*w-N/42*(61+662*E+1320*P+720*P*E))))/m,this.over)}else i=he*um(o),r=0;else{var a=Math.exp(s/this.k0),c=.5*(a-1/a),h=this.lat0+o/this.k0,d=Math.cos(h);e=Math.sqrt((1-Math.pow(d,2))/(1+Math.pow(c,2))),i=Math.asin(e),o<0&&(i=-i),c===0&&d===0?r=0:r=Ie(Math.atan2(c,d)+this.long0,this.over)}return n.x=r,n.y=i,n}var GJ=["Fast_Transverse_Mercator","Fast Transverse Mercator"];const x0={init:DJ,forward:VJ,inverse:FJ,names:GJ};function p3(n){var e=Math.exp(n);return e=(e-1/e)/2,e}function Di(n,e){n=Math.abs(n),e=Math.abs(e);var t=Math.max(n,e),i=Math.min(n,e)/(t||1);return t*Math.sqrt(1+Math.pow(i,2))}function jJ(n){var e=1+n,t=e-1;return t===0?n:n*Math.log(e)/t}function UJ(n){var e=Math.abs(n);return e=jJ(e*(1+e/(Di(1,e)+1))),n<0?-e:e}function jI(n,e){for(var t=2*Math.cos(2*e),i=n.length-1,r=n[i],s=0,o;--i>=0;)o=-s+t*r+n[i],s=r,r=o;return e+o*Math.sin(2*e)}function BJ(n,e){for(var t=2*Math.cos(e),i=n.length-1,r=n[i],s=0,o;--i>=0;)o=-s+t*r+n[i],s=r,r=o;return Math.sin(e)*o}function zJ(n){var e=Math.exp(n);return e=(e+1/e)/2,e}function _3(n,e,t){for(var i=Math.sin(e),r=Math.cos(e),s=p3(t),o=zJ(t),a=2*r*o,c=-2*i*s,h=n.length-1,d=n[h],g=0,m=0,y=0,w,T;--h>=0;)w=m,T=g,m=d,g=y,d=-w+a*m-c*g+n[h],y=-T+c*m+a*g;return a=i*o,c=r*s,[a*d-c*y,a*y+c*d]}function $J(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(x0.init.apply(this),this.forward=x0.forward,this.inverse=x0.inverse),this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var n=this.es/(1+Math.sqrt(1-this.es)),e=n/(2-n),t=e;this.cgb[0]=e*(2+e*(-2/3+e*(-2+e*(116/45+e*(26/45+e*(-2854/675)))))),this.cbg[0]=e*(-2+e*(2/3+e*(4/3+e*(-82/45+e*(32/45+e*(4642/4725)))))),t=t*e,this.cgb[1]=t*(7/3+e*(-8/5+e*(-227/45+e*(2704/315+e*(2323/945))))),this.cbg[1]=t*(5/3+e*(-16/15+e*(-13/9+e*(904/315+e*(-1522/945))))),t=t*e,this.cgb[2]=t*(56/15+e*(-136/35+e*(-1262/105+e*(73814/2835)))),this.cbg[2]=t*(-26/15+e*(34/21+e*(8/5+e*(-12686/2835)))),t=t*e,this.cgb[3]=t*(4279/630+e*(-332/35+e*(-399572/14175))),this.cbg[3]=t*(1237/630+e*(-12/5+e*(-24832/14175))),t=t*e,this.cgb[4]=t*(4174/315+e*(-144838/6237)),this.cbg[4]=t*(-734/315+e*(109598/31185)),t=t*e,this.cgb[5]=t*(601676/22275),this.cbg[5]=t*(444337/155925),t=Math.pow(e,2),this.Qn=this.k0/(1+e)*(1+t*(1/4+t*(1/64+t/256))),this.utg[0]=e*(-.5+e*(2/3+e*(-37/96+e*(1/360+e*(81/512+e*(-96199/604800)))))),this.gtu[0]=e*(.5+e*(-2/3+e*(5/16+e*(41/180+e*(-127/288+e*(7891/37800)))))),this.utg[1]=t*(-1/48+e*(-1/15+e*(437/1440+e*(-46/105+e*(1118711/3870720))))),this.gtu[1]=t*(13/48+e*(-3/5+e*(557/1440+e*(281/630+e*(-1983433/1935360))))),t=t*e,this.utg[2]=t*(-17/480+e*(37/840+e*(209/4480+e*(-5569/90720)))),this.gtu[2]=t*(61/240+e*(-103/140+e*(15061/26880+e*(167603/181440)))),t=t*e,this.utg[3]=t*(-4397/161280+e*(11/504+e*(830251/7257600))),this.gtu[3]=t*(49561/161280+e*(-179/168+e*(6601661/7257600))),t=t*e,this.utg[4]=t*(-4583/161280+e*(108847/3991680)),this.gtu[4]=t*(34729/80640+e*(-3418889/1995840)),t=t*e,this.utg[5]=t*(-20648693/638668800),this.gtu[5]=t*(212378941/319334400);var i=jI(this.cbg,this.lat0);this.Zb=-this.Qn*(i+BJ(this.gtu,2*i))}function WJ(n){var e=Ie(n.x-this.long0,this.over),t=n.y;t=jI(this.cbg,t);var i=Math.sin(t),r=Math.cos(t),s=Math.sin(e),o=Math.cos(e);t=Math.atan2(i,o*r),e=Math.atan2(s*r,Di(i,r*o)),e=UJ(Math.tan(e));var a=_3(this.gtu,2*t,2*e);t=t+a[0],e=e+a[1];var c,h;return Math.abs(e)<=2.623395162778?(c=this.a*(this.Qn*e)+this.x0,h=this.a*(this.Qn*t+this.Zb)+this.y0):(c=1/0,h=1/0),n.x=c,n.y=h,n}function HJ(n){var e=(n.x-this.x0)*(1/this.a),t=(n.y-this.y0)*(1/this.a);t=(t-this.Zb)/this.Qn,e=e/this.Qn;var i,r;if(Math.abs(e)<=2.623395162778){var s=_3(this.utg,2*t,2*e);t=t+s[0],e=e+s[1],e=Math.atan(p3(e));var o=Math.sin(t),a=Math.cos(t),c=Math.sin(e),h=Math.cos(e);t=Math.atan2(o*h,Di(c,h*a)),e=Math.atan2(c,h*a),i=Ie(e+this.long0,this.over),r=jI(this.cgb,t)}else i=1/0,r=1/0;return n.x=i,n.y=r,n}var KJ=["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","Gauss Kruger","Gauss_Kruger","tmerc"];const S0={init:$J,forward:WJ,inverse:HJ,names:KJ};function qJ(n,e){if(n===void 0){if(n=Math.floor((Ie(e)+Math.PI)*30/Math.PI)+1,n<0)return 0;if(n>60)return 60}return n}var YJ="etmerc";function XJ(){var n=qJ(this.zone,this.long0);if(n===void 0)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(n)-183)*Qt,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,S0.init.apply(this),this.forward=S0.forward,this.inverse=S0.inverse}var QJ=["Universal Transverse Mercator System","utm"];const ZJ={init:XJ,names:QJ,dependsOn:YJ};function UI(n,e){return Math.pow((1-n)/(1+n),e)}var JJ=20;function eee(){var n=Math.sin(this.lat0),e=Math.cos(this.lat0);e*=e,this.rc=Math.sqrt(1-this.es)/(1-this.es*n*n),this.C=Math.sqrt(1+this.es*e*e/(1-this.es)),this.phic0=Math.asin(n/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+pt)/(Math.pow(Math.tan(.5*this.lat0+pt),this.C)*UI(this.e*n,this.ratexp))}function tee(n){var e=n.x,t=n.y;return n.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*t+pt),this.C)*UI(this.e*Math.sin(t),this.ratexp))-he,n.x=this.C*e,n}function nee(n){for(var e=1e-14,t=n.x/this.C,i=n.y,r=Math.pow(Math.tan(.5*i+pt)/this.K,1/this.C),s=JJ;s>0&&(i=2*Math.atan(r*UI(this.e*Math.sin(n.y),-.5*this.e))-he,!(Math.abs(i-n.y)<e));--s)n.y=i;return s?(n.x=t,n.y=i,n):null}const BI={init:eee,forward:tee,inverse:nee};function iee(){BI.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))}function ree(n){var e,t,i,r;return n.x=Ie(n.x-this.long0,this.over),BI.forward.apply(this,[n]),e=Math.sin(n.y),t=Math.cos(n.y),i=Math.cos(n.x),r=this.k0*this.R2/(1+this.sinc0*e+this.cosc0*t*i),n.x=r*t*Math.sin(n.x),n.y=r*(this.cosc0*e-this.sinc0*t*i),n.x=this.a*n.x+this.x0,n.y=this.a*n.y+this.y0,n}function see(n){var e,t,i,r,s;if(n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a,n.x/=this.k0,n.y/=this.k0,s=Di(n.x,n.y)){var o=2*Math.atan2(s,this.R2);e=Math.sin(o),t=Math.cos(o),r=Math.asin(t*this.sinc0+n.y*e*this.cosc0/s),i=Math.atan2(n.x*e,s*this.cosc0*t-n.y*this.sinc0*e)}else r=this.phic0,i=0;return n.x=i,n.y=r,BI.inverse.apply(this,[n]),n.x=Ie(n.x+this.long0,this.over),n}var oee=["Stereographic_North_Pole","Oblique_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"];const aee={init:iee,forward:ree,inverse:see,names:oee};function zI(n,e,t){return e*=t,Math.tan(.5*(he+n))*Math.pow((1-e)/(1+e),.5*t)}function lee(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=Ee&&(this.k0=.5*(1+um(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=Ee&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=Ee&&Math.abs(Math.cos(this.lat_ts))>Ee&&(this.k0=.5*this.cons*Gs(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/Jr(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=Gs(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(zI(this.lat0,this.sinlat0,this.e))-he,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))}function cee(n){var e=n.x,t=n.y,i=Math.sin(t),r=Math.cos(t),s,o,a,c,h,d,g=Ie(e-this.long0,this.over);return Math.abs(Math.abs(e-this.long0)-Math.PI)<=Ee&&Math.abs(t+this.lat0)<=Ee?(n.x=NaN,n.y=NaN,n):this.sphere?(s=2*this.k0/(1+this.sinlat0*i+this.coslat0*r*Math.cos(g)),n.x=this.a*s*r*Math.sin(g)+this.x0,n.y=this.a*s*(this.coslat0*i-this.sinlat0*r*Math.cos(g))+this.y0,n):(o=2*Math.atan(zI(t,i,this.e))-he,c=Math.cos(o),a=Math.sin(o),Math.abs(this.coslat0)<=Ee?(h=Jr(this.e,t*this.con,this.con*i),d=2*this.a*this.k0*h/this.cons,n.x=this.x0+d*Math.sin(e-this.long0),n.y=this.y0-this.con*d*Math.cos(e-this.long0),n):(Math.abs(this.sinlat0)<Ee?(s=2*this.a*this.k0/(1+c*Math.cos(g)),n.y=s*a):(s=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*a+this.cosX0*c*Math.cos(g))),n.y=s*(this.cosX0*a-this.sinX0*c*Math.cos(g))+this.y0),n.x=s*c*Math.sin(g)+this.x0,n))}function uee(n){n.x-=this.x0,n.y-=this.y0;var e,t,i,r,s,o=Math.sqrt(n.x*n.x+n.y*n.y);if(this.sphere){var a=2*Math.atan(o/(2*this.a*this.k0));return e=this.long0,t=this.lat0,o<=Ee?(n.x=e,n.y=t,n):(t=Math.asin(Math.cos(a)*this.sinlat0+n.y*Math.sin(a)*this.coslat0/o),Math.abs(this.coslat0)<Ee?this.lat0>0?e=Ie(this.long0+Math.atan2(n.x,-1*n.y),this.over):e=Ie(this.long0+Math.atan2(n.x,n.y),this.over):e=Ie(this.long0+Math.atan2(n.x*Math.sin(a),o*this.coslat0*Math.cos(a)-n.y*this.sinlat0*Math.sin(a)),this.over),n.x=e,n.y=t,n)}else if(Math.abs(this.coslat0)<=Ee){if(o<=Ee)return t=this.lat0,e=this.long0,n.x=e,n.y=t,n;n.x*=this.con,n.y*=this.con,i=o*this.cons/(2*this.a*this.k0),t=this.con*Ag(this.e,i),e=this.con*Ie(this.con*this.long0+Math.atan2(n.x,-1*n.y),this.over)}else r=2*Math.atan(o*this.cosX0/(2*this.a*this.k0*this.ms1)),e=this.long0,o<=Ee?s=this.X0:(s=Math.asin(Math.cos(r)*this.sinX0+n.y*Math.sin(r)*this.cosX0/o),e=Ie(this.long0+Math.atan2(n.x*Math.sin(r),o*this.cosX0*Math.cos(r)-n.y*this.sinX0*Math.sin(r)),this.over)),t=-1*Ag(this.e,Math.tan(.5*(he+s)));return n.x=e,n.y=t,n}var hee=["stere","Stereographic_South_Pole","Polar_Stereographic_variant_A","Polar_Stereographic_variant_B","Polar_Stereographic"];const dee={init:lee,forward:cee,inverse:uee,names:hee,ssfn_:zI};function fee(){var n=this.lat0;this.lambda0=this.long0;var e=Math.sin(n),t=this.a,i=this.rf,r=1/i,s=2*r-Math.pow(r,2),o=this.e=Math.sqrt(s);this.R=this.k0*t*Math.sqrt(1-s)/(1-s*Math.pow(e,2)),this.alpha=Math.sqrt(1+s/(1-s)*Math.pow(Math.cos(n),4)),this.b0=Math.asin(e/this.alpha);var a=Math.log(Math.tan(Math.PI/4+this.b0/2)),c=Math.log(Math.tan(Math.PI/4+n/2)),h=Math.log((1+o*e)/(1-o*e));this.K=a-this.alpha*c+this.alpha*o/2*h}function gee(n){var e=Math.log(Math.tan(Math.PI/4-n.y/2)),t=this.e/2*Math.log((1+this.e*Math.sin(n.y))/(1-this.e*Math.sin(n.y))),i=-this.alpha*(e+t)+this.K,r=2*(Math.atan(Math.exp(i))-Math.PI/4),s=this.alpha*(n.x-this.lambda0),o=Math.atan(Math.sin(s)/(Math.sin(this.b0)*Math.tan(r)+Math.cos(this.b0)*Math.cos(s))),a=Math.asin(Math.cos(this.b0)*Math.sin(r)-Math.sin(this.b0)*Math.cos(r)*Math.cos(s));return n.y=this.R/2*Math.log((1+Math.sin(a))/(1-Math.sin(a)))+this.y0,n.x=this.R*o+this.x0,n}function mee(n){for(var e=n.x-this.x0,t=n.y-this.y0,i=e/this.R,r=2*(Math.atan(Math.exp(t/this.R))-Math.PI/4),s=Math.asin(Math.cos(this.b0)*Math.sin(r)+Math.sin(this.b0)*Math.cos(r)*Math.cos(i)),o=Math.atan(Math.sin(i)/(Math.cos(this.b0)*Math.cos(i)-Math.sin(this.b0)*Math.tan(r))),a=this.lambda0+o/this.alpha,c=0,h=s,d=-1e3,g=0;Math.abs(h-d)>1e-7;){if(++g>20)return;c=1/this.alpha*(Math.log(Math.tan(Math.PI/4+s/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(h))/2)),d=h,h=2*Math.atan(Math.exp(c))-Math.PI/2}return n.x=a,n.y=h,n}var pee=["somerc"];const _ee={init:fee,forward:gee,inverse:mee,names:pee};var $u=1e-7;function yee(n){var e=["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_variant_A","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"],t=typeof n.projName=="object"?Object.keys(n.projName)[0]:n.projName;return"no_uoff"in n||"no_off"in n||e.indexOf(t)!==-1||e.indexOf(s3(t))!==-1}function vee(){var n,e,t,i,r,s,o,a,c,h,d=0,g,m=0,y=0,w=0,T=0,E=0,P=0;this.no_off=yee(this),this.no_rot="no_rot"in this;var M=!1;"alpha"in this&&(M=!0);var N=!1;if("rectified_grid_angle"in this&&(N=!0),M&&(P=this.alpha),N&&(d=this.rectified_grid_angle),M||N)m=this.longc;else if(y=this.long1,T=this.lat1,w=this.long2,E=this.lat2,Math.abs(T-E)<=$u||(n=Math.abs(T))<=$u||Math.abs(n-he)<=$u||Math.abs(Math.abs(this.lat0)-he)<=$u||Math.abs(Math.abs(E)-he)<=$u)throw new Error;var D=1-this.es;e=Math.sqrt(D),Math.abs(this.lat0)>Ee?(a=Math.sin(this.lat0),t=Math.cos(this.lat0),n=1-this.es*a*a,this.B=t*t,this.B=Math.sqrt(1+this.es*this.B*this.B/D),this.A=this.B*this.k0*e/n,i=this.B*e/(t*Math.sqrt(n)),r=i*i-1,r<=0?r=0:(r=Math.sqrt(r),this.lat0<0&&(r=-r)),this.E=r+=i,this.E*=Math.pow(Jr(this.e,this.lat0,a),this.B)):(this.B=1/e,this.A=this.k0,this.E=i=r=1),M||N?(M?(g=Math.asin(Math.sin(P)/i),N||(d=P)):(g=d,P=Math.asin(i*Math.sin(g))),this.lam0=m-Math.asin(.5*(r-1/r)*Math.tan(g))/this.B):(s=Math.pow(Jr(this.e,T,Math.sin(T)),this.B),o=Math.pow(Jr(this.e,E,Math.sin(E)),this.B),r=this.E/s,c=(o-s)/(o+s),h=this.E*this.E,h=(h-o*s)/(h+o*s),n=y-w,n<-Math.PI?w-=Rg:n>Math.PI&&(w+=Rg),this.lam0=Ie(.5*(y+w)-Math.atan(h*Math.tan(.5*this.B*(y-w))/c)/this.B,this.over),g=Math.atan(2*Math.sin(this.B*Ie(y-this.lam0,this.over))/(r-1/r)),d=P=Math.asin(i*Math.sin(g))),this.singam=Math.sin(g),this.cosgam=Math.cos(g),this.sinrot=Math.sin(d),this.cosrot=Math.cos(d),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(i*i-1)/Math.cos(P))),this.lat0<0&&(this.u_0=-this.u_0)),r=.5*g,this.v_pole_n=this.ArB*Math.log(Math.tan(pt-r)),this.v_pole_s=this.ArB*Math.log(Math.tan(pt+r))}function Eee(n){var e={},t,i,r,s,o,a,c,h;if(n.x=n.x-this.lam0,Math.abs(Math.abs(n.y)-he)>Ee){if(o=this.E/Math.pow(Jr(this.e,n.y,Math.sin(n.y)),this.B),a=1/o,t=.5*(o-a),i=.5*(o+a),s=Math.sin(this.B*n.x),r=(t*this.singam-s*this.cosgam)/i,Math.abs(Math.abs(r)-1)<Ee)throw new Error;h=.5*this.ArB*Math.log((1-r)/(1+r)),a=Math.cos(this.B*n.x),Math.abs(a)<$u?c=this.A*n.x:c=this.ArB*Math.atan2(t*this.cosgam+s*this.singam,a)}else h=n.y>0?this.v_pole_n:this.v_pole_s,c=this.ArB*n.y;return this.no_rot?(e.x=c,e.y=h):(c-=this.u_0,e.x=h*this.cosrot+c*this.sinrot,e.y=c*this.cosrot-h*this.sinrot),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e}function wee(n){var e,t,i,r,s,o,a,c={};if(n.x=(n.x-this.x0)*(1/this.a),n.y=(n.y-this.y0)*(1/this.a),this.no_rot?(t=n.y,e=n.x):(t=n.x*this.cosrot-n.y*this.sinrot,e=n.y*this.cosrot+n.x*this.sinrot+this.u_0),i=Math.exp(-this.BrA*t),r=.5*(i-1/i),s=.5*(i+1/i),o=Math.sin(this.BrA*e),a=(o*this.cosgam+r*this.singam)/s,Math.abs(Math.abs(a)-1)<Ee)c.x=0,c.y=a<0?-he:he;else{if(c.y=this.E/Math.sqrt((1+a)/(1-a)),c.y=Ag(this.e,Math.pow(c.y,1/this.B)),c.y===1/0)throw new Error;c.x=-this.rB*Math.atan2(r*this.cosgam-o*this.singam,Math.cos(this.BrA*e))}return c.x+=this.lam0,c}var xee=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_variant_A","Hotine_Oblique_Mercator_Variant_B","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"];const See={init:vee,forward:Eee,inverse:wee,names:xee};function Iee(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<Ee)){var n=this.b/this.a;this.e=Math.sqrt(1-n*n);var e=Math.sin(this.lat1),t=Math.cos(this.lat1),i=Gs(this.e,e,t),r=Jr(this.e,this.lat1,e),s=Math.sin(this.lat2),o=Math.cos(this.lat2),a=Gs(this.e,s,o),c=Jr(this.e,this.lat2,s),h=Math.abs(Math.abs(this.lat0)-he)<Ee?0:Jr(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>Ee?this.ns=Math.log(i/a)/Math.log(r/c):this.ns=e,isNaN(this.ns)&&(this.ns=e),this.f0=i/(this.ns*Math.pow(r,this.ns)),this.rh=this.a*this.f0*Math.pow(h,this.ns),this.title||(this.title="Lambert Conformal Conic")}}function Tee(n){var e=n.x,t=n.y;Math.abs(2*Math.abs(t)-Math.PI)<=Ee&&(t=um(t)*(he-2*Ee));var i=Math.abs(Math.abs(t)-he),r,s;if(i>Ee)r=Jr(this.e,t,Math.sin(t)),s=this.a*this.f0*Math.pow(r,this.ns);else{if(i=t*this.ns,i<=0)return null;s=0}var o=this.ns*Ie(e-this.long0,this.over);return n.x=this.k0*(s*Math.sin(o))+this.x0,n.y=this.k0*(this.rh-s*Math.cos(o))+this.y0,n}function Ree(n){var e,t,i,r,s,o=(n.x-this.x0)/this.k0,a=this.rh-(n.y-this.y0)/this.k0;this.ns>0?(e=Math.sqrt(o*o+a*a),t=1):(e=-Math.sqrt(o*o+a*a),t=-1);var c=0;if(e!==0&&(c=Math.atan2(t*o,t*a)),e!==0||this.ns>0){if(t=1/this.ns,i=Math.pow(e/(this.a*this.f0),t),r=Ag(this.e,i),r===-9999)return null}else r=-he;return s=Ie(c/this.ns+this.long0,this.over),n.x=s,n.y=r,n}var Pee=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"];const Aee={init:Iee,forward:Tee,inverse:Ree,names:Pee};function Cee(){this.a=6377397155e-3,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.7417649320975901-.308341501185665),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq}function Mee(n){var e,t,i,r,s,o,a,c=n.x,h=n.y,d=Ie(c-this.long0,this.over);return e=Math.pow((1+this.e*Math.sin(h))/(1-this.e*Math.sin(h)),this.alfa*this.e/2),t=2*(Math.atan(this.k*Math.pow(Math.tan(h/2+this.s45),this.alfa)/e)-this.s45),i=-d*this.alfa,r=Math.asin(Math.cos(this.ad)*Math.sin(t)+Math.sin(this.ad)*Math.cos(t)*Math.cos(i)),s=Math.asin(Math.cos(t)*Math.sin(i)/Math.cos(r)),o=this.n*s,a=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(r/2+this.s45),this.n),n.y=a*Math.cos(o)/1,n.x=a*Math.sin(o)/1,this.czech||(n.y*=-1,n.x*=-1),n}function bee(n){var e,t,i,r,s,o,a,c,h=n.x;n.x=n.y,n.y=h,this.czech||(n.y*=-1,n.x*=-1),o=Math.sqrt(n.x*n.x+n.y*n.y),s=Math.atan2(n.y,n.x),r=s/Math.sin(this.s0),i=2*(Math.atan(Math.pow(this.ro0/o,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),e=Math.asin(Math.cos(this.ad)*Math.sin(i)-Math.sin(this.ad)*Math.cos(i)*Math.cos(r)),t=Math.asin(Math.cos(i)*Math.sin(r)/Math.cos(e)),n.x=this.long0-t/this.alfa,a=e,c=0;var d=0;do n.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(e/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(a))/(1-this.e*Math.sin(a)),this.e/2))-this.s45),Math.abs(a-n.y)<1e-10&&(c=1),a=n.y,d+=1;while(c===0&&d<15);return d>=15?null:n}var kee=["Krovak","krovak"];const Lee={init:Cee,forward:Mee,inverse:bee,names:kee};function vi(n,e,t,i,r){return n*r-e*Math.sin(2*r)+t*Math.sin(4*r)-i*Math.sin(6*r)}function hm(n){return 1-.25*n*(1+n/16*(3+1.25*n))}function dm(n){return .375*n*(1+.25*n*(1+.46875*n))}function fm(n){return .05859375*n*n*(1+.75*n)}function gm(n){return n*n*n*(35/3072)}function $I(n,e,t){var i=e*t;return n/Math.sqrt(1-i*i)}function nl(n){return Math.abs(n)<he?n:n-um(n)*Math.PI}function b_(n,e,t,i,r){var s,o;s=n/e;for(var a=0;a<15;a++)if(o=(n-(e*s-t*Math.sin(2*s)+i*Math.sin(4*s)-r*Math.sin(6*s)))/(e-2*t*Math.cos(2*s)+4*i*Math.cos(4*s)-6*r*Math.cos(6*s)),s+=o,Math.abs(o)<=1e-10)return s;return NaN}function Nee(){this.sphere||(this.e0=hm(this.es),this.e1=dm(this.es),this.e2=fm(this.es),this.e3=gm(this.es),this.ml0=this.a*vi(this.e0,this.e1,this.e2,this.e3,this.lat0))}function Oee(n){var e,t,i=n.x,r=n.y;if(i=Ie(i-this.long0,this.over),this.sphere)e=this.a*Math.asin(Math.cos(r)*Math.sin(i)),t=this.a*(Math.atan2(Math.tan(r),Math.cos(i))-this.lat0);else{var s=Math.sin(r),o=Math.cos(r),a=$I(this.a,this.e,s),c=Math.tan(r)*Math.tan(r),h=i*Math.cos(r),d=h*h,g=this.es*o*o/(1-this.es),m=this.a*vi(this.e0,this.e1,this.e2,this.e3,r);e=a*h*(1-d*c*(1/6-(8-c+8*g)*d/120)),t=m-this.ml0+a*s/o*d*(.5+(5-c+6*g)*d/24)}return n.x=e+this.x0,n.y=t+this.y0,n}function Dee(n){n.x-=this.x0,n.y-=this.y0;var e=n.x/this.a,t=n.y/this.a,i,r;if(this.sphere){var s=t+this.lat0;i=Math.asin(Math.sin(s)*Math.cos(e)),r=Math.atan2(Math.tan(e),Math.cos(s))}else{var o=this.ml0/this.a+t,a=b_(o,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(a)-he)<=Ee)return n.x=this.long0,n.y=he,t<0&&(n.y*=-1),n;var c=$I(this.a,this.e,Math.sin(a)),h=c*c*c/this.a/this.a*(1-this.es),d=Math.pow(Math.tan(a),2),g=e*this.a/c,m=g*g;i=a-c*Math.tan(a)/h*g*g*(.5-(1+3*d)*g*g/24),r=g*(1-m*(d/3+(1+3*d)*d*m/15))/Math.cos(a)}return n.x=Ie(r+this.long0,this.over),n.y=nl(i),n}var Vee=["Cassini","Cassini_Soldner","cass"];const Fee={init:Nee,forward:Oee,inverse:Dee,names:Vee};function Fa(n,e){var t;return n>1e-7?(t=n*e,(1-n*n)*(e/(1-t*t)-.5/n*Math.log((1-t)/(1+t)))):2*e}var Jw=1,ex=2,tx=3,I0=4;function Gee(){var n=Math.abs(this.lat0);if(Math.abs(n-he)<Ee?this.mode=this.lat0<0?Jw:ex:Math.abs(n)<Ee?this.mode=tx:this.mode=I0,this.es>0){var e;switch(this.qp=Fa(this.e,1),this.mmf=.5/(1-this.es),this.apa=qee(this.es),this.mode){case ex:this.dd=1;break;case Jw:this.dd=1;break;case tx:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case I0:this.rq=Math.sqrt(.5*this.qp),e=Math.sin(this.lat0),this.sinb1=Fa(this.e,e)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*e*e)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd;break}}else this.mode===I0&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))}function jee(n){var e,t,i,r,s,o,a,c,h,d,g=n.x,m=n.y;if(g=Ie(g-this.long0,this.over),this.sphere){if(s=Math.sin(m),d=Math.cos(m),i=Math.cos(g),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(t=this.mode===this.EQUIT?1+d*i:1+this.sinph0*s+this.cosph0*d*i,t<=Ee)return null;t=Math.sqrt(2/t),e=t*d*Math.sin(g),t*=this.mode===this.EQUIT?s:this.cosph0*s-this.sinph0*d*i}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(i=-i),Math.abs(m+this.lat0)<Ee)return null;t=pt-m*.5,t=2*(this.mode===this.S_POLE?Math.cos(t):Math.sin(t)),e=t*Math.sin(g),t*=i}}else{switch(a=0,c=0,h=0,i=Math.cos(g),r=Math.sin(g),s=Math.sin(m),o=Fa(this.e,s),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(a=o/this.qp,c=Math.sqrt(1-a*a)),this.mode){case this.OBLIQ:h=1+this.sinb1*a+this.cosb1*c*i;break;case this.EQUIT:h=1+c*i;break;case this.N_POLE:h=he+m,o=this.qp-o;break;case this.S_POLE:h=m-he,o=this.qp+o;break}if(Math.abs(h)<Ee)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:h=Math.sqrt(2/h),this.mode===this.OBLIQ?t=this.ymf*h*(this.cosb1*a-this.sinb1*c*i):t=(h=Math.sqrt(2/(1+c*i)))*a*this.ymf,e=this.xmf*h*c*r;break;case this.N_POLE:case this.S_POLE:o>=0?(e=(h=Math.sqrt(o))*r,t=i*(this.mode===this.S_POLE?h:-h)):e=t=0;break}}return n.x=this.a*e+this.x0,n.y=this.a*t+this.y0,n}function Uee(n){n.x-=this.x0,n.y-=this.y0;var e=n.x/this.a,t=n.y/this.a,i,r,s,o,a,c,h;if(this.sphere){var d=0,g,m=0;if(g=Math.sqrt(e*e+t*t),r=g*.5,r>1)return null;switch(r=2*Math.asin(r),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(m=Math.sin(r),d=Math.cos(r)),this.mode){case this.EQUIT:r=Math.abs(g)<=Ee?0:Math.asin(t*m/g),e*=m,t=d*g;break;case this.OBLIQ:r=Math.abs(g)<=Ee?this.lat0:Math.asin(d*this.sinph0+t*m*this.cosph0/g),e*=m*this.cosph0,t=(d-Math.sin(r)*this.sinph0)*g;break;case this.N_POLE:t=-t,r=he-r;break;case this.S_POLE:r-=he;break}i=t===0&&(this.mode===this.EQUIT||this.mode===this.OBLIQ)?0:Math.atan2(e,t)}else{if(h=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(e/=this.dd,t*=this.dd,c=Math.sqrt(e*e+t*t),c<Ee)return n.x=this.long0,n.y=this.lat0,n;o=2*Math.asin(.5*c/this.rq),s=Math.cos(o),e*=o=Math.sin(o),this.mode===this.OBLIQ?(h=s*this.sinb1+t*o*this.cosb1/c,a=this.qp*h,t=c*this.cosb1*s-t*this.sinb1*o):(h=t*o/c,a=this.qp*h,t=c*s)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(t=-t),a=e*e+t*t,!a)return n.x=this.long0,n.y=this.lat0,n;h=1-a/this.qp,this.mode===this.S_POLE&&(h=-h)}i=Math.atan2(e,t),r=Yee(Math.asin(h),this.apa)}return n.x=Ie(this.long0+i,this.over),n.y=r,n}var Bee=.3333333333333333,zee=.17222222222222222,$ee=.10257936507936508,Wee=.06388888888888888,Hee=.0664021164021164,Kee=.016415012942191543;function qee(n){var e,t=[];return t[0]=n*Bee,e=n*n,t[0]+=e*zee,t[1]=e*Wee,e*=n,t[0]+=e*$ee,t[1]+=e*Hee,t[2]=e*Kee,t}function Yee(n,e){var t=n+n;return n+e[0]*Math.sin(t)+e[1]*Math.sin(t+t)+e[2]*Math.sin(t+t+t)}var Xee=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"];const Qee={init:Gee,forward:jee,inverse:Uee,names:Xee,S_POLE:Jw,N_POLE:ex,EQUIT:tx,OBLIQ:I0};function Qa(n){return Math.abs(n)>1&&(n=n>1?1:-1),Math.asin(n)}function Zee(){Math.abs(this.lat1+this.lat2)<Ee||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=Gs(this.e3,this.sin_po,this.cos_po),this.qs1=Fa(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=Gs(this.e3,this.sin_po,this.cos_po),this.qs2=Fa(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=Fa(this.e3,this.sin_po),Math.abs(this.lat1-this.lat2)>Ee?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)}function Jee(n){var e=n.x,t=n.y;this.sin_phi=Math.sin(t),this.cos_phi=Math.cos(t);var i=Fa(this.e3,this.sin_phi),r=this.a*Math.sqrt(this.c-this.ns0*i)/this.ns0,s=this.ns0*Ie(e-this.long0,this.over),o=r*Math.sin(s)+this.x0,a=this.rh-r*Math.cos(s)+this.y0;return n.x=o,n.y=a,n}function ete(n){var e,t,i,r,s,o;return n.x-=this.x0,n.y=this.rh-n.y+this.y0,this.ns0>=0?(e=Math.sqrt(n.x*n.x+n.y*n.y),i=1):(e=-Math.sqrt(n.x*n.x+n.y*n.y),i=-1),r=0,e!==0&&(r=Math.atan2(i*n.x,i*n.y)),i=e*this.ns0/this.a,this.sphere?o=Math.asin((this.c-i*i)/(2*this.ns0)):(t=(this.c-i*i)/this.ns0,o=this.phi1z(this.e3,t)),s=Ie(r/this.ns0+this.long0,this.over),n.x=s,n.y=o,n}function tte(n,e){var t,i,r,s,o,a=Qa(.5*e);if(n<Ee)return a;for(var c=n*n,h=1;h<=25;h++)if(t=Math.sin(a),i=Math.cos(a),r=n*t,s=1-r*r,o=.5*s*s/i*(e/(1-c)-t/s+.5/n*Math.log((1-r)/(1+r))),a=a+o,Math.abs(o)<=1e-7)return a;return null}var nte=["Albers_Conic_Equal_Area","Albers_Equal_Area","Albers","aea"];const ite={init:Zee,forward:Jee,inverse:ete,names:nte,phi1z:tte};function rte(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1}function ste(n){var e,t,i,r,s,o,a,c,h=n.x,d=n.y;return i=Ie(h-this.long0,this.over),e=Math.sin(d),t=Math.cos(d),r=Math.cos(i),o=this.sin_p14*e+this.cos_p14*t*r,s=1,o>0||Math.abs(o)<=Ee?(a=this.x0+this.a*s*t*Math.sin(i)/o,c=this.y0+this.a*s*(this.cos_p14*e-this.sin_p14*t*r)/o):(a=this.x0+this.infinity_dist*t*Math.sin(i),c=this.y0+this.infinity_dist*(this.cos_p14*e-this.sin_p14*t*r)),n.x=a,n.y=c,n}function ote(n){var e,t,i,r,s,o;return n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a,n.x/=this.k0,n.y/=this.k0,(e=Math.sqrt(n.x*n.x+n.y*n.y))?(r=Math.atan2(e,this.rc),t=Math.sin(r),i=Math.cos(r),o=Qa(i*this.sin_p14+n.y*t*this.cos_p14/e),s=Math.atan2(n.x*t,e*this.cos_p14*i-n.y*this.sin_p14*t),s=Ie(this.long0+s,this.over)):(o=this.phic0,s=0),n.x=s,n.y=o,n}var ate=["gnom"];const lte={init:rte,forward:ste,inverse:ote,names:ate};function cte(n,e){var t=1-(1-n*n)/(2*n)*Math.log((1-n)/(1+n));if(Math.abs(Math.abs(e)-t)<1e-6)return e<0?-1*he:he;for(var i=Math.asin(.5*e),r,s,o,a,c=0;c<30;c++)if(s=Math.sin(i),o=Math.cos(i),a=n*s,r=Math.pow(1-a*a,2)/(2*o)*(e/(1-n*n)-s/(1-a*a)+.5/n*Math.log((1-a)/(1+a))),i+=r,Math.abs(r)<=1e-10)return i;return NaN}function ute(){this.sphere||(this.k0=Gs(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))}function hte(n){var e=n.x,t=n.y,i,r,s=Ie(e-this.long0,this.over);if(this.sphere)i=this.x0+this.a*s*Math.cos(this.lat_ts),r=this.y0+this.a*Math.sin(t)/Math.cos(this.lat_ts);else{var o=Fa(this.e,Math.sin(t));i=this.x0+this.a*this.k0*s,r=this.y0+this.a*o*.5/this.k0}return n.x=i,n.y=r,n}function dte(n){n.x-=this.x0,n.y-=this.y0;var e,t;return this.sphere?(e=Ie(this.long0+n.x/this.a/Math.cos(this.lat_ts),this.over),t=Math.asin(n.y/this.a*Math.cos(this.lat_ts))):(t=cte(this.e,2*n.y*this.k0/this.a),e=Ie(this.long0+n.x/(this.a*this.k0),this.over)),n.x=e,n.y=t,n}var fte=["cea"];const gte={init:ute,forward:hte,inverse:dte,names:fte};function mte(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)}function pte(n){var e=n.x,t=n.y,i=Ie(e-this.long0,this.over),r=nl(t-this.lat0);return n.x=this.x0+this.a*i*this.rc,n.y=this.y0+this.a*r,n}function _te(n){var e=n.x,t=n.y;return n.x=Ie(this.long0+(e-this.x0)/(this.a*this.rc),this.over),n.y=nl(this.lat0+(t-this.y0)/this.a),n}var yte=["Equirectangular","Equidistant_Cylindrical","Equidistant_Cylindrical_Spherical","eqc"];const vte={init:mte,forward:pte,inverse:_te,names:yte};var mb=20;function Ete(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=hm(this.es),this.e1=dm(this.es),this.e2=fm(this.es),this.e3=gm(this.es),this.ml0=this.a*vi(this.e0,this.e1,this.e2,this.e3,this.lat0)}function wte(n){var e=n.x,t=n.y,i,r,s,o=Ie(e-this.long0,this.over);if(s=o*Math.sin(t),this.sphere)Math.abs(t)<=Ee?(i=this.a*o,r=-1*this.a*this.lat0):(i=this.a*Math.sin(s)/Math.tan(t),r=this.a*(nl(t-this.lat0)+(1-Math.cos(s))/Math.tan(t)));else if(Math.abs(t)<=Ee)i=this.a*o,r=-1*this.ml0;else{var a=$I(this.a,this.e,Math.sin(t))/Math.tan(t);i=a*Math.sin(s),r=this.a*vi(this.e0,this.e1,this.e2,this.e3,t)-this.ml0+a*(1-Math.cos(s))}return n.x=i+this.x0,n.y=r+this.y0,n}function xte(n){var e,t,i,r,s,o,a,c,h;if(i=n.x-this.x0,r=n.y-this.y0,this.sphere)if(Math.abs(r+this.a*this.lat0)<=Ee)e=Ie(i/this.a+this.long0,this.over),t=0;else{o=this.lat0+r/this.a,a=i*i/this.a/this.a+o*o,c=o;var d;for(s=mb;s;--s)if(d=Math.tan(c),h=-1*(o*(c*d+1)-c-.5*(c*c+a)*d)/((c-o)/d-1),c+=h,Math.abs(h)<=Ee){t=c;break}e=Ie(this.long0+Math.asin(i*Math.tan(c)/this.a)/Math.sin(t),this.over)}else if(Math.abs(r+this.ml0)<=Ee)t=0,e=Ie(this.long0+i/this.a,this.over);else{o=(this.ml0+r)/this.a,a=i*i/this.a/this.a+o*o,c=o;var g,m,y,w,T;for(s=mb;s;--s)if(T=this.e*Math.sin(c),g=Math.sqrt(1-T*T)*Math.tan(c),m=this.a*vi(this.e0,this.e1,this.e2,this.e3,c),y=this.e0-2*this.e1*Math.cos(2*c)+4*this.e2*Math.cos(4*c)-6*this.e3*Math.cos(6*c),w=m/this.a,h=(o*(g*w+1)-w-.5*g*(w*w+a))/(this.es*Math.sin(2*c)*(w*w+a-2*o*w)/(4*g)+(o-w)*(g*y-2/Math.sin(2*c))-y),c-=h,Math.abs(h)<=Ee){t=c;break}g=Math.sqrt(1-this.es*Math.pow(Math.sin(t),2))*Math.tan(t),e=Ie(this.long0+Math.asin(i*g/this.a)/Math.sin(t),this.over)}return n.x=e,n.y=t,n}var Ste=["Polyconic","American_Polyconic","poly"];const Ite={init:Ete,forward:wte,inverse:xte,names:Ste};function Tte(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013}function Rte(n){var e,t=n.x,i=n.y,r=i-this.lat0,s=t-this.long0,o=r/Df*1e-5,a=s,c=1,h=0;for(e=1;e<=10;e++)c=c*o,h=h+this.A[e]*c;var d=h,g=a,m=1,y=0,w,T,E=0,P=0;for(e=1;e<=6;e++)w=m*d-y*g,T=y*d+m*g,m=w,y=T,E=E+this.B_re[e]*m-this.B_im[e]*y,P=P+this.B_im[e]*m+this.B_re[e]*y;return n.x=P*this.a+this.x0,n.y=E*this.a+this.y0,n}function Pte(n){var e,t=n.x,i=n.y,r=t-this.x0,s=i-this.y0,o=s/this.a,a=r/this.a,c=1,h=0,d,g,m=0,y=0;for(e=1;e<=6;e++)d=c*o-h*a,g=h*o+c*a,c=d,h=g,m=m+this.C_re[e]*c-this.C_im[e]*h,y=y+this.C_im[e]*c+this.C_re[e]*h;for(var w=0;w<this.iterations;w++){var T=m,E=y,P,M,N=o,D=a;for(e=2;e<=6;e++)P=T*m-E*y,M=E*m+T*y,T=P,E=M,N=N+(e-1)*(this.B_re[e]*T-this.B_im[e]*E),D=D+(e-1)*(this.B_im[e]*T+this.B_re[e]*E);T=1,E=0;var j=this.B_re[1],W=this.B_im[1];for(e=2;e<=6;e++)P=T*m-E*y,M=E*m+T*y,T=P,E=M,j=j+e*(this.B_re[e]*T-this.B_im[e]*E),W=W+e*(this.B_im[e]*T+this.B_re[e]*E);var L=j*j+W*W;m=(N*j+D*W)/L,y=(D*j-N*W)/L}var A=m,k=y,U=1,B=0;for(e=1;e<=9;e++)U=U*A,B=B+this.D[e]*U;var z=this.lat0+B*Df*1e5,O=this.long0+k;return n.x=O,n.y=z,n}var Ate=["New_Zealand_Map_Grid","nzmg"];const Cte={init:Tte,forward:Rte,inverse:Pte,names:Ate};function Mte(){}function bte(n){var e=n.x,t=n.y,i=Ie(e-this.long0,this.over),r=this.x0+this.a*i,s=this.y0+this.a*Math.log(Math.tan(Math.PI/4+t/2.5))*1.25;return n.x=r,n.y=s,n}function kte(n){n.x-=this.x0,n.y-=this.y0;var e=Ie(this.long0+n.x/this.a,this.over),t=2.5*(Math.atan(Math.exp(.8*n.y/this.a))-Math.PI/4);return n.x=e,n.y=t,n}var Lte=["Miller_Cylindrical","mill"];const Nte={init:Mte,forward:bte,inverse:kte,names:Lte};var Ote=20;function Dte(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=FI(this.es)}function Vte(n){var e,t,i=n.x,r=n.y;if(i=Ie(i-this.long0,this.over),this.sphere){if(!this.m)r=this.n!==1?Math.asin(this.n*Math.sin(r)):r;else for(var s=this.n*Math.sin(r),o=Ote;o;--o){var a=(this.m*r+Math.sin(r)-s)/(this.m+Math.cos(r));if(r-=a,Math.abs(a)<Ee)break}e=this.a*this.C_x*i*(this.m+Math.cos(r)),t=this.a*this.C_y*r}else{var c=Math.sin(r),h=Math.cos(r);t=this.a*Qh(r,c,h,this.en),e=this.a*i*h/Math.sqrt(1-this.es*c*c)}return n.x=e,n.y=t,n}function Fte(n){var e,t,i,r;return n.x-=this.x0,i=n.x/this.a,n.y-=this.y0,e=n.y/this.a,this.sphere?(e/=this.C_y,i=i/(this.C_x*(this.m+Math.cos(e))),this.m?e=Qa((this.m*e+Math.sin(e))/this.n):this.n!==1&&(e=Qa(Math.sin(e)/this.n)),i=Ie(i+this.long0,this.over),e=nl(e)):(e=GI(n.y/this.a,this.es,this.en),r=Math.abs(e),r<he?(r=Math.sin(e),t=this.long0+n.x*Math.sqrt(1-this.es*r*r)/(this.a*Math.cos(e)),i=Ie(t,this.over)):r-Ee<he&&(i=this.long0)),n.x=i,n.y=e,n}var Gte=["Sinusoidal","sinu"];const jte={init:Dte,forward:Vte,inverse:Fte,names:Gte};function Ute(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0}function Bte(n){for(var e=n.x,t=n.y,i=Ie(e-this.long0,this.over),r=t,s=Math.PI*Math.sin(t);;){var o=-(r+Math.sin(r)-s)/(1+Math.cos(r));if(r+=o,Math.abs(o)<Ee)break}r/=2,Math.PI/2-Math.abs(t)<Ee&&(i=0);var a=.900316316158*this.a*i*Math.cos(r)+this.x0,c=1.4142135623731*this.a*Math.sin(r)+this.y0;return n.x=a,n.y=c,n}function zte(n){var e,t;n.x-=this.x0,n.y-=this.y0,t=n.y/(1.4142135623731*this.a),Math.abs(t)>.999999999999&&(t=.999999999999),e=Math.asin(t);var i=Ie(this.long0+n.x/(.900316316158*this.a*Math.cos(e)),this.over);i<-Math.PI&&(i=-Math.PI),i>Math.PI&&(i=Math.PI),t=(2*e+Math.sin(2*e))/Math.PI,Math.abs(t)>1&&(t=1);var r=Math.asin(t);return n.x=i,n.y=r,n}var $te=["Mollweide","moll"];const Wte={init:Ute,forward:Bte,inverse:zte,names:$te};function Hte(){Math.abs(this.lat1+this.lat2)<Ee||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=hm(this.es),this.e1=dm(this.es),this.e2=fm(this.es),this.e3=gm(this.es),this.sin_phi=Math.sin(this.lat1),this.cos_phi=Math.cos(this.lat1),this.ms1=Gs(this.e,this.sin_phi,this.cos_phi),this.ml1=vi(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<Ee?this.ns=this.sin_phi:(this.sin_phi=Math.sin(this.lat2),this.cos_phi=Math.cos(this.lat2),this.ms2=Gs(this.e,this.sin_phi,this.cos_phi),this.ml2=vi(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=vi(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))}function Kte(n){var e=n.x,t=n.y,i;if(this.sphere)i=this.a*(this.g-t);else{var r=vi(this.e0,this.e1,this.e2,this.e3,t);i=this.a*(this.g-r)}var s=this.ns*Ie(e-this.long0,this.over),o=this.x0+i*Math.sin(s),a=this.y0+this.rh-i*Math.cos(s);return n.x=o,n.y=a,n}function qte(n){n.x-=this.x0,n.y=this.rh-n.y+this.y0;var e,t,i,r;this.ns>=0?(t=Math.sqrt(n.x*n.x+n.y*n.y),e=1):(t=-Math.sqrt(n.x*n.x+n.y*n.y),e=-1);var s=0;if(t!==0&&(s=Math.atan2(e*n.x,e*n.y)),this.sphere)return r=Ie(this.long0+s/this.ns,this.over),i=nl(this.g-t/this.a),n.x=r,n.y=i,n;var o=this.g-t/this.a;return i=b_(o,this.e0,this.e1,this.e2,this.e3),r=Ie(this.long0+s/this.ns,this.over),n.x=r,n.y=i,n}var Yte=["Equidistant_Conic","eqdc"];const Xte={init:Hte,forward:Kte,inverse:qte,names:Yte};function Qte(){this.R=this.a}function Zte(n){var e=n.x,t=n.y,i=Ie(e-this.long0,this.over),r,s;Math.abs(t)<=Ee&&(r=this.x0+this.R*i,s=this.y0);var o=Qa(2*Math.abs(t/Math.PI));(Math.abs(i)<=Ee||Math.abs(Math.abs(t)-he)<=Ee)&&(r=this.x0,t>=0?s=this.y0+Math.PI*this.R*Math.tan(.5*o):s=this.y0+Math.PI*this.R*-Math.tan(.5*o));var a=.5*Math.abs(Math.PI/i-i/Math.PI),c=a*a,h=Math.sin(o),d=Math.cos(o),g=d/(h+d-1),m=g*g,y=g*(2/h-1),w=y*y,T=Math.PI*this.R*(a*(g-w)+Math.sqrt(c*(g-w)*(g-w)-(w+c)*(m-w)))/(w+c);i<0&&(T=-T),r=this.x0+T;var E=c+g;return T=Math.PI*this.R*(y*E-a*Math.sqrt((w+c)*(c+1)-E*E))/(w+c),t>=0?s=this.y0+T:s=this.y0-T,n.x=r,n.y=s,n}function Jte(n){var e,t,i,r,s,o,a,c,h,d,g,m,y;return n.x-=this.x0,n.y-=this.y0,g=Math.PI*this.R,i=n.x/g,r=n.y/g,s=i*i+r*r,o=-Math.abs(r)*(1+s),a=o-2*r*r+i*i,c=-2*o+1+2*r*r+s*s,y=r*r/c+(2*a*a*a/c/c/c-9*o*a/c/c)/27,h=(o-a*a/3/c)/c,d=2*Math.sqrt(-h/3),g=3*y/h/d,Math.abs(g)>1&&(g>=0?g=1:g=-1),m=Math.acos(g)/3,n.y>=0?t=(-d*Math.cos(m+Math.PI/3)-a/3/c)*Math.PI:t=-(-d*Math.cos(m+Math.PI/3)-a/3/c)*Math.PI,Math.abs(i)<Ee?e=this.long0:e=Ie(this.long0+Math.PI*(s-1+Math.sqrt(1+2*(i*i-r*r)+s*s))/2/i,this.over),n.x=e,n.y=t,n}var ene=["Van_der_Grinten_I","VanDerGrinten","Van_der_Grinten","vandg"];const tne={init:Qte,forward:Zte,inverse:Jte,names:ene};function nne(n,e,t,i,r,s){const o=i-e,a=Math.atan((1-s)*Math.tan(n)),c=Math.atan((1-s)*Math.tan(t)),h=Math.sin(a),d=Math.cos(a),g=Math.sin(c),m=Math.cos(c);let y=o,w,T=100,E,P,M,N,D,j,W,L,A,k,U,B,z,O;do{if(E=Math.sin(y),P=Math.cos(y),M=Math.sqrt(m*E*(m*E)+(d*g-h*m*P)*(d*g-h*m*P)),M===0)return{azi1:0,s12:0};N=h*g+d*m*P,D=Math.atan2(M,N),j=d*m*E/M,W=1-j*j,L=W!==0?N-2*h*g/W:0,A=s/16*W*(4+s*(4-3*W)),w=y,y=o+(1-A)*s*j*(D+A*M*(L+A*N*(-1+2*L*L)))}while(Math.abs(y-w)>1e-12&&--T>0);return T===0?{azi1:NaN,s12:NaN}:(k=W*(r*r-r*(1-s)*(r*(1-s)))/(r*(1-s)*(r*(1-s))),U=1+k/16384*(4096+k*(-768+k*(320-175*k))),B=k/1024*(256+k*(-128+k*(74-47*k))),z=B*M*(L+B/4*(N*(-1+2*L*L)-B/6*L*(-3+4*M*M)*(-3+4*L*L))),O=r*(1-s)*U*(D-z),{azi1:Math.atan2(m*E,d*g-h*m*P),s12:O})}function ine(n,e,t,i,r,s){const o=Math.atan((1-s)*Math.tan(n)),a=Math.sin(o),c=Math.cos(o),h=Math.sin(t),d=Math.cos(t),g=Math.atan2(a,c*d),m=c*h,y=1-m*m,w=y*(r*r-r*(1-s)*(r*(1-s)))/(r*(1-s)*(r*(1-s))),T=1+w/16384*(4096+w*(-768+w*(320-175*w))),E=w/1024*(256+w*(-128+w*(74-47*w)));let P=i/(r*(1-s)*T),M,N=100,D,j,W,L;do D=Math.cos(2*g+P),j=Math.sin(P),W=Math.cos(P),L=E*j*(D+E/4*(W*(-1+2*D*D)-E/6*D*(-3+4*j*j)*(-3+4*D*D))),M=P,P=i/(r*(1-s)*T)+L;while(Math.abs(P-M)>1e-12&&--N>0);if(N===0)return{lat2:NaN,lon2:NaN};const A=a*j-c*W*d,k=Math.atan2(a*W+c*j*d,(1-s)*Math.sqrt(m*m+A*A)),U=Math.atan2(j*h,c*W-a*j*d),B=s/16*y*(4+s*(4-3*y)),z=U-(1-B)*s*m*(P+B*j*(D+B*W*(-1+2*D*D))),O=e+z;return{lat2:k,lon2:O}}function rne(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0),this.f=this.es/(1+Math.sqrt(1-this.es))}function sne(n){var e=n.x,t=n.y,i=Math.sin(n.y),r=Math.cos(n.y),s=Ie(e-this.long0,this.over),o,a,c,h,d,g,m,y,w,T,E;return this.sphere?Math.abs(this.sin_p12-1)<=Ee?(n.x=this.x0+this.a*(he-t)*Math.sin(s),n.y=this.y0-this.a*(he-t)*Math.cos(s),n):Math.abs(this.sin_p12+1)<=Ee?(n.x=this.x0+this.a*(he+t)*Math.sin(s),n.y=this.y0+this.a*(he+t)*Math.cos(s),n):(w=this.sin_p12*i+this.cos_p12*r*Math.cos(s),m=Math.acos(w),y=m?m/Math.sin(m):1,n.x=this.x0+this.a*y*r*Math.sin(s),n.y=this.y0+this.a*y*(this.cos_p12*i-this.sin_p12*r*Math.cos(s)),n):(o=hm(this.es),a=dm(this.es),c=fm(this.es),h=gm(this.es),Math.abs(this.sin_p12-1)<=Ee?(d=this.a*vi(o,a,c,h,he),g=this.a*vi(o,a,c,h,t),n.x=this.x0+(d-g)*Math.sin(s),n.y=this.y0-(d-g)*Math.cos(s),n):Math.abs(this.sin_p12+1)<=Ee?(d=this.a*vi(o,a,c,h,he),g=this.a*vi(o,a,c,h,t),n.x=this.x0+(d+g)*Math.sin(s),n.y=this.y0+(d+g)*Math.cos(s),n):Math.abs(e)<Ee&&Math.abs(t-this.lat0)<Ee?(n.x=n.y=0,n):(T=nne(this.lat0,this.long0,t,e,this.a,this.f),E=T.azi1,n.x=T.s12*Math.sin(E),n.y=T.s12*Math.cos(E),n))}function one(n){n.x-=this.x0,n.y-=this.y0;var e,t,i,r,s,o,a,c,h,d,g,m,y,w,T,E;return this.sphere?(e=Math.sqrt(n.x*n.x+n.y*n.y),e>2*he*this.a?void 0:(t=e/this.a,i=Math.sin(t),r=Math.cos(t),s=this.long0,Math.abs(e)<=Ee?o=this.lat0:(o=Qa(r*this.sin_p12+n.y*i*this.cos_p12/e),a=Math.abs(this.lat0)-he,Math.abs(a)<=Ee?this.lat0>=0?s=Ie(this.long0+Math.atan2(n.x,-n.y),this.over):s=Ie(this.long0-Math.atan2(-n.x,n.y),this.over):s=Ie(this.long0+Math.atan2(n.x*i,e*this.cos_p12*r-n.y*this.sin_p12*i),this.over)),n.x=s,n.y=o,n)):(c=hm(this.es),h=dm(this.es),d=fm(this.es),g=gm(this.es),Math.abs(this.sin_p12-1)<=Ee?(m=this.a*vi(c,h,d,g,he),e=Math.sqrt(n.x*n.x+n.y*n.y),y=m-e,o=b_(y/this.a,c,h,d,g),s=Ie(this.long0+Math.atan2(n.x,-1*n.y),this.over),n.x=s,n.y=o,n):Math.abs(this.sin_p12+1)<=Ee?(m=this.a*vi(c,h,d,g,he),e=Math.sqrt(n.x*n.x+n.y*n.y),y=e-m,o=b_(y/this.a,c,h,d,g),s=Ie(this.long0+Math.atan2(n.x,n.y),this.over),n.x=s,n.y=o,n):(w=Math.atan2(n.x,n.y),T=Math.sqrt(n.x*n.x+n.y*n.y),E=ine(this.lat0,this.long0,w,T,this.a,this.f),n.x=E.lon2,n.y=E.lat2,n))}var ane=["Azimuthal_Equidistant","aeqd"];const lne={init:rne,forward:sne,inverse:one,names:ane};function cne(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)}function une(n){var e,t,i,r,s,o,a,c,h=n.x,d=n.y;return i=Ie(h-this.long0,this.over),e=Math.sin(d),t=Math.cos(d),r=Math.cos(i),o=this.sin_p14*e+this.cos_p14*t*r,s=1,(o>0||Math.abs(o)<=Ee)&&(a=this.a*s*t*Math.sin(i),c=this.y0+this.a*s*(this.cos_p14*e-this.sin_p14*t*r)),n.x=a,n.y=c,n}function hne(n){var e,t,i,r,s,o,a;return n.x-=this.x0,n.y-=this.y0,e=Math.sqrt(n.x*n.x+n.y*n.y),t=Qa(e/this.a),i=Math.sin(t),r=Math.cos(t),o=this.long0,Math.abs(e)<=Ee?(a=this.lat0,n.x=o,n.y=a,n):(a=Qa(r*this.sin_p14+n.y*i*this.cos_p14/e),s=Math.abs(this.lat0)-he,Math.abs(s)<=Ee?(this.lat0>=0?o=Ie(this.long0+Math.atan2(n.x,-n.y),this.over):o=Ie(this.long0-Math.atan2(-n.x,n.y),this.over),n.x=o,n.y=a,n):(o=Ie(this.long0+Math.atan2(n.x*i,e*this.cos_p14*r-n.y*this.sin_p14*i),this.over),n.x=o,n.y=a,n))}var dne=["ortho"];const fne={init:cne,forward:une,inverse:hne,names:dne};var Ht={FRONT:1,RIGHT:2,BACK:3,LEFT:4,TOP:5,BOTTOM:6},_t={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4};function gne(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=he-pt/2?this.face=Ht.TOP:this.lat0<=-(he-pt/2)?this.face=Ht.BOTTOM:Math.abs(this.long0)<=pt?this.face=Ht.FRONT:Math.abs(this.long0)<=he+pt?this.face=this.long0>0?Ht.RIGHT:Ht.LEFT:this.face=Ht.BACK,this.es!==0&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)}function mne(n){var e={x:0,y:0},t,i,r,s,o,a,c={value:0};if(n.x-=this.long0,this.es!==0?t=Math.atan(this.one_minus_f_squared*Math.tan(n.y)):t=n.y,i=n.x,this.face===Ht.TOP)s=he-t,i>=pt&&i<=he+pt?(c.value=_t.AREA_0,r=i-he):i>he+pt||i<=-(he+pt)?(c.value=_t.AREA_1,r=i>0?i-an:i+an):i>-(he+pt)&&i<=-pt?(c.value=_t.AREA_2,r=i+he):(c.value=_t.AREA_3,r=i);else if(this.face===Ht.BOTTOM)s=he+t,i>=pt&&i<=he+pt?(c.value=_t.AREA_0,r=-i+he):i<pt&&i>=-pt?(c.value=_t.AREA_1,r=-i):i<-pt&&i>=-(he+pt)?(c.value=_t.AREA_2,r=-i-he):(c.value=_t.AREA_3,r=i>0?-i+an:-i-an);else{var h,d,g,m,y,w,T;this.face===Ht.RIGHT?i=dh(i,+he):this.face===Ht.BACK?i=dh(i,+an):this.face===Ht.LEFT&&(i=dh(i,-he)),m=Math.sin(t),y=Math.cos(t),w=Math.sin(i),T=Math.cos(i),h=y*T,d=y*w,g=m,this.face===Ht.FRONT?(s=Math.acos(h),r=Zp(s,g,d,c)):this.face===Ht.RIGHT?(s=Math.acos(d),r=Zp(s,g,-h,c)):this.face===Ht.BACK?(s=Math.acos(-h),r=Zp(s,g,-d,c)):this.face===Ht.LEFT?(s=Math.acos(-d),r=Zp(s,g,h,c)):(s=r=0,c.value=_t.AREA_0)}return a=Math.atan(12/an*(r+Math.acos(Math.sin(r)*Math.cos(pt))-he)),o=Math.sqrt((1-Math.cos(s))/(Math.cos(a)*Math.cos(a))/(1-Math.cos(Math.atan(1/Math.cos(r))))),c.value===_t.AREA_1?a+=he:c.value===_t.AREA_2?a+=an:c.value===_t.AREA_3&&(a+=1.5*an),e.x=o*Math.cos(a),e.y=o*Math.sin(a),e.x=e.x*this.a+this.x0,e.y=e.y*this.a+this.y0,n.x=e.x,n.y=e.y,n}function pne(n){var e={lam:0,phi:0},t,i,r,s,o,a,c,h,d,g={value:0};if(n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a,i=Math.atan(Math.sqrt(n.x*n.x+n.y*n.y)),t=Math.atan2(n.y,n.x),n.x>=0&&n.x>=Math.abs(n.y)?g.value=_t.AREA_0:n.y>=0&&n.y>=Math.abs(n.x)?(g.value=_t.AREA_1,t-=he):n.x<0&&-n.x>=Math.abs(n.y)?(g.value=_t.AREA_2,t=t<0?t+an:t-an):(g.value=_t.AREA_3,t+=he),d=an/12*Math.tan(t),o=Math.sin(d)/(Math.cos(d)-1/Math.sqrt(2)),a=Math.atan(o),r=Math.cos(t),s=Math.tan(i),c=1-r*r*s*s*(1-Math.cos(Math.atan(1/Math.cos(a)))),c<-1?c=-1:c>1&&(c=1),this.face===Ht.TOP)h=Math.acos(c),e.phi=he-h,g.value===_t.AREA_0?e.lam=a+he:g.value===_t.AREA_1?e.lam=a<0?a+an:a-an:g.value===_t.AREA_2?e.lam=a-he:e.lam=a;else if(this.face===Ht.BOTTOM)h=Math.acos(c),e.phi=h-he,g.value===_t.AREA_0?e.lam=-a+he:g.value===_t.AREA_1?e.lam=-a:g.value===_t.AREA_2?e.lam=-a-he:e.lam=a<0?-a-an:-a+an;else{var m,y,w;m=c,d=m*m,d>=1?w=0:w=Math.sqrt(1-d)*Math.sin(a),d+=w*w,d>=1?y=0:y=Math.sqrt(1-d),g.value===_t.AREA_1?(d=y,y=-w,w=d):g.value===_t.AREA_2?(y=-y,w=-w):g.value===_t.AREA_3&&(d=y,y=w,w=-d),this.face===Ht.RIGHT?(d=m,m=-y,y=d):this.face===Ht.BACK?(m=-m,y=-y):this.face===Ht.LEFT&&(d=m,m=y,y=-d),e.phi=Math.acos(-w)-he,e.lam=Math.atan2(y,m),this.face===Ht.RIGHT?e.lam=dh(e.lam,-he):this.face===Ht.BACK?e.lam=dh(e.lam,-an):this.face===Ht.LEFT&&(e.lam=dh(e.lam,+he))}if(this.es!==0){var T,E,P;T=e.phi<0?1:0,E=Math.tan(e.phi),P=this.b/Math.sqrt(E*E+this.one_minus_f_squared),e.phi=Math.atan(Math.sqrt(this.a*this.a-P*P)/(this.one_minus_f*P)),T&&(e.phi=-e.phi)}return e.lam+=this.long0,n.x=e.lam,n.y=e.phi,n}function Zp(n,e,t,i){var r;return n<Ee?(i.value=_t.AREA_0,r=0):(r=Math.atan2(e,t),Math.abs(r)<=pt?i.value=_t.AREA_0:r>pt&&r<=he+pt?(i.value=_t.AREA_1,r-=he):r>he+pt||r<=-(he+pt)?(i.value=_t.AREA_2,r=r>=0?r-an:r+an):(i.value=_t.AREA_3,r+=he)),r}function dh(n,e){var t=n+e;return t<-an?t+=Rg:t>+an&&(t-=Rg),t}var _ne=["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"];const yne={init:gne,forward:mne,inverse:pne,names:_ne};var nx=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-986701e-12],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,18736e-12],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,934959e-12],[.7986,-.00755338,-500009e-10,935324e-12],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],yf=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-126793e-14,422642e-15],[.124,.0124,507171e-14,-160604e-14],[.186,.0123999,-190189e-13,600152e-14],[.248,.0124002,710039e-13,-224e-10],[.31,.0123992,-264997e-12,835986e-13],[.372,.0124029,988983e-12,-311994e-12],[.434,.0123893,-369093e-11,-435621e-12],[.4958,.0123198,-102252e-10,-345523e-12],[.5571,.0121916,-154081e-10,-582288e-12],[.6176,.0119938,-241424e-10,-525327e-12],[.6769,.011713,-320223e-10,-516405e-12],[.7346,.0113541,-397684e-10,-609052e-12],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-140374e-14],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],y3=.8487,v3=1.3523,E3=Gi/5,vne=1/E3,th=18,k_=function(n,e){return n[0]+e*(n[1]+e*(n[2]+e*n[3]))},Ene=function(n,e){return n[1]+e*(2*n[2]+e*3*n[3])};function wne(n,e,t,i){for(var r=e;i;--i){var s=n(r);if(r-=s,Math.abs(s)<t)break}return r}function xne(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"}function Sne(n){var e=Ie(n.x-this.long0,this.over),t=Math.abs(n.y),i=Math.floor(t*E3);i<0?i=0:i>=th&&(i=th-1),t=Gi*(t-vne*i);var r={x:k_(nx[i],t)*e,y:k_(yf[i],t)};return n.y<0&&(r.y=-r.y),r.x=r.x*this.a*y3+this.x0,r.y=r.y*this.a*v3+this.y0,r}function Ine(n){var e={x:(n.x-this.x0)/(this.a*y3),y:Math.abs(n.y-this.y0)/(this.a*v3)};if(e.y>=1)e.x/=nx[th][0],e.y=n.y<0?-he:he;else{var t=Math.floor(e.y*th);for(t<0?t=0:t>=th&&(t=th-1);;)if(yf[t][0]>e.y)--t;else if(yf[t+1][0]<=e.y)++t;else break;var i=yf[t],r=5*(e.y-i[0])/(yf[t+1][0]-i[0]);r=wne(function(s){return(k_(i,s)-e.y)/Ene(i,s)},r,Ee,100),e.x/=k_(nx[t],r),e.y=(5*t+r)*Qt,n.y<0&&(e.y=-e.y)}return e.x=Ie(e.x+this.long0,this.over),e}var Tne=["Robinson","robin"];const Rne={init:xne,forward:Sne,inverse:Ine,names:Tne};function Pne(){this.name="geocent"}function Ane(n){var e=a3(n,this.es,this.a);return e}function Cne(n){var e=l3(n,this.es,this.a,this.b);return e}var Mne=["Geocentric","geocentric","geocent","Geocent"];const bne={init:Pne,forward:Ane,inverse:Cne,names:Mne};var ri={N_POLE:0,S_POLE:1,EQUIT:2,OBLIQ:3},Zd={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};function kne(){if(Object.keys(Zd).forEach((function(t){if(typeof this[t]>"u")this[t]=Zd[t].def;else{if(Zd[t].num&&isNaN(this[t]))throw new Error("Invalid parameter value, must be numeric "+t+" = "+this[t]);Zd[t].num&&(this[t]=parseFloat(this[t]))}Zd[t].degrees&&(this[t]=this[t]*Qt)}).bind(this)),Math.abs(Math.abs(this.lat0)-he)<Ee?this.mode=this.lat0<0?ri.S_POLE:ri.N_POLE:Math.abs(this.lat0)<Ee?this.mode=ri.EQUIT:(this.mode=ri.OBLIQ,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var n=this.tilt,e=this.azi;this.cg=Math.cos(e),this.sg=Math.sin(e),this.cw=Math.cos(n),this.sw=Math.sin(n)}function Lne(n){n.x-=this.long0;var e=Math.sin(n.y),t=Math.cos(n.y),i=Math.cos(n.x),r,s;switch(this.mode){case ri.OBLIQ:s=this.sinph0*e+this.cosph0*t*i;break;case ri.EQUIT:s=t*i;break;case ri.S_POLE:s=-e;break;case ri.N_POLE:s=e;break}switch(s=this.pn1/(this.p-s),r=s*t*Math.sin(n.x),this.mode){case ri.OBLIQ:s*=this.cosph0*e-this.sinph0*t*i;break;case ri.EQUIT:s*=e;break;case ri.N_POLE:s*=-(t*i);break;case ri.S_POLE:s*=t*i;break}var o,a;return o=s*this.cg+r*this.sg,a=1/(o*this.sw*this.h1+this.cw),r=(r*this.cg-s*this.sg)*this.cw*a,s=o*a,n.x=r*this.a,n.y=s*this.a,n}function Nne(n){n.x/=this.a,n.y/=this.a;var e={x:n.x,y:n.y},t,i,r;r=1/(this.pn1-n.y*this.sw),t=this.pn1*n.x*r,i=this.pn1*n.y*this.cw*r,n.x=t*this.cg+i*this.sg,n.y=i*this.cg-t*this.sg;var s=Di(n.x,n.y);if(Math.abs(s)<Ee)e.x=0,e.y=n.y;else{var o,a;switch(a=1-s*s*this.pfact,a=(this.p-Math.sqrt(a))/(this.pn1/s+s/this.pn1),o=Math.sqrt(1-a*a),this.mode){case ri.OBLIQ:e.y=Math.asin(o*this.sinph0+n.y*a*this.cosph0/s),n.y=(o-this.sinph0*Math.sin(e.y))*s,n.x*=a*this.cosph0;break;case ri.EQUIT:e.y=Math.asin(n.y*a/s),n.y=o*s,n.x*=a;break;case ri.N_POLE:e.y=Math.asin(o),n.y=-n.y;break;case ri.S_POLE:e.y=-Math.asin(o);break}e.x=Math.atan2(n.x,n.y)}return n.x=e.x+this.long0,n.y=e.y,n}var One=["Tilted_Perspective","tpers"];const Dne={init:kne,forward:Lne,inverse:Nne,names:One};function Vne(){if(this.flip_axis=this.sweep==="x"?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,this.es!==0){var n=1-this.es,e=1/n;this.radius_p=Math.sqrt(n),this.radius_p2=n,this.radius_p_inv2=e,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")}function Fne(n){var e=n.x,t=n.y,i,r,s,o;if(e=e-this.long0,this.shape==="ellipse"){t=Math.atan(this.radius_p2*Math.tan(t));var a=this.radius_p/Di(this.radius_p*Math.cos(t),Math.sin(t));if(r=a*Math.cos(e)*Math.cos(t),s=a*Math.sin(e)*Math.cos(t),o=a*Math.sin(t),(this.radius_g-r)*r-s*s-o*o*this.radius_p_inv2<0)return n.x=Number.NaN,n.y=Number.NaN,n;i=this.radius_g-r,this.flip_axis?(n.x=this.radius_g_1*Math.atan(s/Di(o,i)),n.y=this.radius_g_1*Math.atan(o/i)):(n.x=this.radius_g_1*Math.atan(s/i),n.y=this.radius_g_1*Math.atan(o/Di(s,i)))}else this.shape==="sphere"&&(i=Math.cos(t),r=Math.cos(e)*i,s=Math.sin(e)*i,o=Math.sin(t),i=this.radius_g-r,this.flip_axis?(n.x=this.radius_g_1*Math.atan(s/Di(o,i)),n.y=this.radius_g_1*Math.atan(o/i)):(n.x=this.radius_g_1*Math.atan(s/i),n.y=this.radius_g_1*Math.atan(o/Di(s,i))));return n.x=n.x*this.a,n.y=n.y*this.a,n}function Gne(n){var e=-1,t=0,i=0,r,s,o,a;if(n.x=n.x/this.a,n.y=n.y/this.a,this.shape==="ellipse"){this.flip_axis?(i=Math.tan(n.y/this.radius_g_1),t=Math.tan(n.x/this.radius_g_1)*Di(1,i)):(t=Math.tan(n.x/this.radius_g_1),i=Math.tan(n.y/this.radius_g_1)*Di(1,t));var c=i/this.radius_p;if(r=t*t+c*c+e*e,s=2*this.radius_g*e,o=s*s-4*r*this.C,o<0)return n.x=Number.NaN,n.y=Number.NaN,n;a=(-s-Math.sqrt(o))/(2*r),e=this.radius_g+a*e,t*=a,i*=a,n.x=Math.atan2(t,e),n.y=Math.atan(i*Math.cos(n.x)/e),n.y=Math.atan(this.radius_p_inv2*Math.tan(n.y))}else if(this.shape==="sphere"){if(this.flip_axis?(i=Math.tan(n.y/this.radius_g_1),t=Math.tan(n.x/this.radius_g_1)*Math.sqrt(1+i*i)):(t=Math.tan(n.x/this.radius_g_1),i=Math.tan(n.y/this.radius_g_1)*Math.sqrt(1+t*t)),r=t*t+i*i+e*e,s=2*this.radius_g*e,o=s*s-4*r*this.C,o<0)return n.x=Number.NaN,n.y=Number.NaN,n;a=(-s-Math.sqrt(o))/(2*r),e=this.radius_g+a*e,t*=a,i*=a,n.x=Math.atan2(t,e),n.y=Math.atan(i*Math.cos(n.x)/e)}return n.x=n.x+this.long0,n}var jne=["Geostationary Satellite View","Geostationary_Satellite","geos"];const Une={init:Vne,forward:Fne,inverse:Gne,names:jne};var Vf=1.340264,Ff=-.081106,Gf=893e-6,jf=.003796,L_=Math.sqrt(3)/2;function Bne(){this.es=0,this.long0=this.long0!==void 0?this.long0:0,this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0}function zne(n){var e=Ie(n.x-this.long0,this.over),t=n.y,i=Math.asin(L_*Math.sin(t)),r=i*i,s=r*r*r;return n.x=e*Math.cos(i)/(L_*(Vf+3*Ff*r+s*(7*Gf+9*jf*r))),n.y=i*(Vf+Ff*r+s*(Gf+jf*r)),n.x=this.a*n.x+this.x0,n.y=this.a*n.y+this.y0,n}function $ne(n){n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a;var e=1e-9,t=12,i=n.y,r,s,o,a,c,h;for(h=0;h<t&&(r=i*i,s=r*r*r,o=i*(Vf+Ff*r+s*(Gf+jf*r))-n.y,a=Vf+3*Ff*r+s*(7*Gf+9*jf*r),i-=c=o/a,!(Math.abs(c)<e));++h);return r=i*i,s=r*r*r,n.x=L_*n.x*(Vf+3*Ff*r+s*(7*Gf+9*jf*r))/Math.cos(i),n.y=Math.asin(Math.sin(i)/L_),n.x=Ie(n.x+this.long0,this.over),n}var Wne=["eqearth","Equal Earth","Equal_Earth"];const Hne={init:Bne,forward:zne,inverse:$ne,names:Wne};var Cg=1e-10;function Kne(){var n;if(this.phi1=this.lat1,Math.abs(this.phi1)<Cg)throw new Error;this.es?(this.en=FI(this.es),this.m1=Qh(this.phi1,this.am1=Math.sin(this.phi1),n=Math.cos(this.phi1),this.en),this.am1=n/(Math.sqrt(1-this.es*this.am1*this.am1)*this.am1),this.inverse=Yne,this.forward=qne):(Math.abs(this.phi1)+Cg>=he?this.cphi1=0:this.cphi1=1/Math.tan(this.phi1),this.inverse=Qne,this.forward=Xne)}function qne(n){var e=Ie(n.x-(this.long0||0),this.over),t=n.y,i,r,s;return i=this.am1+this.m1-Qh(t,r=Math.sin(t),s=Math.cos(t),this.en),r=s*e/(i*Math.sqrt(1-this.es*r*r)),n.x=i*Math.sin(r),n.y=this.am1-i*Math.cos(r),n.x=this.a*n.x+(this.x0||0),n.y=this.a*n.y+(this.y0||0),n}function Yne(n){n.x=(n.x-(this.x0||0))/this.a,n.y=(n.y-(this.y0||0))/this.a;var e,t,i,r;if(t=Di(n.x,n.y=this.am1-n.y),r=GI(this.am1+this.m1-t,this.es,this.en),(e=Math.abs(r))<he)e=Math.sin(r),i=t*Math.atan2(n.x,n.y)*Math.sqrt(1-this.es*e*e)/Math.cos(r);else if(Math.abs(e-he)<=Cg)i=0;else throw new Error;return n.x=Ie(i+(this.long0||0),this.over),n.y=nl(r),n}function Xne(n){var e=Ie(n.x-(this.long0||0),this.over),t=n.y,i,r;return r=this.cphi1+this.phi1-t,Math.abs(r)>Cg?(n.x=r*Math.sin(i=e*Math.cos(t)/r),n.y=this.cphi1-r*Math.cos(i)):n.x=n.y=0,n.x=this.a*n.x+(this.x0||0),n.y=this.a*n.y+(this.y0||0),n}function Qne(n){n.x=(n.x-(this.x0||0))/this.a,n.y=(n.y-(this.y0||0))/this.a;var e,t,i=Di(n.x,n.y=this.cphi1-n.y);if(t=this.cphi1+this.phi1-i,Math.abs(t)>he)throw new Error;return Math.abs(Math.abs(t)-he)<=Cg?e=0:e=i*Math.atan2(n.x,n.y)/Math.cos(t),n.x=Ie(e+(this.long0||0),this.over),n.y=nl(t),n}var Zne=["bonne","Bonne (Werner lat_1=90)"];const Jne={init:Kne,names:Zne},pb={OBLIQUE:{forward:rie,inverse:oie},TRANSVERSE:{forward:sie,inverse:aie}},N_={ROTATE:{o_alpha:"oAlpha",o_lon_c:"oLongC",o_lat_c:"oLatC"},NEW_POLE:{o_lat_p:"oLatP",o_lon_p:"oLongP"},NEW_EQUATOR:{o_lon_1:"oLong1",o_lat_1:"oLat1",o_lon_2:"oLong2",o_lat_2:"oLat2"}};function eie(){if(this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.title=this.title||"General Oblique Transformation",this.isIdentity=i3.includes(this.o_proj),!this.o_proj)throw new Error("Missing parameter: o_proj");if(this.o_proj==="ob_tran")throw new Error("Invalid value for o_proj: "+this.o_proj);const n=this.projStr.replace("+proj=ob_tran","").replace("+o_proj=","+proj=").trim(),e=kr(n);if(!e)throw new Error("Invalid parameter: o_proj. Unknown projection "+this.o_proj);e.long0=0,this.obliqueProjection=e;let t;const i=Object.keys(N_),r=a=>{if(typeof this[a]>"u")return;const c=parseFloat(this[a])*Qt;if(isNaN(c))throw new Error("Invalid value for "+a+": "+this[a]);return c};for(let a=0;a<i.length;a++){const c=i[a],h=N_[c],d=Object.entries(h);if(d.some(([m])=>typeof this[m]<"u")){t=h;for(let m=0;m<d.length;m++){const[y,w]=d[m],T=r(y);if(typeof T>"u")throw new Error("Missing parameter: "+y+".");this[w]=T}break}}if(!t)throw new Error("No valid parameters provided for ob_tran projection.");const{lamp:s,phip:o}=iie(this,t);this.lamp=s,Math.abs(o)>Ee?(this.cphip=Math.cos(o),this.sphip=Math.sin(o),this.projectionType=pb.OBLIQUE):this.projectionType=pb.TRANSVERSE}function tie(n){return this.projectionType.forward(this,n)}function nie(n){return this.projectionType.inverse(this,n)}function iie(n,e){let t,i;if(e===N_.ROTATE){let r=n.oLongC,s=n.oLatC,o=n.oAlpha;if(Math.abs(Math.abs(s)-he)<=Ee)throw new Error("Invalid value for o_lat_c: "+n.o_lat_c+" should be < 90");i=r+Math.atan2(-1*Math.cos(o),-1*Math.sin(o)*Math.sin(s)),t=Math.asin(Math.cos(s)*Math.sin(o))}else if(e===N_.NEW_POLE)i=n.oLongP,t=n.oLatP;else{let r=n.oLong1,s=n.oLat1,o=n.oLong2,a=n.oLat2,c=Math.abs(s);if(Math.abs(s)>he-Ee)throw new Error("Invalid value for o_lat_1: "+n.o_lat_1+" should be < 90");if(Math.abs(a)>he-Ee)throw new Error("Invalid value for o_lat_2: "+n.o_lat_2+" should be < 90");if(Math.abs(s-a)<Ee)throw new Error("Invalid value for o_lat_1 and o_lat_2: o_lat_1 should be different from o_lat_2");if(c<Ee)throw new Error("Invalid value for o_lat_1: o_lat_1 should be different from zero");i=Math.atan2(Math.cos(s)*Math.sin(a)*Math.cos(r)-Math.sin(s)*Math.cos(a)*Math.cos(o),Math.sin(s)*Math.cos(a)*Math.sin(o)-Math.cos(s)*Math.sin(a)*Math.sin(r)),t=Math.atan(-1*Math.cos(i-r)/Math.tan(s))}return{lamp:i,phip:t}}function rie(n,e){let{x:t,y:i}=e;t+=n.long0;const r=Math.cos(t),s=Math.sin(i),o=Math.cos(i);e.x=Ie(Math.atan2(o*Math.sin(t),n.sphip*o*r+n.cphip*s)+n.lamp),e.y=Math.asin(n.sphip*s-n.cphip*o*r);const a=n.obliqueProjection.forward(e);return n.isIdentity&&(a.x*=Gi,a.y*=Gi),a}function sie(n,e){let{x:t,y:i}=e;t+=n.long0;const r=Math.cos(i),s=Math.cos(t);e.x=Ie(Math.atan2(r*Math.sin(t),Math.sin(i))+n.lamp),e.y=Math.asin(-1*r*s);const o=n.obliqueProjection.forward(e);return n.isIdentity&&(o.x*=Gi,o.y*=Gi),o}function oie(n,e){n.isIdentity&&(e.x*=Qt,e.y*=Qt);const t=n.obliqueProjection.inverse(e);let{x:i,y:r}=t;if(i<Number.MAX_VALUE){i-=n.lamp;const s=Math.cos(i),o=Math.sin(r),a=Math.cos(r);e.x=Math.atan2(a*Math.sin(i),n.sphip*a*s-n.cphip*o),e.y=Math.asin(n.sphip*o+n.cphip*a*s)}return e.x=Ie(e.x+n.long0),e}function aie(n,e){n.isIdentity&&(e.x*=Qt,e.y*=Qt);const t=n.obliqueProjection.inverse(e);let{x:i,y:r}=t;if(i<Number.MAX_VALUE){const s=Math.cos(r);i-=n.lamp,e.x=Math.atan2(s*Math.sin(i),-1*Math.sin(r)),e.y=Math.asin(s*Math.cos(i))}return e.x=Ie(e.x+n.long0),e}var lie=["General Oblique Transformation","General_Oblique_Transformation","ob_tran"];const cie={init:eie,forward:tie,inverse:nie,names:lie};function uie(n){n.Proj.projections.add(x0),n.Proj.projections.add(S0),n.Proj.projections.add(ZJ),n.Proj.projections.add(aee),n.Proj.projections.add(dee),n.Proj.projections.add(_ee),n.Proj.projections.add(See),n.Proj.projections.add(Aee),n.Proj.projections.add(Lee),n.Proj.projections.add(Fee),n.Proj.projections.add(Qee),n.Proj.projections.add(ite),n.Proj.projections.add(lte),n.Proj.projections.add(gte),n.Proj.projections.add(vte),n.Proj.projections.add(Ite),n.Proj.projections.add(Cte),n.Proj.projections.add(Nte),n.Proj.projections.add(jte),n.Proj.projections.add(Wte),n.Proj.projections.add(Xte),n.Proj.projections.add(tne),n.Proj.projections.add(lne),n.Proj.projections.add(fne),n.Proj.projections.add(yne),n.Proj.projections.add(Rne),n.Proj.projections.add(bne),n.Proj.projections.add(Dne),n.Proj.projections.add(Une),n.Proj.projections.add(Hne),n.Proj.projections.add(Jne),n.Proj.projections.add(cie)}const Rt=Object.assign(mJ,{defaultDatum:"WGS84",Proj:kr,WGS84:new kr("WGS84"),Point:jh,toPoint:c3,defs:Bn,nadgrid:QZ,transform:M_,mgrs:pJ,version:"__VERSION__"});uie(Rt);class hie{constructor(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.featureClass=gh,this.supportedMediaTypes=null}getReadOptions(e,t){if(t){let i=t.dataProjection?Vt(t.dataProjection):this.readProjection(e);t.extent&&i&&i.getUnits()==="tile-pixels"&&(i=Vt(i),i.setWorldExtent(t.extent)),t={dataProjection:i,featureProjection:t.featureProjection}}return this.adaptOptions(t)}adaptOptions(e){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection,featureClass:this.featureClass},e)}getType(){return We()}readFeature(e,t){return We()}readFeatures(e,t){return We()}readGeometry(e,t){return We()}readProjection(e){return We()}writeFeature(e,t){return We()}writeFeatures(e,t){return We()}writeGeometry(e,t){return We()}}function WI(n,e,t){const i=t?Vt(t.featureProjection):null,r=t?Vt(t.dataProjection):null;let s=n;if(i&&r&&!Ef(i,r)){e&&(s=n.clone());const o=e?i:r,a=e?r:i;o.getUnits()==="tile-pixels"?s.transform(o,a):s.applyTransform(Hf(o,a))}if(e&&t&&t.decimals!==void 0){const o=Math.pow(10,t.decimals),a=function(c){for(let h=0,d=c.length;h<d;++h)c[h]=Math.round(c[h]*o)/o;return c};s===n&&(s=n.clone()),s.applyTransform(a)}return s}const die={Point:cc,LineString:lc,Polygon:Ua,MultiPoint:K_,MultiLineString:D0,MultiPolygon:V0};function fie(n,e,t){return Array.isArray(e[0])?(u4(n,0,e,t)||(n=n.slice(),VE(n,0,e,t)),n):(Mx(n,0,e,t)||(n=n.slice(),N0(n,0,e,t)),n)}function w3(n,e){const t=n.geometry;if(!t)return[];if(Array.isArray(t))return t.map(s=>w3({...n,geometry:s})).flat();const i=t.type==="MultiPolygon"?"Polygon":t.type;if(i==="GeometryCollection"||i==="Circle")throw new Error("Unsupported geometry type: "+i);const r=t.layout.length;return WI(new Ji(i,i==="Polygon"?fie(t.flatCoordinates,t.ends,r):t.flatCoordinates,t.ends?.flat(),r,n.properties||{},n.id).enableSimplifyTransformed(),!1,e)}function HI(n,e){if(!n)return null;if(Array.isArray(n)){const i=n.map(r=>HI(r,e));return new O0(i)}const t=die[n.type];return WI(new t(n.flatCoordinates,n.layout||"XY",n.ends),!1,e)}class gie extends hie{constructor(){super()}getType(){return"json"}readFeature(e,t){return this.readFeatureFromObject(Jp(e),this.getReadOptions(e,t))}readFeatures(e,t){return this.readFeaturesFromObject(Jp(e),this.getReadOptions(e,t))}readFeatureFromObject(e,t){return We()}readFeaturesFromObject(e,t){return We()}readGeometry(e,t){return this.readGeometryFromObject(Jp(e),this.getReadOptions(e,t))}readGeometryFromObject(e,t){return We()}readProjection(e){return this.readProjectionFromObject(Jp(e))}readProjectionFromObject(e){return We()}writeFeature(e,t){return JSON.stringify(this.writeFeatureObject(e,t))}writeFeatureObject(e,t){return We()}writeFeatures(e,t){return JSON.stringify(this.writeFeaturesObject(e,t))}writeFeaturesObject(e,t){return We()}writeGeometry(e,t){return JSON.stringify(this.writeGeometryObject(e,t))}writeGeometryObject(e,t){return We()}}function Jp(n){if(typeof n=="string"){const e=JSON.parse(n);return e||null}return n!==null?n:null}class mie extends gie{constructor(e){e=e||{},super(),this.dataProjection=Vt(e.dataProjection?e.dataProjection:"EPSG:4326"),e.featureProjection&&(this.defaultFeatureProjection=Vt(e.featureProjection)),e.featureClass&&(this.featureClass=e.featureClass),this.geometryName_=e.geometryName,this.extractGeometryName_=e.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(e,t){let i=null;e.type==="Feature"?i=e:i={type:"Feature",geometry:e,properties:null};const r=KI(i.geometry);if(this.featureClass===Ji)return w3({geometry:r,id:i.id,properties:i.properties},t);const s=new gh;return this.geometryName_?s.setGeometryName(this.geometryName_):this.extractGeometryName_&&i.geometry_name&&s.setGeometryName(i.geometry_name),s.setGeometry(HI(r,t)),"id"in i&&s.setId(i.id),i.properties&&s.setProperties(i.properties,!0),s}readFeaturesFromObject(e,t){const i=e;let r=null;if(i.type==="FeatureCollection"){const s=e;r=[];const o=s.features;for(let a=0,c=o.length;a<c;++a){const h=this.readFeatureFromObject(o[a],t);h&&r.push(h)}}else r=[this.readFeatureFromObject(e,t)];return r.flat()}readGeometryFromObject(e,t){return pie(e,t)}readProjectionFromObject(e){const t=e.crs;let i;if(t)if(t.type=="name")i=Vt(t.properties.name);else if(t.type==="EPSG")i=Vt("EPSG:"+t.properties.code);else throw new Error("Unknown SRS type");else i=this.dataProjection;return i}writeFeatureObject(e,t){t=this.adaptOptions(t);const i={type:"Feature",geometry:null,properties:null},r=e.getId();if(r!==void 0&&(i.id=r),!e.hasProperties())return i;const s=e.getProperties(),o=e.getGeometry();return o&&(i.geometry=ix(o,t),delete s[e.getGeometryName()]),sc(s)||(i.properties=s),i}writeFeaturesObject(e,t){t=this.adaptOptions(t);const i=[];for(let r=0,s=e.length;r<s;++r)i.push(this.writeFeatureObject(e[r],t));return{type:"FeatureCollection",features:i}}writeGeometryObject(e,t){return ix(e,this.adaptOptions(t))}}function KI(n,e){if(!n)return null;let t;switch(n.type){case"Point":{t=yie(n);break}case"LineString":{t=vie(n);break}case"Polygon":{t=Sie(n);break}case"MultiPoint":{t=wie(n);break}case"MultiLineString":{t=Eie(n);break}case"MultiPolygon":{t=xie(n);break}case"GeometryCollection":{t=_ie(n);break}default:throw new Error("Unsupported GeoJSON type: "+n.type)}return t}function pie(n,e){const t=KI(n);return HI(t,e)}function _ie(n,e){return n.geometries.map(function(i){return KI(i)})}function yie(n){const e=n.coordinates;return{type:"Point",flatCoordinates:e,layout:Mc(e.length)}}function vie(n){const e=n.coordinates,t=e.flat();return{type:"LineString",flatCoordinates:t,ends:[t.length],layout:Mc(e[0]?.length||2)}}function Eie(n){const e=n.coordinates,t=e[0]?.[0]?.length||2,i=[],r=Fg(i,0,e,t);return{type:"MultiLineString",flatCoordinates:i,ends:r,layout:Mc(t)}}function wie(n){const e=n.coordinates;return{type:"MultiPoint",flatCoordinates:e.flat(),layout:Mc(e[0]?.length||2)}}function xie(n){const e=n.coordinates,t=[],i=e[0]?.[0]?.[0].length||2,r=Bb(t,0,e,i);return{type:"MultiPolygon",flatCoordinates:t,ends:r,layout:Mc(i)}}function Sie(n){const e=n.coordinates,t=[],i=e[0]?.[0]?.length,r=Fg(t,0,e,i);return{type:"Polygon",flatCoordinates:t,ends:r,layout:Mc(i)}}function ix(n,e){n=WI(n,!0,e);const t=n.getType();let i;switch(t){case"Point":{i=Cie(n);break}case"LineString":{i=Tie(n);break}case"Polygon":{i=Mie(n,e);break}case"MultiPoint":{i=Pie(n);break}case"MultiLineString":{i=Rie(n);break}case"MultiPolygon":{i=Aie(n,e);break}case"GeometryCollection":{i=Iie(n,e);break}case"Circle":{i={type:"GeometryCollection",geometries:[]};break}default:throw new Error("Unsupported geometry type: "+t)}return i}function Iie(n,e){return e=Object.assign({},e),delete e.featureProjection,{type:"GeometryCollection",geometries:n.getGeometriesArray().map(function(i){return ix(i,e)})}}function Tie(n,e){return{type:"LineString",coordinates:n.getCoordinates()}}function Rie(n,e){return{type:"MultiLineString",coordinates:n.getCoordinates()}}function Pie(n,e){return{type:"MultiPoint",coordinates:n.getCoordinates()}}function Aie(n,e){let t;return e&&(t=e.rightHanded),{type:"MultiPolygon",coordinates:n.getCoordinates(t)}}function Cie(n,e){return{type:"Point",coordinates:n.getCoordinates()}}function Mie(n,e){let t;return e&&(t=e.rightHanded),{type:"Polygon",coordinates:n.getCoordinates(t)}}Rt.defs("EPSG:28992","+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m +no_defs");let Uf=null,x3=!1;function rx(n){Uf&&(n.removeLayer(Uf),Uf=null),x3||ai.getState().setLayerVisibility("AHN4 Hillshade NL",!1)}async function bie(n,e){try{const t=Ct(e),i=Rt("EPSG:4326","EPSG:28992",t);if(i[0]<7e3||i[0]>3e5||i[1]<289e3||i[1]>629e3)return!1;rx(n);const r=`https://service.pdok.nl/rvo/brpgewaspercelen/wfs/v1_0?SERVICE=WFS&VERSION=2.0.0&REQUEST=GetFeature&TYPENAMES=brpgewaspercelen:BrpGewas&OUTPUTFORMAT=json&SRSNAME=EPSG:28992&CQL_FILTER=INTERSECTS(geom,POINT(${i[0]} ${i[1]}))`,s=new AbortController,o=setTimeout(()=>s.abort(),1e4),a=await fetch(r,{signal:s.signal});if(clearTimeout(o),!a.ok)return console.error("WFS request failed:",a.status),!1;const c=await a.json();if(!c.features||c.features.length===0)return console.log("No parcel found at location"),!1;const h=c.features[0],g=new mie().readFeature(h,{dataProjection:"EPSG:28992",featureProjection:"EPSG:3857"}),m=g.getGeometry();if(!m)return console.log("No geometry in parcel feature"),!1;const y=m.getExtent(),w=y[2]-y[0],T=y[3]-y[1],E=Math.max(w,T)*.3,P=[y[0]-E,y[1]-E,y[2]+E,y[3]+E],M=ai.getState();x3=M.visible["AHN4 Hillshade NL"]??!1,M.setLayerVisibility("AHN4 Hillshade NL",!0);const N=new bx({features:[g]});return Uf=new jx({source:N,style:new ji({fill:new wo({color:"rgba(220, 38, 38, 0.1)"}),stroke:new ka({color:"#dc2626",width:3})}),zIndex:999}),n.addLayer(Uf),n.getView().fit(P,{duration:300,maxZoom:17}),console.log(" Parcel highlighted, hillshade enabled"),!0}catch(t){return console.error("Failed to show parcel height map:",t),!1}}Rt.defs("EPSG:28992","+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m +no_defs");async function kie(n){try{const e=Ct(n),t=Rt("EPSG:4326","EPSG:28992",e);if(t[0]<7e3||t[0]>3e5||t[1]<289e3||t[1]>629e3)return null;const i=1,s=`https://service.pdok.nl/rws/ahn/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=dtm_05m&QUERY_LAYERS=dtm_05m&INFO_FORMAT=application/json&CRS=EPSG:28992&BBOX=${`${t[0]-i},${t[1]-i},${t[0]+i},${t[1]+i}`}&WIDTH=1&HEIGHT=1&I=0&J=0`,a=await(await fetch(s)).json();if(a.features&&a.features.length>0){const c=a.features[0].properties?.GRAY_INDEX;if(typeof c=="number"&&!isNaN(c))return c}}catch(e){console.warn("AHN height query failed:",e)}return null}const Lie={1:"Zeer lage trefkans op archeologische resten",2:"Lage trefkans op archeologische resten",3:"Middelhoge trefkans op archeologische resten",4:"Hoge trefkans op archeologische resten",5:"Lage trefkans (water)",6:"Middelhoge trefkans (water)",7:"Hoge trefkans (water)",8:"Water",9:"Niet gekarteerd"};function Nie(){const n=Ei(k=>k.map),[e,t]=se.useState([]),[i,r]=se.useState(0),[s,o]=se.useState(!1),[a,c]=se.useState(null),[h,d]=se.useState(!1),[g,m]=se.useState(!1),y=e[i]||"",w=e.length>1,T=k=>{const U=k.match(/<strong[^>]*>(.*?)<\/strong>/);if(U){const B=U[1].replace(/<[^>]+>/g,""),z=k.replace(U[0],"").replace(/^(<br\s*\/?>)+/,"");return{title:B,contentWithoutTitle:z}}return{title:"",contentWithoutTitle:k}},{title:E,contentWithoutTitle:P}=T(y),M=y.includes("Landbouwperceel"),N=()=>{r(k=>(k-1+e.length)%e.length)},D=()=>{r(k=>(k+1)%e.length)},j=async()=>{if(!(!n||!a||g)){m(!0);try{await bie(n,a)&&d(!0)}catch(k){console.error("Failed to load height map:",k)}finally{m(!1)}}},W=()=>{n&&(rx(n),d(!1))};se.useEffect(()=>{if(!n)return;const k=z=>{let O='<strong class="text-purple-800">AMK Monument</strong>';if(z.toponiem&&(O+=`<br/><span class="text-sm font-semibold">${z.toponiem}</span>`),z.kwaliteitswaarde&&(O+=`<br/><span class="text-sm text-purple-700">${z.kwaliteitswaarde}</span>`),z.omschrijving&&(O+=`<br/><span class="text-xs text-gray-600 mt-1 block">${z.omschrijving}</span>`),z.txt_label){const oe=z.txt_label.split(", ").slice(0,3).join(", ");O+=`<br/><span class="text-xs text-gray-500 italic">${oe}${z.txt_label.split(", ").length>3?"...":""}</span>`}return O},U=async(z,O)=>{const oe=[],Te=n.getLayers().getArray().filter(we=>we instanceof Ll&&we.getVisible()?we.getSource()instanceof YF:!1);for(const we of Te){const _e=we.getSource();if(!_e)continue;const Q=we.get("title")||"";if(Q==="Archeo Landschappen"){try{const K=Ct(z),V=Rt("EPSG:4326","EPSG:28992",K),I=100,q=`https://services.rce.geovoorziening.nl/landschappenkaart/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=landschappenkaart_nl&QUERY_LAYERS=landschappenkaart_nl&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${V[0]-I},${V[1]-I},${V[0]+I},${V[1]+I}`}`,X=await(await fetch(q)).json();if(X.features&&X.features.length>0){const F=X.features[0].properties;let te='<strong class="text-green-800">Archeologisch Landschap</strong>';(F.landschapsnaam||F.naam)&&(te+=`<br/><span class="text-sm font-semibold">${F.landschapsnaam||F.naam}</span>`),F.omschrijving&&(te+=`<br/><span class="text-xs text-gray-600">${F.omschrijving}</span>`),oe.push(te)}}catch(K){console.warn("Archeo Landschappen WMS query failed:",K)}continue}if(Q==="FAMKE Steentijd"){try{const K=Ct(z),V=Rt("EPSG:4326","EPSG:28992",K),I=100,q=`https://geoportaal.fryslan.nl/arcgis/services/Themas/cultuurhistorie/MapServer/WMSServer?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=FAMKE_Advies_steentijd-bronstijd3339&QUERY_LAYERS=FAMKE_Advies_steentijd-bronstijd3339&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${V[0]-I},${V[1]-I},${V[0]+I},${V[1]+I}`}`,X=await(await fetch(q)).json();if(X.features&&X.features.length>0){const F=X.features[0].properties;let te='<strong class="text-amber-800">FAMKE Steentijd-Bronstijd</strong>';(F.advies||F.Advies)&&(te+=`<br/><span class="text-sm text-amber-700">${F.advies||F.Advies}</span>`),oe.push(te)}}catch(K){console.warn("FAMKE WMS query failed:",K)}continue}if(Q==="Archeo Onderzoeken"){try{const K=Ct(z),V=Rt("EPSG:4326","EPSG:28992",K),I=100,q=`https://data.geo.cultureelerfgoed.nl/openbaar/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=archeologische_onderzoeksmeldingen_openbaar_rd&QUERY_LAYERS=archeologische_onderzoeksmeldingen_openbaar_rd&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${V[0]-I},${V[1]-I},${V[0]+I},${V[1]+I}`}`,X=await(await fetch(q)).json();if(X.features&&X.features.length>0){const F=X.features[0].properties;let te='<strong class="text-blue-800">Archeologisch Onderzoek</strong>';if(F.type_onderzoek&&(te+=`<br/><span class="text-sm font-semibold">${F.type_onderzoek}</span>`),F.onderzoeksmeldingnummer&&(te+=`<br/><span class="text-xs text-gray-500">Melding: ${F.onderzoeksmeldingnummer}</span>`),F.uitvoerder&&(te+=`<br/><span class="text-sm text-gray-700">Uitvoerder: ${F.uitvoerder}</span>`),F.startdatum||F.einddatum){const Pe=[F.startdatum,F.einddatum].filter(Boolean).join(" - ");te+=`<br/><span class="text-xs text-gray-600">Periode: ${Pe}</span>`}if(F.gemeente&&(te+=`<br/><span class="text-xs text-gray-500">${F.gemeente}</span>`),F.type_uri){const Pe=F.type_uri.replace("type_uri:","").trim();Pe.startsWith("http")&&(te+=`<br/><a href="${Pe}" target="_blank" rel="noopener noreferrer" class="text-xs text-blue-600 hover:underline">Meer informatie </a>`)}for(const[Pe,Be]of Object.entries(F))if(Pe.toLowerCase().includes("uri")&&typeof Be=="string"&&Pe!=="type_uri"){const Pt=Be.replace(/^[a-z_]+:/i,"").trim();Pt.startsWith("http")&&(te+=`<br/><a href="${Pt}" target="_blank" rel="noopener noreferrer" class="text-xs text-blue-600 hover:underline">${Pe.replace("_uri","")} </a>`)}oe.push(te)}}catch(K){console.warn("Archeo Onderzoeken WMS query failed:",K)}continue}if(Q==="IKAW"){try{const K=Ct(z),V=Rt("EPSG:4326","EPSG:28992",K),I=500,q=`https://services.rce.geovoorziening.nl/ikaw/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=IKAW3Indicatievekaartarcheologischewaarden2008&QUERY_LAYERS=IKAW3Indicatievekaartarcheologischewaarden2008&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${V[0]-I},${V[1]-I},${V[0]+I},${V[1]+I}`}`,X=await(await fetch(q)).json();if(X.features&&X.features.length>0){const F=X.features[0].properties,te=Math.round(F.PALETTE_INDEX||F.palette_index||0),Pe=Lie[te]||`Trefkans onbekend (${te})`;let Be='<strong class="text-orange-800">IKAW (2008)</strong>';Be+=`<br/><span class="text-sm text-orange-700">${Pe}</span>`,oe.push(Be)}}catch(K){console.warn("IKAW WMS query failed:",K)}continue}if(Q==="Inundatiegebieden"){try{const K=Ct(z),V=Rt("EPSG:4326","EPSG:28992",K),I=100,q=`https://services.rce.geovoorziening.nl/liniesenstellingen/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=inundaties&QUERY_LAYERS=inundaties&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${V[0]-I},${V[1]-I},${V[0]+I},${V[1]+I}`}`,X=await(await fetch(q)).json();if(X.features&&X.features.length>0){const F=X.features[0].properties;let te='<strong class="text-blue-800">Inundatiegebied</strong>';(F["linie-naam"]||F.linie_naam)&&(te+=`<br/><span class="text-sm font-semibold text-blue-700">${F["linie-naam"]||F.linie_naam}</span>`),F.naam&&(te+=`<br/><span class="text-sm text-gray-700">${F.naam}</span>`),F.periode&&(te+=`<br/><span class="text-xs text-gray-500">${F.periode}</span>`),F.lin_period&&(te+=`<br/><span class="text-xs text-gray-400">${F.lin_period}</span>`),oe.push(te)}}catch(K){console.warn("Inundatiegebieden WMS query failed:",K)}continue}if(Q==="Militaire Objecten"){try{const K=Ct(z),V=Rt("EPSG:4326","EPSG:28992",K),I=50,q=`https://services.rce.geovoorziening.nl/liniesenstellingen/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=objecten&QUERY_LAYERS=objecten&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${V[0]-I},${V[1]-I},${V[0]+I},${V[1]+I}`}`,X=await(await fetch(q)).json();if(X.features&&X.features.length>0){const F=X.features[0].properties;let te='<strong class="text-stone-800">Militair Object</strong>';F.obj_soort&&(te+=`<br/><span class="text-sm font-semibold text-stone-700">${F.obj_soort}</span>`),F.obj_naam&&(te+=`<br/><span class="text-sm text-gray-700">${F.obj_naam}</span>`),F.lin_period&&(te+=`<br/><span class="text-xs text-gray-500">${F.lin_period}</span>`),oe.push(te)}}catch(K){console.warn("Militaire Objecten WMS query failed:",K)}continue}if(Q==="Verdedigingslinies"){try{const K=Ct(z),V=Rt("EPSG:4326","EPSG:28992",K),I=100,q=`https://services.rce.geovoorziening.nl/liniesenstellingen/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=linies&QUERY_LAYERS=linies&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${V[0]-I},${V[1]-I},${V[0]+I},${V[1]+I}`}`,X=await(await fetch(q)).json();if(X.features&&X.features.length>0){const F=X.features[0].properties;let te='<strong class="text-amber-800">Verdedigingslinie</strong>';(F.naam||F.lin_naam)&&(te+=`<br/><span class="text-sm font-semibold text-amber-700">${F.naam||F.lin_naam}</span>`),F.lin_period&&(te+=`<br/><span class="text-xs text-gray-500">${F.lin_period}</span>`),F.status&&(te+=`<br/><span class="text-xs text-gray-400">${F.status}</span>`),oe.push(te)}}catch(K){console.warn("Verdedigingslinies WMS query failed:",K)}continue}if(Q==="Rijksmonumenten"){try{const K=Ct(z),V=Rt("EPSG:4326","EPSG:28992",K),I=50,q=`https://data.geo.cultureelerfgoed.nl/openbaar/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=rijksmonumentpunten&QUERY_LAYERS=rijksmonumentpunten&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${V[0]-I},${V[1]-I},${V[0]+I},${V[1]+I}`}`,X=await(await fetch(q)).json();if(X.features&&X.features.length>0){const F=X.features[0].properties;let te='<strong class="text-red-800">Rijksmonument</strong>';(F.cbsNaam||F.cbs_naam)&&(te+=`<br/><span class="text-sm font-semibold">${F.cbsNaam||F.cbs_naam}</span>`),F.hoofdcategorie&&(te+=`<br/><span class="text-sm text-red-700">${F.hoofdcategorie}</span>`),F.subcategorie&&(te+=`<br/><span class="text-xs text-gray-600">${F.subcategorie}</span>`),F.rijksmonumentnummer&&(te+=`<br/><span class="text-xs text-gray-500">Nr: ${F.rijksmonumentnummer}</span>`),(F.bouwjaar||F.oorspronkelijkebouwjaar)&&(te+=`<br/><span class="text-xs text-gray-500">Bouwjaar: ${F.bouwjaar||F.oorspronkelijkebouwjaar}</span>`),oe.push(te)}}catch(K){console.warn("Rijksmonumenten WMS query failed:",K)}continue}if(Q==="Werelderfgoed"){try{const K=Ct(z),V=Rt("EPSG:4326","EPSG:28992",K),I=500,q=`https://service.pdok.nl/rce/ps-ch/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=PS.ProtectedSite&QUERY_LAYERS=PS.ProtectedSite&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${V[0]-I},${V[1]-I},${V[0]+I},${V[1]+I}`}`,X=await(await fetch(q)).json();if(X.features&&X.features.length>0){const F=X.features[0].properties;let te='<strong class="text-cyan-800">UNESCO Werelderfgoed</strong>';(F.siteName||F.naam)&&(te+=`<br/><span class="text-sm font-semibold text-cyan-700">${F.siteName||F.naam}</span>`),F.siteDesignation&&(te+=`<br/><span class="text-xs text-gray-600">${F.siteDesignation}</span>`),oe.push(te)}}catch(K){console.warn("Werelderfgoed WMS query failed:",K)}continue}if(Q==="Terpen"){try{const K=Ct(z),V=Rt("EPSG:4326","EPSG:28992",K),I=100,q=`https://geoportaal.fryslan.nl/arcgis/services/Themas/cultuurhistorie/MapServer/WMSServer?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=terpen3335&QUERY_LAYERS=terpen3335&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${V[0]-I},${V[1]-I},${V[0]+I},${V[1]+I}`}`,X=await(await fetch(q)).json();if(X.features&&X.features.length>0){const F=X.features[0].properties;let te='<strong class="text-orange-800">Terp</strong>';(F.naam||F.NAAM)&&(te+=`<br/><span class="text-sm font-semibold text-orange-700">${F.naam||F.NAAM}</span>`),(F.plaats||F.PLAATS)&&(te+=`<br/><span class="text-xs text-gray-600">${F.plaats||F.PLAATS}</span>`),oe.push(te)}}catch(K){console.warn("Terpen WMS query failed:",K)}continue}if(Q==="Religieus Erfgoed"){try{const K=Ct(z),V=Rt("EPSG:4326","EPSG:28992",K),I=50,q=`https://services.rce.geovoorziening.nl/landschapsatlas_view/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=religieuserfgoed&QUERY_LAYERS=religieuserfgoed&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${V[0]-I},${V[1]-I},${V[0]+I},${V[1]+I}`}`,X=await(await fetch(q)).json();if(X.features&&X.features.length>0){const F=X.features[0].properties;let te='<strong class="text-purple-800">Religieus Erfgoed</strong>';const Pe=F.naam||F.NAAM||F.name||F.NAME;Pe&&(te+=`<br/><span class="text-sm font-semibold text-purple-700">${Pe}</span>`);const Be=F.denominatie||F.DENOMINATIE||F.religie;Be&&(te+=`<br/><span class="text-sm text-gray-700">${Be}</span>`);const Pt=F.type||F.TYPE||F.functie;Pt&&(te+=`<br/><span class="text-xs text-gray-600">${Pt}</span>`);const Kn=F.bouwjaar||F.BOUWJAAR||F.jaar;Kn&&(te+=`<br/><span class="text-xs text-gray-500">Bouwjaar: ${Kn}</span>`);const bn=F.gemeente||F.GEMEENTE||F.plaats;bn&&(te+=`<br/><span class="text-xs text-gray-400">${bn}</span>`),oe.push(te)}}catch(K){console.warn("Religieus Erfgoed WMS query failed:",K)}continue}if(Q==="Gewaspercelen"){try{const K=Ct(z),V=Rt("EPSG:4326","EPSG:28992",K),I=50,q=`https://service.pdok.nl/rvo/brpgewaspercelen/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=BrpGewas&QUERY_LAYERS=BrpGewas&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${V[0]-I},${V[1]-I},${V[0]+I},${V[1]+I}`}`,X=await(await fetch(q)).json();if(X.features&&X.features.length>0){const F=X.features[0].properties;let te='<strong class="text-green-800">Landbouwperceel</strong>';(F.gewas||F.gewasnaam)&&(te+=`<br/><span class="text-sm font-semibold text-green-700">${F.gewas||F.gewasnaam}</span>`),(F.categorie||F.category)&&(te+=`<br/><span class="text-xs text-gray-600">${F.categorie||F.category}</span>`),F.oppervlakte&&(te+=`<br/><span class="text-xs text-gray-500">${F.oppervlakte} ha</span>`),oe.push(te)}}catch(K){console.warn("BRP Gewaspercelen WMS query failed:",K)}continue}if(Q==="Kadastrale Grenzen"){try{const K=Ct(z),V=Rt("EPSG:4326","EPSG:28992",K),I=20,q=`https://service.pdok.nl/kadaster/kadastralekaart/wms/v5_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=Perceel&QUERY_LAYERS=Perceel&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${V[0]-I},${V[1]-I},${V[0]+I},${V[1]+I}`}`,X=await(await fetch(q)).json();if(X.features&&X.features.length>0){const F=X.features[0].properties;let te='<strong class="text-indigo-800">Kadastraal Perceel</strong>';(F.perceelNummer||F.perceelnummer)&&(te+=`<br/><span class="text-sm font-semibold text-indigo-700">${F.perceelNummer||F.perceelnummer}</span>`),(F.kadastraleGemeenteCode||F.gemeentecode)&&(te+=`<br/><span class="text-xs text-gray-600">Gemeente: ${F.kadastraleGemeenteCode||F.gemeentecode}</span>`),F.sectie&&(te+=`<br/><span class="text-xs text-gray-500">Sectie: ${F.sectie}</span>`),F.oppervlakte&&(te+=`<br/><span class="text-xs text-gray-500">${F.oppervlakte} m</span>`),oe.push(te)}}catch(K){console.warn("Kadastrale Grenzen WMS query failed:",K)}continue}if(Q==="Scheepswrakken"){try{const K=Ct(z),V=Rt("EPSG:4326","EPSG:28992",K),I=100,q=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_ARCHEOLOGIE_SCHEEPSRESTANTEN&QUERY_LAYERS=CHS_2015_ARCHEOLOGIE_SCHEEPSRESTANTEN&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${V[0]-I},${V[1]-I},${V[0]+I},${V[1]+I}`}`,X=await(await fetch(q)).json();if(X.features&&X.features.length>0){const F=X.features[0].properties;let te='<strong class="text-cyan-800">Scheepswrak</strong>';(F.naam||F.NAAM)&&(te+=`<br/><span class="text-sm font-semibold text-cyan-700">${F.naam||F.NAAM}</span>`),(F.type||F.TYPE)&&(te+=`<br/><span class="text-sm text-gray-700">${F.type||F.TYPE}</span>`),(F.datering||F.DATERING)&&(te+=`<br/><span class="text-xs text-gray-500">Datering: ${F.datering||F.DATERING}</span>`),(F.bron||F.BRON)&&(te+=`<br/><span class="text-xs text-gray-400">${F.bron||F.BRON}</span>`),oe.push(te)}}catch(K){console.warn("Scheepswrakken WMS query failed:",K)}continue}if(Q==="Woonheuvels ZH"){try{const K=Ct(z),V=Rt("EPSG:4326","EPSG:28992",K),I=100,q=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_ARCHEOLOGIE_WOONHEUVEL&QUERY_LAYERS=CHS_2015_ARCHEOLOGIE_WOONHEUVEL&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${V[0]-I},${V[1]-I},${V[0]+I},${V[1]+I}`}`,X=await(await fetch(q)).json();if(X.features&&X.features.length>0){const F=X.features[0].properties;let te='<strong class="text-orange-800">Woonheuvel</strong>';(F.naam||F.NAAM)&&(te+=`<br/><span class="text-sm font-semibold text-orange-700">${F.naam||F.NAAM}</span>`),(F.type||F.TYPE)&&(te+=`<br/><span class="text-sm text-gray-700">${F.type||F.TYPE}</span>`),oe.push(te)}}catch(K){console.warn("Woonheuvels WMS query failed:",K)}continue}if(Q==="Romeinse Forten"){try{const K=Ct(z),V=Rt("EPSG:4326","EPSG:28992",K),I=200,q=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_ARCHEOLOGIE_ROMEINSFORT&QUERY_LAYERS=CHS_2015_ARCHEOLOGIE_ROMEINSFORT&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${V[0]-I},${V[1]-I},${V[0]+I},${V[1]+I}`}`,X=await(await fetch(q)).json();if(X.features&&X.features.length>0){const F=X.features[0].properties;let te='<strong class="text-red-800">Romeins Fort</strong>';(F.naam||F.NAAM)&&(te+=`<br/><span class="text-sm font-semibold text-red-700">${F.naam||F.NAAM}</span>`),(F.type||F.TYPE)&&(te+=`<br/><span class="text-sm text-gray-700">${F.type||F.TYPE}</span>`),(F.periode||F.PERIODE)&&(te+=`<br/><span class="text-xs text-gray-500">${F.periode||F.PERIODE}</span>`),oe.push(te)}}catch(K){console.warn("Romeinse Forten WMS query failed:",K)}continue}if(Q==="Windmolens"){try{const K=Ct(z),V=Rt("EPSG:4326","EPSG:28992",K),I=50,q=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_NEDERZETTING_WINDMOLENS&QUERY_LAYERS=CHS_2015_NEDERZETTING_WINDMOLENS&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${V[0]-I},${V[1]-I},${V[0]+I},${V[1]+I}`}`,X=await(await fetch(q)).json();if(X.features&&X.features.length>0){const F=X.features[0].properties;let te='<strong class="text-amber-800">Windmolen</strong>';(F.naam||F.NAAM)&&(te+=`<br/><span class="text-sm font-semibold text-amber-700">${F.naam||F.NAAM}</span>`),(F.type||F.TYPE||F.functie||F.FUNCTIE)&&(te+=`<br/><span class="text-sm text-gray-700">${F.type||F.TYPE||F.functie||F.FUNCTIE}</span>`),(F.bouwjaar||F.BOUWJAAR)&&(te+=`<br/><span class="text-xs text-gray-500">Bouwjaar: ${F.bouwjaar||F.BOUWJAAR}</span>`),oe.push(te)}}catch(K){console.warn("Windmolens WMS query failed:",K)}continue}if(Q==="Erfgoedlijnen"){try{const K=Ct(z),V=Rt("EPSG:4326","EPSG:28992",K),I=200,q=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_ERFGOEDLIJN_HOOFDSTRUCTUUR&QUERY_LAYERS=CHS_ERFGOEDLIJN_HOOFDSTRUCTUUR&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${V[0]-I},${V[1]-I},${V[0]+I},${V[1]+I}`}`,X=await(await fetch(q)).json();if(X.features&&X.features.length>0){const F=X.features[0].properties;let te='<strong class="text-purple-800">Erfgoedlijn</strong>';(F.naam||F.NAAM||F.erfgoedlijn)&&(te+=`<br/><span class="text-sm font-semibold text-purple-700">${F.naam||F.NAAM||F.erfgoedlijn}</span>`),(F.type||F.TYPE)&&(te+=`<br/><span class="text-sm text-gray-700">${F.type||F.TYPE}</span>`),(F.omschrijving||F.OMSCHRIJVING)&&(te+=`<br/><span class="text-xs text-gray-500">${F.omschrijving||F.OMSCHRIJVING}</span>`),oe.push(te)}}catch(K){console.warn("Erfgoedlijnen WMS query failed:",K)}continue}if(Q==="Oude Kernen"){try{const K=Ct(z),V=Rt("EPSG:4326","EPSG:28992",K),I=200,q=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_ARCHEOLOGIE_KERNEN&QUERY_LAYERS=CHS_2015_ARCHEOLOGIE_KERNEN&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${V[0]-I},${V[1]-I},${V[0]+I},${V[1]+I}`}`,X=await(await fetch(q)).json();if(X.features&&X.features.length>0){const F=X.features[0].properties;let te='<strong class="text-stone-800">Historische Kern</strong>';(F.naam||F.NAAM)&&(te+=`<br/><span class="text-sm font-semibold text-stone-700">${F.naam||F.NAAM}</span>`),(F.type||F.TYPE)&&(te+=`<br/><span class="text-sm text-gray-700">${F.type||F.TYPE}</span>`),(F.periode||F.PERIODE)&&(te+=`<br/><span class="text-xs text-gray-500">${F.periode||F.PERIODE}</span>`),oe.push(te)}}catch(K){console.warn("Oude Kernen WMS query failed:",K)}continue}if(Q==="Relictenkaart Punten"){try{const K=Ct(z),V=Rt("EPSG:4326","EPSG:28992",K),I=50,q=`https://geoserver.gelderland.nl/geoserver/ngr_a/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=ChAr_Relictenkaart_p&QUERY_LAYERS=ChAr_Relictenkaart_p&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${V[0]-I},${V[1]-I},${V[0]+I},${V[1]+I}`}`,X=await(await fetch(q)).json();if(X.features&&X.features.length>0){const F=X.features[0].properties,te={KV:"Kasteel/Vesting",K:"Kapel",KE:"Kerkhof",B:"Buitenhuis",OB:"Oud Bebouwingsrelict",OV:"Oude Verkaveling",NR:"Nijverheidsrelict",GH:"Grafheuvel",BP:"Begraafplaats",HH:"Havezate",RM:"Rosmolen",WM:"Windmolen",PM:"Poldermolen",EK:"Eendenkooi",SH:"Scholtenhoeve"},Pe=F.type?.replace(/[0-9]/g,"")||"",Be=te[Pe]||F.type||"Cultuurhistorisch object";let Pt='<strong class="text-emerald-800">Relict</strong>';Pt+=`<br/><span class="text-sm font-semibold text-emerald-700">${Be}</span>`,F.type&&Pe!==F.type&&(Pt+=`<br/><span class="text-xs text-gray-500">Code: ${F.type}</span>`),F.streek&&(Pt+=`<br/><span class="text-xs text-gray-400">Streek: ${F.streek}</span>`),oe.push(Pt)}}catch(K){console.warn("Relictenkaart Punten WMS query failed:",K)}continue}if(Q==="Relictenkaart Lijnen"){try{const K=Ct(z),V=Rt("EPSG:4326","EPSG:28992",K),I=50,q=`https://geoserver.gelderland.nl/geoserver/ngr_a/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=ChAr_Relictenkaart_l&QUERY_LAYERS=ChAr_Relictenkaart_l&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${V[0]-I},${V[1]-I},${V[0]+I},${V[1]+I}`}`,X=await(await fetch(q)).json();if(X.features&&X.features.length>0){const F=X.features[0].properties,Pe={1:"Sprengenbeek",2:"Oude waterloop",3:"Doorgaande weg",4:"Hessenweg",5:"Oude weg",6:"Historische grens",7:"Trekpad",8:"Jaagpad"}[F.klasse]||`Historisch lijnrelict (${F.klasse})`;let Be='<strong class="text-teal-800">Lijnrelict</strong>';Be+=`<br/><span class="text-sm font-semibold text-teal-700">${Pe}</span>`,oe.push(Be)}}catch(K){console.warn("Relictenkaart Lijnen WMS query failed:",K)}continue}if(Q==="Relictenkaart Vlakken"){try{const K=Ct(z),V=Rt("EPSG:4326","EPSG:28992",K),I=100,q=`https://geoserver.gelderland.nl/geoserver/ngr_a/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=ChAr_Relictenkaart_v&QUERY_LAYERS=ChAr_Relictenkaart_v&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${V[0]-I},${V[1]-I},${V[0]+I},${V[1]+I}`}`,X=await(await fetch(q)).json();if(X.features&&X.features.length>0){const F=X.features[0].properties,Pe={1:"Onveranderd agrarisch (voor 1850)",2:"Jonge heideontginning (1850-1950)",3:"Open essencomplex",4:"Kampenlandschap",5:"Heiderelict (1850)",6:"Bosrelict (1850)",7:"Stuifzandrelict",8:"Oud bouwland",9:"Historisch grasland",10:"Beekdal"}[F.klasse]||`Historisch landschap (${F.klasse})`;let Be='<strong class="text-lime-800">Landschapsrelict</strong>';if(Be+=`<br/><span class="text-sm font-semibold text-lime-700">${Pe}</span>`,F.st_area_shape_){const Pt=(F.st_area_shape_/1e4).toFixed(1);Be+=`<br/><span class="text-xs text-gray-500">${Pt} ha</span>`}oe.push(Be)}}catch(K){console.warn("Relictenkaart Vlakken WMS query failed:",K)}continue}if(Q==="Verdronken Dorpen"){try{const K=Ct(z),V=Rt("EPSG:4326","EPSG:28992",K),I=200,q=`https://opengeodata.zeeland.nl/geoserver/chs/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=geocmd_vrddrppnt&QUERY_LAYERS=geocmd_vrddrppnt&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${V[0]-I},${V[1]-I},${V[0]+I},${V[1]+I}`}`,X=await(await fetch(q)).json();if(X.features&&X.features.length>0){const F=X.features[0].properties;let te='<strong class="text-blue-800">Verdronken Dorp</strong>';(F.naam||F.NAAM)&&(te+=`<br/><span class="text-sm font-semibold text-blue-700">${F.naam||F.NAAM}</span>`),(F.verdronken||F.VERDRONKEN||F.jaar||F.JAAR)&&(te+=`<br/><span class="text-xs text-gray-600">Verdronken: ${F.verdronken||F.VERDRONKEN||F.jaar||F.JAAR}</span>`),(F.gemeente||F.GEMEENTE)&&(te+=`<br/><span class="text-xs text-gray-500">${F.gemeente||F.GEMEENTE}</span>`),(F.bron||F.BRON)&&(te+=`<br/><span class="text-xs text-gray-400">${F.bron||F.BRON}</span>`),oe.push(te)}}catch(K){console.warn("Verdronken Dorpen WMS query failed:",K)}continue}const ce=_e.getFeatureInfoUrl(z,O,"EPSG:3857",{INFO_FORMAT:"application/json"});if(ce)try{const V=await(await fetch(ce)).json();if(V.features&&V.features.length>0){const I=V.features[0].properties;if(Q==="AHN 0.5m"){console.log(" AHN props:",I);let q='<strong class="text-blue-800">AHN Hoogtekaart</strong>';const fe=I.GRAY_INDEX??I.value??I.gray_index??I.dtm_05m??I.DTM_05M??I.hoogte??I.HOOGTE??I.elevation??I.ELEVATION;if(fe!=null&&!isNaN(Number(fe))){const X=typeof fe=="number"?fe.toFixed(2):Number(fe).toFixed(2);q+=`<br/><span class="text-sm text-blue-700">Hoogte: ${X} m NAP</span>`,oe.push(q)}else{let X=!1;const F=["geometry","id","fid","gml_id","bbox"];for(const[te,Pe]of Object.entries(I))!F.includes(te.toLowerCase())&&Pe!==null&&Pe!==""&&(q+=`<br/><span class="text-xs text-gray-600">${te}: ${Pe}</span>`,X=!0);X&&oe.push(q)}continue}if(Q==="Geomorfologie"){console.log(" Geomorfologie props:",I);let q='<strong class="text-green-800">Geomorfologie</strong>',fe=!1;const X=I.geomorphological_area_name??I.gm_ar_naam??I.gea_name??I.GEA_NAME,F=I.geomorphological_unit_name??I.gm_en_naam??I.gee_name??I.GEE_NAME,te=I.relief??I.relieftype??I.RELIEFTYPE,Pe=I.genesis_name??I.gn_naam??I.genesis??I.GENESIS;if(X&&(q+=`<br/><span class="text-sm text-green-700">${X}</span>`,fe=!0),F&&F!==X&&(q+=`<br/><span class="text-xs text-green-600">${F}</span>`,fe=!0),te&&te!=="Niet opgenomen"&&(q+=`<br/><span class="text-xs text-gray-600">Relief: ${te}</span>`,fe=!0),Pe&&Pe!=="Niet opgenomen"&&(q+=`<br/><span class="text-xs text-gray-500">Ontstaan: ${Pe}</span>`,fe=!0),!fe){const Be=["geometry","id","fid","gml_id","bbox"];for(const[Pt,Kn]of Object.entries(I))!Be.includes(Pt.toLowerCase())&&Kn!==null&&Kn!==""&&(q+=`<br/><span class="text-xs text-gray-600">${Pt}: ${Kn}</span>`)}oe.push(q);continue}let de=`<strong>${Q}</strong>`;if((I.first_soilname||I.soilname)&&(de+=`<br/><span class="text-sm text-amber-700">${I.first_soilname||I.soilname}</span>`),(I.soilcode||I.first_soilcode)&&(de+=`<br/><span class="text-xs text-gray-500">Code: ${I.soilcode||I.first_soilcode}</span>`),I.soilslope&&I.soilslope!=="Niet opgenomen"&&(de+=`<br/><span class="text-xs text-gray-500">Helling: ${I.soilslope}</span>`),!I.first_soilname&&!I.soilname){const q=["geometry","id","fid","gml_id","GRAY_INDEX","gray_index","value"];for(const[fe,X]of Object.entries(I))!q.includes(fe)&&X&&X!=="Niet opgenomen"&&(de+=`<br/><span class="text-xs text-gray-600">${fe}: ${X}</span>`)}oe.push(de)}}catch(K){console.warn("WMS GetFeatureInfo failed:",K)}}return oe},B=async z=>{const O=[],oe=kie(z.coordinate),Te=[];n.forEachFeatureAtPixel(z.pixel,ce=>{Te.push(ce)});for(const ce of Te){const K=ce.getProperties(),{geometry:V,...I}=K;if(I.kwaliteitswaarde&&I.kwaliteitswaarde.includes("archeologische waarde")){const X=k(I);O.push(X);continue}let de=I.name||I.naam||I.title||I.NAAM||I.NAME||I.label||I.route_name||I.road_name;de||(I.leisure==="playground"?de="Speeltuin":I.leisure==="park"?de="Park":I.leisure==="swimming_area"||I.sport==="swimming"?de="Zwemplek":I.tourism==="museum"?de="Museum":I.amenity==="cafe"||I.amenity==="restaurant"?de=I.amenity==="cafe"?"Caf":"Restaurant":I.historic==="castle"?de="Kasteel":de="Info");let q=`<strong>${de}</strong>`;if(I.category&&(q+=`<br/><span class="text-sm text-gray-600">Categorie: ${I.category}</span>`),I.from_to&&I.from_to!==de&&(q+=`<br/><span class="text-sm text-gray-600">${I.from_to}</span>`),I.route&&I.route!==de&&(q+=`<br/><span class="text-sm text-gray-600">${I.route}</span>`),I.TOPONIEM&&(q+=`<br/><span class="text-sm font-semibold text-gray-800">${I.TOPONIEM}</span>`,I.PLAATS&&(q+=`<br/><span class="text-xs text-gray-500">${I.PLAATS}</span>`)),(I.AARD_VINDP||I.Aard_vindp)&&(q+=`<br/><span class="text-sm text-gray-700">Aard: ${I.AARD_VINDP||I.Aard_vindp}</span>`),I.BEGIN_PER&&I.EIND_PER&&(q+=`<br/><span class="text-sm text-purple-700">Periode: ${I.BEGIN_PER} - ${I.EIND_PER}</span>`),(I.AARD_OPM||I.Aard_opmer)&&(q+=`<br/><span class="text-xs text-gray-600 italic">${I.AARD_OPM||I.Aard_opmer}</span>`),I.Gemeente&&(q+=`<br/><span class="text-sm text-gray-600">Gemeente: ${I.Gemeente}</span>`),I.Bron&&(q+=`<br/><span class="text-xs text-gray-500">Bron: ${I.Bron}</span>`),I.Bron_besch&&(q+=`<br/><span class="text-xs text-gray-500">${I.Bron_besch}</span>`),I.Dat_st_z&&I.Dat_ei_z&&(q+=`<br/><span class="text-sm text-purple-700">Datering: ${I.Dat_st_z} - ${I.Dat_ei_z}</span>`),I.Begin&&I.Einde&&(q+=`<br/><span class="text-sm text-purple-700">Periode: ${I.Begin} - ${I.Einde}</span>`),I.Uiterwaard&&(q+=`<br/><span class="text-sm font-semibold">${I.Uiterwaard}</span>`),I.rivier&&(q+=`<br/><span class="text-sm text-blue-600">Rivier: ${I.rivier}</span>`),I.Beschrijvi&&(q+=`<br/><span class="text-sm text-gray-700">${I.Beschrijvi}</span>`),I.leisure&&I.name){const X=I.leisure==="playground"?"Speeltuin":I.leisure==="park"?"Park":I.leisure==="swimming_area"?"Zwemplek":null;X&&(q+=`<br/><span class="text-xs text-green-600">${X}</span>`)}if((I.tourism==="museum"||I.museum)&&I.name&&(q+='<br/><span class="text-xs text-purple-600">Museum</span>'),(I.leisure==="swimming_area"||I.sport==="swimming")&&I.name&&(q+='<br/><span class="text-xs text-cyan-600">Zwemplek</span>'),I.osm_id&&I.address!==void 0&&(q+='<br/><span class="text-xs text-lime-600">Kringloopwinkel</span>',I.address&&(q+=`<br/><span class="text-xs text-gray-500">${I.address}</span>`),I.phone&&(q+=`<br/><span class="text-xs text-gray-600">${I.phone}</span>`)),(I.historic==="castle"||I.castle_type)&&(I.name&&(q+='<br/><span class="text-xs text-purple-600">Kasteel</span>'),I.castle_type&&(q+=`<br/><span class="text-xs text-gray-500">Type: ${I.castle_type}</span>`),I.start_date&&(q+=`<br/><span class="text-xs text-gray-500">Bouwjaar: ${I.start_date}</span>`),I.heritage&&(q+='<br/><span class="text-xs text-amber-600">Rijksmonument</span>')),I.bron==="Paleobiology Database"&&(I.taxonomie&&I.taxonomie!=="Onbekend"&&(q+=`<br/><span class="text-xs text-amber-700">${I.taxonomie}</span>`),I.periode&&I.periode!=="Onbekend"&&(q+=`<br/><span class="text-sm text-purple-700">${I.periode}</span>`),I.ouderdom&&I.ouderdom!=="Onbekend"&&(q+=`<br/><span class="text-xs text-gray-600">Ouderdom: ${I.ouderdom}</span>`),I.aantal_fossielen&&(q+=`<br/><span class="text-xs text-green-700">Aantal fossielen: ${I.aantal_fossielen}</span>`),I.formatie&&(q+=`<br/><span class="text-xs text-gray-500">Formatie: ${I.formatie}</span>`),I.lid&&(q+=`<br/><span class="text-xs text-gray-500">Lid: ${I.lid}</span>`),I.gesteente&&(q+=`<br/><span class="text-xs text-gray-500">Gesteente: ${I.gesteente}</span>`),I.milieu&&(q+=`<br/><span class="text-xs text-blue-600">Milieu: ${I.milieu}</span>`),I.vindplaats&&(q+=`<br/><span class="text-xs text-gray-500 italic">${I.vindplaats}</span>`)),(I.inventarisnummer||I.locatie_naam)&&(I.locatie_naam&&(q+=`<br/><span class="text-sm font-semibold">${I.locatie_naam}</span>`),I.inventarisnummer&&(q+=`<br/><span class="text-xs text-gray-500">CAI: ${I.inventarisnummer}</span>`),I.datering_tekst&&(q+=`<br/><span class="text-sm text-purple-700">${I.datering_tekst}</span>`)),(I.veensoort||I.dikte)&&(I.veensoort&&(q+=`<br/><span class="text-sm text-amber-700">${I.veensoort}</span>`),I.dikte&&(q+=`<br/><span class="text-xs text-gray-600">Dikte: ${I.dikte}</span>`)),I.nature&&I.debut){q+=`<br/><span class="text-sm text-purple-700">${I.nature}</span>`;const X=I.debut===I.fin?I.debut:`${I.debut} - ${I.fin}`;X&&(q+=`<br/><span class="text-sm text-gray-700">Periode: ${X}</span>`),I.structure&&(q+=`<br/><span class="text-xs text-gray-600">${I.structure}</span>`),I.commune&&(q+=`<br/><span class="text-xs text-gray-500">${I.commune}</span>`),I.decouvert&&(q+=`<br/><span class="text-xs text-gray-400">Ontdekt: ${I.decouvert}</span>`),I.numero&&(q+=`<br/><span class="text-xs text-gray-400">${I.numero}</span>`)}if((I.NATURE_OPE||I.CODE_OPERA)&&(I.TITRE&&(q+=`<br/><span class="text-sm font-semibold">${I.TITRE}</span>`),I.NATURE_OPE&&(q+=`<br/><span class="text-sm text-amber-700">${I.NATURE_OPE}</span>`),I.AUTEUR&&(q+=`<br/><span class="text-xs text-gray-600">Auteur: ${I.AUTEUR}</span>`),I.DATE&&(q+=`<br/><span class="text-xs text-gray-500">Datum: ${I.DATE}</span>`),I.COMMUNE&&(q+=`<br/><span class="text-xs text-gray-500">${I.COMMUNE}</span>`)),I.type_protection&&(I.n_site||I.t_site)){const X=I.type_protection==="Classe"?"text-red-700":"text-amber-700";q+=`<br/><span class="text-sm ${X}">${I.type_protection}</span>`,I.n_site&&(q+=`<br/><span class="text-sm font-semibold">${I.n_site}</span>`),I.t_site&&(q+=`<br/><span class="text-xs text-gray-600">${I.t_site}</span>`),I.c_site&&(q+=`<br/><span class="text-xs text-gray-500">Code: ${I.c_site}</span>`),I.d_creation&&(q+=`<br/><span class="text-xs text-gray-400">Beschermd sinds: ${I.d_creation}</span>`)}if(I.type_protection&&I.cod_diren){const X=I.type_protection==="Classe"?"text-red-700":"text-amber-700";if(q+=`<br/><span class="text-sm ${X}">${I.type_protection}</span>`,I.proced&&(q+=`<br/><span class="text-xs text-gray-600">${I.proced}</span>`),I.d_proced&&(q+=`<br/><span class="text-xs text-gray-500">Date: ${I.d_proced}</span>`),I.comment){const F=String(I.comment).slice(0,150);q+=`<br/><span class="text-xs text-gray-600 italic">${F}${String(I.comment).length>150?"...":""}</span>`}}if(I.type_protection&&I.nomsite){const X=I.type_protection==="Classe"?"text-red-700":"text-amber-700";if(q+=`<br/><span class="text-sm ${X}">${I.type_protection}</span>`,I.caractere&&(q+=`<br/><span class="text-xs text-gray-600">${I.caractere}</span>`),I.datedecis&&(q+=`<br/><span class="text-xs text-gray-500">Date: ${I.datedecis}</span>`),I.descriptio){const F=String(I.descriptio).slice(0,150);q+=`<br/><span class="text-xs text-gray-600 italic">${F}${String(I.descriptio).length>150?"...":""}</span>`}}if(I.secteur&&I.style){if(q+=`<br/><span class="text-sm text-gray-700">${I.secteur}</span>`,I["sous-secteur"]&&(q+=`<br/><span class="text-xs text-gray-600">${I["sous-secteur"]}</span>`),I.description){const X=String(I.description).slice(0,150);q+=`<br/><span class="text-xs text-gray-600 italic">${X}${String(I.description).length>150?"...":""}</span>`}I.url&&(q+=`<br/><a href="${I.url}" target="_blank" class="text-xs text-blue-600 hover:underline">Meer info</a>`)}if(I.nature_operation||I.synthese){I.nature_operation&&(q+=`<br/><span class="text-sm text-red-700">${I.nature_operation}</span>`),I.responsable_operation&&(q+=`<br/><span class="text-xs text-gray-600">Responsable: ${I.responsable_operation}</span>`),I.date_operation&&(q+=`<br/><span class="text-xs text-gray-500">Datum: ${I.date_operation}</span>`);const X=[];if(I.prehistoire==="Oui"&&X.push("Prehistorie"),I.protohistoire==="Oui"&&X.push("Protohistorie"),I.antiquite==="Oui"&&X.push("Romeins"),I.moyen_age==="Oui"&&X.push("Middeleeuwen"),I.temps_modernes==="Oui"&&X.push("Moderne tijd"),X.length>0&&(q+=`<br/><span class="text-sm text-purple-700">${X.join(", ")}</span>`),I.adresse&&(q+=`<br/><span class="text-xs text-gray-500">${I.adresse}</span>`),I.synthese){const F=String(I.synthese).slice(0,200);q+=`<br/><span class="text-xs text-gray-600 italic">${F}${String(I.synthese).length>200?"...":""}</span>`}}if(I.operator&&(q+=`<br/><span class="text-sm text-gray-600">${I.operator}</span>`),I.opening_hours&&(q+=`<br/><span class="text-xs text-green-600">Open: ${I.opening_hours}</span>`),I.website&&(q+=`<br/><a href="${I.website}" target="_blank" class="text-xs text-blue-600 underline">Website</a>`),I.addr_street){const X=[I.addr_street,I.addr_housenumber,I.addr_postcode].filter(Boolean).join(" ");q+=`<br/><span class="text-xs text-gray-500">${X}</span>`}const fe=I.description||I.omschrijving||I.descr||I.info;fe&&fe!==de&&(q+=`<br/><span class="text-sm text-gray-600">${fe}</span>`),O.push(q)}const we=n.getView().getResolution()||1,_e=await U(z.coordinate,we);O.push(..._e);const Q=await oe;if(O.length===0&&Q!==null){const ce=`<strong class="text-blue-800">Terrein</strong>
          <br/><div class="mt-2 pt-2 border-t border-gray-100 flex items-center gap-1">
            <span class="text-xs text-gray-400">Hoogte:</span>
            <span class="text-sm font-medium text-blue-600">${Q.toFixed(2)} m NAP</span>
          </div>`;O.push(ce)}O.length>0&&Q!==null&&(O[0]+=`<br/><div class="mt-2 pt-2 border-t border-gray-100 flex items-center gap-1">
          <span class="text-xs text-gray-400">Hoogte:</span>
          <span class="text-sm font-medium text-blue-600">${Q.toFixed(2)} m NAP</span>
        </div>`),O.length>0&&(t(O),r(0),c(z.coordinate),d(!1),o(!0))};return n.on("click",B),()=>{n.un("click",B)}},[n]);const L=()=>{o(!1),n&&h&&(rx(n),d(!1))},A=(k,U)=>{U.offset.y>100&&L()};return C.jsx(Lo,{children:s&&C.jsxs(C.Fragment,{children:[C.jsx(ln.div,{className:"fixed inset-0 z-[1500]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:L}),C.jsxs(ln.div,{className:"fixed bottom-0 left-0 right-0 z-[1501] bg-white rounded-t-2xl shadow-2xl",initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{type:"spring",damping:25,stiffness:300},drag:"y",dragConstraints:{top:0},dragElastic:.2,onDragEnd:A,children:[C.jsx("div",{className:"flex justify-center pt-2 pb-1",children:C.jsx("div",{className:"w-10 h-1 bg-gray-300 rounded-full"})}),C.jsxs("div",{className:"flex items-center gap-2 px-3 pb-2 border-b border-gray-100",children:[w&&C.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[C.jsx("button",{onClick:N,className:"w-7 h-7 flex items-center justify-center text-blue-600 hover:bg-blue-50 rounded-full transition-colors border-0 outline-none","aria-label":"Vorige laag",children:C.jsx(iQ,{size:18})}),C.jsxs("span",{className:"text-xs text-gray-500 font-medium min-w-[32px] text-center",children:[i+1,"/",e.length]}),C.jsx("button",{onClick:D,className:"w-7 h-7 flex items-center justify-center text-blue-600 hover:bg-blue-50 rounded-full transition-colors border-0 outline-none","aria-label":"Volgende laag",children:C.jsx(BD,{size:18})})]}),C.jsx("span",{className:"flex-1 font-semibold text-gray-800 truncate text-sm",children:E||"Info"}),C.jsx("button",{onClick:L,className:"w-7 h-7 flex items-center justify-center text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-full transition-colors flex-shrink-0","aria-label":"Sluiten",children:C.jsx(Fc,{size:18})})]}),C.jsx("div",{className:"px-4 py-3 max-h-[50vh] overflow-y-auto",dangerouslySetInnerHTML:{__html:P}}),M&&a&&C.jsx("div",{className:"px-4 pb-4 border-t border-gray-100",children:h?C.jsxs("button",{onClick:W,className:"w-full flex items-center justify-center gap-2 px-3 py-2 mt-3 text-sm text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors border-0 outline-none",children:[C.jsx(qw,{size:16}),C.jsx("span",{children:"Hoogtekaart verbergen"})]}):C.jsx("button",{onClick:j,disabled:g,className:`w-full flex items-center justify-center gap-2 px-3 py-2 mt-3 text-sm text-white rounded-lg transition-colors border-0 outline-none ${g?"bg-blue-400 cursor-wait":"bg-blue-500 hover:bg-blue-600"}`,children:g?C.jsxs(C.Fragment,{children:[C.jsx($D,{size:16,className:"animate-spin"}),C.jsx("span",{children:"Laden..."})]}):C.jsxs(C.Fragment,{children:[C.jsx(qw,{size:16}),C.jsx("span",{children:"Hoogtekaart tonen"})]})})})]})]})})}function Oie(){const n=Ei(E=>E.map),e=Ut(E=>E.position),t=on(E=>E.startNavigation),i=on(E=>E.isNavigating),[r,s]=se.useState(null),[o,a]=se.useState(!1),[c,h]=se.useState(!1),d=se.useRef(null),g=se.useRef(null);se.useEffect(()=>{if(!n){console.log(" LongPressMenu: map not ready");return}const E=n.getViewport();if(!E){console.log(" LongPressMenu: viewport not ready");return}console.log(" LongPressMenu: attached to viewport",E);const P=600,M=15,N=U=>{if(console.log(" Touch start, touches:",U.touches.length),U.touches.length!==1)return;const B=U.touches[0];g.current={x:B.clientX,y:B.clientY},console.log(" Starting long press timer at:",g.current),d.current&&clearTimeout(d.current),d.current=window.setTimeout(()=>{if(console.log(" Timer fired! startPos:",g.current),!g.current)return;const z=window.__olMap;if(!z){console.log(" Map not available (global)");return}const O=E.getBoundingClientRect(),oe=[g.current.x-O.left,g.current.y-O.top],Te=z.getCoordinateFromPixel(oe);if(Te){const we=Ct(Te);U.preventDefault(),s({pixel:[g.current.x,g.current.y],coordinate:we}),a(!0),h(!1),setTimeout(()=>h(!0),300),"vibrate"in navigator&&navigator.vibrate(50),console.log(" Long press detected at:",we)}},P)},D=U=>{if(!d.current||!g.current)return;const B=U.touches[0],z=B.clientX-g.current.x,O=B.clientY-g.current.y,oe=Math.sqrt(z*z+O*O);oe>M&&(console.log(" Touch moved too much, cancelling. Distance:",oe),clearTimeout(d.current),d.current=null)},j=()=>{console.log(" Touch end, timer active:",!!d.current),d.current&&(console.log(" Cancelling timer on touch end"),clearTimeout(d.current),d.current=null),g.current=null},W=U=>{o&&U.preventDefault()},L=U=>{U.button===0&&(console.log(" Mouse down"),g.current={x:U.clientX,y:U.clientY},d.current&&clearTimeout(d.current),d.current=window.setTimeout(()=>{if(console.log(" Mouse timer fired!"),!g.current)return;const B=window.__olMap;if(console.log(" __olMap:",B),console.log(" __olMap constructor:",B?.constructor?.name),console.log(" has getCoordinateAtPixel:",typeof B?.getCoordinateAtPixel),!B){console.log(" Map not available (global)");return}const z=E.getBoundingClientRect(),O=[g.current.x-z.left,g.current.y-z.top];console.log(" Pixel:",O);const oe=B.getCoordinateFromPixel(O);if(console.log(" Coordinate:",oe),oe){const Te=Ct(oe);s({pixel:[g.current.x,g.current.y],coordinate:Te}),a(!0),h(!1),setTimeout(()=>h(!0),300),console.log(" Long press (mouse) detected at:",Te)}},P))},A=U=>{if(!d.current||!g.current)return;const B=U.clientX-g.current.x,z=U.clientY-g.current.y;Math.sqrt(B*B+z*z)>M&&(console.log(" Mouse moved, cancelling"),clearTimeout(d.current),d.current=null)},k=()=>{console.log(" Mouse up"),d.current&&(clearTimeout(d.current),d.current=null),g.current=null};return E.addEventListener("touchstart",N,{passive:!1}),E.addEventListener("touchmove",D,{passive:!0}),E.addEventListener("touchend",j),E.addEventListener("touchcancel",j),E.addEventListener("contextmenu",W),E.addEventListener("mousedown",L),E.addEventListener("mousemove",A),E.addEventListener("mouseup",k),E.addEventListener("mouseleave",k),()=>{E.removeEventListener("touchstart",N),E.removeEventListener("touchmove",D),E.removeEventListener("touchend",j),E.removeEventListener("touchcancel",j),E.removeEventListener("contextmenu",W),E.removeEventListener("mousedown",L),E.removeEventListener("mousemove",A),E.removeEventListener("mouseup",k),E.removeEventListener("mouseleave",k),d.current&&clearTimeout(d.current)}},[n,o]);const m=()=>{c&&(a(!1),s(null),h(!1))},y=async()=>{if(!r||!e)return;const[E,P]=r.coordinate,M=`${P.toFixed(4)}, ${E.toFixed(4)}`;await t({lng:E,lat:P},M,{lng:e.lng,lat:e.lat}),a(!1),s(null),h(!1)},w=()=>{a(!1),s(null),h(!1)},T=E=>{const[P,M]=E;return`${M.toFixed(5)}N, ${P.toFixed(5)}E`};return C.jsx(Lo,{children:o&&r&&C.jsxs(C.Fragment,{children:[C.jsx(ln.div,{className:"fixed inset-0 z-[1600]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:m}),C.jsxs(ln.div,{className:"fixed z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden min-w-[200px]",style:{left:Math.min(r.pixel[0],window.innerWidth-220),top:Math.min(r.pixel[1],window.innerHeight-180)},initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.15},children:[C.jsx("div",{className:"px-4 py-3 bg-gray-50 border-b border-gray-100",children:C.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[C.jsx(WD,{size:16}),C.jsx("span",{className:"text-xs font-mono",children:T(r.coordinate)})]})}),C.jsxs("div",{className:"py-1",children:[C.jsxs("button",{onClick:y,disabled:!e||i,className:`w-full px-4 py-3 flex items-center gap-3 transition-colors ${e&&!i?"hover:bg-blue-50 text-gray-700":"text-gray-400 cursor-not-allowed"}`,children:[C.jsx(Dy,{size:20,className:e&&!i?"text-blue-500":"text-gray-300"}),C.jsx("span",{className:"font-medium",children:"Navigeer hierheen"})]}),!e&&C.jsx("div",{className:"px-4 py-2 text-xs text-amber-600 bg-amber-50",children:"GPS positie niet beschikbaar"}),i&&C.jsx("div",{className:"px-4 py-2 text-xs text-blue-600 bg-blue-50",children:"Navigatie al actief"})]}),C.jsx("div",{className:"border-t border-gray-100",children:C.jsxs("button",{onClick:w,className:"w-full px-4 py-3 flex items-center justify-center gap-2 text-gray-500 hover:bg-gray-50 transition-colors",children:[C.jsx(Fc,{size:18}),C.jsx("span",{children:"Annuleren"})]})})]})]})})}function Die(){return C.jsx("div",{className:"fixed bottom-2.5 left-2.5 z-[800] px-2 py-1 bg-white/90 rounded shadow-sm text-xs font-mono text-gray-600",children:"bvd v2.5.3"})}const Vie={Compass:hQ,TreePalm:KQ,Mountain:qw,Waves:JQ,Search:qD,Target:zQ,Layers:Tg,Grid:wQ},Fie={Compass:"text-purple-600",Waves:"text-cyan-600",TreePalm:"text-green-600",Mountain:"text-stone-600",Search:"text-amber-600",Target:"text-red-600",Layers:"text-blue-600",Grid:"text-lime-600"},Gie={Compass:"hover:bg-purple-50",Waves:"hover:bg-cyan-50",TreePalm:"hover:bg-green-50",Mountain:"hover:bg-stone-50",Search:"hover:bg-amber-50",Target:"hover:bg-red-50",Layers:"hover:bg-blue-50",Grid:"hover:bg-lime-50"},jie=["Labels Overlay","Hunebedden","FAMKE Steentijd","Grafheuvels","Terpen","AMK Monumenten","Romeinse wegen","Kastelen","IKAW","Archeo Landschappen","Rijksmonumenten","Werelderfgoed","WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Inundatiegebieden","Militaire Objecten","Paleokaart 800 n.Chr.","Paleokaart 100 n.Chr.","Paleokaart 500 v.Chr.","Paleokaart 1500 v.Chr.","Paleokaart 2750 v.Chr.","Paleokaart 5500 v.Chr.","Paleokaart 9000 v.Chr.","Religieus Erfgoed","UIKAV Punten","UIKAV Vlakken","UIKAV Expert","UIKAV Buffer","UIKAV Indeling","Veengebieden","AHN 0.5m","Geomorfologie","Bodemkaart","AHN4 Hillshade NL","AHN4 Multi-Hillshade NL","World Hillshade","Fossielen Nederland","Fossielen Belgi","Fossielen Duitsland","Fossielen Frankrijk","Parken","Speeltuinen","Musea","Strandjes","Gewaspercelen","Kadastrale Grenzen"],Uie=["CartoDB (licht)","OpenStreetMap","Luchtfoto","TMK 1850","Bonnebladen 1900"];function Bie(){const n=ai(d=>d.setLayerVisibility),e=Ut(d=>d.stopTracking),{presetsPanelOpen:t,togglePresetsPanel:i,toggleSettingsPanel:r,closeAllPanels:s}=xh(),{presets:o,applyPreset:a}=hO(),c=()=>{s(),jie.forEach(d=>n(d,!1)),Uie.forEach(d=>{n(d,d==="CartoDB (licht)")}),e(),console.log(" Reset: CartoDB (licht), alle lagen uit, GPS uit")},h=d=>{a(d),s()};return C.jsxs("div",{className:"fixed bottom-[30px] md:bottom-10 left-2 z-[800]",children:[C.jsxs("div",{className:"flex flex-col gap-2",children:[C.jsx("button",{onClick:i,className:"w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",title:"Presets",children:t?C.jsx(zD,{size:22,className:"text-blue-600"}):C.jsx(Tg,{size:22,className:"text-blue-600"})}),C.jsx("button",{onClick:c,className:"w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",title:"Reset - CartoDB, alle lagen uit, GPS uit",children:C.jsx(Yw,{size:22,className:"text-gray-600"})}),C.jsx("button",{onClick:r,className:"w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",title:"Instellingen",children:C.jsx(YD,{size:22,className:"text-gray-600"})})]}),C.jsx(Lo,{children:t&&C.jsxs(C.Fragment,{children:[C.jsx(ln.div,{className:"fixed inset-0 z-[-1]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:i}),C.jsxs(ln.div,{initial:{opacity:0,y:10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.95},transition:{duration:.15},className:"absolute bottom-0 left-14 bg-white/95 rounded-xl shadow-lg overflow-hidden min-w-[140px] backdrop-blur-sm",children:[C.jsx("div",{className:"px-3 py-1.5 bg-gradient-to-r from-blue-500 to-blue-600 text-white text-xs font-medium",children:"Presets"}),C.jsx("div",{className:"p-2",children:o.map(d=>{const g=Vie[d.icon]||Tg,m=Fie[d.icon]||"text-blue-600",y=Gie[d.icon]||"hover:bg-blue-50";return C.jsxs("button",{onClick:()=>h(d.id),className:`w-full flex items-center gap-2 px-2 py-1.5 ${y} rounded text-left transition-colors border-0 outline-none bg-transparent`,children:[C.jsx(g,{size:14,className:m}),C.jsx("span",{className:"text-xs text-gray-700",children:d.name}),!d.isBuiltIn&&C.jsx("span",{className:"ml-auto text-[10px] text-gray-400",children:"custom"})]},d.id)})})]})]})})]})}function zie(){const{infoPanelOpen:n,toggleInfoPanel:e}=xh();return C.jsxs(C.Fragment,{children:[C.jsx("button",{onClick:e,className:"fixed top-2.5 right-2.5 z-[800] w-8 h-8 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-lg shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",title:"Info & Attributies",children:C.jsx(SQ,{size:16,className:"text-blue-600"})}),C.jsx(Lo,{children:n&&C.jsxs(C.Fragment,{children:[C.jsx(ln.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),C.jsxs(ln.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[90vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[C.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-blue-500 to-blue-600 text-white",children:[C.jsx("span",{className:"font-medium",children:"Info & Attributies"}),C.jsx("button",{onClick:e,className:"p-1 rounded hover:bg-white/20 transition-colors",children:C.jsx(Fc,{size:18})})]}),C.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 text-sm",children:[C.jsxs("section",{children:[C.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Over deze app"}),C.jsx("p",{className:"text-gray-600",children:"Detectorapp NL is een kaartapplicatie voor metal detecting en archeologische verkenning in Nederland."})]}),C.jsxs("section",{children:[C.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Databronnen & Licenties"}),C.jsxs("ul",{className:"space-y-2 text-gray-600",children:[C.jsxs("li",{children:[C.jsx("strong",{children:"RCE / Cultureelerfgoed.nl"})," (CC0/CC-BY)",C.jsx("br",{}),C.jsx("span",{className:"text-xs",children:"AMK, Rijksmonumenten, Werelderfgoed, Paleokaarten, Religieus Erfgoed"})]}),C.jsxs("li",{children:[C.jsx("strong",{children:"PDOK / Kadaster"})," (CC0/CC-BY)",C.jsx("br",{}),C.jsx("span",{className:"text-xs",children:"Luchtfoto, AHN, IKAW, Bodemkaart, Geomorfologie"})]}),C.jsxs("li",{children:[C.jsx("strong",{children:"OpenStreetMap"})," (ODbL)",C.jsx("br",{}),C.jsx("span",{className:"text-xs",children:"Hunebedden, Grafheuvels, Bunkers, Kastelen, Parken, etc."})]}),C.jsxs("li",{children:[C.jsx("strong",{children:"Itiner-E"})," (CC BY 4.0)",C.jsx("br",{}),C.jsx("span",{className:"text-xs",children:"Romeinse wegen - Brughmans, Paout, de Soto & Bjerregaard Vahlstrup"})]}),C.jsxs("li",{children:[C.jsx("strong",{children:"CARTO"})," (CC BY 3.0)",C.jsx("br",{}),C.jsx("span",{className:"text-xs",children:"CartoDB basiskaart"})]}),C.jsxs("li",{children:[C.jsx("strong",{children:"Map5.nl / Kadaster"}),C.jsx("br",{}),C.jsx("span",{className:"text-xs",children:"Historische kaarten (TMK 1850, Bonnebladen 1900)"})]}),C.jsxs("li",{children:[C.jsx("strong",{children:"Friesland Geoportal"}),C.jsx("br",{}),C.jsx("span",{className:"text-xs",children:"FAMKE Steentijd, Terpen"})]}),C.jsxs("li",{children:[C.jsx("strong",{children:"UIKAV / Rijkswaterstaat"}),C.jsx("br",{}),C.jsx("span",{className:"text-xs",children:"Uiterwaarden archeologische data"})]})]})]}),C.jsxs("section",{children:[C.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Privacy"}),C.jsxs("div",{className:"text-gray-600 space-y-2",children:[C.jsxs("p",{children:[C.jsx("strong",{children:"Locatiegegevens:"})," Deze app gebruikt uw GPS-locatie alleen voor navigatie op de kaart. Locatiegegevens worden niet opgeslagen of gedeeld met derden."]}),C.jsxs("p",{children:[C.jsx("strong",{children:"Geen tracking:"})," We verzamelen geen persoonlijke gegevens, analytics of gebruiksstatistieken."]}),C.jsxs("p",{children:[C.jsx("strong",{children:"Lokale opslag:"})," Alle kaartdata wordt lokaal in de app opgeslagen. Er worden geen gegevens naar externe servers gestuurd."]})]})]}),C.jsxs("section",{children:[C.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Contact"}),C.jsx("p",{className:"text-gray-600",children:"Vragen of feedback? Neem contact op via de ontwikkelaar."})]}),C.jsx("section",{className:"pt-2 border-t border-gray-200",children:C.jsx("p",{className:"text-xs text-gray-400 text-center",children:"Detectorapp NL v2.5.3"})})]})]})]})})]})}const $ie=[{name:"AHN4 Hillshade NL",color:"blue",default:.7},{name:"AHN4 Multi-Hillshade NL",color:"blue",default:.7},{name:"AHN4 Helling NL",color:"blue",default:.6},{name:"AHN 0.5m",color:"blue",default:.7},{name:"World Hillshade",color:"blue",default:.7},{name:"Geomorfologie",color:"green",default:.5},{name:"Bodemkaart",color:"amber",default:.6},{name:"IKAW",color:"orange",default:.5},{name:"Archeo Landschappen",color:"green",default:.5},{name:"AMK Monumenten",color:"purple",default:.8}],Wie={blue:"accent-blue-500",amber:"accent-amber-500",red:"accent-red-500",indigo:"accent-indigo-500",green:"accent-green-500",orange:"accent-orange-500",purple:"accent-purple-500"};function Hie(){const[n,e]=se.useState(!1),[t,i]=se.useState(!1),r=ai(d=>d.visible),s=ai(d=>d.opacity),o=ai(d=>d.setLayerOpacity),a=$ie.filter(d=>r[d.name]);if(a.length===0)return null;const c=t?a:a.slice(0,3),h=a.length>3;return C.jsxs("div",{className:"fixed bottom-[140px] md:bottom-[150px] right-2.5 z-[900]",children:[C.jsxs(ln.button,{onClick:()=>e(!n),className:"w-11 h-11 bg-white/80 rounded-xl backdrop-blur-sm shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none hover:bg-white/90 transition-colors",whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":"Opacity sliders",title:n?"Sluit opacity sliders":"Open opacity sliders",children:[C.jsx(GQ,{size:22,strokeWidth:2,className:"text-gray-500"}),a.length>0&&C.jsx("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-blue-500 text-white text-[10px] rounded-full flex items-center justify-center",children:a.length})]}),C.jsx(Lo,{children:n&&C.jsxs(ln.div,{initial:{opacity:0,x:20,scale:.9},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:20,scale:.9},transition:{duration:.2},className:"absolute bottom-0 right-14 bg-white/95 rounded-lg shadow-lg p-3 min-w-[220px] max-h-[60vh] overflow-y-auto",children:[C.jsx("div",{className:"text-xs font-semibold text-gray-500 mb-2 uppercase tracking-wide",children:"Transparantie"}),C.jsx("div",{className:"space-y-3",children:c.map(d=>{const g=s[d.name]??d.default;return C.jsxs("div",{children:[C.jsx("label",{className:"text-xs font-medium text-gray-700 mb-1 block truncate",title:d.name,children:d.name}),C.jsxs("div",{className:"flex items-center gap-2",children:[C.jsx("input",{type:"range",min:"0",max:"100",value:g*100,onChange:m=>o(d.name,parseInt(m.target.value)/100),className:`flex-1 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer ${Wie[d.color]}`}),C.jsxs("span",{className:"text-xs text-gray-500 w-8 text-right select-none pointer-events-none",children:[Math.round(g*100),"%"]})]})]},d.name)})}),h&&C.jsx("button",{onClick:()=>i(!t),className:"w-full mt-3 pt-2 border-t border-gray-200 flex items-center justify-center gap-1 text-xs text-gray-500 hover:text-gray-700",children:t?C.jsxs(C.Fragment,{children:[C.jsx(zD,{size:14}),"Minder tonen"]}):C.jsxs(C.Fragment,{children:[C.jsx(tQ,{size:14}),a.length-3," meer..."]})})]})})]})}function Kie(){const n=Ei(N=>N.map),e=Ut(N=>N.position),t=on(N=>N.startNavigation);on(N=>N.isNavigating);const i=on(N=>N.loading),[r,s]=se.useState(""),[o,a]=se.useState([]),[c,h]=se.useState(!1),[d,g]=se.useState(!1),m=se.useRef(null),y=se.useRef();se.useEffect(()=>{if(y.current&&clearTimeout(y.current),r.length<2){a([]);return}return y.current=window.setTimeout(async()=>{g(!0);try{const D=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/suggest?q=${encodeURIComponent(r)}&rows=7`)).json();D.response?.docs&&a(D.response.docs)}catch(N){console.error("Search error:",N),a([])}finally{g(!1)}},300),()=>{y.current&&clearTimeout(y.current)}},[r]);const w=async N=>{try{const j=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/lookup?id=${encodeURIComponent(N)}`)).json();if(j.response?.docs?.[0]?.centroide_ll){const L=j.response.docs[0].centroide_ll.match(/POINT\(([^ ]+) ([^)]+)\)/);if(L)return{lng:parseFloat(L[1]),lat:parseFloat(L[2])}}}catch(D){console.error("Lookup error:",D)}return null},T=async N=>{if(!n)return;const D=await w(N.id);D&&n.getView().animate({center:ac([D.lng,D.lat]),zoom:16,duration:1e3}),s(""),a([]),h(!1)},E=async(N,D)=>{if(D.stopPropagation(),!e){alert("GPS positie niet beschikbaar. Zet GPS aan.");return}const j=await w(N.id);j&&await t(j,N.weergavenaam,{lng:e.lng,lat:e.lat}),s(""),a([]),h(!1)},P=()=>{s(""),a([]),m.current?.focus()},M=N=>{switch(N){case"adres":return"";case"weg":return"";case"woonplaats":return"";case"gemeente":return"";case"provincie":return"";case"postcode":return"";default:return""}};return C.jsxs("div",{className:"search-box",children:[C.jsxs("div",{className:"search-input-wrapper",children:[C.jsx(qD,{size:18,className:"search-icon"}),C.jsx("input",{ref:m,type:"text",value:r,onChange:N=>{s(N.target.value),h(!0)},onFocus:()=>h(!0),placeholder:"Zoek adres of plaats...",className:"search-input"}),r&&C.jsx("button",{onClick:P,className:"search-clear",children:C.jsx(Fc,{size:16})})]}),c&&o.length>0&&C.jsx("ul",{className:"search-results",children:o.map(N=>C.jsxs("li",{className:"search-result-item",children:[C.jsxs("div",{className:"search-result-content",onClick:()=>T(N),children:[C.jsx("span",{className:"search-result-icon",children:M(N.type)}),C.jsx("span",{className:"search-result-text",children:N.weergavenaam})]}),C.jsx("button",{className:"search-navigate-btn",onClick:D=>E(N,D),disabled:i||!e,title:e?"Navigeer hierheen":"GPS niet actief",children:C.jsx(Dy,{size:16})})]},N.id))}),c&&d&&C.jsx("div",{className:"search-loading",children:"Zoeken..."})]})}function qie(){const n=Ei(i=>i.map),e=()=>{if(!n)return;const i=n.getView(),r=i.getZoom();r!==void 0&&i.animate({zoom:r+1,duration:200})},t=()=>{if(!n)return;const i=n.getView(),r=i.getZoom();r!==void 0&&i.animate({zoom:r-1,duration:200})};return C.jsxs("div",{className:"fixed top-14 left-2.5 z-[800] flex flex-col gap-1",children:[C.jsx(ln.button,{className:"w-8 h-8 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-lg shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},title:"Inzoomen",children:C.jsx(KD,{size:16,className:"text-gray-600"})}),C.jsx(ln.button,{className:"w-8 h-8 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-lg shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",onClick:t,whileHover:{scale:1.05},whileTap:{scale:.95},title:"Uitzoomen",children:C.jsx(bQ,{size:16,className:"text-gray-600"})})]})}function Yie(){const{settingsPanelOpen:n,toggleSettingsPanel:e}=xh(),t=eI(),{presets:i,createPreset:r,deletePreset:s}=hO(),[o,a]=se.useState(""),[c,h]=se.useState(!1),d=()=>{o.trim()&&(r(o.trim(),"Layers"),a(""),h(!1))};return C.jsx(Lo,{children:n&&C.jsxs(C.Fragment,{children:[C.jsx(ln.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),C.jsxs(ln.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-sm mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[C.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-blue-500 to-blue-600 text-white",children:[C.jsxs("div",{className:"flex items-center gap-2",children:[C.jsx(YD,{size:18}),C.jsx("span",{className:"font-medium",children:"Instellingen"})]}),C.jsx("button",{onClick:e,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none",children:C.jsx(Fc,{size:18})})]}),C.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-5",children:[C.jsxs(e0,{title:"Kaart",icon:C.jsx(HD,{size:16}),children:[C.jsx(Xie,{label:"Standaard achtergrond",children:C.jsxs("select",{value:t.defaultBackground,onChange:g=>t.setDefaultBackground(g.target.value),className:"px-2 py-1 text-sm bg-gray-100 rounded border-0 outline-none",children:[C.jsx("option",{value:"CartoDB (licht)",children:"Licht"}),C.jsx("option",{value:"OpenStreetMap",children:"OSM"}),C.jsx("option",{value:"Luchtfoto",children:"Luchtfoto"})]})}),C.jsx(Jd,{label:"Schaalbalk tonen",checked:t.showScaleBar,onChange:t.setShowScaleBar})]}),C.jsxs(e0,{title:"GPS",icon:C.jsx(Dy,{size:16}),children:[C.jsx(Jd,{label:"GPS aan bij start",checked:t.gpsAutoStart,onChange:t.setGpsAutoStart}),C.jsx(Jd,{label:"Kaart draait mee (heading up)",checked:t.headingUpMode,onChange:t.setHeadingUpMode}),C.jsx(Jd,{label:"Nauwkeurigheidscirkel",checked:t.showAccuracyCircle,onChange:t.setShowAccuracyCircle})]}),C.jsx(e0,{title:"Feedback",icon:C.jsx(UQ,{size:16}),children:C.jsx(Jd,{label:"Trillen bij acties",checked:t.hapticFeedback,onChange:t.setHapticFeedback})}),C.jsx(e0,{title:"Presets",icon:C.jsx(Tg,{size:16}),children:C.jsxs("div",{className:"space-y-2",children:[i.map(g=>C.jsxs("div",{className:"flex items-center justify-between py-1",children:[C.jsxs("span",{className:"text-sm text-gray-600",children:[g.name,g.isBuiltIn&&C.jsx("span",{className:"ml-1 text-[10px] text-gray-400",children:"(standaard)"})]}),!g.isBuiltIn&&C.jsx("button",{onClick:()=>s(g.id),className:"p-1 text-red-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors border-0 outline-none",title:"Verwijderen",children:C.jsx(WQ,{size:14})})]},g.id)),c?C.jsxs("div",{className:"flex gap-2 mt-2",children:[C.jsx("input",{type:"text",value:o,onChange:g=>a(g.target.value),placeholder:"Naam nieuwe preset",className:"flex-1 px-2 py-1 text-sm bg-gray-100 rounded border-0 outline-none",onKeyDown:g=>g.key==="Enter"&&d(),autoFocus:!0}),C.jsx("button",{onClick:d,className:"px-2 py-1 text-xs bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors border-0 outline-none",children:"Opslaan"}),C.jsx("button",{onClick:()=>h(!1),className:"px-2 py-1 text-xs bg-gray-200 text-gray-600 rounded hover:bg-gray-300 transition-colors border-0 outline-none",children:"Annuleren"})]}):C.jsxs("button",{onClick:()=>h(!0),className:"flex items-center gap-2 mt-2 px-2 py-1.5 text-sm text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none w-full",children:[C.jsx(KD,{size:14}),C.jsx("span",{children:"Huidige lagen als preset opslaan"})]})]})})]}),C.jsx("div",{className:"px-4 py-2 border-t border-gray-100 text-xs text-gray-400 text-center",children:"Instellingen worden lokaal opgeslagen"})]})]})})}function e0({title:n,icon:e,children:t}){return C.jsxs("section",{children:[C.jsxs("div",{className:"flex items-center gap-2 mb-2 pb-1 border-b border-gray-100",children:[C.jsx("span",{className:"text-blue-600",children:e}),C.jsx("span",{className:"font-medium text-gray-800 text-sm",children:n})]}),C.jsx("div",{className:"space-y-2",children:t})]})}function Xie({label:n,children:e}){return C.jsxs("div",{className:"flex items-center justify-between",children:[C.jsx("span",{className:"text-sm text-gray-600",children:n}),e]})}function Jd({label:n,checked:e,onChange:t}){return C.jsxs("div",{className:"flex items-center justify-between",children:[C.jsx("span",{className:"text-sm text-gray-600",children:n}),C.jsx("button",{onClick:()=>t(!e),className:`w-10 h-5 rounded-full transition-colors border-0 outline-none relative ${e?"bg-blue-500":"bg-gray-300"}`,children:C.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white shadow transition-transform ${e?"translate-x-5":"translate-x-0.5"}`})})]})}function Qie(n,e){const i=(e.lat-n.lat)*Math.PI/180,r=(e.lng-n.lng)*Math.PI/180,s=Math.sin(i/2)*Math.sin(i/2)+Math.cos(n.lat*Math.PI/180)*Math.cos(e.lat*Math.PI/180)*Math.sin(r/2)*Math.sin(r/2);return 6371e3*(2*Math.atan2(Math.sqrt(s),Math.sqrt(1-s)))}function Zie(n,e){let t=1/0,i=0;for(let r=0;r<e.length;r++){const s=Qie(n,e[r]);s<t&&(t=s,i=r)}return i}function Jie(){const n=Ei(a=>a.map),e=on(a=>a.routeCoordinates),t=on(a=>a.destination),i=on(a=>a.isNavigating),r=Ut(a=>a.position),s=se.useRef(null),o=se.useRef(0);return se.useEffect(()=>{if(!n)return;const a=new bx;return s.current=new jx({source:a,zIndex:500}),n.addLayer(s.current),()=>{s.current&&n&&n.removeLayer(s.current)}},[n]),se.useEffect(()=>{i||(o.current=0)},[i]),se.useEffect(()=>{if(!s.current)return;const a=s.current.getSource();if(!a||(a.clear(),!i||!e||e.length===0))return;let c=0;if(r&&e.length>2){const m={lng:r.lng,lat:r.lat},y=Zie(m,e);y>o.current&&(o.current=y),c=o.current,c>e.length-2&&(c=e.length-2)}const d=e.slice(c).map(m=>ac([m.lng,m.lat])),g=new gh({geometry:new lc(d)});if(g.setStyle([new ji({stroke:new ka({color:"white",width:8,lineCap:"round",lineJoin:"round"})}),new ji({stroke:new ka({color:"#4285F4",width:5,lineCap:"round",lineJoin:"round"})})]),a.addFeature(g),t){const m=new gh({geometry:new cc(ac([t.lng,t.lat]))});m.setStyle(new ji({image:new Uh({radius:12,fill:new wo({color:"#EA4335"}),stroke:new ka({color:"white",width:3})})})),a.addFeature(m)}if(n&&c===0){const m=a.getExtent();n.getView().fit(m,{padding:[80,80,80,80],duration:500})}},[n,i,e,t,r]),null}function ere(n){const e={size:24,className:"text-white"};return n.includes("left")?n.includes("sharp")?C.jsx(fQ,{...e}):n.includes("slight")?C.jsx(KX,{...e}):C.jsx(zX,{...e}):n.includes("right")?n.includes("sharp")?C.jsx(mQ,{...e}):n.includes("slight")?C.jsx(YX,{...e}):C.jsx(WX,{...e}):n.includes("uturn")?C.jsx(Yw,{...e}):n.includes("arrive")?C.jsx(cQ,{...e}):n.includes("roundabout")||n.includes("rotary")?C.jsx(Yw,{...e}):C.jsx(QX,{...e})}function tre(){const n=on(m=>m.isNavigating),e=on(m=>m.destinationName),t=on(m=>m.distance),i=on(m=>m.duration),r=on(m=>m.steps),s=on(m=>m.currentStepIndex),o=on(m=>m.voiceEnabled),a=on(m=>m.setVoiceEnabled),c=on(m=>m.stopNavigation),h=r[s],d=m=>m?m<1e3?`${Math.round(m)} m`:`${(m/1e3).toFixed(1)} km`:"--",g=m=>{if(!m)return"--";if(m<60)return`${Math.round(m)} sec`;const y=Math.round(m/60);if(y<60)return`${y} min`;const w=Math.floor(y/60),T=y%60;return`${w}u ${T}m`};return C.jsx(Lo,{children:n&&C.jsxs(ln.div,{className:"fixed top-16 left-2 right-2 z-[1100] bg-white rounded-xl shadow-lg overflow-hidden",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.2},children:[h&&C.jsxs("div",{className:"bg-blue-600 px-4 py-3 flex items-center gap-3",children:[C.jsx("div",{className:"w-12 h-12 rounded-full bg-blue-700 flex items-center justify-center flex-shrink-0",children:ere(h.maneuver)}),C.jsxs("div",{className:"flex-1 min-w-0",children:[C.jsx("div",{className:"text-white font-bold text-lg truncate",children:h.instruction}),C.jsxs("div",{className:"text-blue-200 text-sm",children:["Over ",d(h.distance)]})]}),C.jsx("button",{onClick:()=>a(!o),className:`w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0 transition-colors ${o?"bg-blue-700 text-white":"bg-blue-800 text-blue-400"}`,title:o?"Geluid uit":"Geluid aan",children:o?C.jsx(YQ,{size:20}):C.jsx(QQ,{size:20})})]}),C.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 border-t border-gray-100",children:[C.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center flex-shrink-0",children:C.jsx(Dy,{size:20,className:"text-gray-600"})}),C.jsxs("div",{className:"flex-1 min-w-0",children:[C.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500",children:[C.jsx(WD,{size:12}),C.jsx("span",{children:"Bestemming"})]}),C.jsx("div",{className:"font-medium text-gray-900 truncate text-sm",children:e||"Bestemming"})]}),C.jsxs("div",{className:"text-right flex-shrink-0",children:[C.jsx("div",{className:"text-lg font-bold text-blue-600",children:d(t)}),C.jsx("div",{className:"text-xs text-gray-500",children:g(i)})]}),C.jsx("button",{onClick:c,className:"w-10 h-10 rounded-full bg-red-500 hover:bg-red-600 flex items-center justify-center flex-shrink-0 transition-colors",title:"Stop navigatie",children:C.jsx(Fc,{size:20,className:"text-white"})})]}),r.length>1&&C.jsxs("div",{className:"px-4 pb-2",children:[C.jsx("div",{className:"flex gap-1",children:r.map((m,y)=>C.jsx("div",{className:`h-1 flex-1 rounded-full transition-colors ${y<s?"bg-green-500":y===s?"bg-blue-500":"bg-gray-200"}`},y))}),C.jsxs("div",{className:"text-xs text-gray-400 mt-1 text-center",children:["Stap ",s+1," van ",r.length]})]})]})})}function nre(){const n=Ut(i=>i.tracking),e=Ut(i=>i.headingSource),t=Ut(i=>i.updateHeading);se.useEffect(()=>{if(!n||e!=="compass")return;let i=0;const r=100,s=c=>{const h=Date.now();h-i<r||(i=h,c.alpha!==null&&t(360-c.alpha,"compass"))},o=c=>{const h=Date.now();h-i<r||(i=h,c.alpha!==null&&t(360-c.alpha,"compass"))},a=c=>{const h=Date.now();h-i<r||(i=h,c.webkitCompassHeading!==void 0&&t(c.webkitCompassHeading,"compass"))};return window.addEventListener("deviceorientationabsolute",o),window.addEventListener("deviceorientation",s),window.addEventListener("deviceorientation",a),()=>{window.removeEventListener("deviceorientationabsolute",o),window.removeEventListener("deviceorientation",s),window.removeEventListener("deviceorientation",a)}},[n,e,t])}const ire=n=>n<.5?2*n*n:-1+(4-2*n)*n;function rre(){const n=Ei(c=>c.map),e=Ei(c=>c.rotationEnabled),t=Ei(c=>c.setRotation),i=Ut(c=>c.smoothHeading),r=Ut(c=>c.tracking),s=Ut(c=>c.navigationMode),o=se.useRef(null),a=se.useRef(null);se.useEffect(()=>{n&&(s==="drive"&&a.current!=="drive"&&(n.getView().animate({zoom:15,duration:500}),console.log(" Rijmodus: zoom naar wijkniveau (15)")),a.current=s)},[n,s]),se.useEffect(()=>{if(s==="free"){n&&n.getView().getRotation()!==0&&(n.getView().animate({rotation:0,duration:500}),t(0),o.current=null);return}if(!n||!r||!e||i===null){n&&!r&&(n.getView().animate({rotation:0,duration:500}),t(0),o.current=null);return}const c=i*Math.PI/180,h=o.current??n.getView().getRotation();let d=c-h;for(;d>Math.PI;)d-=2*Math.PI;for(;d<-Math.PI;)d+=2*Math.PI;Math.abs(d)<.087||(n.getView().animate({rotation:c,duration:250,easing:ire}),o.current=c,t(i))},[n,r,e,i,t])}function sre(){const n=Ei(d=>d.map),e=Ut(d=>d.position),t=Ut(d=>d.tracking),i=Ut(d=>d.navigationMode),r=Ut(d=>d.toggleMode),s=on(d=>d.isNavigating),o=on(d=>d.updateCurrentStep),a=on(d=>d.destination),c=se.useRef(!1),h=se.useRef(0);return se.useEffect(()=>{s&&!c.current?(console.log(" Navigation started - activating drive mode"),i==="free"&&r(),c.current=!0):!s&&c.current&&(console.log(" Navigation stopped - deactivating drive mode"),i==="drive"&&r(),c.current=!1)},[s,i,r]),se.useEffect(()=>{!s||!e||o({lng:e.lng,lat:e.lat})},[s,e,o]),se.useEffect(()=>{if(!n||!e||!s||!t)return;const d=Date.now();if(d-h.current<500)return;h.current=d;const g=ac([e.lng,e.lat]);n.getView().animate({center:g,duration:300})},[n,e,s,t]),se.useEffect(()=>{if(!n||!s)return;(n.getView().getZoom()||15)<14&&n.getView().animate({zoom:15,duration:500})},[n,s,e]),{isNavigating:s,destination:a}}function ore(){const n=Ei(r=>r.map),e=ai(r=>r.setLayerOpacity),t=ai(r=>r.visible),i=se.useRef(null);se.useEffect(()=>{if(!n)return;const r=()=>{const s=n.getView().getZoom();if(!s||i.current!==null&&Math.abs(s-i.current)<.5)return;i.current=s;const o=t["AHN 0.5m"],a=t["AHN4 Multi-Hillshade NL"];!o&&!a||(o&&(s>=18?e("AHN 0.5m",.85):s>=16?e("AHN 0.5m",.75):s>=14?e("AHN 0.5m",.65):e("AHN 0.5m",.55)),a&&(s>=18?e("AHN4 Multi-Hillshade NL",.8):s>=16?e("AHN4 Multi-Hillshade NL",.7):s>=14?e("AHN4 Multi-Hillshade NL",.6):e("AHN4 Multi-Hillshade NL",.5)))};return n.on("moveend",r),r(),()=>{n.un("moveend",r)}},[n,t,e])}function are(){return nre(),rre(),sre(),ore(),C.jsxs(C.Fragment,{children:[C.jsx(uH,{}),C.jsx(iZ,{}),C.jsx(Jie,{}),C.jsx(Nie,{}),C.jsx(Oie,{}),C.jsx(Kie,{}),C.jsx(tre,{}),C.jsx(nZ,{}),C.jsx(qie,{}),C.jsx(sZ,{}),C.jsx(oZ,{}),C.jsx(Hie,{}),C.jsx(Die,{}),C.jsx(Bie,{}),C.jsx(zie,{}),C.jsx(Yie,{})]})}F5.createRoot(document.getElementById("root")).render(C.jsx(are,{}));export{gh as $,mR as A,Ao as B,w4 as C,fP as D,Qe as E,G4 as F,jx as G,ji as H,Ke as I,ka as J,wo as K,Z_ as L,bx as M,mie as N,Rt as O,kx as P,a6 as Q,AE as R,m4 as S,Ll as T,ux as U,ni as V,d1 as W,Vu as X,IR as Y,ure as Z,hre as _,YF as a,cc as a0,ac as a1,G0 as a2,Mn as b,mh as c,ht as d,oi as e,Sa as f,Zl as g,Ni as h,j_ as i,ef as j,Eo as k,dre as l,ja as m,UE as n,_F as o,lt as p,yF as q,mF as r,ox as s,Ef as t,Ot as u,Wf as v,Tp as w,IE as x,Vt as y,fre as z};
//# sourceMappingURL=index-TOUqTsv0.js.map
