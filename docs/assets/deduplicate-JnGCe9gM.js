import{eA as O}from"./index-CNFGw7t3.js";import{f as R,t as L}from"./Indices-D7UertPK.js";function F(f,n,y){const e=Array.isArray(f),r=e?f.length/n:f.byteLength/(4*n),h=e?f:new Uint32Array(f,0,r*n),s=y?.minReduction??0,c=y?.originalIndices||null,q=c?c.length:0,i=y?.componentOffsets||null;let U=0;if(i)for(let t=0;t<i.length-1;t++){const u=i[t+1]-i[t];u>U&&(U=u)}else U=r;const m=Math.floor(1.1*U)+1;(a==null||a.length<2*m)&&(a=new Uint32Array(O(2*m)));for(let t=0;t<2*m;t++)a[t]=0;let o=0;const w=!!i&&!!c,b=w?q:r;let A=R(r);const p=new Uint32Array(q),k=1.96;let I=s!==0?Math.ceil(4*k*k/(s*s)*s*(1-s)):b,d=1,$=i?i[1]:b;for(let t=0;t<b;t++){if(t===I){const l=1-o/t;if(l+k*Math.sqrt(l*(1-l)/t)<s)return null;I*=2}if(t===$){for(let l=0;l<2*m;l++)a[l]=0;if(c)for(let l=i[d-1];l<i[d];l++)p[l]=A[c[l]];$=i[++d]}const u=w?c[t]:t,j=u*n,x=B(h,j,n);let g=x%m,C=o;for(;a[2*g+1]!==0;){if(a[2*g]===x){const l=a[2*g+1]-1;if(v(h,j,l*n,n)){C=A[l];break}}g++,g>=m&&(g-=m)}C===o&&(a[2*g]=x,a[2*g+1]=u+1,o++),A[u]=C}if(s!==0&&1-o/r<s)return null;if(w){for(let t=i[d-1];t<p.length;t++)p[t]=A[c[t]];A=L(p)}const M=e?new Array(o):new Uint32Array(o*n);o=0;for(let t=0;t<b;t++)A[t]===o&&(z(h,(w?c[t]:t)*n,M,o*n,n),o++);if(c&&!w){const t=new Uint32Array(q);for(let u=0;u<t.length;u++)t[u]=A[c[u]];A=L(t)}return{buffer:Array.isArray(M)?M:M.buffer,indices:A,uniqueCount:o}}function v(f,n,y,e){for(let r=0;r<e;r++)if(f[n+r]!==f[y+r])return!1;return!0}function z(f,n,y,e,r){for(let h=0;h<r;h++)y[e+h]=f[n+h]}function B(f,n,y){let e=0;for(let r=0;r<y;r++)e=f[n+r]+e|0,e=e+(e<<11)+(e>>>2)|0;return e>>>0}let a=null;export{F as e};
//# sourceMappingURL=deduplicate-JnGCe9gM.js.map
