{"version":3,"file":"WorkerHandle-YTGzOikD.js","sources":["../../node_modules/@arcgis/core/core/workers/WorkerHandle.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{remove as e}from\"../arrayUtils.js\";import{makeHandle as t}from\"../handleUtils.js\";import s from\"../Logger.js\";import{throwIfAborted as r}from\"../promiseUtils.js\";import{open as i}from\"./workers.js\";class o{constructor(e,t,r,o,h={}){this._mainMethod=t,this._transferLists=r,this._listeners=[],this._promise=i(e,{...h,schedule:o}).then(e=>{if(void 0===this._thread){this._thread=e,this._promise=null,h.hasInitialize&&this.broadcast({},\"initialize\");for(const e of this._listeners)this._connectListener(e)}else e.close()}),this._promise.catch(t=>s.getLogger(\"esri.core.workers.WorkerHandle\").error(`Failed to initialize ${e} worker: ${t}`))}on(s,r){const i={removed:!1,eventName:s,callback:r,threadHandle:null};return this._listeners.push(i),this._connectListener(i),t(()=>{i.removed=!0,e(this._listeners,i),this._thread&&null!=i.threadHandle&&i.threadHandle.remove()})}destroy(){this._thread&&(this._thread.close(),this._thread=null),this._promise=null,this._listeners.length=0,this._transferLists={}}invoke(e,t,s){return this.invokeMethod(this._mainMethod,e,t,s)}invokeMethod(e,t,s,i){if(this._thread){const r=this._transferLists[e],o=r?r(t):[];return this._thread.invoke(e,t,{transferList:o,signal:s,priority:i})}return this._promise?this._promise.then(()=>(r(s),this.invokeMethod(e,t,s))):Promise.reject(null)}broadcast(e,t){return this._thread?Promise.all(this._thread.broadcast(t,e)).then(h):this._promise?this._promise.then(()=>this.broadcast(e,t)):Promise.reject()}get promise(){return this._promise}_connectListener(e){this._thread&&this._thread.on(e.eventName,e.callback).then(t=>{e.removed||(e.threadHandle=t)})}}function h(){}export{o as WorkerHandle};\n"],"names":["o","r","h","i","e","t","s"],"mappings":"uEAI6M,MAAMA,CAAC,CAAC,YAAY,EAAE,EAAEC,EAAED,EAAEE,EAAE,CAAA,EAAG,CAAC,KAAK,YAAY,EAAE,KAAK,eAAeD,EAAE,KAAK,WAAW,CAAA,EAAG,KAAK,SAASE,EAAE,EAAE,CAAC,GAAGD,EAAE,SAASF,CAAC,CAAC,EAAE,KAAKI,GAAG,CAAC,GAAY,KAAK,UAAd,OAAsB,CAAC,KAAK,QAAQA,EAAE,KAAK,SAAS,KAAKF,EAAE,eAAe,KAAK,UAAU,CAAA,EAAG,YAAY,EAAE,UAAUE,KAAK,KAAK,WAAW,KAAK,iBAAiBA,CAAC,CAAC,MAAMA,EAAE,MAAK,CAAE,CAAC,EAAE,KAAK,SAAS,MAAMC,GAAGC,EAAE,UAAU,gCAAgC,EAAE,MAAM,wBAAwB,CAAC,YAAYD,CAAC,EAAE,CAAC,CAAC,CAAC,GAAGC,EAAEL,EAAE,CAAC,MAAME,EAAE,CAAC,QAAQ,GAAG,UAAUG,EAAE,SAASL,EAAE,aAAa,IAAI,EAAE,OAAO,KAAK,WAAW,KAAKE,CAAC,EAAE,KAAK,iBAAiBA,CAAC,EAAEE,EAAE,IAAI,CAACF,EAAE,QAAQ,GAAGC,EAAE,KAAK,WAAWD,CAAC,EAAE,KAAK,SAAeA,EAAE,cAAR,MAAsBA,EAAE,aAAa,OAAM,CAAE,CAAC,CAAC,CAAC,SAAS,CAAC,KAAK,UAAU,KAAK,QAAQ,MAAK,EAAG,KAAK,QAAQ,MAAM,KAAK,SAAS,KAAK,KAAK,WAAW,OAAO,EAAE,KAAK,eAAe,CAAA,CAAE,CAAC,OAAO,EAAE,EAAE,EAAE,CAAC,OAAO,KAAK,aAAa,KAAK,YAAY,EAAE,EAAE,CAAC,CAAC,CAAC,aAAa,EAAE,EAAE,EAAEA,EAAE,CAAC,GAAG,KAAK,QAAQ,CAAC,MAAM,EAAE,KAAK,eAAe,CAAC,EAAEH,EAAE,EAAE,EAAE,CAAC,EAAE,CAAA,EAAG,OAAO,KAAK,QAAQ,OAAO,EAAE,EAAE,CAAC,aAAaA,EAAE,OAAO,EAAE,SAASG,CAAC,CAAC,CAAC,CAAC,OAAO,KAAK,SAAS,KAAK,SAAS,KAAK,KAAKF,EAAE,CAAC,EAAE,KAAK,aAAa,EAAE,EAAE,CAAC,EAAE,EAAE,QAAQ,OAAO,IAAI,CAAC,CAAC,UAAU,EAAE,EAAE,CAAC,OAAO,KAAK,QAAQ,QAAQ,IAAI,KAAK,QAAQ,UAAU,EAAE,CAAC,CAAC,EAAE,KAAKC,CAAC,EAAE,KAAK,SAAS,KAAK,SAAS,KAAK,IAAI,KAAK,UAAU,EAAE,CAAC,CAAC,EAAE,QAAQ,OAAM,CAAE,CAAC,IAAI,SAAS,CAAC,OAAO,KAAK,QAAQ,CAAC,iBAAiB,EAAE,CAAC,KAAK,SAAS,KAAK,QAAQ,GAAG,EAAE,UAAU,EAAE,QAAQ,EAAE,KAAK,GAAG,CAAC,EAAE,UAAU,EAAE,aAAa,EAAE,CAAC,CAAC,CAAC,CAAC,SAASA,GAAG,CAAC","x_google_ignoreList":[0]}