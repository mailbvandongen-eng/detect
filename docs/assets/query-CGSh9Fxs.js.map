{"version":3,"file":"query-CGSh9Fxs.js","sources":["../../node_modules/@arcgis/core/rest/operations/urlUtils.js","../../node_modules/@arcgis/core/rest/query/operations/queryUtils.js","../../node_modules/@arcgis/core/rest/query/operations/query.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nfunction t(n){const o={};for(const e in n){if(\"declaredClass\"===e)continue;const r=n[e];if(null!=r&&\"function\"!=typeof r)if(Array.isArray(r)){o[e]=[];for(let n=0;n<r.length;n++)o[e][n]=t(r[n])}else\"object\"==typeof r?r.toJSON&&(o[e]=JSON.stringify(r)):o[e]=r}return o}export{t as mapParameters};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{getJsonType as e}from\"../../../geometry/support/jsonUtils.js\";import{srToRESTValue as t}from\"../../../geometry/support/spatialReferenceUtils.js\";function i(e,t){if(t&&\"extent\"===e.type)return`${e.xmin},${e.ymin},${e.xmax},${e.ymax}`;if(t&&\"point\"===e.type)return`${e.x},${e.y}`;const i=e.toJSON();return delete i.spatialReference,JSON.stringify(i)}function r(r,n,a){const{geometry:l}=r,s=r.compactGeometryEnabled??!1,o=r.toJSON();delete o.compactGeometryEnabled,delete o.defaultSpatialReferenceEnabled;const u=o;let d,c,y;if(l&&(c=l.spatialReference,y=t(c),u.geometryType=e(l),u.geometry=i(l,s),u.inSR=y),o.groupByFieldsForStatistics&&(u.groupByFieldsForStatistics=o.groupByFieldsForStatistics.join(\",\")),o.objectIds)switch(a?.uniqueIdFields?.length){case void 0:u.objectIds=o.objectIds.join(\",\");break;case 1:u.uniqueIds=JSON.stringify(o.objectIds),delete u.objectIds;break;default:u.uniqueIds=JSON.stringify(o.objectIds.map(e=>JSON.parse(e))),delete u.objectIds}if(o.orderByFields&&(u.orderByFields=o.orderByFields.join(\",\")),!o.outFields||!o.returnDistinctValues&&(n?.returnCountOnly||n?.returnExtentOnly||n?.returnIdsOnly)?delete u.outFields:o.outFields.includes(\"*\")?u.outFields=\"*\":u.outFields=o.outFields.join(\",\"),o.outSR?(u.outSR=t(o.outSR),d=r.outSpatialReference):l&&(o.returnGeometry||o.returnCentroid)&&(u.outSR=u.inSR,d=c),o.returnGeometry&&delete o.returnGeometry,o.outStatistics&&(u.outStatistics=JSON.stringify(o.outStatistics)),o.fullText&&(u.fullText=JSON.stringify(o.fullText)),o.pixelSize&&(u.pixelSize=JSON.stringify(o.pixelSize)),o.quantizationParameters&&(r.defaultSpatialReferenceEnabled&&null!=c&&null!=r.quantizationParameters?.extent&&c.equals(r.quantizationParameters.extent.spatialReference)&&delete o.quantizationParameters.extent.spatialReference,u.quantizationParameters=JSON.stringify(o.quantizationParameters)),o.parameterValues&&(u.parameterValues=JSON.stringify(o.parameterValues)),o.rangeValues&&(u.rangeValues=JSON.stringify(o.rangeValues)),o.dynamicDataSource&&(u.layer=JSON.stringify({source:o.dynamicDataSource}),delete o.dynamicDataSource),o.timeExtent){const e=o.timeExtent,{start:t,end:i}=e;null==t&&null==i||(u.time=t===i?t:`${t??\"null\"},${i??\"null\"}`),delete o.timeExtent}return r.defaultSpatialReferenceEnabled&&null!=c&&null!=d&&c.equals(d)&&(u.defaultSR=u.inSR,delete u.inSR,delete u.outSR),u}export{i as encodeGeometry,r as queryLikeToQueryStringParameters};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport t from\"../../../request.js\";import{urlToObject as r,join as n}from\"../../../core/urlUtils.js\";import{normalizeCentralMeridian as e}from\"../../../geometry/support/normalizeUtils.js\";import{mapParameters as o}from\"../../operations/urlUtils.js\";import{parsePBFFeatureQuery as u}from\"./pbfQueryUtils.js\";import{queryLikeToQueryStringParameters as s}from\"./queryUtils.js\";import{applyFeatureSetZUnitScaling as i}from\"./queryZScale.js\";const a=\"Layer does not support extent calculation.\";function l(t,r,n){return s(t,r,n)}async function y(t,r,n,e,o){const u=r.timeExtent?.isEmpty?{data:{features:[]}}:await j(t,r,\"json\",e,void 0,o);return i(r,n,u.data),u}async function f(t,r,n,e,o){if(r.timeExtent?.isEmpty)return{data:n.createFeatureResult()};const s=await c(t,r,e,o),i=s;return i.data=u(s.data,n),i}function c(t,r,n,e){return j(t,r,\"pbf\",n,void 0,e)}function m(t,r,n,e){return r.timeExtent?.isEmpty?Promise.resolve({data:{objectIds:[]}}):j(t,r,\"json\",n,{returnIdsOnly:!0},e)}function p(t,r,n,e){return r.timeExtent?.isEmpty?Promise.resolve({data:{count:0}}):j(t,r,\"json\",n,{returnIdsOnly:!0,returnCountOnly:!0},e)}async function d(t,r,n){if(r.timeExtent?.isEmpty)return{data:{count:0,extent:null}};const e=await j(t,r,\"json\",n,{returnExtentOnly:!0,returnCountOnly:!0}),o=e.data;if(o.hasOwnProperty(\"extent\"))return e;if(o.features)throw new Error(a);if(o.hasOwnProperty(\"count\"))throw new Error(a);return e}function O(t,r){if(!t.returnIdsOnly||!r.uniqueIdFields)return t;const n={...t,returnUniqueIdsOnly:!0};return delete n.returnIdsOnly,n}async function j(u,s,i,a={},y={},f={}){const c=\"string\"==typeof u?r(u):u,m=s.geometry?[s.geometry]:[],p=await e(m,null,{signal:a.signal}),d=p?.[0];null!=d&&((s=s.clone()).geometry=d);const j=o({...c.query,f:i,...O(y,f),...l(s,y,f)});return t(n(c.path,E(s,y)?\"query3d\":\"query\"),{...a,responseType:\"pbf\"===i?\"array-buffer\":\"json\",query:{...j,...a.query}})}function E(t,r){return null!=t.formatOf3DObjects&&!(r.returnCountOnly||r.returnExtentOnly||r.returnIdsOnly)}export{y as executeQuery,p as executeQueryForCount,d as executeQueryForExtent,m as executeQueryForIds,f as executeQueryPBF,c as executeQueryPBFBuffer,l as queryToQueryStringParameters,j as runQuery};\n"],"names":["t","n","o","e","r","i","l","s","u","d","c","y","a","j","f","m","p","O","E"],"mappings":"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","x_google_ignoreList":[0,1,2]}