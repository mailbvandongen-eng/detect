{"version":3,"file":"FeatureIdInfo-BWH9104_.js","sources":["../../node_modules/@arcgis/core/views/2d/layers/features/sources/FeatureSourceQueryInfo.js","../../node_modules/@arcgis/core/layers/graphics/data/FeatureIdInfo.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport has from\"../../../../../core/has.js\";import{sqlAnd as e}from\"../../../../../core/sql.js\";import t from\"../../../../../geometry/SpatialReference.js\";import{getClauseForScaleRange as r}from\"../../../../../layers/support/displayFilterUtils.js\";import a from\"../../../../../rest/support/Query.js\";import i from\"../../../../../time/TimeExtent.js\";const s=4;function o(e){switch(e.type){case\"object-id\":case\"unique-id-simple\":return`${e.fieldName} ASC`;case\"unique-id-composite\":return`${e.fieldNames.join(\",\")} ASC`}}function n(e,r,a){const s=o(a.featureIdInfo);return{returnCentroid:\"esriGeometryPolygon\"===a.serviceGeometryType&&!e.queryMetadata.supportsCentroidOnDegeneratedQuantizedGeometry&&!e.queryMetadata.supportsDegeneratedQuantizedGeometry,returnGeometry:!0,timeReferenceUnknownClient:a.timeReferenceUnknownClient??void 0,outSpatialReference:t.fromJSON(e.outSpatialReference),orderByFields:\"memory\"===e.type?[]:[s],where:r.definitionExpression??\"1=1\",outFields:r.availableFields,multipatchOption:\"esriGeometryMultiPatch\"===a.serviceGeometryType?\"xyFootprint\":null,gdbVersion:r.gdbVersion,historicMoment:r.historicMoment?new Date(r.historicMoment):null,timeExtent:r.timeExtent?i.fromJSON(r.timeExtent):null}}class u{static create(e,t,r){const a=t.queryScaleRanges,i=t.displayFilterInfo;return new u(n(e,t,r),i,a,r.subtypeField,t.customParameters,r.geometryType,e.queryMetadata)}constructor(e,t,r,a,i,s,o){this._queryParams=e,this._displayFilter=t,this._queryScaleRanges=r,this._subtypeField=a,this._customParameters=i,this._geometryType=s,this._queryMetadata=o}get pageSize(){if(null==this._queryMetadata)throw new Error(\"InternalError: Service does not support paged queries\");const e=this._queryMetadata.supportsMaxRecordCountFactor?s:null,t=(this._queryMetadata.maxRecordCount??8e3)*(e??1);return Math.min(8e3,t)}get objectIdsQueryPageSize(){return this._queryMetadata?.maxRecordCount??2e3}updateHistoricMoment(e){this._queryParams.historicMoment=e}updateFields(e){this._queryParams.outFields=e}createPatchFieldsQuery(e,t,r){if(!t.getSize())return null;const a=e.clone();if(\"*\"===this._queryParams.outFields[0]){if(\"*\"===(a.outFields??[])[0])return null;a.outFields=this._queryParams.outFields}else{const e=new Set(this._queryParams.outFields),r=[];for(const a of e)t.hasField(a)||r.push(a);if(0===r.length)return null;a.outFields=r}a.returnGeometry=!1,a.returnCentroid=!1,a.quantizationParameters=null,a.cacheHint=!0;const i={inner:a,customParameters:this._customParameters};if(has(\"esri-tiles-debug\")&&null!=r){const e=r.chunkId.toString().replaceAll(\"/\",\".\");i.customParameters=i.customParameters?{...i.customParameters,chunkId:e}:{chunkId:e}}return i}createQuery(e={}){if(!this._queryParams)throw new Error(\"InternalError: queryInfo should be defined\");return{inner:new a({...this._queryParams,...e}),customParameters:this._customParameters}}createTileQuery(t,a){if(null==this._queryMetadata)throw new Error(\"InternalError: Service does not support tile queries\");const i=this.createQuery(a),o=i.inner;if(this._queryScaleRanges?.length){const r=this._queryScaleRanges.filter(e=>(!e.minScale||e.minScale>=t.maxScale)&&(!e.maxScale||e.maxScale<=t.minScale)).map(e=>e.subtypeCode);if(r.length){const t=`${this._subtypeField} IN (${r})`;o.where=e(o.where,t)}}if(this._displayFilter&&(o.where=e(o.where,r(this._displayFilter,t.minScale,t.maxScale))),o.quantizationParameters=a.quantizationParameters??t.getQuantizationParameters(),o.resultType=\"tile\",o.geometry=t.extent,this._queryMetadata.supportsQuantization?\"esriGeometryPolyline\"===this._geometryType&&(o.maxAllowableOffset=t.resolution*has(\"feature-polyline-generalization-factor\")):\"esriGeometryPolyline\"!==this._geometryType&&\"esriGeometryPolygon\"!==this._geometryType||(o.maxAllowableOffset=t.resolution,\"esriGeometryPolyline\"===this._geometryType&&(o.maxAllowableOffset*=has(\"feature-polyline-generalization-factor\"))),o.defaultSpatialReferenceEnabled=this._queryMetadata.supportsDefaultSpatialReference,o.compactGeometryEnabled=this._queryMetadata.supportsCompactGeometry,this._queryMetadata.supportsMaxRecordCountFactor&&(o.maxRecordCountFactor=s),has(\"esri-tiles-debug\")){const e=t.id.replaceAll(\"/\",\".\");i.customParameters=i.customParameters?{...i.customParameters,tileId:e}:{tileId:e}}return i}createPagedTileQuery(e,t){const r=this.pageSize;return this.createTileQuery(e,{start:r*t,num:r,returnExceededLimitFeatures:!0})}createPagedQuery(e,t){const r=this.pageSize;return this.createQuery({start:r*e,num:r,returnExceededLimitFeatures:!0,maxRecordCountFactor:s,quantizationParameters:t,cacheHint:!0})}createObjectIdsQuery(e){return this.createQuery({objectIds:e,outFields:[\"*\"]})}}export{u as FeatureSourceQueryInfo};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nfunction*e(e){switch(e.type){case\"object-id\":case\"unique-id-simple\":return void(yield e.fieldName);case\"unique-id-composite\":return void(yield*e.fieldNames)}}export{e as getFeatureIdInfoFieldNames};\n"],"names":["s","o","e","n","r","a","t","i","u","has"],"mappings":"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","x_google_ignoreList":[0,1]}