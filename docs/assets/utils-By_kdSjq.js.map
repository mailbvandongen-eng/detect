{"version":3,"file":"utils-By_kdSjq.js","sources":["../../node_modules/@arcgis/core/smartMapping/support/utils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{convertDateTimeFieldFormatToIntlOptions as t,formatDate as e,convertDateFormatToIntlOptions as n,formatTimestamp as o,formatTimeOnly as r,formatDateOnly as i}from\"../../intl/date.js\";import{isDateField as s,isDateOnlyField as a,isTimestampOffsetField as l}from\"../../layers/support/fieldUtils.js\";import{getWellKnownBasemapId as u}from\"../../support/basemapUtils.js\";import{loadArcade as d}from\"../../support/loadArcade.js\";import{utc as m}from\"../../time/constants.js\";import{getTimeZoneFormattingOptions as f}from\"../../time/timeZoneUtils.js\";const c=\",\",p={light:[\"streets\",\"gray\",\"topo\",\"terrain\",\"oceans\",\"osm\",\"gray-vector\",\"streets-vector\",\"topo-vector\",\"streets-relief-vector\",\"streets-navigation-vector\",\"topo-3d\",\"navigation-3d\",\"streets-3d\",\"osm-3d\",\"gray-3d\"],dark:[\"satellite\",\"hybrid\",\"dark-gray\",\"dark-gray-vector\",\"streets-night-vector\",\"navigation-dark-3d\",\"streets-dark-3d\",\"dark-gray-3d\"]},g=\"percent-of-total\",y=\"field\",h={exclude:[\"median\"]},v={years:365,months:30,days:1,hours:1/24,minutes:1/1440,seconds:1/86400,milliseconds:1/864e5},T=new Set([\"integer\",\"small-integer\"]);let Z=null;const $=[\"date\",\"date-only\",\"timestamp-offset\"];function U(t){return s(t)||a(t)||l(t)}async function w(t){const{field:e,field2:n,field3:o,normalizationField:r,valueExpression:i,fields:s}=t;let a=[];if(i){if(!Z){const{arcadeUtils:t}=await d();Z=t}a=Z.extractFieldNames(i)}return e&&a.push(e),n&&a.push(n),o&&a.push(o),r&&a.push(r),s&&a.push(...s),a}function F(t){let e=t.normalizationType;return e||(t.normalizationField?e=y:null!=t.normalizationTotal&&(e=g)),e??void 0}function S(t){return String(t).padStart(2,\"0\")}function k(t,e,n){let o;if(\"date\"===e||\"number\"===e){\"number\"===e&&(t=new Date(t));o=`TIMESTAMP'${n?t.getFullYear():t.getUTCFullYear()}-${S((n?t.getMonth():t.getUTCMonth())+1)}-${S(n?t.getDate():t.getUTCDate())} ${S(n?t.getHours():t.getUTCHours())}:${S(n?t.getMinutes():t.getUTCMinutes())}:${S(n?t.getSeconds():t.getUTCSeconds())}'`}else o=t;return o}function C(t,e,n,o){const{hasQueryEngine:r}=t,i=`(${k(n,D(t,n),r)} - ${k(e,D(t,e),r)})`;let s=v[o],a=\"/\";s<1&&(s=1/s,a=\"*\");return{sqlExpression:1===s?i:`(${i} ${a} ${s})`,sqlWhere:null}}function D(t,e){if(e instanceof Date)return\"date\";if(\"number\"==typeof e)return\"number\";if(\"string\"==typeof e){const n=t.getField(e);if(\"<now>\"===e.toLowerCase())return;if(s(n))return\"field\"}}function b(t,e=p){for(const n in e)if(e[n].includes(t))return n}function j(t,e,n=!0){let o=null;return t&&(\"string\"==typeof t?e.includes(t)&&(o=t):o=u(t)),n?o||\"gray\":o}function M(t,e){const n=e&&t.getField(e);return!!n&&T.has(n.type)}function N(t){return`cast(${t} as float)`}function x(s,a){const{format:l,fieldFormat:u,timeZoneOptions:d,fieldType:c}=a??{},p=u?t(u):null;let g,y;if(d&&({timeZone:g,timeZoneName:y}=f(d.layerTimeZone,d.datesInUnknownTimezone,d.viewTimeZone,p||n(l||\"short-date-short-time\"),c)),\"string\"==typeof s&&isNaN(Date.parse(\"time-only\"===c?`1970-01-01T${s}Z`:s)))return s;switch(c){case\"date-only\":{const t=p||n(l||\"short-date\");return\"string\"==typeof s?i(s,{...t}):e(s,{...t,timeZone:m})}case\"time-only\":{const t=p||n(l||\"short-time\");return\"string\"==typeof s?r(s,t):e(s,{...t,timeZone:m})}case\"timestamp-offset\":{if(!g&&\"string\"==typeof s&&new Date(s).toISOString()!==s)return s;const t=l||p||d?p||n(l||\"short-date-short-time\"):void 0,r=t?{...t,timeZone:g,timeZoneName:y}:void 0;return\"string\"==typeof s?o(s,r):e(s,r)}default:{const t=l||p||d?p||n(l||\"short-date-short-time\"):void 0;return e(\"string\"==typeof s?new Date(s):s,t?{...t,timeZone:g,timeZoneName:y}:void 0)}}}export{N as castIntegerFieldToFloat,$ as dateTypes,p as defaultBasemapGroups,h as defaultStatisticTypes,c as fieldDelimiter,x as formatAnyDate,b as getBasemapGroup,j as getBasemapId,C as getDateDiffSQL,D as getDateType,w as getFieldsList,F as getNormalizationType,U as isAnyDateField,M as isIntegerField,v as unitValueInDays};\n"],"names":["c","v","T","Z","U","t","s","a","l","w","e","n","o","i","d","S","k","C","D","M","N","x","u","p","g","y","f","m","r"],"mappings":"iIAI6iB,MAACA,EAAE,IAA0ZC,EAAE,CAAC,MAAM,IAAI,OAAO,GAAG,KAAK,EAAE,MAAM,EAAE,GAAG,QAAQ,EAAE,KAAK,QAAQ,EAAE,MAAM,aAAa,EAAE,KAAK,EAAEC,EAAE,IAAI,IAAI,CAAC,UAAU,eAAe,CAAC,EAAE,IAAIC,EAAE,KAAqD,SAASC,EAAEC,EAAE,CAAC,OAAOC,EAAED,CAAC,GAAGE,EAAEF,CAAC,GAAGG,EAAEH,CAAC,CAAC,CAAC,eAAeI,EAAEJ,EAAE,CAAC,KAAK,CAAC,MAAMK,EAAE,OAAOC,EAAE,OAAOC,EAAE,mBAAmB,EAAE,gBAAgBC,EAAE,OAAOP,CAAC,EAAED,EAAE,IAAIE,EAAE,CAAA,EAAG,GAAGM,EAAE,CAAC,GAAG,CAACV,EAAE,CAAC,KAAK,CAAC,YAAYE,CAAC,EAAE,MAAMS,EAAC,EAAGX,EAAEE,CAAC,CAACE,EAAEJ,EAAE,kBAAkBU,CAAC,CAAC,CAAC,OAAOH,GAAGH,EAAE,KAAKG,CAAC,EAAEC,GAAGJ,EAAE,KAAKI,CAAC,EAAEC,GAAGL,EAAE,KAAKK,CAAC,EAAE,GAAGL,EAAE,KAAK,CAAC,EAAED,GAAGC,EAAE,KAAK,GAAGD,CAAC,EAAEC,CAAC,CAA0H,SAASQ,EAAEV,EAAE,CAAC,OAAO,OAAOA,CAAC,EAAE,SAAS,EAAE,GAAG,CAAC,CAAC,SAASW,EAAEX,EAAEK,EAAEC,EAAE,CAAC,IAAIC,EAAE,OAAYF,IAAT,QAAuBA,IAAX,UAAyBA,IAAX,WAAeL,EAAE,IAAI,KAAKA,CAAC,GAAGO,EAAE,aAAaD,EAAEN,EAAE,YAAW,EAAGA,EAAE,eAAc,CAAE,IAAIU,GAAGJ,EAAEN,EAAE,SAAQ,EAAGA,EAAE,YAAW,GAAI,CAAC,CAAC,IAAIU,EAAEJ,EAAEN,EAAE,QAAO,EAAGA,EAAE,WAAU,CAAE,CAAC,IAAIU,EAAEJ,EAAEN,EAAE,SAAQ,EAAGA,EAAE,YAAW,CAAE,CAAC,IAAIU,EAAEJ,EAAEN,EAAE,WAAU,EAAGA,EAAE,cAAa,CAAE,CAAC,IAAIU,EAAEJ,EAAEN,EAAE,aAAaA,EAAE,cAAa,CAAE,CAAC,KAASO,EAAEP,EAASO,CAAC,CAAC,SAASK,EAAEZ,EAAEK,EAAEC,EAAEC,EAAE,CAAC,KAAK,CAAC,eAAe,CAAC,EAAEP,EAAEQ,EAAE,IAAIG,EAAEL,EAAEO,EAAEb,EAAEM,CAAC,EAAE,CAAC,CAAC,MAAMK,EAAEN,EAAEQ,EAAEb,EAAEK,CAAC,EAAE,CAAC,CAAC,IAAI,IAAIJ,EAAEL,EAAEW,CAAC,EAAEL,EAAE,IAAI,OAAAD,EAAE,IAAIA,EAAE,EAAEA,EAAEC,EAAE,KAAW,CAAC,cAAkBD,IAAJ,EAAMO,EAAE,IAAIA,CAAC,IAAIN,CAAC,IAAID,CAAC,IAAI,SAAS,IAAI,CAAC,CAAC,SAASY,EAAEb,EAAEK,EAAE,CAAC,GAAGA,aAAa,KAAK,MAAM,OAAO,GAAa,OAAOA,GAAjB,SAAmB,MAAM,SAAS,GAAa,OAAOA,GAAjB,SAAmB,CAAC,MAAMC,EAAEN,EAAE,SAASK,CAAC,EAAE,GAAaA,EAAE,YAAW,IAAvB,QAA0B,OAAO,GAAGJ,EAAEK,CAAC,EAAE,MAAM,OAAO,CAAC,CAA0K,SAASQ,EAAEd,EAAEK,EAAE,CAAC,MAAMC,EAAED,GAAGL,EAAE,SAASK,CAAC,EAAE,MAAM,CAAC,CAACC,GAAGT,EAAE,IAAIS,EAAE,IAAI,CAAC,CAAC,SAASS,EAAEf,EAAE,CAAC,MAAM,QAAQA,CAAC,YAAY,CAAC,SAASgB,EAAEf,EAAEC,EAAE,CAAC,KAAK,CAAC,OAAOC,EAAE,YAAYc,EAAE,gBAAgBR,EAAE,UAAUd,CAAC,EAAEO,GAAG,CAAA,EAAGgB,EAAED,EAAEjB,EAAEiB,CAAC,EAAE,KAAK,IAAIE,EAAEC,EAAE,GAAGX,IAAI,CAAC,SAASU,EAAE,aAAaC,CAAC,EAAEC,EAAEZ,EAAE,cAAcA,EAAE,uBAAuBA,EAAE,aAAaS,GAAGZ,EAAEH,GAAG,uBAAuB,EAAER,CAAC,GAAa,OAAOM,GAAjB,UAAoB,MAAM,KAAK,MAAoBN,IAAd,YAAgB,cAAcM,CAAC,IAAIA,CAAC,CAAC,EAAE,OAAOA,EAAE,OAAON,EAAC,CAAE,IAAI,YAAY,CAAC,MAAMK,EAAEkB,GAAGZ,EAAEH,GAAG,YAAY,EAAE,OAAgB,OAAOF,GAAjB,SAAmBO,EAAEP,EAAE,CAAC,GAAGD,CAAC,CAAC,EAAEK,EAAEJ,EAAE,CAAC,GAAGD,EAAE,SAASsB,CAAC,CAAC,CAAC,CAAC,IAAI,YAAY,CAAC,MAAMtB,EAAEkB,GAAGZ,EAAEH,GAAG,YAAY,EAAE,OAAgB,OAAOF,GAAjB,SAAmBsB,EAAEtB,EAAED,CAAC,EAAEK,EAAEJ,EAAE,CAAC,GAAGD,EAAE,SAASsB,CAAC,CAAC,CAAC,CAAC,IAAI,mBAAmB,CAAC,GAAG,CAACH,GAAa,OAAOlB,GAAjB,UAAoB,IAAI,KAAKA,CAAC,EAAE,YAAW,IAAKA,EAAE,OAAOA,EAAE,MAAMD,EAAEG,GAAGe,GAAGT,EAAES,GAAGZ,EAAEH,GAAG,uBAAuB,EAAE,OAAOoB,EAAEvB,EAAE,CAAC,GAAGA,EAAE,SAASmB,EAAE,aAAaC,CAAC,EAAE,OAAO,OAAgB,OAAOnB,GAAjB,SAAmBM,EAAEN,EAAEsB,CAAC,EAAElB,EAAEJ,EAAEsB,CAAC,CAAC,CAAC,QAAQ,CAAC,MAAMvB,EAAEG,GAAGe,GAAGT,EAAES,GAAGZ,EAAEH,GAAG,uBAAuB,EAAE,OAAO,OAAOE,EAAY,OAAOJ,GAAjB,SAAmB,IAAI,KAAKA,CAAC,EAAEA,EAAED,EAAE,CAAC,GAAGA,EAAE,SAASmB,EAAE,aAAaC,CAAC,EAAE,MAAM,CAAC,CAAC,CAAC","x_google_ignoreList":[0]}