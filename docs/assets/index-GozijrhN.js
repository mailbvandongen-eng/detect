const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/amkOL-BMpsLH3A.js","assets/layerLoaderOL-BWmWyZBc.js","assets/GeoJSON-DSYI3kew.js","assets/romeinsOL-CTmsrHLa.js","assets/kastelenOL-CQB3Fr53.js","assets/iconStyles-KBlwNKb5.js","assets/veengebiedenOL-CVQFE82Q.js","assets/hunebeddenOL-D6bv9-v6.js","assets/uikavArcheoPuntenOL-CmCV2opM.js","assets/proj4-CAc_Cwga.js","assets/uikavVlakkenOL-BSyfkZlc.js","assets/uikavBufferlaagOL-C-FYcmEu.js","assets/uikavExpertOL-VLL-T6YU.js","assets/uikavUiterwaardenOL-CX7qTYNk.js","assets/speeltuinenOL-BD7mZ7Vh.js","assets/museaOL-BKUP8IB2.js","assets/strandjesOL-C_1ROisp.js","assets/parkenOL-Ba-pOzjm.js","assets/fossielenOL-DWvtWnpZ.js","assets/fossielUtils-CPtDe3F7.js","assets/fossielenBelgieOL-C3f5zo27.js","assets/fossielenDuitslandOL-DCwf-Zht.js","assets/fossielenFrankrijkOL-CZey33tx.js","assets/bunkersOL-Cz_O9pbj.js","assets/grafheuvelsOL-lw90V7xG.js","assets/slagveldenOL-DPkqb4BD.js","assets/vliegveldenOL-DLp3ddSN.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();function Uw(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Wv={exports:{}},Md={},Kv={exports:{}},Je={};var b2;function JO(){if(b2)return Je;b2=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),o=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),g=Symbol.iterator;function m($){return $===null||typeof $!="object"?null:($=g&&$[g]||$["@@iterator"],typeof $=="function"?$:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,T={};function w($,K,Ae){this.props=$,this.context=K,this.refs=T,this.updater=Ae||v}w.prototype.isReactComponent={},w.prototype.setState=function($,K){if(typeof $!="object"&&typeof $!="function"&&$!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,$,K,"setState")},w.prototype.forceUpdate=function($){this.updater.enqueueForceUpdate(this,$,"forceUpdate")};function A(){}A.prototype=w.prototype;function P($,K,Ae){this.props=$,this.context=K,this.refs=T,this.updater=Ae||v}var C=P.prototype=new A;C.constructor=P,y(C,w.prototype),C.isPureReactComponent=!0;var N=Array.isArray,D=Object.prototype.hasOwnProperty,z={current:null},k={key:!0,ref:!0,__self:!0,__source:!0};function R($,K,Ae){var Re,Pe={},Oe=null,Fe=null;if(K!=null)for(Re in K.ref!==void 0&&(Fe=K.ref),K.key!==void 0&&(Oe=""+K.key),K)D.call(K,Re)&&!k.hasOwnProperty(Re)&&(Pe[Re]=K[Re]);var Ke=arguments.length-2;if(Ke===1)Pe.children=Ae;else if(1<Ke){for(var Ye=Array(Ke),yt=0;yt<Ke;yt++)Ye[yt]=arguments[yt+2];Pe.children=Ye}if($&&$.defaultProps)for(Re in Ke=$.defaultProps,Ke)Pe[Re]===void 0&&(Pe[Re]=Ke[Re]);return{$$typeof:n,type:$,key:Oe,ref:Fe,props:Pe,_owner:z.current}}function L($,K){return{$$typeof:n,type:$.type,key:K,ref:$.ref,props:$.props,_owner:$._owner}}function F($){return typeof $=="object"&&$!==null&&$.$$typeof===n}function j($){var K={"=":"=0",":":"=2"};return"$"+$.replace(/[=:]/g,function(Ae){return K[Ae]})}var U=/\/+/g;function O($,K){return typeof $=="object"&&$!==null&&$.key!=null?j(""+$.key):K.toString(36)}function ce($,K,Ae,Re,Pe){var Oe=typeof $;(Oe==="undefined"||Oe==="boolean")&&($=null);var Fe=!1;if($===null)Fe=!0;else switch(Oe){case"string":case"number":Fe=!0;break;case"object":switch($.$$typeof){case n:case e:Fe=!0}}if(Fe)return Fe=$,Pe=Pe(Fe),$=Re===""?"."+O(Fe,0):Re,N(Pe)?(Ae="",$!=null&&(Ae=$.replace(U,"$&/")+"/"),ce(Pe,K,Ae,"",function(yt){return yt})):Pe!=null&&(F(Pe)&&(Pe=L(Pe,Ae+(!Pe.key||Fe&&Fe.key===Pe.key?"":(""+Pe.key).replace(U,"$&/")+"/")+$)),K.push(Pe)),1;if(Fe=0,Re=Re===""?".":Re+":",N($))for(var Ke=0;Ke<$.length;Ke++){Oe=$[Ke];var Ye=Re+O(Oe,Ke);Fe+=ce(Oe,K,Ae,Ye,Pe)}else if(Ye=m($),typeof Ye=="function")for($=Ye.call($),Ke=0;!(Oe=$.next()).done;)Oe=Oe.value,Ye=Re+O(Oe,Ke++),Fe+=ce(Oe,K,Ae,Ye,Pe);else if(Oe==="object")throw K=String($),Error("Objects are not valid as a React child (found: "+(K==="[object Object]"?"object with keys {"+Object.keys($).join(", ")+"}":K)+"). If you meant to render a collection of children, use an array instead.");return Fe}function we($,K,Ae){if($==null)return $;var Re=[],Pe=0;return ce($,Re,"","",function(Oe){return K.call(Ae,Oe,Pe++)}),Re}function ye($){if($._status===-1){var K=$._result;K=K(),K.then(function(Ae){($._status===0||$._status===-1)&&($._status=1,$._result=Ae)},function(Ae){($._status===0||$._status===-1)&&($._status=2,$._result=Ae)}),$._status===-1&&($._status=0,$._result=K)}if($._status===1)return $._result.default;throw $._result}var de={current:null},J={transition:null},ae={ReactCurrentDispatcher:de,ReactCurrentBatchConfig:J,ReactCurrentOwner:z};function ie(){throw Error("act(...) is not supported in production builds of React.")}return Je.Children={map:we,forEach:function($,K,Ae){we($,function(){K.apply(this,arguments)},Ae)},count:function($){var K=0;return we($,function(){K++}),K},toArray:function($){return we($,function(K){return K})||[]},only:function($){if(!F($))throw Error("React.Children.only expected to receive a single React element child.");return $}},Je.Component=w,Je.Fragment=t,Je.Profiler=r,Je.PureComponent=P,Je.StrictMode=i,Je.Suspense=c,Je.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ae,Je.act=ie,Je.cloneElement=function($,K,Ae){if($==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+$+".");var Re=y({},$.props),Pe=$.key,Oe=$.ref,Fe=$._owner;if(K!=null){if(K.ref!==void 0&&(Oe=K.ref,Fe=z.current),K.key!==void 0&&(Pe=""+K.key),$.type&&$.type.defaultProps)var Ke=$.type.defaultProps;for(Ye in K)D.call(K,Ye)&&!k.hasOwnProperty(Ye)&&(Re[Ye]=K[Ye]===void 0&&Ke!==void 0?Ke[Ye]:K[Ye])}var Ye=arguments.length-2;if(Ye===1)Re.children=Ae;else if(1<Ye){Ke=Array(Ye);for(var yt=0;yt<Ye;yt++)Ke[yt]=arguments[yt+2];Re.children=Ke}return{$$typeof:n,type:$.type,key:Pe,ref:Oe,props:Re,_owner:Fe}},Je.createContext=function($){return $={$$typeof:o,_currentValue:$,_currentValue2:$,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},$.Provider={$$typeof:s,_context:$},$.Consumer=$},Je.createElement=R,Je.createFactory=function($){var K=R.bind(null,$);return K.type=$,K},Je.createRef=function(){return{current:null}},Je.forwardRef=function($){return{$$typeof:a,render:$}},Je.isValidElement=F,Je.lazy=function($){return{$$typeof:d,_payload:{_status:-1,_result:$},_init:ye}},Je.memo=function($,K){return{$$typeof:h,type:$,compare:K===void 0?null:K}},Je.startTransition=function($){var K=J.transition;J.transition={};try{$()}finally{J.transition=K}},Je.unstable_act=ie,Je.useCallback=function($,K){return de.current.useCallback($,K)},Je.useContext=function($){return de.current.useContext($)},Je.useDebugValue=function(){},Je.useDeferredValue=function($){return de.current.useDeferredValue($)},Je.useEffect=function($,K){return de.current.useEffect($,K)},Je.useId=function(){return de.current.useId()},Je.useImperativeHandle=function($,K,Ae){return de.current.useImperativeHandle($,K,Ae)},Je.useInsertionEffect=function($,K){return de.current.useInsertionEffect($,K)},Je.useLayoutEffect=function($,K){return de.current.useLayoutEffect($,K)},Je.useMemo=function($,K){return de.current.useMemo($,K)},Je.useReducer=function($,K,Ae){return de.current.useReducer($,K,Ae)},Je.useRef=function($){return de.current.useRef($)},Je.useState=function($){return de.current.useState($)},Je.useSyncExternalStore=function($,K,Ae){return de.current.useSyncExternalStore($,K,Ae)},Je.useTransition=function(){return de.current.useTransition()},Je.version="18.3.1",Je}var k2;function _g(){return k2||(k2=1,Kv.exports=JO()),Kv.exports}var L2;function e5(){if(L2)return Md;L2=1;var n=_g(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,r=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function o(a,c,h){var d,g={},m=null,v=null;h!==void 0&&(m=""+h),c.key!==void 0&&(m=""+c.key),c.ref!==void 0&&(v=c.ref);for(d in c)i.call(c,d)&&!s.hasOwnProperty(d)&&(g[d]=c[d]);if(a&&a.defaultProps)for(d in c=a.defaultProps,c)g[d]===void 0&&(g[d]=c[d]);return{$$typeof:e,type:a,key:m,ref:v,props:g,_owner:r.current}}return Md.Fragment=t,Md.jsx=o,Md.jsxs=o,Md}var N2;function t5(){return N2||(N2=1,Wv.exports=e5()),Wv.exports}var M=t5(),op={},qv={exports:{}},xi={},Hv={exports:{}},Xv={};var D2;function n5(){return D2||(D2=1,(function(n){function e(J,ae){var ie=J.length;J.push(ae);e:for(;0<ie;){var $=ie-1>>>1,K=J[$];if(0<r(K,ae))J[$]=ae,J[ie]=K,ie=$;else break e}}function t(J){return J.length===0?null:J[0]}function i(J){if(J.length===0)return null;var ae=J[0],ie=J.pop();if(ie!==ae){J[0]=ie;e:for(var $=0,K=J.length,Ae=K>>>1;$<Ae;){var Re=2*($+1)-1,Pe=J[Re],Oe=Re+1,Fe=J[Oe];if(0>r(Pe,ie))Oe<K&&0>r(Fe,Pe)?(J[$]=Fe,J[Oe]=ie,$=Oe):(J[$]=Pe,J[Re]=ie,$=Re);else if(Oe<K&&0>r(Fe,ie))J[$]=Fe,J[Oe]=ie,$=Oe;else break e}}return ae}function r(J,ae){var ie=J.sortIndex-ae.sortIndex;return ie!==0?ie:J.id-ae.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var c=[],h=[],d=1,g=null,m=3,v=!1,y=!1,T=!1,w=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,P=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function C(J){for(var ae=t(h);ae!==null;){if(ae.callback===null)i(h);else if(ae.startTime<=J)i(h),ae.sortIndex=ae.expirationTime,e(c,ae);else break;ae=t(h)}}function N(J){if(T=!1,C(J),!y)if(t(c)!==null)y=!0,ye(D);else{var ae=t(h);ae!==null&&de(N,ae.startTime-J)}}function D(J,ae){y=!1,T&&(T=!1,A(R),R=-1),v=!0;var ie=m;try{for(C(ae),g=t(c);g!==null&&(!(g.expirationTime>ae)||J&&!j());){var $=g.callback;if(typeof $=="function"){g.callback=null,m=g.priorityLevel;var K=$(g.expirationTime<=ae);ae=n.unstable_now(),typeof K=="function"?g.callback=K:g===t(c)&&i(c),C(ae)}else i(c);g=t(c)}if(g!==null)var Ae=!0;else{var Re=t(h);Re!==null&&de(N,Re.startTime-ae),Ae=!1}return Ae}finally{g=null,m=ie,v=!1}}var z=!1,k=null,R=-1,L=5,F=-1;function j(){return!(n.unstable_now()-F<L)}function U(){if(k!==null){var J=n.unstable_now();F=J;var ae=!0;try{ae=k(!0,J)}finally{ae?O():(z=!1,k=null)}}else z=!1}var O;if(typeof P=="function")O=function(){P(U)};else if(typeof MessageChannel<"u"){var ce=new MessageChannel,we=ce.port2;ce.port1.onmessage=U,O=function(){we.postMessage(null)}}else O=function(){w(U,0)};function ye(J){k=J,z||(z=!0,O())}function de(J,ae){R=w(function(){J(n.unstable_now())},ae)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(J){J.callback=null},n.unstable_continueExecution=function(){y||v||(y=!0,ye(D))},n.unstable_forceFrameRate=function(J){0>J||125<J?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<J?Math.floor(1e3/J):5},n.unstable_getCurrentPriorityLevel=function(){return m},n.unstable_getFirstCallbackNode=function(){return t(c)},n.unstable_next=function(J){switch(m){case 1:case 2:case 3:var ae=3;break;default:ae=m}var ie=m;m=ae;try{return J()}finally{m=ie}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(J,ae){switch(J){case 1:case 2:case 3:case 4:case 5:break;default:J=3}var ie=m;m=J;try{return ae()}finally{m=ie}},n.unstable_scheduleCallback=function(J,ae,ie){var $=n.unstable_now();switch(typeof ie=="object"&&ie!==null?(ie=ie.delay,ie=typeof ie=="number"&&0<ie?$+ie:$):ie=$,J){case 1:var K=-1;break;case 2:K=250;break;case 5:K=1073741823;break;case 4:K=1e4;break;default:K=5e3}return K=ie+K,J={id:d++,callback:ae,priorityLevel:J,startTime:ie,expirationTime:K,sortIndex:-1},ie>$?(J.sortIndex=ie,e(h,J),t(c)===null&&J===t(h)&&(T?(A(R),R=-1):T=!0,de(N,ie-$))):(J.sortIndex=K,e(c,J),y||v||(y=!0,ye(D))),J},n.unstable_shouldYield=j,n.unstable_wrapCallback=function(J){var ae=m;return function(){var ie=m;m=ae;try{return J.apply(this,arguments)}finally{m=ie}}}})(Xv)),Xv}var O2;function i5(){return O2||(O2=1,Hv.exports=n5()),Hv.exports}var V2;function r5(){if(V2)return xi;V2=1;var n=_g(),e=i5();function t(l){for(var u="https://reactjs.org/docs/error-decoder.html?invariant="+l,f=1;f<arguments.length;f++)u+="&args[]="+encodeURIComponent(arguments[f]);return"Minified React error #"+l+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,r={};function s(l,u){o(l,u),o(l+"Capture",u)}function o(l,u){for(r[l]=u,l=0;l<u.length;l++)i.add(u[l])}var a=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),c=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d={},g={};function m(l){return c.call(g,l)?!0:c.call(d,l)?!1:h.test(l)?g[l]=!0:(d[l]=!0,!1)}function v(l,u,f,_){if(f!==null&&f.type===0)return!1;switch(typeof u){case"function":case"symbol":return!0;case"boolean":return _?!1:f!==null?!f.acceptsBooleans:(l=l.toLowerCase().slice(0,5),l!=="data-"&&l!=="aria-");default:return!1}}function y(l,u,f,_){if(u===null||typeof u>"u"||v(l,u,f,_))return!0;if(_)return!1;if(f!==null)switch(f.type){case 3:return!u;case 4:return u===!1;case 5:return isNaN(u);case 6:return isNaN(u)||1>u}return!1}function T(l,u,f,_,E,x,b){this.acceptsBooleans=u===2||u===3||u===4,this.attributeName=_,this.attributeNamespace=E,this.mustUseProperty=f,this.propertyName=l,this.type=u,this.sanitizeURL=x,this.removeEmptyString=b}var w={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(l){w[l]=new T(l,0,!1,l,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(l){var u=l[0];w[u]=new T(u,1,!1,l[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(l){w[l]=new T(l,2,!1,l.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(l){w[l]=new T(l,2,!1,l,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(l){w[l]=new T(l,3,!1,l.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(l){w[l]=new T(l,3,!0,l,null,!1,!1)}),["capture","download"].forEach(function(l){w[l]=new T(l,4,!1,l,null,!1,!1)}),["cols","rows","size","span"].forEach(function(l){w[l]=new T(l,6,!1,l,null,!1,!1)}),["rowSpan","start"].forEach(function(l){w[l]=new T(l,5,!1,l.toLowerCase(),null,!1,!1)});var A=/[\-:]([a-z])/g;function P(l){return l[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(l){var u=l.replace(A,P);w[u]=new T(u,1,!1,l,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(l){var u=l.replace(A,P);w[u]=new T(u,1,!1,l,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(l){var u=l.replace(A,P);w[u]=new T(u,1,!1,l,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(l){w[l]=new T(l,1,!1,l.toLowerCase(),null,!1,!1)}),w.xlinkHref=new T("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(l){w[l]=new T(l,1,!1,l.toLowerCase(),null,!0,!0)});function C(l,u,f,_){var E=w.hasOwnProperty(u)?w[u]:null;(E!==null?E.type!==0:_||!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(y(u,f,E,_)&&(f=null),_||E===null?m(u)&&(f===null?l.removeAttribute(u):l.setAttribute(u,""+f)):E.mustUseProperty?l[E.propertyName]=f===null?E.type===3?!1:"":f:(u=E.attributeName,_=E.attributeNamespace,f===null?l.removeAttribute(u):(E=E.type,f=E===3||E===4&&f===!0?"":""+f,_?l.setAttributeNS(_,u,f):l.setAttribute(u,f))))}var N=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,D=Symbol.for("react.element"),z=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),R=Symbol.for("react.strict_mode"),L=Symbol.for("react.profiler"),F=Symbol.for("react.provider"),j=Symbol.for("react.context"),U=Symbol.for("react.forward_ref"),O=Symbol.for("react.suspense"),ce=Symbol.for("react.suspense_list"),we=Symbol.for("react.memo"),ye=Symbol.for("react.lazy"),de=Symbol.for("react.offscreen"),J=Symbol.iterator;function ae(l){return l===null||typeof l!="object"?null:(l=J&&l[J]||l["@@iterator"],typeof l=="function"?l:null)}var ie=Object.assign,$;function K(l){if($===void 0)try{throw Error()}catch(f){var u=f.stack.trim().match(/\n( *(at )?)/);$=u&&u[1]||""}return`
`+$+l}var Ae=!1;function Re(l,u){if(!l||Ae)return"";Ae=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(u)if(u=function(){throw Error()},Object.defineProperty(u.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(u,[])}catch(Z){var _=Z}Reflect.construct(l,[],u)}else{try{u.call()}catch(Z){_=Z}l.call(u.prototype)}else{try{throw Error()}catch(Z){_=Z}l()}}catch(Z){if(Z&&_&&typeof Z.stack=="string"){for(var E=Z.stack.split(`
`),x=_.stack.split(`
`),b=E.length-1,G=x.length-1;1<=b&&0<=G&&E[b]!==x[G];)G--;for(;1<=b&&0<=G;b--,G--)if(E[b]!==x[G]){if(b!==1||G!==1)do if(b--,G--,0>G||E[b]!==x[G]){var B=`
`+E[b].replace(" at new "," at ");return l.displayName&&B.includes("<anonymous>")&&(B=B.replace("<anonymous>",l.displayName)),B}while(1<=b&&0<=G);break}}}finally{Ae=!1,Error.prepareStackTrace=f}return(l=l?l.displayName||l.name:"")?K(l):""}function Pe(l){switch(l.tag){case 5:return K(l.type);case 16:return K("Lazy");case 13:return K("Suspense");case 19:return K("SuspenseList");case 0:case 2:case 15:return l=Re(l.type,!1),l;case 11:return l=Re(l.type.render,!1),l;case 1:return l=Re(l.type,!0),l;default:return""}}function Oe(l){if(l==null)return null;if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l;switch(l){case k:return"Fragment";case z:return"Portal";case L:return"Profiler";case R:return"StrictMode";case O:return"Suspense";case ce:return"SuspenseList"}if(typeof l=="object")switch(l.$$typeof){case j:return(l.displayName||"Context")+".Consumer";case F:return(l._context.displayName||"Context")+".Provider";case U:var u=l.render;return l=l.displayName,l||(l=u.displayName||u.name||"",l=l!==""?"ForwardRef("+l+")":"ForwardRef"),l;case we:return u=l.displayName||null,u!==null?u:Oe(l.type)||"Memo";case ye:u=l._payload,l=l._init;try{return Oe(l(u))}catch{}}return null}function Fe(l){var u=l.type;switch(l.tag){case 24:return"Cache";case 9:return(u.displayName||"Context")+".Consumer";case 10:return(u._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return l=u.render,l=l.displayName||l.name||"",u.displayName||(l!==""?"ForwardRef("+l+")":"ForwardRef");case 7:return"Fragment";case 5:return u;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Oe(u);case 8:return u===R?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof u=="function")return u.displayName||u.name||null;if(typeof u=="string")return u}return null}function Ke(l){switch(typeof l){case"boolean":case"number":case"string":case"undefined":return l;case"object":return l;default:return""}}function Ye(l){var u=l.type;return(l=l.nodeName)&&l.toLowerCase()==="input"&&(u==="checkbox"||u==="radio")}function yt(l){var u=Ye(l)?"checked":"value",f=Object.getOwnPropertyDescriptor(l.constructor.prototype,u),_=""+l[u];if(!l.hasOwnProperty(u)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var E=f.get,x=f.set;return Object.defineProperty(l,u,{configurable:!0,get:function(){return E.call(this)},set:function(b){_=""+b,x.call(this,b)}}),Object.defineProperty(l,u,{enumerable:f.enumerable}),{getValue:function(){return _},setValue:function(b){_=""+b},stopTracking:function(){l._valueTracker=null,delete l[u]}}}}function Rr(l){l._valueTracker||(l._valueTracker=yt(l))}function js(l){if(!l)return!1;var u=l._valueTracker;if(!u)return!0;var f=u.getValue(),_="";return l&&(_=Ye(l)?l.checked?"true":"false":l.value),l=_,l!==f?(u.setValue(l),!0):!1}function gi(l){if(l=l||(typeof document<"u"?document:void 0),typeof l>"u")return null;try{return l.activeElement||l.body}catch{return l.body}}function mi(l,u){var f=u.checked;return ie({},u,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:f??l._wrapperState.initialChecked})}function Rn(l,u){var f=u.defaultValue==null?"":u.defaultValue,_=u.checked!=null?u.checked:u.defaultChecked;f=Ke(u.value!=null?u.value:f),l._wrapperState={initialChecked:_,initialValue:f,controlled:u.type==="checkbox"||u.type==="radio"?u.checked!=null:u.value!=null}}function Pn(l,u){u=u.checked,u!=null&&C(l,"checked",u,!1)}function pi(l,u){Pn(l,u);var f=Ke(u.value),_=u.type;if(f!=null)_==="number"?(f===0&&l.value===""||l.value!=f)&&(l.value=""+f):l.value!==""+f&&(l.value=""+f);else if(_==="submit"||_==="reset"){l.removeAttribute("value");return}u.hasOwnProperty("value")?Rt(l,u.type,f):u.hasOwnProperty("defaultValue")&&Rt(l,u.type,Ke(u.defaultValue)),u.checked==null&&u.defaultChecked!=null&&(l.defaultChecked=!!u.defaultChecked)}function tr(l,u,f){if(u.hasOwnProperty("value")||u.hasOwnProperty("defaultValue")){var _=u.type;if(!(_!=="submit"&&_!=="reset"||u.value!==void 0&&u.value!==null))return;u=""+l._wrapperState.initialValue,f||u===l.value||(l.value=u),l.defaultValue=u}f=l.name,f!==""&&(l.name=""),l.defaultChecked=!!l._wrapperState.initialChecked,f!==""&&(l.name=f)}function Rt(l,u,f){(u!=="number"||gi(l.ownerDocument)!==l)&&(f==null?l.defaultValue=""+l._wrapperState.initialValue:l.defaultValue!==""+f&&(l.defaultValue=""+f))}var vt=Array.isArray;function vn(l,u,f,_){if(l=l.options,u){u={};for(var E=0;E<f.length;E++)u["$"+f[E]]=!0;for(f=0;f<l.length;f++)E=u.hasOwnProperty("$"+l[f].value),l[f].selected!==E&&(l[f].selected=E),E&&_&&(l[f].defaultSelected=!0)}else{for(f=""+Ke(f),u=null,E=0;E<l.length;E++){if(l[E].value===f){l[E].selected=!0,_&&(l[E].defaultSelected=!0);return}u!==null||l[E].disabled||(u=l[E])}u!==null&&(u.selected=!0)}}function nr(l,u){if(u.dangerouslySetInnerHTML!=null)throw Error(t(91));return ie({},u,{value:void 0,defaultValue:void 0,children:""+l._wrapperState.initialValue})}function Nt(l,u){var f=u.value;if(f==null){if(f=u.children,u=u.defaultValue,f!=null){if(u!=null)throw Error(t(92));if(vt(f)){if(1<f.length)throw Error(t(93));f=f[0]}u=f}u==null&&(u=""),f=u}l._wrapperState={initialValue:Ke(f)}}function bo(l,u){var f=Ke(u.value),_=Ke(u.defaultValue);f!=null&&(f=""+f,f!==l.value&&(l.value=f),u.defaultValue==null&&l.defaultValue!==f&&(l.defaultValue=f)),_!=null&&(l.defaultValue=""+_)}function ir(l){var u=l.textContent;u===l._wrapperState.initialValue&&u!==""&&u!==null&&(l.value=u)}function Zr(l){switch(l){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Pr(l,u){return l==null||l==="http://www.w3.org/1999/xhtml"?Zr(u):l==="http://www.w3.org/2000/svg"&&u==="foreignObject"?"http://www.w3.org/1999/xhtml":l}var Qr,Ja=(function(l){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(u,f,_,E){MSApp.execUnsafeLocalFunction(function(){return l(u,f,_,E)})}:l})(function(l,u){if(l.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in l)l.innerHTML=u;else{for(Qr=Qr||document.createElement("div"),Qr.innerHTML="<svg>"+u.valueOf().toString()+"</svg>",u=Qr.firstChild;l.firstChild;)l.removeChild(l.firstChild);for(;u.firstChild;)l.appendChild(u.firstChild)}});function Jr(l,u){if(u){var f=l.firstChild;if(f&&f===l.lastChild&&f.nodeType===3){f.nodeValue=u;return}}l.textContent=u}var rr={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Mc=["Webkit","ms","Moz","O"];Object.keys(rr).forEach(function(l){Mc.forEach(function(u){u=u+l.charAt(0).toUpperCase()+l.substring(1),rr[u]=rr[l]})});function es(l,u,f){return u==null||typeof u=="boolean"||u===""?"":f||typeof u!="number"||u===0||rr.hasOwnProperty(l)&&rr[l]?(""+u).trim():u+"px"}function Gs(l,u){l=l.style;for(var f in u)if(u.hasOwnProperty(f)){var _=f.indexOf("--")===0,E=es(f,u[f],_);f==="float"&&(f="cssFloat"),_?l.setProperty(f,E):l[f]=E}}var ko=ie({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ri(l,u){if(u){if(ko[l]&&(u.children!=null||u.dangerouslySetInnerHTML!=null))throw Error(t(137,l));if(u.dangerouslySetInnerHTML!=null){if(u.children!=null)throw Error(t(60));if(typeof u.dangerouslySetInnerHTML!="object"||!("__html"in u.dangerouslySetInnerHTML))throw Error(t(61))}if(u.style!=null&&typeof u.style!="object")throw Error(t(62))}}function Us(l,u){if(l.indexOf("-")===-1)return typeof u.is=="string";switch(l){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ts=null;function ns(l){return l=l.target||l.srcElement||window,l.correspondingUseElement&&(l=l.correspondingUseElement),l.nodeType===3?l.parentNode:l}var si=null,oi=null,It=null;function Lo(l){if(l=md(l)){if(typeof si!="function")throw Error(t(280));var u=l.stateNode;u&&(u=wm(u),si(l.stateNode,l.type,u))}}function Cr(l){oi?It?It.push(l):It=[l]:oi=l}function Yt(){if(oi){var l=oi,u=It;if(It=oi=null,Lo(l),u)for(l=0;l<u.length;l++)Lo(u[l])}}function sr(l,u){return l(u)}function Cn(){}var Zt=!1;function Mn(l,u,f){if(Zt)return l(u,f);Zt=!0;try{return sr(l,u,f)}finally{Zt=!1,(oi!==null||It!==null)&&(Cn(),Yt())}}function bn(l,u){var f=l.stateNode;if(f===null)return null;var _=wm(f);if(_===null)return null;f=_[u];e:switch(u){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(_=!_.disabled)||(l=l.type,_=!(l==="button"||l==="input"||l==="select"||l==="textarea")),l=!_;break e;default:l=!1}if(l)return null;if(f&&typeof f!="function")throw Error(t(231,u,typeof f));return f}var En=!1;if(a)try{var ht={};Object.defineProperty(ht,"passive",{get:function(){En=!0}}),window.addEventListener("test",ht,ht),window.removeEventListener("test",ht,ht)}catch{En=!1}function rn(l,u,f,_,E,x,b,G,B){var Z=Array.prototype.slice.call(arguments,3);try{u.apply(f,Z)}catch(oe){this.onError(oe)}}var un=!1,or=null,bc=!1,ar=null,Jg={onError:function(l){un=!0,or=l}};function em(l,u,f,_,E,x,b,G,B){un=!1,or=null,rn.apply(Jg,arguments)}function Bh(l,u,f,_,E,x,b,G,B){if(em.apply(this,arguments),un){if(un){var Z=or;un=!1,or=null}else throw Error(t(198));bc||(bc=!0,ar=Z)}}function Mr(l){var u=l,f=l;if(l.alternate)for(;u.return;)u=u.return;else{l=u;do u=l,(u.flags&4098)!==0&&(f=u.return),l=u.return;while(l)}return u.tag===3?f:null}function $h(l){if(l.tag===13){var u=l.memoizedState;if(u===null&&(l=l.alternate,l!==null&&(u=l.memoizedState)),u!==null)return u.dehydrated}return null}function tm(l){if(Mr(l)!==l)throw Error(t(188))}function nm(l){var u=l.alternate;if(!u){if(u=Mr(l),u===null)throw Error(t(188));return u!==l?null:l}for(var f=l,_=u;;){var E=f.return;if(E===null)break;var x=E.alternate;if(x===null){if(_=E.return,_!==null){f=_;continue}break}if(E.child===x.child){for(x=E.child;x;){if(x===f)return tm(E),l;if(x===_)return tm(E),u;x=x.sibling}throw Error(t(188))}if(f.return!==_.return)f=E,_=x;else{for(var b=!1,G=E.child;G;){if(G===f){b=!0,f=E,_=x;break}if(G===_){b=!0,_=E,f=x;break}G=G.sibling}if(!b){for(G=x.child;G;){if(G===f){b=!0,f=x,_=E;break}if(G===_){b=!0,_=x,f=E;break}G=G.sibling}if(!b)throw Error(t(189))}}if(f.alternate!==_)throw Error(t(190))}if(f.tag!==3)throw Error(t(188));return f.stateNode.current===f?l:u}function im(l){return l=nm(l),l!==null?el(l):null}function el(l){if(l.tag===5||l.tag===6)return l;for(l=l.child;l!==null;){var u=el(l);if(u!==null)return u;l=l.sibling}return null}var Wh=e.unstable_scheduleCallback,kc=e.unstable_cancelCallback,tl=e.unstable_shouldYield,zs=e.unstable_requestPaint,Ct=e.unstable_now,xy=e.unstable_getCurrentPriorityLevel,Lc=e.unstable_ImmediatePriority,Kh=e.unstable_UserBlockingPriority,nl=e.unstable_NormalPriority,qh=e.unstable_LowPriority,Nc=e.unstable_IdlePriority,il=null,Di=null;function rm(l){if(Di&&typeof Di.onCommitFiberRoot=="function")try{Di.onCommitFiberRoot(il,l,void 0,(l.current.flags&128)===128)}catch{}}var Oi=Math.clz32?Math.clz32:rl,is=Math.log,lr=Math.LN2;function rl(l){return l>>>=0,l===0?32:31-(is(l)/lr|0)|0}var rs=64,No=4194304;function dt(l){switch(l&-l){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return l&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return l}}function Bs(l,u){var f=l.pendingLanes;if(f===0)return 0;var _=0,E=l.suspendedLanes,x=l.pingedLanes,b=f&268435455;if(b!==0){var G=b&~E;G!==0?_=dt(G):(x&=b,x!==0&&(_=dt(x)))}else b=f&~E,b!==0?_=dt(b):x!==0&&(_=dt(x));if(_===0)return 0;if(u!==0&&u!==_&&(u&E)===0&&(E=_&-_,x=u&-u,E>=x||E===16&&(x&4194240)!==0))return u;if((_&4)!==0&&(_|=f&16),u=l.entangledLanes,u!==0)for(l=l.entanglements,u&=_;0<u;)f=31-Oi(u),E=1<<f,_|=l[f],u&=~E;return _}function sl(l,u){switch(l){case 1:case 2:case 4:return u+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ol(l,u){for(var f=l.suspendedLanes,_=l.pingedLanes,E=l.expirationTimes,x=l.pendingLanes;0<x;){var b=31-Oi(x),G=1<<b,B=E[b];B===-1?((G&f)===0||(G&_)!==0)&&(E[b]=sl(G,u)):B<=u&&(l.expiredLanes|=G),x&=~G}}function Hh(l){return l=l.pendingLanes&-1073741825,l!==0?l:l&1073741824?1073741824:0}function Xh(){var l=rs;return rs<<=1,(rs&4194240)===0&&(rs=64),l}function Yh(l){for(var u=[],f=0;31>f;f++)u.push(l);return u}function al(l,u,f){l.pendingLanes|=u,u!==536870912&&(l.suspendedLanes=0,l.pingedLanes=0),l=l.eventTimes,u=31-Oi(u),l[u]=f}function Sy(l,u){var f=l.pendingLanes&~u;l.pendingLanes=u,l.suspendedLanes=0,l.pingedLanes=0,l.expiredLanes&=u,l.mutableReadLanes&=u,l.entangledLanes&=u,u=l.entanglements;var _=l.eventTimes;for(l=l.expirationTimes;0<f;){var E=31-Oi(f),x=1<<E;u[E]=0,_[E]=-1,l[E]=-1,f&=~x}}function Zh(l,u){var f=l.entangledLanes|=u;for(l=l.entanglements;f;){var _=31-Oi(f),E=1<<_;E&u|l[_]&u&&(l[_]|=u),f&=~E}}var nt=0;function ss(l){return l&=-l,1<l?4<l?(l&268435455)!==0?16:536870912:4:1}var Qh,Dc,Jh,ed,td,os=!1,Oc=[],as=null,ls=null,kn=null,ll=new Map,$s=new Map,Vi=[],sm="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Do(l,u){switch(l){case"focusin":case"focusout":as=null;break;case"dragenter":case"dragleave":ls=null;break;case"mouseover":case"mouseout":kn=null;break;case"pointerover":case"pointerout":ll.delete(u.pointerId);break;case"gotpointercapture":case"lostpointercapture":$s.delete(u.pointerId)}}function br(l,u,f,_,E,x){return l===null||l.nativeEvent!==x?(l={blockedOn:u,domEventName:f,eventSystemFlags:_,nativeEvent:x,targetContainers:[E]},u!==null&&(u=md(u),u!==null&&Dc(u)),l):(l.eventSystemFlags|=_,u=l.targetContainers,E!==null&&u.indexOf(E)===-1&&u.push(E),l)}function om(l,u,f,_,E){switch(u){case"focusin":return as=br(as,l,u,f,_,E),!0;case"dragenter":return ls=br(ls,l,u,f,_,E),!0;case"mouseover":return kn=br(kn,l,u,f,_,E),!0;case"pointerover":var x=E.pointerId;return ll.set(x,br(ll.get(x)||null,l,u,f,_,E)),!0;case"gotpointercapture":return x=E.pointerId,$s.set(x,br($s.get(x)||null,l,u,f,_,E)),!0}return!1}function Vc(l){var u=dl(l.target);if(u!==null){var f=Mr(u);if(f!==null){if(u=f.tag,u===13){if(u=$h(f),u!==null){l.blockedOn=u,td(l.priority,function(){Jh(f)});return}}else if(u===3&&f.stateNode.current.memoizedState.isDehydrated){l.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}l.blockedOn=null}function At(l){if(l.blockedOn!==null)return!1;for(var u=l.targetContainers;0<u.length;){var f=Fc(l.domEventName,l.eventSystemFlags,u[0],l.nativeEvent);if(f===null){f=l.nativeEvent;var _=new f.constructor(f.type,f);ts=_,f.target.dispatchEvent(_),ts=null}else return u=md(f),u!==null&&Dc(u),l.blockedOn=f,!1;u.shift()}return!0}function am(l,u,f){At(l)&&f.delete(u)}function Ty(){os=!1,as!==null&&At(as)&&(as=null),ls!==null&&At(ls)&&(ls=null),kn!==null&&At(kn)&&(kn=null),ll.forEach(am),$s.forEach(am)}function Oo(l,u){l.blockedOn===u&&(l.blockedOn=null,os||(os=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Ty)))}function Vo(l){function u(E){return Oo(E,l)}if(0<Oc.length){Oo(Oc[0],l);for(var f=1;f<Oc.length;f++){var _=Oc[f];_.blockedOn===l&&(_.blockedOn=null)}}for(as!==null&&Oo(as,l),ls!==null&&Oo(ls,l),kn!==null&&Oo(kn,l),ll.forEach(u),$s.forEach(u),f=0;f<Vi.length;f++)_=Vi[f],_.blockedOn===l&&(_.blockedOn=null);for(;0<Vi.length&&(f=Vi[0],f.blockedOn===null);)Vc(f),f.blockedOn===null&&Vi.shift()}var Ws=N.ReactCurrentBatchConfig,Ks=!0;function cs(l,u,f,_){var E=nt,x=Ws.transition;Ws.transition=null;try{nt=1,nd(l,u,f,_)}finally{nt=E,Ws.transition=x}}function lm(l,u,f,_){var E=nt,x=Ws.transition;Ws.transition=null;try{nt=4,nd(l,u,f,_)}finally{nt=E,Ws.transition=x}}function nd(l,u,f,_){if(Ks){var E=Fc(l,u,f,_);if(E===null)Dy(l,u,_,us,f),Do(l,_);else if(om(E,l,u,f,_))_.stopPropagation();else if(Do(l,_),u&4&&-1<sm.indexOf(l)){for(;E!==null;){var x=md(E);if(x!==null&&Qh(x),x=Fc(l,u,f,_),x===null&&Dy(l,u,_,us,f),x===E)break;E=x}E!==null&&_.stopPropagation()}else Dy(l,u,_,null,f)}}var us=null;function Fc(l,u,f,_){if(us=null,l=ns(_),l=dl(l),l!==null)if(u=Mr(l),u===null)l=null;else if(f=u.tag,f===13){if(l=$h(u),l!==null)return l;l=null}else if(f===3){if(u.stateNode.current.memoizedState.isDehydrated)return u.tag===3?u.stateNode.containerInfo:null;l=null}else u!==l&&(l=null);return us=l,null}function jc(l){switch(l){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(xy()){case Lc:return 1;case Kh:return 4;case nl:case qh:return 16;case Nc:return 536870912;default:return 16}default:return 16}}var Fi=null,Gc=null,qs=null;function cm(){if(qs)return qs;var l,u=Gc,f=u.length,_,E="value"in Fi?Fi.value:Fi.textContent,x=E.length;for(l=0;l<f&&u[l]===E[l];l++);var b=f-l;for(_=1;_<=b&&u[f-_]===E[x-_];_++);return qs=E.slice(l,1<_?1-_:void 0)}function cl(l){var u=l.keyCode;return"charCode"in l?(l=l.charCode,l===0&&u===13&&(l=13)):l=u,l===10&&(l=13),32<=l||l===13?l:0}function hs(){return!0}function id(){return!1}function zn(l){function u(f,_,E,x,b){this._reactName=f,this._targetInst=E,this.type=_,this.nativeEvent=x,this.target=b,this.currentTarget=null;for(var G in l)l.hasOwnProperty(G)&&(f=l[G],this[G]=f?f(x):x[G]);return this.isDefaultPrevented=(x.defaultPrevented!=null?x.defaultPrevented:x.returnValue===!1)?hs:id,this.isPropagationStopped=id,this}return ie(u.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=hs)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=hs)},persist:function(){},isPersistent:hs}),u}var ds={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(l){return l.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ul=zn(ds),Fo=ie({},ds,{view:0,detail:0}),Uc=zn(Fo),zc,Bc,ji,hl=ie({},Fo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:qe,button:0,buttons:0,relatedTarget:function(l){return l.relatedTarget===void 0?l.fromElement===l.srcElement?l.toElement:l.fromElement:l.relatedTarget},movementX:function(l){return"movementX"in l?l.movementX:(l!==ji&&(ji&&l.type==="mousemove"?(zc=l.screenX-ji.screenX,Bc=l.screenY-ji.screenY):Bc=zc=0,ji=l),zc)},movementY:function(l){return"movementY"in l?l.movementY:Bc}}),rd=zn(hl),um=ie({},hl,{dataTransfer:0}),hm=zn(um),$c=ie({},Fo,{relatedTarget:0}),Ln=zn($c),dm=ie({},ds,{animationName:0,elapsedTime:0,pseudoElement:0}),fm=zn(dm),jo=ie({},ds,{clipboardData:function(l){return"clipboardData"in l?l.clipboardData:window.clipboardData}}),p=zn(jo),S=ie({},ds,{data:0}),I=zn(S),V={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},X={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Q={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function fe(l){var u=this.nativeEvent;return u.getModifierState?u.getModifierState(l):(l=Q[l])?!!u[l]:!1}function qe(){return fe}var Qt=ie({},Fo,{key:function(l){if(l.key){var u=V[l.key]||l.key;if(u!=="Unidentified")return u}return l.type==="keypress"?(l=cl(l),l===13?"Enter":String.fromCharCode(l)):l.type==="keydown"||l.type==="keyup"?X[l.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:qe,charCode:function(l){return l.type==="keypress"?cl(l):0},keyCode:function(l){return l.type==="keydown"||l.type==="keyup"?l.keyCode:0},which:function(l){return l.type==="keypress"?cl(l):l.type==="keydown"||l.type==="keyup"?l.keyCode:0}}),Et=zn(Qt),sn=ie({},hl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Gi=zn(sn),Hs=ie({},Fo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:qe}),fs=zn(Hs),gs=ie({},ds,{propertyName:0,elapsedTime:0,pseudoElement:0}),Wc=zn(gs),sd=ie({},hl,{deltaX:function(l){return"deltaX"in l?l.deltaX:"wheelDeltaX"in l?-l.wheelDeltaX:0},deltaY:function(l){return"deltaY"in l?l.deltaY:"wheelDeltaY"in l?-l.wheelDeltaY:"wheelDelta"in l?-l.wheelDelta:0},deltaZ:0,deltaMode:0}),q3=zn(sd),H3=[9,13,27,32],Iy=a&&"CompositionEvent"in window,od=null;a&&"documentMode"in document&&(od=document.documentMode);var X3=a&&"TextEvent"in window&&!od,ST=a&&(!Iy||od&&8<od&&11>=od),TT=" ",IT=!1;function AT(l,u){switch(l){case"keyup":return H3.indexOf(u.keyCode)!==-1;case"keydown":return u.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function RT(l){return l=l.detail,typeof l=="object"&&"data"in l?l.data:null}var Kc=!1;function Y3(l,u){switch(l){case"compositionend":return RT(u);case"keypress":return u.which!==32?null:(IT=!0,TT);case"textInput":return l=u.data,l===TT&&IT?null:l;default:return null}}function Z3(l,u){if(Kc)return l==="compositionend"||!Iy&&AT(l,u)?(l=cm(),qs=Gc=Fi=null,Kc=!1,l):null;switch(l){case"paste":return null;case"keypress":if(!(u.ctrlKey||u.altKey||u.metaKey)||u.ctrlKey&&u.altKey){if(u.char&&1<u.char.length)return u.char;if(u.which)return String.fromCharCode(u.which)}return null;case"compositionend":return ST&&u.locale!=="ko"?null:u.data;default:return null}}var Q3={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function PT(l){var u=l&&l.nodeName&&l.nodeName.toLowerCase();return u==="input"?!!Q3[l.type]:u==="textarea"}function CT(l,u,f,_){Cr(_),u=ym(u,"onChange"),0<u.length&&(f=new ul("onChange","change",null,f,_),l.push({event:f,listeners:u}))}var ad=null,ld=null;function J3(l){qT(l,0)}function gm(l){var u=Zc(l);if(js(u))return l}function eO(l,u){if(l==="change")return u}var MT=!1;if(a){var Ay;if(a){var Ry="oninput"in document;if(!Ry){var bT=document.createElement("div");bT.setAttribute("oninput","return;"),Ry=typeof bT.oninput=="function"}Ay=Ry}else Ay=!1;MT=Ay&&(!document.documentMode||9<document.documentMode)}function kT(){ad&&(ad.detachEvent("onpropertychange",LT),ld=ad=null)}function LT(l){if(l.propertyName==="value"&&gm(ld)){var u=[];CT(u,ld,l,ns(l)),Mn(J3,u)}}function tO(l,u,f){l==="focusin"?(kT(),ad=u,ld=f,ad.attachEvent("onpropertychange",LT)):l==="focusout"&&kT()}function nO(l){if(l==="selectionchange"||l==="keyup"||l==="keydown")return gm(ld)}function iO(l,u){if(l==="click")return gm(u)}function rO(l,u){if(l==="input"||l==="change")return gm(u)}function sO(l,u){return l===u&&(l!==0||1/l===1/u)||l!==l&&u!==u}var kr=typeof Object.is=="function"?Object.is:sO;function cd(l,u){if(kr(l,u))return!0;if(typeof l!="object"||l===null||typeof u!="object"||u===null)return!1;var f=Object.keys(l),_=Object.keys(u);if(f.length!==_.length)return!1;for(_=0;_<f.length;_++){var E=f[_];if(!c.call(u,E)||!kr(l[E],u[E]))return!1}return!0}function NT(l){for(;l&&l.firstChild;)l=l.firstChild;return l}function DT(l,u){var f=NT(l);l=0;for(var _;f;){if(f.nodeType===3){if(_=l+f.textContent.length,l<=u&&_>=u)return{node:f,offset:u-l};l=_}e:{for(;f;){if(f.nextSibling){f=f.nextSibling;break e}f=f.parentNode}f=void 0}f=NT(f)}}function OT(l,u){return l&&u?l===u?!0:l&&l.nodeType===3?!1:u&&u.nodeType===3?OT(l,u.parentNode):"contains"in l?l.contains(u):l.compareDocumentPosition?!!(l.compareDocumentPosition(u)&16):!1:!1}function VT(){for(var l=window,u=gi();u instanceof l.HTMLIFrameElement;){try{var f=typeof u.contentWindow.location.href=="string"}catch{f=!1}if(f)l=u.contentWindow;else break;u=gi(l.document)}return u}function Py(l){var u=l&&l.nodeName&&l.nodeName.toLowerCase();return u&&(u==="input"&&(l.type==="text"||l.type==="search"||l.type==="tel"||l.type==="url"||l.type==="password")||u==="textarea"||l.contentEditable==="true")}function oO(l){var u=VT(),f=l.focusedElem,_=l.selectionRange;if(u!==f&&f&&f.ownerDocument&&OT(f.ownerDocument.documentElement,f)){if(_!==null&&Py(f)){if(u=_.start,l=_.end,l===void 0&&(l=u),"selectionStart"in f)f.selectionStart=u,f.selectionEnd=Math.min(l,f.value.length);else if(l=(u=f.ownerDocument||document)&&u.defaultView||window,l.getSelection){l=l.getSelection();var E=f.textContent.length,x=Math.min(_.start,E);_=_.end===void 0?x:Math.min(_.end,E),!l.extend&&x>_&&(E=_,_=x,x=E),E=DT(f,x);var b=DT(f,_);E&&b&&(l.rangeCount!==1||l.anchorNode!==E.node||l.anchorOffset!==E.offset||l.focusNode!==b.node||l.focusOffset!==b.offset)&&(u=u.createRange(),u.setStart(E.node,E.offset),l.removeAllRanges(),x>_?(l.addRange(u),l.extend(b.node,b.offset)):(u.setEnd(b.node,b.offset),l.addRange(u)))}}for(u=[],l=f;l=l.parentNode;)l.nodeType===1&&u.push({element:l,left:l.scrollLeft,top:l.scrollTop});for(typeof f.focus=="function"&&f.focus(),f=0;f<u.length;f++)l=u[f],l.element.scrollLeft=l.left,l.element.scrollTop=l.top}}var aO=a&&"documentMode"in document&&11>=document.documentMode,qc=null,Cy=null,ud=null,My=!1;function FT(l,u,f){var _=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;My||qc==null||qc!==gi(_)||(_=qc,"selectionStart"in _&&Py(_)?_={start:_.selectionStart,end:_.selectionEnd}:(_=(_.ownerDocument&&_.ownerDocument.defaultView||window).getSelection(),_={anchorNode:_.anchorNode,anchorOffset:_.anchorOffset,focusNode:_.focusNode,focusOffset:_.focusOffset}),ud&&cd(ud,_)||(ud=_,_=ym(Cy,"onSelect"),0<_.length&&(u=new ul("onSelect","select",null,u,f),l.push({event:u,listeners:_}),u.target=qc)))}function mm(l,u){var f={};return f[l.toLowerCase()]=u.toLowerCase(),f["Webkit"+l]="webkit"+u,f["Moz"+l]="moz"+u,f}var Hc={animationend:mm("Animation","AnimationEnd"),animationiteration:mm("Animation","AnimationIteration"),animationstart:mm("Animation","AnimationStart"),transitionend:mm("Transition","TransitionEnd")},by={},jT={};a&&(jT=document.createElement("div").style,"AnimationEvent"in window||(delete Hc.animationend.animation,delete Hc.animationiteration.animation,delete Hc.animationstart.animation),"TransitionEvent"in window||delete Hc.transitionend.transition);function pm(l){if(by[l])return by[l];if(!Hc[l])return l;var u=Hc[l],f;for(f in u)if(u.hasOwnProperty(f)&&f in jT)return by[l]=u[f];return l}var GT=pm("animationend"),UT=pm("animationiteration"),zT=pm("animationstart"),BT=pm("transitionend"),$T=new Map,WT="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Go(l,u){$T.set(l,u),s(u,[l])}for(var ky=0;ky<WT.length;ky++){var Ly=WT[ky],lO=Ly.toLowerCase(),cO=Ly[0].toUpperCase()+Ly.slice(1);Go(lO,"on"+cO)}Go(GT,"onAnimationEnd"),Go(UT,"onAnimationIteration"),Go(zT,"onAnimationStart"),Go("dblclick","onDoubleClick"),Go("focusin","onFocus"),Go("focusout","onBlur"),Go(BT,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var hd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),uO=new Set("cancel close invalid load scroll toggle".split(" ").concat(hd));function KT(l,u,f){var _=l.type||"unknown-event";l.currentTarget=f,Bh(_,u,void 0,l),l.currentTarget=null}function qT(l,u){u=(u&4)!==0;for(var f=0;f<l.length;f++){var _=l[f],E=_.event;_=_.listeners;e:{var x=void 0;if(u)for(var b=_.length-1;0<=b;b--){var G=_[b],B=G.instance,Z=G.currentTarget;if(G=G.listener,B!==x&&E.isPropagationStopped())break e;KT(E,G,Z),x=B}else for(b=0;b<_.length;b++){if(G=_[b],B=G.instance,Z=G.currentTarget,G=G.listener,B!==x&&E.isPropagationStopped())break e;KT(E,G,Z),x=B}}}if(bc)throw l=ar,bc=!1,ar=null,l}function Mt(l,u){var f=u[Uy];f===void 0&&(f=u[Uy]=new Set);var _=l+"__bubble";f.has(_)||(HT(u,l,2,!1),f.add(_))}function Ny(l,u,f){var _=0;u&&(_|=4),HT(f,l,_,u)}var _m="_reactListening"+Math.random().toString(36).slice(2);function dd(l){if(!l[_m]){l[_m]=!0,i.forEach(function(f){f!=="selectionchange"&&(uO.has(f)||Ny(f,!1,l),Ny(f,!0,l))});var u=l.nodeType===9?l:l.ownerDocument;u===null||u[_m]||(u[_m]=!0,Ny("selectionchange",!1,u))}}function HT(l,u,f,_){switch(jc(u)){case 1:var E=cs;break;case 4:E=lm;break;default:E=nd}f=E.bind(null,u,f,l),E=void 0,!En||u!=="touchstart"&&u!=="touchmove"&&u!=="wheel"||(E=!0),_?E!==void 0?l.addEventListener(u,f,{capture:!0,passive:E}):l.addEventListener(u,f,!0):E!==void 0?l.addEventListener(u,f,{passive:E}):l.addEventListener(u,f,!1)}function Dy(l,u,f,_,E){var x=_;if((u&1)===0&&(u&2)===0&&_!==null)e:for(;;){if(_===null)return;var b=_.tag;if(b===3||b===4){var G=_.stateNode.containerInfo;if(G===E||G.nodeType===8&&G.parentNode===E)break;if(b===4)for(b=_.return;b!==null;){var B=b.tag;if((B===3||B===4)&&(B=b.stateNode.containerInfo,B===E||B.nodeType===8&&B.parentNode===E))return;b=b.return}for(;G!==null;){if(b=dl(G),b===null)return;if(B=b.tag,B===5||B===6){_=x=b;continue e}G=G.parentNode}}_=_.return}Mn(function(){var Z=x,oe=ns(f),le=[];e:{var re=$T.get(l);if(re!==void 0){var ve=ul,xe=l;switch(l){case"keypress":if(cl(f)===0)break e;case"keydown":case"keyup":ve=Et;break;case"focusin":xe="focus",ve=Ln;break;case"focusout":xe="blur",ve=Ln;break;case"beforeblur":case"afterblur":ve=Ln;break;case"click":if(f.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ve=rd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ve=hm;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ve=fs;break;case GT:case UT:case zT:ve=fm;break;case BT:ve=Wc;break;case"scroll":ve=Uc;break;case"wheel":ve=q3;break;case"copy":case"cut":case"paste":ve=p;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ve=Gi}var Te=(u&4)!==0,Jt=!Te&&l==="scroll",H=Te?re!==null?re+"Capture":null:re;Te=[];for(var W=Z,Y;W!==null;){Y=W;var he=Y.stateNode;if(Y.tag===5&&he!==null&&(Y=he,H!==null&&(he=bn(W,H),he!=null&&Te.push(fd(W,he,Y)))),Jt)break;W=W.return}0<Te.length&&(re=new ve(re,xe,null,f,oe),le.push({event:re,listeners:Te}))}}if((u&7)===0){e:{if(re=l==="mouseover"||l==="pointerover",ve=l==="mouseout"||l==="pointerout",re&&f!==ts&&(xe=f.relatedTarget||f.fromElement)&&(dl(xe)||xe[Xs]))break e;if((ve||re)&&(re=oe.window===oe?oe:(re=oe.ownerDocument)?re.defaultView||re.parentWindow:window,ve?(xe=f.relatedTarget||f.toElement,ve=Z,xe=xe?dl(xe):null,xe!==null&&(Jt=Mr(xe),xe!==Jt||xe.tag!==5&&xe.tag!==6)&&(xe=null)):(ve=null,xe=Z),ve!==xe)){if(Te=rd,he="onMouseLeave",H="onMouseEnter",W="mouse",(l==="pointerout"||l==="pointerover")&&(Te=Gi,he="onPointerLeave",H="onPointerEnter",W="pointer"),Jt=ve==null?re:Zc(ve),Y=xe==null?re:Zc(xe),re=new Te(he,W+"leave",ve,f,oe),re.target=Jt,re.relatedTarget=Y,he=null,dl(oe)===Z&&(Te=new Te(H,W+"enter",xe,f,oe),Te.target=Y,Te.relatedTarget=Jt,he=Te),Jt=he,ve&&xe)t:{for(Te=ve,H=xe,W=0,Y=Te;Y;Y=Xc(Y))W++;for(Y=0,he=H;he;he=Xc(he))Y++;for(;0<W-Y;)Te=Xc(Te),W--;for(;0<Y-W;)H=Xc(H),Y--;for(;W--;){if(Te===H||H!==null&&Te===H.alternate)break t;Te=Xc(Te),H=Xc(H)}Te=null}else Te=null;ve!==null&&XT(le,re,ve,Te,!1),xe!==null&&Jt!==null&&XT(le,Jt,xe,Te,!0)}}e:{if(re=Z?Zc(Z):window,ve=re.nodeName&&re.nodeName.toLowerCase(),ve==="select"||ve==="input"&&re.type==="file")var Ie=eO;else if(PT(re))if(MT)Ie=rO;else{Ie=nO;var Ne=tO}else(ve=re.nodeName)&&ve.toLowerCase()==="input"&&(re.type==="checkbox"||re.type==="radio")&&(Ie=iO);if(Ie&&(Ie=Ie(l,Z))){CT(le,Ie,f,oe);break e}Ne&&Ne(l,re,Z),l==="focusout"&&(Ne=re._wrapperState)&&Ne.controlled&&re.type==="number"&&Rt(re,"number",re.value)}switch(Ne=Z?Zc(Z):window,l){case"focusin":(PT(Ne)||Ne.contentEditable==="true")&&(qc=Ne,Cy=Z,ud=null);break;case"focusout":ud=Cy=qc=null;break;case"mousedown":My=!0;break;case"contextmenu":case"mouseup":case"dragend":My=!1,FT(le,f,oe);break;case"selectionchange":if(aO)break;case"keydown":case"keyup":FT(le,f,oe)}var De;if(Iy)e:{switch(l){case"compositionstart":var je="onCompositionStart";break e;case"compositionend":je="onCompositionEnd";break e;case"compositionupdate":je="onCompositionUpdate";break e}je=void 0}else Kc?AT(l,f)&&(je="onCompositionEnd"):l==="keydown"&&f.keyCode===229&&(je="onCompositionStart");je&&(ST&&f.locale!=="ko"&&(Kc||je!=="onCompositionStart"?je==="onCompositionEnd"&&Kc&&(De=cm()):(Fi=oe,Gc="value"in Fi?Fi.value:Fi.textContent,Kc=!0)),Ne=ym(Z,je),0<Ne.length&&(je=new I(je,l,null,f,oe),le.push({event:je,listeners:Ne}),De?je.data=De:(De=RT(f),De!==null&&(je.data=De)))),(De=X3?Y3(l,f):Z3(l,f))&&(Z=ym(Z,"onBeforeInput"),0<Z.length&&(oe=new I("onBeforeInput","beforeinput",null,f,oe),le.push({event:oe,listeners:Z}),oe.data=De))}qT(le,u)})}function fd(l,u,f){return{instance:l,listener:u,currentTarget:f}}function ym(l,u){for(var f=u+"Capture",_=[];l!==null;){var E=l,x=E.stateNode;E.tag===5&&x!==null&&(E=x,x=bn(l,f),x!=null&&_.unshift(fd(l,x,E)),x=bn(l,u),x!=null&&_.push(fd(l,x,E))),l=l.return}return _}function Xc(l){if(l===null)return null;do l=l.return;while(l&&l.tag!==5);return l||null}function XT(l,u,f,_,E){for(var x=u._reactName,b=[];f!==null&&f!==_;){var G=f,B=G.alternate,Z=G.stateNode;if(B!==null&&B===_)break;G.tag===5&&Z!==null&&(G=Z,E?(B=bn(f,x),B!=null&&b.unshift(fd(f,B,G))):E||(B=bn(f,x),B!=null&&b.push(fd(f,B,G)))),f=f.return}b.length!==0&&l.push({event:u,listeners:b})}var hO=/\r\n?/g,dO=/\u0000|\uFFFD/g;function YT(l){return(typeof l=="string"?l:""+l).replace(hO,`
`).replace(dO,"")}function vm(l,u,f){if(u=YT(u),YT(l)!==u&&f)throw Error(t(425))}function Em(){}var Oy=null,Vy=null;function Fy(l,u){return l==="textarea"||l==="noscript"||typeof u.children=="string"||typeof u.children=="number"||typeof u.dangerouslySetInnerHTML=="object"&&u.dangerouslySetInnerHTML!==null&&u.dangerouslySetInnerHTML.__html!=null}var jy=typeof setTimeout=="function"?setTimeout:void 0,fO=typeof clearTimeout=="function"?clearTimeout:void 0,ZT=typeof Promise=="function"?Promise:void 0,gO=typeof queueMicrotask=="function"?queueMicrotask:typeof ZT<"u"?function(l){return ZT.resolve(null).then(l).catch(mO)}:jy;function mO(l){setTimeout(function(){throw l})}function Gy(l,u){var f=u,_=0;do{var E=f.nextSibling;if(l.removeChild(f),E&&E.nodeType===8)if(f=E.data,f==="/$"){if(_===0){l.removeChild(E),Vo(u);return}_--}else f!=="$"&&f!=="$?"&&f!=="$!"||_++;f=E}while(f);Vo(u)}function Uo(l){for(;l!=null;l=l.nextSibling){var u=l.nodeType;if(u===1||u===3)break;if(u===8){if(u=l.data,u==="$"||u==="$!"||u==="$?")break;if(u==="/$")return null}}return l}function QT(l){l=l.previousSibling;for(var u=0;l;){if(l.nodeType===8){var f=l.data;if(f==="$"||f==="$!"||f==="$?"){if(u===0)return l;u--}else f==="/$"&&u++}l=l.previousSibling}return null}var Yc=Math.random().toString(36).slice(2),ms="__reactFiber$"+Yc,gd="__reactProps$"+Yc,Xs="__reactContainer$"+Yc,Uy="__reactEvents$"+Yc,pO="__reactListeners$"+Yc,_O="__reactHandles$"+Yc;function dl(l){var u=l[ms];if(u)return u;for(var f=l.parentNode;f;){if(u=f[Xs]||f[ms]){if(f=u.alternate,u.child!==null||f!==null&&f.child!==null)for(l=QT(l);l!==null;){if(f=l[ms])return f;l=QT(l)}return u}l=f,f=l.parentNode}return null}function md(l){return l=l[ms]||l[Xs],!l||l.tag!==5&&l.tag!==6&&l.tag!==13&&l.tag!==3?null:l}function Zc(l){if(l.tag===5||l.tag===6)return l.stateNode;throw Error(t(33))}function wm(l){return l[gd]||null}var zy=[],Qc=-1;function zo(l){return{current:l}}function bt(l){0>Qc||(l.current=zy[Qc],zy[Qc]=null,Qc--)}function Pt(l,u){Qc++,zy[Qc]=l.current,l.current=u}var Bo={},Bn=zo(Bo),_i=zo(!1),fl=Bo;function Jc(l,u){var f=l.type.contextTypes;if(!f)return Bo;var _=l.stateNode;if(_&&_.__reactInternalMemoizedUnmaskedChildContext===u)return _.__reactInternalMemoizedMaskedChildContext;var E={},x;for(x in f)E[x]=u[x];return _&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=u,l.__reactInternalMemoizedMaskedChildContext=E),E}function yi(l){return l=l.childContextTypes,l!=null}function xm(){bt(_i),bt(Bn)}function JT(l,u,f){if(Bn.current!==Bo)throw Error(t(168));Pt(Bn,u),Pt(_i,f)}function eI(l,u,f){var _=l.stateNode;if(u=u.childContextTypes,typeof _.getChildContext!="function")return f;_=_.getChildContext();for(var E in _)if(!(E in u))throw Error(t(108,Fe(l)||"Unknown",E));return ie({},f,_)}function Sm(l){return l=(l=l.stateNode)&&l.__reactInternalMemoizedMergedChildContext||Bo,fl=Bn.current,Pt(Bn,l),Pt(_i,_i.current),!0}function tI(l,u,f){var _=l.stateNode;if(!_)throw Error(t(169));f?(l=eI(l,u,fl),_.__reactInternalMemoizedMergedChildContext=l,bt(_i),bt(Bn),Pt(Bn,l)):bt(_i),Pt(_i,f)}var Ys=null,Tm=!1,By=!1;function nI(l){Ys===null?Ys=[l]:Ys.push(l)}function yO(l){Tm=!0,nI(l)}function $o(){if(!By&&Ys!==null){By=!0;var l=0,u=nt;try{var f=Ys;for(nt=1;l<f.length;l++){var _=f[l];do _=_(!0);while(_!==null)}Ys=null,Tm=!1}catch(E){throw Ys!==null&&(Ys=Ys.slice(l+1)),Wh(Lc,$o),E}finally{nt=u,By=!1}}return null}var eu=[],tu=0,Im=null,Am=0,cr=[],ur=0,gl=null,Zs=1,Qs="";function ml(l,u){eu[tu++]=Am,eu[tu++]=Im,Im=l,Am=u}function iI(l,u,f){cr[ur++]=Zs,cr[ur++]=Qs,cr[ur++]=gl,gl=l;var _=Zs;l=Qs;var E=32-Oi(_)-1;_&=~(1<<E),f+=1;var x=32-Oi(u)+E;if(30<x){var b=E-E%5;x=(_&(1<<b)-1).toString(32),_>>=b,E-=b,Zs=1<<32-Oi(u)+E|f<<E|_,Qs=x+l}else Zs=1<<x|f<<E|_,Qs=l}function $y(l){l.return!==null&&(ml(l,1),iI(l,1,0))}function Wy(l){for(;l===Im;)Im=eu[--tu],eu[tu]=null,Am=eu[--tu],eu[tu]=null;for(;l===gl;)gl=cr[--ur],cr[ur]=null,Qs=cr[--ur],cr[ur]=null,Zs=cr[--ur],cr[ur]=null}var Ui=null,zi=null,Dt=!1,Lr=null;function rI(l,u){var f=gr(5,null,null,0);f.elementType="DELETED",f.stateNode=u,f.return=l,u=l.deletions,u===null?(l.deletions=[f],l.flags|=16):u.push(f)}function sI(l,u){switch(l.tag){case 5:var f=l.type;return u=u.nodeType!==1||f.toLowerCase()!==u.nodeName.toLowerCase()?null:u,u!==null?(l.stateNode=u,Ui=l,zi=Uo(u.firstChild),!0):!1;case 6:return u=l.pendingProps===""||u.nodeType!==3?null:u,u!==null?(l.stateNode=u,Ui=l,zi=null,!0):!1;case 13:return u=u.nodeType!==8?null:u,u!==null?(f=gl!==null?{id:Zs,overflow:Qs}:null,l.memoizedState={dehydrated:u,treeContext:f,retryLane:1073741824},f=gr(18,null,null,0),f.stateNode=u,f.return=l,l.child=f,Ui=l,zi=null,!0):!1;default:return!1}}function Ky(l){return(l.mode&1)!==0&&(l.flags&128)===0}function qy(l){if(Dt){var u=zi;if(u){var f=u;if(!sI(l,u)){if(Ky(l))throw Error(t(418));u=Uo(f.nextSibling);var _=Ui;u&&sI(l,u)?rI(_,f):(l.flags=l.flags&-4097|2,Dt=!1,Ui=l)}}else{if(Ky(l))throw Error(t(418));l.flags=l.flags&-4097|2,Dt=!1,Ui=l}}}function oI(l){for(l=l.return;l!==null&&l.tag!==5&&l.tag!==3&&l.tag!==13;)l=l.return;Ui=l}function Rm(l){if(l!==Ui)return!1;if(!Dt)return oI(l),Dt=!0,!1;var u;if((u=l.tag!==3)&&!(u=l.tag!==5)&&(u=l.type,u=u!=="head"&&u!=="body"&&!Fy(l.type,l.memoizedProps)),u&&(u=zi)){if(Ky(l))throw aI(),Error(t(418));for(;u;)rI(l,u),u=Uo(u.nextSibling)}if(oI(l),l.tag===13){if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(t(317));e:{for(l=l.nextSibling,u=0;l;){if(l.nodeType===8){var f=l.data;if(f==="/$"){if(u===0){zi=Uo(l.nextSibling);break e}u--}else f!=="$"&&f!=="$!"&&f!=="$?"||u++}l=l.nextSibling}zi=null}}else zi=Ui?Uo(l.stateNode.nextSibling):null;return!0}function aI(){for(var l=zi;l;)l=Uo(l.nextSibling)}function nu(){zi=Ui=null,Dt=!1}function Hy(l){Lr===null?Lr=[l]:Lr.push(l)}var vO=N.ReactCurrentBatchConfig;function pd(l,u,f){if(l=f.ref,l!==null&&typeof l!="function"&&typeof l!="object"){if(f._owner){if(f=f._owner,f){if(f.tag!==1)throw Error(t(309));var _=f.stateNode}if(!_)throw Error(t(147,l));var E=_,x=""+l;return u!==null&&u.ref!==null&&typeof u.ref=="function"&&u.ref._stringRef===x?u.ref:(u=function(b){var G=E.refs;b===null?delete G[x]:G[x]=b},u._stringRef=x,u)}if(typeof l!="string")throw Error(t(284));if(!f._owner)throw Error(t(290,l))}return l}function Pm(l,u){throw l=Object.prototype.toString.call(u),Error(t(31,l==="[object Object]"?"object with keys {"+Object.keys(u).join(", ")+"}":l))}function lI(l){var u=l._init;return u(l._payload)}function cI(l){function u(H,W){if(l){var Y=H.deletions;Y===null?(H.deletions=[W],H.flags|=16):Y.push(W)}}function f(H,W){if(!l)return null;for(;W!==null;)u(H,W),W=W.sibling;return null}function _(H,W){for(H=new Map;W!==null;)W.key!==null?H.set(W.key,W):H.set(W.index,W),W=W.sibling;return H}function E(H,W){return H=Qo(H,W),H.index=0,H.sibling=null,H}function x(H,W,Y){return H.index=Y,l?(Y=H.alternate,Y!==null?(Y=Y.index,Y<W?(H.flags|=2,W):Y):(H.flags|=2,W)):(H.flags|=1048576,W)}function b(H){return l&&H.alternate===null&&(H.flags|=2),H}function G(H,W,Y,he){return W===null||W.tag!==6?(W=jv(Y,H.mode,he),W.return=H,W):(W=E(W,Y),W.return=H,W)}function B(H,W,Y,he){var Ie=Y.type;return Ie===k?oe(H,W,Y.props.children,he,Y.key):W!==null&&(W.elementType===Ie||typeof Ie=="object"&&Ie!==null&&Ie.$$typeof===ye&&lI(Ie)===W.type)?(he=E(W,Y.props),he.ref=pd(H,W,Y),he.return=H,he):(he=Qm(Y.type,Y.key,Y.props,null,H.mode,he),he.ref=pd(H,W,Y),he.return=H,he)}function Z(H,W,Y,he){return W===null||W.tag!==4||W.stateNode.containerInfo!==Y.containerInfo||W.stateNode.implementation!==Y.implementation?(W=Gv(Y,H.mode,he),W.return=H,W):(W=E(W,Y.children||[]),W.return=H,W)}function oe(H,W,Y,he,Ie){return W===null||W.tag!==7?(W=Sl(Y,H.mode,he,Ie),W.return=H,W):(W=E(W,Y),W.return=H,W)}function le(H,W,Y){if(typeof W=="string"&&W!==""||typeof W=="number")return W=jv(""+W,H.mode,Y),W.return=H,W;if(typeof W=="object"&&W!==null){switch(W.$$typeof){case D:return Y=Qm(W.type,W.key,W.props,null,H.mode,Y),Y.ref=pd(H,null,W),Y.return=H,Y;case z:return W=Gv(W,H.mode,Y),W.return=H,W;case ye:var he=W._init;return le(H,he(W._payload),Y)}if(vt(W)||ae(W))return W=Sl(W,H.mode,Y,null),W.return=H,W;Pm(H,W)}return null}function re(H,W,Y,he){var Ie=W!==null?W.key:null;if(typeof Y=="string"&&Y!==""||typeof Y=="number")return Ie!==null?null:G(H,W,""+Y,he);if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case D:return Y.key===Ie?B(H,W,Y,he):null;case z:return Y.key===Ie?Z(H,W,Y,he):null;case ye:return Ie=Y._init,re(H,W,Ie(Y._payload),he)}if(vt(Y)||ae(Y))return Ie!==null?null:oe(H,W,Y,he,null);Pm(H,Y)}return null}function ve(H,W,Y,he,Ie){if(typeof he=="string"&&he!==""||typeof he=="number")return H=H.get(Y)||null,G(W,H,""+he,Ie);if(typeof he=="object"&&he!==null){switch(he.$$typeof){case D:return H=H.get(he.key===null?Y:he.key)||null,B(W,H,he,Ie);case z:return H=H.get(he.key===null?Y:he.key)||null,Z(W,H,he,Ie);case ye:var Ne=he._init;return ve(H,W,Y,Ne(he._payload),Ie)}if(vt(he)||ae(he))return H=H.get(Y)||null,oe(W,H,he,Ie,null);Pm(W,he)}return null}function xe(H,W,Y,he){for(var Ie=null,Ne=null,De=W,je=W=0,Sn=null;De!==null&&je<Y.length;je++){De.index>je?(Sn=De,De=null):Sn=De.sibling;var ot=re(H,De,Y[je],he);if(ot===null){De===null&&(De=Sn);break}l&&De&&ot.alternate===null&&u(H,De),W=x(ot,W,je),Ne===null?Ie=ot:Ne.sibling=ot,Ne=ot,De=Sn}if(je===Y.length)return f(H,De),Dt&&ml(H,je),Ie;if(De===null){for(;je<Y.length;je++)De=le(H,Y[je],he),De!==null&&(W=x(De,W,je),Ne===null?Ie=De:Ne.sibling=De,Ne=De);return Dt&&ml(H,je),Ie}for(De=_(H,De);je<Y.length;je++)Sn=ve(De,H,je,Y[je],he),Sn!==null&&(l&&Sn.alternate!==null&&De.delete(Sn.key===null?je:Sn.key),W=x(Sn,W,je),Ne===null?Ie=Sn:Ne.sibling=Sn,Ne=Sn);return l&&De.forEach(function(Jo){return u(H,Jo)}),Dt&&ml(H,je),Ie}function Te(H,W,Y,he){var Ie=ae(Y);if(typeof Ie!="function")throw Error(t(150));if(Y=Ie.call(Y),Y==null)throw Error(t(151));for(var Ne=Ie=null,De=W,je=W=0,Sn=null,ot=Y.next();De!==null&&!ot.done;je++,ot=Y.next()){De.index>je?(Sn=De,De=null):Sn=De.sibling;var Jo=re(H,De,ot.value,he);if(Jo===null){De===null&&(De=Sn);break}l&&De&&Jo.alternate===null&&u(H,De),W=x(Jo,W,je),Ne===null?Ie=Jo:Ne.sibling=Jo,Ne=Jo,De=Sn}if(ot.done)return f(H,De),Dt&&ml(H,je),Ie;if(De===null){for(;!ot.done;je++,ot=Y.next())ot=le(H,ot.value,he),ot!==null&&(W=x(ot,W,je),Ne===null?Ie=ot:Ne.sibling=ot,Ne=ot);return Dt&&ml(H,je),Ie}for(De=_(H,De);!ot.done;je++,ot=Y.next())ot=ve(De,H,je,ot.value,he),ot!==null&&(l&&ot.alternate!==null&&De.delete(ot.key===null?je:ot.key),W=x(ot,W,je),Ne===null?Ie=ot:Ne.sibling=ot,Ne=ot);return l&&De.forEach(function(QO){return u(H,QO)}),Dt&&ml(H,je),Ie}function Jt(H,W,Y,he){if(typeof Y=="object"&&Y!==null&&Y.type===k&&Y.key===null&&(Y=Y.props.children),typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case D:e:{for(var Ie=Y.key,Ne=W;Ne!==null;){if(Ne.key===Ie){if(Ie=Y.type,Ie===k){if(Ne.tag===7){f(H,Ne.sibling),W=E(Ne,Y.props.children),W.return=H,H=W;break e}}else if(Ne.elementType===Ie||typeof Ie=="object"&&Ie!==null&&Ie.$$typeof===ye&&lI(Ie)===Ne.type){f(H,Ne.sibling),W=E(Ne,Y.props),W.ref=pd(H,Ne,Y),W.return=H,H=W;break e}f(H,Ne);break}else u(H,Ne);Ne=Ne.sibling}Y.type===k?(W=Sl(Y.props.children,H.mode,he,Y.key),W.return=H,H=W):(he=Qm(Y.type,Y.key,Y.props,null,H.mode,he),he.ref=pd(H,W,Y),he.return=H,H=he)}return b(H);case z:e:{for(Ne=Y.key;W!==null;){if(W.key===Ne)if(W.tag===4&&W.stateNode.containerInfo===Y.containerInfo&&W.stateNode.implementation===Y.implementation){f(H,W.sibling),W=E(W,Y.children||[]),W.return=H,H=W;break e}else{f(H,W);break}else u(H,W);W=W.sibling}W=Gv(Y,H.mode,he),W.return=H,H=W}return b(H);case ye:return Ne=Y._init,Jt(H,W,Ne(Y._payload),he)}if(vt(Y))return xe(H,W,Y,he);if(ae(Y))return Te(H,W,Y,he);Pm(H,Y)}return typeof Y=="string"&&Y!==""||typeof Y=="number"?(Y=""+Y,W!==null&&W.tag===6?(f(H,W.sibling),W=E(W,Y),W.return=H,H=W):(f(H,W),W=jv(Y,H.mode,he),W.return=H,H=W),b(H)):f(H,W)}return Jt}var iu=cI(!0),uI=cI(!1),Cm=zo(null),Mm=null,ru=null,Xy=null;function Yy(){Xy=ru=Mm=null}function Zy(l){var u=Cm.current;bt(Cm),l._currentValue=u}function Qy(l,u,f){for(;l!==null;){var _=l.alternate;if((l.childLanes&u)!==u?(l.childLanes|=u,_!==null&&(_.childLanes|=u)):_!==null&&(_.childLanes&u)!==u&&(_.childLanes|=u),l===f)break;l=l.return}}function su(l,u){Mm=l,Xy=ru=null,l=l.dependencies,l!==null&&l.firstContext!==null&&((l.lanes&u)!==0&&(vi=!0),l.firstContext=null)}function hr(l){var u=l._currentValue;if(Xy!==l)if(l={context:l,memoizedValue:u,next:null},ru===null){if(Mm===null)throw Error(t(308));ru=l,Mm.dependencies={lanes:0,firstContext:l}}else ru=ru.next=l;return u}var pl=null;function Jy(l){pl===null?pl=[l]:pl.push(l)}function hI(l,u,f,_){var E=u.interleaved;return E===null?(f.next=f,Jy(u)):(f.next=E.next,E.next=f),u.interleaved=f,Js(l,_)}function Js(l,u){l.lanes|=u;var f=l.alternate;for(f!==null&&(f.lanes|=u),f=l,l=l.return;l!==null;)l.childLanes|=u,f=l.alternate,f!==null&&(f.childLanes|=u),f=l,l=l.return;return f.tag===3?f.stateNode:null}var Wo=!1;function ev(l){l.updateQueue={baseState:l.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function dI(l,u){l=l.updateQueue,u.updateQueue===l&&(u.updateQueue={baseState:l.baseState,firstBaseUpdate:l.firstBaseUpdate,lastBaseUpdate:l.lastBaseUpdate,shared:l.shared,effects:l.effects})}function eo(l,u){return{eventTime:l,lane:u,tag:0,payload:null,callback:null,next:null}}function Ko(l,u,f){var _=l.updateQueue;if(_===null)return null;if(_=_.shared,(st&2)!==0){var E=_.pending;return E===null?u.next=u:(u.next=E.next,E.next=u),_.pending=u,Js(l,f)}return E=_.interleaved,E===null?(u.next=u,Jy(_)):(u.next=E.next,E.next=u),_.interleaved=u,Js(l,f)}function bm(l,u,f){if(u=u.updateQueue,u!==null&&(u=u.shared,(f&4194240)!==0)){var _=u.lanes;_&=l.pendingLanes,f|=_,u.lanes=f,Zh(l,f)}}function fI(l,u){var f=l.updateQueue,_=l.alternate;if(_!==null&&(_=_.updateQueue,f===_)){var E=null,x=null;if(f=f.firstBaseUpdate,f!==null){do{var b={eventTime:f.eventTime,lane:f.lane,tag:f.tag,payload:f.payload,callback:f.callback,next:null};x===null?E=x=b:x=x.next=b,f=f.next}while(f!==null);x===null?E=x=u:x=x.next=u}else E=x=u;f={baseState:_.baseState,firstBaseUpdate:E,lastBaseUpdate:x,shared:_.shared,effects:_.effects},l.updateQueue=f;return}l=f.lastBaseUpdate,l===null?f.firstBaseUpdate=u:l.next=u,f.lastBaseUpdate=u}function km(l,u,f,_){var E=l.updateQueue;Wo=!1;var x=E.firstBaseUpdate,b=E.lastBaseUpdate,G=E.shared.pending;if(G!==null){E.shared.pending=null;var B=G,Z=B.next;B.next=null,b===null?x=Z:b.next=Z,b=B;var oe=l.alternate;oe!==null&&(oe=oe.updateQueue,G=oe.lastBaseUpdate,G!==b&&(G===null?oe.firstBaseUpdate=Z:G.next=Z,oe.lastBaseUpdate=B))}if(x!==null){var le=E.baseState;b=0,oe=Z=B=null,G=x;do{var re=G.lane,ve=G.eventTime;if((_&re)===re){oe!==null&&(oe=oe.next={eventTime:ve,lane:0,tag:G.tag,payload:G.payload,callback:G.callback,next:null});e:{var xe=l,Te=G;switch(re=u,ve=f,Te.tag){case 1:if(xe=Te.payload,typeof xe=="function"){le=xe.call(ve,le,re);break e}le=xe;break e;case 3:xe.flags=xe.flags&-65537|128;case 0:if(xe=Te.payload,re=typeof xe=="function"?xe.call(ve,le,re):xe,re==null)break e;le=ie({},le,re);break e;case 2:Wo=!0}}G.callback!==null&&G.lane!==0&&(l.flags|=64,re=E.effects,re===null?E.effects=[G]:re.push(G))}else ve={eventTime:ve,lane:re,tag:G.tag,payload:G.payload,callback:G.callback,next:null},oe===null?(Z=oe=ve,B=le):oe=oe.next=ve,b|=re;if(G=G.next,G===null){if(G=E.shared.pending,G===null)break;re=G,G=re.next,re.next=null,E.lastBaseUpdate=re,E.shared.pending=null}}while(!0);if(oe===null&&(B=le),E.baseState=B,E.firstBaseUpdate=Z,E.lastBaseUpdate=oe,u=E.shared.interleaved,u!==null){E=u;do b|=E.lane,E=E.next;while(E!==u)}else x===null&&(E.shared.lanes=0);vl|=b,l.lanes=b,l.memoizedState=le}}function gI(l,u,f){if(l=u.effects,u.effects=null,l!==null)for(u=0;u<l.length;u++){var _=l[u],E=_.callback;if(E!==null){if(_.callback=null,_=f,typeof E!="function")throw Error(t(191,E));E.call(_)}}}var _d={},ps=zo(_d),yd=zo(_d),vd=zo(_d);function _l(l){if(l===_d)throw Error(t(174));return l}function tv(l,u){switch(Pt(vd,u),Pt(yd,l),Pt(ps,_d),l=u.nodeType,l){case 9:case 11:u=(u=u.documentElement)?u.namespaceURI:Pr(null,"");break;default:l=l===8?u.parentNode:u,u=l.namespaceURI||null,l=l.tagName,u=Pr(u,l)}bt(ps),Pt(ps,u)}function ou(){bt(ps),bt(yd),bt(vd)}function mI(l){_l(vd.current);var u=_l(ps.current),f=Pr(u,l.type);u!==f&&(Pt(yd,l),Pt(ps,f))}function nv(l){yd.current===l&&(bt(ps),bt(yd))}var Gt=zo(0);function Lm(l){for(var u=l;u!==null;){if(u.tag===13){var f=u.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||f.data==="$?"||f.data==="$!"))return u}else if(u.tag===19&&u.memoizedProps.revealOrder!==void 0){if((u.flags&128)!==0)return u}else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===l)break;for(;u.sibling===null;){if(u.return===null||u.return===l)return null;u=u.return}u.sibling.return=u.return,u=u.sibling}return null}var iv=[];function rv(){for(var l=0;l<iv.length;l++)iv[l]._workInProgressVersionPrimary=null;iv.length=0}var Nm=N.ReactCurrentDispatcher,sv=N.ReactCurrentBatchConfig,yl=0,Ut=null,hn=null,wn=null,Dm=!1,Ed=!1,wd=0,EO=0;function $n(){throw Error(t(321))}function ov(l,u){if(u===null)return!1;for(var f=0;f<u.length&&f<l.length;f++)if(!kr(l[f],u[f]))return!1;return!0}function av(l,u,f,_,E,x){if(yl=x,Ut=u,u.memoizedState=null,u.updateQueue=null,u.lanes=0,Nm.current=l===null||l.memoizedState===null?TO:IO,l=f(_,E),Ed){x=0;do{if(Ed=!1,wd=0,25<=x)throw Error(t(301));x+=1,wn=hn=null,u.updateQueue=null,Nm.current=AO,l=f(_,E)}while(Ed)}if(Nm.current=Fm,u=hn!==null&&hn.next!==null,yl=0,wn=hn=Ut=null,Dm=!1,u)throw Error(t(300));return l}function lv(){var l=wd!==0;return wd=0,l}function _s(){var l={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return wn===null?Ut.memoizedState=wn=l:wn=wn.next=l,wn}function dr(){if(hn===null){var l=Ut.alternate;l=l!==null?l.memoizedState:null}else l=hn.next;var u=wn===null?Ut.memoizedState:wn.next;if(u!==null)wn=u,hn=l;else{if(l===null)throw Error(t(310));hn=l,l={memoizedState:hn.memoizedState,baseState:hn.baseState,baseQueue:hn.baseQueue,queue:hn.queue,next:null},wn===null?Ut.memoizedState=wn=l:wn=wn.next=l}return wn}function xd(l,u){return typeof u=="function"?u(l):u}function cv(l){var u=dr(),f=u.queue;if(f===null)throw Error(t(311));f.lastRenderedReducer=l;var _=hn,E=_.baseQueue,x=f.pending;if(x!==null){if(E!==null){var b=E.next;E.next=x.next,x.next=b}_.baseQueue=E=x,f.pending=null}if(E!==null){x=E.next,_=_.baseState;var G=b=null,B=null,Z=x;do{var oe=Z.lane;if((yl&oe)===oe)B!==null&&(B=B.next={lane:0,action:Z.action,hasEagerState:Z.hasEagerState,eagerState:Z.eagerState,next:null}),_=Z.hasEagerState?Z.eagerState:l(_,Z.action);else{var le={lane:oe,action:Z.action,hasEagerState:Z.hasEagerState,eagerState:Z.eagerState,next:null};B===null?(G=B=le,b=_):B=B.next=le,Ut.lanes|=oe,vl|=oe}Z=Z.next}while(Z!==null&&Z!==x);B===null?b=_:B.next=G,kr(_,u.memoizedState)||(vi=!0),u.memoizedState=_,u.baseState=b,u.baseQueue=B,f.lastRenderedState=_}if(l=f.interleaved,l!==null){E=l;do x=E.lane,Ut.lanes|=x,vl|=x,E=E.next;while(E!==l)}else E===null&&(f.lanes=0);return[u.memoizedState,f.dispatch]}function uv(l){var u=dr(),f=u.queue;if(f===null)throw Error(t(311));f.lastRenderedReducer=l;var _=f.dispatch,E=f.pending,x=u.memoizedState;if(E!==null){f.pending=null;var b=E=E.next;do x=l(x,b.action),b=b.next;while(b!==E);kr(x,u.memoizedState)||(vi=!0),u.memoizedState=x,u.baseQueue===null&&(u.baseState=x),f.lastRenderedState=x}return[x,_]}function pI(){}function _I(l,u){var f=Ut,_=dr(),E=u(),x=!kr(_.memoizedState,E);if(x&&(_.memoizedState=E,vi=!0),_=_.queue,hv(EI.bind(null,f,_,l),[l]),_.getSnapshot!==u||x||wn!==null&&wn.memoizedState.tag&1){if(f.flags|=2048,Sd(9,vI.bind(null,f,_,E,u),void 0,null),xn===null)throw Error(t(349));(yl&30)!==0||yI(f,u,E)}return E}function yI(l,u,f){l.flags|=16384,l={getSnapshot:u,value:f},u=Ut.updateQueue,u===null?(u={lastEffect:null,stores:null},Ut.updateQueue=u,u.stores=[l]):(f=u.stores,f===null?u.stores=[l]:f.push(l))}function vI(l,u,f,_){u.value=f,u.getSnapshot=_,wI(u)&&xI(l)}function EI(l,u,f){return f(function(){wI(u)&&xI(l)})}function wI(l){var u=l.getSnapshot;l=l.value;try{var f=u();return!kr(l,f)}catch{return!0}}function xI(l){var u=Js(l,1);u!==null&&Vr(u,l,1,-1)}function SI(l){var u=_s();return typeof l=="function"&&(l=l()),u.memoizedState=u.baseState=l,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:xd,lastRenderedState:l},u.queue=l,l=l.dispatch=SO.bind(null,Ut,l),[u.memoizedState,l]}function Sd(l,u,f,_){return l={tag:l,create:u,destroy:f,deps:_,next:null},u=Ut.updateQueue,u===null?(u={lastEffect:null,stores:null},Ut.updateQueue=u,u.lastEffect=l.next=l):(f=u.lastEffect,f===null?u.lastEffect=l.next=l:(_=f.next,f.next=l,l.next=_,u.lastEffect=l)),l}function TI(){return dr().memoizedState}function Om(l,u,f,_){var E=_s();Ut.flags|=l,E.memoizedState=Sd(1|u,f,void 0,_===void 0?null:_)}function Vm(l,u,f,_){var E=dr();_=_===void 0?null:_;var x=void 0;if(hn!==null){var b=hn.memoizedState;if(x=b.destroy,_!==null&&ov(_,b.deps)){E.memoizedState=Sd(u,f,x,_);return}}Ut.flags|=l,E.memoizedState=Sd(1|u,f,x,_)}function II(l,u){return Om(8390656,8,l,u)}function hv(l,u){return Vm(2048,8,l,u)}function AI(l,u){return Vm(4,2,l,u)}function RI(l,u){return Vm(4,4,l,u)}function PI(l,u){if(typeof u=="function")return l=l(),u(l),function(){u(null)};if(u!=null)return l=l(),u.current=l,function(){u.current=null}}function CI(l,u,f){return f=f!=null?f.concat([l]):null,Vm(4,4,PI.bind(null,u,l),f)}function dv(){}function MI(l,u){var f=dr();u=u===void 0?null:u;var _=f.memoizedState;return _!==null&&u!==null&&ov(u,_[1])?_[0]:(f.memoizedState=[l,u],l)}function bI(l,u){var f=dr();u=u===void 0?null:u;var _=f.memoizedState;return _!==null&&u!==null&&ov(u,_[1])?_[0]:(l=l(),f.memoizedState=[l,u],l)}function kI(l,u,f){return(yl&21)===0?(l.baseState&&(l.baseState=!1,vi=!0),l.memoizedState=f):(kr(f,u)||(f=Xh(),Ut.lanes|=f,vl|=f,l.baseState=!0),u)}function wO(l,u){var f=nt;nt=f!==0&&4>f?f:4,l(!0);var _=sv.transition;sv.transition={};try{l(!1),u()}finally{nt=f,sv.transition=_}}function LI(){return dr().memoizedState}function xO(l,u,f){var _=Yo(l);if(f={lane:_,action:f,hasEagerState:!1,eagerState:null,next:null},NI(l))DI(u,f);else if(f=hI(l,u,f,_),f!==null){var E=li();Vr(f,l,_,E),OI(f,u,_)}}function SO(l,u,f){var _=Yo(l),E={lane:_,action:f,hasEagerState:!1,eagerState:null,next:null};if(NI(l))DI(u,E);else{var x=l.alternate;if(l.lanes===0&&(x===null||x.lanes===0)&&(x=u.lastRenderedReducer,x!==null))try{var b=u.lastRenderedState,G=x(b,f);if(E.hasEagerState=!0,E.eagerState=G,kr(G,b)){var B=u.interleaved;B===null?(E.next=E,Jy(u)):(E.next=B.next,B.next=E),u.interleaved=E;return}}catch{}f=hI(l,u,E,_),f!==null&&(E=li(),Vr(f,l,_,E),OI(f,u,_))}}function NI(l){var u=l.alternate;return l===Ut||u!==null&&u===Ut}function DI(l,u){Ed=Dm=!0;var f=l.pending;f===null?u.next=u:(u.next=f.next,f.next=u),l.pending=u}function OI(l,u,f){if((f&4194240)!==0){var _=u.lanes;_&=l.pendingLanes,f|=_,u.lanes=f,Zh(l,f)}}var Fm={readContext:hr,useCallback:$n,useContext:$n,useEffect:$n,useImperativeHandle:$n,useInsertionEffect:$n,useLayoutEffect:$n,useMemo:$n,useReducer:$n,useRef:$n,useState:$n,useDebugValue:$n,useDeferredValue:$n,useTransition:$n,useMutableSource:$n,useSyncExternalStore:$n,useId:$n,unstable_isNewReconciler:!1},TO={readContext:hr,useCallback:function(l,u){return _s().memoizedState=[l,u===void 0?null:u],l},useContext:hr,useEffect:II,useImperativeHandle:function(l,u,f){return f=f!=null?f.concat([l]):null,Om(4194308,4,PI.bind(null,u,l),f)},useLayoutEffect:function(l,u){return Om(4194308,4,l,u)},useInsertionEffect:function(l,u){return Om(4,2,l,u)},useMemo:function(l,u){var f=_s();return u=u===void 0?null:u,l=l(),f.memoizedState=[l,u],l},useReducer:function(l,u,f){var _=_s();return u=f!==void 0?f(u):u,_.memoizedState=_.baseState=u,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:l,lastRenderedState:u},_.queue=l,l=l.dispatch=xO.bind(null,Ut,l),[_.memoizedState,l]},useRef:function(l){var u=_s();return l={current:l},u.memoizedState=l},useState:SI,useDebugValue:dv,useDeferredValue:function(l){return _s().memoizedState=l},useTransition:function(){var l=SI(!1),u=l[0];return l=wO.bind(null,l[1]),_s().memoizedState=l,[u,l]},useMutableSource:function(){},useSyncExternalStore:function(l,u,f){var _=Ut,E=_s();if(Dt){if(f===void 0)throw Error(t(407));f=f()}else{if(f=u(),xn===null)throw Error(t(349));(yl&30)!==0||yI(_,u,f)}E.memoizedState=f;var x={value:f,getSnapshot:u};return E.queue=x,II(EI.bind(null,_,x,l),[l]),_.flags|=2048,Sd(9,vI.bind(null,_,x,f,u),void 0,null),f},useId:function(){var l=_s(),u=xn.identifierPrefix;if(Dt){var f=Qs,_=Zs;f=(_&~(1<<32-Oi(_)-1)).toString(32)+f,u=":"+u+"R"+f,f=wd++,0<f&&(u+="H"+f.toString(32)),u+=":"}else f=EO++,u=":"+u+"r"+f.toString(32)+":";return l.memoizedState=u},unstable_isNewReconciler:!1},IO={readContext:hr,useCallback:MI,useContext:hr,useEffect:hv,useImperativeHandle:CI,useInsertionEffect:AI,useLayoutEffect:RI,useMemo:bI,useReducer:cv,useRef:TI,useState:function(){return cv(xd)},useDebugValue:dv,useDeferredValue:function(l){var u=dr();return kI(u,hn.memoizedState,l)},useTransition:function(){var l=cv(xd)[0],u=dr().memoizedState;return[l,u]},useMutableSource:pI,useSyncExternalStore:_I,useId:LI,unstable_isNewReconciler:!1},AO={readContext:hr,useCallback:MI,useContext:hr,useEffect:hv,useImperativeHandle:CI,useInsertionEffect:AI,useLayoutEffect:RI,useMemo:bI,useReducer:uv,useRef:TI,useState:function(){return uv(xd)},useDebugValue:dv,useDeferredValue:function(l){var u=dr();return hn===null?u.memoizedState=l:kI(u,hn.memoizedState,l)},useTransition:function(){var l=uv(xd)[0],u=dr().memoizedState;return[l,u]},useMutableSource:pI,useSyncExternalStore:_I,useId:LI,unstable_isNewReconciler:!1};function Nr(l,u){if(l&&l.defaultProps){u=ie({},u),l=l.defaultProps;for(var f in l)u[f]===void 0&&(u[f]=l[f]);return u}return u}function fv(l,u,f,_){u=l.memoizedState,f=f(_,u),f=f==null?u:ie({},u,f),l.memoizedState=f,l.lanes===0&&(l.updateQueue.baseState=f)}var jm={isMounted:function(l){return(l=l._reactInternals)?Mr(l)===l:!1},enqueueSetState:function(l,u,f){l=l._reactInternals;var _=li(),E=Yo(l),x=eo(_,E);x.payload=u,f!=null&&(x.callback=f),u=Ko(l,x,E),u!==null&&(Vr(u,l,E,_),bm(u,l,E))},enqueueReplaceState:function(l,u,f){l=l._reactInternals;var _=li(),E=Yo(l),x=eo(_,E);x.tag=1,x.payload=u,f!=null&&(x.callback=f),u=Ko(l,x,E),u!==null&&(Vr(u,l,E,_),bm(u,l,E))},enqueueForceUpdate:function(l,u){l=l._reactInternals;var f=li(),_=Yo(l),E=eo(f,_);E.tag=2,u!=null&&(E.callback=u),u=Ko(l,E,_),u!==null&&(Vr(u,l,_,f),bm(u,l,_))}};function VI(l,u,f,_,E,x,b){return l=l.stateNode,typeof l.shouldComponentUpdate=="function"?l.shouldComponentUpdate(_,x,b):u.prototype&&u.prototype.isPureReactComponent?!cd(f,_)||!cd(E,x):!0}function FI(l,u,f){var _=!1,E=Bo,x=u.contextType;return typeof x=="object"&&x!==null?x=hr(x):(E=yi(u)?fl:Bn.current,_=u.contextTypes,x=(_=_!=null)?Jc(l,E):Bo),u=new u(f,x),l.memoizedState=u.state!==null&&u.state!==void 0?u.state:null,u.updater=jm,l.stateNode=u,u._reactInternals=l,_&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=E,l.__reactInternalMemoizedMaskedChildContext=x),u}function jI(l,u,f,_){l=u.state,typeof u.componentWillReceiveProps=="function"&&u.componentWillReceiveProps(f,_),typeof u.UNSAFE_componentWillReceiveProps=="function"&&u.UNSAFE_componentWillReceiveProps(f,_),u.state!==l&&jm.enqueueReplaceState(u,u.state,null)}function gv(l,u,f,_){var E=l.stateNode;E.props=f,E.state=l.memoizedState,E.refs={},ev(l);var x=u.contextType;typeof x=="object"&&x!==null?E.context=hr(x):(x=yi(u)?fl:Bn.current,E.context=Jc(l,x)),E.state=l.memoizedState,x=u.getDerivedStateFromProps,typeof x=="function"&&(fv(l,u,x,f),E.state=l.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof E.getSnapshotBeforeUpdate=="function"||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(u=E.state,typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount(),u!==E.state&&jm.enqueueReplaceState(E,E.state,null),km(l,f,E,_),E.state=l.memoizedState),typeof E.componentDidMount=="function"&&(l.flags|=4194308)}function au(l,u){try{var f="",_=u;do f+=Pe(_),_=_.return;while(_);var E=f}catch(x){E=`
Error generating stack: `+x.message+`
`+x.stack}return{value:l,source:u,stack:E,digest:null}}function mv(l,u,f){return{value:l,source:null,stack:f??null,digest:u??null}}function pv(l,u){try{console.error(u.value)}catch(f){setTimeout(function(){throw f})}}var RO=typeof WeakMap=="function"?WeakMap:Map;function GI(l,u,f){f=eo(-1,f),f.tag=3,f.payload={element:null};var _=u.value;return f.callback=function(){Km||(Km=!0,bv=_),pv(l,u)},f}function UI(l,u,f){f=eo(-1,f),f.tag=3;var _=l.type.getDerivedStateFromError;if(typeof _=="function"){var E=u.value;f.payload=function(){return _(E)},f.callback=function(){pv(l,u)}}var x=l.stateNode;return x!==null&&typeof x.componentDidCatch=="function"&&(f.callback=function(){pv(l,u),typeof _!="function"&&(Ho===null?Ho=new Set([this]):Ho.add(this));var b=u.stack;this.componentDidCatch(u.value,{componentStack:b!==null?b:""})}),f}function zI(l,u,f){var _=l.pingCache;if(_===null){_=l.pingCache=new RO;var E=new Set;_.set(u,E)}else E=_.get(u),E===void 0&&(E=new Set,_.set(u,E));E.has(f)||(E.add(f),l=UO.bind(null,l,u,f),u.then(l,l))}function BI(l){do{var u;if((u=l.tag===13)&&(u=l.memoizedState,u=u!==null?u.dehydrated!==null:!0),u)return l;l=l.return}while(l!==null);return null}function $I(l,u,f,_,E){return(l.mode&1)===0?(l===u?l.flags|=65536:(l.flags|=128,f.flags|=131072,f.flags&=-52805,f.tag===1&&(f.alternate===null?f.tag=17:(u=eo(-1,1),u.tag=2,Ko(f,u,1))),f.lanes|=1),l):(l.flags|=65536,l.lanes=E,l)}var PO=N.ReactCurrentOwner,vi=!1;function ai(l,u,f,_){u.child=l===null?uI(u,null,f,_):iu(u,l.child,f,_)}function WI(l,u,f,_,E){f=f.render;var x=u.ref;return su(u,E),_=av(l,u,f,_,x,E),f=lv(),l!==null&&!vi?(u.updateQueue=l.updateQueue,u.flags&=-2053,l.lanes&=~E,to(l,u,E)):(Dt&&f&&$y(u),u.flags|=1,ai(l,u,_,E),u.child)}function KI(l,u,f,_,E){if(l===null){var x=f.type;return typeof x=="function"&&!Fv(x)&&x.defaultProps===void 0&&f.compare===null&&f.defaultProps===void 0?(u.tag=15,u.type=x,qI(l,u,x,_,E)):(l=Qm(f.type,null,_,u,u.mode,E),l.ref=u.ref,l.return=u,u.child=l)}if(x=l.child,(l.lanes&E)===0){var b=x.memoizedProps;if(f=f.compare,f=f!==null?f:cd,f(b,_)&&l.ref===u.ref)return to(l,u,E)}return u.flags|=1,l=Qo(x,_),l.ref=u.ref,l.return=u,u.child=l}function qI(l,u,f,_,E){if(l!==null){var x=l.memoizedProps;if(cd(x,_)&&l.ref===u.ref)if(vi=!1,u.pendingProps=_=x,(l.lanes&E)!==0)(l.flags&131072)!==0&&(vi=!0);else return u.lanes=l.lanes,to(l,u,E)}return _v(l,u,f,_,E)}function HI(l,u,f){var _=u.pendingProps,E=_.children,x=l!==null?l.memoizedState:null;if(_.mode==="hidden")if((u.mode&1)===0)u.memoizedState={baseLanes:0,cachePool:null,transitions:null},Pt(cu,Bi),Bi|=f;else{if((f&1073741824)===0)return l=x!==null?x.baseLanes|f:f,u.lanes=u.childLanes=1073741824,u.memoizedState={baseLanes:l,cachePool:null,transitions:null},u.updateQueue=null,Pt(cu,Bi),Bi|=l,null;u.memoizedState={baseLanes:0,cachePool:null,transitions:null},_=x!==null?x.baseLanes:f,Pt(cu,Bi),Bi|=_}else x!==null?(_=x.baseLanes|f,u.memoizedState=null):_=f,Pt(cu,Bi),Bi|=_;return ai(l,u,E,f),u.child}function XI(l,u){var f=u.ref;(l===null&&f!==null||l!==null&&l.ref!==f)&&(u.flags|=512,u.flags|=2097152)}function _v(l,u,f,_,E){var x=yi(f)?fl:Bn.current;return x=Jc(u,x),su(u,E),f=av(l,u,f,_,x,E),_=lv(),l!==null&&!vi?(u.updateQueue=l.updateQueue,u.flags&=-2053,l.lanes&=~E,to(l,u,E)):(Dt&&_&&$y(u),u.flags|=1,ai(l,u,f,E),u.child)}function YI(l,u,f,_,E){if(yi(f)){var x=!0;Sm(u)}else x=!1;if(su(u,E),u.stateNode===null)Um(l,u),FI(u,f,_),gv(u,f,_,E),_=!0;else if(l===null){var b=u.stateNode,G=u.memoizedProps;b.props=G;var B=b.context,Z=f.contextType;typeof Z=="object"&&Z!==null?Z=hr(Z):(Z=yi(f)?fl:Bn.current,Z=Jc(u,Z));var oe=f.getDerivedStateFromProps,le=typeof oe=="function"||typeof b.getSnapshotBeforeUpdate=="function";le||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(G!==_||B!==Z)&&jI(u,b,_,Z),Wo=!1;var re=u.memoizedState;b.state=re,km(u,_,b,E),B=u.memoizedState,G!==_||re!==B||_i.current||Wo?(typeof oe=="function"&&(fv(u,f,oe,_),B=u.memoizedState),(G=Wo||VI(u,f,G,_,re,B,Z))?(le||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount()),typeof b.componentDidMount=="function"&&(u.flags|=4194308)):(typeof b.componentDidMount=="function"&&(u.flags|=4194308),u.memoizedProps=_,u.memoizedState=B),b.props=_,b.state=B,b.context=Z,_=G):(typeof b.componentDidMount=="function"&&(u.flags|=4194308),_=!1)}else{b=u.stateNode,dI(l,u),G=u.memoizedProps,Z=u.type===u.elementType?G:Nr(u.type,G),b.props=Z,le=u.pendingProps,re=b.context,B=f.contextType,typeof B=="object"&&B!==null?B=hr(B):(B=yi(f)?fl:Bn.current,B=Jc(u,B));var ve=f.getDerivedStateFromProps;(oe=typeof ve=="function"||typeof b.getSnapshotBeforeUpdate=="function")||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(G!==le||re!==B)&&jI(u,b,_,B),Wo=!1,re=u.memoizedState,b.state=re,km(u,_,b,E);var xe=u.memoizedState;G!==le||re!==xe||_i.current||Wo?(typeof ve=="function"&&(fv(u,f,ve,_),xe=u.memoizedState),(Z=Wo||VI(u,f,Z,_,re,xe,B)||!1)?(oe||typeof b.UNSAFE_componentWillUpdate!="function"&&typeof b.componentWillUpdate!="function"||(typeof b.componentWillUpdate=="function"&&b.componentWillUpdate(_,xe,B),typeof b.UNSAFE_componentWillUpdate=="function"&&b.UNSAFE_componentWillUpdate(_,xe,B)),typeof b.componentDidUpdate=="function"&&(u.flags|=4),typeof b.getSnapshotBeforeUpdate=="function"&&(u.flags|=1024)):(typeof b.componentDidUpdate!="function"||G===l.memoizedProps&&re===l.memoizedState||(u.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||G===l.memoizedProps&&re===l.memoizedState||(u.flags|=1024),u.memoizedProps=_,u.memoizedState=xe),b.props=_,b.state=xe,b.context=B,_=Z):(typeof b.componentDidUpdate!="function"||G===l.memoizedProps&&re===l.memoizedState||(u.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||G===l.memoizedProps&&re===l.memoizedState||(u.flags|=1024),_=!1)}return yv(l,u,f,_,x,E)}function yv(l,u,f,_,E,x){XI(l,u);var b=(u.flags&128)!==0;if(!_&&!b)return E&&tI(u,f,!1),to(l,u,x);_=u.stateNode,PO.current=u;var G=b&&typeof f.getDerivedStateFromError!="function"?null:_.render();return u.flags|=1,l!==null&&b?(u.child=iu(u,l.child,null,x),u.child=iu(u,null,G,x)):ai(l,u,G,x),u.memoizedState=_.state,E&&tI(u,f,!0),u.child}function ZI(l){var u=l.stateNode;u.pendingContext?JT(l,u.pendingContext,u.pendingContext!==u.context):u.context&&JT(l,u.context,!1),tv(l,u.containerInfo)}function QI(l,u,f,_,E){return nu(),Hy(E),u.flags|=256,ai(l,u,f,_),u.child}var vv={dehydrated:null,treeContext:null,retryLane:0};function Ev(l){return{baseLanes:l,cachePool:null,transitions:null}}function JI(l,u,f){var _=u.pendingProps,E=Gt.current,x=!1,b=(u.flags&128)!==0,G;if((G=b)||(G=l!==null&&l.memoizedState===null?!1:(E&2)!==0),G?(x=!0,u.flags&=-129):(l===null||l.memoizedState!==null)&&(E|=1),Pt(Gt,E&1),l===null)return qy(u),l=u.memoizedState,l!==null&&(l=l.dehydrated,l!==null)?((u.mode&1)===0?u.lanes=1:l.data==="$!"?u.lanes=8:u.lanes=1073741824,null):(b=_.children,l=_.fallback,x?(_=u.mode,x=u.child,b={mode:"hidden",children:b},(_&1)===0&&x!==null?(x.childLanes=0,x.pendingProps=b):x=Jm(b,_,0,null),l=Sl(l,_,f,null),x.return=u,l.return=u,x.sibling=l,u.child=x,u.child.memoizedState=Ev(f),u.memoizedState=vv,l):wv(u,b));if(E=l.memoizedState,E!==null&&(G=E.dehydrated,G!==null))return CO(l,u,b,_,G,E,f);if(x){x=_.fallback,b=u.mode,E=l.child,G=E.sibling;var B={mode:"hidden",children:_.children};return(b&1)===0&&u.child!==E?(_=u.child,_.childLanes=0,_.pendingProps=B,u.deletions=null):(_=Qo(E,B),_.subtreeFlags=E.subtreeFlags&14680064),G!==null?x=Qo(G,x):(x=Sl(x,b,f,null),x.flags|=2),x.return=u,_.return=u,_.sibling=x,u.child=_,_=x,x=u.child,b=l.child.memoizedState,b=b===null?Ev(f):{baseLanes:b.baseLanes|f,cachePool:null,transitions:b.transitions},x.memoizedState=b,x.childLanes=l.childLanes&~f,u.memoizedState=vv,_}return x=l.child,l=x.sibling,_=Qo(x,{mode:"visible",children:_.children}),(u.mode&1)===0&&(_.lanes=f),_.return=u,_.sibling=null,l!==null&&(f=u.deletions,f===null?(u.deletions=[l],u.flags|=16):f.push(l)),u.child=_,u.memoizedState=null,_}function wv(l,u){return u=Jm({mode:"visible",children:u},l.mode,0,null),u.return=l,l.child=u}function Gm(l,u,f,_){return _!==null&&Hy(_),iu(u,l.child,null,f),l=wv(u,u.pendingProps.children),l.flags|=2,u.memoizedState=null,l}function CO(l,u,f,_,E,x,b){if(f)return u.flags&256?(u.flags&=-257,_=mv(Error(t(422))),Gm(l,u,b,_)):u.memoizedState!==null?(u.child=l.child,u.flags|=128,null):(x=_.fallback,E=u.mode,_=Jm({mode:"visible",children:_.children},E,0,null),x=Sl(x,E,b,null),x.flags|=2,_.return=u,x.return=u,_.sibling=x,u.child=_,(u.mode&1)!==0&&iu(u,l.child,null,b),u.child.memoizedState=Ev(b),u.memoizedState=vv,x);if((u.mode&1)===0)return Gm(l,u,b,null);if(E.data==="$!"){if(_=E.nextSibling&&E.nextSibling.dataset,_)var G=_.dgst;return _=G,x=Error(t(419)),_=mv(x,_,void 0),Gm(l,u,b,_)}if(G=(b&l.childLanes)!==0,vi||G){if(_=xn,_!==null){switch(b&-b){case 4:E=2;break;case 16:E=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:E=32;break;case 536870912:E=268435456;break;default:E=0}E=(E&(_.suspendedLanes|b))!==0?0:E,E!==0&&E!==x.retryLane&&(x.retryLane=E,Js(l,E),Vr(_,l,E,-1))}return Vv(),_=mv(Error(t(421))),Gm(l,u,b,_)}return E.data==="$?"?(u.flags|=128,u.child=l.child,u=zO.bind(null,l),E._reactRetry=u,null):(l=x.treeContext,zi=Uo(E.nextSibling),Ui=u,Dt=!0,Lr=null,l!==null&&(cr[ur++]=Zs,cr[ur++]=Qs,cr[ur++]=gl,Zs=l.id,Qs=l.overflow,gl=u),u=wv(u,_.children),u.flags|=4096,u)}function e2(l,u,f){l.lanes|=u;var _=l.alternate;_!==null&&(_.lanes|=u),Qy(l.return,u,f)}function xv(l,u,f,_,E){var x=l.memoizedState;x===null?l.memoizedState={isBackwards:u,rendering:null,renderingStartTime:0,last:_,tail:f,tailMode:E}:(x.isBackwards=u,x.rendering=null,x.renderingStartTime=0,x.last=_,x.tail=f,x.tailMode=E)}function t2(l,u,f){var _=u.pendingProps,E=_.revealOrder,x=_.tail;if(ai(l,u,_.children,f),_=Gt.current,(_&2)!==0)_=_&1|2,u.flags|=128;else{if(l!==null&&(l.flags&128)!==0)e:for(l=u.child;l!==null;){if(l.tag===13)l.memoizedState!==null&&e2(l,f,u);else if(l.tag===19)e2(l,f,u);else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===u)break e;for(;l.sibling===null;){if(l.return===null||l.return===u)break e;l=l.return}l.sibling.return=l.return,l=l.sibling}_&=1}if(Pt(Gt,_),(u.mode&1)===0)u.memoizedState=null;else switch(E){case"forwards":for(f=u.child,E=null;f!==null;)l=f.alternate,l!==null&&Lm(l)===null&&(E=f),f=f.sibling;f=E,f===null?(E=u.child,u.child=null):(E=f.sibling,f.sibling=null),xv(u,!1,E,f,x);break;case"backwards":for(f=null,E=u.child,u.child=null;E!==null;){if(l=E.alternate,l!==null&&Lm(l)===null){u.child=E;break}l=E.sibling,E.sibling=f,f=E,E=l}xv(u,!0,f,null,x);break;case"together":xv(u,!1,null,null,void 0);break;default:u.memoizedState=null}return u.child}function Um(l,u){(u.mode&1)===0&&l!==null&&(l.alternate=null,u.alternate=null,u.flags|=2)}function to(l,u,f){if(l!==null&&(u.dependencies=l.dependencies),vl|=u.lanes,(f&u.childLanes)===0)return null;if(l!==null&&u.child!==l.child)throw Error(t(153));if(u.child!==null){for(l=u.child,f=Qo(l,l.pendingProps),u.child=f,f.return=u;l.sibling!==null;)l=l.sibling,f=f.sibling=Qo(l,l.pendingProps),f.return=u;f.sibling=null}return u.child}function MO(l,u,f){switch(u.tag){case 3:ZI(u),nu();break;case 5:mI(u);break;case 1:yi(u.type)&&Sm(u);break;case 4:tv(u,u.stateNode.containerInfo);break;case 10:var _=u.type._context,E=u.memoizedProps.value;Pt(Cm,_._currentValue),_._currentValue=E;break;case 13:if(_=u.memoizedState,_!==null)return _.dehydrated!==null?(Pt(Gt,Gt.current&1),u.flags|=128,null):(f&u.child.childLanes)!==0?JI(l,u,f):(Pt(Gt,Gt.current&1),l=to(l,u,f),l!==null?l.sibling:null);Pt(Gt,Gt.current&1);break;case 19:if(_=(f&u.childLanes)!==0,(l.flags&128)!==0){if(_)return t2(l,u,f);u.flags|=128}if(E=u.memoizedState,E!==null&&(E.rendering=null,E.tail=null,E.lastEffect=null),Pt(Gt,Gt.current),_)break;return null;case 22:case 23:return u.lanes=0,HI(l,u,f)}return to(l,u,f)}var n2,Sv,i2,r2;n2=function(l,u){for(var f=u.child;f!==null;){if(f.tag===5||f.tag===6)l.appendChild(f.stateNode);else if(f.tag!==4&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===u)break;for(;f.sibling===null;){if(f.return===null||f.return===u)return;f=f.return}f.sibling.return=f.return,f=f.sibling}},Sv=function(){},i2=function(l,u,f,_){var E=l.memoizedProps;if(E!==_){l=u.stateNode,_l(ps.current);var x=null;switch(f){case"input":E=mi(l,E),_=mi(l,_),x=[];break;case"select":E=ie({},E,{value:void 0}),_=ie({},_,{value:void 0}),x=[];break;case"textarea":E=nr(l,E),_=nr(l,_),x=[];break;default:typeof E.onClick!="function"&&typeof _.onClick=="function"&&(l.onclick=Em)}ri(f,_);var b;f=null;for(Z in E)if(!_.hasOwnProperty(Z)&&E.hasOwnProperty(Z)&&E[Z]!=null)if(Z==="style"){var G=E[Z];for(b in G)G.hasOwnProperty(b)&&(f||(f={}),f[b]="")}else Z!=="dangerouslySetInnerHTML"&&Z!=="children"&&Z!=="suppressContentEditableWarning"&&Z!=="suppressHydrationWarning"&&Z!=="autoFocus"&&(r.hasOwnProperty(Z)?x||(x=[]):(x=x||[]).push(Z,null));for(Z in _){var B=_[Z];if(G=E?.[Z],_.hasOwnProperty(Z)&&B!==G&&(B!=null||G!=null))if(Z==="style")if(G){for(b in G)!G.hasOwnProperty(b)||B&&B.hasOwnProperty(b)||(f||(f={}),f[b]="");for(b in B)B.hasOwnProperty(b)&&G[b]!==B[b]&&(f||(f={}),f[b]=B[b])}else f||(x||(x=[]),x.push(Z,f)),f=B;else Z==="dangerouslySetInnerHTML"?(B=B?B.__html:void 0,G=G?G.__html:void 0,B!=null&&G!==B&&(x=x||[]).push(Z,B)):Z==="children"?typeof B!="string"&&typeof B!="number"||(x=x||[]).push(Z,""+B):Z!=="suppressContentEditableWarning"&&Z!=="suppressHydrationWarning"&&(r.hasOwnProperty(Z)?(B!=null&&Z==="onScroll"&&Mt("scroll",l),x||G===B||(x=[])):(x=x||[]).push(Z,B))}f&&(x=x||[]).push("style",f);var Z=x;(u.updateQueue=Z)&&(u.flags|=4)}},r2=function(l,u,f,_){f!==_&&(u.flags|=4)};function Td(l,u){if(!Dt)switch(l.tailMode){case"hidden":u=l.tail;for(var f=null;u!==null;)u.alternate!==null&&(f=u),u=u.sibling;f===null?l.tail=null:f.sibling=null;break;case"collapsed":f=l.tail;for(var _=null;f!==null;)f.alternate!==null&&(_=f),f=f.sibling;_===null?u||l.tail===null?l.tail=null:l.tail.sibling=null:_.sibling=null}}function Wn(l){var u=l.alternate!==null&&l.alternate.child===l.child,f=0,_=0;if(u)for(var E=l.child;E!==null;)f|=E.lanes|E.childLanes,_|=E.subtreeFlags&14680064,_|=E.flags&14680064,E.return=l,E=E.sibling;else for(E=l.child;E!==null;)f|=E.lanes|E.childLanes,_|=E.subtreeFlags,_|=E.flags,E.return=l,E=E.sibling;return l.subtreeFlags|=_,l.childLanes=f,u}function bO(l,u,f){var _=u.pendingProps;switch(Wy(u),u.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Wn(u),null;case 1:return yi(u.type)&&xm(),Wn(u),null;case 3:return _=u.stateNode,ou(),bt(_i),bt(Bn),rv(),_.pendingContext&&(_.context=_.pendingContext,_.pendingContext=null),(l===null||l.child===null)&&(Rm(u)?u.flags|=4:l===null||l.memoizedState.isDehydrated&&(u.flags&256)===0||(u.flags|=1024,Lr!==null&&(Nv(Lr),Lr=null))),Sv(l,u),Wn(u),null;case 5:nv(u);var E=_l(vd.current);if(f=u.type,l!==null&&u.stateNode!=null)i2(l,u,f,_,E),l.ref!==u.ref&&(u.flags|=512,u.flags|=2097152);else{if(!_){if(u.stateNode===null)throw Error(t(166));return Wn(u),null}if(l=_l(ps.current),Rm(u)){_=u.stateNode,f=u.type;var x=u.memoizedProps;switch(_[ms]=u,_[gd]=x,l=(u.mode&1)!==0,f){case"dialog":Mt("cancel",_),Mt("close",_);break;case"iframe":case"object":case"embed":Mt("load",_);break;case"video":case"audio":for(E=0;E<hd.length;E++)Mt(hd[E],_);break;case"source":Mt("error",_);break;case"img":case"image":case"link":Mt("error",_),Mt("load",_);break;case"details":Mt("toggle",_);break;case"input":Rn(_,x),Mt("invalid",_);break;case"select":_._wrapperState={wasMultiple:!!x.multiple},Mt("invalid",_);break;case"textarea":Nt(_,x),Mt("invalid",_)}ri(f,x),E=null;for(var b in x)if(x.hasOwnProperty(b)){var G=x[b];b==="children"?typeof G=="string"?_.textContent!==G&&(x.suppressHydrationWarning!==!0&&vm(_.textContent,G,l),E=["children",G]):typeof G=="number"&&_.textContent!==""+G&&(x.suppressHydrationWarning!==!0&&vm(_.textContent,G,l),E=["children",""+G]):r.hasOwnProperty(b)&&G!=null&&b==="onScroll"&&Mt("scroll",_)}switch(f){case"input":Rr(_),tr(_,x,!0);break;case"textarea":Rr(_),ir(_);break;case"select":case"option":break;default:typeof x.onClick=="function"&&(_.onclick=Em)}_=E,u.updateQueue=_,_!==null&&(u.flags|=4)}else{b=E.nodeType===9?E:E.ownerDocument,l==="http://www.w3.org/1999/xhtml"&&(l=Zr(f)),l==="http://www.w3.org/1999/xhtml"?f==="script"?(l=b.createElement("div"),l.innerHTML="<script><\/script>",l=l.removeChild(l.firstChild)):typeof _.is=="string"?l=b.createElement(f,{is:_.is}):(l=b.createElement(f),f==="select"&&(b=l,_.multiple?b.multiple=!0:_.size&&(b.size=_.size))):l=b.createElementNS(l,f),l[ms]=u,l[gd]=_,n2(l,u,!1,!1),u.stateNode=l;e:{switch(b=Us(f,_),f){case"dialog":Mt("cancel",l),Mt("close",l),E=_;break;case"iframe":case"object":case"embed":Mt("load",l),E=_;break;case"video":case"audio":for(E=0;E<hd.length;E++)Mt(hd[E],l);E=_;break;case"source":Mt("error",l),E=_;break;case"img":case"image":case"link":Mt("error",l),Mt("load",l),E=_;break;case"details":Mt("toggle",l),E=_;break;case"input":Rn(l,_),E=mi(l,_),Mt("invalid",l);break;case"option":E=_;break;case"select":l._wrapperState={wasMultiple:!!_.multiple},E=ie({},_,{value:void 0}),Mt("invalid",l);break;case"textarea":Nt(l,_),E=nr(l,_),Mt("invalid",l);break;default:E=_}ri(f,E),G=E;for(x in G)if(G.hasOwnProperty(x)){var B=G[x];x==="style"?Gs(l,B):x==="dangerouslySetInnerHTML"?(B=B?B.__html:void 0,B!=null&&Ja(l,B)):x==="children"?typeof B=="string"?(f!=="textarea"||B!=="")&&Jr(l,B):typeof B=="number"&&Jr(l,""+B):x!=="suppressContentEditableWarning"&&x!=="suppressHydrationWarning"&&x!=="autoFocus"&&(r.hasOwnProperty(x)?B!=null&&x==="onScroll"&&Mt("scroll",l):B!=null&&C(l,x,B,b))}switch(f){case"input":Rr(l),tr(l,_,!1);break;case"textarea":Rr(l),ir(l);break;case"option":_.value!=null&&l.setAttribute("value",""+Ke(_.value));break;case"select":l.multiple=!!_.multiple,x=_.value,x!=null?vn(l,!!_.multiple,x,!1):_.defaultValue!=null&&vn(l,!!_.multiple,_.defaultValue,!0);break;default:typeof E.onClick=="function"&&(l.onclick=Em)}switch(f){case"button":case"input":case"select":case"textarea":_=!!_.autoFocus;break e;case"img":_=!0;break e;default:_=!1}}_&&(u.flags|=4)}u.ref!==null&&(u.flags|=512,u.flags|=2097152)}return Wn(u),null;case 6:if(l&&u.stateNode!=null)r2(l,u,l.memoizedProps,_);else{if(typeof _!="string"&&u.stateNode===null)throw Error(t(166));if(f=_l(vd.current),_l(ps.current),Rm(u)){if(_=u.stateNode,f=u.memoizedProps,_[ms]=u,(x=_.nodeValue!==f)&&(l=Ui,l!==null))switch(l.tag){case 3:vm(_.nodeValue,f,(l.mode&1)!==0);break;case 5:l.memoizedProps.suppressHydrationWarning!==!0&&vm(_.nodeValue,f,(l.mode&1)!==0)}x&&(u.flags|=4)}else _=(f.nodeType===9?f:f.ownerDocument).createTextNode(_),_[ms]=u,u.stateNode=_}return Wn(u),null;case 13:if(bt(Gt),_=u.memoizedState,l===null||l.memoizedState!==null&&l.memoizedState.dehydrated!==null){if(Dt&&zi!==null&&(u.mode&1)!==0&&(u.flags&128)===0)aI(),nu(),u.flags|=98560,x=!1;else if(x=Rm(u),_!==null&&_.dehydrated!==null){if(l===null){if(!x)throw Error(t(318));if(x=u.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(t(317));x[ms]=u}else nu(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;Wn(u),x=!1}else Lr!==null&&(Nv(Lr),Lr=null),x=!0;if(!x)return u.flags&65536?u:null}return(u.flags&128)!==0?(u.lanes=f,u):(_=_!==null,_!==(l!==null&&l.memoizedState!==null)&&_&&(u.child.flags|=8192,(u.mode&1)!==0&&(l===null||(Gt.current&1)!==0?dn===0&&(dn=3):Vv())),u.updateQueue!==null&&(u.flags|=4),Wn(u),null);case 4:return ou(),Sv(l,u),l===null&&dd(u.stateNode.containerInfo),Wn(u),null;case 10:return Zy(u.type._context),Wn(u),null;case 17:return yi(u.type)&&xm(),Wn(u),null;case 19:if(bt(Gt),x=u.memoizedState,x===null)return Wn(u),null;if(_=(u.flags&128)!==0,b=x.rendering,b===null)if(_)Td(x,!1);else{if(dn!==0||l!==null&&(l.flags&128)!==0)for(l=u.child;l!==null;){if(b=Lm(l),b!==null){for(u.flags|=128,Td(x,!1),_=b.updateQueue,_!==null&&(u.updateQueue=_,u.flags|=4),u.subtreeFlags=0,_=f,f=u.child;f!==null;)x=f,l=_,x.flags&=14680066,b=x.alternate,b===null?(x.childLanes=0,x.lanes=l,x.child=null,x.subtreeFlags=0,x.memoizedProps=null,x.memoizedState=null,x.updateQueue=null,x.dependencies=null,x.stateNode=null):(x.childLanes=b.childLanes,x.lanes=b.lanes,x.child=b.child,x.subtreeFlags=0,x.deletions=null,x.memoizedProps=b.memoizedProps,x.memoizedState=b.memoizedState,x.updateQueue=b.updateQueue,x.type=b.type,l=b.dependencies,x.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),f=f.sibling;return Pt(Gt,Gt.current&1|2),u.child}l=l.sibling}x.tail!==null&&Ct()>uu&&(u.flags|=128,_=!0,Td(x,!1),u.lanes=4194304)}else{if(!_)if(l=Lm(b),l!==null){if(u.flags|=128,_=!0,f=l.updateQueue,f!==null&&(u.updateQueue=f,u.flags|=4),Td(x,!0),x.tail===null&&x.tailMode==="hidden"&&!b.alternate&&!Dt)return Wn(u),null}else 2*Ct()-x.renderingStartTime>uu&&f!==1073741824&&(u.flags|=128,_=!0,Td(x,!1),u.lanes=4194304);x.isBackwards?(b.sibling=u.child,u.child=b):(f=x.last,f!==null?f.sibling=b:u.child=b,x.last=b)}return x.tail!==null?(u=x.tail,x.rendering=u,x.tail=u.sibling,x.renderingStartTime=Ct(),u.sibling=null,f=Gt.current,Pt(Gt,_?f&1|2:f&1),u):(Wn(u),null);case 22:case 23:return Ov(),_=u.memoizedState!==null,l!==null&&l.memoizedState!==null!==_&&(u.flags|=8192),_&&(u.mode&1)!==0?(Bi&1073741824)!==0&&(Wn(u),u.subtreeFlags&6&&(u.flags|=8192)):Wn(u),null;case 24:return null;case 25:return null}throw Error(t(156,u.tag))}function kO(l,u){switch(Wy(u),u.tag){case 1:return yi(u.type)&&xm(),l=u.flags,l&65536?(u.flags=l&-65537|128,u):null;case 3:return ou(),bt(_i),bt(Bn),rv(),l=u.flags,(l&65536)!==0&&(l&128)===0?(u.flags=l&-65537|128,u):null;case 5:return nv(u),null;case 13:if(bt(Gt),l=u.memoizedState,l!==null&&l.dehydrated!==null){if(u.alternate===null)throw Error(t(340));nu()}return l=u.flags,l&65536?(u.flags=l&-65537|128,u):null;case 19:return bt(Gt),null;case 4:return ou(),null;case 10:return Zy(u.type._context),null;case 22:case 23:return Ov(),null;case 24:return null;default:return null}}var zm=!1,Kn=!1,LO=typeof WeakSet=="function"?WeakSet:Set,Ee=null;function lu(l,u){var f=l.ref;if(f!==null)if(typeof f=="function")try{f(null)}catch(_){Wt(l,u,_)}else f.current=null}function Tv(l,u,f){try{f()}catch(_){Wt(l,u,_)}}var s2=!1;function NO(l,u){if(Oy=Ks,l=VT(),Py(l)){if("selectionStart"in l)var f={start:l.selectionStart,end:l.selectionEnd};else e:{f=(f=l.ownerDocument)&&f.defaultView||window;var _=f.getSelection&&f.getSelection();if(_&&_.rangeCount!==0){f=_.anchorNode;var E=_.anchorOffset,x=_.focusNode;_=_.focusOffset;try{f.nodeType,x.nodeType}catch{f=null;break e}var b=0,G=-1,B=-1,Z=0,oe=0,le=l,re=null;t:for(;;){for(var ve;le!==f||E!==0&&le.nodeType!==3||(G=b+E),le!==x||_!==0&&le.nodeType!==3||(B=b+_),le.nodeType===3&&(b+=le.nodeValue.length),(ve=le.firstChild)!==null;)re=le,le=ve;for(;;){if(le===l)break t;if(re===f&&++Z===E&&(G=b),re===x&&++oe===_&&(B=b),(ve=le.nextSibling)!==null)break;le=re,re=le.parentNode}le=ve}f=G===-1||B===-1?null:{start:G,end:B}}else f=null}f=f||{start:0,end:0}}else f=null;for(Vy={focusedElem:l,selectionRange:f},Ks=!1,Ee=u;Ee!==null;)if(u=Ee,l=u.child,(u.subtreeFlags&1028)!==0&&l!==null)l.return=u,Ee=l;else for(;Ee!==null;){u=Ee;try{var xe=u.alternate;if((u.flags&1024)!==0)switch(u.tag){case 0:case 11:case 15:break;case 1:if(xe!==null){var Te=xe.memoizedProps,Jt=xe.memoizedState,H=u.stateNode,W=H.getSnapshotBeforeUpdate(u.elementType===u.type?Te:Nr(u.type,Te),Jt);H.__reactInternalSnapshotBeforeUpdate=W}break;case 3:var Y=u.stateNode.containerInfo;Y.nodeType===1?Y.textContent="":Y.nodeType===9&&Y.documentElement&&Y.removeChild(Y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(he){Wt(u,u.return,he)}if(l=u.sibling,l!==null){l.return=u.return,Ee=l;break}Ee=u.return}return xe=s2,s2=!1,xe}function Id(l,u,f){var _=u.updateQueue;if(_=_!==null?_.lastEffect:null,_!==null){var E=_=_.next;do{if((E.tag&l)===l){var x=E.destroy;E.destroy=void 0,x!==void 0&&Tv(u,f,x)}E=E.next}while(E!==_)}}function Bm(l,u){if(u=u.updateQueue,u=u!==null?u.lastEffect:null,u!==null){var f=u=u.next;do{if((f.tag&l)===l){var _=f.create;f.destroy=_()}f=f.next}while(f!==u)}}function Iv(l){var u=l.ref;if(u!==null){var f=l.stateNode;switch(l.tag){case 5:l=f;break;default:l=f}typeof u=="function"?u(l):u.current=l}}function o2(l){var u=l.alternate;u!==null&&(l.alternate=null,o2(u)),l.child=null,l.deletions=null,l.sibling=null,l.tag===5&&(u=l.stateNode,u!==null&&(delete u[ms],delete u[gd],delete u[Uy],delete u[pO],delete u[_O])),l.stateNode=null,l.return=null,l.dependencies=null,l.memoizedProps=null,l.memoizedState=null,l.pendingProps=null,l.stateNode=null,l.updateQueue=null}function a2(l){return l.tag===5||l.tag===3||l.tag===4}function l2(l){e:for(;;){for(;l.sibling===null;){if(l.return===null||a2(l.return))return null;l=l.return}for(l.sibling.return=l.return,l=l.sibling;l.tag!==5&&l.tag!==6&&l.tag!==18;){if(l.flags&2||l.child===null||l.tag===4)continue e;l.child.return=l,l=l.child}if(!(l.flags&2))return l.stateNode}}function Av(l,u,f){var _=l.tag;if(_===5||_===6)l=l.stateNode,u?f.nodeType===8?f.parentNode.insertBefore(l,u):f.insertBefore(l,u):(f.nodeType===8?(u=f.parentNode,u.insertBefore(l,f)):(u=f,u.appendChild(l)),f=f._reactRootContainer,f!=null||u.onclick!==null||(u.onclick=Em));else if(_!==4&&(l=l.child,l!==null))for(Av(l,u,f),l=l.sibling;l!==null;)Av(l,u,f),l=l.sibling}function Rv(l,u,f){var _=l.tag;if(_===5||_===6)l=l.stateNode,u?f.insertBefore(l,u):f.appendChild(l);else if(_!==4&&(l=l.child,l!==null))for(Rv(l,u,f),l=l.sibling;l!==null;)Rv(l,u,f),l=l.sibling}var Nn=null,Dr=!1;function qo(l,u,f){for(f=f.child;f!==null;)c2(l,u,f),f=f.sibling}function c2(l,u,f){if(Di&&typeof Di.onCommitFiberUnmount=="function")try{Di.onCommitFiberUnmount(il,f)}catch{}switch(f.tag){case 5:Kn||lu(f,u);case 6:var _=Nn,E=Dr;Nn=null,qo(l,u,f),Nn=_,Dr=E,Nn!==null&&(Dr?(l=Nn,f=f.stateNode,l.nodeType===8?l.parentNode.removeChild(f):l.removeChild(f)):Nn.removeChild(f.stateNode));break;case 18:Nn!==null&&(Dr?(l=Nn,f=f.stateNode,l.nodeType===8?Gy(l.parentNode,f):l.nodeType===1&&Gy(l,f),Vo(l)):Gy(Nn,f.stateNode));break;case 4:_=Nn,E=Dr,Nn=f.stateNode.containerInfo,Dr=!0,qo(l,u,f),Nn=_,Dr=E;break;case 0:case 11:case 14:case 15:if(!Kn&&(_=f.updateQueue,_!==null&&(_=_.lastEffect,_!==null))){E=_=_.next;do{var x=E,b=x.destroy;x=x.tag,b!==void 0&&((x&2)!==0||(x&4)!==0)&&Tv(f,u,b),E=E.next}while(E!==_)}qo(l,u,f);break;case 1:if(!Kn&&(lu(f,u),_=f.stateNode,typeof _.componentWillUnmount=="function"))try{_.props=f.memoizedProps,_.state=f.memoizedState,_.componentWillUnmount()}catch(G){Wt(f,u,G)}qo(l,u,f);break;case 21:qo(l,u,f);break;case 22:f.mode&1?(Kn=(_=Kn)||f.memoizedState!==null,qo(l,u,f),Kn=_):qo(l,u,f);break;default:qo(l,u,f)}}function u2(l){var u=l.updateQueue;if(u!==null){l.updateQueue=null;var f=l.stateNode;f===null&&(f=l.stateNode=new LO),u.forEach(function(_){var E=BO.bind(null,l,_);f.has(_)||(f.add(_),_.then(E,E))})}}function Or(l,u){var f=u.deletions;if(f!==null)for(var _=0;_<f.length;_++){var E=f[_];try{var x=l,b=u,G=b;e:for(;G!==null;){switch(G.tag){case 5:Nn=G.stateNode,Dr=!1;break e;case 3:Nn=G.stateNode.containerInfo,Dr=!0;break e;case 4:Nn=G.stateNode.containerInfo,Dr=!0;break e}G=G.return}if(Nn===null)throw Error(t(160));c2(x,b,E),Nn=null,Dr=!1;var B=E.alternate;B!==null&&(B.return=null),E.return=null}catch(Z){Wt(E,u,Z)}}if(u.subtreeFlags&12854)for(u=u.child;u!==null;)h2(u,l),u=u.sibling}function h2(l,u){var f=l.alternate,_=l.flags;switch(l.tag){case 0:case 11:case 14:case 15:if(Or(u,l),ys(l),_&4){try{Id(3,l,l.return),Bm(3,l)}catch(Te){Wt(l,l.return,Te)}try{Id(5,l,l.return)}catch(Te){Wt(l,l.return,Te)}}break;case 1:Or(u,l),ys(l),_&512&&f!==null&&lu(f,f.return);break;case 5:if(Or(u,l),ys(l),_&512&&f!==null&&lu(f,f.return),l.flags&32){var E=l.stateNode;try{Jr(E,"")}catch(Te){Wt(l,l.return,Te)}}if(_&4&&(E=l.stateNode,E!=null)){var x=l.memoizedProps,b=f!==null?f.memoizedProps:x,G=l.type,B=l.updateQueue;if(l.updateQueue=null,B!==null)try{G==="input"&&x.type==="radio"&&x.name!=null&&Pn(E,x),Us(G,b);var Z=Us(G,x);for(b=0;b<B.length;b+=2){var oe=B[b],le=B[b+1];oe==="style"?Gs(E,le):oe==="dangerouslySetInnerHTML"?Ja(E,le):oe==="children"?Jr(E,le):C(E,oe,le,Z)}switch(G){case"input":pi(E,x);break;case"textarea":bo(E,x);break;case"select":var re=E._wrapperState.wasMultiple;E._wrapperState.wasMultiple=!!x.multiple;var ve=x.value;ve!=null?vn(E,!!x.multiple,ve,!1):re!==!!x.multiple&&(x.defaultValue!=null?vn(E,!!x.multiple,x.defaultValue,!0):vn(E,!!x.multiple,x.multiple?[]:"",!1))}E[gd]=x}catch(Te){Wt(l,l.return,Te)}}break;case 6:if(Or(u,l),ys(l),_&4){if(l.stateNode===null)throw Error(t(162));E=l.stateNode,x=l.memoizedProps;try{E.nodeValue=x}catch(Te){Wt(l,l.return,Te)}}break;case 3:if(Or(u,l),ys(l),_&4&&f!==null&&f.memoizedState.isDehydrated)try{Vo(u.containerInfo)}catch(Te){Wt(l,l.return,Te)}break;case 4:Or(u,l),ys(l);break;case 13:Or(u,l),ys(l),E=l.child,E.flags&8192&&(x=E.memoizedState!==null,E.stateNode.isHidden=x,!x||E.alternate!==null&&E.alternate.memoizedState!==null||(Mv=Ct())),_&4&&u2(l);break;case 22:if(oe=f!==null&&f.memoizedState!==null,l.mode&1?(Kn=(Z=Kn)||oe,Or(u,l),Kn=Z):Or(u,l),ys(l),_&8192){if(Z=l.memoizedState!==null,(l.stateNode.isHidden=Z)&&!oe&&(l.mode&1)!==0)for(Ee=l,oe=l.child;oe!==null;){for(le=Ee=oe;Ee!==null;){switch(re=Ee,ve=re.child,re.tag){case 0:case 11:case 14:case 15:Id(4,re,re.return);break;case 1:lu(re,re.return);var xe=re.stateNode;if(typeof xe.componentWillUnmount=="function"){_=re,f=re.return;try{u=_,xe.props=u.memoizedProps,xe.state=u.memoizedState,xe.componentWillUnmount()}catch(Te){Wt(_,f,Te)}}break;case 5:lu(re,re.return);break;case 22:if(re.memoizedState!==null){g2(le);continue}}ve!==null?(ve.return=re,Ee=ve):g2(le)}oe=oe.sibling}e:for(oe=null,le=l;;){if(le.tag===5){if(oe===null){oe=le;try{E=le.stateNode,Z?(x=E.style,typeof x.setProperty=="function"?x.setProperty("display","none","important"):x.display="none"):(G=le.stateNode,B=le.memoizedProps.style,b=B!=null&&B.hasOwnProperty("display")?B.display:null,G.style.display=es("display",b))}catch(Te){Wt(l,l.return,Te)}}}else if(le.tag===6){if(oe===null)try{le.stateNode.nodeValue=Z?"":le.memoizedProps}catch(Te){Wt(l,l.return,Te)}}else if((le.tag!==22&&le.tag!==23||le.memoizedState===null||le===l)&&le.child!==null){le.child.return=le,le=le.child;continue}if(le===l)break e;for(;le.sibling===null;){if(le.return===null||le.return===l)break e;oe===le&&(oe=null),le=le.return}oe===le&&(oe=null),le.sibling.return=le.return,le=le.sibling}}break;case 19:Or(u,l),ys(l),_&4&&u2(l);break;case 21:break;default:Or(u,l),ys(l)}}function ys(l){var u=l.flags;if(u&2){try{e:{for(var f=l.return;f!==null;){if(a2(f)){var _=f;break e}f=f.return}throw Error(t(160))}switch(_.tag){case 5:var E=_.stateNode;_.flags&32&&(Jr(E,""),_.flags&=-33);var x=l2(l);Rv(l,x,E);break;case 3:case 4:var b=_.stateNode.containerInfo,G=l2(l);Av(l,G,b);break;default:throw Error(t(161))}}catch(B){Wt(l,l.return,B)}l.flags&=-3}u&4096&&(l.flags&=-4097)}function DO(l,u,f){Ee=l,d2(l)}function d2(l,u,f){for(var _=(l.mode&1)!==0;Ee!==null;){var E=Ee,x=E.child;if(E.tag===22&&_){var b=E.memoizedState!==null||zm;if(!b){var G=E.alternate,B=G!==null&&G.memoizedState!==null||Kn;G=zm;var Z=Kn;if(zm=b,(Kn=B)&&!Z)for(Ee=E;Ee!==null;)b=Ee,B=b.child,b.tag===22&&b.memoizedState!==null?m2(E):B!==null?(B.return=b,Ee=B):m2(E);for(;x!==null;)Ee=x,d2(x),x=x.sibling;Ee=E,zm=G,Kn=Z}f2(l)}else(E.subtreeFlags&8772)!==0&&x!==null?(x.return=E,Ee=x):f2(l)}}function f2(l){for(;Ee!==null;){var u=Ee;if((u.flags&8772)!==0){var f=u.alternate;try{if((u.flags&8772)!==0)switch(u.tag){case 0:case 11:case 15:Kn||Bm(5,u);break;case 1:var _=u.stateNode;if(u.flags&4&&!Kn)if(f===null)_.componentDidMount();else{var E=u.elementType===u.type?f.memoizedProps:Nr(u.type,f.memoizedProps);_.componentDidUpdate(E,f.memoizedState,_.__reactInternalSnapshotBeforeUpdate)}var x=u.updateQueue;x!==null&&gI(u,x,_);break;case 3:var b=u.updateQueue;if(b!==null){if(f=null,u.child!==null)switch(u.child.tag){case 5:f=u.child.stateNode;break;case 1:f=u.child.stateNode}gI(u,b,f)}break;case 5:var G=u.stateNode;if(f===null&&u.flags&4){f=G;var B=u.memoizedProps;switch(u.type){case"button":case"input":case"select":case"textarea":B.autoFocus&&f.focus();break;case"img":B.src&&(f.src=B.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(u.memoizedState===null){var Z=u.alternate;if(Z!==null){var oe=Z.memoizedState;if(oe!==null){var le=oe.dehydrated;le!==null&&Vo(le)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Kn||u.flags&512&&Iv(u)}catch(re){Wt(u,u.return,re)}}if(u===l){Ee=null;break}if(f=u.sibling,f!==null){f.return=u.return,Ee=f;break}Ee=u.return}}function g2(l){for(;Ee!==null;){var u=Ee;if(u===l){Ee=null;break}var f=u.sibling;if(f!==null){f.return=u.return,Ee=f;break}Ee=u.return}}function m2(l){for(;Ee!==null;){var u=Ee;try{switch(u.tag){case 0:case 11:case 15:var f=u.return;try{Bm(4,u)}catch(B){Wt(u,f,B)}break;case 1:var _=u.stateNode;if(typeof _.componentDidMount=="function"){var E=u.return;try{_.componentDidMount()}catch(B){Wt(u,E,B)}}var x=u.return;try{Iv(u)}catch(B){Wt(u,x,B)}break;case 5:var b=u.return;try{Iv(u)}catch(B){Wt(u,b,B)}}}catch(B){Wt(u,u.return,B)}if(u===l){Ee=null;break}var G=u.sibling;if(G!==null){G.return=u.return,Ee=G;break}Ee=u.return}}var OO=Math.ceil,$m=N.ReactCurrentDispatcher,Pv=N.ReactCurrentOwner,fr=N.ReactCurrentBatchConfig,st=0,xn=null,on=null,Dn=0,Bi=0,cu=zo(0),dn=0,Ad=null,vl=0,Wm=0,Cv=0,Rd=null,Ei=null,Mv=0,uu=1/0,no=null,Km=!1,bv=null,Ho=null,qm=!1,Xo=null,Hm=0,Pd=0,kv=null,Xm=-1,Ym=0;function li(){return(st&6)!==0?Ct():Xm!==-1?Xm:Xm=Ct()}function Yo(l){return(l.mode&1)===0?1:(st&2)!==0&&Dn!==0?Dn&-Dn:vO.transition!==null?(Ym===0&&(Ym=Xh()),Ym):(l=nt,l!==0||(l=window.event,l=l===void 0?16:jc(l.type)),l)}function Vr(l,u,f,_){if(50<Pd)throw Pd=0,kv=null,Error(t(185));al(l,f,_),((st&2)===0||l!==xn)&&(l===xn&&((st&2)===0&&(Wm|=f),dn===4&&Zo(l,Dn)),wi(l,_),f===1&&st===0&&(u.mode&1)===0&&(uu=Ct()+500,Tm&&$o()))}function wi(l,u){var f=l.callbackNode;ol(l,u);var _=Bs(l,l===xn?Dn:0);if(_===0)f!==null&&kc(f),l.callbackNode=null,l.callbackPriority=0;else if(u=_&-_,l.callbackPriority!==u){if(f!=null&&kc(f),u===1)l.tag===0?yO(_2.bind(null,l)):nI(_2.bind(null,l)),gO(function(){(st&6)===0&&$o()}),f=null;else{switch(ss(_)){case 1:f=Lc;break;case 4:f=Kh;break;case 16:f=nl;break;case 536870912:f=Nc;break;default:f=nl}f=I2(f,p2.bind(null,l))}l.callbackPriority=u,l.callbackNode=f}}function p2(l,u){if(Xm=-1,Ym=0,(st&6)!==0)throw Error(t(327));var f=l.callbackNode;if(hu()&&l.callbackNode!==f)return null;var _=Bs(l,l===xn?Dn:0);if(_===0)return null;if((_&30)!==0||(_&l.expiredLanes)!==0||u)u=Zm(l,_);else{u=_;var E=st;st|=2;var x=v2();(xn!==l||Dn!==u)&&(no=null,uu=Ct()+500,wl(l,u));do try{jO();break}catch(G){y2(l,G)}while(!0);Yy(),$m.current=x,st=E,on!==null?u=0:(xn=null,Dn=0,u=dn)}if(u!==0){if(u===2&&(E=Hh(l),E!==0&&(_=E,u=Lv(l,E))),u===1)throw f=Ad,wl(l,0),Zo(l,_),wi(l,Ct()),f;if(u===6)Zo(l,_);else{if(E=l.current.alternate,(_&30)===0&&!VO(E)&&(u=Zm(l,_),u===2&&(x=Hh(l),x!==0&&(_=x,u=Lv(l,x))),u===1))throw f=Ad,wl(l,0),Zo(l,_),wi(l,Ct()),f;switch(l.finishedWork=E,l.finishedLanes=_,u){case 0:case 1:throw Error(t(345));case 2:xl(l,Ei,no);break;case 3:if(Zo(l,_),(_&130023424)===_&&(u=Mv+500-Ct(),10<u)){if(Bs(l,0)!==0)break;if(E=l.suspendedLanes,(E&_)!==_){li(),l.pingedLanes|=l.suspendedLanes&E;break}l.timeoutHandle=jy(xl.bind(null,l,Ei,no),u);break}xl(l,Ei,no);break;case 4:if(Zo(l,_),(_&4194240)===_)break;for(u=l.eventTimes,E=-1;0<_;){var b=31-Oi(_);x=1<<b,b=u[b],b>E&&(E=b),_&=~x}if(_=E,_=Ct()-_,_=(120>_?120:480>_?480:1080>_?1080:1920>_?1920:3e3>_?3e3:4320>_?4320:1960*OO(_/1960))-_,10<_){l.timeoutHandle=jy(xl.bind(null,l,Ei,no),_);break}xl(l,Ei,no);break;case 5:xl(l,Ei,no);break;default:throw Error(t(329))}}}return wi(l,Ct()),l.callbackNode===f?p2.bind(null,l):null}function Lv(l,u){var f=Rd;return l.current.memoizedState.isDehydrated&&(wl(l,u).flags|=256),l=Zm(l,u),l!==2&&(u=Ei,Ei=f,u!==null&&Nv(u)),l}function Nv(l){Ei===null?Ei=l:Ei.push.apply(Ei,l)}function VO(l){for(var u=l;;){if(u.flags&16384){var f=u.updateQueue;if(f!==null&&(f=f.stores,f!==null))for(var _=0;_<f.length;_++){var E=f[_],x=E.getSnapshot;E=E.value;try{if(!kr(x(),E))return!1}catch{return!1}}}if(f=u.child,u.subtreeFlags&16384&&f!==null)f.return=u,u=f;else{if(u===l)break;for(;u.sibling===null;){if(u.return===null||u.return===l)return!0;u=u.return}u.sibling.return=u.return,u=u.sibling}}return!0}function Zo(l,u){for(u&=~Cv,u&=~Wm,l.suspendedLanes|=u,l.pingedLanes&=~u,l=l.expirationTimes;0<u;){var f=31-Oi(u),_=1<<f;l[f]=-1,u&=~_}}function _2(l){if((st&6)!==0)throw Error(t(327));hu();var u=Bs(l,0);if((u&1)===0)return wi(l,Ct()),null;var f=Zm(l,u);if(l.tag!==0&&f===2){var _=Hh(l);_!==0&&(u=_,f=Lv(l,_))}if(f===1)throw f=Ad,wl(l,0),Zo(l,u),wi(l,Ct()),f;if(f===6)throw Error(t(345));return l.finishedWork=l.current.alternate,l.finishedLanes=u,xl(l,Ei,no),wi(l,Ct()),null}function Dv(l,u){var f=st;st|=1;try{return l(u)}finally{st=f,st===0&&(uu=Ct()+500,Tm&&$o())}}function El(l){Xo!==null&&Xo.tag===0&&(st&6)===0&&hu();var u=st;st|=1;var f=fr.transition,_=nt;try{if(fr.transition=null,nt=1,l)return l()}finally{nt=_,fr.transition=f,st=u,(st&6)===0&&$o()}}function Ov(){Bi=cu.current,bt(cu)}function wl(l,u){l.finishedWork=null,l.finishedLanes=0;var f=l.timeoutHandle;if(f!==-1&&(l.timeoutHandle=-1,fO(f)),on!==null)for(f=on.return;f!==null;){var _=f;switch(Wy(_),_.tag){case 1:_=_.type.childContextTypes,_!=null&&xm();break;case 3:ou(),bt(_i),bt(Bn),rv();break;case 5:nv(_);break;case 4:ou();break;case 13:bt(Gt);break;case 19:bt(Gt);break;case 10:Zy(_.type._context);break;case 22:case 23:Ov()}f=f.return}if(xn=l,on=l=Qo(l.current,null),Dn=Bi=u,dn=0,Ad=null,Cv=Wm=vl=0,Ei=Rd=null,pl!==null){for(u=0;u<pl.length;u++)if(f=pl[u],_=f.interleaved,_!==null){f.interleaved=null;var E=_.next,x=f.pending;if(x!==null){var b=x.next;x.next=E,_.next=b}f.pending=_}pl=null}return l}function y2(l,u){do{var f=on;try{if(Yy(),Nm.current=Fm,Dm){for(var _=Ut.memoizedState;_!==null;){var E=_.queue;E!==null&&(E.pending=null),_=_.next}Dm=!1}if(yl=0,wn=hn=Ut=null,Ed=!1,wd=0,Pv.current=null,f===null||f.return===null){dn=1,Ad=u,on=null;break}e:{var x=l,b=f.return,G=f,B=u;if(u=Dn,G.flags|=32768,B!==null&&typeof B=="object"&&typeof B.then=="function"){var Z=B,oe=G,le=oe.tag;if((oe.mode&1)===0&&(le===0||le===11||le===15)){var re=oe.alternate;re?(oe.updateQueue=re.updateQueue,oe.memoizedState=re.memoizedState,oe.lanes=re.lanes):(oe.updateQueue=null,oe.memoizedState=null)}var ve=BI(b);if(ve!==null){ve.flags&=-257,$I(ve,b,G,x,u),ve.mode&1&&zI(x,Z,u),u=ve,B=Z;var xe=u.updateQueue;if(xe===null){var Te=new Set;Te.add(B),u.updateQueue=Te}else xe.add(B);break e}else{if((u&1)===0){zI(x,Z,u),Vv();break e}B=Error(t(426))}}else if(Dt&&G.mode&1){var Jt=BI(b);if(Jt!==null){(Jt.flags&65536)===0&&(Jt.flags|=256),$I(Jt,b,G,x,u),Hy(au(B,G));break e}}x=B=au(B,G),dn!==4&&(dn=2),Rd===null?Rd=[x]:Rd.push(x),x=b;do{switch(x.tag){case 3:x.flags|=65536,u&=-u,x.lanes|=u;var H=GI(x,B,u);fI(x,H);break e;case 1:G=B;var W=x.type,Y=x.stateNode;if((x.flags&128)===0&&(typeof W.getDerivedStateFromError=="function"||Y!==null&&typeof Y.componentDidCatch=="function"&&(Ho===null||!Ho.has(Y)))){x.flags|=65536,u&=-u,x.lanes|=u;var he=UI(x,G,u);fI(x,he);break e}}x=x.return}while(x!==null)}w2(f)}catch(Ie){u=Ie,on===f&&f!==null&&(on=f=f.return);continue}break}while(!0)}function v2(){var l=$m.current;return $m.current=Fm,l===null?Fm:l}function Vv(){(dn===0||dn===3||dn===2)&&(dn=4),xn===null||(vl&268435455)===0&&(Wm&268435455)===0||Zo(xn,Dn)}function Zm(l,u){var f=st;st|=2;var _=v2();(xn!==l||Dn!==u)&&(no=null,wl(l,u));do try{FO();break}catch(E){y2(l,E)}while(!0);if(Yy(),st=f,$m.current=_,on!==null)throw Error(t(261));return xn=null,Dn=0,dn}function FO(){for(;on!==null;)E2(on)}function jO(){for(;on!==null&&!tl();)E2(on)}function E2(l){var u=T2(l.alternate,l,Bi);l.memoizedProps=l.pendingProps,u===null?w2(l):on=u,Pv.current=null}function w2(l){var u=l;do{var f=u.alternate;if(l=u.return,(u.flags&32768)===0){if(f=bO(f,u,Bi),f!==null){on=f;return}}else{if(f=kO(f,u),f!==null){f.flags&=32767,on=f;return}if(l!==null)l.flags|=32768,l.subtreeFlags=0,l.deletions=null;else{dn=6,on=null;return}}if(u=u.sibling,u!==null){on=u;return}on=u=l}while(u!==null);dn===0&&(dn=5)}function xl(l,u,f){var _=nt,E=fr.transition;try{fr.transition=null,nt=1,GO(l,u,f,_)}finally{fr.transition=E,nt=_}return null}function GO(l,u,f,_){do hu();while(Xo!==null);if((st&6)!==0)throw Error(t(327));f=l.finishedWork;var E=l.finishedLanes;if(f===null)return null;if(l.finishedWork=null,l.finishedLanes=0,f===l.current)throw Error(t(177));l.callbackNode=null,l.callbackPriority=0;var x=f.lanes|f.childLanes;if(Sy(l,x),l===xn&&(on=xn=null,Dn=0),(f.subtreeFlags&2064)===0&&(f.flags&2064)===0||qm||(qm=!0,I2(nl,function(){return hu(),null})),x=(f.flags&15990)!==0,(f.subtreeFlags&15990)!==0||x){x=fr.transition,fr.transition=null;var b=nt;nt=1;var G=st;st|=4,Pv.current=null,NO(l,f),h2(f,l),oO(Vy),Ks=!!Oy,Vy=Oy=null,l.current=f,DO(f),zs(),st=G,nt=b,fr.transition=x}else l.current=f;if(qm&&(qm=!1,Xo=l,Hm=E),x=l.pendingLanes,x===0&&(Ho=null),rm(f.stateNode),wi(l,Ct()),u!==null)for(_=l.onRecoverableError,f=0;f<u.length;f++)E=u[f],_(E.value,{componentStack:E.stack,digest:E.digest});if(Km)throw Km=!1,l=bv,bv=null,l;return(Hm&1)!==0&&l.tag!==0&&hu(),x=l.pendingLanes,(x&1)!==0?l===kv?Pd++:(Pd=0,kv=l):Pd=0,$o(),null}function hu(){if(Xo!==null){var l=ss(Hm),u=fr.transition,f=nt;try{if(fr.transition=null,nt=16>l?16:l,Xo===null)var _=!1;else{if(l=Xo,Xo=null,Hm=0,(st&6)!==0)throw Error(t(331));var E=st;for(st|=4,Ee=l.current;Ee!==null;){var x=Ee,b=x.child;if((Ee.flags&16)!==0){var G=x.deletions;if(G!==null){for(var B=0;B<G.length;B++){var Z=G[B];for(Ee=Z;Ee!==null;){var oe=Ee;switch(oe.tag){case 0:case 11:case 15:Id(8,oe,x)}var le=oe.child;if(le!==null)le.return=oe,Ee=le;else for(;Ee!==null;){oe=Ee;var re=oe.sibling,ve=oe.return;if(o2(oe),oe===Z){Ee=null;break}if(re!==null){re.return=ve,Ee=re;break}Ee=ve}}}var xe=x.alternate;if(xe!==null){var Te=xe.child;if(Te!==null){xe.child=null;do{var Jt=Te.sibling;Te.sibling=null,Te=Jt}while(Te!==null)}}Ee=x}}if((x.subtreeFlags&2064)!==0&&b!==null)b.return=x,Ee=b;else e:for(;Ee!==null;){if(x=Ee,(x.flags&2048)!==0)switch(x.tag){case 0:case 11:case 15:Id(9,x,x.return)}var H=x.sibling;if(H!==null){H.return=x.return,Ee=H;break e}Ee=x.return}}var W=l.current;for(Ee=W;Ee!==null;){b=Ee;var Y=b.child;if((b.subtreeFlags&2064)!==0&&Y!==null)Y.return=b,Ee=Y;else e:for(b=W;Ee!==null;){if(G=Ee,(G.flags&2048)!==0)try{switch(G.tag){case 0:case 11:case 15:Bm(9,G)}}catch(Ie){Wt(G,G.return,Ie)}if(G===b){Ee=null;break e}var he=G.sibling;if(he!==null){he.return=G.return,Ee=he;break e}Ee=G.return}}if(st=E,$o(),Di&&typeof Di.onPostCommitFiberRoot=="function")try{Di.onPostCommitFiberRoot(il,l)}catch{}_=!0}return _}finally{nt=f,fr.transition=u}}return!1}function x2(l,u,f){u=au(f,u),u=GI(l,u,1),l=Ko(l,u,1),u=li(),l!==null&&(al(l,1,u),wi(l,u))}function Wt(l,u,f){if(l.tag===3)x2(l,l,f);else for(;u!==null;){if(u.tag===3){x2(u,l,f);break}else if(u.tag===1){var _=u.stateNode;if(typeof u.type.getDerivedStateFromError=="function"||typeof _.componentDidCatch=="function"&&(Ho===null||!Ho.has(_))){l=au(f,l),l=UI(u,l,1),u=Ko(u,l,1),l=li(),u!==null&&(al(u,1,l),wi(u,l));break}}u=u.return}}function UO(l,u,f){var _=l.pingCache;_!==null&&_.delete(u),u=li(),l.pingedLanes|=l.suspendedLanes&f,xn===l&&(Dn&f)===f&&(dn===4||dn===3&&(Dn&130023424)===Dn&&500>Ct()-Mv?wl(l,0):Cv|=f),wi(l,u)}function S2(l,u){u===0&&((l.mode&1)===0?u=1:(u=No,No<<=1,(No&130023424)===0&&(No=4194304)));var f=li();l=Js(l,u),l!==null&&(al(l,u,f),wi(l,f))}function zO(l){var u=l.memoizedState,f=0;u!==null&&(f=u.retryLane),S2(l,f)}function BO(l,u){var f=0;switch(l.tag){case 13:var _=l.stateNode,E=l.memoizedState;E!==null&&(f=E.retryLane);break;case 19:_=l.stateNode;break;default:throw Error(t(314))}_!==null&&_.delete(u),S2(l,f)}var T2;T2=function(l,u,f){if(l!==null)if(l.memoizedProps!==u.pendingProps||_i.current)vi=!0;else{if((l.lanes&f)===0&&(u.flags&128)===0)return vi=!1,MO(l,u,f);vi=(l.flags&131072)!==0}else vi=!1,Dt&&(u.flags&1048576)!==0&&iI(u,Am,u.index);switch(u.lanes=0,u.tag){case 2:var _=u.type;Um(l,u),l=u.pendingProps;var E=Jc(u,Bn.current);su(u,f),E=av(null,u,_,l,E,f);var x=lv();return u.flags|=1,typeof E=="object"&&E!==null&&typeof E.render=="function"&&E.$$typeof===void 0?(u.tag=1,u.memoizedState=null,u.updateQueue=null,yi(_)?(x=!0,Sm(u)):x=!1,u.memoizedState=E.state!==null&&E.state!==void 0?E.state:null,ev(u),E.updater=jm,u.stateNode=E,E._reactInternals=u,gv(u,_,l,f),u=yv(null,u,_,!0,x,f)):(u.tag=0,Dt&&x&&$y(u),ai(null,u,E,f),u=u.child),u;case 16:_=u.elementType;e:{switch(Um(l,u),l=u.pendingProps,E=_._init,_=E(_._payload),u.type=_,E=u.tag=WO(_),l=Nr(_,l),E){case 0:u=_v(null,u,_,l,f);break e;case 1:u=YI(null,u,_,l,f);break e;case 11:u=WI(null,u,_,l,f);break e;case 14:u=KI(null,u,_,Nr(_.type,l),f);break e}throw Error(t(306,_,""))}return u;case 0:return _=u.type,E=u.pendingProps,E=u.elementType===_?E:Nr(_,E),_v(l,u,_,E,f);case 1:return _=u.type,E=u.pendingProps,E=u.elementType===_?E:Nr(_,E),YI(l,u,_,E,f);case 3:e:{if(ZI(u),l===null)throw Error(t(387));_=u.pendingProps,x=u.memoizedState,E=x.element,dI(l,u),km(u,_,null,f);var b=u.memoizedState;if(_=b.element,x.isDehydrated)if(x={element:_,isDehydrated:!1,cache:b.cache,pendingSuspenseBoundaries:b.pendingSuspenseBoundaries,transitions:b.transitions},u.updateQueue.baseState=x,u.memoizedState=x,u.flags&256){E=au(Error(t(423)),u),u=QI(l,u,_,f,E);break e}else if(_!==E){E=au(Error(t(424)),u),u=QI(l,u,_,f,E);break e}else for(zi=Uo(u.stateNode.containerInfo.firstChild),Ui=u,Dt=!0,Lr=null,f=uI(u,null,_,f),u.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling;else{if(nu(),_===E){u=to(l,u,f);break e}ai(l,u,_,f)}u=u.child}return u;case 5:return mI(u),l===null&&qy(u),_=u.type,E=u.pendingProps,x=l!==null?l.memoizedProps:null,b=E.children,Fy(_,E)?b=null:x!==null&&Fy(_,x)&&(u.flags|=32),XI(l,u),ai(l,u,b,f),u.child;case 6:return l===null&&qy(u),null;case 13:return JI(l,u,f);case 4:return tv(u,u.stateNode.containerInfo),_=u.pendingProps,l===null?u.child=iu(u,null,_,f):ai(l,u,_,f),u.child;case 11:return _=u.type,E=u.pendingProps,E=u.elementType===_?E:Nr(_,E),WI(l,u,_,E,f);case 7:return ai(l,u,u.pendingProps,f),u.child;case 8:return ai(l,u,u.pendingProps.children,f),u.child;case 12:return ai(l,u,u.pendingProps.children,f),u.child;case 10:e:{if(_=u.type._context,E=u.pendingProps,x=u.memoizedProps,b=E.value,Pt(Cm,_._currentValue),_._currentValue=b,x!==null)if(kr(x.value,b)){if(x.children===E.children&&!_i.current){u=to(l,u,f);break e}}else for(x=u.child,x!==null&&(x.return=u);x!==null;){var G=x.dependencies;if(G!==null){b=x.child;for(var B=G.firstContext;B!==null;){if(B.context===_){if(x.tag===1){B=eo(-1,f&-f),B.tag=2;var Z=x.updateQueue;if(Z!==null){Z=Z.shared;var oe=Z.pending;oe===null?B.next=B:(B.next=oe.next,oe.next=B),Z.pending=B}}x.lanes|=f,B=x.alternate,B!==null&&(B.lanes|=f),Qy(x.return,f,u),G.lanes|=f;break}B=B.next}}else if(x.tag===10)b=x.type===u.type?null:x.child;else if(x.tag===18){if(b=x.return,b===null)throw Error(t(341));b.lanes|=f,G=b.alternate,G!==null&&(G.lanes|=f),Qy(b,f,u),b=x.sibling}else b=x.child;if(b!==null)b.return=x;else for(b=x;b!==null;){if(b===u){b=null;break}if(x=b.sibling,x!==null){x.return=b.return,b=x;break}b=b.return}x=b}ai(l,u,E.children,f),u=u.child}return u;case 9:return E=u.type,_=u.pendingProps.children,su(u,f),E=hr(E),_=_(E),u.flags|=1,ai(l,u,_,f),u.child;case 14:return _=u.type,E=Nr(_,u.pendingProps),E=Nr(_.type,E),KI(l,u,_,E,f);case 15:return qI(l,u,u.type,u.pendingProps,f);case 17:return _=u.type,E=u.pendingProps,E=u.elementType===_?E:Nr(_,E),Um(l,u),u.tag=1,yi(_)?(l=!0,Sm(u)):l=!1,su(u,f),FI(u,_,E),gv(u,_,E,f),yv(null,u,_,!0,l,f);case 19:return t2(l,u,f);case 22:return HI(l,u,f)}throw Error(t(156,u.tag))};function I2(l,u){return Wh(l,u)}function $O(l,u,f,_){this.tag=l,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=u,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=_,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function gr(l,u,f,_){return new $O(l,u,f,_)}function Fv(l){return l=l.prototype,!(!l||!l.isReactComponent)}function WO(l){if(typeof l=="function")return Fv(l)?1:0;if(l!=null){if(l=l.$$typeof,l===U)return 11;if(l===we)return 14}return 2}function Qo(l,u){var f=l.alternate;return f===null?(f=gr(l.tag,u,l.key,l.mode),f.elementType=l.elementType,f.type=l.type,f.stateNode=l.stateNode,f.alternate=l,l.alternate=f):(f.pendingProps=u,f.type=l.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=l.flags&14680064,f.childLanes=l.childLanes,f.lanes=l.lanes,f.child=l.child,f.memoizedProps=l.memoizedProps,f.memoizedState=l.memoizedState,f.updateQueue=l.updateQueue,u=l.dependencies,f.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext},f.sibling=l.sibling,f.index=l.index,f.ref=l.ref,f}function Qm(l,u,f,_,E,x){var b=2;if(_=l,typeof l=="function")Fv(l)&&(b=1);else if(typeof l=="string")b=5;else e:switch(l){case k:return Sl(f.children,E,x,u);case R:b=8,E|=8;break;case L:return l=gr(12,f,u,E|2),l.elementType=L,l.lanes=x,l;case O:return l=gr(13,f,u,E),l.elementType=O,l.lanes=x,l;case ce:return l=gr(19,f,u,E),l.elementType=ce,l.lanes=x,l;case de:return Jm(f,E,x,u);default:if(typeof l=="object"&&l!==null)switch(l.$$typeof){case F:b=10;break e;case j:b=9;break e;case U:b=11;break e;case we:b=14;break e;case ye:b=16,_=null;break e}throw Error(t(130,l==null?l:typeof l,""))}return u=gr(b,f,u,E),u.elementType=l,u.type=_,u.lanes=x,u}function Sl(l,u,f,_){return l=gr(7,l,_,u),l.lanes=f,l}function Jm(l,u,f,_){return l=gr(22,l,_,u),l.elementType=de,l.lanes=f,l.stateNode={isHidden:!1},l}function jv(l,u,f){return l=gr(6,l,null,u),l.lanes=f,l}function Gv(l,u,f){return u=gr(4,l.children!==null?l.children:[],l.key,u),u.lanes=f,u.stateNode={containerInfo:l.containerInfo,pendingChildren:null,implementation:l.implementation},u}function KO(l,u,f,_,E){this.tag=u,this.containerInfo=l,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Yh(0),this.expirationTimes=Yh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Yh(0),this.identifierPrefix=_,this.onRecoverableError=E,this.mutableSourceEagerHydrationData=null}function Uv(l,u,f,_,E,x,b,G,B){return l=new KO(l,u,f,G,B),u===1?(u=1,x===!0&&(u|=8)):u=0,x=gr(3,null,null,u),l.current=x,x.stateNode=l,x.memoizedState={element:_,isDehydrated:f,cache:null,transitions:null,pendingSuspenseBoundaries:null},ev(x),l}function qO(l,u,f){var _=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:z,key:_==null?null:""+_,children:l,containerInfo:u,implementation:f}}function A2(l){if(!l)return Bo;l=l._reactInternals;e:{if(Mr(l)!==l||l.tag!==1)throw Error(t(170));var u=l;do{switch(u.tag){case 3:u=u.stateNode.context;break e;case 1:if(yi(u.type)){u=u.stateNode.__reactInternalMemoizedMergedChildContext;break e}}u=u.return}while(u!==null);throw Error(t(171))}if(l.tag===1){var f=l.type;if(yi(f))return eI(l,f,u)}return u}function R2(l,u,f,_,E,x,b,G,B){return l=Uv(f,_,!0,l,E,x,b,G,B),l.context=A2(null),f=l.current,_=li(),E=Yo(f),x=eo(_,E),x.callback=u??null,Ko(f,x,E),l.current.lanes=E,al(l,E,_),wi(l,_),l}function ep(l,u,f,_){var E=u.current,x=li(),b=Yo(E);return f=A2(f),u.context===null?u.context=f:u.pendingContext=f,u=eo(x,b),u.payload={element:l},_=_===void 0?null:_,_!==null&&(u.callback=_),l=Ko(E,u,b),l!==null&&(Vr(l,E,b,x),bm(l,E,b)),b}function tp(l){if(l=l.current,!l.child)return null;switch(l.child.tag){case 5:return l.child.stateNode;default:return l.child.stateNode}}function P2(l,u){if(l=l.memoizedState,l!==null&&l.dehydrated!==null){var f=l.retryLane;l.retryLane=f!==0&&f<u?f:u}}function zv(l,u){P2(l,u),(l=l.alternate)&&P2(l,u)}function HO(){return null}var C2=typeof reportError=="function"?reportError:function(l){console.error(l)};function Bv(l){this._internalRoot=l}np.prototype.render=Bv.prototype.render=function(l){var u=this._internalRoot;if(u===null)throw Error(t(409));ep(l,u,null,null)},np.prototype.unmount=Bv.prototype.unmount=function(){var l=this._internalRoot;if(l!==null){this._internalRoot=null;var u=l.containerInfo;El(function(){ep(null,l,null,null)}),u[Xs]=null}};function np(l){this._internalRoot=l}np.prototype.unstable_scheduleHydration=function(l){if(l){var u=ed();l={blockedOn:null,target:l,priority:u};for(var f=0;f<Vi.length&&u!==0&&u<Vi[f].priority;f++);Vi.splice(f,0,l),f===0&&Vc(l)}};function $v(l){return!(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11)}function ip(l){return!(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11&&(l.nodeType!==8||l.nodeValue!==" react-mount-point-unstable "))}function M2(){}function XO(l,u,f,_,E){if(E){if(typeof _=="function"){var x=_;_=function(){var Z=tp(b);x.call(Z)}}var b=R2(u,_,l,0,null,!1,!1,"",M2);return l._reactRootContainer=b,l[Xs]=b.current,dd(l.nodeType===8?l.parentNode:l),El(),b}for(;E=l.lastChild;)l.removeChild(E);if(typeof _=="function"){var G=_;_=function(){var Z=tp(B);G.call(Z)}}var B=Uv(l,0,!1,null,null,!1,!1,"",M2);return l._reactRootContainer=B,l[Xs]=B.current,dd(l.nodeType===8?l.parentNode:l),El(function(){ep(u,B,f,_)}),B}function rp(l,u,f,_,E){var x=f._reactRootContainer;if(x){var b=x;if(typeof E=="function"){var G=E;E=function(){var B=tp(b);G.call(B)}}ep(u,b,l,E)}else b=XO(f,u,l,E,_);return tp(b)}Qh=function(l){switch(l.tag){case 3:var u=l.stateNode;if(u.current.memoizedState.isDehydrated){var f=dt(u.pendingLanes);f!==0&&(Zh(u,f|1),wi(u,Ct()),(st&6)===0&&(uu=Ct()+500,$o()))}break;case 13:El(function(){var _=Js(l,1);if(_!==null){var E=li();Vr(_,l,1,E)}}),zv(l,1)}},Dc=function(l){if(l.tag===13){var u=Js(l,134217728);if(u!==null){var f=li();Vr(u,l,134217728,f)}zv(l,134217728)}},Jh=function(l){if(l.tag===13){var u=Yo(l),f=Js(l,u);if(f!==null){var _=li();Vr(f,l,u,_)}zv(l,u)}},ed=function(){return nt},td=function(l,u){var f=nt;try{return nt=l,u()}finally{nt=f}},si=function(l,u,f){switch(u){case"input":if(pi(l,f),u=f.name,f.type==="radio"&&u!=null){for(f=l;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll("input[name="+JSON.stringify(""+u)+'][type="radio"]'),u=0;u<f.length;u++){var _=f[u];if(_!==l&&_.form===l.form){var E=wm(_);if(!E)throw Error(t(90));js(_),pi(_,E)}}}break;case"textarea":bo(l,f);break;case"select":u=f.value,u!=null&&vn(l,!!f.multiple,u,!1)}},sr=Dv,Cn=El;var YO={usingClientEntryPoint:!1,Events:[md,Zc,wm,Cr,Yt,Dv]},Cd={findFiberByHostInstance:dl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ZO={bundleType:Cd.bundleType,version:Cd.version,rendererPackageName:Cd.rendererPackageName,rendererConfig:Cd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:N.ReactCurrentDispatcher,findHostInstanceByFiber:function(l){return l=im(l),l===null?null:l.stateNode},findFiberByHostInstance:Cd.findFiberByHostInstance||HO,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var sp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!sp.isDisabled&&sp.supportsFiber)try{il=sp.inject(ZO),Di=sp}catch{}}return xi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=YO,xi.createPortal=function(l,u){var f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!$v(u))throw Error(t(200));return qO(l,u,null,f)},xi.createRoot=function(l,u){if(!$v(l))throw Error(t(299));var f=!1,_="",E=C2;return u!=null&&(u.unstable_strictMode===!0&&(f=!0),u.identifierPrefix!==void 0&&(_=u.identifierPrefix),u.onRecoverableError!==void 0&&(E=u.onRecoverableError)),u=Uv(l,1,!1,null,null,f,!1,_,E),l[Xs]=u.current,dd(l.nodeType===8?l.parentNode:l),new Bv(u)},xi.findDOMNode=function(l){if(l==null)return null;if(l.nodeType===1)return l;var u=l._reactInternals;if(u===void 0)throw typeof l.render=="function"?Error(t(188)):(l=Object.keys(l).join(","),Error(t(268,l)));return l=im(u),l=l===null?null:l.stateNode,l},xi.flushSync=function(l){return El(l)},xi.hydrate=function(l,u,f){if(!ip(u))throw Error(t(200));return rp(null,l,u,!0,f)},xi.hydrateRoot=function(l,u,f){if(!$v(l))throw Error(t(405));var _=f!=null&&f.hydratedSources||null,E=!1,x="",b=C2;if(f!=null&&(f.unstable_strictMode===!0&&(E=!0),f.identifierPrefix!==void 0&&(x=f.identifierPrefix),f.onRecoverableError!==void 0&&(b=f.onRecoverableError)),u=R2(u,null,l,1,f??null,E,!1,x,b),l[Xs]=u.current,dd(l),_)for(l=0;l<_.length;l++)f=_[l],E=f._getVersion,E=E(f._source),u.mutableSourceEagerHydrationData==null?u.mutableSourceEagerHydrationData=[f,E]:u.mutableSourceEagerHydrationData.push(f,E);return new np(u)},xi.render=function(l,u,f){if(!ip(u))throw Error(t(200));return rp(null,l,u,!1,f)},xi.unmountComponentAtNode=function(l){if(!ip(l))throw Error(t(40));return l._reactRootContainer?(El(function(){rp(null,null,l,!1,function(){l._reactRootContainer=null,l[Xs]=null})}),!0):!1},xi.unstable_batchedUpdates=Dv,xi.unstable_renderSubtreeIntoContainer=function(l,u,f,_){if(!ip(f))throw Error(t(200));if(l==null||l._reactInternals===void 0)throw Error(t(38));return rp(l,u,f,!1,_)},xi.version="18.3.1-next-f1338f8080-20240426",xi}var F2;function s5(){if(F2)return qv.exports;F2=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),qv.exports=r5(),qv.exports}var j2;function o5(){if(j2)return op;j2=1;var n=s5();return op.createRoot=n.createRoot,op.hydrateRoot=n.hydrateRoot,op}var a5=o5();const l5=Uw(a5);var ne=_g();const c5=Uw(ne),Ti={ADD:"add",REMOVE:"remove"},oh={PROPERTYCHANGE:"propertychange"},He={CHANGE:"change",ERROR:"error",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",TOUCHMOVE:"touchmove",WHEEL:"wheel"};class y_{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}function u5(n,e,t){let i,r;t=t||ho;let s=0,o=n.length,a=!1;for(;s<o;)i=s+(o-s>>1),r=+t(n[i],e),r<0?s=i+1:(o=i,a=!r);return a?s:~s}function ho(n,e){return n>e?1:n<e?-1:0}function h5(n,e){return n<e?1:n>e?-1:0}function zw(n,e,t){if(n[0]<=e)return 0;const i=n.length;if(e<=n[i-1])return i-1;if(typeof t=="function"){for(let r=1;r<i;++r){const s=n[r];if(s===e)return r;if(s<e)return t(e,n[r-1],s)>0?r-1:r}return i-1}if(t>0){for(let r=1;r<i;++r)if(n[r]<e)return r-1;return i-1}if(t<0){for(let r=1;r<i;++r)if(n[r]<=e)return r;return i-1}for(let r=1;r<i;++r){if(n[r]==e)return r;if(n[r]<e)return n[r-1]-e<e-n[r]?r-1:r}return i-1}function d5(n,e,t){for(;e<t;){const i=n[e];n[e]=n[t],n[t]=i,++e,--t}}function v_(n,e){const t=Array.isArray(e)?e:[e],i=t.length;for(let r=0;r<i;r++)n[n.length]=t[r]}function qa(n,e){const t=n.length;if(t!==e.length)return!1;for(let i=0;i<t;i++)if(n[i]!==e[i])return!1;return!0}function f5(n,e,t){const i=e||ho;return n.every(function(r,s){if(s===0)return!0;const o=i(n[s-1],r);return!(o>0||o===0)})}function Mf(){return!0}function E_(){return!1}function bf(){}function KM(n){let e,t,i;return function(){const r=Array.prototype.slice.call(arguments);return(!t||this!==i||!qa(r,t))&&(i=this,t=r,e=n.apply(this,arguments)),e}}function qM(n){function e(){let t;try{t=n()}catch(i){return Promise.reject(i)}return t instanceof Promise?t:Promise.resolve(t)}return e()}function yg(n){for(const e in n)delete n[e]}function ah(n){let e;for(e in n)return!1;return!e}class Io{constructor(e){this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}let vg=class extends y_{constructor(e){super(),this.eventTarget_=e,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(e,t){if(!e||!t)return;const i=this.listeners_||(this.listeners_={}),r=i[e]||(i[e]=[]);r.includes(t)||r.push(t)}dispatchEvent(e){const t=typeof e=="string",i=t?e:e.type,r=this.listeners_&&this.listeners_[i];if(!r)return;const s=t?new Io(e):e;s.target||(s.target=this.eventTarget_||this);const o=this.dispatching_||(this.dispatching_={}),a=this.pendingRemovals_||(this.pendingRemovals_={});i in o||(o[i]=0,a[i]=0),++o[i];let c;for(let h=0,d=r.length;h<d;++h)if("handleEvent"in r[h]?c=r[h].handleEvent(s):c=r[h].call(this,s),c===!1||s.propagationStopped){c=!1;break}if(--o[i]===0){let h=a[i];for(delete a[i];h--;)this.removeEventListener(i,bf);delete o[i]}return c}disposeInternal(){this.listeners_&&yg(this.listeners_)}getListeners(e){return this.listeners_&&this.listeners_[e]||void 0}hasListener(e){return this.listeners_?e?e in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(e,t){if(!this.listeners_)return;const i=this.listeners_[e];if(!i)return;const r=i.indexOf(t);r!==-1&&(this.pendingRemovals_&&e in this.pendingRemovals_?(i[r]=bf,++this.pendingRemovals_[e]):(i.splice(r,1),i.length===0&&delete this.listeners_[e]))}};function lt(n,e,t,i,r){if(r){const o=t;t=function(a){return n.removeEventListener(e,t),o.call(i??this,a)}}else i&&i!==n&&(t=t.bind(i));const s={target:n,type:e,listener:t};return n.addEventListener(e,t),s}function c0(n,e,t,i){return lt(n,e,t,i,!0)}function Ft(n){n&&n.target&&(n.target.removeEventListener(n.type,n.listener),yg(n))}class Eg extends vg{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(He.CHANGE)}getRevision(){return this.revision_}onInternal(e,t){if(Array.isArray(e)){const i=e.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=lt(this,e[s],t);return r}return lt(this,e,t)}onceInternal(e,t){let i;if(Array.isArray(e)){const r=e.length;i=new Array(r);for(let s=0;s<r;++s)i[s]=c0(this,e[s],t)}else i=c0(this,e,t);return t.ol_key=i,i}unInternal(e,t){const i=t.ol_key;if(i)g5(i);else if(Array.isArray(e))for(let r=0,s=e.length;r<s;++r)this.removeEventListener(e[r],t);else this.removeEventListener(e,t)}}Eg.prototype.on;Eg.prototype.once;Eg.prototype.un;function g5(n){if(Array.isArray(n))for(let e=0,t=n.length;e<t;++e)Ft(n[e]);else Ft(n)}function at(){throw new Error("Unimplemented abstract method.")}let m5=0;function ct(n){return n.ol_uid||(n.ol_uid=String(++m5))}class G2 extends Io{constructor(e,t,i){super(e),this.key=t,this.oldValue=i}}class Os extends Eg{constructor(e){super(),this.on,this.once,this.un,ct(this),this.values_=null,e!==void 0&&this.setProperties(e)}get(e){let t;return this.values_&&this.values_.hasOwnProperty(e)&&(t=this.values_[e]),t}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(e,t){let i;i=`change:${e}`,this.hasListener(i)&&this.dispatchEvent(new G2(i,e,t)),i=oh.PROPERTYCHANGE,this.hasListener(i)&&this.dispatchEvent(new G2(i,e,t))}addChangeListener(e,t){this.addEventListener(`change:${e}`,t)}removeChangeListener(e,t){this.removeEventListener(`change:${e}`,t)}set(e,t,i){const r=this.values_||(this.values_={});if(i)r[e]=t;else{const s=r[e];r[e]=t,s!==t&&this.notify(e,s)}}setProperties(e,t){for(const i in e)this.set(i,e[i],t)}applyProperties(e){e.values_&&Object.assign(this.values_||(this.values_={}),e.values_)}unset(e,t){if(this.values_&&e in this.values_){const i=this.values_[e];delete this.values_[e],ah(this.values_)&&(this.values_=null),t||this.notify(e,i)}}}const U2={LENGTH:"length"};class ap extends Io{constructor(e,t,i){super(e),this.element=t,this.index=i}}class Er extends Os{constructor(e,t){if(super(),this.on,this.once,this.un,t=t||{},this.unique_=!!t.unique,this.array_=e??[],this.unique_)for(let i=1,r=this.array_.length;i<r;++i)this.assertUnique_(this.array_[i],i);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(e){for(let t=0,i=e.length;t<i;++t)this.push(e[t]);return this}forEach(e){const t=this.array_;for(let i=0,r=t.length;i<r;++i)e(t[i],i,t)}getArray(){return this.array_}item(e){return this.array_[e]}getLength(){return this.get(U2.LENGTH)}insertAt(e,t){if(e<0||e>this.getLength())throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t),this.array_.splice(e,0,t),this.updateLength_(),this.dispatchEvent(new ap(Ti.ADD,t,e))}pop(){return this.removeAt(this.getLength()-1)}push(e){const t=this.getLength();return this.insertAt(t,e),this.getLength()}remove(e){const t=this.array_;for(let i=0,r=t.length;i<r;++i)if(t[i]===e)return this.removeAt(i)}removeAt(e){if(e<0||e>=this.getLength())return;const t=this.array_[e];return this.array_.splice(e,1),this.updateLength_(),this.dispatchEvent(new ap(Ti.REMOVE,t,e)),t}setAt(e,t){const i=this.getLength();if(e>=i){this.insertAt(e,t);return}if(e<0)throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t,e);const r=this.array_[e];this.array_[e]=t,this.dispatchEvent(new ap(Ti.REMOVE,r,e)),this.dispatchEvent(new ap(Ti.ADD,t,e))}updateLength_(){this.set(U2.LENGTH,this.array_.length)}assertUnique_(e,t){const i=this.array_;for(let r=0,s=i.length;r<s;++r)if(i[r]===e&&r!==t)throw new Error("Duplicate item added to a unique collection")}}function _t(n,e){if(!n)throw new Error(e)}let u0=class HM extends Os{constructor(e){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),e)if(typeof e.getSimplifiedGeometry=="function"){const t=e;this.setGeometry(t)}else{const t=e;this.setProperties(t)}}clone(){const e=new HM(this.hasProperties()?this.getProperties():null);e.setGeometryName(this.getGeometryName());const t=this.getGeometry();t&&e.setGeometry(t.clone());const i=this.getStyle();return i&&e.setStyle(i),e}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(Ft(this.geometryChangeKey_),this.geometryChangeKey_=null);const e=this.getGeometry();e&&(this.geometryChangeKey_=lt(e,He.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(e){this.set(this.geometryName_,e)}setStyle(e){this.style_=e,this.styleFunction_=e?p5(e):void 0,this.changed()}setId(e){this.id_=e,this.changed()}setGeometryName(e){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=e,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}};function p5(n){if(typeof n=="function")return n;let e;return Array.isArray(n)?e=n:(_t(typeof n.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),e=[n]),function(){return e}}const Tn={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function z2(n){const e=Zi();for(let t=0,i=n.length;t<i;++t)cf(e,n[t]);return e}function kf(n,e,t){return t?(t[0]=n[0]-e,t[1]=n[1]-e,t[2]=n[2]+e,t[3]=n[3]+e,t):[n[0]-e,n[1]-e,n[2]+e,n[3]+e]}function XM(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n.slice()}function Bw(n,e,t){let i,r;return e<n[0]?i=n[0]-e:n[2]<e?i=e-n[2]:i=0,t<n[1]?r=n[1]-t:n[3]<t?r=t-n[3]:r=0,i*i+r*r}function lh(n,e){return YM(n,e[0],e[1])}function $d(n,e){return n[0]<=e[0]&&e[2]<=n[2]&&n[1]<=e[1]&&e[3]<=n[3]}function YM(n,e,t){return n[0]<=e&&e<=n[2]&&n[1]<=t&&t<=n[3]}function aE(n,e){const t=n[0],i=n[1],r=n[2],s=n[3],o=e[0],a=e[1];let c=Tn.UNKNOWN;return o<t?c=c|Tn.LEFT:o>r&&(c=c|Tn.RIGHT),a<i?c=c|Tn.BELOW:a>s&&(c=c|Tn.ABOVE),c===Tn.UNKNOWN&&(c=Tn.INTERSECTING),c}function Zi(){return[1/0,1/0,-1/0,-1/0]}function Da(n,e,t,i,r){return r?(r[0]=n,r[1]=e,r[2]=t,r[3]=i,r):[n,e,t,i]}function w_(n){return Da(1/0,1/0,-1/0,-1/0,n)}function ZM(n,e){const t=n[0],i=n[1];return Da(t,i,t,i,e)}function $w(n,e,t,i,r){const s=w_(r);return QM(s,n,e,t,i)}function Lf(n,e){return n[0]==e[0]&&n[2]==e[2]&&n[1]==e[1]&&n[3]==e[3]}function _5(n,e){return e[0]<n[0]&&(n[0]=e[0]),e[2]>n[2]&&(n[2]=e[2]),e[1]<n[1]&&(n[1]=e[1]),e[3]>n[3]&&(n[3]=e[3]),n}function cf(n,e){e[0]<n[0]&&(n[0]=e[0]),e[0]>n[2]&&(n[2]=e[0]),e[1]<n[1]&&(n[1]=e[1]),e[1]>n[3]&&(n[3]=e[1])}function QM(n,e,t,i,r){for(;t<i;t+=r)y5(n,e[t],e[t+1]);return n}function y5(n,e,t){n[0]=Math.min(n[0],e),n[1]=Math.min(n[1],t),n[2]=Math.max(n[2],e),n[3]=Math.max(n[3],t)}function JM(n,e){let t;return t=e(x_(n)),t||(t=e(S_(n)),t)||(t=e(T_(n)),t)||(t=e(wc(n)),t)?t:!1}function lE(n){let e=0;return I_(n)||(e=ut(n)*ei(n)),e}function x_(n){return[n[0],n[1]]}function S_(n){return[n[2],n[1]]}function tc(n){return[(n[0]+n[2])/2,(n[1]+n[3])/2]}function v5(n,e){let t;if(e==="bottom-left")t=x_(n);else if(e==="bottom-right")t=S_(n);else if(e==="top-left")t=wc(n);else if(e==="top-right")t=T_(n);else throw new Error("Invalid corner");return t}function cE(n,e,t,i,r){const[s,o,a,c,h,d,g,m]=eb(n,e,t,i);return Da(Math.min(s,a,h,g),Math.min(o,c,d,m),Math.max(s,a,h,g),Math.max(o,c,d,m),r)}function eb(n,e,t,i){const r=e*i[0]/2,s=e*i[1]/2,o=Math.cos(t),a=Math.sin(t),c=r*o,h=r*a,d=s*o,g=s*a,m=n[0],v=n[1];return[m-c+g,v-h-d,m-c-g,v-h+d,m+c-g,v+h+d,m+c+g,v+h-d,m-c+g,v-h-d]}function ei(n){return n[3]-n[1]}function Hl(n,e,t){const i=t||Zi();return Ri(n,e)?(n[0]>e[0]?i[0]=n[0]:i[0]=e[0],n[1]>e[1]?i[1]=n[1]:i[1]=e[1],n[2]<e[2]?i[2]=n[2]:i[2]=e[2],n[3]<e[3]?i[3]=n[3]:i[3]=e[3]):w_(i),i}function wc(n){return[n[0],n[3]]}function T_(n){return[n[2],n[3]]}function ut(n){return n[2]-n[0]}function Ri(n,e){return n[0]<=e[2]&&n[2]>=e[0]&&n[1]<=e[3]&&n[3]>=e[1]}function I_(n){return n[2]<n[0]||n[3]<n[1]}function E5(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n}function w5(n,e,t){let i=!1;const r=aE(n,e),s=aE(n,t);if(r===Tn.INTERSECTING||s===Tn.INTERSECTING)i=!0;else{const o=n[0],a=n[1],c=n[2],h=n[3],d=e[0],g=e[1],m=t[0],v=t[1],y=(v-g)/(m-d);let T,w;s&Tn.ABOVE&&!(r&Tn.ABOVE)&&(T=m-(v-h)/y,i=T>=o&&T<=c),!i&&s&Tn.RIGHT&&!(r&Tn.RIGHT)&&(w=v-(m-c)*y,i=w>=a&&w<=h),!i&&s&Tn.BELOW&&!(r&Tn.BELOW)&&(T=m-(v-a)/y,i=T>=o&&T<=c),!i&&s&Tn.LEFT&&!(r&Tn.LEFT)&&(w=v-(m-o)*y,i=w>=a&&w<=h)}return i}function tb(n,e){const t=e.getExtent(),i=tc(n);if(e.canWrapX()&&(i[0]<t[0]||i[0]>=t[2])){const r=ut(t),o=Math.floor((i[0]-t[0])/r)*r;n[0]-=o,n[2]-=o}return n}function nb(n,e,t){if(e.canWrapX()){const i=e.getExtent();if(!isFinite(n[0])||!isFinite(n[2]))return[[i[0],n[1],i[2],n[3]]];tb(n,e);const r=ut(i);if(ut(n)>r&&!t)return[[i[0],n[1],i[2],n[3]]];if(n[0]<i[0])return[[n[0]+r,n[1],i[2],n[3]],[i[0],n[1],n[2],n[3]]];if(n[2]>i[2])return[[n[0],n[1],i[2],n[3]],[i[0],n[1],n[2]-r,n[3]]]}return[n]}function kt(n,e,t){return Math.min(Math.max(n,e),t)}function x5(n,e,t,i,r,s){const o=r-t,a=s-i;if(o!==0||a!==0){const c=((n-t)*o+(e-i)*a)/(o*o+a*a);c>1?(t=r,i=s):c>0&&(t+=o*c,i+=a*c)}return Hu(n,e,t,i)}function Hu(n,e,t,i){const r=t-n,s=i-e;return r*r+s*s}function S5(n){const e=n.length;for(let i=0;i<e;i++){let r=i,s=Math.abs(n[i][i]);for(let a=i+1;a<e;a++){const c=Math.abs(n[a][i]);c>s&&(s=c,r=a)}if(s===0)return null;const o=n[r];n[r]=n[i],n[i]=o;for(let a=i+1;a<e;a++){const c=-n[a][i]/n[i][i];for(let h=i;h<e+1;h++)i==h?n[a][h]=0:n[a][h]+=c*n[i][h]}}const t=new Array(e);for(let i=e-1;i>=0;i--){t[i]=n[i][e]/n[i][i];for(let r=i-1;r>=0;r--)n[r][e]-=n[r][i]*t[i]}return t}function B2(n){return n*180/Math.PI}function Aa(n){return n*Math.PI/180}function Ra(n,e){const t=n%e;return t*e<0?t+e:t}function Ki(n,e,t){return n+t*(e-n)}function wg(n,e){const t=Math.pow(10,e);return Math.round(n*t)/t}function $2(n,e){return Math.round(wg(n,e))}function lp(n,e){return Math.floor(wg(n,e))}function cp(n,e){return Math.ceil(wg(n,e))}function uE(n,e,t){if(n>=e&&n<t)return n;const i=t-e;return((n-e)%i+i)%i+e}function ib(n,e){const t=(""+n).split("."),i=(""+e).split(".");for(let r=0;r<Math.max(t.length,i.length);r++){const s=parseInt(t[r]||"0",10),o=parseInt(i[r]||"0",10);if(s>o)return 1;if(o>s)return-1}return 0}function T5(n,e){return n[0]+=+e[0],n[1]+=+e[1],n}function h0(n,e){let t=!0;for(let i=n.length-1;i>=0;--i)if(n[i]!=e[i]){t=!1;break}return t}function Ww(n,e){const t=Math.cos(e),i=Math.sin(e),r=n[0]*t-n[1]*i,s=n[1]*t+n[0]*i;return n[0]=r,n[1]=s,n}function I5(n,e){return n[0]*=e,n[1]*=e,n}function rb(n,e){if(e.canWrapX()){const t=ut(e.getExtent()),i=sb(n,e,t);i&&(n[0]-=i*t)}return n}function sb(n,e,t){const i=e.getExtent();let r=0;return e.canWrapX()&&(n[0]<i[0]||n[0]>i[2])&&(t=t||ut(i),r=Math.floor((n[0]-i[0])/t)),r}function ob(...n){console.warn(...n)}const Kw={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};let qw=class{constructor(e){this.code_=e.code,this.units_=e.units,this.extent_=e.extent!==void 0?e.extent:null,this.worldExtent_=e.worldExtent!==void 0?e.worldExtent:null,this.axisOrientation_=e.axisOrientation!==void 0?e.axisOrientation:"enu",this.global_=e.global!==void 0?e.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||Kw[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(e){this.global_=e,this.canWrapX_=!!(e&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(e){this.defaultTileGrid_=e}setExtent(e){this.extent_=e,this.canWrapX_=!!(this.global_&&e)}setWorldExtent(e){this.worldExtent_=e}setGetPointResolution(e){this.getPointResolutionFunc_=e}getPointResolutionFunc(){return this.getPointResolutionFunc_}};const xg=6378137,Du=Math.PI*xg,A5=[-Du,-Du,Du,Du],R5=[-180,-85,180,85],up=xg*Math.log(Math.tan(Math.PI/2));class du extends qw{constructor(e){super({code:e,units:"m",extent:A5,global:!0,worldExtent:R5,getPointResolution:function(t,i){return t/Math.cosh(i[1]/xg)}})}}const W2=[new du("EPSG:3857"),new du("EPSG:102100"),new du("EPSG:102113"),new du("EPSG:900913"),new du("http://www.opengis.net/def/crs/EPSG/0/3857"),new du("http://www.opengis.net/gml/srs/epsg.xml#3857")];function P5(n,e,t,i){const r=n.length;t=t>1?t:2,i=i??t,e===void 0&&(t>2?e=n.slice():e=new Array(r));for(let s=0;s<r;s+=i){e[s]=Du*n[s]/180;let o=xg*Math.log(Math.tan(Math.PI*(+n[s+1]+90)/360));o>up?o=up:o<-up&&(o=-up),e[s+1]=o}return e}function C5(n,e,t,i){const r=n.length;t=t>1?t:2,i=i??t,e===void 0&&(t>2?e=n.slice():e=new Array(r));for(let s=0;s<r;s+=i)e[s]=180*n[s]/Du,e[s+1]=360*Math.atan(Math.exp(n[s+1]/xg))/Math.PI-90;return e}const M5=6378137,K2=[-180,-90,180,90],b5=Math.PI*M5/180;class Tl extends qw{constructor(e,t){super({code:e,units:"degrees",extent:K2,axisOrientation:t,global:!0,metersPerUnit:b5,worldExtent:K2})}}const q2=[new Tl("CRS:84"),new Tl("EPSG:4326","neu"),new Tl("urn:ogc:def:crs:OGC:1.3:CRS84"),new Tl("urn:ogc:def:crs:OGC:2:84"),new Tl("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new Tl("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new Tl("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let hE={};function k5(n){return hE[n]||hE[n.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function L5(n,e){hE[n]=e}let Xu={};function nc(n,e,t){const i=n.getCode(),r=e.getCode();i in Xu||(Xu[i]={}),Xu[i][r]=t}function Yv(n,e){return n in Xu&&e in Xu[n]?Xu[n][e]:null}const d0=.9996,Tr=.00669438,A_=Tr*Tr,R_=A_*Tr,Ul=Tr/(1-Tr),H2=Math.sqrt(1-Tr),ch=(1-H2)/(1+H2),ab=ch*ch,Hw=ab*ch,Xw=Hw*ch,lb=Xw*ch,cb=1-Tr/4-3*A_/64-5*R_/256,N5=3*Tr/8+3*A_/32+45*R_/1024,D5=15*A_/256+45*R_/1024,O5=35*R_/3072,V5=3/2*ch-27/32*Hw+269/512*lb,F5=21/16*ab-55/32*Xw,j5=151/96*Hw-417/128*lb,G5=1097/512*Xw,f0=6378137;function U5(n,e,t){const i=n-5e5,o=(t.north?e:e-1e7)/d0/(f0*cb),a=o+V5*Math.sin(2*o)+F5*Math.sin(4*o)+j5*Math.sin(6*o)+G5*Math.sin(8*o),c=Math.sin(a),h=c*c,d=Math.cos(a),g=c/d,m=g*g,v=m*m,y=1-Tr*h,T=Math.sqrt(1-Tr*h),w=f0/T,A=(1-Tr)/y,P=Ul*d**2,C=P*P,N=i/(w*d0),D=N*N,z=D*N,k=z*N,R=k*N,L=R*N,F=a-g/A*(D/2-k/24*(5+3*m+10*P-4*C-9*Ul))+L/720*(61+90*m+298*P+45*v-252*Ul-3*C);let j=(N-z/6*(1+2*m+P)+R/120*(5-2*P+28*m-3*C+8*Ul+24*v))/d;return j=uE(j+Aa(ub(t.number)),-Math.PI,Math.PI),[B2(j),B2(F)]}const X2=-80,Y2=84,z5=-180,B5=180;function $5(n,e,t){n=uE(n,z5,B5),e<X2?e=X2:e>Y2&&(e=Y2);const i=Aa(e),r=Math.sin(i),s=Math.cos(i),o=r/s,a=o*o,c=a*a,h=Aa(n),d=ub(t.number),g=Aa(d),m=f0/Math.sqrt(1-Tr*r**2),v=Ul*s**2,y=s*uE(h-g,-Math.PI,Math.PI),T=y*y,w=T*y,A=w*y,P=A*y,C=P*y,N=f0*(cb*i-N5*Math.sin(2*i)+D5*Math.sin(4*i)-O5*Math.sin(6*i)),D=d0*m*(y+w/6*(1-a+v)+P/120*(5-18*a+c+72*v-58*Ul))+5e5;let z=d0*(N+m*o*(T/2+A/24*(5-a+9*v+4*v**2)+C/720*(61-58*a+c+600*v-330*Ul)));return t.north||(z+=1e7),[D,z]}function ub(n){return(n-1)*6-180+3}const W5=[/^EPSG:(\d+)$/,/^urn:ogc:def:crs:EPSG::(\d+)$/,/^http:\/\/www\.opengis\.net\/def\/crs\/EPSG\/0\/(\d+)$/];function hb(n){let e=0;for(const r of W5){const s=n.match(r);if(s){e=parseInt(s[1]);break}}if(!e)return null;let t=0,i=!1;return e>32700&&e<32761?t=e-32700:e>32600&&e<32661&&(i=!0,t=e-32600),t?{number:t,north:i}:null}function Z2(n,e){return function(t,i,r,s){const o=t.length;r=r>1?r:2,s=s??r,i||(r>2?i=t.slice():i=new Array(o));for(let a=0;a<o;a+=s){const c=t[a],h=t[a+1],d=n(c,h,e);i[a]=d[0],i[a+1]=d[1]}return i}}function K5(n){return hb(n)?new qw({code:n,units:"m"}):null}function q5(n){const e=hb(n.getCode());return e?{forward:Z2($5,e),inverse:Z2(U5,e)}:null}const H5=63710088e-1;function Q2(n,e,t){t=t||H5;const i=Aa(n[1]),r=Aa(e[1]),s=(r-i)/2,o=Aa(e[0]-n[0])/2,a=Math.sin(s)*Math.sin(s)+Math.sin(o)*Math.sin(o)*Math.cos(i)*Math.cos(r);return 2*t*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))}const X5=[q5],Y5=[K5];let dE=!0;function db(n){dE=!1}function Yw(n,e){if(e!==void 0){for(let t=0,i=n.length;t<i;++t)e[t]=n[t];e=e}else e=n.slice();return e}function fE(n){L5(n.getCode(),n),nc(n,n,Yw)}function Z5(n){n.forEach(fE)}function Un(n){if(typeof n!="string")return n;const e=k5(n);if(e)return e;for(const t of Y5){const i=t(n);if(i)return i}return null}function J2(n,e,t,i){n=Un(n);let r;const s=n.getPointResolutionFunc();if(s)r=s(e,t);else{const o=n.getUnits();if(o=="degrees"&&!i||i=="degrees")r=e;else{const a=Qw(n,Un("EPSG:4326"));if(!a&&o!=="degrees")r=e*n.getMetersPerUnit();else{let h=[t[0]-e/2,t[1],t[0]+e/2,t[1],t[0],t[1]-e/2,t[0],t[1]+e/2];h=a(h,h,2);const d=Q2(h.slice(0,2),h.slice(2,4)),g=Q2(h.slice(4,6),h.slice(6,8));r=(d+g)/2}const c=n.getMetersPerUnit();c!==void 0&&(r/=c)}}return r}function eA(n){Z5(n),n.forEach(function(e){n.forEach(function(t){e!==t&&nc(e,t,Yw)})})}function Q5(n,e,t,i){n.forEach(function(r){e.forEach(function(s){nc(r,s,t),nc(s,r,i)})})}function Zw(n,e){return n?typeof n=="string"?Un(n):n:Un(e)}function gE(n){return(function(e,t,i,r){const s=e.length;i=i!==void 0?i:2,r=r??i,t=t!==void 0?t:new Array(s);for(let o=0;o<s;o+=r){const a=n(e.slice(o,o+i)),c=a.length;for(let h=0,d=r;h<d;++h)t[o+h]=h>=c?e[o+h]:a[h]}return t})}function uie(n,e,t,i){const r=Un(n),s=Un(e);nc(r,s,gE(t)),nc(s,r,gE(i))}function ic(n,e){return db(),Sg(n,"EPSG:4326","EPSG:3857")}function Ou(n,e){const t=Sg(n,"EPSG:3857","EPSG:4326"),i=t[0];return(i<-180||i>180)&&(t[0]=Ra(i+180,360)-180),t}function Fp(n,e){if(n===e)return!0;const t=n.getUnits()===e.getUnits();return(n.getCode()===e.getCode()||Qw(n,e)===Yw)&&t}function Qw(n,e){const t=n.getCode(),i=e.getCode();let r=Yv(t,i);if(r)return r;let s=null,o=null;for(const c of X5)s||(s=c(n)),o||(o=c(e));if(!s&&!o)return null;const a="EPSG:4326";if(o)if(s)r=Zv(s.inverse,o.forward);else{const c=Yv(t,a);c&&(r=Zv(c,o.forward))}else{const c=Yv(a,i);c&&(r=Zv(s.inverse,c))}return r&&(fE(n),fE(e),nc(n,e,r)),r}function Zv(n,e){return function(t,i,r,s){return i=n(t,i,r,s),e(i,i,r,s)}}function g0(n,e){const t=Un(n),i=Un(e);return Qw(t,i)}function Sg(n,e,t){const i=g0(e,t);if(!i){const r=Un(e).getCode(),s=Un(t).getCode();throw new Error(`No transform available between ${r} and ${s}`)}return i(n,void 0,n.length)}function mE(n,e){return n}function so(n,e){return dE&&!h0(n,[0,0])&&n[0]>=-180&&n[0]<=180&&n[1]>=-90&&n[1]<=90&&(dE=!1,ob("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),n}function fb(n,e){return n}function wa(n,e){return n}function hie(n,e,t){return function(i){let r,s;if(n.canWrapX()){const o=n.getExtent(),a=ut(o);i=i.slice(0),s=sb(i,n,a),s&&(i[0]=i[0]-s*a),i[0]=kt(i[0],o[0],o[2]),i[1]=kt(i[1],o[1],o[3]),r=t(i)}else r=t(i);return s&&e.canWrapX()&&(r[0]+=s*ut(e.getExtent())),r}}function J5(){eA(W2),eA(q2),Q5(q2,W2,P5,C5)}J5();new Array(6);function Hr(){return[1,0,0,1,0,0]}function e6(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n}function An(n,e){const t=e[0],i=e[1];return e[0]=n[0]*t+n[2]*i+n[4],e[1]=n[1]*t+n[3]*i+n[5],e}function yo(n,e,t,i,r,s,o,a){const c=Math.sin(s),h=Math.cos(s);return n[0]=i*h,n[1]=r*c,n[2]=-i*c,n[3]=r*h,n[4]=o*i*h-a*i*c+e,n[5]=o*r*c+a*r*h+t,n}function gb(n,e){const t=t6(e);_t(t!==0,"Transformation matrix cannot be inverted");const i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],c=e[5];return n[0]=o/t,n[1]=-r/t,n[2]=-s/t,n[3]=i/t,n[4]=(s*c-o*a)/t,n[5]=-(i*c-r*a)/t,n}function t6(n){return n[0]*n[3]-n[1]*n[2]}const n6=[1e5,1e5,1e5,1e5,2,2];function i6(n){return"matrix("+n.join(", ")+")"}function pE(n){return n.substring(7,n.length-1).split(",").map(parseFloat)}function r6(n,e){const t=pE(n),i=pE(e);for(let r=0;r<6;++r)if(Math.round((t[r]-i[r])*n6[r])!==0)return!1;return!0}function Pa(n,e,t,i,r,s,o){s=s||[],o=o||2;let a=0;for(let c=e;c<t;c+=i){const h=n[c],d=n[c+1];s[a++]=r[0]*h+r[2]*d+r[4],s[a++]=r[1]*h+r[3]*d+r[5];for(let g=2;g<o;g++)s[a++]=n[c+g]}return s&&s.length!=a&&(s.length=a),s}function mb(n,e,t,i,r,s,o){o=o||[];const a=Math.cos(r),c=Math.sin(r),h=s[0],d=s[1];let g=0;for(let m=e;m<t;m+=i){const v=n[m]-h,y=n[m+1]-d;o[g++]=h+v*a-y*c,o[g++]=d+v*c+y*a;for(let T=m+2;T<m+i;++T)o[g++]=n[T]}return o&&o.length!=g&&(o.length=g),o}function s6(n,e,t,i,r,s,o,a){a=a||[];const c=o[0],h=o[1];let d=0;for(let g=e;g<t;g+=i){const m=n[g]-c,v=n[g+1]-h;a[d++]=c+r*m,a[d++]=h+s*v;for(let y=g+2;y<g+i;++y)a[d++]=n[y]}return a&&a.length!=d&&(a.length=d),a}function o6(n,e,t,i,r,s,o){o=o||[];let a=0;for(let c=e;c<t;c+=i){o[a++]=n[c]+r,o[a++]=n[c+1]+s;for(let h=c+2;h<c+i;++h)o[a++]=n[h]}return o&&o.length!=a&&(o.length=a),o}const tA=Hr(),a6=[NaN,NaN];class l6 extends Os{constructor(){super(),this.extent_=Zi(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=KM((e,t,i)=>{if(!i)return this.getSimplifiedGeometry(t);const r=this.clone();return r.applyTransform(i),r.getSimplifiedGeometry(t)})}simplifyTransformed(e,t){return this.simplifyTransformedInternal(this.getRevision(),e,t)}clone(){return at()}closestPointXY(e,t,i,r){return at()}containsXY(e,t){return this.closestPointXY(e,t,a6,Number.MIN_VALUE)===0}getClosestPoint(e,t){return t=t||[NaN,NaN],this.closestPointXY(e[0],e[1],t,1/0),t}intersectsCoordinate(e){return this.containsXY(e[0],e[1])}computeExtent(e){return at()}getExtent(e){if(this.extentRevision_!=this.getRevision()){const t=this.computeExtent(this.extent_);(isNaN(t[0])||isNaN(t[1]))&&w_(t),this.extentRevision_=this.getRevision()}return E5(this.extent_,e)}rotate(e,t){at()}scale(e,t,i){at()}simplify(e){return this.getSimplifiedGeometry(e*e)}getSimplifiedGeometry(e){return at()}getType(){return at()}applyTransform(e){at()}intersectsExtent(e){return at()}translate(e,t){at()}transform(e,t){const i=Un(e),r=i.getUnits()=="tile-pixels"?function(s,o,a){const c=i.getExtent(),h=i.getWorldExtent(),d=ei(h)/ei(c);yo(tA,h[0],h[3],d,-d,0,0,0);const g=Pa(s,0,s.length,a,tA,o),m=g0(i,t);return m?m(g,g,a):g}:g0(i,t);return this.applyTransform(r),this}}class P_ extends l6{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(e){return $w(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinates(){return at()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const t=this.getSimplifiedGeometryInternal(e);return t.getFlatCoordinates().length<this.flatCoordinates.length?t:(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getSimplifiedGeometryInternal(e){return this}getStride(){return this.stride}setFlatCoordinates(e,t){this.stride=nA(e),this.layout=e,this.flatCoordinates=t}setCoordinates(e,t){at()}setLayout(e,t,i){let r;if(e)r=nA(e);else{for(let s=0;s<i;++s){if(t.length===0){this.layout="XY",this.stride=2;return}t=t[0]}r=t.length,e=c6(r)}this.layout=e,this.stride=r}applyTransform(e){this.flatCoordinates&&(e(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(e,t){const i=this.getFlatCoordinates();if(i){const r=this.getStride();mb(i,0,i.length,r,e,t,i),this.changed()}}scale(e,t,i){t===void 0&&(t=e),i||(i=tc(this.getExtent()));const r=this.getFlatCoordinates();if(r){const s=this.getStride();s6(r,0,r.length,s,e,t,i,r),this.changed()}}translate(e,t){const i=this.getFlatCoordinates();if(i){const r=this.getStride();o6(i,0,i.length,r,e,t,i),this.changed()}}}function c6(n){let e;return n==2?e="XY":n==3?e="XYZ":n==4&&(e="XYZM"),e}function nA(n){let e;return n=="XY"?e=2:n=="XYZ"||n=="XYM"?e=3:n=="XYZM"&&(e=4),e}function u6(n,e,t){const i=n.getFlatCoordinates();if(!i)return null;const r=n.getStride();return Pa(i,0,i.length,r,e,t)}function iA(n,e,t,i,r,s,o){const a=n[e],c=n[e+1],h=n[t]-a,d=n[t+1]-c;let g;if(h===0&&d===0)g=e;else{const m=((r-a)*h+(s-c)*d)/(h*h+d*d);if(m>1)g=t;else if(m>0){for(let v=0;v<i;++v)o[v]=Ki(n[e+v],n[t+v],m);o.length=i;return}else g=e}for(let m=0;m<i;++m)o[m]=n[g+m];o.length=i}function Jw(n,e,t,i,r){let s=n[e],o=n[e+1];for(e+=i;e<t;e+=i){const a=n[e],c=n[e+1],h=Hu(s,o,a,c);h>r&&(r=h),s=a,o=c}return r}function pb(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const a=t[s];r=Jw(n,e,a,i,r),e=a}return r}function die(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const a=t[s];r=pb(n,e,a,i,r),e=a[a.length-1]}return r}function ex(n,e,t,i,r,s,o,a,c,h,d){if(e==t)return h;let g,m;if(r===0){if(m=Hu(o,a,n[e],n[e+1]),m<h){for(g=0;g<i;++g)c[g]=n[e+g];return c.length=i,m}return h}d=d||[NaN,NaN];let v=e+i;for(;v<t;)if(iA(n,v-i,v,i,o,a,d),m=Hu(o,a,d[0],d[1]),m<h){for(h=m,g=0;g<i;++g)c[g]=d[g];c.length=i,v+=i}else v+=i*Math.max((Math.sqrt(m)-Math.sqrt(h))/r|0,1);if(s&&(iA(n,t-i,e,i,o,a,d),m=Hu(o,a,d[0],d[1]),m<h)){for(h=m,g=0;g<i;++g)c[g]=d[g];c.length=i}return h}function _b(n,e,t,i,r,s,o,a,c,h,d){d=d||[NaN,NaN];for(let g=0,m=t.length;g<m;++g){const v=t[g];h=ex(n,e,v,i,r,s,o,a,c,h,d),e=v}return h}function fie(n,e,t,i,r,s,o,a,c,h,d){d=d||[NaN,NaN];for(let g=0,m=t.length;g<m;++g){const v=t[g];h=_b(n,e,v,i,r,s,o,a,c,h,d),e=v[v.length-1]}return h}function h6(n,e,t,i){for(let r=0,s=t.length;r<s;++r)n[e++]=t[r];return e}function tx(n,e,t,i){for(let r=0,s=t.length;r<s;++r){const o=t[r];for(let a=0;a<i;++a)n[e++]=o[a]}return e}function yb(n,e,t,i,r){r=r||[];let s=0;for(let o=0,a=t.length;o<a;++o){const c=tx(n,e,t[o],i);r[s++]=c,e=c}return r.length=s,r}function gie(n,e,t,i,r){r=r||[];let s=0;for(let o=0,a=t.length;o<a;++o){const c=yb(n,e,t[o],i,r[s]);c.length===0&&(c[0]=e),r[s++]=c,e=c[c.length-1]}return r.length=s,r}function zl(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=e;o<t;o+=i)r[s++]=n.slice(o,o+i);return r.length=s,r}function m0(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=0,a=t.length;o<a;++o){const c=t[o];r[s++]=zl(n,e,c,i,r[s]),e=c}return r.length=s,r}function rA(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=0,a=t.length;o<a;++o){const c=t[o];r[s++]=c.length===1&&c[0]===e?[]:m0(n,e,c,i,r[s]),e=c[c.length-1]}return r.length=s,r}function _E(n,e,t,i,r,s,o){let a,c;const h=(t-e)/i;if(h===1)a=e;else if(h===2)a=e,c=r;else if(h!==0){let d=n[e],g=n[e+1],m=0;const v=[0];for(let w=e+i;w<t;w+=i){const A=n[w],P=n[w+1];m+=Math.sqrt((A-d)*(A-d)+(P-g)*(P-g)),v.push(m),d=A,g=P}const y=r*m,T=u5(v,y);T<0?(c=(y-v[-T-2])/(v[-T-1]-v[-T-2]),a=e+(-T-2)*i):a=e+T*i}o=o>1?o:2,s=s||new Array(o);for(let d=0;d<o;++d)s[d]=a===void 0?NaN:c===void 0?n[a+d]:Ki(n[a+d],n[a+i+d],c);return s}function yE(n,e,t,i,r,s){if(t==e)return null;let o;if(r<n[e+i-1])return s?(o=n.slice(e,e+i),o[i-1]=r,o):null;if(n[t-1]<r)return s?(o=n.slice(t-i,t),o[i-1]=r,o):null;if(r==n[e+i-1])return n.slice(e,e+i);let a=e/i,c=t/i;for(;a<c;){const m=a+c>>1;r<n[(m+1)*i-1]?c=m:a=m+1}const h=n[a*i-1];if(r==h)return n.slice((a-1)*i,(a-1)*i+i);const d=n[(a+1)*i-1],g=(r-h)/(d-h);o=[];for(let m=0;m<i-1;++m)o.push(Ki(n[(a-1)*i+m],n[a*i+m],g));return o.push(r),o}function mie(n,e,t,i,r,s,o){if(o)return yE(n,e,t[t.length-1],i,r,s);let a;if(r<n[i-1])return s?(a=n.slice(0,i),a[i-1]=r,a):null;if(n[n.length-1]<r)return s?(a=n.slice(n.length-i),a[i-1]=r,a):null;for(let c=0,h=t.length;c<h;++c){const d=t[c];if(e!=d){if(r<n[e+i-1])return null;if(r<=n[d-1])return yE(n,e,d,i,r,!1);e=d}}return null}function d6(n,e,t,i,r){return!JM(r,function(o){return!Bl(n,e,t,i,o[0],o[1])})}function Bl(n,e,t,i,r,s){let o=0,a=n[t-i],c=n[t-i+1];for(;e<t;e+=i){const h=n[e],d=n[e+1];c<=s?d>s&&(h-a)*(s-c)-(r-a)*(d-c)>0&&o++:d<=s&&(h-a)*(s-c)-(r-a)*(d-c)<0&&o--,a=h,c=d}return o!==0}function nx(n,e,t,i,r,s){if(t.length===0||!Bl(n,e,t[0],i,r,s))return!1;for(let o=1,a=t.length;o<a;++o)if(Bl(n,t[o-1],t[o],i,r,s))return!1;return!0}function pie(n,e,t,i,r,s){if(t.length===0)return!1;for(let o=0,a=t.length;o<a;++o){const c=t[o];if(nx(n,e,c,i,r,s))return!0;e=c[c.length-1]}return!1}function vb(n,e,t,i,r){let s;for(e+=i;e<t;e+=i)if(s=r(n.slice(e-i,e),n.slice(e,e+i)),s)return s;return!1}function C_(n,e,t,i,r,s){return s=s??QM(Zi(),n,e,t,i),Ri(r,s)?s[0]>=r[0]&&s[2]<=r[2]||s[1]>=r[1]&&s[3]<=r[3]?!0:vb(n,e,t,i,function(o,a){return w5(r,o,a)}):!1}function _ie(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){if(C_(n,e,t[s],i,r))return!0;e=t[s]}return!1}function Eb(n,e,t,i,r){return!!(C_(n,e,t,i,r)||Bl(n,e,t,i,r[0],r[1])||Bl(n,e,t,i,r[0],r[3])||Bl(n,e,t,i,r[2],r[1])||Bl(n,e,t,i,r[2],r[3]))}function wb(n,e,t,i,r){if(!Eb(n,e,t[0],i,r))return!1;if(t.length===1)return!0;for(let s=1,o=t.length;s<o;++s)if(d6(n,t[s-1],t[s],i,r)&&!C_(n,t[s-1],t[s],i,r))return!1;return!0}function yie(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const a=t[s];if(wb(n,e,a,i,r))return!0;e=a[a.length-1]}return!1}function xb(n,e,t,i){let r=n[e],s=n[e+1],o=0;for(let a=e+i;a<t;a+=i){const c=n[a],h=n[a+1];o+=Math.sqrt((c-r)*(c-r)+(h-s)*(h-s)),r=c,s=h}return o}function M_(n,e,t,i,r,s,o){const a=(t-e)/i;if(a<3){for(;e<t;e+=i)s[o++]=n[e],s[o++]=n[e+1];return o}const c=new Array(a);c[0]=1,c[a-1]=1;const h=[e,t-i];let d=0;for(;h.length>0;){const g=h.pop(),m=h.pop();let v=0;const y=n[m],T=n[m+1],w=n[g],A=n[g+1];for(let P=m+i;P<g;P+=i){const C=n[P],N=n[P+1],D=x5(C,N,y,T,w,A);D>v&&(d=P,v=D)}v>r&&(c[(d-e)/i]=1,m+i<d&&h.push(m,d),d+i<g&&h.push(d,g))}for(let g=0;g<a;++g)c[g]&&(s[o++]=n[e+g*i],s[o++]=n[e+g*i+1]);return o}function f6(n,e,t,i,r,s,o,a){for(let c=0,h=t.length;c<h;++c){const d=t[c];o=M_(n,e,d,i,r,s,o),a.push(o),e=d}return o}function Pl(n,e){return e*Math.round(n/e)}function g6(n,e,t,i,r,s,o){if(e==t)return o;let a=Pl(n[e],r),c=Pl(n[e+1],r);e+=i,s[o++]=a,s[o++]=c;let h,d;do if(h=Pl(n[e],r),d=Pl(n[e+1],r),e+=i,e==t)return s[o++]=h,s[o++]=d,o;while(h==a&&d==c);for(;e<t;){const g=Pl(n[e],r),m=Pl(n[e+1],r);if(e+=i,g==h&&m==d)continue;const v=h-a,y=d-c,T=g-a,w=m-c;if(v*w==y*T&&(v<0&&T<v||v==T||v>0&&T>v)&&(y<0&&w<y||y==w||y>0&&w>y)){h=g,d=m;continue}s[o++]=h,s[o++]=d,a=h,c=d,h=g,d=m}return s[o++]=h,s[o++]=d,o}function ix(n,e,t,i,r,s,o,a){for(let c=0,h=t.length;c<h;++c){const d=t[c];o=g6(n,e,d,i,r,s,o),a.push(o),e=d}return o}function vie(n,e,t,i,r,s,o,a){for(let c=0,h=t.length;c<h;++c){const d=t[c],g=[];o=ix(n,e,d,i,r,s,o,g),a.push(g),e=d[d.length-1]}return o}class p0 extends P_{constructor(e,t){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,t!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}appendCoordinate(e){v_(this.flatCoordinates,e),this.changed()}clone(){const e=new p0(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,i,r){return r<Bw(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Jw(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),ex(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,e,t,i,r))}forEachSegment(e){return vb(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinateAtM(e,t){return this.layout!="XYM"&&this.layout!="XYZM"?null:(t=t!==void 0?t:!1,yE(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t))}getCoordinates(){return zl(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(e,t){return _E(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,this.stride)}getLength(){return xb(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_??void 0),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(e){const t=[];return t.length=M_(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new p0(t,"XY")}getType(){return"LineString"}intersectsExtent(e){return C_(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,this.getExtent())}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=tx(this.flatCoordinates,0,e,this.stride),this.changed()}}let _0=class Sb extends P_{constructor(e,t){super(),this.setCoordinates(e,t)}clone(){const e=new Sb(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,i,r){const s=this.flatCoordinates,o=Hu(e,t,s[0],s[1]);if(o<r){const a=this.stride;for(let c=0;c<a;++c)i[c]=s[c];return i.length=a,o}return r}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(e){return ZM(this.flatCoordinates,e)}getType(){return"Point"}intersectsExtent(e){return YM(e,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(e,t){this.setLayout(t,e,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=h6(this.flatCoordinates,0,e,this.stride),this.changed()}};const wr={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"},rc=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",m6=rc.includes("safari")&&!rc.includes("chrom");m6&&(rc.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(rc));const p6=rc.includes("webkit")&&!rc.includes("edge"),Tb=rc.includes("macintosh"),_6=typeof devicePixelRatio<"u"?devicePixelRatio:1,qi=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,rx=typeof Image<"u"&&Image.prototype.decode,Ib=typeof createImageBitmap=="function",Ab=(function(){let n=!1;try{const e=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch{}return n})(),Be={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function mn(n,e,t,i){let r;return t&&t.length?r=t.shift():qi?r=new class extends OffscreenCanvas{style={}}(n??300,e??150):r=document.createElement("canvas"),n&&(r.width=n),e&&(r.height=e),r.getContext("2d",i)}let Qv;function y0(){return Qv||(Qv=mn(1,1)),Qv}function b_(n){const e=n.canvas;e.width=1,e.height=1,n.clearRect(0,0,1,1)}function sA(n,e){const t=e.parentNode;t&&t.replaceChild(n,e)}function y6(n){for(;n.lastChild;)n.lastChild.remove()}function v6(n,e){const t=n.childNodes;for(let i=0;;++i){const r=t[i],s=e[i];if(!r&&!s)break;if(r!==s){if(!r){n.appendChild(s);continue}if(!s){n.removeChild(r),--i;continue}n.insertBefore(s,r)}}}function Rb(){return new Proxy({childNodes:[],appendChild:function(e){return this.childNodes.push(e),e},remove:function(){},removeChild:function(e){const t=this.childNodes.indexOf(e);if(t===-1)throw new Error("Node to remove was not found");return this.childNodes.splice(t,1),e},insertBefore:function(e,t){const i=this.childNodes.indexOf(t);if(i===-1)throw new Error("Reference node not found");return this.childNodes.splice(i,0,e),e},style:{}},{get(e,t,i){return t==="firstElementChild"?e.childNodes.length>0?e.childNodes[0]:null:Reflect.get(e,t,i)}})}function xa(n){return typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas}const sx=[NaN,NaN,NaN,0];let Jv;function E6(){return Jv||(Jv=mn(1,1,void 0,{willReadFrequently:!0,desynchronized:!0})),Jv}const w6=/^rgba?\(\s*(\d+%?)\s+(\d+%?)\s+(\d+%?)(?:\s*\/\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,x6=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,S6=/^rgba?\(\s*(\d+%)\s*,\s*(\d+%)\s*,\s*(\d+%)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,T6=/^#([\da-f]{3,4}|[\da-f]{6}|[\da-f]{8})$/i;function hp(n,e){return n.endsWith("%")?Number(n.substring(0,n.length-1))/e:Number(n)}function uf(n){throw new Error('failed to parse "'+n+'" as color')}function Pb(n){if(n.toLowerCase().startsWith("rgb")){const s=n.match(x6)||n.match(w6)||n.match(S6);if(s){const o=s[4],a=100/255;return[kt(hp(s[1],a)+.5|0,0,255),kt(hp(s[2],a)+.5|0,0,255),kt(hp(s[3],a)+.5|0,0,255),o!==void 0?kt(hp(o,100),0,1):1]}uf(n)}if(n.startsWith("#")){if(T6.test(n)){const s=n.substring(1),o=s.length<=4?1:2,a=[0,0,0,255];for(let c=0,h=s.length;c<h;c+=o){let d=parseInt(s.substring(c,c+o),16);o===1&&(d+=d<<4),a[c/o]=d}return a[3]=a[3]/255,a}uf(n)}const e=E6();e.fillStyle="#abcdef";let t=e.fillStyle;e.fillStyle=n,e.fillStyle===t&&(e.fillStyle="#fedcba",t=e.fillStyle,e.fillStyle=n,e.fillStyle===t&&uf(n));const i=e.fillStyle;if(i.startsWith("#")||i.startsWith("rgba"))return Pb(i);e.clearRect(0,0,1,1),e.fillRect(0,0,1,1);const r=Array.from(e.getImageData(0,0,1,1).data);return r[3]=wg(r[3]/255,3),r}function I6(n){return typeof n=="string"?n:ax(n)}const A6=1024,bd={};let e1=0;function R6(n){if(n.length===4)return n;const e=n.slice();return e[3]=1,e}function t1(n){return n>.0031308?Math.pow(n,1/2.4)*269.025-14.025:n*3294.6}function n1(n){return n>.2068965?Math.pow(n,3):(n-4/29)*(108/841)}function i1(n){return n>10.314724?Math.pow((n+14.025)/269.025,2.4):n/3294.6}function r1(n){return n>.0088564?Math.pow(n,1/3):n/(108/841)+4/29}function oA(n){const e=i1(n[0]),t=i1(n[1]),i=i1(n[2]),r=r1(e*.222488403+t*.716873169+i*.06060791),s=500*(r1(e*.452247074+t*.399439023+i*.148375274)-r),o=200*(r-r1(e*.016863605+t*.117638439+i*.865350722)),a=Math.atan2(o,s)*(180/Math.PI);return[116*r-16,Math.sqrt(s*s+o*o),a<0?a+360:a,n[3]]}function P6(n){const e=(n[0]+16)/116,t=n[1],i=n[2]*Math.PI/180,r=n1(e),s=n1(e+t/500*Math.cos(i)),o=n1(e-t/200*Math.sin(i)),a=t1(s*3.021973625-r*1.617392459-o*.404875592),c=t1(s*-.943766287+r*1.916279586+o*.027607165),h=t1(s*.069407491-r*.22898585+o*1.159737864);return[kt(a+.5|0,0,255),kt(c+.5|0,0,255),kt(h+.5|0,0,255),n[3]]}function ox(n){if(n==="none")return sx;if(bd.hasOwnProperty(n))return bd[n];if(e1>=A6){let t=0;for(const i in bd)(t++&3)===0&&(delete bd[i],--e1)}const e=Pb(n);e.length!==4&&uf(n);for(const t of e)isNaN(t)&&uf(n);return bd[n]=e,++e1,e}function uh(n){return Array.isArray(n)?n:ox(n)}function ax(n){let e=n[0];e!=(e|0)&&(e=e+.5|0);let t=n[1];t!=(t|0)&&(t=t+.5|0);let i=n[2];i!=(i|0)&&(i=i+.5|0);const r=n[3]===void 0?1:Math.round(n[3]*1e3)/1e3;return"rgba("+e+","+t+","+i+","+r+")"}class Eie extends vg{constructor(e,t,i,r){super(),this.extent=e,this.pixelRatio_=i,this.resolution=t,this.state=typeof r=="function"?Be.IDLE:r,this.image_=null,this.loader=typeof r=="function"?r:null}changed(){this.dispatchEvent(He.CHANGE)}getExtent(){return this.extent}getImage(){return this.image_}getPixelRatio(){return this.pixelRatio_}getResolution(){return this.resolution}getState(){return this.state}load(){if(this.state==Be.IDLE&&this.loader){this.state=Be.LOADING,this.changed();const e=this.getResolution(),t=Array.isArray(e)?e[0]:e;qM(()=>this.loader(this.getExtent(),t,this.getPixelRatio())).then(i=>{"image"in i&&(this.image_=i.image),"extent"in i&&(this.extent=i.extent),"resolution"in i&&(this.resolution=i.resolution),"pixelRatio"in i&&(this.pixelRatio_=i.pixelRatio),(i instanceof HTMLImageElement||Ib&&i instanceof ImageBitmap||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement)&&(this.image_=i),this.state=Be.LOADED}).catch(i=>{this.state=Be.ERROR,console.error(i)}).finally(()=>this.changed())}}setImage(e){this.image_=e}setResolution(e){this.resolution=e}}function C6(n,e,t){const i=n;let r=!0,s=!1,o=!1;const a=[c0(i,He.LOAD,function(){o=!0,s||e()})];return i.src&&rx?(s=!0,i.decode().then(function(){r&&e()}).catch(function(c){r&&(o?e():t())})):a.push(c0(i,He.ERROR,t)),function(){r=!1,a.forEach(Ft)}}function M6(n,e){return new Promise((t,i)=>{function r(){o(),t(n)}function s(){o(),i(new Error("Image load error"))}function o(){n.removeEventListener("load",r),n.removeEventListener("error",s)}n.addEventListener("load",r),n.addEventListener("error",s)})}function Cb(n,e){return e&&(n.src=e),n.src&&rx?new Promise((t,i)=>n.decode().then(()=>t(n)).catch(r=>n.complete&&n.width?t(n):i(r))):M6(n)}function wie(n,e){return e&&(n.src=e),n.src&&rx&&Ib?n.decode().then(()=>createImageBitmap(n)).catch(t=>{if(n.complete&&n.width)return n;throw t}):Cb(n)}class b6{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=1024}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let e=0;for(const t in this.cache_){const i=this.cache_[t];(e++&3)===0&&!i.hasListener()&&(delete this.cache_[t],delete this.patternCache_[t],--this.cacheSize_)}}}get(e,t,i){const r=s1(e,t,i);return r in this.cache_?this.cache_[r]:null}getPattern(e,t,i){const r=s1(e,t,i);return r in this.patternCache_?this.patternCache_[r]:null}set(e,t,i,r,s){const o=s1(e,t,i),a=o in this.cache_;this.cache_[o]=r,s&&(r.getImageState()===Be.IDLE&&r.load(),r.getImageState()===Be.LOADING?r.ready().then(()=>{this.patternCache_[o]=y0().createPattern(r.getImage(1),"repeat")}):this.patternCache_[o]=y0().createPattern(r.getImage(1),"repeat")),a||++this.cacheSize_}setSize(e){this.maxCacheSize_=e,this.expire()}}function s1(n,e,t){const i=t?uh(t):"null";return e+":"+n+":"+i}const xr=new b6;let kd=null;class Mb extends vg{constructor(e,t,i,r,s){super(),this.hitDetectionImage_=null,this.image_=e,this.crossOrigin_=i,this.canvas_={},this.color_=s,this.imageState_=r===void 0?Be.IDLE:r,this.size_=e&&e.width&&e.height?[e.width,e.height]:null,this.src_=t,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===Be.LOADED){kd||(kd=mn(1,1,void 0,{willReadFrequently:!0})),kd.drawImage(this.image_,0,0);try{kd.getImageData(0,0,1,1),this.tainted_=!1}catch{kd=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(He.CHANGE)}handleImageError_(){this.imageState_=Be.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=Be.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(e){return this.image_||this.initializeImage_(),this.replaceColor_(e),this.canvas_[e]?this.canvas_[e]:this.image_}getPixelRatio(e){return this.replaceColor_(e),this.canvas_[e]?e:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const e=this.size_[0],t=this.size_[1],i=mn(e,t);i.fillRect(0,0,e,t),this.hitDetectionImage_=i.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===Be.IDLE){this.image_||this.initializeImage_(),this.imageState_=Be.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&Cb(this.image_,this.src_).then(e=>{this.image_=e,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(e){if(!this.color_||this.canvas_[e]||this.imageState_!==Be.LOADED)return;const t=this.image_,i=mn(Math.ceil(t.width*e),Math.ceil(t.height*e)),r=i.canvas;i.scale(e,e),i.drawImage(t,0,0),i.globalCompositeOperation="multiply",i.fillStyle=I6(this.color_),i.fillRect(0,0,r.width/e,r.height/e),i.globalCompositeOperation="destination-in",i.drawImage(t,0,0),this.canvas_[e]=r}ready(){return this.ready_||(this.ready_=new Promise(e=>{if(this.imageState_===Be.LOADED||this.imageState_===Be.ERROR)e();else{const t=()=>{(this.imageState_===Be.LOADED||this.imageState_===Be.ERROR)&&(this.removeEventListener(He.CHANGE,t),e())};this.addEventListener(He.CHANGE,t)}})),this.ready_}}function v0(n,e,t,i,r,s){let o=e===void 0?void 0:xr.get(e,t,r);return o||(o=new Mb(n,n&&"src"in n?n.src||void 0:e,t,i,r),xr.set(e,t,r,o,s)),s&&o&&!xr.getPattern(e,t,r)&&xr.set(e,t,r,o,s),o}function xs(n){return n?Array.isArray(n)?ax(n):typeof n=="object"&&"src"in n?k6(n):n:null}function k6(n){if(!n.offset||!n.size)return xr.getPattern(n.src,"anonymous",n.color);const e=n.src+":"+n.offset,t=xr.getPattern(e,void 0,n.color);if(t)return t;const i=xr.get(n.src,"anonymous",null);if(i.getImageState()!==Be.LOADED)return null;const r=mn(n.size[0],n.size[1]);return r.drawImage(i.getImage(1),n.offset[0],n.offset[1],n.size[0],n.size[1],0,0,n.size[0],n.size[1]),v0(r.canvas,e,void 0,Be.LOADED,n.color,!0),xr.getPattern(e,void 0,n.color)}class bb{drawCustom(e,t,i,r,s){}drawGeometry(e){}setStyle(e){}drawCircle(e,t,i){}drawFeature(e,t,i){}drawGeometryCollection(e,t,i){}drawLineString(e,t,i){}drawMultiLineString(e,t,i){}drawMultiPoint(e,t,i){}drawMultiPolygon(e,t,i){}drawPoint(e,t,i){}drawPolygon(e,t,i){}drawText(e,t,i){}setFillStrokeStyle(e,t){}setImageStyle(e,t){}setTextStyle(e,t){}}const dp="ol-hidden",k_="ol-unselectable",lx="ol-control",aA="ol-collapsed",L6=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z0-9]+?)\\s*$`].join(""),"i"),lA=["style","variant","weight","size","lineHeight","family"],vE={normal:400,bold:700},EE=function(n){const e=n.match(L6);if(!e)return null;const t={lineHeight:"normal",size:"1.2em",style:"normal",weight:"400",variant:"normal"};for(let i=0,r=lA.length;i<r;++i){const s=e[i+1];s!==void 0&&(t[lA[i]]=typeof s=="string"?s.trim():s)}return isNaN(Number(t.weight))&&t.weight in vE&&(t.weight=vE[t.weight]),t.families=t.family.split(/,\s?/).map(i=>i.trim().replace(/^['"]|['"]$/g,"")),t},kb="10px sans-serif",Ii="#000",hh="round",fo=[],go=0,dh="round",Nf=10,Df="#000",Of="center",E0="middle",$l=[0,0,0,0],Vf=1,Iu=new Os;let Ld=null,cA;const wE={},N6=new Set(["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","emoji","math","fangsong"]);function D6(n,e,t){return`${n} ${e} 16px "${t}"`}const O6=(function(){let e,t;async function i(s){await t.ready;const o=await t.load(s);if(o.length===0)return!1;const a=EE(s),c=a.families[0].toLowerCase(),h=a.weight;return o.some(d=>{const g=d.family.replace(/^['"]|['"]$/g,"").toLowerCase(),m=vE[d.weight]||d.weight;return g===c&&d.style===a.style&&m==h})}async function r(){await t.ready;let s=!0;const o=Iu.getProperties(),a=Object.keys(o).filter(c=>o[c]<100);for(let c=a.length-1;c>=0;--c){const h=a[c];let d=o[h];d<100&&(await i(h)?(yg(wE),Iu.set(h,100)):(d+=10,Iu.set(h,d,!0),d<100&&(s=!1)))}e=void 0,s||(e=setTimeout(r,100))}return async function(s){t||(t=qi?self.fonts:document.fonts);const o=EE(s);if(!o)return;const a=o.families;let c=!1;for(const h of a){if(N6.has(h))continue;const d=D6(o.style,o.weight,h);Iu.get(d)===void 0&&(Iu.set(d,0,!0),c=!0)}c&&(clearTimeout(e),e=setTimeout(r,100))}})(),V6=(function(){let n;return function(e){let t=wE[e];if(t==null){if(qi){const i=EE(e),r=Lb(e,"g");t=(isNaN(Number(i.lineHeight))?1.2:Number(i.lineHeight))*(r.actualBoundingBoxAscent+r.actualBoundingBoxDescent)}else n||(n=document.createElement("div"),n.innerHTML="M",n.style.minHeight="0",n.style.maxHeight="none",n.style.height="auto",n.style.padding="0",n.style.border="none",n.style.position="absolute",n.style.display="block",n.style.left="-99999px"),n.style.font=e,document.body.appendChild(n),t=n.offsetHeight,document.body.removeChild(n);wE[e]=t}return t}})();function Lb(n,e){return Ld||(Ld=mn(1,1)),n!=cA&&(Ld.font=n,cA=Ld.font),Ld.measureText(e)}function Nb(n,e){return Lb(n,e).width}function uA(n,e,t){if(e in t)return t[e];const i=e.split(`
`).reduce((r,s)=>Math.max(r,Nb(n,s)),0);return t[e]=i,i}function F6(n,e){const t=[],i=[],r=[];let s=0,o=0,a=0,c=0;for(let h=0,d=e.length;h<=d;h+=2){const g=e[h];if(g===`
`||h===d){s=Math.max(s,o),r.push(o),o=0,a+=c,c=0;continue}const m=e[h+1]||n.font,v=Nb(m,g);t.push(v),o+=v;const y=V6(m);i.push(y),c=Math.max(c,y)}return{width:s,height:a,widths:t,heights:i,lineWidths:r}}function j6(n,e,t,i,r,s,o,a,c,h,d){n.save(),t!==1&&(n.globalAlpha===void 0?n.globalAlpha=g=>g.globalAlpha*=t:n.globalAlpha*=t),e&&n.transform.apply(n,e),i.contextInstructions?(n.translate(c,h),n.scale(d[0],d[1]),G6(i,n)):d[0]<0||d[1]<0?(n.translate(c,h),n.scale(d[0],d[1]),n.drawImage(i,r,s,o,a,0,0,o,a)):n.drawImage(i,r,s,o,a,c,h,o*d[0],a*d[1]),n.restore()}function G6(n,e){const t=n.contextInstructions;for(let i=0,r=t.length;i<r;i+=2)Array.isArray(t[i+1])?e[t[i]].apply(e,t[i+1]):e[t[i]]=t[i+1]}class U6 extends bb{constructor(e,t,i,r,s,o,a){super(),this.context_=e,this.pixelRatio_=t,this.extent_=i,this.transform_=r,this.transformRotation_=r?wg(Math.atan2(r[1],r[0]),10):0,this.viewRotation_=s,this.squaredTolerance_=o,this.userTransform_=a,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=Hr()}drawImages_(e,t,i,r){if(!this.image_)return;const s=Pa(e,t,i,r,this.transform_,this.pixelCoordinates_),o=this.context_,a=this.tmpLocalTransform_,c=o.globalAlpha;this.imageOpacity_!=1&&(o.globalAlpha=c*this.imageOpacity_);let h=this.imageRotation_;this.transformRotation_===0&&(h-=this.viewRotation_),this.imageRotateWithView_&&(h+=this.viewRotation_);for(let d=0,g=s.length;d<g;d+=2){const m=s[d]-this.imageAnchorX_,v=s[d+1]-this.imageAnchorY_;if(h!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const y=m+this.imageAnchorX_,T=v+this.imageAnchorY_;yo(a,y,T,1,1,h,-y,-T),o.save(),o.transform.apply(o,a),o.translate(y,T),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.restore()}else o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,m,v,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(o.globalAlpha=c)}drawText_(e,t,i,r){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const s=Pa(e,t,i,r,this.transform_,this.pixelCoordinates_),o=this.context_;let a=this.textRotation_;for(this.transformRotation_===0&&(a-=this.viewRotation_),this.textRotateWithView_&&(a+=this.viewRotation_);t<i;t+=r){const c=s[t]+this.textOffsetX_,h=s[t+1]+this.textOffsetY_;a!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(o.save(),o.translate(c-this.textOffsetX_,h-this.textOffsetY_),o.rotate(a),o.translate(this.textOffsetX_,this.textOffsetY_),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.restore()):(this.textStrokeState_&&o.strokeText(this.text_,c,h),this.textFillState_&&o.fillText(this.text_,c,h))}}moveToLineTo_(e,t,i,r,s){const o=this.context_,a=Pa(e,t,i,r,this.transform_,this.pixelCoordinates_);o.moveTo(a[0],a[1]);let c=a.length;s&&(c-=2);for(let h=2;h<c;h+=2)o.lineTo(a[h],a[h+1]);return s&&o.closePath(),i}drawRings_(e,t,i,r){for(let s=0,o=i.length;s<o;++s)t=this.moveToLineTo_(e,t,i[s],r,!0);return t}drawCircle(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Ri(this.extent_,e.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=u6(e,this.transform_,this.pixelCoordinates_),i=t[2]-t[0],r=t[3]-t[1],s=Math.sqrt(i*i+r*r),o=this.context_;o.beginPath(),o.arc(t[0],t[1],s,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}this.text_!==""&&this.drawText_(e.getCenter(),0,2,2)}}setStyle(e){this.setFillStrokeStyle(e.getFill(),e.getStroke()),this.setImageStyle(e.getImage()),this.setTextStyle(e.getText())}setTransform(e){this.transform_=e}drawGeometry(e){switch(e.getType()){case"Point":this.drawPoint(e);break;case"LineString":this.drawLineString(e);break;case"Polygon":this.drawPolygon(e);break;case"MultiPoint":this.drawMultiPoint(e);break;case"MultiLineString":this.drawMultiLineString(e);break;case"MultiPolygon":this.drawMultiPolygon(e);break;case"GeometryCollection":this.drawGeometryCollection(e);break;case"Circle":this.drawCircle(e);break}}drawFeature(e,t){const i=t.getGeometryFunction()(e);i&&(this.setStyle(t),this.drawGeometry(i))}drawGeometryCollection(e){const t=e.getGeometriesArray();for(let i=0,r=t.length;i<r;++i)this.drawGeometry(t[i])}drawPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),i=e.getStride();this.image_&&this.drawImages_(t,0,t.length,i),this.text_!==""&&this.drawText_(t,0,t.length,i)}drawMultiPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),i=e.getStride();this.image_&&this.drawImages_(t,0,t.length,i),this.text_!==""&&this.drawText_(t,0,t.length,i)}drawLineString(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Ri(this.extent_,e.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const t=this.context_,i=e.getFlatCoordinates();t.beginPath(),this.moveToLineTo_(i,0,i.length,e.getStride(),!1),t.stroke()}if(this.text_!==""){const t=e.getFlatMidpoint();this.drawText_(t,0,2,2)}}}drawMultiLineString(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getExtent();if(Ri(this.extent_,t)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const i=this.context_,r=e.getFlatCoordinates();let s=0;const o=e.getEnds(),a=e.getStride();i.beginPath();for(let c=0,h=o.length;c<h;++c)s=this.moveToLineTo_(r,s,o[c],a,!1);i.stroke()}if(this.text_!==""){const i=e.getFlatMidpoints();this.drawText_(i,0,i.length,2)}}}drawPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Ri(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_;t.beginPath(),this.drawRings_(e.getOrientedFlatCoordinates(),0,e.getEnds(),e.getStride()),this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoint();this.drawText_(t,0,2,2)}}}drawMultiPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Ri(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_,i=e.getOrientedFlatCoordinates();let r=0;const s=e.getEndss(),o=e.getStride();t.beginPath();for(let a=0,c=s.length;a<c;++a){const h=s[a];r=this.drawRings_(i,r,h,o)}this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoints();this.drawText_(t,0,t.length,2)}}}setContextFillState_(e){const t=this.context_,i=this.contextFillState_;i?i.fillStyle!=e.fillStyle&&(i.fillStyle=e.fillStyle,t.fillStyle=e.fillStyle):(t.fillStyle=e.fillStyle,this.contextFillState_={fillStyle:e.fillStyle})}setContextStrokeState_(e){const t=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=e.lineCap&&(i.lineCap=e.lineCap,t.lineCap=e.lineCap),qa(i.lineDash,e.lineDash)||t.setLineDash(i.lineDash=e.lineDash),i.lineDashOffset!=e.lineDashOffset&&(i.lineDashOffset=e.lineDashOffset,t.lineDashOffset=e.lineDashOffset),i.lineJoin!=e.lineJoin&&(i.lineJoin=e.lineJoin,t.lineJoin=e.lineJoin),i.lineWidth!=e.lineWidth&&(i.lineWidth=e.lineWidth,t.lineWidth=e.lineWidth),i.miterLimit!=e.miterLimit&&(i.miterLimit=e.miterLimit,t.miterLimit=e.miterLimit),i.strokeStyle!=e.strokeStyle&&(i.strokeStyle=e.strokeStyle,t.strokeStyle=e.strokeStyle)):(t.lineCap=e.lineCap,t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset,t.lineJoin=e.lineJoin,t.lineWidth=e.lineWidth,t.miterLimit=e.miterLimit,t.strokeStyle=e.strokeStyle,this.contextStrokeState_={lineCap:e.lineCap,lineDash:e.lineDash,lineDashOffset:e.lineDashOffset,lineJoin:e.lineJoin,lineWidth:e.lineWidth,miterLimit:e.miterLimit,strokeStyle:e.strokeStyle})}setContextTextState_(e){const t=this.context_,i=this.contextTextState_,r=e.textAlign?e.textAlign:Of;i?(i.font!=e.font&&(i.font=e.font,t.font=e.font),i.textAlign!=r&&(i.textAlign=r,t.textAlign=r),i.textBaseline!=e.textBaseline&&(i.textBaseline=e.textBaseline,t.textBaseline=e.textBaseline)):(t.font=e.font,t.textAlign=r,t.textBaseline=e.textBaseline,this.contextTextState_={font:e.font,textAlign:r,textBaseline:e.textBaseline})}setFillStrokeStyle(e,t){if(!e)this.fillState_=null;else{const i=e.getColor();this.fillState_={fillStyle:xs(i||Ii)}}if(!t)this.strokeState_=null;else{const i=t.getColor(),r=t.getLineCap(),s=t.getLineDash(),o=t.getLineDashOffset(),a=t.getLineJoin(),c=t.getWidth(),h=t.getMiterLimit(),d=s||fo;this.strokeState_={lineCap:r!==void 0?r:hh,lineDash:this.pixelRatio_===1?d:d.map(g=>g*this.pixelRatio_),lineDashOffset:(o||go)*this.pixelRatio_,lineJoin:a!==void 0?a:dh,lineWidth:(c!==void 0?c:Vf)*this.pixelRatio_,miterLimit:h!==void 0?h:Nf,strokeStyle:xs(i||Df)}}}setImageStyle(e){let t;if(!e||!(t=e.getSize())){this.image_=null;return}const i=e.getPixelRatio(this.pixelRatio_),r=e.getAnchor(),s=e.getOrigin();this.image_=e.getImage(this.pixelRatio_),this.imageAnchorX_=r[0]*i,this.imageAnchorY_=r[1]*i,this.imageHeight_=t[1]*i,this.imageOpacity_=e.getOpacity(),this.imageOriginX_=s[0],this.imageOriginY_=s[1],this.imageRotateWithView_=e.getRotateWithView(),this.imageRotation_=e.getRotation();const o=e.getScaleArray();this.imageScale_=[o[0]*this.pixelRatio_/i,o[1]*this.pixelRatio_/i],this.imageWidth_=t[0]*i}setTextStyle(e){if(!e)this.text_="";else{const t=e.getFill();if(!t)this.textFillState_=null;else{const v=t.getColor();this.textFillState_={fillStyle:xs(v||Ii)}}const i=e.getStroke();if(!i)this.textStrokeState_=null;else{const v=i.getColor(),y=i.getLineCap(),T=i.getLineDash(),w=i.getLineDashOffset(),A=i.getLineJoin(),P=i.getWidth(),C=i.getMiterLimit();this.textStrokeState_={lineCap:y!==void 0?y:hh,lineDash:T||fo,lineDashOffset:w||go,lineJoin:A!==void 0?A:dh,lineWidth:P!==void 0?P:Vf,miterLimit:C!==void 0?C:Nf,strokeStyle:xs(v||Df)}}const r=e.getFont(),s=e.getOffsetX(),o=e.getOffsetY(),a=e.getRotateWithView(),c=e.getRotation(),h=e.getScaleArray(),d=e.getText(),g=e.getTextAlign(),m=e.getTextBaseline();this.textState_={font:r!==void 0?r:kb,textAlign:g!==void 0?g:Of,textBaseline:m!==void 0?m:E0},this.text_=d!==void 0?Array.isArray(d)?d.reduce((v,y,T)=>v+=T%2?" ":y,""):d:"",this.textOffsetX_=s!==void 0?this.pixelRatio_*s:0,this.textOffsetY_=o!==void 0?this.pixelRatio_*o:0,this.textRotateWithView_=a!==void 0?a:!1,this.textRotation_=c!==void 0?c:0,this.textScale_=[this.pixelRatio_*h[0],this.pixelRatio_*h[1]]}}}const z6=.5,Db={Point:Y6,LineString:q6,Polygon:Q6,MultiPoint:Z6,MultiLineString:H6,MultiPolygon:X6,GeometryCollection:K6,Circle:$6};function B6(n,e){return parseInt(ct(n),10)-parseInt(ct(e),10)}function hA(n,e){const t=Ob(n,e);return t*t}function Ob(n,e){return z6*n/e}function $6(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(s||o){const c=n.getBuilder(t.getZIndex(),"Circle");c.setFillStrokeStyle(s,o),c.drawCircle(e,i,r)}const a=t.getText();if(a&&a.getText()){const c=n.getBuilder(t.getZIndex(),"Text");c.setTextStyle(a),c.drawText(e,i)}}function dA(n,e,t,i,r,s,o,a){const c=[],h=t.getImage();if(h){let m=!0;const v=h.getImageState();v==Be.LOADED||v==Be.ERROR?m=!1:v==Be.IDLE&&h.load(),m&&c.push(h.ready())}const d=t.getFill();d&&d.loading()&&c.push(d.ready());const g=c.length>0;return g&&Promise.all(c).then(()=>r(null)),W6(n,e,t,i,s,o,a),g}function W6(n,e,t,i,r,s,o){const a=t.getGeometryFunction()(e);if(!a)return;const c=a.simplifyTransformed(i,r);if(t.getRenderer())Vb(n,c,t,e,o);else{const d=Db[c.getType()];d(n,c,t,e,o,s)}}function Vb(n,e,t,i,r){if(e.getType()=="GeometryCollection"){const o=e.getGeometries();for(let a=0,c=o.length;a<c;++a)Vb(n,o[a],t,i,r);return}n.getBuilder(t.getZIndex(),"Default").drawCustom(e,i,t.getRenderer(),t.getHitDetectionRenderer(),r)}function K6(n,e,t,i,r,s){const o=e.getGeometriesArray();let a,c;for(a=0,c=o.length;a<c;++a){const h=Db[o[a].getType()];h(n,o[a],t,i,r,s)}}function q6(n,e,t,i,r){const s=t.getStroke();if(s){const a=n.getBuilder(t.getZIndex(),"LineString");a.setFillStrokeStyle(null,s),a.drawLineString(e,i,r)}const o=t.getText();if(o&&o.getText()){const a=n.getBuilder(t.getZIndex(),"Text");a.setTextStyle(o),a.drawText(e,i,r)}}function H6(n,e,t,i,r){const s=t.getStroke();if(s){const a=n.getBuilder(t.getZIndex(),"LineString");a.setFillStrokeStyle(null,s),a.drawMultiLineString(e,i,r)}const o=t.getText();if(o&&o.getText()){const a=n.getBuilder(t.getZIndex(),"Text");a.setTextStyle(o),a.drawText(e,i,r)}}function X6(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(o||s){const c=n.getBuilder(t.getZIndex(),"Polygon");c.setFillStrokeStyle(s,o),c.drawMultiPolygon(e,i,r)}const a=t.getText();if(a&&a.getText()){const c=n.getBuilder(t.getZIndex(),"Text");c.setTextStyle(a),c.drawText(e,i,r)}}function Y6(n,e,t,i,r,s){const o=t.getImage(),a=t.getText(),c=a&&a.getText(),h=s&&o&&c?{}:void 0;if(o){if(o.getImageState()!=Be.LOADED)return;const d=n.getBuilder(t.getZIndex(),"Image");d.setImageStyle(o,h),d.drawPoint(e,i,r)}if(c){const d=n.getBuilder(t.getZIndex(),"Text");d.setTextStyle(a,h),d.drawText(e,i,r)}}function Z6(n,e,t,i,r,s){const o=t.getImage(),a=o&&o.getOpacity()!==0,c=t.getText(),h=c&&c.getText(),d=s&&a&&h?{}:void 0;if(a){if(o.getImageState()!=Be.LOADED)return;const g=n.getBuilder(t.getZIndex(),"Image");g.setImageStyle(o,d),g.drawMultiPoint(e,i,r)}if(h){const g=n.getBuilder(t.getZIndex(),"Text");g.setTextStyle(c,d),g.drawText(e,i,r)}}function Q6(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(s||o){const c=n.getBuilder(t.getZIndex(),"Polygon");c.setFillStrokeStyle(s,o),c.drawPolygon(e,i,r)}const a=t.getText();if(a&&a.getText()){const c=n.getBuilder(t.getZIndex(),"Text");c.setTextStyle(a),c.drawText(e,i,r)}}let J6=!1;function e8(n,e,t,i,r,s,o){const a=new XMLHttpRequest;a.open("GET",typeof n=="function"?n(t,i,r):n,!0),e.getType()=="arraybuffer"&&(a.responseType="arraybuffer"),a.withCredentials=J6,a.onload=function(c){if(!a.status||a.status>=200&&a.status<300){const h=e.getType();try{let d;h=="text"||h=="json"?d=a.responseText:h=="xml"?d=a.responseXML||a.responseText:h=="arraybuffer"&&(d=a.response),d?s(e.readFeatures(d,{extent:t,featureProjection:r}),e.readProjection(d)):o()}catch{o()}}else o()},a.onerror=o,a.send()}function fA(n,e){return function(t,i,r,s,o){e8(n,e,t,i,r,(a,c)=>{this.addFeatures(a),s!==void 0&&s(a)},()=>{this.changed(),o!==void 0&&o()})}}function t8(n,e){return[[-1/0,-1/0,1/0,1/0]]}function n8(n,e,t,i){const r=[];let s=Zi();for(let o=0,a=t.length;o<a;++o){const c=t[o];s=$w(n,e,c[0],i),r.push((s[0]+s[2])/2,(s[1]+s[3])/2),e=c[c.length-1]}return r}function cx(n,e,t,i,r,s,o){let a,c,h,d,g,m,v;const y=r[s+1],T=[];for(let P=0,C=t.length;P<C;++P){const N=t[P];for(d=n[N-i],m=n[N-i+1],a=e;a<N;a+=i)g=n[a],v=n[a+1],(y<=m&&v<=y||m<=y&&y<=v)&&(h=(y-m)/(v-m)*(g-d)+d,T.push(h)),d=g,m=v}let w=NaN,A=-1/0;for(T.sort(ho),d=T[0],a=1,c=T.length;a<c;++a){g=T[a];const P=Math.abs(g-d);P>A&&(h=(d+g)/2,nx(n,e,t,i,h,y)&&(w=h,A=P)),d=g}return isNaN(w)&&(w=r[s]),o?(o.push(w,y,A),o):[w,y,A]}function i8(n,e,t,i,r){let s=[];for(let o=0,a=t.length;o<a;++o){const c=t[o];s=cx(n,e,c,i,r,2*o,s),e=c[c.length-1]}return s}function r8(n,e,t,i){for(;e<t-i;){for(let r=0;r<i;++r){const s=n[e+r];n[e+r]=n[t-i+r],n[t-i+r]=s}e+=i,t-=i}}function ux(n,e,t,i){let r=0,s=n[t-i],o=n[t-i+1];for(;e<t;e+=i){const a=n[e],c=n[e+1];r+=(a-s)*(c+o),s=a,o=c}return r===0?void 0:r>0}function Fb(n,e,t,i,r){r=r!==void 0?r:!1;for(let s=0,o=t.length;s<o;++s){const a=t[s],c=ux(n,e,a,i);if(s===0){if(r&&c||!r&&!c)return!1}else if(r&&!c||!r&&c)return!1;e=a}return!0}function xie(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const a=t[s];if(!Fb(n,e,a,i,r))return!1;a.length&&(e=a[a.length-1])}return!0}function xE(n,e,t,i,r){r=r!==void 0?r:!1;for(let s=0,o=t.length;s<o;++s){const a=t[s],c=ux(n,e,a,i);(s===0?r&&c||!r&&!c:r&&!c||!r&&c)&&r8(n,e,a,i),e=a}return e}function Sie(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s)e=xE(n,e,t[s],i,r);return e}function s8(n,e){const t=[];let i=0,r=0,s;for(let o=0,a=e.length;o<a;++o){const c=e[o],h=ux(n,i,c,2);if(s===void 0&&(s=h),h===s)t.push(e.slice(r,o+1));else{if(t.length===0)continue;t[t.length-1].push(e[r])}r=o+1,i=c}return t}function jb(n,e,t,i){let r=0;const s=n[t-i],o=n[t-i+1];let a=0,c=0;for(;e<t;e+=i){const h=n[e]-s,d=n[e+1]-o;r+=c*h-a*d,a=h,c=d}return r/2}function Gb(n,e,t,i){let r=0;for(let s=0,o=t.length;s<o;++s){const a=t[s];r+=jb(n,e,a,i),e=a}return r}function Tie(n,e,t,i){let r=0;for(let s=0,o=t.length;s<o;++s){const a=t[s];r+=Gb(n,e,a,i),e=a[a.length-1]}return r}class Ff extends P_{constructor(e,t){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,t!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}clone(){return new Ff(this.flatCoordinates.slice(),this.layout)}closestPointXY(e,t,i,r){return r<Bw(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Jw(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),ex(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,e,t,i,r))}getArea(){return jb(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return zl(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(e){const t=[];return t.length=M_(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new Ff(t,"XY")}getType(){return"LinearRing"}intersectsExtent(e){return!1}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=tx(this.flatCoordinates,0,e,this.stride),this.changed()}}class jf extends P_{constructor(e,t,i){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,t!==void 0&&i?(this.setFlatCoordinates(t,e),this.ends_=i):this.setCoordinates(e,t)}appendLinearRing(e){this.flatCoordinates?v_(this.flatCoordinates,e.getFlatCoordinates()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new jf(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,t,i,r){return r<Bw(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(pb(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),_b(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,e,t,i,r))}containsXY(e,t){return nx(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,t)}getArea(){return Gb(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(e){let t;return e!==void 0?(t=this.getOrientedFlatCoordinates().slice(),xE(t,0,this.ends_,this.stride,e)):t=this.flatCoordinates,m0(t,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const e=tc(this.getExtent());this.flatInteriorPoint_=cx(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new _0(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(e){return e<0||this.ends_.length<=e?null:new Ff(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLinearRings(){const e=this.layout,t=this.flatCoordinates,i=this.ends_,r=[];let s=0;for(let o=0,a=i.length;o<a;++o){const c=i[o],h=new Ff(t.slice(s,c),e);r.push(h),s=c}return r}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;Fb(e,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=xE(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const t=[],i=[];return t.length=ix(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(e),t,0,i),new jf(t,"XY",i)}getType(){return"Polygon"}intersectsExtent(e){return wb(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=yb(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1],this.changed()}}function gA(n){if(I_(n))throw new Error("Cannot create polygon from empty extent");const e=n[0],t=n[1],i=n[2],r=n[3],s=[e,t,e,r,i,r,i,t,e,t];return new jf(s,"XY",[s.length])}const mA=Hr();class zr{constructor(e,t,i,r,s,o){this.styleFunction,this.extent_,this.id_=o,this.type_=e,this.flatCoordinates_=t,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=i||null,this.properties_=s,this.squaredTolerance_,this.stride_=r,this.simplifiedGeometry_}get(e){return this.properties_[e]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?ZM(this.flatCoordinates_):$w(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const e=tc(this.getExtent());this.flatInteriorPoints_=cx(this.flatCoordinates_,0,this.ends_,2,e,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const e=s8(this.flatCoordinates_,this.ends_),t=n8(this.flatCoordinates_,0,e,2);this.flatInteriorPoints_=i8(this.flatCoordinates_,0,e,2,t)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=_E(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const e=this.flatCoordinates_;let t=0;const i=this.ends_;for(let r=0,s=i.length;r<s;++r){const o=i[r],a=_E(e,t,o,2,.5);v_(this.flatMidpoints_,a),t=o}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(e){return this}simplifyTransformed(e,t){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(e){e=Un(e);const t=e.getExtent(),i=e.getWorldExtent();if(t&&i){const r=ei(i)/ei(t);yo(mA,i[0],i[3],r,-r,0,0,0),Pa(this.flatCoordinates_,0,this.flatCoordinates_.length,2,mA,this.flatCoordinates_)}}applyTransform(e){e(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){return new zr(this.type_,this.flatCoordinates_.slice(),this.ends_?.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=KM((e,t)=>{if(e===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),t&&this.simplifiedGeometry_.applyTransform(t);const i=this.simplifiedGeometry_.getFlatCoordinates();let r;switch(this.type_){case"LineString":i.length=M_(i,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,e,i,0),r=[i.length];break;case"MultiLineString":r=[],i.length=f6(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,e,i,0,r);break;case"Polygon":r=[],i.length=ix(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(e),i,0,r);break}return r&&(this.simplifiedGeometry_=new zr(this.type_,i,r,2,this.properties_,this.id_)),this.squaredTolerance_=e,this.simplifiedGeometry_}),this}}zr.prototype.getFlatCoordinates=zr.prototype.getOrientedFlatCoordinates;function Ub(n,e,t=0,i=n.length-1,r=o8){for(;i>t;){if(i-t>600){const c=i-t+1,h=e-t+1,d=Math.log(c),g=.5*Math.exp(2*d/3),m=.5*Math.sqrt(d*g*(c-g)/c)*(h-c/2<0?-1:1),v=Math.max(t,Math.floor(e-h*g/c+m)),y=Math.min(i,Math.floor(e+(c-h)*g/c+m));Ub(n,e,v,y,r)}const s=n[e];let o=t,a=i;for(Nd(n,t,e),r(n[i],s)>0&&Nd(n,t,i);o<a;){for(Nd(n,o,a),o++,a--;r(n[o],s)<0;)o++;for(;r(n[a],s)>0;)a--}r(n[t],s)===0?Nd(n,t,a):(a++,Nd(n,a,i)),a<=e&&(t=a+1),e<=a&&(i=a-1)}}function Nd(n,e,t){const i=n[e];n[e]=n[t],n[t]=i}function o8(n,e){return n<e?-1:n>e?1:0}let zb=class{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let t=this.data;const i=[];if(!gp(e,t))return i;const r=this.toBBox,s=[];for(;t;){for(let o=0;o<t.children.length;o++){const a=t.children[o],c=t.leaf?r(a):a;gp(e,c)&&(t.leaf?i.push(a):a1(e,c)?this._all(a,i):s.push(a))}t=s.pop()}return i}collides(e){let t=this.data;if(!gp(e,t))return!1;const i=[];for(;t;){for(let r=0;r<t.children.length;r++){const s=t.children[r],o=t.leaf?this.toBBox(s):s;if(gp(e,o)){if(t.leaf||a1(e,o))return!0;i.push(s)}}t=i.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let i=0;i<e.length;i++)this.insert(e[i]);return this}let t=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=t;else if(this.data.height===t.height)this._splitRoot(this.data,t);else{if(this.data.height<t.height){const i=this.data;this.data=t,t=i}this._insert(t,this.data.height-t.height-1,!0)}return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=Au([]),this}remove(e,t){if(!e)return this;let i=this.data;const r=this.toBBox(e),s=[],o=[];let a,c,h;for(;i||s.length;){if(i||(i=s.pop(),c=s[s.length-1],a=o.pop(),h=!0),i.leaf){const d=a8(e,i.children,t);if(d!==-1)return i.children.splice(d,1),s.push(i),this._condense(s),this}!h&&!i.leaf&&a1(i,r)?(s.push(i),o.push(a),a=0,c=i,i=i.children[0]):c?(a++,i=c.children[a],h=!1):i=null}return this}toBBox(e){return e}compareMinX(e,t){return e.minX-t.minX}compareMinY(e,t){return e.minY-t.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,t){const i=[];for(;e;)e.leaf?t.push(...e.children):i.push(...e.children),e=i.pop();return t}_build(e,t,i,r){const s=i-t+1;let o=this._maxEntries,a;if(s<=o)return a=Au(e.slice(t,i+1)),fu(a,this.toBBox),a;r||(r=Math.ceil(Math.log(s)/Math.log(o)),o=Math.ceil(s/Math.pow(o,r-1))),a=Au([]),a.leaf=!1,a.height=r;const c=Math.ceil(s/o),h=c*Math.ceil(Math.sqrt(o));pA(e,t,i,h,this.compareMinX);for(let d=t;d<=i;d+=h){const g=Math.min(d+h-1,i);pA(e,d,g,c,this.compareMinY);for(let m=d;m<=g;m+=c){const v=Math.min(m+c-1,g);a.children.push(this._build(e,m,v,r-1))}}return fu(a,this.toBBox),a}_chooseSubtree(e,t,i,r){for(;r.push(t),!(t.leaf||r.length-1===i);){let s=1/0,o=1/0,a;for(let c=0;c<t.children.length;c++){const h=t.children[c],d=o1(h),g=u8(e,h)-d;g<o?(o=g,s=d<s?d:s,a=h):g===o&&d<s&&(s=d,a=h)}t=a||t.children[0]}return t}_insert(e,t,i){const r=i?e:this.toBBox(e),s=[],o=this._chooseSubtree(r,this.data,t,s);for(o.children.push(e),Kd(o,r);t>=0&&s[t].children.length>this._maxEntries;)this._split(s,t),t--;this._adjustParentBBoxes(r,s,t)}_split(e,t){const i=e[t],r=i.children.length,s=this._minEntries;this._chooseSplitAxis(i,s,r);const o=this._chooseSplitIndex(i,s,r),a=Au(i.children.splice(o,i.children.length-o));a.height=i.height,a.leaf=i.leaf,fu(i,this.toBBox),fu(a,this.toBBox),t?e[t-1].children.push(a):this._splitRoot(i,a)}_splitRoot(e,t){this.data=Au([e,t]),this.data.height=e.height+1,this.data.leaf=!1,fu(this.data,this.toBBox)}_chooseSplitIndex(e,t,i){let r,s=1/0,o=1/0;for(let a=t;a<=i-t;a++){const c=Wd(e,0,a,this.toBBox),h=Wd(e,a,i,this.toBBox),d=h8(c,h),g=o1(c)+o1(h);d<s?(s=d,r=a,o=g<o?g:o):d===s&&g<o&&(o=g,r=a)}return r||i-t}_chooseSplitAxis(e,t,i){const r=e.leaf?this.compareMinX:l8,s=e.leaf?this.compareMinY:c8,o=this._allDistMargin(e,t,i,r),a=this._allDistMargin(e,t,i,s);o<a&&e.children.sort(r)}_allDistMargin(e,t,i,r){e.children.sort(r);const s=this.toBBox,o=Wd(e,0,t,s),a=Wd(e,i-t,i,s);let c=fp(o)+fp(a);for(let h=t;h<i-t;h++){const d=e.children[h];Kd(o,e.leaf?s(d):d),c+=fp(o)}for(let h=i-t-1;h>=t;h--){const d=e.children[h];Kd(a,e.leaf?s(d):d),c+=fp(a)}return c}_adjustParentBBoxes(e,t,i){for(let r=i;r>=0;r--)Kd(t[r],e)}_condense(e){for(let t=e.length-1,i;t>=0;t--)e[t].children.length===0?t>0?(i=e[t-1].children,i.splice(i.indexOf(e[t]),1)):this.clear():fu(e[t],this.toBBox)}};function a8(n,e,t){if(!t)return e.indexOf(n);for(let i=0;i<e.length;i++)if(t(n,e[i]))return i;return-1}function fu(n,e){Wd(n,0,n.children.length,e,n)}function Wd(n,e,t,i,r){r||(r=Au(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(let s=e;s<t;s++){const o=n.children[s];Kd(r,n.leaf?i(o):o)}return r}function Kd(n,e){return n.minX=Math.min(n.minX,e.minX),n.minY=Math.min(n.minY,e.minY),n.maxX=Math.max(n.maxX,e.maxX),n.maxY=Math.max(n.maxY,e.maxY),n}function l8(n,e){return n.minX-e.minX}function c8(n,e){return n.minY-e.minY}function o1(n){return(n.maxX-n.minX)*(n.maxY-n.minY)}function fp(n){return n.maxX-n.minX+(n.maxY-n.minY)}function u8(n,e){return(Math.max(e.maxX,n.maxX)-Math.min(e.minX,n.minX))*(Math.max(e.maxY,n.maxY)-Math.min(e.minY,n.minY))}function h8(n,e){const t=Math.max(n.minX,e.minX),i=Math.max(n.minY,e.minY),r=Math.min(n.maxX,e.maxX),s=Math.min(n.maxY,e.maxY);return Math.max(0,r-t)*Math.max(0,s-i)}function a1(n,e){return n.minX<=e.minX&&n.minY<=e.minY&&e.maxX<=n.maxX&&e.maxY<=n.maxY}function gp(n,e){return e.minX<=n.maxX&&e.minY<=n.maxY&&e.maxX>=n.minX&&e.maxY>=n.minY}function Au(n){return{children:n,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function pA(n,e,t,i,r){const s=[e,t];for(;s.length;){if(t=s.pop(),e=s.pop(),t-e<=i)continue;const o=e+Math.ceil((t-e)/i/2)*i;Ub(n,o,e,t,r),s.push(e,o,o,t)}}class _A{constructor(e){this.rbush_=new zb(e),this.items_={}}insert(e,t){const i={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:t};this.rbush_.insert(i),this.items_[ct(t)]=i}load(e,t){const i=new Array(t.length);for(let r=0,s=t.length;r<s;r++){const o=e[r],a=t[r],c={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:a};i[r]=c,this.items_[ct(a)]=c}this.rbush_.load(i)}remove(e){const t=ct(e),i=this.items_[t];return delete this.items_[t],this.rbush_.remove(i)!==null}update(e,t){const i=this.items_[ct(t)],r=[i.minX,i.minY,i.maxX,i.maxY];Lf(r,e)||(this.remove(t),this.insert(e,t))}getAll(){return this.rbush_.all().map(function(t){return t.value})}getInExtent(e){const t={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]};return this.rbush_.search(t).map(function(r){return r.value})}forEach(e){return this.forEach_(this.getAll(),e)}forEachInExtent(e,t){return this.forEach_(this.getInExtent(e),t)}forEach_(e,t){let i;for(let r=0,s=e.length;r<s;r++)if(i=t(e[r]),i)return i;return i}isEmpty(){return ah(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(e){const t=this.rbush_.toJSON();return Da(t.minX,t.minY,t.maxX,t.maxY,e)}concat(e){this.rbush_.load(e.rbush_.all());for(const t in e.items_)this.items_[t]=e.items_[t]}}class Bb extends Os{constructor(e){super(),this.projection=Un(e.projection),this.attributions_=yA(e.attributions),this.attributionsCollapsible_=e.attributionsCollapsible??!0,this.loading=!1,this.state_=e.state!==void 0?e.state:"ready",this.wrapX_=e.wrapX!==void 0?e.wrapX:!1,this.interpolate_=!!e.interpolate,this.viewResolver=null,this.viewRejector=null;const t=this;this.viewPromise_=new Promise(function(i,r){t.viewResolver=i,t.viewRejector=r})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(e){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(e){this.attributions_=yA(e),this.changed()}setState(e){this.state_=e,this.changed()}}function yA(n){return n?typeof n=="function"?n:(Array.isArray(n)||(n=[n]),e=>n):null}const mr={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};class ea extends Io{constructor(e,t,i){super(e),this.feature=t,this.features=i}}class $b extends Bb{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:e.wrapX!==void 0?e.wrapX:!0}),this.on,this.once,this.un,this.loader_=bf,this.format_=e.format||null,this.overlaps_=e.overlaps===void 0?!0:e.overlaps,this.url_=e.url,e.loader!==void 0?this.loader_=e.loader:this.url_!==void 0&&(_t(this.format_,"`format` must be set when `url` is set"),this.loader_=fA(this.url_,this.format_)),this.strategy_=e.strategy!==void 0?e.strategy:t8;const t=e.useSpatialIndex!==void 0?e.useSpatialIndex:!0;this.featuresRtree_=t?new _A:null,this.loadedExtentsRtree_=new _A,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let i,r;Array.isArray(e.features)?r=e.features:e.features&&(i=e.features,r=i.getArray()),!t&&i===void 0&&(i=new Er(r)),r!==void 0&&this.addFeaturesInternal(r),i!==void 0&&this.bindFeaturesCollection_(i)}addFeature(e){this.addFeatureInternal(e),this.changed()}addFeatureInternal(e){const t=ct(e);if(!this.addToIndex_(t,e)){this.featuresCollection_&&this.featuresCollection_.remove(e);return}this.setupChangeEvents_(t,e);const i=e.getGeometry();if(i){const r=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(r,e)}else this.nullGeometryFeatures_[t]=e;this.dispatchEvent(new ea(mr.ADDFEATURE,e))}setupChangeEvents_(e,t){t instanceof zr||(this.featureChangeKeys_[e]=[lt(t,He.CHANGE,this.handleFeatureChange_,this),lt(t,oh.PROPERTYCHANGE,this.handleFeatureChange_,this)])}addToIndex_(e,t){let i=!0;if(t.getId()!==void 0){const r=String(t.getId());if(!(r in this.idIndex_))this.idIndex_[r]=t;else if(t instanceof zr){const s=this.idIndex_[r];s instanceof zr?Array.isArray(s)?s.push(t):this.idIndex_[r]=[s,t]:i=!1}else i=!1}return i&&(_t(!(e in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[e]=t),i}addFeatures(e){this.addFeaturesInternal(e),this.changed()}addFeaturesInternal(e){const t=[],i=[],r=[];for(let s=0,o=e.length;s<o;s++){const a=e[s],c=ct(a);this.addToIndex_(c,a)&&i.push(a)}for(let s=0,o=i.length;s<o;s++){const a=i[s],c=ct(a);this.setupChangeEvents_(c,a);const h=a.getGeometry();if(h){const d=h.getExtent();t.push(d),r.push(a)}else this.nullGeometryFeatures_[c]=a}if(this.featuresRtree_&&this.featuresRtree_.load(t,r),this.hasListener(mr.ADDFEATURE))for(let s=0,o=i.length;s<o;s++)this.dispatchEvent(new ea(mr.ADDFEATURE,i[s]))}bindFeaturesCollection_(e){let t=!1;this.addEventListener(mr.ADDFEATURE,function(i){t||(t=!0,e.push(i.feature),t=!1)}),this.addEventListener(mr.REMOVEFEATURE,function(i){t||(t=!0,e.remove(i.feature),t=!1)}),e.addEventListener(Ti.ADD,i=>{t||(t=!0,this.addFeature(i.element),t=!1)}),e.addEventListener(Ti.REMOVE,i=>{t||(t=!0,this.removeFeature(i.element),t=!1)}),this.featuresCollection_=e}clear(e){if(e){for(const i in this.featureChangeKeys_)this.featureChangeKeys_[i].forEach(Ft);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(i=>{this.removeFeatureInternal(i)});for(const i in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[i])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const t=new ea(mr.CLEAR);this.dispatchEvent(t),this.changed()}forEachFeature(e){if(this.featuresRtree_)return this.featuresRtree_.forEach(e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureAtCoordinateDirect(e,t){const i=[e[0],e[1],e[0],e[1]];return this.forEachFeatureInExtent(i,function(r){const s=r.getGeometry();if(s instanceof zr||s.intersectsCoordinate(e))return t(r)})}forEachFeatureInExtent(e,t){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(e,t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureIntersectingExtent(e,t){return this.forEachFeatureInExtent(e,function(i){const r=i.getGeometry();if(r instanceof zr||r.intersectsExtent(e)){const s=t(i);if(s)return s}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let e;return this.featuresCollection_?e=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(e=this.featuresRtree_.getAll(),ah(this.nullGeometryFeatures_)||v_(e,Object.values(this.nullGeometryFeatures_))),e}getFeaturesAtCoordinate(e){const t=[];return this.forEachFeatureAtCoordinateDirect(e,function(i){t.push(i)}),t}getFeaturesInExtent(e,t){if(this.featuresRtree_){if(!(t&&t.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(e);const r=nb(e,t);return[].concat(...r.map(s=>this.featuresRtree_.getInExtent(s)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(e,t){const i=e[0],r=e[1];let s=null;const o=[NaN,NaN];let a=1/0;const c=[-1/0,-1/0,1/0,1/0];return t=t||Mf,this.featuresRtree_.forEachInExtent(c,function(h){if(t(h)){const d=h.getGeometry(),g=a;if(a=d instanceof zr?0:d.closestPointXY(i,r,o,a),a<g){s=h;const m=Math.sqrt(a);c[0]=i-m,c[1]=r-m,c[2]=i+m,c[3]=r+m}}}),s}getExtent(e){return this.featuresRtree_.getExtent(e)}getFeatureById(e){const t=this.idIndex_[e.toString()];return t!==void 0?t:null}getFeatureByUid(e){const t=this.uidIndex_[e];return t!==void 0?t:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(e){const t=e.target,i=ct(t),r=t.getGeometry();if(!r)i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(t),this.nullGeometryFeatures_[i]=t);else{const o=r.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(o,t)):this.featuresRtree_&&this.featuresRtree_.update(o,t)}const s=t.getId();if(s!==void 0){const o=s.toString();this.idIndex_[o]!==t&&(this.removeFromIdIndex_(t),this.idIndex_[o]=t)}else this.removeFromIdIndex_(t),this.uidIndex_[i]=t;this.changed(),this.dispatchEvent(new ea(mr.CHANGEFEATURE,t))}hasFeature(e){const t=e.getId();return t!==void 0?t in this.idIndex_:ct(e)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&ah(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(e,t,i){const r=this.loadedExtentsRtree_,s=this.strategy_(e,t,i);for(let o=0,a=s.length;o<a;++o){const c=s[o];r.forEachInExtent(c,function(d){return $d(d.extent,c)})||(++this.loadingExtentsCount_,this.dispatchEvent(new ea(mr.FEATURESLOADSTART)),this.loader_.call(this,c,t,i,d=>{--this.loadingExtentsCount_,this.dispatchEvent(new ea(mr.FEATURESLOADEND,void 0,d))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new ea(mr.FEATURESLOADERROR))}),r.insert(c,{extent:c.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(e){const t=this.loadedExtentsRtree_,i=t.forEachInExtent(e,function(r){if(Lf(r.extent,e))return r});i&&t.remove(i)}removeFeatures(e){let t=!1;for(let i=0,r=e.length;i<r;++i)t=this.removeFeatureInternal(e[i])||t;t&&this.changed()}removeFeature(e){if(!e)return;this.removeFeatureInternal(e)&&this.changed()}removeFeatureInternal(e){const t=ct(e);if(!(t in this.uidIndex_))return!1;t in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[t]:this.featuresRtree_&&this.featuresRtree_.remove(e),this.featureChangeKeys_[t]?.forEach(Ft),delete this.featureChangeKeys_[t];const r=e.getId();if(r!==void 0){const s=r.toString(),o=this.idIndex_[s];o===e?delete this.idIndex_[s]:Array.isArray(o)&&(o.splice(o.indexOf(e),1),o.length===1&&(this.idIndex_[s]=o[0]))}return delete this.uidIndex_[t],this.hasListener(mr.REMOVEFEATURE)&&this.dispatchEvent(new ea(mr.REMOVEFEATURE,e)),!0}removeFromIdIndex_(e){for(const t in this.idIndex_)if(this.idIndex_[t]===e){delete this.idIndex_[t];break}}setLoader(e){this.loader_=e}setUrl(e){_t(this.format_,"`format` must be set when `url` is set"),this.url_=e,this.setLoader(fA(e,this.format_))}setOverlaps(e){this.overlaps_=e,this.changed()}}class Oa{constructor(e){e=e||{},this.patternImage_=null,this.color_=null,e.color!==void 0&&this.setColor(e.color)}clone(){const e=this.getColor();return new Oa({color:Array.isArray(e)?e.slice():e||void 0})}getColor(){return this.color_}setColor(e){if(e!==null&&typeof e=="object"&&"src"in e){const t=v0(null,e.src,"anonymous",void 0,e.offset?null:e.color?e.color:null,!(e.offset&&e.size));t.ready().then(()=>{this.patternImage_=null}),t.getImageState()===Be.IDLE&&t.load(),t.getImageState()===Be.LOADING&&(this.patternImage_=t)}this.color_=e}getKey(){const e=this.getColor();return e?e instanceof CanvasPattern||e instanceof CanvasGradient?ct(e):typeof e=="object"&&"src"in e?e.src+":"+e.offset:uh(e).toString():""}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}class Xl{constructor(e){e=e||{},this.color_=e.color!==void 0?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=e.lineDash!==void 0?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width}clone(){const e=this.getColor();return new Xl({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(e){this.color_=e}setLineCap(e){this.lineCap_=e}setLineDash(e){this.lineDash_=e}setLineDashOffset(e){this.lineDashOffset_=e}setLineJoin(e){this.lineJoin_=e}setMiterLimit(e){this.miterLimit_=e}setWidth(e){this.width_=e}}function vA(n){return n[0]>0&&n[1]>0}function d8(n,e,t){return t===void 0&&(t=[0,0]),t[0]=n[0]*e+.5|0,t[1]=n[1]*e+.5|0,t}function Mi(n,e){return Array.isArray(n)?n:(e===void 0?e=[n,n]:(e[0]=n,e[1]=n),e)}class L_{constructor(e){this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=Mi(e.scale),this.displacement_=e.displacement,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new L_({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return at()}getImage(e){return at()}getHitDetectionImage(){return at()}getPixelRatio(e){return 1}getImageState(){return at()}getImageSize(){return at()}getOrigin(){return at()}getSize(){return at()}setDisplacement(e){this.displacement_=e}setOpacity(e){this.opacity_=e}setRotateWithView(e){this.rotateWithView_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=Mi(e)}listenImageChange(e){at()}load(){at()}unlistenImageChange(e){at()}ready(){return Promise.resolve()}}class N_ extends L_{constructor(e){super({opacity:1,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,rotation:e.rotation!==void 0?e.rotation:0,scale:e.scale!==void 0?e.scale:1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=e.fill!==void 0?e.fill:null,this.origin_=[0,0],this.points_=e.points,this.radius=e.radius,this.radius2_=e.radius2,this.angle_=e.angle!==void 0?e.angle:0,this.stroke_=e.stroke!==void 0?e.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?Be.LOADING:Be.LOADED,this.imageState_===Be.LOADING&&this.ready().then(()=>this.imageState_=Be.LOADED),this.render()}clone(){const e=this.getScale(),t=new N_({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}getAnchor(){const e=this.size_,t=this.getDisplacement(),i=this.getScaleArray();return[e[0]/2-t[0]/i[0],e[1]/2+t[1]/i[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(e){this.fill_=e,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(e){const t=this.fill_?.getKey(),i=`${e},${this.angle_},${this.radius},${this.radius2_},${this.points_},${t}`+Object.values(this.renderOptions_).join(",");let r=xr.get(i,null,null)?.getImage(1);if(!r){const s=this.renderOptions_,o=Math.ceil(s.size*e),a=mn(o,o);this.draw_(s,a,e),r=a.canvas,xr.set(i,null,null,new Mb(r,void 0,null,Be.LOADED,null))}return r}getPixelRatio(e){return e}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e,this.render()}listenImageChange(e){}load(){}unlistenImageChange(e){}calculateLineJoinSize_(e,t,i){if(t===0||this.points_===1/0||e!=="bevel"&&e!=="miter")return t;let r=this.radius,s=this.radius2_===void 0?r:this.radius2_;if(r<s){const z=r;r=s,s=z}const o=this.radius2_===void 0?this.points_:this.points_*2,a=2*Math.PI/o,c=s*Math.sin(a),h=Math.sqrt(s*s-c*c),d=r-h,g=Math.sqrt(c*c+d*d),m=g/c;if(e==="miter"&&m<=i)return m*t;const v=t/2/m,y=t/2*(d/g),w=Math.sqrt((r+v)*(r+v)+y*y)-r;if(this.radius2_===void 0||e==="bevel")return w*2;const A=r*Math.sin(a),P=Math.sqrt(r*r-A*A),C=s-P,D=Math.sqrt(A*A+C*C)/A;if(D<=i){const z=D*t/2-s-r;return 2*Math.max(w,z)}return w*2}createRenderOptions(){let e=hh,t=dh,i=0,r=null,s=0,o,a=0;this.stroke_&&(o=xs(this.stroke_.getColor()??Df),a=this.stroke_.getWidth()??Vf,r=this.stroke_.getLineDash(),s=this.stroke_.getLineDashOffset()??0,t=this.stroke_.getLineJoin()??dh,e=this.stroke_.getLineCap()??hh,i=this.stroke_.getMiterLimit()??Nf);const c=this.calculateLineJoinSize_(t,a,i),h=Math.max(this.radius,this.radius2_||0),d=Math.ceil(2*h+c);return{strokeStyle:o,strokeWidth:a,size:d,lineCap:e,lineDash:r,lineDashOffset:s,lineJoin:t,miterLimit:i}}render(){this.renderOptions_=this.createRenderOptions();const e=this.renderOptions_.size;this.hitDetectionCanvas_=null,this.size_=[e,e]}draw_(e,t,i){if(t.scale(i,i),t.translate(e.size/2,e.size/2),this.createPath_(t),this.fill_){let r=this.fill_.getColor();r===null&&(r=Ii),t.fillStyle=xs(r),t.fill()}e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineCap=e.lineCap,t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}createHitDetectionCanvas_(e){let t;if(this.fill_){let i=this.fill_.getColor(),r=0;typeof i=="string"&&(i=uh(i)),i===null?r=1:Array.isArray(i)&&(r=i.length===4?i[3]:1),r===0&&(t=mn(e.size,e.size),this.drawHitDetectionCanvas_(e,t))}return t?t.canvas:this.getImage(1)}createPath_(e){let t=this.points_;const i=this.radius;if(t===1/0)e.arc(0,0,i,0,2*Math.PI);else{const r=this.radius2_===void 0?i:this.radius2_;this.radius2_!==void 0&&(t*=2);const s=this.angle_-Math.PI/2,o=2*Math.PI/t;for(let a=0;a<t;a++){const c=s+a*o,h=a%2===0?i:r;e.lineTo(h*Math.cos(c),h*Math.sin(c))}e.closePath()}}drawHitDetectionCanvas_(e,t){t.translate(e.size/2,e.size/2),this.createPath_(t),t.fillStyle=Ii,t.fill(),e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}class kh extends N_{constructor(e){e=e||{radius:5},super({points:1/0,fill:e.fill,radius:e.radius,stroke:e.stroke,scale:e.scale!==void 0?e.scale:1,rotation:e.rotation!==void 0?e.rotation:0,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode})}clone(){const e=this.getScale(),t=new kh({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}setRadius(e){this.radius=e,this.render()}}class Xi{constructor(e){e=e||{},this.geometry_=null,this.geometryFunction_=EA,e.geometry!==void 0&&this.setGeometry(e.geometry),this.fill_=e.fill!==void 0?e.fill:null,this.image_=e.image!==void 0?e.image:null,this.renderer_=e.renderer!==void 0?e.renderer:null,this.hitDetectionRenderer_=e.hitDetectionRenderer!==void 0?e.hitDetectionRenderer:null,this.stroke_=e.stroke!==void 0?e.stroke:null,this.text_=e.text!==void 0?e.text:null,this.zIndex_=e.zIndex}clone(){let e=this.getGeometry();return e&&typeof e=="object"&&(e=e.clone()),new Xi({geometry:e??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(e){this.renderer_=e}setHitDetectionRenderer(e){this.hitDetectionRenderer_=e}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(e){this.fill_=e}getImage(){return this.image_}setImage(e){this.image_=e}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e}getText(){return this.text_}setText(e){this.text_=e}getZIndex(){return this.zIndex_}setGeometry(e){typeof e=="function"?this.geometryFunction_=e:typeof e=="string"?this.geometryFunction_=function(t){return t.get(e)}:e?e!==void 0&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=EA,this.geometry_=e}setZIndex(e){this.zIndex_=e}}function f8(n){let e;if(typeof n=="function")e=n;else{let t;Array.isArray(n)?t=n:(_t(typeof n.getZIndex=="function","Expected an `Style` or an array of `Style`"),t=[n]),e=function(){return t}}return e}let l1=null;function Wb(n,e){if(!l1){const t=new Oa({color:"rgba(255,255,255,0.4)"}),i=new Xl({color:"#3399CC",width:1.25});l1=[new Xi({image:new kh({fill:t,stroke:i,radius:5}),fill:t,stroke:i})]}return l1}function EA(n){return n.getGeometry()}const g8="#333";class hx{constructor(e){e=e||{},this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.keepUpright_=e.keepUpright,this.scale_=e.scale,this.scaleArray_=Mi(e.scale!==void 0?e.scale:1),this.text_=e.text,this.textAlign_=e.textAlign,this.justify_=e.justify,this.repeat_=e.repeat,this.textBaseline_=e.textBaseline,this.fill_=e.fill!==void 0?e.fill:new Oa({color:g8}),this.maxAngle_=e.maxAngle!==void 0?e.maxAngle:Math.PI/4,this.placement_=e.placement!==void 0?e.placement:"point",this.overflow_=!!e.overflow,this.stroke_=e.stroke!==void 0?e.stroke:null,this.offsetX_=e.offsetX!==void 0?e.offsetX:0,this.offsetY_=e.offsetY!==void 0?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=e.padding===void 0?null:e.padding,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new hx({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),keepUpright:this.getKeepUpright(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()instanceof Oa?this.getFill().clone():this.getFill(),stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getKeepUpright(){return this.keepUpright_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(e){this.overflow_=e}setFont(e){this.font_=e}setMaxAngle(e){this.maxAngle_=e}setOffsetX(e){this.offsetX_=e}setOffsetY(e){this.offsetY_=e}setPlacement(e){this.placement_=e}setRepeat(e){this.repeat_=e}setRotateWithView(e){this.rotateWithView_=e}setKeepUpright(e){this.keepUpright_=e}setFill(e){this.fill_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=Mi(e!==void 0?e:1)}setStroke(e){this.stroke_=e}setText(e){this.text_=e}setTextAlign(e){this.textAlign_=e}setJustify(e){this.justify_=e}setTextBaseline(e){this.textBaseline_=e}setBackgroundFill(e){this.backgroundFill_=e}setBackgroundStroke(e){this.backgroundStroke_=e}setPadding(e){this.padding_=e}}const Yn={ANIMATING:0,INTERACTING:1},ke={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},mp=[ke.FILL],Sa=[ke.STROKE],Wl=[ke.BEGIN_PATH],wA=[ke.CLOSE_PATH];class Tg extends bb{constructor(e,t,i,r){super(),this.tolerance=e,this.maxExtent=t,this.pixelRatio=r,this.maxLineWidth=0,this.resolution=i,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(e){const t=this.pixelRatio;return t==1?e:e.map(function(i){return i*t})}appendFlatPointCoordinates(e,t){const i=this.getBufferedMaxExtent(),r=this.tmpCoordinate_,s=this.coordinates;let o=s.length;for(let a=0,c=e.length;a<c;a+=t)r[0]=e[a],r[1]=e[a+1],lh(i,r)&&(s[o++]=r[0],s[o++]=r[1]);return o}appendFlatLineCoordinates(e,t,i,r,s,o){const a=this.coordinates;let c=a.length;const h=this.getBufferedMaxExtent();o&&(t+=r);let d=e[t],g=e[t+1];const m=this.tmpCoordinate_;let v=!0,y,T,w;for(y=t+r;y<i;y+=r)m[0]=e[y],m[1]=e[y+1],w=aE(h,m),w!==T?(v&&(a[c++]=d,a[c++]=g,v=!1),a[c++]=m[0],a[c++]=m[1]):w===Tn.INTERSECTING?(a[c++]=m[0],a[c++]=m[1],v=!1):v=!0,d=m[0],g=m[1],T=w;return(s&&v||y===t+r)&&(a[c++]=d,a[c++]=g),c}drawCustomCoordinates_(e,t,i,r,s){for(let o=0,a=i.length;o<a;++o){const c=i[o],h=this.appendFlatLineCoordinates(e,t,c,r,!1,!1);s.push(h),t=c}return t}drawCustom(e,t,i,r,s){this.beginGeometry(e,t,s);const o=e.getType(),a=e.getStride(),c=this.coordinates.length;let h,d,g,m,v;switch(o){case"MultiPolygon":h=e.getOrientedFlatCoordinates(),m=[];const y=e.getEndss();v=0;for(let T=0,w=y.length;T<w;++T){const A=[];v=this.drawCustomCoordinates_(h,v,y[T],a,A),m.push(A)}this.instructions.push([ke.CUSTOM,c,m,e,i,rA,s]),this.hitDetectionInstructions.push([ke.CUSTOM,c,m,e,r||i,rA,s]);break;case"Polygon":case"MultiLineString":g=[],h=o=="Polygon"?e.getOrientedFlatCoordinates():e.getFlatCoordinates(),v=this.drawCustomCoordinates_(h,0,e.getEnds(),a,g),this.instructions.push([ke.CUSTOM,c,g,e,i,m0,s]),this.hitDetectionInstructions.push([ke.CUSTOM,c,g,e,r||i,m0,s]);break;case"LineString":case"Circle":h=e.getFlatCoordinates(),d=this.appendFlatLineCoordinates(h,0,h.length,a,!1,!1),this.instructions.push([ke.CUSTOM,c,d,e,i,zl,s]),this.hitDetectionInstructions.push([ke.CUSTOM,c,d,e,r||i,zl,s]);break;case"MultiPoint":h=e.getFlatCoordinates(),d=this.appendFlatPointCoordinates(h,a),d>c&&(this.instructions.push([ke.CUSTOM,c,d,e,i,zl,s]),this.hitDetectionInstructions.push([ke.CUSTOM,c,d,e,r||i,zl,s]));break;case"Point":h=e.getFlatCoordinates(),this.coordinates.push(h[0],h[1]),d=this.coordinates.length,this.instructions.push([ke.CUSTOM,c,d,e,i,void 0,s]),this.hitDetectionInstructions.push([ke.CUSTOM,c,d,e,r||i,void 0,s]);break}this.endGeometry(t)}beginGeometry(e,t,i){this.beginGeometryInstruction1_=[ke.BEGIN_GEOMETRY,t,0,e,i],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[ke.BEGIN_GEOMETRY,t,0,e,i],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const e=this.hitDetectionInstructions;e.reverse();let t;const i=e.length;let r,s,o=-1;for(t=0;t<i;++t)r=e[t],s=r[0],s==ke.END_GEOMETRY?o=t:s==ke.BEGIN_GEOMETRY&&(r[2]=t,d5(this.hitDetectionInstructions,o,t),o=-1)}fillStyleToState(e,t={}){if(e){const i=e.getColor();t.fillPatternScale=i&&typeof i=="object"&&"src"in i?this.pixelRatio:1,t.fillStyle=xs(i||Ii)}else t.fillStyle=void 0;return t}strokeStyleToState(e,t={}){if(e){const i=e.getColor();t.strokeStyle=xs(i||Df);const r=e.getLineCap();t.lineCap=r!==void 0?r:hh;const s=e.getLineDash();t.lineDash=s?s.slice():fo;const o=e.getLineDashOffset();t.lineDashOffset=o||go;const a=e.getLineJoin();t.lineJoin=a!==void 0?a:dh;const c=e.getWidth();t.lineWidth=c!==void 0?c:Vf;const h=e.getMiterLimit();t.miterLimit=h!==void 0?h:Nf,t.lineWidth>this.maxLineWidth&&(this.maxLineWidth=t.lineWidth,this.bufferedMaxExtent_=null)}else t.strokeStyle=void 0,t.lineCap=void 0,t.lineDash=null,t.lineDashOffset=void 0,t.lineJoin=void 0,t.lineWidth=void 0,t.miterLimit=void 0;return t}setFillStrokeStyle(e,t){const i=this.state;this.fillStyleToState(e,i),this.strokeStyleToState(t,i)}createFill(e){const t=e.fillStyle,i=[ke.SET_FILL_STYLE,t];return typeof t!="string"&&i.push(e.fillPatternScale),i}applyStroke(e){this.instructions.push(this.createStroke(e))}createStroke(e){return[ke.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth*this.pixelRatio,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash?this.applyPixelRatio(e.lineDash):null,e.lineDashOffset*this.pixelRatio]}updateFillStyle(e,t){const i=e.fillStyle;(typeof i!="string"||e.currentFillStyle!=i)&&(this.instructions.push(t.call(this,e)),e.currentFillStyle=i)}updateStrokeStyle(e,t){const i=e.strokeStyle,r=e.lineCap,s=e.lineDash,o=e.lineDashOffset,a=e.lineJoin,c=e.lineWidth,h=e.miterLimit;(e.currentStrokeStyle!=i||e.currentLineCap!=r||s!=e.currentLineDash&&!qa(e.currentLineDash,s)||e.currentLineDashOffset!=o||e.currentLineJoin!=a||e.currentLineWidth!=c||e.currentMiterLimit!=h)&&(t.call(this,e),e.currentStrokeStyle=i,e.currentLineCap=r,e.currentLineDash=s,e.currentLineDashOffset=o,e.currentLineJoin=a,e.currentLineWidth=c,e.currentMiterLimit=h)}endGeometry(e){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const t=[ke.END_GEOMETRY,e];this.instructions.push(t),this.hitDetectionInstructions.push(t)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=XM(this.maxExtent),this.maxLineWidth>0)){const e=this.resolution*(this.maxLineWidth+1)/2;kf(this.bufferedMaxExtent_,e,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}class m8 extends Tg{constructor(e,t,i,r){super(e,t,i,r),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(e,t,i){if(!this.image_||this.maxExtent&&!lh(this.maxExtent,e.getFlatCoordinates()))return;this.beginGeometry(e,t,i);const r=e.getFlatCoordinates(),s=e.getStride(),o=this.coordinates.length,a=this.appendFlatPointCoordinates(r,s);this.instructions.push([ke.DRAW_IMAGE,o,a,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([ke.DRAW_IMAGE,o,a,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}drawMultiPoint(e,t,i){if(!this.image_)return;this.beginGeometry(e,t,i);const r=e.getFlatCoordinates(),s=[];for(let c=0,h=r.length;c<h;c+=e.getStride())(!this.maxExtent||lh(this.maxExtent,r.slice(c,c+2)))&&s.push(r[c],r[c+1]);const o=this.coordinates.length,a=this.appendFlatPointCoordinates(s,2);this.instructions.push([ke.DRAW_IMAGE,o,a,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([ke.DRAW_IMAGE,o,a,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(e,t){const i=e.getAnchor(),r=e.getSize(),s=e.getOrigin();this.imagePixelRatio_=e.getPixelRatio(this.pixelRatio),this.anchorX_=i[0],this.anchorY_=i[1],this.hitDetectionImage_=e.getHitDetectionImage(),this.image_=e.getImage(this.pixelRatio),this.height_=r[1],this.opacity_=e.getOpacity(),this.originX_=s[0],this.originY_=s[1],this.rotateWithView_=e.getRotateWithView(),this.rotation_=e.getRotation(),this.scale_=e.getScaleArray(),this.width_=r[0],this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}class p8 extends Tg{constructor(e,t,i,r){super(e,t,i,r)}drawFlatCoordinates_(e,t,i,r){const s=this.coordinates.length,o=this.appendFlatLineCoordinates(e,t,i,r,!1,!1),a=[ke.MOVE_TO_LINE_TO,s,o];return this.instructions.push(a),this.hitDetectionInstructions.push(a),i}drawLineString(e,t,i){const r=this.state,s=r.strokeStyle,o=r.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(e,t,i),this.hitDetectionInstructions.push([ke.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,fo,go],Wl);const a=e.getFlatCoordinates(),c=e.getStride();this.drawFlatCoordinates_(a,0,a.length,c),this.hitDetectionInstructions.push(Sa),this.endGeometry(t)}drawMultiLineString(e,t,i){const r=this.state,s=r.strokeStyle,o=r.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(e,t,i),this.hitDetectionInstructions.push([ke.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,fo,go],Wl);const a=e.getEnds(),c=e.getFlatCoordinates(),h=e.getStride();let d=0;for(let g=0,m=a.length;g<m;++g)d=this.drawFlatCoordinates_(c,d,a[g],h);this.hitDetectionInstructions.push(Sa),this.endGeometry(t)}finish(){const e=this.state;return e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&this.instructions.push(Sa),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(e){e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&(this.instructions.push(Sa),e.lastStroke=this.coordinates.length),e.lastStroke=0,super.applyStroke(e),this.instructions.push(Wl)}}class xA extends Tg{constructor(e,t,i,r){super(e,t,i,r)}drawFlatCoordinatess_(e,t,i,r){const s=this.state,o=s.fillStyle!==void 0,a=s.strokeStyle!==void 0,c=i.length;this.instructions.push(Wl),this.hitDetectionInstructions.push(Wl);for(let h=0;h<c;++h){const d=i[h],g=this.coordinates.length,m=this.appendFlatLineCoordinates(e,t,d,r,!0,!a),v=[ke.MOVE_TO_LINE_TO,g,m];this.instructions.push(v),this.hitDetectionInstructions.push(v),a&&(this.instructions.push(wA),this.hitDetectionInstructions.push(wA)),t=d}return o&&(this.instructions.push(mp),this.hitDetectionInstructions.push(mp)),a&&(this.instructions.push(Sa),this.hitDetectionInstructions.push(Sa)),t}drawCircle(e,t,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([ke.SET_FILL_STYLE,Ii]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([ke.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,fo,go]);const a=e.getFlatCoordinates(),c=e.getStride(),h=this.coordinates.length;this.appendFlatLineCoordinates(a,0,a.length,c,!1,!1);const d=[ke.CIRCLE,h];this.instructions.push(Wl,d),this.hitDetectionInstructions.push(Wl,d),r.fillStyle!==void 0&&(this.instructions.push(mp),this.hitDetectionInstructions.push(mp)),r.strokeStyle!==void 0&&(this.instructions.push(Sa),this.hitDetectionInstructions.push(Sa)),this.endGeometry(t)}drawPolygon(e,t,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([ke.SET_FILL_STYLE,Ii]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([ke.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,fo,go]);const a=e.getEnds(),c=e.getOrientedFlatCoordinates(),h=e.getStride();this.drawFlatCoordinatess_(c,0,a,h),this.endGeometry(t)}drawMultiPolygon(e,t,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([ke.SET_FILL_STYLE,Ii]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([ke.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,fo,go]);const a=e.getEndss(),c=e.getOrientedFlatCoordinates(),h=e.getStride();let d=0;for(let g=0,m=a.length;g<m;++g)d=this.drawFlatCoordinatess_(c,d,a[g],h);this.endGeometry(t)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const e=this.tolerance;if(e!==0){const t=this.coordinates;for(let i=0,r=t.length;i<r;++i)t[i]=Pl(t[i],e)}return super.finish()}setFillStrokeStyles_(){const e=this.state;this.updateFillStyle(e,this.createFill),this.updateStrokeStyle(e,this.applyStroke)}}function _8(n,e,t,i,r){const s=[];let o=t,a=0,c=e.slice(t,2);for(;a<n&&o+r<i;){const[h,d]=c.slice(-2),g=e[o+r],m=e[o+r+1],v=Math.sqrt((g-h)*(g-h)+(m-d)*(m-d));if(a+=v,a>=n){const y=(n-a+v)/v,T=Ki(h,g,y),w=Ki(d,m,y);c.push(T,w),s.push(c),c=[T,w],a==n&&(o+=r),a=0}else if(a<n)c.push(e[o+r],e[o+r+1]),o+=r;else{const y=v-a,T=Ki(h,g,y/v),w=Ki(d,m,y/v);c.push(T,w),s.push(c),c=[T,w],a=0,o+=r}}return a>0&&s.push(c),s}function y8(n,e,t,i,r){let s=t,o=t,a=0,c=0,h=t,d,g,m,v,y,T,w,A,P,C;for(g=t;g<i;g+=r){const N=e[g],D=e[g+1];y!==void 0&&(P=N-y,C=D-T,v=Math.sqrt(P*P+C*C),w!==void 0&&(c+=m,d=Math.acos((w*P+A*C)/(m*v)),d>n&&(c>a&&(a=c,s=h,o=g),c=0,h=g-r)),m=v,w=P,A=C),y=N,T=D}return c+=v,c>a?[h,g]:[s,o]}const w0={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class v8 extends Tg{constructor(e,t,i,r){super(e,t,i,r),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textKeepUpright_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[Ii]={fillStyle:Ii},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const e=super.finish();return e.textStates=this.textStates,e.fillStates=this.fillStates,e.strokeStates=this.strokeStates,e}drawText(e,t,i){const r=this.textFillState_,s=this.textStrokeState_,o=this.textState_;if(this.text_===""||!o||!r&&!s)return;const a=this.coordinates;let c=a.length;const h=e.getType();let d=null,g=e.getStride();if(o.placement==="line"&&(h=="LineString"||h=="MultiLineString"||h=="Polygon"||h=="MultiPolygon")){if(!Ri(this.maxExtent,e.getExtent()))return;let m;if(d=e.getFlatCoordinates(),h=="LineString")m=[d.length];else if(h=="MultiLineString")m=e.getEnds();else if(h=="Polygon")m=e.getEnds().slice(0,1);else if(h=="MultiPolygon"){const w=e.getEndss();m=[];for(let A=0,P=w.length;A<P;++A)m.push(w[A][0])}this.beginGeometry(e,t,i);const v=o.repeat,y=v?void 0:o.textAlign;let T=0;for(let w=0,A=m.length;w<A;++w){let P;v?P=_8(v*this.resolution,d,T,m[w],g):P=[d.slice(T,m[w])];for(let C=0,N=P.length;C<N;++C){const D=P[C];let z=0,k=D.length;if(y==null){const L=y8(o.maxAngle,D,0,D.length,2);z=L[0],k=L[1]}for(let L=z;L<k;L+=g)a.push(D[L],D[L+1]);const R=a.length;T=m[w],this.drawChars_(c,R),c=R}}this.endGeometry(t)}else{let m=o.overflow?null:[];switch(h){case"Point":case"MultiPoint":d=e.getFlatCoordinates();break;case"LineString":d=e.getFlatMidpoint();break;case"Circle":d=e.getCenter();break;case"MultiLineString":d=e.getFlatMidpoints(),g=2;break;case"Polygon":d=e.getFlatInteriorPoint(),o.overflow||m.push(d[2]/this.resolution),g=3;break;case"MultiPolygon":const N=e.getFlatInteriorPoints();d=[];for(let D=0,z=N.length;D<z;D+=3)o.overflow||m.push(N[D+2]/this.resolution),d.push(N[D],N[D+1]);if(d.length===0)return;g=2;break}const v=this.appendFlatPointCoordinates(d,g);if(v===c)return;if(m&&(v-c)/2!==d.length/g){let N=c/2;m=m.filter((D,z)=>{const k=a[(N+z)*2]===d[z*g]&&a[(N+z)*2+1]===d[z*g+1];return k||--N,k})}this.saveTextStates_();const y=o.backgroundFill?this.createFill(this.fillStyleToState(o.backgroundFill)):null,T=o.backgroundStroke?this.createStroke(this.strokeStyleToState(o.backgroundStroke)):null;this.beginGeometry(e,t,i);let w=o.padding;if(w!=$l&&(o.scale[0]<0||o.scale[1]<0)){let N=o.padding[0],D=o.padding[1],z=o.padding[2],k=o.padding[3];o.scale[0]<0&&(D=-D,k=-k),o.scale[1]<0&&(N=-N,z=-z),w=[N,D,z,k]}const A=this.pixelRatio;this.instructions.push([ke.DRAW_IMAGE,c,v,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,w==$l?$l:w.map(function(N){return N*A}),y,T,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,m]);const P=1/A,C=y?y.slice(0):null;C&&(C[1]=Ii),this.hitDetectionInstructions.push([ke.DRAW_IMAGE,c,v,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[P,P],NaN,this.declutterMode_,this.declutterImageWithText_,w,C,T,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?Ii:this.fillKey_,this.textOffsetX_,this.textOffsetY_,m]),this.endGeometry(t)}}saveTextStates_(){const e=this.textStrokeState_,t=this.textState_,i=this.textFillState_,r=this.strokeKey_;e&&(r in this.strokeStates||(this.strokeStates[r]={strokeStyle:e.strokeStyle,lineCap:e.lineCap,lineDashOffset:e.lineDashOffset,lineWidth:e.lineWidth,lineJoin:e.lineJoin,miterLimit:e.miterLimit,lineDash:e.lineDash}));const s=this.textKey_;s in this.textStates||(this.textStates[s]={font:t.font,textAlign:t.textAlign||Of,justify:t.justify,textBaseline:t.textBaseline||E0,scale:t.scale});const o=this.fillKey_;i&&(o in this.fillStates||(this.fillStates[o]={fillStyle:i.fillStyle}))}drawChars_(e,t){const i=this.textStrokeState_,r=this.textState_,s=this.strokeKey_,o=this.textKey_,a=this.fillKey_;this.saveTextStates_();const c=this.pixelRatio,h=w0[r.textBaseline],d=this.textOffsetY_*c,g=this.text_,m=i?i.lineWidth*Math.abs(r.scale[0])/2:0;this.instructions.push([ke.DRAW_CHARS,e,t,h,r.overflow,a,r.maxAngle,c,d,s,m*c,g,o,1,this.declutterMode_,this.textKeepUpright_]),this.hitDetectionInstructions.push([ke.DRAW_CHARS,e,t,h,r.overflow,a&&Ii,r.maxAngle,c,d,s,m*c,g,o,1/c,this.declutterMode_,this.textKeepUpright_])}setTextStyle(e,t){let i,r,s;if(!e)this.text_="";else{const o=e.getFill();o?(r=this.textFillState_,r||(r={},this.textFillState_=r),r.fillStyle=xs(o.getColor()||Ii)):(r=null,this.textFillState_=r);const a=e.getStroke();if(!a)s=null,this.textStrokeState_=s;else{s=this.textStrokeState_,s||(s={},this.textStrokeState_=s);const T=a.getLineDash(),w=a.getLineDashOffset(),A=a.getWidth(),P=a.getMiterLimit();s.lineCap=a.getLineCap()||hh,s.lineDash=T?T.slice():fo,s.lineDashOffset=w===void 0?go:w,s.lineJoin=a.getLineJoin()||dh,s.lineWidth=A===void 0?Vf:A,s.miterLimit=P===void 0?Nf:P,s.strokeStyle=xs(a.getColor()||Df)}i=this.textState_;const c=e.getFont()||kb;O6(c);const h=e.getScaleArray();i.overflow=e.getOverflow(),i.font=c,i.maxAngle=e.getMaxAngle(),i.placement=e.getPlacement(),i.textAlign=e.getTextAlign(),i.repeat=e.getRepeat(),i.justify=e.getJustify(),i.textBaseline=e.getTextBaseline()||E0,i.backgroundFill=e.getBackgroundFill(),i.backgroundStroke=e.getBackgroundStroke(),i.padding=e.getPadding()||$l,i.scale=h===void 0?[1,1]:h;const d=e.getOffsetX(),g=e.getOffsetY(),m=e.getRotateWithView(),v=e.getKeepUpright(),y=e.getRotation();this.text_=e.getText()||"",this.textOffsetX_=d===void 0?0:d,this.textOffsetY_=g===void 0?0:g,this.textRotateWithView_=m===void 0?!1:m,this.textKeepUpright_=v===void 0?!0:v,this.textRotation_=y===void 0?0:y,this.strokeKey_=s?(typeof s.strokeStyle=="string"?s.strokeStyle:ct(s.strokeStyle))+s.lineCap+s.lineDashOffset+"|"+s.lineWidth+s.lineJoin+s.miterLimit+"["+s.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.repeat||"?")+(i.justify||"?")+(i.textBaseline||"?"),this.fillKey_=r&&r.fillStyle?typeof r.fillStyle=="string"?r.fillStyle:"|"+ct(r.fillStyle):""}this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}const E8={Circle:xA,Default:Tg,Image:m8,LineString:p8,Polygon:xA,Text:v8};class w8{constructor(e,t,i,r){this.tolerance_=e,this.maxExtent_=t,this.pixelRatio_=r,this.resolution_=i,this.buildersByZIndex_={}}finish(){const e={};for(const t in this.buildersByZIndex_){e[t]=e[t]||{};const i=this.buildersByZIndex_[t];for(const r in i){const s=i[r].finish();e[t][r]=s}}return e}getBuilder(e,t){const i=e!==void 0?e.toString():"0";let r=this.buildersByZIndex_[i];r===void 0&&(r={},this.buildersByZIndex_[i]=r);let s=r[t];if(s===void 0){const o=E8[t];s=new o(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),r[t]=s}return s}}function x8(n,e,t,i,r,s,o,a,c,h,d,g,m=!0){let v=n[e],y=n[e+1],T=0,w=0,A=0,P=0;function C(){T=v,w=y,e+=i,v=n[e],y=n[e+1],P+=A,A=Math.sqrt((v-T)*(v-T)+(y-w)*(y-w))}do C();while(e<t-i&&P+A<s);let N=A===0?0:(s-P)/A;const D=Ki(T,v,N),z=Ki(w,y,N),k=e-i,R=P,L=s+a*c(h,r,d);for(;e<t-i&&P+A<L;)C();N=A===0?0:(L-P)/A;const F=Ki(T,v,N),j=Ki(w,y,N);let U=!1;if(m)if(g){const de=[D,z,F,j];mb(de,0,4,2,g,de,de),U=de[0]>de[2]}else U=D>F;const O=Math.PI,ce=[],we=k+i===e;e=k,A=0,P=R,v=n[e],y=n[e+1];let ye;if(we){C(),ye=Math.atan2(y-w,v-T),U&&(ye+=ye>0?-O:O);const de=(F+D)/2,J=(j+z)/2;return ce[0]=[de,J,(L-s)/2,ye,r],ce}r=r.replace(/\n/g," ");for(let de=0,J=r.length;de<J;){C();let ae=Math.atan2(y-w,v-T);if(U&&(ae+=ae>0?-O:O),ye!==void 0){let Pe=ae-ye;if(Pe+=Pe>O?-2*O:Pe<-O?2*O:0,Math.abs(Pe)>o)return null}ye=ae;const ie=de;let $=0;for(;de<J;++de){const Pe=U?J-de-1:de,Oe=a*c(h,r[Pe],d);if(e+i<t&&P+A<s+$+Oe/2)break;$+=Oe}if(de===ie)continue;const K=U?r.substring(J-ie,J-de):r.substring(ie,de);N=A===0?0:(s+$/2-P)/A;const Ae=Ki(T,v,N),Re=Ki(w,y,N);ce.push([Ae,Re,$/2,ae,K]),s+=$}return ce}class Kb{constructor(){this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(y0(),{get:(e,t)=>{if(typeof y0()[t]=="function")return this.push_(t),this.pushMethodArgs_},set:(e,t,i)=>(this.push_(t,i),!0)})}push_(...e){const t=this.instructions_,i=this.zIndex+this.offset_;t[i]||(t[i]=[]),t[i].push(...e)}pushMethodArgs_=(...e)=>(this.push_(e),this);pushFunction(e){this.push_(e)}getContext(){return this.context_}draw(e){this.instructions_.forEach(t=>{for(let i=0,r=t.length;i<r;++i){const s=t[i];if(typeof s=="function"){s(e);continue}const o=t[++i];if(typeof e[s]=="function")e[s](...o);else{if(typeof o=="function"){e[s]=o(e);continue}e[s]=o}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}}const gu=Zi(),ta=[],io=[],ro=[],na=[];function SA(n){return n[3].declutterBox}const TA=new RegExp("[-----]");function c1(n,e){return e==="start"?e=TA.test(n)?"right":"left":e==="end"&&(e=TA.test(n)?"left":"right"),w0[e]}function S8(n,e,t){return t>0&&n.push(`
`,""),n.push(e,""),n}function T8(n,e,t){return t%2===0&&(n+=e),n}class I8{constructor(e,t,i,r,s){this.overlaps=i,this.pixelRatio=t,this.resolution=e,this.alignAndScaleFill_,this.instructions=r.instructions,this.coordinates=r.coordinates,this.coordinateCache_={},this.renderedTransform_=Hr(),this.hitDetectionInstructions=r.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=r.fillStates||{},this.strokeStates=r.strokeStates||{},this.textStates=r.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=s?new Kb:null}getZIndexContext(){return this.zIndexContext_}createLabel(e,t,i,r){const s=e+t+i+r;if(this.labels_[s])return this.labels_[s];const o=r?this.strokeStates[r]:null,a=i?this.fillStates[i]:null,c=this.textStates[t],h=this.pixelRatio,d=[c.scale[0]*h,c.scale[1]*h],g=c.justify?w0[c.justify]:c1(Array.isArray(e)?e[0]:e,c.textAlign||Of),m=r&&o.lineWidth?o.lineWidth:0,v=Array.isArray(e)?e:String(e).split(`
`).reduce(S8,[]),{width:y,height:T,widths:w,heights:A,lineWidths:P}=F6(c,v),C=y+m,N=[],D=(C+2)*d[0],z=(T+m)*d[1],k={width:D<0?Math.floor(D):Math.ceil(D),height:z<0?Math.floor(z):Math.ceil(z),contextInstructions:N};(d[0]!=1||d[1]!=1)&&N.push("scale",d),r&&(N.push("strokeStyle",o.strokeStyle),N.push("lineWidth",m),N.push("lineCap",o.lineCap),N.push("lineJoin",o.lineJoin),N.push("miterLimit",o.miterLimit),N.push("setLineDash",[o.lineDash]),N.push("lineDashOffset",o.lineDashOffset)),i&&N.push("fillStyle",a.fillStyle),N.push("textBaseline","middle"),N.push("textAlign","center");const R=.5-g;let L=g*C+R*m;const F=[],j=[];let U=0,O=0,ce=0,we=0,ye;for(let de=0,J=v.length;de<J;de+=2){const ae=v[de];if(ae===`
`){O+=U,U=0,L=g*C+R*m,++we;continue}const ie=v[de+1]||c.font;ie!==ye&&(r&&F.push("font",ie),i&&j.push("font",ie),ye=ie),U=Math.max(U,A[ce]);const $=[ae,L+R*w[ce]+g*(w[ce]-P[we]),.5*(m+U)+O];L+=w[ce],r&&F.push("strokeText",$),i&&j.push("fillText",$),++ce}return Array.prototype.push.apply(N,F),Array.prototype.push.apply(N,j),this.labels_[s]=k,k}replayTextBackground_(e,t,i,r,s,o,a){e.beginPath(),e.moveTo.apply(e,t),e.lineTo.apply(e,i),e.lineTo.apply(e,r),e.lineTo.apply(e,s),e.lineTo.apply(e,t),o&&(this.alignAndScaleFill_=o[2],e.fillStyle=o[1],this.fill_(e)),a&&(this.setStrokeStyle_(e,a),e.stroke())}calculateImageOrLabelDimensions_(e,t,i,r,s,o,a,c,h,d,g,m,v,y,T,w){a*=m[0],c*=m[1];let A=i-a,P=r-c;const C=s+h>e?e-h:s,N=o+d>t?t-d:o,D=y[3]+C*m[0]+y[1],z=y[0]+N*m[1]+y[2],k=A-y[3],R=P-y[0];(T||g!==0)&&(ta[0]=k,na[0]=k,ta[1]=R,io[1]=R,io[0]=k+D,ro[0]=io[0],ro[1]=R+z,na[1]=ro[1]);let L;return g!==0?(L=yo(Hr(),i,r,1,1,g,-i,-r),An(L,ta),An(L,io),An(L,ro),An(L,na),Da(Math.min(ta[0],io[0],ro[0],na[0]),Math.min(ta[1],io[1],ro[1],na[1]),Math.max(ta[0],io[0],ro[0],na[0]),Math.max(ta[1],io[1],ro[1],na[1]),gu)):Da(Math.min(k,k+D),Math.min(R,R+z),Math.max(k,k+D),Math.max(R,R+z),gu),v&&(A=Math.round(A),P=Math.round(P)),{drawImageX:A,drawImageY:P,drawImageW:C,drawImageH:N,originX:h,originY:d,declutterBox:{minX:gu[0],minY:gu[1],maxX:gu[2],maxY:gu[3],value:w},canvasTransform:L,scale:m}}replayImageOrLabel_(e,t,i,r,s,o,a){const c=!!(o||a),h=r.declutterBox,d=a?a[2]*r.scale[0]/2:0;return h.minX-d<=t[0]&&h.maxX+d>=0&&h.minY-d<=t[1]&&h.maxY+d>=0&&(c&&this.replayTextBackground_(e,ta,io,ro,na,o,a),j6(e,r.canvasTransform,s,i,r.originX,r.originY,r.drawImageW,r.drawImageH,r.drawImageX,r.drawImageY,r.scale)),!0}fill_(e){const t=this.alignAndScaleFill_;if(t){const i=An(this.renderedTransform_,[0,0]),r=512*this.pixelRatio;e.save(),e.translate(i[0]%r,i[1]%r),t!==1&&e.scale(t,t),e.rotate(this.viewRotation_)}e.fill(),t&&e.restore()}setStrokeStyle_(e,t){e.strokeStyle=t[1],t[1]&&(e.lineWidth=t[2],e.lineCap=t[3],e.lineJoin=t[4],e.miterLimit=t[5],e.lineDashOffset=t[7],e.setLineDash(t[6]))}drawLabelWithPointPlacement_(e,t,i,r){const s=this.textStates[t],o=this.createLabel(e,t,r,i),a=this.strokeStates[i],c=this.pixelRatio,h=c1(Array.isArray(e)?e[0]:e,s.textAlign||Of),d=w0[s.textBaseline||E0],g=a&&a.lineWidth?a.lineWidth:0,m=o.width/c-2*s.scale[0],v=h*m+2*(.5-h)*g,y=d*o.height/c+2*(.5-d)*g;return{label:o,anchorX:v,anchorY:y}}execute_(e,t,i,r,s,o,a,c){const h=this.zIndexContext_;let d;this.pixelCoordinates_&&qa(i,this.renderedTransform_)?d=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),d=Pa(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),e6(this.renderedTransform_,i));let g=0;const m=r.length;let v=0,y,T,w,A,P,C,N,D,z,k,R,L,F,j=0,U=0;const O=this.coordinateCache_,ce=this.viewRotation_,we=Math.round(Math.atan2(-i[1],i[0])*1e12)/1e12,ye={context:e,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:ce},de=this.instructions!=r||this.overlaps?0:200;let J,ae,ie,$;for(;g<m;){const K=r[g];switch(K[0]){case ke.BEGIN_GEOMETRY:J=K[1],$=K[3],J.getGeometry()?a!==void 0&&!Ri(a,$.getExtent())?g=K[2]+1:++g:g=K[2],h&&(h.zIndex=K[4]);break;case ke.BEGIN_PATH:j>de&&(this.fill_(e),j=0),U>de&&(e.stroke(),U=0),!j&&!U&&(e.beginPath(),P=NaN,C=NaN),++g;break;case ke.CIRCLE:v=K[1];const Re=d[v],Pe=d[v+1],Oe=d[v+2],Fe=d[v+3],Ke=Oe-Re,Ye=Fe-Pe,yt=Math.sqrt(Ke*Ke+Ye*Ye);e.moveTo(Re+yt,Pe),e.arc(Re,Pe,yt,0,2*Math.PI,!0),++g;break;case ke.CLOSE_PATH:e.closePath(),++g;break;case ke.CUSTOM:v=K[1],y=K[2];const Rr=K[3],js=K[4],gi=K[5];ye.geometry=Rr,ye.feature=J,g in O||(O[g]=[]);const mi=O[g];gi?gi(d,v,y,2,mi):(mi[0]=d[v],mi[1]=d[v+1],mi.length=2),h&&(h.zIndex=K[6]),js(mi,ye),++g;break;case ke.DRAW_IMAGE:v=K[1],y=K[2],z=K[3],T=K[4],w=K[5];let Rn=K[6];const Pn=K[7],pi=K[8],tr=K[9],Rt=K[10];let vt=K[11];const vn=K[12];let nr=K[13];A=K[14]||"declutter";const Nt=K[15];if(!z&&K.length>=20){k=K[19],R=K[20],L=K[21],F=K[22];const Yt=this.drawLabelWithPointPlacement_(k,R,L,F);z=Yt.label,K[3]=z;const sr=K[23];T=(Yt.anchorX-sr)*this.pixelRatio,K[4]=T;const Cn=K[24];w=(Yt.anchorY-Cn)*this.pixelRatio,K[5]=w,Rn=z.height,K[6]=Rn,nr=z.width,K[13]=nr}let bo;K.length>25&&(bo=K[25]);let ir,Zr,Pr;K.length>17?(ir=K[16],Zr=K[17],Pr=K[18]):(ir=$l,Zr=null,Pr=null),Rt&&we?vt+=ce:!Rt&&!we&&(vt-=ce);let Qr=0;for(;v<y;v+=2){if(bo&&bo[Qr++]<nr/this.pixelRatio)continue;const Yt=this.calculateImageOrLabelDimensions_(z.width,z.height,d[v],d[v+1],nr,Rn,T,w,pi,tr,vt,vn,s,ir,!!Zr||!!Pr,J),sr=[e,t,z,Yt,Pn,Zr,Pr];if(c){let Cn,Zt,Mn;if(Nt){const ht=y-v;if(!Nt[ht]){Nt[ht]={args:sr,declutterMode:A};continue}const rn=Nt[ht];Cn=rn.args,Zt=rn.declutterMode,delete Nt[ht],Mn=SA(Cn)}let bn,En;if(Cn&&(Zt!=="declutter"||!c.collides(Mn))&&(bn=!0),(A!=="declutter"||!c.collides(Yt.declutterBox))&&(En=!0),Zt==="declutter"&&A==="declutter"){const ht=bn&&En;bn=ht,En=ht}bn&&(Zt!=="none"&&c.insert(Mn),this.replayImageOrLabel_.apply(this,Cn)),En&&(A!=="none"&&c.insert(Yt.declutterBox),this.replayImageOrLabel_.apply(this,sr))}else this.replayImageOrLabel_.apply(this,sr)}++g;break;case ke.DRAW_CHARS:const Ja=K[1],Jr=K[2],rr=K[3],Mc=K[4];F=K[5];const es=K[6],Gs=K[7],ko=K[8];L=K[9];const ri=K[10];k=K[11],Array.isArray(k)&&(k=k.reduce(T8,"")),R=K[12];const Us=[K[13],K[13]];A=K[14]||"declutter";const ts=K[15],ns=this.textStates[R],si=ns.font,oi=[ns.scale[0]*Gs,ns.scale[1]*Gs];let It;si in this.widths_?It=this.widths_[si]:(It={},this.widths_[si]=It);const Lo=xb(d,Ja,Jr,2),Cr=Math.abs(oi[0])*uA(si,k,It);if(Mc||Cr<=Lo){const Yt=this.textStates[R].textAlign,sr=(Lo-Cr)*c1(k,Yt),Cn=x8(d,Ja,Jr,2,k,sr,es,Math.abs(oi[0]),uA,si,It,we?0:this.viewRotation_,ts);e:if(Cn){const Zt=[];let Mn,bn,En,ht,rn;if(L)for(Mn=0,bn=Cn.length;Mn<bn;++Mn){rn=Cn[Mn],En=rn[4],ht=this.createLabel(En,R,"",L),T=rn[2]+(oi[0]<0?-ri:ri),w=rr*ht.height+(.5-rr)*2*ri*oi[1]/oi[0]-ko;const un=this.calculateImageOrLabelDimensions_(ht.width,ht.height,rn[0],rn[1],ht.width,ht.height,T,w,0,0,rn[3],Us,!1,$l,!1,J);if(c&&A==="declutter"&&c.collides(un.declutterBox))break e;Zt.push([e,t,ht,un,1,null,null])}if(F)for(Mn=0,bn=Cn.length;Mn<bn;++Mn){rn=Cn[Mn],En=rn[4],ht=this.createLabel(En,R,F,""),T=rn[2],w=rr*ht.height-ko;const un=this.calculateImageOrLabelDimensions_(ht.width,ht.height,rn[0],rn[1],ht.width,ht.height,T,w,0,0,rn[3],Us,!1,$l,!1,J);if(c&&A==="declutter"&&c.collides(un.declutterBox))break e;Zt.push([e,t,ht,un,1,null,null])}c&&A!=="none"&&c.load(Zt.map(SA));for(let un=0,or=Zt.length;un<or;++un)this.replayImageOrLabel_.apply(this,Zt[un])}}++g;break;case ke.END_GEOMETRY:if(o!==void 0){J=K[1];const Yt=o(J,$,A);if(Yt)return Yt}++g;break;case ke.FILL:de?j++:this.fill_(e),++g;break;case ke.MOVE_TO_LINE_TO:for(v=K[1],y=K[2],ae=d[v],ie=d[v+1],e.moveTo(ae,ie),P=ae+.5|0,C=ie+.5|0,v+=2;v<y;v+=2)ae=d[v],ie=d[v+1],N=ae+.5|0,D=ie+.5|0,(v==y-2||N!==P||D!==C)&&(e.lineTo(ae,ie),P=N,C=D);++g;break;case ke.SET_FILL_STYLE:this.alignAndScaleFill_=K[2],j&&(this.fill_(e),j=0,U&&(e.stroke(),U=0)),e.fillStyle=K[1],++g;break;case ke.SET_STROKE_STYLE:U&&(e.stroke(),U=0),this.setStrokeStyle_(e,K),++g;break;case ke.STROKE:de?U++:e.stroke(),++g;break;default:++g;break}}j&&this.fill_(e),U&&e.stroke()}execute(e,t,i,r,s,o){this.viewRotation_=r,this.execute_(e,t,i,this.instructions,s,void 0,void 0,o)}executeHitDetection(e,t,i,r,s){return this.viewRotation_=i,this.execute_(e,[e.canvas.width,e.canvas.height],t,this.hitDetectionInstructions,!0,r,s)}}const Ol=["Polygon","Circle","LineString","Image","Text","Default"],qb=["Image","Text"],A8=Ol.filter(n=>!qb.includes(n));class R8{constructor(e,t,i,r,s,o,a){this.maxExtent_=e,this.overlaps_=r,this.pixelRatio_=i,this.resolution_=t,this.renderBuffer_=o,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=Hr(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(s,a)}clip(e,t){const i=this.getClipCoords(t);e.beginPath(),e.moveTo(i[0],i[1]),e.lineTo(i[2],i[3]),e.lineTo(i[4],i[5]),e.lineTo(i[6],i[7]),e.clip()}createExecutors_(e,t){for(const i in e){let r=this.executorsByZIndex_[i];r===void 0&&(r={},this.executorsByZIndex_[i]=r);const s=e[i];for(const o in s){const a=s[o];r[o]=new I8(this.resolution_,this.pixelRatio_,this.overlaps_,a,t)}}}hasExecutors(e){for(const t in this.executorsByZIndex_){const i=this.executorsByZIndex_[t];for(let r=0,s=e.length;r<s;++r)if(e[r]in i)return!0}return!1}forEachFeatureAtCoordinate(e,t,i,r,s,o){r=Math.round(r);const a=r*2+1,c=yo(this.hitDetectionTransform_,r+.5,r+.5,1/t,-1/t,-i,-e[0],-e[1]),h=!this.hitDetectionContext_;h&&(this.hitDetectionContext_=mn(a,a));const d=this.hitDetectionContext_;d.canvas.width!==a||d.canvas.height!==a?(d.canvas.width=a,d.canvas.height=a):h||d.clearRect(0,0,a,a);let g;this.renderBuffer_!==void 0&&(g=Zi(),cf(g,e),kf(g,t*(this.renderBuffer_+r),g));const m=P8(r);let v;function y(D,z,k){const R=d.getImageData(0,0,a,a).data;for(let L=0,F=m.length;L<F;L++)if(R[m[L]]>0){if(!o||k==="none"||v!=="Image"&&v!=="Text"||o.includes(D)){const j=(m[L]-3)/4,U=r-j%a,O=r-(j/a|0),ce=s(D,z,U*U+O*O);if(ce)return ce}d.clearRect(0,0,a,a);break}}const T=Object.keys(this.executorsByZIndex_).map(Number);T.sort(ho);let w,A,P,C,N;for(w=T.length-1;w>=0;--w){const D=T[w].toString();for(P=this.executorsByZIndex_[D],A=Ol.length-1;A>=0;--A)if(v=Ol[A],C=P[v],C!==void 0&&(N=C.executeHitDetection(d,c,i,y,g),N))return N}}getClipCoords(e){const t=this.maxExtent_;if(!t)return null;const i=t[0],r=t[1],s=t[2],o=t[3],a=[i,r,i,o,s,o,s,r];return Pa(a,0,8,2,e,a),a}isEmpty(){return ah(this.executorsByZIndex_)}execute(e,t,i,r,s,o,a){const c=Object.keys(this.executorsByZIndex_).map(Number);c.sort(a?h5:ho),o=o||Ol;const h=Ol.length;for(let d=0,g=c.length;d<g;++d){const m=c[d].toString(),v=this.executorsByZIndex_[m];for(let y=0,T=o.length;y<T;++y){const w=o[y],A=v[w];if(A!==void 0){const P=a===null?void 0:A.getZIndexContext(),C=P?P.getContext():e,N=this.maxExtent_&&w!=="Image"&&w!=="Text";if(N&&(C.save(),this.clip(C,i)),!P||w==="Text"||w==="Image"?A.execute(C,t,i,r,s,a):P.pushFunction(D=>A.execute(D,t,i,r,s,a)),N&&C.restore(),P){P.offset();const D=c[d]*h+Ol.indexOf(w);this.deferredZIndexContexts_[D]||(this.deferredZIndexContexts_[D]=[]),this.deferredZIndexContexts_[D].push(P)}}}}this.renderedContext_=e}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const e=this.deferredZIndexContexts_,t=Object.keys(e).map(Number).sort(ho);for(let i=0,r=t.length;i<r;++i)e[t[i]].forEach(s=>{s.draw(this.renderedContext_),s.clear()}),e[t[i]].length=0}}const u1={};function P8(n){if(u1[n]!==void 0)return u1[n];const e=n*2+1,t=n*n,i=new Array(t+1);for(let s=0;s<=n;++s)for(let o=0;o<=n;++o){const a=s*s+o*o;if(a>t)break;let c=i[a];c||(c=[],i[a]=c),c.push(((n+s)*e+(n+o))*4+3),s>0&&c.push(((n-s)*e+(n+o))*4+3),o>0&&(c.push(((n+s)*e+(n-o))*4+3),s>0&&c.push(((n-s)*e+(n-o))*4+3))}const r=[];for(let s=0,o=i.length;s<o;++s)i[s]&&r.push(...i[s]);return u1[n]=r,r}function IA(n,e,t,i){return t!==void 0&&i!==void 0?[t/n,i/e]:t!==void 0?t/n:i!==void 0?i/e:1}let x0=class Hb extends L_{constructor(e){e=e||{};const t=e.opacity!==void 0?e.opacity:1,i=e.rotation!==void 0?e.rotation:0,r=e.scale!==void 0?e.scale:1,s=e.rotateWithView!==void 0?e.rotateWithView:!1;super({opacity:t,rotation:i,scale:r,displacement:e.displacement!==void 0?e.displacement:[0,0],rotateWithView:s,declutterMode:e.declutterMode}),this.anchor_=e.anchor!==void 0?e.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=e.anchorOrigin!==void 0?e.anchorOrigin:"top-left",this.anchorXUnits_=e.anchorXUnits!==void 0?e.anchorXUnits:"fraction",this.anchorYUnits_=e.anchorYUnits!==void 0?e.anchorYUnits:"fraction",this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null;const o=e.img!==void 0?e.img:null;let a=e.src;_t(!(a!==void 0&&o),"`image` and `src` cannot be provided at the same time"),(a===void 0||a.length===0)&&o&&(a=o.src||ct(o)),_t(a!==void 0&&a.length>0,"A defined and non-empty `src` or `image` must be provided"),_t(!((e.width!==void 0||e.height!==void 0)&&e.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let c;if(e.src!==void 0?c=Be.IDLE:o!==void 0&&("complete"in o?o.complete?c=o.src?Be.LOADED:Be.IDLE:c=Be.LOADING:c=Be.LOADED),this.color_=e.color!==void 0?uh(e.color):null,this.iconImage_=v0(o,a,this.crossOrigin_,c,this.color_),this.offset_=e.offset!==void 0?e.offset:[0,0],this.offsetOrigin_=e.offsetOrigin!==void 0?e.offsetOrigin:"top-left",this.origin_=null,this.size_=e.size!==void 0?e.size:null,this.initialOptions_,e.width!==void 0||e.height!==void 0){let h,d;if(e.size)[h,d]=e.size;else{const g=this.getImage(1);if(g.width&&g.height)h=g.width,d=g.height;else if(g instanceof HTMLImageElement){this.initialOptions_=e;const m=()=>{if(this.unlistenImageChange(m),!this.initialOptions_)return;const v=this.iconImage_.getSize();this.setScale(IA(v[0],v[1],e.width,e.height))};this.listenImageChange(m);return}}h!==void 0&&this.setScale(IA(h,d,e.width,e.height))}}clone(){let e,t,i;return this.initialOptions_?(t=this.initialOptions_.width,i=this.initialOptions_.height):(e=this.getScale(),e=Array.isArray(e)?e.slice():e),new Hb({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:e,width:t,height:i,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let e=this.normalizedAnchor_;if(!e){e=this.anchor_;const r=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!r)return null;e=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(e[0]*=r[0]),this.anchorYUnits_=="fraction"&&(e[1]*=r[1])}if(this.anchorOrigin_!="top-left"){if(!r)return null;e===this.anchor_&&(e=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(e[0]=-e[0]+r[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(e[1]=-e[1]+r[1])}this.normalizedAnchor_=e}const t=this.getDisplacement(),i=this.getScaleArray();return[e[0]-t[0]/i[0],e[1]+t[1]/i[1]]}setAnchor(e){this.anchor_=e,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(e){return this.iconImage_.getImage(e)}getPixelRatio(e){return this.iconImage_.getPixelRatio(e)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let e=this.offset_;if(this.offsetOrigin_!="top-left"){const t=this.getSize(),i=this.iconImage_.getSize();if(!t||!i)return null;e=e.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(e[0]=i[0]-t[0]-e[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(e[1]=i[1]-t[1]-e[1])}return this.origin_=e,this.origin_}getSrc(){return this.iconImage_.getSrc()}setSrc(e){this.iconImage_=v0(null,e,this.crossOrigin_,Be.IDLE,this.color_)}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const e=this.getScaleArray();if(this.size_)return this.size_[0]*e[0];if(this.iconImage_.getImageState()==Be.LOADED)return this.iconImage_.getSize()[0]*e[0]}getHeight(){const e=this.getScaleArray();if(this.size_)return this.size_[1]*e[1];if(this.iconImage_.getImageState()==Be.LOADED)return this.iconImage_.getSize()[1]*e[1]}setScale(e){delete this.initialOptions_,super.setScale(e)}listenImageChange(e){this.iconImage_.addEventListener(He.CHANGE,e)}load(){this.iconImage_.load()}unlistenImageChange(e){this.iconImage_.removeEventListener(He.CHANGE,e)}ready(){return this.iconImage_.ready()}};const Es=.5;function C8(n,e,t,i,r,s,o,a,c){const h=r,d=n[0]*Es,g=n[1]*Es,m=mn(d,g);m.imageSmoothingEnabled=!1;const v=m.canvas,y=new U6(m,Es,r,null,o,a,null),T=t.length,w=Math.floor((256*256*256-1)/T),A={};for(let C=1;C<=T;++C){const N=t[C-1],D=N.getStyleFunction()||i;if(!D)continue;let z=D(N,s);if(!z)continue;Array.isArray(z)||(z=[z]);const R=(C*w).toString(16).padStart(7,"#00000");for(let L=0,F=z.length;L<F;++L){const j=z[L],U=j.getGeometryFunction()(N);if(!U||!Ri(h,U.getExtent()))continue;const O=j.clone(),ce=O.getFill();ce&&ce.setColor(R);const we=O.getStroke();we&&(we.setColor(R),we.setLineDash(null)),O.setText(void 0);const ye=j.getImage();if(ye){const ie=ye.getImageSize();if(!ie)continue;const $=mn(ie[0],ie[1],void 0,{alpha:!1}),K=$.canvas;$.fillStyle=R,$.fillRect(0,0,K.width,K.height),O.setImage(new x0({img:K,anchor:ye.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:ye.getOrigin(),opacity:1,size:ye.getSize(),scale:ye.getScale(),rotation:ye.getRotation(),rotateWithView:ye.getRotateWithView()}))}const de=O.getZIndex()||0;let J=A[de];J||(J={},A[de]=J,J.Polygon=[],J.Circle=[],J.LineString=[],J.Point=[]);const ae=U.getType();if(ae==="GeometryCollection"){const ie=U.getGeometriesArrayRecursive();for(let $=0,K=ie.length;$<K;++$){const Ae=ie[$];J[Ae.getType().replace("Multi","")].push(Ae,O)}}else J[ae.replace("Multi","")].push(U,O)}}const P=Object.keys(A).map(Number).sort(ho);for(let C=0,N=P.length;C<N;++C){const D=A[P[C]];for(const z in D){const k=D[z];for(let R=0,L=k.length;R<L;R+=2){y.setStyle(k[R+1]);for(let F=0,j=e.length;F<j;++F)y.setTransform(e[F]),y.drawGeometry(k[R])}}}return m.getImageData(0,0,v.width,v.height)}function M8(n,e,t){const i=[];if(t){const r=Math.floor(Math.round(n[0])*Es),s=Math.floor(Math.round(n[1])*Es),o=(kt(r,0,t.width-1)+kt(s,0,t.height-1)*t.width)*4,a=t.data[o],c=t.data[o+1],d=t.data[o+2]+256*(c+256*a),g=Math.floor((256*256*256-1)/e.length);d&&d%g===0&&i.push(e[d/g-1])}return i}class Xb extends Io{constructor(e,t,i,r){super(e),this.inversePixelTransform=t,this.frameState=i,this.context=r}}const b8=5;class k8 extends Eg{constructor(e){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=e,this.staleKeys_=new Array,this.maxStaleKeys=b8}getStaleKeys(){return this.staleKeys_}prependStaleKey(e){this.staleKeys_.unshift(e),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(e){return at()}getData(e){return null}prepareFrame(e){return at()}renderFrame(e,t){return at()}forEachFeatureAtCoordinate(e,t,i,r,s){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(e){const t=e.target;(t.getState()===Be.LOADED||t.getState()===Be.ERROR)&&this.renderIfReadyAndVisible()}loadImage(e){let t=e.getState();return t!=Be.LOADED&&t!=Be.ERROR&&e.addEventListener(He.CHANGE,this.boundHandleImageChange_),t==Be.IDLE&&(e.load(),t=e.getState()),t==Be.LOADED}renderIfReadyAndVisible(){const e=this.getLayer();e&&e.getVisible()&&e.getSourceState()==="ready"&&e.changed()}renderDeferred(e){}disposeInternal(){delete this.layer_,super.disposeInternal()}}const AA=[];let Ru=null;function L8(){Ru=mn(1,1,void 0,{willReadFrequently:!0})}class Yb extends k8{constructor(e){super(e),this.container=null,this.renderedResolution,this.tempTransform=Hr(),this.pixelTransform=Hr(),this.inversePixelTransform=Hr(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(e,t,i){Ru||L8(),Ru.clearRect(0,0,1,1);let r;try{Ru.drawImage(e,t,i,1,1,0,0,1,1),r=Ru.getImageData(0,0,1,1).data}catch{return Ru=null,null}return r}getBackground(e){let i=this.getLayer().getBackground();return typeof i=="function"&&(i=i(e.viewState.resolution)),i||void 0}useContainer(e,t,i){const r=this.getLayer().getClassName();let s,o;if(e&&e.className===r&&(!i||e&&e.style.backgroundColor&&qa(uh(e.style.backgroundColor),uh(i)))){const a=e.firstElementChild;xa(a)&&(o=a.getContext("2d"))}if(o&&r6(o.canvas.style.transform,t)?(this.container=e,this.context=o,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){s=qi?Rb():document.createElement("div"),s.className=r;let a=s.style;a.position="absolute",a.width="100%",a.height="100%",o=mn();const c=o.canvas;s.appendChild(c),a=c.style,a.position="absolute",a.left="0",a.transformOrigin="top left",this.container=s,this.context=o}!this.containerReused&&i&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=i)}clipUnrotated(e,t,i){const r=wc(i),s=T_(i),o=S_(i),a=x_(i);An(t.coordinateToPixelTransform,r),An(t.coordinateToPixelTransform,s),An(t.coordinateToPixelTransform,o),An(t.coordinateToPixelTransform,a);const c=this.inversePixelTransform;An(c,r),An(c,s),An(c,o),An(c,a),e.save(),e.beginPath(),e.moveTo(Math.round(r[0]),Math.round(r[1])),e.lineTo(Math.round(s[0]),Math.round(s[1])),e.lineTo(Math.round(o[0]),Math.round(o[1])),e.lineTo(Math.round(a[0]),Math.round(a[1])),e.clip()}prepareContainer(e,t){const i=e.extent,r=e.viewState.resolution,s=e.viewState.rotation,o=e.pixelRatio,a=Math.round(ut(i)/r*o),c=Math.round(ei(i)/r*o);yo(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/o,1/o,s,-a/2,-c/2),gb(this.inversePixelTransform,this.pixelTransform);const h=i6(this.pixelTransform);if(this.useContainer(t,h,this.getBackground(e)),!this.containerReused){const d=this.context.canvas;d.width!=a||d.height!=c?(d.width=a,d.height=c):this.context.clearRect(0,0,a,c),h!==d.style.transform&&(d.style.transform=h)}}dispatchRenderEvent_(e,t,i){const r=this.getLayer();if(r.hasListener(e)){const s=new Xb(e,this.inversePixelTransform,i,t);r.dispatchEvent(s)}}preRender(e,t){this.frameState=t,!t.declutter&&this.dispatchRenderEvent_(wr.PRERENDER,e,t)}postRender(e,t){t.declutter||this.dispatchRenderEvent_(wr.POSTRENDER,e,t)}renderDeferredInternal(e){}getRenderContext(e){return e.declutter&&!this.deferredContext_&&(this.deferredContext_=new Kb),e.declutter?this.deferredContext_.getContext():this.context}renderDeferred(e){e.declutter&&(this.dispatchRenderEvent_(wr.PRERENDER,this.context,e),e.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(e),this.dispatchRenderEvent_(wr.POSTRENDER,this.context,e))}getRenderTransform(e,t,i,r,s,o,a){const c=s/2,h=o/2,d=r/t,g=-d,m=-e[0]+a,v=-e[1];return yo(this.tempTransform,c,h,d,g,-i,m,v)}disposeInternal(){delete this.frameState,super.disposeInternal()}}class N8 extends Yb{constructor(e){super(e),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipped_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=Zi(),this.wrappedRenderedExtent_=Zi(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(e,t,i){const r=t.extent,s=t.viewState,o=s.center,a=s.resolution,c=s.projection,h=s.rotation,d=c.getExtent(),g=this.getLayer().getSource(),m=this.getLayer().getDeclutter(),v=t.pixelRatio,y=t.viewHints,T=!(y[Yn.ANIMATING]||y[Yn.INTERACTING]),w=this.context,A=Math.round(ut(r)/a*v),P=Math.round(ei(r)/a*v),C=g.getWrapX()&&c.canWrapX(),N=C?ut(d):null,D=C?Math.ceil((r[2]-d[2])/N)+1:1;let z=C?Math.floor((r[0]-d[0])/N):0;do{let k=this.getRenderTransform(o,a,0,v,A,P,z*N);t.declutter&&(k=k.slice(0)),e.execute(w,[w.canvas.width,w.canvas.height],k,h,T,i===void 0?Ol:i?qb:A8,i?m&&t.declutter[m]:void 0)}while(++z<D)}setDrawContext_(){this.opacity_!==1&&(this.targetContext_=this.context,this.context=mn(this.context.canvas.width,this.context.canvas.height,AA))}resetDrawContext_(){if(this.opacity_!==1&&this.targetContext_){const e=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=e,b_(this.context),AA.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(e){!this.replayGroup_||!this.getLayer().getDeclutter()||this.renderWorlds(this.replayGroup_,e,!0)}renderDeferredInternal(e){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}renderFrame(e,t){const i=e.layerStatesArray[e.layerIndex];this.opacity_=i.opacity;const r=e.viewState;this.prepareContainer(e,t);const s=this.context,o=this.replayGroup_;let a=o&&!o.isEmpty();if(!a&&!(this.getLayer().hasListener(wr.PRERENDER)||this.getLayer().hasListener(wr.POSTRENDER)))return this.container;if(this.setDrawContext_(),this.preRender(s,e),r.projection,this.clipped_=!1,a&&i.extent&&this.clipping){const c=wa(i.extent);a=Ri(c,e.extent),this.clipped_=a&&!$d(c,e.extent),this.clipped_&&this.clipUnrotated(s,e,c)}return a&&this.renderWorlds(o,e,this.getLayer().getDeclutter()?!1:void 0),!e.declutter&&this.clipped_&&s.restore(),this.postRender(s,e),this.renderedRotation_!==r.rotation&&(this.renderedRotation_=r.rotation,this.hitDetectionImageData_=null),e.declutter||this.resetDrawContext_(),this.container}getFeatures(e){return new Promise(t=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const i=this.frameState.size.slice(),r=this.renderedCenter_,s=this.renderedResolution_,o=this.renderedRotation_,a=this.renderedProjection_,c=this.wrappedRenderedExtent_,h=this.getLayer(),d=[],g=i[0]*Es,m=i[1]*Es;d.push(this.getRenderTransform(r,s,o,Es,g,m,0).slice());const v=h.getSource(),y=a.getExtent();if(v.getWrapX()&&a.canWrapX()&&!$d(y,c)){let T=c[0];const w=ut(y);let A=0,P;for(;T<y[0];)--A,P=w*A,d.push(this.getRenderTransform(r,s,o,Es,g,m,P).slice()),T+=w;for(A=0,T=c[2];T>y[2];)++A,P=w*A,d.push(this.getRenderTransform(r,s,o,Es,g,m,P).slice()),T-=w}this.hitDetectionImageData_=C8(i,d,this.renderedFeatures_,h.getStyleFunction(),c,s,o,hA(s,this.renderedPixelRatio_))}t(M8(e,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(e,t,i,r,s){if(!this.replayGroup_)return;const o=t.viewState.resolution,a=t.viewState.rotation,c=this.getLayer(),h={},d=function(m,v,y){const T=ct(m),w=h[T];if(w){if(w!==!0&&y<w.distanceSq){if(y===0)return h[T]=!0,s.splice(s.lastIndexOf(w),1),r(m,c,v);w.geometry=v,w.distanceSq=y}}else{if(y===0)return h[T]=!0,r(m,c,v);s.push(h[T]={feature:m,layer:c,geometry:v,distanceSq:y,callback:r})}},g=this.getLayer().getDeclutter();return this.replayGroup_.forEachFeatureAtCoordinate(e,o,a,i,d,g?t.declutter?.[g]?.all().map(m=>m.value):null)}handleFontsChanged(){const e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}prepareFrame(e){const t=this.getLayer(),i=t.getSource();if(!i)return!1;const r=e.viewHints[Yn.ANIMATING],s=e.viewHints[Yn.INTERACTING],o=t.getUpdateWhileAnimating(),a=t.getUpdateWhileInteracting();if(this.ready&&!o&&r||!a&&s)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const c=e.extent,h=e.viewState,d=h.projection,g=h.resolution,m=e.pixelRatio,v=t.getRevision(),y=t.getRenderBuffer();let T=t.getRenderOrder();T===void 0&&(T=B6);const w=h.center.slice(),A=kf(c,y*g),P=A.slice(),C=[A.slice()],N=d.getExtent();if(i.getWrapX()&&d.canWrapX()&&!$d(N,e.extent)){const ce=ut(N),we=Math.max(ut(A)/2,ce);A[0]=N[0]-we,A[2]=N[2]+we,rb(w,d);const ye=tb(C[0],d);ye[0]<N[0]&&ye[2]<N[2]?C.push([ye[0]+ce,ye[1],ye[2]+ce,ye[3]]):ye[0]>N[0]&&ye[2]>N[2]&&C.push([ye[0]-ce,ye[1],ye[2]-ce,ye[3]])}if(this.ready&&this.renderedResolution_==g&&this.renderedRevision_==v&&this.renderedRenderOrder_==T&&this.renderedFrameDeclutter_===!!e.declutter&&$d(this.wrappedRenderedExtent_,A))return qa(this.renderedExtent_,P)||(this.hitDetectionImageData_=null,this.renderedExtent_=P),this.renderedCenter_=w,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const D=new w8(Ob(g,m),A,g,m);let z;for(let ce=0,we=C.length;ce<we;++ce)i.loadFeatures(C[ce],g,d);const k=hA(g,m);let R=!0;const L=(ce,we)=>{let ye;const de=ce.getStyleFunction()||t.getStyleFunction();if(de&&(ye=de(ce,g)),ye){const J=this.renderFeature(ce,k,ye,D,z,this.getLayer().getDeclutter(),we);R=R&&!J}},F=fb(A),j=i.getFeaturesInExtent(F);T&&j.sort(T);for(let ce=0,we=j.length;ce<we;++ce)L(j[ce],ce);this.renderedFeatures_=j,this.ready=R;const U=D.finish(),O=new R8(A,g,m,i.getOverlaps(),U,t.getRenderBuffer(),!!e.declutter);return this.renderedResolution_=g,this.renderedRevision_=v,this.renderedRenderOrder_=T,this.renderedFrameDeclutter_=!!e.declutter,this.renderedExtent_=P,this.wrappedRenderedExtent_=A,this.renderedCenter_=w,this.renderedProjection_=d,this.renderedPixelRatio_=m,this.replayGroup_=O,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(e,t,i,r,s,o,a){if(!i)return!1;let c=!1;if(Array.isArray(i))for(let h=0,d=i.length;h<d;++h)c=dA(r,e,i[h],t,this.boundHandleStyleImageChange_,s,o,a)||c;else c=dA(r,e,i,t,this.boundHandleStyleImageChange_,s,o,a);return c}}let xc=0;const ci=1<<xc++,it=1<<xc++,Ai=1<<xc++,Br=1<<xc++,sc=1<<xc++,qd=1<<xc++,pp=Math.pow(2,xc)-1,dx={[ci]:"boolean",[it]:"number",[Ai]:"string",[Br]:"color",[sc]:"number[]",[qd]:"size"},D8=Object.keys(dx).map(Number).sort(ho);function O8(n){return n in dx}function Hd(n){const e=[];for(const t of D8)Xd(n,t)&&e.push(dx[t]);return e.length===0?"untyped":e.length<3?e.join(" or "):e.slice(0,-1).join(", ")+", or "+e[e.length-1]}function Xd(n,e){return(n&e)===e}function ia(n,e){return n===e}class fn{constructor(e,t){if(!O8(e))throw new Error(`literal expressions must have a specific type, got ${Hd(e)}`);this.type=e,this.value=t}}class V8{constructor(e,t,...i){this.type=e,this.operator=t,this.args=i}}function Zb(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,mapState:!1}}function Gn(n,e,t){switch(typeof n){case"boolean":{if(ia(e,Ai))return new fn(Ai,n?"true":"false");if(!Xd(e,ci))throw new Error(`got a boolean, but expected ${Hd(e)}`);return new fn(ci,n)}case"number":{if(ia(e,qd))return new fn(qd,Mi(n));if(ia(e,ci))return new fn(ci,!!n);if(ia(e,Ai))return new fn(Ai,n.toString());if(!Xd(e,it))throw new Error(`got a number, but expected ${Hd(e)}`);return new fn(it,n)}case"string":{if(ia(e,Br))return new fn(Br,ox(n));if(ia(e,ci))return new fn(ci,!!n);if(!Xd(e,Ai))throw new Error(`got a string, but expected ${Hd(e)}`);return new fn(Ai,n)}}if(!Array.isArray(n))throw new Error("expression must be an array or a primitive value");if(n.length===0)throw new Error("empty expression");if(typeof n[0]=="string")return H8(n,e,t);for(const i of n)if(typeof i!="number")throw new Error("expected an array of numbers");if(ia(e,qd)){if(n.length!==2)throw new Error(`expected an array of two values for a size, got ${n.length}`);return new fn(qd,n)}if(ia(e,Br)){if(n.length===3)return new fn(Br,[...n,1]);if(n.length===4)return new fn(Br,n);throw new Error(`expected an array of 3 or 4 values for a color, got ${n.length}`)}if(!Xd(e,sc))throw new Error(`got an array of numbers, but expected ${Hd(e)}`);return new fn(sc,n)}const te={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",LineMetric:"line-metric",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string",Has:"has"},F8={[te.Get]:Ge(Xe(1,1/0),RA),[te.Var]:Ge(Xe(1,1),j8),[te.Has]:Ge(Xe(1,1/0),RA),[te.Id]:Ge(G8,mu),[te.Concat]:Ge(Xe(2,1/0),ft(Ai)),[te.GeometryType]:Ge(U8,mu),[te.LineMetric]:Ge(mu),[te.Resolution]:Ge(h1,mu),[te.Zoom]:Ge(h1,mu),[te.Time]:Ge(h1,mu),[te.Any]:Ge(Xe(2,1/0),ft(ci)),[te.All]:Ge(Xe(2,1/0),ft(ci)),[te.Not]:Ge(Xe(1,1),ft(ci)),[te.Equal]:Ge(Xe(2,2),ft(pp)),[te.NotEqual]:Ge(Xe(2,2),ft(pp)),[te.GreaterThan]:Ge(Xe(2,2),ft(it)),[te.GreaterThanOrEqualTo]:Ge(Xe(2,2),ft(it)),[te.LessThan]:Ge(Xe(2,2),ft(it)),[te.LessThanOrEqualTo]:Ge(Xe(2,2),ft(it)),[te.Multiply]:Ge(Xe(2,1/0),PA),[te.Coalesce]:Ge(Xe(2,1/0),PA),[te.Divide]:Ge(Xe(2,2),ft(it)),[te.Add]:Ge(Xe(2,1/0),ft(it)),[te.Subtract]:Ge(Xe(2,2),ft(it)),[te.Clamp]:Ge(Xe(3,3),ft(it)),[te.Mod]:Ge(Xe(2,2),ft(it)),[te.Pow]:Ge(Xe(2,2),ft(it)),[te.Abs]:Ge(Xe(1,1),ft(it)),[te.Floor]:Ge(Xe(1,1),ft(it)),[te.Ceil]:Ge(Xe(1,1),ft(it)),[te.Round]:Ge(Xe(1,1),ft(it)),[te.Sin]:Ge(Xe(1,1),ft(it)),[te.Cos]:Ge(Xe(1,1),ft(it)),[te.Atan]:Ge(Xe(1,2),ft(it)),[te.Sqrt]:Ge(Xe(1,1),ft(it)),[te.Match]:Ge(Xe(4,1/0),CA,B8),[te.Between]:Ge(Xe(3,3),ft(it)),[te.Interpolate]:Ge(Xe(6,1/0),CA,$8),[te.Case]:Ge(Xe(3,1/0),z8,W8),[te.In]:Ge(Xe(2,2),K8),[te.Number]:Ge(Xe(1,1/0),ft(pp)),[te.String]:Ge(Xe(1,1/0),ft(pp)),[te.Array]:Ge(Xe(1,1/0),ft(it)),[te.Color]:Ge(Xe(1,4),ft(it)),[te.Band]:Ge(Xe(1,3),ft(it)),[te.Palette]:Ge(Xe(2,2),q8),[te.ToString]:Ge(Xe(1,1),ft(ci|it|Ai|Br))};function RA(n,e,t){const i=n.length-1,r=new Array(i);for(let s=0;s<i;++s){const o=n[s+1];switch(typeof o){case"number":{r[s]=new fn(it,o);break}case"string":{r[s]=new fn(Ai,o);break}default:throw new Error(`expected a string key or numeric array index for a get operation, got ${o}`)}s===0&&t.properties.add(String(o))}return r}function j8(n,e,t){const i=n[1];if(typeof i!="string")throw new Error("expected a string argument for var operation");return t.variables.add(i),[new fn(Ai,i)]}function G8(n,e,t){t.featureId=!0}function U8(n,e,t){t.geometryType=!0}function h1(n,e,t){t.mapState=!0}function mu(n,e,t){const i=n[0];if(n.length!==1)throw new Error(`expected no arguments for ${i} operation`);return[]}function Xe(n,e){return function(t,i,r){const s=t[0],o=t.length-1;if(n===e){if(o!==n){const a=n===1?"":"s";throw new Error(`expected ${n} argument${a} for ${s}, got ${o}`)}}else if(o<n||o>e){const a=e===1/0?`${n} or more`:`${n} to ${e}`;throw new Error(`expected ${a} arguments for ${s}, got ${o}`)}}}function PA(n,e,t){const i=n.length-1,r=new Array(i);for(let s=0;s<i;++s){const o=Gn(n[s+1],e,t);r[s]=o}return r}function ft(n){return function(e,t,i){const r=e.length-1,s=new Array(r);for(let o=0;o<r;++o){const a=Gn(e[o+1],n,i);s[o]=a}return s}}function z8(n,e,t){const i=n[0],r=n.length-1;if(r%2===0)throw new Error(`expected an odd number of arguments for ${i}, got ${r} instead`)}function CA(n,e,t){const i=n[0],r=n.length-1;if(r%2===1)throw new Error(`expected an even number of arguments for operation ${i}, got ${r} instead`)}function B8(n,e,t){const i=n.length-1,r=Ai|it|ci,s=Gn(n[1],r,t),o=Gn(n[n.length-1],e,t),a=new Array(i-2);for(let c=0;c<i-2;c+=2){try{const h=Gn(n[c+2],s.type,t);a[c]=h}catch(h){throw new Error(`failed to parse argument ${c+1} of match expression: ${h.message}`)}try{const h=Gn(n[c+3],o.type,t);a[c+1]=h}catch(h){throw new Error(`failed to parse argument ${c+2} of match expression: ${h.message}`)}}return[s,...a,o]}function $8(n,e,t){const i=n[1];let r;switch(i[0]){case"linear":r=1;break;case"exponential":const c=i[1];if(typeof c!="number"||c<=0)throw new Error(`expected a number base for exponential interpolation, got ${JSON.stringify(c)} instead`);r=c;break;default:throw new Error(`invalid interpolation type: ${JSON.stringify(i)}`)}const s=new fn(it,r);let o;try{o=Gn(n[2],it,t)}catch(c){throw new Error(`failed to parse argument 1 in interpolate expression: ${c.message}`)}const a=new Array(n.length-3);for(let c=0;c<a.length;c+=2){try{const h=Gn(n[c+3],it,t);a[c]=h}catch(h){throw new Error(`failed to parse argument ${c+2} for interpolate expression: ${h.message}`)}try{const h=Gn(n[c+4],e,t);a[c+1]=h}catch(h){throw new Error(`failed to parse argument ${c+3} for interpolate expression: ${h.message}`)}}return[s,o,...a]}function W8(n,e,t){const i=Gn(n[n.length-1],e,t),r=new Array(n.length-1);for(let s=0;s<r.length-1;s+=2){try{const o=Gn(n[s+1],ci,t);r[s]=o}catch(o){throw new Error(`failed to parse argument ${s} of case expression: ${o.message}`)}try{const o=Gn(n[s+2],i.type,t);r[s+1]=o}catch(o){throw new Error(`failed to parse argument ${s+1} of case expression: ${o.message}`)}}return r[r.length-1]=i,r}function K8(n,e,t){let i=n[2];if(!Array.isArray(i))throw new Error('the second argument for the "in" operator must be an array');let r;if(typeof i[0]=="string"){if(i[0]!=="literal")throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(i[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');i=i[1],r=Ai}else r=it;const s=new Array(i.length);for(let a=0;a<s.length;a++)try{const c=Gn(i[a],r,t);s[a]=c}catch(c){throw new Error(`failed to parse haystack item ${a} for "in" expression: ${c.message}`)}return[Gn(n[1],r,t),...s]}function q8(n,e,t){let i;try{i=Gn(n[1],it,t)}catch(o){throw new Error(`failed to parse first argument in palette expression: ${o.message}`)}const r=n[2];if(!Array.isArray(r))throw new Error("the second argument of palette must be an array");const s=new Array(r.length);for(let o=0;o<s.length;o++){let a;try{a=Gn(r[o],Br,t)}catch(c){throw new Error(`failed to parse color at index ${o} in palette expression: ${c.message}`)}if(!(a instanceof fn))throw new Error(`the palette color at index ${o} must be a literal value`);s[o]=a}return[i,...s]}function Ge(...n){return function(e,t,i){const r=e[0];let s;for(let o=0;o<n.length;o++){const a=n[o](e,t,i);if(o==n.length-1){if(!a)throw new Error("expected last argument validator to return the parsed args");s=a}}return new V8(t,r,...s)}}function H8(n,e,t){const i=n[0],r=F8[i];if(!r)throw new Error(`unknown operator: ${i}`);return r(n,e,t)}function Qb(n){if(!n)return"";const e=n.getType();switch(e){case"Point":case"LineString":case"Polygon":return e;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return e.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return Qb(n.getGeometries()[0]);default:return""}}function Jb(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function Ao(n,e,t){const i=Gn(n,e,t);return Yr(i)}function Yr(n,e){if(n instanceof fn){if(n.type===Br&&typeof n.value=="string"){const i=ox(n.value);return function(){return i}}return function(){return n.value}}const t=n.operator;switch(t){case te.Number:case te.String:case te.Coalesce:return X8(n);case te.Get:case te.Var:case te.Has:return Y8(n);case te.Id:return i=>i.featureId;case te.GeometryType:return i=>i.geometryType;case te.Concat:{const i=n.args.map(r=>Yr(r));return r=>"".concat(...i.map(s=>s(r).toString()))}case te.Resolution:return i=>i.resolution;case te.Any:case te.All:case te.Between:case te.In:case te.Not:return Q8(n);case te.Equal:case te.NotEqual:case te.LessThan:case te.LessThanOrEqualTo:case te.GreaterThan:case te.GreaterThanOrEqualTo:return Z8(n);case te.Multiply:case te.Divide:case te.Add:case te.Subtract:case te.Clamp:case te.Mod:case te.Pow:case te.Abs:case te.Floor:case te.Ceil:case te.Round:case te.Sin:case te.Cos:case te.Atan:case te.Sqrt:return J8(n);case te.Case:return eV(n);case te.Match:return tV(n);case te.Interpolate:return nV(n);case te.ToString:return iV(n);default:throw new Error(`Unsupported operator ${t}`)}}function X8(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Yr(n.args[s]);switch(t){case te.Coalesce:return s=>{for(let o=0;o<i;++o){const a=r[o](s);if(typeof a<"u"&&a!==null)return a}throw new Error("Expected one of the values to be non-null")};case te.Number:case te.String:return s=>{for(let o=0;o<i;++o){const a=r[o](s);if(typeof a===t)return a}throw new Error(`Expected one of the values to be a ${t}`)};default:throw new Error(`Unsupported assertion operator ${t}`)}}function Y8(n,e){const i=n.args[0].value;switch(n.operator){case te.Get:return r=>{const s=n.args;let o=r.properties[i];for(let a=1,c=s.length;a<c;++a){const d=s[a].value;o=o[d]}return o};case te.Var:return r=>r.variables[i];case te.Has:return r=>{const s=n.args;if(!(i in r.properties))return!1;let o=r.properties[i];for(let a=1,c=s.length;a<c;++a){const d=s[a].value;if(!o||!Object.hasOwn(o,d))return!1;o=o[d]}return!0};default:throw new Error(`Unsupported accessor operator ${n.operator}`)}}function Z8(n,e){const t=n.operator,i=Yr(n.args[0]),r=Yr(n.args[1]);switch(t){case te.Equal:return s=>i(s)===r(s);case te.NotEqual:return s=>i(s)!==r(s);case te.LessThan:return s=>i(s)<r(s);case te.LessThanOrEqualTo:return s=>i(s)<=r(s);case te.GreaterThan:return s=>i(s)>r(s);case te.GreaterThanOrEqualTo:return s=>i(s)>=r(s);default:throw new Error(`Unsupported comparison operator ${t}`)}}function Q8(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Yr(n.args[s]);switch(t){case te.Any:return s=>{for(let o=0;o<i;++o)if(r[o](s))return!0;return!1};case te.All:return s=>{for(let o=0;o<i;++o)if(!r[o](s))return!1;return!0};case te.Between:return s=>{const o=r[0](s),a=r[1](s),c=r[2](s);return o>=a&&o<=c};case te.In:return s=>{const o=r[0](s);for(let a=1;a<i;++a)if(o===r[a](s))return!0;return!1};case te.Not:return s=>!r[0](s);default:throw new Error(`Unsupported logical operator ${t}`)}}function J8(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Yr(n.args[s]);switch(t){case te.Multiply:return s=>{let o=1;for(let a=0;a<i;++a)o*=r[a](s);return o};case te.Divide:return s=>r[0](s)/r[1](s);case te.Add:return s=>{let o=0;for(let a=0;a<i;++a)o+=r[a](s);return o};case te.Subtract:return s=>r[0](s)-r[1](s);case te.Clamp:return s=>{const o=r[0](s),a=r[1](s);if(o<a)return a;const c=r[2](s);return o>c?c:o};case te.Mod:return s=>r[0](s)%r[1](s);case te.Pow:return s=>Math.pow(r[0](s),r[1](s));case te.Abs:return s=>Math.abs(r[0](s));case te.Floor:return s=>Math.floor(r[0](s));case te.Ceil:return s=>Math.ceil(r[0](s));case te.Round:return s=>Math.round(r[0](s));case te.Sin:return s=>Math.sin(r[0](s));case te.Cos:return s=>Math.cos(r[0](s));case te.Atan:return i===2?s=>Math.atan2(r[0](s),r[1](s)):s=>Math.atan(r[0](s));case te.Sqrt:return s=>Math.sqrt(r[0](s));default:throw new Error(`Unsupported numeric operator ${t}`)}}function eV(n,e){const t=n.args.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=Yr(n.args[r]);return r=>{for(let s=0;s<t-1;s+=2)if(i[s](r))return i[s+1](r);return i[t-1](r)}}function tV(n,e){const t=n.args.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=Yr(n.args[r]);return r=>{const s=i[0](r);for(let o=1;o<t-1;o+=2)if(s===i[o](r))return i[o+1](r);return i[t-1](r)}}function nV(n,e){const t=n.args.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=Yr(n.args[r]);return r=>{const s=i[0](r),o=i[1](r);let a,c;for(let h=2;h<t;h+=2){const d=i[h](r);let g=i[h+1](r);const m=Array.isArray(g);if(m&&(g=R6(g)),d>=o)return h===2?g:m?rV(s,o,a,c,d,g):Yd(s,o,a,c,d,g);a=d,c=g}return c}}function iV(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Yr(n.args[s]);switch(t){case te.ToString:return s=>{const o=r[0](s);return n.args[0].type===Br?ax(o):o.toString()};default:throw new Error(`Unsupported convert operator ${t}`)}}function Yd(n,e,t,i,r,s){const o=r-t;if(o===0)return i;const a=e-t,c=n===1?a/o:(Math.pow(n,a)-1)/(Math.pow(n,o)-1);return i+c*(s-i)}function rV(n,e,t,i,r,s){if(r-t===0)return i;const a=oA(i),c=oA(s);let h=c[2]-a[2];h>180?h-=360:h<-180&&(h+=360);const d=[Yd(n,e,t,a[0],r,c[0]),Yd(n,e,t,a[1],r,c[1]),a[2]+Yd(n,e,t,0,r,h),Yd(n,e,t,i[3],r,s[3])];return P6(d)}function sV(n){return!0}function oV(n){const e=Zb(),t=aV(n,e),i=Jb();return function(r,s){if(i.properties=r.getPropertiesInternal(),i.resolution=s,e.featureId){const o=r.getId();o!==void 0?i.featureId=o:i.featureId=null}return e.geometryType&&(i.geometryType=Qb(r.getGeometry())),t(i)}}function MA(n){const e=Zb(),t=n.length,i=new Array(t);for(let o=0;o<t;++o)i[o]=SE(n[o],e);const r=Jb(),s=new Array(t);return function(o,a){if(r.properties=o.getPropertiesInternal(),r.resolution=a,e.featureId){const h=o.getId();h!==void 0?r.featureId=h:r.featureId=null}let c=0;for(let h=0;h<t;++h){const d=i[h](r);d&&(s[c]=d,c+=1)}return s.length=c,s}}function aV(n,e){const t=n.length,i=new Array(t);for(let r=0;r<t;++r){const s=n[r],o="filter"in s?Ao(s.filter,ci,e):sV;let a;if(Array.isArray(s.style)){const c=s.style.length;a=new Array(c);for(let h=0;h<c;++h)a[h]=SE(s.style[h],e)}else a=[SE(s.style,e)];i[r]={filter:o,styles:a}}return function(r){const s=[];let o=!1;for(let a=0;a<t;++a){const c=i[a].filter;if(c(r)&&!(n[a].else&&o)){o=!0;for(const h of i[a].styles){const d=h(r);d&&s.push(d)}}}return s}}function SE(n,e){const t=Gf(n,"",e),i=Uf(n,"",e),r=lV(n,e),s=cV(n,e),o=Pi(n,"z-index",e);if(!t&&!i&&!r&&!s&&!ah(n))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(n));const a=new Xi;return function(c){let h=!0;if(t){const d=t(c);d&&(h=!1),a.setFill(d)}if(i){const d=i(c);d&&(h=!1),a.setStroke(d)}if(r){const d=r(c);d&&(h=!1),a.setText(d)}if(s){const d=s(c);d&&(h=!1),a.setImage(d)}return o&&a.setZIndex(o(c)),h?null:a}}function Gf(n,e,t){let i;if(e+"fill-pattern-src"in n)i=fV(n,e+"fill-",t);else{if(n[e+"fill-color"]==="none")return s=>null;i=fx(n,e+"fill-color",t)}if(!i)return null;const r=new Oa;return function(s){const o=i(s);return o===sx?null:(r.setColor(o),r)}}function Uf(n,e,t){const i=Pi(n,e+"stroke-width",t),r=fx(n,e+"stroke-color",t);if(!i&&!r)return null;const s=ao(n,e+"stroke-line-cap",t),o=ao(n,e+"stroke-line-join",t),a=e4(n,e+"stroke-line-dash",t),c=Pi(n,e+"stroke-line-dash-offset",t),h=Pi(n,e+"stroke-miter-limit",t),d=new Xl;return function(g){if(r){const m=r(g);if(m===sx)return null;d.setColor(m)}if(i&&d.setWidth(i(g)),s){const m=s(g);if(m!=="butt"&&m!=="round"&&m!=="square")throw new Error("Expected butt, round, or square line cap");d.setLineCap(m)}if(o){const m=o(g);if(m!=="bevel"&&m!=="round"&&m!=="miter")throw new Error("Expected bevel, round, or miter line join");d.setLineJoin(m)}return a&&d.setLineDash(a(g)),c&&d.setLineDashOffset(c(g)),h&&d.setMiterLimit(h(g)),d}}function lV(n,e){const t="text-",i=ao(n,t+"value",e);if(!i)return null;const r=Gf(n,t,e),s=Gf(n,t+"background-",e),o=Uf(n,t,e),a=Uf(n,t+"background-",e),c=ao(n,t+"font",e),h=Pi(n,t+"max-angle",e),d=Pi(n,t+"offset-x",e),g=Pi(n,t+"offset-y",e),m=Yu(n,t+"overflow",e),v=ao(n,t+"placement",e),y=Pi(n,t+"repeat",e),T=D_(n,t+"scale",e),w=Yu(n,t+"rotate-with-view",e),A=Pi(n,t+"rotation",e),P=ao(n,t+"align",e),C=ao(n,t+"justify",e),N=ao(n,t+"baseline",e),D=Yu(n,t+"keep-upright",e),z=e4(n,t+"padding",e),k=O_(n,t+"declutter-mode"),R=new hx({declutterMode:k});return function(L){if(R.setText(i(L)),r&&R.setFill(r(L)),s&&R.setBackgroundFill(s(L)),o&&R.setStroke(o(L)),a&&R.setBackgroundStroke(a(L)),c&&R.setFont(c(L)),h&&R.setMaxAngle(h(L)),d&&R.setOffsetX(d(L)),g&&R.setOffsetY(g(L)),m&&R.setOverflow(m(L)),v){const F=v(L);if(F!=="point"&&F!=="line")throw new Error("Expected point or line for text-placement");R.setPlacement(F)}if(y&&R.setRepeat(y(L)),T&&R.setScale(T(L)),w&&R.setRotateWithView(w(L)),A&&R.setRotation(A(L)),P){const F=P(L);if(F!=="left"&&F!=="center"&&F!=="right"&&F!=="end"&&F!=="start")throw new Error("Expected left, right, center, start, or end for text-align");R.setTextAlign(F)}if(C){const F=C(L);if(F!=="left"&&F!=="right"&&F!=="center")throw new Error("Expected left, right, or center for text-justify");R.setJustify(F)}if(N){const F=N(L);if(F!=="bottom"&&F!=="top"&&F!=="middle"&&F!=="alphabetic"&&F!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");R.setTextBaseline(F)}return z&&R.setPadding(z(L)),D&&R.setKeepUpright(D(L)),R}}function cV(n,e){return"icon-src"in n?uV(n,e):"shape-points"in n?hV(n,e):"circle-radius"in n?dV(n,e):null}function uV(n,e){const t="icon-",i=t+"src",r=t4(n[i],i),s=S0(n,t+"anchor",e),o=D_(n,t+"scale",e),a=Pi(n,t+"opacity",e),c=S0(n,t+"displacement",e),h=Pi(n,t+"rotation",e),d=Yu(n,t+"rotate-with-view",e),g=kA(n,t+"anchor-origin"),m=LA(n,t+"anchor-x-units"),v=LA(n,t+"anchor-y-units"),y=_V(n,t+"color"),T=mV(n,t+"cross-origin"),w=pV(n,t+"offset"),A=kA(n,t+"offset-origin"),P=T0(n,t+"width"),C=T0(n,t+"height"),N=gV(n,t+"size"),D=O_(n,t+"declutter-mode"),z=new x0({src:r,anchorOrigin:g,anchorXUnits:m,anchorYUnits:v,color:y,crossOrigin:T,offset:w,offsetOrigin:A,height:C,width:P,size:N,declutterMode:D});return function(k){return a&&z.setOpacity(a(k)),c&&z.setDisplacement(c(k)),h&&z.setRotation(h(k)),d&&z.setRotateWithView(d(k)),o&&z.setScale(o(k)),s&&z.setAnchor(s(k)),z}}function hV(n,e){const t="shape-",i=t+"points",r=t+"radius",s=TE(n[i],i),o=TE(n[r],r),a=Gf(n,t,e),c=Uf(n,t,e),h=D_(n,t+"scale",e),d=S0(n,t+"displacement",e),g=Pi(n,t+"rotation",e),m=Yu(n,t+"rotate-with-view",e),v=T0(n,t+"radius2"),y=T0(n,t+"angle"),T=O_(n,t+"declutter-mode"),w=new N_({points:s,radius:o,radius2:v,angle:y,declutterMode:T});return function(A){return a&&w.setFill(a(A)),c&&w.setStroke(c(A)),d&&w.setDisplacement(d(A)),g&&w.setRotation(g(A)),m&&w.setRotateWithView(m(A)),h&&w.setScale(h(A)),w}}function dV(n,e){const t="circle-",i=Gf(n,t,e),r=Uf(n,t,e),s=Pi(n,t+"radius",e),o=D_(n,t+"scale",e),a=S0(n,t+"displacement",e),c=Pi(n,t+"rotation",e),h=Yu(n,t+"rotate-with-view",e),d=O_(n,t+"declutter-mode"),g=new kh({radius:5,declutterMode:d});return function(m){return s&&g.setRadius(s(m)),i&&g.setFill(i(m)),r&&g.setStroke(r(m)),a&&g.setDisplacement(a(m)),c&&g.setRotation(c(m)),h&&g.setRotateWithView(h(m)),o&&g.setScale(o(m)),g}}function Pi(n,e,t){if(!(e in n))return;const i=Ao(n[e],it,t);return function(r){return TE(i(r),e)}}function ao(n,e,t){if(!(e in n))return null;const i=Ao(n[e],Ai,t);return function(r){return t4(i(r),e)}}function fV(n,e,t){const i=ao(n,e+"pattern-src",t),r=bA(n,e+"pattern-offset",t),s=bA(n,e+"pattern-size",t),o=fx(n,e+"color",t);return function(a){return{src:i(a),offset:r&&r(a),size:s&&s(a),color:o&&o(a)}}}function Yu(n,e,t){if(!(e in n))return null;const i=Ao(n[e],ci,t);return function(r){const s=i(r);if(typeof s!="boolean")throw new Error(`Expected a boolean for ${e}`);return s}}function fx(n,e,t){if(!(e in n))return null;const i=Ao(n[e],Br,t);return function(r){return n4(i(r),e)}}function e4(n,e,t){if(!(e in n))return null;const i=Ao(n[e],sc,t);return function(r){return Ig(i(r),e)}}function S0(n,e,t){if(!(e in n))return null;const i=Ao(n[e],sc,t);return function(r){const s=Ig(i(r),e);if(s.length!==2)throw new Error(`Expected two numbers for ${e}`);return s}}function bA(n,e,t){if(!(e in n))return null;const i=Ao(n[e],sc,t);return function(r){return i4(i(r),e)}}function D_(n,e,t){if(!(e in n))return null;const i=Ao(n[e],sc|it,t);return function(r){return yV(i(r),e)}}function T0(n,e){const t=n[e];if(t!==void 0){if(typeof t!="number")throw new Error(`Expected a number for ${e}`);return t}}function gV(n,e){const t=n[e];if(t!==void 0){if(typeof t=="number")return Mi(t);if(!Array.isArray(t))throw new Error(`Expected a number or size array for ${e}`);if(t.length!==2||typeof t[0]!="number"||typeof t[1]!="number")throw new Error(`Expected a number or size array for ${e}`);return t}}function mV(n,e){const t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);return t}}function kA(n,e){const t=n[e];if(t!==void 0){if(t!=="bottom-left"&&t!=="bottom-right"&&t!=="top-left"&&t!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${e}`);return t}}function LA(n,e){const t=n[e];if(t!==void 0){if(t!=="pixels"&&t!=="fraction")throw new Error(`Expected pixels or fraction for ${e}`);return t}}function pV(n,e){const t=n[e];if(t!==void 0)return Ig(t,e)}function O_(n,e){const t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);if(t!=="declutter"&&t!=="obstacle"&&t!=="none")throw new Error(`Expected declutter, obstacle, or none for ${e}`);return t}}function _V(n,e){const t=n[e];if(t!==void 0)return n4(t,e)}function Ig(n,e){if(!Array.isArray(n))throw new Error(`Expected an array for ${e}`);const t=n.length;for(let i=0;i<t;++i)if(typeof n[i]!="number")throw new Error(`Expected an array of numbers for ${e}`);return n}function t4(n,e){if(typeof n!="string")throw new Error(`Expected a string for ${e}`);return n}function TE(n,e){if(typeof n!="number")throw new Error(`Expected a number for ${e}`);return n}function n4(n,e){if(typeof n=="string")return n;const t=Ig(n,e),i=t.length;if(i<3||i>4)throw new Error(`Expected a color with 3 or 4 values for ${e}`);return t}function i4(n,e){const t=Ig(n,e);if(t.length!==2)throw new Error(`Expected an array of two numbers for ${e}`);return t}function yV(n,e){return typeof n=="number"?n:i4(n,e)}const Fr={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function NA(n,e,t){return(function(i,r,s,o,a){if(!i)return;if(!r&&!e)return i;const c=e?0:s[0]*r,h=e?0:s[1]*r,d=a?a[0]:0,g=a?a[1]:0;let m=n[0]+c/2+d,v=n[2]-c/2+d,y=n[1]+h/2+g,T=n[3]-h/2+g;m>v&&(m=(v+m)/2,v=m),y>T&&(y=(T+y)/2,T=y);let w=kt(i[0],m,v),A=kt(i[1],y,T);if(o&&t&&r){const P=30*r;w+=-P*Math.log(1+Math.max(0,m-i[0])/P)+P*Math.log(1+Math.max(0,i[0]-v)/P),A+=-P*Math.log(1+Math.max(0,y-i[1])/P)+P*Math.log(1+Math.max(0,i[1]-T)/P)}return[w,A]})}function vV(n){return n}function r4(n){return Math.pow(n,3)}function Lh(n){return 1-r4(1-n)}function EV(n){return 3*n*n-2*n*n*n}function wV(n){return n}function gx(n,e,t,i){const r=ut(e)/t[0],s=ei(e)/t[1];return i?Math.min(n,Math.max(r,s)):Math.min(n,Math.min(r,s))}function mx(n,e,t){let i=Math.min(n,e);const r=50;return i*=Math.log(1+r*Math.max(0,n/e-1))/r+1,t&&(i=Math.max(i,t),i/=Math.log(1+r*Math.max(0,t/n-1))/r+1),kt(i,t/2,e*2)}function xV(n,e,t,i){return e=e!==void 0?e:!0,(function(r,s,o,a){if(r!==void 0){const c=n[0],h=n[n.length-1],d=t?gx(c,t,o,i):c;if(a)return e?mx(r,d,h):kt(r,h,d);const g=Math.min(d,r),m=Math.floor(zw(n,g,s));return n[m]>d&&m<n.length-1?n[m+1]:n[m]}})}function SV(n,e,t,i,r,s){return i=i!==void 0?i:!0,t=t!==void 0?t:0,(function(o,a,c,h){if(o!==void 0){const d=r?gx(e,r,c,s):e;if(h)return i?mx(o,d,t):kt(o,t,d);const g=1e-9,m=Math.ceil(Math.log(e/d)/Math.log(n)-g),v=-a*(.5-g)+.5,y=Math.min(d,o),T=Math.floor(Math.log(e/y)/Math.log(n)+v),w=Math.max(m,T),A=e/Math.pow(n,w);return kt(A,t,d)}})}function DA(n,e,t,i,r){return t=t!==void 0?t:!0,(function(s,o,a,c){if(s!==void 0){const h=i?gx(n,i,a,r):n;return!t||!c?kt(s,e,h):mx(s,h,e)}})}function px(n){if(n!==void 0)return 0}function OA(n){if(n!==void 0)return n}function TV(n){const e=2*Math.PI/n;return(function(t,i){if(i)return t;if(t!==void 0)return t=Math.floor(t/e+.5)*e,t})}function IV(n){const e=Aa(5);return(function(t,i){return i||t===void 0?t:Math.abs(t)<=e?0:t})}const AV=42,_x=256,d1=0;class ws extends Os{constructor(e){super(),this.on,this.once,this.un,e=Object.assign({},e),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=Zw(e.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,e.projection&&db(),e.center&&(e.center=so(e.center,this.projection_)),e.extent&&(e.extent=wa(e.extent,this.projection_)),this.applyOptions_(e)}applyOptions_(e){const t=Object.assign({},e);for(const a in Fr)delete t[a];this.setProperties(t,!0);const i=PV(e);this.maxResolution_=i.maxResolution,this.minResolution_=i.minResolution,this.zoomFactor_=i.zoomFactor,this.resolutions_=e.resolutions,this.padding_=e.padding,this.minZoom_=i.minZoom;const r=RV(e),s=i.constraint,o=CV(e);this.constraints_={center:r,resolution:s,rotation:o},this.setRotation(e.rotation!==void 0?e.rotation:0),this.setCenterInternal(e.center!==void 0?e.center:null),e.resolution!==void 0?this.setResolution(e.resolution):e.zoom!==void 0&&this.setZoom(e.zoom)}get padding(){return this.padding_}set padding(e){let t=this.padding_;this.padding_=e;const i=this.getCenterInternal();if(i){const r=e||[0,0,0,0];t=t||[0,0,0,0];const s=this.getResolution(),o=s/2*(r[3]-t[3]+t[1]-r[1]),a=s/2*(r[0]-t[0]+t[2]-r[2]);this.setCenterInternal([i[0]+o,i[1]-a])}}getUpdatedOptions_(e){const t=this.getProperties();return t.resolution!==void 0?t.resolution=this.getResolution():t.zoom=this.getZoom(),t.center=this.getCenterInternal(),t.rotation=this.getRotation(),Object.assign({},t,e)}animate(e){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const t=new Array(arguments.length);for(let i=0;i<t.length;++i){let r=arguments[i];r.center&&(r=Object.assign({},r),r.center=so(r.center,this.getProjection())),r.anchor&&(r=Object.assign({},r),r.anchor=so(r.anchor,this.getProjection())),t[i]=r}this.animateInternal.apply(this,t)}animateInternal(e){let t=arguments.length,i;t>1&&typeof arguments[t-1]=="function"&&(i=arguments[t-1],--t);let r=0;for(;r<t&&!this.isDef();++r){const d=arguments[r];d.center&&this.setCenterInternal(d.center),d.zoom!==void 0?this.setZoom(d.zoom):d.resolution&&this.setResolution(d.resolution),d.rotation!==void 0&&this.setRotation(d.rotation)}if(r===t){i&&_p(i,!0);return}let s=Date.now(),o=this.targetCenter_.slice(),a=this.targetResolution_,c=this.targetRotation_;const h=[];for(;r<t;++r){const d=arguments[r],g={start:s,complete:!1,anchor:d.anchor,duration:d.duration!==void 0?d.duration:1e3,easing:d.easing||EV,callback:i};if(d.center&&(g.sourceCenter=o,g.targetCenter=d.center.slice(),o=g.targetCenter),d.zoom!==void 0?(g.sourceResolution=a,g.targetResolution=this.getResolutionForZoom(d.zoom),a=g.targetResolution):d.resolution&&(g.sourceResolution=a,g.targetResolution=d.resolution,a=g.targetResolution),d.rotation!==void 0){g.sourceRotation=c;const m=Ra(d.rotation-c+Math.PI,2*Math.PI)-Math.PI;g.targetRotation=c+m,c=g.targetRotation}MV(g)?g.complete=!0:s+=g.duration,h.push(g)}this.animations_.push(h),this.setHint(Yn.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[Yn.ANIMATING]>0}getInteracting(){return this.hints_[Yn.INTERACTING]>0}cancelAnimations(){this.setHint(Yn.ANIMATING,-this.hints_[Yn.ANIMATING]);let e;for(let t=0,i=this.animations_.length;t<i;++t){const r=this.animations_[t];if(r[0].callback&&_p(r[0].callback,!1),!e)for(let s=0,o=r.length;s<o;++s){const a=r[s];if(!a.complete){e=a.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=e,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const e=Date.now();let t=!1;for(let i=this.animations_.length-1;i>=0;--i){const r=this.animations_[i];let s=!0;for(let o=0,a=r.length;o<a;++o){const c=r[o];if(c.complete)continue;const h=e-c.start;let d=c.duration>0?h/c.duration:1;d>=1?(c.complete=!0,d=1):s=!1;const g=c.easing(d);if(c.sourceCenter){const m=c.sourceCenter[0],v=c.sourceCenter[1],y=c.targetCenter[0],T=c.targetCenter[1];this.nextCenter_=c.targetCenter;const w=m+g*(y-m),A=v+g*(T-v);this.targetCenter_=[w,A]}if(c.sourceResolution&&c.targetResolution){const m=g===1?c.targetResolution:c.sourceResolution+g*(c.targetResolution-c.sourceResolution);if(c.anchor){const v=this.getViewportSize_(this.getRotation()),y=this.constraints_.resolution(m,0,v,!0);this.targetCenter_=this.calculateCenterZoom(y,c.anchor)}this.nextResolution_=c.targetResolution,this.targetResolution_=m,this.applyTargetState_(!0)}if(c.sourceRotation!==void 0&&c.targetRotation!==void 0){const m=g===1?Ra(c.targetRotation+Math.PI,2*Math.PI)-Math.PI:c.sourceRotation+g*(c.targetRotation-c.sourceRotation);if(c.anchor){const v=this.constraints_.rotation(m,!0);this.targetCenter_=this.calculateCenterRotate(v,c.anchor)}this.nextRotation_=c.targetRotation,this.targetRotation_=m}if(this.applyTargetState_(!0),t=!0,!c.complete)break}if(s){this.animations_[i]=null,this.setHint(Yn.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const o=r[0].callback;o&&_p(o,!0)}}this.animations_=this.animations_.filter(Boolean),t&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(e,t){let i;const r=this.getCenterInternal();return r!==void 0&&(i=[r[0]-t[0],r[1]-t[1]],Ww(i,e-this.getRotation()),T5(i,t)),i}calculateCenterZoom(e,t){let i;const r=this.getCenterInternal(),s=this.getResolution();if(r!==void 0&&s!==void 0){const o=t[0]-e*(t[0]-r[0])/s,a=t[1]-e*(t[1]-r[1])/s;i=[o,a]}return i}getViewportSize_(e){const t=this.viewportSize_;if(e){const i=t[0],r=t[1];return[Math.abs(i*Math.cos(e))+Math.abs(r*Math.sin(e)),Math.abs(i*Math.sin(e))+Math.abs(r*Math.cos(e))]}return t}setViewportSize(e){this.viewportSize_=Array.isArray(e)?e.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const e=this.getCenterInternal();return e&&mE(e,this.getProjection())}getCenterInternal(){return this.get(Fr.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(e){return e!==void 0?(e[0]=this.hints_[0],e[1]=this.hints_[1],e):this.hints_.slice()}calculateExtent(e){const t=this.calculateExtentInternal(e);return fb(t,this.getProjection())}calculateExtentInternal(e){e=e||this.getViewportSizeMinusPadding_();const t=this.getCenterInternal();_t(t,"The view center is not defined");const i=this.getResolution();_t(i!==void 0,"The view resolution is not defined");const r=this.getRotation();return _t(r!==void 0,"The view rotation is not defined"),cE(t,i,r,e)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(e){this.applyOptions_(this.getUpdatedOptions_({maxZoom:e}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(e){this.applyOptions_(this.getUpdatedOptions_({minZoom:e}))}setConstrainResolution(e){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:e}))}getProjection(){return this.projection_}getResolution(){return this.get(Fr.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(e,t){return this.getResolutionForExtentInternal(wa(e,this.getProjection()),t)}getResolutionForExtentInternal(e,t){t=t||this.getViewportSizeMinusPadding_();const i=ut(e)/t[0],r=ei(e)/t[1];return Math.max(i,r)}getResolutionForValueFunction(e){e=e||2;const t=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,r=Math.log(t/i)/Math.log(e);return(function(s){return t/Math.pow(e,s*r)})}getRotation(){return this.get(Fr.ROTATION)}getValueForResolutionFunction(e){const t=Math.log(e||2),i=this.getConstrainedResolution(this.maxResolution_),r=this.minResolution_,s=Math.log(i/r)/t;return(function(o){return Math.log(i/o)/t/s})}getViewportSizeMinusPadding_(e){let t=this.getViewportSize_(e);const i=this.padding_;return i&&(t=[t[0]-i[1]-i[3],t[1]-i[0]-i[2]]),t}getState(){const e=this.getProjection(),t=this.getResolution(),i=this.getRotation();let r=this.getCenterInternal();const s=this.padding_;if(s){const o=this.getViewportSizeMinusPadding_();r=f1(r,this.getViewportSize_(),[o[0]/2+s[3],o[1]/2+s[0]],t,i)}return{center:r.slice(0),projection:e!==void 0?e:null,resolution:t,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:i,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let e;const t=this.getResolution();return t!==void 0&&(e=this.getZoomForResolution(t)),e}getZoomForResolution(e){let t=this.minZoom_||0,i,r;if(this.resolutions_){const s=zw(this.resolutions_,e,1);t=s,i=this.resolutions_[s],s==this.resolutions_.length-1?r=2:r=i/this.resolutions_[s+1]}else i=this.maxResolution_,r=this.zoomFactor_;return t+Math.log(i/e)/Math.log(r)}getResolutionForZoom(e){if(this.resolutions_?.length){if(this.resolutions_.length===1)return this.resolutions_[0];const t=kt(Math.floor(e),0,this.resolutions_.length-2),i=this.resolutions_[t]/this.resolutions_[t+1];return this.resolutions_[t]/Math.pow(i,kt(e-t,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,e-this.minZoom_)}fit(e,t){let i;if(_t(Array.isArray(e)||typeof e.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(e)){_t(!I_(e),"Cannot fit empty extent provided as `geometry`");const r=wa(e,this.getProjection());i=gA(r)}else if(e.getType()==="Circle"){const r=wa(e.getExtent(),this.getProjection());i=gA(r),i.rotate(this.getRotation(),tc(r))}else i=e;this.fitInternal(i,t)}rotatedExtentForGeometry(e){const t=this.getRotation(),i=Math.cos(t),r=Math.sin(-t),s=e.getFlatCoordinates(),o=e.getStride();let a=1/0,c=1/0,h=-1/0,d=-1/0;for(let g=0,m=s.length;g<m;g+=o){const v=s[g]*i-s[g+1]*r,y=s[g]*r+s[g+1]*i;a=Math.min(a,v),c=Math.min(c,y),h=Math.max(h,v),d=Math.max(d,y)}return[a,c,h,d]}fitInternal(e,t){t=t||{};let i=t.size;i||(i=this.getViewportSizeMinusPadding_());const r=t.padding!==void 0?t.padding:[0,0,0,0],s=t.nearest!==void 0?t.nearest:!1;let o;t.minResolution!==void 0?o=t.minResolution:t.maxZoom!==void 0?o=this.getResolutionForZoom(t.maxZoom):o=0;const a=this.rotatedExtentForGeometry(e);let c=this.getResolutionForExtentInternal(a,[i[0]-r[1]-r[3],i[1]-r[0]-r[2]]);c=isNaN(c)?o:Math.max(c,o),c=this.getConstrainedResolution(c,s?0:1);const h=this.getRotation(),d=Math.sin(h),g=Math.cos(h),m=tc(a);m[0]+=(r[1]-r[3])/2*c,m[1]+=(r[0]-r[2])/2*c;const v=m[0]*g-m[1]*d,y=m[1]*g+m[0]*d,T=this.getConstrainedCenter([v,y],c),w=t.callback?t.callback:bf;t.duration!==void 0?this.animateInternal({resolution:c,center:T,duration:t.duration,easing:t.easing},w):(this.targetResolution_=c,this.targetCenter_=T,this.applyTargetState_(!1,!0),_p(w,!0))}centerOn(e,t,i){this.centerOnInternal(so(e,this.getProjection()),t,i)}centerOnInternal(e,t,i){this.setCenterInternal(f1(e,t,i,this.getResolution(),this.getRotation()))}calculateCenterShift(e,t,i,r){let s;const o=this.padding_;if(o&&e){const a=this.getViewportSizeMinusPadding_(-i),c=f1(e,r,[a[0]/2+o[3],a[1]/2+o[0]],t,i);s=[e[0]-c[0],e[1]-c[1]]}return s}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(e){const t=mE(this.targetCenter_,this.getProjection());this.setCenter([t[0]+e[0],t[1]+e[1]])}adjustCenterInternal(e){const t=this.targetCenter_;this.setCenterInternal([t[0]+e[0],t[1]+e[1]])}adjustResolution(e,t){t=t&&so(t,this.getProjection()),this.adjustResolutionInternal(e,t)}adjustResolutionInternal(e,t){const i=this.getAnimating()||this.getInteracting(),r=this.getViewportSize_(this.getRotation()),s=this.constraints_.resolution(this.targetResolution_*e,0,r,i);t&&(this.targetCenter_=this.calculateCenterZoom(s,t)),this.targetResolution_*=e,this.applyTargetState_()}adjustZoom(e,t){this.adjustResolution(Math.pow(this.zoomFactor_,-e),t)}adjustRotation(e,t){t&&(t=so(t,this.getProjection())),this.adjustRotationInternal(e,t)}adjustRotationInternal(e,t){const i=this.getAnimating()||this.getInteracting(),r=this.constraints_.rotation(this.targetRotation_+e,i);t&&(this.targetCenter_=this.calculateCenterRotate(r,t)),this.targetRotation_+=e,this.applyTargetState_()}setCenter(e){this.setCenterInternal(e&&so(e,this.getProjection()))}setCenterInternal(e){this.targetCenter_=e,this.applyTargetState_()}setHint(e,t){return this.hints_[e]+=t,this.changed(),this.hints_[e]}setResolution(e){this.targetResolution_=e,this.applyTargetState_()}setRotation(e){this.targetRotation_=e,this.applyTargetState_()}setZoom(e){this.setResolution(this.getResolutionForZoom(e))}applyTargetState_(e,t){const i=this.getAnimating()||this.getInteracting()||t,r=this.constraints_.rotation(this.targetRotation_,i),s=this.getViewportSize_(r),o=this.constraints_.resolution(this.targetResolution_,0,s,i),a=this.constraints_.center(this.targetCenter_,o,s,i,this.calculateCenterShift(this.targetCenter_,o,r,s));this.get(Fr.ROTATION)!==r&&this.set(Fr.ROTATION,r),this.get(Fr.RESOLUTION)!==o&&(this.set(Fr.RESOLUTION,o),this.set("zoom",this.getZoom(),!0)),(!a||!this.get(Fr.CENTER)||!h0(this.get(Fr.CENTER),a))&&this.set(Fr.CENTER,a),this.getAnimating()&&!e&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(e,t,i){e=e!==void 0?e:200;const r=t||0,s=this.constraints_.rotation(this.targetRotation_),o=this.getViewportSize_(s),a=this.constraints_.resolution(this.targetResolution_,r,o),c=this.constraints_.center(this.targetCenter_,a,o,!1,this.calculateCenterShift(this.targetCenter_,a,s,o));if(e===0&&!this.cancelAnchor_){this.targetResolution_=a,this.targetRotation_=s,this.targetCenter_=c,this.applyTargetState_();return}i=i||(e===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==a||this.getRotation()!==s||!this.getCenterInternal()||!h0(this.getCenterInternal(),c))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:s,center:c,resolution:a,duration:e,easing:Lh,anchor:i}))}beginInteraction(){this.resolveConstraints(0),this.setHint(Yn.INTERACTING,1)}endInteraction(e,t,i){i=i&&so(i,this.getProjection()),this.endInteractionInternal(e,t,i)}endInteractionInternal(e,t,i){this.getInteracting()&&(this.setHint(Yn.INTERACTING,-1),this.resolveConstraints(e,t,i))}getConstrainedCenter(e,t){const i=this.getViewportSize_(this.getRotation());return this.constraints_.center(e,t||this.getResolution(),i)}getConstrainedZoom(e,t){const i=this.getResolutionForZoom(e);return this.getZoomForResolution(this.getConstrainedResolution(i,t))}getConstrainedResolution(e,t){t=t||0;const i=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(e,t,i)}}function _p(n,e){setTimeout(function(){n(e)},0)}function RV(n){if(n.extent!==void 0){const t=n.smoothExtentConstraint!==void 0?n.smoothExtentConstraint:!0;return NA(n.extent,n.constrainOnlyCenter,t)}const e=Zw(n.projection,"EPSG:3857");if(n.multiWorld!==!0&&e.isGlobal()){const t=e.getExtent().slice();return t[0]=-1/0,t[2]=1/0,NA(t,!1,!1)}return vV}function PV(n){let e,t,i,o=n.minZoom!==void 0?n.minZoom:d1,a=n.maxZoom!==void 0?n.maxZoom:28;const c=n.zoomFactor!==void 0?n.zoomFactor:2,h=n.multiWorld!==void 0?n.multiWorld:!1,d=n.smoothResolutionConstraint!==void 0?n.smoothResolutionConstraint:!0,g=n.showFullExtent!==void 0?n.showFullExtent:!1,m=Zw(n.projection,"EPSG:3857"),v=m.getExtent();let y=n.constrainOnlyCenter,T=n.extent;if(!h&&!T&&m.isGlobal()&&(y=!1,T=v),n.resolutions!==void 0){const w=n.resolutions;t=w[o],i=w[a]!==void 0?w[a]:w[w.length-1],n.constrainResolution?e=xV(w,d,!y&&T,g):e=DA(t,i,d,!y&&T,g)}else{const A=(v?Math.max(ut(v),ei(v)):360*Kw.degrees/m.getMetersPerUnit())/_x/Math.pow(2,d1),P=A/Math.pow(2,28-d1);t=n.maxResolution,t!==void 0?o=0:t=A/Math.pow(c,o),i=n.minResolution,i===void 0&&(n.maxZoom!==void 0?n.maxResolution!==void 0?i=t/Math.pow(c,a):i=A/Math.pow(c,a):i=P),a=o+Math.floor(Math.log(t/i)/Math.log(c)),i=t/Math.pow(c,a-o),n.constrainResolution?e=SV(c,t,i,d,!y&&T,g):e=DA(t,i,d,!y&&T,g)}return{constraint:e,maxResolution:t,minResolution:i,minZoom:o,zoomFactor:c}}function CV(n){if(n.enableRotation!==void 0?n.enableRotation:!0){const t=n.constrainRotation;return t===void 0||t===!0?IV():t===!1?OA:typeof t=="number"?TV(t):OA}return px}function MV(n){return!(n.sourceCenter&&n.targetCenter&&!h0(n.sourceCenter,n.targetCenter)||n.sourceResolution!==n.targetResolution||n.sourceRotation!==n.targetRotation)}function f1(n,e,t,i,r){const s=Math.cos(-r);let o=Math.sin(-r),a=n[0]*s-n[1]*o,c=n[1]*s+n[0]*o;a+=(e[0]/2-t[0])*i,c+=(t[1]-e[1]/2)*i,o=-o;const h=a*s-c*o,d=c*s+a*o;return[h,d]}const wt={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class s4 extends Os{constructor(e){super(),this.on,this.once,this.un,this.background_=e.background;const t=Object.assign({},e);typeof e.properties=="object"&&(delete t.properties,Object.assign(t,e.properties)),t[wt.OPACITY]=e.opacity!==void 0?e.opacity:1,_t(typeof t[wt.OPACITY]=="number","Layer opacity must be a number"),t[wt.VISIBLE]=e.visible!==void 0?e.visible:!0,t[wt.Z_INDEX]=e.zIndex,t[wt.MAX_RESOLUTION]=e.maxResolution!==void 0?e.maxResolution:1/0,t[wt.MIN_RESOLUTION]=e.minResolution!==void 0?e.minResolution:0,t[wt.MIN_ZOOM]=e.minZoom!==void 0?e.minZoom:-1/0,t[wt.MAX_ZOOM]=e.maxZoom!==void 0?e.maxZoom:1/0,this.className_=t.className!==void 0?t.className:"ol-layer",delete t.className,this.setProperties(t),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(e){const t=this.state_||{layer:this,managed:e===void 0?!0:e},i=this.getZIndex();return t.opacity=kt(Math.round(this.getOpacity()*100)/100,0,1),t.visible=this.getVisible(),t.extent=this.getExtent(),t.zIndex=i===void 0&&!t.managed?1/0:i,t.maxResolution=this.getMaxResolution(),t.minResolution=Math.max(this.getMinResolution(),0),t.minZoom=this.getMinZoom(),t.maxZoom=this.getMaxZoom(),this.state_=t,t}getLayersArray(e){return at()}getLayerStatesArray(e){return at()}getExtent(){return this.get(wt.EXTENT)}getMaxResolution(){return this.get(wt.MAX_RESOLUTION)}getMinResolution(){return this.get(wt.MIN_RESOLUTION)}getMinZoom(){return this.get(wt.MIN_ZOOM)}getMaxZoom(){return this.get(wt.MAX_ZOOM)}getOpacity(){return this.get(wt.OPACITY)}getSourceState(){return at()}getVisible(){return this.get(wt.VISIBLE)}getZIndex(){return this.get(wt.Z_INDEX)}setBackground(e){this.background_=e,this.changed()}setExtent(e){this.set(wt.EXTENT,e)}setMaxResolution(e){this.set(wt.MAX_RESOLUTION,e)}setMinResolution(e){this.set(wt.MIN_RESOLUTION,e)}setMaxZoom(e){this.set(wt.MAX_ZOOM,e)}setMinZoom(e){this.set(wt.MIN_ZOOM,e)}setOpacity(e){_t(typeof e=="number","Layer opacity must be a number"),this.set(wt.OPACITY,e)}setVisible(e){this.set(wt.VISIBLE,e)}setZIndex(e){this.set(wt.Z_INDEX,e)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}class V_ extends s4{constructor(e){const t=Object.assign({},e);delete t.source,super(t),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,e.render&&(this.render=e.render),e.map&&this.setMap(e.map),this.addChangeListener(wt.SOURCE,this.handleSourcePropertyChange_);const i=e.source?e.source:null;this.setSource(i)}getLayersArray(e){return e=e||[],e.push(this),e}getLayerStatesArray(e){return e=e||[],e.push(this.getLayerState()),e}getSource(){return this.get(wt.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const e=this.getSource();return e?e.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(Ft(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const e=this.getSource();e&&(this.sourceChangeKey_=lt(e,He.CHANGE,this.handleSourceChange_,this),e.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(e){return this.renderer_?this.renderer_.getFeatures(e):Promise.resolve([])}getData(e){return!this.renderer_||!this.rendered?null:this.renderer_.getData(e)}isVisible(e){let t;const i=this.getMapInternal();!e&&i&&(e=i.getView()),e instanceof ws?t={viewState:e.getState(),extent:e.calculateExtent()}:t=e,!t.layerStatesArray&&i&&(t.layerStatesArray=i.getLayerGroup().getLayerStatesArray());let r;if(t.layerStatesArray){if(r=t.layerStatesArray.find(o=>o.layer===this),!r)return!1}else r=this.getLayerState();const s=this.getExtent();return yx(r,t.viewState)&&(!s||Ri(s,t.extent))}getAttributions(e){if(!this.isVisible(e))return[];const t=this.getSource()?.getAttributions();if(!t)return[];const i=e instanceof ws?e.getViewStateAndExtent():e;let r=t(i);return Array.isArray(r)||(r=[r]),r}render(e,t){const i=this.getRenderer();return i.prepareFrame(e)?(this.rendered=!0,i.renderFrame(e,t)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(e,t){}renderDeferred(e){const t=this.getRenderer();t&&t.renderDeferred(e)}setMapInternal(e){e||this.unrender(),this.set(wt.MAP,e)}getMapInternal(){return this.get(wt.MAP)}setMap(e){this.mapPrecomposeKey_&&(Ft(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),e||this.changed(),this.mapRenderKey_&&(Ft(this.mapRenderKey_),this.mapRenderKey_=null),e&&(this.mapPrecomposeKey_=lt(e,wr.PRECOMPOSE,this.handlePrecompose_,this),this.mapRenderKey_=lt(this,He.CHANGE,e.render,e),this.changed())}handlePrecompose_(e){const t=e.frameState.layerStatesArray,i=this.getLayerState(!1);_t(!t.some(r=>r.layer===i.layer),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),t.push(i)}setSource(e){this.set(wt.SOURCE,e)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}clearRenderer(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_)}disposeInternal(){this.clearRenderer(),this.setSource(null),super.disposeInternal()}}function yx(n,e){if(!n.visible)return!1;const t=e.resolution;if(t<n.minResolution||t>=n.maxResolution)return!1;const i=e.zoom;return i>n.minZoom&&i<=n.maxZoom}const VA={RENDER_ORDER:"renderOrder"};class o4 extends V_{constructor(e){e=e||{};const t=Object.assign({},e);delete t.style,delete t.renderBuffer,delete t.updateWhileAnimating,delete t.updateWhileInteracting,super(t),this.declutter_=e.declutter?String(e.declutter):void 0,this.renderBuffer_=e.renderBuffer!==void 0?e.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(e.style),this.updateWhileAnimating_=e.updateWhileAnimating!==void 0?e.updateWhileAnimating:!1,this.updateWhileInteracting_=e.updateWhileInteracting!==void 0?e.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(e){return super.getFeatures(e)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(VA.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(e,t){const i=this.getDeclutter();i in e.declutter||(e.declutter[i]=new zb(9)),this.getRenderer().renderDeclutter(e,t)}setRenderOrder(e){this.set(VA.RENDER_ORDER,e)}setStyle(e){this.style_=e===void 0?Wb:e;const t=bV(e);this.styleFunction_=e===null?void 0:f8(t),this.changed()}setDeclutter(e){this.declutter_=e?String(e):void 0,this.changed()}}function bV(n){if(n===void 0)return Wb;if(!n)return null;if(typeof n=="function"||n instanceof Xi)return n;if(!Array.isArray(n))return MA([n]);if(n.length===0)return[];const e=n.length,t=n[0];if(t instanceof Xi){const r=new Array(e);for(let s=0;s<e;++s){const o=n[s];if(!(o instanceof Xi))throw new Error("Expected a list of style instances");r[s]=o}return r}if("style"in t){const r=new Array(e);for(let s=0;s<e;++s){const o=n[s];if(!("style"in o))throw new Error("Expected a list of rules with a style property");r[s]=o}return oV(r)}return MA(n)}class a4 extends o4{constructor(e){super(e)}createRenderer(){return new N8(this)}}const ra={ADDLAYER:"addlayer",REMOVELAYER:"removelayer"};class ma extends Io{constructor(e,t){super(e),this.layer=t}}const g1={LAYERS:"layers"};let F_=class l4 extends s4{constructor(e){e=e||{};const t=Object.assign({},e);delete t.layers;let i=e.layers;super(t),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(g1.LAYERS,this.handleLayersChanged_),i?Array.isArray(i)?i=new Er(i.slice(),{unique:!0}):_t(typeof i.getArray=="function","Expected `layers` to be an array or a `Collection`"):i=new Er(void 0,{unique:!0}),this.setLayers(i)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(Ft),this.layersListenerKeys_.length=0;const e=this.getLayers();this.layersListenerKeys_.push(lt(e,Ti.ADD,this.handleLayersAdd_,this),lt(e,Ti.REMOVE,this.handleLayersRemove_,this));for(const i in this.listenerKeys_)this.listenerKeys_[i].forEach(Ft);yg(this.listenerKeys_);const t=e.getArray();for(let i=0,r=t.length;i<r;i++){const s=t[i];this.registerLayerListeners_(s),this.dispatchEvent(new ma(ra.ADDLAYER,s))}this.changed()}registerLayerListeners_(e){const t=[lt(e,oh.PROPERTYCHANGE,this.handleLayerChange_,this),lt(e,He.CHANGE,this.handleLayerChange_,this)];e instanceof l4&&t.push(lt(e,ra.ADDLAYER,this.handleLayerGroupAdd_,this),lt(e,ra.REMOVELAYER,this.handleLayerGroupRemove_,this)),this.listenerKeys_[ct(e)]=t}handleLayerGroupAdd_(e){this.dispatchEvent(new ma(ra.ADDLAYER,e.layer))}handleLayerGroupRemove_(e){this.dispatchEvent(new ma(ra.REMOVELAYER,e.layer))}handleLayersAdd_(e){const t=e.element;this.registerLayerListeners_(t),this.dispatchEvent(new ma(ra.ADDLAYER,t)),this.changed()}handleLayersRemove_(e){const t=e.element,i=ct(t);this.listenerKeys_[i].forEach(Ft),delete this.listenerKeys_[i],this.dispatchEvent(new ma(ra.REMOVELAYER,t)),this.changed()}getLayers(){return this.get(g1.LAYERS)}setLayers(e){const t=this.getLayers();if(t){const i=t.getArray();for(let r=0,s=i.length;r<s;++r)this.dispatchEvent(new ma(ra.REMOVELAYER,i[r]))}this.set(g1.LAYERS,e)}getLayersArray(e){return e=e!==void 0?e:[],this.getLayers().forEach(function(t){t.getLayersArray(e)}),e}getLayerStatesArray(e){const t=e!==void 0?e:[],i=t.length;this.getLayers().forEach(function(o){o.getLayerStatesArray(t)});const r=this.getLayerState();let s=r.zIndex;!e&&r.zIndex===void 0&&(s=0);for(let o=i,a=t.length;o<a;o++){const c=t[o];c.opacity*=r.opacity,c.visible=c.visible&&r.visible,c.maxResolution=Math.min(c.maxResolution,r.maxResolution),c.minResolution=Math.max(c.minResolution,r.minResolution),c.minZoom=Math.max(c.minZoom,r.minZoom),c.maxZoom=Math.min(c.maxZoom,r.maxZoom),r.extent!==void 0&&(c.extent!==void 0?c.extent=Hl(c.extent,r.extent):c.extent=r.extent),c.zIndex===void 0&&(c.zIndex=s)}return t}getSourceState(){return"ready"}};const Le={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};class vx extends vg{constructor(e,t,i){super(),i=i||{},this.tileCoord=e,this.state=t,this.key="",this.transition_=i.transition===void 0?250:i.transition,this.transitionStarts_={},this.interpolate=!!i.interpolate}changed(){this.dispatchEvent(He.CHANGE)}release(){this.setState(Le.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(e){if(this.state!==Le.EMPTY){if(this.state!==Le.ERROR&&this.state>e)throw new Error("Tile load sequence violation");this.state=e,this.changed()}}load(){at()}getAlpha(e,t){if(!this.transition_)return 1;let i=this.transitionStarts_[e];if(!i)i=t,this.transitionStarts_[e]=i;else if(i===-1)return 1;const r=t-i+1e3/60;return r>=this.transition_?1:r4(r/this.transition_)}inTransition(e){return this.transition_?this.transitionStarts_[e]!==-1:!1}endTransition(e){this.transition_&&(this.transitionStarts_[e]=-1)}disposeInternal(){this.release(),super.disposeInternal()}}function IE(n){return n instanceof Image||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageBitmap?n:null}const kV=new Error("disposed"),LV=[256,256];class FA extends vx{constructor(e){const t=Le.IDLE;super(e.tileCoord,t,{transition:e.transition,interpolate:e.interpolate}),this.loader_=e.loader,this.data_=null,this.error_=null,this.size_=e.size||null,this.controller_=e.controller||null}getSize(){if(this.size_)return this.size_;const e=IE(this.data_);return e?[e.width,e.height]:LV}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==Le.IDLE&&this.state!==Le.ERROR)return;this.state=Le.LOADING,this.changed();const e=this;this.loader_().then(function(t){e.data_=t,e.state=Le.LOADED,e.changed()}).catch(function(t){e.error_=t,e.state=Le.ERROR,e.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(kV),this.controller_=null),super.disposeInternal()}}class c4 extends vx{constructor(e,t,i,r,s,o){super(e,t,o),this.crossOrigin_=r,this.src_=i,this.key=i,this.image_,qi?this.image_=new OffscreenCanvas(1,1):(this.image_=new Image,r!==null&&(this.image_.crossOrigin=r)),this.unlisten_=null,this.tileLoadFunction_=s}getImage(){return this.image_}setImage(e){this.image_=e,this.state=Le.LOADED,this.unlistenImage_(),this.changed()}getCrossOrigin(){return this.crossOrigin_}handleImageError_(){this.state=Le.ERROR,this.unlistenImage_(),this.image_=NV(),this.changed()}handleImageLoad_(){if(qi)this.state=Le.LOADED;else{const e=this.image_;e.naturalWidth&&e.naturalHeight?this.state=Le.LOADED:this.state=Le.EMPTY}this.unlistenImage_(),this.changed()}load(){this.state==Le.ERROR&&(this.state=Le.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==Le.IDLE&&(this.state=Le.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=C6(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}}function NV(){const n=mn(1,1);return n.fillStyle="rgba(0,0,0,0)",n.fillRect(0,0,1,1),n.canvas}let m1;const Zu=[];function jA(n,e,t,i,r){n.beginPath(),n.moveTo(0,0),n.lineTo(e,t),n.lineTo(i,r),n.closePath(),n.save(),n.clip(),n.fillRect(0,0,Math.max(e,i)+1,Math.max(t,r)),n.restore()}function p1(n,e){return Math.abs(n[e*4]-210)>2||Math.abs(n[e*4+3]-.75*255)>2}function DV(){if(m1===void 0){const n=mn(6,6,Zu);n.globalCompositeOperation="lighter",n.fillStyle="rgba(210, 0, 0, 0.75)",jA(n,4,5,4,0),jA(n,4,5,0,5);const e=n.getImageData(0,0,3,3).data;m1=p1(e,0)||p1(e,4)||p1(e,8),b_(n),Zu.push(n.canvas)}return m1}function AE(n,e,t,i){const r=Sg(t,e,n);let s=J2(e,i,t);const o=e.getMetersPerUnit();o!==void 0&&(s*=o);const a=n.getMetersPerUnit();a!==void 0&&(s/=a);const c=n.getExtent();if(!c||lh(c,r)){const h=J2(n,s,r)/s;isFinite(h)&&h>0&&(s/=h)}return s}function OV(n,e,t,i){const r=tc(t);let s=AE(n,e,r,i);return(!isFinite(s)||s<=0)&&JM(t,function(o){return s=AE(n,e,o,i),isFinite(s)&&s>0}),s}function VV(n,e,t,i,r,s,o,a,c,h,d,g,m,v){const y=mn(Math.round(t*n),Math.round(t*e),Zu);if(g||(y.imageSmoothingEnabled=!1),c.length===0)return y.canvas;y.scale(t,t);function T(D){return Math.round(D*t)/t}y.globalCompositeOperation="lighter";const w=Zi();c.forEach(function(D,z,k){_5(w,D.extent)});let A;const P=t/i,C=(g?1:1+Math.pow(2,-24))/P;(!m||c.length!==1||h!==0)&&(A=mn(Math.round(ut(w)*P),Math.round(ei(w)*P),Zu),g||(A.imageSmoothingEnabled=!1),c.forEach(function(D,z,k){if(D.image.width>0&&D.image.height>0){if(D.clipExtent){A.save();const U=(D.clipExtent[0]-w[0])*P,O=-(D.clipExtent[3]-w[3])*P,ce=ut(D.clipExtent)*P,we=ei(D.clipExtent)*P;A.rect(g?U:Math.round(U),g?O:Math.round(O),g?ce:Math.round(U+ce)-Math.round(U),g?we:Math.round(O+we)-Math.round(O)),A.clip()}const R=(D.extent[0]-w[0])*P,L=-(D.extent[3]-w[3])*P,F=ut(D.extent)*P,j=ei(D.extent)*P;A.drawImage(D.image,h,h,D.image.width-2*h,D.image.height-2*h,g?R:Math.round(R),g?L:Math.round(L),g?F:Math.round(R+F)-Math.round(R),g?j:Math.round(L+j)-Math.round(L)),D.clipExtent&&A.restore()}}));const N=wc(o);return a.getTriangles().forEach(function(D,z,k){const R=D.source,L=D.target;let F=R[0][0],j=R[0][1],U=R[1][0],O=R[1][1],ce=R[2][0],we=R[2][1];const ye=T((L[0][0]-N[0])/s),de=T(-(L[0][1]-N[1])/s),J=T((L[1][0]-N[0])/s),ae=T(-(L[1][1]-N[1])/s),ie=T((L[2][0]-N[0])/s),$=T(-(L[2][1]-N[1])/s),K=F,Ae=j;F=0,j=0,U-=K,O-=Ae,ce-=K,we-=Ae;const Re=[[U,O,0,0,J-ye],[ce,we,0,0,ie-ye],[0,0,U,O,ae-de],[0,0,ce,we,$-de]],Pe=S5(Re);if(!Pe)return;if(y.save(),y.beginPath(),DV()||!g){y.moveTo(J,ae);const Fe=4,Ke=ye-J,Ye=de-ae;for(let yt=0;yt<Fe;yt++)y.lineTo(J+T((yt+1)*Ke/Fe),ae+T(yt*Ye/(Fe-1))),yt!=Fe-1&&y.lineTo(J+T((yt+1)*Ke/Fe),ae+T((yt+1)*Ye/(Fe-1)));y.lineTo(ie,$)}else y.moveTo(J,ae),y.lineTo(ye,de),y.lineTo(ie,$);y.clip(),y.transform(Pe[0],Pe[2],Pe[1],Pe[3],ye,de),y.translate(w[0]-K,w[3]-Ae);let Oe;if(A)Oe=A.canvas,y.scale(C,-C);else{const Fe=c[0],Ke=Fe.extent;Oe=Fe.image,y.scale(ut(Ke)/Oe.width,-ei(Ke)/Oe.height)}y.drawImage(Oe,0,0),y.restore()}),A&&(b_(A),Zu.push(A.canvas)),d&&(y.save(),y.globalCompositeOperation="source-over",y.strokeStyle="black",y.lineWidth=1,a.getTriangles().forEach(function(D,z,k){const R=D.target,L=(R[0][0]-N[0])/s,F=-(R[0][1]-N[1])/s,j=(R[1][0]-N[0])/s,U=-(R[1][1]-N[1])/s,O=(R[2][0]-N[0])/s,ce=-(R[2][1]-N[1])/s;y.beginPath(),y.moveTo(j,U),y.lineTo(L,F),y.lineTo(O,ce),y.closePath(),y.stroke()}),y.restore()),y.canvas}const FV=10,GA=.25;class jV{constructor(e,t,i,r,s,o,a){this.sourceProj_=e,this.targetProj_=t;let c={};const h=a?gE(C=>An(a,Sg(C,this.targetProj_,this.sourceProj_))):g0(this.targetProj_,this.sourceProj_);this.transformInv_=function(C){const N=C[0]+"/"+C[1];return c[N]||(c[N]=h(C)),c[N]},this.maxSourceExtent_=r,this.errorThresholdSquared_=s*s,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!r&&!!this.sourceProj_.getExtent()&&ut(r)>=ut(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?ut(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?ut(this.targetProj_.getExtent()):null;const d=wc(i),g=T_(i),m=S_(i),v=x_(i),y=this.transformInv_(d),T=this.transformInv_(g),w=this.transformInv_(m),A=this.transformInv_(v),P=FV+(o?Math.max(0,Math.ceil(Math.log2(lE(i)/(o*o*256*256)))):0);if(this.addQuad_(d,g,m,v,y,T,w,A,P),this.wrapsXInSource_){let C=1/0;this.triangles_.forEach(function(N,D,z){C=Math.min(C,N.source[0][0],N.source[1][0],N.source[2][0])}),this.triangles_.forEach(N=>{if(Math.max(N.source[0][0],N.source[1][0],N.source[2][0])-C>this.sourceWorldWidth_/2){const D=[[N.source[0][0],N.source[0][1]],[N.source[1][0],N.source[1][1]],[N.source[2][0],N.source[2][1]]];D[0][0]-C>this.sourceWorldWidth_/2&&(D[0][0]-=this.sourceWorldWidth_),D[1][0]-C>this.sourceWorldWidth_/2&&(D[1][0]-=this.sourceWorldWidth_),D[2][0]-C>this.sourceWorldWidth_/2&&(D[2][0]-=this.sourceWorldWidth_);const z=Math.min(D[0][0],D[1][0],D[2][0]);Math.max(D[0][0],D[1][0],D[2][0])-z<this.sourceWorldWidth_/2&&(N.source=D)}})}c={}}addTriangle_(e,t,i,r,s,o){this.triangles_.push({source:[r,s,o],target:[e,t,i]})}addQuad_(e,t,i,r,s,o,a,c,h){const d=z2([s,o,a,c]),g=this.sourceWorldWidth_?ut(d)/this.sourceWorldWidth_:null,m=this.sourceWorldWidth_,v=this.sourceProj_.canWrapX()&&g>.5&&g<1;let y=!1;if(h>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const w=z2([e,t,i,r]);y=ut(w)/this.targetWorldWidth_>GA||y}!v&&this.sourceProj_.isGlobal()&&g&&(y=g>GA||y)}if(!y&&this.maxSourceExtent_&&isFinite(d[0])&&isFinite(d[1])&&isFinite(d[2])&&isFinite(d[3])&&!Ri(d,this.maxSourceExtent_))return;let T=0;if(!y&&(!isFinite(s[0])||!isFinite(s[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(a[0])||!isFinite(a[1])||!isFinite(c[0])||!isFinite(c[1]))){if(h>0)y=!0;else if(T=(!isFinite(s[0])||!isFinite(s[1])?8:0)+(!isFinite(o[0])||!isFinite(o[1])?4:0)+(!isFinite(a[0])||!isFinite(a[1])?2:0)+(!isFinite(c[0])||!isFinite(c[1])?1:0),T!=1&&T!=2&&T!=4&&T!=8)return}if(h>0){if(!y){const w=[(e[0]+i[0])/2,(e[1]+i[1])/2],A=this.transformInv_(w);let P;v?P=(Ra(s[0],m)+Ra(a[0],m))/2-Ra(A[0],m):P=(s[0]+a[0])/2-A[0];const C=(s[1]+a[1])/2-A[1];y=P*P+C*C>this.errorThresholdSquared_}if(y){if(Math.abs(e[0]-i[0])<=Math.abs(e[1]-i[1])){const w=[(t[0]+i[0])/2,(t[1]+i[1])/2],A=this.transformInv_(w),P=[(r[0]+e[0])/2,(r[1]+e[1])/2],C=this.transformInv_(P);this.addQuad_(e,t,w,P,s,o,A,C,h-1),this.addQuad_(P,w,i,r,C,A,a,c,h-1)}else{const w=[(e[0]+t[0])/2,(e[1]+t[1])/2],A=this.transformInv_(w),P=[(i[0]+r[0])/2,(i[1]+r[1])/2],C=this.transformInv_(P);this.addQuad_(e,w,P,r,s,A,C,c,h-1),this.addQuad_(w,t,i,P,A,o,a,C,h-1)}return}}if(v){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(T&11)==0&&this.addTriangle_(e,i,r,s,a,c),(T&14)==0&&this.addTriangle_(e,i,t,s,a,o),T&&((T&13)==0&&this.addTriangle_(t,r,e,o,c,s),(T&7)==0&&this.addTriangle_(t,r,i,o,c,a))}calculateSourceExtent(){const e=Zi();return this.triangles_.forEach(function(t,i,r){const s=t.source;cf(e,s[0]),cf(e,s[1]),cf(e,s[2])}),e}getTriangles(){return this.triangles_}}const GV=.5;class u4 extends vx{constructor(e,t,i,r,s,o,a,c,h,d,g,m){super(s,Le.IDLE,m),this.renderEdges_=g!==void 0?g:!1,this.pixelRatio_=a,this.gutter_=c,this.canvas_=null,this.sourceTileGrid_=t,this.targetTileGrid_=r,this.wrappedTileCoord_=o||s,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=e.canWrapX()?e.getExtent():void 0;const v=r.getTileCoordExtent(this.wrappedTileCoord_),y=this.targetTileGrid_.getExtent();let T=this.sourceTileGrid_.getExtent();const w=y?Hl(v,y):v;if(lE(w)===0){this.state=Le.EMPTY;return}const A=e.getExtent();A&&(T?T=Hl(T,A):T=A);const P=r.getResolution(this.wrappedTileCoord_[0]),C=OV(e,i,w,P);if(!isFinite(C)||C<=0){this.state=Le.EMPTY;return}const N=d!==void 0?d:GV;if(this.triangulation_=new jV(e,i,w,T,C*N,P),this.triangulation_.getTriangles().length===0){this.state=Le.EMPTY;return}this.sourceZ_=t.getZForResolution(C);let D=this.triangulation_.calculateSourceExtent();if(T&&(e.canWrapX()?(D[1]=kt(D[1],T[1],T[3]),D[3]=kt(D[3],T[1],T[3])):D=Hl(D,T)),!lE(D))this.state=Le.EMPTY;else{let z=0,k=0;e.canWrapX()&&(z=ut(A),k=Math.floor((D[0]-A[0])/z)),nb(D.slice(),e,!0).forEach(L=>{const F=t.getTileRangeForExtentAndZ(L,this.sourceZ_);for(let j=F.minX;j<=F.maxX;j++)for(let U=F.minY;U<=F.maxY;U++){const O=h(this.sourceZ_,j,U,a);if(O){const ce=k*z;this.sourceTiles_.push({tile:O,offset:ce})}}++k}),this.sourceTiles_.length===0&&(this.state=Le.EMPTY)}}getImage(){return this.canvas_}reproject_(){const e=[];if(this.sourceTiles_.forEach(t=>{const i=t.tile;if(i&&i.getState()==Le.LOADED){const r=this.sourceTileGrid_.getTileCoordExtent(i.tileCoord);r[0]+=t.offset,r[2]+=t.offset;const s=this.clipExtent_?.slice();s&&(s[0]+=t.offset,s[2]+=t.offset),e.push({extent:r,clipExtent:s,image:i.getImage()})}}),this.sourceTiles_.length=0,e.length===0)this.state=Le.ERROR;else{const t=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(t),r=typeof i=="number"?i:i[0],s=typeof i=="number"?i:i[1],o=this.targetTileGrid_.getResolution(t),a=this.sourceTileGrid_.getResolution(this.sourceZ_),c=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=VV(r,s,this.pixelRatio_,a,this.sourceTileGrid_.getExtent(),o,c,this.triangulation_,e,this.gutter_,this.renderEdges_,this.interpolate),this.state=Le.LOADED}this.changed()}load(){if(this.state==Le.IDLE){this.state=Le.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:t})=>{const i=t.getState();if(i==Le.IDLE||i==Le.LOADING){e++;const r=lt(t,He.CHANGE,s=>{const o=t.getState();(o==Le.LOADED||o==Le.ERROR||o==Le.EMPTY)&&(Ft(r),e--,e===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(r)}}),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:t},i,r){t.getState()==Le.IDLE&&t.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(Ft),this.sourcesListenerKeys_=null}release(){this.canvas_&&(b_(this.canvas_.getContext("2d")),Zu.push(this.canvas_),this.canvas_=null),super.release()}}class Ex{constructor(e,t,i,r){this.minX=e,this.maxX=t,this.minY=i,this.maxY=r}contains(e){return this.containsXY(e[1],e[2])}containsTileRange(e){return this.minX<=e.minX&&e.maxX<=this.maxX&&this.minY<=e.minY&&e.maxY<=this.maxY}containsXY(e,t){return this.minX<=e&&e<=this.maxX&&this.minY<=t&&t<=this.maxY}equals(e){return this.minX==e.minX&&this.minY==e.minY&&this.maxX==e.maxX&&this.maxY==e.maxY}extend(e){e.minX<this.minX&&(this.minX=e.minX),e.maxX>this.maxX&&(this.maxX=e.maxX),e.minY<this.minY&&(this.minY=e.minY),e.maxY>this.maxY&&(this.maxY=e.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(e){return this.minX<=e.maxX&&this.maxX>=e.minX&&this.minY<=e.maxY&&this.maxY>=e.minY}}function pu(n,e,t,i,r){return r!==void 0?(r.minX=n,r.maxX=e,r.minY=t,r.maxY=i,r):new Ex(n,e,t,i)}class UA{constructor(e){this.highWaterMark=e!==void 0?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}deleteOldest(){const e=this.pop();e instanceof y_&&e.dispose()}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(e){for(;this.canExpireCache();)this.deleteOldest()}clear(){for(;this.oldest_;)this.deleteOldest()}containsKey(e){return this.entries_.hasOwnProperty(e)}forEach(e){let t=this.oldest_;for(;t;)e(t.value_,t.key_,this),t=t.newer}get(e,t){const i=this.entries_[e];return _t(i!==void 0,"Tried to get a value for a key that does not exist in the cache"),i===this.newest_||(i===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(i.newer.older=i.older,i.older.newer=i.newer),i.newer=null,i.older=this.newest_,this.newest_.newer=i,this.newest_=i),i.value_}remove(e){const t=this.entries_[e];return _t(t!==void 0,"Tried to get a value for a key that does not exist in the cache"),t===this.newest_?(this.newest_=t.older,this.newest_&&(this.newest_.newer=null)):t===this.oldest_?(this.oldest_=t.newer,this.oldest_&&(this.oldest_.older=null)):(t.newer.older=t.older,t.older.newer=t.newer),delete this.entries_[e],--this.count_,t.value_}getCount(){return this.count_}getKeys(){const e=new Array(this.count_);let t=0,i;for(i=this.newest_;i;i=i.older)e[t++]=i.key_;return e}getValues(){const e=new Array(this.count_);let t=0,i;for(i=this.newest_;i;i=i.older)e[t++]=i.value_;return e}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(e){return this.entries_[e]?.value_}pop(){const e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_}replace(e,t){this.get(e),this.entries_[e].value_=t}set(e,t){_t(!(e in this.entries_),"Tried to set a value for a key that is used already");const i={key_:e,newer:null,older:this.newest_,value_:t};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[e]=i,++this.count_}setSize(e){this.highWaterMark=e}}function I0(n,e,t,i){return i!==void 0?(i[0]=n,i[1]=e,i[2]=t,i):[n,e,t]}function UV(n,e,t){return n+"/"+e+"/"+t}function jp(n,e,t,i,r){return`${ct(n)},${e},${UV(t,i,r)}`}function h4(n){return zV(n[0],n[1],n[2])}function zV(n,e,t){return(e<<n)+t}function BV(n,e){const t=n[0],i=n[1],r=n[2];if(e.getMinZoom()>t||t>e.getMaxZoom())return!1;const s=e.getFullTileRange(t);return s?s.containsXY(i,r):!0}function _1(n,e,t){if(!(t in n))return n[t]=new Set([e]),!0;const i=n[t],r=i.has(e);return r||i.add(e),!r}function $V(n,e,t){const i=n[t];return i?i.delete(e):!1}function zA(n,e){const t=n.layerStatesArray[n.layerIndex];t.extent&&(e=Hl(e,wa(t.extent,n.viewState.projection)));const i=t.layer.getRenderSource();if(!i.getWrapX()){const r=i.getTileGridForProjection(n.viewState.projection).getExtent();r&&(e=Hl(e,r))}return e}class WV extends Yb{constructor(e,t){super(e),t=t||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=Zi(),this.tempTileRange_=new Ex(0,0,0,0),this.tempTileCoord_=I0(0,0,0);const i=t.cacheSize!==void 0?t.cacheSize:512;this.tileCache_=new UA(i),this.sourceTileCache_=null,this.maxStaleKeys=i*.5}getTileCache(){return this.tileCache_}getSourceTileCache(){return this.sourceTileCache_||(this.sourceTileCache_=new UA(512)),this.sourceTileCache_}getOrCreateTile(e,t,i,r){const s=this.tileCache_,a=this.getLayer().getSource(),c=jp(a,a.getKey(),e,t,i);let h;if(s.containsKey(c))h=s.get(c);else{const d=r.viewState.projection,g=a.getProjection();if(h=a.getTile(e,t,i,r.pixelRatio,d,!g||Fp(g,d)?void 0:this.getSourceTileCache()),!h)return null;s.set(c,h)}return h}getTile(e,t,i,r){const s=this.getOrCreateTile(e,t,i,r);return s||null}getData(e){const t=this.frameState;if(!t)return null;const i=this.getLayer(),r=An(t.pixelToCoordinateTransform,e.slice()),s=i.getExtent();if(s&&!lh(s,r))return null;const o=t.viewState,a=i.getRenderSource(),c=a.getTileGridForProjection(o.projection),h=a.getTilePixelRatio(t.pixelRatio);for(let d=c.getZForResolution(o.resolution);d>=c.getMinZoom();--d){const g=c.getTileCoordForCoordAndZ(r,d),m=this.getTile(d,g[1],g[2],t);if(!m||m.getState()!==Le.LOADED)continue;const v=c.getOrigin(d),y=Mi(c.getTileSize(d)),T=c.getResolution(d);let w;if(m instanceof c4||m instanceof u4)w=m.getImage();else if(m instanceof FA){if(w=IE(m.getData()),!w)continue}else continue;const A=Math.floor(h*((r[0]-v[0])/T-g[1]*y[0])),P=Math.floor(h*((v[1]-r[1])/T-g[2]*y[1])),C=Math.round(h*a.getGutterForProjection(o.projection));return this.getImageData(w,A+C,P+C)}return null}prepareFrame(e){this.renderedProjection?e.viewState.projection!==this.renderedProjection&&(this.tileCache_.clear(),this.renderedProjection=e.viewState.projection):this.renderedProjection=e.viewState.projection;const t=this.getLayer().getSource();if(!t)return!1;const i=t.getRevision();return this.renderedSourceRevision_?this.renderedSourceRevision_!==i&&(this.renderedSourceRevision_=i,this.renderedSourceKey_===t.getKey()&&(this.tileCache_.clear(),this.sourceTileCache_?.clear())):this.renderedSourceRevision_=i,!0}enqueueTilesForNextExtent(){return!0}enqueueTiles(e,t,i,r,s){const o=e.viewState,a=this.getLayer(),c=a.getRenderSource(),h=c.getTileGridForProjection(o.projection),d=ct(c);d in e.wantedTiles||(e.wantedTiles[d]={});const g=e.wantedTiles[d],m=a.getMapInternal(),v=Math.max(i-s,h.getMinZoom(),h.getZForResolution(Math.min(a.getMaxResolution(),m?m.getView().getResolutionForZoom(Math.max(a.getMinZoom(),0)):h.getResolution(0)),c.zDirection)),y=o.rotation,T=y?eb(o.center,o.resolution,y,e.size):void 0;for(let w=i;w>=v;--w){const A=h.getTileRangeForExtentAndZ(t,w,this.tempTileRange_),P=h.getResolution(w);for(let C=A.minX;C<=A.maxX;++C)for(let N=A.minY;N<=A.maxY;++N){if(y&&!h.tileCoordIntersectsViewport([w,C,N],T))continue;const D=this.getTile(w,C,N,e);if(!D||!_1(r,D,w))continue;const k=D.getKey();if(g[k]=!0,D.getState()===Le.IDLE&&!e.tileQueue.isKeyQueued(k)){const R=I0(w,C,N,this.tempTileCoord_);e.tileQueue.enqueue([D,d,h.getTileCoordCenter(R),P])}}}}findStaleTile_(e,t){const i=this.tileCache_,r=e[0],s=e[1],o=e[2],a=this.getStaleKeys();for(let c=0;c<a.length;++c){const h=jp(this.getLayer().getSource(),a[c],r,s,o);if(i.containsKey(h)){const d=i.peek(h);if(d.getState()===Le.LOADED)return d.endTransition(ct(this)),_1(t,d,r),!0}}return!1}findAltTiles_(e,t,i,r){const s=e.getTileRangeForTileCoordAndZ(t,i,this.tempTileRange_);if(!s)return!1;let o=!0;const a=this.tileCache_,c=this.getLayer().getRenderSource(),h=c.getKey();for(let d=s.minX;d<=s.maxX;++d)for(let g=s.minY;g<=s.maxY;++g){const m=jp(c,h,i,d,g);let v=!1;if(a.containsKey(m)){const y=a.peek(m);y.getState()===Le.LOADED&&(_1(r,y,i),v=!0)}v||(o=!1)}return o}renderFrame(e,t){this.renderComplete=!0;const i=e.layerStatesArray[e.layerIndex],r=e.viewState,s=r.projection,o=r.resolution,a=r.center,c=e.pixelRatio,h=this.getLayer(),d=h.getSource(),g=d.getTileGridForProjection(s),m=g.getZForResolution(o,d.zDirection),v=g.getResolution(m),y=d.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==y&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=y):this.renderedSourceKey_=y;let T=e.extent;const w=d.getTilePixelRatio(c);this.prepareContainer(e,t);const A=this.context.canvas.width,P=this.context.canvas.height,C=i.extent&&wa(i.extent);C&&(T=Hl(T,wa(i.extent)));const N=v*A/2/w,D=v*P/2/w,z=[a[0]-N,a[1]-D,a[0]+N,a[1]+D],k={};this.renderedTiles.length=0;const R=h.getPreload();if(e.nextExtent&&this.enqueueTilesForNextExtent()){const J=g.getZForResolution(r.nextResolution,d.zDirection),ae=zA(e,e.nextExtent);this.enqueueTiles(e,ae,J,k,R)}const L=zA(e,T);if(this.enqueueTiles(e,L,m,k,0),R>0&&setTimeout(()=>{this.enqueueTiles(e,L,m-1,k,R-1)},0),!(m in k))return this.container;const F=ct(this),j=e.time;for(const J of k[m]){const ae=J.getState();if(ae===Le.EMPTY)continue;const ie=J.tileCoord;if(ae===Le.LOADED&&J.getAlpha(F,j)===1){J.endTransition(F);continue}if(ae!==Le.ERROR&&(this.renderComplete=!1),this.findStaleTile_(ie,k)){$V(k,J,m),e.animate=!0;continue}if(this.findAltTiles_(g,ie,m+1,k))continue;const Ae=g.getMinZoom();for(let Re=m-1;Re>=Ae&&!this.findAltTiles_(g,ie,Re,k);--Re);}const U=v/o*c/w,O=this.getRenderContext(e);yo(this.tempTransform,A/2,P/2,U,U,0,-A/2,-P/2),i.extent&&this.clipUnrotated(O,e,C),d.getInterpolate()||(O.imageSmoothingEnabled=!1),this.preRender(O,e);const ce=Object.keys(k).map(Number);ce.sort(ho);let we;const ye=[],de=[];for(let J=ce.length-1;J>=0;--J){const ae=ce[J],ie=d.getTilePixelSize(ae,c,s),K=g.getResolution(ae)/v,Ae=ie[0]*K*U,Re=ie[1]*K*U,Pe=g.getTileCoordForCoordAndZ(wc(z),ae),Oe=g.getTileCoordExtent(Pe),Fe=An(this.tempTransform,[w*(Oe[0]-z[0])/v,w*(z[3]-Oe[3])/v]),Ke=w*d.getGutterForProjection(s);for(const Ye of k[ae]){if(Ye.getState()!==Le.LOADED)continue;const yt=Ye.tileCoord,Rr=Pe[1]-yt[1],js=Math.round(Fe[0]-(Rr-1)*Ae),gi=Pe[2]-yt[2],mi=Math.round(Fe[1]-(gi-1)*Re),Rn=Math.round(Fe[0]-Rr*Ae),Pn=Math.round(Fe[1]-gi*Re),pi=js-Rn,tr=mi-Pn,Rt=ce.length===1;let vt=!1;we=[Rn,Pn,Rn+pi,Pn,Rn+pi,Pn+tr,Rn,Pn+tr];for(let vn=0,nr=ye.length;vn<nr;++vn)if(!Rt&&ae<de[vn]){const Nt=ye[vn];Ri([Rn,Pn,Rn+pi,Pn+tr],[Nt[0],Nt[3],Nt[4],Nt[7]])&&(vt||(O.save(),vt=!0),O.beginPath(),O.moveTo(we[0],we[1]),O.lineTo(we[2],we[3]),O.lineTo(we[4],we[5]),O.lineTo(we[6],we[7]),O.moveTo(Nt[6],Nt[7]),O.lineTo(Nt[4],Nt[5]),O.lineTo(Nt[2],Nt[3]),O.lineTo(Nt[0],Nt[1]),O.clip())}ye.push(we),de.push(ae),this.drawTile(Ye,e,Rn,Pn,pi,tr,Ke,Rt),vt&&O.restore(),this.renderedTiles.unshift(Ye),this.updateUsedTiles(e.usedTiles,d,Ye)}}if(this.renderedResolution=v,this.extentChanged=!this.renderedExtent_||!Lf(this.renderedExtent_,z),this.renderedExtent_=z,this.renderedPixelRatio=c,this.postRender(this.context,e),i.extent&&O.restore(),O.imageSmoothingEnabled=!0,this.renderComplete){const J=(ae,ie)=>{const $=ct(d),K=ie.wantedTiles[$],Ae=K?Object.keys(K).length:0;this.updateCacheSize(Ae),this.tileCache_.expireCache(),this.sourceTileCache_?.expireCache()};e.postRenderFunctions.push(J)}return this.container}updateCacheSize(e){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,e*2)}drawTile(e,t,i,r,s,o,a,c){let h;if(e instanceof FA){if(h=IE(e.getData()),!h)throw new Error("Rendering array data is not yet supported")}else h=this.getTileImage(e);if(!h)return;const d=this.getRenderContext(t),g=ct(this),m=t.layerStatesArray[t.layerIndex],v=m.opacity*(c?e.getAlpha(g,t.time):1),y=v!==d.globalAlpha;y&&(d.save(),d.globalAlpha=v),d.drawImage(h,a,a,h.width-2*a,h.height-2*a,i,r,s,o),y&&d.restore(),v!==m.opacity?t.animate=!0:c&&e.endTransition(g)}getImage(){const e=this.context;return e?e.canvas:null}getTileImage(e){return e.getImage()}updateUsedTiles(e,t,i){const r=ct(t);r in e||(e[r]={}),e[r][i.getKey()]=!0}}const yp={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class KV extends V_{constructor(e){e=e||{};const t=Object.assign({},e),i=e.cacheSize;delete e.cacheSize,delete t.preload,delete t.useInterimTilesOnError,super(t),this.on,this.once,this.un,this.cacheSize_=i,this.setPreload(e.preload!==void 0?e.preload:0),this.setUseInterimTilesOnError(e.useInterimTilesOnError!==void 0?e.useInterimTilesOnError:!0)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(yp.PRELOAD)}setPreload(e){this.set(yp.PRELOAD,e)}getUseInterimTilesOnError(){return this.get(yp.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(e){this.set(yp.USE_INTERIM_TILES_ON_ERROR,e)}getData(e){return super.getData(e)}}class oo extends KV{constructor(e){super(e)}createRenderer(){return new WV(this,{cacheSize:this.getCacheSize()})}}const _u=[0,0,0],sa=5;class d4{constructor(e){this.minZoom=e.minZoom!==void 0?e.minZoom:0,this.resolutions_=e.resolutions,_t(f5(this.resolutions_,(r,s)=>s-r),"`resolutions` must be sorted in descending order");let t;if(!e.origins){for(let r=0,s=this.resolutions_.length-1;r<s;++r)if(!t)t=this.resolutions_[r]/this.resolutions_[r+1];else if(this.resolutions_[r]/this.resolutions_[r+1]!==t){t=void 0;break}}this.zoomFactor_=t,this.maxZoom=this.resolutions_.length-1,this.origin_=e.origin!==void 0?e.origin:null,this.origins_=null,e.origins!==void 0&&(this.origins_=e.origins,_t(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const i=e.extent;i!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=wc(i)),_t(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,e.tileSizes!==void 0&&(this.tileSizes_=e.tileSizes,_t(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=e.tileSize!==void 0?e.tileSize:this.tileSizes_?null:_x,_t(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=i!==void 0?i:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],e.sizes!==void 0?this.fullTileRanges_=e.sizes.map((r,s)=>{const o=new Ex(Math.min(0,r[0]),Math.max(r[0]-1,-1),Math.min(0,r[1]),Math.max(r[1]-1,-1));if(i){const a=this.getTileRangeForExtentAndZ(i,s);o.minX=Math.max(a.minX,o.minX),o.maxX=Math.min(a.maxX,o.maxX),o.minY=Math.max(a.minY,o.minY),o.maxY=Math.min(a.maxY,o.maxY)}return o}):i&&this.calculateTileRanges_(i)}forEachTileCoord(e,t,i){const r=this.getTileRangeForExtentAndZ(e,t);for(let s=r.minX,o=r.maxX;s<=o;++s)for(let a=r.minY,c=r.maxY;a<=c;++a)i([t,s,a])}forEachTileCoordParentTileRange(e,t,i,r){let s,o,a,c=null,h=e[0]-1;for(this.zoomFactor_===2?(o=e[1],a=e[2]):c=this.getTileCoordExtent(e,r);h>=this.minZoom;){if(o!==void 0&&a!==void 0?(o=Math.floor(o/2),a=Math.floor(a/2),s=pu(o,o,a,a,i)):s=this.getTileRangeForExtentAndZ(c,h,i),t(h,s))return!0;--h}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(e){return this.origin_?this.origin_:this.origins_[e]}getResolution(e){return this.resolutions_[e]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(e,t,i){if(e[0]<this.maxZoom){if(this.zoomFactor_===2){const s=e[1]*2,o=e[2]*2;return pu(s,s+1,o,o+1,t)}const r=this.getTileCoordExtent(e,i||this.tmpExtent_);return this.getTileRangeForExtentAndZ(r,e[0]+1,t)}return null}getTileRangeForTileCoordAndZ(e,t,i){if(t>this.maxZoom||t<this.minZoom)return null;const r=e[0],s=e[1],o=e[2];if(t===r)return pu(s,o,s,o,i);if(this.zoomFactor_){const c=Math.pow(this.zoomFactor_,t-r),h=Math.floor(s*c),d=Math.floor(o*c);if(t<r)return pu(h,h,d,d,i);const g=Math.floor(c*(s+1))-1,m=Math.floor(c*(o+1))-1;return pu(h,g,d,m,i)}const a=this.getTileCoordExtent(e,this.tmpExtent_);return this.getTileRangeForExtentAndZ(a,t,i)}getTileRangeForExtentAndZ(e,t,i){this.getTileCoordForXYAndZ_(e[0],e[3],t,!1,_u);const r=_u[1],s=_u[2];this.getTileCoordForXYAndZ_(e[2],e[1],t,!0,_u);const o=_u[1],a=_u[2];return pu(r,o,s,a,i)}getTileCoordCenter(e){const t=this.getOrigin(e[0]),i=this.getResolution(e[0]),r=Mi(this.getTileSize(e[0]),this.tmpSize_);return[t[0]+(e[1]+.5)*r[0]*i,t[1]-(e[2]+.5)*r[1]*i]}getTileCoordExtent(e,t){const i=this.getOrigin(e[0]),r=this.getResolution(e[0]),s=Mi(this.getTileSize(e[0]),this.tmpSize_),o=i[0]+e[1]*s[0]*r,a=i[1]-(e[2]+1)*s[1]*r,c=o+s[0]*r,h=a+s[1]*r;return Da(o,a,c,h,t)}getTileCoordForCoordAndResolution(e,t,i){return this.getTileCoordForXYAndResolution_(e[0],e[1],t,!1,i)}getTileCoordForXYAndResolution_(e,t,i,r,s){const o=this.getZForResolution(i),a=i/this.getResolution(o),c=this.getOrigin(o),h=Mi(this.getTileSize(o),this.tmpSize_);let d=a*(e-c[0])/i/h[0],g=a*(c[1]-t)/i/h[1];return r?(d=cp(d,sa)-1,g=cp(g,sa)-1):(d=lp(d,sa),g=lp(g,sa)),I0(o,d,g,s)}getTileCoordForXYAndZ_(e,t,i,r,s){const o=this.getOrigin(i),a=this.getResolution(i),c=Mi(this.getTileSize(i),this.tmpSize_);let h=(e-o[0])/a/c[0],d=(o[1]-t)/a/c[1];return r?(h=cp(h,sa)-1,d=cp(d,sa)-1):(h=lp(h,sa),d=lp(d,sa)),I0(i,h,d,s)}getTileCoordForCoordAndZ(e,t,i){return this.getTileCoordForXYAndZ_(e[0],e[1],t,!1,i)}getTileCoordResolution(e){return this.resolutions_[e[0]]}getTileSize(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]}getFullTileRange(e){return this.fullTileRanges_?this.fullTileRanges_[e]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,e):null}getZForResolution(e,t){const i=zw(this.resolutions_,e,t||0);return kt(i,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(e,t){return Eb(t,0,t.length,2,this.getTileCoordExtent(e))}calculateTileRanges_(e){const t=this.resolutions_.length,i=new Array(t);for(let r=this.minZoom;r<t;++r)i[r]=this.getTileRangeForExtentAndZ(e,r);this.fullTileRanges_=i}}function f4(n){let e=n.getDefaultTileGrid();return e||(e=YV(n),n.setDefaultTileGrid(e)),e}function qV(n,e,t){const i=e[0],r=n.getTileCoordCenter(e),s=wx(t);if(!lh(s,r)){const o=ut(s),a=Math.ceil((s[0]-r[0])/o);return r[0]+=o*a,n.getTileCoordForCoordAndZ(r,i)}return e}function HV(n,e,t,i){i=i!==void 0?i:"top-left";const r=g4(n,e,t);return new d4({extent:n,origin:v5(n,i),resolutions:r,tileSize:t})}function XV(n){const e=n||{},t=e.extent||Un("EPSG:3857").getExtent(),i={extent:t,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:g4(t,e.maxZoom,e.tileSize,e.maxResolution)};return new d4(i)}function g4(n,e,t,i){e=e!==void 0?e:AV,t=Mi(t!==void 0?t:_x);const r=ei(n),s=ut(n);i=i>0?i:Math.max(s/t[0],r/t[1]);const o=e+1,a=new Array(o);for(let c=0;c<o;++c)a[c]=i/Math.pow(2,c);return a}function YV(n,e,t,i){const r=wx(n);return HV(r,e,t,i)}function wx(n){n=Un(n);let e=n.getExtent();if(!e){const t=180*Kw.degrees/n.getMetersPerUnit();e=Da(-t,-t,t,t)}return e}function m4(n,e){const t=[];Object.keys(e).forEach(function(r){e[r]!==null&&e[r]!==void 0&&t.push(r+"="+encodeURIComponent(e[r]))});const i=t.join("&");return n=n.replace(/[?&]$/,""),n+=n.includes("?")?"&":"?",n+i}const ZV=/\{z\}/g,QV=/\{x\}/g,JV=/\{y\}/g,eF=/\{-y\}/g;function tF(n,e,t,i,r){return n.replace(ZV,e.toString()).replace(QV,t.toString()).replace(JV,i.toString()).replace(eF,function(){if(r===void 0)throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(r-i).toString()})}function nF(n){const e=[];let t=/\{([a-z])-([a-z])\}/.exec(n);if(t){const i=t[1].charCodeAt(0),r=t[2].charCodeAt(0);let s;for(s=i;s<=r;++s)e.push(n.replace(t[0],String.fromCharCode(s)));return e}if(t=/\{(\d+)-(\d+)\}/.exec(n),t){const i=parseInt(t[2],10);for(let r=parseInt(t[1],10);r<=i;r++)e.push(n.replace(t[0],r.toString()));return e}return e.push(n),e}function iF(n,e){return(function(t,i,r){if(!t)return;let s;const o=t[0];if(e){const a=e.getFullTileRange(o);a&&(s=a.getHeight()-1)}return tF(n,o,t[1],t[2],s)})}function rF(n,e){const t=n.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=iF(n[r],e);return sF(i)}function sF(n){return n.length===1?n[0]:(function(e,t,i){if(!e)return;const r=h4(e),s=Ra(r,n.length);return n[s](e,t,i)})}class oF extends Bb{constructor(e){super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX,interpolate:e.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=e.tilePixelRatio!==void 0?e.tilePixelRatio:1,this.tileGrid=e.tileGrid!==void 0?e.tileGrid:null;const t=[256,256];this.tileGrid&&Mi(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),t),this.tmpSize=[0,0],this.key_=e.key||ct(this),this.tileOptions={transition:e.transition,interpolate:e.interpolate},this.zDirection=e.zDirection?e.zDirection:0}getGutterForProjection(e){return 0}getKey(){return this.key_}setKey(e){this.key_!==e&&(this.key_=e,this.changed())}getResolutions(e){const t=e?this.getTileGridForProjection(e):this.tileGrid;return t?t.getResolutions():null}getTile(e,t,i,r,s,o){return at()}getTileGrid(){return this.tileGrid}getTileGridForProjection(e){return this.tileGrid?this.tileGrid:f4(e)}getTilePixelRatio(e){return this.tilePixelRatio_}getTilePixelSize(e,t,i){const r=this.getTileGridForProjection(i),s=this.getTilePixelRatio(t),o=Mi(r.getTileSize(e),this.tmpSize);return s==1?o:d8(o,s,this.tmpSize)}getTileCoordForTileUrlFunction(e,t){const i=t!==void 0?t:this.getProjection(),r=t!==void 0?this.getTileGridForProjection(i):this.tileGrid||this.getTileGridForProjection(i);return this.getWrapX()&&i.isGlobal()&&(e=qV(r,e,i)),BV(e,r)?e:null}clear(){}refresh(){this.clear(),super.refresh()}}class aF extends Io{constructor(e,t){super(e),this.tile=t}}const y1={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};class xx extends oF{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===xx.prototype.tileUrlFunction,this.tileLoadFunction=e.tileLoadFunction,e.tileUrlFunction&&(this.tileUrlFunction=e.tileUrlFunction),this.urls=null,e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(e){const t=e.target,i=ct(t),r=t.getState();let s;r==Le.LOADING?(this.tileLoadingKeys_[i]=!0,s=y1.TILELOADSTART):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],s=r==Le.ERROR?y1.TILELOADERROR:r==Le.LOADED?y1.TILELOADEND:void 0),s!=null&&this.dispatchEvent(new aF(s,t))}setTileLoadFunction(e){this.tileLoadFunction=e,this.changed()}setTileUrlFunction(e,t){this.tileUrlFunction=e,typeof t<"u"?this.setKey(t):this.changed()}setUrl(e){const t=nF(e);this.urls=t,this.setUrls(t)}setUrls(e){this.urls=e;const t=e.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(rF(e,this.tileGrid),t):this.setKey(t)}tileUrlFunction(e,t,i){}}class p4 extends xx{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:_4,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate!==void 0?e.interpolate:!0,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.crossOrigin=e.crossOrigin!==void 0?e.crossOrigin:null,this.tileClass=e.tileClass!==void 0?e.tileClass:c4,this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(e){return this.getProjection()&&e&&!Fp(this.getProjection(),e)?0:this.getGutter()}getGutter(){return 0}getKey(){let e=super.getKey();return this.getInterpolate()||(e+=":disable-interpolation"),e}getTileGridForProjection(e){const t=this.getProjection();if(this.tileGrid&&(!t||Fp(t,e)))return this.tileGrid;const i=ct(e);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=f4(e)),this.tileGridForProjection[i]}createTile_(e,t,i,r,s,o){const a=[e,t,i],c=this.getTileCoordForTileUrlFunction(a,s),h=c?this.tileUrlFunction(c,r,s):void 0,d=new this.tileClass(a,h!==void 0?Le.IDLE:Le.EMPTY,h!==void 0?h:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return d.key=o,d.addEventListener(He.CHANGE,this.handleTileChange.bind(this)),d}getTile(e,t,i,r,s,o){const a=this.getProjection();if(!a||!s||Fp(a,s))return this.getTileInternal(e,t,i,r,a||s);const c=[e,t,i],h=this.getKey(),d=this.getTileGridForProjection(a),g=this.getTileGridForProjection(s),m=this.getTileCoordForTileUrlFunction(c,s),v=new u4(a,d,s,g,c,m,this.getTilePixelRatio(r),this.getGutter(),(y,T,w,A)=>this.getTileInternal(y,T,w,A,a,o),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return v.key=h,v}getTileInternal(e,t,i,r,s,o){const a=this.getKey(),c=jp(this,a,e,t,i);if(o&&o.containsKey(c))return o.get(c);const h=this.createTile_(e,t,i,r,s,a);return o?.set(c,h),h}setRenderReprojectionEdges(e){this.renderReprojectionEdges_!=e&&(this.renderReprojectionEdges_=e,this.changed())}setTileGridForProjection(e,t){const i=Un(e);if(i){const r=ct(i);r in this.tileGridForProjection||(this.tileGridForProjection[r]=t)}}}function _4(n,e){if(qi){const t=n.getCrossOrigin();let i="same-origin",r="same-origin";t==="anonymous"||t===""?(i="cors",r="omit"):t==="use-credentials"&&(i="cors",r="include"),fetch(e,{mode:i,credentials:r}).then(s=>{if(!s.ok)throw new Error(`HTTP ${s.status}`);return s.blob()}).then(s=>createImageBitmap(s)).then(s=>{const o=n.getImage();o.width=s.width,o.height=s.height,o.getContext("2d").drawImage(s,0,0),s.close?.(),o.dispatchEvent(new Event("load"))}).catch(()=>{n.getImage().dispatchEvent(new Event("error"))});return}n.getImage().src=e}class ha extends p4{constructor(e){e=e||{};const t=e.projection!==void 0?e.projection:"EPSG:3857",i=e.tileGrid!==void 0?e.tileGrid:XV({extent:wx(t),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize});super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:t,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:i,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0}getGutter(){return this.gutter_}}const lF="modulepreload",cF=function(n){return"/detectorapp-nl/"+n},BA={},Ue=function(e,t,i){let r=Promise.resolve();if(t&&t.length>0){let c=function(h){return Promise.all(h.map(d=>Promise.resolve(d).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=o?.nonce||o?.getAttribute("nonce");r=c(t.map(h=>{if(h=cF(h),h in BA)return;BA[h]=!0;const d=h.endsWith(".css"),g=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${g}`))return;const m=document.createElement("link");if(m.rel=d?"stylesheet":lF,d||(m.as="script"),m.crossOrigin="",m.href=h,a&&m.setAttribute("nonce",a),document.head.appendChild(m),d)return new Promise((v,y)=>{m.addEventListener("load",v),m.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${h}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return r.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return e().catch(s)})},$A=4,RE="1.3.0";function uF(n,e,t,i,r){r.WIDTH=t[0],r.HEIGHT=t[1];const s=i.getAxisOrientation(),o=ib(r.VERSION,"1.3")>=0;r[o?"CRS":"SRS"]=i.getCode();const a=o&&s.startsWith("ne")?[e[1],e[0],e[3],e[2]]:e;return r.BBOX=a.join(","),m4(n,r)}function hF(n,e,t,i,r,s,o){s=Object.assign({REQUEST:"GetMap"},s);const a=e/t,c=[$2(ut(n)/a,$A),$2(ei(n)/a,$A)];if(t!=1)switch(o){case"geoserver":const d=90*t+.5|0;"FORMAT_OPTIONS"in s?s.FORMAT_OPTIONS+=";dpi:"+d:s.FORMAT_OPTIONS="dpi:"+d;break;case"mapserver":s.MAP_RESOLUTION=90*t;break;case"carmentaserver":case"qgis":s.DPI=90*t;break;default:throw new Error("Unknown `serverType` configured")}return uF(r,n,c,i,s)}function WA(n,e){return Object.assign({REQUEST:e,SERVICE:"WMS",VERSION:RE,FORMAT:"image/png",STYLES:"",TRANSPARENT:"TRUE"},n)}const dF='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.';class fF extends ha{constructor(e){e=e||{};let t;e.attributions!==void 0?t=e.attributions:t=[dF];const i=e.crossOrigin!==void 0?e.crossOrigin:"anonymous",r=e.url!==void 0?e.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:t,attributionsCollapsible:!1,cacheSize:e.cacheSize,crossOrigin:i,interpolate:e.interpolate,maxZoom:e.maxZoom!==void 0?e.maxZoom:19,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileLoadFunction:(s,o)=>{const a=s.getImage();!qi&&a instanceof HTMLImageElement&&(a.referrerPolicy="origin-when-cross-origin"),(e.tileLoadFunction||_4)(s,o)},transition:e.transition,url:r,wrapX:e.wrapX,zDirection:e.zDirection})}}const A0=1/0;class gF{constructor(e,t){this.priorityFunction_=e,this.keyFunction_=t,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,yg(this.queuedElements_)}dequeue(){const e=this.elements_,t=this.priorities_,i=e[0];e.length==1?(e.length=0,t.length=0):(e[0]=e.pop(),t[0]=t.pop(),this.siftUp_(0));const r=this.keyFunction_(i);return delete this.queuedElements_[r],i}enqueue(e){_t(!(this.keyFunction_(e)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const t=this.priorityFunction_(e);return t!=A0?(this.elements_.push(e),this.priorities_.push(t),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(e){return e*2+1}getRightChildIndex_(e){return e*2+2}getParentIndex_(e){return e-1>>1}heapify_(){let e;for(e=(this.elements_.length>>1)-1;e>=0;e--)this.siftUp_(e)}isEmpty(){return this.elements_.length===0}isKeyQueued(e){return e in this.queuedElements_}isQueued(e){return this.isKeyQueued(this.keyFunction_(e))}siftUp_(e){const t=this.elements_,i=this.priorities_,r=t.length,s=t[e],o=i[e],a=e;for(;e<r>>1;){const c=this.getLeftChildIndex_(e),h=this.getRightChildIndex_(e),d=h<r&&i[h]<i[c]?h:c;t[e]=t[d],i[e]=i[d],e=d}t[e]=s,i[e]=o,this.siftDown_(a,e)}siftDown_(e,t){const i=this.elements_,r=this.priorities_,s=i[t],o=r[t];for(;t>e;){const a=this.getParentIndex_(t);if(r[a]>o)i[t]=i[a],r[t]=r[a],t=a;else break}i[t]=s,r[t]=o}reprioritize(){const e=this.priorityFunction_,t=this.elements_,i=this.priorities_;let r=0;const s=t.length;let o,a,c;for(a=0;a<s;++a)o=t[a],c=e(o),c==A0?delete this.queuedElements_[this.keyFunction_(o)]:(i[r]=c,t[r++]=o);t.length=r,i.length=r,this.heapify_()}}class mF extends gF{constructor(e,t){super(i=>e.apply(null,i),i=>i[0].getKey()),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=t,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(e){const t=super.enqueue(e);return t&&e[0].addEventListener(He.CHANGE,this.boundHandleTileChange_),t}getTilesLoading(){return this.tilesLoading_}handleTileChange(e){const t=e.target,i=t.getState();if(i===Le.LOADED||i===Le.ERROR||i===Le.EMPTY){i!==Le.ERROR&&t.removeEventListener(He.CHANGE,this.boundHandleTileChange_);const r=t.getKey();r in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[r],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(e,t){let i=0;for(;this.tilesLoading_<e&&i<t&&this.getCount()>0;){const r=this.dequeue()[0],s=r.getKey();r.getState()===Le.IDLE&&!(s in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[s]=!0,++this.tilesLoading_,++i,r.load())}}}function pF(n,e,t,i,r){if(!n||!(t in n.wantedTiles)||!n.wantedTiles[t][e.getKey()])return A0;const s=n.viewState.center,o=i[0]-s[0],a=i[1]-s[1];return 65536*Math.log(r)+Math.sqrt(o*o+a*a)/r}class _F extends p4{constructor(e){e=e||{};const t=Object.assign({},e.params);super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:e.projection,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileClass:e.tileClass,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0,this.params_=t,this.v13_=!0,this.serverType_=e.serverType,this.hidpi_=e.hidpi!==void 0?e.hidpi:!0,this.tmpExtent_=Zi(),this.updateV13_(),this.setKey(this.getKeyForParams_())}getFeatureInfoUrl(e,t,i,r){const s=Un(i),o=this.getProjection()||s;let a=this.getTileGrid();a||(a=this.getTileGridForProjection(o));const c=Sg(e,s,o),h=AE(o,s,e,t),d=a.getZForResolution(h,this.zDirection),g=a.getResolution(d),m=a.getTileCoordForCoordAndZ(c,d);if(a.getResolutions().length<=m[0])return;let v=a.getTileCoordExtent(m,this.tmpExtent_);const y=this.gutter_;y!==0&&(v=kf(v,g*y,v));const T={QUERY_LAYERS:this.params_.LAYERS};Object.assign(T,WA(this.params_,"GetFeatureInfo"),r);const w=Math.floor((c[0]-v[0])/g),A=Math.floor((v[3]-c[1])/g);return T[this.v13_?"I":"X"]=w,T[this.v13_?"J":"Y"]=A,this.getRequestUrl_(m,v,1,o||s,T)}getLegendUrl(e,t){if(this.urls[0]===void 0)return;const i={SERVICE:"WMS",VERSION:RE,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(t===void 0||t.LAYER===void 0){const r=this.params_.LAYERS;if(!(!Array.isArray(r)||r.length===1))return;i.LAYER=r}if(e!==void 0){const r=this.getProjection()?this.getProjection().getMetersPerUnit():1,s=28e-5;i.SCALE=e*r/s}return Object.assign(i,t),m4(this.urls[0],i)}getGutter(){return this.gutter_}getParams(){return this.params_}getRequestUrl_(e,t,i,r,s){const o=this.urls;if(!o)return;let a;if(o.length==1)a=o[0];else{const c=Ra(h4(e),o.length);a=o[c]}return hF(t,(this.tileGrid||this.getTileGridForProjection(r)).getResolution(e[0]),i,r,a,s,this.serverType_)}getTilePixelRatio(e){return!this.hidpi_||this.serverType_===void 0?1:e}getKeyForParams_(){let e=0;const t=[];for(const i in this.params_)t[e++]=i+"-"+this.params_[i];return t.join("/")}setParams_(e){this.params_=e,this.updateV13_(),this.setKey(this.getKeyForParams_())}setParams(e){this.setParams_(Object.assign({},e))}updateParams(e){this.setParams_(Object.assign(this.params_,e))}updateV13_(){const e=this.params_.VERSION||RE;this.v13_=ib(e,"1.3")>=0}tileUrlFunction(e,t,i){let r=this.getTileGrid();if(r||(r=this.getTileGridForProjection(i)),r.getResolutions().length<=e[0])return;t!=1&&(!this.hidpi_||this.serverType_===void 0)&&(t=1);const s=r.getResolution(e[0]);let o=r.getTileCoordExtent(e,this.tmpExtent_);const a=this.gutter_;a!==0&&(o=kf(o,s*a,o));const c=Object.assign({},WA(this.params_,"GetMap"));return this.getRequestUrl_(e,o,t,i,c)}}class Pu extends Io{constructor(e,t,i){super(e),this.map=t,this.frameState=i!==void 0?i:null}}class da extends Pu{constructor(e,t,i,r,s,o){super(e,t,s),this.originalEvent=i,this.pixel_=null,this.coordinate_=null,this.dragging=r!==void 0?r:!1,this.activePointers=o}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(e){this.pixel_=e}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(e){this.coordinate_=e}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const Kt={SINGLECLICK:"singleclick",CLICK:He.CLICK,DBLCLICK:He.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},PE={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown"};class yF extends vg{constructor(e,t){super(e),this.map_=e,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=t===void 0?1:t,this.down_=null;const i=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=i,this.pointerdownListenerKey_=lt(i,PE.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=lt(i,PE.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(He.TOUCHMOVE,this.boundHandleTouchMove_,Ab?{passive:!1}:!1)}emulateClick_(e){let t=new da(Kt.CLICK,this.map_,e);this.dispatchEvent(t),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,t=new da(Kt.DBLCLICK,this.map_,e),this.dispatchEvent(t)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const i=new da(Kt.SINGLECLICK,this.map_,e);this.dispatchEvent(i)},250)}updateActivePointers_(e){const t=e,i=t.pointerId;if(t.type==Kt.POINTERUP||t.type==Kt.POINTERCANCEL){delete this.trackedTouches_[i];for(const r in this.trackedTouches_)if(this.trackedTouches_[r].target!==t.target){delete this.trackedTouches_[r];break}}else(t.type==Kt.POINTERDOWN||t.type==Kt.POINTERMOVE)&&(this.trackedTouches_[i]=t);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(e){this.updateActivePointers_(e);const t=new da(Kt.POINTERUP,this.map_,e,void 0,void 0,this.activePointers_);this.dispatchEvent(t),this.emulateClicks_&&!t.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(e)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(Ft),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(e){return e.button===0}handlePointerDown_(e){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(e);const t=new da(Kt.POINTERDOWN,this.map_,e,void 0,void 0,this.activePointers_);if(this.dispatchEvent(t),this.down_=new PointerEvent(e.type,e),Object.defineProperty(this.down_,"target",{writable:!1,value:e.target}),this.dragListenerKeys_.length===0){const i=this.map_.getOwnerDocument();this.dragListenerKeys_.push(lt(i,Kt.POINTERMOVE,this.handlePointerMove_,this),lt(i,Kt.POINTERUP,this.handlePointerUp_,this),lt(this.element_,Kt.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==i&&this.dragListenerKeys_.push(lt(this.element_.getRootNode(),Kt.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(e){if(this.isMoving_(e)){this.updateActivePointers_(e),this.dragging_=!0;const t=new da(Kt.POINTERDRAG,this.map_,e,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(t)}}relayMoveEvent_(e){this.originalPointerMoveEvent_=e;const t=!!(this.down_&&this.isMoving_(e));this.dispatchEvent(new da(Kt.POINTERMOVE,this.map_,e,t))}handleTouchMove_(e){const t=this.originalPointerMoveEvent_;(!t||t.defaultPrevented)&&(typeof e.cancelable!="boolean"||e.cancelable===!0)&&e.preventDefault()}isMoving_(e){return this.dragging_||Math.abs(e.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(e.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(Ft(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(He.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(Ft(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(Ft),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const fa={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},Hn={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"};class Sx extends Os{constructor(e){super();const t=e.element;t&&!e.target&&!t.style.pointerEvents&&(t.style.pointerEvents="auto"),this.element=t||null,this.target_=null,this.map_=null,this.listenerKeys=[],e.render&&(this.render=e.render),e.target&&this.setTarget(e.target)}disposeInternal(){this.element?.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(e){this.map_&&this.element?.remove();for(let t=0,i=this.listenerKeys.length;t<i;++t)Ft(this.listenerKeys[t]);if(this.listenerKeys.length=0,this.map_=e,e){const t=this.target_??e.getOverlayContainerStopEvent();this.element&&t.appendChild(this.element),this.render!==bf&&this.listenerKeys.push(lt(e,fa.POSTRENDER,this.render,this)),e.render()}}render(e){}setTarget(e){this.target_=typeof e=="string"?document.getElementById(e):e}}class vF extends Sx{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=e.collapsed!==void 0?e.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=e.collapsible!==void 0,this.collapsible_=e.collapsible!==void 0?e.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.attributions_=e.attributions;const t=e.className!==void 0?e.className:"ol-attribution",i=e.tipLabel!==void 0?e.tipLabel:"Attributions",r=e.expandClassName!==void 0?e.expandClassName:t+"-expand",s=e.collapseLabel!==void 0?e.collapseLabel:"",o=e.collapseClassName!==void 0?e.collapseClassName:t+"-collapse";typeof s=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=s,this.collapseLabel_.className=o):this.collapseLabel_=s;const a=e.label!==void 0?e.label:"i";typeof a=="string"?(this.label_=document.createElement("span"),this.label_.textContent=a,this.label_.className=r):this.label_=a;const c=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=i,this.toggleButton_.appendChild(c),this.toggleButton_.addEventListener(He.CLICK,this.handleClick_.bind(this),!1);const h=t+" "+k_+" "+lx+(this.collapsed_&&this.collapsible_?" "+aA:"")+(this.collapsible_?"":" ol-uncollapsible"),d=this.element;d.className=h,d.appendChild(this.toggleButton_),d.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(e){const t=this.getMap().getAllLayers(),i=new Set(t.flatMap(r=>r.getAttributions(e)));if(this.attributions_!==void 0&&(Array.isArray(this.attributions_)?this.attributions_.forEach(r=>i.add(r)):i.add(this.attributions_)),!this.overrideCollapsible_){const r=!t.some(s=>s.getSource()?.getAttributionsCollapsible()===!1);this.setCollapsible(r)}return Array.from(i)}async updateElement_(e){if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=await Promise.all(this.collectSourceAttributions_(e).map(r=>qM(()=>r))),i=t.length>0;if(this.renderedVisible_!=i&&(this.element.style.display=i?"":"none",this.renderedVisible_=i),!qa(t,this.renderedAttributions_)){y6(this.ulElement_);for(let r=0,s=t.length;r<s;++r){const o=document.createElement("li");o.innerHTML=t[r],this.ulElement_.appendChild(o)}this.renderedAttributions_=t}}handleClick_(e){e.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(aA),this.collapsed_?sA(this.collapseLabel_,this.label_):sA(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(e){this.userCollapsed_=e,!(!this.collapsible_||this.collapsed_===e)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(e){this.updateElement_(e.frameState)}}class EF extends Sx{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target});const t=e.className!==void 0?e.className:"ol-rotate",i=e.label!==void 0?e.label:"",r=e.compassClassName!==void 0?e.compassClassName:"ol-compass";this.label_=null,typeof i=="string"?(this.label_=document.createElement("span"),this.label_.className=r,this.label_.textContent=i):(this.label_=i,this.label_.classList.add(r));const s=e.tipLabel?e.tipLabel:"Reset rotation",o=document.createElement("button");o.className=t+"-reset",o.setAttribute("type","button"),o.title=s,o.appendChild(this.label_),o.addEventListener(He.CLICK,this.handleClick_.bind(this),!1);const a=t+" "+k_+" "+lx,c=this.element;c.className=a,c.appendChild(o),this.callResetNorth_=e.resetNorth?e.resetNorth:void 0,this.duration_=e.duration!==void 0?e.duration:250,this.autoHide_=e.autoHide!==void 0?e.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(dp)}handleClick_(e){e.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const t=this.getMap().getView();if(!t)return;const i=t.getRotation();i!==void 0&&(this.duration_>0&&i%(2*Math.PI)!==0?t.animate({rotation:0,duration:this.duration_,easing:Lh}):t.setRotation(0))}render(e){const t=e.frameState;if(!t)return;const i=t.viewState.rotation;if(i!=this.rotation_){const r="rotate("+i+"rad)";if(this.autoHide_){const s=this.element.classList.contains(dp);!s&&i===0?this.element.classList.add(dp):s&&i!==0&&this.element.classList.remove(dp)}this.label_.style.transform=r}this.rotation_=i}}class wF extends Sx{constructor(e){e=e||{},super({element:document.createElement("div"),target:e.target});const t=e.className!==void 0?e.className:"ol-zoom",i=e.delta!==void 0?e.delta:1,r=e.zoomInClassName!==void 0?e.zoomInClassName:t+"-in",s=e.zoomOutClassName!==void 0?e.zoomOutClassName:t+"-out",o=e.zoomInLabel!==void 0?e.zoomInLabel:"+",a=e.zoomOutLabel!==void 0?e.zoomOutLabel:"",c=e.zoomInTipLabel!==void 0?e.zoomInTipLabel:"Zoom in",h=e.zoomOutTipLabel!==void 0?e.zoomOutTipLabel:"Zoom out",d=document.createElement("button");d.className=r,d.setAttribute("type","button"),d.title=c,d.appendChild(typeof o=="string"?document.createTextNode(o):o),d.addEventListener(He.CLICK,this.handleClick_.bind(this,i),!1);const g=document.createElement("button");g.className=s,g.setAttribute("type","button"),g.title=h,g.appendChild(typeof a=="string"?document.createTextNode(a):a),g.addEventListener(He.CLICK,this.handleClick_.bind(this,-i),!1);const m=t+" "+k_+" "+lx,v=this.element;v.className=m,v.appendChild(d),v.appendChild(g),this.duration_=e.duration!==void 0?e.duration:250}handleClick_(e,t){t.preventDefault(),this.zoomByDelta_(e)}zoomByDelta_(e){const i=this.getMap().getView();if(!i)return;const r=i.getZoom();if(r!==void 0){const s=i.getConstrainedZoom(r+e);this.duration_>0?(i.getAnimating()&&i.cancelAnimations(),i.animate({zoom:s,duration:this.duration_,easing:Lh})):i.setZoom(s)}}}function xF(n){n=n||{};const e=new Er;return(n.zoom===void 0||n.zoom)&&e.push(new wF(n.zoomOptions)),(n.rotate===void 0||n.rotate)&&e.push(new EF(n.rotateOptions)),(n.attribution===void 0||n.attribution)&&e.push(new vF(n.attributionOptions)),e}class SF{constructor(e,t,i){this.decay_=e,this.minVelocity_=t,this.delay_=i,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(e,t){this.points_.push(e,t,Date.now())}end(){if(this.points_.length<6)return!1;const e=Date.now()-this.delay_,t=this.points_.length-3;if(this.points_[t+2]<e)return!1;let i=t-3;for(;i>0&&this.points_[i+2]>e;)i-=3;const r=this.points_[t+2]-this.points_[i+2];if(r<1e3/60)return!1;const s=this.points_[t]-this.points_[i],o=this.points_[t+1]-this.points_[i+1];return this.angle_=Math.atan2(o,s),this.initialVelocity_=Math.sqrt(s*s+o*o)/r,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}const KA={ACTIVE:"active"};class Ag extends Os{constructor(e){super(),this.on,this.once,this.un,e&&e.handleEvent&&(this.handleEvent=e.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(KA.ACTIVE)}getMap(){return this.map_}handleEvent(e){return!0}setActive(e){this.set(KA.ACTIVE,e)}setMap(e){this.map_=e}}function TF(n,e,t){const i=n.getCenterInternal();if(i){const r=[i[0]+e[0],i[1]+e[1]];n.animateInternal({duration:t!==void 0?t:250,easing:wV,center:n.getConstrainedCenter(r)})}}function Tx(n,e,t,i){const r=n.getZoom();if(r===void 0)return;const s=n.getConstrainedZoom(r+e),o=n.getResolutionForZoom(s);n.getAnimating()&&n.cancelAnimations(),n.animate({resolution:o,anchor:t,duration:i!==void 0?i:250,easing:Lh})}class IF extends Ag{constructor(e){super(),e=e||{},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:250}handleEvent(e){let t=!1;if(e.type==Kt.DBLCLICK){const i=e.originalEvent,r=e.map,s=e.coordinate,o=i.shiftKey?-this.delta_:this.delta_,a=r.getView();Tx(a,o,s,this.duration_),i.preventDefault(),t=!0}return!t}}function CE(n){const e=arguments;return function(t){let i=!0;for(let r=0,s=e.length;r<s&&(i=i&&e[r](t),!!i);++r);return i}}const AF=function(n){const e=n.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},RF=function(n){const e=n.map.getTargetElement(),t=e.getRootNode(),i=n.map.getOwnerDocument().activeElement;return t instanceof ShadowRoot?t.host.contains(i):e.contains(i)},y4=function(n){const e=n.map.getTargetElement(),t=e.getRootNode();return(t instanceof ShadowRoot?t.host:e).hasAttribute("tabindex")?RF(n):!0},PF=Mf,v4=function(n){const e=n.originalEvent;return"pointerId"in e&&e.button==0&&!(p6&&Tb&&e.ctrlKey)},E4=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},CF=function(n){const e=n.originalEvent;return Tb?e.metaKey:e.ctrlKey},MF=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},w4=function(n){const e=n.originalEvent,t=e.target.tagName;return t!=="INPUT"&&t!=="SELECT"&&t!=="TEXTAREA"&&!e.target.isContentEditable},v1=function(n){const e=n.originalEvent;return"pointerId"in e&&e.pointerType=="mouse"},bF=function(n){const e=n.originalEvent;return"pointerId"in e&&e.isPrimary&&e.button===0};class Rg extends Ag{constructor(e){e=e||{},super(e),e.handleDownEvent&&(this.handleDownEvent=e.handleDownEvent),e.handleDragEvent&&(this.handleDragEvent=e.handleDragEvent),e.handleMoveEvent&&(this.handleMoveEvent=e.handleMoveEvent),e.handleUpEvent&&(this.handleUpEvent=e.handleUpEvent),e.stopDown&&(this.stopDown=e.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(e){return!1}handleDragEvent(e){}handleEvent(e){if(!e.originalEvent)return!0;let t=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence){if(e.type==Kt.POINTERDRAG)this.handleDragEvent(e),e.originalEvent.preventDefault();else if(e.type==Kt.POINTERUP){const i=this.handleUpEvent(e);this.handlingDownUpSequence=i&&this.targetPointers.length>0}}else if(e.type==Kt.POINTERDOWN){const i=this.handleDownEvent(e);this.handlingDownUpSequence=i,t=this.stopDown(i)}else e.type==Kt.POINTERMOVE&&this.handleMoveEvent(e);return!t}handleMoveEvent(e){}handleUpEvent(e){return!1}stopDown(e){return e}updateTrackedPointers_(e){e.activePointers&&(this.targetPointers=e.activePointers)}}function Ix(n){const e=n.length;let t=0,i=0;for(let r=0;r<e;r++)t+=n[r].clientX,i+=n[r].clientY;return{clientX:t/e,clientY:i/e}}class kF extends Rg{constructor(e){super({stopDown:E_}),e=e||{},this.kinetic_=e.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const t=e.condition?e.condition:CE(E4,bF);this.condition_=e.onFocusOnly?CE(y4,t):t,this.noKinetic_=!1}handleDragEvent(e){const t=e.map;this.panning_||(this.panning_=!0,t.getView().beginInteraction());const i=this.targetPointers,r=t.getEventPixel(Ix(i));if(i.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(r[0],r[1]),this.lastCentroid){const s=[this.lastCentroid[0]-r[0],r[1]-this.lastCentroid[1]],a=e.map.getView();I5(s,a.getResolution()),Ww(s,a.getRotation()),a.adjustCenterInternal(s)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=r,this.lastPointersCount_=i.length,e.originalEvent.preventDefault()}handleUpEvent(e){const t=e.map,i=t.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const r=this.kinetic_.getDistance(),s=this.kinetic_.getAngle(),o=i.getCenterInternal(),a=t.getPixelFromCoordinateInternal(o),c=t.getCoordinateFromPixelInternal([a[0]-r*Math.cos(s),a[1]-r*Math.sin(s)]);i.animateInternal({center:i.getConstrainedCenter(c),duration:500,easing:Lh})}return this.panning_&&(this.panning_=!1,i.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(e){if(this.targetPointers.length>0&&this.condition_(e)){const i=e.map.getView();return this.lastCentroid=null,i.getAnimating()&&i.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}class LF extends Rg{constructor(e){e=e||{},super({stopDown:E_}),this.condition_=e.condition?e.condition:AF,this.lastAngle_=void 0,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){if(!v1(e))return;const t=e.map,i=t.getView();if(i.getConstraints().rotation===px)return;const r=t.getSize(),s=e.pixel,o=Math.atan2(r[1]/2-s[1],s[0]-r[0]/2);if(this.lastAngle_!==void 0){const a=o-this.lastAngle_;i.adjustRotationInternal(-a)}this.lastAngle_=o}handleUpEvent(e){return v1(e)?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){return v1(e)&&v4(e)&&this.condition_(e)?(e.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}class NF extends y_{constructor(e){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+e,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const e=this.startPixel_,t=this.endPixel_,i="px",r=this.element_.style;r.left=Math.min(e[0],t[0])+i,r.top=Math.min(e[1],t[1])+i,r.width=Math.abs(t[0]-e[0])+i,r.height=Math.abs(t[1]-e[1])+i}setMap(e){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const t=this.element_.style;t.left="inherit",t.top="inherit",t.width="inherit",t.height="inherit"}this.map_=e,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(e,t){this.startPixel_=e,this.endPixel_=t,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;const e=this.startPixel_,t=this.endPixel_,r=[e,[e[0],t[1]],t,[t[0],e[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);r[4]=r[0].slice(),this.geometry_?this.geometry_.setCoordinates([r]):this.geometry_=new jf([r])}getGeometry(){return this.geometry_}}const yu={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class Dd extends Io{constructor(e,t,i){super(e),this.coordinate=t,this.mapBrowserEvent=i}}class DF extends Rg{constructor(e){super(),this.on,this.once,this.un,e=e??{},this.box_=new NF(e.className||"ol-dragbox"),this.minArea_=e.minArea??64,e.onBoxEnd&&(this.onBoxEnd=e.onBoxEnd),this.startPixel_=null,this.condition_=e.condition??v4,this.boxEndCondition_=e.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(e,t,i){const r=i[0]-t[0],s=i[1]-t[1];return r*r+s*s>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(e){this.startPixel_&&(this.box_.setPixels(this.startPixel_,e.pixel),this.dispatchEvent(new Dd(yu.BOXDRAG,e.coordinate,e)))}handleUpEvent(e){if(!this.startPixel_)return!1;const t=this.boxEndCondition_(e,this.startPixel_,e.pixel);return t&&this.onBoxEnd(e),this.dispatchEvent(new Dd(t?yu.BOXEND:yu.BOXCANCEL,e.coordinate,e)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(e){return this.condition_(e)?(this.startPixel_=e.pixel,this.box_.setMap(e.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new Dd(yu.BOXSTART,e.coordinate,e)),!0):!1}onBoxEnd(e){}setActive(e){e||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new Dd(yu.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setActive(e)}setMap(e){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new Dd(yu.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setMap(e)}}class OF extends DF{constructor(e){e=e||{};const t=e.condition?e.condition:MF;super({condition:t,className:e.className||"ol-dragzoom",minArea:e.minArea}),this.duration_=e.duration!==void 0?e.duration:200,this.out_=e.out!==void 0?e.out:!1}onBoxEnd(e){const i=this.getMap().getView();let r=this.getGeometry();if(this.out_){const s=i.rotatedExtentForGeometry(r),o=i.getResolutionForExtentInternal(s),a=i.getResolution()/o;r=r.clone(),r.scale(a*a)}i.fitInternal(r,{duration:this.duration_,easing:Lh})}}const Il={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};class VF extends Ag{constructor(e){super(),e=e||{},this.defaultCondition_=function(t){return E4(t)&&w4(t)},this.condition_=e.condition!==void 0?e.condition:this.defaultCondition_,this.duration_=e.duration!==void 0?e.duration:100,this.pixelDelta_=e.pixelDelta!==void 0?e.pixelDelta:128}handleEvent(e){let t=!1;if(e.type==He.KEYDOWN){const i=e.originalEvent,r=i.key;if(this.condition_(e)&&(r==Il.DOWN||r==Il.LEFT||r==Il.RIGHT||r==Il.UP)){const o=e.map.getView(),a=o.getResolution()*this.pixelDelta_;let c=0,h=0;r==Il.DOWN?h=-a:r==Il.LEFT?c=-a:r==Il.RIGHT?c=a:h=a;const d=[c,h];Ww(d,o.getRotation()),TF(o,d,this.duration_),i.preventDefault(),t=!0}}return!t}}class FF extends Ag{constructor(e){super(),e=e||{},this.condition_=e.condition?e.condition:function(t){return!CF(t)&&w4(t)},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:100}handleEvent(e){let t=!1;if(e.type==He.KEYDOWN||e.type==He.KEYPRESS){const i=e.originalEvent,r=i.key;if(this.condition_(e)&&(r==="+"||r==="-")){const s=e.map,o=r==="+"?this.delta_:-this.delta_,a=s.getView();Tx(a,o,void 0,this.duration_),i.preventDefault(),t=!0}}return!t}}const jF=40,GF=300;class UF extends Ag{constructor(e){e=e||{},super(e),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=e.maxDelta!==void 0?e.maxDelta:1,this.duration_=e.duration!==void 0?e.duration:250,this.timeout_=e.timeout!==void 0?e.timeout:80,this.useAnchor_=e.useAnchor!==void 0?e.useAnchor:!0,this.constrainResolution_=e.constrainResolution!==void 0?e.constrainResolution:!1;const t=e.condition?e.condition:PF;this.condition_=e.onFocusOnly?CE(y4,t):t,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const e=this.getMap();if(!e)return;e.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null)}handleEvent(e){if(!this.condition_(e)||e.type!==He.WHEEL)return!0;const i=e.map,r=e.originalEvent;r.preventDefault(),this.useAnchor_&&(this.lastAnchor_=e.pixel);let s=r.deltaY;switch(r.deltaMode){case WheelEvent.DOM_DELTA_LINE:s*=jF;break;case WheelEvent.DOM_DELTA_PAGE:s*=GF;break}if(s===0)return!1;this.lastDelta_=s;const o=Date.now();this.startTime_===void 0&&(this.startTime_=o),(!this.mode_||o-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(s)<4?"trackpad":"wheel");const a=i.getView();if(this.mode_==="trackpad"&&!(a.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(a.getAnimating()&&a.cancelAnimations(),a.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),a.adjustZoom(-s/this.deltaPerZoom_,this.lastAnchor_?i.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=o,!1;this.totalDelta_+=s;const c=Math.max(this.timeout_-(o-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,i),c),!1}handleWheelZoom_(e){const t=e.getView();t.getAnimating()&&t.cancelAnimations();let i=-kt(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(t.getConstrainResolution()||this.constrainResolution_)&&(i=i?i>0?1:-1:0),Tx(t,i,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(e){this.useAnchor_=e,e||(this.lastAnchor_=null)}}class zF extends Rg{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=E_),super(t),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=e.threshold!==void 0?e.threshold:.3,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){let t=0;const i=this.targetPointers[0],r=this.targetPointers[1],s=Math.atan2(r.clientY-i.clientY,r.clientX-i.clientX);if(this.lastAngle_!==void 0){const c=s-this.lastAngle_;this.rotationDelta_+=c,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),t=c}this.lastAngle_=s;const o=e.map,a=o.getView();a.getConstraints().rotation!==px&&(this.anchor_=o.getCoordinateFromPixelInternal(o.getEventPixel(Ix(this.targetPointers))),this.rotating_&&(o.render(),a.adjustRotationInternal(t,this.anchor_)))}handleUpEvent(e){return this.targetPointers.length<2?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}class BF extends Rg{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=E_),super(t),this.anchor_=null,this.duration_=e.duration!==void 0?e.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(e){let t=1;const i=this.targetPointers[0],r=this.targetPointers[1],s=i.clientX-r.clientX,o=i.clientY-r.clientY,a=Math.sqrt(s*s+o*o);this.lastDistance_!==void 0&&(t=this.lastDistance_/a),this.lastDistance_=a;const c=e.map,h=c.getView();t!=1&&(this.lastScaleDelta_=t),this.anchor_=c.getCoordinateFromPixelInternal(c.getEventPixel(Ix(this.targetPointers))),c.render(),h.adjustResolutionInternal(t,this.anchor_)}handleUpEvent(e){if(this.targetPointers.length<2){const i=e.map.getView(),r=this.lastScaleDelta_>1?1:-1;return i.endInteraction(this.duration_,r),!1}return!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}function $F(n){n=n||{};const e=new Er,t=new SF(-.005,.05,100);return(n.altShiftDragRotate===void 0||n.altShiftDragRotate)&&e.push(new LF),(n.doubleClickZoom===void 0||n.doubleClickZoom)&&e.push(new IF({delta:n.zoomDelta,duration:n.zoomDuration})),(n.dragPan===void 0||n.dragPan)&&e.push(new kF({onFocusOnly:n.onFocusOnly,kinetic:t})),(n.pinchRotate===void 0||n.pinchRotate)&&e.push(new zF),(n.pinchZoom===void 0||n.pinchZoom)&&e.push(new BF({duration:n.zoomDuration})),(n.keyboard===void 0||n.keyboard)&&(e.push(new VF),e.push(new FF({delta:n.zoomDelta,duration:n.zoomDuration}))),(n.mouseWheelZoom===void 0||n.mouseWheelZoom)&&e.push(new UF({onFocusOnly:n.onFocusOnly,duration:n.zoomDuration})),(n.shiftDragZoom===void 0||n.shiftDragZoom)&&e.push(new OF({duration:n.zoomDuration})),e}class WF extends y_{constructor(e){super(),this.map_=e}dispatchRenderEvent(e,t){at()}calculateMatrices2D(e){const t=e.viewState,i=e.coordinateToPixelTransform,r=e.pixelToCoordinateTransform;yo(i,e.size[0]/2,e.size[1]/2,1/t.resolution,-1/t.resolution,-t.rotation,-t.center[0],-t.center[1]),gb(r,i)}forEachFeatureAtCoordinate(e,t,i,r,s,o,a,c){let h;const d=t.viewState;function g(N,D,z,k){return s.call(o,D,N?z:null,k)}const m=d.projection,v=rb(e.slice(),m),y=[[0,0]];if(m.canWrapX()&&r){const N=m.getExtent(),D=ut(N);y.push([-D,0],[D,0])}const T=t.layerStatesArray,w=T.length,A=[],P=[];for(let N=0;N<y.length;N++)for(let D=w-1;D>=0;--D){const z=T[D],k=z.layer;if(k.hasRenderer()&&yx(z,d)&&a.call(c,k)){const R=k.getRenderer(),L=k.getSource();if(R&&L){const F=L.getWrapX()?v:e,j=g.bind(null,z.managed);P[0]=F[0]+y[N][0],P[1]=F[1]+y[N][1],h=R.forEachFeatureAtCoordinate(P,t,i,j,A)}if(h)return h}}if(A.length===0)return;const C=1/A.length;return A.forEach((N,D)=>N.distanceSq+=D*C),A.sort((N,D)=>N.distanceSq-D.distanceSq),A.some(N=>h=N.callback(N.feature,N.layer,N.geometry)),h}hasFeatureAtCoordinate(e,t,i,r,s,o){return this.forEachFeatureAtCoordinate(e,t,i,r,Mf,this,s,o)!==void 0}getMap(){return this.map_}renderFrame(e){at()}scheduleExpireIconCache(e){xr.canExpireCache()&&e.postRenderFunctions.push(KF)}}function KF(n,e){xr.expire()}class qF extends WF{constructor(e){super(e),this.fontChangeListenerKey_=lt(Iu,oh.PROPERTYCHANGE,e.redrawText,e),this.element_=qi?Rb():document.createElement("div");const t=this.element_.style;t.position="absolute",t.width="100%",t.height="100%",t.zIndex="0",this.element_.className=k_+" ol-layers";const i=e.getViewport();i&&i.insertBefore(this.element_,i.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(e,t){const i=this.getMap();if(i.hasListener(e)){const r=new Xb(e,void 0,t);i.dispatchEvent(r)}}disposeInternal(){Ft(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(e){if(!e){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(e),this.dispatchRenderEvent(wr.PRECOMPOSE,e);const t=e.layerStatesArray.sort((h,d)=>h.zIndex-d.zIndex);t.some(h=>h.layer instanceof o4&&h.layer.getDeclutter())&&(e.declutter={});const r=e.viewState;this.children_.length=0;const s=[];let o=null;for(let h=0,d=t.length;h<d;++h){const g=t[h];e.layerIndex=h;const m=g.layer,v=m.getSourceState();if(!yx(g,r)||v!="ready"&&v!="undefined"){m.unrender();continue}const y=m.render(e,o);y&&(y!==o&&(this.children_.push(y),o=y),s.push(g))}this.declutter(e,s),v6(this.element_,this.children_);const c=this.getMap().getTargetElement();if(xa(c)){const h=c.getContext("2d");for(const d of this.children_){const g=d.firstElementChild||d,m=d.style.backgroundColor;if(m&&(!xa(g)||g.width>0)&&(h.fillStyle=m,h.fillRect(0,0,c.width,c.height)),xa(g)&&g.width>0){const v=d.style.opacity||g.style.opacity;h.globalAlpha=v===""?1:Number(v);const y=g.style.transform;if(y)h.setTransform(...pE(y));else{const T=parseFloat(g.style.width)/g.width,w=parseFloat(g.style.height)/g.height;h.setTransform(T,0,0,w,0,0)}h.drawImage(g,0,0)}}h.globalAlpha=1,h.setTransform(1,0,0,1,0,0)}this.dispatchRenderEvent(wr.POSTCOMPOSE,e),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(e)}declutter(e,t){if(e.declutter){for(let i=t.length-1;i>=0;--i){const r=t[i],s=r.layer;s.getDeclutter()&&s.renderDeclutter(e,r)}t.forEach(i=>i.layer.renderDeferred(e))}}}function x4(n){if(n instanceof V_){n.setMapInternal(null);return}n instanceof F_&&n.getLayers().forEach(x4)}function S4(n,e){if(n instanceof V_){n.setMapInternal(e);return}if(n instanceof F_){const t=n.getLayers().getArray();for(let i=0,r=t.length;i<r;++i)S4(t[i],e)}}let HF=class extends Os{constructor(e){super(),e=e||{},this.on,this.once,this.un;const t=XF(e);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=e.maxTilesLoading!==void 0?e.maxTilesLoading:16,this.pixelRatio_=e.pixelRatio!==void 0?e.pixelRatio:_6,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=Hr(),this.pixelToCoordinateTransform_=Hr(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,qi||(this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_)),this.mapBrowserEventHandler_=null,this.moveTolerance_=e.moveTolerance,this.keyboardEventTarget_=t.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,qi||(this.resizeObserver_=new ResizeObserver(()=>this.updateSize())),this.controls=t.controls||(qi?new Er:xF()),this.interactions=t.interactions||(qi?new Er:$F({onFocusOnly:!0})),this.overlays_=t.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new mF(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(Hn.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(Hn.VIEW,this.handleViewChanged_),this.addChangeListener(Hn.SIZE,this.handleSizeChanged_),this.addChangeListener(Hn.TARGET,this.handleTargetChanged_),this.setProperties(t.values);const i=this;e.view&&!(e.view instanceof ws)&&e.view.then(function(r){i.setView(new ws(r))}),this.controls.addEventListener(Ti.ADD,r=>{r.element.setMap(this)}),this.controls.addEventListener(Ti.REMOVE,r=>{r.element.setMap(null)}),this.interactions.addEventListener(Ti.ADD,r=>{r.element.setMap(this)}),this.interactions.addEventListener(Ti.REMOVE,r=>{r.element.setMap(null)}),this.overlays_.addEventListener(Ti.ADD,r=>{this.addOverlayInternal_(r.element)}),this.overlays_.addEventListener(Ti.REMOVE,r=>{const s=r.element.getId();s!==void 0&&delete this.overlayIdIndex_[s.toString()],r.element.setMap(null)}),this.controls.forEach(r=>{r.setMap(this)}),this.interactions.forEach(r=>{r.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(e){this.getControls().push(e)}addInteraction(e){this.getInteractions().push(e)}addLayer(e){this.getLayerGroup().getLayers().push(e)}handleLayerAdd_(e){S4(e.layer,this)}addOverlay(e){this.getOverlays().push(e)}addOverlayInternal_(e){const t=e.getId();t!==void 0&&(this.overlayIdIndex_[t.toString()]=e),e.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_?.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(e,t,i){if(!this.frameState_||!this.renderer_)return;const r=this.getCoordinateFromPixelInternal(e);i=i!==void 0?i:{};const s=i.hitTolerance!==void 0?i.hitTolerance:0,o=i.layerFilter!==void 0?i.layerFilter:Mf,a=i.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(r,this.frameState_,s,a,t,null,o,null)}getFeaturesAtPixel(e,t){const i=[];return this.forEachFeatureAtPixel(e,function(r){i.push(r)},t),i}getAllLayers(){const e=[];function t(i){i.forEach(function(r){r instanceof F_?t(r.getLayers()):e.push(r)})}return t(this.getLayers()),e}hasFeatureAtPixel(e,t){if(!this.frameState_||!this.renderer_)return!1;const i=this.getCoordinateFromPixelInternal(e);t=t!==void 0?t:{};const r=t.layerFilter!==void 0?t.layerFilter:Mf,s=t.hitTolerance!==void 0?t.hitTolerance:0,o=t.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,s,o,r,null)}getEventCoordinate(e){return this.getCoordinateFromPixel(this.getEventPixel(e))}getEventCoordinateInternal(e){return this.getCoordinateFromPixelInternal(this.getEventPixel(e))}getEventPixel(e){const i=this.viewport_.getBoundingClientRect(),r=this.getSize(),s=i.width/r[0],o=i.height/r[1],a="changedTouches"in e?e.changedTouches[0]:e;return[(a.clientX-i.left)/s,(a.clientY-i.top)/o]}getTarget(){return this.get(Hn.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(e){return mE(this.getCoordinateFromPixelInternal(e),this.getView().getProjection())}getCoordinateFromPixelInternal(e){const t=this.frameState_;return t?An(t.pixelToCoordinateTransform,e.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(e){const t=this.overlayIdIndex_[e.toString()];return t!==void 0?t:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(Hn.LAYERGROUP)}setLayers(e){const t=this.getLayerGroup();if(e instanceof Er){t.setLayers(e);return}const i=t.getLayers();i.clear(),i.extend(e)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const e=this.getLayerGroup().getLayerStatesArray();for(let t=0,i=e.length;t<i;++t){const r=e[t];if(!r.visible)continue;const s=r.layer.getRenderer();if(s&&!s.ready)return!0;const o=r.layer.getSource();if(o&&o.loading)return!0}return!1}getPixelFromCoordinate(e){const t=so(e,this.getView().getProjection());return this.getPixelFromCoordinateInternal(t)}getPixelFromCoordinateInternal(e){const t=this.frameState_;return t?An(t.coordinateToPixelTransform,e.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(Hn.SIZE)}getView(){return this.get(Hn.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const e=this.getTargetElement();return e?e.ownerDocument:document}getTilePriority(e,t,i,r){return pF(this.frameState_,e,t,i,r)}handleBrowserEvent(e,t){t=t||e.type;const i=new da(t,this,e);this.handleMapBrowserEvent(i)}handleMapBrowserEvent(e){if(!this.frameState_)return;const t=e.originalEvent,i=t.type;if(i===PE.POINTERDOWN||i===He.WHEEL||i===He.KEYDOWN){const r=this.getOwnerDocument(),s=this.viewport_.getRootNode?this.viewport_.getRootNode():r,o=t.target,a=s instanceof ShadowRoot?s.host===o?s.host.ownerDocument:s:s===r?r.documentElement:s;if(this.overlayContainerStopEvent_.contains(o)||!a.contains(o))return}if(e.frameState=this.frameState_,this.dispatchEvent(e)!==!1){const r=this.getInteractions().getArray().slice();for(let s=r.length-1;s>=0;s--){const o=r[s];if(o.getMap()!==this||!o.getActive()||!this.getTargetElement())continue;if(!o.handleEvent(e)||e.propagationStopped)break}}}handlePostRender(){const e=this.frameState_,t=this.tileQueue_;if(!t.isEmpty()){let r=this.maxTilesLoading_,s=r;if(e){const o=e.viewHints;if(o[Yn.ANIMATING]||o[Yn.INTERACTING]){const a=Date.now()-e.time>8;r=a?0:8,s=a?0:2}}t.getTilesLoading()<r&&(t.reprioritize(),t.loadMoreTiles(r,s))}e&&this.renderer_&&!e.animate&&(this.renderComplete_?(this.hasListener(wr.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(wr.RENDERCOMPLETE,e),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new Pu(fa.LOADEND,this,e)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new Pu(fa.LOADSTART,this,e))));const i=this.postRenderFunctions_;if(e)for(let r=0,s=i.length;r<s;++r)i[r](this,e);i.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let i=0,r=this.targetChangeHandlerKeys_.length;i<r;++i)Ft(this.targetChangeHandlerKeys_[i]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(He.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(He.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_&&!xa(this.targetElement_)){this.resizeObserver_?.unobserve(this.targetElement_);const i=this.targetElement_.getRootNode();i instanceof ShadowRoot&&this.resizeObserver_.unobserve(i.host),this.setSize(void 0)}const e=this.getTarget(),t=typeof e=="string"?document.getElementById(e):e;if(this.targetElement_=t,!t)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{if(xa(t)||t.appendChild(this.viewport_),this.renderer_||(this.renderer_=new qF(this)),!xa(t)){this.mapBrowserEventHandler_=new yF(this,this.moveTolerance_);for(const r in Kt)this.mapBrowserEventHandler_.addEventListener(Kt[r],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(He.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(He.WHEEL,this.boundHandleBrowserEvent_,Ab?{passive:!1}:!1);let i;if(this.keyboardEventTarget_)i=this.keyboardEventTarget_;else{const r=t.getRootNode();i=r instanceof ShadowRoot?r.host:t}if(this.targetChangeHandlerKeys_=[lt(i,He.KEYDOWN,this.handleBrowserEvent,this),lt(i,He.KEYPRESS,this.handleBrowserEvent,this)],t instanceof HTMLElement){const r=t.getRootNode();r instanceof ShadowRoot&&this.resizeObserver_.observe(r.host),this.resizeObserver_?.observe(t)}}this.updateSize()}}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(Ft(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(Ft(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const e=this.getView();e&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=lt(e,oh.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=lt(e,He.CHANGE,this.handleViewPropertyChanged_,this),e.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(Ft),this.layerGroupPropertyListenerKeys_=null);const e=this.getLayerGroup();e&&(this.handleLayerAdd_(new ma("addlayer",e)),this.layerGroupPropertyListenerKeys_=[lt(e,oh.PROPERTYCHANGE,this.render,this),lt(e,He.CHANGE,this.render,this),lt(e,"addlayer",this.handleLayerAdd_,this),lt(e,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){if(!this.frameState_)return;const e=this.frameState_.layerStatesArray;for(let t=0,i=e.length;t<i;++t){const r=e[t].layer;r.hasRenderer()&&r.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(e){return this.getControls().remove(e)}removeInteraction(e){return this.getInteractions().remove(e)}removeLayer(e){return this.getLayerGroup().getLayers().remove(e)}handleLayerRemove_(e){x4(e.layer)}removeOverlay(e){return this.getOverlays().remove(e)}renderFrame_(e){const t=this.getSize(),i=this.getView(),r=this.frameState_;let s=null;if(t!==void 0&&vA(t)&&i&&i.isDef()){const o=i.getHints(this.frameState_?this.frameState_.viewHints:void 0),a=i.getState();if(s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:cE(a.center,a.resolution,a.rotation,t),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:t,tileQueue:this.tileQueue_,time:e,usedTiles:{},viewState:a,viewHints:o,wantedTiles:{},mapId:ct(this),renderTargets:{}},a.nextCenter&&a.nextResolution){const c=isNaN(a.nextRotation)?a.rotation:a.nextRotation;s.nextExtent=cE(a.nextCenter,a.nextResolution,c,t)}}this.frameState_=s,this.renderer_.renderFrame(s),s&&(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),r&&(!this.previousExtent_||!I_(this.previousExtent_)&&!Lf(s.extent,this.previousExtent_))&&(this.dispatchEvent(new Pu(fa.MOVESTART,this,r)),this.previousExtent_=w_(this.previousExtent_)),this.previousExtent_&&!s.viewHints[Yn.ANIMATING]&&!s.viewHints[Yn.INTERACTING]&&!Lf(s.extent,this.previousExtent_)&&(this.dispatchEvent(new Pu(fa.MOVEEND,this,s)),XM(s.extent,this.previousExtent_))),this.dispatchEvent(new Pu(fa.POSTRENDER,this,s)),this.renderComplete_=(this.hasListener(fa.LOADSTART)||this.hasListener(fa.LOADEND)||this.hasListener(wr.RENDERCOMPLETE))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(e){const t=this.getLayerGroup();t&&this.handleLayerRemove_(new ma("removelayer",t)),this.set(Hn.LAYERGROUP,e)}setSize(e){this.set(Hn.SIZE,e)}setTarget(e){this.set(Hn.TARGET,e)}setView(e){if(!e||e instanceof ws){this.set(Hn.VIEW,e);return}this.set(Hn.VIEW,new ws);const t=this;e.then(function(i){t.setView(new ws(i))})}updateSize(){const e=this.getTargetElement();let t;if(e){let r,s;if(xa(e))r=e.width,s=e.height;else{const o=getComputedStyle(e);r=e.offsetWidth-parseFloat(o.borderLeftWidth)-parseFloat(o.paddingLeft)-parseFloat(o.paddingRight)-parseFloat(o.borderRightWidth),s=e.offsetHeight-parseFloat(o.borderTopWidth)-parseFloat(o.paddingTop)-parseFloat(o.paddingBottom)-parseFloat(o.borderBottomWidth)}!isNaN(r)&&!isNaN(s)&&(t=[Math.max(0,r),Math.max(0,s)],!vA(t)&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)&&ob("No map visible because the map container's width or height are 0."))}const i=this.getSize();t&&(!i||!qa(t,i))&&(this.setSize(t),this.updateViewportSize_(t))}updateViewportSize_(e){const t=this.getView();t&&t.setViewportSize(e)}};function XF(n){let e=null;n.keyboardEventTarget!==void 0&&(e=typeof n.keyboardEventTarget=="string"?document.getElementById(n.keyboardEventTarget):n.keyboardEventTarget);const t={},i=n.layers&&typeof n.layers.getLayers=="function"?n.layers:new F_({layers:n.layers});t[Hn.LAYERGROUP]=i,t[Hn.TARGET]=n.target,t[Hn.VIEW]=n.view instanceof ws?n.view:new ws;let r;n.controls!==void 0&&(Array.isArray(n.controls)?r=new Er(n.controls.slice()):(_t(typeof n.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),r=n.controls));let s;n.interactions!==void 0&&(Array.isArray(n.interactions)?s=new Er(n.interactions.slice()):(_t(typeof n.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),s=n.interactions));let o;return n.overlays!==void 0?Array.isArray(n.overlays)?o=new Er(n.overlays.slice()):(_t(typeof n.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),o=n.overlays):o=new Er,{controls:r,interactions:s,keyboardEventTarget:e,overlays:o,values:t}}const YF={},qA=n=>{let e;const t=new Set,i=(d,g)=>{const m=typeof d=="function"?d(e):d;if(!Object.is(m,e)){const v=e;e=g??(typeof m!="object"||m===null)?m:Object.assign({},e,m),t.forEach(y=>y(e,v))}},r=()=>e,c={setState:i,getState:r,getInitialState:()=>h,subscribe:d=>(t.add(d),()=>t.delete(d)),destroy:()=>{(YF?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},h=e=n(i,r,c);return c},ZF=n=>n?qA(n):qA;var E1={exports:{}},w1={},x1={exports:{}},S1={};var HA;function QF(){if(HA)return S1;HA=1;var n=_g();function e(g,m){return g===m&&(g!==0||1/g===1/m)||g!==g&&m!==m}var t=typeof Object.is=="function"?Object.is:e,i=n.useState,r=n.useEffect,s=n.useLayoutEffect,o=n.useDebugValue;function a(g,m){var v=m(),y=i({inst:{value:v,getSnapshot:m}}),T=y[0].inst,w=y[1];return s(function(){T.value=v,T.getSnapshot=m,c(T)&&w({inst:T})},[g,v,m]),r(function(){return c(T)&&w({inst:T}),g(function(){c(T)&&w({inst:T})})},[g]),o(v),v}function c(g){var m=g.getSnapshot;g=g.value;try{var v=m();return!t(g,v)}catch{return!0}}function h(g,m){return m()}var d=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?h:a;return S1.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:d,S1}var XA;function JF(){return XA||(XA=1,x1.exports=QF()),x1.exports}var YA;function e9(){if(YA)return w1;YA=1;var n=_g(),e=JF();function t(h,d){return h===d&&(h!==0||1/h===1/d)||h!==h&&d!==d}var i=typeof Object.is=="function"?Object.is:t,r=e.useSyncExternalStore,s=n.useRef,o=n.useEffect,a=n.useMemo,c=n.useDebugValue;return w1.useSyncExternalStoreWithSelector=function(h,d,g,m,v){var y=s(null);if(y.current===null){var T={hasValue:!1,value:null};y.current=T}else T=y.current;y=a(function(){function A(z){if(!P){if(P=!0,C=z,z=m(z),v!==void 0&&T.hasValue){var k=T.value;if(v(k,z))return N=k}return N=z}if(k=N,i(C,z))return k;var R=m(z);return v!==void 0&&v(k,R)?(C=z,k):(C=z,N=R)}var P=!1,C,N,D=g===void 0?null:g;return[function(){return A(d())},D===null?void 0:function(){return A(D())}]},[d,g,m,v]);var w=r(h,y[0],y[1]);return o(function(){T.hasValue=!0,T.value=w},[w]),c(w),w},w1}var ZA;function t9(){return ZA||(ZA=1,E1.exports=e9()),E1.exports}var n9=t9();const i9=Uw(n9),T4={},{useDebugValue:r9}=c5,{useSyncExternalStoreWithSelector:s9}=i9;let QA=!1;const o9=n=>n;function a9(n,e=o9,t){(T4?"production":void 0)!=="production"&&t&&!QA&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),QA=!0);const i=s9(n.subscribe,n.getState,n.getServerState||n.getInitialState,e,t);return r9(i),i}const l9=n=>{(T4?"production":void 0)!=="production"&&typeof n!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof n=="function"?ZF(n):n,t=(i,r)=>a9(e,i,r);return Object.assign(t,e),t},Ha=n=>l9;var I4=Symbol.for("immer-nothing"),JA=Symbol.for("immer-draftable"),Qi=Symbol.for("immer-state");function $r(n,...e){throw new Error(`[Immer] minified error nr: ${n}. Full error at: https://bit.ly/3cXEKWf`)}var zf=Object.getPrototypeOf;function fh(n){return!!n&&!!n[Qi]}function oc(n){return n?A4(n)||Array.isArray(n)||!!n[JA]||!!n.constructor?.[JA]||Pg(n)||G_(n):!1}var c9=Object.prototype.constructor.toString(),eR=new WeakMap;function A4(n){if(!n||typeof n!="object")return!1;const e=Object.getPrototypeOf(n);if(e===null||e===Object.prototype)return!0;const t=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;if(t===Object)return!0;if(typeof t!="function")return!1;let i=eR.get(t);return i===void 0&&(i=Function.toString.call(t),eR.set(t,i)),i===c9}function R0(n,e,t=!0){j_(n)===0?(t?Reflect.ownKeys(n):Object.keys(n)).forEach(r=>{e(r,n[r],n)}):n.forEach((i,r)=>e(r,i,n))}function j_(n){const e=n[Qi];return e?e.type_:Array.isArray(n)?1:Pg(n)?2:G_(n)?3:0}function ME(n,e){return j_(n)===2?n.has(e):Object.prototype.hasOwnProperty.call(n,e)}function R4(n,e,t){const i=j_(n);i===2?n.set(e,t):i===3?n.add(t):n[e]=t}function u9(n,e){return n===e?n!==0||1/n===1/e:n!==n&&e!==e}function Pg(n){return n instanceof Map}function G_(n){return n instanceof Set}function Cl(n){return n.copy_||n.base_}function bE(n,e){if(Pg(n))return new Map(n);if(G_(n))return new Set(n);if(Array.isArray(n))return Array.prototype.slice.call(n);const t=A4(n);if(e===!0||e==="class_only"&&!t){const i=Object.getOwnPropertyDescriptors(n);delete i[Qi];let r=Reflect.ownKeys(i);for(let s=0;s<r.length;s++){const o=r[s],a=i[o];a.writable===!1&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(i[o]={configurable:!0,writable:!0,enumerable:a.enumerable,value:n[o]})}return Object.create(zf(n),i)}else{const i=zf(n);if(i!==null&&t)return{...n};const r=Object.create(i);return Object.assign(r,n)}}function Ax(n,e=!1){return U_(n)||fh(n)||!oc(n)||(j_(n)>1&&Object.defineProperties(n,{set:vp,add:vp,clear:vp,delete:vp}),Object.freeze(n),e&&Object.values(n).forEach(t=>Ax(t,!0))),n}function h9(){$r(2)}var vp={value:h9};function U_(n){return n===null||typeof n!="object"?!0:Object.isFrozen(n)}var d9={};function ac(n){const e=d9[n];return e||$r(0,n),e}var Bf;function P4(){return Bf}function f9(n,e){return{drafts_:[],parent_:n,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function tR(n,e){e&&(ac("Patches"),n.patches_=[],n.inversePatches_=[],n.patchListener_=e)}function kE(n){LE(n),n.drafts_.forEach(g9),n.drafts_=null}function LE(n){n===Bf&&(Bf=n.parent_)}function nR(n){return Bf=f9(Bf,n)}function g9(n){const e=n[Qi];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function iR(n,e){e.unfinalizedDrafts_=e.drafts_.length;const t=e.drafts_[0];return n!==void 0&&n!==t?(t[Qi].modified_&&(kE(e),$r(4)),oc(n)&&(n=P0(e,n),e.parent_||C0(e,n)),e.patches_&&ac("Patches").generateReplacementPatches_(t[Qi].base_,n,e.patches_,e.inversePatches_)):n=P0(e,t,[]),kE(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),n!==I4?n:void 0}function P0(n,e,t){if(U_(e))return e;const i=n.immer_.shouldUseStrictIteration(),r=e[Qi];if(!r)return R0(e,(s,o)=>rR(n,r,e,s,o,t),i),e;if(r.scope_!==n)return e;if(!r.modified_)return C0(n,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const s=r.copy_;let o=s,a=!1;r.type_===3&&(o=new Set(s),s.clear(),a=!0),R0(o,(c,h)=>rR(n,r,s,c,h,t,a),i),C0(n,s,!1),t&&n.patches_&&ac("Patches").generatePatches_(r,t,n.patches_,n.inversePatches_)}return r.copy_}function rR(n,e,t,i,r,s,o){if(r==null||typeof r!="object"&&!o)return;const a=U_(r);if(!(a&&!o)){if(fh(r)){const c=s&&e&&e.type_!==3&&!ME(e.assigned_,i)?s.concat(i):void 0,h=P0(n,r,c);if(R4(t,i,h),fh(h))n.canAutoFreeze_=!1;else return}else o&&t.add(r);if(oc(r)&&!a){if(!n.immer_.autoFreeze_&&n.unfinalizedDrafts_<1||e&&e.base_&&e.base_[i]===r&&a)return;P0(n,r),(!e||!e.scope_.parent_)&&typeof i!="symbol"&&(Pg(t)?t.has(i):Object.prototype.propertyIsEnumerable.call(t,i))&&C0(n,r)}}}function C0(n,e,t=!1){!n.parent_&&n.immer_.autoFreeze_&&n.canAutoFreeze_&&Ax(e,t)}function m9(n,e){const t=Array.isArray(n),i={type_:t?1:0,scope_:e?e.scope_:P4(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:n,draft_:null,copy_:null,revoke_:null,isManual_:!1};let r=i,s=Rx;t&&(r=[i],s=$f);const{revoke:o,proxy:a}=Proxy.revocable(r,s);return i.draft_=a,i.revoke_=o,a}var Rx={get(n,e){if(e===Qi)return n;const t=Cl(n);if(!ME(t,e))return p9(n,t,e);const i=t[e];return n.finalized_||!oc(i)?i:i===T1(n.base_,e)?(I1(n),n.copy_[e]=DE(i,n)):i},has(n,e){return e in Cl(n)},ownKeys(n){return Reflect.ownKeys(Cl(n))},set(n,e,t){const i=C4(Cl(n),e);if(i?.set)return i.set.call(n.draft_,t),!0;if(!n.modified_){const r=T1(Cl(n),e),s=r?.[Qi];if(s&&s.base_===t)return n.copy_[e]=t,n.assigned_[e]=!1,!0;if(u9(t,r)&&(t!==void 0||ME(n.base_,e)))return!0;I1(n),NE(n)}return n.copy_[e]===t&&(t!==void 0||e in n.copy_)||Number.isNaN(t)&&Number.isNaN(n.copy_[e])||(n.copy_[e]=t,n.assigned_[e]=!0),!0},deleteProperty(n,e){return T1(n.base_,e)!==void 0||e in n.base_?(n.assigned_[e]=!1,I1(n),NE(n)):delete n.assigned_[e],n.copy_&&delete n.copy_[e],!0},getOwnPropertyDescriptor(n,e){const t=Cl(n),i=Reflect.getOwnPropertyDescriptor(t,e);return i&&{writable:!0,configurable:n.type_!==1||e!=="length",enumerable:i.enumerable,value:t[e]}},defineProperty(){$r(11)},getPrototypeOf(n){return zf(n.base_)},setPrototypeOf(){$r(12)}},$f={};R0(Rx,(n,e)=>{$f[n]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});$f.deleteProperty=function(n,e){return $f.set.call(this,n,e,void 0)};$f.set=function(n,e,t){return Rx.set.call(this,n[0],e,t,n[0])};function T1(n,e){const t=n[Qi];return(t?Cl(t):n)[e]}function p9(n,e,t){const i=C4(e,t);return i?"value"in i?i.value:i.get?.call(n.draft_):void 0}function C4(n,e){if(!(e in n))return;let t=zf(n);for(;t;){const i=Object.getOwnPropertyDescriptor(t,e);if(i)return i;t=zf(t)}}function NE(n){n.modified_||(n.modified_=!0,n.parent_&&NE(n.parent_))}function I1(n){n.copy_||(n.copy_=bE(n.base_,n.scope_.immer_.useStrictShallowCopy_))}var _9=class{constructor(n){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(e,t,i)=>{if(typeof e=="function"&&typeof t!="function"){const s=t;t=e;const o=this;return function(c=s,...h){return o.produce(c,d=>t.call(this,d,...h))}}typeof t!="function"&&$r(6),i!==void 0&&typeof i!="function"&&$r(7);let r;if(oc(e)){const s=nR(this),o=DE(e,void 0);let a=!0;try{r=t(o),a=!1}finally{a?kE(s):LE(s)}return tR(s,i),iR(r,s)}else if(!e||typeof e!="object"){if(r=t(e),r===void 0&&(r=e),r===I4&&(r=void 0),this.autoFreeze_&&Ax(r,!0),i){const s=[],o=[];ac("Patches").generateReplacementPatches_(e,r,s,o),i(s,o)}return r}else $r(1,e)},this.produceWithPatches=(e,t)=>{if(typeof e=="function")return(o,...a)=>this.produceWithPatches(o,c=>e(c,...a));let i,r;return[this.produce(e,t,(o,a)=>{i=o,r=a}),i,r]},typeof n?.autoFreeze=="boolean"&&this.setAutoFreeze(n.autoFreeze),typeof n?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(n.useStrictShallowCopy),typeof n?.useStrictIteration=="boolean"&&this.setUseStrictIteration(n.useStrictIteration)}createDraft(n){oc(n)||$r(8),fh(n)&&(n=y9(n));const e=nR(this),t=DE(n,void 0);return t[Qi].isManual_=!0,LE(e),t}finishDraft(n,e){const t=n&&n[Qi];(!t||!t.isManual_)&&$r(9);const{scope_:i}=t;return tR(i,e),iR(void 0,i)}setAutoFreeze(n){this.autoFreeze_=n}setUseStrictShallowCopy(n){this.useStrictShallowCopy_=n}setUseStrictIteration(n){this.useStrictIteration_=n}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(n,e){let t;for(t=e.length-1;t>=0;t--){const r=e[t];if(r.path.length===0&&r.op==="replace"){n=r.value;break}}t>-1&&(e=e.slice(t+1));const i=ac("Patches").applyPatches_;return fh(n)?i(n,e):this.produce(n,r=>i(r,e))}};function DE(n,e){const t=Pg(n)?ac("MapSet").proxyMap_(n,e):G_(n)?ac("MapSet").proxySet_(n,e):m9(n,e);return(e?e.scope_:P4()).drafts_.push(t),t}function y9(n){return fh(n)||$r(10,n),M4(n)}function M4(n){if(!oc(n)||U_(n))return n;const e=n[Qi];let t,i=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,t=bE(n,e.scope_.immer_.useStrictShallowCopy_),i=e.scope_.immer_.shouldUseStrictIteration()}else t=bE(n,!0);return R0(t,(r,s)=>{R4(t,r,M4(s))},i),e&&(e.finalized_=!1),t}var v9=new _9,E9=v9.produce;const w9=n=>(e,t,i)=>(i.setState=(r,s,...o)=>{const a=typeof r=="function"?E9(r):r;return e(a,s,...o)},n(i.setState,t,i)),Sc=w9,Ot=Ha()(Sc((n,e)=>({tracking:!1,navigationMode:"free",position:null,heading:null,smoothHeading:null,accuracy:null,speed:null,headingSource:null,watchId:null,firstFix:!0,config:{smoothingFactor:.2,minRotationSpeed:8,centerOnUser:!0,animationDuration:100},startTracking:()=>{n(t=>{t.tracking=!0})},stopTracking:()=>{n(t=>{const{watchId:i}=e();i!==null&&navigator.geolocation.clearWatch(i),t.tracking=!1,t.speed=null,t.headingSource=null,t.watchId=null})},toggleMode:()=>{n(t=>{t.navigationMode=t.navigationMode==="free"?"drive":"free",console.log(` Navigation mode: ${t.navigationMode}`)})},updatePosition:t=>{n(i=>{i.position={lat:t.coords.latitude,lng:t.coords.longitude},i.accuracy=t.coords.accuracy,i.speed=t.coords.speed;const r=15,s=.5;if(!(t.coords.accuracy!==null&&t.coords.accuracy<r)){i.headingSource=null;return}if(t.coords.heading!==null&&t.coords.speed!==null&&t.coords.speed>s){i.headingSource="gps";const a=t.coords.heading;e().updateHeading(a,"gps")}else i.headingSource="compass"})},updateHeading:(t,i="compass")=>{n(r=>{const{smoothHeading:s,config:o}=e();if(s===null){r.smoothHeading=t,r.heading=t;return}let a=t-s;a>180&&(a-=360),a<-180&&(a+=360);const c=i==="compass"?8:o.minRotationSpeed;if(Math.abs(a)<c)return;const h=s+a*o.smoothingFactor;r.smoothHeading=(h+360)%360,r.heading=t})},setWatchId:t=>{n(i=>{i.watchId=t})},resetFirstFix:()=>{n(t=>{t.firstFix=!1})}}))),b4={"AHN 0.5m":{name:"AHN 0.5m",factory:async()=>{const{createAHNLayerOL:n}=await Ue(async()=>{const{createAHNLayerOL:e}=await import("./pdokWMSLayers-BMwxkusj.js");return{createAHNLayerOL:e}},[]);return n()},immediateLoad:!0},Geomorfologie:{name:"Geomorfologie",factory:async()=>{const{createGeomorfologieLayerOL:n}=await Ue(async()=>{const{createGeomorfologieLayerOL:e}=await import("./pdokWMSLayers-BMwxkusj.js");return{createGeomorfologieLayerOL:e}},[]);return n()},immediateLoad:!0},Bodemkaart:{name:"Bodemkaart",factory:async()=>{const{createBodemkaartLayerOL:n}=await Ue(async()=>{const{createBodemkaartLayerOL:e}=await import("./pdokWMSLayers-BMwxkusj.js");return{createBodemkaartLayerOL:e}},[]);return n()},immediateLoad:!0},IKAW:{name:"IKAW",factory:async()=>{const{createIKAWLayerOL:n}=await Ue(async()=>{const{createIKAWLayerOL:e}=await import("./pdokWMSLayers-BMwxkusj.js");return{createIKAWLayerOL:e}},[]);return n()},immediateLoad:!0},"FAMKE Steentijd":{name:"FAMKE Steentijd",factory:async()=>{const{createFAMKESteentijdLayerOL:n}=await Ue(async()=>{const{createFAMKESteentijdLayerOL:e}=await import("./pdokWMSLayers-BMwxkusj.js");return{createFAMKESteentijdLayerOL:e}},[]);return n()},immediateLoad:!0},"Archeo Landschappen":{name:"Archeo Landschappen",factory:async()=>{const{createArcheoLandschappenLayerOL:n}=await Ue(async()=>{const{createArcheoLandschappenLayerOL:e}=await import("./pdokWMSLayers-BMwxkusj.js");return{createArcheoLandschappenLayerOL:e}},[]);return n()},immediateLoad:!0},Rijksmonumenten:{name:"Rijksmonumenten",factory:async()=>{const{createRijksmonumentenLayerOL:n}=await Ue(async()=>{const{createRijksmonumentenLayerOL:e}=await import("./pdokWMSLayers-BMwxkusj.js");return{createRijksmonumentenLayerOL:e}},[]);return n()},immediateLoad:!0},"Archeo Onderzoeken":{name:"Archeo Onderzoeken",factory:async()=>{const{createArcheoOnderzoekenLayerOL:n}=await Ue(async()=>{const{createArcheoOnderzoekenLayerOL:e}=await import("./pdokWMSLayers-BMwxkusj.js");return{createArcheoOnderzoekenLayerOL:e}},[]);return n()},immediateLoad:!0},Werelderfgoed:{name:"Werelderfgoed",factory:async()=>{const{createWerelderfgoedLayerOL:n}=await Ue(async()=>{const{createWerelderfgoedLayerOL:e}=await import("./pdokWMSLayers-BMwxkusj.js");return{createWerelderfgoedLayerOL:e}},[]);return n()},immediateLoad:!0},Terpen:{name:"Terpen",factory:async()=>{const{createTerpenLayerOL:n}=await Ue(async()=>{const{createTerpenLayerOL:e}=await import("./terpenOL-BsubvB4x.js");return{createTerpenLayerOL:e}},[]);return n()},immediateLoad:!0},Verdedigingslinies:{name:"Verdedigingslinies",factory:async()=>{const{createLiniesLayerOL:n}=await Ue(async()=>{const{createLiniesLayerOL:e}=await import("./verdedigingswerkenOL-BI9xhkEA.js");return{createLiniesLayerOL:e}},[]);return n()},immediateLoad:!0},Inundatiegebieden:{name:"Inundatiegebieden",factory:async()=>{const{createInundatiesLayerOL:n}=await Ue(async()=>{const{createInundatiesLayerOL:e}=await import("./verdedigingswerkenOL-BI9xhkEA.js");return{createInundatiesLayerOL:e}},[]);return n()},immediateLoad:!0},"Militaire Objecten":{name:"Militaire Objecten",factory:async()=>{const{createMilitaireObjectenLayerOL:n}=await Ue(async()=>{const{createMilitaireObjectenLayerOL:e}=await import("./verdedigingswerkenOL-BI9xhkEA.js");return{createMilitaireObjectenLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 800 n.Chr.":{name:"Paleokaart 800 n.Chr.",factory:async()=>{const{createPaleo800ncLayerOL:n}=await Ue(async()=>{const{createPaleo800ncLayerOL:e}=await import("./paleokaartOL-CfYbswyB.js");return{createPaleo800ncLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 100 n.Chr.":{name:"Paleokaart 100 n.Chr.",factory:async()=>{const{createPaleo100ncLayerOL:n}=await Ue(async()=>{const{createPaleo100ncLayerOL:e}=await import("./paleokaartOL-CfYbswyB.js");return{createPaleo100ncLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 500 v.Chr.":{name:"Paleokaart 500 v.Chr.",factory:async()=>{const{createPaleo500vcLayerOL:n}=await Ue(async()=>{const{createPaleo500vcLayerOL:e}=await import("./paleokaartOL-CfYbswyB.js");return{createPaleo500vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 1500 v.Chr.":{name:"Paleokaart 1500 v.Chr.",factory:async()=>{const{createPaleo1500vcLayerOL:n}=await Ue(async()=>{const{createPaleo1500vcLayerOL:e}=await import("./paleokaartOL-CfYbswyB.js");return{createPaleo1500vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 2750 v.Chr.":{name:"Paleokaart 2750 v.Chr.",factory:async()=>{const{createPaleo2750vcLayerOL:n}=await Ue(async()=>{const{createPaleo2750vcLayerOL:e}=await import("./paleokaartOL-CfYbswyB.js");return{createPaleo2750vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 5500 v.Chr.":{name:"Paleokaart 5500 v.Chr.",factory:async()=>{const{createPaleo5500vcLayerOL:n}=await Ue(async()=>{const{createPaleo5500vcLayerOL:e}=await import("./paleokaartOL-CfYbswyB.js");return{createPaleo5500vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 9000 v.Chr.":{name:"Paleokaart 9000 v.Chr.",factory:async()=>{const{createPaleo9000vcLayerOL:n}=await Ue(async()=>{const{createPaleo9000vcLayerOL:e}=await import("./paleokaartOL-CfYbswyB.js");return{createPaleo9000vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Religieus Erfgoed":{name:"Religieus Erfgoed",factory:async()=>{const{createReligieusErfgoedLayerOL:n}=await Ue(async()=>{const{createReligieusErfgoedLayerOL:e}=await import("./religieusErfgoedOL-CeWr1hhb.js");return{createReligieusErfgoedLayerOL:e}},[]);return n()},immediateLoad:!0},"AHN4 Hillshade NL":{name:"AHN4 Hillshade NL",factory:async()=>{const{createAHN4HillshadeLayerOL:n}=await Ue(async()=>{const{createAHN4HillshadeLayerOL:e}=await import("./hillshadeLayers-o3Uua_C6.js");return{createAHN4HillshadeLayerOL:e}},[]);return n()},immediateLoad:!0},"AHN4 Multi-Hillshade NL":{name:"AHN4 Multi-Hillshade NL",factory:async()=>{const{createAHN4MultiHillshadeLayerOL:n}=await Ue(async()=>{const{createAHN4MultiHillshadeLayerOL:e}=await import("./hillshadeLayers-o3Uua_C6.js");return{createAHN4MultiHillshadeLayerOL:e}},[]);return n()},immediateLoad:!0},"AHN4 Helling NL":{name:"AHN4 Helling NL",factory:async()=>{const{createAHN4SlopeLayerOL:n}=await Ue(async()=>{const{createAHN4SlopeLayerOL:e}=await import("./hillshadeLayers-o3Uua_C6.js");return{createAHN4SlopeLayerOL:e}},[]);return n()},immediateLoad:!0},"World Hillshade":{name:"World Hillshade",factory:async()=>{const{createWorldHillshadeLayerOL:n}=await Ue(async()=>{const{createWorldHillshadeLayerOL:e}=await import("./hillshadeLayers-o3Uua_C6.js");return{createWorldHillshadeLayerOL:e}},[]);return n()},immediateLoad:!0},"AMK Monumenten":{name:"AMK Monumenten",factory:async()=>{const{createAMKLayerOL:n}=await Ue(async()=>{const{createAMKLayerOL:e}=await import("./amkOL-BMpsLH3A.js");return{createAMKLayerOL:e}},__vite__mapDeps([0,1,2]));return n()},immediateLoad:!1},"Romeinse wegen":{name:"Romeinse wegen",factory:async()=>{const{createRomeinseWegenLayerOL:n}=await Ue(async()=>{const{createRomeinseWegenLayerOL:e}=await import("./romeinsOL-CTmsrHLa.js");return{createRomeinseWegenLayerOL:e}},__vite__mapDeps([3,1,2]));return n()},immediateLoad:!1},Kastelen:{name:"Kastelen",factory:async()=>{const{createKastelenLayerOL:n}=await Ue(async()=>{const{createKastelenLayerOL:e}=await import("./kastelenOL-CQB3Fr53.js");return{createKastelenLayerOL:e}},__vite__mapDeps([4,2,5]));return n()},immediateLoad:!1},Veengebieden:{name:"Veengebieden",factory:async()=>{const{createVeengebiedenLayerOL:n}=await Ue(async()=>{const{createVeengebiedenLayerOL:e}=await import("./veengebiedenOL-CVQFE82Q.js");return{createVeengebiedenLayerOL:e}},__vite__mapDeps([6,2]));return n()},immediateLoad:!1},Hunebedden:{name:"Hunebedden",factory:async()=>{const{createHunebeddenLayerOL:n}=await Ue(async()=>{const{createHunebeddenLayerOL:e}=await import("./hunebeddenOL-D6bv9-v6.js");return{createHunebeddenLayerOL:e}},__vite__mapDeps([7,2,5]));return n()},immediateLoad:!1},"UIKAV Punten":{name:"UIKAV Punten",factory:async()=>{const{createUIKAVArcheoPuntenLayerOL:n}=await Ue(async()=>{const{createUIKAVArcheoPuntenLayerOL:e}=await import("./uikavArcheoPuntenOL-CmCV2opM.js");return{createUIKAVArcheoPuntenLayerOL:e}},__vite__mapDeps([8,2,9,1,5]));return n()},immediateLoad:!1},"UIKAV Vlakken":{name:"UIKAV Vlakken",factory:async()=>{const{createUIKAVVlakkenLayerOL:n}=await Ue(async()=>{const{createUIKAVVlakkenLayerOL:e}=await import("./uikavVlakkenOL-BSyfkZlc.js");return{createUIKAVVlakkenLayerOL:e}},__vite__mapDeps([10,2,9,1]));return n()},immediateLoad:!1},"UIKAV Buffer":{name:"UIKAV Buffer",factory:async()=>{const{createUIKAVBufferlaagLayerOL:n}=await Ue(async()=>{const{createUIKAVBufferlaagLayerOL:e}=await import("./uikavBufferlaagOL-C-FYcmEu.js");return{createUIKAVBufferlaagLayerOL:e}},__vite__mapDeps([11,2,9,1]));return n()},immediateLoad:!1},"UIKAV Expert":{name:"UIKAV Expert",factory:async()=>{const{createUIKAVExpertLayerOL:n}=await Ue(async()=>{const{createUIKAVExpertLayerOL:e}=await import("./uikavExpertOL-VLL-T6YU.js");return{createUIKAVExpertLayerOL:e}},__vite__mapDeps([12,2,9,1]));return n()},immediateLoad:!1},"UIKAV Indeling":{name:"UIKAV Indeling",factory:async()=>{const{createUIKAVUiterwaardenLayerOL:n}=await Ue(async()=>{const{createUIKAVUiterwaardenLayerOL:e}=await import("./uikavUiterwaardenOL-CX7qTYNk.js");return{createUIKAVUiterwaardenLayerOL:e}},__vite__mapDeps([13,2,9,1]));return n()},immediateLoad:!1},Speeltuinen:{name:"Speeltuinen",factory:async()=>{const{createSpeeltuinenLayerOL:n}=await Ue(async()=>{const{createSpeeltuinenLayerOL:e}=await import("./speeltuinenOL-BD7mZ7Vh.js");return{createSpeeltuinenLayerOL:e}},__vite__mapDeps([14,2,9,1,5]));return n()},immediateLoad:!1},Musea:{name:"Musea",factory:async()=>{const{createMuseaLayerOL:n}=await Ue(async()=>{const{createMuseaLayerOL:e}=await import("./museaOL-BKUP8IB2.js");return{createMuseaLayerOL:e}},__vite__mapDeps([15,2,9,1,5]));return n()},immediateLoad:!1},Strandjes:{name:"Strandjes",factory:async()=>{const{createStrandjesLayerOL:n}=await Ue(async()=>{const{createStrandjesLayerOL:e}=await import("./strandjesOL-C_1ROisp.js");return{createStrandjesLayerOL:e}},__vite__mapDeps([16,2,9,1]));return n()},immediateLoad:!1},Parken:{name:"Parken",factory:async()=>{const{createParkenLayerOL:n}=await Ue(async()=>{const{createParkenLayerOL:e}=await import("./parkenOL-Ba-pOzjm.js");return{createParkenLayerOL:e}},__vite__mapDeps([17,2,9,1]));return n()},immediateLoad:!1},"Fossielen Nederland":{name:"Fossielen Nederland",factory:async()=>{const{createFossielenLayerOL:n}=await Ue(async()=>{const{createFossielenLayerOL:e}=await import("./fossielenOL-DWvtWnpZ.js");return{createFossielenLayerOL:e}},__vite__mapDeps([18,19,5]));return n()},immediateLoad:!1},"Fossielen Belgi":{name:"Fossielen Belgi",factory:async()=>{const{createFossielenBelgieLayerOL:n}=await Ue(async()=>{const{createFossielenBelgieLayerOL:e}=await import("./fossielenBelgieOL-C3f5zo27.js");return{createFossielenBelgieLayerOL:e}},__vite__mapDeps([20,19,5]));return n()},immediateLoad:!1},"Fossielen Duitsland":{name:"Fossielen Duitsland",factory:async()=>{const{createFossielenDuitslandLayerOL:n}=await Ue(async()=>{const{createFossielenDuitslandLayerOL:e}=await import("./fossielenDuitslandOL-DCwf-Zht.js");return{createFossielenDuitslandLayerOL:e}},__vite__mapDeps([21,19,5]));return n()},immediateLoad:!1},"Fossielen Frankrijk":{name:"Fossielen Frankrijk",factory:async()=>{const{createFossielenFrankrijkLayerOL:n}=await Ue(async()=>{const{createFossielenFrankrijkLayerOL:e}=await import("./fossielenFrankrijkOL-CZey33tx.js");return{createFossielenFrankrijkLayerOL:e}},__vite__mapDeps([22,19,5]));return n()},immediateLoad:!1},"WWII Bunkers":{name:"WWII Bunkers",factory:async()=>{const{createBunkersLayerOL:n}=await Ue(async()=>{const{createBunkersLayerOL:e}=await import("./bunkersOL-Cz_O9pbj.js");return{createBunkersLayerOL:e}},__vite__mapDeps([23,2,5]));return n()},immediateLoad:!1},Grafheuvels:{name:"Grafheuvels",factory:async()=>{const{createGrafheuvelsLayerOL:n}=await Ue(async()=>{const{createGrafheuvelsLayerOL:e}=await import("./grafheuvelsOL-lw90V7xG.js");return{createGrafheuvelsLayerOL:e}},__vite__mapDeps([24,2,5]));return n()},immediateLoad:!1},Slagvelden:{name:"Slagvelden",factory:async()=>{const{createSlagveldenLayerOL:n}=await Ue(async()=>{const{createSlagveldenLayerOL:e}=await import("./slagveldenOL-DPkqb4BD.js");return{createSlagveldenLayerOL:e}},__vite__mapDeps([25,2]));return n()},immediateLoad:!1},"Militaire Vliegvelden":{name:"Militaire Vliegvelden",factory:async()=>{const{createVliegveldenLayerOL:n}=await Ue(async()=>{const{createVliegveldenLayerOL:e}=await import("./vliegveldenOL-DLp3ddSN.js");return{createVliegveldenLayerOL:e}},__vite__mapDeps([26,2]));return n()},immediateLoad:!1}};function x9(){return Object.values(b4).filter(n=>n.immediateLoad)}const Li=Ha()(Sc((n,e)=>({map:null,rotation:0,rotationEnabled:!0,setMap:t=>{n(i=>{i.map=t})},setRotation:t=>{n(i=>{if(i.rotation=t,i.map&&i.rotationEnabled){const r=t*Math.PI/180;i.map.getView().setRotation(r)}})},enableRotation:()=>{n(t=>{t.rotationEnabled=!0})},disableRotation:()=>{n(t=>{t.rotationEnabled=!1,t.rotation=0,t.map&&t.map.getView().animate({rotation:0,duration:500})})}}))),Ss=Ha()(Sc((n,e)=>({visible:{"CartoDB (licht)":!0,"CartoDB (donker)":!1,OpenStreetMap:!1,OpenTopoMap:!1,Luchtfoto:!1,"Labels Overlay":!1,"TMK 1850":!1,"Bonnebladen 1900":!1,Hunebedden:!1,"FAMKE Steentijd":!1,Grafheuvels:!1,Terpen:!1,"AMK Monumenten":!1,"Romeinse wegen":!1,Kastelen:!1,IKAW:!1,"Archeo Landschappen":!1,Rijksmonumenten:!1,Werelderfgoed:!1,"WWII Bunkers":!1,Slagvelden:!1,"Militaire Vliegvelden":!1,Verdedigingslinies:!1,Inundatiegebieden:!1,"Militaire Objecten":!1,"Paleokaart 800 n.Chr.":!1,"Paleokaart 100 n.Chr.":!1,"Paleokaart 500 v.Chr.":!1,"Paleokaart 1500 v.Chr.":!1,"Paleokaart 2750 v.Chr.":!1,"Paleokaart 5500 v.Chr.":!1,"Paleokaart 9000 v.Chr.":!1,"Religieus Erfgoed":!1,"UIKAV Punten":!1,"UIKAV Vlakken":!1,"UIKAV Buffer":!1,"UIKAV Expert":!1,"UIKAV Indeling":!1,"AHN4 Hillshade NL":!1,"AHN4 Multi-Hillshade NL":!1,"AHN4 Helling NL":!1,"AHN 0.5m":!1,"World Hillshade":!1,Veengebieden:!1,Geomorfologie:!1,Bodemkaart:!1,"Fossielen Nederland":!1,"Fossielen Belgi":!1,"Fossielen Duitsland":!1,"Fossielen Frankrijk":!1,Parken:!1,Speeltuinen:!1,Musea:!1,Strandjes:!1},opacity:{"AHN 0.5m":.7,Geomorfologie:.5,Bodemkaart:.6,IKAW:.5,"Archeo Landschappen":.5,"AHN4 Hillshade NL":.7,"AHN4 Multi-Hillshade NL":.7,"AHN4 Helling NL":.6,"World Hillshade":.7,Terpen:.7,Verdedigingslinies:.7,Inundatiegebieden:.5,"Militaire Objecten":.8,"Paleokaart 800 n.Chr.":.7,"Paleokaart 100 n.Chr.":.7,"Paleokaart 500 v.Chr.":.7,"Paleokaart 1500 v.Chr.":.7,"Paleokaart 2750 v.Chr.":.7,"Paleokaart 5500 v.Chr.":.7,"Paleokaart 9000 v.Chr.":.7,"Religieus Erfgoed":.8},loadingState:{},layers:{},toggleLayer:t=>{const i=e(),r=!i.visible[t];n(s=>{s.visible[t]=r}),r&&!i.layers[t]?e().loadLayer(t):i.layers[t]&&i.layers[t].setVisible(r)},setLayerVisibility:(t,i)=>{const r=e();n(s=>{s.visible[t]=i;const o=s.layers[t];o&&o.setVisible(i)}),i&&!r.layers[t]&&e().loadLayer(t)},setLayerOpacity:(t,i)=>{n(r=>{r.opacity[t]=i;const s=r.layers[t];s&&s.setOpacity(i)})},registerLayer:(t,i)=>{n(r=>{r.layers[t]=i,r.loadingState[t]="loaded",r.visible[t]!==void 0&&i.setVisible(r.visible[t]),r.opacity[t]!==void 0&&i.setOpacity(r.opacity[t])})},unregisterLayer:t=>{n(i=>{delete i.layers[t],delete i.loadingState[t]})},loadLayer:async t=>{const i=e();if(i.loadingState[t]==="loading"||i.layers[t])return;const r=b4[t];if(!r){console.warn(` Layer "${t}" not found in registry`);return}const s=Li.getState().map;if(!s){console.warn(` Cannot load layer "${t}": map not initialized`);return}n(o=>{o.loadingState[t]="loading"}),console.log(` Loading layer: ${t}...`);try{const o=await r.factory();if(!o)throw new Error("Factory returned null");const a=e();o.setVisible(a.visible[t]??!1),a.opacity[t]!==void 0&&o.setOpacity(a.opacity[t]),s.addLayer(o),n(c=>{c.layers[t]=o,c.loadingState[t]="loaded"}),console.log(` Layer loaded: ${t}`)}catch(o){console.error(` Failed to load layer "${t}":`,o),n(a=>{a.loadingState[t]="error"})}}}))),Wf=Ha()(Sc((n,e)=>({layerControlOpen:!1,legendOpen:!1,backgroundsPanelOpen:!1,themesPanelOpen:!1,settingsPanelOpen:!1,collapsedCategories:new Set,toggleLayerControl:()=>{n(t=>{t.layerControlOpen=!t.layerControlOpen})},toggleLegend:()=>{n(t=>{t.legendOpen=!t.legendOpen})},toggleBackgroundsPanel:()=>{n(t=>{t.backgroundsPanelOpen=!t.backgroundsPanelOpen})},toggleThemesPanel:()=>{n(t=>{t.themesPanelOpen=!t.themesPanelOpen})},toggleSettingsPanel:()=>{n(t=>{t.settingsPanelOpen=!t.settingsPanelOpen})},toggleCategory:t=>{n(i=>{i.collapsedCategories.has(t)?i.collapsedCategories.delete(t):i.collapsedCategories.add(t)})},setLayerControlOpen:t=>{n(i=>{i.layerControlOpen=t})},setLegendOpen:t=>{n(i=>{i.legendOpen=t})}})));Ha()(Sc(n=>({user:null,loading:!0,error:null,setUser:e=>{n(t=>{t.user=e,t.loading=!1})},setLoading:e=>{n(t=>{t.loading=e})},setError:e=>{n(t=>{t.error=e})}})));const S9=()=>{};var sR={};const k4=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},T9=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const r=n[t++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=n[t++];e[i++]=String.fromCharCode((r&31)<<6|s&63)}else if(r>239&&r<365){const s=n[t++],o=n[t++],a=n[t++],c=((r&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[i++]=String.fromCharCode(55296+(c>>10)),e[i++]=String.fromCharCode(56320+(c&1023))}else{const s=n[t++],o=n[t++];e[i++]=String.fromCharCode((r&15)<<12|(s&63)<<6|o&63)}}return e.join("")},L4={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<n.length;r+=3){const s=n[r],o=r+1<n.length,a=o?n[r+1]:0,c=r+2<n.length,h=c?n[r+2]:0,d=s>>2,g=(s&3)<<4|a>>4;let m=(a&15)<<2|h>>6,v=h&63;c||(v=64,o||(m=64)),i.push(t[d],t[g],t[m],t[v])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(k4(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):T9(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<n.length;){const s=t[n.charAt(r++)],a=r<n.length?t[n.charAt(r)]:0;++r;const h=r<n.length?t[n.charAt(r)]:64;++r;const g=r<n.length?t[n.charAt(r)]:64;if(++r,s==null||a==null||h==null||g==null)throw new I9;const m=s<<2|a>>4;if(i.push(m),h!==64){const v=a<<4&240|h>>2;if(i.push(v),g!==64){const y=h<<6&192|g;i.push(y)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class I9 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const A9=function(n){const e=k4(n);return L4.encodeByteArray(e,!0)},M0=function(n){return A9(n).replace(/\./g,"")},N4=function(n){try{return L4.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function D4(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const R9=()=>D4().__FIREBASE_DEFAULTS__,P9=()=>{if(typeof process>"u"||typeof sR>"u")return;const n=sR.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},C9=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&N4(n[1]);return e&&JSON.parse(e)},z_=()=>{try{return S9()||R9()||P9()||C9()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},O4=n=>z_()?.emulatorHosts?.[n],V4=n=>{const e=O4(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},F4=()=>z_()?.config,j4=n=>z_()?.[`_${n}`];class M9{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}function Tc(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Px(n){return(await fetch(n,{credentials:"include"})).ok}function G4(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",r=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...n};return[M0(JSON.stringify(t)),M0(JSON.stringify(o)),""].join(".")}const hf={};function b9(){const n={prod:[],emulator:[]};for(const e of Object.keys(hf))hf[e]?n.emulator.push(e):n.prod.push(e);return n}function k9(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let oR=!1;function Cx(n,e){if(typeof window>"u"||typeof document>"u"||!Tc(window.location.host)||hf[n]===e||hf[n]||oR)return;hf[n]=e;function t(m){return`__firebase__banner__${m}`}const i="__firebase__banner",s=b9().prod.length>0;function o(){const m=document.getElementById(i);m&&m.remove()}function a(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function c(m,v){m.setAttribute("width","24"),m.setAttribute("id",v),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function h(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{oR=!0,o()},m}function d(m,v){m.setAttribute("id",v),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function g(){const m=k9(i),v=t("text"),y=document.getElementById(v)||document.createElement("span"),T=t("learnmore"),w=document.getElementById(T)||document.createElement("a"),A=t("preprendIcon"),P=document.getElementById(A)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const C=m.element;a(C),d(w,T);const N=h();c(P,A),C.append(P,y,w,N),document.body.appendChild(C)}s?(y.innerText="Preview backend disconnected.",P.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(P.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,y.innerText="Preview backend running in this workspace."),y.setAttribute("id",v)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",g):g()}function pn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function L9(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(pn())}function U4(){const n=z_()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function N9(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function D9(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function O9(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function V9(){const n=pn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function z4(){return!U4()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function B4(){return!U4()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function $4(){try{return typeof indexedDB=="object"}catch{return!1}}function F9(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{e(r.error?.message||"")}}catch(t){e(t)}})}const j9="FirebaseError";class Vs extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=j9,Object.setPrototypeOf(this,Vs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Cg.prototype.create)}}class Cg{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},r=`${this.service}/${e}`,s=this.errors[e],o=s?G9(s,i):"Error",a=`${this.serviceName}: ${o} (${r}).`;return new Vs(r,a,i)}}function G9(n,e){return n.replace(U9,(t,i)=>{const r=e[i];return r!=null?String(r):`<${i}?>`})}const U9=/\{\$([^}]+)}/g;function z9(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function lc(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const r of t){if(!i.includes(r))return!1;const s=n[r],o=e[r];if(aR(s)&&aR(o)){if(!lc(s,o))return!1}else if(s!==o)return!1}for(const r of i)if(!t.includes(r))return!1;return!0}function aR(n){return n!==null&&typeof n=="object"}function Mg(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function B9(n,e){const t=new $9(n,e);return t.subscribe.bind(t)}class $9{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let r;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");W9(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:i},r.next===void 0&&(r.next=A1),r.error===void 0&&(r.error=A1),r.complete===void 0&&(r.complete=A1);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function W9(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function A1(){}function ii(n){return n&&n._delegate?n._delegate:n}class Va{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Ml="[DEFAULT]";class K9{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new M9;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(r){if(i)return null;throw r}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(H9(e))try{this.getOrInitializeService({instanceIdentifier:Ml})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:r});i.resolve(s)}catch{}}}}clearInstance(e=Ml){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ml){return this.instances.has(e)}getOptions(e=Ml){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);i===a&&o.resolve(r)}return r}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(i)??new Set;r.add(e),this.onInitCallbacks.set(i,r);const s=this.instances.get(i);return s&&e(s,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const r of i)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:q9(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Ml){return this.component?this.component.multipleInstances?e:Ml:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function q9(n){return n===Ml?void 0:n}function H9(n){return n.instantiationMode==="EAGER"}class X9{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new K9(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var et;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(et||(et={}));const Y9={debug:et.DEBUG,verbose:et.VERBOSE,info:et.INFO,warn:et.WARN,error:et.ERROR,silent:et.SILENT},Z9=et.INFO,Q9={[et.DEBUG]:"log",[et.VERBOSE]:"log",[et.INFO]:"info",[et.WARN]:"warn",[et.ERROR]:"error"},J9=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),r=Q9[e];if(r)console[r](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Mx{constructor(e){this.name=e,this._logLevel=Z9,this._logHandler=J9,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in et))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Y9[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,et.DEBUG,...e),this._logHandler(this,et.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,et.VERBOSE,...e),this._logHandler(this,et.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,et.INFO,...e),this._logHandler(this,et.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,et.WARN,...e),this._logHandler(this,et.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,et.ERROR,...e),this._logHandler(this,et.ERROR,...e)}}const e7=(n,e)=>e.some(t=>n instanceof t);let lR,cR;function t7(){return lR||(lR=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function n7(){return cR||(cR=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const W4=new WeakMap,OE=new WeakMap,K4=new WeakMap,R1=new WeakMap,bx=new WeakMap;function i7(n){const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(Ca(n.result)),r()},o=()=>{i(n.error),r()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&W4.set(t,n)}).catch(()=>{}),bx.set(e,n),e}function r7(n){if(OE.has(n))return;const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),r()},o=()=>{i(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});OE.set(n,e)}let VE={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return OE.get(n);if(e==="objectStoreNames")return n.objectStoreNames||K4.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Ca(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function s7(n){VE=n(VE)}function o7(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(P1(this),e,...t);return K4.set(i,e.sort?e.sort():[e]),Ca(i)}:n7().includes(n)?function(...e){return n.apply(P1(this),e),Ca(W4.get(this))}:function(...e){return Ca(n.apply(P1(this),e))}}function a7(n){return typeof n=="function"?o7(n):(n instanceof IDBTransaction&&r7(n),e7(n,t7())?new Proxy(n,VE):n)}function Ca(n){if(n instanceof IDBRequest)return i7(n);if(R1.has(n))return R1.get(n);const e=a7(n);return e!==n&&(R1.set(n,e),bx.set(e,n)),e}const P1=n=>bx.get(n);function l7(n,e,{blocked:t,upgrade:i,blocking:r,terminated:s}={}){const o=indexedDB.open(n,e),a=Ca(o);return i&&o.addEventListener("upgradeneeded",c=>{i(Ca(o.result),c.oldVersion,c.newVersion,Ca(o.transaction),c)}),t&&o.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),a.then(c=>{s&&c.addEventListener("close",()=>s()),r&&c.addEventListener("versionchange",h=>r(h.oldVersion,h.newVersion,h))}).catch(()=>{}),a}const c7=["get","getKey","getAll","getAllKeys","count"],u7=["put","add","delete","clear"],C1=new Map;function uR(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(C1.get(e))return C1.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,r=u7.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(r||c7.includes(t)))return;const s=async function(o,...a){const c=this.transaction(o,r?"readwrite":"readonly");let h=c.store;return i&&(h=h.index(a.shift())),(await Promise.all([h[t](...a),r&&c.done]))[0]};return C1.set(e,s),s}s7(n=>({...n,get:(e,t,i)=>uR(e,t)||n.get(e,t,i),has:(e,t)=>!!uR(e,t)||n.has(e,t)}));class h7{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(d7(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function d7(n){return n.getComponent()?.type==="VERSION"}const FE="@firebase/app",hR="0.14.6";const vo=new Mx("@firebase/app"),f7="@firebase/app-compat",g7="@firebase/analytics-compat",m7="@firebase/analytics",p7="@firebase/app-check-compat",_7="@firebase/app-check",y7="@firebase/auth",v7="@firebase/auth-compat",E7="@firebase/database",w7="@firebase/data-connect",x7="@firebase/database-compat",S7="@firebase/functions",T7="@firebase/functions-compat",I7="@firebase/installations",A7="@firebase/installations-compat",R7="@firebase/messaging",P7="@firebase/messaging-compat",C7="@firebase/performance",M7="@firebase/performance-compat",b7="@firebase/remote-config",k7="@firebase/remote-config-compat",L7="@firebase/storage",N7="@firebase/storage-compat",D7="@firebase/firestore",O7="@firebase/ai",V7="@firebase/firestore-compat",F7="firebase",j7="12.6.0";const jE="[DEFAULT]",G7={[FE]:"fire-core",[f7]:"fire-core-compat",[m7]:"fire-analytics",[g7]:"fire-analytics-compat",[_7]:"fire-app-check",[p7]:"fire-app-check-compat",[y7]:"fire-auth",[v7]:"fire-auth-compat",[E7]:"fire-rtdb",[w7]:"fire-data-connect",[x7]:"fire-rtdb-compat",[S7]:"fire-fn",[T7]:"fire-fn-compat",[I7]:"fire-iid",[A7]:"fire-iid-compat",[R7]:"fire-fcm",[P7]:"fire-fcm-compat",[C7]:"fire-perf",[M7]:"fire-perf-compat",[b7]:"fire-rc",[k7]:"fire-rc-compat",[L7]:"fire-gcs",[N7]:"fire-gcs-compat",[D7]:"fire-fst",[V7]:"fire-fst-compat",[O7]:"fire-vertex","fire-js":"fire-js",[F7]:"fire-js-all"};const b0=new Map,U7=new Map,GE=new Map;function dR(n,e){try{n.container.addComponent(e)}catch(t){vo.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function cc(n){const e=n.name;if(GE.has(e))return vo.debug(`There were multiple attempts to register component ${e}.`),!1;GE.set(e,n);for(const t of b0.values())dR(t,n);for(const t of U7.values())dR(t,n);return!0}function B_(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Wr(n){return n==null?!1:n.settings!==void 0}const z7={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ma=new Cg("app","Firebase",z7);class B7{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Va("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ma.create("app-deleted",{appName:this._name})}}const Ic=j7;function q4(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i={name:jE,automaticDataCollectionEnabled:!0,...e},r=i.name;if(typeof r!="string"||!r)throw Ma.create("bad-app-name",{appName:String(r)});if(t||(t=F4()),!t)throw Ma.create("no-options");const s=b0.get(r);if(s){if(lc(t,s.options)&&lc(i,s.config))return s;throw Ma.create("duplicate-app",{appName:r})}const o=new X9(r);for(const c of GE.values())o.addComponent(c);const a=new B7(t,i,o);return b0.set(r,a),a}function kx(n=jE){const e=b0.get(n);if(!e&&n===jE&&F4())return q4();if(!e)throw Ma.create("no-app",{appName:n});return e}function As(n,e,t){let i=G7[n]??n;t&&(i+=`-${t}`);const r=i.match(/\s|\//),s=e.match(/\s|\//);if(r||s){const o=[`Unable to register library "${i}" with version "${e}":`];r&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),r&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),vo.warn(o.join(" "));return}cc(new Va(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const $7="firebase-heartbeat-database",W7=1,Kf="firebase-heartbeat-store";let M1=null;function H4(){return M1||(M1=l7($7,W7,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Kf)}catch(t){console.warn(t)}}}}).catch(n=>{throw Ma.create("idb-open",{originalErrorMessage:n.message})})),M1}async function K7(n){try{const t=(await H4()).transaction(Kf),i=await t.objectStore(Kf).get(X4(n));return await t.done,i}catch(e){if(e instanceof Vs)vo.warn(e.message);else{const t=Ma.create("idb-get",{originalErrorMessage:e?.message});vo.warn(t.message)}}}async function fR(n,e){try{const i=(await H4()).transaction(Kf,"readwrite");await i.objectStore(Kf).put(e,X4(n)),await i.done}catch(t){if(t instanceof Vs)vo.warn(t.message);else{const i=Ma.create("idb-set",{originalErrorMessage:t?.message});vo.warn(i.message)}}}function X4(n){return`${n.name}!${n.options.appId}`}const q7=1024,H7=30;class X7{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Z7(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=gR();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(r=>r.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>H7){const r=Q7(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(r,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){vo.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=gR(),{heartbeatsToSend:t,unsentEntries:i}=Y7(this._heartbeatsCache.heartbeats),r=M0(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(e){return vo.warn(e),""}}}function gR(){return new Date().toISOString().substring(0,10)}function Y7(n,e=q7){const t=[];let i=n.slice();for(const r of n){const s=t.find(o=>o.agent===r.agent);if(s){if(s.dates.push(r.date),mR(t)>e){s.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),mR(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class Z7{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return $4()?F9().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await K7(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return fR(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return fR(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function mR(n){return M0(JSON.stringify({version:2,heartbeats:n})).length}function Q7(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}function J7(n){cc(new Va("platform-logger",e=>new h7(e),"PRIVATE")),cc(new Va("heartbeat",e=>new X7(e),"PRIVATE")),As(FE,hR,n),As(FE,hR,"esm2020"),As("fire-js","")}J7("");var pR=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var ba,Y4;(function(){var n;function e(k,R){function L(){}L.prototype=R.prototype,k.F=R.prototype,k.prototype=new L,k.prototype.constructor=k,k.D=function(F,j,U){for(var O=Array(arguments.length-2),ce=2;ce<arguments.length;ce++)O[ce-2]=arguments[ce];return R.prototype[j].apply(F,O)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(k,R,L){L||(L=0);const F=Array(16);if(typeof R=="string")for(var j=0;j<16;++j)F[j]=R.charCodeAt(L++)|R.charCodeAt(L++)<<8|R.charCodeAt(L++)<<16|R.charCodeAt(L++)<<24;else for(j=0;j<16;++j)F[j]=R[L++]|R[L++]<<8|R[L++]<<16|R[L++]<<24;R=k.g[0],L=k.g[1],j=k.g[2];let U=k.g[3],O;O=R+(U^L&(j^U))+F[0]+3614090360&4294967295,R=L+(O<<7&4294967295|O>>>25),O=U+(j^R&(L^j))+F[1]+3905402710&4294967295,U=R+(O<<12&4294967295|O>>>20),O=j+(L^U&(R^L))+F[2]+606105819&4294967295,j=U+(O<<17&4294967295|O>>>15),O=L+(R^j&(U^R))+F[3]+3250441966&4294967295,L=j+(O<<22&4294967295|O>>>10),O=R+(U^L&(j^U))+F[4]+4118548399&4294967295,R=L+(O<<7&4294967295|O>>>25),O=U+(j^R&(L^j))+F[5]+1200080426&4294967295,U=R+(O<<12&4294967295|O>>>20),O=j+(L^U&(R^L))+F[6]+2821735955&4294967295,j=U+(O<<17&4294967295|O>>>15),O=L+(R^j&(U^R))+F[7]+4249261313&4294967295,L=j+(O<<22&4294967295|O>>>10),O=R+(U^L&(j^U))+F[8]+1770035416&4294967295,R=L+(O<<7&4294967295|O>>>25),O=U+(j^R&(L^j))+F[9]+2336552879&4294967295,U=R+(O<<12&4294967295|O>>>20),O=j+(L^U&(R^L))+F[10]+4294925233&4294967295,j=U+(O<<17&4294967295|O>>>15),O=L+(R^j&(U^R))+F[11]+2304563134&4294967295,L=j+(O<<22&4294967295|O>>>10),O=R+(U^L&(j^U))+F[12]+1804603682&4294967295,R=L+(O<<7&4294967295|O>>>25),O=U+(j^R&(L^j))+F[13]+4254626195&4294967295,U=R+(O<<12&4294967295|O>>>20),O=j+(L^U&(R^L))+F[14]+2792965006&4294967295,j=U+(O<<17&4294967295|O>>>15),O=L+(R^j&(U^R))+F[15]+1236535329&4294967295,L=j+(O<<22&4294967295|O>>>10),O=R+(j^U&(L^j))+F[1]+4129170786&4294967295,R=L+(O<<5&4294967295|O>>>27),O=U+(L^j&(R^L))+F[6]+3225465664&4294967295,U=R+(O<<9&4294967295|O>>>23),O=j+(R^L&(U^R))+F[11]+643717713&4294967295,j=U+(O<<14&4294967295|O>>>18),O=L+(U^R&(j^U))+F[0]+3921069994&4294967295,L=j+(O<<20&4294967295|O>>>12),O=R+(j^U&(L^j))+F[5]+3593408605&4294967295,R=L+(O<<5&4294967295|O>>>27),O=U+(L^j&(R^L))+F[10]+38016083&4294967295,U=R+(O<<9&4294967295|O>>>23),O=j+(R^L&(U^R))+F[15]+3634488961&4294967295,j=U+(O<<14&4294967295|O>>>18),O=L+(U^R&(j^U))+F[4]+3889429448&4294967295,L=j+(O<<20&4294967295|O>>>12),O=R+(j^U&(L^j))+F[9]+568446438&4294967295,R=L+(O<<5&4294967295|O>>>27),O=U+(L^j&(R^L))+F[14]+3275163606&4294967295,U=R+(O<<9&4294967295|O>>>23),O=j+(R^L&(U^R))+F[3]+4107603335&4294967295,j=U+(O<<14&4294967295|O>>>18),O=L+(U^R&(j^U))+F[8]+1163531501&4294967295,L=j+(O<<20&4294967295|O>>>12),O=R+(j^U&(L^j))+F[13]+2850285829&4294967295,R=L+(O<<5&4294967295|O>>>27),O=U+(L^j&(R^L))+F[2]+4243563512&4294967295,U=R+(O<<9&4294967295|O>>>23),O=j+(R^L&(U^R))+F[7]+1735328473&4294967295,j=U+(O<<14&4294967295|O>>>18),O=L+(U^R&(j^U))+F[12]+2368359562&4294967295,L=j+(O<<20&4294967295|O>>>12),O=R+(L^j^U)+F[5]+4294588738&4294967295,R=L+(O<<4&4294967295|O>>>28),O=U+(R^L^j)+F[8]+2272392833&4294967295,U=R+(O<<11&4294967295|O>>>21),O=j+(U^R^L)+F[11]+1839030562&4294967295,j=U+(O<<16&4294967295|O>>>16),O=L+(j^U^R)+F[14]+4259657740&4294967295,L=j+(O<<23&4294967295|O>>>9),O=R+(L^j^U)+F[1]+2763975236&4294967295,R=L+(O<<4&4294967295|O>>>28),O=U+(R^L^j)+F[4]+1272893353&4294967295,U=R+(O<<11&4294967295|O>>>21),O=j+(U^R^L)+F[7]+4139469664&4294967295,j=U+(O<<16&4294967295|O>>>16),O=L+(j^U^R)+F[10]+3200236656&4294967295,L=j+(O<<23&4294967295|O>>>9),O=R+(L^j^U)+F[13]+681279174&4294967295,R=L+(O<<4&4294967295|O>>>28),O=U+(R^L^j)+F[0]+3936430074&4294967295,U=R+(O<<11&4294967295|O>>>21),O=j+(U^R^L)+F[3]+3572445317&4294967295,j=U+(O<<16&4294967295|O>>>16),O=L+(j^U^R)+F[6]+76029189&4294967295,L=j+(O<<23&4294967295|O>>>9),O=R+(L^j^U)+F[9]+3654602809&4294967295,R=L+(O<<4&4294967295|O>>>28),O=U+(R^L^j)+F[12]+3873151461&4294967295,U=R+(O<<11&4294967295|O>>>21),O=j+(U^R^L)+F[15]+530742520&4294967295,j=U+(O<<16&4294967295|O>>>16),O=L+(j^U^R)+F[2]+3299628645&4294967295,L=j+(O<<23&4294967295|O>>>9),O=R+(j^(L|~U))+F[0]+4096336452&4294967295,R=L+(O<<6&4294967295|O>>>26),O=U+(L^(R|~j))+F[7]+1126891415&4294967295,U=R+(O<<10&4294967295|O>>>22),O=j+(R^(U|~L))+F[14]+2878612391&4294967295,j=U+(O<<15&4294967295|O>>>17),O=L+(U^(j|~R))+F[5]+4237533241&4294967295,L=j+(O<<21&4294967295|O>>>11),O=R+(j^(L|~U))+F[12]+1700485571&4294967295,R=L+(O<<6&4294967295|O>>>26),O=U+(L^(R|~j))+F[3]+2399980690&4294967295,U=R+(O<<10&4294967295|O>>>22),O=j+(R^(U|~L))+F[10]+4293915773&4294967295,j=U+(O<<15&4294967295|O>>>17),O=L+(U^(j|~R))+F[1]+2240044497&4294967295,L=j+(O<<21&4294967295|O>>>11),O=R+(j^(L|~U))+F[8]+1873313359&4294967295,R=L+(O<<6&4294967295|O>>>26),O=U+(L^(R|~j))+F[15]+4264355552&4294967295,U=R+(O<<10&4294967295|O>>>22),O=j+(R^(U|~L))+F[6]+2734768916&4294967295,j=U+(O<<15&4294967295|O>>>17),O=L+(U^(j|~R))+F[13]+1309151649&4294967295,L=j+(O<<21&4294967295|O>>>11),O=R+(j^(L|~U))+F[4]+4149444226&4294967295,R=L+(O<<6&4294967295|O>>>26),O=U+(L^(R|~j))+F[11]+3174756917&4294967295,U=R+(O<<10&4294967295|O>>>22),O=j+(R^(U|~L))+F[2]+718787259&4294967295,j=U+(O<<15&4294967295|O>>>17),O=L+(U^(j|~R))+F[9]+3951481745&4294967295,k.g[0]=k.g[0]+R&4294967295,k.g[1]=k.g[1]+(j+(O<<21&4294967295|O>>>11))&4294967295,k.g[2]=k.g[2]+j&4294967295,k.g[3]=k.g[3]+U&4294967295}i.prototype.v=function(k,R){R===void 0&&(R=k.length);const L=R-this.blockSize,F=this.C;let j=this.h,U=0;for(;U<R;){if(j==0)for(;U<=L;)r(this,k,U),U+=this.blockSize;if(typeof k=="string"){for(;U<R;)if(F[j++]=k.charCodeAt(U++),j==this.blockSize){r(this,F),j=0;break}}else for(;U<R;)if(F[j++]=k[U++],j==this.blockSize){r(this,F),j=0;break}}this.h=j,this.o+=R},i.prototype.A=function(){var k=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);k[0]=128;for(var R=1;R<k.length-8;++R)k[R]=0;R=this.o*8;for(var L=k.length-8;L<k.length;++L)k[L]=R&255,R/=256;for(this.v(k),k=Array(16),R=0,L=0;L<4;++L)for(let F=0;F<32;F+=8)k[R++]=this.g[L]>>>F&255;return k};function s(k,R){var L=a;return Object.prototype.hasOwnProperty.call(L,k)?L[k]:L[k]=R(k)}function o(k,R){this.h=R;const L=[];let F=!0;for(let j=k.length-1;j>=0;j--){const U=k[j]|0;F&&U==R||(L[j]=U,F=!1)}this.g=L}var a={};function c(k){return-128<=k&&k<128?s(k,function(R){return new o([R|0],R<0?-1:0)}):new o([k|0],k<0?-1:0)}function h(k){if(isNaN(k)||!isFinite(k))return g;if(k<0)return w(h(-k));const R=[];let L=1;for(let F=0;k>=L;F++)R[F]=k/L|0,L*=4294967296;return new o(R,0)}function d(k,R){if(k.length==0)throw Error("number format error: empty string");if(R=R||10,R<2||36<R)throw Error("radix out of range: "+R);if(k.charAt(0)=="-")return w(d(k.substring(1),R));if(k.indexOf("-")>=0)throw Error('number format error: interior "-" character');const L=h(Math.pow(R,8));let F=g;for(let U=0;U<k.length;U+=8){var j=Math.min(8,k.length-U);const O=parseInt(k.substring(U,U+j),R);j<8?(j=h(Math.pow(R,j)),F=F.j(j).add(h(O))):(F=F.j(L),F=F.add(h(O)))}return F}var g=c(0),m=c(1),v=c(16777216);n=o.prototype,n.m=function(){if(T(this))return-w(this).m();let k=0,R=1;for(let L=0;L<this.g.length;L++){const F=this.i(L);k+=(F>=0?F:4294967296+F)*R,R*=4294967296}return k},n.toString=function(k){if(k=k||10,k<2||36<k)throw Error("radix out of range: "+k);if(y(this))return"0";if(T(this))return"-"+w(this).toString(k);const R=h(Math.pow(k,6));var L=this;let F="";for(;;){const j=N(L,R).g;L=A(L,j.j(R));let U=((L.g.length>0?L.g[0]:L.h)>>>0).toString(k);if(L=j,y(L))return U+F;for(;U.length<6;)U="0"+U;F=U+F}},n.i=function(k){return k<0?0:k<this.g.length?this.g[k]:this.h};function y(k){if(k.h!=0)return!1;for(let R=0;R<k.g.length;R++)if(k.g[R]!=0)return!1;return!0}function T(k){return k.h==-1}n.l=function(k){return k=A(this,k),T(k)?-1:y(k)?0:1};function w(k){const R=k.g.length,L=[];for(let F=0;F<R;F++)L[F]=~k.g[F];return new o(L,~k.h).add(m)}n.abs=function(){return T(this)?w(this):this},n.add=function(k){const R=Math.max(this.g.length,k.g.length),L=[];let F=0;for(let j=0;j<=R;j++){let U=F+(this.i(j)&65535)+(k.i(j)&65535),O=(U>>>16)+(this.i(j)>>>16)+(k.i(j)>>>16);F=O>>>16,U&=65535,O&=65535,L[j]=O<<16|U}return new o(L,L[L.length-1]&-2147483648?-1:0)};function A(k,R){return k.add(w(R))}n.j=function(k){if(y(this)||y(k))return g;if(T(this))return T(k)?w(this).j(w(k)):w(w(this).j(k));if(T(k))return w(this.j(w(k)));if(this.l(v)<0&&k.l(v)<0)return h(this.m()*k.m());const R=this.g.length+k.g.length,L=[];for(var F=0;F<2*R;F++)L[F]=0;for(F=0;F<this.g.length;F++)for(let j=0;j<k.g.length;j++){const U=this.i(F)>>>16,O=this.i(F)&65535,ce=k.i(j)>>>16,we=k.i(j)&65535;L[2*F+2*j]+=O*we,P(L,2*F+2*j),L[2*F+2*j+1]+=U*we,P(L,2*F+2*j+1),L[2*F+2*j+1]+=O*ce,P(L,2*F+2*j+1),L[2*F+2*j+2]+=U*ce,P(L,2*F+2*j+2)}for(k=0;k<R;k++)L[k]=L[2*k+1]<<16|L[2*k];for(k=R;k<2*R;k++)L[k]=0;return new o(L,0)};function P(k,R){for(;(k[R]&65535)!=k[R];)k[R+1]+=k[R]>>>16,k[R]&=65535,R++}function C(k,R){this.g=k,this.h=R}function N(k,R){if(y(R))throw Error("division by zero");if(y(k))return new C(g,g);if(T(k))return R=N(w(k),R),new C(w(R.g),w(R.h));if(T(R))return R=N(k,w(R)),new C(w(R.g),R.h);if(k.g.length>30){if(T(k)||T(R))throw Error("slowDivide_ only works with positive integers.");for(var L=m,F=R;F.l(k)<=0;)L=D(L),F=D(F);var j=z(L,1),U=z(F,1);for(F=z(F,2),L=z(L,2);!y(F);){var O=U.add(F);O.l(k)<=0&&(j=j.add(L),U=O),F=z(F,1),L=z(L,1)}return R=A(k,j.j(R)),new C(j,R)}for(j=g;k.l(R)>=0;){for(L=Math.max(1,Math.floor(k.m()/R.m())),F=Math.ceil(Math.log(L)/Math.LN2),F=F<=48?1:Math.pow(2,F-48),U=h(L),O=U.j(R);T(O)||O.l(k)>0;)L-=F,U=h(L),O=U.j(R);y(U)&&(U=m),j=j.add(U),k=A(k,O)}return new C(j,k)}n.B=function(k){return N(this,k).h},n.and=function(k){const R=Math.max(this.g.length,k.g.length),L=[];for(let F=0;F<R;F++)L[F]=this.i(F)&k.i(F);return new o(L,this.h&k.h)},n.or=function(k){const R=Math.max(this.g.length,k.g.length),L=[];for(let F=0;F<R;F++)L[F]=this.i(F)|k.i(F);return new o(L,this.h|k.h)},n.xor=function(k){const R=Math.max(this.g.length,k.g.length),L=[];for(let F=0;F<R;F++)L[F]=this.i(F)^k.i(F);return new o(L,this.h^k.h)};function D(k){const R=k.g.length+1,L=[];for(let F=0;F<R;F++)L[F]=k.i(F)<<1|k.i(F-1)>>>31;return new o(L,k.h)}function z(k,R){const L=R>>5;R%=32;const F=k.g.length-L,j=[];for(let U=0;U<F;U++)j[U]=R>0?k.i(U+L)>>>R|k.i(U+L+1)<<32-R:k.i(U+L);return new o(j,k.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,Y4=i,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=d,ba=o}).apply(typeof pR<"u"?pR:typeof self<"u"?self:typeof window<"u"?window:{});var Ep=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Z4,Zd,Q4,Gp,UE,J4,ek,tk;(function(){var n,e=Object.defineProperty;function t(p){p=[typeof globalThis=="object"&&globalThis,p,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ep=="object"&&Ep];for(var S=0;S<p.length;++S){var I=p[S];if(I&&I.Math==Math)return I}throw Error("Cannot find global object")}var i=t(this);function r(p,S){if(S)e:{var I=i;p=p.split(".");for(var V=0;V<p.length-1;V++){var X=p[V];if(!(X in I))break e;I=I[X]}p=p[p.length-1],V=I[p],S=S(V),S!=V&&S!=null&&e(I,p,{configurable:!0,writable:!0,value:S})}}r("Symbol.dispose",function(p){return p||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(p){return p||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(p){return p||function(S){var I=[],V;for(V in S)Object.prototype.hasOwnProperty.call(S,V)&&I.push([V,S[V]]);return I}});var s=s||{},o=this||self;function a(p){var S=typeof p;return S=="object"&&p!=null||S=="function"}function c(p,S,I){return p.call.apply(p.bind,arguments)}function h(p,S,I){return h=c,h.apply(null,arguments)}function d(p,S){var I=Array.prototype.slice.call(arguments,1);return function(){var V=I.slice();return V.push.apply(V,arguments),p.apply(this,V)}}function g(p,S){function I(){}I.prototype=S.prototype,p.Z=S.prototype,p.prototype=new I,p.prototype.constructor=p,p.Ob=function(V,X,Q){for(var fe=Array(arguments.length-2),qe=2;qe<arguments.length;qe++)fe[qe-2]=arguments[qe];return S.prototype[X].apply(V,fe)}}var m=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?p=>p&&AsyncContext.Snapshot.wrap(p):p=>p;function v(p){const S=p.length;if(S>0){const I=Array(S);for(let V=0;V<S;V++)I[V]=p[V];return I}return[]}function y(p,S){for(let V=1;V<arguments.length;V++){const X=arguments[V];var I=typeof X;if(I=I!="object"?I:X?Array.isArray(X)?"array":I:"null",I=="array"||I=="object"&&typeof X.length=="number"){I=p.length||0;const Q=X.length||0;p.length=I+Q;for(let fe=0;fe<Q;fe++)p[I+fe]=X[fe]}else p.push(X)}}class T{constructor(S,I){this.i=S,this.j=I,this.h=0,this.g=null}get(){let S;return this.h>0?(this.h--,S=this.g,this.g=S.next,S.next=null):S=this.i(),S}}function w(p){o.setTimeout(()=>{throw p},0)}function A(){var p=k;let S=null;return p.g&&(S=p.g,p.g=p.g.next,p.g||(p.h=null),S.next=null),S}class P{constructor(){this.h=this.g=null}add(S,I){const V=C.get();V.set(S,I),this.h?this.h.next=V:this.g=V,this.h=V}}var C=new T(()=>new N,p=>p.reset());class N{constructor(){this.next=this.g=this.h=null}set(S,I){this.h=S,this.g=I,this.next=null}reset(){this.next=this.g=this.h=null}}let D,z=!1,k=new P,R=()=>{const p=Promise.resolve(void 0);D=()=>{p.then(L)}};function L(){for(var p;p=A();){try{p.h.call(p.g)}catch(I){w(I)}var S=C;S.j(p),S.h<100&&(S.h++,p.next=S.g,S.g=p)}z=!1}function F(){this.u=this.u,this.C=this.C}F.prototype.u=!1,F.prototype.dispose=function(){this.u||(this.u=!0,this.N())},F.prototype[Symbol.dispose]=function(){this.dispose()},F.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function j(p,S){this.type=p,this.g=this.target=S,this.defaultPrevented=!1}j.prototype.h=function(){this.defaultPrevented=!0};var U=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var p=!1,S=Object.defineProperty({},"passive",{get:function(){p=!0}});try{const I=()=>{};o.addEventListener("test",I,S),o.removeEventListener("test",I,S)}catch{}return p})();function O(p){return/^[\s\xa0]*$/.test(p)}function ce(p,S){j.call(this,p?p.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,p&&this.init(p,S)}g(ce,j),ce.prototype.init=function(p,S){const I=this.type=p.type,V=p.changedTouches&&p.changedTouches.length?p.changedTouches[0]:null;this.target=p.target||p.srcElement,this.g=S,S=p.relatedTarget,S||(I=="mouseover"?S=p.fromElement:I=="mouseout"&&(S=p.toElement)),this.relatedTarget=S,V?(this.clientX=V.clientX!==void 0?V.clientX:V.pageX,this.clientY=V.clientY!==void 0?V.clientY:V.pageY,this.screenX=V.screenX||0,this.screenY=V.screenY||0):(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0),this.button=p.button,this.key=p.key||"",this.ctrlKey=p.ctrlKey,this.altKey=p.altKey,this.shiftKey=p.shiftKey,this.metaKey=p.metaKey,this.pointerId=p.pointerId||0,this.pointerType=p.pointerType,this.state=p.state,this.i=p,p.defaultPrevented&&ce.Z.h.call(this)},ce.prototype.h=function(){ce.Z.h.call(this);const p=this.i;p.preventDefault?p.preventDefault():p.returnValue=!1};var we="closure_listenable_"+(Math.random()*1e6|0),ye=0;function de(p,S,I,V,X){this.listener=p,this.proxy=null,this.src=S,this.type=I,this.capture=!!V,this.ha=X,this.key=++ye,this.da=this.fa=!1}function J(p){p.da=!0,p.listener=null,p.proxy=null,p.src=null,p.ha=null}function ae(p,S,I){for(const V in p)S.call(I,p[V],V,p)}function ie(p,S){for(const I in p)S.call(void 0,p[I],I,p)}function $(p){const S={};for(const I in p)S[I]=p[I];return S}const K="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ae(p,S){let I,V;for(let X=1;X<arguments.length;X++){V=arguments[X];for(I in V)p[I]=V[I];for(let Q=0;Q<K.length;Q++)I=K[Q],Object.prototype.hasOwnProperty.call(V,I)&&(p[I]=V[I])}}function Re(p){this.src=p,this.g={},this.h=0}Re.prototype.add=function(p,S,I,V,X){const Q=p.toString();p=this.g[Q],p||(p=this.g[Q]=[],this.h++);const fe=Oe(p,S,V,X);return fe>-1?(S=p[fe],I||(S.fa=!1)):(S=new de(S,this.src,Q,!!V,X),S.fa=I,p.push(S)),S};function Pe(p,S){const I=S.type;if(I in p.g){var V=p.g[I],X=Array.prototype.indexOf.call(V,S,void 0),Q;(Q=X>=0)&&Array.prototype.splice.call(V,X,1),Q&&(J(S),p.g[I].length==0&&(delete p.g[I],p.h--))}}function Oe(p,S,I,V){for(let X=0;X<p.length;++X){const Q=p[X];if(!Q.da&&Q.listener==S&&Q.capture==!!I&&Q.ha==V)return X}return-1}var Fe="closure_lm_"+(Math.random()*1e6|0),Ke={};function Ye(p,S,I,V,X){if(Array.isArray(S)){for(let Q=0;Q<S.length;Q++)Ye(p,S[Q],I,V,X);return null}return I=tr(I),p&&p[we]?p.J(S,I,a(V)?!!V.capture:!1,X):yt(p,S,I,!1,V,X)}function yt(p,S,I,V,X,Q){if(!S)throw Error("Invalid event type");const fe=a(X)?!!X.capture:!!X;let qe=Pn(p);if(qe||(p[Fe]=qe=new Re(p)),I=qe.add(S,I,V,fe,Q),I.proxy)return I;if(V=Rr(),I.proxy=V,V.src=p,V.listener=I,p.addEventListener)U||(X=fe),X===void 0&&(X=!1),p.addEventListener(S.toString(),V,X);else if(p.attachEvent)p.attachEvent(mi(S.toString()),V);else if(p.addListener&&p.removeListener)p.addListener(V);else throw Error("addEventListener and attachEvent are unavailable.");return I}function Rr(){function p(I){return S.call(p.src,p.listener,I)}const S=Rn;return p}function js(p,S,I,V,X){if(Array.isArray(S))for(var Q=0;Q<S.length;Q++)js(p,S[Q],I,V,X);else V=a(V)?!!V.capture:!!V,I=tr(I),p&&p[we]?(p=p.i,Q=String(S).toString(),Q in p.g&&(S=p.g[Q],I=Oe(S,I,V,X),I>-1&&(J(S[I]),Array.prototype.splice.call(S,I,1),S.length==0&&(delete p.g[Q],p.h--)))):p&&(p=Pn(p))&&(S=p.g[S.toString()],p=-1,S&&(p=Oe(S,I,V,X)),(I=p>-1?S[p]:null)&&gi(I))}function gi(p){if(typeof p!="number"&&p&&!p.da){var S=p.src;if(S&&S[we])Pe(S.i,p);else{var I=p.type,V=p.proxy;S.removeEventListener?S.removeEventListener(I,V,p.capture):S.detachEvent?S.detachEvent(mi(I),V):S.addListener&&S.removeListener&&S.removeListener(V),(I=Pn(S))?(Pe(I,p),I.h==0&&(I.src=null,S[Fe]=null)):J(p)}}}function mi(p){return p in Ke?Ke[p]:Ke[p]="on"+p}function Rn(p,S){if(p.da)p=!0;else{S=new ce(S,this);const I=p.listener,V=p.ha||p.src;p.fa&&gi(p),p=I.call(V,S)}return p}function Pn(p){return p=p[Fe],p instanceof Re?p:null}var pi="__closure_events_fn_"+(Math.random()*1e9>>>0);function tr(p){return typeof p=="function"?p:(p[pi]||(p[pi]=function(S){return p.handleEvent(S)}),p[pi])}function Rt(){F.call(this),this.i=new Re(this),this.M=this,this.G=null}g(Rt,F),Rt.prototype[we]=!0,Rt.prototype.removeEventListener=function(p,S,I,V){js(this,p,S,I,V)};function vt(p,S){var I,V=p.G;if(V)for(I=[];V;V=V.G)I.push(V);if(p=p.M,V=S.type||S,typeof S=="string")S=new j(S,p);else if(S instanceof j)S.target=S.target||p;else{var X=S;S=new j(V,p),Ae(S,X)}X=!0;let Q,fe;if(I)for(fe=I.length-1;fe>=0;fe--)Q=S.g=I[fe],X=vn(Q,V,!0,S)&&X;if(Q=S.g=p,X=vn(Q,V,!0,S)&&X,X=vn(Q,V,!1,S)&&X,I)for(fe=0;fe<I.length;fe++)Q=S.g=I[fe],X=vn(Q,V,!1,S)&&X}Rt.prototype.N=function(){if(Rt.Z.N.call(this),this.i){var p=this.i;for(const S in p.g){const I=p.g[S];for(let V=0;V<I.length;V++)J(I[V]);delete p.g[S],p.h--}}this.G=null},Rt.prototype.J=function(p,S,I,V){return this.i.add(String(p),S,!1,I,V)},Rt.prototype.K=function(p,S,I,V){return this.i.add(String(p),S,!0,I,V)};function vn(p,S,I,V){if(S=p.i.g[String(S)],!S)return!0;S=S.concat();let X=!0;for(let Q=0;Q<S.length;++Q){const fe=S[Q];if(fe&&!fe.da&&fe.capture==I){const qe=fe.listener,Qt=fe.ha||fe.src;fe.fa&&Pe(p.i,fe),X=qe.call(Qt,V)!==!1&&X}}return X&&!V.defaultPrevented}function nr(p,S){if(typeof p!="function")if(p&&typeof p.handleEvent=="function")p=h(p.handleEvent,p);else throw Error("Invalid listener argument");return Number(S)>2147483647?-1:o.setTimeout(p,S||0)}function Nt(p){p.g=nr(()=>{p.g=null,p.i&&(p.i=!1,Nt(p))},p.l);const S=p.h;p.h=null,p.m.apply(null,S)}class bo extends F{constructor(S,I){super(),this.m=S,this.l=I,this.h=null,this.i=!1,this.g=null}j(S){this.h=arguments,this.g?this.i=!0:Nt(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ir(p){F.call(this),this.h=p,this.g={}}g(ir,F);var Zr=[];function Pr(p){ae(p.g,function(S,I){this.g.hasOwnProperty(I)&&gi(S)},p),p.g={}}ir.prototype.N=function(){ir.Z.N.call(this),Pr(this)},ir.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Qr=o.JSON.stringify,Ja=o.JSON.parse,Jr=class{stringify(p){return o.JSON.stringify(p,void 0)}parse(p){return o.JSON.parse(p,void 0)}};function rr(){}function Mc(){}var es={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Gs(){j.call(this,"d")}g(Gs,j);function ko(){j.call(this,"c")}g(ko,j);var ri={},Us=null;function ts(){return Us=Us||new Rt}ri.Ia="serverreachability";function ns(p){j.call(this,ri.Ia,p)}g(ns,j);function si(p){const S=ts();vt(S,new ns(S))}ri.STAT_EVENT="statevent";function oi(p,S){j.call(this,ri.STAT_EVENT,p),this.stat=S}g(oi,j);function It(p){const S=ts();vt(S,new oi(S,p))}ri.Ja="timingevent";function Lo(p,S){j.call(this,ri.Ja,p),this.size=S}g(Lo,j);function Cr(p,S){if(typeof p!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){p()},S)}function Yt(){this.g=!0}Yt.prototype.ua=function(){this.g=!1};function sr(p,S,I,V,X,Q){p.info(function(){if(p.g)if(Q){var fe="",qe=Q.split("&");for(let Et=0;Et<qe.length;Et++){var Qt=qe[Et].split("=");if(Qt.length>1){const sn=Qt[0];Qt=Qt[1];const Gi=sn.split("_");fe=Gi.length>=2&&Gi[1]=="type"?fe+(sn+"="+Qt+"&"):fe+(sn+"=redacted&")}}}else fe=null;else fe=Q;return"XMLHTTP REQ ("+V+") [attempt "+X+"]: "+S+`
`+I+`
`+fe})}function Cn(p,S,I,V,X,Q,fe){p.info(function(){return"XMLHTTP RESP ("+V+") [ attempt "+X+"]: "+S+`
`+I+`
`+Q+" "+fe})}function Zt(p,S,I,V){p.info(function(){return"XMLHTTP TEXT ("+S+"): "+bn(p,I)+(V?" "+V:"")})}function Mn(p,S){p.info(function(){return"TIMEOUT: "+S})}Yt.prototype.info=function(){};function bn(p,S){if(!p.g)return S;if(!S)return null;try{const Q=JSON.parse(S);if(Q){for(p=0;p<Q.length;p++)if(Array.isArray(Q[p])){var I=Q[p];if(!(I.length<2)){var V=I[1];if(Array.isArray(V)&&!(V.length<1)){var X=V[0];if(X!="noop"&&X!="stop"&&X!="close")for(let fe=1;fe<V.length;fe++)V[fe]=""}}}}return Qr(Q)}catch{return S}}var En={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},ht={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},rn;function un(){}g(un,rr),un.prototype.g=function(){return new XMLHttpRequest},rn=new un;function or(p){return encodeURIComponent(String(p))}function bc(p){var S=1;p=p.split(":");const I=[];for(;S>0&&p.length;)I.push(p.shift()),S--;return p.length&&I.push(p.join(":")),I}function ar(p,S,I,V){this.j=p,this.i=S,this.l=I,this.S=V||1,this.V=new ir(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Jg}function Jg(){this.i=null,this.g="",this.h=!1}var em={},Bh={};function Mr(p,S,I){p.M=1,p.A=Bs(lr(S)),p.u=I,p.R=!0,$h(p,null)}function $h(p,S){p.F=Date.now(),el(p),p.B=lr(p.A);var I=p.B,V=p.S;Array.isArray(V)||(V=[String(V)]),ed(I.i,"t",V),p.C=0,I=p.j.L,p.h=new Jg,p.g=um(p.j,I?S:null,!p.u),p.P>0&&(p.O=new bo(h(p.Y,p,p.g),p.P)),S=p.V,I=p.g,V=p.ba;var X="readystatechange";Array.isArray(X)||(X&&(Zr[0]=X.toString()),X=Zr);for(let Q=0;Q<X.length;Q++){const fe=Ye(I,X[Q],V||S.handleEvent,!1,S.h||S);if(!fe)break;S.g[fe.key]=fe}S=p.J?$(p.J):{},p.u?(p.v||(p.v="POST"),S["Content-Type"]="application/x-www-form-urlencoded",p.g.ea(p.B,p.v,p.u,S)):(p.v="GET",p.g.ea(p.B,p.v,null,S)),si(),sr(p.i,p.v,p.B,p.l,p.S,p.u)}ar.prototype.ba=function(p){p=p.target;const S=this.O;S&&cs(p)==3?S.j():this.Y(p)},ar.prototype.Y=function(p){try{if(p==this.g)e:{const qe=cs(this.g),Qt=this.g.ya(),Et=this.g.ca();if(!(qe<3)&&(qe!=3||this.g&&(this.h.h||this.g.la()||lm(this.g)))){this.K||qe!=4||Qt==7||(Qt==8||Et<=0?si(3):si(2)),kc(this);var S=this.g.ca();this.X=S;var I=tm(this);if(this.o=S==200,Cn(this.i,this.v,this.B,this.l,this.S,qe,S),this.o){if(this.U&&!this.L){t:{if(this.g){var V,X=this.g;if((V=X.g?X.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!O(V)){var Q=V;break t}}Q=null}if(p=Q)Zt(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Ct(this,p);else{this.o=!1,this.m=3,It(12),zs(this),tl(this);break e}}if(this.R){p=!0;let sn;for(;!this.K&&this.C<I.length;)if(sn=im(this,I),sn==Bh){qe==4&&(this.m=4,It(14),p=!1),Zt(this.i,this.l,null,"[Incomplete Response]");break}else if(sn==em){this.m=4,It(15),Zt(this.i,this.l,I,"[Invalid Chunk]"),p=!1;break}else Zt(this.i,this.l,sn,null),Ct(this,sn);if(nm(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),qe!=4||I.length!=0||this.h.h||(this.m=1,It(16),p=!1),this.o=this.o&&p,!p)Zt(this.i,this.l,I,"[Invalid Chunked Response]"),zs(this),tl(this);else if(I.length>0&&!this.W){this.W=!0;var fe=this.j;fe.g==this&&fe.aa&&!fe.P&&(fe.j.info("Great, no buffering proxy detected. Bytes received: "+I.length),ul(fe),fe.P=!0,It(11))}}else Zt(this.i,this.l,I,null),Ct(this,I);qe==4&&zs(this),this.o&&!this.K&&(qe==4?zc(this.j,this):(this.o=!1,el(this)))}else nd(this.g),S==400&&I.indexOf("Unknown SID")>0?(this.m=3,It(12)):(this.m=0,It(13)),zs(this),tl(this)}}}catch{}};function tm(p){if(!nm(p))return p.g.la();const S=lm(p.g);if(S==="")return"";let I="";const V=S.length,X=cs(p.g)==4;if(!p.h.i){if(typeof TextDecoder>"u")return zs(p),tl(p),"";p.h.i=new o.TextDecoder}for(let Q=0;Q<V;Q++)p.h.h=!0,I+=p.h.i.decode(S[Q],{stream:!(X&&Q==V-1)});return S.length=0,p.h.g+=I,p.C=0,p.h.g}function nm(p){return p.g?p.v=="GET"&&p.M!=2&&p.j.Aa:!1}function im(p,S){var I=p.C,V=S.indexOf(`
`,I);return V==-1?Bh:(I=Number(S.substring(I,V)),isNaN(I)?em:(V+=1,V+I>S.length?Bh:(S=S.slice(V,V+I),p.C=V+I,S)))}ar.prototype.cancel=function(){this.K=!0,zs(this)};function el(p){p.T=Date.now()+p.H,Wh(p,p.H)}function Wh(p,S){if(p.D!=null)throw Error("WatchDog timer not null");p.D=Cr(h(p.aa,p),S)}function kc(p){p.D&&(o.clearTimeout(p.D),p.D=null)}ar.prototype.aa=function(){this.D=null;const p=Date.now();p-this.T>=0?(Mn(this.i,this.B),this.M!=2&&(si(),It(17)),zs(this),this.m=2,tl(this)):Wh(this,this.T-p)};function tl(p){p.j.I==0||p.K||zc(p.j,p)}function zs(p){kc(p);var S=p.O;S&&typeof S.dispose=="function"&&S.dispose(),p.O=null,Pr(p.V),p.g&&(S=p.g,p.g=null,S.abort(),S.dispose())}function Ct(p,S){try{var I=p.j;if(I.I!=0&&(I.g==p||qh(I.h,p))){if(!p.L&&qh(I.h,p)&&I.I==3){try{var V=I.Ba.g.parse(S)}catch{V=null}if(Array.isArray(V)&&V.length==3){var X=V;if(X[0]==0){e:if(!I.v){if(I.g)if(I.g.F+3e3<p.F)Uc(I),Fi(I);else break e;ds(I),It(18)}}else I.xa=X[1],0<I.xa-I.K&&X[2]<37500&&I.F&&I.A==0&&!I.C&&(I.C=Cr(h(I.Va,I),6e3));nl(I.h)<=1&&I.ta&&(I.ta=void 0)}else ji(I,11)}else if((p.L||I.g==p)&&Uc(I),!O(S))for(X=I.Ba.g.parse(S),S=0;S<X.length;S++){let Et=X[S];const sn=Et[0];if(!(sn<=I.K))if(I.K=sn,Et=Et[1],I.I==2)if(Et[0]=="c"){I.M=Et[1],I.ba=Et[2];const Gi=Et[3];Gi!=null&&(I.ka=Gi,I.j.info("VER="+I.ka));const Hs=Et[4];Hs!=null&&(I.za=Hs,I.j.info("SVER="+I.za));const fs=Et[5];fs!=null&&typeof fs=="number"&&fs>0&&(V=1.5*fs,I.O=V,I.j.info("backChannelRequestTimeoutMs_="+V)),V=I;const gs=p.g;if(gs){const Wc=gs.g?gs.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Wc){var Q=V.h;Q.g||Wc.indexOf("spdy")==-1&&Wc.indexOf("quic")==-1&&Wc.indexOf("h2")==-1||(Q.j=Q.l,Q.g=new Set,Q.h&&(Nc(Q,Q.h),Q.h=null))}if(V.G){const sd=gs.g?gs.g.getResponseHeader("X-HTTP-Session-Id"):null;sd&&(V.wa=sd,dt(V.J,V.G,sd))}}I.I=3,I.l&&I.l.ra(),I.aa&&(I.T=Date.now()-p.F,I.j.info("Handshake RTT: "+I.T+"ms")),V=I;var fe=p;if(V.na=rd(V,V.L?V.ba:null,V.W),fe.L){il(V.h,fe);var qe=fe,Qt=V.O;Qt&&(qe.H=Qt),qe.D&&(kc(qe),el(qe)),V.g=fe}else zn(V);I.i.length>0&&qs(I)}else Et[0]!="stop"&&Et[0]!="close"||ji(I,7);else I.I==3&&(Et[0]=="stop"||Et[0]=="close"?Et[0]=="stop"?ji(I,7):jc(I):Et[0]!="noop"&&I.l&&I.l.qa(Et),I.A=0)}}si(4)}catch{}}var xy=class{constructor(p,S){this.g=p,this.map=S}};function Lc(p){this.l=p||10,o.PerformanceNavigationTiming?(p=o.performance.getEntriesByType("navigation"),p=p.length>0&&(p[0].nextHopProtocol=="hq"||p[0].nextHopProtocol=="h2")):p=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=p?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Kh(p){return p.h?!0:p.g?p.g.size>=p.j:!1}function nl(p){return p.h?1:p.g?p.g.size:0}function qh(p,S){return p.h?p.h==S:p.g?p.g.has(S):!1}function Nc(p,S){p.g?p.g.add(S):p.h=S}function il(p,S){p.h&&p.h==S?p.h=null:p.g&&p.g.has(S)&&p.g.delete(S)}Lc.prototype.cancel=function(){if(this.i=Di(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const p of this.g.values())p.cancel();this.g.clear()}};function Di(p){if(p.h!=null)return p.i.concat(p.h.G);if(p.g!=null&&p.g.size!==0){let S=p.i;for(const I of p.g.values())S=S.concat(I.G);return S}return v(p.i)}var rm=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Oi(p,S){if(p){p=p.split("&");for(let I=0;I<p.length;I++){const V=p[I].indexOf("=");let X,Q=null;V>=0?(X=p[I].substring(0,V),Q=p[I].substring(V+1)):X=p[I],S(X,Q?decodeURIComponent(Q.replace(/\+/g," ")):"")}}}function is(p){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let S;p instanceof is?(this.l=p.l,rl(this,p.j),this.o=p.o,this.g=p.g,rs(this,p.u),this.h=p.h,No(this,td(p.i)),this.m=p.m):p&&(S=String(p).match(rm))?(this.l=!1,rl(this,S[1]||"",!0),this.o=sl(S[2]||""),this.g=sl(S[3]||"",!0),rs(this,S[4]),this.h=sl(S[5]||"",!0),No(this,S[6]||"",!0),this.m=sl(S[7]||"")):(this.l=!1,this.i=new nt(null,this.l))}is.prototype.toString=function(){const p=[];var S=this.j;S&&p.push(ol(S,Xh,!0),":");var I=this.g;return(I||S=="file")&&(p.push("//"),(S=this.o)&&p.push(ol(S,Xh,!0),"@"),p.push(or(I).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),I=this.u,I!=null&&p.push(":",String(I))),(I=this.h)&&(this.g&&I.charAt(0)!="/"&&p.push("/"),p.push(ol(I,I.charAt(0)=="/"?al:Yh,!0))),(I=this.i.toString())&&p.push("?",I),(I=this.m)&&p.push("#",ol(I,Zh)),p.join("")},is.prototype.resolve=function(p){const S=lr(this);let I=!!p.j;I?rl(S,p.j):I=!!p.o,I?S.o=p.o:I=!!p.g,I?S.g=p.g:I=p.u!=null;var V=p.h;if(I)rs(S,p.u);else if(I=!!p.h){if(V.charAt(0)!="/")if(this.g&&!this.h)V="/"+V;else{var X=S.h.lastIndexOf("/");X!=-1&&(V=S.h.slice(0,X+1)+V)}if(X=V,X==".."||X==".")V="";else if(X.indexOf("./")!=-1||X.indexOf("/.")!=-1){V=X.lastIndexOf("/",0)==0,X=X.split("/");const Q=[];for(let fe=0;fe<X.length;){const qe=X[fe++];qe=="."?V&&fe==X.length&&Q.push(""):qe==".."?((Q.length>1||Q.length==1&&Q[0]!="")&&Q.pop(),V&&fe==X.length&&Q.push("")):(Q.push(qe),V=!0)}V=Q.join("/")}else V=X}return I?S.h=V:I=p.i.toString()!=="",I?No(S,td(p.i)):I=!!p.m,I&&(S.m=p.m),S};function lr(p){return new is(p)}function rl(p,S,I){p.j=I?sl(S,!0):S,p.j&&(p.j=p.j.replace(/:$/,""))}function rs(p,S){if(S){if(S=Number(S),isNaN(S)||S<0)throw Error("Bad port number "+S);p.u=S}else p.u=null}function No(p,S,I){S instanceof nt?(p.i=S,Oc(p.i,p.l)):(I||(S=ol(S,Sy)),p.i=new nt(S,p.l))}function dt(p,S,I){p.i.set(S,I)}function Bs(p){return dt(p,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),p}function sl(p,S){return p?S?decodeURI(p.replace(/%25/g,"%2525")):decodeURIComponent(p):""}function ol(p,S,I){return typeof p=="string"?(p=encodeURI(p).replace(S,Hh),I&&(p=p.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p):null}function Hh(p){return p=p.charCodeAt(0),"%"+(p>>4&15).toString(16)+(p&15).toString(16)}var Xh=/[#\/\?@]/g,Yh=/[#\?:]/g,al=/[#\?]/g,Sy=/[#\?@]/g,Zh=/#/g;function nt(p,S){this.h=this.g=null,this.i=p||null,this.j=!!S}function ss(p){p.g||(p.g=new Map,p.h=0,p.i&&Oi(p.i,function(S,I){p.add(decodeURIComponent(S.replace(/\+/g," ")),I)}))}n=nt.prototype,n.add=function(p,S){ss(this),this.i=null,p=os(this,p);let I=this.g.get(p);return I||this.g.set(p,I=[]),I.push(S),this.h+=1,this};function Qh(p,S){ss(p),S=os(p,S),p.g.has(S)&&(p.i=null,p.h-=p.g.get(S).length,p.g.delete(S))}function Dc(p,S){return ss(p),S=os(p,S),p.g.has(S)}n.forEach=function(p,S){ss(this),this.g.forEach(function(I,V){I.forEach(function(X){p.call(S,X,V,this)},this)},this)};function Jh(p,S){ss(p);let I=[];if(typeof S=="string")Dc(p,S)&&(I=I.concat(p.g.get(os(p,S))));else for(p=Array.from(p.g.values()),S=0;S<p.length;S++)I=I.concat(p[S]);return I}n.set=function(p,S){return ss(this),this.i=null,p=os(this,p),Dc(this,p)&&(this.h-=this.g.get(p).length),this.g.set(p,[S]),this.h+=1,this},n.get=function(p,S){return p?(p=Jh(this,p),p.length>0?String(p[0]):S):S};function ed(p,S,I){Qh(p,S),I.length>0&&(p.i=null,p.g.set(os(p,S),v(I)),p.h+=I.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const p=[],S=Array.from(this.g.keys());for(let V=0;V<S.length;V++){var I=S[V];const X=or(I);I=Jh(this,I);for(let Q=0;Q<I.length;Q++){let fe=X;I[Q]!==""&&(fe+="="+or(I[Q])),p.push(fe)}}return this.i=p.join("&")};function td(p){const S=new nt;return S.i=p.i,p.g&&(S.g=new Map(p.g),S.h=p.h),S}function os(p,S){return S=String(S),p.j&&(S=S.toLowerCase()),S}function Oc(p,S){S&&!p.j&&(ss(p),p.i=null,p.g.forEach(function(I,V){const X=V.toLowerCase();V!=X&&(Qh(this,V),ed(this,X,I))},p)),p.j=S}function as(p,S){const I=new Yt;if(o.Image){const V=new Image;V.onload=d(kn,I,"TestLoadImage: loaded",!0,S,V),V.onerror=d(kn,I,"TestLoadImage: error",!1,S,V),V.onabort=d(kn,I,"TestLoadImage: abort",!1,S,V),V.ontimeout=d(kn,I,"TestLoadImage: timeout",!1,S,V),o.setTimeout(function(){V.ontimeout&&V.ontimeout()},1e4),V.src=p}else S(!1)}function ls(p,S){const I=new Yt,V=new AbortController,X=setTimeout(()=>{V.abort(),kn(I,"TestPingServer: timeout",!1,S)},1e4);fetch(p,{signal:V.signal}).then(Q=>{clearTimeout(X),Q.ok?kn(I,"TestPingServer: ok",!0,S):kn(I,"TestPingServer: server error",!1,S)}).catch(()=>{clearTimeout(X),kn(I,"TestPingServer: error",!1,S)})}function kn(p,S,I,V,X){try{X&&(X.onload=null,X.onerror=null,X.onabort=null,X.ontimeout=null),V(I)}catch{}}function ll(){this.g=new Jr}function $s(p){this.i=p.Sb||null,this.h=p.ab||!1}g($s,rr),$s.prototype.g=function(){return new Vi(this.i,this.h)};function Vi(p,S){Rt.call(this),this.H=p,this.o=S,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}g(Vi,Rt),n=Vi.prototype,n.open=function(p,S){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=p,this.D=S,this.readyState=1,br(this)},n.send=function(p){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const S={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};p&&(S.body=p),(this.H||o).fetch(new Request(this.D,S)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Do(this)),this.readyState=0},n.Pa=function(p){if(this.g&&(this.l=p,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=p.headers,this.readyState=2,br(this)),this.g&&(this.readyState=3,br(this),this.g)))if(this.responseType==="arraybuffer")p.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in p){if(this.j=p.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;sm(this)}else p.text().then(this.Oa.bind(this),this.ga.bind(this))};function sm(p){p.j.read().then(p.Ma.bind(p)).catch(p.ga.bind(p))}n.Ma=function(p){if(this.g){if(this.o&&p.value)this.response.push(p.value);else if(!this.o){var S=p.value?p.value:new Uint8Array(0);(S=this.B.decode(S,{stream:!p.done}))&&(this.response=this.responseText+=S)}p.done?Do(this):br(this),this.readyState==3&&sm(this)}},n.Oa=function(p){this.g&&(this.response=this.responseText=p,Do(this))},n.Na=function(p){this.g&&(this.response=p,Do(this))},n.ga=function(){this.g&&Do(this)};function Do(p){p.readyState=4,p.l=null,p.j=null,p.B=null,br(p)}n.setRequestHeader=function(p,S){this.A.append(p,S)},n.getResponseHeader=function(p){return this.h&&this.h.get(p.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const p=[],S=this.h.entries();for(var I=S.next();!I.done;)I=I.value,p.push(I[0]+": "+I[1]),I=S.next();return p.join(`\r
`)};function br(p){p.onreadystatechange&&p.onreadystatechange.call(p)}Object.defineProperty(Vi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(p){this.m=p?"include":"same-origin"}});function om(p){let S="";return ae(p,function(I,V){S+=V,S+=":",S+=I,S+=`\r
`}),S}function Vc(p,S,I){e:{for(V in I){var V=!1;break e}V=!0}V||(I=om(I),typeof p=="string"?I!=null&&or(I):dt(p,S,I))}function At(p){Rt.call(this),this.headers=new Map,this.L=p||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}g(At,Rt);var am=/^https?$/i,Ty=["POST","PUT"];n=At.prototype,n.Fa=function(p){this.H=p},n.ea=function(p,S,I,V){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+p);S=S?S.toUpperCase():"GET",this.D=p,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():rn.g(),this.g.onreadystatechange=m(h(this.Ca,this));try{this.B=!0,this.g.open(S,String(p),!0),this.B=!1}catch(Q){Oo(this,Q);return}if(p=I||"",I=new Map(this.headers),V)if(Object.getPrototypeOf(V)===Object.prototype)for(var X in V)I.set(X,V[X]);else if(typeof V.keys=="function"&&typeof V.get=="function")for(const Q of V.keys())I.set(Q,V.get(Q));else throw Error("Unknown input type for opt_headers: "+String(V));V=Array.from(I.keys()).find(Q=>Q.toLowerCase()=="content-type"),X=o.FormData&&p instanceof o.FormData,!(Array.prototype.indexOf.call(Ty,S,void 0)>=0)||V||X||I.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Q,fe]of I)this.g.setRequestHeader(Q,fe);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(p),this.v=!1}catch(Q){Oo(this,Q)}};function Oo(p,S){p.h=!1,p.g&&(p.j=!0,p.g.abort(),p.j=!1),p.l=S,p.o=5,Vo(p),Ks(p)}function Vo(p){p.A||(p.A=!0,vt(p,"complete"),vt(p,"error"))}n.abort=function(p){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=p||7,vt(this,"complete"),vt(this,"abort"),Ks(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ks(this,!0)),At.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Ws(this):this.Xa())},n.Xa=function(){Ws(this)};function Ws(p){if(p.h&&typeof s<"u"){if(p.v&&cs(p)==4)setTimeout(p.Ca.bind(p),0);else if(vt(p,"readystatechange"),cs(p)==4){p.h=!1;try{const Q=p.ca();e:switch(Q){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var S=!0;break e;default:S=!1}var I;if(!(I=S)){var V;if(V=Q===0){let fe=String(p.D).match(rm)[1]||null;!fe&&o.self&&o.self.location&&(fe=o.self.location.protocol.slice(0,-1)),V=!am.test(fe?fe.toLowerCase():"")}I=V}if(I)vt(p,"complete"),vt(p,"success");else{p.o=6;try{var X=cs(p)>2?p.g.statusText:""}catch{X=""}p.l=X+" ["+p.ca()+"]",Vo(p)}}finally{Ks(p)}}}}function Ks(p,S){if(p.g){p.m&&(clearTimeout(p.m),p.m=null);const I=p.g;p.g=null,S||vt(p,"ready");try{I.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function cs(p){return p.g?p.g.readyState:0}n.ca=function(){try{return cs(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(p){if(this.g){var S=this.g.responseText;return p&&S.indexOf(p)==0&&(S=S.substring(p.length)),Ja(S)}};function lm(p){try{if(!p.g)return null;if("response"in p.g)return p.g.response;switch(p.F){case"":case"text":return p.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in p.g)return p.g.mozResponseArrayBuffer}return null}catch{return null}}function nd(p){const S={};p=(p.g&&cs(p)>=2&&p.g.getAllResponseHeaders()||"").split(`\r
`);for(let V=0;V<p.length;V++){if(O(p[V]))continue;var I=bc(p[V]);const X=I[0];if(I=I[1],typeof I!="string")continue;I=I.trim();const Q=S[X]||[];S[X]=Q,Q.push(I)}ie(S,function(V){return V.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function us(p,S,I){return I&&I.internalChannelParams&&I.internalChannelParams[p]||S}function Fc(p){this.za=0,this.i=[],this.j=new Yt,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=us("failFast",!1,p),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=us("baseRetryDelayMs",5e3,p),this.Za=us("retryDelaySeedMs",1e4,p),this.Ta=us("forwardChannelMaxRetries",2,p),this.va=us("forwardChannelRequestTimeoutMs",2e4,p),this.ma=p&&p.xmlHttpFactory||void 0,this.Ua=p&&p.Rb||void 0,this.Aa=p&&p.useFetchStreams||!1,this.O=void 0,this.L=p&&p.supportsCrossDomainXhr||!1,this.M="",this.h=new Lc(p&&p.concurrentRequestLimit),this.Ba=new ll,this.S=p&&p.fastHandshake||!1,this.R=p&&p.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=p&&p.Pb||!1,p&&p.ua&&this.j.ua(),p&&p.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&p&&p.detectBufferingProxy||!1,this.ia=void 0,p&&p.longPollingTimeout&&p.longPollingTimeout>0&&(this.ia=p.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Fc.prototype,n.ka=8,n.I=1,n.connect=function(p,S,I,V){It(0),this.W=p,this.H=S||{},I&&V!==void 0&&(this.H.OSID=I,this.H.OAID=V),this.F=this.X,this.J=rd(this,null,this.W),qs(this)};function jc(p){if(Gc(p),p.I==3){var S=p.V++,I=lr(p.J);if(dt(I,"SID",p.M),dt(I,"RID",S),dt(I,"TYPE","terminate"),hs(p,I),S=new ar(p,p.j,S),S.M=2,S.A=Bs(lr(I)),I=!1,o.navigator&&o.navigator.sendBeacon)try{I=o.navigator.sendBeacon(S.A.toString(),"")}catch{}!I&&o.Image&&(new Image().src=S.A,I=!0),I||(S.g=um(S.j,null),S.g.ea(S.A)),S.F=Date.now(),el(S)}hl(p)}function Fi(p){p.g&&(ul(p),p.g.cancel(),p.g=null)}function Gc(p){Fi(p),p.v&&(o.clearTimeout(p.v),p.v=null),Uc(p),p.h.cancel(),p.m&&(typeof p.m=="number"&&o.clearTimeout(p.m),p.m=null)}function qs(p){if(!Kh(p.h)&&!p.m){p.m=!0;var S=p.Ea;D||R(),z||(D(),z=!0),k.add(S,p),p.D=0}}function cm(p,S){return nl(p.h)>=p.h.j-(p.m?1:0)?!1:p.m?(p.i=S.G.concat(p.i),!0):p.I==1||p.I==2||p.D>=(p.Sa?0:p.Ta)?!1:(p.m=Cr(h(p.Ea,p,S),Bc(p,p.D)),p.D++,!0)}n.Ea=function(p){if(this.m)if(this.m=null,this.I==1){if(!p){this.V=Math.floor(Math.random()*1e5),p=this.V++;const X=new ar(this,this.j,p);let Q=this.o;if(this.U&&(Q?(Q=$(Q),Ae(Q,this.U)):Q=this.U),this.u!==null||this.R||(X.J=Q,Q=null),this.S)e:{for(var S=0,I=0;I<this.i.length;I++){t:{var V=this.i[I];if("__data__"in V.map&&(V=V.map.__data__,typeof V=="string")){V=V.length;break t}V=void 0}if(V===void 0)break;if(S+=V,S>4096){S=I;break e}if(S===4096||I===this.i.length-1){S=I+1;break e}}S=1e3}else S=1e3;S=id(this,X,S),I=lr(this.J),dt(I,"RID",p),dt(I,"CVER",22),this.G&&dt(I,"X-HTTP-Session-Id",this.G),hs(this,I),Q&&(this.R?S="headers="+or(om(Q))+"&"+S:this.u&&Vc(I,this.u,Q)),Nc(this.h,X),this.Ra&&dt(I,"TYPE","init"),this.S?(dt(I,"$req",S),dt(I,"SID","null"),X.U=!0,Mr(X,I,null)):Mr(X,I,S),this.I=2}}else this.I==3&&(p?cl(this,p):this.i.length==0||Kh(this.h)||cl(this))};function cl(p,S){var I;S?I=S.l:I=p.V++;const V=lr(p.J);dt(V,"SID",p.M),dt(V,"RID",I),dt(V,"AID",p.K),hs(p,V),p.u&&p.o&&Vc(V,p.u,p.o),I=new ar(p,p.j,I,p.D+1),p.u===null&&(I.J=p.o),S&&(p.i=S.G.concat(p.i)),S=id(p,I,1e3),I.H=Math.round(p.va*.5)+Math.round(p.va*.5*Math.random()),Nc(p.h,I),Mr(I,V,S)}function hs(p,S){p.H&&ae(p.H,function(I,V){dt(S,V,I)}),p.l&&ae({},function(I,V){dt(S,V,I)})}function id(p,S,I){I=Math.min(p.i.length,I);const V=p.l?h(p.l.Ka,p.l,p):null;e:{var X=p.i;let qe=-1;for(;;){const Qt=["count="+I];qe==-1?I>0?(qe=X[0].g,Qt.push("ofs="+qe)):qe=0:Qt.push("ofs="+qe);let Et=!0;for(let sn=0;sn<I;sn++){var Q=X[sn].g;const Gi=X[sn].map;if(Q-=qe,Q<0)qe=Math.max(0,X[sn].g-100),Et=!1;else try{Q="req"+Q+"_"||"";try{var fe=Gi instanceof Map?Gi:Object.entries(Gi);for(const[Hs,fs]of fe){let gs=fs;a(fs)&&(gs=Qr(fs)),Qt.push(Q+Hs+"="+encodeURIComponent(gs))}}catch(Hs){throw Qt.push(Q+"type="+encodeURIComponent("_badmap")),Hs}}catch{V&&V(Gi)}}if(Et){fe=Qt.join("&");break e}}fe=void 0}return p=p.i.splice(0,I),S.G=p,fe}function zn(p){if(!p.g&&!p.v){p.Y=1;var S=p.Da;D||R(),z||(D(),z=!0),k.add(S,p),p.A=0}}function ds(p){return p.g||p.v||p.A>=3?!1:(p.Y++,p.v=Cr(h(p.Da,p),Bc(p,p.A)),p.A++,!0)}n.Da=function(){if(this.v=null,Fo(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var p=4*this.T;this.j.info("BP detection timer enabled: "+p),this.B=Cr(h(this.Wa,this),p)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,It(10),Fi(this),Fo(this))};function ul(p){p.B!=null&&(o.clearTimeout(p.B),p.B=null)}function Fo(p){p.g=new ar(p,p.j,"rpc",p.Y),p.u===null&&(p.g.J=p.o),p.g.P=0;var S=lr(p.na);dt(S,"RID","rpc"),dt(S,"SID",p.M),dt(S,"AID",p.K),dt(S,"CI",p.F?"0":"1"),!p.F&&p.ia&&dt(S,"TO",p.ia),dt(S,"TYPE","xmlhttp"),hs(p,S),p.u&&p.o&&Vc(S,p.u,p.o),p.O&&(p.g.H=p.O);var I=p.g;p=p.ba,I.M=1,I.A=Bs(lr(S)),I.u=null,I.R=!0,$h(I,p)}n.Va=function(){this.C!=null&&(this.C=null,Fi(this),ds(this),It(19))};function Uc(p){p.C!=null&&(o.clearTimeout(p.C),p.C=null)}function zc(p,S){var I=null;if(p.g==S){Uc(p),ul(p),p.g=null;var V=2}else if(qh(p.h,S))I=S.G,il(p.h,S),V=1;else return;if(p.I!=0){if(S.o)if(V==1){I=S.u?S.u.length:0,S=Date.now()-S.F;var X=p.D;V=ts(),vt(V,new Lo(V,I)),qs(p)}else zn(p);else if(X=S.m,X==3||X==0&&S.X>0||!(V==1&&cm(p,S)||V==2&&ds(p)))switch(I&&I.length>0&&(S=p.h,S.i=S.i.concat(I)),X){case 1:ji(p,5);break;case 4:ji(p,10);break;case 3:ji(p,6);break;default:ji(p,2)}}}function Bc(p,S){let I=p.Qa+Math.floor(Math.random()*p.Za);return p.isActive()||(I*=2),I*S}function ji(p,S){if(p.j.info("Error code "+S),S==2){var I=h(p.bb,p),V=p.Ua;const X=!V;V=new is(V||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||rl(V,"https"),Bs(V),X?as(V.toString(),I):ls(V.toString(),I)}else It(2);p.I=0,p.l&&p.l.pa(S),hl(p),Gc(p)}n.bb=function(p){p?(this.j.info("Successfully pinged google.com"),It(2)):(this.j.info("Failed to ping google.com"),It(1))};function hl(p){if(p.I=0,p.ja=[],p.l){const S=Di(p.h);(S.length!=0||p.i.length!=0)&&(y(p.ja,S),y(p.ja,p.i),p.h.i.length=0,v(p.i),p.i.length=0),p.l.oa()}}function rd(p,S,I){var V=I instanceof is?lr(I):new is(I);if(V.g!="")S&&(V.g=S+"."+V.g),rs(V,V.u);else{var X=o.location;V=X.protocol,S=S?S+"."+X.hostname:X.hostname,X=+X.port;const Q=new is(null);V&&rl(Q,V),S&&(Q.g=S),X&&rs(Q,X),I&&(Q.h=I),V=Q}return I=p.G,S=p.wa,I&&S&&dt(V,I,S),dt(V,"VER",p.ka),hs(p,V),V}function um(p,S,I){if(S&&!p.L)throw Error("Can't create secondary domain capable XhrIo object.");return S=p.Aa&&!p.ma?new At(new $s({ab:I})):new At(p.ma),S.Fa(p.L),S}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function hm(){}n=hm.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function $c(){}$c.prototype.g=function(p,S){return new Ln(p,S)};function Ln(p,S){Rt.call(this),this.g=new Fc(S),this.l=p,this.h=S&&S.messageUrlParams||null,p=S&&S.messageHeaders||null,S&&S.clientProtocolHeaderRequired&&(p?p["X-Client-Protocol"]="webchannel":p={"X-Client-Protocol":"webchannel"}),this.g.o=p,p=S&&S.initMessageHeaders||null,S&&S.messageContentType&&(p?p["X-WebChannel-Content-Type"]=S.messageContentType:p={"X-WebChannel-Content-Type":S.messageContentType}),S&&S.sa&&(p?p["X-WebChannel-Client-Profile"]=S.sa:p={"X-WebChannel-Client-Profile":S.sa}),this.g.U=p,(p=S&&S.Qb)&&!O(p)&&(this.g.u=p),this.A=S&&S.supportsCrossDomainXhr||!1,this.v=S&&S.sendRawJson||!1,(S=S&&S.httpSessionIdParam)&&!O(S)&&(this.g.G=S,p=this.h,p!==null&&S in p&&(p=this.h,S in p&&delete p[S])),this.j=new jo(this)}g(Ln,Rt),Ln.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Ln.prototype.close=function(){jc(this.g)},Ln.prototype.o=function(p){var S=this.g;if(typeof p=="string"){var I={};I.__data__=p,p=I}else this.v&&(I={},I.__data__=Qr(p),p=I);S.i.push(new xy(S.Ya++,p)),S.I==3&&qs(S)},Ln.prototype.N=function(){this.g.l=null,delete this.j,jc(this.g),delete this.g,Ln.Z.N.call(this)};function dm(p){Gs.call(this),p.__headers__&&(this.headers=p.__headers__,this.statusCode=p.__status__,delete p.__headers__,delete p.__status__);var S=p.__sm__;if(S){e:{for(const I in S){p=I;break e}p=void 0}(this.i=p)&&(p=this.i,S=S!==null&&p in S?S[p]:void 0),this.data=S}else this.data=p}g(dm,Gs);function fm(){ko.call(this),this.status=1}g(fm,ko);function jo(p){this.g=p}g(jo,hm),jo.prototype.ra=function(){vt(this.g,"a")},jo.prototype.qa=function(p){vt(this.g,new dm(p))},jo.prototype.pa=function(p){vt(this.g,new fm)},jo.prototype.oa=function(){vt(this.g,"b")},$c.prototype.createWebChannel=$c.prototype.g,Ln.prototype.send=Ln.prototype.o,Ln.prototype.open=Ln.prototype.m,Ln.prototype.close=Ln.prototype.close,tk=function(){return new $c},ek=function(){return ts()},J4=ri,UE={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},En.NO_ERROR=0,En.TIMEOUT=8,En.HTTP_ERROR=6,Gp=En,ht.COMPLETE="complete",Q4=ht,Mc.EventType=es,es.OPEN="a",es.CLOSE="b",es.ERROR="c",es.MESSAGE="d",Rt.prototype.listen=Rt.prototype.J,Zd=Mc,At.prototype.listenOnce=At.prototype.K,At.prototype.getLastError=At.prototype.Ha,At.prototype.getLastErrorCode=At.prototype.ya,At.prototype.getStatus=At.prototype.ca,At.prototype.getResponseJson=At.prototype.La,At.prototype.getResponseText=At.prototype.la,At.prototype.send=At.prototype.ea,At.prototype.setWithCredentials=At.prototype.Fa,Z4=At}).apply(typeof Ep<"u"?Ep:typeof self<"u"?self:typeof window<"u"?window:{});const _R="@firebase/firestore",yR="4.9.3";class Fn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Fn.UNAUTHENTICATED=new Fn(null),Fn.GOOGLE_CREDENTIALS=new Fn("google-credentials-uid"),Fn.FIRST_PARTY=new Fn("first-party-uid"),Fn.MOCK_USER=new Fn("mock-user");let Nh="12.7.0";const uc=new Mx("@firebase/firestore");function Cu(){return uc.logLevel}function ue(n,...e){if(uc.logLevel<=et.DEBUG){const t=e.map(Lx);uc.debug(`Firestore (${Nh}): ${n}`,...t)}}function ui(n,...e){if(uc.logLevel<=et.ERROR){const t=e.map(Lx);uc.error(`Firestore (${Nh}): ${n}`,...t)}}function hc(n,...e){if(uc.logLevel<=et.WARN){const t=e.map(Lx);uc.warn(`Firestore (${Nh}): ${n}`,...t)}}function Lx(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function Se(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,nk(n,i,t)}function nk(n,e,t){let i=`FIRESTORE (${Nh}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw ui(i),new Error(i)}function Ce(n,e,t,i){let r="Unexpected state";typeof t=="string"?r=t:i=t,n||nk(e,r,i)}function We(n,e){return n}const ee={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class me extends Vs{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class mo{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class ik{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class ej{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Fn.UNAUTHENTICATED)))}shutdown(){}}class tj{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class nj{constructor(e){this.t=e,this.currentUser=Fn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ce(this.o===void 0,42304);let i=this.i;const r=c=>this.i!==i?(i=this.i,t(c)):Promise.resolve();let s=new mo;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new mo,e.enqueueRetryable((()=>r(this.currentUser)))};const o=()=>{const c=s;e.enqueueRetryable((async()=>{await c.promise,await r(this.currentUser)}))},a=c=>{ue("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((c=>a(c))),setTimeout((()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?a(c):(ue("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new mo)}}),0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(ue("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Ce(typeof i.accessToken=="string",31837,{l:i}),new ik(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ce(e===null||typeof e=="string",2055,{h:e}),new Fn(e)}}class ij{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=Fn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class rj{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new ij(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Fn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class vR{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class sj{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Wr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Ce(this.o===void 0,3512);const i=s=>{s.error!=null&&ue("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,ue("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable((()=>i(s)))};const r=s=>{ue("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((s=>r(s))),setTimeout((()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?r(s):ue("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new vR(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Ce(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new vR(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function oj(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}class Nx{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const r=oj(40);for(let s=0;s<r.length;++s)i.length<20&&r[s]<t&&(i+=e.charAt(r[s]%62))}return i}}function $e(n,e){return n<e?-1:n>e?1:0}function zE(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++){const r=n.charAt(i),s=e.charAt(i);if(r!==s)return b1(r)===b1(s)?$e(r,s):b1(r)?1:-1}return $e(n.length,e.length)}const aj=55296,lj=57343;function b1(n){const e=n.charCodeAt(0);return e>=aj&&e<=lj}function gh(n,e,t){return n.length===e.length&&n.every(((i,r)=>t(i,e[r])))}function rk(n){return n+"\0"}const ER="__name__";class vs{constructor(e,t,i){t===void 0?t=0:t>e.length&&Se(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&Se(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return vs.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof vs?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let r=0;r<i;r++){const s=vs.compareSegments(e.get(r),t.get(r));if(s!==0)return s}return $e(e.length,t.length)}static compareSegments(e,t){const i=vs.isNumericId(e),r=vs.isNumericId(t);return i&&!r?-1:!i&&r?1:i&&r?vs.extractNumericId(e).compare(vs.extractNumericId(t)):zE(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ba.fromString(e.substring(4,e.length-2))}}class gt extends vs{construct(e,t,i){return new gt(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new me(ee.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((r=>r.length>0)))}return new gt(t)}static emptyPath(){return new gt([])}}const cj=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Bt extends vs{construct(e,t,i){return new Bt(e,t,i)}static isValidIdentifier(e){return cj.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Bt.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===ER}static keyField(){return new Bt([ER])}static fromServerFormat(e){const t=[];let i="",r=0;const s=()=>{if(i.length===0)throw new me(ee.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let o=!1;for(;r<e.length;){const a=e[r];if(a==="\\"){if(r+1===e.length)throw new me(ee.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[r+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new me(ee.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=c,r+=2}else a==="`"?(o=!o,r++):a!=="."||o?(i+=a,r++):(s(),r++)}if(s(),o)throw new me(ee.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Bt(t)}static emptyPath(){return new Bt([])}}class pe{constructor(e){this.path=e}static fromPath(e){return new pe(gt.fromString(e))}static fromName(e){return new pe(gt.fromString(e).popFirst(5))}static empty(){return new pe(gt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&gt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return gt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new pe(new gt(e.slice()))}}function sk(n,e,t){if(!t)throw new me(ee.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function uj(n,e,t,i){if(e===!0&&i===!0)throw new me(ee.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function wR(n){if(!pe.isDocumentKey(n))throw new me(ee.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function xR(n){if(pe.isDocumentKey(n))throw new me(ee.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function ok(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function $_(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Se(12329,{type:typeof n})}function Fa(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new me(ee.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=$_(n);throw new me(ee.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function ln(n,e){const t={typeString:n};return e&&(t.value=e),t}function bg(n,e){if(!ok(n))throw new me(ee.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const r=e[i].typeString,s="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const o=n[i];if(r&&typeof o!==r){t=`JSON field '${i}' must be a ${r}.`;break}if(s!==void 0&&o!==s.value){t=`Expected '${i}' field to equal '${s.value}'`;break}}if(t)throw new me(ee.INVALID_ARGUMENT,t);return!0}const SR=-62135596800,TR=1e6;class xt{static now(){return xt.fromMillis(Date.now())}static fromDate(e){return xt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*TR);return new xt(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new me(ee.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new me(ee.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<SR)throw new me(ee.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new me(ee.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/TR}_compareTo(e){return this.seconds===e.seconds?$e(this.nanoseconds,e.nanoseconds):$e(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:xt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(bg(e,xt._jsonSchema))return new xt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-SR;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}xt._jsonSchemaVersion="firestore/timestamp/1.0",xt._jsonSchema={type:ln("string",xt._jsonSchemaVersion),seconds:ln("number"),nanoseconds:ln("number")};class be{static fromTimestamp(e){return new be(e)}static min(){return new be(new xt(0,0))}static max(){return new be(new xt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const qf=-1;class k0{constructor(e,t,i,r){this.indexId=e,this.collectionGroup=t,this.fields=i,this.indexState=r}}function BE(n){return n.fields.find((e=>e.kind===2))}function bl(n){return n.fields.filter((e=>e.kind!==2))}k0.UNKNOWN_ID=-1;class Up{constructor(e,t){this.fieldPath=e,this.kind=t}}class Hf{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Hf(0,Ji.min())}}function hj(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=be.fromTimestamp(i===1e9?new xt(t+1,0):new xt(t,i));return new Ji(r,pe.empty(),e)}function ak(n){return new Ji(n.readTime,n.key,qf)}class Ji{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new Ji(be.min(),pe.empty(),qf)}static max(){return new Ji(be.max(),pe.empty(),qf)}}function Dx(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=pe.comparator(n.documentKey,e.documentKey),t!==0?t:$e(n.largestBatchId,e.largestBatchId))}const lk="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class ck{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Ac(n){if(n.code!==ee.FAILED_PRECONDITION||n.message!==lk)throw n;ue("LocalStore","Unexpectedly lost primary lease")}class q{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Se(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new q(((i,r)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(i,r)},this.catchCallback=s=>{this.wrapFailure(t,s).next(i,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof q?t:q.resolve(t)}catch(t){return q.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):q.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):q.reject(t)}static resolve(e){return new q(((t,i)=>{t(e)}))}static reject(e){return new q(((t,i)=>{i(e)}))}static waitFor(e){return new q(((t,i)=>{let r=0,s=0,o=!1;e.forEach((a=>{++r,a.next((()=>{++s,o&&s===r&&t()}),(c=>i(c)))})),o=!0,s===r&&t()}))}static or(e){let t=q.resolve(!1);for(const i of e)t=t.next((r=>r?q.resolve(r):i()));return t}static forEach(e,t){const i=[];return e.forEach(((r,s)=>{i.push(t.call(this,r,s))})),this.waitFor(i)}static mapArray(e,t){return new q(((i,r)=>{const s=e.length,o=new Array(s);let a=0;for(let c=0;c<s;c++){const h=c;t(e[h]).next((d=>{o[h]=d,++a,a===s&&i(o)}),(d=>r(d)))}}))}static doWhile(e,t){return new q(((i,r)=>{const s=()=>{e()===!0?t().next((()=>{s()}),r):i()};s()}))}}const Wi="SimpleDb";class W_{static open(e,t,i,r){try{return new W_(t,e.transaction(r,i))}catch(s){throw new df(t,s)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new mo,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new df(e,t.error)):this.S.resolve()},this.transaction.onerror=i=>{const r=Ox(i.target.error);this.S.reject(new df(e,r))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(ue(Wi,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new fj(t)}}class ka{static delete(e){return ue(Wi,"Removing database:",e),Vl(D4().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!$4())return!1;if(ka.F())return!0;const e=pn(),t=ka.M(e),i=0<t&&t<10,r=uk(e),s=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||i||s)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),i=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(i)}constructor(e,t,i){this.name=e,this.version=t,this.N=i,this.B=null,ka.M(pn())===12.2&&ui("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(ue(Wi,"Opening database:",this.name),this.db=await new Promise(((t,i)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=s=>{const o=s.target.result;t(o)},r.onblocked=()=>{i(new df(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=s=>{const o=s.target.error;o.name==="VersionError"?i(new me(ee.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?i(new me(ee.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):i(new df(e,o))},r.onupgradeneeded=s=>{ue(Wi,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.N.k(o,r.transaction,s.oldVersion,this.version).next((()=>{ue(Wi,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,i,r){const s=t==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const a=W_.open(this.db,e,s?"readonly":"readwrite",i),c=r(a).next((h=>(a.C(),h))).catch((h=>(a.abort(h),q.reject(h)))).toPromise();return c.catch((()=>{})),await a.D,c}catch(a){const c=a,h=c.name!=="FirebaseError"&&o<3;if(ue(Wi,"Transaction failed with error:",c.message,"Retrying:",h),this.close(),!h)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}function uk(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class dj{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return Vl(this.U.delete())}}class df extends me{constructor(e,t){super(ee.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Xa(n){return n.name==="IndexedDbTransactionError"}class fj{constructor(e){this.store=e}put(e,t){let i;return t!==void 0?(ue(Wi,"PUT",this.store.name,e,t),i=this.store.put(t,e)):(ue(Wi,"PUT",this.store.name,"<auto-key>",e),i=this.store.put(e)),Vl(i)}add(e){return ue(Wi,"ADD",this.store.name,e,e),Vl(this.store.add(e))}get(e){return Vl(this.store.get(e)).next((t=>(t===void 0&&(t=null),ue(Wi,"GET",this.store.name,e,t),t)))}delete(e){return ue(Wi,"DELETE",this.store.name,e),Vl(this.store.delete(e))}count(){return ue(Wi,"COUNT",this.store.name),Vl(this.store.count())}J(e,t){const i=this.options(e,t),r=i.index?this.store.index(i.index):this.store;if(typeof r.getAll=="function"){const s=r.getAll(i.range);return new q(((o,a)=>{s.onerror=c=>{a(c.target.error)},s.onsuccess=c=>{o(c.target.result)}}))}{const s=this.cursor(i),o=[];return this.H(s,((a,c)=>{o.push(c)})).next((()=>o))}}Y(e,t){const i=this.store.getAll(e,t===null?void 0:t);return new q(((r,s)=>{i.onerror=o=>{s(o.target.error)},i.onsuccess=o=>{r(o.target.result)}}))}Z(e,t){ue(Wi,"DELETE ALL",this.store.name);const i=this.options(e,t);i.X=!1;const r=this.cursor(i);return this.H(r,((s,o,a)=>a.delete()))}ee(e,t){let i;t?i=e:(i={},t=e);const r=this.cursor(i);return this.H(r,t)}te(e){const t=this.cursor({});return new q(((i,r)=>{t.onerror=s=>{const o=Ox(s.target.error);r(o)},t.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next((a=>{a?o.continue():i()})):i()}}))}H(e,t){const i=[];return new q(((r,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void r();const c=new dj(a),h=t(a.primaryKey,a.value,c);if(h instanceof q){const d=h.catch((g=>(c.done(),q.reject(g))));i.push(d)}c.isDone?r():c.G===null?a.continue():a.continue(c.G)}})).next((()=>q.waitFor(i)))}options(e,t){let i;return e!==void 0&&(typeof e=="string"?i=e:t=e),{index:i,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const i=this.store.index(e.index);return e.X?i.openKeyCursor(e.range,t):i.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Vl(n){return new q(((e,t)=>{n.onsuccess=i=>{const r=i.target.result;e(r)},n.onerror=i=>{const r=Ox(i.target.error);t(r)}}))}let IR=!1;function Ox(n){const e=ka.M(pn());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const i=new me("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return IR||(IR=!0,setTimeout((()=>{throw i}),0)),i}}return n}const ff="IndexBackfiller";class gj{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){ue(ff,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();ue(ff,`Documents written: ${t}`)}catch(t){Xa(t)?ue(ff,"Ignoring IndexedDB error during index backfill: ",t):await Ac(t)}await this.re(6e4)}))}}class mj{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const i=new Set;let r=t,s=!0;return q.doWhile((()=>s===!0&&r>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((o=>{if(o!==null&&!i.has(o))return ue(ff,`Processing collection: ${o}`),this.oe(e,o,r).next((a=>{r-=a,i.add(o)}));s=!1})))).next((()=>t-r))}oe(e,t,i){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((r=>this.localStore.localDocuments.getNextDocuments(e,t,r,i).next((s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next((()=>this._e(r,s))).next((a=>(ue(ff,`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a)))).next((()=>o.size))}))))}_e(e,t){let i=e;return t.changes.forEach(((r,s)=>{const o=ak(s);Dx(o,i)>0&&(i=o)})),new Ji(i.readTime,i.documentKey,Math.max(t.batchId,e.largestBatchId))}}class Sr{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Sr.ce=-1;const Yl=-1;function K_(n){return n==null}function Xf(n){return n===0&&1/n==-1/0}function pj(n){return typeof n=="number"&&Number.isInteger(n)&&!Xf(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const L0="";function ni(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=AR(e)),e=_j(n.get(t),e);return AR(e)}function _j(n,e){let t=e;const i=n.length;for(let r=0;r<i;r++){const s=n.charAt(r);switch(s){case"\0":t+="";break;case L0:t+="";break;default:t+=s}}return t}function AR(n){return n+L0+""}function Ts(n){const e=n.length;if(Ce(e>=2,64408,{path:n}),e===2)return Ce(n.charAt(0)===L0&&n.charAt(1)==="",56145,{path:n}),gt.emptyPath();const t=e-2,i=[];let r="";for(let s=0;s<e;){const o=n.indexOf(L0,s);switch((o<0||o>t)&&Se(50515,{path:n}),n.charAt(o+1)){case"":const a=n.substring(s,o);let c;r.length===0?c=a:(r+=a,c=r,r=""),i.push(c);break;case"":r+=n.substring(s,o),r+="\0";break;case"":r+=n.substring(s,o+1);break;default:Se(61167,{path:n})}s=o+2}return new gt(i)}const kl="remoteDocuments",kg="owner",vu="owner",Yf="mutationQueues",yj="userId",Ur="mutations",RR="batchId",Kl="userMutationsIndex",PR=["userId","batchId"];function zp(n,e){return[n,ni(e)]}function hk(n,e,t){return[n,ni(e),t]}const vj={},mh="documentMutations",N0="remoteDocumentsV14",Ej=["prefixPath","collectionGroup","readTime","documentId"],Bp="documentKeyIndex",wj=["prefixPath","collectionGroup","documentId"],dk="collectionGroupIndex",xj=["collectionGroup","readTime","prefixPath","documentId"],Zf="remoteDocumentGlobal",$E="remoteDocumentGlobalKey",ph="targets",fk="queryTargetsIndex",Sj=["canonicalId","targetId"],_h="targetDocuments",Tj=["targetId","path"],Vx="documentTargetsIndex",Ij=["path","targetId"],D0="targetGlobalKey",Zl="targetGlobal",Qf="collectionParents",Aj=["collectionId","parent"],yh="clientMetadata",Rj="clientId",q_="bundles",Pj="bundleId",H_="namedQueries",Cj="name",Fx="indexConfiguration",Mj="indexId",WE="collectionGroupIndex",bj="collectionGroup",gf="indexState",kj=["indexId","uid"],gk="sequenceNumberIndex",Lj=["uid","sequenceNumber"],mf="indexEntries",Nj=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],mk="documentKeyIndex",Dj=["indexId","uid","orderedDocumentKey"],X_="documentOverlays",Oj=["userId","collectionPath","documentId"],KE="collectionPathOverlayIndex",Vj=["userId","collectionPath","largestBatchId"],pk="collectionGroupOverlayIndex",Fj=["userId","collectionGroup","largestBatchId"],jx="globals",jj="name",_k=[Yf,Ur,mh,kl,ph,kg,Zl,_h,yh,Zf,Qf,q_,H_],Gj=[..._k,X_],yk=[Yf,Ur,mh,N0,ph,kg,Zl,_h,yh,Zf,Qf,q_,H_,X_],vk=yk,Gx=[...vk,Fx,gf,mf],Uj=Gx,Ek=[...Gx,jx],zj=Ek;class qE extends ck{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function yn(n,e){const t=We(n);return ka.O(t.le,e)}function CR(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Ya(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function wk(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class jt{constructor(e,t){this.comparator=e,this.root=t||jn.EMPTY}insert(e,t){return new jt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,jn.BLACK,null,null))}remove(e){return new jt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,jn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const r=this.comparator(e,i.key);if(r===0)return t+i.left.size;r<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new wp(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new wp(this.root,e,this.comparator,!1)}getReverseIterator(){return new wp(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new wp(this.root,e,this.comparator,!0)}}class wp{constructor(e,t,i,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?i(e.key,t):1,t&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class jn{constructor(e,t,i,r,s){this.key=e,this.value=t,this.color=i??jn.RED,this.left=r??jn.EMPTY,this.right=s??jn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,r,s){return new jn(e??this.key,t??this.value,i??this.color,r??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let r=this;const s=i(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,t,i),null):s===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return jn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return jn.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,jn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,jn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Se(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Se(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Se(27949);return e+(this.isRed()?0:1)}}jn.EMPTY=null,jn.RED=!0,jn.BLACK=!1;jn.EMPTY=new class{constructor(){this.size=0}get key(){throw Se(57766)}get value(){throw Se(16141)}get color(){throw Se(16727)}get left(){throw Se(29726)}get right(){throw Se(36894)}copy(e,t,i,r,s){return this}insert(e,t,i){return new jn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Tt{constructor(e){this.comparator=e,this.data=new jt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new MR(this.data.getIterator())}getIteratorFrom(e){return new MR(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof Tt)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=i.getNext().key;if(this.comparator(r,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Tt(this.comparator);return t.data=e,t}}class MR{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Eu(n){return n.hasNext()?n.getNext():void 0}class bi{constructor(e){this.fields=e,e.sort(Bt.comparator)}static empty(){return new bi([])}unionWith(e){let t=new Tt(Bt.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new bi(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return gh(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}class xk extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class cn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(r){try{return atob(r)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new xk("Invalid base64 string: "+s):s}})(e);return new cn(t)}static fromUint8Array(e){const t=(function(r){let s="";for(let o=0;o<r.length;++o)s+=String.fromCharCode(r[o]);return s})(e);return new cn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return $e(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}cn.EMPTY_BYTE_STRING=new cn("");const Bj=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Eo(n){if(Ce(!!n,39018),typeof n=="string"){let e=0;const t=Bj.exec(n);if(Ce(!!t,46558,{timestamp:n}),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Vt(n.seconds),nanos:Vt(n.nanos)}}function Vt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function wo(n){return typeof n=="string"?cn.fromBase64String(n):cn.fromUint8Array(n)}const Sk="server_timestamp",Tk="__type__",Ik="__previous_value__",Ak="__local_write_time__";function Ux(n){return(n?.mapValue?.fields||{})[Tk]?.stringValue===Sk}function Y_(n){const e=n.mapValue.fields[Ik];return Ux(e)?Y_(e):e}function Jf(n){const e=Eo(n.mapValue.fields[Ak].timestampValue);return new xt(e.seconds,e.nanos)}class $j{constructor(e,t,i,r,s,o,a,c,h,d){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=r,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=h,this.isUsingEmulator=d}}const O0="(default)";class dc{constructor(e,t){this.projectId=e,this.database=t||O0}static empty(){return new dc("","")}get isDefaultDatabase(){return this.database===O0}isEqual(e){return e instanceof dc&&e.projectId===this.projectId&&e.database===this.database}}const zx="__type__",Rk="__max__",Ta={mapValue:{fields:{__type__:{stringValue:Rk}}}},Bx="__vector__",vh="value",$p={nullValue:"NULL_VALUE"};function ja(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Ux(n)?4:Pk(n)?9007199254740991:Z_(n)?10:11:Se(28295,{value:n})}function Ls(n,e){if(n===e)return!0;const t=ja(n);if(t!==ja(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Jf(n).isEqual(Jf(e));case 3:return(function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const o=Eo(r.timestampValue),a=Eo(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(r,s){return wo(r.bytesValue).isEqual(wo(s.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(r,s){return Vt(r.geoPointValue.latitude)===Vt(s.geoPointValue.latitude)&&Vt(r.geoPointValue.longitude)===Vt(s.geoPointValue.longitude)})(n,e);case 2:return(function(r,s){if("integerValue"in r&&"integerValue"in s)return Vt(r.integerValue)===Vt(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const o=Vt(r.doubleValue),a=Vt(s.doubleValue);return o===a?Xf(o)===Xf(a):isNaN(o)&&isNaN(a)}return!1})(n,e);case 9:return gh(n.arrayValue.values||[],e.arrayValue.values||[],Ls);case 10:case 11:return(function(r,s){const o=r.mapValue.fields||{},a=s.mapValue.fields||{};if(CR(o)!==CR(a))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!Ls(o[c],a[c])))return!1;return!0})(n,e);default:return Se(52216,{left:n})}}function eg(n,e){return(n.values||[]).find((t=>Ls(t,e)))!==void 0}function Ga(n,e){if(n===e)return 0;const t=ja(n),i=ja(e);if(t!==i)return $e(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return $e(n.booleanValue,e.booleanValue);case 2:return(function(s,o){const a=Vt(s.integerValue||s.doubleValue),c=Vt(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1})(n,e);case 3:return bR(n.timestampValue,e.timestampValue);case 4:return bR(Jf(n),Jf(e));case 5:return zE(n.stringValue,e.stringValue);case 6:return(function(s,o){const a=wo(s),c=wo(o);return a.compareTo(c)})(n.bytesValue,e.bytesValue);case 7:return(function(s,o){const a=s.split("/"),c=o.split("/");for(let h=0;h<a.length&&h<c.length;h++){const d=$e(a[h],c[h]);if(d!==0)return d}return $e(a.length,c.length)})(n.referenceValue,e.referenceValue);case 8:return(function(s,o){const a=$e(Vt(s.latitude),Vt(o.latitude));return a!==0?a:$e(Vt(s.longitude),Vt(o.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return kR(n.arrayValue,e.arrayValue);case 10:return(function(s,o){const a=s.fields||{},c=o.fields||{},h=a[vh]?.arrayValue,d=c[vh]?.arrayValue,g=$e(h?.values?.length||0,d?.values?.length||0);return g!==0?g:kR(h,d)})(n.mapValue,e.mapValue);case 11:return(function(s,o){if(s===Ta.mapValue&&o===Ta.mapValue)return 0;if(s===Ta.mapValue)return 1;if(o===Ta.mapValue)return-1;const a=s.fields||{},c=Object.keys(a),h=o.fields||{},d=Object.keys(h);c.sort(),d.sort();for(let g=0;g<c.length&&g<d.length;++g){const m=zE(c[g],d[g]);if(m!==0)return m;const v=Ga(a[c[g]],h[d[g]]);if(v!==0)return v}return $e(c.length,d.length)})(n.mapValue,e.mapValue);default:throw Se(23264,{he:t})}}function bR(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return $e(n,e);const t=Eo(n),i=Eo(e),r=$e(t.seconds,i.seconds);return r!==0?r:$e(t.nanos,i.nanos)}function kR(n,e){const t=n.values||[],i=e.values||[];for(let r=0;r<t.length&&r<i.length;++r){const s=Ga(t[r],i[r]);if(s)return s}return $e(t.length,i.length)}function Eh(n){return HE(n)}function HE(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=Eo(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return wo(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return pe.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",r=!0;for(const s of t.values||[])r?r=!1:i+=",",i+=HE(s);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let r="{",s=!0;for(const o of i)s?s=!1:r+=",",r+=`${o}:${HE(t.fields[o])}`;return r+"}"})(n.mapValue):Se(61005,{value:n})}function Wp(n){switch(ja(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Y_(n);return e?16+Wp(e):16;case 5:return 2*n.stringValue.length;case 6:return wo(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((r,s)=>r+Wp(s)),0)})(n.arrayValue);case 10:case 11:return(function(i){let r=0;return Ya(i.fields,((s,o)=>{r+=s.length+Wp(o)})),r})(n.mapValue);default:throw Se(13486,{value:n})}}function tg(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function XE(n){return!!n&&"integerValue"in n}function ng(n){return!!n&&"arrayValue"in n}function LR(n){return!!n&&"nullValue"in n}function NR(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Kp(n){return!!n&&"mapValue"in n}function Z_(n){return(n?.mapValue?.fields||{})[zx]?.stringValue===Bx}function pf(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return Ya(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=pf(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=pf(n.arrayValue.values[t]);return e}return{...n}}function Pk(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===Rk}const Ck={mapValue:{fields:{[zx]:{stringValue:Bx},[vh]:{arrayValue:{}}}}};function Wj(n){return"nullValue"in n?$p:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?tg(dc.empty(),pe.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?Z_(n)?Ck:{mapValue:{}}:Se(35942,{value:n})}function Kj(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?tg(dc.empty(),pe.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?Ck:"mapValue"in n?Z_(n)?{mapValue:{}}:Ta:Se(61959,{value:n})}function DR(n,e){const t=Ga(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function OR(n,e){const t=Ga(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class Jn{constructor(e){this.value=e}static empty(){return new Jn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!Kp(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=pf(t)}setAll(e){let t=Bt.emptyPath(),i={},r=[];e.forEach(((o,a)=>{if(!t.isImmediateParentOf(a)){const c=this.getFieldsMap(t);this.applyChanges(c,i,r),i={},r=[],t=a.popLast()}o?i[a.lastSegment()]=pf(o):r.push(a.lastSegment())}));const s=this.getFieldsMap(t);this.applyChanges(s,i,r)}delete(e){const t=this.field(e.popLast());Kp(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ls(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=t.mapValue.fields[e.get(i)];Kp(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,i){Ya(t,((r,s)=>e[r]=s));for(const r of i)delete e[r]}clone(){return new Jn(pf(this.value))}}function Mk(n){const e=[];return Ya(n.fields,((t,i)=>{const r=new Bt([t]);if(Kp(i)){const s=Mk(i.mapValue).fields;if(s.length===0)e.push(r);else for(const o of s)e.push(r.child(o))}else e.push(r)})),new bi(e)}class Xt{constructor(e,t,i,r,s,o,a){this.key=e,this.documentType=t,this.version=i,this.readTime=r,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Xt(e,0,be.min(),be.min(),be.min(),Jn.empty(),0)}static newFoundDocument(e,t,i,r){return new Xt(e,1,t,be.min(),i,r,0)}static newNoDocument(e,t){return new Xt(e,2,t,be.min(),be.min(),Jn.empty(),0)}static newUnknownDocument(e,t){return new Xt(e,3,t,be.min(),be.min(),Jn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(be.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Jn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Jn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=be.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Xt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Xt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class wh{constructor(e,t){this.position=e,this.inclusive=t}}function VR(n,e,t){let i=0;for(let r=0;r<n.position.length;r++){const s=e[r],o=n.position[r];if(s.field.isKeyField()?i=pe.comparator(pe.fromName(o.referenceValue),t.key):i=Ga(o,t.data.field(s.field)),s.dir==="desc"&&(i*=-1),i!==0)break}return i}function FR(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Ls(n.position[t],e.position[t]))return!1;return!0}class V0{constructor(e,t="asc"){this.field=e,this.dir=t}}function qj(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class bk{}class tt extends bk{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new Hj(e,t,i):t==="array-contains"?new Zj(e,i):t==="in"?new Vk(e,i):t==="not-in"?new Qj(e,i):t==="array-contains-any"?new Jj(e,i):new tt(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new Xj(e,i):new Yj(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Ga(t,this.value)):t!==null&&ja(this.value)===ja(t)&&this.matchesComparison(Ga(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Se(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class St extends bk{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new St(e,t)}matches(e){return xh(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function xh(n){return n.op==="and"}function YE(n){return n.op==="or"}function $x(n){return kk(n)&&xh(n)}function kk(n){for(const e of n.filters)if(e instanceof St)return!1;return!0}function ZE(n){if(n instanceof tt)return n.field.canonicalString()+n.op.toString()+Eh(n.value);if($x(n))return n.filters.map((e=>ZE(e))).join(",");{const e=n.filters.map((t=>ZE(t))).join(",");return`${n.op}(${e})`}}function Lk(n,e){return n instanceof tt?(function(i,r){return r instanceof tt&&i.op===r.op&&i.field.isEqual(r.field)&&Ls(i.value,r.value)})(n,e):n instanceof St?(function(i,r){return r instanceof St&&i.op===r.op&&i.filters.length===r.filters.length?i.filters.reduce(((s,o,a)=>s&&Lk(o,r.filters[a])),!0):!1})(n,e):void Se(19439)}function Nk(n,e){const t=n.filters.concat(e);return St.create(t,n.op)}function Dk(n){return n instanceof tt?(function(t){return`${t.field.canonicalString()} ${t.op} ${Eh(t.value)}`})(n):n instanceof St?(function(t){return t.op.toString()+" {"+t.getFilters().map(Dk).join(" ,")+"}"})(n):"Filter"}class Hj extends tt{constructor(e,t,i){super(e,t,i),this.key=pe.fromName(i.referenceValue)}matches(e){const t=pe.comparator(e.key,this.key);return this.matchesComparison(t)}}class Xj extends tt{constructor(e,t){super(e,"in",t),this.keys=Ok("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class Yj extends tt{constructor(e,t){super(e,"not-in",t),this.keys=Ok("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function Ok(n,e){return(e.arrayValue?.values||[]).map((t=>pe.fromName(t.referenceValue)))}class Zj extends tt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return ng(t)&&eg(t.arrayValue,this.value)}}class Vk extends tt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&eg(this.value.arrayValue,t)}}class Qj extends tt{constructor(e,t){super(e,"not-in",t)}matches(e){if(eg(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!eg(this.value.arrayValue,t)}}class Jj extends tt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!ng(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>eg(this.value.arrayValue,i)))}}class eG{constructor(e,t=null,i=[],r=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=r,this.limit=s,this.startAt=o,this.endAt=a,this.Te=null}}function QE(n,e=null,t=[],i=[],r=null,s=null,o=null){return new eG(n,e,t,i,r,s,o)}function fc(n){const e=We(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>ZE(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(s){return s.field.canonicalString()+s.dir})(i))).join(","),K_(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>Eh(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>Eh(i))).join(",")),e.Te=t}return e.Te}function Lg(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!qj(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Lk(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!FR(n.startAt,e.startAt)&&FR(n.endAt,e.endAt)}function F0(n){return pe.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function j0(n,e){return n.filters.filter((t=>t instanceof tt&&t.field.isEqual(e)))}function jR(n,e,t){let i=$p,r=!0;for(const s of j0(n,e)){let o=$p,a=!0;switch(s.op){case"<":case"<=":o=Wj(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=$p}DR({value:i,inclusive:r},{value:o,inclusive:a})<0&&(i=o,r=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];DR({value:i,inclusive:r},{value:o,inclusive:t.inclusive})<0&&(i=o,r=t.inclusive);break}}return{value:i,inclusive:r}}function GR(n,e,t){let i=Ta,r=!0;for(const s of j0(n,e)){let o=Ta,a=!0;switch(s.op){case">=":case">":o=Kj(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=Ta}OR({value:i,inclusive:r},{value:o,inclusive:a})>0&&(i=o,r=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];OR({value:i,inclusive:r},{value:o,inclusive:t.inclusive})>0&&(i=o,r=t.inclusive);break}}return{value:i,inclusive:r}}class Ng{constructor(e,t=null,i=[],r=[],s=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=r,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function tG(n,e,t,i,r,s,o,a){return new Ng(n,e,t,i,r,s,o,a)}function Wx(n){return new Ng(n)}function UR(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Fk(n){return n.collectionGroup!==null}function _f(n){const e=We(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),t.add(s.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Tt(Bt.comparator);return o.filters.forEach((c=>{c.getFlattenedFilters().forEach((h=>{h.isInequality()&&(a=a.add(h.field))}))})),a})(e).forEach((s=>{t.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new V0(s,i))})),t.has(Bt.keyField().canonicalString())||e.Ie.push(new V0(Bt.keyField(),i))}return e.Ie}function Ir(n){const e=We(n);return e.Ee||(e.Ee=nG(e,_f(n))),e.Ee}function nG(n,e){if(n.limitType==="F")return QE(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((r=>{const s=r.dir==="desc"?"asc":"desc";return new V0(r.field,s)}));const t=n.endAt?new wh(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new wh(n.startAt.position,n.startAt.inclusive):null;return QE(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function JE(n,e){const t=n.filters.concat([e]);return new Ng(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function ew(n,e,t){return new Ng(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Q_(n,e){return Lg(Ir(n),Ir(e))&&n.limitType===e.limitType}function jk(n){return`${fc(Ir(n))}|lt:${n.limitType}`}function Mu(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((r=>Dk(r))).join(", ")}]`),K_(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((r=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(r))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((r=>Eh(r))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((r=>Eh(r))).join(",")),`Target(${i})`})(Ir(n))}; limitType=${n.limitType})`}function Dg(n,e){return e.isFoundDocument()&&(function(i,r){const s=r.key.path;return i.collectionGroup!==null?r.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(s):pe.isDocumentKey(i.path)?i.path.isEqual(s):i.path.isImmediateParentOf(s)})(n,e)&&(function(i,r){for(const s of _f(i))if(!s.field.isKeyField()&&r.data.field(s.field)===null)return!1;return!0})(n,e)&&(function(i,r){for(const s of i.filters)if(!s.matches(r))return!1;return!0})(n,e)&&(function(i,r){return!(i.startAt&&!(function(o,a,c){const h=VR(o,a,c);return o.inclusive?h<=0:h<0})(i.startAt,_f(i),r)||i.endAt&&!(function(o,a,c){const h=VR(o,a,c);return o.inclusive?h>=0:h>0})(i.endAt,_f(i),r))})(n,e)}function iG(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Gk(n){return(e,t)=>{let i=!1;for(const r of _f(n)){const s=rG(r,e,t);if(s!==0)return s;i=i||r.field.isKeyField()}return 0}}function rG(n,e,t){const i=n.field.isKeyField()?pe.comparator(e.key,t.key):(function(s,o,a){const c=o.data.field(s),h=a.data.field(s);return c!==null&&h!==null?Ga(c,h):Se(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return Se(19790,{direction:n.dir})}}class Ro{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[r,s]of i)if(this.equalsFn(r,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),r=this.inner[i];if(r===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return void(r[s]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return i.length===1?delete this.inner[t]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Ya(this.inner,((t,i)=>{for(const[r,s]of i)e(r,s)}))}isEmpty(){return wk(this.inner)}size(){return this.innerSize}}const sG=new jt(pe.comparator);function Hi(){return sG}const Uk=new jt(pe.comparator);function Qd(...n){let e=Uk;for(const t of n)e=e.insert(t.key,t);return e}function zk(n){let e=Uk;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function Is(){return yf()}function Bk(){return yf()}function yf(){return new Ro((n=>n.toString()),((n,e)=>n.isEqual(e)))}const oG=new jt(pe.comparator),aG=new Tt(pe.comparator);function Ze(...n){let e=aG;for(const t of n)e=e.add(t);return e}const lG=new Tt($e);function cG(){return lG}function Kx(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Xf(e)?"-0":e}}function $k(n){return{integerValue:""+n}}function uG(n,e){return pj(e)?$k(e):Kx(n,e)}class J_{constructor(){this._=void 0}}function hG(n,e,t){return n instanceof ig?(function(r,s){const o={fields:{[Tk]:{stringValue:Sk},[Ak]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&Ux(s)&&(s=Y_(s)),s&&(o.fields[Ik]=s),{mapValue:o}})(t,e):n instanceof Sh?Kk(n,e):n instanceof Th?qk(n,e):(function(r,s){const o=Wk(r,s),a=zR(o)+zR(r.Ae);return XE(o)&&XE(r.Ae)?$k(a):Kx(r.serializer,a)})(n,e)}function dG(n,e,t){return n instanceof Sh?Kk(n,e):n instanceof Th?qk(n,e):t}function Wk(n,e){return n instanceof rg?(function(i){return XE(i)||(function(s){return!!s&&"doubleValue"in s})(i)})(e)?e:{integerValue:0}:null}class ig extends J_{}class Sh extends J_{constructor(e){super(),this.elements=e}}function Kk(n,e){const t=Hk(e);for(const i of n.elements)t.some((r=>Ls(r,i)))||t.push(i);return{arrayValue:{values:t}}}class Th extends J_{constructor(e){super(),this.elements=e}}function qk(n,e){let t=Hk(e);for(const i of n.elements)t=t.filter((r=>!Ls(r,i)));return{arrayValue:{values:t}}}class rg extends J_{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function zR(n){return Vt(n.integerValue||n.doubleValue)}function Hk(n){return ng(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class fG{constructor(e,t){this.field=e,this.transform=t}}function gG(n,e){return n.field.isEqual(e.field)&&(function(i,r){return i instanceof Sh&&r instanceof Sh||i instanceof Th&&r instanceof Th?gh(i.elements,r.elements,Ls):i instanceof rg&&r instanceof rg?Ls(i.Ae,r.Ae):i instanceof ig&&r instanceof ig})(n.transform,e.transform)}class mG{constructor(e,t){this.version=e,this.transformResults=t}}class hi{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new hi}static exists(e){return new hi(void 0,e)}static updateTime(e){return new hi(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function qp(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class ey{}function Xk(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new ty(n.key,hi.none()):new Dh(n.key,n.data,hi.none());{const t=n.data,i=Jn.empty();let r=new Tt(Bt.comparator);for(let s of e.fields)if(!r.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?i.delete(s):i.set(s,o),r=r.add(s)}return new Po(n.key,i,new bi(r.toArray()),hi.none())}}function pG(n,e,t){n instanceof Dh?(function(r,s,o){const a=r.value.clone(),c=$R(r.fieldTransforms,s,o.transformResults);a.setAll(c),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()})(n,e,t):n instanceof Po?(function(r,s,o){if(!qp(r.precondition,s))return void s.convertToUnknownDocument(o.version);const a=$R(r.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(Yk(r)),c.setAll(a),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()})(n,e,t):(function(r,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,t)}function vf(n,e,t,i){return n instanceof Dh?(function(s,o,a,c){if(!qp(s.precondition,o))return a;const h=s.value.clone(),d=WR(s.fieldTransforms,c,o);return h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null})(n,e,t,i):n instanceof Po?(function(s,o,a,c){if(!qp(s.precondition,o))return a;const h=WR(s.fieldTransforms,c,o),d=o.data;return d.setAll(Yk(s)),d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map((g=>g.field)))})(n,e,t,i):(function(s,o,a){return qp(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a})(n,e,t)}function _G(n,e){let t=null;for(const i of n.fieldTransforms){const r=e.data.field(i.field),s=Wk(i.transform,r||null);s!=null&&(t===null&&(t=Jn.empty()),t.set(i.field,s))}return t||null}function BR(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,r){return i===void 0&&r===void 0||!(!i||!r)&&gh(i,r,((s,o)=>gG(s,o)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Dh extends ey{constructor(e,t,i,r=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Po extends ey{constructor(e,t,i,r,s=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function Yk(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function $R(n,e,t){const i=new Map;Ce(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let r=0;r<t.length;r++){const s=n[r],o=s.transform,a=e.data.field(s.field);i.set(s.field,dG(o,a,t[r]))}return i}function WR(n,e,t){const i=new Map;for(const r of n){const s=r.transform,o=t.data.field(r.field);i.set(r.field,hG(s,o,e))}return i}class ty extends ey{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Zk extends ey{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class qx{constructor(e,t,i,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const s=this.mutations[r];s.key.isEqual(e.key)&&pG(s,e,i[r])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=vf(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=vf(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=Bk();return this.mutations.forEach((r=>{const s=e.get(r.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=t.has(r.key)?null:a;const c=Xk(o,a);c!==null&&i.set(r.key,c),o.isValidDocument()||o.convertToNoDocument(be.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Ze())}isEqual(e){return this.batchId===e.batchId&&gh(this.mutations,e.mutations,((t,i)=>BR(t,i)))&&gh(this.baseMutations,e.baseMutations,((t,i)=>BR(t,i)))}}class Hx{constructor(e,t,i,r){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=r}static from(e,t,i){Ce(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let r=(function(){return oG})();const s=e.mutations;for(let o=0;o<s.length;o++)r=r.insert(s[o].key,i[o].version);return new Hx(e,t,i,r)}}class Xx{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class yG{constructor(e,t){this.count=e,this.unchangedNames=t}}var an,rt;function vG(n){switch(n){case ee.OK:return Se(64938);case ee.CANCELLED:case ee.UNKNOWN:case ee.DEADLINE_EXCEEDED:case ee.RESOURCE_EXHAUSTED:case ee.INTERNAL:case ee.UNAVAILABLE:case ee.UNAUTHENTICATED:return!1;case ee.INVALID_ARGUMENT:case ee.NOT_FOUND:case ee.ALREADY_EXISTS:case ee.PERMISSION_DENIED:case ee.FAILED_PRECONDITION:case ee.ABORTED:case ee.OUT_OF_RANGE:case ee.UNIMPLEMENTED:case ee.DATA_LOSS:return!0;default:return Se(15467,{code:n})}}function Qk(n){if(n===void 0)return ui("GRPC error has no .code"),ee.UNKNOWN;switch(n){case an.OK:return ee.OK;case an.CANCELLED:return ee.CANCELLED;case an.UNKNOWN:return ee.UNKNOWN;case an.DEADLINE_EXCEEDED:return ee.DEADLINE_EXCEEDED;case an.RESOURCE_EXHAUSTED:return ee.RESOURCE_EXHAUSTED;case an.INTERNAL:return ee.INTERNAL;case an.UNAVAILABLE:return ee.UNAVAILABLE;case an.UNAUTHENTICATED:return ee.UNAUTHENTICATED;case an.INVALID_ARGUMENT:return ee.INVALID_ARGUMENT;case an.NOT_FOUND:return ee.NOT_FOUND;case an.ALREADY_EXISTS:return ee.ALREADY_EXISTS;case an.PERMISSION_DENIED:return ee.PERMISSION_DENIED;case an.FAILED_PRECONDITION:return ee.FAILED_PRECONDITION;case an.ABORTED:return ee.ABORTED;case an.OUT_OF_RANGE:return ee.OUT_OF_RANGE;case an.UNIMPLEMENTED:return ee.UNIMPLEMENTED;case an.DATA_LOSS:return ee.DATA_LOSS;default:return Se(39323,{code:n})}}(rt=an||(an={}))[rt.OK=0]="OK",rt[rt.CANCELLED=1]="CANCELLED",rt[rt.UNKNOWN=2]="UNKNOWN",rt[rt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",rt[rt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",rt[rt.NOT_FOUND=5]="NOT_FOUND",rt[rt.ALREADY_EXISTS=6]="ALREADY_EXISTS",rt[rt.PERMISSION_DENIED=7]="PERMISSION_DENIED",rt[rt.UNAUTHENTICATED=16]="UNAUTHENTICATED",rt[rt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",rt[rt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",rt[rt.ABORTED=10]="ABORTED",rt[rt.OUT_OF_RANGE=11]="OUT_OF_RANGE",rt[rt.UNIMPLEMENTED=12]="UNIMPLEMENTED",rt[rt.INTERNAL=13]="INTERNAL",rt[rt.UNAVAILABLE=14]="UNAVAILABLE",rt[rt.DATA_LOSS=15]="DATA_LOSS";function EG(){return new TextEncoder}const wG=new ba([4294967295,4294967295],0);function KR(n){const e=EG().encode(n),t=new Y4;return t.update(e),new Uint8Array(t.digest())}function qR(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),r=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new ba([t,i],0),new ba([r,s],0)]}class Yx{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new Jd(`Invalid padding: ${t}`);if(i<0)throw new Jd(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new Jd(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new Jd(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=ba.fromNumber(this.ge)}ye(e,t,i){let r=e.add(t.multiply(ba.fromNumber(i)));return r.compare(wG)===1&&(r=new ba([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=KR(e),[i,r]=qR(t);for(let s=0;s<this.hashCount;s++){const o=this.ye(i,r,s);if(!this.we(o))return!1}return!0}static create(e,t,i){const r=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new Yx(s,r,t);return i.forEach((a=>o.insert(a))),o}insert(e){if(this.ge===0)return;const t=KR(e),[i,r]=qR(t);for(let s=0;s<this.hashCount;s++){const o=this.ye(i,r,s);this.Se(o)}}Se(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class Jd extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class ny{constructor(e,t,i,r,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const r=new Map;return r.set(e,Og.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new ny(be.min(),r,new jt($e),Hi(),Ze())}}class Og{constructor(e,t,i,r,s){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new Og(i,t,Ze(),Ze(),Ze())}}class Hp{constructor(e,t,i,r){this.be=e,this.removedTargetIds=t,this.key=i,this.De=r}}class Jk{constructor(e,t){this.targetId=e,this.Ce=t}}class eL{constructor(e,t,i=cn.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=r}}class HR{constructor(){this.ve=0,this.Fe=XR(),this.Me=cn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Ze(),t=Ze(),i=Ze();return this.Fe.forEach(((r,s)=>{switch(s){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:i=i.add(r);break;default:Se(38017,{changeType:s})}})),new Og(this.Me,this.xe,e,t,i)}qe(){this.Oe=!1,this.Fe=XR()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Ce(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class xG{constructor(e){this.Ge=e,this.ze=new Map,this.je=Hi(),this.Je=xp(),this.He=xp(),this.Ye=new jt($e)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.Ke(),i.Ne||i.qe(),i.Le(e.resumeToken);break;case 2:i.Ke(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.We(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:Se(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((i,r)=>{this.rt(r)&&t(r)}))}st(e){const t=e.targetId,i=e.Ce.count,r=this.ot(t);if(r){const s=r.target;if(F0(s))if(i===0){const o=new pe(s.path);this.et(t,o,Xt.newNoDocument(o,be.min()))}else Ce(i===1,20013,{expectedCount:i});else{const o=this._t(t);if(o!==i){const a=this.ut(e),c=a?this.ct(a,e,o):1;if(c!==0){this.it(t);const h=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,h)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:r=0},hashCount:s=0}=t;let o,a;try{o=wo(i).toUint8Array()}catch(c){if(c instanceof xk)return hc("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new Yx(o,r,s)}catch(c){return hc(c instanceof Jd?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.ge===0?null:a}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){const i=this.Ge.getRemoteKeysForTarget(t);let r=0;return i.forEach((s=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.et(t,s,null),r++)})),r}Tt(e){const t=new Map;this.ze.forEach(((s,o)=>{const a=this.ot(o);if(a){if(s.current&&F0(a.target)){const c=new pe(a.target.path);this.It(c).has(o)||this.Et(o,c)||this.et(o,c,Xt.newNoDocument(c,e))}s.Be&&(t.set(o,s.ke()),s.qe())}}));let i=Ze();this.He.forEach(((s,o)=>{let a=!0;o.forEachWhile((c=>{const h=this.ot(c);return!h||h.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)})),a&&(i=i.add(s))})),this.je.forEach(((s,o)=>o.setReadTime(e)));const r=new ny(e,t,this.Ye,this.je,i);return this.je=Hi(),this.Je=xp(),this.He=xp(),this.Ye=new jt($e),r}Xe(e,t){if(!this.rt(e))return;const i=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,i),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;const r=this.nt(e);this.Et(e,t)?r.Qe(t,1):r.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new HR,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Tt($e),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Tt($e),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||ue("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new HR),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function xp(){return new jt(pe.comparator)}function XR(){return new jt(pe.comparator)}const SG={asc:"ASCENDING",desc:"DESCENDING"},TG={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},IG={and:"AND",or:"OR"};class AG{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function tw(n,e){return n.useProto3Json||K_(e)?e:{value:e}}function Ih(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function tL(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function RG(n,e){return Ih(n,e.toTimestamp())}function fi(n){return Ce(!!n,49232),be.fromTimestamp((function(t){const i=Eo(t);return new xt(i.seconds,i.nanos)})(n))}function Zx(n,e){return nw(n,e).canonicalString()}function nw(n,e){const t=(function(r){return new gt(["projects",r.projectId,"databases",r.database])})(n).child("documents");return e===void 0?t:t.child(e)}function nL(n){const e=gt.fromString(n);return Ce(hL(e),10190,{key:e.toString()}),e}function G0(n,e){return Zx(n.databaseId,e.path)}function Ql(n,e){const t=nL(e);if(t.get(1)!==n.databaseId.projectId)throw new me(ee.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new me(ee.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new pe(sL(t))}function iL(n,e){return Zx(n.databaseId,e)}function rL(n){const e=nL(n);return e.length===4?gt.emptyPath():sL(e)}function iw(n){return new gt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function sL(n){return Ce(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function YR(n,e,t){return{name:G0(n,e),fields:t.value.mapValue.fields}}function PG(n,e,t){const i=Ql(n,e.name),r=fi(e.updateTime),s=e.createTime?fi(e.createTime):be.min(),o=new Jn({mapValue:{fields:e.fields}}),a=Xt.newFoundDocument(i,r,s,o);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function CG(n,e){let t;if("targetChange"in e){e.targetChange;const i=(function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:Se(39313,{state:h})})(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],s=(function(h,d){return h.useProto3Json?(Ce(d===void 0||typeof d=="string",58123),cn.fromBase64String(d||"")):(Ce(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),cn.fromUint8Array(d||new Uint8Array))})(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&(function(h){const d=h.code===void 0?ee.UNKNOWN:Qk(h.code);return new me(d,h.message||"")})(o);t=new eL(i,r,s,a||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const r=Ql(n,i.document.name),s=fi(i.document.updateTime),o=i.document.createTime?fi(i.document.createTime):be.min(),a=new Jn({mapValue:{fields:i.document.fields}}),c=Xt.newFoundDocument(r,s,o,a),h=i.targetIds||[],d=i.removedTargetIds||[];t=new Hp(h,d,c.key,c)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const r=Ql(n,i.document),s=i.readTime?fi(i.readTime):be.min(),o=Xt.newNoDocument(r,s),a=i.removedTargetIds||[];t=new Hp([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const r=Ql(n,i.document),s=i.removedTargetIds||[];t=new Hp([],s,r,null)}else{if(!("filter"in e))return Se(11601,{Rt:e});{e.filter;const i=e.filter;i.targetId;const{count:r=0,unchangedNames:s}=i,o=new yG(r,s),a=i.targetId;t=new Jk(a,o)}}return t}function U0(n,e){let t;if(e instanceof Dh)t={update:YR(n,e.key,e.value)};else if(e instanceof ty)t={delete:G0(n,e.key)};else if(e instanceof Po)t={update:YR(n,e.key,e.data),updateMask:DG(e.fieldMask)};else{if(!(e instanceof Zk))return Se(16599,{Vt:e.type});t={verify:G0(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(s,o){const a=o.transform;if(a instanceof ig)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Sh)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Th)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof rg)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw Se(20930,{transform:o.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(r,s){return s.updateTime!==void 0?{updateTime:RG(r,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Se(27497)})(n,e.precondition)),t}function rw(n,e){const t=e.currentDocument?(function(s){return s.updateTime!==void 0?hi.updateTime(fi(s.updateTime)):s.exists!==void 0?hi.exists(s.exists):hi.none()})(e.currentDocument):hi.none(),i=e.updateTransforms?e.updateTransforms.map((r=>(function(o,a){let c=null;if("setToServerValue"in a)Ce(a.setToServerValue==="REQUEST_TIME",16630,{proto:a}),c=new ig;else if("appendMissingElements"in a){const d=a.appendMissingElements.values||[];c=new Sh(d)}else if("removeAllFromArray"in a){const d=a.removeAllFromArray.values||[];c=new Th(d)}else"increment"in a?c=new rg(o,a.increment):Se(16584,{proto:a});const h=Bt.fromServerFormat(a.fieldPath);return new fG(h,c)})(n,r))):[];if(e.update){e.update.name;const r=Ql(n,e.update.name),s=new Jn({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=(function(c){const h=c.fieldPaths||[];return new bi(h.map((d=>Bt.fromServerFormat(d))))})(e.updateMask);return new Po(r,s,o,t,i)}return new Dh(r,s,t,i)}if(e.delete){const r=Ql(n,e.delete);return new ty(r,t)}if(e.verify){const r=Ql(n,e.verify);return new Zk(r,t)}return Se(1463,{proto:e})}function MG(n,e){return n&&n.length>0?(Ce(e!==void 0,14353),n.map((t=>(function(r,s){let o=r.updateTime?fi(r.updateTime):fi(s);return o.isEqual(be.min())&&(o=fi(s)),new mG(o,r.transformResults||[])})(t,e)))):[]}function oL(n,e){return{documents:[iL(n,e.path)]}}function aL(n,e){const t={structuredQuery:{}},i=e.path;let r;e.collectionGroup!==null?(r=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=iL(n,r);const s=(function(h){if(h.length!==0)return uL(St.create(h,"and"))})(e.filters);s&&(t.structuredQuery.where=s);const o=(function(h){if(h.length!==0)return h.map((d=>(function(m){return{field:bu(m.field),direction:kG(m.dir)}})(d)))})(e.orderBy);o&&(t.structuredQuery.orderBy=o);const a=tw(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=(function(h){return{before:h.inclusive,values:h.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(h){return{before:!h.inclusive,values:h.position}})(e.endAt)),{ft:t,parent:r}}function lL(n){let e=rL(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let r=null;if(i>0){Ce(i===1,65062);const d=t.from[0];d.allDescendants?r=d.collectionId:e=e.child(d.collectionId)}let s=[];t.where&&(s=(function(g){const m=cL(g);return m instanceof St&&$x(m)?m.getFilters():[m]})(t.where));let o=[];t.orderBy&&(o=(function(g){return g.map((m=>(function(y){return new V0(ku(y.field),(function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(y.direction))})(m)))})(t.orderBy));let a=null;t.limit&&(a=(function(g){let m;return m=typeof g=="object"?g.value:g,K_(m)?null:m})(t.limit));let c=null;t.startAt&&(c=(function(g){const m=!!g.before,v=g.values||[];return new wh(v,m)})(t.startAt));let h=null;return t.endAt&&(h=(function(g){const m=!g.before,v=g.values||[];return new wh(v,m)})(t.endAt)),tG(e,r,o,s,a,"F",c,h)}function bG(n,e){const t=(function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Se(28987,{purpose:r})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function cL(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=ku(t.unaryFilter.field);return tt.create(i,"==",{doubleValue:NaN});case"IS_NULL":const r=ku(t.unaryFilter.field);return tt.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=ku(t.unaryFilter.field);return tt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=ku(t.unaryFilter.field);return tt.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Se(61313);default:return Se(60726)}})(n):n.fieldFilter!==void 0?(function(t){return tt.create(ku(t.fieldFilter.field),(function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Se(58110);default:return Se(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return St.create(t.compositeFilter.filters.map((i=>cL(i))),(function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return Se(1026)}})(t.compositeFilter.op))})(n):Se(30097,{filter:n})}function kG(n){return SG[n]}function LG(n){return TG[n]}function NG(n){return IG[n]}function bu(n){return{fieldPath:n.canonicalString()}}function ku(n){return Bt.fromServerFormat(n.fieldPath)}function uL(n){return n instanceof tt?(function(t){if(t.op==="=="){if(NR(t.value))return{unaryFilter:{field:bu(t.field),op:"IS_NAN"}};if(LR(t.value))return{unaryFilter:{field:bu(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(NR(t.value))return{unaryFilter:{field:bu(t.field),op:"IS_NOT_NAN"}};if(LR(t.value))return{unaryFilter:{field:bu(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:bu(t.field),op:LG(t.op),value:t.value}}})(n):n instanceof St?(function(t){const i=t.getFilters().map((r=>uL(r)));return i.length===1?i[0]:{compositeFilter:{op:NG(t.op),filters:i}}})(n):Se(54877,{filter:n})}function DG(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function hL(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class lo{constructor(e,t,i,r,s=be.min(),o=be.min(),a=cn.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new lo(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new lo(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new lo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new lo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class dL{constructor(e){this.yt=e}}function OG(n,e){let t;if(e.document)t=PG(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const i=pe.fromSegments(e.noDocument.path),r=mc(e.noDocument.readTime);t=Xt.newNoDocument(i,r),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Se(56709);{const i=pe.fromSegments(e.unknownDocument.path),r=mc(e.unknownDocument.version);t=Xt.newUnknownDocument(i,r)}}return e.readTime&&t.setReadTime((function(r){const s=new xt(r[0],r[1]);return be.fromTimestamp(s)})(e.readTime)),t}function ZR(n,e){const t=e.key,i={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:z0(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())i.document=(function(s,o){return{name:G0(s,o.key),fields:o.data.value.mapValue.fields,updateTime:Ih(s,o.version.toTimestamp()),createTime:Ih(s,o.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())i.noDocument={path:t.path.toArray(),readTime:gc(e.version)};else{if(!e.isUnknownDocument())return Se(57904,{document:e});i.unknownDocument={path:t.path.toArray(),version:gc(e.version)}}return i}function z0(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function gc(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function mc(n){const e=new xt(n.seconds,n.nanoseconds);return be.fromTimestamp(e)}function Fl(n,e){const t=(e.baseMutations||[]).map((s=>rw(n.yt,s)));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const i=e.mutations.map((s=>rw(n.yt,s))),r=xt.fromMillis(e.localWriteTimeMs);return new qx(e.batchId,r,t,i)}function ef(n){const e=mc(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?mc(n.lastLimboFreeSnapshotVersion):be.min();let i;return i=(function(s){return s.documents!==void 0})(n.query)?(function(s){const o=s.documents.length;return Ce(o===1,1966,{count:o}),Ir(Wx(rL(s.documents[0])))})(n.query):(function(s){return Ir(lL(s))})(n.query),new lo(i,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,cn.fromBase64String(n.resumeToken))}function fL(n,e){const t=gc(e.snapshotVersion),i=gc(e.lastLimboFreeSnapshotVersion);let r;r=F0(e.target)?oL(n.yt,e.target):aL(n.yt,e.target).ft;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:fc(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:r}}function gL(n){const e=lL({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?ew(e,e.limit,"L"):e}function k1(n,e){return new Xx(e.largestBatchId,rw(n.yt,e.overlayMutation))}function QR(n,e){const t=e.path.lastSegment();return[n,ni(e.path.popLast()),t]}function JR(n,e,t,i){return{indexId:n,uid:e,sequenceNumber:t,readTime:gc(i.readTime),documentKey:ni(i.documentKey.path),largestBatchId:i.largestBatchId}}class VG{getBundleMetadata(e,t){return eP(e).get(t).next((i=>{if(i)return(function(s){return{id:s.bundleId,createTime:mc(s.createTime),version:s.version}})(i)}))}saveBundleMetadata(e,t){return eP(e).put((function(r){return{bundleId:r.id,createTime:gc(fi(r.createTime)),version:r.version}})(t))}getNamedQuery(e,t){return tP(e).get(t).next((i=>{if(i)return(function(s){return{name:s.name,query:gL(s.bundledQuery),readTime:mc(s.readTime)}})(i)}))}saveNamedQuery(e,t){return tP(e).put((function(r){return{name:r.name,readTime:gc(fi(r.readTime)),bundledQuery:r.bundledQuery}})(t))}}function eP(n){return yn(n,q_)}function tP(n){return yn(n,H_)}class iy{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const i=t.uid||"";return new iy(e,i)}getOverlay(e,t){return Od(e).get(QR(this.userId,t)).next((i=>i?k1(this.serializer,i):null))}getOverlays(e,t){const i=Is();return q.forEach(t,(r=>this.getOverlay(e,r).next((s=>{s!==null&&i.set(r,s)})))).next((()=>i))}saveOverlays(e,t,i){const r=[];return i.forEach(((s,o)=>{const a=new Xx(t,o);r.push(this.St(e,a))})),q.waitFor(r)}removeOverlaysForBatchId(e,t,i){const r=new Set;t.forEach((o=>r.add(ni(o.getCollectionPath()))));const s=[];return r.forEach((o=>{const a=IDBKeyRange.bound([this.userId,o,i],[this.userId,o,i+1],!1,!0);s.push(Od(e).Z(KE,a))})),q.waitFor(s)}getOverlaysForCollection(e,t,i){const r=Is(),s=ni(t),o=IDBKeyRange.bound([this.userId,s,i],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Od(e).J(KE,o).next((a=>{for(const c of a){const h=k1(this.serializer,c);r.set(h.getKey(),h)}return r}))}getOverlaysForCollectionGroup(e,t,i,r){const s=Is();let o;const a=IDBKeyRange.bound([this.userId,t,i],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Od(e).ee({index:pk,range:a},((c,h,d)=>{const g=k1(this.serializer,h);s.size()<r||g.largestBatchId===o?(s.set(g.getKey(),g),o=g.largestBatchId):d.done()})).next((()=>s))}St(e,t){return Od(e).put((function(r,s,o){const[a,c,h]=QR(s,o.mutation.key);return{userId:s,collectionPath:c,documentId:h,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:U0(r.yt,o.mutation)}})(this.serializer,this.userId,t))}}function Od(n){return yn(n,X_)}class FG{bt(e){return yn(e,jx)}getSessionToken(e){return this.bt(e).get("sessionToken").next((t=>{const i=t?.value;return i?cn.fromUint8Array(i):cn.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}class jl{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(Vt(e.integerValue));else if("doubleValue"in e){const i=Vt(e.doubleValue);isNaN(i)?this.Ft(t,13):(this.Ft(t,15),Xf(i)?t.Mt(0):t.Mt(i))}else if("timestampValue"in e){let i=e.timestampValue;this.Ft(t,20),typeof i=="string"&&(i=Eo(i)),t.xt(`${i.seconds||""}`),t.Mt(i.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(wo(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const i=e.geoPointValue;this.Ft(t,45),t.Mt(i.latitude||0),t.Mt(i.longitude||0)}else"mapValue"in e?Pk(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):Z_(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):Se(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const i=e.fields||{};this.Ft(t,55);for(const r of Object.keys(i))this.Ot(r,t),this.Ct(i[r],t)}kt(e,t){const i=e.fields||{};this.Ft(t,53);const r=vh,s=i[r].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(Vt(s)),this.Ot(r,t),this.Ct(i[r],t)}Qt(e,t){const i=e.values||[];this.Ft(t,50);for(const r of i)this.Ct(r,t)}Lt(e,t){this.Ft(t,37),pe.fromName(e).path.forEach((i=>{this.Ft(t,60),this.Ut(i,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}jl.Kt=new jl;const wu=255;function jG(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function nP(n){const e=64-(function(i){let r=0;for(let s=0;s<8;++s){const o=jG(255&i[s]);if(r+=o,o!==8)break}return r})(n);return Math.ceil(e/8)}class GG{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Gt(i.value),i=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Jt(i.value),i=t.next();this.Ht()}Yt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Gt(i);else if(i<2048)this.Gt(960|i>>>6),this.Gt(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i);else{const r=t.codePointAt(0);this.Gt(240|r>>>18),this.Gt(128|63&r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r)}}this.zt()}Zt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Jt(i);else if(i<2048)this.Jt(960|i>>>6),this.Jt(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i);else{const r=t.codePointAt(0);this.Jt(240|r>>>18),this.Jt(128|63&r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r)}}this.Ht()}Xt(e){const t=this.en(e),i=nP(t);this.tn(1+i),this.buffer[this.position++]=255&i;for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=255&t[r]}nn(e){const t=this.en(e),i=nP(t);this.tn(1+i),this.buffer[this.position++]=~(255&i);for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}rn(){this.sn(wu),this.sn(255)}_n(){this.an(wu),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)})(e),i=!!(128&t[0]);t[0]^=i?255:128;for(let r=1;r<t.length;++r)t[r]^=i?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===wu?(this.sn(wu),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===wu?(this.an(wu),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let i=2*this.buffer.length;i<t&&(i=t);const r=new Uint8Array(i);r.set(this.buffer),this.buffer=r}}class UG{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class zG{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class Vd{constructor(){this.cn=new GG,this.ln=new UG(this.cn),this.hn=new zG(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}class Gl{constructor(e,t,i,r){this.Tn=e,this.In=t,this.En=i,this.dn=r}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,i=new Uint8Array(t);return i.set(this.dn,0),t!==e?i.set([0],this.dn.length):++i[i.length-1],new Gl(this.Tn,this.In,this.En,i)}Rn(e,t,i){return{indexId:this.Tn,uid:e,arrayValue:Xp(this.En),directionalValue:Xp(this.dn),orderedDocumentKey:Xp(t),documentKey:i.path.toArray()}}Vn(e,t,i){const r=this.Rn(e,t,i);return[r.indexId,r.uid,r.arrayValue,r.directionalValue,r.orderedDocumentKey,r.documentKey]}}function oa(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=iP(n.En,e.En),t!==0?t:(t=iP(n.dn,e.dn),t!==0?t:pe.comparator(n.In,e.In)))}function iP(n,e){for(let t=0;t<n.length&&t<e.length;++t){const i=n[t]-e[t];if(i!==0)return i}return n.length-e.length}function Xp(n){return B4()?(function(t){let i="";for(let r=0;r<t.length;r++)i+=String.fromCharCode(t[r]);return i})(n):n}function rP(n){return typeof n!="string"?n:(function(t){const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i})(n)}class sP{constructor(e){this.mn=new Tt(((t,i)=>Bt.comparator(t.field,i.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const i=t;i.isInequality()?this.mn=this.mn.add(i):this.gn.push(i)}}get pn(){return this.mn.size>1}yn(e){if(Ce(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=BE(e);if(t!==void 0&&!this.wn(t))return!1;const i=bl(e);let r=new Set,s=0,o=0;for(;s<i.length&&this.wn(i[s]);++s)r=r.add(i[s].fieldPath.canonicalString());if(s===i.length)return!0;if(this.mn.size>0){const a=this.mn.getIterator().getNext();if(!r.has(a.field.canonicalString())){const c=i[s];if(!this.Sn(a,c)||!this.bn(this.fn[o++],c))return!1}++s}for(;s<i.length;++s){const a=i[s];if(o>=this.fn.length||!this.bn(this.fn[o++],a))return!1}return!0}Dn(){if(this.pn)return null;let e=new Tt(Bt.comparator);const t=[];for(const i of this.gn)if(!i.field.isKeyField())if(i.op==="array-contains"||i.op==="array-contains-any")t.push(new Up(i.field,2));else{if(e.has(i.field))continue;e=e.add(i.field),t.push(new Up(i.field,0))}for(const i of this.fn)i.field.isKeyField()||e.has(i.field)||(e=e.add(i.field),t.push(new Up(i.field,i.dir==="asc"?0:1)));return new k0(k0.UNKNOWN_ID,this.collectionId,t,Hf.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const i=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===i}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function mL(n){if(Ce(n instanceof tt||n instanceof St,20012),n instanceof tt){if(n instanceof Vk){const t=n.value.arrayValue?.values?.map((i=>tt.create(n.field,"==",i)))||[];return St.create(t,"or")}return n}const e=n.filters.map((t=>mL(t)));return St.create(e,n.op)}function BG(n){if(n.getFilters().length===0)return[];const e=aw(mL(n));return Ce(pL(e),7391),sw(e)||ow(e)?[e]:e.getFilters()}function sw(n){return n instanceof tt}function ow(n){return n instanceof St&&$x(n)}function pL(n){return sw(n)||ow(n)||(function(t){if(t instanceof St&&YE(t)){for(const i of t.getFilters())if(!sw(i)&&!ow(i))return!1;return!0}return!1})(n)}function aw(n){if(Ce(n instanceof tt||n instanceof St,34018),n instanceof tt)return n;if(n.filters.length===1)return aw(n.filters[0]);const e=n.filters.map((i=>aw(i)));let t=St.create(e,n.op);return t=B0(t),pL(t)?t:(Ce(t instanceof St,64498),Ce(xh(t),40251),Ce(t.filters.length>1,57927),t.filters.reduce(((i,r)=>Qx(i,r))))}function Qx(n,e){let t;return Ce(n instanceof tt||n instanceof St,38388),Ce(e instanceof tt||e instanceof St,25473),t=n instanceof tt?e instanceof tt?(function(r,s){return St.create([r,s],"and")})(n,e):oP(n,e):e instanceof tt?oP(e,n):(function(r,s){if(Ce(r.filters.length>0&&s.filters.length>0,48005),xh(r)&&xh(s))return Nk(r,s.getFilters());const o=YE(r)?r:s,a=YE(r)?s:r,c=o.filters.map((h=>Qx(h,a)));return St.create(c,"or")})(n,e),B0(t)}function oP(n,e){if(xh(e))return Nk(e,n.getFilters());{const t=e.filters.map((i=>Qx(n,i)));return St.create(t,"or")}}function B0(n){if(Ce(n instanceof tt||n instanceof St,11850),n instanceof tt)return n;const e=n.getFilters();if(e.length===1)return B0(e[0]);if(kk(n))return n;const t=e.map((r=>B0(r))),i=[];return t.forEach((r=>{r instanceof tt?i.push(r):r instanceof St&&(r.op===n.op?i.push(...r.filters):i.push(r))})),i.length===1?i[0]:St.create(i,n.op)}class $G{constructor(){this.Cn=new Jx}addToCollectionParentIndex(e,t){return this.Cn.add(t),q.resolve()}getCollectionParents(e,t){return q.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return q.resolve()}deleteFieldIndex(e,t){return q.resolve()}deleteAllFieldIndexes(e){return q.resolve()}createTargetIndexes(e,t){return q.resolve()}getDocumentsMatchingTarget(e,t){return q.resolve(null)}getIndexType(e,t){return q.resolve(0)}getFieldIndexes(e,t){return q.resolve([])}getNextCollectionGroupToUpdate(e){return q.resolve(null)}getMinOffset(e,t){return q.resolve(Ji.min())}getMinOffsetFromCollectionGroup(e,t){return q.resolve(Ji.min())}updateCollectionGroup(e,t,i){return q.resolve()}updateIndexEntries(e,t){return q.resolve()}}class Jx{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t]||new Tt(gt.comparator),s=!r.has(i);return this.index[t]=r.add(i),s}has(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t];return r&&r.has(i)}getEntries(e){return(this.index[e]||new Tt(gt.comparator)).toArray()}}const aP="IndexedDbIndexManager",Sp=new Uint8Array(0);class WG{constructor(e,t){this.databaseId=t,this.vn=new Jx,this.Fn=new Ro((i=>fc(i)),((i,r)=>Lg(i,r))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const i=t.lastSegment(),r=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const s={collectionId:i,parent:ni(r)};return lP(e).put(s)}return q.resolve()}getCollectionParents(e,t){const i=[],r=IDBKeyRange.bound([t,""],[rk(t),""],!1,!0);return lP(e).J(r).next((s=>{for(const o of s){if(o.collectionId!==t)break;i.push(Ts(o.parent))}return i}))}addFieldIndex(e,t){const i=Fd(e),r=(function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map((c=>[c.fieldPath.canonicalString(),c.kind]))}})(t);delete r.indexId;const s=i.add(r);if(t.indexState){const o=Su(e);return s.next((a=>{o.put(JR(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return s.next()}deleteFieldIndex(e,t){const i=Fd(e),r=Su(e),s=xu(e);return i.delete(t.indexId).next((()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=Fd(e),i=xu(e),r=Su(e);return t.Z().next((()=>i.Z())).next((()=>r.Z()))}createTargetIndexes(e,t){return q.forEach(this.Mn(t),(i=>this.getIndexType(e,i).next((r=>{if(r===0||r===1){const s=new sP(i).Dn();if(s!=null)return this.addFieldIndex(e,s)}}))))}getDocumentsMatchingTarget(e,t){const i=xu(e);let r=!0;const s=new Map;return q.forEach(this.Mn(t),(o=>this.xn(e,o).next((a=>{r&&(r=!!a),s.set(o,a)})))).next((()=>{if(r){let o=Ze();const a=[];return q.forEach(s,((c,h)=>{ue(aP,`Using index ${(function(C){return`id=${C.indexId}|cg=${C.collectionGroup}|f=${C.fields.map((N=>`${N.fieldPath}:${N.kind}`)).join(",")}`})(c)} to execute ${fc(t)}`);const d=(function(C,N){const D=BE(N);if(D===void 0)return null;for(const z of j0(C,D.fieldPath))switch(z.op){case"array-contains-any":return z.value.arrayValue.values||[];case"array-contains":return[z.value]}return null})(h,c),g=(function(C,N){const D=new Map;for(const z of bl(N))for(const k of j0(C,z.fieldPath))switch(k.op){case"==":case"in":D.set(z.fieldPath.canonicalString(),k.value);break;case"not-in":case"!=":return D.set(z.fieldPath.canonicalString(),k.value),Array.from(D.values())}return null})(h,c),m=(function(C,N){const D=[];let z=!0;for(const k of bl(N)){const R=k.kind===0?jR(C,k.fieldPath,C.startAt):GR(C,k.fieldPath,C.startAt);D.push(R.value),z&&(z=R.inclusive)}return new wh(D,z)})(h,c),v=(function(C,N){const D=[];let z=!0;for(const k of bl(N)){const R=k.kind===0?GR(C,k.fieldPath,C.endAt):jR(C,k.fieldPath,C.endAt);D.push(R.value),z&&(z=R.inclusive)}return new wh(D,z)})(h,c),y=this.On(c,h,m),T=this.On(c,h,v),w=this.Nn(c,h,g),A=this.Bn(c.indexId,d,y,m.inclusive,T,v.inclusive,w);return q.forEach(A,(P=>i.Y(P,t.limit).next((C=>{C.forEach((N=>{const D=pe.fromSegments(N.documentKey);o.has(D)||(o=o.add(D),a.push(D))}))}))))})).next((()=>a))}return q.resolve(null)}))}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=BG(St.create(e.filters,"and")).map((i=>QE(e.path,e.collectionGroup,e.orderBy,i.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,t),t)}Bn(e,t,i,r,s,o,a){const c=(t!=null?t.length:1)*Math.max(i.length,s.length),h=c/(t!=null?t.length:1),d=[];for(let g=0;g<c;++g){const m=t?this.Ln(t[g/h]):Sp,v=this.kn(e,m,i[g%h],r),y=this.qn(e,m,s[g%h],o),T=a.map((w=>this.kn(e,m,w,!0)));d.push(...this.createRange(v,y,T))}return d}kn(e,t,i,r){const s=new Gl(e,pe.empty(),t,i);return r?s:s.An()}qn(e,t,i,r){const s=new Gl(e,pe.empty(),t,i);return r?s.An():s}xn(e,t){const i=new sP(t),r=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next((s=>{let o=null;for(const a of s)i.yn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o}))}getIndexType(e,t){let i=2;const r=this.Mn(t);return q.forEach(r,(s=>this.xn(e,s).next((o=>{o?i!==0&&o.fields.length<(function(c){let h=new Tt(Bt.comparator),d=!1;for(const g of c.filters)for(const m of g.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?d=!0:h=h.add(m.field));for(const g of c.orderBy)g.field.isKeyField()||(h=h.add(g.field));return h.size+(d?1:0)})(s)&&(i=1):i=0})))).next((()=>(function(o){return o.limit!==null})(t)&&r.length>1&&i===2?1:i))}Qn(e,t){const i=new Vd;for(const r of bl(e)){const s=t.data.field(r.fieldPath);if(s==null)return null;const o=i.Pn(r.kind);jl.Kt.Dt(s,o)}return i.un()}Ln(e){const t=new Vd;return jl.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const i=new Vd;return jl.Kt.Dt(tg(this.databaseId,t),i.Pn((function(s){const o=bl(s);return o.length===0?0:o[o.length-1].kind})(e))),i.un()}Nn(e,t,i){if(i===null)return[];let r=[];r.push(new Vd);let s=0;for(const o of bl(e)){const a=i[s++];for(const c of r)if(this.Un(t,o.fieldPath)&&ng(a))r=this.Kn(r,o,a);else{const h=c.Pn(o.kind);jl.Kt.Dt(a,h)}}return this.Wn(r)}On(e,t,i){return this.Nn(e,t,i.position)}Wn(e){const t=[];for(let i=0;i<e.length;++i)t[i]=e[i].un();return t}Kn(e,t,i){const r=[...e],s=[];for(const o of i.arrayValue.values||[])for(const a of r){const c=new Vd;c.seed(a.un()),jl.Kt.Dt(o,c.Pn(t.kind)),s.push(c)}return s}Un(e,t){return!!e.filters.find((i=>i instanceof tt&&i.field.isEqual(t)&&(i.op==="in"||i.op==="not-in")))}getFieldIndexes(e,t){const i=Fd(e),r=Su(e);return(t?i.J(WE,IDBKeyRange.bound(t,t)):i.J()).next((s=>{const o=[];return q.forEach(s,(a=>r.get([a.indexId,this.uid]).next((c=>{o.push((function(d,g){const m=g?new Hf(g.sequenceNumber,new Ji(mc(g.readTime),new pe(Ts(g.documentKey)),g.largestBatchId)):Hf.empty(),v=d.fields.map((([y,T])=>new Up(Bt.fromServerFormat(y),T)));return new k0(d.indexId,d.collectionGroup,v,m)})(a,c))})))).next((()=>o))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((i,r)=>{const s=i.indexState.sequenceNumber-r.indexState.sequenceNumber;return s!==0?s:$e(i.collectionGroup,r.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,i){const r=Fd(e),s=Su(e);return this.Gn(e).next((o=>r.J(WE,IDBKeyRange.bound(t,t)).next((a=>q.forEach(a,(c=>s.put(JR(c.indexId,this.uid,o,i))))))))}updateIndexEntries(e,t){const i=new Map;return q.forEach(t,((r,s)=>{const o=i.get(r.collectionGroup);return(o?q.resolve(o):this.getFieldIndexes(e,r.collectionGroup)).next((a=>(i.set(r.collectionGroup,a),q.forEach(a,(c=>this.zn(e,r,c).next((h=>{const d=this.jn(s,c);return h.isEqual(d)?q.resolve():this.Jn(e,s,c,h,d)})))))))}))}Hn(e,t,i,r){return xu(e).put(r.Rn(this.uid,this.$n(i,t.key),t.key))}Yn(e,t,i,r){return xu(e).delete(r.Vn(this.uid,this.$n(i,t.key),t.key))}zn(e,t,i){const r=xu(e);let s=new Tt(oa);return r.ee({index:mk,range:IDBKeyRange.only([i.indexId,this.uid,Xp(this.$n(i,t))])},((o,a)=>{s=s.add(new Gl(i.indexId,t,rP(a.arrayValue),rP(a.directionalValue)))})).next((()=>s))}jn(e,t){let i=new Tt(oa);const r=this.Qn(t,e);if(r==null)return i;const s=BE(t);if(s!=null){const o=e.data.field(s.fieldPath);if(ng(o))for(const a of o.arrayValue.values||[])i=i.add(new Gl(t.indexId,e.key,this.Ln(a),r))}else i=i.add(new Gl(t.indexId,e.key,Sp,r));return i}Jn(e,t,i,r,s){ue(aP,"Updating index entries for document '%s'",t.key);const o=[];return(function(c,h,d,g,m){const v=c.getIterator(),y=h.getIterator();let T=Eu(v),w=Eu(y);for(;T||w;){let A=!1,P=!1;if(T&&w){const C=d(T,w);C<0?P=!0:C>0&&(A=!0)}else T!=null?P=!0:A=!0;A?(g(w),w=Eu(y)):P?(m(T),T=Eu(v)):(T=Eu(v),w=Eu(y))}})(r,s,oa,(a=>{o.push(this.Hn(e,t,i,a))}),(a=>{o.push(this.Yn(e,t,i,a))})),q.waitFor(o)}Gn(e){let t=1;return Su(e).ee({index:gk,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((i,r,s)=>{s.done(),t=r.sequenceNumber+1})).next((()=>t))}createRange(e,t,i){i=i.sort(((o,a)=>oa(o,a))).filter(((o,a,c)=>!a||oa(o,c[a-1])!==0));const r=[];r.push(e);for(const o of i){const a=oa(o,e),c=oa(o,t);if(a===0)r[0]=e.An();else if(a>0&&c<0)r.push(o),r.push(o.An());else if(c>0)break}r.push(t);const s=[];for(let o=0;o<r.length;o+=2){if(this.Zn(r[o],r[o+1]))return[];const a=r[o].Vn(this.uid,Sp,pe.empty()),c=r[o+1].Vn(this.uid,Sp,pe.empty());s.push(IDBKeyRange.bound(a,c))}return s}Zn(e,t){return oa(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(cP)}getMinOffset(e,t){return q.mapArray(this.Mn(t),(i=>this.xn(e,i).next((r=>r||Se(44426))))).next(cP)}}function lP(n){return yn(n,Qf)}function xu(n){return yn(n,mf)}function Fd(n){return yn(n,Fx)}function Su(n){return yn(n,gf)}function cP(n){Ce(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let i=1;i<n.length;i++){const r=n[i].indexState.offset;Dx(r,e)<0&&(e=r),t<r.largestBatchId&&(t=r.largestBatchId)}return new Ji(e.readTime,e.documentKey,t)}const uP={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},_L=41943040;class Zn{static withCacheSize(e){return new Zn(e,Zn.DEFAULT_COLLECTION_PERCENTILE,Zn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}function yL(n,e,t){const i=n.store(Ur),r=n.store(mh),s=[],o=IDBKeyRange.only(t.batchId);let a=0;const c=i.ee({range:o},((d,g,m)=>(a++,m.delete())));s.push(c.next((()=>{Ce(a===1,47070,{batchId:t.batchId})})));const h=[];for(const d of t.mutations){const g=hk(e,d.key.path,t.batchId);s.push(r.delete(g)),h.push(d.key)}return q.waitFor(s).next((()=>h))}function $0(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Se(14731);e=n.noDocument}return JSON.stringify(e).length}Zn.DEFAULT_COLLECTION_PERCENTILE=10,Zn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Zn.DEFAULT=new Zn(_L,Zn.DEFAULT_COLLECTION_PERCENTILE,Zn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Zn.DISABLED=new Zn(-1,0,0);class ry{constructor(e,t,i,r){this.userId=e,this.serializer=t,this.indexManager=i,this.referenceDelegate=r,this.Xn={}}static wt(e,t,i,r){Ce(e.uid!=="",64387);const s=e.isAuthenticated()?e.uid:"";return new ry(s,t,i,r)}checkEmpty(e){let t=!0;const i=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return aa(e).ee({index:Kl,range:i},((r,s,o)=>{t=!1,o.done()})).next((()=>t))}addMutationBatch(e,t,i,r){const s=Lu(e),o=aa(e);return o.add({}).next((a=>{Ce(typeof a=="number",49019);const c=new qx(a,t,i,r),h=(function(v,y,T){const w=T.baseMutations.map((P=>U0(v.yt,P))),A=T.mutations.map((P=>U0(v.yt,P)));return{userId:y,batchId:T.batchId,localWriteTimeMs:T.localWriteTime.toMillis(),baseMutations:w,mutations:A}})(this.serializer,this.userId,c),d=[];let g=new Tt(((m,v)=>$e(m.canonicalString(),v.canonicalString())));for(const m of r){const v=hk(this.userId,m.key.path,a);g=g.add(m.key.path.popLast()),d.push(o.put(h)),d.push(s.put(v,vj))}return g.forEach((m=>{d.push(this.indexManager.addToCollectionParentIndex(e,m))})),e.addOnCommittedListener((()=>{this.Xn[a]=c.keys()})),q.waitFor(d).next((()=>c))}))}lookupMutationBatch(e,t){return aa(e).get(t).next((i=>i?(Ce(i.userId===this.userId,48,"Unexpected user for mutation batch",{userId:i.userId,batchId:t}),Fl(this.serializer,i)):null))}er(e,t){return this.Xn[t]?q.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next((i=>{if(i){const r=i.keys();return this.Xn[t]=r,r}return null}))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=IDBKeyRange.lowerBound([this.userId,i]);let s=null;return aa(e).ee({index:Kl,range:r},((o,a,c)=>{a.userId===this.userId&&(Ce(a.batchId>=i,47524,{tr:i}),s=Fl(this.serializer,a)),c.done()})).next((()=>s))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let i=Yl;return aa(e).ee({index:Kl,range:t,reverse:!0},((r,s,o)=>{i=s.batchId,o.done()})).next((()=>i))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,Yl],[this.userId,Number.POSITIVE_INFINITY]);return aa(e).J(Kl,t).next((i=>i.map((r=>Fl(this.serializer,r)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const i=zp(this.userId,t.path),r=IDBKeyRange.lowerBound(i),s=[];return Lu(e).ee({range:r},((o,a,c)=>{const[h,d,g]=o,m=Ts(d);if(h===this.userId&&t.path.isEqual(m))return aa(e).get(g).next((v=>{if(!v)throw Se(61480,{nr:o,batchId:g});Ce(v.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:v.userId,batchId:g}),s.push(Fl(this.serializer,v))}));c.done()})).next((()=>s))}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Tt($e);const r=[];return t.forEach((s=>{const o=zp(this.userId,s.path),a=IDBKeyRange.lowerBound(o),c=Lu(e).ee({range:a},((h,d,g)=>{const[m,v,y]=h,T=Ts(v);m===this.userId&&s.path.isEqual(T)?i=i.add(y):g.done()}));r.push(c)})),q.waitFor(r).next((()=>this.rr(e,i)))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1,s=zp(this.userId,i),o=IDBKeyRange.lowerBound(s);let a=new Tt($e);return Lu(e).ee({range:o},((c,h,d)=>{const[g,m,v]=c,y=Ts(m);g===this.userId&&i.isPrefixOf(y)?y.length===r&&(a=a.add(v)):d.done()})).next((()=>this.rr(e,a)))}rr(e,t){const i=[],r=[];return t.forEach((s=>{r.push(aa(e).get(s).next((o=>{if(o===null)throw Se(35274,{batchId:s});Ce(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:s}),i.push(Fl(this.serializer,o))})))})),q.waitFor(r).next((()=>i))}removeMutationBatch(e,t){return yL(e.le,this.userId,t).next((i=>(e.addOnCommittedListener((()=>{this.ir(t.batchId)})),q.forEach(i,(r=>this.referenceDelegate.markPotentiallyOrphaned(e,r))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return q.resolve();const i=IDBKeyRange.lowerBound((function(o){return[o]})(this.userId)),r=[];return Lu(e).ee({range:i},((s,o,a)=>{if(s[0]===this.userId){const c=Ts(s[1]);r.push(c)}else a.done()})).next((()=>{Ce(r.length===0,56720,{sr:r.map((s=>s.canonicalString()))})}))}))}containsKey(e,t){return vL(e,this.userId,t)}_r(e){return EL(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:Yl,lastStreamToken:""}))}}function vL(n,e,t){const i=zp(e,t.path),r=i[1],s=IDBKeyRange.lowerBound(i);let o=!1;return Lu(n).ee({range:s,X:!0},((a,c,h)=>{const[d,g,m]=a;d===e&&g===r&&(o=!0),h.done()})).next((()=>o))}function aa(n){return yn(n,Ur)}function Lu(n){return yn(n,mh)}function EL(n){return yn(n,Yf)}class pc{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new pc(0)}static cr(){return new pc(-1)}}class KG{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next((t=>{const i=new pc(t.highestTargetId);return t.highestTargetId=i.next(),this.hr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((t=>be.fromTimestamp(new xt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,i){return this.lr(e).next((r=>(r.highestListenSequenceNumber=t,i&&(r.lastRemoteSnapshotVersion=i.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.hr(e,r))))}addTargetData(e,t){return this.Pr(e,t).next((()=>this.lr(e).next((i=>(i.targetCount+=1,this.Tr(t,i),this.hr(e,i))))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>Tu(e).delete(t.targetId))).next((()=>this.lr(e))).next((i=>(Ce(i.targetCount>0,8065),i.targetCount-=1,this.hr(e,i))))}removeTargets(e,t,i){let r=0;const s=[];return Tu(e).ee(((o,a)=>{const c=ef(a);c.sequenceNumber<=t&&i.get(c.targetId)===null&&(r++,s.push(this.removeTargetData(e,c)))})).next((()=>q.waitFor(s))).next((()=>r))}forEachTarget(e,t){return Tu(e).ee(((i,r)=>{const s=ef(r);t(s)}))}lr(e){return hP(e).get(D0).next((t=>(Ce(t!==null,2888),t)))}hr(e,t){return hP(e).put(D0,t)}Pr(e,t){return Tu(e).put(fL(this.serializer,t))}Tr(e,t){let i=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,i=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,i=!0),i}getTargetCount(e){return this.lr(e).next((t=>t.targetCount))}getTargetData(e,t){const i=fc(t),r=IDBKeyRange.bound([i,Number.NEGATIVE_INFINITY],[i,Number.POSITIVE_INFINITY]);let s=null;return Tu(e).ee({range:r,index:fk},((o,a,c)=>{const h=ef(a);Lg(t,h.target)&&(s=h,c.done())})).next((()=>s))}addMatchingKeys(e,t,i){const r=[],s=pa(e);return t.forEach((o=>{const a=ni(o.path);r.push(s.put({targetId:i,path:a})),r.push(this.referenceDelegate.addReference(e,i,o))})),q.waitFor(r)}removeMatchingKeys(e,t,i){const r=pa(e);return q.forEach(t,(s=>{const o=ni(s.path);return q.waitFor([r.delete([i,o]),this.referenceDelegate.removeReference(e,i,s)])}))}removeMatchingKeysForTargetId(e,t){const i=pa(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return i.delete(r)}getMatchingKeysForTargetId(e,t){const i=IDBKeyRange.bound([t],[t+1],!1,!0),r=pa(e);let s=Ze();return r.ee({range:i,X:!0},((o,a,c)=>{const h=Ts(o[1]),d=new pe(h);s=s.add(d)})).next((()=>s))}containsKey(e,t){const i=ni(t.path),r=IDBKeyRange.bound([i],[rk(i)],!1,!0);let s=0;return pa(e).ee({index:Vx,X:!0,range:r},(([o,a],c,h)=>{o!==0&&(s++,h.done())})).next((()=>s>0))}At(e,t){return Tu(e).get(t).next((i=>i?ef(i):null))}}function Tu(n){return yn(n,ph)}function hP(n){return yn(n,Zl)}function pa(n){return yn(n,_h)}const dP="LruGarbageCollector",qG=1048576;function fP([n,e],[t,i]){const r=$e(n,t);return r===0?$e(e,i):r}class HG{constructor(e){this.Ir=e,this.buffer=new Tt(fP),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();fP(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class wL{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){ue(dP,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Xa(t)?ue(dP,"Ignoring IndexedDB error during garbage collection: ",t):await Ac(t)}await this.Vr(3e5)}))}}class XG{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return q.resolve(Sr.ce);const i=new HG(t);return this.mr.forEachTarget(e,(r=>i.Ar(r.sequenceNumber))).next((()=>this.mr.pr(e,(r=>i.Ar(r))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.mr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(ue("LruGarbageCollector","Garbage collection skipped; disabled"),q.resolve(uP)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(ue("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),uP):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let i,r,s,o,a,c,h;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((g=>(g>this.params.maximumSequenceNumbersToCollect?(ue("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${g}`),r=this.params.maximumSequenceNumbersToCollect):r=g,o=Date.now(),this.nthSequenceNumber(e,r)))).next((g=>(i=g,a=Date.now(),this.removeTargets(e,i,t)))).next((g=>(s=g,c=Date.now(),this.removeOrphanedDocuments(e,i)))).next((g=>(h=Date.now(),Cu()<=et.DEBUG&&ue("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${r} in `+(a-o)+`ms
	Removed ${s} targets in `+(c-a)+`ms
	Removed ${g} documents in `+(h-c)+`ms
Total Duration: ${h-d}ms`),q.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:g}))))}}function xL(n,e){return new XG(n,e)}class YG{constructor(e,t){this.db=e,this.garbageCollector=xL(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((i=>t.next((r=>i+r))))}wr(e){let t=0;return this.pr(e,(i=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,((i,r)=>t(r)))}addReference(e,t,i){return Tp(e,i)}removeReference(e,t,i){return Tp(e,i)}removeTargets(e,t,i){return this.db.getTargetCache().removeTargets(e,t,i)}markPotentiallyOrphaned(e,t){return Tp(e,t)}br(e,t){return(function(r,s){let o=!1;return EL(r).te((a=>vL(r,a,s).next((c=>(c&&(o=!0),q.resolve(!c)))))).next((()=>o))})(e,t)}removeOrphanedDocuments(e,t){const i=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let s=0;return this.Sr(e,((o,a)=>{if(a<=t){const c=this.br(e,o).next((h=>{if(!h)return s++,i.getEntry(e,o).next((()=>(i.removeEntry(o,be.min()),pa(e).delete((function(g){return[0,ni(g.path)]})(o)))))}));r.push(c)}})).next((()=>q.waitFor(r))).next((()=>i.apply(e))).next((()=>s))}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,i)}updateLimboDocument(e,t){return Tp(e,t)}Sr(e,t){const i=pa(e);let r,s=Sr.ce;return i.ee({index:Vx},(([o,a],{path:c,sequenceNumber:h})=>{o===0?(s!==Sr.ce&&t(new pe(Ts(r)),s),s=h,r=c):s=Sr.ce})).next((()=>{s!==Sr.ce&&t(new pe(Ts(r)),s)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Tp(n,e){return pa(n).put((function(i,r){return{targetId:0,path:ni(i.path),sequenceNumber:r}})(e,n.currentSequenceNumber))}class SL{constructor(){this.changes=new Ro((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Xt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?q.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class ZG{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,i){return Al(e).put(i)}removeEntry(e,t,i){return Al(e).delete((function(s,o){const a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],z0(o),a[a.length-1]]})(t,i))}updateMetadata(e,t){return this.getMetadata(e).next((i=>(i.byteSize+=t,this.Dr(e,i))))}getEntry(e,t){let i=Xt.newInvalidDocument(t);return Al(e).ee({index:Bp,range:IDBKeyRange.only(jd(t))},((r,s)=>{i=this.Cr(t,s)})).next((()=>i))}vr(e,t){let i={size:0,document:Xt.newInvalidDocument(t)};return Al(e).ee({index:Bp,range:IDBKeyRange.only(jd(t))},((r,s)=>{i={document:this.Cr(t,s),size:$0(s)}})).next((()=>i))}getEntries(e,t){let i=Hi();return this.Fr(e,t,((r,s)=>{const o=this.Cr(r,s);i=i.insert(r,o)})).next((()=>i))}Mr(e,t){let i=Hi(),r=new jt(pe.comparator);return this.Fr(e,t,((s,o)=>{const a=this.Cr(s,o);i=i.insert(s,a),r=r.insert(s,$0(o))})).next((()=>({documents:i,Or:r})))}Fr(e,t,i){if(t.isEmpty())return q.resolve();let r=new Tt(pP);t.forEach((c=>r=r.add(c)));const s=IDBKeyRange.bound(jd(r.first()),jd(r.last())),o=r.getIterator();let a=o.getNext();return Al(e).ee({index:Bp,range:s},((c,h,d)=>{const g=pe.fromSegments([...h.prefixPath,h.collectionGroup,h.documentId]);for(;a&&pP(a,g)<0;)i(a,null),a=o.getNext();a&&a.isEqual(g)&&(i(a,h),a=o.hasNext()?o.getNext():null),a?d.j(jd(a)):d.done()})).next((()=>{for(;a;)i(a,null),a=o.hasNext()?o.getNext():null}))}getDocumentsMatchingQuery(e,t,i,r,s){const o=t.path,a=[o.popLast().toArray(),o.lastSegment(),z0(i.readTime),i.documentKey.path.isEmpty()?"":i.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Al(e).J(IDBKeyRange.bound(a,c,!0)).next((h=>{s?.incrementDocumentReadCount(h.length);let d=Hi();for(const g of h){const m=this.Cr(pe.fromSegments(g.prefixPath.concat(g.collectionGroup,g.documentId)),g);m.isFoundDocument()&&(Dg(t,m)||r.has(m.key))&&(d=d.insert(m.key,m))}return d}))}getAllFromCollectionGroup(e,t,i,r){let s=Hi();const o=mP(t,i),a=mP(t,Ji.max());return Al(e).ee({index:dk,range:IDBKeyRange.bound(o,a,!0)},((c,h,d)=>{const g=this.Cr(pe.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);s=s.insert(g.key,g),s.size===r&&d.done()})).next((()=>s))}newChangeBuffer(e){return new QG(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return gP(e).get($E).next((t=>(Ce(!!t,20021),t)))}Dr(e,t){return gP(e).put($E,t)}Cr(e,t){if(t){const i=OG(this.serializer,t);if(!(i.isNoDocument()&&i.version.isEqual(be.min())))return i}return Xt.newInvalidDocument(e)}}function TL(n){return new ZG(n)}class QG extends SL{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new Ro((i=>i.toString()),((i,r)=>i.isEqual(r)))}applyChanges(e){const t=[];let i=0,r=new Tt(((s,o)=>$e(s.canonicalString(),o.canonicalString())));return this.changes.forEach(((s,o)=>{const a=this.Br.get(s);if(t.push(this.Nr.removeEntry(e,s,a.readTime)),o.isValidDocument()){const c=ZR(this.Nr.serializer,o);r=r.add(s.path.popLast());const h=$0(c);i+=h-a.size,t.push(this.Nr.addEntry(e,s,c))}else if(i-=a.size,this.trackRemovals){const c=ZR(this.Nr.serializer,o.convertToNoDocument(be.min()));t.push(this.Nr.addEntry(e,s,c))}})),r.forEach((s=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,s))})),t.push(this.Nr.updateMetadata(e,i)),q.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next((i=>(this.Br.set(t,{size:i.size,readTime:i.document.readTime}),i.document)))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next((({documents:i,Or:r})=>(r.forEach(((s,o)=>{this.Br.set(s,{size:o,readTime:i.get(s).readTime})})),i)))}}function gP(n){return yn(n,Zf)}function Al(n){return yn(n,N0)}function jd(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function mP(n,e){const t=e.documentKey.path.toArray();return[n,z0(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function pP(n,e){const t=n.path.toArray(),i=e.path.toArray();let r=0;for(let s=0;s<t.length-2&&s<i.length-2;++s)if(r=$e(t[s],i[s]),r)return r;return r=$e(t.length,i.length),r||(r=$e(t[t.length-2],i[i.length-2]),r||$e(t[t.length-1],i[i.length-1]))}class JG{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class IL{constructor(e,t,i,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(i=r,this.remoteDocumentCache.getEntry(e,t)))).next((r=>(i!==null&&vf(i.mutation,r,bi.empty(),xt.now()),r)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,Ze()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=Ze()){const r=Is();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,i).next((s=>{let o=Qd();return s.forEach(((a,c)=>{o=o.insert(a,c.overlayedDocument)})),o}))))}getOverlayedDocuments(e,t){const i=Is();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,Ze())))}populateOverlays(e,t,i){const r=[];return i.forEach((s=>{t.has(s)||r.push(s)})),this.documentOverlayCache.getOverlays(e,r).next((s=>{s.forEach(((o,a)=>{t.set(o,a)}))}))}computeViews(e,t,i,r){let s=Hi();const o=yf(),a=(function(){return yf()})();return t.forEach(((c,h)=>{const d=i.get(h.key);r.has(h.key)&&(d===void 0||d.mutation instanceof Po)?s=s.insert(h.key,h):d!==void 0?(o.set(h.key,d.mutation.getFieldMask()),vf(d.mutation,h,d.mutation.getFieldMask(),xt.now())):o.set(h.key,bi.empty())})),this.recalculateAndSaveOverlays(e,s).next((c=>(c.forEach(((h,d)=>o.set(h,d))),t.forEach(((h,d)=>a.set(h,new JG(d,o.get(h)??null)))),a)))}recalculateAndSaveOverlays(e,t){const i=yf();let r=new jt(((o,a)=>o-a)),s=Ze();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((o=>{for(const a of o)a.keys().forEach((c=>{const h=t.get(c);if(h===null)return;let d=i.get(c)||bi.empty();d=a.applyToLocalView(h,d),i.set(c,d);const g=(r.get(a.batchId)||Ze()).add(c);r=r.insert(a.batchId,g)}))})).next((()=>{const o=[],a=r.getReverseIterator();for(;a.hasNext();){const c=a.getNext(),h=c.key,d=c.value,g=Bk();d.forEach((m=>{if(!s.has(m)){const v=Xk(t.get(m),i.get(m));v!==null&&g.set(m,v),s=s.add(m)}})),o.push(this.documentOverlayCache.saveOverlays(e,h,g))}return q.waitFor(o)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,r){return(function(o){return pe.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Fk(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,r):this.getDocumentsMatchingCollectionQuery(e,t,i,r)}getNextDocuments(e,t,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,r).next((s=>{const o=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,r-s.size):q.resolve(Is());let a=qf,c=s;return o.next((h=>q.forEach(h,((d,g)=>(a<g.largestBatchId&&(a=g.largestBatchId),s.get(d)?q.resolve():this.remoteDocumentCache.getEntry(e,d).next((m=>{c=c.insert(d,m)}))))).next((()=>this.populateOverlays(e,h,s))).next((()=>this.computeViews(e,c,h,Ze()))).next((d=>({batchId:a,changes:zk(d)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new pe(t)).next((i=>{let r=Qd();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,r){const s=t.collectionGroup;let o=Qd();return this.indexManager.getCollectionParents(e,s).next((a=>q.forEach(a,(c=>{const h=(function(g,m){return new Ng(m,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)})(t,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,h,i,r).next((d=>{d.forEach(((g,m)=>{o=o.insert(g,m)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,t,i,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,s,r)))).next((o=>{s.forEach(((c,h)=>{const d=h.getKey();o.get(d)===null&&(o=o.insert(d,Xt.newInvalidDocument(d)))}));let a=Qd();return o.forEach(((c,h)=>{const d=s.get(c);d!==void 0&&vf(d.mutation,h,bi.empty(),xt.now()),Dg(t,h)&&(a=a.insert(c,h))})),a}))}}class eU{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return q.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(r){return{id:r.id,version:r.version,createTime:fi(r.createTime)}})(t)),q.resolve()}getNamedQuery(e,t){return q.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(r){return{name:r.name,query:gL(r.bundledQuery),readTime:fi(r.readTime)}})(t)),q.resolve()}}class tU{constructor(){this.overlays=new jt(pe.comparator),this.qr=new Map}getOverlay(e,t){return q.resolve(this.overlays.get(t))}getOverlays(e,t){const i=Is();return q.forEach(t,(r=>this.getOverlay(e,r).next((s=>{s!==null&&i.set(r,s)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((r,s)=>{this.St(e,t,s)})),q.resolve()}removeOverlaysForBatchId(e,t,i){const r=this.qr.get(i);return r!==void 0&&(r.forEach((s=>this.overlays=this.overlays.remove(s))),this.qr.delete(i)),q.resolve()}getOverlaysForCollection(e,t,i){const r=Is(),s=t.length+1,o=new pe(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const c=a.getNext().value,h=c.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===s&&c.largestBatchId>i&&r.set(c.getKey(),c)}return q.resolve(r)}getOverlaysForCollectionGroup(e,t,i,r){let s=new jt(((h,d)=>h-d));const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>i){let d=s.get(h.largestBatchId);d===null&&(d=Is(),s=s.insert(h.largestBatchId,d)),d.set(h.getKey(),h)}}const a=Is(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach(((h,d)=>a.set(h,d))),!(a.size()>=r)););return q.resolve(a)}St(e,t,i){const r=this.overlays.get(i.key);if(r!==null){const o=this.qr.get(r.largestBatchId).delete(i.key);this.qr.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(i.key,new Xx(t,i));let s=this.qr.get(t);s===void 0&&(s=Ze(),this.qr.set(t,s)),this.qr.set(t,s.add(i.key))}}class nU{constructor(){this.sessionToken=cn.EMPTY_BYTE_STRING}getSessionToken(e){return q.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,q.resolve()}}class eS{constructor(){this.Qr=new Tt(In.$r),this.Ur=new Tt(In.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const i=new In(e,t);this.Qr=this.Qr.add(i),this.Ur=this.Ur.add(i)}Wr(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Gr(new In(e,t))}zr(e,t){e.forEach((i=>this.removeReference(i,t)))}jr(e){const t=new pe(new gt([])),i=new In(t,e),r=new In(t,e+1),s=[];return this.Ur.forEachInRange([i,r],(o=>{this.Gr(o),s.push(o.key)})),s}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new pe(new gt([])),i=new In(t,e),r=new In(t,e+1);let s=Ze();return this.Ur.forEachInRange([i,r],(o=>{s=s.add(o.key)})),s}containsKey(e){const t=new In(e,0),i=this.Qr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class In{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return pe.comparator(e.key,t.key)||$e(e.Yr,t.Yr)}static Kr(e,t){return $e(e.Yr,t.Yr)||pe.comparator(e.key,t.key)}}class iU{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Tt(In.$r)}checkEmpty(e){return q.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,r){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new qx(s,t,i,r);this.mutationQueue.push(o);for(const a of r)this.Zr=this.Zr.add(new In(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return q.resolve(o)}lookupMutationBatch(e,t){return q.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=this.ei(i),s=r<0?0:r;return q.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return q.resolve(this.mutationQueue.length===0?Yl:this.tr-1)}getAllMutationBatches(e){return q.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new In(t,0),r=new In(t,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([i,r],(o=>{const a=this.Xr(o.Yr);s.push(a)})),q.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Tt($e);return t.forEach((r=>{const s=new In(r,0),o=new In(r,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,o],(a=>{i=i.add(a.Yr)}))})),q.resolve(this.ti(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1;let s=i;pe.isDocumentKey(s)||(s=s.child(""));const o=new In(new pe(s),0);let a=new Tt($e);return this.Zr.forEachWhile((c=>{const h=c.key.path;return!!i.isPrefixOf(h)&&(h.length===r&&(a=a.add(c.Yr)),!0)}),o),q.resolve(this.ti(a))}ti(e){const t=[];return e.forEach((i=>{const r=this.Xr(i);r!==null&&t.push(r)})),t}removeMutationBatch(e,t){Ce(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Zr;return q.forEach(t.mutations,(r=>{const s=new In(r.key,t.batchId);return i=i.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.Zr=i}))}ir(e){}containsKey(e,t){const i=new In(t,0),r=this.Zr.firstAfterOrEqual(i);return q.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,q.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class rU{constructor(e){this.ri=e,this.docs=(function(){return new jt(pe.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,r=this.docs.get(i),s=r?r.size:0,o=this.ri(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return q.resolve(i?i.document.mutableCopy():Xt.newInvalidDocument(t))}getEntries(e,t){let i=Hi();return t.forEach((r=>{const s=this.docs.get(r);i=i.insert(r,s?s.document.mutableCopy():Xt.newInvalidDocument(r))})),q.resolve(i)}getDocumentsMatchingQuery(e,t,i,r){let s=Hi();const o=t.path,a=new pe(o.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){const{key:h,value:{document:d}}=c.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||Dx(ak(d),i)<=0||(r.has(d.key)||Dg(t,d))&&(s=s.insert(d.key,d.mutableCopy()))}return q.resolve(s)}getAllFromCollectionGroup(e,t,i,r){Se(9500)}ii(e,t){return q.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new sU(this)}getSize(e){return q.resolve(this.size)}}class sU extends SL{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(i)})),q.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class oU{constructor(e){this.persistence=e,this.si=new Ro((t=>fc(t)),Lg),this.lastRemoteSnapshotVersion=be.min(),this.highestTargetId=0,this.oi=0,this._i=new eS,this.targetCount=0,this.ai=pc.ur()}forEachTarget(e,t){return this.si.forEach(((i,r)=>t(r))),q.resolve()}getLastRemoteSnapshotVersion(e){return q.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return q.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),q.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.oi&&(this.oi=t),q.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new pc(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,q.resolve()}updateTargetData(e,t){return this.Pr(t),q.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,q.resolve()}removeTargets(e,t,i){let r=0;const s=[];return this.si.forEach(((o,a)=>{a.sequenceNumber<=t&&i.get(a.targetId)===null&&(this.si.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),r++)})),q.waitFor(s).next((()=>r))}getTargetCount(e){return q.resolve(this.targetCount)}getTargetData(e,t){const i=this.si.get(t)||null;return q.resolve(i)}addMatchingKeys(e,t,i){return this._i.Wr(t,i),q.resolve()}removeMatchingKeys(e,t,i){this._i.zr(t,i);const r=this.persistence.referenceDelegate,s=[];return r&&t.forEach((o=>{s.push(r.markPotentiallyOrphaned(e,o))})),q.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),q.resolve()}getMatchingKeysForTargetId(e,t){const i=this._i.Hr(t);return q.resolve(i)}containsKey(e,t){return q.resolve(this._i.containsKey(t))}}class tS{constructor(e,t){this.ui={},this.overlays={},this.ci=new Sr(0),this.li=!1,this.li=!0,this.hi=new nU,this.referenceDelegate=e(this),this.Pi=new oU(this),this.indexManager=new $G,this.remoteDocumentCache=(function(r){return new rU(r)})((i=>this.referenceDelegate.Ti(i))),this.serializer=new dL(t),this.Ii=new eU(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new tU,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.ui[e.toKey()];return i||(i=new iU(t,this.referenceDelegate),this.ui[e.toKey()]=i),i}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,i){ue("MemoryPersistence","Starting transaction:",e);const r=new aU(this.ci.next());return this.referenceDelegate.Ei(),i(r).next((s=>this.referenceDelegate.di(r).next((()=>s)))).toPromise().then((s=>(r.raiseOnCommittedEvent(),s)))}Ai(e,t){return q.or(Object.values(this.ui).map((i=>()=>i.containsKey(e,t))))}}class aU extends ck{constructor(e){super(),this.currentSequenceNumber=e}}class sy{constructor(e){this.persistence=e,this.Ri=new eS,this.Vi=null}static mi(e){return new sy(e)}get fi(){if(this.Vi)return this.Vi;throw Se(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.fi.delete(i.toString()),q.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.fi.add(i.toString()),q.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),q.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((r=>this.fi.add(r.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((r=>{r.forEach((s=>this.fi.add(s.toString())))})).next((()=>i.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return q.forEach(this.fi,(i=>{const r=pe.fromPath(i);return this.gi(e,r).next((s=>{s||t.removeEntry(r,be.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((i=>{i?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return q.or([()=>q.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class W0{constructor(e,t){this.persistence=e,this.pi=new Ro((i=>ni(i.path)),((i,r)=>i.isEqual(r))),this.garbageCollector=xL(this,t)}static mi(e,t){return new W0(e,t)}Ei(){}di(e){return q.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((r=>i+r))))}wr(e){let t=0;return this.pr(e,(i=>{t++})).next((()=>t))}pr(e,t){return q.forEach(this.pi,((i,r)=>this.br(e,i,r).next((s=>s?q.resolve():t(r)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const r=this.persistence.getRemoteDocumentCache(),s=r.newChangeBuffer();return r.ii(e,(o=>this.br(e,o,t).next((a=>{a||(i++,s.removeEntry(o,be.min()))})))).next((()=>s.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),q.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.pi.set(i,e.currentSequenceNumber),q.resolve()}removeReference(e,t,i){return this.pi.set(i,e.currentSequenceNumber),q.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),q.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Wp(e.data.value)),t}br(e,t,i){return q.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const r=this.pi.get(t);return q.resolve(r!==void 0&&r>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class lU{constructor(e){this.serializer=e}k(e,t,i,r){const s=new W_("createOrUpgrade",t);i<1&&r>=1&&((function(c){c.createObjectStore(kg)})(e),(function(c){c.createObjectStore(Yf,{keyPath:yj}),c.createObjectStore(Ur,{keyPath:RR,autoIncrement:!0}).createIndex(Kl,PR,{unique:!0}),c.createObjectStore(mh)})(e),_P(e),(function(c){c.createObjectStore(kl)})(e));let o=q.resolve();return i<3&&r>=3&&(i!==0&&((function(c){c.deleteObjectStore(_h),c.deleteObjectStore(ph),c.deleteObjectStore(Zl)})(e),_P(e)),o=o.next((()=>(function(c){const h=c.store(Zl),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:be.min().toTimestamp(),targetCount:0};return h.put(D0,d)})(s)))),i<4&&r>=4&&(i!==0&&(o=o.next((()=>(function(c,h){return h.store(Ur).J().next((g=>{c.deleteObjectStore(Ur),c.createObjectStore(Ur,{keyPath:RR,autoIncrement:!0}).createIndex(Kl,PR,{unique:!0});const m=h.store(Ur),v=g.map((y=>m.put(y)));return q.waitFor(v)}))})(e,s)))),o=o.next((()=>{(function(c){c.createObjectStore(yh,{keyPath:Rj})})(e)}))),i<5&&r>=5&&(o=o.next((()=>this.yi(s)))),i<6&&r>=6&&(o=o.next((()=>((function(c){c.createObjectStore(Zf)})(e),this.wi(s))))),i<7&&r>=7&&(o=o.next((()=>this.Si(s)))),i<8&&r>=8&&(o=o.next((()=>this.bi(e,s)))),i<9&&r>=9&&(o=o.next((()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)}))),i<10&&r>=10&&(o=o.next((()=>this.Di(s)))),i<11&&r>=11&&(o=o.next((()=>{(function(c){c.createObjectStore(q_,{keyPath:Pj})})(e),(function(c){c.createObjectStore(H_,{keyPath:Cj})})(e)}))),i<12&&r>=12&&(o=o.next((()=>{(function(c){const h=c.createObjectStore(X_,{keyPath:Oj});h.createIndex(KE,Vj,{unique:!1}),h.createIndex(pk,Fj,{unique:!1})})(e)}))),i<13&&r>=13&&(o=o.next((()=>(function(c){const h=c.createObjectStore(N0,{keyPath:Ej});h.createIndex(Bp,wj),h.createIndex(dk,xj)})(e))).next((()=>this.Ci(e,s))).next((()=>e.deleteObjectStore(kl)))),i<14&&r>=14&&(o=o.next((()=>this.Fi(e,s)))),i<15&&r>=15&&(o=o.next((()=>(function(c){c.createObjectStore(Fx,{keyPath:Mj,autoIncrement:!0}).createIndex(WE,bj,{unique:!1}),c.createObjectStore(gf,{keyPath:kj}).createIndex(gk,Lj,{unique:!1}),c.createObjectStore(mf,{keyPath:Nj}).createIndex(mk,Dj,{unique:!1})})(e)))),i<16&&r>=16&&(o=o.next((()=>{t.objectStore(gf).clear()})).next((()=>{t.objectStore(mf).clear()}))),i<17&&r>=17&&(o=o.next((()=>{(function(c){c.createObjectStore(jx,{keyPath:jj})})(e)}))),i<18&&r>=18&&B4()&&(o=o.next((()=>{t.objectStore(gf).clear()})).next((()=>{t.objectStore(mf).clear()}))),o}wi(e){let t=0;return e.store(kl).ee(((i,r)=>{t+=$0(r)})).next((()=>{const i={byteSize:t};return e.store(Zf).put($E,i)}))}yi(e){const t=e.store(Yf),i=e.store(Ur);return t.J().next((r=>q.forEach(r,(s=>{const o=IDBKeyRange.bound([s.userId,Yl],[s.userId,s.lastAcknowledgedBatchId]);return i.J(Kl,o).next((a=>q.forEach(a,(c=>{Ce(c.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:c.batchId});const h=Fl(this.serializer,c);return yL(e,s.userId,h).next((()=>{}))}))))}))))}Si(e){const t=e.store(_h),i=e.store(kl);return e.store(Zl).get(D0).next((r=>{const s=[];return i.ee(((o,a)=>{const c=new gt(o),h=(function(g){return[0,ni(g)]})(c);s.push(t.get(h).next((d=>d?q.resolve():(g=>t.put({targetId:0,path:ni(g),sequenceNumber:r.highestListenSequenceNumber}))(c))))})).next((()=>q.waitFor(s)))}))}bi(e,t){e.createObjectStore(Qf,{keyPath:Aj});const i=t.store(Qf),r=new Jx,s=o=>{if(r.add(o)){const a=o.lastSegment(),c=o.popLast();return i.put({collectionId:a,parent:ni(c)})}};return t.store(kl).ee({X:!0},((o,a)=>{const c=new gt(o);return s(c.popLast())})).next((()=>t.store(mh).ee({X:!0},(([o,a,c],h)=>{const d=Ts(a);return s(d.popLast())}))))}Di(e){const t=e.store(ph);return t.ee(((i,r)=>{const s=ef(r),o=fL(this.serializer,s);return t.put(o)}))}Ci(e,t){const i=t.store(kl),r=[];return i.ee(((s,o)=>{const a=t.store(N0),c=(function(g){return g.document?new pe(gt.fromString(g.document.name).popFirst(5)):g.noDocument?pe.fromSegments(g.noDocument.path):g.unknownDocument?pe.fromSegments(g.unknownDocument.path):Se(36783)})(o).path.toArray(),h={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};r.push(a.put(h))})).next((()=>q.waitFor(r)))}Fi(e,t){const i=t.store(Ur),r=TL(this.serializer),s=new tS(sy.mi,this.serializer.yt);return i.J().next((o=>{const a=new Map;return o.forEach((c=>{let h=a.get(c.userId)??Ze();Fl(this.serializer,c).keys().forEach((d=>h=h.add(d))),a.set(c.userId,h)})),q.forEach(a,((c,h)=>{const d=new Fn(h),g=iy.wt(this.serializer,d),m=s.getIndexManager(d),v=ry.wt(d,this.serializer,m,s.referenceDelegate);return new IL(r,v,g,m).recalculateAndSaveOverlaysForDocumentKeys(new qE(t,Sr.ce),c).next()}))}))}}function _P(n){n.createObjectStore(_h,{keyPath:Tj}).createIndex(Vx,Ij,{unique:!0}),n.createObjectStore(ph,{keyPath:"targetId"}).createIndex(fk,Sj,{unique:!0}),n.createObjectStore(Zl)}const la="IndexedDbPersistence",L1=18e5,N1=5e3,D1="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",cU="main";class nS{constructor(e,t,i,r,s,o,a,c,h,d,g=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=i,this.Mi=s,this.window=o,this.document=a,this.xi=h,this.Oi=d,this.Ni=g,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=m=>Promise.resolve(),!nS.v())throw new me(ee.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new YG(this,r),this.$i=t+cU,this.serializer=new dL(c),this.Ui=new ka(this.$i,this.Ni,new lU(this.serializer)),this.hi=new FG,this.Pi=new KG(this.referenceDelegate,this.serializer),this.remoteDocumentCache=TL(this.serializer),this.Ii=new VG,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,d===!1&&ui(la,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new me(ee.FAILED_PRECONDITION,D1);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new Sr(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>Ip(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((t=>this.isPrimary&&!t?this.Zi(e).next((()=>!1)):!!t&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(Xa(e))return ue(la,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return ue(la,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return Gd(e).get(vu).next((t=>q.resolve(this.es(t))))}ts(e){return Ip(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,L1)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const i=yn(t,yh);return i.J().next((r=>{const s=this.ss(r,L1),o=r.filter((a=>s.indexOf(a)===-1));return q.forEach(o,(a=>i.delete(a.clientId))).next((()=>o))}))})).catch((()=>[]));if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?q.resolve(!0):Gd(e).get(vu).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,N1)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new me(ee.FAILED_PRECONDITION,D1);return!1}}return!(!this.networkEnabled||!this.inForeground)||Ip(e).J().next((i=>this.ss(i,N1).find((r=>{if(this.clientId!==r.clientId){const s=!this.networkEnabled&&r.networkEnabled,o=!this.inForeground&&r.inForeground,a=this.networkEnabled===r.networkEnabled;if(s||o&&a)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&ue(la,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[kg,yh],(e=>{const t=new qE(e,Sr.ce);return this.Zi(t).next((()=>this.ts(t)))})),this.Ui.close(),this.Ps()}ss(e,t){return e.filter((i=>this.rs(i.updateTimeMs,t)&&!this.us(i.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>Ip(e).J().next((t=>this.ss(t,L1).map((i=>i.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return ry.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new WG(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return iy.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,i){ue(la,"Starting transaction:",e);const r=t==="readonly"?"readonly":"readwrite",s=(function(c){return c===18?zj:c===17?Ek:c===16?Uj:c===15?Gx:c===14?vk:c===13?yk:c===12?Gj:c===11?_k:void Se(60245)})(this.Ni);let o;return this.Ui.runTransaction(e,r,s,(a=>(o=new qE(a,this.ci?this.ci.next():Sr.ce),t==="readwrite-primary"?this.Hi(o).next((c=>!!c||this.Yi(o))).next((c=>{if(!c)throw ui(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new me(ee.FAILED_PRECONDITION,lk);return i(o)})).next((c=>this.Xi(o).next((()=>c)))):this.Is(o).next((()=>i(o)))))).then((a=>(o.raiseOnCommittedEvent(),a)))}Is(e){return Gd(e).get(vu).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,N1)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new me(ee.FAILED_PRECONDITION,D1)}))}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Gd(e).put(vu,t)}static v(){return ka.v()}Zi(e){const t=Gd(e);return t.get(vu).next((i=>this.es(i)?(ue(la,"Releasing primary lease."),t.delete(vu)):q.resolve()))}rs(e,t){const i=Date.now();return!(e<i-t)&&(!(e>i)||(ui(`Detected an update time that is in the future: ${e} > ${i}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){typeof this.window?.addEventListener=="function"&&(this.Bi=()=>{this.cs();const e=/(?:Version|Mobile)\/1[456]/;z4()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){try{const t=this.Ki?.getItem(this._s(e))!==null;return ue(la,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return ui(la,"Failed to get zombied client id.",t),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){ui("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Gd(n){return yn(n,kg)}function Ip(n){return yn(n,yh)}function uU(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class iS{constructor(e,t,i,r){this.targetId=e,this.fromCache=t,this.Es=i,this.ds=r}static As(e,t){let i=Ze(),r=Ze();for(const s of t.docChanges)switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new iS(e,t.fromCache,i,r)}}class hU{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class AL{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return z4()?8:uk(pn())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,r){const s={result:null};return this.ys(e,t).next((o=>{s.result=o})).next((()=>{if(!s.result)return this.ws(e,t,r,i).next((o=>{s.result=o}))})).next((()=>{if(s.result)return;const o=new hU;return this.Ss(e,t,o).next((a=>{if(s.result=a,this.Vs)return this.bs(e,t,o,a.size)}))})).next((()=>s.result))}bs(e,t,i,r){return i.documentReadCount<this.fs?(Cu()<=et.DEBUG&&ue("QueryEngine","SDK will not create cache indexes for query:",Mu(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),q.resolve()):(Cu()<=et.DEBUG&&ue("QueryEngine","Query:",Mu(t),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.gs*r?(Cu()<=et.DEBUG&&ue("QueryEngine","The SDK decides to create cache indexes for query:",Mu(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ir(t))):q.resolve())}ys(e,t){if(UR(t))return q.resolve(null);let i=Ir(t);return this.indexManager.getIndexType(e,i).next((r=>r===0?null:(t.limit!==null&&r===1&&(t=ew(t,null,"F"),i=Ir(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((s=>{const o=Ze(...s);return this.ps.getDocuments(e,o).next((a=>this.indexManager.getMinOffset(e,i).next((c=>{const h=this.Ds(t,a);return this.Cs(t,h,o,c.readTime)?this.ys(e,ew(t,null,"F")):this.vs(e,h,t,c)}))))})))))}ws(e,t,i,r){return UR(t)||r.isEqual(be.min())?q.resolve(null):this.ps.getDocuments(e,i).next((s=>{const o=this.Ds(t,s);return this.Cs(t,o,i,r)?q.resolve(null):(Cu()<=et.DEBUG&&ue("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Mu(t)),this.vs(e,o,t,hj(r,qf)).next((a=>a)))}))}Ds(e,t){let i=new Tt(Gk(e));return t.forEach(((r,s)=>{Dg(e,s)&&(i=i.add(s))})),i}Cs(e,t,i,r){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}Ss(e,t,i){return Cu()<=et.DEBUG&&ue("QueryEngine","Using full collection scan to execute query:",Mu(t)),this.ps.getDocumentsMatchingQuery(e,t,Ji.min(),i)}vs(e,t,i,r){return this.ps.getDocumentsMatchingQuery(e,i,r).next((s=>(t.forEach((o=>{s=s.insert(o.key,o)})),s)))}}const rS="LocalStore",dU=3e8;class fU{constructor(e,t,i,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new jt($e),this.xs=new Ro((s=>fc(s)),Lg),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(i)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new IL(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function RL(n,e,t,i){return new fU(n,e,t,i)}async function PL(n,e){const t=We(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let r;return t.mutationQueue.getAllMutationBatches(i).next((s=>(r=s,t.Bs(e),t.mutationQueue.getAllMutationBatches(i)))).next((s=>{const o=[],a=[];let c=Ze();for(const h of r){o.push(h.batchId);for(const d of h.mutations)c=c.add(d.key)}for(const h of s){a.push(h.batchId);for(const d of h.mutations)c=c.add(d.key)}return t.localDocuments.getDocuments(i,c).next((h=>({Ls:h,removedBatchIds:o,addedBatchIds:a})))}))}))}function gU(n,e){const t=We(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const r=e.batch.keys(),s=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(a,c,h,d){const g=h.batch,m=g.keys();let v=q.resolve();return m.forEach((y=>{v=v.next((()=>d.getEntry(c,y))).next((T=>{const w=h.docVersions.get(y);Ce(w!==null,48541),T.version.compareTo(w)<0&&(g.applyToRemoteDocument(T,h),T.isValidDocument()&&(T.setReadTime(h.commitVersion),d.addEntry(T)))}))})),v.next((()=>a.mutationQueue.removeMutationBatch(c,g)))})(t,i,e,s).next((()=>s.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(a){let c=Ze();for(let h=0;h<a.mutationResults.length;++h)a.mutationResults[h].transformResults.length>0&&(c=c.add(a.batch.mutations[h].key));return c})(e)))).next((()=>t.localDocuments.getDocuments(i,r)))}))}function CL(n){const e=We(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function mU(n,e){const t=We(n),i=e.snapshotVersion;let r=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(s=>{const o=t.Ns.newChangeBuffer({trackRemovals:!0});r=t.Ms;const a=[];e.targetChanges.forEach(((d,g)=>{const m=r.get(g);if(!m)return;a.push(t.Pi.removeMatchingKeys(s,d.removedDocuments,g).next((()=>t.Pi.addMatchingKeys(s,d.addedDocuments,g))));let v=m.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(g)!==null?v=v.withResumeToken(cn.EMPTY_BYTE_STRING,be.min()).withLastLimboFreeSnapshotVersion(be.min()):d.resumeToken.approximateByteSize()>0&&(v=v.withResumeToken(d.resumeToken,i)),r=r.insert(g,v),(function(T,w,A){return T.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-T.snapshotVersion.toMicroseconds()>=dU?!0:A.addedDocuments.size+A.modifiedDocuments.size+A.removedDocuments.size>0})(m,v,d)&&a.push(t.Pi.updateTargetData(s,v))}));let c=Hi(),h=Ze();if(e.documentUpdates.forEach((d=>{e.resolvedLimboDocuments.has(d)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,d))})),a.push(pU(s,o,e.documentUpdates).next((d=>{c=d.ks,h=d.qs}))),!i.isEqual(be.min())){const d=t.Pi.getLastRemoteSnapshotVersion(s).next((g=>t.Pi.setTargetsMetadata(s,s.currentSequenceNumber,i)));a.push(d)}return q.waitFor(a).next((()=>o.apply(s))).next((()=>t.localDocuments.getLocalViewOfDocuments(s,c,h))).next((()=>c))})).then((s=>(t.Ms=r,s)))}function pU(n,e,t){let i=Ze(),r=Ze();return t.forEach((s=>i=i.add(s))),e.getEntries(n,i).next((s=>{let o=Hi();return t.forEach(((a,c)=>{const h=s.get(a);c.isFoundDocument()!==h.isFoundDocument()&&(r=r.add(a)),c.isNoDocument()&&c.version.isEqual(be.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!h.isValidDocument()||c.version.compareTo(h.version)>0||c.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):ue(rS,"Ignoring outdated watch update for ",a,". Current version:",h.version," Watch version:",c.version)})),{ks:o,qs:r}}))}function _U(n,e){const t=We(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=Yl),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function yU(n,e){const t=We(n);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let r;return t.Pi.getTargetData(i,e).next((s=>s?(r=s,q.resolve(r)):t.Pi.allocateTargetId(i).next((o=>(r=new lo(e,o,"TargetPurposeListen",i.currentSequenceNumber),t.Pi.addTargetData(i,r).next((()=>r)))))))})).then((i=>{const r=t.Ms.get(i.targetId);return(r===null||i.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(i.targetId,i),t.xs.set(e,i.targetId)),i}))}async function lw(n,e,t){const i=We(n),r=i.Ms.get(e),s=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",s,(o=>i.persistence.referenceDelegate.removeTarget(o,r)))}catch(o){if(!Xa(o))throw o;ue(rS,`Failed to update sequence numbers for target ${e}: ${o}`)}i.Ms=i.Ms.remove(e),i.xs.delete(r.target)}function yP(n,e,t){const i=We(n);let r=be.min(),s=Ze();return i.persistence.runTransaction("Execute query","readwrite",(o=>(function(c,h,d){const g=We(c),m=g.xs.get(d);return m!==void 0?q.resolve(g.Ms.get(m)):g.Pi.getTargetData(h,d)})(i,o,Ir(e)).next((a=>{if(a)return r=a.lastLimboFreeSnapshotVersion,i.Pi.getMatchingKeysForTargetId(o,a.targetId).next((c=>{s=c}))})).next((()=>i.Fs.getDocumentsMatchingQuery(o,e,t?r:be.min(),t?s:Ze()))).next((a=>(vU(i,iG(e),a),{documents:a,Qs:s})))))}function vU(n,e,t){let i=n.Os.get(e)||be.min();t.forEach(((r,s)=>{s.readTime.compareTo(i)>0&&(i=s.readTime)})),n.Os.set(e,i)}class vP{constructor(){this.activeTargetIds=cG()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class ML{constructor(){this.Mo=new vP,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,i){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new vP,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class EU{Oo(e){}shutdown(){}}const EP="ConnectivityMonitor";class wP{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){ue(EP,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){ue(EP,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Ap=null;function cw(){return Ap===null?Ap=(function(){return 268435456+Math.round(2147483648*Math.random())})():Ap++,"0x"+Ap.toString(16)}const O1="RestConnection",wU={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class xU{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${i}/databases/${r}`,this.Wo=this.databaseId.database===O0?`project_id=${i}`:`project_id=${i}&database_id=${r}`}Go(e,t,i,r,s){const o=cw(),a=this.zo(e,t.toUriEncodedString());ue(O1,`Sending RPC '${e}' ${o}:`,a,i);const c={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(c,r,s);const{host:h}=new URL(a),d=Tc(h);return this.Jo(e,a,c,i,d).then((g=>(ue(O1,`Received RPC '${e}' ${o}: `,g),g)),(g=>{throw hc(O1,`RPC '${e}' ${o} failed with error: `,g,"url: ",a,"request:",i),g}))}Ho(e,t,i,r,s,o){return this.Go(e,t,i,r,s)}jo(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Nh})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((r,s)=>e[s]=r)),i&&i.headers.forEach(((r,s)=>e[s]=r))}zo(e,t){const i=wU[e];return`${this.Uo}/v1/${t}:${i}`}terminate(){}}class SU{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const qn="WebChannelConnection";class TU extends xU{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,i,r,s){const o=cw();return new Promise(((a,c)=>{const h=new Z4;h.setWithCredentials(!0),h.listenOnce(Q4.COMPLETE,(()=>{try{switch(h.getLastErrorCode()){case Gp.NO_ERROR:const g=h.getResponseJson();ue(qn,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(g)),a(g);break;case Gp.TIMEOUT:ue(qn,`RPC '${e}' ${o} timed out`),c(new me(ee.DEADLINE_EXCEEDED,"Request time out"));break;case Gp.HTTP_ERROR:const m=h.getStatus();if(ue(qn,`RPC '${e}' ${o} failed with status:`,m,"response text:",h.getResponseText()),m>0){let v=h.getResponseJson();Array.isArray(v)&&(v=v[0]);const y=v?.error;if(y&&y.status&&y.message){const T=(function(A){const P=A.toLowerCase().replace(/_/g,"-");return Object.values(ee).indexOf(P)>=0?P:ee.UNKNOWN})(y.status);c(new me(T,y.message))}else c(new me(ee.UNKNOWN,"Server responded with status "+h.getStatus()))}else c(new me(ee.UNAVAILABLE,"Connection failed."));break;default:Se(9055,{l_:e,streamId:o,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{ue(qn,`RPC '${e}' ${o} completed.`)}}));const d=JSON.stringify(r);ue(qn,`RPC '${e}' ${o} sending request:`,r),h.send(t,"POST",d,i,15)}))}T_(e,t,i){const r=cw(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=tk(),a=ek(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(c.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(c.useFetchStreams=!0),this.jo(c.initMessageHeaders,t,i),c.encodeInitMessageHeaders=!0;const d=s.join("");ue(qn,`Creating RPC '${e}' stream ${r}: ${d}`,c);const g=o.createWebChannel(d,c);this.I_(g);let m=!1,v=!1;const y=new SU({Yo:w=>{v?ue(qn,`Not sending because RPC '${e}' stream ${r} is closed:`,w):(m||(ue(qn,`Opening RPC '${e}' stream ${r} transport.`),g.open(),m=!0),ue(qn,`RPC '${e}' stream ${r} sending:`,w),g.send(w))},Zo:()=>g.close()}),T=(w,A,P)=>{w.listen(A,(C=>{try{P(C)}catch(N){setTimeout((()=>{throw N}),0)}}))};return T(g,Zd.EventType.OPEN,(()=>{v||(ue(qn,`RPC '${e}' stream ${r} transport opened.`),y.o_())})),T(g,Zd.EventType.CLOSE,(()=>{v||(v=!0,ue(qn,`RPC '${e}' stream ${r} transport closed`),y.a_(),this.E_(g))})),T(g,Zd.EventType.ERROR,(w=>{v||(v=!0,hc(qn,`RPC '${e}' stream ${r} transport errored. Name:`,w.name,"Message:",w.message),y.a_(new me(ee.UNAVAILABLE,"The operation could not be completed")))})),T(g,Zd.EventType.MESSAGE,(w=>{if(!v){const A=w.data[0];Ce(!!A,16349);const P=A,C=P?.error||P[0]?.error;if(C){ue(qn,`RPC '${e}' stream ${r} received error:`,C);const N=C.status;let D=(function(R){const L=an[R];if(L!==void 0)return Qk(L)})(N),z=C.message;D===void 0&&(D=ee.INTERNAL,z="Unknown error status: "+N+" with message "+C.message),v=!0,y.a_(new me(D,z)),g.close()}else ue(qn,`RPC '${e}' stream ${r} received:`,A),y.u_(A)}})),T(a,J4.STAT_EVENT,(w=>{w.stat===UE.PROXY?ue(qn,`RPC '${e}' stream ${r} detected buffering proxy`):w.stat===UE.NOPROXY&&ue(qn,`RPC '${e}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{y.__()}),0),y}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function IU(){return typeof window<"u"?window:null}function Yp(){return typeof document<"u"?document:null}function oy(n){return new AG(n,!0)}class bL{constructor(e,t,i=1e3,r=1.5,s=6e4){this.Mi=e,this.timerId=t,this.d_=i,this.A_=r,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),i=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-i);r>0&&ue("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const xP="PersistentStream";class kL{constructor(e,t,i,r,s,o,a,c){this.Mi=e,this.S_=i,this.b_=r,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new bL(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===ee.RESOURCE_EXHAUSTED?(ui(t.toString()),ui("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===ee.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,r])=>{this.D_===t&&this.G_(i,r)}),(i=>{e((()=>{const r=new me(ee.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(r)}))}))}G_(e,t){const i=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{i((()=>this.listener.Xo()))})),this.stream.t_((()=>{i((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((r=>{i((()=>this.z_(r)))})),this.stream.onMessage((r=>{i((()=>++this.F_==1?this.J_(r):this.onNext(r)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return ue(xP,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(ue(xP,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class AU extends kL{constructor(e,t,i,r,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,r,o),this.serializer=s}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=CG(this.serializer,e),i=(function(s){if(!("targetChange"in s))return be.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?be.min():o.readTime?fi(o.readTime):be.min()})(e);return this.listener.H_(t,i)}Y_(e){const t={};t.database=iw(this.serializer),t.addTarget=(function(s,o){let a;const c=o.target;if(a=F0(c)?{documents:oL(s,c)}:{query:aL(s,c).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=tL(s,o.resumeToken);const h=tw(s,o.expectedCount);h!==null&&(a.expectedCount=h)}else if(o.snapshotVersion.compareTo(be.min())>0){a.readTime=Ih(s,o.snapshotVersion.toTimestamp());const h=tw(s,o.expectedCount);h!==null&&(a.expectedCount=h)}return a})(this.serializer,e);const i=bG(this.serializer,e);i&&(t.labels=i),this.q_(t)}Z_(e){const t={};t.database=iw(this.serializer),t.removeTarget=e,this.q_(t)}}class RU extends kL{constructor(e,t,i,r,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,r,o),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Ce(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ce(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Ce(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=MG(e.writeResults,e.commitTime),i=fi(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=iw(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>U0(this.serializer,i)))};this.q_(t)}}class PU{}class CU extends PU{constructor(e,t,i,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new me(ee.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,i,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,o])=>this.connection.Go(e,nw(t,i),r,s,o))).catch((s=>{throw s.name==="FirebaseError"?(s.code===ee.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new me(ee.UNKNOWN,s.toString())}))}Ho(e,t,i,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,a])=>this.connection.Ho(e,nw(t,i),r,o,a,s))).catch((o=>{throw o.name==="FirebaseError"?(o.code===ee.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new me(ee.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class MU{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(ui(t),this.aa=!1):ue("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const _c="RemoteStore";class bU{constructor(e,t,i,r,s){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo((o=>{i.enqueueAndForget((async()=>{Rc(this)&&(ue(_c,"Restarting streams for network reachability change."),await(async function(c){const h=We(c);h.Ea.add(4),await Vg(h),h.Ra.set("Unknown"),h.Ea.delete(4),await ay(h)})(this))}))})),this.Ra=new MU(i,r)}}async function ay(n){if(Rc(n))for(const e of n.da)await e(!0)}async function Vg(n){for(const e of n.da)await e(!1)}function LL(n,e){const t=We(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),lS(t)?aS(t):Oh(t).O_()&&oS(t,e))}function sS(n,e){const t=We(n),i=Oh(t);t.Ia.delete(e),i.O_()&&NL(t,e),t.Ia.size===0&&(i.O_()?i.L_():Rc(t)&&t.Ra.set("Unknown"))}function oS(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(be.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Oh(n).Y_(e)}function NL(n,e){n.Va.Ue(e),Oh(n).Z_(e)}function aS(n){n.Va=new xG({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Oh(n).start(),n.Ra.ua()}function lS(n){return Rc(n)&&!Oh(n).x_()&&n.Ia.size>0}function Rc(n){return We(n).Ea.size===0}function DL(n){n.Va=void 0}async function kU(n){n.Ra.set("Online")}async function LU(n){n.Ia.forEach(((e,t)=>{oS(n,e)}))}async function NU(n,e){DL(n),lS(n)?(n.Ra.ha(e),aS(n)):n.Ra.set("Unknown")}async function DU(n,e,t){if(n.Ra.set("Online"),e instanceof eL&&e.state===2&&e.cause)try{await(async function(r,s){const o=s.cause;for(const a of s.targetIds)r.Ia.has(a)&&(await r.remoteSyncer.rejectListen(a,o),r.Ia.delete(a),r.Va.removeTarget(a))})(n,e)}catch(i){ue(_c,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await K0(n,i)}else if(e instanceof Hp?n.Va.Ze(e):e instanceof Jk?n.Va.st(e):n.Va.tt(e),!t.isEqual(be.min()))try{const i=await CL(n.localStore);t.compareTo(i)>=0&&await(function(s,o){const a=s.Va.Tt(o);return a.targetChanges.forEach(((c,h)=>{if(c.resumeToken.approximateByteSize()>0){const d=s.Ia.get(h);d&&s.Ia.set(h,d.withResumeToken(c.resumeToken,o))}})),a.targetMismatches.forEach(((c,h)=>{const d=s.Ia.get(c);if(!d)return;s.Ia.set(c,d.withResumeToken(cn.EMPTY_BYTE_STRING,d.snapshotVersion)),NL(s,c);const g=new lo(d.target,c,h,d.sequenceNumber);oS(s,g)})),s.remoteSyncer.applyRemoteEvent(a)})(n,t)}catch(i){ue(_c,"Failed to raise snapshot:",i),await K0(n,i)}}async function K0(n,e,t){if(!Xa(e))throw e;n.Ea.add(1),await Vg(n),n.Ra.set("Offline"),t||(t=()=>CL(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{ue(_c,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await ay(n)}))}function OL(n,e){return e().catch((t=>K0(n,t,e)))}async function Fg(n){const e=We(n),t=Ua(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Yl;for(;OU(e);)try{const r=await _U(e.localStore,i);if(r===null){e.Ta.length===0&&t.L_();break}i=r.batchId,VU(e,r)}catch(r){await K0(e,r)}VL(e)&&FL(e)}function OU(n){return Rc(n)&&n.Ta.length<10}function VU(n,e){n.Ta.push(e);const t=Ua(n);t.O_()&&t.X_&&t.ea(e.mutations)}function VL(n){return Rc(n)&&!Ua(n).x_()&&n.Ta.length>0}function FL(n){Ua(n).start()}async function FU(n){Ua(n).ra()}async function jU(n){const e=Ua(n);for(const t of n.Ta)e.ea(t.mutations)}async function GU(n,e,t){const i=n.Ta.shift(),r=Hx.from(i,e,t);await OL(n,(()=>n.remoteSyncer.applySuccessfulWrite(r))),await Fg(n)}async function UU(n,e){e&&Ua(n).X_&&await(async function(i,r){if((function(o){return vG(o)&&o!==ee.ABORTED})(r.code)){const s=i.Ta.shift();Ua(i).B_(),await OL(i,(()=>i.remoteSyncer.rejectFailedWrite(s.batchId,r))),await Fg(i)}})(n,e),VL(n)&&FL(n)}async function SP(n,e){const t=We(n);t.asyncQueue.verifyOperationInProgress(),ue(_c,"RemoteStore received new credentials");const i=Rc(t);t.Ea.add(3),await Vg(t),i&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await ay(t)}async function zU(n,e){const t=We(n);e?(t.Ea.delete(2),await ay(t)):e||(t.Ea.add(2),await Vg(t),t.Ra.set("Unknown"))}function Oh(n){return n.ma||(n.ma=(function(t,i,r){const s=We(t);return s.sa(),new AU(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)})(n.datastore,n.asyncQueue,{Xo:kU.bind(null,n),t_:LU.bind(null,n),r_:NU.bind(null,n),H_:DU.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),lS(n)?aS(n):n.Ra.set("Unknown")):(await n.ma.stop(),DL(n))}))),n.ma}function Ua(n){return n.fa||(n.fa=(function(t,i,r){const s=We(t);return s.sa(),new RU(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:FU.bind(null,n),r_:UU.bind(null,n),ta:jU.bind(null,n),na:GU.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await Fg(n)):(await n.fa.stop(),n.Ta.length>0&&(ue(_c,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class cS{constructor(e,t,i,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=r,this.removalCallback=s,this.deferred=new mo,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,r,s){const o=Date.now()+i,a=new cS(e,t,o,r,s);return a.start(i),a}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new me(ee.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function uS(n,e){if(ui("AsyncQueue",`${e}: ${n}`),Xa(n))return new me(ee.UNAVAILABLE,`${e}: ${n}`);throw n}class Qu{static emptySet(e){return new Qu(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||pe.comparator(t.key,i.key):(t,i)=>pe.comparator(t.key,i.key),this.keyedMap=Qd(),this.sortedSet=new jt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Qu)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=i.getNext().key;if(!r.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new Qu;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}class TP{constructor(){this.ga=new jt(pe.comparator)}track(e){const t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Se(63341,{Rt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,i)=>{e.push(i)})),e}}class Ah{constructor(e,t,i,r,s,o,a,c,h){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=r,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=h}static fromInitialDocuments(e,t,i,r,s){const o=[];return t.forEach((a=>{o.push({type:0,doc:a})})),new Ah(e,t,Qu.emptySet(t),o,i,r,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Q_(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==i[r].type||!t[r].doc.isEqual(i[r].doc))return!1;return!0}}class BU{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class $U{constructor(){this.queries=IP(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const r=We(t),s=r.queries;r.queries=IP(),s.forEach(((o,a)=>{for(const c of a.Sa)c.onError(i)}))})(this,new me(ee.ABORTED,"Firestore shutting down"))}}function IP(){return new Ro((n=>jk(n)),Q_)}async function WU(n,e){const t=We(n);let i=3;const r=e.query;let s=t.queries.get(r);s?!s.ba()&&e.Da()&&(i=2):(s=new BU,i=e.Da()?0:1);try{switch(i){case 0:s.wa=await t.onListen(r,!0);break;case 1:s.wa=await t.onListen(r,!1);break;case 2:await t.onFirstRemoteStoreListen(r)}}catch(o){const a=uS(o,`Initialization of query '${Mu(e.query)}' failed`);return void e.onError(a)}t.queries.set(r,s),s.Sa.push(e),e.va(t.onlineState),s.wa&&e.Fa(s.wa)&&hS(t)}async function KU(n,e){const t=We(n),i=e.query;let r=3;const s=t.queries.get(i);if(s){const o=s.Sa.indexOf(e);o>=0&&(s.Sa.splice(o,1),s.Sa.length===0?r=e.Da()?0:1:!s.ba()&&e.Da()&&(r=2))}switch(r){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function qU(n,e){const t=We(n);let i=!1;for(const r of e){const s=r.query,o=t.queries.get(s);if(o){for(const a of o.Sa)a.Fa(r)&&(i=!0);o.wa=r}}i&&hS(t)}function HU(n,e,t){const i=We(n),r=i.queries.get(e);if(r)for(const s of r.Sa)s.onError(t);i.queries.delete(e)}function hS(n){n.Ca.forEach((e=>{e.next()}))}var uw,AP;(AP=uw||(uw={})).Ma="default",AP.Cache="cache";class XU{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const r of e.docChanges)r.type!==3&&i.push(r);e=new Ah(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const i=t!=="Offline";return(!this.options.qa||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Ah.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==uw.Cache}}class jL{constructor(e){this.key=e}}class GL{constructor(e){this.key=e}}class YU{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Ze(),this.mutatedKeys=Ze(),this.eu=Gk(e),this.tu=new Qu(this.eu)}get nu(){return this.Ya}ru(e,t){const i=t?t.iu:new TP,r=t?t.tu:this.tu;let s=t?t.mutatedKeys:this.mutatedKeys,o=r,a=!1;const c=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,h=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((d,g)=>{const m=r.get(d),v=Dg(this.query,g)?g:null,y=!!m&&this.mutatedKeys.has(m.key),T=!!v&&(v.hasLocalMutations||this.mutatedKeys.has(v.key)&&v.hasCommittedMutations);let w=!1;m&&v?m.data.isEqual(v.data)?y!==T&&(i.track({type:3,doc:v}),w=!0):this.su(m,v)||(i.track({type:2,doc:v}),w=!0,(c&&this.eu(v,c)>0||h&&this.eu(v,h)<0)&&(a=!0)):!m&&v?(i.track({type:0,doc:v}),w=!0):m&&!v&&(i.track({type:1,doc:m}),w=!0,(c||h)&&(a=!0)),w&&(v?(o=o.add(v),s=T?s.add(d):s.delete(d)):(o=o.delete(d),s=s.delete(d)))})),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),i.track({type:1,doc:d})}return{tu:o,iu:i,Cs:a,mutatedKeys:s}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,r){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort(((d,g)=>(function(v,y){const T=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Se(20277,{Rt:w})}};return T(v)-T(y)})(d.type,g.type)||this.eu(d.doc,g.doc))),this.ou(i),r=r??!1;const a=t&&!r?this._u():[],c=this.Xa.size===0&&this.current&&!r?1:0,h=c!==this.Za;return this.Za=c,o.length!==0||h?{snapshot:new Ah(this.query,e.tu,s,o,e.mutatedKeys,c===0,h,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new TP,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Ze(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Xa=this.Xa.add(i.key))}));const t=[];return e.forEach((i=>{this.Xa.has(i)||t.push(new GL(i))})),this.Xa.forEach((i=>{e.has(i)||t.push(new jL(i))})),t}cu(e){this.Ya=e.Qs,this.Xa=Ze();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Ah.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const dS="SyncEngine";class ZU{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class QU{constructor(e){this.key=e,this.hu=!1}}class JU{constructor(e,t,i,r,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Ro((a=>jk(a)),Q_),this.Iu=new Map,this.Eu=new Set,this.du=new jt(pe.comparator),this.Au=new Map,this.Ru=new eS,this.Vu={},this.mu=new Map,this.fu=pc.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function ez(n,e,t=!0){const i=KL(n);let r;const s=i.Tu.get(e);return s?(i.sharedClientState.addLocalQueryTarget(s.targetId),r=s.view.lu()):r=await UL(i,e,t,!0),r}async function tz(n,e){const t=KL(n);await UL(t,e,!0,!1)}async function UL(n,e,t,i){const r=await yU(n.localStore,Ir(e)),s=r.targetId,o=n.sharedClientState.addLocalQueryTarget(s,t);let a;return i&&(a=await nz(n,e,s,o==="current",r.resumeToken)),n.isPrimaryClient&&t&&LL(n.remoteStore,r),a}async function nz(n,e,t,i,r){n.pu=(g,m,v)=>(async function(T,w,A,P){let C=w.view.ru(A);C.Cs&&(C=await yP(T.localStore,w.query,!1).then((({documents:k})=>w.view.ru(k,C))));const N=P&&P.targetChanges.get(w.targetId),D=P&&P.targetMismatches.get(w.targetId)!=null,z=w.view.applyChanges(C,T.isPrimaryClient,N,D);return PP(T,w.targetId,z.au),z.snapshot})(n,g,m,v);const s=await yP(n.localStore,e,!0),o=new YU(e,s.Qs),a=o.ru(s.documents),c=Og.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",r),h=o.applyChanges(a,n.isPrimaryClient,c);PP(n,t,h.au);const d=new ZU(e,t,o);return n.Tu.set(e,d),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),h.snapshot}async function iz(n,e,t){const i=We(n),r=i.Tu.get(e),s=i.Iu.get(r.targetId);if(s.length>1)return i.Iu.set(r.targetId,s.filter((o=>!Q_(o,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(r.targetId),i.sharedClientState.isActiveQueryTarget(r.targetId)||await lw(i.localStore,r.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(r.targetId),t&&sS(i.remoteStore,r.targetId),hw(i,r.targetId)})).catch(Ac)):(hw(i,r.targetId),await lw(i.localStore,r.targetId,!0))}async function rz(n,e){const t=We(n),i=t.Tu.get(e),r=t.Iu.get(i.targetId);t.isPrimaryClient&&r.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),sS(t.remoteStore,i.targetId))}async function sz(n,e,t){const i=qL(n);try{const r=await(function(o,a){const c=We(o),h=xt.now(),d=a.reduce(((v,y)=>v.add(y.key)),Ze());let g,m;return c.persistence.runTransaction("Locally write mutations","readwrite",(v=>{let y=Hi(),T=Ze();return c.Ns.getEntries(v,d).next((w=>{y=w,y.forEach(((A,P)=>{P.isValidDocument()||(T=T.add(A))}))})).next((()=>c.localDocuments.getOverlayedDocuments(v,y))).next((w=>{g=w;const A=[];for(const P of a){const C=_G(P,g.get(P.key).overlayedDocument);C!=null&&A.push(new Po(P.key,C,Mk(C.value.mapValue),hi.exists(!0)))}return c.mutationQueue.addMutationBatch(v,h,A,a)})).next((w=>{m=w;const A=w.applyToLocalDocumentSet(g,T);return c.documentOverlayCache.saveOverlays(v,w.batchId,A)}))})).then((()=>({batchId:m.batchId,changes:zk(g)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(r.batchId),(function(o,a,c){let h=o.Vu[o.currentUser.toKey()];h||(h=new jt($e)),h=h.insert(a,c),o.Vu[o.currentUser.toKey()]=h})(i,r.batchId,t),await jg(i,r.changes),await Fg(i.remoteStore)}catch(r){const s=uS(r,"Failed to persist write");t.reject(s)}}async function zL(n,e){const t=We(n);try{const i=await mU(t.localStore,e);e.targetChanges.forEach(((r,s)=>{const o=t.Au.get(s);o&&(Ce(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1,22616),r.addedDocuments.size>0?o.hu=!0:r.modifiedDocuments.size>0?Ce(o.hu,14607):r.removedDocuments.size>0&&(Ce(o.hu,42227),o.hu=!1))})),await jg(t,i,e)}catch(i){await Ac(i)}}function RP(n,e,t){const i=We(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const r=[];i.Tu.forEach(((s,o)=>{const a=o.view.va(e);a.snapshot&&r.push(a.snapshot)})),(function(o,a){const c=We(o);c.onlineState=a;let h=!1;c.queries.forEach(((d,g)=>{for(const m of g.Sa)m.va(a)&&(h=!0)})),h&&hS(c)})(i.eventManager,e),r.length&&i.Pu.H_(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function oz(n,e,t){const i=We(n);i.sharedClientState.updateQueryState(e,"rejected",t);const r=i.Au.get(e),s=r&&r.key;if(s){let o=new jt(pe.comparator);o=o.insert(s,Xt.newNoDocument(s,be.min()));const a=Ze().add(s),c=new ny(be.min(),new Map,new jt($e),o,a);await zL(i,c),i.du=i.du.remove(s),i.Au.delete(e),fS(i)}else await lw(i.localStore,e,!1).then((()=>hw(i,e,t))).catch(Ac)}async function az(n,e){const t=We(n),i=e.batch.batchId;try{const r=await gU(t.localStore,e);$L(t,i,null),BL(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await jg(t,r)}catch(r){await Ac(r)}}async function lz(n,e,t){const i=We(n);try{const r=await(function(o,a){const c=We(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",(h=>{let d;return c.mutationQueue.lookupMutationBatch(h,a).next((g=>(Ce(g!==null,37113),d=g.keys(),c.mutationQueue.removeMutationBatch(h,g)))).next((()=>c.mutationQueue.performConsistencyCheck(h))).next((()=>c.documentOverlayCache.removeOverlaysForBatchId(h,d,a))).next((()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,d))).next((()=>c.localDocuments.getDocuments(h,d)))}))})(i.localStore,e);$L(i,e,t),BL(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await jg(i,r)}catch(r){await Ac(r)}}function BL(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function $L(n,e,t){const i=We(n);let r=i.Vu[i.currentUser.toKey()];if(r){const s=r.get(e);s&&(t?s.reject(t):s.resolve(),r=r.remove(e)),i.Vu[i.currentUser.toKey()]=r}}function hw(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Iu.get(e))n.Tu.delete(i),t&&n.Pu.yu(i,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((i=>{n.Ru.containsKey(i)||WL(n,i)}))}function WL(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(sS(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),fS(n))}function PP(n,e,t){for(const i of t)i instanceof jL?(n.Ru.addReference(i.key,e),cz(n,i)):i instanceof GL?(ue(dS,"Document no longer in limbo: "+i.key),n.Ru.removeReference(i.key,e),n.Ru.containsKey(i.key)||WL(n,i.key)):Se(19791,{wu:i})}function cz(n,e){const t=e.key,i=t.path.canonicalString();n.du.get(t)||n.Eu.has(i)||(ue(dS,"New document in limbo: "+t),n.Eu.add(i),fS(n))}function fS(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new pe(gt.fromString(e)),i=n.fu.next();n.Au.set(i,new QU(t)),n.du=n.du.insert(t,i),LL(n.remoteStore,new lo(Ir(Wx(t.path)),i,"TargetPurposeLimboResolution",Sr.ce))}}async function jg(n,e,t){const i=We(n),r=[],s=[],o=[];i.Tu.isEmpty()||(i.Tu.forEach(((a,c)=>{o.push(i.pu(c,e,t).then((h=>{if((h||t)&&i.isPrimaryClient){const d=h?!h.fromCache:t?.targetChanges.get(c.targetId)?.current;i.sharedClientState.updateQueryState(c.targetId,d?"current":"not-current")}if(h){r.push(h);const d=iS.As(c.targetId,h);s.push(d)}})))})),await Promise.all(o),i.Pu.H_(r),await(async function(c,h){const d=We(c);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",(g=>q.forEach(h,(m=>q.forEach(m.Es,(v=>d.persistence.referenceDelegate.addReference(g,m.targetId,v))).next((()=>q.forEach(m.ds,(v=>d.persistence.referenceDelegate.removeReference(g,m.targetId,v)))))))))}catch(g){if(!Xa(g))throw g;ue(rS,"Failed to update sequence numbers: "+g)}for(const g of h){const m=g.targetId;if(!g.fromCache){const v=d.Ms.get(m),y=v.snapshotVersion,T=v.withLastLimboFreeSnapshotVersion(y);d.Ms=d.Ms.insert(m,T)}}})(i.localStore,s))}async function uz(n,e){const t=We(n);if(!t.currentUser.isEqual(e)){ue(dS,"User change. New user:",e.toKey());const i=await PL(t.localStore,e);t.currentUser=e,(function(s,o){s.mu.forEach((a=>{a.forEach((c=>{c.reject(new me(ee.CANCELLED,o))}))})),s.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await jg(t,i.Ls)}}function hz(n,e){const t=We(n),i=t.Au.get(e);if(i&&i.hu)return Ze().add(i.key);{let r=Ze();const s=t.Iu.get(e);if(!s)return r;for(const o of s){const a=t.Tu.get(o);r=r.unionWith(a.view.nu)}return r}}function KL(n){const e=We(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=zL.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=hz.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=oz.bind(null,e),e.Pu.H_=qU.bind(null,e.eventManager),e.Pu.yu=HU.bind(null,e.eventManager),e}function qL(n){const e=We(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=az.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=lz.bind(null,e),e}class sg{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=oy(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return RL(this.persistence,new AL,e.initialUser,this.serializer)}Cu(e){return new tS(sy.mi,this.serializer)}Du(e){return new ML}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}sg.provider={build:()=>new sg};class dz extends sg{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Ce(this.persistence.referenceDelegate instanceof W0,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new wL(i,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Zn.withCacheSize(this.cacheSizeBytes):Zn.DEFAULT;return new tS((i=>W0.mi(i,t)),this.serializer)}}class fz extends sg{constructor(e,t,i){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=i,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await qL(this.xu.syncEngine),await Fg(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return RL(this.persistence,new AL,e.initialUser,this.serializer)}Fu(e,t){const i=this.persistence.referenceDelegate.garbageCollector;return new wL(i,e.asyncQueue,t)}Mu(e,t){const i=new mj(t,this.persistence);return new gj(e.asyncQueue,i)}Cu(e){const t=uU(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),i=this.cacheSizeBytes!==void 0?Zn.withCacheSize(this.cacheSizeBytes):Zn.DEFAULT;return new nS(this.synchronizeTabs,t,e.clientId,i,e.asyncQueue,IU(),Yp(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new ML}}class q0{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>RP(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=uz.bind(null,this.syncEngine),await zU(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new $U})()}createDatastore(e){const t=oy(e.databaseInfo.databaseId),i=(function(s){return new TU(s)})(e.databaseInfo);return(function(s,o,a,c){return new CU(s,o,a,c)})(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,r,s,o,a){return new bU(i,r,s,o,a)})(this.localStore,this.datastore,e.asyncQueue,(t=>RP(this.syncEngine,t,0)),(function(){return wP.v()?new wP:new EU})())}createSyncEngine(e,t){return(function(r,s,o,a,c,h,d){const g=new JU(r,s,o,a,c,h);return d&&(g.gu=!0),g})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const i=We(t);ue(_c,"RemoteStore shutting down."),i.Ea.add(5),await Vg(i),i.Aa.shutdown(),i.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}q0.provider={build:()=>new q0};class gz{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):ui("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const za="FirestoreClient";class mz{constructor(e,t,i,r,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=r,this.user=Fn.UNAUTHENTICATED,this.clientId=Nx.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(i,(async o=>{ue(za,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(i,(o=>(ue(za,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new mo;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=uS(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function V1(n,e){n.asyncQueue.verifyOperationInProgress(),ue(za,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener((async r=>{i.isEqual(r)||(await PL(e.localStore,r),i=r)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function CP(n,e){n.asyncQueue.verifyOperationInProgress();const t=await pz(n);ue(za,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((i=>SP(e.remoteStore,i))),n.setAppCheckTokenChangeListener(((i,r)=>SP(e.remoteStore,r))),n._onlineComponents=e}async function pz(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){ue(za,"Using user provided OfflineComponentProvider");try{await V1(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(r){return r.name==="FirebaseError"?r.code===ee.FAILED_PRECONDITION||r.code===ee.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11})(t))throw t;hc("Error using user provided cache. Falling back to memory cache: "+t),await V1(n,new sg)}}else ue(za,"Using default OfflineComponentProvider"),await V1(n,new dz(void 0));return n._offlineComponents}async function HL(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(ue(za,"Using user provided OnlineComponentProvider"),await CP(n,n._uninitializedComponentsProvider._online)):(ue(za,"Using default OnlineComponentProvider"),await CP(n,new q0))),n._onlineComponents}function _z(n){return HL(n).then((e=>e.syncEngine))}async function yz(n){const e=await HL(n),t=e.eventManager;return t.onListen=ez.bind(null,e.syncEngine),t.onUnlisten=iz.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=tz.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=rz.bind(null,e.syncEngine),t}function vz(n,e,t={}){const i=new mo;return n.asyncQueue.enqueueAndForget((async()=>(function(s,o,a,c,h){const d=new gz({next:m=>{d.Nu(),o.enqueueAndForget((()=>KU(s,g))),m.fromCache&&c.source==="server"?h.reject(new me(ee.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(m)},error:m=>h.reject(m)}),g=new XU(a,d,{includeMetadataChanges:!0,qa:!0});return WU(s,g)})(await yz(n),n.asyncQueue,e,t,i))),i.promise}function XL(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const MP=new Map;const YL="firestore.googleapis.com",bP=!0;class kP{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new me(ee.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=YL,this.ssl=bP}else this.host=e.host,this.ssl=e.ssl??bP;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=_L;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<qG)throw new me(ee.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}uj("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=XL(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new me(ee.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new me(ee.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new me(ee.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,r){return i.timeoutSeconds===r.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class ly{constructor(e,t,i,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new kP({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new me(ee.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new me(ee.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new kP(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new ej;switch(i.type){case"firstParty":return new rj(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new me(ee.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=MP.get(t);i&&(ue("ComponentProvider","Removing Datastore"),MP.delete(t),i.terminate())})(this),Promise.resolve()}}function Ez(n,e,t,i={}){n=Fa(n,ly);const r=Tc(e),s=n._getSettings(),o={...s,emulatorOptions:n._getEmulatorOptions()},a=`${e}:${t}`;r&&(Px(`https://${a}`),Cx("Firestore",!0)),s.host!==YL&&s.host!==a&&hc("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c={...s,host:a,ssl:r,emulatorOptions:i};if(!lc(c,o)&&(n._setSettings(c),i.mockUserToken)){let h,d;if(typeof i.mockUserToken=="string")h=i.mockUserToken,d=Fn.MOCK_USER;else{h=G4(i.mockUserToken,n._app?.options.projectId);const g=i.mockUserToken.sub||i.mockUserToken.user_id;if(!g)throw new me(ee.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new Fn(g)}n._authCredentials=new tj(new ik(h,d))}}class Vh{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new Vh(this.firestore,e,this._query)}}class gn{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new La(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new gn(this.firestore,e,this._key)}toJSON(){return{type:gn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(bg(t,gn._jsonSchema))return new gn(e,i||null,new pe(gt.fromString(t.referencePath)))}}gn._jsonSchemaVersion="firestore/documentReference/1.0",gn._jsonSchema={type:ln("string",gn._jsonSchemaVersion),referencePath:ln("string")};class La extends Vh{constructor(e,t,i){super(e,t,Wx(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new gn(this.firestore,null,new pe(e))}withConverter(e){return new La(this.firestore,e,this._path)}}function LP(n,e,...t){if(n=ii(n),sk("collection","path",e),n instanceof ly){const i=gt.fromString(e,...t);return xR(i),new La(n,null,i)}{if(!(n instanceof gn||n instanceof La))throw new me(ee.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(gt.fromString(e,...t));return xR(i),new La(n.firestore,null,i)}}function dw(n,e,...t){if(n=ii(n),arguments.length===1&&(e=Nx.newId()),sk("doc","path",e),n instanceof ly){const i=gt.fromString(e,...t);return wR(i),new gn(n,null,new pe(i))}{if(!(n instanceof gn||n instanceof La))throw new me(ee.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(gt.fromString(e,...t));return wR(i),new gn(n.firestore,n instanceof La?n.converter:null,new pe(i))}}const NP="AsyncQueue";class DP{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new bL(this,"async_queue_retry"),this._c=()=>{const i=Yp();i&&ue(NP,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=Yp();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Yp();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new mo;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Xa(e))throw e;ue(NP,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,ui("INTERNAL UNHANDLED ERROR: ",OP(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=cS.createAndSchedule(this,e,t,i,(s=>this.hc(s)));return this.tc.push(r),r}uc(){this.nc&&Se(47125,{Pc:OP(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function OP(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class Fh extends ly{constructor(e,t,i,r){super(e,t,i,r),this.type="firestore",this._queue=new DP,this._persistenceKey=r?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new DP(e),this._firestoreClient=void 0,await e}}}function wz(n,e){const t=typeof n=="object"?n:kx(),i=typeof n=="string"?n:O0,r=B_(t,"firestore").getImmediate({identifier:i});if(!r._initialized){const s=V4("firestore");s&&Ez(r,...s)}return r}function ZL(n){if(n._terminated)throw new me(ee.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||QL(n),n._firestoreClient}function QL(n){const e=n._freezeSettings(),t=(function(r,s,o,a){return new $j(r,s,o,a.host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,XL(a.experimentalLongPollingOptions),a.useFetchStreams,a.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new mz(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(r){const s=r?._online.build();return{_offline:r?._offline.build(s),_online:s}})(n._componentsProvider))}function xz(n,e){hc("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return Sz(n,q0.provider,{build:i=>new fz(i,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function Sz(n,e,t){if((n=Fa(n,Fh))._firestoreClient||n._terminated)throw new me(ee.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new me(ee.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},QL(n)}class vr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new vr(cn.fromBase64String(e))}catch(t){throw new me(ee.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new vr(cn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:vr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(bg(e,vr._jsonSchema))return vr.fromBase64String(e.bytes)}}vr._jsonSchemaVersion="firestore/bytes/1.0",vr._jsonSchema={type:ln("string",vr._jsonSchemaVersion),bytes:ln("string")};class cy{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new me(ee.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Bt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class gS{constructor(e){this._methodName=e}}class Rs{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new me(ee.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new me(ee.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return $e(this._lat,e._lat)||$e(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Rs._jsonSchemaVersion}}static fromJSON(e){if(bg(e,Rs._jsonSchema))return new Rs(e.latitude,e.longitude)}}Rs._jsonSchemaVersion="firestore/geoPoint/1.0",Rs._jsonSchema={type:ln("string",Rs._jsonSchemaVersion),latitude:ln("number"),longitude:ln("number")};class Ps{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,r){if(i.length!==r.length)return!1;for(let s=0;s<i.length;++s)if(i[s]!==r[s])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Ps._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(bg(e,Ps._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Ps(e.vectorValues);throw new me(ee.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Ps._jsonSchemaVersion="firestore/vectorValue/1.0",Ps._jsonSchema={type:ln("string",Ps._jsonSchemaVersion),vectorValues:ln("object")};const Tz=/^__.*__$/;class Iz{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new Po(e,this.data,this.fieldMask,t,this.fieldTransforms):new Dh(e,this.data,t,this.fieldTransforms)}}class JL{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new Po(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function eN(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Se(40011,{Ac:n})}}class mS{constructor(e,t,i,r,s,o){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=r,s===void 0&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new mS({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),i=this.Vc({path:t,fc:!1});return i.gc(e),i}yc(e){const t=this.path?.child(e),i=this.Vc({path:t,fc:!1});return i.Rc(),i}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return H0(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(eN(this.Ac)&&Tz.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class Az{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||oy(e)}Cc(e,t,i,r=!1){return new mS({Ac:e,methodName:t,Dc:i,path:Bt.emptyPath(),fc:!1,bc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function pS(n){const e=n._freezeSettings(),t=oy(n._databaseId);return new Az(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Rz(n,e,t,i,r,s={}){const o=n.Cc(s.merge||s.mergeFields?2:0,e,t,r);_S("Data must be an object, but it was:",o,i);const a=tN(i,o);let c,h;if(s.merge)c=new bi(o.fieldMask),h=o.fieldTransforms;else if(s.mergeFields){const d=[];for(const g of s.mergeFields){const m=fw(e,g,t);if(!o.contains(m))throw new me(ee.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);iN(d,m)||d.push(m)}c=new bi(d),h=o.fieldTransforms.filter((g=>c.covers(g.field)))}else c=null,h=o.fieldTransforms;return new Iz(new Jn(a),c,h)}class uy extends gS{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof uy}}function Pz(n,e,t,i){const r=n.Cc(1,e,t);_S("Data must be an object, but it was:",r,i);const s=[],o=Jn.empty();Ya(i,((c,h)=>{const d=yS(e,c,t);h=ii(h);const g=r.yc(d);if(h instanceof uy)s.push(d);else{const m=Gg(h,g);m!=null&&(s.push(d),o.set(d,m))}}));const a=new bi(s);return new JL(o,a,r.fieldTransforms)}function Cz(n,e,t,i,r,s){const o=n.Cc(1,e,t),a=[fw(e,i,t)],c=[r];if(s.length%2!=0)throw new me(ee.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<s.length;m+=2)a.push(fw(e,s[m])),c.push(s[m+1]);const h=[],d=Jn.empty();for(let m=a.length-1;m>=0;--m)if(!iN(h,a[m])){const v=a[m];let y=c[m];y=ii(y);const T=o.yc(v);if(y instanceof uy)h.push(v);else{const w=Gg(y,T);w!=null&&(h.push(v),d.set(v,w))}}const g=new bi(h);return new JL(d,g,o.fieldTransforms)}function Mz(n,e,t,i=!1){return Gg(t,n.Cc(i?4:3,e))}function Gg(n,e){if(nN(n=ii(n)))return _S("Unsupported field value:",e,n),tN(n,e);if(n instanceof gS)return(function(i,r){if(!eN(r.Ac))throw r.Sc(`${i._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Sc(`${i._methodName}() is not currently supported inside arrays`);const s=i._toFieldTransform(r);s&&r.fieldTransforms.push(s)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(i,r){const s=[];let o=0;for(const a of i){let c=Gg(a,r.wc(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}})(n,e)}return(function(i,r){if((i=ii(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return uG(r.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const s=xt.fromDate(i);return{timestampValue:Ih(r.serializer,s)}}if(i instanceof xt){const s=new xt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Ih(r.serializer,s)}}if(i instanceof Rs)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof vr)return{bytesValue:tL(r.serializer,i._byteString)};if(i instanceof gn){const s=r.databaseId,o=i.firestore._databaseId;if(!o.isEqual(s))throw r.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Zx(i.firestore._databaseId||r.databaseId,i._key.path)}}if(i instanceof Ps)return(function(o,a){return{mapValue:{fields:{[zx]:{stringValue:Bx},[vh]:{arrayValue:{values:o.toArray().map((h=>{if(typeof h!="number")throw a.Sc("VectorValues must only contain numeric values.");return Kx(a.serializer,h)}))}}}}}})(i,r);throw r.Sc(`Unsupported field value: ${$_(i)}`)})(n,e)}function tN(n,e){const t={};return wk(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ya(n,((i,r)=>{const s=Gg(r,e.mc(i));s!=null&&(t[i]=s)})),{mapValue:{fields:t}}}function nN(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof xt||n instanceof Rs||n instanceof vr||n instanceof gn||n instanceof gS||n instanceof Ps)}function _S(n,e,t){if(!nN(t)||!ok(t)){const i=$_(t);throw i==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+i)}}function fw(n,e,t){if((e=ii(e))instanceof cy)return e._internalPath;if(typeof e=="string")return yS(n,e);throw H0("Field path arguments must be of type string or ",n,!1,void 0,t)}const bz=new RegExp("[~\\*/\\[\\]]");function yS(n,e,t){if(e.search(bz)>=0)throw H0(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new cy(...e.split("."))._internalPath}catch{throw H0(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function H0(n,e,t,i,r){const s=i&&!i.isEmpty(),o=r!==void 0;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${i}`),o&&(c+=` in document ${r}`),c+=")"),new me(ee.INVALID_ARGUMENT,a+n+c)}function iN(n,e){return n.some((t=>t.isEqual(e)))}class rN{constructor(e,t,i,r,s){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new gn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new kz(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(vS("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class kz extends rN{data(){return super.data()}}function vS(n,e){return typeof e=="string"?yS(n,e):e instanceof cy?e._internalPath:e._delegate._internalPath}function Lz(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new me(ee.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class ES{}class Nz extends ES{}function Dz(n,e,...t){let i=[];e instanceof ES&&i.push(e),i=i.concat(t),(function(s){const o=s.filter((c=>c instanceof wS)).length,a=s.filter((c=>c instanceof hy)).length;if(o>1||o>0&&a>0)throw new me(ee.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const r of i)n=r._apply(n);return n}class hy extends Nz{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new hy(e,t,i)}_apply(e){const t=this._parse(e);return sN(e._query,t),new Vh(e.firestore,e.converter,JE(e._query,t))}_parse(e){const t=pS(e.firestore);return(function(s,o,a,c,h,d,g){let m;if(h.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new me(ee.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){FP(g,d);const y=[];for(const T of g)y.push(VP(c,s,T));m={arrayValue:{values:y}}}else m=VP(c,s,g)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||FP(g,d),m=Mz(a,o,g,d==="in"||d==="not-in");return tt.create(h,d,m)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function Oz(n,e,t){const i=e,r=vS("where",n);return hy._create(r,i,t)}class wS extends ES{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new wS(e,t)}_parse(e){const t=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return t.length===1?t[0]:St.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(r,s){let o=r;const a=s.getFlattenedFilters();for(const c of a)sN(o,c),o=JE(o,c)})(e._query,t),new Vh(e.firestore,e.converter,JE(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function VP(n,e,t){if(typeof(t=ii(t))=="string"){if(t==="")throw new me(ee.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Fk(e)&&t.indexOf("/")!==-1)throw new me(ee.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(gt.fromString(t));if(!pe.isDocumentKey(i))throw new me(ee.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return tg(n,new pe(i))}if(t instanceof gn)return tg(n,t._key);throw new me(ee.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${$_(t)}.`)}function FP(n,e){if(!Array.isArray(n)||n.length===0)throw new me(ee.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function sN(n,e){const t=(function(r,s){for(const o of r)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null})(n.filters,(function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new me(ee.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new me(ee.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class Vz{convertValue(e,t="none"){switch(ja(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Vt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(wo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Se(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return Ya(e,((r,s)=>{i[r]=this.convertValue(s,t)})),i}convertVectorValue(e){const t=e.fields?.[vh].arrayValue?.values?.map((i=>Vt(i.doubleValue)));return new Ps(t)}convertGeoPoint(e){return new Rs(Vt(e.latitude),Vt(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=Y_(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(Jf(e));default:return null}}convertTimestamp(e){const t=Eo(e);return new xt(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=gt.fromString(e);Ce(hL(i),9688,{name:e});const r=new dc(i.get(1),i.get(3)),s=new pe(i.popFirst(5));return r.isEqual(t)||ui(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}function Fz(n,e,t){let i;return i=n?n.toFirestore(e):e,i}class Rp{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ju extends rN{constructor(e,t,i,r,s,o){super(e,t,i,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Zp(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(vS("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new me(ee.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Ju._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Ju._jsonSchemaVersion="firestore/documentSnapshot/1.0",Ju._jsonSchema={type:ln("string",Ju._jsonSchemaVersion),bundleSource:ln("string","DocumentSnapshot"),bundleName:ln("string"),bundle:ln("string")};class Zp extends Ju{data(e={}){return super.data(e)}}class eh{constructor(e,t,i,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Rp(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new Zp(this._firestore,this._userDataWriter,i.key,i,new Rp(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new me(ee.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(r,s){if(r._snapshot.oldDocs.isEmpty()){let o=0;return r._snapshot.docChanges.map((a=>{const c=new Zp(r._firestore,r._userDataWriter,a.doc.key,a.doc,new Rp(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}}))}{let o=r._snapshot.oldDocs;return r._snapshot.docChanges.filter((a=>s||a.type!==3)).map((a=>{const c=new Zp(r._firestore,r._userDataWriter,a.doc.key,a.doc,new Rp(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter);let h=-1,d=-1;return a.type!==0&&(h=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:jz(a.type),doc:c,oldIndex:h,newIndex:d}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new me(ee.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=eh._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Nx.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],r=[];return this.docs.forEach((s=>{s._document!==null&&(t.push(s._document),i.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),r.push(s.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function jz(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Se(61501,{type:n})}}eh._jsonSchemaVersion="firestore/querySnapshot/1.0",eh._jsonSchema={type:ln("string",eh._jsonSchemaVersion),bundleSource:ln("string","QuerySnapshot"),bundleName:ln("string"),bundle:ln("string")};class Gz extends Vz{constructor(e){super(),this.firestore=e}convertBytes(e){return new vr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new gn(this.firestore,null,t)}}function Uz(n){n=Fa(n,Vh);const e=Fa(n.firestore,Fh),t=ZL(e),i=new Gz(e);return Lz(n._query),vz(t,n._query).then((r=>new eh(e,i,n,r)))}function zz(n,e,t,...i){n=Fa(n,gn);const r=Fa(n.firestore,Fh),s=pS(r);let o;return o=typeof(e=ii(e))=="string"||e instanceof cy?Cz(s,"updateDoc",n._key,e,t,i):Pz(s,"updateDoc",n._key,e),xS(r,[o.toMutation(n._key,hi.exists(!0))])}function Bz(n){return xS(Fa(n.firestore,Fh),[new ty(n._key,hi.none())])}function $z(n,e){const t=Fa(n.firestore,Fh),i=dw(n),r=Fz(n.converter,e);return xS(t,[Rz(pS(n.firestore),"addDoc",i._key,r,n.converter!==null,{}).toMutation(i._key,hi.exists(!1))]).then((()=>i))}function xS(n,e){return(function(i,r){const s=new mo;return i.asyncQueue.enqueueAndForget((async()=>sz(await _z(i),r,s))),s.promise})(ZL(n),e)}(function(e,t=!0){(function(r){Nh=r})(Ic),cc(new Va("firestore",((i,{instanceIdentifier:r,options:s})=>{const o=i.getProvider("app").getImmediate(),a=new Fh(new nj(i.getProvider("auth-internal")),new sj(o,i.getProvider("app-check-internal")),(function(h,d){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new me(ee.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new dc(h.options.projectId,d)})(o,r),o);return s={useFetchStreams:t,...s},a._setSettings(s),a}),"PUBLIC").setMultipleInstances(!0)),As(_R,yR,e),As(_R,yR,"esm2020")})();var Wz="firebase",Kz="12.7.0";As(Wz,Kz,"app");function oN(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const qz=oN,aN=new Cg("auth","Firebase",oN());const X0=new Mx("@firebase/auth");function Hz(n,...e){X0.logLevel<=et.WARN&&X0.warn(`Auth (${Ic}): ${n}`,...e)}function Qp(n,...e){X0.logLevel<=et.ERROR&&X0.error(`Auth (${Ic}): ${n}`,...e)}function xo(n,...e){throw SS(n,...e)}function Cs(n,...e){return SS(n,...e)}function lN(n,e,t){const i={...qz(),[e]:t};return new Cg("auth","Firebase",i).create(e,{appName:n.name})}function Jl(n){return lN(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function SS(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return aN.create(n,...e)}function ze(n,e,...t){if(!n)throw SS(e,...t)}function co(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Qp(e),new Error(e)}function So(n,e){n||co(e)}function gw(){return typeof self<"u"&&self.location?.href||""}function Xz(){return jP()==="http:"||jP()==="https:"}function jP(){return typeof self<"u"&&self.location?.protocol||null}function Yz(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Xz()||D9()||"connection"in navigator)?navigator.onLine:!0}function Zz(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class Ug{constructor(e,t){this.shortDelay=e,this.longDelay=t,So(t>e,"Short delay should be less than long delay!"),this.isMobile=L9()||O9()}get(){return Yz()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function TS(n,e){So(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class cN{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;co("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;co("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;co("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Qz={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const Jz=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],eB=new Ug(3e4,6e4);function IS(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function jh(n,e,t,i,r={}){return uN(n,r,async()=>{let s={},o={};i&&(e==="GET"?o=i:s={body:JSON.stringify(i)});const a=Mg({key:n.config.apiKey,...o}).slice(1),c=await n._getAdditionalHeaders();c["Content-Type"]="application/json",n.languageCode&&(c["X-Firebase-Locale"]=n.languageCode);const h={method:e,headers:c,...s};return N9()||(h.referrerPolicy="no-referrer"),n.emulatorConfig&&Tc(n.emulatorConfig.host)&&(h.credentials="include"),cN.fetch()(await hN(n,n.config.apiHost,t,a),h)})}async function uN(n,e,t){n._canInitEmulator=!1;const i={...Qz,...e};try{const r=new nB(n),s=await Promise.race([t(),r.promise]);r.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw Pp(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[c,h]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Pp(n,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Pp(n,"email-already-in-use",o);if(c==="USER_DISABLED")throw Pp(n,"user-disabled",o);const d=i[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw lN(n,d,h);xo(n,d)}}catch(r){if(r instanceof Vs)throw r;xo(n,"network-request-failed",{message:String(r)})}}async function tB(n,e,t,i,r={}){const s=await jh(n,e,t,i,r);return"mfaPendingCredential"in s&&xo(n,"multi-factor-auth-required",{_serverResponse:s}),s}async function hN(n,e,t,i){const r=`${e}${t}?${i}`,s=n,o=s.config.emulator?TS(n.config,r):`${n.config.apiScheme}://${r}`;return Jz.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}class nB{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(Cs(this.auth,"network-request-failed")),eB.get())})}}function Pp(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const r=Cs(n,e,i);return r.customData._tokenResponse=t,r}async function iB(n,e){return jh(n,"POST","/v1/accounts:delete",e)}async function Y0(n,e){return jh(n,"POST","/v1/accounts:lookup",e)}function Ef(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function rB(n,e=!1){const t=ii(n),i=await t.getIdToken(e),r=AS(i);ze(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");const s=typeof r.firebase=="object"?r.firebase:void 0,o=s?.sign_in_provider;return{claims:r,token:i,authTime:Ef(F1(r.auth_time)),issuedAtTime:Ef(F1(r.iat)),expirationTime:Ef(F1(r.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}}function F1(n){return Number(n)*1e3}function AS(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return Qp("JWT malformed, contained fewer than 3 sections"),null;try{const r=N4(t);return r?JSON.parse(r):(Qp("Failed to decode base64 JWT payload"),null)}catch(r){return Qp("Caught error parsing JWT payload as JSON",r?.toString()),null}}function GP(n){const e=AS(n);return ze(e,"internal-error"),ze(typeof e.exp<"u","internal-error"),ze(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function og(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof Vs&&sB(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function sB({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class oB{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class mw{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ef(this.lastLoginAt),this.creationTime=Ef(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Z0(n){const e=n.auth,t=await n.getIdToken(),i=await og(n,Y0(e,{idToken:t}));ze(i?.users.length,e,"internal-error");const r=i.users[0];n._notifyReloadListener(r);const s=r.providerUserInfo?.length?dN(r.providerUserInfo):[],o=lB(n.providerData,s),a=n.isAnonymous,c=!(n.email&&r.passwordHash)&&!o?.length,h=a?c:!1,d={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:o,metadata:new mw(r.createdAt,r.lastLoginAt),isAnonymous:h};Object.assign(n,d)}async function aB(n){const e=ii(n);await Z0(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function lB(n,e){return[...n.filter(i=>!e.some(r=>r.providerId===i.providerId)),...e]}function dN(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function cB(n,e){const t=await uN(n,{},async()=>{const i=Mg({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:s}=n.config,o=await hN(n,r,"/v1/token",`key=${s}`),a=await n._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:a,body:i};return n.emulatorConfig&&Tc(n.emulatorConfig.host)&&(c.credentials="include"),cN.fetch()(o,c)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function uB(n,e){return jh(n,"POST","/v2/accounts:revokeToken",IS(n,e))}class th{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ze(e.idToken,"internal-error"),ze(typeof e.idToken<"u","internal-error"),ze(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):GP(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){ze(e.length!==0,"internal-error");const t=GP(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(ze(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:r,expiresIn:s}=await cB(e,t);this.updateTokensAndExpiration(i,r,Number(s))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:r,expirationTime:s}=t,o=new th;return i&&(ze(typeof i=="string","internal-error",{appName:e}),o.refreshToken=i),r&&(ze(typeof r=="string","internal-error",{appName:e}),o.accessToken=r),s&&(ze(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new th,this.toJSON())}_performRefresh(){return co("not implemented")}}function ca(n,e){ze(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Kr{constructor({uid:e,auth:t,stsTokenManager:i,...r}){this.providerId="firebase",this.proactiveRefresh=new oB(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new mw(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const t=await og(this,this.stsTokenManager.getToken(this.auth,e));return ze(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return rB(this,e)}reload(){return aB(this)}_assign(e){this!==e&&(ze(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Kr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){ze(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await Z0(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Wr(this.auth.app))return Promise.reject(Jl(this.auth));const e=await this.getIdToken();return await og(this,iB(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,r=t.email??void 0,s=t.phoneNumber??void 0,o=t.photoURL??void 0,a=t.tenantId??void 0,c=t._redirectEventId??void 0,h=t.createdAt??void 0,d=t.lastLoginAt??void 0,{uid:g,emailVerified:m,isAnonymous:v,providerData:y,stsTokenManager:T}=t;ze(g&&T,e,"internal-error");const w=th.fromJSON(this.name,T);ze(typeof g=="string",e,"internal-error"),ca(i,e.name),ca(r,e.name),ze(typeof m=="boolean",e,"internal-error"),ze(typeof v=="boolean",e,"internal-error"),ca(s,e.name),ca(o,e.name),ca(a,e.name),ca(c,e.name),ca(h,e.name),ca(d,e.name);const A=new Kr({uid:g,auth:e,email:r,emailVerified:m,displayName:i,isAnonymous:v,photoURL:o,phoneNumber:s,tenantId:a,stsTokenManager:w,createdAt:h,lastLoginAt:d});return y&&Array.isArray(y)&&(A.providerData=y.map(P=>({...P}))),c&&(A._redirectEventId=c),A}static async _fromIdTokenResponse(e,t,i=!1){const r=new th;r.updateFromServerResponse(t);const s=new Kr({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:i});return await Z0(s),s}static async _fromGetAccountInfoResponse(e,t,i){const r=t.users[0];ze(r.localId!==void 0,"internal-error");const s=r.providerUserInfo!==void 0?dN(r.providerUserInfo):[],o=!(r.email&&r.passwordHash)&&!s?.length,a=new th;a.updateFromIdToken(i);const c=new Kr({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:o}),h={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:s,metadata:new mw(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!s?.length};return Object.assign(c,h),c}}const UP=new Map;function uo(n){So(n instanceof Function,"Expected a class definition");let e=UP.get(n);return e?(So(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,UP.set(n,e),e)}class fN{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}fN.type="NONE";const zP=fN;function Jp(n,e,t){return`firebase:${n}:${e}:${t}`}class nh{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:r,name:s}=this.auth;this.fullUserKey=Jp(this.userKey,r.apiKey,s),this.fullPersistenceKey=Jp("persistence",r.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Y0(this.auth,{idToken:e}).catch(()=>{});return t?Kr._fromGetAccountInfoResponse(this.auth,t,e):null}return Kr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new nh(uo(zP),e,i);const r=(await Promise.all(t.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let s=r[0]||uo(zP);const o=Jp(i,e.config.apiKey,e.name);let a=null;for(const h of t)try{const d=await h._get(o);if(d){let g;if(typeof d=="string"){const m=await Y0(e,{idToken:d}).catch(()=>{});if(!m)break;g=await Kr._fromGetAccountInfoResponse(e,m,d)}else g=Kr._fromJSON(e,d);h!==s&&(a=g),s=h;break}}catch{}const c=r.filter(h=>h._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new nh(s,e,i):(s=c[0],a&&await s._set(o,a.toJSON()),await Promise.all(t.map(async h=>{if(h!==s)try{await h._remove(o)}catch{}})),new nh(s,e,i))}}function BP(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(_N(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(gN(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(vN(e))return"Blackberry";if(EN(e))return"Webos";if(mN(e))return"Safari";if((e.includes("chrome/")||pN(e))&&!e.includes("edge/"))return"Chrome";if(yN(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if(i?.length===2)return i[1]}return"Other"}function gN(n=pn()){return/firefox\//i.test(n)}function mN(n=pn()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function pN(n=pn()){return/crios\//i.test(n)}function _N(n=pn()){return/iemobile/i.test(n)}function yN(n=pn()){return/android/i.test(n)}function vN(n=pn()){return/blackberry/i.test(n)}function EN(n=pn()){return/webos/i.test(n)}function RS(n=pn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function hB(n=pn()){return RS(n)&&!!window.navigator?.standalone}function dB(){return V9()&&document.documentMode===10}function wN(n=pn()){return RS(n)||yN(n)||EN(n)||vN(n)||/windows phone/i.test(n)||_N(n)}function xN(n,e=[]){let t;switch(n){case"Browser":t=BP(pn());break;case"Worker":t=`${BP(pn())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Ic}/${i}`}class fB{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=s=>new Promise((o,a)=>{try{const c=e(s);o(c)}catch(c){a(c)}});i.onAbort=t,this.queue.push(i);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function gB(n,e={}){return jh(n,"GET","/v2/passwordPolicy",IS(n,e))}const mB=6;class pB{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??mB,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let r=0;r<e.length;r++)i=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,r,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}class _B{constructor(e,t,i,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new $P(this),this.idTokenSubscription=new $P(this),this.beforeStateQueue=new fB(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=aN,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=uo(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await nh.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Y0(this,{idToken:e}),i=await Kr._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Wr(this.app)){const s=this.app.settings.authIdToken;return s?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(s).then(o,o))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const s=this.redirectUser?._redirectEventId,o=i?._redirectEventId,a=await this.tryRedirectSignIn(e);(!s||s===o)&&a?.user&&(i=a.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(s){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return ze(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Z0(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Zz()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Wr(this.app))return Promise.reject(Jl(this));const t=e?ii(e):null;return t&&ze(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&ze(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Wr(this.app)?Promise.reject(Jl(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Wr(this.app)?Promise.reject(Jl(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(uo(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await gB(this),t=new pB(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Cg("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await uB(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&uo(e)||this._popupRedirectResolver;ze(t,this,"argument-error"),this.redirectPersistenceManager=await nh.create(this,[uo(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,r){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(ze(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof t=="function"){const c=e.addObserver(t,i,r);return()=>{o=!0,c()}}else{const c=e.addObserver(t);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ze(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=xN(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(Wr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&Hz(`Error while retrieving App Check token: ${e.error}`),e?.token}}function PS(n){return ii(n)}class $P{constructor(e){this.auth=e,this.observer=null,this.addObserver=B9(t=>this.observer=t)}get next(){return ze(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let CS={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function yB(n){CS=n}function vB(n){return CS.loadJS(n)}function EB(){return CS.gapiScript}function wB(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function xB(n,e){const t=B_(n,"auth");if(t.isInitialized()){const r=t.getImmediate(),s=t.getOptions();if(lc(s,e??{}))return r;xo(r,"already-initialized")}return t.initialize({options:e})}function SB(n,e){const t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(uo);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e?.popupRedirectResolver)}function TB(n,e,t){const i=PS(n);ze(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const r=!1,s=SN(e),{host:o,port:a}=IB(e),c=a===null?"":`:${a}`,h={url:`${s}//${o}${c}/`},d=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!i._canInitEmulator){ze(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),ze(lc(h,i.config.emulator)&&lc(d,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=h,i.emulatorConfig=d,i.settings.appVerificationDisabledForTesting=!0,Tc(o)?(Px(`${s}//${o}${c}`),Cx("Auth",!0)):AB()}function SN(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function IB(n){const e=SN(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const s=r[1];return{host:s,port:WP(i.substr(s.length+1))}}else{const[s,o]=i.split(":");return{host:s,port:WP(o)}}}function WP(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function AB(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class TN{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return co("not implemented")}_getIdTokenResponse(e){return co("not implemented")}_linkToIdToken(e,t){return co("not implemented")}_getReauthenticationResolver(e){return co("not implemented")}}async function ih(n,e){return tB(n,"POST","/v1/accounts:signInWithIdp",IS(n,e))}const RB="http://localhost";class yc extends TN{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new yc(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):xo("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:r,...s}=t;if(!i||!r)return null;const o=new yc(i,r);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return ih(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,ih(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,ih(e,t)}buildRequest(){const e={requestUri:RB,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Mg(t)}return e}}class IN{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class zg extends IN{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class _a extends zg{constructor(){super("facebook.com")}static credential(e){return yc._fromParams({providerId:_a.PROVIDER_ID,signInMethod:_a.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return _a.credentialFromTaggedObject(e)}static credentialFromError(e){return _a.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return _a.credential(e.oauthAccessToken)}catch{return null}}}_a.FACEBOOK_SIGN_IN_METHOD="facebook.com";_a.PROVIDER_ID="facebook.com";class ya extends zg{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return yc._fromParams({providerId:ya.PROVIDER_ID,signInMethod:ya.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return ya.credentialFromTaggedObject(e)}static credentialFromError(e){return ya.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return ya.credential(t,i)}catch{return null}}}ya.GOOGLE_SIGN_IN_METHOD="google.com";ya.PROVIDER_ID="google.com";class va extends zg{constructor(){super("github.com")}static credential(e){return yc._fromParams({providerId:va.PROVIDER_ID,signInMethod:va.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return va.credentialFromTaggedObject(e)}static credentialFromError(e){return va.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return va.credential(e.oauthAccessToken)}catch{return null}}}va.GITHUB_SIGN_IN_METHOD="github.com";va.PROVIDER_ID="github.com";class Ea extends zg{constructor(){super("twitter.com")}static credential(e,t){return yc._fromParams({providerId:Ea.PROVIDER_ID,signInMethod:Ea.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Ea.credentialFromTaggedObject(e)}static credentialFromError(e){return Ea.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return Ea.credential(t,i)}catch{return null}}}Ea.TWITTER_SIGN_IN_METHOD="twitter.com";Ea.PROVIDER_ID="twitter.com";class Rh{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,r=!1){const s=await Kr._fromIdTokenResponse(e,i,r),o=KP(i);return new Rh({user:s,providerId:o,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const r=KP(i);return new Rh({user:e,providerId:r,_tokenResponse:i,operationType:t})}}function KP(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class Q0 extends Vs{constructor(e,t,i,r){super(t.code,t.message),this.operationType=i,this.user=r,Object.setPrototypeOf(this,Q0.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,r){return new Q0(e,t,i,r)}}function AN(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Q0._fromErrorAndOperation(n,s,e,i):s})}async function PB(n,e,t=!1){const i=await og(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Rh._forOperation(n,"link",i)}async function CB(n,e,t=!1){const{auth:i}=n;if(Wr(i.app))return Promise.reject(Jl(i));const r="reauthenticate";try{const s=await og(n,AN(i,r,e,n),t);ze(s.idToken,i,"internal-error");const o=AS(s.idToken);ze(o,i,"internal-error");const{sub:a}=o;return ze(n.uid===a,i,"user-mismatch"),Rh._forOperation(n,r,s)}catch(s){throw s?.code==="auth/user-not-found"&&xo(i,"user-mismatch"),s}}async function MB(n,e,t=!1){if(Wr(n.app))return Promise.reject(Jl(n));const i="signIn",r=await AN(n,i,e),s=await Rh._fromIdTokenResponse(n,i,r);return t||await n._updateCurrentUser(s.user),s}function bB(n,e,t,i){return ii(n).onIdTokenChanged(e,t,i)}function kB(n,e,t){return ii(n).beforeAuthStateChanged(e,t)}const J0="__sak";class RN{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(J0,"1"),this.storage.removeItem(J0),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const LB=1e3,NB=10;class PN extends RN{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=wN(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),r=this.localCache[t];i!==r&&e(t,r,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,a,c)=>{this.notifyListeners(o,c)});return}const i=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const o=this.storage.getItem(i);!t&&this.localCache[i]===o||this.notifyListeners(i,o)},s=this.storage.getItem(i);dB()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,NB):r()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},LB)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}PN.type="LOCAL";const DB=PN;class CN extends RN{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}CN.type="SESSION";const MN=CN;function OB(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class dy{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(r=>r.isListeningto(e));if(t)return t;const i=new dy(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:r,data:s}=t.data,o=this.handlersMap[r];if(!o?.size)return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:r});const a=Array.from(o).map(async h=>h(t.origin,s)),c=await OB(a);t.ports[0].postMessage({status:"done",eventId:i,eventType:r,response:c})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}dy.receivers=[];function MS(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}class VB{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let s,o;return new Promise((a,c)=>{const h=MS("",20);r.port1.start();const d=setTimeout(()=>{c(new Error("unsupported_event"))},i);o={messageChannel:r,onMessage(g){const m=g;if(m.data.eventId===h)switch(m.data.status){case"ack":clearTimeout(d),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(m.data.response);break;default:clearTimeout(d),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:h,data:t},[r.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}function Ms(){return window}function FB(n){Ms().location.href=n}function bN(){return typeof Ms().WorkerGlobalScope<"u"&&typeof Ms().importScripts=="function"}async function jB(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function GB(){return navigator?.serviceWorker?.controller||null}function UB(){return bN()?self:null}const kN="firebaseLocalStorageDb",zB=1,e_="firebaseLocalStorage",LN="fbase_key";class Bg{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function fy(n,e){return n.transaction([e_],e?"readwrite":"readonly").objectStore(e_)}function BB(){const n=indexedDB.deleteDatabase(kN);return new Bg(n).toPromise()}function pw(){const n=indexedDB.open(kN,zB);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(e_,{keyPath:LN})}catch(r){t(r)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(e_)?e(i):(i.close(),await BB(),e(await pw()))})})}async function qP(n,e,t){const i=fy(n,!0).put({[LN]:e,value:t});return new Bg(i).toPromise()}async function $B(n,e){const t=fy(n,!1).get(e),i=await new Bg(t).toPromise();return i===void 0?null:i.value}function HP(n,e){const t=fy(n,!0).delete(e);return new Bg(t).toPromise()}const WB=800,KB=3;class NN{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await pw(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>KB)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return bN()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=dy._getInstance(UB()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await jB(),!this.activeServiceWorker)return;this.sender=new VB(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||GB()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await pw();return await qP(e,J0,"1"),await HP(e,J0),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>qP(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>$B(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>HP(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const s=fy(r,!1).getAll();return new Bg(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:r,value:s}of e)i.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(s)&&(this.notifyListeners(r,s),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!i.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),WB)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}NN.type="LOCAL";const qB=NN;new Ug(3e4,6e4);function HB(n,e){return e?uo(e):(ze(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class bS extends TN{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ih(e,this._buildIdpRequest())}_linkToIdToken(e,t){return ih(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return ih(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function XB(n){return MB(n.auth,new bS(n),n.bypassAuthState)}function YB(n){const{auth:e,user:t}=n;return ze(t,e,"internal-error"),CB(t,new bS(n),n.bypassAuthState)}async function ZB(n){const{auth:e,user:t}=n;return ze(t,e,"internal-error"),PB(t,new bS(n),n.bypassAuthState)}class DN{constructor(e,t,i,r,s=!1){this.auth=e,this.resolver=i,this.user=r,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:r,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:t,sessionId:i,tenantId:s||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(c))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return XB;case"linkViaPopup":case"linkViaRedirect":return ZB;case"reauthViaPopup":case"reauthViaRedirect":return YB;default:xo(this.auth,"internal-error")}}resolve(e){So(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){So(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const QB=new Ug(2e3,1e4);class Vu extends DN{constructor(e,t,i,r,s){super(e,t,r,s),this.provider=i,this.authWindow=null,this.pollId=null,Vu.currentPopupAction&&Vu.currentPopupAction.cancel(),Vu.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ze(e,this.auth,"internal-error"),e}async onExecution(){So(this.filter.length===1,"Popup operations only handle one event");const e=MS();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Cs(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Cs(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Vu.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Cs(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,QB.get())};e()}}Vu.currentPopupAction=null;const JB="pendingRedirect",e0=new Map;class e$ extends DN{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=e0.get(this.auth._key());if(!e){try{const i=await t$(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}e0.set(this.auth._key(),e)}return this.bypassAuthState||e0.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function t$(n,e){const t=r$(e),i=i$(n);if(!await i._isAvailable())return!1;const r=await i._get(t)==="true";return await i._remove(t),r}function n$(n,e){e0.set(n._key(),e)}function i$(n){return uo(n._redirectPersistence)}function r$(n){return Jp(JB,n.config.apiKey,n.name)}async function s$(n,e,t=!1){if(Wr(n.app))return Promise.reject(Jl(n));const i=PS(n),r=HB(i,e),o=await new e$(i,r,t).execute();return o&&!t&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,e)),o}const o$=600*1e3;class a${constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!l$(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!ON(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Cs(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=o$&&this.cachedEventUids.clear(),this.cachedEventUids.has(XP(e))}saveEventToCache(e){this.cachedEventUids.add(XP(e)),this.lastProcessedEventTime=Date.now()}}function XP(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function ON({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function l$(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return ON(n);default:return!1}}async function c$(n,e={}){return jh(n,"GET","/v1/projects",e)}const u$=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,h$=/^https?/;async function d$(n){if(n.config.emulator)return;const{authorizedDomains:e}=await c$(n);for(const t of e)try{if(f$(t))return}catch{}xo(n,"unauthorized-domain")}function f$(n){const e=gw(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===i}if(!h$.test(t))return!1;if(u$.test(n))return i===n;const r=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}const g$=new Ug(3e4,6e4);function YP(){const n=Ms().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function m$(n){return new Promise((e,t)=>{function i(){YP(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{YP(),t(Cs(n,"network-request-failed"))},timeout:g$.get()})}if(Ms().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Ms().gapi?.load)i();else{const r=wB("iframefcb");return Ms()[r]=()=>{gapi.load?i():t(Cs(n,"network-request-failed"))},vB(`${EB()}?onload=${r}`).catch(s=>t(s))}}).catch(e=>{throw t0=null,e})}let t0=null;function p$(n){return t0=t0||m$(n),t0}const _$=new Ug(5e3,15e3),y$="__/auth/iframe",v$="emulator/auth/iframe",E$={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},w$=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function x$(n){const e=n.config;ze(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?TS(e,v$):`https://${n.config.authDomain}/${y$}`,i={apiKey:e.apiKey,appName:n.name,v:Ic},r=w$.get(n.config.apiHost);r&&(i.eid=r);const s=n._getFrameworks();return s.length&&(i.fw=s.join(",")),`${t}?${Mg(i).slice(1)}`}async function S$(n){const e=await p$(n),t=Ms().gapi;return ze(t,n,"internal-error"),e.open({where:document.body,url:x$(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:E$,dontclear:!0},i=>new Promise(async(r,s)=>{await i.restyle({setHideOnLeave:!1});const o=Cs(n,"network-request-failed"),a=Ms().setTimeout(()=>{s(o)},_$.get());function c(){Ms().clearTimeout(a),r(i)}i.ping(c).then(c,()=>{s(o)})}))}const T$={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},I$=500,A$=600,R$="_blank",P$="http://localhost";class ZP{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function C$(n,e,t,i=I$,r=A$){const s=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString();let a="";const c={...T$,width:i.toString(),height:r.toString(),top:s,left:o},h=pn().toLowerCase();t&&(a=pN(h)?R$:t),gN(h)&&(e=e||P$,c.scrollbars="yes");const d=Object.entries(c).reduce((m,[v,y])=>`${m}${v}=${y},`,"");if(hB(h)&&a!=="_self")return M$(e||"",a),new ZP(null);const g=window.open(e||"",a,d);ze(g,n,"popup-blocked");try{g.focus()}catch{}return new ZP(g)}function M$(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}const b$="__/auth/handler",k$="emulator/auth/handler",L$=encodeURIComponent("fac");async function QP(n,e,t,i,r,s){ze(n.config.authDomain,n,"auth-domain-config-required"),ze(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:Ic,eventId:r};if(e instanceof IN){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",z9(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,g]of Object.entries({}))o[d]=g}if(e instanceof zg){const d=e.getScopes().filter(g=>g!=="");d.length>0&&(o.scopes=d.join(","))}n.tenantId&&(o.tid=n.tenantId);const a=o;for(const d of Object.keys(a))a[d]===void 0&&delete a[d];const c=await n._getAppCheckToken(),h=c?`#${L$}=${encodeURIComponent(c)}`:"";return`${N$(n)}?${Mg(a).slice(1)}${h}`}function N$({config:n}){return n.emulator?TS(n,k$):`https://${n.authDomain}/${b$}`}const j1="webStorageSupport";class D${constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=MN,this._completeRedirectFn=s$,this._overrideRedirectResult=n$}async _openPopup(e,t,i,r){So(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const s=await QP(e,t,i,gw(),r);return C$(e,s,MS())}async _openRedirect(e,t,i,r){await this._originValidation(e);const s=await QP(e,t,i,gw(),r);return FB(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:r,promise:s}=this.eventManagers[t];return r?Promise.resolve(r):(So(s,"If manager is not set, promise should be"),s)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await S$(e),i=new a$(e);return t.register("authEvent",r=>(ze(r?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(j1,{type:j1},r=>{const s=r?.[0]?.[j1];s!==void 0&&t(!!s),xo(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=d$(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return wN()||mN()||RS()}}const O$=D$;var JP="@firebase/auth",eC="1.12.0";class V${constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){ze(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function F$(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function j$(n){cc(new Va("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=i.options;ze(o&&!o.includes(":"),"invalid-api-key",{appName:i.name});const c={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:xN(n)},h=new _B(i,r,s,c);return SB(h,t),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),cc(new Va("auth-internal",e=>{const t=PS(e.getProvider("auth").getImmediate());return(i=>new V$(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),As(JP,eC,F$(n)),As(JP,eC,"esm2020")}const G$=300,U$=j4("authIdTokenMaxAge")||G$;let tC=null;const z$=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>U$)return;const r=t?.token;tC!==r&&(tC=r,await fetch(n,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function B$(n=kx()){const e=B_(n,"auth");if(e.isInitialized())return e.getImmediate();const t=xB(n,{popupRedirectResolver:O$,persistence:[qB,DB,MN]}),i=j4("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(i,location.origin);if(location.origin===s.origin){const o=z$(s.toString());kB(t,o,()=>o(t.currentUser)),bB(t,a=>o(a))}}const r=O4("auth");return r&&TB(t,`http://${r}`),t}function $$(){return document.getElementsByTagName("head")?.[0]??document}yB({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=r=>{const s=Cs("internal-error");s.customData=r,t(s)},i.type="text/javascript",i.charset="UTF-8",$$().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});j$("Browser");const VN="firebasestorage.googleapis.com",W$="storageBucket",K$=120*1e3,q$=600*1e3;class Fs extends Vs{constructor(e,t,i=0){super(G1(e),`Firebase Storage: ${t} (${G1(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Fs.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return G1(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Ns;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Ns||(Ns={}));function G1(n){return"storage/"+n}function H$(){const n="An unknown error occurred, please check the error payload for server response.";return new Fs(Ns.UNKNOWN,n)}function X$(){return new Fs(Ns.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function Y$(){return new Fs(Ns.CANCELED,"User canceled the upload/download.")}function Z$(n){return new Fs(Ns.INVALID_URL,"Invalid URL '"+n+"'.")}function Q$(n){return new Fs(Ns.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function nC(n){return new Fs(Ns.INVALID_ARGUMENT,n)}function FN(){return new Fs(Ns.APP_DELETED,"The Firebase app was deleted.")}function J$(n){return new Fs(Ns.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}class qr{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=qr.makeFromUrl(e,t)}catch{return new qr(e,"")}if(i.path==="")return i;throw Q$(e)}static makeFromUrl(e,t){let i=null;const r="([A-Za-z0-9.\\-_]+)";function s(N){N.path.charAt(N.path.length-1)==="/"&&(N.path_=N.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+r+o,"i"),c={bucket:1,path:3};function h(N){N.path_=decodeURIComponent(N.path)}const d="v[A-Za-z0-9_]+",g=t.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",v=new RegExp(`^https?://${g}/${d}/b/${r}/o${m}`,"i"),y={bucket:1,path:3},T=t===VN?"(?:storage.googleapis.com|storage.cloud.google.com)":t,w="([^?#]*)",A=new RegExp(`^https?://${T}/${r}/${w}`,"i"),C=[{regex:a,indices:c,postModify:s},{regex:v,indices:y,postModify:h},{regex:A,indices:{bucket:1,path:2},postModify:h}];for(let N=0;N<C.length;N++){const D=C[N],z=D.regex.exec(e);if(z){const k=z[D.indices.bucket];let R=z[D.indices.path];R||(R=""),i=new qr(k,R),D.postModify(i);break}}if(i==null)throw Z$(e);return i}}class eW{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function tW(n,e,t){let i=1,r=null,s=null,o=!1,a=0;function c(){return a===2}let h=!1;function d(...w){h||(h=!0,e.apply(null,w))}function g(w){r=setTimeout(()=>{r=null,n(v,c())},w)}function m(){s&&clearTimeout(s)}function v(w,...A){if(h){m();return}if(w){m(),d.call(null,w,...A);return}if(c()||o){m(),d.call(null,w,...A);return}i<64&&(i*=2);let C;a===1?(a=2,C=0):C=(i+Math.random())*1e3,g(C)}let y=!1;function T(w){y||(y=!0,m(),!h&&(r!==null?(w||(a=2),clearTimeout(r),g(0)):w||(a=1)))}return g(0),s=setTimeout(()=>{o=!0,T(!0)},t),T}function nW(n){n(!1)}function iW(n){return n!==void 0}function iC(n,e,t,i){if(i<e)throw nC(`Invalid value for '${n}'. Expected ${e} or greater.`);if(i>t)throw nC(`Invalid value for '${n}'. Expected ${t} or less.`)}function rW(n){const e=encodeURIComponent;let t="?";for(const i in n)if(n.hasOwnProperty(i)){const r=e(i)+"="+e(n[i]);t=t+r+"&"}return t=t.slice(0,-1),t}var t_;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(t_||(t_={}));function sW(n,e){const t=n>=500&&n<600,r=[408,429].indexOf(n)!==-1,s=e.indexOf(n)!==-1;return t||r||s}class oW{constructor(e,t,i,r,s,o,a,c,h,d,g,m=!0,v=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=r,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=c,this.timeout_=h,this.progressCallback_=d,this.connectionFactory_=g,this.retry=m,this.isUsingEmulator=v,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((y,T)=>{this.resolve_=y,this.reject_=T,this.start_()})}start_(){const e=(i,r)=>{if(r){i(!1,new Cp(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const o=a=>{const c=a.loaded,h=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,h)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const a=s.getErrorCode()===t_.NO_ERROR,c=s.getStatus();if(!a||sW(c,this.additionalRetryCodes_)&&this.retry){const d=s.getErrorCode()===t_.ABORT;i(!1,new Cp(!1,null,d));return}const h=this.successCodes_.indexOf(c)!==-1;i(!0,new Cp(h,s))})},t=(i,r)=>{const s=this.resolve_,o=this.reject_,a=r.connection;if(r.wasSuccessCode)try{const c=this.callback_(a,a.getResponse());iW(c)?s(c):s()}catch(c){o(c)}else if(a!==null){const c=H$();c.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,c)):o(c)}else if(r.canceled){const c=this.appDelete_?FN():Y$();o(c)}else{const c=X$();o(c)}};this.canceled_?t(!1,new Cp(!1,null,!0)):this.backoffId_=tW(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&nW(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Cp{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function aW(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function lW(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function cW(n,e){e&&(n["X-Firebase-GMPID"]=e)}function uW(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function hW(n,e,t,i,r,s,o=!0,a=!1){const c=rW(n.urlParams),h=n.url+c,d=Object.assign({},n.headers);return cW(d,e),aW(d,t),lW(d,s),uW(d,i),new oW(h,n.method,d,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,r,o,a)}function dW(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function fW(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}class n_{constructor(e,t){this._service=e,t instanceof qr?this._location=t:this._location=qr.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new n_(e,t)}get root(){const e=new qr(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return fW(this._location.path)}get storage(){return this._service}get parent(){const e=dW(this._location.path);if(e===null)return null;const t=new qr(this._location.bucket,e);return new n_(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw J$(e)}}function rC(n,e){const t=e?.[W$];return t==null?null:qr.makeFromBucketSpec(t,n)}function gW(n,e,t,i={}){n.host=`${e}:${t}`;const r=Tc(e);r&&(Px(`https://${n.host}/b`),Cx("Storage",!0)),n._isUsingEmulator=!0,n._protocol=r?"https":"http";const{mockUserToken:s}=i;s&&(n._overrideAuthToken=typeof s=="string"?s:G4(s,n.app.options.projectId))}class mW{constructor(e,t,i,r,s,o=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=r,this._firebaseVersion=s,this._isUsingEmulator=o,this._bucket=null,this._host=VN,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=K$,this._maxUploadRetryTime=q$,this._requests=new Set,r!=null?this._bucket=qr.makeFromBucketSpec(r,this._host):this._bucket=rC(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=qr.makeFromBucketSpec(this._url,e):this._bucket=rC(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){iC("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){iC("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Wr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new n_(this,e)}_makeRequest(e,t,i,r,s=!0){if(this._deleted)return new eW(FN());{const o=hW(e,this._appId,i,r,t,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,t){const[i,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,r).getPromise()}}const sC="@firebase/storage",oC="0.14.0";const jN="storage";function pW(n=kx(),e){n=ii(n);const i=B_(n,jN).getImmediate({identifier:e}),r=V4("storage");return r&&_W(i,...r),i}function _W(n,e,t,i={}){gW(n,e,t,i)}function yW(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),i=n.getProvider("auth-internal"),r=n.getProvider("app-check-internal");return new mW(t,i,r,e,Ic)}function vW(){cc(new Va(jN,yW,"PUBLIC").setMultipleInstances(!0)),As(sC,oC,""),As(sC,oC,"esm2020")}vW();const EW={apiKey:"REPLACE_WITH_YOUR_API_KEY",authDomain:"your-project.firebaseapp.com",projectId:"your-project-id",storageBucket:"your-project.appspot.com",messagingSenderId:"123456789",appId:"1:123456789:web:abcdef"},kS=q4(EW);B$(kS);const tf=wz(kS);pW(kS);xz(tf).catch(n=>{n.code==="failed-precondition"?console.warn("Offline persistence failed: Multiple tabs open"):n.code==="unimplemented"&&console.warn("Offline persistence not available in this browser")});Ha()(Sc((n,e)=>({vondsten:[],loading:!1,error:null,loadVondsten:async t=>{n(i=>{i.loading=!0});try{const i=Dz(LP(tf,"vondsten"),Oz("userId","==",t)),s=(await Uz(i)).docs.map(o=>({id:o.id,...o.data()}));n(o=>{o.vondsten=s,o.loading=!1})}catch(i){n(r=>{r.error=i.message,r.loading=!1})}},addVondst:async t=>{const i=new Date().toISOString(),r={...t,createdAt:i,updatedAt:i},s=await $z(LP(tf,"vondsten"),r);return n(o=>{o.vondsten.push({...r,id:s.id})}),s.id},updateVondst:async(t,i)=>{const r=dw(tf,"vondsten",t);await zz(r,{...i,updatedAt:new Date().toISOString()}),n(s=>{const o=s.vondsten.findIndex(a=>a.id===t);o!==-1&&(s.vondsten[o]={...s.vondsten[o],...i})})},deleteVondst:async t=>{await Bz(dw(tf,"vondsten",t)),n(i=>{i.vondsten=i.vondsten.filter(r=>r.id!==t)})}})));const wW={};function xW(n,e){let t;try{t=n()}catch{return}return{getItem:r=>{var s;const o=c=>c===null?null:JSON.parse(c,void 0),a=(s=t.getItem(r))!=null?s:null;return a instanceof Promise?a.then(o):o(a)},setItem:(r,s)=>t.setItem(r,JSON.stringify(s,void 0)),removeItem:r=>t.removeItem(r)}}const ag=n=>e=>{try{const t=n(e);return t instanceof Promise?t:{then(i){return ag(i)(t)},catch(i){return this}}}catch(t){return{then(i){return this},catch(i){return ag(i)(t)}}}},SW=(n,e)=>(t,i,r)=>{let s={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:w=>w,version:0,merge:(w,A)=>({...A,...w}),...e},o=!1;const a=new Set,c=new Set;let h;try{h=s.getStorage()}catch{}if(!h)return n((...w)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(...w)},i,r);const d=ag(s.serialize),g=()=>{const w=s.partialize({...i()});let A;const P=d({state:w,version:s.version}).then(C=>h.setItem(s.name,C)).catch(C=>{A=C});if(A)throw A;return P},m=r.setState;r.setState=(w,A)=>{m(w,A),g()};const v=n((...w)=>{t(...w),g()},i,r);let y;const T=()=>{var w;if(!h)return;o=!1,a.forEach(P=>P(i()));const A=((w=s.onRehydrateStorage)==null?void 0:w.call(s,i()))||void 0;return ag(h.getItem.bind(h))(s.name).then(P=>{if(P)return s.deserialize(P)}).then(P=>{if(P)if(typeof P.version=="number"&&P.version!==s.version){if(s.migrate)return s.migrate(P.state,P.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return P.state}).then(P=>{var C;return y=s.merge(P,(C=i())!=null?C:v),t(y,!0),g()}).then(()=>{A?.(y,void 0),o=!0,c.forEach(P=>P(y))}).catch(P=>{A?.(void 0,P)})};return r.persist={setOptions:w=>{s={...s,...w},w.getStorage&&(h=w.getStorage())},clearStorage:()=>{h?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>T(),hasHydrated:()=>o,onHydrate:w=>(a.add(w),()=>{a.delete(w)}),onFinishHydration:w=>(c.add(w),()=>{c.delete(w)})},T(),y||v},TW=(n,e)=>(t,i,r)=>{let s={storage:xW(()=>localStorage),partialize:T=>T,version:0,merge:(T,w)=>({...w,...T}),...e},o=!1;const a=new Set,c=new Set;let h=s.storage;if(!h)return n((...T)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(...T)},i,r);const d=()=>{const T=s.partialize({...i()});return h.setItem(s.name,{state:T,version:s.version})},g=r.setState;r.setState=(T,w)=>{g(T,w),d()};const m=n((...T)=>{t(...T),d()},i,r);r.getInitialState=()=>m;let v;const y=()=>{var T,w;if(!h)return;o=!1,a.forEach(P=>{var C;return P((C=i())!=null?C:m)});const A=((w=s.onRehydrateStorage)==null?void 0:w.call(s,(T=i())!=null?T:m))||void 0;return ag(h.getItem.bind(h))(s.name).then(P=>{if(P)if(typeof P.version=="number"&&P.version!==s.version){if(s.migrate)return[!0,s.migrate(P.state,P.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,P.state];return[!1,void 0]}).then(P=>{var C;const[N,D]=P;if(v=s.merge(D,(C=i())!=null?C:m),t(v,!0),N)return d()}).then(()=>{A?.(v,void 0),v=i(),o=!0,c.forEach(P=>P(v))}).catch(P=>{A?.(void 0,P)})};return r.persist={setOptions:T=>{s={...s,...T},T.storage&&(h=T.storage)},clearStorage:()=>{h?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>y(),hasHydrated:()=>o,onHydrate:T=>(a.add(T),()=>{a.delete(T)}),onFinishHydration:T=>(c.add(T),()=>{c.delete(T)})},s.skipHydration||y(),v||m},IW=(n,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((wW?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),SW(n,e)):TW(n,e),AW=IW,RW=Ha()(AW(n=>({language:"nl",colorScheme:"light",units:"metric",defaultBackground:"CartoDB (licht)",rememberLastLocation:!0,showScaleBar:!0,gpsAutoStart:!1,headingUpMode:!1,showAccuracyCircle:!0,markerClustering:!0,showCoordinates:!1,hapticFeedback:!0,setLanguage:e=>n({language:e}),setColorScheme:e=>n({colorScheme:e}),setUnits:e=>n({units:e}),setDefaultBackground:e=>n({defaultBackground:e}),setRememberLastLocation:e=>n({rememberLastLocation:e}),setShowScaleBar:e=>n({showScaleBar:e}),setGpsAutoStart:e=>n({gpsAutoStart:e}),setHeadingUpMode:e=>n({headingUpMode:e}),setShowAccuracyCircle:e=>n({showAccuracyCircle:e}),setMarkerClustering:e=>n({markerClustering:e}),setShowCoordinates:e=>n({showCoordinates:e}),setHapticFeedback:e=>n({hapticFeedback:e})}),{name:"detectorapp-settings"}));function PW({target:n,viewOptions:e}){const t=ne.useRef(null),i=Li(r=>r.setMap);return ne.useEffect(()=>{if(!t.current){const r={center:[5.1214,52.0907],zoom:8,rotation:0,minZoom:3,maxZoom:19,...e},s=new HF({target:n,controls:[],view:new ws({center:ic(r.center),zoom:r.zoom,rotation:r.rotation,minZoom:r.minZoom,maxZoom:r.maxZoom})});t.current=s,i(s),window.__olMap=s}return()=>{t.current&&(t.current.setTarget(void 0),i(null),window.__olMap=null)}},[n,e,i]),t.current}const CW="https://router.project-osrm.org/route/v1/driving";function MW(n,e){const t={depart:"Start de route",arrive:"U bent aangekomen","turn-left":"Sla linksaf","turn-right":"Sla rechtsaf","turn-slight-left":"Houd links aan","turn-slight-right":"Houd rechts aan","turn-sharp-left":"Sla scherp linksaf","turn-sharp-right":"Sla scherp rechtsaf",uturn:"Keer om",straight:"Ga rechtdoor",merge:"Voeg in","on-ramp":"Neem de oprit","off-ramp":"Neem de afrit","fork-left":"Houd links aan bij de splitsing","fork-right":"Houd rechts aan bij de splitsing","end-of-road-left":"Sla linksaf aan het einde van de weg","end-of-road-right":"Sla rechtsaf aan het einde van de weg",roundabout:"Neem de rotonde",rotary:"Neem de rotonde",continue:"Blijf de weg volgen",notification:"Let op"},i=e?`${n}-${e}`:n;return t[i]||t[n]||"Volg de route"}function aC(n,e){const i=(e.lat-n.lat)*Math.PI/180,r=(e.lng-n.lng)*Math.PI/180,s=Math.sin(i/2)*Math.sin(i/2)+Math.cos(n.lat*Math.PI/180)*Math.cos(e.lat*Math.PI/180)*Math.sin(r/2)*Math.sin(r/2);return 6371e3*(2*Math.atan2(Math.sqrt(s),Math.sqrt(1-s)))}const tn=Ha()(Sc((n,e)=>({isNavigating:!1,destination:null,destinationName:null,routeCoordinates:null,distance:null,duration:null,loading:!1,error:null,steps:[],currentStepIndex:0,voiceEnabled:!0,lastSpokenStep:-1,lastSpokenTime:0,lastSpokenDistance:-1,startNavigation:async(t,i,r)=>{n(s=>{s.loading=!0,s.error=null});try{const s=`${CW}/${r.lng},${r.lat};${t.lng},${t.lat}?overview=full&geometries=geojson&steps=true`,o=await fetch(s);if(!o.ok)throw new Error("Route berekening mislukt");const a=await o.json();if(a.code==="Ok"&&a.routes&&a.routes.length>0){const c=a.routes[0],h=c.geometry.coordinates.map(g=>({lng:g[0],lat:g[1]})),d=[];if(c.legs&&c.legs[0]&&c.legs[0].steps)for(const g of c.legs[0].steps){const m=g.maneuver?.type||"continue",v=g.maneuver?.modifier;d.push({instruction:MW(m,v),maneuver:v?`${m}-${v}`:m,distance:g.distance||0,duration:g.duration||0,location:{lng:g.maneuver?.location?.[0]||r.lng,lat:g.maneuver?.location?.[1]||r.lat}})}if(n(g=>{g.isNavigating=!0,g.destination=t,g.destinationName=i,g.routeCoordinates=h,g.distance=c.distance,g.duration=c.duration,g.steps=d,g.currentStepIndex=0,g.lastSpokenStep=-1,g.loading=!1}),d.length>0){const g=d[0],m=g.distance>1e3?`${(g.distance/1e3).toFixed(1)} kilometer`:`${Math.round(g.distance)} meter`;e().speakInstruction(`${g.instruction}. Over ${m}.`)}console.log(` Navigation started to ${i}`),console.log(` Distance: ${(c.distance/1e3).toFixed(1)} km`),console.log(` Duration: ${Math.round(c.duration/60)} min`),console.log(` Steps: ${d.length}`)}else throw new Error(a.message||"Geen route gevonden")}catch(s){console.error("Navigation error:",s),n(o=>{o.loading=!1,o.error=s.message||"Navigatie fout"})}},stopNavigation:()=>{"speechSynthesis"in window&&window.speechSynthesis.cancel(),n(t=>{t.isNavigating=!1,t.destination=null,t.destinationName=null,t.routeCoordinates=null,t.distance=null,t.duration=null,t.error=null,t.steps=[],t.currentStepIndex=0,t.lastSpokenStep=-1,t.lastSpokenTime=0,t.lastSpokenDistance=-1}),console.log(" Navigation stopped")},clearError:()=>{n(t=>{t.error=null})},updateCurrentStep:t=>{const{steps:i,currentStepIndex:r,lastSpokenStep:s,lastSpokenTime:o,lastSpokenDistance:a,voiceEnabled:c}=e();if(i.length===0)return;const h=Date.now(),d=5e3;let g=r;for(let m=r;m<i.length;m++){const v=i[m].location;aC(t,v)<30&&(g=Math.min(m+1,i.length-1))}if(g!==r&&(n(m=>{m.currentStepIndex=g}),c&&g!==s&&g<i.length&&h-o>d)){const m=i[g],v=m.distance>1e3?`${(m.distance/1e3).toFixed(1)} kilometer`:`${Math.round(m.distance)} meter`;e().speakInstruction(`${m.instruction}. Over ${v}.`),n(y=>{y.lastSpokenStep=g,y.lastSpokenTime=h,y.lastSpokenDistance=-1})}if(c&&r<i.length){const m=i[r],v=aC(t,m.location);if(h-o<d)return;const y=[200,100,50];for(const T of y)if(v<=T&&v>T-30&&(a===-1||Math.abs(a-T)>30)&&m.maneuver!=="depart"&&m.maneuver!=="arrive"){e().speakInstruction(`Over ${T} meter, ${m.instruction.toLowerCase()}.`),n(w=>{w.lastSpokenTime=h,w.lastSpokenDistance=T});break}}},setVoiceEnabled:t=>{n(i=>{i.voiceEnabled=t}),!t&&"speechSynthesis"in window&&window.speechSynthesis.cancel()},speakInstruction:t=>{if(e().voiceEnabled&&"speechSynthesis"in window){window.speechSynthesis.cancel();const i=new SpeechSynthesisUtterance(t);i.lang="nl-NL",i.rate=1,i.pitch=1,i.volume=1;const s=window.speechSynthesis.getVoices().find(o=>o.lang.startsWith("nl"));s&&(i.voice=s),window.speechSynthesis.speak(i),console.log(` Speaking: ${t}`)}}})));function bW(){const n=ne.useRef(null);PW({target:"map"});const e=Li(o=>o.map),t=Ss(o=>o.registerLayer),i=tn(o=>o.isNavigating);ne.useEffect(()=>{if(!e){console.warn(" Map not initialized yet");return}console.log(" Initializing map layers...");const o=new oo({properties:{title:"OpenStreetMap",type:"base"},visible:!1,source:new fF}),a=new oo({properties:{title:"CartoDB (licht)",type:"base"},visible:!0,source:new ha({url:"https://{a-d}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",attributions:" OpenStreetMap contributors  CARTO"})}),c=new oo({properties:{title:"CartoDB (donker)",type:"base"},visible:!1,source:new ha({url:"https://{a-d}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png",attributions:" OpenStreetMap contributors  CARTO"})}),h=new oo({properties:{title:"OpenTopoMap",type:"base"},visible:!1,source:new ha({url:"https://{a-c}.tile.opentopomap.org/{z}/{x}/{y}.png",attributions:" OpenTopoMap (CC-BY-SA)",maxZoom:17})}),d=new oo({properties:{title:"Luchtfoto",type:"base"},visible:!1,source:new ha({url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",attributions:" Esri, Maxar, Earthstar Geographics",maxZoom:19})}),g=new oo({properties:{title:"Labels Overlay",type:"overlay"},visible:!1,source:new ha({url:"https://{a-d}.basemaps.cartocdn.com/rastertiles/voyager_only_labels/{z}/{x}/{y}.png",attributions:" OpenStreetMap contributors  CARTO",maxZoom:20}),zIndex:100}),m=new oo({properties:{title:"TMK 1850",type:"base"},visible:!1,source:new ha({url:"https://s.map5.nl/map/gast/tiles/tmk_1850/EPSG3857/{z}/{x}/{y}.png",attributions:" Kadaster / Map5.nl",crossOrigin:"anonymous",maxZoom:14})}),v=new oo({properties:{title:"Bonnebladen 1900",type:"base"},visible:!1,source:new ha({url:"https://s.map5.nl/map/gast/tiles/bonne_1900/EPSG3857/{z}/{x}/{y}.png",attributions:" Kadaster / Map5.nl",crossOrigin:"anonymous",maxZoom:14})});e.addLayer(o),e.addLayer(a),e.addLayer(c),e.addLayer(h),e.addLayer(d),e.addLayer(g),e.addLayer(m),e.addLayer(v),console.log(" Base layers added:",{osm:o.getVisible(),cartodb:a.getVisible(),satellite:d.getVisible()}),t("OpenStreetMap",o),t("CartoDB (licht)",a),t("CartoDB (donker)",c),t("OpenTopoMap",h),t("Luchtfoto",d),t("Labels Overlay",g),t("TMK 1850",m),t("Bonnebladen 1900",v),e.updateSize(),console.log(" Map size:",e.getSize()),console.log(" Map center:",e.getView().getCenter()),console.log(" Map zoom:",e.getView().getZoom()),r()},[e,t]);async function r(){if(!e){console.error(" Cannot load layers: map is null");return}const o=x9();console.log(` Loading ${o.length} immediate-load layers (WMS/Tile)...`);const a=await Promise.allSettled(o.map(async h=>{try{const d=await h.factory();return d?{name:h.name,layer:d}:null}catch(d){return console.warn(` Failed to create ${h.name}:`,d),null}}));let c=0;a.forEach(h=>{if(h.status==="fulfilled"&&h.value){const{name:d,layer:g}=h.value;e.addLayer(g),t(d,g),c++,console.log(`   ${d}`)}}),console.log(` Immediate layers loaded: ${c}/${o.length}`),console.log(` Total layers on map: ${e.getLayers().getLength()}`),console.log(" Vector layers will load on first toggle (lazy loading enabled)")}const s={width:"100%",height:"100vh",transition:"transform 0.5s ease-out",transformOrigin:"center bottom",...i?{transform:"perspective(1000px) rotateX(25deg) scale(1.1)"}:{}};return M.jsx("div",{id:"map",ref:n,style:s})}const LS=ne.createContext({});function NS(n){const e=ne.useRef(null);return e.current===null&&(e.current=n()),e.current}const gy=ne.createContext(null),DS=ne.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"});class kW extends ne.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const i=this.props.sizeRef.current;i.height=t.offsetHeight||0,i.width=t.offsetWidth||0,i.top=t.offsetTop,i.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function LW({children:n,isPresent:e}){const t=ne.useId(),i=ne.useRef(null),r=ne.useRef({width:0,height:0,top:0,left:0}),{nonce:s}=ne.useContext(DS);return ne.useInsertionEffect(()=>{const{width:o,height:a,top:c,left:h}=r.current;if(e||!i.current||!o||!a)return;i.current.dataset.motionPopId=t;const d=document.createElement("style");return s&&(d.nonce=s),document.head.appendChild(d),d.sheet&&d.sheet.insertRule(`
          [data-motion-pop-id="${t}"] {
            position: absolute !important;
            width: ${o}px !important;
            height: ${a}px !important;
            top: ${c}px !important;
            left: ${h}px !important;
          }
        `),()=>{document.head.removeChild(d)}},[e]),M.jsx(kW,{isPresent:e,childRef:i,sizeRef:r,children:ne.cloneElement(n,{ref:i})})}const NW=({children:n,initial:e,isPresent:t,onExitComplete:i,custom:r,presenceAffectsLayout:s,mode:o})=>{const a=NS(DW),c=ne.useId(),h=ne.useCallback(g=>{a.set(g,!0);for(const m of a.values())if(!m)return;i&&i()},[a,i]),d=ne.useMemo(()=>({id:c,initial:e,isPresent:t,custom:r,onExitComplete:h,register:g=>(a.set(g,!1),()=>a.delete(g))}),s?[Math.random(),h]:[t,h]);return ne.useMemo(()=>{a.forEach((g,m)=>a.set(m,!1))},[t]),ne.useEffect(()=>{!t&&!a.size&&i&&i()},[t]),o==="popLayout"&&(n=M.jsx(LW,{isPresent:t,children:n})),M.jsx(gy.Provider,{value:d,children:n})};function DW(){return new Map}function GN(n=!0){const e=ne.useContext(gy);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:i,register:r}=e,s=ne.useId();ne.useEffect(()=>{n&&r(s)},[n]);const o=ne.useCallback(()=>n&&i&&i(s),[s,i,n]);return!t&&i?[!1,o]:[!0]}const Mp=n=>n.key||"";function lC(n){const e=[];return ne.Children.forEach(n,t=>{ne.isValidElement(t)&&e.push(t)}),e}const OS=typeof window<"u",UN=OS?ne.useLayoutEffect:ne.useEffect,Co=({children:n,custom:e,initial:t=!0,onExitComplete:i,presenceAffectsLayout:r=!0,mode:s="sync",propagate:o=!1})=>{const[a,c]=GN(o),h=ne.useMemo(()=>lC(n),[n]),d=o&&!a?[]:h.map(Mp),g=ne.useRef(!0),m=ne.useRef(h),v=NS(()=>new Map),[y,T]=ne.useState(h),[w,A]=ne.useState(h);UN(()=>{g.current=!1,m.current=h;for(let N=0;N<w.length;N++){const D=Mp(w[N]);d.includes(D)?v.delete(D):v.get(D)!==!0&&v.set(D,!1)}},[w,d.length,d.join("-")]);const P=[];if(h!==y){let N=[...h];for(let D=0;D<w.length;D++){const z=w[D],k=Mp(z);d.includes(k)||(N.splice(D,0,z),P.push(z))}s==="wait"&&P.length&&(N=P),A(lC(N)),T(h);return}const{forceRender:C}=ne.useContext(LS);return M.jsx(M.Fragment,{children:w.map(N=>{const D=Mp(N),z=o&&!a?!1:h===w||d.includes(D),k=()=>{if(v.has(D))v.set(D,!0);else return;let R=!0;v.forEach(L=>{L||(R=!1)}),R&&(C?.(),A(m.current),o&&c?.(),i&&i())};return M.jsx(NW,{isPresent:z,initial:!g.current||t?void 0:!1,custom:z?void 0:e,presenceAffectsLayout:r,mode:s,onExitComplete:z?void 0:k,children:N},D)})})},Yi=n=>n;let zN=Yi;function VS(n){let e;return()=>(e===void 0&&(e=n()),e)}const Ph=(n,e,t)=>{const i=e-n;return i===0?1:(t-n)/i},po=n=>n*1e3,_o=n=>n/1e3,OW={useManualTiming:!1};function VW(n){let e=new Set,t=new Set,i=!1,r=!1;const s=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function a(h){s.has(h)&&(c.schedule(h),n()),h(o)}const c={schedule:(h,d=!1,g=!1)=>{const v=g&&i?e:t;return d&&s.add(h),v.has(h)||v.add(h),h},cancel:h=>{t.delete(h),s.delete(h)},process:h=>{if(o=h,i){r=!0;return}i=!0,[e,t]=[t,e],e.forEach(a),e.clear(),i=!1,r&&(r=!1,c.process(h))}};return c}const bp=["read","resolveKeyframes","update","preRender","render","postRender"],FW=40;function BN(n,e){let t=!1,i=!0;const r={delta:0,timestamp:0,isProcessing:!1},s=()=>t=!0,o=bp.reduce((A,P)=>(A[P]=VW(s),A),{}),{read:a,resolveKeyframes:c,update:h,preRender:d,render:g,postRender:m}=o,v=()=>{const A=performance.now();t=!1,r.delta=i?1e3/60:Math.max(Math.min(A-r.timestamp,FW),1),r.timestamp=A,r.isProcessing=!0,a.process(r),c.process(r),h.process(r),d.process(r),g.process(r),m.process(r),r.isProcessing=!1,t&&e&&(i=!1,n(v))},y=()=>{t=!0,i=!0,r.isProcessing||n(v)};return{schedule:bp.reduce((A,P)=>{const C=o[P];return A[P]=(N,D=!1,z=!1)=>(t||y(),C.schedule(N,D,z)),A},{}),cancel:A=>{for(let P=0;P<bp.length;P++)o[bp[P]].cancel(A)},state:r,steps:o}}const{schedule:Lt,cancel:Ba,state:Vn,steps:U1}=BN(typeof requestAnimationFrame<"u"?requestAnimationFrame:Yi,!0),$N=ne.createContext({strict:!1}),cC={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Ch={};for(const n in cC)Ch[n]={isEnabled:e=>cC[n].some(t=>!!e[t])};function jW(n){for(const e in n)Ch[e]={...Ch[e],...n[e]}}const GW=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function i_(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||GW.has(n)}let WN=n=>!i_(n);function UW(n){n&&(WN=e=>e.startsWith("on")?!i_(e):n(e))}try{UW(require("@emotion/is-prop-valid").default)}catch{}function zW(n,e,t){const i={};for(const r in n)r==="values"&&typeof n.values=="object"||(WN(r)||t===!0&&i_(r)||!e&&!i_(r)||n.draggable&&r.startsWith("onDrag"))&&(i[r]=n[r]);return i}function BW(n){if(typeof Proxy>"u")return n;const e=new Map,t=(...i)=>n(...i);return new Proxy(t,{get:(i,r)=>r==="create"?n:(e.has(r)||e.set(r,n(r)),e.get(r))})}const my=ne.createContext({});function lg(n){return typeof n=="string"||Array.isArray(n)}function py(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}const FS=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],jS=["initial",...FS];function _y(n){return py(n.animate)||jS.some(e=>lg(n[e]))}function KN(n){return!!(_y(n)||n.variants)}function $W(n,e){if(_y(n)){const{initial:t,animate:i}=n;return{initial:t===!1||lg(t)?t:void 0,animate:lg(i)?i:void 0}}return n.inherit!==!1?e:{}}function WW(n){const{initial:e,animate:t}=$W(n,ne.useContext(my));return ne.useMemo(()=>({initial:e,animate:t}),[uC(e),uC(t)])}function uC(n){return Array.isArray(n)?n.join(" "):n}const KW=Symbol.for("motionComponentSymbol");function Fu(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function qW(n,e,t){return ne.useCallback(i=>{i&&n.onMount&&n.onMount(i),e&&(i?e.mount(i):e.unmount()),t&&(typeof t=="function"?t(i):Fu(t)&&(t.current=i))},[e])}const GS=n=>n.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),HW="framerAppearId",qN="data-"+GS(HW),{schedule:US}=BN(queueMicrotask,!1),HN=ne.createContext({});function XW(n,e,t,i,r){var s,o;const{visualElement:a}=ne.useContext(my),c=ne.useContext($N),h=ne.useContext(gy),d=ne.useContext(DS).reducedMotion,g=ne.useRef(null);i=i||c.renderer,!g.current&&i&&(g.current=i(n,{visualState:e,parent:a,props:t,presenceContext:h,blockInitialAnimation:h?h.initial===!1:!1,reducedMotionConfig:d}));const m=g.current,v=ne.useContext(HN);m&&!m.projection&&r&&(m.type==="html"||m.type==="svg")&&YW(g.current,t,r,v);const y=ne.useRef(!1);ne.useInsertionEffect(()=>{m&&y.current&&m.update(t,h)});const T=t[qN],w=ne.useRef(!!T&&!(!((s=window.MotionHandoffIsComplete)===null||s===void 0)&&s.call(window,T))&&((o=window.MotionHasOptimisedAnimation)===null||o===void 0?void 0:o.call(window,T)));return UN(()=>{m&&(y.current=!0,window.MotionIsMounted=!0,m.updateFeatures(),US.render(m.render),w.current&&m.animationState&&m.animationState.animateChanges())}),ne.useEffect(()=>{m&&(!w.current&&m.animationState&&m.animationState.animateChanges(),w.current&&(queueMicrotask(()=>{var A;(A=window.MotionHandoffMarkAsComplete)===null||A===void 0||A.call(window,T)}),w.current=!1))}),m}function YW(n,e,t,i){const{layoutId:r,layout:s,drag:o,dragConstraints:a,layoutScroll:c,layoutRoot:h}=e;n.projection=new t(n.latestValues,e["data-framer-portal-id"]?void 0:XN(n.parent)),n.projection.setOptions({layoutId:r,layout:s,alwaysMeasureLayout:!!o||a&&Fu(a),visualElement:n,animationType:typeof s=="string"?s:"both",initialPromotionConfig:i,layoutScroll:c,layoutRoot:h})}function XN(n){if(n)return n.options.allowProjection!==!1?n.projection:XN(n.parent)}function ZW({preloadedFeatures:n,createVisualElement:e,useRender:t,useVisualState:i,Component:r}){var s,o;n&&jW(n);function a(h,d){let g;const m={...ne.useContext(DS),...h,layoutId:QW(h)},{isStatic:v}=m,y=WW(h),T=i(h,v);if(!v&&OS){JW();const w=eK(m);g=w.MeasureLayout,y.visualElement=XW(r,T,m,e,w.ProjectionNode)}return M.jsxs(my.Provider,{value:y,children:[g&&y.visualElement?M.jsx(g,{visualElement:y.visualElement,...m}):null,t(r,h,qW(T,y.visualElement,d),T,v,y.visualElement)]})}a.displayName=`motion.${typeof r=="string"?r:`create(${(o=(s=r.displayName)!==null&&s!==void 0?s:r.name)!==null&&o!==void 0?o:""})`}`;const c=ne.forwardRef(a);return c[KW]=r,c}function QW({layoutId:n}){const e=ne.useContext(LS).id;return e&&n!==void 0?e+"-"+n:n}function JW(n,e){ne.useContext($N).strict}function eK(n){const{drag:e,layout:t}=Ch;if(!e&&!t)return{};const i={...e,...t};return{MeasureLayout:e?.isEnabled(n)||t?.isEnabled(n)?i.MeasureLayout:void 0,ProjectionNode:i.ProjectionNode}}const tK=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function zS(n){return typeof n!="string"||n.includes("-")?!1:!!(tK.indexOf(n)>-1||/[A-Z]/u.test(n))}function hC(n){const e=[{},{}];return n?.values.forEach((t,i)=>{e[0][i]=t.get(),e[1][i]=t.getVelocity()}),e}function BS(n,e,t,i){if(typeof e=="function"){const[r,s]=hC(i);e=e(t!==void 0?t:n.custom,r,s)}if(typeof e=="string"&&(e=n.variants&&n.variants[e]),typeof e=="function"){const[r,s]=hC(i);e=e(t!==void 0?t:n.custom,r,s)}return e}const _w=n=>Array.isArray(n),nK=n=>!!(n&&typeof n=="object"&&n.mix&&n.toValue),iK=n=>_w(n)?n[n.length-1]||0:n,ti=n=>!!(n&&n.getVelocity);function n0(n){const e=ti(n)?n.get():n;return nK(e)?e.toValue():e}function rK({scrapeMotionValuesFromProps:n,createRenderState:e,onUpdate:t},i,r,s){const o={latestValues:sK(i,r,s,n),renderState:e()};return t&&(o.onMount=a=>t({props:i,current:a,...o}),o.onUpdate=a=>t(a)),o}const YN=n=>(e,t)=>{const i=ne.useContext(my),r=ne.useContext(gy),s=()=>rK(n,e,i,r);return t?s():NS(s)};function sK(n,e,t,i){const r={},s=i(n,{});for(const m in s)r[m]=n0(s[m]);let{initial:o,animate:a}=n;const c=_y(n),h=KN(n);e&&h&&!c&&n.inherit!==!1&&(o===void 0&&(o=e.initial),a===void 0&&(a=e.animate));let d=t?t.initial===!1:!1;d=d||o===!1;const g=d?a:o;if(g&&typeof g!="boolean"&&!py(g)){const m=Array.isArray(g)?g:[g];for(let v=0;v<m.length;v++){const y=BS(n,m[v]);if(y){const{transitionEnd:T,transition:w,...A}=y;for(const P in A){let C=A[P];if(Array.isArray(C)){const N=d?C.length-1:0;C=C[N]}C!==null&&(r[P]=C)}for(const P in T)r[P]=T[P]}}}return r}const Gh=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Pc=new Set(Gh),ZN=n=>e=>typeof e=="string"&&e.startsWith(n),QN=ZN("--"),oK=ZN("var(--"),$S=n=>oK(n)?aK.test(n.split("/*")[0].trim()):!1,aK=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,JN=(n,e)=>e&&typeof n=="number"?e.transform(n):n,To=(n,e,t)=>t>e?e:t<n?n:t,Uh={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},cg={...Uh,transform:n=>To(0,1,n)},kp={...Uh,default:1},$g=n=>({test:e=>typeof e=="string"&&e.endsWith(n)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${n}`}),ga=$g("deg"),bs=$g("%"),Ve=$g("px"),lK=$g("vh"),cK=$g("vw"),dC={...bs,parse:n=>bs.parse(n)/100,transform:n=>bs.transform(n*100)},uK={borderWidth:Ve,borderTopWidth:Ve,borderRightWidth:Ve,borderBottomWidth:Ve,borderLeftWidth:Ve,borderRadius:Ve,radius:Ve,borderTopLeftRadius:Ve,borderTopRightRadius:Ve,borderBottomRightRadius:Ve,borderBottomLeftRadius:Ve,width:Ve,maxWidth:Ve,height:Ve,maxHeight:Ve,top:Ve,right:Ve,bottom:Ve,left:Ve,padding:Ve,paddingTop:Ve,paddingRight:Ve,paddingBottom:Ve,paddingLeft:Ve,margin:Ve,marginTop:Ve,marginRight:Ve,marginBottom:Ve,marginLeft:Ve,backgroundPositionX:Ve,backgroundPositionY:Ve},hK={rotate:ga,rotateX:ga,rotateY:ga,rotateZ:ga,scale:kp,scaleX:kp,scaleY:kp,scaleZ:kp,skew:ga,skewX:ga,skewY:ga,distance:Ve,translateX:Ve,translateY:Ve,translateZ:Ve,x:Ve,y:Ve,z:Ve,perspective:Ve,transformPerspective:Ve,opacity:cg,originX:dC,originY:dC,originZ:Ve},fC={...Uh,transform:Math.round},WS={...uK,...hK,zIndex:fC,size:Ve,fillOpacity:cg,strokeOpacity:cg,numOctaves:fC},dK={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},fK=Gh.length;function gK(n,e,t){let i="",r=!0;for(let s=0;s<fK;s++){const o=Gh[s],a=n[o];if(a===void 0)continue;let c=!0;if(typeof a=="number"?c=a===(o.startsWith("scale")?1:0):c=parseFloat(a)===0,!c||t){const h=JN(a,WS[o]);if(!c){r=!1;const d=dK[o]||o;i+=`${d}(${h}) `}t&&(e[o]=h)}}return i=i.trim(),t?i=t(e,r?"":i):r&&(i="none"),i}function KS(n,e,t){const{style:i,vars:r,transformOrigin:s}=n;let o=!1,a=!1;for(const c in e){const h=e[c];if(Pc.has(c)){o=!0;continue}else if(QN(c)){r[c]=h;continue}else{const d=JN(h,WS[c]);c.startsWith("origin")?(a=!0,s[c]=d):i[c]=d}}if(e.transform||(o||t?i.transform=gK(e,n.transform,t):i.transform&&(i.transform="none")),a){const{originX:c="50%",originY:h="50%",originZ:d=0}=s;i.transformOrigin=`${c} ${h} ${d}`}}const mK={offset:"stroke-dashoffset",array:"stroke-dasharray"},pK={offset:"strokeDashoffset",array:"strokeDasharray"};function _K(n,e,t=1,i=0,r=!0){n.pathLength=1;const s=r?mK:pK;n[s.offset]=Ve.transform(-i);const o=Ve.transform(e),a=Ve.transform(t);n[s.array]=`${o} ${a}`}function gC(n,e,t){return typeof n=="string"?n:Ve.transform(e+t*n)}function yK(n,e,t){const i=gC(e,n.x,n.width),r=gC(t,n.y,n.height);return`${i} ${r}`}function qS(n,{attrX:e,attrY:t,attrScale:i,originX:r,originY:s,pathLength:o,pathSpacing:a=1,pathOffset:c=0,...h},d,g){if(KS(n,h,g),d){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:m,style:v,dimensions:y}=n;m.transform&&(y&&(v.transform=m.transform),delete m.transform),y&&(r!==void 0||s!==void 0||v.transform)&&(v.transformOrigin=yK(y,r!==void 0?r:.5,s!==void 0?s:.5)),e!==void 0&&(m.x=e),t!==void 0&&(m.y=t),i!==void 0&&(m.scale=i),o!==void 0&&_K(m,o,a,c,!1)}const HS=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),eD=()=>({...HS(),attrs:{}}),XS=n=>typeof n=="string"&&n.toLowerCase()==="svg";function tD(n,{style:e,vars:t},i,r){Object.assign(n.style,e,r&&r.getProjectionStyles(i));for(const s in t)n.style.setProperty(s,t[s])}const nD=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function iD(n,e,t,i){tD(n,e,void 0,i);for(const r in e.attrs)n.setAttribute(nD.has(r)?r:GS(r),e.attrs[r])}const r_={};function vK(n){Object.assign(r_,n)}function rD(n,{layout:e,layoutId:t}){return Pc.has(n)||n.startsWith("origin")||(e||t!==void 0)&&(!!r_[n]||n==="opacity")}function YS(n,e,t){var i;const{style:r}=n,s={};for(const o in r)(ti(r[o])||e.style&&ti(e.style[o])||rD(o,n)||((i=t?.getValue(o))===null||i===void 0?void 0:i.liveStyle)!==void 0)&&(s[o]=r[o]);return s}function sD(n,e,t){const i=YS(n,e,t);for(const r in n)if(ti(n[r])||ti(e[r])){const s=Gh.indexOf(r)!==-1?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r;i[s]=n[r]}return i}function EK(n,e){try{e.dimensions=typeof n.getBBox=="function"?n.getBBox():n.getBoundingClientRect()}catch{e.dimensions={x:0,y:0,width:0,height:0}}}const mC=["x","y","width","height","cx","cy","r"],wK={useVisualState:YN({scrapeMotionValuesFromProps:sD,createRenderState:eD,onUpdate:({props:n,prevProps:e,current:t,renderState:i,latestValues:r})=>{if(!t)return;let s=!!n.drag;if(!s){for(const a in r)if(Pc.has(a)){s=!0;break}}if(!s)return;let o=!e;if(e)for(let a=0;a<mC.length;a++){const c=mC[a];n[c]!==e[c]&&(o=!0)}o&&Lt.read(()=>{EK(t,i),Lt.render(()=>{qS(i,r,XS(t.tagName),n.transformTemplate),iD(t,i)})})}})},xK={useVisualState:YN({scrapeMotionValuesFromProps:YS,createRenderState:HS})};function oD(n,e,t){for(const i in e)!ti(e[i])&&!rD(i,t)&&(n[i]=e[i])}function SK({transformTemplate:n},e){return ne.useMemo(()=>{const t=HS();return KS(t,e,n),Object.assign({},t.vars,t.style)},[e])}function TK(n,e){const t=n.style||{},i={};return oD(i,t,n),Object.assign(i,SK(n,e)),i}function IK(n,e){const t={},i=TK(n,e);return n.drag&&n.dragListener!==!1&&(t.draggable=!1,i.userSelect=i.WebkitUserSelect=i.WebkitTouchCallout="none",i.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(t.tabIndex=0),t.style=i,t}function AK(n,e,t,i){const r=ne.useMemo(()=>{const s=eD();return qS(s,e,XS(i),n.transformTemplate),{...s.attrs,style:{...s.style}}},[e]);if(n.style){const s={};oD(s,n.style,n),r.style={...s,...r.style}}return r}function RK(n=!1){return(t,i,r,{latestValues:s},o)=>{const c=(zS(t)?AK:IK)(i,s,o,t),h=zW(i,typeof t=="string",n),d=t!==ne.Fragment?{...h,...c,ref:r}:{},{children:g}=i,m=ne.useMemo(()=>ti(g)?g.get():g,[g]);return ne.createElement(t,{...d,children:m})}}function PK(n,e){return function(i,{forwardMotionProps:r}={forwardMotionProps:!1}){const o={...zS(i)?wK:xK,preloadedFeatures:n,useRender:RK(r),createVisualElement:e,Component:i};return ZW(o)}}function aD(n,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==n.length)return!1;for(let i=0;i<t;i++)if(e[i]!==n[i])return!1;return!0}function yy(n,e,t){const i=n.getProps();return BS(i,e,t!==void 0?t:i.custom,n)}const CK=VS(()=>window.ScrollTimeline!==void 0);class MK{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,t){for(let i=0;i<this.animations.length;i++)this.animations[i][e]=t}attachTimeline(e,t){const i=this.animations.map(r=>{if(CK()&&r.attachTimeline)return r.attachTimeline(e);if(typeof t=="function")return t(r)});return()=>{i.forEach((r,s)=>{r&&r(),this.animations[s].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let t=0;t<this.animations.length;t++)e=Math.max(e,this.animations[t].duration);return e}runAll(e){this.animations.forEach(t=>t[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class bK extends MK{then(e,t){return Promise.all(this.animations).then(e).catch(t)}}function ZS(n,e){return n?n[e]||n.default||n:void 0}const yw=2e4;function lD(n){let e=0;const t=50;let i=n.next(e);for(;!i.done&&e<yw;)e+=t,i=n.next(e);return e>=yw?1/0:e}function QS(n){return typeof n=="function"}function pC(n,e){n.timeline=e,n.onfinish=null}const JS=n=>Array.isArray(n)&&typeof n[0]=="number",kK={linearEasing:void 0};function LK(n,e){const t=VS(n);return()=>{var i;return(i=kK[e])!==null&&i!==void 0?i:t()}}const s_=LK(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),cD=(n,e,t=10)=>{let i="";const r=Math.max(Math.round(e/t),2);for(let s=0;s<r;s++)i+=n(Ph(0,r-1,s))+", ";return`linear(${i.substring(0,i.length-2)})`};function uD(n){return!!(typeof n=="function"&&s_()||!n||typeof n=="string"&&(n in vw||s_())||JS(n)||Array.isArray(n)&&n.every(uD))}const nf=([n,e,t,i])=>`cubic-bezier(${n}, ${e}, ${t}, ${i})`,vw={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:nf([0,.65,.55,1]),circOut:nf([.55,0,1,.45]),backIn:nf([.31,.01,.66,-.59]),backOut:nf([.33,1.53,.69,.99])};function hD(n,e){if(n)return typeof n=="function"&&s_()?cD(n,e):JS(n)?nf(n):Array.isArray(n)?n.map(t=>hD(t,e)||vw.easeOut):vw[n]}const jr={x:!1,y:!1};function dD(){return jr.x||jr.y}function NK(n,e,t){var i;if(n instanceof Element)return[n];if(typeof n=="string"){let r=document;const s=(i=void 0)!==null&&i!==void 0?i:r.querySelectorAll(n);return s?Array.from(s):[]}return Array.from(n)}function fD(n,e){const t=NK(n),i=new AbortController,r={passive:!0,...e,signal:i.signal};return[t,r,()=>i.abort()]}function _C(n){return e=>{e.pointerType==="touch"||dD()||n(e)}}function DK(n,e,t={}){const[i,r,s]=fD(n,t),o=_C(a=>{const{target:c}=a,h=e(a);if(typeof h!="function"||!c)return;const d=_C(g=>{h(g),c.removeEventListener("pointerleave",d)});c.addEventListener("pointerleave",d,r)});return i.forEach(a=>{a.addEventListener("pointerenter",o,r)}),s}const gD=(n,e)=>e?n===e?!0:gD(n,e.parentElement):!1,eT=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1,OK=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function VK(n){return OK.has(n.tagName)||n.tabIndex!==-1}const rf=new WeakSet;function yC(n){return e=>{e.key==="Enter"&&n(e)}}function z1(n,e){n.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const FK=(n,e)=>{const t=n.currentTarget;if(!t)return;const i=yC(()=>{if(rf.has(t))return;z1(t,"down");const r=yC(()=>{z1(t,"up")}),s=()=>z1(t,"cancel");t.addEventListener("keyup",r,e),t.addEventListener("blur",s,e)});t.addEventListener("keydown",i,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",i),e)};function vC(n){return eT(n)&&!dD()}function jK(n,e,t={}){const[i,r,s]=fD(n,t),o=a=>{const c=a.currentTarget;if(!vC(a)||rf.has(c))return;rf.add(c);const h=e(a),d=(v,y)=>{window.removeEventListener("pointerup",g),window.removeEventListener("pointercancel",m),!(!vC(v)||!rf.has(c))&&(rf.delete(c),typeof h=="function"&&h(v,{success:y}))},g=v=>{d(v,t.useGlobalTarget||gD(c,v.target))},m=v=>{d(v,!1)};window.addEventListener("pointerup",g,r),window.addEventListener("pointercancel",m,r)};return i.forEach(a=>{!VK(a)&&a.getAttribute("tabindex")===null&&(a.tabIndex=0),(t.useGlobalTarget?window:a).addEventListener("pointerdown",o,r),a.addEventListener("focus",h=>FK(h,r),r)}),s}function GK(n){return n==="x"||n==="y"?jr[n]?null:(jr[n]=!0,()=>{jr[n]=!1}):jr.x||jr.y?null:(jr.x=jr.y=!0,()=>{jr.x=jr.y=!1})}const mD=new Set(["width","height","top","left","right","bottom",...Gh]);let i0;function UK(){i0=void 0}const ks={now:()=>(i0===void 0&&ks.set(Vn.isProcessing||OW.useManualTiming?Vn.timestamp:performance.now()),i0),set:n=>{i0=n,queueMicrotask(UK)}};function tT(n,e){n.indexOf(e)===-1&&n.push(e)}function nT(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}class iT{constructor(){this.subscriptions=[]}add(e){return tT(this.subscriptions,e),()=>nT(this.subscriptions,e)}notify(e,t,i){const r=this.subscriptions.length;if(r)if(r===1)this.subscriptions[0](e,t,i);else for(let s=0;s<r;s++){const o=this.subscriptions[s];o&&o(e,t,i)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function pD(n,e){return e?n*(1e3/e):0}const EC=30,zK=n=>!isNaN(parseFloat(n));class BK{constructor(e,t={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(i,r=!0)=>{const s=ks.now();this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(i),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),r&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=ks.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=zK(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new iT);const i=this.events[e].add(t);return e==="change"?()=>{i(),Lt.read(()=>{this.events.change.getSize()||this.stop()})}:i}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e,t=!0){!t||!this.passiveEffect?this.updateAndNotify(e,t):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,t,i){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-i}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=ks.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>EC)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,EC);return pD(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function ug(n,e){return new BK(n,e)}function $K(n,e,t){n.hasValue(e)?n.getValue(e).set(t):n.addValue(e,ug(t))}function WK(n,e){const t=yy(n,e);let{transitionEnd:i={},transition:r={},...s}=t||{};s={...s,...i};for(const o in s){const a=iK(s[o]);$K(n,o,a)}}function KK(n){return!!(ti(n)&&n.add)}function Ew(n,e){const t=n.getValue("willChange");if(KK(t))return t.add(e)}function _D(n){return n.props[qN]}const yD=(n,e,t)=>(((1-3*t+3*e)*n+(3*t-6*e))*n+3*e)*n,qK=1e-7,HK=12;function XK(n,e,t,i,r){let s,o,a=0;do o=e+(t-e)/2,s=yD(o,i,r)-n,s>0?t=o:e=o;while(Math.abs(s)>qK&&++a<HK);return o}function Wg(n,e,t,i){if(n===e&&t===i)return Yi;const r=s=>XK(s,0,1,n,t);return s=>s===0||s===1?s:yD(r(s),e,i)}const vD=n=>e=>e<=.5?n(2*e)/2:(2-n(2*(1-e)))/2,ED=n=>e=>1-n(1-e),wD=Wg(.33,1.53,.69,.99),rT=ED(wD),xD=vD(rT),SD=n=>(n*=2)<1?.5*rT(n):.5*(2-Math.pow(2,-10*(n-1))),sT=n=>1-Math.sin(Math.acos(n)),TD=ED(sT),ID=vD(sT),AD=n=>/^0[^.\s]+$/u.test(n);function YK(n){return typeof n=="number"?n===0:n!==null?n==="none"||n==="0"||AD(n):!0}const wf=n=>Math.round(n*1e5)/1e5,oT=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function ZK(n){return n==null}const QK=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,aT=(n,e)=>t=>!!(typeof t=="string"&&QK.test(t)&&t.startsWith(n)||e&&!ZK(t)&&Object.prototype.hasOwnProperty.call(t,e)),RD=(n,e,t)=>i=>{if(typeof i!="string")return i;const[r,s,o,a]=i.match(oT);return{[n]:parseFloat(r),[e]:parseFloat(s),[t]:parseFloat(o),alpha:a!==void 0?parseFloat(a):1}},JK=n=>To(0,255,n),B1={...Uh,transform:n=>Math.round(JK(n))},ql={test:aT("rgb","red"),parse:RD("red","green","blue"),transform:({red:n,green:e,blue:t,alpha:i=1})=>"rgba("+B1.transform(n)+", "+B1.transform(e)+", "+B1.transform(t)+", "+wf(cg.transform(i))+")"};function eq(n){let e="",t="",i="",r="";return n.length>5?(e=n.substring(1,3),t=n.substring(3,5),i=n.substring(5,7),r=n.substring(7,9)):(e=n.substring(1,2),t=n.substring(2,3),i=n.substring(3,4),r=n.substring(4,5),e+=e,t+=t,i+=i,r+=r),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(i,16),alpha:r?parseInt(r,16)/255:1}}const ww={test:aT("#"),parse:eq,transform:ql.transform},ju={test:aT("hsl","hue"),parse:RD("hue","saturation","lightness"),transform:({hue:n,saturation:e,lightness:t,alpha:i=1})=>"hsla("+Math.round(n)+", "+bs.transform(wf(e))+", "+bs.transform(wf(t))+", "+wf(cg.transform(i))+")"},Xn={test:n=>ql.test(n)||ww.test(n)||ju.test(n),parse:n=>ql.test(n)?ql.parse(n):ju.test(n)?ju.parse(n):ww.parse(n),transform:n=>typeof n=="string"?n:n.hasOwnProperty("red")?ql.transform(n):ju.transform(n)},tq=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function nq(n){var e,t;return isNaN(n)&&typeof n=="string"&&(((e=n.match(oT))===null||e===void 0?void 0:e.length)||0)+(((t=n.match(tq))===null||t===void 0?void 0:t.length)||0)>0}const PD="number",CD="color",iq="var",rq="var(",wC="${}",sq=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function hg(n){const e=n.toString(),t=[],i={color:[],number:[],var:[]},r=[];let s=0;const a=e.replace(sq,c=>(Xn.test(c)?(i.color.push(s),r.push(CD),t.push(Xn.parse(c))):c.startsWith(rq)?(i.var.push(s),r.push(iq),t.push(c)):(i.number.push(s),r.push(PD),t.push(parseFloat(c))),++s,wC)).split(wC);return{values:t,split:a,indexes:i,types:r}}function MD(n){return hg(n).values}function bD(n){const{split:e,types:t}=hg(n),i=e.length;return r=>{let s="";for(let o=0;o<i;o++)if(s+=e[o],r[o]!==void 0){const a=t[o];a===PD?s+=wf(r[o]):a===CD?s+=Xn.transform(r[o]):s+=r[o]}return s}}const oq=n=>typeof n=="number"?0:n;function aq(n){const e=MD(n);return bD(n)(e.map(oq))}const $a={test:nq,parse:MD,createTransformer:bD,getAnimatableNone:aq},lq=new Set(["brightness","contrast","saturate","opacity"]);function cq(n){const[e,t]=n.slice(0,-1).split("(");if(e==="drop-shadow")return n;const[i]=t.match(oT)||[];if(!i)return n;const r=t.replace(i,"");let s=lq.has(e)?1:0;return i!==t&&(s*=100),e+"("+s+r+")"}const uq=/\b([a-z-]*)\(.*?\)/gu,xw={...$a,getAnimatableNone:n=>{const e=n.match(uq);return e?e.map(cq).join(" "):n}},hq={...WS,color:Xn,backgroundColor:Xn,outlineColor:Xn,fill:Xn,stroke:Xn,borderColor:Xn,borderTopColor:Xn,borderRightColor:Xn,borderBottomColor:Xn,borderLeftColor:Xn,filter:xw,WebkitFilter:xw},lT=n=>hq[n];function kD(n,e){let t=lT(n);return t!==xw&&(t=$a),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const dq=new Set(["auto","none","0"]);function fq(n,e,t){let i=0,r;for(;i<n.length&&!r;){const s=n[i];typeof s=="string"&&!dq.has(s)&&hg(s).values.length&&(r=n[i]),i++}if(r&&t)for(const s of e)n[s]=kD(t,r)}const xC=n=>n===Uh||n===Ve,SC=(n,e)=>parseFloat(n.split(", ")[e]),TC=(n,e)=>(t,{transform:i})=>{if(i==="none"||!i)return 0;const r=i.match(/^matrix3d\((.+)\)$/u);if(r)return SC(r[1],e);{const s=i.match(/^matrix\((.+)\)$/u);return s?SC(s[1],n):0}},gq=new Set(["x","y","z"]),mq=Gh.filter(n=>!gq.has(n));function pq(n){const e=[];return mq.forEach(t=>{const i=n.getValue(t);i!==void 0&&(e.push([t,i.get()]),i.set(t.startsWith("scale")?1:0))}),e}const Mh={width:({x:n},{paddingLeft:e="0",paddingRight:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),height:({y:n},{paddingTop:e="0",paddingBottom:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),top:(n,{top:e})=>parseFloat(e),left:(n,{left:e})=>parseFloat(e),bottom:({y:n},{top:e})=>parseFloat(e)+(n.max-n.min),right:({x:n},{left:e})=>parseFloat(e)+(n.max-n.min),x:TC(4,13),y:TC(5,14)};Mh.translateX=Mh.x;Mh.translateY=Mh.y;const ec=new Set;let Sw=!1,Tw=!1;function LD(){if(Tw){const n=Array.from(ec).filter(i=>i.needsMeasurement),e=new Set(n.map(i=>i.element)),t=new Map;e.forEach(i=>{const r=pq(i);r.length&&(t.set(i,r),i.render())}),n.forEach(i=>i.measureInitialState()),e.forEach(i=>{i.render();const r=t.get(i);r&&r.forEach(([s,o])=>{var a;(a=i.getValue(s))===null||a===void 0||a.set(o)})}),n.forEach(i=>i.measureEndState()),n.forEach(i=>{i.suspendedScrollY!==void 0&&window.scrollTo(0,i.suspendedScrollY)})}Tw=!1,Sw=!1,ec.forEach(n=>n.complete()),ec.clear()}function ND(){ec.forEach(n=>{n.readKeyframes(),n.needsMeasurement&&(Tw=!0)})}function _q(){ND(),LD()}class cT{constructor(e,t,i,r,s,o=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=i,this.motionValue=r,this.element=s,this.isAsync=o}scheduleResolve(){this.isScheduled=!0,this.isAsync?(ec.add(this),Sw||(Sw=!0,Lt.read(ND),Lt.resolveKeyframes(LD))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:i,motionValue:r}=this;for(let s=0;s<e.length;s++)if(e[s]===null)if(s===0){const o=r?.get(),a=e[e.length-1];if(o!==void 0)e[0]=o;else if(i&&t){const c=i.readValue(t,a);c!=null&&(e[0]=c)}e[0]===void 0&&(e[0]=a),r&&o===void 0&&r.set(e[0])}else e[s]=e[s-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),ec.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,ec.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const DD=n=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(n),yq=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function vq(n){const e=yq.exec(n);if(!e)return[,];const[,t,i,r]=e;return[`--${t??i}`,r]}function OD(n,e,t=1){const[i,r]=vq(n);if(!i)return;const s=window.getComputedStyle(e).getPropertyValue(i);if(s){const o=s.trim();return DD(o)?parseFloat(o):o}return $S(r)?OD(r,e,t+1):r}const VD=n=>e=>e.test(n),Eq={test:n=>n==="auto",parse:n=>n},FD=[Uh,Ve,bs,ga,cK,lK,Eq],IC=n=>FD.find(VD(n));class jD extends cT{constructor(e,t,i,r,s){super(e,t,i,r,s,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:i}=this;if(!t||!t.current)return;super.readKeyframes();for(let c=0;c<e.length;c++){let h=e[c];if(typeof h=="string"&&(h=h.trim(),$S(h))){const d=OD(h,t.current);d!==void 0&&(e[c]=d),c===e.length-1&&(this.finalKeyframe=h)}}if(this.resolveNoneKeyframes(),!mD.has(i)||e.length!==2)return;const[r,s]=e,o=IC(r),a=IC(s);if(o!==a)if(xC(o)&&xC(a))for(let c=0;c<e.length;c++){const h=e[c];typeof h=="string"&&(e[c]=parseFloat(h))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,i=[];for(let r=0;r<e.length;r++)YK(e[r])&&i.push(r);i.length&&fq(e,i,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:i}=this;if(!e||!e.current)return;i==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Mh[i](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const r=t[t.length-1];r!==void 0&&e.getValue(i,r).jump(r,!1)}measureEndState(){var e;const{element:t,name:i,unresolvedKeyframes:r}=this;if(!t||!t.current)return;const s=t.getValue(i);s&&s.jump(this.measuredOrigin,!1);const o=r.length-1,a=r[o];r[o]=Mh[i](t.measureViewportBox(),window.getComputedStyle(t.current)),a!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=a),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([c,h])=>{t.getValue(c).set(h)}),this.resolveNoneKeyframes()}}const AC=(n,e)=>e==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&($a.test(n)||n==="0")&&!n.startsWith("url("));function wq(n){const e=n[0];if(n.length===1)return!0;for(let t=0;t<n.length;t++)if(n[t]!==e)return!0}function xq(n,e,t,i){const r=n[0];if(r===null)return!1;if(e==="display"||e==="visibility")return!0;const s=n[n.length-1],o=AC(r,e),a=AC(s,e);return!o||!a?!1:wq(n)||(t==="spring"||QS(t))&&i}const Sq=n=>n!==null;function vy(n,{repeat:e,repeatType:t="loop"},i){const r=n.filter(Sq),s=e&&t!=="loop"&&e%2===1?0:r.length-1;return!s||i===void 0?r[s]:i}const Tq=40;class GD{constructor({autoplay:e=!0,delay:t=0,type:i="keyframes",repeat:r=0,repeatDelay:s=0,repeatType:o="loop",...a}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=ks.now(),this.options={autoplay:e,delay:t,type:i,repeat:r,repeatDelay:s,repeatType:o,...a},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>Tq?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&_q(),this._resolved}onKeyframesResolved(e,t){this.resolvedAt=ks.now(),this.hasAttemptedResolve=!0;const{name:i,type:r,velocity:s,delay:o,onComplete:a,onUpdate:c,isGenerator:h}=this.options;if(!h&&!xq(e,i,r,s))if(o)this.options.duration=0;else{c&&c(vy(e,this.options,t)),a&&a(),this.resolveFinishedPromise();return}const d=this.initPlayback(e,t);d!==!1&&(this._resolved={keyframes:e,finalKeyframe:t,...d},this.onPostResolved())}onPostResolved(){}then(e,t){return this.currentFinishedPromise.then(e,t)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const $t=(n,e,t)=>n+(e-n)*t;function $1(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function Iq({hue:n,saturation:e,lightness:t,alpha:i}){n/=360,e/=100,t/=100;let r=0,s=0,o=0;if(!e)r=s=o=t;else{const a=t<.5?t*(1+e):t+e-t*e,c=2*t-a;r=$1(c,a,n+1/3),s=$1(c,a,n),o=$1(c,a,n-1/3)}return{red:Math.round(r*255),green:Math.round(s*255),blue:Math.round(o*255),alpha:i}}function o_(n,e){return t=>t>0?e:n}const W1=(n,e,t)=>{const i=n*n,r=t*(e*e-i)+i;return r<0?0:Math.sqrt(r)},Aq=[ww,ql,ju],Rq=n=>Aq.find(e=>e.test(n));function RC(n){const e=Rq(n);if(!e)return!1;let t=e.parse(n);return e===ju&&(t=Iq(t)),t}const PC=(n,e)=>{const t=RC(n),i=RC(e);if(!t||!i)return o_(n,e);const r={...t};return s=>(r.red=W1(t.red,i.red,s),r.green=W1(t.green,i.green,s),r.blue=W1(t.blue,i.blue,s),r.alpha=$t(t.alpha,i.alpha,s),ql.transform(r))},Pq=(n,e)=>t=>e(n(t)),Kg=(...n)=>n.reduce(Pq),Iw=new Set(["none","hidden"]);function Cq(n,e){return Iw.has(n)?t=>t<=0?n:e:t=>t>=1?e:n}function Mq(n,e){return t=>$t(n,e,t)}function uT(n){return typeof n=="number"?Mq:typeof n=="string"?$S(n)?o_:Xn.test(n)?PC:Lq:Array.isArray(n)?UD:typeof n=="object"?Xn.test(n)?PC:bq:o_}function UD(n,e){const t=[...n],i=t.length,r=n.map((s,o)=>uT(s)(s,e[o]));return s=>{for(let o=0;o<i;o++)t[o]=r[o](s);return t}}function bq(n,e){const t={...n,...e},i={};for(const r in t)n[r]!==void 0&&e[r]!==void 0&&(i[r]=uT(n[r])(n[r],e[r]));return r=>{for(const s in i)t[s]=i[s](r);return t}}function kq(n,e){var t;const i=[],r={color:0,var:0,number:0};for(let s=0;s<e.values.length;s++){const o=e.types[s],a=n.indexes[o][r[o]],c=(t=n.values[a])!==null&&t!==void 0?t:0;i[s]=c,r[o]++}return i}const Lq=(n,e)=>{const t=$a.createTransformer(e),i=hg(n),r=hg(e);return i.indexes.var.length===r.indexes.var.length&&i.indexes.color.length===r.indexes.color.length&&i.indexes.number.length>=r.indexes.number.length?Iw.has(n)&&!r.values.length||Iw.has(e)&&!i.values.length?Cq(n,e):Kg(UD(kq(i,r),r.values),t):o_(n,e)};function zD(n,e,t){return typeof n=="number"&&typeof e=="number"&&typeof t=="number"?$t(n,e,t):uT(n)(n,e)}const Nq=5;function BD(n,e,t){const i=Math.max(e-Nq,0);return pD(t-n(i),e-i)}const Ht={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},K1=.001;function Dq({duration:n=Ht.duration,bounce:e=Ht.bounce,velocity:t=Ht.velocity,mass:i=Ht.mass}){let r,s,o=1-e;o=To(Ht.minDamping,Ht.maxDamping,o),n=To(Ht.minDuration,Ht.maxDuration,_o(n)),o<1?(r=h=>{const d=h*o,g=d*n,m=d-t,v=Aw(h,o),y=Math.exp(-g);return K1-m/v*y},s=h=>{const g=h*o*n,m=g*t+t,v=Math.pow(o,2)*Math.pow(h,2)*n,y=Math.exp(-g),T=Aw(Math.pow(h,2),o);return(-r(h)+K1>0?-1:1)*((m-v)*y)/T}):(r=h=>{const d=Math.exp(-h*n),g=(h-t)*n+1;return-K1+d*g},s=h=>{const d=Math.exp(-h*n),g=(t-h)*(n*n);return d*g});const a=5/n,c=Vq(r,s,a);if(n=po(n),isNaN(c))return{stiffness:Ht.stiffness,damping:Ht.damping,duration:n};{const h=Math.pow(c,2)*i;return{stiffness:h,damping:o*2*Math.sqrt(i*h),duration:n}}}const Oq=12;function Vq(n,e,t){let i=t;for(let r=1;r<Oq;r++)i=i-n(i)/e(i);return i}function Aw(n,e){return n*Math.sqrt(1-e*e)}const Fq=["duration","bounce"],jq=["stiffness","damping","mass"];function CC(n,e){return e.some(t=>n[t]!==void 0)}function Gq(n){let e={velocity:Ht.velocity,stiffness:Ht.stiffness,damping:Ht.damping,mass:Ht.mass,isResolvedFromDuration:!1,...n};if(!CC(n,jq)&&CC(n,Fq))if(n.visualDuration){const t=n.visualDuration,i=2*Math.PI/(t*1.2),r=i*i,s=2*To(.05,1,1-(n.bounce||0))*Math.sqrt(r);e={...e,mass:Ht.mass,stiffness:r,damping:s}}else{const t=Dq(n);e={...e,...t,mass:Ht.mass},e.isResolvedFromDuration=!0}return e}function $D(n=Ht.visualDuration,e=Ht.bounce){const t=typeof n!="object"?{visualDuration:n,keyframes:[0,1],bounce:e}:n;let{restSpeed:i,restDelta:r}=t;const s=t.keyframes[0],o=t.keyframes[t.keyframes.length-1],a={done:!1,value:s},{stiffness:c,damping:h,mass:d,duration:g,velocity:m,isResolvedFromDuration:v}=Gq({...t,velocity:-_o(t.velocity||0)}),y=m||0,T=h/(2*Math.sqrt(c*d)),w=o-s,A=_o(Math.sqrt(c/d)),P=Math.abs(w)<5;i||(i=P?Ht.restSpeed.granular:Ht.restSpeed.default),r||(r=P?Ht.restDelta.granular:Ht.restDelta.default);let C;if(T<1){const D=Aw(A,T);C=z=>{const k=Math.exp(-T*A*z);return o-k*((y+T*A*w)/D*Math.sin(D*z)+w*Math.cos(D*z))}}else if(T===1)C=D=>o-Math.exp(-A*D)*(w+(y+A*w)*D);else{const D=A*Math.sqrt(T*T-1);C=z=>{const k=Math.exp(-T*A*z),R=Math.min(D*z,300);return o-k*((y+T*A*w)*Math.sinh(R)+D*w*Math.cosh(R))/D}}const N={calculatedDuration:v&&g||null,next:D=>{const z=C(D);if(v)a.done=D>=g;else{let k=0;T<1&&(k=D===0?po(y):BD(C,D,z));const R=Math.abs(k)<=i,L=Math.abs(o-z)<=r;a.done=R&&L}return a.value=a.done?o:z,a},toString:()=>{const D=Math.min(lD(N),yw),z=cD(k=>N.next(D*k).value,D,30);return D+"ms "+z}};return N}function MC({keyframes:n,velocity:e=0,power:t=.8,timeConstant:i=325,bounceDamping:r=10,bounceStiffness:s=500,modifyTarget:o,min:a,max:c,restDelta:h=.5,restSpeed:d}){const g=n[0],m={done:!1,value:g},v=R=>a!==void 0&&R<a||c!==void 0&&R>c,y=R=>a===void 0?c:c===void 0||Math.abs(a-R)<Math.abs(c-R)?a:c;let T=t*e;const w=g+T,A=o===void 0?w:o(w);A!==w&&(T=A-g);const P=R=>-T*Math.exp(-R/i),C=R=>A+P(R),N=R=>{const L=P(R),F=C(R);m.done=Math.abs(L)<=h,m.value=m.done?A:F};let D,z;const k=R=>{v(m.value)&&(D=R,z=$D({keyframes:[m.value,y(m.value)],velocity:BD(C,R,m.value),damping:r,stiffness:s,restDelta:h,restSpeed:d}))};return k(0),{calculatedDuration:null,next:R=>{let L=!1;return!z&&D===void 0&&(L=!0,N(R),k(R)),D!==void 0&&R>=D?z.next(R-D):(!L&&N(R),m)}}}const Uq=Wg(.42,0,1,1),zq=Wg(0,0,.58,1),WD=Wg(.42,0,.58,1),Bq=n=>Array.isArray(n)&&typeof n[0]!="number",$q={linear:Yi,easeIn:Uq,easeInOut:WD,easeOut:zq,circIn:sT,circInOut:ID,circOut:TD,backIn:rT,backInOut:xD,backOut:wD,anticipate:SD},bC=n=>{if(JS(n)){zN(n.length===4);const[e,t,i,r]=n;return Wg(e,t,i,r)}else if(typeof n=="string")return $q[n];return n};function Wq(n,e,t){const i=[],r=t||zD,s=n.length-1;for(let o=0;o<s;o++){let a=r(n[o],n[o+1]);if(e){const c=Array.isArray(e)?e[o]||Yi:e;a=Kg(c,a)}i.push(a)}return i}function Kq(n,e,{clamp:t=!0,ease:i,mixer:r}={}){const s=n.length;if(zN(s===e.length),s===1)return()=>e[0];if(s===2&&e[0]===e[1])return()=>e[1];const o=n[0]===n[1];n[0]>n[s-1]&&(n=[...n].reverse(),e=[...e].reverse());const a=Wq(e,i,r),c=a.length,h=d=>{if(o&&d<n[0])return e[0];let g=0;if(c>1)for(;g<n.length-2&&!(d<n[g+1]);g++);const m=Ph(n[g],n[g+1],d);return a[g](m)};return t?d=>h(To(n[0],n[s-1],d)):h}function qq(n,e){const t=n[n.length-1];for(let i=1;i<=e;i++){const r=Ph(0,e,i);n.push($t(t,1,r))}}function Hq(n){const e=[0];return qq(e,n.length-1),e}function Xq(n,e){return n.map(t=>t*e)}function Yq(n,e){return n.map(()=>e||WD).splice(0,n.length-1)}function a_({duration:n=300,keyframes:e,times:t,ease:i="easeInOut"}){const r=Bq(i)?i.map(bC):bC(i),s={done:!1,value:e[0]},o=Xq(t&&t.length===e.length?t:Hq(e),n),a=Kq(o,e,{ease:Array.isArray(r)?r:Yq(e,r)});return{calculatedDuration:n,next:c=>(s.value=a(c),s.done=c>=n,s)}}const Zq=n=>{const e=({timestamp:t})=>n(t);return{start:()=>Lt.update(e,!0),stop:()=>Ba(e),now:()=>Vn.isProcessing?Vn.timestamp:ks.now()}},Qq={decay:MC,inertia:MC,tween:a_,keyframes:a_,spring:$D},Jq=n=>n/100;class hT extends GD{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:c}=this.options;c&&c()};const{name:t,motionValue:i,element:r,keyframes:s}=this.options,o=r?.KeyframeResolver||cT,a=(c,h)=>this.onKeyframesResolved(c,h);this.resolver=new o(s,a,t,i,r),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:t="keyframes",repeat:i=0,repeatDelay:r=0,repeatType:s,velocity:o=0}=this.options,a=QS(t)?t:Qq[t]||a_;let c,h;a!==a_&&typeof e[0]!="number"&&(c=Kg(Jq,zD(e[0],e[1])),e=[0,100]);const d=a({...this.options,keyframes:e});s==="mirror"&&(h=a({...this.options,keyframes:[...e].reverse(),velocity:-o})),d.calculatedDuration===null&&(d.calculatedDuration=lD(d));const{calculatedDuration:g}=d,m=g+r,v=m*(i+1)-r;return{generator:d,mirroredGenerator:h,mapPercentToKeyframes:c,calculatedDuration:g,resolvedDuration:m,totalDuration:v}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,t=!1){const{resolved:i}=this;if(!i){const{keyframes:R}=this.options;return{done:!0,value:R[R.length-1]}}const{finalKeyframe:r,generator:s,mirroredGenerator:o,mapPercentToKeyframes:a,keyframes:c,calculatedDuration:h,totalDuration:d,resolvedDuration:g}=i;if(this.startTime===null)return s.next(0);const{delay:m,repeat:v,repeatType:y,repeatDelay:T,onUpdate:w}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-d/this.speed,this.startTime)),t?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const A=this.currentTime-m*(this.speed>=0?1:-1),P=this.speed>=0?A<0:A>d;this.currentTime=Math.max(A,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=d);let C=this.currentTime,N=s;if(v){const R=Math.min(this.currentTime,d)/g;let L=Math.floor(R),F=R%1;!F&&R>=1&&(F=1),F===1&&L--,L=Math.min(L,v+1),L%2&&(y==="reverse"?(F=1-F,T&&(F-=T/g)):y==="mirror"&&(N=o)),C=To(0,1,F)*g}const D=P?{done:!1,value:c[0]}:N.next(C);a&&(D.value=a(D.value));let{done:z}=D;!P&&h!==null&&(z=this.speed>=0?this.currentTime>=d:this.currentTime<=0);const k=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&z);return k&&r!==void 0&&(D.value=vy(c,this.options,r)),w&&w(D.value),k&&this.finish(),D}get duration(){const{resolved:e}=this;return e?_o(e.calculatedDuration):0}get time(){return _o(this.currentTime)}set time(e){e=po(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=_o(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=Zq,onPlay:t,startTime:i}=this.options;this.driver||(this.driver=e(s=>this.tick(s))),t&&t();const r=this.driver.now();this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=r):this.startTime=i??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const eH=new Set(["opacity","clipPath","filter","transform"]);function tH(n,e,t,{delay:i=0,duration:r=300,repeat:s=0,repeatType:o="loop",ease:a="easeInOut",times:c}={}){const h={[e]:t};c&&(h.offset=c);const d=hD(a,r);return Array.isArray(d)&&(h.easing=d),n.animate(h,{delay:i,duration:r,easing:Array.isArray(d)?"linear":d,fill:"both",iterations:s+1,direction:o==="reverse"?"alternate":"normal"})}const nH=VS(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),l_=10,iH=2e4;function rH(n){return QS(n.type)||n.type==="spring"||!uD(n.ease)}function sH(n,e){const t=new hT({...e,keyframes:n,repeat:0,delay:0,isGenerator:!0});let i={done:!1,value:n[0]};const r=[];let s=0;for(;!i.done&&s<iH;)i=t.sample(s),r.push(i.value),s+=l_;return{times:void 0,keyframes:r,duration:s-l_,ease:"linear"}}const KD={anticipate:SD,backInOut:xD,circInOut:ID};function oH(n){return n in KD}class kC extends GD{constructor(e){super(e);const{name:t,motionValue:i,element:r,keyframes:s}=this.options;this.resolver=new jD(s,(o,a)=>this.onKeyframesResolved(o,a),t,i,r),this.resolver.scheduleResolve()}initPlayback(e,t){let{duration:i=300,times:r,ease:s,type:o,motionValue:a,name:c,startTime:h}=this.options;if(!a.owner||!a.owner.current)return!1;if(typeof s=="string"&&s_()&&oH(s)&&(s=KD[s]),rH(this.options)){const{onComplete:g,onUpdate:m,motionValue:v,element:y,...T}=this.options,w=sH(e,T);e=w.keyframes,e.length===1&&(e[1]=e[0]),i=w.duration,r=w.times,s=w.ease,o="keyframes"}const d=tH(a.owner.current,c,e,{...this.options,duration:i,times:r,ease:s});return d.startTime=h??this.calcStartTime(),this.pendingTimeline?(pC(d,this.pendingTimeline),this.pendingTimeline=void 0):d.onfinish=()=>{const{onComplete:g}=this.options;a.set(vy(e,this.options,t)),g&&g(),this.cancel(),this.resolveFinishedPromise()},{animation:d,duration:i,times:r,type:o,ease:s,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:t}=e;return _o(t)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:t}=e;return _o(t.currentTime||0)}set time(e){const{resolved:t}=this;if(!t)return;const{animation:i}=t;i.currentTime=po(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:t}=e;return t.playbackRate}set speed(e){const{resolved:t}=this;if(!t)return;const{animation:i}=t;i.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:t}=e;return t.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:t}=e;return t.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:t}=this;if(!t)return Yi;const{animation:i}=t;pC(i,e)}return Yi}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.playState==="finished"&&this.updateFinishedPromise(),t.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:t,keyframes:i,duration:r,type:s,ease:o,times:a}=e;if(t.playState==="idle"||t.playState==="finished")return;if(this.time){const{motionValue:h,onUpdate:d,onComplete:g,element:m,...v}=this.options,y=new hT({...v,keyframes:i,duration:r,type:s,ease:o,times:a,isGenerator:!0}),T=po(this.time);h.setWithVelocity(y.sample(T-l_).value,y.sample(T).value,l_)}const{onStop:c}=this.options;c&&c(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:t,name:i,repeatDelay:r,repeatType:s,damping:o,type:a}=e;if(!t||!t.owner||!(t.owner.current instanceof HTMLElement))return!1;const{onUpdate:c,transformTemplate:h}=t.owner.getProps();return nH()&&i&&eH.has(i)&&!c&&!h&&!r&&s!=="mirror"&&o!==0&&a!=="inertia"}}const aH={type:"spring",stiffness:500,damping:25,restSpeed:10},lH=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),cH={type:"keyframes",duration:.8},uH={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},hH=(n,{keyframes:e})=>e.length>2?cH:Pc.has(n)?n.startsWith("scale")?lH(e[1]):aH:uH;function dH({when:n,delay:e,delayChildren:t,staggerChildren:i,staggerDirection:r,repeat:s,repeatType:o,repeatDelay:a,from:c,elapsed:h,...d}){return!!Object.keys(d).length}const dT=(n,e,t,i={},r,s)=>o=>{const a=ZS(i,n)||{},c=a.delay||i.delay||0;let{elapsed:h=0}=i;h=h-po(c);let d={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...a,delay:-h,onUpdate:m=>{e.set(m),a.onUpdate&&a.onUpdate(m)},onComplete:()=>{o(),a.onComplete&&a.onComplete()},name:n,motionValue:e,element:s?void 0:r};dH(a)||(d={...d,...hH(n,d)}),d.duration&&(d.duration=po(d.duration)),d.repeatDelay&&(d.repeatDelay=po(d.repeatDelay)),d.from!==void 0&&(d.keyframes[0]=d.from);let g=!1;if((d.type===!1||d.duration===0&&!d.repeatDelay)&&(d.duration=0,d.delay===0&&(g=!0)),g&&!s&&e.get()!==void 0){const m=vy(d.keyframes,a);if(m!==void 0)return Lt.update(()=>{d.onUpdate(m),d.onComplete()}),new bK([])}return!s&&kC.supports(d)?new kC(d):new hT(d)};function fH({protectedKeys:n,needsAnimating:e},t){const i=n.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,i}function qD(n,e,{delay:t=0,transitionOverride:i,type:r}={}){var s;let{transition:o=n.getDefaultTransition(),transitionEnd:a,...c}=e;i&&(o=i);const h=[],d=r&&n.animationState&&n.animationState.getState()[r];for(const g in c){const m=n.getValue(g,(s=n.latestValues[g])!==null&&s!==void 0?s:null),v=c[g];if(v===void 0||d&&fH(d,g))continue;const y={delay:t,...ZS(o||{},g)};let T=!1;if(window.MotionHandoffAnimation){const A=_D(n);if(A){const P=window.MotionHandoffAnimation(A,g,Lt);P!==null&&(y.startTime=P,T=!0)}}Ew(n,g),m.start(dT(g,m,v,n.shouldReduceMotion&&mD.has(g)?{type:!1}:y,n,T));const w=m.animation;w&&h.push(w)}return a&&Promise.all(h).then(()=>{Lt.update(()=>{a&&WK(n,a)})}),h}function Rw(n,e,t={}){var i;const r=yy(n,e,t.type==="exit"?(i=n.presenceContext)===null||i===void 0?void 0:i.custom:void 0);let{transition:s=n.getDefaultTransition()||{}}=r||{};t.transitionOverride&&(s=t.transitionOverride);const o=r?()=>Promise.all(qD(n,r,t)):()=>Promise.resolve(),a=n.variantChildren&&n.variantChildren.size?(h=0)=>{const{delayChildren:d=0,staggerChildren:g,staggerDirection:m}=s;return gH(n,e,d+h,g,m,t)}:()=>Promise.resolve(),{when:c}=s;if(c){const[h,d]=c==="beforeChildren"?[o,a]:[a,o];return h().then(()=>d())}else return Promise.all([o(),a(t.delay)])}function gH(n,e,t=0,i=0,r=1,s){const o=[],a=(n.variantChildren.size-1)*i,c=r===1?(h=0)=>h*i:(h=0)=>a-h*i;return Array.from(n.variantChildren).sort(mH).forEach((h,d)=>{h.notify("AnimationStart",e),o.push(Rw(h,e,{...s,delay:t+c(d)}).then(()=>h.notify("AnimationComplete",e)))}),Promise.all(o)}function mH(n,e){return n.sortNodePosition(e)}function pH(n,e,t={}){n.notify("AnimationStart",e);let i;if(Array.isArray(e)){const r=e.map(s=>Rw(n,s,t));i=Promise.all(r)}else if(typeof e=="string")i=Rw(n,e,t);else{const r=typeof e=="function"?yy(n,e,t.custom):e;i=Promise.all(qD(n,r,t))}return i.then(()=>{n.notify("AnimationComplete",e)})}const _H=jS.length;function HD(n){if(!n)return;if(!n.isControllingVariants){const t=n.parent?HD(n.parent)||{}:{};return n.props.initial!==void 0&&(t.initial=n.props.initial),t}const e={};for(let t=0;t<_H;t++){const i=jS[t],r=n.props[i];(lg(r)||r===!1)&&(e[i]=r)}return e}const yH=[...FS].reverse(),vH=FS.length;function EH(n){return e=>Promise.all(e.map(({animation:t,options:i})=>pH(n,t,i)))}function wH(n){let e=EH(n),t=LC(),i=!0;const r=c=>(h,d)=>{var g;const m=yy(n,d,c==="exit"?(g=n.presenceContext)===null||g===void 0?void 0:g.custom:void 0);if(m){const{transition:v,transitionEnd:y,...T}=m;h={...h,...T,...y}}return h};function s(c){e=c(n)}function o(c){const{props:h}=n,d=HD(n.parent)||{},g=[],m=new Set;let v={},y=1/0;for(let w=0;w<vH;w++){const A=yH[w],P=t[A],C=h[A]!==void 0?h[A]:d[A],N=lg(C),D=A===c?P.isActive:null;D===!1&&(y=w);let z=C===d[A]&&C!==h[A]&&N;if(z&&i&&n.manuallyAnimateOnMount&&(z=!1),P.protectedKeys={...v},!P.isActive&&D===null||!C&&!P.prevProp||py(C)||typeof C=="boolean")continue;const k=xH(P.prevProp,C);let R=k||A===c&&P.isActive&&!z&&N||w>y&&N,L=!1;const F=Array.isArray(C)?C:[C];let j=F.reduce(r(A),{});D===!1&&(j={});const{prevResolvedValues:U={}}=P,O={...U,...j},ce=de=>{R=!0,m.has(de)&&(L=!0,m.delete(de)),P.needsAnimating[de]=!0;const J=n.getValue(de);J&&(J.liveStyle=!1)};for(const de in O){const J=j[de],ae=U[de];if(v.hasOwnProperty(de))continue;let ie=!1;_w(J)&&_w(ae)?ie=!aD(J,ae):ie=J!==ae,ie?J!=null?ce(de):m.add(de):J!==void 0&&m.has(de)?ce(de):P.protectedKeys[de]=!0}P.prevProp=C,P.prevResolvedValues=j,P.isActive&&(v={...v,...j}),i&&n.blockInitialAnimation&&(R=!1),R&&(!(z&&k)||L)&&g.push(...F.map(de=>({animation:de,options:{type:A}})))}if(m.size){const w={};m.forEach(A=>{const P=n.getBaseTarget(A),C=n.getValue(A);C&&(C.liveStyle=!0),w[A]=P??null}),g.push({animation:w})}let T=!!g.length;return i&&(h.initial===!1||h.initial===h.animate)&&!n.manuallyAnimateOnMount&&(T=!1),i=!1,T?e(g):Promise.resolve()}function a(c,h){var d;if(t[c].isActive===h)return Promise.resolve();(d=n.variantChildren)===null||d===void 0||d.forEach(m=>{var v;return(v=m.animationState)===null||v===void 0?void 0:v.setActive(c,h)}),t[c].isActive=h;const g=o(c);for(const m in t)t[m].protectedKeys={};return g}return{animateChanges:o,setActive:a,setAnimateFunction:s,getState:()=>t,reset:()=>{t=LC(),i=!0}}}function xH(n,e){return typeof e=="string"?e!==n:Array.isArray(e)?!aD(e,n):!1}function Rl(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function LC(){return{animate:Rl(!0),whileInView:Rl(),whileHover:Rl(),whileTap:Rl(),whileDrag:Rl(),whileFocus:Rl(),exit:Rl()}}class Za{constructor(e){this.isMounted=!1,this.node=e}update(){}}class SH extends Za{constructor(e){super(e),e.animationState||(e.animationState=wH(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();py(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let TH=0;class IH extends Za{constructor(){super(...arguments),this.id=TH++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:i}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===i)return;const r=this.node.animationState.setActive("exit",!e);t&&!e&&r.then(()=>t(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const AH={animation:{Feature:SH},exit:{Feature:IH}};function dg(n,e,t,i={passive:!0}){return n.addEventListener(e,t,i),()=>n.removeEventListener(e,t)}function qg(n){return{point:{x:n.pageX,y:n.pageY}}}const RH=n=>e=>eT(e)&&n(e,qg(e));function xf(n,e,t,i){return dg(n,e,RH(t),i)}const NC=(n,e)=>Math.abs(n-e);function PH(n,e){const t=NC(n.x,e.x),i=NC(n.y,e.y);return Math.sqrt(t**2+i**2)}class XD{constructor(e,t,{transformPagePoint:i,contextWindow:r,dragSnapToOrigin:s=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const g=H1(this.lastMoveEventInfo,this.history),m=this.startEvent!==null,v=PH(g.offset,{x:0,y:0})>=3;if(!m&&!v)return;const{point:y}=g,{timestamp:T}=Vn;this.history.push({...y,timestamp:T});const{onStart:w,onMove:A}=this.handlers;m||(w&&w(this.lastMoveEvent,g),this.startEvent=this.lastMoveEvent),A&&A(this.lastMoveEvent,g)},this.handlePointerMove=(g,m)=>{this.lastMoveEvent=g,this.lastMoveEventInfo=q1(m,this.transformPagePoint),Lt.update(this.updatePoint,!0)},this.handlePointerUp=(g,m)=>{this.end();const{onEnd:v,onSessionEnd:y,resumeAnimation:T}=this.handlers;if(this.dragSnapToOrigin&&T&&T(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const w=H1(g.type==="pointercancel"?this.lastMoveEventInfo:q1(m,this.transformPagePoint),this.history);this.startEvent&&v&&v(g,w),y&&y(g,w)},!eT(e))return;this.dragSnapToOrigin=s,this.handlers=t,this.transformPagePoint=i,this.contextWindow=r||window;const o=qg(e),a=q1(o,this.transformPagePoint),{point:c}=a,{timestamp:h}=Vn;this.history=[{...c,timestamp:h}];const{onSessionStart:d}=t;d&&d(e,H1(a,this.history)),this.removeListeners=Kg(xf(this.contextWindow,"pointermove",this.handlePointerMove),xf(this.contextWindow,"pointerup",this.handlePointerUp),xf(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Ba(this.updatePoint)}}function q1(n,e){return e?{point:e(n.point)}:n}function DC(n,e){return{x:n.x-e.x,y:n.y-e.y}}function H1({point:n},e){return{point:n,delta:DC(n,YD(e)),offset:DC(n,CH(e)),velocity:MH(e,.1)}}function CH(n){return n[0]}function YD(n){return n[n.length-1]}function MH(n,e){if(n.length<2)return{x:0,y:0};let t=n.length-1,i=null;const r=YD(n);for(;t>=0&&(i=n[t],!(r.timestamp-i.timestamp>po(e)));)t--;if(!i)return{x:0,y:0};const s=_o(r.timestamp-i.timestamp);if(s===0)return{x:0,y:0};const o={x:(r.x-i.x)/s,y:(r.y-i.y)/s};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}const ZD=1e-4,bH=1-ZD,kH=1+ZD,QD=.01,LH=0-QD,NH=0+QD;function er(n){return n.max-n.min}function DH(n,e,t){return Math.abs(n-e)<=t}function OC(n,e,t,i=.5){n.origin=i,n.originPoint=$t(e.min,e.max,n.origin),n.scale=er(t)/er(e),n.translate=$t(t.min,t.max,n.origin)-n.originPoint,(n.scale>=bH&&n.scale<=kH||isNaN(n.scale))&&(n.scale=1),(n.translate>=LH&&n.translate<=NH||isNaN(n.translate))&&(n.translate=0)}function Sf(n,e,t,i){OC(n.x,e.x,t.x,i?i.originX:void 0),OC(n.y,e.y,t.y,i?i.originY:void 0)}function VC(n,e,t){n.min=t.min+e.min,n.max=n.min+er(e)}function OH(n,e,t){VC(n.x,e.x,t.x),VC(n.y,e.y,t.y)}function FC(n,e,t){n.min=e.min-t.min,n.max=n.min+er(e)}function Tf(n,e,t){FC(n.x,e.x,t.x),FC(n.y,e.y,t.y)}function VH(n,{min:e,max:t},i){return e!==void 0&&n<e?n=i?$t(e,n,i.min):Math.max(n,e):t!==void 0&&n>t&&(n=i?$t(t,n,i.max):Math.min(n,t)),n}function jC(n,e,t){return{min:e!==void 0?n.min+e:void 0,max:t!==void 0?n.max+t-(n.max-n.min):void 0}}function FH(n,{top:e,left:t,bottom:i,right:r}){return{x:jC(n.x,t,r),y:jC(n.y,e,i)}}function GC(n,e){let t=e.min-n.min,i=e.max-n.max;return e.max-e.min<n.max-n.min&&([t,i]=[i,t]),{min:t,max:i}}function jH(n,e){return{x:GC(n.x,e.x),y:GC(n.y,e.y)}}function GH(n,e){let t=.5;const i=er(n),r=er(e);return r>i?t=Ph(e.min,e.max-i,n.min):i>r&&(t=Ph(n.min,n.max-r,e.min)),To(0,1,t)}function UH(n,e){const t={};return e.min!==void 0&&(t.min=e.min-n.min),e.max!==void 0&&(t.max=e.max-n.min),t}const Pw=.35;function zH(n=Pw){return n===!1?n=0:n===!0&&(n=Pw),{x:UC(n,"left","right"),y:UC(n,"top","bottom")}}function UC(n,e,t){return{min:zC(n,e),max:zC(n,t)}}function zC(n,e){return typeof n=="number"?n:n[e]||0}const BC=()=>({translate:0,scale:1,origin:0,originPoint:0}),Gu=()=>({x:BC(),y:BC()}),$C=()=>({min:0,max:0}),en=()=>({x:$C(),y:$C()});function _r(n){return[n("x"),n("y")]}function JD({top:n,left:e,right:t,bottom:i}){return{x:{min:e,max:t},y:{min:n,max:i}}}function BH({x:n,y:e}){return{top:e.min,right:n.max,bottom:e.max,left:n.min}}function $H(n,e){if(!e)return n;const t=e({x:n.left,y:n.top}),i=e({x:n.right,y:n.bottom});return{top:t.y,left:t.x,bottom:i.y,right:i.x}}function X1(n){return n===void 0||n===1}function Cw({scale:n,scaleX:e,scaleY:t}){return!X1(n)||!X1(e)||!X1(t)}function Ll(n){return Cw(n)||e3(n)||n.z||n.rotate||n.rotateX||n.rotateY||n.skewX||n.skewY}function e3(n){return WC(n.x)||WC(n.y)}function WC(n){return n&&n!=="0%"}function c_(n,e,t){const i=n-t,r=e*i;return t+r}function KC(n,e,t,i,r){return r!==void 0&&(n=c_(n,r,i)),c_(n,t,i)+e}function Mw(n,e=0,t=1,i,r){n.min=KC(n.min,e,t,i,r),n.max=KC(n.max,e,t,i,r)}function t3(n,{x:e,y:t}){Mw(n.x,e.translate,e.scale,e.originPoint),Mw(n.y,t.translate,t.scale,t.originPoint)}const qC=.999999999999,HC=1.0000000000001;function WH(n,e,t,i=!1){const r=t.length;if(!r)return;e.x=e.y=1;let s,o;for(let a=0;a<r;a++){s=t[a],o=s.projectionDelta;const{visualElement:c}=s.options;c&&c.props.style&&c.props.style.display==="contents"||(i&&s.options.layoutScroll&&s.scroll&&s!==s.root&&zu(n,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,t3(n,o)),i&&Ll(s.latestValues)&&zu(n,s.latestValues))}e.x<HC&&e.x>qC&&(e.x=1),e.y<HC&&e.y>qC&&(e.y=1)}function Uu(n,e){n.min=n.min+e,n.max=n.max+e}function XC(n,e,t,i,r=.5){const s=$t(n.min,n.max,r);Mw(n,e,t,s,i)}function zu(n,e){XC(n.x,e.x,e.scaleX,e.scale,e.originX),XC(n.y,e.y,e.scaleY,e.scale,e.originY)}function n3(n,e){return JD($H(n.getBoundingClientRect(),e))}function KH(n,e,t){const i=n3(n,t),{scroll:r}=e;return r&&(Uu(i.x,r.offset.x),Uu(i.y,r.offset.y)),i}const i3=({current:n})=>n?n.ownerDocument.defaultView:null,qH=new WeakMap;class HH{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=en(),this.visualElement=e}start(e,{snapToCursor:t=!1}={}){const{presenceContext:i}=this.visualElement;if(i&&i.isPresent===!1)return;const r=d=>{const{dragSnapToOrigin:g}=this.getProps();g?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(qg(d).point)},s=(d,g)=>{const{drag:m,dragPropagation:v,onDragStart:y}=this.getProps();if(m&&!v&&(this.openDragLock&&this.openDragLock(),this.openDragLock=GK(m),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),_r(w=>{let A=this.getAxisMotionValue(w).get()||0;if(bs.test(A)){const{projection:P}=this.visualElement;if(P&&P.layout){const C=P.layout.layoutBox[w];C&&(A=er(C)*(parseFloat(A)/100))}}this.originPoint[w]=A}),y&&Lt.postRender(()=>y(d,g)),Ew(this.visualElement,"transform");const{animationState:T}=this.visualElement;T&&T.setActive("whileDrag",!0)},o=(d,g)=>{const{dragPropagation:m,dragDirectionLock:v,onDirectionLock:y,onDrag:T}=this.getProps();if(!m&&!this.openDragLock)return;const{offset:w}=g;if(v&&this.currentDirection===null){this.currentDirection=XH(w),this.currentDirection!==null&&y&&y(this.currentDirection);return}this.updateAxis("x",g.point,w),this.updateAxis("y",g.point,w),this.visualElement.render(),T&&T(d,g)},a=(d,g)=>this.stop(d,g),c=()=>_r(d=>{var g;return this.getAnimationState(d)==="paused"&&((g=this.getAxisMotionValue(d).animation)===null||g===void 0?void 0:g.play())}),{dragSnapToOrigin:h}=this.getProps();this.panSession=new XD(e,{onSessionStart:r,onStart:s,onMove:o,onSessionEnd:a,resumeAnimation:c},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:h,contextWindow:i3(this.visualElement)})}stop(e,t){const i=this.isDragging;if(this.cancel(),!i)return;const{velocity:r}=t;this.startAnimation(r);const{onDragEnd:s}=this.getProps();s&&Lt.postRender(()=>s(e,t))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:i}=this.getProps();!i&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,i){const{drag:r}=this.getProps();if(!i||!Lp(e,r,this.currentDirection))return;const s=this.getAxisMotionValue(e);let o=this.originPoint[e]+i[e];this.constraints&&this.constraints[e]&&(o=VH(o,this.constraints[e],this.elastic[e])),s.set(o)}resolveConstraints(){var e;const{dragConstraints:t,dragElastic:i}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,s=this.constraints;t&&Fu(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&r?this.constraints=FH(r.layoutBox,t):this.constraints=!1,this.elastic=zH(i),s!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&_r(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=UH(r.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!Fu(e))return!1;const i=e.current,{projection:r}=this.visualElement;if(!r||!r.layout)return!1;const s=KH(i,r.root,this.visualElement.getTransformPagePoint());let o=jH(r.layout.layoutBox,s);if(t){const a=t(BH(o));this.hasMutatedConstraints=!!a,a&&(o=JD(a))}return o}startAnimation(e){const{drag:t,dragMomentum:i,dragElastic:r,dragTransition:s,dragSnapToOrigin:o,onDragTransitionEnd:a}=this.getProps(),c=this.constraints||{},h=_r(d=>{if(!Lp(d,t,this.currentDirection))return;let g=c&&c[d]||{};o&&(g={min:0,max:0});const m=r?200:1e6,v=r?40:1e7,y={type:"inertia",velocity:i?e[d]:0,bounceStiffness:m,bounceDamping:v,timeConstant:750,restDelta:1,restSpeed:10,...s,...g};return this.startAxisValueAnimation(d,y)});return Promise.all(h).then(a)}startAxisValueAnimation(e,t){const i=this.getAxisMotionValue(e);return Ew(this.visualElement,e),i.start(dT(e,i,0,t,this.visualElement,!1))}stopAnimation(){_r(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){_r(e=>{var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.pause()})}getAnimationState(e){var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,i=this.visualElement.getProps(),r=i[t];return r||this.visualElement.getValue(e,(i.initial?i.initial[e]:void 0)||0)}snapToCursor(e){_r(t=>{const{drag:i}=this.getProps();if(!Lp(t,i,this.currentDirection))return;const{projection:r}=this.visualElement,s=this.getAxisMotionValue(t);if(r&&r.layout){const{min:o,max:a}=r.layout.layoutBox[t];s.set(e[t]-$t(o,a,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:i}=this.visualElement;if(!Fu(t)||!i||!this.constraints)return;this.stopAnimation();const r={x:0,y:0};_r(o=>{const a=this.getAxisMotionValue(o);if(a&&this.constraints!==!1){const c=a.get();r[o]=GH({min:c,max:c},this.constraints[o])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",i.root&&i.root.updateScroll(),i.updateLayout(),this.resolveConstraints(),_r(o=>{if(!Lp(o,e,null))return;const a=this.getAxisMotionValue(o),{min:c,max:h}=this.constraints[o];a.set($t(c,h,r[o]))})}addListeners(){if(!this.visualElement.current)return;qH.set(this.visualElement,this);const e=this.visualElement.current,t=xf(e,"pointerdown",c=>{const{drag:h,dragListener:d=!0}=this.getProps();h&&d&&this.start(c)}),i=()=>{const{dragConstraints:c}=this.getProps();Fu(c)&&c.current&&(this.constraints=this.resolveRefConstraints())},{projection:r}=this.visualElement,s=r.addEventListener("measure",i);r&&!r.layout&&(r.root&&r.root.updateScroll(),r.updateLayout()),Lt.read(i);const o=dg(window,"resize",()=>this.scalePositionWithinConstraints()),a=r.addEventListener("didUpdate",(({delta:c,hasLayoutChanged:h})=>{this.isDragging&&h&&(_r(d=>{const g=this.getAxisMotionValue(d);g&&(this.originPoint[d]+=c[d].translate,g.set(g.get()+c[d].translate))}),this.visualElement.render())}));return()=>{o(),t(),s(),a&&a()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:i=!1,dragPropagation:r=!1,dragConstraints:s=!1,dragElastic:o=Pw,dragMomentum:a=!0}=e;return{...e,drag:t,dragDirectionLock:i,dragPropagation:r,dragConstraints:s,dragElastic:o,dragMomentum:a}}}function Lp(n,e,t){return(e===!0||e===n)&&(t===null||t===n)}function XH(n,e=10){let t=null;return Math.abs(n.y)>e?t="y":Math.abs(n.x)>e&&(t="x"),t}class YH extends Za{constructor(e){super(e),this.removeGroupControls=Yi,this.removeListeners=Yi,this.controls=new HH(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Yi}unmount(){this.removeGroupControls(),this.removeListeners()}}const YC=n=>(e,t)=>{n&&Lt.postRender(()=>n(e,t))};class ZH extends Za{constructor(){super(...arguments),this.removePointerDownListener=Yi}onPointerDown(e){this.session=new XD(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:i3(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:i,onPanEnd:r}=this.node.getProps();return{onSessionStart:YC(e),onStart:YC(t),onMove:i,onEnd:(s,o)=>{delete this.session,r&&Lt.postRender(()=>r(s,o))}}}mount(){this.removePointerDownListener=xf(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const r0={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function ZC(n,e){return e.max===e.min?0:n/(e.max-e.min)*100}const Ud={correct:(n,e)=>{if(!e.target)return n;if(typeof n=="string")if(Ve.test(n))n=parseFloat(n);else return n;const t=ZC(n,e.target.x),i=ZC(n,e.target.y);return`${t}% ${i}%`}},QH={correct:(n,{treeScale:e,projectionDelta:t})=>{const i=n,r=$a.parse(n);if(r.length>5)return i;const s=$a.createTransformer(n),o=typeof r[0]!="number"?1:0,a=t.x.scale*e.x,c=t.y.scale*e.y;r[0+o]/=a,r[1+o]/=c;const h=$t(a,c,.5);return typeof r[2+o]=="number"&&(r[2+o]/=h),typeof r[3+o]=="number"&&(r[3+o]/=h),s(r)}};class JH extends ne.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:i,layoutId:r}=this.props,{projection:s}=e;vK(eX),s&&(t.group&&t.group.add(s),i&&i.register&&r&&i.register(s),s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),r0.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:i,drag:r,isPresent:s}=this.props,o=i.projection;return o&&(o.isPresent=s,r||e.layoutDependency!==t||t===void 0?o.willUpdate():this.safeToRemove(),e.isPresent!==s&&(s?o.promote():o.relegate()||Lt.postRender(()=>{const a=o.getStack();(!a||!a.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),US.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:i}=this.props,{projection:r}=e;r&&(r.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(r),i&&i.deregister&&i.deregister(r))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function r3(n){const[e,t]=GN(),i=ne.useContext(LS);return M.jsx(JH,{...n,layoutGroup:i,switchLayoutGroup:ne.useContext(HN),isPresent:e,safeToRemove:t})}const eX={borderRadius:{...Ud,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Ud,borderTopRightRadius:Ud,borderBottomLeftRadius:Ud,borderBottomRightRadius:Ud,boxShadow:QH};function tX(n,e,t){const i=ti(n)?n:ug(n);return i.start(dT("",i,e,t)),i.animation}function nX(n){return n instanceof SVGElement&&n.tagName!=="svg"}const iX=(n,e)=>n.depth-e.depth;class rX{constructor(){this.children=[],this.isDirty=!1}add(e){tT(this.children,e),this.isDirty=!0}remove(e){nT(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(iX),this.isDirty=!1,this.children.forEach(e)}}function sX(n,e){const t=ks.now(),i=({timestamp:r})=>{const s=r-t;s>=e&&(Ba(i),n(s-e))};return Lt.read(i,!0),()=>Ba(i)}const s3=["TopLeft","TopRight","BottomLeft","BottomRight"],oX=s3.length,QC=n=>typeof n=="string"?parseFloat(n):n,JC=n=>typeof n=="number"||Ve.test(n);function aX(n,e,t,i,r,s){r?(n.opacity=$t(0,t.opacity!==void 0?t.opacity:1,lX(i)),n.opacityExit=$t(e.opacity!==void 0?e.opacity:1,0,cX(i))):s&&(n.opacity=$t(e.opacity!==void 0?e.opacity:1,t.opacity!==void 0?t.opacity:1,i));for(let o=0;o<oX;o++){const a=`border${s3[o]}Radius`;let c=eM(e,a),h=eM(t,a);if(c===void 0&&h===void 0)continue;c||(c=0),h||(h=0),c===0||h===0||JC(c)===JC(h)?(n[a]=Math.max($t(QC(c),QC(h),i),0),(bs.test(h)||bs.test(c))&&(n[a]+="%")):n[a]=h}(e.rotate||t.rotate)&&(n.rotate=$t(e.rotate||0,t.rotate||0,i))}function eM(n,e){return n[e]!==void 0?n[e]:n.borderRadius}const lX=o3(0,.5,TD),cX=o3(.5,.95,Yi);function o3(n,e,t){return i=>i<n?0:i>e?1:t(Ph(n,e,i))}function tM(n,e){n.min=e.min,n.max=e.max}function pr(n,e){tM(n.x,e.x),tM(n.y,e.y)}function nM(n,e){n.translate=e.translate,n.scale=e.scale,n.originPoint=e.originPoint,n.origin=e.origin}function iM(n,e,t,i,r){return n-=e,n=c_(n,1/t,i),r!==void 0&&(n=c_(n,1/r,i)),n}function uX(n,e=0,t=1,i=.5,r,s=n,o=n){if(bs.test(e)&&(e=parseFloat(e),e=$t(o.min,o.max,e/100)-o.min),typeof e!="number")return;let a=$t(s.min,s.max,i);n===s&&(a-=e),n.min=iM(n.min,e,t,a,r),n.max=iM(n.max,e,t,a,r)}function rM(n,e,[t,i,r],s,o){uX(n,e[t],e[i],e[r],e.scale,s,o)}const hX=["x","scaleX","originX"],dX=["y","scaleY","originY"];function sM(n,e,t,i){rM(n.x,e,hX,t?t.x:void 0,i?i.x:void 0),rM(n.y,e,dX,t?t.y:void 0,i?i.y:void 0)}function oM(n){return n.translate===0&&n.scale===1}function a3(n){return oM(n.x)&&oM(n.y)}function aM(n,e){return n.min===e.min&&n.max===e.max}function fX(n,e){return aM(n.x,e.x)&&aM(n.y,e.y)}function lM(n,e){return Math.round(n.min)===Math.round(e.min)&&Math.round(n.max)===Math.round(e.max)}function l3(n,e){return lM(n.x,e.x)&&lM(n.y,e.y)}function cM(n){return er(n.x)/er(n.y)}function uM(n,e){return n.translate===e.translate&&n.scale===e.scale&&n.originPoint===e.originPoint}class gX{constructor(){this.members=[]}add(e){tT(this.members,e),e.scheduleRender()}remove(e){if(nT(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(r=>e===r);if(t===0)return!1;let i;for(let r=t;r>=0;r--){const s=this.members[r];if(s.isPresent!==!1){i=s;break}}return i?(this.promote(i),!0):!1}promote(e,t){const i=this.lead;if(e!==i&&(this.prevLead=i,this.lead=e,e.show(),i)){i.instance&&i.scheduleRender(),e.scheduleRender(),e.resumeFrom=i,t&&(e.resumeFrom.preserveOpacity=!0),i.snapshot&&(e.snapshot=i.snapshot,e.snapshot.latestValues=i.animationValues||i.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:r}=e.options;r===!1&&i.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:i}=e;t.onExitComplete&&t.onExitComplete(),i&&i.options.onExitComplete&&i.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function mX(n,e,t){let i="";const r=n.x.translate/e.x,s=n.y.translate/e.y,o=t?.z||0;if((r||s||o)&&(i=`translate3d(${r}px, ${s}px, ${o}px) `),(e.x!==1||e.y!==1)&&(i+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:h,rotate:d,rotateX:g,rotateY:m,skewX:v,skewY:y}=t;h&&(i=`perspective(${h}px) ${i}`),d&&(i+=`rotate(${d}deg) `),g&&(i+=`rotateX(${g}deg) `),m&&(i+=`rotateY(${m}deg) `),v&&(i+=`skewX(${v}deg) `),y&&(i+=`skewY(${y}deg) `)}const a=n.x.scale*e.x,c=n.y.scale*e.y;return(a!==1||c!==1)&&(i+=`scale(${a}, ${c})`),i||"none"}const Nl={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},sf=typeof window<"u"&&window.MotionDebug!==void 0,Y1=["","X","Y","Z"],pX={visibility:"hidden"},hM=1e3;let _X=0;function Z1(n,e,t,i){const{latestValues:r}=e;r[n]&&(t[n]=r[n],e.setStaticValue(n,0),i&&(i[n]=0))}function c3(n){if(n.hasCheckedOptimisedAppear=!0,n.root===n)return;const{visualElement:e}=n.options;if(!e)return;const t=_D(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:r,layoutId:s}=n.options;window.MotionCancelOptimisedAnimation(t,"transform",Lt,!(r||s))}const{parent:i}=n;i&&!i.hasCheckedOptimisedAppear&&c3(i)}function u3({attachResizeListener:n,defaultParent:e,measureScroll:t,checkIsScrollRoot:i,resetTransform:r}){return class{constructor(o={},a=e?.()){this.id=_X++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,sf&&(Nl.totalNodes=Nl.resolvedTargetDeltas=Nl.recalculatedProjection=0),this.nodes.forEach(EX),this.nodes.forEach(IX),this.nodes.forEach(AX),this.nodes.forEach(wX),sf&&window.MotionDebug.record(Nl)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=a?a.root||a:this,this.path=a?[...a.path,a]:[],this.parent=a,this.depth=a?a.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new rX)}addEventListener(o,a){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new iT),this.eventHandlers.get(o).add(a)}notifyListeners(o,...a){const c=this.eventHandlers.get(o);c&&c.notify(...a)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,a=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=nX(o),this.instance=o;const{layoutId:c,layout:h,visualElement:d}=this.options;if(d&&!d.current&&d.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),a&&(h||c)&&(this.isLayoutDirty=!0),n){let g;const m=()=>this.root.updateBlockedByResize=!1;n(o,()=>{this.root.updateBlockedByResize=!0,g&&g(),g=sX(m,250),r0.hasAnimatedSinceResize&&(r0.hasAnimatedSinceResize=!1,this.nodes.forEach(fM))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&d&&(c||h)&&this.addEventListener("didUpdate",({delta:g,hasLayoutChanged:m,hasRelativeTargetChanged:v,layout:y})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const T=this.options.transition||d.getDefaultTransition()||bX,{onLayoutAnimationStart:w,onLayoutAnimationComplete:A}=d.getProps(),P=!this.targetLayout||!l3(this.targetLayout,y)||v,C=!m&&v;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||C||m&&(P||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(g,C);const N={...ZS(T,"layout"),onPlay:w,onComplete:A};(d.shouldReduceMotion||this.options.layoutRoot)&&(N.delay=0,N.type=!1),this.startAnimation(N)}else m||fM(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=y})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Ba(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(RX),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&c3(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let d=0;d<this.path.length;d++){const g=this.path[d];g.shouldResetTransform=!0,g.updateScroll("snapshot"),g.options.layoutRoot&&g.willUpdate(!1)}const{layoutId:a,layout:c}=this.options;if(a===void 0&&!c)return;const h=this.getTransformTemplate();this.prevTransformTemplateValue=h?h(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(dM);return}this.isUpdating||this.nodes.forEach(SX),this.isUpdating=!1,this.nodes.forEach(TX),this.nodes.forEach(yX),this.nodes.forEach(vX),this.clearAllSnapshots();const a=ks.now();Vn.delta=To(0,1e3/60,a-Vn.timestamp),Vn.timestamp=a,Vn.isProcessing=!0,U1.update.process(Vn),U1.preRender.process(Vn),U1.render.process(Vn),Vn.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,US.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(xX),this.sharedNodes.forEach(PX)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Lt.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Lt.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=en(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:a}=this.options;a&&a.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let a=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(a=!1),a){const c=i(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:c,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:c}}}resetTransform(){if(!r)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,a=this.projectionDelta&&!a3(this.projectionDelta),c=this.getTransformTemplate(),h=c?c(this.latestValues,""):void 0,d=h!==this.prevTransformTemplateValue;o&&(a||Ll(this.latestValues)||d)&&(r(this.instance,h),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const a=this.measurePageBox();let c=this.removeElementScroll(a);return o&&(c=this.removeTransform(c)),kX(c),{animationId:this.root.animationId,measuredBox:a,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){var o;const{visualElement:a}=this.options;if(!a)return en();const c=a.measureViewportBox();if(!(((o=this.scroll)===null||o===void 0?void 0:o.wasRoot)||this.path.some(LX))){const{scroll:d}=this.root;d&&(Uu(c.x,d.offset.x),Uu(c.y,d.offset.y))}return c}removeElementScroll(o){var a;const c=en();if(pr(c,o),!((a=this.scroll)===null||a===void 0)&&a.wasRoot)return c;for(let h=0;h<this.path.length;h++){const d=this.path[h],{scroll:g,options:m}=d;d!==this.root&&g&&m.layoutScroll&&(g.wasRoot&&pr(c,o),Uu(c.x,g.offset.x),Uu(c.y,g.offset.y))}return c}applyTransform(o,a=!1){const c=en();pr(c,o);for(let h=0;h<this.path.length;h++){const d=this.path[h];!a&&d.options.layoutScroll&&d.scroll&&d!==d.root&&zu(c,{x:-d.scroll.offset.x,y:-d.scroll.offset.y}),Ll(d.latestValues)&&zu(c,d.latestValues)}return Ll(this.latestValues)&&zu(c,this.latestValues),c}removeTransform(o){const a=en();pr(a,o);for(let c=0;c<this.path.length;c++){const h=this.path[c];if(!h.instance||!Ll(h.latestValues))continue;Cw(h.latestValues)&&h.updateSnapshot();const d=en(),g=h.measurePageBox();pr(d,g),sM(a,h.latestValues,h.snapshot?h.snapshot.layoutBox:void 0,d)}return Ll(this.latestValues)&&sM(a,this.latestValues),a}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Vn.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var a;const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const h=!!this.resumingFrom||this!==c;if(!(o||h&&this.isSharedProjectionDirty||this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:g,layoutId:m}=this.options;if(!(!this.layout||!(g||m))){if(this.resolvedRelativeTargetAt=Vn.timestamp,!this.targetDelta&&!this.relativeTarget){const v=this.getClosestProjectingParent();v&&v.layout&&this.animationProgress!==1?(this.relativeParent=v,this.forceRelativeParentToResolveTarget(),this.relativeTarget=en(),this.relativeTargetOrigin=en(),Tf(this.relativeTargetOrigin,this.layout.layoutBox,v.layout.layoutBox),pr(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=en(),this.targetWithTransforms=en()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),OH(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):pr(this.target,this.layout.layoutBox),t3(this.target,this.targetDelta)):pr(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const v=this.getClosestProjectingParent();v&&!!v.resumingFrom==!!this.resumingFrom&&!v.options.layoutScroll&&v.target&&this.animationProgress!==1?(this.relativeParent=v,this.forceRelativeParentToResolveTarget(),this.relativeTarget=en(),this.relativeTargetOrigin=en(),Tf(this.relativeTargetOrigin,this.target,v.target),pr(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}sf&&Nl.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||Cw(this.parent.latestValues)||e3(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const a=this.getLead(),c=!!this.resumingFrom||this!==a;let h=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(h=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(h=!1),this.resolvedRelativeTargetAt===Vn.timestamp&&(h=!1),h)return;const{layout:d,layoutId:g}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(d||g))return;pr(this.layoutCorrected,this.layout.layoutBox);const m=this.treeScale.x,v=this.treeScale.y;WH(this.layoutCorrected,this.treeScale,this.path,c),a.layout&&!a.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(a.target=a.layout.layoutBox,a.targetWithTransforms=en());const{target:y}=a;if(!y){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(nM(this.prevProjectionDelta.x,this.projectionDelta.x),nM(this.prevProjectionDelta.y,this.projectionDelta.y)),Sf(this.projectionDelta,this.layoutCorrected,y,this.latestValues),(this.treeScale.x!==m||this.treeScale.y!==v||!uM(this.projectionDelta.x,this.prevProjectionDelta.x)||!uM(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",y)),sf&&Nl.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var a;if((a=this.options.visualElement)===null||a===void 0||a.scheduleRender(),o){const c=this.getStack();c&&c.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Gu(),this.projectionDelta=Gu(),this.projectionDeltaWithTransform=Gu()}setAnimationOrigin(o,a=!1){const c=this.snapshot,h=c?c.latestValues:{},d={...this.latestValues},g=Gu();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!a;const m=en(),v=c?c.source:void 0,y=this.layout?this.layout.source:void 0,T=v!==y,w=this.getStack(),A=!w||w.members.length<=1,P=!!(T&&!A&&this.options.crossfade===!0&&!this.path.some(MX));this.animationProgress=0;let C;this.mixTargetDelta=N=>{const D=N/1e3;gM(g.x,o.x,D),gM(g.y,o.y,D),this.setTargetDelta(g),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Tf(m,this.layout.layoutBox,this.relativeParent.layout.layoutBox),CX(this.relativeTarget,this.relativeTargetOrigin,m,D),C&&fX(this.relativeTarget,C)&&(this.isProjectionDirty=!1),C||(C=en()),pr(C,this.relativeTarget)),T&&(this.animationValues=d,aX(d,h,this.latestValues,D,P,A)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=D},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Ba(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Lt.update(()=>{r0.hasAnimatedSinceResize=!0,this.currentAnimation=tX(0,hM,{...o,onUpdate:a=>{this.mixTargetDelta(a),o.onUpdate&&o.onUpdate(a)},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(hM),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:a,target:c,layout:h,latestValues:d}=o;if(!(!a||!c||!h)){if(this!==o&&this.layout&&h&&h3(this.options.animationType,this.layout.layoutBox,h.layoutBox)){c=this.target||en();const g=er(this.layout.layoutBox.x);c.x.min=o.target.x.min,c.x.max=c.x.min+g;const m=er(this.layout.layoutBox.y);c.y.min=o.target.y.min,c.y.max=c.y.min+m}pr(a,c),zu(a,d),Sf(this.projectionDeltaWithTransform,this.layoutCorrected,a,d)}}registerSharedNode(o,a){this.sharedNodes.has(o)||this.sharedNodes.set(o,new gX),this.sharedNodes.get(o).add(a);const h=a.options.initialPromotionConfig;a.promote({transition:h?h.transition:void 0,preserveFollowOpacity:h&&h.shouldPreserveFollowOpacity?h.shouldPreserveFollowOpacity(a):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:a}=this.options;return a?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:a}=this.options;return a?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:a,preserveFollowOpacity:c}={}){const h=this.getStack();h&&h.promote(this,c),o&&(this.projectionDelta=void 0,this.needsReset=!0),a&&this.setOptions({transition:a})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let a=!1;const{latestValues:c}=o;if((c.z||c.rotate||c.rotateX||c.rotateY||c.rotateZ||c.skewX||c.skewY)&&(a=!0),!a)return;const h={};c.z&&Z1("z",o,h,this.animationValues);for(let d=0;d<Y1.length;d++)Z1(`rotate${Y1[d]}`,o,h,this.animationValues),Z1(`skew${Y1[d]}`,o,h,this.animationValues);o.render();for(const d in h)o.setStaticValue(d,h[d]),this.animationValues&&(this.animationValues[d]=h[d]);o.scheduleRender()}getProjectionStyles(o){var a,c;if(!this.instance||this.isSVG)return;if(!this.isVisible)return pX;const h={visibility:""},d=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,h.opacity="",h.pointerEvents=n0(o?.pointerEvents)||"",h.transform=d?d(this.latestValues,""):"none",h;const g=this.getLead();if(!this.projectionDelta||!this.layout||!g.target){const T={};return this.options.layoutId&&(T.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,T.pointerEvents=n0(o?.pointerEvents)||""),this.hasProjected&&!Ll(this.latestValues)&&(T.transform=d?d({},""):"none",this.hasProjected=!1),T}const m=g.animationValues||g.latestValues;this.applyTransformsToTarget(),h.transform=mX(this.projectionDeltaWithTransform,this.treeScale,m),d&&(h.transform=d(m,h.transform));const{x:v,y}=this.projectionDelta;h.transformOrigin=`${v.origin*100}% ${y.origin*100}% 0`,g.animationValues?h.opacity=g===this?(c=(a=m.opacity)!==null&&a!==void 0?a:this.latestValues.opacity)!==null&&c!==void 0?c:1:this.preserveOpacity?this.latestValues.opacity:m.opacityExit:h.opacity=g===this?m.opacity!==void 0?m.opacity:"":m.opacityExit!==void 0?m.opacityExit:0;for(const T in r_){if(m[T]===void 0)continue;const{correct:w,applyTo:A}=r_[T],P=h.transform==="none"?m[T]:w(m[T],g);if(A){const C=A.length;for(let N=0;N<C;N++)h[A[N]]=P}else h[T]=P}return this.options.layoutId&&(h.pointerEvents=g===this?n0(o?.pointerEvents)||"":"none"),h}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var a;return(a=o.currentAnimation)===null||a===void 0?void 0:a.stop()}),this.root.nodes.forEach(dM),this.root.sharedNodes.clear()}}}function yX(n){n.updateLayout()}function vX(n){var e;const t=((e=n.resumeFrom)===null||e===void 0?void 0:e.snapshot)||n.snapshot;if(n.isLead()&&n.layout&&t&&n.hasListeners("didUpdate")){const{layoutBox:i,measuredBox:r}=n.layout,{animationType:s}=n.options,o=t.source!==n.layout.source;s==="size"?_r(g=>{const m=o?t.measuredBox[g]:t.layoutBox[g],v=er(m);m.min=i[g].min,m.max=m.min+v}):h3(s,t.layoutBox,i)&&_r(g=>{const m=o?t.measuredBox[g]:t.layoutBox[g],v=er(i[g]);m.max=m.min+v,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[g].max=n.relativeTarget[g].min+v)});const a=Gu();Sf(a,i,t.layoutBox);const c=Gu();o?Sf(c,n.applyTransform(r,!0),t.measuredBox):Sf(c,i,t.layoutBox);const h=!a3(a);let d=!1;if(!n.resumeFrom){const g=n.getClosestProjectingParent();if(g&&!g.resumeFrom){const{snapshot:m,layout:v}=g;if(m&&v){const y=en();Tf(y,t.layoutBox,m.layoutBox);const T=en();Tf(T,i,v.layoutBox),l3(y,T)||(d=!0),g.options.layoutRoot&&(n.relativeTarget=T,n.relativeTargetOrigin=y,n.relativeParent=g)}}}n.notifyListeners("didUpdate",{layout:i,snapshot:t,delta:c,layoutDelta:a,hasLayoutChanged:h,hasRelativeTargetChanged:d})}else if(n.isLead()){const{onExitComplete:i}=n.options;i&&i()}n.options.transition=void 0}function EX(n){sf&&Nl.totalNodes++,n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function wX(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function xX(n){n.clearSnapshot()}function dM(n){n.clearMeasurements()}function SX(n){n.isLayoutDirty=!1}function TX(n){const{visualElement:e}=n.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),n.resetTransform()}function fM(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function IX(n){n.resolveTargetDelta()}function AX(n){n.calcProjection()}function RX(n){n.resetSkewAndRotation()}function PX(n){n.removeLeadSnapshot()}function gM(n,e,t){n.translate=$t(e.translate,0,t),n.scale=$t(e.scale,1,t),n.origin=e.origin,n.originPoint=e.originPoint}function mM(n,e,t,i){n.min=$t(e.min,t.min,i),n.max=$t(e.max,t.max,i)}function CX(n,e,t,i){mM(n.x,e.x,t.x,i),mM(n.y,e.y,t.y,i)}function MX(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const bX={duration:.45,ease:[.4,0,.1,1]},pM=n=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(n),_M=pM("applewebkit/")&&!pM("chrome/")?Math.round:Yi;function yM(n){n.min=_M(n.min),n.max=_M(n.max)}function kX(n){yM(n.x),yM(n.y)}function h3(n,e,t){return n==="position"||n==="preserve-aspect"&&!DH(cM(e),cM(t),.2)}function LX(n){var e;return n!==n.root&&((e=n.scroll)===null||e===void 0?void 0:e.wasRoot)}const NX=u3({attachResizeListener:(n,e)=>dg(n,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Q1={current:void 0},d3=u3({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!Q1.current){const n=new NX({});n.mount(window),n.setOptions({layoutScroll:!0}),Q1.current=n}return Q1.current},resetTransform:(n,e)=>{n.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),DX={pan:{Feature:ZH},drag:{Feature:YH,ProjectionNode:d3,MeasureLayout:r3}};function vM(n,e,t){const{props:i}=n;n.animationState&&i.whileHover&&n.animationState.setActive("whileHover",t==="Start");const r="onHover"+t,s=i[r];s&&Lt.postRender(()=>s(e,qg(e)))}class OX extends Za{mount(){const{current:e}=this.node;e&&(this.unmount=DK(e,t=>(vM(this.node,t,"Start"),i=>vM(this.node,i,"End"))))}unmount(){}}class VX extends Za{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Kg(dg(this.node.current,"focus",()=>this.onFocus()),dg(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function EM(n,e,t){const{props:i}=n;n.animationState&&i.whileTap&&n.animationState.setActive("whileTap",t==="Start");const r="onTap"+(t==="End"?"":t),s=i[r];s&&Lt.postRender(()=>s(e,qg(e)))}class FX extends Za{mount(){const{current:e}=this.node;e&&(this.unmount=jK(e,t=>(EM(this.node,t,"Start"),(i,{success:r})=>EM(this.node,i,r?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const bw=new WeakMap,J1=new WeakMap,jX=n=>{const e=bw.get(n.target);e&&e(n)},GX=n=>{n.forEach(jX)};function UX({root:n,...e}){const t=n||document;J1.has(t)||J1.set(t,{});const i=J1.get(t),r=JSON.stringify(e);return i[r]||(i[r]=new IntersectionObserver(GX,{root:n,...e})),i[r]}function zX(n,e,t){const i=UX(e);return bw.set(n,t),i.observe(n),()=>{bw.delete(n),i.unobserve(n)}}const BX={some:0,all:1};class $X extends Za{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:i,amount:r="some",once:s}=e,o={root:t?t.current:void 0,rootMargin:i,threshold:typeof r=="number"?r:BX[r]},a=c=>{const{isIntersecting:h}=c;if(this.isInView===h||(this.isInView=h,s&&!h&&this.hasEnteredView))return;h&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",h);const{onViewportEnter:d,onViewportLeave:g}=this.node.getProps(),m=h?d:g;m&&m(c)};return zX(this.node.current,o,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(WX(e,t))&&this.startObserver()}unmount(){}}function WX({viewport:n={}},{viewport:e={}}={}){return t=>n[t]!==e[t]}const KX={inView:{Feature:$X},tap:{Feature:FX},focus:{Feature:VX},hover:{Feature:OX}},qX={layout:{ProjectionNode:d3,MeasureLayout:r3}},kw={current:null},f3={current:!1};function HX(){if(f3.current=!0,!!OS)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),e=()=>kw.current=n.matches;n.addListener(e),e()}else kw.current=!1}const XX=[...FD,Xn,$a],YX=n=>XX.find(VD(n)),wM=new WeakMap;function ZX(n,e,t){for(const i in e){const r=e[i],s=t[i];if(ti(r))n.addValue(i,r);else if(ti(s))n.addValue(i,ug(r,{owner:n}));else if(s!==r)if(n.hasValue(i)){const o=n.getValue(i);o.liveStyle===!0?o.jump(r):o.hasAnimated||o.set(r)}else{const o=n.getStaticValue(i);n.addValue(i,ug(o!==void 0?o:r,{owner:n}))}}for(const i in t)e[i]===void 0&&n.removeValue(i);return e}const xM=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class QX{scrapeMotionValuesFromProps(e,t,i){return{}}constructor({parent:e,props:t,presenceContext:i,reducedMotionConfig:r,blockInitialAnimation:s,visualState:o},a={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=cT,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const v=ks.now();this.renderScheduledAt<v&&(this.renderScheduledAt=v,Lt.render(this.render,!1,!0))};const{latestValues:c,renderState:h,onUpdate:d}=o;this.onUpdate=d,this.latestValues=c,this.baseTarget={...c},this.initialValues=t.initial?{...c}:{},this.renderState=h,this.parent=e,this.props=t,this.presenceContext=i,this.depth=e?e.depth+1:0,this.reducedMotionConfig=r,this.options=a,this.blockInitialAnimation=!!s,this.isControllingVariants=_y(t),this.isVariantNode=KN(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:g,...m}=this.scrapeMotionValuesFromProps(t,{},this);for(const v in m){const y=m[v];c[v]!==void 0&&ti(y)&&y.set(c[v],!1)}}mount(e){this.current=e,wM.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((t,i)=>this.bindToMotionValue(i,t)),f3.current||HX(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:kw.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){wM.delete(this.current),this.projection&&this.projection.unmount(),Ba(this.notifyUpdate),Ba(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const i=Pc.has(e),r=t.on("change",a=>{this.latestValues[e]=a,this.props.onUpdate&&Lt.preRender(this.notifyUpdate),i&&this.projection&&(this.projection.isTransformDirty=!0)}),s=t.on("renderRequest",this.scheduleRender);let o;window.MotionCheckAppearSync&&(o=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{r(),s(),o&&o(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in Ch){const t=Ch[e];if(!t)continue;const{isEnabled:i,Feature:r}=t;if(!this.features[e]&&r&&i(this.props)&&(this.features[e]=new r(this)),this.features[e]){const s=this.features[e];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):en()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let i=0;i<xM.length;i++){const r=xM[i];this.propEventSubscriptions[r]&&(this.propEventSubscriptions[r](),delete this.propEventSubscriptions[r]);const s="on"+r,o=e[s];o&&(this.propEventSubscriptions[r]=this.on(r,o))}this.prevMotionValues=ZX(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const i=this.values.get(e);t!==i&&(i&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let i=this.values.get(e);return i===void 0&&t!==void 0&&(i=ug(t===null?void 0:t,{owner:this}),this.addValue(e,i)),i}readValue(e,t){var i;let r=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(i=this.getBaseTargetFromProps(this.props,e))!==null&&i!==void 0?i:this.readValueFromInstance(this.current,e,this.options);return r!=null&&(typeof r=="string"&&(DD(r)||AD(r))?r=parseFloat(r):!YX(r)&&$a.test(t)&&(r=kD(e,t)),this.setBaseTarget(e,ti(r)?r.get():r)),ti(r)?r.get():r}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var t;const{initial:i}=this.props;let r;if(typeof i=="string"||typeof i=="object"){const o=BS(this.props,i,(t=this.presenceContext)===null||t===void 0?void 0:t.custom);o&&(r=o[e])}if(i&&r!==void 0)return r;const s=this.getBaseTargetFromProps(this.props,e);return s!==void 0&&!ti(s)?s:this.initialValues[e]!==void 0&&r===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new iT),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}}class g3 extends QX{constructor(){super(...arguments),this.KeyframeResolver=jD}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:i}){delete t[e],delete i[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;ti(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function JX(n){return window.getComputedStyle(n)}class eY extends g3{constructor(){super(...arguments),this.type="html",this.renderInstance=tD}readValueFromInstance(e,t){if(Pc.has(t)){const i=lT(t);return i&&i.default||0}else{const i=JX(e),r=(QN(t)?i.getPropertyValue(t):i[t])||0;return typeof r=="string"?r.trim():r}}measureInstanceViewportBox(e,{transformPagePoint:t}){return n3(e,t)}build(e,t,i){KS(e,t,i.transformTemplate)}scrapeMotionValuesFromProps(e,t,i){return YS(e,t,i)}}class tY extends g3{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=en}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(Pc.has(t)){const i=lT(t);return i&&i.default||0}return t=nD.has(t)?t:GS(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,i){return sD(e,t,i)}build(e,t,i){qS(e,t,this.isSVGTag,i.transformTemplate)}renderInstance(e,t,i,r){iD(e,t,i,r)}mount(e){this.isSVGTag=XS(e.tagName),super.mount(e)}}const nY=(n,e)=>zS(n)?new tY(e):new eY(e,{allowProjection:n!==ne.Fragment}),iY=PK({...AH,...KX,...DX,...qX},nY),_n=BW(iY);const rY=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),sY=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,i)=>i?i.toUpperCase():t.toLowerCase()),SM=n=>{const e=sY(n);return e.charAt(0).toUpperCase()+e.slice(1)},m3=(...n)=>n.filter((e,t,i)=>!!e&&e.trim()!==""&&i.indexOf(e)===t).join(" ").trim(),oY=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var aY={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const lY=ne.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:i,className:r="",children:s,iconNode:o,...a},c)=>ne.createElement("svg",{ref:c,...aY,width:e,height:e,stroke:n,strokeWidth:i?Number(t)*24/Number(e):t,className:m3("lucide",r),...!s&&!oY(a)&&{"aria-hidden":"true"},...a},[...o.map(([h,d])=>ne.createElement(h,d)),...Array.isArray(s)?s:[s]]));const Qe=(n,e)=>{const t=ne.forwardRef(({className:i,...r},s)=>ne.createElement(lY,{ref:s,iconNode:e,className:m3(`lucide-${rY(SM(n))}`,`lucide-${n}`,i),...r}));return t.displayName=SM(n),t};const cY=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],uY=Qe("arrow-left",cY);const hY=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],dY=Qe("arrow-right",hY);const fY=[["path",{d:"M7 17V7h10",key:"11bw93"}],["path",{d:"M17 17 7 7",key:"2786uv"}]],gY=Qe("arrow-up-left",fY);const mY=[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]],pY=Qe("arrow-up-right",mY);const _Y=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],yY=Qe("arrow-up",_Y);const vY=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],EY=Qe("check",vY);const wY=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],xY=Qe("chevron-down",wY);const SY=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],TY=Qe("chevron-right",SY);const IY=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],p3=Qe("chevron-up",IY);const AY=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],RY=Qe("circle-alert",AY);const PY=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],CY=Qe("circle",PY);const MY=[["path",{d:"m16.24 7.76-1.804 5.411a2 2 0 0 1-1.265 1.265L7.76 16.24l1.804-5.411a2 2 0 0 1 1.265-1.265z",key:"9ktpf1"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],bY=Qe("compass",MY);const kY=[["path",{d:"M20 20v-7a4 4 0 0 0-4-4H4",key:"1nkjon"}],["path",{d:"M9 14 4 9l5-5",key:"102s5s"}]],LY=Qe("corner-up-left",kY);const NY=[["path",{d:"m15 14 5-5-5-5",key:"12vg1m"}],["path",{d:"M4 20v-7a4 4 0 0 1 4-4h12",key:"1lu4f8"}]],DY=Qe("corner-up-right",NY);const OY=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],VY=Qe("eye",OY);const FY=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],jY=Qe("folder-open",FY);const GY=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],UY=Qe("folder",GY);const zY=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],BY=Qe("globe",zY);const $Y=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],WY=Qe("info",$Y);const KY=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],_3=Qe("layers",KY);const qY=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],HY=Qe("loader-circle",qY);const XY=[["line",{x1:"2",x2:"5",y1:"12",y2:"12",key:"bvdh0s"}],["line",{x1:"19",x2:"22",y1:"12",y2:"12",key:"1tbv5k"}],["line",{x1:"12",x2:"12",y1:"2",y2:"5",key:"11lu5j"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}],["circle",{cx:"12",cy:"12",r:"7",key:"fim9np"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],YY=Qe("locate-fixed",XY);const ZY=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],y3=Qe("map-pin",ZY);const QY=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],v3=Qe("map",QY);const JY=[["path",{d:"M5 12h14",key:"1ays0h"}]],eZ=Qe("minus",JY);const tZ=[["path",{d:"m8 3 4 8 5-5 5 15H2L8 3z",key:"otkl63"}]],nZ=Qe("mountain",tZ);const iZ=[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]],Ey=Qe("navigation",iZ);const rZ=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],sZ=Qe("plus",rZ);const oZ=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],Lw=Qe("rotate-ccw",oZ);const aZ=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],E3=Qe("search",aZ);const lZ=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],w3=Qe("settings",lZ);const cZ=[["path",{d:"M10 5H3",key:"1qgfaw"}],["path",{d:"M12 19H3",key:"yhmn1j"}],["path",{d:"M14 3v4",key:"1sua03"}],["path",{d:"M16 17v4",key:"1q0r14"}],["path",{d:"M21 12h-9",key:"1o4lsq"}],["path",{d:"M21 19h-5",key:"1rlt1p"}],["path",{d:"M21 5h-7",key:"1oszz2"}],["path",{d:"M8 10v4",key:"tgpxqk"}],["path",{d:"M8 12H3",key:"a7s4jb"}]],uZ=Qe("sliders-horizontal",cZ);const hZ=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],dZ=Qe("smartphone",hZ);const fZ=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],gZ=Qe("target",fZ);const mZ=[["path",{d:"M13 8c0-2.76-2.46-5-5.5-5S2 5.24 2 8h2l1-1 1 1h4",key:"foxbe7"}],["path",{d:"M13 7.14A5.82 5.82 0 0 1 16.5 6c3.04 0 5.5 2.24 5.5 5h-3l-1-1-1 1h-3",key:"18arnh"}],["path",{d:"M5.89 9.71c-2.15 2.15-2.3 5.47-.35 7.43l4.24-4.25.7-.7.71-.71 2.12-2.12c-1.95-1.96-5.27-1.8-7.42.35",key:"ywahnh"}],["path",{d:"M11 15.5c.5 2.5-.17 4.5-1 6.5h4c2-5.5-.5-12-1-14",key:"ft0feo"}]],pZ=Qe("tree-palm",mZ);const _Z=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],yZ=Qe("volume-2",_Z);const vZ=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]],EZ=Qe("volume-x",vZ);const wZ=[["path",{d:"M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"knzxuh"}],["path",{d:"M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"2jd2cc"}],["path",{d:"M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"rd2r6e"}]],xZ=Qe("waves",wZ);const SZ=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Cc=Qe("x",SZ);function TZ(){const{tracking:n,startTracking:e,stopTracking:t,updatePosition:i,setWatchId:r,resetFirstFix:s}=Ot(),o=ne.useCallback(c=>{i(c)},[i]),a=ne.useCallback(c=>{console.error("GPS error:",c),alert(`GPS fout: ${c.message}`),t()},[t]);return ne.useEffect(()=>{if(!n)return;if(!navigator.geolocation){alert("Geolocation wordt niet ondersteund door deze browser"),t();return}const c=navigator.geolocation.watchPosition(o,a,{enableHighAccuracy:!0,maximumAge:1e3,timeout:15e3});return r(c),()=>{navigator.geolocation.clearWatch(c)}},[n,o,a,r,t]),{tracking:n,start:e,stop:t,toggle:()=>n?t():e()}}function IZ(){const{tracking:n,toggle:e}=TZ();return M.jsx(_n.button,{className:`
        fixed bottom-[30px] md:bottom-10 right-2.5 z-[1000]
        w-11 h-11 cursor-pointer border-0 outline-none
        flex items-center justify-center
        rounded-xl backdrop-blur-sm
        transition-all duration-200
        ${n?"bg-gradient-to-br from-blue-400 to-blue-600 text-white shadow-lg shadow-blue-500/30":"bg-white/80 text-gray-500 hover:bg-white/90 shadow-sm"}
      `,onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},animate:n?{scale:[1,1.02,1]}:{},transition:n?{scale:{duration:2,repeat:1/0,ease:"easeInOut"}}:{},"aria-label":n?"GPS tracking actief":"GPS tracking starten",title:n?"GPS tracking actief":"GPS tracking starten",children:M.jsx(YY,{size:22,strokeWidth:2})})}const TM="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(`<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40">
    <polygon points="20,4 32,32 20,26 8,32" fill="#4285F4" stroke="white" stroke-width="2.5" stroke-linejoin="round"/>
  </svg>`);function AZ(){const n=Li(w=>w.map),e=Li(w=>w.rotation),t=Ot(w=>w.position),i=Ot(w=>w.accuracy),r=Ot(w=>w.tracking),s=Ot(w=>w.navigationMode),o=Ot(w=>w.smoothHeading),a=Ot(w=>w.firstFix),c=Ot(w=>w.resetFirstFix),h=Ot(w=>w.config.centerOnUser),d=Ot(w=>w.config.animationDuration),g=ne.useRef(null),m=ne.useRef(null),v=ne.useRef(null),y=ne.useRef(0),T=ne.useMemo(()=>new Xi({image:new x0({src:TM,scale:1,rotation:0,rotateWithView:!1,anchor:[.5,.5]})}),[]);return ne.useEffect(()=>{if(!n||!r&&!t)return;const w=ic([5.1214,52.0907]);return g.current=new u0({geometry:new _0(w)}),g.current.setStyle(T),m.current=new u0({geometry:new _0(w)}),v.current=new a4({source:new $b({features:[m.current,g.current]}),zIndex:1e3}),n.addLayer(v.current),()=>{v.current&&n&&n.removeLayer(v.current)}},[n,r,t,T]),ne.useEffect(()=>{if(!n||!t||!g.current||!m.current)return;const w=ic([t.lng,t.lat]);if(g.current.getGeometry()?.setCoordinates(w),m.current.getGeometry()?.setCoordinates(w),i){const A=n.getView().getResolution()||1,P=i/A;m.current.setStyle(new Xi({image:new kh({radius:Math.min(P,100),fill:new Oa({color:"rgba(66, 133, 244, 0.1)"})})}))}a&&r&&(n.getView().setCenter(w),n.getView().setZoom(17),c(),console.log(" GPS locked - jumped to position + street level")),r&&h&&!a&&n.getView().animate({center:w,duration:d})},[n,r,t,i,a,c,h,d]),ne.useEffect(()=>{if(!n||!g.current)return;const A=n.getView().getRotation();let P;s==="free"?P=o!==null?o*Math.PI/180:0:P=-A;const C=5*Math.PI/180;let N=P-y.current;N>Math.PI&&(N-=2*Math.PI),N<-Math.PI&&(N+=2*Math.PI),!(Math.abs(N)<C)&&(y.current=P,g.current.setStyle(new Xi({image:new x0({src:TM,scale:1,rotation:P,rotateWithView:!1,anchor:[.5,.5]})})))},[n,s,o,e]),null}function RZ(){const n=Wf(t=>t.themesPanelOpen),e=Wf(t=>t.toggleThemesPanel);return M.jsx(_n.button,{className:`
        fixed bottom-[85px] md:bottom-[95px] right-2.5 z-[1000]
        w-10 h-10 cursor-pointer border-0 outline-none
        flex items-center justify-center
        rounded-xl backdrop-blur-sm
        transition-all duration-200
        ${n?"bg-gradient-to-br from-blue-400 to-blue-600 text-white shadow-lg shadow-blue-500/30":"bg-white/80 text-gray-500 hover:bg-white/90 shadow-sm"}
      `,onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":n?"Kaartlagen sluiten":"Kaartlagen openen",title:"Kaartlagen",children:M.jsx(v3,{size:20,strokeWidth:2})})}function PZ(){return M.jsx(RZ,{})}function $i({title:n,children:e,defaultExpanded:t=!0}){const[i,r]=ne.useState(t);return M.jsxs("div",{className:"mb-0.5",children:[M.jsxs("button",{onClick:()=>r(!i),className:"w-full flex items-center gap-1 py-1 px-1 bg-transparent border-0 outline-none hover:bg-blue-100 transition-colors text-left",children:[M.jsx(_n.span,{animate:{rotate:i?90:0},transition:{duration:.15},className:"text-gray-400",children:M.jsx(TY,{size:14})}),i?M.jsx(jY,{size:16,className:"text-blue-500"}):M.jsx(UY,{size:16,className:"text-blue-500"}),M.jsx("span",{className:"text-sm text-gray-700 font-medium",children:n})]}),M.jsx(Co,{initial:!1,children:i&&M.jsx(_n.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.15},style:{overflow:"hidden"},className:"ml-5",children:e})})]})}function Me({name:n,type:e}){const t=Ss(d=>d.visible[n]),i=Ss(d=>d.loadingState[n]),r=Ss(d=>d.toggleLayer),s=Ss(d=>d.setLayerVisibility),o=i==="loading",a=i==="error",c=()=>{o||(e==="overlay"?r(n):["CartoDB (licht)","CartoDB (donker)","OpenStreetMap","OpenTopoMap","Luchtfoto","TMK 1850","Bonnebladen 1900"].forEach(g=>{s(g,g===n)}))},h=t??!1;return M.jsxs("button",{onClick:c,disabled:o,className:`w-full flex items-center justify-between py-1 pl-3 pr-2 bg-transparent border-0 outline-none transition-colors text-left ${o?"opacity-70 cursor-wait":"hover:bg-blue-100"}`,children:[M.jsxs("span",{className:`text-sm ${a?"text-red-500":"text-gray-600"}`,children:[n,a&&M.jsx(RY,{size:12,className:"inline ml-1 text-red-500"})]}),M.jsx("div",{className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:o?"#93c5fd":h?"#3b82f6":"white",border:o?"2px solid #93c5fd":h?"2px solid #3b82f6":"2px solid #60a5fa",color:"white"},children:o?M.jsx(HY,{size:10,strokeWidth:3,className:"animate-spin"}):h?M.jsx(EY,{size:12,strokeWidth:3}):null})]})}function CZ(){const{themesPanelOpen:n,toggleThemesPanel:e}=Wf();return M.jsx(Co,{children:n&&M.jsxs(_n.div,{className:"fixed top-2.5 right-2.5 z-[999] bg-white rounded-lg shadow-lg overflow-hidden w-[240px] max-h-[calc(100vh-200px)] flex flex-col",initial:{opacity:0,x:10},animate:{opacity:1,x:0},exit:{opacity:0,x:10},transition:{duration:.15},children:[M.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-gradient-to-r from-blue-500 to-blue-600 text-white",children:[M.jsxs("div",{className:"flex items-center gap-2",children:[M.jsx(_3,{size:14}),M.jsx("span",{className:"font-medium text-sm",children:"Kaartlagen"})]}),M.jsx("button",{onClick:e,className:"p-0.5 rounded border-0 outline-none hover:bg-white/20 transition-colors",children:M.jsx(Cc,{size:16})})]}),M.jsxs("div",{className:"p-2 overflow-y-auto flex-1",children:[M.jsxs($i,{title:"Achtergronden",defaultExpanded:!0,children:[M.jsx(Me,{name:"CartoDB (licht)",type:"base"}),M.jsx(Me,{name:"CartoDB (donker)",type:"base"}),M.jsx(Me,{name:"OpenStreetMap",type:"base"}),M.jsx(Me,{name:"OpenTopoMap",type:"base"}),M.jsx(Me,{name:"Luchtfoto",type:"base"}),M.jsx(Me,{name:"Labels Overlay",type:"overlay"}),M.jsx(Me,{name:"TMK 1850",type:"base"}),M.jsx(Me,{name:"Bonnebladen 1900",type:"base"})]}),M.jsxs($i,{title:"Thema's",defaultExpanded:!1,children:[M.jsxs($i,{title:"Steentijd & Prehistorie",defaultExpanded:!1,children:[M.jsx(Me,{name:"Hunebedden",type:"overlay"}),M.jsx(Me,{name:"FAMKE Steentijd",type:"overlay"}),M.jsx(Me,{name:"Grafheuvels",type:"overlay"}),M.jsx(Me,{name:"Terpen",type:"overlay"})]}),M.jsxs($i,{title:"Archeologische lagen",defaultExpanded:!1,children:[M.jsx(Me,{name:"AMK Monumenten",type:"overlay"}),M.jsx(Me,{name:"Romeinse wegen",type:"overlay"}),M.jsx(Me,{name:"Kastelen",type:"overlay"}),M.jsx(Me,{name:"IKAW",type:"overlay"}),M.jsx(Me,{name:"Archeo Landschappen",type:"overlay"})]}),M.jsxs($i,{title:"Erfgoed & Monumenten",defaultExpanded:!1,children:[M.jsx(Me,{name:"Rijksmonumenten",type:"overlay"}),M.jsx(Me,{name:"Werelderfgoed",type:"overlay"})]}),M.jsxs($i,{title:"WOII & Militair",defaultExpanded:!1,children:[M.jsx(Me,{name:"WWII Bunkers",type:"overlay"}),M.jsx(Me,{name:"Slagvelden",type:"overlay"}),M.jsx(Me,{name:"Militaire Vliegvelden",type:"overlay"}),M.jsx(Me,{name:"Verdedigingslinies",type:"overlay"}),M.jsx(Me,{name:"Militaire Objecten",type:"overlay"}),M.jsx(Me,{name:"Inundatiegebieden",type:"overlay"})]}),M.jsxs($i,{title:"Paleokaarten (tijdreizen)",defaultExpanded:!1,children:[M.jsx(Me,{name:"Paleokaart 800 n.Chr.",type:"overlay"}),M.jsx(Me,{name:"Paleokaart 100 n.Chr.",type:"overlay"}),M.jsx(Me,{name:"Paleokaart 500 v.Chr.",type:"overlay"}),M.jsx(Me,{name:"Paleokaart 1500 v.Chr.",type:"overlay"}),M.jsx(Me,{name:"Paleokaart 2750 v.Chr.",type:"overlay"}),M.jsx(Me,{name:"Paleokaart 5500 v.Chr.",type:"overlay"}),M.jsx(Me,{name:"Paleokaart 9000 v.Chr.",type:"overlay"})]}),M.jsx($i,{title:"Religieus Erfgoed",defaultExpanded:!1,children:M.jsx(Me,{name:"Religieus Erfgoed",type:"overlay"})}),M.jsxs($i,{title:"Uiterwaarden (UIKAV)",defaultExpanded:!1,children:[M.jsx(Me,{name:"UIKAV Punten",type:"overlay"}),M.jsx(Me,{name:"UIKAV Vlakken",type:"overlay"}),M.jsx(Me,{name:"UIKAV Expert",type:"overlay"}),M.jsx(Me,{name:"UIKAV Buffer",type:"overlay"}),M.jsx(Me,{name:"UIKAV Indeling",type:"overlay"})]}),M.jsxs($i,{title:"Hillshade & LiDAR",defaultExpanded:!1,children:[M.jsx(Me,{name:"AHN4 Hillshade NL",type:"overlay"}),M.jsx(Me,{name:"AHN4 Multi-Hillshade NL",type:"overlay"}),M.jsx(Me,{name:"AHN4 Helling NL",type:"overlay"}),M.jsx(Me,{name:"AHN 0.5m",type:"overlay"}),M.jsx(Me,{name:"World Hillshade",type:"overlay"})]}),M.jsxs($i,{title:"Terrein & Bodem",defaultExpanded:!1,children:[M.jsx(Me,{name:"Veengebieden",type:"overlay"}),M.jsx(Me,{name:"Geomorfologie",type:"overlay"}),M.jsx(Me,{name:"Bodemkaart",type:"overlay"})]}),M.jsxs($i,{title:"Fossielen (vondsten)",defaultExpanded:!1,children:[M.jsx(Me,{name:"Fossielen Nederland",type:"overlay"}),M.jsx(Me,{name:"Fossielen Belgi",type:"overlay"}),M.jsx(Me,{name:"Fossielen Duitsland",type:"overlay"}),M.jsx(Me,{name:"Fossielen Frankrijk",type:"overlay"})]}),M.jsxs($i,{title:"Recreatie",defaultExpanded:!1,children:[M.jsx(Me,{name:"Parken",type:"overlay"}),M.jsx(Me,{name:"Speeltuinen",type:"overlay"}),M.jsx(Me,{name:"Musea",type:"overlay"}),M.jsx(Me,{name:"Strandjes",type:"overlay"})]})]})]})]})})}function MZ(n){n("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),n("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),n("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs");for(var e=1;e<=60;++e)n("EPSG:"+(32600+e),"+proj=utm +zone="+e+" +datum=WGS84 +units=m"),n("EPSG:"+(32700+e),"+proj=utm +zone="+e+" +south +datum=WGS84 +units=m");n("EPSG:5041","+title=WGS 84 / UPS North (E,N) +proj=stere +lat_0=90 +lon_0=0 +k=0.994 +x_0=2000000 +y_0=2000000 +datum=WGS84 +units=m"),n("EPSG:5042","+title=WGS 84 / UPS South (E,N) +proj=stere +lat_0=-90 +lon_0=0 +k=0.994 +x_0=2000000 +y_0=2000000 +datum=WGS84 +units=m"),n.WGS84=n["EPSG:4326"],n["EPSG:3785"]=n["EPSG:3857"],n.GOOGLE=n["EPSG:3857"],n["EPSG:900913"]=n["EPSG:3857"],n["EPSG:102113"]=n["EPSG:3857"]}var vc=1,Ec=2,rh=3,bZ=4,Nw=5,IM=6378137,kZ=6356752314e-3,AM=.0066943799901413165,If=484813681109536e-20,se=Math.PI/2,LZ=.16666666666666666,NZ=.04722222222222222,DZ=.022156084656084655,ge=1e-10,qt=.017453292519943295,ki=57.29577951308232,mt=Math.PI/4,fg=Math.PI*2,nn=3.14159265359,Ni={};Ni.greenwich=0;Ni.lisbon=-9.131906111111;Ni.paris=2.337229166667;Ni.bogota=-74.080916666667;Ni.madrid=-3.687938888889;Ni.rome=12.452333333333;Ni.bern=7.439583333333;Ni.jakarta=106.807719444444;Ni.ferro=-17.666666666667;Ni.brussels=4.367975;Ni.stockholm=18.058277777778;Ni.athens=23.7163375;Ni.oslo=10.722916666667;const OZ={mm:{to_meter:.001},cm:{to_meter:.01},ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937},fath:{to_meter:1.8288},kmi:{to_meter:1852},"us-ch":{to_meter:20.1168402336805},"us-mi":{to_meter:1609.34721869444},km:{to_meter:1e3},"ind-ft":{to_meter:.30479841},"ind-yd":{to_meter:.91439523},mi:{to_meter:1609.344},yd:{to_meter:.9144},ch:{to_meter:20.1168},link:{to_meter:.201168},dm:{to_meter:.1},in:{to_meter:.0254},"ind-ch":{to_meter:20.11669506},"us-in":{to_meter:.025400050800101},"us-yd":{to_meter:.914401828803658}};var RM=/[\s_\-\/\(\)]/g;function Wa(n,e){if(n[e])return n[e];for(var t=Object.keys(n),i=e.toLowerCase().replace(RM,""),r=-1,s,o;++r<t.length;)if(s=t[r],o=s.toLowerCase().replace(RM,""),o===i)return n[s]}function Dw(n){var e={},t=n.split("+").map(function(a){return a.trim()}).filter(function(a){return a}).reduce(function(a,c){var h=c.split("=");return h.push(!0),a[h[0].toLowerCase()]=h[1],a},{}),i,r,s,o={proj:"projName",datum:"datumCode",rf:function(a){e.rf=parseFloat(a)},lat_0:function(a){e.lat0=a*qt},lat_1:function(a){e.lat1=a*qt},lat_2:function(a){e.lat2=a*qt},lat_ts:function(a){e.lat_ts=a*qt},lon_0:function(a){e.long0=a*qt},lon_1:function(a){e.long1=a*qt},lon_2:function(a){e.long2=a*qt},alpha:function(a){e.alpha=parseFloat(a)*qt},gamma:function(a){e.rectified_grid_angle=parseFloat(a)*qt},lonc:function(a){e.longc=a*qt},x_0:function(a){e.x0=parseFloat(a)},y_0:function(a){e.y0=parseFloat(a)},k_0:function(a){e.k0=parseFloat(a)},k:function(a){e.k0=parseFloat(a)},a:function(a){e.a=parseFloat(a)},b:function(a){e.b=parseFloat(a)},r:function(a){e.a=e.b=parseFloat(a)},r_a:function(){e.R_A=!0},zone:function(a){e.zone=parseInt(a,10)},south:function(){e.utmSouth=!0},towgs84:function(a){e.datum_params=a.split(",").map(function(c){return parseFloat(c)})},to_meter:function(a){e.to_meter=parseFloat(a)},units:function(a){e.units=a;var c=Wa(OZ,a);c&&(e.to_meter=c.to_meter)},from_greenwich:function(a){e.from_greenwich=a*qt},pm:function(a){var c=Wa(Ni,a);e.from_greenwich=(c||parseFloat(a))*qt},nadgrids:function(a){a==="@null"?e.datumCode="none":e.nadgrids=a},axis:function(a){var c="ewnsud";a.length===3&&c.indexOf(a.substr(0,1))!==-1&&c.indexOf(a.substr(1,1))!==-1&&c.indexOf(a.substr(2,1))!==-1&&(e.axis=a)},approx:function(){e.approx=!0},over:function(){e.over=!0}};for(i in t)r=t[i],i in o?(s=o[i],typeof s=="function"?s(r):e[s]=r):e[i]=r;return typeof e.datumCode=="string"&&e.datumCode!=="WGS84"&&(e.datumCode=e.datumCode.toLowerCase()),e.projStr=n,e}class x3{static getId(e){const t=e.find(i=>Array.isArray(i)&&i[0]==="ID");return t&&t.length>=3?{authority:t[1],code:parseInt(t[2],10)}:null}static convertUnit(e,t="unit"){if(!e||e.length<3)return{type:t,name:"unknown",conversion_factor:null};const i=e[1],r=parseFloat(e[2])||null,s=e.find(a=>Array.isArray(a)&&a[0]==="ID"),o=s?{authority:s[1],code:parseInt(s[2],10)}:null;return{type:t,name:i,conversion_factor:r,id:o}}static convertAxis(e){const t=e[1]||"Unknown";let i;const r=t.match(/^\((.)\)$/);if(r){const h=r[1].toUpperCase();if(h==="E")i="east";else if(h==="N")i="north";else if(h==="U")i="up";else throw new Error(`Unknown axis abbreviation: ${h}`)}else i=e[2]?e[2].toLowerCase():"unknown";const s=e.find(h=>Array.isArray(h)&&h[0]==="ORDER"),o=s?parseInt(s[1],10):null,a=e.find(h=>Array.isArray(h)&&(h[0]==="LENGTHUNIT"||h[0]==="ANGLEUNIT"||h[0]==="SCALEUNIT")),c=this.convertUnit(a);return{name:t,direction:i,unit:c,order:o}}static extractAxes(e){return e.filter(t=>Array.isArray(t)&&t[0]==="AXIS").map(t=>this.convertAxis(t)).sort((t,i)=>(t.order||0)-(i.order||0))}static convert(e,t={}){switch(e[0]){case"PROJCRS":t.type="ProjectedCRS",t.name=e[1],t.base_crs=e.find(m=>Array.isArray(m)&&m[0]==="BASEGEOGCRS")?this.convert(e.find(m=>Array.isArray(m)&&m[0]==="BASEGEOGCRS")):null,t.conversion=e.find(m=>Array.isArray(m)&&m[0]==="CONVERSION")?this.convert(e.find(m=>Array.isArray(m)&&m[0]==="CONVERSION")):null;const i=e.find(m=>Array.isArray(m)&&m[0]==="CS");i&&(t.coordinate_system={type:i[1],axis:this.extractAxes(e)});const r=e.find(m=>Array.isArray(m)&&m[0]==="LENGTHUNIT");if(r){const m=this.convertUnit(r);t.coordinate_system.unit=m}t.id=this.getId(e);break;case"BASEGEOGCRS":case"GEOGCRS":t.type="GeographicCRS",t.name=e[1];const s=e.find(m=>Array.isArray(m)&&(m[0]==="DATUM"||m[0]==="ENSEMBLE"));if(s){const m=this.convert(s);s[0]==="ENSEMBLE"?t.datum_ensemble=m:t.datum=m;const v=e.find(y=>Array.isArray(y)&&y[0]==="PRIMEM");v&&v[1]!=="Greenwich"&&(m.prime_meridian={name:v[1],longitude:parseFloat(v[2])})}t.coordinate_system={type:"ellipsoidal",axis:this.extractAxes(e)},t.id=this.getId(e);break;case"DATUM":t.type="GeodeticReferenceFrame",t.name=e[1],t.ellipsoid=e.find(m=>Array.isArray(m)&&m[0]==="ELLIPSOID")?this.convert(e.find(m=>Array.isArray(m)&&m[0]==="ELLIPSOID")):null;break;case"ENSEMBLE":t.type="DatumEnsemble",t.name=e[1],t.members=e.filter(m=>Array.isArray(m)&&m[0]==="MEMBER").map(m=>({type:"DatumEnsembleMember",name:m[1],id:this.getId(m)}));const o=e.find(m=>Array.isArray(m)&&m[0]==="ENSEMBLEACCURACY");o&&(t.accuracy=parseFloat(o[1]));const a=e.find(m=>Array.isArray(m)&&m[0]==="ELLIPSOID");a&&(t.ellipsoid=this.convert(a)),t.id=this.getId(e);break;case"ELLIPSOID":t.type="Ellipsoid",t.name=e[1],t.semi_major_axis=parseFloat(e[2]),t.inverse_flattening=parseFloat(e[3]),e.find(m=>Array.isArray(m)&&m[0]==="LENGTHUNIT")&&this.convert(e.find(m=>Array.isArray(m)&&m[0]==="LENGTHUNIT"),t);break;case"CONVERSION":t.type="Conversion",t.name=e[1],t.method=e.find(m=>Array.isArray(m)&&m[0]==="METHOD")?this.convert(e.find(m=>Array.isArray(m)&&m[0]==="METHOD")):null,t.parameters=e.filter(m=>Array.isArray(m)&&m[0]==="PARAMETER").map(m=>this.convert(m));break;case"METHOD":t.type="Method",t.name=e[1],t.id=this.getId(e);break;case"PARAMETER":t.type="Parameter",t.name=e[1],t.value=parseFloat(e[2]),t.unit=this.convertUnit(e.find(m=>Array.isArray(m)&&(m[0]==="LENGTHUNIT"||m[0]==="ANGLEUNIT"||m[0]==="SCALEUNIT"))),t.id=this.getId(e);break;case"BOUNDCRS":t.type="BoundCRS";const c=e.find(m=>Array.isArray(m)&&m[0]==="SOURCECRS");if(c){const m=c.find(v=>Array.isArray(v));t.source_crs=m?this.convert(m):null}const h=e.find(m=>Array.isArray(m)&&m[0]==="TARGETCRS");if(h){const m=h.find(v=>Array.isArray(v));t.target_crs=m?this.convert(m):null}const d=e.find(m=>Array.isArray(m)&&m[0]==="ABRIDGEDTRANSFORMATION");d?t.transformation=this.convert(d):t.transformation=null;break;case"ABRIDGEDTRANSFORMATION":if(t.type="Transformation",t.name=e[1],t.method=e.find(m=>Array.isArray(m)&&m[0]==="METHOD")?this.convert(e.find(m=>Array.isArray(m)&&m[0]==="METHOD")):null,t.parameters=e.filter(m=>Array.isArray(m)&&(m[0]==="PARAMETER"||m[0]==="PARAMETERFILE")).map(m=>{if(m[0]==="PARAMETER")return this.convert(m);if(m[0]==="PARAMETERFILE")return{name:m[1],value:m[2],id:{authority:"EPSG",code:8656}}}),t.parameters.length===7){const m=t.parameters[6];m.name==="Scale difference"&&(m.value=Math.round((m.value-1)*1e12)/1e6)}t.id=this.getId(e);break;case"AXIS":t.coordinate_system||(t.coordinate_system={type:"unspecified",axis:[]}),t.coordinate_system.axis.push(this.convertAxis(e));break;case"LENGTHUNIT":const g=this.convertUnit(e,"LinearUnit");t.coordinate_system&&t.coordinate_system.axis&&t.coordinate_system.axis.forEach(m=>{m.unit||(m.unit=g)}),g.conversion_factor&&g.conversion_factor!==1&&t.semi_major_axis&&(t.semi_major_axis={value:t.semi_major_axis,unit:g});break;default:t.keyword=e[0];break}return t}}class VZ extends x3{static convert(e,t={}){return super.convert(e,t),t.coordinate_system&&t.coordinate_system.subtype==="Cartesian"&&delete t.coordinate_system,t.usage&&delete t.usage,t}}class FZ extends x3{static convert(e,t={}){super.convert(e,t);const i=e.find(s=>Array.isArray(s)&&s[0]==="CS");i&&(t.coordinate_system={subtype:i[1],axis:this.extractAxes(e)});const r=e.find(s=>Array.isArray(s)&&s[0]==="USAGE");if(r){const s=r.find(c=>Array.isArray(c)&&c[0]==="SCOPE"),o=r.find(c=>Array.isArray(c)&&c[0]==="AREA"),a=r.find(c=>Array.isArray(c)&&c[0]==="BBOX");t.usage={},s&&(t.usage.scope=s[1]),o&&(t.usage.area=o[1]),a&&(t.usage.bbox=a.slice(1))}return t}}function jZ(n){return n.find(e=>Array.isArray(e)&&e[0]==="USAGE")?"2019":(n.find(e=>Array.isArray(e)&&e[0]==="CS")||n[0]==="BOUNDCRS"||n[0]==="PROJCRS"||n[0]==="GEOGCRS","2015")}function GZ(n){return(jZ(n)==="2019"?FZ:VZ).convert(n)}function UZ(n){const e=n.toUpperCase();return e.includes("PROJCRS")||e.includes("GEOGCRS")||e.includes("BOUNDCRS")||e.includes("VERTCRS")||e.includes("LENGTHUNIT")||e.includes("ANGLEUNIT")||e.includes("SCALEUNIT")?"WKT2":(e.includes("PROJCS")||e.includes("GEOGCS")||e.includes("LOCAL_CS")||e.includes("VERT_CS")||e.includes("UNIT"),"WKT1")}var gg=1,S3=2,T3=3,u_=4,I3=5,fT=-1,zZ=/\s/,BZ=/[A-Za-z]/,$Z=/[A-Za-z84_]/,wy=/[,\]]/,A3=/[\d\.E\-\+]/;function Mo(n){if(typeof n!="string")throw new Error("not a string");this.text=n.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=gg}Mo.prototype.readCharicter=function(){var n=this.text[this.place++];if(this.state!==u_)for(;zZ.test(n);){if(this.place>=this.text.length)return;n=this.text[this.place++]}switch(this.state){case gg:return this.neutral(n);case S3:return this.keyword(n);case u_:return this.quoted(n);case I3:return this.afterquote(n);case T3:return this.number(n);case fT:return}};Mo.prototype.afterquote=function(n){if(n==='"'){this.word+='"',this.state=u_;return}if(wy.test(n)){this.word=this.word.trim(),this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in afterquote yet, index '+this.place)};Mo.prototype.afterItem=function(n){if(n===","){this.word!==null&&this.currentObject.push(this.word),this.word=null,this.state=gg;return}if(n==="]"){this.level--,this.word!==null&&(this.currentObject.push(this.word),this.word=null),this.state=gg,this.currentObject=this.stack.pop(),this.currentObject||(this.state=fT);return}};Mo.prototype.number=function(n){if(A3.test(n)){this.word+=n;return}if(wy.test(n)){this.word=parseFloat(this.word),this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in number yet, index '+this.place)};Mo.prototype.quoted=function(n){if(n==='"'){this.state=I3;return}this.word+=n};Mo.prototype.keyword=function(n){if($Z.test(n)){this.word+=n;return}if(n==="["){var e=[];e.push(this.word),this.level++,this.root===null?this.root=e:this.currentObject.push(e),this.stack.push(this.currentObject),this.currentObject=e,this.state=gg;return}if(wy.test(n)){this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in keyword yet, index '+this.place)};Mo.prototype.neutral=function(n){if(BZ.test(n)){this.word=n,this.state=S3;return}if(n==='"'){this.word="",this.state=u_;return}if(A3.test(n)){this.word=n,this.state=T3;return}if(wy.test(n)){this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in neutral yet, index '+this.place)};Mo.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(this.state===fT)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};function WZ(n){var e=new Mo(n);return e.output()}function eE(n,e,t){Array.isArray(e)&&(t.unshift(e),e=null);var i=e?{}:n,r=t.reduce(function(s,o){return Bu(o,s),s},i);e&&(n[e]=r)}function Bu(n,e){if(!Array.isArray(n)){e[n]=!0;return}var t=n.shift();if(t==="PARAMETER"&&(t=n.shift()),n.length===1){if(Array.isArray(n[0])){e[t]={},Bu(n[0],e[t]);return}e[t]=n[0];return}if(!n.length){e[t]=!0;return}if(t==="TOWGS84"){e[t]=n;return}if(t==="AXIS"){t in e||(e[t]=[]),e[t].push(n);return}Array.isArray(t)||(e[t]={});var i;switch(t){case"UNIT":case"PRIMEM":case"VERT_DATUM":e[t]={name:n[0].toLowerCase(),convert:n[1]},n.length===3&&Bu(n[2],e[t]);return;case"SPHEROID":case"ELLIPSOID":e[t]={name:n[0],a:n[1],rf:n[2]},n.length===4&&Bu(n[3],e[t]);return;case"EDATUM":case"ENGINEERINGDATUM":case"LOCAL_DATUM":case"DATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":n[0]=["name",n[0]],eE(e,t,n);return;case"COMPD_CS":case"COMPOUNDCRS":case"FITTED_CS":case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"ENGCRS":case"ENGINEERINGCRS":n[0]=["name",n[0]],eE(e,t,n),e[t].type=t;return;default:for(i=-1;++i<n.length;)if(!Array.isArray(n[i]))return Bu(n,e[t]);return eE(e,t,n)}}var KZ=.017453292519943295;function Gr(n){return n*KZ}function R3(n){const e=(n.projName||"").toLowerCase().replace(/_/g," ");!n.long0&&n.longc&&(e==="albers conic equal area"||e==="lambert azimuthal equal area")&&(n.long0=n.longc),!n.lat_ts&&n.lat1&&(e==="stereographic south pole"||e==="polar stereographic (variant b)")?(n.lat0=Gr(n.lat1>0?90:-90),n.lat_ts=n.lat1,delete n.lat1):!n.lat_ts&&n.lat0&&(e==="polar stereographic"||e==="polar stereographic (variant a)")&&(n.lat_ts=n.lat0,n.lat0=Gr(n.lat0>0?90:-90),delete n.lat1)}function PM(n){let e={units:null,to_meter:void 0};return typeof n=="string"?(e.units=n.toLowerCase(),e.units==="metre"&&(e.units="meter"),e.units==="meter"&&(e.to_meter=1)):n&&n.name&&(e.units=n.name.toLowerCase(),e.units==="metre"&&(e.units="meter"),e.to_meter=n.conversion_factor),e}function CM(n){return typeof n=="object"?n.value*n.unit.conversion_factor:n}function MM(n,e){n.ellipsoid.radius?(e.a=n.ellipsoid.radius,e.rf=0):(e.a=CM(n.ellipsoid.semi_major_axis),n.ellipsoid.inverse_flattening!==void 0?e.rf=n.ellipsoid.inverse_flattening:n.ellipsoid.semi_major_axis!==void 0&&n.ellipsoid.semi_minor_axis!==void 0&&(e.rf=e.a/(e.a-CM(n.ellipsoid.semi_minor_axis))))}function h_(n,e={}){return!n||typeof n!="object"?n:n.type==="BoundCRS"?(h_(n.source_crs,e),n.transformation&&(n.transformation.method&&n.transformation.method.name==="NTv2"?e.nadgrids=n.transformation.parameters[0].value:e.datum_params=n.transformation.parameters.map(t=>t.value)),e):(Object.keys(n).forEach(t=>{const i=n[t];if(i!==null)switch(t){case"name":if(e.srsCode)break;e.name=i,e.srsCode=i;break;case"type":i==="GeographicCRS"?e.projName="longlat":i==="ProjectedCRS"&&n.conversion&&n.conversion.method&&(e.projName=n.conversion.method.name);break;case"datum":case"datum_ensemble":i.ellipsoid&&(e.ellps=i.ellipsoid.name,MM(i,e)),i.prime_meridian&&(e.from_greenwich=i.prime_meridian.longitude*Math.PI/180);break;case"ellipsoid":e.ellps=i.name,MM(i,e);break;case"prime_meridian":e.long0=(i.longitude||0)*Math.PI/180;break;case"coordinate_system":if(i.axis){if(e.axis=i.axis.map(r=>{const s=r.direction;if(s==="east")return"e";if(s==="north")return"n";if(s==="west")return"w";if(s==="south")return"s";throw new Error(`Unknown axis direction: ${s}`)}).join("")+"u",i.unit){const{units:r,to_meter:s}=PM(i.unit);e.units=r,e.to_meter=s}else if(i.axis[0]&&i.axis[0].unit){const{units:r,to_meter:s}=PM(i.axis[0].unit);e.units=r,e.to_meter=s}}break;case"id":i.authority&&i.code&&(e.title=i.authority+":"+i.code);break;case"conversion":i.method&&i.method.name&&(e.projName=i.method.name),i.parameters&&i.parameters.forEach(r=>{const s=r.name.toLowerCase().replace(/\s+/g,"_"),o=r.value;r.unit&&r.unit.conversion_factor?e[s]=o*r.unit.conversion_factor:r.unit==="degree"?e[s]=o*Math.PI/180:e[s]=o});break;case"unit":i.name&&(e.units=i.name.toLowerCase(),e.units==="metre"&&(e.units="meter")),i.conversion_factor&&(e.to_meter=i.conversion_factor);break;case"base_crs":h_(i,e),e.datumCode=i.id?i.id.authority+"_"+i.id.code:i.name;break}}),e.latitude_of_false_origin!==void 0&&(e.lat0=e.latitude_of_false_origin),e.longitude_of_false_origin!==void 0&&(e.long0=e.longitude_of_false_origin),e.latitude_of_standard_parallel!==void 0&&(e.lat0=e.latitude_of_standard_parallel,e.lat1=e.latitude_of_standard_parallel),e.latitude_of_1st_standard_parallel!==void 0&&(e.lat1=e.latitude_of_1st_standard_parallel),e.latitude_of_2nd_standard_parallel!==void 0&&(e.lat2=e.latitude_of_2nd_standard_parallel),e.latitude_of_projection_centre!==void 0&&(e.lat0=e.latitude_of_projection_centre),e.longitude_of_projection_centre!==void 0&&(e.longc=e.longitude_of_projection_centre),e.easting_at_false_origin!==void 0&&(e.x0=e.easting_at_false_origin),e.northing_at_false_origin!==void 0&&(e.y0=e.northing_at_false_origin),e.latitude_of_natural_origin!==void 0&&(e.lat0=e.latitude_of_natural_origin),e.longitude_of_natural_origin!==void 0&&(e.long0=e.longitude_of_natural_origin),e.longitude_of_origin!==void 0&&(e.long0=e.longitude_of_origin),e.false_easting!==void 0&&(e.x0=e.false_easting),e.easting_at_projection_centre&&(e.x0=e.easting_at_projection_centre),e.false_northing!==void 0&&(e.y0=e.false_northing),e.northing_at_projection_centre&&(e.y0=e.northing_at_projection_centre),e.standard_parallel_1!==void 0&&(e.lat1=e.standard_parallel_1),e.standard_parallel_2!==void 0&&(e.lat2=e.standard_parallel_2),e.scale_factor_at_natural_origin!==void 0&&(e.k0=e.scale_factor_at_natural_origin),e.scale_factor_at_projection_centre!==void 0&&(e.k0=e.scale_factor_at_projection_centre),e.scale_factor_on_pseudo_standard_parallel!==void 0&&(e.k0=e.scale_factor_on_pseudo_standard_parallel),e.azimuth!==void 0&&(e.alpha=e.azimuth),e.azimuth_at_projection_centre!==void 0&&(e.alpha=e.azimuth_at_projection_centre),e.angle_from_rectified_to_skew_grid&&(e.rectified_grid_angle=e.angle_from_rectified_to_skew_grid),R3(e),e)}var qZ=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function HZ(n,e){var t=e[0],i=e[1];!(t in n)&&i in n&&(n[t]=n[i],e.length===3&&(n[t]=e[2](n[t])))}function P3(n){for(var e=Object.keys(n),t=0,i=e.length;t<i;++t){var r=e[t];qZ.indexOf(r)!==-1&&XZ(n[r]),typeof n[r]=="object"&&P3(n[r])}}function XZ(n){if(n.AUTHORITY){var e=Object.keys(n.AUTHORITY)[0];e&&e in n.AUTHORITY&&(n.title=e+":"+n.AUTHORITY[e])}if(n.type==="GEOGCS"?n.projName="longlat":n.type==="LOCAL_CS"?(n.projName="identity",n.local=!0):typeof n.PROJECTION=="object"?n.projName=Object.keys(n.PROJECTION)[0]:n.projName=n.PROJECTION,n.AXIS){for(var t="",i=0,r=n.AXIS.length;i<r;++i){var s=[n.AXIS[i][0].toLowerCase(),n.AXIS[i][1].toLowerCase()];s[0].indexOf("north")!==-1||(s[0]==="y"||s[0]==="lat")&&s[1]==="north"?t+="n":s[0].indexOf("south")!==-1||(s[0]==="y"||s[0]==="lat")&&s[1]==="south"?t+="s":s[0].indexOf("east")!==-1||(s[0]==="x"||s[0]==="lon")&&s[1]==="east"?t+="e":(s[0].indexOf("west")!==-1||(s[0]==="x"||s[0]==="lon")&&s[1]==="west")&&(t+="w")}t.length===2&&(t+="u"),t.length===3&&(n.axis=t)}n.UNIT&&(n.units=n.UNIT.name.toLowerCase(),n.units==="metre"&&(n.units="meter"),n.UNIT.convert&&(n.type==="GEOGCS"?n.DATUM&&n.DATUM.SPHEROID&&(n.to_meter=n.UNIT.convert*n.DATUM.SPHEROID.a):n.to_meter=n.UNIT.convert));var o=n.GEOGCS;n.type==="GEOGCS"&&(o=n),o&&(o.DATUM?n.datumCode=o.DATUM.name.toLowerCase():n.datumCode=o.name.toLowerCase(),n.datumCode.slice(0,2)==="d_"&&(n.datumCode=n.datumCode.slice(2)),n.datumCode==="new_zealand_1949"&&(n.datumCode="nzgd49"),(n.datumCode==="wgs_1984"||n.datumCode==="world_geodetic_system_1984")&&(n.PROJECTION==="Mercator_Auxiliary_Sphere"&&(n.sphere=!0),n.datumCode="wgs84"),n.datumCode==="belge_1972"&&(n.datumCode="rnb72"),o.DATUM&&o.DATUM.SPHEROID&&(n.ellps=o.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),n.ellps.toLowerCase().slice(0,13)==="international"&&(n.ellps="intl"),n.a=o.DATUM.SPHEROID.a,n.rf=parseFloat(o.DATUM.SPHEROID.rf,10)),o.DATUM&&o.DATUM.TOWGS84&&(n.datum_params=o.DATUM.TOWGS84),~n.datumCode.indexOf("osgb_1936")&&(n.datumCode="osgb36"),~n.datumCode.indexOf("osni_1952")&&(n.datumCode="osni52"),(~n.datumCode.indexOf("tm65")||~n.datumCode.indexOf("geodetic_datum_of_1965"))&&(n.datumCode="ire65"),n.datumCode==="ch1903+"&&(n.datumCode="ch1903"),~n.datumCode.indexOf("israel")&&(n.datumCode="isr93")),n.b&&!isFinite(n.b)&&(n.b=n.a),n.rectified_grid_angle&&(n.rectified_grid_angle=Gr(n.rectified_grid_angle));function a(d){var g=n.to_meter||1;return d*g}var c=function(d){return HZ(n,d)},h=[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",Gr],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",Gr],["x0","false_easting",a],["y0","false_northing",a],["long0","central_meridian",Gr],["lat0","latitude_of_origin",Gr],["lat0","standard_parallel_1",Gr],["lat1","standard_parallel_1",Gr],["lat2","standard_parallel_2",Gr],["azimuth","Azimuth"],["alpha","azimuth",Gr],["srsCode","name"]];h.forEach(c),R3(n)}function d_(n){if(typeof n=="object")return h_(n);const e=UZ(n);var t=WZ(n);if(e==="WKT2"){const s=GZ(t);return h_(s)}var i=t[0],r={};return Bu(t,r),P3(r),r[i]}function On(n){var e=this;if(arguments.length===2){var t=arguments[1];typeof t=="string"?t.charAt(0)==="+"?On[n]=Dw(arguments[1]):On[n]=d_(arguments[1]):t&&typeof t=="object"&&!("projName"in t)?On[n]=d_(arguments[1]):(On[n]=t,t||delete On[n])}else if(arguments.length===1){if(Array.isArray(n))return n.map(function(i){return Array.isArray(i)?On.apply(e,i):On(i)});if(typeof n=="string"){if(n in On)return On[n]}else"EPSG"in n?On["EPSG:"+n.EPSG]=n:"ESRI"in n?On["ESRI:"+n.ESRI]=n:"IAU2000"in n?On["IAU2000:"+n.IAU2000]=n:console.log(n);return}}MZ(On);function YZ(n){return typeof n=="string"}function ZZ(n){return n in On}function QZ(n){return n.indexOf("+")!==0&&n.indexOf("[")!==-1||typeof n=="object"&&!("srsCode"in n)}var JZ=["3857","900913","3785","102113"];function eQ(n){var e=Wa(n,"authority");if(e){var t=Wa(e,"epsg");return t&&JZ.indexOf(t)>-1}}function tQ(n){var e=Wa(n,"extension");if(e)return Wa(e,"proj4")}function nQ(n){return n[0]==="+"}function iQ(n){if(YZ(n)){if(ZZ(n))return On[n];if(QZ(n)){var e=d_(n);if(eQ(e))return On["EPSG:3857"];var t=tQ(e);return t?Dw(t):e}if(nQ(n))return Dw(n)}else return"projName"in n?n:d_(n)}function bM(n,e){n=n||{};var t,i;if(!e)return n;for(i in e)t=e[i],t!==void 0&&(n[i]=t);return n}function Ds(n,e,t){var i=n*e;return t/Math.sqrt(1-i*i)}function Hg(n){return n<0?-1:1}function _e(n,e){return e||Math.abs(n)<=nn?n:n-Hg(n)*fg}function Xr(n,e,t){var i=n*t,r=.5*n;return i=Math.pow((1-i)/(1+i),r),Math.tan(.5*(se-e))/i}function mg(n,e){for(var t=.5*n,i,r,s=se-2*Math.atan(e),o=0;o<=15;o++)if(i=n*Math.sin(s),r=se-2*Math.atan(e*Math.pow((1-i)/(1+i),t))-s,s+=r,Math.abs(r)<=1e-10)return s;return-9999}function rQ(){var n=this.b/this.a;this.es=1-n*n,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=Ds(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)}function sQ(n){var e=n.x,t=n.y;if(t*ki>90&&t*ki<-90&&e*ki>180&&e*ki<-180)return null;var i,r;if(Math.abs(Math.abs(t)-se)<=ge)return null;if(this.sphere)i=this.x0+this.a*this.k0*_e(e-this.long0,this.over),r=this.y0+this.a*this.k0*Math.log(Math.tan(mt+.5*t));else{var s=Math.sin(t),o=Xr(this.e,t,s);i=this.x0+this.a*this.k0*_e(e-this.long0,this.over),r=this.y0-this.a*this.k0*Math.log(o)}return n.x=i,n.y=r,n}function oQ(n){var e=n.x-this.x0,t=n.y-this.y0,i,r;if(this.sphere)r=se-2*Math.atan(Math.exp(-t/(this.a*this.k0)));else{var s=Math.exp(-t/(this.a*this.k0));if(r=mg(this.e,s),r===-9999)return null}return i=_e(this.long0+e/(this.a*this.k0),this.over),n.x=i,n.y=r,n}var aQ=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","Mercator_Variant_A","merc"];const lQ={init:rQ,forward:sQ,inverse:oQ,names:aQ};function cQ(){}function kM(n){return n}var C3=["longlat","identity"];const uQ={init:cQ,forward:kM,inverse:kM,names:C3};var hQ=[lQ,uQ],Dl={},$u=[];function M3(n,e){var t=$u.length;return n.names?($u[t]=n,n.names.forEach(function(i){Dl[i.toLowerCase()]=t}),this):(console.log(e),!0)}function b3(n){return n.replace(/[-\(\)\s]+/g," ").trim().replace(/ /g,"_")}function dQ(n){if(!n)return!1;var e=n.toLowerCase();if(typeof Dl[e]<"u"&&$u[Dl[e]]||(e=b3(e),e in Dl&&$u[Dl[e]]))return $u[Dl[e]]}function fQ(){hQ.forEach(M3)}const gQ={start:fQ,add:M3,get:dQ};var k3={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563396e-3,b:635625691e-2,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340189e-3,b:6356034446e-3,ellipseName:"Modified Airy"},andrae:{a:637710443e-2,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397155e-3,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483865e-3,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:63782064e-1,b:63565838e-1,ellipseName:"Clarke 1866"},clrk80:{a:6378249145e-3,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk80ign:{a:63782492e-1,b:6356515,rf:293.4660213,ellipseName:"Clarke 1880 (IGN)"},clrk58:{a:6378293645208759e-9,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:63757387e-1,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:637813605e-2,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276345e-3,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304063e-3,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301243e-3,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295664e-3,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298556e-3,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:63781575e-1,b:63567722e-1,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:63567733205e-4,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:63558348467e-4,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"},WGS84:{a:6378137,rf:298.257223563,ellipseName:"WGS 84"},sphere:{a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"}};const mQ=k3.WGS84;function pQ(n,e,t,i){var r=n*n,s=e*e,o=(r-s)/r,a=0;i?(n*=1-o*(LZ+o*(NZ+o*DZ)),r=n*n,o=0):a=Math.sqrt(o);var c=(r-s)/s;return{es:o,e:a,ep2:c}}function _Q(n,e,t,i,r){if(!n){var s=Wa(k3,i);s||(s=mQ),n=s.a,e=s.b,t=s.rf}return t&&!e&&(e=(1-1/t)*n),(t===0||Math.abs(n-e)<ge)&&(r=!0,e=n),{a:n,b:e,rf:t,sphere:r}}var s0={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},mgi:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Militar-Geographische Institut"},osni52:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Ordnance Survey of Great Britain 1936"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"},EPSG_5451:{towgs84:"6.41,-49.05,-11.28,1.5657,0.5242,6.9718,-5.7649"},IGNF_LURESG:{towgs84:"-192.986,13.673,-39.309,-0.4099,-2.9332,2.6881,0.43"},EPSG_4614:{towgs84:"-119.4248,-303.65872,-11.00061,1.164298,0.174458,1.096259,3.657065"},EPSG_4615:{towgs84:"-494.088,-312.129,279.877,-1.423,-1.013,1.59,-0.748"},ESRI_37241:{towgs84:"-76.822,257.457,-12.817,2.136,-0.033,-2.392,-0.031"},ESRI_37249:{towgs84:"-440.296,58.548,296.265,1.128,10.202,4.559,-0.438"},ESRI_37245:{towgs84:"-511.151,-181.269,139.609,1.05,2.703,1.798,3.071"},EPSG_4178:{towgs84:"24.9,-126.4,-93.2,-0.063,-0.247,-0.041,1.01"},EPSG_4622:{towgs84:"-472.29,-5.63,-304.12,0.4362,-0.8374,0.2563,1.8984"},EPSG_4625:{towgs84:"126.93,547.94,130.41,-2.7867,5.1612,-0.8584,13.8227"},EPSG_5252:{towgs84:"0.023,0.036,-0.068,0.00176,0.00912,-0.01136,0.00439"},EPSG_4314:{towgs84:"597.1,71.4,412.1,0.894,0.068,-1.563,7.58"},EPSG_4282:{towgs84:"-178.3,-316.7,-131.5,5.278,6.077,10.979,19.166"},EPSG_4231:{towgs84:"-83.11,-97.38,-117.22,0.0276,-0.2167,0.2147,0.1218"},EPSG_4274:{towgs84:"-230.994,102.591,25.199,0.633,-0.239,0.9,1.95"},EPSG_4134:{towgs84:"-180.624,-225.516,173.919,-0.81,-1.898,8.336,16.71006"},EPSG_4254:{towgs84:"18.38,192.45,96.82,0.056,-0.142,-0.2,-0.0013"},EPSG_4159:{towgs84:"-194.513,-63.978,-25.759,-3.4027,3.756,-3.352,-0.9175"},EPSG_4687:{towgs84:"0.072,-0.507,-0.245,0.0183,-0.0003,0.007,-0.0093"},EPSG_4227:{towgs84:"-83.58,-397.54,458.78,-17.595,-2.847,4.256,3.225"},EPSG_4746:{towgs84:"599.4,72.4,419.2,-0.062,-0.022,-2.723,6.46"},EPSG_4745:{towgs84:"612.4,77,440.2,-0.054,0.057,-2.797,2.55"},EPSG_6311:{towgs84:"8.846,-4.394,-1.122,-0.00237,-0.146528,0.130428,0.783926"},EPSG_4289:{towgs84:"565.7381,50.4018,465.2904,-1.91514,1.60363,-9.09546,4.07244"},EPSG_4230:{towgs84:"-68.863,-134.888,-111.49,-0.53,-0.14,0.57,-3.4"},EPSG_4154:{towgs84:"-123.02,-158.95,-168.47"},EPSG_4156:{towgs84:"570.8,85.7,462.8,4.998,1.587,5.261,3.56"},EPSG_4299:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4179:{towgs84:"33.4,-146.6,-76.3,-0.359,-0.053,0.844,-0.84"},EPSG_4313:{towgs84:"-106.8686,52.2978,-103.7239,0.3366,-0.457,1.8422,-1.2747"},EPSG_4194:{towgs84:"163.511,127.533,-159.789"},EPSG_4195:{towgs84:"105,326,-102.5"},EPSG_4196:{towgs84:"-45,417,-3.5"},EPSG_4611:{towgs84:"-162.619,-276.959,-161.764,0.067753,-2.243649,-1.158827,-1.094246"},EPSG_4633:{towgs84:"137.092,131.66,91.475,-1.9436,-11.5993,-4.3321,-7.4824"},EPSG_4641:{towgs84:"-408.809,366.856,-412.987,1.8842,-0.5308,2.1655,-121.0993"},EPSG_4643:{towgs84:"-480.26,-438.32,-643.429,16.3119,20.1721,-4.0349,-111.7002"},EPSG_4300:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4188:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4660:{towgs84:"982.6087,552.753,-540.873,32.39344,-153.25684,-96.2266,16.805"},EPSG_4662:{towgs84:"97.295,-263.247,310.882,-1.5999,0.8386,3.1409,13.3259"},EPSG_3906:{towgs84:"577.88891,165.22205,391.18289,4.9145,-0.94729,-13.05098,7.78664"},EPSG_4307:{towgs84:"-209.3622,-87.8162,404.6198,0.0046,3.4784,0.5805,-1.4547"},EPSG_6892:{towgs84:"-76.269,-16.683,68.562,-6.275,10.536,-4.286,-13.686"},EPSG_4690:{towgs84:"221.597,152.441,176.523,2.403,1.3893,0.884,11.4648"},EPSG_4691:{towgs84:"218.769,150.75,176.75,3.5231,2.0037,1.288,10.9817"},EPSG_4629:{towgs84:"72.51,345.411,79.241,-1.5862,-0.8826,-0.5495,1.3653"},EPSG_4630:{towgs84:"165.804,216.213,180.26,-0.6251,-0.4515,-0.0721,7.4111"},EPSG_4692:{towgs84:"217.109,86.452,23.711,0.0183,-0.0003,0.007,-0.0093"},EPSG_9333:{towgs84:"0,0,0,-8.393,0.749,-10.276,0"},EPSG_9059:{towgs84:"0,0,0"},EPSG_4312:{towgs84:"601.705,84.263,485.227,4.7354,1.3145,5.393,-2.3887"},EPSG_4123:{towgs84:"-96.062,-82.428,-121.753,4.801,0.345,-1.376,1.496"},EPSG_4309:{towgs84:"-124.45,183.74,44.64,-0.4384,0.5446,-0.9706,-2.1365"},ESRI_104106:{towgs84:"-283.088,-70.693,117.445,-1.157,0.059,-0.652,-4.058"},EPSG_4281:{towgs84:"-219.247,-73.802,269.529"},EPSG_4322:{towgs84:"0,0,4.5"},EPSG_4324:{towgs84:"0,0,1.9"},EPSG_4284:{towgs84:"43.822,-108.842,-119.585,1.455,-0.761,0.737,0.549"},EPSG_4277:{towgs84:"446.448,-125.157,542.06,0.15,0.247,0.842,-20.489"},EPSG_4207:{towgs84:"-282.1,-72.2,120,-1.529,0.145,-0.89,-4.46"},EPSG_4688:{towgs84:"347.175,1077.618,2623.677,33.9058,-70.6776,9.4013,186.0647"},EPSG_4689:{towgs84:"410.793,54.542,80.501,-2.5596,-2.3517,-0.6594,17.3218"},EPSG_4720:{towgs84:"0,0,4.5"},EPSG_4273:{towgs84:"278.3,93,474.5,7.889,0.05,-6.61,6.21"},EPSG_4240:{towgs84:"204.64,834.74,293.8"},EPSG_4817:{towgs84:"278.3,93,474.5,7.889,0.05,-6.61,6.21"},ESRI_104131:{towgs84:"426.62,142.62,460.09,4.98,4.49,-12.42,-17.1"},EPSG_4265:{towgs84:"-104.1,-49.1,-9.9,0.971,-2.917,0.714,-11.68"},EPSG_4263:{towgs84:"-111.92,-87.85,114.5,1.875,0.202,0.219,0.032"},EPSG_4298:{towgs84:"-689.5937,623.84046,-65.93566,-0.02331,1.17094,-0.80054,5.88536"},EPSG_4270:{towgs84:"-253.4392,-148.452,386.5267,0.15605,0.43,-0.1013,-0.0424"},EPSG_4229:{towgs84:"-121.8,98.1,-10.7"},EPSG_4220:{towgs84:"-55.5,-348,-229.2"},EPSG_4214:{towgs84:"12.646,-155.176,-80.863"},EPSG_4232:{towgs84:"-345,3,223"},EPSG_4238:{towgs84:"-1.977,-13.06,-9.993,0.364,0.254,0.689,-1.037"},EPSG_4168:{towgs84:"-170,33,326"},EPSG_4131:{towgs84:"199,931,318.9"},EPSG_4152:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_5228:{towgs84:"572.213,85.334,461.94,4.9732,1.529,5.2484,3.5378"},EPSG_8351:{towgs84:"485.021,169.465,483.839,7.786342,4.397554,4.102655,0"},EPSG_4683:{towgs84:"-127.62,-67.24,-47.04,-3.068,4.903,1.578,-1.06"},EPSG_4133:{towgs84:"0,0,0"},EPSG_7373:{towgs84:"0.819,-0.5762,-1.6446,-0.00378,-0.03317,0.00318,0.0693"},EPSG_9075:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_9072:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_9294:{towgs84:"1.16835,-1.42001,-2.24431,-0.00822,-0.05508,0.01818,0.23388"},EPSG_4212:{towgs84:"-267.434,173.496,181.814,-13.4704,8.7154,7.3926,14.7492"},EPSG_4191:{towgs84:"-44.183,-0.58,-38.489,2.3867,2.7072,-3.5196,-8.2703"},EPSG_4237:{towgs84:"52.684,-71.194,-13.975,-0.312,-0.1063,-0.3729,1.0191"},EPSG_4740:{towgs84:"-1.08,-0.27,-0.9"},EPSG_4124:{towgs84:"419.3836,99.3335,591.3451,0.850389,1.817277,-7.862238,-0.99496"},EPSG_5681:{towgs84:"584.9636,107.7175,413.8067,1.1155,0.2824,-3.1384,7.9922"},EPSG_4141:{towgs84:"23.772,17.49,17.859,-0.3132,-1.85274,1.67299,-5.4262"},EPSG_4204:{towgs84:"-85.645,-273.077,-79.708,2.289,-1.421,2.532,3.194"},EPSG_4319:{towgs84:"226.702,-193.337,-35.371,-2.229,-4.391,9.238,0.9798"},EPSG_4200:{towgs84:"24.82,-131.21,-82.66"},EPSG_4130:{towgs84:"0,0,0"},EPSG_4127:{towgs84:"-82.875,-57.097,-156.768,-2.158,1.524,-0.982,-0.359"},EPSG_4149:{towgs84:"674.374,15.056,405.346"},EPSG_4617:{towgs84:"-0.991,1.9072,0.5129,1.25033e-7,4.6785e-8,5.6529e-8,0"},EPSG_4663:{towgs84:"-210.502,-66.902,-48.476,2.094,-15.067,-5.817,0.485"},EPSG_4664:{towgs84:"-211.939,137.626,58.3,-0.089,0.251,0.079,0.384"},EPSG_4665:{towgs84:"-105.854,165.589,-38.312,-0.003,-0.026,0.024,-0.048"},EPSG_4666:{towgs84:"631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43"},EPSG_4756:{towgs84:"-192.873,-39.382,-111.202,-0.00205,-0.0005,0.00335,0.0188"},EPSG_4723:{towgs84:"-179.483,-69.379,-27.584,-7.862,8.163,6.042,-13.925"},EPSG_4726:{towgs84:"8.853,-52.644,180.304,-0.393,-2.323,2.96,-24.081"},EPSG_4267:{towgs84:"-8.0,160.0,176.0"},EPSG_5365:{towgs84:"-0.16959,0.35312,0.51846,0.03385,-0.16325,0.03446,0.03693"},EPSG_4218:{towgs84:"304.5,306.5,-318.1"},EPSG_4242:{towgs84:"-33.722,153.789,94.959,-8.581,-4.478,4.54,8.95"},EPSG_4216:{towgs84:"-292.295,248.758,429.447,4.9971,2.99,6.6906,1.0289"},ESRI_104105:{towgs84:"631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43"},ESRI_104129:{towgs84:"0,0,0"},EPSG_4673:{towgs84:"174.05,-25.49,112.57"},EPSG_4202:{towgs84:"-124,-60,154"},EPSG_4203:{towgs84:"-117.763,-51.51,139.061,0.292,0.443,0.277,-0.191"},EPSG_3819:{towgs84:"595.48,121.69,515.35,4.115,-2.9383,0.853,-3.408"},EPSG_8694:{towgs84:"-93.799,-132.737,-219.073,-1.844,0.648,-6.37,-0.169"},EPSG_4145:{towgs84:"275.57,676.78,229.6"},EPSG_4283:{towgs84:"61.55,-10.87,-40.19,39.4924,32.7221,32.8979,-9.994"},EPSG_4317:{towgs84:"2.3287,-147.0425,-92.0802,-0.3092483,0.32482185,0.49729934,5.68906266"},EPSG_4272:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993"},EPSG_4248:{towgs84:"-307.7,265.3,-363.5"},EPSG_5561:{towgs84:"24,-121,-76"},EPSG_5233:{towgs84:"-0.293,766.95,87.713,0.195704,1.695068,3.473016,-0.039338"},ESRI_104130:{towgs84:"-86,-98,-119"},ESRI_104102:{towgs84:"682,-203,480"},ESRI_37207:{towgs84:"7,-10,-26"},EPSG_4675:{towgs84:"59.935,118.4,-10.871"},ESRI_104109:{towgs84:"-89.121,-348.182,260.871"},ESRI_104112:{towgs84:"-185.583,-230.096,281.361"},ESRI_104113:{towgs84:"25.1,-275.6,222.6"},IGNF_WGS72G:{towgs84:"0,12,6"},IGNF_NTFG:{towgs84:"-168,-60,320"},IGNF_EFATE57G:{towgs84:"-127,-769,472"},IGNF_PGP50G:{towgs84:"324.8,153.6,172.1"},IGNF_REUN47G:{towgs84:"94,-948,-1262"},IGNF_CSG67G:{towgs84:"-186,230,110"},IGNF_GUAD48G:{towgs84:"-467,-16,-300"},IGNF_TAHI51G:{towgs84:"162,117,154"},IGNF_TAHAAG:{towgs84:"65,342,77"},IGNF_NUKU72G:{towgs84:"84,274,65"},IGNF_PETRELS72G:{towgs84:"365,194,166"},IGNF_WALL78G:{towgs84:"253,-133,-127"},IGNF_MAYO50G:{towgs84:"-382,-59,-262"},IGNF_TANNAG:{towgs84:"-139,-967,436"},IGNF_IGN72G:{towgs84:"-13,-348,292"},IGNF_ATIGG:{towgs84:"1118,23,66"},IGNF_FANGA84G:{towgs84:"150.57,158.33,118.32"},IGNF_RUSAT84G:{towgs84:"202.13,174.6,-15.74"},IGNF_KAUE70G:{towgs84:"126.74,300.1,-75.49"},IGNF_MOP90G:{towgs84:"-10.8,-1.8,12.77"},IGNF_MHPF67G:{towgs84:"338.08,212.58,-296.17"},IGNF_TAHI79G:{towgs84:"160.61,116.05,153.69"},IGNF_ANAA92G:{towgs84:"1.5,3.84,4.81"},IGNF_MARQUI72G:{towgs84:"330.91,-13.92,58.56"},IGNF_APAT86G:{towgs84:"143.6,197.82,74.05"},IGNF_TUBU69G:{towgs84:"237.17,171.61,-77.84"},IGNF_STPM50G:{towgs84:"11.363,424.148,373.13"},EPSG_4150:{towgs84:"674.374,15.056,405.346"},EPSG_4754:{towgs84:"-208.4058,-109.8777,-2.5764"},ESRI_104101:{towgs84:"374,150,588"},EPSG_4693:{towgs84:"0,-0.15,0.68"},EPSG_6207:{towgs84:"293.17,726.18,245.36"},EPSG_4153:{towgs84:"-133.63,-157.5,-158.62"},EPSG_4132:{towgs84:"-241.54,-163.64,396.06"},EPSG_4221:{towgs84:"-154.5,150.7,100.4"},EPSG_4266:{towgs84:"-80.7,-132.5,41.1"},EPSG_4193:{towgs84:"-70.9,-151.8,-41.4"},EPSG_5340:{towgs84:"-0.41,0.46,-0.35"},EPSG_4246:{towgs84:"-294.7,-200.1,525.5"},EPSG_4318:{towgs84:"-3.2,-5.7,2.8"},EPSG_4121:{towgs84:"-199.87,74.79,246.62"},EPSG_4223:{towgs84:"-260.1,5.5,432.2"},EPSG_4158:{towgs84:"-0.465,372.095,171.736"},EPSG_4285:{towgs84:"-128.16,-282.42,21.93"},EPSG_4613:{towgs84:"-404.78,685.68,45.47"},EPSG_4607:{towgs84:"195.671,332.517,274.607"},EPSG_4475:{towgs84:"-381.788,-57.501,-256.673"},EPSG_4208:{towgs84:"-157.84,308.54,-146.6"},EPSG_4743:{towgs84:"70.995,-335.916,262.898"},EPSG_4710:{towgs84:"-323.65,551.39,-491.22"},EPSG_7881:{towgs84:"-0.077,0.079,0.086"},EPSG_4682:{towgs84:"283.729,735.942,261.143"},EPSG_4739:{towgs84:"-156,-271,-189"},EPSG_4679:{towgs84:"-80.01,253.26,291.19"},EPSG_4750:{towgs84:"-56.263,16.136,-22.856"},EPSG_4644:{towgs84:"-10.18,-350.43,291.37"},EPSG_4695:{towgs84:"-103.746,-9.614,-255.95"},EPSG_4292:{towgs84:"-355,21,72"},EPSG_4302:{towgs84:"-61.702,284.488,472.052"},EPSG_4143:{towgs84:"-124.76,53,466.79"},EPSG_4606:{towgs84:"-153,153,307"},EPSG_4699:{towgs84:"-770.1,158.4,-498.2"},EPSG_4247:{towgs84:"-273.5,110.6,-357.9"},EPSG_4160:{towgs84:"8.88,184.86,106.69"},EPSG_4161:{towgs84:"-233.43,6.65,173.64"},EPSG_9251:{towgs84:"-9.5,122.9,138.2"},EPSG_9253:{towgs84:"-78.1,101.6,133.3"},EPSG_4297:{towgs84:"-198.383,-240.517,-107.909"},EPSG_4269:{towgs84:"0,0,0"},EPSG_4301:{towgs84:"-147,506,687"},EPSG_4618:{towgs84:"-59,-11,-52"},EPSG_4612:{towgs84:"0,0,0"},EPSG_4678:{towgs84:"44.585,-131.212,-39.544"},EPSG_4250:{towgs84:"-130,29,364"},EPSG_4144:{towgs84:"214,804,268"},EPSG_4147:{towgs84:"-17.51,-108.32,-62.39"},EPSG_4259:{towgs84:"-254.1,-5.36,-100.29"},EPSG_4164:{towgs84:"-76,-138,67"},EPSG_4211:{towgs84:"-378.873,676.002,-46.255"},EPSG_4182:{towgs84:"-422.651,-172.995,84.02"},EPSG_4224:{towgs84:"-143.87,243.37,-33.52"},EPSG_4225:{towgs84:"-205.57,168.77,-4.12"},EPSG_5527:{towgs84:"-67.35,3.88,-38.22"},EPSG_4752:{towgs84:"98,390,-22"},EPSG_4310:{towgs84:"-30,190,89"},EPSG_9248:{towgs84:"-192.26,65.72,132.08"},EPSG_4680:{towgs84:"124.5,-63.5,-281"},EPSG_4701:{towgs84:"-79.9,-158,-168.9"},EPSG_4706:{towgs84:"-146.21,112.63,4.05"},EPSG_4805:{towgs84:"682,-203,480"},EPSG_4201:{towgs84:"-165,-11,206"},EPSG_4210:{towgs84:"-157,-2,-299"},EPSG_4183:{towgs84:"-104,167,-38"},EPSG_4139:{towgs84:"11,72,-101"},EPSG_4668:{towgs84:"-86,-98,-119"},EPSG_4717:{towgs84:"-2,151,181"},EPSG_4732:{towgs84:"102,52,-38"},EPSG_4280:{towgs84:"-377,681,-50"},EPSG_4209:{towgs84:"-138,-105,-289"},EPSG_4261:{towgs84:"31,146,47"},EPSG_4658:{towgs84:"-73,46,-86"},EPSG_4721:{towgs84:"265.025,384.929,-194.046"},EPSG_4222:{towgs84:"-136,-108,-292"},EPSG_4601:{towgs84:"-255,-15,71"},EPSG_4602:{towgs84:"725,685,536"},EPSG_4603:{towgs84:"72,213.7,93"},EPSG_4605:{towgs84:"9,183,236"},EPSG_4621:{towgs84:"137,248,-430"},EPSG_4657:{towgs84:"-28,199,5"},EPSG_4316:{towgs84:"103.25,-100.4,-307.19"},EPSG_4642:{towgs84:"-13,-348,292"},EPSG_4698:{towgs84:"145,-187,103"},EPSG_4192:{towgs84:"-206.1,-174.7,-87.7"},EPSG_4311:{towgs84:"-265,120,-358"},EPSG_4135:{towgs84:"58,-283,-182"},ESRI_104138:{towgs84:"198,-226,-347"},EPSG_4245:{towgs84:"-11,851,5"},EPSG_4142:{towgs84:"-125,53,467"},EPSG_4213:{towgs84:"-106,-87,188"},EPSG_4253:{towgs84:"-133,-77,-51"},EPSG_4129:{towgs84:"-132,-110,-335"},EPSG_4713:{towgs84:"-77,-128,142"},EPSG_4239:{towgs84:"217,823,299"},EPSG_4146:{towgs84:"295,736,257"},EPSG_4155:{towgs84:"-83,37,124"},EPSG_4165:{towgs84:"-173,253,27"},EPSG_4672:{towgs84:"175,-38,113"},EPSG_4236:{towgs84:"-637,-549,-203"},EPSG_4251:{towgs84:"-90,40,88"},EPSG_4271:{towgs84:"-2,374,172"},EPSG_4175:{towgs84:"-88,4,101"},EPSG_4716:{towgs84:"298,-304,-375"},EPSG_4315:{towgs84:"-23,259,-9"},EPSG_4744:{towgs84:"-242.2,-144.9,370.3"},EPSG_4244:{towgs84:"-97,787,86"},EPSG_4293:{towgs84:"616,97,-251"},EPSG_4714:{towgs84:"-127,-769,472"},EPSG_4736:{towgs84:"260,12,-147"},EPSG_6883:{towgs84:"-235,-110,393"},EPSG_6894:{towgs84:"-63,176,185"},EPSG_4205:{towgs84:"-43,-163,45"},EPSG_4256:{towgs84:"41,-220,-134"},EPSG_4262:{towgs84:"639,405,60"},EPSG_4604:{towgs84:"174,359,365"},EPSG_4169:{towgs84:"-115,118,426"},EPSG_4620:{towgs84:"-106,-129,165"},EPSG_4184:{towgs84:"-203,141,53"},EPSG_4616:{towgs84:"-289,-124,60"},EPSG_9403:{towgs84:"-307,-92,127"},EPSG_4684:{towgs84:"-133,-321,50"},EPSG_4708:{towgs84:"-491,-22,435"},EPSG_4707:{towgs84:"114,-116,-333"},EPSG_4709:{towgs84:"145,75,-272"},EPSG_4712:{towgs84:"-205,107,53"},EPSG_4711:{towgs84:"124,-234,-25"},EPSG_4718:{towgs84:"230,-199,-752"},EPSG_4719:{towgs84:"211,147,111"},EPSG_4724:{towgs84:"208,-435,-229"},EPSG_4725:{towgs84:"189,-79,-202"},EPSG_4735:{towgs84:"647,1777,-1124"},EPSG_4722:{towgs84:"-794,119,-298"},EPSG_4728:{towgs84:"-307,-92,127"},EPSG_4734:{towgs84:"-632,438,-609"},EPSG_4727:{towgs84:"912,-58,1227"},EPSG_4729:{towgs84:"185,165,42"},EPSG_4730:{towgs84:"170,42,84"},EPSG_4733:{towgs84:"276,-57,149"},ESRI_37218:{towgs84:"230,-199,-752"},ESRI_37240:{towgs84:"-7,215,225"},ESRI_37221:{towgs84:"252,-209,-751"},ESRI_4305:{towgs84:"-123,-206,219"},ESRI_104139:{towgs84:"-73,-247,227"},EPSG_4748:{towgs84:"51,391,-36"},EPSG_4219:{towgs84:"-384,664,-48"},EPSG_4255:{towgs84:"-333,-222,114"},EPSG_4257:{towgs84:"-587.8,519.75,145.76"},EPSG_4646:{towgs84:"-963,510,-359"},EPSG_6881:{towgs84:"-24,-203,268"},EPSG_6882:{towgs84:"-183,-15,273"},EPSG_4715:{towgs84:"-104,-129,239"},IGNF_RGF93GDD:{towgs84:"0,0,0"},IGNF_RGM04GDD:{towgs84:"0,0,0"},IGNF_RGSPM06GDD:{towgs84:"0,0,0"},IGNF_RGTAAF07GDD:{towgs84:"0,0,0"},IGNF_RGFG95GDD:{towgs84:"0,0,0"},IGNF_RGNCG:{towgs84:"0,0,0"},IGNF_RGPFGDD:{towgs84:"0,0,0"},IGNF_ETRS89G:{towgs84:"0,0,0"},IGNF_RGR92GDD:{towgs84:"0,0,0"},EPSG_4173:{towgs84:"0,0,0"},EPSG_4180:{towgs84:"0,0,0"},EPSG_4619:{towgs84:"0,0,0"},EPSG_4667:{towgs84:"0,0,0"},EPSG_4075:{towgs84:"0,0,0"},EPSG_6706:{towgs84:"0,0,0"},EPSG_7798:{towgs84:"0,0,0"},EPSG_4661:{towgs84:"0,0,0"},EPSG_4669:{towgs84:"0,0,0"},EPSG_8685:{towgs84:"0,0,0"},EPSG_4151:{towgs84:"0,0,0"},EPSG_9702:{towgs84:"0,0,0"},EPSG_4758:{towgs84:"0,0,0"},EPSG_4761:{towgs84:"0,0,0"},EPSG_4765:{towgs84:"0,0,0"},EPSG_8997:{towgs84:"0,0,0"},EPSG_4023:{towgs84:"0,0,0"},EPSG_4670:{towgs84:"0,0,0"},EPSG_4694:{towgs84:"0,0,0"},EPSG_4148:{towgs84:"0,0,0"},EPSG_4163:{towgs84:"0,0,0"},EPSG_4167:{towgs84:"0,0,0"},EPSG_4189:{towgs84:"0,0,0"},EPSG_4190:{towgs84:"0,0,0"},EPSG_4176:{towgs84:"0,0,0"},EPSG_4659:{towgs84:"0,0,0"},EPSG_3824:{towgs84:"0,0,0"},EPSG_3889:{towgs84:"0,0,0"},EPSG_4046:{towgs84:"0,0,0"},EPSG_4081:{towgs84:"0,0,0"},EPSG_4558:{towgs84:"0,0,0"},EPSG_4483:{towgs84:"0,0,0"},EPSG_5013:{towgs84:"0,0,0"},EPSG_5264:{towgs84:"0,0,0"},EPSG_5324:{towgs84:"0,0,0"},EPSG_5354:{towgs84:"0,0,0"},EPSG_5371:{towgs84:"0,0,0"},EPSG_5373:{towgs84:"0,0,0"},EPSG_5381:{towgs84:"0,0,0"},EPSG_5393:{towgs84:"0,0,0"},EPSG_5489:{towgs84:"0,0,0"},EPSG_5593:{towgs84:"0,0,0"},EPSG_6135:{towgs84:"0,0,0"},EPSG_6365:{towgs84:"0,0,0"},EPSG_5246:{towgs84:"0,0,0"},EPSG_7886:{towgs84:"0,0,0"},EPSG_8431:{towgs84:"0,0,0"},EPSG_8427:{towgs84:"0,0,0"},EPSG_8699:{towgs84:"0,0,0"},EPSG_8818:{towgs84:"0,0,0"},EPSG_4757:{towgs84:"0,0,0"},EPSG_9140:{towgs84:"0,0,0"},EPSG_8086:{towgs84:"0,0,0"},EPSG_4686:{towgs84:"0,0,0"},EPSG_4737:{towgs84:"0,0,0"},EPSG_4702:{towgs84:"0,0,0"},EPSG_4747:{towgs84:"0,0,0"},EPSG_4749:{towgs84:"0,0,0"},EPSG_4674:{towgs84:"0,0,0"},EPSG_4755:{towgs84:"0,0,0"},EPSG_4759:{towgs84:"0,0,0"},EPSG_4762:{towgs84:"0,0,0"},EPSG_4763:{towgs84:"0,0,0"},EPSG_4764:{towgs84:"0,0,0"},EPSG_4166:{towgs84:"0,0,0"},EPSG_4170:{towgs84:"0,0,0"},EPSG_5546:{towgs84:"0,0,0"},EPSG_7844:{towgs84:"0,0,0"},EPSG_4818:{towgs84:"589,76,480"}};for(var yQ in s0){var tE=s0[yQ];tE.datumName&&(s0[tE.datumName]=tE)}function vQ(n,e,t,i,r,s,o){var a={};return n===void 0||n==="none"?a.datum_type=Nw:a.datum_type=bZ,e&&(a.datum_params=e.map(parseFloat),(a.datum_params[0]!==0||a.datum_params[1]!==0||a.datum_params[2]!==0)&&(a.datum_type=vc),a.datum_params.length>3&&(a.datum_params[3]!==0||a.datum_params[4]!==0||a.datum_params[5]!==0||a.datum_params[6]!==0)&&(a.datum_type=Ec,a.datum_params[3]*=If,a.datum_params[4]*=If,a.datum_params[5]*=If,a.datum_params[6]=a.datum_params[6]/1e6+1)),o&&(a.datum_type=rh,a.grids=o),a.a=t,a.b=i,a.es=r,a.ep2=s,a}var gT={};function EQ(n,e,t){return e instanceof ArrayBuffer?wQ(n,e,t):{ready:xQ(n,e)}}function wQ(n,e,t){var i=!0;t!==void 0&&t.includeErrorFields===!1&&(i=!1);var r=new DataView(e),s=IQ(r),o=AQ(r,s),a=RQ(r,o,s,i),c={header:o,subgrids:a};return gT[n]=c,c}async function xQ(n,e){for(var t=[],i=await e.getImageCount(),r=i-1;r>=0;r--){var s=await e.getImage(r),o=await s.readRasters(),a=o,c=[s.getWidth(),s.getHeight()],h=s.getBoundingBox().map(LM),d=[s.fileDirectory.ModelPixelScale[0],s.fileDirectory.ModelPixelScale[1]].map(LM),g=h[0]+(c[0]-1)*d[0],m=h[3]-(c[1]-1)*d[1],v=a[0],y=a[1],T=[];for(let P=c[1]-1;P>=0;P--)for(let C=c[0]-1;C>=0;C--){var w=P*c[0]+C;T.push([-Ia(y[w]),Ia(v[w])])}t.push({del:d,lim:c,ll:[-g,m],cvs:T})}var A={header:{nSubgrids:i},subgrids:t};return gT[n]=A,A}function SQ(n){if(n===void 0)return null;var e=n.split(",");return e.map(TQ)}function TQ(n){if(n.length===0)return null;var e=n[0]==="@";return e&&(n=n.slice(1)),n==="null"?{name:"null",mandatory:!e,grid:null,isNull:!0}:{name:n,mandatory:!e,grid:gT[n]||null,isNull:!1}}function LM(n){return n*Math.PI/180}function Ia(n){return n/3600*Math.PI/180}function IQ(n){var e=n.getInt32(8,!1);return e===11?!1:(e=n.getInt32(8,!0),e!==11&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}function AQ(n,e){return{nFields:n.getInt32(8,e),nSubgridFields:n.getInt32(24,e),nSubgrids:n.getInt32(40,e),shiftType:Ow(n,56,64).trim(),fromSemiMajorAxis:n.getFloat64(120,e),fromSemiMinorAxis:n.getFloat64(136,e),toSemiMajorAxis:n.getFloat64(152,e),toSemiMinorAxis:n.getFloat64(168,e)}}function Ow(n,e,t){return String.fromCharCode.apply(null,new Uint8Array(n.buffer.slice(e,t)))}function RQ(n,e,t,i){for(var r=176,s=[],o=0;o<e.nSubgrids;o++){var a=CQ(n,r,t),c=MQ(n,r,a,t,i),h=Math.round(1+(a.upperLongitude-a.lowerLongitude)/a.longitudeInterval),d=Math.round(1+(a.upperLatitude-a.lowerLatitude)/a.latitudeInterval);s.push({ll:[Ia(a.lowerLongitude),Ia(a.lowerLatitude)],del:[Ia(a.longitudeInterval),Ia(a.latitudeInterval)],lim:[h,d],count:a.gridNodeCount,cvs:PQ(c)});var g=16;i===!1&&(g=8),r+=176+a.gridNodeCount*g}return s}function PQ(n){return n.map(function(e){return[Ia(e.longitudeShift),Ia(e.latitudeShift)]})}function CQ(n,e,t){return{name:Ow(n,e+8,e+16).trim(),parent:Ow(n,e+24,e+24+8).trim(),lowerLatitude:n.getFloat64(e+72,t),upperLatitude:n.getFloat64(e+88,t),lowerLongitude:n.getFloat64(e+104,t),upperLongitude:n.getFloat64(e+120,t),latitudeInterval:n.getFloat64(e+136,t),longitudeInterval:n.getFloat64(e+152,t),gridNodeCount:n.getInt32(e+168,t)}}function MQ(n,e,t,i,r){var s=e+176,o=16;r===!1&&(o=8);for(var a=[],c=0;c<t.gridNodeCount;c++){var h={latitudeShift:n.getFloat32(s+c*o,i),longitudeShift:n.getFloat32(s+c*o+4,i)};r!==!1&&(h.latitudeAccuracy=n.getFloat32(s+c*o+8,i),h.longitudeAccuracy=n.getFloat32(s+c*o+12,i)),a.push(h)}return a}function Ar(n,e){if(!(this instanceof Ar))return new Ar(n);this.forward=null,this.inverse=null,this.init=null,this.name,this.names=null,this.title,e=e||function(h){if(h)throw h};var t=iQ(n);if(typeof t!="object"){e("Could not parse to valid json: "+n);return}var i=Ar.projections.get(t.projName);if(!i){e("Could not get projection name from: "+n);return}if(t.datumCode&&t.datumCode!=="none"){var r=Wa(s0,t.datumCode);r&&(t.datum_params=t.datum_params||(r.towgs84?r.towgs84.split(","):null),t.ellps=r.ellipse,t.datumName=r.datumName?r.datumName:t.datumCode)}t.k0=t.k0||1,t.axis=t.axis||"enu",t.ellps=t.ellps||"wgs84",t.lat1=t.lat1||t.lat0;var s=_Q(t.a,t.b,t.rf,t.ellps,t.sphere),o=pQ(s.a,s.b,s.rf,t.R_A),a=SQ(t.nadgrids),c=t.datum||vQ(t.datumCode,t.datum_params,s.a,s.b,o.es,o.ep2,a);bM(this,t),bM(this,i),this.a=s.a,this.b=s.b,this.rf=s.rf,this.sphere=s.sphere,this.es=o.es,this.e=o.e,this.ep2=o.ep2,this.datum=c,"init"in this&&typeof this.init=="function"&&this.init(),e(null,this)}Ar.projections=gQ;Ar.projections.start();function bQ(n,e){return n.datum_type!==e.datum_type||n.a!==e.a||Math.abs(n.es-e.es)>5e-11?!1:n.datum_type===vc?n.datum_params[0]===e.datum_params[0]&&n.datum_params[1]===e.datum_params[1]&&n.datum_params[2]===e.datum_params[2]:n.datum_type===Ec?n.datum_params[0]===e.datum_params[0]&&n.datum_params[1]===e.datum_params[1]&&n.datum_params[2]===e.datum_params[2]&&n.datum_params[3]===e.datum_params[3]&&n.datum_params[4]===e.datum_params[4]&&n.datum_params[5]===e.datum_params[5]&&n.datum_params[6]===e.datum_params[6]:!0}function L3(n,e,t){var i=n.x,r=n.y,s=n.z?n.z:0,o,a,c,h;if(r<-se&&r>-1.001*se)r=-se;else if(r>se&&r<1.001*se)r=se;else{if(r<-se)return{x:-1/0,y:-1/0,z:n.z};if(r>se)return{x:1/0,y:1/0,z:n.z}}return i>Math.PI&&(i-=2*Math.PI),a=Math.sin(r),h=Math.cos(r),c=a*a,o=t/Math.sqrt(1-e*c),{x:(o+s)*h*Math.cos(i),y:(o+s)*h*Math.sin(i),z:(o*(1-e)+s)*a}}function N3(n,e,t,i){var r=1e-12,s=r*r,o=30,a,c,h,d,g,m,v,y,T,w,A,P,C,N=n.x,D=n.y,z=n.z?n.z:0,k,R,L;if(a=Math.sqrt(N*N+D*D),c=Math.sqrt(N*N+D*D+z*z),a/t<r){if(k=0,c/t<r)return R=se,L=-i,{x:n.x,y:n.y,z:n.z}}else k=Math.atan2(D,N);h=z/c,d=a/c,g=1/Math.sqrt(1-e*(2-e)*d*d),y=d*(1-e)*g,T=h*g,C=0;do C++,v=t/Math.sqrt(1-e*T*T),L=a*y+z*T-v*(1-e*T*T),m=e*v/(v+L),g=1/Math.sqrt(1-m*(2-m)*d*d),w=d*(1-m)*g,A=h*g,P=A*y-w*T,y=w,T=A;while(P*P>s&&C<o);return R=Math.atan(A/Math.abs(w)),{x:k,y:R,z:L}}function kQ(n,e,t){if(e===vc)return{x:n.x+t[0],y:n.y+t[1],z:n.z+t[2]};if(e===Ec){var i=t[0],r=t[1],s=t[2],o=t[3],a=t[4],c=t[5],h=t[6];return{x:h*(n.x-c*n.y+a*n.z)+i,y:h*(c*n.x+n.y-o*n.z)+r,z:h*(-a*n.x+o*n.y+n.z)+s}}}function LQ(n,e,t){if(e===vc)return{x:n.x-t[0],y:n.y-t[1],z:n.z-t[2]};if(e===Ec){var i=t[0],r=t[1],s=t[2],o=t[3],a=t[4],c=t[5],h=t[6],d=(n.x-i)/h,g=(n.y-r)/h,m=(n.z-s)/h;return{x:d+c*g-a*m,y:-c*d+g+o*m,z:a*d-o*g+m}}}function Np(n){return n===vc||n===Ec}function NQ(n,e,t){if(bQ(n,e)||n.datum_type===Nw||e.datum_type===Nw)return t;var i=n.a,r=n.es;if(n.datum_type===rh){var s=NM(n,!1,t);if(s!==0)return;i=IM,r=AM}var o=e.a,a=e.b,c=e.es;if(e.datum_type===rh&&(o=IM,a=kZ,c=AM),r===c&&i===o&&!Np(n.datum_type)&&!Np(e.datum_type))return t;if(t=L3(t,r,i),Np(n.datum_type)&&(t=kQ(t,n.datum_type,n.datum_params)),Np(e.datum_type)&&(t=LQ(t,e.datum_type,e.datum_params)),t=N3(t,c,o,a),e.datum_type===rh){var h=NM(e,!0,t);if(h!==0)return}return t}function NM(n,e,t){if(n.grids===null||n.grids.length===0)return console.log("Grid shift grids not found"),-1;var i={x:-t.x,y:t.y},r={x:Number.NaN,y:Number.NaN},s=[];e:for(var o=0;o<n.grids.length;o++){var a=n.grids[o];if(s.push(a.name),a.isNull){r=i;break}if(a.grid===null){if(a.mandatory)return console.log("Unable to find mandatory grid '"+a.name+"'"),-1;continue}for(var c=a.grid.subgrids,h=0,d=c.length;h<d;h++){var g=c[h],m=(Math.abs(g.del[1])+Math.abs(g.del[0]))/1e4,v=g.ll[0]-m,y=g.ll[1]-m,T=g.ll[0]+(g.lim[0]-1)*g.del[0]+m,w=g.ll[1]+(g.lim[1]-1)*g.del[1]+m;if(!(y>i.y||v>i.x||w<i.y||T<i.x)&&(r=DQ(i,e,g),!isNaN(r.x)))break e}}return isNaN(r.x)?(console.log("Failed to find a grid shift table for location '"+-i.x*ki+" "+i.y*ki+" tried: '"+s+"'"),-1):(t.x=-r.x,t.y=r.y,0)}function DQ(n,e,t){var i={x:Number.NaN,y:Number.NaN};if(isNaN(n.x))return i;var r={x:n.x,y:n.y};r.x-=t.ll[0],r.y-=t.ll[1],r.x=_e(r.x-Math.PI)+Math.PI;var s=DM(r,t);if(e){if(isNaN(s.x))return i;s.x=r.x-s.x,s.y=r.y-s.y;var o=9,a=1e-12,c,h;do{if(h=DM(s,t),isNaN(h.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}c={x:r.x-(h.x+s.x),y:r.y-(h.y+s.y)},s.x+=c.x,s.y+=c.y}while(o--&&Math.abs(c.x)>a&&Math.abs(c.y)>a);if(o<0)return console.log("Inverse grid shift iterator failed to converge."),i;i.x=_e(s.x+t.ll[0]),i.y=s.y+t.ll[1]}else isNaN(s.x)||(i.x=n.x+s.x,i.y=n.y+s.y);return i}function DM(n,e){var t={x:n.x/e.del[0],y:n.y/e.del[1]},i={x:Math.floor(t.x),y:Math.floor(t.y)},r={x:t.x-1*i.x,y:t.y-1*i.y},s={x:Number.NaN,y:Number.NaN},o;if(i.x<0||i.x>=e.lim[0]||i.y<0||i.y>=e.lim[1])return s;o=i.y*e.lim[0]+i.x;var a={x:e.cvs[o][0],y:e.cvs[o][1]};o++;var c={x:e.cvs[o][0],y:e.cvs[o][1]};o+=e.lim[0];var h={x:e.cvs[o][0],y:e.cvs[o][1]};o--;var d={x:e.cvs[o][0],y:e.cvs[o][1]},g=r.x*r.y,m=r.x*(1-r.y),v=(1-r.x)*(1-r.y),y=(1-r.x)*r.y;return s.x=v*a.x+m*c.x+y*d.x+g*h.x,s.y=v*a.y+m*c.y+y*d.y+g*h.y,s}function OM(n,e,t){var i=t.x,r=t.y,s=t.z||0,o,a,c,h={};for(c=0;c<3;c++)if(!(e&&c===2&&t.z===void 0))switch(c===0?(o=i,"ew".indexOf(n.axis[c])!==-1?a="x":a="y"):c===1?(o=r,"ns".indexOf(n.axis[c])!==-1?a="y":a="x"):(o=s,a="z"),n.axis[c]){case"e":h[a]=o;break;case"w":h[a]=-o;break;case"n":h[a]=o;break;case"s":h[a]=-o;break;case"u":t[a]!==void 0&&(h.z=o);break;case"d":t[a]!==void 0&&(h.z=-o);break;default:return null}return h}function D3(n){var e={x:n[0],y:n[1]};return n.length>2&&(e.z=n[2]),n.length>3&&(e.m=n[3]),e}function OQ(n){VM(n.x),VM(n.y)}function VM(n){if(typeof Number.isFinite=="function"){if(Number.isFinite(n))return;throw new TypeError("coordinates must be finite numbers")}if(typeof n!="number"||n!==n||!isFinite(n))throw new TypeError("coordinates must be finite numbers")}function VQ(n,e){return(n.datum.datum_type===vc||n.datum.datum_type===Ec||n.datum.datum_type===rh)&&e.datumCode!=="WGS84"||(e.datum.datum_type===vc||e.datum.datum_type===Ec||e.datum.datum_type===rh)&&n.datumCode!=="WGS84"}function f_(n,e,t,i){var r;Array.isArray(t)?t=D3(t):t={x:t.x,y:t.y,z:t.z,m:t.m};var s=t.z!==void 0;if(OQ(t),n.datum&&e.datum&&VQ(n,e)&&(r=new Ar("WGS84"),t=f_(n,r,t,i),n=r),i&&n.axis!=="enu"&&(t=OM(n,!1,t)),n.projName==="longlat")t={x:t.x*qt,y:t.y*qt,z:t.z||0};else if(n.to_meter&&(t={x:t.x*n.to_meter,y:t.y*n.to_meter,z:t.z||0}),t=n.inverse(t),!t)return;if(n.from_greenwich&&(t.x+=n.from_greenwich),t=NQ(n.datum,e.datum,t),!!t)return t=t,e.from_greenwich&&(t={x:t.x-e.from_greenwich,y:t.y,z:t.z||0}),e.projName==="longlat"?t={x:t.x*ki,y:t.y*ki,z:t.z||0}:(t=e.forward(t),e.to_meter&&(t={x:t.x/e.to_meter,y:t.y/e.to_meter,z:t.z||0})),i&&e.axis!=="enu"?OM(e,!0,t):(t&&!s&&delete t.z,t)}var FM=Ar("WGS84");function nE(n,e,t,i){var r,s,o;return Array.isArray(t)?(r=f_(n,e,t,i)||{x:NaN,y:NaN},t.length>2?typeof n.name<"u"&&n.name==="geocent"||typeof e.name<"u"&&e.name==="geocent"?typeof r.z=="number"?[r.x,r.y,r.z].concat(t.slice(3)):[r.x,r.y,t[2]].concat(t.slice(3)):[r.x,r.y].concat(t.slice(2)):[r.x,r.y]):(s=f_(n,e,t,i),o=Object.keys(t),o.length===2||o.forEach(function(a){if(typeof n.name<"u"&&n.name==="geocent"||typeof e.name<"u"&&e.name==="geocent"){if(a==="x"||a==="y"||a==="z")return}else if(a==="x"||a==="y")return;s[a]=t[a]}),s)}function Dp(n){return n instanceof Ar?n:typeof n=="object"&&"oProj"in n?n.oProj:Ar(n)}function FQ(n,e,t){var i,r,s=!1,o;return typeof e>"u"?(r=Dp(n),i=FM,s=!0):(typeof e.x<"u"||Array.isArray(e))&&(t=e,r=Dp(n),i=FM,s=!0),i||(i=Dp(n)),r||(r=Dp(e)),t?nE(i,r,t):(o={forward:function(a,c){return nE(i,r,a,c)},inverse:function(a,c){return nE(r,i,a,c)}},s&&(o.oProj=r),o)}var jM=6,O3="AJSAJS",V3="AFAFAF",Wu=65,Si=73,yr=79,of=86,af=90;const jQ={forward:F3,inverse:GQ,toPoint:j3};function F3(n,e){return e=e||5,BQ(UQ({lat:n[1],lon:n[0]}),e)}function GQ(n){var e=mT(U3(n.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat,e.lon,e.lat]:[e.left,e.bottom,e.right,e.top]}function j3(n){var e=mT(U3(n.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat]:[(e.left+e.right)/2,(e.top+e.bottom)/2]}function iE(n){return n*(Math.PI/180)}function GM(n){return 180*(n/Math.PI)}function UQ(n){var e=n.lat,t=n.lon,i=6378137,r=.00669438,s=.9996,o,a,c,h,d,g,m,v=iE(e),y=iE(t),T,w;w=Math.floor((t+180)/6)+1,t===180&&(w=60),e>=56&&e<64&&t>=3&&t<12&&(w=32),e>=72&&e<84&&(t>=0&&t<9?w=31:t>=9&&t<21?w=33:t>=21&&t<33?w=35:t>=33&&t<42&&(w=37)),o=(w-1)*6-180+3,T=iE(o),a=r/(1-r),c=i/Math.sqrt(1-r*Math.sin(v)*Math.sin(v)),h=Math.tan(v)*Math.tan(v),d=a*Math.cos(v)*Math.cos(v),g=Math.cos(v)*(y-T),m=i*((1-r/4-3*r*r/64-5*r*r*r/256)*v-(3*r/8+3*r*r/32+45*r*r*r/1024)*Math.sin(2*v)+(15*r*r/256+45*r*r*r/1024)*Math.sin(4*v)-35*r*r*r/3072*Math.sin(6*v));var A=s*c*(g+(1-h+d)*g*g*g/6+(5-18*h+h*h+72*d-58*a)*g*g*g*g*g/120)+5e5,P=s*(m+c*Math.tan(v)*(g*g/2+(5-h+9*d+4*d*d)*g*g*g*g/24+(61-58*h+h*h+600*d-330*a)*g*g*g*g*g*g/720));return e<0&&(P+=1e7),{northing:Math.round(P),easting:Math.round(A),zoneNumber:w,zoneLetter:zQ(e)}}function mT(n){var e=n.northing,t=n.easting,i=n.zoneLetter,r=n.zoneNumber;if(r<0||r>60)return null;var s=.9996,o=6378137,a=.00669438,c,h=(1-Math.sqrt(1-a))/(1+Math.sqrt(1-a)),d,g,m,v,y,T,w,A,P,C=t-5e5,N=e;i<"N"&&(N-=1e7),w=(r-1)*6-180+3,c=a/(1-a),T=N/s,A=T/(o*(1-a/4-3*a*a/64-5*a*a*a/256)),P=A+(3*h/2-27*h*h*h/32)*Math.sin(2*A)+(21*h*h/16-55*h*h*h*h/32)*Math.sin(4*A)+151*h*h*h/96*Math.sin(6*A),d=o/Math.sqrt(1-a*Math.sin(P)*Math.sin(P)),g=Math.tan(P)*Math.tan(P),m=c*Math.cos(P)*Math.cos(P),v=o*(1-a)/Math.pow(1-a*Math.sin(P)*Math.sin(P),1.5),y=C/(d*s);var D=P-d*Math.tan(P)/v*(y*y/2-(5+3*g+10*m-4*m*m-9*c)*y*y*y*y/24+(61+90*g+298*m+45*g*g-252*c-3*m*m)*y*y*y*y*y*y/720);D=GM(D);var z=(y-(1+2*g+m)*y*y*y/6+(5-2*m+28*g-3*m*m+8*c+24*g*g)*y*y*y*y*y/120)/Math.cos(P);z=w+GM(z);var k;if(n.accuracy){var R=mT({northing:n.northing+n.accuracy,easting:n.easting+n.accuracy,zoneLetter:n.zoneLetter,zoneNumber:n.zoneNumber});k={top:R.lat,right:R.lon,bottom:D,left:z}}else k={lat:D,lon:z};return k}function zQ(n){var e="Z";return 84>=n&&n>=72?e="X":72>n&&n>=64?e="W":64>n&&n>=56?e="V":56>n&&n>=48?e="U":48>n&&n>=40?e="T":40>n&&n>=32?e="S":32>n&&n>=24?e="R":24>n&&n>=16?e="Q":16>n&&n>=8?e="P":8>n&&n>=0?e="N":0>n&&n>=-8?e="M":-8>n&&n>=-16?e="L":-16>n&&n>=-24?e="K":-24>n&&n>=-32?e="J":-32>n&&n>=-40?e="H":-40>n&&n>=-48?e="G":-48>n&&n>=-56?e="F":-56>n&&n>=-64?e="E":-64>n&&n>=-72?e="D":-72>n&&n>=-80&&(e="C"),e}function BQ(n,e){var t="00000"+n.easting,i="00000"+n.northing;return n.zoneNumber+n.zoneLetter+$Q(n.easting,n.northing,n.zoneNumber)+t.substr(t.length-5,e)+i.substr(i.length-5,e)}function $Q(n,e,t){var i=G3(t),r=Math.floor(n/1e5),s=Math.floor(e/1e5)%20;return WQ(r,s,i)}function G3(n){var e=n%jM;return e===0&&(e=jM),e}function WQ(n,e,t){var i=t-1,r=O3.charCodeAt(i),s=V3.charCodeAt(i),o=r+n-1,a=s+e,c=!1;o>af&&(o=o-af+Wu-1,c=!0),(o===Si||r<Si&&o>Si||(o>Si||r<Si)&&c)&&o++,(o===yr||r<yr&&o>yr||(o>yr||r<yr)&&c)&&(o++,o===Si&&o++),o>af&&(o=o-af+Wu-1),a>of?(a=a-of+Wu-1,c=!0):c=!1,(a===Si||s<Si&&a>Si||(a>Si||s<Si)&&c)&&a++,(a===yr||s<yr&&a>yr||(a>yr||s<yr)&&c)&&(a++,a===Si&&a++),a>of&&(a=a-of+Wu-1);var h=String.fromCharCode(o)+String.fromCharCode(a);return h}function U3(n){if(n&&n.length===0)throw"MGRSPoint coverting from nothing";for(var e=n.length,t=null,i="",r,s=0;!/[A-Z]/.test(r=n.charAt(s));){if(s>=2)throw"MGRSPoint bad conversion from: "+n;i+=r,s++}var o=parseInt(i,10);if(s===0||s+3>e)throw"MGRSPoint bad conversion from: "+n;var a=n.charAt(s++);if(a<="A"||a==="B"||a==="Y"||a>="Z"||a==="I"||a==="O")throw"MGRSPoint zone letter "+a+" not handled: "+n;t=n.substring(s,s+=2);for(var c=G3(o),h=KQ(t.charAt(0),c),d=qQ(t.charAt(1),c);d<HQ(a);)d+=2e6;var g=e-s;if(g%2!==0)throw`MGRSPoint has to have an even number 
of digits after the zone letter and two 100km letters - front 
half for easting meters, second half for 
northing meters`+n;var m=g/2,v=0,y=0,T,w,A,P,C;return m>0&&(T=1e5/Math.pow(10,m),w=n.substring(s,s+m),v=parseFloat(w)*T,A=n.substring(s+m),y=parseFloat(A)*T),P=v+h,C=y+d,{easting:P,northing:C,zoneLetter:a,zoneNumber:o,accuracy:T}}function KQ(n,e){for(var t=O3.charCodeAt(e-1),i=1e5,r=!1;t!==n.charCodeAt(0);){if(t++,t===Si&&t++,t===yr&&t++,t>af){if(r)throw"Bad character: "+n;t=Wu,r=!0}i+=1e5}return i}function qQ(n,e){if(n>"V")throw"MGRSPoint given invalid Northing "+n;for(var t=V3.charCodeAt(e-1),i=0,r=!1;t!==n.charCodeAt(0);){if(t++,t===Si&&t++,t===yr&&t++,t>of){if(r)throw"Bad character: "+n;t=Wu,r=!0}i+=1e5}return i}function HQ(n){var e;switch(n){case"C":e=11e5;break;case"D":e=2e6;break;case"E":e=28e5;break;case"F":e=37e5;break;case"G":e=46e5;break;case"H":e=55e5;break;case"J":e=64e5;break;case"K":e=73e5;break;case"L":e=82e5;break;case"M":e=91e5;break;case"N":e=0;break;case"P":e=8e5;break;case"Q":e=17e5;break;case"R":e=26e5;break;case"S":e=35e5;break;case"T":e=44e5;break;case"U":e=53e5;break;case"V":e=62e5;break;case"W":e=7e6;break;case"X":e=79e5;break;default:e=-1}if(e>=0)return e;throw"Invalid zone letter: "+n}function bh(n,e,t){if(!(this instanceof bh))return new bh(n,e,t);if(Array.isArray(n))this.x=n[0],this.y=n[1],this.z=n[2]||0;else if(typeof n=="object")this.x=n.x,this.y=n.y,this.z=n.z||0;else if(typeof n=="string"&&typeof e>"u"){var i=n.split(",");this.x=parseFloat(i[0]),this.y=parseFloat(i[1]),this.z=parseFloat(i[2])||0}else this.x=n,this.y=e,this.z=t||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}bh.fromMGRS=function(n){return new bh(j3(n))};bh.prototype.toMGRS=function(n){return F3([this.x,this.y],n)};var XQ=1,YQ=.25,UM=.046875,zM=.01953125,BM=.01068115234375,ZQ=.75,QQ=.46875,JQ=.013020833333333334,eJ=.007120768229166667,tJ=.3645833333333333,nJ=.005696614583333333,iJ=.3076171875;function pT(n){var e=[];e[0]=XQ-n*(YQ+n*(UM+n*(zM+n*BM))),e[1]=n*(ZQ-n*(UM+n*(zM+n*BM)));var t=n*n;return e[2]=t*(QQ-n*(JQ+n*eJ)),t*=n,e[3]=t*(tJ-n*nJ),e[4]=t*n*iJ,e}function zh(n,e,t,i){return t*=e,e*=e,i[0]*n-t*(i[1]+e*(i[2]+e*(i[3]+e*i[4])))}var rJ=20;function _T(n,e,t){for(var i=1/(1-e),r=n,s=rJ;s;--s){var o=Math.sin(r),a=1-e*o*o;if(a=(zh(r,o,Math.cos(r),t)-n)*(a*Math.sqrt(a))*i,r-=a,Math.abs(a)<ge)return r}return r}function sJ(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.es&&(this.en=pT(this.es),this.ml0=zh(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))}function oJ(n){var e=n.x,t=n.y,i=_e(e-this.long0,this.over),r,s,o,a=Math.sin(t),c=Math.cos(t);if(this.es){var d=c*i,g=Math.pow(d,2),m=this.ep2*Math.pow(c,2),v=Math.pow(m,2),y=Math.abs(c)>ge?Math.tan(t):0,T=Math.pow(y,2),w=Math.pow(T,2);r=1-this.es*Math.pow(a,2),d=d/Math.sqrt(r);var A=zh(t,a,c,this.en);s=this.a*(this.k0*d*(1+g/6*(1-T+m+g/20*(5-18*T+w+14*m-58*T*m+g/42*(61+179*w-w*T-479*T)))))+this.x0,o=this.a*(this.k0*(A-this.ml0+a*i*d/2*(1+g/12*(5-T+9*m+4*v+g/30*(61+w-58*T+270*m-330*T*m+g/56*(1385+543*w-w*T-3111*T))))))+this.y0}else{var h=c*Math.sin(i);if(Math.abs(Math.abs(h)-1)<ge)return 93;if(s=.5*this.a*this.k0*Math.log((1+h)/(1-h))+this.x0,o=c*Math.cos(i)/Math.sqrt(1-Math.pow(h,2)),h=Math.abs(o),h>=1){if(h-1>ge)return 93;o=0}else o=Math.acos(o);t<0&&(o=-o),o=this.a*this.k0*(o-this.lat0)+this.y0}return n.x=s,n.y=o,n}function aJ(n){var e,t,i,r,s=(n.x-this.x0)*(1/this.a),o=(n.y-this.y0)*(1/this.a);if(this.es)if(e=this.ml0+o/this.k0,t=_T(e,this.es,this.en),Math.abs(t)<se){var g=Math.sin(t),m=Math.cos(t),v=Math.abs(m)>ge?Math.tan(t):0,y=this.ep2*Math.pow(m,2),T=Math.pow(y,2),w=Math.pow(v,2),A=Math.pow(w,2);e=1-this.es*Math.pow(g,2);var P=s*Math.sqrt(e)/this.k0,C=Math.pow(P,2);e=e*v,i=t-e*C/(1-this.es)*.5*(1-C/12*(5+3*w-9*y*w+y-4*T-C/30*(61+90*w-252*y*w+45*A+46*y-C/56*(1385+3633*w+4095*A+1574*A*w)))),r=_e(this.long0+P*(1-C/6*(1+2*w+y-C/20*(5+28*w+24*A+8*y*w+6*y-C/42*(61+662*w+1320*A+720*A*w))))/m,this.over)}else i=se*Hg(o),r=0;else{var a=Math.exp(s/this.k0),c=.5*(a-1/a),h=this.lat0+o/this.k0,d=Math.cos(h);e=Math.sqrt((1-Math.pow(d,2))/(1+Math.pow(c,2))),i=Math.asin(e),o<0&&(i=-i),c===0&&d===0?r=0:r=_e(Math.atan2(c,d)+this.long0,this.over)}return n.x=r,n.y=i,n}var lJ=["Fast_Transverse_Mercator","Fast Transverse Mercator"];const o0={init:sJ,forward:oJ,inverse:aJ,names:lJ};function z3(n){var e=Math.exp(n);return e=(e-1/e)/2,e}function Ci(n,e){n=Math.abs(n),e=Math.abs(e);var t=Math.max(n,e),i=Math.min(n,e)/(t||1);return t*Math.sqrt(1+Math.pow(i,2))}function cJ(n){var e=1+n,t=e-1;return t===0?n:n*Math.log(e)/t}function uJ(n){var e=Math.abs(n);return e=cJ(e*(1+e/(Ci(1,e)+1))),n<0?-e:e}function yT(n,e){for(var t=2*Math.cos(2*e),i=n.length-1,r=n[i],s=0,o;--i>=0;)o=-s+t*r+n[i],s=r,r=o;return e+o*Math.sin(2*e)}function hJ(n,e){for(var t=2*Math.cos(e),i=n.length-1,r=n[i],s=0,o;--i>=0;)o=-s+t*r+n[i],s=r,r=o;return Math.sin(e)*o}function dJ(n){var e=Math.exp(n);return e=(e+1/e)/2,e}function B3(n,e,t){for(var i=Math.sin(e),r=Math.cos(e),s=z3(t),o=dJ(t),a=2*r*o,c=-2*i*s,h=n.length-1,d=n[h],g=0,m=0,v=0,y,T;--h>=0;)y=m,T=g,m=d,g=v,d=-y+a*m-c*g+n[h],v=-T+c*m+a*g;return a=i*o,c=r*s,[a*d-c*v,a*v+c*d]}function fJ(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(o0.init.apply(this),this.forward=o0.forward,this.inverse=o0.inverse),this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var n=this.es/(1+Math.sqrt(1-this.es)),e=n/(2-n),t=e;this.cgb[0]=e*(2+e*(-2/3+e*(-2+e*(116/45+e*(26/45+e*(-2854/675)))))),this.cbg[0]=e*(-2+e*(2/3+e*(4/3+e*(-82/45+e*(32/45+e*(4642/4725)))))),t=t*e,this.cgb[1]=t*(7/3+e*(-8/5+e*(-227/45+e*(2704/315+e*(2323/945))))),this.cbg[1]=t*(5/3+e*(-16/15+e*(-13/9+e*(904/315+e*(-1522/945))))),t=t*e,this.cgb[2]=t*(56/15+e*(-136/35+e*(-1262/105+e*(73814/2835)))),this.cbg[2]=t*(-26/15+e*(34/21+e*(8/5+e*(-12686/2835)))),t=t*e,this.cgb[3]=t*(4279/630+e*(-332/35+e*(-399572/14175))),this.cbg[3]=t*(1237/630+e*(-12/5+e*(-24832/14175))),t=t*e,this.cgb[4]=t*(4174/315+e*(-144838/6237)),this.cbg[4]=t*(-734/315+e*(109598/31185)),t=t*e,this.cgb[5]=t*(601676/22275),this.cbg[5]=t*(444337/155925),t=Math.pow(e,2),this.Qn=this.k0/(1+e)*(1+t*(1/4+t*(1/64+t/256))),this.utg[0]=e*(-.5+e*(2/3+e*(-37/96+e*(1/360+e*(81/512+e*(-96199/604800)))))),this.gtu[0]=e*(.5+e*(-2/3+e*(5/16+e*(41/180+e*(-127/288+e*(7891/37800)))))),this.utg[1]=t*(-1/48+e*(-1/15+e*(437/1440+e*(-46/105+e*(1118711/3870720))))),this.gtu[1]=t*(13/48+e*(-3/5+e*(557/1440+e*(281/630+e*(-1983433/1935360))))),t=t*e,this.utg[2]=t*(-17/480+e*(37/840+e*(209/4480+e*(-5569/90720)))),this.gtu[2]=t*(61/240+e*(-103/140+e*(15061/26880+e*(167603/181440)))),t=t*e,this.utg[3]=t*(-4397/161280+e*(11/504+e*(830251/7257600))),this.gtu[3]=t*(49561/161280+e*(-179/168+e*(6601661/7257600))),t=t*e,this.utg[4]=t*(-4583/161280+e*(108847/3991680)),this.gtu[4]=t*(34729/80640+e*(-3418889/1995840)),t=t*e,this.utg[5]=t*(-20648693/638668800),this.gtu[5]=t*(212378941/319334400);var i=yT(this.cbg,this.lat0);this.Zb=-this.Qn*(i+hJ(this.gtu,2*i))}function gJ(n){var e=_e(n.x-this.long0,this.over),t=n.y;t=yT(this.cbg,t);var i=Math.sin(t),r=Math.cos(t),s=Math.sin(e),o=Math.cos(e);t=Math.atan2(i,o*r),e=Math.atan2(s*r,Ci(i,r*o)),e=uJ(Math.tan(e));var a=B3(this.gtu,2*t,2*e);t=t+a[0],e=e+a[1];var c,h;return Math.abs(e)<=2.623395162778?(c=this.a*(this.Qn*e)+this.x0,h=this.a*(this.Qn*t+this.Zb)+this.y0):(c=1/0,h=1/0),n.x=c,n.y=h,n}function mJ(n){var e=(n.x-this.x0)*(1/this.a),t=(n.y-this.y0)*(1/this.a);t=(t-this.Zb)/this.Qn,e=e/this.Qn;var i,r;if(Math.abs(e)<=2.623395162778){var s=B3(this.utg,2*t,2*e);t=t+s[0],e=e+s[1],e=Math.atan(z3(e));var o=Math.sin(t),a=Math.cos(t),c=Math.sin(e),h=Math.cos(e);t=Math.atan2(o*h,Ci(c,h*a)),e=Math.atan2(c,h*a),i=_e(e+this.long0,this.over),r=yT(this.cgb,t)}else i=1/0,r=1/0;return n.x=i,n.y=r,n}var pJ=["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","Gauss Kruger","Gauss_Kruger","tmerc"];const a0={init:fJ,forward:gJ,inverse:mJ,names:pJ};function _J(n,e){if(n===void 0){if(n=Math.floor((_e(e)+Math.PI)*30/Math.PI)+1,n<0)return 0;if(n>60)return 60}return n}var yJ="etmerc";function vJ(){var n=_J(this.zone,this.long0);if(n===void 0)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(n)-183)*qt,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,a0.init.apply(this),this.forward=a0.forward,this.inverse=a0.inverse}var EJ=["Universal Transverse Mercator System","utm"];const wJ={init:vJ,names:EJ,dependsOn:yJ};function vT(n,e){return Math.pow((1-n)/(1+n),e)}var xJ=20;function SJ(){var n=Math.sin(this.lat0),e=Math.cos(this.lat0);e*=e,this.rc=Math.sqrt(1-this.es)/(1-this.es*n*n),this.C=Math.sqrt(1+this.es*e*e/(1-this.es)),this.phic0=Math.asin(n/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+mt)/(Math.pow(Math.tan(.5*this.lat0+mt),this.C)*vT(this.e*n,this.ratexp))}function TJ(n){var e=n.x,t=n.y;return n.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*t+mt),this.C)*vT(this.e*Math.sin(t),this.ratexp))-se,n.x=this.C*e,n}function IJ(n){for(var e=1e-14,t=n.x/this.C,i=n.y,r=Math.pow(Math.tan(.5*i+mt)/this.K,1/this.C),s=xJ;s>0&&(i=2*Math.atan(r*vT(this.e*Math.sin(n.y),-.5*this.e))-se,!(Math.abs(i-n.y)<e));--s)n.y=i;return s?(n.x=t,n.y=i,n):null}const ET={init:SJ,forward:TJ,inverse:IJ};function AJ(){ET.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))}function RJ(n){var e,t,i,r;return n.x=_e(n.x-this.long0,this.over),ET.forward.apply(this,[n]),e=Math.sin(n.y),t=Math.cos(n.y),i=Math.cos(n.x),r=this.k0*this.R2/(1+this.sinc0*e+this.cosc0*t*i),n.x=r*t*Math.sin(n.x),n.y=r*(this.cosc0*e-this.sinc0*t*i),n.x=this.a*n.x+this.x0,n.y=this.a*n.y+this.y0,n}function PJ(n){var e,t,i,r,s;if(n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a,n.x/=this.k0,n.y/=this.k0,s=Ci(n.x,n.y)){var o=2*Math.atan2(s,this.R2);e=Math.sin(o),t=Math.cos(o),r=Math.asin(t*this.sinc0+n.y*e*this.cosc0/s),i=Math.atan2(n.x*e,s*this.cosc0*t-n.y*this.sinc0*e)}else r=this.phic0,i=0;return n.x=i,n.y=r,ET.inverse.apply(this,[n]),n.x=_e(n.x+this.long0,this.over),n}var CJ=["Stereographic_North_Pole","Oblique_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"];const MJ={init:AJ,forward:RJ,inverse:PJ,names:CJ};function wT(n,e,t){return e*=t,Math.tan(.5*(se+n))*Math.pow((1-e)/(1+e),.5*t)}function bJ(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=ge&&(this.k0=.5*(1+Hg(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=ge&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=ge&&Math.abs(Math.cos(this.lat_ts))>ge&&(this.k0=.5*this.cons*Ds(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/Xr(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=Ds(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(wT(this.lat0,this.sinlat0,this.e))-se,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))}function kJ(n){var e=n.x,t=n.y,i=Math.sin(t),r=Math.cos(t),s,o,a,c,h,d,g=_e(e-this.long0,this.over);return Math.abs(Math.abs(e-this.long0)-Math.PI)<=ge&&Math.abs(t+this.lat0)<=ge?(n.x=NaN,n.y=NaN,n):this.sphere?(s=2*this.k0/(1+this.sinlat0*i+this.coslat0*r*Math.cos(g)),n.x=this.a*s*r*Math.sin(g)+this.x0,n.y=this.a*s*(this.coslat0*i-this.sinlat0*r*Math.cos(g))+this.y0,n):(o=2*Math.atan(wT(t,i,this.e))-se,c=Math.cos(o),a=Math.sin(o),Math.abs(this.coslat0)<=ge?(h=Xr(this.e,t*this.con,this.con*i),d=2*this.a*this.k0*h/this.cons,n.x=this.x0+d*Math.sin(e-this.long0),n.y=this.y0-this.con*d*Math.cos(e-this.long0),n):(Math.abs(this.sinlat0)<ge?(s=2*this.a*this.k0/(1+c*Math.cos(g)),n.y=s*a):(s=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*a+this.cosX0*c*Math.cos(g))),n.y=s*(this.cosX0*a-this.sinX0*c*Math.cos(g))+this.y0),n.x=s*c*Math.sin(g)+this.x0,n))}function LJ(n){n.x-=this.x0,n.y-=this.y0;var e,t,i,r,s,o=Math.sqrt(n.x*n.x+n.y*n.y);if(this.sphere){var a=2*Math.atan(o/(2*this.a*this.k0));return e=this.long0,t=this.lat0,o<=ge?(n.x=e,n.y=t,n):(t=Math.asin(Math.cos(a)*this.sinlat0+n.y*Math.sin(a)*this.coslat0/o),Math.abs(this.coslat0)<ge?this.lat0>0?e=_e(this.long0+Math.atan2(n.x,-1*n.y),this.over):e=_e(this.long0+Math.atan2(n.x,n.y),this.over):e=_e(this.long0+Math.atan2(n.x*Math.sin(a),o*this.coslat0*Math.cos(a)-n.y*this.sinlat0*Math.sin(a)),this.over),n.x=e,n.y=t,n)}else if(Math.abs(this.coslat0)<=ge){if(o<=ge)return t=this.lat0,e=this.long0,n.x=e,n.y=t,n;n.x*=this.con,n.y*=this.con,i=o*this.cons/(2*this.a*this.k0),t=this.con*mg(this.e,i),e=this.con*_e(this.con*this.long0+Math.atan2(n.x,-1*n.y),this.over)}else r=2*Math.atan(o*this.cosX0/(2*this.a*this.k0*this.ms1)),e=this.long0,o<=ge?s=this.X0:(s=Math.asin(Math.cos(r)*this.sinX0+n.y*Math.sin(r)*this.cosX0/o),e=_e(this.long0+Math.atan2(n.x*Math.sin(r),o*this.cosX0*Math.cos(r)-n.y*this.sinX0*Math.sin(r)),this.over)),t=-1*mg(this.e,Math.tan(.5*(se+s)));return n.x=e,n.y=t,n}var NJ=["stere","Stereographic_South_Pole","Polar_Stereographic_variant_A","Polar_Stereographic_variant_B","Polar_Stereographic"];const DJ={init:bJ,forward:kJ,inverse:LJ,names:NJ,ssfn_:wT};function OJ(){var n=this.lat0;this.lambda0=this.long0;var e=Math.sin(n),t=this.a,i=this.rf,r=1/i,s=2*r-Math.pow(r,2),o=this.e=Math.sqrt(s);this.R=this.k0*t*Math.sqrt(1-s)/(1-s*Math.pow(e,2)),this.alpha=Math.sqrt(1+s/(1-s)*Math.pow(Math.cos(n),4)),this.b0=Math.asin(e/this.alpha);var a=Math.log(Math.tan(Math.PI/4+this.b0/2)),c=Math.log(Math.tan(Math.PI/4+n/2)),h=Math.log((1+o*e)/(1-o*e));this.K=a-this.alpha*c+this.alpha*o/2*h}function VJ(n){var e=Math.log(Math.tan(Math.PI/4-n.y/2)),t=this.e/2*Math.log((1+this.e*Math.sin(n.y))/(1-this.e*Math.sin(n.y))),i=-this.alpha*(e+t)+this.K,r=2*(Math.atan(Math.exp(i))-Math.PI/4),s=this.alpha*(n.x-this.lambda0),o=Math.atan(Math.sin(s)/(Math.sin(this.b0)*Math.tan(r)+Math.cos(this.b0)*Math.cos(s))),a=Math.asin(Math.cos(this.b0)*Math.sin(r)-Math.sin(this.b0)*Math.cos(r)*Math.cos(s));return n.y=this.R/2*Math.log((1+Math.sin(a))/(1-Math.sin(a)))+this.y0,n.x=this.R*o+this.x0,n}function FJ(n){for(var e=n.x-this.x0,t=n.y-this.y0,i=e/this.R,r=2*(Math.atan(Math.exp(t/this.R))-Math.PI/4),s=Math.asin(Math.cos(this.b0)*Math.sin(r)+Math.sin(this.b0)*Math.cos(r)*Math.cos(i)),o=Math.atan(Math.sin(i)/(Math.cos(this.b0)*Math.cos(i)-Math.sin(this.b0)*Math.tan(r))),a=this.lambda0+o/this.alpha,c=0,h=s,d=-1e3,g=0;Math.abs(h-d)>1e-7;){if(++g>20)return;c=1/this.alpha*(Math.log(Math.tan(Math.PI/4+s/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(h))/2)),d=h,h=2*Math.atan(Math.exp(c))-Math.PI/2}return n.x=a,n.y=h,n}var jJ=["somerc"];const GJ={init:OJ,forward:VJ,inverse:FJ,names:jJ};var Nu=1e-7;function UJ(n){var e=["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_variant_A","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"],t=typeof n.projName=="object"?Object.keys(n.projName)[0]:n.projName;return"no_uoff"in n||"no_off"in n||e.indexOf(t)!==-1||e.indexOf(b3(t))!==-1}function zJ(){var n,e,t,i,r,s,o,a,c,h,d=0,g,m=0,v=0,y=0,T=0,w=0,A=0;this.no_off=UJ(this),this.no_rot="no_rot"in this;var P=!1;"alpha"in this&&(P=!0);var C=!1;if("rectified_grid_angle"in this&&(C=!0),P&&(A=this.alpha),C&&(d=this.rectified_grid_angle),P||C)m=this.longc;else if(v=this.long1,T=this.lat1,y=this.long2,w=this.lat2,Math.abs(T-w)<=Nu||(n=Math.abs(T))<=Nu||Math.abs(n-se)<=Nu||Math.abs(Math.abs(this.lat0)-se)<=Nu||Math.abs(Math.abs(w)-se)<=Nu)throw new Error;var N=1-this.es;e=Math.sqrt(N),Math.abs(this.lat0)>ge?(a=Math.sin(this.lat0),t=Math.cos(this.lat0),n=1-this.es*a*a,this.B=t*t,this.B=Math.sqrt(1+this.es*this.B*this.B/N),this.A=this.B*this.k0*e/n,i=this.B*e/(t*Math.sqrt(n)),r=i*i-1,r<=0?r=0:(r=Math.sqrt(r),this.lat0<0&&(r=-r)),this.E=r+=i,this.E*=Math.pow(Xr(this.e,this.lat0,a),this.B)):(this.B=1/e,this.A=this.k0,this.E=i=r=1),P||C?(P?(g=Math.asin(Math.sin(A)/i),C||(d=A)):(g=d,A=Math.asin(i*Math.sin(g))),this.lam0=m-Math.asin(.5*(r-1/r)*Math.tan(g))/this.B):(s=Math.pow(Xr(this.e,T,Math.sin(T)),this.B),o=Math.pow(Xr(this.e,w,Math.sin(w)),this.B),r=this.E/s,c=(o-s)/(o+s),h=this.E*this.E,h=(h-o*s)/(h+o*s),n=v-y,n<-Math.PI?y-=fg:n>Math.PI&&(y+=fg),this.lam0=_e(.5*(v+y)-Math.atan(h*Math.tan(.5*this.B*(v-y))/c)/this.B,this.over),g=Math.atan(2*Math.sin(this.B*_e(v-this.lam0,this.over))/(r-1/r)),d=A=Math.asin(i*Math.sin(g))),this.singam=Math.sin(g),this.cosgam=Math.cos(g),this.sinrot=Math.sin(d),this.cosrot=Math.cos(d),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(i*i-1)/Math.cos(A))),this.lat0<0&&(this.u_0=-this.u_0)),r=.5*g,this.v_pole_n=this.ArB*Math.log(Math.tan(mt-r)),this.v_pole_s=this.ArB*Math.log(Math.tan(mt+r))}function BJ(n){var e={},t,i,r,s,o,a,c,h;if(n.x=n.x-this.lam0,Math.abs(Math.abs(n.y)-se)>ge){if(o=this.E/Math.pow(Xr(this.e,n.y,Math.sin(n.y)),this.B),a=1/o,t=.5*(o-a),i=.5*(o+a),s=Math.sin(this.B*n.x),r=(t*this.singam-s*this.cosgam)/i,Math.abs(Math.abs(r)-1)<ge)throw new Error;h=.5*this.ArB*Math.log((1-r)/(1+r)),a=Math.cos(this.B*n.x),Math.abs(a)<Nu?c=this.A*n.x:c=this.ArB*Math.atan2(t*this.cosgam+s*this.singam,a)}else h=n.y>0?this.v_pole_n:this.v_pole_s,c=this.ArB*n.y;return this.no_rot?(e.x=c,e.y=h):(c-=this.u_0,e.x=h*this.cosrot+c*this.sinrot,e.y=c*this.cosrot-h*this.sinrot),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e}function $J(n){var e,t,i,r,s,o,a,c={};if(n.x=(n.x-this.x0)*(1/this.a),n.y=(n.y-this.y0)*(1/this.a),this.no_rot?(t=n.y,e=n.x):(t=n.x*this.cosrot-n.y*this.sinrot,e=n.y*this.cosrot+n.x*this.sinrot+this.u_0),i=Math.exp(-this.BrA*t),r=.5*(i-1/i),s=.5*(i+1/i),o=Math.sin(this.BrA*e),a=(o*this.cosgam+r*this.singam)/s,Math.abs(Math.abs(a)-1)<ge)c.x=0,c.y=a<0?-se:se;else{if(c.y=this.E/Math.sqrt((1+a)/(1-a)),c.y=mg(this.e,Math.pow(c.y,1/this.B)),c.y===1/0)throw new Error;c.x=-this.rB*Math.atan2(r*this.cosgam-o*this.singam,Math.cos(this.BrA*e))}return c.x+=this.lam0,c}var WJ=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_variant_A","Hotine_Oblique_Mercator_Variant_B","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"];const KJ={init:zJ,forward:BJ,inverse:$J,names:WJ};function qJ(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<ge)){var n=this.b/this.a;this.e=Math.sqrt(1-n*n);var e=Math.sin(this.lat1),t=Math.cos(this.lat1),i=Ds(this.e,e,t),r=Xr(this.e,this.lat1,e),s=Math.sin(this.lat2),o=Math.cos(this.lat2),a=Ds(this.e,s,o),c=Xr(this.e,this.lat2,s),h=Math.abs(Math.abs(this.lat0)-se)<ge?0:Xr(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>ge?this.ns=Math.log(i/a)/Math.log(r/c):this.ns=e,isNaN(this.ns)&&(this.ns=e),this.f0=i/(this.ns*Math.pow(r,this.ns)),this.rh=this.a*this.f0*Math.pow(h,this.ns),this.title||(this.title="Lambert Conformal Conic")}}function HJ(n){var e=n.x,t=n.y;Math.abs(2*Math.abs(t)-Math.PI)<=ge&&(t=Hg(t)*(se-2*ge));var i=Math.abs(Math.abs(t)-se),r,s;if(i>ge)r=Xr(this.e,t,Math.sin(t)),s=this.a*this.f0*Math.pow(r,this.ns);else{if(i=t*this.ns,i<=0)return null;s=0}var o=this.ns*_e(e-this.long0,this.over);return n.x=this.k0*(s*Math.sin(o))+this.x0,n.y=this.k0*(this.rh-s*Math.cos(o))+this.y0,n}function XJ(n){var e,t,i,r,s,o=(n.x-this.x0)/this.k0,a=this.rh-(n.y-this.y0)/this.k0;this.ns>0?(e=Math.sqrt(o*o+a*a),t=1):(e=-Math.sqrt(o*o+a*a),t=-1);var c=0;if(e!==0&&(c=Math.atan2(t*o,t*a)),e!==0||this.ns>0){if(t=1/this.ns,i=Math.pow(e/(this.a*this.f0),t),r=mg(this.e,i),r===-9999)return null}else r=-se;return s=_e(c/this.ns+this.long0,this.over),n.x=s,n.y=r,n}var YJ=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"];const ZJ={init:qJ,forward:HJ,inverse:XJ,names:YJ};function QJ(){this.a=6377397155e-3,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.7417649320975901-.308341501185665),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq}function JJ(n){var e,t,i,r,s,o,a,c=n.x,h=n.y,d=_e(c-this.long0,this.over);return e=Math.pow((1+this.e*Math.sin(h))/(1-this.e*Math.sin(h)),this.alfa*this.e/2),t=2*(Math.atan(this.k*Math.pow(Math.tan(h/2+this.s45),this.alfa)/e)-this.s45),i=-d*this.alfa,r=Math.asin(Math.cos(this.ad)*Math.sin(t)+Math.sin(this.ad)*Math.cos(t)*Math.cos(i)),s=Math.asin(Math.cos(t)*Math.sin(i)/Math.cos(r)),o=this.n*s,a=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(r/2+this.s45),this.n),n.y=a*Math.cos(o)/1,n.x=a*Math.sin(o)/1,this.czech||(n.y*=-1,n.x*=-1),n}function eee(n){var e,t,i,r,s,o,a,c,h=n.x;n.x=n.y,n.y=h,this.czech||(n.y*=-1,n.x*=-1),o=Math.sqrt(n.x*n.x+n.y*n.y),s=Math.atan2(n.y,n.x),r=s/Math.sin(this.s0),i=2*(Math.atan(Math.pow(this.ro0/o,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),e=Math.asin(Math.cos(this.ad)*Math.sin(i)-Math.sin(this.ad)*Math.cos(i)*Math.cos(r)),t=Math.asin(Math.cos(i)*Math.sin(r)/Math.cos(e)),n.x=this.long0-t/this.alfa,a=e,c=0;var d=0;do n.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(e/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(a))/(1-this.e*Math.sin(a)),this.e/2))-this.s45),Math.abs(a-n.y)<1e-10&&(c=1),a=n.y,d+=1;while(c===0&&d<15);return d>=15?null:n}var tee=["Krovak","krovak"];const nee={init:QJ,forward:JJ,inverse:eee,names:tee};function di(n,e,t,i,r){return n*r-e*Math.sin(2*r)+t*Math.sin(4*r)-i*Math.sin(6*r)}function Xg(n){return 1-.25*n*(1+n/16*(3+1.25*n))}function Yg(n){return .375*n*(1+.25*n*(1+.46875*n))}function Zg(n){return .05859375*n*n*(1+.75*n)}function Qg(n){return n*n*n*(35/3072)}function xT(n,e,t){var i=e*t;return n/Math.sqrt(1-i*i)}function Qa(n){return Math.abs(n)<se?n:n-Hg(n)*Math.PI}function g_(n,e,t,i,r){var s,o;s=n/e;for(var a=0;a<15;a++)if(o=(n-(e*s-t*Math.sin(2*s)+i*Math.sin(4*s)-r*Math.sin(6*s)))/(e-2*t*Math.cos(2*s)+4*i*Math.cos(4*s)-6*r*Math.cos(6*s)),s+=o,Math.abs(o)<=1e-10)return s;return NaN}function iee(){this.sphere||(this.e0=Xg(this.es),this.e1=Yg(this.es),this.e2=Zg(this.es),this.e3=Qg(this.es),this.ml0=this.a*di(this.e0,this.e1,this.e2,this.e3,this.lat0))}function ree(n){var e,t,i=n.x,r=n.y;if(i=_e(i-this.long0,this.over),this.sphere)e=this.a*Math.asin(Math.cos(r)*Math.sin(i)),t=this.a*(Math.atan2(Math.tan(r),Math.cos(i))-this.lat0);else{var s=Math.sin(r),o=Math.cos(r),a=xT(this.a,this.e,s),c=Math.tan(r)*Math.tan(r),h=i*Math.cos(r),d=h*h,g=this.es*o*o/(1-this.es),m=this.a*di(this.e0,this.e1,this.e2,this.e3,r);e=a*h*(1-d*c*(1/6-(8-c+8*g)*d/120)),t=m-this.ml0+a*s/o*d*(.5+(5-c+6*g)*d/24)}return n.x=e+this.x0,n.y=t+this.y0,n}function see(n){n.x-=this.x0,n.y-=this.y0;var e=n.x/this.a,t=n.y/this.a,i,r;if(this.sphere){var s=t+this.lat0;i=Math.asin(Math.sin(s)*Math.cos(e)),r=Math.atan2(Math.tan(e),Math.cos(s))}else{var o=this.ml0/this.a+t,a=g_(o,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(a)-se)<=ge)return n.x=this.long0,n.y=se,t<0&&(n.y*=-1),n;var c=xT(this.a,this.e,Math.sin(a)),h=c*c*c/this.a/this.a*(1-this.es),d=Math.pow(Math.tan(a),2),g=e*this.a/c,m=g*g;i=a-c*Math.tan(a)/h*g*g*(.5-(1+3*d)*g*g/24),r=g*(1-m*(d/3+(1+3*d)*d*m/15))/Math.cos(a)}return n.x=_e(r+this.long0,this.over),n.y=Qa(i),n}var oee=["Cassini","Cassini_Soldner","cass"];const aee={init:iee,forward:ree,inverse:see,names:oee};function Na(n,e){var t;return n>1e-7?(t=n*e,(1-n*n)*(e/(1-t*t)-.5/n*Math.log((1-t)/(1+t)))):2*e}var Vw=1,Fw=2,jw=3,l0=4;function lee(){var n=Math.abs(this.lat0);if(Math.abs(n-se)<ge?this.mode=this.lat0<0?Vw:Fw:Math.abs(n)<ge?this.mode=jw:this.mode=l0,this.es>0){var e;switch(this.qp=Na(this.e,1),this.mmf=.5/(1-this.es),this.apa=_ee(this.es),this.mode){case Fw:this.dd=1;break;case Vw:this.dd=1;break;case jw:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case l0:this.rq=Math.sqrt(.5*this.qp),e=Math.sin(this.lat0),this.sinb1=Na(this.e,e)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*e*e)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd;break}}else this.mode===l0&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))}function cee(n){var e,t,i,r,s,o,a,c,h,d,g=n.x,m=n.y;if(g=_e(g-this.long0,this.over),this.sphere){if(s=Math.sin(m),d=Math.cos(m),i=Math.cos(g),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(t=this.mode===this.EQUIT?1+d*i:1+this.sinph0*s+this.cosph0*d*i,t<=ge)return null;t=Math.sqrt(2/t),e=t*d*Math.sin(g),t*=this.mode===this.EQUIT?s:this.cosph0*s-this.sinph0*d*i}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(i=-i),Math.abs(m+this.lat0)<ge)return null;t=mt-m*.5,t=2*(this.mode===this.S_POLE?Math.cos(t):Math.sin(t)),e=t*Math.sin(g),t*=i}}else{switch(a=0,c=0,h=0,i=Math.cos(g),r=Math.sin(g),s=Math.sin(m),o=Na(this.e,s),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(a=o/this.qp,c=Math.sqrt(1-a*a)),this.mode){case this.OBLIQ:h=1+this.sinb1*a+this.cosb1*c*i;break;case this.EQUIT:h=1+c*i;break;case this.N_POLE:h=se+m,o=this.qp-o;break;case this.S_POLE:h=m-se,o=this.qp+o;break}if(Math.abs(h)<ge)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:h=Math.sqrt(2/h),this.mode===this.OBLIQ?t=this.ymf*h*(this.cosb1*a-this.sinb1*c*i):t=(h=Math.sqrt(2/(1+c*i)))*a*this.ymf,e=this.xmf*h*c*r;break;case this.N_POLE:case this.S_POLE:o>=0?(e=(h=Math.sqrt(o))*r,t=i*(this.mode===this.S_POLE?h:-h)):e=t=0;break}}return n.x=this.a*e+this.x0,n.y=this.a*t+this.y0,n}function uee(n){n.x-=this.x0,n.y-=this.y0;var e=n.x/this.a,t=n.y/this.a,i,r,s,o,a,c,h;if(this.sphere){var d=0,g,m=0;if(g=Math.sqrt(e*e+t*t),r=g*.5,r>1)return null;switch(r=2*Math.asin(r),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(m=Math.sin(r),d=Math.cos(r)),this.mode){case this.EQUIT:r=Math.abs(g)<=ge?0:Math.asin(t*m/g),e*=m,t=d*g;break;case this.OBLIQ:r=Math.abs(g)<=ge?this.lat0:Math.asin(d*this.sinph0+t*m*this.cosph0/g),e*=m*this.cosph0,t=(d-Math.sin(r)*this.sinph0)*g;break;case this.N_POLE:t=-t,r=se-r;break;case this.S_POLE:r-=se;break}i=t===0&&(this.mode===this.EQUIT||this.mode===this.OBLIQ)?0:Math.atan2(e,t)}else{if(h=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(e/=this.dd,t*=this.dd,c=Math.sqrt(e*e+t*t),c<ge)return n.x=this.long0,n.y=this.lat0,n;o=2*Math.asin(.5*c/this.rq),s=Math.cos(o),e*=o=Math.sin(o),this.mode===this.OBLIQ?(h=s*this.sinb1+t*o*this.cosb1/c,a=this.qp*h,t=c*this.cosb1*s-t*this.sinb1*o):(h=t*o/c,a=this.qp*h,t=c*s)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(t=-t),a=e*e+t*t,!a)return n.x=this.long0,n.y=this.lat0,n;h=1-a/this.qp,this.mode===this.S_POLE&&(h=-h)}i=Math.atan2(e,t),r=yee(Math.asin(h),this.apa)}return n.x=_e(this.long0+i,this.over),n.y=r,n}var hee=.3333333333333333,dee=.17222222222222222,fee=.10257936507936508,gee=.06388888888888888,mee=.0664021164021164,pee=.016415012942191543;function _ee(n){var e,t=[];return t[0]=n*hee,e=n*n,t[0]+=e*dee,t[1]=e*gee,e*=n,t[0]+=e*fee,t[1]+=e*mee,t[2]=e*pee,t}function yee(n,e){var t=n+n;return n+e[0]*Math.sin(t)+e[1]*Math.sin(t+t)+e[2]*Math.sin(t+t+t)}var vee=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"];const Eee={init:lee,forward:cee,inverse:uee,names:vee,S_POLE:Vw,N_POLE:Fw,EQUIT:jw,OBLIQ:l0};function Ka(n){return Math.abs(n)>1&&(n=n>1?1:-1),Math.asin(n)}function wee(){Math.abs(this.lat1+this.lat2)<ge||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=Ds(this.e3,this.sin_po,this.cos_po),this.qs1=Na(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=Ds(this.e3,this.sin_po,this.cos_po),this.qs2=Na(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=Na(this.e3,this.sin_po),Math.abs(this.lat1-this.lat2)>ge?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)}function xee(n){var e=n.x,t=n.y;this.sin_phi=Math.sin(t),this.cos_phi=Math.cos(t);var i=Na(this.e3,this.sin_phi),r=this.a*Math.sqrt(this.c-this.ns0*i)/this.ns0,s=this.ns0*_e(e-this.long0,this.over),o=r*Math.sin(s)+this.x0,a=this.rh-r*Math.cos(s)+this.y0;return n.x=o,n.y=a,n}function See(n){var e,t,i,r,s,o;return n.x-=this.x0,n.y=this.rh-n.y+this.y0,this.ns0>=0?(e=Math.sqrt(n.x*n.x+n.y*n.y),i=1):(e=-Math.sqrt(n.x*n.x+n.y*n.y),i=-1),r=0,e!==0&&(r=Math.atan2(i*n.x,i*n.y)),i=e*this.ns0/this.a,this.sphere?o=Math.asin((this.c-i*i)/(2*this.ns0)):(t=(this.c-i*i)/this.ns0,o=this.phi1z(this.e3,t)),s=_e(r/this.ns0+this.long0,this.over),n.x=s,n.y=o,n}function Tee(n,e){var t,i,r,s,o,a=Ka(.5*e);if(n<ge)return a;for(var c=n*n,h=1;h<=25;h++)if(t=Math.sin(a),i=Math.cos(a),r=n*t,s=1-r*r,o=.5*s*s/i*(e/(1-c)-t/s+.5/n*Math.log((1-r)/(1+r))),a=a+o,Math.abs(o)<=1e-7)return a;return null}var Iee=["Albers_Conic_Equal_Area","Albers_Equal_Area","Albers","aea"];const Aee={init:wee,forward:xee,inverse:See,names:Iee,phi1z:Tee};function Ree(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1}function Pee(n){var e,t,i,r,s,o,a,c,h=n.x,d=n.y;return i=_e(h-this.long0,this.over),e=Math.sin(d),t=Math.cos(d),r=Math.cos(i),o=this.sin_p14*e+this.cos_p14*t*r,s=1,o>0||Math.abs(o)<=ge?(a=this.x0+this.a*s*t*Math.sin(i)/o,c=this.y0+this.a*s*(this.cos_p14*e-this.sin_p14*t*r)/o):(a=this.x0+this.infinity_dist*t*Math.sin(i),c=this.y0+this.infinity_dist*(this.cos_p14*e-this.sin_p14*t*r)),n.x=a,n.y=c,n}function Cee(n){var e,t,i,r,s,o;return n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a,n.x/=this.k0,n.y/=this.k0,(e=Math.sqrt(n.x*n.x+n.y*n.y))?(r=Math.atan2(e,this.rc),t=Math.sin(r),i=Math.cos(r),o=Ka(i*this.sin_p14+n.y*t*this.cos_p14/e),s=Math.atan2(n.x*t,e*this.cos_p14*i-n.y*this.sin_p14*t),s=_e(this.long0+s,this.over)):(o=this.phic0,s=0),n.x=s,n.y=o,n}var Mee=["gnom"];const bee={init:Ree,forward:Pee,inverse:Cee,names:Mee};function kee(n,e){var t=1-(1-n*n)/(2*n)*Math.log((1-n)/(1+n));if(Math.abs(Math.abs(e)-t)<1e-6)return e<0?-1*se:se;for(var i=Math.asin(.5*e),r,s,o,a,c=0;c<30;c++)if(s=Math.sin(i),o=Math.cos(i),a=n*s,r=Math.pow(1-a*a,2)/(2*o)*(e/(1-n*n)-s/(1-a*a)+.5/n*Math.log((1-a)/(1+a))),i+=r,Math.abs(r)<=1e-10)return i;return NaN}function Lee(){this.sphere||(this.k0=Ds(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))}function Nee(n){var e=n.x,t=n.y,i,r,s=_e(e-this.long0,this.over);if(this.sphere)i=this.x0+this.a*s*Math.cos(this.lat_ts),r=this.y0+this.a*Math.sin(t)/Math.cos(this.lat_ts);else{var o=Na(this.e,Math.sin(t));i=this.x0+this.a*this.k0*s,r=this.y0+this.a*o*.5/this.k0}return n.x=i,n.y=r,n}function Dee(n){n.x-=this.x0,n.y-=this.y0;var e,t;return this.sphere?(e=_e(this.long0+n.x/this.a/Math.cos(this.lat_ts),this.over),t=Math.asin(n.y/this.a*Math.cos(this.lat_ts))):(t=kee(this.e,2*n.y*this.k0/this.a),e=_e(this.long0+n.x/(this.a*this.k0),this.over)),n.x=e,n.y=t,n}var Oee=["cea"];const Vee={init:Lee,forward:Nee,inverse:Dee,names:Oee};function Fee(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)}function jee(n){var e=n.x,t=n.y,i=_e(e-this.long0,this.over),r=Qa(t-this.lat0);return n.x=this.x0+this.a*i*this.rc,n.y=this.y0+this.a*r,n}function Gee(n){var e=n.x,t=n.y;return n.x=_e(this.long0+(e-this.x0)/(this.a*this.rc),this.over),n.y=Qa(this.lat0+(t-this.y0)/this.a),n}var Uee=["Equirectangular","Equidistant_Cylindrical","Equidistant_Cylindrical_Spherical","eqc"];const zee={init:Fee,forward:jee,inverse:Gee,names:Uee};var $M=20;function Bee(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Xg(this.es),this.e1=Yg(this.es),this.e2=Zg(this.es),this.e3=Qg(this.es),this.ml0=this.a*di(this.e0,this.e1,this.e2,this.e3,this.lat0)}function $ee(n){var e=n.x,t=n.y,i,r,s,o=_e(e-this.long0,this.over);if(s=o*Math.sin(t),this.sphere)Math.abs(t)<=ge?(i=this.a*o,r=-1*this.a*this.lat0):(i=this.a*Math.sin(s)/Math.tan(t),r=this.a*(Qa(t-this.lat0)+(1-Math.cos(s))/Math.tan(t)));else if(Math.abs(t)<=ge)i=this.a*o,r=-1*this.ml0;else{var a=xT(this.a,this.e,Math.sin(t))/Math.tan(t);i=a*Math.sin(s),r=this.a*di(this.e0,this.e1,this.e2,this.e3,t)-this.ml0+a*(1-Math.cos(s))}return n.x=i+this.x0,n.y=r+this.y0,n}function Wee(n){var e,t,i,r,s,o,a,c,h;if(i=n.x-this.x0,r=n.y-this.y0,this.sphere)if(Math.abs(r+this.a*this.lat0)<=ge)e=_e(i/this.a+this.long0,this.over),t=0;else{o=this.lat0+r/this.a,a=i*i/this.a/this.a+o*o,c=o;var d;for(s=$M;s;--s)if(d=Math.tan(c),h=-1*(o*(c*d+1)-c-.5*(c*c+a)*d)/((c-o)/d-1),c+=h,Math.abs(h)<=ge){t=c;break}e=_e(this.long0+Math.asin(i*Math.tan(c)/this.a)/Math.sin(t),this.over)}else if(Math.abs(r+this.ml0)<=ge)t=0,e=_e(this.long0+i/this.a,this.over);else{o=(this.ml0+r)/this.a,a=i*i/this.a/this.a+o*o,c=o;var g,m,v,y,T;for(s=$M;s;--s)if(T=this.e*Math.sin(c),g=Math.sqrt(1-T*T)*Math.tan(c),m=this.a*di(this.e0,this.e1,this.e2,this.e3,c),v=this.e0-2*this.e1*Math.cos(2*c)+4*this.e2*Math.cos(4*c)-6*this.e3*Math.cos(6*c),y=m/this.a,h=(o*(g*y+1)-y-.5*g*(y*y+a))/(this.es*Math.sin(2*c)*(y*y+a-2*o*y)/(4*g)+(o-y)*(g*v-2/Math.sin(2*c))-v),c-=h,Math.abs(h)<=ge){t=c;break}g=Math.sqrt(1-this.es*Math.pow(Math.sin(t),2))*Math.tan(t),e=_e(this.long0+Math.asin(i*g/this.a)/Math.sin(t),this.over)}return n.x=e,n.y=t,n}var Kee=["Polyconic","American_Polyconic","poly"];const qee={init:Bee,forward:$ee,inverse:Wee,names:Kee};function Hee(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013}function Xee(n){var e,t=n.x,i=n.y,r=i-this.lat0,s=t-this.long0,o=r/If*1e-5,a=s,c=1,h=0;for(e=1;e<=10;e++)c=c*o,h=h+this.A[e]*c;var d=h,g=a,m=1,v=0,y,T,w=0,A=0;for(e=1;e<=6;e++)y=m*d-v*g,T=v*d+m*g,m=y,v=T,w=w+this.B_re[e]*m-this.B_im[e]*v,A=A+this.B_im[e]*m+this.B_re[e]*v;return n.x=A*this.a+this.x0,n.y=w*this.a+this.y0,n}function Yee(n){var e,t=n.x,i=n.y,r=t-this.x0,s=i-this.y0,o=s/this.a,a=r/this.a,c=1,h=0,d,g,m=0,v=0;for(e=1;e<=6;e++)d=c*o-h*a,g=h*o+c*a,c=d,h=g,m=m+this.C_re[e]*c-this.C_im[e]*h,v=v+this.C_im[e]*c+this.C_re[e]*h;for(var y=0;y<this.iterations;y++){var T=m,w=v,A,P,C=o,N=a;for(e=2;e<=6;e++)A=T*m-w*v,P=w*m+T*v,T=A,w=P,C=C+(e-1)*(this.B_re[e]*T-this.B_im[e]*w),N=N+(e-1)*(this.B_im[e]*T+this.B_re[e]*w);T=1,w=0;var D=this.B_re[1],z=this.B_im[1];for(e=2;e<=6;e++)A=T*m-w*v,P=w*m+T*v,T=A,w=P,D=D+e*(this.B_re[e]*T-this.B_im[e]*w),z=z+e*(this.B_im[e]*T+this.B_re[e]*w);var k=D*D+z*z;m=(C*D+N*z)/k,v=(N*D-C*z)/k}var R=m,L=v,F=1,j=0;for(e=1;e<=9;e++)F=F*R,j=j+this.D[e]*F;var U=this.lat0+j*If*1e5,O=this.long0+L;return n.x=O,n.y=U,n}var Zee=["New_Zealand_Map_Grid","nzmg"];const Qee={init:Hee,forward:Xee,inverse:Yee,names:Zee};function Jee(){}function ete(n){var e=n.x,t=n.y,i=_e(e-this.long0,this.over),r=this.x0+this.a*i,s=this.y0+this.a*Math.log(Math.tan(Math.PI/4+t/2.5))*1.25;return n.x=r,n.y=s,n}function tte(n){n.x-=this.x0,n.y-=this.y0;var e=_e(this.long0+n.x/this.a,this.over),t=2.5*(Math.atan(Math.exp(.8*n.y/this.a))-Math.PI/4);return n.x=e,n.y=t,n}var nte=["Miller_Cylindrical","mill"];const ite={init:Jee,forward:ete,inverse:tte,names:nte};var rte=20;function ste(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=pT(this.es)}function ote(n){var e,t,i=n.x,r=n.y;if(i=_e(i-this.long0,this.over),this.sphere){if(!this.m)r=this.n!==1?Math.asin(this.n*Math.sin(r)):r;else for(var s=this.n*Math.sin(r),o=rte;o;--o){var a=(this.m*r+Math.sin(r)-s)/(this.m+Math.cos(r));if(r-=a,Math.abs(a)<ge)break}e=this.a*this.C_x*i*(this.m+Math.cos(r)),t=this.a*this.C_y*r}else{var c=Math.sin(r),h=Math.cos(r);t=this.a*zh(r,c,h,this.en),e=this.a*i*h/Math.sqrt(1-this.es*c*c)}return n.x=e,n.y=t,n}function ate(n){var e,t,i,r;return n.x-=this.x0,i=n.x/this.a,n.y-=this.y0,e=n.y/this.a,this.sphere?(e/=this.C_y,i=i/(this.C_x*(this.m+Math.cos(e))),this.m?e=Ka((this.m*e+Math.sin(e))/this.n):this.n!==1&&(e=Ka(Math.sin(e)/this.n)),i=_e(i+this.long0,this.over),e=Qa(e)):(e=_T(n.y/this.a,this.es,this.en),r=Math.abs(e),r<se?(r=Math.sin(e),t=this.long0+n.x*Math.sqrt(1-this.es*r*r)/(this.a*Math.cos(e)),i=_e(t,this.over)):r-ge<se&&(i=this.long0)),n.x=i,n.y=e,n}var lte=["Sinusoidal","sinu"];const cte={init:ste,forward:ote,inverse:ate,names:lte};function ute(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0}function hte(n){for(var e=n.x,t=n.y,i=_e(e-this.long0,this.over),r=t,s=Math.PI*Math.sin(t);;){var o=-(r+Math.sin(r)-s)/(1+Math.cos(r));if(r+=o,Math.abs(o)<ge)break}r/=2,Math.PI/2-Math.abs(t)<ge&&(i=0);var a=.900316316158*this.a*i*Math.cos(r)+this.x0,c=1.4142135623731*this.a*Math.sin(r)+this.y0;return n.x=a,n.y=c,n}function dte(n){var e,t;n.x-=this.x0,n.y-=this.y0,t=n.y/(1.4142135623731*this.a),Math.abs(t)>.999999999999&&(t=.999999999999),e=Math.asin(t);var i=_e(this.long0+n.x/(.900316316158*this.a*Math.cos(e)),this.over);i<-Math.PI&&(i=-Math.PI),i>Math.PI&&(i=Math.PI),t=(2*e+Math.sin(2*e))/Math.PI,Math.abs(t)>1&&(t=1);var r=Math.asin(t);return n.x=i,n.y=r,n}var fte=["Mollweide","moll"];const gte={init:ute,forward:hte,inverse:dte,names:fte};function mte(){Math.abs(this.lat1+this.lat2)<ge||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Xg(this.es),this.e1=Yg(this.es),this.e2=Zg(this.es),this.e3=Qg(this.es),this.sin_phi=Math.sin(this.lat1),this.cos_phi=Math.cos(this.lat1),this.ms1=Ds(this.e,this.sin_phi,this.cos_phi),this.ml1=di(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<ge?this.ns=this.sin_phi:(this.sin_phi=Math.sin(this.lat2),this.cos_phi=Math.cos(this.lat2),this.ms2=Ds(this.e,this.sin_phi,this.cos_phi),this.ml2=di(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=di(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))}function pte(n){var e=n.x,t=n.y,i;if(this.sphere)i=this.a*(this.g-t);else{var r=di(this.e0,this.e1,this.e2,this.e3,t);i=this.a*(this.g-r)}var s=this.ns*_e(e-this.long0,this.over),o=this.x0+i*Math.sin(s),a=this.y0+this.rh-i*Math.cos(s);return n.x=o,n.y=a,n}function _te(n){n.x-=this.x0,n.y=this.rh-n.y+this.y0;var e,t,i,r;this.ns>=0?(t=Math.sqrt(n.x*n.x+n.y*n.y),e=1):(t=-Math.sqrt(n.x*n.x+n.y*n.y),e=-1);var s=0;if(t!==0&&(s=Math.atan2(e*n.x,e*n.y)),this.sphere)return r=_e(this.long0+s/this.ns,this.over),i=Qa(this.g-t/this.a),n.x=r,n.y=i,n;var o=this.g-t/this.a;return i=g_(o,this.e0,this.e1,this.e2,this.e3),r=_e(this.long0+s/this.ns,this.over),n.x=r,n.y=i,n}var yte=["Equidistant_Conic","eqdc"];const vte={init:mte,forward:pte,inverse:_te,names:yte};function Ete(){this.R=this.a}function wte(n){var e=n.x,t=n.y,i=_e(e-this.long0,this.over),r,s;Math.abs(t)<=ge&&(r=this.x0+this.R*i,s=this.y0);var o=Ka(2*Math.abs(t/Math.PI));(Math.abs(i)<=ge||Math.abs(Math.abs(t)-se)<=ge)&&(r=this.x0,t>=0?s=this.y0+Math.PI*this.R*Math.tan(.5*o):s=this.y0+Math.PI*this.R*-Math.tan(.5*o));var a=.5*Math.abs(Math.PI/i-i/Math.PI),c=a*a,h=Math.sin(o),d=Math.cos(o),g=d/(h+d-1),m=g*g,v=g*(2/h-1),y=v*v,T=Math.PI*this.R*(a*(g-y)+Math.sqrt(c*(g-y)*(g-y)-(y+c)*(m-y)))/(y+c);i<0&&(T=-T),r=this.x0+T;var w=c+g;return T=Math.PI*this.R*(v*w-a*Math.sqrt((y+c)*(c+1)-w*w))/(y+c),t>=0?s=this.y0+T:s=this.y0-T,n.x=r,n.y=s,n}function xte(n){var e,t,i,r,s,o,a,c,h,d,g,m,v;return n.x-=this.x0,n.y-=this.y0,g=Math.PI*this.R,i=n.x/g,r=n.y/g,s=i*i+r*r,o=-Math.abs(r)*(1+s),a=o-2*r*r+i*i,c=-2*o+1+2*r*r+s*s,v=r*r/c+(2*a*a*a/c/c/c-9*o*a/c/c)/27,h=(o-a*a/3/c)/c,d=2*Math.sqrt(-h/3),g=3*v/h/d,Math.abs(g)>1&&(g>=0?g=1:g=-1),m=Math.acos(g)/3,n.y>=0?t=(-d*Math.cos(m+Math.PI/3)-a/3/c)*Math.PI:t=-(-d*Math.cos(m+Math.PI/3)-a/3/c)*Math.PI,Math.abs(i)<ge?e=this.long0:e=_e(this.long0+Math.PI*(s-1+Math.sqrt(1+2*(i*i-r*r)+s*s))/2/i,this.over),n.x=e,n.y=t,n}var Ste=["Van_der_Grinten_I","VanDerGrinten","Van_der_Grinten","vandg"];const Tte={init:Ete,forward:wte,inverse:xte,names:Ste};function Ite(n,e,t,i,r,s){const o=i-e,a=Math.atan((1-s)*Math.tan(n)),c=Math.atan((1-s)*Math.tan(t)),h=Math.sin(a),d=Math.cos(a),g=Math.sin(c),m=Math.cos(c);let v=o,y,T=100,w,A,P,C,N,D,z,k,R,L,F,j,U,O;do{if(w=Math.sin(v),A=Math.cos(v),P=Math.sqrt(m*w*(m*w)+(d*g-h*m*A)*(d*g-h*m*A)),P===0)return{azi1:0,s12:0};C=h*g+d*m*A,N=Math.atan2(P,C),D=d*m*w/P,z=1-D*D,k=z!==0?C-2*h*g/z:0,R=s/16*z*(4+s*(4-3*z)),y=v,v=o+(1-R)*s*D*(N+R*P*(k+R*C*(-1+2*k*k)))}while(Math.abs(v-y)>1e-12&&--T>0);return T===0?{azi1:NaN,s12:NaN}:(L=z*(r*r-r*(1-s)*(r*(1-s)))/(r*(1-s)*(r*(1-s))),F=1+L/16384*(4096+L*(-768+L*(320-175*L))),j=L/1024*(256+L*(-128+L*(74-47*L))),U=j*P*(k+j/4*(C*(-1+2*k*k)-j/6*k*(-3+4*P*P)*(-3+4*k*k))),O=r*(1-s)*F*(N-U),{azi1:Math.atan2(m*w,d*g-h*m*A),s12:O})}function Ate(n,e,t,i,r,s){const o=Math.atan((1-s)*Math.tan(n)),a=Math.sin(o),c=Math.cos(o),h=Math.sin(t),d=Math.cos(t),g=Math.atan2(a,c*d),m=c*h,v=1-m*m,y=v*(r*r-r*(1-s)*(r*(1-s)))/(r*(1-s)*(r*(1-s))),T=1+y/16384*(4096+y*(-768+y*(320-175*y))),w=y/1024*(256+y*(-128+y*(74-47*y)));let A=i/(r*(1-s)*T),P,C=100,N,D,z,k;do N=Math.cos(2*g+A),D=Math.sin(A),z=Math.cos(A),k=w*D*(N+w/4*(z*(-1+2*N*N)-w/6*N*(-3+4*D*D)*(-3+4*N*N))),P=A,A=i/(r*(1-s)*T)+k;while(Math.abs(A-P)>1e-12&&--C>0);if(C===0)return{lat2:NaN,lon2:NaN};const R=a*D-c*z*d,L=Math.atan2(a*z+c*D*d,(1-s)*Math.sqrt(m*m+R*R)),F=Math.atan2(D*h,c*z-a*D*d),j=s/16*v*(4+s*(4-3*v)),U=F-(1-j)*s*m*(A+j*D*(N+j*z*(-1+2*N*N))),O=e+U;return{lat2:L,lon2:O}}function Rte(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0),this.f=this.es/(1+Math.sqrt(1-this.es))}function Pte(n){var e=n.x,t=n.y,i=Math.sin(n.y),r=Math.cos(n.y),s=_e(e-this.long0,this.over),o,a,c,h,d,g,m,v,y,T,w;return this.sphere?Math.abs(this.sin_p12-1)<=ge?(n.x=this.x0+this.a*(se-t)*Math.sin(s),n.y=this.y0-this.a*(se-t)*Math.cos(s),n):Math.abs(this.sin_p12+1)<=ge?(n.x=this.x0+this.a*(se+t)*Math.sin(s),n.y=this.y0+this.a*(se+t)*Math.cos(s),n):(y=this.sin_p12*i+this.cos_p12*r*Math.cos(s),m=Math.acos(y),v=m?m/Math.sin(m):1,n.x=this.x0+this.a*v*r*Math.sin(s),n.y=this.y0+this.a*v*(this.cos_p12*i-this.sin_p12*r*Math.cos(s)),n):(o=Xg(this.es),a=Yg(this.es),c=Zg(this.es),h=Qg(this.es),Math.abs(this.sin_p12-1)<=ge?(d=this.a*di(o,a,c,h,se),g=this.a*di(o,a,c,h,t),n.x=this.x0+(d-g)*Math.sin(s),n.y=this.y0-(d-g)*Math.cos(s),n):Math.abs(this.sin_p12+1)<=ge?(d=this.a*di(o,a,c,h,se),g=this.a*di(o,a,c,h,t),n.x=this.x0+(d+g)*Math.sin(s),n.y=this.y0+(d+g)*Math.cos(s),n):Math.abs(e)<ge&&Math.abs(t-this.lat0)<ge?(n.x=n.y=0,n):(T=Ite(this.lat0,this.long0,t,e,this.a,this.f),w=T.azi1,n.x=T.s12*Math.sin(w),n.y=T.s12*Math.cos(w),n))}function Cte(n){n.x-=this.x0,n.y-=this.y0;var e,t,i,r,s,o,a,c,h,d,g,m,v,y,T,w;return this.sphere?(e=Math.sqrt(n.x*n.x+n.y*n.y),e>2*se*this.a?void 0:(t=e/this.a,i=Math.sin(t),r=Math.cos(t),s=this.long0,Math.abs(e)<=ge?o=this.lat0:(o=Ka(r*this.sin_p12+n.y*i*this.cos_p12/e),a=Math.abs(this.lat0)-se,Math.abs(a)<=ge?this.lat0>=0?s=_e(this.long0+Math.atan2(n.x,-n.y),this.over):s=_e(this.long0-Math.atan2(-n.x,n.y),this.over):s=_e(this.long0+Math.atan2(n.x*i,e*this.cos_p12*r-n.y*this.sin_p12*i),this.over)),n.x=s,n.y=o,n)):(c=Xg(this.es),h=Yg(this.es),d=Zg(this.es),g=Qg(this.es),Math.abs(this.sin_p12-1)<=ge?(m=this.a*di(c,h,d,g,se),e=Math.sqrt(n.x*n.x+n.y*n.y),v=m-e,o=g_(v/this.a,c,h,d,g),s=_e(this.long0+Math.atan2(n.x,-1*n.y),this.over),n.x=s,n.y=o,n):Math.abs(this.sin_p12+1)<=ge?(m=this.a*di(c,h,d,g,se),e=Math.sqrt(n.x*n.x+n.y*n.y),v=e-m,o=g_(v/this.a,c,h,d,g),s=_e(this.long0+Math.atan2(n.x,n.y),this.over),n.x=s,n.y=o,n):(y=Math.atan2(n.x,n.y),T=Math.sqrt(n.x*n.x+n.y*n.y),w=Ate(this.lat0,this.long0,y,T,this.a,this.f),n.x=w.lon2,n.y=w.lat2,n))}var Mte=["Azimuthal_Equidistant","aeqd"];const bte={init:Rte,forward:Pte,inverse:Cte,names:Mte};function kte(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)}function Lte(n){var e,t,i,r,s,o,a,c,h=n.x,d=n.y;return i=_e(h-this.long0,this.over),e=Math.sin(d),t=Math.cos(d),r=Math.cos(i),o=this.sin_p14*e+this.cos_p14*t*r,s=1,(o>0||Math.abs(o)<=ge)&&(a=this.a*s*t*Math.sin(i),c=this.y0+this.a*s*(this.cos_p14*e-this.sin_p14*t*r)),n.x=a,n.y=c,n}function Nte(n){var e,t,i,r,s,o,a;return n.x-=this.x0,n.y-=this.y0,e=Math.sqrt(n.x*n.x+n.y*n.y),t=Ka(e/this.a),i=Math.sin(t),r=Math.cos(t),o=this.long0,Math.abs(e)<=ge?(a=this.lat0,n.x=o,n.y=a,n):(a=Ka(r*this.sin_p14+n.y*i*this.cos_p14/e),s=Math.abs(this.lat0)-se,Math.abs(s)<=ge?(this.lat0>=0?o=_e(this.long0+Math.atan2(n.x,-n.y),this.over):o=_e(this.long0-Math.atan2(-n.x,n.y),this.over),n.x=o,n.y=a,n):(o=_e(this.long0+Math.atan2(n.x*i,e*this.cos_p14*r-n.y*this.sin_p14*i),this.over),n.x=o,n.y=a,n))}var Dte=["ortho"];const Ote={init:kte,forward:Lte,inverse:Nte,names:Dte};var zt={FRONT:1,RIGHT:2,BACK:3,LEFT:4,TOP:5,BOTTOM:6},pt={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4};function Vte(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=se-mt/2?this.face=zt.TOP:this.lat0<=-(se-mt/2)?this.face=zt.BOTTOM:Math.abs(this.long0)<=mt?this.face=zt.FRONT:Math.abs(this.long0)<=se+mt?this.face=this.long0>0?zt.RIGHT:zt.LEFT:this.face=zt.BACK,this.es!==0&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)}function Fte(n){var e={x:0,y:0},t,i,r,s,o,a,c={value:0};if(n.x-=this.long0,this.es!==0?t=Math.atan(this.one_minus_f_squared*Math.tan(n.y)):t=n.y,i=n.x,this.face===zt.TOP)s=se-t,i>=mt&&i<=se+mt?(c.value=pt.AREA_0,r=i-se):i>se+mt||i<=-(se+mt)?(c.value=pt.AREA_1,r=i>0?i-nn:i+nn):i>-(se+mt)&&i<=-mt?(c.value=pt.AREA_2,r=i+se):(c.value=pt.AREA_3,r=i);else if(this.face===zt.BOTTOM)s=se+t,i>=mt&&i<=se+mt?(c.value=pt.AREA_0,r=-i+se):i<mt&&i>=-mt?(c.value=pt.AREA_1,r=-i):i<-mt&&i>=-(se+mt)?(c.value=pt.AREA_2,r=-i-se):(c.value=pt.AREA_3,r=i>0?-i+nn:-i-nn);else{var h,d,g,m,v,y,T;this.face===zt.RIGHT?i=sh(i,+se):this.face===zt.BACK?i=sh(i,+nn):this.face===zt.LEFT&&(i=sh(i,-se)),m=Math.sin(t),v=Math.cos(t),y=Math.sin(i),T=Math.cos(i),h=v*T,d=v*y,g=m,this.face===zt.FRONT?(s=Math.acos(h),r=Op(s,g,d,c)):this.face===zt.RIGHT?(s=Math.acos(d),r=Op(s,g,-h,c)):this.face===zt.BACK?(s=Math.acos(-h),r=Op(s,g,-d,c)):this.face===zt.LEFT?(s=Math.acos(-d),r=Op(s,g,h,c)):(s=r=0,c.value=pt.AREA_0)}return a=Math.atan(12/nn*(r+Math.acos(Math.sin(r)*Math.cos(mt))-se)),o=Math.sqrt((1-Math.cos(s))/(Math.cos(a)*Math.cos(a))/(1-Math.cos(Math.atan(1/Math.cos(r))))),c.value===pt.AREA_1?a+=se:c.value===pt.AREA_2?a+=nn:c.value===pt.AREA_3&&(a+=1.5*nn),e.x=o*Math.cos(a),e.y=o*Math.sin(a),e.x=e.x*this.a+this.x0,e.y=e.y*this.a+this.y0,n.x=e.x,n.y=e.y,n}function jte(n){var e={lam:0,phi:0},t,i,r,s,o,a,c,h,d,g={value:0};if(n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a,i=Math.atan(Math.sqrt(n.x*n.x+n.y*n.y)),t=Math.atan2(n.y,n.x),n.x>=0&&n.x>=Math.abs(n.y)?g.value=pt.AREA_0:n.y>=0&&n.y>=Math.abs(n.x)?(g.value=pt.AREA_1,t-=se):n.x<0&&-n.x>=Math.abs(n.y)?(g.value=pt.AREA_2,t=t<0?t+nn:t-nn):(g.value=pt.AREA_3,t+=se),d=nn/12*Math.tan(t),o=Math.sin(d)/(Math.cos(d)-1/Math.sqrt(2)),a=Math.atan(o),r=Math.cos(t),s=Math.tan(i),c=1-r*r*s*s*(1-Math.cos(Math.atan(1/Math.cos(a)))),c<-1?c=-1:c>1&&(c=1),this.face===zt.TOP)h=Math.acos(c),e.phi=se-h,g.value===pt.AREA_0?e.lam=a+se:g.value===pt.AREA_1?e.lam=a<0?a+nn:a-nn:g.value===pt.AREA_2?e.lam=a-se:e.lam=a;else if(this.face===zt.BOTTOM)h=Math.acos(c),e.phi=h-se,g.value===pt.AREA_0?e.lam=-a+se:g.value===pt.AREA_1?e.lam=-a:g.value===pt.AREA_2?e.lam=-a-se:e.lam=a<0?-a-nn:-a+nn;else{var m,v,y;m=c,d=m*m,d>=1?y=0:y=Math.sqrt(1-d)*Math.sin(a),d+=y*y,d>=1?v=0:v=Math.sqrt(1-d),g.value===pt.AREA_1?(d=v,v=-y,y=d):g.value===pt.AREA_2?(v=-v,y=-y):g.value===pt.AREA_3&&(d=v,v=y,y=-d),this.face===zt.RIGHT?(d=m,m=-v,v=d):this.face===zt.BACK?(m=-m,v=-v):this.face===zt.LEFT&&(d=m,m=v,v=-d),e.phi=Math.acos(-y)-se,e.lam=Math.atan2(v,m),this.face===zt.RIGHT?e.lam=sh(e.lam,-se):this.face===zt.BACK?e.lam=sh(e.lam,-nn):this.face===zt.LEFT&&(e.lam=sh(e.lam,+se))}if(this.es!==0){var T,w,A;T=e.phi<0?1:0,w=Math.tan(e.phi),A=this.b/Math.sqrt(w*w+this.one_minus_f_squared),e.phi=Math.atan(Math.sqrt(this.a*this.a-A*A)/(this.one_minus_f*A)),T&&(e.phi=-e.phi)}return e.lam+=this.long0,n.x=e.lam,n.y=e.phi,n}function Op(n,e,t,i){var r;return n<ge?(i.value=pt.AREA_0,r=0):(r=Math.atan2(e,t),Math.abs(r)<=mt?i.value=pt.AREA_0:r>mt&&r<=se+mt?(i.value=pt.AREA_1,r-=se):r>se+mt||r<=-(se+mt)?(i.value=pt.AREA_2,r=r>=0?r-nn:r+nn):(i.value=pt.AREA_3,r+=se)),r}function sh(n,e){var t=n+e;return t<-nn?t+=fg:t>+nn&&(t-=fg),t}var Gte=["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"];const Ute={init:Vte,forward:Fte,inverse:jte,names:Gte};var Gw=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-986701e-12],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,18736e-12],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,934959e-12],[.7986,-.00755338,-500009e-10,935324e-12],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],lf=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-126793e-14,422642e-15],[.124,.0124,507171e-14,-160604e-14],[.186,.0123999,-190189e-13,600152e-14],[.248,.0124002,710039e-13,-224e-10],[.31,.0123992,-264997e-12,835986e-13],[.372,.0124029,988983e-12,-311994e-12],[.434,.0123893,-369093e-11,-435621e-12],[.4958,.0123198,-102252e-10,-345523e-12],[.5571,.0121916,-154081e-10,-582288e-12],[.6176,.0119938,-241424e-10,-525327e-12],[.6769,.011713,-320223e-10,-516405e-12],[.7346,.0113541,-397684e-10,-609052e-12],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-140374e-14],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],$3=.8487,W3=1.3523,K3=ki/5,zte=1/K3,Ku=18,m_=function(n,e){return n[0]+e*(n[1]+e*(n[2]+e*n[3]))},Bte=function(n,e){return n[1]+e*(2*n[2]+e*3*n[3])};function $te(n,e,t,i){for(var r=e;i;--i){var s=n(r);if(r-=s,Math.abs(s)<t)break}return r}function Wte(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"}function Kte(n){var e=_e(n.x-this.long0,this.over),t=Math.abs(n.y),i=Math.floor(t*K3);i<0?i=0:i>=Ku&&(i=Ku-1),t=ki*(t-zte*i);var r={x:m_(Gw[i],t)*e,y:m_(lf[i],t)};return n.y<0&&(r.y=-r.y),r.x=r.x*this.a*$3+this.x0,r.y=r.y*this.a*W3+this.y0,r}function qte(n){var e={x:(n.x-this.x0)/(this.a*$3),y:Math.abs(n.y-this.y0)/(this.a*W3)};if(e.y>=1)e.x/=Gw[Ku][0],e.y=n.y<0?-se:se;else{var t=Math.floor(e.y*Ku);for(t<0?t=0:t>=Ku&&(t=Ku-1);;)if(lf[t][0]>e.y)--t;else if(lf[t+1][0]<=e.y)++t;else break;var i=lf[t],r=5*(e.y-i[0])/(lf[t+1][0]-i[0]);r=$te(function(s){return(m_(i,s)-e.y)/Bte(i,s)},r,ge,100),e.x/=m_(Gw[t],r),e.y=(5*t+r)*qt,n.y<0&&(e.y=-e.y)}return e.x=_e(e.x+this.long0,this.over),e}var Hte=["Robinson","robin"];const Xte={init:Wte,forward:Kte,inverse:qte,names:Hte};function Yte(){this.name="geocent"}function Zte(n){var e=L3(n,this.es,this.a);return e}function Qte(n){var e=N3(n,this.es,this.a,this.b);return e}var Jte=["Geocentric","geocentric","geocent","Geocent"];const ene={init:Yte,forward:Zte,inverse:Qte,names:Jte};var Qn={N_POLE:0,S_POLE:1,EQUIT:2,OBLIQ:3},zd={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};function tne(){if(Object.keys(zd).forEach((function(t){if(typeof this[t]>"u")this[t]=zd[t].def;else{if(zd[t].num&&isNaN(this[t]))throw new Error("Invalid parameter value, must be numeric "+t+" = "+this[t]);zd[t].num&&(this[t]=parseFloat(this[t]))}zd[t].degrees&&(this[t]=this[t]*qt)}).bind(this)),Math.abs(Math.abs(this.lat0)-se)<ge?this.mode=this.lat0<0?Qn.S_POLE:Qn.N_POLE:Math.abs(this.lat0)<ge?this.mode=Qn.EQUIT:(this.mode=Qn.OBLIQ,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var n=this.tilt,e=this.azi;this.cg=Math.cos(e),this.sg=Math.sin(e),this.cw=Math.cos(n),this.sw=Math.sin(n)}function nne(n){n.x-=this.long0;var e=Math.sin(n.y),t=Math.cos(n.y),i=Math.cos(n.x),r,s;switch(this.mode){case Qn.OBLIQ:s=this.sinph0*e+this.cosph0*t*i;break;case Qn.EQUIT:s=t*i;break;case Qn.S_POLE:s=-e;break;case Qn.N_POLE:s=e;break}switch(s=this.pn1/(this.p-s),r=s*t*Math.sin(n.x),this.mode){case Qn.OBLIQ:s*=this.cosph0*e-this.sinph0*t*i;break;case Qn.EQUIT:s*=e;break;case Qn.N_POLE:s*=-(t*i);break;case Qn.S_POLE:s*=t*i;break}var o,a;return o=s*this.cg+r*this.sg,a=1/(o*this.sw*this.h1+this.cw),r=(r*this.cg-s*this.sg)*this.cw*a,s=o*a,n.x=r*this.a,n.y=s*this.a,n}function ine(n){n.x/=this.a,n.y/=this.a;var e={x:n.x,y:n.y},t,i,r;r=1/(this.pn1-n.y*this.sw),t=this.pn1*n.x*r,i=this.pn1*n.y*this.cw*r,n.x=t*this.cg+i*this.sg,n.y=i*this.cg-t*this.sg;var s=Ci(n.x,n.y);if(Math.abs(s)<ge)e.x=0,e.y=n.y;else{var o,a;switch(a=1-s*s*this.pfact,a=(this.p-Math.sqrt(a))/(this.pn1/s+s/this.pn1),o=Math.sqrt(1-a*a),this.mode){case Qn.OBLIQ:e.y=Math.asin(o*this.sinph0+n.y*a*this.cosph0/s),n.y=(o-this.sinph0*Math.sin(e.y))*s,n.x*=a*this.cosph0;break;case Qn.EQUIT:e.y=Math.asin(n.y*a/s),n.y=o*s,n.x*=a;break;case Qn.N_POLE:e.y=Math.asin(o),n.y=-n.y;break;case Qn.S_POLE:e.y=-Math.asin(o);break}e.x=Math.atan2(n.x,n.y)}return n.x=e.x+this.long0,n.y=e.y,n}var rne=["Tilted_Perspective","tpers"];const sne={init:tne,forward:nne,inverse:ine,names:rne};function one(){if(this.flip_axis=this.sweep==="x"?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,this.es!==0){var n=1-this.es,e=1/n;this.radius_p=Math.sqrt(n),this.radius_p2=n,this.radius_p_inv2=e,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")}function ane(n){var e=n.x,t=n.y,i,r,s,o;if(e=e-this.long0,this.shape==="ellipse"){t=Math.atan(this.radius_p2*Math.tan(t));var a=this.radius_p/Ci(this.radius_p*Math.cos(t),Math.sin(t));if(r=a*Math.cos(e)*Math.cos(t),s=a*Math.sin(e)*Math.cos(t),o=a*Math.sin(t),(this.radius_g-r)*r-s*s-o*o*this.radius_p_inv2<0)return n.x=Number.NaN,n.y=Number.NaN,n;i=this.radius_g-r,this.flip_axis?(n.x=this.radius_g_1*Math.atan(s/Ci(o,i)),n.y=this.radius_g_1*Math.atan(o/i)):(n.x=this.radius_g_1*Math.atan(s/i),n.y=this.radius_g_1*Math.atan(o/Ci(s,i)))}else this.shape==="sphere"&&(i=Math.cos(t),r=Math.cos(e)*i,s=Math.sin(e)*i,o=Math.sin(t),i=this.radius_g-r,this.flip_axis?(n.x=this.radius_g_1*Math.atan(s/Ci(o,i)),n.y=this.radius_g_1*Math.atan(o/i)):(n.x=this.radius_g_1*Math.atan(s/i),n.y=this.radius_g_1*Math.atan(o/Ci(s,i))));return n.x=n.x*this.a,n.y=n.y*this.a,n}function lne(n){var e=-1,t=0,i=0,r,s,o,a;if(n.x=n.x/this.a,n.y=n.y/this.a,this.shape==="ellipse"){this.flip_axis?(i=Math.tan(n.y/this.radius_g_1),t=Math.tan(n.x/this.radius_g_1)*Ci(1,i)):(t=Math.tan(n.x/this.radius_g_1),i=Math.tan(n.y/this.radius_g_1)*Ci(1,t));var c=i/this.radius_p;if(r=t*t+c*c+e*e,s=2*this.radius_g*e,o=s*s-4*r*this.C,o<0)return n.x=Number.NaN,n.y=Number.NaN,n;a=(-s-Math.sqrt(o))/(2*r),e=this.radius_g+a*e,t*=a,i*=a,n.x=Math.atan2(t,e),n.y=Math.atan(i*Math.cos(n.x)/e),n.y=Math.atan(this.radius_p_inv2*Math.tan(n.y))}else if(this.shape==="sphere"){if(this.flip_axis?(i=Math.tan(n.y/this.radius_g_1),t=Math.tan(n.x/this.radius_g_1)*Math.sqrt(1+i*i)):(t=Math.tan(n.x/this.radius_g_1),i=Math.tan(n.y/this.radius_g_1)*Math.sqrt(1+t*t)),r=t*t+i*i+e*e,s=2*this.radius_g*e,o=s*s-4*r*this.C,o<0)return n.x=Number.NaN,n.y=Number.NaN,n;a=(-s-Math.sqrt(o))/(2*r),e=this.radius_g+a*e,t*=a,i*=a,n.x=Math.atan2(t,e),n.y=Math.atan(i*Math.cos(n.x)/e)}return n.x=n.x+this.long0,n}var cne=["Geostationary Satellite View","Geostationary_Satellite","geos"];const une={init:one,forward:ane,inverse:lne,names:cne};var Af=1.340264,Rf=-.081106,Pf=893e-6,Cf=.003796,p_=Math.sqrt(3)/2;function hne(){this.es=0,this.long0=this.long0!==void 0?this.long0:0,this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0}function dne(n){var e=_e(n.x-this.long0,this.over),t=n.y,i=Math.asin(p_*Math.sin(t)),r=i*i,s=r*r*r;return n.x=e*Math.cos(i)/(p_*(Af+3*Rf*r+s*(7*Pf+9*Cf*r))),n.y=i*(Af+Rf*r+s*(Pf+Cf*r)),n.x=this.a*n.x+this.x0,n.y=this.a*n.y+this.y0,n}function fne(n){n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a;var e=1e-9,t=12,i=n.y,r,s,o,a,c,h;for(h=0;h<t&&(r=i*i,s=r*r*r,o=i*(Af+Rf*r+s*(Pf+Cf*r))-n.y,a=Af+3*Rf*r+s*(7*Pf+9*Cf*r),i-=c=o/a,!(Math.abs(c)<e));++h);return r=i*i,s=r*r*r,n.x=p_*n.x*(Af+3*Rf*r+s*(7*Pf+9*Cf*r))/Math.cos(i),n.y=Math.asin(Math.sin(i)/p_),n.x=_e(n.x+this.long0,this.over),n}var gne=["eqearth","Equal Earth","Equal_Earth"];const mne={init:hne,forward:dne,inverse:fne,names:gne};var pg=1e-10;function pne(){var n;if(this.phi1=this.lat1,Math.abs(this.phi1)<pg)throw new Error;this.es?(this.en=pT(this.es),this.m1=zh(this.phi1,this.am1=Math.sin(this.phi1),n=Math.cos(this.phi1),this.en),this.am1=n/(Math.sqrt(1-this.es*this.am1*this.am1)*this.am1),this.inverse=yne,this.forward=_ne):(Math.abs(this.phi1)+pg>=se?this.cphi1=0:this.cphi1=1/Math.tan(this.phi1),this.inverse=Ene,this.forward=vne)}function _ne(n){var e=_e(n.x-(this.long0||0),this.over),t=n.y,i,r,s;return i=this.am1+this.m1-zh(t,r=Math.sin(t),s=Math.cos(t),this.en),r=s*e/(i*Math.sqrt(1-this.es*r*r)),n.x=i*Math.sin(r),n.y=this.am1-i*Math.cos(r),n.x=this.a*n.x+(this.x0||0),n.y=this.a*n.y+(this.y0||0),n}function yne(n){n.x=(n.x-(this.x0||0))/this.a,n.y=(n.y-(this.y0||0))/this.a;var e,t,i,r;if(t=Ci(n.x,n.y=this.am1-n.y),r=_T(this.am1+this.m1-t,this.es,this.en),(e=Math.abs(r))<se)e=Math.sin(r),i=t*Math.atan2(n.x,n.y)*Math.sqrt(1-this.es*e*e)/Math.cos(r);else if(Math.abs(e-se)<=pg)i=0;else throw new Error;return n.x=_e(i+(this.long0||0),this.over),n.y=Qa(r),n}function vne(n){var e=_e(n.x-(this.long0||0),this.over),t=n.y,i,r;return r=this.cphi1+this.phi1-t,Math.abs(r)>pg?(n.x=r*Math.sin(i=e*Math.cos(t)/r),n.y=this.cphi1-r*Math.cos(i)):n.x=n.y=0,n.x=this.a*n.x+(this.x0||0),n.y=this.a*n.y+(this.y0||0),n}function Ene(n){n.x=(n.x-(this.x0||0))/this.a,n.y=(n.y-(this.y0||0))/this.a;var e,t,i=Ci(n.x,n.y=this.cphi1-n.y);if(t=this.cphi1+this.phi1-i,Math.abs(t)>se)throw new Error;return Math.abs(Math.abs(t)-se)<=pg?e=0:e=i*Math.atan2(n.x,n.y)/Math.cos(t),n.x=_e(e+(this.long0||0),this.over),n.y=Qa(t),n}var wne=["bonne","Bonne (Werner lat_1=90)"];const xne={init:pne,names:wne},WM={OBLIQUE:{forward:Rne,inverse:Cne},TRANSVERSE:{forward:Pne,inverse:Mne}},__={ROTATE:{o_alpha:"oAlpha",o_lon_c:"oLongC",o_lat_c:"oLatC"},NEW_POLE:{o_lat_p:"oLatP",o_lon_p:"oLongP"},NEW_EQUATOR:{o_lon_1:"oLong1",o_lat_1:"oLat1",o_lon_2:"oLong2",o_lat_2:"oLat2"}};function Sne(){if(this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.title=this.title||"General Oblique Transformation",this.isIdentity=C3.includes(this.o_proj),!this.o_proj)throw new Error("Missing parameter: o_proj");if(this.o_proj==="ob_tran")throw new Error("Invalid value for o_proj: "+this.o_proj);const n=this.projStr.replace("+proj=ob_tran","").replace("+o_proj=","+proj=").trim(),e=Ar(n);if(!e)throw new Error("Invalid parameter: o_proj. Unknown projection "+this.o_proj);e.long0=0,this.obliqueProjection=e;let t;const i=Object.keys(__),r=a=>{if(typeof this[a]>"u")return;const c=parseFloat(this[a])*qt;if(isNaN(c))throw new Error("Invalid value for "+a+": "+this[a]);return c};for(let a=0;a<i.length;a++){const c=i[a],h=__[c],d=Object.entries(h);if(d.some(([m])=>typeof this[m]<"u")){t=h;for(let m=0;m<d.length;m++){const[v,y]=d[m],T=r(v);if(typeof T>"u")throw new Error("Missing parameter: "+v+".");this[y]=T}break}}if(!t)throw new Error("No valid parameters provided for ob_tran projection.");const{lamp:s,phip:o}=Ane(this,t);this.lamp=s,Math.abs(o)>ge?(this.cphip=Math.cos(o),this.sphip=Math.sin(o),this.projectionType=WM.OBLIQUE):this.projectionType=WM.TRANSVERSE}function Tne(n){return this.projectionType.forward(this,n)}function Ine(n){return this.projectionType.inverse(this,n)}function Ane(n,e){let t,i;if(e===__.ROTATE){let r=n.oLongC,s=n.oLatC,o=n.oAlpha;if(Math.abs(Math.abs(s)-se)<=ge)throw new Error("Invalid value for o_lat_c: "+n.o_lat_c+" should be < 90");i=r+Math.atan2(-1*Math.cos(o),-1*Math.sin(o)*Math.sin(s)),t=Math.asin(Math.cos(s)*Math.sin(o))}else if(e===__.NEW_POLE)i=n.oLongP,t=n.oLatP;else{let r=n.oLong1,s=n.oLat1,o=n.oLong2,a=n.oLat2,c=Math.abs(s);if(Math.abs(s)>se-ge)throw new Error("Invalid value for o_lat_1: "+n.o_lat_1+" should be < 90");if(Math.abs(a)>se-ge)throw new Error("Invalid value for o_lat_2: "+n.o_lat_2+" should be < 90");if(Math.abs(s-a)<ge)throw new Error("Invalid value for o_lat_1 and o_lat_2: o_lat_1 should be different from o_lat_2");if(c<ge)throw new Error("Invalid value for o_lat_1: o_lat_1 should be different from zero");i=Math.atan2(Math.cos(s)*Math.sin(a)*Math.cos(r)-Math.sin(s)*Math.cos(a)*Math.cos(o),Math.sin(s)*Math.cos(a)*Math.sin(o)-Math.cos(s)*Math.sin(a)*Math.sin(r)),t=Math.atan(-1*Math.cos(i-r)/Math.tan(s))}return{lamp:i,phip:t}}function Rne(n,e){let{x:t,y:i}=e;t+=n.long0;const r=Math.cos(t),s=Math.sin(i),o=Math.cos(i);e.x=_e(Math.atan2(o*Math.sin(t),n.sphip*o*r+n.cphip*s)+n.lamp),e.y=Math.asin(n.sphip*s-n.cphip*o*r);const a=n.obliqueProjection.forward(e);return n.isIdentity&&(a.x*=ki,a.y*=ki),a}function Pne(n,e){let{x:t,y:i}=e;t+=n.long0;const r=Math.cos(i),s=Math.cos(t);e.x=_e(Math.atan2(r*Math.sin(t),Math.sin(i))+n.lamp),e.y=Math.asin(-1*r*s);const o=n.obliqueProjection.forward(e);return n.isIdentity&&(o.x*=ki,o.y*=ki),o}function Cne(n,e){n.isIdentity&&(e.x*=qt,e.y*=qt);const t=n.obliqueProjection.inverse(e);let{x:i,y:r}=t;if(i<Number.MAX_VALUE){i-=n.lamp;const s=Math.cos(i),o=Math.sin(r),a=Math.cos(r);e.x=Math.atan2(a*Math.sin(i),n.sphip*a*s-n.cphip*o),e.y=Math.asin(n.sphip*o+n.cphip*a*s)}return e.x=_e(e.x+n.long0),e}function Mne(n,e){n.isIdentity&&(e.x*=qt,e.y*=qt);const t=n.obliqueProjection.inverse(e);let{x:i,y:r}=t;if(i<Number.MAX_VALUE){const s=Math.cos(r);i-=n.lamp,e.x=Math.atan2(s*Math.sin(i),-1*Math.sin(r)),e.y=Math.asin(s*Math.cos(i))}return e.x=_e(e.x+n.long0),e}var bne=["General Oblique Transformation","General_Oblique_Transformation","ob_tran"];const kne={init:Sne,forward:Tne,inverse:Ine,names:bne};function Lne(n){n.Proj.projections.add(o0),n.Proj.projections.add(a0),n.Proj.projections.add(wJ),n.Proj.projections.add(MJ),n.Proj.projections.add(DJ),n.Proj.projections.add(GJ),n.Proj.projections.add(KJ),n.Proj.projections.add(ZJ),n.Proj.projections.add(nee),n.Proj.projections.add(aee),n.Proj.projections.add(Eee),n.Proj.projections.add(Aee),n.Proj.projections.add(bee),n.Proj.projections.add(Vee),n.Proj.projections.add(zee),n.Proj.projections.add(qee),n.Proj.projections.add(Qee),n.Proj.projections.add(ite),n.Proj.projections.add(cte),n.Proj.projections.add(gte),n.Proj.projections.add(vte),n.Proj.projections.add(Tte),n.Proj.projections.add(bte),n.Proj.projections.add(Ote),n.Proj.projections.add(Ute),n.Proj.projections.add(Xte),n.Proj.projections.add(ene),n.Proj.projections.add(sne),n.Proj.projections.add(une),n.Proj.projections.add(mne),n.Proj.projections.add(xne),n.Proj.projections.add(kne)}const qu=Object.assign(FQ,{defaultDatum:"WGS84",Proj:Ar,WGS84:new Ar("WGS84"),Point:bh,toPoint:D3,defs:On,nadgrid:EQ,transform:f_,mgrs:jQ,version:"__VERSION__"});Lne(qu);qu.defs("EPSG:28992","+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m +no_defs");const Nne={1:"Zeer lage trefkans op archeologische resten",2:"Lage trefkans op archeologische resten",3:"Middelhoge trefkans op archeologische resten",4:"Hoge trefkans op archeologische resten",5:"Lage trefkans (water)",6:"Middelhoge trefkans (water)",7:"Hoge trefkans (water)",8:"Water",9:"Niet gekarteerd"};function Dne(){const n=Li(a=>a.map),[e,t]=ne.useState(""),[i,r]=ne.useState(!1);ne.useEffect(()=>{if(!n)return;const a=d=>{let g='<strong class="text-purple-800">AMK Monument</strong>';if(d.toponiem&&(g+=`<br/><span class="text-sm font-semibold">${d.toponiem}</span>`),d.kwaliteitswaarde&&(g+=`<br/><span class="text-sm text-purple-700">${d.kwaliteitswaarde}</span>`),d.omschrijving&&(g+=`<br/><span class="text-xs text-gray-600 mt-1 block">${d.omschrijving}</span>`),d.txt_label){const m=d.txt_label.split(", ").slice(0,3).join(", ");g+=`<br/><span class="text-xs text-gray-500 italic">${m}${d.txt_label.split(", ").length>3?"...":""}</span>`}return g},c=async(d,g)=>{const m=n.getLayers().getArray().filter(v=>v instanceof oo&&v.getVisible()?v.getSource()instanceof _F:!1);for(const v of m){const y=v.getSource();if(!y)continue;const T=v.get("title")||"";if(T==="Archeo Landschappen"){try{const A=Ou(d),P=qu("EPSG:4326","EPSG:28992",A),C=100,D=`https://services.rce.geovoorziening.nl/landschappenkaart/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=landschappenkaart_nl&QUERY_LAYERS=landschappenkaart_nl&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${P[0]-C},${P[1]-C},${P[0]+C},${P[1]+C}`}`,k=await(await fetch(D)).json();if(k.features&&k.features.length>0){const R=k.features[0].properties;let L='<strong class="text-green-800">Archeologisch Landschap</strong>';return(R.landschapsnaam||R.naam)&&(L+=`<br/><span class="text-sm font-semibold">${R.landschapsnaam||R.naam}</span>`),R.omschrijving&&(L+=`<br/><span class="text-xs text-gray-600">${R.omschrijving}</span>`),L}}catch(A){console.warn("Archeo Landschappen WMS query failed:",A)}continue}if(T==="FAMKE Steentijd"){try{const A=Ou(d),P=qu("EPSG:4326","EPSG:28992",A),C=100,D=`https://geoportaal.fryslan.nl/arcgis/services/Themas/cultuurhistorie/MapServer/WMSServer?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=FAMKE_Advies_steentijd-bronstijd3339&QUERY_LAYERS=FAMKE_Advies_steentijd-bronstijd3339&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${P[0]-C},${P[1]-C},${P[0]+C},${P[1]+C}`}`,k=await(await fetch(D)).json();if(k.features&&k.features.length>0){const R=k.features[0].properties;let L='<strong class="text-amber-800">FAMKE Steentijd-Bronstijd</strong>';return(R.advies||R.Advies)&&(L+=`<br/><span class="text-sm text-amber-700">${R.advies||R.Advies}</span>`),L}}catch(A){console.warn("FAMKE WMS query failed:",A)}continue}if(T==="Archeo Onderzoeken"){try{const A=Ou(d),P=qu("EPSG:4326","EPSG:28992",A),C=100,D=`https://data.geo.cultureelerfgoed.nl/openbaar/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=archeologische_onderzoeksmeldingen_openbaar_rd&QUERY_LAYERS=archeologische_onderzoeksmeldingen_openbaar_rd&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${P[0]-C},${P[1]-C},${P[0]+C},${P[1]+C}`}`,k=await(await fetch(D)).json();if(k.features&&k.features.length>0){const R=k.features[0].properties;let L='<strong class="text-blue-800">Archeologisch Onderzoek</strong>';if(R.type_onderzoek&&(L+=`<br/><span class="text-sm font-semibold">${R.type_onderzoek}</span>`),R.onderzoeksmeldingnummer&&(L+=`<br/><span class="text-xs text-gray-500">Melding: ${R.onderzoeksmeldingnummer}</span>`),R.uitvoerder&&(L+=`<br/><span class="text-sm text-gray-700">Uitvoerder: ${R.uitvoerder}</span>`),R.startdatum||R.einddatum){const F=[R.startdatum,R.einddatum].filter(Boolean).join(" - ");L+=`<br/><span class="text-xs text-gray-600">Periode: ${F}</span>`}if(R.gemeente&&(L+=`<br/><span class="text-xs text-gray-500">${R.gemeente}</span>`),R.type_uri){const F=R.type_uri.replace("type_uri:","").trim();F.startsWith("http")&&(L+=`<br/><a href="${F}" target="_blank" rel="noopener noreferrer" class="text-xs text-blue-600 hover:underline">Meer informatie </a>`)}for(const[F,j]of Object.entries(R))if(F.toLowerCase().includes("uri")&&typeof j=="string"&&F!=="type_uri"){const U=j.replace(/^[a-z_]+:/i,"").trim();U.startsWith("http")&&(L+=`<br/><a href="${U}" target="_blank" rel="noopener noreferrer" class="text-xs text-blue-600 hover:underline">${F.replace("_uri","")} </a>`)}return L}}catch(A){console.warn("Archeo Onderzoeken WMS query failed:",A)}continue}if(T==="IKAW"){try{const A=Ou(d),P=qu("EPSG:4326","EPSG:28992",A),C=500,D=`https://services.rce.geovoorziening.nl/ikaw/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=IKAW3Indicatievekaartarcheologischewaarden2008&QUERY_LAYERS=IKAW3Indicatievekaartarcheologischewaarden2008&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${P[0]-C},${P[1]-C},${P[0]+C},${P[1]+C}`}`,k=await(await fetch(D)).json();if(k.features&&k.features.length>0){const R=k.features[0].properties,L=Math.round(R.PALETTE_INDEX||R.palette_index||0),F=Nne[L]||`Trefkans onbekend (${L})`;let j='<strong class="text-orange-800">IKAW (2008)</strong>';return j+=`<br/><span class="text-sm text-orange-700">${F}</span>`,j}}catch(A){console.warn("IKAW WMS query failed:",A)}continue}const w=y.getFeatureInfoUrl(d,g,"EPSG:3857",{INFO_FORMAT:"application/json"});if(w)try{const P=await(await fetch(w)).json();if(P.features&&P.features.length>0){const C=P.features[0].properties;let N=`<strong>${T}</strong>`;if((C.first_soilname||C.soilname)&&(N+=`<br/><span class="text-sm text-amber-700">${C.first_soilname||C.soilname}</span>`),(C.soilcode||C.first_soilcode)&&(N+=`<br/><span class="text-xs text-gray-500">Code: ${C.soilcode||C.first_soilcode}</span>`),C.soilslope&&C.soilslope!=="Niet opgenomen"&&(N+=`<br/><span class="text-xs text-gray-500">Helling: ${C.soilslope}</span>`),C.geomorphological_area_name&&(N+=`<br/><span class="text-sm text-green-700">${C.geomorphological_area_name}</span>`),C.relief&&(N+=`<br/><span class="text-xs text-gray-500">Relief: ${C.relief}</span>`),!C.first_soilname&&!C.soilname&&!C.geomorphological_area_name){const D=["geometry","id","fid","gml_id"];for(const[z,k]of Object.entries(C))!D.includes(z)&&k&&k!=="Niet opgenomen"&&(N+=`<br/><span class="text-xs text-gray-600">${z}: ${k}</span>`)}return N}}catch(A){console.warn("WMS GetFeatureInfo failed:",A)}}return null},h=async d=>{const g=n.forEachFeatureAtPixel(d.pixel,m=>m);if(g){const m=g.getProperties(),{geometry:v,...y}=m;if(y.kwaliteitswaarde&&y.kwaliteitswaarde.includes("archeologische waarde")){const P=a(y);t(P),r(!0);return}const T=y.name||y.naam||y.title||y.NAAM||y.NAME||y.label||y.route_name||y.road_name||"Info";let w=`<strong>${T}</strong>`;if(y.category&&(w+=`<br/><span class="text-sm text-gray-600">Categorie: ${y.category}</span>`),y.from_to&&y.from_to!==T&&(w+=`<br/><span class="text-sm text-gray-600">${y.from_to}</span>`),y.route&&y.route!==T&&(w+=`<br/><span class="text-sm text-gray-600">${y.route}</span>`),y.TOPONIEM&&(w+=`<br/><span class="text-sm font-semibold text-gray-800">${y.TOPONIEM}</span>`,y.PLAATS&&(w+=`<br/><span class="text-xs text-gray-500">${y.PLAATS}</span>`)),(y.AARD_VINDP||y.Aard_vindp)&&(w+=`<br/><span class="text-sm text-gray-700">Aard: ${y.AARD_VINDP||y.Aard_vindp}</span>`),y.BEGIN_PER&&y.EIND_PER&&(w+=`<br/><span class="text-sm text-purple-700">Periode: ${y.BEGIN_PER} - ${y.EIND_PER}</span>`),(y.AARD_OPM||y.Aard_opmer)&&(w+=`<br/><span class="text-xs text-gray-600 italic">${y.AARD_OPM||y.Aard_opmer}</span>`),y.Gemeente&&(w+=`<br/><span class="text-sm text-gray-600">Gemeente: ${y.Gemeente}</span>`),y.Bron&&(w+=`<br/><span class="text-xs text-gray-500">Bron: ${y.Bron}</span>`),y.Bron_besch&&(w+=`<br/><span class="text-xs text-gray-500">${y.Bron_besch}</span>`),y.Dat_st_z&&y.Dat_ei_z&&(w+=`<br/><span class="text-sm text-purple-700">Datering: ${y.Dat_st_z} - ${y.Dat_ei_z}</span>`),y.Begin&&y.Einde&&(w+=`<br/><span class="text-sm text-purple-700">Periode: ${y.Begin} - ${y.Einde}</span>`),y.Uiterwaard&&(w+=`<br/><span class="text-sm font-semibold">${y.Uiterwaard}</span>`),y.rivier&&(w+=`<br/><span class="text-sm text-blue-600">Rivier: ${y.rivier}</span>`),y.Beschrijvi&&(w+=`<br/><span class="text-sm text-gray-700">${y.Beschrijvi}</span>`),y.leisure){const P=y.leisure==="playground"?"Speeltuin":"Park";w+=`<br/><span class="text-xs text-gray-500">${P}</span>`}if((y.tourism==="museum"||y.museum)&&(w+='<br/><span class="text-xs text-purple-600">Museum</span>'),(y.leisure==="swimming_area"||y.sport==="swimming")&&(w+='<br/><span class="text-xs text-cyan-600">Zwemplek</span>'),y.osm_id&&y.address!==void 0&&(w+='<br/><span class="text-xs text-lime-600">Kringloopwinkel</span>',y.address&&(w+=`<br/><span class="text-xs text-gray-500">${y.address}</span>`),y.phone&&(w+=`<br/><span class="text-xs text-gray-600">${y.phone}</span>`)),(y.historic==="castle"||y.castle_type)&&(w+='<br/><span class="text-xs text-purple-600">Kasteel</span>',y.castle_type&&(w+=`<br/><span class="text-xs text-gray-500">Type: ${y.castle_type}</span>`),y.start_date&&(w+=`<br/><span class="text-xs text-gray-500">Bouwjaar: ${y.start_date}</span>`),y.heritage&&(w+='<br/><span class="text-xs text-amber-600">Rijksmonument</span>')),y.bron==="Paleobiology Database"&&(y.taxonomie&&y.taxonomie!=="Onbekend"&&(w+=`<br/><span class="text-xs text-amber-700">${y.taxonomie}</span>`),y.periode&&y.periode!=="Onbekend"&&(w+=`<br/><span class="text-sm text-purple-700">${y.periode}</span>`),y.ouderdom&&y.ouderdom!=="Onbekend"&&(w+=`<br/><span class="text-xs text-gray-600">Ouderdom: ${y.ouderdom}</span>`),y.aantal_fossielen&&(w+=`<br/><span class="text-xs text-green-700">Aantal fossielen: ${y.aantal_fossielen}</span>`),y.formatie&&(w+=`<br/><span class="text-xs text-gray-500">Formatie: ${y.formatie}</span>`),y.lid&&(w+=`<br/><span class="text-xs text-gray-500">Lid: ${y.lid}</span>`),y.gesteente&&(w+=`<br/><span class="text-xs text-gray-500">Gesteente: ${y.gesteente}</span>`),y.milieu&&(w+=`<br/><span class="text-xs text-blue-600">Milieu: ${y.milieu}</span>`),y.vindplaats&&(w+=`<br/><span class="text-xs text-gray-500 italic">${y.vindplaats}</span>`)),(y.inventarisnummer||y.locatie_naam)&&(y.locatie_naam&&(w+=`<br/><span class="text-sm font-semibold">${y.locatie_naam}</span>`),y.inventarisnummer&&(w+=`<br/><span class="text-xs text-gray-500">CAI: ${y.inventarisnummer}</span>`),y.datering_tekst&&(w+=`<br/><span class="text-sm text-purple-700">${y.datering_tekst}</span>`)),(y.veensoort||y.dikte)&&(y.veensoort&&(w+=`<br/><span class="text-sm text-amber-700">${y.veensoort}</span>`),y.dikte&&(w+=`<br/><span class="text-xs text-gray-600">Dikte: ${y.dikte}</span>`)),y.nature&&y.debut){w+=`<br/><span class="text-sm text-purple-700">${y.nature}</span>`;const P=y.debut===y.fin?y.debut:`${y.debut} - ${y.fin}`;P&&(w+=`<br/><span class="text-sm text-gray-700">Periode: ${P}</span>`),y.structure&&(w+=`<br/><span class="text-xs text-gray-600">${y.structure}</span>`),y.commune&&(w+=`<br/><span class="text-xs text-gray-500">${y.commune}</span>`),y.decouvert&&(w+=`<br/><span class="text-xs text-gray-400">Ontdekt: ${y.decouvert}</span>`),y.numero&&(w+=`<br/><span class="text-xs text-gray-400">${y.numero}</span>`)}if((y.NATURE_OPE||y.CODE_OPERA)&&(y.TITRE&&(w+=`<br/><span class="text-sm font-semibold">${y.TITRE}</span>`),y.NATURE_OPE&&(w+=`<br/><span class="text-sm text-amber-700">${y.NATURE_OPE}</span>`),y.AUTEUR&&(w+=`<br/><span class="text-xs text-gray-600">Auteur: ${y.AUTEUR}</span>`),y.DATE&&(w+=`<br/><span class="text-xs text-gray-500">Datum: ${y.DATE}</span>`),y.COMMUNE&&(w+=`<br/><span class="text-xs text-gray-500">${y.COMMUNE}</span>`)),y.type_protection&&(y.n_site||y.t_site)){const P=y.type_protection==="Classe"?"text-red-700":"text-amber-700";w+=`<br/><span class="text-sm ${P}">${y.type_protection}</span>`,y.n_site&&(w+=`<br/><span class="text-sm font-semibold">${y.n_site}</span>`),y.t_site&&(w+=`<br/><span class="text-xs text-gray-600">${y.t_site}</span>`),y.c_site&&(w+=`<br/><span class="text-xs text-gray-500">Code: ${y.c_site}</span>`),y.d_creation&&(w+=`<br/><span class="text-xs text-gray-400">Beschermd sinds: ${y.d_creation}</span>`)}if(y.type_protection&&y.cod_diren){const P=y.type_protection==="Classe"?"text-red-700":"text-amber-700";if(w+=`<br/><span class="text-sm ${P}">${y.type_protection}</span>`,y.proced&&(w+=`<br/><span class="text-xs text-gray-600">${y.proced}</span>`),y.d_proced&&(w+=`<br/><span class="text-xs text-gray-500">Date: ${y.d_proced}</span>`),y.comment){const C=String(y.comment).slice(0,150);w+=`<br/><span class="text-xs text-gray-600 italic">${C}${String(y.comment).length>150?"...":""}</span>`}}if(y.type_protection&&y.nomsite){const P=y.type_protection==="Classe"?"text-red-700":"text-amber-700";if(w+=`<br/><span class="text-sm ${P}">${y.type_protection}</span>`,y.caractere&&(w+=`<br/><span class="text-xs text-gray-600">${y.caractere}</span>`),y.datedecis&&(w+=`<br/><span class="text-xs text-gray-500">Date: ${y.datedecis}</span>`),y.descriptio){const C=String(y.descriptio).slice(0,150);w+=`<br/><span class="text-xs text-gray-600 italic">${C}${String(y.descriptio).length>150?"...":""}</span>`}}if(y.secteur&&y.style){if(w+=`<br/><span class="text-sm text-gray-700">${y.secteur}</span>`,y["sous-secteur"]&&(w+=`<br/><span class="text-xs text-gray-600">${y["sous-secteur"]}</span>`),y.description){const P=String(y.description).slice(0,150);w+=`<br/><span class="text-xs text-gray-600 italic">${P}${String(y.description).length>150?"...":""}</span>`}y.url&&(w+=`<br/><a href="${y.url}" target="_blank" class="text-xs text-blue-600 hover:underline">Meer info</a>`)}if(y.nature_operation||y.synthese){y.nature_operation&&(w+=`<br/><span class="text-sm text-red-700">${y.nature_operation}</span>`),y.responsable_operation&&(w+=`<br/><span class="text-xs text-gray-600">Responsable: ${y.responsable_operation}</span>`),y.date_operation&&(w+=`<br/><span class="text-xs text-gray-500">Datum: ${y.date_operation}</span>`);const P=[];if(y.prehistoire==="Oui"&&P.push("Prehistorie"),y.protohistoire==="Oui"&&P.push("Protohistorie"),y.antiquite==="Oui"&&P.push("Romeins"),y.moyen_age==="Oui"&&P.push("Middeleeuwen"),y.temps_modernes==="Oui"&&P.push("Moderne tijd"),P.length>0&&(w+=`<br/><span class="text-sm text-purple-700">${P.join(", ")}</span>`),y.adresse&&(w+=`<br/><span class="text-xs text-gray-500">${y.adresse}</span>`),y.synthese){const C=String(y.synthese).slice(0,200);w+=`<br/><span class="text-xs text-gray-600 italic">${C}${String(y.synthese).length>200?"...":""}</span>`}}if(y.operator&&(w+=`<br/><span class="text-sm text-gray-600">${y.operator}</span>`),y.opening_hours&&(w+=`<br/><span class="text-xs text-green-600">Open: ${y.opening_hours}</span>`),y.website&&(w+=`<br/><a href="${y.website}" target="_blank" class="text-xs text-blue-600 underline">Website</a>`),y.addr_street){const P=[y.addr_street,y.addr_housenumber,y.addr_postcode].filter(Boolean).join(" ");w+=`<br/><span class="text-xs text-gray-500">${P}</span>`}const A=y.description||y.omschrijving||y.descr||y.info;A&&A!==T&&(w+=`<br/><span class="text-sm text-gray-600">${A}</span>`),t(w),r(!0)}else{const m=n.getView().getResolution()||1,v=await c(d.coordinate,m);v&&(t(v),r(!0))}};return n.on("click",h),()=>{n.un("click",h)}},[n]);const s=()=>{r(!1)},o=(a,c)=>{c.offset.y>100&&r(!1)};return M.jsx(Co,{children:i&&M.jsxs(M.Fragment,{children:[M.jsx(_n.div,{className:"fixed inset-0 z-[1500]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:s}),M.jsxs(_n.div,{className:"fixed bottom-0 left-0 right-0 z-[1501] bg-white rounded-t-2xl shadow-2xl",initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{type:"spring",damping:25,stiffness:300},drag:"y",dragConstraints:{top:0},dragElastic:.2,onDragEnd:o,children:[M.jsx("div",{className:"flex justify-center pt-3 pb-2",children:M.jsx("div",{className:"w-10 h-1 bg-gray-300 rounded-full"})}),M.jsx("button",{onClick:s,className:"absolute top-3 right-3 w-8 h-8 flex items-center justify-center text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-full transition-colors","aria-label":"Sluiten",children:M.jsx(Cc,{size:20})}),M.jsx("div",{className:"px-4 pb-6 max-h-[50vh] overflow-y-auto",dangerouslySetInnerHTML:{__html:e}})]})]})})}function One(){const n=Li(w=>w.map),e=Ot(w=>w.position),t=tn(w=>w.startNavigation),i=tn(w=>w.isNavigating),[r,s]=ne.useState(null),[o,a]=ne.useState(!1),[c,h]=ne.useState(!1),d=ne.useRef(null),g=ne.useRef(null);ne.useEffect(()=>{if(!n){console.log(" LongPressMenu: map not ready");return}const w=n.getViewport();if(!w){console.log(" LongPressMenu: viewport not ready");return}console.log(" LongPressMenu: attached to viewport",w);const A=600,P=15,C=F=>{if(console.log(" Touch start, touches:",F.touches.length),F.touches.length!==1)return;const j=F.touches[0];g.current={x:j.clientX,y:j.clientY},console.log(" Starting long press timer at:",g.current),d.current&&clearTimeout(d.current),d.current=window.setTimeout(()=>{if(console.log(" Timer fired! startPos:",g.current),!g.current)return;const U=window.__olMap;if(!U){console.log(" Map not available (global)");return}const O=w.getBoundingClientRect(),ce=[g.current.x-O.left,g.current.y-O.top],we=U.getCoordinateFromPixel(ce);if(we){const ye=Ou(we);F.preventDefault(),s({pixel:[g.current.x,g.current.y],coordinate:ye}),a(!0),h(!1),setTimeout(()=>h(!0),300),"vibrate"in navigator&&navigator.vibrate(50),console.log(" Long press detected at:",ye)}},A)},N=F=>{if(!d.current||!g.current)return;const j=F.touches[0],U=j.clientX-g.current.x,O=j.clientY-g.current.y,ce=Math.sqrt(U*U+O*O);ce>P&&(console.log(" Touch moved too much, cancelling. Distance:",ce),clearTimeout(d.current),d.current=null)},D=()=>{console.log(" Touch end, timer active:",!!d.current),d.current&&(console.log(" Cancelling timer on touch end"),clearTimeout(d.current),d.current=null),g.current=null},z=F=>{o&&F.preventDefault()},k=F=>{F.button===0&&(console.log(" Mouse down"),g.current={x:F.clientX,y:F.clientY},d.current&&clearTimeout(d.current),d.current=window.setTimeout(()=>{if(console.log(" Mouse timer fired!"),!g.current)return;const j=window.__olMap;if(console.log(" __olMap:",j),console.log(" __olMap constructor:",j?.constructor?.name),console.log(" has getCoordinateAtPixel:",typeof j?.getCoordinateAtPixel),!j){console.log(" Map not available (global)");return}const U=w.getBoundingClientRect(),O=[g.current.x-U.left,g.current.y-U.top];console.log(" Pixel:",O);const ce=j.getCoordinateFromPixel(O);if(console.log(" Coordinate:",ce),ce){const we=Ou(ce);s({pixel:[g.current.x,g.current.y],coordinate:we}),a(!0),h(!1),setTimeout(()=>h(!0),300),console.log(" Long press (mouse) detected at:",we)}},A))},R=F=>{if(!d.current||!g.current)return;const j=F.clientX-g.current.x,U=F.clientY-g.current.y;Math.sqrt(j*j+U*U)>P&&(console.log(" Mouse moved, cancelling"),clearTimeout(d.current),d.current=null)},L=()=>{console.log(" Mouse up"),d.current&&(clearTimeout(d.current),d.current=null),g.current=null};return w.addEventListener("touchstart",C,{passive:!1}),w.addEventListener("touchmove",N,{passive:!0}),w.addEventListener("touchend",D),w.addEventListener("touchcancel",D),w.addEventListener("contextmenu",z),w.addEventListener("mousedown",k),w.addEventListener("mousemove",R),w.addEventListener("mouseup",L),w.addEventListener("mouseleave",L),()=>{w.removeEventListener("touchstart",C),w.removeEventListener("touchmove",N),w.removeEventListener("touchend",D),w.removeEventListener("touchcancel",D),w.removeEventListener("contextmenu",z),w.removeEventListener("mousedown",k),w.removeEventListener("mousemove",R),w.removeEventListener("mouseup",L),w.removeEventListener("mouseleave",L),d.current&&clearTimeout(d.current)}},[n,o]);const m=()=>{c&&(a(!1),s(null),h(!1))},v=async()=>{if(!r||!e)return;const[w,A]=r.coordinate,P=`${A.toFixed(4)}, ${w.toFixed(4)}`;await t({lng:w,lat:A},P,{lng:e.lng,lat:e.lat}),a(!1),s(null),h(!1)},y=()=>{a(!1),s(null),h(!1)},T=w=>{const[A,P]=w;return`${P.toFixed(5)}N, ${A.toFixed(5)}E`};return M.jsx(Co,{children:o&&r&&M.jsxs(M.Fragment,{children:[M.jsx(_n.div,{className:"fixed inset-0 z-[1600]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:m}),M.jsxs(_n.div,{className:"fixed z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden min-w-[200px]",style:{left:Math.min(r.pixel[0],window.innerWidth-220),top:Math.min(r.pixel[1],window.innerHeight-180)},initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.15},children:[M.jsx("div",{className:"px-4 py-3 bg-gray-50 border-b border-gray-100",children:M.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[M.jsx(y3,{size:16}),M.jsx("span",{className:"text-xs font-mono",children:T(r.coordinate)})]})}),M.jsxs("div",{className:"py-1",children:[M.jsxs("button",{onClick:v,disabled:!e||i,className:`w-full px-4 py-3 flex items-center gap-3 transition-colors ${e&&!i?"hover:bg-blue-50 text-gray-700":"text-gray-400 cursor-not-allowed"}`,children:[M.jsx(Ey,{size:20,className:e&&!i?"text-blue-500":"text-gray-300"}),M.jsx("span",{className:"font-medium",children:"Navigeer hierheen"})]}),!e&&M.jsx("div",{className:"px-4 py-2 text-xs text-amber-600 bg-amber-50",children:"GPS positie niet beschikbaar"}),i&&M.jsx("div",{className:"px-4 py-2 text-xs text-blue-600 bg-blue-50",children:"Navigatie al actief"})]}),M.jsx("div",{className:"border-t border-gray-100",children:M.jsxs("button",{onClick:y,className:"w-full px-4 py-3 flex items-center justify-center gap-2 text-gray-500 hover:bg-gray-50 transition-colors",children:[M.jsx(Cc,{size:18}),M.jsx("span",{children:"Annuleren"})]})})]})]})})}function Vne(){return M.jsx("div",{className:"fixed bottom-2.5 left-2.5 z-[800] px-2 py-1 bg-white/90 rounded shadow-sm text-xs font-mono text-gray-600",children:"bvd v2.5.0"})}const rE={layers:["AHN4 Multi-Hillshade NL","AHN 0.5m","Geomorfologie","AMK Monumenten"],opacities:{"AHN4 Multi-Hillshade NL":.56,"AHN 0.5m":.6,Geomorfologie:.69,"AMK Monumenten":.4}},Fne=["Parken","Speeltuinen","Strandjes"],jne=["UIKAV Punten","UIKAV Vlakken","UIKAV Expert","UIKAV Buffer","UIKAV Indeling"],Gne=["AHN 0.5m","Geomorfologie","AHN4 Multi-Hillshade NL"],Une=["IKAW","Geomorfologie","Bodemkaart","AHN4 Multi-Hillshade NL","AMK Monumenten"],zne=["WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Militaire Objecten"],sE=["Labels Overlay","Hunebedden","FAMKE Steentijd","Grafheuvels","Terpen","AMK Monumenten","Romeinse wegen","Kastelen","IKAW","Archeo Landschappen","Rijksmonumenten","Werelderfgoed","WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Inundatiegebieden","Militaire Objecten","Paleokaart 800 n.Chr.","Paleokaart 100 n.Chr.","Paleokaart 500 v.Chr.","Paleokaart 1500 v.Chr.","Paleokaart 2750 v.Chr.","Paleokaart 5500 v.Chr.","Paleokaart 9000 v.Chr.","Religieus Erfgoed","UIKAV Punten","UIKAV Vlakken","UIKAV Expert","UIKAV Buffer","UIKAV Indeling","Veengebieden","AHN 0.5m","Geomorfologie","Bodemkaart","AHN4 Hillshade NL","AHN4 Multi-Hillshade NL","AHN4 Helling NL","World Hillshade","Fossielen Nederland","Fossielen Belgi","Fossielen Duitsland","Fossielen Frankrijk","Parken","Speeltuinen","Musea","Strandjes"],Bne=["CartoDB (licht)","OpenStreetMap","Luchtfoto","TMK 1850","Bonnebladen 1900"];function $ne(){const[n,e]=ne.useState(!1),t=Ss(h=>h.setLayerVisibility),i=Ss(h=>h.setLayerOpacity),r=Ot(h=>h.stopTracking),s=Wf(h=>h.toggleSettingsPanel),o=()=>{sE.forEach(h=>t(h,!1)),Bne.forEach(h=>{t(h,h==="CartoDB (licht)")}),r(),console.log(" Reset: CartoDB (licht), alle lagen uit, GPS uit")},a=h=>{sE.forEach(d=>t(d,!1)),h.forEach(d=>t(d,!0)),e(!1)},c=()=>{sE.forEach(h=>t(h,!1)),rE.layers.forEach(h=>{t(h,!0),rE.opacities[h]&&i(h,rE.opacities[h])}),e(!1)};return M.jsxs("div",{className:"fixed bottom-[30px] md:bottom-10 left-2 z-[800]",children:[M.jsxs("div",{className:"flex flex-col gap-2",children:[M.jsx("button",{onClick:()=>e(!n),className:"w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",title:"Presets",children:n?M.jsx(p3,{size:22,className:"text-blue-600"}):M.jsx(_3,{size:22,className:"text-blue-600"})}),M.jsx("button",{onClick:o,className:"w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",title:"Reset - CartoDB, alle lagen uit, GPS uit",children:M.jsx(Lw,{size:22,className:"text-gray-600"})}),M.jsx("button",{onClick:s,className:"w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",title:"Instellingen",children:M.jsx(w3,{size:22,className:"text-gray-600"})})]}),M.jsx(Co,{children:n&&M.jsxs(_n.div,{initial:{opacity:0,y:10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.95},transition:{duration:.15},className:"absolute bottom-0 left-14 bg-white/95 rounded-xl shadow-lg overflow-hidden min-w-[140px] backdrop-blur-sm",children:[M.jsx("div",{className:"px-3 py-1.5 bg-gradient-to-r from-blue-500 to-blue-600 text-white text-xs font-medium",children:"Presets"}),M.jsxs("div",{className:"p-2",children:[M.jsxs("button",{onClick:c,className:"w-full flex items-center gap-2 px-2 py-1.5 hover:bg-purple-50 rounded text-left transition-colors border-0 outline-none bg-transparent",children:[M.jsx(bY,{size:14,className:"text-purple-600"}),M.jsx("span",{className:"text-xs text-gray-700",children:"Detectie"})]}),M.jsxs("button",{onClick:()=>a(jne),className:"w-full flex items-center gap-2 px-2 py-1.5 hover:bg-cyan-50 rounded text-left transition-colors border-0 outline-none bg-transparent",children:[M.jsx(xZ,{size:14,className:"text-cyan-600"}),M.jsx("span",{className:"text-xs text-gray-700",children:"Uiterwaarden"})]}),M.jsxs("button",{onClick:()=>a(Fne),className:"w-full flex items-center gap-2 px-2 py-1.5 hover:bg-green-50 rounded text-left transition-colors border-0 outline-none bg-transparent",children:[M.jsx(pZ,{size:14,className:"text-green-600"}),M.jsx("span",{className:"text-xs text-gray-700",children:"Recreatie"})]}),M.jsxs("button",{onClick:()=>a(Gne),className:"w-full flex items-center gap-2 px-2 py-1.5 hover:bg-stone-50 rounded text-left transition-colors border-0 outline-none bg-transparent",children:[M.jsx(nZ,{size:14,className:"text-stone-600"}),M.jsx("span",{className:"text-xs text-gray-700",children:"Hillshade"})]}),M.jsxs("button",{onClick:()=>a(Une),className:"w-full flex items-center gap-2 px-2 py-1.5 hover:bg-amber-50 rounded text-left transition-colors border-0 outline-none bg-transparent",children:[M.jsx(E3,{size:14,className:"text-amber-600"}),M.jsx("span",{className:"text-xs text-gray-700",children:"Analyse"})]}),M.jsxs("button",{onClick:()=>a(zne),className:"w-full flex items-center gap-2 px-2 py-1.5 hover:bg-red-50 rounded text-left transition-colors border-0 outline-none bg-transparent",children:[M.jsx(gZ,{size:14,className:"text-red-600"}),M.jsx("span",{className:"text-xs text-gray-700",children:"WOII"})]})]})]})})]})}function Wne(){const[n,e]=ne.useState(!1);return M.jsxs(M.Fragment,{children:[M.jsx("button",{onClick:()=>e(!0),className:"fixed top-2.5 right-2.5 z-[800] w-8 h-8 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-lg shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",title:"Info & Attributies",children:M.jsx(WY,{size:16,className:"text-blue-600"})}),M.jsx(Co,{children:n&&M.jsxs(M.Fragment,{children:[M.jsx(_n.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>e(!1)}),M.jsxs(_n.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[90vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[M.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-blue-500 to-blue-600 text-white",children:[M.jsx("span",{className:"font-medium",children:"Info & Attributies"}),M.jsx("button",{onClick:()=>e(!1),className:"p-1 rounded hover:bg-white/20 transition-colors",children:M.jsx(Cc,{size:18})})]}),M.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 text-sm",children:[M.jsxs("section",{children:[M.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Over deze app"}),M.jsx("p",{className:"text-gray-600",children:"Detectorapp NL is een kaartapplicatie voor metal detecting en archeologische verkenning in Nederland."})]}),M.jsxs("section",{children:[M.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Databronnen & Licenties"}),M.jsxs("ul",{className:"space-y-2 text-gray-600",children:[M.jsxs("li",{children:[M.jsx("strong",{children:"RCE / Cultureelerfgoed.nl"})," (CC0/CC-BY)",M.jsx("br",{}),M.jsx("span",{className:"text-xs",children:"AMK, Rijksmonumenten, Werelderfgoed, Paleokaarten, Religieus Erfgoed"})]}),M.jsxs("li",{children:[M.jsx("strong",{children:"PDOK / Kadaster"})," (CC0/CC-BY)",M.jsx("br",{}),M.jsx("span",{className:"text-xs",children:"Luchtfoto, AHN, IKAW, Bodemkaart, Geomorfologie"})]}),M.jsxs("li",{children:[M.jsx("strong",{children:"OpenStreetMap"})," (ODbL)",M.jsx("br",{}),M.jsx("span",{className:"text-xs",children:"Hunebedden, Grafheuvels, Bunkers, Kastelen, Parken, etc."})]}),M.jsxs("li",{children:[M.jsx("strong",{children:"Itiner-E"})," (CC BY 4.0)",M.jsx("br",{}),M.jsx("span",{className:"text-xs",children:"Romeinse wegen - Brughmans, Paout, de Soto & Bjerregaard Vahlstrup"})]}),M.jsxs("li",{children:[M.jsx("strong",{children:"CARTO"})," (CC BY 3.0)",M.jsx("br",{}),M.jsx("span",{className:"text-xs",children:"CartoDB basiskaart"})]}),M.jsxs("li",{children:[M.jsx("strong",{children:"Map5.nl / Kadaster"}),M.jsx("br",{}),M.jsx("span",{className:"text-xs",children:"Historische kaarten (TMK 1850, Bonnebladen 1900)"})]}),M.jsxs("li",{children:[M.jsx("strong",{children:"Friesland Geoportal"}),M.jsx("br",{}),M.jsx("span",{className:"text-xs",children:"FAMKE Steentijd, Terpen"})]}),M.jsxs("li",{children:[M.jsx("strong",{children:"UIKAV / Rijkswaterstaat"}),M.jsx("br",{}),M.jsx("span",{className:"text-xs",children:"Uiterwaarden archeologische data"})]})]})]}),M.jsxs("section",{children:[M.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Privacy"}),M.jsxs("div",{className:"text-gray-600 space-y-2",children:[M.jsxs("p",{children:[M.jsx("strong",{children:"Locatiegegevens:"})," Deze app gebruikt uw GPS-locatie alleen voor navigatie op de kaart. Locatiegegevens worden niet opgeslagen of gedeeld met derden."]}),M.jsxs("p",{children:[M.jsx("strong",{children:"Geen tracking:"})," We verzamelen geen persoonlijke gegevens, analytics of gebruiksstatistieken."]}),M.jsxs("p",{children:[M.jsx("strong",{children:"Lokale opslag:"})," Alle kaartdata wordt lokaal in de app opgeslagen. Er worden geen gegevens naar externe servers gestuurd."]})]})]}),M.jsxs("section",{children:[M.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Contact"}),M.jsx("p",{className:"text-gray-600",children:"Vragen of feedback? Neem contact op via de ontwikkelaar."})]}),M.jsx("section",{className:"pt-2 border-t border-gray-200",children:M.jsx("p",{className:"text-xs text-gray-400 text-center",children:"Detectorapp NL v2.5.0"})})]})]})]})})]})}const Kne=[{name:"AHN4 Hillshade NL",color:"blue",default:.7},{name:"AHN4 Multi-Hillshade NL",color:"blue",default:.7},{name:"AHN4 Helling NL",color:"blue",default:.6},{name:"AHN 0.5m",color:"blue",default:.7},{name:"World Hillshade",color:"blue",default:.7},{name:"Geomorfologie",color:"green",default:.5},{name:"Bodemkaart",color:"amber",default:.6},{name:"IKAW",color:"orange",default:.5},{name:"Archeo Landschappen",color:"green",default:.5},{name:"AMK Monumenten",color:"purple",default:.8}],qne={blue:"accent-blue-500",amber:"accent-amber-500",red:"accent-red-500",indigo:"accent-indigo-500",green:"accent-green-500",orange:"accent-orange-500",purple:"accent-purple-500"};function Hne(){const[n,e]=ne.useState(!1),[t,i]=ne.useState(!1),r=Ss(d=>d.visible),s=Ss(d=>d.opacity),o=Ss(d=>d.setLayerOpacity),a=Kne.filter(d=>r[d.name]);if(a.length===0)return null;const c=t?a:a.slice(0,3),h=a.length>3;return M.jsxs("div",{className:"fixed bottom-[140px] md:bottom-[150px] right-2.5 z-[900]",children:[M.jsxs(_n.button,{onClick:()=>e(!n),className:"w-11 h-11 bg-white/80 rounded-xl backdrop-blur-sm shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none hover:bg-white/90 transition-colors",whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":"Opacity sliders",title:n?"Sluit opacity sliders":"Open opacity sliders",children:[M.jsx(uZ,{size:22,strokeWidth:2,className:"text-gray-500"}),a.length>0&&M.jsx("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-blue-500 text-white text-[10px] rounded-full flex items-center justify-center",children:a.length})]}),M.jsx(Co,{children:n&&M.jsxs(_n.div,{initial:{opacity:0,x:20,scale:.9},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:20,scale:.9},transition:{duration:.2},className:"absolute bottom-0 right-14 bg-white/95 rounded-lg shadow-lg p-3 min-w-[220px] max-h-[60vh] overflow-y-auto",children:[M.jsx("div",{className:"text-xs font-semibold text-gray-500 mb-2 uppercase tracking-wide",children:"Transparantie"}),M.jsx("div",{className:"space-y-3",children:c.map(d=>{const g=s[d.name]??d.default;return M.jsxs("div",{children:[M.jsx("label",{className:"text-xs font-medium text-gray-700 mb-1 block truncate",title:d.name,children:d.name}),M.jsxs("div",{className:"flex items-center gap-2",children:[M.jsx("input",{type:"range",min:"0",max:"100",value:g*100,onChange:m=>o(d.name,parseInt(m.target.value)/100),className:`flex-1 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer ${qne[d.color]}`}),M.jsxs("span",{className:"text-xs text-gray-500 w-8 text-right",children:[Math.round(g*100),"%"]})]})]},d.name)})}),h&&M.jsx("button",{onClick:()=>i(!t),className:"w-full mt-3 pt-2 border-t border-gray-200 flex items-center justify-center gap-1 text-xs text-gray-500 hover:text-gray-700",children:t?M.jsxs(M.Fragment,{children:[M.jsx(p3,{size:14}),"Minder tonen"]}):M.jsxs(M.Fragment,{children:[M.jsx(xY,{size:14}),a.length-3," meer..."]})})]})})]})}function Xne(){const n=Li(C=>C.map),e=Ot(C=>C.position),t=tn(C=>C.startNavigation);tn(C=>C.isNavigating);const i=tn(C=>C.loading),[r,s]=ne.useState(""),[o,a]=ne.useState([]),[c,h]=ne.useState(!1),[d,g]=ne.useState(!1),m=ne.useRef(null),v=ne.useRef();ne.useEffect(()=>{if(v.current&&clearTimeout(v.current),r.length<2){a([]);return}return v.current=window.setTimeout(async()=>{g(!0);try{const N=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/suggest?q=${encodeURIComponent(r)}&rows=7`)).json();N.response?.docs&&a(N.response.docs)}catch(C){console.error("Search error:",C),a([])}finally{g(!1)}},300),()=>{v.current&&clearTimeout(v.current)}},[r]);const y=async C=>{try{const D=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/lookup?id=${encodeURIComponent(C)}`)).json();if(D.response?.docs?.[0]?.centroide_ll){const k=D.response.docs[0].centroide_ll.match(/POINT\(([^ ]+) ([^)]+)\)/);if(k)return{lng:parseFloat(k[1]),lat:parseFloat(k[2])}}}catch(N){console.error("Lookup error:",N)}return null},T=async C=>{if(!n)return;const N=await y(C.id);N&&n.getView().animate({center:ic([N.lng,N.lat]),zoom:16,duration:1e3}),s(""),a([]),h(!1)},w=async(C,N)=>{if(N.stopPropagation(),!e){alert("GPS positie niet beschikbaar. Zet GPS aan.");return}const D=await y(C.id);D&&await t(D,C.weergavenaam,{lng:e.lng,lat:e.lat}),s(""),a([]),h(!1)},A=()=>{s(""),a([]),m.current?.focus()},P=C=>{switch(C){case"adres":return"";case"weg":return"";case"woonplaats":return"";case"gemeente":return"";case"provincie":return"";case"postcode":return"";default:return""}};return M.jsxs("div",{className:"search-box",children:[M.jsxs("div",{className:"search-input-wrapper",children:[M.jsx(E3,{size:18,className:"search-icon"}),M.jsx("input",{ref:m,type:"text",value:r,onChange:C=>{s(C.target.value),h(!0)},onFocus:()=>h(!0),placeholder:"Zoek adres of plaats...",className:"search-input"}),r&&M.jsx("button",{onClick:A,className:"search-clear",children:M.jsx(Cc,{size:16})})]}),c&&o.length>0&&M.jsx("ul",{className:"search-results",children:o.map(C=>M.jsxs("li",{className:"search-result-item",children:[M.jsxs("div",{className:"search-result-content",onClick:()=>T(C),children:[M.jsx("span",{className:"search-result-icon",children:P(C.type)}),M.jsx("span",{className:"search-result-text",children:C.weergavenaam})]}),M.jsx("button",{className:"search-navigate-btn",onClick:N=>w(C,N),disabled:i||!e,title:e?"Navigeer hierheen":"GPS niet actief",children:M.jsx(Ey,{size:16})})]},C.id))}),c&&d&&M.jsx("div",{className:"search-loading",children:"Zoeken..."})]})}function Yne(){const n=Li(i=>i.map),e=()=>{if(!n)return;const i=n.getView(),r=i.getZoom();r!==void 0&&i.animate({zoom:r+1,duration:200})},t=()=>{if(!n)return;const i=n.getView(),r=i.getZoom();r!==void 0&&i.animate({zoom:r-1,duration:200})};return M.jsxs("div",{className:"fixed bottom-[30px] md:bottom-10 right-14 z-[800] flex gap-1",children:[M.jsx(_n.button,{className:"w-10 h-10 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",onClick:t,whileHover:{scale:1.05},whileTap:{scale:.95},title:"Uitzoomen",children:M.jsx(eZ,{size:20,className:"text-gray-600"})}),M.jsx(_n.button,{className:"w-10 h-10 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},title:"Inzoomen",children:M.jsx(sZ,{size:20,className:"text-gray-600"})})]})}function Zne(){const{settingsPanelOpen:n,toggleSettingsPanel:e}=Wf(),t=RW();return M.jsx(Co,{children:n&&M.jsxs(M.Fragment,{children:[M.jsx(_n.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),M.jsxs(_n.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-sm mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[M.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-blue-500 to-blue-600 text-white",children:[M.jsxs("div",{className:"flex items-center gap-2",children:[M.jsx(w3,{size:18}),M.jsx("span",{className:"font-medium",children:"Instellingen"})]}),M.jsx("button",{onClick:e,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none",children:M.jsx(Cc,{size:18})})]}),M.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-5",children:[M.jsxs(Bd,{title:"Algemeen",icon:M.jsx(BY,{size:16}),children:[M.jsx(oE,{label:"Taal",children:M.jsxs("div",{className:"flex gap-1",children:[M.jsx(Vp,{active:t.language==="nl",onClick:()=>t.setLanguage("nl"),label:"NL"}),M.jsx(Vp,{active:t.language==="en",onClick:()=>t.setLanguage("en"),label:"EN"})]})}),M.jsx(oE,{label:"Eenheden",children:M.jsxs("div",{className:"flex gap-1",children:[M.jsx(Vp,{active:t.units==="metric",onClick:()=>t.setUnits("metric"),label:"km"}),M.jsx(Vp,{active:t.units==="imperial",onClick:()=>t.setUnits("imperial"),label:"mi"})]})})]}),M.jsxs(Bd,{title:"Kaart",icon:M.jsx(v3,{size:16}),children:[M.jsx(oE,{label:"Standaard achtergrond",children:M.jsxs("select",{value:t.defaultBackground,onChange:i=>t.setDefaultBackground(i.target.value),className:"px-2 py-1 text-sm bg-gray-100 rounded border-0 outline-none",children:[M.jsx("option",{value:"CartoDB (licht)",children:"Licht"}),M.jsx("option",{value:"CartoDB (donker)",children:"Donker"}),M.jsx("option",{value:"Luchtfoto",children:"Luchtfoto"}),M.jsx("option",{value:"OpenTopoMap",children:"Topo"})]})}),M.jsx(ua,{label:"Onthoud locatie",checked:t.rememberLastLocation,onChange:t.setRememberLastLocation}),M.jsx(ua,{label:"Schaalbalk tonen",checked:t.showScaleBar,onChange:t.setShowScaleBar})]}),M.jsxs(Bd,{title:"GPS",icon:M.jsx(Ey,{size:16}),children:[M.jsx(ua,{label:"GPS aan bij start",checked:t.gpsAutoStart,onChange:t.setGpsAutoStart}),M.jsx(ua,{label:"Kaart draait mee (heading up)",checked:t.headingUpMode,onChange:t.setHeadingUpMode}),M.jsx(ua,{label:"Nauwkeurigheidscirkel",checked:t.showAccuracyCircle,onChange:t.setShowAccuracyCircle})]}),M.jsxs(Bd,{title:"Weergave",icon:M.jsx(VY,{size:16}),children:[M.jsx(ua,{label:"Marker clustering",checked:t.markerClustering,onChange:t.setMarkerClustering}),M.jsx(ua,{label:"Coordinaten tonen",checked:t.showCoordinates,onChange:t.setShowCoordinates})]}),M.jsx(Bd,{title:"Feedback",icon:M.jsx(dZ,{size:16}),children:M.jsx(ua,{label:"Trillen bij acties",checked:t.hapticFeedback,onChange:t.setHapticFeedback})})]}),M.jsx("div",{className:"px-4 py-2 border-t border-gray-100 text-xs text-gray-400 text-center",children:"Instellingen worden lokaal opgeslagen"})]})]})})}function Bd({title:n,icon:e,children:t}){return M.jsxs("section",{children:[M.jsxs("div",{className:"flex items-center gap-2 mb-2 pb-1 border-b border-gray-100",children:[M.jsx("span",{className:"text-blue-600",children:e}),M.jsx("span",{className:"font-medium text-gray-800 text-sm",children:n})]}),M.jsx("div",{className:"space-y-2",children:t})]})}function oE({label:n,children:e}){return M.jsxs("div",{className:"flex items-center justify-between",children:[M.jsx("span",{className:"text-sm text-gray-600",children:n}),e]})}function ua({label:n,checked:e,onChange:t}){return M.jsxs("div",{className:"flex items-center justify-between",children:[M.jsx("span",{className:"text-sm text-gray-600",children:n}),M.jsx("button",{onClick:()=>t(!e),className:`w-10 h-5 rounded-full transition-colors border-0 outline-none relative ${e?"bg-blue-500":"bg-gray-300"}`,children:M.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white shadow transition-transform ${e?"translate-x-5":"translate-x-0.5"}`})})]})}function Vp({active:n,onClick:e,label:t}){return M.jsx("button",{onClick:e,className:`px-2.5 py-1 rounded text-xs border-0 outline-none transition-colors ${n?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:t})}function Qne(n,e){const i=(e.lat-n.lat)*Math.PI/180,r=(e.lng-n.lng)*Math.PI/180,s=Math.sin(i/2)*Math.sin(i/2)+Math.cos(n.lat*Math.PI/180)*Math.cos(e.lat*Math.PI/180)*Math.sin(r/2)*Math.sin(r/2);return 6371e3*(2*Math.atan2(Math.sqrt(s),Math.sqrt(1-s)))}function Jne(n,e){let t=1/0,i=0;for(let r=0;r<e.length;r++){const s=Qne(n,e[r]);s<t&&(t=s,i=r)}return i}function eie(){const n=Li(a=>a.map),e=tn(a=>a.routeCoordinates),t=tn(a=>a.destination),i=tn(a=>a.isNavigating),r=Ot(a=>a.position),s=ne.useRef(null),o=ne.useRef(0);return ne.useEffect(()=>{if(!n)return;const a=new $b;return s.current=new a4({source:a,zIndex:500}),n.addLayer(s.current),()=>{s.current&&n&&n.removeLayer(s.current)}},[n]),ne.useEffect(()=>{i||(o.current=0)},[i]),ne.useEffect(()=>{if(!s.current)return;const a=s.current.getSource();if(!a||(a.clear(),!i||!e||e.length===0))return;let c=0;if(r&&e.length>2){const m={lng:r.lng,lat:r.lat},v=Jne(m,e);v>o.current&&(o.current=v),c=o.current,c>e.length-2&&(c=e.length-2)}const d=e.slice(c).map(m=>ic([m.lng,m.lat])),g=new u0({geometry:new p0(d)});if(g.setStyle([new Xi({stroke:new Xl({color:"white",width:8,lineCap:"round",lineJoin:"round"})}),new Xi({stroke:new Xl({color:"#4285F4",width:5,lineCap:"round",lineJoin:"round"})})]),a.addFeature(g),t){const m=new u0({geometry:new _0(ic([t.lng,t.lat]))});m.setStyle(new Xi({image:new kh({radius:12,fill:new Oa({color:"#EA4335"}),stroke:new Xl({color:"white",width:3})})})),a.addFeature(m)}if(n&&c===0){const m=a.getExtent();n.getView().fit(m,{padding:[80,80,80,80],duration:500})}},[n,i,e,t,r]),null}function tie(n){const e={size:24,className:"text-white"};return n.includes("left")?n.includes("sharp")?M.jsx(LY,{...e}):n.includes("slight")?M.jsx(gY,{...e}):M.jsx(uY,{...e}):n.includes("right")?n.includes("sharp")?M.jsx(DY,{...e}):n.includes("slight")?M.jsx(pY,{...e}):M.jsx(dY,{...e}):n.includes("uturn")?M.jsx(Lw,{...e}):n.includes("arrive")?M.jsx(CY,{...e}):n.includes("roundabout")||n.includes("rotary")?M.jsx(Lw,{...e}):M.jsx(yY,{...e})}function nie(){const n=tn(m=>m.isNavigating),e=tn(m=>m.destinationName),t=tn(m=>m.distance),i=tn(m=>m.duration),r=tn(m=>m.steps),s=tn(m=>m.currentStepIndex),o=tn(m=>m.voiceEnabled),a=tn(m=>m.setVoiceEnabled),c=tn(m=>m.stopNavigation),h=r[s],d=m=>m?m<1e3?`${Math.round(m)} m`:`${(m/1e3).toFixed(1)} km`:"--",g=m=>{if(!m)return"--";if(m<60)return`${Math.round(m)} sec`;const v=Math.round(m/60);if(v<60)return`${v} min`;const y=Math.floor(v/60),T=v%60;return`${y}u ${T}m`};return M.jsx(Co,{children:n&&M.jsxs(_n.div,{className:"fixed top-16 left-2 right-2 z-[1100] bg-white rounded-xl shadow-lg overflow-hidden",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.2},children:[h&&M.jsxs("div",{className:"bg-blue-600 px-4 py-3 flex items-center gap-3",children:[M.jsx("div",{className:"w-12 h-12 rounded-full bg-blue-700 flex items-center justify-center flex-shrink-0",children:tie(h.maneuver)}),M.jsxs("div",{className:"flex-1 min-w-0",children:[M.jsx("div",{className:"text-white font-bold text-lg truncate",children:h.instruction}),M.jsxs("div",{className:"text-blue-200 text-sm",children:["Over ",d(h.distance)]})]}),M.jsx("button",{onClick:()=>a(!o),className:`w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0 transition-colors ${o?"bg-blue-700 text-white":"bg-blue-800 text-blue-400"}`,title:o?"Geluid uit":"Geluid aan",children:o?M.jsx(yZ,{size:20}):M.jsx(EZ,{size:20})})]}),M.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 border-t border-gray-100",children:[M.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center flex-shrink-0",children:M.jsx(Ey,{size:20,className:"text-gray-600"})}),M.jsxs("div",{className:"flex-1 min-w-0",children:[M.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500",children:[M.jsx(y3,{size:12}),M.jsx("span",{children:"Bestemming"})]}),M.jsx("div",{className:"font-medium text-gray-900 truncate text-sm",children:e||"Bestemming"})]}),M.jsxs("div",{className:"text-right flex-shrink-0",children:[M.jsx("div",{className:"text-lg font-bold text-blue-600",children:d(t)}),M.jsx("div",{className:"text-xs text-gray-500",children:g(i)})]}),M.jsx("button",{onClick:c,className:"w-10 h-10 rounded-full bg-red-500 hover:bg-red-600 flex items-center justify-center flex-shrink-0 transition-colors",title:"Stop navigatie",children:M.jsx(Cc,{size:20,className:"text-white"})})]}),r.length>1&&M.jsxs("div",{className:"px-4 pb-2",children:[M.jsx("div",{className:"flex gap-1",children:r.map((m,v)=>M.jsx("div",{className:`h-1 flex-1 rounded-full transition-colors ${v<s?"bg-green-500":v===s?"bg-blue-500":"bg-gray-200"}`},v))}),M.jsxs("div",{className:"text-xs text-gray-400 mt-1 text-center",children:["Stap ",s+1," van ",r.length]})]})]})})}function iie(){const n=Ot(i=>i.tracking),e=Ot(i=>i.headingSource),t=Ot(i=>i.updateHeading);ne.useEffect(()=>{if(!n||e!=="compass")return;let i=0;const r=100,s=c=>{const h=Date.now();h-i<r||(i=h,c.alpha!==null&&t(360-c.alpha,"compass"))},o=c=>{const h=Date.now();h-i<r||(i=h,c.alpha!==null&&t(360-c.alpha,"compass"))},a=c=>{const h=Date.now();h-i<r||(i=h,c.webkitCompassHeading!==void 0&&t(c.webkitCompassHeading,"compass"))};return window.addEventListener("deviceorientationabsolute",o),window.addEventListener("deviceorientation",s),window.addEventListener("deviceorientation",a),()=>{window.removeEventListener("deviceorientationabsolute",o),window.removeEventListener("deviceorientation",s),window.removeEventListener("deviceorientation",a)}},[n,e,t])}const rie=n=>n<.5?2*n*n:-1+(4-2*n)*n;function sie(){const n=Li(c=>c.map),e=Li(c=>c.rotationEnabled),t=Li(c=>c.setRotation),i=Ot(c=>c.smoothHeading),r=Ot(c=>c.tracking),s=Ot(c=>c.navigationMode),o=ne.useRef(null),a=ne.useRef(null);ne.useEffect(()=>{n&&(s==="drive"&&a.current!=="drive"&&(n.getView().animate({zoom:15,duration:500}),console.log(" Rijmodus: zoom naar wijkniveau (15)")),a.current=s)},[n,s]),ne.useEffect(()=>{if(s==="free"){n&&n.getView().getRotation()!==0&&(n.getView().animate({rotation:0,duration:500}),t(0),o.current=null);return}if(!n||!r||!e||i===null){n&&!r&&(n.getView().animate({rotation:0,duration:500}),t(0),o.current=null);return}const c=i*Math.PI/180,h=o.current??n.getView().getRotation();let d=c-h;for(;d>Math.PI;)d-=2*Math.PI;for(;d<-Math.PI;)d+=2*Math.PI;Math.abs(d)<.087||(n.getView().animate({rotation:c,duration:250,easing:rie}),o.current=c,t(i))},[n,r,e,i,t])}function oie(){const n=Li(d=>d.map),e=Ot(d=>d.position),t=Ot(d=>d.tracking),i=Ot(d=>d.navigationMode),r=Ot(d=>d.toggleMode),s=tn(d=>d.isNavigating),o=tn(d=>d.updateCurrentStep),a=tn(d=>d.destination),c=ne.useRef(!1),h=ne.useRef(0);return ne.useEffect(()=>{s&&!c.current?(console.log(" Navigation started - activating drive mode"),i==="free"&&r(),c.current=!0):!s&&c.current&&(console.log(" Navigation stopped - deactivating drive mode"),i==="drive"&&r(),c.current=!1)},[s,i,r]),ne.useEffect(()=>{!s||!e||o({lng:e.lng,lat:e.lat})},[s,e,o]),ne.useEffect(()=>{if(!n||!e||!s||!t)return;const d=Date.now();if(d-h.current<500)return;h.current=d;const g=ic([e.lng,e.lat]);n.getView().animate({center:g,duration:300})},[n,e,s,t]),ne.useEffect(()=>{if(!n||!s)return;(n.getView().getZoom()||15)<14&&n.getView().animate({zoom:15,duration:500})},[n,s,e]),{isNavigating:s,destination:a}}function aie(){return iie(),sie(),oie(),M.jsxs(M.Fragment,{children:[M.jsx(bW,{}),M.jsx(AZ,{}),M.jsx(eie,{}),M.jsx(Dne,{}),M.jsx(One,{}),M.jsx(Xne,{}),M.jsx(nie,{}),M.jsx(IZ,{}),M.jsx(Yne,{}),M.jsx(PZ,{}),M.jsx(CZ,{}),M.jsx(Hne,{}),M.jsx(Vne,{}),M.jsx($ne,{}),M.jsx(Wne,{}),M.jsx(Zne,{})]})}l5.createRoot(document.getElementById("root")).render(M.jsx(aie,{}));export{_0 as $,$2 as A,Io as B,Yb as C,$A as D,He as E,m4 as F,a4 as G,Xi as H,Be as I,Xl as J,Oa as K,V_ as L,$b as M,qu as N,hx as O,k5 as P,fE as Q,qw as R,Bb as S,oo as T,Yv as U,Yn as V,eA as W,ha as X,uie as Y,hie as Z,u0 as _,_F as a,ic as a0,x0 as a1,l6 as a2,Bw as a3,w_ as a4,_5 as a5,P_ as a6,v_ as a7,pb as a8,_b as a9,at as aA,g0 as aB,Fb as aC,xE as aD,ah as aE,c6 as aF,mie as aa,m0 as ab,p0 as ac,xb as ad,_E as ae,f6 as af,_ie as ag,yb as ah,Hu as ai,zl as aj,YM as ak,tx as al,die as am,fie as an,pie as ao,Tie as ap,Sie as aq,rA as ar,n8 as as,i8 as at,xie as au,vie as av,jf as aw,yie as ax,gie as ay,zr as az,An as b,lh as c,ut as d,ei as e,wa as f,Hl as g,Ri as h,I_ as i,$d as j,yo as k,Eie as l,tc as m,AE as n,jV as o,lt as p,GV as q,VV as r,zw as s,Fp as t,Ft as u,Lf as v,cp as w,cE as x,Un as y,wie as z};
//# sourceMappingURL=index-GozijrhN.js.map
