const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/romeinseFortenOL-pLxgGUYx.js","assets/iconStyles-D5Ndn4fr.js","assets/kastelenOL-B4QnzVHi.js","assets/ruinesOL-DR03H0KU.js","assets/hunebeddenOL-C8DIjvKm.js","assets/uikavArcheoPuntenOL-jhv0tlyX.js","assets/speeltuinenOL-ByF1QYAK.js","assets/museaOL-CoBdoUFL.js","assets/kringloopwinkelsOL-CtAqOFnP.js","assets/fossielenOL-DmItwvxH.js","assets/fossielUtils-Dw4ANg3u.js","assets/fossielenBelgieOL-C9JfrCFC.js","assets/fossielenDuitslandOL-BF5HCBrN.js","assets/fossielenFrankrijkOL-_ROoxzub.js","assets/bunkersOL-CPe954A9.js","assets/grafheuvelsOL-_qw5Hmh8.js","assets/slagveldenOL-CBjvfOsd.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();function XR(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var hS={exports:{}},am={},dS={exports:{}},mn={};var j4;function vU(){if(j4)return mn;j4=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),a=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),g=Symbol.iterator;function m(ie){return ie===null||typeof ie!="object"?null:(ie=g&&ie[g]||ie["@@iterator"],typeof ie=="function"?ie:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_=Object.assign,x={};function w(ie,V,J){this.props=ie,this.context=V,this.refs=x,this.updater=J||y}w.prototype.isReactComponent={},w.prototype.setState=function(ie,V){if(typeof ie!="object"&&typeof ie!="function"&&ie!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,ie,V,"setState")},w.prototype.forceUpdate=function(ie){this.updater.enqueueForceUpdate(this,ie,"forceUpdate")};function b(){}b.prototype=w.prototype;function T(ie,V,J){this.props=ie,this.context=V,this.refs=x,this.updater=J||y}var k=T.prototype=new b;k.constructor=T,_(k,w.prototype),k.isPureReactComponent=!0;var L=Array.isArray,O=Object.prototype.hasOwnProperty,B={current:null},R={key:!0,ref:!0,__self:!0,__source:!0};function A(ie,V,J){var te,re={},he=null,Be=null;if(V!=null)for(te in V.ref!==void 0&&(Be=V.ref),V.key!==void 0&&(he=""+V.key),V)O.call(V,te)&&!R.hasOwnProperty(te)&&(re[te]=V[te]);var Ge=arguments.length-2;if(Ge===1)re.children=J;else if(1<Ge){for(var ye=Array(Ge),pe=0;pe<Ge;pe++)ye[pe]=arguments[pe+2];re.children=ye}if(ie&&ie.defaultProps)for(te in Ge=ie.defaultProps,Ge)re[te]===void 0&&(re[te]=Ge[te]);return{$$typeof:n,type:ie,key:he,ref:Be,props:re,_owner:B.current}}function P(ie,V){return{$$typeof:n,type:ie.type,key:V,ref:ie.ref,props:ie.props,_owner:ie._owner}}function D(ie){return typeof ie=="object"&&ie!==null&&ie.$$typeof===n}function N(ie){var V={"=":"=0",":":"=2"};return"$"+ie.replace(/[=:]/g,function(J){return V[J]})}var G=/\/+/g;function j(ie,V){return typeof ie=="object"&&ie!==null&&ie.key!=null?N(""+ie.key):V.toString(36)}function ve(ie,V,J,te,re){var he=typeof ie;(he==="undefined"||he==="boolean")&&(ie=null);var Be=!1;if(ie===null)Be=!0;else switch(he){case"string":case"number":Be=!0;break;case"object":switch(ie.$$typeof){case n:case e:Be=!0}}if(Be)return Be=ie,re=re(Be),ie=te===""?"."+j(Be,0):te,L(re)?(J="",ie!=null&&(J=ie.replace(G,"$&/")+"/"),ve(re,V,J,"",function(pe){return pe})):re!=null&&(D(re)&&(re=P(re,J+(!re.key||Be&&Be.key===re.key?"":(""+re.key).replace(G,"$&/")+"/")+ie)),V.push(re)),1;if(Be=0,te=te===""?".":te+":",L(ie))for(var Ge=0;Ge<ie.length;Ge++){he=ie[Ge];var ye=te+j(he,Ge);Be+=ve(he,V,J,ye,re)}else if(ye=m(ie),typeof ye=="function")for(ie=ye.call(ie),Ge=0;!(he=ie.next()).done;)he=he.value,ye=te+j(he,Ge++),Be+=ve(he,V,J,ye,re);else if(he==="object")throw V=String(ie),Error("Objects are not valid as a React child (found: "+(V==="[object Object]"?"object with keys {"+Object.keys(ie).join(", ")+"}":V)+"). If you meant to render a collection of children, use an array instead.");return Be}function ce(ie,V,J){if(ie==null)return ie;var te=[],re=0;return ve(ie,te,"","",function(he){return V.call(J,he,re++)}),te}function je(ie){if(ie._status===-1){var V=ie._result;V=V(),V.then(function(J){(ie._status===0||ie._status===-1)&&(ie._status=1,ie._result=J)},function(J){(ie._status===0||ie._status===-1)&&(ie._status=2,ie._result=J)}),ie._status===-1&&(ie._status=0,ie._result=V)}if(ie._status===1)return ie._result.default;throw ie._result}var Pe={current:null},ue={transition:null},Ne={ReactCurrentDispatcher:Pe,ReactCurrentBatchConfig:ue,ReactCurrentOwner:B};function be(){throw Error("act(...) is not supported in production builds of React.")}return mn.Children={map:ce,forEach:function(ie,V,J){ce(ie,function(){V.apply(this,arguments)},J)},count:function(ie){var V=0;return ce(ie,function(){V++}),V},toArray:function(ie){return ce(ie,function(V){return V})||[]},only:function(ie){if(!D(ie))throw Error("React.Children.only expected to receive a single React element child.");return ie}},mn.Component=w,mn.Fragment=t,mn.Profiler=i,mn.PureComponent=T,mn.StrictMode=r,mn.Suspense=l,mn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ne,mn.act=be,mn.cloneElement=function(ie,V,J){if(ie==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+ie+".");var te=_({},ie.props),re=ie.key,he=ie.ref,Be=ie._owner;if(V!=null){if(V.ref!==void 0&&(he=V.ref,Be=B.current),V.key!==void 0&&(re=""+V.key),ie.type&&ie.type.defaultProps)var Ge=ie.type.defaultProps;for(ye in V)O.call(V,ye)&&!R.hasOwnProperty(ye)&&(te[ye]=V[ye]===void 0&&Ge!==void 0?Ge[ye]:V[ye])}var ye=arguments.length-2;if(ye===1)te.children=J;else if(1<ye){Ge=Array(ye);for(var pe=0;pe<ye;pe++)Ge[pe]=arguments[pe+2];te.children=Ge}return{$$typeof:n,type:ie.type,key:re,ref:he,props:te,_owner:Be}},mn.createContext=function(ie){return ie={$$typeof:a,_currentValue:ie,_currentValue2:ie,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},ie.Provider={$$typeof:s,_context:ie},ie.Consumer=ie},mn.createElement=A,mn.createFactory=function(ie){var V=A.bind(null,ie);return V.type=ie,V},mn.createRef=function(){return{current:null}},mn.forwardRef=function(ie){return{$$typeof:o,render:ie}},mn.isValidElement=D,mn.lazy=function(ie){return{$$typeof:h,_payload:{_status:-1,_result:ie},_init:je}},mn.memo=function(ie,V){return{$$typeof:c,type:ie,compare:V===void 0?null:V}},mn.startTransition=function(ie){var V=ue.transition;ue.transition={};try{ie()}finally{ue.transition=V}},mn.unstable_act=be,mn.useCallback=function(ie,V){return Pe.current.useCallback(ie,V)},mn.useContext=function(ie){return Pe.current.useContext(ie)},mn.useDebugValue=function(){},mn.useDeferredValue=function(ie){return Pe.current.useDeferredValue(ie)},mn.useEffect=function(ie,V){return Pe.current.useEffect(ie,V)},mn.useId=function(){return Pe.current.useId()},mn.useImperativeHandle=function(ie,V,J){return Pe.current.useImperativeHandle(ie,V,J)},mn.useInsertionEffect=function(ie,V){return Pe.current.useInsertionEffect(ie,V)},mn.useLayoutEffect=function(ie,V){return Pe.current.useLayoutEffect(ie,V)},mn.useMemo=function(ie,V){return Pe.current.useMemo(ie,V)},mn.useReducer=function(ie,V,J){return Pe.current.useReducer(ie,V,J)},mn.useRef=function(ie){return Pe.current.useRef(ie)},mn.useState=function(ie){return Pe.current.useState(ie)},mn.useSyncExternalStore=function(ie,V,J){return Pe.current.useSyncExternalStore(ie,V,J)},mn.useTransition=function(){return Pe.current.useTransition()},mn.version="18.3.1",mn}var F4;function f1(){return F4||(F4=1,dS.exports=vU()),dS.exports}var V4;function wU(){if(V4)return am;V4=1;var n=f1(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,i=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function a(o,l,c){var h,g={},m=null,y=null;c!==void 0&&(m=""+c),l.key!==void 0&&(m=""+l.key),l.ref!==void 0&&(y=l.ref);for(h in l)r.call(l,h)&&!s.hasOwnProperty(h)&&(g[h]=l[h]);if(o&&o.defaultProps)for(h in l=o.defaultProps,l)g[h]===void 0&&(g[h]=l[h]);return{$$typeof:e,type:o,key:m,ref:y,props:g,_owner:i.current}}return am.Fragment=t,am.jsx=a,am.jsxs=a,am}var B4;function EU(){return B4||(B4=1,hS.exports=wU()),hS.exports}var f=EU(),hx={},fS={exports:{}},Ps={},gS={exports:{}},mS={};var G4;function SU(){return G4||(G4=1,(function(n){function e(ue,Ne){var be=ue.length;ue.push(Ne);e:for(;0<be;){var ie=be-1>>>1,V=ue[ie];if(0<i(V,Ne))ue[ie]=Ne,ue[be]=V,be=ie;else break e}}function t(ue){return ue.length===0?null:ue[0]}function r(ue){if(ue.length===0)return null;var Ne=ue[0],be=ue.pop();if(be!==Ne){ue[0]=be;e:for(var ie=0,V=ue.length,J=V>>>1;ie<J;){var te=2*(ie+1)-1,re=ue[te],he=te+1,Be=ue[he];if(0>i(re,be))he<V&&0>i(Be,re)?(ue[ie]=Be,ue[he]=be,ie=he):(ue[ie]=re,ue[te]=be,ie=te);else if(he<V&&0>i(Be,be))ue[ie]=Be,ue[he]=be,ie=he;else break e}}return Ne}function i(ue,Ne){var be=ue.sortIndex-Ne.sortIndex;return be!==0?be:ue.id-Ne.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();n.unstable_now=function(){return a.now()-o}}var l=[],c=[],h=1,g=null,m=3,y=!1,_=!1,x=!1,w=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function k(ue){for(var Ne=t(c);Ne!==null;){if(Ne.callback===null)r(c);else if(Ne.startTime<=ue)r(c),Ne.sortIndex=Ne.expirationTime,e(l,Ne);else break;Ne=t(c)}}function L(ue){if(x=!1,k(ue),!_)if(t(l)!==null)_=!0,je(O);else{var Ne=t(c);Ne!==null&&Pe(L,Ne.startTime-ue)}}function O(ue,Ne){_=!1,x&&(x=!1,b(A),A=-1),y=!0;var be=m;try{for(k(Ne),g=t(l);g!==null&&(!(g.expirationTime>Ne)||ue&&!N());){var ie=g.callback;if(typeof ie=="function"){g.callback=null,m=g.priorityLevel;var V=ie(g.expirationTime<=Ne);Ne=n.unstable_now(),typeof V=="function"?g.callback=V:g===t(l)&&r(l),k(Ne)}else r(l);g=t(l)}if(g!==null)var J=!0;else{var te=t(c);te!==null&&Pe(L,te.startTime-Ne),J=!1}return J}finally{g=null,m=be,y=!1}}var B=!1,R=null,A=-1,P=5,D=-1;function N(){return!(n.unstable_now()-D<P)}function G(){if(R!==null){var ue=n.unstable_now();D=ue;var Ne=!0;try{Ne=R(!0,ue)}finally{Ne?j():(B=!1,R=null)}}else B=!1}var j;if(typeof T=="function")j=function(){T(G)};else if(typeof MessageChannel<"u"){var ve=new MessageChannel,ce=ve.port2;ve.port1.onmessage=G,j=function(){ce.postMessage(null)}}else j=function(){w(G,0)};function je(ue){R=ue,B||(B=!0,j())}function Pe(ue,Ne){A=w(function(){ue(n.unstable_now())},Ne)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(ue){ue.callback=null},n.unstable_continueExecution=function(){_||y||(_=!0,je(O))},n.unstable_forceFrameRate=function(ue){0>ue||125<ue?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<ue?Math.floor(1e3/ue):5},n.unstable_getCurrentPriorityLevel=function(){return m},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(ue){switch(m){case 1:case 2:case 3:var Ne=3;break;default:Ne=m}var be=m;m=Ne;try{return ue()}finally{m=be}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(ue,Ne){switch(ue){case 1:case 2:case 3:case 4:case 5:break;default:ue=3}var be=m;m=ue;try{return Ne()}finally{m=be}},n.unstable_scheduleCallback=function(ue,Ne,be){var ie=n.unstable_now();switch(typeof be=="object"&&be!==null?(be=be.delay,be=typeof be=="number"&&0<be?ie+be:ie):be=ie,ue){case 1:var V=-1;break;case 2:V=250;break;case 5:V=1073741823;break;case 4:V=1e4;break;default:V=5e3}return V=be+V,ue={id:h++,callback:Ne,priorityLevel:ue,startTime:be,expirationTime:V,sortIndex:-1},be>ie?(ue.sortIndex=be,e(c,ue),t(l)===null&&ue===t(c)&&(x?(b(A),A=-1):x=!0,Pe(L,be-ie))):(ue.sortIndex=V,e(l,ue),_||y||(_=!0,je(O))),ue},n.unstable_shouldYield=N,n.unstable_wrapCallback=function(ue){var Ne=m;return function(){var be=m;m=Ne;try{return ue.apply(this,arguments)}finally{m=be}}}})(mS)),mS}var z4;function bU(){return z4||(z4=1,gS.exports=SU()),gS.exports}var U4;function TU(){if(U4)return Ps;U4=1;var n=f1(),e=bU();function t(u){for(var d="https://reactjs.org/docs/error-decoder.html?invariant="+u,p=1;p<arguments.length;p++)d+="&args[]="+encodeURIComponent(arguments[p]);return"Minified React error #"+u+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,i={};function s(u,d){a(u,d),a(u+"Capture",d)}function a(u,d){for(i[u]=d,u=0;u<d.length;u++)r.add(d[u])}var o=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),l=Object.prototype.hasOwnProperty,c=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},g={};function m(u){return l.call(g,u)?!0:l.call(h,u)?!1:c.test(u)?g[u]=!0:(h[u]=!0,!1)}function y(u,d,p,E){if(p!==null&&p.type===0)return!1;switch(typeof d){case"function":case"symbol":return!0;case"boolean":return E?!1:p!==null?!p.acceptsBooleans:(u=u.toLowerCase().slice(0,5),u!=="data-"&&u!=="aria-");default:return!1}}function _(u,d,p,E){if(d===null||typeof d>"u"||y(u,d,p,E))return!0;if(E)return!1;if(p!==null)switch(p.type){case 3:return!d;case 4:return d===!1;case 5:return isNaN(d);case 6:return isNaN(d)||1>d}return!1}function x(u,d,p,E,S,I,U){this.acceptsBooleans=d===2||d===3||d===4,this.attributeName=E,this.attributeNamespace=S,this.mustUseProperty=p,this.propertyName=u,this.type=d,this.sanitizeURL=I,this.removeEmptyString=U}var w={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(u){w[u]=new x(u,0,!1,u,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(u){var d=u[0];w[d]=new x(d,1,!1,u[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(u){w[u]=new x(u,2,!1,u.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(u){w[u]=new x(u,2,!1,u,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(u){w[u]=new x(u,3,!1,u.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(u){w[u]=new x(u,3,!0,u,null,!1,!1)}),["capture","download"].forEach(function(u){w[u]=new x(u,4,!1,u,null,!1,!1)}),["cols","rows","size","span"].forEach(function(u){w[u]=new x(u,6,!1,u,null,!1,!1)}),["rowSpan","start"].forEach(function(u){w[u]=new x(u,5,!1,u.toLowerCase(),null,!1,!1)});var b=/[\-:]([a-z])/g;function T(u){return u[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(u){var d=u.replace(b,T);w[d]=new x(d,1,!1,u,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(u){var d=u.replace(b,T);w[d]=new x(d,1,!1,u,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(u){var d=u.replace(b,T);w[d]=new x(d,1,!1,u,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(u){w[u]=new x(u,1,!1,u.toLowerCase(),null,!1,!1)}),w.xlinkHref=new x("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(u){w[u]=new x(u,1,!1,u.toLowerCase(),null,!0,!0)});function k(u,d,p,E){var S=w.hasOwnProperty(d)?w[d]:null;(S!==null?S.type!==0:E||!(2<d.length)||d[0]!=="o"&&d[0]!=="O"||d[1]!=="n"&&d[1]!=="N")&&(_(d,p,S,E)&&(p=null),E||S===null?m(d)&&(p===null?u.removeAttribute(d):u.setAttribute(d,""+p)):S.mustUseProperty?u[S.propertyName]=p===null?S.type===3?!1:"":p:(d=S.attributeName,E=S.attributeNamespace,p===null?u.removeAttribute(d):(S=S.type,p=S===3||S===4&&p===!0?"":""+p,E?u.setAttributeNS(E,d,p):u.setAttribute(d,p))))}var L=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,O=Symbol.for("react.element"),B=Symbol.for("react.portal"),R=Symbol.for("react.fragment"),A=Symbol.for("react.strict_mode"),P=Symbol.for("react.profiler"),D=Symbol.for("react.provider"),N=Symbol.for("react.context"),G=Symbol.for("react.forward_ref"),j=Symbol.for("react.suspense"),ve=Symbol.for("react.suspense_list"),ce=Symbol.for("react.memo"),je=Symbol.for("react.lazy"),Pe=Symbol.for("react.offscreen"),ue=Symbol.iterator;function Ne(u){return u===null||typeof u!="object"?null:(u=ue&&u[ue]||u["@@iterator"],typeof u=="function"?u:null)}var be=Object.assign,ie;function V(u){if(ie===void 0)try{throw Error()}catch(p){var d=p.stack.trim().match(/\n( *(at )?)/);ie=d&&d[1]||""}return`
`+ie+u}var J=!1;function te(u,d){if(!u||J)return"";J=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(d)if(d=function(){throw Error()},Object.defineProperty(d.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(d,[])}catch(ke){var E=ke}Reflect.construct(u,[],d)}else{try{d.call()}catch(ke){E=ke}u.call(d.prototype)}else{try{throw Error()}catch(ke){E=ke}u()}}catch(ke){if(ke&&E&&typeof ke.stack=="string"){for(var S=ke.stack.split(`
`),I=E.stack.split(`
`),U=S.length-1,se=I.length-1;1<=U&&0<=se&&S[U]!==I[se];)se--;for(;1<=U&&0<=se;U--,se--)if(S[U]!==I[se]){if(U!==1||se!==1)do if(U--,se--,0>se||S[U]!==I[se]){var ae=`
`+S[U].replace(" at new "," at ");return u.displayName&&ae.includes("<anonymous>")&&(ae=ae.replace("<anonymous>",u.displayName)),ae}while(1<=U&&0<=se);break}}}finally{J=!1,Error.prepareStackTrace=p}return(u=u?u.displayName||u.name:"")?V(u):""}function re(u){switch(u.tag){case 5:return V(u.type);case 16:return V("Lazy");case 13:return V("Suspense");case 19:return V("SuspenseList");case 0:case 2:case 15:return u=te(u.type,!1),u;case 11:return u=te(u.type.render,!1),u;case 1:return u=te(u.type,!0),u;default:return""}}function he(u){if(u==null)return null;if(typeof u=="function")return u.displayName||u.name||null;if(typeof u=="string")return u;switch(u){case R:return"Fragment";case B:return"Portal";case P:return"Profiler";case A:return"StrictMode";case j:return"Suspense";case ve:return"SuspenseList"}if(typeof u=="object")switch(u.$$typeof){case N:return(u.displayName||"Context")+".Consumer";case D:return(u._context.displayName||"Context")+".Provider";case G:var d=u.render;return u=u.displayName,u||(u=d.displayName||d.name||"",u=u!==""?"ForwardRef("+u+")":"ForwardRef"),u;case ce:return d=u.displayName||null,d!==null?d:he(u.type)||"Memo";case je:d=u._payload,u=u._init;try{return he(u(d))}catch{}}return null}function Be(u){var d=u.type;switch(u.tag){case 24:return"Cache";case 9:return(d.displayName||"Context")+".Consumer";case 10:return(d._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return u=d.render,u=u.displayName||u.name||"",d.displayName||(u!==""?"ForwardRef("+u+")":"ForwardRef");case 7:return"Fragment";case 5:return d;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return he(d);case 8:return d===A?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof d=="function")return d.displayName||d.name||null;if(typeof d=="string")return d}return null}function Ge(u){switch(typeof u){case"boolean":case"number":case"string":case"undefined":return u;case"object":return u;default:return""}}function ye(u){var d=u.type;return(u=u.nodeName)&&u.toLowerCase()==="input"&&(d==="checkbox"||d==="radio")}function pe(u){var d=ye(u)?"checked":"value",p=Object.getOwnPropertyDescriptor(u.constructor.prototype,d),E=""+u[d];if(!u.hasOwnProperty(d)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var S=p.get,I=p.set;return Object.defineProperty(u,d,{configurable:!0,get:function(){return S.call(this)},set:function(U){E=""+U,I.call(this,U)}}),Object.defineProperty(u,d,{enumerable:p.enumerable}),{getValue:function(){return E},setValue:function(U){E=""+U},stopTracking:function(){u._valueTracker=null,delete u[d]}}}}function Et(u){u._valueTracker||(u._valueTracker=pe(u))}function Ve(u){if(!u)return!1;var d=u._valueTracker;if(!d)return!0;var p=d.getValue(),E="";return u&&(E=ye(u)?u.checked?"true":"false":u.value),u=E,u!==p?(d.setValue(u),!0):!1}function jt(u){if(u=u||(typeof document<"u"?document:void 0),typeof u>"u")return null;try{return u.activeElement||u.body}catch{return u.body}}function St(u,d){var p=d.checked;return be({},d,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:p??u._wrapperState.initialChecked})}function Ut(u,d){var p=d.defaultValue==null?"":d.defaultValue,E=d.checked!=null?d.checked:d.defaultChecked;p=Ge(d.value!=null?d.value:p),u._wrapperState={initialChecked:E,initialValue:p,controlled:d.type==="checkbox"||d.type==="radio"?d.checked!=null:d.value!=null}}function Ht(u,d){d=d.checked,d!=null&&k(u,"checked",d,!1)}function tt(u,d){Ht(u,d);var p=Ge(d.value),E=d.type;if(p!=null)E==="number"?(p===0&&u.value===""||u.value!=p)&&(u.value=""+p):u.value!==""+p&&(u.value=""+p);else if(E==="submit"||E==="reset"){u.removeAttribute("value");return}d.hasOwnProperty("value")?ln(u,d.type,p):d.hasOwnProperty("defaultValue")&&ln(u,d.type,Ge(d.defaultValue)),d.checked==null&&d.defaultChecked!=null&&(u.defaultChecked=!!d.defaultChecked)}function kn(u,d,p){if(d.hasOwnProperty("value")||d.hasOwnProperty("defaultValue")){var E=d.type;if(!(E!=="submit"&&E!=="reset"||d.value!==void 0&&d.value!==null))return;d=""+u._wrapperState.initialValue,p||d===u.value||(u.value=d),u.defaultValue=d}p=u.name,p!==""&&(u.name=""),u.defaultChecked=!!u._wrapperState.initialChecked,p!==""&&(u.name=p)}function ln(u,d,p){(d!=="number"||jt(u.ownerDocument)!==u)&&(p==null?u.defaultValue=""+u._wrapperState.initialValue:u.defaultValue!==""+p&&(u.defaultValue=""+p))}var hn=Array.isArray;function sr(u,d,p,E){if(u=u.options,d){d={};for(var S=0;S<p.length;S++)d["$"+p[S]]=!0;for(p=0;p<u.length;p++)S=d.hasOwnProperty("$"+u[p].value),u[p].selected!==S&&(u[p].selected=S),S&&E&&(u[p].defaultSelected=!0)}else{for(p=""+Ge(p),d=null,S=0;S<u.length;S++){if(u[S].value===p){u[S].selected=!0,E&&(u[S].defaultSelected=!0);return}d!==null||u[S].disabled||(d=u[S])}d!==null&&(d.selected=!0)}}function Pi(u,d){if(d.dangerouslySetInnerHTML!=null)throw Error(t(91));return be({},d,{value:void 0,defaultValue:void 0,children:""+u._wrapperState.initialValue})}function Gn(u,d){var p=d.value;if(p==null){if(p=d.children,d=d.defaultValue,p!=null){if(d!=null)throw Error(t(92));if(hn(p)){if(1<p.length)throw Error(t(93));p=p[0]}d=p}d==null&&(d=""),p=d}u._wrapperState={initialValue:Ge(p)}}function br(u,d){var p=Ge(d.value),E=Ge(d.defaultValue);p!=null&&(p=""+p,p!==u.value&&(u.value=p),d.defaultValue==null&&u.defaultValue!==p&&(u.defaultValue=p)),E!=null&&(u.defaultValue=""+E)}function oi(u){var d=u.textContent;d===u._wrapperState.initialValue&&d!==""&&d!==null&&(u.value=d)}function _t(u){switch(u){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function xn(u,d){return u==null||u==="http://www.w3.org/1999/xhtml"?_t(d):u==="http://www.w3.org/2000/svg"&&d==="foreignObject"?"http://www.w3.org/1999/xhtml":u}var In,Tt=(function(u){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(d,p,E,S){MSApp.execUnsafeLocalFunction(function(){return u(d,p,E,S)})}:u})(function(u,d){if(u.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in u)u.innerHTML=d;else{for(In=In||document.createElement("div"),In.innerHTML="<svg>"+d.valueOf().toString()+"</svg>",d=In.firstChild;u.firstChild;)u.removeChild(u.firstChild);for(;d.firstChild;)u.appendChild(d.firstChild)}});function an(u,d){if(d){var p=u.firstChild;if(p&&p===u.lastChild&&p.nodeType===3){p.nodeValue=d;return}}u.textContent=d}var Lt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Yi=["Webkit","ms","Moz","O"];Object.keys(Lt).forEach(function(u){Yi.forEach(function(d){d=d+u.charAt(0).toUpperCase()+u.substring(1),Lt[d]=Lt[u]})});function Mr(u,d,p){return d==null||typeof d=="boolean"||d===""?"":p||typeof d!="number"||d===0||Lt.hasOwnProperty(u)&&Lt[u]?(""+d).trim():d+"px"}function li(u,d){u=u.style;for(var p in d)if(d.hasOwnProperty(p)){var E=p.indexOf("--")===0,S=Mr(p,d[p],E);p==="float"&&(p="cssFloat"),E?u.setProperty(p,S):u[p]=S}}var rn=be({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Tr(u,d){if(d){if(rn[u]&&(d.children!=null||d.dangerouslySetInnerHTML!=null))throw Error(t(137,u));if(d.dangerouslySetInnerHTML!=null){if(d.children!=null)throw Error(t(60));if(typeof d.dangerouslySetInnerHTML!="object"||!("__html"in d.dangerouslySetInnerHTML))throw Error(t(61))}if(d.style!=null&&typeof d.style!="object")throw Error(t(62))}}function Fe(u,d){if(u.indexOf("-")===-1)return typeof d.is=="string";switch(u){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xe=null;function _e(u){return u=u.target||u.srcElement||window,u.correspondingUseElement&&(u=u.correspondingUseElement),u.nodeType===3?u.parentNode:u}var Dt=null,M=null,ut=null;function W(u){if(u=Wg(u)){if(typeof Dt!="function")throw Error(t(280));var d=u.stateNode;d&&(d=Ry(d),Dt(u.stateNode,u.type,d))}}function ne(u){M?ut?ut.push(u):ut=[u]:M=u}function Ce(){if(M){var u=M,d=ut;if(ut=M=null,W(u),d)for(u=0;u<d.length;u++)W(d[u])}}function q(u,d){return u(d)}function le(){}var Ae=!1;function ze(u,d,p){if(Ae)return u(d,p);Ae=!0;try{return q(u,d,p)}finally{Ae=!1,(M!==null||ut!==null)&&(le(),Ce())}}function Me(u,d){var p=u.stateNode;if(p===null)return null;var E=Ry(p);if(E===null)return null;p=E[d];e:switch(d){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(E=!E.disabled)||(u=u.type,E=!(u==="button"||u==="input"||u==="select"||u==="textarea")),u=!E;break e;default:u=!1}if(u)return null;if(p&&typeof p!="function")throw Error(t(231,d,typeof p));return p}var He=!1;if(o)try{var $e={};Object.defineProperty($e,"passive",{get:function(){He=!0}}),window.addEventListener("test",$e,$e),window.removeEventListener("test",$e,$e)}catch{He=!1}function yt(u,d,p,E,S,I,U,se,ae){var ke=Array.prototype.slice.call(arguments,3);try{d.apply(p,ke)}catch(qe){this.onError(qe)}}var At=!1,Wt=null,z=!1,Z=null,X={onError:function(u){At=!0,Wt=u}};function Y(u,d,p,E,S,I,U,se,ae){At=!1,Wt=null,yt.apply(X,arguments)}function Q(u,d,p,E,S,I,U,se,ae){if(Y.apply(this,arguments),At){if(At){var ke=Wt;At=!1,Wt=null}else throw Error(t(198));z||(z=!0,Z=ke)}}function ee(u){var d=u,p=u;if(u.alternate)for(;d.return;)d=d.return;else{u=d;do d=u,(d.flags&4098)!==0&&(p=d.return),u=d.return;while(u)}return d.tag===3?p:null}function Ee(u){if(u.tag===13){var d=u.memoizedState;if(d===null&&(u=u.alternate,u!==null&&(d=u.memoizedState)),d!==null)return d.dehydrated}return null}function Oe(u){if(ee(u)!==u)throw Error(t(188))}function we(u){var d=u.alternate;if(!d){if(d=ee(u),d===null)throw Error(t(188));return d!==u?null:u}for(var p=u,E=d;;){var S=p.return;if(S===null)break;var I=S.alternate;if(I===null){if(E=S.return,E!==null){p=E;continue}break}if(S.child===I.child){for(I=S.child;I;){if(I===p)return Oe(S),u;if(I===E)return Oe(S),d;I=I.sibling}throw Error(t(188))}if(p.return!==E.return)p=S,E=I;else{for(var U=!1,se=S.child;se;){if(se===p){U=!0,p=S,E=I;break}if(se===E){U=!0,E=S,p=I;break}se=se.sibling}if(!U){for(se=I.child;se;){if(se===p){U=!0,p=I,E=S;break}if(se===E){U=!0,E=I,p=S;break}se=se.sibling}if(!U)throw Error(t(189))}}if(p.alternate!==E)throw Error(t(190))}if(p.tag!==3)throw Error(t(188));return p.stateNode.current===p?u:d}function Te(u){return u=we(u),u!==null?Re(u):null}function Re(u){if(u.tag===5||u.tag===6)return u;for(u=u.child;u!==null;){var d=Re(u);if(d!==null)return d;u=u.sibling}return null}var Ye=e.unstable_scheduleCallback,st=e.unstable_cancelCallback,pt=e.unstable_shouldYield,Ze=e.unstable_requestPaint,Je=e.unstable_now,qt=e.unstable_getCurrentPriorityLevel,zn=e.unstable_ImmediatePriority,Kn=e.unstable_UserBlockingPriority,yr=e.unstable_NormalPriority,Ka=e.unstable_LowPriority,xa=e.unstable_IdlePriority,qs=null,zr=null;function Sc(u){if(zr&&typeof zr.onCommitFiberRoot=="function")try{zr.onCommitFiberRoot(qs,u,void 0,(u.current.flags&128)===128)}catch{}}var Rr=Math.clz32?Math.clz32:eh,ko=Math.log,_a=Math.LN2;function eh(u){return u>>>=0,u===0?32:31-(ko(u)/_a|0)|0}var Io=64,bc=4194304;function On(u){switch(u&-u){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return u&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return u}}function wl(u,d){var p=u.pendingLanes;if(p===0)return 0;var E=0,S=u.suspendedLanes,I=u.pingedLanes,U=p&268435455;if(U!==0){var se=U&~S;se!==0?E=On(se):(I&=U,I!==0&&(E=On(I)))}else U=p&~S,U!==0?E=On(U):I!==0&&(E=On(I));if(E===0)return 0;if(d!==0&&d!==E&&(d&S)===0&&(S=E&-E,I=d&-d,S>=I||S===16&&(I&4194240)!==0))return d;if((E&4)!==0&&(E|=p&16),d=u.entangledLanes,d!==0)for(u=u.entanglements,d&=E;0<d;)p=31-Rr(d),S=1<<p,E|=u[p],d&=~S;return E}function th(u,d){switch(u){case 1:case 2:case 4:return d+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function nh(u,d){for(var p=u.suspendedLanes,E=u.pingedLanes,S=u.expirationTimes,I=u.pendingLanes;0<I;){var U=31-Rr(I),se=1<<U,ae=S[U];ae===-1?((se&p)===0||(se&E)!==0)&&(S[U]=th(se,d)):ae<=d&&(u.expiredLanes|=se),I&=~se}}function bg(u){return u=u.pendingLanes&-1073741825,u!==0?u:u&1073741824?1073741824:0}function Tg(){var u=Io;return Io<<=1,(Io&4194240)===0&&(Io=64),u}function Rg(u){for(var d=[],p=0;31>p;p++)d.push(u);return d}function rh(u,d,p){u.pendingLanes|=d,d!==536870912&&(u.suspendedLanes=0,u.pingedLanes=0),u=u.eventTimes,d=31-Rr(d),u[d]=p}function UE(u,d){var p=u.pendingLanes&~d;u.pendingLanes=d,u.suspendedLanes=0,u.pingedLanes=0,u.expiredLanes&=d,u.mutableReadLanes&=d,u.entangledLanes&=d,d=u.entanglements;var E=u.eventTimes;for(u=u.expirationTimes;0<p;){var S=31-Rr(p),I=1<<S;d[S]=0,E[S]=-1,u[S]=-1,p&=~I}}function Ag(u,d){var p=u.entangledLanes|=d;for(u=u.entanglements;p;){var E=31-Rr(p),S=1<<E;S&d|u[E]&d&&(u[E]|=d),p&=~S}}var En=0;function Co(u){return u&=-u,1<u?4<u?(u&268435455)!==0?16:536870912:4:1}var kg,Wd,Ig,Cg,Pg,Po=!1,Hd=[],No=null,Mo=null,Ni=null,ih=new Map,El=new Map,Ys=[],uy="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Tc(u,d){switch(u){case"focusin":case"focusout":No=null;break;case"dragenter":case"dragleave":Mo=null;break;case"mouseover":case"mouseout":Ni=null;break;case"pointerover":case"pointerout":ih.delete(d.pointerId);break;case"gotpointercapture":case"lostpointercapture":El.delete(d.pointerId)}}function Xa(u,d,p,E,S,I){return u===null||u.nativeEvent!==I?(u={blockedOn:d,domEventName:p,eventSystemFlags:E,nativeEvent:I,targetContainers:[S]},d!==null&&(d=Wg(d),d!==null&&Wd(d)),u):(u.eventSystemFlags|=E,d=u.targetContainers,S!==null&&d.indexOf(S)===-1&&d.push(S),u)}function hy(u,d,p,E,S){switch(d){case"focusin":return No=Xa(No,u,d,p,E,S),!0;case"dragenter":return Mo=Xa(Mo,u,d,p,E,S),!0;case"mouseover":return Ni=Xa(Ni,u,d,p,E,S),!0;case"pointerover":var I=S.pointerId;return ih.set(I,Xa(ih.get(I)||null,u,d,p,E,S)),!0;case"gotpointercapture":return I=S.pointerId,El.set(I,Xa(El.get(I)||null,u,d,p,E,S)),!0}return!1}function Kd(u){var d=lh(u.target);if(d!==null){var p=ee(d);if(p!==null){if(d=p.tag,d===13){if(d=Ee(p),d!==null){u.blockedOn=d,Pg(u.priority,function(){Ig(p)});return}}else if(d===3&&p.stateNode.current.memoizedState.isDehydrated){u.blockedOn=p.tag===3?p.stateNode.containerInfo:null;return}}}u.blockedOn=null}function ar(u){if(u.blockedOn!==null)return!1;for(var d=u.targetContainers;0<d.length;){var p=Xd(u.domEventName,u.eventSystemFlags,d[0],u.nativeEvent);if(p===null){p=u.nativeEvent;var E=new p.constructor(p.type,p);xe=E,p.target.dispatchEvent(E),xe=null}else return d=Wg(p),d!==null&&Wd(d),u.blockedOn=p,!1;d.shift()}return!0}function dy(u,d,p){ar(u)&&p.delete(d)}function $E(){Po=!1,No!==null&&ar(No)&&(No=null),Mo!==null&&ar(Mo)&&(Mo=null),Ni!==null&&ar(Ni)&&(Ni=null),ih.forEach(dy),El.forEach(dy)}function Rc(u,d){u.blockedOn===d&&(u.blockedOn=null,Po||(Po=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,$E)))}function Ac(u){function d(S){return Rc(S,u)}if(0<Hd.length){Rc(Hd[0],u);for(var p=1;p<Hd.length;p++){var E=Hd[p];E.blockedOn===u&&(E.blockedOn=null)}}for(No!==null&&Rc(No,u),Mo!==null&&Rc(Mo,u),Ni!==null&&Rc(Ni,u),ih.forEach(d),El.forEach(d),p=0;p<Ys.length;p++)E=Ys[p],E.blockedOn===u&&(E.blockedOn=null);for(;0<Ys.length&&(p=Ys[0],p.blockedOn===null);)Kd(p),p.blockedOn===null&&Ys.shift()}var Sl=L.ReactCurrentBatchConfig,bl=!0;function Lo(u,d,p,E){var S=En,I=Sl.transition;Sl.transition=null;try{En=1,Ng(u,d,p,E)}finally{En=S,Sl.transition=I}}function fy(u,d,p,E){var S=En,I=Sl.transition;Sl.transition=null;try{En=4,Ng(u,d,p,E)}finally{En=S,Sl.transition=I}}function Ng(u,d,p,E){if(bl){var S=Xd(u,d,p,E);if(S===null)t2(u,d,E,Oo,p),Tc(u,E);else if(hy(S,u,d,p,E))E.stopPropagation();else if(Tc(u,E),d&4&&-1<uy.indexOf(u)){for(;S!==null;){var I=Wg(S);if(I!==null&&kg(I),I=Xd(u,d,p,E),I===null&&t2(u,d,E,Oo,p),I===S)break;S=I}S!==null&&E.stopPropagation()}else t2(u,d,E,null,p)}}var Oo=null;function Xd(u,d,p,E){if(Oo=null,u=_e(E),u=lh(u),u!==null)if(d=ee(u),d===null)u=null;else if(p=d.tag,p===13){if(u=Ee(d),u!==null)return u;u=null}else if(p===3){if(d.stateNode.current.memoizedState.isDehydrated)return d.tag===3?d.stateNode.containerInfo:null;u=null}else d!==u&&(u=null);return Oo=u,null}function qd(u){switch(u){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(qt()){case zn:return 1;case Kn:return 4;case yr:case Ka:return 16;case xa:return 536870912;default:return 16}default:return 16}}var Zs=null,Yd=null,Tl=null;function gy(){if(Tl)return Tl;var u,d=Yd,p=d.length,E,S="value"in Zs?Zs.value:Zs.textContent,I=S.length;for(u=0;u<p&&d[u]===S[u];u++);var U=p-u;for(E=1;E<=U&&d[p-E]===S[I-E];E++);return Tl=S.slice(u,1<E?1-E:void 0)}function sh(u){var d=u.keyCode;return"charCode"in u?(u=u.charCode,u===0&&d===13&&(u=13)):u=d,u===10&&(u=13),32<=u||u===13?u:0}function Do(){return!0}function Mg(){return!1}function Zi(u){function d(p,E,S,I,U){this._reactName=p,this._targetInst=S,this.type=E,this.nativeEvent=I,this.target=U,this.currentTarget=null;for(var se in u)u.hasOwnProperty(se)&&(p=u[se],this[se]=p?p(I):I[se]);return this.isDefaultPrevented=(I.defaultPrevented!=null?I.defaultPrevented:I.returnValue===!1)?Do:Mg,this.isPropagationStopped=Mg,this}return be(d.prototype,{preventDefault:function(){this.defaultPrevented=!0;var p=this.nativeEvent;p&&(p.preventDefault?p.preventDefault():typeof p.returnValue!="unknown"&&(p.returnValue=!1),this.isDefaultPrevented=Do)},stopPropagation:function(){var p=this.nativeEvent;p&&(p.stopPropagation?p.stopPropagation():typeof p.cancelBubble!="unknown"&&(p.cancelBubble=!0),this.isPropagationStopped=Do)},persist:function(){},isPersistent:Do}),d}var jo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(u){return u.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ah=Zi(jo),kc=be({},jo,{view:0,detail:0}),Zd=Zi(kc),Jd,Qd,Js,oh=be({},kc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:sn,button:0,buttons:0,relatedTarget:function(u){return u.relatedTarget===void 0?u.fromElement===u.srcElement?u.toElement:u.fromElement:u.relatedTarget},movementX:function(u){return"movementX"in u?u.movementX:(u!==Js&&(Js&&u.type==="mousemove"?(Jd=u.screenX-Js.screenX,Qd=u.screenY-Js.screenY):Qd=Jd=0,Js=u),Jd)},movementY:function(u){return"movementY"in u?u.movementY:Qd}}),Lg=Zi(oh),my=be({},oh,{dataTransfer:0}),py=Zi(my),ef=be({},kc,{relatedTarget:0}),Mi=Zi(ef),yy=be({},jo,{animationName:0,elapsedTime:0,pseudoElement:0}),xy=Zi(yy),Ic=be({},jo,{clipboardData:function(u){return"clipboardData"in u?u.clipboardData:window.clipboardData}}),v=Zi(Ic),C=be({},jo,{data:0}),F=Zi(C),K={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ge={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ie={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function lt(u){var d=this.nativeEvent;return d.getModifierState?d.getModifierState(u):(u=Ie[u])?!!d[u]:!1}function sn(){return lt}var Ur=be({},kc,{key:function(u){if(u.key){var d=K[u.key]||u.key;if(d!=="Unidentified")return d}return u.type==="keypress"?(u=sh(u),u===13?"Enter":String.fromCharCode(u)):u.type==="keydown"||u.type==="keyup"?ge[u.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:sn,charCode:function(u){return u.type==="keypress"?sh(u):0},keyCode:function(u){return u.type==="keydown"||u.type==="keyup"?u.keyCode:0},which:function(u){return u.type==="keypress"?sh(u):u.type==="keydown"||u.type==="keyup"?u.keyCode:0}}),Xn=Zi(Ur),qr=be({},oh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Qs=Zi(qr),Rl=be({},kc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:sn}),Fo=Zi(Rl),Vo=be({},jo,{propertyName:0,elapsedTime:0,pseudoElement:0}),tf=Zi(Vo),Og=be({},oh,{deltaX:function(u){return"deltaX"in u?u.deltaX:"wheelDeltaX"in u?-u.wheelDeltaX:0},deltaY:function(u){return"deltaY"in u?u.deltaY:"wheelDeltaY"in u?-u.wheelDeltaY:"wheelDelta"in u?-u.wheelDelta:0},deltaZ:0,deltaMode:0}),gz=Zi(Og),mz=[9,13,27,32],WE=o&&"CompositionEvent"in window,Dg=null;o&&"documentMode"in document&&(Dg=document.documentMode);var pz=o&&"TextEvent"in window&&!Dg,IC=o&&(!WE||Dg&&8<Dg&&11>=Dg),CC=" ",PC=!1;function NC(u,d){switch(u){case"keyup":return mz.indexOf(d.keyCode)!==-1;case"keydown":return d.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function MC(u){return u=u.detail,typeof u=="object"&&"data"in u?u.data:null}var nf=!1;function yz(u,d){switch(u){case"compositionend":return MC(d);case"keypress":return d.which!==32?null:(PC=!0,CC);case"textInput":return u=d.data,u===CC&&PC?null:u;default:return null}}function xz(u,d){if(nf)return u==="compositionend"||!WE&&NC(u,d)?(u=gy(),Tl=Yd=Zs=null,nf=!1,u):null;switch(u){case"paste":return null;case"keypress":if(!(d.ctrlKey||d.altKey||d.metaKey)||d.ctrlKey&&d.altKey){if(d.char&&1<d.char.length)return d.char;if(d.which)return String.fromCharCode(d.which)}return null;case"compositionend":return IC&&d.locale!=="ko"?null:d.data;default:return null}}var _z={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function LC(u){var d=u&&u.nodeName&&u.nodeName.toLowerCase();return d==="input"?!!_z[u.type]:d==="textarea"}function OC(u,d,p,E){ne(E),d=Sy(d,"onChange"),0<d.length&&(p=new ah("onChange","change",null,p,E),u.push({event:p,listeners:d}))}var jg=null,Fg=null;function vz(u){QC(u,0)}function _y(u){var d=lf(u);if(Ve(d))return u}function wz(u,d){if(u==="change")return d}var DC=!1;if(o){var HE;if(o){var KE="oninput"in document;if(!KE){var jC=document.createElement("div");jC.setAttribute("oninput","return;"),KE=typeof jC.oninput=="function"}HE=KE}else HE=!1;DC=HE&&(!document.documentMode||9<document.documentMode)}function FC(){jg&&(jg.detachEvent("onpropertychange",VC),Fg=jg=null)}function VC(u){if(u.propertyName==="value"&&_y(Fg)){var d=[];OC(d,Fg,u,_e(u)),ze(vz,d)}}function Ez(u,d,p){u==="focusin"?(FC(),jg=d,Fg=p,jg.attachEvent("onpropertychange",VC)):u==="focusout"&&FC()}function Sz(u){if(u==="selectionchange"||u==="keyup"||u==="keydown")return _y(Fg)}function bz(u,d){if(u==="click")return _y(d)}function Tz(u,d){if(u==="input"||u==="change")return _y(d)}function Rz(u,d){return u===d&&(u!==0||1/u===1/d)||u!==u&&d!==d}var qa=typeof Object.is=="function"?Object.is:Rz;function Vg(u,d){if(qa(u,d))return!0;if(typeof u!="object"||u===null||typeof d!="object"||d===null)return!1;var p=Object.keys(u),E=Object.keys(d);if(p.length!==E.length)return!1;for(E=0;E<p.length;E++){var S=p[E];if(!l.call(d,S)||!qa(u[S],d[S]))return!1}return!0}function BC(u){for(;u&&u.firstChild;)u=u.firstChild;return u}function GC(u,d){var p=BC(u);u=0;for(var E;p;){if(p.nodeType===3){if(E=u+p.textContent.length,u<=d&&E>=d)return{node:p,offset:d-u};u=E}e:{for(;p;){if(p.nextSibling){p=p.nextSibling;break e}p=p.parentNode}p=void 0}p=BC(p)}}function zC(u,d){return u&&d?u===d?!0:u&&u.nodeType===3?!1:d&&d.nodeType===3?zC(u,d.parentNode):"contains"in u?u.contains(d):u.compareDocumentPosition?!!(u.compareDocumentPosition(d)&16):!1:!1}function UC(){for(var u=window,d=jt();d instanceof u.HTMLIFrameElement;){try{var p=typeof d.contentWindow.location.href=="string"}catch{p=!1}if(p)u=d.contentWindow;else break;d=jt(u.document)}return d}function XE(u){var d=u&&u.nodeName&&u.nodeName.toLowerCase();return d&&(d==="input"&&(u.type==="text"||u.type==="search"||u.type==="tel"||u.type==="url"||u.type==="password")||d==="textarea"||u.contentEditable==="true")}function Az(u){var d=UC(),p=u.focusedElem,E=u.selectionRange;if(d!==p&&p&&p.ownerDocument&&zC(p.ownerDocument.documentElement,p)){if(E!==null&&XE(p)){if(d=E.start,u=E.end,u===void 0&&(u=d),"selectionStart"in p)p.selectionStart=d,p.selectionEnd=Math.min(u,p.value.length);else if(u=(d=p.ownerDocument||document)&&d.defaultView||window,u.getSelection){u=u.getSelection();var S=p.textContent.length,I=Math.min(E.start,S);E=E.end===void 0?I:Math.min(E.end,S),!u.extend&&I>E&&(S=E,E=I,I=S),S=GC(p,I);var U=GC(p,E);S&&U&&(u.rangeCount!==1||u.anchorNode!==S.node||u.anchorOffset!==S.offset||u.focusNode!==U.node||u.focusOffset!==U.offset)&&(d=d.createRange(),d.setStart(S.node,S.offset),u.removeAllRanges(),I>E?(u.addRange(d),u.extend(U.node,U.offset)):(d.setEnd(U.node,U.offset),u.addRange(d)))}}for(d=[],u=p;u=u.parentNode;)u.nodeType===1&&d.push({element:u,left:u.scrollLeft,top:u.scrollTop});for(typeof p.focus=="function"&&p.focus(),p=0;p<d.length;p++)u=d[p],u.element.scrollLeft=u.left,u.element.scrollTop=u.top}}var kz=o&&"documentMode"in document&&11>=document.documentMode,rf=null,qE=null,Bg=null,YE=!1;function $C(u,d,p){var E=p.window===p?p.document:p.nodeType===9?p:p.ownerDocument;YE||rf==null||rf!==jt(E)||(E=rf,"selectionStart"in E&&XE(E)?E={start:E.selectionStart,end:E.selectionEnd}:(E=(E.ownerDocument&&E.ownerDocument.defaultView||window).getSelection(),E={anchorNode:E.anchorNode,anchorOffset:E.anchorOffset,focusNode:E.focusNode,focusOffset:E.focusOffset}),Bg&&Vg(Bg,E)||(Bg=E,E=Sy(qE,"onSelect"),0<E.length&&(d=new ah("onSelect","select",null,d,p),u.push({event:d,listeners:E}),d.target=rf)))}function vy(u,d){var p={};return p[u.toLowerCase()]=d.toLowerCase(),p["Webkit"+u]="webkit"+d,p["Moz"+u]="moz"+d,p}var sf={animationend:vy("Animation","AnimationEnd"),animationiteration:vy("Animation","AnimationIteration"),animationstart:vy("Animation","AnimationStart"),transitionend:vy("Transition","TransitionEnd")},ZE={},WC={};o&&(WC=document.createElement("div").style,"AnimationEvent"in window||(delete sf.animationend.animation,delete sf.animationiteration.animation,delete sf.animationstart.animation),"TransitionEvent"in window||delete sf.transitionend.transition);function wy(u){if(ZE[u])return ZE[u];if(!sf[u])return u;var d=sf[u],p;for(p in d)if(d.hasOwnProperty(p)&&p in WC)return ZE[u]=d[p];return u}var HC=wy("animationend"),KC=wy("animationiteration"),XC=wy("animationstart"),qC=wy("transitionend"),YC=new Map,ZC="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Cc(u,d){YC.set(u,d),s(d,[u])}for(var JE=0;JE<ZC.length;JE++){var QE=ZC[JE],Iz=QE.toLowerCase(),Cz=QE[0].toUpperCase()+QE.slice(1);Cc(Iz,"on"+Cz)}Cc(HC,"onAnimationEnd"),Cc(KC,"onAnimationIteration"),Cc(XC,"onAnimationStart"),Cc("dblclick","onDoubleClick"),Cc("focusin","onFocus"),Cc("focusout","onBlur"),Cc(qC,"onTransitionEnd"),a("onMouseEnter",["mouseout","mouseover"]),a("onMouseLeave",["mouseout","mouseover"]),a("onPointerEnter",["pointerout","pointerover"]),a("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Gg="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Pz=new Set("cancel close invalid load scroll toggle".split(" ").concat(Gg));function JC(u,d,p){var E=u.type||"unknown-event";u.currentTarget=p,Q(E,d,void 0,u),u.currentTarget=null}function QC(u,d){d=(d&4)!==0;for(var p=0;p<u.length;p++){var E=u[p],S=E.event;E=E.listeners;e:{var I=void 0;if(d)for(var U=E.length-1;0<=U;U--){var se=E[U],ae=se.instance,ke=se.currentTarget;if(se=se.listener,ae!==I&&S.isPropagationStopped())break e;JC(S,se,ke),I=ae}else for(U=0;U<E.length;U++){if(se=E[U],ae=se.instance,ke=se.currentTarget,se=se.listener,ae!==I&&S.isPropagationStopped())break e;JC(S,se,ke),I=ae}}}if(z)throw u=Z,z=!1,Z=null,u}function dr(u,d){var p=d[o2];p===void 0&&(p=d[o2]=new Set);var E=u+"__bubble";p.has(E)||(eP(d,u,2,!1),p.add(E))}function e2(u,d,p){var E=0;d&&(E|=4),eP(p,u,E,d)}var Ey="_reactListening"+Math.random().toString(36).slice(2);function zg(u){if(!u[Ey]){u[Ey]=!0,r.forEach(function(p){p!=="selectionchange"&&(Pz.has(p)||e2(p,!1,u),e2(p,!0,u))});var d=u.nodeType===9?u:u.ownerDocument;d===null||d[Ey]||(d[Ey]=!0,e2("selectionchange",!1,d))}}function eP(u,d,p,E){switch(qd(d)){case 1:var S=Lo;break;case 4:S=fy;break;default:S=Ng}p=S.bind(null,d,p,u),S=void 0,!He||d!=="touchstart"&&d!=="touchmove"&&d!=="wheel"||(S=!0),E?S!==void 0?u.addEventListener(d,p,{capture:!0,passive:S}):u.addEventListener(d,p,!0):S!==void 0?u.addEventListener(d,p,{passive:S}):u.addEventListener(d,p,!1)}function t2(u,d,p,E,S){var I=E;if((d&1)===0&&(d&2)===0&&E!==null)e:for(;;){if(E===null)return;var U=E.tag;if(U===3||U===4){var se=E.stateNode.containerInfo;if(se===S||se.nodeType===8&&se.parentNode===S)break;if(U===4)for(U=E.return;U!==null;){var ae=U.tag;if((ae===3||ae===4)&&(ae=U.stateNode.containerInfo,ae===S||ae.nodeType===8&&ae.parentNode===S))return;U=U.return}for(;se!==null;){if(U=lh(se),U===null)return;if(ae=U.tag,ae===5||ae===6){E=I=U;continue e}se=se.parentNode}}E=E.return}ze(function(){var ke=I,qe=_e(p),et=[];e:{var Ke=YC.get(u);if(Ke!==void 0){var vt=ah,kt=u;switch(u){case"keypress":if(sh(p)===0)break e;case"keydown":case"keyup":vt=Xn;break;case"focusin":kt="focus",vt=Mi;break;case"focusout":kt="blur",vt=Mi;break;case"beforeblur":case"afterblur":vt=Mi;break;case"click":if(p.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":vt=Lg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":vt=py;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":vt=Fo;break;case HC:case KC:case XC:vt=xy;break;case qC:vt=tf;break;case"scroll":vt=Zd;break;case"wheel":vt=gz;break;case"copy":case"cut":case"paste":vt=v;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":vt=Qs}var Pt=(d&4)!==0,$r=!Pt&&u==="scroll",fe=Pt?Ke!==null?Ke+"Capture":null:Ke;Pt=[];for(var oe=ke,Se;oe!==null;){Se=oe;var it=Se.stateNode;if(Se.tag===5&&it!==null&&(Se=it,fe!==null&&(it=Me(oe,fe),it!=null&&Pt.push(Ug(oe,it,Se)))),$r)break;oe=oe.return}0<Pt.length&&(Ke=new vt(Ke,kt,null,p,qe),et.push({event:Ke,listeners:Pt}))}}if((d&7)===0){e:{if(Ke=u==="mouseover"||u==="pointerover",vt=u==="mouseout"||u==="pointerout",Ke&&p!==xe&&(kt=p.relatedTarget||p.fromElement)&&(lh(kt)||kt[Al]))break e;if((vt||Ke)&&(Ke=qe.window===qe?qe:(Ke=qe.ownerDocument)?Ke.defaultView||Ke.parentWindow:window,vt?(kt=p.relatedTarget||p.toElement,vt=ke,kt=kt?lh(kt):null,kt!==null&&($r=ee(kt),kt!==$r||kt.tag!==5&&kt.tag!==6)&&(kt=null)):(vt=null,kt=ke),vt!==kt)){if(Pt=Lg,it="onMouseLeave",fe="onMouseEnter",oe="mouse",(u==="pointerout"||u==="pointerover")&&(Pt=Qs,it="onPointerLeave",fe="onPointerEnter",oe="pointer"),$r=vt==null?Ke:lf(vt),Se=kt==null?Ke:lf(kt),Ke=new Pt(it,oe+"leave",vt,p,qe),Ke.target=$r,Ke.relatedTarget=Se,it=null,lh(qe)===ke&&(Pt=new Pt(fe,oe+"enter",kt,p,qe),Pt.target=Se,Pt.relatedTarget=$r,it=Pt),$r=it,vt&&kt)t:{for(Pt=vt,fe=kt,oe=0,Se=Pt;Se;Se=af(Se))oe++;for(Se=0,it=fe;it;it=af(it))Se++;for(;0<oe-Se;)Pt=af(Pt),oe--;for(;0<Se-oe;)fe=af(fe),Se--;for(;oe--;){if(Pt===fe||fe!==null&&Pt===fe.alternate)break t;Pt=af(Pt),fe=af(fe)}Pt=null}else Pt=null;vt!==null&&tP(et,Ke,vt,Pt,!1),kt!==null&&$r!==null&&tP(et,$r,kt,Pt,!0)}}e:{if(Ke=ke?lf(ke):window,vt=Ke.nodeName&&Ke.nodeName.toLowerCase(),vt==="select"||vt==="input"&&Ke.type==="file")var Mt=wz;else if(LC(Ke))if(DC)Mt=Tz;else{Mt=Sz;var Gt=Ez}else(vt=Ke.nodeName)&&vt.toLowerCase()==="input"&&(Ke.type==="checkbox"||Ke.type==="radio")&&(Mt=bz);if(Mt&&(Mt=Mt(u,ke))){OC(et,Mt,p,qe);break e}Gt&&Gt(u,Ke,ke),u==="focusout"&&(Gt=Ke._wrapperState)&&Gt.controlled&&Ke.type==="number"&&ln(Ke,"number",Ke.value)}switch(Gt=ke?lf(ke):window,u){case"focusin":(LC(Gt)||Gt.contentEditable==="true")&&(rf=Gt,qE=ke,Bg=null);break;case"focusout":Bg=qE=rf=null;break;case"mousedown":YE=!0;break;case"contextmenu":case"mouseup":case"dragend":YE=!1,$C(et,p,qe);break;case"selectionchange":if(kz)break;case"keydown":case"keyup":$C(et,p,qe)}var zt;if(WE)e:{switch(u){case"compositionstart":var Yt="onCompositionStart";break e;case"compositionend":Yt="onCompositionEnd";break e;case"compositionupdate":Yt="onCompositionUpdate";break e}Yt=void 0}else nf?NC(u,p)&&(Yt="onCompositionEnd"):u==="keydown"&&p.keyCode===229&&(Yt="onCompositionStart");Yt&&(IC&&p.locale!=="ko"&&(nf||Yt!=="onCompositionStart"?Yt==="onCompositionEnd"&&nf&&(zt=gy()):(Zs=qe,Yd="value"in Zs?Zs.value:Zs.textContent,nf=!0)),Gt=Sy(ke,Yt),0<Gt.length&&(Yt=new F(Yt,u,null,p,qe),et.push({event:Yt,listeners:Gt}),zt?Yt.data=zt:(zt=MC(p),zt!==null&&(Yt.data=zt)))),(zt=pz?yz(u,p):xz(u,p))&&(ke=Sy(ke,"onBeforeInput"),0<ke.length&&(qe=new F("onBeforeInput","beforeinput",null,p,qe),et.push({event:qe,listeners:ke}),qe.data=zt))}QC(et,d)})}function Ug(u,d,p){return{instance:u,listener:d,currentTarget:p}}function Sy(u,d){for(var p=d+"Capture",E=[];u!==null;){var S=u,I=S.stateNode;S.tag===5&&I!==null&&(S=I,I=Me(u,p),I!=null&&E.unshift(Ug(u,I,S)),I=Me(u,d),I!=null&&E.push(Ug(u,I,S))),u=u.return}return E}function af(u){if(u===null)return null;do u=u.return;while(u&&u.tag!==5);return u||null}function tP(u,d,p,E,S){for(var I=d._reactName,U=[];p!==null&&p!==E;){var se=p,ae=se.alternate,ke=se.stateNode;if(ae!==null&&ae===E)break;se.tag===5&&ke!==null&&(se=ke,S?(ae=Me(p,I),ae!=null&&U.unshift(Ug(p,ae,se))):S||(ae=Me(p,I),ae!=null&&U.push(Ug(p,ae,se)))),p=p.return}U.length!==0&&u.push({event:d,listeners:U})}var Nz=/\r\n?/g,Mz=/\u0000|\uFFFD/g;function nP(u){return(typeof u=="string"?u:""+u).replace(Nz,`
`).replace(Mz,"")}function by(u,d,p){if(d=nP(d),nP(u)!==d&&p)throw Error(t(425))}function Ty(){}var n2=null,r2=null;function i2(u,d){return u==="textarea"||u==="noscript"||typeof d.children=="string"||typeof d.children=="number"||typeof d.dangerouslySetInnerHTML=="object"&&d.dangerouslySetInnerHTML!==null&&d.dangerouslySetInnerHTML.__html!=null}var s2=typeof setTimeout=="function"?setTimeout:void 0,Lz=typeof clearTimeout=="function"?clearTimeout:void 0,rP=typeof Promise=="function"?Promise:void 0,Oz=typeof queueMicrotask=="function"?queueMicrotask:typeof rP<"u"?function(u){return rP.resolve(null).then(u).catch(Dz)}:s2;function Dz(u){setTimeout(function(){throw u})}function a2(u,d){var p=d,E=0;do{var S=p.nextSibling;if(u.removeChild(p),S&&S.nodeType===8)if(p=S.data,p==="/$"){if(E===0){u.removeChild(S),Ac(d);return}E--}else p!=="$"&&p!=="$?"&&p!=="$!"||E++;p=S}while(p);Ac(d)}function Pc(u){for(;u!=null;u=u.nextSibling){var d=u.nodeType;if(d===1||d===3)break;if(d===8){if(d=u.data,d==="$"||d==="$!"||d==="$?")break;if(d==="/$")return null}}return u}function iP(u){u=u.previousSibling;for(var d=0;u;){if(u.nodeType===8){var p=u.data;if(p==="$"||p==="$!"||p==="$?"){if(d===0)return u;d--}else p==="/$"&&d++}u=u.previousSibling}return null}var of=Math.random().toString(36).slice(2),Bo="__reactFiber$"+of,$g="__reactProps$"+of,Al="__reactContainer$"+of,o2="__reactEvents$"+of,jz="__reactListeners$"+of,Fz="__reactHandles$"+of;function lh(u){var d=u[Bo];if(d)return d;for(var p=u.parentNode;p;){if(d=p[Al]||p[Bo]){if(p=d.alternate,d.child!==null||p!==null&&p.child!==null)for(u=iP(u);u!==null;){if(p=u[Bo])return p;u=iP(u)}return d}u=p,p=u.parentNode}return null}function Wg(u){return u=u[Bo]||u[Al],!u||u.tag!==5&&u.tag!==6&&u.tag!==13&&u.tag!==3?null:u}function lf(u){if(u.tag===5||u.tag===6)return u.stateNode;throw Error(t(33))}function Ry(u){return u[$g]||null}var l2=[],cf=-1;function Nc(u){return{current:u}}function fr(u){0>cf||(u.current=l2[cf],l2[cf]=null,cf--)}function cr(u,d){cf++,l2[cf]=u.current,u.current=d}var Mc={},Ji=Nc(Mc),Rs=Nc(!1),ch=Mc;function uf(u,d){var p=u.type.contextTypes;if(!p)return Mc;var E=u.stateNode;if(E&&E.__reactInternalMemoizedUnmaskedChildContext===d)return E.__reactInternalMemoizedMaskedChildContext;var S={},I;for(I in p)S[I]=d[I];return E&&(u=u.stateNode,u.__reactInternalMemoizedUnmaskedChildContext=d,u.__reactInternalMemoizedMaskedChildContext=S),S}function As(u){return u=u.childContextTypes,u!=null}function Ay(){fr(Rs),fr(Ji)}function sP(u,d,p){if(Ji.current!==Mc)throw Error(t(168));cr(Ji,d),cr(Rs,p)}function aP(u,d,p){var E=u.stateNode;if(d=d.childContextTypes,typeof E.getChildContext!="function")return p;E=E.getChildContext();for(var S in E)if(!(S in d))throw Error(t(108,Be(u)||"Unknown",S));return be({},p,E)}function ky(u){return u=(u=u.stateNode)&&u.__reactInternalMemoizedMergedChildContext||Mc,ch=Ji.current,cr(Ji,u),cr(Rs,Rs.current),!0}function oP(u,d,p){var E=u.stateNode;if(!E)throw Error(t(169));p?(u=aP(u,d,ch),E.__reactInternalMemoizedMergedChildContext=u,fr(Rs),fr(Ji),cr(Ji,u)):fr(Rs),cr(Rs,p)}var kl=null,Iy=!1,c2=!1;function lP(u){kl===null?kl=[u]:kl.push(u)}function Vz(u){Iy=!0,lP(u)}function Lc(){if(!c2&&kl!==null){c2=!0;var u=0,d=En;try{var p=kl;for(En=1;u<p.length;u++){var E=p[u];do E=E(!0);while(E!==null)}kl=null,Iy=!1}catch(S){throw kl!==null&&(kl=kl.slice(u+1)),Ye(zn,Lc),S}finally{En=d,c2=!1}}return null}var hf=[],df=0,Cy=null,Py=0,va=[],wa=0,uh=null,Il=1,Cl="";function hh(u,d){hf[df++]=Py,hf[df++]=Cy,Cy=u,Py=d}function cP(u,d,p){va[wa++]=Il,va[wa++]=Cl,va[wa++]=uh,uh=u;var E=Il;u=Cl;var S=32-Rr(E)-1;E&=~(1<<S),p+=1;var I=32-Rr(d)+S;if(30<I){var U=S-S%5;I=(E&(1<<U)-1).toString(32),E>>=U,S-=U,Il=1<<32-Rr(d)+S|p<<S|E,Cl=I+u}else Il=1<<I|p<<S|E,Cl=u}function u2(u){u.return!==null&&(hh(u,1),cP(u,1,0))}function h2(u){for(;u===Cy;)Cy=hf[--df],hf[df]=null,Py=hf[--df],hf[df]=null;for(;u===uh;)uh=va[--wa],va[wa]=null,Cl=va[--wa],va[wa]=null,Il=va[--wa],va[wa]=null}var ea=null,ta=null,xr=!1,Ya=null;function uP(u,d){var p=Ta(5,null,null,0);p.elementType="DELETED",p.stateNode=d,p.return=u,d=u.deletions,d===null?(u.deletions=[p],u.flags|=16):d.push(p)}function hP(u,d){switch(u.tag){case 5:var p=u.type;return d=d.nodeType!==1||p.toLowerCase()!==d.nodeName.toLowerCase()?null:d,d!==null?(u.stateNode=d,ea=u,ta=Pc(d.firstChild),!0):!1;case 6:return d=u.pendingProps===""||d.nodeType!==3?null:d,d!==null?(u.stateNode=d,ea=u,ta=null,!0):!1;case 13:return d=d.nodeType!==8?null:d,d!==null?(p=uh!==null?{id:Il,overflow:Cl}:null,u.memoizedState={dehydrated:d,treeContext:p,retryLane:1073741824},p=Ta(18,null,null,0),p.stateNode=d,p.return=u,u.child=p,ea=u,ta=null,!0):!1;default:return!1}}function d2(u){return(u.mode&1)!==0&&(u.flags&128)===0}function f2(u){if(xr){var d=ta;if(d){var p=d;if(!hP(u,d)){if(d2(u))throw Error(t(418));d=Pc(p.nextSibling);var E=ea;d&&hP(u,d)?uP(E,p):(u.flags=u.flags&-4097|2,xr=!1,ea=u)}}else{if(d2(u))throw Error(t(418));u.flags=u.flags&-4097|2,xr=!1,ea=u}}}function dP(u){for(u=u.return;u!==null&&u.tag!==5&&u.tag!==3&&u.tag!==13;)u=u.return;ea=u}function Ny(u){if(u!==ea)return!1;if(!xr)return dP(u),xr=!0,!1;var d;if((d=u.tag!==3)&&!(d=u.tag!==5)&&(d=u.type,d=d!=="head"&&d!=="body"&&!i2(u.type,u.memoizedProps)),d&&(d=ta)){if(d2(u))throw fP(),Error(t(418));for(;d;)uP(u,d),d=Pc(d.nextSibling)}if(dP(u),u.tag===13){if(u=u.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(t(317));e:{for(u=u.nextSibling,d=0;u;){if(u.nodeType===8){var p=u.data;if(p==="/$"){if(d===0){ta=Pc(u.nextSibling);break e}d--}else p!=="$"&&p!=="$!"&&p!=="$?"||d++}u=u.nextSibling}ta=null}}else ta=ea?Pc(u.stateNode.nextSibling):null;return!0}function fP(){for(var u=ta;u;)u=Pc(u.nextSibling)}function ff(){ta=ea=null,xr=!1}function g2(u){Ya===null?Ya=[u]:Ya.push(u)}var Bz=L.ReactCurrentBatchConfig;function Hg(u,d,p){if(u=p.ref,u!==null&&typeof u!="function"&&typeof u!="object"){if(p._owner){if(p=p._owner,p){if(p.tag!==1)throw Error(t(309));var E=p.stateNode}if(!E)throw Error(t(147,u));var S=E,I=""+u;return d!==null&&d.ref!==null&&typeof d.ref=="function"&&d.ref._stringRef===I?d.ref:(d=function(U){var se=S.refs;U===null?delete se[I]:se[I]=U},d._stringRef=I,d)}if(typeof u!="string")throw Error(t(284));if(!p._owner)throw Error(t(290,u))}return u}function My(u,d){throw u=Object.prototype.toString.call(d),Error(t(31,u==="[object Object]"?"object with keys {"+Object.keys(d).join(", ")+"}":u))}function gP(u){var d=u._init;return d(u._payload)}function mP(u){function d(fe,oe){if(u){var Se=fe.deletions;Se===null?(fe.deletions=[oe],fe.flags|=16):Se.push(oe)}}function p(fe,oe){if(!u)return null;for(;oe!==null;)d(fe,oe),oe=oe.sibling;return null}function E(fe,oe){for(fe=new Map;oe!==null;)oe.key!==null?fe.set(oe.key,oe):fe.set(oe.index,oe),oe=oe.sibling;return fe}function S(fe,oe){return fe=zc(fe,oe),fe.index=0,fe.sibling=null,fe}function I(fe,oe,Se){return fe.index=Se,u?(Se=fe.alternate,Se!==null?(Se=Se.index,Se<oe?(fe.flags|=2,oe):Se):(fe.flags|=2,oe)):(fe.flags|=1048576,oe)}function U(fe){return u&&fe.alternate===null&&(fe.flags|=2),fe}function se(fe,oe,Se,it){return oe===null||oe.tag!==6?(oe=sS(Se,fe.mode,it),oe.return=fe,oe):(oe=S(oe,Se),oe.return=fe,oe)}function ae(fe,oe,Se,it){var Mt=Se.type;return Mt===R?qe(fe,oe,Se.props.children,it,Se.key):oe!==null&&(oe.elementType===Mt||typeof Mt=="object"&&Mt!==null&&Mt.$$typeof===je&&gP(Mt)===oe.type)?(it=S(oe,Se.props),it.ref=Hg(fe,oe,Se),it.return=fe,it):(it=rx(Se.type,Se.key,Se.props,null,fe.mode,it),it.ref=Hg(fe,oe,Se),it.return=fe,it)}function ke(fe,oe,Se,it){return oe===null||oe.tag!==4||oe.stateNode.containerInfo!==Se.containerInfo||oe.stateNode.implementation!==Se.implementation?(oe=aS(Se,fe.mode,it),oe.return=fe,oe):(oe=S(oe,Se.children||[]),oe.return=fe,oe)}function qe(fe,oe,Se,it,Mt){return oe===null||oe.tag!==7?(oe=_h(Se,fe.mode,it,Mt),oe.return=fe,oe):(oe=S(oe,Se),oe.return=fe,oe)}function et(fe,oe,Se){if(typeof oe=="string"&&oe!==""||typeof oe=="number")return oe=sS(""+oe,fe.mode,Se),oe.return=fe,oe;if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case O:return Se=rx(oe.type,oe.key,oe.props,null,fe.mode,Se),Se.ref=Hg(fe,null,oe),Se.return=fe,Se;case B:return oe=aS(oe,fe.mode,Se),oe.return=fe,oe;case je:var it=oe._init;return et(fe,it(oe._payload),Se)}if(hn(oe)||Ne(oe))return oe=_h(oe,fe.mode,Se,null),oe.return=fe,oe;My(fe,oe)}return null}function Ke(fe,oe,Se,it){var Mt=oe!==null?oe.key:null;if(typeof Se=="string"&&Se!==""||typeof Se=="number")return Mt!==null?null:se(fe,oe,""+Se,it);if(typeof Se=="object"&&Se!==null){switch(Se.$$typeof){case O:return Se.key===Mt?ae(fe,oe,Se,it):null;case B:return Se.key===Mt?ke(fe,oe,Se,it):null;case je:return Mt=Se._init,Ke(fe,oe,Mt(Se._payload),it)}if(hn(Se)||Ne(Se))return Mt!==null?null:qe(fe,oe,Se,it,null);My(fe,Se)}return null}function vt(fe,oe,Se,it,Mt){if(typeof it=="string"&&it!==""||typeof it=="number")return fe=fe.get(Se)||null,se(oe,fe,""+it,Mt);if(typeof it=="object"&&it!==null){switch(it.$$typeof){case O:return fe=fe.get(it.key===null?Se:it.key)||null,ae(oe,fe,it,Mt);case B:return fe=fe.get(it.key===null?Se:it.key)||null,ke(oe,fe,it,Mt);case je:var Gt=it._init;return vt(fe,oe,Se,Gt(it._payload),Mt)}if(hn(it)||Ne(it))return fe=fe.get(Se)||null,qe(oe,fe,it,Mt,null);My(oe,it)}return null}function kt(fe,oe,Se,it){for(var Mt=null,Gt=null,zt=oe,Yt=oe=0,vi=null;zt!==null&&Yt<Se.length;Yt++){zt.index>Yt?(vi=zt,zt=null):vi=zt.sibling;var Pn=Ke(fe,zt,Se[Yt],it);if(Pn===null){zt===null&&(zt=vi);break}u&&zt&&Pn.alternate===null&&d(fe,zt),oe=I(Pn,oe,Yt),Gt===null?Mt=Pn:Gt.sibling=Pn,Gt=Pn,zt=vi}if(Yt===Se.length)return p(fe,zt),xr&&hh(fe,Yt),Mt;if(zt===null){for(;Yt<Se.length;Yt++)zt=et(fe,Se[Yt],it),zt!==null&&(oe=I(zt,oe,Yt),Gt===null?Mt=zt:Gt.sibling=zt,Gt=zt);return xr&&hh(fe,Yt),Mt}for(zt=E(fe,zt);Yt<Se.length;Yt++)vi=vt(zt,fe,Yt,Se[Yt],it),vi!==null&&(u&&vi.alternate!==null&&zt.delete(vi.key===null?Yt:vi.key),oe=I(vi,oe,Yt),Gt===null?Mt=vi:Gt.sibling=vi,Gt=vi);return u&&zt.forEach(function(Uc){return d(fe,Uc)}),xr&&hh(fe,Yt),Mt}function Pt(fe,oe,Se,it){var Mt=Ne(Se);if(typeof Mt!="function")throw Error(t(150));if(Se=Mt.call(Se),Se==null)throw Error(t(151));for(var Gt=Mt=null,zt=oe,Yt=oe=0,vi=null,Pn=Se.next();zt!==null&&!Pn.done;Yt++,Pn=Se.next()){zt.index>Yt?(vi=zt,zt=null):vi=zt.sibling;var Uc=Ke(fe,zt,Pn.value,it);if(Uc===null){zt===null&&(zt=vi);break}u&&zt&&Uc.alternate===null&&d(fe,zt),oe=I(Uc,oe,Yt),Gt===null?Mt=Uc:Gt.sibling=Uc,Gt=Uc,zt=vi}if(Pn.done)return p(fe,zt),xr&&hh(fe,Yt),Mt;if(zt===null){for(;!Pn.done;Yt++,Pn=Se.next())Pn=et(fe,Pn.value,it),Pn!==null&&(oe=I(Pn,oe,Yt),Gt===null?Mt=Pn:Gt.sibling=Pn,Gt=Pn);return xr&&hh(fe,Yt),Mt}for(zt=E(fe,zt);!Pn.done;Yt++,Pn=Se.next())Pn=vt(zt,fe,Yt,Pn.value,it),Pn!==null&&(u&&Pn.alternate!==null&&zt.delete(Pn.key===null?Yt:Pn.key),oe=I(Pn,oe,Yt),Gt===null?Mt=Pn:Gt.sibling=Pn,Gt=Pn);return u&&zt.forEach(function(_U){return d(fe,_U)}),xr&&hh(fe,Yt),Mt}function $r(fe,oe,Se,it){if(typeof Se=="object"&&Se!==null&&Se.type===R&&Se.key===null&&(Se=Se.props.children),typeof Se=="object"&&Se!==null){switch(Se.$$typeof){case O:e:{for(var Mt=Se.key,Gt=oe;Gt!==null;){if(Gt.key===Mt){if(Mt=Se.type,Mt===R){if(Gt.tag===7){p(fe,Gt.sibling),oe=S(Gt,Se.props.children),oe.return=fe,fe=oe;break e}}else if(Gt.elementType===Mt||typeof Mt=="object"&&Mt!==null&&Mt.$$typeof===je&&gP(Mt)===Gt.type){p(fe,Gt.sibling),oe=S(Gt,Se.props),oe.ref=Hg(fe,Gt,Se),oe.return=fe,fe=oe;break e}p(fe,Gt);break}else d(fe,Gt);Gt=Gt.sibling}Se.type===R?(oe=_h(Se.props.children,fe.mode,it,Se.key),oe.return=fe,fe=oe):(it=rx(Se.type,Se.key,Se.props,null,fe.mode,it),it.ref=Hg(fe,oe,Se),it.return=fe,fe=it)}return U(fe);case B:e:{for(Gt=Se.key;oe!==null;){if(oe.key===Gt)if(oe.tag===4&&oe.stateNode.containerInfo===Se.containerInfo&&oe.stateNode.implementation===Se.implementation){p(fe,oe.sibling),oe=S(oe,Se.children||[]),oe.return=fe,fe=oe;break e}else{p(fe,oe);break}else d(fe,oe);oe=oe.sibling}oe=aS(Se,fe.mode,it),oe.return=fe,fe=oe}return U(fe);case je:return Gt=Se._init,$r(fe,oe,Gt(Se._payload),it)}if(hn(Se))return kt(fe,oe,Se,it);if(Ne(Se))return Pt(fe,oe,Se,it);My(fe,Se)}return typeof Se=="string"&&Se!==""||typeof Se=="number"?(Se=""+Se,oe!==null&&oe.tag===6?(p(fe,oe.sibling),oe=S(oe,Se),oe.return=fe,fe=oe):(p(fe,oe),oe=sS(Se,fe.mode,it),oe.return=fe,fe=oe),U(fe)):p(fe,oe)}return $r}var gf=mP(!0),pP=mP(!1),Ly=Nc(null),Oy=null,mf=null,m2=null;function p2(){m2=mf=Oy=null}function y2(u){var d=Ly.current;fr(Ly),u._currentValue=d}function x2(u,d,p){for(;u!==null;){var E=u.alternate;if((u.childLanes&d)!==d?(u.childLanes|=d,E!==null&&(E.childLanes|=d)):E!==null&&(E.childLanes&d)!==d&&(E.childLanes|=d),u===p)break;u=u.return}}function pf(u,d){Oy=u,m2=mf=null,u=u.dependencies,u!==null&&u.firstContext!==null&&((u.lanes&d)!==0&&(ks=!0),u.firstContext=null)}function Ea(u){var d=u._currentValue;if(m2!==u)if(u={context:u,memoizedValue:d,next:null},mf===null){if(Oy===null)throw Error(t(308));mf=u,Oy.dependencies={lanes:0,firstContext:u}}else mf=mf.next=u;return d}var dh=null;function _2(u){dh===null?dh=[u]:dh.push(u)}function yP(u,d,p,E){var S=d.interleaved;return S===null?(p.next=p,_2(d)):(p.next=S.next,S.next=p),d.interleaved=p,Pl(u,E)}function Pl(u,d){u.lanes|=d;var p=u.alternate;for(p!==null&&(p.lanes|=d),p=u,u=u.return;u!==null;)u.childLanes|=d,p=u.alternate,p!==null&&(p.childLanes|=d),p=u,u=u.return;return p.tag===3?p.stateNode:null}var Oc=!1;function v2(u){u.updateQueue={baseState:u.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function xP(u,d){u=u.updateQueue,d.updateQueue===u&&(d.updateQueue={baseState:u.baseState,firstBaseUpdate:u.firstBaseUpdate,lastBaseUpdate:u.lastBaseUpdate,shared:u.shared,effects:u.effects})}function Nl(u,d){return{eventTime:u,lane:d,tag:0,payload:null,callback:null,next:null}}function Dc(u,d,p){var E=u.updateQueue;if(E===null)return null;if(E=E.shared,(Cn&2)!==0){var S=E.pending;return S===null?d.next=d:(d.next=S.next,S.next=d),E.pending=d,Pl(u,p)}return S=E.interleaved,S===null?(d.next=d,_2(E)):(d.next=S.next,S.next=d),E.interleaved=d,Pl(u,p)}function Dy(u,d,p){if(d=d.updateQueue,d!==null&&(d=d.shared,(p&4194240)!==0)){var E=d.lanes;E&=u.pendingLanes,p|=E,d.lanes=p,Ag(u,p)}}function _P(u,d){var p=u.updateQueue,E=u.alternate;if(E!==null&&(E=E.updateQueue,p===E)){var S=null,I=null;if(p=p.firstBaseUpdate,p!==null){do{var U={eventTime:p.eventTime,lane:p.lane,tag:p.tag,payload:p.payload,callback:p.callback,next:null};I===null?S=I=U:I=I.next=U,p=p.next}while(p!==null);I===null?S=I=d:I=I.next=d}else S=I=d;p={baseState:E.baseState,firstBaseUpdate:S,lastBaseUpdate:I,shared:E.shared,effects:E.effects},u.updateQueue=p;return}u=p.lastBaseUpdate,u===null?p.firstBaseUpdate=d:u.next=d,p.lastBaseUpdate=d}function jy(u,d,p,E){var S=u.updateQueue;Oc=!1;var I=S.firstBaseUpdate,U=S.lastBaseUpdate,se=S.shared.pending;if(se!==null){S.shared.pending=null;var ae=se,ke=ae.next;ae.next=null,U===null?I=ke:U.next=ke,U=ae;var qe=u.alternate;qe!==null&&(qe=qe.updateQueue,se=qe.lastBaseUpdate,se!==U&&(se===null?qe.firstBaseUpdate=ke:se.next=ke,qe.lastBaseUpdate=ae))}if(I!==null){var et=S.baseState;U=0,qe=ke=ae=null,se=I;do{var Ke=se.lane,vt=se.eventTime;if((E&Ke)===Ke){qe!==null&&(qe=qe.next={eventTime:vt,lane:0,tag:se.tag,payload:se.payload,callback:se.callback,next:null});e:{var kt=u,Pt=se;switch(Ke=d,vt=p,Pt.tag){case 1:if(kt=Pt.payload,typeof kt=="function"){et=kt.call(vt,et,Ke);break e}et=kt;break e;case 3:kt.flags=kt.flags&-65537|128;case 0:if(kt=Pt.payload,Ke=typeof kt=="function"?kt.call(vt,et,Ke):kt,Ke==null)break e;et=be({},et,Ke);break e;case 2:Oc=!0}}se.callback!==null&&se.lane!==0&&(u.flags|=64,Ke=S.effects,Ke===null?S.effects=[se]:Ke.push(se))}else vt={eventTime:vt,lane:Ke,tag:se.tag,payload:se.payload,callback:se.callback,next:null},qe===null?(ke=qe=vt,ae=et):qe=qe.next=vt,U|=Ke;if(se=se.next,se===null){if(se=S.shared.pending,se===null)break;Ke=se,se=Ke.next,Ke.next=null,S.lastBaseUpdate=Ke,S.shared.pending=null}}while(!0);if(qe===null&&(ae=et),S.baseState=ae,S.firstBaseUpdate=ke,S.lastBaseUpdate=qe,d=S.shared.interleaved,d!==null){S=d;do U|=S.lane,S=S.next;while(S!==d)}else I===null&&(S.shared.lanes=0);mh|=U,u.lanes=U,u.memoizedState=et}}function vP(u,d,p){if(u=d.effects,d.effects=null,u!==null)for(d=0;d<u.length;d++){var E=u[d],S=E.callback;if(S!==null){if(E.callback=null,E=p,typeof S!="function")throw Error(t(191,S));S.call(E)}}}var Kg={},Go=Nc(Kg),Xg=Nc(Kg),qg=Nc(Kg);function fh(u){if(u===Kg)throw Error(t(174));return u}function w2(u,d){switch(cr(qg,d),cr(Xg,u),cr(Go,Kg),u=d.nodeType,u){case 9:case 11:d=(d=d.documentElement)?d.namespaceURI:xn(null,"");break;default:u=u===8?d.parentNode:d,d=u.namespaceURI||null,u=u.tagName,d=xn(d,u)}fr(Go),cr(Go,d)}function yf(){fr(Go),fr(Xg),fr(qg)}function wP(u){fh(qg.current);var d=fh(Go.current),p=xn(d,u.type);d!==p&&(cr(Xg,u),cr(Go,p))}function E2(u){Xg.current===u&&(fr(Go),fr(Xg))}var Ar=Nc(0);function Fy(u){for(var d=u;d!==null;){if(d.tag===13){var p=d.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||p.data==="$?"||p.data==="$!"))return d}else if(d.tag===19&&d.memoizedProps.revealOrder!==void 0){if((d.flags&128)!==0)return d}else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===u)break;for(;d.sibling===null;){if(d.return===null||d.return===u)return null;d=d.return}d.sibling.return=d.return,d=d.sibling}return null}var S2=[];function b2(){for(var u=0;u<S2.length;u++)S2[u]._workInProgressVersionPrimary=null;S2.length=0}var Vy=L.ReactCurrentDispatcher,T2=L.ReactCurrentBatchConfig,gh=0,kr=null,ci=null,xi=null,By=!1,Yg=!1,Zg=0,Gz=0;function Qi(){throw Error(t(321))}function R2(u,d){if(d===null)return!1;for(var p=0;p<d.length&&p<u.length;p++)if(!qa(u[p],d[p]))return!1;return!0}function A2(u,d,p,E,S,I){if(gh=I,kr=d,d.memoizedState=null,d.updateQueue=null,d.lanes=0,Vy.current=u===null||u.memoizedState===null?Wz:Hz,u=p(E,S),Yg){I=0;do{if(Yg=!1,Zg=0,25<=I)throw Error(t(301));I+=1,xi=ci=null,d.updateQueue=null,Vy.current=Kz,u=p(E,S)}while(Yg)}if(Vy.current=Uy,d=ci!==null&&ci.next!==null,gh=0,xi=ci=kr=null,By=!1,d)throw Error(t(300));return u}function k2(){var u=Zg!==0;return Zg=0,u}function zo(){var u={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return xi===null?kr.memoizedState=xi=u:xi=xi.next=u,xi}function Sa(){if(ci===null){var u=kr.alternate;u=u!==null?u.memoizedState:null}else u=ci.next;var d=xi===null?kr.memoizedState:xi.next;if(d!==null)xi=d,ci=u;else{if(u===null)throw Error(t(310));ci=u,u={memoizedState:ci.memoizedState,baseState:ci.baseState,baseQueue:ci.baseQueue,queue:ci.queue,next:null},xi===null?kr.memoizedState=xi=u:xi=xi.next=u}return xi}function Jg(u,d){return typeof d=="function"?d(u):d}function I2(u){var d=Sa(),p=d.queue;if(p===null)throw Error(t(311));p.lastRenderedReducer=u;var E=ci,S=E.baseQueue,I=p.pending;if(I!==null){if(S!==null){var U=S.next;S.next=I.next,I.next=U}E.baseQueue=S=I,p.pending=null}if(S!==null){I=S.next,E=E.baseState;var se=U=null,ae=null,ke=I;do{var qe=ke.lane;if((gh&qe)===qe)ae!==null&&(ae=ae.next={lane:0,action:ke.action,hasEagerState:ke.hasEagerState,eagerState:ke.eagerState,next:null}),E=ke.hasEagerState?ke.eagerState:u(E,ke.action);else{var et={lane:qe,action:ke.action,hasEagerState:ke.hasEagerState,eagerState:ke.eagerState,next:null};ae===null?(se=ae=et,U=E):ae=ae.next=et,kr.lanes|=qe,mh|=qe}ke=ke.next}while(ke!==null&&ke!==I);ae===null?U=E:ae.next=se,qa(E,d.memoizedState)||(ks=!0),d.memoizedState=E,d.baseState=U,d.baseQueue=ae,p.lastRenderedState=E}if(u=p.interleaved,u!==null){S=u;do I=S.lane,kr.lanes|=I,mh|=I,S=S.next;while(S!==u)}else S===null&&(p.lanes=0);return[d.memoizedState,p.dispatch]}function C2(u){var d=Sa(),p=d.queue;if(p===null)throw Error(t(311));p.lastRenderedReducer=u;var E=p.dispatch,S=p.pending,I=d.memoizedState;if(S!==null){p.pending=null;var U=S=S.next;do I=u(I,U.action),U=U.next;while(U!==S);qa(I,d.memoizedState)||(ks=!0),d.memoizedState=I,d.baseQueue===null&&(d.baseState=I),p.lastRenderedState=I}return[I,E]}function EP(){}function SP(u,d){var p=kr,E=Sa(),S=d(),I=!qa(E.memoizedState,S);if(I&&(E.memoizedState=S,ks=!0),E=E.queue,P2(RP.bind(null,p,E,u),[u]),E.getSnapshot!==d||I||xi!==null&&xi.memoizedState.tag&1){if(p.flags|=2048,Qg(9,TP.bind(null,p,E,S,d),void 0,null),_i===null)throw Error(t(349));(gh&30)!==0||bP(p,d,S)}return S}function bP(u,d,p){u.flags|=16384,u={getSnapshot:d,value:p},d=kr.updateQueue,d===null?(d={lastEffect:null,stores:null},kr.updateQueue=d,d.stores=[u]):(p=d.stores,p===null?d.stores=[u]:p.push(u))}function TP(u,d,p,E){d.value=p,d.getSnapshot=E,AP(d)&&kP(u)}function RP(u,d,p){return p(function(){AP(d)&&kP(u)})}function AP(u){var d=u.getSnapshot;u=u.value;try{var p=d();return!qa(u,p)}catch{return!0}}function kP(u){var d=Pl(u,1);d!==null&&eo(d,u,1,-1)}function IP(u){var d=zo();return typeof u=="function"&&(u=u()),d.memoizedState=d.baseState=u,u={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Jg,lastRenderedState:u},d.queue=u,u=u.dispatch=$z.bind(null,kr,u),[d.memoizedState,u]}function Qg(u,d,p,E){return u={tag:u,create:d,destroy:p,deps:E,next:null},d=kr.updateQueue,d===null?(d={lastEffect:null,stores:null},kr.updateQueue=d,d.lastEffect=u.next=u):(p=d.lastEffect,p===null?d.lastEffect=u.next=u:(E=p.next,p.next=u,u.next=E,d.lastEffect=u)),u}function CP(){return Sa().memoizedState}function Gy(u,d,p,E){var S=zo();kr.flags|=u,S.memoizedState=Qg(1|d,p,void 0,E===void 0?null:E)}function zy(u,d,p,E){var S=Sa();E=E===void 0?null:E;var I=void 0;if(ci!==null){var U=ci.memoizedState;if(I=U.destroy,E!==null&&R2(E,U.deps)){S.memoizedState=Qg(d,p,I,E);return}}kr.flags|=u,S.memoizedState=Qg(1|d,p,I,E)}function PP(u,d){return Gy(8390656,8,u,d)}function P2(u,d){return zy(2048,8,u,d)}function NP(u,d){return zy(4,2,u,d)}function MP(u,d){return zy(4,4,u,d)}function LP(u,d){if(typeof d=="function")return u=u(),d(u),function(){d(null)};if(d!=null)return u=u(),d.current=u,function(){d.current=null}}function OP(u,d,p){return p=p!=null?p.concat([u]):null,zy(4,4,LP.bind(null,d,u),p)}function N2(){}function DP(u,d){var p=Sa();d=d===void 0?null:d;var E=p.memoizedState;return E!==null&&d!==null&&R2(d,E[1])?E[0]:(p.memoizedState=[u,d],u)}function jP(u,d){var p=Sa();d=d===void 0?null:d;var E=p.memoizedState;return E!==null&&d!==null&&R2(d,E[1])?E[0]:(u=u(),p.memoizedState=[u,d],u)}function FP(u,d,p){return(gh&21)===0?(u.baseState&&(u.baseState=!1,ks=!0),u.memoizedState=p):(qa(p,d)||(p=Tg(),kr.lanes|=p,mh|=p,u.baseState=!0),d)}function zz(u,d){var p=En;En=p!==0&&4>p?p:4,u(!0);var E=T2.transition;T2.transition={};try{u(!1),d()}finally{En=p,T2.transition=E}}function VP(){return Sa().memoizedState}function Uz(u,d,p){var E=Bc(u);if(p={lane:E,action:p,hasEagerState:!1,eagerState:null,next:null},BP(u))GP(d,p);else if(p=yP(u,d,p,E),p!==null){var S=ys();eo(p,u,E,S),zP(p,d,E)}}function $z(u,d,p){var E=Bc(u),S={lane:E,action:p,hasEagerState:!1,eagerState:null,next:null};if(BP(u))GP(d,S);else{var I=u.alternate;if(u.lanes===0&&(I===null||I.lanes===0)&&(I=d.lastRenderedReducer,I!==null))try{var U=d.lastRenderedState,se=I(U,p);if(S.hasEagerState=!0,S.eagerState=se,qa(se,U)){var ae=d.interleaved;ae===null?(S.next=S,_2(d)):(S.next=ae.next,ae.next=S),d.interleaved=S;return}}catch{}p=yP(u,d,S,E),p!==null&&(S=ys(),eo(p,u,E,S),zP(p,d,E))}}function BP(u){var d=u.alternate;return u===kr||d!==null&&d===kr}function GP(u,d){Yg=By=!0;var p=u.pending;p===null?d.next=d:(d.next=p.next,p.next=d),u.pending=d}function zP(u,d,p){if((p&4194240)!==0){var E=d.lanes;E&=u.pendingLanes,p|=E,d.lanes=p,Ag(u,p)}}var Uy={readContext:Ea,useCallback:Qi,useContext:Qi,useEffect:Qi,useImperativeHandle:Qi,useInsertionEffect:Qi,useLayoutEffect:Qi,useMemo:Qi,useReducer:Qi,useRef:Qi,useState:Qi,useDebugValue:Qi,useDeferredValue:Qi,useTransition:Qi,useMutableSource:Qi,useSyncExternalStore:Qi,useId:Qi,unstable_isNewReconciler:!1},Wz={readContext:Ea,useCallback:function(u,d){return zo().memoizedState=[u,d===void 0?null:d],u},useContext:Ea,useEffect:PP,useImperativeHandle:function(u,d,p){return p=p!=null?p.concat([u]):null,Gy(4194308,4,LP.bind(null,d,u),p)},useLayoutEffect:function(u,d){return Gy(4194308,4,u,d)},useInsertionEffect:function(u,d){return Gy(4,2,u,d)},useMemo:function(u,d){var p=zo();return d=d===void 0?null:d,u=u(),p.memoizedState=[u,d],u},useReducer:function(u,d,p){var E=zo();return d=p!==void 0?p(d):d,E.memoizedState=E.baseState=d,u={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:u,lastRenderedState:d},E.queue=u,u=u.dispatch=Uz.bind(null,kr,u),[E.memoizedState,u]},useRef:function(u){var d=zo();return u={current:u},d.memoizedState=u},useState:IP,useDebugValue:N2,useDeferredValue:function(u){return zo().memoizedState=u},useTransition:function(){var u=IP(!1),d=u[0];return u=zz.bind(null,u[1]),zo().memoizedState=u,[d,u]},useMutableSource:function(){},useSyncExternalStore:function(u,d,p){var E=kr,S=zo();if(xr){if(p===void 0)throw Error(t(407));p=p()}else{if(p=d(),_i===null)throw Error(t(349));(gh&30)!==0||bP(E,d,p)}S.memoizedState=p;var I={value:p,getSnapshot:d};return S.queue=I,PP(RP.bind(null,E,I,u),[u]),E.flags|=2048,Qg(9,TP.bind(null,E,I,p,d),void 0,null),p},useId:function(){var u=zo(),d=_i.identifierPrefix;if(xr){var p=Cl,E=Il;p=(E&~(1<<32-Rr(E)-1)).toString(32)+p,d=":"+d+"R"+p,p=Zg++,0<p&&(d+="H"+p.toString(32)),d+=":"}else p=Gz++,d=":"+d+"r"+p.toString(32)+":";return u.memoizedState=d},unstable_isNewReconciler:!1},Hz={readContext:Ea,useCallback:DP,useContext:Ea,useEffect:P2,useImperativeHandle:OP,useInsertionEffect:NP,useLayoutEffect:MP,useMemo:jP,useReducer:I2,useRef:CP,useState:function(){return I2(Jg)},useDebugValue:N2,useDeferredValue:function(u){var d=Sa();return FP(d,ci.memoizedState,u)},useTransition:function(){var u=I2(Jg)[0],d=Sa().memoizedState;return[u,d]},useMutableSource:EP,useSyncExternalStore:SP,useId:VP,unstable_isNewReconciler:!1},Kz={readContext:Ea,useCallback:DP,useContext:Ea,useEffect:P2,useImperativeHandle:OP,useInsertionEffect:NP,useLayoutEffect:MP,useMemo:jP,useReducer:C2,useRef:CP,useState:function(){return C2(Jg)},useDebugValue:N2,useDeferredValue:function(u){var d=Sa();return ci===null?d.memoizedState=u:FP(d,ci.memoizedState,u)},useTransition:function(){var u=C2(Jg)[0],d=Sa().memoizedState;return[u,d]},useMutableSource:EP,useSyncExternalStore:SP,useId:VP,unstable_isNewReconciler:!1};function Za(u,d){if(u&&u.defaultProps){d=be({},d),u=u.defaultProps;for(var p in u)d[p]===void 0&&(d[p]=u[p]);return d}return d}function M2(u,d,p,E){d=u.memoizedState,p=p(E,d),p=p==null?d:be({},d,p),u.memoizedState=p,u.lanes===0&&(u.updateQueue.baseState=p)}var $y={isMounted:function(u){return(u=u._reactInternals)?ee(u)===u:!1},enqueueSetState:function(u,d,p){u=u._reactInternals;var E=ys(),S=Bc(u),I=Nl(E,S);I.payload=d,p!=null&&(I.callback=p),d=Dc(u,I,S),d!==null&&(eo(d,u,S,E),Dy(d,u,S))},enqueueReplaceState:function(u,d,p){u=u._reactInternals;var E=ys(),S=Bc(u),I=Nl(E,S);I.tag=1,I.payload=d,p!=null&&(I.callback=p),d=Dc(u,I,S),d!==null&&(eo(d,u,S,E),Dy(d,u,S))},enqueueForceUpdate:function(u,d){u=u._reactInternals;var p=ys(),E=Bc(u),S=Nl(p,E);S.tag=2,d!=null&&(S.callback=d),d=Dc(u,S,E),d!==null&&(eo(d,u,E,p),Dy(d,u,E))}};function UP(u,d,p,E,S,I,U){return u=u.stateNode,typeof u.shouldComponentUpdate=="function"?u.shouldComponentUpdate(E,I,U):d.prototype&&d.prototype.isPureReactComponent?!Vg(p,E)||!Vg(S,I):!0}function $P(u,d,p){var E=!1,S=Mc,I=d.contextType;return typeof I=="object"&&I!==null?I=Ea(I):(S=As(d)?ch:Ji.current,E=d.contextTypes,I=(E=E!=null)?uf(u,S):Mc),d=new d(p,I),u.memoizedState=d.state!==null&&d.state!==void 0?d.state:null,d.updater=$y,u.stateNode=d,d._reactInternals=u,E&&(u=u.stateNode,u.__reactInternalMemoizedUnmaskedChildContext=S,u.__reactInternalMemoizedMaskedChildContext=I),d}function WP(u,d,p,E){u=d.state,typeof d.componentWillReceiveProps=="function"&&d.componentWillReceiveProps(p,E),typeof d.UNSAFE_componentWillReceiveProps=="function"&&d.UNSAFE_componentWillReceiveProps(p,E),d.state!==u&&$y.enqueueReplaceState(d,d.state,null)}function L2(u,d,p,E){var S=u.stateNode;S.props=p,S.state=u.memoizedState,S.refs={},v2(u);var I=d.contextType;typeof I=="object"&&I!==null?S.context=Ea(I):(I=As(d)?ch:Ji.current,S.context=uf(u,I)),S.state=u.memoizedState,I=d.getDerivedStateFromProps,typeof I=="function"&&(M2(u,d,I,p),S.state=u.memoizedState),typeof d.getDerivedStateFromProps=="function"||typeof S.getSnapshotBeforeUpdate=="function"||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(d=S.state,typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount(),d!==S.state&&$y.enqueueReplaceState(S,S.state,null),jy(u,p,S,E),S.state=u.memoizedState),typeof S.componentDidMount=="function"&&(u.flags|=4194308)}function xf(u,d){try{var p="",E=d;do p+=re(E),E=E.return;while(E);var S=p}catch(I){S=`
Error generating stack: `+I.message+`
`+I.stack}return{value:u,source:d,stack:S,digest:null}}function O2(u,d,p){return{value:u,source:null,stack:p??null,digest:d??null}}function D2(u,d){try{console.error(d.value)}catch(p){setTimeout(function(){throw p})}}var Xz=typeof WeakMap=="function"?WeakMap:Map;function HP(u,d,p){p=Nl(-1,p),p.tag=3,p.payload={element:null};var E=d.value;return p.callback=function(){Zy||(Zy=!0,Z2=E),D2(u,d)},p}function KP(u,d,p){p=Nl(-1,p),p.tag=3;var E=u.type.getDerivedStateFromError;if(typeof E=="function"){var S=d.value;p.payload=function(){return E(S)},p.callback=function(){D2(u,d)}}var I=u.stateNode;return I!==null&&typeof I.componentDidCatch=="function"&&(p.callback=function(){D2(u,d),typeof E!="function"&&(Fc===null?Fc=new Set([this]):Fc.add(this));var U=d.stack;this.componentDidCatch(d.value,{componentStack:U!==null?U:""})}),p}function XP(u,d,p){var E=u.pingCache;if(E===null){E=u.pingCache=new Xz;var S=new Set;E.set(d,S)}else S=E.get(d),S===void 0&&(S=new Set,E.set(d,S));S.has(p)||(S.add(p),u=lU.bind(null,u,d,p),d.then(u,u))}function qP(u){do{var d;if((d=u.tag===13)&&(d=u.memoizedState,d=d!==null?d.dehydrated!==null:!0),d)return u;u=u.return}while(u!==null);return null}function YP(u,d,p,E,S){return(u.mode&1)===0?(u===d?u.flags|=65536:(u.flags|=128,p.flags|=131072,p.flags&=-52805,p.tag===1&&(p.alternate===null?p.tag=17:(d=Nl(-1,1),d.tag=2,Dc(p,d,1))),p.lanes|=1),u):(u.flags|=65536,u.lanes=S,u)}var qz=L.ReactCurrentOwner,ks=!1;function ps(u,d,p,E){d.child=u===null?pP(d,null,p,E):gf(d,u.child,p,E)}function ZP(u,d,p,E,S){p=p.render;var I=d.ref;return pf(d,S),E=A2(u,d,p,E,I,S),p=k2(),u!==null&&!ks?(d.updateQueue=u.updateQueue,d.flags&=-2053,u.lanes&=~S,Ml(u,d,S)):(xr&&p&&u2(d),d.flags|=1,ps(u,d,E,S),d.child)}function JP(u,d,p,E,S){if(u===null){var I=p.type;return typeof I=="function"&&!iS(I)&&I.defaultProps===void 0&&p.compare===null&&p.defaultProps===void 0?(d.tag=15,d.type=I,QP(u,d,I,E,S)):(u=rx(p.type,null,E,d,d.mode,S),u.ref=d.ref,u.return=d,d.child=u)}if(I=u.child,(u.lanes&S)===0){var U=I.memoizedProps;if(p=p.compare,p=p!==null?p:Vg,p(U,E)&&u.ref===d.ref)return Ml(u,d,S)}return d.flags|=1,u=zc(I,E),u.ref=d.ref,u.return=d,d.child=u}function QP(u,d,p,E,S){if(u!==null){var I=u.memoizedProps;if(Vg(I,E)&&u.ref===d.ref)if(ks=!1,d.pendingProps=E=I,(u.lanes&S)!==0)(u.flags&131072)!==0&&(ks=!0);else return d.lanes=u.lanes,Ml(u,d,S)}return j2(u,d,p,E,S)}function e4(u,d,p){var E=d.pendingProps,S=E.children,I=u!==null?u.memoizedState:null;if(E.mode==="hidden")if((d.mode&1)===0)d.memoizedState={baseLanes:0,cachePool:null,transitions:null},cr(vf,na),na|=p;else{if((p&1073741824)===0)return u=I!==null?I.baseLanes|p:p,d.lanes=d.childLanes=1073741824,d.memoizedState={baseLanes:u,cachePool:null,transitions:null},d.updateQueue=null,cr(vf,na),na|=u,null;d.memoizedState={baseLanes:0,cachePool:null,transitions:null},E=I!==null?I.baseLanes:p,cr(vf,na),na|=E}else I!==null?(E=I.baseLanes|p,d.memoizedState=null):E=p,cr(vf,na),na|=E;return ps(u,d,S,p),d.child}function t4(u,d){var p=d.ref;(u===null&&p!==null||u!==null&&u.ref!==p)&&(d.flags|=512,d.flags|=2097152)}function j2(u,d,p,E,S){var I=As(p)?ch:Ji.current;return I=uf(d,I),pf(d,S),p=A2(u,d,p,E,I,S),E=k2(),u!==null&&!ks?(d.updateQueue=u.updateQueue,d.flags&=-2053,u.lanes&=~S,Ml(u,d,S)):(xr&&E&&u2(d),d.flags|=1,ps(u,d,p,S),d.child)}function n4(u,d,p,E,S){if(As(p)){var I=!0;ky(d)}else I=!1;if(pf(d,S),d.stateNode===null)Hy(u,d),$P(d,p,E),L2(d,p,E,S),E=!0;else if(u===null){var U=d.stateNode,se=d.memoizedProps;U.props=se;var ae=U.context,ke=p.contextType;typeof ke=="object"&&ke!==null?ke=Ea(ke):(ke=As(p)?ch:Ji.current,ke=uf(d,ke));var qe=p.getDerivedStateFromProps,et=typeof qe=="function"||typeof U.getSnapshotBeforeUpdate=="function";et||typeof U.UNSAFE_componentWillReceiveProps!="function"&&typeof U.componentWillReceiveProps!="function"||(se!==E||ae!==ke)&&WP(d,U,E,ke),Oc=!1;var Ke=d.memoizedState;U.state=Ke,jy(d,E,U,S),ae=d.memoizedState,se!==E||Ke!==ae||Rs.current||Oc?(typeof qe=="function"&&(M2(d,p,qe,E),ae=d.memoizedState),(se=Oc||UP(d,p,se,E,Ke,ae,ke))?(et||typeof U.UNSAFE_componentWillMount!="function"&&typeof U.componentWillMount!="function"||(typeof U.componentWillMount=="function"&&U.componentWillMount(),typeof U.UNSAFE_componentWillMount=="function"&&U.UNSAFE_componentWillMount()),typeof U.componentDidMount=="function"&&(d.flags|=4194308)):(typeof U.componentDidMount=="function"&&(d.flags|=4194308),d.memoizedProps=E,d.memoizedState=ae),U.props=E,U.state=ae,U.context=ke,E=se):(typeof U.componentDidMount=="function"&&(d.flags|=4194308),E=!1)}else{U=d.stateNode,xP(u,d),se=d.memoizedProps,ke=d.type===d.elementType?se:Za(d.type,se),U.props=ke,et=d.pendingProps,Ke=U.context,ae=p.contextType,typeof ae=="object"&&ae!==null?ae=Ea(ae):(ae=As(p)?ch:Ji.current,ae=uf(d,ae));var vt=p.getDerivedStateFromProps;(qe=typeof vt=="function"||typeof U.getSnapshotBeforeUpdate=="function")||typeof U.UNSAFE_componentWillReceiveProps!="function"&&typeof U.componentWillReceiveProps!="function"||(se!==et||Ke!==ae)&&WP(d,U,E,ae),Oc=!1,Ke=d.memoizedState,U.state=Ke,jy(d,E,U,S);var kt=d.memoizedState;se!==et||Ke!==kt||Rs.current||Oc?(typeof vt=="function"&&(M2(d,p,vt,E),kt=d.memoizedState),(ke=Oc||UP(d,p,ke,E,Ke,kt,ae)||!1)?(qe||typeof U.UNSAFE_componentWillUpdate!="function"&&typeof U.componentWillUpdate!="function"||(typeof U.componentWillUpdate=="function"&&U.componentWillUpdate(E,kt,ae),typeof U.UNSAFE_componentWillUpdate=="function"&&U.UNSAFE_componentWillUpdate(E,kt,ae)),typeof U.componentDidUpdate=="function"&&(d.flags|=4),typeof U.getSnapshotBeforeUpdate=="function"&&(d.flags|=1024)):(typeof U.componentDidUpdate!="function"||se===u.memoizedProps&&Ke===u.memoizedState||(d.flags|=4),typeof U.getSnapshotBeforeUpdate!="function"||se===u.memoizedProps&&Ke===u.memoizedState||(d.flags|=1024),d.memoizedProps=E,d.memoizedState=kt),U.props=E,U.state=kt,U.context=ae,E=ke):(typeof U.componentDidUpdate!="function"||se===u.memoizedProps&&Ke===u.memoizedState||(d.flags|=4),typeof U.getSnapshotBeforeUpdate!="function"||se===u.memoizedProps&&Ke===u.memoizedState||(d.flags|=1024),E=!1)}return F2(u,d,p,E,I,S)}function F2(u,d,p,E,S,I){t4(u,d);var U=(d.flags&128)!==0;if(!E&&!U)return S&&oP(d,p,!1),Ml(u,d,I);E=d.stateNode,qz.current=d;var se=U&&typeof p.getDerivedStateFromError!="function"?null:E.render();return d.flags|=1,u!==null&&U?(d.child=gf(d,u.child,null,I),d.child=gf(d,null,se,I)):ps(u,d,se,I),d.memoizedState=E.state,S&&oP(d,p,!0),d.child}function r4(u){var d=u.stateNode;d.pendingContext?sP(u,d.pendingContext,d.pendingContext!==d.context):d.context&&sP(u,d.context,!1),w2(u,d.containerInfo)}function i4(u,d,p,E,S){return ff(),g2(S),d.flags|=256,ps(u,d,p,E),d.child}var V2={dehydrated:null,treeContext:null,retryLane:0};function B2(u){return{baseLanes:u,cachePool:null,transitions:null}}function s4(u,d,p){var E=d.pendingProps,S=Ar.current,I=!1,U=(d.flags&128)!==0,se;if((se=U)||(se=u!==null&&u.memoizedState===null?!1:(S&2)!==0),se?(I=!0,d.flags&=-129):(u===null||u.memoizedState!==null)&&(S|=1),cr(Ar,S&1),u===null)return f2(d),u=d.memoizedState,u!==null&&(u=u.dehydrated,u!==null)?((d.mode&1)===0?d.lanes=1:u.data==="$!"?d.lanes=8:d.lanes=1073741824,null):(U=E.children,u=E.fallback,I?(E=d.mode,I=d.child,U={mode:"hidden",children:U},(E&1)===0&&I!==null?(I.childLanes=0,I.pendingProps=U):I=ix(U,E,0,null),u=_h(u,E,p,null),I.return=d,u.return=d,I.sibling=u,d.child=I,d.child.memoizedState=B2(p),d.memoizedState=V2,u):G2(d,U));if(S=u.memoizedState,S!==null&&(se=S.dehydrated,se!==null))return Yz(u,d,U,E,se,S,p);if(I){I=E.fallback,U=d.mode,S=u.child,se=S.sibling;var ae={mode:"hidden",children:E.children};return(U&1)===0&&d.child!==S?(E=d.child,E.childLanes=0,E.pendingProps=ae,d.deletions=null):(E=zc(S,ae),E.subtreeFlags=S.subtreeFlags&14680064),se!==null?I=zc(se,I):(I=_h(I,U,p,null),I.flags|=2),I.return=d,E.return=d,E.sibling=I,d.child=E,E=I,I=d.child,U=u.child.memoizedState,U=U===null?B2(p):{baseLanes:U.baseLanes|p,cachePool:null,transitions:U.transitions},I.memoizedState=U,I.childLanes=u.childLanes&~p,d.memoizedState=V2,E}return I=u.child,u=I.sibling,E=zc(I,{mode:"visible",children:E.children}),(d.mode&1)===0&&(E.lanes=p),E.return=d,E.sibling=null,u!==null&&(p=d.deletions,p===null?(d.deletions=[u],d.flags|=16):p.push(u)),d.child=E,d.memoizedState=null,E}function G2(u,d){return d=ix({mode:"visible",children:d},u.mode,0,null),d.return=u,u.child=d}function Wy(u,d,p,E){return E!==null&&g2(E),gf(d,u.child,null,p),u=G2(d,d.pendingProps.children),u.flags|=2,d.memoizedState=null,u}function Yz(u,d,p,E,S,I,U){if(p)return d.flags&256?(d.flags&=-257,E=O2(Error(t(422))),Wy(u,d,U,E)):d.memoizedState!==null?(d.child=u.child,d.flags|=128,null):(I=E.fallback,S=d.mode,E=ix({mode:"visible",children:E.children},S,0,null),I=_h(I,S,U,null),I.flags|=2,E.return=d,I.return=d,E.sibling=I,d.child=E,(d.mode&1)!==0&&gf(d,u.child,null,U),d.child.memoizedState=B2(U),d.memoizedState=V2,I);if((d.mode&1)===0)return Wy(u,d,U,null);if(S.data==="$!"){if(E=S.nextSibling&&S.nextSibling.dataset,E)var se=E.dgst;return E=se,I=Error(t(419)),E=O2(I,E,void 0),Wy(u,d,U,E)}if(se=(U&u.childLanes)!==0,ks||se){if(E=_i,E!==null){switch(U&-U){case 4:S=2;break;case 16:S=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:S=32;break;case 536870912:S=268435456;break;default:S=0}S=(S&(E.suspendedLanes|U))!==0?0:S,S!==0&&S!==I.retryLane&&(I.retryLane=S,Pl(u,S),eo(E,u,S,-1))}return rS(),E=O2(Error(t(421))),Wy(u,d,U,E)}return S.data==="$?"?(d.flags|=128,d.child=u.child,d=cU.bind(null,u),S._reactRetry=d,null):(u=I.treeContext,ta=Pc(S.nextSibling),ea=d,xr=!0,Ya=null,u!==null&&(va[wa++]=Il,va[wa++]=Cl,va[wa++]=uh,Il=u.id,Cl=u.overflow,uh=d),d=G2(d,E.children),d.flags|=4096,d)}function a4(u,d,p){u.lanes|=d;var E=u.alternate;E!==null&&(E.lanes|=d),x2(u.return,d,p)}function z2(u,d,p,E,S){var I=u.memoizedState;I===null?u.memoizedState={isBackwards:d,rendering:null,renderingStartTime:0,last:E,tail:p,tailMode:S}:(I.isBackwards=d,I.rendering=null,I.renderingStartTime=0,I.last=E,I.tail=p,I.tailMode=S)}function o4(u,d,p){var E=d.pendingProps,S=E.revealOrder,I=E.tail;if(ps(u,d,E.children,p),E=Ar.current,(E&2)!==0)E=E&1|2,d.flags|=128;else{if(u!==null&&(u.flags&128)!==0)e:for(u=d.child;u!==null;){if(u.tag===13)u.memoizedState!==null&&a4(u,p,d);else if(u.tag===19)a4(u,p,d);else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===d)break e;for(;u.sibling===null;){if(u.return===null||u.return===d)break e;u=u.return}u.sibling.return=u.return,u=u.sibling}E&=1}if(cr(Ar,E),(d.mode&1)===0)d.memoizedState=null;else switch(S){case"forwards":for(p=d.child,S=null;p!==null;)u=p.alternate,u!==null&&Fy(u)===null&&(S=p),p=p.sibling;p=S,p===null?(S=d.child,d.child=null):(S=p.sibling,p.sibling=null),z2(d,!1,S,p,I);break;case"backwards":for(p=null,S=d.child,d.child=null;S!==null;){if(u=S.alternate,u!==null&&Fy(u)===null){d.child=S;break}u=S.sibling,S.sibling=p,p=S,S=u}z2(d,!0,p,null,I);break;case"together":z2(d,!1,null,null,void 0);break;default:d.memoizedState=null}return d.child}function Hy(u,d){(d.mode&1)===0&&u!==null&&(u.alternate=null,d.alternate=null,d.flags|=2)}function Ml(u,d,p){if(u!==null&&(d.dependencies=u.dependencies),mh|=d.lanes,(p&d.childLanes)===0)return null;if(u!==null&&d.child!==u.child)throw Error(t(153));if(d.child!==null){for(u=d.child,p=zc(u,u.pendingProps),d.child=p,p.return=d;u.sibling!==null;)u=u.sibling,p=p.sibling=zc(u,u.pendingProps),p.return=d;p.sibling=null}return d.child}function Zz(u,d,p){switch(d.tag){case 3:r4(d),ff();break;case 5:wP(d);break;case 1:As(d.type)&&ky(d);break;case 4:w2(d,d.stateNode.containerInfo);break;case 10:var E=d.type._context,S=d.memoizedProps.value;cr(Ly,E._currentValue),E._currentValue=S;break;case 13:if(E=d.memoizedState,E!==null)return E.dehydrated!==null?(cr(Ar,Ar.current&1),d.flags|=128,null):(p&d.child.childLanes)!==0?s4(u,d,p):(cr(Ar,Ar.current&1),u=Ml(u,d,p),u!==null?u.sibling:null);cr(Ar,Ar.current&1);break;case 19:if(E=(p&d.childLanes)!==0,(u.flags&128)!==0){if(E)return o4(u,d,p);d.flags|=128}if(S=d.memoizedState,S!==null&&(S.rendering=null,S.tail=null,S.lastEffect=null),cr(Ar,Ar.current),E)break;return null;case 22:case 23:return d.lanes=0,e4(u,d,p)}return Ml(u,d,p)}var l4,U2,c4,u4;l4=function(u,d){for(var p=d.child;p!==null;){if(p.tag===5||p.tag===6)u.appendChild(p.stateNode);else if(p.tag!==4&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===d)break;for(;p.sibling===null;){if(p.return===null||p.return===d)return;p=p.return}p.sibling.return=p.return,p=p.sibling}},U2=function(){},c4=function(u,d,p,E){var S=u.memoizedProps;if(S!==E){u=d.stateNode,fh(Go.current);var I=null;switch(p){case"input":S=St(u,S),E=St(u,E),I=[];break;case"select":S=be({},S,{value:void 0}),E=be({},E,{value:void 0}),I=[];break;case"textarea":S=Pi(u,S),E=Pi(u,E),I=[];break;default:typeof S.onClick!="function"&&typeof E.onClick=="function"&&(u.onclick=Ty)}Tr(p,E);var U;p=null;for(ke in S)if(!E.hasOwnProperty(ke)&&S.hasOwnProperty(ke)&&S[ke]!=null)if(ke==="style"){var se=S[ke];for(U in se)se.hasOwnProperty(U)&&(p||(p={}),p[U]="")}else ke!=="dangerouslySetInnerHTML"&&ke!=="children"&&ke!=="suppressContentEditableWarning"&&ke!=="suppressHydrationWarning"&&ke!=="autoFocus"&&(i.hasOwnProperty(ke)?I||(I=[]):(I=I||[]).push(ke,null));for(ke in E){var ae=E[ke];if(se=S?.[ke],E.hasOwnProperty(ke)&&ae!==se&&(ae!=null||se!=null))if(ke==="style")if(se){for(U in se)!se.hasOwnProperty(U)||ae&&ae.hasOwnProperty(U)||(p||(p={}),p[U]="");for(U in ae)ae.hasOwnProperty(U)&&se[U]!==ae[U]&&(p||(p={}),p[U]=ae[U])}else p||(I||(I=[]),I.push(ke,p)),p=ae;else ke==="dangerouslySetInnerHTML"?(ae=ae?ae.__html:void 0,se=se?se.__html:void 0,ae!=null&&se!==ae&&(I=I||[]).push(ke,ae)):ke==="children"?typeof ae!="string"&&typeof ae!="number"||(I=I||[]).push(ke,""+ae):ke!=="suppressContentEditableWarning"&&ke!=="suppressHydrationWarning"&&(i.hasOwnProperty(ke)?(ae!=null&&ke==="onScroll"&&dr("scroll",u),I||se===ae||(I=[])):(I=I||[]).push(ke,ae))}p&&(I=I||[]).push("style",p);var ke=I;(d.updateQueue=ke)&&(d.flags|=4)}},u4=function(u,d,p,E){p!==E&&(d.flags|=4)};function em(u,d){if(!xr)switch(u.tailMode){case"hidden":d=u.tail;for(var p=null;d!==null;)d.alternate!==null&&(p=d),d=d.sibling;p===null?u.tail=null:p.sibling=null;break;case"collapsed":p=u.tail;for(var E=null;p!==null;)p.alternate!==null&&(E=p),p=p.sibling;E===null?d||u.tail===null?u.tail=null:u.tail.sibling=null:E.sibling=null}}function es(u){var d=u.alternate!==null&&u.alternate.child===u.child,p=0,E=0;if(d)for(var S=u.child;S!==null;)p|=S.lanes|S.childLanes,E|=S.subtreeFlags&14680064,E|=S.flags&14680064,S.return=u,S=S.sibling;else for(S=u.child;S!==null;)p|=S.lanes|S.childLanes,E|=S.subtreeFlags,E|=S.flags,S.return=u,S=S.sibling;return u.subtreeFlags|=E,u.childLanes=p,d}function Jz(u,d,p){var E=d.pendingProps;switch(h2(d),d.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return es(d),null;case 1:return As(d.type)&&Ay(),es(d),null;case 3:return E=d.stateNode,yf(),fr(Rs),fr(Ji),b2(),E.pendingContext&&(E.context=E.pendingContext,E.pendingContext=null),(u===null||u.child===null)&&(Ny(d)?d.flags|=4:u===null||u.memoizedState.isDehydrated&&(d.flags&256)===0||(d.flags|=1024,Ya!==null&&(eS(Ya),Ya=null))),U2(u,d),es(d),null;case 5:E2(d);var S=fh(qg.current);if(p=d.type,u!==null&&d.stateNode!=null)c4(u,d,p,E,S),u.ref!==d.ref&&(d.flags|=512,d.flags|=2097152);else{if(!E){if(d.stateNode===null)throw Error(t(166));return es(d),null}if(u=fh(Go.current),Ny(d)){E=d.stateNode,p=d.type;var I=d.memoizedProps;switch(E[Bo]=d,E[$g]=I,u=(d.mode&1)!==0,p){case"dialog":dr("cancel",E),dr("close",E);break;case"iframe":case"object":case"embed":dr("load",E);break;case"video":case"audio":for(S=0;S<Gg.length;S++)dr(Gg[S],E);break;case"source":dr("error",E);break;case"img":case"image":case"link":dr("error",E),dr("load",E);break;case"details":dr("toggle",E);break;case"input":Ut(E,I),dr("invalid",E);break;case"select":E._wrapperState={wasMultiple:!!I.multiple},dr("invalid",E);break;case"textarea":Gn(E,I),dr("invalid",E)}Tr(p,I),S=null;for(var U in I)if(I.hasOwnProperty(U)){var se=I[U];U==="children"?typeof se=="string"?E.textContent!==se&&(I.suppressHydrationWarning!==!0&&by(E.textContent,se,u),S=["children",se]):typeof se=="number"&&E.textContent!==""+se&&(I.suppressHydrationWarning!==!0&&by(E.textContent,se,u),S=["children",""+se]):i.hasOwnProperty(U)&&se!=null&&U==="onScroll"&&dr("scroll",E)}switch(p){case"input":Et(E),kn(E,I,!0);break;case"textarea":Et(E),oi(E);break;case"select":case"option":break;default:typeof I.onClick=="function"&&(E.onclick=Ty)}E=S,d.updateQueue=E,E!==null&&(d.flags|=4)}else{U=S.nodeType===9?S:S.ownerDocument,u==="http://www.w3.org/1999/xhtml"&&(u=_t(p)),u==="http://www.w3.org/1999/xhtml"?p==="script"?(u=U.createElement("div"),u.innerHTML="<script><\/script>",u=u.removeChild(u.firstChild)):typeof E.is=="string"?u=U.createElement(p,{is:E.is}):(u=U.createElement(p),p==="select"&&(U=u,E.multiple?U.multiple=!0:E.size&&(U.size=E.size))):u=U.createElementNS(u,p),u[Bo]=d,u[$g]=E,l4(u,d,!1,!1),d.stateNode=u;e:{switch(U=Fe(p,E),p){case"dialog":dr("cancel",u),dr("close",u),S=E;break;case"iframe":case"object":case"embed":dr("load",u),S=E;break;case"video":case"audio":for(S=0;S<Gg.length;S++)dr(Gg[S],u);S=E;break;case"source":dr("error",u),S=E;break;case"img":case"image":case"link":dr("error",u),dr("load",u),S=E;break;case"details":dr("toggle",u),S=E;break;case"input":Ut(u,E),S=St(u,E),dr("invalid",u);break;case"option":S=E;break;case"select":u._wrapperState={wasMultiple:!!E.multiple},S=be({},E,{value:void 0}),dr("invalid",u);break;case"textarea":Gn(u,E),S=Pi(u,E),dr("invalid",u);break;default:S=E}Tr(p,S),se=S;for(I in se)if(se.hasOwnProperty(I)){var ae=se[I];I==="style"?li(u,ae):I==="dangerouslySetInnerHTML"?(ae=ae?ae.__html:void 0,ae!=null&&Tt(u,ae)):I==="children"?typeof ae=="string"?(p!=="textarea"||ae!=="")&&an(u,ae):typeof ae=="number"&&an(u,""+ae):I!=="suppressContentEditableWarning"&&I!=="suppressHydrationWarning"&&I!=="autoFocus"&&(i.hasOwnProperty(I)?ae!=null&&I==="onScroll"&&dr("scroll",u):ae!=null&&k(u,I,ae,U))}switch(p){case"input":Et(u),kn(u,E,!1);break;case"textarea":Et(u),oi(u);break;case"option":E.value!=null&&u.setAttribute("value",""+Ge(E.value));break;case"select":u.multiple=!!E.multiple,I=E.value,I!=null?sr(u,!!E.multiple,I,!1):E.defaultValue!=null&&sr(u,!!E.multiple,E.defaultValue,!0);break;default:typeof S.onClick=="function"&&(u.onclick=Ty)}switch(p){case"button":case"input":case"select":case"textarea":E=!!E.autoFocus;break e;case"img":E=!0;break e;default:E=!1}}E&&(d.flags|=4)}d.ref!==null&&(d.flags|=512,d.flags|=2097152)}return es(d),null;case 6:if(u&&d.stateNode!=null)u4(u,d,u.memoizedProps,E);else{if(typeof E!="string"&&d.stateNode===null)throw Error(t(166));if(p=fh(qg.current),fh(Go.current),Ny(d)){if(E=d.stateNode,p=d.memoizedProps,E[Bo]=d,(I=E.nodeValue!==p)&&(u=ea,u!==null))switch(u.tag){case 3:by(E.nodeValue,p,(u.mode&1)!==0);break;case 5:u.memoizedProps.suppressHydrationWarning!==!0&&by(E.nodeValue,p,(u.mode&1)!==0)}I&&(d.flags|=4)}else E=(p.nodeType===9?p:p.ownerDocument).createTextNode(E),E[Bo]=d,d.stateNode=E}return es(d),null;case 13:if(fr(Ar),E=d.memoizedState,u===null||u.memoizedState!==null&&u.memoizedState.dehydrated!==null){if(xr&&ta!==null&&(d.mode&1)!==0&&(d.flags&128)===0)fP(),ff(),d.flags|=98560,I=!1;else if(I=Ny(d),E!==null&&E.dehydrated!==null){if(u===null){if(!I)throw Error(t(318));if(I=d.memoizedState,I=I!==null?I.dehydrated:null,!I)throw Error(t(317));I[Bo]=d}else ff(),(d.flags&128)===0&&(d.memoizedState=null),d.flags|=4;es(d),I=!1}else Ya!==null&&(eS(Ya),Ya=null),I=!0;if(!I)return d.flags&65536?d:null}return(d.flags&128)!==0?(d.lanes=p,d):(E=E!==null,E!==(u!==null&&u.memoizedState!==null)&&E&&(d.child.flags|=8192,(d.mode&1)!==0&&(u===null||(Ar.current&1)!==0?ui===0&&(ui=3):rS())),d.updateQueue!==null&&(d.flags|=4),es(d),null);case 4:return yf(),U2(u,d),u===null&&zg(d.stateNode.containerInfo),es(d),null;case 10:return y2(d.type._context),es(d),null;case 17:return As(d.type)&&Ay(),es(d),null;case 19:if(fr(Ar),I=d.memoizedState,I===null)return es(d),null;if(E=(d.flags&128)!==0,U=I.rendering,U===null)if(E)em(I,!1);else{if(ui!==0||u!==null&&(u.flags&128)!==0)for(u=d.child;u!==null;){if(U=Fy(u),U!==null){for(d.flags|=128,em(I,!1),E=U.updateQueue,E!==null&&(d.updateQueue=E,d.flags|=4),d.subtreeFlags=0,E=p,p=d.child;p!==null;)I=p,u=E,I.flags&=14680066,U=I.alternate,U===null?(I.childLanes=0,I.lanes=u,I.child=null,I.subtreeFlags=0,I.memoizedProps=null,I.memoizedState=null,I.updateQueue=null,I.dependencies=null,I.stateNode=null):(I.childLanes=U.childLanes,I.lanes=U.lanes,I.child=U.child,I.subtreeFlags=0,I.deletions=null,I.memoizedProps=U.memoizedProps,I.memoizedState=U.memoizedState,I.updateQueue=U.updateQueue,I.type=U.type,u=U.dependencies,I.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext}),p=p.sibling;return cr(Ar,Ar.current&1|2),d.child}u=u.sibling}I.tail!==null&&Je()>wf&&(d.flags|=128,E=!0,em(I,!1),d.lanes=4194304)}else{if(!E)if(u=Fy(U),u!==null){if(d.flags|=128,E=!0,p=u.updateQueue,p!==null&&(d.updateQueue=p,d.flags|=4),em(I,!0),I.tail===null&&I.tailMode==="hidden"&&!U.alternate&&!xr)return es(d),null}else 2*Je()-I.renderingStartTime>wf&&p!==1073741824&&(d.flags|=128,E=!0,em(I,!1),d.lanes=4194304);I.isBackwards?(U.sibling=d.child,d.child=U):(p=I.last,p!==null?p.sibling=U:d.child=U,I.last=U)}return I.tail!==null?(d=I.tail,I.rendering=d,I.tail=d.sibling,I.renderingStartTime=Je(),d.sibling=null,p=Ar.current,cr(Ar,E?p&1|2:p&1),d):(es(d),null);case 22:case 23:return nS(),E=d.memoizedState!==null,u!==null&&u.memoizedState!==null!==E&&(d.flags|=8192),E&&(d.mode&1)!==0?(na&1073741824)!==0&&(es(d),d.subtreeFlags&6&&(d.flags|=8192)):es(d),null;case 24:return null;case 25:return null}throw Error(t(156,d.tag))}function Qz(u,d){switch(h2(d),d.tag){case 1:return As(d.type)&&Ay(),u=d.flags,u&65536?(d.flags=u&-65537|128,d):null;case 3:return yf(),fr(Rs),fr(Ji),b2(),u=d.flags,(u&65536)!==0&&(u&128)===0?(d.flags=u&-65537|128,d):null;case 5:return E2(d),null;case 13:if(fr(Ar),u=d.memoizedState,u!==null&&u.dehydrated!==null){if(d.alternate===null)throw Error(t(340));ff()}return u=d.flags,u&65536?(d.flags=u&-65537|128,d):null;case 19:return fr(Ar),null;case 4:return yf(),null;case 10:return y2(d.type._context),null;case 22:case 23:return nS(),null;case 24:return null;default:return null}}var Ky=!1,ts=!1,eU=typeof WeakSet=="function"?WeakSet:Set,bt=null;function _f(u,d){var p=u.ref;if(p!==null)if(typeof p=="function")try{p(null)}catch(E){Lr(u,d,E)}else p.current=null}function $2(u,d,p){try{p()}catch(E){Lr(u,d,E)}}var h4=!1;function tU(u,d){if(n2=bl,u=UC(),XE(u)){if("selectionStart"in u)var p={start:u.selectionStart,end:u.selectionEnd};else e:{p=(p=u.ownerDocument)&&p.defaultView||window;var E=p.getSelection&&p.getSelection();if(E&&E.rangeCount!==0){p=E.anchorNode;var S=E.anchorOffset,I=E.focusNode;E=E.focusOffset;try{p.nodeType,I.nodeType}catch{p=null;break e}var U=0,se=-1,ae=-1,ke=0,qe=0,et=u,Ke=null;t:for(;;){for(var vt;et!==p||S!==0&&et.nodeType!==3||(se=U+S),et!==I||E!==0&&et.nodeType!==3||(ae=U+E),et.nodeType===3&&(U+=et.nodeValue.length),(vt=et.firstChild)!==null;)Ke=et,et=vt;for(;;){if(et===u)break t;if(Ke===p&&++ke===S&&(se=U),Ke===I&&++qe===E&&(ae=U),(vt=et.nextSibling)!==null)break;et=Ke,Ke=et.parentNode}et=vt}p=se===-1||ae===-1?null:{start:se,end:ae}}else p=null}p=p||{start:0,end:0}}else p=null;for(r2={focusedElem:u,selectionRange:p},bl=!1,bt=d;bt!==null;)if(d=bt,u=d.child,(d.subtreeFlags&1028)!==0&&u!==null)u.return=d,bt=u;else for(;bt!==null;){d=bt;try{var kt=d.alternate;if((d.flags&1024)!==0)switch(d.tag){case 0:case 11:case 15:break;case 1:if(kt!==null){var Pt=kt.memoizedProps,$r=kt.memoizedState,fe=d.stateNode,oe=fe.getSnapshotBeforeUpdate(d.elementType===d.type?Pt:Za(d.type,Pt),$r);fe.__reactInternalSnapshotBeforeUpdate=oe}break;case 3:var Se=d.stateNode.containerInfo;Se.nodeType===1?Se.textContent="":Se.nodeType===9&&Se.documentElement&&Se.removeChild(Se.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(it){Lr(d,d.return,it)}if(u=d.sibling,u!==null){u.return=d.return,bt=u;break}bt=d.return}return kt=h4,h4=!1,kt}function tm(u,d,p){var E=d.updateQueue;if(E=E!==null?E.lastEffect:null,E!==null){var S=E=E.next;do{if((S.tag&u)===u){var I=S.destroy;S.destroy=void 0,I!==void 0&&$2(d,p,I)}S=S.next}while(S!==E)}}function Xy(u,d){if(d=d.updateQueue,d=d!==null?d.lastEffect:null,d!==null){var p=d=d.next;do{if((p.tag&u)===u){var E=p.create;p.destroy=E()}p=p.next}while(p!==d)}}function W2(u){var d=u.ref;if(d!==null){var p=u.stateNode;switch(u.tag){case 5:u=p;break;default:u=p}typeof d=="function"?d(u):d.current=u}}function d4(u){var d=u.alternate;d!==null&&(u.alternate=null,d4(d)),u.child=null,u.deletions=null,u.sibling=null,u.tag===5&&(d=u.stateNode,d!==null&&(delete d[Bo],delete d[$g],delete d[o2],delete d[jz],delete d[Fz])),u.stateNode=null,u.return=null,u.dependencies=null,u.memoizedProps=null,u.memoizedState=null,u.pendingProps=null,u.stateNode=null,u.updateQueue=null}function f4(u){return u.tag===5||u.tag===3||u.tag===4}function g4(u){e:for(;;){for(;u.sibling===null;){if(u.return===null||f4(u.return))return null;u=u.return}for(u.sibling.return=u.return,u=u.sibling;u.tag!==5&&u.tag!==6&&u.tag!==18;){if(u.flags&2||u.child===null||u.tag===4)continue e;u.child.return=u,u=u.child}if(!(u.flags&2))return u.stateNode}}function H2(u,d,p){var E=u.tag;if(E===5||E===6)u=u.stateNode,d?p.nodeType===8?p.parentNode.insertBefore(u,d):p.insertBefore(u,d):(p.nodeType===8?(d=p.parentNode,d.insertBefore(u,p)):(d=p,d.appendChild(u)),p=p._reactRootContainer,p!=null||d.onclick!==null||(d.onclick=Ty));else if(E!==4&&(u=u.child,u!==null))for(H2(u,d,p),u=u.sibling;u!==null;)H2(u,d,p),u=u.sibling}function K2(u,d,p){var E=u.tag;if(E===5||E===6)u=u.stateNode,d?p.insertBefore(u,d):p.appendChild(u);else if(E!==4&&(u=u.child,u!==null))for(K2(u,d,p),u=u.sibling;u!==null;)K2(u,d,p),u=u.sibling}var Li=null,Ja=!1;function jc(u,d,p){for(p=p.child;p!==null;)m4(u,d,p),p=p.sibling}function m4(u,d,p){if(zr&&typeof zr.onCommitFiberUnmount=="function")try{zr.onCommitFiberUnmount(qs,p)}catch{}switch(p.tag){case 5:ts||_f(p,d);case 6:var E=Li,S=Ja;Li=null,jc(u,d,p),Li=E,Ja=S,Li!==null&&(Ja?(u=Li,p=p.stateNode,u.nodeType===8?u.parentNode.removeChild(p):u.removeChild(p)):Li.removeChild(p.stateNode));break;case 18:Li!==null&&(Ja?(u=Li,p=p.stateNode,u.nodeType===8?a2(u.parentNode,p):u.nodeType===1&&a2(u,p),Ac(u)):a2(Li,p.stateNode));break;case 4:E=Li,S=Ja,Li=p.stateNode.containerInfo,Ja=!0,jc(u,d,p),Li=E,Ja=S;break;case 0:case 11:case 14:case 15:if(!ts&&(E=p.updateQueue,E!==null&&(E=E.lastEffect,E!==null))){S=E=E.next;do{var I=S,U=I.destroy;I=I.tag,U!==void 0&&((I&2)!==0||(I&4)!==0)&&$2(p,d,U),S=S.next}while(S!==E)}jc(u,d,p);break;case 1:if(!ts&&(_f(p,d),E=p.stateNode,typeof E.componentWillUnmount=="function"))try{E.props=p.memoizedProps,E.state=p.memoizedState,E.componentWillUnmount()}catch(se){Lr(p,d,se)}jc(u,d,p);break;case 21:jc(u,d,p);break;case 22:p.mode&1?(ts=(E=ts)||p.memoizedState!==null,jc(u,d,p),ts=E):jc(u,d,p);break;default:jc(u,d,p)}}function p4(u){var d=u.updateQueue;if(d!==null){u.updateQueue=null;var p=u.stateNode;p===null&&(p=u.stateNode=new eU),d.forEach(function(E){var S=uU.bind(null,u,E);p.has(E)||(p.add(E),E.then(S,S))})}}function Qa(u,d){var p=d.deletions;if(p!==null)for(var E=0;E<p.length;E++){var S=p[E];try{var I=u,U=d,se=U;e:for(;se!==null;){switch(se.tag){case 5:Li=se.stateNode,Ja=!1;break e;case 3:Li=se.stateNode.containerInfo,Ja=!0;break e;case 4:Li=se.stateNode.containerInfo,Ja=!0;break e}se=se.return}if(Li===null)throw Error(t(160));m4(I,U,S),Li=null,Ja=!1;var ae=S.alternate;ae!==null&&(ae.return=null),S.return=null}catch(ke){Lr(S,d,ke)}}if(d.subtreeFlags&12854)for(d=d.child;d!==null;)y4(d,u),d=d.sibling}function y4(u,d){var p=u.alternate,E=u.flags;switch(u.tag){case 0:case 11:case 14:case 15:if(Qa(d,u),Uo(u),E&4){try{tm(3,u,u.return),Xy(3,u)}catch(Pt){Lr(u,u.return,Pt)}try{tm(5,u,u.return)}catch(Pt){Lr(u,u.return,Pt)}}break;case 1:Qa(d,u),Uo(u),E&512&&p!==null&&_f(p,p.return);break;case 5:if(Qa(d,u),Uo(u),E&512&&p!==null&&_f(p,p.return),u.flags&32){var S=u.stateNode;try{an(S,"")}catch(Pt){Lr(u,u.return,Pt)}}if(E&4&&(S=u.stateNode,S!=null)){var I=u.memoizedProps,U=p!==null?p.memoizedProps:I,se=u.type,ae=u.updateQueue;if(u.updateQueue=null,ae!==null)try{se==="input"&&I.type==="radio"&&I.name!=null&&Ht(S,I),Fe(se,U);var ke=Fe(se,I);for(U=0;U<ae.length;U+=2){var qe=ae[U],et=ae[U+1];qe==="style"?li(S,et):qe==="dangerouslySetInnerHTML"?Tt(S,et):qe==="children"?an(S,et):k(S,qe,et,ke)}switch(se){case"input":tt(S,I);break;case"textarea":br(S,I);break;case"select":var Ke=S._wrapperState.wasMultiple;S._wrapperState.wasMultiple=!!I.multiple;var vt=I.value;vt!=null?sr(S,!!I.multiple,vt,!1):Ke!==!!I.multiple&&(I.defaultValue!=null?sr(S,!!I.multiple,I.defaultValue,!0):sr(S,!!I.multiple,I.multiple?[]:"",!1))}S[$g]=I}catch(Pt){Lr(u,u.return,Pt)}}break;case 6:if(Qa(d,u),Uo(u),E&4){if(u.stateNode===null)throw Error(t(162));S=u.stateNode,I=u.memoizedProps;try{S.nodeValue=I}catch(Pt){Lr(u,u.return,Pt)}}break;case 3:if(Qa(d,u),Uo(u),E&4&&p!==null&&p.memoizedState.isDehydrated)try{Ac(d.containerInfo)}catch(Pt){Lr(u,u.return,Pt)}break;case 4:Qa(d,u),Uo(u);break;case 13:Qa(d,u),Uo(u),S=u.child,S.flags&8192&&(I=S.memoizedState!==null,S.stateNode.isHidden=I,!I||S.alternate!==null&&S.alternate.memoizedState!==null||(Y2=Je())),E&4&&p4(u);break;case 22:if(qe=p!==null&&p.memoizedState!==null,u.mode&1?(ts=(ke=ts)||qe,Qa(d,u),ts=ke):Qa(d,u),Uo(u),E&8192){if(ke=u.memoizedState!==null,(u.stateNode.isHidden=ke)&&!qe&&(u.mode&1)!==0)for(bt=u,qe=u.child;qe!==null;){for(et=bt=qe;bt!==null;){switch(Ke=bt,vt=Ke.child,Ke.tag){case 0:case 11:case 14:case 15:tm(4,Ke,Ke.return);break;case 1:_f(Ke,Ke.return);var kt=Ke.stateNode;if(typeof kt.componentWillUnmount=="function"){E=Ke,p=Ke.return;try{d=E,kt.props=d.memoizedProps,kt.state=d.memoizedState,kt.componentWillUnmount()}catch(Pt){Lr(E,p,Pt)}}break;case 5:_f(Ke,Ke.return);break;case 22:if(Ke.memoizedState!==null){v4(et);continue}}vt!==null?(vt.return=Ke,bt=vt):v4(et)}qe=qe.sibling}e:for(qe=null,et=u;;){if(et.tag===5){if(qe===null){qe=et;try{S=et.stateNode,ke?(I=S.style,typeof I.setProperty=="function"?I.setProperty("display","none","important"):I.display="none"):(se=et.stateNode,ae=et.memoizedProps.style,U=ae!=null&&ae.hasOwnProperty("display")?ae.display:null,se.style.display=Mr("display",U))}catch(Pt){Lr(u,u.return,Pt)}}}else if(et.tag===6){if(qe===null)try{et.stateNode.nodeValue=ke?"":et.memoizedProps}catch(Pt){Lr(u,u.return,Pt)}}else if((et.tag!==22&&et.tag!==23||et.memoizedState===null||et===u)&&et.child!==null){et.child.return=et,et=et.child;continue}if(et===u)break e;for(;et.sibling===null;){if(et.return===null||et.return===u)break e;qe===et&&(qe=null),et=et.return}qe===et&&(qe=null),et.sibling.return=et.return,et=et.sibling}}break;case 19:Qa(d,u),Uo(u),E&4&&p4(u);break;case 21:break;default:Qa(d,u),Uo(u)}}function Uo(u){var d=u.flags;if(d&2){try{e:{for(var p=u.return;p!==null;){if(f4(p)){var E=p;break e}p=p.return}throw Error(t(160))}switch(E.tag){case 5:var S=E.stateNode;E.flags&32&&(an(S,""),E.flags&=-33);var I=g4(u);K2(u,I,S);break;case 3:case 4:var U=E.stateNode.containerInfo,se=g4(u);H2(u,se,U);break;default:throw Error(t(161))}}catch(ae){Lr(u,u.return,ae)}u.flags&=-3}d&4096&&(u.flags&=-4097)}function nU(u,d,p){bt=u,x4(u)}function x4(u,d,p){for(var E=(u.mode&1)!==0;bt!==null;){var S=bt,I=S.child;if(S.tag===22&&E){var U=S.memoizedState!==null||Ky;if(!U){var se=S.alternate,ae=se!==null&&se.memoizedState!==null||ts;se=Ky;var ke=ts;if(Ky=U,(ts=ae)&&!ke)for(bt=S;bt!==null;)U=bt,ae=U.child,U.tag===22&&U.memoizedState!==null?w4(S):ae!==null?(ae.return=U,bt=ae):w4(S);for(;I!==null;)bt=I,x4(I),I=I.sibling;bt=S,Ky=se,ts=ke}_4(u)}else(S.subtreeFlags&8772)!==0&&I!==null?(I.return=S,bt=I):_4(u)}}function _4(u){for(;bt!==null;){var d=bt;if((d.flags&8772)!==0){var p=d.alternate;try{if((d.flags&8772)!==0)switch(d.tag){case 0:case 11:case 15:ts||Xy(5,d);break;case 1:var E=d.stateNode;if(d.flags&4&&!ts)if(p===null)E.componentDidMount();else{var S=d.elementType===d.type?p.memoizedProps:Za(d.type,p.memoizedProps);E.componentDidUpdate(S,p.memoizedState,E.__reactInternalSnapshotBeforeUpdate)}var I=d.updateQueue;I!==null&&vP(d,I,E);break;case 3:var U=d.updateQueue;if(U!==null){if(p=null,d.child!==null)switch(d.child.tag){case 5:p=d.child.stateNode;break;case 1:p=d.child.stateNode}vP(d,U,p)}break;case 5:var se=d.stateNode;if(p===null&&d.flags&4){p=se;var ae=d.memoizedProps;switch(d.type){case"button":case"input":case"select":case"textarea":ae.autoFocus&&p.focus();break;case"img":ae.src&&(p.src=ae.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(d.memoizedState===null){var ke=d.alternate;if(ke!==null){var qe=ke.memoizedState;if(qe!==null){var et=qe.dehydrated;et!==null&&Ac(et)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}ts||d.flags&512&&W2(d)}catch(Ke){Lr(d,d.return,Ke)}}if(d===u){bt=null;break}if(p=d.sibling,p!==null){p.return=d.return,bt=p;break}bt=d.return}}function v4(u){for(;bt!==null;){var d=bt;if(d===u){bt=null;break}var p=d.sibling;if(p!==null){p.return=d.return,bt=p;break}bt=d.return}}function w4(u){for(;bt!==null;){var d=bt;try{switch(d.tag){case 0:case 11:case 15:var p=d.return;try{Xy(4,d)}catch(ae){Lr(d,p,ae)}break;case 1:var E=d.stateNode;if(typeof E.componentDidMount=="function"){var S=d.return;try{E.componentDidMount()}catch(ae){Lr(d,S,ae)}}var I=d.return;try{W2(d)}catch(ae){Lr(d,I,ae)}break;case 5:var U=d.return;try{W2(d)}catch(ae){Lr(d,U,ae)}}}catch(ae){Lr(d,d.return,ae)}if(d===u){bt=null;break}var se=d.sibling;if(se!==null){se.return=d.return,bt=se;break}bt=d.return}}var rU=Math.ceil,qy=L.ReactCurrentDispatcher,X2=L.ReactCurrentOwner,ba=L.ReactCurrentBatchConfig,Cn=0,_i=null,Yr=null,Oi=0,na=0,vf=Nc(0),ui=0,nm=null,mh=0,Yy=0,q2=0,rm=null,Is=null,Y2=0,wf=1/0,Ll=null,Zy=!1,Z2=null,Fc=null,Jy=!1,Vc=null,Qy=0,im=0,J2=null,ex=-1,tx=0;function ys(){return(Cn&6)!==0?Je():ex!==-1?ex:ex=Je()}function Bc(u){return(u.mode&1)===0?1:(Cn&2)!==0&&Oi!==0?Oi&-Oi:Bz.transition!==null?(tx===0&&(tx=Tg()),tx):(u=En,u!==0||(u=window.event,u=u===void 0?16:qd(u.type)),u)}function eo(u,d,p,E){if(50<im)throw im=0,J2=null,Error(t(185));rh(u,p,E),((Cn&2)===0||u!==_i)&&(u===_i&&((Cn&2)===0&&(Yy|=p),ui===4&&Gc(u,Oi)),Cs(u,E),p===1&&Cn===0&&(d.mode&1)===0&&(wf=Je()+500,Iy&&Lc()))}function Cs(u,d){var p=u.callbackNode;nh(u,d);var E=wl(u,u===_i?Oi:0);if(E===0)p!==null&&st(p),u.callbackNode=null,u.callbackPriority=0;else if(d=E&-E,u.callbackPriority!==d){if(p!=null&&st(p),d===1)u.tag===0?Vz(S4.bind(null,u)):lP(S4.bind(null,u)),Oz(function(){(Cn&6)===0&&Lc()}),p=null;else{switch(Co(E)){case 1:p=zn;break;case 4:p=Kn;break;case 16:p=yr;break;case 536870912:p=xa;break;default:p=yr}p=P4(p,E4.bind(null,u))}u.callbackPriority=d,u.callbackNode=p}}function E4(u,d){if(ex=-1,tx=0,(Cn&6)!==0)throw Error(t(327));var p=u.callbackNode;if(Ef()&&u.callbackNode!==p)return null;var E=wl(u,u===_i?Oi:0);if(E===0)return null;if((E&30)!==0||(E&u.expiredLanes)!==0||d)d=nx(u,E);else{d=E;var S=Cn;Cn|=2;var I=T4();(_i!==u||Oi!==d)&&(Ll=null,wf=Je()+500,yh(u,d));do try{aU();break}catch(se){b4(u,se)}while(!0);p2(),qy.current=I,Cn=S,Yr!==null?d=0:(_i=null,Oi=0,d=ui)}if(d!==0){if(d===2&&(S=bg(u),S!==0&&(E=S,d=Q2(u,S))),d===1)throw p=nm,yh(u,0),Gc(u,E),Cs(u,Je()),p;if(d===6)Gc(u,E);else{if(S=u.current.alternate,(E&30)===0&&!iU(S)&&(d=nx(u,E),d===2&&(I=bg(u),I!==0&&(E=I,d=Q2(u,I))),d===1))throw p=nm,yh(u,0),Gc(u,E),Cs(u,Je()),p;switch(u.finishedWork=S,u.finishedLanes=E,d){case 0:case 1:throw Error(t(345));case 2:xh(u,Is,Ll);break;case 3:if(Gc(u,E),(E&130023424)===E&&(d=Y2+500-Je(),10<d)){if(wl(u,0)!==0)break;if(S=u.suspendedLanes,(S&E)!==E){ys(),u.pingedLanes|=u.suspendedLanes&S;break}u.timeoutHandle=s2(xh.bind(null,u,Is,Ll),d);break}xh(u,Is,Ll);break;case 4:if(Gc(u,E),(E&4194240)===E)break;for(d=u.eventTimes,S=-1;0<E;){var U=31-Rr(E);I=1<<U,U=d[U],U>S&&(S=U),E&=~I}if(E=S,E=Je()-E,E=(120>E?120:480>E?480:1080>E?1080:1920>E?1920:3e3>E?3e3:4320>E?4320:1960*rU(E/1960))-E,10<E){u.timeoutHandle=s2(xh.bind(null,u,Is,Ll),E);break}xh(u,Is,Ll);break;case 5:xh(u,Is,Ll);break;default:throw Error(t(329))}}}return Cs(u,Je()),u.callbackNode===p?E4.bind(null,u):null}function Q2(u,d){var p=rm;return u.current.memoizedState.isDehydrated&&(yh(u,d).flags|=256),u=nx(u,d),u!==2&&(d=Is,Is=p,d!==null&&eS(d)),u}function eS(u){Is===null?Is=u:Is.push.apply(Is,u)}function iU(u){for(var d=u;;){if(d.flags&16384){var p=d.updateQueue;if(p!==null&&(p=p.stores,p!==null))for(var E=0;E<p.length;E++){var S=p[E],I=S.getSnapshot;S=S.value;try{if(!qa(I(),S))return!1}catch{return!1}}}if(p=d.child,d.subtreeFlags&16384&&p!==null)p.return=d,d=p;else{if(d===u)break;for(;d.sibling===null;){if(d.return===null||d.return===u)return!0;d=d.return}d.sibling.return=d.return,d=d.sibling}}return!0}function Gc(u,d){for(d&=~q2,d&=~Yy,u.suspendedLanes|=d,u.pingedLanes&=~d,u=u.expirationTimes;0<d;){var p=31-Rr(d),E=1<<p;u[p]=-1,d&=~E}}function S4(u){if((Cn&6)!==0)throw Error(t(327));Ef();var d=wl(u,0);if((d&1)===0)return Cs(u,Je()),null;var p=nx(u,d);if(u.tag!==0&&p===2){var E=bg(u);E!==0&&(d=E,p=Q2(u,E))}if(p===1)throw p=nm,yh(u,0),Gc(u,d),Cs(u,Je()),p;if(p===6)throw Error(t(345));return u.finishedWork=u.current.alternate,u.finishedLanes=d,xh(u,Is,Ll),Cs(u,Je()),null}function tS(u,d){var p=Cn;Cn|=1;try{return u(d)}finally{Cn=p,Cn===0&&(wf=Je()+500,Iy&&Lc())}}function ph(u){Vc!==null&&Vc.tag===0&&(Cn&6)===0&&Ef();var d=Cn;Cn|=1;var p=ba.transition,E=En;try{if(ba.transition=null,En=1,u)return u()}finally{En=E,ba.transition=p,Cn=d,(Cn&6)===0&&Lc()}}function nS(){na=vf.current,fr(vf)}function yh(u,d){u.finishedWork=null,u.finishedLanes=0;var p=u.timeoutHandle;if(p!==-1&&(u.timeoutHandle=-1,Lz(p)),Yr!==null)for(p=Yr.return;p!==null;){var E=p;switch(h2(E),E.tag){case 1:E=E.type.childContextTypes,E!=null&&Ay();break;case 3:yf(),fr(Rs),fr(Ji),b2();break;case 5:E2(E);break;case 4:yf();break;case 13:fr(Ar);break;case 19:fr(Ar);break;case 10:y2(E.type._context);break;case 22:case 23:nS()}p=p.return}if(_i=u,Yr=u=zc(u.current,null),Oi=na=d,ui=0,nm=null,q2=Yy=mh=0,Is=rm=null,dh!==null){for(d=0;d<dh.length;d++)if(p=dh[d],E=p.interleaved,E!==null){p.interleaved=null;var S=E.next,I=p.pending;if(I!==null){var U=I.next;I.next=S,E.next=U}p.pending=E}dh=null}return u}function b4(u,d){do{var p=Yr;try{if(p2(),Vy.current=Uy,By){for(var E=kr.memoizedState;E!==null;){var S=E.queue;S!==null&&(S.pending=null),E=E.next}By=!1}if(gh=0,xi=ci=kr=null,Yg=!1,Zg=0,X2.current=null,p===null||p.return===null){ui=1,nm=d,Yr=null;break}e:{var I=u,U=p.return,se=p,ae=d;if(d=Oi,se.flags|=32768,ae!==null&&typeof ae=="object"&&typeof ae.then=="function"){var ke=ae,qe=se,et=qe.tag;if((qe.mode&1)===0&&(et===0||et===11||et===15)){var Ke=qe.alternate;Ke?(qe.updateQueue=Ke.updateQueue,qe.memoizedState=Ke.memoizedState,qe.lanes=Ke.lanes):(qe.updateQueue=null,qe.memoizedState=null)}var vt=qP(U);if(vt!==null){vt.flags&=-257,YP(vt,U,se,I,d),vt.mode&1&&XP(I,ke,d),d=vt,ae=ke;var kt=d.updateQueue;if(kt===null){var Pt=new Set;Pt.add(ae),d.updateQueue=Pt}else kt.add(ae);break e}else{if((d&1)===0){XP(I,ke,d),rS();break e}ae=Error(t(426))}}else if(xr&&se.mode&1){var $r=qP(U);if($r!==null){($r.flags&65536)===0&&($r.flags|=256),YP($r,U,se,I,d),g2(xf(ae,se));break e}}I=ae=xf(ae,se),ui!==4&&(ui=2),rm===null?rm=[I]:rm.push(I),I=U;do{switch(I.tag){case 3:I.flags|=65536,d&=-d,I.lanes|=d;var fe=HP(I,ae,d);_P(I,fe);break e;case 1:se=ae;var oe=I.type,Se=I.stateNode;if((I.flags&128)===0&&(typeof oe.getDerivedStateFromError=="function"||Se!==null&&typeof Se.componentDidCatch=="function"&&(Fc===null||!Fc.has(Se)))){I.flags|=65536,d&=-d,I.lanes|=d;var it=KP(I,se,d);_P(I,it);break e}}I=I.return}while(I!==null)}A4(p)}catch(Mt){d=Mt,Yr===p&&p!==null&&(Yr=p=p.return);continue}break}while(!0)}function T4(){var u=qy.current;return qy.current=Uy,u===null?Uy:u}function rS(){(ui===0||ui===3||ui===2)&&(ui=4),_i===null||(mh&268435455)===0&&(Yy&268435455)===0||Gc(_i,Oi)}function nx(u,d){var p=Cn;Cn|=2;var E=T4();(_i!==u||Oi!==d)&&(Ll=null,yh(u,d));do try{sU();break}catch(S){b4(u,S)}while(!0);if(p2(),Cn=p,qy.current=E,Yr!==null)throw Error(t(261));return _i=null,Oi=0,ui}function sU(){for(;Yr!==null;)R4(Yr)}function aU(){for(;Yr!==null&&!pt();)R4(Yr)}function R4(u){var d=C4(u.alternate,u,na);u.memoizedProps=u.pendingProps,d===null?A4(u):Yr=d,X2.current=null}function A4(u){var d=u;do{var p=d.alternate;if(u=d.return,(d.flags&32768)===0){if(p=Jz(p,d,na),p!==null){Yr=p;return}}else{if(p=Qz(p,d),p!==null){p.flags&=32767,Yr=p;return}if(u!==null)u.flags|=32768,u.subtreeFlags=0,u.deletions=null;else{ui=6,Yr=null;return}}if(d=d.sibling,d!==null){Yr=d;return}Yr=d=u}while(d!==null);ui===0&&(ui=5)}function xh(u,d,p){var E=En,S=ba.transition;try{ba.transition=null,En=1,oU(u,d,p,E)}finally{ba.transition=S,En=E}return null}function oU(u,d,p,E){do Ef();while(Vc!==null);if((Cn&6)!==0)throw Error(t(327));p=u.finishedWork;var S=u.finishedLanes;if(p===null)return null;if(u.finishedWork=null,u.finishedLanes=0,p===u.current)throw Error(t(177));u.callbackNode=null,u.callbackPriority=0;var I=p.lanes|p.childLanes;if(UE(u,I),u===_i&&(Yr=_i=null,Oi=0),(p.subtreeFlags&2064)===0&&(p.flags&2064)===0||Jy||(Jy=!0,P4(yr,function(){return Ef(),null})),I=(p.flags&15990)!==0,(p.subtreeFlags&15990)!==0||I){I=ba.transition,ba.transition=null;var U=En;En=1;var se=Cn;Cn|=4,X2.current=null,tU(u,p),y4(p,u),Az(r2),bl=!!n2,r2=n2=null,u.current=p,nU(p),Ze(),Cn=se,En=U,ba.transition=I}else u.current=p;if(Jy&&(Jy=!1,Vc=u,Qy=S),I=u.pendingLanes,I===0&&(Fc=null),Sc(p.stateNode),Cs(u,Je()),d!==null)for(E=u.onRecoverableError,p=0;p<d.length;p++)S=d[p],E(S.value,{componentStack:S.stack,digest:S.digest});if(Zy)throw Zy=!1,u=Z2,Z2=null,u;return(Qy&1)!==0&&u.tag!==0&&Ef(),I=u.pendingLanes,(I&1)!==0?u===J2?im++:(im=0,J2=u):im=0,Lc(),null}function Ef(){if(Vc!==null){var u=Co(Qy),d=ba.transition,p=En;try{if(ba.transition=null,En=16>u?16:u,Vc===null)var E=!1;else{if(u=Vc,Vc=null,Qy=0,(Cn&6)!==0)throw Error(t(331));var S=Cn;for(Cn|=4,bt=u.current;bt!==null;){var I=bt,U=I.child;if((bt.flags&16)!==0){var se=I.deletions;if(se!==null){for(var ae=0;ae<se.length;ae++){var ke=se[ae];for(bt=ke;bt!==null;){var qe=bt;switch(qe.tag){case 0:case 11:case 15:tm(8,qe,I)}var et=qe.child;if(et!==null)et.return=qe,bt=et;else for(;bt!==null;){qe=bt;var Ke=qe.sibling,vt=qe.return;if(d4(qe),qe===ke){bt=null;break}if(Ke!==null){Ke.return=vt,bt=Ke;break}bt=vt}}}var kt=I.alternate;if(kt!==null){var Pt=kt.child;if(Pt!==null){kt.child=null;do{var $r=Pt.sibling;Pt.sibling=null,Pt=$r}while(Pt!==null)}}bt=I}}if((I.subtreeFlags&2064)!==0&&U!==null)U.return=I,bt=U;else e:for(;bt!==null;){if(I=bt,(I.flags&2048)!==0)switch(I.tag){case 0:case 11:case 15:tm(9,I,I.return)}var fe=I.sibling;if(fe!==null){fe.return=I.return,bt=fe;break e}bt=I.return}}var oe=u.current;for(bt=oe;bt!==null;){U=bt;var Se=U.child;if((U.subtreeFlags&2064)!==0&&Se!==null)Se.return=U,bt=Se;else e:for(U=oe;bt!==null;){if(se=bt,(se.flags&2048)!==0)try{switch(se.tag){case 0:case 11:case 15:Xy(9,se)}}catch(Mt){Lr(se,se.return,Mt)}if(se===U){bt=null;break e}var it=se.sibling;if(it!==null){it.return=se.return,bt=it;break e}bt=se.return}}if(Cn=S,Lc(),zr&&typeof zr.onPostCommitFiberRoot=="function")try{zr.onPostCommitFiberRoot(qs,u)}catch{}E=!0}return E}finally{En=p,ba.transition=d}}return!1}function k4(u,d,p){d=xf(p,d),d=HP(u,d,1),u=Dc(u,d,1),d=ys(),u!==null&&(rh(u,1,d),Cs(u,d))}function Lr(u,d,p){if(u.tag===3)k4(u,u,p);else for(;d!==null;){if(d.tag===3){k4(d,u,p);break}else if(d.tag===1){var E=d.stateNode;if(typeof d.type.getDerivedStateFromError=="function"||typeof E.componentDidCatch=="function"&&(Fc===null||!Fc.has(E))){u=xf(p,u),u=KP(d,u,1),d=Dc(d,u,1),u=ys(),d!==null&&(rh(d,1,u),Cs(d,u));break}}d=d.return}}function lU(u,d,p){var E=u.pingCache;E!==null&&E.delete(d),d=ys(),u.pingedLanes|=u.suspendedLanes&p,_i===u&&(Oi&p)===p&&(ui===4||ui===3&&(Oi&130023424)===Oi&&500>Je()-Y2?yh(u,0):q2|=p),Cs(u,d)}function I4(u,d){d===0&&((u.mode&1)===0?d=1:(d=bc,bc<<=1,(bc&130023424)===0&&(bc=4194304)));var p=ys();u=Pl(u,d),u!==null&&(rh(u,d,p),Cs(u,p))}function cU(u){var d=u.memoizedState,p=0;d!==null&&(p=d.retryLane),I4(u,p)}function uU(u,d){var p=0;switch(u.tag){case 13:var E=u.stateNode,S=u.memoizedState;S!==null&&(p=S.retryLane);break;case 19:E=u.stateNode;break;default:throw Error(t(314))}E!==null&&E.delete(d),I4(u,p)}var C4;C4=function(u,d,p){if(u!==null)if(u.memoizedProps!==d.pendingProps||Rs.current)ks=!0;else{if((u.lanes&p)===0&&(d.flags&128)===0)return ks=!1,Zz(u,d,p);ks=(u.flags&131072)!==0}else ks=!1,xr&&(d.flags&1048576)!==0&&cP(d,Py,d.index);switch(d.lanes=0,d.tag){case 2:var E=d.type;Hy(u,d),u=d.pendingProps;var S=uf(d,Ji.current);pf(d,p),S=A2(null,d,E,u,S,p);var I=k2();return d.flags|=1,typeof S=="object"&&S!==null&&typeof S.render=="function"&&S.$$typeof===void 0?(d.tag=1,d.memoizedState=null,d.updateQueue=null,As(E)?(I=!0,ky(d)):I=!1,d.memoizedState=S.state!==null&&S.state!==void 0?S.state:null,v2(d),S.updater=$y,d.stateNode=S,S._reactInternals=d,L2(d,E,u,p),d=F2(null,d,E,!0,I,p)):(d.tag=0,xr&&I&&u2(d),ps(null,d,S,p),d=d.child),d;case 16:E=d.elementType;e:{switch(Hy(u,d),u=d.pendingProps,S=E._init,E=S(E._payload),d.type=E,S=d.tag=dU(E),u=Za(E,u),S){case 0:d=j2(null,d,E,u,p);break e;case 1:d=n4(null,d,E,u,p);break e;case 11:d=ZP(null,d,E,u,p);break e;case 14:d=JP(null,d,E,Za(E.type,u),p);break e}throw Error(t(306,E,""))}return d;case 0:return E=d.type,S=d.pendingProps,S=d.elementType===E?S:Za(E,S),j2(u,d,E,S,p);case 1:return E=d.type,S=d.pendingProps,S=d.elementType===E?S:Za(E,S),n4(u,d,E,S,p);case 3:e:{if(r4(d),u===null)throw Error(t(387));E=d.pendingProps,I=d.memoizedState,S=I.element,xP(u,d),jy(d,E,null,p);var U=d.memoizedState;if(E=U.element,I.isDehydrated)if(I={element:E,isDehydrated:!1,cache:U.cache,pendingSuspenseBoundaries:U.pendingSuspenseBoundaries,transitions:U.transitions},d.updateQueue.baseState=I,d.memoizedState=I,d.flags&256){S=xf(Error(t(423)),d),d=i4(u,d,E,p,S);break e}else if(E!==S){S=xf(Error(t(424)),d),d=i4(u,d,E,p,S);break e}else for(ta=Pc(d.stateNode.containerInfo.firstChild),ea=d,xr=!0,Ya=null,p=pP(d,null,E,p),d.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling;else{if(ff(),E===S){d=Ml(u,d,p);break e}ps(u,d,E,p)}d=d.child}return d;case 5:return wP(d),u===null&&f2(d),E=d.type,S=d.pendingProps,I=u!==null?u.memoizedProps:null,U=S.children,i2(E,S)?U=null:I!==null&&i2(E,I)&&(d.flags|=32),t4(u,d),ps(u,d,U,p),d.child;case 6:return u===null&&f2(d),null;case 13:return s4(u,d,p);case 4:return w2(d,d.stateNode.containerInfo),E=d.pendingProps,u===null?d.child=gf(d,null,E,p):ps(u,d,E,p),d.child;case 11:return E=d.type,S=d.pendingProps,S=d.elementType===E?S:Za(E,S),ZP(u,d,E,S,p);case 7:return ps(u,d,d.pendingProps,p),d.child;case 8:return ps(u,d,d.pendingProps.children,p),d.child;case 12:return ps(u,d,d.pendingProps.children,p),d.child;case 10:e:{if(E=d.type._context,S=d.pendingProps,I=d.memoizedProps,U=S.value,cr(Ly,E._currentValue),E._currentValue=U,I!==null)if(qa(I.value,U)){if(I.children===S.children&&!Rs.current){d=Ml(u,d,p);break e}}else for(I=d.child,I!==null&&(I.return=d);I!==null;){var se=I.dependencies;if(se!==null){U=I.child;for(var ae=se.firstContext;ae!==null;){if(ae.context===E){if(I.tag===1){ae=Nl(-1,p&-p),ae.tag=2;var ke=I.updateQueue;if(ke!==null){ke=ke.shared;var qe=ke.pending;qe===null?ae.next=ae:(ae.next=qe.next,qe.next=ae),ke.pending=ae}}I.lanes|=p,ae=I.alternate,ae!==null&&(ae.lanes|=p),x2(I.return,p,d),se.lanes|=p;break}ae=ae.next}}else if(I.tag===10)U=I.type===d.type?null:I.child;else if(I.tag===18){if(U=I.return,U===null)throw Error(t(341));U.lanes|=p,se=U.alternate,se!==null&&(se.lanes|=p),x2(U,p,d),U=I.sibling}else U=I.child;if(U!==null)U.return=I;else for(U=I;U!==null;){if(U===d){U=null;break}if(I=U.sibling,I!==null){I.return=U.return,U=I;break}U=U.return}I=U}ps(u,d,S.children,p),d=d.child}return d;case 9:return S=d.type,E=d.pendingProps.children,pf(d,p),S=Ea(S),E=E(S),d.flags|=1,ps(u,d,E,p),d.child;case 14:return E=d.type,S=Za(E,d.pendingProps),S=Za(E.type,S),JP(u,d,E,S,p);case 15:return QP(u,d,d.type,d.pendingProps,p);case 17:return E=d.type,S=d.pendingProps,S=d.elementType===E?S:Za(E,S),Hy(u,d),d.tag=1,As(E)?(u=!0,ky(d)):u=!1,pf(d,p),$P(d,E,S),L2(d,E,S,p),F2(null,d,E,!0,u,p);case 19:return o4(u,d,p);case 22:return e4(u,d,p)}throw Error(t(156,d.tag))};function P4(u,d){return Ye(u,d)}function hU(u,d,p,E){this.tag=u,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=d,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=E,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ta(u,d,p,E){return new hU(u,d,p,E)}function iS(u){return u=u.prototype,!(!u||!u.isReactComponent)}function dU(u){if(typeof u=="function")return iS(u)?1:0;if(u!=null){if(u=u.$$typeof,u===G)return 11;if(u===ce)return 14}return 2}function zc(u,d){var p=u.alternate;return p===null?(p=Ta(u.tag,d,u.key,u.mode),p.elementType=u.elementType,p.type=u.type,p.stateNode=u.stateNode,p.alternate=u,u.alternate=p):(p.pendingProps=d,p.type=u.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=u.flags&14680064,p.childLanes=u.childLanes,p.lanes=u.lanes,p.child=u.child,p.memoizedProps=u.memoizedProps,p.memoizedState=u.memoizedState,p.updateQueue=u.updateQueue,d=u.dependencies,p.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext},p.sibling=u.sibling,p.index=u.index,p.ref=u.ref,p}function rx(u,d,p,E,S,I){var U=2;if(E=u,typeof u=="function")iS(u)&&(U=1);else if(typeof u=="string")U=5;else e:switch(u){case R:return _h(p.children,S,I,d);case A:U=8,S|=8;break;case P:return u=Ta(12,p,d,S|2),u.elementType=P,u.lanes=I,u;case j:return u=Ta(13,p,d,S),u.elementType=j,u.lanes=I,u;case ve:return u=Ta(19,p,d,S),u.elementType=ve,u.lanes=I,u;case Pe:return ix(p,S,I,d);default:if(typeof u=="object"&&u!==null)switch(u.$$typeof){case D:U=10;break e;case N:U=9;break e;case G:U=11;break e;case ce:U=14;break e;case je:U=16,E=null;break e}throw Error(t(130,u==null?u:typeof u,""))}return d=Ta(U,p,d,S),d.elementType=u,d.type=E,d.lanes=I,d}function _h(u,d,p,E){return u=Ta(7,u,E,d),u.lanes=p,u}function ix(u,d,p,E){return u=Ta(22,u,E,d),u.elementType=Pe,u.lanes=p,u.stateNode={isHidden:!1},u}function sS(u,d,p){return u=Ta(6,u,null,d),u.lanes=p,u}function aS(u,d,p){return d=Ta(4,u.children!==null?u.children:[],u.key,d),d.lanes=p,d.stateNode={containerInfo:u.containerInfo,pendingChildren:null,implementation:u.implementation},d}function fU(u,d,p,E,S){this.tag=d,this.containerInfo=u,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Rg(0),this.expirationTimes=Rg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Rg(0),this.identifierPrefix=E,this.onRecoverableError=S,this.mutableSourceEagerHydrationData=null}function oS(u,d,p,E,S,I,U,se,ae){return u=new fU(u,d,p,se,ae),d===1?(d=1,I===!0&&(d|=8)):d=0,I=Ta(3,null,null,d),u.current=I,I.stateNode=u,I.memoizedState={element:E,isDehydrated:p,cache:null,transitions:null,pendingSuspenseBoundaries:null},v2(I),u}function gU(u,d,p){var E=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:B,key:E==null?null:""+E,children:u,containerInfo:d,implementation:p}}function N4(u){if(!u)return Mc;u=u._reactInternals;e:{if(ee(u)!==u||u.tag!==1)throw Error(t(170));var d=u;do{switch(d.tag){case 3:d=d.stateNode.context;break e;case 1:if(As(d.type)){d=d.stateNode.__reactInternalMemoizedMergedChildContext;break e}}d=d.return}while(d!==null);throw Error(t(171))}if(u.tag===1){var p=u.type;if(As(p))return aP(u,p,d)}return d}function M4(u,d,p,E,S,I,U,se,ae){return u=oS(p,E,!0,u,S,I,U,se,ae),u.context=N4(null),p=u.current,E=ys(),S=Bc(p),I=Nl(E,S),I.callback=d??null,Dc(p,I,S),u.current.lanes=S,rh(u,S,E),Cs(u,E),u}function sx(u,d,p,E){var S=d.current,I=ys(),U=Bc(S);return p=N4(p),d.context===null?d.context=p:d.pendingContext=p,d=Nl(I,U),d.payload={element:u},E=E===void 0?null:E,E!==null&&(d.callback=E),u=Dc(S,d,U),u!==null&&(eo(u,S,U,I),Dy(u,S,U)),U}function ax(u){if(u=u.current,!u.child)return null;switch(u.child.tag){case 5:return u.child.stateNode;default:return u.child.stateNode}}function L4(u,d){if(u=u.memoizedState,u!==null&&u.dehydrated!==null){var p=u.retryLane;u.retryLane=p!==0&&p<d?p:d}}function lS(u,d){L4(u,d),(u=u.alternate)&&L4(u,d)}function mU(){return null}var O4=typeof reportError=="function"?reportError:function(u){console.error(u)};function cS(u){this._internalRoot=u}ox.prototype.render=cS.prototype.render=function(u){var d=this._internalRoot;if(d===null)throw Error(t(409));sx(u,d,null,null)},ox.prototype.unmount=cS.prototype.unmount=function(){var u=this._internalRoot;if(u!==null){this._internalRoot=null;var d=u.containerInfo;ph(function(){sx(null,u,null,null)}),d[Al]=null}};function ox(u){this._internalRoot=u}ox.prototype.unstable_scheduleHydration=function(u){if(u){var d=Cg();u={blockedOn:null,target:u,priority:d};for(var p=0;p<Ys.length&&d!==0&&d<Ys[p].priority;p++);Ys.splice(p,0,u),p===0&&Kd(u)}};function uS(u){return!(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)}function lx(u){return!(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11&&(u.nodeType!==8||u.nodeValue!==" react-mount-point-unstable "))}function D4(){}function pU(u,d,p,E,S){if(S){if(typeof E=="function"){var I=E;E=function(){var ke=ax(U);I.call(ke)}}var U=M4(d,E,u,0,null,!1,!1,"",D4);return u._reactRootContainer=U,u[Al]=U.current,zg(u.nodeType===8?u.parentNode:u),ph(),U}for(;S=u.lastChild;)u.removeChild(S);if(typeof E=="function"){var se=E;E=function(){var ke=ax(ae);se.call(ke)}}var ae=oS(u,0,!1,null,null,!1,!1,"",D4);return u._reactRootContainer=ae,u[Al]=ae.current,zg(u.nodeType===8?u.parentNode:u),ph(function(){sx(d,ae,p,E)}),ae}function cx(u,d,p,E,S){var I=p._reactRootContainer;if(I){var U=I;if(typeof S=="function"){var se=S;S=function(){var ae=ax(U);se.call(ae)}}sx(d,U,u,S)}else U=pU(p,d,u,S,E);return ax(U)}kg=function(u){switch(u.tag){case 3:var d=u.stateNode;if(d.current.memoizedState.isDehydrated){var p=On(d.pendingLanes);p!==0&&(Ag(d,p|1),Cs(d,Je()),(Cn&6)===0&&(wf=Je()+500,Lc()))}break;case 13:ph(function(){var E=Pl(u,1);if(E!==null){var S=ys();eo(E,u,1,S)}}),lS(u,1)}},Wd=function(u){if(u.tag===13){var d=Pl(u,134217728);if(d!==null){var p=ys();eo(d,u,134217728,p)}lS(u,134217728)}},Ig=function(u){if(u.tag===13){var d=Bc(u),p=Pl(u,d);if(p!==null){var E=ys();eo(p,u,d,E)}lS(u,d)}},Cg=function(){return En},Pg=function(u,d){var p=En;try{return En=u,d()}finally{En=p}},Dt=function(u,d,p){switch(d){case"input":if(tt(u,p),d=p.name,p.type==="radio"&&d!=null){for(p=u;p.parentNode;)p=p.parentNode;for(p=p.querySelectorAll("input[name="+JSON.stringify(""+d)+'][type="radio"]'),d=0;d<p.length;d++){var E=p[d];if(E!==u&&E.form===u.form){var S=Ry(E);if(!S)throw Error(t(90));Ve(E),tt(E,S)}}}break;case"textarea":br(u,p);break;case"select":d=p.value,d!=null&&sr(u,!!p.multiple,d,!1)}},q=tS,le=ph;var yU={usingClientEntryPoint:!1,Events:[Wg,lf,Ry,ne,Ce,tS]},sm={findFiberByHostInstance:lh,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},xU={bundleType:sm.bundleType,version:sm.version,rendererPackageName:sm.rendererPackageName,rendererConfig:sm.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:L.ReactCurrentDispatcher,findHostInstanceByFiber:function(u){return u=Te(u),u===null?null:u.stateNode},findFiberByHostInstance:sm.findFiberByHostInstance||mU,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ux=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ux.isDisabled&&ux.supportsFiber)try{qs=ux.inject(xU),zr=ux}catch{}}return Ps.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=yU,Ps.createPortal=function(u,d){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!uS(d))throw Error(t(200));return gU(u,d,null,p)},Ps.createRoot=function(u,d){if(!uS(u))throw Error(t(299));var p=!1,E="",S=O4;return d!=null&&(d.unstable_strictMode===!0&&(p=!0),d.identifierPrefix!==void 0&&(E=d.identifierPrefix),d.onRecoverableError!==void 0&&(S=d.onRecoverableError)),d=oS(u,1,!1,null,null,p,!1,E,S),u[Al]=d.current,zg(u.nodeType===8?u.parentNode:u),new cS(d)},Ps.findDOMNode=function(u){if(u==null)return null;if(u.nodeType===1)return u;var d=u._reactInternals;if(d===void 0)throw typeof u.render=="function"?Error(t(188)):(u=Object.keys(u).join(","),Error(t(268,u)));return u=Te(d),u=u===null?null:u.stateNode,u},Ps.flushSync=function(u){return ph(u)},Ps.hydrate=function(u,d,p){if(!lx(d))throw Error(t(200));return cx(null,u,d,!0,p)},Ps.hydrateRoot=function(u,d,p){if(!uS(u))throw Error(t(405));var E=p!=null&&p.hydratedSources||null,S=!1,I="",U=O4;if(p!=null&&(p.unstable_strictMode===!0&&(S=!0),p.identifierPrefix!==void 0&&(I=p.identifierPrefix),p.onRecoverableError!==void 0&&(U=p.onRecoverableError)),d=M4(d,null,u,1,p??null,S,!1,I,U),u[Al]=d.current,zg(u),E)for(u=0;u<E.length;u++)p=E[u],S=p._getVersion,S=S(p._source),d.mutableSourceEagerHydrationData==null?d.mutableSourceEagerHydrationData=[p,S]:d.mutableSourceEagerHydrationData.push(p,S);return new ox(d)},Ps.render=function(u,d,p){if(!lx(d))throw Error(t(200));return cx(null,u,d,!1,p)},Ps.unmountComponentAtNode=function(u){if(!lx(u))throw Error(t(40));return u._reactRootContainer?(ph(function(){cx(null,null,u,!1,function(){u._reactRootContainer=null,u[Al]=null})}),!0):!1},Ps.unstable_batchedUpdates=tS,Ps.unstable_renderSubtreeIntoContainer=function(u,d,p,E){if(!lx(p))throw Error(t(200));if(u==null||u._reactInternals===void 0)throw Error(t(38));return cx(u,d,p,!1,E)},Ps.version="18.3.1-next-f1338f8080-20240426",Ps}var $4;function RU(){if($4)return fS.exports;$4=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),fS.exports=TU(),fS.exports}var W4;function AU(){if(W4)return hx;W4=1;var n=RU();return hx.createRoot=n.createRoot,hx.hydrateRoot=n.hydrateRoot,hx}var kU=AU();const IU=XR(kU);var H=f1();const CU=XR(H),Ls={ADD:"add",REMOVE:"remove"},C0={PROPERTYCHANGE:"propertychange"},en={CHANGE:"change",ERROR:"error",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",TOUCHMOVE:"touchmove",WHEEL:"wheel"};class g1{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}function PU(n,e,t){let r,i;t=t||Kl;let s=0,a=n.length,o=!1;for(;s<a;)r=s+(a-s>>1),i=+t(n[r],e),i<0?s=r+1:(a=r,o=!i);return o?s:~s}function Kl(n,e){return n>e?1:n<e?-1:0}function NU(n,e){return n<e?1:n>e?-1:0}function xw(n,e,t){if(n[0]<=e)return 0;const r=n.length;if(e<=n[r-1])return r-1;if(typeof t=="function"){for(let i=1;i<r;++i){const s=n[i];if(s===e)return i;if(s<e)return t(e,n[i-1],s)>0?i-1:i}return r-1}if(t>0){for(let i=1;i<r;++i)if(n[i]<e)return i-1;return r-1}if(t<0){for(let i=1;i<r;++i)if(n[i]<=e)return i;return r-1}for(let i=1;i<r;++i){if(n[i]==e)return i;if(n[i]<e)return n[i-1]-e<e-n[i]?i-1:i}return r-1}function MU(n,e,t){for(;e<t;){const r=n[e];n[e]=n[t],n[t]=r,++e,--t}}function Un(n,e){const t=Array.isArray(e)?e:[e],r=t.length;for(let i=0;i<r;i++)n[n.length]=t[i]}function gc(n,e){const t=n.length;if(t!==e.length)return!1;for(let r=0;r<t;r++)if(n[r]!==e[r])return!1;return!0}function LU(n,e,t){const r=e||Kl;return n.every(function(i,s){if(s===0)return!0;const a=r(n[s-1],i);return!(a>0||a===0)})}function xp(){return!0}function _w(){return!1}function _p(){}function gD(n){let e,t,r;return function(){const i=Array.prototype.slice.call(arguments);return(!t||this!==r||!gc(i,t))&&(r=this,t=i,e=n.apply(this,arguments)),e}}function mD(n){function e(){let t;try{t=n()}catch(r){return Promise.reject(r)}return t instanceof Promise?t:Promise.resolve(t)}return e()}function ig(n){for(const e in n)delete n[e]}function id(n){let e;for(e in n)return!1;return!e}class pl{constructor(e){this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}let m1=class extends g1{constructor(e){super(),this.eventTarget_=e,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(e,t){if(!e||!t)return;const r=this.listeners_||(this.listeners_={}),i=r[e]||(r[e]=[]);i.includes(t)||i.push(t)}dispatchEvent(e){const t=typeof e=="string",r=t?e:e.type,i=this.listeners_&&this.listeners_[r];if(!i)return;const s=t?new pl(e):e;s.target||(s.target=this.eventTarget_||this);const a=this.dispatching_||(this.dispatching_={}),o=this.pendingRemovals_||(this.pendingRemovals_={});r in a||(a[r]=0,o[r]=0),++a[r];let l;for(let c=0,h=i.length;c<h;++c)if("handleEvent"in i[c]?l=i[c].handleEvent(s):l=i[c].call(this,s),l===!1||s.propagationStopped){l=!1;break}if(--a[r]===0){let c=o[r];for(delete o[r];c--;)this.removeEventListener(r,_p);delete a[r]}return l}disposeInternal(){this.listeners_&&ig(this.listeners_)}getListeners(e){return this.listeners_&&this.listeners_[e]||void 0}hasListener(e){return this.listeners_?e?e in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(e,t){if(!this.listeners_)return;const r=this.listeners_[e];if(!r)return;const i=r.indexOf(t);i!==-1&&(this.pendingRemovals_&&e in this.pendingRemovals_?(r[i]=_p,++this.pendingRemovals_[e]):(r.splice(i,1),r.length===0&&delete this.listeners_[e]))}};function pn(n,e,t,r,i){if(i){const a=t;t=function(o){return n.removeEventListener(e,t),a.call(r??this,o)}}else r&&r!==n&&(t=t.bind(r));const s={target:n,type:e,listener:t};return n.addEventListener(e,t),s}function C_(n,e,t,r){return pn(n,e,t,r,!0)}function or(n){n&&n.target&&(n.target.removeEventListener(n.type,n.listener),ig(n))}class p1 extends m1{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(en.CHANGE)}getRevision(){return this.revision_}onInternal(e,t){if(Array.isArray(e)){const r=e.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=pn(this,e[s],t);return i}return pn(this,e,t)}onceInternal(e,t){let r;if(Array.isArray(e)){const i=e.length;r=new Array(i);for(let s=0;s<i;++s)r[s]=C_(this,e[s],t)}else r=C_(this,e,t);return t.ol_key=r,r}unInternal(e,t){const r=t.ol_key;if(r)OU(r);else if(Array.isArray(e))for(let i=0,s=e.length;i<s;++i)this.removeEventListener(e[i],t);else this.removeEventListener(e,t)}}p1.prototype.on;p1.prototype.once;p1.prototype.un;function OU(n){if(Array.isArray(n))for(let e=0,t=n.length;e<t;++e)or(n[e]);else or(n)}function Xt(){throw new Error("Unimplemented abstract method.")}let DU=0;function Kt(n){return n.ol_uid||(n.ol_uid=String(++DU))}class H4 extends pl{constructor(e,t,r){super(e),this.key=t,this.oldValue=r}}class yl extends p1{constructor(e){super(),this.on,this.once,this.un,Kt(this),this.values_=null,e!==void 0&&this.setProperties(e)}get(e){let t;return this.values_&&this.values_.hasOwnProperty(e)&&(t=this.values_[e]),t}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(e,t){let r;r=`change:${e}`,this.hasListener(r)&&this.dispatchEvent(new H4(r,e,t)),r=C0.PROPERTYCHANGE,this.hasListener(r)&&this.dispatchEvent(new H4(r,e,t))}addChangeListener(e,t){this.addEventListener(`change:${e}`,t)}removeChangeListener(e,t){this.removeEventListener(`change:${e}`,t)}set(e,t,r){const i=this.values_||(this.values_={});if(r)i[e]=t;else{const s=i[e];i[e]=t,s!==t&&this.notify(e,s)}}setProperties(e,t){for(const r in e)this.set(r,e[r],t)}applyProperties(e){e.values_&&Object.assign(this.values_||(this.values_={}),e.values_)}unset(e,t){if(this.values_&&e in this.values_){const r=this.values_[e];delete this.values_[e],id(this.values_)&&(this.values_=null),t||this.notify(e,r)}}}const K4={LENGTH:"length"};class dx extends pl{constructor(e,t,r){super(e),this.element=t,this.index=r}}class Ma extends yl{constructor(e,t){if(super(),this.on,this.once,this.un,t=t||{},this.unique_=!!t.unique,this.array_=e??[],this.unique_)for(let r=1,i=this.array_.length;r<i;++r)this.assertUnique_(this.array_[r],r);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(e){for(let t=0,r=e.length;t<r;++t)this.push(e[t]);return this}forEach(e){const t=this.array_;for(let r=0,i=t.length;r<i;++r)e(t[r],r,t)}getArray(){return this.array_}item(e){return this.array_[e]}getLength(){return this.get(K4.LENGTH)}insertAt(e,t){if(e<0||e>this.getLength())throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t),this.array_.splice(e,0,t),this.updateLength_(),this.dispatchEvent(new dx(Ls.ADD,t,e))}pop(){return this.removeAt(this.getLength()-1)}push(e){const t=this.getLength();return this.insertAt(t,e),this.getLength()}remove(e){const t=this.array_;for(let r=0,i=t.length;r<i;++r)if(t[r]===e)return this.removeAt(r)}removeAt(e){if(e<0||e>=this.getLength())return;const t=this.array_[e];return this.array_.splice(e,1),this.updateLength_(),this.dispatchEvent(new dx(Ls.REMOVE,t,e)),t}setAt(e,t){const r=this.getLength();if(e>=r){this.insertAt(e,t);return}if(e<0)throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t,e);const i=this.array_[e];this.array_[e]=t,this.dispatchEvent(new dx(Ls.REMOVE,i,e)),this.dispatchEvent(new dx(Ls.ADD,t,e))}updateLength_(){this.set(K4.LENGTH,this.array_.length)}assertUnique_(e,t){const r=this.array_;for(let i=0,s=r.length;i<s;++i)if(r[i]===e&&i!==t)throw new Error("Duplicate item added to a unique collection")}}function Rn(n,e){if(!n)throw new Error(e)}let vr=class pD extends yl{constructor(e){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),e)if(typeof e.getSimplifiedGeometry=="function"){const t=e;this.setGeometry(t)}else{const t=e;this.setProperties(t)}}clone(){const e=new pD(this.hasProperties()?this.getProperties():null);e.setGeometryName(this.getGeometryName());const t=this.getGeometry();t&&e.setGeometry(t.clone());const r=this.getStyle();return r&&e.setStyle(r),e}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(or(this.geometryChangeKey_),this.geometryChangeKey_=null);const e=this.getGeometry();e&&(this.geometryChangeKey_=pn(e,en.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(e){this.set(this.geometryName_,e)}setStyle(e){this.style_=e,this.styleFunction_=e?jU(e):void 0,this.changed()}setId(e){this.id_=e,this.changed()}setGeometryName(e){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=e,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}};function jU(n){if(typeof n=="function")return n;let e;return Array.isArray(n)?e=n:(Rn(typeof n.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),e=[n]),function(){return e}}const wi={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function X4(n){const e=zs();for(let t=0,r=n.length;t<r;++t)Fm(e,n[t]);return e}function Xl(n,e,t){return t?(t[0]=n[0]-e,t[1]=n[1]-e,t[2]=n[2]+e,t[3]=n[3]+e,t):[n[0]-e,n[1]-e,n[2]+e,n[3]+e]}function yD(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n.slice()}function kd(n,e,t){let r,i;return e<n[0]?r=n[0]-e:n[2]<e?r=e-n[2]:r=0,t<n[1]?i=n[1]-t:n[3]<t?i=t-n[3]:i=0,r*r+i*i}function sd(n,e){return qR(n,e[0],e[1])}function uu(n,e){return n[0]<=e[0]&&e[2]<=n[2]&&n[1]<=e[1]&&e[3]<=n[3]}function qR(n,e,t){return n[0]<=e&&e<=n[2]&&n[1]<=t&&t<=n[3]}function eT(n,e){const t=n[0],r=n[1],i=n[2],s=n[3],a=e[0],o=e[1];let l=wi.UNKNOWN;return a<t?l=l|wi.LEFT:a>i&&(l=l|wi.RIGHT),o<r?l=l|wi.BELOW:o>s&&(l=l|wi.ABOVE),l===wi.UNKNOWN&&(l=wi.INTERSECTING),l}function zs(){return[1/0,1/0,-1/0,-1/0]}function Nu(n,e,t,r,i){return i?(i[0]=n,i[1]=e,i[2]=t,i[3]=r,i):[n,e,t,r]}function y1(n){return Nu(1/0,1/0,-1/0,-1/0,n)}function xD(n,e){const t=n[0],r=n[1];return Nu(t,r,t,r,e)}function YR(n,e,t,r,i){const s=y1(i);return vD(s,n,e,t,r)}function ad(n,e){return n[0]==e[0]&&n[2]==e[2]&&n[1]==e[1]&&n[3]==e[3]}function _D(n,e){return e[0]<n[0]&&(n[0]=e[0]),e[2]>n[2]&&(n[2]=e[2]),e[1]<n[1]&&(n[1]=e[1]),e[3]>n[3]&&(n[3]=e[3]),n}function Fm(n,e){e[0]<n[0]&&(n[0]=e[0]),e[0]>n[2]&&(n[2]=e[0]),e[1]<n[1]&&(n[1]=e[1]),e[1]>n[3]&&(n[3]=e[1])}function vD(n,e,t,r,i){for(;t<r;t+=i)FU(n,e[t],e[t+1]);return n}function FU(n,e,t){n[0]=Math.min(n[0],e),n[1]=Math.min(n[1],t),n[2]=Math.max(n[2],e),n[3]=Math.max(n[3],t)}function wD(n,e){let t;return t=e(vw(n)),t||(t=e(ww(n)),t)||(t=e(Ew(n)),t)||(t=e(Id(n)),t)?t:!1}function tT(n){let e=0;return sg(n)||(e=yn(n)*ti(n)),e}function vw(n){return[n[0],n[1]]}function ww(n){return[n[2],n[1]]}function Eo(n){return[(n[0]+n[2])/2,(n[1]+n[3])/2]}function VU(n,e){let t;if(e==="bottom-left")t=vw(n);else if(e==="bottom-right")t=ww(n);else if(e==="top-left")t=Id(n);else if(e==="top-right")t=Ew(n);else throw new Error("Invalid corner");return t}function P_(n,e,t,r,i){const[s,a,o,l,c,h,g,m]=ED(n,e,t,r);return Nu(Math.min(s,o,c,g),Math.min(a,l,h,m),Math.max(s,o,c,g),Math.max(a,l,h,m),i)}function ED(n,e,t,r){const i=e*r[0]/2,s=e*r[1]/2,a=Math.cos(t),o=Math.sin(t),l=i*a,c=i*o,h=s*a,g=s*o,m=n[0],y=n[1];return[m-l+g,y-c-h,m-l-g,y-c+h,m+l-g,y+c+h,m+l+g,y+c-h,m-l+g,y-c-h]}function ti(n){return n[3]-n[1]}function ql(n,e,t){const r=t||zs();return vs(n,e)?(n[0]>e[0]?r[0]=n[0]:r[0]=e[0],n[1]>e[1]?r[1]=n[1]:r[1]=e[1],n[2]<e[2]?r[2]=n[2]:r[2]=e[2],n[3]<e[3]?r[3]=n[3]:r[3]=e[3]):y1(r),r}function Id(n){return[n[0],n[3]]}function Ew(n){return[n[2],n[3]]}function yn(n){return n[2]-n[0]}function vs(n,e){return n[0]<=e[2]&&n[2]>=e[0]&&n[1]<=e[3]&&n[3]>=e[1]}function sg(n){return n[2]<n[0]||n[3]<n[1]}function BU(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n}function GU(n,e,t){let r=!1;const i=eT(n,e),s=eT(n,t);if(i===wi.INTERSECTING||s===wi.INTERSECTING)r=!0;else{const a=n[0],o=n[1],l=n[2],c=n[3],h=e[0],g=e[1],m=t[0],y=t[1],_=(y-g)/(m-h);let x,w;s&wi.ABOVE&&!(i&wi.ABOVE)&&(x=m-(y-c)/_,r=x>=a&&x<=l),!r&&s&wi.RIGHT&&!(i&wi.RIGHT)&&(w=y-(m-l)*_,r=w>=o&&w<=c),!r&&s&wi.BELOW&&!(i&wi.BELOW)&&(x=m-(y-o)/_,r=x>=a&&x<=l),!r&&s&wi.LEFT&&!(i&wi.LEFT)&&(w=y-(m-a)*_,r=w>=o&&w<=c)}return r}function SD(n,e){const t=e.getExtent(),r=Eo(n);if(e.canWrapX()&&(r[0]<t[0]||r[0]>=t[2])){const i=yn(t),a=Math.floor((r[0]-t[0])/i)*i;n[0]-=a,n[2]-=a}return n}function bD(n,e,t){if(e.canWrapX()){const r=e.getExtent();if(!isFinite(n[0])||!isFinite(n[2]))return[[r[0],n[1],r[2],n[3]]];SD(n,e);const i=yn(r);if(yn(n)>i&&!t)return[[r[0],n[1],r[2],n[3]]];if(n[0]<r[0])return[[n[0]+i,n[1],r[2],n[3]],[r[0],n[1],n[2],n[3]]];if(n[2]>r[2])return[[n[0],n[1],r[2],n[3]],[r[0],n[1],n[2]-i,n[3]]]}return[n]}function hr(n,e,t){return Math.min(Math.max(n,e),t)}function zU(n,e,t,r,i,s){const a=i-t,o=s-r;if(a!==0||o!==0){const l=((n-t)*a+(e-r)*o)/(a*a+o*o);l>1?(t=i,r=s):l>0&&(t+=a*l,r+=o*l)}return Yh(n,e,t,r)}function Yh(n,e,t,r){const i=t-n,s=r-e;return i*i+s*s}function UU(n){const e=n.length;for(let r=0;r<e;r++){let i=r,s=Math.abs(n[r][r]);for(let o=r+1;o<e;o++){const l=Math.abs(n[o][r]);l>s&&(s=l,i=o)}if(s===0)return null;const a=n[i];n[i]=n[r],n[r]=a;for(let o=r+1;o<e;o++){const l=-n[o][r]/n[r][r];for(let c=r;c<e+1;c++)r==c?n[o][c]=0:n[o][c]+=l*n[r][c]}}const t=new Array(e);for(let r=e-1;r>=0;r--){t[r]=n[r][e]/n[r][r];for(let i=r-1;i>=0;i--)n[i][e]-=n[i][r]*t[r]}return t}function q4(n){return n*180/Math.PI}function Yl(n){return n*Math.PI/180}function Eu(n,e){const t=n%e;return t*e<0?t+e:t}function aa(n,e,t){return n+t*(e-n)}function x1(n,e){const t=Math.pow(10,e);return Math.round(n*t)/t}function N_(n,e){return Math.round(x1(n,e))}function fx(n,e){return Math.floor(x1(n,e))}function hu(n,e){return Math.ceil(x1(n,e))}function nT(n,e,t){if(n>=e&&n<t)return n;const r=t-e;return((n-e)%r+r)%r+e}function om(n,e,t){const r=""+n;let i=r.indexOf(".");return i=i===-1?r.length:i,i>e?r:new Array(1+e-i).join("0")+r}function TD(n,e){const t=(""+n).split("."),r=(""+e).split(".");for(let i=0;i<Math.max(t.length,r.length);i++){const s=parseInt(t[i]||"0",10),a=parseInt(r[i]||"0",10);if(s>a)return 1;if(a>s)return-1}return 0}function $U(n,e){return n[0]+=+e[0],n[1]+=+e[1],n}function M_(n,e){let t=!0;for(let r=n.length-1;r>=0;--r)if(n[r]!=e[r]){t=!1;break}return t}function ZR(n,e){const t=Math.cos(e),r=Math.sin(e),i=n[0]*t-n[1]*r,s=n[1]*t+n[0]*r;return n[0]=i,n[1]=s,n}function WU(n,e){return n[0]*=e,n[1]*=e,n}function RD(n,e){if(e.canWrapX()){const t=yn(e.getExtent()),r=AD(n,e,t);r&&(n[0]-=r*t)}return n}function AD(n,e,t){const r=e.getExtent();let i=0;return e.canWrapX()&&(n[0]<r[0]||n[0]>r[2])&&(t=t||yn(r),i=Math.floor((n[0]-r[0])/t)),i}function kD(...n){console.warn(...n)}const P0={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};let Sw=class{constructor(e){this.code_=e.code,this.units_=e.units,this.extent_=e.extent!==void 0?e.extent:null,this.worldExtent_=e.worldExtent!==void 0?e.worldExtent:null,this.axisOrientation_=e.axisOrientation!==void 0?e.axisOrientation:"enu",this.global_=e.global!==void 0?e.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||P0[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(e){this.global_=e,this.canWrapX_=!!(e&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(e){this.defaultTileGrid_=e}setExtent(e){this.extent_=e,this.canWrapX_=!!(this.global_&&e)}setWorldExtent(e){this.worldExtent_=e}setGetPointResolution(e){this.getPointResolutionFunc_=e}getPointResolutionFunc(){return this.getPointResolutionFunc_}};const _1=6378137,e0=Math.PI*_1,HU=[-e0,-e0,e0,e0],KU=[-180,-85,180,85],gx=_1*Math.log(Math.tan(Math.PI/2));class Sf extends Sw{constructor(e){super({code:e,units:"m",extent:HU,global:!0,worldExtent:KU,getPointResolution:function(t,r){return t/Math.cosh(r[1]/_1)}})}}const Y4=[new Sf("EPSG:3857"),new Sf("EPSG:102100"),new Sf("EPSG:102113"),new Sf("EPSG:900913"),new Sf("http://www.opengis.net/def/crs/EPSG/0/3857"),new Sf("http://www.opengis.net/gml/srs/epsg.xml#3857")];function XU(n,e,t,r){const i=n.length;t=t>1?t:2,r=r??t,e===void 0&&(t>2?e=n.slice():e=new Array(i));for(let s=0;s<i;s+=r){e[s]=e0*n[s]/180;let a=_1*Math.log(Math.tan(Math.PI*(+n[s+1]+90)/360));a>gx?a=gx:a<-gx&&(a=-gx),e[s+1]=a}return e}function qU(n,e,t,r){const i=n.length;t=t>1?t:2,r=r??t,e===void 0&&(t>2?e=n.slice():e=new Array(i));for(let s=0;s<i;s+=r)e[s]=180*n[s]/e0,e[s+1]=360*Math.atan(Math.exp(n[s+1]/_1))/Math.PI-90;return e}const YU=6378137,Z4=[-180,-90,180,90],ZU=Math.PI*YU/180;class vh extends Sw{constructor(e,t){super({code:e,units:"degrees",extent:Z4,axisOrientation:t,global:!0,metersPerUnit:ZU,worldExtent:Z4})}}const J4=[new vh("CRS:84"),new vh("EPSG:4326","neu"),new vh("urn:ogc:def:crs:OGC:1.3:CRS84"),new vh("urn:ogc:def:crs:OGC:2:84"),new vh("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new vh("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new vh("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let rT={};function t_(n){return rT[n]||rT[n.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function JU(n,e){rT[n]=e}let f0={};function od(n,e,t){const r=n.getCode(),i=e.getCode();r in f0||(f0[r]={}),f0[r][i]=t}function n_(n,e){return n in f0&&e in f0[n]?f0[n][e]:null}const L_=.9996,ja=.00669438,bw=ja*ja,Tw=bw*ja,Bh=ja/(1-ja),Q4=Math.sqrt(1-ja),N0=(1-Q4)/(1+Q4),ID=N0*N0,JR=ID*N0,QR=JR*N0,CD=QR*N0,PD=1-ja/4-3*bw/64-5*Tw/256,QU=3*ja/8+3*bw/32+45*Tw/1024,e$=15*bw/256+45*Tw/1024,t$=35*Tw/3072,n$=3/2*N0-27/32*JR+269/512*CD,r$=21/16*ID-55/32*QR,i$=151/96*JR-417/128*CD,s$=1097/512*QR,O_=6378137;function a$(n,e,t){const r=n-5e5,a=(t.north?e:e-1e7)/L_/(O_*PD),o=a+n$*Math.sin(2*a)+r$*Math.sin(4*a)+i$*Math.sin(6*a)+s$*Math.sin(8*a),l=Math.sin(o),c=l*l,h=Math.cos(o),g=l/h,m=g*g,y=m*m,_=1-ja*c,x=Math.sqrt(1-ja*c),w=O_/x,b=(1-ja)/_,T=Bh*h**2,k=T*T,L=r/(w*L_),O=L*L,B=O*L,R=B*L,A=R*L,P=A*L,D=o-g/b*(O/2-R/24*(5+3*m+10*T-4*k-9*Bh))+P/720*(61+90*m+298*T+45*y-252*Bh-3*k);let N=(L-B/6*(1+2*m+T)+A/120*(5-2*T+28*m-3*k+8*Bh+24*y))/h;return N=nT(N+Yl(ND(t.number)),-Math.PI,Math.PI),[q4(N),q4(D)]}const eN=-80,tN=84,o$=-180,l$=180;function c$(n,e,t){n=nT(n,o$,l$),e<eN?e=eN:e>tN&&(e=tN);const r=Yl(e),i=Math.sin(r),s=Math.cos(r),a=i/s,o=a*a,l=o*o,c=Yl(n),h=ND(t.number),g=Yl(h),m=O_/Math.sqrt(1-ja*i**2),y=Bh*s**2,_=s*nT(c-g,-Math.PI,Math.PI),x=_*_,w=x*_,b=w*_,T=b*_,k=T*_,L=O_*(PD*r-QU*Math.sin(2*r)+e$*Math.sin(4*r)-t$*Math.sin(6*r)),O=L_*m*(_+w/6*(1-o+y)+T/120*(5-18*o+l+72*y-58*Bh))+5e5;let B=L_*(L+m*a*(x/2+b/24*(5-o+9*y+4*y**2)+k/720*(61-58*o+l+600*y-330*Bh)));return t.north||(B+=1e7),[O,B]}function ND(n){return(n-1)*6-180+3}const u$=[/^EPSG:(\d+)$/,/^urn:ogc:def:crs:EPSG::(\d+)$/,/^http:\/\/www\.opengis\.net\/def\/crs\/EPSG\/0\/(\d+)$/];function MD(n){let e=0;for(const i of u$){const s=n.match(i);if(s){e=parseInt(s[1]);break}}if(!e)return null;let t=0,r=!1;return e>32700&&e<32761?t=e-32700:e>32600&&e<32661&&(r=!0,t=e-32600),t?{number:t,north:r}:null}function nN(n,e){return function(t,r,i,s){const a=t.length;i=i>1?i:2,s=s??i,r||(i>2?r=t.slice():r=new Array(a));for(let o=0;o<a;o+=s){const l=t[o],c=t[o+1],h=n(l,c,e);r[o]=h[0],r[o+1]=h[1]}return r}}function h$(n){return MD(n)?new Sw({code:n,units:"m"}):null}function d$(n){const e=MD(n.getCode());return e?{forward:nN(c$,e),inverse:nN(a$,e)}:null}const f$=63710088e-1;function rN(n,e,t){t=t||f$;const r=Yl(n[1]),i=Yl(e[1]),s=(i-r)/2,a=Yl(e[0]-n[0])/2,o=Math.sin(s)*Math.sin(s)+Math.sin(a)*Math.sin(a)*Math.cos(r)*Math.cos(i);return 2*t*Math.atan2(Math.sqrt(o),Math.sqrt(1-o))}const g$=[d$],m$=[h$];let iT=!0;function LD(n){iT=!1}function eA(n,e){if(e!==void 0){for(let t=0,r=n.length;t<r;++t)e[t]=n[t];e=e}else e=n.slice();return e}function D_(n){JU(n.getCode(),n),od(n,n,eA)}function p$(n){n.forEach(D_)}function ir(n){if(typeof n!="string")return n;const e=t_(n);if(e)return e;for(const t of m$){const r=t(n);if(r)return r}return null}function j_(n,e,t,r){n=ir(n);let i;const s=n.getPointResolutionFunc();if(s){if(i=s(e,t),r&&r!==n.getUnits()){const a=n.getMetersPerUnit();a&&(i=i*a/P0[r])}}else{const a=n.getUnits();if(a=="degrees"&&!r||r=="degrees")i=e;else{const o=nA(n,ir("EPSG:4326"));if(!o&&a!=="degrees")i=e*n.getMetersPerUnit();else{let c=[t[0]-e/2,t[1],t[0]+e/2,t[1],t[0],t[1]-e/2,t[0],t[1]+e/2];c=o(c,c,2);const h=rN(c.slice(0,2),c.slice(2,4)),g=rN(c.slice(4,6),c.slice(6,8));i=(h+g)/2}const l=r?P0[r]:n.getMetersPerUnit();l!==void 0&&(i/=l)}}return i}function sT(n){p$(n),n.forEach(function(e){n.forEach(function(t){e!==t&&od(e,t,eA)})})}function y$(n,e,t,r){n.forEach(function(i){e.forEach(function(s){od(i,s,t),od(s,i,r)})})}function tA(n,e){return n?typeof n=="string"?ir(n):n:ir(e)}function aT(n){return(function(e,t,r,i){const s=e.length;r=r!==void 0?r:2,i=i??r,t=t!==void 0?t:new Array(s);for(let a=0;a<s;a+=i){const o=n(e.slice(a,a+r)),l=o.length;for(let c=0,h=i;c<h;++c)t[a+c]=c>=l?e[a+c]:o[c]}return t})}function x$(n,e,t,r){const i=ir(n),s=ir(e);od(i,s,aT(t)),od(s,i,aT(r))}function Ir(n,e){return LD(),ag(n,"EPSG:4326","EPSG:3857")}function bn(n,e){const t=ag(n,"EPSG:3857","EPSG:4326"),r=t[0];return(r<-180||r>180)&&(t[0]=Eu(r+180,360)-180),t}function Zh(n,e){if(n===e)return!0;const t=n.getUnits()===e.getUnits();return(n.getCode()===e.getCode()||nA(n,e)===eA)&&t}function nA(n,e){const t=n.getCode(),r=e.getCode();let i=n_(t,r);if(i)return i;let s=null,a=null;for(const l of g$)s||(s=l(n)),a||(a=l(e));if(!s&&!a)return null;const o="EPSG:4326";if(a)if(s)i=pS(s.inverse,a.forward);else{const l=n_(t,o);l&&(i=pS(l,a.forward))}else{const l=n_(o,r);l&&(i=pS(s.inverse,l))}return i&&(D_(n),D_(e),od(n,e,i)),i}function pS(n,e){return function(t,r,i,s){return r=n(t,r,i,s),e(r,r,i,s)}}function vp(n,e){const t=ir(n),r=ir(e);return nA(t,r)}function ag(n,e,t){const r=vp(e,t);if(!r){const i=ir(e).getCode(),s=ir(t).getCode();throw new Error(`No transform available between ${i} and ${s}`)}return r(n,void 0,n.length)}function oT(n,e){return n}function Fl(n,e){return iT&&!M_(n,[0,0])&&n[0]>=-180&&n[0]<=180&&n[1]>=-90&&n[1]<=90&&(iT=!1,kD("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),n}function OD(n,e){return n}function Jo(n,e){return n}function iN(n,e,t){return function(r){let i,s;if(n.canWrapX()){const a=n.getExtent(),o=yn(a);r=r.slice(0),s=AD(r,n,o),s&&(r[0]=r[0]-s*o),r[0]=hr(r[0],a[0],a[2]),r[1]=hr(r[1],a[1],a[3]),i=t(r)}else i=t(r);return s&&e.canWrapX()&&(i[0]+=s*yn(e.getExtent())),i}}function _$(){sT(Y4),sT(J4),y$(J4,Y4,XU,qU)}_$();const v$=new Array(6);function gi(){return[1,0,0,1,0,0]}function DD(n,e){const t=n[0],r=n[1],i=n[2],s=n[3],a=n[4],o=n[5],l=e[0],c=e[1],h=e[2],g=e[3],m=e[4],y=e[5];return n[0]=t*l+i*c,n[1]=r*l+s*c,n[2]=t*h+i*g,n[3]=r*h+s*g,n[4]=t*m+i*y+a,n[5]=r*m+s*y+o,n}function w$(n,e,t,r,i,s,a){return n[0]=e,n[1]=t,n[2]=r,n[3]=i,n[4]=s,n[5]=a,n}function jD(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n}function Fr(n,e){const t=e[0],r=e[1];return e[0]=n[0]*t+n[2]*r+n[4],e[1]=n[1]*t+n[3]*r+n[5],e}function E$(n,e,t){return DD(n,w$(v$,1,0,0,1,e,t))}function Ga(n,e,t,r,i,s,a,o){const l=Math.sin(s),c=Math.cos(s);return n[0]=r*c,n[1]=i*l,n[2]=-r*l,n[3]=i*c,n[4]=a*r*c-o*r*l+e,n[5]=a*i*l+o*i*c+t,n}function wp(n,e){const t=S$(e);Rn(t!==0,"Transformation matrix cannot be inverted");const r=e[0],i=e[1],s=e[2],a=e[3],o=e[4],l=e[5];return n[0]=a/t,n[1]=-i/t,n[2]=-s/t,n[3]=r/t,n[4]=(s*l-a*o)/t,n[5]=-(r*l-i*o)/t,n}function S$(n){return n[0]*n[3]-n[1]*n[2]}const b$=[1e5,1e5,1e5,1e5,2,2];function T$(n){return"matrix("+n.join(", ")+")"}function lT(n){return n.substring(7,n.length-1).split(",").map(parseFloat)}function R$(n,e){const t=lT(n),r=lT(e);for(let i=0;i<6;++i)if(Math.round((t[i]-r[i])*b$[i])!==0)return!1;return!0}function nl(n,e,t,r,i,s,a){s=s||[],a=a||2;let o=0;for(let l=e;l<t;l+=r){const c=n[l],h=n[l+1];s[o++]=i[0]*c+i[2]*h+i[4],s[o++]=i[1]*c+i[3]*h+i[5];for(let g=2;g<a;g++)s[o++]=n[l+g]}return s&&s.length!=o&&(s.length=o),s}function FD(n,e,t,r,i,s,a){a=a||[];const o=Math.cos(i),l=Math.sin(i),c=s[0],h=s[1];let g=0;for(let m=e;m<t;m+=r){const y=n[m]-c,_=n[m+1]-h;a[g++]=c+y*o-_*l,a[g++]=h+y*l+_*o;for(let x=m+2;x<m+r;++x)a[g++]=n[x]}return a&&a.length!=g&&(a.length=g),a}function A$(n,e,t,r,i,s,a,o){o=o||[];const l=a[0],c=a[1];let h=0;for(let g=e;g<t;g+=r){const m=n[g]-l,y=n[g+1]-c;o[h++]=l+i*m,o[h++]=c+s*y;for(let _=g+2;_<g+r;++_)o[h++]=n[_]}return o&&o.length!=h&&(o.length=h),o}function k$(n,e,t,r,i,s,a){a=a||[];let o=0;for(let l=e;l<t;l+=r){a[o++]=n[l]+i,a[o++]=n[l+1]+s;for(let c=l+2;c<l+r;++c)a[o++]=n[c]}return a&&a.length!=o&&(a.length=o),a}const sN=gi(),I$=[NaN,NaN];class VD extends yl{constructor(){super(),this.extent_=zs(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=gD((e,t,r)=>{if(!r)return this.getSimplifiedGeometry(t);const i=this.clone();return i.applyTransform(r),i.getSimplifiedGeometry(t)})}simplifyTransformed(e,t){return this.simplifyTransformedInternal(this.getRevision(),e,t)}clone(){return Xt()}closestPointXY(e,t,r,i){return Xt()}containsXY(e,t){return this.closestPointXY(e,t,I$,Number.MIN_VALUE)===0}getClosestPoint(e,t){return t=t||[NaN,NaN],this.closestPointXY(e[0],e[1],t,1/0),t}intersectsCoordinate(e){return this.containsXY(e[0],e[1])}computeExtent(e){return Xt()}getExtent(e){if(this.extentRevision_!=this.getRevision()){const t=this.computeExtent(this.extent_);(isNaN(t[0])||isNaN(t[1]))&&y1(t),this.extentRevision_=this.getRevision()}return BU(this.extent_,e)}rotate(e,t){Xt()}scale(e,t,r){Xt()}simplify(e){return this.getSimplifiedGeometry(e*e)}getSimplifiedGeometry(e){return Xt()}getType(){return Xt()}applyTransform(e){Xt()}intersectsExtent(e){return Xt()}translate(e,t){Xt()}transform(e,t){const r=ir(e),i=r.getUnits()=="tile-pixels"?function(s,a,o){const l=r.getExtent(),c=r.getWorldExtent(),h=ti(c)/ti(l);Ga(sN,c[0],c[3],h,-h,0,0,0);const g=nl(s,0,s.length,o,sN,a),m=vp(r,t);return m?m(g,g,o):g}:vp(r,t);return this.applyTransform(i),this}}class Cd extends VD{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(e){return YR(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinates(){return Xt()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const t=this.getSimplifiedGeometryInternal(e);return t.getFlatCoordinates().length<this.flatCoordinates.length?t:(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getSimplifiedGeometryInternal(e){return this}getStride(){return this.stride}setFlatCoordinates(e,t){this.stride=aN(e),this.layout=e,this.flatCoordinates=t}setCoordinates(e,t){Xt()}setLayout(e,t,r){let i;if(e)i=aN(e);else{for(let s=0;s<r;++s){if(t.length===0){this.layout="XY",this.stride=2;return}t=t[0]}i=t.length,e=Pd(i)}this.layout=e,this.stride=i}applyTransform(e){this.flatCoordinates&&(e(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(e,t){const r=this.getFlatCoordinates();if(r){const i=this.getStride();FD(r,0,r.length,i,e,t,r),this.changed()}}scale(e,t,r){t===void 0&&(t=e),r||(r=Eo(this.getExtent()));const i=this.getFlatCoordinates();if(i){const s=this.getStride();A$(i,0,i.length,s,e,t,r,i),this.changed()}}translate(e,t){const r=this.getFlatCoordinates();if(r){const i=this.getStride();k$(r,0,r.length,i,e,t,r),this.changed()}}}function Pd(n){let e;return n==2?e="XY":n==3?e="XYZ":n==4&&(e="XYZM"),e}function aN(n){let e;return n=="XY"?e=2:n=="XYZ"||n=="XYM"?e=3:n=="XYZM"&&(e=4),e}function C$(n,e,t){const r=n.getFlatCoordinates();if(!r)return null;const i=n.getStride();return nl(r,0,r.length,i,e,t)}function oN(n,e,t,r,i,s,a){const o=n[e],l=n[e+1],c=n[t]-o,h=n[t+1]-l;let g;if(c===0&&h===0)g=e;else{const m=((i-o)*c+(s-l)*h)/(c*c+h*h);if(m>1)g=t;else if(m>0){for(let y=0;y<r;++y)a[y]=aa(n[e+y],n[t+y],m);a.length=r;return}else g=e}for(let m=0;m<r;++m)a[m]=n[g+m];a.length=r}function rA(n,e,t,r,i){let s=n[e],a=n[e+1];for(e+=r;e<t;e+=r){const o=n[e],l=n[e+1],c=Yh(s,a,o,l);c>i&&(i=c),s=o,a=l}return i}function iA(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s){const o=t[s];i=rA(n,e,o,r,i),e=o}return i}function P$(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s){const o=t[s];i=iA(n,e,o,r,i),e=o[o.length-1]}return i}function sA(n,e,t,r,i,s,a,o,l,c,h){if(e==t)return c;let g,m;if(i===0){if(m=Yh(a,o,n[e],n[e+1]),m<c){for(g=0;g<r;++g)l[g]=n[e+g];return l.length=r,m}return c}h=h||[NaN,NaN];let y=e+r;for(;y<t;)if(oN(n,y-r,y,r,a,o,h),m=Yh(a,o,h[0],h[1]),m<c){for(c=m,g=0;g<r;++g)l[g]=h[g];l.length=r,y+=r}else y+=r*Math.max((Math.sqrt(m)-Math.sqrt(c))/i|0,1);if(s&&(oN(n,t-r,e,r,a,o,h),m=Yh(a,o,h[0],h[1]),m<c)){for(c=m,g=0;g<r;++g)l[g]=h[g];l.length=r}return c}function aA(n,e,t,r,i,s,a,o,l,c,h){h=h||[NaN,NaN];for(let g=0,m=t.length;g<m;++g){const y=t[g];c=sA(n,e,y,r,i,s,a,o,l,c,h),e=y}return c}function N$(n,e,t,r,i,s,a,o,l,c,h){h=h||[NaN,NaN];for(let g=0,m=t.length;g<m;++g){const y=t[g];c=aA(n,e,y,r,i,s,a,o,l,c,h),e=y[y.length-1]}return c}function M$(n,e,t,r){for(let i=0,s=t.length;i<s;++i)n[e++]=t[i];return e}function Rw(n,e,t,r){for(let i=0,s=t.length;i<s;++i){const a=t[i];for(let o=0;o<r;++o)n[e++]=a[o]}return e}function v1(n,e,t,r,i){i=i||[];let s=0;for(let a=0,o=t.length;a<o;++a){const l=Rw(n,e,t[a],r);i[s++]=l,e=l}return i.length=s,i}function BD(n,e,t,r,i){i=i||[];let s=0;for(let a=0,o=t.length;a<o;++a){const l=v1(n,e,t[a],r,i[s]);l.length===0&&(l[0]=e),i[s++]=l,e=l[l.length-1]}return i.length=s,i}function du(n,e,t,r,i){i=i!==void 0?i:[];let s=0;for(let a=e;a<t;a+=r)i[s++]=n.slice(a,a+r);return i.length=s,i}function Ep(n,e,t,r,i){i=i!==void 0?i:[];let s=0;for(let a=0,o=t.length;a<o;++a){const l=t[a];i[s++]=du(n,e,l,r,i[s]),e=l}return i.length=s,i}function cT(n,e,t,r,i){i=i!==void 0?i:[];let s=0;for(let a=0,o=t.length;a<o;++a){const l=t[a];i[s++]=l.length===1&&l[0]===e?[]:Ep(n,e,l,r,i[s]),e=l[l.length-1]}return i.length=s,i}function F_(n,e,t,r,i,s,a){let o,l;const c=(t-e)/r;if(c===1)o=e;else if(c===2)o=e,l=i;else if(c!==0){let h=n[e],g=n[e+1],m=0;const y=[0];for(let w=e+r;w<t;w+=r){const b=n[w],T=n[w+1];m+=Math.sqrt((b-h)*(b-h)+(T-g)*(T-g)),y.push(m),h=b,g=T}const _=i*m,x=PU(y,_);x<0?(l=(_-y[-x-2])/(y[-x-1]-y[-x-2]),o=e+(-x-2)*r):o=e+x*r}a=a>1?a:2,s=s||new Array(a);for(let h=0;h<a;++h)s[h]=o===void 0?NaN:l===void 0?n[o+h]:aa(n[o+h],n[o+r+h],l);return s}function uT(n,e,t,r,i,s){if(t==e)return null;let a;if(i<n[e+r-1])return s?(a=n.slice(e,e+r),a[r-1]=i,a):null;if(n[t-1]<i)return s?(a=n.slice(t-r,t),a[r-1]=i,a):null;if(i==n[e+r-1])return n.slice(e,e+r);let o=e/r,l=t/r;for(;o<l;){const m=o+l>>1;i<n[(m+1)*r-1]?l=m:o=m+1}const c=n[o*r-1];if(i==c)return n.slice((o-1)*r,(o-1)*r+r);const h=n[(o+1)*r-1],g=(i-c)/(h-c);a=[];for(let m=0;m<r-1;++m)a.push(aa(n[(o-1)*r+m],n[o*r+m],g));return a.push(i),a}function L$(n,e,t,r,i,s,a){if(a)return uT(n,e,t[t.length-1],r,i,s);let o;if(i<n[r-1])return s?(o=n.slice(0,r),o[r-1]=i,o):null;if(n[n.length-1]<i)return s?(o=n.slice(n.length-r),o[r-1]=i,o):null;for(let l=0,c=t.length;l<c;++l){const h=t[l];if(e!=h){if(i<n[e+r-1])return null;if(i<=n[h-1])return uT(n,e,h,r,i,!1);e=h}}return null}function O$(n,e,t,r,i){return!wD(i,function(a){return!Gh(n,e,t,r,a[0],a[1])})}function Gh(n,e,t,r,i,s){let a=0,o=n[t-r],l=n[t-r+1];for(;e<t;e+=r){const c=n[e],h=n[e+1];l<=s?h>s&&(c-o)*(s-l)-(i-o)*(h-l)>0&&a++:h<=s&&(c-o)*(s-l)-(i-o)*(h-l)<0&&a--,o=c,l=h}return a!==0}function oA(n,e,t,r,i,s){if(t.length===0||!Gh(n,e,t[0],r,i,s))return!1;for(let a=1,o=t.length;a<o;++a)if(Gh(n,t[a-1],t[a],r,i,s))return!1;return!0}function D$(n,e,t,r,i,s){if(t.length===0)return!1;for(let a=0,o=t.length;a<o;++a){const l=t[a];if(oA(n,e,l,r,i,s))return!0;e=l[l.length-1]}return!1}function GD(n,e,t,r,i){let s;for(e+=r;e<t;e+=r)if(s=i(n.slice(e-r,e),n.slice(e,e+r)),s)return s;return!1}function Aw(n,e,t,r,i,s){return s=s??vD(zs(),n,e,t,r),vs(i,s)?s[0]>=i[0]&&s[2]<=i[2]||s[1]>=i[1]&&s[3]<=i[3]?!0:GD(n,e,t,r,function(a,o){return GU(i,a,o)}):!1}function j$(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s){if(Aw(n,e,t[s],r,i))return!0;e=t[s]}return!1}function zD(n,e,t,r,i){return!!(Aw(n,e,t,r,i)||Gh(n,e,t,r,i[0],i[1])||Gh(n,e,t,r,i[0],i[3])||Gh(n,e,t,r,i[2],i[1])||Gh(n,e,t,r,i[2],i[3]))}function UD(n,e,t,r,i){if(!zD(n,e,t[0],r,i))return!1;if(t.length===1)return!0;for(let s=1,a=t.length;s<a;++s)if(O$(n,t[s-1],t[s],r,i)&&!Aw(n,t[s-1],t[s],r,i))return!1;return!0}function F$(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s){const o=t[s];if(UD(n,e,o,r,i))return!0;e=o[o.length-1]}return!1}function lA(n,e,t,r){let i=n[e],s=n[e+1],a=0;for(let o=e+r;o<t;o+=r){const l=n[o],c=n[o+1];a+=Math.sqrt((l-i)*(l-i)+(c-s)*(c-s)),i=l,s=c}return a}function kw(n,e,t,r,i,s,a){const o=(t-e)/r;if(o<3){for(;e<t;e+=r)s[a++]=n[e],s[a++]=n[e+1];return a}const l=new Array(o);l[0]=1,l[o-1]=1;const c=[e,t-r];let h=0;for(;c.length>0;){const g=c.pop(),m=c.pop();let y=0;const _=n[m],x=n[m+1],w=n[g],b=n[g+1];for(let T=m+r;T<g;T+=r){const k=n[T],L=n[T+1],O=zU(k,L,_,x,w,b);O>y&&(h=T,y=O)}y>i&&(l[(h-e)/r]=1,m+r<h&&c.push(m,h),h+r<g&&c.push(h,g))}for(let g=0;g<o;++g)l[g]&&(s[a++]=n[e+g*r],s[a++]=n[e+g*r+1]);return a}function $D(n,e,t,r,i,s,a,o){for(let l=0,c=t.length;l<c;++l){const h=t[l];a=kw(n,e,h,r,i,s,a),o.push(a),e=h}return a}function Th(n,e){return e*Math.round(n/e)}function V$(n,e,t,r,i,s,a){if(e==t)return a;let o=Th(n[e],i),l=Th(n[e+1],i);e+=r,s[a++]=o,s[a++]=l;let c,h;do if(c=Th(n[e],i),h=Th(n[e+1],i),e+=r,e==t)return s[a++]=c,s[a++]=h,a;while(c==o&&h==l);for(;e<t;){const g=Th(n[e],i),m=Th(n[e+1],i);if(e+=r,g==c&&m==h)continue;const y=c-o,_=h-l,x=g-o,w=m-l;if(y*w==_*x&&(y<0&&x<y||y==x||y>0&&x>y)&&(_<0&&w<_||_==w||_>0&&w>_)){c=g,h=m;continue}s[a++]=c,s[a++]=h,o=c,l=h,c=g,h=m}return s[a++]=c,s[a++]=h,a}function cA(n,e,t,r,i,s,a,o){for(let l=0,c=t.length;l<c;++l){const h=t[l];a=V$(n,e,h,r,i,s,a),o.push(a),e=h}return a}function B$(n,e,t,r,i,s,a,o){for(let l=0,c=t.length;l<c;++l){const h=t[l],g=[];a=cA(n,e,h,r,i,s,a,g),o.push(g),e=h[h.length-1]}return a}class bi extends Cd{constructor(e,t){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,t!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}appendCoordinate(e){Un(this.flatCoordinates,e),this.changed()}clone(){const e=new bi(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,r,i){return i<kd(this.getExtent(),e,t)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(rA(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),sA(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,e,t,r,i))}forEachSegment(e){return GD(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinateAtM(e,t){return this.layout!="XYM"&&this.layout!="XYZM"?null:(t=t!==void 0?t:!1,uT(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t))}getCoordinates(){return du(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(e,t){return F_(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,this.stride)}getLength(){return lA(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_??void 0),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(e){const t=[];return t.length=kw(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new bi(t,"XY")}getType(){return"LineString"}intersectsExtent(e){return Aw(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,this.getExtent())}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Rw(this.flatCoordinates,0,e,this.stride),this.changed()}}let mi=class WD extends Cd{constructor(e,t){super(),this.setCoordinates(e,t)}clone(){const e=new WD(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,r,i){const s=this.flatCoordinates,a=Yh(e,t,s[0],s[1]);if(a<i){const o=this.stride;for(let l=0;l<o;++l)r[l]=s[l];return r.length=o,a}return i}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(e){return xD(this.flatCoordinates,e)}getType(){return"Point"}intersectsExtent(e){return qR(e,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(e,t){this.setLayout(t,e,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=M$(this.flatCoordinates,0,e,this.stride),this.changed()}};const Si={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"},ld=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",G$=ld.includes("safari")&&!ld.includes("chrom"),z$=G$&&(ld.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(ld)),U$=ld.includes("webkit")&&!ld.includes("edge"),HD=ld.includes("macintosh"),$$=typeof devicePixelRatio<"u"?devicePixelRatio:1,ua=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,uA=typeof Image<"u"&&Image.prototype.decode,KD=typeof createImageBitmap=="function",XD=(function(){let n=!1;try{const e=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch{}return n})(),Rt={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function ri(n,e,t,r){let i;return t&&t.length?i=t.shift():ua?i=new class extends OffscreenCanvas{style={}}(n??300,e??150):i=document.createElement("canvas"),n&&(i.width=n),e&&(i.height=e),i.getContext("2d",r)}let yS;function V_(){return yS||(yS=ri(1,1)),yS}function Iw(n){const e=n.canvas;e.width=1,e.height=1,n.clearRect(0,0,1,1)}function lN(n,e){const t=e.parentNode;t&&t.replaceChild(n,e)}function W$(n){for(;n.lastChild;)n.lastChild.remove()}function H$(n,e){const t=n.childNodes;for(let r=0;;++r){const i=t[r],s=e[r];if(!i&&!s)break;if(i!==s){if(!i){n.appendChild(s);continue}if(!s){n.removeChild(i),--r;continue}n.insertBefore(s,i)}}}function qD(){return new Proxy({childNodes:[],appendChild:function(e){return this.childNodes.push(e),e},remove:function(){},removeChild:function(e){const t=this.childNodes.indexOf(e);if(t===-1)throw new Error("Node to remove was not found");return this.childNodes.splice(t,1),e},insertBefore:function(e,t){const r=this.childNodes.indexOf(t);if(r===-1)throw new Error("Reference node not found");return this.childNodes.splice(r,0,e),e},style:{}},{get(e,t,r){return t==="firstElementChild"?e.childNodes.length>0?e.childNodes[0]:null:Reflect.get(e,t,r)}})}function fu(n){return typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas}const hA=[NaN,NaN,NaN,0];let xS;function K$(){return xS||(xS=ri(1,1,void 0,{willReadFrequently:!0,desynchronized:!0})),xS}const X$=/^rgba?\(\s*(\d+%?)\s+(\d+%?)\s+(\d+%?)(?:\s*\/\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,q$=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,Y$=/^rgba?\(\s*(\d+%)\s*,\s*(\d+%)\s*,\s*(\d+%)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,Z$=/^#([\da-f]{3,4}|[\da-f]{6}|[\da-f]{8})$/i;function mx(n,e){return n.endsWith("%")?Number(n.substring(0,n.length-1))/e:Number(n)}function Vm(n){throw new Error('failed to parse "'+n+'" as color')}function YD(n){if(n.toLowerCase().startsWith("rgb")){const s=n.match(q$)||n.match(X$)||n.match(Y$);if(s){const a=s[4],o=100/255;return[hr(mx(s[1],o)+.5|0,0,255),hr(mx(s[2],o)+.5|0,0,255),hr(mx(s[3],o)+.5|0,0,255),a!==void 0?hr(mx(a,100),0,1):1]}Vm(n)}if(n.startsWith("#")){if(Z$.test(n)){const s=n.substring(1),a=s.length<=4?1:2,o=[0,0,0,255];for(let l=0,c=s.length;l<c;l+=a){let h=parseInt(s.substring(l,l+a),16);a===1&&(h+=h<<4),o[l/a]=h}return o[3]=o[3]/255,o}Vm(n)}const e=K$();e.fillStyle="#abcdef";let t=e.fillStyle;e.fillStyle=n,e.fillStyle===t&&(e.fillStyle="#fedcba",t=e.fillStyle,e.fillStyle=n,e.fillStyle===t&&Vm(n));const r=e.fillStyle;if(r.startsWith("#")||r.startsWith("rgba"))return YD(r);e.clearRect(0,0,1,1),e.fillRect(0,0,1,1);const i=Array.from(e.getImageData(0,0,1,1).data);return i[3]=x1(i[3]/255,3),i}function J$(n){return typeof n=="string"?n:fA(n)}const Q$=1024,lm={};let _S=0;function eW(n){if(n.length===4)return n;const e=n.slice();return e[3]=1,e}function vS(n){return n>.0031308?Math.pow(n,1/2.4)*269.025-14.025:n*3294.6}function wS(n){return n>.2068965?Math.pow(n,3):(n-4/29)*(108/841)}function ES(n){return n>10.314724?Math.pow((n+14.025)/269.025,2.4):n/3294.6}function SS(n){return n>.0088564?Math.pow(n,1/3):n/(108/841)+4/29}function cN(n){const e=ES(n[0]),t=ES(n[1]),r=ES(n[2]),i=SS(e*.222488403+t*.716873169+r*.06060791),s=500*(SS(e*.452247074+t*.399439023+r*.148375274)-i),a=200*(i-SS(e*.016863605+t*.117638439+r*.865350722)),o=Math.atan2(a,s)*(180/Math.PI);return[116*i-16,Math.sqrt(s*s+a*a),o<0?o+360:o,n[3]]}function tW(n){const e=(n[0]+16)/116,t=n[1],r=n[2]*Math.PI/180,i=wS(e),s=wS(e+t/500*Math.cos(r)),a=wS(e-t/200*Math.sin(r)),o=vS(s*3.021973625-i*1.617392459-a*.404875592),l=vS(s*-.943766287+i*1.916279586+a*.027607165),c=vS(s*.069407491-i*.22898585+a*1.159737864);return[hr(o+.5|0,0,255),hr(l+.5|0,0,255),hr(c+.5|0,0,255),n[3]]}function dA(n){if(n==="none")return hA;if(lm.hasOwnProperty(n))return lm[n];if(_S>=Q$){let t=0;for(const r in lm)(t++&3)===0&&(delete lm[r],--_S)}const e=YD(n);e.length!==4&&Vm(n);for(const t of e)isNaN(t)&&Vm(n);return lm[n]=e,++_S,e}function za(n){return Array.isArray(n)?n:dA(n)}function fA(n){let e=n[0];e!=(e|0)&&(e=e+.5|0);let t=n[1];t!=(t|0)&&(t=t+.5|0);let r=n[2];r!=(r|0)&&(r=r+.5|0);const i=n[3]===void 0?1:Math.round(n[3]*1e3)/1e3;return"rgba("+e+","+t+","+r+","+i+")"}class ZD extends m1{constructor(e,t,r,i){super(),this.extent=e,this.pixelRatio_=r,this.resolution=t,this.state=typeof i=="function"?Rt.IDLE:i,this.image_=null,this.loader=typeof i=="function"?i:null}changed(){this.dispatchEvent(en.CHANGE)}getExtent(){return this.extent}getImage(){return this.image_}getPixelRatio(){return this.pixelRatio_}getResolution(){return this.resolution}getState(){return this.state}load(){if(this.state==Rt.IDLE&&this.loader){this.state=Rt.LOADING,this.changed();const e=this.getResolution(),t=Array.isArray(e)?e[0]:e;mD(()=>this.loader(this.getExtent(),t,this.getPixelRatio())).then(r=>{"image"in r&&(this.image_=r.image),"extent"in r&&(this.extent=r.extent),"resolution"in r&&(this.resolution=r.resolution),"pixelRatio"in r&&(this.pixelRatio_=r.pixelRatio),(r instanceof HTMLImageElement||KD&&r instanceof ImageBitmap||r instanceof HTMLCanvasElement||r instanceof HTMLVideoElement)&&(this.image_=r),this.state=Rt.LOADED}).catch(r=>{this.state=Rt.ERROR,console.error(r)}).finally(()=>this.changed())}}setImage(e){this.image_=e}setResolution(e){this.resolution=e}}function nW(n,e,t){const r=n;let i=!0,s=!1,a=!1;const o=[C_(r,en.LOAD,function(){a=!0,s||e()})];return r.src&&uA?(s=!0,r.decode().then(function(){i&&e()}).catch(function(l){i&&(a?e():t())})):o.push(C_(r,en.ERROR,t)),function(){i=!1,o.forEach(or)}}function rW(n,e){return new Promise((t,r)=>{function i(){a(),t(n)}function s(){a(),r(new Error("Image load error"))}function a(){n.removeEventListener("load",i),n.removeEventListener("error",s)}n.addEventListener("load",i),n.addEventListener("error",s)})}function JD(n,e){return e&&(n.src=e),n.src&&uA?new Promise((t,r)=>n.decode().then(()=>t(n)).catch(i=>n.complete&&n.width?t(n):r(i))):rW(n)}function QD(n,e){return e&&(n.src=e),n.src&&uA&&KD?n.decode().then(()=>createImageBitmap(n)).catch(t=>{if(n.complete&&n.width)return n;throw t}):JD(n)}class iW{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=1024}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let e=0;for(const t in this.cache_){const r=this.cache_[t];(e++&3)===0&&!r.hasListener()&&(delete this.cache_[t],delete this.patternCache_[t],--this.cacheSize_)}}}get(e,t,r){const i=bS(e,t,r);return i in this.cache_?this.cache_[i]:null}getPattern(e,t,r){const i=bS(e,t,r);return i in this.patternCache_?this.patternCache_[i]:null}set(e,t,r,i,s){const a=bS(e,t,r),o=a in this.cache_;this.cache_[a]=i,s&&(i.getImageState()===Rt.IDLE&&i.load(),i.getImageState()===Rt.LOADING?i.ready().then(()=>{this.patternCache_[a]=V_().createPattern(i.getImage(1),"repeat")}):this.patternCache_[a]=V_().createPattern(i.getImage(1),"repeat")),o||++this.cacheSize_}setSize(e){this.maxCacheSize_=e,this.expire()}}function bS(n,e,t){const r=t?za(t):"null";return e+":"+n+":"+r}const La=new iW;let cm=null;class ej extends m1{constructor(e,t,r,i,s){super(),this.hitDetectionImage_=null,this.image_=e,this.crossOrigin_=r,this.canvas_={},this.color_=s,this.imageState_=i===void 0?Rt.IDLE:i,this.size_=e&&e.width&&e.height?[e.width,e.height]:null,this.src_=t,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===Rt.LOADED){cm||(cm=ri(1,1,void 0,{willReadFrequently:!0})),cm.drawImage(this.image_,0,0);try{cm.getImageData(0,0,1,1),this.tainted_=!1}catch{cm=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(en.CHANGE)}handleImageError_(){this.imageState_=Rt.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=Rt.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(e){return this.image_||this.initializeImage_(),this.replaceColor_(e),this.canvas_[e]?this.canvas_[e]:this.image_}getPixelRatio(e){return this.replaceColor_(e),this.canvas_[e]?e:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const e=this.size_[0],t=this.size_[1],r=ri(e,t);r.fillRect(0,0,e,t),this.hitDetectionImage_=r.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===Rt.IDLE){this.image_||this.initializeImage_(),this.imageState_=Rt.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&JD(this.image_,this.src_).then(e=>{this.image_=e,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(e){if(!this.color_||this.canvas_[e]||this.imageState_!==Rt.LOADED)return;const t=this.image_,r=ri(Math.ceil(t.width*e),Math.ceil(t.height*e)),i=r.canvas;r.scale(e,e),r.drawImage(t,0,0),r.globalCompositeOperation="multiply",r.fillStyle=J$(this.color_),r.fillRect(0,0,i.width/e,i.height/e),r.globalCompositeOperation="destination-in",r.drawImage(t,0,0),this.canvas_[e]=i}ready(){return this.ready_||(this.ready_=new Promise(e=>{if(this.imageState_===Rt.LOADED||this.imageState_===Rt.ERROR)e();else{const t=()=>{(this.imageState_===Rt.LOADED||this.imageState_===Rt.ERROR)&&(this.removeEventListener(en.CHANGE,t),e())};this.addEventListener(en.CHANGE,t)}})),this.ready_}}function B_(n,e,t,r,i,s){let a=e===void 0?void 0:La.get(e,t,i);return a||(a=new ej(n,n&&"src"in n?n.src||void 0:e,t,r,i),La.set(e,t,i,a,s)),s&&a&&!La.getPattern(e,t,i)&&La.set(e,t,i,a,s),a}function Qo(n){return n?Array.isArray(n)?fA(n):typeof n=="object"&&"src"in n?sW(n):n:null}function sW(n){if(!n.offset||!n.size)return La.getPattern(n.src,"anonymous",n.color);const e=n.src+":"+n.offset,t=La.getPattern(e,void 0,n.color);if(t)return t;const r=La.get(n.src,"anonymous",null);if(r.getImageState()!==Rt.LOADED)return null;const i=ri(n.size[0],n.size[1]);return i.drawImage(r.getImage(1),n.offset[0],n.offset[1],n.size[0],n.size[1],0,0,n.size[0],n.size[1]),B_(i.canvas,e,void 0,Rt.LOADED,n.color,!0),La.getPattern(e,void 0,n.color)}class tj{drawCustom(e,t,r,i,s){}drawGeometry(e){}setStyle(e){}drawCircle(e,t,r){}drawFeature(e,t,r){}drawGeometryCollection(e,t,r){}drawLineString(e,t,r){}drawMultiLineString(e,t,r){}drawMultiPoint(e,t,r){}drawMultiPolygon(e,t,r){}drawPoint(e,t,r){}drawPolygon(e,t,r){}drawText(e,t,r){}setFillStrokeStyle(e,t){}setImageStyle(e,t){}setTextStyle(e,t){}}const px="ol-hidden",w1="ol-unselectable",gA="ol-control",uN="ol-collapsed",aW=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z0-9]+?)\\s*$`].join(""),"i"),hN=["style","variant","weight","size","lineHeight","family"],hT={normal:400,bold:700},dT=function(n){const e=n.match(aW);if(!e)return null;const t={lineHeight:"normal",size:"1.2em",style:"normal",weight:"400",variant:"normal"};for(let r=0,i=hN.length;r<i;++r){const s=e[r+1];s!==void 0&&(t[hN[r]]=typeof s=="string"?s.trim():s)}return isNaN(Number(t.weight))&&t.weight in hT&&(t.weight=hT[t.weight]),t.families=t.family.split(/,\s?/).map(r=>r.trim().replace(/^['"]|['"]$/g,"")),t},nj="10px sans-serif",Os="#000",M0="round",Zl=[],Jl=0,L0="round",Sp=10,bp="#000",Tp="center",G_="middle",zh=[0,0,0,0],Rp=1,zf=new yl;let um=null,dN;const fT={},oW=new Set(["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","emoji","math","fangsong"]);function lW(n,e,t){return`${n} ${e} 16px "${t}"`}const cW=(function(){let e,t;async function r(s){await t.ready;const a=await t.load(s);if(a.length===0)return!1;const o=dT(s),l=o.families[0].toLowerCase(),c=o.weight;return a.some(h=>{const g=h.family.replace(/^['"]|['"]$/g,"").toLowerCase(),m=hT[h.weight]||h.weight;return g===l&&h.style===o.style&&m==c})}async function i(){await t.ready;let s=!0;const a=zf.getProperties(),o=Object.keys(a).filter(l=>a[l]<100);for(let l=o.length-1;l>=0;--l){const c=o[l];let h=a[c];h<100&&(await r(c)?(ig(fT),zf.set(c,100)):(h+=10,zf.set(c,h,!0),h<100&&(s=!1)))}e=void 0,s||(e=setTimeout(i,100))}return async function(s){t||(t=ua?self.fonts:document.fonts);const a=dT(s);if(!a)return;const o=a.families;let l=!1;for(const c of o){if(oW.has(c))continue;const h=lW(a.style,a.weight,c);zf.get(h)===void 0&&(zf.set(h,0,!0),l=!0)}l&&(clearTimeout(e),e=setTimeout(i,100))}})(),uW=(function(){let n;return function(e){let t=fT[e];if(t==null){if(ua){const r=dT(e),i=rj(e,"g");t=(isNaN(Number(r.lineHeight))?1.2:Number(r.lineHeight))*(i.actualBoundingBoxAscent+i.actualBoundingBoxDescent)}else n||(n=document.createElement("div"),n.innerHTML="M",n.style.minHeight="0",n.style.maxHeight="none",n.style.height="auto",n.style.padding="0",n.style.border="none",n.style.position="absolute",n.style.display="block",n.style.left="-99999px"),n.style.font=e,document.body.appendChild(n),t=n.offsetHeight,document.body.removeChild(n);fT[e]=t}return t}})();function rj(n,e){return um||(um=ri(1,1)),n!=dN&&(um.font=n,dN=um.font),um.measureText(e)}function ij(n,e){return rj(n,e).width}function fN(n,e,t){if(e in t)return t[e];const r=e.split(`
`).reduce((i,s)=>Math.max(i,ij(n,s)),0);return t[e]=r,r}function hW(n,e){const t=[],r=[],i=[];let s=0,a=0,o=0,l=0;for(let c=0,h=e.length;c<=h;c+=2){const g=e[c];if(g===`
`||c===h){s=Math.max(s,a),i.push(a),a=0,o+=l,l=0;continue}const m=e[c+1]||n.font,y=ij(m,g);t.push(y),a+=y;const _=uW(m);r.push(_),l=Math.max(l,_)}return{width:s,height:o,widths:t,heights:r,lineWidths:i}}function dW(n,e,t,r,i,s,a,o,l,c,h){n.save(),t!==1&&(n.globalAlpha===void 0?n.globalAlpha=g=>g.globalAlpha*=t:n.globalAlpha*=t),e&&n.transform.apply(n,e),r.contextInstructions?(n.translate(l,c),n.scale(h[0],h[1]),fW(r,n)):h[0]<0||h[1]<0?(n.translate(l,c),n.scale(h[0],h[1]),n.drawImage(r,i,s,a,o,0,0,a,o)):n.drawImage(r,i,s,a,o,l,c,a*h[0],o*h[1]),n.restore()}function fW(n,e){const t=n.contextInstructions;for(let r=0,i=t.length;r<i;r+=2)Array.isArray(t[r+1])?e[t[r]].apply(e,t[r+1]):e[t[r]]=t[r+1]}class gW extends tj{constructor(e,t,r,i,s,a,o){super(),this.context_=e,this.pixelRatio_=t,this.extent_=r,this.transform_=i,this.transformRotation_=i?x1(Math.atan2(i[1],i[0]),10):0,this.viewRotation_=s,this.squaredTolerance_=a,this.userTransform_=o,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=gi()}drawImages_(e,t,r,i){if(!this.image_)return;const s=nl(e,t,r,i,this.transform_,this.pixelCoordinates_),a=this.context_,o=this.tmpLocalTransform_,l=a.globalAlpha;this.imageOpacity_!=1&&(a.globalAlpha=l*this.imageOpacity_);let c=this.imageRotation_;this.transformRotation_===0&&(c-=this.viewRotation_),this.imageRotateWithView_&&(c+=this.viewRotation_);for(let h=0,g=s.length;h<g;h+=2){const m=s[h]-this.imageAnchorX_,y=s[h+1]-this.imageAnchorY_;if(c!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const _=m+this.imageAnchorX_,x=y+this.imageAnchorY_;Ga(o,_,x,1,1,c,-_,-x),a.save(),a.transform.apply(a,o),a.translate(_,x),a.scale(this.imageScale_[0],this.imageScale_[1]),a.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),a.restore()}else a.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,m,y,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(a.globalAlpha=l)}drawText_(e,t,r,i){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const s=nl(e,t,r,i,this.transform_,this.pixelCoordinates_),a=this.context_;let o=this.textRotation_;for(this.transformRotation_===0&&(o-=this.viewRotation_),this.textRotateWithView_&&(o+=this.viewRotation_);t<r;t+=i){const l=s[t]+this.textOffsetX_,c=s[t+1]+this.textOffsetY_;o!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(a.save(),a.translate(l-this.textOffsetX_,c-this.textOffsetY_),a.rotate(o),a.translate(this.textOffsetX_,this.textOffsetY_),a.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&a.strokeText(this.text_,0,0),this.textFillState_&&a.fillText(this.text_,0,0),a.restore()):(this.textStrokeState_&&a.strokeText(this.text_,l,c),this.textFillState_&&a.fillText(this.text_,l,c))}}moveToLineTo_(e,t,r,i,s){const a=this.context_,o=nl(e,t,r,i,this.transform_,this.pixelCoordinates_);a.moveTo(o[0],o[1]);let l=o.length;s&&(l-=2);for(let c=2;c<l;c+=2)a.lineTo(o[c],o[c+1]);return s&&a.closePath(),r}drawRings_(e,t,r,i){for(let s=0,a=r.length;s<a;++s)t=this.moveToLineTo_(e,t,r[s],i,!0);return t}drawCircle(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!vs(this.extent_,e.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=C$(e,this.transform_,this.pixelCoordinates_),r=t[2]-t[0],i=t[3]-t[1],s=Math.sqrt(r*r+i*i),a=this.context_;a.beginPath(),a.arc(t[0],t[1],s,0,2*Math.PI),this.fillState_&&a.fill(),this.strokeState_&&a.stroke()}this.text_!==""&&this.drawText_(e.getCenter(),0,2,2)}}setStyle(e){this.setFillStrokeStyle(e.getFill(),e.getStroke()),this.setImageStyle(e.getImage()),this.setTextStyle(e.getText())}setTransform(e){this.transform_=e}drawGeometry(e){switch(e.getType()){case"Point":this.drawPoint(e);break;case"LineString":this.drawLineString(e);break;case"Polygon":this.drawPolygon(e);break;case"MultiPoint":this.drawMultiPoint(e);break;case"MultiLineString":this.drawMultiLineString(e);break;case"MultiPolygon":this.drawMultiPolygon(e);break;case"GeometryCollection":this.drawGeometryCollection(e);break;case"Circle":this.drawCircle(e);break}}drawFeature(e,t){const r=t.getGeometryFunction()(e);r&&(this.setStyle(t),this.drawGeometry(r))}drawGeometryCollection(e){const t=e.getGeometriesArray();for(let r=0,i=t.length;r<i;++r)this.drawGeometry(t[r])}drawPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),r=e.getStride();this.image_&&this.drawImages_(t,0,t.length,r),this.text_!==""&&this.drawText_(t,0,t.length,r)}drawMultiPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),r=e.getStride();this.image_&&this.drawImages_(t,0,t.length,r),this.text_!==""&&this.drawText_(t,0,t.length,r)}drawLineString(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!vs(this.extent_,e.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const t=this.context_,r=e.getFlatCoordinates();t.beginPath(),this.moveToLineTo_(r,0,r.length,e.getStride(),!1),t.stroke()}if(this.text_!==""){const t=e.getFlatMidpoint();this.drawText_(t,0,2,2)}}}drawMultiLineString(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getExtent();if(vs(this.extent_,t)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const r=this.context_,i=e.getFlatCoordinates();let s=0;const a=e.getEnds(),o=e.getStride();r.beginPath();for(let l=0,c=a.length;l<c;++l)s=this.moveToLineTo_(i,s,a[l],o,!1);r.stroke()}if(this.text_!==""){const r=e.getFlatMidpoints();this.drawText_(r,0,r.length,2)}}}drawPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!vs(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_;t.beginPath(),this.drawRings_(e.getOrientedFlatCoordinates(),0,e.getEnds(),e.getStride()),this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoint();this.drawText_(t,0,2,2)}}}drawMultiPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!vs(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_,r=e.getOrientedFlatCoordinates();let i=0;const s=e.getEndss(),a=e.getStride();t.beginPath();for(let o=0,l=s.length;o<l;++o){const c=s[o];i=this.drawRings_(r,i,c,a)}this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoints();this.drawText_(t,0,t.length,2)}}}setContextFillState_(e){const t=this.context_,r=this.contextFillState_;r?r.fillStyle!=e.fillStyle&&(r.fillStyle=e.fillStyle,t.fillStyle=e.fillStyle):(t.fillStyle=e.fillStyle,this.contextFillState_={fillStyle:e.fillStyle})}setContextStrokeState_(e){const t=this.context_,r=this.contextStrokeState_;r?(r.lineCap!=e.lineCap&&(r.lineCap=e.lineCap,t.lineCap=e.lineCap),gc(r.lineDash,e.lineDash)||t.setLineDash(r.lineDash=e.lineDash),r.lineDashOffset!=e.lineDashOffset&&(r.lineDashOffset=e.lineDashOffset,t.lineDashOffset=e.lineDashOffset),r.lineJoin!=e.lineJoin&&(r.lineJoin=e.lineJoin,t.lineJoin=e.lineJoin),r.lineWidth!=e.lineWidth&&(r.lineWidth=e.lineWidth,t.lineWidth=e.lineWidth),r.miterLimit!=e.miterLimit&&(r.miterLimit=e.miterLimit,t.miterLimit=e.miterLimit),r.strokeStyle!=e.strokeStyle&&(r.strokeStyle=e.strokeStyle,t.strokeStyle=e.strokeStyle)):(t.lineCap=e.lineCap,t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset,t.lineJoin=e.lineJoin,t.lineWidth=e.lineWidth,t.miterLimit=e.miterLimit,t.strokeStyle=e.strokeStyle,this.contextStrokeState_={lineCap:e.lineCap,lineDash:e.lineDash,lineDashOffset:e.lineDashOffset,lineJoin:e.lineJoin,lineWidth:e.lineWidth,miterLimit:e.miterLimit,strokeStyle:e.strokeStyle})}setContextTextState_(e){const t=this.context_,r=this.contextTextState_,i=e.textAlign?e.textAlign:Tp;r?(r.font!=e.font&&(r.font=e.font,t.font=e.font),r.textAlign!=i&&(r.textAlign=i,t.textAlign=i),r.textBaseline!=e.textBaseline&&(r.textBaseline=e.textBaseline,t.textBaseline=e.textBaseline)):(t.font=e.font,t.textAlign=i,t.textBaseline=e.textBaseline,this.contextTextState_={font:e.font,textAlign:i,textBaseline:e.textBaseline})}setFillStrokeStyle(e,t){if(!e)this.fillState_=null;else{const r=e.getColor();this.fillState_={fillStyle:Qo(r||Os)}}if(!t)this.strokeState_=null;else{const r=t.getColor(),i=t.getLineCap(),s=t.getLineDash(),a=t.getLineDashOffset(),o=t.getLineJoin(),l=t.getWidth(),c=t.getMiterLimit(),h=s||Zl;this.strokeState_={lineCap:i!==void 0?i:M0,lineDash:this.pixelRatio_===1?h:h.map(g=>g*this.pixelRatio_),lineDashOffset:(a||Jl)*this.pixelRatio_,lineJoin:o!==void 0?o:L0,lineWidth:(l!==void 0?l:Rp)*this.pixelRatio_,miterLimit:c!==void 0?c:Sp,strokeStyle:Qo(r||bp)}}}setImageStyle(e){let t;if(!e||!(t=e.getSize())){this.image_=null;return}const r=e.getPixelRatio(this.pixelRatio_),i=e.getAnchor(),s=e.getOrigin();this.image_=e.getImage(this.pixelRatio_),this.imageAnchorX_=i[0]*r,this.imageAnchorY_=i[1]*r,this.imageHeight_=t[1]*r,this.imageOpacity_=e.getOpacity(),this.imageOriginX_=s[0],this.imageOriginY_=s[1],this.imageRotateWithView_=e.getRotateWithView(),this.imageRotation_=e.getRotation();const a=e.getScaleArray();this.imageScale_=[a[0]*this.pixelRatio_/r,a[1]*this.pixelRatio_/r],this.imageWidth_=t[0]*r}setTextStyle(e){if(!e)this.text_="";else{const t=e.getFill();if(!t)this.textFillState_=null;else{const y=t.getColor();this.textFillState_={fillStyle:Qo(y||Os)}}const r=e.getStroke();if(!r)this.textStrokeState_=null;else{const y=r.getColor(),_=r.getLineCap(),x=r.getLineDash(),w=r.getLineDashOffset(),b=r.getLineJoin(),T=r.getWidth(),k=r.getMiterLimit();this.textStrokeState_={lineCap:_!==void 0?_:M0,lineDash:x||Zl,lineDashOffset:w||Jl,lineJoin:b!==void 0?b:L0,lineWidth:T!==void 0?T:Rp,miterLimit:k!==void 0?k:Sp,strokeStyle:Qo(y||bp)}}const i=e.getFont(),s=e.getOffsetX(),a=e.getOffsetY(),o=e.getRotateWithView(),l=e.getRotation(),c=e.getScaleArray(),h=e.getText(),g=e.getTextAlign(),m=e.getTextBaseline();this.textState_={font:i!==void 0?i:nj,textAlign:g!==void 0?g:Tp,textBaseline:m!==void 0?m:G_},this.text_=h!==void 0?Array.isArray(h)?h.reduce((y,_,x)=>y+=x%2?" ":_,""):h:"",this.textOffsetX_=s!==void 0?this.pixelRatio_*s:0,this.textOffsetY_=a!==void 0?this.pixelRatio_*a:0,this.textRotateWithView_=o!==void 0?o:!1,this.textRotation_=l!==void 0?l:0,this.textScale_=[this.pixelRatio_*c[0],this.pixelRatio_*c[1]]}}}const mW=.5,sj={Point:SW,LineString:vW,Polygon:TW,MultiPoint:bW,MultiLineString:wW,MultiPolygon:EW,GeometryCollection:_W,Circle:yW};function pW(n,e){return parseInt(Kt(n),10)-parseInt(Kt(e),10)}function gN(n,e){const t=aj(n,e);return t*t}function aj(n,e){return mW*n/e}function yW(n,e,t,r,i){const s=t.getFill(),a=t.getStroke();if(s||a){const l=n.getBuilder(t.getZIndex(),"Circle");l.setFillStrokeStyle(s,a),l.drawCircle(e,r,i)}const o=t.getText();if(o&&o.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(o),l.drawText(e,r)}}function mN(n,e,t,r,i,s,a,o){const l=[],c=t.getImage();if(c){let m=!0;const y=c.getImageState();y==Rt.LOADED||y==Rt.ERROR?m=!1:y==Rt.IDLE&&c.load(),m&&l.push(c.ready())}const h=t.getFill();h&&h.loading()&&l.push(h.ready());const g=l.length>0;return g&&Promise.all(l).then(()=>i(null)),xW(n,e,t,r,s,a,o),g}function xW(n,e,t,r,i,s,a){const o=t.getGeometryFunction()(e);if(!o)return;const l=o.simplifyTransformed(r,i);if(t.getRenderer())oj(n,l,t,e,a);else{const h=sj[l.getType()];h(n,l,t,e,a,s)}}function oj(n,e,t,r,i){if(e.getType()=="GeometryCollection"){const a=e.getGeometries();for(let o=0,l=a.length;o<l;++o)oj(n,a[o],t,r,i);return}n.getBuilder(t.getZIndex(),"Default").drawCustom(e,r,t.getRenderer(),t.getHitDetectionRenderer(),i)}function _W(n,e,t,r,i,s){const a=e.getGeometriesArray();let o,l;for(o=0,l=a.length;o<l;++o){const c=sj[a[o].getType()];c(n,a[o],t,r,i,s)}}function vW(n,e,t,r,i){const s=t.getStroke();if(s){const o=n.getBuilder(t.getZIndex(),"LineString");o.setFillStrokeStyle(null,s),o.drawLineString(e,r,i)}const a=t.getText();if(a&&a.getText()){const o=n.getBuilder(t.getZIndex(),"Text");o.setTextStyle(a),o.drawText(e,r,i)}}function wW(n,e,t,r,i){const s=t.getStroke();if(s){const o=n.getBuilder(t.getZIndex(),"LineString");o.setFillStrokeStyle(null,s),o.drawMultiLineString(e,r,i)}const a=t.getText();if(a&&a.getText()){const o=n.getBuilder(t.getZIndex(),"Text");o.setTextStyle(a),o.drawText(e,r,i)}}function EW(n,e,t,r,i){const s=t.getFill(),a=t.getStroke();if(a||s){const l=n.getBuilder(t.getZIndex(),"Polygon");l.setFillStrokeStyle(s,a),l.drawMultiPolygon(e,r,i)}const o=t.getText();if(o&&o.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(o),l.drawText(e,r,i)}}function SW(n,e,t,r,i,s){const a=t.getImage(),o=t.getText(),l=o&&o.getText(),c=s&&a&&l?{}:void 0;if(a){if(a.getImageState()!=Rt.LOADED)return;const h=n.getBuilder(t.getZIndex(),"Image");h.setImageStyle(a,c),h.drawPoint(e,r,i)}if(l){const h=n.getBuilder(t.getZIndex(),"Text");h.setTextStyle(o,c),h.drawText(e,r,i)}}function bW(n,e,t,r,i,s){const a=t.getImage(),o=a&&a.getOpacity()!==0,l=t.getText(),c=l&&l.getText(),h=s&&o&&c?{}:void 0;if(o){if(a.getImageState()!=Rt.LOADED)return;const g=n.getBuilder(t.getZIndex(),"Image");g.setImageStyle(a,h),g.drawMultiPoint(e,r,i)}if(c){const g=n.getBuilder(t.getZIndex(),"Text");g.setTextStyle(l,h),g.drawText(e,r,i)}}function TW(n,e,t,r,i){const s=t.getFill(),a=t.getStroke();if(s||a){const l=n.getBuilder(t.getZIndex(),"Polygon");l.setFillStrokeStyle(s,a),l.drawPolygon(e,r,i)}const o=t.getText();if(o&&o.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(o),l.drawText(e,r,i)}}let RW=!1;function AW(n,e,t,r,i,s,a){const o=new XMLHttpRequest;o.open("GET",typeof n=="function"?n(t,r,i):n,!0),e.getType()=="arraybuffer"&&(o.responseType="arraybuffer"),o.withCredentials=RW,o.onload=function(l){if(!o.status||o.status>=200&&o.status<300){const c=e.getType();try{let h;c=="text"||c=="json"?h=o.responseText:c=="xml"?h=o.responseXML||o.responseText:c=="arraybuffer"&&(h=o.response),h?s(e.readFeatures(h,{extent:t,featureProjection:i}),e.readProjection(h)):a()}catch{a()}}else a()},o.onerror=a,o.send()}function pN(n,e){return function(t,r,i,s,a){AW(n,e,t,r,i,(o,l)=>{this.addFeatures(o),s!==void 0&&s(o)},()=>{this.changed(),a!==void 0&&a()})}}function kW(n,e){return[[-1/0,-1/0,1/0,1/0]]}function lj(n,e,t,r){const i=[];let s=zs();for(let a=0,o=t.length;a<o;++a){const l=t[a];s=YR(n,e,l[0],r),i.push((s[0]+s[2])/2,(s[1]+s[3])/2),e=l[l.length-1]}return i}function mA(n,e,t,r,i,s,a){let o,l,c,h,g,m,y;const _=i[s+1],x=[];for(let T=0,k=t.length;T<k;++T){const L=t[T];for(h=n[L-r],m=n[L-r+1],o=e;o<L;o+=r)g=n[o],y=n[o+1],(_<=m&&y<=_||m<=_&&_<=y)&&(c=(_-m)/(y-m)*(g-h)+h,x.push(c)),h=g,m=y}let w=NaN,b=-1/0;for(x.sort(Kl),h=x[0],o=1,l=x.length;o<l;++o){g=x[o];const T=Math.abs(g-h);T>b&&(c=(h+g)/2,oA(n,e,t,r,c,_)&&(w=c,b=T)),h=g}return isNaN(w)&&(w=i[s]),a?(a.push(w,_,b),a):[w,_,b]}function cj(n,e,t,r,i){let s=[];for(let a=0,o=t.length;a<o;++a){const l=t[a];s=mA(n,e,l,r,i,2*a,s),e=l[l.length-1]}return s}function IW(n,e,t,r){for(;e<t-r;){for(let i=0;i<r;++i){const s=n[e+i];n[e+i]=n[t-r+i],n[t-r+i]=s}e+=r,t-=r}}function pA(n,e,t,r){let i=0,s=n[t-r],a=n[t-r+1];for(;e<t;e+=r){const o=n[e],l=n[e+1];i+=(o-s)*(l+a),s=o,a=l}return i===0?void 0:i>0}function yA(n,e,t,r,i){i=i!==void 0?i:!1;for(let s=0,a=t.length;s<a;++s){const o=t[s],l=pA(n,e,o,r);if(s===0){if(i&&l||!i&&!l)return!1}else if(i&&!l||!i&&l)return!1;e=o}return!0}function uj(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s){const o=t[s];if(!yA(n,e,o,r,i))return!1;o.length&&(e=o[o.length-1])}return!0}function z_(n,e,t,r,i){i=i!==void 0?i:!1;for(let s=0,a=t.length;s<a;++s){const o=t[s],l=pA(n,e,o,r);(s===0?i&&l||!i&&!l:i&&!l||!i&&l)&&IW(n,e,o,r),e=o}return e}function gT(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s)e=z_(n,e,t[s],r,i);return e}function hj(n,e){const t=[];let r=0,i=0,s;for(let a=0,o=e.length;a<o;++a){const l=e[a],c=pA(n,r,l,2);if(s===void 0&&(s=c),c===s)t.push(e.slice(i,a+1));else{if(t.length===0)continue;t[t.length-1].push(e[i])}i=a+1,r=l}return t}class po extends VD{constructor(e){super(),this.geometries_=e,this.changeEventsKeys_=[],this.listenGeometriesChange_()}unlistenGeometriesChange_(){this.changeEventsKeys_.forEach(or),this.changeEventsKeys_.length=0}listenGeometriesChange_(){const e=this.geometries_;for(let t=0,r=e.length;t<r;++t)this.changeEventsKeys_.push(pn(e[t],en.CHANGE,this.changed,this))}clone(){const e=new po(TS(this.geometries_));return e.applyProperties(this),e}closestPointXY(e,t,r,i){if(i<kd(this.getExtent(),e,t))return i;const s=this.geometries_;for(let a=0,o=s.length;a<o;++a)i=s[a].closestPointXY(e,t,r,i);return i}containsXY(e,t){const r=this.geometries_;for(let i=0,s=r.length;i<s;++i)if(r[i].containsXY(e,t))return!0;return!1}computeExtent(e){y1(e);const t=this.geometries_;for(let r=0,i=t.length;r<i;++r)_D(e,t[r].getExtent());return e}getGeometries(){return TS(this.geometries_)}getGeometriesArray(){return this.geometries_}getGeometriesArrayRecursive(){let e=[];const t=this.geometries_;for(let r=0,i=t.length;r<i;++r)t[r].getType()===this.getType()?e=e.concat(t[r].getGeometriesArrayRecursive()):e.push(t[r]);return e}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<this.simplifiedGeometryMaxMinSquaredTolerance)return this;const t=[],r=this.geometries_;let i=!1;for(let s=0,a=r.length;s<a;++s){const o=r[s],l=o.getSimplifiedGeometry(e);t.push(l),l!==o&&(i=!0)}return i?new po(t):(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getType(){return"GeometryCollection"}intersectsExtent(e){const t=this.geometries_;for(let r=0,i=t.length;r<i;++r)if(t[r].intersectsExtent(e))return!0;return!1}isEmpty(){return this.geometries_.length===0}rotate(e,t){const r=this.geometries_;for(let i=0,s=r.length;i<s;++i)r[i].rotate(e,t);this.changed()}scale(e,t,r){r||(r=Eo(this.getExtent()));const i=this.geometries_;for(let s=0,a=i.length;s<a;++s)i[s].scale(e,t,r);this.changed()}setGeometries(e){this.setGeometriesArray(TS(e))}setGeometriesArray(e){this.unlistenGeometriesChange_(),this.geometries_=e,this.listenGeometriesChange_(),this.changed()}applyTransform(e){const t=this.geometries_;for(let r=0,i=t.length;r<i;++r)t[r].applyTransform(e);this.changed()}translate(e,t){const r=this.geometries_;for(let i=0,s=r.length;i<s;++i)r[i].translate(e,t);this.changed()}disposeInternal(){this.unlistenGeometriesChange_(),super.disposeInternal()}}function TS(n){return n.map(e=>e.clone())}function dj(n,e,t,r){let i=0;const s=n[t-r],a=n[t-r+1];let o=0,l=0;for(;e<t;e+=r){const c=n[e]-s,h=n[e+1]-a;i+=l*c-o*h,o=c,l=h}return i/2}function fj(n,e,t,r){let i=0;for(let s=0,a=t.length;s<a;++s){const o=t[s];i+=dj(n,e,o,r),e=o}return i}function CW(n,e,t,r){let i=0;for(let s=0,a=t.length;s<a;++s){const o=t[s];i+=fj(n,e,o,r),e=o[o.length-1]}return i}class Ap extends Cd{constructor(e,t){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,t!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}clone(){return new Ap(this.flatCoordinates.slice(),this.layout)}closestPointXY(e,t,r,i){return i<kd(this.getExtent(),e,t)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(rA(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),sA(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,e,t,r,i))}getArea(){return dj(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return du(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(e){const t=[];return t.length=kw(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new Ap(t,"XY")}getType(){return"LinearRing"}intersectsExtent(e){return!1}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Rw(this.flatCoordinates,0,e,this.stride),this.changed()}}class ic extends Cd{constructor(e,t,r){if(super(),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(e[0]))this.setCoordinates(e,t);else if(t!==void 0&&r)this.setFlatCoordinates(t,e),this.ends_=r;else{const i=e,s=[],a=[];for(let l=0,c=i.length;l<c;++l){const h=i[l];Un(s,h.getFlatCoordinates()),a.push(s.length)}const o=i.length===0?this.getLayout():i[0].getLayout();this.setFlatCoordinates(o,s),this.ends_=a}}appendLineString(e){Un(this.flatCoordinates,e.getFlatCoordinates().slice()),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new ic(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,t,r,i){return i<kd(this.getExtent(),e,t)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(iA(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),aA(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,e,t,r,i))}getCoordinateAtM(e,t,r){return this.layout!="XYM"&&this.layout!="XYZM"||this.flatCoordinates.length===0?null:(t=t!==void 0?t:!1,r=r!==void 0?r:!1,L$(this.flatCoordinates,0,this.ends_,this.stride,e,t,r))}getCoordinates(){return Ep(this.flatCoordinates,0,this.ends_,this.stride)}getEnds(){return this.ends_}getLineString(e){return e<0||this.ends_.length<=e?null:new bi(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLineStrings(){const e=this.flatCoordinates,t=this.ends_,r=this.layout,i=[];let s=0;for(let a=0,o=t.length;a<o;++a){const l=t[a],c=new bi(e.slice(s,l),r);i.push(c),s=l}return i}getLength(){const e=this.ends_;let t=0,r=0;for(let i=0,s=e.length;i<s;++i)r+=lA(this.flatCoordinates,t,e[i],this.stride),t=e[i];return r}getFlatMidpoints(){const e=[],t=this.flatCoordinates;let r=0;const i=this.ends_,s=this.stride;for(let a=0,o=i.length;a<o;++a){const l=i[a],c=F_(t,r,l,s,.5);Un(e,c),r=l}return e}getSimplifiedGeometryInternal(e){const t=[],r=[];return t.length=$D(this.flatCoordinates,0,this.ends_,this.stride,e,t,0,r),new ic(t,"XY",r)}getType(){return"MultiLineString"}intersectsExtent(e){return j$(this.flatCoordinates,0,this.ends_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const r=v1(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=r.length===0?0:r[r.length-1],this.changed()}}class Nd extends Cd{constructor(e,t){super(),t&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}appendPoint(e){Un(this.flatCoordinates,e.getFlatCoordinates()),this.changed()}clone(){const e=new Nd(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,r,i){if(i<kd(this.getExtent(),e,t))return i;const s=this.flatCoordinates,a=this.stride;for(let o=0,l=s.length;o<l;o+=a){const c=Yh(e,t,s[o],s[o+1]);if(c<i){i=c;for(let h=0;h<a;++h)r[h]=s[o+h];r.length=a}}return i}getCoordinates(){return du(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getPoint(e){const t=this.flatCoordinates.length/this.stride;return e<0||t<=e?null:new mi(this.flatCoordinates.slice(e*this.stride,(e+1)*this.stride),this.layout)}getPoints(){const e=this.flatCoordinates,t=this.layout,r=this.stride,i=[];for(let s=0,a=e.length;s<a;s+=r){const o=new mi(e.slice(s,s+r),t);i.push(o)}return i}getType(){return"MultiPoint"}intersectsExtent(e){const t=this.flatCoordinates,r=this.stride;for(let i=0,s=t.length;i<s;i+=r){const a=t[i],o=t[i+1];if(qR(e,a,o))return!0}return!1}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Rw(this.flatCoordinates,0,e,this.stride),this.changed()}}class Ua extends Cd{constructor(e,t,r){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,t!==void 0&&r?(this.setFlatCoordinates(t,e),this.ends_=r):this.setCoordinates(e,t)}appendLinearRing(e){this.flatCoordinates?Un(this.flatCoordinates,e.getFlatCoordinates()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new Ua(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,t,r,i){return i<kd(this.getExtent(),e,t)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(iA(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),aA(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,e,t,r,i))}containsXY(e,t){return oA(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,t)}getArea(){return fj(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(e){let t;return e!==void 0?(t=this.getOrientedFlatCoordinates().slice(),z_(t,0,this.ends_,this.stride,e)):t=this.flatCoordinates,Ep(t,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const e=Eo(this.getExtent());this.flatInteriorPoint_=mA(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new mi(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(e){return e<0||this.ends_.length<=e?null:new Ap(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLinearRings(){const e=this.layout,t=this.flatCoordinates,r=this.ends_,i=[];let s=0;for(let a=0,o=r.length;a<o;++a){const l=r[a],c=new Ap(t.slice(s,l),e);i.push(c),s=l}return i}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;yA(e,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=z_(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const t=[],r=[];return t.length=cA(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(e),t,0,r),new Ua(t,"XY",r)}getType(){return"Polygon"}intersectsExtent(e){return UD(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const r=v1(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=r.length===0?0:r[r.length-1],this.changed()}}function yN(n){if(sg(n))throw new Error("Cannot create polygon from empty extent");const e=n[0],t=n[1],r=n[2],i=n[3],s=[e,t,e,i,r,i,r,t,e,t];return new Ua(s,"XY",[s.length])}class cd extends Cd{constructor(e,t,r){if(super(),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!r&&!Array.isArray(e[0])){const i=e,s=[],a=[];for(let o=0,l=i.length;o<l;++o){const c=i[o],h=s.length,g=c.getEnds();for(let m=0,y=g.length;m<y;++m)g[m]+=h;Un(s,c.getFlatCoordinates()),a.push(g)}t=i.length===0?this.getLayout():i[0].getLayout(),e=s,r=a}t!==void 0&&r?(this.setFlatCoordinates(t,e),this.endss_=r):this.setCoordinates(e,t)}appendPolygon(e){let t;if(!this.flatCoordinates)this.flatCoordinates=e.getFlatCoordinates().slice(),t=e.getEnds().slice(),this.endss_.push();else{const r=this.flatCoordinates.length;Un(this.flatCoordinates,e.getFlatCoordinates()),t=e.getEnds().slice();for(let i=0,s=t.length;i<s;++i)t[i]+=r}this.endss_.push(t),this.changed()}clone(){const e=this.endss_.length,t=new Array(e);for(let i=0;i<e;++i)t[i]=this.endss_[i].slice();const r=new cd(this.flatCoordinates.slice(),this.layout,t);return r.applyProperties(this),r}closestPointXY(e,t,r,i){return i<kd(this.getExtent(),e,t)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(P$(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),N$(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,e,t,r,i))}containsXY(e,t){return D$(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e,t)}getArea(){return CW(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}getCoordinates(e){let t;return e!==void 0?(t=this.getOrientedFlatCoordinates().slice(),gT(t,0,this.endss_,this.stride,e)):t=this.flatCoordinates,cT(t,0,this.endss_,this.stride)}getEndss(){return this.endss_}getFlatInteriorPoints(){if(this.flatInteriorPointsRevision_!=this.getRevision()){const e=lj(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=cj(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}getInteriorPoints(){return new Nd(this.getFlatInteriorPoints().slice(),"XYM")}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;uj(e,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=gT(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const t=[],r=[];return t.length=B$(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(e),t,0,r),new cd(t,"XY",r)}getPolygon(e){if(e<0||this.endss_.length<=e)return null;let t;if(e===0)t=0;else{const s=this.endss_[e-1];t=s[s.length-1]}const r=this.endss_[e].slice(),i=r[r.length-1];if(t!==0)for(let s=0,a=r.length;s<a;++s)r[s]-=t;return new Ua(this.flatCoordinates.slice(t,i),this.layout,r)}getPolygons(){const e=this.layout,t=this.flatCoordinates,r=this.endss_,i=[];let s=0;for(let a=0,o=r.length;a<o;++a){const l=r[a].slice(),c=l[l.length-1];if(s!==0)for(let g=0,m=l.length;g<m;++g)l[g]-=s;const h=new Ua(t.slice(s,c),e,l);i.push(h),s=c}return i}getType(){return"MultiPolygon"}intersectsExtent(e){return F$(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,3),this.flatCoordinates||(this.flatCoordinates=[]);const r=BD(this.flatCoordinates,0,e,this.stride,this.endss_);if(r.length===0)this.flatCoordinates.length=0;else{const i=r[r.length-1];this.flatCoordinates.length=i.length===0?0:i[i.length-1]}this.changed()}}const xN=gi();class Ds{constructor(e,t,r,i,s,a){this.styleFunction,this.extent_,this.id_=a,this.type_=e,this.flatCoordinates_=t,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=r||null,this.properties_=s,this.squaredTolerance_,this.stride_=i,this.simplifiedGeometry_}get(e){return this.properties_[e]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?xD(this.flatCoordinates_):YR(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const e=Eo(this.getExtent());this.flatInteriorPoints_=mA(this.flatCoordinates_,0,this.ends_,2,e,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const e=hj(this.flatCoordinates_,this.ends_),t=lj(this.flatCoordinates_,0,e,2);this.flatInteriorPoints_=cj(this.flatCoordinates_,0,e,2,t)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=F_(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const e=this.flatCoordinates_;let t=0;const r=this.ends_;for(let i=0,s=r.length;i<s;++i){const a=r[i],o=F_(e,t,a,2,.5);Un(this.flatMidpoints_,o),t=a}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(e){return this}simplifyTransformed(e,t){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(e){e=ir(e);const t=e.getExtent(),r=e.getWorldExtent();if(t&&r){const i=ti(r)/ti(t);Ga(xN,r[0],r[3],i,-i,0,0,0),nl(this.flatCoordinates_,0,this.flatCoordinates_.length,2,xN,this.flatCoordinates_)}}applyTransform(e){e(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){return new Ds(this.type_,this.flatCoordinates_.slice(),this.ends_?.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=gD((e,t)=>{if(e===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),t&&this.simplifiedGeometry_.applyTransform(t);const r=this.simplifiedGeometry_.getFlatCoordinates();let i;switch(this.type_){case"LineString":r.length=kw(r,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,e,r,0),i=[r.length];break;case"MultiLineString":i=[],r.length=$D(r,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,e,r,0,i);break;case"Polygon":i=[],r.length=cA(r,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(e),r,0,i);break}return i&&(this.simplifiedGeometry_=new Ds(this.type_,r,i,2,this.properties_,this.id_)),this.squaredTolerance_=e,this.simplifiedGeometry_}),this}}Ds.prototype.getFlatCoordinates=Ds.prototype.getOrientedFlatCoordinates;function gj(n,e,t=0,r=n.length-1,i=PW){for(;r>t;){if(r-t>600){const l=r-t+1,c=e-t+1,h=Math.log(l),g=.5*Math.exp(2*h/3),m=.5*Math.sqrt(h*g*(l-g)/l)*(c-l/2<0?-1:1),y=Math.max(t,Math.floor(e-c*g/l+m)),_=Math.min(r,Math.floor(e+(l-c)*g/l+m));gj(n,e,y,_,i)}const s=n[e];let a=t,o=r;for(hm(n,t,e),i(n[r],s)>0&&hm(n,t,r);a<o;){for(hm(n,a,o),a++,o--;i(n[a],s)<0;)a++;for(;i(n[o],s)>0;)o--}i(n[t],s)===0?hm(n,t,o):(o++,hm(n,o,r)),o<=e&&(t=o+1),e<=o&&(r=o-1)}}function hm(n,e,t){const r=n[e];n[e]=n[t],n[t]=r}function PW(n,e){return n<e?-1:n>e?1:0}let mj=class{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let t=this.data;const r=[];if(!xx(e,t))return r;const i=this.toBBox,s=[];for(;t;){for(let a=0;a<t.children.length;a++){const o=t.children[a],l=t.leaf?i(o):o;xx(e,l)&&(t.leaf?r.push(o):AS(e,l)?this._all(o,r):s.push(o))}t=s.pop()}return r}collides(e){let t=this.data;if(!xx(e,t))return!1;const r=[];for(;t;){for(let i=0;i<t.children.length;i++){const s=t.children[i],a=t.leaf?this.toBBox(s):s;if(xx(e,a)){if(t.leaf||AS(e,a))return!0;r.push(s)}}t=r.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let r=0;r<e.length;r++)this.insert(e[r]);return this}let t=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=t;else if(this.data.height===t.height)this._splitRoot(this.data,t);else{if(this.data.height<t.height){const r=this.data;this.data=t,t=r}this._insert(t,this.data.height-t.height-1,!0)}return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=Uf([]),this}remove(e,t){if(!e)return this;let r=this.data;const i=this.toBBox(e),s=[],a=[];let o,l,c;for(;r||s.length;){if(r||(r=s.pop(),l=s[s.length-1],o=a.pop(),c=!0),r.leaf){const h=NW(e,r.children,t);if(h!==-1)return r.children.splice(h,1),s.push(r),this._condense(s),this}!c&&!r.leaf&&AS(r,i)?(s.push(r),a.push(o),o=0,l=r,r=r.children[0]):l?(o++,r=l.children[o],c=!1):r=null}return this}toBBox(e){return e}compareMinX(e,t){return e.minX-t.minX}compareMinY(e,t){return e.minY-t.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,t){const r=[];for(;e;)e.leaf?t.push(...e.children):r.push(...e.children),e=r.pop();return t}_build(e,t,r,i){const s=r-t+1;let a=this._maxEntries,o;if(s<=a)return o=Uf(e.slice(t,r+1)),bf(o,this.toBBox),o;i||(i=Math.ceil(Math.log(s)/Math.log(a)),a=Math.ceil(s/Math.pow(a,i-1))),o=Uf([]),o.leaf=!1,o.height=i;const l=Math.ceil(s/a),c=l*Math.ceil(Math.sqrt(a));_N(e,t,r,c,this.compareMinX);for(let h=t;h<=r;h+=c){const g=Math.min(h+c-1,r);_N(e,h,g,l,this.compareMinY);for(let m=h;m<=g;m+=l){const y=Math.min(m+l-1,g);o.children.push(this._build(e,m,y,i-1))}}return bf(o,this.toBBox),o}_chooseSubtree(e,t,r,i){for(;i.push(t),!(t.leaf||i.length-1===r);){let s=1/0,a=1/0,o;for(let l=0;l<t.children.length;l++){const c=t.children[l],h=RS(c),g=OW(e,c)-h;g<a?(a=g,s=h<s?h:s,o=c):g===a&&h<s&&(s=h,o=c)}t=o||t.children[0]}return t}_insert(e,t,r){const i=r?e:this.toBBox(e),s=[],a=this._chooseSubtree(i,this.data,t,s);for(a.children.push(e),Sm(a,i);t>=0&&s[t].children.length>this._maxEntries;)this._split(s,t),t--;this._adjustParentBBoxes(i,s,t)}_split(e,t){const r=e[t],i=r.children.length,s=this._minEntries;this._chooseSplitAxis(r,s,i);const a=this._chooseSplitIndex(r,s,i),o=Uf(r.children.splice(a,r.children.length-a));o.height=r.height,o.leaf=r.leaf,bf(r,this.toBBox),bf(o,this.toBBox),t?e[t-1].children.push(o):this._splitRoot(r,o)}_splitRoot(e,t){this.data=Uf([e,t]),this.data.height=e.height+1,this.data.leaf=!1,bf(this.data,this.toBBox)}_chooseSplitIndex(e,t,r){let i,s=1/0,a=1/0;for(let o=t;o<=r-t;o++){const l=Em(e,0,o,this.toBBox),c=Em(e,o,r,this.toBBox),h=DW(l,c),g=RS(l)+RS(c);h<s?(s=h,i=o,a=g<a?g:a):h===s&&g<a&&(a=g,i=o)}return i||r-t}_chooseSplitAxis(e,t,r){const i=e.leaf?this.compareMinX:MW,s=e.leaf?this.compareMinY:LW,a=this._allDistMargin(e,t,r,i),o=this._allDistMargin(e,t,r,s);a<o&&e.children.sort(i)}_allDistMargin(e,t,r,i){e.children.sort(i);const s=this.toBBox,a=Em(e,0,t,s),o=Em(e,r-t,r,s);let l=yx(a)+yx(o);for(let c=t;c<r-t;c++){const h=e.children[c];Sm(a,e.leaf?s(h):h),l+=yx(a)}for(let c=r-t-1;c>=t;c--){const h=e.children[c];Sm(o,e.leaf?s(h):h),l+=yx(o)}return l}_adjustParentBBoxes(e,t,r){for(let i=r;i>=0;i--)Sm(t[i],e)}_condense(e){for(let t=e.length-1,r;t>=0;t--)e[t].children.length===0?t>0?(r=e[t-1].children,r.splice(r.indexOf(e[t]),1)):this.clear():bf(e[t],this.toBBox)}};function NW(n,e,t){if(!t)return e.indexOf(n);for(let r=0;r<e.length;r++)if(t(n,e[r]))return r;return-1}function bf(n,e){Em(n,0,n.children.length,e,n)}function Em(n,e,t,r,i){i||(i=Uf(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(let s=e;s<t;s++){const a=n.children[s];Sm(i,n.leaf?r(a):a)}return i}function Sm(n,e){return n.minX=Math.min(n.minX,e.minX),n.minY=Math.min(n.minY,e.minY),n.maxX=Math.max(n.maxX,e.maxX),n.maxY=Math.max(n.maxY,e.maxY),n}function MW(n,e){return n.minX-e.minX}function LW(n,e){return n.minY-e.minY}function RS(n){return(n.maxX-n.minX)*(n.maxY-n.minY)}function yx(n){return n.maxX-n.minX+(n.maxY-n.minY)}function OW(n,e){return(Math.max(e.maxX,n.maxX)-Math.min(e.minX,n.minX))*(Math.max(e.maxY,n.maxY)-Math.min(e.minY,n.minY))}function DW(n,e){const t=Math.max(n.minX,e.minX),r=Math.max(n.minY,e.minY),i=Math.min(n.maxX,e.maxX),s=Math.min(n.maxY,e.maxY);return Math.max(0,i-t)*Math.max(0,s-r)}function AS(n,e){return n.minX<=e.minX&&n.minY<=e.minY&&e.maxX<=n.maxX&&e.maxY<=n.maxY}function xx(n,e){return e.minX<=n.maxX&&e.minY<=n.maxY&&e.maxX>=n.minX&&e.maxY>=n.minY}function Uf(n){return{children:n,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function _N(n,e,t,r,i){const s=[e,t];for(;s.length;){if(t=s.pop(),e=s.pop(),t-e<=r)continue;const a=e+Math.ceil((t-e)/r/2)*r;gj(n,a,e,t,i),s.push(e,a,a,t)}}class vN{constructor(e){this.rbush_=new mj(e),this.items_={}}insert(e,t){const r={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:t};this.rbush_.insert(r),this.items_[Kt(t)]=r}load(e,t){const r=new Array(t.length);for(let i=0,s=t.length;i<s;i++){const a=e[i],o=t[i],l={minX:a[0],minY:a[1],maxX:a[2],maxY:a[3],value:o};r[i]=l,this.items_[Kt(o)]=l}this.rbush_.load(r)}remove(e){const t=Kt(e),r=this.items_[t];return delete this.items_[t],this.rbush_.remove(r)!==null}update(e,t){const r=this.items_[Kt(t)],i=[r.minX,r.minY,r.maxX,r.maxY];ad(i,e)||(this.remove(t),this.insert(e,t))}getAll(){return this.rbush_.all().map(function(t){return t.value})}getInExtent(e){const t={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]};return this.rbush_.search(t).map(function(i){return i.value})}forEach(e){return this.forEach_(this.getAll(),e)}forEachInExtent(e,t){return this.forEach_(this.getInExtent(e),t)}forEach_(e,t){let r;for(let i=0,s=e.length;i<s;i++)if(r=t(e[i]),r)return r;return r}isEmpty(){return id(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(e){const t=this.rbush_.toJSON();return Nu(t.minX,t.minY,t.maxX,t.maxY,e)}concat(e){this.rbush_.load(e.rbush_.all());for(const t in e.items_)this.items_[t]=e.items_[t]}}class xA extends yl{constructor(e){super(),this.projection=ir(e.projection),this.attributions_=wN(e.attributions),this.attributionsCollapsible_=e.attributionsCollapsible??!0,this.loading=!1,this.state_=e.state!==void 0?e.state:"ready",this.wrapX_=e.wrapX!==void 0?e.wrapX:!1,this.interpolate_=!!e.interpolate,this.viewResolver=null,this.viewRejector=null;const t=this;this.viewPromise_=new Promise(function(r,i){t.viewResolver=r,t.viewRejector=i})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(e){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(e){this.attributions_=wN(e),this.changed()}setState(e){this.state_=e,this.changed()}}function wN(n){return n?typeof n=="function"?n:(Array.isArray(n)||(n=[n]),e=>n):null}const is={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};class $c extends pl{constructor(e,t,r){super(e),this.feature=t,this.features=r}}class xl extends xA{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:e.wrapX!==void 0?e.wrapX:!0}),this.on,this.once,this.un,this.loader_=_p,this.format_=e.format||null,this.overlaps_=e.overlaps===void 0?!0:e.overlaps,this.url_=e.url,e.loader!==void 0?this.loader_=e.loader:this.url_!==void 0&&(Rn(this.format_,"`format` must be set when `url` is set"),this.loader_=pN(this.url_,this.format_)),this.strategy_=e.strategy!==void 0?e.strategy:kW;const t=e.useSpatialIndex!==void 0?e.useSpatialIndex:!0;this.featuresRtree_=t?new vN:null,this.loadedExtentsRtree_=new vN,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let r,i;Array.isArray(e.features)?i=e.features:e.features&&(r=e.features,i=r.getArray()),!t&&r===void 0&&(r=new Ma(i)),i!==void 0&&this.addFeaturesInternal(i),r!==void 0&&this.bindFeaturesCollection_(r)}addFeature(e){this.addFeatureInternal(e),this.changed()}addFeatureInternal(e){const t=Kt(e);if(!this.addToIndex_(t,e)){this.featuresCollection_&&this.featuresCollection_.remove(e);return}this.setupChangeEvents_(t,e);const r=e.getGeometry();if(r){const i=r.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(i,e)}else this.nullGeometryFeatures_[t]=e;this.dispatchEvent(new $c(is.ADDFEATURE,e))}setupChangeEvents_(e,t){t instanceof Ds||(this.featureChangeKeys_[e]=[pn(t,en.CHANGE,this.handleFeatureChange_,this),pn(t,C0.PROPERTYCHANGE,this.handleFeatureChange_,this)])}addToIndex_(e,t){let r=!0;if(t.getId()!==void 0){const i=String(t.getId());if(!(i in this.idIndex_))this.idIndex_[i]=t;else if(t instanceof Ds){const s=this.idIndex_[i];s instanceof Ds?Array.isArray(s)?s.push(t):this.idIndex_[i]=[s,t]:r=!1}else r=!1}return r&&(Rn(!(e in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[e]=t),r}addFeatures(e){this.addFeaturesInternal(e),this.changed()}addFeaturesInternal(e){const t=[],r=[],i=[];for(let s=0,a=e.length;s<a;s++){const o=e[s],l=Kt(o);this.addToIndex_(l,o)&&r.push(o)}for(let s=0,a=r.length;s<a;s++){const o=r[s],l=Kt(o);this.setupChangeEvents_(l,o);const c=o.getGeometry();if(c){const h=c.getExtent();t.push(h),i.push(o)}else this.nullGeometryFeatures_[l]=o}if(this.featuresRtree_&&this.featuresRtree_.load(t,i),this.hasListener(is.ADDFEATURE))for(let s=0,a=r.length;s<a;s++)this.dispatchEvent(new $c(is.ADDFEATURE,r[s]))}bindFeaturesCollection_(e){let t=!1;this.addEventListener(is.ADDFEATURE,function(r){t||(t=!0,e.push(r.feature),t=!1)}),this.addEventListener(is.REMOVEFEATURE,function(r){t||(t=!0,e.remove(r.feature),t=!1)}),e.addEventListener(Ls.ADD,r=>{t||(t=!0,this.addFeature(r.element),t=!1)}),e.addEventListener(Ls.REMOVE,r=>{t||(t=!0,this.removeFeature(r.element),t=!1)}),this.featuresCollection_=e}clear(e){if(e){for(const r in this.featureChangeKeys_)this.featureChangeKeys_[r].forEach(or);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(r=>{this.removeFeatureInternal(r)});for(const r in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[r])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const t=new $c(is.CLEAR);this.dispatchEvent(t),this.changed()}forEachFeature(e){if(this.featuresRtree_)return this.featuresRtree_.forEach(e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureAtCoordinateDirect(e,t){const r=[e[0],e[1],e[0],e[1]];return this.forEachFeatureInExtent(r,function(i){const s=i.getGeometry();if(s instanceof Ds||s.intersectsCoordinate(e))return t(i)})}forEachFeatureInExtent(e,t){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(e,t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureIntersectingExtent(e,t){return this.forEachFeatureInExtent(e,function(r){const i=r.getGeometry();if(i instanceof Ds||i.intersectsExtent(e)){const s=t(r);if(s)return s}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let e;return this.featuresCollection_?e=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(e=this.featuresRtree_.getAll(),id(this.nullGeometryFeatures_)||Un(e,Object.values(this.nullGeometryFeatures_))),e}getFeaturesAtCoordinate(e){const t=[];return this.forEachFeatureAtCoordinateDirect(e,function(r){t.push(r)}),t}getFeaturesInExtent(e,t){if(this.featuresRtree_){if(!(t&&t.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(e);const i=bD(e,t);return[].concat(...i.map(s=>this.featuresRtree_.getInExtent(s)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(e,t){const r=e[0],i=e[1];let s=null;const a=[NaN,NaN];let o=1/0;const l=[-1/0,-1/0,1/0,1/0];return t=t||xp,this.featuresRtree_.forEachInExtent(l,function(c){if(t(c)){const h=c.getGeometry(),g=o;if(o=h instanceof Ds?0:h.closestPointXY(r,i,a,o),o<g){s=c;const m=Math.sqrt(o);l[0]=r-m,l[1]=i-m,l[2]=r+m,l[3]=i+m}}}),s}getExtent(e){return this.featuresRtree_.getExtent(e)}getFeatureById(e){const t=this.idIndex_[e.toString()];return t!==void 0?t:null}getFeatureByUid(e){const t=this.uidIndex_[e];return t!==void 0?t:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(e){const t=e.target,r=Kt(t),i=t.getGeometry();if(!i)r in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(t),this.nullGeometryFeatures_[r]=t);else{const a=i.getExtent();r in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[r],this.featuresRtree_&&this.featuresRtree_.insert(a,t)):this.featuresRtree_&&this.featuresRtree_.update(a,t)}const s=t.getId();if(s!==void 0){const a=s.toString();this.idIndex_[a]!==t&&(this.removeFromIdIndex_(t),this.idIndex_[a]=t)}else this.removeFromIdIndex_(t),this.uidIndex_[r]=t;this.changed(),this.dispatchEvent(new $c(is.CHANGEFEATURE,t))}hasFeature(e){const t=e.getId();return t!==void 0?t in this.idIndex_:Kt(e)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&id(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(e,t,r){const i=this.loadedExtentsRtree_,s=this.strategy_(e,t,r);for(let a=0,o=s.length;a<o;++a){const l=s[a];i.forEachInExtent(l,function(h){return uu(h.extent,l)})||(++this.loadingExtentsCount_,this.dispatchEvent(new $c(is.FEATURESLOADSTART)),this.loader_.call(this,l,t,r,h=>{--this.loadingExtentsCount_,this.dispatchEvent(new $c(is.FEATURESLOADEND,void 0,h))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new $c(is.FEATURESLOADERROR))}),i.insert(l,{extent:l.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(e){const t=this.loadedExtentsRtree_,r=t.forEachInExtent(e,function(i){if(ad(i.extent,e))return i});r&&t.remove(r)}removeFeatures(e){let t=!1;for(let r=0,i=e.length;r<i;++r)t=this.removeFeatureInternal(e[r])||t;t&&this.changed()}removeFeature(e){if(!e)return;this.removeFeatureInternal(e)&&this.changed()}removeFeatureInternal(e){const t=Kt(e);if(!(t in this.uidIndex_))return!1;t in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[t]:this.featuresRtree_&&this.featuresRtree_.remove(e),this.featureChangeKeys_[t]?.forEach(or),delete this.featureChangeKeys_[t];const i=e.getId();if(i!==void 0){const s=i.toString(),a=this.idIndex_[s];a===e?delete this.idIndex_[s]:Array.isArray(a)&&(a.splice(a.indexOf(e),1),a.length===1&&(this.idIndex_[s]=a[0]))}return delete this.uidIndex_[t],this.hasListener(is.REMOVEFEATURE)&&this.dispatchEvent(new $c(is.REMOVEFEATURE,e)),!0}removeFromIdIndex_(e){for(const t in this.idIndex_)if(this.idIndex_[t]===e){delete this.idIndex_[t];break}}setLoader(e){this.loader_=e}setUrl(e){Rn(this.format_,"`format` must be set when `url` is set"),this.url_=e,this.setLoader(pN(e,this.format_))}setOverlaps(e){this.overlaps_=e,this.changed()}}class Jn{constructor(e){e=e||{},this.patternImage_=null,this.color_=null,e.color!==void 0&&this.setColor(e.color)}clone(){const e=this.getColor();return new Jn({color:Array.isArray(e)?e.slice():e||void 0})}getColor(){return this.color_}setColor(e){if(e!==null&&typeof e=="object"&&"src"in e){const t=B_(null,e.src,"anonymous",void 0,e.offset?null:e.color?e.color:null,!(e.offset&&e.size));t.ready().then(()=>{this.patternImage_=null}),t.getImageState()===Rt.IDLE&&t.load(),t.getImageState()===Rt.LOADING&&(this.patternImage_=t)}this.color_=e}getKey(){const e=this.getColor();return e?e instanceof CanvasPattern||e instanceof CanvasGradient?Kt(e):typeof e=="object"&&"src"in e?e.src+":"+e.offset:za(e).toString():""}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}class Hn{constructor(e){e=e||{},this.color_=e.color!==void 0?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=e.lineDash!==void 0?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width}clone(){const e=this.getColor();return new Hn({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(e){this.color_=e}setLineCap(e){this.lineCap_=e}setLineDash(e){this.lineDash_=e}setLineDashOffset(e){this.lineDashOffset_=e}setLineJoin(e){this.lineJoin_=e}setMiterLimit(e){this.miterLimit_=e}setWidth(e){this.width_=e}}function EN(n){return n[0]>0&&n[1]>0}function jW(n,e,t){return t===void 0&&(t=[0,0]),t[0]=n[0]*e+.5|0,t[1]=n[1]*e+.5|0,t}function Es(n,e){return Array.isArray(n)?n:(e===void 0?e=[n,n]:(e[0]=n,e[1]=n),e)}class Cw{constructor(e){this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=Es(e.scale),this.displacement_=e.displacement,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new Cw({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return Xt()}getImage(e){return Xt()}getHitDetectionImage(){return Xt()}getPixelRatio(e){return 1}getImageState(){return Xt()}getImageSize(){return Xt()}getOrigin(){return Xt()}getSize(){return Xt()}setDisplacement(e){this.displacement_=e}setOpacity(e){this.opacity_=e}setRotateWithView(e){this.rotateWithView_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=Es(e)}listenImageChange(e){Xt()}load(){Xt()}unlistenImageChange(e){Xt()}ready(){return Promise.resolve()}}class Pw extends Cw{constructor(e){super({opacity:1,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,rotation:e.rotation!==void 0?e.rotation:0,scale:e.scale!==void 0?e.scale:1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=e.fill!==void 0?e.fill:null,this.origin_=[0,0],this.points_=e.points,this.radius=e.radius,this.radius2_=e.radius2,this.angle_=e.angle!==void 0?e.angle:0,this.stroke_=e.stroke!==void 0?e.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?Rt.LOADING:Rt.LOADED,this.imageState_===Rt.LOADING&&this.ready().then(()=>this.imageState_=Rt.LOADED),this.render()}clone(){const e=this.getScale(),t=new Pw({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}getAnchor(){const e=this.size_,t=this.getDisplacement(),r=this.getScaleArray();return[e[0]/2-t[0]/r[0],e[1]/2+t[1]/r[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(e){this.fill_=e,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(e){const t=this.fill_?.getKey(),r=`${e},${this.angle_},${this.radius},${this.radius2_},${this.points_},${t}`+Object.values(this.renderOptions_).join(",");let i=La.get(r,null,null)?.getImage(1);if(!i){const s=this.renderOptions_,a=Math.ceil(s.size*e),o=ri(a,a);this.draw_(s,o,e),i=o.canvas,La.set(r,null,null,new ej(i,void 0,null,Rt.LOADED,null))}return i}getPixelRatio(e){return e}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e,this.render()}listenImageChange(e){}load(){}unlistenImageChange(e){}calculateLineJoinSize_(e,t,r){if(t===0||this.points_===1/0||e!=="bevel"&&e!=="miter")return t;let i=this.radius,s=this.radius2_===void 0?i:this.radius2_;if(i<s){const B=i;i=s,s=B}const a=this.radius2_===void 0?this.points_:this.points_*2,o=2*Math.PI/a,l=s*Math.sin(o),c=Math.sqrt(s*s-l*l),h=i-c,g=Math.sqrt(l*l+h*h),m=g/l;if(e==="miter"&&m<=r)return m*t;const y=t/2/m,_=t/2*(h/g),w=Math.sqrt((i+y)*(i+y)+_*_)-i;if(this.radius2_===void 0||e==="bevel")return w*2;const b=i*Math.sin(o),T=Math.sqrt(i*i-b*b),k=s-T,O=Math.sqrt(b*b+k*k)/b;if(O<=r){const B=O*t/2-s-i;return 2*Math.max(w,B)}return w*2}createRenderOptions(){let e=M0,t=L0,r=0,i=null,s=0,a,o=0;this.stroke_&&(a=Qo(this.stroke_.getColor()??bp),o=this.stroke_.getWidth()??Rp,i=this.stroke_.getLineDash(),s=this.stroke_.getLineDashOffset()??0,t=this.stroke_.getLineJoin()??L0,e=this.stroke_.getLineCap()??M0,r=this.stroke_.getMiterLimit()??Sp);const l=this.calculateLineJoinSize_(t,o,r),c=Math.max(this.radius,this.radius2_||0),h=Math.ceil(2*c+l);return{strokeStyle:a,strokeWidth:o,size:h,lineCap:e,lineDash:i,lineDashOffset:s,lineJoin:t,miterLimit:r}}render(){this.renderOptions_=this.createRenderOptions();const e=this.renderOptions_.size;this.hitDetectionCanvas_=null,this.size_=[e,e]}draw_(e,t,r){if(t.scale(r,r),t.translate(e.size/2,e.size/2),this.createPath_(t),this.fill_){let i=this.fill_.getColor();i===null&&(i=Os),t.fillStyle=Qo(i),t.fill()}e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineCap=e.lineCap,t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}createHitDetectionCanvas_(e){let t;if(this.fill_){let r=this.fill_.getColor(),i=0;typeof r=="string"&&(r=za(r)),r===null?i=1:Array.isArray(r)&&(i=r.length===4?r[3]:1),i===0&&(t=ri(e.size,e.size),this.drawHitDetectionCanvas_(e,t))}return t?t.canvas:this.getImage(1)}createPath_(e){let t=this.points_;const r=this.radius;if(t===1/0)e.arc(0,0,r,0,2*Math.PI);else{const i=this.radius2_===void 0?r:this.radius2_;this.radius2_!==void 0&&(t*=2);const s=this.angle_-Math.PI/2,a=2*Math.PI/t;for(let o=0;o<t;o++){const l=s+o*a,c=o%2===0?r:i;e.lineTo(c*Math.cos(l),c*Math.sin(l))}e.closePath()}}drawHitDetectionCanvas_(e,t){t.translate(e.size/2,e.size/2),this.createPath_(t),t.fillStyle=Os,t.fill(),e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}class Us extends Pw{constructor(e){e=e||{radius:5},super({points:1/0,fill:e.fill,radius:e.radius,stroke:e.stroke,scale:e.scale!==void 0?e.scale:1,rotation:e.rotation!==void 0?e.rotation:0,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode})}clone(){const e=this.getScale(),t=new Us({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}setRadius(e){this.radius=e,this.render()}}class gn{constructor(e){e=e||{},this.geometry_=null,this.geometryFunction_=SN,e.geometry!==void 0&&this.setGeometry(e.geometry),this.fill_=e.fill!==void 0?e.fill:null,this.image_=e.image!==void 0?e.image:null,this.renderer_=e.renderer!==void 0?e.renderer:null,this.hitDetectionRenderer_=e.hitDetectionRenderer!==void 0?e.hitDetectionRenderer:null,this.stroke_=e.stroke!==void 0?e.stroke:null,this.text_=e.text!==void 0?e.text:null,this.zIndex_=e.zIndex}clone(){let e=this.getGeometry();return e&&typeof e=="object"&&(e=e.clone()),new gn({geometry:e??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(e){this.renderer_=e}setHitDetectionRenderer(e){this.hitDetectionRenderer_=e}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(e){this.fill_=e}getImage(){return this.image_}setImage(e){this.image_=e}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e}getText(){return this.text_}setText(e){this.text_=e}getZIndex(){return this.zIndex_}setGeometry(e){typeof e=="function"?this.geometryFunction_=e:typeof e=="string"?this.geometryFunction_=function(t){return t.get(e)}:e?e!==void 0&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=SN,this.geometry_=e}setZIndex(e){this.zIndex_=e}}function FW(n){let e;if(typeof n=="function")e=n;else{let t;Array.isArray(n)?t=n:(Rn(typeof n.getZIndex=="function","Expected an `Style` or an array of `Style`"),t=[n]),e=function(){return t}}return e}let kS=null;function pj(n,e){if(!kS){const t=new Jn({color:"rgba(255,255,255,0.4)"}),r=new Hn({color:"#3399CC",width:1.25});kS=[new gn({image:new Us({fill:t,stroke:r,radius:5}),fill:t,stroke:r})]}return kS}function SN(n){return n.getGeometry()}const VW="#333";class yo{constructor(e){e=e||{},this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.keepUpright_=e.keepUpright,this.scale_=e.scale,this.scaleArray_=Es(e.scale!==void 0?e.scale:1),this.text_=e.text,this.textAlign_=e.textAlign,this.justify_=e.justify,this.repeat_=e.repeat,this.textBaseline_=e.textBaseline,this.fill_=e.fill!==void 0?e.fill:new Jn({color:VW}),this.maxAngle_=e.maxAngle!==void 0?e.maxAngle:Math.PI/4,this.placement_=e.placement!==void 0?e.placement:"point",this.overflow_=!!e.overflow,this.stroke_=e.stroke!==void 0?e.stroke:null,this.offsetX_=e.offsetX!==void 0?e.offsetX:0,this.offsetY_=e.offsetY!==void 0?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=e.padding===void 0?null:e.padding,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new yo({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),keepUpright:this.getKeepUpright(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()instanceof Jn?this.getFill().clone():this.getFill(),stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getKeepUpright(){return this.keepUpright_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(e){this.overflow_=e}setFont(e){this.font_=e}setMaxAngle(e){this.maxAngle_=e}setOffsetX(e){this.offsetX_=e}setOffsetY(e){this.offsetY_=e}setPlacement(e){this.placement_=e}setRepeat(e){this.repeat_=e}setRotateWithView(e){this.rotateWithView_=e}setKeepUpright(e){this.keepUpright_=e}setFill(e){this.fill_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=Es(e!==void 0?e:1)}setStroke(e){this.stroke_=e}setText(e){this.text_=e}setTextAlign(e){this.textAlign_=e}setJustify(e){this.justify_=e}setTextBaseline(e){this.textBaseline_=e}setBackgroundFill(e){this.backgroundFill_=e}setBackgroundStroke(e){this.backgroundStroke_=e}setPadding(e){this.padding_=e}}const Qr={ANIMATING:0,INTERACTING:1},Vt={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},_x=[Vt.FILL],gu=[Vt.STROKE],Uh=[Vt.BEGIN_PATH],bN=[Vt.CLOSE_PATH];class E1 extends tj{constructor(e,t,r,i){super(),this.tolerance=e,this.maxExtent=t,this.pixelRatio=i,this.maxLineWidth=0,this.resolution=r,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(e){const t=this.pixelRatio;return t==1?e:e.map(function(r){return r*t})}appendFlatPointCoordinates(e,t){const r=this.getBufferedMaxExtent(),i=this.tmpCoordinate_,s=this.coordinates;let a=s.length;for(let o=0,l=e.length;o<l;o+=t)i[0]=e[o],i[1]=e[o+1],sd(r,i)&&(s[a++]=i[0],s[a++]=i[1]);return a}appendFlatLineCoordinates(e,t,r,i,s,a){const o=this.coordinates;let l=o.length;const c=this.getBufferedMaxExtent();a&&(t+=i);let h=e[t],g=e[t+1];const m=this.tmpCoordinate_;let y=!0,_,x,w;for(_=t+i;_<r;_+=i)m[0]=e[_],m[1]=e[_+1],w=eT(c,m),w!==x?(y&&(o[l++]=h,o[l++]=g,y=!1),o[l++]=m[0],o[l++]=m[1]):w===wi.INTERSECTING?(o[l++]=m[0],o[l++]=m[1],y=!1):y=!0,h=m[0],g=m[1],x=w;return(s&&y||_===t+i)&&(o[l++]=h,o[l++]=g),l}drawCustomCoordinates_(e,t,r,i,s){for(let a=0,o=r.length;a<o;++a){const l=r[a],c=this.appendFlatLineCoordinates(e,t,l,i,!1,!1);s.push(c),t=l}return t}drawCustom(e,t,r,i,s){this.beginGeometry(e,t,s);const a=e.getType(),o=e.getStride(),l=this.coordinates.length;let c,h,g,m,y;switch(a){case"MultiPolygon":c=e.getOrientedFlatCoordinates(),m=[];const _=e.getEndss();y=0;for(let x=0,w=_.length;x<w;++x){const b=[];y=this.drawCustomCoordinates_(c,y,_[x],o,b),m.push(b)}this.instructions.push([Vt.CUSTOM,l,m,e,r,cT,s]),this.hitDetectionInstructions.push([Vt.CUSTOM,l,m,e,i||r,cT,s]);break;case"Polygon":case"MultiLineString":g=[],c=a=="Polygon"?e.getOrientedFlatCoordinates():e.getFlatCoordinates(),y=this.drawCustomCoordinates_(c,0,e.getEnds(),o,g),this.instructions.push([Vt.CUSTOM,l,g,e,r,Ep,s]),this.hitDetectionInstructions.push([Vt.CUSTOM,l,g,e,i||r,Ep,s]);break;case"LineString":case"Circle":c=e.getFlatCoordinates(),h=this.appendFlatLineCoordinates(c,0,c.length,o,!1,!1),this.instructions.push([Vt.CUSTOM,l,h,e,r,du,s]),this.hitDetectionInstructions.push([Vt.CUSTOM,l,h,e,i||r,du,s]);break;case"MultiPoint":c=e.getFlatCoordinates(),h=this.appendFlatPointCoordinates(c,o),h>l&&(this.instructions.push([Vt.CUSTOM,l,h,e,r,du,s]),this.hitDetectionInstructions.push([Vt.CUSTOM,l,h,e,i||r,du,s]));break;case"Point":c=e.getFlatCoordinates(),this.coordinates.push(c[0],c[1]),h=this.coordinates.length,this.instructions.push([Vt.CUSTOM,l,h,e,r,void 0,s]),this.hitDetectionInstructions.push([Vt.CUSTOM,l,h,e,i||r,void 0,s]);break}this.endGeometry(t)}beginGeometry(e,t,r){this.beginGeometryInstruction1_=[Vt.BEGIN_GEOMETRY,t,0,e,r],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[Vt.BEGIN_GEOMETRY,t,0,e,r],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const e=this.hitDetectionInstructions;e.reverse();let t;const r=e.length;let i,s,a=-1;for(t=0;t<r;++t)i=e[t],s=i[0],s==Vt.END_GEOMETRY?a=t:s==Vt.BEGIN_GEOMETRY&&(i[2]=t,MU(this.hitDetectionInstructions,a,t),a=-1)}fillStyleToState(e,t={}){if(e){const r=e.getColor();t.fillPatternScale=r&&typeof r=="object"&&"src"in r?this.pixelRatio:1,t.fillStyle=Qo(r||Os)}else t.fillStyle=void 0;return t}strokeStyleToState(e,t={}){if(e){const r=e.getColor();t.strokeStyle=Qo(r||bp);const i=e.getLineCap();t.lineCap=i!==void 0?i:M0;const s=e.getLineDash();t.lineDash=s?s.slice():Zl;const a=e.getLineDashOffset();t.lineDashOffset=a||Jl;const o=e.getLineJoin();t.lineJoin=o!==void 0?o:L0;const l=e.getWidth();t.lineWidth=l!==void 0?l:Rp;const c=e.getMiterLimit();t.miterLimit=c!==void 0?c:Sp,t.lineWidth>this.maxLineWidth&&(this.maxLineWidth=t.lineWidth,this.bufferedMaxExtent_=null)}else t.strokeStyle=void 0,t.lineCap=void 0,t.lineDash=null,t.lineDashOffset=void 0,t.lineJoin=void 0,t.lineWidth=void 0,t.miterLimit=void 0;return t}setFillStrokeStyle(e,t){const r=this.state;this.fillStyleToState(e,r),this.strokeStyleToState(t,r)}createFill(e){const t=e.fillStyle,r=[Vt.SET_FILL_STYLE,t];return typeof t!="string"&&r.push(e.fillPatternScale),r}applyStroke(e){this.instructions.push(this.createStroke(e))}createStroke(e){return[Vt.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth*this.pixelRatio,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash?this.applyPixelRatio(e.lineDash):null,e.lineDashOffset*this.pixelRatio]}updateFillStyle(e,t){const r=e.fillStyle;(typeof r!="string"||e.currentFillStyle!=r)&&(this.instructions.push(t.call(this,e)),e.currentFillStyle=r)}updateStrokeStyle(e,t){const r=e.strokeStyle,i=e.lineCap,s=e.lineDash,a=e.lineDashOffset,o=e.lineJoin,l=e.lineWidth,c=e.miterLimit;(e.currentStrokeStyle!=r||e.currentLineCap!=i||s!=e.currentLineDash&&!gc(e.currentLineDash,s)||e.currentLineDashOffset!=a||e.currentLineJoin!=o||e.currentLineWidth!=l||e.currentMiterLimit!=c)&&(t.call(this,e),e.currentStrokeStyle=r,e.currentLineCap=i,e.currentLineDash=s,e.currentLineDashOffset=a,e.currentLineJoin=o,e.currentLineWidth=l,e.currentMiterLimit=c)}endGeometry(e){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const t=[Vt.END_GEOMETRY,e];this.instructions.push(t),this.hitDetectionInstructions.push(t)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=yD(this.maxExtent),this.maxLineWidth>0)){const e=this.resolution*(this.maxLineWidth+1)/2;Xl(this.bufferedMaxExtent_,e,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}class BW extends E1{constructor(e,t,r,i){super(e,t,r,i),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(e,t,r){if(!this.image_||this.maxExtent&&!sd(this.maxExtent,e.getFlatCoordinates()))return;this.beginGeometry(e,t,r);const i=e.getFlatCoordinates(),s=e.getStride(),a=this.coordinates.length,o=this.appendFlatPointCoordinates(i,s);this.instructions.push([Vt.DRAW_IMAGE,a,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Vt.DRAW_IMAGE,a,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}drawMultiPoint(e,t,r){if(!this.image_)return;this.beginGeometry(e,t,r);const i=e.getFlatCoordinates(),s=[];for(let l=0,c=i.length;l<c;l+=e.getStride())(!this.maxExtent||sd(this.maxExtent,i.slice(l,l+2)))&&s.push(i[l],i[l+1]);const a=this.coordinates.length,o=this.appendFlatPointCoordinates(s,2);this.instructions.push([Vt.DRAW_IMAGE,a,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Vt.DRAW_IMAGE,a,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(e,t){const r=e.getAnchor(),i=e.getSize(),s=e.getOrigin();this.imagePixelRatio_=e.getPixelRatio(this.pixelRatio),this.anchorX_=r[0],this.anchorY_=r[1],this.hitDetectionImage_=e.getHitDetectionImage(),this.image_=e.getImage(this.pixelRatio),this.height_=i[1],this.opacity_=e.getOpacity(),this.originX_=s[0],this.originY_=s[1],this.rotateWithView_=e.getRotateWithView(),this.rotation_=e.getRotation(),this.scale_=e.getScaleArray(),this.width_=i[0],this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}class GW extends E1{constructor(e,t,r,i){super(e,t,r,i)}drawFlatCoordinates_(e,t,r,i){const s=this.coordinates.length,a=this.appendFlatLineCoordinates(e,t,r,i,!1,!1),o=[Vt.MOVE_TO_LINE_TO,s,a];return this.instructions.push(o),this.hitDetectionInstructions.push(o),r}drawLineString(e,t,r){const i=this.state,s=i.strokeStyle,a=i.lineWidth;if(s===void 0||a===void 0)return;this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(e,t,r),this.hitDetectionInstructions.push([Vt.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Zl,Jl],Uh);const o=e.getFlatCoordinates(),l=e.getStride();this.drawFlatCoordinates_(o,0,o.length,l),this.hitDetectionInstructions.push(gu),this.endGeometry(t)}drawMultiLineString(e,t,r){const i=this.state,s=i.strokeStyle,a=i.lineWidth;if(s===void 0||a===void 0)return;this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(e,t,r),this.hitDetectionInstructions.push([Vt.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Zl,Jl],Uh);const o=e.getEnds(),l=e.getFlatCoordinates(),c=e.getStride();let h=0;for(let g=0,m=o.length;g<m;++g)h=this.drawFlatCoordinates_(l,h,o[g],c);this.hitDetectionInstructions.push(gu),this.endGeometry(t)}finish(){const e=this.state;return e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&this.instructions.push(gu),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(e){e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&(this.instructions.push(gu),e.lastStroke=this.coordinates.length),e.lastStroke=0,super.applyStroke(e),this.instructions.push(Uh)}}class TN extends E1{constructor(e,t,r,i){super(e,t,r,i)}drawFlatCoordinatess_(e,t,r,i){const s=this.state,a=s.fillStyle!==void 0,o=s.strokeStyle!==void 0,l=r.length;this.instructions.push(Uh),this.hitDetectionInstructions.push(Uh);for(let c=0;c<l;++c){const h=r[c],g=this.coordinates.length,m=this.appendFlatLineCoordinates(e,t,h,i,!0,!o),y=[Vt.MOVE_TO_LINE_TO,g,m];this.instructions.push(y),this.hitDetectionInstructions.push(y),o&&(this.instructions.push(bN),this.hitDetectionInstructions.push(bN)),t=h}return a&&(this.instructions.push(_x),this.hitDetectionInstructions.push(_x)),o&&(this.instructions.push(gu),this.hitDetectionInstructions.push(gu)),t}drawCircle(e,t,r){const i=this.state,s=i.fillStyle,a=i.strokeStyle;if(s===void 0&&a===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,r),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([Vt.SET_FILL_STYLE,Os]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Vt.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Zl,Jl]);const o=e.getFlatCoordinates(),l=e.getStride(),c=this.coordinates.length;this.appendFlatLineCoordinates(o,0,o.length,l,!1,!1);const h=[Vt.CIRCLE,c];this.instructions.push(Uh,h),this.hitDetectionInstructions.push(Uh,h),i.fillStyle!==void 0&&(this.instructions.push(_x),this.hitDetectionInstructions.push(_x)),i.strokeStyle!==void 0&&(this.instructions.push(gu),this.hitDetectionInstructions.push(gu)),this.endGeometry(t)}drawPolygon(e,t,r){const i=this.state,s=i.fillStyle,a=i.strokeStyle;if(s===void 0&&a===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,r),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([Vt.SET_FILL_STYLE,Os]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Vt.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Zl,Jl]);const o=e.getEnds(),l=e.getOrientedFlatCoordinates(),c=e.getStride();this.drawFlatCoordinatess_(l,0,o,c),this.endGeometry(t)}drawMultiPolygon(e,t,r){const i=this.state,s=i.fillStyle,a=i.strokeStyle;if(s===void 0&&a===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,r),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([Vt.SET_FILL_STYLE,Os]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Vt.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Zl,Jl]);const o=e.getEndss(),l=e.getOrientedFlatCoordinates(),c=e.getStride();let h=0;for(let g=0,m=o.length;g<m;++g)h=this.drawFlatCoordinatess_(l,h,o[g],c);this.endGeometry(t)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const e=this.tolerance;if(e!==0){const t=this.coordinates;for(let r=0,i=t.length;r<i;++r)t[r]=Th(t[r],e)}return super.finish()}setFillStrokeStyles_(){const e=this.state;this.updateFillStyle(e,this.createFill),this.updateStrokeStyle(e,this.applyStroke)}}function zW(n,e,t,r,i){const s=[];let a=t,o=0,l=e.slice(t,2);for(;o<n&&a+i<r;){const[c,h]=l.slice(-2),g=e[a+i],m=e[a+i+1],y=Math.sqrt((g-c)*(g-c)+(m-h)*(m-h));if(o+=y,o>=n){const _=(n-o+y)/y,x=aa(c,g,_),w=aa(h,m,_);l.push(x,w),s.push(l),l=[x,w],o==n&&(a+=i),o=0}else if(o<n)l.push(e[a+i],e[a+i+1]),a+=i;else{const _=y-o,x=aa(c,g,_/y),w=aa(h,m,_/y);l.push(x,w),s.push(l),l=[x,w],o=0,a+=i}}return o>0&&s.push(l),s}function UW(n,e,t,r,i){let s=t,a=t,o=0,l=0,c=t,h,g,m,y,_,x,w,b,T,k;for(g=t;g<r;g+=i){const L=e[g],O=e[g+1];_!==void 0&&(T=L-_,k=O-x,y=Math.sqrt(T*T+k*k),w!==void 0&&(l+=m,h=Math.acos((w*T+b*k)/(m*y)),h>n&&(l>o&&(o=l,s=c,a=g),l=0,c=g-i)),m=y,w=T,b=k),_=L,x=O}return l+=y,l>o?[c,g]:[s,a]}const U_={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class $W extends E1{constructor(e,t,r,i){super(e,t,r,i),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textKeepUpright_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[Os]={fillStyle:Os},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const e=super.finish();return e.textStates=this.textStates,e.fillStates=this.fillStates,e.strokeStates=this.strokeStates,e}drawText(e,t,r){const i=this.textFillState_,s=this.textStrokeState_,a=this.textState_;if(this.text_===""||!a||!i&&!s)return;const o=this.coordinates;let l=o.length;const c=e.getType();let h=null,g=e.getStride();if(a.placement==="line"&&(c=="LineString"||c=="MultiLineString"||c=="Polygon"||c=="MultiPolygon")){if(!vs(this.maxExtent,e.getExtent()))return;let m;if(h=e.getFlatCoordinates(),c=="LineString")m=[h.length];else if(c=="MultiLineString")m=e.getEnds();else if(c=="Polygon")m=e.getEnds().slice(0,1);else if(c=="MultiPolygon"){const w=e.getEndss();m=[];for(let b=0,T=w.length;b<T;++b)m.push(w[b][0])}this.beginGeometry(e,t,r);const y=a.repeat,_=y?void 0:a.textAlign;let x=0;for(let w=0,b=m.length;w<b;++w){let T;y?T=zW(y*this.resolution,h,x,m[w],g):T=[h.slice(x,m[w])];for(let k=0,L=T.length;k<L;++k){const O=T[k];let B=0,R=O.length;if(_==null){const P=UW(a.maxAngle,O,0,O.length,2);B=P[0],R=P[1]}for(let P=B;P<R;P+=g)o.push(O[P],O[P+1]);const A=o.length;x=m[w],this.drawChars_(l,A),l=A}}this.endGeometry(t)}else{let m=a.overflow?null:[];switch(c){case"Point":case"MultiPoint":h=e.getFlatCoordinates();break;case"LineString":h=e.getFlatMidpoint();break;case"Circle":h=e.getCenter();break;case"MultiLineString":h=e.getFlatMidpoints(),g=2;break;case"Polygon":h=e.getFlatInteriorPoint(),a.overflow||m.push(h[2]/this.resolution),g=3;break;case"MultiPolygon":const L=e.getFlatInteriorPoints();h=[];for(let O=0,B=L.length;O<B;O+=3)a.overflow||m.push(L[O+2]/this.resolution),h.push(L[O],L[O+1]);if(h.length===0)return;g=2;break}const y=this.appendFlatPointCoordinates(h,g);if(y===l)return;if(m&&(y-l)/2!==h.length/g){let L=l/2;m=m.filter((O,B)=>{const R=o[(L+B)*2]===h[B*g]&&o[(L+B)*2+1]===h[B*g+1];return R||--L,R})}this.saveTextStates_();const _=a.backgroundFill?this.createFill(this.fillStyleToState(a.backgroundFill)):null,x=a.backgroundStroke?this.createStroke(this.strokeStyleToState(a.backgroundStroke)):null;this.beginGeometry(e,t,r);let w=a.padding;if(w!=zh&&(a.scale[0]<0||a.scale[1]<0)){let L=a.padding[0],O=a.padding[1],B=a.padding[2],R=a.padding[3];a.scale[0]<0&&(O=-O,R=-R),a.scale[1]<0&&(L=-L,B=-B),w=[L,O,B,R]}const b=this.pixelRatio;this.instructions.push([Vt.DRAW_IMAGE,l,y,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,w==zh?zh:w.map(function(L){return L*b}),_,x,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,m]);const T=1/b,k=_?_.slice(0):null;k&&(k[1]=Os),this.hitDetectionInstructions.push([Vt.DRAW_IMAGE,l,y,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[T,T],NaN,this.declutterMode_,this.declutterImageWithText_,w,k,x,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?Os:this.fillKey_,this.textOffsetX_,this.textOffsetY_,m]),this.endGeometry(t)}}saveTextStates_(){const e=this.textStrokeState_,t=this.textState_,r=this.textFillState_,i=this.strokeKey_;e&&(i in this.strokeStates||(this.strokeStates[i]={strokeStyle:e.strokeStyle,lineCap:e.lineCap,lineDashOffset:e.lineDashOffset,lineWidth:e.lineWidth,lineJoin:e.lineJoin,miterLimit:e.miterLimit,lineDash:e.lineDash}));const s=this.textKey_;s in this.textStates||(this.textStates[s]={font:t.font,textAlign:t.textAlign||Tp,justify:t.justify,textBaseline:t.textBaseline||G_,scale:t.scale});const a=this.fillKey_;r&&(a in this.fillStates||(this.fillStates[a]={fillStyle:r.fillStyle}))}drawChars_(e,t){const r=this.textStrokeState_,i=this.textState_,s=this.strokeKey_,a=this.textKey_,o=this.fillKey_;this.saveTextStates_();const l=this.pixelRatio,c=U_[i.textBaseline],h=this.textOffsetY_*l,g=this.text_,m=r?r.lineWidth*Math.abs(i.scale[0])/2:0;this.instructions.push([Vt.DRAW_CHARS,e,t,c,i.overflow,o,i.maxAngle,l,h,s,m*l,g,a,1,this.declutterMode_,this.textKeepUpright_]),this.hitDetectionInstructions.push([Vt.DRAW_CHARS,e,t,c,i.overflow,o&&Os,i.maxAngle,l,h,s,m*l,g,a,1/l,this.declutterMode_,this.textKeepUpright_])}setTextStyle(e,t){let r,i,s;if(!e)this.text_="";else{const a=e.getFill();a?(i=this.textFillState_,i||(i={},this.textFillState_=i),i.fillStyle=Qo(a.getColor()||Os)):(i=null,this.textFillState_=i);const o=e.getStroke();if(!o)s=null,this.textStrokeState_=s;else{s=this.textStrokeState_,s||(s={},this.textStrokeState_=s);const x=o.getLineDash(),w=o.getLineDashOffset(),b=o.getWidth(),T=o.getMiterLimit();s.lineCap=o.getLineCap()||M0,s.lineDash=x?x.slice():Zl,s.lineDashOffset=w===void 0?Jl:w,s.lineJoin=o.getLineJoin()||L0,s.lineWidth=b===void 0?Rp:b,s.miterLimit=T===void 0?Sp:T,s.strokeStyle=Qo(o.getColor()||bp)}r=this.textState_;const l=e.getFont()||nj;cW(l);const c=e.getScaleArray();r.overflow=e.getOverflow(),r.font=l,r.maxAngle=e.getMaxAngle(),r.placement=e.getPlacement(),r.textAlign=e.getTextAlign(),r.repeat=e.getRepeat(),r.justify=e.getJustify(),r.textBaseline=e.getTextBaseline()||G_,r.backgroundFill=e.getBackgroundFill(),r.backgroundStroke=e.getBackgroundStroke(),r.padding=e.getPadding()||zh,r.scale=c===void 0?[1,1]:c;const h=e.getOffsetX(),g=e.getOffsetY(),m=e.getRotateWithView(),y=e.getKeepUpright(),_=e.getRotation();this.text_=e.getText()||"",this.textOffsetX_=h===void 0?0:h,this.textOffsetY_=g===void 0?0:g,this.textRotateWithView_=m===void 0?!1:m,this.textKeepUpright_=y===void 0?!0:y,this.textRotation_=_===void 0?0:_,this.strokeKey_=s?(typeof s.strokeStyle=="string"?s.strokeStyle:Kt(s.strokeStyle))+s.lineCap+s.lineDashOffset+"|"+s.lineWidth+s.lineJoin+s.miterLimit+"["+s.lineDash.join()+"]":"",this.textKey_=r.font+r.scale+(r.textAlign||"?")+(r.repeat||"?")+(r.justify||"?")+(r.textBaseline||"?"),this.fillKey_=i&&i.fillStyle?typeof i.fillStyle=="string"?i.fillStyle:"|"+Kt(i.fillStyle):""}this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}const WW={Circle:TN,Default:E1,Image:BW,LineString:GW,Polygon:TN,Text:$W};class HW{constructor(e,t,r,i){this.tolerance_=e,this.maxExtent_=t,this.pixelRatio_=i,this.resolution_=r,this.buildersByZIndex_={}}finish(){const e={};for(const t in this.buildersByZIndex_){e[t]=e[t]||{};const r=this.buildersByZIndex_[t];for(const i in r){const s=r[i].finish();e[t][i]=s}}return e}getBuilder(e,t){const r=e!==void 0?e.toString():"0";let i=this.buildersByZIndex_[r];i===void 0&&(i={},this.buildersByZIndex_[r]=i);let s=i[t];if(s===void 0){const a=WW[t];s=new a(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),i[t]=s}return s}}function KW(n,e,t,r,i,s,a,o,l,c,h,g,m=!0){let y=n[e],_=n[e+1],x=0,w=0,b=0,T=0;function k(){x=y,w=_,e+=r,y=n[e],_=n[e+1],T+=b,b=Math.sqrt((y-x)*(y-x)+(_-w)*(_-w))}do k();while(e<t-r&&T+b<s);let L=b===0?0:(s-T)/b;const O=aa(x,y,L),B=aa(w,_,L),R=e-r,A=T,P=s+o*l(c,i,h);for(;e<t-r&&T+b<P;)k();L=b===0?0:(P-T)/b;const D=aa(x,y,L),N=aa(w,_,L);let G=!1;if(m)if(g){const Pe=[O,B,D,N];FD(Pe,0,4,2,g,Pe,Pe),G=Pe[0]>Pe[2]}else G=O>D;const j=Math.PI,ve=[],ce=R+r===e;e=R,b=0,T=A,y=n[e],_=n[e+1];let je;if(ce){k(),je=Math.atan2(_-w,y-x),G&&(je+=je>0?-j:j);const Pe=(D+O)/2,ue=(N+B)/2;return ve[0]=[Pe,ue,(P-s)/2,je,i],ve}i=i.replace(/\n/g," ");for(let Pe=0,ue=i.length;Pe<ue;){k();let Ne=Math.atan2(_-w,y-x);if(G&&(Ne+=Ne>0?-j:j),je!==void 0){let re=Ne-je;if(re+=re>j?-2*j:re<-j?2*j:0,Math.abs(re)>a)return null}je=Ne;const be=Pe;let ie=0;for(;Pe<ue;++Pe){const re=G?ue-Pe-1:Pe,he=o*l(c,i[re],h);if(e+r<t&&T+b<s+ie+he/2)break;ie+=he}if(Pe===be)continue;const V=G?i.substring(ue-be,ue-Pe):i.substring(be,Pe);L=b===0?0:(s+ie/2-T)/b;const J=aa(x,y,L),te=aa(w,_,L);ve.push([J,te,ie/2,Ne,V]),s+=ie}return ve}class yj{constructor(){this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(V_(),{get:(e,t)=>{if(typeof V_()[t]=="function")return this.push_(t),this.pushMethodArgs_},set:(e,t,r)=>(this.push_(t,r),!0)})}push_(...e){const t=this.instructions_,r=this.zIndex+this.offset_;t[r]||(t[r]=[]),t[r].push(...e)}pushMethodArgs_=(...e)=>(this.push_(e),this);pushFunction(e){this.push_(e)}getContext(){return this.context_}draw(e){this.instructions_.forEach(t=>{for(let r=0,i=t.length;r<i;++r){const s=t[r];if(typeof s=="function"){s(e);continue}const a=t[++r];if(typeof e[s]=="function")e[s](...a);else{if(typeof a=="function"){e[s]=a(e);continue}e[s]=a}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}}const Tf=zs(),Wc=[],Ol=[],Dl=[],Hc=[];function RN(n){return n[3].declutterBox}const AN=new RegExp("[-----]");function IS(n,e){return e==="start"?e=AN.test(n)?"right":"left":e==="end"&&(e=AN.test(n)?"left":"right"),U_[e]}function XW(n,e,t){return t>0&&n.push(`
`,""),n.push(e,""),n}function qW(n,e,t){return t%2===0&&(n+=e),n}class YW{constructor(e,t,r,i,s){this.overlaps=r,this.pixelRatio=t,this.resolution=e,this.alignAndScaleFill_,this.instructions=i.instructions,this.coordinates=i.coordinates,this.coordinateCache_={},this.renderedTransform_=gi(),this.hitDetectionInstructions=i.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=i.fillStates||{},this.strokeStates=i.strokeStates||{},this.textStates=i.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=s?new yj:null}getZIndexContext(){return this.zIndexContext_}createLabel(e,t,r,i){const s=e+t+r+i;if(this.labels_[s])return this.labels_[s];const a=i?this.strokeStates[i]:null,o=r?this.fillStates[r]:null,l=this.textStates[t],c=this.pixelRatio,h=[l.scale[0]*c,l.scale[1]*c],g=l.justify?U_[l.justify]:IS(Array.isArray(e)?e[0]:e,l.textAlign||Tp),m=i&&a.lineWidth?a.lineWidth:0,y=Array.isArray(e)?e:String(e).split(`
`).reduce(XW,[]),{width:_,height:x,widths:w,heights:b,lineWidths:T}=hW(l,y),k=_+m,L=[],O=(k+2)*h[0],B=(x+m)*h[1],R={width:O<0?Math.floor(O):Math.ceil(O),height:B<0?Math.floor(B):Math.ceil(B),contextInstructions:L};(h[0]!=1||h[1]!=1)&&L.push("scale",h),i&&(L.push("strokeStyle",a.strokeStyle),L.push("lineWidth",m),L.push("lineCap",a.lineCap),L.push("lineJoin",a.lineJoin),L.push("miterLimit",a.miterLimit),L.push("setLineDash",[a.lineDash]),L.push("lineDashOffset",a.lineDashOffset)),r&&L.push("fillStyle",o.fillStyle),L.push("textBaseline","middle"),L.push("textAlign","center");const A=.5-g;let P=g*k+A*m;const D=[],N=[];let G=0,j=0,ve=0,ce=0,je;for(let Pe=0,ue=y.length;Pe<ue;Pe+=2){const Ne=y[Pe];if(Ne===`
`){j+=G,G=0,P=g*k+A*m,++ce;continue}const be=y[Pe+1]||l.font;be!==je&&(i&&D.push("font",be),r&&N.push("font",be),je=be),G=Math.max(G,b[ve]);const ie=[Ne,P+A*w[ve]+g*(w[ve]-T[ce]),.5*(m+G)+j];P+=w[ve],i&&D.push("strokeText",ie),r&&N.push("fillText",ie),++ve}return Array.prototype.push.apply(L,D),Array.prototype.push.apply(L,N),this.labels_[s]=R,R}replayTextBackground_(e,t,r,i,s,a,o){e.beginPath(),e.moveTo.apply(e,t),e.lineTo.apply(e,r),e.lineTo.apply(e,i),e.lineTo.apply(e,s),e.lineTo.apply(e,t),a&&(this.alignAndScaleFill_=a[2],e.fillStyle=a[1],this.fill_(e)),o&&(this.setStrokeStyle_(e,o),e.stroke())}calculateImageOrLabelDimensions_(e,t,r,i,s,a,o,l,c,h,g,m,y,_,x,w){o*=m[0],l*=m[1];let b=r-o,T=i-l;const k=s+c>e?e-c:s,L=a+h>t?t-h:a,O=_[3]+k*m[0]+_[1],B=_[0]+L*m[1]+_[2],R=b-_[3],A=T-_[0];(x||g!==0)&&(Wc[0]=R,Hc[0]=R,Wc[1]=A,Ol[1]=A,Ol[0]=R+O,Dl[0]=Ol[0],Dl[1]=A+B,Hc[1]=Dl[1]);let P;return g!==0?(P=Ga(gi(),r,i,1,1,g,-r,-i),Fr(P,Wc),Fr(P,Ol),Fr(P,Dl),Fr(P,Hc),Nu(Math.min(Wc[0],Ol[0],Dl[0],Hc[0]),Math.min(Wc[1],Ol[1],Dl[1],Hc[1]),Math.max(Wc[0],Ol[0],Dl[0],Hc[0]),Math.max(Wc[1],Ol[1],Dl[1],Hc[1]),Tf)):Nu(Math.min(R,R+O),Math.min(A,A+B),Math.max(R,R+O),Math.max(A,A+B),Tf),y&&(b=Math.round(b),T=Math.round(T)),{drawImageX:b,drawImageY:T,drawImageW:k,drawImageH:L,originX:c,originY:h,declutterBox:{minX:Tf[0],minY:Tf[1],maxX:Tf[2],maxY:Tf[3],value:w},canvasTransform:P,scale:m}}replayImageOrLabel_(e,t,r,i,s,a,o){const l=!!(a||o),c=i.declutterBox,h=o?o[2]*i.scale[0]/2:0;return c.minX-h<=t[0]&&c.maxX+h>=0&&c.minY-h<=t[1]&&c.maxY+h>=0&&(l&&this.replayTextBackground_(e,Wc,Ol,Dl,Hc,a,o),dW(e,i.canvasTransform,s,r,i.originX,i.originY,i.drawImageW,i.drawImageH,i.drawImageX,i.drawImageY,i.scale)),!0}fill_(e){const t=this.alignAndScaleFill_;if(t){const r=Fr(this.renderedTransform_,[0,0]),i=512*this.pixelRatio;e.save(),e.translate(r[0]%i,r[1]%i),t!==1&&e.scale(t,t),e.rotate(this.viewRotation_)}e.fill(),t&&e.restore()}setStrokeStyle_(e,t){e.strokeStyle=t[1],t[1]&&(e.lineWidth=t[2],e.lineCap=t[3],e.lineJoin=t[4],e.miterLimit=t[5],e.lineDashOffset=t[7],e.setLineDash(t[6]))}drawLabelWithPointPlacement_(e,t,r,i){const s=this.textStates[t],a=this.createLabel(e,t,i,r),o=this.strokeStates[r],l=this.pixelRatio,c=IS(Array.isArray(e)?e[0]:e,s.textAlign||Tp),h=U_[s.textBaseline||G_],g=o&&o.lineWidth?o.lineWidth:0,m=a.width/l-2*s.scale[0],y=c*m+2*(.5-c)*g,_=h*a.height/l+2*(.5-h)*g;return{label:a,anchorX:y,anchorY:_}}execute_(e,t,r,i,s,a,o,l){const c=this.zIndexContext_;let h;this.pixelCoordinates_&&gc(r,this.renderedTransform_)?h=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),h=nl(this.coordinates,0,this.coordinates.length,2,r,this.pixelCoordinates_),jD(this.renderedTransform_,r));let g=0;const m=i.length;let y=0,_,x,w,b,T,k,L,O,B,R,A,P,D,N=0,G=0;const j=this.coordinateCache_,ve=this.viewRotation_,ce=Math.round(Math.atan2(-r[1],r[0])*1e12)/1e12,je={context:e,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:ve},Pe=this.instructions!=i||this.overlaps?0:200;let ue,Ne,be,ie;for(;g<m;){const V=i[g];switch(V[0]){case Vt.BEGIN_GEOMETRY:ue=V[1],ie=V[3],ue.getGeometry()?o!==void 0&&!vs(o,ie.getExtent())?g=V[2]+1:++g:g=V[2],c&&(c.zIndex=V[4]);break;case Vt.BEGIN_PATH:N>Pe&&(this.fill_(e),N=0),G>Pe&&(e.stroke(),G=0),!N&&!G&&(e.beginPath(),T=NaN,k=NaN),++g;break;case Vt.CIRCLE:y=V[1];const te=h[y],re=h[y+1],he=h[y+2],Be=h[y+3],Ge=he-te,ye=Be-re,pe=Math.sqrt(Ge*Ge+ye*ye);e.moveTo(te+pe,re),e.arc(te,re,pe,0,2*Math.PI,!0),++g;break;case Vt.CLOSE_PATH:e.closePath(),++g;break;case Vt.CUSTOM:y=V[1],_=V[2];const Et=V[3],Ve=V[4],jt=V[5];je.geometry=Et,je.feature=ue,g in j||(j[g]=[]);const St=j[g];jt?jt(h,y,_,2,St):(St[0]=h[y],St[1]=h[y+1],St.length=2),c&&(c.zIndex=V[6]),Ve(St,je),++g;break;case Vt.DRAW_IMAGE:y=V[1],_=V[2],B=V[3],x=V[4],w=V[5];let Ut=V[6];const Ht=V[7],tt=V[8],kn=V[9],ln=V[10];let hn=V[11];const sr=V[12];let Pi=V[13];b=V[14]||"declutter";const Gn=V[15];if(!B&&V.length>=20){R=V[19],A=V[20],P=V[21],D=V[22];const Ce=this.drawLabelWithPointPlacement_(R,A,P,D);B=Ce.label,V[3]=B;const q=V[23];x=(Ce.anchorX-q)*this.pixelRatio,V[4]=x;const le=V[24];w=(Ce.anchorY-le)*this.pixelRatio,V[5]=w,Ut=B.height,V[6]=Ut,Pi=B.width,V[13]=Pi}let br;V.length>25&&(br=V[25]);let oi,_t,xn;V.length>17?(oi=V[16],_t=V[17],xn=V[18]):(oi=zh,_t=null,xn=null),ln&&ce?hn+=ve:!ln&&!ce&&(hn-=ve);let In=0;for(;y<_;y+=2){if(br&&br[In++]<Pi/this.pixelRatio)continue;const Ce=this.calculateImageOrLabelDimensions_(B.width,B.height,h[y],h[y+1],Pi,Ut,x,w,tt,kn,hn,sr,s,oi,!!_t||!!xn,ue),q=[e,t,B,Ce,Ht,_t,xn];if(l){let le,Ae,ze;if(Gn){const $e=_-y;if(!Gn[$e]){Gn[$e]={args:q,declutterMode:b};continue}const yt=Gn[$e];le=yt.args,Ae=yt.declutterMode,delete Gn[$e],ze=RN(le)}let Me,He;if(le&&(Ae!=="declutter"||!l.collides(ze))&&(Me=!0),(b!=="declutter"||!l.collides(Ce.declutterBox))&&(He=!0),Ae==="declutter"&&b==="declutter"){const $e=Me&&He;Me=$e,He=$e}Me&&(Ae!=="none"&&l.insert(ze),this.replayImageOrLabel_.apply(this,le)),He&&(b!=="none"&&l.insert(Ce.declutterBox),this.replayImageOrLabel_.apply(this,q))}else this.replayImageOrLabel_.apply(this,q)}++g;break;case Vt.DRAW_CHARS:const Tt=V[1],an=V[2],Lt=V[3],Yi=V[4];D=V[5];const Mr=V[6],li=V[7],rn=V[8];P=V[9];const Tr=V[10];R=V[11],Array.isArray(R)&&(R=R.reduce(qW,"")),A=V[12];const Fe=[V[13],V[13]];b=V[14]||"declutter";const xe=V[15],_e=this.textStates[A],Dt=_e.font,M=[_e.scale[0]*li,_e.scale[1]*li];let ut;Dt in this.widths_?ut=this.widths_[Dt]:(ut={},this.widths_[Dt]=ut);const W=lA(h,Tt,an,2),ne=Math.abs(M[0])*fN(Dt,R,ut);if(Yi||ne<=W){const Ce=this.textStates[A].textAlign,q=(W-ne)*IS(R,Ce),le=KW(h,Tt,an,2,R,q,Mr,Math.abs(M[0]),fN,Dt,ut,ce?0:this.viewRotation_,xe);e:if(le){const Ae=[];let ze,Me,He,$e,yt;if(P)for(ze=0,Me=le.length;ze<Me;++ze){yt=le[ze],He=yt[4],$e=this.createLabel(He,A,"",P),x=yt[2]+(M[0]<0?-Tr:Tr),w=Lt*$e.height+(.5-Lt)*2*Tr*M[1]/M[0]-rn;const At=this.calculateImageOrLabelDimensions_($e.width,$e.height,yt[0],yt[1],$e.width,$e.height,x,w,0,0,yt[3],Fe,!1,zh,!1,ue);if(l&&b==="declutter"&&l.collides(At.declutterBox))break e;Ae.push([e,t,$e,At,1,null,null])}if(D)for(ze=0,Me=le.length;ze<Me;++ze){yt=le[ze],He=yt[4],$e=this.createLabel(He,A,D,""),x=yt[2],w=Lt*$e.height-rn;const At=this.calculateImageOrLabelDimensions_($e.width,$e.height,yt[0],yt[1],$e.width,$e.height,x,w,0,0,yt[3],Fe,!1,zh,!1,ue);if(l&&b==="declutter"&&l.collides(At.declutterBox))break e;Ae.push([e,t,$e,At,1,null,null])}l&&b!=="none"&&l.load(Ae.map(RN));for(let At=0,Wt=Ae.length;At<Wt;++At)this.replayImageOrLabel_.apply(this,Ae[At])}}++g;break;case Vt.END_GEOMETRY:if(a!==void 0){ue=V[1];const Ce=a(ue,ie,b);if(Ce)return Ce}++g;break;case Vt.FILL:Pe?N++:this.fill_(e),++g;break;case Vt.MOVE_TO_LINE_TO:for(y=V[1],_=V[2],Ne=h[y],be=h[y+1],e.moveTo(Ne,be),T=Ne+.5|0,k=be+.5|0,y+=2;y<_;y+=2)Ne=h[y],be=h[y+1],L=Ne+.5|0,O=be+.5|0,(y==_-2||L!==T||O!==k)&&(e.lineTo(Ne,be),T=L,k=O);++g;break;case Vt.SET_FILL_STYLE:this.alignAndScaleFill_=V[2],N&&(this.fill_(e),N=0,G&&(e.stroke(),G=0)),e.fillStyle=V[1],++g;break;case Vt.SET_STROKE_STYLE:G&&(e.stroke(),G=0),this.setStrokeStyle_(e,V),++g;break;case Vt.STROKE:Pe?G++:e.stroke(),++g;break;default:++g;break}}N&&this.fill_(e),G&&e.stroke()}execute(e,t,r,i,s,a){this.viewRotation_=i,this.execute_(e,t,r,this.instructions,s,void 0,void 0,a)}executeHitDetection(e,t,r,i,s){return this.viewRotation_=r,this.execute_(e,[e.canvas.width,e.canvas.height],t,this.hitDetectionInstructions,!0,i,s)}}const Mh=["Polygon","Circle","LineString","Image","Text","Default"],xj=["Image","Text"],ZW=Mh.filter(n=>!xj.includes(n));class JW{constructor(e,t,r,i,s,a,o){this.maxExtent_=e,this.overlaps_=i,this.pixelRatio_=r,this.resolution_=t,this.renderBuffer_=a,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=gi(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(s,o)}clip(e,t){const r=this.getClipCoords(t);e.beginPath(),e.moveTo(r[0],r[1]),e.lineTo(r[2],r[3]),e.lineTo(r[4],r[5]),e.lineTo(r[6],r[7]),e.clip()}createExecutors_(e,t){for(const r in e){let i=this.executorsByZIndex_[r];i===void 0&&(i={},this.executorsByZIndex_[r]=i);const s=e[r];for(const a in s){const o=s[a];i[a]=new YW(this.resolution_,this.pixelRatio_,this.overlaps_,o,t)}}}hasExecutors(e){for(const t in this.executorsByZIndex_){const r=this.executorsByZIndex_[t];for(let i=0,s=e.length;i<s;++i)if(e[i]in r)return!0}return!1}forEachFeatureAtCoordinate(e,t,r,i,s,a){i=Math.round(i);const o=i*2+1,l=Ga(this.hitDetectionTransform_,i+.5,i+.5,1/t,-1/t,-r,-e[0],-e[1]),c=!this.hitDetectionContext_;c&&(this.hitDetectionContext_=ri(o,o));const h=this.hitDetectionContext_;h.canvas.width!==o||h.canvas.height!==o?(h.canvas.width=o,h.canvas.height=o):c||h.clearRect(0,0,o,o);let g;this.renderBuffer_!==void 0&&(g=zs(),Fm(g,e),Xl(g,t*(this.renderBuffer_+i),g));const m=QW(i);let y;function _(O,B,R){const A=h.getImageData(0,0,o,o).data;for(let P=0,D=m.length;P<D;P++)if(A[m[P]]>0){if(!a||R==="none"||y!=="Image"&&y!=="Text"||a.includes(O)){const N=(m[P]-3)/4,G=i-N%o,j=i-(N/o|0),ve=s(O,B,G*G+j*j);if(ve)return ve}h.clearRect(0,0,o,o);break}}const x=Object.keys(this.executorsByZIndex_).map(Number);x.sort(Kl);let w,b,T,k,L;for(w=x.length-1;w>=0;--w){const O=x[w].toString();for(T=this.executorsByZIndex_[O],b=Mh.length-1;b>=0;--b)if(y=Mh[b],k=T[y],k!==void 0&&(L=k.executeHitDetection(h,l,r,_,g),L))return L}}getClipCoords(e){const t=this.maxExtent_;if(!t)return null;const r=t[0],i=t[1],s=t[2],a=t[3],o=[r,i,r,a,s,a,s,i];return nl(o,0,8,2,e,o),o}isEmpty(){return id(this.executorsByZIndex_)}execute(e,t,r,i,s,a,o){const l=Object.keys(this.executorsByZIndex_).map(Number);l.sort(o?NU:Kl),a=a||Mh;const c=Mh.length;for(let h=0,g=l.length;h<g;++h){const m=l[h].toString(),y=this.executorsByZIndex_[m];for(let _=0,x=a.length;_<x;++_){const w=a[_],b=y[w];if(b!==void 0){const T=o===null?void 0:b.getZIndexContext(),k=T?T.getContext():e,L=this.maxExtent_&&w!=="Image"&&w!=="Text";if(L&&(k.save(),this.clip(k,r)),!T||w==="Text"||w==="Image"?b.execute(k,t,r,i,s,o):T.pushFunction(O=>b.execute(O,t,r,i,s,o)),L&&k.restore(),T){T.offset();const O=l[h]*c+Mh.indexOf(w);this.deferredZIndexContexts_[O]||(this.deferredZIndexContexts_[O]=[]),this.deferredZIndexContexts_[O].push(T)}}}}this.renderedContext_=e}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const e=this.deferredZIndexContexts_,t=Object.keys(e).map(Number).sort(Kl);for(let r=0,i=t.length;r<i;++r)e[t[r]].forEach(s=>{s.draw(this.renderedContext_),s.clear()}),e[t[r]].length=0}}const CS={};function QW(n){if(CS[n]!==void 0)return CS[n];const e=n*2+1,t=n*n,r=new Array(t+1);for(let s=0;s<=n;++s)for(let a=0;a<=n;++a){const o=s*s+a*a;if(o>t)break;let l=r[o];l||(l=[],r[o]=l),l.push(((n+s)*e+(n+a))*4+3),s>0&&l.push(((n-s)*e+(n+a))*4+3),a>0&&(l.push(((n+s)*e+(n-a))*4+3),s>0&&l.push(((n-s)*e+(n-a))*4+3))}const i=[];for(let s=0,a=r.length;s<a;++s)r[s]&&i.push(...r[s]);return CS[n]=i,i}function kN(n,e,t,r){return t!==void 0&&r!==void 0?[t/n,r/e]:t!==void 0?t/n:r!==void 0?r/e:1}let S1=class _j extends Cw{constructor(e){e=e||{};const t=e.opacity!==void 0?e.opacity:1,r=e.rotation!==void 0?e.rotation:0,i=e.scale!==void 0?e.scale:1,s=e.rotateWithView!==void 0?e.rotateWithView:!1;super({opacity:t,rotation:r,scale:i,displacement:e.displacement!==void 0?e.displacement:[0,0],rotateWithView:s,declutterMode:e.declutterMode}),this.anchor_=e.anchor!==void 0?e.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=e.anchorOrigin!==void 0?e.anchorOrigin:"top-left",this.anchorXUnits_=e.anchorXUnits!==void 0?e.anchorXUnits:"fraction",this.anchorYUnits_=e.anchorYUnits!==void 0?e.anchorYUnits:"fraction",this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null;const a=e.img!==void 0?e.img:null;let o=e.src;Rn(!(o!==void 0&&a),"`image` and `src` cannot be provided at the same time"),(o===void 0||o.length===0)&&a&&(o=a.src||Kt(a)),Rn(o!==void 0&&o.length>0,"A defined and non-empty `src` or `image` must be provided"),Rn(!((e.width!==void 0||e.height!==void 0)&&e.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let l;if(e.src!==void 0?l=Rt.IDLE:a!==void 0&&("complete"in a?a.complete?l=a.src?Rt.LOADED:Rt.IDLE:l=Rt.LOADING:l=Rt.LOADED),this.color_=e.color!==void 0?za(e.color):null,this.iconImage_=B_(a,o,this.crossOrigin_,l,this.color_),this.offset_=e.offset!==void 0?e.offset:[0,0],this.offsetOrigin_=e.offsetOrigin!==void 0?e.offsetOrigin:"top-left",this.origin_=null,this.size_=e.size!==void 0?e.size:null,this.initialOptions_,e.width!==void 0||e.height!==void 0){let c,h;if(e.size)[c,h]=e.size;else{const g=this.getImage(1);if(g.width&&g.height)c=g.width,h=g.height;else if(g instanceof HTMLImageElement){this.initialOptions_=e;const m=()=>{if(this.unlistenImageChange(m),!this.initialOptions_)return;const y=this.iconImage_.getSize();this.setScale(kN(y[0],y[1],e.width,e.height))};this.listenImageChange(m);return}}c!==void 0&&this.setScale(kN(c,h,e.width,e.height))}}clone(){let e,t,r;return this.initialOptions_?(t=this.initialOptions_.width,r=this.initialOptions_.height):(e=this.getScale(),e=Array.isArray(e)?e.slice():e),new _j({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:e,width:t,height:r,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let e=this.normalizedAnchor_;if(!e){e=this.anchor_;const i=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!i)return null;e=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(e[0]*=i[0]),this.anchorYUnits_=="fraction"&&(e[1]*=i[1])}if(this.anchorOrigin_!="top-left"){if(!i)return null;e===this.anchor_&&(e=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(e[0]=-e[0]+i[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(e[1]=-e[1]+i[1])}this.normalizedAnchor_=e}const t=this.getDisplacement(),r=this.getScaleArray();return[e[0]-t[0]/r[0],e[1]+t[1]/r[1]]}setAnchor(e){this.anchor_=e,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(e){return this.iconImage_.getImage(e)}getPixelRatio(e){return this.iconImage_.getPixelRatio(e)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let e=this.offset_;if(this.offsetOrigin_!="top-left"){const t=this.getSize(),r=this.iconImage_.getSize();if(!t||!r)return null;e=e.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(e[0]=r[0]-t[0]-e[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(e[1]=r[1]-t[1]-e[1])}return this.origin_=e,this.origin_}getSrc(){return this.iconImage_.getSrc()}setSrc(e){this.iconImage_=B_(null,e,this.crossOrigin_,Rt.IDLE,this.color_)}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const e=this.getScaleArray();if(this.size_)return this.size_[0]*e[0];if(this.iconImage_.getImageState()==Rt.LOADED)return this.iconImage_.getSize()[0]*e[0]}getHeight(){const e=this.getScaleArray();if(this.size_)return this.size_[1]*e[1];if(this.iconImage_.getImageState()==Rt.LOADED)return this.iconImage_.getSize()[1]*e[1]}setScale(e){delete this.initialOptions_,super.setScale(e)}listenImageChange(e){this.iconImage_.addEventListener(en.CHANGE,e)}load(){this.iconImage_.load()}unlistenImageChange(e){this.iconImage_.removeEventListener(en.CHANGE,e)}ready(){return this.iconImage_.ready()}};const Yo=.5;function eH(n,e,t,r,i,s,a,o,l){const c=i,h=n[0]*Yo,g=n[1]*Yo,m=ri(h,g);m.imageSmoothingEnabled=!1;const y=m.canvas,_=new gW(m,Yo,i,null,a,o,null),x=t.length,w=Math.floor((256*256*256-1)/x),b={};for(let k=1;k<=x;++k){const L=t[k-1],O=L.getStyleFunction()||r;if(!O)continue;let B=O(L,s);if(!B)continue;Array.isArray(B)||(B=[B]);const A=(k*w).toString(16).padStart(7,"#00000");for(let P=0,D=B.length;P<D;++P){const N=B[P],G=N.getGeometryFunction()(L);if(!G||!vs(c,G.getExtent()))continue;const j=N.clone(),ve=j.getFill();ve&&ve.setColor(A);const ce=j.getStroke();ce&&(ce.setColor(A),ce.setLineDash(null)),j.setText(void 0);const je=N.getImage();if(je){const be=je.getImageSize();if(!be)continue;const ie=ri(be[0],be[1],void 0,{alpha:!1}),V=ie.canvas;ie.fillStyle=A,ie.fillRect(0,0,V.width,V.height),j.setImage(new S1({img:V,anchor:je.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:je.getOrigin(),opacity:1,size:je.getSize(),scale:je.getScale(),rotation:je.getRotation(),rotateWithView:je.getRotateWithView()}))}const Pe=j.getZIndex()||0;let ue=b[Pe];ue||(ue={},b[Pe]=ue,ue.Polygon=[],ue.Circle=[],ue.LineString=[],ue.Point=[]);const Ne=G.getType();if(Ne==="GeometryCollection"){const be=G.getGeometriesArrayRecursive();for(let ie=0,V=be.length;ie<V;++ie){const J=be[ie];ue[J.getType().replace("Multi","")].push(J,j)}}else ue[Ne.replace("Multi","")].push(G,j)}}const T=Object.keys(b).map(Number).sort(Kl);for(let k=0,L=T.length;k<L;++k){const O=b[T[k]];for(const B in O){const R=O[B];for(let A=0,P=R.length;A<P;A+=2){_.setStyle(R[A+1]);for(let D=0,N=e.length;D<N;++D)_.setTransform(e[D]),_.drawGeometry(R[A])}}}return m.getImageData(0,0,y.width,y.height)}function tH(n,e,t){const r=[];if(t){const i=Math.floor(Math.round(n[0])*Yo),s=Math.floor(Math.round(n[1])*Yo),a=(hr(i,0,t.width-1)+hr(s,0,t.height-1)*t.width)*4,o=t.data[a],l=t.data[a+1],h=t.data[a+2]+256*(l+256*o),g=Math.floor((256*256*256-1)/e.length);h&&h%g===0&&r.push(e[h/g-1])}return r}class Bm extends pl{constructor(e,t,r,i){super(e),this.inversePixelTransform=t,this.frameState=r,this.context=i}}const nH=5;class vj extends p1{constructor(e){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=e,this.staleKeys_=new Array,this.maxStaleKeys=nH}getStaleKeys(){return this.staleKeys_}prependStaleKey(e){this.staleKeys_.unshift(e),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(e){return Xt()}getData(e){return null}prepareFrame(e){return Xt()}renderFrame(e,t){return Xt()}forEachFeatureAtCoordinate(e,t,r,i,s){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(e){const t=e.target;(t.getState()===Rt.LOADED||t.getState()===Rt.ERROR)&&this.renderIfReadyAndVisible()}loadImage(e){let t=e.getState();return t!=Rt.LOADED&&t!=Rt.ERROR&&e.addEventListener(en.CHANGE,this.boundHandleImageChange_),t==Rt.IDLE&&(e.load(),t=e.getState()),t==Rt.LOADED}renderIfReadyAndVisible(){const e=this.getLayer();e&&e.getVisible()&&e.getSourceState()==="ready"&&e.changed()}renderDeferred(e){}disposeInternal(){delete this.layer_,super.disposeInternal()}}const IN=[];let $f=null;function rH(){$f=ri(1,1,void 0,{willReadFrequently:!0})}class _A extends vj{constructor(e){super(e),this.container=null,this.renderedResolution,this.tempTransform=gi(),this.pixelTransform=gi(),this.inversePixelTransform=gi(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(e,t,r){$f||rH(),$f.clearRect(0,0,1,1);let i;try{$f.drawImage(e,t,r,1,1,0,0,1,1),i=$f.getImageData(0,0,1,1).data}catch{return $f=null,null}return i}getBackground(e){let r=this.getLayer().getBackground();return typeof r=="function"&&(r=r(e.viewState.resolution)),r||void 0}useContainer(e,t,r){const i=this.getLayer().getClassName();let s,a;if(e&&e.className===i&&(!r||e&&e.style.backgroundColor&&gc(za(e.style.backgroundColor),za(r)))){const o=e.firstElementChild;fu(o)&&(a=o.getContext("2d"))}if(a&&R$(a.canvas.style.transform,t)?(this.container=e,this.context=a,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){s=ua?qD():document.createElement("div"),s.className=i;let o=s.style;o.position="absolute",o.width="100%",o.height="100%",a=ri();const l=a.canvas;s.appendChild(l),o=l.style,o.position="absolute",o.left="0",o.transformOrigin="top left",this.container=s,this.context=a}!this.containerReused&&r&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=r)}clipUnrotated(e,t,r){const i=Id(r),s=Ew(r),a=ww(r),o=vw(r);Fr(t.coordinateToPixelTransform,i),Fr(t.coordinateToPixelTransform,s),Fr(t.coordinateToPixelTransform,a),Fr(t.coordinateToPixelTransform,o);const l=this.inversePixelTransform;Fr(l,i),Fr(l,s),Fr(l,a),Fr(l,o),e.save(),e.beginPath(),e.moveTo(Math.round(i[0]),Math.round(i[1])),e.lineTo(Math.round(s[0]),Math.round(s[1])),e.lineTo(Math.round(a[0]),Math.round(a[1])),e.lineTo(Math.round(o[0]),Math.round(o[1])),e.clip()}prepareContainer(e,t){const r=e.extent,i=e.viewState.resolution,s=e.viewState.rotation,a=e.pixelRatio,o=Math.round(yn(r)/i*a),l=Math.round(ti(r)/i*a);Ga(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/a,1/a,s,-o/2,-l/2),wp(this.inversePixelTransform,this.pixelTransform);const c=T$(this.pixelTransform);if(this.useContainer(t,c,this.getBackground(e)),!this.containerReused){const h=this.context.canvas;h.width!=o||h.height!=l?(h.width=o,h.height=l):this.context.clearRect(0,0,o,l),c!==h.style.transform&&(h.style.transform=c)}}dispatchRenderEvent_(e,t,r){const i=this.getLayer();if(i.hasListener(e)){const s=new Bm(e,this.inversePixelTransform,r,t);i.dispatchEvent(s)}}preRender(e,t){this.frameState=t,!t.declutter&&this.dispatchRenderEvent_(Si.PRERENDER,e,t)}postRender(e,t){t.declutter||this.dispatchRenderEvent_(Si.POSTRENDER,e,t)}renderDeferredInternal(e){}getRenderContext(e){return e.declutter&&!this.deferredContext_&&(this.deferredContext_=new yj),e.declutter?this.deferredContext_.getContext():this.context}renderDeferred(e){e.declutter&&(this.dispatchRenderEvent_(Si.PRERENDER,this.context,e),e.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(e),this.dispatchRenderEvent_(Si.POSTRENDER,this.context,e))}getRenderTransform(e,t,r,i,s,a,o){const l=s/2,c=a/2,h=i/t,g=-h,m=-e[0]+o,y=-e[1];return Ga(this.tempTransform,l,c,h,g,-r,m,y)}disposeInternal(){delete this.frameState,super.disposeInternal()}}class iH extends _A{constructor(e){super(e),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipped_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=zs(),this.wrappedRenderedExtent_=zs(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(e,t,r){const i=t.extent,s=t.viewState,a=s.center,o=s.resolution,l=s.projection,c=s.rotation,h=l.getExtent(),g=this.getLayer().getSource(),m=this.getLayer().getDeclutter(),y=t.pixelRatio,_=t.viewHints,x=!(_[Qr.ANIMATING]||_[Qr.INTERACTING]),w=this.context,b=Math.round(yn(i)/o*y),T=Math.round(ti(i)/o*y),k=g.getWrapX()&&l.canWrapX(),L=k?yn(h):null,O=k?Math.ceil((i[2]-h[2])/L)+1:1;let B=k?Math.floor((i[0]-h[0])/L):0;do{let R=this.getRenderTransform(a,o,0,y,b,T,B*L);t.declutter&&(R=R.slice(0)),e.execute(w,[w.canvas.width,w.canvas.height],R,c,x,r===void 0?Mh:r?xj:ZW,r?m&&t.declutter[m]:void 0)}while(++B<O)}setDrawContext_(){this.opacity_!==1&&(this.targetContext_=this.context,this.context=ri(this.context.canvas.width,this.context.canvas.height,IN))}resetDrawContext_(){if(this.opacity_!==1&&this.targetContext_){const e=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=e,Iw(this.context),IN.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(e){!this.replayGroup_||!this.getLayer().getDeclutter()||this.renderWorlds(this.replayGroup_,e,!0)}renderDeferredInternal(e){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}renderFrame(e,t){const r=e.layerStatesArray[e.layerIndex];this.opacity_=r.opacity;const i=e.viewState;this.prepareContainer(e,t);const s=this.context,a=this.replayGroup_;let o=a&&!a.isEmpty();if(!o&&!(this.getLayer().hasListener(Si.PRERENDER)||this.getLayer().hasListener(Si.POSTRENDER)))return this.container;if(this.setDrawContext_(),this.preRender(s,e),i.projection,this.clipped_=!1,o&&r.extent&&this.clipping){const l=Jo(r.extent);o=vs(l,e.extent),this.clipped_=o&&!uu(l,e.extent),this.clipped_&&this.clipUnrotated(s,e,l)}return o&&this.renderWorlds(a,e,this.getLayer().getDeclutter()?!1:void 0),!e.declutter&&this.clipped_&&s.restore(),this.postRender(s,e),this.renderedRotation_!==i.rotation&&(this.renderedRotation_=i.rotation,this.hitDetectionImageData_=null),e.declutter||this.resetDrawContext_(),this.container}getFeatures(e){return new Promise(t=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const r=this.frameState.size.slice(),i=this.renderedCenter_,s=this.renderedResolution_,a=this.renderedRotation_,o=this.renderedProjection_,l=this.wrappedRenderedExtent_,c=this.getLayer(),h=[],g=r[0]*Yo,m=r[1]*Yo;h.push(this.getRenderTransform(i,s,a,Yo,g,m,0).slice());const y=c.getSource(),_=o.getExtent();if(y.getWrapX()&&o.canWrapX()&&!uu(_,l)){let x=l[0];const w=yn(_);let b=0,T;for(;x<_[0];)--b,T=w*b,h.push(this.getRenderTransform(i,s,a,Yo,g,m,T).slice()),x+=w;for(b=0,x=l[2];x>_[2];)++b,T=w*b,h.push(this.getRenderTransform(i,s,a,Yo,g,m,T).slice()),x-=w}this.hitDetectionImageData_=eH(r,h,this.renderedFeatures_,c.getStyleFunction(),l,s,a,gN(s,this.renderedPixelRatio_))}t(tH(e,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(e,t,r,i,s){if(!this.replayGroup_)return;const a=t.viewState.resolution,o=t.viewState.rotation,l=this.getLayer(),c={},h=function(m,y,_){const x=Kt(m),w=c[x];if(w){if(w!==!0&&_<w.distanceSq){if(_===0)return c[x]=!0,s.splice(s.lastIndexOf(w),1),i(m,l,y);w.geometry=y,w.distanceSq=_}}else{if(_===0)return c[x]=!0,i(m,l,y);s.push(c[x]={feature:m,layer:l,geometry:y,distanceSq:_,callback:i})}},g=this.getLayer().getDeclutter();return this.replayGroup_.forEachFeatureAtCoordinate(e,a,o,r,h,g?t.declutter?.[g]?.all().map(m=>m.value):null)}handleFontsChanged(){const e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}prepareFrame(e){const t=this.getLayer(),r=t.getSource();if(!r)return!1;const i=e.viewHints[Qr.ANIMATING],s=e.viewHints[Qr.INTERACTING],a=t.getUpdateWhileAnimating(),o=t.getUpdateWhileInteracting();if(this.ready&&!a&&i||!o&&s)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const l=e.extent,c=e.viewState,h=c.projection,g=c.resolution,m=e.pixelRatio,y=t.getRevision(),_=t.getRenderBuffer();let x=t.getRenderOrder();x===void 0&&(x=pW);const w=c.center.slice(),b=Xl(l,_*g),T=b.slice(),k=[b.slice()],L=h.getExtent();if(r.getWrapX()&&h.canWrapX()&&!uu(L,e.extent)){const ve=yn(L),ce=Math.max(yn(b)/2,ve);b[0]=L[0]-ce,b[2]=L[2]+ce,RD(w,h);const je=SD(k[0],h);je[0]<L[0]&&je[2]<L[2]?k.push([je[0]+ve,je[1],je[2]+ve,je[3]]):je[0]>L[0]&&je[2]>L[2]&&k.push([je[0]-ve,je[1],je[2]-ve,je[3]])}if(this.ready&&this.renderedResolution_==g&&this.renderedRevision_==y&&this.renderedRenderOrder_==x&&this.renderedFrameDeclutter_===!!e.declutter&&uu(this.wrappedRenderedExtent_,b))return gc(this.renderedExtent_,T)||(this.hitDetectionImageData_=null,this.renderedExtent_=T),this.renderedCenter_=w,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const O=new HW(aj(g,m),b,g,m);let B;for(let ve=0,ce=k.length;ve<ce;++ve)r.loadFeatures(k[ve],g,h);const R=gN(g,m);let A=!0;const P=(ve,ce)=>{let je;const Pe=ve.getStyleFunction()||t.getStyleFunction();if(Pe&&(je=Pe(ve,g)),je){const ue=this.renderFeature(ve,R,je,O,B,this.getLayer().getDeclutter(),ce);A=A&&!ue}},D=OD(b),N=r.getFeaturesInExtent(D);x&&N.sort(x);for(let ve=0,ce=N.length;ve<ce;++ve)P(N[ve],ve);this.renderedFeatures_=N,this.ready=A;const G=O.finish(),j=new JW(b,g,m,r.getOverlaps(),G,t.getRenderBuffer(),!!e.declutter);return this.renderedResolution_=g,this.renderedRevision_=y,this.renderedRenderOrder_=x,this.renderedFrameDeclutter_=!!e.declutter,this.renderedExtent_=T,this.wrappedRenderedExtent_=b,this.renderedCenter_=w,this.renderedProjection_=h,this.renderedPixelRatio_=m,this.replayGroup_=j,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(e,t,r,i,s,a,o){if(!r)return!1;let l=!1;if(Array.isArray(r))for(let c=0,h=r.length;c<h;++c)l=mN(i,e,r[c],t,this.boundHandleStyleImageChange_,s,a,o)||l;else l=mN(i,e,r,t,this.boundHandleStyleImageChange_,s,a,o);return l}}let Md=0;const ei=1<<Md++,It=1<<Md++,fi=1<<Md++,wr=1<<Md++,$s=1<<Md++,Oa=1<<Md++,vx=Math.pow(2,Md)-1,vA={[ei]:"boolean",[It]:"number",[fi]:"string",[wr]:"color",[$s]:"number[]",[Oa]:"size"},sH=Object.keys(vA).map(Number).sort(Kl);function aH(n){return n in vA}function t0(n){const e=[];for(const t of sH)bm(n,t)&&e.push(vA[t]);return e.length===0?"untyped":e.length<3?e.join(" or "):e.slice(0,-1).join(", ")+", or "+e[e.length-1]}function bm(n,e){return(n&e)===e}function Xo(n,e){return n===e}class di{constructor(e,t){if(!aH(e))throw new Error(`literal expressions must have a specific type, got ${t0(e)}`);this.type=e,this.value=t}}class wj{constructor(e,t,...r){this.type=e,this.operator=t,this.args=r}}function wA(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,mapState:!1}}function Ai(n,e,t){switch(typeof n){case"boolean":{if(Xo(e,fi))return new di(fi,n?"true":"false");if(!bm(e,ei))throw new Error(`got a boolean, but expected ${t0(e)}`);return new di(ei,n)}case"number":{if(Xo(e,Oa))return new di(Oa,Es(n));if(Xo(e,ei))return new di(ei,!!n);if(Xo(e,fi))return new di(fi,n.toString());if(!bm(e,It))throw new Error(`got a number, but expected ${t0(e)}`);return new di(It,n)}case"string":{if(Xo(e,wr))return new di(wr,dA(n));if(Xo(e,ei))return new di(ei,!!n);if(!bm(e,fi))throw new Error(`got a string, but expected ${t0(e)}`);return new di(fi,n)}}if(!Array.isArray(n))throw new Error("expression must be an array or a primitive value");if(n.length===0)throw new Error("empty expression");if(typeof n[0]=="string")return yH(n,e,t);for(const r of n)if(typeof r!="number")throw new Error("expected an array of numbers");if(Xo(e,Oa)){if(n.length!==2)throw new Error(`expected an array of two values for a size, got ${n.length}`);return new di(Oa,n)}if(Xo(e,wr)){if(n.length===3)return new di(wr,[...n,1]);if(n.length===4)return new di(wr,n);throw new Error(`expected an array of 3 or 4 values for a color, got ${n.length}`)}if(!bm(e,$s))throw new Error(`got an array of numbers, but expected ${t0(e)}`);return new di($s,n)}const me={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",LineMetric:"line-metric",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string",Has:"has"},oH={[me.Get]:Zt(on(1,1/0),CN),[me.Var]:Zt(on(1,1),lH),[me.Has]:Zt(on(1,1/0),CN),[me.Id]:Zt(cH,Rf),[me.Concat]:Zt(on(2,1/0),Dn(fi)),[me.GeometryType]:Zt(uH,Rf),[me.LineMetric]:Zt(Rf),[me.Resolution]:Zt(PS,Rf),[me.Zoom]:Zt(PS,Rf),[me.Time]:Zt(PS,Rf),[me.Any]:Zt(on(2,1/0),Dn(ei)),[me.All]:Zt(on(2,1/0),Dn(ei)),[me.Not]:Zt(on(1,1),Dn(ei)),[me.Equal]:Zt(on(2,2),Dn(vx)),[me.NotEqual]:Zt(on(2,2),Dn(vx)),[me.GreaterThan]:Zt(on(2,2),Dn(It)),[me.GreaterThanOrEqualTo]:Zt(on(2,2),Dn(It)),[me.LessThan]:Zt(on(2,2),Dn(It)),[me.LessThanOrEqualTo]:Zt(on(2,2),Dn(It)),[me.Multiply]:Zt(on(2,1/0),PN),[me.Coalesce]:Zt(on(2,1/0),PN),[me.Divide]:Zt(on(2,2),Dn(It)),[me.Add]:Zt(on(2,1/0),Dn(It)),[me.Subtract]:Zt(on(2,2),Dn(It)),[me.Clamp]:Zt(on(3,3),Dn(It)),[me.Mod]:Zt(on(2,2),Dn(It)),[me.Pow]:Zt(on(2,2),Dn(It)),[me.Abs]:Zt(on(1,1),Dn(It)),[me.Floor]:Zt(on(1,1),Dn(It)),[me.Ceil]:Zt(on(1,1),Dn(It)),[me.Round]:Zt(on(1,1),Dn(It)),[me.Sin]:Zt(on(1,1),Dn(It)),[me.Cos]:Zt(on(1,1),Dn(It)),[me.Atan]:Zt(on(1,2),Dn(It)),[me.Sqrt]:Zt(on(1,1),Dn(It)),[me.Match]:Zt(on(4,1/0),NN,dH),[me.Between]:Zt(on(3,3),Dn(It)),[me.Interpolate]:Zt(on(6,1/0),NN,fH),[me.Case]:Zt(on(3,1/0),hH,gH),[me.In]:Zt(on(2,2),mH),[me.Number]:Zt(on(1,1/0),Dn(vx)),[me.String]:Zt(on(1,1/0),Dn(vx)),[me.Array]:Zt(on(1,1/0),Dn(It)),[me.Color]:Zt(on(1,4),Dn(It)),[me.Band]:Zt(on(1,3),Dn(It)),[me.Palette]:Zt(on(2,2),pH),[me.ToString]:Zt(on(1,1),Dn(ei|It|fi|wr))};function CN(n,e,t){const r=n.length-1,i=new Array(r);for(let s=0;s<r;++s){const a=n[s+1];switch(typeof a){case"number":{i[s]=new di(It,a);break}case"string":{i[s]=new di(fi,a);break}default:throw new Error(`expected a string key or numeric array index for a get operation, got ${a}`)}s===0&&t.properties.add(String(a))}return i}function lH(n,e,t){const r=n[1];if(typeof r!="string")throw new Error("expected a string argument for var operation");return t.variables.add(r),[new di(fi,r)]}function cH(n,e,t){t.featureId=!0}function uH(n,e,t){t.geometryType=!0}function PS(n,e,t){t.mapState=!0}function Rf(n,e,t){const r=n[0];if(n.length!==1)throw new Error(`expected no arguments for ${r} operation`);return[]}function on(n,e){return function(t,r,i){const s=t[0],a=t.length-1;if(n===e){if(a!==n){const o=n===1?"":"s";throw new Error(`expected ${n} argument${o} for ${s}, got ${a}`)}}else if(a<n||a>e){const o=e===1/0?`${n} or more`:`${n} to ${e}`;throw new Error(`expected ${o} arguments for ${s}, got ${a}`)}}}function PN(n,e,t){const r=n.length-1,i=new Array(r);for(let s=0;s<r;++s){const a=Ai(n[s+1],e,t);i[s]=a}return i}function Dn(n){return function(e,t,r){const i=e.length-1,s=new Array(i);for(let a=0;a<i;++a){const o=Ai(e[a+1],n,r);s[a]=o}return s}}function hH(n,e,t){const r=n[0],i=n.length-1;if(i%2===0)throw new Error(`expected an odd number of arguments for ${r}, got ${i} instead`)}function NN(n,e,t){const r=n[0],i=n.length-1;if(i%2===1)throw new Error(`expected an even number of arguments for operation ${r}, got ${i} instead`)}function dH(n,e,t){const r=n.length-1,i=fi|It|ei,s=Ai(n[1],i,t),a=Ai(n[n.length-1],e,t),o=new Array(r-2);for(let l=0;l<r-2;l+=2){try{const c=Ai(n[l+2],s.type,t);o[l]=c}catch(c){throw new Error(`failed to parse argument ${l+1} of match expression: ${c.message}`)}try{const c=Ai(n[l+3],a.type,t);o[l+1]=c}catch(c){throw new Error(`failed to parse argument ${l+2} of match expression: ${c.message}`)}}return[s,...o,a]}function fH(n,e,t){const r=n[1];let i;switch(r[0]){case"linear":i=1;break;case"exponential":const l=r[1];if(typeof l!="number"||l<=0)throw new Error(`expected a number base for exponential interpolation, got ${JSON.stringify(l)} instead`);i=l;break;default:throw new Error(`invalid interpolation type: ${JSON.stringify(r)}`)}const s=new di(It,i);let a;try{a=Ai(n[2],It,t)}catch(l){throw new Error(`failed to parse argument 1 in interpolate expression: ${l.message}`)}const o=new Array(n.length-3);for(let l=0;l<o.length;l+=2){try{const c=Ai(n[l+3],It,t);o[l]=c}catch(c){throw new Error(`failed to parse argument ${l+2} for interpolate expression: ${c.message}`)}try{const c=Ai(n[l+4],e,t);o[l+1]=c}catch(c){throw new Error(`failed to parse argument ${l+3} for interpolate expression: ${c.message}`)}}return[s,a,...o]}function gH(n,e,t){const r=Ai(n[n.length-1],e,t),i=new Array(n.length-1);for(let s=0;s<i.length-1;s+=2){try{const a=Ai(n[s+1],ei,t);i[s]=a}catch(a){throw new Error(`failed to parse argument ${s} of case expression: ${a.message}`)}try{const a=Ai(n[s+2],r.type,t);i[s+1]=a}catch(a){throw new Error(`failed to parse argument ${s+1} of case expression: ${a.message}`)}}return i[i.length-1]=r,i}function mH(n,e,t){let r=n[2];if(!Array.isArray(r))throw new Error('the second argument for the "in" operator must be an array');let i;if(typeof r[0]=="string"){if(r[0]!=="literal")throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(r[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');r=r[1],i=fi}else i=It;const s=new Array(r.length);for(let o=0;o<s.length;o++)try{const l=Ai(r[o],i,t);s[o]=l}catch(l){throw new Error(`failed to parse haystack item ${o} for "in" expression: ${l.message}`)}return[Ai(n[1],i,t),...s]}function pH(n,e,t){let r;try{r=Ai(n[1],It,t)}catch(a){throw new Error(`failed to parse first argument in palette expression: ${a.message}`)}const i=n[2];if(!Array.isArray(i))throw new Error("the second argument of palette must be an array");const s=new Array(i.length);for(let a=0;a<s.length;a++){let o;try{o=Ai(i[a],wr,t)}catch(l){throw new Error(`failed to parse color at index ${a} in palette expression: ${l.message}`)}if(!(o instanceof di))throw new Error(`the palette color at index ${a} must be a literal value`);s[a]=o}return[r,...s]}function Zt(...n){return function(e,t,r){const i=e[0];let s;for(let a=0;a<n.length;a++){const o=n[a](e,t,r);if(a==n.length-1){if(!o)throw new Error("expected last argument validator to return the parsed args");s=o}}return new wj(t,i,...s)}}function yH(n,e,t){const r=n[0],i=oH[r];if(!i)throw new Error(`unknown operator: ${r}`);return i(n,e,t)}function EA(n){if(!n)return"";const e=n.getType();switch(e){case"Point":case"LineString":case"Polygon":return e;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return e.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return EA(n.getGeometries()[0]);default:return""}}function Ej(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function mc(n,e,t){const r=Ai(n,e,t);return So(r)}function So(n,e){if(n instanceof di){if(n.type===wr&&typeof n.value=="string"){const r=dA(n.value);return function(){return r}}return function(){return n.value}}const t=n.operator;switch(t){case me.Number:case me.String:case me.Coalesce:return xH(n);case me.Get:case me.Var:case me.Has:return _H(n);case me.Id:return r=>r.featureId;case me.GeometryType:return r=>r.geometryType;case me.Concat:{const r=n.args.map(i=>So(i));return i=>"".concat(...r.map(s=>s(i).toString()))}case me.Resolution:return r=>r.resolution;case me.Any:case me.All:case me.Between:case me.In:case me.Not:return wH(n);case me.Equal:case me.NotEqual:case me.LessThan:case me.LessThanOrEqualTo:case me.GreaterThan:case me.GreaterThanOrEqualTo:return vH(n);case me.Multiply:case me.Divide:case me.Add:case me.Subtract:case me.Clamp:case me.Mod:case me.Pow:case me.Abs:case me.Floor:case me.Ceil:case me.Round:case me.Sin:case me.Cos:case me.Atan:case me.Sqrt:return EH(n);case me.Case:return SH(n);case me.Match:return bH(n);case me.Interpolate:return TH(n);case me.ToString:return RH(n);default:throw new Error(`Unsupported operator ${t}`)}}function xH(n,e){const t=n.operator,r=n.args.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=So(n.args[s]);switch(t){case me.Coalesce:return s=>{for(let a=0;a<r;++a){const o=i[a](s);if(typeof o<"u"&&o!==null)return o}throw new Error("Expected one of the values to be non-null")};case me.Number:case me.String:return s=>{for(let a=0;a<r;++a){const o=i[a](s);if(typeof o===t)return o}throw new Error(`Expected one of the values to be a ${t}`)};default:throw new Error(`Unsupported assertion operator ${t}`)}}function _H(n,e){const r=n.args[0].value;switch(n.operator){case me.Get:return i=>{const s=n.args;let a=i.properties[r];for(let o=1,l=s.length;o<l;++o){const h=s[o].value;a=a[h]}return a};case me.Var:return i=>i.variables[r];case me.Has:return i=>{const s=n.args;if(!(r in i.properties))return!1;let a=i.properties[r];for(let o=1,l=s.length;o<l;++o){const h=s[o].value;if(!a||!Object.hasOwn(a,h))return!1;a=a[h]}return!0};default:throw new Error(`Unsupported accessor operator ${n.operator}`)}}function vH(n,e){const t=n.operator,r=So(n.args[0]),i=So(n.args[1]);switch(t){case me.Equal:return s=>r(s)===i(s);case me.NotEqual:return s=>r(s)!==i(s);case me.LessThan:return s=>r(s)<i(s);case me.LessThanOrEqualTo:return s=>r(s)<=i(s);case me.GreaterThan:return s=>r(s)>i(s);case me.GreaterThanOrEqualTo:return s=>r(s)>=i(s);default:throw new Error(`Unsupported comparison operator ${t}`)}}function wH(n,e){const t=n.operator,r=n.args.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=So(n.args[s]);switch(t){case me.Any:return s=>{for(let a=0;a<r;++a)if(i[a](s))return!0;return!1};case me.All:return s=>{for(let a=0;a<r;++a)if(!i[a](s))return!1;return!0};case me.Between:return s=>{const a=i[0](s),o=i[1](s),l=i[2](s);return a>=o&&a<=l};case me.In:return s=>{const a=i[0](s);for(let o=1;o<r;++o)if(a===i[o](s))return!0;return!1};case me.Not:return s=>!i[0](s);default:throw new Error(`Unsupported logical operator ${t}`)}}function EH(n,e){const t=n.operator,r=n.args.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=So(n.args[s]);switch(t){case me.Multiply:return s=>{let a=1;for(let o=0;o<r;++o)a*=i[o](s);return a};case me.Divide:return s=>i[0](s)/i[1](s);case me.Add:return s=>{let a=0;for(let o=0;o<r;++o)a+=i[o](s);return a};case me.Subtract:return s=>i[0](s)-i[1](s);case me.Clamp:return s=>{const a=i[0](s),o=i[1](s);if(a<o)return o;const l=i[2](s);return a>l?l:a};case me.Mod:return s=>i[0](s)%i[1](s);case me.Pow:return s=>Math.pow(i[0](s),i[1](s));case me.Abs:return s=>Math.abs(i[0](s));case me.Floor:return s=>Math.floor(i[0](s));case me.Ceil:return s=>Math.ceil(i[0](s));case me.Round:return s=>Math.round(i[0](s));case me.Sin:return s=>Math.sin(i[0](s));case me.Cos:return s=>Math.cos(i[0](s));case me.Atan:return r===2?s=>Math.atan2(i[0](s),i[1](s)):s=>Math.atan(i[0](s));case me.Sqrt:return s=>Math.sqrt(i[0](s));default:throw new Error(`Unsupported numeric operator ${t}`)}}function SH(n,e){const t=n.args.length,r=new Array(t);for(let i=0;i<t;++i)r[i]=So(n.args[i]);return i=>{for(let s=0;s<t-1;s+=2)if(r[s](i))return r[s+1](i);return r[t-1](i)}}function bH(n,e){const t=n.args.length,r=new Array(t);for(let i=0;i<t;++i)r[i]=So(n.args[i]);return i=>{const s=r[0](i);for(let a=1;a<t-1;a+=2)if(s===r[a](i))return r[a+1](i);return r[t-1](i)}}function TH(n,e){const t=n.args.length,r=new Array(t);for(let i=0;i<t;++i)r[i]=So(n.args[i]);return i=>{const s=r[0](i),a=r[1](i);let o,l;for(let c=2;c<t;c+=2){const h=r[c](i);let g=r[c+1](i);const m=Array.isArray(g);if(m&&(g=eW(g)),h>=a)return c===2?g:m?AH(s,a,o,l,h,g):Tm(s,a,o,l,h,g);o=h,l=g}return l}}function RH(n,e){const t=n.operator,r=n.args.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=So(n.args[s]);switch(t){case me.ToString:return s=>{const a=i[0](s);return n.args[0].type===wr?fA(a):a.toString()};default:throw new Error(`Unsupported convert operator ${t}`)}}function Tm(n,e,t,r,i,s){const a=i-t;if(a===0)return r;const o=e-t,l=n===1?o/a:(Math.pow(n,o)-1)/(Math.pow(n,a)-1);return r+l*(s-r)}function AH(n,e,t,r,i,s){if(i-t===0)return r;const o=cN(r),l=cN(s);let c=l[2]-o[2];c>180?c-=360:c<-180&&(c+=360);const h=[Tm(n,e,t,o[0],i,l[0]),Tm(n,e,t,o[1],i,l[1]),o[2]+Tm(n,e,t,0,i,c),Tm(n,e,t,r[3],i,s[3])];return tW(h)}function kH(n){return!0}function IH(n){const e=wA(),t=CH(n,e),r=Ej();return function(i,s){if(r.properties=i.getPropertiesInternal(),r.resolution=s,e.featureId){const a=i.getId();a!==void 0?r.featureId=a:r.featureId=null}return e.geometryType&&(r.geometryType=EA(i.getGeometry())),t(r)}}function MN(n){const e=wA(),t=n.length,r=new Array(t);for(let a=0;a<t;++a)r[a]=mT(n[a],e);const i=Ej(),s=new Array(t);return function(a,o){if(i.properties=a.getPropertiesInternal(),i.resolution=o,e.featureId){const c=a.getId();c!==void 0?i.featureId=c:i.featureId=null}let l=0;for(let c=0;c<t;++c){const h=r[c](i);h&&(s[l]=h,l+=1)}return s.length=l,s}}function CH(n,e){const t=n.length,r=new Array(t);for(let i=0;i<t;++i){const s=n[i],a="filter"in s?mc(s.filter,ei,e):kH;let o;if(Array.isArray(s.style)){const l=s.style.length;o=new Array(l);for(let c=0;c<l;++c)o[c]=mT(s.style[c],e)}else o=[mT(s.style,e)];r[i]={filter:a,styles:o}}return function(i){const s=[];let a=!1;for(let o=0;o<t;++o){const l=r[o].filter;if(l(i)&&!(n[o].else&&a)){a=!0;for(const c of r[o].styles){const h=c(i);h&&s.push(h)}}}return s}}function mT(n,e){const t=kp(n,"",e),r=Ip(n,"",e),i=PH(n,e),s=NH(n,e),a=js(n,"z-index",e);if(!t&&!r&&!i&&!s&&!id(n))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(n));const o=new gn;return function(l){let c=!0;if(t){const h=t(l);h&&(c=!1),o.setFill(h)}if(r){const h=r(l);h&&(c=!1),o.setStroke(h)}if(i){const h=i(l);h&&(c=!1),o.setText(h)}if(s){const h=s(l);h&&(c=!1),o.setImage(h)}return a&&o.setZIndex(a(l)),c?null:o}}function kp(n,e,t){let r;if(e+"fill-pattern-src"in n)r=DH(n,e+"fill-",t);else{if(n[e+"fill-color"]==="none")return s=>null;r=SA(n,e+"fill-color",t)}if(!r)return null;const i=new Jn;return function(s){const a=r(s);return a===hA?null:(i.setColor(a),i)}}function Ip(n,e,t){const r=js(n,e+"stroke-width",t),i=SA(n,e+"stroke-color",t);if(!r&&!i)return null;const s=Bl(n,e+"stroke-line-cap",t),a=Bl(n,e+"stroke-line-join",t),o=Sj(n,e+"stroke-line-dash",t),l=js(n,e+"stroke-line-dash-offset",t),c=js(n,e+"stroke-miter-limit",t),h=new Hn;return function(g){if(i){const m=i(g);if(m===hA)return null;h.setColor(m)}if(r&&h.setWidth(r(g)),s){const m=s(g);if(m!=="butt"&&m!=="round"&&m!=="square")throw new Error("Expected butt, round, or square line cap");h.setLineCap(m)}if(a){const m=a(g);if(m!=="bevel"&&m!=="round"&&m!=="miter")throw new Error("Expected bevel, round, or miter line join");h.setLineJoin(m)}return o&&h.setLineDash(o(g)),l&&h.setLineDashOffset(l(g)),c&&h.setMiterLimit(c(g)),h}}function PH(n,e){const t="text-",r=Bl(n,t+"value",e);if(!r)return null;const i=kp(n,t,e),s=kp(n,t+"background-",e),a=Ip(n,t,e),o=Ip(n,t+"background-",e),l=Bl(n,t+"font",e),c=js(n,t+"max-angle",e),h=js(n,t+"offset-x",e),g=js(n,t+"offset-y",e),m=g0(n,t+"overflow",e),y=Bl(n,t+"placement",e),_=js(n,t+"repeat",e),x=Nw(n,t+"scale",e),w=g0(n,t+"rotate-with-view",e),b=js(n,t+"rotation",e),T=Bl(n,t+"align",e),k=Bl(n,t+"justify",e),L=Bl(n,t+"baseline",e),O=g0(n,t+"keep-upright",e),B=Sj(n,t+"padding",e),R=Mw(n,t+"declutter-mode"),A=new yo({declutterMode:R});return function(P){if(A.setText(r(P)),i&&A.setFill(i(P)),s&&A.setBackgroundFill(s(P)),a&&A.setStroke(a(P)),o&&A.setBackgroundStroke(o(P)),l&&A.setFont(l(P)),c&&A.setMaxAngle(c(P)),h&&A.setOffsetX(h(P)),g&&A.setOffsetY(g(P)),m&&A.setOverflow(m(P)),y){const D=y(P);if(D!=="point"&&D!=="line")throw new Error("Expected point or line for text-placement");A.setPlacement(D)}if(_&&A.setRepeat(_(P)),x&&A.setScale(x(P)),w&&A.setRotateWithView(w(P)),b&&A.setRotation(b(P)),T){const D=T(P);if(D!=="left"&&D!=="center"&&D!=="right"&&D!=="end"&&D!=="start")throw new Error("Expected left, right, center, start, or end for text-align");A.setTextAlign(D)}if(k){const D=k(P);if(D!=="left"&&D!=="right"&&D!=="center")throw new Error("Expected left, right, or center for text-justify");A.setJustify(D)}if(L){const D=L(P);if(D!=="bottom"&&D!=="top"&&D!=="middle"&&D!=="alphabetic"&&D!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");A.setTextBaseline(D)}return B&&A.setPadding(B(P)),O&&A.setKeepUpright(O(P)),A}}function NH(n,e){return"icon-src"in n?MH(n,e):"shape-points"in n?LH(n,e):"circle-radius"in n?OH(n,e):null}function MH(n,e){const t="icon-",r=t+"src",i=bj(n[r],r),s=$_(n,t+"anchor",e),a=Nw(n,t+"scale",e),o=js(n,t+"opacity",e),l=$_(n,t+"displacement",e),c=js(n,t+"rotation",e),h=g0(n,t+"rotate-with-view",e),g=ON(n,t+"anchor-origin"),m=DN(n,t+"anchor-x-units"),y=DN(n,t+"anchor-y-units"),_=BH(n,t+"color"),x=FH(n,t+"cross-origin"),w=VH(n,t+"offset"),b=ON(n,t+"offset-origin"),T=W_(n,t+"width"),k=W_(n,t+"height"),L=jH(n,t+"size"),O=Mw(n,t+"declutter-mode"),B=new S1({src:i,anchorOrigin:g,anchorXUnits:m,anchorYUnits:y,color:_,crossOrigin:x,offset:w,offsetOrigin:b,height:k,width:T,size:L,declutterMode:O});return function(R){return o&&B.setOpacity(o(R)),l&&B.setDisplacement(l(R)),c&&B.setRotation(c(R)),h&&B.setRotateWithView(h(R)),a&&B.setScale(a(R)),s&&B.setAnchor(s(R)),B}}function LH(n,e){const t="shape-",r=t+"points",i=t+"radius",s=pT(n[r],r),a=pT(n[i],i),o=kp(n,t,e),l=Ip(n,t,e),c=Nw(n,t+"scale",e),h=$_(n,t+"displacement",e),g=js(n,t+"rotation",e),m=g0(n,t+"rotate-with-view",e),y=W_(n,t+"radius2"),_=W_(n,t+"angle"),x=Mw(n,t+"declutter-mode"),w=new Pw({points:s,radius:a,radius2:y,angle:_,declutterMode:x});return function(b){return o&&w.setFill(o(b)),l&&w.setStroke(l(b)),h&&w.setDisplacement(h(b)),g&&w.setRotation(g(b)),m&&w.setRotateWithView(m(b)),c&&w.setScale(c(b)),w}}function OH(n,e){const t="circle-",r=kp(n,t,e),i=Ip(n,t,e),s=js(n,t+"radius",e),a=Nw(n,t+"scale",e),o=$_(n,t+"displacement",e),l=js(n,t+"rotation",e),c=g0(n,t+"rotate-with-view",e),h=Mw(n,t+"declutter-mode"),g=new Us({radius:5,declutterMode:h});return function(m){return s&&g.setRadius(s(m)),r&&g.setFill(r(m)),i&&g.setStroke(i(m)),o&&g.setDisplacement(o(m)),l&&g.setRotation(l(m)),c&&g.setRotateWithView(c(m)),a&&g.setScale(a(m)),g}}function js(n,e,t){if(!(e in n))return;const r=mc(n[e],It,t);return function(i){return pT(r(i),e)}}function Bl(n,e,t){if(!(e in n))return null;const r=mc(n[e],fi,t);return function(i){return bj(r(i),e)}}function DH(n,e,t){const r=Bl(n,e+"pattern-src",t),i=LN(n,e+"pattern-offset",t),s=LN(n,e+"pattern-size",t),a=SA(n,e+"color",t);return function(o){return{src:r(o),offset:i&&i(o),size:s&&s(o),color:a&&a(o)}}}function g0(n,e,t){if(!(e in n))return null;const r=mc(n[e],ei,t);return function(i){const s=r(i);if(typeof s!="boolean")throw new Error(`Expected a boolean for ${e}`);return s}}function SA(n,e,t){if(!(e in n))return null;const r=mc(n[e],wr,t);return function(i){return Tj(r(i),e)}}function Sj(n,e,t){if(!(e in n))return null;const r=mc(n[e],$s,t);return function(i){return b1(r(i),e)}}function $_(n,e,t){if(!(e in n))return null;const r=mc(n[e],$s,t);return function(i){const s=b1(r(i),e);if(s.length!==2)throw new Error(`Expected two numbers for ${e}`);return s}}function LN(n,e,t){if(!(e in n))return null;const r=mc(n[e],$s,t);return function(i){return Rj(r(i),e)}}function Nw(n,e,t){if(!(e in n))return null;const r=mc(n[e],$s|It,t);return function(i){return GH(r(i),e)}}function W_(n,e){const t=n[e];if(t!==void 0){if(typeof t!="number")throw new Error(`Expected a number for ${e}`);return t}}function jH(n,e){const t=n[e];if(t!==void 0){if(typeof t=="number")return Es(t);if(!Array.isArray(t))throw new Error(`Expected a number or size array for ${e}`);if(t.length!==2||typeof t[0]!="number"||typeof t[1]!="number")throw new Error(`Expected a number or size array for ${e}`);return t}}function FH(n,e){const t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);return t}}function ON(n,e){const t=n[e];if(t!==void 0){if(t!=="bottom-left"&&t!=="bottom-right"&&t!=="top-left"&&t!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${e}`);return t}}function DN(n,e){const t=n[e];if(t!==void 0){if(t!=="pixels"&&t!=="fraction")throw new Error(`Expected pixels or fraction for ${e}`);return t}}function VH(n,e){const t=n[e];if(t!==void 0)return b1(t,e)}function Mw(n,e){const t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);if(t!=="declutter"&&t!=="obstacle"&&t!=="none")throw new Error(`Expected declutter, obstacle, or none for ${e}`);return t}}function BH(n,e){const t=n[e];if(t!==void 0)return Tj(t,e)}function b1(n,e){if(!Array.isArray(n))throw new Error(`Expected an array for ${e}`);const t=n.length;for(let r=0;r<t;++r)if(typeof n[r]!="number")throw new Error(`Expected an array of numbers for ${e}`);return n}function bj(n,e){if(typeof n!="string")throw new Error(`Expected a string for ${e}`);return n}function pT(n,e){if(typeof n!="number")throw new Error(`Expected a number for ${e}`);return n}function Tj(n,e){if(typeof n=="string")return n;const t=b1(n,e),r=t.length;if(r<3||r>4)throw new Error(`Expected a color with 3 or 4 values for ${e}`);return t}function Rj(n,e){const t=b1(n,e);if(t.length!==2)throw new Error(`Expected an array of two numbers for ${e}`);return t}function GH(n,e){return typeof n=="number"?n:Rj(n,e)}const to={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function jN(n,e,t){return(function(r,i,s,a,o){if(!r)return;if(!i&&!e)return r;const l=e?0:s[0]*i,c=e?0:s[1]*i,h=o?o[0]:0,g=o?o[1]:0;let m=n[0]+l/2+h,y=n[2]-l/2+h,_=n[1]+c/2+g,x=n[3]-c/2+g;m>y&&(m=(y+m)/2,y=m),_>x&&(_=(x+_)/2,x=_);let w=hr(r[0],m,y),b=hr(r[1],_,x);if(a&&t&&i){const T=30*i;w+=-T*Math.log(1+Math.max(0,m-r[0])/T)+T*Math.log(1+Math.max(0,r[0]-y)/T),b+=-T*Math.log(1+Math.max(0,_-r[1])/T)+T*Math.log(1+Math.max(0,r[1]-x)/T)}return[w,b]})}function zH(n){return n}function Aj(n){return Math.pow(n,3)}function og(n){return 1-Aj(1-n)}function UH(n){return 3*n*n-2*n*n*n}function $H(n){return n}function bA(n,e,t,r){const i=yn(e)/t[0],s=ti(e)/t[1];return r?Math.min(n,Math.max(i,s)):Math.min(n,Math.min(i,s))}function TA(n,e,t){let r=Math.min(n,e);const i=50;return r*=Math.log(1+i*Math.max(0,n/e-1))/i+1,t&&(r=Math.max(r,t),r/=Math.log(1+i*Math.max(0,t/n-1))/i+1),hr(r,t/2,e*2)}function WH(n,e,t,r){return e=e!==void 0?e:!0,(function(i,s,a,o){if(i!==void 0){const l=n[0],c=n[n.length-1],h=t?bA(l,t,a,r):l;if(o)return e?TA(i,h,c):hr(i,c,h);const g=Math.min(h,i),m=Math.floor(xw(n,g,s));return n[m]>h&&m<n.length-1?n[m+1]:n[m]}})}function HH(n,e,t,r,i,s){return r=r!==void 0?r:!0,t=t!==void 0?t:0,(function(a,o,l,c){if(a!==void 0){const h=i?bA(e,i,l,s):e;if(c)return r?TA(a,h,t):hr(a,t,h);const g=1e-9,m=Math.ceil(Math.log(e/h)/Math.log(n)-g),y=-o*(.5-g)+.5,_=Math.min(h,a),x=Math.floor(Math.log(e/_)/Math.log(n)+y),w=Math.max(m,x),b=e/Math.pow(n,w);return hr(b,t,h)}})}function FN(n,e,t,r,i){return t=t!==void 0?t:!0,(function(s,a,o,l){if(s!==void 0){const c=r?bA(n,r,o,i):n;return!t||!l?hr(s,e,c):TA(s,c,e)}})}function RA(n){if(n!==void 0)return 0}function VN(n){if(n!==void 0)return n}function KH(n){const e=2*Math.PI/n;return(function(t,r){if(r)return t;if(t!==void 0)return t=Math.floor(t/e+.5)*e,t})}function XH(n){const e=Yl(5);return(function(t,r){return r||t===void 0?t:Math.abs(t)<=e?0:t})}const qH=42,AA=256,NS=0;class Zo extends yl{constructor(e){super(),this.on,this.once,this.un,e=Object.assign({},e),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=tA(e.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,e.projection&&LD(),e.center&&(e.center=Fl(e.center,this.projection_)),e.extent&&(e.extent=Jo(e.extent,this.projection_)),this.applyOptions_(e)}applyOptions_(e){const t=Object.assign({},e);for(const o in to)delete t[o];this.setProperties(t,!0);const r=ZH(e);this.maxResolution_=r.maxResolution,this.minResolution_=r.minResolution,this.zoomFactor_=r.zoomFactor,this.resolutions_=e.resolutions,this.padding_=e.padding,this.minZoom_=r.minZoom;const i=YH(e),s=r.constraint,a=JH(e);this.constraints_={center:i,resolution:s,rotation:a},this.setRotation(e.rotation!==void 0?e.rotation:0),this.setCenterInternal(e.center!==void 0?e.center:null),e.resolution!==void 0?this.setResolution(e.resolution):e.zoom!==void 0&&this.setZoom(e.zoom)}get padding(){return this.padding_}set padding(e){let t=this.padding_;this.padding_=e;const r=this.getCenterInternal();if(r){const i=e||[0,0,0,0];t=t||[0,0,0,0];const s=this.getResolution(),a=s/2*(i[3]-t[3]+t[1]-i[1]),o=s/2*(i[0]-t[0]+t[2]-i[2]);this.setCenterInternal([r[0]+a,r[1]-o])}}getUpdatedOptions_(e){const t=this.getProperties();return t.resolution!==void 0?t.resolution=this.getResolution():t.zoom=this.getZoom(),t.center=this.getCenterInternal(),t.rotation=this.getRotation(),Object.assign({},t,e)}animate(e){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const t=new Array(arguments.length);for(let r=0;r<t.length;++r){let i=arguments[r];i.center&&(i=Object.assign({},i),i.center=Fl(i.center,this.getProjection())),i.anchor&&(i=Object.assign({},i),i.anchor=Fl(i.anchor,this.getProjection())),t[r]=i}this.animateInternal.apply(this,t)}animateInternal(e){let t=arguments.length,r;t>1&&typeof arguments[t-1]=="function"&&(r=arguments[t-1],--t);let i=0;for(;i<t&&!this.isDef();++i){const h=arguments[i];h.center&&this.setCenterInternal(h.center),h.zoom!==void 0?this.setZoom(h.zoom):h.resolution&&this.setResolution(h.resolution),h.rotation!==void 0&&this.setRotation(h.rotation)}if(i===t){r&&wx(r,!0);return}let s=Date.now(),a=this.targetCenter_.slice(),o=this.targetResolution_,l=this.targetRotation_;const c=[];for(;i<t;++i){const h=arguments[i],g={start:s,complete:!1,anchor:h.anchor,duration:h.duration!==void 0?h.duration:1e3,easing:h.easing||UH,callback:r};if(h.center&&(g.sourceCenter=a,g.targetCenter=h.center.slice(),a=g.targetCenter),h.zoom!==void 0?(g.sourceResolution=o,g.targetResolution=this.getResolutionForZoom(h.zoom),o=g.targetResolution):h.resolution&&(g.sourceResolution=o,g.targetResolution=h.resolution,o=g.targetResolution),h.rotation!==void 0){g.sourceRotation=l;const m=Eu(h.rotation-l+Math.PI,2*Math.PI)-Math.PI;g.targetRotation=l+m,l=g.targetRotation}QH(g)?g.complete=!0:s+=g.duration,c.push(g)}this.animations_.push(c),this.setHint(Qr.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[Qr.ANIMATING]>0}getInteracting(){return this.hints_[Qr.INTERACTING]>0}cancelAnimations(){this.setHint(Qr.ANIMATING,-this.hints_[Qr.ANIMATING]);let e;for(let t=0,r=this.animations_.length;t<r;++t){const i=this.animations_[t];if(i[0].callback&&wx(i[0].callback,!1),!e)for(let s=0,a=i.length;s<a;++s){const o=i[s];if(!o.complete){e=o.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=e,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const e=Date.now();let t=!1;for(let r=this.animations_.length-1;r>=0;--r){const i=this.animations_[r];let s=!0;for(let a=0,o=i.length;a<o;++a){const l=i[a];if(l.complete)continue;const c=e-l.start;let h=l.duration>0?c/l.duration:1;h>=1?(l.complete=!0,h=1):s=!1;const g=l.easing(h);if(l.sourceCenter){const m=l.sourceCenter[0],y=l.sourceCenter[1],_=l.targetCenter[0],x=l.targetCenter[1];this.nextCenter_=l.targetCenter;const w=m+g*(_-m),b=y+g*(x-y);this.targetCenter_=[w,b]}if(l.sourceResolution&&l.targetResolution){const m=g===1?l.targetResolution:l.sourceResolution+g*(l.targetResolution-l.sourceResolution);if(l.anchor){const y=this.getViewportSize_(this.getRotation()),_=this.constraints_.resolution(m,0,y,!0);this.targetCenter_=this.calculateCenterZoom(_,l.anchor)}this.nextResolution_=l.targetResolution,this.targetResolution_=m,this.applyTargetState_(!0)}if(l.sourceRotation!==void 0&&l.targetRotation!==void 0){const m=g===1?Eu(l.targetRotation+Math.PI,2*Math.PI)-Math.PI:l.sourceRotation+g*(l.targetRotation-l.sourceRotation);if(l.anchor){const y=this.constraints_.rotation(m,!0);this.targetCenter_=this.calculateCenterRotate(y,l.anchor)}this.nextRotation_=l.targetRotation,this.targetRotation_=m}if(this.applyTargetState_(!0),t=!0,!l.complete)break}if(s){this.animations_[r]=null,this.setHint(Qr.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const a=i[0].callback;a&&wx(a,!0)}}this.animations_=this.animations_.filter(Boolean),t&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(e,t){let r;const i=this.getCenterInternal();return i!==void 0&&(r=[i[0]-t[0],i[1]-t[1]],ZR(r,e-this.getRotation()),$U(r,t)),r}calculateCenterZoom(e,t){let r;const i=this.getCenterInternal(),s=this.getResolution();if(i!==void 0&&s!==void 0){const a=t[0]-e*(t[0]-i[0])/s,o=t[1]-e*(t[1]-i[1])/s;r=[a,o]}return r}getViewportSize_(e){const t=this.viewportSize_;if(e){const r=t[0],i=t[1];return[Math.abs(r*Math.cos(e))+Math.abs(i*Math.sin(e)),Math.abs(r*Math.sin(e))+Math.abs(i*Math.cos(e))]}return t}setViewportSize(e){this.viewportSize_=Array.isArray(e)?e.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const e=this.getCenterInternal();return e&&oT(e,this.getProjection())}getCenterInternal(){return this.get(to.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(e){return e!==void 0?(e[0]=this.hints_[0],e[1]=this.hints_[1],e):this.hints_.slice()}calculateExtent(e){const t=this.calculateExtentInternal(e);return OD(t,this.getProjection())}calculateExtentInternal(e){e=e||this.getViewportSizeMinusPadding_();const t=this.getCenterInternal();Rn(t,"The view center is not defined");const r=this.getResolution();Rn(r!==void 0,"The view resolution is not defined");const i=this.getRotation();return Rn(i!==void 0,"The view rotation is not defined"),P_(t,r,i,e)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(e){this.applyOptions_(this.getUpdatedOptions_({maxZoom:e}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(e){this.applyOptions_(this.getUpdatedOptions_({minZoom:e}))}setConstrainResolution(e){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:e}))}getProjection(){return this.projection_}getResolution(){return this.get(to.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(e,t){return this.getResolutionForExtentInternal(Jo(e,this.getProjection()),t)}getResolutionForExtentInternal(e,t){t=t||this.getViewportSizeMinusPadding_();const r=yn(e)/t[0],i=ti(e)/t[1];return Math.max(r,i)}getResolutionForValueFunction(e){e=e||2;const t=this.getConstrainedResolution(this.maxResolution_),r=this.minResolution_,i=Math.log(t/r)/Math.log(e);return(function(s){return t/Math.pow(e,s*i)})}getRotation(){return this.get(to.ROTATION)}getValueForResolutionFunction(e){const t=Math.log(e||2),r=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,s=Math.log(r/i)/t;return(function(a){return Math.log(r/a)/t/s})}getViewportSizeMinusPadding_(e){let t=this.getViewportSize_(e);const r=this.padding_;return r&&(t=[t[0]-r[1]-r[3],t[1]-r[0]-r[2]]),t}getState(){const e=this.getProjection(),t=this.getResolution(),r=this.getRotation();let i=this.getCenterInternal();const s=this.padding_;if(s){const a=this.getViewportSizeMinusPadding_();i=MS(i,this.getViewportSize_(),[a[0]/2+s[3],a[1]/2+s[0]],t,r)}return{center:i.slice(0),projection:e!==void 0?e:null,resolution:t,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:r,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let e;const t=this.getResolution();return t!==void 0&&(e=this.getZoomForResolution(t)),e}getZoomForResolution(e){let t=this.minZoom_||0,r,i;if(this.resolutions_){const s=xw(this.resolutions_,e,1);t=s,r=this.resolutions_[s],s==this.resolutions_.length-1?i=2:i=r/this.resolutions_[s+1]}else r=this.maxResolution_,i=this.zoomFactor_;return t+Math.log(r/e)/Math.log(i)}getResolutionForZoom(e){if(this.resolutions_?.length){if(this.resolutions_.length===1)return this.resolutions_[0];const t=hr(Math.floor(e),0,this.resolutions_.length-2),r=this.resolutions_[t]/this.resolutions_[t+1];return this.resolutions_[t]/Math.pow(r,hr(e-t,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,e-this.minZoom_)}fit(e,t){let r;if(Rn(Array.isArray(e)||typeof e.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(e)){Rn(!sg(e),"Cannot fit empty extent provided as `geometry`");const i=Jo(e,this.getProjection());r=yN(i)}else if(e.getType()==="Circle"){const i=Jo(e.getExtent(),this.getProjection());r=yN(i),r.rotate(this.getRotation(),Eo(i))}else r=e;this.fitInternal(r,t)}rotatedExtentForGeometry(e){const t=this.getRotation(),r=Math.cos(t),i=Math.sin(-t),s=e.getFlatCoordinates(),a=e.getStride();let o=1/0,l=1/0,c=-1/0,h=-1/0;for(let g=0,m=s.length;g<m;g+=a){const y=s[g]*r-s[g+1]*i,_=s[g]*i+s[g+1]*r;o=Math.min(o,y),l=Math.min(l,_),c=Math.max(c,y),h=Math.max(h,_)}return[o,l,c,h]}fitInternal(e,t){t=t||{};let r=t.size;r||(r=this.getViewportSizeMinusPadding_());const i=t.padding!==void 0?t.padding:[0,0,0,0],s=t.nearest!==void 0?t.nearest:!1;let a;t.minResolution!==void 0?a=t.minResolution:t.maxZoom!==void 0?a=this.getResolutionForZoom(t.maxZoom):a=0;const o=this.rotatedExtentForGeometry(e);let l=this.getResolutionForExtentInternal(o,[r[0]-i[1]-i[3],r[1]-i[0]-i[2]]);l=isNaN(l)?a:Math.max(l,a),l=this.getConstrainedResolution(l,s?0:1);const c=this.getRotation(),h=Math.sin(c),g=Math.cos(c),m=Eo(o);m[0]+=(i[1]-i[3])/2*l,m[1]+=(i[0]-i[2])/2*l;const y=m[0]*g-m[1]*h,_=m[1]*g+m[0]*h,x=this.getConstrainedCenter([y,_],l),w=t.callback?t.callback:_p;t.duration!==void 0?this.animateInternal({resolution:l,center:x,duration:t.duration,easing:t.easing},w):(this.targetResolution_=l,this.targetCenter_=x,this.applyTargetState_(!1,!0),wx(w,!0))}centerOn(e,t,r){this.centerOnInternal(Fl(e,this.getProjection()),t,r)}centerOnInternal(e,t,r){this.setCenterInternal(MS(e,t,r,this.getResolution(),this.getRotation()))}calculateCenterShift(e,t,r,i){let s;const a=this.padding_;if(a&&e){const o=this.getViewportSizeMinusPadding_(-r),l=MS(e,i,[o[0]/2+a[3],o[1]/2+a[0]],t,r);s=[e[0]-l[0],e[1]-l[1]]}return s}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(e){const t=oT(this.targetCenter_,this.getProjection());this.setCenter([t[0]+e[0],t[1]+e[1]])}adjustCenterInternal(e){const t=this.targetCenter_;this.setCenterInternal([t[0]+e[0],t[1]+e[1]])}adjustResolution(e,t){t=t&&Fl(t,this.getProjection()),this.adjustResolutionInternal(e,t)}adjustResolutionInternal(e,t){const r=this.getAnimating()||this.getInteracting(),i=this.getViewportSize_(this.getRotation()),s=this.constraints_.resolution(this.targetResolution_*e,0,i,r);t&&(this.targetCenter_=this.calculateCenterZoom(s,t)),this.targetResolution_*=e,this.applyTargetState_()}adjustZoom(e,t){this.adjustResolution(Math.pow(this.zoomFactor_,-e),t)}adjustRotation(e,t){t&&(t=Fl(t,this.getProjection())),this.adjustRotationInternal(e,t)}adjustRotationInternal(e,t){const r=this.getAnimating()||this.getInteracting(),i=this.constraints_.rotation(this.targetRotation_+e,r);t&&(this.targetCenter_=this.calculateCenterRotate(i,t)),this.targetRotation_+=e,this.applyTargetState_()}setCenter(e){this.setCenterInternal(e&&Fl(e,this.getProjection()))}setCenterInternal(e){this.targetCenter_=e,this.applyTargetState_()}setHint(e,t){return this.hints_[e]+=t,this.changed(),this.hints_[e]}setResolution(e){this.targetResolution_=e,this.applyTargetState_()}setRotation(e){this.targetRotation_=e,this.applyTargetState_()}setZoom(e){this.setResolution(this.getResolutionForZoom(e))}applyTargetState_(e,t){const r=this.getAnimating()||this.getInteracting()||t,i=this.constraints_.rotation(this.targetRotation_,r),s=this.getViewportSize_(i),a=this.constraints_.resolution(this.targetResolution_,0,s,r),o=this.constraints_.center(this.targetCenter_,a,s,r,this.calculateCenterShift(this.targetCenter_,a,i,s));this.get(to.ROTATION)!==i&&this.set(to.ROTATION,i),this.get(to.RESOLUTION)!==a&&(this.set(to.RESOLUTION,a),this.set("zoom",this.getZoom(),!0)),(!o||!this.get(to.CENTER)||!M_(this.get(to.CENTER),o))&&this.set(to.CENTER,o),this.getAnimating()&&!e&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(e,t,r){e=e!==void 0?e:200;const i=t||0,s=this.constraints_.rotation(this.targetRotation_),a=this.getViewportSize_(s),o=this.constraints_.resolution(this.targetResolution_,i,a),l=this.constraints_.center(this.targetCenter_,o,a,!1,this.calculateCenterShift(this.targetCenter_,o,s,a));if(e===0&&!this.cancelAnchor_){this.targetResolution_=o,this.targetRotation_=s,this.targetCenter_=l,this.applyTargetState_();return}r=r||(e===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==o||this.getRotation()!==s||!this.getCenterInternal()||!M_(this.getCenterInternal(),l))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:s,center:l,resolution:o,duration:e,easing:og,anchor:r}))}beginInteraction(){this.resolveConstraints(0),this.setHint(Qr.INTERACTING,1)}endInteraction(e,t,r){r=r&&Fl(r,this.getProjection()),this.endInteractionInternal(e,t,r)}endInteractionInternal(e,t,r){this.getInteracting()&&(this.setHint(Qr.INTERACTING,-1),this.resolveConstraints(e,t,r))}getConstrainedCenter(e,t){const r=this.getViewportSize_(this.getRotation());return this.constraints_.center(e,t||this.getResolution(),r)}getConstrainedZoom(e,t){const r=this.getResolutionForZoom(e);return this.getZoomForResolution(this.getConstrainedResolution(r,t))}getConstrainedResolution(e,t){t=t||0;const r=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(e,t,r)}}function wx(n,e){setTimeout(function(){n(e)},0)}function YH(n){if(n.extent!==void 0){const t=n.smoothExtentConstraint!==void 0?n.smoothExtentConstraint:!0;return jN(n.extent,n.constrainOnlyCenter,t)}const e=tA(n.projection,"EPSG:3857");if(n.multiWorld!==!0&&e.isGlobal()){const t=e.getExtent().slice();return t[0]=-1/0,t[2]=1/0,jN(t,!1,!1)}return zH}function ZH(n){let e,t,r,a=n.minZoom!==void 0?n.minZoom:NS,o=n.maxZoom!==void 0?n.maxZoom:28;const l=n.zoomFactor!==void 0?n.zoomFactor:2,c=n.multiWorld!==void 0?n.multiWorld:!1,h=n.smoothResolutionConstraint!==void 0?n.smoothResolutionConstraint:!0,g=n.showFullExtent!==void 0?n.showFullExtent:!1,m=tA(n.projection,"EPSG:3857"),y=m.getExtent();let _=n.constrainOnlyCenter,x=n.extent;if(!c&&!x&&m.isGlobal()&&(_=!1,x=y),n.resolutions!==void 0){const w=n.resolutions;t=w[a],r=w[o]!==void 0?w[o]:w[w.length-1],n.constrainResolution?e=WH(w,h,!_&&x,g):e=FN(t,r,h,!_&&x,g)}else{const b=(y?Math.max(yn(y),ti(y)):360*P0.degrees/m.getMetersPerUnit())/AA/Math.pow(2,NS),T=b/Math.pow(2,28-NS);t=n.maxResolution,t!==void 0?a=0:t=b/Math.pow(l,a),r=n.minResolution,r===void 0&&(n.maxZoom!==void 0?n.maxResolution!==void 0?r=t/Math.pow(l,o):r=b/Math.pow(l,o):r=T),o=a+Math.floor(Math.log(t/r)/Math.log(l)),r=t/Math.pow(l,o-a),n.constrainResolution?e=HH(l,t,r,h,!_&&x,g):e=FN(t,r,h,!_&&x,g)}return{constraint:e,maxResolution:t,minResolution:r,minZoom:a,zoomFactor:l}}function JH(n){if(n.enableRotation!==void 0?n.enableRotation:!0){const t=n.constrainRotation;return t===void 0||t===!0?XH():t===!1?VN:typeof t=="number"?KH(t):VN}return RA}function QH(n){return!(n.sourceCenter&&n.targetCenter&&!M_(n.sourceCenter,n.targetCenter)||n.sourceResolution!==n.targetResolution||n.sourceRotation!==n.targetRotation)}function MS(n,e,t,r,i){const s=Math.cos(-i);let a=Math.sin(-i),o=n[0]*s-n[1]*a,l=n[1]*s+n[0]*a;o+=(e[0]/2-t[0])*r,l+=(t[1]-e[1]/2)*r,a=-a;const c=o*s-l*a,h=l*s+o*a;return[c,h]}const jn={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class kj extends yl{constructor(e){super(),this.on,this.once,this.un,this.background_=e.background;const t=Object.assign({},e);typeof e.properties=="object"&&(delete t.properties,Object.assign(t,e.properties)),t[jn.OPACITY]=e.opacity!==void 0?e.opacity:1,Rn(typeof t[jn.OPACITY]=="number","Layer opacity must be a number"),t[jn.VISIBLE]=e.visible!==void 0?e.visible:!0,t[jn.Z_INDEX]=e.zIndex,t[jn.MAX_RESOLUTION]=e.maxResolution!==void 0?e.maxResolution:1/0,t[jn.MIN_RESOLUTION]=e.minResolution!==void 0?e.minResolution:0,t[jn.MIN_ZOOM]=e.minZoom!==void 0?e.minZoom:-1/0,t[jn.MAX_ZOOM]=e.maxZoom!==void 0?e.maxZoom:1/0,this.className_=t.className!==void 0?t.className:"ol-layer",delete t.className,this.setProperties(t),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(e){const t=this.state_||{layer:this,managed:e===void 0?!0:e},r=this.getZIndex();return t.opacity=hr(Math.round(this.getOpacity()*100)/100,0,1),t.visible=this.getVisible(),t.extent=this.getExtent(),t.zIndex=r===void 0&&!t.managed?1/0:r,t.maxResolution=this.getMaxResolution(),t.minResolution=Math.max(this.getMinResolution(),0),t.minZoom=this.getMinZoom(),t.maxZoom=this.getMaxZoom(),this.state_=t,t}getLayersArray(e){return Xt()}getLayerStatesArray(e){return Xt()}getExtent(){return this.get(jn.EXTENT)}getMaxResolution(){return this.get(jn.MAX_RESOLUTION)}getMinResolution(){return this.get(jn.MIN_RESOLUTION)}getMinZoom(){return this.get(jn.MIN_ZOOM)}getMaxZoom(){return this.get(jn.MAX_ZOOM)}getOpacity(){return this.get(jn.OPACITY)}getSourceState(){return Xt()}getVisible(){return this.get(jn.VISIBLE)}getZIndex(){return this.get(jn.Z_INDEX)}setBackground(e){this.background_=e,this.changed()}setExtent(e){this.set(jn.EXTENT,e)}setMaxResolution(e){this.set(jn.MAX_RESOLUTION,e)}setMinResolution(e){this.set(jn.MIN_RESOLUTION,e)}setMaxZoom(e){this.set(jn.MAX_ZOOM,e)}setMinZoom(e){this.set(jn.MIN_ZOOM,e)}setOpacity(e){Rn(typeof e=="number","Layer opacity must be a number"),this.set(jn.OPACITY,e)}setVisible(e){this.set(jn.VISIBLE,e)}setZIndex(e){this.set(jn.Z_INDEX,e)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}class T1 extends kj{constructor(e){const t=Object.assign({},e);delete t.source,super(t),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,e.render&&(this.render=e.render),e.map&&this.setMap(e.map),this.addChangeListener(jn.SOURCE,this.handleSourcePropertyChange_);const r=e.source?e.source:null;this.setSource(r)}getLayersArray(e){return e=e||[],e.push(this),e}getLayerStatesArray(e){return e=e||[],e.push(this.getLayerState()),e}getSource(){return this.get(jn.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const e=this.getSource();return e?e.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(or(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const e=this.getSource();e&&(this.sourceChangeKey_=pn(e,en.CHANGE,this.handleSourceChange_,this),e.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(e){return this.renderer_?this.renderer_.getFeatures(e):Promise.resolve([])}getData(e){return!this.renderer_||!this.rendered?null:this.renderer_.getData(e)}isVisible(e){let t;const r=this.getMapInternal();!e&&r&&(e=r.getView()),e instanceof Zo?t={viewState:e.getState(),extent:e.calculateExtent()}:t=e,!t.layerStatesArray&&r&&(t.layerStatesArray=r.getLayerGroup().getLayerStatesArray());let i;if(t.layerStatesArray){if(i=t.layerStatesArray.find(a=>a.layer===this),!i)return!1}else i=this.getLayerState();const s=this.getExtent();return kA(i,t.viewState)&&(!s||vs(s,t.extent))}getAttributions(e){if(!this.isVisible(e))return[];const t=this.getSource()?.getAttributions();if(!t)return[];const r=e instanceof Zo?e.getViewStateAndExtent():e;let i=t(r);return Array.isArray(i)||(i=[i]),i}render(e,t){const r=this.getRenderer();return r.prepareFrame(e)?(this.rendered=!0,r.renderFrame(e,t)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(e,t){}renderDeferred(e){const t=this.getRenderer();t&&t.renderDeferred(e)}setMapInternal(e){e||this.unrender(),this.set(jn.MAP,e)}getMapInternal(){return this.get(jn.MAP)}setMap(e){this.mapPrecomposeKey_&&(or(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),e||this.changed(),this.mapRenderKey_&&(or(this.mapRenderKey_),this.mapRenderKey_=null),e&&(this.mapPrecomposeKey_=pn(e,Si.PRECOMPOSE,this.handlePrecompose_,this),this.mapRenderKey_=pn(this,en.CHANGE,e.render,e),this.changed())}handlePrecompose_(e){const t=e.frameState.layerStatesArray,r=this.getLayerState(!1);Rn(!t.some(i=>i.layer===r.layer),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),t.push(r)}setSource(e){this.set(jn.SOURCE,e)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}clearRenderer(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_)}disposeInternal(){this.clearRenderer(),this.setSource(null),super.disposeInternal()}}function kA(n,e){if(!n.visible)return!1;const t=e.resolution;if(t<n.minResolution||t>=n.maxResolution)return!1;const r=e.zoom;return r>n.minZoom&&r<=n.maxZoom}const BN={RENDER_ORDER:"renderOrder"};class Lw extends T1{constructor(e){e=e||{};const t=Object.assign({},e);delete t.style,delete t.renderBuffer,delete t.updateWhileAnimating,delete t.updateWhileInteracting,super(t),this.declutter_=e.declutter?String(e.declutter):void 0,this.renderBuffer_=e.renderBuffer!==void 0?e.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(e.style),this.updateWhileAnimating_=e.updateWhileAnimating!==void 0?e.updateWhileAnimating:!1,this.updateWhileInteracting_=e.updateWhileInteracting!==void 0?e.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(e){return super.getFeatures(e)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(BN.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(e,t){const r=this.getDeclutter();r in e.declutter||(e.declutter[r]=new mj(9)),this.getRenderer().renderDeclutter(e,t)}setRenderOrder(e){this.set(BN.RENDER_ORDER,e)}setStyle(e){this.style_=e===void 0?pj:e;const t=eK(e);this.styleFunction_=e===null?void 0:FW(t),this.changed()}setDeclutter(e){this.declutter_=e?String(e):void 0,this.changed()}}function eK(n){if(n===void 0)return pj;if(!n)return null;if(typeof n=="function"||n instanceof gn)return n;if(!Array.isArray(n))return MN([n]);if(n.length===0)return[];const e=n.length,t=n[0];if(t instanceof gn){const i=new Array(e);for(let s=0;s<e;++s){const a=n[s];if(!(a instanceof gn))throw new Error("Expected a list of style instances");i[s]=a}return i}if("style"in t){const i=new Array(e);for(let s=0;s<e;++s){const a=n[s];if(!("style"in a))throw new Error("Expected a list of rules with a style property");i[s]=a}return IH(i)}return MN(n)}class pc extends Lw{constructor(e){super(e)}createRenderer(){return new iH(this)}}const Kc={ADDLAYER:"addlayer",REMOVELAYER:"removelayer"};class ru extends pl{constructor(e,t){super(e),this.layer=t}}const LS={LAYERS:"layers"};let Ow=class Ij extends kj{constructor(e){e=e||{};const t=Object.assign({},e);delete t.layers;let r=e.layers;super(t),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(LS.LAYERS,this.handleLayersChanged_),r?Array.isArray(r)?r=new Ma(r.slice(),{unique:!0}):Rn(typeof r.getArray=="function","Expected `layers` to be an array or a `Collection`"):r=new Ma(void 0,{unique:!0}),this.setLayers(r)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(or),this.layersListenerKeys_.length=0;const e=this.getLayers();this.layersListenerKeys_.push(pn(e,Ls.ADD,this.handleLayersAdd_,this),pn(e,Ls.REMOVE,this.handleLayersRemove_,this));for(const r in this.listenerKeys_)this.listenerKeys_[r].forEach(or);ig(this.listenerKeys_);const t=e.getArray();for(let r=0,i=t.length;r<i;r++){const s=t[r];this.registerLayerListeners_(s),this.dispatchEvent(new ru(Kc.ADDLAYER,s))}this.changed()}registerLayerListeners_(e){const t=[pn(e,C0.PROPERTYCHANGE,this.handleLayerChange_,this),pn(e,en.CHANGE,this.handleLayerChange_,this)];e instanceof Ij&&t.push(pn(e,Kc.ADDLAYER,this.handleLayerGroupAdd_,this),pn(e,Kc.REMOVELAYER,this.handleLayerGroupRemove_,this)),this.listenerKeys_[Kt(e)]=t}handleLayerGroupAdd_(e){this.dispatchEvent(new ru(Kc.ADDLAYER,e.layer))}handleLayerGroupRemove_(e){this.dispatchEvent(new ru(Kc.REMOVELAYER,e.layer))}handleLayersAdd_(e){const t=e.element;this.registerLayerListeners_(t),this.dispatchEvent(new ru(Kc.ADDLAYER,t)),this.changed()}handleLayersRemove_(e){const t=e.element,r=Kt(t);this.listenerKeys_[r].forEach(or),delete this.listenerKeys_[r],this.dispatchEvent(new ru(Kc.REMOVELAYER,t)),this.changed()}getLayers(){return this.get(LS.LAYERS)}setLayers(e){const t=this.getLayers();if(t){const r=t.getArray();for(let i=0,s=r.length;i<s;++i)this.dispatchEvent(new ru(Kc.REMOVELAYER,r[i]))}this.set(LS.LAYERS,e)}getLayersArray(e){return e=e!==void 0?e:[],this.getLayers().forEach(function(t){t.getLayersArray(e)}),e}getLayerStatesArray(e){const t=e!==void 0?e:[],r=t.length;this.getLayers().forEach(function(a){a.getLayerStatesArray(t)});const i=this.getLayerState();let s=i.zIndex;!e&&i.zIndex===void 0&&(s=0);for(let a=r,o=t.length;a<o;a++){const l=t[a];l.opacity*=i.opacity,l.visible=l.visible&&i.visible,l.maxResolution=Math.min(l.maxResolution,i.maxResolution),l.minResolution=Math.max(l.minResolution,i.minResolution),l.minZoom=Math.max(l.minZoom,i.minZoom),l.maxZoom=Math.min(l.maxZoom,i.maxZoom),i.extent!==void 0&&(l.extent!==void 0?l.extent=ql(l.extent,i.extent):l.extent=i.extent),l.zIndex===void 0&&(l.zIndex=s)}return t}getSourceState(){return"ready"}};const Bt={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function Cj(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function yT(n,e){return n[0]=e[0],n[1]=e[1],n[4]=e[2],n[5]=e[3],n[12]=e[4],n[13]=e[5],n}const H_=34962,IA=34963,tK=35044,OS=35048,nK=5121,rK=5123,iK=5125,Pj=5126,GN=["experimental-webgl","webgl","webkit-3d","moz-webgl"];function sK(n,e){e=Object.assign({preserveDrawingBuffer:!0,antialias:!z$},e);const t=GN.length;for(let r=0;r<t;++r)try{const i=n.getContext(GN[r],e);if(i)return i}catch{}return null}const aK={STATIC_DRAW:tK};class DS{constructor(e,t){this.array_=null,this.type_=e,Rn(e===H_||e===IA,"A `WebGLArrayBuffer` must either be of type `ELEMENT_ARRAY_BUFFER` or `ARRAY_BUFFER`"),this.usage_=t!==void 0?t:aK.STATIC_DRAW}ofSize(e){return this.array_=new(Ex(this.type_))(e),this}fromArray(e){return this.array_=Ex(this.type_).from(e),this}fromArrayBuffer(e){return this.array_=new(Ex(this.type_))(e),this}getType(){return this.type_}getArray(){return this.array_}setArray(e){const t=Ex(this.type_);if(!(e instanceof t))throw new Error(`Expected ${t}`);this.array_=e}getUsage(){return this.usage_}getSize(){return this.array_?this.array_.length:0}}function Ex(n){switch(n){case H_:return Float32Array;case IA:return Uint32Array;default:return Float32Array}}const Sx={LOST:"webglcontextlost",RESTORED:"webglcontextrestored"},oK=`
  precision mediump float;

  attribute vec2 a_position;
  varying vec2 v_texCoord;
  varying vec2 v_screenCoord;

  uniform vec2 u_screenSize;

  void main() {
    v_texCoord = a_position * 0.5 + 0.5;
    v_screenCoord = v_texCoord * u_screenSize;
    gl_Position = vec4(a_position, 0.0, 1.0);
  }
`,lK=`
  precision mediump float;

  uniform sampler2D u_image;
  uniform float u_opacity;

  varying vec2 v_texCoord;

  void main() {
    gl_FragColor = texture2D(u_image, v_texCoord) * u_opacity;
  }
`;class zN{constructor(e){this.gl_=e.webGlContext;const t=this.gl_;this.scaleRatio_=e.scaleRatio||1,this.renderTargetTexture_=t.createTexture(),this.renderTargetTextureSize_=null,this.frameBuffer_=t.createFramebuffer(),this.depthBuffer_=t.createRenderbuffer();const r=t.createShader(t.VERTEX_SHADER);t.shaderSource(r,e.vertexShader||oK),t.compileShader(r);const i=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(i,e.fragmentShader||lK),t.compileShader(i),this.renderTargetProgram_=t.createProgram(),t.attachShader(this.renderTargetProgram_,r),t.attachShader(this.renderTargetProgram_,i),t.linkProgram(this.renderTargetProgram_),this.renderTargetVerticesBuffer_=t.createBuffer();const s=[-1,-1,1,-1,-1,1,1,-1,1,1,-1,1];t.bindBuffer(t.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),t.bufferData(t.ARRAY_BUFFER,new Float32Array(s),t.STATIC_DRAW),this.renderTargetAttribLocation_=t.getAttribLocation(this.renderTargetProgram_,"a_position"),this.renderTargetUniformLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_screenSize"),this.renderTargetOpacityLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_opacity"),this.renderTargetTextureLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_image"),this.uniforms_=[],e.uniforms&&Object.keys(e.uniforms).forEach(a=>{this.uniforms_.push({value:e.uniforms[a],location:t.getUniformLocation(this.renderTargetProgram_,a)})})}getRenderTargetTexture(){return this.renderTargetTexture_}getGL(){return this.gl_}init(e){const t=this.getGL(),r=[t.drawingBufferWidth*this.scaleRatio_,t.drawingBufferHeight*this.scaleRatio_];if(t.bindFramebuffer(t.FRAMEBUFFER,this.getFrameBuffer()),t.bindRenderbuffer(t.RENDERBUFFER,this.getDepthBuffer()),t.viewport(0,0,r[0],r[1]),!this.renderTargetTextureSize_||this.renderTargetTextureSize_[0]!==r[0]||this.renderTargetTextureSize_[1]!==r[1]){this.renderTargetTextureSize_=r;const i=0,s=t.RGBA,a=0,o=t.RGBA,l=t.UNSIGNED_BYTE,c=null;t.bindTexture(t.TEXTURE_2D,this.renderTargetTexture_),t.texImage2D(t.TEXTURE_2D,i,s,r[0],r[1],a,o,l,c),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.renderTargetTexture_,0),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,r[0],r[1]),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,this.depthBuffer_)}}apply(e,t,r,i){const s=this.getGL(),a=e.size;if(s.bindFramebuffer(s.FRAMEBUFFER,t?t.getFrameBuffer():null),s.activeTexture(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,this.renderTargetTexture_),!t){const l=Kt(s.canvas);if(!e.renderTargets[l]){const c=s.getContextAttributes();c&&c.preserveDrawingBuffer&&(s.clearColor(0,0,0,0),s.clearDepth(1),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT)),e.renderTargets[l]=!0}}s.disable(s.DEPTH_TEST),s.enable(s.BLEND),s.blendFunc(s.ONE,s.ONE_MINUS_SRC_ALPHA),s.viewport(0,0,s.drawingBufferWidth,s.drawingBufferHeight),s.bindBuffer(s.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),s.useProgram(this.renderTargetProgram_),s.enableVertexAttribArray(this.renderTargetAttribLocation_),s.vertexAttribPointer(this.renderTargetAttribLocation_,2,s.FLOAT,!1,0,0),s.uniform2f(this.renderTargetUniformLocation_,a[0],a[1]),s.uniform1i(this.renderTargetTextureLocation_,0);const o=e.layerStatesArray[e.layerIndex].opacity;s.uniform1f(this.renderTargetOpacityLocation_,o),this.applyUniforms(e),r&&r(s,e),s.drawArrays(s.TRIANGLES,0,6),i&&i(s,e)}getFrameBuffer(){return this.frameBuffer_}getDepthBuffer(){return this.depthBuffer_}applyUniforms(e){const t=this.getGL();let r,i=1;this.uniforms_.forEach(function(s){if(r=typeof s.value=="function"?s.value(e):s.value,r instanceof HTMLCanvasElement||r instanceof ImageData)s.texture||(s.texture=t.createTexture()),t.activeTexture(t[`TEXTURE${i}`]),t.bindTexture(t.TEXTURE_2D,s.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),r instanceof ImageData?t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,r.width,r.height,0,t.UNSIGNED_BYTE,new Uint8Array(r.data)):t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,r),t.uniform1i(s.location,i++);else if(Array.isArray(r))switch(r.length){case 2:t.uniform2f(s.location,r[0],r[1]);return;case 3:t.uniform3f(s.location,r[0],r[1],r[2]);return;case 4:t.uniform4f(s.location,r[0],r[1],r[2],r[3]);return;default:return}else typeof r=="number"&&t.uniform1f(s.location,r)})}}const Vl={PROJECTION_MATRIX:"u_projectionMatrix",SCREEN_TO_WORLD_MATRIX:"u_screenToWorldMatrix",TIME:"u_time",ZOOM:"u_zoom",RESOLUTION:"u_resolution",ROTATION:"u_rotation",VIEWPORT_SIZE_PX:"u_viewportSizePx",PIXEL_RATIO:"u_pixelRatio",HIT_DETECTION:"u_hitDetection"},Fi={UNSIGNED_BYTE:nK,UNSIGNED_SHORT:rK,UNSIGNED_INT:iK,FLOAT:Pj},K_={};function UN(n){return"shared/"+n}let $N=0;function cK(){const n="unique/"+$N;return $N+=1,n}function uK(n){let e=K_[n];if(!e){const t=document.createElement("canvas");t.width=1,t.height=1,t.style.position="absolute",t.style.left="0",e={users:0,context:sK(t)},K_[n]=e}return e.users+=1,e.context}function hK(n){const e=K_[n];if(!e||(e.users-=1,e.users>0))return;const t=e.context,r=t.getExtension("WEBGL_lose_context");r&&r.loseContext();const i=t.canvas;i.width=1,i.height=1,delete K_[n]}class dK extends g1{constructor(e){super(),e=e||{},this.boundHandleWebGLContextLost_=this.handleWebGLContextLost.bind(this),this.boundHandleWebGLContextRestored_=this.handleWebGLContextRestored.bind(this),this.canvasCacheKey_=e.canvasCacheKey?UN(e.canvasCacheKey):cK(),this.gl_=uK(this.canvasCacheKey_),this.bufferCache_={},this.extensionCache_={},this.currentProgram_=null,this.needsToBeRecreated_=!1;const t=this.gl_.canvas;t.addEventListener(Sx.LOST,this.boundHandleWebGLContextLost_),t.addEventListener(Sx.RESTORED,this.boundHandleWebGLContextRestored_),this.offsetRotateMatrix_=gi(),this.offsetScaleMatrix_=gi(),this.tmpMat4_=Cj(),this.uniformLocationsByProgram_={},this.attribLocationsByProgram_={},this.uniforms_=[],e.uniforms&&this.setUniforms(e.uniforms),this.postProcessPasses_=e.postProcesses?e.postProcesses.map(r=>new zN({webGlContext:this.gl_,scaleRatio:r.scaleRatio,vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,uniforms:r.uniforms})):[new zN({webGlContext:this.gl_})],this.shaderCompileErrors_=null,this.startTime_=Date.now(),this.maxAttributeCount_=this.gl_.getParameter(this.gl_.MAX_VERTEX_ATTRIBS)}setUniforms(e){this.uniforms_=[],this.addUniforms(e)}addUniforms(e){for(const t in e)this.uniforms_.push({name:t,value:e[t]})}canvasCacheKeyMatches(e){return this.canvasCacheKey_===UN(e)}getExtension(e){if(e in this.extensionCache_)return this.extensionCache_[e];const t=this.gl_.getExtension(e);return this.extensionCache_[e]=t,t}getInstancedRenderingExtension_(){const e=this.getExtension("ANGLE_instanced_arrays");return Rn(!!e,"WebGL extension 'ANGLE_instanced_arrays' is required for vector rendering"),e}bindBuffer(e){const t=this.gl_,r=Kt(e);let i=this.bufferCache_[r];if(!i){const s=t.createBuffer();i={buffer:e,webGlBuffer:s},this.bufferCache_[r]=i}t.bindBuffer(e.getType(),i.webGlBuffer)}flushBufferData(e){const t=this.gl_;this.bindBuffer(e),t.bufferData(e.getType(),e.getArray(),e.getUsage())}deleteBuffer(e){const t=Kt(e);delete this.bufferCache_[t]}disposeInternal(){const e=this.gl_.canvas;e.removeEventListener(Sx.LOST,this.boundHandleWebGLContextLost_),e.removeEventListener(Sx.RESTORED,this.boundHandleWebGLContextRestored_),hK(this.canvasCacheKey_),delete this.gl_}prepareDraw(e,t,r){const i=this.gl_,s=this.getCanvas(),a=e.size,o=e.pixelRatio;(s.width!==a[0]*o||s.height!==a[1]*o)&&(s.width=a[0]*o,s.height=a[1]*o,s.style.width=a[0]+"px",s.style.height=a[1]+"px");for(let l=this.postProcessPasses_.length-1;l>=0;l--)this.postProcessPasses_[l].init(e);i.bindTexture(i.TEXTURE_2D,null),i.clearColor(0,0,0,0),i.depthRange(0,1),i.clearDepth(1),i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT),i.enable(i.BLEND),i.blendFunc(i.ONE,t?i.ZERO:i.ONE_MINUS_SRC_ALPHA),r?(i.enable(i.DEPTH_TEST),i.depthFunc(i.LEQUAL)):i.disable(i.DEPTH_TEST)}bindFrameBuffer(e,t){const r=this.getGL();r.bindFramebuffer(r.FRAMEBUFFER,e),t&&r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,t,0)}bindInitialFrameBuffer(){const e=this.getGL(),t=this.postProcessPasses_[0].getFrameBuffer();e.bindFramebuffer(e.FRAMEBUFFER,t);const r=this.postProcessPasses_[0].getRenderTargetTexture();e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0)}bindTexture(e,t,r){const i=this.gl_;i.activeTexture(i.TEXTURE0+t),i.bindTexture(i.TEXTURE_2D,e),i.uniform1i(this.getUniformLocation(r),t)}bindAttribute(e,t,r){const i=this.getGL();this.bindBuffer(e);const s=this.getAttributeLocation(t);i.enableVertexAttribArray(s),i.vertexAttribPointer(s,r,i.FLOAT,!1,0,0)}prepareDrawToRenderTarget(e,t,r,i){const s=this.gl_,a=t.getSize();s.bindFramebuffer(s.FRAMEBUFFER,t.getFramebuffer()),s.bindRenderbuffer(s.RENDERBUFFER,t.getDepthbuffer()),s.viewport(0,0,a[0],a[1]),s.bindTexture(s.TEXTURE_2D,t.getTexture()),s.clearColor(0,0,0,0),s.depthRange(0,1),s.clearDepth(1),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),s.enable(s.BLEND),s.blendFunc(s.ONE,r?s.ZERO:s.ONE_MINUS_SRC_ALPHA),i?(s.enable(s.DEPTH_TEST),s.depthFunc(s.LEQUAL)):s.disable(s.DEPTH_TEST)}drawElements(e,t){const r=this.gl_;this.getExtension("OES_element_index_uint");const i=r.UNSIGNED_INT,s=4,a=t-e,o=e*s;r.drawElements(r.TRIANGLES,a,i,o)}drawElementsInstanced(e,t,r){const i=this.gl_;this.getExtension("OES_element_index_uint");const s=this.getInstancedRenderingExtension_(),a=i.UNSIGNED_INT,o=4,l=t-e,c=e*o;s.drawElementsInstancedANGLE(i.TRIANGLES,l,a,c,r);for(let h=0;h<this.maxAttributeCount_;h++)s.vertexAttribDivisorANGLE(h,0)}finalizeDraw(e,t,r){for(let i=0,s=this.postProcessPasses_.length;i<s;i++)i===s-1?this.postProcessPasses_[i].apply(e,null,t,r):this.postProcessPasses_[i].apply(e,this.postProcessPasses_[i+1])}getCanvas(){return this.gl_.canvas}getGL(){return this.gl_}applyFrameState(e){const t=e.size,r=e.viewState.rotation,i=e.pixelRatio;this.setUniformFloatValue(Vl.TIME,(Date.now()-this.startTime_)*.001),this.setUniformFloatValue(Vl.ZOOM,e.viewState.zoom),this.setUniformFloatValue(Vl.RESOLUTION,e.viewState.resolution),this.setUniformFloatValue(Vl.PIXEL_RATIO,i),this.setUniformFloatVec2(Vl.VIEWPORT_SIZE_PX,[t[0],t[1]]),this.setUniformFloatValue(Vl.ROTATION,r)}applyHitDetectionUniform(e){const t=this.getUniformLocation(Vl.HIT_DETECTION);this.getGL().uniform1i(t,e?1:0),e&&this.setUniformFloatValue(Vl.PIXEL_RATIO,.5)}applyUniforms(e){const t=this.gl_;let r,i=0;this.uniforms_.forEach(s=>{if(r=typeof s.value=="function"?s.value(e):s.value,r instanceof HTMLCanvasElement||r instanceof HTMLImageElement||r instanceof ImageData||r instanceof WebGLTexture){r instanceof WebGLTexture&&!s.texture?(s.prevValue=void 0,s.texture=r):s.texture||(s.prevValue=void 0,s.texture=t.createTexture()),this.bindTexture(s.texture,i,s.name),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE);const a=!(r instanceof HTMLImageElement)||r.complete;!(r instanceof WebGLTexture)&&a&&s.prevValue!==r&&(s.prevValue=r,t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,r)),i++}else if(Array.isArray(r)&&r.length===6)this.setUniformMatrixValue(s.name,yT(this.tmpMat4_,r));else if(Array.isArray(r)&&r.length<=4)switch(r.length){case 2:t.uniform2f(this.getUniformLocation(s.name),r[0],r[1]);return;case 3:t.uniform3f(this.getUniformLocation(s.name),r[0],r[1],r[2]);return;case 4:t.uniform4f(this.getUniformLocation(s.name),r[0],r[1],r[2],r[3]);return;default:return}else typeof r=="number"&&t.uniform1f(this.getUniformLocation(s.name),r)})}useProgram(e,t){this.disableAllAttributes_(),this.gl_.useProgram(e),this.currentProgram_=e,t&&(this.applyFrameState(t),this.applyUniforms(t))}compileShader(e,t){const r=this.gl_,i=r.createShader(t);return r.shaderSource(i,e),r.compileShader(i),i}getProgram(e,t){const r=this.gl_,i=this.compileShader(e,r.FRAGMENT_SHADER),s=this.compileShader(t,r.VERTEX_SHADER),a=r.createProgram();if(r.attachShader(a,i),r.attachShader(a,s),r.linkProgram(a),!r.getShaderParameter(i,r.COMPILE_STATUS)){const o=`Fragment shader compilation failed: ${r.getShaderInfoLog(i)}`;throw new Error(o)}if(r.deleteShader(i),!r.getShaderParameter(s,r.COMPILE_STATUS)){const o=`Vertex shader compilation failed: ${r.getShaderInfoLog(s)}`;throw new Error(o)}if(r.deleteShader(s),!r.getProgramParameter(a,r.LINK_STATUS)){const o=`GL program linking failed: ${r.getProgramInfoLog(a)}`;throw new Error(o)}return a}getUniformLocation(e){const t=Kt(this.currentProgram_);return this.uniformLocationsByProgram_[t]===void 0&&(this.uniformLocationsByProgram_[t]={}),this.uniformLocationsByProgram_[t][e]===void 0&&(this.uniformLocationsByProgram_[t][e]=this.gl_.getUniformLocation(this.currentProgram_,e)),this.uniformLocationsByProgram_[t][e]}getAttributeLocation(e){const t=Kt(this.currentProgram_);return this.attribLocationsByProgram_[t]===void 0&&(this.attribLocationsByProgram_[t]={}),this.attribLocationsByProgram_[t][e]===void 0&&(this.attribLocationsByProgram_[t][e]=this.gl_.getAttribLocation(this.currentProgram_,e)),this.attribLocationsByProgram_[t][e]}makeProjectionTransform(e,t){const r=e.size,i=e.viewState.rotation,s=e.viewState.resolution,a=e.viewState.center;return Ga(t,0,0,2/(s*r[0]),2/(s*r[1]),-i,-a[0],-a[1]),t}setUniformFloatValue(e,t){this.gl_.uniform1f(this.getUniformLocation(e),t)}setUniformFloatVec2(e,t){this.gl_.uniform2fv(this.getUniformLocation(e),t)}setUniformFloatVec4(e,t){this.gl_.uniform4fv(this.getUniformLocation(e),t)}setUniformMatrixValue(e,t){this.gl_.uniformMatrix4fv(this.getUniformLocation(e),!1,t)}disableAllAttributes_(){for(let e=0;e<this.maxAttributeCount_;e++)this.gl_.disableVertexAttribArray(e)}enableAttributeArray_(e,t,r,i,s,a){const o=this.getAttributeLocation(e);o<0||(this.gl_.enableVertexAttribArray(o),this.gl_.vertexAttribPointer(o,t,r,!1,i,s),a&&this.getInstancedRenderingExtension_().vertexAttribDivisorANGLE(o,1))}enableAttributes_(e,t){const r=fK(e);let i=0;for(let s=0;s<e.length;s++){const a=e[s];a.name&&this.enableAttributeArray_(a.name,a.size,a.type||Pj,r,i,t),i+=a.size*Nj(a.type)}}enableAttributes(e){this.enableAttributes_(e,!1)}enableAttributesInstanced(e){this.enableAttributes_(e,!0)}handleWebGLContextLost(e){ig(this.bufferCache_),this.currentProgram_=null,e.preventDefault()}handleWebGLContextRestored(){this.needsToBeRecreated_=!0}needsToBeRecreated(){return this.needsToBeRecreated_}createTexture(e,t,r,i){const s=this.gl_;r=r||s.createTexture();const a=i?s.NEAREST:s.LINEAR;s.bindTexture(s.TEXTURE_2D,r),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,a),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,a),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE);const o=0,l=s.RGBA,c=0,h=s.RGBA,g=s.UNSIGNED_BYTE;return t instanceof Uint8Array?s.texImage2D(s.TEXTURE_2D,o,l,e[0],e[1],c,h,g,t):t?s.texImage2D(s.TEXTURE_2D,o,l,h,g,t):s.texImage2D(s.TEXTURE_2D,o,l,e[0],e[1],c,h,g,null),r}}function fK(n){let e=0;for(let t=0;t<n.length;t++){const r=n[t];e+=r.size*Nj(r.type)}return e}function Nj(n){switch(n){case Fi.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case Fi.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case Fi.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case Fi.FLOAT:default:return Float32Array.BYTES_PER_ELEMENT}}class CA extends m1{constructor(e,t,r){super(),r=r||{},this.tileCoord=e,this.state=t,this.key="",this.transition_=r.transition===void 0?250:r.transition,this.transitionStarts_={},this.interpolate=!!r.interpolate}changed(){this.dispatchEvent(en.CHANGE)}release(){this.setState(Bt.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(e){if(this.state!==Bt.EMPTY){if(this.state!==Bt.ERROR&&this.state>e)throw new Error("Tile load sequence violation");this.state=e,this.changed()}}load(){Xt()}getAlpha(e,t){if(!this.transition_)return 1;let r=this.transitionStarts_[e];if(!r)r=t,this.transitionStarts_[e]=r;else if(r===-1)return 1;const i=t-r+1e3/60;return i>=this.transition_?1:Aj(i/this.transition_)}inTransition(e){return this.transition_?this.transitionStarts_[e]!==-1:!1}endTransition(e){this.transition_&&(this.transitionStarts_[e]=-1)}disposeInternal(){this.release(),super.disposeInternal()}}function xT(n){return n instanceof Image||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageBitmap?n:null}const gK=new Error("disposed"),mK=[256,256];class WN extends CA{constructor(e){const t=Bt.IDLE;super(e.tileCoord,t,{transition:e.transition,interpolate:e.interpolate}),this.loader_=e.loader,this.data_=null,this.error_=null,this.size_=e.size||null,this.controller_=e.controller||null}getSize(){if(this.size_)return this.size_;const e=xT(this.data_);return e?[e.width,e.height]:mK}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==Bt.IDLE&&this.state!==Bt.ERROR)return;this.state=Bt.LOADING,this.changed();const e=this;this.loader_().then(function(t){e.data_=t,e.state=Bt.LOADED,e.changed()}).catch(function(t){e.error_=t,e.state=Bt.ERROR,e.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(gK),this.controller_=null),super.disposeInternal()}}class Mj extends CA{constructor(e,t,r,i,s,a){super(e,t,a),this.crossOrigin_=i,this.src_=r,this.key=r,this.image_,ua?this.image_=new OffscreenCanvas(1,1):(this.image_=new Image,i!==null&&(this.image_.crossOrigin=i)),this.unlisten_=null,this.tileLoadFunction_=s}getImage(){return this.image_}setImage(e){this.image_=e,this.state=Bt.LOADED,this.unlistenImage_(),this.changed()}getCrossOrigin(){return this.crossOrigin_}handleImageError_(){this.state=Bt.ERROR,this.unlistenImage_(),this.image_=pK(),this.changed()}handleImageLoad_(){if(ua)this.state=Bt.LOADED;else{const e=this.image_;e.naturalWidth&&e.naturalHeight?this.state=Bt.LOADED:this.state=Bt.EMPTY}this.unlistenImage_(),this.changed()}load(){this.state==Bt.ERROR&&(this.state=Bt.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==Bt.IDLE&&(this.state=Bt.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=nW(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}}function pK(){const n=ri(1,1);return n.fillStyle="rgba(0,0,0,0)",n.fillRect(0,0,1,1),n.canvas}let jS;const m0=[];function HN(n,e,t,r,i){n.beginPath(),n.moveTo(0,0),n.lineTo(e,t),n.lineTo(r,i),n.closePath(),n.save(),n.clip(),n.fillRect(0,0,Math.max(e,r)+1,Math.max(t,i)),n.restore()}function FS(n,e){return Math.abs(n[e*4]-210)>2||Math.abs(n[e*4+3]-.75*255)>2}function yK(){if(jS===void 0){const n=ri(6,6,m0);n.globalCompositeOperation="lighter",n.fillStyle="rgba(210, 0, 0, 0.75)",HN(n,4,5,4,0),HN(n,4,5,0,5);const e=n.getImageData(0,0,3,3).data;jS=FS(e,0)||FS(e,4)||FS(e,8),Iw(n),m0.push(n.canvas)}return jS}function X_(n,e,t,r){const i=ag(t,e,n);let s=j_(e,r,t);const a=e.getMetersPerUnit();a!==void 0&&(s*=a);const o=n.getMetersPerUnit();o!==void 0&&(s/=o);const l=n.getExtent();if(!l||sd(l,i)){const c=j_(n,s,i)/s;isFinite(c)&&c>0&&(s/=c)}return s}function xK(n,e,t,r){const i=Eo(t);let s=X_(n,e,i,r);return(!isFinite(s)||s<=0)&&wD(t,function(a){return s=X_(n,e,a,r),isFinite(s)&&s>0}),s}function Lj(n,e,t,r,i,s,a,o,l,c,h,g,m,y){const _=ri(Math.round(t*n),Math.round(t*e),m0);if(g||(_.imageSmoothingEnabled=!1),l.length===0)return _.canvas;_.scale(t,t);function x(O){return Math.round(O*t)/t}_.globalCompositeOperation="lighter";const w=zs();l.forEach(function(O,B,R){_D(w,O.extent)});let b;const T=t/r,k=(g?1:1+Math.pow(2,-24))/T;(!m||l.length!==1||c!==0)&&(b=ri(Math.round(yn(w)*T),Math.round(ti(w)*T),m0),g||(b.imageSmoothingEnabled=!1),l.forEach(function(O,B,R){if(O.image.width>0&&O.image.height>0){if(O.clipExtent){b.save();const G=(O.clipExtent[0]-w[0])*T,j=-(O.clipExtent[3]-w[3])*T,ve=yn(O.clipExtent)*T,ce=ti(O.clipExtent)*T;b.rect(g?G:Math.round(G),g?j:Math.round(j),g?ve:Math.round(G+ve)-Math.round(G),g?ce:Math.round(j+ce)-Math.round(j)),b.clip()}const A=(O.extent[0]-w[0])*T,P=-(O.extent[3]-w[3])*T,D=yn(O.extent)*T,N=ti(O.extent)*T;b.drawImage(O.image,c,c,O.image.width-2*c,O.image.height-2*c,g?A:Math.round(A),g?P:Math.round(P),g?D:Math.round(A+D)-Math.round(A),g?N:Math.round(P+N)-Math.round(P)),O.clipExtent&&b.restore()}}));const L=Id(a);return o.getTriangles().forEach(function(O,B,R){const A=O.source,P=O.target;let D=A[0][0],N=A[0][1],G=A[1][0],j=A[1][1],ve=A[2][0],ce=A[2][1];const je=x((P[0][0]-L[0])/s),Pe=x(-(P[0][1]-L[1])/s),ue=x((P[1][0]-L[0])/s),Ne=x(-(P[1][1]-L[1])/s),be=x((P[2][0]-L[0])/s),ie=x(-(P[2][1]-L[1])/s),V=D,J=N;D=0,N=0,G-=V,j-=J,ve-=V,ce-=J;const te=[[G,j,0,0,ue-je],[ve,ce,0,0,be-je],[0,0,G,j,Ne-Pe],[0,0,ve,ce,ie-Pe]],re=UU(te);if(!re)return;if(_.save(),_.beginPath(),yK()||!g){_.moveTo(ue,Ne);const Be=4,Ge=je-ue,ye=Pe-Ne;for(let pe=0;pe<Be;pe++)_.lineTo(ue+x((pe+1)*Ge/Be),Ne+x(pe*ye/(Be-1))),pe!=Be-1&&_.lineTo(ue+x((pe+1)*Ge/Be),Ne+x((pe+1)*ye/(Be-1)));_.lineTo(be,ie)}else _.moveTo(ue,Ne),_.lineTo(je,Pe),_.lineTo(be,ie);_.clip(),_.transform(re[0],re[2],re[1],re[3],je,Pe),_.translate(w[0]-V,w[3]-J);let he;if(b)he=b.canvas,_.scale(k,-k);else{const Be=l[0],Ge=Be.extent;he=Be.image,_.scale(yn(Ge)/he.width,-ti(Ge)/he.height)}_.drawImage(he,0,0),_.restore()}),b&&(Iw(b),m0.push(b.canvas)),h&&(_.save(),_.globalCompositeOperation="source-over",_.strokeStyle="black",_.lineWidth=1,o.getTriangles().forEach(function(O,B,R){const A=O.target,P=(A[0][0]-L[0])/s,D=-(A[0][1]-L[1])/s,N=(A[1][0]-L[0])/s,G=-(A[1][1]-L[1])/s,j=(A[2][0]-L[0])/s,ve=-(A[2][1]-L[1])/s;_.beginPath(),_.moveTo(N,G),_.lineTo(P,D),_.lineTo(j,ve),_.closePath(),_.stroke()}),_.restore()),_.canvas}const _K=10,KN=.25;class Oj{constructor(e,t,r,i,s,a,o){this.sourceProj_=e,this.targetProj_=t;let l={};const c=o?aT(k=>Fr(o,ag(k,this.targetProj_,this.sourceProj_))):vp(this.targetProj_,this.sourceProj_);this.transformInv_=function(k){const L=k[0]+"/"+k[1];return l[L]||(l[L]=c(k)),l[L]},this.maxSourceExtent_=i,this.errorThresholdSquared_=s*s,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!i&&!!this.sourceProj_.getExtent()&&yn(i)>=yn(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?yn(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?yn(this.targetProj_.getExtent()):null;const h=Id(r),g=Ew(r),m=ww(r),y=vw(r),_=this.transformInv_(h),x=this.transformInv_(g),w=this.transformInv_(m),b=this.transformInv_(y),T=_K+(a?Math.max(0,Math.ceil(Math.log2(tT(r)/(a*a*256*256)))):0);if(this.addQuad_(h,g,m,y,_,x,w,b,T),this.wrapsXInSource_){let k=1/0;this.triangles_.forEach(function(L,O,B){k=Math.min(k,L.source[0][0],L.source[1][0],L.source[2][0])}),this.triangles_.forEach(L=>{if(Math.max(L.source[0][0],L.source[1][0],L.source[2][0])-k>this.sourceWorldWidth_/2){const O=[[L.source[0][0],L.source[0][1]],[L.source[1][0],L.source[1][1]],[L.source[2][0],L.source[2][1]]];O[0][0]-k>this.sourceWorldWidth_/2&&(O[0][0]-=this.sourceWorldWidth_),O[1][0]-k>this.sourceWorldWidth_/2&&(O[1][0]-=this.sourceWorldWidth_),O[2][0]-k>this.sourceWorldWidth_/2&&(O[2][0]-=this.sourceWorldWidth_);const B=Math.min(O[0][0],O[1][0],O[2][0]);Math.max(O[0][0],O[1][0],O[2][0])-B<this.sourceWorldWidth_/2&&(L.source=O)}})}l={}}addTriangle_(e,t,r,i,s,a){this.triangles_.push({source:[i,s,a],target:[e,t,r]})}addQuad_(e,t,r,i,s,a,o,l,c){const h=X4([s,a,o,l]),g=this.sourceWorldWidth_?yn(h)/this.sourceWorldWidth_:null,m=this.sourceWorldWidth_,y=this.sourceProj_.canWrapX()&&g>.5&&g<1;let _=!1;if(c>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const w=X4([e,t,r,i]);_=yn(w)/this.targetWorldWidth_>KN||_}!y&&this.sourceProj_.isGlobal()&&g&&(_=g>KN||_)}if(!_&&this.maxSourceExtent_&&isFinite(h[0])&&isFinite(h[1])&&isFinite(h[2])&&isFinite(h[3])&&!vs(h,this.maxSourceExtent_))return;let x=0;if(!_&&(!isFinite(s[0])||!isFinite(s[1])||!isFinite(a[0])||!isFinite(a[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(l[0])||!isFinite(l[1]))){if(c>0)_=!0;else if(x=(!isFinite(s[0])||!isFinite(s[1])?8:0)+(!isFinite(a[0])||!isFinite(a[1])?4:0)+(!isFinite(o[0])||!isFinite(o[1])?2:0)+(!isFinite(l[0])||!isFinite(l[1])?1:0),x!=1&&x!=2&&x!=4&&x!=8)return}if(c>0){if(!_){const w=[(e[0]+r[0])/2,(e[1]+r[1])/2],b=this.transformInv_(w);let T;y?T=(Eu(s[0],m)+Eu(o[0],m))/2-Eu(b[0],m):T=(s[0]+o[0])/2-b[0];const k=(s[1]+o[1])/2-b[1];_=T*T+k*k>this.errorThresholdSquared_}if(_){if(Math.abs(e[0]-r[0])<=Math.abs(e[1]-r[1])){const w=[(t[0]+r[0])/2,(t[1]+r[1])/2],b=this.transformInv_(w),T=[(i[0]+e[0])/2,(i[1]+e[1])/2],k=this.transformInv_(T);this.addQuad_(e,t,w,T,s,a,b,k,c-1),this.addQuad_(T,w,r,i,k,b,o,l,c-1)}else{const w=[(e[0]+t[0])/2,(e[1]+t[1])/2],b=this.transformInv_(w),T=[(r[0]+i[0])/2,(r[1]+i[1])/2],k=this.transformInv_(T);this.addQuad_(e,w,T,i,s,b,k,l,c-1),this.addQuad_(w,t,r,T,b,a,o,k,c-1)}return}}if(y){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(x&11)==0&&this.addTriangle_(e,r,i,s,o,l),(x&14)==0&&this.addTriangle_(e,r,t,s,o,a),x&&((x&13)==0&&this.addTriangle_(t,i,e,a,l,s),(x&7)==0&&this.addTriangle_(t,i,r,a,l,o))}calculateSourceExtent(){const e=zs();return this.triangles_.forEach(function(t,r,i){const s=t.source;Fm(e,s[0]),Fm(e,s[1]),Fm(e,s[2])}),e}getTriangles(){return this.triangles_}}const Dj=.5;class jj extends CA{constructor(e,t,r,i,s,a,o,l,c,h,g,m){super(s,Bt.IDLE,m),this.renderEdges_=g!==void 0?g:!1,this.pixelRatio_=o,this.gutter_=l,this.canvas_=null,this.sourceTileGrid_=t,this.targetTileGrid_=i,this.wrappedTileCoord_=a||s,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=e.canWrapX()?e.getExtent():void 0;const y=i.getTileCoordExtent(this.wrappedTileCoord_),_=this.targetTileGrid_.getExtent();let x=this.sourceTileGrid_.getExtent();const w=_?ql(y,_):y;if(tT(w)===0){this.state=Bt.EMPTY;return}const b=e.getExtent();b&&(x?x=ql(x,b):x=b);const T=i.getResolution(this.wrappedTileCoord_[0]),k=xK(e,r,w,T);if(!isFinite(k)||k<=0){this.state=Bt.EMPTY;return}const L=h!==void 0?h:Dj;if(this.triangulation_=new Oj(e,r,w,x,k*L,T),this.triangulation_.getTriangles().length===0){this.state=Bt.EMPTY;return}this.sourceZ_=t.getZForResolution(k);let O=this.triangulation_.calculateSourceExtent();if(x&&(e.canWrapX()?(O[1]=hr(O[1],x[1],x[3]),O[3]=hr(O[3],x[1],x[3])):O=ql(O,x)),!tT(O))this.state=Bt.EMPTY;else{let B=0,R=0;e.canWrapX()&&(B=yn(b),R=Math.floor((O[0]-b[0])/B)),bD(O.slice(),e,!0).forEach(P=>{const D=t.getTileRangeForExtentAndZ(P,this.sourceZ_);for(let N=D.minX;N<=D.maxX;N++)for(let G=D.minY;G<=D.maxY;G++){const j=c(this.sourceZ_,N,G,o);if(j){const ve=R*B;this.sourceTiles_.push({tile:j,offset:ve})}}++R}),this.sourceTiles_.length===0&&(this.state=Bt.EMPTY)}}getImage(){return this.canvas_}reproject_(){const e=[];if(this.sourceTiles_.forEach(t=>{const r=t.tile;if(r&&r.getState()==Bt.LOADED){const i=this.sourceTileGrid_.getTileCoordExtent(r.tileCoord);i[0]+=t.offset,i[2]+=t.offset;const s=this.clipExtent_?.slice();s&&(s[0]+=t.offset,s[2]+=t.offset),e.push({extent:i,clipExtent:s,image:r.getImage()})}}),this.sourceTiles_.length=0,e.length===0)this.state=Bt.ERROR;else{const t=this.wrappedTileCoord_[0],r=this.targetTileGrid_.getTileSize(t),i=typeof r=="number"?r:r[0],s=typeof r=="number"?r:r[1],a=this.targetTileGrid_.getResolution(t),o=this.sourceTileGrid_.getResolution(this.sourceZ_),l=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=Lj(i,s,this.pixelRatio_,o,this.sourceTileGrid_.getExtent(),a,l,this.triangulation_,e,this.gutter_,this.renderEdges_,this.interpolate),this.state=Bt.LOADED}this.changed()}load(){if(this.state==Bt.IDLE){this.state=Bt.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:t})=>{const r=t.getState();if(r==Bt.IDLE||r==Bt.LOADING){e++;const i=pn(t,en.CHANGE,s=>{const a=t.getState();(a==Bt.LOADED||a==Bt.ERROR||a==Bt.EMPTY)&&(or(i),e--,e===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(i)}}),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:t},r,i){t.getState()==Bt.IDLE&&t.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(or),this.sourcesListenerKeys_=null}release(){this.canvas_&&(Iw(this.canvas_.getContext("2d")),m0.push(this.canvas_),this.canvas_=null),super.release()}}class PA{constructor(e,t,r,i){this.minX=e,this.maxX=t,this.minY=r,this.maxY=i}contains(e){return this.containsXY(e[1],e[2])}containsTileRange(e){return this.minX<=e.minX&&e.maxX<=this.maxX&&this.minY<=e.minY&&e.maxY<=this.maxY}containsXY(e,t){return this.minX<=e&&e<=this.maxX&&this.minY<=t&&t<=this.maxY}equals(e){return this.minX==e.minX&&this.minY==e.minY&&this.maxX==e.maxX&&this.maxY==e.maxY}extend(e){e.minX<this.minX&&(this.minX=e.minX),e.maxX>this.maxX&&(this.maxX=e.maxX),e.minY<this.minY&&(this.minY=e.minY),e.maxY>this.maxY&&(this.maxY=e.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(e){return this.minX<=e.maxX&&this.maxX>=e.minX&&this.minY<=e.maxY&&this.maxY>=e.minY}}function Af(n,e,t,r,i){return i!==void 0?(i.minX=n,i.maxX=e,i.minY=t,i.maxY=r,i):new PA(n,e,t,r)}class XN{constructor(e){this.highWaterMark=e!==void 0?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}deleteOldest(){const e=this.pop();e instanceof g1&&e.dispose()}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(e){for(;this.canExpireCache();)this.deleteOldest()}clear(){for(;this.oldest_;)this.deleteOldest()}containsKey(e){return this.entries_.hasOwnProperty(e)}forEach(e){let t=this.oldest_;for(;t;)e(t.value_,t.key_,this),t=t.newer}get(e,t){const r=this.entries_[e];return Rn(r!==void 0,"Tried to get a value for a key that does not exist in the cache"),r===this.newest_||(r===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(r.newer.older=r.older,r.older.newer=r.newer),r.newer=null,r.older=this.newest_,this.newest_.newer=r,this.newest_=r),r.value_}remove(e){const t=this.entries_[e];return Rn(t!==void 0,"Tried to get a value for a key that does not exist in the cache"),t===this.newest_?(this.newest_=t.older,this.newest_&&(this.newest_.newer=null)):t===this.oldest_?(this.oldest_=t.newer,this.oldest_&&(this.oldest_.older=null)):(t.newer.older=t.older,t.older.newer=t.newer),delete this.entries_[e],--this.count_,t.value_}getCount(){return this.count_}getKeys(){const e=new Array(this.count_);let t=0,r;for(r=this.newest_;r;r=r.older)e[t++]=r.key_;return e}getValues(){const e=new Array(this.count_);let t=0,r;for(r=this.newest_;r;r=r.older)e[t++]=r.value_;return e}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(e){return this.entries_[e]?.value_}pop(){const e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_}replace(e,t){this.get(e),this.entries_[e].value_=t}set(e,t){Rn(!(e in this.entries_),"Tried to set a value for a key that is used already");const r={key_:e,newer:null,older:this.newest_,value_:t};this.newest_?this.newest_.newer=r:this.oldest_=r,this.newest_=r,this.entries_[e]=r,++this.count_}setSize(e){this.highWaterMark=e}}function q_(n,e,t,r){return r!==void 0?(r[0]=n,r[1]=e,r[2]=t,r):[n,e,t]}function vK(n,e,t){return n+"/"+e+"/"+t}function r_(n,e,t,r,i){return`${Kt(n)},${e},${vK(t,r,i)}`}function Fj(n){return wK(n[0],n[1],n[2])}function wK(n,e,t){return(e<<n)+t}function EK(n,e){const t=n[0],r=n[1],i=n[2];if(e.getMinZoom()>t||t>e.getMaxZoom())return!1;const s=e.getFullTileRange(t);return s?s.containsXY(r,i):!0}class NA extends vj{constructor(e,t){super(e),t=t||{},this.inversePixelTransform_=gi(),this.postProcesses_=t.postProcesses,this.uniforms_=t.uniforms,this.helper,this.onMapChanged_=()=>{this.clearCache(),this.removeHelper()},e.addChangeListener(jn.MAP,this.onMapChanged_),this.dispatchPreComposeEvent=this.dispatchPreComposeEvent.bind(this),this.dispatchPostComposeEvent=this.dispatchPostComposeEvent.bind(this)}dispatchPreComposeEvent(e,t){const r=this.getLayer();if(r.hasListener(Si.PRECOMPOSE)){const i=new Bm(Si.PRECOMPOSE,void 0,t,e);r.dispatchEvent(i)}}dispatchPostComposeEvent(e,t){const r=this.getLayer();if(r.hasListener(Si.POSTCOMPOSE)){const i=new Bm(Si.POSTCOMPOSE,void 0,t,e);r.dispatchEvent(i)}}reset(e){this.uniforms_=e.uniforms,this.helper&&this.helper.setUniforms(this.uniforms_)}removeHelper(){this.helper&&(this.helper.dispose(),delete this.helper)}prepareFrame(e){if(this.getLayer().getRenderSource()){let t=!0,r=-1,i;for(let a=0,o=e.layerStatesArray.length;a<o;a++){const l=e.layerStatesArray[a].layer,c=l.getRenderer();if(!(c instanceof NA)){t=!0;continue}const h=l.getClassName();if((t||h!==i)&&(r+=1,t=!1),i=h,c===this)break}const s="map/"+e.mapId+"/group/"+r;(!this.helper||!this.helper.canvasCacheKeyMatches(s)||this.helper.needsToBeRecreated())&&(this.removeHelper(),this.helper=new dK({postProcesses:this.postProcesses_,uniforms:this.uniforms_,canvasCacheKey:s}),i&&(this.helper.getCanvas().className=i),this.afterHelperCreated())}return this.prepareFrameInternal(e)}afterHelperCreated(){}prepareFrameInternal(e){return!0}clearCache(){}disposeInternal(){this.clearCache(),this.removeHelper(),this.getLayer()?.removeChangeListener(jn.MAP,this.onMapChanged_),super.disposeInternal()}dispatchRenderEvent_(e,t,r){const i=this.getLayer();if(i.hasListener(e)){Ga(this.inversePixelTransform_,0,0,r.pixelRatio,-r.pixelRatio,0,0,-r.size[1]);const s=new Bm(e,this.inversePixelTransform_,r,t);i.dispatchEvent(s)}}preRender(e,t){this.dispatchRenderEvent_(Si.PRERENDER,e,t)}postRender(e,t){this.dispatchRenderEvent_(Si.POSTRENDER,e,t)}}const VS={TILE_TEXTURE_ARRAY:"u_tileTextures",TEXTURE_PIXEL_WIDTH:"u_texturePixelWidth",TEXTURE_PIXEL_HEIGHT:"u_texturePixelHeight"};class SK{constructor(e,t){this.name=e,this.data=t,this.texture_=null}getTexture(e){if(!this.texture_){const t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.data.length/4,1,0,e.RGBA,e.UNSIGNED_BYTE,this.data),this.texture_=t}return this.texture_}delete(e){this.texture_&&e.deleteTexture(this.texture_),this.texture_=null}}function bK(n,e){return`operator_${n}_${Object.keys(e.functions).length}`}function Su(n){const e=n.toString();return e.includes(".")?e:e+".0"}function MA(n){if(n.length<2||n.length>4)throw new Error("`formatArray` can only output `vec2`, `vec3` or `vec4` arrays.");return`vec${n.length}(${n.map(Su).join(", ")})`}function i_(n){const e=za(n),t=e.length>3?e[3]:1;return MA([e[0]/255,e[1]/255,e[2]/255,t])}function TK(n){const e=Es(n);return MA(e)}const BS={};let RK=0;function Cp(n){return n in BS||(BS[n]=RK++),BS[n]}function Gl(n){return Su(Cp(n))}function LA(n){return"u_var_"+n}function Vj(){return{variables:{},properties:{},functions:{},bandCount:0,featureId:!1,geometryType:!1}}const GS="getBandValue",AK="u_paletteTextures",Bj="featureId",Gj="geometryType",_T=-9999999;function kK(n,e,t,r){const i=Ai(n,e,t);return OA(i,e,r)}function Nn(n){return(e,t,r)=>{const i=t.args.length,s=new Array(i);for(let a=0;a<i;++a)s[a]=OA(t.args[a],r,e);return n(s,e)}}const IK={[me.Get]:(n,e)=>{const r=e.args[0].value;r in n.properties||(n.properties[r]={name:r,type:e.type});let s="a_prop_"+r;return Xo(e.type,ei)&&(s=`(${s} > 0.0)`),s},[me.Id]:n=>(n.featureId=!0,"a_"+Bj),[me.GeometryType]:n=>(n.geometryType=!0,"a_"+Gj),[me.LineMetric]:()=>"currentLineMetric",[me.Var]:(n,e)=>{const r=e.args[0].value;r in n.variables||(n.variables[r]={name:r,type:e.type});let s=LA(r);return Xo(e.type,ei)&&(s=`(${s} > 0.0)`),s},[me.Has]:(n,e)=>{const r=e.args[0].value;return r in n.properties||(n.properties[r]={name:r,type:e.type}),`(a_prop_${r} != ${Su(_T)})`},[me.Resolution]:()=>"u_resolution",[me.Zoom]:()=>"u_zoom",[me.Time]:()=>"u_time",[me.Any]:Nn(n=>`(${n.join(" || ")})`),[me.All]:Nn(n=>`(${n.join(" && ")})`),[me.Not]:Nn(([n])=>`(!${n})`),[me.Equal]:Nn(([n,e])=>`(${n} == ${e})`),[me.NotEqual]:Nn(([n,e])=>`(${n} != ${e})`),[me.GreaterThan]:Nn(([n,e])=>`(${n} > ${e})`),[me.GreaterThanOrEqualTo]:Nn(([n,e])=>`(${n} >= ${e})`),[me.LessThan]:Nn(([n,e])=>`(${n} < ${e})`),[me.LessThanOrEqualTo]:Nn(([n,e])=>`(${n} <= ${e})`),[me.Multiply]:Nn(n=>`(${n.join(" * ")})`),[me.Divide]:Nn(([n,e])=>`(${n} / ${e})`),[me.Add]:Nn(n=>`(${n.join(" + ")})`),[me.Subtract]:Nn(([n,e])=>`(${n} - ${e})`),[me.Clamp]:Nn(([n,e,t])=>`clamp(${n}, ${e}, ${t})`),[me.Mod]:Nn(([n,e])=>`mod(${n}, ${e})`),[me.Pow]:Nn(([n,e])=>`pow(${n}, ${e})`),[me.Abs]:Nn(([n])=>`abs(${n})`),[me.Floor]:Nn(([n])=>`floor(${n})`),[me.Ceil]:Nn(([n])=>`ceil(${n})`),[me.Round]:Nn(([n])=>`floor(${n} + 0.5)`),[me.Sin]:Nn(([n])=>`sin(${n})`),[me.Cos]:Nn(([n])=>`cos(${n})`),[me.Atan]:Nn(([n,e])=>e!==void 0?`atan(${n}, ${e})`:`atan(${n})`),[me.Sqrt]:Nn(([n])=>`sqrt(${n})`),[me.Match]:Nn(n=>{const e=n[0],t=n[n.length-1];let r=null;for(let i=n.length-3;i>=1;i-=2){const s=n[i],a=n[i+1];r=`(${e} == ${s} ? ${a} : ${r||t})`}return r}),[me.Between]:Nn(([n,e,t])=>`(${n} >= ${e} && ${n} <= ${t})`),[me.Interpolate]:Nn(([n,e,...t])=>{let r="";for(let i=0;i<t.length-2;i+=2){const s=t[i],a=r||t[i+1],o=t[i+2],l=t[i+3];let c;n===Su(1)?c=`(${e} - ${s}) / (${o} - ${s})`:c=`(pow(${n}, (${e} - ${s})) - 1.0) / (pow(${n}, (${o} - ${s})) - 1.0)`,r=`mix(${a}, ${l}, clamp(${c}, 0.0, 1.0))`}return r}),[me.Case]:Nn(n=>{const e=n[n.length-1];let t=null;for(let r=n.length-3;r>=0;r-=2){const i=n[r],s=n[r+1];t=`(${i} ? ${s} : ${t||e})`}return t}),[me.In]:Nn(([n,...e],t)=>{const r=bK("in",t),i=[];for(let s=0;s<e.length;s+=1)i.push(`  if (inputValue == ${e[s]}) { return true; }`);return t.functions[r]=`bool ${r}(float inputValue) {
${i.join(`
`)}
  return false;
}`,`${r}(${n})`}),[me.Array]:Nn(n=>`vec${n.length}(${n.join(", ")})`),[me.Color]:Nn(n=>{if(n.length===1)return`vec4(vec3(${n[0]} / 255.0), 1.0)`;if(n.length===2)return`vec4(vec3(${n[0]} / 255.0), ${n[1]})`;const e=n.slice(0,3).map(r=>`${r} / 255.0`);if(n.length===3)return`vec4(${e.join(", ")}, 1.0)`;const t=n[3];return`vec4(${e.join(", ")}, ${t})`}),[me.Band]:Nn(([n,e,t],r)=>{if(!(GS in r.functions)){let i="";const s=r.bandCount||1;for(let a=0;a<s;a++){const o=Math.floor(a/4);let l=a%4;a===s-1&&l===1&&(l=3);const c=`${VS.TILE_TEXTURE_ARRAY}[${o}]`;i+=`  if (band == ${a+1}.0) {
    return texture2D(${c}, v_textureCoord + vec2(dx, dy))[${l}];
  }
`}r.functions[GS]=`float getBandValue(float band, float xOffset, float yOffset) {
  float dx = xOffset / ${VS.TEXTURE_PIXEL_WIDTH};
  float dy = yOffset / ${VS.TEXTURE_PIXEL_HEIGHT};
${i}
}`}return`${GS}(${n}, ${e??"0.0"}, ${t??"0.0"})`}),[me.Palette]:(n,e)=>{const[t,...r]=e.args,i=r.length,s=new Uint8Array(i*4);for(let c=0;c<r.length;c++){const h=r[c].value,g=za(h),m=c*4;s[m]=g[0],s[m+1]=g[1],s[m+2]=g[2],s[m+3]=g[3]*255}n.paletteTextures||(n.paletteTextures=[]);const a=`${AK}[${n.paletteTextures.length}]`,o=new SK(a,s);n.paletteTextures.push(o);const l=OA(t,It,n);return`texture2D(${a}, vec2((${l} + 0.5) / ${i}.0, 0.5))`}};function OA(n,e,t){if(n instanceof wj){const r=IK[n.operator];if(r===void 0)throw new Error(`No compiler defined for this operator: ${JSON.stringify(n.operator)}`);return r(t,n,e)}if((n.type&It)>0)return Su(n.value);if((n.type&ei)>0)return n.value.toString();if((n.type&fi)>0)return Gl(n.value.toString());if((n.type&wr)>0)return i_(n.value);if((n.type&$s)>0)return MA(n.value);if((n.type&Oa)>0)return TK(n.value);throw new Error(`Unexpected expression ${n.value} (expected type ${t0(e)})`)}function CK(){return{"fill-color":"rgba(255,255,255,0.4)","stroke-color":"#3399CC","stroke-width":1.25,"circle-radius":5,"circle-fill-color":"rgba(255,255,255,0.4)","circle-stroke-width":1.25,"circle-stroke-color":"#3399CC"}}const qN=.985;function Jt(n,e,t){const r=wA();return kK(e,t,r,n)}function PK(n){const e=za(n),t=e[0]*256,r=e[1],i=e[2]*256,s=Math.round(e[3]*255);return[t+r,i+s]}const NK=`vec4 unpackColor(vec2 packedColor) {
  return vec4(
    min(floor(packedColor[0] / 256.0) / 255.0, 1.0),
    min(mod(packedColor[0], 256.0) / 255.0, 1.0),
    min(floor(packedColor[1] / 256.0) / 255.0, 1.0),
    min(mod(packedColor[1], 256.0) / 255.0, 1.0)
  );
}`;function DA(n){return n===wr||n===Oa?2:n===$s?4:1}function vT(n){const e=DA(n);return e>1?`vec${e}`:"float"}function zj(n,e){for(const t in e.variables){const r=e.variables[t],i=LA(r.name);let s=vT(r.type);r.type===wr&&(s="vec4"),n.addUniform(i,s)}for(const t in e.properties){const r=e.properties[t],i=vT(r.type),s=`a_prop_${r.name}`;r.type===wr?n.addAttribute(s,i,`unpackColor(${s})`,"vec4"):n.addAttribute(s,i)}for(const t in e.functions)n.addVertexShaderFunction(e.functions[t]),n.addFragmentShaderFunction(e.functions[t])}function Uj(n,e){const t={};for(const r in n.variables){const i=n.variables[r],s=LA(i.name);t[s]=()=>{const a=e[i.name];if(typeof a=="number")return a;if(typeof a=="boolean")return a?1:0;if(i.type===wr){const o=[...za(a||"#eee")];return o[0]/=255,o[1]/=255,o[2]/=255,o[3]??=1,o}return typeof a=="string"?Cp(a):a}}return t}function $j(n){const e={};for(const t in n.properties){const r=n.properties[t],i=s=>{const a=s.get(r.name);return r.type===wr?PK([...za(a||"#eee")]):typeof a=="string"?Cp(a):typeof a=="boolean"?a?1:0:a};e[`prop_${r.name}`]={size:DA(r.type),callback:i}}return e}const kf=`#ifdef GL_FRAGMENT_PRECISION_HIGH
precision highp float;
#else
precision mediump float;
#endif
uniform mat4 u_projectionMatrix;
uniform mat4 u_screenToWorldMatrix;
uniform vec2 u_viewportSizePx;
uniform float u_pixelRatio;
uniform float u_globalAlpha;
uniform float u_time;
uniform float u_zoom;
uniform float u_resolution;
uniform float u_rotation;
uniform vec4 u_renderExtent;
uniform vec2 u_patternOrigin;
uniform float u_depth;
uniform mediump int u_hitDetection;

const float PI = 3.141592653589793238;
const float TWO_PI = 2.0 * PI;
float currentLineMetric = 0.; // an actual value will be used in the stroke shaders

${NK}
`,If=CK();class Wj{constructor(){this.uniforms_=[],this.attributes_=[],this.hasSymbol_=!1,this.symbolSizeExpression_=`vec2(${Su(If["circle-radius"])} + ${Su(If["circle-stroke-width"]*.5)})`,this.symbolRotationExpression_="0.0",this.symbolOffsetExpression_="vec2(0.0)",this.symbolColorExpression_=i_(If["circle-fill-color"]),this.texCoordExpression_="vec4(0.0, 0.0, 1.0, 1.0)",this.discardExpression_="false",this.symbolRotateWithView_=!1,this.hasStroke_=!1,this.strokeWidthExpression_=Su(If["stroke-width"]),this.strokeColorExpression_=i_(If["stroke-color"]),this.strokeOffsetExpression_="0.",this.strokeCapExpression_=Gl("round"),this.strokeJoinExpression_=Gl("round"),this.strokeMiterLimitExpression_="10.",this.strokeDistanceFieldExpression_="-1000.",this.strokePatternLengthExpression_=null,this.hasFill_=!1,this.fillColorExpression_=i_(If["fill-color"]),this.vertexShaderFunctions_=[],this.fragmentShaderFunctions_=[]}addUniform(e,t){return this.uniforms_.push({name:e,type:t}),this}addAttribute(e,t,r,i){return this.attributes_.push({name:e,type:t,varyingName:e.replace(/^a_/,"v_"),varyingType:i??t,varyingExpression:r??e}),this}setSymbolSizeExpression(e){return this.hasSymbol_=!0,this.symbolSizeExpression_=e,this}getSymbolSizeExpression(){return this.symbolSizeExpression_}setSymbolRotationExpression(e){return this.symbolRotationExpression_=e,this}setSymbolOffsetExpression(e){return this.symbolOffsetExpression_=e,this}getSymbolOffsetExpression(){return this.symbolOffsetExpression_}setSymbolColorExpression(e){return this.hasSymbol_=!0,this.symbolColorExpression_=e,this}getSymbolColorExpression(){return this.symbolColorExpression_}setTextureCoordinateExpression(e){return this.texCoordExpression_=e,this}setFragmentDiscardExpression(e){return this.discardExpression_=e,this}getFragmentDiscardExpression(){return this.discardExpression_}setSymbolRotateWithView(e){return this.symbolRotateWithView_=e,this}setStrokeWidthExpression(e){return this.hasStroke_=!0,this.strokeWidthExpression_=e,this}setStrokeColorExpression(e){return this.hasStroke_=!0,this.strokeColorExpression_=e,this}getStrokeColorExpression(){return this.strokeColorExpression_}setStrokeOffsetExpression(e){return this.strokeOffsetExpression_=e,this}setStrokeCapExpression(e){return this.strokeCapExpression_=e,this}setStrokeJoinExpression(e){return this.strokeJoinExpression_=e,this}setStrokeMiterLimitExpression(e){return this.strokeMiterLimitExpression_=e,this}setStrokeDistanceFieldExpression(e){return this.strokeDistanceFieldExpression_=e,this}setStrokePatternLengthExpression(e){return this.strokePatternLengthExpression_=e,this}getStrokePatternLengthExpression(){return this.strokePatternLengthExpression_}setFillColorExpression(e){return this.hasFill_=!0,this.fillColorExpression_=e,this}getFillColorExpression(){return this.fillColorExpression_}addVertexShaderFunction(e){return this.vertexShaderFunctions_.includes(e)?this:(this.vertexShaderFunctions_.push(e),this)}addFragmentShaderFunction(e){return this.fragmentShaderFunctions_.includes(e)?this:(this.fragmentShaderFunctions_.push(e),this)}getSymbolVertexShader(){return this.hasSymbol_?`${kf}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
attribute vec2 a_position;
attribute vec2 a_localPosition;
attribute vec2 a_hitColor;

varying vec2 v_texCoord;
varying vec2 v_quadCoord;
varying vec4 v_hitColor;
varying vec2 v_centerPx;
varying float v_angle;
varying vec2 v_quadSizePx;

${this.attributes_.map(e=>`attribute ${e.type} ${e.name};
varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.vertexShaderFunctions_.join(`
`)}
vec2 pxToScreen(vec2 coordPx) {
  vec2 scaled = coordPx / u_viewportSizePx / 0.5;
  return scaled;
}

vec2 screenToPx(vec2 coordScreen) {
  return (coordScreen * 0.5 + 0.5) * u_viewportSizePx;
}

void main(void) {
  v_quadSizePx = ${this.symbolSizeExpression_};
  vec2 halfSizePx = v_quadSizePx * 0.5;
  vec2 centerOffsetPx = ${this.symbolOffsetExpression_};
  vec2 offsetPx = centerOffsetPx + a_localPosition * halfSizePx * vec2(1., -1.);
  float angle = ${this.symbolRotationExpression_}${this.symbolRotateWithView_?" + u_rotation":""};
  float c = cos(-angle);
  float s = sin(-angle);
  offsetPx = vec2(c * offsetPx.x - s * offsetPx.y, s * offsetPx.x + c * offsetPx.y);
  vec4 center = u_projectionMatrix * vec4(a_position, 0.0, 1.0);
  gl_Position = center + vec4(pxToScreen(offsetPx), u_depth, 0.);
  vec4 texCoord = ${this.texCoordExpression_};
  float u = mix(texCoord.s, texCoord.p, a_localPosition.x * 0.5 + 0.5);
  float v = mix(texCoord.t, texCoord.q, a_localPosition.y * 0.5 + 0.5);
  v_texCoord = vec2(u, v);
  v_hitColor = unpackColor(a_hitColor);
  v_angle = angle;
  c = cos(-v_angle);
  s = sin(-v_angle);
  centerOffsetPx = vec2(c * centerOffsetPx.x - s * centerOffsetPx.y, s * centerOffsetPx.x + c * centerOffsetPx.y);
  v_centerPx = screenToPx(center.xy) + centerOffsetPx;
${this.attributes_.map(e=>`  ${e.varyingName} = ${e.varyingExpression};`).join(`
`)}
}`:null}getSymbolFragmentShader(){return this.hasSymbol_?`${kf}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
varying vec2 v_texCoord;
varying vec4 v_hitColor;
varying vec2 v_centerPx;
varying float v_angle;
varying vec2 v_quadSizePx;
${this.attributes_.map(e=>`varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.fragmentShaderFunctions_.join(`
`)}

void main(void) {
${this.attributes_.map(e=>`  ${e.varyingType} ${e.name} = ${e.varyingName}; // assign to original attribute name`).join(`
`)}
  if (${this.discardExpression_}) { discard; }
  vec2 coordsPx = gl_FragCoord.xy / u_pixelRatio - v_centerPx; // relative to center
  float c = cos(v_angle);
  float s = sin(v_angle);
  coordsPx = vec2(c * coordsPx.x - s * coordsPx.y, s * coordsPx.x + c * coordsPx.y);
  gl_FragColor = ${this.symbolColorExpression_};
  gl_FragColor.rgb *= gl_FragColor.a;
  if (u_hitDetection > 0) {
    if (gl_FragColor.a < 0.05) { discard; };
    gl_FragColor = v_hitColor;
  }
}`:null}getStrokeVertexShader(){return this.hasStroke_?`${kf}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
attribute vec2 a_segmentStart;
attribute vec2 a_segmentEnd;
attribute vec2 a_localPosition;
attribute float a_measureStart;
attribute float a_measureEnd;
attribute float a_angleTangentSum;
attribute float a_distanceLow;
attribute float a_distanceHigh;
attribute vec2 a_joinAngles;
attribute vec2 a_hitColor;

varying vec2 v_segmentStartPx;
varying vec2 v_segmentEndPx;
varying float v_angleStart;
varying float v_angleEnd;
varying float v_width;
varying vec4 v_hitColor;
varying float v_distancePx;
varying float v_measureStart;
varying float v_measureEnd;

${this.attributes_.map(e=>`attribute ${e.type} ${e.name};
varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.vertexShaderFunctions_.join(`
`)}
vec2 worldToPx(vec2 worldPos) {
  vec4 screenPos = u_projectionMatrix * vec4(worldPos, 0.0, 1.0);
  return (0.5 * screenPos.xy + 0.5) * u_viewportSizePx;
}

vec4 pxToScreen(vec2 pxPos) {
  vec2 screenPos = 2.0 * pxPos / u_viewportSizePx - 1.0;
  return vec4(screenPos, u_depth, 1.0);
}

bool isCap(float joinAngle) {
  return joinAngle < -0.1;
}

vec2 getJoinOffsetDirection(vec2 normalPx, float joinAngle) {
  float halfAngle = joinAngle / 2.0;
  float c = cos(halfAngle);
  float s = sin(halfAngle);
  vec2 angleBisectorNormal = vec2(s * normalPx.x + c * normalPx.y, -c * normalPx.x + s * normalPx.y);
  float length = 1.0 / s;
  return angleBisectorNormal * length;
}

vec2 getOffsetPoint(vec2 point, vec2 normal, float joinAngle, float offsetPx) {
  // if on a cap or the join angle is too high, offset the line along the segment normal
  if (cos(joinAngle) > 0.998 || isCap(joinAngle)) {
    return point - normal * offsetPx;
  }
  // offset is applied along the inverted normal (positive offset goes "right" relative to line direction)
  return point - getJoinOffsetDirection(normal, joinAngle) * offsetPx;
}

void main(void) {
  v_angleStart = a_joinAngles.x;
  v_angleEnd = a_joinAngles.y;
  float startEndRatio = a_localPosition.x * 0.5 + 0.5;
  currentLineMetric = mix(a_measureStart, a_measureEnd, startEndRatio);
  // we're reading the fractional part while keeping the sign (so -4.12 gives -0.12, 3.45 gives 0.45)

  float lineWidth = ${this.strokeWidthExpression_};
  float lineOffsetPx = ${this.strokeOffsetExpression_};

  // compute segment start/end in px with offset
  vec2 segmentStartPx = worldToPx(a_segmentStart);
  vec2 segmentEndPx = worldToPx(a_segmentEnd);
  vec2 tangentPx = normalize(segmentEndPx - segmentStartPx);
  vec2 normalPx = vec2(-tangentPx.y, tangentPx.x);
  segmentStartPx = getOffsetPoint(segmentStartPx, normalPx, v_angleStart, lineOffsetPx),
  segmentEndPx = getOffsetPoint(segmentEndPx, normalPx, v_angleEnd, lineOffsetPx);

  // compute current vertex position
  float normalDir = -1. * a_localPosition.y;
  float tangentDir = -1. * a_localPosition.x;
  float angle = mix(v_angleStart, v_angleEnd, startEndRatio);
  vec2 joinDirection;
  vec2 positionPx = mix(segmentStartPx, segmentEndPx, startEndRatio);
  // if angle is too high, do not make a proper join
  if (cos(angle) > ${qN} || isCap(angle)) {
    joinDirection = normalPx * normalDir - tangentPx * tangentDir;
  } else {
    joinDirection = getJoinOffsetDirection(normalPx * normalDir, angle);
  }
  positionPx = positionPx + joinDirection * (lineWidth * 0.5 + 1.); // adding 1 pixel for antialiasing
  gl_Position = pxToScreen(positionPx);

  v_segmentStartPx = segmentStartPx;
  v_segmentEndPx = segmentEndPx;
  v_width = lineWidth;
  v_hitColor = unpackColor(a_hitColor);

  v_distancePx = a_distanceLow / u_resolution - (lineOffsetPx * a_angleTangentSum);
  float distanceHighPx = a_distanceHigh / u_resolution;
  ${this.strokePatternLengthExpression_!==null?`v_distancePx = mod(v_distancePx, ${this.strokePatternLengthExpression_});
  distanceHighPx = mod(distanceHighPx, ${this.strokePatternLengthExpression_});
  `:""}v_distancePx += distanceHighPx;

  v_measureStart = a_measureStart;
  v_measureEnd = a_measureEnd;
${this.attributes_.map(e=>`  ${e.varyingName} = ${e.varyingExpression};`).join(`
`)}
}`:null}getStrokeFragmentShader(){return this.hasStroke_?`${kf}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
varying vec2 v_segmentStartPx;
varying vec2 v_segmentEndPx;
varying float v_angleStart;
varying float v_angleEnd;
varying float v_width;
varying vec4 v_hitColor;
varying float v_distancePx;
varying float v_measureStart;
varying float v_measureEnd;
${this.attributes_.map(e=>`varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.fragmentShaderFunctions_.join(`
`)}

vec2 pxToWorld(vec2 pxPos) {
  vec2 screenPos = 2.0 * pxPos / u_viewportSizePx - 1.0;
  return (u_screenToWorldMatrix * vec4(screenPos, 0.0, 1.0)).xy;
}

bool isCap(float joinAngle) {
  return joinAngle < -0.1;
}

float segmentDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  vec2 tangent = normalize(end - start);
  vec2 normal = vec2(-tangent.y, tangent.x);
  vec2 startToPoint = point - start;
  return abs(dot(startToPoint, normal)) - width * 0.5;
}

float buttCapDistanceField(vec2 point, vec2 start, vec2 end) {
  vec2 startToPoint = point - start;
  vec2 tangent = normalize(end - start);
  return dot(startToPoint, -tangent);
}

float squareCapDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  return buttCapDistanceField(point, start, end) - width * 0.5;
}

float roundCapDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  float onSegment = max(0., 1000. * dot(point - start, end - start)); // this is very high when inside the segment
  return length(point - start) - width * 0.5 - onSegment;
}

float roundJoinDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  return roundCapDistanceField(point, start, end, width);
}

float bevelJoinField(vec2 point, vec2 start, vec2 end, float width, float joinAngle) {
  vec2 startToPoint = point - start;
  vec2 tangent = normalize(end - start);
  float c = cos(joinAngle * 0.5);
  float s = sin(joinAngle * 0.5);
  float direction = -sign(sin(joinAngle));
  vec2 bisector = vec2(c * tangent.x - s * tangent.y, s * tangent.x + c * tangent.y);
  float radius = width * 0.5 * s;
  return dot(startToPoint, bisector * direction) - radius;
}

float miterJoinDistanceField(vec2 point, vec2 start, vec2 end, float width, float joinAngle) {
  if (cos(joinAngle) > ${qN}) { // avoid risking a division by zero
    return bevelJoinField(point, start, end, width, joinAngle);
  }
  float miterLength = 1. / sin(joinAngle * 0.5);
  float miterLimit = ${this.strokeMiterLimitExpression_};
  if (miterLength > miterLimit) {
    return bevelJoinField(point, start, end, width, joinAngle);
  }
  return -1000.;
}

float capDistanceField(vec2 point, vec2 start, vec2 end, float width, float capType) {
   if (capType == ${Gl("butt")}) {
    return buttCapDistanceField(point, start, end);
  } else if (capType == ${Gl("square")}) {
    return squareCapDistanceField(point, start, end, width);
  }
  return roundCapDistanceField(point, start, end, width);
}

float joinDistanceField(vec2 point, vec2 start, vec2 end, float width, float joinAngle, float joinType) {
  if (joinType == ${Gl("bevel")}) {
    return bevelJoinField(point, start, end, width, joinAngle);
  } else if (joinType == ${Gl("miter")}) {
    return miterJoinDistanceField(point, start, end, width, joinAngle);
  }
  return roundJoinDistanceField(point, start, end, width);
}

float computeSegmentPointDistance(vec2 point, vec2 start, vec2 end, float width, float joinAngle, float capType, float joinType) {
  if (isCap(joinAngle)) {
    return capDistanceField(point, start, end, width, capType);
  }
  return joinDistanceField(point, start, end, width, joinAngle, joinType);
}

float distanceFromSegment(vec2 point, vec2 start, vec2 end) {
  vec2 tangent = end - start;
  vec2 startToPoint = point - start;
  // inspire by capsule fn in https://iquilezles.org/articles/distfunctions/
  float h = clamp(dot(startToPoint, tangent) / dot(tangent, tangent), 0.0, 1.0);
  return length(startToPoint - tangent * h);
}

void main(void) {
${this.attributes_.map(e=>`  ${e.varyingType} ${e.name} = ${e.varyingName}; // assign to original attribute name`).join(`
`)}

  vec2 currentPointPx = gl_FragCoord.xy / u_pixelRatio;
  #ifdef GL_FRAGMENT_PRECISION_HIGH
  vec2 worldPos = pxToWorld(currentPointPx);
  if (
    abs(u_renderExtent[0] - u_renderExtent[2]) > 0.0 && (
      worldPos[0] < u_renderExtent[0] ||
      worldPos[1] < u_renderExtent[1] ||
      worldPos[0] > u_renderExtent[2] ||
      worldPos[1] > u_renderExtent[3]
    )
  ) {
    discard;
  }
  #endif

  float segmentLengthPx = length(v_segmentEndPx - v_segmentStartPx);
  segmentLengthPx = max(segmentLengthPx, 1.17549429e-38); // avoid divide by zero
  vec2 segmentTangent = (v_segmentEndPx - v_segmentStartPx) / segmentLengthPx;
  vec2 segmentNormal = vec2(-segmentTangent.y, segmentTangent.x);
  vec2 startToPointPx = currentPointPx - v_segmentStartPx;
  float lengthToPointPx = max(0., min(dot(segmentTangent, startToPointPx), segmentLengthPx));
  float currentLengthPx = lengthToPointPx + v_distancePx;
  float currentRadiusPx = distanceFromSegment(currentPointPx, v_segmentStartPx, v_segmentEndPx);
  float currentRadiusRatio = dot(segmentNormal, startToPointPx) * 2. / v_width;
  currentLineMetric = mix(v_measureStart, v_measureEnd, lengthToPointPx / segmentLengthPx);

  if (${this.discardExpression_}) { discard; }

  float capType = ${this.strokeCapExpression_};
  float joinType = ${this.strokeJoinExpression_};
  float segmentStartDistance = computeSegmentPointDistance(currentPointPx, v_segmentStartPx, v_segmentEndPx, v_width, v_angleStart, capType, joinType);
  float segmentEndDistance = computeSegmentPointDistance(currentPointPx, v_segmentEndPx, v_segmentStartPx, v_width, v_angleEnd, capType, joinType);
  float distanceField = max(
    segmentDistanceField(currentPointPx, v_segmentStartPx, v_segmentEndPx, v_width),
    max(segmentStartDistance, segmentEndDistance)
  );
  distanceField = max(distanceField, ${this.strokeDistanceFieldExpression_});

  vec4 color = ${this.strokeColorExpression_};
  color.a *= smoothstep(0.5, -0.5, distanceField);
  gl_FragColor = color;
  gl_FragColor.a *= u_globalAlpha;
  gl_FragColor.rgb *= gl_FragColor.a;
  if (u_hitDetection > 0) {
    if (gl_FragColor.a < 0.1) { discard; };
    gl_FragColor = v_hitColor;
  }
}`:null}getFillVertexShader(){return this.hasFill_?`${kf}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
attribute vec2 a_position;
attribute vec2 a_hitColor;

varying vec4 v_hitColor;

${this.attributes_.map(e=>`attribute ${e.type} ${e.name};
varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.vertexShaderFunctions_.join(`
`)}
void main(void) {
  gl_Position = u_projectionMatrix * vec4(a_position, u_depth, 1.0);
  v_hitColor = unpackColor(a_hitColor);
${this.attributes_.map(e=>`  ${e.varyingName} = ${e.varyingExpression};`).join(`
`)}
}`:null}getFillFragmentShader(){return this.hasFill_?`${kf}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
varying vec4 v_hitColor;
${this.attributes_.map(e=>`varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.fragmentShaderFunctions_.join(`
`)}
vec2 pxToWorld(vec2 pxPos) {
  vec2 screenPos = 2.0 * pxPos / u_viewportSizePx - 1.0;
  return (u_screenToWorldMatrix * vec4(screenPos, 0.0, 1.0)).xy;
}

vec2 worldToPx(vec2 worldPos) {
  vec4 screenPos = u_projectionMatrix * vec4(worldPos, 0.0, 1.0);
  return (0.5 * screenPos.xy + 0.5) * u_viewportSizePx;
}

void main(void) {
${this.attributes_.map(e=>`  ${e.varyingType} ${e.name} = ${e.varyingName}; // assign to original attribute name`).join(`
`)}
  vec2 pxPos = gl_FragCoord.xy / u_pixelRatio;
  vec2 pxOrigin = worldToPx(u_patternOrigin);
  #ifdef GL_FRAGMENT_PRECISION_HIGH
  vec2 worldPos = pxToWorld(pxPos);
  if (
    abs(u_renderExtent[0] - u_renderExtent[2]) > 0.0 && (
      worldPos[0] < u_renderExtent[0] ||
      worldPos[1] < u_renderExtent[1] ||
      worldPos[0] > u_renderExtent[2] ||
      worldPos[1] > u_renderExtent[3]
    )
  ) {
    discard;
  }
  #endif
  if (${this.discardExpression_}) { discard; }
  gl_FragColor = ${this.fillColorExpression_};
  gl_FragColor.a *= u_globalAlpha;
  gl_FragColor.rgb *= gl_FragColor.a;
  if (u_hitDetection > 0) {
    if (gl_FragColor.a < 0.1) { discard; };
    gl_FragColor = v_hitColor;
  }
}`:null}}class Y_{constructor(){this.globalCounter_=0,this.refToFeature_=new Map,this.uidToRef_=new Map,this.freeGlobalRef_=[],this.polygonBatch={entries:{},geometriesCount:0,verticesCount:0,ringsCount:0},this.pointBatch={entries:{},geometriesCount:0},this.lineStringBatch={entries:{},geometriesCount:0,verticesCount:0}}addFeatures(e,t){for(let r=0;r<e.length;r++)this.addFeature(e[r],t)}addFeature(e,t){let r=e.getGeometry();r&&(t&&(r=r.clone(),r.applyTransform(t)),this.addGeometry_(r,e))}clearFeatureEntryInPointBatch_(e){const t=Kt(e),r=this.pointBatch.entries[t];if(r)return this.pointBatch.geometriesCount-=r.flatCoordss.length,delete this.pointBatch.entries[t],r}clearFeatureEntryInLineStringBatch_(e){const t=Kt(e),r=this.lineStringBatch.entries[t];if(r)return this.lineStringBatch.verticesCount-=r.verticesCount,this.lineStringBatch.geometriesCount-=r.flatCoordss.length,delete this.lineStringBatch.entries[t],r}clearFeatureEntryInPolygonBatch_(e){const t=Kt(e),r=this.polygonBatch.entries[t];if(r)return this.polygonBatch.verticesCount-=r.verticesCount,this.polygonBatch.ringsCount-=r.ringsCount,this.polygonBatch.geometriesCount-=r.flatCoordss.length,delete this.polygonBatch.entries[t],r}addGeometry_(e,t){const r=e.getType();switch(r){case"GeometryCollection":{const i=e.getGeometriesArray();for(const s of i)this.addGeometry_(s,t);break}case"MultiPolygon":{const i=e;this.addCoordinates_(r,i.getFlatCoordinates(),i.getEndss(),t,Kt(t),i.getStride());break}case"MultiLineString":{const i=e;this.addCoordinates_(r,i.getFlatCoordinates(),i.getEnds(),t,Kt(t),i.getStride());break}case"MultiPoint":{const i=e;this.addCoordinates_(r,i.getFlatCoordinates(),null,t,Kt(t),i.getStride());break}case"Polygon":{const i=e;this.addCoordinates_(r,i.getFlatCoordinates(),i.getEnds(),t,Kt(t),i.getStride());break}case"Point":{const i=e;this.addCoordinates_(r,i.getFlatCoordinates(),null,t,Kt(t),i.getStride());break}case"LineString":case"LinearRing":{const i=e,s=i.getStride();this.addCoordinates_(r,i.getFlatCoordinates(),null,t,Kt(t),s,i.getLayout?.());break}}}addCoordinates_(e,t,r,i,s,a,o){let l;switch(e){case"MultiPolygon":{const c=r;for(let h=0,g=c.length;h<g;h++){let m=c[h];const y=h>0?c[h-1]:null,_=y?y[y.length-1]:0,x=m[m.length-1];m=_>0?m.map(w=>w-_):m,this.addCoordinates_("Polygon",t.slice(_,x),m,i,s,a,o)}break}case"MultiLineString":{const c=r;for(let h=0,g=c.length;h<g;h++){const m=h>0?c[h-1]:0;this.addCoordinates_("LineString",t.slice(m,c[h]),null,i,s,a,o)}break}case"MultiPoint":for(let c=0,h=t.length;c<h;c+=a)this.addCoordinates_("Point",t.slice(c,c+2),null,i,s,null,null);break;case"Polygon":{const c=r;if(i instanceof Ds){const m=hj(t,c);if(m.length>1){this.addCoordinates_("MultiPolygon",t,m,i,s,a,o);return}}this.polygonBatch.entries[s]||(this.polygonBatch.entries[s]=this.addRefToEntry_(s,{feature:i,flatCoordss:[],verticesCount:0,ringsCount:0,ringsVerticesCounts:[]})),l=t.length/a;const h=r.length,g=r.map((m,y,_)=>y>0?(m-_[y-1])/a:m/a);this.polygonBatch.verticesCount+=l,this.polygonBatch.ringsCount+=h,this.polygonBatch.geometriesCount++,this.polygonBatch.entries[s].flatCoordss.push(MK(t,a)),this.polygonBatch.entries[s].ringsVerticesCounts.push(g),this.polygonBatch.entries[s].verticesCount+=l,this.polygonBatch.entries[s].ringsCount+=h;for(let m=0,y=c.length;m<y;m++){const _=m>0?c[m-1]:0;this.addCoordinates_("LinearRing",t.slice(_,c[m]),null,i,s,a,o)}break}case"Point":this.pointBatch.entries[s]||(this.pointBatch.entries[s]=this.addRefToEntry_(s,{feature:i,flatCoordss:[]})),this.pointBatch.geometriesCount++,this.pointBatch.entries[s].flatCoordss.push(t);break;case"LineString":case"LinearRing":this.lineStringBatch.entries[s]||(this.lineStringBatch.entries[s]=this.addRefToEntry_(s,{feature:i,flatCoordss:[],verticesCount:0})),l=t.length/a,this.lineStringBatch.verticesCount+=l,this.lineStringBatch.geometriesCount++,this.lineStringBatch.entries[s].flatCoordss.push(LK(t,a,o)),this.lineStringBatch.entries[s].verticesCount+=l;break}}addRefToEntry_(e,t){const r=this.uidToRef_.get(e),i=r||this.freeGlobalRef_.pop()||++this.globalCounter_;return t.ref=i,r||(this.refToFeature_.set(i,t.feature),this.uidToRef_.set(e,i)),t}removeRef_(e,t){if(!e)throw new Error("This feature has no ref: "+t);this.refToFeature_.delete(e),this.uidToRef_.delete(t),this.freeGlobalRef_.push(e)}changeFeature(e,t){if(!this.uidToRef_.get(Kt(e)))return;this.removeFeature(e);let r=e.getGeometry();r&&(t&&(r=r.clone(),r.applyTransform(t)),this.addGeometry_(r,e))}removeFeature(e){let t=this.clearFeatureEntryInPointBatch_(e);t=this.clearFeatureEntryInPolygonBatch_(e)||t,t=this.clearFeatureEntryInLineStringBatch_(e)||t,t&&this.removeRef_(t.ref,Kt(t.feature))}clear(){this.polygonBatch.entries={},this.polygonBatch.geometriesCount=0,this.polygonBatch.verticesCount=0,this.polygonBatch.ringsCount=0,this.lineStringBatch.entries={},this.lineStringBatch.geometriesCount=0,this.lineStringBatch.verticesCount=0,this.pointBatch.entries={},this.pointBatch.geometriesCount=0,this.globalCounter_=0,this.freeGlobalRef_=[],this.refToFeature_.clear(),this.uidToRef_.clear()}getFeatureFromRef(e){return this.refToFeature_.get(e)}isEmpty(){return this.globalCounter_===0}filter(e){const t=new Y_;t.globalCounter_=this.globalCounter_,t.uidToRef_=this.uidToRef_,t.refToFeature_=this.refToFeature_;let r=!0;for(const i of this.refToFeature_.values())e(i)&&(t.addFeature(i),r=!1);return r?new Y_:t}}function MK(n,e){return e===2?n:n.filter((t,r)=>r%e<2)}function LK(n,e,t){return e===3&&t==="XYM"?n:e===4?n.filter((r,i)=>i%e!==2):e===3?n.map((r,i)=>i%e!==2?r:0):new Array(n.length*1.5).fill(0).map((r,i)=>i%3===2?0:n[Math.round(i/1.5)])}function OK(){const n='function t(t,n,x=2){const o=n&&n.length,i=o?n[0]*x:t.length;let f=e(t,0,i,x,!0);const l=[];if(!f||f.next===f.prev)return l;let c,y,h;if(o&&(f=function(t,n,r,x){const o=[];for(let r=0,i=n.length;r<i;r++){const f=e(t,n[r]*x,r<i-1?n[r+1]*x:t.length,x,!1);f===f.next&&(f.steiner=!0),o.push(a(f))}o.sort(u);for(let t=0;t<o.length;t++)r=s(o[t],r);return r}(t,n,f,x)),t.length>80*x){c=t[0],y=t[1];let e=c,n=y;for(let r=x;r<i;r+=x){const x=t[r],o=t[r+1];x<c&&(c=x),o<y&&(y=o),x>e&&(e=x),o>n&&(n=o)}h=Math.max(e-c,n-y),h=0!==h?32767/h:0}return r(f,l,x,c,y,h,0),l}function e(t,e,n,r,x){let o;if(x===function(t,e,n,r){let x=0;for(let o=e,i=n-r;o<n;o+=r)x+=(t[i]-t[o])*(t[o+1]+t[i+1]),i=o;return x}(t,e,n,r)>0)for(let x=e;x<n;x+=r)o=d(x/r|0,t[x],t[x+1],o);else for(let x=n-r;x>=e;x-=r)o=d(x/r|0,t[x],t[x+1],o);return o&&b(o,o.next)&&(w(o),o=o.next),o}function n(t,e){if(!t)return t;e||(e=t);let n,r=t;do{if(n=!1,r.steiner||!b(r,r.next)&&0!==v(r.prev,r,r.next))r=r.next;else{if(w(r),r=e=r.prev,r===r.next)break;n=!0}}while(n||r!==e);return e}function r(t,e,u,s,l,a,y){if(!t)return;!y&&a&&function(t,e,n,r){let x=t;do{0===x.z&&(x.z=c(x.x,x.y,e,n,r)),x.prevZ=x.prev,x.nextZ=x.next,x=x.next}while(x!==t);x.prevZ.nextZ=null,x.prevZ=null,function(t){let e,n=1;do{let r,x=t;t=null;let o=null;for(e=0;x;){e++;let i=x,f=0;for(let t=0;t<n&&(f++,i=i.nextZ,i);t++);let u=n;for(;f>0||u>0&&i;)0!==f&&(0===u||!i||x.z<=i.z)?(r=x,x=x.nextZ,f--):(r=i,i=i.nextZ,u--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;x=i}o.nextZ=null,n*=2}while(e>1)}(x)}(t,s,l,a);let h=t;for(;t.prev!==t.next;){const c=t.prev,p=t.next;if(a?o(t,s,l,a):x(t))e.push(c.i,t.i,p.i),w(t),t=p.next,h=p.next;else if((t=p)===h){y?1===y?r(t=i(n(t),e),e,u,s,l,a,2):2===y&&f(t,e,u,s,l,a):r(n(t),e,u,s,l,a,1);break}}}function x(t){const e=t.prev,n=t,r=t.next;if(v(e,n,r)>=0)return!1;const x=e.x,o=n.x,i=r.x,f=e.y,u=n.y,s=r.y,l=Math.min(x,o,i),c=Math.min(f,u,s),a=Math.max(x,o,i),y=Math.max(f,u,s);let p=r.next;for(;p!==e;){if(p.x>=l&&p.x<=a&&p.y>=c&&p.y<=y&&h(x,f,o,u,i,s,p.x,p.y)&&v(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function o(t,e,n,r){const x=t.prev,o=t,i=t.next;if(v(x,o,i)>=0)return!1;const f=x.x,u=o.x,s=i.x,l=x.y,a=o.y,y=i.y,p=Math.min(f,u,s),b=Math.min(l,a,y),M=Math.max(f,u,s),m=Math.max(l,a,y),A=c(p,b,e,n,r),g=c(M,m,e,n,r);let Z=t.prevZ,d=t.nextZ;for(;Z&&Z.z>=A&&d&&d.z<=g;){if(Z.x>=p&&Z.x<=M&&Z.y>=b&&Z.y<=m&&Z!==x&&Z!==i&&h(f,l,u,a,s,y,Z.x,Z.y)&&v(Z.prev,Z,Z.next)>=0)return!1;if(Z=Z.prevZ,d.x>=p&&d.x<=M&&d.y>=b&&d.y<=m&&d!==x&&d!==i&&h(f,l,u,a,s,y,d.x,d.y)&&v(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(;Z&&Z.z>=A;){if(Z.x>=p&&Z.x<=M&&Z.y>=b&&Z.y<=m&&Z!==x&&Z!==i&&h(f,l,u,a,s,y,Z.x,Z.y)&&v(Z.prev,Z,Z.next)>=0)return!1;Z=Z.prevZ}for(;d&&d.z<=g;){if(d.x>=p&&d.x<=M&&d.y>=b&&d.y<=m&&d!==x&&d!==i&&h(f,l,u,a,s,y,d.x,d.y)&&v(d.prev,d,d.next)>=0)return!1;d=d.nextZ}return!0}function i(t,e){let r=t;do{const n=r.prev,x=r.next.next;!b(n,x)&&M(n,r,r.next,x)&&g(n,x)&&g(x,n)&&(e.push(n.i,r.i,x.i),w(r),w(r.next),r=t=x),r=r.next}while(r!==t);return n(r)}function f(t,e,x,o,i,f){let u=t;do{let t=u.next.next;for(;t!==u.prev;){if(u.i!==t.i&&p(u,t)){let s=Z(u,t);return u=n(u,u.next),s=n(s,s.next),r(u,e,x,o,i,f,0),void r(s,e,x,o,i,f,0)}t=t.next}u=u.next}while(u!==t)}function u(t,e){let n=t.x-e.x;if(0===n&&(n=t.y-e.y,0===n)){n=(t.next.y-t.y)/(t.next.x-t.x)-(e.next.y-e.y)/(e.next.x-e.x)}return n}function s(t,e){const r=function(t,e){let n=e;const r=t.x,x=t.y;let o,i=-1/0;if(b(t,n))return n;do{if(b(t,n.next))return n.next;if(x<=n.y&&x>=n.next.y&&n.next.y!==n.y){const t=n.x+(x-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(t<=r&&t>i&&(i=t,o=n.x<n.next.x?n:n.next,t===r))return o}n=n.next}while(n!==e);if(!o)return null;const f=o,u=o.x,s=o.y;let c=1/0;n=o;do{if(r>=n.x&&n.x>=u&&r!==n.x&&y(x<s?r:i,x,u,s,x<s?i:r,x,n.x,n.y)){const e=Math.abs(x-n.y)/(r-n.x);g(n,t)&&(e<c||e===c&&(n.x>o.x||n.x===o.x&&l(o,n)))&&(o=n,c=e)}n=n.next}while(n!==f);return o}(t,e);if(!r)return e;const x=Z(r,t);return n(x,x.next),n(r,r.next)}function l(t,e){return v(t.prev,t,e.prev)<0&&v(e.next,t,t.next)<0}function c(t,e,n,r,x){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*x|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*x|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function a(t){let e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function y(t,e,n,r,x,o,i,f){return(x-i)*(e-f)>=(t-i)*(o-f)&&(t-i)*(r-f)>=(n-i)*(e-f)&&(n-i)*(o-f)>=(x-i)*(r-f)}function h(t,e,n,r,x,o,i,f){return!(t===i&&e===f)&&y(t,e,n,r,x,o,i,f)}function p(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&M(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(g(t,e)&&g(e,t)&&function(t,e){let n=t,r=!1;const x=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&x<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)&&(v(t.prev,t,e.prev)||v(t,e.prev,e))||b(t,e)&&v(t.prev,t,t.next)>0&&v(e.prev,e,e.next)>0)}function v(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function b(t,e){return t.x===e.x&&t.y===e.y}function M(t,e,n,r){const x=A(v(t,e,n)),o=A(v(t,e,r)),i=A(v(n,r,t)),f=A(v(n,r,e));return x!==o&&i!==f||(!(0!==x||!m(t,n,e))||(!(0!==o||!m(t,r,e))||(!(0!==i||!m(n,t,r))||!(0!==f||!m(n,e,r)))))}function m(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function A(t){return t>0?1:t<0?-1:0}function g(t,e){return v(t.prev,t,t.next)<0?v(t,e,t.next)>=0&&v(t,t.prev,e)>=0:v(t,e,t.prev)<0||v(t,t.next,e)<0}function Z(t,e){const n=F(t.i,t.x,t.y),r=F(e.i,e.x,e.y),x=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=x,x.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function d(t,e,n,r){const x=F(t,e,n);return r?(x.next=r.next,x.prev=r,r.next.prev=x,r.next=x):(x.prev=x,x.next=x),x}function w(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function F(t,e,n){return{i:t,x:e,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function E(t,e){const n=e[0],r=e[1];return e[0]=t[0]*n+t[2]*r+t[4],e[1]=t[1]*n+t[3]*r+t[5],e}function I(t,e){const n=(r=e)[0]*r[3]-r[1]*r[2];var r;!function(t,e){if(!t)throw new Error(e)}(0!==n,"Transformation matrix cannot be inverted");const x=e[0],o=e[1],i=e[2],f=e[3],u=e[4],s=e[5];return t[0]=f/n,t[1]=-o/n,t[2]=-i/n,t[3]=x/n,t[4]=(i*s-f*u)/n,t[5]=-(x*s-o*u)/n,t}new Array(6);const z=[],B={vertexAttributesPosition:0,instanceAttributesPosition:0,indicesPosition:0};function P(t,e,n,r,x){const o=t[e++],i=t[e++],f=z;f.length=r;for(let n=0;n<f.length;n++)f[n]=t[e+n];let u=x?x.instanceAttributesPosition:0;return n[u++]=o,n[u++]=i,f.length&&(n.set(f,u),u+=f.length),B.instanceAttributesPosition=u,B}function N(t,e,n,r,x,o,i,f,u,s){const l=[t[e],t[e+1]],c=[t[n],t[n+1]],a=t[e+2],y=t[n+2],h=E(f,[...l]),p=E(f,[...c]);function v(t,e,n){const r=Math.sqrt((e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1])),x=[(e[0]-t[0])/r,(e[1]-t[1])/r],o=[-x[1],x[0]],i=Math.sqrt((n[0]-t[0])*(n[0]-t[0])+(n[1]-t[1])*(n[1]-t[1])),f=[(n[0]-t[0])/i,(n[1]-t[1])/i];let u=0===r||0===i?0:Math.acos((s=f[0]*x[0]+f[1]*x[1],l=-1,c=1,Math.min(Math.max(s,l),c)));var s,l,c;u=Math.max(u,1e-5);return f[0]*o[0]+f[1]*o[1]>0?u:2*Math.PI-u}let b=-1,M=-1,m=s;const A=null!==x;if(null!==r){b=v(h,p,E(f,[...[t[r],t[r+1]]])),Math.cos(b)<=.985&&(m+=Math.tan((b-Math.PI)/2))}if(A){M=v(p,h,E(f,[...[t[x],t[x+1]]])),Math.cos(M)<=.985&&(m+=Math.tan((Math.PI-M)/2))}const g=Math.pow(2,24),Z=u%g,d=Math.floor(u/g)*g;return o.push(l[0],l[1],a,c[0],c[1],y,b,M,Z,d,s),o.push(...i),{length:u+Math.sqrt((p[0]-h[0])*(p[0]-h[0])+(p[1]-h[1])*(p[1]-h[1])),angle:m}}function R(e,n,r,x,o){const i=2+o;let f=n;const u=e.slice(f,f+o);f+=o;const s=e[f++];let l=0;const c=new Array(s-1);for(let t=0;t<s;t++)l+=e[f++],t<s-1&&(c[t]=l);const a=e.slice(f,f+2*l),y=t(a,c,2);for(let t=0;t<y.length;t++)x.push(y[t]+r.length/i);for(let t=0;t<a.length;t+=2)r.push(a[t],a[t+1],...u);return f+2*l}const S="GENERATE_POLYGON_BUFFERS",T="GENERATE_POINT_BUFFERS",_="GENERATE_LINE_STRING_BUFFERS",O=self;O.onmessage=t=>{const e=t.data;switch(e.type){case T:{const t=2,n=2,r=e.customAttributesSize,x=n+r,o=new Float32Array(e.renderInstructions),i=o.length/x*(t+r),f=Uint32Array.from([0,1,3,1,2,3]),u=Float32Array.from([-1,-1,1,-1,1,1,-1,1]),s=new Float32Array(i);let l;for(let t=0;t<o.length;t+=x)l=P(o,t,s,r,l);const c=Object.assign({indicesBuffer:f.buffer,vertexAttributesBuffer:u.buffer,instanceAttributesBuffer:s.buffer,renderInstructions:o.buffer},e);O.postMessage(c,[u.buffer,s.buffer,f.buffer,o.buffer]);break}case _:{const t=[],n=e.customAttributesSize,r=3,x=new Float32Array(e.renderInstructions);let o=0;const i=[1,0,0,1,0,0];let f,u;for(I(i,e.renderInstructionsTransform);o<x.length;){u=Array.from(x.slice(o,o+n)),o+=n,f=x[o++];const e=o,s=o+(f-1)*r,l=x[e]===x[s]&&x[e+1]===x[s+1];let c=0,a=0;for(let n=0;n<f-1;n++){let y=null;n>0?y=o+(n-1)*r:l&&(y=s-r);let h=null;n<f-2?h=o+(n+2)*r:l&&(h=e+r);const p=N(x,o+n*r,o+(n+1)*r,y,h,t,u,i,c,a);c=p.length,a=p.angle}o+=f*r}const s=Uint32Array.from([0,1,3,1,2,3]),l=Float32Array.from([-1,-1,1,-1,1,1,-1,1]),c=Float32Array.from(t),a=Object.assign({indicesBuffer:s.buffer,vertexAttributesBuffer:l.buffer,instanceAttributesBuffer:c.buffer,renderInstructions:x.buffer},e);O.postMessage(a,[l.buffer,c.buffer,s.buffer,x.buffer]);break}case S:{const t=[],n=[],r=e.customAttributesSize,x=new Float32Array(e.renderInstructions);let o=0;for(;o<x.length;)o=R(x,o,t,n,r);const i=Uint32Array.from(n),f=Float32Array.from(t),u=Float32Array.from([]),s=Object.assign({indicesBuffer:i.buffer,vertexAttributesBuffer:f.buffer,instanceAttributesBuffer:u.buffer,renderInstructions:x.buffer},e);O.postMessage(s,[f.buffer,u.buffer,i.buffer,x.buffer]);break}}};';return new Worker(typeof Blob>"u"?"data:application/javascript;base64,"+Buffer.from(n,"binary").toString("base64"):URL.createObjectURL(new Blob([n],{type:"application/javascript"})))}const zS={GENERATE_POLYGON_BUFFERS:"GENERATE_POLYGON_BUFFERS",GENERATE_POINT_BUFFERS:"GENERATE_POINT_BUFFERS",GENERATE_LINE_STRING_BUFFERS:"GENERATE_LINE_STRING_BUFFERS"};function DK(n,e){e=e||[];const t=256,r=t-1,i=Math.floor(n/t/t/t)/r,s=Math.floor(n/t/t)%t/r,a=Math.floor(n/t)%t/r,o=n%t/r;return e[0]=i*256*255+s*255,e[1]=a*256*255+o*255,e}function jK(n){let e=0;const t=256,r=t-1;return e+=Math.round(n[0]*t*t*t*r),e+=Math.round(n[1]*t*t*r),e+=Math.round(n[2]*t*r),e+=Math.round(n[3]*r),e}function jA(n,e,t,r){let i=0;for(const s in e){const a=e[s],o=a.callback.call(t,t.feature);let l=o?.[0]??o;l===_T&&console.warn('The "has" operator might return false positives.'),l===void 0?l=_T:l===null&&(l=0),n[r+i++]=l,!(!a.size||a.size===1)&&(n[r+i++]=o[1],!(a.size<3)&&(n[r+i++]=o[2],!(a.size<4)&&(n[r+i++]=o[3])))}return i}function Dw(n){return Object.keys(n).reduce((e,t)=>e+(n[t].size||1),0)}function FK(n,e,t,r){const i=(2+Dw(t))*n.geometriesCount;(!e||e.length!==i)&&(e=new Float32Array(i));const s=[];let a=0;for(const o in n.entries){const l=n.entries[o];for(let c=0,h=l.flatCoordss.length;c<h;c++)s[0]=l.flatCoordss[c][0],s[1]=l.flatCoordss[c][1],Fr(r,s),e[a++]=s[0],e[a++]=s[1],a+=jA(e,t,l,a)}return e}function VK(n,e,t,r){const i=3*n.verticesCount+(1+Dw(t))*n.geometriesCount;(!e||e.length!==i)&&(e=new Float32Array(i));const s=[];let a=0;for(const o in n.entries){const l=n.entries[o];for(let c=0,h=l.flatCoordss.length;c<h;c++){s.length=l.flatCoordss[c].length,nl(l.flatCoordss[c],0,s.length,3,r,s,3),a+=jA(e,t,l,a),e[a++]=s.length/3;for(let g=0,m=s.length;g<m;g+=3)e[a++]=s[g],e[a++]=s[g+1],e[a++]=s[g+2]}}return e}function BK(n,e,t,r){const i=2*n.verticesCount+(1+Dw(t))*n.geometriesCount+n.ringsCount;(!e||e.length!==i)&&(e=new Float32Array(i));const s=[];let a=0;for(const o in n.entries){const l=n.entries[o];for(let c=0,h=l.flatCoordss.length;c<h;c++){s.length=l.flatCoordss[c].length,nl(l.flatCoordss[c],0,s.length,2,r,s),a+=jA(e,t,l,a),e[a++]=l.ringsVerticesCounts[c].length;for(let g=0,m=l.ringsVerticesCounts[c].length;g<m;g++)e[a++]=l.ringsVerticesCounts[c][g];for(let g=0,m=s.length;g<m;g+=2)e[a++]=s[g],e[a++]=s[g+1]}}return e}function Z_(n){return(JSON.stringify(n).split("").reduce((t,r)=>(t<<5)-t+r.charCodeAt(0),0)>>>0).toString()}function FA(n,e,t,r){if(`${r}radius`in n&&r!=="icon-"){let i=Jt(t,n[`${r}radius`],It);if(`${r}radius2`in n){const s=Jt(t,n[`${r}radius2`],It);i=`max(${i}, ${s})`}`${r}stroke-width`in n&&(i=`(${i} + ${Jt(t,n[`${r}stroke-width`],It)} * 0.5)`),e.setSymbolSizeExpression(`vec2(${i} * 2. + 0.5)`)}if(`${r}scale`in n){const i=Jt(t,n[`${r}scale`],Oa);e.setSymbolSizeExpression(`${e.getSymbolSizeExpression()} * ${i}`)}`${r}displacement`in n&&e.setSymbolOffsetExpression(Jt(t,n[`${r}displacement`],$s)),`${r}rotation`in n&&e.setSymbolRotationExpression(Jt(t,n[`${r}rotation`],It)),`${r}rotate-with-view`in n&&e.setSymbolRotateWithView(!!n[`${r}rotate-with-view`])}function Hj(n,e,t,r,i){let s="vec4(0.)";if(e!==null&&(s=e),t!==null&&r!==null){const l=`smoothstep(-${r} + 0.63, -${r} - 0.58, ${n})`;s=`mix(${t}, ${s}, ${l})`}const a=`(1.0 - smoothstep(-0.63, 0.58, ${n}))`;let o=`${s} * vec4(1.0, 1.0, 1.0, ${a})`;return i!==null&&(o=`${o} * vec4(1.0, 1.0, 1.0, ${i})`),o}function VA(n,e,t,r,i){const s=new Image;s.crossOrigin=n[`${r}cross-origin`]===void 0?"anonymous":n[`${r}cross-origin`],Rn(typeof n[`${r}src`]=="string",`WebGL layers do not support expressions for the ${r}src style property`),s.src=n[`${r}src`],t[`u_texture${i}_size`]=()=>s.complete?[s.width,s.height]:[0,0],e.addUniform(`u_texture${i}_size`,"vec2");const a=`u_texture${i}_size`;return t[`u_texture${i}`]=s,e.addUniform(`u_texture${i}`,"sampler2D"),a}function BA(n,e,t,r,i){let s=Jt(t,n[`${e}offset`],Oa);if(`${e}offset-origin`in n)switch(n[`${e}offset-origin`]){case"top-right":s=`vec2(${r}.x, 0.) + ${i} * vec2(-1., 0.) + ${s} * vec2(-1., 1.)`;break;case"bottom-left":s=`vec2(0., ${r}.y) + ${i} * vec2(0., -1.) + ${s} * vec2(1., -1.)`;break;case"bottom-right":s=`${r} - ${i} - ${s}`;break}return s}function GK(n,e,t,r){r.functions.circleDistanceField=`float circleDistanceField(vec2 point, float radius) {
  return length(point) - radius;
}`,FA(n,e,r,"circle-");let i=null;"circle-opacity"in n&&(i=Jt(r,n["circle-opacity"],It));let s="coordsPx";"circle-scale"in n&&(s=`coordsPx / ${Jt(r,n["circle-scale"],Oa)}`);let a=null;"circle-fill-color"in n&&(a=Jt(r,n["circle-fill-color"],wr));let o=null;"circle-stroke-color"in n&&(o=Jt(r,n["circle-stroke-color"],wr));let l=Jt(r,n["circle-radius"],It),c=null;"circle-stroke-width"in n&&(c=Jt(r,n["circle-stroke-width"],It),l=`(${l} + ${c} * 0.5)`);const h=`circleDistanceField(${s}, ${l})`,g=Hj(h,a,o,c,i);e.setSymbolColorExpression(g)}function zK(n,e,t,r){r.functions.round=`float round(float v) {
  return sign(v) * floor(abs(v) + 0.5);
}`,r.functions.starDistanceField=`float starDistanceField(vec2 point, float numPoints, float radius, float radius2, float angle) {
  float startAngle = -PI * 0.5 + angle; // tip starts upwards and rotates clockwise with angle
  float c = cos(startAngle);
  float s = sin(startAngle);
  vec2 pointRotated = vec2(c * point.x - s * point.y, s * point.x + c * point.y);
  float alpha = TWO_PI / numPoints; // the angle of one sector
  float beta = atan(pointRotated.y, pointRotated.x);
  float gamma = round(beta / alpha) * alpha; // angle in sector
  c = cos(-gamma);
  s = sin(-gamma);
  vec2 inSector = vec2(c * pointRotated.x - s * pointRotated.y, abs(s * pointRotated.x + c * pointRotated.y));
  vec2 tipToPoint = inSector + vec2(-radius, 0.);
  vec2 edgeNormal = vec2(radius2 * sin(alpha * 0.5), -radius2 * cos(alpha * 0.5) + radius);
  return dot(normalize(edgeNormal), tipToPoint);
}`,r.functions.regularDistanceField=`float regularDistanceField(vec2 point, float numPoints, float radius, float angle) {
  float startAngle = -PI * 0.5 + angle; // tip starts upwards and rotates clockwise with angle
  float c = cos(startAngle);
  float s = sin(startAngle);
  vec2 pointRotated = vec2(c * point.x - s * point.y, s * point.x + c * point.y);
  float alpha = TWO_PI / numPoints; // the angle of one sector
  float radiusIn = radius * cos(PI / numPoints);
  float beta = atan(pointRotated.y, pointRotated.x);
  float gamma = round((beta - alpha * 0.5) / alpha) * alpha + alpha * 0.5; // angle in sector from mid
  c = cos(-gamma);
  s = sin(-gamma);
  vec2 inSector = vec2(c * pointRotated.x - s * pointRotated.y, abs(s * pointRotated.x + c * pointRotated.y));
  return inSector.x - radiusIn;
}`,FA(n,e,r,"shape-");let i=null;"shape-opacity"in n&&(i=Jt(r,n["shape-opacity"],It));let s="coordsPx";"shape-scale"in n&&(s=`coordsPx / ${Jt(r,n["shape-scale"],Oa)}`);let a=null;"shape-fill-color"in n&&(a=Jt(r,n["shape-fill-color"],wr));let o=null;"shape-stroke-color"in n&&(o=Jt(r,n["shape-stroke-color"],wr));let l=null;"shape-stroke-width"in n&&(l=Jt(r,n["shape-stroke-width"],It));const c=Jt(r,n["shape-points"],It);let h="0.";"shape-angle"in n&&(h=Jt(r,n["shape-angle"],It));let g,m=Jt(r,n["shape-radius"],It);if(l!==null&&(m=`${m} + ${l} * 0.5`),"shape-radius2"in n){let _=Jt(r,n["shape-radius2"],It);l!==null&&(_=`${_} + ${l} * 0.5`),g=`starDistanceField(${s}, ${c}, ${m}, ${_}, ${h})`}else g=`regularDistanceField(${s}, ${c}, ${m}, ${h})`;const y=Hj(g,a,o,l,i);e.setSymbolColorExpression(y)}function UK(n,e,t,r){let i="vec4(1.0)";"icon-color"in n&&(i=Jt(r,n["icon-color"],wr)),"icon-opacity"in n&&(i=`${i} * vec4(1.0, 1.0, 1.0, ${Jt(r,n["icon-opacity"],It)})`);const s=Z_(n["icon-src"]),a=VA(n,e,t,"icon-",s);if(e.setSymbolColorExpression(`${i} * texture2D(u_texture${s}, v_texCoord)`).setSymbolSizeExpression(a),"icon-width"in n&&"icon-height"in n&&e.setSymbolSizeExpression(`vec2(${Jt(r,n["icon-width"],It)}, ${Jt(r,n["icon-height"],It)})`),"icon-offset"in n&&"icon-size"in n){const o=Jt(r,n["icon-size"],$s),l=e.getSymbolSizeExpression();e.setSymbolSizeExpression(o);const c=BA(n,"icon-",r,"v_quadSizePx",o);e.setTextureCoordinateExpression(`(vec4((${c}).xyxy) + vec4(0., 0., ${o})) / (${l}).xyxy`)}if(FA(n,e,r,"icon-"),"icon-anchor"in n){const o=Jt(r,n["icon-anchor"],$s);let l="1.0";"icon-scale"in n&&(l=Jt(r,n["icon-scale"],Oa));let c;n["icon-anchor-x-units"]==="pixels"&&n["icon-anchor-y-units"]==="pixels"?c=`${o} * ${l}`:n["icon-anchor-x-units"]==="pixels"?c=`${o} * vec2(vec2(${l}).x, v_quadSizePx.y)`:n["icon-anchor-y-units"]==="pixels"?c=`${o} * vec2(v_quadSizePx.x, vec2(${l}).x)`:c=`${o} * v_quadSizePx`;let h=`v_quadSizePx * vec2(0.5, -0.5) + ${c} * vec2(-1., 1.)`;if("icon-anchor-origin"in n)switch(n["icon-anchor-origin"]){case"top-right":h=`v_quadSizePx * -0.5 + ${c}`;break;case"bottom-left":h=`v_quadSizePx * 0.5 - ${c}`;break;case"bottom-right":h=`v_quadSizePx * vec2(-0.5, 0.5) + ${c} * vec2(1., -1.)`;break}e.setSymbolOffsetExpression(`${e.getSymbolOffsetExpression()} + ${h}`)}}function $K(n,e,t,r){if("stroke-color"in n&&e.setStrokeColorExpression(Jt(r,n["stroke-color"],wr)),"stroke-pattern-src"in n){const i=Z_(n["stroke-pattern-src"]),s=VA(n,e,t,"stroke-pattern-",i);let a=s,o="vec2(0.)";"stroke-pattern-offset"in n&&"stroke-pattern-size"in n&&(a=Jt(r,n["stroke-pattern-size"],$s),o=BA(n,"stroke-pattern-",r,s,a));let l="0.";"stroke-pattern-spacing"in n&&(l=Jt(r,n["stroke-pattern-spacing"],It));let c="0.";"stroke-pattern-start-offset"in n&&(c=Jt(r,n["stroke-pattern-start-offset"],It)),r.functions.sampleStrokePattern=`vec4 sampleStrokePattern(sampler2D texture, vec2 textureSize, vec2 textureOffset, vec2 sampleSize, float spacingPx, float startOffsetPx, float currentLengthPx, float currentRadiusRatio, float lineWidth) {
  float currentLengthScaled = (currentLengthPx - startOffsetPx) * sampleSize.y / lineWidth;
  float spacingScaled = spacingPx * sampleSize.y / lineWidth;
  float uCoordPx = mod(currentLengthScaled, (sampleSize.x + spacingScaled));
  float isInsideOfPattern = step(uCoordPx, sampleSize.x);
  float vCoordPx = (-currentRadiusRatio * 0.5 + 0.5) * sampleSize.y;
  // make sure that we're not sampling too close to the borders to avoid interpolation with outside pixels
  uCoordPx = clamp(uCoordPx, 0.5, sampleSize.x - 0.5);
  vCoordPx = clamp(vCoordPx, 0.5, sampleSize.y - 0.5);
  vec2 texCoord = (vec2(uCoordPx, vCoordPx) + textureOffset) / textureSize;
  return texture2D(texture, texCoord) * vec4(1.0, 1.0, 1.0, isInsideOfPattern);
}`;const h=`u_texture${i}`;let g="1.";"stroke-color"in n&&(g=e.getStrokeColorExpression()),e.setStrokeColorExpression(`${g} * sampleStrokePattern(${h}, ${s}, ${o}, ${a}, ${l}, ${c}, currentLengthPx, currentRadiusRatio, v_width)`),r.functions.computeStrokePatternLength=`float computeStrokePatternLength(vec2 sampleSize, float spacingPx, float lineWidth) {
  float patternLengthPx = sampleSize.x / sampleSize.y * lineWidth;
  return patternLengthPx + spacingPx;
}`,e.setStrokePatternLengthExpression(`computeStrokePatternLength(${a}, ${l}, v_width)`)}if("stroke-width"in n&&e.setStrokeWidthExpression(Jt(r,n["stroke-width"],It)),"stroke-offset"in n&&e.setStrokeOffsetExpression(Jt(r,n["stroke-offset"],It)),"stroke-line-cap"in n&&e.setStrokeCapExpression(Jt(r,n["stroke-line-cap"],fi)),"stroke-line-join"in n&&e.setStrokeJoinExpression(Jt(r,n["stroke-line-join"],fi)),"stroke-miter-limit"in n&&e.setStrokeMiterLimitExpression(Jt(r,n["stroke-miter-limit"],It)),"stroke-line-dash"in n){r.functions.getSingleDashDistance=`float getSingleDashDistance(float distance, float radius, float dashOffset, float dashLength, float dashLengthTotal, float capType, float lineWidth) {
  float localDistance = mod(distance, dashLengthTotal);
  float distanceSegment = abs(localDistance - dashOffset - dashLength * 0.5) - dashLength * 0.5;
  distanceSegment = min(distanceSegment, dashLengthTotal - localDistance);
  if (capType == ${Gl("square")}) {
    distanceSegment -= lineWidth * 0.5;
  } else if (capType == ${Gl("round")}) {
    distanceSegment = min(distanceSegment, sqrt(distanceSegment * distanceSegment + radius * radius) - lineWidth * 0.5);
  }
  return distanceSegment;
}`;let i=n["stroke-line-dash"].map(_=>Jt(r,_,It));i.length%2===1&&(i=[...i,...i]);let s="0.";"stroke-line-dash-offset"in n&&(s=Jt(r,n["stroke-line-dash-offset"],It));const o=`dashDistanceField_${Z_(n["stroke-line-dash"])}`,l=i.map((_,x)=>`float dashLength${x}`).join(", "),c=i.map((_,x)=>`dashLength${x}`).join(" + ");let h="0.",g=`getSingleDashDistance(distance, radius, ${h}, dashLength0, totalDashLength, capType, lineWidth)`;for(let _=2;_<i.length;_+=2)h=`${h} + dashLength${_-2} + dashLength${_-1}`,g=`min(${g}, getSingleDashDistance(distance, radius, ${h}, dashLength${_}, totalDashLength, capType, lineWidth))`;r.functions[o]=`float ${o}(float distance, float radius, float capType, float lineWidth, ${l}) {
  float totalDashLength = ${c};
  return ${g};
}`;const m=i.map((_,x)=>`${_}`).join(", ");e.setStrokeDistanceFieldExpression(`${o}(currentLengthPx + ${s}, currentRadiusPx, capType, v_width, ${m})`);let y=i.join(" + ");e.getStrokePatternLengthExpression()&&(r.functions.combinePatternLengths=`float combinePatternLengths(float patternLength1, float patternLength2) {
  return patternLength1 * patternLength2;
}`,y=`combinePatternLengths(${e.getStrokePatternLengthExpression()}, ${y})`),e.setStrokePatternLengthExpression(y)}}function WK(n,e,t,r){if("fill-color"in n&&e.setFillColorExpression(Jt(r,n["fill-color"],wr)),"fill-pattern-src"in n){const i=Z_(n["fill-pattern-src"]),s=VA(n,e,t,"fill-pattern-",i);let a=s,o="vec2(0.)";"fill-pattern-offset"in n&&"fill-pattern-size"in n&&(a=Jt(r,n["fill-pattern-size"],$s),o=BA(n,"fill-pattern-",r,s,a)),r.functions.sampleFillPattern=`vec4 sampleFillPattern(sampler2D texture, vec2 textureSize, vec2 textureOffset, vec2 sampleSize, vec2 pxOrigin, vec2 pxPosition) {
  float scaleRatio = pow(2., mod(u_zoom + 0.5, 1.) - 0.5);
  vec2 pxRelativePos = pxPosition - pxOrigin;
  // rotate the relative position from origin by the current view rotation
  pxRelativePos = vec2(pxRelativePos.x * cos(u_rotation) - pxRelativePos.y * sin(u_rotation), pxRelativePos.x * sin(u_rotation) + pxRelativePos.y * cos(u_rotation));
  // sample position is computed according to the sample offset & size
  vec2 samplePos = mod(pxRelativePos / scaleRatio, sampleSize);
  // also make sure that we're not sampling too close to the borders to avoid interpolation with outside pixels
  samplePos = clamp(samplePos, vec2(0.5), sampleSize - vec2(0.5));
  samplePos.y = sampleSize.y - samplePos.y; // invert y axis so that images appear upright
  return texture2D(texture, (samplePos + textureOffset) / textureSize);
}`;const l=`u_texture${i}`;let c="1.";"fill-color"in n&&(c=e.getFillColorExpression()),e.setFillColorExpression(`${c} * sampleFillPattern(${l}, ${s}, ${o}, ${a}, pxOrigin, pxPos)`)}}function YN(n,e,t){const r=Vj(),i=new Wj,s={};if("icon-src"in n?UK(n,i,s,r):"shape-points"in n?zK(n,i,s,r):"circle-radius"in n&&GK(n,i,s,r),$K(n,i,s,r),WK(n,i,s,r),t){const l=Jt(r,t,ei);i.setFragmentDiscardExpression(`!${l}`)}const a={};function o(l,c,h,g){if(!r[l])return;const m=vT(h),y=DA(h);i.addAttribute(`a_${c}`,m),a[c]={size:y,callback:g}}return o("geometryType",Gj,fi,l=>Cp(EA(l.getGeometry()))),o("featureId",Bj,fi|It,l=>{const c=l.getId()??null;return typeof c=="string"?Cp(c):c}),zj(i,r),{builder:i,attributes:{...a,...$j(r)},uniforms:{...s,...Uj(r,e)}}}const HK=[];let US;function KK(){return US||(US=OK()),US}let XK=0;const Ra={POSITION:"a_position",LOCAL_POSITION:"a_localPosition",SEGMENT_START:"a_segmentStart",SEGMENT_END:"a_segmentEnd",MEASURE_START:"a_measureStart",MEASURE_END:"a_measureEnd",ANGLE_TANGENT_SUM:"a_angleTangentSum",JOIN_ANGLES:"a_joinAngles",DISTANCE_LOW:"a_distanceLow",DISTANCE_HIGH:"a_distanceHigh"};class qK{constructor(e,t,r,i){this.helper_,this.hitDetectionEnabled_=!!i,this.styleShaders=YK(e,t),this.customAttributes_={},this.uniforms_={},this.hitDetectionEnabled_&&(this.customAttributes_.hitColor={callback(){return DK(this.ref,HK)},size:2});for(const s of this.styleShaders){for(const a in s.attributes)a in this.customAttributes_||(this.customAttributes_[a]=s.attributes[a]);for(const a in s.uniforms)a in this.uniforms_||(this.uniforms_[a]=s.uniforms[a])}this.renderPasses_=this.styleShaders.map(s=>{const a={},o=Object.entries(this.customAttributes_).map(([l,c])=>({name:l in s.attributes||l==="hitColor"?`a_${l}`:null,size:c.size||1,type:Fi.FLOAT}));return s.builder.getFillVertexShader()&&(a.fillRenderPass={vertexShader:s.builder.getFillVertexShader(),fragmentShader:s.builder.getFillFragmentShader(),attributesDesc:[{name:Ra.POSITION,size:2,type:Fi.FLOAT},...o],instancedAttributesDesc:[],instancePrimitiveVertexCount:3}),s.builder.getStrokeVertexShader()&&(a.strokeRenderPass={vertexShader:s.builder.getStrokeVertexShader(),fragmentShader:s.builder.getStrokeFragmentShader(),attributesDesc:[{name:Ra.LOCAL_POSITION,size:2,type:Fi.FLOAT}],instancedAttributesDesc:[{name:Ra.SEGMENT_START,size:2,type:Fi.FLOAT},{name:Ra.MEASURE_START,size:1,type:Fi.FLOAT},{name:Ra.SEGMENT_END,size:2,type:Fi.FLOAT},{name:Ra.MEASURE_END,size:1,type:Fi.FLOAT},{name:Ra.JOIN_ANGLES,size:2,type:Fi.FLOAT},{name:Ra.DISTANCE_LOW,size:1,type:Fi.FLOAT},{name:Ra.DISTANCE_HIGH,size:1,type:Fi.FLOAT},{name:Ra.ANGLE_TANGENT_SUM,size:1,type:Fi.FLOAT},...o],instancePrimitiveVertexCount:6}),s.builder.getSymbolVertexShader()&&(a.symbolRenderPass={vertexShader:s.builder.getSymbolVertexShader(),fragmentShader:s.builder.getSymbolFragmentShader(),attributesDesc:[{name:Ra.LOCAL_POSITION,size:2,type:Fi.FLOAT}],instancedAttributesDesc:[{name:Ra.POSITION,size:2,type:Fi.FLOAT},...o],instancePrimitiveVertexCount:6}),a}),this.hasFill_=this.renderPasses_.some(s=>s.fillRenderPass),this.hasStroke_=this.renderPasses_.some(s=>s.strokeRenderPass),this.hasSymbol_=this.renderPasses_.some(s=>s.symbolRenderPass),this.setHelper(r)}async generateBuffers(e,t){if(e.isEmpty())return null;const r=this.generateRenderInstructions_(e,t),[i,s,a]=await Promise.all([this.generateBuffersForType_(r.polygonInstructions,"Polygon",t),this.generateBuffersForType_(r.lineStringInstructions,"LineString",t),this.generateBuffersForType_(r.pointInstructions,"Point",t)]),o=wp(gi(),t);return{polygonBuffers:i,lineStringBuffers:s,pointBuffers:a,invertVerticesTransform:o}}generateRenderInstructions_(e,t){const r=this.hasFill_?BK(e.polygonBatch,new Float32Array(0),this.customAttributes_,t):null,i=this.hasStroke_?VK(e.lineStringBatch,new Float32Array(0),this.customAttributes_,t):null,s=this.hasSymbol_?FK(e.pointBatch,new Float32Array(0),this.customAttributes_,t):null;return{polygonInstructions:r,lineStringInstructions:i,pointInstructions:s}}generateBuffersForType_(e,t,r){if(e===null)return null;const i=XK++;let s;switch(t){case"Polygon":s=zS.GENERATE_POLYGON_BUFFERS;break;case"LineString":s=zS.GENERATE_LINE_STRING_BUFFERS;break;case"Point":s=zS.GENERATE_POINT_BUFFERS;break}const a={id:i,type:s,renderInstructions:e.buffer,renderInstructionsTransform:r,customAttributesSize:Dw(this.customAttributes_)},o=KK();return o.postMessage(a,[e.buffer]),e=null,new Promise(l=>{const c=h=>{const g=h.data;if(g.id!==i||(o.removeEventListener("message",c),!this.helper_.getGL()))return;const m=new DS(IA,OS).fromArrayBuffer(g.indicesBuffer),y=new DS(H_,OS).fromArrayBuffer(g.vertexAttributesBuffer),_=new DS(H_,OS).fromArrayBuffer(g.instanceAttributesBuffer);this.helper_.flushBufferData(m),this.helper_.flushBufferData(y),this.helper_.flushBufferData(_),l([m,y,_])};o.addEventListener("message",c)})}render(e,t,r){for(const i of this.renderPasses_)i.fillRenderPass&&this.renderInternal_(e.polygonBuffers[0],e.polygonBuffers[1],e.polygonBuffers[2],i.fillRenderPass,t,r),i.strokeRenderPass&&this.renderInternal_(e.lineStringBuffers[0],e.lineStringBuffers[1],e.lineStringBuffers[2],i.strokeRenderPass,t,r),i.symbolRenderPass&&this.renderInternal_(e.pointBuffers[0],e.pointBuffers[1],e.pointBuffers[2],i.symbolRenderPass,t,r)}renderInternal_(e,t,r,i,s,a){const o=e.getSize();if(o===0)return;const l=i.instancedAttributesDesc.length;if(this.helper_.useProgram(i.program,s),this.helper_.bindBuffer(t),this.helper_.bindBuffer(e),this.helper_.enableAttributes(i.attributesDesc),this.helper_.bindBuffer(r),this.helper_.enableAttributesInstanced(i.instancedAttributesDesc),a(),l){const c=i.instancedAttributesDesc.reduce((g,m)=>g+(m.size||1),0),h=r.getSize()/c;this.helper_.drawElementsInstanced(0,o,h)}else this.helper_.drawElements(0,o)}setHelper(e,t=null){this.helper_=e;for(const r of this.renderPasses_)r.fillRenderPass&&(r.fillRenderPass.program=this.helper_.getProgram(r.fillRenderPass.fragmentShader,r.fillRenderPass.vertexShader)),r.strokeRenderPass&&(r.strokeRenderPass.program=this.helper_.getProgram(r.strokeRenderPass.fragmentShader,r.strokeRenderPass.vertexShader)),r.symbolRenderPass&&(r.symbolRenderPass.program=this.helper_.getProgram(r.symbolRenderPass.fragmentShader,r.symbolRenderPass.vertexShader));this.helper_.addUniforms(this.uniforms_),t&&(t.polygonBuffers&&(this.helper_.flushBufferData(t.polygonBuffers[0]),this.helper_.flushBufferData(t.polygonBuffers[1]),this.helper_.flushBufferData(t.polygonBuffers[2])),t.lineStringBuffers&&(this.helper_.flushBufferData(t.lineStringBuffers[0]),this.helper_.flushBufferData(t.lineStringBuffers[1]),this.helper_.flushBufferData(t.lineStringBuffers[2])),t.pointBuffers&&(this.helper_.flushBufferData(t.pointBuffers[0]),this.helper_.flushBufferData(t.pointBuffers[1]),this.helper_.flushBufferData(t.pointBuffers[2])))}}function YK(n,e){const t=Array.isArray(n)?n:[n];if("style"in t[0]){const r=[],i=t,s=[];for(const a of i){const o=Array.isArray(a.style)?a.style:[a.style];let l=a.filter;a.else&&s.length&&(l=["all",...s.map(h=>["!",h])],a.filter&&l.push(a.filter),l.length<3&&(l=l[1])),a.filter&&s.push(a.filter);const c=o.map(h=>YN(h,e,l));r.push(...c)}return r}return"builder"in t[0]?t:t.map(r=>YN(r,e,null))}const $o=new Uint8Array(4);class ZK{constructor(e,t){this.helper_=e;const r=e.getGL();this.texture_=r.createTexture(),this.framebuffer_=r.createFramebuffer(),this.depthbuffer_=r.createRenderbuffer(),this.size_=t||[1,1],this.data_=new Uint8Array(0),this.dataCacheDirty_=!0,this.updateSize_()}setSize(e){gc(e,this.size_)||(this.size_[0]=e[0],this.size_[1]=e[1],this.updateSize_())}getSize(){return this.size_}clearCachedData(){this.dataCacheDirty_=!0}readAll(){if(this.dataCacheDirty_){const e=this.size_,t=this.helper_.getGL();t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer_),t.readPixels(0,0,e[0],e[1],t.RGBA,t.UNSIGNED_BYTE,this.data_),this.dataCacheDirty_=!1}return this.data_}readPixel(e,t){if(e<0||t<0||e>this.size_[0]||t>=this.size_[1])return $o[0]=0,$o[1]=0,$o[2]=0,$o[3]=0,$o;this.readAll();const r=Math.floor(e)+(this.size_[1]-Math.floor(t)-1)*this.size_[0];return $o[0]=this.data_[r*4],$o[1]=this.data_[r*4+1],$o[2]=this.data_[r*4+2],$o[3]=this.data_[r*4+3],$o}getTexture(){return this.texture_}getFramebuffer(){return this.framebuffer_}getDepthbuffer(){return this.depthbuffer_}updateSize_(){const e=this.size_,t=this.helper_.getGL();this.texture_=this.helper_.createTexture(e,null,this.texture_),t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer_),t.viewport(0,0,e[0],e[1]),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.texture_,0),t.bindRenderbuffer(t.RENDERBUFFER,this.depthbuffer_),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,e[0],e[1]),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,this.depthbuffer_),this.data_=new Uint8Array(e[0]*e[1]*4)}}function JK(n,e){const t=n.viewState.projection,i=e.getSource().getWrapX()&&t.canWrapX(),s=t.getExtent(),a=n.extent,o=i?yn(s):null,l=i?Math.ceil((a[2]-s[2])/o)+1:1;return[i?Math.floor((a[0]-s[0])/o):0,l,o]}const Cf={...Vl,RENDER_EXTENT:"u_renderExtent",PATTERN_ORIGIN:"u_patternOrigin",GLOBAL_ALPHA:"u_globalAlpha"};class QK extends NA{constructor(e,t){const r={[Cf.RENDER_EXTENT]:[0,0,0,0],[Cf.PATTERN_ORIGIN]:[0,0],[Cf.GLOBAL_ALPHA]:1};super(e,{uniforms:r,postProcesses:t.postProcesses}),this.hitDetectionEnabled_=!t.disableHitDetection,this.hitRenderTarget_,this.sourceRevision_=-1,this.previousExtent_=zs(),this.currentTransform_=gi(),this.tmpCoords_=[0,0],this.tmpTransform_=gi(),this.tmpMat4_=Cj(),this.currentFrameStateTransform_=gi(),this.styleVariables_={},this.style_=[],this.styleRenderer_=null,this.buffers_=null,this.applyOptions_(t),this.batch_=new Y_,this.initialFeaturesAdded_=!1,this.sourceListenKeys_=null}addInitialFeatures_(e){const t=this.getLayer().getSource();let r;this.batch_.addFeatures(t.getFeatures(),r),this.sourceListenKeys_=[pn(t,is.ADDFEATURE,this.handleSourceFeatureAdded_.bind(this,r)),pn(t,is.CHANGEFEATURE,this.handleSourceFeatureChanged_.bind(this,r),this),pn(t,is.REMOVEFEATURE,this.handleSourceFeatureDelete_,this),pn(t,is.CLEAR,this.handleSourceFeatureClear_,this)]}applyOptions_(e){this.styleVariables_=e.variables,this.style_=e.style}createRenderers_(){this.buffers_=null,this.styleRenderer_=new qK(this.style_,this.styleVariables_,this.helper,this.hitDetectionEnabled_)}reset(e){this.applyOptions_(e),this.helper&&this.createRenderers_(),super.reset(e)}afterHelperCreated(){this.styleRenderer_?this.styleRenderer_.setHelper(this.helper,this.buffers_):this.createRenderers_(),this.hitDetectionEnabled_&&(this.hitRenderTarget_=new ZK(this.helper))}handleSourceFeatureAdded_(e,t){const r=t.feature;this.batch_.addFeature(r,e)}handleSourceFeatureChanged_(e,t){const r=t.feature;this.batch_.changeFeature(r,e)}handleSourceFeatureDelete_(e){const t=e.feature;this.batch_.removeFeature(t)}handleSourceFeatureClear_(){this.batch_.clear()}applyUniforms_(e){jD(this.tmpTransform_,this.currentFrameStateTransform_),DD(this.tmpTransform_,e),this.helper.setUniformMatrixValue(Cf.PROJECTION_MATRIX,yT(this.tmpMat4_,this.tmpTransform_)),wp(this.tmpTransform_,this.tmpTransform_),this.helper.setUniformMatrixValue(Cf.SCREEN_TO_WORLD_MATRIX,yT(this.tmpMat4_,this.tmpTransform_)),this.tmpCoords_[0]=0,this.tmpCoords_[1]=0,wp(this.tmpTransform_,e),Fr(this.tmpTransform_,this.tmpCoords_),this.helper.setUniformFloatVec2(Cf.PATTERN_ORIGIN,this.tmpCoords_)}renderFrame(e){const t=this.helper.getGL();this.preRender(t,e);const[r,i,s]=JK(e,this.getLayer());this.helper.prepareDraw(e),this.renderWorlds(e,!1,r,i,s),this.helper.finalizeDraw(e,this.dispatchPreComposeEvent,this.dispatchPostComposeEvent);const a=this.helper.getCanvas();return this.hitDetectionEnabled_&&(this.renderWorlds(e,!0,r,i,s),this.hitRenderTarget_.clearCachedData()),this.postRender(t,e),a}prepareFrameInternal(e){this.initialFeaturesAdded_||(this.addInitialFeatures_(e),this.initialFeaturesAdded_=!0);const t=this.getLayer(),r=t.getSource(),i=e.viewState,s=!e.viewHints[Qr.ANIMATING]&&!e.viewHints[Qr.INTERACTING],a=!ad(this.previousExtent_,e.extent),o=this.sourceRevision_<r.getRevision();if(o&&(this.sourceRevision_=r.getRevision()),s&&(a||o)){const l=i.projection,c=i.resolution,h=t instanceof Lw?t.getRenderBuffer():0,g=Xl(e.extent,h*c);r.loadFeatures(g,c,l),this.ready=!1;const m=this.helper.makeProjectionTransform(e,gi());this.styleRenderer_.generateBuffers(this.batch_,m).then(y=>{this.buffers_&&this.disposeBuffers(this.buffers_),this.buffers_=y,this.ready=!0,this.getLayer().changed()}),this.previousExtent_=e.extent.slice()}return!0}renderWorlds(e,t,r,i,s){let a=r;t&&(this.hitRenderTarget_.setSize([Math.floor(e.size[0]/2),Math.floor(e.size[1]/2)]),this.helper.prepareDrawToRenderTarget(e,this.hitRenderTarget_,!0));do this.helper.makeProjectionTransform(e,this.currentFrameStateTransform_),E$(this.currentFrameStateTransform_,a*s,0),this.buffers_&&this.styleRenderer_.render(this.buffers_,e,()=>{this.applyUniforms_(this.buffers_.invertVerticesTransform),this.helper.applyHitDetectionUniform(t)});while(++a<i)}forEachFeatureAtCoordinate(e,t,r,i,s){if(Rn(this.hitDetectionEnabled_,"`forEachFeatureAtCoordinate` cannot be used on a WebGL layer if the hit detection logic has been disabled using the `disableHitDetection: true` option."),!this.styleRenderer_||!this.hitDetectionEnabled_)return;const a=Fr(t.coordinateToPixelTransform,e.slice()),o=this.hitRenderTarget_.readPixel(a[0]/2,a[1]/2),l=[o[0]/255,o[1]/255,o[2]/255,o[3]/255],c=jK(l),h=this.batch_.getFeatureFromRef(c);if(h)return i(h,this.getLayer(),null)}disposeBuffers(e){const t=r=>{for(const i of r)i&&this.helper.deleteBuffer(i)};e.pointBuffers&&t(e.pointBuffers),e.lineStringBuffers&&t(e.lineStringBuffers),e.polygonBuffers&&t(e.polygonBuffers)}disposeInternal(){this.buffers_&&this.disposeBuffers(this.buffers_),this.sourceListenKeys_&&(this.sourceListenKeys_.forEach(function(e){or(e)}),this.sourceListenKeys_=null),super.disposeInternal()}renderDeclutter(){}}const jl={BLUR:"blur",GRADIENT:"gradient",RADIUS:"radius"},eX=["#00f","#0ff","#0f0","#ff0","#f00"];class tX extends Lw{constructor(e){e=e||{};const t=Object.assign({},e);delete t.gradient,delete t.radius,delete t.blur,delete t.weight,super(t),this.filter_=e.filter??!0,this.styleVariables_=e.variables||{},this.gradient_=null,this.addChangeListener(jl.GRADIENT,this.handleGradientChanged_),this.setGradient(e.gradient?e.gradient:eX),this.setBlur(e.blur!==void 0?e.blur:15),this.setRadius(e.radius!==void 0?e.radius:8);const r=e.weight?e.weight:"weight";this.weight_=r,this.setRenderOrder(null)}getBlur(){return this.get(jl.BLUR)}getGradient(){return this.get(jl.GRADIENT)}getRadius(){return this.get(jl.RADIUS)}handleGradientChanged_(){this.gradient_=nX(this.getGradient())}setBlur(e){const t=this.get(jl.BLUR);if(this.set(jl.BLUR,e),typeof e=="number"&&typeof t=="number"){this.changed();return}this.clearRenderer()}setGradient(e){this.set(jl.GRADIENT,e)}setRadius(e){const t=this.get(jl.RADIUS);if(this.set(jl.RADIUS,e),typeof e=="number"&&typeof t=="number"){this.changed();return}this.clearRenderer()}setFilter(e){this.filter_=e,this.changed(),this.clearRenderer()}setWeight(e){this.weight_=e,this.changed(),this.clearRenderer()}createRenderer(){const e=new Wj,t=Vj(),r=Jt(t,this.filter_,ei);let i=Jt(t,this.getRadius(),It),s=Jt(t,this.getBlur(),It);const a={};typeof this.getBlur()=="number"&&(s="a_blur",a.a_blur=()=>this.getBlur(),e.addUniform("a_blur","float")),typeof this.getRadius()=="number"&&(i="a_radius",a.a_radius=()=>this.getRadius(),e.addUniform("a_radius","float"));const o={};let l=null;if(typeof this.weight_=="string"||typeof this.weight_=="function"){const g=typeof this.weight_=="string"?m=>m.get(this.weight_):this.weight_;o.prop_weight={size:1,callback:m=>{const y=g(m);return y!==void 0?hr(y,0,1):1}},l="a_prop_weight",e.addAttribute("a_prop_weight","float")}else{const g=["clamp",this.weight_,0,1];l=Jt(t,g,It)}e.addFragmentShaderFunction(`float getBlurSlope() {
  float blur = max(1., ${s});
  float radius = ${i};
  return radius / blur;
}`).setSymbolSizeExpression(`vec2(${i} + ${s}) * 2.`).setSymbolColorExpression(`vec4(smoothstep(0., 1., (1. - length(coordsPx * 2. / v_quadSizePx)) * getBlurSlope()) * ${l})`).setStrokeColorExpression(`vec4(smoothstep(0., 1., (1. - length(currentRadiusPx * 2. / v_width)) * getBlurSlope()) * ${l})`).setStrokeWidthExpression(`(${i} + ${s}) * 2.`).setFillColorExpression(`vec4(${l})`).setFragmentDiscardExpression(`!${r}`),zj(e,t);const c=$j(t),h=Uj(t,this.styleVariables_);return new QK(this,{className:this.getClassName(),variables:this.styleVariables_,style:{builder:e,attributes:{...c,...o},uniforms:{...h,...a}},disableHitDetection:!1,postProcesses:[{fragmentShader:`
            precision mediump float;

            uniform sampler2D u_image;
            uniform sampler2D u_gradientTexture;
            uniform float u_opacity;

            varying vec2 v_texCoord;

            void main() {
              vec4 color = texture2D(u_image, v_texCoord);
              gl_FragColor.a = color.a * u_opacity;
              gl_FragColor.rgb = texture2D(u_gradientTexture, vec2(0.5, color.a)).rgb;
              gl_FragColor.rgb *= gl_FragColor.a;
            }`,uniforms:{u_gradientTexture:()=>this.gradient_,u_opacity:()=>this.getOpacity()}}]})}updateStyleVariables(e){Object.assign(this.styleVariables_,e),this.changed()}renderDeclutter(){}}function nX(n){const r=ri(1,256),i=r.createLinearGradient(0,0,1,256),s=1/(n.length-1);for(let a=0,o=n.length;a<o;++a)i.addColorStop(a*s,n[a]);return r.fillStyle=i,r.fillRect(0,0,1,256),r.canvas}class rX extends _A{constructor(e){super(e),this.image=null}getImage(){return this.image?this.image.getImage():null}prepareFrame(e){const t=e.layerStatesArray[e.layerIndex],r=e.pixelRatio,i=e.viewState,s=i.resolution,a=this.getLayer().getSource(),o=e.viewHints;let l=e.extent;if(t.extent!==void 0&&(l=ql(l,Jo(t.extent,i.projection))),!o[Qr.ANIMATING]&&!o[Qr.INTERACTING]&&!sg(l))if(a){const c=i.projection,h=a.getImage(l,s,r,c);h&&(this.loadImage(h)?this.image=h:h.getState()===Rt.EMPTY&&(this.image=null))}else this.image=null;return!!this.image}getData(e){const t=this.frameState;if(!t)return null;const r=this.getLayer(),i=Fr(t.pixelToCoordinateTransform,e.slice()),s=r.getExtent();if(s&&!sd(s,i))return null;const a=this.image.getExtent(),o=this.image.getImage(),l=yn(a),c=Math.floor(o.width*((i[0]-a[0])/l));if(c<0||c>=o.width)return null;const h=ti(a),g=Math.floor(o.height*((a[3]-i[1])/h));return g<0||g>=o.height?null:this.getImageData(o,c,g)}renderFrame(e,t){const r=this.image,i=r.getExtent(),s=r.getResolution(),[a,o]=Array.isArray(s)?s:[s,s],l=r.getPixelRatio(),c=e.layerStatesArray[e.layerIndex],h=e.pixelRatio,g=e.viewState,m=g.center,y=g.resolution,_=h*a/(y*l),x=h*o/(y*l);this.prepareContainer(e,t);const w=this.context.canvas.width,b=this.context.canvas.height,T=this.getRenderContext(e);let k=!1,L=!0;if(c.extent){const P=Jo(c.extent,g.projection);L=vs(P,e.extent),k=L&&!uu(P,e.extent),k&&this.clipUnrotated(T,e,P)}const O=r.getImage(),B=Ga(this.tempTransform,w/2,b/2,_,x,0,l*(i[0]-m[0])/a,l*(m[1]-i[3])/o);this.renderedResolution=o*h/l;const R=O.width*B[0],A=O.height*B[3];if(this.getLayer().getSource().getInterpolate()||(T.imageSmoothingEnabled=!1),this.preRender(T,e),L&&R>=.5&&A>=.5){const P=B[4],D=B[5],N=c.opacity;N!==1&&(T.save(),T.globalAlpha=N),T.drawImage(O,0,0,+O.width,+O.height,P,D,R,A),N!==1&&T.restore()}return this.postRender(this.context,e),k&&T.restore(),T.imageSmoothingEnabled=!0,this.container}}class iX extends T1{constructor(e){e=e||{},super(e)}}class sX extends iX{constructor(e){super(e)}createRenderer(){return new rX(this)}getData(e){return super.getData(e)}}function $S(n,e,t){if(!(t in n))return n[t]=new Set([e]),!0;const r=n[t],i=r.has(e);return i||r.add(e),!i}function aX(n,e,t){const r=n[t];return r?r.delete(e):!1}function ZN(n,e){const t=n.layerStatesArray[n.layerIndex];t.extent&&(e=ql(e,Jo(t.extent,n.viewState.projection)));const r=t.layer.getRenderSource();if(!r.getWrapX()){const i=r.getTileGridForProjection(n.viewState.projection).getExtent();i&&(e=ql(e,i))}return e}class oX extends _A{constructor(e,t){super(e),t=t||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=zs(),this.tempTileRange_=new PA(0,0,0,0),this.tempTileCoord_=q_(0,0,0);const r=t.cacheSize!==void 0?t.cacheSize:512;this.tileCache_=new XN(r),this.sourceTileCache_=null,this.maxStaleKeys=r*.5}getTileCache(){return this.tileCache_}getSourceTileCache(){return this.sourceTileCache_||(this.sourceTileCache_=new XN(512)),this.sourceTileCache_}getOrCreateTile(e,t,r,i){const s=this.tileCache_,o=this.getLayer().getSource(),l=r_(o,o.getKey(),e,t,r);let c;if(s.containsKey(l))c=s.get(l);else{const h=i.viewState.projection,g=o.getProjection();if(c=o.getTile(e,t,r,i.pixelRatio,h,!g||Zh(g,h)?void 0:this.getSourceTileCache()),!c)return null;s.set(l,c)}return c}getTile(e,t,r,i){const s=this.getOrCreateTile(e,t,r,i);return s||null}getData(e){const t=this.frameState;if(!t)return null;const r=this.getLayer(),i=Fr(t.pixelToCoordinateTransform,e.slice()),s=r.getExtent();if(s&&!sd(s,i))return null;const a=t.viewState,o=r.getRenderSource(),l=o.getTileGridForProjection(a.projection),c=o.getTilePixelRatio(t.pixelRatio);for(let h=l.getZForResolution(a.resolution);h>=l.getMinZoom();--h){const g=l.getTileCoordForCoordAndZ(i,h),m=this.getTile(h,g[1],g[2],t);if(!m||m.getState()!==Bt.LOADED)continue;const y=l.getOrigin(h),_=Es(l.getTileSize(h)),x=l.getResolution(h);let w;if(m instanceof Mj||m instanceof jj)w=m.getImage();else if(m instanceof WN){if(w=xT(m.getData()),!w)continue}else continue;const b=Math.floor(c*((i[0]-y[0])/x-g[1]*_[0])),T=Math.floor(c*((y[1]-i[1])/x-g[2]*_[1])),k=Math.round(c*o.getGutterForProjection(a.projection));return this.getImageData(w,b+k,T+k)}return null}prepareFrame(e){this.renderedProjection?e.viewState.projection!==this.renderedProjection&&(this.tileCache_.clear(),this.renderedProjection=e.viewState.projection):this.renderedProjection=e.viewState.projection;const t=this.getLayer().getSource();if(!t)return!1;const r=t.getRevision();return this.renderedSourceRevision_?this.renderedSourceRevision_!==r&&(this.renderedSourceRevision_=r,this.renderedSourceKey_===t.getKey()&&(this.tileCache_.clear(),this.sourceTileCache_?.clear())):this.renderedSourceRevision_=r,!0}enqueueTilesForNextExtent(){return!0}enqueueTiles(e,t,r,i,s){const a=e.viewState,o=this.getLayer(),l=o.getRenderSource(),c=l.getTileGridForProjection(a.projection),h=Kt(l);h in e.wantedTiles||(e.wantedTiles[h]={});const g=e.wantedTiles[h],m=o.getMapInternal(),y=Math.max(r-s,c.getMinZoom(),c.getZForResolution(Math.min(o.getMaxResolution(),m?m.getView().getResolutionForZoom(Math.max(o.getMinZoom(),0)):c.getResolution(0)),l.zDirection)),_=a.rotation,x=_?ED(a.center,a.resolution,_,e.size):void 0;for(let w=r;w>=y;--w){const b=c.getTileRangeForExtentAndZ(t,w,this.tempTileRange_),T=c.getResolution(w);for(let k=b.minX;k<=b.maxX;++k)for(let L=b.minY;L<=b.maxY;++L){if(_&&!c.tileCoordIntersectsViewport([w,k,L],x))continue;const O=this.getTile(w,k,L,e);if(!O||!$S(i,O,w))continue;const R=O.getKey();if(g[R]=!0,O.getState()===Bt.IDLE&&!e.tileQueue.isKeyQueued(R)){const A=q_(w,k,L,this.tempTileCoord_);e.tileQueue.enqueue([O,h,c.getTileCoordCenter(A),T])}}}}findStaleTile_(e,t){const r=this.tileCache_,i=e[0],s=e[1],a=e[2],o=this.getStaleKeys();for(let l=0;l<o.length;++l){const c=r_(this.getLayer().getSource(),o[l],i,s,a);if(r.containsKey(c)){const h=r.peek(c);if(h.getState()===Bt.LOADED)return h.endTransition(Kt(this)),$S(t,h,i),!0}}return!1}findAltTiles_(e,t,r,i){const s=e.getTileRangeForTileCoordAndZ(t,r,this.tempTileRange_);if(!s)return!1;let a=!0;const o=this.tileCache_,l=this.getLayer().getRenderSource(),c=l.getKey();for(let h=s.minX;h<=s.maxX;++h)for(let g=s.minY;g<=s.maxY;++g){const m=r_(l,c,r,h,g);let y=!1;if(o.containsKey(m)){const _=o.peek(m);_.getState()===Bt.LOADED&&($S(i,_,r),y=!0)}y||(a=!1)}return a}renderFrame(e,t){this.renderComplete=!0;const r=e.layerStatesArray[e.layerIndex],i=e.viewState,s=i.projection,a=i.resolution,o=i.center,l=e.pixelRatio,c=this.getLayer(),h=c.getSource(),g=h.getTileGridForProjection(s),m=g.getZForResolution(a,h.zDirection),y=g.getResolution(m),_=h.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==_&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=_):this.renderedSourceKey_=_;let x=e.extent;const w=h.getTilePixelRatio(l);this.prepareContainer(e,t);const b=this.context.canvas.width,T=this.context.canvas.height,k=r.extent&&Jo(r.extent);k&&(x=ql(x,Jo(r.extent)));const L=y*b/2/w,O=y*T/2/w,B=[o[0]-L,o[1]-O,o[0]+L,o[1]+O],R={};this.renderedTiles.length=0;const A=c.getPreload();if(e.nextExtent&&this.enqueueTilesForNextExtent()){const ue=g.getZForResolution(i.nextResolution,h.zDirection),Ne=ZN(e,e.nextExtent);this.enqueueTiles(e,Ne,ue,R,A)}const P=ZN(e,x);if(this.enqueueTiles(e,P,m,R,0),A>0&&setTimeout(()=>{this.enqueueTiles(e,P,m-1,R,A-1)},0),!(m in R))return this.container;const D=Kt(this),N=e.time;for(const ue of R[m]){const Ne=ue.getState();if(Ne===Bt.EMPTY)continue;const be=ue.tileCoord;if(Ne===Bt.LOADED&&ue.getAlpha(D,N)===1){ue.endTransition(D);continue}if(Ne!==Bt.ERROR&&(this.renderComplete=!1),this.findStaleTile_(be,R)){aX(R,ue,m),e.animate=!0;continue}if(this.findAltTiles_(g,be,m+1,R))continue;const J=g.getMinZoom();for(let te=m-1;te>=J&&!this.findAltTiles_(g,be,te,R);--te);}const G=y/a*l/w,j=this.getRenderContext(e);Ga(this.tempTransform,b/2,T/2,G,G,0,-b/2,-T/2),r.extent&&this.clipUnrotated(j,e,k),h.getInterpolate()||(j.imageSmoothingEnabled=!1),this.preRender(j,e);const ve=Object.keys(R).map(Number);ve.sort(Kl);let ce;const je=[],Pe=[];for(let ue=ve.length-1;ue>=0;--ue){const Ne=ve[ue],be=h.getTilePixelSize(Ne,l,s),V=g.getResolution(Ne)/y,J=be[0]*V*G,te=be[1]*V*G,re=g.getTileCoordForCoordAndZ(Id(B),Ne),he=g.getTileCoordExtent(re),Be=Fr(this.tempTransform,[w*(he[0]-B[0])/y,w*(B[3]-he[3])/y]),Ge=w*h.getGutterForProjection(s);for(const ye of R[Ne]){if(ye.getState()!==Bt.LOADED)continue;const pe=ye.tileCoord,Et=re[1]-pe[1],Ve=Math.round(Be[0]-(Et-1)*J),jt=re[2]-pe[2],St=Math.round(Be[1]-(jt-1)*te),Ut=Math.round(Be[0]-Et*J),Ht=Math.round(Be[1]-jt*te),tt=Ve-Ut,kn=St-Ht,ln=ve.length===1;let hn=!1;ce=[Ut,Ht,Ut+tt,Ht,Ut+tt,Ht+kn,Ut,Ht+kn];for(let sr=0,Pi=je.length;sr<Pi;++sr)if(!ln&&Ne<Pe[sr]){const Gn=je[sr];vs([Ut,Ht,Ut+tt,Ht+kn],[Gn[0],Gn[3],Gn[4],Gn[7]])&&(hn||(j.save(),hn=!0),j.beginPath(),j.moveTo(ce[0],ce[1]),j.lineTo(ce[2],ce[3]),j.lineTo(ce[4],ce[5]),j.lineTo(ce[6],ce[7]),j.moveTo(Gn[6],Gn[7]),j.lineTo(Gn[4],Gn[5]),j.lineTo(Gn[2],Gn[3]),j.lineTo(Gn[0],Gn[1]),j.clip())}je.push(ce),Pe.push(Ne),this.drawTile(ye,e,Ut,Ht,tt,kn,Ge,ln),hn&&j.restore(),this.renderedTiles.unshift(ye),this.updateUsedTiles(e.usedTiles,h,ye)}}if(this.renderedResolution=y,this.extentChanged=!this.renderedExtent_||!ad(this.renderedExtent_,B),this.renderedExtent_=B,this.renderedPixelRatio=l,this.postRender(this.context,e),r.extent&&j.restore(),j.imageSmoothingEnabled=!0,this.renderComplete){const ue=(Ne,be)=>{const ie=Kt(h),V=be.wantedTiles[ie],J=V?Object.keys(V).length:0;this.updateCacheSize(J),this.tileCache_.expireCache(),this.sourceTileCache_?.expireCache()};e.postRenderFunctions.push(ue)}return this.container}updateCacheSize(e){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,e*2)}drawTile(e,t,r,i,s,a,o,l){let c;if(e instanceof WN){if(c=xT(e.getData()),!c)throw new Error("Rendering array data is not yet supported")}else c=this.getTileImage(e);if(!c)return;const h=this.getRenderContext(t),g=Kt(this),m=t.layerStatesArray[t.layerIndex],y=m.opacity*(l?e.getAlpha(g,t.time):1),_=y!==h.globalAlpha;_&&(h.save(),h.globalAlpha=y),h.drawImage(c,o,o,c.width-2*o,c.height-2*o,r,i,s,a),_&&h.restore(),y!==m.opacity?t.animate=!0:l&&e.endTransition(g)}getImage(){const e=this.context;return e?e.canvas:null}getTileImage(e){return e.getImage()}updateUsedTiles(e,t,r){const i=Kt(t);i in e||(e[i]={}),e[i][r.getKey()]=!0}}const bx={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class lX extends T1{constructor(e){e=e||{};const t=Object.assign({},e),r=e.cacheSize;delete e.cacheSize,delete t.preload,delete t.useInterimTilesOnError,super(t),this.on,this.once,this.un,this.cacheSize_=r,this.setPreload(e.preload!==void 0?e.preload:0),this.setUseInterimTilesOnError(e.useInterimTilesOnError!==void 0?e.useInterimTilesOnError:!0)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(bx.PRELOAD)}setPreload(e){this.set(bx.PRELOAD,e)}getUseInterimTilesOnError(){return this.get(bx.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(e){this.set(bx.USE_INTERIM_TILES_ON_ERROR,e)}getData(e){return super.getData(e)}}class iu extends lX{constructor(e){super(e)}createRenderer(){return new oX(this,{cacheSize:this.getCacheSize()})}}function wT(n){return Array.isArray(n)?Math.min(...n):n}const Pf=[0,0,0],Xc=5;class Kj{constructor(e){this.minZoom=e.minZoom!==void 0?e.minZoom:0,this.resolutions_=e.resolutions,Rn(LU(this.resolutions_,(i,s)=>s-i),"`resolutions` must be sorted in descending order");let t;if(!e.origins){for(let i=0,s=this.resolutions_.length-1;i<s;++i)if(!t)t=this.resolutions_[i]/this.resolutions_[i+1];else if(this.resolutions_[i]/this.resolutions_[i+1]!==t){t=void 0;break}}this.zoomFactor_=t,this.maxZoom=this.resolutions_.length-1,this.origin_=e.origin!==void 0?e.origin:null,this.origins_=null,e.origins!==void 0&&(this.origins_=e.origins,Rn(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const r=e.extent;r!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=Id(r)),Rn(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,e.tileSizes!==void 0&&(this.tileSizes_=e.tileSizes,Rn(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=e.tileSize!==void 0?e.tileSize:this.tileSizes_?null:AA,Rn(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=r!==void 0?r:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],e.sizes!==void 0?this.fullTileRanges_=e.sizes.map((i,s)=>{const a=new PA(Math.min(0,i[0]),Math.max(i[0]-1,-1),Math.min(0,i[1]),Math.max(i[1]-1,-1));if(r){const o=this.getTileRangeForExtentAndZ(r,s);a.minX=Math.max(o.minX,a.minX),a.maxX=Math.min(o.maxX,a.maxX),a.minY=Math.max(o.minY,a.minY),a.maxY=Math.min(o.maxY,a.maxY)}return a}):r&&this.calculateTileRanges_(r)}forEachTileCoord(e,t,r){const i=this.getTileRangeForExtentAndZ(e,t);for(let s=i.minX,a=i.maxX;s<=a;++s)for(let o=i.minY,l=i.maxY;o<=l;++o)r([t,s,o])}forEachTileCoordParentTileRange(e,t,r,i){let s,a,o,l=null,c=e[0]-1;for(this.zoomFactor_===2?(a=e[1],o=e[2]):l=this.getTileCoordExtent(e,i);c>=this.minZoom;){if(a!==void 0&&o!==void 0?(a=Math.floor(a/2),o=Math.floor(o/2),s=Af(a,a,o,o,r)):s=this.getTileRangeForExtentAndZ(l,c,r),t(c,s))return!0;--c}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(e){return this.origin_?this.origin_:this.origins_[e]}getResolution(e){return this.resolutions_[e]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(e,t,r){if(e[0]<this.maxZoom){if(this.zoomFactor_===2){const s=e[1]*2,a=e[2]*2;return Af(s,s+1,a,a+1,t)}const i=this.getTileCoordExtent(e,r||this.tmpExtent_);return this.getTileRangeForExtentAndZ(i,e[0]+1,t)}return null}getTileRangeForTileCoordAndZ(e,t,r){if(t>this.maxZoom||t<this.minZoom)return null;const i=e[0],s=e[1],a=e[2];if(t===i)return Af(s,a,s,a,r);if(this.zoomFactor_){const l=Math.pow(this.zoomFactor_,t-i),c=Math.floor(s*l),h=Math.floor(a*l);if(t<i)return Af(c,c,h,h,r);const g=Math.floor(l*(s+1))-1,m=Math.floor(l*(a+1))-1;return Af(c,g,h,m,r)}const o=this.getTileCoordExtent(e,this.tmpExtent_);return this.getTileRangeForExtentAndZ(o,t,r)}getTileRangeForExtentAndZ(e,t,r){this.getTileCoordForXYAndZ_(e[0],e[3],t,!1,Pf);const i=Pf[1],s=Pf[2];this.getTileCoordForXYAndZ_(e[2],e[1],t,!0,Pf);const a=Pf[1],o=Pf[2];return Af(i,a,s,o,r)}getTileCoordCenter(e){const t=this.getOrigin(e[0]),r=this.getResolution(e[0]),i=Es(this.getTileSize(e[0]),this.tmpSize_);return[t[0]+(e[1]+.5)*i[0]*r,t[1]-(e[2]+.5)*i[1]*r]}getTileCoordExtent(e,t){const r=this.getOrigin(e[0]),i=this.getResolution(e[0]),s=Es(this.getTileSize(e[0]),this.tmpSize_),a=r[0]+e[1]*s[0]*i,o=r[1]-(e[2]+1)*s[1]*i,l=a+s[0]*i,c=o+s[1]*i;return Nu(a,o,l,c,t)}getTileCoordForCoordAndResolution(e,t,r){return this.getTileCoordForXYAndResolution_(e[0],e[1],t,!1,r)}getTileCoordForXYAndResolution_(e,t,r,i,s){const a=this.getZForResolution(r),o=r/this.getResolution(a),l=this.getOrigin(a),c=Es(this.getTileSize(a),this.tmpSize_);let h=o*(e-l[0])/r/c[0],g=o*(l[1]-t)/r/c[1];return i?(h=hu(h,Xc)-1,g=hu(g,Xc)-1):(h=fx(h,Xc),g=fx(g,Xc)),q_(a,h,g,s)}getTileCoordForXYAndZ_(e,t,r,i,s){const a=this.getOrigin(r),o=this.getResolution(r),l=Es(this.getTileSize(r),this.tmpSize_);let c=(e-a[0])/o/l[0],h=(a[1]-t)/o/l[1];return i?(c=hu(c,Xc)-1,h=hu(h,Xc)-1):(c=fx(c,Xc),h=fx(h,Xc)),q_(r,c,h,s)}getTileCoordForCoordAndZ(e,t,r){return this.getTileCoordForXYAndZ_(e[0],e[1],t,!1,r)}getTileCoordResolution(e){return this.resolutions_[e[0]]}getTileSize(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]}getFullTileRange(e){return this.fullTileRanges_?this.fullTileRanges_[e]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,e):null}getZForResolution(e,t){const r=xw(this.resolutions_,e,t||0);return hr(r,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(e,t){return zD(t,0,t.length,2,this.getTileCoordExtent(e))}calculateTileRanges_(e){const t=this.resolutions_.length,r=new Array(t);for(let i=this.minZoom;i<t;++i)r[i]=this.getTileRangeForExtentAndZ(e,i);this.fullTileRanges_=r}}function Xj(n){let e=n.getDefaultTileGrid();return e||(e=dX(n),n.setDefaultTileGrid(e)),e}function cX(n,e,t){const r=e[0],i=n.getTileCoordCenter(e),s=GA(t);if(!sd(s,i)){const a=yn(s),o=Math.ceil((s[0]-i[0])/a);return i[0]+=a*o,n.getTileCoordForCoordAndZ(i,r)}return e}function uX(n,e,t,r){r=r!==void 0?r:"top-left";const i=qj(n,e,t);return new Kj({extent:n,origin:VU(n,r),resolutions:i,tileSize:t})}function hX(n){const e=n||{},t=e.extent||ir("EPSG:3857").getExtent(),r={extent:t,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:qj(t,e.maxZoom,e.tileSize,e.maxResolution)};return new Kj(r)}function qj(n,e,t,r){e=e!==void 0?e:qH,t=Es(t!==void 0?t:AA);const i=ti(n),s=yn(n);r=r>0?r:Math.max(s/t[0],i/t[1]);const a=e+1,o=new Array(a);for(let l=0;l<a;++l)o[l]=r/Math.pow(2,l);return o}function dX(n,e,t,r){const i=GA(n);return uX(i,e,t,r)}function GA(n){n=ir(n);let e=n.getExtent();if(!e){const t=180*P0.degrees/n.getMetersPerUnit();e=Nu(-t,-t,t,t)}return e}function zA(n,e){const t=[];Object.keys(e).forEach(function(i){e[i]!==null&&e[i]!==void 0&&t.push(i+"="+encodeURIComponent(e[i]))});const r=t.join("&");return n=n.replace(/[?&]$/,""),n+=n.includes("?")?"&":"?",n+r}const fX=/\{z\}/g,gX=/\{x\}/g,mX=/\{y\}/g,pX=/\{-y\}/g;function yX(n,e,t,r,i){return n.replace(fX,e.toString()).replace(gX,t.toString()).replace(mX,r.toString()).replace(pX,function(){if(i===void 0)throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(i-r).toString()})}function xX(n){const e=[];let t=/\{([a-z])-([a-z])\}/.exec(n);if(t){const r=t[1].charCodeAt(0),i=t[2].charCodeAt(0);let s;for(s=r;s<=i;++s)e.push(n.replace(t[0],String.fromCharCode(s)));return e}if(t=/\{(\d+)-(\d+)\}/.exec(n),t){const r=parseInt(t[2],10);for(let i=parseInt(t[1],10);i<=r;i++)e.push(n.replace(t[0],i.toString()));return e}return e.push(n),e}function _X(n,e){return(function(t,r,i){if(!t)return;let s;const a=t[0];if(e){const o=e.getFullTileRange(a);o&&(s=o.getHeight()-1)}return yX(n,a,t[1],t[2],s)})}function vX(n,e){const t=n.length,r=new Array(t);for(let i=0;i<t;++i)r[i]=_X(n[i],e);return wX(r)}function wX(n){return n.length===1?n[0]:(function(e,t,r){if(!e)return;const i=Fj(e),s=Eu(i,n.length);return n[s](e,t,r)})}class EX extends xA{constructor(e){super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX,interpolate:e.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=e.tilePixelRatio!==void 0?e.tilePixelRatio:1,this.tileGrid=e.tileGrid!==void 0?e.tileGrid:null;const t=[256,256];this.tileGrid&&Es(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),t),this.tmpSize=[0,0],this.key_=e.key||Kt(this),this.tileOptions={transition:e.transition,interpolate:e.interpolate},this.zDirection=e.zDirection?e.zDirection:0}getGutterForProjection(e){return 0}getKey(){return this.key_}setKey(e){this.key_!==e&&(this.key_=e,this.changed())}getResolutions(e){const t=e?this.getTileGridForProjection(e):this.tileGrid;return t?t.getResolutions():null}getTile(e,t,r,i,s,a){return Xt()}getTileGrid(){return this.tileGrid}getTileGridForProjection(e){return this.tileGrid?this.tileGrid:Xj(e)}getTilePixelRatio(e){return this.tilePixelRatio_}getTilePixelSize(e,t,r){const i=this.getTileGridForProjection(r),s=this.getTilePixelRatio(t),a=Es(i.getTileSize(e),this.tmpSize);return s==1?a:jW(a,s,this.tmpSize)}getTileCoordForTileUrlFunction(e,t){const r=t!==void 0?t:this.getProjection(),i=t!==void 0?this.getTileGridForProjection(r):this.tileGrid||this.getTileGridForProjection(r);return this.getWrapX()&&r.isGlobal()&&(e=cX(i,e,r)),EK(e,i)?e:null}clear(){}refresh(){this.clear(),super.refresh()}}class SX extends pl{constructor(e,t){super(e),this.tile=t}}const WS={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};class UA extends EX{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===UA.prototype.tileUrlFunction,this.tileLoadFunction=e.tileLoadFunction,e.tileUrlFunction&&(this.tileUrlFunction=e.tileUrlFunction),this.urls=null,e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(e){const t=e.target,r=Kt(t),i=t.getState();let s;i==Bt.LOADING?(this.tileLoadingKeys_[r]=!0,s=WS.TILELOADSTART):r in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[r],s=i==Bt.ERROR?WS.TILELOADERROR:i==Bt.LOADED?WS.TILELOADEND:void 0),s!=null&&this.dispatchEvent(new SX(s,t))}setTileLoadFunction(e){this.tileLoadFunction=e,this.changed()}setTileUrlFunction(e,t){this.tileUrlFunction=e,typeof t<"u"?this.setKey(t):this.changed()}setUrl(e){const t=xX(e);this.urls=t,this.setUrls(t)}setUrls(e){this.urls=e;const t=e.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(vX(e,this.tileGrid),t):this.setKey(t)}tileUrlFunction(e,t,r){}}class Yj extends UA{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:Zj,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate!==void 0?e.interpolate:!0,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.crossOrigin=e.crossOrigin!==void 0?e.crossOrigin:null,this.tileClass=e.tileClass!==void 0?e.tileClass:Mj,this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(e){return this.getProjection()&&e&&!Zh(this.getProjection(),e)?0:this.getGutter()}getGutter(){return 0}getKey(){let e=super.getKey();return this.getInterpolate()||(e+=":disable-interpolation"),e}getTileGridForProjection(e){const t=this.getProjection();if(this.tileGrid&&(!t||Zh(t,e)))return this.tileGrid;const r=Kt(e);return r in this.tileGridForProjection||(this.tileGridForProjection[r]=Xj(e)),this.tileGridForProjection[r]}createTile_(e,t,r,i,s,a){const o=[e,t,r],l=this.getTileCoordForTileUrlFunction(o,s),c=l?this.tileUrlFunction(l,i,s):void 0,h=new this.tileClass(o,c!==void 0?Bt.IDLE:Bt.EMPTY,c!==void 0?c:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return h.key=a,h.addEventListener(en.CHANGE,this.handleTileChange.bind(this)),h}getTile(e,t,r,i,s,a){const o=this.getProjection();if(!o||!s||Zh(o,s))return this.getTileInternal(e,t,r,i,o||s);const l=[e,t,r],c=this.getKey(),h=this.getTileGridForProjection(o),g=this.getTileGridForProjection(s),m=this.getTileCoordForTileUrlFunction(l,s),y=new jj(o,h,s,g,l,m,this.getTilePixelRatio(i),this.getGutter(),(_,x,w,b)=>this.getTileInternal(_,x,w,b,o,a),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return y.key=c,y}getTileInternal(e,t,r,i,s,a){const o=this.getKey(),l=r_(this,o,e,t,r);if(a&&a.containsKey(l))return a.get(l);const c=this.createTile_(e,t,r,i,s,o);return a?.set(l,c),c}setRenderReprojectionEdges(e){this.renderReprojectionEdges_!=e&&(this.renderReprojectionEdges_=e,this.changed())}setTileGridForProjection(e,t){const r=ir(e);if(r){const i=Kt(r);i in this.tileGridForProjection||(this.tileGridForProjection[i]=t)}}}function Zj(n,e){if(ua){const t=n.getCrossOrigin();let r="same-origin",i="same-origin";t==="anonymous"||t===""?(r="cors",i="omit"):t==="use-credentials"&&(r="cors",i="include"),fetch(e,{mode:r,credentials:i}).then(s=>{if(!s.ok)throw new Error(`HTTP ${s.status}`);return s.blob()}).then(s=>createImageBitmap(s)).then(s=>{const a=n.getImage();a.width=s.width,a.height=s.height,a.getContext("2d").drawImage(s,0,0),s.close?.(),a.dispatchEvent(new Event("load"))}).catch(()=>{n.getImage().dispatchEvent(new Event("error"))});return}n.getImage().src=e}class Lh extends Yj{constructor(e){e=e||{};const t=e.projection!==void 0?e.projection:"EPSG:3857",r=e.tileGrid!==void 0?e.tileGrid:hX({extent:GA(t),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize});super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:t,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:r,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0}getGutter(){return this.gutter_}}const bX="modulepreload",TX=function(n){return"/detectorapp-nl/"+n},JN={},xt=function(e,t,r){let i=Promise.resolve();if(t&&t.length>0){let l=function(c){return Promise.all(c.map(h=>Promise.resolve(h).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=a?.nonce||a?.getAttribute("nonce");i=l(t.map(c=>{if(c=TX(c),c in JN)return;JN[c]=!0;const h=c.endsWith(".css"),g=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${g}`))return;const m=document.createElement("link");if(m.rel=h?"stylesheet":bX,h||(m.as="script"),m.crossOrigin="",m.href=c,o&&m.setAttribute("nonce",o),document.head.appendChild(m),h)return new Promise((y,_)=>{m.addEventListener("load",y),m.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return i.then(a=>{for(const o of a||[])o.status==="rejected"&&s(o.reason);return e().catch(s)})};class RX extends ZD{constructor(e,t,r,i,s,a,o){let l=e.getExtent();l&&e.canWrapX()&&(l=l.slice(),l[0]=-1/0,l[2]=1/0);let c=t.getExtent();c&&t.canWrapX()&&(c=c.slice(),c[0]=-1/0,c[2]=1/0);const h=c?ql(r,c):r,g=Eo(h),m=X_(e,t,g,i),y=Dj,_=new Oj(e,t,h,l,m*y,i),x=_.calculateSourceExtent(),w=sg(x)?null:a(x,m,s),b=w?Rt.IDLE:Rt.EMPTY,T=w?w.getPixelRatio():1;super(r,i,T,b),this.targetProj_=t,this.maxSourceExtent_=l,this.triangulation_=_,this.targetResolution_=i,this.targetExtent_=r,this.sourceImage_=w,this.sourcePixelRatio_=T,this.interpolate_=o,this.canvas_=null,this.sourceListenerKey_=null}disposeInternal(){this.state==Rt.LOADING&&this.unlistenSource_(),super.disposeInternal()}getImage(){return this.canvas_}getProjection(){return this.targetProj_}reproject_(){const e=this.sourceImage_.getState();if(e==Rt.LOADED){const t=yn(this.targetExtent_)/this.targetResolution_,r=ti(this.targetExtent_)/this.targetResolution_;this.canvas_=Lj(t,r,this.sourcePixelRatio_,wT(this.sourceImage_.getResolution()),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0,void 0,this.interpolate_,!0)}this.state=e,this.changed()}load(){if(this.state==Rt.IDLE){this.state=Rt.LOADING,this.changed();const e=this.sourceImage_.getState();e==Rt.LOADED||e==Rt.ERROR?this.reproject_():(this.sourceListenerKey_=pn(this.sourceImage_,en.CHANGE,t=>{const r=this.sourceImage_.getState();(r==Rt.LOADED||r==Rt.ERROR)&&(this.unlistenSource_(),this.reproject_())}),this.sourceImage_.load())}}unlistenSource_(){or(this.sourceListenerKey_),this.sourceListenerKey_=null}}const mu=4,HS={IMAGELOADSTART:"imageloadstart",IMAGELOADEND:"imageloadend",IMAGELOADERROR:"imageloaderror"};class AX extends pl{constructor(e,t){super(e),this.image=t}}class kX extends xA{constructor(e){super({attributions:e.attributions,projection:e.projection,state:e.state,interpolate:e.interpolate!==void 0?e.interpolate:!0}),this.on,this.once,this.un,this.loader=e.loader||null,this.resolutions_=e.resolutions!==void 0?e.resolutions:null,this.reprojectedImage_=null,this.reprojectedRevision_=0,this.image=null,this.wantedExtent_,this.wantedResolution_,this.static_=e.loader?e.loader.length===0:!1,this.wantedProjection_=null}getResolutions(){return this.resolutions_}setResolutions(e){this.resolutions_=e}findNearestResolution(e){const t=this.getResolutions();if(t){const r=xw(t,e,0);e=t[r]}return e}getImage(e,t,r,i){const s=this.getProjection();if(!s||!i||Zh(s,i))return s&&(i=s),this.getImageInternal(e,t,r,i);if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&Zh(this.reprojectedImage_.getProjection(),i)&&this.reprojectedImage_.getResolution()==t&&ad(this.reprojectedImage_.getExtent(),e))return this.reprojectedImage_;this.reprojectedImage_.dispose(),this.reprojectedImage_=null}return this.reprojectedImage_=new RX(s,i,e,t,r,(a,o,l)=>this.getImageInternal(a,o,l,s),this.getInterpolate()),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}getImageInternal(e,t,r,i){if(this.loader){const s=Jj(e,t,r,1),a=this.findNearestResolution(t);if(this.image&&(this.static_||this.wantedProjection_===i&&(this.wantedExtent_&&uu(this.wantedExtent_,s)||uu(this.image.getExtent(),s))&&(this.wantedResolution_&&wT(this.wantedResolution_)===a||wT(this.image.getResolution())===a)))return this.image;this.wantedProjection_=i,this.wantedExtent_=s,this.wantedResolution_=a,this.image=new ZD(s,a,r,this.loader),this.image.addEventListener(en.CHANGE,this.handleImageChange.bind(this))}return this.image}handleImageChange(e){const t=e.target;let r;switch(t.getState()){case Rt.LOADING:this.loading=!0,r=HS.IMAGELOADSTART;break;case Rt.LOADED:this.loading=!1,r=HS.IMAGELOADEND;break;case Rt.ERROR:this.loading=!1,r=HS.IMAGELOADERROR;break;default:return}this.hasListener(r)&&this.dispatchEvent(new AX(r,t))}}function IX(n,e){n.getImage().src=e}function Jj(n,e,t,r){const i=e/t,s=Eo(n),a=hu(yn(n)/i,mu),o=hu(ti(n)/i,mu),l=hu((r-1)*a/2,mu),c=a+2*l,h=hu((r-1)*o/2,mu),g=o+2*h;return P_(s,i,0,[c,g])}function CX(n,e,t,r,i,s){const a=i.getCode().split(/:(?=\d+$)/).pop(),o=t/r,l=[N_(yn(e)/o,mu),N_(ti(e)/o,mu)];s.SIZE=l[0]+","+l[1],s.BBOX=e.join(","),s.BBOXSR=a,s.IMAGESR=a,s.DPI=Math.round(s.DPI?s.DPI*r:90*r);const c=n.replace(/MapServer\/?$/,"MapServer/export").replace(/ImageServer\/?$/,"ImageServer/exportImage");return zA(c,s)}function PX(n){const e=n.load?n.load:QD,t=ir(n.projection||"EPSG:3857"),r=n.ratio??1.5,i=n.crossOrigin??null;return function(s,a,o){o=n.hidpi?o:1;const l={F:"image",FORMAT:"PNG32",TRANSPARENT:!0};Object.assign(l,n.params),s=Jj(s,a,o,r);const c=CX(n.url,s,a,o,t,l),h=new Image;return h.crossOrigin=i,e(h,c).then(g=>{const m=yn(s)/g.width*o;return{image:g,extent:s,resolution:m,pixelRatio:o}})}}class NX extends kX{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:e.interpolate,projection:e.projection,resolutions:e.resolutions}),this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null,this.hidpi_=e.hidpi!==void 0?e.hidpi:!0,this.url_=e.url,this.imageLoadFunction_=e.imageLoadFunction!==void 0?e.imageLoadFunction:IX,this.params_=Object.assign({},e.params),this.imageSize_=[0,0],this.renderedRevision_=0,this.ratio_=e.ratio!==void 0?e.ratio:1.5,this.loaderProjection_=null}getParams(){return this.params_}getImageInternal(e,t,r,i){return this.url_===void 0?null:((!this.loader||this.loaderProjection_!==i)&&(this.loaderProjection_=i,this.loader=PX({crossOrigin:this.crossOrigin_,params:this.params_,projection:i,hidpi:this.hidpi_,url:this.url_,ratio:this.ratio_,load:(s,a)=>(this.image.setImage(s),this.imageLoadFunction_(this.image,a),QD(s))})),super.getImageInternal(e,t,r,i))}getImageLoadFunction(){return this.imageLoadFunction_}getUrl(){return this.url_}setImageLoadFunction(e){this.imageLoadFunction_=e,this.changed()}setUrl(e){e!=this.url_&&(this.url_=e,this.loader=null,this.changed())}setParams(e){this.params_=Object.assign({},e),this.changed()}updateParams(e){Object.assign(this.params_,e),this.changed()}changed(){this.image=null,super.changed()}}const ET="1.3.0";function MX(n,e,t,r,i){i.WIDTH=t[0],i.HEIGHT=t[1];const s=r.getAxisOrientation(),a=TD(i.VERSION,"1.3")>=0;i[a?"CRS":"SRS"]=r.getCode();const o=a&&s.startsWith("ne")?[e[1],e[0],e[3],e[2]]:e;return i.BBOX=o.join(","),zA(n,i)}function LX(n,e,t,r,i,s,a){s=Object.assign({REQUEST:"GetMap"},s);const o=e/t,l=[N_(yn(n)/o,mu),N_(ti(n)/o,mu)];if(t!=1)switch(a){case"geoserver":const h=90*t+.5|0;"FORMAT_OPTIONS"in s?s.FORMAT_OPTIONS+=";dpi:"+h:s.FORMAT_OPTIONS="dpi:"+h;break;case"mapserver":s.MAP_RESOLUTION=90*t;break;case"carmentaserver":case"qgis":s.DPI=90*t;break;default:throw new Error("Unknown `serverType` configured")}return MX(i,n,l,r,s)}function QN(n,e){return Object.assign({REQUEST:e,SERVICE:"WMS",VERSION:ET,FORMAT:"image/png",STYLES:"",TRANSPARENT:"TRUE"},n)}const OX='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.';class DX extends Lh{constructor(e){e=e||{};let t;e.attributions!==void 0?t=e.attributions:t=[OX];const r=e.crossOrigin!==void 0?e.crossOrigin:"anonymous",i=e.url!==void 0?e.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:t,attributionsCollapsible:!1,cacheSize:e.cacheSize,crossOrigin:r,interpolate:e.interpolate,maxZoom:e.maxZoom!==void 0?e.maxZoom:19,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileLoadFunction:(s,a)=>{const o=s.getImage();!ua&&o instanceof HTMLImageElement&&(o.referrerPolicy="origin-when-cross-origin"),(e.tileLoadFunction||Zj)(s,a)},transition:e.transition,url:i,wrapX:e.wrapX,zDirection:e.zDirection})}}const J_=1/0;class jX{constructor(e,t){this.priorityFunction_=e,this.keyFunction_=t,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,ig(this.queuedElements_)}dequeue(){const e=this.elements_,t=this.priorities_,r=e[0];e.length==1?(e.length=0,t.length=0):(e[0]=e.pop(),t[0]=t.pop(),this.siftUp_(0));const i=this.keyFunction_(r);return delete this.queuedElements_[i],r}enqueue(e){Rn(!(this.keyFunction_(e)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const t=this.priorityFunction_(e);return t!=J_?(this.elements_.push(e),this.priorities_.push(t),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(e){return e*2+1}getRightChildIndex_(e){return e*2+2}getParentIndex_(e){return e-1>>1}heapify_(){let e;for(e=(this.elements_.length>>1)-1;e>=0;e--)this.siftUp_(e)}isEmpty(){return this.elements_.length===0}isKeyQueued(e){return e in this.queuedElements_}isQueued(e){return this.isKeyQueued(this.keyFunction_(e))}siftUp_(e){const t=this.elements_,r=this.priorities_,i=t.length,s=t[e],a=r[e],o=e;for(;e<i>>1;){const l=this.getLeftChildIndex_(e),c=this.getRightChildIndex_(e),h=c<i&&r[c]<r[l]?c:l;t[e]=t[h],r[e]=r[h],e=h}t[e]=s,r[e]=a,this.siftDown_(o,e)}siftDown_(e,t){const r=this.elements_,i=this.priorities_,s=r[t],a=i[t];for(;t>e;){const o=this.getParentIndex_(t);if(i[o]>a)r[t]=r[o],i[t]=i[o],t=o;else break}r[t]=s,i[t]=a}reprioritize(){const e=this.priorityFunction_,t=this.elements_,r=this.priorities_;let i=0;const s=t.length;let a,o,l;for(o=0;o<s;++o)a=t[o],l=e(a),l==J_?delete this.queuedElements_[this.keyFunction_(a)]:(r[i]=l,t[i++]=a);t.length=i,r.length=i,this.heapify_()}}class FX extends jX{constructor(e,t){super(r=>e.apply(null,r),r=>r[0].getKey()),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=t,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(e){const t=super.enqueue(e);return t&&e[0].addEventListener(en.CHANGE,this.boundHandleTileChange_),t}getTilesLoading(){return this.tilesLoading_}handleTileChange(e){const t=e.target,r=t.getState();if(r===Bt.LOADED||r===Bt.ERROR||r===Bt.EMPTY){r!==Bt.ERROR&&t.removeEventListener(en.CHANGE,this.boundHandleTileChange_);const i=t.getKey();i in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[i],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(e,t){let r=0;for(;this.tilesLoading_<e&&r<t&&this.getCount()>0;){const i=this.dequeue()[0],s=i.getKey();i.getState()===Bt.IDLE&&!(s in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[s]=!0,++this.tilesLoading_,++r,i.load())}}}function VX(n,e,t,r,i){if(!n||!(t in n.wantedTiles)||!n.wantedTiles[t][e.getKey()])return J_;const s=n.viewState.center,a=r[0]-s[0],o=r[1]-s[1];return 65536*Math.log(i)+Math.sqrt(a*a+o*o)/i}class BX extends Yj{constructor(e){e=e||{};const t=Object.assign({},e.params);super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:e.projection,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileClass:e.tileClass,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0,this.params_=t,this.v13_=!0,this.serverType_=e.serverType,this.hidpi_=e.hidpi!==void 0?e.hidpi:!0,this.tmpExtent_=zs(),this.updateV13_(),this.setKey(this.getKeyForParams_())}getFeatureInfoUrl(e,t,r,i){const s=ir(r),a=this.getProjection()||s;let o=this.getTileGrid();o||(o=this.getTileGridForProjection(a));const l=ag(e,s,a),c=X_(a,s,e,t),h=o.getZForResolution(c,this.zDirection),g=o.getResolution(h),m=o.getTileCoordForCoordAndZ(l,h);if(o.getResolutions().length<=m[0])return;let y=o.getTileCoordExtent(m,this.tmpExtent_);const _=this.gutter_;_!==0&&(y=Xl(y,g*_,y));const x={QUERY_LAYERS:this.params_.LAYERS};Object.assign(x,QN(this.params_,"GetFeatureInfo"),i);const w=Math.floor((l[0]-y[0])/g),b=Math.floor((y[3]-l[1])/g);return x[this.v13_?"I":"X"]=w,x[this.v13_?"J":"Y"]=b,this.getRequestUrl_(m,y,1,a||s,x)}getLegendUrl(e,t){if(this.urls[0]===void 0)return;const r={SERVICE:"WMS",VERSION:ET,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(t===void 0||t.LAYER===void 0){const i=this.params_.LAYERS;if(!(!Array.isArray(i)||i.length===1))return;r.LAYER=i}if(e!==void 0){const i=this.getProjection()?this.getProjection().getMetersPerUnit():1,s=28e-5;r.SCALE=e*i/s}return Object.assign(r,t),zA(this.urls[0],r)}getGutter(){return this.gutter_}getParams(){return this.params_}getRequestUrl_(e,t,r,i,s){const a=this.urls;if(!a)return;let o;if(a.length==1)o=a[0];else{const l=Eu(Fj(e),a.length);o=a[l]}return LX(t,(this.tileGrid||this.getTileGridForProjection(i)).getResolution(e[0]),r,i,o,s,this.serverType_)}getTilePixelRatio(e){return!this.hidpi_||this.serverType_===void 0?1:e}getKeyForParams_(){let e=0;const t=[];for(const r in this.params_)t[e++]=r+"-"+this.params_[r];return t.join("/")}setParams_(e){this.params_=e,this.updateV13_(),this.setKey(this.getKeyForParams_())}setParams(e){this.setParams_(Object.assign({},e))}updateParams(e){this.setParams_(Object.assign(this.params_,e))}updateV13_(){const e=this.params_.VERSION||ET;this.v13_=TD(e,"1.3")>=0}tileUrlFunction(e,t,r){let i=this.getTileGrid();if(i||(i=this.getTileGridForProjection(r)),i.getResolutions().length<=e[0])return;t!=1&&(!this.hidpi_||this.serverType_===void 0)&&(t=1);const s=i.getResolution(e[0]);let a=i.getTileCoordExtent(e,this.tmpExtent_);const o=this.gutter_;o!==0&&(a=Xl(a,s*o,a));const l=Object.assign({},QN(this.params_,"GetMap"));return this.getRequestUrl_(e,a,t,r,l)}}class Wf extends pl{constructor(e,t,r){super(e),this.map=t,this.frameState=r!==void 0?r:null}}class eu extends Wf{constructor(e,t,r,i,s,a){super(e,t,s),this.originalEvent=r,this.pixel_=null,this.coordinate_=null,this.dragging=i!==void 0?i:!1,this.activePointers=a}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(e){this.pixel_=e}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(e){this.coordinate_=e}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const Or={SINGLECLICK:"singleclick",CLICK:en.CLICK,DBLCLICK:en.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},ST={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown"};class GX extends m1{constructor(e,t){super(e),this.map_=e,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=t===void 0?1:t,this.down_=null;const r=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=r,this.pointerdownListenerKey_=pn(r,ST.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=pn(r,ST.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(en.TOUCHMOVE,this.boundHandleTouchMove_,XD?{passive:!1}:!1)}emulateClick_(e){let t=new eu(Or.CLICK,this.map_,e);this.dispatchEvent(t),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,t=new eu(Or.DBLCLICK,this.map_,e),this.dispatchEvent(t)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const r=new eu(Or.SINGLECLICK,this.map_,e);this.dispatchEvent(r)},250)}updateActivePointers_(e){const t=e,r=t.pointerId;if(t.type==Or.POINTERUP||t.type==Or.POINTERCANCEL){delete this.trackedTouches_[r];for(const i in this.trackedTouches_)if(this.trackedTouches_[i].target!==t.target){delete this.trackedTouches_[i];break}}else(t.type==Or.POINTERDOWN||t.type==Or.POINTERMOVE)&&(this.trackedTouches_[r]=t);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(e){this.updateActivePointers_(e);const t=new eu(Or.POINTERUP,this.map_,e,void 0,void 0,this.activePointers_);this.dispatchEvent(t),this.emulateClicks_&&!t.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(e)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(or),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(e){return e.button===0}handlePointerDown_(e){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(e);const t=new eu(Or.POINTERDOWN,this.map_,e,void 0,void 0,this.activePointers_);if(this.dispatchEvent(t),this.down_=new PointerEvent(e.type,e),Object.defineProperty(this.down_,"target",{writable:!1,value:e.target}),this.dragListenerKeys_.length===0){const r=this.map_.getOwnerDocument();this.dragListenerKeys_.push(pn(r,Or.POINTERMOVE,this.handlePointerMove_,this),pn(r,Or.POINTERUP,this.handlePointerUp_,this),pn(this.element_,Or.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==r&&this.dragListenerKeys_.push(pn(this.element_.getRootNode(),Or.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(e){if(this.isMoving_(e)){this.updateActivePointers_(e),this.dragging_=!0;const t=new eu(Or.POINTERDRAG,this.map_,e,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(t)}}relayMoveEvent_(e){this.originalPointerMoveEvent_=e;const t=!!(this.down_&&this.isMoving_(e));this.dispatchEvent(new eu(Or.POINTERMOVE,this.map_,e,t))}handleTouchMove_(e){const t=this.originalPointerMoveEvent_;(!t||t.defaultPrevented)&&(typeof e.cancelable!="boolean"||e.cancelable===!0)&&e.preventDefault()}isMoving_(e){return this.dragging_||Math.abs(e.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(e.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(or(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(en.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(or(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(or),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const tu={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},rs={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"};class jw extends yl{constructor(e){super();const t=e.element;t&&!e.target&&!t.style.pointerEvents&&(t.style.pointerEvents="auto"),this.element=t||null,this.target_=null,this.map_=null,this.listenerKeys=[],e.render&&(this.render=e.render),e.target&&this.setTarget(e.target)}disposeInternal(){this.element?.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(e){this.map_&&this.element?.remove();for(let t=0,r=this.listenerKeys.length;t<r;++t)or(this.listenerKeys[t]);if(this.listenerKeys.length=0,this.map_=e,e){const t=this.target_??e.getOverlayContainerStopEvent();this.element&&t.appendChild(this.element),this.render!==_p&&this.listenerKeys.push(pn(e,tu.POSTRENDER,this.render,this)),e.render()}}render(e){}setTarget(e){this.target_=typeof e=="string"?document.getElementById(e):e}}class zX extends jw{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=e.collapsed!==void 0?e.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=e.collapsible!==void 0,this.collapsible_=e.collapsible!==void 0?e.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.attributions_=e.attributions;const t=e.className!==void 0?e.className:"ol-attribution",r=e.tipLabel!==void 0?e.tipLabel:"Attributions",i=e.expandClassName!==void 0?e.expandClassName:t+"-expand",s=e.collapseLabel!==void 0?e.collapseLabel:"",a=e.collapseClassName!==void 0?e.collapseClassName:t+"-collapse";typeof s=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=s,this.collapseLabel_.className=a):this.collapseLabel_=s;const o=e.label!==void 0?e.label:"i";typeof o=="string"?(this.label_=document.createElement("span"),this.label_.textContent=o,this.label_.className=i):this.label_=o;const l=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=r,this.toggleButton_.appendChild(l),this.toggleButton_.addEventListener(en.CLICK,this.handleClick_.bind(this),!1);const c=t+" "+w1+" "+gA+(this.collapsed_&&this.collapsible_?" "+uN:"")+(this.collapsible_?"":" ol-uncollapsible"),h=this.element;h.className=c,h.appendChild(this.toggleButton_),h.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(e){const t=this.getMap().getAllLayers(),r=new Set(t.flatMap(i=>i.getAttributions(e)));if(this.attributions_!==void 0&&(Array.isArray(this.attributions_)?this.attributions_.forEach(i=>r.add(i)):r.add(this.attributions_)),!this.overrideCollapsible_){const i=!t.some(s=>s.getSource()?.getAttributionsCollapsible()===!1);this.setCollapsible(i)}return Array.from(r)}async updateElement_(e){if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=await Promise.all(this.collectSourceAttributions_(e).map(i=>mD(()=>i))),r=t.length>0;if(this.renderedVisible_!=r&&(this.element.style.display=r?"":"none",this.renderedVisible_=r),!gc(t,this.renderedAttributions_)){W$(this.ulElement_);for(let i=0,s=t.length;i<s;++i){const a=document.createElement("li");a.innerHTML=t[i],this.ulElement_.appendChild(a)}this.renderedAttributions_=t}}handleClick_(e){e.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(uN),this.collapsed_?lN(this.collapseLabel_,this.label_):lN(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(e){this.userCollapsed_=e,!(!this.collapsible_||this.collapsed_===e)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(e){this.updateElement_(e.frameState)}}class UX extends jw{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target});const t=e.className!==void 0?e.className:"ol-rotate",r=e.label!==void 0?e.label:"",i=e.compassClassName!==void 0?e.compassClassName:"ol-compass";this.label_=null,typeof r=="string"?(this.label_=document.createElement("span"),this.label_.className=i,this.label_.textContent=r):(this.label_=r,this.label_.classList.add(i));const s=e.tipLabel?e.tipLabel:"Reset rotation",a=document.createElement("button");a.className=t+"-reset",a.setAttribute("type","button"),a.title=s,a.appendChild(this.label_),a.addEventListener(en.CLICK,this.handleClick_.bind(this),!1);const o=t+" "+w1+" "+gA,l=this.element;l.className=o,l.appendChild(a),this.callResetNorth_=e.resetNorth?e.resetNorth:void 0,this.duration_=e.duration!==void 0?e.duration:250,this.autoHide_=e.autoHide!==void 0?e.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(px)}handleClick_(e){e.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const t=this.getMap().getView();if(!t)return;const r=t.getRotation();r!==void 0&&(this.duration_>0&&r%(2*Math.PI)!==0?t.animate({rotation:0,duration:this.duration_,easing:og}):t.setRotation(0))}render(e){const t=e.frameState;if(!t)return;const r=t.viewState.rotation;if(r!=this.rotation_){const i="rotate("+r+"rad)";if(this.autoHide_){const s=this.element.classList.contains(px);!s&&r===0?this.element.classList.add(px):s&&r!==0&&this.element.classList.remove(px)}this.label_.style.transform=i}this.rotation_=r}}class $X extends jw{constructor(e){e=e||{},super({element:document.createElement("div"),target:e.target});const t=e.className!==void 0?e.className:"ol-zoom",r=e.delta!==void 0?e.delta:1,i=e.zoomInClassName!==void 0?e.zoomInClassName:t+"-in",s=e.zoomOutClassName!==void 0?e.zoomOutClassName:t+"-out",a=e.zoomInLabel!==void 0?e.zoomInLabel:"+",o=e.zoomOutLabel!==void 0?e.zoomOutLabel:"",l=e.zoomInTipLabel!==void 0?e.zoomInTipLabel:"Zoom in",c=e.zoomOutTipLabel!==void 0?e.zoomOutTipLabel:"Zoom out",h=document.createElement("button");h.className=i,h.setAttribute("type","button"),h.title=l,h.appendChild(typeof a=="string"?document.createTextNode(a):a),h.addEventListener(en.CLICK,this.handleClick_.bind(this,r),!1);const g=document.createElement("button");g.className=s,g.setAttribute("type","button"),g.title=c,g.appendChild(typeof o=="string"?document.createTextNode(o):o),g.addEventListener(en.CLICK,this.handleClick_.bind(this,-r),!1);const m=t+" "+w1+" "+gA,y=this.element;y.className=m,y.appendChild(h),y.appendChild(g),this.duration_=e.duration!==void 0?e.duration:250}handleClick_(e,t){t.preventDefault(),this.zoomByDelta_(e)}zoomByDelta_(e){const r=this.getMap().getView();if(!r)return;const i=r.getZoom();if(i!==void 0){const s=r.getConstrainedZoom(i+e);this.duration_>0?(r.getAnimating()&&r.cancelAnimations(),r.animate({zoom:s,duration:this.duration_,easing:og})):r.setZoom(s)}}}function WX(n){n=n||{};const e=new Ma;return(n.zoom===void 0||n.zoom)&&e.push(new $X(n.zoomOptions)),(n.rotate===void 0||n.rotate)&&e.push(new UX(n.rotateOptions)),(n.attribution===void 0||n.attribution)&&e.push(new zX(n.attributionOptions)),e}class HX{constructor(e,t,r){this.decay_=e,this.minVelocity_=t,this.delay_=r,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(e,t){this.points_.push(e,t,Date.now())}end(){if(this.points_.length<6)return!1;const e=Date.now()-this.delay_,t=this.points_.length-3;if(this.points_[t+2]<e)return!1;let r=t-3;for(;r>0&&this.points_[r+2]>e;)r-=3;const i=this.points_[t+2]-this.points_[r+2];if(i<1e3/60)return!1;const s=this.points_[t]-this.points_[r],a=this.points_[t+1]-this.points_[r+1];return this.angle_=Math.atan2(a,s),this.initialVelocity_=Math.sqrt(s*s+a*a)/i,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}const eM={ACTIVE:"active"};class R1 extends yl{constructor(e){super(),this.on,this.once,this.un,e&&e.handleEvent&&(this.handleEvent=e.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(eM.ACTIVE)}getMap(){return this.map_}handleEvent(e){return!0}setActive(e){this.set(eM.ACTIVE,e)}setMap(e){this.map_=e}}function KX(n,e,t){const r=n.getCenterInternal();if(r){const i=[r[0]+e[0],r[1]+e[1]];n.animateInternal({duration:t!==void 0?t:250,easing:$H,center:n.getConstrainedCenter(i)})}}function $A(n,e,t,r){const i=n.getZoom();if(i===void 0)return;const s=n.getConstrainedZoom(i+e),a=n.getResolutionForZoom(s);n.getAnimating()&&n.cancelAnimations(),n.animate({resolution:a,anchor:t,duration:r!==void 0?r:250,easing:og})}class XX extends R1{constructor(e){super(),e=e||{},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:250}handleEvent(e){let t=!1;if(e.type==Or.DBLCLICK){const r=e.originalEvent,i=e.map,s=e.coordinate,a=r.shiftKey?-this.delta_:this.delta_,o=i.getView();$A(o,a,s,this.duration_),r.preventDefault(),t=!0}return!t}}function bT(n){const e=arguments;return function(t){let r=!0;for(let i=0,s=e.length;i<s&&(r=r&&e[i](t),!!r);++i);return r}}const qX=function(n){const e=n.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},YX=function(n){const e=n.map.getTargetElement(),t=e.getRootNode(),r=n.map.getOwnerDocument().activeElement;return t instanceof ShadowRoot?t.host.contains(r):e.contains(r)},Qj=function(n){const e=n.map.getTargetElement(),t=e.getRootNode();return(t instanceof ShadowRoot?t.host:e).hasAttribute("tabindex")?YX(n):!0},ZX=xp,eF=function(n){const e=n.originalEvent;return"pointerId"in e&&e.button==0&&!(U$&&HD&&e.ctrlKey)},tF=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},JX=function(n){const e=n.originalEvent;return HD?e.metaKey:e.ctrlKey},QX=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},nF=function(n){const e=n.originalEvent,t=e.target.tagName;return t!=="INPUT"&&t!=="SELECT"&&t!=="TEXTAREA"&&!e.target.isContentEditable},KS=function(n){const e=n.originalEvent;return"pointerId"in e&&e.pointerType=="mouse"},eq=function(n){const e=n.originalEvent;return"pointerId"in e&&e.isPrimary&&e.button===0};class A1 extends R1{constructor(e){e=e||{},super(e),e.handleDownEvent&&(this.handleDownEvent=e.handleDownEvent),e.handleDragEvent&&(this.handleDragEvent=e.handleDragEvent),e.handleMoveEvent&&(this.handleMoveEvent=e.handleMoveEvent),e.handleUpEvent&&(this.handleUpEvent=e.handleUpEvent),e.stopDown&&(this.stopDown=e.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(e){return!1}handleDragEvent(e){}handleEvent(e){if(!e.originalEvent)return!0;let t=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence){if(e.type==Or.POINTERDRAG)this.handleDragEvent(e),e.originalEvent.preventDefault();else if(e.type==Or.POINTERUP){const r=this.handleUpEvent(e);this.handlingDownUpSequence=r&&this.targetPointers.length>0}}else if(e.type==Or.POINTERDOWN){const r=this.handleDownEvent(e);this.handlingDownUpSequence=r,t=this.stopDown(r)}else e.type==Or.POINTERMOVE&&this.handleMoveEvent(e);return!t}handleMoveEvent(e){}handleUpEvent(e){return!1}stopDown(e){return e}updateTrackedPointers_(e){e.activePointers&&(this.targetPointers=e.activePointers)}}function WA(n){const e=n.length;let t=0,r=0;for(let i=0;i<e;i++)t+=n[i].clientX,r+=n[i].clientY;return{clientX:t/e,clientY:r/e}}class tq extends A1{constructor(e){super({stopDown:_w}),e=e||{},this.kinetic_=e.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const t=e.condition?e.condition:bT(tF,eq);this.condition_=e.onFocusOnly?bT(Qj,t):t,this.noKinetic_=!1}handleDragEvent(e){const t=e.map;this.panning_||(this.panning_=!0,t.getView().beginInteraction());const r=this.targetPointers,i=t.getEventPixel(WA(r));if(r.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(i[0],i[1]),this.lastCentroid){const s=[this.lastCentroid[0]-i[0],i[1]-this.lastCentroid[1]],o=e.map.getView();WU(s,o.getResolution()),ZR(s,o.getRotation()),o.adjustCenterInternal(s)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=i,this.lastPointersCount_=r.length,e.originalEvent.preventDefault()}handleUpEvent(e){const t=e.map,r=t.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const i=this.kinetic_.getDistance(),s=this.kinetic_.getAngle(),a=r.getCenterInternal(),o=t.getPixelFromCoordinateInternal(a),l=t.getCoordinateFromPixelInternal([o[0]-i*Math.cos(s),o[1]-i*Math.sin(s)]);r.animateInternal({center:r.getConstrainedCenter(l),duration:500,easing:og})}return this.panning_&&(this.panning_=!1,r.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(e){if(this.targetPointers.length>0&&this.condition_(e)){const r=e.map.getView();return this.lastCentroid=null,r.getAnimating()&&r.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}class nq extends A1{constructor(e){e=e||{},super({stopDown:_w}),this.condition_=e.condition?e.condition:qX,this.lastAngle_=void 0,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){if(!KS(e))return;const t=e.map,r=t.getView();if(r.getConstraints().rotation===RA)return;const i=t.getSize(),s=e.pixel,a=Math.atan2(i[1]/2-s[1],s[0]-i[0]/2);if(this.lastAngle_!==void 0){const o=a-this.lastAngle_;r.adjustRotationInternal(-o)}this.lastAngle_=a}handleUpEvent(e){return KS(e)?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){return KS(e)&&eF(e)&&this.condition_(e)?(e.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}class rq extends g1{constructor(e){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+e,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const e=this.startPixel_,t=this.endPixel_,r="px",i=this.element_.style;i.left=Math.min(e[0],t[0])+r,i.top=Math.min(e[1],t[1])+r,i.width=Math.abs(t[0]-e[0])+r,i.height=Math.abs(t[1]-e[1])+r}setMap(e){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const t=this.element_.style;t.left="inherit",t.top="inherit",t.width="inherit",t.height="inherit"}this.map_=e,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(e,t){this.startPixel_=e,this.endPixel_=t,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;const e=this.startPixel_,t=this.endPixel_,i=[e,[e[0],t[1]],t,[t[0],e[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);i[4]=i[0].slice(),this.geometry_?this.geometry_.setCoordinates([i]):this.geometry_=new Ua([i])}getGeometry(){return this.geometry_}}const Nf={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class dm extends pl{constructor(e,t,r){super(e),this.coordinate=t,this.mapBrowserEvent=r}}class iq extends A1{constructor(e){super(),this.on,this.once,this.un,e=e??{},this.box_=new rq(e.className||"ol-dragbox"),this.minArea_=e.minArea??64,e.onBoxEnd&&(this.onBoxEnd=e.onBoxEnd),this.startPixel_=null,this.condition_=e.condition??eF,this.boxEndCondition_=e.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(e,t,r){const i=r[0]-t[0],s=r[1]-t[1];return i*i+s*s>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(e){this.startPixel_&&(this.box_.setPixels(this.startPixel_,e.pixel),this.dispatchEvent(new dm(Nf.BOXDRAG,e.coordinate,e)))}handleUpEvent(e){if(!this.startPixel_)return!1;const t=this.boxEndCondition_(e,this.startPixel_,e.pixel);return t&&this.onBoxEnd(e),this.dispatchEvent(new dm(t?Nf.BOXEND:Nf.BOXCANCEL,e.coordinate,e)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(e){return this.condition_(e)?(this.startPixel_=e.pixel,this.box_.setMap(e.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new dm(Nf.BOXSTART,e.coordinate,e)),!0):!1}onBoxEnd(e){}setActive(e){e||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new dm(Nf.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setActive(e)}setMap(e){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new dm(Nf.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setMap(e)}}class sq extends iq{constructor(e){e=e||{};const t=e.condition?e.condition:QX;super({condition:t,className:e.className||"ol-dragzoom",minArea:e.minArea}),this.duration_=e.duration!==void 0?e.duration:200,this.out_=e.out!==void 0?e.out:!1}onBoxEnd(e){const r=this.getMap().getView();let i=this.getGeometry();if(this.out_){const s=r.rotatedExtentForGeometry(i),a=r.getResolutionForExtentInternal(s),o=r.getResolution()/a;i=i.clone(),i.scale(o*o)}r.fitInternal(i,{duration:this.duration_,easing:og})}}const wh={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};class aq extends R1{constructor(e){super(),e=e||{},this.defaultCondition_=function(t){return tF(t)&&nF(t)},this.condition_=e.condition!==void 0?e.condition:this.defaultCondition_,this.duration_=e.duration!==void 0?e.duration:100,this.pixelDelta_=e.pixelDelta!==void 0?e.pixelDelta:128}handleEvent(e){let t=!1;if(e.type==en.KEYDOWN){const r=e.originalEvent,i=r.key;if(this.condition_(e)&&(i==wh.DOWN||i==wh.LEFT||i==wh.RIGHT||i==wh.UP)){const a=e.map.getView(),o=a.getResolution()*this.pixelDelta_;let l=0,c=0;i==wh.DOWN?c=-o:i==wh.LEFT?l=-o:i==wh.RIGHT?l=o:c=o;const h=[l,c];ZR(h,a.getRotation()),KX(a,h,this.duration_),r.preventDefault(),t=!0}}return!t}}class oq extends R1{constructor(e){super(),e=e||{},this.condition_=e.condition?e.condition:function(t){return!JX(t)&&nF(t)},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:100}handleEvent(e){let t=!1;if(e.type==en.KEYDOWN||e.type==en.KEYPRESS){const r=e.originalEvent,i=r.key;if(this.condition_(e)&&(i==="+"||i==="-")){const s=e.map,a=i==="+"?this.delta_:-this.delta_,o=s.getView();$A(o,a,void 0,this.duration_),r.preventDefault(),t=!0}}return!t}}const lq=40,cq=300;class uq extends R1{constructor(e){e=e||{},super(e),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=e.maxDelta!==void 0?e.maxDelta:1,this.duration_=e.duration!==void 0?e.duration:250,this.timeout_=e.timeout!==void 0?e.timeout:80,this.useAnchor_=e.useAnchor!==void 0?e.useAnchor:!0,this.constrainResolution_=e.constrainResolution!==void 0?e.constrainResolution:!1;const t=e.condition?e.condition:ZX;this.condition_=e.onFocusOnly?bT(Qj,t):t,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const e=this.getMap();if(!e)return;e.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null)}handleEvent(e){if(!this.condition_(e)||e.type!==en.WHEEL)return!0;const r=e.map,i=e.originalEvent;i.preventDefault(),this.useAnchor_&&(this.lastAnchor_=e.pixel);let s=i.deltaY;switch(i.deltaMode){case WheelEvent.DOM_DELTA_LINE:s*=lq;break;case WheelEvent.DOM_DELTA_PAGE:s*=cq;break}if(s===0)return!1;this.lastDelta_=s;const a=Date.now();this.startTime_===void 0&&(this.startTime_=a),(!this.mode_||a-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(s)<4?"trackpad":"wheel");const o=r.getView();if(this.mode_==="trackpad"&&!(o.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(o.getAnimating()&&o.cancelAnimations(),o.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),o.adjustZoom(-s/this.deltaPerZoom_,this.lastAnchor_?r.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=a,!1;this.totalDelta_+=s;const l=Math.max(this.timeout_-(a-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,r),l),!1}handleWheelZoom_(e){const t=e.getView();t.getAnimating()&&t.cancelAnimations();let r=-hr(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(t.getConstrainResolution()||this.constrainResolution_)&&(r=r?r>0?1:-1:0),$A(t,r,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(e){this.useAnchor_=e,e||(this.lastAnchor_=null)}}class hq extends A1{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=_w),super(t),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=e.threshold!==void 0?e.threshold:.3,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){let t=0;const r=this.targetPointers[0],i=this.targetPointers[1],s=Math.atan2(i.clientY-r.clientY,i.clientX-r.clientX);if(this.lastAngle_!==void 0){const l=s-this.lastAngle_;this.rotationDelta_+=l,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),t=l}this.lastAngle_=s;const a=e.map,o=a.getView();o.getConstraints().rotation!==RA&&(this.anchor_=a.getCoordinateFromPixelInternal(a.getEventPixel(WA(this.targetPointers))),this.rotating_&&(a.render(),o.adjustRotationInternal(t,this.anchor_)))}handleUpEvent(e){return this.targetPointers.length<2?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}class dq extends A1{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=_w),super(t),this.anchor_=null,this.duration_=e.duration!==void 0?e.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(e){let t=1;const r=this.targetPointers[0],i=this.targetPointers[1],s=r.clientX-i.clientX,a=r.clientY-i.clientY,o=Math.sqrt(s*s+a*a);this.lastDistance_!==void 0&&(t=this.lastDistance_/o),this.lastDistance_=o;const l=e.map,c=l.getView();t!=1&&(this.lastScaleDelta_=t),this.anchor_=l.getCoordinateFromPixelInternal(l.getEventPixel(WA(this.targetPointers))),l.render(),c.adjustResolutionInternal(t,this.anchor_)}handleUpEvent(e){if(this.targetPointers.length<2){const r=e.map.getView(),i=this.lastScaleDelta_>1?1:-1;return r.endInteraction(this.duration_,i),!1}return!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}function fq(n){n=n||{};const e=new Ma,t=new HX(-.005,.05,100);return(n.altShiftDragRotate===void 0||n.altShiftDragRotate)&&e.push(new nq),(n.doubleClickZoom===void 0||n.doubleClickZoom)&&e.push(new XX({delta:n.zoomDelta,duration:n.zoomDuration})),(n.dragPan===void 0||n.dragPan)&&e.push(new tq({onFocusOnly:n.onFocusOnly,kinetic:t})),(n.pinchRotate===void 0||n.pinchRotate)&&e.push(new hq),(n.pinchZoom===void 0||n.pinchZoom)&&e.push(new dq({duration:n.zoomDuration})),(n.keyboard===void 0||n.keyboard)&&(e.push(new aq),e.push(new oq({delta:n.zoomDelta,duration:n.zoomDuration}))),(n.mouseWheelZoom===void 0||n.mouseWheelZoom)&&e.push(new uq({onFocusOnly:n.onFocusOnly,duration:n.zoomDuration})),(n.shiftDragZoom===void 0||n.shiftDragZoom)&&e.push(new sq({duration:n.zoomDuration})),e}class gq extends g1{constructor(e){super(),this.map_=e}dispatchRenderEvent(e,t){Xt()}calculateMatrices2D(e){const t=e.viewState,r=e.coordinateToPixelTransform,i=e.pixelToCoordinateTransform;Ga(r,e.size[0]/2,e.size[1]/2,1/t.resolution,-1/t.resolution,-t.rotation,-t.center[0],-t.center[1]),wp(i,r)}forEachFeatureAtCoordinate(e,t,r,i,s,a,o,l){let c;const h=t.viewState;function g(L,O,B,R){return s.call(a,O,L?B:null,R)}const m=h.projection,y=RD(e.slice(),m),_=[[0,0]];if(m.canWrapX()&&i){const L=m.getExtent(),O=yn(L);_.push([-O,0],[O,0])}const x=t.layerStatesArray,w=x.length,b=[],T=[];for(let L=0;L<_.length;L++)for(let O=w-1;O>=0;--O){const B=x[O],R=B.layer;if(R.hasRenderer()&&kA(B,h)&&o.call(l,R)){const A=R.getRenderer(),P=R.getSource();if(A&&P){const D=P.getWrapX()?y:e,N=g.bind(null,B.managed);T[0]=D[0]+_[L][0],T[1]=D[1]+_[L][1],c=A.forEachFeatureAtCoordinate(T,t,r,N,b)}if(c)return c}}if(b.length===0)return;const k=1/b.length;return b.forEach((L,O)=>L.distanceSq+=O*k),b.sort((L,O)=>L.distanceSq-O.distanceSq),b.some(L=>c=L.callback(L.feature,L.layer,L.geometry)),c}hasFeatureAtCoordinate(e,t,r,i,s,a){return this.forEachFeatureAtCoordinate(e,t,r,i,xp,this,s,a)!==void 0}getMap(){return this.map_}renderFrame(e){Xt()}scheduleExpireIconCache(e){La.canExpireCache()&&e.postRenderFunctions.push(mq)}}function mq(n,e){La.expire()}class pq extends gq{constructor(e){super(e),this.fontChangeListenerKey_=pn(zf,C0.PROPERTYCHANGE,e.redrawText,e),this.element_=ua?qD():document.createElement("div");const t=this.element_.style;t.position="absolute",t.width="100%",t.height="100%",t.zIndex="0",this.element_.className=w1+" ol-layers";const r=e.getViewport();r&&r.insertBefore(this.element_,r.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(e,t){const r=this.getMap();if(r.hasListener(e)){const i=new Bm(e,void 0,t);r.dispatchEvent(i)}}disposeInternal(){or(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(e){if(!e){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(e),this.dispatchRenderEvent(Si.PRECOMPOSE,e);const t=e.layerStatesArray.sort((c,h)=>c.zIndex-h.zIndex);t.some(c=>c.layer instanceof Lw&&c.layer.getDeclutter())&&(e.declutter={});const i=e.viewState;this.children_.length=0;const s=[];let a=null;for(let c=0,h=t.length;c<h;++c){const g=t[c];e.layerIndex=c;const m=g.layer,y=m.getSourceState();if(!kA(g,i)||y!="ready"&&y!="undefined"){m.unrender();continue}const _=m.render(e,a);_&&(_!==a&&(this.children_.push(_),a=_),s.push(g))}this.declutter(e,s),H$(this.element_,this.children_);const l=this.getMap().getTargetElement();if(fu(l)){const c=l.getContext("2d");for(const h of this.children_){const g=h.firstElementChild||h,m=h.style.backgroundColor;if(m&&(!fu(g)||g.width>0)&&(c.fillStyle=m,c.fillRect(0,0,l.width,l.height)),fu(g)&&g.width>0){const y=h.style.opacity||g.style.opacity;c.globalAlpha=y===""?1:Number(y);const _=g.style.transform;if(_)c.setTransform(...lT(_));else{const x=parseFloat(g.style.width)/g.width,w=parseFloat(g.style.height)/g.height;c.setTransform(x,0,0,w,0,0)}c.drawImage(g,0,0)}}c.globalAlpha=1,c.setTransform(1,0,0,1,0,0)}this.dispatchRenderEvent(Si.POSTCOMPOSE,e),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(e)}declutter(e,t){if(e.declutter){for(let r=t.length-1;r>=0;--r){const i=t[r],s=i.layer;s.getDeclutter()&&s.renderDeclutter(e,i)}t.forEach(r=>r.layer.renderDeferred(e))}}}function rF(n){if(n instanceof T1){n.setMapInternal(null);return}n instanceof Ow&&n.getLayers().forEach(rF)}function iF(n,e){if(n instanceof T1){n.setMapInternal(e);return}if(n instanceof Ow){const t=n.getLayers().getArray();for(let r=0,i=t.length;r<i;++r)iF(t[r],e)}}let yq=class extends yl{constructor(e){super(),e=e||{},this.on,this.once,this.un;const t=xq(e);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=e.maxTilesLoading!==void 0?e.maxTilesLoading:16,this.pixelRatio_=e.pixelRatio!==void 0?e.pixelRatio:$$,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=gi(),this.pixelToCoordinateTransform_=gi(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,ua||(this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_)),this.mapBrowserEventHandler_=null,this.moveTolerance_=e.moveTolerance,this.keyboardEventTarget_=t.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,ua||(this.resizeObserver_=new ResizeObserver(()=>this.updateSize())),this.controls=t.controls||(ua?new Ma:WX()),this.interactions=t.interactions||(ua?new Ma:fq({onFocusOnly:!0})),this.overlays_=t.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new FX(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(rs.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(rs.VIEW,this.handleViewChanged_),this.addChangeListener(rs.SIZE,this.handleSizeChanged_),this.addChangeListener(rs.TARGET,this.handleTargetChanged_),this.setProperties(t.values);const r=this;e.view&&!(e.view instanceof Zo)&&e.view.then(function(i){r.setView(new Zo(i))}),this.controls.addEventListener(Ls.ADD,i=>{i.element.setMap(this)}),this.controls.addEventListener(Ls.REMOVE,i=>{i.element.setMap(null)}),this.interactions.addEventListener(Ls.ADD,i=>{i.element.setMap(this)}),this.interactions.addEventListener(Ls.REMOVE,i=>{i.element.setMap(null)}),this.overlays_.addEventListener(Ls.ADD,i=>{this.addOverlayInternal_(i.element)}),this.overlays_.addEventListener(Ls.REMOVE,i=>{const s=i.element.getId();s!==void 0&&delete this.overlayIdIndex_[s.toString()],i.element.setMap(null)}),this.controls.forEach(i=>{i.setMap(this)}),this.interactions.forEach(i=>{i.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(e){this.getControls().push(e)}addInteraction(e){this.getInteractions().push(e)}addLayer(e){this.getLayerGroup().getLayers().push(e)}handleLayerAdd_(e){iF(e.layer,this)}addOverlay(e){this.getOverlays().push(e)}addOverlayInternal_(e){const t=e.getId();t!==void 0&&(this.overlayIdIndex_[t.toString()]=e),e.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_?.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(e,t,r){if(!this.frameState_||!this.renderer_)return;const i=this.getCoordinateFromPixelInternal(e);r=r!==void 0?r:{};const s=r.hitTolerance!==void 0?r.hitTolerance:0,a=r.layerFilter!==void 0?r.layerFilter:xp,o=r.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(i,this.frameState_,s,o,t,null,a,null)}getFeaturesAtPixel(e,t){const r=[];return this.forEachFeatureAtPixel(e,function(i){r.push(i)},t),r}getAllLayers(){const e=[];function t(r){r.forEach(function(i){i instanceof Ow?t(i.getLayers()):e.push(i)})}return t(this.getLayers()),e}hasFeatureAtPixel(e,t){if(!this.frameState_||!this.renderer_)return!1;const r=this.getCoordinateFromPixelInternal(e);t=t!==void 0?t:{};const i=t.layerFilter!==void 0?t.layerFilter:xp,s=t.hitTolerance!==void 0?t.hitTolerance:0,a=t.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(r,this.frameState_,s,a,i,null)}getEventCoordinate(e){return this.getCoordinateFromPixel(this.getEventPixel(e))}getEventCoordinateInternal(e){return this.getCoordinateFromPixelInternal(this.getEventPixel(e))}getEventPixel(e){const r=this.viewport_.getBoundingClientRect(),i=this.getSize(),s=r.width/i[0],a=r.height/i[1],o="changedTouches"in e?e.changedTouches[0]:e;return[(o.clientX-r.left)/s,(o.clientY-r.top)/a]}getTarget(){return this.get(rs.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(e){return oT(this.getCoordinateFromPixelInternal(e),this.getView().getProjection())}getCoordinateFromPixelInternal(e){const t=this.frameState_;return t?Fr(t.pixelToCoordinateTransform,e.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(e){const t=this.overlayIdIndex_[e.toString()];return t!==void 0?t:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(rs.LAYERGROUP)}setLayers(e){const t=this.getLayerGroup();if(e instanceof Ma){t.setLayers(e);return}const r=t.getLayers();r.clear(),r.extend(e)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const e=this.getLayerGroup().getLayerStatesArray();for(let t=0,r=e.length;t<r;++t){const i=e[t];if(!i.visible)continue;const s=i.layer.getRenderer();if(s&&!s.ready)return!0;const a=i.layer.getSource();if(a&&a.loading)return!0}return!1}getPixelFromCoordinate(e){const t=Fl(e,this.getView().getProjection());return this.getPixelFromCoordinateInternal(t)}getPixelFromCoordinateInternal(e){const t=this.frameState_;return t?Fr(t.coordinateToPixelTransform,e.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(rs.SIZE)}getView(){return this.get(rs.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const e=this.getTargetElement();return e?e.ownerDocument:document}getTilePriority(e,t,r,i){return VX(this.frameState_,e,t,r,i)}handleBrowserEvent(e,t){t=t||e.type;const r=new eu(t,this,e);this.handleMapBrowserEvent(r)}handleMapBrowserEvent(e){if(!this.frameState_)return;const t=e.originalEvent,r=t.type;if(r===ST.POINTERDOWN||r===en.WHEEL||r===en.KEYDOWN){const i=this.getOwnerDocument(),s=this.viewport_.getRootNode?this.viewport_.getRootNode():i,a=t.target,o=s instanceof ShadowRoot?s.host===a?s.host.ownerDocument:s:s===i?i.documentElement:s;if(this.overlayContainerStopEvent_.contains(a)||!o.contains(a))return}if(e.frameState=this.frameState_,this.dispatchEvent(e)!==!1){const i=this.getInteractions().getArray().slice();for(let s=i.length-1;s>=0;s--){const a=i[s];if(a.getMap()!==this||!a.getActive()||!this.getTargetElement())continue;if(!a.handleEvent(e)||e.propagationStopped)break}}}handlePostRender(){const e=this.frameState_,t=this.tileQueue_;if(!t.isEmpty()){let i=this.maxTilesLoading_,s=i;if(e){const a=e.viewHints;if(a[Qr.ANIMATING]||a[Qr.INTERACTING]){const o=Date.now()-e.time>8;i=o?0:8,s=o?0:2}}t.getTilesLoading()<i&&(t.reprioritize(),t.loadMoreTiles(i,s))}e&&this.renderer_&&!e.animate&&(this.renderComplete_?(this.hasListener(Si.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(Si.RENDERCOMPLETE,e),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new Wf(tu.LOADEND,this,e)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new Wf(tu.LOADSTART,this,e))));const r=this.postRenderFunctions_;if(e)for(let i=0,s=r.length;i<s;++i)r[i](this,e);r.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let r=0,i=this.targetChangeHandlerKeys_.length;r<i;++r)or(this.targetChangeHandlerKeys_[r]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(en.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(en.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_&&!fu(this.targetElement_)){this.resizeObserver_?.unobserve(this.targetElement_);const r=this.targetElement_.getRootNode();r instanceof ShadowRoot&&this.resizeObserver_.unobserve(r.host),this.setSize(void 0)}const e=this.getTarget(),t=typeof e=="string"?document.getElementById(e):e;if(this.targetElement_=t,!t)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{if(fu(t)||t.appendChild(this.viewport_),this.renderer_||(this.renderer_=new pq(this)),!fu(t)){this.mapBrowserEventHandler_=new GX(this,this.moveTolerance_);for(const i in Or)this.mapBrowserEventHandler_.addEventListener(Or[i],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(en.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(en.WHEEL,this.boundHandleBrowserEvent_,XD?{passive:!1}:!1);let r;if(this.keyboardEventTarget_)r=this.keyboardEventTarget_;else{const i=t.getRootNode();r=i instanceof ShadowRoot?i.host:t}if(this.targetChangeHandlerKeys_=[pn(r,en.KEYDOWN,this.handleBrowserEvent,this),pn(r,en.KEYPRESS,this.handleBrowserEvent,this)],t instanceof HTMLElement){const i=t.getRootNode();i instanceof ShadowRoot&&this.resizeObserver_.observe(i.host),this.resizeObserver_?.observe(t)}}this.updateSize()}}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(or(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(or(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const e=this.getView();e&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=pn(e,C0.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=pn(e,en.CHANGE,this.handleViewPropertyChanged_,this),e.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(or),this.layerGroupPropertyListenerKeys_=null);const e=this.getLayerGroup();e&&(this.handleLayerAdd_(new ru("addlayer",e)),this.layerGroupPropertyListenerKeys_=[pn(e,C0.PROPERTYCHANGE,this.render,this),pn(e,en.CHANGE,this.render,this),pn(e,"addlayer",this.handleLayerAdd_,this),pn(e,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){if(!this.frameState_)return;const e=this.frameState_.layerStatesArray;for(let t=0,r=e.length;t<r;++t){const i=e[t].layer;i.hasRenderer()&&i.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(e){return this.getControls().remove(e)}removeInteraction(e){return this.getInteractions().remove(e)}removeLayer(e){return this.getLayerGroup().getLayers().remove(e)}handleLayerRemove_(e){rF(e.layer)}removeOverlay(e){return this.getOverlays().remove(e)}renderFrame_(e){const t=this.getSize(),r=this.getView(),i=this.frameState_;let s=null;if(t!==void 0&&EN(t)&&r&&r.isDef()){const a=r.getHints(this.frameState_?this.frameState_.viewHints:void 0),o=r.getState();if(s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:P_(o.center,o.resolution,o.rotation,t),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:t,tileQueue:this.tileQueue_,time:e,usedTiles:{},viewState:o,viewHints:a,wantedTiles:{},mapId:Kt(this),renderTargets:{}},o.nextCenter&&o.nextResolution){const l=isNaN(o.nextRotation)?o.rotation:o.nextRotation;s.nextExtent=P_(o.nextCenter,o.nextResolution,l,t)}}this.frameState_=s,this.renderer_.renderFrame(s),s&&(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),i&&(!this.previousExtent_||!sg(this.previousExtent_)&&!ad(s.extent,this.previousExtent_))&&(this.dispatchEvent(new Wf(tu.MOVESTART,this,i)),this.previousExtent_=y1(this.previousExtent_)),this.previousExtent_&&!s.viewHints[Qr.ANIMATING]&&!s.viewHints[Qr.INTERACTING]&&!ad(s.extent,this.previousExtent_)&&(this.dispatchEvent(new Wf(tu.MOVEEND,this,s)),yD(s.extent,this.previousExtent_))),this.dispatchEvent(new Wf(tu.POSTRENDER,this,s)),this.renderComplete_=(this.hasListener(tu.LOADSTART)||this.hasListener(tu.LOADEND)||this.hasListener(Si.RENDERCOMPLETE))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(e){const t=this.getLayerGroup();t&&this.handleLayerRemove_(new ru("removelayer",t)),this.set(rs.LAYERGROUP,e)}setSize(e){this.set(rs.SIZE,e)}setTarget(e){this.set(rs.TARGET,e)}setView(e){if(!e||e instanceof Zo){this.set(rs.VIEW,e);return}this.set(rs.VIEW,new Zo);const t=this;e.then(function(r){t.setView(new Zo(r))})}updateSize(){const e=this.getTargetElement();let t;if(e){let i,s;if(fu(e))i=e.width,s=e.height;else{const a=getComputedStyle(e);i=e.offsetWidth-parseFloat(a.borderLeftWidth)-parseFloat(a.paddingLeft)-parseFloat(a.paddingRight)-parseFloat(a.borderRightWidth),s=e.offsetHeight-parseFloat(a.borderTopWidth)-parseFloat(a.paddingTop)-parseFloat(a.paddingBottom)-parseFloat(a.borderBottomWidth)}!isNaN(i)&&!isNaN(s)&&(t=[Math.max(0,i),Math.max(0,s)],!EN(t)&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)&&kD("No map visible because the map container's width or height are 0."))}const r=this.getSize();t&&(!r||!gc(t,r))&&(this.setSize(t),this.updateViewportSize_(t))}updateViewportSize_(e){const t=this.getView();t&&t.setViewportSize(e)}};function xq(n){let e=null;n.keyboardEventTarget!==void 0&&(e=typeof n.keyboardEventTarget=="string"?document.getElementById(n.keyboardEventTarget):n.keyboardEventTarget);const t={},r=n.layers&&typeof n.layers.getLayers=="function"?n.layers:new Ow({layers:n.layers});t[rs.LAYERGROUP]=r,t[rs.TARGET]=n.target,t[rs.VIEW]=n.view instanceof Zo?n.view:new Zo;let i;n.controls!==void 0&&(Array.isArray(n.controls)?i=new Ma(n.controls.slice()):(Rn(typeof n.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),i=n.controls));let s;n.interactions!==void 0&&(Array.isArray(n.interactions)?s=new Ma(n.interactions.slice()):(Rn(typeof n.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),s=n.interactions));let a;return n.overlays!==void 0?Array.isArray(n.overlays)?a=new Ma(n.overlays.slice()):(Rn(typeof n.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),a=n.overlays):a=new Ma,{controls:i,interactions:s,keyboardEventTarget:e,overlays:a,values:t}}const XS="units",_q=[1,2,5],fm=25.4/.28;class vq extends jw{constructor(e){e=e||{};const t=document.createElement("div");t.style.pointerEvents="none",super({element:t,render:e.render,target:e.target}),this.on,this.once,this.un;const r=e.className!==void 0?e.className:e.bar?"ol-scale-bar":"ol-scale-line";this.innerElement_=document.createElement("div"),this.innerElement_.className=r+"-inner",this.element.className=r+" "+w1,this.element.appendChild(this.innerElement_),this.viewState_=null,this.minWidth_=e.minWidth!==void 0?e.minWidth:64,this.maxWidth_=e.maxWidth,this.renderedVisible_=!1,this.renderedWidth_=void 0,this.renderedHTML_="",this.addChangeListener(XS,this.handleUnitsChanged_),this.setUnits(e.units||"metric"),this.scaleBar_=e.bar||!1,this.scaleBarSteps_=e.steps||4,this.scaleBarText_=e.text||!1,this.dpi_=e.dpi||void 0}getUnits(){return this.get(XS)}handleUnitsChanged_(){this.updateElement_()}setUnits(e){this.set(XS,e)}setDpi(e){this.dpi_=e}updateElement_(){const e=this.viewState_;if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=e.center,r=e.projection,i=this.getUnits(),s=i=="degrees"?"degrees":"m";let a=j_(r,e.resolution,t,s);const o=this.minWidth_*(this.dpi_||fm)/fm,l=this.maxWidth_!==void 0?this.maxWidth_*(this.dpi_||fm)/fm:void 0;let c=o*a,h="";if(i=="degrees"){const k=P0.degrees;c*=k,c<k/60?(h="",a*=3600):c<k?(h="",a*=60):h=""}else if(i=="imperial")c<.9144?(h="in",a/=.0254):c<1609.344?(h="ft",a/=.3048):(h="mi",a/=1609.344);else if(i=="nautical")a/=1852,h="NM";else if(i=="metric")c<1e-6?(h="nm",a*=1e9):c<.001?(h="m",a*=1e6):c<1?(h="mm",a*=1e3):c<1e3?h="m":(h="km",a/=1e3);else if(i=="us")c<.9144?(h="in",a*=39.37):c<1609.344?(h="ft",a/=.30480061):(h="mi",a/=1609.3472);else throw new Error("Invalid units");let g=3*Math.floor(Math.log(o*a)/Math.log(10)),m,y,_,x=0,w,b;for(;;){_=Math.floor(g/3);const k=Math.pow(10,_);if(m=_q[(g%3+3)%3]*k,y=Math.round(m/a),isNaN(y)){this.element.style.display="none",this.renderedVisible_=!1;return}if(l!==void 0&&y>=l){m=x,y=w,_=b;break}else if(y>=o)break;x=m,w=y,b=_,++g}const T=this.scaleBar_?this.createScaleBar(y,m,h):m.toFixed(_<0?-_:0)+" "+h;this.renderedHTML_!=T&&(this.innerElement_.innerHTML=T,this.renderedHTML_=T),this.renderedWidth_!=y&&(this.innerElement_.style.width=y+"px",this.renderedWidth_=y),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}createScaleBar(e,t,r){const i=this.getScaleForResolution(),s=i<1?Math.round(1/i).toLocaleString()+" : 1":"1 : "+Math.round(i).toLocaleString(),a=this.scaleBarSteps_,o=e/a,l=[this.createMarker("absolute")];for(let h=0;h<a;++h){const g=h%2===0?"ol-scale-singlebar-odd":"ol-scale-singlebar-even";l.push(`<div><div class="ol-scale-singlebar ${g}" style="width: ${o}px;"></div>`+this.createMarker("relative")+(h%2===0||a===2?this.createStepText(h,e,!1,t,r):"")+"</div>")}return l.push(this.createStepText(a,e,!0,t,r)),(this.scaleBarText_?`<div class="ol-scale-text" style="width: ${e}px;">`+s+"</div>":"")+l.join("")}createMarker(e){return`<div class="ol-scale-step-marker" style="position: ${e}; top: ${e==="absolute"?3:-10}px;"></div>`}createStepText(e,t,r,i,s){const o=(e===0?0:Math.round(i/this.scaleBarSteps_*e*100)/100)+(e===0?"":" "+s),l=e===0?-3:t/this.scaleBarSteps_*-1,c=e===0?0:t/this.scaleBarSteps_*2;return`<div class="ol-scale-step-text" style="margin-left: ${l}px;text-align: ${e===0?"left":"center"};min-width: ${c}px;left: ${r?t+"px":"unset"};">`+o+"</div>"}getScaleForResolution(){const e=j_(this.viewState_.projection,this.viewState_.resolution,this.viewState_.center,"m"),t=this.dpi_||fm,r=1e3/25.4;return e*r*t}render(e){const t=e.frameState;t?this.viewState_=t.viewState:this.viewState_=null,this.updateElement_()}}const wq={},tM=n=>{let e;const t=new Set,r=(h,g)=>{const m=typeof h=="function"?h(e):h;if(!Object.is(m,e)){const y=e;e=g??(typeof m!="object"||m===null)?m:Object.assign({},e,m),t.forEach(_=>_(e,y))}},i=()=>e,l={setState:r,getState:i,getInitialState:()=>c,subscribe:h=>(t.add(h),()=>t.delete(h)),destroy:()=>{(wq?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},c=e=n(r,i,l);return l},Eq=n=>n?tM(n):tM;var qS={exports:{}},YS={},ZS={exports:{}},JS={};var nM;function Sq(){if(nM)return JS;nM=1;var n=f1();function e(g,m){return g===m&&(g!==0||1/g===1/m)||g!==g&&m!==m}var t=typeof Object.is=="function"?Object.is:e,r=n.useState,i=n.useEffect,s=n.useLayoutEffect,a=n.useDebugValue;function o(g,m){var y=m(),_=r({inst:{value:y,getSnapshot:m}}),x=_[0].inst,w=_[1];return s(function(){x.value=y,x.getSnapshot=m,l(x)&&w({inst:x})},[g,y,m]),i(function(){return l(x)&&w({inst:x}),g(function(){l(x)&&w({inst:x})})},[g]),a(y),y}function l(g){var m=g.getSnapshot;g=g.value;try{var y=m();return!t(g,y)}catch{return!0}}function c(g,m){return m()}var h=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:o;return JS.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:h,JS}var rM;function bq(){return rM||(rM=1,ZS.exports=Sq()),ZS.exports}var iM;function Tq(){if(iM)return YS;iM=1;var n=f1(),e=bq();function t(c,h){return c===h&&(c!==0||1/c===1/h)||c!==c&&h!==h}var r=typeof Object.is=="function"?Object.is:t,i=e.useSyncExternalStore,s=n.useRef,a=n.useEffect,o=n.useMemo,l=n.useDebugValue;return YS.useSyncExternalStoreWithSelector=function(c,h,g,m,y){var _=s(null);if(_.current===null){var x={hasValue:!1,value:null};_.current=x}else x=_.current;_=o(function(){function b(B){if(!T){if(T=!0,k=B,B=m(B),y!==void 0&&x.hasValue){var R=x.value;if(y(R,B))return L=R}return L=B}if(R=L,r(k,B))return R;var A=m(B);return y!==void 0&&y(R,A)?(k=B,R):(k=B,L=A)}var T=!1,k,L,O=g===void 0?null:g;return[function(){return b(h())},O===null?void 0:function(){return b(O())}]},[h,g,m,y]);var w=i(c,_[0],_[1]);return a(function(){x.hasValue=!0,x.value=w},[w]),l(w),w},YS}var sM;function Rq(){return sM||(sM=1,qS.exports=Tq()),qS.exports}var Aq=Rq();const kq=XR(Aq),sF={},{useDebugValue:Iq}=CU,{useSyncExternalStoreWithSelector:Cq}=kq;let aM=!1;const Pq=n=>n;function Nq(n,e=Pq,t){(sF?"production":void 0)!=="production"&&t&&!aM&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),aM=!0);const r=Cq(n.subscribe,n.getState,n.getServerState||n.getInitialState,e,t);return Iq(r),r}const Mq=n=>{(sF?"production":void 0)!=="production"&&typeof n!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof n=="function"?Eq(n):n,t=(r,i)=>Nq(e,r,i);return Object.assign(t,e),t},qi=n=>Mq;var aF=Symbol.for("immer-nothing"),oM=Symbol.for("immer-draftable"),fa=Symbol.for("immer-state");function lo(n,...e){throw new Error(`[Immer] minified error nr: ${n}. Full error at: https://bit.ly/3cXEKWf`)}var Pp=Object.getPrototypeOf;function O0(n){return!!n&&!!n[fa]}function ud(n){return n?oF(n)||Array.isArray(n)||!!n[oM]||!!n.constructor?.[oM]||k1(n)||Vw(n):!1}var Lq=Object.prototype.constructor.toString(),lM=new WeakMap;function oF(n){if(!n||typeof n!="object")return!1;const e=Object.getPrototypeOf(n);if(e===null||e===Object.prototype)return!0;const t=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;if(t===Object)return!0;if(typeof t!="function")return!1;let r=lM.get(t);return r===void 0&&(r=Function.toString.call(t),lM.set(t,r)),r===Lq}function Q_(n,e,t=!0){Fw(n)===0?(t?Reflect.ownKeys(n):Object.keys(n)).forEach(i=>{e(i,n[i],n)}):n.forEach((r,i)=>e(i,r,n))}function Fw(n){const e=n[fa];return e?e.type_:Array.isArray(n)?1:k1(n)?2:Vw(n)?3:0}function TT(n,e){return Fw(n)===2?n.has(e):Object.prototype.hasOwnProperty.call(n,e)}function lF(n,e,t){const r=Fw(n);r===2?n.set(e,t):r===3?n.add(t):n[e]=t}function Oq(n,e){return n===e?n!==0||1/n===1/e:n!==n&&e!==e}function k1(n){return n instanceof Map}function Vw(n){return n instanceof Set}function Rh(n){return n.copy_||n.base_}function RT(n,e){if(k1(n))return new Map(n);if(Vw(n))return new Set(n);if(Array.isArray(n))return Array.prototype.slice.call(n);const t=oF(n);if(e===!0||e==="class_only"&&!t){const r=Object.getOwnPropertyDescriptors(n);delete r[fa];let i=Reflect.ownKeys(r);for(let s=0;s<i.length;s++){const a=i[s],o=r[a];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(r[a]={configurable:!0,writable:!0,enumerable:o.enumerable,value:n[a]})}return Object.create(Pp(n),r)}else{const r=Pp(n);if(r!==null&&t)return{...n};const i=Object.create(r);return Object.assign(i,n)}}function HA(n,e=!1){return Bw(n)||O0(n)||!ud(n)||(Fw(n)>1&&Object.defineProperties(n,{set:Tx,add:Tx,clear:Tx,delete:Tx}),Object.freeze(n),e&&Object.values(n).forEach(t=>HA(t,!0))),n}function Dq(){lo(2)}var Tx={value:Dq};function Bw(n){return n===null||typeof n!="object"?!0:Object.isFrozen(n)}var jq={};function hd(n){const e=jq[n];return e||lo(0,n),e}var Np;function cF(){return Np}function Fq(n,e){return{drafts_:[],parent_:n,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function cM(n,e){e&&(hd("Patches"),n.patches_=[],n.inversePatches_=[],n.patchListener_=e)}function AT(n){kT(n),n.drafts_.forEach(Vq),n.drafts_=null}function kT(n){n===Np&&(Np=n.parent_)}function uM(n){return Np=Fq(Np,n)}function Vq(n){const e=n[fa];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function hM(n,e){e.unfinalizedDrafts_=e.drafts_.length;const t=e.drafts_[0];return n!==void 0&&n!==t?(t[fa].modified_&&(AT(e),lo(4)),ud(n)&&(n=ev(e,n),e.parent_||tv(e,n)),e.patches_&&hd("Patches").generateReplacementPatches_(t[fa].base_,n,e.patches_,e.inversePatches_)):n=ev(e,t,[]),AT(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),n!==aF?n:void 0}function ev(n,e,t){if(Bw(e))return e;const r=n.immer_.shouldUseStrictIteration(),i=e[fa];if(!i)return Q_(e,(s,a)=>dM(n,i,e,s,a,t),r),e;if(i.scope_!==n)return e;if(!i.modified_)return tv(n,i.base_,!0),i.base_;if(!i.finalized_){i.finalized_=!0,i.scope_.unfinalizedDrafts_--;const s=i.copy_;let a=s,o=!1;i.type_===3&&(a=new Set(s),s.clear(),o=!0),Q_(a,(l,c)=>dM(n,i,s,l,c,t,o),r),tv(n,s,!1),t&&n.patches_&&hd("Patches").generatePatches_(i,t,n.patches_,n.inversePatches_)}return i.copy_}function dM(n,e,t,r,i,s,a){if(i==null||typeof i!="object"&&!a)return;const o=Bw(i);if(!(o&&!a)){if(O0(i)){const l=s&&e&&e.type_!==3&&!TT(e.assigned_,r)?s.concat(r):void 0,c=ev(n,i,l);if(lF(t,r,c),O0(c))n.canAutoFreeze_=!1;else return}else a&&t.add(i);if(ud(i)&&!o){if(!n.immer_.autoFreeze_&&n.unfinalizedDrafts_<1||e&&e.base_&&e.base_[r]===i&&o)return;ev(n,i),(!e||!e.scope_.parent_)&&typeof r!="symbol"&&(k1(t)?t.has(r):Object.prototype.propertyIsEnumerable.call(t,r))&&tv(n,i)}}}function tv(n,e,t=!1){!n.parent_&&n.immer_.autoFreeze_&&n.canAutoFreeze_&&HA(e,t)}function Bq(n,e){const t=Array.isArray(n),r={type_:t?1:0,scope_:e?e.scope_:cF(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:n,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=r,s=KA;t&&(i=[r],s=Mp);const{revoke:a,proxy:o}=Proxy.revocable(i,s);return r.draft_=o,r.revoke_=a,o}var KA={get(n,e){if(e===fa)return n;const t=Rh(n);if(!TT(t,e))return Gq(n,t,e);const r=t[e];return n.finalized_||!ud(r)?r:r===QS(n.base_,e)?(eb(n),n.copy_[e]=CT(r,n)):r},has(n,e){return e in Rh(n)},ownKeys(n){return Reflect.ownKeys(Rh(n))},set(n,e,t){const r=uF(Rh(n),e);if(r?.set)return r.set.call(n.draft_,t),!0;if(!n.modified_){const i=QS(Rh(n),e),s=i?.[fa];if(s&&s.base_===t)return n.copy_[e]=t,n.assigned_[e]=!1,!0;if(Oq(t,i)&&(t!==void 0||TT(n.base_,e)))return!0;eb(n),IT(n)}return n.copy_[e]===t&&(t!==void 0||e in n.copy_)||Number.isNaN(t)&&Number.isNaN(n.copy_[e])||(n.copy_[e]=t,n.assigned_[e]=!0),!0},deleteProperty(n,e){return QS(n.base_,e)!==void 0||e in n.base_?(n.assigned_[e]=!1,eb(n),IT(n)):delete n.assigned_[e],n.copy_&&delete n.copy_[e],!0},getOwnPropertyDescriptor(n,e){const t=Rh(n),r=Reflect.getOwnPropertyDescriptor(t,e);return r&&{writable:!0,configurable:n.type_!==1||e!=="length",enumerable:r.enumerable,value:t[e]}},defineProperty(){lo(11)},getPrototypeOf(n){return Pp(n.base_)},setPrototypeOf(){lo(12)}},Mp={};Q_(KA,(n,e)=>{Mp[n]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});Mp.deleteProperty=function(n,e){return Mp.set.call(this,n,e,void 0)};Mp.set=function(n,e,t){return KA.set.call(this,n[0],e,t,n[0])};function QS(n,e){const t=n[fa];return(t?Rh(t):n)[e]}function Gq(n,e,t){const r=uF(e,t);return r?"value"in r?r.value:r.get?.call(n.draft_):void 0}function uF(n,e){if(!(e in n))return;let t=Pp(n);for(;t;){const r=Object.getOwnPropertyDescriptor(t,e);if(r)return r;t=Pp(t)}}function IT(n){n.modified_||(n.modified_=!0,n.parent_&&IT(n.parent_))}function eb(n){n.copy_||(n.copy_=RT(n.base_,n.scope_.immer_.useStrictShallowCopy_))}var zq=class{constructor(n){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(e,t,r)=>{if(typeof e=="function"&&typeof t!="function"){const s=t;t=e;const a=this;return function(l=s,...c){return a.produce(l,h=>t.call(this,h,...c))}}typeof t!="function"&&lo(6),r!==void 0&&typeof r!="function"&&lo(7);let i;if(ud(e)){const s=uM(this),a=CT(e,void 0);let o=!0;try{i=t(a),o=!1}finally{o?AT(s):kT(s)}return cM(s,r),hM(i,s)}else if(!e||typeof e!="object"){if(i=t(e),i===void 0&&(i=e),i===aF&&(i=void 0),this.autoFreeze_&&HA(i,!0),r){const s=[],a=[];hd("Patches").generateReplacementPatches_(e,i,s,a),r(s,a)}return i}else lo(1,e)},this.produceWithPatches=(e,t)=>{if(typeof e=="function")return(a,...o)=>this.produceWithPatches(a,l=>e(l,...o));let r,i;return[this.produce(e,t,(a,o)=>{r=a,i=o}),r,i]},typeof n?.autoFreeze=="boolean"&&this.setAutoFreeze(n.autoFreeze),typeof n?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(n.useStrictShallowCopy),typeof n?.useStrictIteration=="boolean"&&this.setUseStrictIteration(n.useStrictIteration)}createDraft(n){ud(n)||lo(8),O0(n)&&(n=Uq(n));const e=uM(this),t=CT(n,void 0);return t[fa].isManual_=!0,kT(e),t}finishDraft(n,e){const t=n&&n[fa];(!t||!t.isManual_)&&lo(9);const{scope_:r}=t;return cM(r,e),hM(void 0,r)}setAutoFreeze(n){this.autoFreeze_=n}setUseStrictShallowCopy(n){this.useStrictShallowCopy_=n}setUseStrictIteration(n){this.useStrictIteration_=n}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(n,e){let t;for(t=e.length-1;t>=0;t--){const i=e[t];if(i.path.length===0&&i.op==="replace"){n=i.value;break}}t>-1&&(e=e.slice(t+1));const r=hd("Patches").applyPatches_;return O0(n)?r(n,e):this.produce(n,i=>r(i,e))}};function CT(n,e){const t=k1(n)?hd("MapSet").proxyMap_(n,e):Vw(n)?hd("MapSet").proxySet_(n,e):Bq(n,e);return(e?e.scope_:cF()).drafts_.push(t),t}function Uq(n){return O0(n)||lo(10,n),hF(n)}function hF(n){if(!ud(n)||Bw(n))return n;const e=n[fa];let t,r=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,t=RT(n,e.scope_.immer_.useStrictShallowCopy_),r=e.scope_.immer_.shouldUseStrictIteration()}else t=RT(n,!0);return Q_(t,(i,s)=>{lF(t,i,hF(s))},r),e&&(e.finalized_=!1),t}var $q=new zq,Wq=$q.produce;const Hq=n=>(e,t,r)=>(r.setState=(i,s,...a)=>{const o=typeof i=="function"?Wq(i):i;return e(o,s,...a)},n(r.setState,t,r)),lg=Hq,ls=qi()(lg((n,e)=>({tracking:!1,position:null,heading:null,smoothHeading:null,accuracy:null,speed:null,headingSource:null,watchId:null,firstFix:!0,config:{smoothingFactor:.2,minRotationSpeed:8,centerOnUser:!0,animationDuration:100},startTracking:()=>{n(t=>{t.tracking=!0})},stopTracking:()=>{n(t=>{const{watchId:r}=e();r!==null&&navigator.geolocation.clearWatch(r),t.tracking=!1,t.speed=null,t.headingSource=null,t.watchId=null})},updatePosition:t=>{n(r=>{r.position={lat:t.coords.latitude,lng:t.coords.longitude},r.accuracy=t.coords.accuracy,r.speed=t.coords.speed;const i=15,s=.5;if(!(t.coords.accuracy!==null&&t.coords.accuracy<i)){r.headingSource=null;return}if(t.coords.heading!==null&&t.coords.speed!==null&&t.coords.speed>s){r.headingSource="gps";const o=t.coords.heading;e().updateHeading(o,"gps")}else r.headingSource="compass"})},updateHeading:(t,r="compass")=>{n(i=>{const{smoothHeading:s,config:a}=e();if(s===null){i.smoothHeading=t,i.heading=t;return}let o=t-s;o>180&&(o-=360),o<-180&&(o+=360);const l=r==="compass"?5:3;if(Math.abs(o)<l)return;const h=s+o*(r==="gps"?.5:.35);i.smoothHeading=(h+360)%360,i.heading=t})},setSmoothedHeading:t=>{n(r=>{r.smoothHeading=t,r.heading=t})},setWatchId:t=>{n(r=>{r.watchId=t})},resetFirstFix:()=>{n(t=>{t.firstFix=!1})}}))),Gw={"TMK 1850":{name:"TMK 1850",factory:async()=>null,immediateLoad:!0,tier:"premium"},"Bonnebladen 1900":{name:"Bonnebladen 1900",factory:async()=>null,immediateLoad:!0,tier:"premium"},"AHN 0.5m":{name:"AHN 0.5m",factory:async()=>{const{createAHNLayerOL:n}=await xt(async()=>{const{createAHNLayerOL:e}=await import("./pdokWMSLayers-CP68xMic.js");return{createAHNLayerOL:e}},[]);return n()},immediateLoad:!0},Geomorfologie:{name:"Geomorfologie",factory:async()=>{const{createGeomorfologieLayerOL:n}=await xt(async()=>{const{createGeomorfologieLayerOL:e}=await import("./pdokWMSLayers-CP68xMic.js");return{createGeomorfologieLayerOL:e}},[]);return n()},immediateLoad:!0},Bodemkaart:{name:"Bodemkaart",factory:async()=>{const{createBodemkaartLayerOL:n}=await xt(async()=>{const{createBodemkaartLayerOL:e}=await import("./pdokWMSLayers-CP68xMic.js");return{createBodemkaartLayerOL:e}},[]);return n()},immediateLoad:!0},IKAW:{name:"IKAW",factory:async()=>{const{createIKAWLayerOL:n}=await xt(async()=>{const{createIKAWLayerOL:e}=await import("./pdokWMSLayers-CP68xMic.js");return{createIKAWLayerOL:e}},[]);return n()},immediateLoad:!0},"FAMKE Steentijd":{name:"FAMKE Steentijd",factory:async()=>{const{createFAMKESteentijdLayerOL:n}=await xt(async()=>{const{createFAMKESteentijdLayerOL:e}=await import("./pdokWMSLayers-CP68xMic.js");return{createFAMKESteentijdLayerOL:e}},[]);return n()},immediateLoad:!0},"FAMKE IJzertijd":{name:"FAMKE IJzertijd",factory:async()=>{const{createFAMKEIJzertijdLayerOL:n}=await xt(async()=>{const{createFAMKEIJzertijdLayerOL:e}=await import("./pdokWMSLayers-CP68xMic.js");return{createFAMKEIJzertijdLayerOL:e}},[]);return n()},immediateLoad:!0},Essen:{name:"Essen",factory:async()=>{const{createEssenLayerOL:n}=await xt(async()=>{const{createEssenLayerOL:e}=await import("./pdokWMSLayers-CP68xMic.js");return{createEssenLayerOL:e}},[]);return n()},immediateLoad:!0},Rijksmonumenten:{name:"Rijksmonumenten",factory:async()=>{const{createRijksmonumentenLayerOL:n}=await xt(async()=>{const{createRijksmonumentenLayerOL:e}=await import("./pdokWMSLayers-CP68xMic.js");return{createRijksmonumentenLayerOL:e}},[]);return n()},immediateLoad:!0},"Archeo Onderzoeken":{name:"Archeo Onderzoeken",factory:async()=>{const{createArcheoOnderzoekenLayerOL:n}=await xt(async()=>{const{createArcheoOnderzoekenLayerOL:e}=await import("./pdokWMSLayers-CP68xMic.js");return{createArcheoOnderzoekenLayerOL:e}},[]);return n()},immediateLoad:!0},Werelderfgoed:{name:"Werelderfgoed",factory:async()=>{const{createWerelderfgoedLayerOL:n}=await xt(async()=>{const{createWerelderfgoedLayerOL:e}=await import("./pdokWMSLayers-CP68xMic.js");return{createWerelderfgoedLayerOL:e}},[]);return n()},immediateLoad:!0},Terpen:{name:"Terpen",factory:async()=>{const{createTerpenLayerOL:n}=await xt(async()=>{const{createTerpenLayerOL:e}=await import("./terpenOL-BG2ZYJ9q.js");return{createTerpenLayerOL:e}},[]);return n()},immediateLoad:!0,tier:"premium"},Verdedigingslinies:{name:"Verdedigingslinies",factory:async()=>{const{createLiniesLayerOL:n}=await xt(async()=>{const{createLiniesLayerOL:e}=await import("./verdedigingswerkenOL-B23yaUSj.js");return{createLiniesLayerOL:e}},[]);return n()},immediateLoad:!0},Inundatiegebieden:{name:"Inundatiegebieden",factory:async()=>{const{createInundatiesLayerOL:n}=await xt(async()=>{const{createInundatiesLayerOL:e}=await import("./verdedigingswerkenOL-B23yaUSj.js");return{createInundatiesLayerOL:e}},[]);return n()},immediateLoad:!0},"Militaire Objecten":{name:"Militaire Objecten",factory:async()=>{const{createMilitaireObjectenLayerOL:n}=await xt(async()=>{const{createMilitaireObjectenLayerOL:e}=await import("./verdedigingswerkenOL-B23yaUSj.js");return{createMilitaireObjectenLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 800 n.Chr.":{name:"Paleokaart 800 n.Chr.",factory:async()=>{const{createPaleo800ncLayerOL:n}=await xt(async()=>{const{createPaleo800ncLayerOL:e}=await import("./paleokaartOL-CqGS3Oce.js");return{createPaleo800ncLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 100 n.Chr.":{name:"Paleokaart 100 n.Chr.",factory:async()=>{const{createPaleo100ncLayerOL:n}=await xt(async()=>{const{createPaleo100ncLayerOL:e}=await import("./paleokaartOL-CqGS3Oce.js");return{createPaleo100ncLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 500 v.Chr.":{name:"Paleokaart 500 v.Chr.",factory:async()=>{const{createPaleo500vcLayerOL:n}=await xt(async()=>{const{createPaleo500vcLayerOL:e}=await import("./paleokaartOL-CqGS3Oce.js");return{createPaleo500vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 1500 v.Chr.":{name:"Paleokaart 1500 v.Chr.",factory:async()=>{const{createPaleo1500vcLayerOL:n}=await xt(async()=>{const{createPaleo1500vcLayerOL:e}=await import("./paleokaartOL-CqGS3Oce.js");return{createPaleo1500vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 2750 v.Chr.":{name:"Paleokaart 2750 v.Chr.",factory:async()=>{const{createPaleo2750vcLayerOL:n}=await xt(async()=>{const{createPaleo2750vcLayerOL:e}=await import("./paleokaartOL-CqGS3Oce.js");return{createPaleo2750vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 5500 v.Chr.":{name:"Paleokaart 5500 v.Chr.",factory:async()=>{const{createPaleo5500vcLayerOL:n}=await xt(async()=>{const{createPaleo5500vcLayerOL:e}=await import("./paleokaartOL-CqGS3Oce.js");return{createPaleo5500vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 9000 v.Chr.":{name:"Paleokaart 9000 v.Chr.",factory:async()=>{const{createPaleo9000vcLayerOL:n}=await xt(async()=>{const{createPaleo9000vcLayerOL:e}=await import("./paleokaartOL-CqGS3Oce.js");return{createPaleo9000vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Religieus Erfgoed":{name:"Religieus Erfgoed",factory:async()=>{const{createReligieusErfgoedLayerOL:n}=await xt(async()=>{const{createReligieusErfgoedLayerOL:e}=await import("./religieusErfgoedOL-BAeBLAQC.js");return{createReligieusErfgoedLayerOL:e}},[]);return n()},immediateLoad:!0},"AHN4 Hoogtekaart Kleur":{name:"AHN4 Hoogtekaart Kleur",factory:async()=>{const{createAHN4ColorElevationLayerOL:n}=await xt(async()=>{const{createAHN4ColorElevationLayerOL:e}=await import("./hillshadeLayers-uEdX5me8.js");return{createAHN4ColorElevationLayerOL:e}},[]);return n()},immediateLoad:!0,tier:"premium"},"AHN4 Hillshade NL":{name:"AHN4 Hillshade NL",factory:async()=>{const{createAHN4HillshadeLayerOL:n}=await xt(async()=>{const{createAHN4HillshadeLayerOL:e}=await import("./hillshadeLayers-uEdX5me8.js");return{createAHN4HillshadeLayerOL:e}},[]);return n()},immediateLoad:!0,tier:"premium"},"AHN4 Multi-Hillshade NL":{name:"AHN4 Multi-Hillshade NL",factory:async()=>{const{createAHN4MultiHillshadeLayerOL:n}=await xt(async()=>{const{createAHN4MultiHillshadeLayerOL:e}=await import("./hillshadeLayers-uEdX5me8.js");return{createAHN4MultiHillshadeLayerOL:e}},[]);return n()},immediateLoad:!0,tier:"premium"},"AHN4 Hillshade Kleur":{name:"AHN4 Hillshade Kleur",factory:async()=>{const{createAHN4ShadedReliefLayerOL:n}=await xt(async()=>{const{createAHN4ShadedReliefLayerOL:e}=await import("./hillshadeLayers-uEdX5me8.js");return{createAHN4ShadedReliefLayerOL:e}},[]);return n()},immediateLoad:!0,tier:"premium"},Gewaspercelen:{name:"Gewaspercelen",factory:async()=>{const{createGewaspercelenLayerOL:n}=await xt(async()=>{const{createGewaspercelenLayerOL:e}=await import("./pdokWMSLayers-CP68xMic.js");return{createGewaspercelenLayerOL:e}},[]);return n()},immediateLoad:!0,tier:"premium"},"Kadastrale Grenzen":{name:"Kadastrale Grenzen",factory:async()=>{const{createKadastraleKaartLayerOL:n}=await xt(async()=>{const{createKadastraleKaartLayerOL:e}=await import("./pdokWMSLayers-CP68xMic.js");return{createKadastraleKaartLayerOL:e}},[]);return n()},immediateLoad:!0},Scheepswrakken:{name:"Scheepswrakken",factory:async()=>{const{createScheepswrakkenLayerOL:n}=await xt(async()=>{const{createScheepswrakkenLayerOL:e}=await import("./pdokWMSLayers-CP68xMic.js");return{createScheepswrakkenLayerOL:e}},[]);return n()},immediateLoad:!0},"Woonheuvels ZH":{name:"Woonheuvels ZH",factory:async()=>{const{createWoonheuvelsLayerOL:n}=await xt(async()=>{const{createWoonheuvelsLayerOL:e}=await import("./pdokWMSLayers-CP68xMic.js");return{createWoonheuvelsLayerOL:e}},[]);return n()},immediateLoad:!0},"Romeinse Forten":{name:"Romeinse Forten",factory:async()=>{const{createRomeinseFortenLayerOL:n}=await xt(async()=>{const{createRomeinseFortenLayerOL:e}=await import("./romeinseFortenOL-pLxgGUYx.js");return{createRomeinseFortenLayerOL:e}},__vite__mapDeps([0,1]));return n()},immediateLoad:!1},"Romeinse Forten Lijnen":{name:"Romeinse Forten Lijnen",factory:async()=>{const{createRomeinseFortenLijnenLayerOL:n}=await xt(async()=>{const{createRomeinseFortenLijnenLayerOL:e}=await import("./romeinseFortenOL-pLxgGUYx.js");return{createRomeinseFortenLijnenLayerOL:e}},__vite__mapDeps([0,1]));return n()},immediateLoad:!1},Windmolens:{name:"Windmolens",factory:async()=>{const{createWindmolensLayerOL:n}=await xt(async()=>{const{createWindmolensLayerOL:e}=await import("./pdokWMSLayers-CP68xMic.js");return{createWindmolensLayerOL:e}},[]);return n()},immediateLoad:!0},Erfgoedlijnen:{name:"Erfgoedlijnen",factory:async()=>{const{createErfgoedlijnenLayerOL:n}=await xt(async()=>{const{createErfgoedlijnenLayerOL:e}=await import("./pdokWMSLayers-CP68xMic.js");return{createErfgoedlijnenLayerOL:e}},[]);return n()},immediateLoad:!0},"Oude Kernen":{name:"Oude Kernen",factory:async()=>{const{createOudeKernenLayerOL:n}=await xt(async()=>{const{createOudeKernenLayerOL:e}=await import("./pdokWMSLayers-CP68xMic.js");return{createOudeKernenLayerOL:e}},[]);return n()},immediateLoad:!0},"Relictenkaart Punten":{name:"Relictenkaart Punten",factory:async()=>{const{createRelictenPuntenLayerOL:n}=await xt(async()=>{const{createRelictenPuntenLayerOL:e}=await import("./relictenGelderlandOL-DwJWqCK0.js");return{createRelictenPuntenLayerOL:e}},[]);return n()},immediateLoad:!1},"Relictenkaart Lijnen":{name:"Relictenkaart Lijnen",factory:async()=>{const{createRelictenkaartLijnenLayerOL:n}=await xt(async()=>{const{createRelictenkaartLijnenLayerOL:e}=await import("./pdokWMSLayers-CP68xMic.js");return{createRelictenkaartLijnenLayerOL:e}},[]);return n()},immediateLoad:!0},"Relictenkaart Vlakken":{name:"Relictenkaart Vlakken",factory:async()=>{const{createRelictenkaartVlakkenLayerOL:n}=await xt(async()=>{const{createRelictenkaartVlakkenLayerOL:e}=await import("./pdokWMSLayers-CP68xMic.js");return{createRelictenkaartVlakkenLayerOL:e}},[]);return n()},immediateLoad:!0},"Verdronken Dorpen":{name:"Verdronken Dorpen",factory:async()=>{const{createVerdronkenDorpenLayerOL:n}=await xt(async()=>{const{createVerdronkenDorpenLayerOL:e}=await import("./pdokWMSLayers-CP68xMic.js");return{createVerdronkenDorpenLayerOL:e}},[]);return n()},immediateLoad:!0},"AMK Monumenten":{name:"AMK Monumenten",factory:async()=>{const{createAMKLayerOL:n}=await xt(async()=>{const{createAMKLayerOL:e}=await import("./amkOL-hM9oWUtH.js");return{createAMKLayerOL:e}},[]);return n()},immediateLoad:!1,tier:"premium"},"AMK Romeins":{name:"AMK Romeins",factory:async()=>{const{createAMKRomeinsLayerOL:n}=await xt(async()=>{const{createAMKRomeinsLayerOL:e}=await import("./amkOL-hM9oWUtH.js");return{createAMKRomeinsLayerOL:e}},[]);return n()},immediateLoad:!1,tier:"premium"},"AMK Steentijd":{name:"AMK Steentijd",factory:async()=>{const{createAMKSteentijdLayerOL:n}=await xt(async()=>{const{createAMKSteentijdLayerOL:e}=await import("./amkOL-hM9oWUtH.js");return{createAMKSteentijdLayerOL:e}},[]);return n()},immediateLoad:!1,tier:"premium"},"AMK Vroege ME":{name:"AMK Vroege ME",factory:async()=>{const{createAMKVroegeMELayerOL:n}=await xt(async()=>{const{createAMKVroegeMELayerOL:e}=await import("./amkOL-hM9oWUtH.js");return{createAMKVroegeMELayerOL:e}},[]);return n()},immediateLoad:!1,tier:"premium"},"AMK Late ME":{name:"AMK Late ME",factory:async()=>{const{createAMKLateMELayerOL:n}=await xt(async()=>{const{createAMKLateMELayerOL:e}=await import("./amkOL-hM9oWUtH.js");return{createAMKLateMELayerOL:e}},[]);return n()},immediateLoad:!1,tier:"premium"},"AMK Overig":{name:"AMK Overig",factory:async()=>{const{createAMKOverigLayerOL:n}=await xt(async()=>{const{createAMKOverigLayerOL:e}=await import("./amkOL-hM9oWUtH.js");return{createAMKOverigLayerOL:e}},[]);return n()},immediateLoad:!1,tier:"premium"},"Romeinse wegen (regio)":{name:"Romeinse wegen (regio)",factory:async()=>{const{createRomeinseWegenLayerOL:n}=await xt(async()=>{const{createRomeinseWegenLayerOL:e}=await import("./romeinsOL-B1DX4xsK.js");return{createRomeinseWegenLayerOL:e}},[]);return n()},immediateLoad:!1},"Romeinse wegen (Wereld)":{name:"Romeinse wegen (Wereld)",factory:async()=>{const{createRomeinseWegenWereldLayerOL:n}=await xt(async()=>{const{createRomeinseWegenWereldLayerOL:e}=await import("./romeinsOL-B1DX4xsK.js");return{createRomeinseWegenWereldLayerOL:e}},[]);return n()},immediateLoad:!1,tier:"premium",regions:["nl","be","de","fr"]},Kastelen:{name:"Kastelen",factory:async()=>{const{createKastelenLayerOL:n}=await xt(async()=>{const{createKastelenLayerOL:e}=await import("./kastelenOL-B4QnzVHi.js");return{createKastelenLayerOL:e}},__vite__mapDeps([2,1]));return n()},immediateLoad:!1},Runes:{name:"Runes",factory:async()=>{const{createRuinesLayerOL:n}=await xt(async()=>{const{createRuinesLayerOL:e}=await import("./ruinesOL-DR03H0KU.js");return{createRuinesLayerOL:e}},__vite__mapDeps([3,1]));return n()},immediateLoad:!1},Veengebieden:{name:"Veengebieden",factory:async()=>{const{createVeengebiedenLayerOL:n}=await xt(async()=>{const{createVeengebiedenLayerOL:e}=await import("./veengebiedenOL-Bbf_3hT_.js");return{createVeengebiedenLayerOL:e}},[]);return n()},immediateLoad:!1},Hunebedden:{name:"Hunebedden",factory:async()=>{const{createHunebeddenLayerOL:n}=await xt(async()=>{const{createHunebeddenLayerOL:e}=await import("./hunebeddenOL-C8DIjvKm.js");return{createHunebeddenLayerOL:e}},__vite__mapDeps([4,1]));return n()},immediateLoad:!1},"UIKAV Punten":{name:"UIKAV Punten",factory:async()=>{const{createUIKAVArcheoPuntenLayerOL:n}=await xt(async()=>{const{createUIKAVArcheoPuntenLayerOL:e}=await import("./uikavArcheoPuntenOL-jhv0tlyX.js");return{createUIKAVArcheoPuntenLayerOL:e}},__vite__mapDeps([5,1]));return n()},immediateLoad:!1,tier:"premium"},"UIKAV Vlakken":{name:"UIKAV Vlakken",factory:async()=>{const{createUIKAVVlakkenLayerOL:n}=await xt(async()=>{const{createUIKAVVlakkenLayerOL:e}=await import("./uikavVlakkenOL-D1YTlpjn.js");return{createUIKAVVlakkenLayerOL:e}},[]);return n()},immediateLoad:!1},"UIKAV Buffer":{name:"UIKAV Buffer",factory:async()=>{const{createUIKAVBufferlaagLayerOL:n}=await xt(async()=>{const{createUIKAVBufferlaagLayerOL:e}=await import("./uikavBufferlaagOL-bs7IQ_IO.js");return{createUIKAVBufferlaagLayerOL:e}},[]);return n()},immediateLoad:!1},"UIKAV Expert":{name:"UIKAV Expert",factory:async()=>{const{createUIKAVExpertLayerOL:n}=await xt(async()=>{const{createUIKAVExpertLayerOL:e}=await import("./uikavExpertOL-maEm85t6.js");return{createUIKAVExpertLayerOL:e}},[]);return n()},immediateLoad:!1},"UIKAV Indeling":{name:"UIKAV Indeling",factory:async()=>{const{createUIKAVUiterwaardenLayerOL:n}=await xt(async()=>{const{createUIKAVUiterwaardenLayerOL:e}=await import("./uikavUiterwaardenOL-ymghWycw.js");return{createUIKAVUiterwaardenLayerOL:e}},[]);return n()},immediateLoad:!1},Speeltuinen:{name:"Speeltuinen",factory:async()=>{const{createSpeeltuinenLayerOL:n}=await xt(async()=>{const{createSpeeltuinenLayerOL:e}=await import("./speeltuinenOL-ByF1QYAK.js");return{createSpeeltuinenLayerOL:e}},__vite__mapDeps([6,1]));return n()},immediateLoad:!1},Musea:{name:"Musea",factory:async()=>{const{createMuseaLayerOL:n}=await xt(async()=>{const{createMuseaLayerOL:e}=await import("./museaOL-CoBdoUFL.js");return{createMuseaLayerOL:e}},__vite__mapDeps([7,1]));return n()},immediateLoad:!1},Strandjes:{name:"Strandjes",factory:async()=>{const{createStrandjesLayerOL:n}=await xt(async()=>{const{createStrandjesLayerOL:e}=await import("./strandjesOL-DWpsAKWa.js");return{createStrandjesLayerOL:e}},[]);return n()},immediateLoad:!1},Parken:{name:"Parken",factory:async()=>{const{createParkenLayerOL:n}=await xt(async()=>{const{createParkenLayerOL:e}=await import("./parkenOL-BGkw5PpE.js");return{createParkenLayerOL:e}},[]);return n()},immediateLoad:!1},Kringloopwinkels:{name:"Kringloopwinkels",factory:async()=>{const{createKringloopwinkelsLayerOL:n}=await xt(async()=>{const{createKringloopwinkelsLayerOL:e}=await import("./kringloopwinkelsOL-CtAqOFnP.js");return{createKringloopwinkelsLayerOL:e}},__vite__mapDeps([8,1]));return n()},immediateLoad:!1},Ruiterpaden:{name:"Ruiterpaden",factory:async()=>{const{createRuiterpadenLayerOL:n}=await xt(async()=>{const{createRuiterpadenLayerOL:e}=await import("./ruiterpadenOL-IwhGbYHC.js");return{createRuiterpadenLayerOL:e}},[]);return n()},immediateLoad:!1},Laarzenpaden:{name:"Laarzenpaden",factory:async()=>{const{createLaarzenpadenLayerOL:n}=await xt(async()=>{const{createLaarzenpadenLayerOL:e}=await import("./laarzenpadenOL-B3EaF9ue.js");return{createLaarzenpadenLayerOL:e}},[]);return n()},immediateLoad:!1},"Fossielen Nederland":{name:"Fossielen Nederland",factory:async()=>{const{createFossielenLayerOL:n}=await xt(async()=>{const{createFossielenLayerOL:e}=await import("./fossielenOL-DmItwvxH.js");return{createFossielenLayerOL:e}},__vite__mapDeps([9,10,1]));return n()},immediateLoad:!1,tier:"premium"},"Fossielen Belgi":{name:"Fossielen Belgi",factory:async()=>{const{createFossielenBelgieLayerOL:n}=await xt(async()=>{const{createFossielenBelgieLayerOL:e}=await import("./fossielenBelgieOL-C9JfrCFC.js");return{createFossielenBelgieLayerOL:e}},__vite__mapDeps([11,10,1]));return n()},immediateLoad:!1,tier:"premium",regions:["be"]},"Fossielen Duitsland":{name:"Fossielen Duitsland",factory:async()=>{const{createFossielenDuitslandLayerOL:n}=await xt(async()=>{const{createFossielenDuitslandLayerOL:e}=await import("./fossielenDuitslandOL-BF5HCBrN.js");return{createFossielenDuitslandLayerOL:e}},__vite__mapDeps([12,10,1]));return n()},immediateLoad:!1,tier:"premium",regions:["de"]},"Fossielen Frankrijk":{name:"Fossielen Frankrijk",factory:async()=>{const{createFossielenFrankrijkLayerOL:n}=await xt(async()=>{const{createFossielenFrankrijkLayerOL:e}=await import("./fossielenFrankrijkOL-_ROoxzub.js");return{createFossielenFrankrijkLayerOL:e}},__vite__mapDeps([13,10,1]));return n()},immediateLoad:!1,tier:"premium",regions:["fr"]},"Fossiel Hotspots":{name:"Fossiel Hotspots",factory:async()=>{const{createFossielHotspotsLayerOL:n}=await xt(async()=>{const{createFossielHotspotsLayerOL:e}=await import("./fossielHotspotsOL-mUCwTNBQ.js");return{createFossielHotspotsLayerOL:e}},[]);return n()},immediateLoad:!1,tier:"premium",regions:["nl","be","de","fr"]},"Mineralen Hotspots":{name:"Mineralen Hotspots",factory:async()=>{const{createMineralenHotspotsLayerOL:n}=await xt(async()=>{const{createMineralenHotspotsLayerOL:e}=await import("./mineralenHotspotsOL-CWLnb0iz.js");return{createMineralenHotspotsLayerOL:e}},[]);return n()},immediateLoad:!1,tier:"premium",regions:["nl","be","de","fr"]},Goudrivieren:{name:"Goudrivieren",factory:async()=>{const{createGoudrivierenLayerOL:n}=await xt(async()=>{const{createGoudrivierenLayerOL:e}=await import("./goudrivierenOL-C4Kq8RRE.js");return{createGoudrivierenLayerOL:e}},[]);return n()},immediateLoad:!1,tier:"premium",regions:["nl","be","de","fr"]},"WWII Bunkers":{name:"WWII Bunkers",factory:async()=>{const{createBunkersLayerOL:n}=await xt(async()=>{const{createBunkersLayerOL:e}=await import("./bunkersOL-CPe954A9.js");return{createBunkersLayerOL:e}},__vite__mapDeps([14,1]));return n()},immediateLoad:!1},Grafheuvels:{name:"Grafheuvels",factory:async()=>{const{createGrafheuvelsLayerOL:n}=await xt(async()=>{const{createGrafheuvelsLayerOL:e}=await import("./grafheuvelsOL-_qw5Hmh8.js");return{createGrafheuvelsLayerOL:e}},__vite__mapDeps([15,1]));return n()},immediateLoad:!1},Slagvelden:{name:"Slagvelden",factory:async()=>{const{createSlagveldenLayerOL:n}=await xt(async()=>{const{createSlagveldenLayerOL:e}=await import("./slagveldenOL-CBjvfOsd.js");return{createSlagveldenLayerOL:e}},__vite__mapDeps([16,1]));return n()},immediateLoad:!1},"Militaire Vliegvelden":{name:"Militaire Vliegvelden",factory:async()=>{const{createVliegveldenLayerOL:n}=await xt(async()=>{const{createVliegveldenLayerOL:e}=await import("./vliegveldenOL-1jLUh_Uu.js");return{createVliegveldenLayerOL:e}},[]);return n()},immediateLoad:!1}};function Kq(){return Object.values(Gw).filter(n=>n.immediateLoad)}const Xr=qi()(lg((n,e)=>({map:null,rotation:0,rotationEnabled:!0,setMap:t=>{n(r=>{r.map=t})},setRotation:t=>{n(r=>{if(r.rotation=t,r.map&&r.rotationEnabled){const i=t*Math.PI/180;r.map.getView().setRotation(i)}})},enableRotation:()=>{n(t=>{t.rotationEnabled=!0})},disableRotation:()=>{n(t=>{t.rotationEnabled=!1,t.rotation=0,t.map&&t.map.getView().animate({rotation:0,duration:500})})}}))),Ti=qi()(lg((n,e)=>({visible:{"CartoDB (licht)":!0,OpenStreetMap:!1,Luchtfoto:!1,"Labels Overlay":!1,"TMK 1850":!1,"Bonnebladen 1900":!1,Hunebedden:!1,"FAMKE Steentijd":!1,"FAMKE IJzertijd":!1,Grafheuvels:!1,Terpen:!1,"AMK Monumenten":!1,"AMK Romeins":!1,"AMK Steentijd":!1,"AMK Vroege ME":!1,"AMK Late ME":!1,"AMK Overig":!1,"Archeo Onderzoeken":!1,"Romeinse wegen (regio)":!1,"Romeinse wegen (Wereld)":!1,Kastelen:!1,IKAW:!1,Essen:!1,Rijksmonumenten:!1,Werelderfgoed:!1,"WWII Bunkers":!1,Slagvelden:!1,"Militaire Vliegvelden":!1,Verdedigingslinies:!1,Inundatiegebieden:!1,"Militaire Objecten":!1,"Paleokaart 800 n.Chr.":!1,"Paleokaart 100 n.Chr.":!1,"Paleokaart 500 v.Chr.":!1,"Paleokaart 1500 v.Chr.":!1,"Paleokaart 2750 v.Chr.":!1,"Paleokaart 5500 v.Chr.":!1,"Paleokaart 9000 v.Chr.":!1,"Religieus Erfgoed":!1,"UIKAV Punten":!1,"UIKAV Vlakken":!1,"UIKAV Buffer":!1,"UIKAV Expert":!1,"UIKAV Indeling":!1,"Hoogtekaart (WebGL)":!1,"AHN4 Hoogtekaart Kleur":!1,"AHN4 Hillshade NL":!1,"AHN4 Multi-Hillshade NL":!1,"AHN 0.5m":!1,Veengebieden:!1,Geomorfologie:!1,Bodemkaart:!1,"Fossielen Nederland":!1,"Fossielen Belgi":!1,"Fossielen Duitsland":!1,"Fossielen Frankrijk":!1,Parken:!1,Speeltuinen:!1,Musea:!1,Strandjes:!1,Ruiterpaden:!1,Laarzenpaden:!1,Gewaspercelen:!1,"Kadastrale Grenzen":!1,Scheepswrakken:!1,"Woonheuvels ZH":!1,"Romeinse Forten":!1,Windmolens:!1,Erfgoedlijnen:!1,"Oude Kernen":!1,"Relictenkaart Punten":!1,"Relictenkaart Lijnen":!1,"Relictenkaart Vlakken":!1,"Verdronken Dorpen":!1,"Mijn Vondsten":!0},opacity:{"Hoogtekaart (WebGL)":.8,"AHN4 Hoogtekaart Kleur":.85,"AHN4 Hillshade NL":.7,"AHN4 Multi-Hillshade NL":.7,"AHN 0.5m":.7,"TMK 1850":.8,"Bonnebladen 1900":.8,Geomorfologie:.5,Bodemkaart:.6,Veengebieden:.6,IKAW:.5,"FAMKE Steentijd":.6,"FAMKE IJzertijd":.6,Essen:.6,Terpen:.7,"AMK Monumenten":.45,"AMK Romeins":.6,"AMK Steentijd":.6,"AMK Vroege ME":.6,"AMK Late ME":.6,"AMK Overig":.6,"Paleokaart 9000 v.Chr.":.7,"Paleokaart 5500 v.Chr.":.7,"Paleokaart 2750 v.Chr.":.7,"Paleokaart 1500 v.Chr.":.7,"Paleokaart 500 v.Chr.":.7,"Paleokaart 100 n.Chr.":.7,"Paleokaart 800 n.Chr.":.7,Verdedigingslinies:.7,Inundatiegebieden:.5,"Militaire Objecten":.8,"Religieus Erfgoed":.8,Gewaspercelen:.6,"Kadastrale Grenzen":.7,Erfgoedlijnen:.7,"Oude Kernen":.6,"Relictenkaart Vlakken":.5},loadingState:{},layers:{},toggleLayer:t=>{const r=e(),i=!r.visible[t];n(s=>{s.visible[t]=i}),i&&!r.layers[t]?e().loadLayer(t):r.layers[t]&&r.layers[t].setVisible(i)},setLayerVisibility:(t,r)=>{const i=e();n(s=>{s.visible[t]=r;const a=s.layers[t];a&&a.setVisible(r)}),r&&!i.layers[t]&&e().loadLayer(t)},setLayerOpacity:(t,r)=>{n(i=>{i.opacity[t]=r;const s=i.layers[t];s&&s.setOpacity(r)})},registerLayer:(t,r)=>{n(i=>{i.layers[t]=r,i.loadingState[t]="loaded",i.visible[t]!==void 0&&r.setVisible(i.visible[t]),i.opacity[t]!==void 0&&r.setOpacity(i.opacity[t])})},unregisterLayer:t=>{n(r=>{delete r.layers[t],delete r.loadingState[t]})},loadLayer:async t=>{const r=e();if(r.loadingState[t]==="loading"||r.layers[t])return;const i=Gw[t];if(!i){console.warn(` Layer "${t}" not found in registry`);return}const s=Xr.getState().map;if(!s){console.warn(` Cannot load layer "${t}": map not initialized`);return}n(a=>{a.loadingState[t]="loading"}),console.log(` Loading layer: ${t}...`);try{const a=await i.factory();if(!a)throw new Error("Factory returned null");const o=e();a.setVisible(o.visible[t]??!1),o.opacity[t]!==void 0&&a.setOpacity(o.opacity[t]),s.addLayer(a),n(l=>{l.layers[t]=a,l.loadingState[t]="loaded"}),console.log(` Layer loaded: ${t}`)}catch(a){console.error(` Failed to load layer "${t}":`,a),n(o=>{o.loadingState[t]="error"})}}}))),ur=qi()(lg((n,e)=>({layerControlOpen:!1,legendOpen:!1,backgroundsPanelOpen:!1,themesPanelOpen:!1,settingsPanelOpen:!1,infoPanelOpen:!1,presetsPanelOpen:!1,monumentSearchOpen:!1,vondstFormOpen:!1,vondstFormLocation:null,vondstFormPhoto:null,vondstDashboardOpen:!1,createLayerModalOpen:!1,addPointModalOpen:!1,addPointModalLayerId:null,addPointModalLocation:null,layerManagerModalOpen:!1,layerDashboardOpen:!1,layerDashboardLayerId:null,routeDashboardOpen:!1,collapsedCategories:new Set,closeAllPanels:()=>{n(t=>{t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1})},toggleLayerControl:()=>{n(t=>{t.layerControlOpen=!t.layerControlOpen})},toggleLegend:()=>{n(t=>{t.legendOpen=!t.legendOpen})},toggleBackgroundsPanel:()=>{n(t=>{const r=t.backgroundsPanelOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,r||(t.backgroundsPanelOpen=!0)})},toggleThemesPanel:()=>{n(t=>{const r=t.themesPanelOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,r||(t.themesPanelOpen=!0)})},toggleSettingsPanel:()=>{n(t=>{const r=t.settingsPanelOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,r||(t.settingsPanelOpen=!0)})},toggleInfoPanel:()=>{n(t=>{const r=t.infoPanelOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,r||(t.infoPanelOpen=!0)})},togglePresetsPanel:()=>{n(t=>{const r=t.presetsPanelOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,r||(t.presetsPanelOpen=!0)})},toggleCategory:t=>{n(r=>{r.collapsedCategories.has(t)?r.collapsedCategories.delete(t):r.collapsedCategories.add(t)})},setLayerControlOpen:t=>{n(r=>{r.layerControlOpen=t})},setLegendOpen:t=>{n(r=>{r.legendOpen=t})},openVondstForm:(t,r)=>{n(i=>{i.backgroundsPanelOpen=!1,i.themesPanelOpen=!1,i.settingsPanelOpen=!1,i.infoPanelOpen=!1,i.presetsPanelOpen=!1,i.vondstFormOpen=!0,i.vondstFormLocation=t||null,i.vondstFormPhoto=r||null})},closeVondstForm:()=>{n(t=>{t.vondstFormOpen=!1,t.vondstFormLocation=null,t.vondstFormPhoto=null})},toggleVondstDashboard:()=>{n(t=>{const r=t.vondstDashboardOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,t.vondstDashboardOpen=!r})},openCreateLayerModal:()=>{n(t=>{t.createLayerModalOpen=!0})},closeCreateLayerModal:()=>{n(t=>{t.createLayerModalOpen=!1})},openAddPointModal:(t,r)=>{n(i=>{i.addPointModalOpen=!0,i.addPointModalLayerId=t,i.addPointModalLocation=r})},closeAddPointModal:()=>{n(t=>{t.addPointModalOpen=!1,t.addPointModalLayerId=null,t.addPointModalLocation=null})},openLayerManagerModal:()=>{n(t=>{t.layerManagerModalOpen=!0})},closeLayerManagerModal:()=>{n(t=>{t.layerManagerModalOpen=!1})},openLayerDashboard:t=>{n(r=>{r.layerDashboardOpen=!0,r.layerDashboardLayerId=t,r.layerManagerModalOpen=!1})},closeLayerDashboard:()=>{n(t=>{t.layerDashboardOpen=!1,t.layerDashboardLayerId=null})},toggleRouteDashboard:()=>{n(t=>{t.routeDashboardOpen=!t.routeDashboardOpen})},toggleMonumentSearch:()=>{n(t=>{const r=t.monumentSearchOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,t.monumentSearchOpen=!r})},closeMonumentSearch:()=>{n(t=>{t.monumentSearchOpen=!1})}}))),Xq=()=>{};var fM={};const dF=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},qq=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=n[t++],a=n[t++],o=n[t++],l=((i&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const s=n[t++],a=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},fF={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){const s=n[i],a=i+1<n.length,o=a?n[i+1]:0,l=i+2<n.length,c=l?n[i+2]:0,h=s>>2,g=(s&3)<<4|o>>4;let m=(o&15)<<2|c>>6,y=c&63;l||(y=64,a||(m=64)),r.push(t[h],t[g],t[m],t[y])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(dF(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):qq(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){const s=t[n.charAt(i++)],o=i<n.length?t[n.charAt(i)]:0;++i;const c=i<n.length?t[n.charAt(i)]:64;++i;const g=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||o==null||c==null||g==null)throw new Yq;const m=s<<2|o>>4;if(r.push(m),c!==64){const y=o<<4&240|c>>2;if(r.push(y),g!==64){const _=c<<6&192|g;r.push(_)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class Yq extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Zq=function(n){const e=dF(n);return fF.encodeByteArray(e,!0)},nv=function(n){return Zq(n).replace(/\./g,"")},gF=function(n){try{return fF.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function mF(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const Jq=()=>mF().__FIREBASE_DEFAULTS__,Qq=()=>{if(typeof process>"u"||typeof fM>"u")return;const n=fM.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},eY=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&gF(n[1]);return e&&JSON.parse(e)},zw=()=>{try{return Xq()||Jq()||Qq()||eY()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},pF=n=>zw()?.emulatorHosts?.[n],yF=n=>{const e=pF(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},xF=()=>zw()?.config,_F=n=>zw()?.[`_${n}`];class tY{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}function Ld(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function XA(n){return(await fetch(n,{credentials:"include"})).ok}function vF(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...n};return[nv(JSON.stringify(t)),nv(JSON.stringify(a)),""].join(".")}const Gm={};function nY(){const n={prod:[],emulator:[]};for(const e of Object.keys(Gm))Gm[e]?n.emulator.push(e):n.prod.push(e);return n}function rY(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let gM=!1;function qA(n,e){if(typeof window>"u"||typeof document>"u"||!Ld(window.location.host)||Gm[n]===e||Gm[n]||gM)return;Gm[n]=e;function t(m){return`__firebase__banner__${m}`}const r="__firebase__banner",s=nY().prod.length>0;function a(){const m=document.getElementById(r);m&&m.remove()}function o(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function l(m,y){m.setAttribute("width","24"),m.setAttribute("id",y),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function c(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{gM=!0,a()},m}function h(m,y){m.setAttribute("id",y),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function g(){const m=rY(r),y=t("text"),_=document.getElementById(y)||document.createElement("span"),x=t("learnmore"),w=document.getElementById(x)||document.createElement("a"),b=t("preprendIcon"),T=document.getElementById(b)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const k=m.element;o(k),h(w,x);const L=c();l(T,b),k.append(T,_,w,L),document.body.appendChild(k)}s?(_.innerText="Preview backend disconnected.",T.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(T.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,_.innerText="Preview backend running in this workspace."),_.setAttribute("id",y)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",g):g()}function pi(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function iY(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(pi())}function wF(){const n=zw()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function sY(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function aY(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function oY(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function lY(){const n=pi();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function EF(){return!wF()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function SF(){return!wF()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function bF(){try{return typeof indexedDB=="object"}catch{return!1}}function cY(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(t){e(t)}})}const uY="FirebaseError";class _l extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=uY,Object.setPrototypeOf(this,_l.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,I1.prototype.create)}}class I1{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?hY(s,r):"Error",o=`${this.serviceName}: ${a} (${i}).`;return new _l(i,o,r)}}function hY(n,e){return n.replace(dY,(t,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const dY=/\{\$([^}]+)}/g;function fY(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function dd(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const i of t){if(!r.includes(i))return!1;const s=n[i],a=e[i];if(mM(s)&&mM(a)){if(!dd(s,a))return!1}else if(s!==a)return!1}for(const i of r)if(!t.includes(i))return!1;return!0}function mM(n){return n!==null&&typeof n=="object"}function C1(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function gY(n,e){const t=new mY(n,e);return t.subscribe.bind(t)}class mY{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");pY(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=tb),i.error===void 0&&(i.error=tb),i.complete===void 0&&(i.complete=tb);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function pY(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function tb(){}function Ci(n){return n&&n._delegate?n._delegate:n}class Mu{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Ah="[DEFAULT]";class yY{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new tY;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(_Y(e))try{this.getOrInitializeService({instanceIdentifier:Ah})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Ah){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ah){return this.instances.has(e)}getOptions(e=Ah){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[s,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(s);r===o&&a.resolve(i)}return i}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:xY(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Ah){return this.component?this.component.multipleInstances?e:Ah:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function xY(n){return n===Ah?void 0:n}function _Y(n){return n.instantiationMode==="EAGER"}class vY{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new yY(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var _n;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(_n||(_n={}));const wY={debug:_n.DEBUG,verbose:_n.VERBOSE,info:_n.INFO,warn:_n.WARN,error:_n.ERROR,silent:_n.SILENT},EY=_n.INFO,SY={[_n.DEBUG]:"log",[_n.VERBOSE]:"log",[_n.INFO]:"info",[_n.WARN]:"warn",[_n.ERROR]:"error"},bY=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),i=SY[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class YA{constructor(e){this.name=e,this._logLevel=EY,this._logHandler=bY,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in _n))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?wY[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,_n.DEBUG,...e),this._logHandler(this,_n.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,_n.VERBOSE,...e),this._logHandler(this,_n.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,_n.INFO,...e),this._logHandler(this,_n.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,_n.WARN,...e),this._logHandler(this,_n.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,_n.ERROR,...e),this._logHandler(this,_n.ERROR,...e)}}const TY=(n,e)=>e.some(t=>n instanceof t);let pM,yM;function RY(){return pM||(pM=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function AY(){return yM||(yM=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const TF=new WeakMap,PT=new WeakMap,RF=new WeakMap,nb=new WeakMap,ZA=new WeakMap;function kY(n){const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",a)},s=()=>{t(bu(n.result)),i()},a=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&TF.set(t,n)}).catch(()=>{}),ZA.set(e,n),e}function IY(n){if(PT.has(n))return;const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",a),n.removeEventListener("abort",a)},s=()=>{t(),i()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",a),n.addEventListener("abort",a)});PT.set(n,e)}let NT={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return PT.get(n);if(e==="objectStoreNames")return n.objectStoreNames||RF.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return bu(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function CY(n){NT=n(NT)}function PY(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(rb(this),e,...t);return RF.set(r,e.sort?e.sort():[e]),bu(r)}:AY().includes(n)?function(...e){return n.apply(rb(this),e),bu(TF.get(this))}:function(...e){return bu(n.apply(rb(this),e))}}function NY(n){return typeof n=="function"?PY(n):(n instanceof IDBTransaction&&IY(n),TY(n,RY())?new Proxy(n,NT):n)}function bu(n){if(n instanceof IDBRequest)return kY(n);if(nb.has(n))return nb.get(n);const e=NY(n);return e!==n&&(nb.set(n,e),ZA.set(e,n)),e}const rb=n=>ZA.get(n);function MY(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){const a=indexedDB.open(n,e),o=bu(a);return r&&a.addEventListener("upgradeneeded",l=>{r(bu(a.result),l.oldVersion,l.newVersion,bu(a.transaction),l)}),t&&a.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),o.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),o}const LY=["get","getKey","getAll","getAllKeys","count"],OY=["put","add","delete","clear"],ib=new Map;function xM(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(ib.get(e))return ib.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,i=OY.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||LY.includes(t)))return;const s=async function(a,...o){const l=this.transaction(a,i?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(o.shift())),(await Promise.all([c[t](...o),i&&l.done]))[0]};return ib.set(e,s),s}CY(n=>({...n,get:(e,t,r)=>xM(e,t)||n.get(e,t,r),has:(e,t)=>!!xM(e,t)||n.has(e,t)}));class DY{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(jY(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function jY(n){return n.getComponent()?.type==="VERSION"}const MT="@firebase/app",_M="0.14.6";const sc=new YA("@firebase/app"),FY="@firebase/app-compat",VY="@firebase/analytics-compat",BY="@firebase/analytics",GY="@firebase/app-check-compat",zY="@firebase/app-check",UY="@firebase/auth",$Y="@firebase/auth-compat",WY="@firebase/database",HY="@firebase/data-connect",KY="@firebase/database-compat",XY="@firebase/functions",qY="@firebase/functions-compat",YY="@firebase/installations",ZY="@firebase/installations-compat",JY="@firebase/messaging",QY="@firebase/messaging-compat",eZ="@firebase/performance",tZ="@firebase/performance-compat",nZ="@firebase/remote-config",rZ="@firebase/remote-config-compat",iZ="@firebase/storage",sZ="@firebase/storage-compat",aZ="@firebase/firestore",oZ="@firebase/ai",lZ="@firebase/firestore-compat",cZ="firebase",uZ="12.6.0";const LT="[DEFAULT]",hZ={[MT]:"fire-core",[FY]:"fire-core-compat",[BY]:"fire-analytics",[VY]:"fire-analytics-compat",[zY]:"fire-app-check",[GY]:"fire-app-check-compat",[UY]:"fire-auth",[$Y]:"fire-auth-compat",[WY]:"fire-rtdb",[HY]:"fire-data-connect",[KY]:"fire-rtdb-compat",[XY]:"fire-fn",[qY]:"fire-fn-compat",[YY]:"fire-iid",[ZY]:"fire-iid-compat",[JY]:"fire-fcm",[QY]:"fire-fcm-compat",[eZ]:"fire-perf",[tZ]:"fire-perf-compat",[nZ]:"fire-rc",[rZ]:"fire-rc-compat",[iZ]:"fire-gcs",[sZ]:"fire-gcs-compat",[aZ]:"fire-fst",[lZ]:"fire-fst-compat",[oZ]:"fire-vertex","fire-js":"fire-js",[cZ]:"fire-js-all"};const rv=new Map,dZ=new Map,OT=new Map;function vM(n,e){try{n.container.addComponent(e)}catch(t){sc.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function fd(n){const e=n.name;if(OT.has(e))return sc.debug(`There were multiple attempts to register component ${e}.`),!1;OT.set(e,n);for(const t of rv.values())vM(t,n);for(const t of dZ.values())vM(t,n);return!0}function Uw(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function ca(n){return n==null?!1:n.settings!==void 0}const fZ={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Tu=new I1("app","Firebase",fZ);class gZ{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Mu("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Tu.create("app-deleted",{appName:this._name})}}const Od=uZ;function AF(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r={name:LT,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw Tu.create("bad-app-name",{appName:String(i)});if(t||(t=xF()),!t)throw Tu.create("no-options");const s=rv.get(i);if(s){if(dd(t,s.options)&&dd(r,s.config))return s;throw Tu.create("duplicate-app",{appName:i})}const a=new vY(i);for(const l of OT.values())a.addComponent(l);const o=new gZ(t,r,a);return rv.set(i,o),o}function JA(n=LT){const e=rv.get(n);if(!e&&n===LT&&xF())return AF();if(!e)throw Tu.create("no-app",{appName:n});return e}function rl(n,e,t){let r=hZ[n]??n;t&&(r+=`-${t}`);const i=r.match(/\s|\//),s=e.match(/\s|\//);if(i||s){const a=[`Unable to register library "${r}" with version "${e}":`];i&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&s&&a.push("and"),s&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),sc.warn(a.join(" "));return}fd(new Mu(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}const mZ="firebase-heartbeat-database",pZ=1,Lp="firebase-heartbeat-store";let sb=null;function kF(){return sb||(sb=MY(mZ,pZ,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Lp)}catch(t){console.warn(t)}}}}).catch(n=>{throw Tu.create("idb-open",{originalErrorMessage:n.message})})),sb}async function yZ(n){try{const t=(await kF()).transaction(Lp),r=await t.objectStore(Lp).get(IF(n));return await t.done,r}catch(e){if(e instanceof _l)sc.warn(e.message);else{const t=Tu.create("idb-get",{originalErrorMessage:e?.message});sc.warn(t.message)}}}async function wM(n,e){try{const r=(await kF()).transaction(Lp,"readwrite");await r.objectStore(Lp).put(e,IF(n)),await r.done}catch(t){if(t instanceof _l)sc.warn(t.message);else{const r=Tu.create("idb-set",{originalErrorMessage:t?.message});sc.warn(r.message)}}}function IF(n){return`${n.name}!${n.options.appId}`}const xZ=1024,_Z=30;class vZ{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new EZ(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=EM();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(i=>i.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>_Z){const i=SZ(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){sc.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=EM(),{heartbeatsToSend:t,unsentEntries:r}=wZ(this._heartbeatsCache.heartbeats),i=nv(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return sc.warn(e),""}}}function EM(){return new Date().toISOString().substring(0,10)}function wZ(n,e=xZ){const t=[];let r=n.slice();for(const i of n){const s=t.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),SM(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),SM(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class EZ{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return bF()?cY().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await yZ(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return wM(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return wM(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function SM(n){return nv(JSON.stringify({version:2,heartbeats:n})).length}function SZ(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function bZ(n){fd(new Mu("platform-logger",e=>new DY(e),"PRIVATE")),fd(new Mu("heartbeat",e=>new vZ(e),"PRIVATE")),rl(MT,_M,n),rl(MT,_M,"esm2020"),rl("fire-js","")}bZ("");function CF(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const TZ=CF,PF=new I1("auth","Firebase",CF());const iv=new YA("@firebase/auth");function RZ(n,...e){iv.logLevel<=_n.WARN&&iv.warn(`Auth (${Od}): ${n}`,...e)}function s_(n,...e){iv.logLevel<=_n.ERROR&&iv.error(`Auth (${Od}): ${n}`,...e)}function hl(n,...e){throw ek(n,...e)}function xo(n,...e){return ek(n,...e)}function QA(n,e,t){const r={...TZ(),[e]:t};return new I1("auth","Firebase",r).create(e,{appName:n.name})}function Ru(n){return QA(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function AZ(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&hl(n,"argument-error"),QA(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function ek(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return PF.create(n,...e)}function Qt(n,e,...t){if(!n)throw ek(e,...t)}function zl(n){const e="INTERNAL ASSERTION FAILED: "+n;throw s_(e),new Error(e)}function ac(n,e){n||zl(e)}function DT(){return typeof self<"u"&&self.location?.href||""}function kZ(){return bM()==="http:"||bM()==="https:"}function bM(){return typeof self<"u"&&self.location?.protocol||null}function IZ(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(kZ()||aY()||"connection"in navigator)?navigator.onLine:!0}function CZ(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class P1{constructor(e,t){this.shortDelay=e,this.longDelay=t,ac(t>e,"Short delay should be less than long delay!"),this.isMobile=iY()||oY()}get(){return IZ()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function tk(n,e){ac(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class NF{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;zl("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;zl("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;zl("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const PZ={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const NZ=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],MZ=new P1(3e4,6e4);function $w(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function cg(n,e,t,r,i={}){return MF(n,i,async()=>{let s={},a={};r&&(e==="GET"?a=r:s={body:JSON.stringify(r)});const o=C1({key:n.config.apiKey,...a}).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);const c={method:e,headers:l,...s};return sY()||(c.referrerPolicy="no-referrer"),n.emulatorConfig&&Ld(n.emulatorConfig.host)&&(c.credentials="include"),NF.fetch()(await OF(n,n.config.apiHost,t,o),c)})}async function MF(n,e,t){n._canInitEmulator=!1;const r={...PZ,...e};try{const i=new LZ(n),s=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw Rx(n,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const o=s.ok?a.errorMessage:a.error.message,[l,c]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Rx(n,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw Rx(n,"email-already-in-use",a);if(l==="USER_DISABLED")throw Rx(n,"user-disabled",a);const h=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw QA(n,h,c);hl(n,h)}}catch(i){if(i instanceof _l)throw i;hl(n,"network-request-failed",{message:String(i)})}}async function LF(n,e,t,r,i={}){const s=await cg(n,e,t,r,i);return"mfaPendingCredential"in s&&hl(n,"multi-factor-auth-required",{_serverResponse:s}),s}async function OF(n,e,t,r){const i=`${e}${t}?${r}`,s=n,a=s.config.emulator?tk(n.config,i):`${n.config.apiScheme}://${i}`;return NZ.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(a).toString():a}class LZ{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(xo(this.auth,"network-request-failed")),MZ.get())})}}function Rx(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const i=xo(n,e,r);return i.customData._tokenResponse=t,i}async function OZ(n,e){return cg(n,"POST","/v1/accounts:delete",e)}async function sv(n,e){return cg(n,"POST","/v1/accounts:lookup",e)}function zm(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function DZ(n,e=!1){const t=Ci(n),r=await t.getIdToken(e),i=nk(r);Qt(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,a=s?.sign_in_provider;return{claims:i,token:r,authTime:zm(ab(i.auth_time)),issuedAtTime:zm(ab(i.iat)),expirationTime:zm(ab(i.exp)),signInProvider:a||null,signInSecondFactor:s?.sign_in_second_factor||null}}function ab(n){return Number(n)*1e3}function nk(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return s_("JWT malformed, contained fewer than 3 sections"),null;try{const i=gF(t);return i?JSON.parse(i):(s_("Failed to decode base64 JWT payload"),null)}catch(i){return s_("Caught error parsing JWT payload as JSON",i?.toString()),null}}function TM(n){const e=nk(n);return Qt(e,"internal-error"),Qt(typeof e.exp<"u","internal-error"),Qt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Op(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof _l&&jZ(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function jZ({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class FZ{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class jT{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=zm(this.lastLoginAt),this.creationTime=zm(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function av(n){const e=n.auth,t=await n.getIdToken(),r=await Op(n,sv(e,{idToken:t}));Qt(r?.users.length,e,"internal-error");const i=r.users[0];n._notifyReloadListener(i);const s=i.providerUserInfo?.length?DF(i.providerUserInfo):[],a=BZ(n.providerData,s),o=n.isAnonymous,l=!(n.email&&i.passwordHash)&&!a?.length,c=o?l:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new jT(i.createdAt,i.lastLoginAt),isAnonymous:c};Object.assign(n,h)}async function VZ(n){const e=Ci(n);await av(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function BZ(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function DF(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function GZ(n,e){const t=await MF(n,{},async()=>{const r=C1({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,a=await OF(n,i,"/v1/token",`key=${s}`),o=await n._getAdditionalHeaders();o["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:o,body:r};return n.emulatorConfig&&Ld(n.emulatorConfig.host)&&(l.credentials="include"),NF.fetch()(a,l)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function zZ(n,e){return cg(n,"POST","/v2/accounts:revokeToken",$w(n,e))}class p0{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Qt(e.idToken,"internal-error"),Qt(typeof e.idToken<"u","internal-error"),Qt(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):TM(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Qt(e.length!==0,"internal-error");const t=TM(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Qt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:i,expiresIn:s}=await GZ(e,t);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:i,expirationTime:s}=t,a=new p0;return r&&(Qt(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),i&&(Qt(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(Qt(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new p0,this.toJSON())}_performRefresh(){return zl("not implemented")}}function qc(n,e){Qt(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class fo{constructor({uid:e,auth:t,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new FZ(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new jT(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await Op(this,this.stsTokenManager.getToken(this.auth,e));return Qt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return DZ(this,e)}reload(){return VZ(this)}_assign(e){this!==e&&(Qt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new fo({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Qt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await av(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ca(this.auth.app))return Promise.reject(Ru(this.auth));const e=await this.getIdToken();return await Op(this,OZ(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,i=t.email??void 0,s=t.phoneNumber??void 0,a=t.photoURL??void 0,o=t.tenantId??void 0,l=t._redirectEventId??void 0,c=t.createdAt??void 0,h=t.lastLoginAt??void 0,{uid:g,emailVerified:m,isAnonymous:y,providerData:_,stsTokenManager:x}=t;Qt(g&&x,e,"internal-error");const w=p0.fromJSON(this.name,x);Qt(typeof g=="string",e,"internal-error"),qc(r,e.name),qc(i,e.name),Qt(typeof m=="boolean",e,"internal-error"),Qt(typeof y=="boolean",e,"internal-error"),qc(s,e.name),qc(a,e.name),qc(o,e.name),qc(l,e.name),qc(c,e.name),qc(h,e.name);const b=new fo({uid:g,auth:e,email:i,emailVerified:m,displayName:r,isAnonymous:y,photoURL:a,phoneNumber:s,tenantId:o,stsTokenManager:w,createdAt:c,lastLoginAt:h});return _&&Array.isArray(_)&&(b.providerData=_.map(T=>({...T}))),l&&(b._redirectEventId=l),b}static async _fromIdTokenResponse(e,t,r=!1){const i=new p0;i.updateFromServerResponse(t);const s=new fo({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await av(s),s}static async _fromGetAccountInfoResponse(e,t,r){const i=t.users[0];Qt(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?DF(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!s?.length,o=new p0;o.updateFromIdToken(r);const l=new fo({uid:i.localId,auth:e,stsTokenManager:o,isAnonymous:a}),c={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new jT(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(l,c),l}}const RM=new Map;function Ul(n){ac(n instanceof Function,"Expected a class definition");let e=RM.get(n);return e?(ac(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,RM.set(n,e),e)}class jF{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}jF.type="NONE";const AM=jF;function a_(n,e,t){return`firebase:${n}:${e}:${t}`}class y0{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=a_(this.userKey,i.apiKey,s),this.fullPersistenceKey=a_("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await sv(this.auth,{idToken:e}).catch(()=>{});return t?fo._fromGetAccountInfoResponse(this.auth,t,e):null}return fo._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new y0(Ul(AM),e,r);const i=(await Promise.all(t.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let s=i[0]||Ul(AM);const a=a_(r,e.config.apiKey,e.name);let o=null;for(const c of t)try{const h=await c._get(a);if(h){let g;if(typeof h=="string"){const m=await sv(e,{idToken:h}).catch(()=>{});if(!m)break;g=await fo._fromGetAccountInfoResponse(e,m,h)}else g=fo._fromJSON(e,h);c!==s&&(o=g),s=c;break}}catch{}const l=i.filter(c=>c._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new y0(s,e,r):(s=l[0],o&&await s._set(a,o.toJSON()),await Promise.all(t.map(async c=>{if(c!==s)try{await c._remove(a)}catch{}})),new y0(s,e,r))}}function kM(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(GF(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(FF(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(UF(e))return"Blackberry";if($F(e))return"Webos";if(VF(e))return"Safari";if((e.includes("chrome/")||BF(e))&&!e.includes("edge/"))return"Chrome";if(zF(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function FF(n=pi()){return/firefox\//i.test(n)}function VF(n=pi()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function BF(n=pi()){return/crios\//i.test(n)}function GF(n=pi()){return/iemobile/i.test(n)}function zF(n=pi()){return/android/i.test(n)}function UF(n=pi()){return/blackberry/i.test(n)}function $F(n=pi()){return/webos/i.test(n)}function rk(n=pi()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function UZ(n=pi()){return rk(n)&&!!window.navigator?.standalone}function $Z(){return lY()&&document.documentMode===10}function WF(n=pi()){return rk(n)||zF(n)||$F(n)||UF(n)||/windows phone/i.test(n)||GF(n)}function HF(n,e=[]){let t;switch(n){case"Browser":t=kM(pi());break;case"Worker":t=`${kM(pi())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Od}/${r}`}class WZ{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=s=>new Promise((a,o)=>{try{const l=e(s);a(l)}catch(l){o(l)}});r.onAbort=t,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}async function HZ(n,e={}){return cg(n,"GET","/v2/passwordPolicy",$w(n,e))}const KZ=6;class XZ{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??KZ,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}class qZ{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new IM(this),this.idTokenSubscription=new IM(this),this.beforeStateQueue=new WZ(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=PF,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Ul(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await y0.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await sv(this,{idToken:e}),r=await fo._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(ca(this.app)){const s=this.app.settings.authIdToken;return s?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(s).then(a,a))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const s=this.redirectUser?._redirectEventId,a=r?._redirectEventId,o=await this.tryRedirectSignIn(e);(!s||s===a)&&o?.user&&(r=o.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(s){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Qt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await av(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=CZ()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ca(this.app))return Promise.reject(Ru(this));const t=e?Ci(e):null;return t&&Qt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Qt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ca(this.app)?Promise.reject(Ru(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ca(this.app)?Promise.reject(Ru(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ul(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await HZ(this),t=new XZ(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new I1("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await zZ(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Ul(e)||this._popupRedirectResolver;Qt(t,this,"argument-error"),this.redirectPersistenceManager=await y0.create(this,[Ul(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Qt(o,this,"internal-error"),o.then(()=>{a||s(this.currentUser)}),typeof t=="function"){const l=e.addObserver(t,r,i);return()=>{a=!0,l()}}else{const l=e.addObserver(t);return()=>{a=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Qt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=HF(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(ca(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&RZ(`Error while retrieving App Check token: ${e.error}`),e?.token}}function N1(n){return Ci(n)}class IM{constructor(e){this.auth=e,this.observer=null,this.addObserver=gY(t=>this.observer=t)}get next(){return Qt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let ik={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function YZ(n){ik=n}function ZZ(n){return ik.loadJS(n)}function JZ(){return ik.gapiScript}function QZ(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function eJ(n,e){const t=Uw(n,"auth");if(t.isInitialized()){const i=t.getImmediate(),s=t.getOptions();if(dd(s,e??{}))return i;hl(i,"already-initialized")}return t.initialize({options:e})}function tJ(n,e){const t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(Ul);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function nJ(n,e,t){const r=N1(n);Qt(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,s=KF(e),{host:a,port:o}=rJ(e),l=o===null?"":`:${o}`,c={url:`${s}//${a}${l}/`},h=Object.freeze({host:a,port:o,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){Qt(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),Qt(dd(c,r.config.emulator)&&dd(h,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=c,r.emulatorConfig=h,r.settings.appVerificationDisabledForTesting=!0,Ld(a)?(XA(`${s}//${a}${l}`),qA("Auth",!0)):iJ()}function KF(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function rJ(n){const e=KF(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:CM(r.substr(s.length+1))}}else{const[s,a]=r.split(":");return{host:s,port:CM(a)}}}function CM(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function iJ(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class XF{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return zl("not implemented")}_getIdTokenResponse(e){return zl("not implemented")}_linkToIdToken(e,t){return zl("not implemented")}_getReauthenticationResolver(e){return zl("not implemented")}}async function x0(n,e){return LF(n,"POST","/v1/accounts:signInWithIdp",$w(n,e))}const sJ="http://localhost";class gd extends XF{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new gd(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):hl("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...s}=t;if(!r||!i)return null;const a=new gd(r,i);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(e){const t=this.buildRequest();return x0(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,x0(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,x0(e,t)}buildRequest(){const e={requestUri:sJ,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=C1(t)}return e}}class sk{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class M1 extends sk{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class au extends M1{constructor(){super("facebook.com")}static credential(e){return gd._fromParams({providerId:au.PROVIDER_ID,signInMethod:au.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return au.credentialFromTaggedObject(e)}static credentialFromError(e){return au.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return au.credential(e.oauthAccessToken)}catch{return null}}}au.FACEBOOK_SIGN_IN_METHOD="facebook.com";au.PROVIDER_ID="facebook.com";class co extends M1{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return gd._fromParams({providerId:co.PROVIDER_ID,signInMethod:co.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return co.credentialFromTaggedObject(e)}static credentialFromError(e){return co.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return co.credential(t,r)}catch{return null}}}co.GOOGLE_SIGN_IN_METHOD="google.com";co.PROVIDER_ID="google.com";class ou extends M1{constructor(){super("github.com")}static credential(e){return gd._fromParams({providerId:ou.PROVIDER_ID,signInMethod:ou.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ou.credentialFromTaggedObject(e)}static credentialFromError(e){return ou.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ou.credential(e.oauthAccessToken)}catch{return null}}}ou.GITHUB_SIGN_IN_METHOD="github.com";ou.PROVIDER_ID="github.com";class lu extends M1{constructor(){super("twitter.com")}static credential(e,t){return gd._fromParams({providerId:lu.PROVIDER_ID,signInMethod:lu.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return lu.credentialFromTaggedObject(e)}static credentialFromError(e){return lu.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return lu.credential(t,r)}catch{return null}}}lu.TWITTER_SIGN_IN_METHOD="twitter.com";lu.PROVIDER_ID="twitter.com";async function aJ(n,e){return LF(n,"POST","/v1/accounts:signUp",$w(n,e))}class Lu{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){const s=await fo._fromIdTokenResponse(e,r,i),a=PM(r);return new Lu({user:s,providerId:a,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const i=PM(r);return new Lu({user:e,providerId:i,_tokenResponse:r,operationType:t})}}function PM(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}async function oJ(n){if(ca(n.app))return Promise.reject(Ru(n));const e=N1(n);if(await e._initializationPromise,e.currentUser?.isAnonymous)return new Lu({user:e.currentUser,providerId:null,operationType:"signIn"});const t=await aJ(e,{returnSecureToken:!0}),r=await Lu._fromIdTokenResponse(e,"signIn",t,!0);return await e._updateCurrentUser(r.user),r}class ov extends _l{constructor(e,t,r,i){super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,ov.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new ov(e,t,r,i)}}function qF(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?ov._fromErrorAndOperation(n,s,e,r):s})}async function lJ(n,e,t=!1){const r=await Op(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Lu._forOperation(n,"link",r)}async function cJ(n,e,t=!1){const{auth:r}=n;if(ca(r.app))return Promise.reject(Ru(r));const i="reauthenticate";try{const s=await Op(n,qF(r,i,e,n),t);Qt(s.idToken,r,"internal-error");const a=nk(s.idToken);Qt(a,r,"internal-error");const{sub:o}=a;return Qt(n.uid===o,r,"user-mismatch"),Lu._forOperation(n,i,s)}catch(s){throw s?.code==="auth/user-not-found"&&hl(r,"user-mismatch"),s}}async function uJ(n,e,t=!1){if(ca(n.app))return Promise.reject(Ru(n));const r="signIn",i=await qF(n,r,e),s=await Lu._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(s.user),s}function hJ(n,e,t,r){return Ci(n).onIdTokenChanged(e,t,r)}function dJ(n,e,t){return Ci(n).beforeAuthStateChanged(e,t)}function YF(n,e,t,r){return Ci(n).onAuthStateChanged(e,t,r)}function ZF(n){return Ci(n).signOut()}const lv="__sak";class JF{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(lv,"1"),this.storage.removeItem(lv),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const fJ=1e3,gJ=10;class QF extends JF{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=WF(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),i=this.localCache[t];r!==i&&e(t,i,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((a,o,l)=>{this.notifyListeners(a,l)});return}const r=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const a=this.storage.getItem(r);!t&&this.localCache[r]===a||this.notifyListeners(r,a)},s=this.storage.getItem(r);$Z()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,gJ):i()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},fJ)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}QF.type="LOCAL";const mJ=QF;class e6 extends JF{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}e6.type="SESSION";const t6=e6;function pJ(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class Ww{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const r=new Ww(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:i,data:s}=t.data,a=this.handlersMap[i];if(!a?.size)return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const o=Array.from(a).map(async c=>c(t.origin,s)),l=await pJ(o);t.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:l})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Ww.receivers=[];function ak(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}class yJ{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((o,l)=>{const c=ak("",20);i.port1.start();const h=setTimeout(()=>{l(new Error("unsupported_event"))},r);a={messageChannel:i,onMessage(g){const m=g;if(m.data.eventId===c)switch(m.data.status){case"ack":clearTimeout(h),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),o(m.data.response);break;default:clearTimeout(h),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}function il(){return window}function xJ(n){il().location.href=n}function n6(){return typeof il().WorkerGlobalScope<"u"&&typeof il().importScripts=="function"}async function _J(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function vJ(){return navigator?.serviceWorker?.controller||null}function wJ(){return n6()?self:null}const r6="firebaseLocalStorageDb",EJ=1,cv="firebaseLocalStorage",i6="fbase_key";class L1{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Hw(n,e){return n.transaction([cv],e?"readwrite":"readonly").objectStore(cv)}function SJ(){const n=indexedDB.deleteDatabase(r6);return new L1(n).toPromise()}function FT(){const n=indexedDB.open(r6,EJ);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(cv,{keyPath:i6})}catch(i){t(i)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(cv)?e(r):(r.close(),await SJ(),e(await FT()))})})}async function NM(n,e,t){const r=Hw(n,!0).put({[i6]:e,value:t});return new L1(r).toPromise()}async function bJ(n,e){const t=Hw(n,!1).get(e),r=await new L1(t).toPromise();return r===void 0?null:r.value}function MM(n,e){const t=Hw(n,!0).delete(e);return new L1(t).toPromise()}const TJ=800,RJ=3;class s6{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await FT(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>RJ)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return n6()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Ww._getInstance(wJ()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await _J(),!this.activeServiceWorker)return;this.sender=new yJ(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||vJ()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await FT();return await NM(e,lv,"1"),await MM(e,lv),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>NM(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>bJ(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>MM(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=Hw(i,!1).getAll();return new L1(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),TJ)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}s6.type="LOCAL";const AJ=s6;new P1(3e4,6e4);function a6(n,e){return e?Ul(e):(Qt(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class ok extends XF{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return x0(e,this._buildIdpRequest())}_linkToIdToken(e,t){return x0(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return x0(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function kJ(n){return uJ(n.auth,new ok(n),n.bypassAuthState)}function IJ(n){const{auth:e,user:t}=n;return Qt(t,e,"internal-error"),cJ(t,new ok(n),n.bypassAuthState)}async function CJ(n){const{auth:e,user:t}=n;return Qt(t,e,"internal-error"),lJ(t,new ok(n),n.bypassAuthState)}class o6{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:a,type:o}=e;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return kJ;case"linkViaPopup":case"linkViaRedirect":return CJ;case"reauthViaPopup":case"reauthViaRedirect":return IJ;default:hl(this.auth,"internal-error")}}resolve(e){ac(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ac(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const PJ=new P1(2e3,1e4);async function LM(n,e,t){if(ca(n.app))return Promise.reject(xo(n,"operation-not-supported-in-this-environment"));const r=N1(n);AZ(n,e,sk);const i=a6(r,t);return new $h(r,"signInViaPopup",e,i).executeNotNull()}class $h extends o6{constructor(e,t,r,i,s){super(e,t,i,s),this.provider=r,this.authWindow=null,this.pollId=null,$h.currentPopupAction&&$h.currentPopupAction.cancel(),$h.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Qt(e,this.auth,"internal-error"),e}async onExecution(){ac(this.filter.length===1,"Popup operations only handle one event");const e=ak();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(xo(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(xo(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,$h.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(xo(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,PJ.get())};e()}}$h.currentPopupAction=null;const NJ="pendingRedirect",o_=new Map;class MJ extends o6{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=o_.get(this.auth._key());if(!e){try{const r=await LJ(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}o_.set(this.auth._key(),e)}return this.bypassAuthState||o_.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function LJ(n,e){const t=jJ(e),r=DJ(n);if(!await r._isAvailable())return!1;const i=await r._get(t)==="true";return await r._remove(t),i}function OJ(n,e){o_.set(n._key(),e)}function DJ(n){return Ul(n._redirectPersistence)}function jJ(n){return a_(NJ,n.config.apiKey,n.name)}async function FJ(n,e,t=!1){if(ca(n.app))return Promise.reject(Ru(n));const r=N1(n),i=a6(r,e),a=await new MJ(r,i,t).execute();return a&&!t&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,e)),a}const VJ=600*1e3;class BJ{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!GJ(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!l6(e)){const r=e.error.code?.split("auth/")[1]||"internal-error";t.onError(xo(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=VJ&&this.cachedEventUids.clear(),this.cachedEventUids.has(OM(e))}saveEventToCache(e){this.cachedEventUids.add(OM(e)),this.lastProcessedEventTime=Date.now()}}function OM(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function l6({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function GJ(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return l6(n);default:return!1}}async function zJ(n,e={}){return cg(n,"GET","/v1/projects",e)}const UJ=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,$J=/^https?/;async function WJ(n){if(n.config.emulator)return;const{authorizedDomains:e}=await zJ(n);for(const t of e)try{if(HJ(t))return}catch{}hl(n,"unauthorized-domain")}function HJ(n){const e=DT(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const a=new URL(n);return a.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===r}if(!$J.test(t))return!1;if(UJ.test(n))return r===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const KJ=new P1(3e4,6e4);function DM(){const n=il().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function XJ(n){return new Promise((e,t)=>{function r(){DM(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{DM(),t(xo(n,"network-request-failed"))},timeout:KJ.get()})}if(il().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(il().gapi?.load)r();else{const i=QZ("iframefcb");return il()[i]=()=>{gapi.load?r():t(xo(n,"network-request-failed"))},ZZ(`${JZ()}?onload=${i}`).catch(s=>t(s))}}).catch(e=>{throw l_=null,e})}let l_=null;function qJ(n){return l_=l_||XJ(n),l_}const YJ=new P1(5e3,15e3),ZJ="__/auth/iframe",JJ="emulator/auth/iframe",QJ={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},eQ=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function tQ(n){const e=n.config;Qt(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?tk(e,JJ):`https://${n.config.authDomain}/${ZJ}`,r={apiKey:e.apiKey,appName:n.name,v:Od},i=eQ.get(n.config.apiHost);i&&(r.eid=i);const s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${C1(r).slice(1)}`}async function nQ(n){const e=await qJ(n),t=il().gapi;return Qt(t,n,"internal-error"),e.open({where:document.body,url:tQ(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:QJ,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const a=xo(n,"network-request-failed"),o=il().setTimeout(()=>{s(a)},YJ.get());function l(){il().clearTimeout(o),i(r)}r.ping(l).then(l,()=>{s(a)})}))}const rQ={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},iQ=500,sQ=600,aQ="_blank",oQ="http://localhost";class jM{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function lQ(n,e,t,r=iQ,i=sQ){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let o="";const l={...rQ,width:r.toString(),height:i.toString(),top:s,left:a},c=pi().toLowerCase();t&&(o=BF(c)?aQ:t),FF(c)&&(e=e||oQ,l.scrollbars="yes");const h=Object.entries(l).reduce((m,[y,_])=>`${m}${y}=${_},`,"");if(UZ(c)&&o!=="_self")return cQ(e||"",o),new jM(null);const g=window.open(e||"",o,h);Qt(g,n,"popup-blocked");try{g.focus()}catch{}return new jM(g)}function cQ(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}const uQ="__/auth/handler",hQ="emulator/auth/handler",dQ=encodeURIComponent("fac");async function FM(n,e,t,r,i,s){Qt(n.config.authDomain,n,"auth-domain-config-required"),Qt(n.config.apiKey,n,"invalid-api-key");const a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Od,eventId:i};if(e instanceof sk){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",fY(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,g]of Object.entries({}))a[h]=g}if(e instanceof M1){const h=e.getScopes().filter(g=>g!=="");h.length>0&&(a.scopes=h.join(","))}n.tenantId&&(a.tid=n.tenantId);const o=a;for(const h of Object.keys(o))o[h]===void 0&&delete o[h];const l=await n._getAppCheckToken(),c=l?`#${dQ}=${encodeURIComponent(l)}`:"";return`${fQ(n)}?${C1(o).slice(1)}${c}`}function fQ({config:n}){return n.emulator?tk(n,hQ):`https://${n.authDomain}/${uQ}`}const ob="webStorageSupport";class gQ{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=t6,this._completeRedirectFn=FJ,this._overrideRedirectResult=OJ}async _openPopup(e,t,r,i){ac(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const s=await FM(e,t,r,DT(),i);return lQ(e,s,ak())}async _openRedirect(e,t,r,i){await this._originValidation(e);const s=await FM(e,t,r,DT(),i);return xJ(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(ac(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await nQ(e),r=new BJ(e);return t.register("authEvent",i=>(Qt(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(ob,{type:ob},i=>{const s=i?.[0]?.[ob];s!==void 0&&t(!!s),hl(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=WJ(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return WF()||VF()||rk()}}const mQ=gQ;var VM="@firebase/auth",BM="1.12.0";class pQ{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Qt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function yQ(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function xQ(n){fd(new Mu("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=r.options;Qt(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:a,authDomain:o,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:HF(n)},c=new qZ(r,i,s,l);return tJ(c,t),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),fd(new Mu("auth-internal",e=>{const t=N1(e.getProvider("auth").getImmediate());return(r=>new pQ(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),rl(VM,BM,yQ(n)),rl(VM,BM,"esm2020")}const _Q=300,vQ=_F("authIdTokenMaxAge")||_Q;let GM=null;const wQ=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>vQ)return;const i=t?.token;GM!==i&&(GM=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function EQ(n=JA()){const e=Uw(n,"auth");if(e.isInitialized())return e.getImmediate();const t=eJ(n,{popupRedirectResolver:mQ,persistence:[AJ,mJ,t6]}),r=_F("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const a=wQ(s.toString());dJ(t,a,()=>a(t.currentUser)),hJ(t,o=>a(o))}}const i=pF("auth");return i&&nJ(t,`http://${i}`),t}function SQ(){return document.getElementsByTagName("head")?.[0]??document}YZ({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{const s=xo("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",SQ().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});xQ("Browser");var bQ="firebase",TQ="12.7.0";rl(bQ,TQ,"app");var zM=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Au,c6;(function(){var n;function e(R,A){function P(){}P.prototype=A.prototype,R.F=A.prototype,R.prototype=new P,R.prototype.constructor=R,R.D=function(D,N,G){for(var j=Array(arguments.length-2),ve=2;ve<arguments.length;ve++)j[ve-2]=arguments[ve];return A.prototype[N].apply(D,j)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(R,A,P){P||(P=0);const D=Array(16);if(typeof A=="string")for(var N=0;N<16;++N)D[N]=A.charCodeAt(P++)|A.charCodeAt(P++)<<8|A.charCodeAt(P++)<<16|A.charCodeAt(P++)<<24;else for(N=0;N<16;++N)D[N]=A[P++]|A[P++]<<8|A[P++]<<16|A[P++]<<24;A=R.g[0],P=R.g[1],N=R.g[2];let G=R.g[3],j;j=A+(G^P&(N^G))+D[0]+3614090360&4294967295,A=P+(j<<7&4294967295|j>>>25),j=G+(N^A&(P^N))+D[1]+3905402710&4294967295,G=A+(j<<12&4294967295|j>>>20),j=N+(P^G&(A^P))+D[2]+606105819&4294967295,N=G+(j<<17&4294967295|j>>>15),j=P+(A^N&(G^A))+D[3]+3250441966&4294967295,P=N+(j<<22&4294967295|j>>>10),j=A+(G^P&(N^G))+D[4]+4118548399&4294967295,A=P+(j<<7&4294967295|j>>>25),j=G+(N^A&(P^N))+D[5]+1200080426&4294967295,G=A+(j<<12&4294967295|j>>>20),j=N+(P^G&(A^P))+D[6]+2821735955&4294967295,N=G+(j<<17&4294967295|j>>>15),j=P+(A^N&(G^A))+D[7]+4249261313&4294967295,P=N+(j<<22&4294967295|j>>>10),j=A+(G^P&(N^G))+D[8]+1770035416&4294967295,A=P+(j<<7&4294967295|j>>>25),j=G+(N^A&(P^N))+D[9]+2336552879&4294967295,G=A+(j<<12&4294967295|j>>>20),j=N+(P^G&(A^P))+D[10]+4294925233&4294967295,N=G+(j<<17&4294967295|j>>>15),j=P+(A^N&(G^A))+D[11]+2304563134&4294967295,P=N+(j<<22&4294967295|j>>>10),j=A+(G^P&(N^G))+D[12]+1804603682&4294967295,A=P+(j<<7&4294967295|j>>>25),j=G+(N^A&(P^N))+D[13]+4254626195&4294967295,G=A+(j<<12&4294967295|j>>>20),j=N+(P^G&(A^P))+D[14]+2792965006&4294967295,N=G+(j<<17&4294967295|j>>>15),j=P+(A^N&(G^A))+D[15]+1236535329&4294967295,P=N+(j<<22&4294967295|j>>>10),j=A+(N^G&(P^N))+D[1]+4129170786&4294967295,A=P+(j<<5&4294967295|j>>>27),j=G+(P^N&(A^P))+D[6]+3225465664&4294967295,G=A+(j<<9&4294967295|j>>>23),j=N+(A^P&(G^A))+D[11]+643717713&4294967295,N=G+(j<<14&4294967295|j>>>18),j=P+(G^A&(N^G))+D[0]+3921069994&4294967295,P=N+(j<<20&4294967295|j>>>12),j=A+(N^G&(P^N))+D[5]+3593408605&4294967295,A=P+(j<<5&4294967295|j>>>27),j=G+(P^N&(A^P))+D[10]+38016083&4294967295,G=A+(j<<9&4294967295|j>>>23),j=N+(A^P&(G^A))+D[15]+3634488961&4294967295,N=G+(j<<14&4294967295|j>>>18),j=P+(G^A&(N^G))+D[4]+3889429448&4294967295,P=N+(j<<20&4294967295|j>>>12),j=A+(N^G&(P^N))+D[9]+568446438&4294967295,A=P+(j<<5&4294967295|j>>>27),j=G+(P^N&(A^P))+D[14]+3275163606&4294967295,G=A+(j<<9&4294967295|j>>>23),j=N+(A^P&(G^A))+D[3]+4107603335&4294967295,N=G+(j<<14&4294967295|j>>>18),j=P+(G^A&(N^G))+D[8]+1163531501&4294967295,P=N+(j<<20&4294967295|j>>>12),j=A+(N^G&(P^N))+D[13]+2850285829&4294967295,A=P+(j<<5&4294967295|j>>>27),j=G+(P^N&(A^P))+D[2]+4243563512&4294967295,G=A+(j<<9&4294967295|j>>>23),j=N+(A^P&(G^A))+D[7]+1735328473&4294967295,N=G+(j<<14&4294967295|j>>>18),j=P+(G^A&(N^G))+D[12]+2368359562&4294967295,P=N+(j<<20&4294967295|j>>>12),j=A+(P^N^G)+D[5]+4294588738&4294967295,A=P+(j<<4&4294967295|j>>>28),j=G+(A^P^N)+D[8]+2272392833&4294967295,G=A+(j<<11&4294967295|j>>>21),j=N+(G^A^P)+D[11]+1839030562&4294967295,N=G+(j<<16&4294967295|j>>>16),j=P+(N^G^A)+D[14]+4259657740&4294967295,P=N+(j<<23&4294967295|j>>>9),j=A+(P^N^G)+D[1]+2763975236&4294967295,A=P+(j<<4&4294967295|j>>>28),j=G+(A^P^N)+D[4]+1272893353&4294967295,G=A+(j<<11&4294967295|j>>>21),j=N+(G^A^P)+D[7]+4139469664&4294967295,N=G+(j<<16&4294967295|j>>>16),j=P+(N^G^A)+D[10]+3200236656&4294967295,P=N+(j<<23&4294967295|j>>>9),j=A+(P^N^G)+D[13]+681279174&4294967295,A=P+(j<<4&4294967295|j>>>28),j=G+(A^P^N)+D[0]+3936430074&4294967295,G=A+(j<<11&4294967295|j>>>21),j=N+(G^A^P)+D[3]+3572445317&4294967295,N=G+(j<<16&4294967295|j>>>16),j=P+(N^G^A)+D[6]+76029189&4294967295,P=N+(j<<23&4294967295|j>>>9),j=A+(P^N^G)+D[9]+3654602809&4294967295,A=P+(j<<4&4294967295|j>>>28),j=G+(A^P^N)+D[12]+3873151461&4294967295,G=A+(j<<11&4294967295|j>>>21),j=N+(G^A^P)+D[15]+530742520&4294967295,N=G+(j<<16&4294967295|j>>>16),j=P+(N^G^A)+D[2]+3299628645&4294967295,P=N+(j<<23&4294967295|j>>>9),j=A+(N^(P|~G))+D[0]+4096336452&4294967295,A=P+(j<<6&4294967295|j>>>26),j=G+(P^(A|~N))+D[7]+1126891415&4294967295,G=A+(j<<10&4294967295|j>>>22),j=N+(A^(G|~P))+D[14]+2878612391&4294967295,N=G+(j<<15&4294967295|j>>>17),j=P+(G^(N|~A))+D[5]+4237533241&4294967295,P=N+(j<<21&4294967295|j>>>11),j=A+(N^(P|~G))+D[12]+1700485571&4294967295,A=P+(j<<6&4294967295|j>>>26),j=G+(P^(A|~N))+D[3]+2399980690&4294967295,G=A+(j<<10&4294967295|j>>>22),j=N+(A^(G|~P))+D[10]+4293915773&4294967295,N=G+(j<<15&4294967295|j>>>17),j=P+(G^(N|~A))+D[1]+2240044497&4294967295,P=N+(j<<21&4294967295|j>>>11),j=A+(N^(P|~G))+D[8]+1873313359&4294967295,A=P+(j<<6&4294967295|j>>>26),j=G+(P^(A|~N))+D[15]+4264355552&4294967295,G=A+(j<<10&4294967295|j>>>22),j=N+(A^(G|~P))+D[6]+2734768916&4294967295,N=G+(j<<15&4294967295|j>>>17),j=P+(G^(N|~A))+D[13]+1309151649&4294967295,P=N+(j<<21&4294967295|j>>>11),j=A+(N^(P|~G))+D[4]+4149444226&4294967295,A=P+(j<<6&4294967295|j>>>26),j=G+(P^(A|~N))+D[11]+3174756917&4294967295,G=A+(j<<10&4294967295|j>>>22),j=N+(A^(G|~P))+D[2]+718787259&4294967295,N=G+(j<<15&4294967295|j>>>17),j=P+(G^(N|~A))+D[9]+3951481745&4294967295,R.g[0]=R.g[0]+A&4294967295,R.g[1]=R.g[1]+(N+(j<<21&4294967295|j>>>11))&4294967295,R.g[2]=R.g[2]+N&4294967295,R.g[3]=R.g[3]+G&4294967295}r.prototype.v=function(R,A){A===void 0&&(A=R.length);const P=A-this.blockSize,D=this.C;let N=this.h,G=0;for(;G<A;){if(N==0)for(;G<=P;)i(this,R,G),G+=this.blockSize;if(typeof R=="string"){for(;G<A;)if(D[N++]=R.charCodeAt(G++),N==this.blockSize){i(this,D),N=0;break}}else for(;G<A;)if(D[N++]=R[G++],N==this.blockSize){i(this,D),N=0;break}}this.h=N,this.o+=A},r.prototype.A=function(){var R=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);R[0]=128;for(var A=1;A<R.length-8;++A)R[A]=0;A=this.o*8;for(var P=R.length-8;P<R.length;++P)R[P]=A&255,A/=256;for(this.v(R),R=Array(16),A=0,P=0;P<4;++P)for(let D=0;D<32;D+=8)R[A++]=this.g[P]>>>D&255;return R};function s(R,A){var P=o;return Object.prototype.hasOwnProperty.call(P,R)?P[R]:P[R]=A(R)}function a(R,A){this.h=A;const P=[];let D=!0;for(let N=R.length-1;N>=0;N--){const G=R[N]|0;D&&G==A||(P[N]=G,D=!1)}this.g=P}var o={};function l(R){return-128<=R&&R<128?s(R,function(A){return new a([A|0],A<0?-1:0)}):new a([R|0],R<0?-1:0)}function c(R){if(isNaN(R)||!isFinite(R))return g;if(R<0)return w(c(-R));const A=[];let P=1;for(let D=0;R>=P;D++)A[D]=R/P|0,P*=4294967296;return new a(A,0)}function h(R,A){if(R.length==0)throw Error("number format error: empty string");if(A=A||10,A<2||36<A)throw Error("radix out of range: "+A);if(R.charAt(0)=="-")return w(h(R.substring(1),A));if(R.indexOf("-")>=0)throw Error('number format error: interior "-" character');const P=c(Math.pow(A,8));let D=g;for(let G=0;G<R.length;G+=8){var N=Math.min(8,R.length-G);const j=parseInt(R.substring(G,G+N),A);N<8?(N=c(Math.pow(A,N)),D=D.j(N).add(c(j))):(D=D.j(P),D=D.add(c(j)))}return D}var g=l(0),m=l(1),y=l(16777216);n=a.prototype,n.m=function(){if(x(this))return-w(this).m();let R=0,A=1;for(let P=0;P<this.g.length;P++){const D=this.i(P);R+=(D>=0?D:4294967296+D)*A,A*=4294967296}return R},n.toString=function(R){if(R=R||10,R<2||36<R)throw Error("radix out of range: "+R);if(_(this))return"0";if(x(this))return"-"+w(this).toString(R);const A=c(Math.pow(R,6));var P=this;let D="";for(;;){const N=L(P,A).g;P=b(P,N.j(A));let G=((P.g.length>0?P.g[0]:P.h)>>>0).toString(R);if(P=N,_(P))return G+D;for(;G.length<6;)G="0"+G;D=G+D}},n.i=function(R){return R<0?0:R<this.g.length?this.g[R]:this.h};function _(R){if(R.h!=0)return!1;for(let A=0;A<R.g.length;A++)if(R.g[A]!=0)return!1;return!0}function x(R){return R.h==-1}n.l=function(R){return R=b(this,R),x(R)?-1:_(R)?0:1};function w(R){const A=R.g.length,P=[];for(let D=0;D<A;D++)P[D]=~R.g[D];return new a(P,~R.h).add(m)}n.abs=function(){return x(this)?w(this):this},n.add=function(R){const A=Math.max(this.g.length,R.g.length),P=[];let D=0;for(let N=0;N<=A;N++){let G=D+(this.i(N)&65535)+(R.i(N)&65535),j=(G>>>16)+(this.i(N)>>>16)+(R.i(N)>>>16);D=j>>>16,G&=65535,j&=65535,P[N]=j<<16|G}return new a(P,P[P.length-1]&-2147483648?-1:0)};function b(R,A){return R.add(w(A))}n.j=function(R){if(_(this)||_(R))return g;if(x(this))return x(R)?w(this).j(w(R)):w(w(this).j(R));if(x(R))return w(this.j(w(R)));if(this.l(y)<0&&R.l(y)<0)return c(this.m()*R.m());const A=this.g.length+R.g.length,P=[];for(var D=0;D<2*A;D++)P[D]=0;for(D=0;D<this.g.length;D++)for(let N=0;N<R.g.length;N++){const G=this.i(D)>>>16,j=this.i(D)&65535,ve=R.i(N)>>>16,ce=R.i(N)&65535;P[2*D+2*N]+=j*ce,T(P,2*D+2*N),P[2*D+2*N+1]+=G*ce,T(P,2*D+2*N+1),P[2*D+2*N+1]+=j*ve,T(P,2*D+2*N+1),P[2*D+2*N+2]+=G*ve,T(P,2*D+2*N+2)}for(R=0;R<A;R++)P[R]=P[2*R+1]<<16|P[2*R];for(R=A;R<2*A;R++)P[R]=0;return new a(P,0)};function T(R,A){for(;(R[A]&65535)!=R[A];)R[A+1]+=R[A]>>>16,R[A]&=65535,A++}function k(R,A){this.g=R,this.h=A}function L(R,A){if(_(A))throw Error("division by zero");if(_(R))return new k(g,g);if(x(R))return A=L(w(R),A),new k(w(A.g),w(A.h));if(x(A))return A=L(R,w(A)),new k(w(A.g),A.h);if(R.g.length>30){if(x(R)||x(A))throw Error("slowDivide_ only works with positive integers.");for(var P=m,D=A;D.l(R)<=0;)P=O(P),D=O(D);var N=B(P,1),G=B(D,1);for(D=B(D,2),P=B(P,2);!_(D);){var j=G.add(D);j.l(R)<=0&&(N=N.add(P),G=j),D=B(D,1),P=B(P,1)}return A=b(R,N.j(A)),new k(N,A)}for(N=g;R.l(A)>=0;){for(P=Math.max(1,Math.floor(R.m()/A.m())),D=Math.ceil(Math.log(P)/Math.LN2),D=D<=48?1:Math.pow(2,D-48),G=c(P),j=G.j(A);x(j)||j.l(R)>0;)P-=D,G=c(P),j=G.j(A);_(G)&&(G=m),N=N.add(G),R=b(R,j)}return new k(N,R)}n.B=function(R){return L(this,R).h},n.and=function(R){const A=Math.max(this.g.length,R.g.length),P=[];for(let D=0;D<A;D++)P[D]=this.i(D)&R.i(D);return new a(P,this.h&R.h)},n.or=function(R){const A=Math.max(this.g.length,R.g.length),P=[];for(let D=0;D<A;D++)P[D]=this.i(D)|R.i(D);return new a(P,this.h|R.h)},n.xor=function(R){const A=Math.max(this.g.length,R.g.length),P=[];for(let D=0;D<A;D++)P[D]=this.i(D)^R.i(D);return new a(P,this.h^R.h)};function O(R){const A=R.g.length+1,P=[];for(let D=0;D<A;D++)P[D]=R.i(D)<<1|R.i(D-1)>>>31;return new a(P,R.h)}function B(R,A){const P=A>>5;A%=32;const D=R.g.length-P,N=[];for(let G=0;G<D;G++)N[G]=A>0?R.i(G+P)>>>A|R.i(G+P+1)<<32-A:R.i(G+P);return new a(N,R.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,c6=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.B,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=c,a.fromString=h,Au=a}).apply(typeof zM<"u"?zM:typeof self<"u"?self:typeof window<"u"?window:{});var Ax=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var u6,Rm,h6,c_,VT,d6,f6,g6;(function(){var n,e=Object.defineProperty;function t(v){v=[typeof globalThis=="object"&&globalThis,v,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ax=="object"&&Ax];for(var C=0;C<v.length;++C){var F=v[C];if(F&&F.Math==Math)return F}throw Error("Cannot find global object")}var r=t(this);function i(v,C){if(C)e:{var F=r;v=v.split(".");for(var K=0;K<v.length-1;K++){var ge=v[K];if(!(ge in F))break e;F=F[ge]}v=v[v.length-1],K=F[v],C=C(K),C!=K&&C!=null&&e(F,v,{configurable:!0,writable:!0,value:C})}}i("Symbol.dispose",function(v){return v||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(v){return v||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(v){return v||function(C){var F=[],K;for(K in C)Object.prototype.hasOwnProperty.call(C,K)&&F.push([K,C[K]]);return F}});var s=s||{},a=this||self;function o(v){var C=typeof v;return C=="object"&&v!=null||C=="function"}function l(v,C,F){return v.call.apply(v.bind,arguments)}function c(v,C,F){return c=l,c.apply(null,arguments)}function h(v,C){var F=Array.prototype.slice.call(arguments,1);return function(){var K=F.slice();return K.push.apply(K,arguments),v.apply(this,K)}}function g(v,C){function F(){}F.prototype=C.prototype,v.Z=C.prototype,v.prototype=new F,v.prototype.constructor=v,v.Ob=function(K,ge,Ie){for(var lt=Array(arguments.length-2),sn=2;sn<arguments.length;sn++)lt[sn-2]=arguments[sn];return C.prototype[ge].apply(K,lt)}}var m=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?v=>v&&AsyncContext.Snapshot.wrap(v):v=>v;function y(v){const C=v.length;if(C>0){const F=Array(C);for(let K=0;K<C;K++)F[K]=v[K];return F}return[]}function _(v,C){for(let K=1;K<arguments.length;K++){const ge=arguments[K];var F=typeof ge;if(F=F!="object"?F:ge?Array.isArray(ge)?"array":F:"null",F=="array"||F=="object"&&typeof ge.length=="number"){F=v.length||0;const Ie=ge.length||0;v.length=F+Ie;for(let lt=0;lt<Ie;lt++)v[F+lt]=ge[lt]}else v.push(ge)}}class x{constructor(C,F){this.i=C,this.j=F,this.h=0,this.g=null}get(){let C;return this.h>0?(this.h--,C=this.g,this.g=C.next,C.next=null):C=this.i(),C}}function w(v){a.setTimeout(()=>{throw v},0)}function b(){var v=R;let C=null;return v.g&&(C=v.g,v.g=v.g.next,v.g||(v.h=null),C.next=null),C}class T{constructor(){this.h=this.g=null}add(C,F){const K=k.get();K.set(C,F),this.h?this.h.next=K:this.g=K,this.h=K}}var k=new x(()=>new L,v=>v.reset());class L{constructor(){this.next=this.g=this.h=null}set(C,F){this.h=C,this.g=F,this.next=null}reset(){this.next=this.g=this.h=null}}let O,B=!1,R=new T,A=()=>{const v=Promise.resolve(void 0);O=()=>{v.then(P)}};function P(){for(var v;v=b();){try{v.h.call(v.g)}catch(F){w(F)}var C=k;C.j(v),C.h<100&&(C.h++,v.next=C.g,C.g=v)}B=!1}function D(){this.u=this.u,this.C=this.C}D.prototype.u=!1,D.prototype.dispose=function(){this.u||(this.u=!0,this.N())},D.prototype[Symbol.dispose]=function(){this.dispose()},D.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function N(v,C){this.type=v,this.g=this.target=C,this.defaultPrevented=!1}N.prototype.h=function(){this.defaultPrevented=!0};var G=(function(){if(!a.addEventListener||!Object.defineProperty)return!1;var v=!1,C=Object.defineProperty({},"passive",{get:function(){v=!0}});try{const F=()=>{};a.addEventListener("test",F,C),a.removeEventListener("test",F,C)}catch{}return v})();function j(v){return/^[\s\xa0]*$/.test(v)}function ve(v,C){N.call(this,v?v.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,v&&this.init(v,C)}g(ve,N),ve.prototype.init=function(v,C){const F=this.type=v.type,K=v.changedTouches&&v.changedTouches.length?v.changedTouches[0]:null;this.target=v.target||v.srcElement,this.g=C,C=v.relatedTarget,C||(F=="mouseover"?C=v.fromElement:F=="mouseout"&&(C=v.toElement)),this.relatedTarget=C,K?(this.clientX=K.clientX!==void 0?K.clientX:K.pageX,this.clientY=K.clientY!==void 0?K.clientY:K.pageY,this.screenX=K.screenX||0,this.screenY=K.screenY||0):(this.clientX=v.clientX!==void 0?v.clientX:v.pageX,this.clientY=v.clientY!==void 0?v.clientY:v.pageY,this.screenX=v.screenX||0,this.screenY=v.screenY||0),this.button=v.button,this.key=v.key||"",this.ctrlKey=v.ctrlKey,this.altKey=v.altKey,this.shiftKey=v.shiftKey,this.metaKey=v.metaKey,this.pointerId=v.pointerId||0,this.pointerType=v.pointerType,this.state=v.state,this.i=v,v.defaultPrevented&&ve.Z.h.call(this)},ve.prototype.h=function(){ve.Z.h.call(this);const v=this.i;v.preventDefault?v.preventDefault():v.returnValue=!1};var ce="closure_listenable_"+(Math.random()*1e6|0),je=0;function Pe(v,C,F,K,ge){this.listener=v,this.proxy=null,this.src=C,this.type=F,this.capture=!!K,this.ha=ge,this.key=++je,this.da=this.fa=!1}function ue(v){v.da=!0,v.listener=null,v.proxy=null,v.src=null,v.ha=null}function Ne(v,C,F){for(const K in v)C.call(F,v[K],K,v)}function be(v,C){for(const F in v)C.call(void 0,v[F],F,v)}function ie(v){const C={};for(const F in v)C[F]=v[F];return C}const V="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function J(v,C){let F,K;for(let ge=1;ge<arguments.length;ge++){K=arguments[ge];for(F in K)v[F]=K[F];for(let Ie=0;Ie<V.length;Ie++)F=V[Ie],Object.prototype.hasOwnProperty.call(K,F)&&(v[F]=K[F])}}function te(v){this.src=v,this.g={},this.h=0}te.prototype.add=function(v,C,F,K,ge){const Ie=v.toString();v=this.g[Ie],v||(v=this.g[Ie]=[],this.h++);const lt=he(v,C,K,ge);return lt>-1?(C=v[lt],F||(C.fa=!1)):(C=new Pe(C,this.src,Ie,!!K,ge),C.fa=F,v.push(C)),C};function re(v,C){const F=C.type;if(F in v.g){var K=v.g[F],ge=Array.prototype.indexOf.call(K,C,void 0),Ie;(Ie=ge>=0)&&Array.prototype.splice.call(K,ge,1),Ie&&(ue(C),v.g[F].length==0&&(delete v.g[F],v.h--))}}function he(v,C,F,K){for(let ge=0;ge<v.length;++ge){const Ie=v[ge];if(!Ie.da&&Ie.listener==C&&Ie.capture==!!F&&Ie.ha==K)return ge}return-1}var Be="closure_lm_"+(Math.random()*1e6|0),Ge={};function ye(v,C,F,K,ge){if(Array.isArray(C)){for(let Ie=0;Ie<C.length;Ie++)ye(v,C[Ie],F,K,ge);return null}return F=kn(F),v&&v[ce]?v.J(C,F,o(K)?!!K.capture:!1,ge):pe(v,C,F,!1,K,ge)}function pe(v,C,F,K,ge,Ie){if(!C)throw Error("Invalid event type");const lt=o(ge)?!!ge.capture:!!ge;let sn=Ht(v);if(sn||(v[Be]=sn=new te(v)),F=sn.add(C,F,K,lt,Ie),F.proxy)return F;if(K=Et(),F.proxy=K,K.src=v,K.listener=F,v.addEventListener)G||(ge=lt),ge===void 0&&(ge=!1),v.addEventListener(C.toString(),K,ge);else if(v.attachEvent)v.attachEvent(St(C.toString()),K);else if(v.addListener&&v.removeListener)v.addListener(K);else throw Error("addEventListener and attachEvent are unavailable.");return F}function Et(){function v(F){return C.call(v.src,v.listener,F)}const C=Ut;return v}function Ve(v,C,F,K,ge){if(Array.isArray(C))for(var Ie=0;Ie<C.length;Ie++)Ve(v,C[Ie],F,K,ge);else K=o(K)?!!K.capture:!!K,F=kn(F),v&&v[ce]?(v=v.i,Ie=String(C).toString(),Ie in v.g&&(C=v.g[Ie],F=he(C,F,K,ge),F>-1&&(ue(C[F]),Array.prototype.splice.call(C,F,1),C.length==0&&(delete v.g[Ie],v.h--)))):v&&(v=Ht(v))&&(C=v.g[C.toString()],v=-1,C&&(v=he(C,F,K,ge)),(F=v>-1?C[v]:null)&&jt(F))}function jt(v){if(typeof v!="number"&&v&&!v.da){var C=v.src;if(C&&C[ce])re(C.i,v);else{var F=v.type,K=v.proxy;C.removeEventListener?C.removeEventListener(F,K,v.capture):C.detachEvent?C.detachEvent(St(F),K):C.addListener&&C.removeListener&&C.removeListener(K),(F=Ht(C))?(re(F,v),F.h==0&&(F.src=null,C[Be]=null)):ue(v)}}}function St(v){return v in Ge?Ge[v]:Ge[v]="on"+v}function Ut(v,C){if(v.da)v=!0;else{C=new ve(C,this);const F=v.listener,K=v.ha||v.src;v.fa&&jt(v),v=F.call(K,C)}return v}function Ht(v){return v=v[Be],v instanceof te?v:null}var tt="__closure_events_fn_"+(Math.random()*1e9>>>0);function kn(v){return typeof v=="function"?v:(v[tt]||(v[tt]=function(C){return v.handleEvent(C)}),v[tt])}function ln(){D.call(this),this.i=new te(this),this.M=this,this.G=null}g(ln,D),ln.prototype[ce]=!0,ln.prototype.removeEventListener=function(v,C,F,K){Ve(this,v,C,F,K)};function hn(v,C){var F,K=v.G;if(K)for(F=[];K;K=K.G)F.push(K);if(v=v.M,K=C.type||C,typeof C=="string")C=new N(C,v);else if(C instanceof N)C.target=C.target||v;else{var ge=C;C=new N(K,v),J(C,ge)}ge=!0;let Ie,lt;if(F)for(lt=F.length-1;lt>=0;lt--)Ie=C.g=F[lt],ge=sr(Ie,K,!0,C)&&ge;if(Ie=C.g=v,ge=sr(Ie,K,!0,C)&&ge,ge=sr(Ie,K,!1,C)&&ge,F)for(lt=0;lt<F.length;lt++)Ie=C.g=F[lt],ge=sr(Ie,K,!1,C)&&ge}ln.prototype.N=function(){if(ln.Z.N.call(this),this.i){var v=this.i;for(const C in v.g){const F=v.g[C];for(let K=0;K<F.length;K++)ue(F[K]);delete v.g[C],v.h--}}this.G=null},ln.prototype.J=function(v,C,F,K){return this.i.add(String(v),C,!1,F,K)},ln.prototype.K=function(v,C,F,K){return this.i.add(String(v),C,!0,F,K)};function sr(v,C,F,K){if(C=v.i.g[String(C)],!C)return!0;C=C.concat();let ge=!0;for(let Ie=0;Ie<C.length;++Ie){const lt=C[Ie];if(lt&&!lt.da&&lt.capture==F){const sn=lt.listener,Ur=lt.ha||lt.src;lt.fa&&re(v.i,lt),ge=sn.call(Ur,K)!==!1&&ge}}return ge&&!K.defaultPrevented}function Pi(v,C){if(typeof v!="function")if(v&&typeof v.handleEvent=="function")v=c(v.handleEvent,v);else throw Error("Invalid listener argument");return Number(C)>2147483647?-1:a.setTimeout(v,C||0)}function Gn(v){v.g=Pi(()=>{v.g=null,v.i&&(v.i=!1,Gn(v))},v.l);const C=v.h;v.h=null,v.m.apply(null,C)}class br extends D{constructor(C,F){super(),this.m=C,this.l=F,this.h=null,this.i=!1,this.g=null}j(C){this.h=arguments,this.g?this.i=!0:Gn(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function oi(v){D.call(this),this.h=v,this.g={}}g(oi,D);var _t=[];function xn(v){Ne(v.g,function(C,F){this.g.hasOwnProperty(F)&&jt(C)},v),v.g={}}oi.prototype.N=function(){oi.Z.N.call(this),xn(this)},oi.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var In=a.JSON.stringify,Tt=a.JSON.parse,an=class{stringify(v){return a.JSON.stringify(v,void 0)}parse(v){return a.JSON.parse(v,void 0)}};function Lt(){}function Yi(){}var Mr={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function li(){N.call(this,"d")}g(li,N);function rn(){N.call(this,"c")}g(rn,N);var Tr={},Fe=null;function xe(){return Fe=Fe||new ln}Tr.Ia="serverreachability";function _e(v){N.call(this,Tr.Ia,v)}g(_e,N);function Dt(v){const C=xe();hn(C,new _e(C))}Tr.STAT_EVENT="statevent";function M(v,C){N.call(this,Tr.STAT_EVENT,v),this.stat=C}g(M,N);function ut(v){const C=xe();hn(C,new M(C,v))}Tr.Ja="timingevent";function W(v,C){N.call(this,Tr.Ja,v),this.size=C}g(W,N);function ne(v,C){if(typeof v!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){v()},C)}function Ce(){this.g=!0}Ce.prototype.ua=function(){this.g=!1};function q(v,C,F,K,ge,Ie){v.info(function(){if(v.g)if(Ie){var lt="",sn=Ie.split("&");for(let Xn=0;Xn<sn.length;Xn++){var Ur=sn[Xn].split("=");if(Ur.length>1){const qr=Ur[0];Ur=Ur[1];const Qs=qr.split("_");lt=Qs.length>=2&&Qs[1]=="type"?lt+(qr+"="+Ur+"&"):lt+(qr+"=redacted&")}}}else lt=null;else lt=Ie;return"XMLHTTP REQ ("+K+") [attempt "+ge+"]: "+C+`
`+F+`
`+lt})}function le(v,C,F,K,ge,Ie,lt){v.info(function(){return"XMLHTTP RESP ("+K+") [ attempt "+ge+"]: "+C+`
`+F+`
`+Ie+" "+lt})}function Ae(v,C,F,K){v.info(function(){return"XMLHTTP TEXT ("+C+"): "+Me(v,F)+(K?" "+K:"")})}function ze(v,C){v.info(function(){return"TIMEOUT: "+C})}Ce.prototype.info=function(){};function Me(v,C){if(!v.g)return C;if(!C)return null;try{const Ie=JSON.parse(C);if(Ie){for(v=0;v<Ie.length;v++)if(Array.isArray(Ie[v])){var F=Ie[v];if(!(F.length<2)){var K=F[1];if(Array.isArray(K)&&!(K.length<1)){var ge=K[0];if(ge!="noop"&&ge!="stop"&&ge!="close")for(let lt=1;lt<K.length;lt++)K[lt]=""}}}}return In(Ie)}catch{return C}}var He={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},$e={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},yt;function At(){}g(At,Lt),At.prototype.g=function(){return new XMLHttpRequest},yt=new At;function Wt(v){return encodeURIComponent(String(v))}function z(v){var C=1;v=v.split(":");const F=[];for(;C>0&&v.length;)F.push(v.shift()),C--;return v.length&&F.push(v.join(":")),F}function Z(v,C,F,K){this.j=v,this.i=C,this.l=F,this.S=K||1,this.V=new oi(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new X}function X(){this.i=null,this.g="",this.h=!1}var Y={},Q={};function ee(v,C,F){v.M=1,v.A=wl(_a(C)),v.u=F,v.R=!0,Ee(v,null)}function Ee(v,C){v.F=Date.now(),Re(v),v.B=_a(v.A);var F=v.B,K=v.S;Array.isArray(K)||(K=[String(K)]),Cg(F.i,"t",K),v.C=0,F=v.j.L,v.h=new X,v.g=my(v.j,F?C:null,!v.u),v.P>0&&(v.O=new br(c(v.Y,v,v.g),v.P)),C=v.V,F=v.g,K=v.ba;var ge="readystatechange";Array.isArray(ge)||(ge&&(_t[0]=ge.toString()),ge=_t);for(let Ie=0;Ie<ge.length;Ie++){const lt=ye(F,ge[Ie],K||C.handleEvent,!1,C.h||C);if(!lt)break;C.g[lt.key]=lt}C=v.J?ie(v.J):{},v.u?(v.v||(v.v="POST"),C["Content-Type"]="application/x-www-form-urlencoded",v.g.ea(v.B,v.v,v.u,C)):(v.v="GET",v.g.ea(v.B,v.v,null,C)),Dt(),q(v.i,v.v,v.B,v.l,v.S,v.u)}Z.prototype.ba=function(v){v=v.target;const C=this.O;C&&Lo(v)==3?C.j():this.Y(v)},Z.prototype.Y=function(v){try{if(v==this.g)e:{const sn=Lo(this.g),Ur=this.g.ya(),Xn=this.g.ca();if(!(sn<3)&&(sn!=3||this.g&&(this.h.h||this.g.la()||fy(this.g)))){this.K||sn!=4||Ur==7||(Ur==8||Xn<=0?Dt(3):Dt(2)),st(this);var C=this.g.ca();this.X=C;var F=Oe(this);if(this.o=C==200,le(this.i,this.v,this.B,this.l,this.S,sn,C),this.o){if(this.U&&!this.L){t:{if(this.g){var K,ge=this.g;if((K=ge.g?ge.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!j(K)){var Ie=K;break t}}Ie=null}if(v=Ie)Ae(this.i,this.l,v,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Je(this,v);else{this.o=!1,this.m=3,ut(12),Ze(this),pt(this);break e}}if(this.R){v=!0;let qr;for(;!this.K&&this.C<F.length;)if(qr=Te(this,F),qr==Q){sn==4&&(this.m=4,ut(14),v=!1),Ae(this.i,this.l,null,"[Incomplete Response]");break}else if(qr==Y){this.m=4,ut(15),Ae(this.i,this.l,F,"[Invalid Chunk]"),v=!1;break}else Ae(this.i,this.l,qr,null),Je(this,qr);if(we(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),sn!=4||F.length!=0||this.h.h||(this.m=1,ut(16),v=!1),this.o=this.o&&v,!v)Ae(this.i,this.l,F,"[Invalid Chunked Response]"),Ze(this),pt(this);else if(F.length>0&&!this.W){this.W=!0;var lt=this.j;lt.g==this&&lt.aa&&!lt.P&&(lt.j.info("Great, no buffering proxy detected. Bytes received: "+F.length),ah(lt),lt.P=!0,ut(11))}}else Ae(this.i,this.l,F,null),Je(this,F);sn==4&&Ze(this),this.o&&!this.K&&(sn==4?Jd(this.j,this):(this.o=!1,Re(this)))}else Ng(this.g),C==400&&F.indexOf("Unknown SID")>0?(this.m=3,ut(12)):(this.m=0,ut(13)),Ze(this),pt(this)}}}catch{}};function Oe(v){if(!we(v))return v.g.la();const C=fy(v.g);if(C==="")return"";let F="";const K=C.length,ge=Lo(v.g)==4;if(!v.h.i){if(typeof TextDecoder>"u")return Ze(v),pt(v),"";v.h.i=new a.TextDecoder}for(let Ie=0;Ie<K;Ie++)v.h.h=!0,F+=v.h.i.decode(C[Ie],{stream:!(ge&&Ie==K-1)});return C.length=0,v.h.g+=F,v.C=0,v.h.g}function we(v){return v.g?v.v=="GET"&&v.M!=2&&v.j.Aa:!1}function Te(v,C){var F=v.C,K=C.indexOf(`
`,F);return K==-1?Q:(F=Number(C.substring(F,K)),isNaN(F)?Y:(K+=1,K+F>C.length?Q:(C=C.slice(K,K+F),v.C=K+F,C)))}Z.prototype.cancel=function(){this.K=!0,Ze(this)};function Re(v){v.T=Date.now()+v.H,Ye(v,v.H)}function Ye(v,C){if(v.D!=null)throw Error("WatchDog timer not null");v.D=ne(c(v.aa,v),C)}function st(v){v.D&&(a.clearTimeout(v.D),v.D=null)}Z.prototype.aa=function(){this.D=null;const v=Date.now();v-this.T>=0?(ze(this.i,this.B),this.M!=2&&(Dt(),ut(17)),Ze(this),this.m=2,pt(this)):Ye(this,this.T-v)};function pt(v){v.j.I==0||v.K||Jd(v.j,v)}function Ze(v){st(v);var C=v.O;C&&typeof C.dispose=="function"&&C.dispose(),v.O=null,xn(v.V),v.g&&(C=v.g,v.g=null,C.abort(),C.dispose())}function Je(v,C){try{var F=v.j;if(F.I!=0&&(F.g==v||Ka(F.h,v))){if(!v.L&&Ka(F.h,v)&&F.I==3){try{var K=F.Ba.g.parse(C)}catch{K=null}if(Array.isArray(K)&&K.length==3){var ge=K;if(ge[0]==0){e:if(!F.v){if(F.g)if(F.g.F+3e3<v.F)Zd(F),Zs(F);else break e;jo(F),ut(18)}}else F.xa=ge[1],0<F.xa-F.K&&ge[2]<37500&&F.F&&F.A==0&&!F.C&&(F.C=ne(c(F.Va,F),6e3));yr(F.h)<=1&&F.ta&&(F.ta=void 0)}else Js(F,11)}else if((v.L||F.g==v)&&Zd(F),!j(C))for(ge=F.Ba.g.parse(C),C=0;C<ge.length;C++){let Xn=ge[C];const qr=Xn[0];if(!(qr<=F.K))if(F.K=qr,Xn=Xn[1],F.I==2)if(Xn[0]=="c"){F.M=Xn[1],F.ba=Xn[2];const Qs=Xn[3];Qs!=null&&(F.ka=Qs,F.j.info("VER="+F.ka));const Rl=Xn[4];Rl!=null&&(F.za=Rl,F.j.info("SVER="+F.za));const Fo=Xn[5];Fo!=null&&typeof Fo=="number"&&Fo>0&&(K=1.5*Fo,F.O=K,F.j.info("backChannelRequestTimeoutMs_="+K)),K=F;const Vo=v.g;if(Vo){const tf=Vo.g?Vo.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(tf){var Ie=K.h;Ie.g||tf.indexOf("spdy")==-1&&tf.indexOf("quic")==-1&&tf.indexOf("h2")==-1||(Ie.j=Ie.l,Ie.g=new Set,Ie.h&&(xa(Ie,Ie.h),Ie.h=null))}if(K.G){const Og=Vo.g?Vo.g.getResponseHeader("X-HTTP-Session-Id"):null;Og&&(K.wa=Og,On(K.J,K.G,Og))}}F.I=3,F.l&&F.l.ra(),F.aa&&(F.T=Date.now()-v.F,F.j.info("Handshake RTT: "+F.T+"ms")),K=F;var lt=v;if(K.na=Lg(K,K.L?K.ba:null,K.W),lt.L){qs(K.h,lt);var sn=lt,Ur=K.O;Ur&&(sn.H=Ur),sn.D&&(st(sn),Re(sn)),K.g=lt}else Zi(K);F.i.length>0&&Tl(F)}else Xn[0]!="stop"&&Xn[0]!="close"||Js(F,7);else F.I==3&&(Xn[0]=="stop"||Xn[0]=="close"?Xn[0]=="stop"?Js(F,7):qd(F):Xn[0]!="noop"&&F.l&&F.l.qa(Xn),F.A=0)}}Dt(4)}catch{}}var qt=class{constructor(v,C){this.g=v,this.map=C}};function zn(v){this.l=v||10,a.PerformanceNavigationTiming?(v=a.performance.getEntriesByType("navigation"),v=v.length>0&&(v[0].nextHopProtocol=="hq"||v[0].nextHopProtocol=="h2")):v=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=v?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Kn(v){return v.h?!0:v.g?v.g.size>=v.j:!1}function yr(v){return v.h?1:v.g?v.g.size:0}function Ka(v,C){return v.h?v.h==C:v.g?v.g.has(C):!1}function xa(v,C){v.g?v.g.add(C):v.h=C}function qs(v,C){v.h&&v.h==C?v.h=null:v.g&&v.g.has(C)&&v.g.delete(C)}zn.prototype.cancel=function(){if(this.i=zr(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const v of this.g.values())v.cancel();this.g.clear()}};function zr(v){if(v.h!=null)return v.i.concat(v.h.G);if(v.g!=null&&v.g.size!==0){let C=v.i;for(const F of v.g.values())C=C.concat(F.G);return C}return y(v.i)}var Sc=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Rr(v,C){if(v){v=v.split("&");for(let F=0;F<v.length;F++){const K=v[F].indexOf("=");let ge,Ie=null;K>=0?(ge=v[F].substring(0,K),Ie=v[F].substring(K+1)):ge=v[F],C(ge,Ie?decodeURIComponent(Ie.replace(/\+/g," ")):"")}}}function ko(v){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let C;v instanceof ko?(this.l=v.l,eh(this,v.j),this.o=v.o,this.g=v.g,Io(this,v.u),this.h=v.h,bc(this,Pg(v.i)),this.m=v.m):v&&(C=String(v).match(Sc))?(this.l=!1,eh(this,C[1]||"",!0),this.o=th(C[2]||""),this.g=th(C[3]||"",!0),Io(this,C[4]),this.h=th(C[5]||"",!0),bc(this,C[6]||"",!0),this.m=th(C[7]||"")):(this.l=!1,this.i=new En(null,this.l))}ko.prototype.toString=function(){const v=[];var C=this.j;C&&v.push(nh(C,Tg,!0),":");var F=this.g;return(F||C=="file")&&(v.push("//"),(C=this.o)&&v.push(nh(C,Tg,!0),"@"),v.push(Wt(F).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),F=this.u,F!=null&&v.push(":",String(F))),(F=this.h)&&(this.g&&F.charAt(0)!="/"&&v.push("/"),v.push(nh(F,F.charAt(0)=="/"?rh:Rg,!0))),(F=this.i.toString())&&v.push("?",F),(F=this.m)&&v.push("#",nh(F,Ag)),v.join("")},ko.prototype.resolve=function(v){const C=_a(this);let F=!!v.j;F?eh(C,v.j):F=!!v.o,F?C.o=v.o:F=!!v.g,F?C.g=v.g:F=v.u!=null;var K=v.h;if(F)Io(C,v.u);else if(F=!!v.h){if(K.charAt(0)!="/")if(this.g&&!this.h)K="/"+K;else{var ge=C.h.lastIndexOf("/");ge!=-1&&(K=C.h.slice(0,ge+1)+K)}if(ge=K,ge==".."||ge==".")K="";else if(ge.indexOf("./")!=-1||ge.indexOf("/.")!=-1){K=ge.lastIndexOf("/",0)==0,ge=ge.split("/");const Ie=[];for(let lt=0;lt<ge.length;){const sn=ge[lt++];sn=="."?K&&lt==ge.length&&Ie.push(""):sn==".."?((Ie.length>1||Ie.length==1&&Ie[0]!="")&&Ie.pop(),K&&lt==ge.length&&Ie.push("")):(Ie.push(sn),K=!0)}K=Ie.join("/")}else K=ge}return F?C.h=K:F=v.i.toString()!=="",F?bc(C,Pg(v.i)):F=!!v.m,F&&(C.m=v.m),C};function _a(v){return new ko(v)}function eh(v,C,F){v.j=F?th(C,!0):C,v.j&&(v.j=v.j.replace(/:$/,""))}function Io(v,C){if(C){if(C=Number(C),isNaN(C)||C<0)throw Error("Bad port number "+C);v.u=C}else v.u=null}function bc(v,C,F){C instanceof En?(v.i=C,Hd(v.i,v.l)):(F||(C=nh(C,UE)),v.i=new En(C,v.l))}function On(v,C,F){v.i.set(C,F)}function wl(v){return On(v,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),v}function th(v,C){return v?C?decodeURI(v.replace(/%25/g,"%2525")):decodeURIComponent(v):""}function nh(v,C,F){return typeof v=="string"?(v=encodeURI(v).replace(C,bg),F&&(v=v.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),v):null}function bg(v){return v=v.charCodeAt(0),"%"+(v>>4&15).toString(16)+(v&15).toString(16)}var Tg=/[#\/\?@]/g,Rg=/[#\?:]/g,rh=/[#\?]/g,UE=/[#\?@]/g,Ag=/#/g;function En(v,C){this.h=this.g=null,this.i=v||null,this.j=!!C}function Co(v){v.g||(v.g=new Map,v.h=0,v.i&&Rr(v.i,function(C,F){v.add(decodeURIComponent(C.replace(/\+/g," ")),F)}))}n=En.prototype,n.add=function(v,C){Co(this),this.i=null,v=Po(this,v);let F=this.g.get(v);return F||this.g.set(v,F=[]),F.push(C),this.h+=1,this};function kg(v,C){Co(v),C=Po(v,C),v.g.has(C)&&(v.i=null,v.h-=v.g.get(C).length,v.g.delete(C))}function Wd(v,C){return Co(v),C=Po(v,C),v.g.has(C)}n.forEach=function(v,C){Co(this),this.g.forEach(function(F,K){F.forEach(function(ge){v.call(C,ge,K,this)},this)},this)};function Ig(v,C){Co(v);let F=[];if(typeof C=="string")Wd(v,C)&&(F=F.concat(v.g.get(Po(v,C))));else for(v=Array.from(v.g.values()),C=0;C<v.length;C++)F=F.concat(v[C]);return F}n.set=function(v,C){return Co(this),this.i=null,v=Po(this,v),Wd(this,v)&&(this.h-=this.g.get(v).length),this.g.set(v,[C]),this.h+=1,this},n.get=function(v,C){return v?(v=Ig(this,v),v.length>0?String(v[0]):C):C};function Cg(v,C,F){kg(v,C),F.length>0&&(v.i=null,v.g.set(Po(v,C),y(F)),v.h+=F.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const v=[],C=Array.from(this.g.keys());for(let K=0;K<C.length;K++){var F=C[K];const ge=Wt(F);F=Ig(this,F);for(let Ie=0;Ie<F.length;Ie++){let lt=ge;F[Ie]!==""&&(lt+="="+Wt(F[Ie])),v.push(lt)}}return this.i=v.join("&")};function Pg(v){const C=new En;return C.i=v.i,v.g&&(C.g=new Map(v.g),C.h=v.h),C}function Po(v,C){return C=String(C),v.j&&(C=C.toLowerCase()),C}function Hd(v,C){C&&!v.j&&(Co(v),v.i=null,v.g.forEach(function(F,K){const ge=K.toLowerCase();K!=ge&&(kg(this,K),Cg(this,ge,F))},v)),v.j=C}function No(v,C){const F=new Ce;if(a.Image){const K=new Image;K.onload=h(Ni,F,"TestLoadImage: loaded",!0,C,K),K.onerror=h(Ni,F,"TestLoadImage: error",!1,C,K),K.onabort=h(Ni,F,"TestLoadImage: abort",!1,C,K),K.ontimeout=h(Ni,F,"TestLoadImage: timeout",!1,C,K),a.setTimeout(function(){K.ontimeout&&K.ontimeout()},1e4),K.src=v}else C(!1)}function Mo(v,C){const F=new Ce,K=new AbortController,ge=setTimeout(()=>{K.abort(),Ni(F,"TestPingServer: timeout",!1,C)},1e4);fetch(v,{signal:K.signal}).then(Ie=>{clearTimeout(ge),Ie.ok?Ni(F,"TestPingServer: ok",!0,C):Ni(F,"TestPingServer: server error",!1,C)}).catch(()=>{clearTimeout(ge),Ni(F,"TestPingServer: error",!1,C)})}function Ni(v,C,F,K,ge){try{ge&&(ge.onload=null,ge.onerror=null,ge.onabort=null,ge.ontimeout=null),K(F)}catch{}}function ih(){this.g=new an}function El(v){this.i=v.Sb||null,this.h=v.ab||!1}g(El,Lt),El.prototype.g=function(){return new Ys(this.i,this.h)};function Ys(v,C){ln.call(this),this.H=v,this.o=C,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}g(Ys,ln),n=Ys.prototype,n.open=function(v,C){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=v,this.D=C,this.readyState=1,Xa(this)},n.send=function(v){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const C={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};v&&(C.body=v),(this.H||a).fetch(new Request(this.D,C)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Tc(this)),this.readyState=0},n.Pa=function(v){if(this.g&&(this.l=v,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=v.headers,this.readyState=2,Xa(this)),this.g&&(this.readyState=3,Xa(this),this.g)))if(this.responseType==="arraybuffer")v.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in v){if(this.j=v.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;uy(this)}else v.text().then(this.Oa.bind(this),this.ga.bind(this))};function uy(v){v.j.read().then(v.Ma.bind(v)).catch(v.ga.bind(v))}n.Ma=function(v){if(this.g){if(this.o&&v.value)this.response.push(v.value);else if(!this.o){var C=v.value?v.value:new Uint8Array(0);(C=this.B.decode(C,{stream:!v.done}))&&(this.response=this.responseText+=C)}v.done?Tc(this):Xa(this),this.readyState==3&&uy(this)}},n.Oa=function(v){this.g&&(this.response=this.responseText=v,Tc(this))},n.Na=function(v){this.g&&(this.response=v,Tc(this))},n.ga=function(){this.g&&Tc(this)};function Tc(v){v.readyState=4,v.l=null,v.j=null,v.B=null,Xa(v)}n.setRequestHeader=function(v,C){this.A.append(v,C)},n.getResponseHeader=function(v){return this.h&&this.h.get(v.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const v=[],C=this.h.entries();for(var F=C.next();!F.done;)F=F.value,v.push(F[0]+": "+F[1]),F=C.next();return v.join(`\r
`)};function Xa(v){v.onreadystatechange&&v.onreadystatechange.call(v)}Object.defineProperty(Ys.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(v){this.m=v?"include":"same-origin"}});function hy(v){let C="";return Ne(v,function(F,K){C+=K,C+=":",C+=F,C+=`\r
`}),C}function Kd(v,C,F){e:{for(K in F){var K=!1;break e}K=!0}K||(F=hy(F),typeof v=="string"?F!=null&&Wt(F):On(v,C,F))}function ar(v){ln.call(this),this.headers=new Map,this.L=v||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}g(ar,ln);var dy=/^https?$/i,$E=["POST","PUT"];n=ar.prototype,n.Fa=function(v){this.H=v},n.ea=function(v,C,F,K){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+v);C=C?C.toUpperCase():"GET",this.D=v,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():yt.g(),this.g.onreadystatechange=m(c(this.Ca,this));try{this.B=!0,this.g.open(C,String(v),!0),this.B=!1}catch(Ie){Rc(this,Ie);return}if(v=F||"",F=new Map(this.headers),K)if(Object.getPrototypeOf(K)===Object.prototype)for(var ge in K)F.set(ge,K[ge]);else if(typeof K.keys=="function"&&typeof K.get=="function")for(const Ie of K.keys())F.set(Ie,K.get(Ie));else throw Error("Unknown input type for opt_headers: "+String(K));K=Array.from(F.keys()).find(Ie=>Ie.toLowerCase()=="content-type"),ge=a.FormData&&v instanceof a.FormData,!(Array.prototype.indexOf.call($E,C,void 0)>=0)||K||ge||F.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Ie,lt]of F)this.g.setRequestHeader(Ie,lt);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(v),this.v=!1}catch(Ie){Rc(this,Ie)}};function Rc(v,C){v.h=!1,v.g&&(v.j=!0,v.g.abort(),v.j=!1),v.l=C,v.o=5,Ac(v),bl(v)}function Ac(v){v.A||(v.A=!0,hn(v,"complete"),hn(v,"error"))}n.abort=function(v){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=v||7,hn(this,"complete"),hn(this,"abort"),bl(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),bl(this,!0)),ar.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Sl(this):this.Xa())},n.Xa=function(){Sl(this)};function Sl(v){if(v.h&&typeof s<"u"){if(v.v&&Lo(v)==4)setTimeout(v.Ca.bind(v),0);else if(hn(v,"readystatechange"),Lo(v)==4){v.h=!1;try{const Ie=v.ca();e:switch(Ie){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var C=!0;break e;default:C=!1}var F;if(!(F=C)){var K;if(K=Ie===0){let lt=String(v.D).match(Sc)[1]||null;!lt&&a.self&&a.self.location&&(lt=a.self.location.protocol.slice(0,-1)),K=!dy.test(lt?lt.toLowerCase():"")}F=K}if(F)hn(v,"complete"),hn(v,"success");else{v.o=6;try{var ge=Lo(v)>2?v.g.statusText:""}catch{ge=""}v.l=ge+" ["+v.ca()+"]",Ac(v)}}finally{bl(v)}}}}function bl(v,C){if(v.g){v.m&&(clearTimeout(v.m),v.m=null);const F=v.g;v.g=null,C||hn(v,"ready");try{F.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Lo(v){return v.g?v.g.readyState:0}n.ca=function(){try{return Lo(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(v){if(this.g){var C=this.g.responseText;return v&&C.indexOf(v)==0&&(C=C.substring(v.length)),Tt(C)}};function fy(v){try{if(!v.g)return null;if("response"in v.g)return v.g.response;switch(v.F){case"":case"text":return v.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in v.g)return v.g.mozResponseArrayBuffer}return null}catch{return null}}function Ng(v){const C={};v=(v.g&&Lo(v)>=2&&v.g.getAllResponseHeaders()||"").split(`\r
`);for(let K=0;K<v.length;K++){if(j(v[K]))continue;var F=z(v[K]);const ge=F[0];if(F=F[1],typeof F!="string")continue;F=F.trim();const Ie=C[ge]||[];C[ge]=Ie,Ie.push(F)}be(C,function(K){return K.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Oo(v,C,F){return F&&F.internalChannelParams&&F.internalChannelParams[v]||C}function Xd(v){this.za=0,this.i=[],this.j=new Ce,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Oo("failFast",!1,v),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Oo("baseRetryDelayMs",5e3,v),this.Za=Oo("retryDelaySeedMs",1e4,v),this.Ta=Oo("forwardChannelMaxRetries",2,v),this.va=Oo("forwardChannelRequestTimeoutMs",2e4,v),this.ma=v&&v.xmlHttpFactory||void 0,this.Ua=v&&v.Rb||void 0,this.Aa=v&&v.useFetchStreams||!1,this.O=void 0,this.L=v&&v.supportsCrossDomainXhr||!1,this.M="",this.h=new zn(v&&v.concurrentRequestLimit),this.Ba=new ih,this.S=v&&v.fastHandshake||!1,this.R=v&&v.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=v&&v.Pb||!1,v&&v.ua&&this.j.ua(),v&&v.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&v&&v.detectBufferingProxy||!1,this.ia=void 0,v&&v.longPollingTimeout&&v.longPollingTimeout>0&&(this.ia=v.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Xd.prototype,n.ka=8,n.I=1,n.connect=function(v,C,F,K){ut(0),this.W=v,this.H=C||{},F&&K!==void 0&&(this.H.OSID=F,this.H.OAID=K),this.F=this.X,this.J=Lg(this,null,this.W),Tl(this)};function qd(v){if(Yd(v),v.I==3){var C=v.V++,F=_a(v.J);if(On(F,"SID",v.M),On(F,"RID",C),On(F,"TYPE","terminate"),Do(v,F),C=new Z(v,v.j,C),C.M=2,C.A=wl(_a(F)),F=!1,a.navigator&&a.navigator.sendBeacon)try{F=a.navigator.sendBeacon(C.A.toString(),"")}catch{}!F&&a.Image&&(new Image().src=C.A,F=!0),F||(C.g=my(C.j,null),C.g.ea(C.A)),C.F=Date.now(),Re(C)}oh(v)}function Zs(v){v.g&&(ah(v),v.g.cancel(),v.g=null)}function Yd(v){Zs(v),v.v&&(a.clearTimeout(v.v),v.v=null),Zd(v),v.h.cancel(),v.m&&(typeof v.m=="number"&&a.clearTimeout(v.m),v.m=null)}function Tl(v){if(!Kn(v.h)&&!v.m){v.m=!0;var C=v.Ea;O||A(),B||(O(),B=!0),R.add(C,v),v.D=0}}function gy(v,C){return yr(v.h)>=v.h.j-(v.m?1:0)?!1:v.m?(v.i=C.G.concat(v.i),!0):v.I==1||v.I==2||v.D>=(v.Sa?0:v.Ta)?!1:(v.m=ne(c(v.Ea,v,C),Qd(v,v.D)),v.D++,!0)}n.Ea=function(v){if(this.m)if(this.m=null,this.I==1){if(!v){this.V=Math.floor(Math.random()*1e5),v=this.V++;const ge=new Z(this,this.j,v);let Ie=this.o;if(this.U&&(Ie?(Ie=ie(Ie),J(Ie,this.U)):Ie=this.U),this.u!==null||this.R||(ge.J=Ie,Ie=null),this.S)e:{for(var C=0,F=0;F<this.i.length;F++){t:{var K=this.i[F];if("__data__"in K.map&&(K=K.map.__data__,typeof K=="string")){K=K.length;break t}K=void 0}if(K===void 0)break;if(C+=K,C>4096){C=F;break e}if(C===4096||F===this.i.length-1){C=F+1;break e}}C=1e3}else C=1e3;C=Mg(this,ge,C),F=_a(this.J),On(F,"RID",v),On(F,"CVER",22),this.G&&On(F,"X-HTTP-Session-Id",this.G),Do(this,F),Ie&&(this.R?C="headers="+Wt(hy(Ie))+"&"+C:this.u&&Kd(F,this.u,Ie)),xa(this.h,ge),this.Ra&&On(F,"TYPE","init"),this.S?(On(F,"$req",C),On(F,"SID","null"),ge.U=!0,ee(ge,F,null)):ee(ge,F,C),this.I=2}}else this.I==3&&(v?sh(this,v):this.i.length==0||Kn(this.h)||sh(this))};function sh(v,C){var F;C?F=C.l:F=v.V++;const K=_a(v.J);On(K,"SID",v.M),On(K,"RID",F),On(K,"AID",v.K),Do(v,K),v.u&&v.o&&Kd(K,v.u,v.o),F=new Z(v,v.j,F,v.D+1),v.u===null&&(F.J=v.o),C&&(v.i=C.G.concat(v.i)),C=Mg(v,F,1e3),F.H=Math.round(v.va*.5)+Math.round(v.va*.5*Math.random()),xa(v.h,F),ee(F,K,C)}function Do(v,C){v.H&&Ne(v.H,function(F,K){On(C,K,F)}),v.l&&Ne({},function(F,K){On(C,K,F)})}function Mg(v,C,F){F=Math.min(v.i.length,F);const K=v.l?c(v.l.Ka,v.l,v):null;e:{var ge=v.i;let sn=-1;for(;;){const Ur=["count="+F];sn==-1?F>0?(sn=ge[0].g,Ur.push("ofs="+sn)):sn=0:Ur.push("ofs="+sn);let Xn=!0;for(let qr=0;qr<F;qr++){var Ie=ge[qr].g;const Qs=ge[qr].map;if(Ie-=sn,Ie<0)sn=Math.max(0,ge[qr].g-100),Xn=!1;else try{Ie="req"+Ie+"_"||"";try{var lt=Qs instanceof Map?Qs:Object.entries(Qs);for(const[Rl,Fo]of lt){let Vo=Fo;o(Fo)&&(Vo=In(Fo)),Ur.push(Ie+Rl+"="+encodeURIComponent(Vo))}}catch(Rl){throw Ur.push(Ie+"type="+encodeURIComponent("_badmap")),Rl}}catch{K&&K(Qs)}}if(Xn){lt=Ur.join("&");break e}}lt=void 0}return v=v.i.splice(0,F),C.G=v,lt}function Zi(v){if(!v.g&&!v.v){v.Y=1;var C=v.Da;O||A(),B||(O(),B=!0),R.add(C,v),v.A=0}}function jo(v){return v.g||v.v||v.A>=3?!1:(v.Y++,v.v=ne(c(v.Da,v),Qd(v,v.A)),v.A++,!0)}n.Da=function(){if(this.v=null,kc(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var v=4*this.T;this.j.info("BP detection timer enabled: "+v),this.B=ne(c(this.Wa,this),v)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,ut(10),Zs(this),kc(this))};function ah(v){v.B!=null&&(a.clearTimeout(v.B),v.B=null)}function kc(v){v.g=new Z(v,v.j,"rpc",v.Y),v.u===null&&(v.g.J=v.o),v.g.P=0;var C=_a(v.na);On(C,"RID","rpc"),On(C,"SID",v.M),On(C,"AID",v.K),On(C,"CI",v.F?"0":"1"),!v.F&&v.ia&&On(C,"TO",v.ia),On(C,"TYPE","xmlhttp"),Do(v,C),v.u&&v.o&&Kd(C,v.u,v.o),v.O&&(v.g.H=v.O);var F=v.g;v=v.ba,F.M=1,F.A=wl(_a(C)),F.u=null,F.R=!0,Ee(F,v)}n.Va=function(){this.C!=null&&(this.C=null,Zs(this),jo(this),ut(19))};function Zd(v){v.C!=null&&(a.clearTimeout(v.C),v.C=null)}function Jd(v,C){var F=null;if(v.g==C){Zd(v),ah(v),v.g=null;var K=2}else if(Ka(v.h,C))F=C.G,qs(v.h,C),K=1;else return;if(v.I!=0){if(C.o)if(K==1){F=C.u?C.u.length:0,C=Date.now()-C.F;var ge=v.D;K=xe(),hn(K,new W(K,F)),Tl(v)}else Zi(v);else if(ge=C.m,ge==3||ge==0&&C.X>0||!(K==1&&gy(v,C)||K==2&&jo(v)))switch(F&&F.length>0&&(C=v.h,C.i=C.i.concat(F)),ge){case 1:Js(v,5);break;case 4:Js(v,10);break;case 3:Js(v,6);break;default:Js(v,2)}}}function Qd(v,C){let F=v.Qa+Math.floor(Math.random()*v.Za);return v.isActive()||(F*=2),F*C}function Js(v,C){if(v.j.info("Error code "+C),C==2){var F=c(v.bb,v),K=v.Ua;const ge=!K;K=new ko(K||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||eh(K,"https"),wl(K),ge?No(K.toString(),F):Mo(K.toString(),F)}else ut(2);v.I=0,v.l&&v.l.pa(C),oh(v),Yd(v)}n.bb=function(v){v?(this.j.info("Successfully pinged google.com"),ut(2)):(this.j.info("Failed to ping google.com"),ut(1))};function oh(v){if(v.I=0,v.ja=[],v.l){const C=zr(v.h);(C.length!=0||v.i.length!=0)&&(_(v.ja,C),_(v.ja,v.i),v.h.i.length=0,y(v.i),v.i.length=0),v.l.oa()}}function Lg(v,C,F){var K=F instanceof ko?_a(F):new ko(F);if(K.g!="")C&&(K.g=C+"."+K.g),Io(K,K.u);else{var ge=a.location;K=ge.protocol,C=C?C+"."+ge.hostname:ge.hostname,ge=+ge.port;const Ie=new ko(null);K&&eh(Ie,K),C&&(Ie.g=C),ge&&Io(Ie,ge),F&&(Ie.h=F),K=Ie}return F=v.G,C=v.wa,F&&C&&On(K,F,C),On(K,"VER",v.ka),Do(v,K),K}function my(v,C,F){if(C&&!v.L)throw Error("Can't create secondary domain capable XhrIo object.");return C=v.Aa&&!v.ma?new ar(new El({ab:F})):new ar(v.ma),C.Fa(v.L),C}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function py(){}n=py.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function ef(){}ef.prototype.g=function(v,C){return new Mi(v,C)};function Mi(v,C){ln.call(this),this.g=new Xd(C),this.l=v,this.h=C&&C.messageUrlParams||null,v=C&&C.messageHeaders||null,C&&C.clientProtocolHeaderRequired&&(v?v["X-Client-Protocol"]="webchannel":v={"X-Client-Protocol":"webchannel"}),this.g.o=v,v=C&&C.initMessageHeaders||null,C&&C.messageContentType&&(v?v["X-WebChannel-Content-Type"]=C.messageContentType:v={"X-WebChannel-Content-Type":C.messageContentType}),C&&C.sa&&(v?v["X-WebChannel-Client-Profile"]=C.sa:v={"X-WebChannel-Client-Profile":C.sa}),this.g.U=v,(v=C&&C.Qb)&&!j(v)&&(this.g.u=v),this.A=C&&C.supportsCrossDomainXhr||!1,this.v=C&&C.sendRawJson||!1,(C=C&&C.httpSessionIdParam)&&!j(C)&&(this.g.G=C,v=this.h,v!==null&&C in v&&(v=this.h,C in v&&delete v[C])),this.j=new Ic(this)}g(Mi,ln),Mi.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Mi.prototype.close=function(){qd(this.g)},Mi.prototype.o=function(v){var C=this.g;if(typeof v=="string"){var F={};F.__data__=v,v=F}else this.v&&(F={},F.__data__=In(v),v=F);C.i.push(new qt(C.Ya++,v)),C.I==3&&Tl(C)},Mi.prototype.N=function(){this.g.l=null,delete this.j,qd(this.g),delete this.g,Mi.Z.N.call(this)};function yy(v){li.call(this),v.__headers__&&(this.headers=v.__headers__,this.statusCode=v.__status__,delete v.__headers__,delete v.__status__);var C=v.__sm__;if(C){e:{for(const F in C){v=F;break e}v=void 0}(this.i=v)&&(v=this.i,C=C!==null&&v in C?C[v]:void 0),this.data=C}else this.data=v}g(yy,li);function xy(){rn.call(this),this.status=1}g(xy,rn);function Ic(v){this.g=v}g(Ic,py),Ic.prototype.ra=function(){hn(this.g,"a")},Ic.prototype.qa=function(v){hn(this.g,new yy(v))},Ic.prototype.pa=function(v){hn(this.g,new xy)},Ic.prototype.oa=function(){hn(this.g,"b")},ef.prototype.createWebChannel=ef.prototype.g,Mi.prototype.send=Mi.prototype.o,Mi.prototype.open=Mi.prototype.m,Mi.prototype.close=Mi.prototype.close,g6=function(){return new ef},f6=function(){return xe()},d6=Tr,VT={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},He.NO_ERROR=0,He.TIMEOUT=8,He.HTTP_ERROR=6,c_=He,$e.COMPLETE="complete",h6=$e,Yi.EventType=Mr,Mr.OPEN="a",Mr.CLOSE="b",Mr.ERROR="c",Mr.MESSAGE="d",ln.prototype.listen=ln.prototype.J,Rm=Yi,ar.prototype.listenOnce=ar.prototype.K,ar.prototype.getLastError=ar.prototype.Ha,ar.prototype.getLastErrorCode=ar.prototype.ya,ar.prototype.getStatus=ar.prototype.ca,ar.prototype.getResponseJson=ar.prototype.La,ar.prototype.getResponseText=ar.prototype.la,ar.prototype.send=ar.prototype.ea,ar.prototype.setWithCredentials=ar.prototype.Fa,u6=ar}).apply(typeof Ax<"u"?Ax:typeof self<"u"?self:typeof window<"u"?window:{});const UM="@firebase/firestore",$M="4.9.3";let zi=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};zi.UNAUTHENTICATED=new zi(null),zi.GOOGLE_CREDENTIALS=new zi("google-credentials-uid"),zi.FIRST_PARTY=new zi("first-party-uid"),zi.MOCK_USER=new zi("mock-user");let ug="12.7.0";const md=new YA("@firebase/firestore");function Hf(){return md.logLevel}function nt(n,...e){if(md.logLevel<=_n.DEBUG){const t=e.map(lk);md.debug(`Firestore (${ug}): ${n}`,...t)}}function ws(n,...e){if(md.logLevel<=_n.ERROR){const t=e.map(lk);md.error(`Firestore (${ug}): ${n}`,...t)}}function pd(n,...e){if(md.logLevel<=_n.WARN){const t=e.map(lk);md.warn(`Firestore (${ug}): ${n}`,...t)}}function lk(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function Ct(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,m6(n,r,t)}function m6(n,e,t){let r=`FIRESTORE (${ug}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw ws(r),new Error(r)}function Ot(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||m6(e,i,r)}function nn(n,e){return n}const De={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ht extends _l{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class sl{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class p6{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class RQ{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(zi.UNAUTHENTICATED)))}shutdown(){}}class AQ{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class kQ{constructor(e){this.t=e,this.currentUser=zi.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ot(this.o===void 0,42304);let r=this.i;const i=l=>this.i!==r?(r=this.i,t(l)):Promise.resolve();let s=new sl;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new sl,e.enqueueRetryable((()=>i(this.currentUser)))};const a=()=>{const l=s;e.enqueueRetryable((async()=>{await l.promise,await i(this.currentUser)}))},o=l=>{nt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit((l=>o(l))),setTimeout((()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(nt("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new sl)}}),0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(nt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Ot(typeof r.accessToken=="string",31837,{l:r}),new p6(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ot(e===null||typeof e=="string",2055,{h:e}),new zi(e)}}class IQ{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=zi.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class CQ{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new IQ(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(zi.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class WM{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class PQ{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,ca(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Ot(this.o===void 0,3512);const r=s=>{s.error!=null&&nt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.m;return this.m=s.token,nt("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable((()=>r(s)))};const i=s=>{nt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((s=>i(s))),setTimeout((()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):nt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new WM(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Ot(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new WM(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function NQ(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class ck{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=NQ(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%62))}return r}}function tn(n,e){return n<e?-1:n>e?1:0}function BT(n,e){const t=Math.min(n.length,e.length);for(let r=0;r<t;r++){const i=n.charAt(r),s=e.charAt(r);if(i!==s)return lb(i)===lb(s)?tn(i,s):lb(i)?1:-1}return tn(n.length,e.length)}const MQ=55296,LQ=57343;function lb(n){const e=n.charCodeAt(0);return e>=MQ&&e<=LQ}function D0(n,e,t){return n.length===e.length&&n.every(((r,i)=>t(r,e[i])))}function y6(n){return n+"\0"}const HM="__name__";class qo{constructor(e,t,r){t===void 0?t=0:t>e.length&&Ct(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&Ct(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return qo.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof qo?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const s=qo.compareSegments(e.get(i),t.get(i));if(s!==0)return s}return tn(e.length,t.length)}static compareSegments(e,t){const r=qo.isNumericId(e),i=qo.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?qo.extractNumericId(e).compare(qo.extractNumericId(t)):BT(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Au.fromString(e.substring(4,e.length-2))}}class Bn extends qo{construct(e,t,r){return new Bn(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new ht(De.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((i=>i.length>0)))}return new Bn(t)}static emptyPath(){return new Bn([])}}const OQ=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Pr extends qo{construct(e,t,r){return new Pr(e,t,r)}static isValidIdentifier(e){return OQ.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Pr.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===HM}static keyField(){return new Pr([HM])}static fromServerFormat(e){const t=[];let r="",i=0;const s=()=>{if(r.length===0)throw new ht(De.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let a=!1;for(;i<e.length;){const o=e[i];if(o==="\\"){if(i+1===e.length)throw new ht(De.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new ht(De.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else o==="`"?(a=!a,i++):o!=="."||a?(r+=o,i++):(s(),i++)}if(s(),a)throw new ht(De.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Pr(t)}static emptyPath(){return new Pr([])}}class ft{constructor(e){this.path=e}static fromPath(e){return new ft(Bn.fromString(e))}static fromName(e){return new ft(Bn.fromString(e).popFirst(5))}static empty(){return new ft(Bn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Bn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Bn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ft(new Bn(e.slice()))}}function x6(n,e,t){if(!t)throw new ht(De.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function DQ(n,e,t,r){if(e===!0&&r===!0)throw new ht(De.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function KM(n){if(!ft.isDocumentKey(n))throw new ht(De.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function XM(n){if(ft.isDocumentKey(n))throw new ht(De.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function _6(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Kw(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Ct(12329,{type:typeof n})}function $a(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new ht(De.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Kw(n);throw new ht(De.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function ni(n,e){const t={typeString:n};return e&&(t.value=e),t}function O1(n,e){if(!_6(n))throw new ht(De.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const a=n[r];if(i&&typeof a!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&a!==s.value){t=`Expected '${r}' field to equal '${s.value}'`;break}}if(t)throw new ht(De.INVALID_ARGUMENT,t);return!0}const qM=-62135596800,YM=1e6;class Zn{static now(){return Zn.fromMillis(Date.now())}static fromDate(e){return Zn.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*YM);return new Zn(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ht(De.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ht(De.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<qM)throw new ht(De.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ht(De.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/YM}_compareTo(e){return this.seconds===e.seconds?tn(this.nanoseconds,e.nanoseconds):tn(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Zn._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(O1(e,Zn._jsonSchema))return new Zn(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-qM;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Zn._jsonSchemaVersion="firestore/timestamp/1.0",Zn._jsonSchema={type:ni("string",Zn._jsonSchemaVersion),seconds:ni("number"),nanoseconds:ni("number")};class Ft{static fromTimestamp(e){return new Ft(e)}static min(){return new Ft(new Zn(0,0))}static max(){return new Ft(new Zn(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Dp=-1;class uv{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}}function GT(n){return n.fields.find((e=>e.kind===2))}function kh(n){return n.fields.filter((e=>e.kind!==2))}uv.UNKNOWN_ID=-1;class u_{constructor(e,t){this.fieldPath=e,this.kind=t}}class jp{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new jp(0,ga.min())}}function jQ(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=Ft.fromTimestamp(r===1e9?new Zn(t+1,0):new Zn(t,r));return new ga(i,ft.empty(),e)}function v6(n){return new ga(n.readTime,n.key,Dp)}class ga{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new ga(Ft.min(),ft.empty(),Dp)}static max(){return new ga(Ft.max(),ft.empty(),Dp)}}function uk(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=ft.comparator(n.documentKey,e.documentKey),t!==0?t:tn(n.largestBatchId,e.largestBatchId))}const w6="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class E6{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Dd(n){if(n.code!==De.FAILED_PRECONDITION||n.message!==w6)throw n;nt("LocalStore","Unexpectedly lost primary lease")}class de{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ct(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new de(((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof de?t:de.resolve(t)}catch(t){return de.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):de.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):de.reject(t)}static resolve(e){return new de(((t,r)=>{t(e)}))}static reject(e){return new de(((t,r)=>{r(e)}))}static waitFor(e){return new de(((t,r)=>{let i=0,s=0,a=!1;e.forEach((o=>{++i,o.next((()=>{++s,a&&s===i&&t()}),(l=>r(l)))})),a=!0,s===i&&t()}))}static or(e){let t=de.resolve(!1);for(const r of e)t=t.next((i=>i?de.resolve(i):r()));return t}static forEach(e,t){const r=[];return e.forEach(((i,s)=>{r.push(t.call(this,i,s))})),this.waitFor(r)}static mapArray(e,t){return new de(((r,i)=>{const s=e.length,a=new Array(s);let o=0;for(let l=0;l<s;l++){const c=l;t(e[c]).next((h=>{a[c]=h,++o,o===s&&r(a)}),(h=>i(h)))}}))}static doWhile(e,t){return new de(((r,i)=>{const s=()=>{e()===!0?t().next((()=>{s()}),i):r()};s()}))}}const ia="SimpleDb";class Xw{static open(e,t,r,i){try{return new Xw(t,e.transaction(i,r))}catch(s){throw new Um(t,s)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new sl,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new Um(e,t.error)):this.S.resolve()},this.transaction.onerror=r=>{const i=hk(r.target.error);this.S.reject(new Um(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(nt(ia,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new VQ(t)}}class ku{static delete(e){return nt(ia,"Removing database:",e),Oh(mF().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!bF())return!1;if(ku.F())return!0;const e=pi(),t=ku.M(e),r=0<t&&t<10,i=S6(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,t,r){this.name=e,this.version=t,this.N=r,this.B=null,ku.M(pi())===12.2&&ws("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(nt(ia,"Opening database:",this.name),this.db=await new Promise(((t,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const a=s.target.result;t(a)},i.onblocked=()=>{r(new Um(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const a=s.target.error;a.name==="VersionError"?r(new ht(De.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):a.name==="InvalidStateError"?r(new ht(De.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+a)):r(new Um(e,a))},i.onupgradeneeded=s=>{nt(ia,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const a=s.target.result;this.N.k(a,i.transaction,s.oldVersion,this.version).next((()=>{nt(ia,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,i){const s=t==="readonly";let a=0;for(;;){++a;try{this.db=await this.L(e);const o=Xw.open(this.db,e,s?"readonly":"readwrite",r),l=i(o).next((c=>(o.C(),c))).catch((c=>(o.abort(c),de.reject(c)))).toPromise();return l.catch((()=>{})),await o.D,l}catch(o){const l=o,c=l.name!=="FirebaseError"&&a<3;if(nt(ia,"Transaction failed with error:",l.message,"Retrying:",c),this.close(),!c)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function S6(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class FQ{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return Oh(this.U.delete())}}class Um extends ht{constructor(e,t){super(De.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Ku(n){return n.name==="IndexedDbTransactionError"}class VQ{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(nt(ia,"PUT",this.store.name,e,t),r=this.store.put(t,e)):(nt(ia,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Oh(r)}add(e){return nt(ia,"ADD",this.store.name,e,e),Oh(this.store.add(e))}get(e){return Oh(this.store.get(e)).next((t=>(t===void 0&&(t=null),nt(ia,"GET",this.store.name,e,t),t)))}delete(e){return nt(ia,"DELETE",this.store.name,e),Oh(this.store.delete(e))}count(){return nt(ia,"COUNT",this.store.name),Oh(this.store.count())}J(e,t){const r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const s=i.getAll(r.range);return new de(((a,o)=>{s.onerror=l=>{o(l.target.error)},s.onsuccess=l=>{a(l.target.result)}}))}{const s=this.cursor(r),a=[];return this.H(s,((o,l)=>{a.push(l)})).next((()=>a))}}Y(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new de(((i,s)=>{r.onerror=a=>{s(a.target.error)},r.onsuccess=a=>{i(a.target.result)}}))}Z(e,t){nt(ia,"DELETE ALL",this.store.name);const r=this.options(e,t);r.X=!1;const i=this.cursor(r);return this.H(i,((s,a,o)=>o.delete()))}ee(e,t){let r;t?r=e:(r={},t=e);const i=this.cursor(r);return this.H(i,t)}te(e){const t=this.cursor({});return new de(((r,i)=>{t.onerror=s=>{const a=hk(s.target.error);i(a)},t.onsuccess=s=>{const a=s.target.result;a?e(a.primaryKey,a.value).next((o=>{o?a.continue():r()})):r()}}))}H(e,t){const r=[];return new de(((i,s)=>{e.onerror=a=>{s(a.target.error)},e.onsuccess=a=>{const o=a.target.result;if(!o)return void i();const l=new FQ(o),c=t(o.primaryKey,o.value,l);if(c instanceof de){const h=c.catch((g=>(l.done(),de.reject(g))));r.push(h)}l.isDone?i():l.G===null?o.continue():o.continue(l.G)}})).next((()=>de.waitFor(r)))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Oh(n){return new de(((e,t)=>{n.onsuccess=r=>{const i=r.target.result;e(i)},n.onerror=r=>{const i=hk(r.target.error);t(i)}}))}let ZM=!1;function hk(n){const e=ku.M(pi());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new ht("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return ZM||(ZM=!0,setTimeout((()=>{throw r}),0)),r}}return n}const $m="IndexBackfiller";class BQ{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){nt($m,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();nt($m,`Documents written: ${t}`)}catch(t){Ku(t)?nt($m,"Ignoring IndexedDB error during index backfill: ",t):await Dd(t)}await this.re(6e4)}))}}class GQ{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const r=new Set;let i=t,s=!0;return de.doWhile((()=>s===!0&&i>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((a=>{if(a!==null&&!r.has(a))return nt($m,`Processing collection: ${a}`),this.oe(e,a,i).next((o=>{i-=o,r.add(a)}));s=!1})))).next((()=>t-i))}oe(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next((s=>{const a=s.changes;return this.localStore.indexManager.updateIndexEntries(e,a).next((()=>this._e(i,s))).next((o=>(nt($m,`Updating offset: ${o}`),this.localStore.indexManager.updateCollectionGroup(e,t,o)))).next((()=>a.size))}))))}_e(e,t){let r=e;return t.changes.forEach(((i,s)=>{const a=v6(s);uk(a,r)>0&&(r=a)})),new ga(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}class Da{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Da.ce=-1;const Jh=-1;function qw(n){return n==null}function Fp(n){return n===0&&1/n==-1/0}function zQ(n){return typeof n=="number"&&Number.isInteger(n)&&!Fp(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const hv="";function ds(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=JM(e)),e=UQ(n.get(t),e);return JM(e)}function UQ(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const s=n.charAt(i);switch(s){case"\0":t+="";break;case hv:t+="";break;default:t+=s}}return t}function JM(n){return n+hv+""}function el(n){const e=n.length;if(Ot(e>=2,64408,{path:n}),e===2)return Ot(n.charAt(0)===hv&&n.charAt(1)==="",56145,{path:n}),Bn.emptyPath();const t=e-2,r=[];let i="";for(let s=0;s<e;){const a=n.indexOf(hv,s);switch((a<0||a>t)&&Ct(50515,{path:n}),n.charAt(a+1)){case"":const o=n.substring(s,a);let l;i.length===0?l=o:(i+=o,l=i,i=""),r.push(l);break;case"":i+=n.substring(s,a),i+="\0";break;case"":i+=n.substring(s,a+1);break;default:Ct(61167,{path:n})}s=a+2}return new Bn(r)}const Ih="remoteDocuments",D1="owner",Mf="owner",Vp="mutationQueues",$Q="userId",ao="mutations",QM="batchId",Wh="userMutationsIndex",eL=["userId","batchId"];function h_(n,e){return[n,ds(e)]}function b6(n,e,t){return[n,ds(e),t]}const WQ={},j0="documentMutations",dv="remoteDocumentsV14",HQ=["prefixPath","collectionGroup","readTime","documentId"],d_="documentKeyIndex",KQ=["prefixPath","collectionGroup","documentId"],T6="collectionGroupIndex",XQ=["collectionGroup","readTime","prefixPath","documentId"],Bp="remoteDocumentGlobal",zT="remoteDocumentGlobalKey",F0="targets",R6="queryTargetsIndex",qQ=["canonicalId","targetId"],V0="targetDocuments",YQ=["targetId","path"],dk="documentTargetsIndex",ZQ=["path","targetId"],fv="targetGlobalKey",Qh="targetGlobal",Gp="collectionParents",JQ=["collectionId","parent"],B0="clientMetadata",QQ="clientId",Yw="bundles",eee="bundleId",Zw="namedQueries",tee="name",fk="indexConfiguration",nee="indexId",UT="collectionGroupIndex",ree="collectionGroup",Wm="indexState",iee=["indexId","uid"],A6="sequenceNumberIndex",see=["uid","sequenceNumber"],Hm="indexEntries",aee=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],k6="documentKeyIndex",oee=["indexId","uid","orderedDocumentKey"],Jw="documentOverlays",lee=["userId","collectionPath","documentId"],$T="collectionPathOverlayIndex",cee=["userId","collectionPath","largestBatchId"],I6="collectionGroupOverlayIndex",uee=["userId","collectionGroup","largestBatchId"],gk="globals",hee="name",C6=[Vp,ao,j0,Ih,F0,D1,Qh,V0,B0,Bp,Gp,Yw,Zw],dee=[...C6,Jw],P6=[Vp,ao,j0,dv,F0,D1,Qh,V0,B0,Bp,Gp,Yw,Zw,Jw],N6=P6,mk=[...N6,fk,Wm,Hm],fee=mk,M6=[...mk,gk],gee=M6;class WT extends E6{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function yi(n,e){const t=nn(n);return ku.O(t.le,e)}function tL(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Xu(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function L6(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class Er{constructor(e,t){this.comparator=e,this.root=t||Ui.EMPTY}insert(e,t){return new Er(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Ui.BLACK,null,null))}remove(e){return new Er(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ui.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new kx(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new kx(this.root,e,this.comparator,!1)}getReverseIterator(){return new kx(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new kx(this.root,e,this.comparator,!0)}}class kx{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ui{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??Ui.RED,this.left=i??Ui.EMPTY,this.right=s??Ui.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new Ui(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Ui.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return Ui.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ui.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ui.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ct(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ct(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ct(27949);return e+(this.isRed()?0:1)}}Ui.EMPTY=null,Ui.RED=!0,Ui.BLACK=!1;Ui.EMPTY=new class{constructor(){this.size=0}get key(){throw Ct(57766)}get value(){throw Ct(16141)}get color(){throw Ct(16727)}get left(){throw Ct(29726)}get right(){throw Ct(36894)}copy(e,t,r,i,s){return this}insert(e,t,r){return new Ui(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class tr{constructor(e){this.comparator=e,this.data=new Er(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new nL(this.data.getIterator())}getIteratorFrom(e){return new nL(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof tr)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new tr(this.comparator);return t.data=e,t}}class nL{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Lf(n){return n.hasNext()?n.getNext():void 0}class Vs{constructor(e){this.fields=e,e.sort(Pr.comparator)}static empty(){return new Vs([])}unionWith(e){let t=new tr(Pr.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Vs(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return D0(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}class O6 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class si{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new O6("Invalid base64 string: "+s):s}})(e);return new si(t)}static fromUint8Array(e){const t=(function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s})(e);return new si(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return tn(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}si.EMPTY_BYTE_STRING=new si("");const mee=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function oc(n){if(Ot(!!n,39018),typeof n=="string"){let e=0;const t=mee.exec(n);if(Ot(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:_r(n.seconds),nanos:_r(n.nanos)}}function _r(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function lc(n){return typeof n=="string"?si.fromBase64String(n):si.fromUint8Array(n)}const D6="server_timestamp",j6="__type__",F6="__previous_value__",V6="__local_write_time__";function pk(n){return(n?.mapValue?.fields||{})[j6]?.stringValue===D6}function Qw(n){const e=n.mapValue.fields[F6];return pk(e)?Qw(e):e}function zp(n){const e=oc(n.mapValue.fields[V6].timestampValue);return new Zn(e.seconds,e.nanos)}class pee{constructor(e,t,r,i,s,a,o,l,c,h){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=c,this.isUsingEmulator=h}}const gv="(default)";class yd{constructor(e,t){this.projectId=e,this.database=t||gv}static empty(){return new yd("","")}get isDefaultDatabase(){return this.database===gv}isEqual(e){return e instanceof yd&&e.projectId===this.projectId&&e.database===this.database}}const yk="__type__",B6="__max__",pu={mapValue:{fields:{__type__:{stringValue:B6}}}},xk="__vector__",G0="value",f_={nullValue:"NULL_VALUE"};function Ou(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?pk(n)?4:G6(n)?9007199254740991:eE(n)?10:11:Ct(28295,{value:n})}function dl(n,e){if(n===e)return!0;const t=Ou(n);if(t!==Ou(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return zp(n).isEqual(zp(e));case 3:return(function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=oc(i.timestampValue),o=oc(s.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(i,s){return lc(i.bytesValue).isEqual(lc(s.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(i,s){return _r(i.geoPointValue.latitude)===_r(s.geoPointValue.latitude)&&_r(i.geoPointValue.longitude)===_r(s.geoPointValue.longitude)})(n,e);case 2:return(function(i,s){if("integerValue"in i&&"integerValue"in s)return _r(i.integerValue)===_r(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=_r(i.doubleValue),o=_r(s.doubleValue);return a===o?Fp(a)===Fp(o):isNaN(a)&&isNaN(o)}return!1})(n,e);case 9:return D0(n.arrayValue.values||[],e.arrayValue.values||[],dl);case 10:case 11:return(function(i,s){const a=i.mapValue.fields||{},o=s.mapValue.fields||{};if(tL(a)!==tL(o))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(o[l]===void 0||!dl(a[l],o[l])))return!1;return!0})(n,e);default:return Ct(52216,{left:n})}}function Up(n,e){return(n.values||[]).find((t=>dl(t,e)))!==void 0}function Du(n,e){if(n===e)return 0;const t=Ou(n),r=Ou(e);if(t!==r)return tn(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return tn(n.booleanValue,e.booleanValue);case 2:return(function(s,a){const o=_r(s.integerValue||s.doubleValue),l=_r(a.integerValue||a.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1})(n,e);case 3:return rL(n.timestampValue,e.timestampValue);case 4:return rL(zp(n),zp(e));case 5:return BT(n.stringValue,e.stringValue);case 6:return(function(s,a){const o=lc(s),l=lc(a);return o.compareTo(l)})(n.bytesValue,e.bytesValue);case 7:return(function(s,a){const o=s.split("/"),l=a.split("/");for(let c=0;c<o.length&&c<l.length;c++){const h=tn(o[c],l[c]);if(h!==0)return h}return tn(o.length,l.length)})(n.referenceValue,e.referenceValue);case 8:return(function(s,a){const o=tn(_r(s.latitude),_r(a.latitude));return o!==0?o:tn(_r(s.longitude),_r(a.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return iL(n.arrayValue,e.arrayValue);case 10:return(function(s,a){const o=s.fields||{},l=a.fields||{},c=o[G0]?.arrayValue,h=l[G0]?.arrayValue,g=tn(c?.values?.length||0,h?.values?.length||0);return g!==0?g:iL(c,h)})(n.mapValue,e.mapValue);case 11:return(function(s,a){if(s===pu.mapValue&&a===pu.mapValue)return 0;if(s===pu.mapValue)return 1;if(a===pu.mapValue)return-1;const o=s.fields||{},l=Object.keys(o),c=a.fields||{},h=Object.keys(c);l.sort(),h.sort();for(let g=0;g<l.length&&g<h.length;++g){const m=BT(l[g],h[g]);if(m!==0)return m;const y=Du(o[l[g]],c[h[g]]);if(y!==0)return y}return tn(l.length,h.length)})(n.mapValue,e.mapValue);default:throw Ct(23264,{he:t})}}function rL(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return tn(n,e);const t=oc(n),r=oc(e),i=tn(t.seconds,r.seconds);return i!==0?i:tn(t.nanos,r.nanos)}function iL(n,e){const t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){const s=Du(t[i],r[i]);if(s)return s}return tn(t.length,r.length)}function z0(n){return HT(n)}function HT(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const r=oc(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return lc(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return ft.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",i=!0;for(const s of t.values||[])i?i=!1:r+=",",r+=HT(s);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){const r=Object.keys(t.fields||{}).sort();let i="{",s=!0;for(const a of r)s?s=!1:i+=",",i+=`${a}:${HT(t.fields[a])}`;return i+"}"})(n.mapValue):Ct(61005,{value:n})}function g_(n){switch(Ou(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Qw(n);return e?16+g_(e):16;case 5:return 2*n.stringValue.length;case 6:return lc(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((i,s)=>i+g_(s)),0)})(n.arrayValue);case 10:case 11:return(function(r){let i=0;return Xu(r.fields,((s,a)=>{i+=s.length+g_(a)})),i})(n.mapValue);default:throw Ct(13486,{value:n})}}function $p(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function KT(n){return!!n&&"integerValue"in n}function Wp(n){return!!n&&"arrayValue"in n}function sL(n){return!!n&&"nullValue"in n}function aL(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function m_(n){return!!n&&"mapValue"in n}function eE(n){return(n?.mapValue?.fields||{})[yk]?.stringValue===xk}function Km(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return Xu(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=Km(r))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Km(n.arrayValue.values[t]);return e}return{...n}}function G6(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===B6}const z6={mapValue:{fields:{[yk]:{stringValue:xk},[G0]:{arrayValue:{}}}}};function yee(n){return"nullValue"in n?f_:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?$p(yd.empty(),ft.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?eE(n)?z6:{mapValue:{}}:Ct(35942,{value:n})}function xee(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?$p(yd.empty(),ft.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?z6:"mapValue"in n?eE(n)?{mapValue:{}}:pu:Ct(61959,{value:n})}function oL(n,e){const t=Du(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function lL(n,e){const t=Du(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class cs{constructor(e){this.value=e}static empty(){return new cs({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!m_(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Km(t)}setAll(e){let t=Pr.emptyPath(),r={},i=[];e.forEach(((a,o)=>{if(!t.isImmediateParentOf(o)){const l=this.getFieldsMap(t);this.applyChanges(l,r,i),r={},i=[],t=o.popLast()}a?r[o.lastSegment()]=Km(a):i.push(o.lastSegment())}));const s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){const t=this.field(e.popLast());m_(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return dl(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];m_(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Xu(t,((i,s)=>e[i]=s));for(const i of r)delete e[i]}clone(){return new cs(Km(this.value))}}function U6(n){const e=[];return Xu(n.fields,((t,r)=>{const i=new Pr([t]);if(m_(r)){const s=U6(r.mapValue).fields;if(s.length===0)e.push(i);else for(const a of s)e.push(i.child(a))}else e.push(i)})),new Vs(e)}class Br{constructor(e,t,r,i,s,a,o){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=a,this.documentState=o}static newInvalidDocument(e){return new Br(e,0,Ft.min(),Ft.min(),Ft.min(),cs.empty(),0)}static newFoundDocument(e,t,r,i){return new Br(e,1,t,Ft.min(),r,i,0)}static newNoDocument(e,t){return new Br(e,2,t,Ft.min(),Ft.min(),cs.empty(),0)}static newUnknownDocument(e,t){return new Br(e,3,t,Ft.min(),Ft.min(),cs.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ft.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=cs.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=cs.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ft.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Br&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Br(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class U0{constructor(e,t){this.position=e,this.inclusive=t}}function cL(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const s=e[i],a=n.position[i];if(s.field.isKeyField()?r=ft.comparator(ft.fromName(a.referenceValue),t.key):r=Du(a,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function uL(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!dl(n.position[t],e.position[t]))return!1;return!0}class mv{constructor(e,t="asc"){this.field=e,this.dir=t}}function _ee(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class $6{}class vn extends $6{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new vee(e,t,r):t==="array-contains"?new See(e,r):t==="in"?new Y6(e,r):t==="not-in"?new bee(e,r):t==="array-contains-any"?new Tee(e,r):new vn(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new wee(e,r):new Eee(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Du(t,this.value)):t!==null&&Ou(this.value)===Ou(t)&&this.matchesComparison(Du(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ct(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Qn extends $6{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Qn(e,t)}matches(e){return $0(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function $0(n){return n.op==="and"}function XT(n){return n.op==="or"}function _k(n){return W6(n)&&$0(n)}function W6(n){for(const e of n.filters)if(e instanceof Qn)return!1;return!0}function qT(n){if(n instanceof vn)return n.field.canonicalString()+n.op.toString()+z0(n.value);if(_k(n))return n.filters.map((e=>qT(e))).join(",");{const e=n.filters.map((t=>qT(t))).join(",");return`${n.op}(${e})`}}function H6(n,e){return n instanceof vn?(function(r,i){return i instanceof vn&&r.op===i.op&&r.field.isEqual(i.field)&&dl(r.value,i.value)})(n,e):n instanceof Qn?(function(r,i){return i instanceof Qn&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce(((s,a,o)=>s&&H6(a,i.filters[o])),!0):!1})(n,e):void Ct(19439)}function K6(n,e){const t=n.filters.concat(e);return Qn.create(t,n.op)}function X6(n){return n instanceof vn?(function(t){return`${t.field.canonicalString()} ${t.op} ${z0(t.value)}`})(n):n instanceof Qn?(function(t){return t.op.toString()+" {"+t.getFilters().map(X6).join(" ,")+"}"})(n):"Filter"}class vee extends vn{constructor(e,t,r){super(e,t,r),this.key=ft.fromName(r.referenceValue)}matches(e){const t=ft.comparator(e.key,this.key);return this.matchesComparison(t)}}class wee extends vn{constructor(e,t){super(e,"in",t),this.keys=q6("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class Eee extends vn{constructor(e,t){super(e,"not-in",t),this.keys=q6("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function q6(n,e){return(e.arrayValue?.values||[]).map((t=>ft.fromName(t.referenceValue)))}class See extends vn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Wp(t)&&Up(t.arrayValue,this.value)}}class Y6 extends vn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Up(this.value.arrayValue,t)}}class bee extends vn{constructor(e,t){super(e,"not-in",t)}matches(e){if(Up(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Up(this.value.arrayValue,t)}}class Tee extends vn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Wp(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>Up(this.value.arrayValue,r)))}}class Ree{constructor(e,t=null,r=[],i=[],s=null,a=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=a,this.endAt=o,this.Te=null}}function YT(n,e=null,t=[],r=[],i=null,s=null,a=null){return new Ree(n,e,t,r,i,s,a)}function xd(n){const e=nn(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>qT(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(s){return s.field.canonicalString()+s.dir})(r))).join(","),qw(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>z0(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>z0(r))).join(",")),e.Te=t}return e.Te}function j1(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!_ee(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!H6(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!uL(n.startAt,e.startAt)&&uL(n.endAt,e.endAt)}function pv(n){return ft.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function yv(n,e){return n.filters.filter((t=>t instanceof vn&&t.field.isEqual(e)))}function hL(n,e,t){let r=f_,i=!0;for(const s of yv(n,e)){let a=f_,o=!0;switch(s.op){case"<":case"<=":a=yee(s.value);break;case"==":case"in":case">=":a=s.value;break;case">":a=s.value,o=!1;break;case"!=":case"not-in":a=f_}oL({value:r,inclusive:i},{value:a,inclusive:o})<0&&(r=a,i=o)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const a=t.position[s];oL({value:r,inclusive:i},{value:a,inclusive:t.inclusive})<0&&(r=a,i=t.inclusive);break}}return{value:r,inclusive:i}}function dL(n,e,t){let r=pu,i=!0;for(const s of yv(n,e)){let a=pu,o=!0;switch(s.op){case">=":case">":a=xee(s.value),o=!1;break;case"==":case"in":case"<=":a=s.value;break;case"<":a=s.value,o=!1;break;case"!=":case"not-in":a=pu}lL({value:r,inclusive:i},{value:a,inclusive:o})>0&&(r=a,i=o)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const a=t.position[s];lL({value:r,inclusive:i},{value:a,inclusive:t.inclusive})>0&&(r=a,i=t.inclusive);break}}return{value:r,inclusive:i}}class F1{constructor(e,t=null,r=[],i=[],s=null,a="F",o=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=a,this.startAt=o,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function Aee(n,e,t,r,i,s,a,o){return new F1(n,e,t,r,i,s,a,o)}function tE(n){return new F1(n)}function fL(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Z6(n){return n.collectionGroup!==null}function Xm(n){const e=nn(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),t.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new tr(Pr.comparator);return a.filters.forEach((l=>{l.getFlattenedFilters().forEach((c=>{c.isInequality()&&(o=o.add(c.field))}))})),o})(e).forEach((s=>{t.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new mv(s,r))})),t.has(Pr.keyField().canonicalString())||e.Ie.push(new mv(Pr.keyField(),r))}return e.Ie}function Fa(n){const e=nn(n);return e.Ee||(e.Ee=kee(e,Xm(n))),e.Ee}function kee(n,e){if(n.limitType==="F")return YT(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((i=>{const s=i.dir==="desc"?"asc":"desc";return new mv(i.field,s)}));const t=n.endAt?new U0(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new U0(n.startAt.position,n.startAt.inclusive):null;return YT(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function ZT(n,e){const t=n.filters.concat([e]);return new F1(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function JT(n,e,t){return new F1(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function nE(n,e){return j1(Fa(n),Fa(e))&&n.limitType===e.limitType}function J6(n){return`${xd(Fa(n))}|lt:${n.limitType}`}function Kf(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((i=>X6(i))).join(", ")}]`),qw(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((i=>(function(a){return`${a.field.canonicalString()} (${a.dir})`})(i))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((i=>z0(i))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((i=>z0(i))).join(",")),`Target(${r})`})(Fa(n))}; limitType=${n.limitType})`}function V1(n,e){return e.isFoundDocument()&&(function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):ft.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)})(n,e)&&(function(r,i){for(const s of Xm(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0})(n,e)&&(function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0})(n,e)&&(function(r,i){return!(r.startAt&&!(function(a,o,l){const c=cL(a,o,l);return a.inclusive?c<=0:c<0})(r.startAt,Xm(r),i)||r.endAt&&!(function(a,o,l){const c=cL(a,o,l);return a.inclusive?c>=0:c>0})(r.endAt,Xm(r),i))})(n,e)}function Iee(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Q6(n){return(e,t)=>{let r=!1;for(const i of Xm(n)){const s=Cee(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function Cee(n,e,t){const r=n.field.isKeyField()?ft.comparator(e.key,t.key):(function(s,a,o){const l=a.data.field(s),c=o.data.field(s);return l!==null&&c!==null?Du(l,c):Ct(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Ct(19790,{direction:n.dir})}}class yc{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Xu(this.inner,((t,r)=>{for(const[i,s]of r)e(i,s)}))}isEmpty(){return L6(this.inner)}size(){return this.innerSize}}const Pee=new Er(ft.comparator);function ha(){return Pee}const e8=new Er(ft.comparator);function Am(...n){let e=e8;for(const t of n)e=e.insert(t.key,t);return e}function t8(n){let e=e8;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function tl(){return qm()}function n8(){return qm()}function qm(){return new yc((n=>n.toString()),((n,e)=>n.isEqual(e)))}const Nee=new Er(ft.comparator),Mee=new tr(ft.comparator);function fn(...n){let e=Mee;for(const t of n)e=e.add(t);return e}const Lee=new tr(tn);function Oee(){return Lee}function vk(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Fp(e)?"-0":e}}function r8(n){return{integerValue:""+n}}function Dee(n,e){return zQ(e)?r8(e):vk(n,e)}class rE{constructor(){this._=void 0}}function jee(n,e,t){return n instanceof W0?(function(i,s){const a={fields:{[j6]:{stringValue:D6},[V6]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&pk(s)&&(s=Qw(s)),s&&(a.fields[F6]=s),{mapValue:a}})(t,e):n instanceof H0?s8(n,e):n instanceof K0?a8(n,e):(function(i,s){const a=i8(i,s),o=gL(a)+gL(i.Ae);return KT(a)&&KT(i.Ae)?r8(o):vk(i.serializer,o)})(n,e)}function Fee(n,e,t){return n instanceof H0?s8(n,e):n instanceof K0?a8(n,e):t}function i8(n,e){return n instanceof Hp?(function(r){return KT(r)||(function(s){return!!s&&"doubleValue"in s})(r)})(e)?e:{integerValue:0}:null}class W0 extends rE{}class H0 extends rE{constructor(e){super(),this.elements=e}}function s8(n,e){const t=o8(e);for(const r of n.elements)t.some((i=>dl(i,r)))||t.push(r);return{arrayValue:{values:t}}}class K0 extends rE{constructor(e){super(),this.elements=e}}function a8(n,e){let t=o8(e);for(const r of n.elements)t=t.filter((i=>!dl(i,r)));return{arrayValue:{values:t}}}class Hp extends rE{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function gL(n){return _r(n.integerValue||n.doubleValue)}function o8(n){return Wp(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class l8{constructor(e,t){this.field=e,this.transform=t}}function Vee(n,e){return n.field.isEqual(e.field)&&(function(r,i){return r instanceof H0&&i instanceof H0||r instanceof K0&&i instanceof K0?D0(r.elements,i.elements,dl):r instanceof Hp&&i instanceof Hp?dl(r.Ae,i.Ae):r instanceof W0&&i instanceof W0})(n.transform,e.transform)}class Bee{constructor(e,t){this.version=e,this.transformResults=t}}class us{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new us}static exists(e){return new us(void 0,e)}static updateTime(e){return new us(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function p_(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class iE{}function c8(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new sE(n.key,us.none()):new hg(n.key,n.data,us.none());{const t=n.data,r=cs.empty();let i=new tr(Pr.comparator);for(let s of e.fields)if(!i.has(s)){let a=t.field(s);a===null&&s.length>1&&(s=s.popLast(),a=t.field(s)),a===null?r.delete(s):r.set(s,a),i=i.add(s)}return new xc(n.key,r,new Vs(i.toArray()),us.none())}}function Gee(n,e,t){n instanceof hg?(function(i,s,a){const o=i.value.clone(),l=pL(i.fieldTransforms,s,a.transformResults);o.setAll(l),s.convertToFoundDocument(a.version,o).setHasCommittedMutations()})(n,e,t):n instanceof xc?(function(i,s,a){if(!p_(i.precondition,s))return void s.convertToUnknownDocument(a.version);const o=pL(i.fieldTransforms,s,a.transformResults),l=s.data;l.setAll(u8(i)),l.setAll(o),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()})(n,e,t):(function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()})(0,e,t)}function Ym(n,e,t,r){return n instanceof hg?(function(s,a,o,l){if(!p_(s.precondition,a))return o;const c=s.value.clone(),h=yL(s.fieldTransforms,l,a);return c.setAll(h),a.convertToFoundDocument(a.version,c).setHasLocalMutations(),null})(n,e,t,r):n instanceof xc?(function(s,a,o,l){if(!p_(s.precondition,a))return o;const c=yL(s.fieldTransforms,l,a),h=a.data;return h.setAll(u8(s)),h.setAll(c),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map((g=>g.field)))})(n,e,t,r):(function(s,a,o){return p_(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o})(n,e,t)}function zee(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),s=i8(r.transform,i||null);s!=null&&(t===null&&(t=cs.empty()),t.set(r.field,s))}return t||null}function mL(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&D0(r,i,((s,a)=>Vee(s,a)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class hg extends iE{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class xc extends iE{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function u8(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}})),e}function pL(n,e,t){const r=new Map;Ot(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let i=0;i<t.length;i++){const s=n[i],a=s.transform,o=e.data.field(s.field);r.set(s.field,Fee(a,o,t[i]))}return r}function yL(n,e,t){const r=new Map;for(const i of n){const s=i.transform,a=t.data.field(i.field);r.set(i.field,jee(s,a,e))}return r}class sE extends iE{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class h8 extends iE{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class wk{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&Gee(s,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Ym(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Ym(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=n8();return this.mutations.forEach((i=>{const s=e.get(i.key),a=s.overlayedDocument;let o=this.applyToLocalView(a,s.mutatedFields);o=t.has(i.key)?null:o;const l=c8(a,o);l!==null&&r.set(i.key,l),a.isValidDocument()||a.convertToNoDocument(Ft.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),fn())}isEqual(e){return this.batchId===e.batchId&&D0(this.mutations,e.mutations,((t,r)=>mL(t,r)))&&D0(this.baseMutations,e.baseMutations,((t,r)=>mL(t,r)))}}class Ek{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){Ot(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=(function(){return Nee})();const s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,r[a].version);return new Ek(e,t,r,i)}}class Sk{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class Uee{constructor(e,t){this.count=e,this.unchangedNames=t}}var Jr,Sn;function $ee(n){switch(n){case De.OK:return Ct(64938);case De.CANCELLED:case De.UNKNOWN:case De.DEADLINE_EXCEEDED:case De.RESOURCE_EXHAUSTED:case De.INTERNAL:case De.UNAVAILABLE:case De.UNAUTHENTICATED:return!1;case De.INVALID_ARGUMENT:case De.NOT_FOUND:case De.ALREADY_EXISTS:case De.PERMISSION_DENIED:case De.FAILED_PRECONDITION:case De.ABORTED:case De.OUT_OF_RANGE:case De.UNIMPLEMENTED:case De.DATA_LOSS:return!0;default:return Ct(15467,{code:n})}}function d8(n){if(n===void 0)return ws("GRPC error has no .code"),De.UNKNOWN;switch(n){case Jr.OK:return De.OK;case Jr.CANCELLED:return De.CANCELLED;case Jr.UNKNOWN:return De.UNKNOWN;case Jr.DEADLINE_EXCEEDED:return De.DEADLINE_EXCEEDED;case Jr.RESOURCE_EXHAUSTED:return De.RESOURCE_EXHAUSTED;case Jr.INTERNAL:return De.INTERNAL;case Jr.UNAVAILABLE:return De.UNAVAILABLE;case Jr.UNAUTHENTICATED:return De.UNAUTHENTICATED;case Jr.INVALID_ARGUMENT:return De.INVALID_ARGUMENT;case Jr.NOT_FOUND:return De.NOT_FOUND;case Jr.ALREADY_EXISTS:return De.ALREADY_EXISTS;case Jr.PERMISSION_DENIED:return De.PERMISSION_DENIED;case Jr.FAILED_PRECONDITION:return De.FAILED_PRECONDITION;case Jr.ABORTED:return De.ABORTED;case Jr.OUT_OF_RANGE:return De.OUT_OF_RANGE;case Jr.UNIMPLEMENTED:return De.UNIMPLEMENTED;case Jr.DATA_LOSS:return De.DATA_LOSS;default:return Ct(39323,{code:n})}}(Sn=Jr||(Jr={}))[Sn.OK=0]="OK",Sn[Sn.CANCELLED=1]="CANCELLED",Sn[Sn.UNKNOWN=2]="UNKNOWN",Sn[Sn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Sn[Sn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Sn[Sn.NOT_FOUND=5]="NOT_FOUND",Sn[Sn.ALREADY_EXISTS=6]="ALREADY_EXISTS",Sn[Sn.PERMISSION_DENIED=7]="PERMISSION_DENIED",Sn[Sn.UNAUTHENTICATED=16]="UNAUTHENTICATED",Sn[Sn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Sn[Sn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Sn[Sn.ABORTED=10]="ABORTED",Sn[Sn.OUT_OF_RANGE=11]="OUT_OF_RANGE",Sn[Sn.UNIMPLEMENTED=12]="UNIMPLEMENTED",Sn[Sn.INTERNAL=13]="INTERNAL",Sn[Sn.UNAVAILABLE=14]="UNAVAILABLE",Sn[Sn.DATA_LOSS=15]="DATA_LOSS";function Wee(){return new TextEncoder}const Hee=new Au([4294967295,4294967295],0);function xL(n){const e=Wee().encode(n),t=new c6;return t.update(e),new Uint8Array(t.digest())}function _L(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Au([t,r],0),new Au([i,s],0)]}class bk{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new km(`Invalid padding: ${t}`);if(r<0)throw new km(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new km(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new km(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Au.fromNumber(this.ge)}ye(e,t,r){let i=e.add(t.multiply(Au.fromNumber(r)));return i.compare(Hee)===1&&(i=new Au([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=xL(e),[r,i]=_L(t);for(let s=0;s<this.hashCount;s++){const a=this.ye(r,i,s);if(!this.we(a))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new bk(s,i,t);return r.forEach((o=>a.insert(o))),a}insert(e){if(this.ge===0)return;const t=xL(e),[r,i]=_L(t);for(let s=0;s<this.hashCount;s++){const a=this.ye(r,i,s);this.Se(a)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class km extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class aE{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,B1.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new aE(Ft.min(),i,new Er(tn),ha(),fn())}}class B1{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new B1(r,t,fn(),fn(),fn())}}class y_{constructor(e,t,r,i){this.be=e,this.removedTargetIds=t,this.key=r,this.De=i}}class f8{constructor(e,t){this.targetId=e,this.Ce=t}}class g8{constructor(e,t,r=si.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class vL{constructor(){this.ve=0,this.Fe=wL(),this.Me=si.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=fn(),t=fn(),r=fn();return this.Fe.forEach(((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:Ct(38017,{changeType:s})}})),new B1(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=wL()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Ot(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class Kee{constructor(e){this.Ge=e,this.ze=new Map,this.je=ha(),this.Je=Ix(),this.He=Ix(),this.Ye=new Er(tn)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:Ct(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((r,i)=>{this.rt(i)&&t(i)}))}st(e){const t=e.targetId,r=e.Ce.count,i=this.ot(t);if(i){const s=i.target;if(pv(s))if(r===0){const a=new ft(s.path);this.et(t,a,Br.newNoDocument(a,Ft.min()))}else Ot(r===1,20013,{expectedCount:r});else{const a=this._t(t);if(a!==r){const o=this.ut(e),l=o?this.ct(o,e,a):1;if(l!==0){this.it(t);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,c)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t;let a,o;try{a=lc(r).toUint8Array()}catch(l){if(l instanceof O6)return pd("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new bk(a,i,s)}catch(l){return pd(l instanceof km?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.ge===0?null:o}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let i=0;return r.forEach((s=>{const a=this.Ge.ht(),o=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(o)||(this.et(t,s,null),i++)})),i}Tt(e){const t=new Map;this.ze.forEach(((s,a)=>{const o=this.ot(a);if(o){if(s.current&&pv(o.target)){const l=new ft(o.target.path);this.It(l).has(a)||this.Et(a,l)||this.et(a,l,Br.newNoDocument(l,e))}s.Be&&(t.set(a,s.ke()),s.qe())}}));let r=fn();this.He.forEach(((s,a)=>{let o=!0;a.forEachWhile((l=>{const c=this.ot(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)})),o&&(r=r.add(s))})),this.je.forEach(((s,a)=>a.setReadTime(e)));const i=new aE(e,t,this.Ye,this.je,r);return this.je=ha(),this.Je=Ix(),this.He=Ix(),this.Ye=new Er(tn),i}Xe(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,t)?i.Qe(t,1):i.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new vL,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new tr(tn),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new tr(tn),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||nt("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new vL),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Ix(){return new Er(ft.comparator)}function wL(){return new Er(ft.comparator)}const Xee={asc:"ASCENDING",desc:"DESCENDING"},qee={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Yee={and:"AND",or:"OR"};class Zee{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function QT(n,e){return n.useProto3Json||qw(e)?e:{value:e}}function X0(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function m8(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function Jee(n,e){return X0(n,e.toTimestamp())}function bs(n){return Ot(!!n,49232),Ft.fromTimestamp((function(t){const r=oc(t);return new Zn(r.seconds,r.nanos)})(n))}function Tk(n,e){return eR(n,e).canonicalString()}function eR(n,e){const t=(function(i){return new Bn(["projects",i.projectId,"databases",i.database])})(n).child("documents");return e===void 0?t:t.child(e)}function p8(n){const e=Bn.fromString(n);return Ot(T8(e),10190,{key:e.toString()}),e}function xv(n,e){return Tk(n.databaseId,e.path)}function ed(n,e){const t=p8(e);if(t.get(1)!==n.databaseId.projectId)throw new ht(De.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new ht(De.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new ft(_8(t))}function y8(n,e){return Tk(n.databaseId,e)}function x8(n){const e=p8(n);return e.length===4?Bn.emptyPath():_8(e)}function tR(n){return new Bn(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function _8(n){return Ot(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function EL(n,e,t){return{name:xv(n,e),fields:t.value.mapValue.fields}}function Qee(n,e,t){const r=ed(n,e.name),i=bs(e.updateTime),s=e.createTime?bs(e.createTime):Ft.min(),a=new cs({mapValue:{fields:e.fields}}),o=Br.newFoundDocument(r,i,s,a);return t&&o.setHasCommittedMutations(),t?o.setHasCommittedMutations():o}function ete(n,e){let t;if("targetChange"in e){e.targetChange;const r=(function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:Ct(39313,{state:c})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=(function(c,h){return c.useProto3Json?(Ot(h===void 0||typeof h=="string",58123),si.fromBase64String(h||"")):(Ot(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),si.fromUint8Array(h||new Uint8Array))})(n,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&(function(c){const h=c.code===void 0?De.UNKNOWN:d8(c.code);return new ht(h,c.message||"")})(a);t=new g8(r,i,s,o||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=ed(n,r.document.name),s=bs(r.document.updateTime),a=r.document.createTime?bs(r.document.createTime):Ft.min(),o=new cs({mapValue:{fields:r.document.fields}}),l=Br.newFoundDocument(i,s,a,o),c=r.targetIds||[],h=r.removedTargetIds||[];t=new y_(c,h,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=ed(n,r.document),s=r.readTime?bs(r.readTime):Ft.min(),a=Br.newNoDocument(i,s),o=r.removedTargetIds||[];t=new y_([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=ed(n,r.document),s=r.removedTargetIds||[];t=new y_([],s,i,null)}else{if(!("filter"in e))return Ct(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,a=new Uee(i,s),o=r.targetId;t=new f8(o,a)}}return t}function _v(n,e){let t;if(e instanceof hg)t={update:EL(n,e.key,e.value)};else if(e instanceof sE)t={delete:xv(n,e.key)};else if(e instanceof xc)t={update:EL(n,e.key,e.data),updateMask:ate(e.fieldMask)};else{if(!(e instanceof h8))return Ct(16599,{Vt:e.type});t={verify:xv(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(s,a){const o=a.transform;if(o instanceof W0)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof H0)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof K0)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof Hp)return{fieldPath:a.field.canonicalString(),increment:o.Ae};throw Ct(20930,{transform:a.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(i,s){return s.updateTime!==void 0?{updateTime:Jee(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Ct(27497)})(n,e.precondition)),t}function nR(n,e){const t=e.currentDocument?(function(s){return s.updateTime!==void 0?us.updateTime(bs(s.updateTime)):s.exists!==void 0?us.exists(s.exists):us.none()})(e.currentDocument):us.none(),r=e.updateTransforms?e.updateTransforms.map((i=>(function(a,o){let l=null;if("setToServerValue"in o)Ot(o.setToServerValue==="REQUEST_TIME",16630,{proto:o}),l=new W0;else if("appendMissingElements"in o){const h=o.appendMissingElements.values||[];l=new H0(h)}else if("removeAllFromArray"in o){const h=o.removeAllFromArray.values||[];l=new K0(h)}else"increment"in o?l=new Hp(a,o.increment):Ct(16584,{proto:o});const c=Pr.fromServerFormat(o.fieldPath);return new l8(c,l)})(n,i))):[];if(e.update){e.update.name;const i=ed(n,e.update.name),s=new cs({mapValue:{fields:e.update.fields}});if(e.updateMask){const a=(function(l){const c=l.fieldPaths||[];return new Vs(c.map((h=>Pr.fromServerFormat(h))))})(e.updateMask);return new xc(i,s,a,t,r)}return new hg(i,s,t,r)}if(e.delete){const i=ed(n,e.delete);return new sE(i,t)}if(e.verify){const i=ed(n,e.verify);return new h8(i,t)}return Ct(1463,{proto:e})}function tte(n,e){return n&&n.length>0?(Ot(e!==void 0,14353),n.map((t=>(function(i,s){let a=i.updateTime?bs(i.updateTime):bs(s);return a.isEqual(Ft.min())&&(a=bs(s)),new Bee(a,i.transformResults||[])})(t,e)))):[]}function v8(n,e){return{documents:[y8(n,e.path)]}}function w8(n,e){const t={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=y8(n,i);const s=(function(c){if(c.length!==0)return b8(Qn.create(c,"and"))})(e.filters);s&&(t.structuredQuery.where=s);const a=(function(c){if(c.length!==0)return c.map((h=>(function(m){return{field:Xf(m.field),direction:rte(m.dir)}})(h)))})(e.orderBy);a&&(t.structuredQuery.orderBy=a);const o=QT(n,e.limit);return o!==null&&(t.structuredQuery.limit=o),e.startAt&&(t.structuredQuery.startAt=(function(c){return{before:c.inclusive,values:c.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(c){return{before:!c.inclusive,values:c.position}})(e.endAt)),{ft:t,parent:i}}function E8(n){let e=x8(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){Ot(r===1,65062);const h=t.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let s=[];t.where&&(s=(function(g){const m=S8(g);return m instanceof Qn&&_k(m)?m.getFilters():[m]})(t.where));let a=[];t.orderBy&&(a=(function(g){return g.map((m=>(function(_){return new mv(qf(_.field),(function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(_.direction))})(m)))})(t.orderBy));let o=null;t.limit&&(o=(function(g){let m;return m=typeof g=="object"?g.value:g,qw(m)?null:m})(t.limit));let l=null;t.startAt&&(l=(function(g){const m=!!g.before,y=g.values||[];return new U0(y,m)})(t.startAt));let c=null;return t.endAt&&(c=(function(g){const m=!g.before,y=g.values||[];return new U0(y,m)})(t.endAt)),Aee(e,i,a,s,o,"F",l,c)}function nte(n,e){const t=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ct(28987,{purpose:i})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function S8(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=qf(t.unaryFilter.field);return vn.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=qf(t.unaryFilter.field);return vn.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=qf(t.unaryFilter.field);return vn.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=qf(t.unaryFilter.field);return vn.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ct(61313);default:return Ct(60726)}})(n):n.fieldFilter!==void 0?(function(t){return vn.create(qf(t.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ct(58110);default:return Ct(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Qn.create(t.compositeFilter.filters.map((r=>S8(r))),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Ct(1026)}})(t.compositeFilter.op))})(n):Ct(30097,{filter:n})}function rte(n){return Xee[n]}function ite(n){return qee[n]}function ste(n){return Yee[n]}function Xf(n){return{fieldPath:n.canonicalString()}}function qf(n){return Pr.fromServerFormat(n.fieldPath)}function b8(n){return n instanceof vn?(function(t){if(t.op==="=="){if(aL(t.value))return{unaryFilter:{field:Xf(t.field),op:"IS_NAN"}};if(sL(t.value))return{unaryFilter:{field:Xf(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(aL(t.value))return{unaryFilter:{field:Xf(t.field),op:"IS_NOT_NAN"}};if(sL(t.value))return{unaryFilter:{field:Xf(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Xf(t.field),op:ite(t.op),value:t.value}}})(n):n instanceof Qn?(function(t){const r=t.getFilters().map((i=>b8(i)));return r.length===1?r[0]:{compositeFilter:{op:ste(t.op),filters:r}}})(n):Ct(54877,{filter:n})}function ate(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function T8(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class $l{constructor(e,t,r,i,s=Ft.min(),a=Ft.min(),o=si.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(e){return new $l(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new $l(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new $l(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new $l(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class R8{constructor(e){this.yt=e}}function ote(n,e){let t;if(e.document)t=Qee(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=ft.fromSegments(e.noDocument.path),i=vd(e.noDocument.readTime);t=Br.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Ct(56709);{const r=ft.fromSegments(e.unknownDocument.path),i=vd(e.unknownDocument.version);t=Br.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime((function(i){const s=new Zn(i[0],i[1]);return Ft.fromTimestamp(s)})(e.readTime)),t}function SL(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:vv(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=(function(s,a){return{name:xv(s,a.key),fields:a.data.value.mapValue.fields,updateTime:X0(s,a.version.toTimestamp()),createTime:X0(s,a.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:_d(e.version)};else{if(!e.isUnknownDocument())return Ct(57904,{document:e});r.unknownDocument={path:t.path.toArray(),version:_d(e.version)}}return r}function vv(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function _d(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function vd(n){const e=new Zn(n.seconds,n.nanoseconds);return Ft.fromTimestamp(e)}function Dh(n,e){const t=(e.baseMutations||[]).map((s=>nR(n.yt,s)));for(let s=0;s<e.mutations.length-1;++s){const a=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const o=e.mutations[s+1];a.updateTransforms=o.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map((s=>nR(n.yt,s))),i=Zn.fromMillis(e.localWriteTimeMs);return new wk(e.batchId,i,t,r)}function Im(n){const e=vd(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?vd(n.lastLimboFreeSnapshotVersion):Ft.min();let r;return r=(function(s){return s.documents!==void 0})(n.query)?(function(s){const a=s.documents.length;return Ot(a===1,1966,{count:a}),Fa(tE(x8(s.documents[0])))})(n.query):(function(s){return Fa(E8(s))})(n.query),new $l(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,si.fromBase64String(n.resumeToken))}function A8(n,e){const t=_d(e.snapshotVersion),r=_d(e.lastLimboFreeSnapshotVersion);let i;i=pv(e.target)?v8(n.yt,e.target):w8(n.yt,e.target).ft;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:xd(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function k8(n){const e=E8({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?JT(e,e.limit,"L"):e}function cb(n,e){return new Sk(e.largestBatchId,nR(n.yt,e.overlayMutation))}function bL(n,e){const t=e.path.lastSegment();return[n,ds(e.path.popLast()),t]}function TL(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:_d(r.readTime),documentKey:ds(r.documentKey.path),largestBatchId:r.largestBatchId}}class lte{getBundleMetadata(e,t){return RL(e).get(t).next((r=>{if(r)return(function(s){return{id:s.bundleId,createTime:vd(s.createTime),version:s.version}})(r)}))}saveBundleMetadata(e,t){return RL(e).put((function(i){return{bundleId:i.id,createTime:_d(bs(i.createTime)),version:i.version}})(t))}getNamedQuery(e,t){return AL(e).get(t).next((r=>{if(r)return(function(s){return{name:s.name,query:k8(s.bundledQuery),readTime:vd(s.readTime)}})(r)}))}saveNamedQuery(e,t){return AL(e).put((function(i){return{name:i.name,readTime:_d(bs(i.readTime)),bundledQuery:i.bundledQuery}})(t))}}function RL(n){return yi(n,Yw)}function AL(n){return yi(n,Zw)}class oE{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const r=t.uid||"";return new oE(e,r)}getOverlay(e,t){return gm(e).get(bL(this.userId,t)).next((r=>r?cb(this.serializer,r):null))}getOverlays(e,t){const r=tl();return de.forEach(t,(i=>this.getOverlay(e,i).next((s=>{s!==null&&r.set(i,s)})))).next((()=>r))}saveOverlays(e,t,r){const i=[];return r.forEach(((s,a)=>{const o=new Sk(t,a);i.push(this.St(e,o))})),de.waitFor(i)}removeOverlaysForBatchId(e,t,r){const i=new Set;t.forEach((a=>i.add(ds(a.getCollectionPath()))));const s=[];return i.forEach((a=>{const o=IDBKeyRange.bound([this.userId,a,r],[this.userId,a,r+1],!1,!0);s.push(gm(e).Z($T,o))})),de.waitFor(s)}getOverlaysForCollection(e,t,r){const i=tl(),s=ds(t),a=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return gm(e).J($T,a).next((o=>{for(const l of o){const c=cb(this.serializer,l);i.set(c.getKey(),c)}return i}))}getOverlaysForCollectionGroup(e,t,r,i){const s=tl();let a;const o=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return gm(e).ee({index:I6,range:o},((l,c,h)=>{const g=cb(this.serializer,c);s.size()<i||g.largestBatchId===a?(s.set(g.getKey(),g),a=g.largestBatchId):h.done()})).next((()=>s))}St(e,t){return gm(e).put((function(i,s,a){const[o,l,c]=bL(s,a.mutation.key);return{userId:s,collectionPath:l,documentId:c,collectionGroup:a.mutation.key.getCollectionGroup(),largestBatchId:a.largestBatchId,overlayMutation:_v(i.yt,a.mutation)}})(this.serializer,this.userId,t))}}function gm(n){return yi(n,Jw)}class cte{bt(e){return yi(e,gk)}getSessionToken(e){return this.bt(e).get("sessionToken").next((t=>{const r=t?.value;return r?si.fromUint8Array(r):si.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}class jh{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(_r(e.integerValue));else if("doubleValue"in e){const r=_r(e.doubleValue);isNaN(r)?this.Ft(t,13):(this.Ft(t,15),Fp(r)?t.Mt(0):t.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(t,20),typeof r=="string"&&(r=oc(r)),t.xt(`${r.seconds||""}`),t.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(lc(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(t,45),t.Mt(r.latitude||0),t.Mt(r.longitude||0)}else"mapValue"in e?G6(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):eE(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):Ct(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const r=e.fields||{};this.Ft(t,55);for(const i of Object.keys(r))this.Ot(i,t),this.Ct(r[i],t)}kt(e,t){const r=e.fields||{};this.Ft(t,53);const i=G0,s=r[i].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(_r(s)),this.Ot(i,t),this.Ct(r[i],t)}Qt(e,t){const r=e.values||[];this.Ft(t,50);for(const i of r)this.Ct(i,t)}Lt(e,t){this.Ft(t,37),ft.fromName(e).path.forEach((r=>{this.Ft(t,60),this.Ut(r,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}jh.Kt=new jh;const Of=255;function ute(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function kL(n){const e=64-(function(r){let i=0;for(let s=0;s<8;++s){const a=ute(255&r[s]);if(i+=a,a!==8)break}return i})(n);return Math.ceil(e/8)}class hte{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Gt(r.value),r=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Jt(r.value),r=t.next();this.Ht()}Yt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const i=t.codePointAt(0);this.Gt(240|i>>>18),this.Gt(128|63&i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i)}}this.zt()}Zt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const i=t.codePointAt(0);this.Jt(240|i>>>18),this.Jt(128|63&i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i)}}this.Ht()}Xt(e){const t=this.en(e),r=kL(t);this.tn(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}nn(e){const t=this.en(e),r=kL(t);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}rn(){this.sn(Of),this.sn(255)}_n(){this.an(Of),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(s){const a=new DataView(new ArrayBuffer(8));return a.setFloat64(0,s,!1),new Uint8Array(a.buffer)})(e),r=!!(128&t[0]);t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===Of?(this.sn(Of),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===Of?(this.an(Of),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class dte{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class fte{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class mm{constructor(){this.cn=new hte,this.ln=new dte(this.cn),this.hn=new fte(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}class Fh{constructor(e,t,r,i){this.Tn=e,this.In=t,this.En=r,this.dn=i}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.dn,0),t!==e?r.set([0],this.dn.length):++r[r.length-1],new Fh(this.Tn,this.In,this.En,r)}Rn(e,t,r){return{indexId:this.Tn,uid:e,arrayValue:x_(this.En),directionalValue:x_(this.dn),orderedDocumentKey:x_(t),documentKey:r.path.toArray()}}Vn(e,t,r){const i=this.Rn(e,t,r);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}}function Yc(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=IL(n.En,e.En),t!==0?t:(t=IL(n.dn,e.dn),t!==0?t:ft.comparator(n.In,e.In)))}function IL(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}function x_(n){return SF()?(function(t){let r="";for(let i=0;i<t.length;i++)r+=String.fromCharCode(t[i]);return r})(n):n}function CL(n){return typeof n!="string"?n:(function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(n)}class PL{constructor(e){this.mn=new tr(((t,r)=>Pr.comparator(t.field,r.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const r=t;r.isInequality()?this.mn=this.mn.add(r):this.gn.push(r)}}get pn(){return this.mn.size>1}yn(e){if(Ot(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=GT(e);if(t!==void 0&&!this.wn(t))return!1;const r=kh(e);let i=new Set,s=0,a=0;for(;s<r.length&&this.wn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.mn.size>0){const o=this.mn.getIterator().getNext();if(!i.has(o.field.canonicalString())){const l=r[s];if(!this.Sn(o,l)||!this.bn(this.fn[a++],l))return!1}++s}for(;s<r.length;++s){const o=r[s];if(a>=this.fn.length||!this.bn(this.fn[a++],o))return!1}return!0}Dn(){if(this.pn)return null;let e=new tr(Pr.comparator);const t=[];for(const r of this.gn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new u_(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new u_(r.field,0))}for(const r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new u_(r.field,r.dir==="asc"?0:1)));return new uv(uv.UNKNOWN_ID,this.collectionId,t,jp.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function I8(n){if(Ot(n instanceof vn||n instanceof Qn,20012),n instanceof vn){if(n instanceof Y6){const t=n.value.arrayValue?.values?.map((r=>vn.create(n.field,"==",r)))||[];return Qn.create(t,"or")}return n}const e=n.filters.map((t=>I8(t)));return Qn.create(e,n.op)}function gte(n){if(n.getFilters().length===0)return[];const e=sR(I8(n));return Ot(C8(e),7391),rR(e)||iR(e)?[e]:e.getFilters()}function rR(n){return n instanceof vn}function iR(n){return n instanceof Qn&&_k(n)}function C8(n){return rR(n)||iR(n)||(function(t){if(t instanceof Qn&&XT(t)){for(const r of t.getFilters())if(!rR(r)&&!iR(r))return!1;return!0}return!1})(n)}function sR(n){if(Ot(n instanceof vn||n instanceof Qn,34018),n instanceof vn)return n;if(n.filters.length===1)return sR(n.filters[0]);const e=n.filters.map((r=>sR(r)));let t=Qn.create(e,n.op);return t=wv(t),C8(t)?t:(Ot(t instanceof Qn,64498),Ot($0(t),40251),Ot(t.filters.length>1,57927),t.filters.reduce(((r,i)=>Rk(r,i))))}function Rk(n,e){let t;return Ot(n instanceof vn||n instanceof Qn,38388),Ot(e instanceof vn||e instanceof Qn,25473),t=n instanceof vn?e instanceof vn?(function(i,s){return Qn.create([i,s],"and")})(n,e):NL(n,e):e instanceof vn?NL(e,n):(function(i,s){if(Ot(i.filters.length>0&&s.filters.length>0,48005),$0(i)&&$0(s))return K6(i,s.getFilters());const a=XT(i)?i:s,o=XT(i)?s:i,l=a.filters.map((c=>Rk(c,o)));return Qn.create(l,"or")})(n,e),wv(t)}function NL(n,e){if($0(e))return K6(e,n.getFilters());{const t=e.filters.map((r=>Rk(n,r)));return Qn.create(t,"or")}}function wv(n){if(Ot(n instanceof vn||n instanceof Qn,11850),n instanceof vn)return n;const e=n.getFilters();if(e.length===1)return wv(e[0]);if(W6(n))return n;const t=e.map((i=>wv(i))),r=[];return t.forEach((i=>{i instanceof vn?r.push(i):i instanceof Qn&&(i.op===n.op?r.push(...i.filters):r.push(i))})),r.length===1?r[0]:Qn.create(r,n.op)}class mte{constructor(){this.Cn=new Ak}addToCollectionParentIndex(e,t){return this.Cn.add(t),de.resolve()}getCollectionParents(e,t){return de.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return de.resolve()}deleteFieldIndex(e,t){return de.resolve()}deleteAllFieldIndexes(e){return de.resolve()}createTargetIndexes(e,t){return de.resolve()}getDocumentsMatchingTarget(e,t){return de.resolve(null)}getIndexType(e,t){return de.resolve(0)}getFieldIndexes(e,t){return de.resolve([])}getNextCollectionGroupToUpdate(e){return de.resolve(null)}getMinOffset(e,t){return de.resolve(ga.min())}getMinOffsetFromCollectionGroup(e,t){return de.resolve(ga.min())}updateCollectionGroup(e,t,r){return de.resolve()}updateIndexEntries(e,t){return de.resolve()}}class Ak{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new tr(Bn.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new tr(Bn.comparator)).toArray()}}const ML="IndexedDbIndexManager",Cx=new Uint8Array(0);class pte{constructor(e,t){this.databaseId=t,this.vn=new Ak,this.Fn=new yc((r=>xd(r)),((r,i)=>j1(r,i))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const s={collectionId:r,parent:ds(i)};return LL(e).put(s)}return de.resolve()}getCollectionParents(e,t){const r=[],i=IDBKeyRange.bound([t,""],[y6(t),""],!1,!0);return LL(e).J(i).next((s=>{for(const a of s){if(a.collectionId!==t)break;r.push(el(a.parent))}return r}))}addFieldIndex(e,t){const r=pm(e),i=(function(o){return{indexId:o.indexId,collectionGroup:o.collectionGroup,fields:o.fields.map((l=>[l.fieldPath.canonicalString(),l.kind]))}})(t);delete i.indexId;const s=r.add(i);if(t.indexState){const a=jf(e);return s.next((o=>{a.put(TL(o,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return s.next()}deleteFieldIndex(e,t){const r=pm(e),i=jf(e),s=Df(e);return r.delete(t.indexId).next((()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=pm(e),r=Df(e),i=jf(e);return t.Z().next((()=>r.Z())).next((()=>i.Z()))}createTargetIndexes(e,t){return de.forEach(this.Mn(t),(r=>this.getIndexType(e,r).next((i=>{if(i===0||i===1){const s=new PL(r).Dn();if(s!=null)return this.addFieldIndex(e,s)}}))))}getDocumentsMatchingTarget(e,t){const r=Df(e);let i=!0;const s=new Map;return de.forEach(this.Mn(t),(a=>this.xn(e,a).next((o=>{i&&(i=!!o),s.set(a,o)})))).next((()=>{if(i){let a=fn();const o=[];return de.forEach(s,((l,c)=>{nt(ML,`Using index ${(function(k){return`id=${k.indexId}|cg=${k.collectionGroup}|f=${k.fields.map((L=>`${L.fieldPath}:${L.kind}`)).join(",")}`})(l)} to execute ${xd(t)}`);const h=(function(k,L){const O=GT(L);if(O===void 0)return null;for(const B of yv(k,O.fieldPath))switch(B.op){case"array-contains-any":return B.value.arrayValue.values||[];case"array-contains":return[B.value]}return null})(c,l),g=(function(k,L){const O=new Map;for(const B of kh(L))for(const R of yv(k,B.fieldPath))switch(R.op){case"==":case"in":O.set(B.fieldPath.canonicalString(),R.value);break;case"not-in":case"!=":return O.set(B.fieldPath.canonicalString(),R.value),Array.from(O.values())}return null})(c,l),m=(function(k,L){const O=[];let B=!0;for(const R of kh(L)){const A=R.kind===0?hL(k,R.fieldPath,k.startAt):dL(k,R.fieldPath,k.startAt);O.push(A.value),B&&(B=A.inclusive)}return new U0(O,B)})(c,l),y=(function(k,L){const O=[];let B=!0;for(const R of kh(L)){const A=R.kind===0?dL(k,R.fieldPath,k.endAt):hL(k,R.fieldPath,k.endAt);O.push(A.value),B&&(B=A.inclusive)}return new U0(O,B)})(c,l),_=this.On(l,c,m),x=this.On(l,c,y),w=this.Nn(l,c,g),b=this.Bn(l.indexId,h,_,m.inclusive,x,y.inclusive,w);return de.forEach(b,(T=>r.Y(T,t.limit).next((k=>{k.forEach((L=>{const O=ft.fromSegments(L.documentKey);a.has(O)||(a=a.add(O),o.push(O))}))}))))})).next((()=>o))}return de.resolve(null)}))}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=gte(Qn.create(e.filters,"and")).map((r=>YT(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,t),t)}Bn(e,t,r,i,s,a,o){const l=(t!=null?t.length:1)*Math.max(r.length,s.length),c=l/(t!=null?t.length:1),h=[];for(let g=0;g<l;++g){const m=t?this.Ln(t[g/c]):Cx,y=this.kn(e,m,r[g%c],i),_=this.qn(e,m,s[g%c],a),x=o.map((w=>this.kn(e,m,w,!0)));h.push(...this.createRange(y,_,x))}return h}kn(e,t,r,i){const s=new Fh(e,ft.empty(),t,r);return i?s:s.An()}qn(e,t,r,i){const s=new Fh(e,ft.empty(),t,r);return i?s.An():s}xn(e,t){const r=new PL(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next((s=>{let a=null;for(const o of s)r.yn(o)&&(!a||o.fields.length>a.fields.length)&&(a=o);return a}))}getIndexType(e,t){let r=2;const i=this.Mn(t);return de.forEach(i,(s=>this.xn(e,s).next((a=>{a?r!==0&&a.fields.length<(function(l){let c=new tr(Pr.comparator),h=!1;for(const g of l.filters)for(const m of g.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?h=!0:c=c.add(m.field));for(const g of l.orderBy)g.field.isKeyField()||(c=c.add(g.field));return c.size+(h?1:0)})(s)&&(r=1):r=0})))).next((()=>(function(a){return a.limit!==null})(t)&&i.length>1&&r===2?1:r))}Qn(e,t){const r=new mm;for(const i of kh(e)){const s=t.data.field(i.fieldPath);if(s==null)return null;const a=r.Pn(i.kind);jh.Kt.Dt(s,a)}return r.un()}Ln(e){const t=new mm;return jh.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const r=new mm;return jh.Kt.Dt($p(this.databaseId,t),r.Pn((function(s){const a=kh(s);return a.length===0?0:a[a.length-1].kind})(e))),r.un()}Nn(e,t,r){if(r===null)return[];let i=[];i.push(new mm);let s=0;for(const a of kh(e)){const o=r[s++];for(const l of i)if(this.Un(t,a.fieldPath)&&Wp(o))i=this.Kn(i,a,o);else{const c=l.Pn(a.kind);jh.Kt.Dt(o,c)}}return this.Wn(i)}On(e,t,r){return this.Nn(e,t,r.position)}Wn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].un();return t}Kn(e,t,r){const i=[...e],s=[];for(const a of r.arrayValue.values||[])for(const o of i){const l=new mm;l.seed(o.un()),jh.Kt.Dt(a,l.Pn(t.kind)),s.push(l)}return s}Un(e,t){return!!e.filters.find((r=>r instanceof vn&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in")))}getFieldIndexes(e,t){const r=pm(e),i=jf(e);return(t?r.J(UT,IDBKeyRange.bound(t,t)):r.J()).next((s=>{const a=[];return de.forEach(s,(o=>i.get([o.indexId,this.uid]).next((l=>{a.push((function(h,g){const m=g?new jp(g.sequenceNumber,new ga(vd(g.readTime),new ft(el(g.documentKey)),g.largestBatchId)):jp.empty(),y=h.fields.map((([_,x])=>new u_(Pr.fromServerFormat(_),x)));return new uv(h.indexId,h.collectionGroup,y,m)})(o,l))})))).next((()=>a))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:tn(r.collectionGroup,i.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,r){const i=pm(e),s=jf(e);return this.Gn(e).next((a=>i.J(UT,IDBKeyRange.bound(t,t)).next((o=>de.forEach(o,(l=>s.put(TL(l.indexId,this.uid,a,r))))))))}updateIndexEntries(e,t){const r=new Map;return de.forEach(t,((i,s)=>{const a=r.get(i.collectionGroup);return(a?de.resolve(a):this.getFieldIndexes(e,i.collectionGroup)).next((o=>(r.set(i.collectionGroup,o),de.forEach(o,(l=>this.zn(e,i,l).next((c=>{const h=this.jn(s,l);return c.isEqual(h)?de.resolve():this.Jn(e,s,l,c,h)})))))))}))}Hn(e,t,r,i){return Df(e).put(i.Rn(this.uid,this.$n(r,t.key),t.key))}Yn(e,t,r,i){return Df(e).delete(i.Vn(this.uid,this.$n(r,t.key),t.key))}zn(e,t,r){const i=Df(e);let s=new tr(Yc);return i.ee({index:k6,range:IDBKeyRange.only([r.indexId,this.uid,x_(this.$n(r,t))])},((a,o)=>{s=s.add(new Fh(r.indexId,t,CL(o.arrayValue),CL(o.directionalValue)))})).next((()=>s))}jn(e,t){let r=new tr(Yc);const i=this.Qn(t,e);if(i==null)return r;const s=GT(t);if(s!=null){const a=e.data.field(s.fieldPath);if(Wp(a))for(const o of a.arrayValue.values||[])r=r.add(new Fh(t.indexId,e.key,this.Ln(o),i))}else r=r.add(new Fh(t.indexId,e.key,Cx,i));return r}Jn(e,t,r,i,s){nt(ML,"Updating index entries for document '%s'",t.key);const a=[];return(function(l,c,h,g,m){const y=l.getIterator(),_=c.getIterator();let x=Lf(y),w=Lf(_);for(;x||w;){let b=!1,T=!1;if(x&&w){const k=h(x,w);k<0?T=!0:k>0&&(b=!0)}else x!=null?T=!0:b=!0;b?(g(w),w=Lf(_)):T?(m(x),x=Lf(y)):(x=Lf(y),w=Lf(_))}})(i,s,Yc,(o=>{a.push(this.Hn(e,t,r,o))}),(o=>{a.push(this.Yn(e,t,r,o))})),de.waitFor(a)}Gn(e){let t=1;return jf(e).ee({index:A6,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((r,i,s)=>{s.done(),t=i.sequenceNumber+1})).next((()=>t))}createRange(e,t,r){r=r.sort(((a,o)=>Yc(a,o))).filter(((a,o,l)=>!o||Yc(a,l[o-1])!==0));const i=[];i.push(e);for(const a of r){const o=Yc(a,e),l=Yc(a,t);if(o===0)i[0]=e.An();else if(o>0&&l<0)i.push(a),i.push(a.An());else if(l>0)break}i.push(t);const s=[];for(let a=0;a<i.length;a+=2){if(this.Zn(i[a],i[a+1]))return[];const o=i[a].Vn(this.uid,Cx,ft.empty()),l=i[a+1].Vn(this.uid,Cx,ft.empty());s.push(IDBKeyRange.bound(o,l))}return s}Zn(e,t){return Yc(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(OL)}getMinOffset(e,t){return de.mapArray(this.Mn(t),(r=>this.xn(e,r).next((i=>i||Ct(44426))))).next(OL)}}function LL(n){return yi(n,Gp)}function Df(n){return yi(n,Hm)}function pm(n){return yi(n,fk)}function jf(n){return yi(n,Wm)}function OL(n){Ot(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const i=n[r].indexState.offset;uk(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new ga(e.readTime,e.documentKey,t)}const DL={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},P8=41943040;class as{static withCacheSize(e){return new as(e,as.DEFAULT_COLLECTION_PERCENTILE,as.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}function N8(n,e,t){const r=n.store(ao),i=n.store(j0),s=[],a=IDBKeyRange.only(t.batchId);let o=0;const l=r.ee({range:a},((h,g,m)=>(o++,m.delete())));s.push(l.next((()=>{Ot(o===1,47070,{batchId:t.batchId})})));const c=[];for(const h of t.mutations){const g=b6(e,h.key.path,t.batchId);s.push(i.delete(g)),c.push(h.key)}return de.waitFor(s).next((()=>c))}function Ev(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Ct(14731);e=n.noDocument}return JSON.stringify(e).length}as.DEFAULT_COLLECTION_PERCENTILE=10,as.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,as.DEFAULT=new as(P8,as.DEFAULT_COLLECTION_PERCENTILE,as.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),as.DISABLED=new as(-1,0,0);class lE{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Xn={}}static wt(e,t,r,i){Ot(e.uid!=="",64387);const s=e.isAuthenticated()?e.uid:"";return new lE(s,t,r,i)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Zc(e).ee({index:Wh,range:r},((i,s,a)=>{t=!1,a.done()})).next((()=>t))}addMutationBatch(e,t,r,i){const s=Yf(e),a=Zc(e);return a.add({}).next((o=>{Ot(typeof o=="number",49019);const l=new wk(o,t,r,i),c=(function(y,_,x){const w=x.baseMutations.map((T=>_v(y.yt,T))),b=x.mutations.map((T=>_v(y.yt,T)));return{userId:_,batchId:x.batchId,localWriteTimeMs:x.localWriteTime.toMillis(),baseMutations:w,mutations:b}})(this.serializer,this.userId,l),h=[];let g=new tr(((m,y)=>tn(m.canonicalString(),y.canonicalString())));for(const m of i){const y=b6(this.userId,m.key.path,o);g=g.add(m.key.path.popLast()),h.push(a.put(c)),h.push(s.put(y,WQ))}return g.forEach((m=>{h.push(this.indexManager.addToCollectionParentIndex(e,m))})),e.addOnCommittedListener((()=>{this.Xn[o]=l.keys()})),de.waitFor(h).next((()=>l))}))}lookupMutationBatch(e,t){return Zc(e).get(t).next((r=>r?(Ot(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:t}),Dh(this.serializer,r)):null))}er(e,t){return this.Xn[t]?de.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next((r=>{if(r){const i=r.keys();return this.Xn[t]=i,i}return null}))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return Zc(e).ee({index:Wh,range:i},((a,o,l)=>{o.userId===this.userId&&(Ot(o.batchId>=r,47524,{tr:r}),s=Dh(this.serializer,o)),l.done()})).next((()=>s))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=Jh;return Zc(e).ee({index:Wh,range:t,reverse:!0},((i,s,a)=>{r=s.batchId,a.done()})).next((()=>r))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,Jh],[this.userId,Number.POSITIVE_INFINITY]);return Zc(e).J(Wh,t).next((r=>r.map((i=>Dh(this.serializer,i)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=h_(this.userId,t.path),i=IDBKeyRange.lowerBound(r),s=[];return Yf(e).ee({range:i},((a,o,l)=>{const[c,h,g]=a,m=el(h);if(c===this.userId&&t.path.isEqual(m))return Zc(e).get(g).next((y=>{if(!y)throw Ct(61480,{nr:a,batchId:g});Ot(y.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:y.userId,batchId:g}),s.push(Dh(this.serializer,y))}));l.done()})).next((()=>s))}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new tr(tn);const i=[];return t.forEach((s=>{const a=h_(this.userId,s.path),o=IDBKeyRange.lowerBound(a),l=Yf(e).ee({range:o},((c,h,g)=>{const[m,y,_]=c,x=el(y);m===this.userId&&s.path.isEqual(x)?r=r.add(_):g.done()}));i.push(l)})),de.waitFor(i).next((()=>this.rr(e,r)))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1,s=h_(this.userId,r),a=IDBKeyRange.lowerBound(s);let o=new tr(tn);return Yf(e).ee({range:a},((l,c,h)=>{const[g,m,y]=l,_=el(m);g===this.userId&&r.isPrefixOf(_)?_.length===i&&(o=o.add(y)):h.done()})).next((()=>this.rr(e,o)))}rr(e,t){const r=[],i=[];return t.forEach((s=>{i.push(Zc(e).get(s).next((a=>{if(a===null)throw Ct(35274,{batchId:s});Ot(a.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:a.userId,batchId:s}),r.push(Dh(this.serializer,a))})))})),de.waitFor(i).next((()=>r))}removeMutationBatch(e,t){return N8(e.le,this.userId,t).next((r=>(e.addOnCommittedListener((()=>{this.ir(t.batchId)})),de.forEach(r,(i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return de.resolve();const r=IDBKeyRange.lowerBound((function(a){return[a]})(this.userId)),i=[];return Yf(e).ee({range:r},((s,a,o)=>{if(s[0]===this.userId){const l=el(s[1]);i.push(l)}else o.done()})).next((()=>{Ot(i.length===0,56720,{sr:i.map((s=>s.canonicalString()))})}))}))}containsKey(e,t){return M8(e,this.userId,t)}_r(e){return L8(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:Jh,lastStreamToken:""}))}}function M8(n,e,t){const r=h_(e,t.path),i=r[1],s=IDBKeyRange.lowerBound(r);let a=!1;return Yf(n).ee({range:s,X:!0},((o,l,c)=>{const[h,g,m]=o;h===e&&g===i&&(a=!0),c.done()})).next((()=>a))}function Zc(n){return yi(n,ao)}function Yf(n){return yi(n,j0)}function L8(n){return yi(n,Vp)}class wd{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new wd(0)}static cr(){return new wd(-1)}}class yte{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next((t=>{const r=new wd(t.highestTargetId);return t.highestTargetId=r.next(),this.hr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((t=>Ft.fromTimestamp(new Zn(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,r){return this.lr(e).next((i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.hr(e,i))))}addTargetData(e,t){return this.Pr(e,t).next((()=>this.lr(e).next((r=>(r.targetCount+=1,this.Tr(t,r),this.hr(e,r))))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>Ff(e).delete(t.targetId))).next((()=>this.lr(e))).next((r=>(Ot(r.targetCount>0,8065),r.targetCount-=1,this.hr(e,r))))}removeTargets(e,t,r){let i=0;const s=[];return Ff(e).ee(((a,o)=>{const l=Im(o);l.sequenceNumber<=t&&r.get(l.targetId)===null&&(i++,s.push(this.removeTargetData(e,l)))})).next((()=>de.waitFor(s))).next((()=>i))}forEachTarget(e,t){return Ff(e).ee(((r,i)=>{const s=Im(i);t(s)}))}lr(e){return jL(e).get(fv).next((t=>(Ot(t!==null,2888),t)))}hr(e,t){return jL(e).put(fv,t)}Pr(e,t){return Ff(e).put(A8(this.serializer,t))}Tr(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next((t=>t.targetCount))}getTargetData(e,t){const r=xd(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return Ff(e).ee({range:i,index:R6},((a,o,l)=>{const c=Im(o);j1(t,c.target)&&(s=c,l.done())})).next((()=>s))}addMatchingKeys(e,t,r){const i=[],s=cu(e);return t.forEach((a=>{const o=ds(a.path);i.push(s.put({targetId:r,path:o})),i.push(this.referenceDelegate.addReference(e,r,a))})),de.waitFor(i)}removeMatchingKeys(e,t,r){const i=cu(e);return de.forEach(t,(s=>{const a=ds(s.path);return de.waitFor([i.delete([r,a]),this.referenceDelegate.removeReference(e,r,s)])}))}removeMatchingKeysForTargetId(e,t){const r=cu(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),i=cu(e);let s=fn();return i.ee({range:r,X:!0},((a,o,l)=>{const c=el(a[1]),h=new ft(c);s=s.add(h)})).next((()=>s))}containsKey(e,t){const r=ds(t.path),i=IDBKeyRange.bound([r],[y6(r)],!1,!0);let s=0;return cu(e).ee({index:dk,X:!0,range:i},(([a,o],l,c)=>{a!==0&&(s++,c.done())})).next((()=>s>0))}At(e,t){return Ff(e).get(t).next((r=>r?Im(r):null))}}function Ff(n){return yi(n,F0)}function jL(n){return yi(n,Qh)}function cu(n){return yi(n,V0)}const FL="LruGarbageCollector",xte=1048576;function VL([n,e],[t,r]){const i=tn(n,t);return i===0?tn(e,r):i}class _te{constructor(e){this.Ir=e,this.buffer=new tr(VL),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();VL(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class O8{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){nt(FL,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Ku(t)?nt(FL,"Ignoring IndexedDB error during garbage collection: ",t):await Dd(t)}await this.Vr(3e5)}))}}class vte{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return de.resolve(Da.ce);const r=new _te(t);return this.mr.forEachTarget(e,(i=>r.Ar(i.sequenceNumber))).next((()=>this.mr.pr(e,(i=>r.Ar(i))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(nt("LruGarbageCollector","Garbage collection skipped; disabled"),de.resolve(DL)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(nt("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),DL):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,i,s,a,o,l,c;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((g=>(g>this.params.maximumSequenceNumbersToCollect?(nt("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${g}`),i=this.params.maximumSequenceNumbersToCollect):i=g,a=Date.now(),this.nthSequenceNumber(e,i)))).next((g=>(r=g,o=Date.now(),this.removeTargets(e,r,t)))).next((g=>(s=g,l=Date.now(),this.removeOrphanedDocuments(e,r)))).next((g=>(c=Date.now(),Hf()<=_n.DEBUG&&nt("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-h}ms
	Determined least recently used ${i} in `+(o-a)+`ms
	Removed ${s} targets in `+(l-o)+`ms
	Removed ${g} documents in `+(c-l)+`ms
Total Duration: ${c-h}ms`),de.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:g}))))}}function D8(n,e){return new vte(n,e)}class wte{constructor(e,t){this.db=e,this.garbageCollector=D8(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,((r,i)=>t(i)))}addReference(e,t,r){return Px(e,r)}removeReference(e,t,r){return Px(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Px(e,t)}br(e,t){return(function(i,s){let a=!1;return L8(i).te((o=>M8(i,o,s).next((l=>(l&&(a=!0),de.resolve(!l)))))).next((()=>a))})(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Sr(e,((a,o)=>{if(o<=t){const l=this.br(e,a).next((c=>{if(!c)return s++,r.getEntry(e,a).next((()=>(r.removeEntry(a,Ft.min()),cu(e).delete((function(g){return[0,ds(g.path)]})(a)))))}));i.push(l)}})).next((()=>de.waitFor(i))).next((()=>r.apply(e))).next((()=>s))}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Px(e,t)}Sr(e,t){const r=cu(e);let i,s=Da.ce;return r.ee({index:dk},(([a,o],{path:l,sequenceNumber:c})=>{a===0?(s!==Da.ce&&t(new ft(el(i)),s),s=c,i=l):s=Da.ce})).next((()=>{s!==Da.ce&&t(new ft(el(i)),s)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Px(n,e){return cu(n).put((function(r,i){return{targetId:0,path:ds(r.path),sequenceNumber:i}})(e,n.currentSequenceNumber))}class j8{constructor(){this.changes=new yc((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Br.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?de.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Ete{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return Eh(e).put(r)}removeEntry(e,t,r){return Eh(e).delete((function(s,a){const o=s.path.toArray();return[o.slice(0,o.length-2),o[o.length-2],vv(a),o[o.length-1]]})(t,r))}updateMetadata(e,t){return this.getMetadata(e).next((r=>(r.byteSize+=t,this.Dr(e,r))))}getEntry(e,t){let r=Br.newInvalidDocument(t);return Eh(e).ee({index:d_,range:IDBKeyRange.only(ym(t))},((i,s)=>{r=this.Cr(t,s)})).next((()=>r))}vr(e,t){let r={size:0,document:Br.newInvalidDocument(t)};return Eh(e).ee({index:d_,range:IDBKeyRange.only(ym(t))},((i,s)=>{r={document:this.Cr(t,s),size:Ev(s)}})).next((()=>r))}getEntries(e,t){let r=ha();return this.Fr(e,t,((i,s)=>{const a=this.Cr(i,s);r=r.insert(i,a)})).next((()=>r))}Mr(e,t){let r=ha(),i=new Er(ft.comparator);return this.Fr(e,t,((s,a)=>{const o=this.Cr(s,a);r=r.insert(s,o),i=i.insert(s,Ev(a))})).next((()=>({documents:r,Or:i})))}Fr(e,t,r){if(t.isEmpty())return de.resolve();let i=new tr(zL);t.forEach((l=>i=i.add(l)));const s=IDBKeyRange.bound(ym(i.first()),ym(i.last())),a=i.getIterator();let o=a.getNext();return Eh(e).ee({index:d_,range:s},((l,c,h)=>{const g=ft.fromSegments([...c.prefixPath,c.collectionGroup,c.documentId]);for(;o&&zL(o,g)<0;)r(o,null),o=a.getNext();o&&o.isEqual(g)&&(r(o,c),o=a.hasNext()?a.getNext():null),o?h.j(ym(o)):h.done()})).next((()=>{for(;o;)r(o,null),o=a.hasNext()?a.getNext():null}))}getDocumentsMatchingQuery(e,t,r,i,s){const a=t.path,o=[a.popLast().toArray(),a.lastSegment(),vv(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[a.popLast().toArray(),a.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Eh(e).J(IDBKeyRange.bound(o,l,!0)).next((c=>{s?.incrementDocumentReadCount(c.length);let h=ha();for(const g of c){const m=this.Cr(ft.fromSegments(g.prefixPath.concat(g.collectionGroup,g.documentId)),g);m.isFoundDocument()&&(V1(t,m)||i.has(m.key))&&(h=h.insert(m.key,m))}return h}))}getAllFromCollectionGroup(e,t,r,i){let s=ha();const a=GL(t,r),o=GL(t,ga.max());return Eh(e).ee({index:T6,range:IDBKeyRange.bound(a,o,!0)},((l,c,h)=>{const g=this.Cr(ft.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);s=s.insert(g.key,g),s.size===i&&h.done()})).next((()=>s))}newChangeBuffer(e){return new Ste(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return BL(e).get(zT).next((t=>(Ot(!!t,20021),t)))}Dr(e,t){return BL(e).put(zT,t)}Cr(e,t){if(t){const r=ote(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(Ft.min())))return r}return Br.newInvalidDocument(e)}}function F8(n){return new Ete(n)}class Ste extends j8{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new yc((r=>r.toString()),((r,i)=>r.isEqual(i)))}applyChanges(e){const t=[];let r=0,i=new tr(((s,a)=>tn(s.canonicalString(),a.canonicalString())));return this.changes.forEach(((s,a)=>{const o=this.Br.get(s);if(t.push(this.Nr.removeEntry(e,s,o.readTime)),a.isValidDocument()){const l=SL(this.Nr.serializer,a);i=i.add(s.path.popLast());const c=Ev(l);r+=c-o.size,t.push(this.Nr.addEntry(e,s,l))}else if(r-=o.size,this.trackRemovals){const l=SL(this.Nr.serializer,a.convertToNoDocument(Ft.min()));t.push(this.Nr.addEntry(e,s,l))}})),i.forEach((s=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,s))})),t.push(this.Nr.updateMetadata(e,r)),de.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next((r=>(this.Br.set(t,{size:r.size,readTime:r.document.readTime}),r.document)))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next((({documents:r,Or:i})=>(i.forEach(((s,a)=>{this.Br.set(s,{size:a,readTime:r.get(s).readTime})})),r)))}}function BL(n){return yi(n,Bp)}function Eh(n){return yi(n,dv)}function ym(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function GL(n,e){const t=e.documentKey.path.toArray();return[n,vv(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function zL(n,e){const t=n.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<t.length-2&&s<r.length-2;++s)if(i=tn(t[s],r[s]),i)return i;return i=tn(t.length,r.length),i||(i=tn(t[t.length-2],r[r.length-2]),i||tn(t[t.length-1],r[r.length-1]))}class bte{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class V8{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((i=>(r=i,this.remoteDocumentCache.getEntry(e,t)))).next((i=>(r!==null&&Ym(r.mutation,i,Vs.empty(),Zn.now()),i)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,fn()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=fn()){const i=tl();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,r).next((s=>{let a=Am();return s.forEach(((o,l)=>{a=a.insert(o,l.overlayedDocument)})),a}))))}getOverlayedDocuments(e,t){const r=tl();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,fn())))}populateOverlays(e,t,r){const i=[];return r.forEach((s=>{t.has(s)||i.push(s)})),this.documentOverlayCache.getOverlays(e,i).next((s=>{s.forEach(((a,o)=>{t.set(a,o)}))}))}computeViews(e,t,r,i){let s=ha();const a=qm(),o=(function(){return qm()})();return t.forEach(((l,c)=>{const h=r.get(c.key);i.has(c.key)&&(h===void 0||h.mutation instanceof xc)?s=s.insert(c.key,c):h!==void 0?(a.set(c.key,h.mutation.getFieldMask()),Ym(h.mutation,c,h.mutation.getFieldMask(),Zn.now())):a.set(c.key,Vs.empty())})),this.recalculateAndSaveOverlays(e,s).next((l=>(l.forEach(((c,h)=>a.set(c,h))),t.forEach(((c,h)=>o.set(c,new bte(h,a.get(c)??null)))),o)))}recalculateAndSaveOverlays(e,t){const r=qm();let i=new Er(((a,o)=>a-o)),s=fn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((a=>{for(const o of a)o.keys().forEach((l=>{const c=t.get(l);if(c===null)return;let h=r.get(l)||Vs.empty();h=o.applyToLocalView(c,h),r.set(l,h);const g=(i.get(o.batchId)||fn()).add(l);i=i.insert(o.batchId,g)}))})).next((()=>{const a=[],o=i.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),c=l.key,h=l.value,g=n8();h.forEach((m=>{if(!s.has(m)){const y=c8(t.get(m),r.get(m));y!==null&&g.set(m,y),s=s.add(m)}})),a.push(this.documentOverlayCache.saveOverlays(e,c,g))}return de.waitFor(a)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,i){return(function(a){return ft.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Z6(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next((s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):de.resolve(tl());let o=Dp,l=s;return a.next((c=>de.forEach(c,((h,g)=>(o<g.largestBatchId&&(o=g.largestBatchId),s.get(h)?de.resolve():this.remoteDocumentCache.getEntry(e,h).next((m=>{l=l.insert(h,m)}))))).next((()=>this.populateOverlays(e,c,s))).next((()=>this.computeViews(e,l,c,fn()))).next((h=>({batchId:o,changes:t8(h)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ft(t)).next((r=>{let i=Am();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const s=t.collectionGroup;let a=Am();return this.indexManager.getCollectionParents(e,s).next((o=>de.forEach(o,(l=>{const c=(function(g,m){return new F1(m,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)})(t,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,r,i).next((h=>{h.forEach(((g,m)=>{a=a.insert(g,m)}))}))})).next((()=>a))))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i)))).next((a=>{s.forEach(((l,c)=>{const h=c.getKey();a.get(h)===null&&(a=a.insert(h,Br.newInvalidDocument(h)))}));let o=Am();return a.forEach(((l,c)=>{const h=s.get(l);h!==void 0&&Ym(h.mutation,c,Vs.empty(),Zn.now()),V1(t,c)&&(o=o.insert(l,c))})),o}))}}class Tte{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return de.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(i){return{id:i.id,version:i.version,createTime:bs(i.createTime)}})(t)),de.resolve()}getNamedQuery(e,t){return de.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(i){return{name:i.name,query:k8(i.bundledQuery),readTime:bs(i.readTime)}})(t)),de.resolve()}}class Rte{constructor(){this.overlays=new Er(ft.comparator),this.qr=new Map}getOverlay(e,t){return de.resolve(this.overlays.get(t))}getOverlays(e,t){const r=tl();return de.forEach(t,(i=>this.getOverlay(e,i).next((s=>{s!==null&&r.set(i,s)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((i,s)=>{this.St(e,t,s)})),de.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.qr.get(r);return i!==void 0&&(i.forEach((s=>this.overlays=this.overlays.remove(s))),this.qr.delete(r)),de.resolve()}getOverlaysForCollection(e,t,r){const i=tl(),s=t.length+1,a=new ft(t.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const l=o.getNext().value,c=l.getKey();if(!t.isPrefixOf(c.path))break;c.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return de.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new Er(((c,h)=>c-h));const a=this.overlays.getIterator();for(;a.hasNext();){const c=a.getNext().value;if(c.getKey().getCollectionGroup()===t&&c.largestBatchId>r){let h=s.get(c.largestBatchId);h===null&&(h=tl(),s=s.insert(c.largestBatchId,h)),h.set(c.getKey(),c)}}const o=tl(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach(((c,h)=>o.set(c,h))),!(o.size()>=i)););return de.resolve(o)}St(e,t,r){const i=this.overlays.get(r.key);if(i!==null){const a=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new Sk(t,r));let s=this.qr.get(t);s===void 0&&(s=fn(),this.qr.set(t,s)),this.qr.set(t,s.add(r.key))}}class Ate{constructor(){this.sessionToken=si.EMPTY_BYTE_STRING}getSessionToken(e){return de.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,de.resolve()}}class kk{constructor(){this.Qr=new tr(Ei.$r),this.Ur=new tr(Ei.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const r=new Ei(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Gr(new Ei(e,t))}zr(e,t){e.forEach((r=>this.removeReference(r,t)))}jr(e){const t=new ft(new Bn([])),r=new Ei(t,e),i=new Ei(t,e+1),s=[];return this.Ur.forEachInRange([r,i],(a=>{this.Gr(a),s.push(a.key)})),s}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new ft(new Bn([])),r=new Ei(t,e),i=new Ei(t,e+1);let s=fn();return this.Ur.forEachInRange([r,i],(a=>{s=s.add(a.key)})),s}containsKey(e){const t=new Ei(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class Ei{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return ft.comparator(e.key,t.key)||tn(e.Yr,t.Yr)}static Kr(e,t){return tn(e.Yr,t.Yr)||ft.comparator(e.key,t.key)}}class kte{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new tr(Ei.$r)}checkEmpty(e){return de.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new wk(s,t,r,i);this.mutationQueue.push(a);for(const o of i)this.Zr=this.Zr.add(new Ei(o.key,s)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return de.resolve(a)}lookupMutationBatch(e,t){return de.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=this.ei(r),s=i<0?0:i;return de.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return de.resolve(this.mutationQueue.length===0?Jh:this.tr-1)}getAllMutationBatches(e){return de.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new Ei(t,0),i=new Ei(t,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([r,i],(a=>{const o=this.Xr(a.Yr);s.push(o)})),de.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new tr(tn);return t.forEach((i=>{const s=new Ei(i,0),a=new Ei(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,a],(o=>{r=r.add(o.Yr)}))})),de.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let s=r;ft.isDocumentKey(s)||(s=s.child(""));const a=new Ei(new ft(s),0);let o=new tr(tn);return this.Zr.forEachWhile((l=>{const c=l.key.path;return!!r.isPrefixOf(c)&&(c.length===i&&(o=o.add(l.Yr)),!0)}),a),de.resolve(this.ti(o))}ti(e){const t=[];return e.forEach((r=>{const i=this.Xr(r);i!==null&&t.push(i)})),t}removeMutationBatch(e,t){Ot(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return de.forEach(t.mutations,(i=>{const s=new Ei(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((()=>{this.Zr=r}))}ir(e){}containsKey(e,t){const r=new Ei(t,0),i=this.Zr.firstAfterOrEqual(r);return de.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,de.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class Ite{constructor(e){this.ri=e,this.docs=(function(){return new Er(ft.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),s=i?i.size:0,a=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return de.resolve(r?r.document.mutableCopy():Br.newInvalidDocument(t))}getEntries(e,t){let r=ha();return t.forEach((i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Br.newInvalidDocument(i))})),de.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=ha();const a=t.path,o=new ft(a.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:c,value:{document:h}}=l.getNext();if(!a.isPrefixOf(c.path))break;c.path.length>a.length+1||uk(v6(h),r)<=0||(i.has(h.key)||V1(t,h))&&(s=s.insert(h.key,h.mutableCopy()))}return de.resolve(s)}getAllFromCollectionGroup(e,t,r,i){Ct(9500)}ii(e,t){return de.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new Cte(this)}getSize(e){return de.resolve(this.size)}}class Cte extends j8{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((r,i)=>{i.isValidDocument()?t.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)})),de.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class Pte{constructor(e){this.persistence=e,this.si=new yc((t=>xd(t)),j1),this.lastRemoteSnapshotVersion=Ft.min(),this.highestTargetId=0,this.oi=0,this._i=new kk,this.targetCount=0,this.ai=wd.ur()}forEachTarget(e,t){return this.si.forEach(((r,i)=>t(i))),de.resolve()}getLastRemoteSnapshotVersion(e){return de.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return de.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),de.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),de.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new wd(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,de.resolve()}updateTargetData(e,t){return this.Pr(t),de.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,de.resolve()}removeTargets(e,t,r){let i=0;const s=[];return this.si.forEach(((a,o)=>{o.sequenceNumber<=t&&r.get(o.targetId)===null&&(this.si.delete(a),s.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)})),de.waitFor(s).next((()=>i))}getTargetCount(e){return de.resolve(this.targetCount)}getTargetData(e,t){const r=this.si.get(t)||null;return de.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),de.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach((a=>{s.push(i.markPotentiallyOrphaned(e,a))})),de.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),de.resolve()}getMatchingKeysForTargetId(e,t){const r=this._i.Hr(t);return de.resolve(r)}containsKey(e,t){return de.resolve(this._i.containsKey(t))}}class Ik{constructor(e,t){this.ui={},this.overlays={},this.ci=new Da(0),this.li=!1,this.li=!0,this.hi=new Ate,this.referenceDelegate=e(this),this.Pi=new Pte(this),this.indexManager=new mte,this.remoteDocumentCache=(function(i){return new Ite(i)})((r=>this.referenceDelegate.Ti(r))),this.serializer=new R8(t),this.Ii=new Tte(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Rte,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new kte(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){nt("MemoryPersistence","Starting transaction:",e);const i=new Nte(this.ci.next());return this.referenceDelegate.Ei(),r(i).next((s=>this.referenceDelegate.di(i).next((()=>s)))).toPromise().then((s=>(i.raiseOnCommittedEvent(),s)))}Ai(e,t){return de.or(Object.values(this.ui).map((r=>()=>r.containsKey(e,t))))}}class Nte extends E6{constructor(e){super(),this.currentSequenceNumber=e}}class cE{constructor(e){this.persistence=e,this.Ri=new kk,this.Vi=null}static mi(e){return new cE(e)}get fi(){if(this.Vi)return this.Vi;throw Ct(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),de.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),de.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),de.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((i=>this.fi.add(i.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((i=>{i.forEach((s=>this.fi.add(s.toString())))})).next((()=>r.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return de.forEach(this.fi,(r=>{const i=ft.fromPath(r);return this.gi(e,i).next((s=>{s||t.removeEntry(i,Ft.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return de.or([()=>de.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Sv{constructor(e,t){this.persistence=e,this.pi=new yc((r=>ds(r.path)),((r,i)=>r.isEqual(i))),this.garbageCollector=D8(this,t)}static mi(e,t){return new Sv(e,t)}Ei(){}di(e){return de.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}pr(e,t){return de.forEach(this.pi,((r,i)=>this.br(e,r,i).next((s=>s?de.resolve():t(i)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ii(e,(a=>this.br(e,a,t).next((o=>{o||(r++,s.removeEntry(a,Ft.min()))})))).next((()=>s.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),de.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),de.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),de.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),de.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=g_(e.data.value)),t}br(e,t,r){return de.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.pi.get(t);return de.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class Mte{constructor(e){this.serializer=e}k(e,t,r,i){const s=new Xw("createOrUpgrade",t);r<1&&i>=1&&((function(l){l.createObjectStore(D1)})(e),(function(l){l.createObjectStore(Vp,{keyPath:$Q}),l.createObjectStore(ao,{keyPath:QM,autoIncrement:!0}).createIndex(Wh,eL,{unique:!0}),l.createObjectStore(j0)})(e),UL(e),(function(l){l.createObjectStore(Ih)})(e));let a=de.resolve();return r<3&&i>=3&&(r!==0&&((function(l){l.deleteObjectStore(V0),l.deleteObjectStore(F0),l.deleteObjectStore(Qh)})(e),UL(e)),a=a.next((()=>(function(l){const c=l.store(Qh),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Ft.min().toTimestamp(),targetCount:0};return c.put(fv,h)})(s)))),r<4&&i>=4&&(r!==0&&(a=a.next((()=>(function(l,c){return c.store(ao).J().next((g=>{l.deleteObjectStore(ao),l.createObjectStore(ao,{keyPath:QM,autoIncrement:!0}).createIndex(Wh,eL,{unique:!0});const m=c.store(ao),y=g.map((_=>m.put(_)));return de.waitFor(y)}))})(e,s)))),a=a.next((()=>{(function(l){l.createObjectStore(B0,{keyPath:QQ})})(e)}))),r<5&&i>=5&&(a=a.next((()=>this.yi(s)))),r<6&&i>=6&&(a=a.next((()=>((function(l){l.createObjectStore(Bp)})(e),this.wi(s))))),r<7&&i>=7&&(a=a.next((()=>this.Si(s)))),r<8&&i>=8&&(a=a.next((()=>this.bi(e,s)))),r<9&&i>=9&&(a=a.next((()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)}))),r<10&&i>=10&&(a=a.next((()=>this.Di(s)))),r<11&&i>=11&&(a=a.next((()=>{(function(l){l.createObjectStore(Yw,{keyPath:eee})})(e),(function(l){l.createObjectStore(Zw,{keyPath:tee})})(e)}))),r<12&&i>=12&&(a=a.next((()=>{(function(l){const c=l.createObjectStore(Jw,{keyPath:lee});c.createIndex($T,cee,{unique:!1}),c.createIndex(I6,uee,{unique:!1})})(e)}))),r<13&&i>=13&&(a=a.next((()=>(function(l){const c=l.createObjectStore(dv,{keyPath:HQ});c.createIndex(d_,KQ),c.createIndex(T6,XQ)})(e))).next((()=>this.Ci(e,s))).next((()=>e.deleteObjectStore(Ih)))),r<14&&i>=14&&(a=a.next((()=>this.Fi(e,s)))),r<15&&i>=15&&(a=a.next((()=>(function(l){l.createObjectStore(fk,{keyPath:nee,autoIncrement:!0}).createIndex(UT,ree,{unique:!1}),l.createObjectStore(Wm,{keyPath:iee}).createIndex(A6,see,{unique:!1}),l.createObjectStore(Hm,{keyPath:aee}).createIndex(k6,oee,{unique:!1})})(e)))),r<16&&i>=16&&(a=a.next((()=>{t.objectStore(Wm).clear()})).next((()=>{t.objectStore(Hm).clear()}))),r<17&&i>=17&&(a=a.next((()=>{(function(l){l.createObjectStore(gk,{keyPath:hee})})(e)}))),r<18&&i>=18&&SF()&&(a=a.next((()=>{t.objectStore(Wm).clear()})).next((()=>{t.objectStore(Hm).clear()}))),a}wi(e){let t=0;return e.store(Ih).ee(((r,i)=>{t+=Ev(i)})).next((()=>{const r={byteSize:t};return e.store(Bp).put(zT,r)}))}yi(e){const t=e.store(Vp),r=e.store(ao);return t.J().next((i=>de.forEach(i,(s=>{const a=IDBKeyRange.bound([s.userId,Jh],[s.userId,s.lastAcknowledgedBatchId]);return r.J(Wh,a).next((o=>de.forEach(o,(l=>{Ot(l.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:l.batchId});const c=Dh(this.serializer,l);return N8(e,s.userId,c).next((()=>{}))}))))}))))}Si(e){const t=e.store(V0),r=e.store(Ih);return e.store(Qh).get(fv).next((i=>{const s=[];return r.ee(((a,o)=>{const l=new Bn(a),c=(function(g){return[0,ds(g)]})(l);s.push(t.get(c).next((h=>h?de.resolve():(g=>t.put({targetId:0,path:ds(g),sequenceNumber:i.highestListenSequenceNumber}))(l))))})).next((()=>de.waitFor(s)))}))}bi(e,t){e.createObjectStore(Gp,{keyPath:JQ});const r=t.store(Gp),i=new Ak,s=a=>{if(i.add(a)){const o=a.lastSegment(),l=a.popLast();return r.put({collectionId:o,parent:ds(l)})}};return t.store(Ih).ee({X:!0},((a,o)=>{const l=new Bn(a);return s(l.popLast())})).next((()=>t.store(j0).ee({X:!0},(([a,o,l],c)=>{const h=el(o);return s(h.popLast())}))))}Di(e){const t=e.store(F0);return t.ee(((r,i)=>{const s=Im(i),a=A8(this.serializer,s);return t.put(a)}))}Ci(e,t){const r=t.store(Ih),i=[];return r.ee(((s,a)=>{const o=t.store(dv),l=(function(g){return g.document?new ft(Bn.fromString(g.document.name).popFirst(5)):g.noDocument?ft.fromSegments(g.noDocument.path):g.unknownDocument?ft.fromSegments(g.unknownDocument.path):Ct(36783)})(a).path.toArray(),c={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:a.readTime||[0,0],unknownDocument:a.unknownDocument,noDocument:a.noDocument,document:a.document,hasCommittedMutations:!!a.hasCommittedMutations};i.push(o.put(c))})).next((()=>de.waitFor(i)))}Fi(e,t){const r=t.store(ao),i=F8(this.serializer),s=new Ik(cE.mi,this.serializer.yt);return r.J().next((a=>{const o=new Map;return a.forEach((l=>{let c=o.get(l.userId)??fn();Dh(this.serializer,l).keys().forEach((h=>c=c.add(h))),o.set(l.userId,c)})),de.forEach(o,((l,c)=>{const h=new zi(c),g=oE.wt(this.serializer,h),m=s.getIndexManager(h),y=lE.wt(h,this.serializer,m,s.referenceDelegate);return new V8(i,y,g,m).recalculateAndSaveOverlaysForDocumentKeys(new WT(t,Da.ce),l).next()}))}))}}function UL(n){n.createObjectStore(V0,{keyPath:YQ}).createIndex(dk,ZQ,{unique:!0}),n.createObjectStore(F0,{keyPath:"targetId"}).createIndex(R6,qQ,{unique:!0}),n.createObjectStore(Qh)}const Jc="IndexedDbPersistence",ub=18e5,hb=5e3,db="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Lte="main";class Ck{constructor(e,t,r,i,s,a,o,l,c,h,g=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Mi=s,this.window=a,this.document=o,this.xi=c,this.Oi=h,this.Ni=g,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=m=>Promise.resolve(),!Ck.v())throw new ht(De.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new wte(this,i),this.$i=t+Lte,this.serializer=new R8(l),this.Ui=new ku(this.$i,this.Ni,new Mte(this.serializer)),this.hi=new cte,this.Pi=new yte(this.referenceDelegate,this.serializer),this.remoteDocumentCache=F8(this.serializer),this.Ii=new lte,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,h===!1&&ws(Jc,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new ht(De.FAILED_PRECONDITION,db);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new Da(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>Nx(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((t=>this.isPrimary&&!t?this.Zi(e).next((()=>!1)):!!t&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(Ku(e))return nt(Jc,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return nt(Jc,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return xm(e).get(Mf).next((t=>de.resolve(this.es(t))))}ts(e){return Nx(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,ub)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const r=yi(t,B0);return r.J().next((i=>{const s=this.ss(i,ub),a=i.filter((o=>s.indexOf(o)===-1));return de.forEach(a,(o=>r.delete(o.clientId))).next((()=>a))}))})).catch((()=>[]));if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?de.resolve(!0):xm(e).get(Mf).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,hb)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new ht(De.FAILED_PRECONDITION,db);return!1}}return!(!this.networkEnabled||!this.inForeground)||Nx(e).J().next((r=>this.ss(r,hb).find((i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,a=!this.inForeground&&i.inForeground,o=this.networkEnabled===i.networkEnabled;if(s||a&&o)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&nt(Jc,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[D1,B0],(e=>{const t=new WT(e,Da.ce);return this.Zi(t).next((()=>this.ts(t)))})),this.Ui.close(),this.Ps()}ss(e,t){return e.filter((r=>this.rs(r.updateTimeMs,t)&&!this.us(r.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>Nx(e).J().next((t=>this.ss(t,ub).map((r=>r.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return lE.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new pte(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return oE.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,r){nt(Jc,"Starting transaction:",e);const i=t==="readonly"?"readonly":"readwrite",s=(function(l){return l===18?gee:l===17?M6:l===16?fee:l===15?mk:l===14?N6:l===13?P6:l===12?dee:l===11?C6:void Ct(60245)})(this.Ni);let a;return this.Ui.runTransaction(e,i,s,(o=>(a=new WT(o,this.ci?this.ci.next():Da.ce),t==="readwrite-primary"?this.Hi(a).next((l=>!!l||this.Yi(a))).next((l=>{if(!l)throw ws(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new ht(De.FAILED_PRECONDITION,w6);return r(a)})).next((l=>this.Xi(a).next((()=>l)))):this.Is(a).next((()=>r(a)))))).then((o=>(a.raiseOnCommittedEvent(),o)))}Is(e){return xm(e).get(Mf).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,hb)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new ht(De.FAILED_PRECONDITION,db)}))}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return xm(e).put(Mf,t)}static v(){return ku.v()}Zi(e){const t=xm(e);return t.get(Mf).next((r=>this.es(r)?(nt(Jc,"Releasing primary lease."),t.delete(Mf)):de.resolve()))}rs(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(ws(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){typeof this.window?.addEventListener=="function"&&(this.Bi=()=>{this.cs();const e=/(?:Version|Mobile)\/1[456]/;EF()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){try{const t=this.Ki?.getItem(this._s(e))!==null;return nt(Jc,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return ws(Jc,"Failed to get zombied client id.",t),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){ws("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function xm(n){return yi(n,D1)}function Nx(n){return yi(n,B0)}function Ote(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class Pk{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=i}static As(e,t){let r=fn(),i=fn();for(const s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new Pk(e,t.fromCache,r,i)}}class Dte{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class B8{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return EF()?8:S6(pi())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,i){const s={result:null};return this.ys(e,t).next((a=>{s.result=a})).next((()=>{if(!s.result)return this.ws(e,t,i,r).next((a=>{s.result=a}))})).next((()=>{if(s.result)return;const a=new Dte;return this.Ss(e,t,a).next((o=>{if(s.result=o,this.Vs)return this.bs(e,t,a,o.size)}))})).next((()=>s.result))}bs(e,t,r,i){return r.documentReadCount<this.fs?(Hf()<=_n.DEBUG&&nt("QueryEngine","SDK will not create cache indexes for query:",Kf(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),de.resolve()):(Hf()<=_n.DEBUG&&nt("QueryEngine","Query:",Kf(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?(Hf()<=_n.DEBUG&&nt("QueryEngine","The SDK decides to create cache indexes for query:",Kf(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Fa(t))):de.resolve())}ys(e,t){if(fL(t))return de.resolve(null);let r=Fa(t);return this.indexManager.getIndexType(e,r).next((i=>i===0?null:(t.limit!==null&&i===1&&(t=JT(t,null,"F"),r=Fa(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((s=>{const a=fn(...s);return this.ps.getDocuments(e,a).next((o=>this.indexManager.getMinOffset(e,r).next((l=>{const c=this.Ds(t,o);return this.Cs(t,c,a,l.readTime)?this.ys(e,JT(t,null,"F")):this.vs(e,c,t,l)}))))})))))}ws(e,t,r,i){return fL(t)||i.isEqual(Ft.min())?de.resolve(null):this.ps.getDocuments(e,r).next((s=>{const a=this.Ds(t,s);return this.Cs(t,a,r,i)?de.resolve(null):(Hf()<=_n.DEBUG&&nt("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Kf(t)),this.vs(e,a,t,jQ(i,Dp)).next((o=>o)))}))}Ds(e,t){let r=new tr(Q6(e));return t.forEach(((i,s)=>{V1(e,s)&&(r=r.add(s))})),r}Cs(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ss(e,t,r){return Hf()<=_n.DEBUG&&nt("QueryEngine","Using full collection scan to execute query:",Kf(t)),this.ps.getDocumentsMatchingQuery(e,t,ga.min(),r)}vs(e,t,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next((s=>(t.forEach((a=>{s=s.insert(a.key,a)})),s)))}}const Nk="LocalStore",jte=3e8;class Fte{constructor(e,t,r,i){this.persistence=e,this.Fs=t,this.serializer=i,this.Ms=new Er(tn),this.xs=new yc((s=>xd(s)),j1),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new V8(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function G8(n,e,t,r){return new Fte(n,e,t,r)}async function z8(n,e){const t=nn(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next((s=>(i=s,t.Bs(e),t.mutationQueue.getAllMutationBatches(r)))).next((s=>{const a=[],o=[];let l=fn();for(const c of i){a.push(c.batchId);for(const h of c.mutations)l=l.add(h.key)}for(const c of s){o.push(c.batchId);for(const h of c.mutations)l=l.add(h.key)}return t.localDocuments.getDocuments(r,l).next((c=>({Ls:c,removedBatchIds:a,addedBatchIds:o})))}))}))}function Vte(n,e){const t=nn(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const i=e.batch.keys(),s=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(o,l,c,h){const g=c.batch,m=g.keys();let y=de.resolve();return m.forEach((_=>{y=y.next((()=>h.getEntry(l,_))).next((x=>{const w=c.docVersions.get(_);Ot(w!==null,48541),x.version.compareTo(w)<0&&(g.applyToRemoteDocument(x,c),x.isValidDocument()&&(x.setReadTime(c.commitVersion),h.addEntry(x)))}))})),y.next((()=>o.mutationQueue.removeMutationBatch(l,g)))})(t,r,e,s).next((()=>s.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(o){let l=fn();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(l=l.add(o.batch.mutations[c].key));return l})(e)))).next((()=>t.localDocuments.getDocuments(r,i)))}))}function U8(n){const e=nn(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function Bte(n,e){const t=nn(n),r=e.snapshotVersion;let i=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(s=>{const a=t.Ns.newChangeBuffer({trackRemovals:!0});i=t.Ms;const o=[];e.targetChanges.forEach(((h,g)=>{const m=i.get(g);if(!m)return;o.push(t.Pi.removeMatchingKeys(s,h.removedDocuments,g).next((()=>t.Pi.addMatchingKeys(s,h.addedDocuments,g))));let y=m.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(g)!==null?y=y.withResumeToken(si.EMPTY_BYTE_STRING,Ft.min()).withLastLimboFreeSnapshotVersion(Ft.min()):h.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(h.resumeToken,r)),i=i.insert(g,y),(function(x,w,b){return x.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=jte?!0:b.addedDocuments.size+b.modifiedDocuments.size+b.removedDocuments.size>0})(m,y,h)&&o.push(t.Pi.updateTargetData(s,y))}));let l=ha(),c=fn();if(e.documentUpdates.forEach((h=>{e.resolvedLimboDocuments.has(h)&&o.push(t.persistence.referenceDelegate.updateLimboDocument(s,h))})),o.push(Gte(s,a,e.documentUpdates).next((h=>{l=h.ks,c=h.qs}))),!r.isEqual(Ft.min())){const h=t.Pi.getLastRemoteSnapshotVersion(s).next((g=>t.Pi.setTargetsMetadata(s,s.currentSequenceNumber,r)));o.push(h)}return de.waitFor(o).next((()=>a.apply(s))).next((()=>t.localDocuments.getLocalViewOfDocuments(s,l,c))).next((()=>l))})).then((s=>(t.Ms=i,s)))}function Gte(n,e,t){let r=fn(),i=fn();return t.forEach((s=>r=r.add(s))),e.getEntries(n,r).next((s=>{let a=ha();return t.forEach(((o,l)=>{const c=s.get(o);l.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(o)),l.isNoDocument()&&l.version.isEqual(Ft.min())?(e.removeEntry(o,l.readTime),a=a.insert(o,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),a=a.insert(o,l)):nt(Nk,"Ignoring outdated watch update for ",o,". Current version:",c.version," Watch version:",l.version)})),{ks:a,qs:i}}))}function zte(n,e){const t=nn(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=Jh),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function Ute(n,e){const t=nn(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let i;return t.Pi.getTargetData(r,e).next((s=>s?(i=s,de.resolve(i)):t.Pi.allocateTargetId(r).next((a=>(i=new $l(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,i).next((()=>i)))))))})).then((r=>{const i=t.Ms.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r}))}async function aR(n,e,t){const r=nn(n),i=r.Ms.get(e),s=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",s,(a=>r.persistence.referenceDelegate.removeTarget(a,i)))}catch(a){if(!Ku(a))throw a;nt(Nk,`Failed to update sequence numbers for target ${e}: ${a}`)}r.Ms=r.Ms.remove(e),r.xs.delete(i.target)}function $L(n,e,t){const r=nn(n);let i=Ft.min(),s=fn();return r.persistence.runTransaction("Execute query","readwrite",(a=>(function(l,c,h){const g=nn(l),m=g.xs.get(h);return m!==void 0?de.resolve(g.Ms.get(m)):g.Pi.getTargetData(c,h)})(r,a,Fa(e)).next((o=>{if(o)return i=o.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(a,o.targetId).next((l=>{s=l}))})).next((()=>r.Fs.getDocumentsMatchingQuery(a,e,t?i:Ft.min(),t?s:fn()))).next((o=>($te(r,Iee(e),o),{documents:o,Qs:s})))))}function $te(n,e,t){let r=n.Os.get(e)||Ft.min();t.forEach(((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)})),n.Os.set(e,r)}class WL{constructor(){this.activeTargetIds=Oee()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class $8{constructor(){this.Mo=new WL,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new WL,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class Wte{Oo(e){}shutdown(){}}const HL="ConnectivityMonitor";class KL{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){nt(HL,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){nt(HL,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Mx=null;function oR(){return Mx===null?Mx=(function(){return 268435456+Math.round(2147483648*Math.random())})():Mx++,"0x"+Mx.toString(16)}const fb="RestConnection",Hte={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Kte{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===gv?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,t,r,i,s){const a=oR(),o=this.zo(e,t.toUriEncodedString());nt(fb,`Sending RPC '${e}' ${a}:`,o,r);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,i,s);const{host:c}=new URL(o),h=Ld(c);return this.Jo(e,o,l,r,h).then((g=>(nt(fb,`Received RPC '${e}' ${a}: `,g),g)),(g=>{throw pd(fb,`RPC '${e}' ${a} failed with error: `,g,"url: ",o,"request:",r),g}))}Ho(e,t,r,i,s,a){return this.Go(e,t,r,i,s)}jo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+ug})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((i,s)=>e[s]=i)),r&&r.headers.forEach(((i,s)=>e[s]=i))}zo(e,t){const r=Hte[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}}class Xte{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const ns="WebChannelConnection";class qte extends Kte{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,i,s){const a=oR();return new Promise(((o,l)=>{const c=new u6;c.setWithCredentials(!0),c.listenOnce(h6.COMPLETE,(()=>{try{switch(c.getLastErrorCode()){case c_.NO_ERROR:const g=c.getResponseJson();nt(ns,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(g)),o(g);break;case c_.TIMEOUT:nt(ns,`RPC '${e}' ${a} timed out`),l(new ht(De.DEADLINE_EXCEEDED,"Request time out"));break;case c_.HTTP_ERROR:const m=c.getStatus();if(nt(ns,`RPC '${e}' ${a} failed with status:`,m,"response text:",c.getResponseText()),m>0){let y=c.getResponseJson();Array.isArray(y)&&(y=y[0]);const _=y?.error;if(_&&_.status&&_.message){const x=(function(b){const T=b.toLowerCase().replace(/_/g,"-");return Object.values(De).indexOf(T)>=0?T:De.UNKNOWN})(_.status);l(new ht(x,_.message))}else l(new ht(De.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new ht(De.UNAVAILABLE,"Connection failed."));break;default:Ct(9055,{l_:e,streamId:a,h_:c.getLastErrorCode(),P_:c.getLastError()})}}finally{nt(ns,`RPC '${e}' ${a} completed.`)}}));const h=JSON.stringify(i);nt(ns,`RPC '${e}' ${a} sending request:`,i),c.send(t,"POST",h,r,15)}))}T_(e,t,r){const i=oR(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=g6(),o=f6(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,t,r),l.encodeInitMessageHeaders=!0;const h=s.join("");nt(ns,`Creating RPC '${e}' stream ${i}: ${h}`,l);const g=a.createWebChannel(h,l);this.I_(g);let m=!1,y=!1;const _=new Xte({Yo:w=>{y?nt(ns,`Not sending because RPC '${e}' stream ${i} is closed:`,w):(m||(nt(ns,`Opening RPC '${e}' stream ${i} transport.`),g.open(),m=!0),nt(ns,`RPC '${e}' stream ${i} sending:`,w),g.send(w))},Zo:()=>g.close()}),x=(w,b,T)=>{w.listen(b,(k=>{try{T(k)}catch(L){setTimeout((()=>{throw L}),0)}}))};return x(g,Rm.EventType.OPEN,(()=>{y||(nt(ns,`RPC '${e}' stream ${i} transport opened.`),_.o_())})),x(g,Rm.EventType.CLOSE,(()=>{y||(y=!0,nt(ns,`RPC '${e}' stream ${i} transport closed`),_.a_(),this.E_(g))})),x(g,Rm.EventType.ERROR,(w=>{y||(y=!0,pd(ns,`RPC '${e}' stream ${i} transport errored. Name:`,w.name,"Message:",w.message),_.a_(new ht(De.UNAVAILABLE,"The operation could not be completed")))})),x(g,Rm.EventType.MESSAGE,(w=>{if(!y){const b=w.data[0];Ot(!!b,16349);const T=b,k=T?.error||T[0]?.error;if(k){nt(ns,`RPC '${e}' stream ${i} received error:`,k);const L=k.status;let O=(function(A){const P=Jr[A];if(P!==void 0)return d8(P)})(L),B=k.message;O===void 0&&(O=De.INTERNAL,B="Unknown error status: "+L+" with message "+k.message),y=!0,_.a_(new ht(O,B)),g.close()}else nt(ns,`RPC '${e}' stream ${i} received:`,b),_.u_(b)}})),x(o,d6.STAT_EVENT,(w=>{w.stat===VT.PROXY?nt(ns,`RPC '${e}' stream ${i} detected buffering proxy`):w.stat===VT.NOPROXY&&nt(ns,`RPC '${e}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{_.__()}),0),_}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function Yte(){return typeof window<"u"?window:null}function __(){return typeof document<"u"?document:null}function uE(n){return new Zee(n,!0)}class W8{constructor(e,t,r=1e3,i=1.5,s=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=i,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,t-r);i>0&&nt("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const XL="PersistentStream";class H8{constructor(e,t,r,i,s,a,o,l){this.Mi=e,this.S_=r,this.b_=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new W8(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===De.RESOURCE_EXHAUSTED?(ws(t.toString()),ws("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===De.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,i])=>{this.D_===t&&this.G_(r,i)}),(r=>{e((()=>{const i=new ht(De.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)}))}))}G_(e,t){const r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{r((()=>this.listener.Xo()))})),this.stream.t_((()=>{r((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((i=>{r((()=>this.z_(i)))})),this.stream.onMessage((i=>{r((()=>++this.F_==1?this.J_(i):this.onNext(i)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return nt(XL,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(nt(XL,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Zte extends H8{constructor(e,t,r,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=ete(this.serializer,e),r=(function(s){if(!("targetChange"in s))return Ft.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?Ft.min():a.readTime?bs(a.readTime):Ft.min()})(e);return this.listener.H_(t,r)}Y_(e){const t={};t.database=tR(this.serializer),t.addTarget=(function(s,a){let o;const l=a.target;if(o=pv(l)?{documents:v8(s,l)}:{query:w8(s,l).ft},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=m8(s,a.resumeToken);const c=QT(s,a.expectedCount);c!==null&&(o.expectedCount=c)}else if(a.snapshotVersion.compareTo(Ft.min())>0){o.readTime=X0(s,a.snapshotVersion.toTimestamp());const c=QT(s,a.expectedCount);c!==null&&(o.expectedCount=c)}return o})(this.serializer,e);const r=nte(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){const t={};t.database=tR(this.serializer),t.removeTarget=e,this.q_(t)}}class Jte extends H8{constructor(e,t,r,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Ot(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ot(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Ot(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=tte(e.writeResults,e.commitTime),r=bs(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=tR(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>_v(this.serializer,r)))};this.q_(t)}}class Qte{}class ene extends Qte{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new ht(De.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,a])=>this.connection.Go(e,eR(t,r),i,s,a))).catch((s=>{throw s.name==="FirebaseError"?(s.code===De.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new ht(De.UNKNOWN,s.toString())}))}Ho(e,t,r,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,o])=>this.connection.Ho(e,eR(t,r),i,a,o,s))).catch((a=>{throw a.name==="FirebaseError"?(a.code===De.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new ht(De.UNKNOWN,a.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class tne{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(ws(t),this.aa=!1):nt("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Ed="RemoteStore";class nne{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo((a=>{r.enqueueAndForget((async()=>{jd(this)&&(nt(Ed,"Restarting streams for network reachability change."),await(async function(l){const c=nn(l);c.Ea.add(4),await G1(c),c.Ra.set("Unknown"),c.Ea.delete(4),await hE(c)})(this))}))})),this.Ra=new tne(r,i)}}async function hE(n){if(jd(n))for(const e of n.da)await e(!0)}async function G1(n){for(const e of n.da)await e(!1)}function K8(n,e){const t=nn(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Dk(t)?Ok(t):dg(t).O_()&&Lk(t,e))}function Mk(n,e){const t=nn(n),r=dg(t);t.Ia.delete(e),r.O_()&&X8(t,e),t.Ia.size===0&&(r.O_()?r.L_():jd(t)&&t.Ra.set("Unknown"))}function Lk(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ft.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}dg(n).Y_(e)}function X8(n,e){n.Va.Ue(e),dg(n).Z_(e)}function Ok(n){n.Va=new Kee({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),dg(n).start(),n.Ra.ua()}function Dk(n){return jd(n)&&!dg(n).x_()&&n.Ia.size>0}function jd(n){return nn(n).Ea.size===0}function q8(n){n.Va=void 0}async function rne(n){n.Ra.set("Online")}async function ine(n){n.Ia.forEach(((e,t)=>{Lk(n,e)}))}async function sne(n,e){q8(n),Dk(n)?(n.Ra.ha(e),Ok(n)):n.Ra.set("Unknown")}async function ane(n,e,t){if(n.Ra.set("Online"),e instanceof g8&&e.state===2&&e.cause)try{await(async function(i,s){const a=s.cause;for(const o of s.targetIds)i.Ia.has(o)&&(await i.remoteSyncer.rejectListen(o,a),i.Ia.delete(o),i.Va.removeTarget(o))})(n,e)}catch(r){nt(Ed,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await bv(n,r)}else if(e instanceof y_?n.Va.Ze(e):e instanceof f8?n.Va.st(e):n.Va.tt(e),!t.isEqual(Ft.min()))try{const r=await U8(n.localStore);t.compareTo(r)>=0&&await(function(s,a){const o=s.Va.Tt(a);return o.targetChanges.forEach(((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const h=s.Ia.get(c);h&&s.Ia.set(c,h.withResumeToken(l.resumeToken,a))}})),o.targetMismatches.forEach(((l,c)=>{const h=s.Ia.get(l);if(!h)return;s.Ia.set(l,h.withResumeToken(si.EMPTY_BYTE_STRING,h.snapshotVersion)),X8(s,l);const g=new $l(h.target,l,c,h.sequenceNumber);Lk(s,g)})),s.remoteSyncer.applyRemoteEvent(o)})(n,t)}catch(r){nt(Ed,"Failed to raise snapshot:",r),await bv(n,r)}}async function bv(n,e,t){if(!Ku(e))throw e;n.Ea.add(1),await G1(n),n.Ra.set("Offline"),t||(t=()=>U8(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{nt(Ed,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await hE(n)}))}function Y8(n,e){return e().catch((t=>bv(n,t,e)))}async function z1(n){const e=nn(n),t=ju(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Jh;for(;one(e);)try{const i=await zte(e.localStore,r);if(i===null){e.Ta.length===0&&t.L_();break}r=i.batchId,lne(e,i)}catch(i){await bv(e,i)}Z8(e)&&J8(e)}function one(n){return jd(n)&&n.Ta.length<10}function lne(n,e){n.Ta.push(e);const t=ju(n);t.O_()&&t.X_&&t.ea(e.mutations)}function Z8(n){return jd(n)&&!ju(n).x_()&&n.Ta.length>0}function J8(n){ju(n).start()}async function cne(n){ju(n).ra()}async function une(n){const e=ju(n);for(const t of n.Ta)e.ea(t.mutations)}async function hne(n,e,t){const r=n.Ta.shift(),i=Ek.from(r,e,t);await Y8(n,(()=>n.remoteSyncer.applySuccessfulWrite(i))),await z1(n)}async function dne(n,e){e&&ju(n).X_&&await(async function(r,i){if((function(a){return $ee(a)&&a!==De.ABORTED})(i.code)){const s=r.Ta.shift();ju(r).B_(),await Y8(r,(()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i))),await z1(r)}})(n,e),Z8(n)&&J8(n)}async function qL(n,e){const t=nn(n);t.asyncQueue.verifyOperationInProgress(),nt(Ed,"RemoteStore received new credentials");const r=jd(t);t.Ea.add(3),await G1(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await hE(t)}async function fne(n,e){const t=nn(n);e?(t.Ea.delete(2),await hE(t)):e||(t.Ea.add(2),await G1(t),t.Ra.set("Unknown"))}function dg(n){return n.ma||(n.ma=(function(t,r,i){const s=nn(t);return s.sa(),new Zte(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(n.datastore,n.asyncQueue,{Xo:rne.bind(null,n),t_:ine.bind(null,n),r_:sne.bind(null,n),H_:ane.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),Dk(n)?Ok(n):n.Ra.set("Unknown")):(await n.ma.stop(),q8(n))}))),n.ma}function ju(n){return n.fa||(n.fa=(function(t,r,i){const s=nn(t);return s.sa(),new Jte(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:cne.bind(null,n),r_:dne.bind(null,n),ta:une.bind(null,n),na:hne.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await z1(n)):(await n.fa.stop(),n.Ta.length>0&&(nt(Ed,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class jk{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new sl,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((a=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){const a=Date.now()+r,o=new jk(e,t,a,i,s);return o.start(r),o}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ht(De.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Fk(n,e){if(ws("AsyncQueue",`${e}: ${n}`),Ku(n))return new ht(De.UNAVAILABLE,`${e}: ${n}`);throw n}class _0{static emptySet(e){return new _0(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||ft.comparator(t.key,r.key):(t,r)=>ft.comparator(t.key,r.key),this.keyedMap=Am(),this.sortedSet=new Er(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof _0)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new _0;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class YL{constructor(){this.ga=new Er(ft.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Ct(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,r)=>{e.push(r)})),e}}class q0{constructor(e,t,r,i,s,a,o,l,c){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,t,r,i,s){const a=[];return t.forEach((o=>{a.push({type:0,doc:o})})),new q0(e,t,_0.emptySet(t),a,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&nE(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}class gne{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class mne{constructor(){this.queries=ZL(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const i=nn(t),s=i.queries;i.queries=ZL(),s.forEach(((a,o)=>{for(const l of o.Sa)l.onError(r)}))})(this,new ht(De.ABORTED,"Firestore shutting down"))}}function ZL(){return new yc((n=>J6(n)),nE)}async function Q8(n,e){const t=nn(n);let r=3;const i=e.query;let s=t.queries.get(i);s?!s.ba()&&e.Da()&&(r=2):(s=new gne,r=e.Da()?0:1);try{switch(r){case 0:s.wa=await t.onListen(i,!0);break;case 1:s.wa=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(a){const o=Fk(a,`Initialization of query '${Kf(e.query)}' failed`);return void e.onError(o)}t.queries.set(i,s),s.Sa.push(e),e.va(t.onlineState),s.wa&&e.Fa(s.wa)&&Vk(t)}async function e9(n,e){const t=nn(n),r=e.query;let i=3;const s=t.queries.get(r);if(s){const a=s.Sa.indexOf(e);a>=0&&(s.Sa.splice(a,1),s.Sa.length===0?i=e.Da()?0:1:!s.ba()&&e.Da()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function pne(n,e){const t=nn(n);let r=!1;for(const i of e){const s=i.query,a=t.queries.get(s);if(a){for(const o of a.Sa)o.Fa(i)&&(r=!0);a.wa=i}}r&&Vk(t)}function yne(n,e,t){const r=nn(n),i=r.queries.get(e);if(i)for(const s of i.Sa)s.onError(t);r.queries.delete(e)}function Vk(n){n.Ca.forEach((e=>{e.next()}))}var lR,JL;(JL=lR||(lR={})).Ma="default",JL.Cache="cache";class t9{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new q0(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=q0.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==lR.Cache}}class n9{constructor(e){this.key=e}}class r9{constructor(e){this.key=e}}class xne{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=fn(),this.mutatedKeys=fn(),this.eu=Q6(e),this.tu=new _0(this.eu)}get nu(){return this.Ya}ru(e,t){const r=t?t.iu:new YL,i=t?t.tu:this.tu;let s=t?t.mutatedKeys:this.mutatedKeys,a=i,o=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(((h,g)=>{const m=i.get(h),y=V1(this.query,g)?g:null,_=!!m&&this.mutatedKeys.has(m.key),x=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations);let w=!1;m&&y?m.data.isEqual(y.data)?_!==x&&(r.track({type:3,doc:y}),w=!0):this.su(m,y)||(r.track({type:2,doc:y}),w=!0,(l&&this.eu(y,l)>0||c&&this.eu(y,c)<0)&&(o=!0)):!m&&y?(r.track({type:0,doc:y}),w=!0):m&&!y&&(r.track({type:1,doc:m}),w=!0,(l||c)&&(o=!0)),w&&(y?(a=a.add(y),s=x?s.add(h):s.delete(h)):(a=a.delete(h),s=s.delete(h)))})),this.query.limit!==null)for(;a.size>this.query.limit;){const h=this.query.limitType==="F"?a.last():a.first();a=a.delete(h.key),s=s.delete(h.key),r.track({type:1,doc:h})}return{tu:a,iu:r,Cs:o,mutatedKeys:s}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort(((h,g)=>(function(y,_){const x=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ct(20277,{Rt:w})}};return x(y)-x(_)})(h.type,g.type)||this.eu(h.doc,g.doc))),this.ou(r),i=i??!1;const o=t&&!i?this._u():[],l=this.Xa.size===0&&this.current&&!i?1:0,c=l!==this.Za;return this.Za=l,a.length!==0||c?{snapshot:new q0(this.query,e.tu,s,a,e.mutatedKeys,l===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:o}:{au:o}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new YL,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=fn(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))}));const t=[];return e.forEach((r=>{this.Xa.has(r)||t.push(new r9(r))})),this.Xa.forEach((r=>{e.has(r)||t.push(new n9(r))})),t}cu(e){this.Ya=e.Qs,this.Xa=fn();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return q0.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Bk="SyncEngine";class _ne{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class vne{constructor(e){this.key=e,this.hu=!1}}class wne{constructor(e,t,r,i,s,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new yc((o=>J6(o)),nE),this.Iu=new Map,this.Eu=new Set,this.du=new Er(ft.comparator),this.Au=new Map,this.Ru=new kk,this.Vu={},this.mu=new Map,this.fu=wd.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function Ene(n,e,t=!0){const r=c9(n);let i;const s=r.Tu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await i9(r,e,t,!0),i}async function Sne(n,e){const t=c9(n);await i9(t,e,!0,!1)}async function i9(n,e,t,r){const i=await Ute(n.localStore,Fa(e)),s=i.targetId,a=n.sharedClientState.addLocalQueryTarget(s,t);let o;return r&&(o=await bne(n,e,s,a==="current",i.resumeToken)),n.isPrimaryClient&&t&&K8(n.remoteStore,i),o}async function bne(n,e,t,r,i){n.pu=(g,m,y)=>(async function(x,w,b,T){let k=w.view.ru(b);k.Cs&&(k=await $L(x.localStore,w.query,!1).then((({documents:R})=>w.view.ru(R,k))));const L=T&&T.targetChanges.get(w.targetId),O=T&&T.targetMismatches.get(w.targetId)!=null,B=w.view.applyChanges(k,x.isPrimaryClient,L,O);return e3(x,w.targetId,B.au),B.snapshot})(n,g,m,y);const s=await $L(n.localStore,e,!0),a=new xne(e,s.Qs),o=a.ru(s.documents),l=B1.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),c=a.applyChanges(o,n.isPrimaryClient,l);e3(n,t,c.au);const h=new _ne(e,t,a);return n.Tu.set(e,h),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),c.snapshot}async function Tne(n,e,t){const r=nn(n),i=r.Tu.get(e),s=r.Iu.get(i.targetId);if(s.length>1)return r.Iu.set(i.targetId,s.filter((a=>!nE(a,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await aR(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),t&&Mk(r.remoteStore,i.targetId),cR(r,i.targetId)})).catch(Dd)):(cR(r,i.targetId),await aR(r.localStore,i.targetId,!0))}async function Rne(n,e){const t=nn(n),r=t.Tu.get(e),i=t.Iu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Mk(t.remoteStore,r.targetId))}async function Ane(n,e,t){const r=u9(n);try{const i=await(function(a,o){const l=nn(a),c=Zn.now(),h=o.reduce(((y,_)=>y.add(_.key)),fn());let g,m;return l.persistence.runTransaction("Locally write mutations","readwrite",(y=>{let _=ha(),x=fn();return l.Ns.getEntries(y,h).next((w=>{_=w,_.forEach(((b,T)=>{T.isValidDocument()||(x=x.add(b))}))})).next((()=>l.localDocuments.getOverlayedDocuments(y,_))).next((w=>{g=w;const b=[];for(const T of o){const k=zee(T,g.get(T.key).overlayedDocument);k!=null&&b.push(new xc(T.key,k,U6(k.value.mapValue),us.exists(!0)))}return l.mutationQueue.addMutationBatch(y,c,b,o)})).next((w=>{m=w;const b=w.applyToLocalDocumentSet(g,x);return l.documentOverlayCache.saveOverlays(y,w.batchId,b)}))})).then((()=>({batchId:m.batchId,changes:t8(g)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),(function(a,o,l){let c=a.Vu[a.currentUser.toKey()];c||(c=new Er(tn)),c=c.insert(o,l),a.Vu[a.currentUser.toKey()]=c})(r,i.batchId,t),await U1(r,i.changes),await z1(r.remoteStore)}catch(i){const s=Fk(i,"Failed to persist write");t.reject(s)}}async function s9(n,e){const t=nn(n);try{const r=await Bte(t.localStore,e);e.targetChanges.forEach(((i,s)=>{const a=t.Au.get(s);a&&(Ot(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?a.hu=!0:i.modifiedDocuments.size>0?Ot(a.hu,14607):i.removedDocuments.size>0&&(Ot(a.hu,42227),a.hu=!1))})),await U1(t,r,e)}catch(r){await Dd(r)}}function QL(n,e,t){const r=nn(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const i=[];r.Tu.forEach(((s,a)=>{const o=a.view.va(e);o.snapshot&&i.push(o.snapshot)})),(function(a,o){const l=nn(a);l.onlineState=o;let c=!1;l.queries.forEach(((h,g)=>{for(const m of g.Sa)m.va(o)&&(c=!0)})),c&&Vk(l)})(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function kne(n,e,t){const r=nn(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.Au.get(e),s=i&&i.key;if(s){let a=new Er(ft.comparator);a=a.insert(s,Br.newNoDocument(s,Ft.min()));const o=fn().add(s),l=new aE(Ft.min(),new Map,new Er(tn),a,o);await s9(r,l),r.du=r.du.remove(s),r.Au.delete(e),Gk(r)}else await aR(r.localStore,e,!1).then((()=>cR(r,e,t))).catch(Dd)}async function Ine(n,e){const t=nn(n),r=e.batch.batchId;try{const i=await Vte(t.localStore,e);o9(t,r,null),a9(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await U1(t,i)}catch(i){await Dd(i)}}async function Cne(n,e,t){const r=nn(n);try{const i=await(function(a,o){const l=nn(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",(c=>{let h;return l.mutationQueue.lookupMutationBatch(c,o).next((g=>(Ot(g!==null,37113),h=g.keys(),l.mutationQueue.removeMutationBatch(c,g)))).next((()=>l.mutationQueue.performConsistencyCheck(c))).next((()=>l.documentOverlayCache.removeOverlaysForBatchId(c,h,o))).next((()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,h))).next((()=>l.localDocuments.getDocuments(c,h)))}))})(r.localStore,e);o9(r,e,t),a9(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await U1(r,i)}catch(i){await Dd(i)}}function a9(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function o9(n,e,t){const r=nn(n);let i=r.Vu[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Vu[r.currentUser.toKey()]=i}}function cR(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((r=>{n.Ru.containsKey(r)||l9(n,r)}))}function l9(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(Mk(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),Gk(n))}function e3(n,e,t){for(const r of t)r instanceof n9?(n.Ru.addReference(r.key,e),Pne(n,r)):r instanceof r9?(nt(Bk,"Document no longer in limbo: "+r.key),n.Ru.removeReference(r.key,e),n.Ru.containsKey(r.key)||l9(n,r.key)):Ct(19791,{wu:r})}function Pne(n,e){const t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Eu.has(r)||(nt(Bk,"New document in limbo: "+t),n.Eu.add(r),Gk(n))}function Gk(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new ft(Bn.fromString(e)),r=n.fu.next();n.Au.set(r,new vne(t)),n.du=n.du.insert(t,r),K8(n.remoteStore,new $l(Fa(tE(t.path)),r,"TargetPurposeLimboResolution",Da.ce))}}async function U1(n,e,t){const r=nn(n),i=[],s=[],a=[];r.Tu.isEmpty()||(r.Tu.forEach(((o,l)=>{a.push(r.pu(l,e,t).then((c=>{if((c||t)&&r.isPrimaryClient){const h=c?!c.fromCache:t?.targetChanges.get(l.targetId)?.current;r.sharedClientState.updateQueryState(l.targetId,h?"current":"not-current")}if(c){i.push(c);const h=Pk.As(l.targetId,c);s.push(h)}})))})),await Promise.all(a),r.Pu.H_(i),await(async function(l,c){const h=nn(l);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",(g=>de.forEach(c,(m=>de.forEach(m.Es,(y=>h.persistence.referenceDelegate.addReference(g,m.targetId,y))).next((()=>de.forEach(m.ds,(y=>h.persistence.referenceDelegate.removeReference(g,m.targetId,y)))))))))}catch(g){if(!Ku(g))throw g;nt(Nk,"Failed to update sequence numbers: "+g)}for(const g of c){const m=g.targetId;if(!g.fromCache){const y=h.Ms.get(m),_=y.snapshotVersion,x=y.withLastLimboFreeSnapshotVersion(_);h.Ms=h.Ms.insert(m,x)}}})(r.localStore,s))}async function Nne(n,e){const t=nn(n);if(!t.currentUser.isEqual(e)){nt(Bk,"User change. New user:",e.toKey());const r=await z8(t.localStore,e);t.currentUser=e,(function(s,a){s.mu.forEach((o=>{o.forEach((l=>{l.reject(new ht(De.CANCELLED,a))}))})),s.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await U1(t,r.Ls)}}function Mne(n,e){const t=nn(n),r=t.Au.get(e);if(r&&r.hu)return fn().add(r.key);{let i=fn();const s=t.Iu.get(e);if(!s)return i;for(const a of s){const o=t.Tu.get(a);i=i.unionWith(o.view.nu)}return i}}function c9(n){const e=nn(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=s9.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Mne.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=kne.bind(null,e),e.Pu.H_=pne.bind(null,e.eventManager),e.Pu.yu=yne.bind(null,e.eventManager),e}function u9(n){const e=nn(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Ine.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Cne.bind(null,e),e}class Kp{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=uE(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return G8(this.persistence,new B8,e.initialUser,this.serializer)}Cu(e){return new Ik(cE.mi,this.serializer)}Du(e){return new $8}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Kp.provider={build:()=>new Kp};class Lne extends Kp{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Ot(this.persistence.referenceDelegate instanceof Sv,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new O8(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?as.withCacheSize(this.cacheSizeBytes):as.DEFAULT;return new Ik((r=>Sv.mi(r,t)),this.serializer)}}class One extends Kp{constructor(e,t,r){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await u9(this.xu.syncEngine),await z1(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return G8(this.persistence,new B8,e.initialUser,this.serializer)}Fu(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new O8(r,e.asyncQueue,t)}Mu(e,t){const r=new GQ(t,this.persistence);return new BQ(e.asyncQueue,r)}Cu(e){const t=Ote(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?as.withCacheSize(this.cacheSizeBytes):as.DEFAULT;return new Ck(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,Yte(),__(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new $8}}class Tv{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>QL(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=Nne.bind(null,this.syncEngine),await fne(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new mne})()}createDatastore(e){const t=uE(e.databaseInfo.databaseId),r=(function(s){return new qte(s)})(e.databaseInfo);return(function(s,a,o,l){return new ene(s,a,o,l)})(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,i,s,a,o){return new nne(r,i,s,a,o)})(this.localStore,this.datastore,e.asyncQueue,(t=>QL(this.syncEngine,t,0)),(function(){return KL.v()?new KL:new Wte})())}createSyncEngine(e,t){return(function(i,s,a,o,l,c,h){const g=new wne(i,s,a,o,l,c);return h&&(g.gu=!0),g})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const r=nn(t);nt(Ed,"RemoteStore shutting down."),r.Ea.add(5),await G1(r),r.Aa.shutdown(),r.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Tv.provider={build:()=>new Tv};class h9{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):ws("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const Fu="FirestoreClient";class Dne{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=zi.UNAUTHENTICATED,this.clientId=ck.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,(async a=>{nt(Fu,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a})),this.appCheckCredentials.start(r,(a=>(nt(Fu,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new sl;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=Fk(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function gb(n,e){n.asyncQueue.verifyOperationInProgress(),nt(Fu,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async i=>{r.isEqual(i)||(await z8(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function t3(n,e){n.asyncQueue.verifyOperationInProgress();const t=await jne(n);nt(Fu,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>qL(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,i)=>qL(e.remoteStore,i))),n._onlineComponents=e}async function jne(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){nt(Fu,"Using user provided OfflineComponentProvider");try{await gb(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(i){return i.name==="FirebaseError"?i.code===De.FAILED_PRECONDITION||i.code===De.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(t))throw t;pd("Error using user provided cache. Falling back to memory cache: "+t),await gb(n,new Kp)}}else nt(Fu,"Using default OfflineComponentProvider"),await gb(n,new Lne(void 0));return n._offlineComponents}async function d9(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(nt(Fu,"Using user provided OnlineComponentProvider"),await t3(n,n._uninitializedComponentsProvider._online)):(nt(Fu,"Using default OnlineComponentProvider"),await t3(n,new Tv))),n._onlineComponents}function Fne(n){return d9(n).then((e=>e.syncEngine))}async function f9(n){const e=await d9(n),t=e.eventManager;return t.onListen=Ene.bind(null,e.syncEngine),t.onUnlisten=Tne.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=Sne.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=Rne.bind(null,e.syncEngine),t}function Vne(n,e,t={}){const r=new sl;return n.asyncQueue.enqueueAndForget((async()=>(function(s,a,o,l,c){const h=new h9({next:m=>{h.Nu(),a.enqueueAndForget((()=>e9(s,g)));const y=m.docs.has(o);!y&&m.fromCache?c.reject(new ht(De.UNAVAILABLE,"Failed to get document because the client is offline.")):y&&m.fromCache&&l&&l.source==="server"?c.reject(new ht(De.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(m)},error:m=>c.reject(m)}),g=new t9(tE(o.path),h,{includeMetadataChanges:!0,qa:!0});return Q8(s,g)})(await f9(n),n.asyncQueue,e,t,r))),r.promise}function Bne(n,e,t={}){const r=new sl;return n.asyncQueue.enqueueAndForget((async()=>(function(s,a,o,l,c){const h=new h9({next:m=>{h.Nu(),a.enqueueAndForget((()=>e9(s,g))),m.fromCache&&l.source==="server"?c.reject(new ht(De.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(m)},error:m=>c.reject(m)}),g=new t9(o,h,{includeMetadataChanges:!0,qa:!0});return Q8(s,g)})(await f9(n),n.asyncQueue,e,t,r))),r.promise}function g9(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const n3=new Map;const m9="firestore.googleapis.com",r3=!0;class i3{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new ht(De.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=m9,this.ssl=r3}else this.host=e.host,this.ssl=e.ssl??r3;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=P8;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<xte)throw new ht(De.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}DQ("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=g9(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new ht(De.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new ht(De.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new ht(De.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class dE{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new i3({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ht(De.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ht(De.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new i3(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new RQ;switch(r.type){case"firstParty":return new CQ(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new ht(De.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=n3.get(t);r&&(nt("ComponentProvider","Removing Datastore"),n3.delete(t),r.terminate())})(this),Promise.resolve()}}function Gne(n,e,t,r={}){n=$a(n,dE);const i=Ld(e),s=n._getSettings(),a={...s,emulatorOptions:n._getEmulatorOptions()},o=`${e}:${t}`;i&&(XA(`https://${o}`),qA("Firestore",!0)),s.host!==m9&&s.host!==o&&pd("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...s,host:o,ssl:i,emulatorOptions:r};if(!dd(l,a)&&(n._setSettings(l),r.mockUserToken)){let c,h;if(typeof r.mockUserToken=="string")c=r.mockUserToken,h=zi.MOCK_USER;else{c=vF(r.mockUserToken,n._app?.options.projectId);const g=r.mockUserToken.sub||r.mockUserToken.user_id;if(!g)throw new ht(De.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new zi(g)}n._authCredentials=new AQ(new p6(c,h))}}class fg{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new fg(this.firestore,e,this._query)}}class Kr{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Iu(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Kr(this.firestore,e,this._key)}toJSON(){return{type:Kr._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(O1(t,Kr._jsonSchema))return new Kr(e,r||null,new ft(Bn.fromString(t.referencePath)))}}Kr._jsonSchemaVersion="firestore/documentReference/1.0",Kr._jsonSchema={type:ni("string",Kr._jsonSchemaVersion),referencePath:ni("string")};class Iu extends fg{constructor(e,t,r){super(e,t,tE(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Kr(this.firestore,null,new ft(e))}withConverter(e){return new Iu(this.firestore,e,this._path)}}function s3(n,e,...t){if(n=Ci(n),x6("collection","path",e),n instanceof dE){const r=Bn.fromString(e,...t);return XM(r),new Iu(n,null,r)}{if(!(n instanceof Kr||n instanceof Iu))throw new ht(De.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Bn.fromString(e,...t));return XM(r),new Iu(n.firestore,null,r)}}function v0(n,e,...t){if(n=Ci(n),arguments.length===1&&(e=ck.newId()),x6("doc","path",e),n instanceof dE){const r=Bn.fromString(e,...t);return KM(r),new Kr(n,null,new ft(r))}{if(!(n instanceof Kr||n instanceof Iu))throw new ht(De.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Bn.fromString(e,...t));return KM(r),new Kr(n.firestore,n instanceof Iu?n.converter:null,new ft(r))}}const a3="AsyncQueue";class o3{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new W8(this,"async_queue_retry"),this._c=()=>{const r=__();r&&nt(a3,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=__();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=__();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new sl;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Ku(e))throw e;nt(a3,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,ws("INTERNAL UNHANDLED ERROR: ",l3(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const i=jk.createAndSchedule(this,e,t,r,(s=>this.hc(s)));return this.tc.push(i),i}uc(){this.nc&&Ct(47125,{Pc:l3(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function l3(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class qu extends dE{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new o3,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new o3(e),this._firestoreClient=void 0,await e}}}function zne(n,e){const t=typeof n=="object"?n:JA(),r=typeof n=="string"?n:gv,i=Uw(t,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=yF("firestore");s&&Gne(i,...s)}return i}function zk(n){if(n._terminated)throw new ht(De.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||p9(n),n._firestoreClient}function p9(n){const e=n._freezeSettings(),t=(function(i,s,a,o){return new pee(i,s,a,o.host,o.ssl,o.experimentalForceLongPolling,o.experimentalAutoDetectLongPolling,g9(o.experimentalLongPollingOptions),o.useFetchStreams,o.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new Dne(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(i){const s=i?._online.build();return{_offline:i?._offline.build(s),_online:s}})(n._componentsProvider))}function Une(n,e){pd("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return $ne(n,Tv.provider,{build:r=>new One(r,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function $ne(n,e,t){if((n=$a(n,qu))._firestoreClient||n._terminated)throw new ht(De.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new ht(De.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},p9(n)}class Na{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Na(si.fromBase64String(e))}catch(t){throw new ht(De.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Na(si.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Na._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(O1(e,Na._jsonSchema))return Na.fromBase64String(e.bytes)}}Na._jsonSchemaVersion="firestore/bytes/1.0",Na._jsonSchema={type:ni("string",Na._jsonSchemaVersion),bytes:ni("string")};class fE{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new ht(De.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Pr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class gE{constructor(e){this._methodName=e}}class al{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ht(De.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ht(De.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return tn(this._lat,e._lat)||tn(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:al._jsonSchemaVersion}}static fromJSON(e){if(O1(e,al._jsonSchema))return new al(e.latitude,e.longitude)}}al._jsonSchemaVersion="firestore/geoPoint/1.0",al._jsonSchema={type:ni("string",al._jsonSchemaVersion),latitude:ni("number"),longitude:ni("number")};class ol{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0})(this._values,e._values)}toJSON(){return{type:ol._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(O1(e,ol._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new ol(e.vectorValues);throw new ht(De.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ol._jsonSchemaVersion="firestore/vectorValue/1.0",ol._jsonSchema={type:ni("string",ol._jsonSchemaVersion),vectorValues:ni("object")};const Wne=/^__.*__$/;class Hne{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new xc(e,this.data,this.fieldMask,t,this.fieldTransforms):new hg(e,this.data,t,this.fieldTransforms)}}class y9{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new xc(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function x9(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ct(40011,{Ac:n})}}class Uk{constructor(e,t,r,i,s,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Uk({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Rv(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(x9(this.Ac)&&Wne.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class Kne{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||uE(e)}Cc(e,t,r,i=!1){return new Uk({Ac:e,methodName:t,Dc:r,path:Pr.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function mE(n){const e=n._freezeSettings(),t=uE(n._databaseId);return new Kne(n._databaseId,!!e.ignoreUndefinedProperties,t)}function _9(n,e,t,r,i,s={}){const a=n.Cc(s.merge||s.mergeFields?2:0,e,t,i);Wk("Data must be an object, but it was:",a,r);const o=v9(r,a);let l,c;if(s.merge)l=new Vs(a.fieldMask),c=a.fieldTransforms;else if(s.mergeFields){const h=[];for(const g of s.mergeFields){const m=uR(e,g,t);if(!a.contains(m))throw new ht(De.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);E9(h,m)||h.push(m)}l=new Vs(h),c=a.fieldTransforms.filter((g=>l.covers(g.field)))}else l=null,c=a.fieldTransforms;return new Hne(new cs(o),l,c)}class pE extends gE{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof pE}}class $k extends gE{_toFieldTransform(e){return new l8(e.path,new W0)}isEqual(e){return e instanceof $k}}function Xne(n,e,t,r){const i=n.Cc(1,e,t);Wk("Data must be an object, but it was:",i,r);const s=[],a=cs.empty();Xu(r,((l,c)=>{const h=Hk(e,l,t);c=Ci(c);const g=i.yc(h);if(c instanceof pE)s.push(h);else{const m=$1(c,g);m!=null&&(s.push(h),a.set(h,m))}}));const o=new Vs(s);return new y9(a,o,i.fieldTransforms)}function qne(n,e,t,r,i,s){const a=n.Cc(1,e,t),o=[uR(e,r,t)],l=[i];if(s.length%2!=0)throw new ht(De.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<s.length;m+=2)o.push(uR(e,s[m])),l.push(s[m+1]);const c=[],h=cs.empty();for(let m=o.length-1;m>=0;--m)if(!E9(c,o[m])){const y=o[m];let _=l[m];_=Ci(_);const x=a.yc(y);if(_ instanceof pE)c.push(y);else{const w=$1(_,x);w!=null&&(c.push(y),h.set(y,w))}}const g=new Vs(c);return new y9(h,g,a.fieldTransforms)}function Yne(n,e,t,r=!1){return $1(t,n.Cc(r?4:3,e))}function $1(n,e){if(w9(n=Ci(n)))return Wk("Unsupported field value:",e,n),v9(n,e);if(n instanceof gE)return(function(r,i){if(!x9(i.Ac))throw i.Sc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,i){const s=[];let a=0;for(const o of r){let l=$1(o,i.wc(a));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),a++}return{arrayValue:{values:s}}})(n,e)}return(function(r,i){if((r=Ci(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Dee(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=Zn.fromDate(r);return{timestampValue:X0(i.serializer,s)}}if(r instanceof Zn){const s=new Zn(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:X0(i.serializer,s)}}if(r instanceof al)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Na)return{bytesValue:m8(i.serializer,r._byteString)};if(r instanceof Kr){const s=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(s))throw i.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Tk(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof ol)return(function(a,o){return{mapValue:{fields:{[yk]:{stringValue:xk},[G0]:{arrayValue:{values:a.toArray().map((c=>{if(typeof c!="number")throw o.Sc("VectorValues must only contain numeric values.");return vk(o.serializer,c)}))}}}}}})(r,i);throw i.Sc(`Unsupported field value: ${Kw(r)}`)})(n,e)}function v9(n,e){const t={};return L6(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Xu(n,((r,i)=>{const s=$1(i,e.mc(r));s!=null&&(t[r]=s)})),{mapValue:{fields:t}}}function w9(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Zn||n instanceof al||n instanceof Na||n instanceof Kr||n instanceof gE||n instanceof ol)}function Wk(n,e,t){if(!w9(t)||!_6(t)){const r=Kw(t);throw r==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+r)}}function uR(n,e,t){if((e=Ci(e))instanceof fE)return e._internalPath;if(typeof e=="string")return Hk(n,e);throw Rv("Field path arguments must be of type string or ",n,!1,void 0,t)}const Zne=new RegExp("[~\\*/\\[\\]]");function Hk(n,e,t){if(e.search(Zne)>=0)throw Rv(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new fE(...e.split("."))._internalPath}catch{throw Rv(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Rv(n,e,t,r,i){const s=r&&!r.isEmpty(),a=i!==void 0;let o=`Function ${e}() called with invalid data`;t&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${r}`),a&&(l+=` in document ${i}`),l+=")"),new ht(De.INVALID_ARGUMENT,o+n+l)}function E9(n,e){return n.some((t=>t.isEqual(e)))}class S9{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Kr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Jne(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Kk("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class Jne extends S9{data(){return super.data()}}function Kk(n,e){return typeof e=="string"?Hk(n,e):e instanceof fE?e._internalPath:e._delegate._internalPath}function Qne(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new ht(De.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Xk{}class ere extends Xk{}function tre(n,e,...t){let r=[];e instanceof Xk&&r.push(e),r=r.concat(t),(function(s){const a=s.filter((l=>l instanceof qk)).length,o=s.filter((l=>l instanceof yE)).length;if(a>1||a>0&&o>0)throw new ht(De.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const i of r)n=i._apply(n);return n}class yE extends ere{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new yE(e,t,r)}_apply(e){const t=this._parse(e);return b9(e._query,t),new fg(e.firestore,e.converter,ZT(e._query,t))}_parse(e){const t=mE(e.firestore);return(function(s,a,o,l,c,h,g){let m;if(c.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new ht(De.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){u3(g,h);const _=[];for(const x of g)_.push(c3(l,s,x));m={arrayValue:{values:_}}}else m=c3(l,s,g)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||u3(g,h),m=Yne(o,a,g,h==="in"||h==="not-in");return vn.create(c,h,m)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function nre(n,e,t){const r=e,i=Kk("where",n);return yE._create(i,r,t)}class qk extends Xk{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new qk(e,t)}_parse(e){const t=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return t.length===1?t[0]:Qn.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(i,s){let a=i;const o=s.getFlattenedFilters();for(const l of o)b9(a,l),a=ZT(a,l)})(e._query,t),new fg(e.firestore,e.converter,ZT(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function c3(n,e,t){if(typeof(t=Ci(t))=="string"){if(t==="")throw new ht(De.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Z6(e)&&t.indexOf("/")!==-1)throw new ht(De.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(Bn.fromString(t));if(!ft.isDocumentKey(r))throw new ht(De.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return $p(n,new ft(r))}if(t instanceof Kr)return $p(n,t._key);throw new ht(De.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Kw(t)}.`)}function u3(n,e){if(!Array.isArray(n)||n.length===0)throw new ht(De.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function b9(n,e){const t=(function(i,s){for(const a of i)for(const o of a.getFlattenedFilters())if(s.indexOf(o.op)>=0)return o.op;return null})(n.filters,(function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new ht(De.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ht(De.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class rre{convertValue(e,t="none"){switch(Ou(e)){case 0:return null;case 1:return e.booleanValue;case 2:return _r(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(lc(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ct(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return Xu(e,((i,s)=>{r[i]=this.convertValue(s,t)})),r}convertVectorValue(e){const t=e.fields?.[G0].arrayValue?.values?.map((r=>_r(r.doubleValue)));return new ol(t)}convertGeoPoint(e){return new al(_r(e.latitude),_r(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Qw(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(zp(e));default:return null}}convertTimestamp(e){const t=oc(e);return new Zn(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=Bn.fromString(e);Ot(T8(r),9688,{name:e});const i=new yd(r.get(1),r.get(3)),s=new ft(r.popFirst(5));return i.isEqual(t)||ws(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}function T9(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class Cm{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class td extends S9{constructor(e,t,r,i,s,a){super(e,t,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new v_(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(Kk("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ht(De.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=td._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}td._jsonSchemaVersion="firestore/documentSnapshot/1.0",td._jsonSchema={type:ni("string",td._jsonSchemaVersion),bundleSource:ni("string","DocumentSnapshot"),bundleName:ni("string"),bundle:ni("string")};class v_ extends td{data(e={}){return super.data(e)}}class w0{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Cm(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new v_(this._firestore,this._userDataWriter,r.key,r,new Cm(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ht(De.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map((o=>{const l=new v_(i._firestore,i._userDataWriter,o.doc.key,o.doc,new Cm(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}}))}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter((o=>s||o.type!==3)).map((o=>{const l=new v_(i._firestore,i._userDataWriter,o.doc.key,o.doc,new Cm(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);let c=-1,h=-1;return o.type!==0&&(c=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),h=a.indexOf(o.doc.key)),{type:ire(o.type),doc:l,oldIndex:c,newIndex:h}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ht(De.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=w0._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=ck.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],i=[];return this.docs.forEach((s=>{s._document!==null&&(t.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function ire(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ct(61501,{type:n})}}function sre(n){n=$a(n,Kr);const e=$a(n.firestore,qu);return Vne(zk(e),n._key).then((t=>ure(e,n,t)))}w0._jsonSchemaVersion="firestore/querySnapshot/1.0",w0._jsonSchema={type:ni("string",w0._jsonSchemaVersion),bundleSource:ni("string","QuerySnapshot"),bundleName:ni("string"),bundle:ni("string")};class R9 extends rre{constructor(e){super(),this.firestore=e}convertBytes(e){return new Na(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Kr(this.firestore,null,t)}}function are(n){n=$a(n,fg);const e=$a(n.firestore,qu),t=zk(e),r=new R9(e);return Qne(n._query),Bne(t,n._query).then((i=>new w0(e,r,n,i)))}function h3(n,e,t){n=$a(n,Kr);const r=$a(n.firestore,qu),i=T9(n.converter,e,t);return xE(r,[_9(mE(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,us.none())])}function ore(n,e,t,...r){n=$a(n,Kr);const i=$a(n.firestore,qu),s=mE(i);let a;return a=typeof(e=Ci(e))=="string"||e instanceof fE?qne(s,"updateDoc",n._key,e,t,r):Xne(s,"updateDoc",n._key,e),xE(i,[a.toMutation(n._key,us.exists(!0))])}function lre(n){return xE($a(n.firestore,qu),[new sE(n._key,us.none())])}function cre(n,e){const t=$a(n.firestore,qu),r=v0(n),i=T9(n.converter,e);return xE(t,[_9(mE(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,us.exists(!1))]).then((()=>r))}function xE(n,e){return(function(r,i){const s=new sl;return r.asyncQueue.enqueueAndForget((async()=>Ane(await Fne(r),i,s))),s.promise})(zk(n),e)}function ure(n,e,t){const r=t.docs.get(e._key),i=new R9(n);return new td(n,i,e._key,r,new Cm(t.hasPendingWrites,t.fromCache),e.converter)}function d3(){return new $k("serverTimestamp")}(function(e,t=!0){(function(i){ug=i})(Od),fd(new Mu("firestore",((r,{instanceIdentifier:i,options:s})=>{const a=r.getProvider("app").getImmediate(),o=new qu(new kQ(r.getProvider("auth-internal")),new PQ(a,r.getProvider("app-check-internal")),(function(c,h){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new ht(De.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new yd(c.options.projectId,h)})(a,i),a);return s={useFetchStreams:t,...s},o._setSettings(s),o}),"PUBLIC").setMultipleInstances(!0)),rl(UM,$M,e),rl(UM,$M,"esm2020")})();const A9="firebasestorage.googleapis.com",hre="storageBucket",dre=120*1e3,fre=600*1e3;class vl extends _l{constructor(e,t,r=0){super(mb(e),`Firebase Storage: ${t} (${mb(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,vl.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return mb(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var fl;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(fl||(fl={}));function mb(n){return"storage/"+n}function gre(){const n="An unknown error occurred, please check the error payload for server response.";return new vl(fl.UNKNOWN,n)}function mre(){return new vl(fl.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function pre(){return new vl(fl.CANCELED,"User canceled the upload/download.")}function yre(n){return new vl(fl.INVALID_URL,"Invalid URL '"+n+"'.")}function xre(n){return new vl(fl.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function f3(n){return new vl(fl.INVALID_ARGUMENT,n)}function k9(){return new vl(fl.APP_DELETED,"The Firebase app was deleted.")}function _re(n){return new vl(fl.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}class go{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=go.makeFromUrl(e,t)}catch{return new go(e,"")}if(r.path==="")return r;throw xre(e)}static makeFromUrl(e,t){let r=null;const i="([A-Za-z0-9.\\-_]+)";function s(L){L.path.charAt(L.path.length-1)==="/"&&(L.path_=L.path_.slice(0,-1))}const a="(/(.*))?$",o=new RegExp("^gs://"+i+a,"i"),l={bucket:1,path:3};function c(L){L.path_=decodeURIComponent(L.path)}const h="v[A-Za-z0-9_]+",g=t.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",y=new RegExp(`^https?://${g}/${h}/b/${i}/o${m}`,"i"),_={bucket:1,path:3},x=t===A9?"(?:storage.googleapis.com|storage.cloud.google.com)":t,w="([^?#]*)",b=new RegExp(`^https?://${x}/${i}/${w}`,"i"),k=[{regex:o,indices:l,postModify:s},{regex:y,indices:_,postModify:c},{regex:b,indices:{bucket:1,path:2},postModify:c}];for(let L=0;L<k.length;L++){const O=k[L],B=O.regex.exec(e);if(B){const R=B[O.indices.bucket];let A=B[O.indices.path];A||(A=""),r=new go(R,A),O.postModify(r);break}}if(r==null)throw yre(e);return r}}class vre{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function wre(n,e,t){let r=1,i=null,s=null,a=!1,o=0;function l(){return o===2}let c=!1;function h(...w){c||(c=!0,e.apply(null,w))}function g(w){i=setTimeout(()=>{i=null,n(y,l())},w)}function m(){s&&clearTimeout(s)}function y(w,...b){if(c){m();return}if(w){m(),h.call(null,w,...b);return}if(l()||a){m(),h.call(null,w,...b);return}r<64&&(r*=2);let k;o===1?(o=2,k=0):k=(r+Math.random())*1e3,g(k)}let _=!1;function x(w){_||(_=!0,m(),!c&&(i!==null?(w||(o=2),clearTimeout(i),g(0)):w||(o=1)))}return g(0),s=setTimeout(()=>{a=!0,x(!0)},t),x}function Ere(n){n(!1)}function Sre(n){return n!==void 0}function g3(n,e,t,r){if(r<e)throw f3(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw f3(`Invalid value for '${n}'. Expected ${t} or less.`)}function bre(n){const e=encodeURIComponent;let t="?";for(const r in n)if(n.hasOwnProperty(r)){const i=e(r)+"="+e(n[r]);t=t+i+"&"}return t=t.slice(0,-1),t}var Av;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(Av||(Av={}));function Tre(n,e){const t=n>=500&&n<600,i=[408,429].indexOf(n)!==-1,s=e.indexOf(n)!==-1;return t||i||s}class Rre{constructor(e,t,r,i,s,a,o,l,c,h,g,m=!0,y=!1){this.url_=e,this.method_=t,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=a,this.callback_=o,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=h,this.connectionFactory_=g,this.retry=m,this.isUsingEmulator=y,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((_,x)=>{this.resolve_=_,this.reject_=x,this.start_()})}start_(){const e=(r,i)=>{if(i){r(!1,new Lx(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const a=o=>{const l=o.loaded,c=o.lengthComputable?o.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&s.addUploadProgressListener(a),s.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(a),this.pendingConnection_=null;const o=s.getErrorCode()===Av.NO_ERROR,l=s.getStatus();if(!o||Tre(l,this.additionalRetryCodes_)&&this.retry){const h=s.getErrorCode()===Av.ABORT;r(!1,new Lx(!1,null,h));return}const c=this.successCodes_.indexOf(l)!==-1;r(!0,new Lx(c,s))})},t=(r,i)=>{const s=this.resolve_,a=this.reject_,o=i.connection;if(i.wasSuccessCode)try{const l=this.callback_(o,o.getResponse());Sre(l)?s(l):s()}catch(l){a(l)}else if(o!==null){const l=gre();l.serverResponse=o.getErrorText(),this.errorCallback_?a(this.errorCallback_(o,l)):a(l)}else if(i.canceled){const l=this.appDelete_?k9():pre();a(l)}else{const l=mre();a(l)}};this.canceled_?t(!1,new Lx(!1,null,!0)):this.backoffId_=wre(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&Ere(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Lx{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}}function Are(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function kre(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function Ire(n,e){e&&(n["X-Firebase-GMPID"]=e)}function Cre(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function Pre(n,e,t,r,i,s,a=!0,o=!1){const l=bre(n.urlParams),c=n.url+l,h=Object.assign({},n.headers);return Ire(h,e),Are(h,t),kre(h,s),Cre(h,r),new Rre(c,n.method,h,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i,a,o)}function Nre(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function Mre(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}class kv{constructor(e,t){this._service=e,t instanceof go?this._location=t:this._location=go.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new kv(e,t)}get root(){const e=new go(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Mre(this._location.path)}get storage(){return this._service}get parent(){const e=Nre(this._location.path);if(e===null)return null;const t=new go(this._location.bucket,e);return new kv(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw _re(e)}}function m3(n,e){const t=e?.[hre];return t==null?null:go.makeFromBucketSpec(t,n)}function Lre(n,e,t,r={}){n.host=`${e}:${t}`;const i=Ld(e);i&&(XA(`https://${n.host}/b`),qA("Storage",!0)),n._isUsingEmulator=!0,n._protocol=i?"https":"http";const{mockUserToken:s}=r;s&&(n._overrideAuthToken=typeof s=="string"?s:vF(s,n.app.options.projectId))}class Ore{constructor(e,t,r,i,s,a=!1){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._isUsingEmulator=a,this._bucket=null,this._host=A9,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=dre,this._maxUploadRetryTime=fre,this._requests=new Set,i!=null?this._bucket=go.makeFromBucketSpec(i,this._host):this._bucket=m3(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=go.makeFromBucketSpec(this._url,e):this._bucket=m3(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){g3("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){g3("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(ca(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new kv(this,e)}_makeRequest(e,t,r,i,s=!0){if(this._deleted)return new vre(k9());{const a=Pre(e,this._appId,r,i,t,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}async makeRequestWithTokens(e,t){const[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,i).getPromise()}}const p3="@firebase/storage",y3="0.14.0";const I9="storage";function Dre(n=JA(),e){n=Ci(n);const r=Uw(n,I9).getImmediate({identifier:e}),i=yF("storage");return i&&jre(r,...i),r}function jre(n,e,t,r={}){Lre(n,e,t,r)}function Fre(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new Ore(t,r,i,e,Od)}function Vre(){fd(new Mu(I9,Fre,"PUBLIC").setMultipleInstances(!0)),rl(p3,y3,""),rl(p3,y3,"esm2020")}Vre();const Bre={apiKey:"AIzaSyBcLuKvUr5XqEJTwOf9I0hqJ1o9g3kOZ-g",authDomain:"detectorapp-nl.firebaseapp.com",projectId:"detectorapp-nl",storageBucket:"detectorapp-nl.firebasestorage.app",messagingSenderId:"110954177210",appId:"1:110954177210:web:d77c9ed262ad92bc431883"},Yk=AF(Bre),Hh=EQ(Yk),yu=zne(Yk);Dre(Yk);Une(yu).catch(n=>{n.code==="failed-precondition"?console.warn("Offline persistence failed: Multiple tabs open"):n.code==="unimplemented"&&console.warn("Offline persistence not available in this browser")});const Gre={};function zre(n,e){let t;try{t=n()}catch{return}return{getItem:i=>{var s;const a=l=>l===null?null:JSON.parse(l,void 0),o=(s=t.getItem(i))!=null?s:null;return o instanceof Promise?o.then(a):a(o)},setItem:(i,s)=>t.setItem(i,JSON.stringify(s,void 0)),removeItem:i=>t.removeItem(i)}}const Xp=n=>e=>{try{const t=n(e);return t instanceof Promise?t:{then(r){return Xp(r)(t)},catch(r){return this}}}catch(t){return{then(r){return this},catch(r){return Xp(r)(t)}}}},Ure=(n,e)=>(t,r,i)=>{let s={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:w=>w,version:0,merge:(w,b)=>({...b,...w}),...e},a=!1;const o=new Set,l=new Set;let c;try{c=s.getStorage()}catch{}if(!c)return n((...w)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(...w)},r,i);const h=Xp(s.serialize),g=()=>{const w=s.partialize({...r()});let b;const T=h({state:w,version:s.version}).then(k=>c.setItem(s.name,k)).catch(k=>{b=k});if(b)throw b;return T},m=i.setState;i.setState=(w,b)=>{m(w,b),g()};const y=n((...w)=>{t(...w),g()},r,i);let _;const x=()=>{var w;if(!c)return;a=!1,o.forEach(T=>T(r()));const b=((w=s.onRehydrateStorage)==null?void 0:w.call(s,r()))||void 0;return Xp(c.getItem.bind(c))(s.name).then(T=>{if(T)return s.deserialize(T)}).then(T=>{if(T)if(typeof T.version=="number"&&T.version!==s.version){if(s.migrate)return s.migrate(T.state,T.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return T.state}).then(T=>{var k;return _=s.merge(T,(k=r())!=null?k:y),t(_,!0),g()}).then(()=>{b?.(_,void 0),a=!0,l.forEach(T=>T(_))}).catch(T=>{b?.(void 0,T)})};return i.persist={setOptions:w=>{s={...s,...w},w.getStorage&&(c=w.getStorage())},clearStorage:()=>{c?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>x(),hasHydrated:()=>a,onHydrate:w=>(o.add(w),()=>{o.delete(w)}),onFinishHydration:w=>(l.add(w),()=>{l.delete(w)})},x(),_||y},$re=(n,e)=>(t,r,i)=>{let s={storage:zre(()=>localStorage),partialize:x=>x,version:0,merge:(x,w)=>({...w,...x}),...e},a=!1;const o=new Set,l=new Set;let c=s.storage;if(!c)return n((...x)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(...x)},r,i);const h=()=>{const x=s.partialize({...r()});return c.setItem(s.name,{state:x,version:s.version})},g=i.setState;i.setState=(x,w)=>{g(x,w),h()};const m=n((...x)=>{t(...x),h()},r,i);i.getInitialState=()=>m;let y;const _=()=>{var x,w;if(!c)return;a=!1,o.forEach(T=>{var k;return T((k=r())!=null?k:m)});const b=((w=s.onRehydrateStorage)==null?void 0:w.call(s,(x=r())!=null?x:m))||void 0;return Xp(c.getItem.bind(c))(s.name).then(T=>{if(T)if(typeof T.version=="number"&&T.version!==s.version){if(s.migrate)return[!0,s.migrate(T.state,T.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,T.state];return[!1,void 0]}).then(T=>{var k;const[L,O]=T;if(y=s.merge(O,(k=r())!=null?k:m),t(y,!0),L)return h()}).then(()=>{b?.(y,void 0),y=r(),a=!0,l.forEach(T=>T(y))}).catch(T=>{b?.(void 0,T)})};return i.persist={setOptions:x=>{s={...s,...x},x.storage&&(c=x.storage)},clearStorage:()=>{c?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>_(),hasHydrated:()=>a,onHydrate:x=>(o.add(x),()=>{o.delete(x)}),onFinishHydration:x=>(l.add(x),()=>{l.delete(x)})},s.skipHydration||_(),y||m},Wre=(n,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((Gre?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),Ure(n,e)):$re(n,e),bo=Wre,dn=qi()(bo(n=>({defaultBackground:"CartoDB (licht)",showScaleBar:!0,gpsAutoStart:!1,showAccuracyCircle:!0,hapticFeedback:!0,vondstenLocalOnly:!0,showVondstButton:!1,showRouteRecordButton:!1,showLocalVondsten:!0,showCustomPointLayers:!0,fontScale:100,layerPanelFontScale:100,presetPanelFontScale:100,menuFontScale:100,voiceFeedbackEnabled:!1,showStepCounter:!1,showFontSliders:!1,showWeatherButton:!1,setDefaultBackground:e=>n({defaultBackground:e}),setShowScaleBar:e=>n({showScaleBar:e}),setGpsAutoStart:e=>n({gpsAutoStart:e}),setShowAccuracyCircle:e=>n({showAccuracyCircle:e}),setHapticFeedback:e=>n({hapticFeedback:e}),setVondstenLocalOnly:e=>n({vondstenLocalOnly:e}),setShowVondstButton:e=>n({showVondstButton:e}),setShowRouteRecordButton:e=>n({showRouteRecordButton:e}),setShowLocalVondsten:e=>n({showLocalVondsten:e}),setShowCustomPointLayers:e=>n({showCustomPointLayers:e}),setFontScale:e=>n({fontScale:e}),setLayerPanelFontScale:e=>n({layerPanelFontScale:e}),setPresetPanelFontScale:e=>n({presetPanelFontScale:e}),setMenuFontScale:e=>n({menuFontScale:e}),setVoiceFeedbackEnabled:e=>n({voiceFeedbackEnabled:e}),setShowStepCounter:e=>n({showStepCounter:e}),setShowFontSliders:e=>n({showFontSliders:e}),setShowWeatherButton:e=>n({showWeatherButton:e})}),{name:"detectorapp-settings",version:2,migrate:(n,e)=>e<2?{...n,showScaleBar:!0}:n})),_E=qi()(lg((n,e)=>({user:null,accessToken:null,loading:!1,error:null,initialized:!1,setUser:t=>{n(r=>{r.user=t,r.loading=!1})},setLoading:t=>{n(r=>{r.loading=t})},setError:t=>{n(r=>{r.error=t})},setAccessToken:t=>{n(r=>{r.accessToken=t})},signInWithGoogle:async()=>{n(t=>{t.loading=!0,t.error=null});try{const t=new co;await LM(Hh,t)}catch(t){console.error("Google sign-in error:",t),n(r=>{r.error=t.message,r.loading=!1})}},connectGoogleFit:async()=>{n(t=>{t.loading=!0,t.error=null});try{const t=new co;t.addScope("https://www.googleapis.com/auth/fitness.activity.read");const r=await LM(Hh,t),i=co.credentialFromResult(r);return i?.accessToken?(n(s=>{s.accessToken=i.accessToken||null,s.loading=!1}),console.log(" Google Fit gekoppeld"),!0):(n(s=>{s.loading=!1}),!1)}catch(t){return console.error("Google Fit connect error:",t),n(r=>{r.error=t.message,r.loading=!1}),!1}},logout:async()=>{n(t=>{t.loading=!0});try{await ZF(Hh),n(t=>{t.accessToken=null})}catch(t){console.error("Logout error:",t),n(r=>{r.error=t.message,r.loading=!1})}},initAuth:()=>{e().initialized||(n(t=>{t.initialized=!0}),YF(Hh,t=>{n(r=>{r.user=t,r.loading=!1}),t&&dn.getState().setVondstenLocalOnly(!1)}))}})));qi()(lg((n,e)=>({vondsten:[],loading:!1,error:null,loadVondsten:async t=>{n(r=>{r.loading=!0});try{const r=tre(s3(yu,"vondsten"),nre("userId","==",t)),s=(await are(r)).docs.map(a=>({id:a.id,...a.data()}));n(a=>{a.vondsten=s,a.loading=!1})}catch(r){n(i=>{i.error=r.message,i.loading=!1})}},addVondst:async t=>{const r=new Date().toISOString(),i={...t,createdAt:r,updatedAt:r},s=await cre(s3(yu,"vondsten"),i);return n(a=>{a.vondsten.push({...i,id:s.id})}),s.id},updateVondst:async(t,r)=>{const i=v0(yu,"vondsten",t);await ore(i,{...r,updatedAt:new Date().toISOString()}),n(s=>{const a=s.vondsten.findIndex(o=>o.id===t);a!==-1&&(s.vondsten[a]={...s.vondsten[a],...r})})},deleteVondst:async t=>{await lre(v0(yu,"vondsten",t)),n(r=>{r.vondsten=r.vondsten.filter(i=>i.id!==t)})}})));const pb=[{id:"detectie",name:"Detectie",icon:"Compass",layers:["AMK Monumenten","Gewaspercelen"],baseLayer:"CartoDB (licht)",isBuiltIn:!1},{id:"steentijd",name:"Steentijd",icon:"Mountain",layers:["Hunebedden","Grafheuvels","Terpen","FAMKE Steentijd","AMK Steentijd","AHN4 Multi-Hillshade NL","Labels Overlay"],baseLayer:"Luchtfoto",isBuiltIn:!1},{id:"romeins-midvroeg",name:"Romeins - Mid vroeg",icon:"Layers",layers:["Romeinse wegen (regio)","Romeinse Forten","Romeinse Forten Lijnen","AMK Romeins","AMK Vroege ME","Gewaspercelen","Kadastrale Grenzen"],isBuiltIn:!1},{id:"midlaat-nieuwetijd",name:"Mid laat - Nieuwe tijd",icon:"Grid",layers:["AMK Late ME","Kastelen","Essen","Rijksmonumenten","Gewaspercelen","Kadastrale Grenzen","Oude Kernen"],isBuiltIn:!1},{id:"woii-militair",name:"WOII & Militair",icon:"Target",layers:["WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Inundatiegebieden","Militaire Objecten"],isBuiltIn:!1},{id:"analyse",name:"Terrein Analyse",icon:"Search",layers:["IKAW","Geomorfologie","Bodemkaart","Archeo Landschappen","AHN4 Multi-Hillshade NL","AHN4 Hoogtekaart Kleur"],isBuiltIn:!1}],x3=["Labels Overlay","TMK 1850","Bonnebladen 1900","Hunebedden","FAMKE Steentijd","Grafheuvels","Terpen","AMK Monumenten","AMK Romeins","AMK Steentijd","AMK Vroege ME","AMK Late ME","AMK Overig","Romeinse wegen (regio)","Romeinse wegen (Wereld)","Romeinse Forten","Romeinse Forten Lijnen","Kastelen","IKAW","Archeo Landschappen","Rijksmonumenten","Werelderfgoed","Religieus Erfgoed","Essen","WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Inundatiegebieden","Militaire Objecten","Paleokaart 800 n.Chr.","Paleokaart 100 n.Chr.","Paleokaart 500 v.Chr.","Paleokaart 1500 v.Chr.","Paleokaart 2750 v.Chr.","Paleokaart 5500 v.Chr.","Paleokaart 9000 v.Chr.","UIKAV Punten","UIKAV Vlakken","UIKAV Expert","UIKAV Buffer","UIKAV Indeling","AHN4 Hoogtekaart Kleur","AHN4 Hillshade NL","AHN4 Multi-Hillshade NL","AHN 0.5m","Veengebieden","Geomorfologie","Bodemkaart","Fossielen Nederland","Fossielen Belgi","Fossielen Duitsland","Fossielen Frankrijk","Parken","Speeltuinen","Musea","Strandjes","Kringloopwinkels","Gewaspercelen","Kadastrale Grenzen","Scheepswrakken","Woonheuvels ZH","Windmolens","Erfgoedlijnen","Oude Kernen","Relictenkaart Punten","Relictenkaart Lijnen","Relictenkaart Vlakken","Verdronken Dorpen"],C9=qi()(bo((n,e)=>({presets:[...pb],applyPreset:t=>{const r=e().presets.find(s=>s.id===t);if(!r)return;const i=Ti.getState();x3.forEach(s=>i.setLayerVisibility(s,!1)),r.layers.forEach(s=>i.setLayerVisibility(s,!0)),r.baseLayer&&["CartoDB (licht)","OpenStreetMap","Luchtfoto","TMK 1850","Bonnebladen 1900"].forEach(a=>{i.setLayerVisibility(a,a===r.baseLayer)}),console.log(` Preset toegepast: ${r.name}${r.baseLayer?` (${r.baseLayer})`:""}`)},createPreset:(t,r)=>{const i=Ti.getState(),s=Object.entries(i.visible).filter(([o,l])=>l&&x3.includes(o)).map(([o])=>o),a={id:`custom-${Date.now()}`,name:t,icon:r,layers:s,isBuiltIn:!1};n(o=>({presets:[...o.presets,a]})),console.log(` Preset aangemaakt: ${t} met ${s.length} lagen`)},updatePreset:(t,r)=>{n(i=>({presets:i.presets.map(s=>s.id===t?{...s,...r}:s)}))},deletePreset:t=>{n(r=>({presets:r.presets.filter(i=>i.id!==t||i.isBuiltIn)}))},resetToDefaults:()=>{n({presets:[...pb]})}}),{name:"detectorapp-presets",version:9,migrate:(n,e)=>e<9?{presets:[...pb]}:n})),_3=["#ef4444","#f97316","#eab308","#22c55e","#06b6d4","#3b82f6","#8b5cf6","#ec4899"],W1=qi()(bo((n,e)=>({layers:[],addLayer:t=>{const r=crypto.randomUUID(),i=e().layers.length,s=_3[i%_3.length];return n(a=>({layers:[...a.layers,{...t,id:r,createdAt:new Date().toISOString(),color:t.color||s,visible:t.visible??!0,opacity:t.opacity??1}]})),r},removeLayer:t=>n(r=>({layers:r.layers.filter(i=>i.id!==t)})),updateLayer:(t,r)=>n(i=>({layers:i.layers.map(s=>s.id===t?{...s,...r}:s)})),toggleVisibility:t=>n(r=>({layers:r.layers.map(i=>i.id===t?{...i,visible:!i.visible}:i)})),setOpacity:(t,r)=>n(i=>({layers:i.layers.map(s=>s.id===t?{...s,opacity:r}:s)})),setColor:(t,r)=>n(i=>({layers:i.layers.map(s=>s.id===t?{...s,color:r}:s)})),clearAll:()=>n({layers:[]})}),{name:"detectorapp-custom-layers",version:1})),Hre=["CartoDB (licht)","OpenStreetMap","Luchtfoto","Labels Overlay","Mijn Vondsten"],Zk=qi()(bo((n,e)=>({tier:"free",unlockedRegions:["nl"],devMode:!0,setTier:t=>n({tier:t}),unlockRegion:t=>n(r=>({unlockedRegions:r.unlockedRegions.includes(t)?r.unlockedRegions:[...r.unlockedRegions,t]})),lockRegion:t=>n(r=>({unlockedRegions:r.unlockedRegions.filter(i=>i!==t)})),setDevMode:t=>n({devMode:t}),isRegionUnlocked:t=>{const r=e();return r.devMode||r.tier==="pro"?!0:r.unlockedRegions.includes(t)},isLayerUnlocked:(t,r="free",i=["nl"])=>{const s=e();return s.devMode||Hre.includes(t)||r==="free"||s.tier==="pro"?!0:s.tier==="premium"?i.some(a=>s.unlockedRegions.includes(a)):!1},canAccessPremiumFeatures:()=>{const t=e();return t.devMode||t.tier!=="free"}}),{name:"detectorapp-subscription",version:1}));qi()(bo(n=>({parkingLocation:null,showParkingButton:!0,setParkingLocation:e=>n({parkingLocation:e}),clearParkingLocation:()=>n({parkingLocation:null}),setShowParkingButton:e=>n({showParkingButton:e})}),{name:"detectorapp-parking"}));function v3(){return new Date().toISOString().split("T")[0]}qi()(bo((n,e)=>({steps:0,distance:0,startTime:null,isActive:!1,todaySteps:0,todayDate:v3(),stepLength:.75,incrementStep:()=>{const t=e(),r=v3(),i=t.todayDate===r?t.todaySteps+1:1;n({steps:t.steps+1,distance:(t.steps+1)*t.stepLength,todaySteps:i,todayDate:r})},resetSession:()=>{n({steps:0,distance:0,startTime:null})},setActive:t=>{n({isActive:t,startTime:t?Date.now():e().startTime})},setStepLength:t=>{const r=e();n({stepLength:t,distance:r.steps*t})}}),{name:"step-counter-storage",partialize:n=>({todaySteps:n.todaySteps,todayDate:n.todayDate,stepLength:n.stepLength})}));const w3={sunAzimuth:315,sunElevation:45,verticalExaggeration:2,colorRamp:"terrain",minElevation:-5,maxElevation:50,showControls:!1};qi()(bo(n=>({...w3,setSunAzimuth:e=>n({sunAzimuth:e}),setSunElevation:e=>n({sunElevation:e}),setVerticalExaggeration:e=>n({verticalExaggeration:e}),setColorRamp:e=>n({colorRamp:e}),setMinElevation:e=>n({minElevation:e}),setMaxElevation:e=>n({maxElevation:e}),setShowControls:e=>n({showControls:e}),resetToDefaults:()=>n(w3)}),{name:"detectorapp-hillshade"}));const Kre=()=>Math.random().toString(36).substring(2,9),Xre={0:"Helder",1:"Overwegend helder",2:"Halfbewolkt",3:"Bewolkt",45:"Mist",48:"Rijp/mist",51:"Lichte motregen",53:"Motregen",55:"Dichte motregen",56:"Lichte ijzel",57:"Ijzel",61:"Lichte regen",63:"Regen",65:"Hevige regen",66:"Lichte ijsregen",67:"IJsregen",71:"Lichte sneeuw",73:"Sneeuw",75:"Hevige sneeuw",77:"Korrelsneeuw",80:"Lichte buien",81:"Buien",82:"Hevige buien",85:"Lichte sneeuwbuien",86:"Sneeuwbuien",95:"Onweer",96:"Onweer met hagel",99:"Zwaar onweer met hagel"};function qre(n){const e=["N","NNO","NO","ONO","O","OZO","ZO","ZZO","Z","ZZW","ZW","WZW","W","WNW","NW","NNW"],t=Math.round(n/22.5)%16;return e[t]}const Zm=qi()(bo((n,e)=>({weatherData:null,isLoading:!1,error:null,savedLocations:[{id:"current",name:"Huidige locatie",lat:0,lon:0,isCurrentLocation:!0}],selectedLocationId:"current",weatherPanelOpen:!1,showBuienradar:!1,setWeatherData:t=>n({weatherData:t}),setIsLoading:t=>n({isLoading:t}),setError:t=>n({error:t}),addLocation:t=>n(r=>({savedLocations:[...r.savedLocations,{...t,id:Kre()}]})),removeLocation:t=>n(r=>({savedLocations:r.savedLocations.filter(i=>i.id!==t),selectedLocationId:r.selectedLocationId===t?"current":r.selectedLocationId})),setSelectedLocation:t=>n({selectedLocationId:t}),updateCurrentLocation:(t,r)=>n(i=>({savedLocations:i.savedLocations.map(s=>s.isCurrentLocation?{...s,lat:t,lon:r}:s)})),toggleWeatherPanel:()=>n(t=>({weatherPanelOpen:!t.weatherPanelOpen})),setWeatherPanelOpen:t=>n({weatherPanelOpen:t}),setShowBuienradar:t=>n({showBuienradar:t}),fetchWeather:async(t,r)=>{const{setIsLoading:i,setError:s,setWeatherData:a,savedLocations:o,selectedLocationId:l}=e();i(!0),s(null);try{const c=new URL("https://api.open-meteo.com/v1/forecast");c.searchParams.set("latitude",t.toString()),c.searchParams.set("longitude",r.toString()),c.searchParams.set("current","temperature_2m,relative_humidity_2m,apparent_temperature,precipitation,weather_code,wind_speed_10m,wind_direction_10m,wind_gusts_10m,cloud_cover,is_day,snow_depth"),c.searchParams.set("hourly","temperature_2m,precipitation,precipitation_probability,weather_code,wind_speed_10m,wind_direction_10m,relative_humidity_2m"),c.searchParams.set("daily","weather_code,temperature_2m_max,temperature_2m_min,precipitation_sum,precipitation_probability_max,wind_speed_10m_max,sunrise,sunset"),c.searchParams.set("minutely_15","precipitation"),c.searchParams.set("timezone","Europe/Amsterdam"),c.searchParams.set("forecast_days","7"),c.searchParams.set("past_days","7");const h=await fetch(c.toString());if(!h.ok)throw new Error("Kon weerdata niet ophalen");const g=await h.json();let m=0;const y=g.daily.temperature_2m_min||[],_=new Date().toISOString().split("T")[0],x=g.daily.time.indexOf(_);for(let P=x-1;P>=0&&y[P]<0;P--)m++;const w=o.find(P=>P.id===l)||o[0],b=new Date,T=[],k=[];if(g.minutely_15?.time&&g.minutely_15?.precipitation){const P=new Date(b.getTime()+72e5),D=new Date(b.getTime()+2880*60*1e3);for(let N=0;N<g.minutely_15.time.length;N++){const G=new Date(g.minutely_15.time[N]);G<b||(G<=P&&T.push({time:g.minutely_15.time[N],precipitation:g.minutely_15.precipitation[N]}),G<=D&&k.push({time:g.minutely_15.time[N],precipitation:g.minutely_15.precipitation[N]}))}}const L=b.getHours(),O=b.toISOString().split("T")[0],B=g.hourly.time.map((P,D)=>({time:P,temperature:g.hourly.temperature_2m[D],precipitation:g.hourly.precipitation[D],precipitationProbability:g.hourly.precipitation_probability[D],weatherCode:g.hourly.weather_code[D],windSpeed:g.hourly.wind_speed_10m[D],windDirection:g.hourly.wind_direction_10m[D],humidity:g.hourly.relative_humidity_2m[D]})).filter(P=>new Date(P.time)>=b).slice(0,24),R=g.daily.time.map((P,D)=>({date:P,temperatureMax:g.daily.temperature_2m_max[D],temperatureMin:g.daily.temperature_2m_min[D],precipitationSum:g.daily.precipitation_sum[D],precipitationProbability:g.daily.precipitation_probability_max[D],weatherCode:g.daily.weather_code[D],windSpeedMax:g.daily.wind_speed_10m_max[D],sunrise:g.daily.sunrise[D],sunset:g.daily.sunset[D]})).filter(P=>P.date>=O),A={location:{...w,lat:t,lon:r},current:{temperature:g.current.temperature_2m,apparentTemperature:g.current.apparent_temperature,humidity:g.current.relative_humidity_2m,precipitation:g.current.precipitation,weatherCode:g.current.weather_code,windSpeed:g.current.wind_speed_10m,windDirection:g.current.wind_direction_10m,windGusts:g.current.wind_gusts_10m,cloudCover:g.current.cloud_cover,isDay:g.current.is_day===1,snowDepth:g.current.snow_depth},hourly:B,daily:R,precipitation15min:T,precipitation48h:k,frostDays:m,lastUpdated:Date.now()};try{const P=new URL("https://air-quality-api.open-meteo.com/v1/air-quality");P.searchParams.set("latitude",t.toString()),P.searchParams.set("longitude",r.toString()),P.searchParams.set("current","grass_pollen,birch_pollen,alder_pollen,mugwort_pollen,ragweed_pollen,olive_pollen");const D=await fetch(P.toString());if(D.ok){const N=await D.json();if(N.current){const G=j=>Math.min(5,Math.round(j/20));A.pollen={grass:G(N.current.grass_pollen||0),birch:G(N.current.birch_pollen||0),alder:G(N.current.alder_pollen||0),mugwort:G(N.current.mugwort_pollen||0),ragweed:G(N.current.ragweed_pollen||0),olive:G(N.current.olive_pollen||0)}}}}catch{}a(A)}catch(c){s(c instanceof Error?c.message:"Onbekende fout")}finally{i(!1)}}}),{name:"detectorapp-weather",partialize:n=>({savedLocations:n.savedLocations,selectedLocationId:n.selectedLocationId,showBuienradar:n.showBuienradar})}));function Yre({target:n,viewOptions:e}){const t=H.useRef(null),r=H.useRef(null),i=Xr(a=>a.setMap),s=dn(a=>a.showScaleBar);return H.useEffect(()=>{if(!t.current){const a={center:[5.1214,52.0907],zoom:8,rotation:0,minZoom:3,maxZoom:19,...e},o=new yq({target:n,controls:[],view:new Zo({center:Ir(a.center),zoom:a.zoom,rotation:a.rotation,minZoom:a.minZoom,maxZoom:a.maxZoom})});t.current=o,i(o),window.__olMap=o}return()=>{t.current&&(t.current.setTarget(void 0),i(null),window.__olMap=null)}},[n,e,i]),H.useEffect(()=>{const a=t.current;a&&(s?r.current||(r.current=new vq({units:"metric",bar:!1,text:!0,minWidth:80}),a.addControl(r.current)):r.current&&(a.removeControl(r.current),r.current=null))},[s]),t.current}const E3=["CartoDB (licht)","OpenStreetMap","Luchtfoto","TMK 1850","Bonnebladen 1900"];function Zre(){const n=H.useRef(null),e=H.useRef(!1);Yre({target:"map"});const t=Xr(g=>g.map),r=Ti(g=>g.registerLayer),i=Ti(g=>g.setLayerVisibility),s=dn(g=>g.defaultBackground);H.useEffect(()=>{if(!t){console.warn(" Map not initialized yet");return}console.log(" Initializing map layers...");const g=new iu({properties:{title:"OpenStreetMap",type:"base"},visible:!1,source:new DX}),m=new iu({properties:{title:"CartoDB (licht)",type:"base"},visible:!0,source:new Lh({url:"https://{a-d}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",attributions:" OpenStreetMap contributors  CARTO"})}),y=new iu({properties:{title:"Luchtfoto",type:"base"},visible:!1,source:new Lh({url:"https://service.pdok.nl/hwh/luchtfotorgb/wmts/v1_0/Actueel_orthoHR/EPSG:3857/{z}/{x}/{y}.jpeg",attributions:" Kadaster / PDOK Luchtfoto",maxZoom:19})}),_=new iu({properties:{title:"Labels Overlay",type:"overlay"},visible:!1,source:new Lh({url:"https://{a-d}.basemaps.cartocdn.com/rastertiles/voyager_only_labels/{z}/{x}/{y}.png",attributions:" OpenStreetMap contributors  CARTO",maxZoom:20}),zIndex:100}),x=new iu({properties:{title:"TMK 1850",type:"base"},visible:!1,source:new Lh({url:"https://s.map5.nl/map/gast/tiles/tmk_1850/EPSG3857/{z}/{x}/{y}.png",attributions:" Kadaster / Map5.nl",crossOrigin:"anonymous",maxZoom:14})}),w=new iu({properties:{title:"Bonnebladen 1900",type:"base"},visible:!1,source:new Lh({url:"https://s.map5.nl/map/gast/tiles/bonne_1900/EPSG3857/{z}/{x}/{y}.png",attributions:" Kadaster / Map5.nl",crossOrigin:"anonymous",maxZoom:14})});t.addLayer(g),t.addLayer(m),t.addLayer(y),t.addLayer(_),t.addLayer(x),t.addLayer(w),console.log(" Base layers added:",{osm:g.getVisible(),cartodb:m.getVisible(),satellite:y.getVisible()}),r("OpenStreetMap",g),r("CartoDB (licht)",m),r("Luchtfoto",y),r("Labels Overlay",_),r("TMK 1850",x),r("Bonnebladen 1900",w),t.updateSize(),console.log(" Map size:",t.getSize()),console.log(" Map center:",t.getView().getCenter()),console.log(" Map zoom:",t.getView().getZoom()),a()},[t,r]);async function a(){if(!t){console.error(" Cannot load layers: map is null");return}const g=Kq();console.log(` Loading ${g.length} immediate-load layers (WMS/Tile)...`);const m=await Promise.allSettled(g.map(async _=>{try{const x=await _.factory();return x?{name:_.name,layer:x}:null}catch(x){return console.warn(` Failed to create ${_.name}:`,x),null}}));let y=0;m.forEach(_=>{if(_.status==="fulfilled"&&_.value){const{name:x,layer:w}=_.value;t.addLayer(w),r(x,w),y++,console.log(`   ${x}`)}}),console.log(` Immediate layers loaded: ${y}/${g.length}`),console.log(` Total layers on map: ${t.getLayers().getLength()}`),console.log(" Vector layers will load on first toggle (lazy loading enabled)")}H.useEffect(()=>{if(!t||e.current)return;const g=setTimeout(()=>{const m=s||"CartoDB (licht)";E3.forEach(y=>{i(y,!1)}),E3.includes(m)?i(m,!0):i("CartoDB (licht)",!0),e.current=!0,console.log(` Default background: ${m}`)},100);return()=>clearTimeout(g)},[t,s,i]);const o=dn(g=>g.gpsAutoStart),l=ls(g=>g.startTracking),c=H.useRef(!1);H.useEffect(()=>{if(!(!t||c.current)&&o){const g=setTimeout(()=>{l(),c.current=!0,console.log(" GPS autostart enabled - tracking started")},500);return()=>clearTimeout(g)}},[t,o,l]);const h={width:"100%",height:"100vh"};return f.jsx("div",{id:"map",ref:n,style:h})}const Jk=H.createContext({});function Qk(n){const e=H.useRef(null);return e.current===null&&(e.current=n()),e.current}const vE=H.createContext(null),eI=H.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"});class Jre extends H.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const r=this.props.sizeRef.current;r.height=t.offsetHeight||0,r.width=t.offsetWidth||0,r.top=t.offsetTop,r.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function Qre({children:n,isPresent:e}){const t=H.useId(),r=H.useRef(null),i=H.useRef({width:0,height:0,top:0,left:0}),{nonce:s}=H.useContext(eI);return H.useInsertionEffect(()=>{const{width:a,height:o,top:l,left:c}=i.current;if(e||!r.current||!a||!o)return;r.current.dataset.motionPopId=t;const h=document.createElement("style");return s&&(h.nonce=s),document.head.appendChild(h),h.sheet&&h.sheet.insertRule(`
          [data-motion-pop-id="${t}"] {
            position: absolute !important;
            width: ${a}px !important;
            height: ${o}px !important;
            top: ${l}px !important;
            left: ${c}px !important;
          }
        `),()=>{document.head.removeChild(h)}},[e]),f.jsx(Jre,{isPresent:e,childRef:r,sizeRef:i,children:H.cloneElement(n,{ref:r})})}const eie=({children:n,initial:e,isPresent:t,onExitComplete:r,custom:i,presenceAffectsLayout:s,mode:a})=>{const o=Qk(tie),l=H.useId(),c=H.useCallback(g=>{o.set(g,!0);for(const m of o.values())if(!m)return;r&&r()},[o,r]),h=H.useMemo(()=>({id:l,initial:e,isPresent:t,custom:i,onExitComplete:c,register:g=>(o.set(g,!1),()=>o.delete(g))}),s?[Math.random(),c]:[t,c]);return H.useMemo(()=>{o.forEach((g,m)=>o.set(m,!1))},[t]),H.useEffect(()=>{!t&&!o.size&&r&&r()},[t]),a==="popLayout"&&(n=f.jsx(Qre,{isPresent:t,children:n})),f.jsx(vE.Provider,{value:h,children:n})};function tie(){return new Map}function P9(n=!0){const e=H.useContext(vE);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:r,register:i}=e,s=H.useId();H.useEffect(()=>{n&&i(s)},[n]);const a=H.useCallback(()=>n&&r&&r(s),[s,r,n]);return!t&&r?[!1,a]:[!0]}const Ox=n=>n.key||"";function S3(n){const e=[];return H.Children.forEach(n,t=>{H.isValidElement(t)&&e.push(t)}),e}const tI=typeof window<"u",N9=tI?H.useLayoutEffect:H.useEffect,An=({children:n,custom:e,initial:t=!0,onExitComplete:r,presenceAffectsLayout:i=!0,mode:s="sync",propagate:a=!1})=>{const[o,l]=P9(a),c=H.useMemo(()=>S3(n),[n]),h=a&&!o?[]:c.map(Ox),g=H.useRef(!0),m=H.useRef(c),y=Qk(()=>new Map),[_,x]=H.useState(c),[w,b]=H.useState(c);N9(()=>{g.current=!1,m.current=c;for(let L=0;L<w.length;L++){const O=Ox(w[L]);h.includes(O)?y.delete(O):y.get(O)!==!0&&y.set(O,!1)}},[w,h.length,h.join("-")]);const T=[];if(c!==_){let L=[...c];for(let O=0;O<w.length;O++){const B=w[O],R=Ox(B);h.includes(R)||(L.splice(O,0,B),T.push(B))}s==="wait"&&T.length&&(L=T),b(S3(L)),x(c);return}const{forceRender:k}=H.useContext(Jk);return f.jsx(f.Fragment,{children:w.map(L=>{const O=Ox(L),B=a&&!o?!1:c===w||h.includes(O),R=()=>{if(y.has(O))y.set(O,!0);else return;let A=!0;y.forEach(P=>{P||(A=!1)}),A&&(k?.(),b(m.current),a&&l?.(),r&&r())};return f.jsx(eie,{isPresent:B,initial:!g.current||t?void 0:!1,custom:B?void 0:e,presenceAffectsLayout:i,mode:s,onExitComplete:B?void 0:R,children:L},O)})})},da=n=>n;let M9=da;function nI(n){let e;return()=>(e===void 0&&(e=n()),e)}const Y0=(n,e,t)=>{const r=e-n;return r===0?1:(t-n)/r},Ql=n=>n*1e3,ec=n=>n/1e3,nie={useManualTiming:!1};function rie(n){let e=new Set,t=new Set,r=!1,i=!1;const s=new WeakSet;let a={delta:0,timestamp:0,isProcessing:!1};function o(c){s.has(c)&&(l.schedule(c),n()),c(a)}const l={schedule:(c,h=!1,g=!1)=>{const y=g&&r?e:t;return h&&s.add(c),y.has(c)||y.add(c),c},cancel:c=>{t.delete(c),s.delete(c)},process:c=>{if(a=c,r){i=!0;return}r=!0,[e,t]=[t,e],e.forEach(o),e.clear(),r=!1,i&&(i=!1,l.process(c))}};return l}const Dx=["read","resolveKeyframes","update","preRender","render","postRender"],iie=40;function L9(n,e){let t=!1,r=!0;const i={delta:0,timestamp:0,isProcessing:!1},s=()=>t=!0,a=Dx.reduce((b,T)=>(b[T]=rie(s),b),{}),{read:o,resolveKeyframes:l,update:c,preRender:h,render:g,postRender:m}=a,y=()=>{const b=performance.now();t=!1,i.delta=r?1e3/60:Math.max(Math.min(b-i.timestamp,iie),1),i.timestamp=b,i.isProcessing=!0,o.process(i),l.process(i),c.process(i),h.process(i),g.process(i),m.process(i),i.isProcessing=!1,t&&e&&(r=!1,n(y))},_=()=>{t=!0,r=!0,i.isProcessing||n(y)};return{schedule:Dx.reduce((b,T)=>{const k=a[T];return b[T]=(L,O=!1,B=!1)=>(t||_(),k.schedule(L,O,B)),b},{}),cancel:b=>{for(let T=0;T<Dx.length;T++)a[Dx[T]].cancel(b)},state:i,steps:a}}const{schedule:mr,cancel:Vu,state:Bi,steps:yb}=L9(typeof requestAnimationFrame<"u"?requestAnimationFrame:da,!0),O9=H.createContext({strict:!1}),b3={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Z0={};for(const n in b3)Z0[n]={isEnabled:e=>b3[n].some(t=>!!e[t])};function sie(n){for(const e in n)Z0[e]={...Z0[e],...n[e]}}const aie=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Iv(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||aie.has(n)}let D9=n=>!Iv(n);function oie(n){n&&(D9=e=>e.startsWith("on")?!Iv(e):n(e))}try{oie(require("@emotion/is-prop-valid").default)}catch{}function lie(n,e,t){const r={};for(const i in n)i==="values"&&typeof n.values=="object"||(D9(i)||t===!0&&Iv(i)||!e&&!Iv(i)||n.draggable&&i.startsWith("onDrag"))&&(r[i]=n[i]);return r}function cie(n){if(typeof Proxy>"u")return n;const e=new Map,t=(...r)=>n(...r);return new Proxy(t,{get:(r,i)=>i==="create"?n:(e.has(i)||e.set(i,n(i)),e.get(i))})}const wE=H.createContext({});function qp(n){return typeof n=="string"||Array.isArray(n)}function EE(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}const rI=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],iI=["initial",...rI];function SE(n){return EE(n.animate)||iI.some(e=>qp(n[e]))}function j9(n){return!!(SE(n)||n.variants)}function uie(n,e){if(SE(n)){const{initial:t,animate:r}=n;return{initial:t===!1||qp(t)?t:void 0,animate:qp(r)?r:void 0}}return n.inherit!==!1?e:{}}function hie(n){const{initial:e,animate:t}=uie(n,H.useContext(wE));return H.useMemo(()=>({initial:e,animate:t}),[T3(e),T3(t)])}function T3(n){return Array.isArray(n)?n.join(" "):n}const die=Symbol.for("motionComponentSymbol");function n0(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function fie(n,e,t){return H.useCallback(r=>{r&&n.onMount&&n.onMount(r),e&&(r?e.mount(r):e.unmount()),t&&(typeof t=="function"?t(r):n0(t)&&(t.current=r))},[e])}const sI=n=>n.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),gie="framerAppearId",F9="data-"+sI(gie),{schedule:aI}=L9(queueMicrotask,!1),V9=H.createContext({});function mie(n,e,t,r,i){var s,a;const{visualElement:o}=H.useContext(wE),l=H.useContext(O9),c=H.useContext(vE),h=H.useContext(eI).reducedMotion,g=H.useRef(null);r=r||l.renderer,!g.current&&r&&(g.current=r(n,{visualState:e,parent:o,props:t,presenceContext:c,blockInitialAnimation:c?c.initial===!1:!1,reducedMotionConfig:h}));const m=g.current,y=H.useContext(V9);m&&!m.projection&&i&&(m.type==="html"||m.type==="svg")&&pie(g.current,t,i,y);const _=H.useRef(!1);H.useInsertionEffect(()=>{m&&_.current&&m.update(t,c)});const x=t[F9],w=H.useRef(!!x&&!(!((s=window.MotionHandoffIsComplete)===null||s===void 0)&&s.call(window,x))&&((a=window.MotionHasOptimisedAnimation)===null||a===void 0?void 0:a.call(window,x)));return N9(()=>{m&&(_.current=!0,window.MotionIsMounted=!0,m.updateFeatures(),aI.render(m.render),w.current&&m.animationState&&m.animationState.animateChanges())}),H.useEffect(()=>{m&&(!w.current&&m.animationState&&m.animationState.animateChanges(),w.current&&(queueMicrotask(()=>{var b;(b=window.MotionHandoffMarkAsComplete)===null||b===void 0||b.call(window,x)}),w.current=!1))}),m}function pie(n,e,t,r){const{layoutId:i,layout:s,drag:a,dragConstraints:o,layoutScroll:l,layoutRoot:c}=e;n.projection=new t(n.latestValues,e["data-framer-portal-id"]?void 0:B9(n.parent)),n.projection.setOptions({layoutId:i,layout:s,alwaysMeasureLayout:!!a||o&&n0(o),visualElement:n,animationType:typeof s=="string"?s:"both",initialPromotionConfig:r,layoutScroll:l,layoutRoot:c})}function B9(n){if(n)return n.options.allowProjection!==!1?n.projection:B9(n.parent)}function yie({preloadedFeatures:n,createVisualElement:e,useRender:t,useVisualState:r,Component:i}){var s,a;n&&sie(n);function o(c,h){let g;const m={...H.useContext(eI),...c,layoutId:xie(c)},{isStatic:y}=m,_=hie(c),x=r(c,y);if(!y&&tI){_ie();const w=vie(m);g=w.MeasureLayout,_.visualElement=mie(i,x,m,e,w.ProjectionNode)}return f.jsxs(wE.Provider,{value:_,children:[g&&_.visualElement?f.jsx(g,{visualElement:_.visualElement,...m}):null,t(i,c,fie(x,_.visualElement,h),x,y,_.visualElement)]})}o.displayName=`motion.${typeof i=="string"?i:`create(${(a=(s=i.displayName)!==null&&s!==void 0?s:i.name)!==null&&a!==void 0?a:""})`}`;const l=H.forwardRef(o);return l[die]=i,l}function xie({layoutId:n}){const e=H.useContext(Jk).id;return e&&n!==void 0?e+"-"+n:n}function _ie(n,e){H.useContext(O9).strict}function vie(n){const{drag:e,layout:t}=Z0;if(!e&&!t)return{};const r={...e,...t};return{MeasureLayout:e?.isEnabled(n)||t?.isEnabled(n)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}const wie=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function oI(n){return typeof n!="string"||n.includes("-")?!1:!!(wie.indexOf(n)>-1||/[A-Z]/u.test(n))}function R3(n){const e=[{},{}];return n?.values.forEach((t,r)=>{e[0][r]=t.get(),e[1][r]=t.getVelocity()}),e}function lI(n,e,t,r){if(typeof e=="function"){const[i,s]=R3(r);e=e(t!==void 0?t:n.custom,i,s)}if(typeof e=="string"&&(e=n.variants&&n.variants[e]),typeof e=="function"){const[i,s]=R3(r);e=e(t!==void 0?t:n.custom,i,s)}return e}const hR=n=>Array.isArray(n),Eie=n=>!!(n&&typeof n=="object"&&n.mix&&n.toValue),Sie=n=>hR(n)?n[n.length-1]||0:n,hs=n=>!!(n&&n.getVelocity);function w_(n){const e=hs(n)?n.get():n;return Eie(e)?e.toValue():e}function bie({scrapeMotionValuesFromProps:n,createRenderState:e,onUpdate:t},r,i,s){const a={latestValues:Tie(r,i,s,n),renderState:e()};return t&&(a.onMount=o=>t({props:r,current:o,...a}),a.onUpdate=o=>t(o)),a}const G9=n=>(e,t)=>{const r=H.useContext(wE),i=H.useContext(vE),s=()=>bie(n,e,r,i);return t?s():Qk(s)};function Tie(n,e,t,r){const i={},s=r(n,{});for(const m in s)i[m]=w_(s[m]);let{initial:a,animate:o}=n;const l=SE(n),c=j9(n);e&&c&&!l&&n.inherit!==!1&&(a===void 0&&(a=e.initial),o===void 0&&(o=e.animate));let h=t?t.initial===!1:!1;h=h||a===!1;const g=h?o:a;if(g&&typeof g!="boolean"&&!EE(g)){const m=Array.isArray(g)?g:[g];for(let y=0;y<m.length;y++){const _=lI(n,m[y]);if(_){const{transitionEnd:x,transition:w,...b}=_;for(const T in b){let k=b[T];if(Array.isArray(k)){const L=h?k.length-1:0;k=k[L]}k!==null&&(i[T]=k)}for(const T in x)i[T]=x[T]}}}return i}const gg=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Fd=new Set(gg),z9=n=>e=>typeof e=="string"&&e.startsWith(n),U9=z9("--"),Rie=z9("var(--"),cI=n=>Rie(n)?Aie.test(n.split("/*")[0].trim()):!1,Aie=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,$9=(n,e)=>e&&typeof n=="number"?e.transform(n):n,cc=(n,e,t)=>t>e?e:t<n?n:t,mg={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},Yp={...mg,transform:n=>cc(0,1,n)},jx={...mg,default:1},H1=n=>({test:e=>typeof e=="string"&&e.endsWith(n)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${n}`}),nu=H1("deg"),ll=H1("%"),$t=H1("px"),kie=H1("vh"),Iie=H1("vw"),A3={...ll,parse:n=>ll.parse(n)/100,transform:n=>ll.transform(n*100)},Cie={borderWidth:$t,borderTopWidth:$t,borderRightWidth:$t,borderBottomWidth:$t,borderLeftWidth:$t,borderRadius:$t,radius:$t,borderTopLeftRadius:$t,borderTopRightRadius:$t,borderBottomRightRadius:$t,borderBottomLeftRadius:$t,width:$t,maxWidth:$t,height:$t,maxHeight:$t,top:$t,right:$t,bottom:$t,left:$t,padding:$t,paddingTop:$t,paddingRight:$t,paddingBottom:$t,paddingLeft:$t,margin:$t,marginTop:$t,marginRight:$t,marginBottom:$t,marginLeft:$t,backgroundPositionX:$t,backgroundPositionY:$t},Pie={rotate:nu,rotateX:nu,rotateY:nu,rotateZ:nu,scale:jx,scaleX:jx,scaleY:jx,scaleZ:jx,skew:nu,skewX:nu,skewY:nu,distance:$t,translateX:$t,translateY:$t,translateZ:$t,x:$t,y:$t,z:$t,perspective:$t,transformPerspective:$t,opacity:Yp,originX:A3,originY:A3,originZ:$t},k3={...mg,transform:Math.round},uI={...Cie,...Pie,zIndex:k3,size:$t,fillOpacity:Yp,strokeOpacity:Yp,numOctaves:k3},Nie={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},Mie=gg.length;function Lie(n,e,t){let r="",i=!0;for(let s=0;s<Mie;s++){const a=gg[s],o=n[a];if(o===void 0)continue;let l=!0;if(typeof o=="number"?l=o===(a.startsWith("scale")?1:0):l=parseFloat(o)===0,!l||t){const c=$9(o,uI[a]);if(!l){i=!1;const h=Nie[a]||a;r+=`${h}(${c}) `}t&&(e[a]=c)}}return r=r.trim(),t?r=t(e,i?"":r):i&&(r="none"),r}function hI(n,e,t){const{style:r,vars:i,transformOrigin:s}=n;let a=!1,o=!1;for(const l in e){const c=e[l];if(Fd.has(l)){a=!0;continue}else if(U9(l)){i[l]=c;continue}else{const h=$9(c,uI[l]);l.startsWith("origin")?(o=!0,s[l]=h):r[l]=h}}if(e.transform||(a||t?r.transform=Lie(e,n.transform,t):r.transform&&(r.transform="none")),o){const{originX:l="50%",originY:c="50%",originZ:h=0}=s;r.transformOrigin=`${l} ${c} ${h}`}}const Oie={offset:"stroke-dashoffset",array:"stroke-dasharray"},Die={offset:"strokeDashoffset",array:"strokeDasharray"};function jie(n,e,t=1,r=0,i=!0){n.pathLength=1;const s=i?Oie:Die;n[s.offset]=$t.transform(-r);const a=$t.transform(e),o=$t.transform(t);n[s.array]=`${a} ${o}`}function I3(n,e,t){return typeof n=="string"?n:$t.transform(e+t*n)}function Fie(n,e,t){const r=I3(e,n.x,n.width),i=I3(t,n.y,n.height);return`${r} ${i}`}function dI(n,{attrX:e,attrY:t,attrScale:r,originX:i,originY:s,pathLength:a,pathSpacing:o=1,pathOffset:l=0,...c},h,g){if(hI(n,c,g),h){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:m,style:y,dimensions:_}=n;m.transform&&(_&&(y.transform=m.transform),delete m.transform),_&&(i!==void 0||s!==void 0||y.transform)&&(y.transformOrigin=Fie(_,i!==void 0?i:.5,s!==void 0?s:.5)),e!==void 0&&(m.x=e),t!==void 0&&(m.y=t),r!==void 0&&(m.scale=r),a!==void 0&&jie(m,a,o,l,!1)}const fI=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),W9=()=>({...fI(),attrs:{}}),gI=n=>typeof n=="string"&&n.toLowerCase()==="svg";function H9(n,{style:e,vars:t},r,i){Object.assign(n.style,e,i&&i.getProjectionStyles(r));for(const s in t)n.style.setProperty(s,t[s])}const K9=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function X9(n,e,t,r){H9(n,e,void 0,r);for(const i in e.attrs)n.setAttribute(K9.has(i)?i:sI(i),e.attrs[i])}const Cv={};function Vie(n){Object.assign(Cv,n)}function q9(n,{layout:e,layoutId:t}){return Fd.has(n)||n.startsWith("origin")||(e||t!==void 0)&&(!!Cv[n]||n==="opacity")}function mI(n,e,t){var r;const{style:i}=n,s={};for(const a in i)(hs(i[a])||e.style&&hs(e.style[a])||q9(a,n)||((r=t?.getValue(a))===null||r===void 0?void 0:r.liveStyle)!==void 0)&&(s[a]=i[a]);return s}function Y9(n,e,t){const r=mI(n,e,t);for(const i in n)if(hs(n[i])||hs(e[i])){const s=gg.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;r[s]=n[i]}return r}function Bie(n,e){try{e.dimensions=typeof n.getBBox=="function"?n.getBBox():n.getBoundingClientRect()}catch{e.dimensions={x:0,y:0,width:0,height:0}}}const C3=["x","y","width","height","cx","cy","r"],Gie={useVisualState:G9({scrapeMotionValuesFromProps:Y9,createRenderState:W9,onUpdate:({props:n,prevProps:e,current:t,renderState:r,latestValues:i})=>{if(!t)return;let s=!!n.drag;if(!s){for(const o in i)if(Fd.has(o)){s=!0;break}}if(!s)return;let a=!e;if(e)for(let o=0;o<C3.length;o++){const l=C3[o];n[l]!==e[l]&&(a=!0)}a&&mr.read(()=>{Bie(t,r),mr.render(()=>{dI(r,i,gI(t.tagName),n.transformTemplate),X9(t,r)})})}})},zie={useVisualState:G9({scrapeMotionValuesFromProps:mI,createRenderState:fI})};function Z9(n,e,t){for(const r in e)!hs(e[r])&&!q9(r,t)&&(n[r]=e[r])}function Uie({transformTemplate:n},e){return H.useMemo(()=>{const t=fI();return hI(t,e,n),Object.assign({},t.vars,t.style)},[e])}function $ie(n,e){const t=n.style||{},r={};return Z9(r,t,n),Object.assign(r,Uie(n,e)),r}function Wie(n,e){const t={},r=$ie(n,e);return n.drag&&n.dragListener!==!1&&(t.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(t.tabIndex=0),t.style=r,t}function Hie(n,e,t,r){const i=H.useMemo(()=>{const s=W9();return dI(s,e,gI(r),n.transformTemplate),{...s.attrs,style:{...s.style}}},[e]);if(n.style){const s={};Z9(s,n.style,n),i.style={...s,...i.style}}return i}function Kie(n=!1){return(t,r,i,{latestValues:s},a)=>{const l=(oI(t)?Hie:Wie)(r,s,a,t),c=lie(r,typeof t=="string",n),h=t!==H.Fragment?{...c,...l,ref:i}:{},{children:g}=r,m=H.useMemo(()=>hs(g)?g.get():g,[g]);return H.createElement(t,{...h,children:m})}}function Xie(n,e){return function(r,{forwardMotionProps:i}={forwardMotionProps:!1}){const a={...oI(r)?Gie:zie,preloadedFeatures:n,useRender:Kie(i),createVisualElement:e,Component:r};return yie(a)}}function J9(n,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==n.length)return!1;for(let r=0;r<t;r++)if(e[r]!==n[r])return!1;return!0}function bE(n,e,t){const r=n.getProps();return lI(r,e,t!==void 0?t:r.custom,n)}const qie=nI(()=>window.ScrollTimeline!==void 0);class Yie{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,t){for(let r=0;r<this.animations.length;r++)this.animations[r][e]=t}attachTimeline(e,t){const r=this.animations.map(i=>{if(qie()&&i.attachTimeline)return i.attachTimeline(e);if(typeof t=="function")return t(i)});return()=>{r.forEach((i,s)=>{i&&i(),this.animations[s].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let t=0;t<this.animations.length;t++)e=Math.max(e,this.animations[t].duration);return e}runAll(e){this.animations.forEach(t=>t[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class Zie extends Yie{then(e,t){return Promise.all(this.animations).then(e).catch(t)}}function pI(n,e){return n?n[e]||n.default||n:void 0}const dR=2e4;function Q9(n){let e=0;const t=50;let r=n.next(e);for(;!r.done&&e<dR;)e+=t,r=n.next(e);return e>=dR?1/0:e}function yI(n){return typeof n=="function"}function P3(n,e){n.timeline=e,n.onfinish=null}const xI=n=>Array.isArray(n)&&typeof n[0]=="number",Jie={linearEasing:void 0};function Qie(n,e){const t=nI(n);return()=>{var r;return(r=Jie[e])!==null&&r!==void 0?r:t()}}const Pv=Qie(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),e7=(n,e,t=10)=>{let r="";const i=Math.max(Math.round(e/t),2);for(let s=0;s<i;s++)r+=n(Y0(0,i-1,s))+", ";return`linear(${r.substring(0,r.length-2)})`};function t7(n){return!!(typeof n=="function"&&Pv()||!n||typeof n=="string"&&(n in fR||Pv())||xI(n)||Array.isArray(n)&&n.every(t7))}const Pm=([n,e,t,r])=>`cubic-bezier(${n}, ${e}, ${t}, ${r})`,fR={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Pm([0,.65,.55,1]),circOut:Pm([.55,0,1,.45]),backIn:Pm([.31,.01,.66,-.59]),backOut:Pm([.33,1.53,.69,.99])};function n7(n,e){if(n)return typeof n=="function"&&Pv()?e7(n,e):xI(n)?Pm(n):Array.isArray(n)?n.map(t=>n7(t,e)||fR.easeOut):fR[n]}const io={x:!1,y:!1};function r7(){return io.x||io.y}function ese(n,e,t){var r;if(n instanceof Element)return[n];if(typeof n=="string"){let i=document;const s=(r=void 0)!==null&&r!==void 0?r:i.querySelectorAll(n);return s?Array.from(s):[]}return Array.from(n)}function i7(n,e){const t=ese(n),r=new AbortController,i={passive:!0,...e,signal:r.signal};return[t,i,()=>r.abort()]}function N3(n){return e=>{e.pointerType==="touch"||r7()||n(e)}}function tse(n,e,t={}){const[r,i,s]=i7(n,t),a=N3(o=>{const{target:l}=o,c=e(o);if(typeof c!="function"||!l)return;const h=N3(g=>{c(g),l.removeEventListener("pointerleave",h)});l.addEventListener("pointerleave",h,i)});return r.forEach(o=>{o.addEventListener("pointerenter",a,i)}),s}const s7=(n,e)=>e?n===e?!0:s7(n,e.parentElement):!1,_I=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1,nse=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function rse(n){return nse.has(n.tagName)||n.tabIndex!==-1}const Nm=new WeakSet;function M3(n){return e=>{e.key==="Enter"&&n(e)}}function xb(n,e){n.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const ise=(n,e)=>{const t=n.currentTarget;if(!t)return;const r=M3(()=>{if(Nm.has(t))return;xb(t,"down");const i=M3(()=>{xb(t,"up")}),s=()=>xb(t,"cancel");t.addEventListener("keyup",i,e),t.addEventListener("blur",s,e)});t.addEventListener("keydown",r,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",r),e)};function L3(n){return _I(n)&&!r7()}function sse(n,e,t={}){const[r,i,s]=i7(n,t),a=o=>{const l=o.currentTarget;if(!L3(o)||Nm.has(l))return;Nm.add(l);const c=e(o),h=(y,_)=>{window.removeEventListener("pointerup",g),window.removeEventListener("pointercancel",m),!(!L3(y)||!Nm.has(l))&&(Nm.delete(l),typeof c=="function"&&c(y,{success:_}))},g=y=>{h(y,t.useGlobalTarget||s7(l,y.target))},m=y=>{h(y,!1)};window.addEventListener("pointerup",g,i),window.addEventListener("pointercancel",m,i)};return r.forEach(o=>{!rse(o)&&o.getAttribute("tabindex")===null&&(o.tabIndex=0),(t.useGlobalTarget?window:o).addEventListener("pointerdown",a,i),o.addEventListener("focus",c=>ise(c,i),i)}),s}function ase(n){return n==="x"||n==="y"?io[n]?null:(io[n]=!0,()=>{io[n]=!1}):io.x||io.y?null:(io.x=io.y=!0,()=>{io.x=io.y=!1})}const a7=new Set(["width","height","top","left","right","bottom",...gg]);let E_;function ose(){E_=void 0}const cl={now:()=>(E_===void 0&&cl.set(Bi.isProcessing||nie.useManualTiming?Bi.timestamp:performance.now()),E_),set:n=>{E_=n,queueMicrotask(ose)}};function vI(n,e){n.indexOf(e)===-1&&n.push(e)}function wI(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}class EI{constructor(){this.subscriptions=[]}add(e){return vI(this.subscriptions,e),()=>wI(this.subscriptions,e)}notify(e,t,r){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](e,t,r);else for(let s=0;s<i;s++){const a=this.subscriptions[s];a&&a(e,t,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function o7(n,e){return e?n*(1e3/e):0}const O3=30,lse=n=>!isNaN(parseFloat(n));class cse{constructor(e,t={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(r,i=!0)=>{const s=cl.now();this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),i&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=cl.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=lse(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new EI);const r=this.events[e].add(t);return e==="change"?()=>{r(),mr.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e,t=!0){!t||!this.passiveEffect?this.updateAndNotify(e,t):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,t,r){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-r}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=cl.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>O3)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,O3);return o7(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Zp(n,e){return new cse(n,e)}function use(n,e,t){n.hasValue(e)?n.getValue(e).set(t):n.addValue(e,Zp(t))}function hse(n,e){const t=bE(n,e);let{transitionEnd:r={},transition:i={},...s}=t||{};s={...s,...r};for(const a in s){const o=Sie(s[a]);use(n,a,o)}}function dse(n){return!!(hs(n)&&n.add)}function gR(n,e){const t=n.getValue("willChange");if(dse(t))return t.add(e)}function l7(n){return n.props[F9]}const c7=(n,e,t)=>(((1-3*t+3*e)*n+(3*t-6*e))*n+3*e)*n,fse=1e-7,gse=12;function mse(n,e,t,r,i){let s,a,o=0;do a=e+(t-e)/2,s=c7(a,r,i)-n,s>0?t=a:e=a;while(Math.abs(s)>fse&&++o<gse);return a}function K1(n,e,t,r){if(n===e&&t===r)return da;const i=s=>mse(s,0,1,n,t);return s=>s===0||s===1?s:c7(i(s),e,r)}const u7=n=>e=>e<=.5?n(2*e)/2:(2-n(2*(1-e)))/2,h7=n=>e=>1-n(1-e),d7=K1(.33,1.53,.69,.99),SI=h7(d7),f7=u7(SI),g7=n=>(n*=2)<1?.5*SI(n):.5*(2-Math.pow(2,-10*(n-1))),bI=n=>1-Math.sin(Math.acos(n)),m7=h7(bI),p7=u7(bI),y7=n=>/^0[^.\s]+$/u.test(n);function pse(n){return typeof n=="number"?n===0:n!==null?n==="none"||n==="0"||y7(n):!0}const Jm=n=>Math.round(n*1e5)/1e5,TI=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function yse(n){return n==null}const xse=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,RI=(n,e)=>t=>!!(typeof t=="string"&&xse.test(t)&&t.startsWith(n)||e&&!yse(t)&&Object.prototype.hasOwnProperty.call(t,e)),x7=(n,e,t)=>r=>{if(typeof r!="string")return r;const[i,s,a,o]=r.match(TI);return{[n]:parseFloat(i),[e]:parseFloat(s),[t]:parseFloat(a),alpha:o!==void 0?parseFloat(o):1}},_se=n=>cc(0,255,n),_b={...mg,transform:n=>Math.round(_se(n))},Kh={test:RI("rgb","red"),parse:x7("red","green","blue"),transform:({red:n,green:e,blue:t,alpha:r=1})=>"rgba("+_b.transform(n)+", "+_b.transform(e)+", "+_b.transform(t)+", "+Jm(Yp.transform(r))+")"};function vse(n){let e="",t="",r="",i="";return n.length>5?(e=n.substring(1,3),t=n.substring(3,5),r=n.substring(5,7),i=n.substring(7,9)):(e=n.substring(1,2),t=n.substring(2,3),r=n.substring(3,4),i=n.substring(4,5),e+=e,t+=t,r+=r,i+=i),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(r,16),alpha:i?parseInt(i,16)/255:1}}const mR={test:RI("#"),parse:vse,transform:Kh.transform},r0={test:RI("hsl","hue"),parse:x7("hue","saturation","lightness"),transform:({hue:n,saturation:e,lightness:t,alpha:r=1})=>"hsla("+Math.round(n)+", "+ll.transform(Jm(e))+", "+ll.transform(Jm(t))+", "+Jm(Yp.transform(r))+")"},ss={test:n=>Kh.test(n)||mR.test(n)||r0.test(n),parse:n=>Kh.test(n)?Kh.parse(n):r0.test(n)?r0.parse(n):mR.parse(n),transform:n=>typeof n=="string"?n:n.hasOwnProperty("red")?Kh.transform(n):r0.transform(n)},wse=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function Ese(n){var e,t;return isNaN(n)&&typeof n=="string"&&(((e=n.match(TI))===null||e===void 0?void 0:e.length)||0)+(((t=n.match(wse))===null||t===void 0?void 0:t.length)||0)>0}const _7="number",v7="color",Sse="var",bse="var(",D3="${}",Tse=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Jp(n){const e=n.toString(),t=[],r={color:[],number:[],var:[]},i=[];let s=0;const o=e.replace(Tse,l=>(ss.test(l)?(r.color.push(s),i.push(v7),t.push(ss.parse(l))):l.startsWith(bse)?(r.var.push(s),i.push(Sse),t.push(l)):(r.number.push(s),i.push(_7),t.push(parseFloat(l))),++s,D3)).split(D3);return{values:t,split:o,indexes:r,types:i}}function w7(n){return Jp(n).values}function E7(n){const{split:e,types:t}=Jp(n),r=e.length;return i=>{let s="";for(let a=0;a<r;a++)if(s+=e[a],i[a]!==void 0){const o=t[a];o===_7?s+=Jm(i[a]):o===v7?s+=ss.transform(i[a]):s+=i[a]}return s}}const Rse=n=>typeof n=="number"?0:n;function Ase(n){const e=w7(n);return E7(n)(e.map(Rse))}const Bu={test:Ese,parse:w7,createTransformer:E7,getAnimatableNone:Ase},kse=new Set(["brightness","contrast","saturate","opacity"]);function Ise(n){const[e,t]=n.slice(0,-1).split("(");if(e==="drop-shadow")return n;const[r]=t.match(TI)||[];if(!r)return n;const i=t.replace(r,"");let s=kse.has(e)?1:0;return r!==t&&(s*=100),e+"("+s+i+")"}const Cse=/\b([a-z-]*)\(.*?\)/gu,pR={...Bu,getAnimatableNone:n=>{const e=n.match(Cse);return e?e.map(Ise).join(" "):n}},Pse={...uI,color:ss,backgroundColor:ss,outlineColor:ss,fill:ss,stroke:ss,borderColor:ss,borderTopColor:ss,borderRightColor:ss,borderBottomColor:ss,borderLeftColor:ss,filter:pR,WebkitFilter:pR},AI=n=>Pse[n];function S7(n,e){let t=AI(n);return t!==pR&&(t=Bu),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const Nse=new Set(["auto","none","0"]);function Mse(n,e,t){let r=0,i;for(;r<n.length&&!i;){const s=n[r];typeof s=="string"&&!Nse.has(s)&&Jp(s).values.length&&(i=n[r]),r++}if(i&&t)for(const s of e)n[s]=S7(t,i)}const j3=n=>n===mg||n===$t,F3=(n,e)=>parseFloat(n.split(", ")[e]),V3=(n,e)=>(t,{transform:r})=>{if(r==="none"||!r)return 0;const i=r.match(/^matrix3d\((.+)\)$/u);if(i)return F3(i[1],e);{const s=r.match(/^matrix\((.+)\)$/u);return s?F3(s[1],n):0}},Lse=new Set(["x","y","z"]),Ose=gg.filter(n=>!Lse.has(n));function Dse(n){const e=[];return Ose.forEach(t=>{const r=n.getValue(t);r!==void 0&&(e.push([t,r.get()]),r.set(t.startsWith("scale")?1:0))}),e}const J0={width:({x:n},{paddingLeft:e="0",paddingRight:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),height:({y:n},{paddingTop:e="0",paddingBottom:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),top:(n,{top:e})=>parseFloat(e),left:(n,{left:e})=>parseFloat(e),bottom:({y:n},{top:e})=>parseFloat(e)+(n.max-n.min),right:({x:n},{left:e})=>parseFloat(e)+(n.max-n.min),x:V3(4,13),y:V3(5,14)};J0.translateX=J0.x;J0.translateY=J0.y;const nd=new Set;let yR=!1,xR=!1;function b7(){if(xR){const n=Array.from(nd).filter(r=>r.needsMeasurement),e=new Set(n.map(r=>r.element)),t=new Map;e.forEach(r=>{const i=Dse(r);i.length&&(t.set(r,i),r.render())}),n.forEach(r=>r.measureInitialState()),e.forEach(r=>{r.render();const i=t.get(r);i&&i.forEach(([s,a])=>{var o;(o=r.getValue(s))===null||o===void 0||o.set(a)})}),n.forEach(r=>r.measureEndState()),n.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}xR=!1,yR=!1,nd.forEach(n=>n.complete()),nd.clear()}function T7(){nd.forEach(n=>{n.readKeyframes(),n.needsMeasurement&&(xR=!0)})}function jse(){T7(),b7()}class kI{constructor(e,t,r,i,s,a=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=r,this.motionValue=i,this.element=s,this.isAsync=a}scheduleResolve(){this.isScheduled=!0,this.isAsync?(nd.add(this),yR||(yR=!0,mr.read(T7),mr.resolveKeyframes(b7))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:r,motionValue:i}=this;for(let s=0;s<e.length;s++)if(e[s]===null)if(s===0){const a=i?.get(),o=e[e.length-1];if(a!==void 0)e[0]=a;else if(r&&t){const l=r.readValue(t,o);l!=null&&(e[0]=l)}e[0]===void 0&&(e[0]=o),i&&a===void 0&&i.set(e[0])}else e[s]=e[s-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),nd.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,nd.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const R7=n=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(n),Fse=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function Vse(n){const e=Fse.exec(n);if(!e)return[,];const[,t,r,i]=e;return[`--${t??r}`,i]}function A7(n,e,t=1){const[r,i]=Vse(n);if(!r)return;const s=window.getComputedStyle(e).getPropertyValue(r);if(s){const a=s.trim();return R7(a)?parseFloat(a):a}return cI(i)?A7(i,e,t+1):i}const k7=n=>e=>e.test(n),Bse={test:n=>n==="auto",parse:n=>n},I7=[mg,$t,ll,nu,Iie,kie,Bse],B3=n=>I7.find(k7(n));class C7 extends kI{constructor(e,t,r,i,s){super(e,t,r,i,s,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:r}=this;if(!t||!t.current)return;super.readKeyframes();for(let l=0;l<e.length;l++){let c=e[l];if(typeof c=="string"&&(c=c.trim(),cI(c))){const h=A7(c,t.current);h!==void 0&&(e[l]=h),l===e.length-1&&(this.finalKeyframe=c)}}if(this.resolveNoneKeyframes(),!a7.has(r)||e.length!==2)return;const[i,s]=e,a=B3(i),o=B3(s);if(a!==o)if(j3(a)&&j3(o))for(let l=0;l<e.length;l++){const c=e[l];typeof c=="string"&&(e[l]=parseFloat(c))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,r=[];for(let i=0;i<e.length;i++)pse(e[i])&&r.push(i);r.length&&Mse(e,r,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:r}=this;if(!e||!e.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=J0[r](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const i=t[t.length-1];i!==void 0&&e.getValue(r,i).jump(i,!1)}measureEndState(){var e;const{element:t,name:r,unresolvedKeyframes:i}=this;if(!t||!t.current)return;const s=t.getValue(r);s&&s.jump(this.measuredOrigin,!1);const a=i.length-1,o=i[a];i[a]=J0[r](t.measureViewportBox(),window.getComputedStyle(t.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([l,c])=>{t.getValue(l).set(c)}),this.resolveNoneKeyframes()}}const G3=(n,e)=>e==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&(Bu.test(n)||n==="0")&&!n.startsWith("url("));function Gse(n){const e=n[0];if(n.length===1)return!0;for(let t=0;t<n.length;t++)if(n[t]!==e)return!0}function zse(n,e,t,r){const i=n[0];if(i===null)return!1;if(e==="display"||e==="visibility")return!0;const s=n[n.length-1],a=G3(i,e),o=G3(s,e);return!a||!o?!1:Gse(n)||(t==="spring"||yI(t))&&r}const Use=n=>n!==null;function TE(n,{repeat:e,repeatType:t="loop"},r){const i=n.filter(Use),s=e&&t!=="loop"&&e%2===1?0:i.length-1;return!s||r===void 0?i[s]:r}const $se=40;class P7{constructor({autoplay:e=!0,delay:t=0,type:r="keyframes",repeat:i=0,repeatDelay:s=0,repeatType:a="loop",...o}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=cl.now(),this.options={autoplay:e,delay:t,type:r,repeat:i,repeatDelay:s,repeatType:a,...o},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>$se?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&jse(),this._resolved}onKeyframesResolved(e,t){this.resolvedAt=cl.now(),this.hasAttemptedResolve=!0;const{name:r,type:i,velocity:s,delay:a,onComplete:o,onUpdate:l,isGenerator:c}=this.options;if(!c&&!zse(e,r,i,s))if(a)this.options.duration=0;else{l&&l(TE(e,this.options,t)),o&&o(),this.resolveFinishedPromise();return}const h=this.initPlayback(e,t);h!==!1&&(this._resolved={keyframes:e,finalKeyframe:t,...h},this.onPostResolved())}onPostResolved(){}then(e,t){return this.currentFinishedPromise.then(e,t)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const Nr=(n,e,t)=>n+(e-n)*t;function vb(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function Wse({hue:n,saturation:e,lightness:t,alpha:r}){n/=360,e/=100,t/=100;let i=0,s=0,a=0;if(!e)i=s=a=t;else{const o=t<.5?t*(1+e):t+e-t*e,l=2*t-o;i=vb(l,o,n+1/3),s=vb(l,o,n),a=vb(l,o,n-1/3)}return{red:Math.round(i*255),green:Math.round(s*255),blue:Math.round(a*255),alpha:r}}function Nv(n,e){return t=>t>0?e:n}const wb=(n,e,t)=>{const r=n*n,i=t*(e*e-r)+r;return i<0?0:Math.sqrt(i)},Hse=[mR,Kh,r0],Kse=n=>Hse.find(e=>e.test(n));function z3(n){const e=Kse(n);if(!e)return!1;let t=e.parse(n);return e===r0&&(t=Wse(t)),t}const U3=(n,e)=>{const t=z3(n),r=z3(e);if(!t||!r)return Nv(n,e);const i={...t};return s=>(i.red=wb(t.red,r.red,s),i.green=wb(t.green,r.green,s),i.blue=wb(t.blue,r.blue,s),i.alpha=Nr(t.alpha,r.alpha,s),Kh.transform(i))},Xse=(n,e)=>t=>e(n(t)),X1=(...n)=>n.reduce(Xse),_R=new Set(["none","hidden"]);function qse(n,e){return _R.has(n)?t=>t<=0?n:e:t=>t>=1?e:n}function Yse(n,e){return t=>Nr(n,e,t)}function II(n){return typeof n=="number"?Yse:typeof n=="string"?cI(n)?Nv:ss.test(n)?U3:Qse:Array.isArray(n)?N7:typeof n=="object"?ss.test(n)?U3:Zse:Nv}function N7(n,e){const t=[...n],r=t.length,i=n.map((s,a)=>II(s)(s,e[a]));return s=>{for(let a=0;a<r;a++)t[a]=i[a](s);return t}}function Zse(n,e){const t={...n,...e},r={};for(const i in t)n[i]!==void 0&&e[i]!==void 0&&(r[i]=II(n[i])(n[i],e[i]));return i=>{for(const s in r)t[s]=r[s](i);return t}}function Jse(n,e){var t;const r=[],i={color:0,var:0,number:0};for(let s=0;s<e.values.length;s++){const a=e.types[s],o=n.indexes[a][i[a]],l=(t=n.values[o])!==null&&t!==void 0?t:0;r[s]=l,i[a]++}return r}const Qse=(n,e)=>{const t=Bu.createTransformer(e),r=Jp(n),i=Jp(e);return r.indexes.var.length===i.indexes.var.length&&r.indexes.color.length===i.indexes.color.length&&r.indexes.number.length>=i.indexes.number.length?_R.has(n)&&!i.values.length||_R.has(e)&&!r.values.length?qse(n,e):X1(N7(Jse(r,i),i.values),t):Nv(n,e)};function M7(n,e,t){return typeof n=="number"&&typeof e=="number"&&typeof t=="number"?Nr(n,e,t):II(n)(n,e)}const eae=5;function L7(n,e,t){const r=Math.max(e-eae,0);return o7(t-n(r),e-r)}const jr={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},Eb=.001;function tae({duration:n=jr.duration,bounce:e=jr.bounce,velocity:t=jr.velocity,mass:r=jr.mass}){let i,s,a=1-e;a=cc(jr.minDamping,jr.maxDamping,a),n=cc(jr.minDuration,jr.maxDuration,ec(n)),a<1?(i=c=>{const h=c*a,g=h*n,m=h-t,y=vR(c,a),_=Math.exp(-g);return Eb-m/y*_},s=c=>{const g=c*a*n,m=g*t+t,y=Math.pow(a,2)*Math.pow(c,2)*n,_=Math.exp(-g),x=vR(Math.pow(c,2),a);return(-i(c)+Eb>0?-1:1)*((m-y)*_)/x}):(i=c=>{const h=Math.exp(-c*n),g=(c-t)*n+1;return-Eb+h*g},s=c=>{const h=Math.exp(-c*n),g=(t-c)*(n*n);return h*g});const o=5/n,l=rae(i,s,o);if(n=Ql(n),isNaN(l))return{stiffness:jr.stiffness,damping:jr.damping,duration:n};{const c=Math.pow(l,2)*r;return{stiffness:c,damping:a*2*Math.sqrt(r*c),duration:n}}}const nae=12;function rae(n,e,t){let r=t;for(let i=1;i<nae;i++)r=r-n(r)/e(r);return r}function vR(n,e){return n*Math.sqrt(1-e*e)}const iae=["duration","bounce"],sae=["stiffness","damping","mass"];function $3(n,e){return e.some(t=>n[t]!==void 0)}function aae(n){let e={velocity:jr.velocity,stiffness:jr.stiffness,damping:jr.damping,mass:jr.mass,isResolvedFromDuration:!1,...n};if(!$3(n,sae)&&$3(n,iae))if(n.visualDuration){const t=n.visualDuration,r=2*Math.PI/(t*1.2),i=r*r,s=2*cc(.05,1,1-(n.bounce||0))*Math.sqrt(i);e={...e,mass:jr.mass,stiffness:i,damping:s}}else{const t=tae(n);e={...e,...t,mass:jr.mass},e.isResolvedFromDuration=!0}return e}function O7(n=jr.visualDuration,e=jr.bounce){const t=typeof n!="object"?{visualDuration:n,keyframes:[0,1],bounce:e}:n;let{restSpeed:r,restDelta:i}=t;const s=t.keyframes[0],a=t.keyframes[t.keyframes.length-1],o={done:!1,value:s},{stiffness:l,damping:c,mass:h,duration:g,velocity:m,isResolvedFromDuration:y}=aae({...t,velocity:-ec(t.velocity||0)}),_=m||0,x=c/(2*Math.sqrt(l*h)),w=a-s,b=ec(Math.sqrt(l/h)),T=Math.abs(w)<5;r||(r=T?jr.restSpeed.granular:jr.restSpeed.default),i||(i=T?jr.restDelta.granular:jr.restDelta.default);let k;if(x<1){const O=vR(b,x);k=B=>{const R=Math.exp(-x*b*B);return a-R*((_+x*b*w)/O*Math.sin(O*B)+w*Math.cos(O*B))}}else if(x===1)k=O=>a-Math.exp(-b*O)*(w+(_+b*w)*O);else{const O=b*Math.sqrt(x*x-1);k=B=>{const R=Math.exp(-x*b*B),A=Math.min(O*B,300);return a-R*((_+x*b*w)*Math.sinh(A)+O*w*Math.cosh(A))/O}}const L={calculatedDuration:y&&g||null,next:O=>{const B=k(O);if(y)o.done=O>=g;else{let R=0;x<1&&(R=O===0?Ql(_):L7(k,O,B));const A=Math.abs(R)<=r,P=Math.abs(a-B)<=i;o.done=A&&P}return o.value=o.done?a:B,o},toString:()=>{const O=Math.min(Q9(L),dR),B=e7(R=>L.next(O*R).value,O,30);return O+"ms "+B}};return L}function W3({keyframes:n,velocity:e=0,power:t=.8,timeConstant:r=325,bounceDamping:i=10,bounceStiffness:s=500,modifyTarget:a,min:o,max:l,restDelta:c=.5,restSpeed:h}){const g=n[0],m={done:!1,value:g},y=A=>o!==void 0&&A<o||l!==void 0&&A>l,_=A=>o===void 0?l:l===void 0||Math.abs(o-A)<Math.abs(l-A)?o:l;let x=t*e;const w=g+x,b=a===void 0?w:a(w);b!==w&&(x=b-g);const T=A=>-x*Math.exp(-A/r),k=A=>b+T(A),L=A=>{const P=T(A),D=k(A);m.done=Math.abs(P)<=c,m.value=m.done?b:D};let O,B;const R=A=>{y(m.value)&&(O=A,B=O7({keyframes:[m.value,_(m.value)],velocity:L7(k,A,m.value),damping:i,stiffness:s,restDelta:c,restSpeed:h}))};return R(0),{calculatedDuration:null,next:A=>{let P=!1;return!B&&O===void 0&&(P=!0,L(A),R(A)),O!==void 0&&A>=O?B.next(A-O):(!P&&L(A),m)}}}const oae=K1(.42,0,1,1),lae=K1(0,0,.58,1),D7=K1(.42,0,.58,1),cae=n=>Array.isArray(n)&&typeof n[0]!="number",uae={linear:da,easeIn:oae,easeInOut:D7,easeOut:lae,circIn:bI,circInOut:p7,circOut:m7,backIn:SI,backInOut:f7,backOut:d7,anticipate:g7},H3=n=>{if(xI(n)){M9(n.length===4);const[e,t,r,i]=n;return K1(e,t,r,i)}else if(typeof n=="string")return uae[n];return n};function hae(n,e,t){const r=[],i=t||M7,s=n.length-1;for(let a=0;a<s;a++){let o=i(n[a],n[a+1]);if(e){const l=Array.isArray(e)?e[a]||da:e;o=X1(l,o)}r.push(o)}return r}function dae(n,e,{clamp:t=!0,ease:r,mixer:i}={}){const s=n.length;if(M9(s===e.length),s===1)return()=>e[0];if(s===2&&e[0]===e[1])return()=>e[1];const a=n[0]===n[1];n[0]>n[s-1]&&(n=[...n].reverse(),e=[...e].reverse());const o=hae(e,r,i),l=o.length,c=h=>{if(a&&h<n[0])return e[0];let g=0;if(l>1)for(;g<n.length-2&&!(h<n[g+1]);g++);const m=Y0(n[g],n[g+1],h);return o[g](m)};return t?h=>c(cc(n[0],n[s-1],h)):c}function fae(n,e){const t=n[n.length-1];for(let r=1;r<=e;r++){const i=Y0(0,e,r);n.push(Nr(t,1,i))}}function gae(n){const e=[0];return fae(e,n.length-1),e}function mae(n,e){return n.map(t=>t*e)}function pae(n,e){return n.map(()=>e||D7).splice(0,n.length-1)}function Mv({duration:n=300,keyframes:e,times:t,ease:r="easeInOut"}){const i=cae(r)?r.map(H3):H3(r),s={done:!1,value:e[0]},a=mae(t&&t.length===e.length?t:gae(e),n),o=dae(a,e,{ease:Array.isArray(i)?i:pae(e,i)});return{calculatedDuration:n,next:l=>(s.value=o(l),s.done=l>=n,s)}}const yae=n=>{const e=({timestamp:t})=>n(t);return{start:()=>mr.update(e,!0),stop:()=>Vu(e),now:()=>Bi.isProcessing?Bi.timestamp:cl.now()}},xae={decay:W3,inertia:W3,tween:Mv,keyframes:Mv,spring:O7},_ae=n=>n/100;class CI extends P7{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:l}=this.options;l&&l()};const{name:t,motionValue:r,element:i,keyframes:s}=this.options,a=i?.KeyframeResolver||kI,o=(l,c)=>this.onKeyframesResolved(l,c);this.resolver=new a(s,o,t,r,i),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:t="keyframes",repeat:r=0,repeatDelay:i=0,repeatType:s,velocity:a=0}=this.options,o=yI(t)?t:xae[t]||Mv;let l,c;o!==Mv&&typeof e[0]!="number"&&(l=X1(_ae,M7(e[0],e[1])),e=[0,100]);const h=o({...this.options,keyframes:e});s==="mirror"&&(c=o({...this.options,keyframes:[...e].reverse(),velocity:-a})),h.calculatedDuration===null&&(h.calculatedDuration=Q9(h));const{calculatedDuration:g}=h,m=g+i,y=m*(r+1)-i;return{generator:h,mirroredGenerator:c,mapPercentToKeyframes:l,calculatedDuration:g,resolvedDuration:m,totalDuration:y}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,t=!1){const{resolved:r}=this;if(!r){const{keyframes:A}=this.options;return{done:!0,value:A[A.length-1]}}const{finalKeyframe:i,generator:s,mirroredGenerator:a,mapPercentToKeyframes:o,keyframes:l,calculatedDuration:c,totalDuration:h,resolvedDuration:g}=r;if(this.startTime===null)return s.next(0);const{delay:m,repeat:y,repeatType:_,repeatDelay:x,onUpdate:w}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-h/this.speed,this.startTime)),t?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const b=this.currentTime-m*(this.speed>=0?1:-1),T=this.speed>=0?b<0:b>h;this.currentTime=Math.max(b,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=h);let k=this.currentTime,L=s;if(y){const A=Math.min(this.currentTime,h)/g;let P=Math.floor(A),D=A%1;!D&&A>=1&&(D=1),D===1&&P--,P=Math.min(P,y+1),P%2&&(_==="reverse"?(D=1-D,x&&(D-=x/g)):_==="mirror"&&(L=a)),k=cc(0,1,D)*g}const O=T?{done:!1,value:l[0]}:L.next(k);o&&(O.value=o(O.value));let{done:B}=O;!T&&c!==null&&(B=this.speed>=0?this.currentTime>=h:this.currentTime<=0);const R=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&B);return R&&i!==void 0&&(O.value=TE(l,this.options,i)),w&&w(O.value),R&&this.finish(),O}get duration(){const{resolved:e}=this;return e?ec(e.calculatedDuration):0}get time(){return ec(this.currentTime)}set time(e){e=Ql(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=ec(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=yae,onPlay:t,startTime:r}=this.options;this.driver||(this.driver=e(s=>this.tick(s))),t&&t();const i=this.driver.now();this.holdTime!==null?this.startTime=i-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=i):this.startTime=r??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const vae=new Set(["opacity","clipPath","filter","transform"]);function wae(n,e,t,{delay:r=0,duration:i=300,repeat:s=0,repeatType:a="loop",ease:o="easeInOut",times:l}={}){const c={[e]:t};l&&(c.offset=l);const h=n7(o,i);return Array.isArray(h)&&(c.easing=h),n.animate(c,{delay:r,duration:i,easing:Array.isArray(h)?"linear":h,fill:"both",iterations:s+1,direction:a==="reverse"?"alternate":"normal"})}const Eae=nI(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Lv=10,Sae=2e4;function bae(n){return yI(n.type)||n.type==="spring"||!t7(n.ease)}function Tae(n,e){const t=new CI({...e,keyframes:n,repeat:0,delay:0,isGenerator:!0});let r={done:!1,value:n[0]};const i=[];let s=0;for(;!r.done&&s<Sae;)r=t.sample(s),i.push(r.value),s+=Lv;return{times:void 0,keyframes:i,duration:s-Lv,ease:"linear"}}const j7={anticipate:g7,backInOut:f7,circInOut:p7};function Rae(n){return n in j7}class K3 extends P7{constructor(e){super(e);const{name:t,motionValue:r,element:i,keyframes:s}=this.options;this.resolver=new C7(s,(a,o)=>this.onKeyframesResolved(a,o),t,r,i),this.resolver.scheduleResolve()}initPlayback(e,t){let{duration:r=300,times:i,ease:s,type:a,motionValue:o,name:l,startTime:c}=this.options;if(!o.owner||!o.owner.current)return!1;if(typeof s=="string"&&Pv()&&Rae(s)&&(s=j7[s]),bae(this.options)){const{onComplete:g,onUpdate:m,motionValue:y,element:_,...x}=this.options,w=Tae(e,x);e=w.keyframes,e.length===1&&(e[1]=e[0]),r=w.duration,i=w.times,s=w.ease,a="keyframes"}const h=wae(o.owner.current,l,e,{...this.options,duration:r,times:i,ease:s});return h.startTime=c??this.calcStartTime(),this.pendingTimeline?(P3(h,this.pendingTimeline),this.pendingTimeline=void 0):h.onfinish=()=>{const{onComplete:g}=this.options;o.set(TE(e,this.options,t)),g&&g(),this.cancel(),this.resolveFinishedPromise()},{animation:h,duration:r,times:i,type:a,ease:s,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:t}=e;return ec(t)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:t}=e;return ec(t.currentTime||0)}set time(e){const{resolved:t}=this;if(!t)return;const{animation:r}=t;r.currentTime=Ql(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:t}=e;return t.playbackRate}set speed(e){const{resolved:t}=this;if(!t)return;const{animation:r}=t;r.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:t}=e;return t.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:t}=e;return t.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:t}=this;if(!t)return da;const{animation:r}=t;P3(r,e)}return da}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.playState==="finished"&&this.updateFinishedPromise(),t.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:t,keyframes:r,duration:i,type:s,ease:a,times:o}=e;if(t.playState==="idle"||t.playState==="finished")return;if(this.time){const{motionValue:c,onUpdate:h,onComplete:g,element:m,...y}=this.options,_=new CI({...y,keyframes:r,duration:i,type:s,ease:a,times:o,isGenerator:!0}),x=Ql(this.time);c.setWithVelocity(_.sample(x-Lv).value,_.sample(x).value,Lv)}const{onStop:l}=this.options;l&&l(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:t,name:r,repeatDelay:i,repeatType:s,damping:a,type:o}=e;if(!t||!t.owner||!(t.owner.current instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:c}=t.owner.getProps();return Eae()&&r&&vae.has(r)&&!l&&!c&&!i&&s!=="mirror"&&a!==0&&o!=="inertia"}}const Aae={type:"spring",stiffness:500,damping:25,restSpeed:10},kae=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),Iae={type:"keyframes",duration:.8},Cae={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Pae=(n,{keyframes:e})=>e.length>2?Iae:Fd.has(n)?n.startsWith("scale")?kae(e[1]):Aae:Cae;function Nae({when:n,delay:e,delayChildren:t,staggerChildren:r,staggerDirection:i,repeat:s,repeatType:a,repeatDelay:o,from:l,elapsed:c,...h}){return!!Object.keys(h).length}const PI=(n,e,t,r={},i,s)=>a=>{const o=pI(r,n)||{},l=o.delay||r.delay||0;let{elapsed:c=0}=r;c=c-Ql(l);let h={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...o,delay:-c,onUpdate:m=>{e.set(m),o.onUpdate&&o.onUpdate(m)},onComplete:()=>{a(),o.onComplete&&o.onComplete()},name:n,motionValue:e,element:s?void 0:i};Nae(o)||(h={...h,...Pae(n,h)}),h.duration&&(h.duration=Ql(h.duration)),h.repeatDelay&&(h.repeatDelay=Ql(h.repeatDelay)),h.from!==void 0&&(h.keyframes[0]=h.from);let g=!1;if((h.type===!1||h.duration===0&&!h.repeatDelay)&&(h.duration=0,h.delay===0&&(g=!0)),g&&!s&&e.get()!==void 0){const m=TE(h.keyframes,o);if(m!==void 0)return mr.update(()=>{h.onUpdate(m),h.onComplete()}),new Zie([])}return!s&&K3.supports(h)?new K3(h):new CI(h)};function Mae({protectedKeys:n,needsAnimating:e},t){const r=n.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,r}function F7(n,e,{delay:t=0,transitionOverride:r,type:i}={}){var s;let{transition:a=n.getDefaultTransition(),transitionEnd:o,...l}=e;r&&(a=r);const c=[],h=i&&n.animationState&&n.animationState.getState()[i];for(const g in l){const m=n.getValue(g,(s=n.latestValues[g])!==null&&s!==void 0?s:null),y=l[g];if(y===void 0||h&&Mae(h,g))continue;const _={delay:t,...pI(a||{},g)};let x=!1;if(window.MotionHandoffAnimation){const b=l7(n);if(b){const T=window.MotionHandoffAnimation(b,g,mr);T!==null&&(_.startTime=T,x=!0)}}gR(n,g),m.start(PI(g,m,y,n.shouldReduceMotion&&a7.has(g)?{type:!1}:_,n,x));const w=m.animation;w&&c.push(w)}return o&&Promise.all(c).then(()=>{mr.update(()=>{o&&hse(n,o)})}),c}function wR(n,e,t={}){var r;const i=bE(n,e,t.type==="exit"?(r=n.presenceContext)===null||r===void 0?void 0:r.custom:void 0);let{transition:s=n.getDefaultTransition()||{}}=i||{};t.transitionOverride&&(s=t.transitionOverride);const a=i?()=>Promise.all(F7(n,i,t)):()=>Promise.resolve(),o=n.variantChildren&&n.variantChildren.size?(c=0)=>{const{delayChildren:h=0,staggerChildren:g,staggerDirection:m}=s;return Lae(n,e,h+c,g,m,t)}:()=>Promise.resolve(),{when:l}=s;if(l){const[c,h]=l==="beforeChildren"?[a,o]:[o,a];return c().then(()=>h())}else return Promise.all([a(),o(t.delay)])}function Lae(n,e,t=0,r=0,i=1,s){const a=[],o=(n.variantChildren.size-1)*r,l=i===1?(c=0)=>c*r:(c=0)=>o-c*r;return Array.from(n.variantChildren).sort(Oae).forEach((c,h)=>{c.notify("AnimationStart",e),a.push(wR(c,e,{...s,delay:t+l(h)}).then(()=>c.notify("AnimationComplete",e)))}),Promise.all(a)}function Oae(n,e){return n.sortNodePosition(e)}function Dae(n,e,t={}){n.notify("AnimationStart",e);let r;if(Array.isArray(e)){const i=e.map(s=>wR(n,s,t));r=Promise.all(i)}else if(typeof e=="string")r=wR(n,e,t);else{const i=typeof e=="function"?bE(n,e,t.custom):e;r=Promise.all(F7(n,i,t))}return r.then(()=>{n.notify("AnimationComplete",e)})}const jae=iI.length;function V7(n){if(!n)return;if(!n.isControllingVariants){const t=n.parent?V7(n.parent)||{}:{};return n.props.initial!==void 0&&(t.initial=n.props.initial),t}const e={};for(let t=0;t<jae;t++){const r=iI[t],i=n.props[r];(qp(i)||i===!1)&&(e[r]=i)}return e}const Fae=[...rI].reverse(),Vae=rI.length;function Bae(n){return e=>Promise.all(e.map(({animation:t,options:r})=>Dae(n,t,r)))}function Gae(n){let e=Bae(n),t=X3(),r=!0;const i=l=>(c,h)=>{var g;const m=bE(n,h,l==="exit"?(g=n.presenceContext)===null||g===void 0?void 0:g.custom:void 0);if(m){const{transition:y,transitionEnd:_,...x}=m;c={...c,...x,..._}}return c};function s(l){e=l(n)}function a(l){const{props:c}=n,h=V7(n.parent)||{},g=[],m=new Set;let y={},_=1/0;for(let w=0;w<Vae;w++){const b=Fae[w],T=t[b],k=c[b]!==void 0?c[b]:h[b],L=qp(k),O=b===l?T.isActive:null;O===!1&&(_=w);let B=k===h[b]&&k!==c[b]&&L;if(B&&r&&n.manuallyAnimateOnMount&&(B=!1),T.protectedKeys={...y},!T.isActive&&O===null||!k&&!T.prevProp||EE(k)||typeof k=="boolean")continue;const R=zae(T.prevProp,k);let A=R||b===l&&T.isActive&&!B&&L||w>_&&L,P=!1;const D=Array.isArray(k)?k:[k];let N=D.reduce(i(b),{});O===!1&&(N={});const{prevResolvedValues:G={}}=T,j={...G,...N},ve=Pe=>{A=!0,m.has(Pe)&&(P=!0,m.delete(Pe)),T.needsAnimating[Pe]=!0;const ue=n.getValue(Pe);ue&&(ue.liveStyle=!1)};for(const Pe in j){const ue=N[Pe],Ne=G[Pe];if(y.hasOwnProperty(Pe))continue;let be=!1;hR(ue)&&hR(Ne)?be=!J9(ue,Ne):be=ue!==Ne,be?ue!=null?ve(Pe):m.add(Pe):ue!==void 0&&m.has(Pe)?ve(Pe):T.protectedKeys[Pe]=!0}T.prevProp=k,T.prevResolvedValues=N,T.isActive&&(y={...y,...N}),r&&n.blockInitialAnimation&&(A=!1),A&&(!(B&&R)||P)&&g.push(...D.map(Pe=>({animation:Pe,options:{type:b}})))}if(m.size){const w={};m.forEach(b=>{const T=n.getBaseTarget(b),k=n.getValue(b);k&&(k.liveStyle=!0),w[b]=T??null}),g.push({animation:w})}let x=!!g.length;return r&&(c.initial===!1||c.initial===c.animate)&&!n.manuallyAnimateOnMount&&(x=!1),r=!1,x?e(g):Promise.resolve()}function o(l,c){var h;if(t[l].isActive===c)return Promise.resolve();(h=n.variantChildren)===null||h===void 0||h.forEach(m=>{var y;return(y=m.animationState)===null||y===void 0?void 0:y.setActive(l,c)}),t[l].isActive=c;const g=a(l);for(const m in t)t[m].protectedKeys={};return g}return{animateChanges:a,setActive:o,setAnimateFunction:s,getState:()=>t,reset:()=>{t=X3(),r=!0}}}function zae(n,e){return typeof e=="string"?e!==n:Array.isArray(e)?!J9(e,n):!1}function Sh(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function X3(){return{animate:Sh(!0),whileInView:Sh(),whileHover:Sh(),whileTap:Sh(),whileDrag:Sh(),whileFocus:Sh(),exit:Sh()}}class Yu{constructor(e){this.isMounted=!1,this.node=e}update(){}}class Uae extends Yu{constructor(e){super(e),e.animationState||(e.animationState=Gae(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();EE(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let $ae=0;class Wae extends Yu{constructor(){super(...arguments),this.id=$ae++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;const i=this.node.animationState.setActive("exit",!e);t&&!e&&i.then(()=>t(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const Hae={animation:{Feature:Uae},exit:{Feature:Wae}};function Qp(n,e,t,r={passive:!0}){return n.addEventListener(e,t,r),()=>n.removeEventListener(e,t)}function q1(n){return{point:{x:n.pageX,y:n.pageY}}}const Kae=n=>e=>_I(e)&&n(e,q1(e));function Qm(n,e,t,r){return Qp(n,e,Kae(t),r)}const q3=(n,e)=>Math.abs(n-e);function Xae(n,e){const t=q3(n.x,e.x),r=q3(n.y,e.y);return Math.sqrt(t**2+r**2)}class B7{constructor(e,t,{transformPagePoint:r,contextWindow:i,dragSnapToOrigin:s=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const g=bb(this.lastMoveEventInfo,this.history),m=this.startEvent!==null,y=Xae(g.offset,{x:0,y:0})>=3;if(!m&&!y)return;const{point:_}=g,{timestamp:x}=Bi;this.history.push({..._,timestamp:x});const{onStart:w,onMove:b}=this.handlers;m||(w&&w(this.lastMoveEvent,g),this.startEvent=this.lastMoveEvent),b&&b(this.lastMoveEvent,g)},this.handlePointerMove=(g,m)=>{this.lastMoveEvent=g,this.lastMoveEventInfo=Sb(m,this.transformPagePoint),mr.update(this.updatePoint,!0)},this.handlePointerUp=(g,m)=>{this.end();const{onEnd:y,onSessionEnd:_,resumeAnimation:x}=this.handlers;if(this.dragSnapToOrigin&&x&&x(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const w=bb(g.type==="pointercancel"?this.lastMoveEventInfo:Sb(m,this.transformPagePoint),this.history);this.startEvent&&y&&y(g,w),_&&_(g,w)},!_I(e))return;this.dragSnapToOrigin=s,this.handlers=t,this.transformPagePoint=r,this.contextWindow=i||window;const a=q1(e),o=Sb(a,this.transformPagePoint),{point:l}=o,{timestamp:c}=Bi;this.history=[{...l,timestamp:c}];const{onSessionStart:h}=t;h&&h(e,bb(o,this.history)),this.removeListeners=X1(Qm(this.contextWindow,"pointermove",this.handlePointerMove),Qm(this.contextWindow,"pointerup",this.handlePointerUp),Qm(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Vu(this.updatePoint)}}function Sb(n,e){return e?{point:e(n.point)}:n}function Y3(n,e){return{x:n.x-e.x,y:n.y-e.y}}function bb({point:n},e){return{point:n,delta:Y3(n,G7(e)),offset:Y3(n,qae(e)),velocity:Yae(e,.1)}}function qae(n){return n[0]}function G7(n){return n[n.length-1]}function Yae(n,e){if(n.length<2)return{x:0,y:0};let t=n.length-1,r=null;const i=G7(n);for(;t>=0&&(r=n[t],!(i.timestamp-r.timestamp>Ql(e)));)t--;if(!r)return{x:0,y:0};const s=ec(i.timestamp-r.timestamp);if(s===0)return{x:0,y:0};const a={x:(i.x-r.x)/s,y:(i.y-r.y)/s};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}const z7=1e-4,Zae=1-z7,Jae=1+z7,U7=.01,Qae=0-U7,eoe=0+U7;function ma(n){return n.max-n.min}function toe(n,e,t){return Math.abs(n-e)<=t}function Z3(n,e,t,r=.5){n.origin=r,n.originPoint=Nr(e.min,e.max,n.origin),n.scale=ma(t)/ma(e),n.translate=Nr(t.min,t.max,n.origin)-n.originPoint,(n.scale>=Zae&&n.scale<=Jae||isNaN(n.scale))&&(n.scale=1),(n.translate>=Qae&&n.translate<=eoe||isNaN(n.translate))&&(n.translate=0)}function ep(n,e,t,r){Z3(n.x,e.x,t.x,r?r.originX:void 0),Z3(n.y,e.y,t.y,r?r.originY:void 0)}function J3(n,e,t){n.min=t.min+e.min,n.max=n.min+ma(e)}function noe(n,e,t){J3(n.x,e.x,t.x),J3(n.y,e.y,t.y)}function Q3(n,e,t){n.min=e.min-t.min,n.max=n.min+ma(e)}function tp(n,e,t){Q3(n.x,e.x,t.x),Q3(n.y,e.y,t.y)}function roe(n,{min:e,max:t},r){return e!==void 0&&n<e?n=r?Nr(e,n,r.min):Math.max(n,e):t!==void 0&&n>t&&(n=r?Nr(t,n,r.max):Math.min(n,t)),n}function e5(n,e,t){return{min:e!==void 0?n.min+e:void 0,max:t!==void 0?n.max+t-(n.max-n.min):void 0}}function ioe(n,{top:e,left:t,bottom:r,right:i}){return{x:e5(n.x,t,i),y:e5(n.y,e,r)}}function t5(n,e){let t=e.min-n.min,r=e.max-n.max;return e.max-e.min<n.max-n.min&&([t,r]=[r,t]),{min:t,max:r}}function soe(n,e){return{x:t5(n.x,e.x),y:t5(n.y,e.y)}}function aoe(n,e){let t=.5;const r=ma(n),i=ma(e);return i>r?t=Y0(e.min,e.max-r,n.min):r>i&&(t=Y0(n.min,n.max-i,e.min)),cc(0,1,t)}function ooe(n,e){const t={};return e.min!==void 0&&(t.min=e.min-n.min),e.max!==void 0&&(t.max=e.max-n.min),t}const ER=.35;function loe(n=ER){return n===!1?n=0:n===!0&&(n=ER),{x:n5(n,"left","right"),y:n5(n,"top","bottom")}}function n5(n,e,t){return{min:r5(n,e),max:r5(n,t)}}function r5(n,e){return typeof n=="number"?n:n[e]||0}const i5=()=>({translate:0,scale:1,origin:0,originPoint:0}),i0=()=>({x:i5(),y:i5()}),s5=()=>({min:0,max:0}),Wr=()=>({x:s5(),y:s5()});function Ia(n){return[n("x"),n("y")]}function $7({top:n,left:e,right:t,bottom:r}){return{x:{min:e,max:t},y:{min:n,max:r}}}function coe({x:n,y:e}){return{top:e.min,right:n.max,bottom:e.max,left:n.min}}function uoe(n,e){if(!e)return n;const t=e({x:n.left,y:n.top}),r=e({x:n.right,y:n.bottom});return{top:t.y,left:t.x,bottom:r.y,right:r.x}}function Tb(n){return n===void 0||n===1}function SR({scale:n,scaleX:e,scaleY:t}){return!Tb(n)||!Tb(e)||!Tb(t)}function Ch(n){return SR(n)||W7(n)||n.z||n.rotate||n.rotateX||n.rotateY||n.skewX||n.skewY}function W7(n){return a5(n.x)||a5(n.y)}function a5(n){return n&&n!=="0%"}function Ov(n,e,t){const r=n-t,i=e*r;return t+i}function o5(n,e,t,r,i){return i!==void 0&&(n=Ov(n,i,r)),Ov(n,t,r)+e}function bR(n,e=0,t=1,r,i){n.min=o5(n.min,e,t,r,i),n.max=o5(n.max,e,t,r,i)}function H7(n,{x:e,y:t}){bR(n.x,e.translate,e.scale,e.originPoint),bR(n.y,t.translate,t.scale,t.originPoint)}const l5=.999999999999,c5=1.0000000000001;function hoe(n,e,t,r=!1){const i=t.length;if(!i)return;e.x=e.y=1;let s,a;for(let o=0;o<i;o++){s=t[o],a=s.projectionDelta;const{visualElement:l}=s.options;l&&l.props.style&&l.props.style.display==="contents"||(r&&s.options.layoutScroll&&s.scroll&&s!==s.root&&a0(n,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),a&&(e.x*=a.x.scale,e.y*=a.y.scale,H7(n,a)),r&&Ch(s.latestValues)&&a0(n,s.latestValues))}e.x<c5&&e.x>l5&&(e.x=1),e.y<c5&&e.y>l5&&(e.y=1)}function s0(n,e){n.min=n.min+e,n.max=n.max+e}function u5(n,e,t,r,i=.5){const s=Nr(n.min,n.max,i);bR(n,e,t,s,r)}function a0(n,e){u5(n.x,e.x,e.scaleX,e.scale,e.originX),u5(n.y,e.y,e.scaleY,e.scale,e.originY)}function K7(n,e){return $7(uoe(n.getBoundingClientRect(),e))}function doe(n,e,t){const r=K7(n,t),{scroll:i}=e;return i&&(s0(r.x,i.offset.x),s0(r.y,i.offset.y)),r}const X7=({current:n})=>n?n.ownerDocument.defaultView:null,foe=new WeakMap;class goe{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Wr(),this.visualElement=e}start(e,{snapToCursor:t=!1}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const i=h=>{const{dragSnapToOrigin:g}=this.getProps();g?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(q1(h).point)},s=(h,g)=>{const{drag:m,dragPropagation:y,onDragStart:_}=this.getProps();if(m&&!y&&(this.openDragLock&&this.openDragLock(),this.openDragLock=ase(m),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Ia(w=>{let b=this.getAxisMotionValue(w).get()||0;if(ll.test(b)){const{projection:T}=this.visualElement;if(T&&T.layout){const k=T.layout.layoutBox[w];k&&(b=ma(k)*(parseFloat(b)/100))}}this.originPoint[w]=b}),_&&mr.postRender(()=>_(h,g)),gR(this.visualElement,"transform");const{animationState:x}=this.visualElement;x&&x.setActive("whileDrag",!0)},a=(h,g)=>{const{dragPropagation:m,dragDirectionLock:y,onDirectionLock:_,onDrag:x}=this.getProps();if(!m&&!this.openDragLock)return;const{offset:w}=g;if(y&&this.currentDirection===null){this.currentDirection=moe(w),this.currentDirection!==null&&_&&_(this.currentDirection);return}this.updateAxis("x",g.point,w),this.updateAxis("y",g.point,w),this.visualElement.render(),x&&x(h,g)},o=(h,g)=>this.stop(h,g),l=()=>Ia(h=>{var g;return this.getAnimationState(h)==="paused"&&((g=this.getAxisMotionValue(h).animation)===null||g===void 0?void 0:g.play())}),{dragSnapToOrigin:c}=this.getProps();this.panSession=new B7(e,{onSessionStart:i,onStart:s,onMove:a,onSessionEnd:o,resumeAnimation:l},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:c,contextWindow:X7(this.visualElement)})}stop(e,t){const r=this.isDragging;if(this.cancel(),!r)return;const{velocity:i}=t;this.startAnimation(i);const{onDragEnd:s}=this.getProps();s&&mr.postRender(()=>s(e,t))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,r){const{drag:i}=this.getProps();if(!r||!Fx(e,i,this.currentDirection))return;const s=this.getAxisMotionValue(e);let a=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(a=roe(a,this.constraints[e],this.elastic[e])),s.set(a)}resolveConstraints(){var e;const{dragConstraints:t,dragElastic:r}=this.getProps(),i=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,s=this.constraints;t&&n0(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&i?this.constraints=ioe(i.layoutBox,t):this.constraints=!1,this.elastic=loe(r),s!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&Ia(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=ooe(i.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!n0(e))return!1;const r=e.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const s=doe(r,i.root,this.visualElement.getTransformPagePoint());let a=soe(i.layout.layoutBox,s);if(t){const o=t(coe(a));this.hasMutatedConstraints=!!o,o&&(a=$7(o))}return a}startAnimation(e){const{drag:t,dragMomentum:r,dragElastic:i,dragTransition:s,dragSnapToOrigin:a,onDragTransitionEnd:o}=this.getProps(),l=this.constraints||{},c=Ia(h=>{if(!Fx(h,t,this.currentDirection))return;let g=l&&l[h]||{};a&&(g={min:0,max:0});const m=i?200:1e6,y=i?40:1e7,_={type:"inertia",velocity:r?e[h]:0,bounceStiffness:m,bounceDamping:y,timeConstant:750,restDelta:1,restSpeed:10,...s,...g};return this.startAxisValueAnimation(h,_)});return Promise.all(c).then(o)}startAxisValueAnimation(e,t){const r=this.getAxisMotionValue(e);return gR(this.visualElement,e),r.start(PI(e,r,0,t,this.visualElement,!1))}stopAnimation(){Ia(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Ia(e=>{var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.pause()})}getAnimationState(e){var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,r=this.visualElement.getProps(),i=r[t];return i||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){Ia(t=>{const{drag:r}=this.getProps();if(!Fx(t,r,this.currentDirection))return;const{projection:i}=this.visualElement,s=this.getAxisMotionValue(t);if(i&&i.layout){const{min:a,max:o}=i.layout.layoutBox[t];s.set(e[t]-Nr(a,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:r}=this.visualElement;if(!n0(t)||!r||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};Ia(a=>{const o=this.getAxisMotionValue(a);if(o&&this.constraints!==!1){const l=o.get();i[a]=aoe({min:l,max:l},this.constraints[a])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),Ia(a=>{if(!Fx(a,e,null))return;const o=this.getAxisMotionValue(a),{min:l,max:c}=this.constraints[a];o.set(Nr(l,c,i[a]))})}addListeners(){if(!this.visualElement.current)return;foe.set(this.visualElement,this);const e=this.visualElement.current,t=Qm(e,"pointerdown",l=>{const{drag:c,dragListener:h=!0}=this.getProps();c&&h&&this.start(l)}),r=()=>{const{dragConstraints:l}=this.getProps();n0(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,s=i.addEventListener("measure",r);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),mr.read(r);const a=Qp(window,"resize",()=>this.scalePositionWithinConstraints()),o=i.addEventListener("didUpdate",(({delta:l,hasLayoutChanged:c})=>{this.isDragging&&c&&(Ia(h=>{const g=this.getAxisMotionValue(h);g&&(this.originPoint[h]+=l[h].translate,g.set(g.get()+l[h].translate))}),this.visualElement.render())}));return()=>{a(),t(),s(),o&&o()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:r=!1,dragPropagation:i=!1,dragConstraints:s=!1,dragElastic:a=ER,dragMomentum:o=!0}=e;return{...e,drag:t,dragDirectionLock:r,dragPropagation:i,dragConstraints:s,dragElastic:a,dragMomentum:o}}}function Fx(n,e,t){return(e===!0||e===n)&&(t===null||t===n)}function moe(n,e=10){let t=null;return Math.abs(n.y)>e?t="y":Math.abs(n.x)>e&&(t="x"),t}class poe extends Yu{constructor(e){super(e),this.removeGroupControls=da,this.removeListeners=da,this.controls=new goe(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||da}unmount(){this.removeGroupControls(),this.removeListeners()}}const h5=n=>(e,t)=>{n&&mr.postRender(()=>n(e,t))};class yoe extends Yu{constructor(){super(...arguments),this.removePointerDownListener=da}onPointerDown(e){this.session=new B7(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:X7(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:r,onPanEnd:i}=this.node.getProps();return{onSessionStart:h5(e),onStart:h5(t),onMove:r,onEnd:(s,a)=>{delete this.session,i&&mr.postRender(()=>i(s,a))}}}mount(){this.removePointerDownListener=Qm(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const S_={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function d5(n,e){return e.max===e.min?0:n/(e.max-e.min)*100}const _m={correct:(n,e)=>{if(!e.target)return n;if(typeof n=="string")if($t.test(n))n=parseFloat(n);else return n;const t=d5(n,e.target.x),r=d5(n,e.target.y);return`${t}% ${r}%`}},xoe={correct:(n,{treeScale:e,projectionDelta:t})=>{const r=n,i=Bu.parse(n);if(i.length>5)return r;const s=Bu.createTransformer(n),a=typeof i[0]!="number"?1:0,o=t.x.scale*e.x,l=t.y.scale*e.y;i[0+a]/=o,i[1+a]/=l;const c=Nr(o,l,.5);return typeof i[2+a]=="number"&&(i[2+a]/=c),typeof i[3+a]=="number"&&(i[3+a]/=c),s(i)}};class _oe extends H.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r,layoutId:i}=this.props,{projection:s}=e;Vie(voe),s&&(t.group&&t.group.add(s),r&&r.register&&i&&r.register(s),s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),S_.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:r,drag:i,isPresent:s}=this.props,a=r.projection;return a&&(a.isPresent=s,i||e.layoutDependency!==t||t===void 0?a.willUpdate():this.safeToRemove(),e.isPresent!==s&&(s?a.promote():a.relegate()||mr.postRender(()=>{const o=a.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),aI.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r}=this.props,{projection:i}=e;i&&(i.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(i),r&&r.deregister&&r.deregister(i))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function q7(n){const[e,t]=P9(),r=H.useContext(Jk);return f.jsx(_oe,{...n,layoutGroup:r,switchLayoutGroup:H.useContext(V9),isPresent:e,safeToRemove:t})}const voe={borderRadius:{..._m,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:_m,borderTopRightRadius:_m,borderBottomLeftRadius:_m,borderBottomRightRadius:_m,boxShadow:xoe};function woe(n,e,t){const r=hs(n)?n:Zp(n);return r.start(PI("",r,e,t)),r.animation}function Eoe(n){return n instanceof SVGElement&&n.tagName!=="svg"}const Soe=(n,e)=>n.depth-e.depth;class boe{constructor(){this.children=[],this.isDirty=!1}add(e){vI(this.children,e),this.isDirty=!0}remove(e){wI(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(Soe),this.isDirty=!1,this.children.forEach(e)}}function Toe(n,e){const t=cl.now(),r=({timestamp:i})=>{const s=i-t;s>=e&&(Vu(r),n(s-e))};return mr.read(r,!0),()=>Vu(r)}const Y7=["TopLeft","TopRight","BottomLeft","BottomRight"],Roe=Y7.length,f5=n=>typeof n=="string"?parseFloat(n):n,g5=n=>typeof n=="number"||$t.test(n);function Aoe(n,e,t,r,i,s){i?(n.opacity=Nr(0,t.opacity!==void 0?t.opacity:1,koe(r)),n.opacityExit=Nr(e.opacity!==void 0?e.opacity:1,0,Ioe(r))):s&&(n.opacity=Nr(e.opacity!==void 0?e.opacity:1,t.opacity!==void 0?t.opacity:1,r));for(let a=0;a<Roe;a++){const o=`border${Y7[a]}Radius`;let l=m5(e,o),c=m5(t,o);if(l===void 0&&c===void 0)continue;l||(l=0),c||(c=0),l===0||c===0||g5(l)===g5(c)?(n[o]=Math.max(Nr(f5(l),f5(c),r),0),(ll.test(c)||ll.test(l))&&(n[o]+="%")):n[o]=c}(e.rotate||t.rotate)&&(n.rotate=Nr(e.rotate||0,t.rotate||0,r))}function m5(n,e){return n[e]!==void 0?n[e]:n.borderRadius}const koe=Z7(0,.5,m7),Ioe=Z7(.5,.95,da);function Z7(n,e,t){return r=>r<n?0:r>e?1:t(Y0(n,e,r))}function p5(n,e){n.min=e.min,n.max=e.max}function Aa(n,e){p5(n.x,e.x),p5(n.y,e.y)}function y5(n,e){n.translate=e.translate,n.scale=e.scale,n.originPoint=e.originPoint,n.origin=e.origin}function x5(n,e,t,r,i){return n-=e,n=Ov(n,1/t,r),i!==void 0&&(n=Ov(n,1/i,r)),n}function Coe(n,e=0,t=1,r=.5,i,s=n,a=n){if(ll.test(e)&&(e=parseFloat(e),e=Nr(a.min,a.max,e/100)-a.min),typeof e!="number")return;let o=Nr(s.min,s.max,r);n===s&&(o-=e),n.min=x5(n.min,e,t,o,i),n.max=x5(n.max,e,t,o,i)}function _5(n,e,[t,r,i],s,a){Coe(n,e[t],e[r],e[i],e.scale,s,a)}const Poe=["x","scaleX","originX"],Noe=["y","scaleY","originY"];function v5(n,e,t,r){_5(n.x,e,Poe,t?t.x:void 0,r?r.x:void 0),_5(n.y,e,Noe,t?t.y:void 0,r?r.y:void 0)}function w5(n){return n.translate===0&&n.scale===1}function J7(n){return w5(n.x)&&w5(n.y)}function E5(n,e){return n.min===e.min&&n.max===e.max}function Moe(n,e){return E5(n.x,e.x)&&E5(n.y,e.y)}function S5(n,e){return Math.round(n.min)===Math.round(e.min)&&Math.round(n.max)===Math.round(e.max)}function Q7(n,e){return S5(n.x,e.x)&&S5(n.y,e.y)}function b5(n){return ma(n.x)/ma(n.y)}function T5(n,e){return n.translate===e.translate&&n.scale===e.scale&&n.originPoint===e.originPoint}class Loe{constructor(){this.members=[]}add(e){vI(this.members,e),e.scheduleRender()}remove(e){if(wI(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(i=>e===i);if(t===0)return!1;let r;for(let i=t;i>=0;i--){const s=this.members[i];if(s.isPresent!==!1){r=s;break}}return r?(this.promote(r),!0):!1}promote(e,t){const r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,t&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:i}=e.options;i===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:r}=e;t.onExitComplete&&t.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function Ooe(n,e,t){let r="";const i=n.x.translate/e.x,s=n.y.translate/e.y,a=t?.z||0;if((i||s||a)&&(r=`translate3d(${i}px, ${s}px, ${a}px) `),(e.x!==1||e.y!==1)&&(r+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:c,rotate:h,rotateX:g,rotateY:m,skewX:y,skewY:_}=t;c&&(r=`perspective(${c}px) ${r}`),h&&(r+=`rotate(${h}deg) `),g&&(r+=`rotateX(${g}deg) `),m&&(r+=`rotateY(${m}deg) `),y&&(r+=`skewX(${y}deg) `),_&&(r+=`skewY(${_}deg) `)}const o=n.x.scale*e.x,l=n.y.scale*e.y;return(o!==1||l!==1)&&(r+=`scale(${o}, ${l})`),r||"none"}const Ph={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},Mm=typeof window<"u"&&window.MotionDebug!==void 0,Rb=["","X","Y","Z"],Doe={visibility:"hidden"},R5=1e3;let joe=0;function Ab(n,e,t,r){const{latestValues:i}=e;i[n]&&(t[n]=i[n],e.setStaticValue(n,0),r&&(r[n]=0))}function eV(n){if(n.hasCheckedOptimisedAppear=!0,n.root===n)return;const{visualElement:e}=n.options;if(!e)return;const t=l7(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:i,layoutId:s}=n.options;window.MotionCancelOptimisedAnimation(t,"transform",mr,!(i||s))}const{parent:r}=n;r&&!r.hasCheckedOptimisedAppear&&eV(r)}function tV({attachResizeListener:n,defaultParent:e,measureScroll:t,checkIsScrollRoot:r,resetTransform:i}){return class{constructor(a={},o=e?.()){this.id=joe++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,Mm&&(Ph.totalNodes=Ph.resolvedTargetDeltas=Ph.recalculatedProjection=0),this.nodes.forEach(Boe),this.nodes.forEach(Woe),this.nodes.forEach(Hoe),this.nodes.forEach(Goe),Mm&&window.MotionDebug.record(Ph)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=a,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new boe)}addEventListener(a,o){return this.eventHandlers.has(a)||this.eventHandlers.set(a,new EI),this.eventHandlers.get(a).add(o)}notifyListeners(a,...o){const l=this.eventHandlers.get(a);l&&l.notify(...o)}hasListeners(a){return this.eventHandlers.has(a)}mount(a,o=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=Eoe(a),this.instance=a;const{layoutId:l,layout:c,visualElement:h}=this.options;if(h&&!h.current&&h.mount(a),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),o&&(c||l)&&(this.isLayoutDirty=!0),n){let g;const m=()=>this.root.updateBlockedByResize=!1;n(a,()=>{this.root.updateBlockedByResize=!0,g&&g(),g=Toe(m,250),S_.hasAnimatedSinceResize&&(S_.hasAnimatedSinceResize=!1,this.nodes.forEach(k5))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&h&&(l||c)&&this.addEventListener("didUpdate",({delta:g,hasLayoutChanged:m,hasRelativeTargetChanged:y,layout:_})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const x=this.options.transition||h.getDefaultTransition()||Zoe,{onLayoutAnimationStart:w,onLayoutAnimationComplete:b}=h.getProps(),T=!this.targetLayout||!Q7(this.targetLayout,_)||y,k=!m&&y;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||k||m&&(T||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(g,k);const L={...pI(x,"layout"),onPlay:w,onComplete:b};(h.shouldReduceMotion||this.options.layoutRoot)&&(L.delay=0,L.type=!1),this.startAnimation(L)}else m||k5(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=_})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const a=this.getStack();a&&a.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Vu(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Koe),this.animationId++)}getTransformTemplate(){const{visualElement:a}=this.options;return a&&a.getProps().transformTemplate}willUpdate(a=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&eV(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let h=0;h<this.path.length;h++){const g=this.path[h];g.shouldResetTransform=!0,g.updateScroll("snapshot"),g.options.layoutRoot&&g.willUpdate(!1)}const{layoutId:o,layout:l}=this.options;if(o===void 0&&!l)return;const c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),a&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(A5);return}this.isUpdating||this.nodes.forEach(Uoe),this.isUpdating=!1,this.nodes.forEach($oe),this.nodes.forEach(Foe),this.nodes.forEach(Voe),this.clearAllSnapshots();const o=cl.now();Bi.delta=cc(0,1e3/60,o-Bi.timestamp),Bi.timestamp=o,Bi.isProcessing=!0,yb.update.process(Bi),yb.preRender.process(Bi),yb.render.process(Bi),Bi.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,aI.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(zoe),this.sharedNodes.forEach(Xoe)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,mr.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){mr.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const a=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Wr(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,a?a.layoutBox:void 0)}updateScroll(a="measure"){let o=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===a&&(o=!1),o){const l=r(this.instance);this.scroll={animationId:this.root.animationId,phase:a,isRoot:l,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!i)return;const a=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,o=this.projectionDelta&&!J7(this.projectionDelta),l=this.getTransformTemplate(),c=l?l(this.latestValues,""):void 0,h=c!==this.prevTransformTemplateValue;a&&(o||Ch(this.latestValues)||h)&&(i(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(a=!0){const o=this.measurePageBox();let l=this.removeElementScroll(o);return a&&(l=this.removeTransform(l)),Joe(l),{animationId:this.root.animationId,measuredBox:o,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var a;const{visualElement:o}=this.options;if(!o)return Wr();const l=o.measureViewportBox();if(!(((a=this.scroll)===null||a===void 0?void 0:a.wasRoot)||this.path.some(Qoe))){const{scroll:h}=this.root;h&&(s0(l.x,h.offset.x),s0(l.y,h.offset.y))}return l}removeElementScroll(a){var o;const l=Wr();if(Aa(l,a),!((o=this.scroll)===null||o===void 0)&&o.wasRoot)return l;for(let c=0;c<this.path.length;c++){const h=this.path[c],{scroll:g,options:m}=h;h!==this.root&&g&&m.layoutScroll&&(g.wasRoot&&Aa(l,a),s0(l.x,g.offset.x),s0(l.y,g.offset.y))}return l}applyTransform(a,o=!1){const l=Wr();Aa(l,a);for(let c=0;c<this.path.length;c++){const h=this.path[c];!o&&h.options.layoutScroll&&h.scroll&&h!==h.root&&a0(l,{x:-h.scroll.offset.x,y:-h.scroll.offset.y}),Ch(h.latestValues)&&a0(l,h.latestValues)}return Ch(this.latestValues)&&a0(l,this.latestValues),l}removeTransform(a){const o=Wr();Aa(o,a);for(let l=0;l<this.path.length;l++){const c=this.path[l];if(!c.instance||!Ch(c.latestValues))continue;SR(c.latestValues)&&c.updateSnapshot();const h=Wr(),g=c.measurePageBox();Aa(h,g),v5(o,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,h)}return Ch(this.latestValues)&&v5(o,this.latestValues),o}setTargetDelta(a){this.targetDelta=a,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(a){this.options={...this.options,...a,crossfade:a.crossfade!==void 0?a.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Bi.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(a=!1){var o;const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==l;if(!(a||c&&this.isSharedProjectionDirty||this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:g,layoutId:m}=this.options;if(!(!this.layout||!(g||m))){if(this.resolvedRelativeTargetAt=Bi.timestamp,!this.targetDelta&&!this.relativeTarget){const y=this.getClosestProjectingParent();y&&y.layout&&this.animationProgress!==1?(this.relativeParent=y,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Wr(),this.relativeTargetOrigin=Wr(),tp(this.relativeTargetOrigin,this.layout.layoutBox,y.layout.layoutBox),Aa(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Wr(),this.targetWithTransforms=Wr()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),noe(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Aa(this.target,this.layout.layoutBox),H7(this.target,this.targetDelta)):Aa(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const y=this.getClosestProjectingParent();y&&!!y.resumingFrom==!!this.resumingFrom&&!y.options.layoutScroll&&y.target&&this.animationProgress!==1?(this.relativeParent=y,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Wr(),this.relativeTargetOrigin=Wr(),tp(this.relativeTargetOrigin,this.target,y.target),Aa(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}Mm&&Ph.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||SR(this.parent.latestValues)||W7(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var a;const o=this.getLead(),l=!!this.resumingFrom||this!==o;let c=!0;if((this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty)&&(c=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===Bi.timestamp&&(c=!1),c)return;const{layout:h,layoutId:g}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(h||g))return;Aa(this.layoutCorrected,this.layout.layoutBox);const m=this.treeScale.x,y=this.treeScale.y;hoe(this.layoutCorrected,this.treeScale,this.path,l),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=Wr());const{target:_}=o;if(!_){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(y5(this.prevProjectionDelta.x,this.projectionDelta.x),y5(this.prevProjectionDelta.y,this.projectionDelta.y)),ep(this.projectionDelta,this.layoutCorrected,_,this.latestValues),(this.treeScale.x!==m||this.treeScale.y!==y||!T5(this.projectionDelta.x,this.prevProjectionDelta.x)||!T5(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",_)),Mm&&Ph.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(a=!0){var o;if((o=this.options.visualElement)===null||o===void 0||o.scheduleRender(),a){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=i0(),this.projectionDelta=i0(),this.projectionDeltaWithTransform=i0()}setAnimationOrigin(a,o=!1){const l=this.snapshot,c=l?l.latestValues:{},h={...this.latestValues},g=i0();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const m=Wr(),y=l?l.source:void 0,_=this.layout?this.layout.source:void 0,x=y!==_,w=this.getStack(),b=!w||w.members.length<=1,T=!!(x&&!b&&this.options.crossfade===!0&&!this.path.some(Yoe));this.animationProgress=0;let k;this.mixTargetDelta=L=>{const O=L/1e3;I5(g.x,a.x,O),I5(g.y,a.y,O),this.setTargetDelta(g),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(tp(m,this.layout.layoutBox,this.relativeParent.layout.layoutBox),qoe(this.relativeTarget,this.relativeTargetOrigin,m,O),k&&Moe(this.relativeTarget,k)&&(this.isProjectionDirty=!1),k||(k=Wr()),Aa(k,this.relativeTarget)),x&&(this.animationValues=h,Aoe(h,c,this.latestValues,O,T,b)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=O},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(a){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Vu(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=mr.update(()=>{S_.hasAnimatedSinceResize=!0,this.currentAnimation=woe(0,R5,{...a,onUpdate:o=>{this.mixTargetDelta(o),a.onUpdate&&a.onUpdate(o)},onComplete:()=>{a.onComplete&&a.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const a=this.getStack();a&&a.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(R5),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const a=this.getLead();let{targetWithTransforms:o,target:l,layout:c,latestValues:h}=a;if(!(!o||!l||!c)){if(this!==a&&this.layout&&c&&nV(this.options.animationType,this.layout.layoutBox,c.layoutBox)){l=this.target||Wr();const g=ma(this.layout.layoutBox.x);l.x.min=a.target.x.min,l.x.max=l.x.min+g;const m=ma(this.layout.layoutBox.y);l.y.min=a.target.y.min,l.y.max=l.y.min+m}Aa(o,l),a0(o,h),ep(this.projectionDeltaWithTransform,this.layoutCorrected,o,h)}}registerSharedNode(a,o){this.sharedNodes.has(a)||this.sharedNodes.set(a,new Loe),this.sharedNodes.get(a).add(o);const c=o.options.initialPromotionConfig;o.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(o):void 0})}isLead(){const a=this.getStack();return a?a.lead===this:!0}getLead(){var a;const{layoutId:o}=this.options;return o?((a=this.getStack())===null||a===void 0?void 0:a.lead)||this:this}getPrevLead(){var a;const{layoutId:o}=this.options;return o?(a=this.getStack())===null||a===void 0?void 0:a.prevLead:void 0}getStack(){const{layoutId:a}=this.options;if(a)return this.root.sharedNodes.get(a)}promote({needsReset:a,transition:o,preserveFollowOpacity:l}={}){const c=this.getStack();c&&c.promote(this,l),a&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const a=this.getStack();return a?a.relegate(this):!1}resetSkewAndRotation(){const{visualElement:a}=this.options;if(!a)return;let o=!1;const{latestValues:l}=a;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(o=!0),!o)return;const c={};l.z&&Ab("z",a,c,this.animationValues);for(let h=0;h<Rb.length;h++)Ab(`rotate${Rb[h]}`,a,c,this.animationValues),Ab(`skew${Rb[h]}`,a,c,this.animationValues);a.render();for(const h in c)a.setStaticValue(h,c[h]),this.animationValues&&(this.animationValues[h]=c[h]);a.scheduleRender()}getProjectionStyles(a){var o,l;if(!this.instance||this.isSVG)return;if(!this.isVisible)return Doe;const c={visibility:""},h=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,c.opacity="",c.pointerEvents=w_(a?.pointerEvents)||"",c.transform=h?h(this.latestValues,""):"none",c;const g=this.getLead();if(!this.projectionDelta||!this.layout||!g.target){const x={};return this.options.layoutId&&(x.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,x.pointerEvents=w_(a?.pointerEvents)||""),this.hasProjected&&!Ch(this.latestValues)&&(x.transform=h?h({},""):"none",this.hasProjected=!1),x}const m=g.animationValues||g.latestValues;this.applyTransformsToTarget(),c.transform=Ooe(this.projectionDeltaWithTransform,this.treeScale,m),h&&(c.transform=h(m,c.transform));const{x:y,y:_}=this.projectionDelta;c.transformOrigin=`${y.origin*100}% ${_.origin*100}% 0`,g.animationValues?c.opacity=g===this?(l=(o=m.opacity)!==null&&o!==void 0?o:this.latestValues.opacity)!==null&&l!==void 0?l:1:this.preserveOpacity?this.latestValues.opacity:m.opacityExit:c.opacity=g===this?m.opacity!==void 0?m.opacity:"":m.opacityExit!==void 0?m.opacityExit:0;for(const x in Cv){if(m[x]===void 0)continue;const{correct:w,applyTo:b}=Cv[x],T=c.transform==="none"?m[x]:w(m[x],g);if(b){const k=b.length;for(let L=0;L<k;L++)c[b[L]]=T}else c[x]=T}return this.options.layoutId&&(c.pointerEvents=g===this?w_(a?.pointerEvents)||"":"none"),c}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(a=>{var o;return(o=a.currentAnimation)===null||o===void 0?void 0:o.stop()}),this.root.nodes.forEach(A5),this.root.sharedNodes.clear()}}}function Foe(n){n.updateLayout()}function Voe(n){var e;const t=((e=n.resumeFrom)===null||e===void 0?void 0:e.snapshot)||n.snapshot;if(n.isLead()&&n.layout&&t&&n.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:i}=n.layout,{animationType:s}=n.options,a=t.source!==n.layout.source;s==="size"?Ia(g=>{const m=a?t.measuredBox[g]:t.layoutBox[g],y=ma(m);m.min=r[g].min,m.max=m.min+y}):nV(s,t.layoutBox,r)&&Ia(g=>{const m=a?t.measuredBox[g]:t.layoutBox[g],y=ma(r[g]);m.max=m.min+y,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[g].max=n.relativeTarget[g].min+y)});const o=i0();ep(o,r,t.layoutBox);const l=i0();a?ep(l,n.applyTransform(i,!0),t.measuredBox):ep(l,r,t.layoutBox);const c=!J7(o);let h=!1;if(!n.resumeFrom){const g=n.getClosestProjectingParent();if(g&&!g.resumeFrom){const{snapshot:m,layout:y}=g;if(m&&y){const _=Wr();tp(_,t.layoutBox,m.layoutBox);const x=Wr();tp(x,r,y.layoutBox),Q7(_,x)||(h=!0),g.options.layoutRoot&&(n.relativeTarget=x,n.relativeTargetOrigin=_,n.relativeParent=g)}}}n.notifyListeners("didUpdate",{layout:r,snapshot:t,delta:l,layoutDelta:o,hasLayoutChanged:c,hasRelativeTargetChanged:h})}else if(n.isLead()){const{onExitComplete:r}=n.options;r&&r()}n.options.transition=void 0}function Boe(n){Mm&&Ph.totalNodes++,n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function Goe(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function zoe(n){n.clearSnapshot()}function A5(n){n.clearMeasurements()}function Uoe(n){n.isLayoutDirty=!1}function $oe(n){const{visualElement:e}=n.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),n.resetTransform()}function k5(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function Woe(n){n.resolveTargetDelta()}function Hoe(n){n.calcProjection()}function Koe(n){n.resetSkewAndRotation()}function Xoe(n){n.removeLeadSnapshot()}function I5(n,e,t){n.translate=Nr(e.translate,0,t),n.scale=Nr(e.scale,1,t),n.origin=e.origin,n.originPoint=e.originPoint}function C5(n,e,t,r){n.min=Nr(e.min,t.min,r),n.max=Nr(e.max,t.max,r)}function qoe(n,e,t,r){C5(n.x,e.x,t.x,r),C5(n.y,e.y,t.y,r)}function Yoe(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const Zoe={duration:.45,ease:[.4,0,.1,1]},P5=n=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(n),N5=P5("applewebkit/")&&!P5("chrome/")?Math.round:da;function M5(n){n.min=N5(n.min),n.max=N5(n.max)}function Joe(n){M5(n.x),M5(n.y)}function nV(n,e,t){return n==="position"||n==="preserve-aspect"&&!toe(b5(e),b5(t),.2)}function Qoe(n){var e;return n!==n.root&&((e=n.scroll)===null||e===void 0?void 0:e.wasRoot)}const ele=tV({attachResizeListener:(n,e)=>Qp(n,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),kb={current:void 0},rV=tV({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!kb.current){const n=new ele({});n.mount(window),n.setOptions({layoutScroll:!0}),kb.current=n}return kb.current},resetTransform:(n,e)=>{n.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),tle={pan:{Feature:yoe},drag:{Feature:poe,ProjectionNode:rV,MeasureLayout:q7}};function L5(n,e,t){const{props:r}=n;n.animationState&&r.whileHover&&n.animationState.setActive("whileHover",t==="Start");const i="onHover"+t,s=r[i];s&&mr.postRender(()=>s(e,q1(e)))}class nle extends Yu{mount(){const{current:e}=this.node;e&&(this.unmount=tse(e,t=>(L5(this.node,t,"Start"),r=>L5(this.node,r,"End"))))}unmount(){}}class rle extends Yu{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=X1(Qp(this.node.current,"focus",()=>this.onFocus()),Qp(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function O5(n,e,t){const{props:r}=n;n.animationState&&r.whileTap&&n.animationState.setActive("whileTap",t==="Start");const i="onTap"+(t==="End"?"":t),s=r[i];s&&mr.postRender(()=>s(e,q1(e)))}class ile extends Yu{mount(){const{current:e}=this.node;e&&(this.unmount=sse(e,t=>(O5(this.node,t,"Start"),(r,{success:i})=>O5(this.node,r,i?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const TR=new WeakMap,Ib=new WeakMap,sle=n=>{const e=TR.get(n.target);e&&e(n)},ale=n=>{n.forEach(sle)};function ole({root:n,...e}){const t=n||document;Ib.has(t)||Ib.set(t,{});const r=Ib.get(t),i=JSON.stringify(e);return r[i]||(r[i]=new IntersectionObserver(ale,{root:n,...e})),r[i]}function lle(n,e,t){const r=ole(e);return TR.set(n,t),r.observe(n),()=>{TR.delete(n),r.unobserve(n)}}const cle={some:0,all:1};class ule extends Yu{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:r,amount:i="some",once:s}=e,a={root:t?t.current:void 0,rootMargin:r,threshold:typeof i=="number"?i:cle[i]},o=l=>{const{isIntersecting:c}=l;if(this.isInView===c||(this.isInView=c,s&&!c&&this.hasEnteredView))return;c&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",c);const{onViewportEnter:h,onViewportLeave:g}=this.node.getProps(),m=c?h:g;m&&m(l)};return lle(this.node.current,a,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(hle(e,t))&&this.startObserver()}unmount(){}}function hle({viewport:n={}},{viewport:e={}}={}){return t=>n[t]!==e[t]}const dle={inView:{Feature:ule},tap:{Feature:ile},focus:{Feature:rle},hover:{Feature:nle}},fle={layout:{ProjectionNode:rV,MeasureLayout:q7}},RR={current:null},iV={current:!1};function gle(){if(iV.current=!0,!!tI)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),e=()=>RR.current=n.matches;n.addListener(e),e()}else RR.current=!1}const mle=[...I7,ss,Bu],ple=n=>mle.find(k7(n)),D5=new WeakMap;function yle(n,e,t){for(const r in e){const i=e[r],s=t[r];if(hs(i))n.addValue(r,i);else if(hs(s))n.addValue(r,Zp(i,{owner:n}));else if(s!==i)if(n.hasValue(r)){const a=n.getValue(r);a.liveStyle===!0?a.jump(i):a.hasAnimated||a.set(i)}else{const a=n.getStaticValue(r);n.addValue(r,Zp(a!==void 0?a:i,{owner:n}))}}for(const r in t)e[r]===void 0&&n.removeValue(r);return e}const j5=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class xle{scrapeMotionValuesFromProps(e,t,r){return{}}constructor({parent:e,props:t,presenceContext:r,reducedMotionConfig:i,blockInitialAnimation:s,visualState:a},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=kI,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const y=cl.now();this.renderScheduledAt<y&&(this.renderScheduledAt=y,mr.render(this.render,!1,!0))};const{latestValues:l,renderState:c,onUpdate:h}=a;this.onUpdate=h,this.latestValues=l,this.baseTarget={...l},this.initialValues=t.initial?{...l}:{},this.renderState=c,this.parent=e,this.props=t,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=i,this.options=o,this.blockInitialAnimation=!!s,this.isControllingVariants=SE(t),this.isVariantNode=j9(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:g,...m}=this.scrapeMotionValuesFromProps(t,{},this);for(const y in m){const _=m[y];l[y]!==void 0&&hs(_)&&_.set(l[y],!1)}}mount(e){this.current=e,D5.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((t,r)=>this.bindToMotionValue(r,t)),iV.current||gle(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:RR.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){D5.delete(this.current),this.projection&&this.projection.unmount(),Vu(this.notifyUpdate),Vu(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const r=Fd.has(e),i=t.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&mr.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0)}),s=t.on("renderRequest",this.scheduleRender);let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{i(),s(),a&&a(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in Z0){const t=Z0[e];if(!t)continue;const{isEnabled:r,Feature:i}=t;if(!this.features[e]&&i&&r(this.props)&&(this.features[e]=new i(this)),this.features[e]){const s=this.features[e];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Wr()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let r=0;r<j5.length;r++){const i=j5[r];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const s="on"+i,a=e[s];a&&(this.propEventSubscriptions[i]=this.on(i,a))}this.prevMotionValues=yle(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const r=this.values.get(e);t!==r&&(r&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return r===void 0&&t!==void 0&&(r=Zp(t===null?void 0:t,{owner:this}),this.addValue(e,r)),r}readValue(e,t){var r;let i=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(r=this.getBaseTargetFromProps(this.props,e))!==null&&r!==void 0?r:this.readValueFromInstance(this.current,e,this.options);return i!=null&&(typeof i=="string"&&(R7(i)||y7(i))?i=parseFloat(i):!ple(i)&&Bu.test(t)&&(i=S7(e,t)),this.setBaseTarget(e,hs(i)?i.get():i)),hs(i)?i.get():i}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var t;const{initial:r}=this.props;let i;if(typeof r=="string"||typeof r=="object"){const a=lI(this.props,r,(t=this.presenceContext)===null||t===void 0?void 0:t.custom);a&&(i=a[e])}if(r&&i!==void 0)return i;const s=this.getBaseTargetFromProps(this.props,e);return s!==void 0&&!hs(s)?s:this.initialValues[e]!==void 0&&i===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new EI),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}}class sV extends xle{constructor(){super(...arguments),this.KeyframeResolver=C7}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:r}){delete t[e],delete r[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;hs(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function _le(n){return window.getComputedStyle(n)}class vle extends sV{constructor(){super(...arguments),this.type="html",this.renderInstance=H9}readValueFromInstance(e,t){if(Fd.has(t)){const r=AI(t);return r&&r.default||0}else{const r=_le(e),i=(U9(t)?r.getPropertyValue(t):r[t])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(e,{transformPagePoint:t}){return K7(e,t)}build(e,t,r){hI(e,t,r.transformTemplate)}scrapeMotionValuesFromProps(e,t,r){return mI(e,t,r)}}class wle extends sV{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Wr}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(Fd.has(t)){const r=AI(t);return r&&r.default||0}return t=K9.has(t)?t:sI(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,r){return Y9(e,t,r)}build(e,t,r){dI(e,t,this.isSVGTag,r.transformTemplate)}renderInstance(e,t,r,i){X9(e,t,r,i)}mount(e){this.isSVGTag=gI(e.tagName),super.mount(e)}}const Ele=(n,e)=>oI(n)?new wle(e):new vle(e,{allowProjection:n!==H.Fragment}),Sle=Xie({...Hae,...dle,...tle,...fle},Ele),wt=cie(Sle);const ble=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Tle=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),F5=n=>{const e=Tle(n);return e.charAt(0).toUpperCase()+e.slice(1)},aV=(...n)=>n.filter((e,t,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===t).join(" ").trim(),Rle=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var Ale={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const kle=H.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:i="",children:s,iconNode:a,...o},l)=>H.createElement("svg",{ref:l,...Ale,width:e,height:e,stroke:n,strokeWidth:r?Number(t)*24/Number(e):t,className:aV("lucide",i),...!s&&!Rle(o)&&{"aria-hidden":"true"},...o},[...a.map(([c,h])=>H.createElement(c,h)),...Array.isArray(s)?s:[s]]));const Qe=(n,e)=>{const t=H.forwardRef(({className:r,...i},s)=>H.createElement(kle,{ref:s,iconNode:e,className:aV(`lucide-${ble(F5(n))}`,`lucide-${n}`,r),...i}));return t.displayName=F5(n),t};const Ile=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h2",key:"tvwodi"}],["path",{d:"M20 8v11a2 2 0 0 1-2 2h-2",key:"1gkqxj"}],["path",{d:"m9 15 3-3 3 3",key:"1pd0qc"}],["path",{d:"M12 12v9",key:"192myk"}]],Cle=Qe("archive-restore",Ile);const Ple=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],oV=Qe("archive",Ple);const Nle=[["path",{d:"M4.929 4.929 19.07 19.071",key:"196cmz"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Mle=Qe("ban",Nle);const Lle=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],Ole=Qe("book-open",Lle);const Dle=[["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M14 7a4 4 0 0 1 4 4v3a6 6 0 0 1-12 0v-3a4 4 0 0 1 4-4z",key:"uouzyp"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M21 21a4 4 0 0 0-3.81-4",key:"1b0z45"}],["path",{d:"M21 5a4 4 0 0 1-3.55 3.97",key:"5cxbf6"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M3 21a4 4 0 0 1 3.81-4",key:"1fjd4g"}],["path",{d:"M3 5a4 4 0 0 0 3.55 3.97",key:"1d7oge"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M9 7.13V6a3 3 0 1 1 6 0v1.13",key:"1vgav8"}]],lV=Qe("bug",Dle);const jle=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],NI=Qe("calendar",jle);const Fle=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],RE=Qe("camera",Fle);const Vle=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],cV=Qe("chart-column",Vle);const Ble=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],uc=Qe("check",Ble);const Gle=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],pg=Qe("chevron-down",Gle);const zle=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],uV=Qe("chevron-left",zle);const Ule=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],yg=Qe("chevron-right",Ule);const $le=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],AE=Qe("chevron-up",$le);const Wle=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],hV=Qe("circle-alert",Wle);const Hle=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Kle=Qe("circle-check-big",Hle);const Xle=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Dv=Qe("clock",Xle);const qle=[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M16 17H7",key:"pygtm1"}],["path",{d:"M17 21H9",key:"1u2q02"}]],Yle=Qe("cloud-fog",qle);const Zle=[["path",{d:"M6 16.326A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 .5 8.973",key:"1cez44"}],["path",{d:"m13 12-3 5h4l-3 5",key:"1t22er"}]],Jle=Qe("cloud-lightning",Zle);const Qle=[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5.782 5.782A7 7 0 0 0 9 19h8.5a4.5 4.5 0 0 0 1.307-.193",key:"yfwify"}],["path",{d:"M21.532 16.5A4.5 4.5 0 0 0 17.5 10h-1.79A7.008 7.008 0 0 0 10 5.07",key:"jlfiyv"}]],ece=Qe("cloud-off",Qle);const tce=[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M16 14v6",key:"1j4efv"}],["path",{d:"M8 14v6",key:"17c4r9"}],["path",{d:"M12 16v6",key:"c8a4gj"}]],MI=Qe("cloud-rain",tce);const nce=[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M8 15h.01",key:"a7atzg"}],["path",{d:"M8 19h.01",key:"puxtts"}],["path",{d:"M12 17h.01",key:"p32p05"}],["path",{d:"M12 21h.01",key:"h35vbk"}],["path",{d:"M16 15h.01",key:"rnfrdf"}],["path",{d:"M16 19h.01",key:"1vcnzz"}]],rce=Qe("cloud-snow",nce);const ice=[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]],hc=Qe("cloud",ice);const sce=[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]],ace=Qe("code",sce);const oce=[["path",{d:"m16.24 7.76-1.804 5.411a2 2 0 0 1-1.265 1.265L7.76 16.24l1.804-5.411a2 2 0 0 1 1.265-1.265z",key:"9ktpf1"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],lce=Qe("compass",oce);const cce=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"22",x2:"18",y1:"12",y2:"12",key:"l9bcsi"}],["line",{x1:"6",x2:"2",y1:"12",y2:"12",key:"13hhkx"}],["line",{x1:"12",x2:"12",y1:"6",y2:"2",key:"10w3f3"}],["line",{x1:"12",x2:"12",y1:"22",y2:"18",key:"15g9kq"}]],jv=Qe("crosshair",cce);const uce=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Fv=Qe("download",uce);const hce=[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]],dce=Qe("droplets",hce);const fce=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],Cu=Qe("external-link",fce);const gce=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],Vv=Qe("eye-off",gce);const mce=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Bv=Qe("eye",mce);const pce=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],LI=Qe("file-text",pce);const yce=[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4",key:"1slcih"}]],xce=Qe("flame",yce);const _ce=[["path",{d:"M12 5a3 3 0 1 1 3 3m-3-3a3 3 0 1 0-3 3m3-3v1M9 8a3 3 0 1 0 3 3M9 8h1m5 0a3 3 0 1 1-3 3m3-3h-1m-2 3v-1",key:"3pnvol"}],["circle",{cx:"12",cy:"8",r:"2",key:"1822b1"}],["path",{d:"M12 10v12",key:"6ubwww"}],["path",{d:"M12 22c4.2 0 7-1.667 7-5-4.2 0-7 1.667-7 5Z",key:"9hd38g"}],["path",{d:"M12 22c-4.2 0-7-1.667-7-5 4.2 0 7 1.667 7 5Z",key:"ufn41s"}]],V5=Qe("flower-2",_ce);const vce=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],wce=Qe("folder-open",vce);const Ece=[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],Sce=Qe("folder-plus",Ece);const bce=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],Tce=Qe("folder",bce);const Rce=[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]],Ace=Qe("gauge",Rce);const kce=[["path",{d:"M10.5 3 8 9l4 13 4-13-2.5-6",key:"b3dvk1"}],["path",{d:"M17 3a2 2 0 0 1 1.6.8l3 4a2 2 0 0 1 .013 2.382l-7.99 10.986a2 2 0 0 1-3.247 0l-7.99-10.986A2 2 0 0 1 2.4 7.8l2.998-3.997A2 2 0 0 1 7 3z",key:"7w4byz"}],["path",{d:"M2 9h20",key:"16fsjt"}]],Ice=Qe("gem",kce);const Cce=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],Pce=Qe("globe",Cce);const Nce=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],dV=Qe("grid-3x3",Nce);const Mce=[["circle",{cx:"12",cy:"9",r:"1",key:"124mty"}],["circle",{cx:"19",cy:"9",r:"1",key:"1ruzo2"}],["circle",{cx:"5",cy:"9",r:"1",key:"1a8b28"}],["circle",{cx:"12",cy:"15",r:"1",key:"1e56xg"}],["circle",{cx:"19",cy:"15",r:"1",key:"1a92ep"}],["circle",{cx:"5",cy:"15",r:"1",key:"5r1jwy"}]],Lce=Qe("grip-horizontal",Mce);const Oce=[["path",{d:"M16 5h6",key:"1vod17"}],["path",{d:"M19 2v6",key:"4bpg5p"}],["path",{d:"M21 11.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7.5",key:"1ue2ih"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}]],Dce=Qe("image-plus",Oce);const jce=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],OI=Qe("info",jce);const Fce=[["path",{d:"M10 18v-7",key:"wt116b"}],["path",{d:"M11.12 2.198a2 2 0 0 1 1.76.006l7.866 3.847c.476.233.31.949-.22.949H3.474c-.53 0-.695-.716-.22-.949z",key:"1m329m"}],["path",{d:"M14 18v-7",key:"vav6t3"}],["path",{d:"M18 18v-7",key:"aexdmj"}],["path",{d:"M3 22h18",key:"8prr45"}],["path",{d:"M6 18v-7",key:"1ivflk"}]],fV=Qe("landmark",Fce);const Vce=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],Va=Qe("layers",Vce);const Bce=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],gV=Qe("list",Bce);const Gce=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],DI=Qe("loader-circle",Gce);const zce=[["line",{x1:"2",x2:"5",y1:"12",y2:"12",key:"bvdh0s"}],["line",{x1:"19",x2:"22",y1:"12",y2:"12",key:"1tbv5k"}],["line",{x1:"12",x2:"12",y1:"2",y2:"5",key:"11lu5j"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}],["circle",{cx:"12",cy:"12",r:"7",key:"fim9np"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Uce=Qe("locate-fixed",zce);const $ce=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],AR=Qe("lock",$ce);const Wce=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],jI=Qe("log-out",Wce);const Hce=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],pa=Qe("map-pin",Hce);const Kce=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],FI=Qe("map",Kce);const Xce=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],qce=Qe("menu",Xce);const Yce=[["path",{d:"M5 12h14",key:"1ays0h"}]],mV=Qe("minus",Yce);const Zce=[["path",{d:"m8 3 4 8 5-5 5 15H2L8 3z",key:"otkl63"}]],Q0=Qe("mountain",Zce);const Jce=[["path",{d:"M12.586 12.586 19 19",key:"ea5xo7"}],["path",{d:"M3.688 3.037a.497.497 0 0 0-.651.651l6.5 15.999a.501.501 0 0 0 .947-.062l1.569-6.083a2 2 0 0 1 1.448-1.479l6.124-1.579a.5.5 0 0 0 .063-.947z",key:"277e5u"}]],Qce=Qe("mouse-pointer",Jce);const eue=[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]],Y1=Qe("navigation",eue);const tue=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],pV=Qe("pause",tue);const nue=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],B5=Qe("pen-line",nue);const rue=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],iue=Qe("pen",rue);const sue=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],eg=Qe("pencil",sue);const aue=[["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["path",{d:"m9 20 3-6 3 6",key:"se2kox"}],["path",{d:"m6 8 6 2 6-2",key:"4o3us4"}],["path",{d:"M12 10v4",key:"1kjpxc"}]],yV=Qe("person-standing",aue);const oue=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],xV=Qe("play",oue);const lue=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Wa=Qe("plus",lue);const cue=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],uue=Qe("refresh-cw",cue);const hue=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],due=Qe("rotate-ccw",hue);const fue=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],gue=Qe("rotate-cw",fue);const mue=[["circle",{cx:"6",cy:"19",r:"3",key:"1kj8tv"}],["path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15",key:"1d8sl"}],["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}]],Gv=Qe("route",mue);const pue=[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]],e1=Qe("ruler",pue);const yue=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],_V=Qe("save",yue);const xue=[["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"m19 8 3 8a5 5 0 0 1-6 0zV7",key:"zcdpyk"}],["path",{d:"M3 7h1a17 17 0 0 0 8-2 17 17 0 0 0 8 2h1",key:"1yorad"}],["path",{d:"m5 8 3 8a5 5 0 0 1-6 0zV7",key:"eua70x"}],["path",{d:"M7 21h10",key:"1b0cd5"}]],_ue=Qe("scale",xue);const vue=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],zv=Qe("search",vue);const wue=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],kR=Qe("settings",wue);const Eue=[["path",{d:"M14 17H5",key:"gfn3mx"}],["path",{d:"M19 7h-9",key:"6i9tg"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],Sue=Qe("settings-2",Eue);const bue=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],Tue=Qe("share-2",bue);const Rue=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],Aue=Qe("shield",Rue);const kue=[["path",{d:"M10 5H3",key:"1qgfaw"}],["path",{d:"M12 19H3",key:"yhmn1j"}],["path",{d:"M14 3v4",key:"1sua03"}],["path",{d:"M16 17v4",key:"1q0r14"}],["path",{d:"M21 12h-9",key:"1o4lsq"}],["path",{d:"M21 19h-5",key:"1rlt1p"}],["path",{d:"M21 5h-7",key:"1oszz2"}],["path",{d:"M8 10v4",key:"tgpxqk"}],["path",{d:"M8 12H3",key:"a7s4jb"}]],Iue=Qe("sliders-horizontal",kue);const Cue=[["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M12 21v-9",key:"17s77i"}],["path",{d:"M12 8V3",key:"13r4qs"}],["path",{d:"M17 16h4",key:"h1uq16"}],["path",{d:"M19 12V3",key:"o1uvq1"}],["path",{d:"M19 21v-5",key:"qua636"}],["path",{d:"M3 14h4",key:"bcjad9"}],["path",{d:"M5 10V3",key:"cb8scm"}],["path",{d:"M5 21v-7",key:"1w1uti"}]],Pue=Qe("sliders-vertical",Cue);const Nue=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],Mue=Qe("smartphone",Nue);const Lue=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],Oue=Qe("square",Lue);const Due=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],jue=Qe("sun",Due);const Fue=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],Vue=Qe("tag",Fue);const Bue=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],Gue=Qe("target",Bue);const zue=[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]],Uue=Qe("timer",zue);const $ue=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],_c=Qe("trash-2",$ue);const Wue=[["path",{d:"M13 8c0-2.76-2.46-5-5.5-5S2 5.24 2 8h2l1-1 1 1h4",key:"foxbe7"}],["path",{d:"M13 7.14A5.82 5.82 0 0 1 16.5 6c3.04 0 5.5 2.24 5.5 5h-3l-1-1-1 1h-3",key:"18arnh"}],["path",{d:"M5.89 9.71c-2.15 2.15-2.3 5.47-.35 7.43l4.24-4.25.7-.7.71-.71 2.12-2.12c-1.95-1.96-5.27-1.8-7.42.35",key:"ywahnh"}],["path",{d:"M11 15.5c.5 2.5-.17 4.5-1 6.5h4c2-5.5-.5-12-1-14",key:"ft0feo"}]],Hue=Qe("tree-palm",Wue);const Kue=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],Xue=Qe("trending-down",Kue);const que=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],Yue=Qe("trending-up",que);const Zue=[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]],vV=Qe("type",Zue);const Jue=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Z1=Qe("upload",Jue);const Que=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],VI=Qe("user",Que);const ehe=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],the=Qe("volume-2",ehe);const nhe=[["path",{d:"M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"knzxuh"}],["path",{d:"M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"2jd2cc"}],["path",{d:"M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"rd2r6e"}]],rhe=Qe("waves",nhe);const ihe=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],she=Qe("wifi-off",ihe);const ahe=[["path",{d:"M12.8 19.6A2 2 0 1 0 14 16H2",key:"148xed"}],["path",{d:"M17.5 8a2.5 2.5 0 1 1 2 4H2",key:"1u4tom"}],["path",{d:"M9.8 4.4A2 2 0 1 1 11 8H2",key:"75valh"}]],G5=Qe("wind",ahe);const ohe=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Sr=Qe("x",ohe);const lhe=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],che=Qe("zoom-in",lhe);function uhe(){const{tracking:n,startTracking:e,stopTracking:t,updatePosition:r,setWatchId:i,resetFirstFix:s}=ls(),a=H.useCallback(l=>{r(l)},[r]),o=H.useCallback(l=>{console.error("GPS error:",l),alert(`GPS fout: ${l.message}`),t()},[t]);return H.useEffect(()=>{if(!n)return;if(!navigator.geolocation){alert("Geolocation wordt niet ondersteund door deze browser"),t();return}const l=navigator.geolocation.watchPosition(a,o,{enableHighAccuracy:!0,maximumAge:1e3,timeout:15e3});return i(l),()=>{navigator.geolocation.clearWatch(l)}},[n,a,o,i,t]),{tracking:n,start:e,stop:t,toggle:()=>n?t():e()}}function hhe(){const{tracking:n,toggle:e}=uhe();return f.jsx(wt.button,{className:`
        fixed bottom-2 right-2 z-[1000]
        w-11 h-11 cursor-pointer border-0 outline-none
        flex items-center justify-center
        rounded-xl backdrop-blur-sm
        transition-all duration-200
        ${n?"bg-gradient-to-br from-blue-400 to-blue-600 text-white shadow-lg shadow-blue-500/30":"bg-white/80 text-gray-500 hover:bg-white/90 shadow-sm"}
      `,onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},animate:n?{scale:[1,1.02,1]}:{},transition:n?{scale:{duration:2,repeat:1/0,ease:"easeInOut"}}:{},"aria-label":n?"GPS tracking actief":"GPS tracking starten",title:n?"GPS tracking actief":"GPS tracking starten",children:f.jsx(Uce,{size:22,strokeWidth:2})})}const dhe="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(`<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 48 48">
    <polygon points="24,6 38,38 24,30 10,38" fill="#4285F4" stroke="white" stroke-width="3" stroke-linejoin="round"/>
  </svg>`);function fhe(){const n=Xr(y=>y.map),e=ls(y=>y.position),t=ls(y=>y.accuracy),r=ls(y=>y.tracking),i=ls(y=>y.smoothHeading),s=dn(y=>y.showAccuracyCircle),a=ls(y=>y.firstFix),o=ls(y=>y.resetFirstFix),l=ls(y=>y.config.centerOnUser),c=H.useRef(null),h=H.useRef(null),g=H.useRef(null),m=H.useMemo(()=>y=>new gn({image:new S1({src:dhe,scale:.9,rotation:y,rotateWithView:!1,anchor:[.5,.5]})}),[]);return H.useEffect(()=>{if(!n||!r&&!e)return;const y=Ir([5.1214,52.0907]);return c.current=new vr({geometry:new mi(y)}),c.current.setStyle(m(0)),h.current=new vr({geometry:new mi(y)}),g.current=new pc({source:new xl({features:[h.current,c.current]}),zIndex:1e3}),n.addLayer(g.current),()=>{g.current&&n&&n.removeLayer(g.current)}},[n,r,e,m]),H.useEffect(()=>{if(!n||!e||!c.current||!h.current)return;const y=Ir([e.lng,e.lat]);if(c.current.getGeometry()?.setCoordinates(y),h.current.getGeometry()?.setCoordinates(y),s&&t){const _=n.getView().getResolution()||1,x=Math.min(t/_,80);h.current.setStyle(new gn({image:new Us({radius:x,fill:new Jn({color:"rgba(66, 133, 244, 0.12)"})})}))}else h.current.setStyle(new gn({}));if(a&&r){n.getView().setCenter(y),n.getView().setZoom(17),o();return}r&&l&&!a&&n.getView().animate({center:y,duration:150})},[n,r,e,t,a,o,l,s]),H.useEffect(()=>{if(!c.current)return;const y=i!==null?i*Math.PI/180:0;c.current.setStyle(m(y))},[i,m]),null}function ghe(){const n=ur(t=>t.themesPanelOpen),e=ur(t=>t.toggleThemesPanel);return f.jsx(wt.button,{className:`
        fixed bottom-[60px] right-2 z-[1000]
        w-11 h-11 cursor-pointer border-0 outline-none
        flex items-center justify-center
        rounded-xl backdrop-blur-sm
        transition-all duration-200
        ${n?"bg-gradient-to-br from-blue-400 to-blue-600 text-white shadow-lg shadow-blue-500/30":"bg-white/80 text-gray-500 hover:bg-white/90 shadow-sm"}
      `,onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":n?"Kaartlagen sluiten":"Kaartlagen openen",title:"Kaartlagen",children:f.jsx(FI,{size:22,strokeWidth:2})})}function mhe(){return f.jsx(ghe,{})}const Vx=["#ef4444","#f97316","#eab308","#22c55e","#06b6d4","#3b82f6","#8b5cf6","#ec4899"],su=["Mineraal","Fossiel","Erfgoed","Monument","Overig"],oo="default-vondsten",wV={id:oo,name:"Mijn vondsten",color:"#f97316",categories:["Munt","Aardewerk","Gesp","Fibula","Ring","Speld","Sieraad","Gereedschap","Wapen","Anders"],points:[],visible:!0,archived:!1,createdAt:new Date().toISOString()},phe=n=>n.some(t=>t.id===oo)?n:[{...wV,createdAt:new Date().toISOString()},...n],Hi=qi()(bo((n,e)=>({layers:[{...wV}],colorIndex:0,addLayer:(t,r=su)=>{const i=crypto.randomUUID(),s=Vx[e().colorIndex%Vx.length];return n(a=>({layers:[...a.layers,{id:i,name:t,color:s,categories:[...r],points:[],visible:!0,archived:!1,createdAt:new Date().toISOString()}],colorIndex:a.colorIndex+1})),i},removeLayer:t=>{n(r=>({layers:r.layers.filter(i=>i.id!==t)}))},updateLayer:(t,r)=>{n(i=>({layers:i.layers.map(s=>s.id===t?{...s,...r}:s)}))},toggleVisibility:t=>{n(r=>({layers:r.layers.map(i=>i.id===t?{...i,visible:!i.visible}:i)}))},toggleArchived:t=>{n(r=>({layers:r.layers.map(i=>i.id===t?{...i,archived:!i.archived,visible:i.archived?i.visible:!1}:i)}))},addPoint:(t,r)=>{const i={...r,status:r.status||"todo",id:crypto.randomUUID(),createdAt:new Date().toISOString()};n(s=>({layers:s.layers.map(a=>a.id===t?{...a,points:[...a.points,i]}:a)}))},removePoint:(t,r)=>{n(i=>({layers:i.layers.map(s=>s.id===t?{...s,points:s.points.filter(a=>a.id!==r)}:s)}))},updatePoint:(t,r,i)=>{n(s=>({layers:s.layers.map(a=>a.id===t?{...a,points:a.points.map(o=>o.id===r?{...o,...i}:o)}:a)}))},setPointStatus:(t,r,i)=>{n(s=>({layers:s.layers.map(a=>a.id===t?{...a,points:a.points.map(o=>o.id===r?{...o,status:i}:o)}:a)}))},addCategory:(t,r)=>{n(i=>({layers:i.layers.map(s=>s.id===t&&!s.categories.includes(r)?{...s,categories:[...s.categories,r]}:s)}))},removeCategory:(t,r)=>{n(i=>({layers:i.layers.map(s=>s.id===t?{...s,categories:s.categories.filter(a=>a!==r)}:s)}))},addPhotoToPoint:(t,r,i)=>{n(s=>({layers:s.layers.map(a=>a.id===t?{...a,points:a.points.map(o=>o.id===r?{...o,photos:[...o.photos||[],i]}:o)}:a)}))},removePhotoFromPoint:(t,r,i)=>{n(s=>({layers:s.layers.map(a=>a.id===t?{...a,points:a.points.map(o=>o.id===r?{...o,photos:(o.photos||[]).filter(l=>l.id!==i)}:o)}:a)}))},updatePhotoInPoint:(t,r,i,s)=>{n(a=>({layers:a.layers.map(o=>o.id===t?{...o,points:o.points.map(l=>l.id===r?{...l,photos:(l.photos||[]).map(c=>c.id===i?{...c,...s}:c)}:l)}:o)}))},exportLayerAsGeoJSON:t=>{const r=e().layers.find(l=>l.id===t);if(!r)return;const i={type:"FeatureCollection",properties:{name:r.name,color:r.color,categories:r.categories,createdAt:r.createdAt,exportedAt:new Date().toISOString()},features:r.points.map(l=>({type:"Feature",geometry:{type:"Point",coordinates:l.coordinates},properties:{id:l.id,name:l.name,category:l.category,notes:l.notes,url:l.url,status:l.status,sourceLayer:l.sourceLayer,sourceId:l.sourceId,photos:l.photos,createdAt:l.createdAt}}))},s=new Blob([JSON.stringify(i,null,2)],{type:"application/geo+json"}),a=URL.createObjectURL(s),o=document.createElement("a");o.href=a,o.download=`${r.name.replace(/[^a-zA-Z0-9]/g,"-")}-${new Date().toISOString().split("T")[0]}.geojson`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(a)},importLayerFromGeoJSON:t=>{try{const r=JSON.parse(t);if(r.type!=="FeatureCollection")return{success:!1,error:"Ongeldig GeoJSON formaat"};const i=r.properties||{},s=i.name||`Gemporteerd ${new Date().toLocaleDateString("nl-NL")}`,a=i.categories||su,o=i.color||Vx[e().colorIndex%Vx.length],l=(r.features||[]).filter(h=>h.geometry?.type==="Point").map(h=>({id:h.properties?.id||crypto.randomUUID(),name:h.properties?.name||"Naamloos",category:h.properties?.category||"Overig",notes:h.properties?.notes||"",url:h.properties?.url,status:h.properties?.status||"todo",sourceLayer:h.properties?.sourceLayer,sourceId:h.properties?.sourceId,photos:h.properties?.photos,coordinates:h.geometry.coordinates,createdAt:h.properties?.createdAt||new Date().toISOString()})),c=crypto.randomUUID();return n(h=>({layers:[...h.layers,{id:c,name:s,color:o,categories:a,points:l,visible:!0,archived:!1,createdAt:new Date().toISOString()}],colorIndex:h.colorIndex+1})),{success:!0,layerId:c}}catch{return{success:!1,error:"Fout bij parsen van GeoJSON"}}},getLayer:t=>e().layers.find(r=>r.id===t),getActiveLayerCount:()=>e().layers.filter(t=>!t.archived).length,getArchivedLayerCount:()=>e().layers.filter(t=>t.archived).length,clearAll:()=>{n(t=>({layers:t.layers.map(r=>r.id===oo?{...r,points:[]}:r).filter(r=>r.id===oo),colorIndex:0}))}}),{name:"detectorapp-custom-point-layers",version:3,migrate:(n,e)=>{const t=n;return e<2?{...t,layers:phe(t.layers||[])}:e<3?{...t,layers:(t.layers||[]).map(r=>r.id===oo?{...r,name:"Mijn vondsten"}:r)}:t}}));function Di({title:n,children:e,defaultExpanded:t=!0,layerNames:r}){const[i,s]=H.useState(t),a=Ti(w=>w.visible),o=Ti(w=>w.setLayerVisibility),l=Zk(w=>w.isLayerUnlocked),c=w=>{const b=Gw[w],T=b?.tier??"free",k=b?.regions??["nl"];return l(w,T,k)},h=r?.filter(w=>c(w))||[],g=h.filter(w=>a[w]).length,m=h.length,y=m>0&&g===m,_=g>0&&g<m,x=w=>{if(w.stopPropagation(),!r||h.length===0)return;const b=!y;h.forEach(T=>{o(T,b)})};return f.jsxs("div",{className:"mb-0.5",children:[f.jsxs("div",{className:"flex items-center gap-1 py-1 px-1 hover:bg-blue-50 transition-colors",children:[f.jsxs("button",{onClick:w=>{w.stopPropagation(),s(!i)},className:"flex-1 flex items-center gap-1 bg-transparent border-0 outline-none text-left",style:{fontSize:"inherit"},children:[f.jsx(wt.span,{animate:{rotate:i?90:0},transition:{duration:.15},className:"text-gray-400",children:f.jsx(yg,{size:14})}),i?f.jsx(wce,{size:16,className:"text-blue-500"}):f.jsx(Tce,{size:16,className:"text-blue-500"}),f.jsx("span",{className:"text-gray-700 font-medium",style:{fontSize:"1em"},children:n}),g>0&&f.jsx("span",{className:"ml-1 px-1.5 py-0.5 font-medium bg-blue-100 text-blue-600 rounded-full",style:{fontSize:"0.7em"},children:g})]}),r&&r.length>0&&f.jsx("button",{onClick:x,className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:y?"#3b82f6":_?"#93c5fd":"white",border:y?"2px solid #3b82f6":"2px solid #60a5fa",color:"white"},children:(y||_)&&f.jsx("svg",{width:"10",height:"10",viewBox:"0 0 10 10",children:f.jsx("path",{d:"M2 5 L4 7 L8 3",stroke:"currentColor",strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),f.jsx(An,{initial:!1,children:i&&f.jsx(wt.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.15},style:{overflow:"hidden"},className:"ml-5",children:e})})]})}function dt({name:n,type:e,hasOverlay:t}){const r=Ti(k=>k.visible[n]),i=Ti(k=>k.visible["Labels Overlay"]),s=Ti(k=>k.loadingState[n]),a=Ti(k=>k.toggleLayer),o=Ti(k=>k.setLayerVisibility),l=Zk(k=>k.isLayerUnlocked),c=s==="loading",h=s==="error",g=Gw[n],m=g?.tier??"free",y=g?.regions??["nl"],x=!l(n,m,y),w=k=>{k.stopPropagation(),!(c||x)&&(e==="overlay"?a(n):["CartoDB (licht)","OpenStreetMap","Luchtfoto","TMK 1850","Bonnebladen 1900"].forEach(O=>{o(O,O===n)}))},b=k=>{k.stopPropagation(),o("Labels Overlay",!i)},T=r??!1;return f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsxs("button",{onClick:w,disabled:c||x,className:`flex-1 flex items-center justify-between py-1 pl-3 pr-2 border-0 outline-none transition-colors text-left ${x?"opacity-50 cursor-not-allowed bg-gray-50":c?"opacity-70 cursor-wait bg-transparent":T?"bg-blue-50 hover:bg-blue-100":"bg-transparent hover:bg-blue-50"}`,style:{fontSize:"inherit"},title:x?"Premium laag - upgrade om te ontgrendelen":void 0,children:[f.jsxs("span",{className:`flex items-center gap-1 ${h?"text-red-500":x?"text-gray-400":"text-gray-600"}`,children:[n,h&&f.jsx(hV,{size:12,className:"text-red-500"}),x&&f.jsx(AR,{size:12,className:"text-amber-500"})]}),f.jsx("div",{className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:x?"#e5e7eb":c?"#93c5fd":T?"#3b82f6":"white",border:x?"2px solid #d1d5db":c?"2px solid #93c5fd":T?"2px solid #3b82f6":"2px solid #60a5fa",color:"white"},children:x?f.jsx(AR,{size:10,strokeWidth:3,className:"text-gray-400"}):c?f.jsx(DI,{size:10,strokeWidth:3,className:"animate-spin"}):T?f.jsx(uc,{size:12,strokeWidth:3}):null})]}),t&&T&&f.jsx("button",{onClick:b,className:`p-1 rounded transition-colors border-0 outline-none ${i?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-400 hover:bg-gray-200"}`,title:i?"Labels verbergen":"Labels tonen",children:f.jsx(Vue,{size:12})})]})}const yhe=["#ef4444","#f97316","#eab308","#22c55e","#06b6d4","#3b82f6","#8b5cf6","#ec4899","#6b7280"];function EV({layer:n,compact:e=!1}){const{toggleVisibility:t,removeLayer:r,updateLayer:i,setColor:s}=W1(),[a,o]=H.useState(!1),[l,c]=H.useState(!1),[h,g]=H.useState(n.name),[m,y]=H.useState(!1),_=H.useRef(null),x=H.useRef(null),w=n.features.features.length,b=[...new Set(n.features.features.map(R=>R.geometry?.type).filter(Boolean))];H.useEffect(()=>{l&&_.current&&(_.current.focus(),_.current.select())},[l]),H.useEffect(()=>{const R=A=>{x.current&&!x.current.contains(A.target)&&y(!1)};if(m)return document.addEventListener("mousedown",R),()=>document.removeEventListener("mousedown",R)},[m]);const T=()=>{a?r(n.id):(o(!0),setTimeout(()=>o(!1),3e3))},k=()=>{const R=h.trim();R&&R!==n.name&&i(n.id,{name:R}),c(!1)},L=()=>{g(n.name),c(!1)},O=R=>{R.key==="Enter"?k():R.key==="Escape"&&L()},B=R=>{s(n.id,R),y(!1)};return e?f.jsxs("div",{className:"flex items-center gap-1 py-0.5 px-1 hover:bg-blue-50 transition-colors rounded",children:[f.jsx("button",{onClick:()=>t(n.id),className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:n.visible?n.color:"white",border:`2px solid ${n.color}`},title:n.visible?"Verbergen":"Tonen",children:n.visible&&f.jsx("svg",{width:"10",height:"10",viewBox:"0 0 10 10",children:f.jsx("path",{d:"M2 5 L4 7 L8 3",stroke:"white",strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})})}),f.jsx("span",{className:"text-gray-700 truncate flex-1 cursor-pointer",style:{fontSize:"0.9em"},onClick:()=>t(n.id),children:n.name}),f.jsx("span",{className:"text-[10px] text-gray-400 flex-shrink-0",children:w})]}):f.jsxs("div",{className:"flex items-center justify-between py-1.5 group",children:[f.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[f.jsxs("div",{className:"relative",ref:x,children:[f.jsx("button",{onClick:()=>y(!m),className:"w-5 h-5 rounded border-2 border-white shadow-sm flex-shrink-0 hover:scale-110 transition-transform",style:{backgroundColor:n.color},title:"Kleur wijzigen"}),m&&f.jsx("div",{className:"absolute top-6 left-0 z-50 bg-white rounded-lg shadow-lg border p-2 grid grid-cols-3 gap-1",children:yhe.map(R=>f.jsx("button",{onClick:()=>B(R),className:`w-6 h-6 rounded border-2 transition-transform hover:scale-110 ${R===n.color?"border-gray-800 scale-110":"border-white"}`,style:{backgroundColor:R},title:R},R))})]}),f.jsx("div",{className:"flex-1 min-w-0",children:l?f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("input",{ref:_,type:"text",value:h,onChange:R=>g(R.target.value),onKeyDown:O,className:"flex-1 text-sm px-1 py-0.5 border rounded min-w-0"}),f.jsx("button",{onClick:k,className:"p-0.5 text-green-600 hover:bg-green-50 rounded",title:"Opslaan",children:f.jsx(uc,{size:14})}),f.jsx("button",{onClick:L,className:"p-0.5 text-gray-400 hover:bg-gray-100 rounded",title:"Annuleren",children:f.jsx(Sr,{size:14})})]}):f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("span",{className:"text-sm text-gray-700 truncate",children:n.name}),f.jsx("button",{onClick:()=>c(!0),className:"p-0.5 text-gray-400 hover:text-blue-500 opacity-0 group-hover:opacity-100 transition-opacity",title:"Naam wijzigen",children:f.jsx(eg,{size:12})})]}),f.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-gray-400",children:[f.jsxs("span",{children:[w," ",w===1?"feature":"features"]}),b.length>0&&f.jsxs(f.Fragment,{children:[f.jsx("span",{className:"mx-0.5",children:""}),f.jsx("span",{children:b.join(", ")})]})]})]})})]}),f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("button",{onClick:()=>t(n.id),className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:n.visible?n.color:"white",border:`2px solid ${n.visible?n.color:"#9ca3af"}`},title:n.visible?"Verbergen":"Tonen",children:n.visible&&f.jsx("svg",{width:"10",height:"10",viewBox:"0 0 10 10",children:f.jsx("path",{d:"M2 5 L4 7 L8 3",stroke:"white",strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})})}),f.jsx("button",{onClick:T,className:`p-1 rounded transition-colors border-0 outline-none ${a?"text-white bg-red-500 hover:bg-red-600":"text-gray-400 hover:text-red-500 hover:bg-red-50"}`,title:a?"Klik nogmaals om te verwijderen":"Verwijderen",children:f.jsx(_c,{size:14})})]})]})}const xhe=[{name:"Rapa Nui - Moai Productie",url:"https://arcg.is/qu59O1",desc:"Paaseiland steengroeve in 3D"},{name:"Digital Giza - Piramides",url:"http://giza.fas.harvard.edu/giza3d/",desc:"Harvard 3D reconstructie"},{name:"Stonehenge 360",url:"https://www.english-heritage.org.uk/visit/places/stonehenge/history-and-stories/stonehenge360/",desc:"English Heritage virtuele tour"},{name:"Pompeii 3D Explorer",url:"https://www.cyark.org/projects/pompeii/3D-Explorer",desc:"CyArk LiDAR scans"},{name:"Virtual Angkor Wat",url:"https://www.virtualangkor.com/",desc:"3D reconstructie 1300 n.Chr."},{name:"Petra Virtuele Tour",url:"https://www.zamaniproject.org/site-jordan-petra.html",desc:"Zamani Project 3D"}],_he=[{name:"CyArk (200+ sites)",url:"https://www.cyark.org/projects/",desc:"Wereldwijd erfgoed archief"},{name:"Google Open Heritage",url:"https://artsandculture.google.com/project/openheritage",desc:"26+ UNESCO sites in 3D"}];function vhe(){const{themesPanelOpen:n,toggleThemesPanel:e,toggleSettingsPanel:t}=ur(),{layers:r,toggleVisibility:i}=Hi(),s=W1(y=>y.layers),a=H.useRef(null),o=dn(y=>y.layerPanelFontScale),l=dn(y=>y.setLayerPanelFontScale),c=dn(y=>y.showFontSliders),h=13*o/100,[g,m]=H.useState(!1);return H.useEffect(()=>{if(!n)return;const y=x=>{a.current&&!a.current.contains(x.target)&&e()},_=setTimeout(()=>{document.addEventListener("click",y)},100);return()=>{clearTimeout(_),document.removeEventListener("click",y)}},[n,e]),f.jsx(An,{children:n&&f.jsxs(wt.div,{ref:a,className:"fixed top-2.5 right-2 z-[1101] bg-white rounded-lg shadow-lg overflow-hidden w-[300px] max-h-[calc(100vh-200px)] flex flex-col",initial:{opacity:0,x:10},animate:{opacity:1,x:0},exit:{opacity:0,x:10},transition:{duration:.15},children:[f.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-blue-500",style:{fontSize:`${h}px`},children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(Va,{size:14,className:"text-white"}),f.jsx("span",{className:"font-medium text-white",children:"Kaartlagen"})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[c&&f.jsxs(f.Fragment,{children:[f.jsx("span",{className:"text-[10px] text-blue-200",children:"T"}),f.jsx("input",{type:"range",min:"80",max:"130",step:"10",value:o,onInput:y=>{l(parseInt(y.target.value))},onChange:y=>l(parseInt(y.target.value)),className:"w-20 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${o}%`}),f.jsx("span",{className:"text-xs text-blue-200",children:"T"})]}),f.jsx("button",{onClick:e,className:"p-0.5 rounded border-0 outline-none bg-blue-400/50 hover:bg-blue-400 transition-colors ml-1",children:f.jsx(Sr,{size:16,className:"text-white",strokeWidth:2.5})})]})]}),f.jsxs("div",{className:"p-2 overflow-y-auto flex-1",style:{fontSize:`${h}px`},children:[r.filter(y=>!y.archived).length>0&&f.jsxs("div",{className:"mb-2 pb-1 border-b border-gray-100",children:[f.jsx("div",{className:"flex items-center gap-1 py-0.5 px-1 mb-1",children:f.jsx("span",{className:"text-orange-600 font-medium",style:{fontSize:"0.9em"},children:"Mijn lagen"})}),r.filter(y=>!y.archived).map(y=>f.jsxs("button",{onClick:_=>{_.stopPropagation(),i(y.id)},className:`w-full flex items-center justify-between py-1 pl-3 pr-2 border-0 outline-none transition-colors text-left ${y.visible?"bg-orange-50 hover:bg-orange-100":"bg-transparent hover:bg-orange-50"}`,style:{fontSize:"inherit"},children:[f.jsxs("span",{className:"flex items-center gap-2 text-gray-600",children:[y.name,f.jsxs("span",{className:"text-xs text-gray-400",children:["(",y.points.length,")"]})]}),f.jsx("div",{className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:y.visible?"#f97316":"white",border:y.visible?"2px solid #f97316":"2px solid #fb923c",color:"white"},children:y.visible&&f.jsx(uc,{size:12,strokeWidth:3})})]},y.id))]}),s.length>0&&f.jsxs("div",{className:"mb-2 pb-1 border-b border-gray-100",children:[f.jsxs("div",{className:"flex items-center gap-1 py-0.5 px-1 mb-1",children:[f.jsx(Z1,{size:12,className:"text-cyan-600"}),f.jsx("span",{className:"text-cyan-600 font-medium",style:{fontSize:"0.9em"},children:"Gemporteerde lagen"})]}),s.map(y=>f.jsx(EV,{layer:y,compact:!0},y.id)),f.jsx("button",{onClick:()=>{e(),t()},className:"w-full text-left py-1 pl-3 text-xs text-cyan-500 hover:text-cyan-700 hover:bg-cyan-50 transition-colors",children:"+ Laag importeren..."})]}),f.jsxs("div",{className:"mb-2",children:[f.jsx("div",{className:"flex items-center gap-1 py-1 px-1 mb-1",children:f.jsx("span",{className:"text-blue-600 font-medium",style:{fontSize:"0.95em"},children:"Basislaag"})}),f.jsxs("div",{className:"space-y-0",children:[f.jsx(dt,{name:"CartoDB (licht)",type:"base"}),f.jsx(dt,{name:"OpenStreetMap",type:"base"}),f.jsx(dt,{name:"Luchtfoto",type:"base",hasOverlay:!0}),f.jsx(dt,{name:"TMK 1850",type:"base",hasOverlay:!0}),f.jsx(dt,{name:"Bonnebladen 1900",type:"base",hasOverlay:!0})]})]}),f.jsxs("div",{className:"mb-2",children:[f.jsx("div",{className:"flex items-center gap-1 py-1 px-1 mb-1 border-t border-gray-100 pt-2",children:f.jsx("span",{className:"text-blue-600 font-medium",style:{fontSize:"0.95em"},children:"Thema's"})}),f.jsxs(Di,{title:"Steentijd & Prehistorie",defaultExpanded:!1,layerNames:["Hunebedden","Grafheuvels","Terpen"],children:[f.jsx(dt,{name:"Hunebedden",type:"overlay"}),f.jsx(dt,{name:"Grafheuvels",type:"overlay"}),f.jsx(dt,{name:"Terpen",type:"overlay"})]}),f.jsxs(Di,{title:"Paleokaarten",defaultExpanded:!1,layerNames:["Paleokaart 9000 v.Chr.","Paleokaart 5500 v.Chr.","Paleokaart 2750 v.Chr.","Paleokaart 1500 v.Chr.","Paleokaart 500 v.Chr.","Paleokaart 100 n.Chr.","Paleokaart 800 n.Chr."],children:[f.jsx(dt,{name:"Paleokaart 9000 v.Chr.",type:"overlay"}),f.jsx(dt,{name:"Paleokaart 5500 v.Chr.",type:"overlay"}),f.jsx(dt,{name:"Paleokaart 2750 v.Chr.",type:"overlay"}),f.jsx(dt,{name:"Paleokaart 1500 v.Chr.",type:"overlay"}),f.jsx(dt,{name:"Paleokaart 500 v.Chr.",type:"overlay"}),f.jsx(dt,{name:"Paleokaart 100 n.Chr.",type:"overlay"}),f.jsx(dt,{name:"Paleokaart 800 n.Chr.",type:"overlay"})]}),f.jsxs(Di,{title:"Archeologische lagen",defaultExpanded:!1,layerNames:["FAMKE Steentijd","FAMKE IJzertijd","AMK Monumenten","AMK Romeins","AMK Steentijd","AMK Vroege ME","AMK Late ME","AMK Overig","Archeo Onderzoeken","Romeinse wegen (regio)","Romeinse wegen (Wereld)","Romeinse Forten","Romeinse Forten Lijnen"],children:[f.jsx(dt,{name:"FAMKE Steentijd",type:"overlay"}),f.jsx(dt,{name:"FAMKE IJzertijd",type:"overlay"}),f.jsx(dt,{name:"AMK Monumenten",type:"overlay"}),f.jsxs(Di,{title:"AMK per periode",defaultExpanded:!1,layerNames:["AMK Romeins","AMK Steentijd","AMK Vroege ME","AMK Late ME","AMK Overig"],children:[f.jsx(dt,{name:"AMK Romeins",type:"overlay"}),f.jsx(dt,{name:"AMK Steentijd",type:"overlay"}),f.jsx(dt,{name:"AMK Vroege ME",type:"overlay"}),f.jsx(dt,{name:"AMK Late ME",type:"overlay"}),f.jsx(dt,{name:"AMK Overig",type:"overlay"})]}),f.jsx(dt,{name:"Archeo Onderzoeken",type:"overlay"}),f.jsxs(Di,{title:"Romeinse tijd",defaultExpanded:!1,layerNames:["Romeinse wegen (regio)","Romeinse wegen (Wereld)","Romeinse Forten","Romeinse Forten Lijnen"],children:[f.jsx(dt,{name:"Romeinse wegen (regio)",type:"overlay"}),f.jsx(dt,{name:"Romeinse wegen (Wereld)",type:"overlay"}),f.jsx(dt,{name:"Romeinse Forten",type:"overlay"}),f.jsx(dt,{name:"Romeinse Forten Lijnen",type:"overlay"})]})]}),f.jsxs(Di,{title:"Archeologische verwachtingen",defaultExpanded:!1,layerNames:["IKAW","UIKAV Punten","UIKAV Vlakken","UIKAV Expert","UIKAV Buffer","UIKAV Indeling"],children:[f.jsx(dt,{name:"IKAW",type:"overlay"}),f.jsx(dt,{name:"UIKAV Punten",type:"overlay"}),f.jsx(dt,{name:"UIKAV Vlakken",type:"overlay"}),f.jsx(dt,{name:"UIKAV Expert",type:"overlay"}),f.jsx(dt,{name:"UIKAV Buffer",type:"overlay"}),f.jsx(dt,{name:"UIKAV Indeling",type:"overlay"})]}),f.jsxs(Di,{title:"Erfgoed & Monumenten",defaultExpanded:!1,layerNames:["Rijksmonumenten","Werelderfgoed","Religieus Erfgoed","Kastelen","Runes"],children:[f.jsx(dt,{name:"Rijksmonumenten",type:"overlay"}),f.jsx(dt,{name:"Werelderfgoed",type:"overlay"}),f.jsx(dt,{name:"Religieus Erfgoed",type:"overlay"}),f.jsx(dt,{name:"Kastelen",type:"overlay"}),f.jsx(dt,{name:"Runes",type:"overlay"})]}),f.jsxs(Di,{title:"WOII & Militair",defaultExpanded:!1,layerNames:["WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Militaire Objecten","Inundatiegebieden"],children:[f.jsx(dt,{name:"WWII Bunkers",type:"overlay"}),f.jsx(dt,{name:"Slagvelden",type:"overlay"}),f.jsx(dt,{name:"Militaire Vliegvelden",type:"overlay"}),f.jsx(dt,{name:"Verdedigingslinies",type:"overlay"}),f.jsx(dt,{name:"Militaire Objecten",type:"overlay"}),f.jsx(dt,{name:"Inundatiegebieden",type:"overlay"})]}),f.jsxs(Di,{title:"Hillshade & LiDAR",defaultExpanded:!1,layerNames:["Hoogtekaart (WebGL)","AHN4 Hoogtekaart Kleur","AHN4 Hillshade NL","AHN4 Multi-Hillshade NL","AHN 0.5m"],children:[f.jsx(dt,{name:"Hoogtekaart (WebGL)",type:"overlay"}),f.jsx(dt,{name:"AHN4 Hoogtekaart Kleur",type:"overlay"}),f.jsx(dt,{name:"AHN4 Hillshade NL",type:"overlay"}),f.jsx(dt,{name:"AHN4 Multi-Hillshade NL",type:"overlay"}),f.jsx(dt,{name:"AHN 0.5m",type:"overlay"})]}),f.jsxs(Di,{title:"Terrein & Bodem",defaultExpanded:!1,layerNames:["Veengebieden","Geomorfologie","Bodemkaart","Essen"],children:[f.jsx(dt,{name:"Veengebieden",type:"overlay"}),f.jsx(dt,{name:"Geomorfologie",type:"overlay"}),f.jsx(dt,{name:"Bodemkaart",type:"overlay"}),f.jsx(dt,{name:"Essen",type:"overlay"})]}),f.jsxs(Di,{title:"Percelen",defaultExpanded:!1,layerNames:["Gewaspercelen","Kadastrale Grenzen"],children:[f.jsx(dt,{name:"Gewaspercelen",type:"overlay"}),f.jsx(dt,{name:"Kadastrale Grenzen",type:"overlay"})]}),f.jsxs(Di,{title:"Provinciale Thema's",defaultExpanded:!1,layerNames:["Scheepswrakken","Woonheuvels ZH","Windmolens","Erfgoedlijnen","Oude Kernen","Relictenkaart Punten","Relictenkaart Lijnen","Relictenkaart Vlakken","Verdronken Dorpen"],children:[f.jsxs(Di,{title:"Zuid-Holland",defaultExpanded:!1,layerNames:["Scheepswrakken","Woonheuvels ZH","Windmolens","Erfgoedlijnen","Oude Kernen"],children:[f.jsx(dt,{name:"Scheepswrakken",type:"overlay"}),f.jsx(dt,{name:"Woonheuvels ZH",type:"overlay"}),f.jsx(dt,{name:"Windmolens",type:"overlay"}),f.jsx(dt,{name:"Erfgoedlijnen",type:"overlay"}),f.jsx(dt,{name:"Oude Kernen",type:"overlay"})]}),f.jsxs(Di,{title:"Gelderland",defaultExpanded:!1,layerNames:["Relictenkaart Punten","Relictenkaart Lijnen","Relictenkaart Vlakken"],children:[f.jsx(dt,{name:"Relictenkaart Punten",type:"overlay"}),f.jsx(dt,{name:"Relictenkaart Lijnen",type:"overlay"}),f.jsx(dt,{name:"Relictenkaart Vlakken",type:"overlay"})]}),f.jsx(Di,{title:"Zeeland",defaultExpanded:!1,layerNames:["Verdronken Dorpen"],children:f.jsx(dt,{name:"Verdronken Dorpen",type:"overlay"})})]}),f.jsxs(Di,{title:"Fossielen, Mineralen & Goud",defaultExpanded:!1,layerNames:["Fossiel Hotspots","Mineralen Hotspots","Goudrivieren","Fossielen Nederland","Fossielen Belgi","Fossielen Duitsland","Fossielen Frankrijk"],children:[f.jsx(dt,{name:"Fossiel Hotspots",type:"overlay"}),f.jsx(dt,{name:"Mineralen Hotspots",type:"overlay"}),f.jsx(dt,{name:"Goudrivieren",type:"overlay"}),f.jsx(dt,{name:"Fossielen Nederland",type:"overlay"}),f.jsx(dt,{name:"Fossielen Belgi",type:"overlay"}),f.jsx(dt,{name:"Fossielen Duitsland",type:"overlay"}),f.jsx(dt,{name:"Fossielen Frankrijk",type:"overlay"})]}),f.jsxs(Di,{title:"Recreatie",defaultExpanded:!1,layerNames:["Ruiterpaden","Laarzenpaden","Parken","Speeltuinen","Musea","Strandjes","Kringloopwinkels"],children:[f.jsx(dt,{name:"Ruiterpaden",type:"overlay"}),f.jsx(dt,{name:"Laarzenpaden",type:"overlay"}),f.jsx(dt,{name:"Parken",type:"overlay"}),f.jsx(dt,{name:"Speeltuinen",type:"overlay"}),f.jsx(dt,{name:"Musea",type:"overlay"}),f.jsx(dt,{name:"Strandjes",type:"overlay"}),f.jsx(dt,{name:"Kringloopwinkels",type:"overlay"})]}),f.jsxs("div",{className:"mb-2",children:[f.jsxs("button",{onClick:y=>{y.stopPropagation(),m(!g)},className:"w-full flex items-center gap-1 py-1 px-1 hover:bg-purple-50 rounded transition-colors border-0 outline-none bg-transparent",children:[g?f.jsx(pg,{size:14,className:"text-purple-500"}):f.jsx(yg,{size:14,className:"text-purple-500"}),f.jsx(Pce,{size:12,className:"text-purple-500"}),f.jsx("span",{className:"text-purple-600 font-medium",style:{fontSize:"0.95em"},children:"Speciale Projecten"}),f.jsx(Cu,{size:10,className:"text-purple-400 ml-auto"})]}),g&&f.jsxs("div",{className:"mt-1",onClick:y=>y.stopPropagation(),children:[xhe.map(y=>f.jsxs("a",{href:y.url,target:"_blank",rel:"noopener noreferrer",onClick:_=>_.stopPropagation(),className:"w-full flex items-center justify-between py-1.5 pl-6 pr-2 hover:bg-purple-50 rounded transition-colors text-left",style:{fontSize:"inherit"},children:[f.jsxs("div",{className:"flex flex-col",children:[f.jsx("span",{className:"text-gray-700",children:y.name}),f.jsx("span",{className:"text-gray-400",style:{fontSize:"0.8em"},children:y.desc})]}),f.jsx(Cu,{size:12,className:"text-purple-400 flex-shrink-0 ml-2"})]},y.name)),f.jsx("div",{className:"border-t border-gray-200 my-1.5 mx-2"}),_he.map(y=>f.jsxs("a",{href:y.url,target:"_blank",rel:"noopener noreferrer",onClick:_=>_.stopPropagation(),className:"w-full flex items-center justify-between py-1.5 pl-6 pr-2 hover:bg-purple-50 rounded transition-colors text-left",style:{fontSize:"inherit"},children:[f.jsxs("div",{className:"flex flex-col",children:[f.jsx("span",{className:"text-gray-700 font-medium",children:y.name}),f.jsx("span",{className:"text-gray-400",style:{fontSize:"0.8em"},children:y.desc})]}),f.jsx(Cu,{size:12,className:"text-purple-400 flex-shrink-0 ml-2"})]},y.name))]})]})]})]})]})})}function whe(n){n("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),n("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),n("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs");for(var e=1;e<=60;++e)n("EPSG:"+(32600+e),"+proj=utm +zone="+e+" +datum=WGS84 +units=m"),n("EPSG:"+(32700+e),"+proj=utm +zone="+e+" +south +datum=WGS84 +units=m");n("EPSG:5041","+title=WGS 84 / UPS North (E,N) +proj=stere +lat_0=90 +lon_0=0 +k=0.994 +x_0=2000000 +y_0=2000000 +datum=WGS84 +units=m"),n("EPSG:5042","+title=WGS 84 / UPS South (E,N) +proj=stere +lat_0=-90 +lon_0=0 +k=0.994 +x_0=2000000 +y_0=2000000 +datum=WGS84 +units=m"),n.WGS84=n["EPSG:4326"],n["EPSG:3785"]=n["EPSG:3857"],n.GOOGLE=n["EPSG:3857"],n["EPSG:900913"]=n["EPSG:3857"],n["EPSG:102113"]=n["EPSG:3857"]}var Sd=1,bd=2,E0=3,Ehe=4,IR=5,z5=6378137,She=6356752314e-3,U5=.0066943799901413165,np=484813681109536e-20,Xe=Math.PI/2,bhe=.16666666666666666,The=.04722222222222222,Rhe=.022156084656084655,ct=1e-10,Dr=.017453292519943295,Bs=57.29577951308232,$n=Math.PI/4,t1=Math.PI*2,Hr=3.14159265359,Xs={};Xs.greenwich=0;Xs.lisbon=-9.131906111111;Xs.paris=2.337229166667;Xs.bogota=-74.080916666667;Xs.madrid=-3.687938888889;Xs.rome=12.452333333333;Xs.bern=7.439583333333;Xs.jakarta=106.807719444444;Xs.ferro=-17.666666666667;Xs.brussels=4.367975;Xs.stockholm=18.058277777778;Xs.athens=23.7163375;Xs.oslo=10.722916666667;const Ahe={mm:{to_meter:.001},cm:{to_meter:.01},ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937},fath:{to_meter:1.8288},kmi:{to_meter:1852},"us-ch":{to_meter:20.1168402336805},"us-mi":{to_meter:1609.34721869444},km:{to_meter:1e3},"ind-ft":{to_meter:.30479841},"ind-yd":{to_meter:.91439523},mi:{to_meter:1609.344},yd:{to_meter:.9144},ch:{to_meter:20.1168},link:{to_meter:.201168},dm:{to_meter:.1},in:{to_meter:.0254},"ind-ch":{to_meter:20.11669506},"us-in":{to_meter:.025400050800101},"us-yd":{to_meter:.914401828803658}};var $5=/[\s_\-\/\(\)]/g;function Gu(n,e){if(n[e])return n[e];for(var t=Object.keys(n),r=e.toLowerCase().replace($5,""),i=-1,s,a;++i<t.length;)if(s=t[i],a=s.toLowerCase().replace($5,""),a===r)return n[s]}function CR(n){var e={},t=n.split("+").map(function(o){return o.trim()}).filter(function(o){return o}).reduce(function(o,l){var c=l.split("=");return c.push(!0),o[c[0].toLowerCase()]=c[1],o},{}),r,i,s,a={proj:"projName",datum:"datumCode",rf:function(o){e.rf=parseFloat(o)},lat_0:function(o){e.lat0=o*Dr},lat_1:function(o){e.lat1=o*Dr},lat_2:function(o){e.lat2=o*Dr},lat_ts:function(o){e.lat_ts=o*Dr},lon_0:function(o){e.long0=o*Dr},lon_1:function(o){e.long1=o*Dr},lon_2:function(o){e.long2=o*Dr},alpha:function(o){e.alpha=parseFloat(o)*Dr},gamma:function(o){e.rectified_grid_angle=parseFloat(o)*Dr},lonc:function(o){e.longc=o*Dr},x_0:function(o){e.x0=parseFloat(o)},y_0:function(o){e.y0=parseFloat(o)},k_0:function(o){e.k0=parseFloat(o)},k:function(o){e.k0=parseFloat(o)},a:function(o){e.a=parseFloat(o)},b:function(o){e.b=parseFloat(o)},r:function(o){e.a=e.b=parseFloat(o)},r_a:function(){e.R_A=!0},zone:function(o){e.zone=parseInt(o,10)},south:function(){e.utmSouth=!0},towgs84:function(o){e.datum_params=o.split(",").map(function(l){return parseFloat(l)})},to_meter:function(o){e.to_meter=parseFloat(o)},units:function(o){e.units=o;var l=Gu(Ahe,o);l&&(e.to_meter=l.to_meter)},from_greenwich:function(o){e.from_greenwich=o*Dr},pm:function(o){var l=Gu(Xs,o);e.from_greenwich=(l||parseFloat(o))*Dr},nadgrids:function(o){o==="@null"?e.datumCode="none":e.nadgrids=o},axis:function(o){var l="ewnsud";o.length===3&&l.indexOf(o.substr(0,1))!==-1&&l.indexOf(o.substr(1,1))!==-1&&l.indexOf(o.substr(2,1))!==-1&&(e.axis=o)},approx:function(){e.approx=!0},over:function(){e.over=!0}};for(r in t)i=t[r],r in a?(s=a[r],typeof s=="function"?s(i):e[s]=i):e[r]=i;return typeof e.datumCode=="string"&&e.datumCode!=="WGS84"&&(e.datumCode=e.datumCode.toLowerCase()),e.projStr=n,e}class SV{static getId(e){const t=e.find(r=>Array.isArray(r)&&r[0]==="ID");return t&&t.length>=3?{authority:t[1],code:parseInt(t[2],10)}:null}static convertUnit(e,t="unit"){if(!e||e.length<3)return{type:t,name:"unknown",conversion_factor:null};const r=e[1],i=parseFloat(e[2])||null,s=e.find(o=>Array.isArray(o)&&o[0]==="ID"),a=s?{authority:s[1],code:parseInt(s[2],10)}:null;return{type:t,name:r,conversion_factor:i,id:a}}static convertAxis(e){const t=e[1]||"Unknown";let r;const i=t.match(/^\((.)\)$/);if(i){const c=i[1].toUpperCase();if(c==="E")r="east";else if(c==="N")r="north";else if(c==="U")r="up";else throw new Error(`Unknown axis abbreviation: ${c}`)}else r=e[2]?e[2].toLowerCase():"unknown";const s=e.find(c=>Array.isArray(c)&&c[0]==="ORDER"),a=s?parseInt(s[1],10):null,o=e.find(c=>Array.isArray(c)&&(c[0]==="LENGTHUNIT"||c[0]==="ANGLEUNIT"||c[0]==="SCALEUNIT")),l=this.convertUnit(o);return{name:t,direction:r,unit:l,order:a}}static extractAxes(e){return e.filter(t=>Array.isArray(t)&&t[0]==="AXIS").map(t=>this.convertAxis(t)).sort((t,r)=>(t.order||0)-(r.order||0))}static convert(e,t={}){switch(e[0]){case"PROJCRS":t.type="ProjectedCRS",t.name=e[1],t.base_crs=e.find(m=>Array.isArray(m)&&m[0]==="BASEGEOGCRS")?this.convert(e.find(m=>Array.isArray(m)&&m[0]==="BASEGEOGCRS")):null,t.conversion=e.find(m=>Array.isArray(m)&&m[0]==="CONVERSION")?this.convert(e.find(m=>Array.isArray(m)&&m[0]==="CONVERSION")):null;const r=e.find(m=>Array.isArray(m)&&m[0]==="CS");r&&(t.coordinate_system={type:r[1],axis:this.extractAxes(e)});const i=e.find(m=>Array.isArray(m)&&m[0]==="LENGTHUNIT");if(i){const m=this.convertUnit(i);t.coordinate_system.unit=m}t.id=this.getId(e);break;case"BASEGEOGCRS":case"GEOGCRS":t.type="GeographicCRS",t.name=e[1];const s=e.find(m=>Array.isArray(m)&&(m[0]==="DATUM"||m[0]==="ENSEMBLE"));if(s){const m=this.convert(s);s[0]==="ENSEMBLE"?t.datum_ensemble=m:t.datum=m;const y=e.find(_=>Array.isArray(_)&&_[0]==="PRIMEM");y&&y[1]!=="Greenwich"&&(m.prime_meridian={name:y[1],longitude:parseFloat(y[2])})}t.coordinate_system={type:"ellipsoidal",axis:this.extractAxes(e)},t.id=this.getId(e);break;case"DATUM":t.type="GeodeticReferenceFrame",t.name=e[1],t.ellipsoid=e.find(m=>Array.isArray(m)&&m[0]==="ELLIPSOID")?this.convert(e.find(m=>Array.isArray(m)&&m[0]==="ELLIPSOID")):null;break;case"ENSEMBLE":t.type="DatumEnsemble",t.name=e[1],t.members=e.filter(m=>Array.isArray(m)&&m[0]==="MEMBER").map(m=>({type:"DatumEnsembleMember",name:m[1],id:this.getId(m)}));const a=e.find(m=>Array.isArray(m)&&m[0]==="ENSEMBLEACCURACY");a&&(t.accuracy=parseFloat(a[1]));const o=e.find(m=>Array.isArray(m)&&m[0]==="ELLIPSOID");o&&(t.ellipsoid=this.convert(o)),t.id=this.getId(e);break;case"ELLIPSOID":t.type="Ellipsoid",t.name=e[1],t.semi_major_axis=parseFloat(e[2]),t.inverse_flattening=parseFloat(e[3]),e.find(m=>Array.isArray(m)&&m[0]==="LENGTHUNIT")&&this.convert(e.find(m=>Array.isArray(m)&&m[0]==="LENGTHUNIT"),t);break;case"CONVERSION":t.type="Conversion",t.name=e[1],t.method=e.find(m=>Array.isArray(m)&&m[0]==="METHOD")?this.convert(e.find(m=>Array.isArray(m)&&m[0]==="METHOD")):null,t.parameters=e.filter(m=>Array.isArray(m)&&m[0]==="PARAMETER").map(m=>this.convert(m));break;case"METHOD":t.type="Method",t.name=e[1],t.id=this.getId(e);break;case"PARAMETER":t.type="Parameter",t.name=e[1],t.value=parseFloat(e[2]),t.unit=this.convertUnit(e.find(m=>Array.isArray(m)&&(m[0]==="LENGTHUNIT"||m[0]==="ANGLEUNIT"||m[0]==="SCALEUNIT"))),t.id=this.getId(e);break;case"BOUNDCRS":t.type="BoundCRS";const l=e.find(m=>Array.isArray(m)&&m[0]==="SOURCECRS");if(l){const m=l.find(y=>Array.isArray(y));t.source_crs=m?this.convert(m):null}const c=e.find(m=>Array.isArray(m)&&m[0]==="TARGETCRS");if(c){const m=c.find(y=>Array.isArray(y));t.target_crs=m?this.convert(m):null}const h=e.find(m=>Array.isArray(m)&&m[0]==="ABRIDGEDTRANSFORMATION");h?t.transformation=this.convert(h):t.transformation=null;break;case"ABRIDGEDTRANSFORMATION":if(t.type="Transformation",t.name=e[1],t.method=e.find(m=>Array.isArray(m)&&m[0]==="METHOD")?this.convert(e.find(m=>Array.isArray(m)&&m[0]==="METHOD")):null,t.parameters=e.filter(m=>Array.isArray(m)&&(m[0]==="PARAMETER"||m[0]==="PARAMETERFILE")).map(m=>{if(m[0]==="PARAMETER")return this.convert(m);if(m[0]==="PARAMETERFILE")return{name:m[1],value:m[2],id:{authority:"EPSG",code:8656}}}),t.parameters.length===7){const m=t.parameters[6];m.name==="Scale difference"&&(m.value=Math.round((m.value-1)*1e12)/1e6)}t.id=this.getId(e);break;case"AXIS":t.coordinate_system||(t.coordinate_system={type:"unspecified",axis:[]}),t.coordinate_system.axis.push(this.convertAxis(e));break;case"LENGTHUNIT":const g=this.convertUnit(e,"LinearUnit");t.coordinate_system&&t.coordinate_system.axis&&t.coordinate_system.axis.forEach(m=>{m.unit||(m.unit=g)}),g.conversion_factor&&g.conversion_factor!==1&&t.semi_major_axis&&(t.semi_major_axis={value:t.semi_major_axis,unit:g});break;default:t.keyword=e[0];break}return t}}class khe extends SV{static convert(e,t={}){return super.convert(e,t),t.coordinate_system&&t.coordinate_system.subtype==="Cartesian"&&delete t.coordinate_system,t.usage&&delete t.usage,t}}class Ihe extends SV{static convert(e,t={}){super.convert(e,t);const r=e.find(s=>Array.isArray(s)&&s[0]==="CS");r&&(t.coordinate_system={subtype:r[1],axis:this.extractAxes(e)});const i=e.find(s=>Array.isArray(s)&&s[0]==="USAGE");if(i){const s=i.find(l=>Array.isArray(l)&&l[0]==="SCOPE"),a=i.find(l=>Array.isArray(l)&&l[0]==="AREA"),o=i.find(l=>Array.isArray(l)&&l[0]==="BBOX");t.usage={},s&&(t.usage.scope=s[1]),a&&(t.usage.area=a[1]),o&&(t.usage.bbox=o.slice(1))}return t}}function Che(n){return n.find(e=>Array.isArray(e)&&e[0]==="USAGE")?"2019":(n.find(e=>Array.isArray(e)&&e[0]==="CS")||n[0]==="BOUNDCRS"||n[0]==="PROJCRS"||n[0]==="GEOGCRS","2015")}function Phe(n){return(Che(n)==="2019"?Ihe:khe).convert(n)}function Nhe(n){const e=n.toUpperCase();return e.includes("PROJCRS")||e.includes("GEOGCRS")||e.includes("BOUNDCRS")||e.includes("VERTCRS")||e.includes("LENGTHUNIT")||e.includes("ANGLEUNIT")||e.includes("SCALEUNIT")?"WKT2":(e.includes("PROJCS")||e.includes("GEOGCS")||e.includes("LOCAL_CS")||e.includes("VERT_CS")||e.includes("UNIT"),"WKT1")}var n1=1,bV=2,TV=3,Uv=4,RV=5,BI=-1,Mhe=/\s/,Lhe=/[A-Za-z]/,Ohe=/[A-Za-z84_]/,kE=/[,\]]/,AV=/[\d\.E\-\+]/;function vc(n){if(typeof n!="string")throw new Error("not a string");this.text=n.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=n1}vc.prototype.readCharicter=function(){var n=this.text[this.place++];if(this.state!==Uv)for(;Mhe.test(n);){if(this.place>=this.text.length)return;n=this.text[this.place++]}switch(this.state){case n1:return this.neutral(n);case bV:return this.keyword(n);case Uv:return this.quoted(n);case RV:return this.afterquote(n);case TV:return this.number(n);case BI:return}};vc.prototype.afterquote=function(n){if(n==='"'){this.word+='"',this.state=Uv;return}if(kE.test(n)){this.word=this.word.trim(),this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in afterquote yet, index '+this.place)};vc.prototype.afterItem=function(n){if(n===","){this.word!==null&&this.currentObject.push(this.word),this.word=null,this.state=n1;return}if(n==="]"){this.level--,this.word!==null&&(this.currentObject.push(this.word),this.word=null),this.state=n1,this.currentObject=this.stack.pop(),this.currentObject||(this.state=BI);return}};vc.prototype.number=function(n){if(AV.test(n)){this.word+=n;return}if(kE.test(n)){this.word=parseFloat(this.word),this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in number yet, index '+this.place)};vc.prototype.quoted=function(n){if(n==='"'){this.state=RV;return}this.word+=n};vc.prototype.keyword=function(n){if(Ohe.test(n)){this.word+=n;return}if(n==="["){var e=[];e.push(this.word),this.level++,this.root===null?this.root=e:this.currentObject.push(e),this.stack.push(this.currentObject),this.currentObject=e,this.state=n1;return}if(kE.test(n)){this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in keyword yet, index '+this.place)};vc.prototype.neutral=function(n){if(Lhe.test(n)){this.word=n,this.state=bV;return}if(n==='"'){this.word="",this.state=Uv;return}if(AV.test(n)){this.word=n,this.state=TV;return}if(kE.test(n)){this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in neutral yet, index '+this.place)};vc.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(this.state===BI)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};function Dhe(n){var e=new vc(n);return e.output()}function Cb(n,e,t){Array.isArray(e)&&(t.unshift(e),e=null);var r=e?{}:n,i=t.reduce(function(s,a){return o0(a,s),s},r);e&&(n[e]=i)}function o0(n,e){if(!Array.isArray(n)){e[n]=!0;return}var t=n.shift();if(t==="PARAMETER"&&(t=n.shift()),n.length===1){if(Array.isArray(n[0])){e[t]={},o0(n[0],e[t]);return}e[t]=n[0];return}if(!n.length){e[t]=!0;return}if(t==="TOWGS84"){e[t]=n;return}if(t==="AXIS"){t in e||(e[t]=[]),e[t].push(n);return}Array.isArray(t)||(e[t]={});var r;switch(t){case"UNIT":case"PRIMEM":case"VERT_DATUM":e[t]={name:n[0].toLowerCase(),convert:n[1]},n.length===3&&o0(n[2],e[t]);return;case"SPHEROID":case"ELLIPSOID":e[t]={name:n[0],a:n[1],rf:n[2]},n.length===4&&o0(n[3],e[t]);return;case"EDATUM":case"ENGINEERINGDATUM":case"LOCAL_DATUM":case"DATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":n[0]=["name",n[0]],Cb(e,t,n);return;case"COMPD_CS":case"COMPOUNDCRS":case"FITTED_CS":case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"ENGCRS":case"ENGINEERINGCRS":n[0]=["name",n[0]],Cb(e,t,n),e[t].type=t;return;default:for(r=-1;++r<n.length;)if(!Array.isArray(n[r]))return o0(n,e[t]);return Cb(e,t,n)}}var jhe=.017453292519943295;function so(n){return n*jhe}function kV(n){const e=(n.projName||"").toLowerCase().replace(/_/g," ");!n.long0&&n.longc&&(e==="albers conic equal area"||e==="lambert azimuthal equal area")&&(n.long0=n.longc),!n.lat_ts&&n.lat1&&(e==="stereographic south pole"||e==="polar stereographic (variant b)")?(n.lat0=so(n.lat1>0?90:-90),n.lat_ts=n.lat1,delete n.lat1):!n.lat_ts&&n.lat0&&(e==="polar stereographic"||e==="polar stereographic (variant a)")&&(n.lat_ts=n.lat0,n.lat0=so(n.lat0>0?90:-90),delete n.lat1)}function W5(n){let e={units:null,to_meter:void 0};return typeof n=="string"?(e.units=n.toLowerCase(),e.units==="metre"&&(e.units="meter"),e.units==="meter"&&(e.to_meter=1)):n&&n.name&&(e.units=n.name.toLowerCase(),e.units==="metre"&&(e.units="meter"),e.to_meter=n.conversion_factor),e}function H5(n){return typeof n=="object"?n.value*n.unit.conversion_factor:n}function K5(n,e){n.ellipsoid.radius?(e.a=n.ellipsoid.radius,e.rf=0):(e.a=H5(n.ellipsoid.semi_major_axis),n.ellipsoid.inverse_flattening!==void 0?e.rf=n.ellipsoid.inverse_flattening:n.ellipsoid.semi_major_axis!==void 0&&n.ellipsoid.semi_minor_axis!==void 0&&(e.rf=e.a/(e.a-H5(n.ellipsoid.semi_minor_axis))))}function $v(n,e={}){return!n||typeof n!="object"?n:n.type==="BoundCRS"?($v(n.source_crs,e),n.transformation&&(n.transformation.method&&n.transformation.method.name==="NTv2"?e.nadgrids=n.transformation.parameters[0].value:e.datum_params=n.transformation.parameters.map(t=>t.value)),e):(Object.keys(n).forEach(t=>{const r=n[t];if(r!==null)switch(t){case"name":if(e.srsCode)break;e.name=r,e.srsCode=r;break;case"type":r==="GeographicCRS"?e.projName="longlat":r==="ProjectedCRS"&&n.conversion&&n.conversion.method&&(e.projName=n.conversion.method.name);break;case"datum":case"datum_ensemble":r.ellipsoid&&(e.ellps=r.ellipsoid.name,K5(r,e)),r.prime_meridian&&(e.from_greenwich=r.prime_meridian.longitude*Math.PI/180);break;case"ellipsoid":e.ellps=r.name,K5(r,e);break;case"prime_meridian":e.long0=(r.longitude||0)*Math.PI/180;break;case"coordinate_system":if(r.axis){if(e.axis=r.axis.map(i=>{const s=i.direction;if(s==="east")return"e";if(s==="north")return"n";if(s==="west")return"w";if(s==="south")return"s";throw new Error(`Unknown axis direction: ${s}`)}).join("")+"u",r.unit){const{units:i,to_meter:s}=W5(r.unit);e.units=i,e.to_meter=s}else if(r.axis[0]&&r.axis[0].unit){const{units:i,to_meter:s}=W5(r.axis[0].unit);e.units=i,e.to_meter=s}}break;case"id":r.authority&&r.code&&(e.title=r.authority+":"+r.code);break;case"conversion":r.method&&r.method.name&&(e.projName=r.method.name),r.parameters&&r.parameters.forEach(i=>{const s=i.name.toLowerCase().replace(/\s+/g,"_"),a=i.value;i.unit&&i.unit.conversion_factor?e[s]=a*i.unit.conversion_factor:i.unit==="degree"?e[s]=a*Math.PI/180:e[s]=a});break;case"unit":r.name&&(e.units=r.name.toLowerCase(),e.units==="metre"&&(e.units="meter")),r.conversion_factor&&(e.to_meter=r.conversion_factor);break;case"base_crs":$v(r,e),e.datumCode=r.id?r.id.authority+"_"+r.id.code:r.name;break}}),e.latitude_of_false_origin!==void 0&&(e.lat0=e.latitude_of_false_origin),e.longitude_of_false_origin!==void 0&&(e.long0=e.longitude_of_false_origin),e.latitude_of_standard_parallel!==void 0&&(e.lat0=e.latitude_of_standard_parallel,e.lat1=e.latitude_of_standard_parallel),e.latitude_of_1st_standard_parallel!==void 0&&(e.lat1=e.latitude_of_1st_standard_parallel),e.latitude_of_2nd_standard_parallel!==void 0&&(e.lat2=e.latitude_of_2nd_standard_parallel),e.latitude_of_projection_centre!==void 0&&(e.lat0=e.latitude_of_projection_centre),e.longitude_of_projection_centre!==void 0&&(e.longc=e.longitude_of_projection_centre),e.easting_at_false_origin!==void 0&&(e.x0=e.easting_at_false_origin),e.northing_at_false_origin!==void 0&&(e.y0=e.northing_at_false_origin),e.latitude_of_natural_origin!==void 0&&(e.lat0=e.latitude_of_natural_origin),e.longitude_of_natural_origin!==void 0&&(e.long0=e.longitude_of_natural_origin),e.longitude_of_origin!==void 0&&(e.long0=e.longitude_of_origin),e.false_easting!==void 0&&(e.x0=e.false_easting),e.easting_at_projection_centre&&(e.x0=e.easting_at_projection_centre),e.false_northing!==void 0&&(e.y0=e.false_northing),e.northing_at_projection_centre&&(e.y0=e.northing_at_projection_centre),e.standard_parallel_1!==void 0&&(e.lat1=e.standard_parallel_1),e.standard_parallel_2!==void 0&&(e.lat2=e.standard_parallel_2),e.scale_factor_at_natural_origin!==void 0&&(e.k0=e.scale_factor_at_natural_origin),e.scale_factor_at_projection_centre!==void 0&&(e.k0=e.scale_factor_at_projection_centre),e.scale_factor_on_pseudo_standard_parallel!==void 0&&(e.k0=e.scale_factor_on_pseudo_standard_parallel),e.azimuth!==void 0&&(e.alpha=e.azimuth),e.azimuth_at_projection_centre!==void 0&&(e.alpha=e.azimuth_at_projection_centre),e.angle_from_rectified_to_skew_grid&&(e.rectified_grid_angle=e.angle_from_rectified_to_skew_grid),kV(e),e)}var Fhe=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function Vhe(n,e){var t=e[0],r=e[1];!(t in n)&&r in n&&(n[t]=n[r],e.length===3&&(n[t]=e[2](n[t])))}function IV(n){for(var e=Object.keys(n),t=0,r=e.length;t<r;++t){var i=e[t];Fhe.indexOf(i)!==-1&&Bhe(n[i]),typeof n[i]=="object"&&IV(n[i])}}function Bhe(n){if(n.AUTHORITY){var e=Object.keys(n.AUTHORITY)[0];e&&e in n.AUTHORITY&&(n.title=e+":"+n.AUTHORITY[e])}if(n.type==="GEOGCS"?n.projName="longlat":n.type==="LOCAL_CS"?(n.projName="identity",n.local=!0):typeof n.PROJECTION=="object"?n.projName=Object.keys(n.PROJECTION)[0]:n.projName=n.PROJECTION,n.AXIS){for(var t="",r=0,i=n.AXIS.length;r<i;++r){var s=[n.AXIS[r][0].toLowerCase(),n.AXIS[r][1].toLowerCase()];s[0].indexOf("north")!==-1||(s[0]==="y"||s[0]==="lat")&&s[1]==="north"?t+="n":s[0].indexOf("south")!==-1||(s[0]==="y"||s[0]==="lat")&&s[1]==="south"?t+="s":s[0].indexOf("east")!==-1||(s[0]==="x"||s[0]==="lon")&&s[1]==="east"?t+="e":(s[0].indexOf("west")!==-1||(s[0]==="x"||s[0]==="lon")&&s[1]==="west")&&(t+="w")}t.length===2&&(t+="u"),t.length===3&&(n.axis=t)}n.UNIT&&(n.units=n.UNIT.name.toLowerCase(),n.units==="metre"&&(n.units="meter"),n.UNIT.convert&&(n.type==="GEOGCS"?n.DATUM&&n.DATUM.SPHEROID&&(n.to_meter=n.UNIT.convert*n.DATUM.SPHEROID.a):n.to_meter=n.UNIT.convert));var a=n.GEOGCS;n.type==="GEOGCS"&&(a=n),a&&(a.DATUM?n.datumCode=a.DATUM.name.toLowerCase():n.datumCode=a.name.toLowerCase(),n.datumCode.slice(0,2)==="d_"&&(n.datumCode=n.datumCode.slice(2)),n.datumCode==="new_zealand_1949"&&(n.datumCode="nzgd49"),(n.datumCode==="wgs_1984"||n.datumCode==="world_geodetic_system_1984")&&(n.PROJECTION==="Mercator_Auxiliary_Sphere"&&(n.sphere=!0),n.datumCode="wgs84"),n.datumCode==="belge_1972"&&(n.datumCode="rnb72"),a.DATUM&&a.DATUM.SPHEROID&&(n.ellps=a.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),n.ellps.toLowerCase().slice(0,13)==="international"&&(n.ellps="intl"),n.a=a.DATUM.SPHEROID.a,n.rf=parseFloat(a.DATUM.SPHEROID.rf,10)),a.DATUM&&a.DATUM.TOWGS84&&(n.datum_params=a.DATUM.TOWGS84),~n.datumCode.indexOf("osgb_1936")&&(n.datumCode="osgb36"),~n.datumCode.indexOf("osni_1952")&&(n.datumCode="osni52"),(~n.datumCode.indexOf("tm65")||~n.datumCode.indexOf("geodetic_datum_of_1965"))&&(n.datumCode="ire65"),n.datumCode==="ch1903+"&&(n.datumCode="ch1903"),~n.datumCode.indexOf("israel")&&(n.datumCode="isr93")),n.b&&!isFinite(n.b)&&(n.b=n.a),n.rectified_grid_angle&&(n.rectified_grid_angle=so(n.rectified_grid_angle));function o(h){var g=n.to_meter||1;return h*g}var l=function(h){return Vhe(n,h)},c=[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",so],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",so],["x0","false_easting",o],["y0","false_northing",o],["long0","central_meridian",so],["lat0","latitude_of_origin",so],["lat0","standard_parallel_1",so],["lat1","standard_parallel_1",so],["lat2","standard_parallel_2",so],["azimuth","Azimuth"],["alpha","azimuth",so],["srsCode","name"]];c.forEach(l),kV(n)}function Wv(n){if(typeof n=="object")return $v(n);const e=Nhe(n);var t=Dhe(n);if(e==="WKT2"){const s=Phe(t);return $v(s)}var r=t[0],i={};return o0(t,i),IV(i),i[r]}function Vi(n){var e=this;if(arguments.length===2){var t=arguments[1];typeof t=="string"?t.charAt(0)==="+"?Vi[n]=CR(arguments[1]):Vi[n]=Wv(arguments[1]):t&&typeof t=="object"&&!("projName"in t)?Vi[n]=Wv(arguments[1]):(Vi[n]=t,t||delete Vi[n])}else if(arguments.length===1){if(Array.isArray(n))return n.map(function(r){return Array.isArray(r)?Vi.apply(e,r):Vi(r)});if(typeof n=="string"){if(n in Vi)return Vi[n]}else"EPSG"in n?Vi["EPSG:"+n.EPSG]=n:"ESRI"in n?Vi["ESRI:"+n.ESRI]=n:"IAU2000"in n?Vi["IAU2000:"+n.IAU2000]=n:console.log(n);return}}whe(Vi);function Ghe(n){return typeof n=="string"}function zhe(n){return n in Vi}function Uhe(n){return n.indexOf("+")!==0&&n.indexOf("[")!==-1||typeof n=="object"&&!("srsCode"in n)}var $he=["3857","900913","3785","102113"];function Whe(n){var e=Gu(n,"authority");if(e){var t=Gu(e,"epsg");return t&&$he.indexOf(t)>-1}}function Hhe(n){var e=Gu(n,"extension");if(e)return Gu(e,"proj4")}function Khe(n){return n[0]==="+"}function Xhe(n){if(Ghe(n)){if(zhe(n))return Vi[n];if(Uhe(n)){var e=Wv(n);if(Whe(e))return Vi["EPSG:3857"];var t=Hhe(e);return t?CR(t):e}if(Khe(n))return CR(n)}else return"projName"in n?n:Wv(n)}function X5(n,e){n=n||{};var t,r;if(!e)return n;for(r in e)t=e[r],t!==void 0&&(n[r]=t);return n}function gl(n,e,t){var r=n*e;return t/Math.sqrt(1-r*r)}function J1(n){return n<0?-1:1}function mt(n,e){return e||Math.abs(n)<=Hr?n:n-J1(n)*t1}function _o(n,e,t){var r=n*t,i=.5*n;return r=Math.pow((1-r)/(1+r),i),Math.tan(.5*(Xe-e))/r}function r1(n,e){for(var t=.5*n,r,i,s=Xe-2*Math.atan(e),a=0;a<=15;a++)if(r=n*Math.sin(s),i=Xe-2*Math.atan(e*Math.pow((1-r)/(1+r),t))-s,s+=i,Math.abs(i)<=1e-10)return s;return-9999}function qhe(){var n=this.b/this.a;this.es=1-n*n,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=gl(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)}function Yhe(n){var e=n.x,t=n.y;if(t*Bs>90&&t*Bs<-90&&e*Bs>180&&e*Bs<-180)return null;var r,i;if(Math.abs(Math.abs(t)-Xe)<=ct)return null;if(this.sphere)r=this.x0+this.a*this.k0*mt(e-this.long0,this.over),i=this.y0+this.a*this.k0*Math.log(Math.tan($n+.5*t));else{var s=Math.sin(t),a=_o(this.e,t,s);r=this.x0+this.a*this.k0*mt(e-this.long0,this.over),i=this.y0-this.a*this.k0*Math.log(a)}return n.x=r,n.y=i,n}function Zhe(n){var e=n.x-this.x0,t=n.y-this.y0,r,i;if(this.sphere)i=Xe-2*Math.atan(Math.exp(-t/(this.a*this.k0)));else{var s=Math.exp(-t/(this.a*this.k0));if(i=r1(this.e,s),i===-9999)return null}return r=mt(this.long0+e/(this.a*this.k0),this.over),n.x=r,n.y=i,n}var Jhe=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","Mercator_Variant_A","merc"];const Qhe={init:qhe,forward:Yhe,inverse:Zhe,names:Jhe};function ede(){}function q5(n){return n}var CV=["longlat","identity"];const tde={init:ede,forward:q5,inverse:q5,names:CV};var nde=[Qhe,tde],Nh={},l0=[];function PV(n,e){var t=l0.length;return n.names?(l0[t]=n,n.names.forEach(function(r){Nh[r.toLowerCase()]=t}),this):(console.log(e),!0)}function NV(n){return n.replace(/[-\(\)\s]+/g," ").trim().replace(/ /g,"_")}function rde(n){if(!n)return!1;var e=n.toLowerCase();if(typeof Nh[e]<"u"&&l0[Nh[e]]||(e=NV(e),e in Nh&&l0[Nh[e]]))return l0[Nh[e]]}function ide(){nde.forEach(PV)}const sde={start:ide,add:PV,get:rde};var MV={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563396e-3,b:635625691e-2,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340189e-3,b:6356034446e-3,ellipseName:"Modified Airy"},andrae:{a:637710443e-2,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397155e-3,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483865e-3,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:63782064e-1,b:63565838e-1,ellipseName:"Clarke 1866"},clrk80:{a:6378249145e-3,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk80ign:{a:63782492e-1,b:6356515,rf:293.4660213,ellipseName:"Clarke 1880 (IGN)"},clrk58:{a:6378293645208759e-9,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:63757387e-1,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:637813605e-2,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276345e-3,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304063e-3,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301243e-3,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295664e-3,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298556e-3,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:63781575e-1,b:63567722e-1,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:63567733205e-4,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:63558348467e-4,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"},WGS84:{a:6378137,rf:298.257223563,ellipseName:"WGS 84"},sphere:{a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"}};const ade=MV.WGS84;function ode(n,e,t,r){var i=n*n,s=e*e,a=(i-s)/i,o=0;r?(n*=1-a*(bhe+a*(The+a*Rhe)),i=n*n,a=0):o=Math.sqrt(a);var l=(i-s)/s;return{es:a,e:o,ep2:l}}function lde(n,e,t,r,i){if(!n){var s=Gu(MV,r);s||(s=ade),n=s.a,e=s.b,t=s.rf}return t&&!e&&(e=(1-1/t)*n),(t===0||Math.abs(n-e)<ct)&&(i=!0,e=n),{a:n,b:e,rf:t,sphere:i}}var b_={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},mgi:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Militar-Geographische Institut"},osni52:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Ordnance Survey of Great Britain 1936"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"},EPSG_5451:{towgs84:"6.41,-49.05,-11.28,1.5657,0.5242,6.9718,-5.7649"},IGNF_LURESG:{towgs84:"-192.986,13.673,-39.309,-0.4099,-2.9332,2.6881,0.43"},EPSG_4614:{towgs84:"-119.4248,-303.65872,-11.00061,1.164298,0.174458,1.096259,3.657065"},EPSG_4615:{towgs84:"-494.088,-312.129,279.877,-1.423,-1.013,1.59,-0.748"},ESRI_37241:{towgs84:"-76.822,257.457,-12.817,2.136,-0.033,-2.392,-0.031"},ESRI_37249:{towgs84:"-440.296,58.548,296.265,1.128,10.202,4.559,-0.438"},ESRI_37245:{towgs84:"-511.151,-181.269,139.609,1.05,2.703,1.798,3.071"},EPSG_4178:{towgs84:"24.9,-126.4,-93.2,-0.063,-0.247,-0.041,1.01"},EPSG_4622:{towgs84:"-472.29,-5.63,-304.12,0.4362,-0.8374,0.2563,1.8984"},EPSG_4625:{towgs84:"126.93,547.94,130.41,-2.7867,5.1612,-0.8584,13.8227"},EPSG_5252:{towgs84:"0.023,0.036,-0.068,0.00176,0.00912,-0.01136,0.00439"},EPSG_4314:{towgs84:"597.1,71.4,412.1,0.894,0.068,-1.563,7.58"},EPSG_4282:{towgs84:"-178.3,-316.7,-131.5,5.278,6.077,10.979,19.166"},EPSG_4231:{towgs84:"-83.11,-97.38,-117.22,0.0276,-0.2167,0.2147,0.1218"},EPSG_4274:{towgs84:"-230.994,102.591,25.199,0.633,-0.239,0.9,1.95"},EPSG_4134:{towgs84:"-180.624,-225.516,173.919,-0.81,-1.898,8.336,16.71006"},EPSG_4254:{towgs84:"18.38,192.45,96.82,0.056,-0.142,-0.2,-0.0013"},EPSG_4159:{towgs84:"-194.513,-63.978,-25.759,-3.4027,3.756,-3.352,-0.9175"},EPSG_4687:{towgs84:"0.072,-0.507,-0.245,0.0183,-0.0003,0.007,-0.0093"},EPSG_4227:{towgs84:"-83.58,-397.54,458.78,-17.595,-2.847,4.256,3.225"},EPSG_4746:{towgs84:"599.4,72.4,419.2,-0.062,-0.022,-2.723,6.46"},EPSG_4745:{towgs84:"612.4,77,440.2,-0.054,0.057,-2.797,2.55"},EPSG_6311:{towgs84:"8.846,-4.394,-1.122,-0.00237,-0.146528,0.130428,0.783926"},EPSG_4289:{towgs84:"565.7381,50.4018,465.2904,-1.91514,1.60363,-9.09546,4.07244"},EPSG_4230:{towgs84:"-68.863,-134.888,-111.49,-0.53,-0.14,0.57,-3.4"},EPSG_4154:{towgs84:"-123.02,-158.95,-168.47"},EPSG_4156:{towgs84:"570.8,85.7,462.8,4.998,1.587,5.261,3.56"},EPSG_4299:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4179:{towgs84:"33.4,-146.6,-76.3,-0.359,-0.053,0.844,-0.84"},EPSG_4313:{towgs84:"-106.8686,52.2978,-103.7239,0.3366,-0.457,1.8422,-1.2747"},EPSG_4194:{towgs84:"163.511,127.533,-159.789"},EPSG_4195:{towgs84:"105,326,-102.5"},EPSG_4196:{towgs84:"-45,417,-3.5"},EPSG_4611:{towgs84:"-162.619,-276.959,-161.764,0.067753,-2.243649,-1.158827,-1.094246"},EPSG_4633:{towgs84:"137.092,131.66,91.475,-1.9436,-11.5993,-4.3321,-7.4824"},EPSG_4641:{towgs84:"-408.809,366.856,-412.987,1.8842,-0.5308,2.1655,-121.0993"},EPSG_4643:{towgs84:"-480.26,-438.32,-643.429,16.3119,20.1721,-4.0349,-111.7002"},EPSG_4300:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4188:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4660:{towgs84:"982.6087,552.753,-540.873,32.39344,-153.25684,-96.2266,16.805"},EPSG_4662:{towgs84:"97.295,-263.247,310.882,-1.5999,0.8386,3.1409,13.3259"},EPSG_3906:{towgs84:"577.88891,165.22205,391.18289,4.9145,-0.94729,-13.05098,7.78664"},EPSG_4307:{towgs84:"-209.3622,-87.8162,404.6198,0.0046,3.4784,0.5805,-1.4547"},EPSG_6892:{towgs84:"-76.269,-16.683,68.562,-6.275,10.536,-4.286,-13.686"},EPSG_4690:{towgs84:"221.597,152.441,176.523,2.403,1.3893,0.884,11.4648"},EPSG_4691:{towgs84:"218.769,150.75,176.75,3.5231,2.0037,1.288,10.9817"},EPSG_4629:{towgs84:"72.51,345.411,79.241,-1.5862,-0.8826,-0.5495,1.3653"},EPSG_4630:{towgs84:"165.804,216.213,180.26,-0.6251,-0.4515,-0.0721,7.4111"},EPSG_4692:{towgs84:"217.109,86.452,23.711,0.0183,-0.0003,0.007,-0.0093"},EPSG_9333:{towgs84:"0,0,0,-8.393,0.749,-10.276,0"},EPSG_9059:{towgs84:"0,0,0"},EPSG_4312:{towgs84:"601.705,84.263,485.227,4.7354,1.3145,5.393,-2.3887"},EPSG_4123:{towgs84:"-96.062,-82.428,-121.753,4.801,0.345,-1.376,1.496"},EPSG_4309:{towgs84:"-124.45,183.74,44.64,-0.4384,0.5446,-0.9706,-2.1365"},ESRI_104106:{towgs84:"-283.088,-70.693,117.445,-1.157,0.059,-0.652,-4.058"},EPSG_4281:{towgs84:"-219.247,-73.802,269.529"},EPSG_4322:{towgs84:"0,0,4.5"},EPSG_4324:{towgs84:"0,0,1.9"},EPSG_4284:{towgs84:"43.822,-108.842,-119.585,1.455,-0.761,0.737,0.549"},EPSG_4277:{towgs84:"446.448,-125.157,542.06,0.15,0.247,0.842,-20.489"},EPSG_4207:{towgs84:"-282.1,-72.2,120,-1.529,0.145,-0.89,-4.46"},EPSG_4688:{towgs84:"347.175,1077.618,2623.677,33.9058,-70.6776,9.4013,186.0647"},EPSG_4689:{towgs84:"410.793,54.542,80.501,-2.5596,-2.3517,-0.6594,17.3218"},EPSG_4720:{towgs84:"0,0,4.5"},EPSG_4273:{towgs84:"278.3,93,474.5,7.889,0.05,-6.61,6.21"},EPSG_4240:{towgs84:"204.64,834.74,293.8"},EPSG_4817:{towgs84:"278.3,93,474.5,7.889,0.05,-6.61,6.21"},ESRI_104131:{towgs84:"426.62,142.62,460.09,4.98,4.49,-12.42,-17.1"},EPSG_4265:{towgs84:"-104.1,-49.1,-9.9,0.971,-2.917,0.714,-11.68"},EPSG_4263:{towgs84:"-111.92,-87.85,114.5,1.875,0.202,0.219,0.032"},EPSG_4298:{towgs84:"-689.5937,623.84046,-65.93566,-0.02331,1.17094,-0.80054,5.88536"},EPSG_4270:{towgs84:"-253.4392,-148.452,386.5267,0.15605,0.43,-0.1013,-0.0424"},EPSG_4229:{towgs84:"-121.8,98.1,-10.7"},EPSG_4220:{towgs84:"-55.5,-348,-229.2"},EPSG_4214:{towgs84:"12.646,-155.176,-80.863"},EPSG_4232:{towgs84:"-345,3,223"},EPSG_4238:{towgs84:"-1.977,-13.06,-9.993,0.364,0.254,0.689,-1.037"},EPSG_4168:{towgs84:"-170,33,326"},EPSG_4131:{towgs84:"199,931,318.9"},EPSG_4152:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_5228:{towgs84:"572.213,85.334,461.94,4.9732,1.529,5.2484,3.5378"},EPSG_8351:{towgs84:"485.021,169.465,483.839,7.786342,4.397554,4.102655,0"},EPSG_4683:{towgs84:"-127.62,-67.24,-47.04,-3.068,4.903,1.578,-1.06"},EPSG_4133:{towgs84:"0,0,0"},EPSG_7373:{towgs84:"0.819,-0.5762,-1.6446,-0.00378,-0.03317,0.00318,0.0693"},EPSG_9075:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_9072:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_9294:{towgs84:"1.16835,-1.42001,-2.24431,-0.00822,-0.05508,0.01818,0.23388"},EPSG_4212:{towgs84:"-267.434,173.496,181.814,-13.4704,8.7154,7.3926,14.7492"},EPSG_4191:{towgs84:"-44.183,-0.58,-38.489,2.3867,2.7072,-3.5196,-8.2703"},EPSG_4237:{towgs84:"52.684,-71.194,-13.975,-0.312,-0.1063,-0.3729,1.0191"},EPSG_4740:{towgs84:"-1.08,-0.27,-0.9"},EPSG_4124:{towgs84:"419.3836,99.3335,591.3451,0.850389,1.817277,-7.862238,-0.99496"},EPSG_5681:{towgs84:"584.9636,107.7175,413.8067,1.1155,0.2824,-3.1384,7.9922"},EPSG_4141:{towgs84:"23.772,17.49,17.859,-0.3132,-1.85274,1.67299,-5.4262"},EPSG_4204:{towgs84:"-85.645,-273.077,-79.708,2.289,-1.421,2.532,3.194"},EPSG_4319:{towgs84:"226.702,-193.337,-35.371,-2.229,-4.391,9.238,0.9798"},EPSG_4200:{towgs84:"24.82,-131.21,-82.66"},EPSG_4130:{towgs84:"0,0,0"},EPSG_4127:{towgs84:"-82.875,-57.097,-156.768,-2.158,1.524,-0.982,-0.359"},EPSG_4149:{towgs84:"674.374,15.056,405.346"},EPSG_4617:{towgs84:"-0.991,1.9072,0.5129,1.25033e-7,4.6785e-8,5.6529e-8,0"},EPSG_4663:{towgs84:"-210.502,-66.902,-48.476,2.094,-15.067,-5.817,0.485"},EPSG_4664:{towgs84:"-211.939,137.626,58.3,-0.089,0.251,0.079,0.384"},EPSG_4665:{towgs84:"-105.854,165.589,-38.312,-0.003,-0.026,0.024,-0.048"},EPSG_4666:{towgs84:"631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43"},EPSG_4756:{towgs84:"-192.873,-39.382,-111.202,-0.00205,-0.0005,0.00335,0.0188"},EPSG_4723:{towgs84:"-179.483,-69.379,-27.584,-7.862,8.163,6.042,-13.925"},EPSG_4726:{towgs84:"8.853,-52.644,180.304,-0.393,-2.323,2.96,-24.081"},EPSG_4267:{towgs84:"-8.0,160.0,176.0"},EPSG_5365:{towgs84:"-0.16959,0.35312,0.51846,0.03385,-0.16325,0.03446,0.03693"},EPSG_4218:{towgs84:"304.5,306.5,-318.1"},EPSG_4242:{towgs84:"-33.722,153.789,94.959,-8.581,-4.478,4.54,8.95"},EPSG_4216:{towgs84:"-292.295,248.758,429.447,4.9971,2.99,6.6906,1.0289"},ESRI_104105:{towgs84:"631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43"},ESRI_104129:{towgs84:"0,0,0"},EPSG_4673:{towgs84:"174.05,-25.49,112.57"},EPSG_4202:{towgs84:"-124,-60,154"},EPSG_4203:{towgs84:"-117.763,-51.51,139.061,0.292,0.443,0.277,-0.191"},EPSG_3819:{towgs84:"595.48,121.69,515.35,4.115,-2.9383,0.853,-3.408"},EPSG_8694:{towgs84:"-93.799,-132.737,-219.073,-1.844,0.648,-6.37,-0.169"},EPSG_4145:{towgs84:"275.57,676.78,229.6"},EPSG_4283:{towgs84:"61.55,-10.87,-40.19,39.4924,32.7221,32.8979,-9.994"},EPSG_4317:{towgs84:"2.3287,-147.0425,-92.0802,-0.3092483,0.32482185,0.49729934,5.68906266"},EPSG_4272:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993"},EPSG_4248:{towgs84:"-307.7,265.3,-363.5"},EPSG_5561:{towgs84:"24,-121,-76"},EPSG_5233:{towgs84:"-0.293,766.95,87.713,0.195704,1.695068,3.473016,-0.039338"},ESRI_104130:{towgs84:"-86,-98,-119"},ESRI_104102:{towgs84:"682,-203,480"},ESRI_37207:{towgs84:"7,-10,-26"},EPSG_4675:{towgs84:"59.935,118.4,-10.871"},ESRI_104109:{towgs84:"-89.121,-348.182,260.871"},ESRI_104112:{towgs84:"-185.583,-230.096,281.361"},ESRI_104113:{towgs84:"25.1,-275.6,222.6"},IGNF_WGS72G:{towgs84:"0,12,6"},IGNF_NTFG:{towgs84:"-168,-60,320"},IGNF_EFATE57G:{towgs84:"-127,-769,472"},IGNF_PGP50G:{towgs84:"324.8,153.6,172.1"},IGNF_REUN47G:{towgs84:"94,-948,-1262"},IGNF_CSG67G:{towgs84:"-186,230,110"},IGNF_GUAD48G:{towgs84:"-467,-16,-300"},IGNF_TAHI51G:{towgs84:"162,117,154"},IGNF_TAHAAG:{towgs84:"65,342,77"},IGNF_NUKU72G:{towgs84:"84,274,65"},IGNF_PETRELS72G:{towgs84:"365,194,166"},IGNF_WALL78G:{towgs84:"253,-133,-127"},IGNF_MAYO50G:{towgs84:"-382,-59,-262"},IGNF_TANNAG:{towgs84:"-139,-967,436"},IGNF_IGN72G:{towgs84:"-13,-348,292"},IGNF_ATIGG:{towgs84:"1118,23,66"},IGNF_FANGA84G:{towgs84:"150.57,158.33,118.32"},IGNF_RUSAT84G:{towgs84:"202.13,174.6,-15.74"},IGNF_KAUE70G:{towgs84:"126.74,300.1,-75.49"},IGNF_MOP90G:{towgs84:"-10.8,-1.8,12.77"},IGNF_MHPF67G:{towgs84:"338.08,212.58,-296.17"},IGNF_TAHI79G:{towgs84:"160.61,116.05,153.69"},IGNF_ANAA92G:{towgs84:"1.5,3.84,4.81"},IGNF_MARQUI72G:{towgs84:"330.91,-13.92,58.56"},IGNF_APAT86G:{towgs84:"143.6,197.82,74.05"},IGNF_TUBU69G:{towgs84:"237.17,171.61,-77.84"},IGNF_STPM50G:{towgs84:"11.363,424.148,373.13"},EPSG_4150:{towgs84:"674.374,15.056,405.346"},EPSG_4754:{towgs84:"-208.4058,-109.8777,-2.5764"},ESRI_104101:{towgs84:"374,150,588"},EPSG_4693:{towgs84:"0,-0.15,0.68"},EPSG_6207:{towgs84:"293.17,726.18,245.36"},EPSG_4153:{towgs84:"-133.63,-157.5,-158.62"},EPSG_4132:{towgs84:"-241.54,-163.64,396.06"},EPSG_4221:{towgs84:"-154.5,150.7,100.4"},EPSG_4266:{towgs84:"-80.7,-132.5,41.1"},EPSG_4193:{towgs84:"-70.9,-151.8,-41.4"},EPSG_5340:{towgs84:"-0.41,0.46,-0.35"},EPSG_4246:{towgs84:"-294.7,-200.1,525.5"},EPSG_4318:{towgs84:"-3.2,-5.7,2.8"},EPSG_4121:{towgs84:"-199.87,74.79,246.62"},EPSG_4223:{towgs84:"-260.1,5.5,432.2"},EPSG_4158:{towgs84:"-0.465,372.095,171.736"},EPSG_4285:{towgs84:"-128.16,-282.42,21.93"},EPSG_4613:{towgs84:"-404.78,685.68,45.47"},EPSG_4607:{towgs84:"195.671,332.517,274.607"},EPSG_4475:{towgs84:"-381.788,-57.501,-256.673"},EPSG_4208:{towgs84:"-157.84,308.54,-146.6"},EPSG_4743:{towgs84:"70.995,-335.916,262.898"},EPSG_4710:{towgs84:"-323.65,551.39,-491.22"},EPSG_7881:{towgs84:"-0.077,0.079,0.086"},EPSG_4682:{towgs84:"283.729,735.942,261.143"},EPSG_4739:{towgs84:"-156,-271,-189"},EPSG_4679:{towgs84:"-80.01,253.26,291.19"},EPSG_4750:{towgs84:"-56.263,16.136,-22.856"},EPSG_4644:{towgs84:"-10.18,-350.43,291.37"},EPSG_4695:{towgs84:"-103.746,-9.614,-255.95"},EPSG_4292:{towgs84:"-355,21,72"},EPSG_4302:{towgs84:"-61.702,284.488,472.052"},EPSG_4143:{towgs84:"-124.76,53,466.79"},EPSG_4606:{towgs84:"-153,153,307"},EPSG_4699:{towgs84:"-770.1,158.4,-498.2"},EPSG_4247:{towgs84:"-273.5,110.6,-357.9"},EPSG_4160:{towgs84:"8.88,184.86,106.69"},EPSG_4161:{towgs84:"-233.43,6.65,173.64"},EPSG_9251:{towgs84:"-9.5,122.9,138.2"},EPSG_9253:{towgs84:"-78.1,101.6,133.3"},EPSG_4297:{towgs84:"-198.383,-240.517,-107.909"},EPSG_4269:{towgs84:"0,0,0"},EPSG_4301:{towgs84:"-147,506,687"},EPSG_4618:{towgs84:"-59,-11,-52"},EPSG_4612:{towgs84:"0,0,0"},EPSG_4678:{towgs84:"44.585,-131.212,-39.544"},EPSG_4250:{towgs84:"-130,29,364"},EPSG_4144:{towgs84:"214,804,268"},EPSG_4147:{towgs84:"-17.51,-108.32,-62.39"},EPSG_4259:{towgs84:"-254.1,-5.36,-100.29"},EPSG_4164:{towgs84:"-76,-138,67"},EPSG_4211:{towgs84:"-378.873,676.002,-46.255"},EPSG_4182:{towgs84:"-422.651,-172.995,84.02"},EPSG_4224:{towgs84:"-143.87,243.37,-33.52"},EPSG_4225:{towgs84:"-205.57,168.77,-4.12"},EPSG_5527:{towgs84:"-67.35,3.88,-38.22"},EPSG_4752:{towgs84:"98,390,-22"},EPSG_4310:{towgs84:"-30,190,89"},EPSG_9248:{towgs84:"-192.26,65.72,132.08"},EPSG_4680:{towgs84:"124.5,-63.5,-281"},EPSG_4701:{towgs84:"-79.9,-158,-168.9"},EPSG_4706:{towgs84:"-146.21,112.63,4.05"},EPSG_4805:{towgs84:"682,-203,480"},EPSG_4201:{towgs84:"-165,-11,206"},EPSG_4210:{towgs84:"-157,-2,-299"},EPSG_4183:{towgs84:"-104,167,-38"},EPSG_4139:{towgs84:"11,72,-101"},EPSG_4668:{towgs84:"-86,-98,-119"},EPSG_4717:{towgs84:"-2,151,181"},EPSG_4732:{towgs84:"102,52,-38"},EPSG_4280:{towgs84:"-377,681,-50"},EPSG_4209:{towgs84:"-138,-105,-289"},EPSG_4261:{towgs84:"31,146,47"},EPSG_4658:{towgs84:"-73,46,-86"},EPSG_4721:{towgs84:"265.025,384.929,-194.046"},EPSG_4222:{towgs84:"-136,-108,-292"},EPSG_4601:{towgs84:"-255,-15,71"},EPSG_4602:{towgs84:"725,685,536"},EPSG_4603:{towgs84:"72,213.7,93"},EPSG_4605:{towgs84:"9,183,236"},EPSG_4621:{towgs84:"137,248,-430"},EPSG_4657:{towgs84:"-28,199,5"},EPSG_4316:{towgs84:"103.25,-100.4,-307.19"},EPSG_4642:{towgs84:"-13,-348,292"},EPSG_4698:{towgs84:"145,-187,103"},EPSG_4192:{towgs84:"-206.1,-174.7,-87.7"},EPSG_4311:{towgs84:"-265,120,-358"},EPSG_4135:{towgs84:"58,-283,-182"},ESRI_104138:{towgs84:"198,-226,-347"},EPSG_4245:{towgs84:"-11,851,5"},EPSG_4142:{towgs84:"-125,53,467"},EPSG_4213:{towgs84:"-106,-87,188"},EPSG_4253:{towgs84:"-133,-77,-51"},EPSG_4129:{towgs84:"-132,-110,-335"},EPSG_4713:{towgs84:"-77,-128,142"},EPSG_4239:{towgs84:"217,823,299"},EPSG_4146:{towgs84:"295,736,257"},EPSG_4155:{towgs84:"-83,37,124"},EPSG_4165:{towgs84:"-173,253,27"},EPSG_4672:{towgs84:"175,-38,113"},EPSG_4236:{towgs84:"-637,-549,-203"},EPSG_4251:{towgs84:"-90,40,88"},EPSG_4271:{towgs84:"-2,374,172"},EPSG_4175:{towgs84:"-88,4,101"},EPSG_4716:{towgs84:"298,-304,-375"},EPSG_4315:{towgs84:"-23,259,-9"},EPSG_4744:{towgs84:"-242.2,-144.9,370.3"},EPSG_4244:{towgs84:"-97,787,86"},EPSG_4293:{towgs84:"616,97,-251"},EPSG_4714:{towgs84:"-127,-769,472"},EPSG_4736:{towgs84:"260,12,-147"},EPSG_6883:{towgs84:"-235,-110,393"},EPSG_6894:{towgs84:"-63,176,185"},EPSG_4205:{towgs84:"-43,-163,45"},EPSG_4256:{towgs84:"41,-220,-134"},EPSG_4262:{towgs84:"639,405,60"},EPSG_4604:{towgs84:"174,359,365"},EPSG_4169:{towgs84:"-115,118,426"},EPSG_4620:{towgs84:"-106,-129,165"},EPSG_4184:{towgs84:"-203,141,53"},EPSG_4616:{towgs84:"-289,-124,60"},EPSG_9403:{towgs84:"-307,-92,127"},EPSG_4684:{towgs84:"-133,-321,50"},EPSG_4708:{towgs84:"-491,-22,435"},EPSG_4707:{towgs84:"114,-116,-333"},EPSG_4709:{towgs84:"145,75,-272"},EPSG_4712:{towgs84:"-205,107,53"},EPSG_4711:{towgs84:"124,-234,-25"},EPSG_4718:{towgs84:"230,-199,-752"},EPSG_4719:{towgs84:"211,147,111"},EPSG_4724:{towgs84:"208,-435,-229"},EPSG_4725:{towgs84:"189,-79,-202"},EPSG_4735:{towgs84:"647,1777,-1124"},EPSG_4722:{towgs84:"-794,119,-298"},EPSG_4728:{towgs84:"-307,-92,127"},EPSG_4734:{towgs84:"-632,438,-609"},EPSG_4727:{towgs84:"912,-58,1227"},EPSG_4729:{towgs84:"185,165,42"},EPSG_4730:{towgs84:"170,42,84"},EPSG_4733:{towgs84:"276,-57,149"},ESRI_37218:{towgs84:"230,-199,-752"},ESRI_37240:{towgs84:"-7,215,225"},ESRI_37221:{towgs84:"252,-209,-751"},ESRI_4305:{towgs84:"-123,-206,219"},ESRI_104139:{towgs84:"-73,-247,227"},EPSG_4748:{towgs84:"51,391,-36"},EPSG_4219:{towgs84:"-384,664,-48"},EPSG_4255:{towgs84:"-333,-222,114"},EPSG_4257:{towgs84:"-587.8,519.75,145.76"},EPSG_4646:{towgs84:"-963,510,-359"},EPSG_6881:{towgs84:"-24,-203,268"},EPSG_6882:{towgs84:"-183,-15,273"},EPSG_4715:{towgs84:"-104,-129,239"},IGNF_RGF93GDD:{towgs84:"0,0,0"},IGNF_RGM04GDD:{towgs84:"0,0,0"},IGNF_RGSPM06GDD:{towgs84:"0,0,0"},IGNF_RGTAAF07GDD:{towgs84:"0,0,0"},IGNF_RGFG95GDD:{towgs84:"0,0,0"},IGNF_RGNCG:{towgs84:"0,0,0"},IGNF_RGPFGDD:{towgs84:"0,0,0"},IGNF_ETRS89G:{towgs84:"0,0,0"},IGNF_RGR92GDD:{towgs84:"0,0,0"},EPSG_4173:{towgs84:"0,0,0"},EPSG_4180:{towgs84:"0,0,0"},EPSG_4619:{towgs84:"0,0,0"},EPSG_4667:{towgs84:"0,0,0"},EPSG_4075:{towgs84:"0,0,0"},EPSG_6706:{towgs84:"0,0,0"},EPSG_7798:{towgs84:"0,0,0"},EPSG_4661:{towgs84:"0,0,0"},EPSG_4669:{towgs84:"0,0,0"},EPSG_8685:{towgs84:"0,0,0"},EPSG_4151:{towgs84:"0,0,0"},EPSG_9702:{towgs84:"0,0,0"},EPSG_4758:{towgs84:"0,0,0"},EPSG_4761:{towgs84:"0,0,0"},EPSG_4765:{towgs84:"0,0,0"},EPSG_8997:{towgs84:"0,0,0"},EPSG_4023:{towgs84:"0,0,0"},EPSG_4670:{towgs84:"0,0,0"},EPSG_4694:{towgs84:"0,0,0"},EPSG_4148:{towgs84:"0,0,0"},EPSG_4163:{towgs84:"0,0,0"},EPSG_4167:{towgs84:"0,0,0"},EPSG_4189:{towgs84:"0,0,0"},EPSG_4190:{towgs84:"0,0,0"},EPSG_4176:{towgs84:"0,0,0"},EPSG_4659:{towgs84:"0,0,0"},EPSG_3824:{towgs84:"0,0,0"},EPSG_3889:{towgs84:"0,0,0"},EPSG_4046:{towgs84:"0,0,0"},EPSG_4081:{towgs84:"0,0,0"},EPSG_4558:{towgs84:"0,0,0"},EPSG_4483:{towgs84:"0,0,0"},EPSG_5013:{towgs84:"0,0,0"},EPSG_5264:{towgs84:"0,0,0"},EPSG_5324:{towgs84:"0,0,0"},EPSG_5354:{towgs84:"0,0,0"},EPSG_5371:{towgs84:"0,0,0"},EPSG_5373:{towgs84:"0,0,0"},EPSG_5381:{towgs84:"0,0,0"},EPSG_5393:{towgs84:"0,0,0"},EPSG_5489:{towgs84:"0,0,0"},EPSG_5593:{towgs84:"0,0,0"},EPSG_6135:{towgs84:"0,0,0"},EPSG_6365:{towgs84:"0,0,0"},EPSG_5246:{towgs84:"0,0,0"},EPSG_7886:{towgs84:"0,0,0"},EPSG_8431:{towgs84:"0,0,0"},EPSG_8427:{towgs84:"0,0,0"},EPSG_8699:{towgs84:"0,0,0"},EPSG_8818:{towgs84:"0,0,0"},EPSG_4757:{towgs84:"0,0,0"},EPSG_9140:{towgs84:"0,0,0"},EPSG_8086:{towgs84:"0,0,0"},EPSG_4686:{towgs84:"0,0,0"},EPSG_4737:{towgs84:"0,0,0"},EPSG_4702:{towgs84:"0,0,0"},EPSG_4747:{towgs84:"0,0,0"},EPSG_4749:{towgs84:"0,0,0"},EPSG_4674:{towgs84:"0,0,0"},EPSG_4755:{towgs84:"0,0,0"},EPSG_4759:{towgs84:"0,0,0"},EPSG_4762:{towgs84:"0,0,0"},EPSG_4763:{towgs84:"0,0,0"},EPSG_4764:{towgs84:"0,0,0"},EPSG_4166:{towgs84:"0,0,0"},EPSG_4170:{towgs84:"0,0,0"},EPSG_5546:{towgs84:"0,0,0"},EPSG_7844:{towgs84:"0,0,0"},EPSG_4818:{towgs84:"589,76,480"}};for(var cde in b_){var Pb=b_[cde];Pb.datumName&&(b_[Pb.datumName]=Pb)}function ude(n,e,t,r,i,s,a){var o={};return n===void 0||n==="none"?o.datum_type=IR:o.datum_type=Ehe,e&&(o.datum_params=e.map(parseFloat),(o.datum_params[0]!==0||o.datum_params[1]!==0||o.datum_params[2]!==0)&&(o.datum_type=Sd),o.datum_params.length>3&&(o.datum_params[3]!==0||o.datum_params[4]!==0||o.datum_params[5]!==0||o.datum_params[6]!==0)&&(o.datum_type=bd,o.datum_params[3]*=np,o.datum_params[4]*=np,o.datum_params[5]*=np,o.datum_params[6]=o.datum_params[6]/1e6+1)),a&&(o.datum_type=E0,o.grids=a),o.a=t,o.b=r,o.es=i,o.ep2=s,o}var GI={};function hde(n,e,t){return e instanceof ArrayBuffer?dde(n,e,t):{ready:fde(n,e)}}function dde(n,e,t){var r=!0;t!==void 0&&t.includeErrorFields===!1&&(r=!1);var i=new DataView(e),s=pde(i),a=yde(i,s),o=xde(i,a,s,r),l={header:a,subgrids:o};return GI[n]=l,l}async function fde(n,e){for(var t=[],r=await e.getImageCount(),i=r-1;i>=0;i--){var s=await e.getImage(i),a=await s.readRasters(),o=a,l=[s.getWidth(),s.getHeight()],c=s.getBoundingBox().map(Y5),h=[s.fileDirectory.ModelPixelScale[0],s.fileDirectory.ModelPixelScale[1]].map(Y5),g=c[0]+(l[0]-1)*h[0],m=c[3]-(l[1]-1)*h[1],y=o[0],_=o[1],x=[];for(let T=l[1]-1;T>=0;T--)for(let k=l[0]-1;k>=0;k--){var w=T*l[0]+k;x.push([-xu(_[w]),xu(y[w])])}t.push({del:h,lim:l,ll:[-g,m],cvs:x})}var b={header:{nSubgrids:r},subgrids:t};return GI[n]=b,b}function gde(n){if(n===void 0)return null;var e=n.split(",");return e.map(mde)}function mde(n){if(n.length===0)return null;var e=n[0]==="@";return e&&(n=n.slice(1)),n==="null"?{name:"null",mandatory:!e,grid:null,isNull:!0}:{name:n,mandatory:!e,grid:GI[n]||null,isNull:!1}}function Y5(n){return n*Math.PI/180}function xu(n){return n/3600*Math.PI/180}function pde(n){var e=n.getInt32(8,!1);return e===11?!1:(e=n.getInt32(8,!0),e!==11&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}function yde(n,e){return{nFields:n.getInt32(8,e),nSubgridFields:n.getInt32(24,e),nSubgrids:n.getInt32(40,e),shiftType:PR(n,56,64).trim(),fromSemiMajorAxis:n.getFloat64(120,e),fromSemiMinorAxis:n.getFloat64(136,e),toSemiMajorAxis:n.getFloat64(152,e),toSemiMinorAxis:n.getFloat64(168,e)}}function PR(n,e,t){return String.fromCharCode.apply(null,new Uint8Array(n.buffer.slice(e,t)))}function xde(n,e,t,r){for(var i=176,s=[],a=0;a<e.nSubgrids;a++){var o=vde(n,i,t),l=wde(n,i,o,t,r),c=Math.round(1+(o.upperLongitude-o.lowerLongitude)/o.longitudeInterval),h=Math.round(1+(o.upperLatitude-o.lowerLatitude)/o.latitudeInterval);s.push({ll:[xu(o.lowerLongitude),xu(o.lowerLatitude)],del:[xu(o.longitudeInterval),xu(o.latitudeInterval)],lim:[c,h],count:o.gridNodeCount,cvs:_de(l)});var g=16;r===!1&&(g=8),i+=176+o.gridNodeCount*g}return s}function _de(n){return n.map(function(e){return[xu(e.longitudeShift),xu(e.latitudeShift)]})}function vde(n,e,t){return{name:PR(n,e+8,e+16).trim(),parent:PR(n,e+24,e+24+8).trim(),lowerLatitude:n.getFloat64(e+72,t),upperLatitude:n.getFloat64(e+88,t),lowerLongitude:n.getFloat64(e+104,t),upperLongitude:n.getFloat64(e+120,t),latitudeInterval:n.getFloat64(e+136,t),longitudeInterval:n.getFloat64(e+152,t),gridNodeCount:n.getInt32(e+168,t)}}function wde(n,e,t,r,i){var s=e+176,a=16;i===!1&&(a=8);for(var o=[],l=0;l<t.gridNodeCount;l++){var c={latitudeShift:n.getFloat32(s+l*a,r),longitudeShift:n.getFloat32(s+l*a+4,r)};i!==!1&&(c.latitudeAccuracy=n.getFloat32(s+l*a+8,r),c.longitudeAccuracy=n.getFloat32(s+l*a+12,r)),o.push(c)}return o}function Ba(n,e){if(!(this instanceof Ba))return new Ba(n);this.forward=null,this.inverse=null,this.init=null,this.name,this.names=null,this.title,e=e||function(c){if(c)throw c};var t=Xhe(n);if(typeof t!="object"){e("Could not parse to valid json: "+n);return}var r=Ba.projections.get(t.projName);if(!r){e("Could not get projection name from: "+n);return}if(t.datumCode&&t.datumCode!=="none"){var i=Gu(b_,t.datumCode);i&&(t.datum_params=t.datum_params||(i.towgs84?i.towgs84.split(","):null),t.ellps=i.ellipse,t.datumName=i.datumName?i.datumName:t.datumCode)}t.k0=t.k0||1,t.axis=t.axis||"enu",t.ellps=t.ellps||"wgs84",t.lat1=t.lat1||t.lat0;var s=lde(t.a,t.b,t.rf,t.ellps,t.sphere),a=ode(s.a,s.b,s.rf,t.R_A),o=gde(t.nadgrids),l=t.datum||ude(t.datumCode,t.datum_params,s.a,s.b,a.es,a.ep2,o);X5(this,t),X5(this,r),this.a=s.a,this.b=s.b,this.rf=s.rf,this.sphere=s.sphere,this.es=a.es,this.e=a.e,this.ep2=a.ep2,this.datum=l,"init"in this&&typeof this.init=="function"&&this.init(),e(null,this)}Ba.projections=sde;Ba.projections.start();function Ede(n,e){return n.datum_type!==e.datum_type||n.a!==e.a||Math.abs(n.es-e.es)>5e-11?!1:n.datum_type===Sd?n.datum_params[0]===e.datum_params[0]&&n.datum_params[1]===e.datum_params[1]&&n.datum_params[2]===e.datum_params[2]:n.datum_type===bd?n.datum_params[0]===e.datum_params[0]&&n.datum_params[1]===e.datum_params[1]&&n.datum_params[2]===e.datum_params[2]&&n.datum_params[3]===e.datum_params[3]&&n.datum_params[4]===e.datum_params[4]&&n.datum_params[5]===e.datum_params[5]&&n.datum_params[6]===e.datum_params[6]:!0}function LV(n,e,t){var r=n.x,i=n.y,s=n.z?n.z:0,a,o,l,c;if(i<-Xe&&i>-1.001*Xe)i=-Xe;else if(i>Xe&&i<1.001*Xe)i=Xe;else{if(i<-Xe)return{x:-1/0,y:-1/0,z:n.z};if(i>Xe)return{x:1/0,y:1/0,z:n.z}}return r>Math.PI&&(r-=2*Math.PI),o=Math.sin(i),c=Math.cos(i),l=o*o,a=t/Math.sqrt(1-e*l),{x:(a+s)*c*Math.cos(r),y:(a+s)*c*Math.sin(r),z:(a*(1-e)+s)*o}}function OV(n,e,t,r){var i=1e-12,s=i*i,a=30,o,l,c,h,g,m,y,_,x,w,b,T,k,L=n.x,O=n.y,B=n.z?n.z:0,R,A,P;if(o=Math.sqrt(L*L+O*O),l=Math.sqrt(L*L+O*O+B*B),o/t<i){if(R=0,l/t<i)return A=Xe,P=-r,{x:n.x,y:n.y,z:n.z}}else R=Math.atan2(O,L);c=B/l,h=o/l,g=1/Math.sqrt(1-e*(2-e)*h*h),_=h*(1-e)*g,x=c*g,k=0;do k++,y=t/Math.sqrt(1-e*x*x),P=o*_+B*x-y*(1-e*x*x),m=e*y/(y+P),g=1/Math.sqrt(1-m*(2-m)*h*h),w=h*(1-m)*g,b=c*g,T=b*_-w*x,_=w,x=b;while(T*T>s&&k<a);return A=Math.atan(b/Math.abs(w)),{x:R,y:A,z:P}}function Sde(n,e,t){if(e===Sd)return{x:n.x+t[0],y:n.y+t[1],z:n.z+t[2]};if(e===bd){var r=t[0],i=t[1],s=t[2],a=t[3],o=t[4],l=t[5],c=t[6];return{x:c*(n.x-l*n.y+o*n.z)+r,y:c*(l*n.x+n.y-a*n.z)+i,z:c*(-o*n.x+a*n.y+n.z)+s}}}function bde(n,e,t){if(e===Sd)return{x:n.x-t[0],y:n.y-t[1],z:n.z-t[2]};if(e===bd){var r=t[0],i=t[1],s=t[2],a=t[3],o=t[4],l=t[5],c=t[6],h=(n.x-r)/c,g=(n.y-i)/c,m=(n.z-s)/c;return{x:h+l*g-o*m,y:-l*h+g+a*m,z:o*h-a*g+m}}}function Bx(n){return n===Sd||n===bd}function Tde(n,e,t){if(Ede(n,e)||n.datum_type===IR||e.datum_type===IR)return t;var r=n.a,i=n.es;if(n.datum_type===E0){var s=Z5(n,!1,t);if(s!==0)return;r=z5,i=U5}var a=e.a,o=e.b,l=e.es;if(e.datum_type===E0&&(a=z5,o=She,l=U5),i===l&&r===a&&!Bx(n.datum_type)&&!Bx(e.datum_type))return t;if(t=LV(t,i,r),Bx(n.datum_type)&&(t=Sde(t,n.datum_type,n.datum_params)),Bx(e.datum_type)&&(t=bde(t,e.datum_type,e.datum_params)),t=OV(t,l,a,o),e.datum_type===E0){var c=Z5(e,!0,t);if(c!==0)return}return t}function Z5(n,e,t){if(n.grids===null||n.grids.length===0)return console.log("Grid shift grids not found"),-1;var r={x:-t.x,y:t.y},i={x:Number.NaN,y:Number.NaN},s=[];e:for(var a=0;a<n.grids.length;a++){var o=n.grids[a];if(s.push(o.name),o.isNull){i=r;break}if(o.grid===null){if(o.mandatory)return console.log("Unable to find mandatory grid '"+o.name+"'"),-1;continue}for(var l=o.grid.subgrids,c=0,h=l.length;c<h;c++){var g=l[c],m=(Math.abs(g.del[1])+Math.abs(g.del[0]))/1e4,y=g.ll[0]-m,_=g.ll[1]-m,x=g.ll[0]+(g.lim[0]-1)*g.del[0]+m,w=g.ll[1]+(g.lim[1]-1)*g.del[1]+m;if(!(_>r.y||y>r.x||w<r.y||x<r.x)&&(i=Rde(r,e,g),!isNaN(i.x)))break e}}return isNaN(i.x)?(console.log("Failed to find a grid shift table for location '"+-r.x*Bs+" "+r.y*Bs+" tried: '"+s+"'"),-1):(t.x=-i.x,t.y=i.y,0)}function Rde(n,e,t){var r={x:Number.NaN,y:Number.NaN};if(isNaN(n.x))return r;var i={x:n.x,y:n.y};i.x-=t.ll[0],i.y-=t.ll[1],i.x=mt(i.x-Math.PI)+Math.PI;var s=J5(i,t);if(e){if(isNaN(s.x))return r;s.x=i.x-s.x,s.y=i.y-s.y;var a=9,o=1e-12,l,c;do{if(c=J5(s,t),isNaN(c.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}l={x:i.x-(c.x+s.x),y:i.y-(c.y+s.y)},s.x+=l.x,s.y+=l.y}while(a--&&Math.abs(l.x)>o&&Math.abs(l.y)>o);if(a<0)return console.log("Inverse grid shift iterator failed to converge."),r;r.x=mt(s.x+t.ll[0]),r.y=s.y+t.ll[1]}else isNaN(s.x)||(r.x=n.x+s.x,r.y=n.y+s.y);return r}function J5(n,e){var t={x:n.x/e.del[0],y:n.y/e.del[1]},r={x:Math.floor(t.x),y:Math.floor(t.y)},i={x:t.x-1*r.x,y:t.y-1*r.y},s={x:Number.NaN,y:Number.NaN},a;if(r.x<0||r.x>=e.lim[0]||r.y<0||r.y>=e.lim[1])return s;a=r.y*e.lim[0]+r.x;var o={x:e.cvs[a][0],y:e.cvs[a][1]};a++;var l={x:e.cvs[a][0],y:e.cvs[a][1]};a+=e.lim[0];var c={x:e.cvs[a][0],y:e.cvs[a][1]};a--;var h={x:e.cvs[a][0],y:e.cvs[a][1]},g=i.x*i.y,m=i.x*(1-i.y),y=(1-i.x)*(1-i.y),_=(1-i.x)*i.y;return s.x=y*o.x+m*l.x+_*h.x+g*c.x,s.y=y*o.y+m*l.y+_*h.y+g*c.y,s}function Q5(n,e,t){var r=t.x,i=t.y,s=t.z||0,a,o,l,c={};for(l=0;l<3;l++)if(!(e&&l===2&&t.z===void 0))switch(l===0?(a=r,"ew".indexOf(n.axis[l])!==-1?o="x":o="y"):l===1?(a=i,"ns".indexOf(n.axis[l])!==-1?o="y":o="x"):(a=s,o="z"),n.axis[l]){case"e":c[o]=a;break;case"w":c[o]=-a;break;case"n":c[o]=a;break;case"s":c[o]=-a;break;case"u":t[o]!==void 0&&(c.z=a);break;case"d":t[o]!==void 0&&(c.z=-a);break;default:return null}return c}function DV(n){var e={x:n[0],y:n[1]};return n.length>2&&(e.z=n[2]),n.length>3&&(e.m=n[3]),e}function Ade(n){eO(n.x),eO(n.y)}function eO(n){if(typeof Number.isFinite=="function"){if(Number.isFinite(n))return;throw new TypeError("coordinates must be finite numbers")}if(typeof n!="number"||n!==n||!isFinite(n))throw new TypeError("coordinates must be finite numbers")}function kde(n,e){return(n.datum.datum_type===Sd||n.datum.datum_type===bd||n.datum.datum_type===E0)&&e.datumCode!=="WGS84"||(e.datum.datum_type===Sd||e.datum.datum_type===bd||e.datum.datum_type===E0)&&n.datumCode!=="WGS84"}function Hv(n,e,t,r){var i;Array.isArray(t)?t=DV(t):t={x:t.x,y:t.y,z:t.z,m:t.m};var s=t.z!==void 0;if(Ade(t),n.datum&&e.datum&&kde(n,e)&&(i=new Ba("WGS84"),t=Hv(n,i,t,r),n=i),r&&n.axis!=="enu"&&(t=Q5(n,!1,t)),n.projName==="longlat")t={x:t.x*Dr,y:t.y*Dr,z:t.z||0};else if(n.to_meter&&(t={x:t.x*n.to_meter,y:t.y*n.to_meter,z:t.z||0}),t=n.inverse(t),!t)return;if(n.from_greenwich&&(t.x+=n.from_greenwich),t=Tde(n.datum,e.datum,t),!!t)return t=t,e.from_greenwich&&(t={x:t.x-e.from_greenwich,y:t.y,z:t.z||0}),e.projName==="longlat"?t={x:t.x*Bs,y:t.y*Bs,z:t.z||0}:(t=e.forward(t),e.to_meter&&(t={x:t.x/e.to_meter,y:t.y/e.to_meter,z:t.z||0})),r&&e.axis!=="enu"?Q5(e,!0,t):(t&&!s&&delete t.z,t)}var tO=Ba("WGS84");function Nb(n,e,t,r){var i,s,a;return Array.isArray(t)?(i=Hv(n,e,t,r)||{x:NaN,y:NaN},t.length>2?typeof n.name<"u"&&n.name==="geocent"||typeof e.name<"u"&&e.name==="geocent"?typeof i.z=="number"?[i.x,i.y,i.z].concat(t.slice(3)):[i.x,i.y,t[2]].concat(t.slice(3)):[i.x,i.y].concat(t.slice(2)):[i.x,i.y]):(s=Hv(n,e,t,r),a=Object.keys(t),a.length===2||a.forEach(function(o){if(typeof n.name<"u"&&n.name==="geocent"||typeof e.name<"u"&&e.name==="geocent"){if(o==="x"||o==="y"||o==="z")return}else if(o==="x"||o==="y")return;s[o]=t[o]}),s)}function Gx(n){return n instanceof Ba?n:typeof n=="object"&&"oProj"in n?n.oProj:Ba(n)}function Ide(n,e,t){var r,i,s=!1,a;return typeof e>"u"?(i=Gx(n),r=tO,s=!0):(typeof e.x<"u"||Array.isArray(e))&&(t=e,i=Gx(n),r=tO,s=!0),r||(r=Gx(n)),i||(i=Gx(e)),t?Nb(r,i,t):(a={forward:function(o,l){return Nb(r,i,o,l)},inverse:function(o,l){return Nb(i,r,o,l)}},s&&(a.oProj=i),a)}var nO=6,jV="AJSAJS",FV="AFAFAF",c0=65,Ns=73,Ca=79,Lm=86,Om=90;const Cde={forward:VV,inverse:Pde,toPoint:BV};function VV(n,e){return e=e||5,Lde(Nde({lat:n[1],lon:n[0]}),e)}function Pde(n){var e=zI(zV(n.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat,e.lon,e.lat]:[e.left,e.bottom,e.right,e.top]}function BV(n){var e=zI(zV(n.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat]:[(e.left+e.right)/2,(e.top+e.bottom)/2]}function Mb(n){return n*(Math.PI/180)}function rO(n){return 180*(n/Math.PI)}function Nde(n){var e=n.lat,t=n.lon,r=6378137,i=.00669438,s=.9996,a,o,l,c,h,g,m,y=Mb(e),_=Mb(t),x,w;w=Math.floor((t+180)/6)+1,t===180&&(w=60),e>=56&&e<64&&t>=3&&t<12&&(w=32),e>=72&&e<84&&(t>=0&&t<9?w=31:t>=9&&t<21?w=33:t>=21&&t<33?w=35:t>=33&&t<42&&(w=37)),a=(w-1)*6-180+3,x=Mb(a),o=i/(1-i),l=r/Math.sqrt(1-i*Math.sin(y)*Math.sin(y)),c=Math.tan(y)*Math.tan(y),h=o*Math.cos(y)*Math.cos(y),g=Math.cos(y)*(_-x),m=r*((1-i/4-3*i*i/64-5*i*i*i/256)*y-(3*i/8+3*i*i/32+45*i*i*i/1024)*Math.sin(2*y)+(15*i*i/256+45*i*i*i/1024)*Math.sin(4*y)-35*i*i*i/3072*Math.sin(6*y));var b=s*l*(g+(1-c+h)*g*g*g/6+(5-18*c+c*c+72*h-58*o)*g*g*g*g*g/120)+5e5,T=s*(m+l*Math.tan(y)*(g*g/2+(5-c+9*h+4*h*h)*g*g*g*g/24+(61-58*c+c*c+600*h-330*o)*g*g*g*g*g*g/720));return e<0&&(T+=1e7),{northing:Math.round(T),easting:Math.round(b),zoneNumber:w,zoneLetter:Mde(e)}}function zI(n){var e=n.northing,t=n.easting,r=n.zoneLetter,i=n.zoneNumber;if(i<0||i>60)return null;var s=.9996,a=6378137,o=.00669438,l,c=(1-Math.sqrt(1-o))/(1+Math.sqrt(1-o)),h,g,m,y,_,x,w,b,T,k=t-5e5,L=e;r<"N"&&(L-=1e7),w=(i-1)*6-180+3,l=o/(1-o),x=L/s,b=x/(a*(1-o/4-3*o*o/64-5*o*o*o/256)),T=b+(3*c/2-27*c*c*c/32)*Math.sin(2*b)+(21*c*c/16-55*c*c*c*c/32)*Math.sin(4*b)+151*c*c*c/96*Math.sin(6*b),h=a/Math.sqrt(1-o*Math.sin(T)*Math.sin(T)),g=Math.tan(T)*Math.tan(T),m=l*Math.cos(T)*Math.cos(T),y=a*(1-o)/Math.pow(1-o*Math.sin(T)*Math.sin(T),1.5),_=k/(h*s);var O=T-h*Math.tan(T)/y*(_*_/2-(5+3*g+10*m-4*m*m-9*l)*_*_*_*_/24+(61+90*g+298*m+45*g*g-252*l-3*m*m)*_*_*_*_*_*_/720);O=rO(O);var B=(_-(1+2*g+m)*_*_*_/6+(5-2*m+28*g-3*m*m+8*l+24*g*g)*_*_*_*_*_/120)/Math.cos(T);B=w+rO(B);var R;if(n.accuracy){var A=zI({northing:n.northing+n.accuracy,easting:n.easting+n.accuracy,zoneLetter:n.zoneLetter,zoneNumber:n.zoneNumber});R={top:A.lat,right:A.lon,bottom:O,left:B}}else R={lat:O,lon:B};return R}function Mde(n){var e="Z";return 84>=n&&n>=72?e="X":72>n&&n>=64?e="W":64>n&&n>=56?e="V":56>n&&n>=48?e="U":48>n&&n>=40?e="T":40>n&&n>=32?e="S":32>n&&n>=24?e="R":24>n&&n>=16?e="Q":16>n&&n>=8?e="P":8>n&&n>=0?e="N":0>n&&n>=-8?e="M":-8>n&&n>=-16?e="L":-16>n&&n>=-24?e="K":-24>n&&n>=-32?e="J":-32>n&&n>=-40?e="H":-40>n&&n>=-48?e="G":-48>n&&n>=-56?e="F":-56>n&&n>=-64?e="E":-64>n&&n>=-72?e="D":-72>n&&n>=-80&&(e="C"),e}function Lde(n,e){var t="00000"+n.easting,r="00000"+n.northing;return n.zoneNumber+n.zoneLetter+Ode(n.easting,n.northing,n.zoneNumber)+t.substr(t.length-5,e)+r.substr(r.length-5,e)}function Ode(n,e,t){var r=GV(t),i=Math.floor(n/1e5),s=Math.floor(e/1e5)%20;return Dde(i,s,r)}function GV(n){var e=n%nO;return e===0&&(e=nO),e}function Dde(n,e,t){var r=t-1,i=jV.charCodeAt(r),s=FV.charCodeAt(r),a=i+n-1,o=s+e,l=!1;a>Om&&(a=a-Om+c0-1,l=!0),(a===Ns||i<Ns&&a>Ns||(a>Ns||i<Ns)&&l)&&a++,(a===Ca||i<Ca&&a>Ca||(a>Ca||i<Ca)&&l)&&(a++,a===Ns&&a++),a>Om&&(a=a-Om+c0-1),o>Lm?(o=o-Lm+c0-1,l=!0):l=!1,(o===Ns||s<Ns&&o>Ns||(o>Ns||s<Ns)&&l)&&o++,(o===Ca||s<Ca&&o>Ca||(o>Ca||s<Ca)&&l)&&(o++,o===Ns&&o++),o>Lm&&(o=o-Lm+c0-1);var c=String.fromCharCode(a)+String.fromCharCode(o);return c}function zV(n){if(n&&n.length===0)throw"MGRSPoint coverting from nothing";for(var e=n.length,t=null,r="",i,s=0;!/[A-Z]/.test(i=n.charAt(s));){if(s>=2)throw"MGRSPoint bad conversion from: "+n;r+=i,s++}var a=parseInt(r,10);if(s===0||s+3>e)throw"MGRSPoint bad conversion from: "+n;var o=n.charAt(s++);if(o<="A"||o==="B"||o==="Y"||o>="Z"||o==="I"||o==="O")throw"MGRSPoint zone letter "+o+" not handled: "+n;t=n.substring(s,s+=2);for(var l=GV(a),c=jde(t.charAt(0),l),h=Fde(t.charAt(1),l);h<Vde(o);)h+=2e6;var g=e-s;if(g%2!==0)throw`MGRSPoint has to have an even number 
of digits after the zone letter and two 100km letters - front 
half for easting meters, second half for 
northing meters`+n;var m=g/2,y=0,_=0,x,w,b,T,k;return m>0&&(x=1e5/Math.pow(10,m),w=n.substring(s,s+m),y=parseFloat(w)*x,b=n.substring(s+m),_=parseFloat(b)*x),T=y+c,k=_+h,{easting:T,northing:k,zoneLetter:o,zoneNumber:a,accuracy:x}}function jde(n,e){for(var t=jV.charCodeAt(e-1),r=1e5,i=!1;t!==n.charCodeAt(0);){if(t++,t===Ns&&t++,t===Ca&&t++,t>Om){if(i)throw"Bad character: "+n;t=c0,i=!0}r+=1e5}return r}function Fde(n,e){if(n>"V")throw"MGRSPoint given invalid Northing "+n;for(var t=FV.charCodeAt(e-1),r=0,i=!1;t!==n.charCodeAt(0);){if(t++,t===Ns&&t++,t===Ca&&t++,t>Lm){if(i)throw"Bad character: "+n;t=c0,i=!0}r+=1e5}return r}function Vde(n){var e;switch(n){case"C":e=11e5;break;case"D":e=2e6;break;case"E":e=28e5;break;case"F":e=37e5;break;case"G":e=46e5;break;case"H":e=55e5;break;case"J":e=64e5;break;case"K":e=73e5;break;case"L":e=82e5;break;case"M":e=91e5;break;case"N":e=0;break;case"P":e=8e5;break;case"Q":e=17e5;break;case"R":e=26e5;break;case"S":e=35e5;break;case"T":e=44e5;break;case"U":e=53e5;break;case"V":e=62e5;break;case"W":e=7e6;break;case"X":e=79e5;break;default:e=-1}if(e>=0)return e;throw"Invalid zone letter: "+n}function tg(n,e,t){if(!(this instanceof tg))return new tg(n,e,t);if(Array.isArray(n))this.x=n[0],this.y=n[1],this.z=n[2]||0;else if(typeof n=="object")this.x=n.x,this.y=n.y,this.z=n.z||0;else if(typeof n=="string"&&typeof e>"u"){var r=n.split(",");this.x=parseFloat(r[0]),this.y=parseFloat(r[1]),this.z=parseFloat(r[2])||0}else this.x=n,this.y=e,this.z=t||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}tg.fromMGRS=function(n){return new tg(BV(n))};tg.prototype.toMGRS=function(n){return VV([this.x,this.y],n)};var Bde=1,Gde=.25,iO=.046875,sO=.01953125,aO=.01068115234375,zde=.75,Ude=.46875,$de=.013020833333333334,Wde=.007120768229166667,Hde=.3645833333333333,Kde=.005696614583333333,Xde=.3076171875;function UI(n){var e=[];e[0]=Bde-n*(Gde+n*(iO+n*(sO+n*aO))),e[1]=n*(zde-n*(iO+n*(sO+n*aO)));var t=n*n;return e[2]=t*(Ude-n*($de+n*Wde)),t*=n,e[3]=t*(Hde-n*Kde),e[4]=t*n*Xde,e}function xg(n,e,t,r){return t*=e,e*=e,r[0]*n-t*(r[1]+e*(r[2]+e*(r[3]+e*r[4])))}var qde=20;function $I(n,e,t){for(var r=1/(1-e),i=n,s=qde;s;--s){var a=Math.sin(i),o=1-e*a*a;if(o=(xg(i,a,Math.cos(i),t)-n)*(o*Math.sqrt(o))*r,i-=o,Math.abs(o)<ct)return i}return i}function Yde(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.es&&(this.en=UI(this.es),this.ml0=xg(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))}function Zde(n){var e=n.x,t=n.y,r=mt(e-this.long0,this.over),i,s,a,o=Math.sin(t),l=Math.cos(t);if(this.es){var h=l*r,g=Math.pow(h,2),m=this.ep2*Math.pow(l,2),y=Math.pow(m,2),_=Math.abs(l)>ct?Math.tan(t):0,x=Math.pow(_,2),w=Math.pow(x,2);i=1-this.es*Math.pow(o,2),h=h/Math.sqrt(i);var b=xg(t,o,l,this.en);s=this.a*(this.k0*h*(1+g/6*(1-x+m+g/20*(5-18*x+w+14*m-58*x*m+g/42*(61+179*w-w*x-479*x)))))+this.x0,a=this.a*(this.k0*(b-this.ml0+o*r*h/2*(1+g/12*(5-x+9*m+4*y+g/30*(61+w-58*x+270*m-330*x*m+g/56*(1385+543*w-w*x-3111*x))))))+this.y0}else{var c=l*Math.sin(r);if(Math.abs(Math.abs(c)-1)<ct)return 93;if(s=.5*this.a*this.k0*Math.log((1+c)/(1-c))+this.x0,a=l*Math.cos(r)/Math.sqrt(1-Math.pow(c,2)),c=Math.abs(a),c>=1){if(c-1>ct)return 93;a=0}else a=Math.acos(a);t<0&&(a=-a),a=this.a*this.k0*(a-this.lat0)+this.y0}return n.x=s,n.y=a,n}function Jde(n){var e,t,r,i,s=(n.x-this.x0)*(1/this.a),a=(n.y-this.y0)*(1/this.a);if(this.es)if(e=this.ml0+a/this.k0,t=$I(e,this.es,this.en),Math.abs(t)<Xe){var g=Math.sin(t),m=Math.cos(t),y=Math.abs(m)>ct?Math.tan(t):0,_=this.ep2*Math.pow(m,2),x=Math.pow(_,2),w=Math.pow(y,2),b=Math.pow(w,2);e=1-this.es*Math.pow(g,2);var T=s*Math.sqrt(e)/this.k0,k=Math.pow(T,2);e=e*y,r=t-e*k/(1-this.es)*.5*(1-k/12*(5+3*w-9*_*w+_-4*x-k/30*(61+90*w-252*_*w+45*b+46*_-k/56*(1385+3633*w+4095*b+1574*b*w)))),i=mt(this.long0+T*(1-k/6*(1+2*w+_-k/20*(5+28*w+24*b+8*_*w+6*_-k/42*(61+662*w+1320*b+720*b*w))))/m,this.over)}else r=Xe*J1(a),i=0;else{var o=Math.exp(s/this.k0),l=.5*(o-1/o),c=this.lat0+a/this.k0,h=Math.cos(c);e=Math.sqrt((1-Math.pow(h,2))/(1+Math.pow(l,2))),r=Math.asin(e),a<0&&(r=-r),l===0&&h===0?i=0:i=mt(Math.atan2(l,h)+this.long0,this.over)}return n.x=i,n.y=r,n}var Qde=["Fast_Transverse_Mercator","Fast Transverse Mercator"];const T_={init:Yde,forward:Zde,inverse:Jde,names:Qde};function UV(n){var e=Math.exp(n);return e=(e-1/e)/2,e}function Fs(n,e){n=Math.abs(n),e=Math.abs(e);var t=Math.max(n,e),r=Math.min(n,e)/(t||1);return t*Math.sqrt(1+Math.pow(r,2))}function efe(n){var e=1+n,t=e-1;return t===0?n:n*Math.log(e)/t}function tfe(n){var e=Math.abs(n);return e=efe(e*(1+e/(Fs(1,e)+1))),n<0?-e:e}function WI(n,e){for(var t=2*Math.cos(2*e),r=n.length-1,i=n[r],s=0,a;--r>=0;)a=-s+t*i+n[r],s=i,i=a;return e+a*Math.sin(2*e)}function nfe(n,e){for(var t=2*Math.cos(e),r=n.length-1,i=n[r],s=0,a;--r>=0;)a=-s+t*i+n[r],s=i,i=a;return Math.sin(e)*a}function rfe(n){var e=Math.exp(n);return e=(e+1/e)/2,e}function $V(n,e,t){for(var r=Math.sin(e),i=Math.cos(e),s=UV(t),a=rfe(t),o=2*i*a,l=-2*r*s,c=n.length-1,h=n[c],g=0,m=0,y=0,_,x;--c>=0;)_=m,x=g,m=h,g=y,h=-_+o*m-l*g+n[c],y=-x+l*m+o*g;return o=r*a,l=i*s,[o*h-l*y,o*y+l*h]}function ife(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(T_.init.apply(this),this.forward=T_.forward,this.inverse=T_.inverse),this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var n=this.es/(1+Math.sqrt(1-this.es)),e=n/(2-n),t=e;this.cgb[0]=e*(2+e*(-2/3+e*(-2+e*(116/45+e*(26/45+e*(-2854/675)))))),this.cbg[0]=e*(-2+e*(2/3+e*(4/3+e*(-82/45+e*(32/45+e*(4642/4725)))))),t=t*e,this.cgb[1]=t*(7/3+e*(-8/5+e*(-227/45+e*(2704/315+e*(2323/945))))),this.cbg[1]=t*(5/3+e*(-16/15+e*(-13/9+e*(904/315+e*(-1522/945))))),t=t*e,this.cgb[2]=t*(56/15+e*(-136/35+e*(-1262/105+e*(73814/2835)))),this.cbg[2]=t*(-26/15+e*(34/21+e*(8/5+e*(-12686/2835)))),t=t*e,this.cgb[3]=t*(4279/630+e*(-332/35+e*(-399572/14175))),this.cbg[3]=t*(1237/630+e*(-12/5+e*(-24832/14175))),t=t*e,this.cgb[4]=t*(4174/315+e*(-144838/6237)),this.cbg[4]=t*(-734/315+e*(109598/31185)),t=t*e,this.cgb[5]=t*(601676/22275),this.cbg[5]=t*(444337/155925),t=Math.pow(e,2),this.Qn=this.k0/(1+e)*(1+t*(1/4+t*(1/64+t/256))),this.utg[0]=e*(-.5+e*(2/3+e*(-37/96+e*(1/360+e*(81/512+e*(-96199/604800)))))),this.gtu[0]=e*(.5+e*(-2/3+e*(5/16+e*(41/180+e*(-127/288+e*(7891/37800)))))),this.utg[1]=t*(-1/48+e*(-1/15+e*(437/1440+e*(-46/105+e*(1118711/3870720))))),this.gtu[1]=t*(13/48+e*(-3/5+e*(557/1440+e*(281/630+e*(-1983433/1935360))))),t=t*e,this.utg[2]=t*(-17/480+e*(37/840+e*(209/4480+e*(-5569/90720)))),this.gtu[2]=t*(61/240+e*(-103/140+e*(15061/26880+e*(167603/181440)))),t=t*e,this.utg[3]=t*(-4397/161280+e*(11/504+e*(830251/7257600))),this.gtu[3]=t*(49561/161280+e*(-179/168+e*(6601661/7257600))),t=t*e,this.utg[4]=t*(-4583/161280+e*(108847/3991680)),this.gtu[4]=t*(34729/80640+e*(-3418889/1995840)),t=t*e,this.utg[5]=t*(-20648693/638668800),this.gtu[5]=t*(212378941/319334400);var r=WI(this.cbg,this.lat0);this.Zb=-this.Qn*(r+nfe(this.gtu,2*r))}function sfe(n){var e=mt(n.x-this.long0,this.over),t=n.y;t=WI(this.cbg,t);var r=Math.sin(t),i=Math.cos(t),s=Math.sin(e),a=Math.cos(e);t=Math.atan2(r,a*i),e=Math.atan2(s*i,Fs(r,i*a)),e=tfe(Math.tan(e));var o=$V(this.gtu,2*t,2*e);t=t+o[0],e=e+o[1];var l,c;return Math.abs(e)<=2.623395162778?(l=this.a*(this.Qn*e)+this.x0,c=this.a*(this.Qn*t+this.Zb)+this.y0):(l=1/0,c=1/0),n.x=l,n.y=c,n}function afe(n){var e=(n.x-this.x0)*(1/this.a),t=(n.y-this.y0)*(1/this.a);t=(t-this.Zb)/this.Qn,e=e/this.Qn;var r,i;if(Math.abs(e)<=2.623395162778){var s=$V(this.utg,2*t,2*e);t=t+s[0],e=e+s[1],e=Math.atan(UV(e));var a=Math.sin(t),o=Math.cos(t),l=Math.sin(e),c=Math.cos(e);t=Math.atan2(a*c,Fs(l,c*o)),e=Math.atan2(l,c*o),r=mt(e+this.long0,this.over),i=WI(this.cgb,t)}else r=1/0,i=1/0;return n.x=r,n.y=i,n}var ofe=["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","Gauss Kruger","Gauss_Kruger","tmerc"];const R_={init:ife,forward:sfe,inverse:afe,names:ofe};function lfe(n,e){if(n===void 0){if(n=Math.floor((mt(e)+Math.PI)*30/Math.PI)+1,n<0)return 0;if(n>60)return 60}return n}var cfe="etmerc";function ufe(){var n=lfe(this.zone,this.long0);if(n===void 0)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(n)-183)*Dr,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,R_.init.apply(this),this.forward=R_.forward,this.inverse=R_.inverse}var hfe=["Universal Transverse Mercator System","utm"];const dfe={init:ufe,names:hfe,dependsOn:cfe};function HI(n,e){return Math.pow((1-n)/(1+n),e)}var ffe=20;function gfe(){var n=Math.sin(this.lat0),e=Math.cos(this.lat0);e*=e,this.rc=Math.sqrt(1-this.es)/(1-this.es*n*n),this.C=Math.sqrt(1+this.es*e*e/(1-this.es)),this.phic0=Math.asin(n/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+$n)/(Math.pow(Math.tan(.5*this.lat0+$n),this.C)*HI(this.e*n,this.ratexp))}function mfe(n){var e=n.x,t=n.y;return n.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*t+$n),this.C)*HI(this.e*Math.sin(t),this.ratexp))-Xe,n.x=this.C*e,n}function pfe(n){for(var e=1e-14,t=n.x/this.C,r=n.y,i=Math.pow(Math.tan(.5*r+$n)/this.K,1/this.C),s=ffe;s>0&&(r=2*Math.atan(i*HI(this.e*Math.sin(n.y),-.5*this.e))-Xe,!(Math.abs(r-n.y)<e));--s)n.y=r;return s?(n.x=t,n.y=r,n):null}const KI={init:gfe,forward:mfe,inverse:pfe};function yfe(){KI.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))}function xfe(n){var e,t,r,i;return n.x=mt(n.x-this.long0,this.over),KI.forward.apply(this,[n]),e=Math.sin(n.y),t=Math.cos(n.y),r=Math.cos(n.x),i=this.k0*this.R2/(1+this.sinc0*e+this.cosc0*t*r),n.x=i*t*Math.sin(n.x),n.y=i*(this.cosc0*e-this.sinc0*t*r),n.x=this.a*n.x+this.x0,n.y=this.a*n.y+this.y0,n}function _fe(n){var e,t,r,i,s;if(n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a,n.x/=this.k0,n.y/=this.k0,s=Fs(n.x,n.y)){var a=2*Math.atan2(s,this.R2);e=Math.sin(a),t=Math.cos(a),i=Math.asin(t*this.sinc0+n.y*e*this.cosc0/s),r=Math.atan2(n.x*e,s*this.cosc0*t-n.y*this.sinc0*e)}else i=this.phic0,r=0;return n.x=r,n.y=i,KI.inverse.apply(this,[n]),n.x=mt(n.x+this.long0,this.over),n}var vfe=["Stereographic_North_Pole","Oblique_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"];const wfe={init:yfe,forward:xfe,inverse:_fe,names:vfe};function XI(n,e,t){return e*=t,Math.tan(.5*(Xe+n))*Math.pow((1-e)/(1+e),.5*t)}function Efe(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=ct&&(this.k0=.5*(1+J1(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=ct&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=ct&&Math.abs(Math.cos(this.lat_ts))>ct&&(this.k0=.5*this.cons*gl(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/_o(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=gl(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(XI(this.lat0,this.sinlat0,this.e))-Xe,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))}function Sfe(n){var e=n.x,t=n.y,r=Math.sin(t),i=Math.cos(t),s,a,o,l,c,h,g=mt(e-this.long0,this.over);return Math.abs(Math.abs(e-this.long0)-Math.PI)<=ct&&Math.abs(t+this.lat0)<=ct?(n.x=NaN,n.y=NaN,n):this.sphere?(s=2*this.k0/(1+this.sinlat0*r+this.coslat0*i*Math.cos(g)),n.x=this.a*s*i*Math.sin(g)+this.x0,n.y=this.a*s*(this.coslat0*r-this.sinlat0*i*Math.cos(g))+this.y0,n):(a=2*Math.atan(XI(t,r,this.e))-Xe,l=Math.cos(a),o=Math.sin(a),Math.abs(this.coslat0)<=ct?(c=_o(this.e,t*this.con,this.con*r),h=2*this.a*this.k0*c/this.cons,n.x=this.x0+h*Math.sin(e-this.long0),n.y=this.y0-this.con*h*Math.cos(e-this.long0),n):(Math.abs(this.sinlat0)<ct?(s=2*this.a*this.k0/(1+l*Math.cos(g)),n.y=s*o):(s=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*o+this.cosX0*l*Math.cos(g))),n.y=s*(this.cosX0*o-this.sinX0*l*Math.cos(g))+this.y0),n.x=s*l*Math.sin(g)+this.x0,n))}function bfe(n){n.x-=this.x0,n.y-=this.y0;var e,t,r,i,s,a=Math.sqrt(n.x*n.x+n.y*n.y);if(this.sphere){var o=2*Math.atan(a/(2*this.a*this.k0));return e=this.long0,t=this.lat0,a<=ct?(n.x=e,n.y=t,n):(t=Math.asin(Math.cos(o)*this.sinlat0+n.y*Math.sin(o)*this.coslat0/a),Math.abs(this.coslat0)<ct?this.lat0>0?e=mt(this.long0+Math.atan2(n.x,-1*n.y),this.over):e=mt(this.long0+Math.atan2(n.x,n.y),this.over):e=mt(this.long0+Math.atan2(n.x*Math.sin(o),a*this.coslat0*Math.cos(o)-n.y*this.sinlat0*Math.sin(o)),this.over),n.x=e,n.y=t,n)}else if(Math.abs(this.coslat0)<=ct){if(a<=ct)return t=this.lat0,e=this.long0,n.x=e,n.y=t,n;n.x*=this.con,n.y*=this.con,r=a*this.cons/(2*this.a*this.k0),t=this.con*r1(this.e,r),e=this.con*mt(this.con*this.long0+Math.atan2(n.x,-1*n.y),this.over)}else i=2*Math.atan(a*this.cosX0/(2*this.a*this.k0*this.ms1)),e=this.long0,a<=ct?s=this.X0:(s=Math.asin(Math.cos(i)*this.sinX0+n.y*Math.sin(i)*this.cosX0/a),e=mt(this.long0+Math.atan2(n.x*Math.sin(i),a*this.cosX0*Math.cos(i)-n.y*this.sinX0*Math.sin(i)),this.over)),t=-1*r1(this.e,Math.tan(.5*(Xe+s)));return n.x=e,n.y=t,n}var Tfe=["stere","Stereographic_South_Pole","Polar_Stereographic_variant_A","Polar_Stereographic_variant_B","Polar_Stereographic"];const Rfe={init:Efe,forward:Sfe,inverse:bfe,names:Tfe,ssfn_:XI};function Afe(){var n=this.lat0;this.lambda0=this.long0;var e=Math.sin(n),t=this.a,r=this.rf,i=1/r,s=2*i-Math.pow(i,2),a=this.e=Math.sqrt(s);this.R=this.k0*t*Math.sqrt(1-s)/(1-s*Math.pow(e,2)),this.alpha=Math.sqrt(1+s/(1-s)*Math.pow(Math.cos(n),4)),this.b0=Math.asin(e/this.alpha);var o=Math.log(Math.tan(Math.PI/4+this.b0/2)),l=Math.log(Math.tan(Math.PI/4+n/2)),c=Math.log((1+a*e)/(1-a*e));this.K=o-this.alpha*l+this.alpha*a/2*c}function kfe(n){var e=Math.log(Math.tan(Math.PI/4-n.y/2)),t=this.e/2*Math.log((1+this.e*Math.sin(n.y))/(1-this.e*Math.sin(n.y))),r=-this.alpha*(e+t)+this.K,i=2*(Math.atan(Math.exp(r))-Math.PI/4),s=this.alpha*(n.x-this.lambda0),a=Math.atan(Math.sin(s)/(Math.sin(this.b0)*Math.tan(i)+Math.cos(this.b0)*Math.cos(s))),o=Math.asin(Math.cos(this.b0)*Math.sin(i)-Math.sin(this.b0)*Math.cos(i)*Math.cos(s));return n.y=this.R/2*Math.log((1+Math.sin(o))/(1-Math.sin(o)))+this.y0,n.x=this.R*a+this.x0,n}function Ife(n){for(var e=n.x-this.x0,t=n.y-this.y0,r=e/this.R,i=2*(Math.atan(Math.exp(t/this.R))-Math.PI/4),s=Math.asin(Math.cos(this.b0)*Math.sin(i)+Math.sin(this.b0)*Math.cos(i)*Math.cos(r)),a=Math.atan(Math.sin(r)/(Math.cos(this.b0)*Math.cos(r)-Math.sin(this.b0)*Math.tan(i))),o=this.lambda0+a/this.alpha,l=0,c=s,h=-1e3,g=0;Math.abs(c-h)>1e-7;){if(++g>20)return;l=1/this.alpha*(Math.log(Math.tan(Math.PI/4+s/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(c))/2)),h=c,c=2*Math.atan(Math.exp(l))-Math.PI/2}return n.x=o,n.y=c,n}var Cfe=["somerc"];const Pfe={init:Afe,forward:kfe,inverse:Ife,names:Cfe};var Zf=1e-7;function Nfe(n){var e=["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_variant_A","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"],t=typeof n.projName=="object"?Object.keys(n.projName)[0]:n.projName;return"no_uoff"in n||"no_off"in n||e.indexOf(t)!==-1||e.indexOf(NV(t))!==-1}function Mfe(){var n,e,t,r,i,s,a,o,l,c,h=0,g,m=0,y=0,_=0,x=0,w=0,b=0;this.no_off=Nfe(this),this.no_rot="no_rot"in this;var T=!1;"alpha"in this&&(T=!0);var k=!1;if("rectified_grid_angle"in this&&(k=!0),T&&(b=this.alpha),k&&(h=this.rectified_grid_angle),T||k)m=this.longc;else if(y=this.long1,x=this.lat1,_=this.long2,w=this.lat2,Math.abs(x-w)<=Zf||(n=Math.abs(x))<=Zf||Math.abs(n-Xe)<=Zf||Math.abs(Math.abs(this.lat0)-Xe)<=Zf||Math.abs(Math.abs(w)-Xe)<=Zf)throw new Error;var L=1-this.es;e=Math.sqrt(L),Math.abs(this.lat0)>ct?(o=Math.sin(this.lat0),t=Math.cos(this.lat0),n=1-this.es*o*o,this.B=t*t,this.B=Math.sqrt(1+this.es*this.B*this.B/L),this.A=this.B*this.k0*e/n,r=this.B*e/(t*Math.sqrt(n)),i=r*r-1,i<=0?i=0:(i=Math.sqrt(i),this.lat0<0&&(i=-i)),this.E=i+=r,this.E*=Math.pow(_o(this.e,this.lat0,o),this.B)):(this.B=1/e,this.A=this.k0,this.E=r=i=1),T||k?(T?(g=Math.asin(Math.sin(b)/r),k||(h=b)):(g=h,b=Math.asin(r*Math.sin(g))),this.lam0=m-Math.asin(.5*(i-1/i)*Math.tan(g))/this.B):(s=Math.pow(_o(this.e,x,Math.sin(x)),this.B),a=Math.pow(_o(this.e,w,Math.sin(w)),this.B),i=this.E/s,l=(a-s)/(a+s),c=this.E*this.E,c=(c-a*s)/(c+a*s),n=y-_,n<-Math.PI?_-=t1:n>Math.PI&&(_+=t1),this.lam0=mt(.5*(y+_)-Math.atan(c*Math.tan(.5*this.B*(y-_))/l)/this.B,this.over),g=Math.atan(2*Math.sin(this.B*mt(y-this.lam0,this.over))/(i-1/i)),h=b=Math.asin(r*Math.sin(g))),this.singam=Math.sin(g),this.cosgam=Math.cos(g),this.sinrot=Math.sin(h),this.cosrot=Math.cos(h),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(r*r-1)/Math.cos(b))),this.lat0<0&&(this.u_0=-this.u_0)),i=.5*g,this.v_pole_n=this.ArB*Math.log(Math.tan($n-i)),this.v_pole_s=this.ArB*Math.log(Math.tan($n+i))}function Lfe(n){var e={},t,r,i,s,a,o,l,c;if(n.x=n.x-this.lam0,Math.abs(Math.abs(n.y)-Xe)>ct){if(a=this.E/Math.pow(_o(this.e,n.y,Math.sin(n.y)),this.B),o=1/a,t=.5*(a-o),r=.5*(a+o),s=Math.sin(this.B*n.x),i=(t*this.singam-s*this.cosgam)/r,Math.abs(Math.abs(i)-1)<ct)throw new Error;c=.5*this.ArB*Math.log((1-i)/(1+i)),o=Math.cos(this.B*n.x),Math.abs(o)<Zf?l=this.A*n.x:l=this.ArB*Math.atan2(t*this.cosgam+s*this.singam,o)}else c=n.y>0?this.v_pole_n:this.v_pole_s,l=this.ArB*n.y;return this.no_rot?(e.x=l,e.y=c):(l-=this.u_0,e.x=c*this.cosrot+l*this.sinrot,e.y=l*this.cosrot-c*this.sinrot),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e}function Ofe(n){var e,t,r,i,s,a,o,l={};if(n.x=(n.x-this.x0)*(1/this.a),n.y=(n.y-this.y0)*(1/this.a),this.no_rot?(t=n.y,e=n.x):(t=n.x*this.cosrot-n.y*this.sinrot,e=n.y*this.cosrot+n.x*this.sinrot+this.u_0),r=Math.exp(-this.BrA*t),i=.5*(r-1/r),s=.5*(r+1/r),a=Math.sin(this.BrA*e),o=(a*this.cosgam+i*this.singam)/s,Math.abs(Math.abs(o)-1)<ct)l.x=0,l.y=o<0?-Xe:Xe;else{if(l.y=this.E/Math.sqrt((1+o)/(1-o)),l.y=r1(this.e,Math.pow(l.y,1/this.B)),l.y===1/0)throw new Error;l.x=-this.rB*Math.atan2(i*this.cosgam-a*this.singam,Math.cos(this.BrA*e))}return l.x+=this.lam0,l}var Dfe=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_variant_A","Hotine_Oblique_Mercator_Variant_B","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"];const jfe={init:Mfe,forward:Lfe,inverse:Ofe,names:Dfe};function Ffe(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<ct)){var n=this.b/this.a;this.e=Math.sqrt(1-n*n);var e=Math.sin(this.lat1),t=Math.cos(this.lat1),r=gl(this.e,e,t),i=_o(this.e,this.lat1,e),s=Math.sin(this.lat2),a=Math.cos(this.lat2),o=gl(this.e,s,a),l=_o(this.e,this.lat2,s),c=Math.abs(Math.abs(this.lat0)-Xe)<ct?0:_o(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>ct?this.ns=Math.log(r/o)/Math.log(i/l):this.ns=e,isNaN(this.ns)&&(this.ns=e),this.f0=r/(this.ns*Math.pow(i,this.ns)),this.rh=this.a*this.f0*Math.pow(c,this.ns),this.title||(this.title="Lambert Conformal Conic")}}function Vfe(n){var e=n.x,t=n.y;Math.abs(2*Math.abs(t)-Math.PI)<=ct&&(t=J1(t)*(Xe-2*ct));var r=Math.abs(Math.abs(t)-Xe),i,s;if(r>ct)i=_o(this.e,t,Math.sin(t)),s=this.a*this.f0*Math.pow(i,this.ns);else{if(r=t*this.ns,r<=0)return null;s=0}var a=this.ns*mt(e-this.long0,this.over);return n.x=this.k0*(s*Math.sin(a))+this.x0,n.y=this.k0*(this.rh-s*Math.cos(a))+this.y0,n}function Bfe(n){var e,t,r,i,s,a=(n.x-this.x0)/this.k0,o=this.rh-(n.y-this.y0)/this.k0;this.ns>0?(e=Math.sqrt(a*a+o*o),t=1):(e=-Math.sqrt(a*a+o*o),t=-1);var l=0;if(e!==0&&(l=Math.atan2(t*a,t*o)),e!==0||this.ns>0){if(t=1/this.ns,r=Math.pow(e/(this.a*this.f0),t),i=r1(this.e,r),i===-9999)return null}else i=-Xe;return s=mt(l/this.ns+this.long0,this.over),n.x=s,n.y=i,n}var Gfe=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"];const zfe={init:Ffe,forward:Vfe,inverse:Bfe,names:Gfe};function Ufe(){this.a=6377397155e-3,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.7417649320975901-.308341501185665),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq}function $fe(n){var e,t,r,i,s,a,o,l=n.x,c=n.y,h=mt(l-this.long0,this.over);return e=Math.pow((1+this.e*Math.sin(c))/(1-this.e*Math.sin(c)),this.alfa*this.e/2),t=2*(Math.atan(this.k*Math.pow(Math.tan(c/2+this.s45),this.alfa)/e)-this.s45),r=-h*this.alfa,i=Math.asin(Math.cos(this.ad)*Math.sin(t)+Math.sin(this.ad)*Math.cos(t)*Math.cos(r)),s=Math.asin(Math.cos(t)*Math.sin(r)/Math.cos(i)),a=this.n*s,o=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(i/2+this.s45),this.n),n.y=o*Math.cos(a)/1,n.x=o*Math.sin(a)/1,this.czech||(n.y*=-1,n.x*=-1),n}function Wfe(n){var e,t,r,i,s,a,o,l,c=n.x;n.x=n.y,n.y=c,this.czech||(n.y*=-1,n.x*=-1),a=Math.sqrt(n.x*n.x+n.y*n.y),s=Math.atan2(n.y,n.x),i=s/Math.sin(this.s0),r=2*(Math.atan(Math.pow(this.ro0/a,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),e=Math.asin(Math.cos(this.ad)*Math.sin(r)-Math.sin(this.ad)*Math.cos(r)*Math.cos(i)),t=Math.asin(Math.cos(r)*Math.sin(i)/Math.cos(e)),n.x=this.long0-t/this.alfa,o=e,l=0;var h=0;do n.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(e/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(o))/(1-this.e*Math.sin(o)),this.e/2))-this.s45),Math.abs(o-n.y)<1e-10&&(l=1),o=n.y,h+=1;while(l===0&&h<15);return h>=15?null:n}var Hfe=["Krovak","krovak"];const Kfe={init:Ufe,forward:$fe,inverse:Wfe,names:Hfe};function Ss(n,e,t,r,i){return n*i-e*Math.sin(2*i)+t*Math.sin(4*i)-r*Math.sin(6*i)}function Q1(n){return 1-.25*n*(1+n/16*(3+1.25*n))}function ey(n){return .375*n*(1+.25*n*(1+.46875*n))}function ty(n){return .05859375*n*n*(1+.75*n)}function ny(n){return n*n*n*(35/3072)}function qI(n,e,t){var r=e*t;return n/Math.sqrt(1-r*r)}function Zu(n){return Math.abs(n)<Xe?n:n-J1(n)*Math.PI}function Kv(n,e,t,r,i){var s,a;s=n/e;for(var o=0;o<15;o++)if(a=(n-(e*s-t*Math.sin(2*s)+r*Math.sin(4*s)-i*Math.sin(6*s)))/(e-2*t*Math.cos(2*s)+4*r*Math.cos(4*s)-6*i*Math.cos(6*s)),s+=a,Math.abs(a)<=1e-10)return s;return NaN}function Xfe(){this.sphere||(this.e0=Q1(this.es),this.e1=ey(this.es),this.e2=ty(this.es),this.e3=ny(this.es),this.ml0=this.a*Ss(this.e0,this.e1,this.e2,this.e3,this.lat0))}function qfe(n){var e,t,r=n.x,i=n.y;if(r=mt(r-this.long0,this.over),this.sphere)e=this.a*Math.asin(Math.cos(i)*Math.sin(r)),t=this.a*(Math.atan2(Math.tan(i),Math.cos(r))-this.lat0);else{var s=Math.sin(i),a=Math.cos(i),o=qI(this.a,this.e,s),l=Math.tan(i)*Math.tan(i),c=r*Math.cos(i),h=c*c,g=this.es*a*a/(1-this.es),m=this.a*Ss(this.e0,this.e1,this.e2,this.e3,i);e=o*c*(1-h*l*(1/6-(8-l+8*g)*h/120)),t=m-this.ml0+o*s/a*h*(.5+(5-l+6*g)*h/24)}return n.x=e+this.x0,n.y=t+this.y0,n}function Yfe(n){n.x-=this.x0,n.y-=this.y0;var e=n.x/this.a,t=n.y/this.a,r,i;if(this.sphere){var s=t+this.lat0;r=Math.asin(Math.sin(s)*Math.cos(e)),i=Math.atan2(Math.tan(e),Math.cos(s))}else{var a=this.ml0/this.a+t,o=Kv(a,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(o)-Xe)<=ct)return n.x=this.long0,n.y=Xe,t<0&&(n.y*=-1),n;var l=qI(this.a,this.e,Math.sin(o)),c=l*l*l/this.a/this.a*(1-this.es),h=Math.pow(Math.tan(o),2),g=e*this.a/l,m=g*g;r=o-l*Math.tan(o)/c*g*g*(.5-(1+3*h)*g*g/24),i=g*(1-m*(h/3+(1+3*h)*h*m/15))/Math.cos(o)}return n.x=mt(i+this.long0,this.over),n.y=Zu(r),n}var Zfe=["Cassini","Cassini_Soldner","cass"];const Jfe={init:Xfe,forward:qfe,inverse:Yfe,names:Zfe};function Pu(n,e){var t;return n>1e-7?(t=n*e,(1-n*n)*(e/(1-t*t)-.5/n*Math.log((1-t)/(1+t)))):2*e}var NR=1,MR=2,LR=3,A_=4;function Qfe(){var n=Math.abs(this.lat0);if(Math.abs(n-Xe)<ct?this.mode=this.lat0<0?NR:MR:Math.abs(n)<ct?this.mode=LR:this.mode=A_,this.es>0){var e;switch(this.qp=Pu(this.e,1),this.mmf=.5/(1-this.es),this.apa=l0e(this.es),this.mode){case MR:this.dd=1;break;case NR:this.dd=1;break;case LR:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case A_:this.rq=Math.sqrt(.5*this.qp),e=Math.sin(this.lat0),this.sinb1=Pu(this.e,e)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*e*e)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd;break}}else this.mode===A_&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))}function e0e(n){var e,t,r,i,s,a,o,l,c,h,g=n.x,m=n.y;if(g=mt(g-this.long0,this.over),this.sphere){if(s=Math.sin(m),h=Math.cos(m),r=Math.cos(g),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(t=this.mode===this.EQUIT?1+h*r:1+this.sinph0*s+this.cosph0*h*r,t<=ct)return null;t=Math.sqrt(2/t),e=t*h*Math.sin(g),t*=this.mode===this.EQUIT?s:this.cosph0*s-this.sinph0*h*r}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(r=-r),Math.abs(m+this.lat0)<ct)return null;t=$n-m*.5,t=2*(this.mode===this.S_POLE?Math.cos(t):Math.sin(t)),e=t*Math.sin(g),t*=r}}else{switch(o=0,l=0,c=0,r=Math.cos(g),i=Math.sin(g),s=Math.sin(m),a=Pu(this.e,s),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(o=a/this.qp,l=Math.sqrt(1-o*o)),this.mode){case this.OBLIQ:c=1+this.sinb1*o+this.cosb1*l*r;break;case this.EQUIT:c=1+l*r;break;case this.N_POLE:c=Xe+m,a=this.qp-a;break;case this.S_POLE:c=m-Xe,a=this.qp+a;break}if(Math.abs(c)<ct)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:c=Math.sqrt(2/c),this.mode===this.OBLIQ?t=this.ymf*c*(this.cosb1*o-this.sinb1*l*r):t=(c=Math.sqrt(2/(1+l*r)))*o*this.ymf,e=this.xmf*c*l*i;break;case this.N_POLE:case this.S_POLE:a>=0?(e=(c=Math.sqrt(a))*i,t=r*(this.mode===this.S_POLE?c:-c)):e=t=0;break}}return n.x=this.a*e+this.x0,n.y=this.a*t+this.y0,n}function t0e(n){n.x-=this.x0,n.y-=this.y0;var e=n.x/this.a,t=n.y/this.a,r,i,s,a,o,l,c;if(this.sphere){var h=0,g,m=0;if(g=Math.sqrt(e*e+t*t),i=g*.5,i>1)return null;switch(i=2*Math.asin(i),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(m=Math.sin(i),h=Math.cos(i)),this.mode){case this.EQUIT:i=Math.abs(g)<=ct?0:Math.asin(t*m/g),e*=m,t=h*g;break;case this.OBLIQ:i=Math.abs(g)<=ct?this.lat0:Math.asin(h*this.sinph0+t*m*this.cosph0/g),e*=m*this.cosph0,t=(h-Math.sin(i)*this.sinph0)*g;break;case this.N_POLE:t=-t,i=Xe-i;break;case this.S_POLE:i-=Xe;break}r=t===0&&(this.mode===this.EQUIT||this.mode===this.OBLIQ)?0:Math.atan2(e,t)}else{if(c=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(e/=this.dd,t*=this.dd,l=Math.sqrt(e*e+t*t),l<ct)return n.x=this.long0,n.y=this.lat0,n;a=2*Math.asin(.5*l/this.rq),s=Math.cos(a),e*=a=Math.sin(a),this.mode===this.OBLIQ?(c=s*this.sinb1+t*a*this.cosb1/l,o=this.qp*c,t=l*this.cosb1*s-t*this.sinb1*a):(c=t*a/l,o=this.qp*c,t=l*s)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(t=-t),o=e*e+t*t,!o)return n.x=this.long0,n.y=this.lat0,n;c=1-o/this.qp,this.mode===this.S_POLE&&(c=-c)}r=Math.atan2(e,t),i=c0e(Math.asin(c),this.apa)}return n.x=mt(this.long0+r,this.over),n.y=i,n}var n0e=.3333333333333333,r0e=.17222222222222222,i0e=.10257936507936508,s0e=.06388888888888888,a0e=.0664021164021164,o0e=.016415012942191543;function l0e(n){var e,t=[];return t[0]=n*n0e,e=n*n,t[0]+=e*r0e,t[1]=e*s0e,e*=n,t[0]+=e*i0e,t[1]+=e*a0e,t[2]=e*o0e,t}function c0e(n,e){var t=n+n;return n+e[0]*Math.sin(t)+e[1]*Math.sin(t+t)+e[2]*Math.sin(t+t+t)}var u0e=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"];const h0e={init:Qfe,forward:e0e,inverse:t0e,names:u0e,S_POLE:NR,N_POLE:MR,EQUIT:LR,OBLIQ:A_};function zu(n){return Math.abs(n)>1&&(n=n>1?1:-1),Math.asin(n)}function d0e(){Math.abs(this.lat1+this.lat2)<ct||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=gl(this.e3,this.sin_po,this.cos_po),this.qs1=Pu(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=gl(this.e3,this.sin_po,this.cos_po),this.qs2=Pu(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=Pu(this.e3,this.sin_po),Math.abs(this.lat1-this.lat2)>ct?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)}function f0e(n){var e=n.x,t=n.y;this.sin_phi=Math.sin(t),this.cos_phi=Math.cos(t);var r=Pu(this.e3,this.sin_phi),i=this.a*Math.sqrt(this.c-this.ns0*r)/this.ns0,s=this.ns0*mt(e-this.long0,this.over),a=i*Math.sin(s)+this.x0,o=this.rh-i*Math.cos(s)+this.y0;return n.x=a,n.y=o,n}function g0e(n){var e,t,r,i,s,a;return n.x-=this.x0,n.y=this.rh-n.y+this.y0,this.ns0>=0?(e=Math.sqrt(n.x*n.x+n.y*n.y),r=1):(e=-Math.sqrt(n.x*n.x+n.y*n.y),r=-1),i=0,e!==0&&(i=Math.atan2(r*n.x,r*n.y)),r=e*this.ns0/this.a,this.sphere?a=Math.asin((this.c-r*r)/(2*this.ns0)):(t=(this.c-r*r)/this.ns0,a=this.phi1z(this.e3,t)),s=mt(i/this.ns0+this.long0,this.over),n.x=s,n.y=a,n}function m0e(n,e){var t,r,i,s,a,o=zu(.5*e);if(n<ct)return o;for(var l=n*n,c=1;c<=25;c++)if(t=Math.sin(o),r=Math.cos(o),i=n*t,s=1-i*i,a=.5*s*s/r*(e/(1-l)-t/s+.5/n*Math.log((1-i)/(1+i))),o=o+a,Math.abs(a)<=1e-7)return o;return null}var p0e=["Albers_Conic_Equal_Area","Albers_Equal_Area","Albers","aea"];const y0e={init:d0e,forward:f0e,inverse:g0e,names:p0e,phi1z:m0e};function x0e(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1}function _0e(n){var e,t,r,i,s,a,o,l,c=n.x,h=n.y;return r=mt(c-this.long0,this.over),e=Math.sin(h),t=Math.cos(h),i=Math.cos(r),a=this.sin_p14*e+this.cos_p14*t*i,s=1,a>0||Math.abs(a)<=ct?(o=this.x0+this.a*s*t*Math.sin(r)/a,l=this.y0+this.a*s*(this.cos_p14*e-this.sin_p14*t*i)/a):(o=this.x0+this.infinity_dist*t*Math.sin(r),l=this.y0+this.infinity_dist*(this.cos_p14*e-this.sin_p14*t*i)),n.x=o,n.y=l,n}function v0e(n){var e,t,r,i,s,a;return n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a,n.x/=this.k0,n.y/=this.k0,(e=Math.sqrt(n.x*n.x+n.y*n.y))?(i=Math.atan2(e,this.rc),t=Math.sin(i),r=Math.cos(i),a=zu(r*this.sin_p14+n.y*t*this.cos_p14/e),s=Math.atan2(n.x*t,e*this.cos_p14*r-n.y*this.sin_p14*t),s=mt(this.long0+s,this.over)):(a=this.phic0,s=0),n.x=s,n.y=a,n}var w0e=["gnom"];const E0e={init:x0e,forward:_0e,inverse:v0e,names:w0e};function S0e(n,e){var t=1-(1-n*n)/(2*n)*Math.log((1-n)/(1+n));if(Math.abs(Math.abs(e)-t)<1e-6)return e<0?-1*Xe:Xe;for(var r=Math.asin(.5*e),i,s,a,o,l=0;l<30;l++)if(s=Math.sin(r),a=Math.cos(r),o=n*s,i=Math.pow(1-o*o,2)/(2*a)*(e/(1-n*n)-s/(1-o*o)+.5/n*Math.log((1-o)/(1+o))),r+=i,Math.abs(i)<=1e-10)return r;return NaN}function b0e(){this.sphere||(this.k0=gl(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))}function T0e(n){var e=n.x,t=n.y,r,i,s=mt(e-this.long0,this.over);if(this.sphere)r=this.x0+this.a*s*Math.cos(this.lat_ts),i=this.y0+this.a*Math.sin(t)/Math.cos(this.lat_ts);else{var a=Pu(this.e,Math.sin(t));r=this.x0+this.a*this.k0*s,i=this.y0+this.a*a*.5/this.k0}return n.x=r,n.y=i,n}function R0e(n){n.x-=this.x0,n.y-=this.y0;var e,t;return this.sphere?(e=mt(this.long0+n.x/this.a/Math.cos(this.lat_ts),this.over),t=Math.asin(n.y/this.a*Math.cos(this.lat_ts))):(t=S0e(this.e,2*n.y*this.k0/this.a),e=mt(this.long0+n.x/(this.a*this.k0),this.over)),n.x=e,n.y=t,n}var A0e=["cea"];const k0e={init:b0e,forward:T0e,inverse:R0e,names:A0e};function I0e(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)}function C0e(n){var e=n.x,t=n.y,r=mt(e-this.long0,this.over),i=Zu(t-this.lat0);return n.x=this.x0+this.a*r*this.rc,n.y=this.y0+this.a*i,n}function P0e(n){var e=n.x,t=n.y;return n.x=mt(this.long0+(e-this.x0)/(this.a*this.rc),this.over),n.y=Zu(this.lat0+(t-this.y0)/this.a),n}var N0e=["Equirectangular","Equidistant_Cylindrical","Equidistant_Cylindrical_Spherical","eqc"];const M0e={init:I0e,forward:C0e,inverse:P0e,names:N0e};var oO=20;function L0e(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Q1(this.es),this.e1=ey(this.es),this.e2=ty(this.es),this.e3=ny(this.es),this.ml0=this.a*Ss(this.e0,this.e1,this.e2,this.e3,this.lat0)}function O0e(n){var e=n.x,t=n.y,r,i,s,a=mt(e-this.long0,this.over);if(s=a*Math.sin(t),this.sphere)Math.abs(t)<=ct?(r=this.a*a,i=-1*this.a*this.lat0):(r=this.a*Math.sin(s)/Math.tan(t),i=this.a*(Zu(t-this.lat0)+(1-Math.cos(s))/Math.tan(t)));else if(Math.abs(t)<=ct)r=this.a*a,i=-1*this.ml0;else{var o=qI(this.a,this.e,Math.sin(t))/Math.tan(t);r=o*Math.sin(s),i=this.a*Ss(this.e0,this.e1,this.e2,this.e3,t)-this.ml0+o*(1-Math.cos(s))}return n.x=r+this.x0,n.y=i+this.y0,n}function D0e(n){var e,t,r,i,s,a,o,l,c;if(r=n.x-this.x0,i=n.y-this.y0,this.sphere)if(Math.abs(i+this.a*this.lat0)<=ct)e=mt(r/this.a+this.long0,this.over),t=0;else{a=this.lat0+i/this.a,o=r*r/this.a/this.a+a*a,l=a;var h;for(s=oO;s;--s)if(h=Math.tan(l),c=-1*(a*(l*h+1)-l-.5*(l*l+o)*h)/((l-a)/h-1),l+=c,Math.abs(c)<=ct){t=l;break}e=mt(this.long0+Math.asin(r*Math.tan(l)/this.a)/Math.sin(t),this.over)}else if(Math.abs(i+this.ml0)<=ct)t=0,e=mt(this.long0+r/this.a,this.over);else{a=(this.ml0+i)/this.a,o=r*r/this.a/this.a+a*a,l=a;var g,m,y,_,x;for(s=oO;s;--s)if(x=this.e*Math.sin(l),g=Math.sqrt(1-x*x)*Math.tan(l),m=this.a*Ss(this.e0,this.e1,this.e2,this.e3,l),y=this.e0-2*this.e1*Math.cos(2*l)+4*this.e2*Math.cos(4*l)-6*this.e3*Math.cos(6*l),_=m/this.a,c=(a*(g*_+1)-_-.5*g*(_*_+o))/(this.es*Math.sin(2*l)*(_*_+o-2*a*_)/(4*g)+(a-_)*(g*y-2/Math.sin(2*l))-y),l-=c,Math.abs(c)<=ct){t=l;break}g=Math.sqrt(1-this.es*Math.pow(Math.sin(t),2))*Math.tan(t),e=mt(this.long0+Math.asin(r*g/this.a)/Math.sin(t),this.over)}return n.x=e,n.y=t,n}var j0e=["Polyconic","American_Polyconic","poly"];const F0e={init:L0e,forward:O0e,inverse:D0e,names:j0e};function V0e(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013}function B0e(n){var e,t=n.x,r=n.y,i=r-this.lat0,s=t-this.long0,a=i/np*1e-5,o=s,l=1,c=0;for(e=1;e<=10;e++)l=l*a,c=c+this.A[e]*l;var h=c,g=o,m=1,y=0,_,x,w=0,b=0;for(e=1;e<=6;e++)_=m*h-y*g,x=y*h+m*g,m=_,y=x,w=w+this.B_re[e]*m-this.B_im[e]*y,b=b+this.B_im[e]*m+this.B_re[e]*y;return n.x=b*this.a+this.x0,n.y=w*this.a+this.y0,n}function G0e(n){var e,t=n.x,r=n.y,i=t-this.x0,s=r-this.y0,a=s/this.a,o=i/this.a,l=1,c=0,h,g,m=0,y=0;for(e=1;e<=6;e++)h=l*a-c*o,g=c*a+l*o,l=h,c=g,m=m+this.C_re[e]*l-this.C_im[e]*c,y=y+this.C_im[e]*l+this.C_re[e]*c;for(var _=0;_<this.iterations;_++){var x=m,w=y,b,T,k=a,L=o;for(e=2;e<=6;e++)b=x*m-w*y,T=w*m+x*y,x=b,w=T,k=k+(e-1)*(this.B_re[e]*x-this.B_im[e]*w),L=L+(e-1)*(this.B_im[e]*x+this.B_re[e]*w);x=1,w=0;var O=this.B_re[1],B=this.B_im[1];for(e=2;e<=6;e++)b=x*m-w*y,T=w*m+x*y,x=b,w=T,O=O+e*(this.B_re[e]*x-this.B_im[e]*w),B=B+e*(this.B_im[e]*x+this.B_re[e]*w);var R=O*O+B*B;m=(k*O+L*B)/R,y=(L*O-k*B)/R}var A=m,P=y,D=1,N=0;for(e=1;e<=9;e++)D=D*A,N=N+this.D[e]*D;var G=this.lat0+N*np*1e5,j=this.long0+P;return n.x=j,n.y=G,n}var z0e=["New_Zealand_Map_Grid","nzmg"];const U0e={init:V0e,forward:B0e,inverse:G0e,names:z0e};function $0e(){}function W0e(n){var e=n.x,t=n.y,r=mt(e-this.long0,this.over),i=this.x0+this.a*r,s=this.y0+this.a*Math.log(Math.tan(Math.PI/4+t/2.5))*1.25;return n.x=i,n.y=s,n}function H0e(n){n.x-=this.x0,n.y-=this.y0;var e=mt(this.long0+n.x/this.a,this.over),t=2.5*(Math.atan(Math.exp(.8*n.y/this.a))-Math.PI/4);return n.x=e,n.y=t,n}var K0e=["Miller_Cylindrical","mill"];const X0e={init:$0e,forward:W0e,inverse:H0e,names:K0e};var q0e=20;function Y0e(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=UI(this.es)}function Z0e(n){var e,t,r=n.x,i=n.y;if(r=mt(r-this.long0,this.over),this.sphere){if(!this.m)i=this.n!==1?Math.asin(this.n*Math.sin(i)):i;else for(var s=this.n*Math.sin(i),a=q0e;a;--a){var o=(this.m*i+Math.sin(i)-s)/(this.m+Math.cos(i));if(i-=o,Math.abs(o)<ct)break}e=this.a*this.C_x*r*(this.m+Math.cos(i)),t=this.a*this.C_y*i}else{var l=Math.sin(i),c=Math.cos(i);t=this.a*xg(i,l,c,this.en),e=this.a*r*c/Math.sqrt(1-this.es*l*l)}return n.x=e,n.y=t,n}function J0e(n){var e,t,r,i;return n.x-=this.x0,r=n.x/this.a,n.y-=this.y0,e=n.y/this.a,this.sphere?(e/=this.C_y,r=r/(this.C_x*(this.m+Math.cos(e))),this.m?e=zu((this.m*e+Math.sin(e))/this.n):this.n!==1&&(e=zu(Math.sin(e)/this.n)),r=mt(r+this.long0,this.over),e=Zu(e)):(e=$I(n.y/this.a,this.es,this.en),i=Math.abs(e),i<Xe?(i=Math.sin(e),t=this.long0+n.x*Math.sqrt(1-this.es*i*i)/(this.a*Math.cos(e)),r=mt(t,this.over)):i-ct<Xe&&(r=this.long0)),n.x=r,n.y=e,n}var Q0e=["Sinusoidal","sinu"];const ege={init:Y0e,forward:Z0e,inverse:J0e,names:Q0e};function tge(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0}function nge(n){for(var e=n.x,t=n.y,r=mt(e-this.long0,this.over),i=t,s=Math.PI*Math.sin(t);;){var a=-(i+Math.sin(i)-s)/(1+Math.cos(i));if(i+=a,Math.abs(a)<ct)break}i/=2,Math.PI/2-Math.abs(t)<ct&&(r=0);var o=.900316316158*this.a*r*Math.cos(i)+this.x0,l=1.4142135623731*this.a*Math.sin(i)+this.y0;return n.x=o,n.y=l,n}function rge(n){var e,t;n.x-=this.x0,n.y-=this.y0,t=n.y/(1.4142135623731*this.a),Math.abs(t)>.999999999999&&(t=.999999999999),e=Math.asin(t);var r=mt(this.long0+n.x/(.900316316158*this.a*Math.cos(e)),this.over);r<-Math.PI&&(r=-Math.PI),r>Math.PI&&(r=Math.PI),t=(2*e+Math.sin(2*e))/Math.PI,Math.abs(t)>1&&(t=1);var i=Math.asin(t);return n.x=r,n.y=i,n}var ige=["Mollweide","moll"];const sge={init:tge,forward:nge,inverse:rge,names:ige};function age(){Math.abs(this.lat1+this.lat2)<ct||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Q1(this.es),this.e1=ey(this.es),this.e2=ty(this.es),this.e3=ny(this.es),this.sin_phi=Math.sin(this.lat1),this.cos_phi=Math.cos(this.lat1),this.ms1=gl(this.e,this.sin_phi,this.cos_phi),this.ml1=Ss(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<ct?this.ns=this.sin_phi:(this.sin_phi=Math.sin(this.lat2),this.cos_phi=Math.cos(this.lat2),this.ms2=gl(this.e,this.sin_phi,this.cos_phi),this.ml2=Ss(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=Ss(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))}function oge(n){var e=n.x,t=n.y,r;if(this.sphere)r=this.a*(this.g-t);else{var i=Ss(this.e0,this.e1,this.e2,this.e3,t);r=this.a*(this.g-i)}var s=this.ns*mt(e-this.long0,this.over),a=this.x0+r*Math.sin(s),o=this.y0+this.rh-r*Math.cos(s);return n.x=a,n.y=o,n}function lge(n){n.x-=this.x0,n.y=this.rh-n.y+this.y0;var e,t,r,i;this.ns>=0?(t=Math.sqrt(n.x*n.x+n.y*n.y),e=1):(t=-Math.sqrt(n.x*n.x+n.y*n.y),e=-1);var s=0;if(t!==0&&(s=Math.atan2(e*n.x,e*n.y)),this.sphere)return i=mt(this.long0+s/this.ns,this.over),r=Zu(this.g-t/this.a),n.x=i,n.y=r,n;var a=this.g-t/this.a;return r=Kv(a,this.e0,this.e1,this.e2,this.e3),i=mt(this.long0+s/this.ns,this.over),n.x=i,n.y=r,n}var cge=["Equidistant_Conic","eqdc"];const uge={init:age,forward:oge,inverse:lge,names:cge};function hge(){this.R=this.a}function dge(n){var e=n.x,t=n.y,r=mt(e-this.long0,this.over),i,s;Math.abs(t)<=ct&&(i=this.x0+this.R*r,s=this.y0);var a=zu(2*Math.abs(t/Math.PI));(Math.abs(r)<=ct||Math.abs(Math.abs(t)-Xe)<=ct)&&(i=this.x0,t>=0?s=this.y0+Math.PI*this.R*Math.tan(.5*a):s=this.y0+Math.PI*this.R*-Math.tan(.5*a));var o=.5*Math.abs(Math.PI/r-r/Math.PI),l=o*o,c=Math.sin(a),h=Math.cos(a),g=h/(c+h-1),m=g*g,y=g*(2/c-1),_=y*y,x=Math.PI*this.R*(o*(g-_)+Math.sqrt(l*(g-_)*(g-_)-(_+l)*(m-_)))/(_+l);r<0&&(x=-x),i=this.x0+x;var w=l+g;return x=Math.PI*this.R*(y*w-o*Math.sqrt((_+l)*(l+1)-w*w))/(_+l),t>=0?s=this.y0+x:s=this.y0-x,n.x=i,n.y=s,n}function fge(n){var e,t,r,i,s,a,o,l,c,h,g,m,y;return n.x-=this.x0,n.y-=this.y0,g=Math.PI*this.R,r=n.x/g,i=n.y/g,s=r*r+i*i,a=-Math.abs(i)*(1+s),o=a-2*i*i+r*r,l=-2*a+1+2*i*i+s*s,y=i*i/l+(2*o*o*o/l/l/l-9*a*o/l/l)/27,c=(a-o*o/3/l)/l,h=2*Math.sqrt(-c/3),g=3*y/c/h,Math.abs(g)>1&&(g>=0?g=1:g=-1),m=Math.acos(g)/3,n.y>=0?t=(-h*Math.cos(m+Math.PI/3)-o/3/l)*Math.PI:t=-(-h*Math.cos(m+Math.PI/3)-o/3/l)*Math.PI,Math.abs(r)<ct?e=this.long0:e=mt(this.long0+Math.PI*(s-1+Math.sqrt(1+2*(r*r-i*i)+s*s))/2/r,this.over),n.x=e,n.y=t,n}var gge=["Van_der_Grinten_I","VanDerGrinten","Van_der_Grinten","vandg"];const mge={init:hge,forward:dge,inverse:fge,names:gge};function pge(n,e,t,r,i,s){const a=r-e,o=Math.atan((1-s)*Math.tan(n)),l=Math.atan((1-s)*Math.tan(t)),c=Math.sin(o),h=Math.cos(o),g=Math.sin(l),m=Math.cos(l);let y=a,_,x=100,w,b,T,k,L,O,B,R,A,P,D,N,G,j;do{if(w=Math.sin(y),b=Math.cos(y),T=Math.sqrt(m*w*(m*w)+(h*g-c*m*b)*(h*g-c*m*b)),T===0)return{azi1:0,s12:0};k=c*g+h*m*b,L=Math.atan2(T,k),O=h*m*w/T,B=1-O*O,R=B!==0?k-2*c*g/B:0,A=s/16*B*(4+s*(4-3*B)),_=y,y=a+(1-A)*s*O*(L+A*T*(R+A*k*(-1+2*R*R)))}while(Math.abs(y-_)>1e-12&&--x>0);return x===0?{azi1:NaN,s12:NaN}:(P=B*(i*i-i*(1-s)*(i*(1-s)))/(i*(1-s)*(i*(1-s))),D=1+P/16384*(4096+P*(-768+P*(320-175*P))),N=P/1024*(256+P*(-128+P*(74-47*P))),G=N*T*(R+N/4*(k*(-1+2*R*R)-N/6*R*(-3+4*T*T)*(-3+4*R*R))),j=i*(1-s)*D*(L-G),{azi1:Math.atan2(m*w,h*g-c*m*b),s12:j})}function yge(n,e,t,r,i,s){const a=Math.atan((1-s)*Math.tan(n)),o=Math.sin(a),l=Math.cos(a),c=Math.sin(t),h=Math.cos(t),g=Math.atan2(o,l*h),m=l*c,y=1-m*m,_=y*(i*i-i*(1-s)*(i*(1-s)))/(i*(1-s)*(i*(1-s))),x=1+_/16384*(4096+_*(-768+_*(320-175*_))),w=_/1024*(256+_*(-128+_*(74-47*_)));let b=r/(i*(1-s)*x),T,k=100,L,O,B,R;do L=Math.cos(2*g+b),O=Math.sin(b),B=Math.cos(b),R=w*O*(L+w/4*(B*(-1+2*L*L)-w/6*L*(-3+4*O*O)*(-3+4*L*L))),T=b,b=r/(i*(1-s)*x)+R;while(Math.abs(b-T)>1e-12&&--k>0);if(k===0)return{lat2:NaN,lon2:NaN};const A=o*O-l*B*h,P=Math.atan2(o*B+l*O*h,(1-s)*Math.sqrt(m*m+A*A)),D=Math.atan2(O*c,l*B-o*O*h),N=s/16*y*(4+s*(4-3*y)),G=D-(1-N)*s*m*(b+N*O*(L+N*B*(-1+2*L*L))),j=e+G;return{lat2:P,lon2:j}}function xge(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0),this.f=this.es/(1+Math.sqrt(1-this.es))}function _ge(n){var e=n.x,t=n.y,r=Math.sin(n.y),i=Math.cos(n.y),s=mt(e-this.long0,this.over),a,o,l,c,h,g,m,y,_,x,w;return this.sphere?Math.abs(this.sin_p12-1)<=ct?(n.x=this.x0+this.a*(Xe-t)*Math.sin(s),n.y=this.y0-this.a*(Xe-t)*Math.cos(s),n):Math.abs(this.sin_p12+1)<=ct?(n.x=this.x0+this.a*(Xe+t)*Math.sin(s),n.y=this.y0+this.a*(Xe+t)*Math.cos(s),n):(_=this.sin_p12*r+this.cos_p12*i*Math.cos(s),m=Math.acos(_),y=m?m/Math.sin(m):1,n.x=this.x0+this.a*y*i*Math.sin(s),n.y=this.y0+this.a*y*(this.cos_p12*r-this.sin_p12*i*Math.cos(s)),n):(a=Q1(this.es),o=ey(this.es),l=ty(this.es),c=ny(this.es),Math.abs(this.sin_p12-1)<=ct?(h=this.a*Ss(a,o,l,c,Xe),g=this.a*Ss(a,o,l,c,t),n.x=this.x0+(h-g)*Math.sin(s),n.y=this.y0-(h-g)*Math.cos(s),n):Math.abs(this.sin_p12+1)<=ct?(h=this.a*Ss(a,o,l,c,Xe),g=this.a*Ss(a,o,l,c,t),n.x=this.x0+(h+g)*Math.sin(s),n.y=this.y0+(h+g)*Math.cos(s),n):Math.abs(e)<ct&&Math.abs(t-this.lat0)<ct?(n.x=n.y=0,n):(x=pge(this.lat0,this.long0,t,e,this.a,this.f),w=x.azi1,n.x=x.s12*Math.sin(w),n.y=x.s12*Math.cos(w),n))}function vge(n){n.x-=this.x0,n.y-=this.y0;var e,t,r,i,s,a,o,l,c,h,g,m,y,_,x,w;return this.sphere?(e=Math.sqrt(n.x*n.x+n.y*n.y),e>2*Xe*this.a?void 0:(t=e/this.a,r=Math.sin(t),i=Math.cos(t),s=this.long0,Math.abs(e)<=ct?a=this.lat0:(a=zu(i*this.sin_p12+n.y*r*this.cos_p12/e),o=Math.abs(this.lat0)-Xe,Math.abs(o)<=ct?this.lat0>=0?s=mt(this.long0+Math.atan2(n.x,-n.y),this.over):s=mt(this.long0-Math.atan2(-n.x,n.y),this.over):s=mt(this.long0+Math.atan2(n.x*r,e*this.cos_p12*i-n.y*this.sin_p12*r),this.over)),n.x=s,n.y=a,n)):(l=Q1(this.es),c=ey(this.es),h=ty(this.es),g=ny(this.es),Math.abs(this.sin_p12-1)<=ct?(m=this.a*Ss(l,c,h,g,Xe),e=Math.sqrt(n.x*n.x+n.y*n.y),y=m-e,a=Kv(y/this.a,l,c,h,g),s=mt(this.long0+Math.atan2(n.x,-1*n.y),this.over),n.x=s,n.y=a,n):Math.abs(this.sin_p12+1)<=ct?(m=this.a*Ss(l,c,h,g,Xe),e=Math.sqrt(n.x*n.x+n.y*n.y),y=e-m,a=Kv(y/this.a,l,c,h,g),s=mt(this.long0+Math.atan2(n.x,n.y),this.over),n.x=s,n.y=a,n):(_=Math.atan2(n.x,n.y),x=Math.sqrt(n.x*n.x+n.y*n.y),w=yge(this.lat0,this.long0,_,x,this.a,this.f),n.x=w.lon2,n.y=w.lat2,n))}var wge=["Azimuthal_Equidistant","aeqd"];const Ege={init:xge,forward:_ge,inverse:vge,names:wge};function Sge(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)}function bge(n){var e,t,r,i,s,a,o,l,c=n.x,h=n.y;return r=mt(c-this.long0,this.over),e=Math.sin(h),t=Math.cos(h),i=Math.cos(r),a=this.sin_p14*e+this.cos_p14*t*i,s=1,(a>0||Math.abs(a)<=ct)&&(o=this.a*s*t*Math.sin(r),l=this.y0+this.a*s*(this.cos_p14*e-this.sin_p14*t*i)),n.x=o,n.y=l,n}function Tge(n){var e,t,r,i,s,a,o;return n.x-=this.x0,n.y-=this.y0,e=Math.sqrt(n.x*n.x+n.y*n.y),t=zu(e/this.a),r=Math.sin(t),i=Math.cos(t),a=this.long0,Math.abs(e)<=ct?(o=this.lat0,n.x=a,n.y=o,n):(o=zu(i*this.sin_p14+n.y*r*this.cos_p14/e),s=Math.abs(this.lat0)-Xe,Math.abs(s)<=ct?(this.lat0>=0?a=mt(this.long0+Math.atan2(n.x,-n.y),this.over):a=mt(this.long0-Math.atan2(-n.x,n.y),this.over),n.x=a,n.y=o,n):(a=mt(this.long0+Math.atan2(n.x*r,e*this.cos_p14*i-n.y*this.sin_p14*r),this.over),n.x=a,n.y=o,n))}var Rge=["ortho"];const Age={init:Sge,forward:bge,inverse:Tge,names:Rge};var Cr={FRONT:1,RIGHT:2,BACK:3,LEFT:4,TOP:5,BOTTOM:6},Wn={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4};function kge(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=Xe-$n/2?this.face=Cr.TOP:this.lat0<=-(Xe-$n/2)?this.face=Cr.BOTTOM:Math.abs(this.long0)<=$n?this.face=Cr.FRONT:Math.abs(this.long0)<=Xe+$n?this.face=this.long0>0?Cr.RIGHT:Cr.LEFT:this.face=Cr.BACK,this.es!==0&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)}function Ige(n){var e={x:0,y:0},t,r,i,s,a,o,l={value:0};if(n.x-=this.long0,this.es!==0?t=Math.atan(this.one_minus_f_squared*Math.tan(n.y)):t=n.y,r=n.x,this.face===Cr.TOP)s=Xe-t,r>=$n&&r<=Xe+$n?(l.value=Wn.AREA_0,i=r-Xe):r>Xe+$n||r<=-(Xe+$n)?(l.value=Wn.AREA_1,i=r>0?r-Hr:r+Hr):r>-(Xe+$n)&&r<=-$n?(l.value=Wn.AREA_2,i=r+Xe):(l.value=Wn.AREA_3,i=r);else if(this.face===Cr.BOTTOM)s=Xe+t,r>=$n&&r<=Xe+$n?(l.value=Wn.AREA_0,i=-r+Xe):r<$n&&r>=-$n?(l.value=Wn.AREA_1,i=-r):r<-$n&&r>=-(Xe+$n)?(l.value=Wn.AREA_2,i=-r-Xe):(l.value=Wn.AREA_3,i=r>0?-r+Hr:-r-Hr);else{var c,h,g,m,y,_,x;this.face===Cr.RIGHT?r=S0(r,+Xe):this.face===Cr.BACK?r=S0(r,+Hr):this.face===Cr.LEFT&&(r=S0(r,-Xe)),m=Math.sin(t),y=Math.cos(t),_=Math.sin(r),x=Math.cos(r),c=y*x,h=y*_,g=m,this.face===Cr.FRONT?(s=Math.acos(c),i=zx(s,g,h,l)):this.face===Cr.RIGHT?(s=Math.acos(h),i=zx(s,g,-c,l)):this.face===Cr.BACK?(s=Math.acos(-c),i=zx(s,g,-h,l)):this.face===Cr.LEFT?(s=Math.acos(-h),i=zx(s,g,c,l)):(s=i=0,l.value=Wn.AREA_0)}return o=Math.atan(12/Hr*(i+Math.acos(Math.sin(i)*Math.cos($n))-Xe)),a=Math.sqrt((1-Math.cos(s))/(Math.cos(o)*Math.cos(o))/(1-Math.cos(Math.atan(1/Math.cos(i))))),l.value===Wn.AREA_1?o+=Xe:l.value===Wn.AREA_2?o+=Hr:l.value===Wn.AREA_3&&(o+=1.5*Hr),e.x=a*Math.cos(o),e.y=a*Math.sin(o),e.x=e.x*this.a+this.x0,e.y=e.y*this.a+this.y0,n.x=e.x,n.y=e.y,n}function Cge(n){var e={lam:0,phi:0},t,r,i,s,a,o,l,c,h,g={value:0};if(n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a,r=Math.atan(Math.sqrt(n.x*n.x+n.y*n.y)),t=Math.atan2(n.y,n.x),n.x>=0&&n.x>=Math.abs(n.y)?g.value=Wn.AREA_0:n.y>=0&&n.y>=Math.abs(n.x)?(g.value=Wn.AREA_1,t-=Xe):n.x<0&&-n.x>=Math.abs(n.y)?(g.value=Wn.AREA_2,t=t<0?t+Hr:t-Hr):(g.value=Wn.AREA_3,t+=Xe),h=Hr/12*Math.tan(t),a=Math.sin(h)/(Math.cos(h)-1/Math.sqrt(2)),o=Math.atan(a),i=Math.cos(t),s=Math.tan(r),l=1-i*i*s*s*(1-Math.cos(Math.atan(1/Math.cos(o)))),l<-1?l=-1:l>1&&(l=1),this.face===Cr.TOP)c=Math.acos(l),e.phi=Xe-c,g.value===Wn.AREA_0?e.lam=o+Xe:g.value===Wn.AREA_1?e.lam=o<0?o+Hr:o-Hr:g.value===Wn.AREA_2?e.lam=o-Xe:e.lam=o;else if(this.face===Cr.BOTTOM)c=Math.acos(l),e.phi=c-Xe,g.value===Wn.AREA_0?e.lam=-o+Xe:g.value===Wn.AREA_1?e.lam=-o:g.value===Wn.AREA_2?e.lam=-o-Xe:e.lam=o<0?-o-Hr:-o+Hr;else{var m,y,_;m=l,h=m*m,h>=1?_=0:_=Math.sqrt(1-h)*Math.sin(o),h+=_*_,h>=1?y=0:y=Math.sqrt(1-h),g.value===Wn.AREA_1?(h=y,y=-_,_=h):g.value===Wn.AREA_2?(y=-y,_=-_):g.value===Wn.AREA_3&&(h=y,y=_,_=-h),this.face===Cr.RIGHT?(h=m,m=-y,y=h):this.face===Cr.BACK?(m=-m,y=-y):this.face===Cr.LEFT&&(h=m,m=y,y=-h),e.phi=Math.acos(-_)-Xe,e.lam=Math.atan2(y,m),this.face===Cr.RIGHT?e.lam=S0(e.lam,-Xe):this.face===Cr.BACK?e.lam=S0(e.lam,-Hr):this.face===Cr.LEFT&&(e.lam=S0(e.lam,+Xe))}if(this.es!==0){var x,w,b;x=e.phi<0?1:0,w=Math.tan(e.phi),b=this.b/Math.sqrt(w*w+this.one_minus_f_squared),e.phi=Math.atan(Math.sqrt(this.a*this.a-b*b)/(this.one_minus_f*b)),x&&(e.phi=-e.phi)}return e.lam+=this.long0,n.x=e.lam,n.y=e.phi,n}function zx(n,e,t,r){var i;return n<ct?(r.value=Wn.AREA_0,i=0):(i=Math.atan2(e,t),Math.abs(i)<=$n?r.value=Wn.AREA_0:i>$n&&i<=Xe+$n?(r.value=Wn.AREA_1,i-=Xe):i>Xe+$n||i<=-(Xe+$n)?(r.value=Wn.AREA_2,i=i>=0?i-Hr:i+Hr):(r.value=Wn.AREA_3,i+=Xe)),i}function S0(n,e){var t=n+e;return t<-Hr?t+=t1:t>+Hr&&(t-=t1),t}var Pge=["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"];const Nge={init:kge,forward:Ige,inverse:Cge,names:Pge};var OR=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-986701e-12],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,18736e-12],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,934959e-12],[.7986,-.00755338,-500009e-10,935324e-12],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],Dm=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-126793e-14,422642e-15],[.124,.0124,507171e-14,-160604e-14],[.186,.0123999,-190189e-13,600152e-14],[.248,.0124002,710039e-13,-224e-10],[.31,.0123992,-264997e-12,835986e-13],[.372,.0124029,988983e-12,-311994e-12],[.434,.0123893,-369093e-11,-435621e-12],[.4958,.0123198,-102252e-10,-345523e-12],[.5571,.0121916,-154081e-10,-582288e-12],[.6176,.0119938,-241424e-10,-525327e-12],[.6769,.011713,-320223e-10,-516405e-12],[.7346,.0113541,-397684e-10,-609052e-12],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-140374e-14],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],WV=.8487,HV=1.3523,KV=Bs/5,Mge=1/KV,u0=18,Xv=function(n,e){return n[0]+e*(n[1]+e*(n[2]+e*n[3]))},Lge=function(n,e){return n[1]+e*(2*n[2]+e*3*n[3])};function Oge(n,e,t,r){for(var i=e;r;--r){var s=n(i);if(i-=s,Math.abs(s)<t)break}return i}function Dge(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"}function jge(n){var e=mt(n.x-this.long0,this.over),t=Math.abs(n.y),r=Math.floor(t*KV);r<0?r=0:r>=u0&&(r=u0-1),t=Bs*(t-Mge*r);var i={x:Xv(OR[r],t)*e,y:Xv(Dm[r],t)};return n.y<0&&(i.y=-i.y),i.x=i.x*this.a*WV+this.x0,i.y=i.y*this.a*HV+this.y0,i}function Fge(n){var e={x:(n.x-this.x0)/(this.a*WV),y:Math.abs(n.y-this.y0)/(this.a*HV)};if(e.y>=1)e.x/=OR[u0][0],e.y=n.y<0?-Xe:Xe;else{var t=Math.floor(e.y*u0);for(t<0?t=0:t>=u0&&(t=u0-1);;)if(Dm[t][0]>e.y)--t;else if(Dm[t+1][0]<=e.y)++t;else break;var r=Dm[t],i=5*(e.y-r[0])/(Dm[t+1][0]-r[0]);i=Oge(function(s){return(Xv(r,s)-e.y)/Lge(r,s)},i,ct,100),e.x/=Xv(OR[t],i),e.y=(5*t+i)*Dr,n.y<0&&(e.y=-e.y)}return e.x=mt(e.x+this.long0,this.over),e}var Vge=["Robinson","robin"];const Bge={init:Dge,forward:jge,inverse:Fge,names:Vge};function Gge(){this.name="geocent"}function zge(n){var e=LV(n,this.es,this.a);return e}function Uge(n){var e=OV(n,this.es,this.a,this.b);return e}var $ge=["Geocentric","geocentric","geocent","Geocent"];const Wge={init:Gge,forward:zge,inverse:Uge,names:$ge};var os={N_POLE:0,S_POLE:1,EQUIT:2,OBLIQ:3},vm={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};function Hge(){if(Object.keys(vm).forEach((function(t){if(typeof this[t]>"u")this[t]=vm[t].def;else{if(vm[t].num&&isNaN(this[t]))throw new Error("Invalid parameter value, must be numeric "+t+" = "+this[t]);vm[t].num&&(this[t]=parseFloat(this[t]))}vm[t].degrees&&(this[t]=this[t]*Dr)}).bind(this)),Math.abs(Math.abs(this.lat0)-Xe)<ct?this.mode=this.lat0<0?os.S_POLE:os.N_POLE:Math.abs(this.lat0)<ct?this.mode=os.EQUIT:(this.mode=os.OBLIQ,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var n=this.tilt,e=this.azi;this.cg=Math.cos(e),this.sg=Math.sin(e),this.cw=Math.cos(n),this.sw=Math.sin(n)}function Kge(n){n.x-=this.long0;var e=Math.sin(n.y),t=Math.cos(n.y),r=Math.cos(n.x),i,s;switch(this.mode){case os.OBLIQ:s=this.sinph0*e+this.cosph0*t*r;break;case os.EQUIT:s=t*r;break;case os.S_POLE:s=-e;break;case os.N_POLE:s=e;break}switch(s=this.pn1/(this.p-s),i=s*t*Math.sin(n.x),this.mode){case os.OBLIQ:s*=this.cosph0*e-this.sinph0*t*r;break;case os.EQUIT:s*=e;break;case os.N_POLE:s*=-(t*r);break;case os.S_POLE:s*=t*r;break}var a,o;return a=s*this.cg+i*this.sg,o=1/(a*this.sw*this.h1+this.cw),i=(i*this.cg-s*this.sg)*this.cw*o,s=a*o,n.x=i*this.a,n.y=s*this.a,n}function Xge(n){n.x/=this.a,n.y/=this.a;var e={x:n.x,y:n.y},t,r,i;i=1/(this.pn1-n.y*this.sw),t=this.pn1*n.x*i,r=this.pn1*n.y*this.cw*i,n.x=t*this.cg+r*this.sg,n.y=r*this.cg-t*this.sg;var s=Fs(n.x,n.y);if(Math.abs(s)<ct)e.x=0,e.y=n.y;else{var a,o;switch(o=1-s*s*this.pfact,o=(this.p-Math.sqrt(o))/(this.pn1/s+s/this.pn1),a=Math.sqrt(1-o*o),this.mode){case os.OBLIQ:e.y=Math.asin(a*this.sinph0+n.y*o*this.cosph0/s),n.y=(a-this.sinph0*Math.sin(e.y))*s,n.x*=o*this.cosph0;break;case os.EQUIT:e.y=Math.asin(n.y*o/s),n.y=a*s,n.x*=o;break;case os.N_POLE:e.y=Math.asin(a),n.y=-n.y;break;case os.S_POLE:e.y=-Math.asin(a);break}e.x=Math.atan2(n.x,n.y)}return n.x=e.x+this.long0,n.y=e.y,n}var qge=["Tilted_Perspective","tpers"];const Yge={init:Hge,forward:Kge,inverse:Xge,names:qge};function Zge(){if(this.flip_axis=this.sweep==="x"?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,this.es!==0){var n=1-this.es,e=1/n;this.radius_p=Math.sqrt(n),this.radius_p2=n,this.radius_p_inv2=e,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")}function Jge(n){var e=n.x,t=n.y,r,i,s,a;if(e=e-this.long0,this.shape==="ellipse"){t=Math.atan(this.radius_p2*Math.tan(t));var o=this.radius_p/Fs(this.radius_p*Math.cos(t),Math.sin(t));if(i=o*Math.cos(e)*Math.cos(t),s=o*Math.sin(e)*Math.cos(t),a=o*Math.sin(t),(this.radius_g-i)*i-s*s-a*a*this.radius_p_inv2<0)return n.x=Number.NaN,n.y=Number.NaN,n;r=this.radius_g-i,this.flip_axis?(n.x=this.radius_g_1*Math.atan(s/Fs(a,r)),n.y=this.radius_g_1*Math.atan(a/r)):(n.x=this.radius_g_1*Math.atan(s/r),n.y=this.radius_g_1*Math.atan(a/Fs(s,r)))}else this.shape==="sphere"&&(r=Math.cos(t),i=Math.cos(e)*r,s=Math.sin(e)*r,a=Math.sin(t),r=this.radius_g-i,this.flip_axis?(n.x=this.radius_g_1*Math.atan(s/Fs(a,r)),n.y=this.radius_g_1*Math.atan(a/r)):(n.x=this.radius_g_1*Math.atan(s/r),n.y=this.radius_g_1*Math.atan(a/Fs(s,r))));return n.x=n.x*this.a,n.y=n.y*this.a,n}function Qge(n){var e=-1,t=0,r=0,i,s,a,o;if(n.x=n.x/this.a,n.y=n.y/this.a,this.shape==="ellipse"){this.flip_axis?(r=Math.tan(n.y/this.radius_g_1),t=Math.tan(n.x/this.radius_g_1)*Fs(1,r)):(t=Math.tan(n.x/this.radius_g_1),r=Math.tan(n.y/this.radius_g_1)*Fs(1,t));var l=r/this.radius_p;if(i=t*t+l*l+e*e,s=2*this.radius_g*e,a=s*s-4*i*this.C,a<0)return n.x=Number.NaN,n.y=Number.NaN,n;o=(-s-Math.sqrt(a))/(2*i),e=this.radius_g+o*e,t*=o,r*=o,n.x=Math.atan2(t,e),n.y=Math.atan(r*Math.cos(n.x)/e),n.y=Math.atan(this.radius_p_inv2*Math.tan(n.y))}else if(this.shape==="sphere"){if(this.flip_axis?(r=Math.tan(n.y/this.radius_g_1),t=Math.tan(n.x/this.radius_g_1)*Math.sqrt(1+r*r)):(t=Math.tan(n.x/this.radius_g_1),r=Math.tan(n.y/this.radius_g_1)*Math.sqrt(1+t*t)),i=t*t+r*r+e*e,s=2*this.radius_g*e,a=s*s-4*i*this.C,a<0)return n.x=Number.NaN,n.y=Number.NaN,n;o=(-s-Math.sqrt(a))/(2*i),e=this.radius_g+o*e,t*=o,r*=o,n.x=Math.atan2(t,e),n.y=Math.atan(r*Math.cos(n.x)/e)}return n.x=n.x+this.long0,n}var eme=["Geostationary Satellite View","Geostationary_Satellite","geos"];const tme={init:Zge,forward:Jge,inverse:Qge,names:eme};var rp=1.340264,ip=-.081106,sp=893e-6,ap=.003796,qv=Math.sqrt(3)/2;function nme(){this.es=0,this.long0=this.long0!==void 0?this.long0:0,this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0}function rme(n){var e=mt(n.x-this.long0,this.over),t=n.y,r=Math.asin(qv*Math.sin(t)),i=r*r,s=i*i*i;return n.x=e*Math.cos(r)/(qv*(rp+3*ip*i+s*(7*sp+9*ap*i))),n.y=r*(rp+ip*i+s*(sp+ap*i)),n.x=this.a*n.x+this.x0,n.y=this.a*n.y+this.y0,n}function ime(n){n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a;var e=1e-9,t=12,r=n.y,i,s,a,o,l,c;for(c=0;c<t&&(i=r*r,s=i*i*i,a=r*(rp+ip*i+s*(sp+ap*i))-n.y,o=rp+3*ip*i+s*(7*sp+9*ap*i),r-=l=a/o,!(Math.abs(l)<e));++c);return i=r*r,s=i*i*i,n.x=qv*n.x*(rp+3*ip*i+s*(7*sp+9*ap*i))/Math.cos(r),n.y=Math.asin(Math.sin(r)/qv),n.x=mt(n.x+this.long0,this.over),n}var sme=["eqearth","Equal Earth","Equal_Earth"];const ame={init:nme,forward:rme,inverse:ime,names:sme};var i1=1e-10;function ome(){var n;if(this.phi1=this.lat1,Math.abs(this.phi1)<i1)throw new Error;this.es?(this.en=UI(this.es),this.m1=xg(this.phi1,this.am1=Math.sin(this.phi1),n=Math.cos(this.phi1),this.en),this.am1=n/(Math.sqrt(1-this.es*this.am1*this.am1)*this.am1),this.inverse=cme,this.forward=lme):(Math.abs(this.phi1)+i1>=Xe?this.cphi1=0:this.cphi1=1/Math.tan(this.phi1),this.inverse=hme,this.forward=ume)}function lme(n){var e=mt(n.x-(this.long0||0),this.over),t=n.y,r,i,s;return r=this.am1+this.m1-xg(t,i=Math.sin(t),s=Math.cos(t),this.en),i=s*e/(r*Math.sqrt(1-this.es*i*i)),n.x=r*Math.sin(i),n.y=this.am1-r*Math.cos(i),n.x=this.a*n.x+(this.x0||0),n.y=this.a*n.y+(this.y0||0),n}function cme(n){n.x=(n.x-(this.x0||0))/this.a,n.y=(n.y-(this.y0||0))/this.a;var e,t,r,i;if(t=Fs(n.x,n.y=this.am1-n.y),i=$I(this.am1+this.m1-t,this.es,this.en),(e=Math.abs(i))<Xe)e=Math.sin(i),r=t*Math.atan2(n.x,n.y)*Math.sqrt(1-this.es*e*e)/Math.cos(i);else if(Math.abs(e-Xe)<=i1)r=0;else throw new Error;return n.x=mt(r+(this.long0||0),this.over),n.y=Zu(i),n}function ume(n){var e=mt(n.x-(this.long0||0),this.over),t=n.y,r,i;return i=this.cphi1+this.phi1-t,Math.abs(i)>i1?(n.x=i*Math.sin(r=e*Math.cos(t)/i),n.y=this.cphi1-i*Math.cos(r)):n.x=n.y=0,n.x=this.a*n.x+(this.x0||0),n.y=this.a*n.y+(this.y0||0),n}function hme(n){n.x=(n.x-(this.x0||0))/this.a,n.y=(n.y-(this.y0||0))/this.a;var e,t,r=Fs(n.x,n.y=this.cphi1-n.y);if(t=this.cphi1+this.phi1-r,Math.abs(t)>Xe)throw new Error;return Math.abs(Math.abs(t)-Xe)<=i1?e=0:e=r*Math.atan2(n.x,n.y)/Math.cos(t),n.x=mt(e+(this.long0||0),this.over),n.y=Zu(t),n}var dme=["bonne","Bonne (Werner lat_1=90)"];const fme={init:ome,names:dme},lO={OBLIQUE:{forward:xme,inverse:vme},TRANSVERSE:{forward:_me,inverse:wme}},Yv={ROTATE:{o_alpha:"oAlpha",o_lon_c:"oLongC",o_lat_c:"oLatC"},NEW_POLE:{o_lat_p:"oLatP",o_lon_p:"oLongP"},NEW_EQUATOR:{o_lon_1:"oLong1",o_lat_1:"oLat1",o_lon_2:"oLong2",o_lat_2:"oLat2"}};function gme(){if(this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.title=this.title||"General Oblique Transformation",this.isIdentity=CV.includes(this.o_proj),!this.o_proj)throw new Error("Missing parameter: o_proj");if(this.o_proj==="ob_tran")throw new Error("Invalid value for o_proj: "+this.o_proj);const n=this.projStr.replace("+proj=ob_tran","").replace("+o_proj=","+proj=").trim(),e=Ba(n);if(!e)throw new Error("Invalid parameter: o_proj. Unknown projection "+this.o_proj);e.long0=0,this.obliqueProjection=e;let t;const r=Object.keys(Yv),i=o=>{if(typeof this[o]>"u")return;const l=parseFloat(this[o])*Dr;if(isNaN(l))throw new Error("Invalid value for "+o+": "+this[o]);return l};for(let o=0;o<r.length;o++){const l=r[o],c=Yv[l],h=Object.entries(c);if(h.some(([m])=>typeof this[m]<"u")){t=c;for(let m=0;m<h.length;m++){const[y,_]=h[m],x=i(y);if(typeof x>"u")throw new Error("Missing parameter: "+y+".");this[_]=x}break}}if(!t)throw new Error("No valid parameters provided for ob_tran projection.");const{lamp:s,phip:a}=yme(this,t);this.lamp=s,Math.abs(a)>ct?(this.cphip=Math.cos(a),this.sphip=Math.sin(a),this.projectionType=lO.OBLIQUE):this.projectionType=lO.TRANSVERSE}function mme(n){return this.projectionType.forward(this,n)}function pme(n){return this.projectionType.inverse(this,n)}function yme(n,e){let t,r;if(e===Yv.ROTATE){let i=n.oLongC,s=n.oLatC,a=n.oAlpha;if(Math.abs(Math.abs(s)-Xe)<=ct)throw new Error("Invalid value for o_lat_c: "+n.o_lat_c+" should be < 90");r=i+Math.atan2(-1*Math.cos(a),-1*Math.sin(a)*Math.sin(s)),t=Math.asin(Math.cos(s)*Math.sin(a))}else if(e===Yv.NEW_POLE)r=n.oLongP,t=n.oLatP;else{let i=n.oLong1,s=n.oLat1,a=n.oLong2,o=n.oLat2,l=Math.abs(s);if(Math.abs(s)>Xe-ct)throw new Error("Invalid value for o_lat_1: "+n.o_lat_1+" should be < 90");if(Math.abs(o)>Xe-ct)throw new Error("Invalid value for o_lat_2: "+n.o_lat_2+" should be < 90");if(Math.abs(s-o)<ct)throw new Error("Invalid value for o_lat_1 and o_lat_2: o_lat_1 should be different from o_lat_2");if(l<ct)throw new Error("Invalid value for o_lat_1: o_lat_1 should be different from zero");r=Math.atan2(Math.cos(s)*Math.sin(o)*Math.cos(i)-Math.sin(s)*Math.cos(o)*Math.cos(a),Math.sin(s)*Math.cos(o)*Math.sin(a)-Math.cos(s)*Math.sin(o)*Math.sin(i)),t=Math.atan(-1*Math.cos(r-i)/Math.tan(s))}return{lamp:r,phip:t}}function xme(n,e){let{x:t,y:r}=e;t+=n.long0;const i=Math.cos(t),s=Math.sin(r),a=Math.cos(r);e.x=mt(Math.atan2(a*Math.sin(t),n.sphip*a*i+n.cphip*s)+n.lamp),e.y=Math.asin(n.sphip*s-n.cphip*a*i);const o=n.obliqueProjection.forward(e);return n.isIdentity&&(o.x*=Bs,o.y*=Bs),o}function _me(n,e){let{x:t,y:r}=e;t+=n.long0;const i=Math.cos(r),s=Math.cos(t);e.x=mt(Math.atan2(i*Math.sin(t),Math.sin(r))+n.lamp),e.y=Math.asin(-1*i*s);const a=n.obliqueProjection.forward(e);return n.isIdentity&&(a.x*=Bs,a.y*=Bs),a}function vme(n,e){n.isIdentity&&(e.x*=Dr,e.y*=Dr);const t=n.obliqueProjection.inverse(e);let{x:r,y:i}=t;if(r<Number.MAX_VALUE){r-=n.lamp;const s=Math.cos(r),a=Math.sin(i),o=Math.cos(i);e.x=Math.atan2(o*Math.sin(r),n.sphip*o*s-n.cphip*a),e.y=Math.asin(n.sphip*a+n.cphip*o*s)}return e.x=mt(e.x+n.long0),e}function wme(n,e){n.isIdentity&&(e.x*=Dr,e.y*=Dr);const t=n.obliqueProjection.inverse(e);let{x:r,y:i}=t;if(r<Number.MAX_VALUE){const s=Math.cos(i);r-=n.lamp,e.x=Math.atan2(s*Math.sin(r),-1*Math.sin(i)),e.y=Math.asin(s*Math.cos(r))}return e.x=mt(e.x+n.long0),e}var Eme=["General Oblique Transformation","General_Oblique_Transformation","ob_tran"];const Sme={init:gme,forward:mme,inverse:pme,names:Eme};function bme(n){n.Proj.projections.add(T_),n.Proj.projections.add(R_),n.Proj.projections.add(dfe),n.Proj.projections.add(wfe),n.Proj.projections.add(Rfe),n.Proj.projections.add(Pfe),n.Proj.projections.add(jfe),n.Proj.projections.add(zfe),n.Proj.projections.add(Kfe),n.Proj.projections.add(Jfe),n.Proj.projections.add(h0e),n.Proj.projections.add(y0e),n.Proj.projections.add(E0e),n.Proj.projections.add(k0e),n.Proj.projections.add(M0e),n.Proj.projections.add(F0e),n.Proj.projections.add(U0e),n.Proj.projections.add(X0e),n.Proj.projections.add(ege),n.Proj.projections.add(sge),n.Proj.projections.add(uge),n.Proj.projections.add(mge),n.Proj.projections.add(Ege),n.Proj.projections.add(Age),n.Proj.projections.add(Nge),n.Proj.projections.add(Bge),n.Proj.projections.add(Wge),n.Proj.projections.add(Yge),n.Proj.projections.add(tme),n.Proj.projections.add(ame),n.Proj.projections.add(fme),n.Proj.projections.add(Sme)}const Tn=Object.assign(Ide,{defaultDatum:"WGS84",Proj:Ba,WGS84:new Ba("WGS84"),Point:tg,toPoint:DV,defs:Vi,nadgrid:hde,transform:Hv,mgrs:Cde,version:"__VERSION__"});bme(Tn);class XV{constructor(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.featureClass=vr,this.supportedMediaTypes=null}getReadOptions(e,t){if(t){let r=t.dataProjection?ir(t.dataProjection):this.readProjection(e);t.extent&&r&&r.getUnits()==="tile-pixels"&&(r=ir(r),r.setWorldExtent(t.extent)),t={dataProjection:r,featureProjection:t.featureProjection}}return this.adaptOptions(t)}adaptOptions(e){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection,featureClass:this.featureClass},e)}getType(){return Xt()}readFeature(e,t){return Xt()}readFeatures(e,t){return Xt()}readGeometry(e,t){return Xt()}readProjection(e){return Xt()}writeFeature(e,t){return Xt()}writeFeatures(e,t){return Xt()}writeGeometry(e,t){return Xt()}}function To(n,e,t){const r=t?ir(t.featureProjection):null,i=t?ir(t.dataProjection):null;let s=n;if(r&&i&&!Zh(r,i)){e&&(s=n.clone());const a=e?r:i,o=e?i:r;a.getUnits()==="tile-pixels"?s.transform(a,o):s.applyTransform(vp(a,o))}if(e&&t&&t.decimals!==void 0){const a=Math.pow(10,t.decimals),o=function(l){for(let c=0,h=l.length;c<h;++c)l[c]=Math.round(l[c]*a)/a;return l};s===n&&(s=n.clone()),s.applyTransform(o)}return s}const Tme={Point:mi,LineString:bi,Polygon:Ua,MultiPoint:Nd,MultiLineString:ic,MultiPolygon:cd};function Rme(n,e,t){return Array.isArray(e[0])?(uj(n,0,e,t)||(n=n.slice(),gT(n,0,e,t)),n):(yA(n,0,e,t)||(n=n.slice(),z_(n,0,e,t)),n)}function qV(n,e){const t=n.geometry;if(!t)return[];if(Array.isArray(t))return t.map(s=>qV({...n,geometry:s})).flat();const r=t.type==="MultiPolygon"?"Polygon":t.type;if(r==="GeometryCollection"||r==="Circle")throw new Error("Unsupported geometry type: "+r);const i=t.layout.length;return To(new Ds(r,r==="Polygon"?Rme(t.flatCoordinates,t.ends,i):t.flatCoordinates,t.ends?.flat(),i,n.properties||{},n.id).enableSimplifyTransformed(),!1,e)}function YI(n,e){if(!n)return null;if(Array.isArray(n)){const r=n.map(i=>YI(i,e));return new po(r)}const t=Tme[n.type];return To(new t(n.flatCoordinates,n.layout||"XY",n.ends),!1,e)}class Ame extends XV{constructor(){super()}getType(){return"json"}readFeature(e,t){return this.readFeatureFromObject(Ux(e),this.getReadOptions(e,t))}readFeatures(e,t){return this.readFeaturesFromObject(Ux(e),this.getReadOptions(e,t))}readFeatureFromObject(e,t){return Xt()}readFeaturesFromObject(e,t){return Xt()}readGeometry(e,t){return this.readGeometryFromObject(Ux(e),this.getReadOptions(e,t))}readGeometryFromObject(e,t){return Xt()}readProjection(e){return this.readProjectionFromObject(Ux(e))}readProjectionFromObject(e){return Xt()}writeFeature(e,t){return JSON.stringify(this.writeFeatureObject(e,t))}writeFeatureObject(e,t){return Xt()}writeFeatures(e,t){return JSON.stringify(this.writeFeaturesObject(e,t))}writeFeaturesObject(e,t){return Xt()}writeGeometry(e,t){return JSON.stringify(this.writeGeometryObject(e,t))}writeGeometryObject(e,t){return Xt()}}function Ux(n){if(typeof n=="string"){const e=JSON.parse(n);return e||null}return n!==null?n:null}class IE extends Ame{constructor(e){e=e||{},super(),this.dataProjection=ir(e.dataProjection?e.dataProjection:"EPSG:4326"),e.featureProjection&&(this.defaultFeatureProjection=ir(e.featureProjection)),e.featureClass&&(this.featureClass=e.featureClass),this.geometryName_=e.geometryName,this.extractGeometryName_=e.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(e,t){let r=null;e.type==="Feature"?r=e:r={type:"Feature",geometry:e,properties:null};const i=ZI(r.geometry);if(this.featureClass===Ds)return qV({geometry:i,id:r.id,properties:r.properties},t);const s=new vr;return this.geometryName_?s.setGeometryName(this.geometryName_):this.extractGeometryName_&&r.geometry_name&&s.setGeometryName(r.geometry_name),s.setGeometry(YI(i,t)),"id"in r&&s.setId(r.id),r.properties&&s.setProperties(r.properties,!0),s}readFeaturesFromObject(e,t){const r=e;let i=null;if(r.type==="FeatureCollection"){const s=e;i=[];const a=s.features;for(let o=0,l=a.length;o<l;++o){const c=this.readFeatureFromObject(a[o],t);c&&i.push(c)}}else i=[this.readFeatureFromObject(e,t)];return i.flat()}readGeometryFromObject(e,t){return kme(e,t)}readProjectionFromObject(e){const t=e.crs;let r;if(t)if(t.type=="name")r=ir(t.properties.name);else if(t.type==="EPSG")r=ir("EPSG:"+t.properties.code);else throw new Error("Unknown SRS type");else r=this.dataProjection;return r}writeFeatureObject(e,t){t=this.adaptOptions(t);const r={type:"Feature",geometry:null,properties:null},i=e.getId();if(i!==void 0&&(r.id=i),!e.hasProperties())return r;const s=e.getProperties(),a=e.getGeometry();return a&&(r.geometry=DR(a,t),delete s[e.getGeometryName()]),id(s)||(r.properties=s),r}writeFeaturesObject(e,t){t=this.adaptOptions(t);const r=[];for(let i=0,s=e.length;i<s;++i)r.push(this.writeFeatureObject(e[i],t));return{type:"FeatureCollection",features:r}}writeGeometryObject(e,t){return DR(e,this.adaptOptions(t))}}function ZI(n,e){if(!n)return null;let t;switch(n.type){case"Point":{t=Cme(n);break}case"LineString":{t=Pme(n);break}case"Polygon":{t=Ome(n);break}case"MultiPoint":{t=Mme(n);break}case"MultiLineString":{t=Nme(n);break}case"MultiPolygon":{t=Lme(n);break}case"GeometryCollection":{t=Ime(n);break}default:throw new Error("Unsupported GeoJSON type: "+n.type)}return t}function kme(n,e){const t=ZI(n);return YI(t,e)}function Ime(n,e){return n.geometries.map(function(r){return ZI(r)})}function Cme(n){const e=n.coordinates;return{type:"Point",flatCoordinates:e,layout:Pd(e.length)}}function Pme(n){const e=n.coordinates,t=e.flat();return{type:"LineString",flatCoordinates:t,ends:[t.length],layout:Pd(e[0]?.length||2)}}function Nme(n){const e=n.coordinates,t=e[0]?.[0]?.length||2,r=[],i=v1(r,0,e,t);return{type:"MultiLineString",flatCoordinates:r,ends:i,layout:Pd(t)}}function Mme(n){const e=n.coordinates;return{type:"MultiPoint",flatCoordinates:e.flat(),layout:Pd(e[0]?.length||2)}}function Lme(n){const e=n.coordinates,t=[],r=e[0]?.[0]?.[0].length||2,i=BD(t,0,e,r);return{type:"MultiPolygon",flatCoordinates:t,ends:i,layout:Pd(r)}}function Ome(n){const e=n.coordinates,t=[],r=e[0]?.[0]?.length,i=v1(t,0,e,r);return{type:"Polygon",flatCoordinates:t,ends:i,layout:Pd(r)}}function DR(n,e){n=To(n,!0,e);const t=n.getType();let r;switch(t){case"Point":{r=Gme(n);break}case"LineString":{r=jme(n);break}case"Polygon":{r=zme(n,e);break}case"MultiPoint":{r=Vme(n);break}case"MultiLineString":{r=Fme(n);break}case"MultiPolygon":{r=Bme(n,e);break}case"GeometryCollection":{r=Dme(n,e);break}case"Circle":{r={type:"GeometryCollection",geometries:[]};break}default:throw new Error("Unsupported geometry type: "+t)}return r}function Dme(n,e){return e=Object.assign({},e),delete e.featureProjection,{type:"GeometryCollection",geometries:n.getGeometriesArray().map(function(r){return DR(r,e)})}}function jme(n,e){return{type:"LineString",coordinates:n.getCoordinates()}}function Fme(n,e){return{type:"MultiLineString",coordinates:n.getCoordinates()}}function Vme(n,e){return{type:"MultiPoint",coordinates:n.getCoordinates()}}function Bme(n,e){let t;return e&&(t=e.rightHanded),{type:"MultiPolygon",coordinates:n.getCoordinates(t)}}function Gme(n,e){return{type:"Point",coordinates:n.getCoordinates()}}function zme(n,e){let t;return e&&(t=e.rightHanded),{type:"Polygon",coordinates:n.getCoordinates(t)}}const Zv="http://www.w3.org/2001/XMLSchema-instance";function Vd(n,e){return _g().createElementNS(n,e)}function Ro(n,e){return YV(n,e,[]).join("")}function YV(n,e,t){if(n.nodeType==Node.CDATA_SECTION_NODE||n.nodeType==Node.TEXT_NODE)t.push(n.nodeValue);else{let r;for(r=n.firstChild;r;r=r.nextSibling)YV(r,e,t)}return t}function Wl(n){return"documentElement"in n}function Hl(n){return new DOMParser().parseFromString(n,"application/xml")}function cO(n,e){return(function(t,r){const i=n.call(e??this,t,r);if(i!==void 0){const s=r[r.length-1];Un(s,i)}})}function uo(n,e){return(function(t,r){const i=n.call(e??this,t,r);i!==void 0&&r[r.length-1].push(i)})}function JI(n,e){return(function(t,r){const i=n.call(this,t,r);i!==void 0&&(r[r.length-1]=i)})}function Ue(n,e,t){return(function(r,i){const s=n.call(this,r,i);if(s!==void 0){const a=i[i.length-1],o=e!==void 0?e:r.localName;a[o]=s}})}function rt(n,e){return(function(t,r,i){n.call(this,t,r,i),i[i.length-1].node.appendChild(t)})}function ZV(n,e){let t,r;return function(i,s,a){if(t===void 0){t={};const o={};o[i.localName]=n,t[i.namespaceURI]=o,r=Ao(i.localName)}JV(t,r,s,a)}}function Ao(n,e){return(function(t,r,i){const a=r[r.length-1].node;let o=n;o===void 0&&(o=i);const l=a.namespaceURI;return Vd(l,o)})}const fs=Ao();function Ws(n,e){const t=e.length,r=new Array(t);for(let i=0;i<t;++i)r[i]=n[e[i]];return r}function gt(n,e,t){t=t!==void 0?t:{};let r,i;for(r=0,i=n.length;r<i;++r)t[n[r]]=e;return t}function Ju(n,e,t,r){let i;for(i=e.firstElementChild;i;i=i.nextElementSibling){const s=n[i.namespaceURI];if(s!==void 0){const a=s[i.localName];a!==void 0&&a.call(r,i,t)}}}function wn(n,e,t,r,i){return r.push(n),Ju(e,t,r,i),r.pop()}function JV(n,e,t,r,i,s){const a=(i!==void 0?i:t).length;let o,l;for(let c=0;c<a;++c)o=t[c],o!==void 0&&(l=e.call(s,o,r,i!==void 0?i[c]:void 0),l!==void 0&&n[l.namespaceURI][l.localName].call(s,l,o,r))}function lr(n,e,t,r,i,s,a){return i.push(n),JV(e,t,r,i,s,a),i.pop()}let Lb;function Ume(){return Lb===void 0&&typeof XMLSerializer<"u"&&(Lb=new XMLSerializer),Lb}let Ob;function _g(){return Ob===void 0&&typeof document<"u"&&(Ob=document.implementation.createDocument("","",null)),Ob}class QV extends XV{constructor(){super(),this.xmlSerializer_=Ume()}getType(){return"xml"}readFeature(e,t){if(!e)return null;if(typeof e=="string"){const r=Hl(e);return this.readFeatureFromDocument(r,t)}return Wl(e)?this.readFeatureFromDocument(e,t):this.readFeatureFromNode(e,t)}readFeatureFromDocument(e,t){const r=this.readFeaturesFromDocument(e,t);return r.length>0?r[0]:null}readFeatureFromNode(e,t){return null}readFeatures(e,t){if(!e)return[];if(typeof e=="string"){const r=Hl(e);return this.readFeaturesFromDocument(r,t)}return Wl(e)?this.readFeaturesFromDocument(e,t):this.readFeaturesFromNode(e,t)}readFeaturesFromDocument(e,t){const r=[];for(let i=e.firstChild;i;i=i.nextSibling)i.nodeType==Node.ELEMENT_NODE&&Un(r,this.readFeaturesFromNode(i,t));return r}readFeaturesFromNode(e,t){return Xt()}readGeometry(e,t){if(!e)return null;if(typeof e=="string"){const r=Hl(e);return this.readGeometryFromDocument(r,t)}return Wl(e)?this.readGeometryFromDocument(e,t):this.readGeometryFromNode(e,t)}readGeometryFromDocument(e,t){return null}readGeometryFromNode(e,t){return null}readProjection(e){if(!e)return null;if(typeof e=="string"){const t=Hl(e);return this.readProjectionFromDocument(t)}return Wl(e)?this.readProjectionFromDocument(e):this.readProjectionFromNode(e)}readProjectionFromDocument(e){return this.dataProjection}readProjectionFromNode(e){return this.dataProjection}writeFeature(e,t){const r=this.writeFeatureNode(e,t);return this.xmlSerializer_.serializeToString(r)}writeFeatureNode(e,t){return null}writeFeatures(e,t){const r=this.writeFeaturesNode(e,t);return this.xmlSerializer_.serializeToString(r)}writeFeaturesNode(e,t){return null}writeGeometry(e,t){const r=this.writeGeometryNode(e,t);return this.xmlSerializer_.serializeToString(r)}writeGeometryNode(e,t){return null}}function Uu(n){const e=Ro(n,!1);return $me(e)}function $me(n){const e=/^\s*(true|1)|(false|0)\s*$/.exec(n);if(e)return e[1]!==void 0||!1}function CE(n){const e=Ro(n,!1),t=Date.parse(e);return isNaN(t)?void 0:t/1e3}function Ln(n){const e=Ro(n,!1);return Wme(e)}function Wme(n){const e=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*$/i.exec(n);if(e)return parseFloat(e[1])}function s1(n){const e=Ro(n,!1);return Hme(e)}function Hme(n){const e=/^\s*(\d+)\s*$/.exec(n);if(e)return parseInt(e[1],10)}function un(n){return Ro(n,!1).trim()}function ng(n,e){Vn(n,e?"1":"0")}function Kme(n,e){n.appendChild(_g().createCDATASection(e))}function Xme(n,e){const t=new Date(e*1e3),r=t.getUTCFullYear()+"-"+om(t.getUTCMonth()+1,2)+"-"+om(t.getUTCDate(),2)+"T"+om(t.getUTCHours(),2)+":"+om(t.getUTCMinutes(),2)+":"+om(t.getUTCSeconds(),2)+"Z";n.appendChild(_g().createTextNode(r))}function Ms(n,e){const t=e.toPrecision();n.appendChild(_g().createTextNode(t))}function Jv(n,e){const t=e.toString();n.appendChild(_g().createTextNode(t))}const qme=/^\s/,Yme=/\s$/,Zme=/(\n|\t|\r|<|&| {2})/;function Vn(n,e){typeof e=="string"&&(qme.test(e)||Yme.test(e)||Zme.test(e))?e.split("]]>").forEach((t,r,i)=>{r<i.length-1&&(t+="]]"),r>0&&(t=">"+t),Kme(n,t)}):n.appendChild(_g().createTextNode(e))}const gr=[null,"http://www.topografix.com/GPX/1/0","http://www.topografix.com/GPX/1/1"],Jme="http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd",Qme={rte:eB,trk:tB,wpt:nB},epe=gt(gr,{rte:uo(eB),trk:uo(tB),wpt:uo(nB)}),tpe=gt(gr,{text:Ue(un,"linkText"),type:Ue(un,"linkType")}),npe=gt(gr,{name:Ue(un),email:Ipe,link:ry}),rpe=gt(gr,{name:Ue(un),desc:Ue(un),author:Ue(Rpe),copyright:Ue(Ape),link:ry,time:Ue(CE),keywords:Ue(un),bounds:kpe,extensions:PE}),ipe=gt(gr,{year:Ue(s1),license:Ue(un)}),spe=gt(gr,{rte:rt(Mpe),trk:rt(Lpe),wpt:rt(Dpe)});class ape extends QV{constructor(e){super(),e=e||{},this.dataProjection=ir("EPSG:4326"),this.readExtensions_=e.readExtensions}handleReadExtensions_(e){e||(e=[]);for(let t=0,r=e.length;t<r;++t){const i=e[t];if(this.readExtensions_){const s=i.get("extensionsNode_")||null;this.readExtensions_(i,s)}i.set("extensionsNode_",void 0)}}readMetadata(e){return e?typeof e=="string"?this.readMetadataFromDocument(Hl(e)):Wl(e)?this.readMetadataFromDocument(e):this.readMetadataFromNode(e):null}readMetadataFromDocument(e){for(let t=e.firstChild;t;t=t.nextSibling)if(t.nodeType===Node.ELEMENT_NODE){const r=this.readMetadataFromNode(t);if(r)return r}return null}readMetadataFromNode(e){if(!gr.includes(e.namespaceURI))return null;for(let t=e.firstElementChild;t;t=t.nextElementSibling)if(gr.includes(t.namespaceURI)&&t.localName==="metadata")return wn({},rpe,t,[]);return null}readFeatureFromNode(e,t){if(!gr.includes(e.namespaceURI))return null;const r=Qme[e.localName];if(!r)return null;const i=r(e,[this.getReadOptions(e,t)]);return i?(this.handleReadExtensions_([i]),i):null}readFeaturesFromNode(e,t){if(!gr.includes(e.namespaceURI))return[];if(e.localName=="gpx"){const r=wn([],epe,e,[this.getReadOptions(e,t)]);return r?(this.handleReadExtensions_(r),r):[]}return[]}writeFeaturesNode(e,t){t=this.adaptOptions(t);const r=Vd("http://www.topografix.com/GPX/1/1","gpx");return r.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xsi",Zv),r.setAttributeNS(Zv,"xsi:schemaLocation",Jme),r.setAttribute("version","1.1"),r.setAttribute("creator","OpenLayers"),lr({node:r},spe,Tpe,e,[t]),r}}const ope=gt(gr,{name:Ue(un),cmt:Ue(un),desc:Ue(un),src:Ue(un),link:ry,number:Ue(s1),extensions:PE,type:Ue(un),rtept:Cpe}),lpe=gt(gr,{ele:Ue(Ln),time:Ue(CE)}),cpe=gt(gr,{name:Ue(un),cmt:Ue(un),desc:Ue(un),src:Ue(un),link:ry,number:Ue(s1),type:Ue(un),extensions:PE,trkseg:Npe}),upe=gt(gr,{trkpt:Ppe}),hpe=gt(gr,{ele:Ue(Ln),time:Ue(CE)}),dpe=gt(gr,{ele:Ue(Ln),time:Ue(CE),magvar:Ue(Ln),geoidheight:Ue(Ln),name:Ue(un),cmt:Ue(un),desc:Ue(un),src:Ue(un),link:ry,sym:Ue(un),type:Ue(un),fix:Ue(un),sat:Ue(s1),hdop:Ue(Ln),vdop:Ue(Ln),pdop:Ue(Ln),ageofdgpsdata:Ue(Ln),dgpsid:Ue(s1),extensions:PE}),fpe=["text","type"],gpe=gt(gr,{text:rt(Vn),type:rt(Vn)}),mpe=gt(gr,["name","cmt","desc","src","link","number","type","rtept"]),ppe=gt(gr,{name:rt(Vn),cmt:rt(Vn),desc:rt(Vn),src:rt(Vn),link:rt(tC),number:rt(Jv),type:rt(Vn),rtept:ZV(rt(nC))}),ype=gt(gr,["ele","time"]),xpe=gt(gr,["name","cmt","desc","src","link","number","type","trkseg"]),_pe=gt(gr,{name:rt(Vn),cmt:rt(Vn),desc:rt(Vn),src:rt(Vn),link:rt(tC),number:rt(Jv),type:rt(Vn),trkseg:ZV(rt(Ope))}),vpe=Ao("trkpt"),wpe=gt(gr,{trkpt:rt(nC)}),Epe=gt(gr,["ele","time","magvar","geoidheight","name","cmt","desc","src","link","sym","type","fix","sat","hdop","vdop","pdop","ageofdgpsdata","dgpsid"]),Spe=gt(gr,{ele:rt(Ms),time:rt(Xme),magvar:rt(Ms),geoidheight:rt(Ms),name:rt(Vn),cmt:rt(Vn),desc:rt(Vn),src:rt(Vn),link:rt(tC),sym:rt(Vn),type:rt(Vn),fix:rt(Vn),sat:rt(Jv),hdop:rt(Ms),vdop:rt(Ms),pdop:rt(Ms),ageofdgpsdata:rt(Ms),dgpsid:rt(Jv)}),bpe={Point:"wpt",LineString:"rte",MultiLineString:"trk"};function Tpe(n,e,t){const r=n.getGeometry();if(r){const i=bpe[r.getType()];if(i){const s=e[e.length-1].node;return Vd(s.namespaceURI,i)}}}function QI(n,e,t,r){return n.push(parseFloat(t.getAttribute("lon")),parseFloat(t.getAttribute("lat"))),"ele"in r?(n.push(r.ele),delete r.ele,e.hasZ=!0):n.push(0),"time"in r?(n.push(r.time),delete r.time,e.hasM=!0):n.push(0),n}function eC(n,e,t){let r="XY",i=2;if(n.hasZ&&n.hasM?(r="XYZM",i=4):n.hasZ?(r="XYZ",i=3):n.hasM&&(r="XYM",i=3),i!==4){for(let s=0,a=e.length/4;s<a;s++)e[s*i]=e[s*4],e[s*i+1]=e[s*4+1],n.hasZ&&(e[s*i+2]=e[s*4+2]),n.hasM&&(e[s*i+2]=e[s*4+3]);if(e.length=e.length/4*i,t)for(let s=0,a=t.length;s<a;s++)t[s]=t[s]/4*i}return r}function Rpe(n,e){const t=wn({},npe,n,e);if(t)return t}function Ape(n,e){const t=wn({},ipe,n,e);if(t){const r=n.getAttribute("author");return r!==null&&(t.author=r),t}}function kpe(n,e){const t=e[e.length-1],r=n.getAttribute("minlat"),i=n.getAttribute("minlon"),s=n.getAttribute("maxlat"),a=n.getAttribute("maxlon");i!==null&&r!==null&&a!==null&&s!==null&&(t.bounds=[[parseFloat(i),parseFloat(r)],[parseFloat(a),parseFloat(s)]])}function Ipe(n,e){const t=e[e.length-1],r=n.getAttribute("id"),i=n.getAttribute("domain");r!==null&&i!==null&&(t.email=`${r}@${i}`)}function ry(n,e){const t=e[e.length-1],r=n.getAttribute("href");r!==null&&(t.link=r),Ju(tpe,n,e)}function PE(n,e){const t=e[e.length-1];t.extensionsNode_=n}function Cpe(n,e){const t=wn({},lpe,n,e);if(t){const r=e[e.length-1],i=r.flatCoordinates,s=r.layoutOptions;QI(i,s,n,t)}}function Ppe(n,e){const t=wn({},hpe,n,e);if(t){const r=e[e.length-1],i=r.flatCoordinates,s=r.layoutOptions;QI(i,s,n,t)}}function Npe(n,e){const t=e[e.length-1];Ju(upe,n,e);const r=t.flatCoordinates;t.ends.push(r.length)}function eB(n,e){const t=e[0],r=wn({flatCoordinates:[],layoutOptions:{}},ope,n,e);if(!r)return;const i=r.flatCoordinates;delete r.flatCoordinates;const s=r.layoutOptions;delete r.layoutOptions;const a=eC(s,i),o=new bi(i,a);To(o,!1,t);const l=new vr(o);return l.setProperties(r,!0),l}function tB(n,e){const t=e[0],r=wn({flatCoordinates:[],ends:[],layoutOptions:{}},cpe,n,e);if(!r)return;const i=r.flatCoordinates;delete r.flatCoordinates;const s=r.ends;delete r.ends;const a=r.layoutOptions;delete r.layoutOptions;const o=eC(a,i,s),l=new ic(i,o,s);To(l,!1,t);const c=new vr(l);return c.setProperties(r,!0),c}function nB(n,e){const t=e[0],r=wn({},dpe,n,e);if(!r)return;const i={},s=QI([],i,n,r),a=eC(i,s),o=new mi(s,a);To(o,!1,t);const l=new vr(o);return l.setProperties(r,!0),l}function tC(n,e,t){n.setAttribute("href",e);const i=t[t.length-1].properties,s=[i.linkText,i.linkType];lr({node:n},gpe,fs,s,t,fpe)}function nC(n,e,t){const r=t[t.length-1],s=r.node.namespaceURI,a=r.properties;switch(n.setAttributeNS(null,"lat",String(e[1])),n.setAttributeNS(null,"lon",String(e[0])),r.geometryLayout){case"XYZM":e[3]!==0&&(a.time=e[3]);case"XYZ":e[2]!==0&&(a.ele=e[2]);break;case"XYM":e[2]!==0&&(a.time=e[2]);break}const l=n.nodeName=="rtept"?ype[s]:Epe[s],c=Ws(a,l);lr({node:n,properties:a},Spe,fs,c,t,l)}function Mpe(n,e,t){const r=t[0],i=e.getProperties(),s={node:n};s.properties=i;const a=e.getGeometry();if(a.getType()=="LineString"){const h=To(a,!0,r);s.geometryLayout=h.getLayout(),i.rtept=h.getCoordinates()}const o=t[t.length-1].node,l=mpe[o.namespaceURI],c=Ws(i,l);lr(s,ppe,fs,c,t,l)}function Lpe(n,e,t){const r=t[0],i=e.getProperties(),s={node:n};s.properties=i;const a=e.getGeometry();if(a.getType()=="MultiLineString"){const h=To(a,!0,r);i.trkseg=h.getLineStrings()}const o=t[t.length-1].node,l=xpe[o.namespaceURI],c=Ws(i,l);lr(s,_pe,fs,c,t,l)}function Ope(n,e,t){const r={node:n};r.geometryLayout=e.getLayout(),r.properties={},lr(r,wpe,vpe,e.getCoordinates(),t)}function Dpe(n,e,t){const r=t[0],i=t[t.length-1];i.properties=e.getProperties();const s=e.getGeometry();if(s.getType()=="Point"){const a=To(s,!0,r);i.geometryLayout=a.getLayout(),nC(n,a.getCoordinates(),t)}}const wc=["http://www.google.com/kml/ext/2.2"],Nt=[null,"http://earth.google.com/kml/2.0","http://earth.google.com/kml/2.1","http://earth.google.com/kml/2.2","http://www.opengis.net/kml/2.2"],jpe="http://www.opengis.net/kml/2.2 https://developers.google.com/kml/schema/kml22gx.xsd",uO={fraction:"fraction",pixels:"pixels",insetPixels:"pixels"},Fpe=gt(Nt,{ExtendedData:yB,Region:xB,MultiGeometry:Ue(gB,"geometry"),LineString:Ue(dB,"geometry"),LinearRing:Ue(fB,"geometry"),Point:Ue(mB,"geometry"),Polygon:Ue(pB,"geometry"),Style:Ue(sC),StyleMap:w1e,address:Ue(un),description:Ue(un),name:Ue(un),open:Ue(Uu),phoneNumber:Ue(un),styleUrl:Ue(oB),visibility:Ue(Uu)},gt(wc,{MultiTrack:Ue(l1e,"geometry"),Track:Ue(hB,"geometry")})),Vpe=gt(Nt,{ExtendedData:yB,Region:xB,Link:M1e,address:Ue(un),description:Ue(un),name:Ue(un),open:Ue(Uu),phoneNumber:Ue(un),visibility:Ue(Uu)}),Bpe=gt(Nt,{href:Ue(aB)}),Gpe=gt(Nt,{Altitude:Ue(Ln),Longitude:Ue(Ln),Latitude:Ue(Ln),Tilt:Ue(Ln),AltitudeMode:Ue(un),Heading:Ue(Ln),Roll:Ue(Ln)}),rB=gt(Nt,{LatLonAltBox:R1e,Lod:k1e}),zpe=gt(Nt,["Document","Placemark"]),Upe=gt(Nt,{Document:rt(G1e),Placemark:rt(wB)});let b0,k_=null,jR,op,lp,cp,Qv,FR=null,rC,VR=null,BR,Xh=null,hO=null,GR=null;function ew(n){return 32/Math.min(n[0],n[1])}function $pe(){b0=[255,255,255,1],k_=new Jn({color:b0}),jR=[20,2],op="pixels",lp="pixels",cp=[64,64],Qv="https://maps.google.com/mapfiles/kml/pushpin/ylw-pushpin.png",FR=new S1({anchor:jR,anchorOrigin:"bottom-left",anchorXUnits:op,anchorYUnits:lp,crossOrigin:"anonymous",rotation:0,scale:ew(cp),size:cp,src:Qv}),rC="NO_IMAGE",VR=new Hn({color:b0,width:1}),BR=new Hn({color:[51,51,51,1],width:2}),Xh=new yo({font:"bold 16px Helvetica",fill:k_,stroke:BR,scale:.8}),hO=new gn({fill:k_,image:FR,text:Xh,stroke:VR,zIndex:0}),GR=[hO]}let $x;function Wpe(n){return n}class Hpe extends QV{constructor(e){super(),e=e||{},GR||$pe(),this.dataProjection=ir("EPSG:4326"),this.defaultStyle_=e.defaultStyle?e.defaultStyle:GR,this.extractStyles_=e.extractStyles!==void 0?e.extractStyles:!0,this.writeStyles_=e.writeStyles!==void 0?e.writeStyles:!0,this.sharedStyles_={},this.showPointNames_=e.showPointNames!==void 0?e.showPointNames:!0,this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:"anonymous",this.iconUrlFunction_=e.iconUrlFunction?e.iconUrlFunction:Wpe,this.supportedMediaTypes=["application/vnd.google-earth.kml+xml"]}readDocumentOrFolder_(e,t){const r=gt(Nt,{Document:cO(this.readDocumentOrFolder_,this),Folder:cO(this.readDocumentOrFolder_,this),Placemark:uo(this.readPlacemark_,this),Style:this.readSharedStyle_.bind(this),StyleMap:this.readSharedStyleMap_.bind(this)}),i=wn([],r,e,t,this);if(i)return i}readPlacemark_(e,t){const r=wn({geometry:null},Fpe,e,t,this);if(!r)return;const i=new vr,s=e.getAttribute("id");s!==null&&i.setId(s);const a=t[0],o=r.geometry;if(o&&To(o,!1,a),i.setGeometry(o),delete r.geometry,this.extractStyles_){const l=r.Style,c=r.styleUrl,h=Xpe(l,c,this.defaultStyle_,this.sharedStyles_,this.showPointNames_);i.setStyle(h)}return delete r.Style,i.setProperties(r,!0),i}readSharedStyle_(e,t){const r=e.getAttribute("id");if(r!==null){const i=sC.call(this,e,t);if(i){let s,a=e.baseURI;(!a||a=="about:blank")&&(a=window.location.href),a?s=new URL("#"+r,a).href:s="#"+r,this.sharedStyles_[s]=i}}}readSharedStyleMap_(e,t){const r=e.getAttribute("id");if(r===null)return;const i=cB.call(this,e,t);if(!i)return;let s,a=e.baseURI;(!a||a=="about:blank")&&(a=window.location.href),a?s=new URL("#"+r,a).href:s="#"+r,this.sharedStyles_[s]=i}readFeatureFromNode(e,t){if(!Nt.includes(e.namespaceURI))return null;const r=this.readPlacemark_(e,[this.getReadOptions(e,t)]);return r||null}readFeaturesFromNode(e,t){if(!Nt.includes(e.namespaceURI))return[];let r;const i=e.localName;if(i=="Document"||i=="Folder")return r=this.readDocumentOrFolder_(e,[this.getReadOptions(e,t)]),r||[];if(i=="Placemark"){const s=this.readPlacemark_(e,[this.getReadOptions(e,t)]);return s?[s]:[]}if(i=="kml"){r=[];for(let s=e.firstElementChild;s;s=s.nextElementSibling){const a=this.readFeaturesFromNode(s,t);a&&Un(r,a)}return r}return[]}readName(e){if(e){if(typeof e=="string"){const t=Hl(e);return this.readNameFromDocument(t)}return Wl(e)?this.readNameFromDocument(e):this.readNameFromNode(e)}}readNameFromDocument(e){for(let t=e.firstChild;t;t=t.nextSibling)if(t.nodeType==Node.ELEMENT_NODE){const r=this.readNameFromNode(t);if(r)return r}}readNameFromNode(e){for(let t=e.firstElementChild;t;t=t.nextElementSibling)if(Nt.includes(t.namespaceURI)&&t.localName=="name")return un(t);for(let t=e.firstElementChild;t;t=t.nextElementSibling){const r=t.localName;if(Nt.includes(t.namespaceURI)&&(r=="Document"||r=="Folder"||r=="Placemark"||r=="kml")){const i=this.readNameFromNode(t);if(i)return i}}}readNetworkLinks(e){const t=[];if(typeof e=="string"){const r=Hl(e);Un(t,this.readNetworkLinksFromDocument(r))}else Wl(e)?Un(t,this.readNetworkLinksFromDocument(e)):Un(t,this.readNetworkLinksFromNode(e));return t}readNetworkLinksFromDocument(e){const t=[];for(let r=e.firstChild;r;r=r.nextSibling)r.nodeType==Node.ELEMENT_NODE&&Un(t,this.readNetworkLinksFromNode(r));return t}readNetworkLinksFromNode(e){const t=[];for(let r=e.firstElementChild;r;r=r.nextElementSibling)if(Nt.includes(r.namespaceURI)&&r.localName=="NetworkLink"){const i=wn({},Vpe,r,[]);t.push(i)}for(let r=e.firstElementChild;r;r=r.nextElementSibling){const i=r.localName;Nt.includes(r.namespaceURI)&&(i=="Document"||i=="Folder"||i=="kml")&&Un(t,this.readNetworkLinksFromNode(r))}return t}readRegion(e){const t=[];if(typeof e=="string"){const r=Hl(e);Un(t,this.readRegionFromDocument(r))}else Wl(e)?Un(t,this.readRegionFromDocument(e)):Un(t,this.readRegionFromNode(e));return t}readRegionFromDocument(e){const t=[];for(let r=e.firstChild;r;r=r.nextSibling)r.nodeType==Node.ELEMENT_NODE&&Un(t,this.readRegionFromNode(r));return t}readRegionFromNode(e){const t=[];for(let r=e.firstElementChild;r;r=r.nextElementSibling)if(Nt.includes(r.namespaceURI)&&r.localName=="Region"){const i=wn({},rB,r,[]);t.push(i)}for(let r=e.firstElementChild;r;r=r.nextElementSibling){const i=r.localName;Nt.includes(r.namespaceURI)&&(i=="Document"||i=="Folder"||i=="kml")&&Un(t,this.readRegionFromNode(r))}return t}readCamera(e){const t=[];if(typeof e=="string"){const r=Hl(e);Un(t,this.readCameraFromDocument(r))}else Wl(e)?Un(t,this.readCameraFromDocument(e)):Un(t,this.readCameraFromNode(e));return t}readCameraFromDocument(e){const t=[];for(let r=e.firstChild;r;r=r.nextSibling)r.nodeType===Node.ELEMENT_NODE&&Un(t,this.readCameraFromNode(r));return t}readCameraFromNode(e){const t=[];for(let r=e.firstElementChild;r;r=r.nextElementSibling)if(Nt.includes(r.namespaceURI)&&r.localName==="Camera"){const i=wn({},Gpe,r,[]);t.push(i)}for(let r=e.firstElementChild;r;r=r.nextElementSibling){const i=r.localName;Nt.includes(r.namespaceURI)&&(i==="Document"||i==="Folder"||i==="Placemark"||i==="kml")&&Un(t,this.readCameraFromNode(r))}return t}writeFeaturesNode(e,t){t=this.adaptOptions(t);const r=Vd(Nt[4],"kml"),i="http://www.w3.org/2000/xmlns/";r.setAttributeNS(i,"xmlns:gx",wc[0]),r.setAttributeNS(i,"xmlns:xsi",Zv),r.setAttributeNS(Zv,"xsi:schemaLocation",jpe);const s={node:r},a={};e.length>1?a.Document=e:e.length==1&&(a.Placemark=e[0]);const o=zpe[r.namespaceURI],l=Ws(a,o);return lr(s,Upe,fs,l,[t],o,this),r}}function Kpe(n,e){const t=[0,0];let r="start";const i=n.getImage();if(i){const o=i.getSize();if(o&&o.length==2){const l=i.getScaleArray(),c=i.getAnchor();t[0]=l[0]*(o[0]-c[0]),t[1]=l[1]*(o[1]/2-c[1]),r="left"}}let s=n.getText();return s?(s=s.clone(),s.setFont(s.getFont()||Xh.getFont()),s.setScale(s.getScale()||Xh.getScale()),s.setFill(s.getFill()||Xh.getFill()),s.setStroke(s.getStroke()||BR)):s=Xh.clone(),s.setText(e),s.setOffsetX(t[0]),s.setOffsetY(t[1]),s.setTextAlign(r),new gn({image:i,text:s})}function Xpe(n,e,t,r,i){return(function(s,a){let o=i,l="",c=[];if(o){const g=s.getGeometry();if(g)if(g instanceof po)c=g.getGeometriesArrayRecursive().filter(function(m){const y=m.getType();return y==="Point"||y==="MultiPoint"}),o=c.length>0;else{const m=g.getType();o=m==="Point"||m==="MultiPoint"}}o&&(l=s.get("name"),o=o&&!!l,o&&/&[^&]+;/.test(l)&&($x||($x=document.createElement("textarea")),$x.innerHTML=l,l=$x.value));let h=t;if(n?h=n:e&&(h=iB(e,t,r)),o){const g=Kpe(h[0],l);if(c.length>0){g.setGeometry(new po(c));const m=new gn({geometry:h[0].getGeometry(),image:null,fill:h[0].getFill(),stroke:h[0].getStroke(),text:null});return[g,m].concat(h.slice(1))}return g}return h})}function iB(n,e,t){return Array.isArray(n)?n:typeof n=="string"?iB(t[n],e,t):e}function NE(n){const e=Ro(n,!1),t=/^\s*#?\s*([0-9A-Fa-f]{8})\s*$/.exec(e);if(t){const r=t[1];return[parseInt(r.substr(6,2),16),parseInt(r.substr(4,2),16),parseInt(r.substr(2,2),16),parseInt(r.substr(0,2),16)/255]}}function sB(n){let e=Ro(n,!1);const t=[];e=e.replace(/\s*,\s*/g,",");const r=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?),([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s+|,|$)(?:([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s+|$))?\s*/i;let i;for(;i=r.exec(e);){const s=parseFloat(i[1]),a=parseFloat(i[2]),o=i[3]?parseFloat(i[3]):0;t.push(s,a,o),e=e.substr(i[0].length)}if(e==="")return t}function aB(n){const e=Ro(n,!1).trim();let t=n.baseURI;return(!t||t=="about:blank")&&(t=window.location.href),t?new URL(e,t).href:e}function oB(n){const e=Ro(n,!1).trim().replace(/^(?!.*#)/,"#");let t=n.baseURI;return(!t||t=="about:blank")&&(t=window.location.href),t?new URL(e,t).href:e}function qpe(n){const e=n.getAttribute("xunits"),t=n.getAttribute("yunits");let r;return e!=="insetPixels"?t!=="insetPixels"?r="bottom-left":r="top-left":t!=="insetPixels"?r="bottom-right":r="top-right",{x:parseFloat(n.getAttribute("x")),xunits:uO[e],y:parseFloat(n.getAttribute("y")),yunits:uO[t],origin:r}}function lB(n){return Ln(n)}const Ype=gt(Nt,{Pair:v1e});function cB(n,e){return wn(void 0,Ype,n,e,this)}const Zpe=gt(Nt,{Icon:Ue(h1e),color:Ue(NE),heading:Ue(Ln),hotSpot:Ue(qpe),scale:Ue(lB)});function Jpe(n,e){const t=wn({},Zpe,n,e);if(!t)return;const r=e[e.length-1],i="Icon"in t?t.Icon:{},s=!("Icon"in t)||Object.keys(i).length>0;let a;const o=i.href;o?a=o:s&&(a=Qv);let l,c,h,g="bottom-left";const m=t.hotSpot;m?(l=[m.x,m.y],c=m.xunits,h=m.yunits,g=m.origin):/^https?:\/\/maps\.(?:google|gstatic)\.com\//.test(a)&&(a.includes("pushpin")?(l=jR,c=op,h=lp):a.includes("arrow-reverse")?(l=[54,42],c=op,h=lp):a.includes("paddle")&&(l=[32,1],c=op,h=lp));let y;const _=i.x,x=i.y;_!==void 0&&x!==void 0&&(y=[_,x]);let w;const b=i.w,T=i.h;b!==void 0&&T!==void 0&&(w=[b,T]);let k;const L=t.heading;L!==void 0&&(k=Yl(L));const O=t.scale,B=t.color;if(s){a==Qv&&(w=cp);const R=new S1({anchor:l,anchorOrigin:g,anchorXUnits:c,anchorYUnits:h,crossOrigin:this.crossOrigin_,offset:y,offsetOrigin:"bottom-left",rotation:k,scale:O,size:w,src:this.iconUrlFunction_(a),color:B}),A=R.getScaleArray()[0],P=R.getSize();if(P===null){const D=R.getImageState();if(D===Rt.IDLE||D===Rt.LOADING){const N=function(){const G=R.getImageState();if(!(G===Rt.IDLE||G===Rt.LOADING)){const j=R.getSize();if(j&&j.length==2){const ve=ew(j);R.setScale(A*ve)}R.unlistenImageChange(N)}};R.listenImageChange(N),D===Rt.IDLE&&R.load()}}else if(P.length==2){const D=ew(P);R.setScale(A*D)}r.imageStyle=R}else r.imageStyle=rC}const Qpe=gt(Nt,{color:Ue(NE),scale:Ue(lB)});function e1e(n,e){const t=wn({},Qpe,n,e);if(!t)return;const r=e[e.length-1],i=new yo({fill:new Jn({color:"color"in t?t.color:b0}),scale:t.scale});r.textStyle=i}const t1e=gt(Nt,{color:Ue(NE),width:Ue(Ln)});function n1e(n,e){const t=wn({},t1e,n,e);if(!t)return;const r=e[e.length-1],i=new Hn({color:"color"in t?t.color:b0,width:"width"in t?t.width:1});r.strokeStyle=i}const r1e=gt(Nt,{color:Ue(NE),fill:Ue(Uu),outline:Ue(Uu)});function i1e(n,e){const t=wn({},r1e,n,e);if(!t)return;const r=e[e.length-1],i=new Jn({color:"color"in t?t.color:b0});r.fillStyle=i;const s=t.fill;s!==void 0&&(r.fill=s);const a=t.outline;a!==void 0&&(r.outline=a)}const s1e=gt(Nt,{coordinates:JI(sB)});function uB(n,e){return wn(null,s1e,n,e)}function a1e(n,e){const r=e[e.length-1].coordinates,i=Ro(n,!1),a=/^\s*([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s*$/i.exec(i);if(a){const o=parseFloat(a[1]),l=parseFloat(a[2]),c=parseFloat(a[3]);r.push([o,l,c])}else r.push([])}const o1e=gt(wc,{Track:uo(hB)});function l1e(n,e){const t=wn([],o1e,n,e);if(t)return new ic(t)}const c1e=gt(Nt,{when:L1e},gt(wc,{coord:a1e}));function hB(n,e){const t=wn({coordinates:[],whens:[]},c1e,n,e);if(!t)return;const r=[],i=t.coordinates,s=t.whens;for(let a=0,o=Math.min(i.length,s.length);a<o;++a)i[a].length==3&&r.push(i[a][0],i[a][1],i[a][2],s[a]);return new bi(r,"XYZM")}const u1e=gt(Nt,{href:Ue(aB)},gt(wc,{x:Ue(Ln),y:Ue(Ln),w:Ue(Ln),h:Ue(Ln)}));function h1e(n,e){const t=wn({},u1e,n,e);return t||null}const d1e=gt(Nt,{coordinates:JI(sB)});function iC(n,e){return wn(null,d1e,n,e)}const ME=gt(Nt,{extrude:Ue(Uu),tessellate:Ue(Uu),altitudeMode:Ue(un)});function dB(n,e){const t=wn({},ME,n,e),r=iC(n,e);if(r){const i=new bi(r,"XYZ");return i.setProperties(t,!0),i}}function fB(n,e){const t=wn({},ME,n,e),r=iC(n,e);if(r){const i=new Ua(r,"XYZ",[r.length]);return i.setProperties(t,!0),i}}const f1e=gt(Nt,{LineString:uo(dB),LinearRing:uo(fB),MultiGeometry:uo(gB),Point:uo(mB),Polygon:uo(pB)});function gB(n,e){const t=wn([],f1e,n,e);if(!t)return null;if(t.length===0)return new po(t);let r,i=!0;const s=t[0].getType();let a;for(let o=1,l=t.length;o<l;++o)if(a=t[o],a.getType()!=s){i=!1;break}if(i){let o,l;if(s=="Point"){const c=t[0];o=c.getLayout(),l=c.getFlatCoordinates();for(let h=1,g=t.length;h<g;++h)a=t[h],Un(l,a.getFlatCoordinates());r=new Nd(l,o),Db(r,t)}else if(s=="LineString")r=new ic(t),Db(r,t);else if(s=="Polygon")r=new cd(t),Db(r,t);else if(s=="GeometryCollection"||s.startsWith("Multi"))r=new po(t);else throw new Error("Unknown geometry type found")}else r=new po(t);return r}function mB(n,e){const t=wn({},ME,n,e),r=iC(n,e);if(r){const i=new mi(r,"XYZ");return i.setProperties(t,!0),i}}const g1e=gt(Nt,{innerBoundaryIs:C1e,outerBoundaryIs:N1e});function pB(n,e){const t=wn({},ME,n,e),r=wn([null],g1e,n,e);if(r&&r[0]){const i=r[0],s=[i.length];for(let o=1,l=r.length;o<l;++o)Un(i,r[o]),s.push(i.length);const a=new Ua(i,"XYZ",s);return a.setProperties(t,!0),a}}const m1e=gt(Nt,{IconStyle:Jpe,LabelStyle:e1e,LineStyle:n1e,PolyStyle:i1e});function sC(n,e){const t=wn({},m1e,n,e,this);if(!t)return null;let r="fillStyle"in t?t.fillStyle:k_;const i=t.fill;i!==void 0&&!i&&(r=null);let s;"imageStyle"in t?t.imageStyle!=rC&&(s=t.imageStyle):s=FR;const a="textStyle"in t?t.textStyle:Xh,o="strokeStyle"in t?t.strokeStyle:VR,l=t.outline;return l!==void 0&&!l?[new gn({geometry:function(c){const h=c.getGeometry(),g=h.getType();if(g==="GeometryCollection"){const m=h;return new po(m.getGeometriesArrayRecursive().filter(function(y){const _=y.getType();return _!=="Polygon"&&_!=="MultiPolygon"}))}if(g!=="Polygon"&&g!=="MultiPolygon")return h},fill:r,image:s,stroke:o,text:a,zIndex:void 0}),new gn({geometry:function(c){const h=c.getGeometry(),g=h.getType();if(g==="GeometryCollection"){const m=h;return new po(m.getGeometriesArrayRecursive().filter(function(y){const _=y.getType();return _==="Polygon"||_==="MultiPolygon"}))}if(g==="Polygon"||g==="MultiPolygon")return h},fill:r,stroke:null,zIndex:void 0})]:[new gn({fill:r,image:s,stroke:o,text:a,zIndex:void 0})]}function Db(n,e){const t=e.length,r=new Array(e.length),i=new Array(e.length),s=new Array(e.length);let a,o,l;a=!1,o=!1,l=!1;for(let c=0;c<t;++c){const h=e[c];r[c]=h.get("extrude"),i[c]=h.get("tessellate"),s[c]=h.get("altitudeMode"),a=a||r[c]!==void 0,o=o||i[c]!==void 0,l=l||s[c]}a&&n.set("extrude",r),o&&n.set("tessellate",i),l&&n.set("altitudeMode",s)}const p1e=gt(Nt,{displayName:Ue(un),value:Ue(un)});function y1e(n,e){const t=n.getAttribute("name");Ju(p1e,n,e);const r=e[e.length-1];t&&r.displayName?r[t]={value:r.value,displayName:r.displayName,toString:function(){return r.value}}:t!==null?r[t]=r.value:r.displayName!==null&&(r[r.displayName]=r.value),delete r.value}const x1e=gt(Nt,{Data:y1e,SchemaData:S1e});function yB(n,e){Ju(x1e,n,e)}function xB(n,e){Ju(rB,n,e)}const _1e=gt(Nt,{Style:Ue(sC),key:Ue(un),styleUrl:Ue(oB)});function v1e(n,e){const t=wn({},_1e,n,e,this);if(!t)return;const r=t.key;if(r&&r=="normal"){const i=t.styleUrl;i&&(e[e.length-1]=i);const s=t.Style;s&&(e[e.length-1]=s)}}function w1e(n,e){const t=cB.call(this,n,e);if(!t)return;const r=e[e.length-1];if(Array.isArray(t))r.Style=t;else if(typeof t=="string")r.styleUrl=t;else throw new Error("`styleMapValue` has an unknown type")}const E1e=gt(Nt,{SimpleData:b1e});function S1e(n,e){Ju(E1e,n,e)}function b1e(n,e){const t=n.getAttribute("name");if(t!==null){const r=un(n),i=e[e.length-1];i[t]=r}}const T1e=gt(Nt,{altitudeMode:Ue(un),minAltitude:Ue(Ln),maxAltitude:Ue(Ln),north:Ue(Ln),south:Ue(Ln),east:Ue(Ln),west:Ue(Ln)});function R1e(n,e){const t=wn({},T1e,n,e);if(!t)return;const r=e[e.length-1],i=[parseFloat(t.west),parseFloat(t.south),parseFloat(t.east),parseFloat(t.north)];r.extent=i,r.altitudeMode=t.altitudeMode,r.minAltitude=parseFloat(t.minAltitude),r.maxAltitude=parseFloat(t.maxAltitude)}const A1e=gt(Nt,{minLodPixels:Ue(Ln),maxLodPixels:Ue(Ln),minFadeExtent:Ue(Ln),maxFadeExtent:Ue(Ln)});function k1e(n,e){const t=wn({},A1e,n,e);if(!t)return;const r=e[e.length-1];r.minLodPixels=parseFloat(t.minLodPixels),r.maxLodPixels=parseFloat(t.maxLodPixels),r.minFadeExtent=parseFloat(t.minFadeExtent),r.maxFadeExtent=parseFloat(t.maxFadeExtent)}const I1e=gt(Nt,{LinearRing:uo(uB)});function C1e(n,e){const t=wn([],I1e,n,e);t.length>0&&e[e.length-1].push(...t)}const P1e=gt(Nt,{LinearRing:JI(uB)});function N1e(n,e){const t=wn(void 0,P1e,n,e);if(t){const r=e[e.length-1];r[0]=t}}function M1e(n,e){Ju(Bpe,n,e)}function L1e(n,e){const r=e[e.length-1].whens,i=Ro(n,!1),s=Date.parse(i);r.push(isNaN(s)?0:s)}function LE(n,e){const t=za(e),i=[(t.length==4?t[3]:1)*255,t[2],t[1],t[0]];for(let s=0;s<4;++s){const a=Math.floor(i[s]).toString(16);i[s]=a.length==1?"0"+a:a}Vn(n,i.join(""))}function O1e(n,e,t){const r=t[t.length-1],i=r.layout,s=r.stride;let a;if(i=="XY"||i=="XYM")a=2;else if(i=="XYZ"||i=="XYZM")a=3;else throw new Error("Invalid geometry layout");const o=e.length;let l="";if(o>0){l+=e[0];for(let c=1;c<a;++c)l+=","+e[c];for(let c=s;c<o;c+=s){l+=" "+e[c];for(let h=1;h<a;++h)l+=","+e[c+h]}}Vn(n,l)}const I_=gt(Nt,{Data:rt(D1e),value:rt(F1e),displayName:rt(j1e)});function D1e(n,e,t){n.setAttribute("name",e.name);const r={node:n},i=e.value;typeof i=="object"?(i!==null&&i.displayName&&lr(r,I_,fs,[i.displayName],t,["displayName"]),i!==null&&i.value&&lr(r,I_,fs,[i.value],t,["value"])):lr(r,I_,fs,[i],t,["value"])}function j1e(n,e){Vn(n,e)}function F1e(n,e){Vn(n,e)}const V1e=gt(Nt,{Placemark:rt(wB)}),B1e=function(n,e,t){const r=e[e.length-1].node;return Vd(r.namespaceURI,"Placemark")};function G1e(n,e,t){lr({node:n},V1e,B1e,e,t,void 0,this)}const z1e=Ao("Data");function U1e(n,e,t){const r={node:n},i=e.names,s=e.values,a=i.length;for(let o=0;o<a;o++)lr(r,I_,z1e,[{name:i[o],value:s[o]}],t)}const dO=gt(Nt,["href"],gt(wc,["x","y","w","h"])),fO=gt(Nt,{href:rt(Vn)},gt(wc,{x:rt(Ms),y:rt(Ms),w:rt(Ms),h:rt(Ms)})),$1e=function(n,e,t){return Vd(wc[0],"gx:"+t)};function W1e(n,e,t){const r={node:n},i=t[t.length-1].node;let s=dO[i.namespaceURI],a=Ws(e,s);lr(r,fO,fs,a,t,s),s=dO[wc[0]],a=Ws(e,s),lr(r,fO,$1e,a,t,s)}const H1e=gt(Nt,["scale","heading","Icon","color","hotSpot"]),K1e=gt(Nt,{Icon:rt(W1e),color:rt(LE),heading:rt(Ms),hotSpot:rt(vye),scale:rt(SB)});function X1e(n,e,t){const r={node:n},i={},s=e.getSrc(),a=e.getSize(),o=e.getImageSize(),l={href:s};if(a){l.w=a[0],l.h=a[1];const w=e.getAnchor(),b=e.getOrigin();if(b&&o&&b[0]!==0&&b[1]!==a[1]&&(l.x=b[0],l.y=o[1]-(b[1]+a[1])),w&&(w[0]!==a[0]/2||w[1]!==a[1]/2)){const T={x:w[0],xunits:"pixels",y:a[1]-w[1],yunits:"pixels"};i.hotSpot=T}}i.Icon=l;let c=e.getScaleArray()[0],h=a;if(h===null&&(h=cp),h.length==2){const w=ew(h);c=c/w}c!==1&&(i.scale=c);const g=e.getRotation();g!==0&&(i.heading=g);const m=e.getColor();m&&(i.color=m);const y=t[t.length-1].node,_=H1e[y.namespaceURI],x=Ws(i,_);lr(r,K1e,fs,x,t,_)}const q1e=gt(Nt,["color","scale"]),Y1e=gt(Nt,{color:rt(LE),scale:rt(SB)});function Z1e(n,e,t){const r={node:n},i={},s=e.getFill();s&&(i.color=s.getColor());const a=e.getScale();a&&a!==1&&(i.scale=a);const o=t[t.length-1].node,l=q1e[o.namespaceURI],c=Ws(i,l);lr(r,Y1e,fs,c,t,l)}const J1e=gt(Nt,["color","width"]),Q1e=gt(Nt,{color:rt(LE),width:rt(Ms)});function eye(n,e,t){const r={node:n},i={color:e.getColor(),width:Number(e.getWidth())||1},s=t[t.length-1].node,a=J1e[s.namespaceURI],o=Ws(i,a);lr(r,Q1e,fs,o,t,a)}const tye={Point:"Point",LineString:"LineString",LinearRing:"LinearRing",Polygon:"Polygon",MultiPoint:"MultiGeometry",MultiLineString:"MultiGeometry",MultiPolygon:"MultiGeometry",GeometryCollection:"MultiGeometry"},_B=function(n,e,t){if(n){const r=e[e.length-1].node;return Vd(r.namespaceURI,tye[n.getType()])}},nye=Ao("Point"),rye=Ao("LineString"),iye=Ao("LinearRing"),sye=Ao("Polygon"),aye=gt(Nt,{LineString:rt(T0),Point:rt(T0),Polygon:rt(EB),GeometryCollection:rt(vB)});function vB(n,e,t){const r={node:n},i=e.getType();let s=[],a;if(i==="GeometryCollection")e.getGeometriesArrayRecursive().forEach(function(o){const l=o.getType();if(l==="MultiPoint")s=s.concat(o.getPoints());else if(l==="MultiLineString")s=s.concat(o.getLineStrings());else if(l==="MultiPolygon")s=s.concat(o.getPolygons());else if(l==="Point"||l==="LineString"||l==="Polygon")s.push(o);else throw new Error("Unknown geometry type")}),a=_B;else if(i==="MultiPoint")s=e.getPoints(),a=nye;else if(i==="MultiLineString")s=e.getLineStrings(),a=rye;else if(i==="MultiPolygon")s=e.getPolygons(),a=sye;else throw new Error("Unknown geometry type");lr(r,aye,a,s,t)}const oye=gt(Nt,{LinearRing:rt(T0)});function gO(n,e,t){lr({node:n},oye,iye,[e],t)}const jb=gt(Nt,{ExtendedData:rt(U1e),MultiGeometry:rt(vB),LineString:rt(T0),LinearRing:rt(T0),Point:rt(T0),Polygon:rt(EB),Style:rt(_ye),address:rt(Vn),description:rt(Vn),name:rt(Vn),open:rt(ng),phoneNumber:rt(Vn),styleUrl:rt(Vn),visibility:rt(ng)}),lye=gt(Nt,["name","open","visibility","address","phoneNumber","description","styleUrl","Style"]),cye=Ao("ExtendedData");function wB(n,e,t){const r={node:n};e.getId()&&n.setAttribute("id",e.getId());const i=e.getProperties(),s={address:1,description:1,name:1,open:1,phoneNumber:1,styleUrl:1,visibility:1};s[e.getGeometryName()]=1;const a=Object.keys(i||{}).sort().filter(function(y){return!s[y]}),o=e.getStyleFunction();if(o){const y=o(e,0);if(y){const _=Array.isArray(y)?y:[y];let x=_;if(e.getGeometry()&&(x=_.filter(function(w){const b=w.getGeometryFunction()(e);if(b){const T=b.getType();return T==="GeometryCollection"?b.getGeometriesArrayRecursive().filter(function(k){const L=k.getType();return L==="Point"||L==="MultiPoint"}).length:T==="Point"||T==="MultiPoint"}})),this.writeStyles_){let w=_,b=_;e.getGeometry()&&(w=_.filter(function(T){const k=T.getGeometryFunction()(e);if(k){const L=k.getType();return L==="GeometryCollection"?k.getGeometriesArrayRecursive().filter(function(O){const B=O.getType();return B==="LineString"||B==="MultiLineString"}).length:L==="LineString"||L==="MultiLineString"}}),b=_.filter(function(T){const k=T.getGeometryFunction()(e);if(k){const L=k.getType();return L==="GeometryCollection"?k.getGeometriesArrayRecursive().filter(function(O){const B=O.getType();return B==="Polygon"||B==="MultiPolygon"}).length:L==="Polygon"||L==="MultiPolygon"}})),i.Style={pointStyles:x,lineStyles:w,polyStyles:b}}if(x.length&&i.name===void 0){const w=x[0].getText();w&&(i.name=w.getText())}}}const l=t[t.length-1].node,c=lye[l.namespaceURI],h=Ws(i,c);if(lr(r,jb,fs,h,t,c),a.length>0){const y=Ws(i,a);lr(r,jb,cye,[{names:a,values:y}],t)}const g=t[0];let m=e.getGeometry();m&&(m=To(m,!0,g)),lr(r,jb,_B,[m],t)}const uye=gt(Nt,["extrude","tessellate","altitudeMode","coordinates"]),hye=gt(Nt,{extrude:rt(ng),tessellate:rt(ng),altitudeMode:rt(Vn),coordinates:rt(O1e)});function T0(n,e,t){const r=e.getFlatCoordinates(),i={node:n};i.layout=e.getLayout(),i.stride=e.getStride();const s=e.getProperties();s.coordinates=r;const a=t[t.length-1].node,o=uye[a.namespaceURI],l=Ws(s,o);lr(i,hye,fs,l,t,o)}const dye=gt(Nt,["color","fill","outline"]),mO=gt(Nt,{outerBoundaryIs:rt(gO),innerBoundaryIs:rt(gO)}),fye=Ao("innerBoundaryIs"),gye=Ao("outerBoundaryIs");function EB(n,e,t){const r=e.getLinearRings(),i=r.shift(),s={node:n};lr(s,mO,fye,r,t),lr(s,mO,gye,[i],t)}const mye=gt(Nt,{color:rt(LE),fill:rt(ng),outline:rt(ng)});function pye(n,e,t){const r={node:n},i=e.getFill(),s=e.getStroke(),a={color:i?i.getColor():void 0,fill:i?void 0:!1,outline:s?void 0:!1},o=t[t.length-1].node,l=dye[o.namespaceURI],c=Ws(a,l);lr(r,mye,fs,c,t,l)}function SB(n,e){Ms(n,Math.round(e*1e6)/1e6)}const yye=gt(Nt,["IconStyle","LabelStyle","LineStyle","PolyStyle"]),xye=gt(Nt,{IconStyle:rt(X1e),LabelStyle:rt(Z1e),LineStyle:rt(eye),PolyStyle:rt(pye)});function _ye(n,e,t){const r={node:n},i={};if(e.pointStyles.length){const l=e.pointStyles[0].getText();l&&(i.LabelStyle=l);const c=e.pointStyles[0].getImage();c&&typeof c.getSrc=="function"&&(i.IconStyle=c)}if(e.lineStyles.length){const l=e.lineStyles[0].getStroke();l&&(i.LineStyle=l)}if(e.polyStyles.length){const l=e.polyStyles[0].getStroke();l&&!i.LineStyle&&(i.LineStyle=l),i.PolyStyle=e.polyStyles[0]}const s=t[t.length-1].node,a=yye[s.namespaceURI],o=Ws(i,a);lr(r,xye,fs,o,t,a)}function vye(n,e){n.setAttribute("x",String(e.x)),n.setAttribute("y",String(e.y)),n.setAttribute("xunits",e.xunits),n.setAttribute("yunits",e.yunits)}function bB(n){const e=Object.keys(n.defs),t=e.length;let r,i;for(r=0;r<t;++r){const s=e[r];if(!t_(s)){const a=n.defs(s);let o=a.units;!o&&a.projName==="longlat"&&(o="degrees"),D_(new Sw({code:s,axisOrientation:a.axis,metersPerUnit:a.to_meter,units:o}))}}for(r=0;r<t;++r){const s=e[r],a=t_(s);for(i=0;i<t;++i){const o=e[i],l=t_(o);if(!n_(s,o))if(n.defs[s]===n.defs[o])sT([a,l]);else{const c=n(s,o);x$(a,l,iN(a,l,c.forward),iN(l,a,c.inverse))}}}}console.log(" parcelHighlight.ts v3.1 loaded - fixed pixelRatio for Android");Tn.defs("EPSG:28992","+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m +no_defs");bB(Tn);let qh=null,up=null,Jf=null;function zR(n){qh&&(n.removeLayer(qh),qh=null),up&&(n.removeLayer(up),up=null),Jf=null}async function wye(n,e){try{const t=bn(e);console.log(` Click (3857): ${e[0].toFixed(0)}, ${e[1].toFixed(0)}`),console.log(` LonLat (WGS84): ${t[0].toFixed(5)}, ${t[1].toFixed(5)}`);const r=Tn("EPSG:4326","EPSG:28992",t);if(console.log(` RD (28992): ${r?r[0].toFixed(0)+", "+r[1].toFixed(0):"FAILED"}`),!r||r[0]<7e3||r[0]>3e5||r[1]<289e3||r[1]>629e3)return console.error(" Coordinate outside Netherlands or transformation failed:",r),!1;zR(n);const i=1,s=`${r[0]-i},${r[1]-i},${r[0]+i},${r[1]+i}`,a=Date.now(),o=`https://service.pdok.nl/rvo/brpgewaspercelen/wfs/v1_0?SERVICE=WFS&VERSION=2.0.0&REQUEST=GetFeature&TYPENAMES=brpgewaspercelen:BrpGewas&OUTPUTFORMAT=json&SRSNAME=EPSG:28992&BBOX=${s},EPSG:28992&_=${a}`;console.log(" WFS URL:",o);const l=new AbortController,c=setTimeout(()=>l.abort(),1e4),h=await fetch(o,{signal:l.signal});if(clearTimeout(c),!h.ok)return console.error("WFS request failed:",h.status),!1;const g=await h.json();if(console.log(" WFS RESPONSE:",JSON.stringify(g).substring(0,500)),!g.features||g.features.length===0)return console.log("No parcel found at location"),!1;const m=g.features[0];console.log(" PARCEL ID:",m.id||m.properties?.id||"geen ID"),console.log(" PARCEL BBOX:",JSON.stringify(m.bbox||"geen bbox"));const _=new IE().readFeature(m,{dataProjection:"EPSG:28992",featureProjection:"EPSG:3857"}),x=_.getGeometry();if(!x)return console.log("No geometry in parcel feature"),!1;const w=m.properties||{};console.log(` Parcel: ${w.category||"unknown"} - ${w.gewasnaam||w.gewas||"geen gewas"}`),console.log(` Geometry type: ${x.getType()}, extent: ${x.getExtent().map(P=>P.toFixed(0)).join(", ")}`);const b=x.getExtent(),T=b[2]-b[0],k=b[3]-b[1],L=Math.max(T,k)*.05,O=[b[0]-L,b[1]-L,b[2]+L,b[3]+L],B=Math.max(T,k)*.3,R=[b[0]-B,b[1]-B,b[2]+B,b[3]+B];Jf=x,qh=new sX({source:new NX({url:"https://ahn.arcgisonline.nl/arcgis/rest/services/Hoogtebestand/AHN4_DTM_50cm/ImageServer",params:{renderingRule:JSON.stringify({rasterFunction:"AHN - Color Ramp D"})},crossOrigin:"anonymous"}),extent:O,zIndex:998}),qh.on("prerender",P=>{if(!Jf)return;const D=P.context;if(!D)return;const N=P.frameState;if(!N)return;D.save(),D.beginPath(),(Jf.getType()==="Polygon"?Jf.getCoordinates()[0]:Jf.getCoordinates()[0][0]).forEach((j,ve)=>{const ce=n.getPixelFromCoordinate(j);if(!ce)return;const je=N.pixelRatio,Pe=ce[0]*je,ue=ce[1]*je;ve===0?D.moveTo(Pe,ue):D.lineTo(Pe,ue)}),D.closePath(),D.clip()}),qh.on("postrender",P=>{const D=P.context;D&&D.restore()}),n.addLayer(qh);const A=new xl({features:[_]});return up=new pc({source:A,style:new gn({fill:new Jn({color:"rgba(0, 0, 0, 0)"}),stroke:new Hn({color:"#dc2626",width:3})}),zIndex:999}),n.addLayer(up),console.log(" Parcel height map displayed"),!0}catch(t){return console.error("Failed to show parcel height map:",t),!1}}var tw={};tw.version="0.18.5";var TB=1252,Eye=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],RB=function(n){Eye.indexOf(n)!=-1&&(TB=n)};function Sye(){RB(1252)}var a1=function(n){RB(n)};function bye(){a1(1200),Sye()}var Wx=function(e){return String.fromCharCode(e)},pO=function(e){return String.fromCharCode(e)},nw,_u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function o1(n){for(var e="",t=0,r=0,i=0,s=0,a=0,o=0,l=0,c=0;c<n.length;)t=n.charCodeAt(c++),s=t>>2,r=n.charCodeAt(c++),a=(t&3)<<4|r>>4,i=n.charCodeAt(c++),o=(r&15)<<2|i>>6,l=i&63,isNaN(r)?o=l=64:isNaN(i)&&(l=64),e+=_u.charAt(s)+_u.charAt(a)+_u.charAt(o)+_u.charAt(l);return e}function dc(n){var e="",t=0,r=0,i=0,s=0,a=0,o=0,l=0;n=n.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<n.length;)s=_u.indexOf(n.charAt(c++)),a=_u.indexOf(n.charAt(c++)),t=s<<2|a>>4,e+=String.fromCharCode(t),o=_u.indexOf(n.charAt(c++)),r=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(r)),l=_u.indexOf(n.charAt(c++)),i=(o&3)<<6|l,l!==64&&(e+=String.fromCharCode(i));return e}var Fn=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Ec=(function(){if(typeof Buffer<"u"){var n=!Buffer.from;if(!n)try{Buffer.from("foo","utf8")}catch{n=!0}return n?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}})();function Td(n){return Fn?Buffer.alloc?Buffer.alloc(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}function yO(n){return Fn?Buffer.allocUnsafe?Buffer.allocUnsafe(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}var ho=function(e){return Fn?Ec(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)&255})};function OE(n){if(typeof ArrayBuffer>"u")return ho(n);for(var e=new ArrayBuffer(n.length),t=new Uint8Array(e),r=0;r!=n.length;++r)t[r]=n.charCodeAt(r)&255;return e}function iy(n){if(Array.isArray(n))return n.map(function(r){return String.fromCharCode(r)}).join("");for(var e=[],t=0;t<n.length;++t)e[t]=String.fromCharCode(n[t]);return e.join("")}function Tye(n){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(n)}var $i=Fn?function(n){return Buffer.concat(n.map(function(e){return Buffer.isBuffer(e)?e:Ec(e)}))}:function(n){if(typeof Uint8Array<"u"){var e=0,t=0;for(e=0;e<n.length;++e)t+=n[e].length;var r=new Uint8Array(t),i=0;for(e=0,t=0;e<n.length;t+=i,++e)if(i=n[e].length,n[e]instanceof Uint8Array)r.set(n[e],t);else{if(typeof n[e]=="string")throw"wtf";r.set(new Uint8Array(n[e]),t)}return r}return[].concat.apply([],n.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function Rye(n){for(var e=[],t=0,r=n.length+250,i=Td(n.length+255),s=0;s<n.length;++s){var a=n.charCodeAt(s);if(a<128)i[t++]=a;else if(a<2048)i[t++]=192|a>>6&31,i[t++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=n.charCodeAt(++s)&1023;i[t++]=240|a>>8&7,i[t++]=128|a>>2&63,i[t++]=128|o>>6&15|(a&3)<<4,i[t++]=128|o&63}else i[t++]=224|a>>12&15,i[t++]=128|a>>6&63,i[t++]=128|a&63;t>r&&(e.push(i.slice(0,t)),t=0,i=Td(65535),r=65530)}return e.push(i.slice(0,t)),$i(e)}var hp=/\u0000/g,Hx=/[\u0001-\u0006]/g;function R0(n){for(var e="",t=n.length-1;t>=0;)e+=n.charAt(t--);return e}function mo(n,e){var t=""+n;return t.length>=e?t:Vr("0",e-t.length)+t}function aC(n,e){var t=""+n;return t.length>=e?t:Vr(" ",e-t.length)+t}function rw(n,e){var t=""+n;return t.length>=e?t:t+Vr(" ",e-t.length)}function Aye(n,e){var t=""+Math.round(n);return t.length>=e?t:Vr("0",e-t.length)+t}function kye(n,e){var t=""+n;return t.length>=e?t:Vr("0",e-t.length)+t}var xO=Math.pow(2,32);function Vf(n,e){if(n>xO||n<-xO)return Aye(n,e);var t=Math.round(n);return kye(t,e)}function iw(n,e){return e=e||0,n.length>=7+e&&(n.charCodeAt(e)|32)===103&&(n.charCodeAt(e+1)|32)===101&&(n.charCodeAt(e+2)|32)===110&&(n.charCodeAt(e+3)|32)===101&&(n.charCodeAt(e+4)|32)===114&&(n.charCodeAt(e+5)|32)===97&&(n.charCodeAt(e+6)|32)===108}var _O=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Fb=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Iye(n){return n||(n={}),n[0]="General",n[1]="0",n[2]="0.00",n[3]="#,##0",n[4]="#,##0.00",n[9]="0%",n[10]="0.00%",n[11]="0.00E+00",n[12]="# ?/?",n[13]="# ??/??",n[14]="m/d/yy",n[15]="d-mmm-yy",n[16]="d-mmm",n[17]="mmm-yy",n[18]="h:mm AM/PM",n[19]="h:mm:ss AM/PM",n[20]="h:mm",n[21]="h:mm:ss",n[22]="m/d/yy h:mm",n[37]="#,##0 ;(#,##0)",n[38]="#,##0 ;[Red](#,##0)",n[39]="#,##0.00;(#,##0.00)",n[40]="#,##0.00;[Red](#,##0.00)",n[45]="mm:ss",n[46]="[h]:mm:ss",n[47]="mmss.0",n[48]="##0.0E+0",n[49]="@",n[56]='"/ "hh""mm""ss" "',n}var Gr={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},vO={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Cye={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function sw(n,e,t){for(var r=n<0?-1:1,i=n*r,s=0,a=1,o=0,l=1,c=0,h=0,g=Math.floor(i);c<e&&(g=Math.floor(i),o=g*a+s,h=g*c+l,!(i-g<5e-8));)i=1/(i-g),s=a,a=o,l=c,c=h;if(h>e&&(c>e?(h=l,o=s):(h=c,o=a)),!t)return[0,r*o,h];var m=Math.floor(r*o/h);return[m,r*o-m*h,h]}function Kx(n,e,t){if(n>2958465||n<0)return null;var r=n|0,i=Math.floor(86400*(n-r)),s=0,a=[],o={D:r,T:i,u:86400*(n-r)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(r+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++r,++o.D)),r===60)a=t?[1317,10,29]:[1900,2,29],s=3;else if(r===0)a=t?[1317,8,29]:[1900,1,0],s=6;else{r>60&&--r;var l=new Date(1900,0,1);l.setDate(l.getDate()+r-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),r<60&&(s=(s+6)%7),t&&(s=jye(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var AB=new Date(1899,11,31,0,0,0),Pye=AB.getTime(),Nye=new Date(1900,2,1,0,0,0);function kB(n,e){var t=n.getTime();return e?t-=1461*24*60*60*1e3:n>=Nye&&(t+=1440*60*1e3),(t-(Pye+(n.getTimezoneOffset()-AB.getTimezoneOffset())*6e4))/(1440*60*1e3)}function oC(n){return n.indexOf(".")==-1?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Mye(n){return n.indexOf("E")==-1?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Lye(n){var e=n<0?12:11,t=oC(n.toFixed(12));return t.length<=e||(t=n.toPrecision(10),t.length<=e)?t:n.toExponential(5)}function Oye(n){var e=oC(n.toFixed(11));return e.length>(n<0?12:11)||e==="0"||e==="-0"?n.toPrecision(6):e}function Dye(n){var e=Math.floor(Math.log(Math.abs(n))*Math.LOG10E),t;return e>=-4&&e<=-1?t=n.toPrecision(10+e):Math.abs(e)<=9?t=Lye(n):e===10?t=n.toFixed(10).substr(0,12):t=Oye(n),oC(Mye(t.toUpperCase()))}function UR(n,e){switch(typeof n){case"string":return n;case"boolean":return n?"TRUE":"FALSE";case"number":return(n|0)===n?n.toString(10):Dye(n);case"undefined":return"";case"object":if(n==null)return"";if(n instanceof Date)return $u(14,kB(n,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+n)}function jye(n,e){e[0]-=581;var t=n.getDay();return n<60&&(t=(t+6)%7),t}function Fye(n,e,t,r){var i="",s=0,a=0,o=t.y,l,c=0;switch(n){case 98:o=t.y+543;case 121:switch(e.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(e.length){case 1:case 2:l=t.m,c=e.length;break;case 3:return Fb[t.m-1][1];case 5:return Fb[t.m-1][0];default:return Fb[t.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=t.d,c=e.length;break;case 3:return _O[t.q][0];default:return _O[t.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(t.H+11)%12,c=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=t.H,c=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=t.M,c=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return t.u===0&&(e=="s"||e=="ss")?mo(t.S,e.length):(r>=2?a=r===3?1e3:100:a=r===1?10:1,s=Math.round(a*(t.S+t.u)),s>=60*a&&(s=0),e==="s"?s===0?"0":""+s/a:(i=mo(s,2+r),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=t.D*24+t.H;break;case"[m]":case"[mm]":l=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":l=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+e}c=e.length===3?1:2;break;case 101:l=o,c=1;break}var h=c>0?mo(l,c):"";return h}function vu(n){var e=3;if(n.length<=e)return n;for(var t=n.length%e,r=n.substr(0,t);t!=n.length;t+=e)r+=(r.length>0?",":"")+n.substr(t,e);return r}var IB=/%/g;function Vye(n,e,t){var r=e.replace(IB,""),i=e.length-r.length;return tc(n,r,t*Math.pow(10,2*i))+Vr("%",i)}function Bye(n,e,t){for(var r=e.length-1;e.charCodeAt(r-1)===44;)--r;return tc(n,e.substr(0,r),t/Math.pow(10,3*(e.length-r)))}function CB(n,e){var t,r=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+CB(n,-e);var i=n.indexOf(".");i===-1&&(i=n.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),t=(e/Math.pow(10,s)).toPrecision(r+1+(i+s)%i),t.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(a-t.length+s):t+="E+"+(a-s);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,i)+"."+t.substr(2+i),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,h){return l+c+h.substr(0,(i+s)%i)+"."+h.substr(s)+"E"})}else t=e.toExponential(r);return n.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),n.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var PB=/# (\?+)( ?)\/( ?)(\d+)/;function Gye(n,e,t){var r=parseInt(n[4],10),i=Math.round(e*r),s=Math.floor(i/r),a=i-s*r,o=r;return t+(s===0?"":""+s)+" "+(a===0?Vr(" ",n[1].length+1+n[4].length):aC(a,n[1].length)+n[2]+"/"+n[3]+mo(o,n[4].length))}function zye(n,e,t){return t+(e===0?"":""+e)+Vr(" ",n[1].length+2+n[4].length)}var NB=/^#*0*\.([0#]+)/,MB=/\).*[0#]/,LB=/\(###\) ###\\?-####/;function xs(n){for(var e="",t,r=0;r!=n.length;++r)switch(t=n.charCodeAt(r)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(t)}return e}function wO(n,e){var t=Math.pow(10,e);return""+Math.round(n*t)/t}function EO(n,e){var t=n-Math.floor(n),r=Math.pow(10,e);return e<(""+Math.round(t*r)).length?0:Math.round(t*r)}function Uye(n,e){return e<(""+Math.round((n-Math.floor(n))*Math.pow(10,e))).length?1:0}function $ye(n){return n<2147483647&&n>-2147483648?""+(n>=0?n|0:n-1|0):""+Math.floor(n)}function ka(n,e,t){if(n.charCodeAt(0)===40&&!e.match(MB)){var r=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?ka("n",r,t):"("+ka("n",r,-t)+")"}if(e.charCodeAt(e.length-1)===44)return Bye(n,e,t);if(e.indexOf("%")!==-1)return Vye(n,e,t);if(e.indexOf("E")!==-1)return CB(e,t);if(e.charCodeAt(0)===36)return"$"+ka(n,e.substr(e.charAt(1)==" "?2:1),t);var i,s,a,o,l=Math.abs(t),c=t<0?"-":"";if(e.match(/^00+$/))return c+Vf(l,e.length);if(e.match(/^[#?]+$/))return i=Vf(t,0),i==="0"&&(i=""),i.length>e.length?i:xs(e.substr(0,e.length-i.length))+i;if(s=e.match(PB))return Gye(s,l,c);if(e.match(/^#+0+$/))return c+Vf(l,e.length-e.indexOf("0"));if(s=e.match(NB))return i=wO(t,s[1].length).replace(/^([^\.]+)$/,"$1."+xs(s[1])).replace(/\.$/,"."+xs(s[1])).replace(/\.(\d*)$/,function(_,x){return"."+x+Vr("0",xs(s[1]).length-x.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return c+wO(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return c+vu(Vf(l,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+ka(n,e,-t):vu(""+(Math.floor(t)+Uye(t,s[1].length)))+"."+mo(EO(t,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return ka(n,e.replace(/^#,#*,/,""),t);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=R0(ka(n,e.replace(/[\\-]/g,""),t)),a=0,R0(R0(e.replace(/\\/g,"")).replace(/[0#]/g,function(_){return a<i.length?i.charAt(a++):_==="0"?"0":""}));if(e.match(LB))return i=ka(n,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var h="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=sw(l,Math.pow(10,a)-1,!1),i=""+c,h=tc("n",s[1],o[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),i+=h+s[2]+"/"+s[3],h=rw(o[2],a),h.length<s[4].length&&(h=xs(s[4].substr(s[4].length-h.length))+h),i+=h,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=sw(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?aC(o[1],a)+s[2]+"/"+s[3]+rw(o[2],a):Vr(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=Vf(t,0),e.length<=i.length?i:xs(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var g=e.indexOf(".")-a,m=e.length-i.length-g;return xs(e.substr(0,g)+i+e.substr(e.length-m))}if(s=e.match(/^00,000\.([#0]*0)$/))return a=EO(t,s[1].length),t<0?"-"+ka(n,e,-t):vu($ye(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(_){return"00,"+(_.length<3?mo(0,3-_.length):"")+_})+"."+mo(a,s[1].length);switch(e){case"###,##0.00":return ka(n,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var y=vu(Vf(l,0));return y!=="0"?c+y:"";case"###,###.00":return ka(n,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return ka(n,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function Wye(n,e,t){for(var r=e.length-1;e.charCodeAt(r-1)===44;)--r;return tc(n,e.substr(0,r),t/Math.pow(10,3*(e.length-r)))}function Hye(n,e,t){var r=e.replace(IB,""),i=e.length-r.length;return tc(n,r,t*Math.pow(10,2*i))+Vr("%",i)}function OB(n,e){var t,r=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+OB(n,-e);var i=n.indexOf(".");i===-1&&(i=n.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),t=(e/Math.pow(10,s)).toPrecision(r+1+(i+s)%i),!t.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(a-t.length+s):t+="E+"+(a-s),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,h){return l+c+h.substr(0,(i+s)%i)+"."+h.substr(s)+"E"})}else t=e.toExponential(r);return n.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),n.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function Ho(n,e,t){if(n.charCodeAt(0)===40&&!e.match(MB)){var r=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Ho("n",r,t):"("+Ho("n",r,-t)+")"}if(e.charCodeAt(e.length-1)===44)return Wye(n,e,t);if(e.indexOf("%")!==-1)return Hye(n,e,t);if(e.indexOf("E")!==-1)return OB(e,t);if(e.charCodeAt(0)===36)return"$"+Ho(n,e.substr(e.charAt(1)==" "?2:1),t);var i,s,a,o,l=Math.abs(t),c=t<0?"-":"";if(e.match(/^00+$/))return c+mo(l,e.length);if(e.match(/^[#?]+$/))return i=""+t,t===0&&(i=""),i.length>e.length?i:xs(e.substr(0,e.length-i.length))+i;if(s=e.match(PB))return zye(s,l,c);if(e.match(/^#+0+$/))return c+mo(l,e.length-e.indexOf("0"));if(s=e.match(NB))return i=(""+t).replace(/^([^\.]+)$/,"$1."+xs(s[1])).replace(/\.$/,"."+xs(s[1])),i=i.replace(/\.(\d*)$/,function(_,x){return"."+x+Vr("0",xs(s[1]).length-x.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return c+vu(""+l);if(s=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Ho(n,e,-t):vu(""+t)+"."+Vr("0",s[1].length);if(s=e.match(/^#,#*,#0/))return Ho(n,e.replace(/^#,#*,/,""),t);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=R0(Ho(n,e.replace(/[\\-]/g,""),t)),a=0,R0(R0(e.replace(/\\/g,"")).replace(/[0#]/g,function(_){return a<i.length?i.charAt(a++):_==="0"?"0":""}));if(e.match(LB))return i=Ho(n,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var h="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=sw(l,Math.pow(10,a)-1,!1),i=""+c,h=tc("n",s[1],o[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),i+=h+s[2]+"/"+s[3],h=rw(o[2],a),h.length<s[4].length&&(h=xs(s[4].substr(s[4].length-h.length))+h),i+=h,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=sw(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?aC(o[1],a)+s[2]+"/"+s[3]+rw(o[2],a):Vr(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+t,e.length<=i.length?i:xs(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var g=e.indexOf(".")-a,m=e.length-i.length-g;return xs(e.substr(0,g)+i+e.substr(e.length-m))}if(s=e.match(/^00,000\.([#0]*0)$/))return t<0?"-"+Ho(n,e,-t):vu(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(_){return"00,"+(_.length<3?mo(0,3-_.length):"")+_})+"."+mo(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var y=vu(""+l);return y!=="0"?c+y:"";default:if(e.match(/\.[0#?]*$/))return Ho(n,e.slice(0,e.lastIndexOf(".")),t)+xs(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function tc(n,e,t){return(t|0)===t?Ho(n,e,t):ka(n,e,t)}function Kye(n){for(var e=[],t=!1,r=0,i=0;r<n.length;++r)switch(n.charCodeAt(r)){case 34:t=!t;break;case 95:case 42:case 92:++r;break;case 59:e[e.length]=n.substr(i,r-i),i=r+1}if(e[e.length]=n.substr(i),t===!0)throw new Error("Format |"+n+"| unterminated string ");return e}var DB=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function jB(n){for(var e=0,t="",r="";e<n.length;)switch(t=n.charAt(e)){case"G":iw(n,e)&&(e+=6),e++;break;case'"':for(;n.charCodeAt(++e)!==34&&e<n.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(n.charAt(e+1)==="1"||n.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(n.substr(e,3).toUpperCase()==="A/P"||n.substr(e,5).toUpperCase()==="AM/PM"||n.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(r=t;n.charAt(e++)!=="]"&&e<n.length;)r+=n.charAt(e);if(r.match(DB))return!0;break;case".":case"0":case"#":for(;e<n.length&&("0#?.,E+-%".indexOf(t=n.charAt(++e))>-1||t=="\\"&&n.charAt(e+1)=="-"&&"0#".indexOf(n.charAt(e+2))>-1););break;case"?":for(;n.charAt(++e)===t;);break;case"*":++e,(n.charAt(e)==" "||n.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<n.length&&"0123456789".indexOf(n.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function Xye(n,e,t,r){for(var i=[],s="",a=0,o="",l="t",c,h,g,m="H";a<n.length;)switch(o=n.charAt(a)){case"G":if(!iw(n,a))throw new Error("unrecognized character "+o+" in "+n);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(g=n.charCodeAt(++a))!==34&&a<n.length;)s+=String.fromCharCode(g);i[i.length]={t:"t",v:s},++a;break;case"\\":var y=n.charAt(++a),_=y==="("||y===")"?y:"t";i[i.length]={t:_,v:y},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:e},++a;break;case"B":case"b":if(n.charAt(a+1)==="1"||n.charAt(a+1)==="2"){if(c==null&&(c=Kx(e,t,n.charAt(a+1)==="2"),c==null))return"";i[i.length]={t:"X",v:n.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||c==null&&(c=Kx(e,t),c==null))return"";for(s=o;++a<n.length&&n.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=m),i[i.length]={t:o,v:s},l=o;break;case"A":case"a":case"":var x={t:o,v:o};if(c==null&&(c=Kx(e,t)),n.substr(a,3).toUpperCase()==="A/P"?(c!=null&&(x.v=c.H>=12?"P":"A"),x.t="T",m="h",a+=3):n.substr(a,5).toUpperCase()==="AM/PM"?(c!=null&&(x.v=c.H>=12?"PM":"AM"),x.t="T",a+=5,m="h"):n.substr(a,5).toUpperCase()==="/"?(c!=null&&(x.v=c.H>=12?"":""),x.t="T",a+=5,m="h"):(x.t="t",++a),c==null&&x.t==="T")return"";i[i.length]=x,l=o;break;case"[":for(s=o;n.charAt(a++)!=="]"&&a<n.length;)s+=n.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(DB)){if(c==null&&(c=Kx(e,t),c==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",jB(n)||(i[i.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=o;++a<n.length&&(o=n.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<n.length&&"0#?.,E+-%".indexOf(o=n.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;n.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},l=o;break;case"*":++a,(n.charAt(a)==" "||n.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:r===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<n.length&&"0123456789".indexOf(n.charAt(++a))>-1;)s+=n.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+n);i[i.length]={t:"t",v:o},++a;break}var w=0,b=0,T;for(a=i.length-1,l="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=m,l="h",w<1&&(w=1);break;case"s":(T=i[a].v.match(/\.0+$/))&&(b=Math.max(b,T[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":l=i[a].t;break;case"m":l==="s"&&(i[a].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&i[a].v.match(/[Hh]/)&&(w=1),w<2&&i[a].v.match(/[Mm]/)&&(w=2),w<3&&i[a].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var k="",L;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=Fye(i[a].t.charCodeAt(0),i[a].v,c,b),i[a].t="t";break;case"n":case"?":for(L=a+1;i[L]!=null&&((o=i[L].t)==="?"||o==="D"||(o===" "||o==="t")&&i[L+1]!=null&&(i[L+1].t==="?"||i[L+1].t==="t"&&i[L+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[L].v==="/"||i[L].v===" "&&i[L+1]!=null&&i[L+1].t=="?"));)i[a].v+=i[L].v,i[L]={v:"",t:";"},++L;k+=i[a].v,a=L-1;break;case"G":i[a].t="t",i[a].v=UR(e,t);break}var O="",B,R;if(k.length>0){k.charCodeAt(0)==40?(B=e<0&&k.charCodeAt(0)===45?-e:e,R=tc("n",k,B)):(B=e<0&&r>1?-e:e,R=tc("n",k,B),B<0&&i[0]&&i[0].t=="t"&&(R=R.substr(1),i[0].v="-"+i[0].v)),L=R.length-1;var A=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){A=a;break}var P=i.length;if(A===i.length&&R.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(L>=i[a].v.length-1?(L-=i[a].v.length,i[a].v=R.substr(L+1,i[a].v.length)):L<0?i[a].v="":(i[a].v=R.substr(0,L+1),L=-1),i[a].t="t",P=a);L>=0&&P<i.length&&(i[P].v=R.substr(0,L+1)+i[P].v)}else if(A!==i.length&&R.indexOf("E")===-1){for(L=R.indexOf(".")-1,a=A;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(h=i[a].v.indexOf(".")>-1&&a===A?i[a].v.indexOf(".")-1:i[a].v.length-1,O=i[a].v.substr(h+1);h>=0;--h)L>=0&&(i[a].v.charAt(h)==="0"||i[a].v.charAt(h)==="#")&&(O=R.charAt(L--)+O);i[a].v=O,i[a].t="t",P=a}for(L>=0&&P<i.length&&(i[P].v=R.substr(0,L+1)+i[P].v),L=R.indexOf(".")+1,a=A;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==A)){for(h=i[a].v.indexOf(".")>-1&&a===A?i[a].v.indexOf(".")+1:0,O=i[a].v.substr(0,h);h<i[a].v.length;++h)L<R.length&&(O+=R.charAt(L++));i[a].v=O,i[a].t="t",P=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(B=r>1&&e<0&&a>0&&i[a-1].v==="-"?-e:e,i[a].v=tc(i[a].t,i[a].v,B),i[a].t="t");var D="";for(a=0;a!==i.length;++a)i[a]!=null&&(D+=i[a].v);return D}var SO=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function bO(n,e){if(e==null)return!1;var t=parseFloat(e[2]);switch(e[1]){case"=":if(n==t)return!0;break;case">":if(n>t)return!0;break;case"<":if(n<t)return!0;break;case"<>":if(n!=t)return!0;break;case">=":if(n>=t)return!0;break;case"<=":if(n<=t)return!0;break}return!1}function qye(n,e){var t=Kye(n),r=t.length,i=t[r-1].indexOf("@");if(r<4&&i>-1&&--r,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof e!="number")return[4,t.length===4||i>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=i>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=i>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=i>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var s=e>0?t[0]:e<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[r,s];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var a=t[0].match(SO),o=t[1].match(SO);return bO(e,a)?[r,t[0]]:bO(e,o)?[r,t[1]]:[r,t[a!=null&&o!=null?2:1]]}return[r,s]}function $u(n,e,t){t==null&&(t={});var r="";switch(typeof n){case"string":n=="m/d/yy"&&t.dateNF?r=t.dateNF:r=n;break;case"number":n==14&&t.dateNF?r=t.dateNF:r=(t.table!=null?t.table:Gr)[n],r==null&&(r=t.table&&t.table[vO[n]]||Gr[vO[n]]),r==null&&(r=Cye[n]||"General");break}if(iw(r,0))return UR(e,t);e instanceof Date&&(e=kB(e,t.date1904));var i=qye(r,e);if(iw(i[1]))return UR(e,t);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return Xye(i[1],e,t,i[0])}function FB(n,e){if(typeof e!="number"){e=+e||-1;for(var t=0;t<392;++t){if(Gr[t]==null){e<0&&(e=t);continue}if(Gr[t]==n){e=t;break}}e<0&&(e=391)}return Gr[e]=n,e}function DE(n){for(var e=0;e!=392;++e)n[e]!==void 0&&FB(n[e],e)}function jE(){Gr=Iye()}var VB=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Yye(n){var e=typeof n=="number"?Gr[n]:n;return e=e.replace(VB,"(\\d+)"),new RegExp("^"+e+"$")}function Zye(n,e,t){var r=-1,i=-1,s=-1,a=-1,o=-1,l=-1;(e.match(VB)||[]).forEach(function(g,m){var y=parseInt(t[m+1],10);switch(g.toLowerCase().charAt(0)){case"y":r=y;break;case"d":s=y;break;case"h":a=y;break;case"s":l=y;break;case"m":a>=0?o=y:i=y;break}}),l>=0&&o==-1&&i>=0&&(o=i,i=-1);var c=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var h=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?c:r==-1&&i==-1&&s==-1?h:c+"T"+h}var Jye=(function(){var n={};n.version="1.2.0";function e(){for(var R=0,A=new Array(256),P=0;P!=256;++P)R=P,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,A[P]=R;return typeof Int32Array<"u"?new Int32Array(A):A}var t=e();function r(R){var A=0,P=0,D=0,N=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(D=0;D!=256;++D)N[D]=R[D];for(D=0;D!=256;++D)for(P=R[D],A=256+D;A<4096;A+=256)P=N[A]=P>>>8^R[P&255];var G=[];for(D=1;D!=16;++D)G[D-1]=typeof Int32Array<"u"?N.subarray(D*256,D*256+256):N.slice(D*256,D*256+256);return G}var i=r(t),s=i[0],a=i[1],o=i[2],l=i[3],c=i[4],h=i[5],g=i[6],m=i[7],y=i[8],_=i[9],x=i[10],w=i[11],b=i[12],T=i[13],k=i[14];function L(R,A){for(var P=A^-1,D=0,N=R.length;D<N;)P=P>>>8^t[(P^R.charCodeAt(D++))&255];return~P}function O(R,A){for(var P=A^-1,D=R.length-15,N=0;N<D;)P=k[R[N++]^P&255]^T[R[N++]^P>>8&255]^b[R[N++]^P>>16&255]^w[R[N++]^P>>>24]^x[R[N++]]^_[R[N++]]^y[R[N++]]^m[R[N++]]^g[R[N++]]^h[R[N++]]^c[R[N++]]^l[R[N++]]^o[R[N++]]^a[R[N++]]^s[R[N++]]^t[R[N++]];for(D+=15;N<D;)P=P>>>8^t[(P^R[N++])&255];return~P}function B(R,A){for(var P=A^-1,D=0,N=R.length,G=0,j=0;D<N;)G=R.charCodeAt(D++),G<128?P=P>>>8^t[(P^G)&255]:G<2048?(P=P>>>8^t[(P^(192|G>>6&31))&255],P=P>>>8^t[(P^(128|G&63))&255]):G>=55296&&G<57344?(G=(G&1023)+64,j=R.charCodeAt(D++)&1023,P=P>>>8^t[(P^(240|G>>8&7))&255],P=P>>>8^t[(P^(128|G>>2&63))&255],P=P>>>8^t[(P^(128|j>>6&15|(G&3)<<4))&255],P=P>>>8^t[(P^(128|j&63))&255]):(P=P>>>8^t[(P^(224|G>>12&15))&255],P=P>>>8^t[(P^(128|G>>6&63))&255],P=P>>>8^t[(P^(128|G&63))&255]);return~P}return n.table=t,n.bstr=L,n.buf=O,n.str=B,n})(),rr=(function(){var e={};e.version="1.2.1";function t(z,Z){for(var X=z.split("/"),Y=Z.split("/"),Q=0,ee=0,Ee=Math.min(X.length,Y.length);Q<Ee;++Q){if(ee=X[Q].length-Y[Q].length)return ee;if(X[Q]!=Y[Q])return X[Q]<Y[Q]?-1:1}return X.length-Y.length}function r(z){if(z.charAt(z.length-1)=="/")return z.slice(0,-1).indexOf("/")===-1?z:r(z.slice(0,-1));var Z=z.lastIndexOf("/");return Z===-1?z:z.slice(0,Z+1)}function i(z){if(z.charAt(z.length-1)=="/")return i(z.slice(0,-1));var Z=z.lastIndexOf("/");return Z===-1?z:z.slice(Z+1)}function s(z,Z){typeof Z=="string"&&(Z=new Date(Z));var X=Z.getHours();X=X<<6|Z.getMinutes(),X=X<<5|Z.getSeconds()>>>1,z.write_shift(2,X);var Y=Z.getFullYear()-1980;Y=Y<<4|Z.getMonth()+1,Y=Y<<5|Z.getDate(),z.write_shift(2,Y)}function a(z){var Z=z.read_shift(2)&65535,X=z.read_shift(2)&65535,Y=new Date,Q=X&31;X>>>=5;var ee=X&15;X>>>=4,Y.setMilliseconds(0),Y.setFullYear(X+1980),Y.setMonth(ee-1),Y.setDate(Q);var Ee=Z&31;Z>>>=5;var Oe=Z&63;return Z>>>=6,Y.setHours(Z),Y.setMinutes(Oe),Y.setSeconds(Ee<<1),Y}function o(z){sa(z,0);for(var Z={},X=0;z.l<=z.length-4;){var Y=z.read_shift(2),Q=z.read_shift(2),ee=z.l+Q,Ee={};switch(Y){case 21589:X=z.read_shift(1),X&1&&(Ee.mtime=z.read_shift(4)),Q>5&&(X&2&&(Ee.atime=z.read_shift(4)),X&4&&(Ee.ctime=z.read_shift(4))),Ee.mtime&&(Ee.mt=new Date(Ee.mtime*1e3));break}z.l=ee,Z[Y]=Ee}return Z}var l;function c(){return l||(l={})}function h(z,Z){if(z[0]==80&&z[1]==75)return Dt(z,Z);if((z[0]|32)==109&&(z[1]|32)==105)return ze(z,Z);if(z.length<512)throw new Error("CFB file size "+z.length+" < 512");var X=3,Y=512,Q=0,ee=0,Ee=0,Oe=0,we=0,Te=[],Re=z.slice(0,512);sa(Re,0);var Ye=g(Re);switch(X=Ye[0],X){case 3:Y=512;break;case 4:Y=4096;break;case 0:if(Ye[1]==0)return Dt(z,Z);default:throw new Error("Major Version: Expected 3 or 4 saw "+X)}Y!==512&&(Re=z.slice(0,Y),sa(Re,28));var st=z.slice(0,Y);m(Re,X);var pt=Re.read_shift(4,"i");if(X===3&&pt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+pt);Re.l+=4,Ee=Re.read_shift(4,"i"),Re.l+=4,Re.chk("00100000","Mini Stream Cutoff Size: "),Oe=Re.read_shift(4,"i"),Q=Re.read_shift(4,"i"),we=Re.read_shift(4,"i"),ee=Re.read_shift(4,"i");for(var Ze=-1,Je=0;Je<109&&(Ze=Re.read_shift(4,"i"),!(Ze<0));++Je)Te[Je]=Ze;var qt=y(z,Y);w(we,ee,qt,Y,Te);var zn=T(qt,Ee,Te,Y);zn[Ee].name="!Directory",Q>0&&Oe!==j&&(zn[Oe].name="!MiniFAT"),zn[Te[0]].name="!FAT",zn.fat_addrs=Te,zn.ssz=Y;var Kn={},yr=[],Ka=[],xa=[];k(Ee,zn,qt,yr,Q,Kn,Ka,Oe),_(Ka,xa,yr),yr.shift();var qs={FileIndex:Ka,FullPaths:xa};return Z&&Z.raw&&(qs.raw={header:st,sectors:qt}),qs}function g(z){if(z[z.l]==80&&z[z.l+1]==75)return[0,0];z.chk(ve,"Header Signature: "),z.l+=16;var Z=z.read_shift(2,"u");return[z.read_shift(2,"u"),Z]}function m(z,Z){var X=9;switch(z.l+=2,X=z.read_shift(2)){case 9:if(Z!=3)throw new Error("Sector Shift: Expected 9 saw "+X);break;case 12:if(Z!=4)throw new Error("Sector Shift: Expected 12 saw "+X);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+X)}z.chk("0600","Mini Sector Shift: "),z.chk("000000000000","Reserved: ")}function y(z,Z){for(var X=Math.ceil(z.length/Z)-1,Y=[],Q=1;Q<X;++Q)Y[Q-1]=z.slice(Q*Z,(Q+1)*Z);return Y[X-1]=z.slice(X*Z),Y}function _(z,Z,X){for(var Y=0,Q=0,ee=0,Ee=0,Oe=0,we=X.length,Te=[],Re=[];Y<we;++Y)Te[Y]=Re[Y]=Y,Z[Y]=X[Y];for(;Oe<Re.length;++Oe)Y=Re[Oe],Q=z[Y].L,ee=z[Y].R,Ee=z[Y].C,Te[Y]===Y&&(Q!==-1&&Te[Q]!==Q&&(Te[Y]=Te[Q]),ee!==-1&&Te[ee]!==ee&&(Te[Y]=Te[ee])),Ee!==-1&&(Te[Ee]=Y),Q!==-1&&Y!=Te[Y]&&(Te[Q]=Te[Y],Re.lastIndexOf(Q)<Oe&&Re.push(Q)),ee!==-1&&Y!=Te[Y]&&(Te[ee]=Te[Y],Re.lastIndexOf(ee)<Oe&&Re.push(ee));for(Y=1;Y<we;++Y)Te[Y]===Y&&(ee!==-1&&Te[ee]!==ee?Te[Y]=Te[ee]:Q!==-1&&Te[Q]!==Q&&(Te[Y]=Te[Q]));for(Y=1;Y<we;++Y)if(z[Y].type!==0){if(Oe=Y,Oe!=Te[Oe])do Oe=Te[Oe],Z[Y]=Z[Oe]+"/"+Z[Y];while(Oe!==0&&Te[Oe]!==-1&&Oe!=Te[Oe]);Te[Y]=-1}for(Z[0]+="/",Y=1;Y<we;++Y)z[Y].type!==2&&(Z[Y]+="/")}function x(z,Z,X){for(var Y=z.start,Q=z.size,ee=[],Ee=Y;X&&Q>0&&Ee>=0;)ee.push(Z.slice(Ee*G,Ee*G+G)),Q-=G,Ee=Vh(X,Ee*4);return ee.length===0?Le(0):$i(ee).slice(0,z.size)}function w(z,Z,X,Y,Q){var ee=j;if(z===j){if(Z!==0)throw new Error("DIFAT chain shorter than expected")}else if(z!==-1){var Ee=X[z],Oe=(Y>>>2)-1;if(!Ee)return;for(var we=0;we<Oe&&(ee=Vh(Ee,we*4))!==j;++we)Q.push(ee);w(Vh(Ee,Y-4),Z-1,X,Y,Q)}}function b(z,Z,X,Y,Q){var ee=[],Ee=[];Q||(Q=[]);var Oe=Y-1,we=0,Te=0;for(we=Z;we>=0;){Q[we]=!0,ee[ee.length]=we,Ee.push(z[we]);var Re=X[Math.floor(we*4/Y)];if(Te=we*4&Oe,Y<4+Te)throw new Error("FAT boundary crossed: "+we+" 4 "+Y);if(!z[Re])break;we=Vh(z[Re],Te)}return{nodes:ee,data:NO([Ee])}}function T(z,Z,X,Y){var Q=z.length,ee=[],Ee=[],Oe=[],we=[],Te=Y-1,Re=0,Ye=0,st=0,pt=0;for(Re=0;Re<Q;++Re)if(Oe=[],st=Re+Z,st>=Q&&(st-=Q),!Ee[st]){we=[];var Ze=[];for(Ye=st;Ye>=0;){Ze[Ye]=!0,Ee[Ye]=!0,Oe[Oe.length]=Ye,we.push(z[Ye]);var Je=X[Math.floor(Ye*4/Y)];if(pt=Ye*4&Te,Y<4+pt)throw new Error("FAT boundary crossed: "+Ye+" 4 "+Y);if(!z[Je]||(Ye=Vh(z[Je],pt),Ze[Ye]))break}ee[st]={nodes:Oe,data:NO([we])}}return ee}function k(z,Z,X,Y,Q,ee,Ee,Oe){for(var we=0,Te=Y.length?2:0,Re=Z[z].data,Ye=0,st=0,pt;Ye<Re.length;Ye+=128){var Ze=Re.slice(Ye,Ye+128);sa(Ze,64),st=Ze.read_shift(2),pt=dC(Ze,0,st-Te),Y.push(pt);var Je={name:pt,type:Ze.read_shift(1),color:Ze.read_shift(1),L:Ze.read_shift(4,"i"),R:Ze.read_shift(4,"i"),C:Ze.read_shift(4,"i"),clsid:Ze.read_shift(16),state:Ze.read_shift(4,"i"),start:0,size:0},qt=Ze.read_shift(2)+Ze.read_shift(2)+Ze.read_shift(2)+Ze.read_shift(2);qt!==0&&(Je.ct=L(Ze,Ze.l-8));var zn=Ze.read_shift(2)+Ze.read_shift(2)+Ze.read_shift(2)+Ze.read_shift(2);zn!==0&&(Je.mt=L(Ze,Ze.l-8)),Je.start=Ze.read_shift(4,"i"),Je.size=Ze.read_shift(4,"i"),Je.size<0&&Je.start<0&&(Je.size=Je.type=0,Je.start=j,Je.name=""),Je.type===5?(we=Je.start,Q>0&&we!==j&&(Z[we].name="!StreamData")):Je.size>=4096?(Je.storage="fat",Z[Je.start]===void 0&&(Z[Je.start]=b(X,Je.start,Z.fat_addrs,Z.ssz)),Z[Je.start].name=Je.name,Je.content=Z[Je.start].data.slice(0,Je.size)):(Je.storage="minifat",Je.size<0?Je.size=0:we!==j&&Je.start!==j&&Z[we]&&(Je.content=x(Je,Z[we].data,(Z[Oe]||{}).data))),Je.content&&sa(Je.content,0),ee[pt]=Je,Ee.push(Je)}}function L(z,Z){return new Date((la(z,Z+4)/1e7*Math.pow(2,32)+la(z,Z)/1e7-11644473600)*1e3)}function O(z,Z){return c(),h(l.readFileSync(z),Z)}function B(z,Z){var X=Z&&Z.type;switch(X||Fn&&Buffer.isBuffer(z)&&(X="buffer"),X||"base64"){case"file":return O(z,Z);case"base64":return h(ho(dc(z)),Z);case"binary":return h(ho(z),Z)}return h(z,Z)}function R(z,Z){var X=Z||{},Y=X.root||"Root Entry";if(z.FullPaths||(z.FullPaths=[]),z.FileIndex||(z.FileIndex=[]),z.FullPaths.length!==z.FileIndex.length)throw new Error("inconsistent CFB structure");z.FullPaths.length===0&&(z.FullPaths[0]=Y+"/",z.FileIndex[0]={name:Y,type:5}),X.CLSID&&(z.FileIndex[0].clsid=X.CLSID),A(z)}function A(z){var Z="Sh33tJ5";if(!rr.find(z,"/"+Z)){var X=Le(4);X[0]=55,X[1]=X[3]=50,X[2]=54,z.FileIndex.push({name:Z,type:2,content:X,size:4,L:69,R:69,C:69}),z.FullPaths.push(z.FullPaths[0]+Z),P(z)}}function P(z,Z){R(z);for(var X=!1,Y=!1,Q=z.FullPaths.length-1;Q>=0;--Q){var ee=z.FileIndex[Q];switch(ee.type){case 0:Y?X=!0:(z.FileIndex.pop(),z.FullPaths.pop());break;case 1:case 2:case 5:Y=!0,isNaN(ee.R*ee.L*ee.C)&&(X=!0),ee.R>-1&&ee.L>-1&&ee.R==ee.L&&(X=!0);break;default:X=!0;break}}if(!(!X&&!Z)){var Ee=new Date(1987,1,19),Oe=0,we=Object.create?Object.create(null):{},Te=[];for(Q=0;Q<z.FullPaths.length;++Q)we[z.FullPaths[Q]]=!0,z.FileIndex[Q].type!==0&&Te.push([z.FullPaths[Q],z.FileIndex[Q]]);for(Q=0;Q<Te.length;++Q){var Re=r(Te[Q][0]);Y=we[Re],Y||(Te.push([Re,{name:i(Re).replace("/",""),type:1,clsid:je,ct:Ee,mt:Ee,content:null}]),we[Re]=!0)}for(Te.sort(function(pt,Ze){return t(pt[0],Ze[0])}),z.FullPaths=[],z.FileIndex=[],Q=0;Q<Te.length;++Q)z.FullPaths[Q]=Te[Q][0],z.FileIndex[Q]=Te[Q][1];for(Q=0;Q<Te.length;++Q){var Ye=z.FileIndex[Q],st=z.FullPaths[Q];if(Ye.name=i(st).replace("/",""),Ye.L=Ye.R=Ye.C=-(Ye.color=1),Ye.size=Ye.content?Ye.content.length:0,Ye.start=0,Ye.clsid=Ye.clsid||je,Q===0)Ye.C=Te.length>1?1:-1,Ye.size=0,Ye.type=5;else if(st.slice(-1)=="/"){for(Oe=Q+1;Oe<Te.length&&r(z.FullPaths[Oe])!=st;++Oe);for(Ye.C=Oe>=Te.length?-1:Oe,Oe=Q+1;Oe<Te.length&&r(z.FullPaths[Oe])!=r(st);++Oe);Ye.R=Oe>=Te.length?-1:Oe,Ye.type=1}else r(z.FullPaths[Q+1]||"")==r(st)&&(Ye.R=Q+1),Ye.type=2}}}function D(z,Z){var X=Z||{};if(X.fileType=="mad")return Me(z,X);switch(P(z),X.fileType){case"zip":return ut(z,X)}var Y=(function(pt){for(var Ze=0,Je=0,qt=0;qt<pt.FileIndex.length;++qt){var zn=pt.FileIndex[qt];if(zn.content){var Kn=zn.content.length;Kn>0&&(Kn<4096?Ze+=Kn+63>>6:Je+=Kn+511>>9)}}for(var yr=pt.FullPaths.length+3>>2,Ka=Ze+7>>3,xa=Ze+127>>7,qs=Ka+Je+yr+xa,zr=qs+127>>7,Sc=zr<=109?0:Math.ceil((zr-109)/127);qs+zr+Sc+127>>7>zr;)Sc=++zr<=109?0:Math.ceil((zr-109)/127);var Rr=[1,Sc,zr,xa,yr,Je,Ze,0];return pt.FileIndex[0].size=Ze<<6,Rr[7]=(pt.FileIndex[0].start=Rr[0]+Rr[1]+Rr[2]+Rr[3]+Rr[4]+Rr[5])+(Rr[6]+7>>3),Rr})(z),Q=Le(Y[7]<<9),ee=0,Ee=0;{for(ee=0;ee<8;++ee)Q.write_shift(1,ce[ee]);for(ee=0;ee<8;++ee)Q.write_shift(2,0);for(Q.write_shift(2,62),Q.write_shift(2,3),Q.write_shift(2,65534),Q.write_shift(2,9),Q.write_shift(2,6),ee=0;ee<3;++ee)Q.write_shift(2,0);for(Q.write_shift(4,0),Q.write_shift(4,Y[2]),Q.write_shift(4,Y[0]+Y[1]+Y[2]+Y[3]-1),Q.write_shift(4,0),Q.write_shift(4,4096),Q.write_shift(4,Y[3]?Y[0]+Y[1]+Y[2]-1:j),Q.write_shift(4,Y[3]),Q.write_shift(-4,Y[1]?Y[0]-1:j),Q.write_shift(4,Y[1]),ee=0;ee<109;++ee)Q.write_shift(-4,ee<Y[2]?Y[1]+ee:-1)}if(Y[1])for(Ee=0;Ee<Y[1];++Ee){for(;ee<236+Ee*127;++ee)Q.write_shift(-4,ee<Y[2]?Y[1]+ee:-1);Q.write_shift(-4,Ee===Y[1]-1?j:Ee+1)}var Oe=function(pt){for(Ee+=pt;ee<Ee-1;++ee)Q.write_shift(-4,ee+1);pt&&(++ee,Q.write_shift(-4,j))};for(Ee=ee=0,Ee+=Y[1];ee<Ee;++ee)Q.write_shift(-4,Pe.DIFSECT);for(Ee+=Y[2];ee<Ee;++ee)Q.write_shift(-4,Pe.FATSECT);Oe(Y[3]),Oe(Y[4]);for(var we=0,Te=0,Re=z.FileIndex[0];we<z.FileIndex.length;++we)Re=z.FileIndex[we],Re.content&&(Te=Re.content.length,!(Te<4096)&&(Re.start=Ee,Oe(Te+511>>9)));for(Oe(Y[6]+7>>3);Q.l&511;)Q.write_shift(-4,Pe.ENDOFCHAIN);for(Ee=ee=0,we=0;we<z.FileIndex.length;++we)Re=z.FileIndex[we],Re.content&&(Te=Re.content.length,!(!Te||Te>=4096)&&(Re.start=Ee,Oe(Te+63>>6)));for(;Q.l&511;)Q.write_shift(-4,Pe.ENDOFCHAIN);for(ee=0;ee<Y[4]<<2;++ee){var Ye=z.FullPaths[ee];if(!Ye||Ye.length===0){for(we=0;we<17;++we)Q.write_shift(4,0);for(we=0;we<3;++we)Q.write_shift(4,-1);for(we=0;we<12;++we)Q.write_shift(4,0);continue}Re=z.FileIndex[ee],ee===0&&(Re.start=Re.size?Re.start-1:j);var st=ee===0&&X.root||Re.name;if(Te=2*(st.length+1),Q.write_shift(64,st,"utf16le"),Q.write_shift(2,Te),Q.write_shift(1,Re.type),Q.write_shift(1,Re.color),Q.write_shift(-4,Re.L),Q.write_shift(-4,Re.R),Q.write_shift(-4,Re.C),Re.clsid)Q.write_shift(16,Re.clsid,"hex");else for(we=0;we<4;++we)Q.write_shift(4,0);Q.write_shift(4,Re.state||0),Q.write_shift(4,0),Q.write_shift(4,0),Q.write_shift(4,0),Q.write_shift(4,0),Q.write_shift(4,Re.start),Q.write_shift(4,Re.size),Q.write_shift(4,0)}for(ee=1;ee<z.FileIndex.length;++ee)if(Re=z.FileIndex[ee],Re.size>=4096)if(Q.l=Re.start+1<<9,Fn&&Buffer.isBuffer(Re.content))Re.content.copy(Q,Q.l,0,Re.size),Q.l+=Re.size+511&-512;else{for(we=0;we<Re.size;++we)Q.write_shift(1,Re.content[we]);for(;we&511;++we)Q.write_shift(1,0)}for(ee=1;ee<z.FileIndex.length;++ee)if(Re=z.FileIndex[ee],Re.size>0&&Re.size<4096)if(Fn&&Buffer.isBuffer(Re.content))Re.content.copy(Q,Q.l,0,Re.size),Q.l+=Re.size+63&-64;else{for(we=0;we<Re.size;++we)Q.write_shift(1,Re.content[we]);for(;we&63;++we)Q.write_shift(1,0)}if(Fn)Q.l=Q.length;else for(;Q.l<Q.length;)Q.write_shift(1,0);return Q}function N(z,Z){var X=z.FullPaths.map(function(we){return we.toUpperCase()}),Y=X.map(function(we){var Te=we.split("/");return Te[Te.length-(we.slice(-1)=="/"?2:1)]}),Q=!1;Z.charCodeAt(0)===47?(Q=!0,Z=X[0].slice(0,-1)+Z):Q=Z.indexOf("/")!==-1;var ee=Z.toUpperCase(),Ee=Q===!0?X.indexOf(ee):Y.indexOf(ee);if(Ee!==-1)return z.FileIndex[Ee];var Oe=!ee.match(Hx);for(ee=ee.replace(hp,""),Oe&&(ee=ee.replace(Hx,"!")),Ee=0;Ee<X.length;++Ee)if((Oe?X[Ee].replace(Hx,"!"):X[Ee]).replace(hp,"")==ee||(Oe?Y[Ee].replace(Hx,"!"):Y[Ee]).replace(hp,"")==ee)return z.FileIndex[Ee];return null}var G=64,j=-2,ve="d0cf11e0a1b11ae1",ce=[208,207,17,224,161,177,26,225],je="00000000000000000000000000000000",Pe={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:j,FREESECT:-1,HEADER_SIGNATURE:ve,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:je,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ue(z,Z,X){c();var Y=D(z,X);l.writeFileSync(Z,Y)}function Ne(z){for(var Z=new Array(z.length),X=0;X<z.length;++X)Z[X]=String.fromCharCode(z[X]);return Z.join("")}function be(z,Z){var X=D(z,Z);switch(Z&&Z.type||"buffer"){case"file":return c(),l.writeFileSync(Z.filename,X),X;case"binary":return typeof X=="string"?X:Ne(X);case"base64":return o1(typeof X=="string"?X:Ne(X));case"buffer":if(Fn)return Buffer.isBuffer(X)?X:Ec(X);case"array":return typeof X=="string"?ho(X):X}return X}var ie;function V(z){try{var Z=z.InflateRaw,X=new Z;if(X._processChunk(new Uint8Array([3,0]),X._finishFlushFlag),X.bytesRead)ie=z;else throw new Error("zlib does not expose bytesRead")}catch(Y){console.error("cannot use native zlib: "+(Y.message||Y))}}function J(z,Z){if(!ie)return xe(z,Z);var X=ie.InflateRaw,Y=new X,Q=Y._processChunk(z.slice(z.l),Y._finishFlushFlag);return z.l+=Y.bytesRead,Q}function te(z){return ie?ie.deflateRawSync(z):an(z)}var re=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],he=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Be=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ge(z){var Z=(z<<1|z<<11)&139536|(z<<5|z<<15)&558144;return(Z>>16|Z>>8|Z)&255}for(var ye=typeof Uint8Array<"u",pe=ye?new Uint8Array(256):[],Et=0;Et<256;++Et)pe[Et]=Ge(Et);function Ve(z,Z){var X=pe[z&255];return Z<=8?X>>>8-Z:(X=X<<8|pe[z>>8&255],Z<=16?X>>>16-Z:(X=X<<8|pe[z>>16&255],X>>>24-Z))}function jt(z,Z){var X=Z&7,Y=Z>>>3;return(z[Y]|(X<=6?0:z[Y+1]<<8))>>>X&3}function St(z,Z){var X=Z&7,Y=Z>>>3;return(z[Y]|(X<=5?0:z[Y+1]<<8))>>>X&7}function Ut(z,Z){var X=Z&7,Y=Z>>>3;return(z[Y]|(X<=4?0:z[Y+1]<<8))>>>X&15}function Ht(z,Z){var X=Z&7,Y=Z>>>3;return(z[Y]|(X<=3?0:z[Y+1]<<8))>>>X&31}function tt(z,Z){var X=Z&7,Y=Z>>>3;return(z[Y]|(X<=1?0:z[Y+1]<<8))>>>X&127}function kn(z,Z,X){var Y=Z&7,Q=Z>>>3,ee=(1<<X)-1,Ee=z[Q]>>>Y;return X<8-Y||(Ee|=z[Q+1]<<8-Y,X<16-Y)||(Ee|=z[Q+2]<<16-Y,X<24-Y)||(Ee|=z[Q+3]<<24-Y),Ee&ee}function ln(z,Z,X){var Y=Z&7,Q=Z>>>3;return Y<=5?z[Q]|=(X&7)<<Y:(z[Q]|=X<<Y&255,z[Q+1]=(X&7)>>8-Y),Z+3}function hn(z,Z,X){var Y=Z&7,Q=Z>>>3;return X=(X&1)<<Y,z[Q]|=X,Z+1}function sr(z,Z,X){var Y=Z&7,Q=Z>>>3;return X<<=Y,z[Q]|=X&255,X>>>=8,z[Q+1]=X,Z+8}function Pi(z,Z,X){var Y=Z&7,Q=Z>>>3;return X<<=Y,z[Q]|=X&255,X>>>=8,z[Q+1]=X&255,z[Q+2]=X>>>8,Z+16}function Gn(z,Z){var X=z.length,Y=2*X>Z?2*X:Z+5,Q=0;if(X>=Z)return z;if(Fn){var ee=yO(Y);if(z.copy)z.copy(ee);else for(;Q<z.length;++Q)ee[Q]=z[Q];return ee}else if(ye){var Ee=new Uint8Array(Y);if(Ee.set)Ee.set(z);else for(;Q<X;++Q)Ee[Q]=z[Q];return Ee}return z.length=Y,z}function br(z){for(var Z=new Array(z),X=0;X<z;++X)Z[X]=0;return Z}function oi(z,Z,X){var Y=1,Q=0,ee=0,Ee=0,Oe=0,we=z.length,Te=ye?new Uint16Array(32):br(32);for(ee=0;ee<32;++ee)Te[ee]=0;for(ee=we;ee<X;++ee)z[ee]=0;we=z.length;var Re=ye?new Uint16Array(we):br(we);for(ee=0;ee<we;++ee)Te[Q=z[ee]]++,Y<Q&&(Y=Q),Re[ee]=0;for(Te[0]=0,ee=1;ee<=Y;++ee)Te[ee+16]=Oe=Oe+Te[ee-1]<<1;for(ee=0;ee<we;++ee)Oe=z[ee],Oe!=0&&(Re[ee]=Te[Oe+16]++);var Ye=0;for(ee=0;ee<we;++ee)if(Ye=z[ee],Ye!=0)for(Oe=Ve(Re[ee],Y)>>Y-Ye,Ee=(1<<Y+4-Ye)-1;Ee>=0;--Ee)Z[Oe|Ee<<Ye]=Ye&15|ee<<4;return Y}var _t=ye?new Uint16Array(512):br(512),xn=ye?new Uint16Array(32):br(32);if(!ye){for(var In=0;In<512;++In)_t[In]=0;for(In=0;In<32;++In)xn[In]=0}(function(){for(var z=[],Z=0;Z<32;Z++)z.push(5);oi(z,xn,32);var X=[];for(Z=0;Z<=143;Z++)X.push(8);for(;Z<=255;Z++)X.push(9);for(;Z<=279;Z++)X.push(7);for(;Z<=287;Z++)X.push(8);oi(X,_t,288)})();var Tt=(function(){for(var Z=ye?new Uint8Array(32768):[],X=0,Y=0;X<Be.length-1;++X)for(;Y<Be[X+1];++Y)Z[Y]=X;for(;Y<32768;++Y)Z[Y]=29;var Q=ye?new Uint8Array(259):[];for(X=0,Y=0;X<he.length-1;++X)for(;Y<he[X+1];++Y)Q[Y]=X;function ee(Oe,we){for(var Te=0;Te<Oe.length;){var Re=Math.min(65535,Oe.length-Te),Ye=Te+Re==Oe.length;for(we.write_shift(1,+Ye),we.write_shift(2,Re),we.write_shift(2,~Re&65535);Re-- >0;)we[we.l++]=Oe[Te++]}return we.l}function Ee(Oe,we){for(var Te=0,Re=0,Ye=ye?new Uint16Array(32768):[];Re<Oe.length;){var st=Math.min(65535,Oe.length-Re);if(st<10){for(Te=ln(we,Te,+(Re+st==Oe.length)),Te&7&&(Te+=8-(Te&7)),we.l=Te/8|0,we.write_shift(2,st),we.write_shift(2,~st&65535);st-- >0;)we[we.l++]=Oe[Re++];Te=we.l*8;continue}Te=ln(we,Te,+(Re+st==Oe.length)+2);for(var pt=0;st-- >0;){var Ze=Oe[Re];pt=(pt<<5^Ze)&32767;var Je=-1,qt=0;if((Je=Ye[pt])&&(Je|=Re&-32768,Je>Re&&(Je-=32768),Je<Re))for(;Oe[Je+qt]==Oe[Re+qt]&&qt<250;)++qt;if(qt>2){Ze=Q[qt],Ze<=22?Te=sr(we,Te,pe[Ze+1]>>1)-1:(sr(we,Te,3),Te+=5,sr(we,Te,pe[Ze-23]>>5),Te+=3);var zn=Ze<8?0:Ze-4>>2;zn>0&&(Pi(we,Te,qt-he[Ze]),Te+=zn),Ze=Z[Re-Je],Te=sr(we,Te,pe[Ze]>>3),Te-=3;var Kn=Ze<4?0:Ze-2>>1;Kn>0&&(Pi(we,Te,Re-Je-Be[Ze]),Te+=Kn);for(var yr=0;yr<qt;++yr)Ye[pt]=Re&32767,pt=(pt<<5^Oe[Re])&32767,++Re;st-=qt-1}else Ze<=143?Ze=Ze+48:Te=hn(we,Te,1),Te=sr(we,Te,pe[Ze]),Ye[pt]=Re&32767,++Re}Te=sr(we,Te,0)-1}return we.l=(Te+7)/8|0,we.l}return function(we,Te){return we.length<8?ee(we,Te):Ee(we,Te)}})();function an(z){var Z=Le(50+Math.floor(z.length*1.1)),X=Tt(z,Z);return Z.slice(0,X)}var Lt=ye?new Uint16Array(32768):br(32768),Yi=ye?new Uint16Array(32768):br(32768),Mr=ye?new Uint16Array(128):br(128),li=1,rn=1;function Tr(z,Z){var X=Ht(z,Z)+257;Z+=5;var Y=Ht(z,Z)+1;Z+=5;var Q=Ut(z,Z)+4;Z+=4;for(var ee=0,Ee=ye?new Uint8Array(19):br(19),Oe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],we=1,Te=ye?new Uint8Array(8):br(8),Re=ye?new Uint8Array(8):br(8),Ye=Ee.length,st=0;st<Q;++st)Ee[re[st]]=ee=St(z,Z),we<ee&&(we=ee),Te[ee]++,Z+=3;var pt=0;for(Te[0]=0,st=1;st<=we;++st)Re[st]=pt=pt+Te[st-1]<<1;for(st=0;st<Ye;++st)(pt=Ee[st])!=0&&(Oe[st]=Re[pt]++);var Ze=0;for(st=0;st<Ye;++st)if(Ze=Ee[st],Ze!=0){pt=pe[Oe[st]]>>8-Ze;for(var Je=(1<<7-Ze)-1;Je>=0;--Je)Mr[pt|Je<<Ze]=Ze&7|st<<3}var qt=[];for(we=1;qt.length<X+Y;)switch(pt=Mr[tt(z,Z)],Z+=pt&7,pt>>>=3){case 16:for(ee=3+jt(z,Z),Z+=2,pt=qt[qt.length-1];ee-- >0;)qt.push(pt);break;case 17:for(ee=3+St(z,Z),Z+=3;ee-- >0;)qt.push(0);break;case 18:for(ee=11+tt(z,Z),Z+=7;ee-- >0;)qt.push(0);break;default:qt.push(pt),we<pt&&(we=pt);break}var zn=qt.slice(0,X),Kn=qt.slice(X);for(st=X;st<286;++st)zn[st]=0;for(st=Y;st<30;++st)Kn[st]=0;return li=oi(zn,Lt,286),rn=oi(Kn,Yi,30),Z}function Fe(z,Z){if(z[0]==3&&!(z[1]&3))return[Td(Z),2];for(var X=0,Y=0,Q=yO(Z||1<<18),ee=0,Ee=Q.length>>>0,Oe=0,we=0;(Y&1)==0;){if(Y=St(z,X),X+=3,Y>>>1)Y>>1==1?(Oe=9,we=5):(X=Tr(z,X),Oe=li,we=rn);else{X&7&&(X+=8-(X&7));var Te=z[X>>>3]|z[(X>>>3)+1]<<8;if(X+=32,Te>0)for(!Z&&Ee<ee+Te&&(Q=Gn(Q,ee+Te),Ee=Q.length);Te-- >0;)Q[ee++]=z[X>>>3],X+=8;continue}for(;;){!Z&&Ee<ee+32767&&(Q=Gn(Q,ee+32767),Ee=Q.length);var Re=kn(z,X,Oe),Ye=Y>>>1==1?_t[Re]:Lt[Re];if(X+=Ye&15,Ye>>>=4,(Ye>>>8&255)===0)Q[ee++]=Ye;else{if(Ye==256)break;Ye-=257;var st=Ye<8?0:Ye-4>>2;st>5&&(st=0);var pt=ee+he[Ye];st>0&&(pt+=kn(z,X,st),X+=st),Re=kn(z,X,we),Ye=Y>>>1==1?xn[Re]:Yi[Re],X+=Ye&15,Ye>>>=4;var Ze=Ye<4?0:Ye-2>>1,Je=Be[Ye];for(Ze>0&&(Je+=kn(z,X,Ze),X+=Ze),!Z&&Ee<pt&&(Q=Gn(Q,pt+100),Ee=Q.length);ee<pt;)Q[ee]=Q[ee-Je],++ee}}}return Z?[Q,X+7>>>3]:[Q.slice(0,ee),X+7>>>3]}function xe(z,Z){var X=z.slice(z.l||0),Y=Fe(X,Z);return z.l+=Y[1],Y[0]}function _e(z,Z){if(z)typeof console<"u"&&console.error(Z);else throw new Error(Z)}function Dt(z,Z){var X=z;sa(X,0);var Y=[],Q=[],ee={FileIndex:Y,FullPaths:Q};R(ee,{root:Z.root});for(var Ee=X.length-4;(X[Ee]!=80||X[Ee+1]!=75||X[Ee+2]!=5||X[Ee+3]!=6)&&Ee>=0;)--Ee;X.l=Ee+4,X.l+=4;var Oe=X.read_shift(2);X.l+=6;var we=X.read_shift(4);for(X.l=we,Ee=0;Ee<Oe;++Ee){X.l+=20;var Te=X.read_shift(4),Re=X.read_shift(4),Ye=X.read_shift(2),st=X.read_shift(2),pt=X.read_shift(2);X.l+=8;var Ze=X.read_shift(4),Je=o(X.slice(X.l+Ye,X.l+Ye+st));X.l+=Ye+st+pt;var qt=X.l;X.l=Ze+4,M(X,Te,Re,ee,Je),X.l=qt}return ee}function M(z,Z,X,Y,Q){z.l+=2;var ee=z.read_shift(2),Ee=z.read_shift(2),Oe=a(z);if(ee&8257)throw new Error("Unsupported ZIP encryption");for(var we=z.read_shift(4),Te=z.read_shift(4),Re=z.read_shift(4),Ye=z.read_shift(2),st=z.read_shift(2),pt="",Ze=0;Ze<Ye;++Ze)pt+=String.fromCharCode(z[z.l++]);if(st){var Je=o(z.slice(z.l,z.l+st));(Je[21589]||{}).mt&&(Oe=Je[21589].mt),((Q||{})[21589]||{}).mt&&(Oe=Q[21589].mt)}z.l+=st;var qt=z.slice(z.l,z.l+Te);switch(Ee){case 8:qt=J(z,Re);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Ee)}var zn=!1;ee&8&&(we=z.read_shift(4),we==134695760&&(we=z.read_shift(4),zn=!0),Te=z.read_shift(4),Re=z.read_shift(4)),Te!=Z&&_e(zn,"Bad compressed size: "+Z+" != "+Te),Re!=X&&_e(zn,"Bad uncompressed size: "+X+" != "+Re),$e(Y,pt,qt,{unsafe:!0,mt:Oe})}function ut(z,Z){var X=Z||{},Y=[],Q=[],ee=Le(1),Ee=X.compression?8:0,Oe=0,we=0,Te=0,Re=0,Ye=0,st=z.FullPaths[0],pt=st,Ze=z.FileIndex[0],Je=[],qt=0;for(we=1;we<z.FullPaths.length;++we)if(pt=z.FullPaths[we].slice(st.length),Ze=z.FileIndex[we],!(!Ze.size||!Ze.content||pt=="Sh33tJ5")){var zn=Re,Kn=Le(pt.length);for(Te=0;Te<pt.length;++Te)Kn.write_shift(1,pt.charCodeAt(Te)&127);Kn=Kn.slice(0,Kn.l),Je[Ye]=Jye.buf(Ze.content,0);var yr=Ze.content;Ee==8&&(yr=te(yr)),ee=Le(30),ee.write_shift(4,67324752),ee.write_shift(2,20),ee.write_shift(2,Oe),ee.write_shift(2,Ee),Ze.mt?s(ee,Ze.mt):ee.write_shift(4,0),ee.write_shift(-4,Je[Ye]),ee.write_shift(4,yr.length),ee.write_shift(4,Ze.content.length),ee.write_shift(2,Kn.length),ee.write_shift(2,0),Re+=ee.length,Y.push(ee),Re+=Kn.length,Y.push(Kn),Re+=yr.length,Y.push(yr),ee=Le(46),ee.write_shift(4,33639248),ee.write_shift(2,0),ee.write_shift(2,20),ee.write_shift(2,Oe),ee.write_shift(2,Ee),ee.write_shift(4,0),ee.write_shift(-4,Je[Ye]),ee.write_shift(4,yr.length),ee.write_shift(4,Ze.content.length),ee.write_shift(2,Kn.length),ee.write_shift(2,0),ee.write_shift(2,0),ee.write_shift(2,0),ee.write_shift(2,0),ee.write_shift(4,0),ee.write_shift(4,zn),qt+=ee.l,Q.push(ee),qt+=Kn.length,Q.push(Kn),++Ye}return ee=Le(22),ee.write_shift(4,101010256),ee.write_shift(2,0),ee.write_shift(2,0),ee.write_shift(2,Ye),ee.write_shift(2,Ye),ee.write_shift(4,qt),ee.write_shift(4,Re),ee.write_shift(2,0),$i([$i(Y),$i(Q),ee])}var W={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ne(z,Z){if(z.ctype)return z.ctype;var X=z.name||"",Y=X.match(/\.([^\.]+)$/);return Y&&W[Y[1]]||Z&&(Y=(X=Z).match(/[\.\\]([^\.\\])+$/),Y&&W[Y[1]])?W[Y[1]]:"application/octet-stream"}function Ce(z){for(var Z=o1(z),X=[],Y=0;Y<Z.length;Y+=76)X.push(Z.slice(Y,Y+76));return X.join(`\r
`)+`\r
`}function q(z){var Z=z.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Te){var Re=Te.charCodeAt(0).toString(16).toUpperCase();return"="+(Re.length==1?"0"+Re:Re)});Z=Z.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),Z.charAt(0)==`
`&&(Z="=0D"+Z.slice(1)),Z=Z.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var X=[],Y=Z.split(`\r
`),Q=0;Q<Y.length;++Q){var ee=Y[Q];if(ee.length==0){X.push("");continue}for(var Ee=0;Ee<ee.length;){var Oe=76,we=ee.slice(Ee,Ee+Oe);we.charAt(Oe-1)=="="?Oe--:we.charAt(Oe-2)=="="?Oe-=2:we.charAt(Oe-3)=="="&&(Oe-=3),we=ee.slice(Ee,Ee+Oe),Ee+=Oe,Ee<ee.length&&(we+="="),X.push(we)}}return X.join(`\r
`)}function le(z){for(var Z=[],X=0;X<z.length;++X){for(var Y=z[X];X<=z.length&&Y.charAt(Y.length-1)=="=";)Y=Y.slice(0,Y.length-1)+z[++X];Z.push(Y)}for(var Q=0;Q<Z.length;++Q)Z[Q]=Z[Q].replace(/[=][0-9A-Fa-f]{2}/g,function(ee){return String.fromCharCode(parseInt(ee.slice(1),16))});return ho(Z.join(`\r
`))}function Ae(z,Z,X){for(var Y="",Q="",ee="",Ee,Oe=0;Oe<10;++Oe){var we=Z[Oe];if(!we||we.match(/^\s*$/))break;var Te=we.match(/^(.*?):\s*([^\s].*)$/);if(Te)switch(Te[1].toLowerCase()){case"content-location":Y=Te[2].trim();break;case"content-type":ee=Te[2].trim();break;case"content-transfer-encoding":Q=Te[2].trim();break}}switch(++Oe,Q.toLowerCase()){case"base64":Ee=ho(dc(Z.slice(Oe).join("")));break;case"quoted-printable":Ee=le(Z.slice(Oe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Q)}var Re=$e(z,Y.slice(X.length),Ee,{unsafe:!0});ee&&(Re.ctype=ee)}function ze(z,Z){if(Ne(z.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var X=Z&&Z.root||"",Y=(Fn&&Buffer.isBuffer(z)?z.toString("binary"):Ne(z)).split(`\r
`),Q=0,ee="";for(Q=0;Q<Y.length;++Q)if(ee=Y[Q],!!/^Content-Location:/i.test(ee)&&(ee=ee.slice(ee.indexOf("file")),X||(X=ee.slice(0,ee.lastIndexOf("/")+1)),ee.slice(0,X.length)!=X))for(;X.length>0&&(X=X.slice(0,X.length-1),X=X.slice(0,X.lastIndexOf("/")+1),ee.slice(0,X.length)!=X););var Ee=(Y[1]||"").match(/boundary="(.*?)"/);if(!Ee)throw new Error("MAD cannot find boundary");var Oe="--"+(Ee[1]||""),we=[],Te=[],Re={FileIndex:we,FullPaths:Te};R(Re);var Ye,st=0;for(Q=0;Q<Y.length;++Q){var pt=Y[Q];pt!==Oe&&pt!==Oe+"--"||(st++&&Ae(Re,Y.slice(Ye,Q),X),Ye=Q)}return Re}function Me(z,Z){var X=Z||{},Y=X.boundary||"SheetJS";Y="------="+Y;for(var Q=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+Y.slice(2)+'"',"","",""],ee=z.FullPaths[0],Ee=ee,Oe=z.FileIndex[0],we=1;we<z.FullPaths.length;++we)if(Ee=z.FullPaths[we].slice(ee.length),Oe=z.FileIndex[we],!(!Oe.size||!Oe.content||Ee=="Sh33tJ5")){Ee=Ee.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(qt){return"_x"+qt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(qt){return"_u"+qt.charCodeAt(0).toString(16)+"_"});for(var Te=Oe.content,Re=Fn&&Buffer.isBuffer(Te)?Te.toString("binary"):Ne(Te),Ye=0,st=Math.min(1024,Re.length),pt=0,Ze=0;Ze<=st;++Ze)(pt=Re.charCodeAt(Ze))>=32&&pt<128&&++Ye;var Je=Ye>=st*4/5;Q.push(Y),Q.push("Content-Location: "+(X.root||"file:///C:/SheetJS/")+Ee),Q.push("Content-Transfer-Encoding: "+(Je?"quoted-printable":"base64")),Q.push("Content-Type: "+ne(Oe,Ee)),Q.push(""),Q.push(Je?q(Re):Ce(Re))}return Q.push(Y+`--\r
`),Q.join(`\r
`)}function He(z){var Z={};return R(Z,z),Z}function $e(z,Z,X,Y){var Q=Y&&Y.unsafe;Q||R(z);var ee=!Q&&rr.find(z,Z);if(!ee){var Ee=z.FullPaths[0];Z.slice(0,Ee.length)==Ee?Ee=Z:(Ee.slice(-1)!="/"&&(Ee+="/"),Ee=(Ee+Z).replace("//","/")),ee={name:i(Z),type:2},z.FileIndex.push(ee),z.FullPaths.push(Ee),Q||rr.utils.cfb_gc(z)}return ee.content=X,ee.size=X?X.length:0,Y&&(Y.CLSID&&(ee.clsid=Y.CLSID),Y.mt&&(ee.mt=Y.mt),Y.ct&&(ee.ct=Y.ct)),ee}function yt(z,Z){R(z);var X=rr.find(z,Z);if(X){for(var Y=0;Y<z.FileIndex.length;++Y)if(z.FileIndex[Y]==X)return z.FileIndex.splice(Y,1),z.FullPaths.splice(Y,1),!0}return!1}function At(z,Z,X){R(z);var Y=rr.find(z,Z);if(Y){for(var Q=0;Q<z.FileIndex.length;++Q)if(z.FileIndex[Q]==Y)return z.FileIndex[Q].name=i(X),z.FullPaths[Q]=X,!0}return!1}function Wt(z){P(z,!0)}return e.find=N,e.read=B,e.parse=h,e.write=be,e.writeFile=ue,e.utils={cfb_new:He,cfb_add:$e,cfb_del:yt,cfb_mov:At,cfb_gc:Wt,ReadShift:fp,CheckField:rG,prep_blob:sa,bconcat:$i,use_zlib:V,_deflateRaw:an,_inflateRaw:xe,consts:Pe},e})();function Qye(n){return typeof n=="string"?OE(n):Array.isArray(n)?Tye(n):n}function sy(n,e,t){if(typeof Deno<"u"){if(t&&typeof e=="string")switch(t){case"utf8":e=new TextEncoder(t).encode(e);break;case"binary":e=OE(e);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(n,e)}var r=t=="utf8"?c1(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(r,n);if(typeof Blob<"u"){var i=new Blob([Qye(r)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,n);if(typeof saveAs<"u")return saveAs(i,n);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:n,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=n,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(n);return o.open("w"),o.encoding="binary",Array.isArray(e)&&(e=iy(e)),o.write(e),o.close(),e}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+n)}function Xi(n){for(var e=Object.keys(n),t=[],r=0;r<e.length;++r)Object.prototype.hasOwnProperty.call(n,e[r])&&t.push(e[r]);return t}function TO(n,e){for(var t=[],r=Xi(n),i=0;i!==r.length;++i)t[n[r[i]][e]]==null&&(t[n[r[i]][e]]=r[i]);return t}function lC(n){for(var e=[],t=Xi(n),r=0;r!==t.length;++r)e[n[t[r]]]=t[r];return e}function FE(n){for(var e=[],t=Xi(n),r=0;r!==t.length;++r)e[n[t[r]]]=parseInt(t[r],10);return e}function exe(n){for(var e=[],t=Xi(n),r=0;r!==t.length;++r)e[n[t[r]]]==null&&(e[n[t[r]]]=[]),e[n[t[r]]].push(t[r]);return e}var aw=new Date(1899,11,30,0,0,0);function Hs(n,e){var t=n.getTime(),r=aw.getTime()+(n.getTimezoneOffset()-aw.getTimezoneOffset())*6e4;return(t-r)/(1440*60*1e3)}var BB=new Date,txe=aw.getTime()+(BB.getTimezoneOffset()-aw.getTimezoneOffset())*6e4,RO=BB.getTimezoneOffset();function GB(n){var e=new Date;return e.setTime(n*24*60*60*1e3+txe),e.getTimezoneOffset()!==RO&&e.setTime(e.getTime()+(e.getTimezoneOffset()-RO)*6e4),e}var AO=new Date("2017-02-19T19:06:09.000Z"),zB=isNaN(AO.getFullYear())?new Date("2/19/17"):AO,nxe=zB.getFullYear()==2017;function Ts(n,e){var t=new Date(n);if(nxe)return e>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):e<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(n instanceof Date)return n;if(zB.getFullYear()==1917&&!isNaN(t.getFullYear())){var r=t.getFullYear();return n.indexOf(""+r)>-1||t.setFullYear(t.getFullYear()+100),t}var i=n.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return n.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function VE(n,e){if(Fn&&Buffer.isBuffer(n))return n.toString("binary");if(typeof TextDecoder<"u")try{var t={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(n)&&(n=new Uint8Array(n)),new TextDecoder("latin1").decode(n).replace(/[]/g,function(s){return t[s]||s})}catch{}for(var r=[],i=0;i!=n.length;++i)r.push(String.fromCharCode(n[i]));return r.join("")}function Ks(n){if(typeof JSON<"u"&&!Array.isArray(n))return JSON.parse(JSON.stringify(n));if(typeof n!="object"||n==null)return n;if(n instanceof Date)return new Date(n.getTime());var e={};for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=Ks(n[t]));return e}function Vr(n,e){for(var t="";t.length<e;)t+=n;return t}function nc(n){var e=Number(n);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(n))return e;var t=1,r=n.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(e=Number(r))||(r=r.replace(/[(](.*)[)]/,function(i,s){return t=-t,s}),!isNaN(e=Number(r)))?e/t:e}var rxe=["january","february","march","april","may","june","july","august","september","october","november","december"];function l1(n){var e=new Date(n),t=new Date(NaN),r=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return t;var a=n.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&rxe.indexOf(a)==-1)return t}else if(a.match(/[a-z]/))return t;return r<0||r>8099?t:(i>0||s>1)&&r!=101?e:n.match(/[^-0-9:,\/\\]/)?t:e}function cn(n,e,t){if(n.FullPaths){if(typeof t=="string"){var r;return Fn?r=Ec(t):r=Rye(t),rr.utils.cfb_add(n,e,r)}rr.utils.cfb_add(n,e,t)}else n.file(e,t)}function cC(){return rr.utils.cfb_new()}var ai=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,ixe={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},uC=lC(ixe),hC=/[&<>'"]/g,sxe=/[\u0000-\u0008\u000b-\u001f]/g;function er(n){var e=n+"";return e.replace(hC,function(t){return uC[t]}).replace(sxe,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function kO(n){return er(n).replace(/ /g,"_x0020_")}var UB=/[\u0000-\u001f]/g;function axe(n){var e=n+"";return e.replace(hC,function(t){return uC[t]}).replace(/\n/g,"<br/>").replace(UB,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function oxe(n){var e=n+"";return e.replace(hC,function(t){return uC[t]}).replace(UB,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}function lxe(n){return n.replace(/(\r\n|[\r\n])/g,"&#10;")}function cxe(n){switch(n){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Vb(n){for(var e="",t=0,r=0,i=0,s=0,a=0,o=0;t<n.length;){if(r=n.charCodeAt(t++),r<128){e+=String.fromCharCode(r);continue}if(i=n.charCodeAt(t++),r>191&&r<224){a=(r&31)<<6,a|=i&63,e+=String.fromCharCode(a);continue}if(s=n.charCodeAt(t++),r<240){e+=String.fromCharCode((r&15)<<12|(i&63)<<6|s&63);continue}a=n.charCodeAt(t++),o=((r&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function IO(n){var e=Td(2*n.length),t,r,i=1,s=0,a=0,o;for(r=0;r<n.length;r+=i)i=1,(o=n.charCodeAt(r))<128?t=o:o<224?(t=(o&31)*64+(n.charCodeAt(r+1)&63),i=2):o<240?(t=(o&15)*4096+(n.charCodeAt(r+1)&63)*64+(n.charCodeAt(r+2)&63),i=3):(i=4,t=(o&7)*262144+(n.charCodeAt(r+1)&63)*4096+(n.charCodeAt(r+2)&63)*64+(n.charCodeAt(r+3)&63),t-=65536,a=55296+(t>>>10&1023),t=56320+(t&1023)),a!==0&&(e[s++]=a&255,e[s++]=a>>>8,a=0),e[s++]=t%256,e[s++]=t>>>8;return e.slice(0,s).toString("ucs2")}function CO(n){return Ec(n,"binary").toString("utf8")}var Xx="foo bar baz",dp=Fn&&(CO(Xx)==Vb(Xx)&&CO||IO(Xx)==Vb(Xx)&&IO)||Vb,c1=Fn?function(n){return Ec(n,"utf8").toString("binary")}:function(n){for(var e=[],t=0,r=0,i=0;t<n.length;)switch(r=n.charCodeAt(t++),!0){case r<128:e.push(String.fromCharCode(r));break;case r<2048:e.push(String.fromCharCode(192+(r>>6))),e.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,i=n.charCodeAt(t++)-56320+(r<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(r>>12))),e.push(String.fromCharCode(128+(r>>6&63))),e.push(String.fromCharCode(128+(r&63)))}return e.join("")},uxe=(function(){var n=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var r=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<n.length;++i)r=r.replace(n[i][0],n[i][1]);return r}})(),$B=/(^\s|\s$|\n)/;function Wi(n,e){return"<"+n+(e.match($B)?' xml:space="preserve"':"")+">"+e+"</"+n+">"}function u1(n){return Xi(n).map(function(e){return" "+e+'="'+n[e]+'"'}).join("")}function at(n,e,t){return"<"+n+(t!=null?u1(t):"")+(e!=null?(e.match($B)?' xml:space="preserve"':"")+">"+e+"</"+n:"/")+">"}function $R(n,e){try{return n.toISOString().replace(/\.\d*/,"")}catch(t){if(e)throw t}return""}function hxe(n,e){switch(typeof n){case"string":var t=at("vt:lpwstr",er(n));return t=t.replace(/&quot;/g,"_x0022_"),t;case"number":return at((n|0)==n?"vt:i4":"vt:r8",er(String(n)));case"boolean":return at("vt:bool",n?"true":"false")}if(n instanceof Date)return at("vt:filetime",$R(n));throw new Error("Unable to serialize "+n)}var Ri={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},vg=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],oa={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function dxe(n,e){for(var t=1-2*(n[e+7]>>>7),r=((n[e+7]&127)<<4)+(n[e+6]>>>4&15),i=n[e+6]&15,s=5;s>=0;--s)i=i*256+n[e+s];return r==2047?i==0?t*(1/0):NaN:(r==0?r=-1022:(r-=1023,i+=Math.pow(2,52)),t*Math.pow(2,r-52)*i)}function fxe(n,e,t){var r=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,a=r?-e:e;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var o=0;o<=5;++o,s/=256)n[t+o]=s&255;n[t+6]=(i&15)<<4|s&15,n[t+7]=i>>4|r}var PO=function(n){for(var e=[],t=10240,r=0;r<n[0].length;++r)if(n[0][r])for(var i=0,s=n[0][r].length;i<s;i+=t)e.push.apply(e,n[0][r].slice(i,i+t));return e},NO=Fn?function(n){return n[0].length>0&&Buffer.isBuffer(n[0][0])?Buffer.concat(n[0].map(function(e){return Buffer.isBuffer(e)?e:Ec(e)})):PO(n)}:PO,MO=function(n,e,t){for(var r=[],i=e;i<t;i+=2)r.push(String.fromCharCode(jm(n,i)));return r.join("").replace(hp,"")},dC=Fn?function(n,e,t){return Buffer.isBuffer(n)?n.toString("utf16le",e,t).replace(hp,""):MO(n,e,t)}:MO,LO=function(n,e,t){for(var r=[],i=e;i<e+t;++i)r.push(("0"+n[i].toString(16)).slice(-2));return r.join("")},WB=Fn?function(n,e,t){return Buffer.isBuffer(n)?n.toString("hex",e,e+t):LO(n,e,t)}:LO,OO=function(n,e,t){for(var r=[],i=e;i<t;i++)r.push(String.fromCharCode(Qf(n,i)));return r.join("")},ay=Fn?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf8",t,r):OO(e,t,r)}:OO,HB=function(n,e){var t=la(n,e);return t>0?ay(n,e+4,e+4+t-1):""},KB=HB,XB=function(n,e){var t=la(n,e);return t>0?ay(n,e+4,e+4+t-1):""},qB=XB,YB=function(n,e){var t=2*la(n,e);return t>0?ay(n,e+4,e+4+t-1):""},ZB=YB,JB=function(e,t){var r=la(e,t);return r>0?dC(e,t+4,t+4+r):""},QB=JB,eG=function(n,e){var t=la(n,e);return t>0?ay(n,e+4,e+4+t):""},tG=eG,nG=function(n,e){return dxe(n,e)},ow=nG,fC=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Fn&&(KB=function(e,t){if(!Buffer.isBuffer(e))return HB(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},qB=function(e,t){if(!Buffer.isBuffer(e))return XB(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},ZB=function(e,t){if(!Buffer.isBuffer(e))return YB(e,t);var r=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r-1)},QB=function(e,t){if(!Buffer.isBuffer(e))return JB(e,t);var r=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r)},tG=function(e,t){if(!Buffer.isBuffer(e))return eG(e,t);var r=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+r)},ow=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):nG(e,t)},fC=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Qf=function(n,e){return n[e]},jm=function(n,e){return n[e+1]*256+n[e]},gxe=function(n,e){var t=n[e+1]*256+n[e];return t<32768?t:(65535-t+1)*-1},la=function(n,e){return n[e+3]*(1<<24)+(n[e+2]<<16)+(n[e+1]<<8)+n[e]},Vh=function(n,e){return n[e+3]<<24|n[e+2]<<16|n[e+1]<<8|n[e]},mxe=function(n,e){return n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3]};function fp(n,e){var t="",r,i,s=[],a,o,l,c;switch(e){case"dbcs":if(c=this.l,Fn&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*n).toString("utf16le");else for(l=0;l<n;++l)t+=String.fromCharCode(jm(this,c)),c+=2;n*=2;break;case"utf8":t=ay(this,this.l,this.l+n);break;case"utf16le":n*=2,t=dC(this,this.l,this.l+n);break;case"wstr":return fp.call(this,n,"dbcs");case"lpstr-ansi":t=KB(this,this.l),n=4+la(this,this.l);break;case"lpstr-cp":t=qB(this,this.l),n=4+la(this,this.l);break;case"lpwstr":t=ZB(this,this.l),n=4+2*la(this,this.l);break;case"lpp4":n=4+la(this,this.l),t=QB(this,this.l),n&2&&(n+=2);break;case"8lpp4":n=4+la(this,this.l),t=tG(this,this.l),n&3&&(n+=4-(n&3));break;case"cstr":for(n=0,t="";(a=Qf(this,this.l+n++))!==0;)s.push(Wx(a));t=s.join("");break;case"_wstr":for(n=0,t="";(a=jm(this,this.l+n))!==0;)s.push(Wx(a)),n+=2;n+=2,t=s.join("");break;case"dbcs-cont":for(t="",c=this.l,l=0;l<n;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=Qf(this,c),this.l=c+1,o=fp.call(this,n-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Wx(jm(this,c))),c+=2}t=s.join(""),n*=2;break;case"cpstr":case"sbcs-cont":for(t="",c=this.l,l=0;l!=n;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=Qf(this,c),this.l=c+1,o=fp.call(this,n-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Wx(Qf(this,c))),c+=1}t=s.join("");break;default:switch(n){case 1:return r=Qf(this,this.l),this.l++,r;case 2:return r=(e==="i"?gxe:jm)(this,this.l),this.l+=2,r;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(r=(n>0?Vh:mxe)(this,this.l),this.l+=4,r):(i=la(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return n==8?i=ow(this,this.l):i=ow([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;n=8;case 16:t=WB(this,this.l,n);break}}return this.l+=n,t}var pxe=function(n,e,t){n[t]=e&255,n[t+1]=e>>>8&255,n[t+2]=e>>>16&255,n[t+3]=e>>>24&255},yxe=function(n,e,t){n[t]=e&255,n[t+1]=e>>8&255,n[t+2]=e>>16&255,n[t+3]=e>>24&255},xxe=function(n,e,t){n[t]=e&255,n[t+1]=e>>>8&255};function _xe(n,e,t){var r=0,i=0;if(t==="dbcs"){for(i=0;i!=e.length;++i)xxe(this,e.charCodeAt(i),this.l+2*i);r=2*e.length}else if(t==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;r=e.length}else if(t==="hex"){for(;i<n;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(t==="utf16le"){var s=Math.min(this.l+n,this.length);for(i=0;i<Math.min(e.length,n);++i){var a=e.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(n){case 1:r=1,this[this.l]=e&255;break;case 2:r=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:r=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:r=4,pxe(this,e,this.l);break;case 8:if(r=8,t==="f"){fxe(this,e,this.l);break}case 16:break;case-4:r=4,yxe(this,e,this.l);break}return this.l+=r,this}function rG(n,e){var t=WB(this,this.l,n.length>>1);if(t!==n)throw new Error(e+"Expected "+n+" saw "+t);this.l+=n.length>>1}function sa(n,e){n.l=e,n.read_shift=fp,n.chk=rG,n.write_shift=_xe}function ml(n,e){n.l+=e}function Le(n){var e=Td(n);return sa(e,0),e}function Gs(){var n=[],e=Fn?256:2048,t=function(c){var h=Le(c);return sa(h,0),h},r=t(e),i=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&n.push(r),r=null)},s=function(c){return r&&c<r.length-r.l?r:(i(),r=t(Math.max(c+1,e)))},a=function(){return i(),$i(n)},o=function(c){i(),r=c,r.l==null&&(r.l=r.length),s(e)};return{next:s,push:o,end:a,_bufs:n}}function We(n,e,t,r){var i=+e,s;if(!isNaN(i)){r||(r=dSe[i].p||(t||[]).length||0),s=1+(i>=128?1:0)+1,r>=128&&++s,r>=16384&&++s,r>=2097152&&++s;var a=n.next(s);i<=127?a.write_shift(1,i):(a.write_shift(1,(i&127)+128),a.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(r>=128)a.write_shift(1,(r&127)+128),r>>=7;else{a.write_shift(1,r);break}r>0&&fC(t)&&n.push(t)}}function gp(n,e,t){var r=Ks(n);if(e.s?(r.cRel&&(r.c+=e.s.c),r.rRel&&(r.r+=e.s.r)):(r.cRel&&(r.c+=e.c),r.rRel&&(r.r+=e.r)),!t||t.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function DO(n,e,t){var r=Ks(n);return r.s=gp(r.s,e.s,t),r.e=gp(r.e,e.s,t),r}function mp(n,e){if(n.cRel&&n.c<0)for(n=Ks(n);n.c<0;)n.c+=e>8?16384:256;if(n.rRel&&n.r<0)for(n=Ks(n);n.r<0;)n.r+=e>8?1048576:e>5?65536:16384;var t=nr(n);return!n.cRel&&n.cRel!=null&&(t=Exe(t)),!n.rRel&&n.rRel!=null&&(t=vxe(t)),t}function Bb(n,e){return n.s.r==0&&!n.s.rRel&&n.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!n.e.rRel?(n.s.cRel?"":"$")+gs(n.s.c)+":"+(n.e.cRel?"":"$")+gs(n.e.c):n.s.c==0&&!n.s.cRel&&n.e.c==(e.biff>=12?16383:255)&&!n.e.cRel?(n.s.rRel?"":"$")+Ki(n.s.r)+":"+(n.e.rRel?"":"$")+Ki(n.e.r):mp(n.s,e.biff)+":"+mp(n.e,e.biff)}function gC(n){return parseInt(wxe(n),10)-1}function Ki(n){return""+(n+1)}function vxe(n){return n.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function wxe(n){return n.replace(/\$(\d+)$/,"$1")}function mC(n){for(var e=Sxe(n),t=0,r=0;r!==e.length;++r)t=26*t+e.charCodeAt(r)-64;return t-1}function gs(n){if(n<0)throw new Error("invalid column "+n);var e="";for(++n;n;n=Math.floor((n-1)/26))e=String.fromCharCode((n-1)%26+65)+e;return e}function Exe(n){return n.replace(/^([A-Z])/,"$$$1")}function Sxe(n){return n.replace(/^\$([A-Z])/,"$1")}function bxe(n){return n.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function ki(n){for(var e=0,t=0,r=0;r<n.length;++r){var i=n.charCodeAt(r);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(t=26*t+(i-64))}return{c:t-1,r:e-1}}function nr(n){for(var e=n.c+1,t="";e;e=(e-1)/26|0)t=String.fromCharCode((e-1)%26+65)+t;return t+(n.r+1)}function ya(n){var e=n.indexOf(":");return e==-1?{s:ki(n),e:ki(n)}:{s:ki(n.slice(0,e)),e:ki(n.slice(e+1))}}function ii(n,e){return typeof e>"u"||typeof e=="number"?ii(n.s,n.e):(typeof n!="string"&&(n=nr(n)),typeof e!="string"&&(e=nr(e)),n==e?n:n+":"+e)}function pr(n){var e={s:{c:0,r:0},e:{c:0,r:0}},t=0,r=0,i=0,s=n.length;for(t=0;r<s&&!((i=n.charCodeAt(r)-64)<1||i>26);++r)t=26*t+i;for(e.s.c=--t,t=0;r<s&&!((i=n.charCodeAt(r)-48)<0||i>9);++r)t=10*t+i;if(e.s.r=--t,r===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++r,t=0;r!=s&&!((i=n.charCodeAt(r)-64)<1||i>26);++r)t=26*t+i;for(e.e.c=--t,t=0;r!=s&&!((i=n.charCodeAt(r)-48)<0||i>9);++r)t=10*t+i;return e.e.r=--t,e}function jO(n,e){var t=n.t=="d"&&e instanceof Date;if(n.z!=null)try{return n.w=$u(n.z,t?Hs(e):e)}catch{}try{return n.w=$u((n.XF||{}).numFmtId||(t?14:0),t?Hs(e):e)}catch{return""+e}}function fc(n,e,t){return n==null||n.t==null||n.t=="z"?"":n.w!==void 0?n.w:(n.t=="d"&&!n.z&&t&&t.dateNF&&(n.z=t.dateNF),n.t=="e"?oy[n.v]||n.v:e==null?jO(n,n.v):jO(n,e))}function Bd(n,e){var t=e&&e.sheet?e.sheet:"Sheet1",r={};return r[t]=n,{SheetNames:[t],Sheets:r}}function iG(n,e,t){var r=t||{},i=n?Array.isArray(n):r.dense,s=n||(i?[]:{}),a=0,o=0;if(s&&r.origin!=null){if(typeof r.origin=="number")a=r.origin;else{var l=typeof r.origin=="string"?ki(r.origin):r.origin;a=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var h=pr(s["!ref"]);c.s.c=h.s.c,c.s.r=h.s.r,c.e.c=Math.max(c.e.c,h.e.c),c.e.r=Math.max(c.e.r,h.e.r),a==-1&&(c.e.r=a=h.e.r+1)}for(var g=0;g!=e.length;++g)if(e[g]){if(!Array.isArray(e[g]))throw new Error("aoa_to_sheet expects an array of arrays");for(var m=0;m!=e[g].length;++m)if(!(typeof e[g][m]>"u")){var y={v:e[g][m]},_=a+g,x=o+m;if(c.s.r>_&&(c.s.r=_),c.s.c>x&&(c.s.c=x),c.e.r<_&&(c.e.r=_),c.e.c<x&&(c.e.c=x),e[g][m]&&typeof e[g][m]=="object"&&!Array.isArray(e[g][m])&&!(e[g][m]instanceof Date))y=e[g][m];else if(Array.isArray(y.v)&&(y.f=e[g][m][1],y.v=y.v[0]),y.v===null)if(y.f)y.t="n";else if(r.nullError)y.t="e",y.v=0;else if(r.sheetStubs)y.t="z";else continue;else typeof y.v=="number"?y.t="n":typeof y.v=="boolean"?y.t="b":y.v instanceof Date?(y.z=r.dateNF||Gr[14],r.cellDates?(y.t="d",y.w=$u(y.z,Hs(y.v))):(y.t="n",y.v=Hs(y.v),y.w=$u(y.z,y.v))):y.t="s";if(i)s[_]||(s[_]=[]),s[_][x]&&s[_][x].z&&(y.z=s[_][x].z),s[_][x]=y;else{var w=nr({c:x,r:_});s[w]&&s[w].z&&(y.z=s[w].z),s[w]=y}}}return c.s.c<1e7&&(s["!ref"]=ii(c)),s}function wg(n,e){return iG(null,n,e)}function Txe(n){return n.read_shift(4,"i")}function vo(n,e){return e||(e=Le(4)),e.write_shift(4,n),e}function ms(n){var e=n.read_shift(4);return e===0?"":n.read_shift(e,"dbcs")}function Ii(n,e){var t=!1;return e==null&&(t=!0,e=Le(4+2*n.length)),e.write_shift(4,n.length),n.length>0&&e.write_shift(0,n,"dbcs"),t?e.slice(0,e.l):e}function Rxe(n){return{ich:n.read_shift(2),ifnt:n.read_shift(2)}}function Axe(n,e){return e||(e=Le(4)),e.write_shift(2,0),e.write_shift(2,0),e}function pC(n,e){var t=n.l,r=n.read_shift(1),i=ms(n),s=[],a={t:i,h:i};if((r&1)!==0){for(var o=n.read_shift(4),l=0;l!=o;++l)s.push(Rxe(n));a.r=s}else a.r=[{ich:0,ifnt:0}];return n.l=t+e,a}function kxe(n,e){var t=!1;return e==null&&(t=!0,e=Le(15+4*n.t.length)),e.write_shift(1,0),Ii(n.t,e),t?e.slice(0,e.l):e}var Ixe=pC;function Cxe(n,e){var t=!1;return e==null&&(t=!0,e=Le(23+4*n.t.length)),e.write_shift(1,1),Ii(n.t,e),e.write_shift(4,1),Axe({},e),t?e.slice(0,e.l):e}function Ha(n){var e=n.read_shift(4),t=n.read_shift(2);return t+=n.read_shift(1)<<16,n.l++,{c:e,iStyleRef:t}}function Gd(n,e){return e==null&&(e=Le(8)),e.write_shift(-4,n.c),e.write_shift(3,n.iStyleRef||n.s),e.write_shift(1,0),e}function zd(n){var e=n.read_shift(2);return e+=n.read_shift(1)<<16,n.l++,{c:-1,iStyleRef:e}}function Ud(n,e){return e==null&&(e=Le(4)),e.write_shift(3,n.iStyleRef||n.s),e.write_shift(1,0),e}var Pxe=ms,sG=Ii;function yC(n){var e=n.read_shift(4);return e===0||e===4294967295?"":n.read_shift(e,"dbcs")}function lw(n,e){var t=!1;return e==null&&(t=!0,e=Le(127)),e.write_shift(4,n.length>0?n.length:4294967295),n.length>0&&e.write_shift(0,n,"dbcs"),t?e.slice(0,e.l):e}var Nxe=ms,WR=yC,xC=lw;function aG(n){var e=n.slice(n.l,n.l+4),t=e[0]&1,r=e[0]&2;n.l+=4;var i=r===0?ow([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Vh(e,0)>>2;return t?i/100:i}function oG(n,e){e==null&&(e=Le(4));var t=0,r=0,i=n*100;if(n==(n|0)&&n>=-536870912&&n<1<<29?r=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(r=1,t=1),r)e.write_shift(-4,((t?i:n)<<2)+(t+2));else throw new Error("unsupported RkNumber "+n)}function lG(n){var e={s:{},e:{}};return e.s.r=n.read_shift(4),e.e.r=n.read_shift(4),e.s.c=n.read_shift(4),e.e.c=n.read_shift(4),e}function Mxe(n,e){return e||(e=Le(16)),e.write_shift(4,n.s.r),e.write_shift(4,n.e.r),e.write_shift(4,n.s.c),e.write_shift(4,n.e.c),e}var $d=lG,Eg=Mxe;function Sg(n){if(n.length-n.l<8)throw"XLS Xnum Buffer underflow";return n.read_shift(8,"f")}function Rd(n,e){return(e||Le(8)).write_shift(8,n,"f")}function Lxe(n){var e={},t=n.read_shift(1),r=t>>>1,i=n.read_shift(1),s=n.read_shift(2,"i"),a=n.read_shift(1),o=n.read_shift(1),l=n.read_shift(1);switch(n.l++,r){case 0:e.auto=1;break;case 1:e.index=i;var c=Uxe[i];c&&(e.rgb=XO(c));break;case 2:e.rgb=XO([a,o,l]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function cw(n,e){if(e||(e=Le(8)),!n||n.auto)return e.write_shift(4,0),e.write_shift(4,0),e;n.index!=null?(e.write_shift(1,2),e.write_shift(1,n.index)):n.theme!=null?(e.write_shift(1,6),e.write_shift(1,n.theme)):(e.write_shift(1,5),e.write_shift(1,0));var t=n.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),e.write_shift(2,t),!n.rgb||n.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var r=n.rgb||"FFFFFF";typeof r=="number"&&(r=("000000"+r.toString(16)).slice(-6)),e.write_shift(1,parseInt(r.slice(0,2),16)),e.write_shift(1,parseInt(r.slice(2,4),16)),e.write_shift(1,parseInt(r.slice(4,6),16)),e.write_shift(1,255)}return e}function Oxe(n){var e=n.read_shift(1);n.l++;var t={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return t}function Dxe(n,e){e||(e=Le(2));var t=(n.italic?2:0)|(n.strike?8:0)|(n.outline?16:0)|(n.shadow?32:0)|(n.condense?64:0)|(n.extend?128:0);return e.write_shift(1,t),e.write_shift(1,0),e}var cG=2,ra=3,qx=11,uw=19,Yx=64,jxe=65,Fxe=71,Vxe=4108,Bxe=4126,Gi=80,FO={1:{n:"CodePage",t:cG},2:{n:"Category",t:Gi},3:{n:"PresentationFormat",t:Gi},4:{n:"ByteCount",t:ra},5:{n:"LineCount",t:ra},6:{n:"ParagraphCount",t:ra},7:{n:"SlideCount",t:ra},8:{n:"NoteCount",t:ra},9:{n:"HiddenCount",t:ra},10:{n:"MultimediaClipCount",t:ra},11:{n:"ScaleCrop",t:qx},12:{n:"HeadingPairs",t:Vxe},13:{n:"TitlesOfParts",t:Bxe},14:{n:"Manager",t:Gi},15:{n:"Company",t:Gi},16:{n:"LinksUpToDate",t:qx},17:{n:"CharacterCount",t:ra},19:{n:"SharedDoc",t:qx},22:{n:"HyperlinksChanged",t:qx},23:{n:"AppVersion",t:ra,p:"version"},24:{n:"DigSig",t:jxe},26:{n:"ContentType",t:Gi},27:{n:"ContentStatus",t:Gi},28:{n:"Language",t:Gi},29:{n:"Version",t:Gi},255:{},2147483648:{n:"Locale",t:uw},2147483651:{n:"Behavior",t:uw},1919054434:{}},VO={1:{n:"CodePage",t:cG},2:{n:"Title",t:Gi},3:{n:"Subject",t:Gi},4:{n:"Author",t:Gi},5:{n:"Keywords",t:Gi},6:{n:"Comments",t:Gi},7:{n:"Template",t:Gi},8:{n:"LastAuthor",t:Gi},9:{n:"RevNumber",t:Gi},10:{n:"EditTime",t:Yx},11:{n:"LastPrinted",t:Yx},12:{n:"CreatedDate",t:Yx},13:{n:"ModifiedDate",t:Yx},14:{n:"PageCount",t:ra},15:{n:"WordCount",t:ra},16:{n:"CharCount",t:ra},17:{n:"Thumbnail",t:Fxe},18:{n:"Application",t:Gi},19:{n:"DocSecurity",t:ra},255:{},2147483648:{n:"Locale",t:uw},2147483651:{n:"Behavior",t:uw},1919054434:{}};function Gxe(n){return n.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var zxe=Gxe([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Uxe=Ks(zxe),oy={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},$xe={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Zx={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function uG(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function hG(n,e){var t=exe($xe),r=[],i;r[r.length]=ai,r[r.length]=at("Types",null,{xmlns:Ri.CT,"xmlns:xsd":Ri.xsd,"xmlns:xsi":Ri.xsi}),r=r.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return at("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){n[l]&&n[l].length>0&&(i=n[l][0],r[r.length]=at("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:Zx[l][e.bookType]||Zx[l].xlsx}))},a=function(l){(n[l]||[]).forEach(function(c){r[r.length]=at("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:Zx[l][e.bookType]||Zx[l].xlsx})})},o=function(l){(n[l]||[]).forEach(function(c){r[r.length]=at("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:t[l][0]})})};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),r.length>2&&(r[r.length]="</Types>",r[1]=r[1].replace("/>",">")),r.join("")}var Mn={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function dG(n){var e=n.lastIndexOf("/");return n.slice(0,e+1)+"_rels/"+n.slice(e+1)+".rels"}function A0(n){var e=[ai,at("Relationships",null,{xmlns:Ri.RELS})];return Xi(n["!id"]).forEach(function(t){e[e.length]=at("Relationship",null,n["!id"][t])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function Yn(n,e,t,r,i,s){if(i||(i={}),n["!id"]||(n["!id"]={}),n["!idx"]||(n["!idx"]=1),e<0)for(e=n["!idx"];n["!id"]["rId"+e];++e);if(n["!idx"]=e+1,i.Id="rId"+e,i.Type=r,i.Target=t,[Mn.HLINK,Mn.XPATH,Mn.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),n["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return n["!id"][i.Id]=i,n[("/"+i.Target).replace("//","/")]=i,e}function Wxe(n){var e=[ai];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<n.length;++t)e.push('  <manifest:file-entry manifest:full-path="'+n[t][0]+'" manifest:media-type="'+n[t][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function BO(n,e,t){return['  <rdf:Description rdf:about="'+n+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function Hxe(n,e){return['  <rdf:Description rdf:about="'+n+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function Kxe(n){var e=[ai];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=n.length;++t)e.push(BO(n[t][0],n[t][1])),e.push(Hxe("",n[t][0]));return e.push(BO("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function fG(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+tw.version+"</meta:generator></office:meta></office:document-meta>"}var rd=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Gb(n,e,t,r,i){i[n]!=null||e==null||e===""||(i[n]=e,e=er(e),r[r.length]=t?at(n,e,t):Wi(n,e))}function gG(n,e){var t=e||{},r=[ai,at("cp:coreProperties",null,{"xmlns:cp":Ri.CORE_PROPS,"xmlns:dc":Ri.dc,"xmlns:dcterms":Ri.dcterms,"xmlns:dcmitype":Ri.dcmitype,"xmlns:xsi":Ri.xsi})],i={};if(!n&&!t.Props)return r.join("");n&&(n.CreatedDate!=null&&Gb("dcterms:created",typeof n.CreatedDate=="string"?n.CreatedDate:$R(n.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i),n.ModifiedDate!=null&&Gb("dcterms:modified",typeof n.ModifiedDate=="string"?n.ModifiedDate:$R(n.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i));for(var s=0;s!=rd.length;++s){var a=rd[s],o=t.Props&&t.Props[a[1]]!=null?t.Props[a[1]]:n?n[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&Gb(a[0],o,null,r,i)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}var k0=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],mG=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function pG(n){var e=[],t=at;return n||(n={}),n.Application="SheetJS",e[e.length]=ai,e[e.length]=at("Properties",null,{xmlns:Ri.EXT_PROPS,"xmlns:vt":Ri.vt}),k0.forEach(function(r){if(n[r[1]]!==void 0){var i;switch(r[2]){case"string":i=er(String(n[r[1]]));break;case"bool":i=n[r[1]]?"true":"false";break}i!==void 0&&(e[e.length]=t(r[0],i))}}),e[e.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(n.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=t("TitlesOfParts",t("vt:vector",n.SheetNames.map(function(r){return"<vt:lpstr>"+er(r)+"</vt:lpstr>"}).join(""),{size:n.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}function yG(n){var e=[ai,at("Properties",null,{xmlns:Ri.CUST_PROPS,"xmlns:vt":Ri.vt})];if(!n)return e.join("");var t=1;return Xi(n).forEach(function(i){++t,e[e.length]=at("property",hxe(n[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:er(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var GO={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function Xxe(n,e){var t=[];return Xi(GO).map(function(r){for(var i=0;i<rd.length;++i)if(rd[i][1]==r)return rd[i];for(i=0;i<k0.length;++i)if(k0[i][1]==r)return k0[i];throw r}).forEach(function(r){if(n[r[1]]!=null){var i=e&&e.Props&&e.Props[r[1]]!=null?e.Props[r[1]]:n[r[1]];switch(r[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),t.push(Wi(GO[r[1]]||r[1],i))}}),at("DocumentProperties",t.join(""),{xmlns:oa.o})}function qxe(n,e){var t=["Worksheets","SheetNames"],r="CustomDocumentProperties",i=[];return n&&Xi(n).forEach(function(s){if(Object.prototype.hasOwnProperty.call(n,s)){for(var a=0;a<rd.length;++a)if(s==rd[a][1])return;for(a=0;a<k0.length;++a)if(s==k0[a][1])return;for(a=0;a<t.length;++a)if(s==t[a])return;var o=n[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),i.push(at(kO(s),o,{"dt:dt":l}))}}),e&&Xi(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(n&&Object.prototype.hasOwnProperty.call(n,s))){var a=e[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),i.push(at(kO(s),a,{"dt:dt":o}))}}),"<"+r+' xmlns="'+oa.o+'">'+i.join("")+"</"+r+">"}function Yxe(n){var e=typeof n=="string"?new Date(Date.parse(n)):n,t=e.getTime()/1e3+11644473600,r=t%Math.pow(2,32),i=(t-r)/Math.pow(2,32);r*=1e7,i*=1e7;var s=r/Math.pow(2,32)|0;s>0&&(r=r%Math.pow(2,32),i+=s);var a=Le(8);return a.write_shift(4,r),a.write_shift(4,i),a}function zO(n,e){var t=Le(4),r=Le(4);switch(t.write_shift(4,n==80?31:n),n){case 3:r.write_shift(-4,e);break;case 5:r=Le(8),r.write_shift(8,e,"f");break;case 11:r.write_shift(4,e?1:0);break;case 64:r=Yxe(e);break;case 31:case 80:for(r=Le(4+2*(e.length+1)+(e.length%2?0:2)),r.write_shift(4,e.length+1),r.write_shift(0,e,"dbcs");r.l!=r.length;)r.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+n+" "+e)}return $i([t,r])}var xG=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Zxe(n){switch(typeof n){case"boolean":return 11;case"number":return(n|0)==n?3:5;case"string":return 31;case"object":if(n instanceof Date)return 64;break}return-1}function UO(n,e,t){var r=Le(8),i=[],s=[],a=8,o=0,l=Le(8),c=Le(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),s.push(l),i.push(c),a+=8+l.length,!e){c=Le(8),c.write_shift(4,0),i.unshift(c);var h=[Le(4)];for(h[0].write_shift(4,n.length),o=0;o<n.length;++o){var g=n[o][0];for(l=Le(8+2*(g.length+1)+(g.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,g.length+1),l.write_shift(0,g,"dbcs");l.l!=l.length;)l.write_shift(1,0);h.push(l)}l=$i(h),s.unshift(l),a+=8+l.length}for(o=0;o<n.length;++o)if(!(e&&!e[n[o][0]])&&!(xG.indexOf(n[o][0])>-1||mG.indexOf(n[o][0])>-1)&&n[o][1]!=null){var m=n[o][1],y=0;if(e){y=+e[n[o][0]];var _=t[y];if(_.p=="version"&&typeof m=="string"){var x=m.split(".");m=(+x[0]<<16)+(+x[1]||0)}l=zO(_.t,m)}else{var w=Zxe(m);w==-1&&(w=31,m=String(m)),l=zO(w,m)}s.push(l),c=Le(8),c.write_shift(4,e?y:2+o),i.push(c),a+=8+l.length}var b=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,b),b+=s[o].length;return r.write_shift(4,a),r.write_shift(4,s.length),$i([r].concat(i).concat(s))}function $O(n,e,t,r,i,s){var a=Le(i?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,rr.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,e,"hex"),a.write_shift(4,i?68:48);var l=UO(n,t,r);if(o.push(l),i){var c=UO(i,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+l.length),o.push(c)}return $i(o)}function Jxe(n,e){e||(e=Le(n));for(var t=0;t<n;++t)e.write_shift(1,0);return e}function Qxe(n,e){return n.read_shift(e)===1}function _s(n,e){return e||(e=Le(2)),e.write_shift(2,+!!n),e}function _G(n){return n.read_shift(2,"u")}function Pa(n,e){return e||(e=Le(2)),e.write_shift(2,n),e}function vG(n,e,t){return t||(t=Le(2)),t.write_shift(1,e=="e"?+n:+!!n),t.write_shift(1,e=="e"?1:0),t}function wG(n,e,t){var r=n.read_shift(t&&t.biff>=12?2:1),i="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var s=n.read_shift(1);s&&(i="dbcs-cont")}else t.biff==12&&(i="wstr");t.biff>=2&&t.biff<=5&&(i="cpstr");var a=r?n.read_shift(r,i):"";return a}function e_e(n){var e=n.t||"",t=Le(3);t.write_shift(2,e.length),t.write_shift(1,1);var r=Le(2*e.length);r.write_shift(2*e.length,e,"utf16le");var i=[t,r];return $i(i)}function t_e(n,e,t){var r;if(t){if(t.biff>=2&&t.biff<=5)return n.read_shift(e,"cpstr");if(t.biff>=12)return n.read_shift(e,"dbcs-cont")}var i=n.read_shift(1);return i===0?r=n.read_shift(e,"sbcs-cont"):r=n.read_shift(e,"dbcs-cont"),r}function n_e(n,e,t){var r=n.read_shift(t&&t.biff==2?1:2);return r===0?(n.l++,""):t_e(n,r,t)}function r_e(n,e,t){if(t.biff>5)return n_e(n,e,t);var r=n.read_shift(1);return r===0?(n.l++,""):n.read_shift(r,t.biff<=4||!n.lens?"cpstr":"sbcs-cont")}function EG(n,e,t){return t||(t=Le(3+2*n.length)),t.write_shift(2,n.length),t.write_shift(1,1),t.write_shift(31,n,"utf16le"),t}function WO(n,e){e||(e=Le(6+n.length*2)),e.write_shift(4,1+n.length);for(var t=0;t<n.length;++t)e.write_shift(2,n.charCodeAt(t));return e.write_shift(2,0),e}function i_e(n){var e=Le(512),t=0,r=n.Target;r.slice(0,7)=="file://"&&(r=r.slice(7));var i=r.indexOf("#"),s=i>-1?31:23;switch(r.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(t=0;t<a.length;++t)e.write_shift(4,a[t]);if(s==28)r=r.slice(1),WO(r,e);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<a.length;++t)e.write_shift(1,parseInt(a[t],16));var o=i>-1?r.slice(0,i):r;for(e.write_shift(4,2*(o.length+1)),t=0;t<o.length;++t)e.write_shift(2,o.charCodeAt(t));e.write_shift(2,0),s&8&&WO(i>-1?r.slice(i+1):"",e)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<a.length;++t)e.write_shift(1,parseInt(a[t],16));for(var l=0;r.slice(l*3,l*3+3)=="../"||r.slice(l*3,l*3+3)=="..\\";)++l;for(e.write_shift(2,l),e.write_shift(4,r.length-3*l+1),t=0;t<r.length-3*l;++t)e.write_shift(1,r.charCodeAt(t+3*l)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),t=0;t<6;++t)e.write_shift(4,0)}return e.slice(0,e.l)}function Ad(n,e,t,r){return r||(r=Le(6)),r.write_shift(2,n),r.write_shift(2,e),r.write_shift(2,t||0),r}function s_e(n,e,t){var r=t.biff>8?4:2,i=n.read_shift(r),s=n.read_shift(r,"i"),a=n.read_shift(r,"i");return[i,s,a]}function a_e(n){var e=n.read_shift(2),t=n.read_shift(2),r=n.read_shift(2),i=n.read_shift(2);return{s:{c:r,r:e},e:{c:i,r:t}}}function SG(n,e){return e||(e=Le(8)),e.write_shift(2,n.s.r),e.write_shift(2,n.e.r),e.write_shift(2,n.s.c),e.write_shift(2,n.e.c),e}function _C(n,e,t){var r=1536,i=16;switch(t.bookType){case"biff8":break;case"biff5":r=1280,i=8;break;case"biff4":r=4,i=6;break;case"biff3":r=3,i=6;break;case"biff2":r=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=Le(i);return s.write_shift(2,r),s.write_shift(2,e),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function o_e(n,e){var t=!e||e.biff==8,r=Le(t?112:54);for(r.write_shift(e.biff==8?2:1,7),t&&r.write_shift(1,0),r.write_shift(4,859007059),r.write_shift(4,5458548|(t?0:536870912));r.l<r.length;)r.write_shift(1,t?0:32);return r}function l_e(n,e){var t=!e||e.biff>=8?2:1,r=Le(8+t*n.name.length);r.write_shift(4,n.pos),r.write_shift(1,n.hs||0),r.write_shift(1,n.dt),r.write_shift(1,n.name.length),e.biff>=8&&r.write_shift(1,1),r.write_shift(t*n.name.length,n.name,e.biff<8?"sbcs":"utf16le");var i=r.slice(0,r.l);return i.l=r.l,i}function c_e(n,e){var t=Le(8);t.write_shift(4,n.Count),t.write_shift(4,n.Unique);for(var r=[],i=0;i<n.length;++i)r[i]=e_e(n[i]);var s=$i([t].concat(r));return s.parts=[t.length].concat(r.map(function(a){return a.length})),s}function u_e(){var n=Le(18);return n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,29280),n.write_shift(2,17600),n.write_shift(2,56),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,1),n.write_shift(2,500),n}function h_e(n){var e=Le(18),t=1718;return n&&n.RTL&&(t|=64),e.write_shift(2,t),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function d_e(n,e){var t=n.name||"Arial",r=e&&e.biff==5,i=r?15+t.length:16+2*t.length,s=Le(i);return s.write_shift(2,n.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,t.length),r||s.write_shift(1,1),s.write_shift((r?1:2)*t.length,t,r?"sbcs":"utf16le"),s}function f_e(n,e,t,r){var i=Le(10);return Ad(n,e,r,i),i.write_shift(4,t),i}function g_e(n,e,t,r,i){var s=!i||i.biff==8,a=Le(8+ +s+(1+s)*t.length);return Ad(n,e,r,a),a.write_shift(2,t.length),s&&a.write_shift(1,1),a.write_shift((1+s)*t.length,t,s?"utf16le":"sbcs"),a}function m_e(n,e,t,r){var i=t&&t.biff==5;r||(r=Le(i?3+e.length:5+2*e.length)),r.write_shift(2,n),r.write_shift(i?1:2,e.length),i||r.write_shift(1,1),r.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var s=r.length>r.l?r.slice(0,r.l):r;return s.l==null&&(s.l=s.length),s}function p_e(n,e){var t=e.biff==8||!e.biff?4:2,r=Le(2*t+6);return r.write_shift(t,n.s.r),r.write_shift(t,n.e.r+1),r.write_shift(2,n.s.c),r.write_shift(2,n.e.c+1),r.write_shift(2,0),r}function HO(n,e,t,r){var i=t&&t.biff==5;r||(r=Le(i?16:20)),r.write_shift(2,0),n.style?(r.write_shift(2,n.numFmtId||0),r.write_shift(2,65524)):(r.write_shift(2,n.numFmtId||0),r.write_shift(2,e<<4));var s=0;return n.numFmtId>0&&i&&(s|=1024),r.write_shift(4,s),r.write_shift(4,0),i||r.write_shift(4,0),r.write_shift(2,0),r}function y_e(n){var e=Le(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function x_e(n,e,t,r,i,s){var a=Le(8);return Ad(n,e,r,a),vG(t,s,a),a}function __e(n,e,t,r){var i=Le(14);return Ad(n,e,r,i),Rd(t,i),i}function v_e(n,e,t){if(t.biff<8)return w_e(n,e,t);for(var r=[],i=n.l+e,s=n.read_shift(t.biff>8?4:2);s--!==0;)r.push(s_e(n,t.biff>8?12:6,t));if(n.l!=i)throw new Error("Bad ExternSheet: "+n.l+" != "+i);return r}function w_e(n,e,t){n[n.l+1]==3&&n[n.l]++;var r=wG(n,e,t);return r.charCodeAt(0)==3?r.slice(1):r}function E_e(n){var e=Le(2+n.length*8);e.write_shift(2,n.length);for(var t=0;t<n.length;++t)SG(n[t],e);return e}function S_e(n){var e=Le(24),t=ki(n[0]);e.write_shift(2,t.r),e.write_shift(2,t.r),e.write_shift(2,t.c),e.write_shift(2,t.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(r[i],16));return $i([e,i_e(n[1])])}function b_e(n){var e=n[1].Tooltip,t=Le(10+2*(e.length+1));t.write_shift(2,2048);var r=ki(n[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var i=0;i<e.length;++i)t.write_shift(2,e.charCodeAt(i));return t.write_shift(2,0),t}function T_e(n){return n||(n=Le(4)),n.write_shift(2,1),n.write_shift(2,1),n}function R_e(n,e,t){if(!t.cellStyles)return ml(n,e);var r=t&&t.biff>=12?4:2,i=n.read_shift(r),s=n.read_shift(r),a=n.read_shift(r),o=n.read_shift(r),l=n.read_shift(2);r==2&&(n.l+=2);var c={s:i,e:s,w:a,ixfe:o,flags:l};return(t.biff>=5||!t.biff)&&(c.level=l>>8&7),c}function A_e(n,e){var t=Le(12);t.write_shift(2,e),t.write_shift(2,e),t.write_shift(2,n.width*256),t.write_shift(2,0);var r=0;return n.hidden&&(r|=1),t.write_shift(1,r),r=n.level||0,t.write_shift(1,r),t.write_shift(2,0),t}function k_e(n){for(var e=Le(2*n),t=0;t<n;++t)e.write_shift(2,t+1);return e}function I_e(n,e,t){var r=Le(15);return cy(r,n,e),r.write_shift(8,t,"f"),r}function C_e(n,e,t){var r=Le(9);return cy(r,n,e),r.write_shift(2,t),r}var P_e=(function(){var n={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=lC({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(o,l){var c=[],h=Td(1);switch(l.type){case"base64":h=ho(dc(o));break;case"binary":h=ho(o);break;case"buffer":case"array":h=o;break}sa(h,0);var g=h.read_shift(1),m=!!(g&136),y=!1,_=!1;switch(g){case 2:break;case 3:break;case 48:y=!0,m=!0;break;case 49:y=!0,m=!0;break;case 131:break;case 139:break;case 140:_=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+g.toString(16))}var x=0,w=521;g==2&&(x=h.read_shift(2)),h.l+=3,g!=2&&(x=h.read_shift(4)),x>1048576&&(x=1e6),g!=2&&(w=h.read_shift(2));var b=h.read_shift(2),T=l.codepage||1252;g!=2&&(h.l+=16,h.read_shift(1),h[h.l]!==0&&(T=n[h[h.l]]),h.l+=1,h.l+=2),_&&(h.l+=36);for(var k=[],L={},O=Math.min(h.length,g==2?521:w-10-(y?264:0)),B=_?32:11;h.l<O&&h[h.l]!=13;)switch(L={},L.name=nw.utils.decode(T,h.slice(h.l,h.l+B)).replace(/[\u0000\r\n].*$/g,""),h.l+=B,L.type=String.fromCharCode(h.read_shift(1)),g!=2&&!_&&(L.offset=h.read_shift(4)),L.len=h.read_shift(1),g==2&&(L.offset=h.read_shift(2)),L.dec=h.read_shift(1),L.name.length&&k.push(L),g!=2&&(h.l+=_?13:14),L.type){case"B":(!y||L.len!=8)&&l.WTF&&console.log("Skipping "+L.name+":"+L.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+L.name+":"+L.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+L.type)}if(h[h.l]!==13&&(h.l=w-1),h.read_shift(1)!==13)throw new Error("DBF Terminator not found "+h.l+" "+h[h.l]);h.l=w;var R=0,A=0;for(c[0]=[],A=0;A!=k.length;++A)c[0][A]=k[A].name;for(;x-- >0;){if(h[h.l]===42){h.l+=b;continue}for(++h.l,c[++R]=[],A=0,A=0;A!=k.length;++A){var P=h.slice(h.l,h.l+k[A].len);h.l+=k[A].len,sa(P,0);var D=nw.utils.decode(T,P);switch(k[A].type){case"C":D.trim().length&&(c[R][A]=D.replace(/\s+$/,""));break;case"D":D.length===8?c[R][A]=new Date(+D.slice(0,4),+D.slice(4,6)-1,+D.slice(6,8)):c[R][A]=D;break;case"F":c[R][A]=parseFloat(D.trim());break;case"+":case"I":c[R][A]=_?P.read_shift(-4,"i")^2147483648:P.read_shift(4,"i");break;case"L":switch(D.trim().toUpperCase()){case"Y":case"T":c[R][A]=!0;break;case"N":case"F":c[R][A]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+D+"|")}break;case"M":if(!m)throw new Error("DBF Unexpected MEMO for type "+g.toString(16));c[R][A]="##MEMO##"+(_?parseInt(D.trim(),10):P.read_shift(4));break;case"N":D=D.replace(/\u0000/g,"").trim(),D&&D!="."&&(c[R][A]=+D||0);break;case"@":c[R][A]=new Date(P.read_shift(-8,"f")-621356832e5);break;case"T":c[R][A]=new Date((P.read_shift(4)-2440588)*864e5+P.read_shift(4));break;case"Y":c[R][A]=P.read_shift(4,"i")/1e4+P.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[R][A]=-P.read_shift(-8,"f");break;case"B":if(y&&k[A].len==8){c[R][A]=P.read_shift(8,"f");break}case"G":case"P":P.l+=k[A].len;break;case"0":if(k[A].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+k[A].type)}}}if(g!=2&&h.l<h.length&&h[h.l++]!=26)throw new Error("DBF EOF Marker missing "+(h.l-1)+" of "+h.length+" "+h[h.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=k,c}function r(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var h=wg(t(o,c),c);return h["!cols"]=c.DBF.map(function(g){return{wch:g.len,DBF:g}}),delete c.DBF,h}function i(o,l){try{return Bd(r(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var c=l||{};if(+c.codepage>=0&&a1(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var h=Gs(),g=mw(o,{header:1,raw:!0,cellDates:!0}),m=g[0],y=g.slice(1),_=o["!cols"]||[],x=0,w=0,b=0,T=1;for(x=0;x<m.length;++x){if(((_[x]||{}).DBF||{}).name){m[x]=_[x].DBF.name,++b;continue}if(m[x]!=null){if(++b,typeof m[x]=="number"&&(m[x]=m[x].toString(10)),typeof m[x]!="string")throw new Error("DBF Invalid column name "+m[x]+" |"+typeof m[x]+"|");if(m.indexOf(m[x])!==x){for(w=0;w<1024;++w)if(m.indexOf(m[x]+"_"+w)==-1){m[x]+="_"+w;break}}}}var k=pr(o["!ref"]),L=[],O=[],B=[];for(x=0;x<=k.e.c-k.s.c;++x){var R="",A="",P=0,D=[];for(w=0;w<y.length;++w)y[w][x]!=null&&D.push(y[w][x]);if(D.length==0||m[x]==null){L[x]="?";continue}for(w=0;w<D.length;++w){switch(typeof D[w]){case"number":A="B";break;case"string":A="C";break;case"boolean":A="L";break;case"object":A=D[w]instanceof Date?"D":"C";break;default:A="C"}P=Math.max(P,String(D[w]).length),R=R&&R!=A?"C":A}P>250&&(P=250),A=((_[x]||{}).DBF||{}).type,A=="C"&&_[x].DBF.len>P&&(P=_[x].DBF.len),R=="B"&&A=="N"&&(R="N",B[x]=_[x].DBF.dec,P=_[x].DBF.len),O[x]=R=="C"||A=="N"?P:s[R]||0,T+=O[x],L[x]=R}var N=h.next(32);for(N.write_shift(4,318902576),N.write_shift(4,y.length),N.write_shift(2,296+32*b),N.write_shift(2,T),x=0;x<4;++x)N.write_shift(4,0);for(N.write_shift(4,0|(+e[TB]||3)<<8),x=0,w=0;x<m.length;++x)if(m[x]!=null){var G=h.next(32),j=(m[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);G.write_shift(1,j,"sbcs"),G.write_shift(1,L[x]=="?"?"C":L[x],"sbcs"),G.write_shift(4,w),G.write_shift(1,O[x]||s[L[x]]||0),G.write_shift(1,B[x]||0),G.write_shift(1,2),G.write_shift(4,0),G.write_shift(1,0),G.write_shift(4,0),G.write_shift(4,0),w+=O[x]||s[L[x]]||0}var ve=h.next(264);for(ve.write_shift(4,13),x=0;x<65;++x)ve.write_shift(4,0);for(x=0;x<y.length;++x){var ce=h.next(T);for(ce.write_shift(1,0),w=0;w<m.length;++w)if(m[w]!=null)switch(L[w]){case"L":ce.write_shift(1,y[x][w]==null?63:y[x][w]?84:70);break;case"B":ce.write_shift(8,y[x][w]||0,"f");break;case"N":var je="0";for(typeof y[x][w]=="number"&&(je=y[x][w].toFixed(B[w]||0)),b=0;b<O[w]-je.length;++b)ce.write_shift(1,32);ce.write_shift(1,je,"sbcs");break;case"D":y[x][w]?(ce.write_shift(4,("0000"+y[x][w].getFullYear()).slice(-4),"sbcs"),ce.write_shift(2,("00"+(y[x][w].getMonth()+1)).slice(-2),"sbcs"),ce.write_shift(2,("00"+y[x][w].getDate()).slice(-2),"sbcs")):ce.write_shift(8,"00000000","sbcs");break;case"C":var Pe=String(y[x][w]!=null?y[x][w]:"").slice(0,O[w]);for(ce.write_shift(1,Pe,"sbcs"),b=0;b<O[w]-Pe.length;++b)ce.write_shift(1,32);break}}return h.next(1).write_shift(1,26),h.end()}return{to_workbook:i,to_sheet:r,from_sheet:a}})(),N_e=(function(){var n={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Xi(n).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(m,y){var _=n[y];return typeof _=="number"?pO(_):_},r=function(m,y,_){var x=y.charCodeAt(0)-32<<4|_.charCodeAt(0)-48;return x==59?m:pO(x)};n["|"]=254;function i(m,y){switch(y.type){case"base64":return s(dc(m),y);case"binary":return s(m,y);case"buffer":return s(Fn&&Buffer.isBuffer(m)?m.toString("binary"):iy(m),y);case"array":return s(VE(m),y)}throw new Error("Unrecognized type "+y.type)}function s(m,y){var _=m.split(/[\n\r]+/),x=-1,w=-1,b=0,T=0,k=[],L=[],O=null,B={},R=[],A=[],P=[],D=0,N;for(+y.codepage>=0&&a1(+y.codepage);b!==_.length;++b){D=0;var G=_[b].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(e,t),j=G.replace(/;;/g,"\0").split(";").map(function(re){return re.replace(/\u0000/g,";")}),ve=j[0],ce;if(G.length>0)switch(ve){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":j[1].charAt(0)=="P"&&L.push(G.slice(3).replace(/;;/g,";"));break;case"C":var je=!1,Pe=!1,ue=!1,Ne=!1,be=-1,ie=-1;for(T=1;T<j.length;++T)switch(j[T].charAt(0)){case"A":break;case"X":w=parseInt(j[T].slice(1))-1,Pe=!0;break;case"Y":for(x=parseInt(j[T].slice(1))-1,Pe||(w=0),N=k.length;N<=x;++N)k[N]=[];break;case"K":ce=j[T].slice(1),ce.charAt(0)==='"'?ce=ce.slice(1,ce.length-1):ce==="TRUE"?ce=!0:ce==="FALSE"?ce=!1:isNaN(nc(ce))?isNaN(l1(ce).getDate())||(ce=Ts(ce)):(ce=nc(ce),O!==null&&jB(O)&&(ce=GB(ce))),je=!0;break;case"E":Ne=!0;var V=Cve(j[T].slice(1),{r:x,c:w});k[x][w]=[k[x][w],V];break;case"S":ue=!0,k[x][w]=[k[x][w],"S5S"];break;case"G":break;case"R":be=parseInt(j[T].slice(1))-1;break;case"C":ie=parseInt(j[T].slice(1))-1;break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+G)}if(je&&(k[x][w]&&k[x][w].length==2?k[x][w][0]=ce:k[x][w]=ce,O=null),ue){if(Ne)throw new Error("SYLK shared formula cannot have own formula");var J=be>-1&&k[be][ie];if(!J||!J[1])throw new Error("SYLK shared formula cannot find base");k[x][w][1]=Pve(J[1],{r:x-be,c:w-ie})}break;case"F":var te=0;for(T=1;T<j.length;++T)switch(j[T].charAt(0)){case"X":w=parseInt(j[T].slice(1))-1,++te;break;case"Y":for(x=parseInt(j[T].slice(1))-1,N=k.length;N<=x;++N)k[N]=[];break;case"M":D=parseInt(j[T].slice(1))/20;break;case"F":break;case"G":break;case"P":O=L[parseInt(j[T].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(P=j[T].slice(1).split(" "),N=parseInt(P[0],10);N<=parseInt(P[1],10);++N)D=parseInt(P[2],10),A[N-1]=D===0?{hidden:!0}:{wch:D},vC(A[N-1]);break;case"C":w=parseInt(j[T].slice(1))-1,A[w]||(A[w]={});break;case"R":x=parseInt(j[T].slice(1))-1,R[x]||(R[x]={}),D>0?(R[x].hpt=D,R[x].hpx=kG(D)):D===0&&(R[x].hidden=!0);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+G)}te<1&&(O=null);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+G)}}return R.length>0&&(B["!rows"]=R),A.length>0&&(B["!cols"]=A),y&&y.sheetRows&&(k=k.slice(0,y.sheetRows)),[k,B]}function a(m,y){var _=i(m,y),x=_[0],w=_[1],b=wg(x,y);return Xi(w).forEach(function(T){b[T]=w[T]}),b}function o(m,y){return Bd(a(m,y),y)}function l(m,y,_,x){var w="C;Y"+(_+1)+";X"+(x+1)+";K";switch(m.t){case"n":w+=m.v||0,m.f&&!m.F&&(w+=";E"+EC(m.f,{r:_,c:x}));break;case"b":w+=m.v?"TRUE":"FALSE";break;case"e":w+=m.w||m.v;break;case"d":w+='"'+(m.w||m.v)+'"';break;case"s":w+='"'+m.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function c(m,y){y.forEach(function(_,x){var w="F;W"+(x+1)+" "+(x+1)+" ";_.hidden?w+="0":(typeof _.width=="number"&&!_.wpx&&(_.wpx=hw(_.width)),typeof _.wpx=="number"&&!_.wch&&(_.wch=dw(_.wpx)),typeof _.wch=="number"&&(w+=Math.round(_.wch))),w.charAt(w.length-1)!=" "&&m.push(w)})}function h(m,y){y.forEach(function(_,x){var w="F;";_.hidden?w+="M0;":_.hpt?w+="M"+20*_.hpt+";":_.hpx&&(w+="M"+20*fw(_.hpx)+";"),w.length>2&&m.push(w+"R"+(x+1))})}function g(m,y){var _=["ID;PWXL;N;E"],x=[],w=pr(m["!ref"]),b,T=Array.isArray(m),k=`\r
`;_.push("P;PGeneral"),_.push("F;P0;DG0G8;M255"),m["!cols"]&&c(_,m["!cols"]),m["!rows"]&&h(_,m["!rows"]),_.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var L=w.s.r;L<=w.e.r;++L)for(var O=w.s.c;O<=w.e.c;++O){var B=nr({r:L,c:O});b=T?(m[L]||[])[O]:m[B],!(!b||b.v==null&&(!b.f||b.F))&&x.push(l(b,m,L,O))}return _.join(k)+k+x.join(k)+k+"E"+k}return{to_workbook:o,to_sheet:a,from_sheet:g}})(),M_e=(function(){function n(s,a){switch(a.type){case"base64":return e(dc(s),a);case"binary":return e(s,a);case"buffer":return e(Fn&&Buffer.isBuffer(s)?s.toString("binary"):iy(s),a);case"array":return e(VE(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){for(var o=s.split(`
`),l=-1,c=-1,h=0,g=[];h!==o.length;++h){if(o[h].trim()==="BOT"){g[++l]=[],c=0;continue}if(!(l<0)){var m=o[h].trim().split(","),y=m[0],_=m[1];++h;for(var x=o[h]||"";(x.match(/["]/g)||[]).length&1&&h<o.length-1;)x+=`
`+o[++h];switch(x=x.trim(),+y){case-1:if(x==="BOT"){g[++l]=[],c=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?g[l][c]=!0:x==="FALSE"?g[l][c]=!1:isNaN(nc(_))?isNaN(l1(_).getDate())?g[l][c]=_:g[l][c]=Ts(_):g[l][c]=nc(_),++c;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),g[l][c++]=x!==""?x:null;break}if(x==="EOD")break}}return a&&a.sheetRows&&(g=g.slice(0,a.sheetRows)),g}function t(s,a){return wg(n(s,a),a)}function r(s,a){return Bd(t(s,a),a)}var i=(function(){var s=function(l,c,h,g,m){l.push(c),l.push(h+","+g),l.push('"'+m.replace(/"/g,'""')+'"')},a=function(l,c,h,g){l.push(c+","+h),l.push(c==1?'"'+g.replace(/"/g,'""')+'"':g)};return function(l){var c=[],h=pr(l["!ref"]),g,m=Array.isArray(l);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,h.e.r-h.s.r+1,""),s(c,"TUPLES",0,h.e.c-h.s.c+1,""),s(c,"DATA",0,0,"");for(var y=h.s.r;y<=h.e.r;++y){a(c,-1,0,"BOT");for(var _=h.s.c;_<=h.e.c;++_){var x=nr({r:y,c:_});if(g=m?(l[y]||[])[_]:l[x],!g){a(c,1,0,"");continue}switch(g.t){case"n":var w=g.w;!w&&g.v!=null&&(w=g.v),w==null?g.f&&!g.F?a(c,1,0,"="+g.f):a(c,1,0,""):a(c,0,w,"V");break;case"b":a(c,0,g.v?1:0,g.v?"TRUE":"FALSE");break;case"s":a(c,1,0,isNaN(g.v)?g.v:'="'+g.v+'"');break;case"d":g.w||(g.w=$u(g.z||Gr[14],Hs(Ts(g.v)))),a(c,0,g.w,"V");break;default:a(c,1,0,"")}}}a(c,-1,0,"EOD");var b=`\r
`,T=c.join(b);return T}})();return{to_workbook:r,to_sheet:t,from_sheet:i}})(),bG=(function(){function n(g){return g.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(g){return g.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(g,m){for(var y=g.split(`
`),_=-1,x=-1,w=0,b=[];w!==y.length;++w){var T=y[w].trim().split(":");if(T[0]==="cell"){var k=ki(T[1]);if(b.length<=k.r)for(_=b.length;_<=k.r;++_)b[_]||(b[_]=[]);switch(_=k.r,x=k.c,T[2]){case"t":b[_][x]=n(T[3]);break;case"v":b[_][x]=+T[3];break;case"vtf":var L=T[T.length-1];case"vtc":switch(T[3]){case"nl":b[_][x]=!!+T[4];break;default:b[_][x]=+T[4];break}T[2]=="vtf"&&(b[_][x]=[b[_][x],L])}}}return m&&m.sheetRows&&(b=b.slice(0,m.sheetRows)),b}function r(g,m){return wg(t(g,m),m)}function i(g,m){return Bd(r(g,m),m)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(g){if(!g||!g["!ref"])return"";for(var m=[],y=[],_,x="",w=ya(g["!ref"]),b=Array.isArray(g),T=w.s.r;T<=w.e.r;++T)for(var k=w.s.c;k<=w.e.c;++k)if(x=nr({r:T,c:k}),_=b?(g[T]||[])[k]:g[x],!(!_||_.v==null||_.t==="z")){switch(y=["cell",x,"t"],_.t){case"s":case"str":y.push(e(_.v));break;case"n":_.f?(y[2]="vtf",y[3]="n",y[4]=_.v,y[5]=e(_.f)):(y[2]="v",y[3]=_.v);break;case"b":y[2]="vt"+(_.f?"f":"c"),y[3]="nl",y[4]=_.v?"1":"0",y[5]=e(_.f||(_.v?"TRUE":"FALSE"));break;case"d":var L=Hs(Ts(_.v));y[2]="vtc",y[3]="nd",y[4]=""+L,y[5]=_.w||$u(_.z||Gr[14],L);break;case"e":continue}m.push(y.join(":"))}return m.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),m.push("valueformat:1:text-wiki"),m.join(`
`)}function h(g){return[s,a,o,a,c(g),l].join(`
`)}return{to_workbook:i,to_sheet:r,from_sheet:h}})(),L_e=(function(){function n(h,g,m,y,_){_.raw?g[m][y]=h:h===""||(h==="TRUE"?g[m][y]=!0:h==="FALSE"?g[m][y]=!1:isNaN(nc(h))?isNaN(l1(h).getDate())?g[m][y]=h:g[m][y]=Ts(h):g[m][y]=nc(h))}function e(h,g){var m=g||{},y=[];if(!h||h.length===0)return y;for(var _=h.split(/[\r\n]/),x=_.length-1;x>=0&&_[x].length===0;)--x;for(var w=10,b=0,T=0;T<=x;++T)b=_[T].indexOf(" "),b==-1?b=_[T].length:b++,w=Math.max(w,b);for(T=0;T<=x;++T){y[T]=[];var k=0;for(n(_[T].slice(0,w).trim(),y,T,k,m),k=1;k<=(_[T].length-w)/10+1;++k)n(_[T].slice(w+(k-1)*10,w+k*10).trim(),y,T,k,m)}return m.sheetRows&&(y=y.slice(0,m.sheetRows)),y}var t={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function i(h){for(var g={},m=!1,y=0,_=0;y<h.length;++y)(_=h.charCodeAt(y))==34?m=!m:!m&&_ in t&&(g[_]=(g[_]||0)+1);_=[];for(y in g)Object.prototype.hasOwnProperty.call(g,y)&&_.push([g[y],y]);if(!_.length){g=r;for(y in g)Object.prototype.hasOwnProperty.call(g,y)&&_.push([g[y],y])}return _.sort(function(x,w){return x[0]-w[0]||r[x[1]]-r[w[1]]}),t[_.pop()[1]]||44}function s(h,g){var m=g||{},y="",_=m.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};h.slice(0,4)=="sep="?h.charCodeAt(5)==13&&h.charCodeAt(6)==10?(y=h.charAt(4),h=h.slice(7)):h.charCodeAt(5)==13||h.charCodeAt(5)==10?(y=h.charAt(4),h=h.slice(6)):y=i(h.slice(0,1024)):m&&m.FS?y=m.FS:y=i(h.slice(0,1024));var w=0,b=0,T=0,k=0,L=0,O=y.charCodeAt(0),B=!1,R=0,A=h.charCodeAt(0);h=h.replace(/\r\n/mg,`
`);var P=m.dateNF!=null?Yye(m.dateNF):null;function D(){var N=h.slice(k,L),G={};if(N.charAt(0)=='"'&&N.charAt(N.length-1)=='"'&&(N=N.slice(1,-1).replace(/""/g,'"')),N.length===0)G.t="z";else if(m.raw)G.t="s",G.v=N;else if(N.trim().length===0)G.t="s",G.v=N;else if(N.charCodeAt(0)==61)N.charCodeAt(1)==34&&N.charCodeAt(N.length-1)==34?(G.t="s",G.v=N.slice(2,-1).replace(/""/g,'"')):Nve(N)?(G.t="n",G.f=N.slice(1)):(G.t="s",G.v=N);else if(N=="TRUE")G.t="b",G.v=!0;else if(N=="FALSE")G.t="b",G.v=!1;else if(!isNaN(T=nc(N)))G.t="n",m.cellText!==!1&&(G.w=N),G.v=T;else if(!isNaN(l1(N).getDate())||P&&N.match(P)){G.z=m.dateNF||Gr[14];var j=0;P&&N.match(P)&&(N=Zye(N,m.dateNF,N.match(P)||[]),j=1),m.cellDates?(G.t="d",G.v=Ts(N,j)):(G.t="n",G.v=Hs(Ts(N,j))),m.cellText!==!1&&(G.w=$u(G.z,G.v instanceof Date?Hs(G.v):G.v)),m.cellNF||delete G.z}else G.t="s",G.v=N;if(G.t=="z"||(m.dense?(_[w]||(_[w]=[]),_[w][b]=G):_[nr({c:b,r:w})]=G),k=L+1,A=h.charCodeAt(k),x.e.c<b&&(x.e.c=b),x.e.r<w&&(x.e.r=w),R==O)++b;else if(b=0,++w,m.sheetRows&&m.sheetRows<=w)return!0}e:for(;L<h.length;++L)switch(R=h.charCodeAt(L)){case 34:A===34&&(B=!B);break;case O:case 10:case 13:if(!B&&D())break e;break}return L-k>0&&D(),_["!ref"]=ii(x),_}function a(h,g){return!(g&&g.PRN)||g.FS||h.slice(0,4)=="sep="||h.indexOf("	")>=0||h.indexOf(",")>=0||h.indexOf(";")>=0?s(h,g):wg(e(h,g),g)}function o(h,g){var m="",y=g.type=="string"?[0,0,0,0]:HSe(h,g);switch(g.type){case"base64":m=dc(h);break;case"binary":m=h;break;case"buffer":g.codepage==65001?m=h.toString("utf8"):g.codepage&&typeof nw<"u"||(m=Fn&&Buffer.isBuffer(h)?h.toString("binary"):iy(h));break;case"array":m=VE(h);break;case"string":m=h;break;default:throw new Error("Unrecognized type "+g.type)}return y[0]==239&&y[1]==187&&y[2]==191?m=dp(m.slice(3)):g.type!="string"&&g.type!="buffer"&&g.codepage==65001?m=dp(m):g.type=="binary"&&typeof nw<"u",m.slice(0,19)=="socialcalc:version:"?bG.to_sheet(g.type=="string"?m:dp(m),g):a(m,g)}function l(h,g){return Bd(o(h,g),g)}function c(h){for(var g=[],m=pr(h["!ref"]),y,_=Array.isArray(h),x=m.s.r;x<=m.e.r;++x){for(var w=[],b=m.s.c;b<=m.e.c;++b){var T=nr({r:x,c:b});if(y=_?(h[x]||[])[b]:h[T],!y||y.v==null){w.push("          ");continue}for(var k=(y.w||(fc(y),y.w)||"").slice(0,10);k.length<10;)k+=" ";w.push(k+(b===0?" ":""))}g.push(w.join(""))}return g.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}})(),KO=(function(){function n(V,J,te){if(V){sa(V,V.l||0);for(var re=te.Enum||be;V.l<V.length;){var he=V.read_shift(2),Be=re[he]||re[65535],Ge=V.read_shift(2),ye=V.l+Ge,pe=Be.f&&Be.f(V,Ge,te);if(V.l=ye,J(pe,Be,he))return}}}function e(V,J){switch(J.type){case"base64":return t(ho(dc(V)),J);case"binary":return t(ho(V),J);case"buffer":case"array":return t(V,J)}throw"Unsupported type "+J.type}function t(V,J){if(!V)return V;var te=J||{},re=te.dense?[]:{},he="Sheet1",Be="",Ge=0,ye={},pe=[],Et=[],Ve={s:{r:0,c:0},e:{r:0,c:0}},jt=te.sheetRows||0;if(V[2]==0&&(V[3]==8||V[3]==9)&&V.length>=16&&V[14]==5&&V[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(V[2]==2)te.Enum=be,n(V,function(tt,kn,ln){switch(ln){case 0:te.vers=tt,tt>=4096&&(te.qpro=!0);break;case 6:Ve=tt;break;case 204:tt&&(Be=tt);break;case 222:Be=tt;break;case 15:case 51:te.qpro||(tt[1].v=tt[1].v.slice(1));case 13:case 14:case 16:ln==14&&(tt[2]&112)==112&&(tt[2]&15)>1&&(tt[2]&15)<15&&(tt[1].z=te.dateNF||Gr[14],te.cellDates&&(tt[1].t="d",tt[1].v=GB(tt[1].v))),te.qpro&&tt[3]>Ge&&(re["!ref"]=ii(Ve),ye[he]=re,pe.push(he),re=te.dense?[]:{},Ve={s:{r:0,c:0},e:{r:0,c:0}},Ge=tt[3],he=Be||"Sheet"+(Ge+1),Be="");var hn=te.dense?(re[tt[0].r]||[])[tt[0].c]:re[nr(tt[0])];if(hn){hn.t=tt[1].t,hn.v=tt[1].v,tt[1].z!=null&&(hn.z=tt[1].z),tt[1].f!=null&&(hn.f=tt[1].f);break}te.dense?(re[tt[0].r]||(re[tt[0].r]=[]),re[tt[0].r][tt[0].c]=tt[1]):re[nr(tt[0])]=tt[1];break}},te);else if(V[2]==26||V[2]==14)te.Enum=ie,V[2]==14&&(te.qpro=!0,V.l=0),n(V,function(tt,kn,ln){switch(ln){case 204:he=tt;break;case 22:tt[1].v=tt[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(tt[3]>Ge&&(re["!ref"]=ii(Ve),ye[he]=re,pe.push(he),re=te.dense?[]:{},Ve={s:{r:0,c:0},e:{r:0,c:0}},Ge=tt[3],he="Sheet"+(Ge+1)),jt>0&&tt[0].r>=jt)break;te.dense?(re[tt[0].r]||(re[tt[0].r]=[]),re[tt[0].r][tt[0].c]=tt[1]):re[nr(tt[0])]=tt[1],Ve.e.c<tt[0].c&&(Ve.e.c=tt[0].c),Ve.e.r<tt[0].r&&(Ve.e.r=tt[0].r);break;case 27:tt[14e3]&&(Et[tt[14e3][0]]=tt[14e3][1]);break;case 1537:Et[tt[0]]=tt[1],tt[0]==Ge&&(he=tt[1]);break}},te);else throw new Error("Unrecognized LOTUS BOF "+V[2]);if(re["!ref"]=ii(Ve),ye[Be||he]=re,pe.push(Be||he),!Et.length)return{SheetNames:pe,Sheets:ye};for(var St={},Ut=[],Ht=0;Ht<Et.length;++Ht)ye[pe[Ht]]?(Ut.push(Et[Ht]||pe[Ht]),St[Et[Ht]]=ye[Et[Ht]]||ye[pe[Ht]]):(Ut.push(Et[Ht]),St[Et[Ht]]={"!ref":"A1"});return{SheetNames:Ut,Sheets:St}}function r(V,J){var te=J||{};if(+te.codepage>=0&&a1(+te.codepage),te.type=="string")throw new Error("Cannot write WK1 to JS string");var re=Gs(),he=pr(V["!ref"]),Be=Array.isArray(V),Ge=[];ot(re,0,s(1030)),ot(re,6,l(he));for(var ye=Math.min(he.e.r,8191),pe=he.s.r;pe<=ye;++pe)for(var Et=Ki(pe),Ve=he.s.c;Ve<=he.e.c;++Ve){pe===he.s.r&&(Ge[Ve]=gs(Ve));var jt=Ge[Ve]+Et,St=Be?(V[pe]||[])[Ve]:V[jt];if(!(!St||St.t=="z"))if(St.t=="n")(St.v|0)==St.v&&St.v>=-32768&&St.v<=32767?ot(re,13,y(pe,Ve,St.v)):ot(re,14,x(pe,Ve,St.v));else{var Ut=fc(St);ot(re,15,g(pe,Ve,Ut.slice(0,239)))}}return ot(re,1),re.end()}function i(V,J){var te=J||{};if(+te.codepage>=0&&a1(+te.codepage),te.type=="string")throw new Error("Cannot write WK3 to JS string");var re=Gs();ot(re,0,a(V));for(var he=0,Be=0;he<V.SheetNames.length;++he)(V.Sheets[V.SheetNames[he]]||{})["!ref"]&&ot(re,27,Ne(V.SheetNames[he],Be++));var Ge=0;for(he=0;he<V.SheetNames.length;++he){var ye=V.Sheets[V.SheetNames[he]];if(!(!ye||!ye["!ref"])){for(var pe=pr(ye["!ref"]),Et=Array.isArray(ye),Ve=[],jt=Math.min(pe.e.r,8191),St=pe.s.r;St<=jt;++St)for(var Ut=Ki(St),Ht=pe.s.c;Ht<=pe.e.c;++Ht){St===pe.s.r&&(Ve[Ht]=gs(Ht));var tt=Ve[Ht]+Ut,kn=Et?(ye[St]||[])[Ht]:ye[tt];if(!(!kn||kn.t=="z"))if(kn.t=="n")ot(re,23,D(St,Ht,Ge,kn.v));else{var ln=fc(kn);ot(re,22,R(St,Ht,Ge,ln.slice(0,239)))}}++Ge}}return ot(re,1),re.end()}function s(V){var J=Le(2);return J.write_shift(2,V),J}function a(V){var J=Le(26);J.write_shift(2,4096),J.write_shift(2,4),J.write_shift(4,0);for(var te=0,re=0,he=0,Be=0;Be<V.SheetNames.length;++Be){var Ge=V.SheetNames[Be],ye=V.Sheets[Ge];if(!(!ye||!ye["!ref"])){++he;var pe=ya(ye["!ref"]);te<pe.e.r&&(te=pe.e.r),re<pe.e.c&&(re=pe.e.c)}}return te>8191&&(te=8191),J.write_shift(2,te),J.write_shift(1,he),J.write_shift(1,re),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(1,1),J.write_shift(1,2),J.write_shift(4,0),J.write_shift(4,0),J}function o(V,J,te){var re={s:{c:0,r:0},e:{c:0,r:0}};return J==8&&te.qpro?(re.s.c=V.read_shift(1),V.l++,re.s.r=V.read_shift(2),re.e.c=V.read_shift(1),V.l++,re.e.r=V.read_shift(2),re):(re.s.c=V.read_shift(2),re.s.r=V.read_shift(2),J==12&&te.qpro&&(V.l+=2),re.e.c=V.read_shift(2),re.e.r=V.read_shift(2),J==12&&te.qpro&&(V.l+=2),re.s.c==65535&&(re.s.c=re.e.c=re.s.r=re.e.r=0),re)}function l(V){var J=Le(8);return J.write_shift(2,V.s.c),J.write_shift(2,V.s.r),J.write_shift(2,V.e.c),J.write_shift(2,V.e.r),J}function c(V,J,te){var re=[{c:0,r:0},{t:"n",v:0},0,0];return te.qpro&&te.vers!=20768?(re[0].c=V.read_shift(1),re[3]=V.read_shift(1),re[0].r=V.read_shift(2),V.l+=2):(re[2]=V.read_shift(1),re[0].c=V.read_shift(2),re[0].r=V.read_shift(2)),re}function h(V,J,te){var re=V.l+J,he=c(V,J,te);if(he[1].t="s",te.vers==20768){V.l++;var Be=V.read_shift(1);return he[1].v=V.read_shift(Be,"utf8"),he}return te.qpro&&V.l++,he[1].v=V.read_shift(re-V.l,"cstr"),he}function g(V,J,te){var re=Le(7+te.length);re.write_shift(1,255),re.write_shift(2,J),re.write_shift(2,V),re.write_shift(1,39);for(var he=0;he<re.length;++he){var Be=te.charCodeAt(he);re.write_shift(1,Be>=128?95:Be)}return re.write_shift(1,0),re}function m(V,J,te){var re=c(V,J,te);return re[1].v=V.read_shift(2,"i"),re}function y(V,J,te){var re=Le(7);return re.write_shift(1,255),re.write_shift(2,J),re.write_shift(2,V),re.write_shift(2,te,"i"),re}function _(V,J,te){var re=c(V,J,te);return re[1].v=V.read_shift(8,"f"),re}function x(V,J,te){var re=Le(13);return re.write_shift(1,255),re.write_shift(2,J),re.write_shift(2,V),re.write_shift(8,te,"f"),re}function w(V,J,te){var re=V.l+J,he=c(V,J,te);if(he[1].v=V.read_shift(8,"f"),te.qpro)V.l=re;else{var Be=V.read_shift(2);L(V.slice(V.l,V.l+Be),he),V.l+=Be}return he}function b(V,J,te){var re=J&32768;return J&=-32769,J=(re?V:0)+(J>=8192?J-16384:J),(re?"":"$")+(te?gs(J):Ki(J))}var T={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},k=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function L(V,J){sa(V,0);for(var te=[],re=0,he="",Be="",Ge="",ye="";V.l<V.length;){var pe=V[V.l++];switch(pe){case 0:te.push(V.read_shift(8,"f"));break;case 1:Be=b(J[0].c,V.read_shift(2),!0),he=b(J[0].r,V.read_shift(2),!1),te.push(Be+he);break;case 2:{var Et=b(J[0].c,V.read_shift(2),!0),Ve=b(J[0].r,V.read_shift(2),!1);Be=b(J[0].c,V.read_shift(2),!0),he=b(J[0].r,V.read_shift(2),!1),te.push(Et+Ve+":"+Be+he)}break;case 3:if(V.l<V.length){console.error("WK1 premature formula end");return}break;case 4:te.push("("+te.pop()+")");break;case 5:te.push(V.read_shift(2));break;case 6:{for(var jt="";pe=V[V.l++];)jt+=String.fromCharCode(pe);te.push('"'+jt.replace(/"/g,'""')+'"')}break;case 8:te.push("-"+te.pop());break;case 23:te.push("+"+te.pop());break;case 22:te.push("NOT("+te.pop()+")");break;case 20:case 21:ye=te.pop(),Ge=te.pop(),te.push(["AND","OR"][pe-20]+"("+Ge+","+ye+")");break;default:if(pe<32&&k[pe])ye=te.pop(),Ge=te.pop(),te.push(Ge+k[pe]+ye);else if(T[pe]){if(re=T[pe][1],re==69&&(re=V[V.l++]),re>te.length){console.error("WK1 bad formula parse 0x"+pe.toString(16)+":|"+te.join("|")+"|");return}var St=te.slice(-re);te.length-=re,te.push(T[pe][0]+"("+St.join(",")+")")}else return pe<=7?console.error("WK1 invalid opcode "+pe.toString(16)):pe<=24?console.error("WK1 unsupported op "+pe.toString(16)):pe<=30?console.error("WK1 invalid opcode "+pe.toString(16)):pe<=115?console.error("WK1 unsupported function opcode "+pe.toString(16)):console.error("WK1 unrecognized opcode "+pe.toString(16))}}te.length==1?J[1].f=""+te[0]:console.error("WK1 bad formula parse |"+te.join("|")+"|")}function O(V){var J=[{c:0,r:0},{t:"n",v:0},0];return J[0].r=V.read_shift(2),J[3]=V[V.l++],J[0].c=V[V.l++],J}function B(V,J){var te=O(V);return te[1].t="s",te[1].v=V.read_shift(J-4,"cstr"),te}function R(V,J,te,re){var he=Le(6+re.length);he.write_shift(2,V),he.write_shift(1,te),he.write_shift(1,J),he.write_shift(1,39);for(var Be=0;Be<re.length;++Be){var Ge=re.charCodeAt(Be);he.write_shift(1,Ge>=128?95:Ge)}return he.write_shift(1,0),he}function A(V,J){var te=O(V);te[1].v=V.read_shift(2);var re=te[1].v>>1;if(te[1].v&1)switch(re&7){case 0:re=(re>>3)*5e3;break;case 1:re=(re>>3)*500;break;case 2:re=(re>>3)/20;break;case 3:re=(re>>3)/200;break;case 4:re=(re>>3)/2e3;break;case 5:re=(re>>3)/2e4;break;case 6:re=(re>>3)/16;break;case 7:re=(re>>3)/64;break}return te[1].v=re,te}function P(V,J){var te=O(V),re=V.read_shift(4),he=V.read_shift(4),Be=V.read_shift(2);if(Be==65535)return re===0&&he===3221225472?(te[1].t="e",te[1].v=15):re===0&&he===3489660928?(te[1].t="e",te[1].v=42):te[1].v=0,te;var Ge=Be&32768;return Be=(Be&32767)-16446,te[1].v=(1-Ge*2)*(he*Math.pow(2,Be+32)+re*Math.pow(2,Be)),te}function D(V,J,te,re){var he=Le(14);if(he.write_shift(2,V),he.write_shift(1,te),he.write_shift(1,J),re==0)return he.write_shift(4,0),he.write_shift(4,0),he.write_shift(2,65535),he;var Be=0,Ge=0,ye=0,pe=0;return re<0&&(Be=1,re=-re),Ge=Math.log2(re)|0,re/=Math.pow(2,Ge-31),pe=re>>>0,(pe&2147483648)==0&&(re/=2,++Ge,pe=re>>>0),re-=pe,pe|=2147483648,pe>>>=0,re*=Math.pow(2,32),ye=re>>>0,he.write_shift(4,ye),he.write_shift(4,pe),Ge+=16383+(Be?32768:0),he.write_shift(2,Ge),he}function N(V,J){var te=P(V);return V.l+=J-14,te}function G(V,J){var te=O(V),re=V.read_shift(4);return te[1].v=re>>6,te}function j(V,J){var te=O(V),re=V.read_shift(8,"f");return te[1].v=re,te}function ve(V,J){var te=j(V);return V.l+=J-10,te}function ce(V,J){return V[V.l+J-1]==0?V.read_shift(J,"cstr"):""}function je(V,J){var te=V[V.l++];te>J-1&&(te=J-1);for(var re="";re.length<te;)re+=String.fromCharCode(V[V.l++]);return re}function Pe(V,J,te){if(!(!te.qpro||J<21)){var re=V.read_shift(1);V.l+=17,V.l+=1,V.l+=2;var he=V.read_shift(J-21,"cstr");return[re,he]}}function ue(V,J){for(var te={},re=V.l+J;V.l<re;){var he=V.read_shift(2);if(he==14e3){for(te[he]=[0,""],te[he][0]=V.read_shift(2);V[V.l];)te[he][1]+=String.fromCharCode(V[V.l]),V.l++;V.l++}}return te}function Ne(V,J){var te=Le(5+V.length);te.write_shift(2,14e3),te.write_shift(2,J);for(var re=0;re<V.length;++re){var he=V.charCodeAt(re);te[te.l++]=he>127?95:he}return te[te.l++]=0,te}var be={0:{n:"BOF",f:_G},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:m},14:{n:"NUMBER",f:_},15:{n:"LABEL",f:h},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:h},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ce},222:{n:"SHEETNAMELP",f:je},65535:{n:""}},ie={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:B},23:{n:"NUMBER17",f:P},24:{n:"NUMBER18",f:A},25:{n:"FORMULA19",f:N},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ue},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:G},38:{n:"??"},39:{n:"NUMBER27",f:j},40:{n:"FORMULA28",f:ve},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ce},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Pe},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:i,to_workbook:e}})(),O_e=/^\s|\s$|[\t\n\r]/;function TG(n,e){if(!e.bookSST)return"";var t=[ai];t[t.length]=at("sst",null,{xmlns:vg[0],count:n.Count,uniqueCount:n.Unique});for(var r=0;r!=n.length;++r)if(n[r]!=null){var i=n[r],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(O_e)&&(s+=' xml:space="preserve"'),s+=">"+er(i.t)+"</t>"),s+="</si>",t[t.length]=s}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function D_e(n){return[n.read_shift(4),n.read_shift(4)]}function j_e(n,e){return e||(e=Le(8)),e.write_shift(4,n.Count),e.write_shift(4,n.Unique),e}var F_e=kxe;function V_e(n){var e=Gs();We(e,159,j_e(n));for(var t=0;t<n.length;++t)We(e,19,F_e(n[t]));return We(e,160),e.end()}function B_e(n){for(var e=[],t=n.split(""),r=0;r<t.length;++r)e[r]=t[r].charCodeAt(0);return e}function RG(n){var e=0,t,r=B_e(n),i=r.length+1,s,a,o,l,c;for(t=Td(i),t[0]=r.length,s=1;s!=i;++s)t[s]=r[s-1];for(s=i-1;s>=0;--s)a=t[s],o=(e&16384)===0?0:1,l=e<<1&32767,c=o|l,e=c^a;return e^52811}var G_e=(function(){function n(i,s){switch(s.type){case"base64":return e(dc(i),s);case"binary":return e(i,s);case"buffer":return e(Fn&&Buffer.isBuffer(i)?i.toString("binary"):iy(i),s);case"array":return e(VE(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var a=s||{},o=a.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(h,g){Array.isArray(o)&&(o[g]=[]);for(var m=/\\\w+\b/g,y=0,_,x=-1;_=m.exec(h);){switch(_[0]){case"\\cell":var w=h.slice(y,m.lastIndex-_[0].length);if(w[0]==" "&&(w=w.slice(1)),++x,w.length){var b={v:w,t:"s"};Array.isArray(o)?o[g][x]=b:o[nr({r:g,c:x})]=b}break}y=m.lastIndex}x>c.e.c&&(c.e.c=x)}),o["!ref"]=ii(c),o}function t(i,s){return Bd(n(i,s),s)}function r(i){for(var s=["{\\rtf1\\ansi"],a=pr(i["!ref"]),o,l=Array.isArray(i),c=a.s.r;c<=a.e.r;++c){s.push("\\trowd\\trautofit1");for(var h=a.s.c;h<=a.e.c;++h)s.push("\\cellx"+(h+1));for(s.push("\\pard\\intbl"),h=a.s.c;h<=a.e.c;++h){var g=nr({r:c,c:h});o=l?(i[c]||[])[h]:i[g],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(fc(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:t,to_sheet:n,from_sheet:r}})();function XO(n){for(var e=0,t=1;e!=3;++e)t=t*256+(n[e]>255?255:n[e]<0?0:n[e]);return t.toString(16).toUpperCase().slice(1)}var z_e=6,rc=z_e;function hw(n){return Math.floor((n+Math.round(128/rc)/256)*rc)}function dw(n){return Math.floor((n-5)/rc*100+.5)/100}function HR(n){return Math.round((n*rc+5)/rc*256)/256}function vC(n){n.width?(n.wpx=hw(n.width),n.wch=dw(n.wpx),n.MDW=rc):n.wpx?(n.wch=dw(n.wpx),n.width=HR(n.wch),n.MDW=rc):typeof n.wch=="number"&&(n.width=HR(n.wch),n.wpx=hw(n.width),n.MDW=rc),n.customWidth&&delete n.customWidth}var U_e=96,AG=U_e;function fw(n){return n*96/AG}function kG(n){return n*AG/96}function $_e(n){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var r=t[0];r<=t[1];++r)n[r]!=null&&(e[e.length]=at("numFmt",null,{numFmtId:r,formatCode:er(n[r])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=at("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function W_e(n){var e=[];return e[e.length]=at("cellXfs",null),n.forEach(function(t){e[e.length]=at("xf",null,t)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=at("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function IG(n,e){var t=[ai,at("styleSheet",null,{xmlns:vg[0],"xmlns:vt":Ri.vt})],r;return n.SSF&&(r=$_e(n.SSF))!=null&&(t[t.length]=r),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(r=W_e(e.cellXfs))&&(t[t.length]=r),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function H_e(n,e){var t=n.read_shift(2),r=ms(n);return[t,r]}function K_e(n,e,t){t||(t=Le(6+4*e.length)),t.write_shift(2,n),Ii(e,t);var r=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),r}function X_e(n,e,t){var r={};r.sz=n.read_shift(2)/20;var i=Oxe(n);i.fItalic&&(r.italic=1),i.fCondense&&(r.condense=1),i.fExtend&&(r.extend=1),i.fShadow&&(r.shadow=1),i.fOutline&&(r.outline=1),i.fStrikeout&&(r.strike=1);var s=n.read_shift(2);switch(s===700&&(r.bold=1),n.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var a=n.read_shift(1);a!=0&&(r.underline=a);var o=n.read_shift(1);o>0&&(r.family=o);var l=n.read_shift(1);switch(l>0&&(r.charset=l),n.l++,r.color=Lxe(n),n.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=ms(n),r}function q_e(n,e){e||(e=Le(153)),e.write_shift(2,n.sz*20),Dxe(n,e),e.write_shift(2,n.bold?700:400);var t=0;n.vertAlign=="superscript"?t=1:n.vertAlign=="subscript"&&(t=2),e.write_shift(2,t),e.write_shift(1,n.underline||0),e.write_shift(1,n.family||0),e.write_shift(1,n.charset||0),e.write_shift(1,0),cw(n.color,e);var r=0;return r=2,e.write_shift(1,r),Ii(n.name,e),e.length>e.l?e.slice(0,e.l):e}var Y_e=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],zb,Z_e=ml;function qO(n,e){e||(e=Le(84)),zb||(zb=lC(Y_e));var t=zb[n.patternType];t==null&&(t=40),e.write_shift(4,t);var r=0;if(t!=40)for(cw({auto:1},e),cw({auto:1},e);r<12;++r)e.write_shift(4,0);else{for(;r<4;++r)e.write_shift(4,0);for(;r<12;++r)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function J_e(n,e){var t=n.l+e,r=n.read_shift(2),i=n.read_shift(2);return n.l=t,{ixfe:r,numFmtId:i}}function CG(n,e,t){t||(t=Le(16)),t.write_shift(2,e||0),t.write_shift(2,n.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var r=0;return t.write_shift(1,r),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function wm(n,e){return e||(e=Le(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var Q_e=ml;function eve(n,e){return e||(e=Le(51)),e.write_shift(1,0),wm(null,e),wm(null,e),wm(null,e),wm(null,e),wm(null,e),e.length>e.l?e.slice(0,e.l):e}function tve(n,e){return e||(e=Le(52)),e.write_shift(4,n.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),lw(n.name||"",e),e.length>e.l?e.slice(0,e.l):e}function nve(n,e,t){var r=Le(2052);return r.write_shift(4,n),lw(e,r),lw(t,r),r.length>r.l?r.slice(0,r.l):r}function rve(n,e){if(e){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)e[i]!=null&&++t}),t!=0&&(We(n,615,vo(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)e[i]!=null&&We(n,44,K_e(i,e[i]))}),We(n,616))}}function ive(n){var e=1;We(n,611,vo(e)),We(n,43,q_e({sz:12,color:{theme:1},name:"Calibri",family:2})),We(n,612)}function sve(n){var e=2;We(n,603,vo(e)),We(n,45,qO({patternType:"none"})),We(n,45,qO({patternType:"gray125"})),We(n,604)}function ave(n){var e=1;We(n,613,vo(e)),We(n,46,eve()),We(n,614)}function ove(n){var e=1;We(n,626,vo(e)),We(n,47,CG({numFmtId:0},65535)),We(n,627)}function lve(n,e){We(n,617,vo(e.length)),e.forEach(function(t){We(n,47,CG(t,0))}),We(n,618)}function cve(n){var e=1;We(n,619,vo(e)),We(n,48,tve({xfId:0,name:"Normal"})),We(n,620)}function uve(n){var e=0;We(n,505,vo(e)),We(n,506)}function hve(n){var e=0;We(n,508,nve(e,"TableStyleMedium9","PivotStyleMedium4")),We(n,509)}function dve(n,e){var t=Gs();return We(t,278),rve(t,n.SSF),ive(t),sve(t),ave(t),ove(t),lve(t,e.cellXfs),cve(t),uve(t),hve(t),We(t,279),t.end()}function PG(n,e){if(e&&e.themeXLSX)return e.themeXLSX;if(n&&typeof n.raw=="string")return n.raw;var t=[ai];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function fve(n,e){return{flags:n.read_shift(4),version:n.read_shift(4),name:ms(n)}}function gve(n){var e=Le(12+2*n.name.length);return e.write_shift(4,n.flags),e.write_shift(4,n.version),Ii(n.name,e),e.slice(0,e.l)}function mve(n){for(var e=[],t=n.read_shift(4);t-- >0;)e.push([n.read_shift(4),n.read_shift(4)]);return e}function pve(n){var e=Le(4+8*n.length);e.write_shift(4,n.length);for(var t=0;t<n.length;++t)e.write_shift(4,n[t][0]),e.write_shift(4,n[t][1]);return e}function yve(n,e){var t=Le(8+2*e.length);return t.write_shift(4,n),Ii(e,t),t.slice(0,t.l)}function xve(n){return n.l+=4,n.read_shift(4)!=0}function _ve(n,e){var t=Le(8);return t.write_shift(4,n),t.write_shift(4,1),t}function vve(){var n=Gs();return We(n,332),We(n,334,vo(1)),We(n,335,gve({name:"XLDAPR",version:12e4,flags:3496657072})),We(n,336),We(n,339,yve(1,"XLDAPR")),We(n,52),We(n,35,vo(514)),We(n,4096,vo(0)),We(n,4097,Pa(1)),We(n,36),We(n,53),We(n,340),We(n,337,_ve(1)),We(n,51,pve([[1,0]])),We(n,338),We(n,333),n.end()}function NG(){var n=[ai];return n.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),n.join("")}function wve(n){var e={};e.i=n.read_shift(4);var t={};t.r=n.read_shift(4),t.c=n.read_shift(4),e.r=nr(t);var r=n.read_shift(1);return r&2&&(e.l="1"),r&8&&(e.a="1"),e}var h0=1024;function MG(n,e){for(var t=[21600,21600],r=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),i=[at("xml",null,{"xmlns:v":oa.v,"xmlns:o":oa.o,"xmlns:x":oa.x,"xmlns:mv":oa.mv}).replace(/\/>/,">"),at("o:shapelayout",at("o:idmap",null,{"v:ext":"edit",data:n}),{"v:ext":"edit"}),at("v:shapetype",[at("v:stroke",null,{joinstyle:"miter"}),at("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:r})];h0<n*1e3;)h0+=1e3;return e.forEach(function(s){var a=ki(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?at("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=at("v:fill",l,o),h={on:"t",obscured:"t"};++h0,i=i.concat(["<v:shape"+u1({id:"_x0000_s"+h0,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,at("v:shadow",null,h),at("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Wi("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),Wi("x:AutoFill","False"),Wi("x:Row",String(a.r)),Wi("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function LG(n){var e=[ai,at("comments",null,{xmlns:vg[0]})],t=[];return e.push("<authors>"),n.forEach(function(r){r[1].forEach(function(i){var s=er(i.a);t.indexOf(s)==-1&&(t.push(s),e.push("<author>"+s+"</author>")),i.T&&i.ID&&t.indexOf("tc="+i.ID)==-1&&(t.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),n.forEach(function(r){var i=0,s=[];if(r[1][0]&&r[1][0].T&&r[1][0].ID?i=t.indexOf("tc="+r[1][0].ID):r[1].forEach(function(l){l.a&&(i=t.indexOf(er(l.a))),s.push(l.t||"")}),e.push('<comment ref="'+r[0]+'" authorId="'+i+'"><text>'),s.length<=1)e.push(Wi("t",er(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)a+=`Reply:
    `+s[o]+`
`;e.push(Wi("t",er(a)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function Eve(n,e,t){var r=[ai,at("ThreadedComments",null,{xmlns:Ri.TCMNT}).replace(/[\/]>/,">")];return n.forEach(function(i){var s="";(i[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&e.indexOf(a.a)==-1&&e.push(a.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};o==0?s=l.id:l.parentId=s,a.ID=l.id,a.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(a.a)).slice(-12)+"}"),r.push(at("threadedComment",Wi("text",a.t||""),l))})}),r.push("</ThreadedComments>"),r.join("")}function Sve(n){var e=[ai,at("personList",null,{xmlns:Ri.TCMNT,"xmlns:x":vg[0]}).replace(/[\/]>/,">")];return n.forEach(function(t,r){e.push(at("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+r).slice(-12)+"}",userId:t,providerId:"None"}))}),e.push("</personList>"),e.join("")}function bve(n){var e={};e.iauthor=n.read_shift(4);var t=$d(n);return e.rfx=t.s,e.ref=nr(t.s),n.l+=16,e}function Tve(n,e){return e==null&&(e=Le(36)),e.write_shift(4,n[1].iauthor),Eg(n[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var Rve=ms;function Ave(n){return Ii(n.slice(0,54))}function kve(n){var e=Gs(),t=[];return We(e,628),We(e,630),n.forEach(function(r){r[1].forEach(function(i){t.indexOf(i.a)>-1||(t.push(i.a.slice(0,54)),We(e,632,Ave(i.a)))})}),We(e,631),We(e,633),n.forEach(function(r){r[1].forEach(function(i){i.iauthor=t.indexOf(i.a);var s={s:ki(r[0]),e:ki(r[0])};We(e,635,Tve([s,i])),i.t&&i.t.length>0&&We(e,637,Cxe(i)),We(e,636),delete i.iauthor})}),We(e,634),We(e,629),e.end()}function Ive(n,e){e.FullPaths.forEach(function(t,r){if(r!=0){var i=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&rr.utils.cfb_add(n,i,e.FileIndex[r].content)}})}var OG=["xlsb","xlsm","xlam","biff8","xla"],Cve=(function(){var n=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function t(r,i,s,a){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,h=a.length>0?parseInt(a,10)|0:0;return o?h+=e.c:--h,l?c+=e.r:--c,i+(o?"":"$")+gs(h)+(l?"":"$")+Ki(c)}return function(i,s){return e=s,i.replace(n,t)}})(),wC=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,EC=(function(){return function(e,t){return e.replace(wC,function(r,i,s,a,o,l){var c=mC(a)-(s?0:t.c),h=gC(l)-(o?0:t.r),g=h==0?"":o?h+1:"["+h+"]",m=c==0?"":s?c+1:"["+c+"]";return i+"R"+g+"C"+m})}})();function Pve(n,e){return n.replace(wC,function(t,r,i,s,a,o){return r+(i=="$"?i+s:gs(mC(s)+e.c))+(a=="$"?a+o:Ki(gC(o)+e.r))})}function Nve(n){return n.length!=1}function Zr(n){n.l+=1}function Wu(n,e){var t=n.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function DG(n,e,t){var r=2;if(t){if(t.biff>=2&&t.biff<=5)return jG(n);t.biff==12&&(r=4)}var i=n.read_shift(r),s=n.read_shift(r),a=Wu(n),o=Wu(n);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function jG(n){var e=Wu(n),t=Wu(n),r=n.read_shift(1),i=n.read_shift(1);return{s:{r:e[0],c:r,cRel:e[1],rRel:e[2]},e:{r:t[0],c:i,cRel:t[1],rRel:t[2]}}}function Mve(n,e,t){if(t.biff<8)return jG(n);var r=n.read_shift(t.biff==12?4:2),i=n.read_shift(t.biff==12?4:2),s=Wu(n),a=Wu(n);return{s:{r,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function FG(n,e,t){if(t&&t.biff>=2&&t.biff<=5)return Lve(n);var r=n.read_shift(t&&t.biff==12?4:2),i=Wu(n);return{r,c:i[0],cRel:i[1],rRel:i[2]}}function Lve(n){var e=Wu(n),t=n.read_shift(1);return{r:e[0],c:t,cRel:e[1],rRel:e[2]}}function Ove(n){var e=n.read_shift(2),t=n.read_shift(2);return{r:e,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function Dve(n,e,t){var r=t&&t.biff?t.biff:8;if(r>=2&&r<=5)return jve(n);var i=n.read_shift(r>=12?4:2),s=n.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function jve(n){var e=n.read_shift(2),t=n.read_shift(1),r=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,r==1&&e>=8192&&(e=e-16384),i==1&&t>=128&&(t=t-256),{r:e,c:t,cRel:i,rRel:r}}function Fve(n,e,t){var r=(n[n.l++]&96)>>5,i=DG(n,t.biff>=2&&t.biff<=5?6:8,t);return[r,i]}function Vve(n,e,t){var r=(n[n.l++]&96)>>5,i=n.read_shift(2,"i"),s=8;if(t)switch(t.biff){case 5:n.l+=12,s=6;break;case 12:s=12;break}var a=DG(n,s,t);return[r,i,a]}function Bve(n,e,t){var r=(n[n.l++]&96)>>5;return n.l+=t&&t.biff>8?12:t.biff<8?6:8,[r]}function Gve(n,e,t){var r=(n[n.l++]&96)>>5,i=n.read_shift(2),s=8;if(t)switch(t.biff){case 5:n.l+=12,s=6;break;case 12:s=12;break}return n.l+=s,[r,i]}function zve(n,e,t){var r=(n[n.l++]&96)>>5,i=Mve(n,e-1,t);return[r,i]}function Uve(n,e,t){var r=(n[n.l++]&96)>>5;return n.l+=t.biff==2?6:t.biff==12?14:7,[r]}function YO(n){var e=n[n.l+1]&1,t=1;return n.l+=4,[e,t]}function $ve(n,e,t){n.l+=2;for(var r=n.read_shift(t&&t.biff==2?1:2),i=[],s=0;s<=r;++s)i.push(n.read_shift(t&&t.biff==2?1:2));return i}function Wve(n,e,t){var r=n[n.l+1]&255?1:0;return n.l+=2,[r,n.read_shift(t&&t.biff==2?1:2)]}function Hve(n,e,t){var r=n[n.l+1]&255?1:0;return n.l+=2,[r,n.read_shift(t&&t.biff==2?1:2)]}function Kve(n){var e=n[n.l+1]&255?1:0;return n.l+=2,[e,n.read_shift(2)]}function Xve(n,e,t){var r=n[n.l+1]&255?1:0;return n.l+=t&&t.biff==2?3:4,[r]}function VG(n){var e=n.read_shift(1),t=n.read_shift(1);return[e,t]}function qve(n){return n.read_shift(2),VG(n)}function Yve(n){return n.read_shift(2),VG(n)}function Zve(n,e,t){var r=(n[n.l]&96)>>5;n.l+=1;var i=FG(n,0,t);return[r,i]}function Jve(n,e,t){var r=(n[n.l]&96)>>5;n.l+=1;var i=Dve(n,0,t);return[r,i]}function Qve(n,e,t){var r=(n[n.l]&96)>>5;n.l+=1;var i=n.read_shift(2);t&&t.biff==5&&(n.l+=12);var s=FG(n,0,t);return[r,i,s]}function ewe(n,e,t){var r=(n[n.l]&96)>>5;n.l+=1;var i=n.read_shift(t&&t.biff<=3?1:2);return[eEe[i],zG[i],r]}function twe(n,e,t){var r=n[n.l++],i=n.read_shift(1),s=t&&t.biff<=3?[r==88?-1:0,n.read_shift(1)]:nwe(n);return[i,(s[0]===0?zG:Qwe)[s[1]]]}function nwe(n){return[n[n.l+1]>>7,n.read_shift(2)&32767]}function rwe(n,e,t){n.l+=t&&t.biff==2?3:4}function iwe(n,e,t){if(n.l++,t&&t.biff==12)return[n.read_shift(4,"i"),0];var r=n.read_shift(2),i=n.read_shift(t&&t.biff==2?1:2);return[r,i]}function swe(n){return n.l++,oy[n.read_shift(1)]}function awe(n){return n.l++,n.read_shift(2)}function owe(n){return n.l++,n.read_shift(1)!==0}function lwe(n){return n.l++,Sg(n)}function cwe(n,e,t){return n.l++,wG(n,e-1,t)}function uwe(n,e){var t=[n.read_shift(1)];if(e==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=Qxe(n,1)?"TRUE":"FALSE",e!=12&&(n.l+=7);break;case 37:case 16:t[1]=oy[n[n.l]],n.l+=e==12?4:8;break;case 0:n.l+=8;break;case 1:t[1]=Sg(n);break;case 2:t[1]=r_e(n,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function hwe(n,e,t){for(var r=n.read_shift(t.biff==12?4:2),i=[],s=0;s!=r;++s)i.push((t.biff==12?$d:a_e)(n));return i}function dwe(n,e,t){var r=0,i=0;t.biff==12?(r=n.read_shift(4),i=n.read_shift(4)):(i=1+n.read_shift(1),r=1+n.read_shift(2)),t.biff>=2&&t.biff<8&&(--r,--i==0&&(i=256));for(var s=0,a=[];s!=r&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=uwe(n,t.biff);return a}function fwe(n,e,t){var r=n.read_shift(1)>>>5&3,i=!t||t.biff>=8?4:2,s=n.read_shift(i);switch(t.biff){case 2:n.l+=5;break;case 3:case 4:n.l+=8;break;case 5:n.l+=12;break}return[r,0,s]}function gwe(n,e,t){if(t.biff==5)return mwe(n);var r=n.read_shift(1)>>>5&3,i=n.read_shift(2),s=n.read_shift(4);return[r,i,s]}function mwe(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2,"i");n.l+=8;var r=n.read_shift(2);return n.l+=12,[e,t,r]}function pwe(n,e,t){var r=n.read_shift(1)>>>5&3;n.l+=t&&t.biff==2?3:4;var i=n.read_shift(t&&t.biff==2?1:2);return[r,i]}function ywe(n,e,t){var r=n.read_shift(1)>>>5&3,i=n.read_shift(t&&t.biff==2?1:2);return[r,i]}function xwe(n,e,t){var r=n.read_shift(1)>>>5&3;return n.l+=4,t.biff<8&&n.l--,t.biff==12&&(n.l+=2),[r]}function _we(n,e,t){var r=(n[n.l++]&96)>>5,i=n.read_shift(2),s=4;if(t)switch(t.biff){case 5:s=15;break;case 12:s=6;break}return n.l+=s,[r,i]}var vwe=ml,wwe=ml,Ewe=ml;function ly(n,e,t){return n.l+=2,[Ove(n)]}function SC(n){return n.l+=6,[]}var Swe=ly,bwe=SC,Twe=SC,Rwe=ly;function BG(n){return n.l+=2,[_G(n),n.read_shift(2)&1]}var Awe=ly,kwe=BG,Iwe=SC,Cwe=ly,Pwe=ly,Nwe=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function Mwe(n){n.l+=2;var e=n.read_shift(2),t=n.read_shift(2),r=n.read_shift(4),i=n.read_shift(2),s=n.read_shift(2),a=Nwe[t>>2&31];return{ixti:e,coltype:t&3,rt:a,idx:r,c:i,C:s}}function Lwe(n){return n.l+=2,[n.read_shift(4)]}function Owe(n,e,t){return n.l+=5,n.l+=2,n.l+=t.biff==2?1:4,["PTGSHEET"]}function Dwe(n,e,t){return n.l+=t.biff==2?4:5,["PTGENDSHEET"]}function jwe(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2);return[e,t]}function Fwe(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2);return[e,t]}function Vwe(n){return n.l+=4,[0,0]}var ZO={1:{n:"PtgExp",f:iwe},2:{n:"PtgTbl",f:Ewe},3:{n:"PtgAdd",f:Zr},4:{n:"PtgSub",f:Zr},5:{n:"PtgMul",f:Zr},6:{n:"PtgDiv",f:Zr},7:{n:"PtgPower",f:Zr},8:{n:"PtgConcat",f:Zr},9:{n:"PtgLt",f:Zr},10:{n:"PtgLe",f:Zr},11:{n:"PtgEq",f:Zr},12:{n:"PtgGe",f:Zr},13:{n:"PtgGt",f:Zr},14:{n:"PtgNe",f:Zr},15:{n:"PtgIsect",f:Zr},16:{n:"PtgUnion",f:Zr},17:{n:"PtgRange",f:Zr},18:{n:"PtgUplus",f:Zr},19:{n:"PtgUminus",f:Zr},20:{n:"PtgPercent",f:Zr},21:{n:"PtgParen",f:Zr},22:{n:"PtgMissArg",f:Zr},23:{n:"PtgStr",f:cwe},26:{n:"PtgSheet",f:Owe},27:{n:"PtgEndSheet",f:Dwe},28:{n:"PtgErr",f:swe},29:{n:"PtgBool",f:owe},30:{n:"PtgInt",f:awe},31:{n:"PtgNum",f:lwe},32:{n:"PtgArray",f:Uve},33:{n:"PtgFunc",f:ewe},34:{n:"PtgFuncVar",f:twe},35:{n:"PtgName",f:fwe},36:{n:"PtgRef",f:Zve},37:{n:"PtgArea",f:Fve},38:{n:"PtgMemArea",f:pwe},39:{n:"PtgMemErr",f:vwe},40:{n:"PtgMemNoMem",f:wwe},41:{n:"PtgMemFunc",f:ywe},42:{n:"PtgRefErr",f:xwe},43:{n:"PtgAreaErr",f:Bve},44:{n:"PtgRefN",f:Jve},45:{n:"PtgAreaN",f:zve},46:{n:"PtgMemAreaN",f:jwe},47:{n:"PtgMemNoMemN",f:Fwe},57:{n:"PtgNameX",f:gwe},58:{n:"PtgRef3d",f:Qve},59:{n:"PtgArea3d",f:Vve},60:{n:"PtgRefErr3d",f:_we},61:{n:"PtgAreaErr3d",f:Gve},255:{}},Bwe={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Gwe={1:{n:"PtgElfLel",f:BG},2:{n:"PtgElfRw",f:Cwe},3:{n:"PtgElfCol",f:Swe},6:{n:"PtgElfRwV",f:Pwe},7:{n:"PtgElfColV",f:Rwe},10:{n:"PtgElfRadical",f:Awe},11:{n:"PtgElfRadicalS",f:Iwe},13:{n:"PtgElfColS",f:bwe},15:{n:"PtgElfColSV",f:Twe},16:{n:"PtgElfRadicalLel",f:kwe},25:{n:"PtgList",f:Mwe},29:{n:"PtgSxName",f:Lwe},255:{}},zwe={0:{n:"PtgAttrNoop",f:Vwe},1:{n:"PtgAttrSemi",f:Xve},2:{n:"PtgAttrIf",f:Hve},4:{n:"PtgAttrChoose",f:$ve},8:{n:"PtgAttrGoto",f:Wve},16:{n:"PtgAttrSum",f:rwe},32:{n:"PtgAttrBaxcel",f:YO},33:{n:"PtgAttrBaxcel",f:YO},64:{n:"PtgAttrSpace",f:qve},65:{n:"PtgAttrSpaceSemi",f:Yve},128:{n:"PtgAttrIfError",f:Kve},255:{}};function Uwe(n,e,t,r){if(r.biff<8)return ml(n,e);for(var i=n.l+e,s=[],a=0;a!==t.length;++a)switch(t[a][0]){case"PtgArray":t[a][1]=dwe(n,0,r),s.push(t[a][1]);break;case"PtgMemArea":t[a][2]=hwe(n,t[a][1],r),s.push(t[a][2]);break;case"PtgExp":r&&r.biff==12&&(t[a][1][1]=n.read_shift(4),s.push(t[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[a][0]}return e=i-n.l,e!==0&&s.push(ml(n,e)),s}function $we(n,e,t){for(var r=n.l+e,i,s,a=[];r!=n.l;)e=r-n.l,s=n[n.l],i=ZO[s]||ZO[Bwe[s]],(s===24||s===25)&&(i=(s===24?Gwe:zwe)[n[n.l+1]]),!i||!i.f?ml(n,e):a.push([i.n,i.f(n,e,t)]);return a}function Wwe(n){for(var e=[],t=0;t<n.length;++t){for(var r=n[t],i=[],s=0;s<r.length;++s){var a=r[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var Hwe={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Kwe(n,e){if(!n&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(n)?"'"+n+"'":n}function GG(n,e,t){if(!n)return"SH33TJSERR0";if(t.biff>8&&(!n.XTI||!n.XTI[e]))return n.SheetNames[e];if(!n.XTI)return"SH33TJSERR6";var r=n.XTI[e];if(t.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":n.XTI[e-1];if(!r)return"SH33TJSERR1";var i="";if(t.biff>8)switch(n[r[0]][0]){case 357:return i=r[1]==-1?"#REF":n.SheetNames[r[1]],r[1]==r[2]?i:i+":"+n.SheetNames[r[2]];case 358:return t.SID!=null?n.SheetNames[t.SID]:"SH33TJSSAME"+n[r[0]][0];case 355:default:return"SH33TJSSRC"+n[r[0]][0]}switch(n[r[0]][0][0]){case 1025:return i=r[1]==-1?"#REF":n.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?i:i+":"+n.SheetNames[r[2]];case 14849:return n[r[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return n[r[0]][0][3]?(i=r[1]==-1?"#REF":n[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?i:i+":"+n[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function JO(n,e,t){var r=GG(n,e,t);return r=="#REF"?r:Kwe(r,t)}function rg(n,e,t,r,i){var s=i&&i.biff||8,a={s:{c:0,r:0}},o=[],l,c,h,g=0,m=0,y,_="";if(!n[0]||!n[0][0])return"";for(var x=-1,w="",b=0,T=n[0].length;b<T;++b){var k=n[0][b];switch(k[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),x>=0){switch(n[0][x][1][0]){case 0:w=Vr(" ",n[0][x][1][1]);break;case 1:w=Vr("\r",n[0][x][1][1]);break;default:if(w="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][x][1][0])}c=c+w,x=-1}o.push(c+Hwe[k[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":h=gp(k[1][1],a,i),o.push(mp(h,s));break;case"PtgRefN":h=t?gp(k[1][1],t,i):k[1][1],o.push(mp(h,s));break;case"PtgRef3d":g=k[1][1],h=gp(k[1][2],a,i),_=JO(r,g,i),o.push(_+"!"+mp(h,s));break;case"PtgFunc":case"PtgFuncVar":var L=k[1][0],O=k[1][1];L||(L=0),L&=127;var B=L==0?[]:o.slice(-L);o.length-=L,O==="User"&&(O=B.shift()),o.push(O+"("+B.join(",")+")");break;case"PtgBool":o.push(k[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(k[1]);break;case"PtgNum":o.push(String(k[1]));break;case"PtgStr":o.push('"'+k[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(k[1]);break;case"PtgAreaN":y=DO(k[1][1],t?{s:t}:a,i),o.push(Bb(y,i));break;case"PtgArea":y=DO(k[1][1],a,i),o.push(Bb(y,i));break;case"PtgArea3d":g=k[1][1],y=k[1][2],_=JO(r,g,i),o.push(_+"!"+Bb(y,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":m=k[1][2];var R=(r.names||[])[m-1]||(r[0]||[])[m],A=R?R.Name:"SH33TJSNAME"+String(m);A&&A.slice(0,6)=="_xlfn."&&!i.xlfn&&(A=A.slice(6)),o.push(A);break;case"PtgNameX":var P=k[1][1];m=k[1][2];var D;if(i.biff<=5)P<0&&(P=-P),r[P]&&(D=r[P][m]);else{var N="";if(((r[P]||[])[0]||[])[0]==14849||(((r[P]||[])[0]||[])[0]==1025?r[P][m]&&r[P][m].itab>0&&(N=r.SheetNames[r[P][m].itab-1]+"!"):N=r.SheetNames[m-1]+"!"),r[P]&&r[P][m])N+=r[P][m].Name;else if(r[0]&&r[0][m])N+=r[0][m].Name;else{var G=(GG(r,P,i)||"").split(";;");G[m-1]?N=G[m-1]:N+="SH33TJSERRX"}o.push(N);break}D||(D={Name:"SH33TJSERRY"}),o.push(D.Name);break;case"PtgParen":var j="(",ve=")";if(x>=0){switch(w="",n[0][x][1][0]){case 2:j=Vr(" ",n[0][x][1][1])+j;break;case 3:j=Vr("\r",n[0][x][1][1])+j;break;case 4:ve=Vr(" ",n[0][x][1][1])+ve;break;case 5:ve=Vr("\r",n[0][x][1][1])+ve;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][x][1][0])}x=-1}o.push(j+o.pop()+ve);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":h={c:k[1][1],r:k[1][0]};var ce={c:t.c,r:t.r};if(r.sharedf[nr(h)]){var je=r.sharedf[nr(h)];o.push(rg(je,a,ce,r,i))}else{var Pe=!1;for(l=0;l!=r.arrayf.length;++l)if(c=r.arrayf[l],!(h.c<c[0].s.c||h.c>c[0].e.c)&&!(h.r<c[0].s.r||h.r>c[0].e.r)){o.push(rg(c[1],a,ce,r,i)),Pe=!0;break}Pe||o.push(k[1])}break;case"PtgArray":o.push("{"+Wwe(k[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=b;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+k[1].idx+"[#"+k[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(k));default:throw new Error("Unrecognized Formula Token: "+String(k))}var ue=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&x>=0&&ue.indexOf(n[0][b][0])==-1){k=n[0][x];var Ne=!0;switch(k[1][0]){case 4:Ne=!1;case 0:w=Vr(" ",k[1][1]);break;case 5:Ne=!1;case 1:w=Vr("\r",k[1][1]);break;default:if(w="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+k[1][0])}o.push((Ne?w:"")+o.pop()+(Ne?"":w)),x=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function Xwe(n){if(n==null){var e=Le(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof n=="number")return Rd(n);return Rd(0)}function qwe(n,e,t,r,i){var s=Ad(e,t,i),a=Xwe(n.v),o=Le(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var c=Le(n.bf.length),h=0;h<n.bf.length;++h)c[h]=n.bf[h];var g=$i([s,a,o,c]);return g}function BE(n,e,t){var r=n.read_shift(4),i=$we(n,r,t),s=n.read_shift(4),a=s>0?Uwe(n,s,i,t):null;return[i,a]}var Ywe=BE,GE=BE,Zwe=BE,Jwe=BE,Qwe={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},zG={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},eEe={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function tEe(n){var e="of:="+n.replace(wC,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function nEe(n){return n.replace(/\./,"!")}var pp=typeof Map<"u";function bC(n,e,t){var r=0,i=n.length;if(t){if(pp?t.has(e):Object.prototype.hasOwnProperty.call(t,e)){for(var s=pp?t.get(e):t[e];r<s.length;++r)if(n[s[r]].t===e)return n.Count++,s[r]}}else for(;r<i;++r)if(n[r].t===e)return n.Count++,r;return n[i]={t:e},n.Count++,n.Unique++,t&&(pp?(t.has(e)||t.set(e,[]),t.get(e).push(i)):(Object.prototype.hasOwnProperty.call(t,e)||(t[e]=[]),t[e].push(i))),i}function zE(n,e){var t={min:n+1,max:n+1},r=-1;return e.MDW&&(rc=e.MDW),e.width!=null?t.customWidth=1:e.wpx!=null?r=dw(e.wpx):e.wch!=null&&(r=e.wch),r>-1?(t.width=HR(r),t.customWidth=1):e.width!=null&&(t.width=e.width),e.hidden&&(t.hidden=!0),e.level!=null&&(t.outlineLevel=t.level=e.level),t}function UG(n,e){if(n){var t=[.7,.7,.75,.75,.3,.3];n.left==null&&(n.left=t[0]),n.right==null&&(n.right=t[1]),n.top==null&&(n.top=t[2]),n.bottom==null&&(n.bottom=t[3]),n.header==null&&(n.header=t[4]),n.footer==null&&(n.footer=t[5])}}function Qu(n,e,t){var r=t.revssf[e.z!=null?e.z:"General"],i=60,s=n.length;if(r==null&&t.ssf){for(;i<392;++i)if(t.ssf[i]==null){FB(e.z,i),t.ssf[i]=e.z,t.revssf[e.z]=r=i;break}}for(i=0;i!=s;++i)if(n[i].numFmtId===r)return i;return n[s]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function rEe(n,e,t){if(n&&n["!ref"]){var r=pr(n["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+t+"): "+n["!ref"])}}function iEe(n){if(n.length===0)return"";for(var e='<mergeCells count="'+n.length+'">',t=0;t!=n.length;++t)e+='<mergeCell ref="'+ii(n[t])+'"/>';return e+"</mergeCells>"}function sEe(n,e,t,r,i){var s=!1,a={},o=null;if(r.bookType!=="xlsx"&&e.vbaraw){var l=e.SheetNames[t];try{e.Workbook&&(l=e.Workbook.Sheets[t].CodeName||l)}catch{}s=!0,a.codeName=c1(er(l))}if(n&&n["!outline"]){var c={summaryBelow:1,summaryRight:1};n["!outline"].above&&(c.summaryBelow=0),n["!outline"].left&&(c.summaryRight=0),o=(o||"")+at("outlinePr",null,c)}!s&&!o||(i[i.length]=at("sheetPr",o,a))}var aEe=["objects","scenarios","selectLockedCells","selectUnlockedCells"],oEe=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function lEe(n){var e={sheet:1};return aEe.forEach(function(t){n[t]!=null&&n[t]&&(e[t]="1")}),oEe.forEach(function(t){n[t]!=null&&!n[t]&&(e[t]="0")}),n.password&&(e.password=RG(n.password).toString(16).toUpperCase()),at("sheetProtection",null,e)}function cEe(n){return UG(n),at("pageMargins",null,n)}function uEe(n,e){for(var t=["<cols>"],r,i=0;i!=e.length;++i)(r=e[i])&&(t[t.length]=at("col",null,zE(i,r)));return t[t.length]="</cols>",t.join("")}function hEe(n,e,t,r){var i=typeof n.ref=="string"?n.ref:ii(n.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var s=t.Workbook.Names,a=ya(i);a.s.r==a.e.r&&(a.e.r=ya(e["!ref"]).e.r,i=ii(a));for(var o=0;o<s.length;++o){var l=s[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==r){l.Ref="'"+t.SheetNames[r]+"'!"+i;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+t.SheetNames[r]+"'!"+i}),at("autoFilter",null,{ref:i})}function dEe(n,e,t,r){var i={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),at("sheetViews",at("sheetView",null,i),{})}function fEe(n,e,t,r){if(n.c&&t["!comments"].push([e,n.c]),n.v===void 0&&typeof n.f!="string"||n.t==="z"&&!n.f)return"";var i="",s=n.t,a=n.v;if(n.t!=="z")switch(n.t){case"b":i=n.v?"1":"0";break;case"n":i=""+n.v;break;case"e":i=oy[n.v];break;case"d":r&&r.cellDates?i=Ts(n.v,-1).toISOString():(n=Ks(n),n.t="n",i=""+(n.v=Hs(Ts(n.v)))),typeof n.z>"u"&&(n.z=Gr[14]);break;default:i=n.v;break}var o=Wi("v",er(i)),l={r:e},c=Qu(r.cellXfs,n,r);switch(c!==0&&(l.s=c),n.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(n.v==null){delete n.t;break}if(n.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){o=Wi("v",""+bC(r.Strings,n.v,r.revStrings)),l.t="s";break}l.t="str";break}if(n.t!=s&&(n.t=s,n.v=a),typeof n.f=="string"&&n.f){var h=n.F&&n.F.slice(0,e.length)==e?{t:"array",ref:n.F}:null;o=at("f",er(n.f),h)+(n.v!=null?o:"")}return n.l&&t["!links"].push([e,n.l]),n.D&&(l.cm=1),at("c",o,l)}function gEe(n,e,t,r){var i=[],s=[],a=pr(n["!ref"]),o="",l,c="",h=[],g=0,m=0,y=n["!rows"],_=Array.isArray(n),x={r:c},w,b=-1;for(m=a.s.c;m<=a.e.c;++m)h[m]=gs(m);for(g=a.s.r;g<=a.e.r;++g){for(s=[],c=Ki(g),m=a.s.c;m<=a.e.c;++m){l=h[m]+c;var T=_?(n[g]||[])[m]:n[l];T!==void 0&&(o=fEe(T,l,n,e))!=null&&s.push(o)}(s.length>0||y&&y[g])&&(x={r:c},y&&y[g]&&(w=y[g],w.hidden&&(x.hidden=1),b=-1,w.hpx?b=fw(w.hpx):w.hpt&&(b=w.hpt),b>-1&&(x.ht=b,x.customHeight=1),w.level&&(x.outlineLevel=w.level)),i[i.length]=at("row",s.join(""),x))}if(y)for(;g<y.length;++g)y&&y[g]&&(x={r:g+1},w=y[g],w.hidden&&(x.hidden=1),b=-1,w.hpx?b=fw(w.hpx):w.hpt&&(b=w.hpt),b>-1&&(x.ht=b,x.customHeight=1),w.level&&(x.outlineLevel=w.level),i[i.length]=at("row","",x));return i.join("")}function $G(n,e,t,r){var i=[ai,at("worksheet",null,{xmlns:vg[0],"xmlns:r":Ri.r})],s=t.SheetNames[n],a=0,o="",l=t.Sheets[s];l==null&&(l={});var c=l["!ref"]||"A1",h=pr(c);if(h.e.c>16383||h.e.r>1048575){if(e.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575),c=ii(h)}r||(r={}),l["!comments"]=[];var g=[];sEe(l,t,n,e,i),i[i.length]=at("dimension",null,{ref:c}),i[i.length]=dEe(l,e,n,t),e.sheetFormat&&(i[i.length]=at("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=uEe(l,l["!cols"])),i[a=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=gEe(l,e),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),l["!protect"]&&(i[i.length]=lEe(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=hEe(l["!autofilter"],l,t,n)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=iEe(l["!merges"]));var m=-1,y,_=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(x){x[1].Target&&(y={ref:x[0]},x[1].Target.charAt(0)!="#"&&(_=Yn(r,-1,er(x[1].Target).replace(/#.*$/,""),Mn.HLINK),y["r:id"]="rId"+_),(m=x[1].Target.indexOf("#"))>-1&&(y.location=er(x[1].Target.slice(m+1))),x[1].Tooltip&&(y.tooltip=er(x[1].Tooltip)),i[i.length]=at("hyperlink",null,y))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=cEe(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=Wi("ignoredErrors",at("ignoredError",null,{numberStoredAsText:1,sqref:c}))),g.length>0&&(_=Yn(r,-1,"../drawings/drawing"+(n+1)+".xml",Mn.DRAW),i[i.length]=at("drawing",null,{"r:id":"rId"+_}),l["!drawing"]=g),l["!comments"].length>0&&(_=Yn(r,-1,"../drawings/vmlDrawing"+(n+1)+".vml",Mn.VML),i[i.length]=at("legacyDrawing",null,{"r:id":"rId"+_}),l["!legacy"]=_),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function mEe(n,e){var t={},r=n.l+e;t.r=n.read_shift(4),n.l+=4;var i=n.read_shift(2);n.l+=1;var s=n.read_shift(1);return n.l=r,s&7&&(t.level=s&7),s&16&&(t.hidden=!0),s&32&&(t.hpt=i/20),t}function pEe(n,e,t){var r=Le(145),i=(t["!rows"]||[])[n]||{};r.write_shift(4,n),r.write_shift(4,0);var s=320;i.hpx?s=fw(i.hpx)*20:i.hpt&&(s=i.hpt*20),r.write_shift(2,s),r.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),r.write_shift(1,a),r.write_shift(1,0);var o=0,l=r.l;r.l+=4;for(var c={r:n,c:0},h=0;h<16;++h)if(!(e.s.c>h+1<<10||e.e.c<h<<10)){for(var g=-1,m=-1,y=h<<10;y<h+1<<10;++y){c.c=y;var _=Array.isArray(t)?(t[c.r]||[])[c.c]:t[nr(c)];_&&(g<0&&(g=y),m=y)}g<0||(++o,r.write_shift(4,g),r.write_shift(4,m))}var x=r.l;return r.l=l,r.write_shift(4,o),r.l=x,r.length>r.l?r.slice(0,r.l):r}function yEe(n,e,t,r){var i=pEe(r,t,e);(i.length>17||(e["!rows"]||[])[r])&&We(n,0,i)}var xEe=$d,_Ee=Eg;function vEe(){}function wEe(n,e){var t={},r=n[n.l];return++n.l,t.above=!(r&64),t.left=!(r&128),n.l+=18,t.name=Pxe(n),t}function EEe(n,e,t){t==null&&(t=Le(84+4*n.length));var r=192;e&&(e.above&&(r&=-65),e.left&&(r&=-129)),t.write_shift(1,r);for(var i=1;i<3;++i)t.write_shift(1,0);return cw({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),sG(n,t),t.slice(0,t.l)}function SEe(n){var e=Ha(n);return[e]}function bEe(n,e,t){return t==null&&(t=Le(8)),Gd(e,t)}function TEe(n){var e=zd(n);return[e]}function REe(n,e,t){return t==null&&(t=Le(4)),Ud(e,t)}function AEe(n){var e=Ha(n),t=n.read_shift(1);return[e,t,"b"]}function kEe(n,e,t){return t==null&&(t=Le(9)),Gd(e,t),t.write_shift(1,n.v?1:0),t}function IEe(n){var e=zd(n),t=n.read_shift(1);return[e,t,"b"]}function CEe(n,e,t){return t==null&&(t=Le(5)),Ud(e,t),t.write_shift(1,n.v?1:0),t}function PEe(n){var e=Ha(n),t=n.read_shift(1);return[e,t,"e"]}function NEe(n,e,t){return t==null&&(t=Le(9)),Gd(e,t),t.write_shift(1,n.v),t}function MEe(n){var e=zd(n),t=n.read_shift(1);return[e,t,"e"]}function LEe(n,e,t){return t==null&&(t=Le(8)),Ud(e,t),t.write_shift(1,n.v),t.write_shift(2,0),t.write_shift(1,0),t}function OEe(n){var e=Ha(n),t=n.read_shift(4);return[e,t,"s"]}function DEe(n,e,t){return t==null&&(t=Le(12)),Gd(e,t),t.write_shift(4,e.v),t}function jEe(n){var e=zd(n),t=n.read_shift(4);return[e,t,"s"]}function FEe(n,e,t){return t==null&&(t=Le(8)),Ud(e,t),t.write_shift(4,e.v),t}function VEe(n){var e=Ha(n),t=Sg(n);return[e,t,"n"]}function BEe(n,e,t){return t==null&&(t=Le(16)),Gd(e,t),Rd(n.v,t),t}function GEe(n){var e=zd(n),t=Sg(n);return[e,t,"n"]}function zEe(n,e,t){return t==null&&(t=Le(12)),Ud(e,t),Rd(n.v,t),t}function UEe(n){var e=Ha(n),t=aG(n);return[e,t,"n"]}function $Ee(n,e,t){return t==null&&(t=Le(12)),Gd(e,t),oG(n.v,t),t}function WEe(n){var e=zd(n),t=aG(n);return[e,t,"n"]}function HEe(n,e,t){return t==null&&(t=Le(8)),Ud(e,t),oG(n.v,t),t}function KEe(n){var e=Ha(n),t=pC(n);return[e,t,"is"]}function XEe(n){var e=Ha(n),t=ms(n);return[e,t,"str"]}function qEe(n,e,t){return t==null&&(t=Le(12+4*n.v.length)),Gd(e,t),Ii(n.v,t),t.length>t.l?t.slice(0,t.l):t}function YEe(n){var e=zd(n),t=ms(n);return[e,t,"str"]}function ZEe(n,e,t){return t==null&&(t=Le(8+4*n.v.length)),Ud(e,t),Ii(n.v,t),t.length>t.l?t.slice(0,t.l):t}function JEe(n,e,t){var r=n.l+e,i=Ha(n);i.r=t["!row"];var s=n.read_shift(1),a=[i,s,"b"];if(t.cellFormula){n.l+=2;var o=GE(n,r-n.l,t);a[3]=rg(o,null,i,t.supbooks,t)}else n.l=r;return a}function QEe(n,e,t){var r=n.l+e,i=Ha(n);i.r=t["!row"];var s=n.read_shift(1),a=[i,s,"e"];if(t.cellFormula){n.l+=2;var o=GE(n,r-n.l,t);a[3]=rg(o,null,i,t.supbooks,t)}else n.l=r;return a}function e2e(n,e,t){var r=n.l+e,i=Ha(n);i.r=t["!row"];var s=Sg(n),a=[i,s,"n"];if(t.cellFormula){n.l+=2;var o=GE(n,r-n.l,t);a[3]=rg(o,null,i,t.supbooks,t)}else n.l=r;return a}function t2e(n,e,t){var r=n.l+e,i=Ha(n);i.r=t["!row"];var s=ms(n),a=[i,s,"str"];if(t.cellFormula){n.l+=2;var o=GE(n,r-n.l,t);a[3]=rg(o,null,i,t.supbooks,t)}else n.l=r;return a}var n2e=$d,r2e=Eg;function i2e(n,e){return e==null&&(e=Le(4)),e.write_shift(4,n),e}function s2e(n,e){var t=n.l+e,r=$d(n),i=yC(n),s=ms(n),a=ms(n),o=ms(n);n.l=t;var l={rfx:r,relId:i,loc:s,display:o};return a&&(l.Tooltip=a),l}function a2e(n,e){var t=Le(50+4*(n[1].Target.length+(n[1].Tooltip||"").length));Eg({s:ki(n[0]),e:ki(n[0])},t),xC("rId"+e,t);var r=n[1].Target.indexOf("#"),i=r==-1?"":n[1].Target.slice(r+1);return Ii(i||"",t),Ii(n[1].Tooltip||"",t),Ii("",t),t.slice(0,t.l)}function o2e(){}function l2e(n,e,t){var r=n.l+e,i=lG(n),s=n.read_shift(1),a=[i];if(a[2]=s,t.cellFormula){var o=Ywe(n,r-n.l,t);a[1]=o}else n.l=r;return a}function c2e(n,e,t){var r=n.l+e,i=$d(n),s=[i];if(t.cellFormula){var a=Jwe(n,r-n.l,t);s[1]=a,n.l=r}else n.l=r;return s}function u2e(n,e,t){t==null&&(t=Le(18));var r=zE(n,e);t.write_shift(-4,n),t.write_shift(-4,n),t.write_shift(4,(r.width||10)*256),t.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof r.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),t.write_shift(2,i),t}var WG=["left","right","top","bottom","header","footer"];function h2e(n){var e={};return WG.forEach(function(t){e[t]=Sg(n)}),e}function d2e(n,e){return e==null&&(e=Le(48)),UG(n),WG.forEach(function(t){Rd(n[t],e)}),e}function f2e(n){var e=n.read_shift(2);return n.l+=28,{RTL:e&32}}function g2e(n,e,t){t==null&&(t=Le(30));var r=924;return(((e||{}).Views||[])[0]||{}).RTL&&(r|=32),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function m2e(n){var e=Le(24);return e.write_shift(4,4),e.write_shift(4,1),Eg(n,e),e}function p2e(n,e){return e==null&&(e=Le(66)),e.write_shift(2,n.password?RG(n.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?e.write_shift(4,n[t[0]]!=null&&!n[t[0]]?1:0):e.write_shift(4,n[t[0]]!=null&&n[t[0]]?0:1)}),e}function y2e(){}function x2e(){}function _2e(n,e,t,r,i,s,a){if(e.v===void 0)return!1;var o="";switch(e.t){case"b":o=e.v?"1":"0";break;case"d":e=Ks(e),e.z=e.z||Gr[14],e.v=Hs(Ts(e.v)),e.t="n";break;case"n":case"e":o=""+e.v;break;default:o=e.v;break}var l={r:t,c:r};switch(l.s=Qu(i.cellXfs,e,i),e.l&&s["!links"].push([nr(l),e.l]),e.c&&s["!comments"].push([nr(l),e.c]),e.t){case"s":case"str":return i.bookSST?(o=bC(i.Strings,e.v,i.revStrings),l.t="s",l.v=o,a?We(n,18,FEe(e,l)):We(n,7,DEe(e,l))):(l.t="str",a?We(n,17,ZEe(e,l)):We(n,6,qEe(e,l))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?a?We(n,13,HEe(e,l)):We(n,2,$Ee(e,l)):a?We(n,16,zEe(e,l)):We(n,5,BEe(e,l)),!0;case"b":return l.t="b",a?We(n,15,CEe(e,l)):We(n,4,kEe(e,l)),!0;case"e":return l.t="e",a?We(n,14,LEe(e,l)):We(n,3,NEe(e,l)),!0}return a?We(n,12,REe(e,l)):We(n,1,bEe(e,l)),!0}function v2e(n,e,t,r){var i=pr(e["!ref"]||"A1"),s,a="",o=[];We(n,145);var l=Array.isArray(e),c=i.e.r;e["!rows"]&&(c=Math.max(i.e.r,e["!rows"].length-1));for(var h=i.s.r;h<=c;++h){a=Ki(h),yEe(n,e,i,h);var g=!1;if(h<=i.e.r)for(var m=i.s.c;m<=i.e.c;++m){h===i.s.r&&(o[m]=gs(m)),s=o[m]+a;var y=l?(e[h]||[])[m]:e[s];if(!y){g=!1;continue}g=_2e(n,y,h,m,r,e,g)}}We(n,146)}function w2e(n,e){!e||!e["!merges"]||(We(n,177,i2e(e["!merges"].length)),e["!merges"].forEach(function(t){We(n,176,r2e(t))}),We(n,178))}function E2e(n,e){!e||!e["!cols"]||(We(n,390),e["!cols"].forEach(function(t,r){t&&We(n,60,u2e(r,t))}),We(n,391))}function S2e(n,e){!e||!e["!ref"]||(We(n,648),We(n,649,m2e(pr(e["!ref"]))),We(n,650))}function b2e(n,e,t){e["!links"].forEach(function(r){if(r[1].Target){var i=Yn(t,-1,r[1].Target.replace(/#.*$/,""),Mn.HLINK);We(n,494,a2e(r,i))}}),delete e["!links"]}function T2e(n,e,t,r){if(e["!comments"].length>0){var i=Yn(r,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Mn.VML);We(n,551,xC("rId"+i)),e["!legacy"]=i}}function R2e(n,e,t,r){if(e["!autofilter"]){var i=e["!autofilter"],s=typeof i.ref=="string"?i.ref:ii(i.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var a=t.Workbook.Names,o=ya(s);o.s.r==o.e.r&&(o.e.r=ya(e["!ref"]).e.r,s=ii(o));for(var l=0;l<a.length;++l){var c=a[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==r){c.Ref="'"+t.SheetNames[r]+"'!"+s;break}}l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+t.SheetNames[r]+"'!"+s}),We(n,161,Eg(pr(s))),We(n,162)}}function A2e(n,e,t){We(n,133),We(n,137,g2e(e,t)),We(n,138),We(n,134)}function k2e(n,e){e["!protect"]&&We(n,535,p2e(e["!protect"]))}function I2e(n,e,t,r){var i=Gs(),s=t.SheetNames[n],a=t.Sheets[s]||{},o=s;try{t&&t.Workbook&&(o=t.Workbook.Sheets[n].CodeName||o)}catch{}var l=pr(a["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],We(i,129),(t.vbaraw||a["!outline"])&&We(i,147,EEe(o,a["!outline"])),We(i,148,_Ee(l)),A2e(i,a,t.Workbook),E2e(i,a),v2e(i,a,n,e),k2e(i,a),R2e(i,a,t,n),w2e(i,a),b2e(i,a,r),a["!margins"]&&We(i,476,d2e(a["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&S2e(i,a),T2e(i,a,n,r),We(i,130),i.end()}function C2e(n,e){n.l+=10;var t=ms(n);return{name:t}}var P2e=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function N2e(n){return!n.Workbook||!n.Workbook.WBProps?"false":cxe(n.Workbook.WBProps.date1904)?"true":"false"}var M2e="][*?/\\".split("");function HG(n,e){if(n.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return M2e.forEach(function(r){if(n.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}function L2e(n,e,t){n.forEach(function(r,i){HG(r);for(var s=0;s<i;++s)if(r==n[s])throw new Error("Duplicate Sheet Name: "+r);if(t){var a=e&&e[i]&&e[i].CodeName||r;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function O2e(n){if(!n||!n.SheetNames||!n.Sheets)throw new Error("Invalid Workbook");if(!n.SheetNames.length)throw new Error("Workbook is empty");var e=n.Workbook&&n.Workbook.Sheets||[];L2e(n.SheetNames,e,!!n.vbaraw);for(var t=0;t<n.SheetNames.length;++t)rEe(n.Sheets[n.SheetNames[t]],n.SheetNames[t],t)}function KG(n){var e=[ai];e[e.length]=at("workbook",null,{xmlns:vg[0],"xmlns:r":Ri.r});var t=n.Workbook&&(n.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};n.Workbook&&n.Workbook.WBProps&&(P2e.forEach(function(o){n.Workbook.WBProps[o[0]]!=null&&n.Workbook.WBProps[o[0]]!=o[1]&&(r[o[0]]=n.Workbook.WBProps[o[0]])}),n.Workbook.WBProps.CodeName&&(r.codeName=n.Workbook.WBProps.CodeName,delete r.CodeName)),e[e.length]=at("workbookPr",null,r);var i=n.Workbook&&n.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=n.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==n.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=n.SheetNames.length;++s){var a={name:er(n.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}e[e.length]=at("sheet",null,a)}return e[e.length]="</sheets>",t&&(e[e.length]="<definedNames>",n.Workbook&&n.Workbook.Names&&n.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(e[e.length]=at("definedName",er(o.Ref),l))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function D2e(n,e){var t={};return t.Hidden=n.read_shift(4),t.iTabID=n.read_shift(4),t.strRelID=WR(n),t.name=ms(n),t}function j2e(n,e){return e||(e=Le(127)),e.write_shift(4,n.Hidden),e.write_shift(4,n.iTabID),xC(n.strRelID,e),Ii(n.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function F2e(n,e){var t={},r=n.read_shift(4);t.defaultThemeVersion=n.read_shift(4);var i=e>8?ms(n):"";return i.length>0&&(t.CodeName=i),t.autoCompressPictures=!!(r&65536),t.backupFile=!!(r&64),t.checkCompatibility=!!(r&4096),t.date1904=!!(r&1),t.filterPrivacy=!!(r&8),t.hidePivotFieldList=!!(r&1024),t.promptedSolutions=!!(r&16),t.publishItems=!!(r&2048),t.refreshAllConnections=!!(r&262144),t.saveExternalLinkValues=!!(r&128),t.showBorderUnselectedTables=!!(r&4),t.showInkAnnotation=!!(r&32),t.showObjects=["all","placeholders","none"][r>>13&3],t.showPivotChartFilter=!!(r&32768),t.updateLinks=["userSet","never","always"][r>>8&3],t}function V2e(n,e){e||(e=Le(72));var t=0;return n&&n.filterPrivacy&&(t|=8),e.write_shift(4,t),e.write_shift(4,0),sG(n&&n.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function B2e(n,e,t){var r=n.l+e;n.l+=4,n.l+=1;var i=n.read_shift(4),s=Nxe(n),a=Zwe(n,0,t),o=yC(n);n.l=r;var l={Name:s,Ptg:a};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}function G2e(n,e){We(n,143);for(var t=0;t!=e.SheetNames.length;++t){var r=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[t]&&e.Workbook.Sheets[t].Hidden||0,i={Hidden:r,iTabID:t+1,strRelID:"rId"+(t+1),name:e.SheetNames[t]};We(n,156,j2e(i))}We(n,144)}function z2e(n,e){e||(e=Le(127));for(var t=0;t!=4;++t)e.write_shift(4,0);return Ii("SheetJS",e),Ii(tw.version,e),Ii(tw.version,e),Ii("7262",e),e.length>e.l?e.slice(0,e.l):e}function U2e(n,e){e||(e=Le(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,n),e.write_shift(4,n);var t=120;return e.write_shift(1,t),e.length>e.l?e.slice(0,e.l):e}function $2e(n,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var t=e.Workbook.Sheets,r=0,i=-1,s=-1;r<t.length;++r)!t[r]||!t[r].Hidden&&i==-1?i=r:t[r].Hidden==1&&s==-1&&(s=r);s>i||(We(n,135),We(n,158,U2e(i)),We(n,136))}}function W2e(n,e){var t=Gs();return We(t,131),We(t,128,z2e()),We(t,153,V2e(n.Workbook&&n.Workbook.WBProps||null)),$2e(t,n),G2e(t,n),We(t,132),t.end()}function H2e(n,e,t){return(e.slice(-4)===".bin"?W2e:KG)(n)}function K2e(n,e,t,r,i){return(e.slice(-4)===".bin"?I2e:$G)(n,t,r,i)}function X2e(n,e,t){return(e.slice(-4)===".bin"?dve:IG)(n,t)}function q2e(n,e,t){return(e.slice(-4)===".bin"?V_e:TG)(n,t)}function Y2e(n,e,t){return(e.slice(-4)===".bin"?kve:LG)(n)}function Z2e(n){return(n.slice(-4)===".bin"?vve:NG)()}function J2e(n,e){var t=[];return n.Props&&t.push(Xxe(n.Props,e)),n.Custprops&&t.push(qxe(n.Props,n.Custprops)),t.join("")}function Q2e(){return""}function eSe(n,e){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(r,i){var s=[];s.push(at("NumberFormat",null,{"ss:Format":er(Gr[r.numFmtId])}));var a={"ss:ID":"s"+(21+i)};t.push(at("Style",s.join(""),a))}),at("Styles",t.join(""))}function XG(n){return at("NamedRange",null,{"ss:Name":n.Name,"ss:RefersTo":"="+EC(n.Ref,{r:0,c:0})})}function tSe(n){if(!((n||{}).Workbook||{}).Names)return"";for(var e=n.Workbook.Names,t=[],r=0;r<e.length;++r){var i=e[r];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||t.push(XG(i)))}return at("Names",t.join(""))}function nSe(n,e,t,r){if(!n||!((r||{}).Workbook||{}).Names)return"";for(var i=r.Workbook.Names,s=[],a=0;a<i.length;++a){var o=i[a];o.Sheet==t&&(o.Name.match(/^_xlfn\./)||s.push(XG(o)))}return s.join("")}function rSe(n,e,t,r){if(!n)return"";var i=[];if(n["!margins"]&&(i.push("<PageSetup>"),n["!margins"].header&&i.push(at("Header",null,{"x:Margin":n["!margins"].header})),n["!margins"].footer&&i.push(at("Footer",null,{"x:Margin":n["!margins"].footer})),i.push(at("PageMargins",null,{"x:Bottom":n["!margins"].bottom||"0.75","x:Left":n["!margins"].left||"0.7","x:Right":n["!margins"].right||"0.7","x:Top":n["!margins"].top||"0.75"})),i.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[t])if(r.Workbook.Sheets[t].Hidden)i.push(at("Visible",r.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<t&&!(r.Workbook.Sheets[s]&&!r.Workbook.Sheets[s].Hidden);++s);s==t&&i.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),n["!protect"]&&(i.push(Wi("ProtectContents","True")),n["!protect"].objects&&i.push(Wi("ProtectObjects","True")),n["!protect"].scenarios&&i.push(Wi("ProtectScenarios","True")),n["!protect"].selectLockedCells!=null&&!n["!protect"].selectLockedCells?i.push(Wi("EnableSelection","NoSelection")):n["!protect"].selectUnlockedCells!=null&&!n["!protect"].selectUnlockedCells&&i.push(Wi("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){n["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),i.length==0?"":at("WorksheetOptions",i.join(""),{xmlns:oa.x})}function iSe(n){return n.map(function(e){var t=lxe(e.t||""),r=at("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return at("Comment",r,{"ss:Author":e.a})}).join("")}function sSe(n,e,t,r,i,s,a){if(!n||n.v==null&&n.f==null)return"";var o={};if(n.f&&(o["ss:Formula"]="="+er(EC(n.f,a))),n.F&&n.F.slice(0,e.length)==e){var l=ki(n.F.slice(e.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==a.r?"":"["+(l.r-a.r)+"]")+"C"+(l.c==a.c?"":"["+(l.c-a.c)+"]")}if(n.l&&n.l.Target&&(o["ss:HRef"]=er(n.l.Target),n.l.Tooltip&&(o["x:HRefScreenTip"]=er(n.l.Tooltip))),t["!merges"])for(var c=t["!merges"],h=0;h!=c.length;++h)c[h].s.c!=a.c||c[h].s.r!=a.r||(c[h].e.c>c[h].s.c&&(o["ss:MergeAcross"]=c[h].e.c-c[h].s.c),c[h].e.r>c[h].s.r&&(o["ss:MergeDown"]=c[h].e.r-c[h].s.r));var g="",m="";switch(n.t){case"z":if(!r.sheetStubs)return"";break;case"n":g="Number",m=String(n.v);break;case"b":g="Boolean",m=n.v?"1":"0";break;case"e":g="Error",m=oy[n.v];break;case"d":g="DateTime",m=new Date(n.v).toISOString(),n.z==null&&(n.z=n.z||Gr[14]);break;case"s":g="String",m=oxe(n.v||"");break}var y=Qu(r.cellXfs,n,r);o["ss:StyleID"]="s"+(21+y),o["ss:Index"]=a.c+1;var _=n.v!=null?m:"",x=n.t=="z"?"":'<Data ss:Type="'+g+'">'+_+"</Data>";return(n.c||[]).length>0&&(x+=iSe(n.c)),at("Cell",x,o)}function aSe(n,e){var t='<Row ss:Index="'+(n+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=kG(e.hpt)),e.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(t+=' ss:Hidden="1"')),t+">"}function oSe(n,e,t,r){if(!n["!ref"])return"";var i=pr(n["!ref"]),s=n["!merges"]||[],a=0,o=[];n["!cols"]&&n["!cols"].forEach(function(w,b){vC(w);var T=!!w.width,k=zE(b,w),L={"ss:Index":b+1};T&&(L["ss:Width"]=hw(k.width)),w.hidden&&(L["ss:Hidden"]="1"),o.push(at("Column",null,L))});for(var l=Array.isArray(n),c=i.s.r;c<=i.e.r;++c){for(var h=[aSe(c,(n["!rows"]||[])[c])],g=i.s.c;g<=i.e.c;++g){var m=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>g)&&!(s[a].s.r>c)&&!(s[a].e.c<g)&&!(s[a].e.r<c)){(s[a].s.c!=g||s[a].s.r!=c)&&(m=!0);break}if(!m){var y={r:c,c:g},_=nr(y),x=l?(n[c]||[])[g]:n[_];h.push(sSe(x,_,n,e,t,r,y))}}h.push("</Row>"),h.length>2&&o.push(h.join(""))}return o.join("")}function lSe(n,e,t){var r=[],i=t.SheetNames[n],s=t.Sheets[i],a=s?nSe(s,e,n,t):"";return a.length>0&&r.push("<Names>"+a+"</Names>"),a=s?oSe(s,e,n,t):"",a.length>0&&r.push("<Table>"+a+"</Table>"),r.push(rSe(s,e,n,t)),r.join("")}function cSe(n,e){e||(e={}),n.SSF||(n.SSF=Ks(Gr)),n.SSF&&(jE(),DE(n.SSF),e.revssf=FE(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF,e.cellXfs=[],Qu(e.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(J2e(n,e)),t.push(Q2e()),t.push(""),t.push("");for(var r=0;r<n.SheetNames.length;++r)t.push(at("Worksheet",lSe(r,e,n),{"ss:Name":er(n.SheetNames[r])}));return t[2]=eSe(n,e),t[3]=tSe(n),ai+at("Workbook",t.join(""),{xmlns:oa.ss,"xmlns:o":oa.o,"xmlns:x":oa.x,"xmlns:ss":oa.ss,"xmlns:dt":oa.dt,"xmlns:html":oa.html})}var Ub={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function uSe(n,e){var t=[],r=[],i=[],s=0,a,o=TO(FO,"n"),l=TO(VO,"n");if(n.Props)for(a=Xi(n.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?t:Object.prototype.hasOwnProperty.call(l,a[s])?r:i).push([a[s],n.Props[a[s]]]);if(n.Custprops)for(a=Xi(n.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(n.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?t:Object.prototype.hasOwnProperty.call(l,a[s])?r:i).push([a[s],n.Custprops[a[s]]]);var c=[];for(s=0;s<i.length;++s)xG.indexOf(i[s][0])>-1||mG.indexOf(i[s][0])>-1||i[s][1]!=null&&c.push(i[s]);r.length&&rr.utils.cfb_add(e,"/SummaryInformation",$O(r,Ub.SI,l,VO)),(t.length||c.length)&&rr.utils.cfb_add(e,"/DocumentSummaryInformation",$O(t,Ub.DSI,o,FO,c.length?c:null,Ub.UDI))}function hSe(n,e){var t=e||{},r=rr.utils.cfb_new({root:"R"}),i="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":i="/Workbook",t.biff=8;break;case"biff5":i="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return rr.utils.cfb_add(r,i,qG(n,t)),t.biff==8&&(n.Props||n.Custprops)&&uSe(n,r),t.biff==8&&n.vbaraw&&Ive(r,rr.read(n.vbaraw,{type:typeof n.vbaraw=="string"?"binary":"buffer"})),r}var dSe={0:{f:mEe},1:{f:SEe},2:{f:UEe},3:{f:PEe},4:{f:AEe},5:{f:VEe},6:{f:XEe},7:{f:OEe},8:{f:t2e},9:{f:e2e},10:{f:JEe},11:{f:QEe},12:{f:TEe},13:{f:WEe},14:{f:MEe},15:{f:IEe},16:{f:GEe},17:{f:YEe},18:{f:jEe},19:{f:pC},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:B2e},40:{},42:{},43:{f:X_e},44:{f:H_e},45:{f:Z_e},46:{f:Q_e},47:{f:J_e},48:{},49:{f:Txe},50:{},51:{f:mve},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:R_e},62:{f:KEe},63:{f:wve},64:{f:y2e},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:ml,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:f2e},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:wEe},148:{f:xEe,p:16},151:{f:o2e},152:{},153:{f:F2e},154:{},155:{},156:{f:D2e},157:{},158:{},159:{T:1,f:D_e},160:{T:-1},161:{T:1,f:$d},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:n2e},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:fve},336:{T:-1},337:{f:xve,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:WR},357:{},358:{},359:{},360:{T:1},361:{},362:{f:v_e},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:l2e},427:{f:c2e},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:h2e},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:vEe},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:s2e},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:WR},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Rve},633:{T:1},634:{T:-1},635:{T:1,f:bve},636:{T:-1},637:{f:Ixe},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:C2e},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:x2e},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function ot(n,e,t,r){var i=e;if(!isNaN(i)){var s=r||(t||[]).length||0,a=n.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&fC(t)&&n.push(t)}}function fSe(n,e,t,r){var i=(t||[]).length||0;if(i<=8224)return ot(n,e,t,i);var s=e;if(!isNaN(s)){for(var a=t.parts||[],o=0,l=0,c=0;c+(a[o]||8224)<=8224;)c+=a[o]||8224,o++;var h=n.next(4);for(h.write_shift(2,s),h.write_shift(2,c),n.push(t.slice(l,l+c)),l+=c;l<i;){for(h=n.next(4),h.write_shift(2,60),c=0;c+(a[o]||8224)<=8224;)c+=a[o]||8224,o++;h.write_shift(2,c),n.push(t.slice(l,l+c)),l+=c}}}function cy(n,e,t){return n||(n=Le(7)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,0),n.write_shift(1,0),n}function gSe(n,e,t,r){var i=Le(9);return cy(i,n,e),vG(t,r||"b",i),i}function mSe(n,e,t){var r=Le(8+2*t.length);return cy(r,n,e),r.write_shift(1,t.length),r.write_shift(t.length,t,"sbcs"),r.l<r.length?r.slice(0,r.l):r}function pSe(n,e,t,r){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?Hs(Ts(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?ot(n,2,C_e(t,r,i)):ot(n,3,I_e(t,r,i));return;case"b":case"e":ot(n,5,gSe(t,r,e.v,e.t));return;case"s":case"str":ot(n,4,mSe(t,r,(e.v||"").slice(0,255)));return}ot(n,1,cy(null,t,r))}function ySe(n,e,t,r){var i=Array.isArray(e),s=pr(e["!ref"]||"A1"),a,o="",l=[];if(s.e.c>255||s.e.r>16383){if(r.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=ii(s)}for(var c=s.s.r;c<=s.e.r;++c){o=Ki(c);for(var h=s.s.c;h<=s.e.c;++h){c===s.s.r&&(l[h]=gs(h)),a=l[h]+o;var g=i?(e[c]||[])[h]:e[a];g&&pSe(n,g,c,h)}}}function xSe(n,e){for(var t=e||{},r=Gs(),i=0,s=0;s<n.SheetNames.length;++s)n.SheetNames[s]==t.sheet&&(i=s);if(i==0&&t.sheet&&n.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return ot(r,t.biff==4?1033:t.biff==3?521:9,_C(n,16,t)),ySe(r,n.Sheets[n.SheetNames[i]],i,t),ot(r,10),r.end()}function _Se(n,e,t){ot(n,49,d_e({sz:12,name:"Arial"},t))}function vSe(n,e,t){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)e[i]!=null&&ot(n,1054,m_e(i,e[i],t))})}function wSe(n,e){var t=Le(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),ot(n,2151,t),t=Le(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),SG(pr(e["!ref"]||"A1"),t),t.write_shift(4,4),ot(n,2152,t)}function ESe(n,e){for(var t=0;t<16;++t)ot(n,224,HO({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(r){ot(n,224,HO(r,0,e))})}function SSe(n,e){for(var t=0;t<e["!links"].length;++t){var r=e["!links"][t];ot(n,440,S_e(r)),r[1].Tooltip&&ot(n,2048,b_e(r))}delete e["!links"]}function bSe(n,e){if(e){var t=0;e.forEach(function(r,i){++t<=256&&r&&ot(n,125,A_e(zE(i,r),i))})}}function TSe(n,e,t,r,i){var s=16+Qu(i.cellXfs,e,i);if(e.v==null&&!e.bf){ot(n,513,Ad(t,r,s));return}if(e.bf)ot(n,6,qwe(e,t,r,i,s));else switch(e.t){case"d":case"n":var a=e.t=="d"?Hs(Ts(e.v)):e.v;ot(n,515,__e(t,r,a,s));break;case"b":case"e":ot(n,517,x_e(t,r,e.v,s,i,e.t));break;case"s":case"str":if(i.bookSST){var o=bC(i.Strings,e.v,i.revStrings);ot(n,253,f_e(t,r,o,s))}else ot(n,516,g_e(t,r,(e.v||"").slice(0,255),s,i));break;default:ot(n,513,Ad(t,r,s))}}function RSe(n,e,t){var r=Gs(),i=t.SheetNames[n],s=t.Sheets[i]||{},a=(t||{}).Workbook||{},o=(a.Sheets||[])[n]||{},l=Array.isArray(s),c=e.biff==8,h,g="",m=[],y=pr(s["!ref"]||"A1"),_=c?65536:16384;if(y.e.c>255||y.e.r>=_){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");y.e.c=Math.min(y.e.c,255),y.e.r=Math.min(y.e.c,_-1)}ot(r,2057,_C(t,16,e)),ot(r,13,Pa(1)),ot(r,12,Pa(100)),ot(r,15,_s(!0)),ot(r,17,_s(!1)),ot(r,16,Rd(.001)),ot(r,95,_s(!0)),ot(r,42,_s(!1)),ot(r,43,_s(!1)),ot(r,130,Pa(1)),ot(r,128,y_e()),ot(r,131,_s(!1)),ot(r,132,_s(!1)),c&&bSe(r,s["!cols"]),ot(r,512,p_e(y,e)),c&&(s["!links"]=[]);for(var x=y.s.r;x<=y.e.r;++x){g=Ki(x);for(var w=y.s.c;w<=y.e.c;++w){x===y.s.r&&(m[w]=gs(w)),h=m[w]+g;var b=l?(s[x]||[])[w]:s[h];b&&(TSe(r,b,x,w,e),c&&b.l&&s["!links"].push([h,b.l]))}}var T=o.CodeName||o.name||i;return c&&ot(r,574,h_e((a.Views||[])[0])),c&&(s["!merges"]||[]).length&&ot(r,229,E_e(s["!merges"])),c&&SSe(r,s),ot(r,442,EG(T)),c&&wSe(r,s),ot(r,10),r.end()}function ASe(n,e,t){var r=Gs(),i=(n||{}).Workbook||{},s=i.Sheets||[],a=i.WBProps||{},o=t.biff==8,l=t.biff==5;if(ot(r,2057,_C(n,5,t)),t.bookType=="xla"&&ot(r,135),ot(r,225,o?Pa(1200):null),ot(r,193,Jxe(2)),l&&ot(r,191),l&&ot(r,192),ot(r,226),ot(r,92,o_e("SheetJS",t)),ot(r,66,Pa(o?1200:1252)),o&&ot(r,353,Pa(0)),o&&ot(r,448),ot(r,317,k_e(n.SheetNames.length)),o&&n.vbaraw&&ot(r,211),o&&n.vbaraw){var c=a.CodeName||"ThisWorkbook";ot(r,442,EG(c))}ot(r,156,Pa(17)),ot(r,25,_s(!1)),ot(r,18,_s(!1)),ot(r,19,Pa(0)),o&&ot(r,431,_s(!1)),o&&ot(r,444,Pa(0)),ot(r,61,u_e()),ot(r,64,_s(!1)),ot(r,141,Pa(0)),ot(r,34,_s(N2e(n)=="true")),ot(r,14,_s(!0)),o&&ot(r,439,_s(!1)),ot(r,218,Pa(0)),_Se(r,n,t),vSe(r,n.SSF,t),ESe(r,t),o&&ot(r,352,_s(!1));var h=r.end(),g=Gs();o&&ot(g,140,T_e()),o&&t.Strings&&fSe(g,252,c_e(t.Strings)),ot(g,10);var m=g.end(),y=Gs(),_=0,x=0;for(x=0;x<n.SheetNames.length;++x)_+=(o?12:11)+(o?2:1)*n.SheetNames[x].length;var w=h.length+_+m.length;for(x=0;x<n.SheetNames.length;++x){var b=s[x]||{};ot(y,133,l_e({pos:w,hs:b.Hidden||0,dt:0,name:n.SheetNames[x]},t)),w+=e[x].length}var T=y.end();if(_!=T.length)throw new Error("BS8 "+_+" != "+T.length);var k=[];return h.length&&k.push(h),T.length&&k.push(T),m.length&&k.push(m),$i(k)}function kSe(n,e){var t=e||{},r=[];n&&!n.SSF&&(n.SSF=Ks(Gr)),n&&n.SSF&&(jE(),DE(n.SSF),t.revssf=FE(n.SSF),t.revssf[n.SSF[65535]]=0,t.ssf=n.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,TC(t),t.cellXfs=[],Qu(t.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={});for(var i=0;i<n.SheetNames.length;++i)r[r.length]=RSe(i,t,n);return r.unshift(ASe(n,r,t)),$i(r)}function qG(n,e){for(var t=0;t<=n.SheetNames.length;++t){var r=n.Sheets[n.SheetNames[t]];if(!(!r||!r["!ref"])){var i=ya(r["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+n.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return kSe(n,e);case 4:case 3:case 2:return xSe(n,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function ISe(n,e,t,r){for(var i=n["!merges"]||[],s=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,l=0,c=0;c<i.length;++c)if(!(i[c].s.r>t||i[c].s.c>a)&&!(i[c].e.r<t||i[c].e.c<a)){if(i[c].s.r<t||i[c].s.c<a){o=-1;break}o=i[c].e.r-i[c].s.r+1,l=i[c].e.c-i[c].s.c+1;break}if(!(o<0)){var h=nr({r:t,c:a}),g=r.dense?(n[t]||[])[a]:n[h],m=g&&g.v!=null&&(g.h||axe(g.w||(fc(g),g.w)||""))||"",y={};o>1&&(y.rowspan=o),l>1&&(y.colspan=l),r.editable?m='<span contenteditable="true">'+m+"</span>":g&&(y["data-t"]=g&&g.t||"z",g.v!=null&&(y["data-v"]=g.v),g.z!=null&&(y["data-z"]=g.z),g.l&&(g.l.Target||"#").charAt(0)!="#"&&(m='<a href="'+g.l.Target+'">'+m+"</a>")),y.id=(r.id||"sjs")+"-"+h,s.push(at("td",m,y))}}var _="<tr>";return _+s.join("")+"</tr>"}var CSe='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',PSe="</body></html>";function NSe(n,e,t){var r=[];return r.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function YG(n,e){var t=e||{},r=t.header!=null?t.header:CSe,i=t.footer!=null?t.footer:PSe,s=[r],a=ya(n["!ref"]);t.dense=Array.isArray(n),s.push(NSe(n,a,t));for(var o=a.s.r;o<=a.e.r;++o)s.push(ISe(n,a,o,t));return s.push("</table>"+i),s.join("")}function ZG(n,e,t){var r=t||{},i=0,s=0;if(r.origin!=null)if(typeof r.origin=="number")i=r.origin;else{var a=typeof r.origin=="string"?ki(r.origin):r.origin;i=a.r,s=a.c}var o=e.getElementsByTagName("tr"),l=Math.min(r.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:i,c:s}};if(n["!ref"]){var h=ya(n["!ref"]);c.s.r=Math.min(c.s.r,h.s.r),c.s.c=Math.min(c.s.c,h.s.c),c.e.r=Math.max(c.e.r,h.e.r),c.e.c=Math.max(c.e.c,h.e.c),i==-1&&(c.e.r=i=h.e.r+1)}var g=[],m=0,y=n["!rows"]||(n["!rows"]=[]),_=0,x=0,w=0,b=0,T=0,k=0;for(n["!cols"]||(n["!cols"]=[]);_<o.length&&x<l;++_){var L=o[_];if(QO(L)){if(r.display)continue;y[x]={hidden:!0}}var O=L.children;for(w=b=0;w<O.length;++w){var B=O[w];if(!(r.display&&QO(B))){var R=B.hasAttribute("data-v")?B.getAttribute("data-v"):B.hasAttribute("v")?B.getAttribute("v"):uxe(B.innerHTML),A=B.getAttribute("data-z")||B.getAttribute("z");for(m=0;m<g.length;++m){var P=g[m];P.s.c==b+s&&P.s.r<x+i&&x+i<=P.e.r&&(b=P.e.c+1-s,m=-1)}k=+B.getAttribute("colspan")||1,((T=+B.getAttribute("rowspan")||1)>1||k>1)&&g.push({s:{r:x+i,c:b+s},e:{r:x+i+(T||1)-1,c:b+s+(k||1)-1}});var D={t:"s",v:R},N=B.getAttribute("data-t")||B.getAttribute("t")||"";R!=null&&(R.length==0?D.t=N||"z":r.raw||R.trim().length==0||N=="s"||(R==="TRUE"?D={t:"b",v:!0}:R==="FALSE"?D={t:"b",v:!1}:isNaN(nc(R))?isNaN(l1(R).getDate())||(D={t:"d",v:Ts(R)},r.cellDates||(D={t:"n",v:Hs(D.v)}),D.z=r.dateNF||Gr[14]):D={t:"n",v:nc(R)})),D.z===void 0&&A!=null&&(D.z=A);var G="",j=B.getElementsByTagName("A");if(j&&j.length)for(var ve=0;ve<j.length&&!(j[ve].hasAttribute("href")&&(G=j[ve].getAttribute("href"),G.charAt(0)!="#"));++ve);G&&G.charAt(0)!="#"&&(D.l={Target:G}),r.dense?(n[x+i]||(n[x+i]=[]),n[x+i][b+s]=D):n[nr({c:b+s,r:x+i})]=D,c.e.c<b+s&&(c.e.c=b+s),b+=k}}++x}return g.length&&(n["!merges"]=(n["!merges"]||[]).concat(g)),c.e.r=Math.max(c.e.r,x-1+i),n["!ref"]=ii(c),x>=l&&(n["!fullref"]=ii((c.e.r=o.length-_+x-1+i,c))),n}function JG(n,e){var t=e||{},r=t.dense?[]:{};return ZG(r,n,e)}function MSe(n,e){return Bd(JG(n,e),e)}function QO(n){var e="",t=LSe(n);return t&&(e=t(n).getPropertyValue("display")),e||(e=n.style&&n.style.display),e==="none"}function LSe(n){return n.ownerDocument.defaultView&&typeof n.ownerDocument.defaultView.getComputedStyle=="function"?n.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var OSe=(function(){var n=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+u1({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+n+"</office:document-styles>";return function(){return ai+e}})(),eD=(function(){var n=function(s){return er(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,r=function(s,a,o){var l=[];l.push('      <table:table table:name="'+er(a.SheetNames[o])+`" table:style-name="ta1">
`);var c=0,h=0,g=ya(s["!ref"]||"A1"),m=s["!merges"]||[],y=0,_=Array.isArray(s);if(s["!cols"])for(h=0;h<=g.e.c;++h)l.push("        <table:table-column"+(s["!cols"][h]?' table:style-name="co'+s["!cols"][h].ods+'"':"")+`></table:table-column>
`);var x="",w=s["!rows"]||[];for(c=0;c<g.s.r;++c)x=w[c]?' table:style-name="ro'+w[c].ods+'"':"",l.push("        <table:table-row"+x+`></table:table-row>
`);for(;c<=g.e.r;++c){for(x=w[c]?' table:style-name="ro'+w[c].ods+'"':"",l.push("        <table:table-row"+x+`>
`),h=0;h<g.s.c;++h)l.push(e);for(;h<=g.e.c;++h){var b=!1,T={},k="";for(y=0;y!=m.length;++y)if(!(m[y].s.c>h)&&!(m[y].s.r>c)&&!(m[y].e.c<h)&&!(m[y].e.r<c)){(m[y].s.c!=h||m[y].s.r!=c)&&(b=!0),T["table:number-columns-spanned"]=m[y].e.c-m[y].s.c+1,T["table:number-rows-spanned"]=m[y].e.r-m[y].s.r+1;break}if(b){l.push(t);continue}var L=nr({r:c,c:h}),O=_?(s[c]||[])[h]:s[L];if(O&&O.f&&(T["table:formula"]=er(tEe(O.f)),O.F&&O.F.slice(0,L.length)==L)){var B=ya(O.F);T["table:number-matrix-columns-spanned"]=B.e.c-B.s.c+1,T["table:number-matrix-rows-spanned"]=B.e.r-B.s.r+1}if(!O){l.push(e);continue}switch(O.t){case"b":k=O.v?"TRUE":"FALSE",T["office:value-type"]="boolean",T["office:boolean-value"]=O.v?"true":"false";break;case"n":k=O.w||String(O.v||0),T["office:value-type"]="float",T["office:value"]=O.v||0;break;case"s":case"str":k=O.v==null?"":O.v,T["office:value-type"]="string";break;case"d":k=O.w||Ts(O.v).toISOString(),T["office:value-type"]="date",T["office:date-value"]=Ts(O.v).toISOString(),T["table:style-name"]="ce1";break;default:l.push(e);continue}var R=n(k);if(O.l&&O.l.Target){var A=O.l.Target;A=A.charAt(0)=="#"?"#"+nEe(A.slice(1)):A,A.charAt(0)!="#"&&!A.match(/^\w+:/)&&(A="../"+A),R=at("text:a",R,{"xlink:href":A.replace(/&/g,"&amp;")})}l.push("          "+at("table:table-cell",at("text:p",R,{}),T)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var h=0;h<c["!cols"].length;++h)if(c["!cols"][h]){var g=c["!cols"][h];if(g.width==null&&g.wpx==null&&g.wch==null)continue;vC(g),g.ods=o;var m=c["!cols"][h].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+m+`"/>
`),s.push(`  </style:style>
`),++o}}});var l=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var h=0;h<c["!rows"].length;++h)if(c["!rows"][h]){c["!rows"][h].ods=l;var g=c["!rows"][h].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+g+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,o){var l=[ai],c=u1({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),h=u1({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+c+h+`>
`),l.push(fG().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+c+`>
`),i(l,a),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var g=0;g!=a.SheetNames.length;++g)l.push(r(a.Sheets[a.SheetNames[g]],a,g));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}})();function QG(n,e){if(e.bookType=="fods")return eD(n,e);var t=cC(),r="",i=[],s=[];return r="mimetype",cn(t,r,"application/vnd.oasis.opendocument.spreadsheet"),r="content.xml",cn(t,r,eD(n,e)),i.push([r,"text/xml"]),s.push([r,"ContentFile"]),r="styles.xml",cn(t,r,OSe(n,e)),i.push([r,"text/xml"]),s.push([r,"StylesFile"]),r="meta.xml",cn(t,r,ai+fG()),i.push([r,"text/xml"]),s.push([r,"MetadataFile"]),r="manifest.rdf",cn(t,r,Kxe(s)),i.push([r,"application/rdf+xml"]),r="META-INF/manifest.xml",cn(t,r,Wxe(i)),t}function gw(n){return new DataView(n.buffer,n.byteOffset,n.byteLength)}function DSe(n){return typeof TextEncoder<"u"?new TextEncoder().encode(n):ho(c1(n))}function jSe(n,e){e:for(var t=0;t<=n.length-e.length;++t){for(var r=0;r<e.length;++r)if(n[t+r]!=e[r])continue e;return!0}return!1}function Hu(n){var e=n.reduce(function(i,s){return i+s.length},0),t=new Uint8Array(e),r=0;return n.forEach(function(i){t.set(i,r),r+=i.length}),t}function FSe(n,e,t){var r=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,i=t/Math.pow(10,r-6176);n[e+15]|=r>>7,n[e+14]|=(r&127)<<1;for(var s=0;i>=1;++s,i/=256)n[e+s]=i&255;n[e+15]|=t>=0?0:128}function h1(n,e){var t=e?e[0]:0,r=n[t]&127;e:if(n[t++]>=128&&(r|=(n[t]&127)<<7,n[t++]<128||(r|=(n[t]&127)<<14,n[t++]<128)||(r|=(n[t]&127)<<21,n[t++]<128)||(r+=(n[t]&127)*Math.pow(2,28),++t,n[t++]<128)||(r+=(n[t]&127)*Math.pow(2,35),++t,n[t++]<128)||(r+=(n[t]&127)*Math.pow(2,42),++t,n[t++]<128)))break e;return e&&(e[0]=t),r}function qn(n){var e=new Uint8Array(7);e[0]=n&127;var t=1;e:if(n>127){if(e[t-1]|=128,e[t]=n>>7&127,++t,n<=16383||(e[t-1]|=128,e[t]=n>>14&127,++t,n<=2097151)||(e[t-1]|=128,e[t]=n>>21&127,++t,n<=268435455)||(e[t-1]|=128,e[t]=n/256>>>21&127,++t,n<=34359738367)||(e[t-1]|=128,e[t]=n/65536>>>21&127,++t,n<=4398046511103))break e;e[t-1]|=128,e[t]=n/16777216>>>21&127,++t}return e.slice(0,t)}function I0(n){var e=0,t=n[e]&127;e:if(n[e++]>=128){if(t|=(n[e]&127)<<7,n[e++]<128||(t|=(n[e]&127)<<14,n[e++]<128)||(t|=(n[e]&127)<<21,n[e++]<128))break e;t|=(n[e]&127)<<28}return t}function hi(n){for(var e=[],t=[0];t[0]<n.length;){var r=t[0],i=h1(n,t),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var l=t[0];n[t[0]++]>=128;);o=n.slice(l,t[0])}break;case 5:a=4,o=n.slice(t[0],t[0]+a),t[0]+=a;break;case 1:a=8,o=n.slice(t[0],t[0]+a),t[0]+=a;break;case 2:a=h1(n,t),o=n.slice(t[0],t[0]+a),t[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(r))}var c={data:o,type:s};e[i]==null?e[i]=[c]:e[i].push(c)}return e}function ji(n){var e=[];return n.forEach(function(t,r){t.forEach(function(i){i.data&&(e.push(qn(r*8+i.type)),i.type==2&&e.push(qn(i.data.length)),e.push(i.data))})}),Hu(e)}function no(n){for(var e,t=[],r=[0];r[0]<n.length;){var i=h1(n,r),s=hi(n.slice(r[0],r[0]+i));r[0]+=i;var a={id:I0(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=hi(o.data),c=I0(l[3][0].data);a.messages.push({meta:l,data:n.slice(r[0],r[0]+c)}),r[0]+=c}),(e=s[3])!=null&&e[0]&&(a.merge=I0(s[3][0].data)>>>0>0),t.push(a)}return t}function Bf(n){var e=[];return n.forEach(function(t){var r=[];r[1]=[{data:qn(t.id),type:0}],r[2]=[],t.merge!=null&&(r[3]=[{data:qn(+!!t.merge),type:0}]);var i=[];t.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:qn(a.data.length)}],r[2].push({data:ji(a.meta),type:2})});var s=ji(r);e.push(qn(s.length)),e.push(s),i.forEach(function(a){return e.push(a)})}),Hu(e)}function VSe(n,e){if(n!=0)throw new Error("Unexpected Snappy chunk type ".concat(n));for(var t=[0],r=h1(e,t),i=[];t[0]<e.length;){var s=e[t[0]]&3;if(s==0){var a=e[t[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[t[0]],o>1&&(a|=e[t[0]+1]<<8),o>2&&(a|=e[t[0]+2]<<16),o>3&&(a|=e[t[0]+3]<<24),a>>>=0,a++,t[0]+=o}i.push(e.slice(t[0],t[0]+a)),t[0]+=a;continue}else{var l=0,c=0;if(s==1?(c=(e[t[0]]>>2&7)+4,l=(e[t[0]++]&224)<<3,l|=e[t[0]++]):(c=(e[t[0]++]>>2)+1,s==2?(l=e[t[0]]|e[t[0]+1]<<8,t[0]+=2):(l=(e[t[0]]|e[t[0]+1]<<8|e[t[0]+2]<<16|e[t[0]+3]<<24)>>>0,t[0]+=4)),i=[Hu(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(i.push(i[0].slice(-l)),c-=l;c>=i[i.length-1].length;)i.push(i[i.length-1]),c-=i[i.length-1].length;i.push(i[0].slice(-l,-l+c))}}var h=Hu(i);if(h.length!=r)throw new Error("Unexpected length: ".concat(h.length," != ").concat(r));return h}function ro(n){for(var e=[],t=0;t<n.length;){var r=n[t++],i=n[t]|n[t+1]<<8|n[t+2]<<16;t+=3,e.push(VSe(r,n.slice(t,t+i))),t+=i}if(t!==n.length)throw new Error("data is not a valid framed stream!");return Hu(e)}function Gf(n){for(var e=[],t=0;t<n.length;){var r=Math.min(n.length-t,268435455),i=new Uint8Array(4);e.push(i);var s=qn(r),a=s.length;e.push(s),r<=60?(a++,e.push(new Uint8Array([r-1<<2]))):r<=256?(a+=2,e.push(new Uint8Array([240,r-1&255]))):r<=65536?(a+=3,e.push(new Uint8Array([244,r-1&255,r-1>>8&255]))):r<=16777216?(a+=4,e.push(new Uint8Array([248,r-1&255,r-1>>8&255,r-1>>16&255]))):r<=4294967296&&(a+=5,e.push(new Uint8Array([252,r-1&255,r-1>>8&255,r-1>>16&255,r-1>>>24&255]))),e.push(n.slice(t,t+r)),a+=r,i[0]=0,i[1]=a&255,i[2]=a>>8&255,i[3]=a>>16&255,t+=r}return Hu(e)}function $b(n,e){var t=new Uint8Array(32),r=gw(t),i=12,s=0;switch(t[0]=5,n.t){case"n":t[1]=2,FSe(t,i,n.v),s|=1,i+=16;break;case"b":t[1]=6,r.setFloat64(i,n.v?1:0,!0),s|=2,i+=8;break;case"s":if(e.indexOf(n.v)==-1)throw new Error("Value ".concat(n.v," missing from SST!"));t[1]=3,r.setUint32(i,e.indexOf(n.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+n.t}return r.setUint32(8,s,!0),t.slice(0,i)}function Wb(n,e){var t=new Uint8Array(32),r=gw(t),i=12,s=0;switch(t[0]=3,n.t){case"n":t[2]=2,r.setFloat64(i,n.v,!0),s|=32,i+=8;break;case"b":t[2]=6,r.setFloat64(i,n.v?1:0,!0),s|=32,i+=8;break;case"s":if(e.indexOf(n.v)==-1)throw new Error("Value ".concat(n.v," missing from SST!"));t[2]=3,r.setUint32(i,e.indexOf(n.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+n.t}return r.setUint32(4,s,!0),t.slice(0,i)}function Qc(n){var e=hi(n);return h1(e[1][0].data)}function BSe(n,e,t){var r,i,s,a;if(!((r=n[6])!=null&&r[0])||!((i=n[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(s=n[8])==null?void 0:s[0])==null?void 0:a.data)&&I0(n[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,c=gw(n[7][0].data),h=0,g=[],m=gw(n[4][0].data),y=0,_=[],x=0;x<e.length;++x){if(e[x]==null){c.setUint16(x*2,65535,!0),m.setUint16(x*2,65535);continue}c.setUint16(x*2,h,!0),m.setUint16(x*2,y,!0);var w,b;switch(typeof e[x]){case"string":w=$b({t:"s",v:e[x]},t),b=Wb({t:"s",v:e[x]},t);break;case"number":w=$b({t:"n",v:e[x]},t),b=Wb({t:"n",v:e[x]},t);break;case"boolean":w=$b({t:"b",v:e[x]},t),b=Wb({t:"b",v:e[x]},t);break;default:throw new Error("Unsupported value "+e[x])}g.push(w),h+=w.length,_.push(b),y+=b.length,++l}for(n[2][0].data=qn(l);x<n[7][0].data.length/2;++x)c.setUint16(x*2,65535,!0),m.setUint16(x*2,65535,!0);return n[6][0].data=Hu(g),n[3][0].data=Hu(_),l}function GSe(n,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=n.Sheets[n.SheetNames[0]];n.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var r=ya(t["!ref"]);r.s.r=r.s.c=0;var i=!1;r.e.c>9&&(i=!0,r.e.c=9),r.e.r>49&&(i=!0,r.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(ii(r)));var s=mw(t,{range:r,header:1}),a=["~Sh33tJ5~"];s.forEach(function(J){return J.forEach(function(te){typeof te=="string"&&a.push(te)})});var o={},l=[],c=rr.read(e.numbers,{type:"base64"});c.FileIndex.map(function(J,te){return[J,c.FullPaths[te]]}).forEach(function(J){var te=J[0],re=J[1];if(te.type==2&&te.name.match(/\.iwa/)){var he=te.content,Be=ro(he),Ge=no(Be);Ge.forEach(function(ye){l.push(ye.id),o[ye.id]={deps:[],location:re,type:I0(ye.messages[0].meta[1][0].data)}})}}),l.sort(function(J,te){return J-te});var h=l.filter(function(J){return J>1}).map(function(J){return[J,qn(J)]});c.FileIndex.map(function(J,te){return[J,c.FullPaths[te]]}).forEach(function(J){var te=J[0];if(J[1],!!te.name.match(/\.iwa/)){var re=no(ro(te.content));re.forEach(function(he){he.messages.forEach(function(Be){h.forEach(function(Ge){he.messages.some(function(ye){return I0(ye.meta[1][0].data)!=11006&&jSe(ye.data,Ge[1])})&&o[Ge[0]].deps.push(he.id)})})})}});for(var g=rr.find(c,o[1].location),m=no(ro(g.content)),y,_=0;_<m.length;++_){var x=m[_];x.id==1&&(y=x)}var w=Qc(hi(y.messages[0].data)[1][0].data);for(g=rr.find(c,o[w].location),m=no(ro(g.content)),_=0;_<m.length;++_)x=m[_],x.id==w&&(y=x);for(w=Qc(hi(y.messages[0].data)[2][0].data),g=rr.find(c,o[w].location),m=no(ro(g.content)),_=0;_<m.length;++_)x=m[_],x.id==w&&(y=x);for(w=Qc(hi(y.messages[0].data)[2][0].data),g=rr.find(c,o[w].location),m=no(ro(g.content)),_=0;_<m.length;++_)x=m[_],x.id==w&&(y=x);var b=hi(y.messages[0].data);{b[6][0].data=qn(r.e.r+1),b[7][0].data=qn(r.e.c+1);var T=Qc(b[46][0].data),k=rr.find(c,o[T].location),L=no(ro(k.content));{for(var O=0;O<L.length&&L[O].id!=T;++O);if(L[O].id!=T)throw"Bad ColumnRowUIDMapArchive";var B=hi(L[O].messages[0].data);B[1]=[],B[2]=[],B[3]=[];for(var R=0;R<=r.e.c;++R){var A=[];A[1]=A[2]=[{type:0,data:qn(R+420690)}],B[1].push({type:2,data:ji(A)}),B[2].push({type:0,data:qn(R)}),B[3].push({type:0,data:qn(R)})}B[4]=[],B[5]=[],B[6]=[];for(var P=0;P<=r.e.r;++P)A=[],A[1]=A[2]=[{type:0,data:qn(P+726270)}],B[4].push({type:2,data:ji(A)}),B[5].push({type:0,data:qn(P)}),B[6].push({type:0,data:qn(P)});L[O].messages[0].data=ji(B)}k.content=Gf(Bf(L)),k.size=k.content.length,delete b[46];var D=hi(b[4][0].data);{D[7][0].data=qn(r.e.r+1);var N=hi(D[1][0].data),G=Qc(N[2][0].data);k=rr.find(c,o[G].location),L=no(ro(k.content));{if(L[0].id!=G)throw"Bad HeaderStorageBucket";var j=hi(L[0].messages[0].data);for(P=0;P<s.length;++P){var ve=hi(j[2][0].data);ve[1][0].data=qn(P),ve[4][0].data=qn(s[P].length),j[2][P]={type:j[2][0].type,data:ji(ve)}}L[0].messages[0].data=ji(j)}k.content=Gf(Bf(L)),k.size=k.content.length;var ce=Qc(D[2][0].data);k=rr.find(c,o[ce].location),L=no(ro(k.content));{if(L[0].id!=ce)throw"Bad HeaderStorageBucket";for(j=hi(L[0].messages[0].data),R=0;R<=r.e.c;++R)ve=hi(j[2][0].data),ve[1][0].data=qn(R),ve[4][0].data=qn(r.e.r+1),j[2][R]={type:j[2][0].type,data:ji(ve)};L[0].messages[0].data=ji(j)}k.content=Gf(Bf(L)),k.size=k.content.length;var je=Qc(D[4][0].data);(function(){for(var J=rr.find(c,o[je].location),te=no(ro(J.content)),re,he=0;he<te.length;++he){var Be=te[he];Be.id==je&&(re=Be)}var Ge=hi(re.messages[0].data);{Ge[3]=[];var ye=[];a.forEach(function(Ve,jt){ye[1]=[{type:0,data:qn(jt)}],ye[2]=[{type:0,data:qn(1)}],ye[3]=[{type:2,data:DSe(Ve)}],Ge[3].push({type:2,data:ji(ye)})})}re.messages[0].data=ji(Ge);var pe=Bf(te),Et=Gf(pe);J.content=Et,J.size=J.content.length})();var Pe=hi(D[3][0].data);{var ue=Pe[1][0];delete Pe[2];var Ne=hi(ue.data);{var be=Qc(Ne[2][0].data);(function(){for(var J=rr.find(c,o[be].location),te=no(ro(J.content)),re,he=0;he<te.length;++he){var Be=te[he];Be.id==be&&(re=Be)}var Ge=hi(re.messages[0].data);{delete Ge[6],delete Pe[7];var ye=new Uint8Array(Ge[5][0].data);Ge[5]=[];for(var pe=0,Et=0;Et<=r.e.r;++Et){var Ve=hi(ye);pe+=BSe(Ve,s[Et],a),Ve[1][0].data=qn(Et),Ge[5].push({data:ji(Ve),type:2})}Ge[1]=[{type:0,data:qn(r.e.c+1)}],Ge[2]=[{type:0,data:qn(r.e.r+1)}],Ge[3]=[{type:0,data:qn(pe)}],Ge[4]=[{type:0,data:qn(r.e.r+1)}]}re.messages[0].data=ji(Ge);var jt=Bf(te),St=Gf(jt);J.content=St,J.size=J.content.length})()}ue.data=ji(Ne)}D[3][0].data=ji(Pe)}b[4][0].data=ji(D)}y.messages[0].data=ji(b);var ie=Bf(m),V=Gf(ie);return g.content=V,g.size=g.content.length,c}function zSe(n){return function(t){for(var r=0;r!=n.length;++r){var i=n[r];t[i[0]]===void 0&&(t[i[0]]=i[1]),i[2]==="n"&&(t[i[0]]=Number(t[i[0]]))}}}function TC(n){zSe([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(n)}function USe(n,e){return e.bookType=="ods"?QG(n,e):e.bookType=="numbers"?GSe(n,e):e.bookType=="xlsb"?$Se(n,e):WSe(n,e)}function $Se(n,e){h0=1024,n&&!n.SSF&&(n.SSF=Ks(Gr)),n&&n.SSF&&(jE(),DE(n.SSF),e.revssf=FE(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,pp?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t=e.bookType=="xlsb"?"bin":"xml",r=OG.indexOf(e.bookType)>-1,i=uG();TC(e=e||{});var s=cC(),a="",o=0;if(e.cellXfs=[],Qu(e.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={}),a="docProps/core.xml",cn(s,a,gG(n.Props,e)),i.coreprops.push(a),Yn(e.rels,2,a,Mn.CORE_PROPS),a="docProps/app.xml",!(n.Props&&n.Props.SheetNames))if(!n.Workbook||!n.Workbook.Sheets)n.Props.SheetNames=n.SheetNames;else{for(var l=[],c=0;c<n.SheetNames.length;++c)(n.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(n.SheetNames[c]);n.Props.SheetNames=l}for(n.Props.Worksheets=n.Props.SheetNames.length,cn(s,a,pG(n.Props)),i.extprops.push(a),Yn(e.rels,3,a,Mn.EXT_PROPS),n.Custprops!==n.Props&&Xi(n.Custprops||{}).length>0&&(a="docProps/custom.xml",cn(s,a,yG(n.Custprops)),i.custprops.push(a),Yn(e.rels,4,a,Mn.CUST_PROPS)),o=1;o<=n.SheetNames.length;++o){var h={"!id":{}},g=n.Sheets[n.SheetNames[o-1]],m=(g||{})["!type"]||"sheet";switch(m){case"chart":default:a="xl/worksheets/sheet"+o+"."+t,cn(s,a,K2e(o-1,a,e,n,h)),i.sheets.push(a),Yn(e.wbrels,-1,"worksheets/sheet"+o+"."+t,Mn.WS[0])}if(g){var y=g["!comments"],_=!1,x="";y&&y.length>0&&(x="xl/comments"+o+"."+t,cn(s,x,Y2e(y,x)),i.comments.push(x),Yn(h,-1,"../comments"+o+"."+t,Mn.CMNT),_=!0),g["!legacy"]&&_&&cn(s,"xl/drawings/vmlDrawing"+o+".vml",MG(o,g["!comments"])),delete g["!comments"],delete g["!legacy"]}h["!id"].rId1&&cn(s,dG(a),A0(h))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+t,cn(s,a,q2e(e.Strings,a,e)),i.strs.push(a),Yn(e.wbrels,-1,"sharedStrings."+t,Mn.SST)),a="xl/workbook."+t,cn(s,a,H2e(n,a)),i.workbooks.push(a),Yn(e.rels,1,a,Mn.WB),a="xl/theme/theme1.xml",cn(s,a,PG(n.Themes,e)),i.themes.push(a),Yn(e.wbrels,-1,"theme/theme1.xml",Mn.THEME),a="xl/styles."+t,cn(s,a,X2e(n,a,e)),i.styles.push(a),Yn(e.wbrels,-1,"styles."+t,Mn.STY),n.vbaraw&&r&&(a="xl/vbaProject.bin",cn(s,a,n.vbaraw),i.vba.push(a),Yn(e.wbrels,-1,"vbaProject.bin",Mn.VBA)),a="xl/metadata."+t,cn(s,a,Z2e(a)),i.metadata.push(a),Yn(e.wbrels,-1,"metadata."+t,Mn.XLMETA),cn(s,"[Content_Types].xml",hG(i,e)),cn(s,"_rels/.rels",A0(e.rels)),cn(s,"xl/_rels/workbook."+t+".rels",A0(e.wbrels)),delete e.revssf,delete e.ssf,s}function WSe(n,e){h0=1024,n&&!n.SSF&&(n.SSF=Ks(Gr)),n&&n.SSF&&(jE(),DE(n.SSF),e.revssf=FE(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,pp?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t="xml",r=OG.indexOf(e.bookType)>-1,i=uG();TC(e=e||{});var s=cC(),a="",o=0;if(e.cellXfs=[],Qu(e.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={}),a="docProps/core.xml",cn(s,a,gG(n.Props,e)),i.coreprops.push(a),Yn(e.rels,2,a,Mn.CORE_PROPS),a="docProps/app.xml",!(n.Props&&n.Props.SheetNames))if(!n.Workbook||!n.Workbook.Sheets)n.Props.SheetNames=n.SheetNames;else{for(var l=[],c=0;c<n.SheetNames.length;++c)(n.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(n.SheetNames[c]);n.Props.SheetNames=l}n.Props.Worksheets=n.Props.SheetNames.length,cn(s,a,pG(n.Props)),i.extprops.push(a),Yn(e.rels,3,a,Mn.EXT_PROPS),n.Custprops!==n.Props&&Xi(n.Custprops||{}).length>0&&(a="docProps/custom.xml",cn(s,a,yG(n.Custprops)),i.custprops.push(a),Yn(e.rels,4,a,Mn.CUST_PROPS));var h=["SheetJ5"];for(e.tcid=0,o=1;o<=n.SheetNames.length;++o){var g={"!id":{}},m=n.Sheets[n.SheetNames[o-1]],y=(m||{})["!type"]||"sheet";switch(y){case"chart":default:a="xl/worksheets/sheet"+o+"."+t,cn(s,a,$G(o-1,e,n,g)),i.sheets.push(a),Yn(e.wbrels,-1,"worksheets/sheet"+o+"."+t,Mn.WS[0])}if(m){var _=m["!comments"],x=!1,w="";if(_&&_.length>0){var b=!1;_.forEach(function(T){T[1].forEach(function(k){k.T==!0&&(b=!0)})}),b&&(w="xl/threadedComments/threadedComment"+o+"."+t,cn(s,w,Eve(_,h,e)),i.threadedcomments.push(w),Yn(g,-1,"../threadedComments/threadedComment"+o+"."+t,Mn.TCMNT)),w="xl/comments"+o+"."+t,cn(s,w,LG(_)),i.comments.push(w),Yn(g,-1,"../comments"+o+"."+t,Mn.CMNT),x=!0}m["!legacy"]&&x&&cn(s,"xl/drawings/vmlDrawing"+o+".vml",MG(o,m["!comments"])),delete m["!comments"],delete m["!legacy"]}g["!id"].rId1&&cn(s,dG(a),A0(g))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+t,cn(s,a,TG(e.Strings,e)),i.strs.push(a),Yn(e.wbrels,-1,"sharedStrings."+t,Mn.SST)),a="xl/workbook."+t,cn(s,a,KG(n)),i.workbooks.push(a),Yn(e.rels,1,a,Mn.WB),a="xl/theme/theme1.xml",cn(s,a,PG(n.Themes,e)),i.themes.push(a),Yn(e.wbrels,-1,"theme/theme1.xml",Mn.THEME),a="xl/styles."+t,cn(s,a,IG(n,e)),i.styles.push(a),Yn(e.wbrels,-1,"styles."+t,Mn.STY),n.vbaraw&&r&&(a="xl/vbaProject.bin",cn(s,a,n.vbaraw),i.vba.push(a),Yn(e.wbrels,-1,"vbaProject.bin",Mn.VBA)),a="xl/metadata."+t,cn(s,a,NG()),i.metadata.push(a),Yn(e.wbrels,-1,"metadata."+t,Mn.XLMETA),h.length>1&&(a="xl/persons/person.xml",cn(s,a,Sve(h)),i.people.push(a),Yn(e.wbrels,-1,"persons/person.xml",Mn.PEOPLE)),cn(s,"[Content_Types].xml",hG(i,e)),cn(s,"_rels/.rels",A0(e.rels)),cn(s,"xl/_rels/workbook."+t+".rels",A0(e.wbrels)),delete e.revssf,delete e.ssf,s}function HSe(n,e){var t="";switch((e||{}).type||"base64"){case"buffer":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];case"base64":t=dc(n.slice(0,12));break;case"binary":t=n;break;case"array":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function ez(n,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return sy(e.file,rr.write(n,{type:Fn?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return rr.write(n,e)}function KSe(n,e){var t=Ks(e||{}),r=USe(n,t);return XSe(r,t)}function XSe(n,e){var t={},r=Fn?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(t.compression="DEFLATE"),e.password)t.type=r;else switch(e.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":t.type=r;break;default:throw new Error("Unrecognized type "+e.type)}var i=n.FullPaths?rr.write(n,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!e.compression}):n.generate(t);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(OE(i))}return e.password&&typeof encrypt_agile<"u"?ez(encrypt_agile(i,e.password),e):e.type==="file"?sy(e.file,i):e.type=="string"?dp(i):i}function qSe(n,e){var t=e||{},r=hSe(n,t);return ez(r,t)}function Ko(n,e,t){t||(t="");var r=t+n;switch(e.type){case"base64":return o1(c1(r));case"binary":return c1(r);case"string":return n;case"file":return sy(e.file,r,"utf8");case"buffer":return Fn?Ec(r,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(r):Ko(r,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function YSe(n,e){switch(e.type){case"base64":return o1(n);case"binary":return n;case"string":return n;case"file":return sy(e.file,n,"binary");case"buffer":return Fn?Ec(n,"binary"):n.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function Jx(n,e){switch(e.type){case"string":case"base64":case"binary":for(var t="",r=0;r<n.length;++r)t+=String.fromCharCode(n[r]);return e.type=="base64"?o1(t):e.type=="string"?dp(t):t;case"file":return sy(e.file,n);case"buffer":return n;default:throw new Error("Unrecognized type "+e.type)}}function tz(n,e){bye(),O2e(n);var t=Ks(e||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var r=tz(n,t);return t.type="array",OE(r)}var i=0;if(t.sheet&&(typeof t.sheet=="number"?i=t.sheet:i=n.SheetNames.indexOf(t.sheet),!n.SheetNames[i]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return Ko(cSe(n,t),t);case"slk":case"sylk":return Ko(N_e.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"htm":case"html":return Ko(YG(n.Sheets[n.SheetNames[i]],t),t);case"txt":return YSe(nz(n.Sheets[n.SheetNames[i]],t),t);case"csv":return Ko(RC(n.Sheets[n.SheetNames[i]],t),t,"\uFEFF");case"dif":return Ko(M_e.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"dbf":return Jx(P_e.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"prn":return Ko(L_e.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"rtf":return Ko(G_e.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"eth":return Ko(bG.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"fods":return Ko(QG(n,t),t);case"wk1":return Jx(KO.sheet_to_wk1(n.Sheets[n.SheetNames[i]],t),t);case"wk3":return Jx(KO.book_to_wk3(n,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),Jx(qG(n,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),qSe(n,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return KSe(n,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function ZSe(n){if(!n.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},t=n.file.slice(n.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(n.bookType=t.slice(1)),n.bookType=e[n.bookType]||n.bookType}}function JSe(n,e,t){var r={};return r.type="file",r.file=e,ZSe(r),tz(n,r)}function QSe(n,e,t,r,i,s,a,o){var l=Ki(t),c=o.defval,h=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),g=!0,m=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(m,"__rowNum__",{value:t,enumerable:!1})}catch{m.__rowNum__=t}else m.__rowNum__=t;if(!a||n[t])for(var y=e.s.c;y<=e.e.c;++y){var _=a?n[t][y]:n[r[y]+l];if(_===void 0||_.t===void 0){if(c===void 0)continue;s[y]!=null&&(m[s[y]]=c);continue}var x=_.v;switch(_.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+_.t)}if(s[y]!=null){if(x==null)if(_.t=="e"&&x===null)m[s[y]]=null;else if(c!==void 0)m[s[y]]=c;else if(h&&x===null)m[s[y]]=null;else continue;else m[s[y]]=h&&(_.t!=="n"||_.t==="n"&&o.rawNumbers!==!1)?x:fc(_,x,o);x!=null&&(g=!1)}}return{row:m,isempty:g}}function mw(n,e){if(n==null||n["!ref"]==null)return[];var t={t:"n",v:0},r=0,i=1,s=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=e||{},h=c.range!=null?c.range:n["!ref"];switch(c.header===1?r=1:c.header==="A"?r=2:Array.isArray(c.header)?r=3:c.header==null&&(r=0),typeof h){case"string":l=pr(h);break;case"number":l=pr(n["!ref"]),l.s.r=h;break;default:l=h}r>0&&(i=0);var g=Ki(l.s.r),m=[],y=[],_=0,x=0,w=Array.isArray(n),b=l.s.r,T=0,k={};w&&!n[b]&&(n[b]=[]);var L=c.skipHidden&&n["!cols"]||[],O=c.skipHidden&&n["!rows"]||[];for(T=l.s.c;T<=l.e.c;++T)if(!(L[T]||{}).hidden)switch(m[T]=gs(T),t=w?n[b][T]:n[m[T]+g],r){case 1:s[T]=T-l.s.c;break;case 2:s[T]=m[T];break;case 3:s[T]=c.header[T-l.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),o=a=fc(t,null,c),x=k[a]||0,!x)k[a]=1;else{do o=a+"_"+x++;while(k[o]);k[a]=x,k[o]=1}s[T]=o}for(b=l.s.r+i;b<=l.e.r;++b)if(!(O[b]||{}).hidden){var B=QSe(n,l,b,m,r,s,w,c);(B.isempty===!1||(r===1?c.blankrows!==!1:c.blankrows))&&(y[_++]=B.row)}return y.length=_,y}var tD=/"/g;function ebe(n,e,t,r,i,s,a,o){for(var l=!0,c=[],h="",g=Ki(t),m=e.s.c;m<=e.e.c;++m)if(r[m]){var y=o.dense?(n[t]||[])[m]:n[r[m]+g];if(y==null)h="";else if(y.v!=null){l=!1,h=""+(o.rawNumbers&&y.t=="n"?y.v:fc(y,null,o));for(var _=0,x=0;_!==h.length;++_)if((x=h.charCodeAt(_))===i||x===s||x===34||o.forceQuotes){h='"'+h.replace(tD,'""')+'"';break}h=="ID"&&(h='"ID"')}else y.f!=null&&!y.F?(l=!1,h="="+y.f,h.indexOf(",")>=0&&(h='"'+h.replace(tD,'""')+'"')):h="";c.push(h)}return o.blankrows===!1&&l?null:c.join(a)}function RC(n,e){var t=[],r=e??{};if(n==null||n["!ref"]==null)return"";var i=pr(n["!ref"]),s=r.FS!==void 0?r.FS:",",a=s.charCodeAt(0),o=r.RS!==void 0?r.RS:`
`,l=o.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),h="",g=[];r.dense=Array.isArray(n);for(var m=r.skipHidden&&n["!cols"]||[],y=r.skipHidden&&n["!rows"]||[],_=i.s.c;_<=i.e.c;++_)(m[_]||{}).hidden||(g[_]=gs(_));for(var x=0,w=i.s.r;w<=i.e.r;++w)(y[w]||{}).hidden||(h=ebe(n,i,w,g,a,l,s,r),h!=null&&(r.strip&&(h=h.replace(c,"")),(h||r.blankrows!==!1)&&t.push((x++?o:"")+h)));return delete r.dense,t.join("")}function nz(n,e){e||(e={}),e.FS="	",e.RS=`
`;var t=RC(n,e);return t}function tbe(n){var e="",t,r="";if(n==null||n["!ref"]==null)return[];var i=pr(n["!ref"]),s="",a=[],o,l=[],c=Array.isArray(n);for(o=i.s.c;o<=i.e.c;++o)a[o]=gs(o);for(var h=i.s.r;h<=i.e.r;++h)for(s=Ki(h),o=i.s.c;o<=i.e.c;++o)if(e=a[o]+s,t=c?(n[h]||[])[o]:n[e],r="",t!==void 0){if(t.F!=null){if(e=t.F,!t.f)continue;r=t.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(t.f!=null)r=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)r=""+t.v;else if(t.t=="b")r=t.v?"TRUE":"FALSE";else if(t.w!==void 0)r="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?r="'"+t.v:r=""+t.v}}l[l.length]=e+"="+r}return l}function rz(n,e,t){var r=t||{},i=+!r.skipHeader,s=n||{},a=0,o=0;if(s&&r.origin!=null)if(typeof r.origin=="number")a=r.origin;else{var l=typeof r.origin=="string"?ki(r.origin):r.origin;a=l.r,o=l.c}var c,h={s:{c:0,r:0},e:{c:o,r:a+e.length-1+i}};if(s["!ref"]){var g=pr(s["!ref"]);h.e.c=Math.max(h.e.c,g.e.c),h.e.r=Math.max(h.e.r,g.e.r),a==-1&&(a=g.e.r+1,h.e.r=a+e.length-1+i)}else a==-1&&(a=0,h.e.r=e.length-1+i);var m=r.header||[],y=0;e.forEach(function(x,w){Xi(x).forEach(function(b){(y=m.indexOf(b))==-1&&(m[y=m.length]=b);var T=x[b],k="z",L="",O=nr({c:o+y,r:a+w+i});c=d1(s,O),T&&typeof T=="object"&&!(T instanceof Date)?s[O]=T:(typeof T=="number"?k="n":typeof T=="boolean"?k="b":typeof T=="string"?k="s":T instanceof Date?(k="d",r.cellDates||(k="n",T=Hs(T)),L=r.dateNF||Gr[14]):T===null&&r.nullError&&(k="e",T=0),c?(c.t=k,c.v=T,delete c.w,delete c.R,L&&(c.z=L)):s[O]=c={t:k,v:T},L&&(c.z=L))})}),h.e.c=Math.max(h.e.c,o+m.length-1);var _=Ki(a);if(i)for(y=0;y<m.length;++y)s[gs(y+o)+_]={t:"s",v:m[y]};return s["!ref"]=ii(h),s}function nbe(n,e){return rz(null,n,e)}function d1(n,e,t){if(typeof e=="string"){if(Array.isArray(n)){var r=ki(e);return n[r.r]||(n[r.r]=[]),n[r.r][r.c]||(n[r.r][r.c]={t:"z"})}return n[e]||(n[e]={t:"z"})}return typeof e!="number"?d1(n,nr(e)):d1(n,nr({r:e,c:t||0}))}function rbe(n,e){if(typeof e=="number"){if(e>=0&&n.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var t=n.SheetNames.indexOf(e);if(t>-1)return t;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function ibe(){return{SheetNames:[],Sheets:{}}}function sbe(n,e,t,r){var i=1;if(!t)for(;i<=65535&&n.SheetNames.indexOf(t="Sheet"+i)!=-1;++i,t=void 0);if(!t||n.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&n.SheetNames.indexOf(t)>=0){var s=t.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||t;for(++i;i<=65535&&n.SheetNames.indexOf(t=a+i)!=-1;++i);}if(HG(t),n.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return n.SheetNames.push(t),n.Sheets[t]=e,t}function abe(n,e,t){n.Workbook||(n.Workbook={}),n.Workbook.Sheets||(n.Workbook.Sheets=[]);var r=rbe(n,e);switch(n.Workbook.Sheets[r]||(n.Workbook.Sheets[r]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}n.Workbook.Sheets[r].Hidden=t}function obe(n,e){return n.z=e,n}function iz(n,e,t){return e?(n.l={Target:e},t&&(n.l.Tooltip=t)):delete n.l,n}function lbe(n,e,t){return iz(n,"#"+e,t)}function cbe(n,e,t){n.c||(n.c=[]),n.c.push({t:e,a:t||"SheetJS"})}function ube(n,e,t,r){for(var i=typeof e!="string"?e:pr(e),s=typeof e=="string"?e:ii(e),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var l=d1(n,a,o);l.t="n",l.F=s,delete l.v,a==i.s.r&&o==i.s.c&&(l.f=t,r&&(l.D=!0))}return n}var Hb={encode_col:gs,encode_row:Ki,encode_cell:nr,encode_range:ii,decode_col:mC,decode_row:gC,split_cell:bxe,decode_cell:ki,decode_range:ya,format_cell:fc,sheet_add_aoa:iG,sheet_add_json:rz,sheet_add_dom:ZG,aoa_to_sheet:wg,json_to_sheet:nbe,table_to_sheet:JG,table_to_book:MSe,sheet_to_csv:RC,sheet_to_txt:nz,sheet_to_json:mw,sheet_to_html:YG,sheet_to_formulae:tbe,sheet_to_row_object_array:mw,sheet_get_cell:d1,book_new:ibe,book_append_sheet:sbe,book_set_sheet_visibility:abe,cell_set_number_format:obe,cell_set_hyperlink:iz,cell_set_internal_link:lbe,cell_add_comment:cbe,sheet_set_array_formula:ube,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const ul=qi()(bo((n,e)=>({vondsten:[],addVondst:t=>n(r=>({vondsten:[...r.vondsten,{...t,id:crypto.randomUUID(),timestamp:new Date().toISOString()}]})),removeVondst:t=>n(r=>({vondsten:r.vondsten.filter(i=>i.id!==t)})),updateVondst:(t,r)=>n(i=>({vondsten:i.vondsten.map(s=>s.id===t?{...s,...r}:s)})),clearAll:()=>n({vondsten:[]}),exportAsGeoJSON:()=>{const t=e().vondsten;if(t.length===0){alert("Geen vondsten om te exporteren");return}const r={type:"FeatureCollection",features:t.map(o=>({type:"Feature",geometry:{type:"Point",coordinates:[o.location.lng,o.location.lat]},properties:{id:o.id,objectType:o.objectType,material:o.material,period:o.period,depth:o.depth,notes:o.notes,timestamp:o.timestamp,photoUrl:o.photoUrl,condition:o.condition,weight:o.weight,length:o.length}}))},i=new Blob([JSON.stringify(r,null,2)],{type:"application/json"}),s=URL.createObjectURL(i),a=document.createElement("a");a.href=s,a.download=`mijn-vondsten-${new Date().toISOString().split("T")[0]}.geojson`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(s)},exportAsCSV:()=>{const t=e().vondsten;if(t.length===0){alert("Geen vondsten om te exporteren");return}const r=`ID,Latitude,Longitude,Datum,Type,Materiaal,Periode,Diepte (cm),Conditie,Gewicht (g),Lengte (mm),Notities,Foto URL
`,i=t.map(c=>{const h=new Date(c.timestamp).toLocaleDateString("nl-NL"),g=c.notes?`"${c.notes.replace(/"/g,'""')}"`:"";return`${c.id},${c.location.lat},${c.location.lng},${h},${c.objectType},${c.material},${c.period},${c.depth||""},${c.condition||""},${c.weight||""},${c.length||""},${g},${c.photoUrl||""}`}).join(`
`),s=r+i,a=new Blob([s],{type:"text/csv;charset=utf-8;"}),o=URL.createObjectURL(a),l=document.createElement("a");l.href=o,l.download=`mijn-vondsten-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(o)},exportAsExcel:()=>{const t=e().vondsten;if(t.length===0){alert("Geen vondsten om te exporteren");return}const r=t.map(o=>({ID:o.id,Latitude:o.location.lat,Longitude:o.location.lng,Datum:new Date(o.timestamp).toLocaleDateString("nl-NL"),Type:o.objectType,Materiaal:o.material,Periode:o.period,"Diepte (cm)":o.depth||"",Conditie:o.condition||"","Gewicht (g)":o.weight||"","Lengte (mm)":o.length||"",Notities:o.notes||"","Foto URL":o.photoUrl||""})),i=Hb.json_to_sheet(r),s=Hb.book_new();Hb.book_append_sheet(s,i,"Vondsten");const a=[{wch:36},{wch:12},{wch:12},{wch:12},{wch:15},{wch:12},{wch:25},{wch:12},{wch:12},{wch:12},{wch:12},{wch:40},{wch:50}];i["!cols"]=a,JSe(s,`mijn-vondsten-${new Date().toISOString().split("T")[0]}.xlsx`)},exportAsGPX:()=>{const t=e().vondsten;if(t.length===0){alert("Geen vondsten om te exporteren");return}const r=t.map(l=>{const c=new Date(l.timestamp).toISOString();return`  <wpt lat="${l.location.lat}" lon="${l.location.lng}">
    <name>${l.objectType} - ${l.material}</name>
    <desc>${l.period}${l.depth?`, ${l.depth}cm diep`:""}${l.condition&&l.condition!=="Onbekend"?`, ${l.condition}`:""}${l.weight?`, ${l.weight}g`:""}${l.length?`, ${l.length}mm`:""}${l.notes?`. ${l.notes}`:""}</desc>
    <time>${c}</time>
    <sym>Pin</sym>
  </wpt>`}).join(`
`),i=`<?xml version="1.0" encoding="UTF-8"?>
<gpx version="1.1" creator="DetectorApp NL" xmlns="http://www.topografix.com/GPX/1/1">
  <metadata>
    <name>Mijn Vondsten</name>
    <desc>Geexporteerd uit DetectorApp NL</desc>
    <time>${new Date().toISOString()}</time>
  </metadata>
${r}
</gpx>`,s=new Blob([i],{type:"application/gpx+xml"}),a=URL.createObjectURL(s),o=document.createElement("a");o.href=a,o.download=`mijn-vondsten-${new Date().toISOString().split("T")[0]}.gpx`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(a)},exportAsKML:()=>{const t=e().vondsten;if(t.length===0){alert("Geen vondsten om te exporteren");return}const i=`<?xml version="1.0" encoding="UTF-8"?>
<kml xmlns="http://www.opengis.net/kml/2.2">
  <Document>
    <name>Mijn Vondsten</name>
    <description>Geexporteerd uit DetectorApp NL</description>
${t.map(l=>{const c=new Date(l.timestamp).toLocaleDateString("nl-NL"),h=`<![CDATA[
            <b>Type:</b> ${l.objectType}<br/>
            <b>Materiaal:</b> ${l.material}<br/>
            <b>Periode:</b> ${l.period}<br/>
            ${l.depth?`<b>Diepte:</b> ${l.depth} cm<br/>`:""}
            ${l.condition&&l.condition!=="Onbekend"?`<b>Conditie:</b> ${l.condition}<br/>`:""}
            ${l.weight?`<b>Gewicht:</b> ${l.weight} gram<br/>`:""}
            ${l.length?`<b>Lengte:</b> ${l.length} mm<br/>`:""}
            <b>Datum:</b> ${c}<br/>
            ${l.notes?`<b>Notities:</b> ${l.notes}<br/>`:""}
            ${l.photoUrl?`<a href="${l.photoUrl}">Bekijk foto</a>`:""}
          ]]>`;return`    <Placemark>
      <name>${l.objectType} - ${l.material}</name>
      <description>${h}</description>
      <Point>
        <coordinates>${l.location.lng},${l.location.lat},0</coordinates>
      </Point>
    </Placemark>`}).join(`
`)}
  </Document>
</kml>`,s=new Blob([i],{type:"application/vnd.google-earth.kml+xml"}),a=URL.createObjectURL(s),o=document.createElement("a");o.href=a,o.download=`mijn-vondsten-${new Date().toISOString().split("T")[0]}.kml`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(a)}}),{name:"detectorapp-local-vondsten"})),hbe={Fectio:{naam:"Fectio",latinNaam:"Fectio",type:"castellum",periode:"ca. 4 - 270 n.Chr.",beschrijving:"Groot Romeins castellum bij Bunnik/Vechten, aan de splitsing van Rijn en Vecht. Een van de belangrijkste legerbases in Nederland met ruimte voor 500 soldaten. Het fort had barakken, badhuis, hospitaal en pakhuizen. Buiten de muren woonden handelaren en soldatenfamilies in een vicus. Hier is een compleet Romeins schip gevonden (De Meern 1). Strategisch gelegen voor transport over de rivieren. Veel vondsten door natte bodem: leer, hout, textiel naast munten en militaria. Te bezoeken: Archeologisch Park Castellum Hoge Woerd met reconstructie en museum.",watWasHier:"Groot castellum met ruimte voor 500 soldaten, barakken, badhuis, hospitaal en pakhuizen. Buiten het fort een burgerdorp.",watTeZien:"Archeologisch Park Castellum Hoge Woerd toont de contouren. Museum met veel vondsten waaronder een Romeins schip.",verwachteVondsten:"Munten, fibulae, aardewerk, wapens, paardentuig, militaire uitrusting. Door natte bodem ook leer, hout en textiel.",betekenis:"Een van de belangrijkste forten aan de Limes. Knooppunt voor troepen- en goederentransport.",bronnen:["https://www.hogewoerd.nl","https://www.livius.org/articles/place/fectio-vechten/"]},Traiectum:{naam:"Traiectum",latinNaam:"Traiectum",type:"castellum",periode:"ca. 42 - 275 n.Chr.",beschrijving:'Romeins castellum onder het huidige Domplein in Utrecht. De naam betekent "doorwaadbare plaats" - hier splitsten Rijn en Vecht. Het fort (124x152m in laatste fase) bood plaats aan ca. 500 soldaten. Vijf bouwfases: eerst hout, na 200 n.Chr. steen met tufsteen uit de Eifel. Cohors II Hispanorum peditata (Spaanse infanterie) was hier uniek gelegerd 88-275 n.Chr. - hun dakpanstempels zijn nergens anders aan de Limes gevonden! Het fort werd verwoest tijdens de Bataafse Opstand (69 n.Chr.). DOMunder onder het Domplein toont de opgegraven resten. UNESCO Werelderfgoed sinds 2021.',watWasHier:"Castellum (500 soldaten) bij riviersplitsing. Cohors II Hispanorum gelegerd.",watTeZien:"DOMunder onder het Domplein: opgravingen te bezoeken. Principia en poorten blootgelegd.",verwachteVondsten:"Dakpannen met stempels, munten, aardewerk, tufsteen bouwmateriaal, militaria.",betekenis:"UNESCO Werelderfgoed. Oorsprong van de stad Utrecht.",bronnen:["https://www.livius.org/articles/place/traiectum-utrecht/","https://www.utrechtaltijd.nl/verhalen/castellum-traiectum-een-romeinse-legerbasis-in-het-hart-van-de-domstad/","https://www.romeinen.nl/locatie-overzicht/3447271878/domunder-castellum-traiectum"]},Laurum:{naam:"Laurum",latinNaam:"Laurum",type:"castellum",periode:"ca. 40 - 270 n.Chr.",beschrijving:"Romeins castellum in het huidige Woerden aan de Oude Rijn. Garnizoen van ca. 500 soldaten in houten barakken. Bijzonder vanwege de natte veenbodem: organisch materiaal bleef bewaard zoals houten schrijfplankjes met Latijnse teksten, leren schoenen en een Romeinse boot. Het fort werd meerdere keren herbouwd na overstromingen. De contouren zijn in het stratenpatroon herkenbaar. Buiten de muren lag een vicus (burgerdorp). Vondsten in Stadsmuseum Woerden, waaronder unieke houten voorwerpen die elders zijn vergaan.",watWasHier:"Castellum voor 500 soldaten met houten barakken, badhuis en pakhuizen. Vicus buiten de muren.",watTeZien:"Stadsmuseum Woerden met bijzondere vondsten. Fort-contouren in stratenpatroon herkenbaar.",verwachteVondsten:"Militaria, aardewerk, munten, schrijfplankjes. Door natte veengrond ook hout, leer en schoenen.",betekenis:"Toont Romeins bouwen in moeilijk veengebied. Unieke organische vondsten.",bronnen:["https://www.castellumwoerden.nl"]},"Castellum Praetorium Agrippinae":{naam:"Praetorium Agrippinae",latinNaam:"Praetorium Agrippinae",type:"castellum",periode:"ca. 40 - 275 n.Chr.",beschrijving:"Een van de best opgegraven Romeinse locaties van Nederland. Het castellum werd gesticht in de winter van 39/40 n.Chr. door keizer Caligula, vernoemd naar zijn moeder Vipsania Agrippina. Een opgegraven wijnvat bevatte wijn van de persoonlijke wijngaarden van de keizer! Er zijn 7 bouwfasen gevonden, 6 van hout en de laatste van steen - uniek compleet inzicht in Romeinse bouwtechnieken. Cohors III Gallorum equitata was hier gelegerd. Bij opgravingen (1941-1953) zijn door het grondwater veel organische vondsten bewaard: voedselresten, leer, touw. De vicus buiten het fort strekte zich 1 km uit met 700+ graven. Op het Castellumplein zijn de contouren in brons gemarkeerd.",watWasHier:"Castellum met 7 bouwfasen. Vicus (1 km) met 700+ graven. Detachement Cohors III Gallorum.",watTeZien:"Castellumplein met bronzen markeringen. Torenmuseum Valkenburg. Gereconstrueerde poort.",verwachteVondsten:"Militaria, organisch materiaal (voedsel, leer, touw), aardewerk, munten, inscripties.",betekenis:"Best gedocumenteerde Romeinse fort van Nederland. UNESCO Werelderfgoed.",bronnen:["https://www.livius.org/articles/place/praetorium-agrippinae-valkenburg-zh/","https://www.geschiedenisvanzuidholland.nl/zien-en-doen/locaties/praetorium-agrippinae-in-valkenburg/","https://oudvalkenburgzh.nl/torenmuseum-5/"]},"Castra Hunnerberg":{naam:"Castra Hunnerberg",latinNaam:"Castra",type:"legerkamp",periode:"ca. 16 v.Chr. - 104 n.Chr.",beschrijving:'Enorm Romeins legerkamp op de Hunnerberg bij Nijmegen - 42 hectare (80 voetbalvelden), ruimte voor 12.000 man. De enige plek in Nederland waar echte legioenen (geen hulptroepen) verbleven! Na de Bataafse Opstand (69 n.Chr.) vestigde Legio X Gemina Pia Fidelis zich hier - opgericht door Julius Caesar en het bekendste legioen van Nederland. De afkorting LXG is talloze keren gevonden op dakpannen en tegels. Bij opgravingen zijn ruim 1000 fragmenten militaire uitrusting en paardentuig gevonden. In 104 n.Chr. vertrok het legioen naar de Balkan - een ramp voor de economie. UNESCO Werelderfgoed sinds 2021, omschreven als "bakermat van de Nederduitse Limes".',watWasHier:"Legerkamp voor 12.000 man. Legio X Gemina (71-104 n.Chr.), opgericht door Julius Caesar.",watTeZien:"Museum Het Valkhof. Museum Kam in de Hunnerberg. Grafvelden in Nijmegen-Oost.",verwachteVondsten:"Legioenstempels LXG, militaria, paardentuig, dakpannen, munten, grafstenen.",betekenis:"UNESCO Werelderfgoed. Bakermat van de Limes. Enige legioenskamp in Nederland.",bronnen:["https://www.livius.org/articles/place/noviomagus-nijmegen-hunnerberg/","https://www.welkominnijmegen.nl/pages/geschiedenis/de-romeinen-in-nijmegen/de-legerkampen.php","https://mijngelderland.nl/inhoud/specials/archeokroniek/romeinse-militaire-uitrusting-en-paardentuig-van-de-hunerberg-te-nijmegen"]},"Castellum Kops Plateau":{naam:"Kops Plateau",latinNaam:"Oppidum Batavorum",type:"castellum",periode:"ca. 10 v.Chr. - 70 n.Chr.",beschrijving:"Vroege Romeinse basis op het Kops Plateau in Nijmegen, later de civiele hoofdstad van de Bataven: Oppidum Batavorum. Hier woonden Romeinen en Bataven samen - het eerste contactpunt tussen beide culturen. Verwoest tijdens de Bataafse Opstand van 69-70 n.Chr. onder leiding van Julius Civilis. Gemengde vondsten: Romeinse militaria n Keltisch-Bataafse voorwerpen. Vroege importaardewerk en munten van Augustus. Nu natuurgebied. Museum Het Valkhof toont de unieke vondsten van deze ontmoeting van culturen.",watWasHier:"Eerst Romeins kamp, later Bataafse hoofdstad. Romeinen en Bataven woonden samen.",watTeZien:"Kops Plateau is natuurgebied. Museum Het Valkhof toont de vondsten.",verwachteVondsten:"Vroege militaria, Keltisch-Bataafse voorwerpen, importaardewerk, munten van Augustus.",betekenis:"Eerste contactpunt Romeinen-Bataven. Begin van romanisering Nederland.",bronnen:["https://www.livius.org/articles/place/noviomagus-nijmegen-kops-plateau/"]},"Nijmegen, Valkhof":{naam:"Valkhof Nijmegen",latinNaam:"Valkhof",type:"versterking",periode:"ca. 270 - 400 n.Chr.",beschrijving:"Laat-Romeinse versterking op het Valkhof in Nijmegen, aan de Waaloever. Gebouwd toen het Rijk onder druk stond van Germaanse invallen. Strategische positie boven de rivier. Continuteit: Karel de Grote bouwde hier later zijn palts (koninklijke residentie). De Sint-Nicolaaskapel bevat mogelijk Karolingische elementen op Romeinse fundamenten. Typische laat-Romeinse vondsten: gordels met riemtongen, militaire gespen, munten van 3e-4e eeuwse keizers. Museum Het Valkhof toont de overgang van Romeinse tijd naar vroege middeleeuwen.",watWasHier:"Laat-Romeinse versterking boven de Waal. Later Karolingische palts.",watTeZien:"Valkhofpark met Sint-Nicolaaskapel. Museum Het Valkhof.",verwachteVondsten:"Laat-Romeinse munten, gordels, riemtongen, militaire gespen, 3e-4e eeuws aardewerk.",betekenis:"Toont overgang Romeinse tijd naar middeleeuwen. Nijmegen bleef machtscentrum.",bronnen:["https://www.museumhetvalkhof.nl"]},"Castellum Op de Hoge Woerd":{naam:"Hoge Woerd",latinNaam:"Castellum",type:"castellum",periode:"ca. 50 - 270 n.Chr.",beschrijving:"Romeins castellum in Leidsche Rijn (Utrecht), nu een voorbeeldig archeologisch park. Middelgroot fort met houten gebouwen en een burgerdorp (vicus) buiten de muren. Hier is een compleet Romeins schip gevonden: De Meern 1, een 25 meter lange vrachtboot. Door de natte kleigrond bleef veel organisch materiaal bewaard. Het park toont de reconstructie van het fort - je kunt over de originele fundamenten lopen. Modern museum met interactieve presentatie. Ideale plek om te zien hoe een Romeins fort eruitzag.",watWasHier:"Middelgroot castellum met houten gebouwen. Vicus buiten de muren. Compleet schip gevonden.",watTeZien:"Archeologisch Park Hoge Woerd: reconstructie fort, museum, originele fundamenten.",verwachteVondsten:"Militaria, scheepsonderdelen, aardewerk, munten. Door natte grond ook organisch materiaal.",betekenis:"Best gepresenteerde Romeinse fort in Nederland. Ideaal om fort-layout te begrijpen.",bronnen:["https://www.hogewoerd.nl"]},Lugdunum:{naam:"Lugdunum",latinNaam:"Lugdunum",type:"vlootbasis",periode:"ca. 40 - 270 n.Chr.",beschrijving:`Romeinse vlootbasis en versterkte graanopslagplaats bij de monding van de Rijn, het westelijkste punt van de gehele Limes. Hier stond mogelijk een enorme vuurtoren (ca. 60m hoog) naar model van de Pharos van Ostia - vissers noemden deze "Kalla's toren" (Caligula). Door de vele dakpannen van de Romeinse vloot wordt aangenomen dat dit een vlootbasis was. Het fort is door kustafslag in zee verdwenen. Bij stormen in 1520, 1552 en 1562 waren de runes van de "Brittenburg" zichtbaar op het strand; de laatst gedateerde vondst was 270 n.Chr. Het Rijksmuseum van Oudheden in Leiden toont vondsten. De beroemde kaart van Ortelius toont hoe het eruit zag.`,watWasHier:"Vlootbasis met vuurtoren bij Rijnmonding. Graanopslag voor Britannia.",watTeZien:"Fort verdwenen in zee. RMO Leiden toont vondsten en kaart van Ortelius.",verwachteVondsten:"Na stormen: munten, aardewerk, militaria. Fort zelf onbereikbaar in Noordzee.",betekenis:"Westelijk eindpunt van de Limes. Verbinding met Britannia.",bronnen:["https://www.livius.org/articles/place/lugdunum-katwijk/","https://nl.wikipedia.org/wiki/Lugdunum_(Katwijk)"]},"Vlootbasis Naaldwijk":{naam:"Vlootbasis Naaldwijk",type:"vlootbasis",periode:"1e - 2e eeuw n.Chr.",beschrijving:"Vermoedelijke basis van de Classis Germanica (Germaanse vloot) bij Naaldwijk in het Westland. De Romeinse vloot patrouilleerde langs de Noordzeekust en vervoerde troepen en goederen naar Britannia. Haven met dokken voor oorlogsschepen en transportboten. Mariniers (classiarii) waren hier gestationeerd. Het gebied is nu landbouwgrond, maar bij opgravingen zijn haven-structuren en scheepsgerelateerde vondsten gedaan. Ankers, scheepsonderdelen en specifieke mariniers-uitrusting. Toont het belang van zeemacht voor de Romeinse grensverdediging.",watWasHier:"Haven voor oorlogsschepen. Mariniers gestationeerd. Patrouilles langs Noordzeekust.",watTeZien:"Gebied is landbouwgrond. Vondsten in lokale musea.",verwachteVondsten:"Scheepsonderdelen, ankers, mariniers-uitrusting, importaardewerk.",betekenis:"Toont belang Romeinse vloot voor kustverdediging.",bronnen:[]},"Minifort Ockenburg":{naam:"Minifort Ockenburg",type:"minifort",periode:"ca. 150 - 180 n.Chr.",beschrijving:"Klein Romeins kustfort bij Ockenburg in Den Haag, op een oude strandwal. Bewaakte de kust tegen piraten en Germaanse invallen over zee. Ruimte voor slechts 20-30 soldaten - een wachtpost eerder dan een echt fort. Korte gebruiksperiode van ca. 30 jaar. Toont dat de Romeinen niet alleen de rivieren maar ook de Noordzeekust verdedigden. Het terrein is beschermd rijksmonument maar niet publiek toegankelijk. Vondsten in het Haags Historisch Museum: militaria, aardewerk en munten uit de 2e eeuw.",watWasHier:"Kleine kustwachtpost voor 20-30 soldaten op strandwal.",watTeZien:"Terrein beschermd maar niet toegankelijk. Haags Historisch Museum.",verwachteVondsten:"Kleine hoeveelheden militaria, aardewerk, munten 2e eeuw.",betekenis:"Toont Romeinse kustverdediging naast rivierforten.",bronnen:[]},"Castellum Ceuclum":{naam:"Ceuclum",latinNaam:"Ceuclum",type:"castellum",periode:"ca. 70 - 270 n.Chr.",beschrijving:"Romeins castellum bij Cuijk aan de Maas, waar de belangrijke weg naar het noorden de rivier kruiste. Het fort bewaakte een brug of veerpont. Garnizoen van hulptroepen. De naam Cuijk is afgeleid van Ceuclum. Bij de brug werden ritueel munten geofferd. Het fort lag op een strategisch punt waar de Maasroute de landweg kruiste. Vondsten wijzen op handel en militaire activiteit. Het Maasmuseum in Cuijk toont lokale Romeinse vondsten. Onder het centrum zijn bij bouwwerkzaamheden regelmatig resten gevonden.",watWasHier:"Castellum bij Maasbrug. Belangrijke rivierovergang en kruispunt.",watTeZien:"Maasmuseum Cuijk. Resten gevonden onder centrum.",verwachteVondsten:"Munten (geofferd bij brug), fibulae, aardewerk, bruggerelateerde vondsten.",betekenis:"Belangrijke schakel in wegennet langs de Maas.",bronnen:["https://www.livius.org/articles/place/ceuclum-cuijk/"]},"Castellum Meinerswijk":{naam:"Meinerswijk",type:"castellum",periode:"ca. 40 - 270 n.Chr.",beschrijving:"Romeins castellum in de uiterwaarden bij Arnhem-Meinerswijk aan de Rijn. Het fort bewaakt een strategisch punt waar de rivier goed te overzien was. Meerdere bouwfasen door overstromingen. In de uiterwaarden zijn bij erosie en opgravingen vondsten gedaan: militaria, aardewerk, munten en scheepsresten. Het gebied is nu natuurgebied Meinerswijk met wisselende waterstanden. Na hoog water kunnen vondsten aan de oppervlakte komen. Museum Arnhem toont Romeinse vondsten uit de regio.",watWasHier:"Castellum in uiterwaarden. Meerdere bouwfasen door overstromingen.",watTeZien:"Natuurgebied Meinerswijk. Museum Arnhem.",verwachteVondsten:"Militaria, aardewerk, munten, scheepsresten. Na hoog water aan oppervlakte.",betekenis:"Onderdeel fortenketen langs de Rijn.",bronnen:[]},Levefanum:{naam:"Levefanum",latinNaam:"Levefanum",type:"versterking",periode:"ca. 50 - 270 n.Chr.",beschrijving:"Romeinse versterking bij Wijk bij Duurstede, waar de Rijn splitste in de Lek en Kromme Rijn. Strategisch cruciaal punt voor controle over het scheepvaartverkeer. Waarschijnlijk ook een haven voor overslag van goederen. Op dezelfde plek ontstond later de Karolingische handelsstad Dorestad, een van de belangrijkste havens van vroegmiddeleeuws Europa. De continuteit toont het blijvende belang van deze locatie. Dorestad Museum vertelt het verhaal van Romeinse tijd tot Vikingaanvallen. Vondsten: munten, handelsaardewerk, militaria.",watWasHier:"Versterking bij riviersplitsing. Haven en overslagpunt. Later Dorestad.",watTeZien:"Dorestad Museum. Terrein bebouwd.",verwachteVondsten:"Munten, handelsaardewerk, militaria, scheepsgerelateerde vondsten.",betekenis:"Strategisch controlepunt waterwegen. Later belangrijke handelsstad Dorestad.",bronnen:[]},"Nigrum Pullum":{naam:"Nigrum Pullum",latinNaam:"Nigrum Pullum (Zwarte Poel)",type:"minifort",periode:"ca. 40 - 270 n.Chr.",beschrijving:"Romeins castellum bij Zwammerdam aan de Oude Rijn. Garnizoen van 100-150 soldaten met pakhuizen en haven voor riviertransport. Wereldberoemd door de vondst van 6 Romeinse schepen (1971-1974) in perfecte staat - bewaard door de natte veengrond. De Zwammerdamschepen zijn de best bewaarde Romeinse rivierschepen ter wereld en tonen uniek inzicht in Romeins transport en scheepsbouw. Vondsten: schepen, leren schoeisel, houten voorwerpen, aardewerk, munten, militaria. Te zien in Rijksmuseum van Oudheden, Leiden.",watWasHier:"Klein fort met pakhuizen en haven. Bij opgravingen werden 6 Romeinse schepen gevonden.",watTeZien:"De schepen zijn in het Rijksmuseum van Oudheden in Leiden. Het terrein zelf is niet te bezoeken.",verwachteVondsten:"Scheepsonderdelen, leren schoeisel, houten voorwerpen, aardewerk, munten, en door de natte veengrond organisch materiaal.",betekenis:"Wereldberoemd om de goed bewaarde Romeinse schepen. Toont transport over de Rijn.",bronnen:["https://www.rmo.nl/collectie/themas/zwammerdam"]},"Stenen wachttoren Vleuterweide":{naam:"Wachttoren Vleuterweide",type:"wachttoren",periode:"ca. 150 - 250 n.Chr.",beschrijving:"Bijzondere stenen wachttoren in Vleuterweide bij Utrecht - de meeste Romeinse wachttorens waren van hout. De stenen constructie wijst op permanentie en belang. Onderdeel van het signaleringssysteem langs de Limes: bij gevaar werden vuren aangestoken om forten te waarschuwen. De toren bood uitzicht over de omgeving en de rivier. Mogelijk woonden hier ook families van de soldaten. De fundamenten zijn gemarkeerd in de moderne woonwijk. Vondsten: bouwmateriaal (dakpannen, stenen), aardewerk, persoonlijke bezittingen. Centraal Museum Utrecht.",watWasHier:"Stenen wachttoren (ongebruikelijk). Signaalpost voor waarschuwingssysteem.",watTeZien:"Fundamenten gemarkeerd in wijk. Centraal Museum Utrecht.",verwachteVondsten:"Dakpannen met legioenstempels, aardewerk, persoonlijke bezittingen.",betekenis:"Een van weinige bekende stenen wachttorens. Toont variatie in bouwwijzen.",bronnen:[]},"Wachttoren Bunnik":{naam:"Wachttoren Bunnik",type:"wachttoren",periode:"ca. 50 - 270 n.Chr.",beschrijving:"Houten wachttoren bij Bunnik aan de Rijn, onderdeel van het signaleringssysteem langs de Limes. Elke paar kilometer stond een toren met uitzicht over de rivier. Bij nadering van vijanden werden vuren of rooksignalen gegeven, zodat binnen minuten alle forten gewaarschuwd waren. De torens waren meestal van hout op een aarden verhoging. Kleine bezetting van 4-8 soldaten. De exacte locatie is niet precies bekend doordat het gebied nu bebouwd is. Vondsten zijn schaars: wat aardewerk en militaria.",watWasHier:"Houten uitkijktoren voor signalering. Kleine bezetting van 4-8 soldaten.",watTeZien:"Exacte locatie onbekend. Gebied bebouwd.",verwachteVondsten:"Kleine hoeveelheden militaria en aardewerk.",betekenis:"Onderdeel signaleringssysteem langs Limes.",bronnen:[]},"Castellum Maastricht":{naam:"Castellum Maastricht",latinNaam:"Mosae Trajectum",type:"versterking",periode:"ca. 270 - 400 n.Chr.",beschrijving:'Laat-Romeinse versterking in het centrum van Maastricht bij de brug over de Maas. Mosae Trajectum betekent "Maasoversteek". Gebouwd in een periode dat het Rijk onder druk stond van Germaanse invallen. Het fort bewaakte de strategische rivierovergang. Continuteit van bewoning: Maastricht bleef bewoond tot op heden. Onder het Vrijthof en omgeving zijn Romeinse resten gevonden. Typische laat-Romeinse vondsten: gordels, riembeslag, munten 3e-4e eeuw, zwaar versterkte muren. Centre Ceramique vertelt de geschiedenis.',watWasHier:"Laat-Romeinse versterking bij Maasbrug. Verdediging tegen Germaanse invallen.",watTeZien:"Onder Vrijthof zijn resten. Centre Ceramique.",verwachteVondsten:"Laat-Romeinse munten, militaire gordelbeslag, riemtongen, 3e-4e eeuws aardewerk.",betekenis:"Toont continuteit - Maastricht ononderbroken bewoond sinds Romeinse tijd.",bronnen:["https://www.centreceramique.nl"]},Roompot:{naam:"Roompot Fort",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeins kustfort bij de Roompot in Zeeland dat de toegang tot de Oosterschelde bewaakte. Het fort beschermde schepen tegen piraterij en controleerde de vaarroute. Door zeespiegelstijging en kustafslag is het fort in de golven verdwenen. De exacte locatie ligt nu onder water. Soms spoelen na stormen vondsten aan op de stranden van Noord-Beveland en Walcheren: munten, aardewerk, metalen voorwerpen. Toont dat de Romeinen de gehele Zeeuwse delta controleerden, niet alleen de grote rivieren.",watWasHier:"Kustfort dat zeeroute bewaakte. Bescherming tegen piraterij.",watTeZien:"Fort verdwenen in zee. Soms vondsten op strand na stormen.",verwachteVondsten:"Na stormen: munten, aardewerk, metalen voorwerpen op Zeeuwse stranden.",betekenis:"Toont Romeinse controle over Zeeuwse wateren.",bronnen:[]},"Castellum Carvium":{naam:"Carvium",latinNaam:"Carvium",type:"castellum",periode:"ca. 40 - 270 n.Chr.",beschrijving:"Romeins castellum bij Herwen-Aerdt (bij Lobith) waar Rijn en Waal samenkwamen - een strategisch knooppunt van eerste orde. Het fort controleerde het rivierverkeer op beide grote stromen. Garnizoen van hulptroepen. In de uiterwaarden zijn bij erosie en opgravingen vondsten gedaan. Het gebied is nu natuurgebied de Gelderse Poort met dynamische rivierlandschap. Na hoog water kunnen vondsten aan oppervlakte komen. Museum Het Valkhof in Nijmegen toont vondsten uit de regio. Scheepsresten gevonden.",watWasHier:"Fort bij samenvloeiing Rijn en Waal. Controleerde twee grote rivieren.",watTeZien:"Natuurgebied Gelderse Poort. Museum Het Valkhof Nijmegen.",verwachteVondsten:"Militaria, aardewerk, munten, scheepsresten. Na hoog water aan oppervlakte.",betekenis:"Controleerde strategisch knooppunt waterwegen.",bronnen:[]},Matilo:{naam:"Matilo",latinNaam:"Matilo",type:"castellum",periode:"ca. 70 - 260 n.Chr.",beschrijving:'Romeins castellum bij Leiden-Roomburg, gebouwd na de Bataafse Opstand (69-70 n.Chr.) op een strategische plek aan de monding van het Kanaal van Corbulo. Het gigantische fort (80x120m) bood plaats aan ca. 500 soldaten en is een van de best bewaarde castella in Nederland. De archeologische resten liggen grotendeels intact onder Archeologisch Park Matilo. In het park staan 6 replica-wachttorens en een aarden wal die de omtrek van het fort visualiseert. Het fort werd tussen 240-260 n.Chr. opgeheven. De locatie Roomburg ("Romeinse burcht") verwijst naar de oorsprong. UNESCO Werelderfgoed sinds 2021.',watWasHier:"Groot castellum (500 soldaten) bij monding Kanaal van Corbulo. Vicus buiten de muren.",watTeZien:"Archeologisch Park Matilo met 6 wachttoren-replica's en aarden wal. Rijksmuseum van Oudheden.",verwachteVondsten:"Militaria, grafgiften, crematie-urnen, aardewerk, munten, fibulae.",betekenis:"UNESCO Werelderfgoed. Een van de best bewaarde castella van Nederland.",bronnen:["https://parkmatilo.nl/het-verhaal-van-matilo/","https://www.limeswerelderfgoed.nl/locaties/2016475046/archeologisch-park-matilo","https://www.romeinen.nl/locatie-overzicht/2016475046/archeologisch-park-matilo"]},Corbulo:{naam:"Forum Hadriani",latinNaam:"Forum Hadriani (Municipium Aelium Cananefatium)",type:"versterking",periode:"ca. 70 - 270 n.Chr.",beschrijving:"Forum Hadriani bij Voorburg was de noordelijkste Romeinse stad van het Europese continent en de enige stad met stadsrechten in Nederland. Gesticht rond 70 n.Chr. aan het Kanaal van Corbulo (34 km, verbinding Rijn-Maas). Keizer Hadrianus verleende in 121 n.Chr. marktrechten en gaf de stad zijn naam. Rond 150 n.Chr. kreeg het stadsrechten (Municipium). De stad had ca. 1000 inwoners, een stadsmuur met dubbele gracht, stenen gebouwen en tempels. Park Arentsburgh markeert de locatie. UNESCO Werelderfgoed sinds 2021. De eerste wetenschappelijke opgravingen (1827-1833) waren door Caspar Reuvens, de eerste hoogleraar archeologie ter wereld.",watWasHier:"Enige Romeinse stad met stadsrechten in Nederland. Ca. 1000 inwoners.",watTeZien:"Park Arentsburgh in Voorburg. Kanaal traceerbaar als de Vliet.",verwachteVondsten:"Stedelijke vondsten: bouwmateriaal, aardewerk, munten, inscripties, religieuze voorwerpen.",betekenis:"UNESCO Werelderfgoed. Noordelijkste Romeinse stad van Europa.",bronnen:["https://www.awlv.nl/forum-hadriani/de-stad-forum-hadriani/","https://www.romeinen.nl/weten/nederland-in-de-romeinse-tijd/zuid-holland/regio-voorburg","https://kennis.cultureelerfgoed.nl/index.php/Monumenten/508083"]},"Berg - Tomveld":{naam:"Berg-Tomveld",type:"villa",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeinse villa bij Berg in Zuid-Limburg, mogelijk tijdelijk militair gebruikt. Dit type gebouwen diende als landbouwbedrijf met luxe woondeel voor de eigenaar. De regio Zuid-Limburg was dicht bebouwd met villa's die graan en vee leverden aan het Romeinse leger. Vondsten wijzen op welvaart: mozaekvloeren, beschilderd pleisterwerk, hypocaustum (vloerverwarming). De locatie Tomveld verwijst mogelijk naar Romeinse grafheuvels (tumuli) in de buurt. Thermenmuseum Heerlen toont de villa-cultuur.",watWasHier:"Villa rustica met mogelijk militair gebruik. Landbouw voor legervoorraden.",watTeZien:"Locatie in agrarisch gebied. Thermenmuseum Heerlen.",verwachteVondsten:"Bouwmateriaal, dakpannen, aardewerk, munten, sieraden.",betekenis:"Toont Romeinse landbouweconomie in Zuid-Limburg.",bronnen:[]},"Berg - Trappenberg":{naam:"Berg-Trappenberg",type:"legerkamp",periode:"1e eeuw v.Chr. - 1e eeuw n.Chr.",beschrijving:"Vroeg-Romeins legerkamp bij Berg in Zuid-Limburg dat later werd omgebouwd tot villa of boerderij. Toont de transitie van militaire bezetting naar civiele bewoning. Het kamp dateert uit de veroveringsperiode toen Rome dit gebied inlijfde. Na pacificatie was een fort niet meer nodig en werd het terrein civiel benut. Vondsten: vroege Romeinse militaria naast later agrarisch materiaal. Zuid-Limburg was een grenszone voordat de Limes naar de Rijn verplaatste.",watWasHier:"Eerst legerkamp, later villa/boerderij. Overgang militair naar civiel.",watTeZien:"Locatie in landbouwgebied.",verwachteVondsten:"Vroege militaria, later agrarisch aardewerk, bouwmateriaal.",betekenis:"Toont Romeinse verovering en pacificatie van Zuid-Limburg.",bronnen:[]},"Castellum Blariacum":{naam:"Blariacum",latinNaam:"Blariacum",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Mogelijke locatie van het Romeinse castellum Blariacum bij Blerick (nu deel van Venlo). De naam leeft voort in de plaatsnaam. Het fort zou de Maasovergang hebben bewaakt op de route tussen Xanten en Maastricht. De exacte locatie is nooit definitief vastgesteld ondanks vele opgravingspogingen. Vondsten in de omgeving wijzen wel op Romeinse militaire aanwezigheid: militaria, munten, aardewerk. Het Limburgs Museum in Venlo toont de Romeinse geschiedenis van de regio.",watWasHier:"Vermoedelijk castellum bij Maasovergang. Exacte locatie onzeker.",watTeZien:"Locatie niet vastgesteld. Limburgs Museum Venlo.",verwachteVondsten:"Militaria, munten, aardewerk als aanwijzingen voor fortlocatie.",betekenis:"Plaatsnaam Blerick afgeleid van Blariacum. Schakel in Maasroute.",bronnen:[]},"Fortificatie Bodegraven":{naam:"Wachtpost Bodegraven",type:"wachttoren",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Waarschijnlijke Romeinse wachtpost bij Bodegraven aan de Oude Rijn. Onderdeel van het signaleringssysteem tussen de grotere forten zoals Nigrum Pullum en Laurum. De wachttorens stonden om de paar kilometer en konden met vuur- of rooksignalen waarschuwingen doorgeven. Kleine bezetting van 4-8 soldaten. De exacte locatie is niet precies bekend. Bij graafwerkzaamheden in Bodegraven zijn wel Romeinse scherven gevonden die op aanwezigheid wijzen.",watWasHier:"Kleine wachtpost voor signalering. 4-8 soldaten.",watTeZien:"Exacte locatie onbekend.",verwachteVondsten:"Aardewerk, kleine hoeveelheden militaria.",betekenis:"Onderdeel communicatiesysteem langs de Limes.",bronnen:[]},Caestert:{naam:"Caestert",type:"versterking",periode:"1e eeuw v.Chr.",beschrijving:"Mogelijk de locatie waar de Eburonen onder leiding van Ambiorix in 54 v.Chr. een Romeins legioen vernietigden - de zwaarste Romeinse nederlaag in de Lage Landen. Het plateau van Caestert bij Kanne (Belgisch Limburg) had een oppidum (versterkte nederzetting). Julius Caesar beschrijft de slag in zijn Gallische Oorlogen. De locatie is omstreden, maar Caestert is een sterke kandidaat. Symbolisch belangrijke plek voor de Belgische geschiedenis. De site is nu natuurgebied met grotten.",watWasHier:"Mogelijk slagveld Ambiorix-opstand 54 v.Chr. Oppidum (versterking).",watTeZien:"Plateau Caestert, natuurgebied met grotten.",verwachteVondsten:"Keltische en vroeg-Romeinse voorwerpen, mogelijk slagveldvondsten.",betekenis:"Mogelijke locatie grootste Romeinse nederlaag in de regio.",bronnen:[]},"Castellum Driel?":{naam:"Castellum Driel",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:'Mogelijke locatie van een Romeins castellum bij Driel in de Betuwe. Het bestaan en de exacte locatie zijn onzeker, vandaar het vraagteken. De Betuwe (Insula Batavorum - "Eiland der Bataven") was kerngebied van de Bataven, bondgenoten van Rome. Zij leverden beroemde hulptroepen aan het Romeinse leger. Een fort hier zou logisch zijn om het gebied te controleren. Vondsten in de omgeving wijzen op Romeinse aanwezigheid. Museum Het Valkhof Nijmegen toont de Bataafse cultuur.',watWasHier:"Mogelijk castellum in Bataafs kerngebied. Bestaan onzeker.",watTeZien:"Geen zichtbare resten. Museum Het Valkhof.",verwachteVondsten:"Romeinse en Bataafse voorwerpen indien locatie juist.",betekenis:"Zou Romeinse controle over Bataafs gebied tonen.",bronnen:[]},"Castellum Duiven - Loowaard":{naam:"Duiven-Loowaard",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeins castellum bij Duiven/Loowaard aan de Rijn, in de uiterwaarden tussen Arnhem en Zevenaar. Het fort bewaakte de rivierroute en de overgang naar het Bataafse gebied. De dynamische rivier heeft veel resten weggespoeld of diep begraven. Bij lage waterstanden en na erosie komen soms vondsten aan oppervlakte: munten, militaria, aardewerk. Het gebied is nu natuurgebied met grazende grote grazers. Museum Arnhem en Het Valkhof Nijmegen tonen vondsten uit de regio.",watWasHier:"Castellum aan de Rijn in uiterwaarden. Bewaakte rivierovergang.",watTeZien:"Natuurgebied. Na erosie mogelijk vondsten aan oppervlakte.",verwachteVondsten:"Militaria, munten, aardewerk na erosie of bij laag water.",betekenis:"Onderdeel fortenketen langs de Rijn.",bronnen:[]},"Castellum Grinnes":{naam:"Grinnes",latinNaam:"Grinnes",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeins castellum bij Rossum in de gemeente Maasdriel - waarschijnlijk het antieke Grinnes vermeld op de Peutingerkaart. Het fort lag aan de Waal en controleerde de rivierroute. Bij opgravingen zijn resten van het fort gevonden. De omgeving is rijk aan Romeinse vondsten: militaria, munten, aardewerk, bouwmateriaal. Het Museum voor de Bommelerwaard in Ammerzoden toont lokale vondsten. De naam Grinnes leeft niet voort in moderne plaatsnamen.",watWasHier:"Castellum aan de Waal. Vermeld op Peutingerkaart.",watTeZien:"Locatie opgegraven. Museum Bommelerwaard.",verwachteVondsten:"Militaria, munten, aardewerk, bouwmateriaal.",betekenis:"Verbinding antieke bronnen met archeologische locatie.",bronnen:[]},"Wachttoren Heumen":{naam:"Wachttoren Heumen",type:"wachttoren",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeinse wachttoren bij Heumen ten zuiden van Nijmegen. Onderdeel van het signaleringssysteem langs de Maas en verbindingswegen. De torens stonden op strategische punten met goed uitzicht. Bij nadering van vijanden werden signalen gegeven naar de grotere forten. Kleine bezetting van 4-8 soldaten die in de toren woonden. De exacte locatie is archeologisch vastgesteld. Vondsten: militaria, aardewerk, persoonlijke bezittingen.",watWasHier:"Signaleertoren met klein garnizoen. Uitzichtpunt.",watTeZien:"Locatie bekend maar geen zichtbare resten.",verwachteVondsten:"Militaria, aardewerk, kleine persoonlijke voorwerpen.",betekenis:"Onderdeel communicatienetwerk Romeins leger.",bronnen:[]},"Castellum Huissen?":{naam:"Castellum Huissen",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Mogelijke locatie van een Romeins castellum bij Huissen aan de Rijn. Het bestaan is niet zeker vastgesteld, vandaar het vraagteken. Huissen ligt op een logische plek tussen de bekende forten bij Arnhem en Zevenaar. Vondsten in de omgeving wijzen op Romeinse activiteit. De moderne bebouwing maakt onderzoek lastig. Als er een fort was, bewaakte het de rivierroute en mogelijk een oversteekplaats.",watWasHier:"Mogelijk castellum aan de Rijn. Bestaan onzeker.",watTeZien:"Geen resten zichtbaar. Gebied bebouwd.",verwachteVondsten:"Romeinse vondsten die fortaanwezigheid zouden bevestigen.",betekenis:"Zou gat in fortenketen opvullen indien bevestigd.",bronnen:[]},"Castellum Kessel-Lith":{naam:"Kessel-Lith",type:"castellum",periode:"3e - 4e eeuw n.Chr.",beschrijving:"Laat-Romeins castellum uit de 3e-4e eeuw bij Kessel-Lith aan de Maas. Gebouwd in een periode van Germaanse invallen toen de oude Limes niet meer te handhaven was. Dit type forten was compacter en zwaarder versterkt dan de vroege castella. De locatie bij een rivierovergang bleef strategisch. Typische laat-Romeinse vondsten: gordels met riemtongen, militaire gespen, munten van 3e-4e eeuwse keizers. Het fort toont de veranderde militaire strategie van het late Romeinse Rijk.",watWasHier:"Laat-Romeins fort, compacter en zwaarder versterkt.",watTeZien:"Locatie bekend, weinig zichtbaar.",verwachteVondsten:"Laat-Romeinse munten, gordelbeslag, riemtongen, 3e-4e eeuws aardewerk.",betekenis:"Toont Romeinse aanpassing aan nieuwe dreigingen.",bronnen:[]},Carvo:{naam:"Carvo",latinNaam:"Carvo",type:"versterking",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Mogelijke Romeinse versterking nabij Kesteren in de Betuwe. De naam komt voor op de Peutingerkaart. Kesteren lag in het hart van het Bataafse stamgebied. De Bataven waren belangrijke bondgenoten van Rome en leverden beroemde cavalerie-eenheden. Een versterking hier zou zowel bescherming als controle bieden. De exacte locatie is niet vastgesteld. Vondsten in de regio tonen intensief Romeins-Bataafs contact: import-aardewerk, wapens, paardentuig.",watWasHier:"Vermoedelijke versterking in Bataafs kerngebied.",watTeZien:"Locatie onbekend.",verwachteVondsten:"Gemengd Romeins-Bataafse voorwerpen, paardentuig.",betekenis:"Zou Romeinse aanwezigheid in Bataafs gebied tonen.",bronnen:[]},Mannaricium:{naam:"Mannaricium",latinNaam:"Mannaricium",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Vermoedelijke locatie van het Romeinse castellum Mannaricium bij Maurik aan de Rijn. De naam komt voor op de Peutingerkaart. Het fort zou de rivierroute hebben bewaakt tussen Levefanum (Wijk bij Duurstede) en forten stroomopwaarts. De moderne plaats Maurik zou afgeleid kunnen zijn van Mannaricium. Bij bouwwerkzaamheden zijn Romeinse vondsten gedaan die op een fort wijzen. De exacte contouren zijn niet bekend.",watWasHier:"Vermoedelijk castellum aan de Rijn. Vermeld op Peutingerkaart.",watTeZien:"Geen zichtbare resten. Gebied bebouwd.",verwachteVondsten:"Militaria, aardewerk, munten bij bouwwerkzaamheden.",betekenis:"Mogelijke herkomst plaatsnaam Maurik.",bronnen:[]},Oostvoorne:{naam:"Castellum Oostvoorne",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeins kustfort bij de monding van de Waal en Maas, nu verdwenen in zee door kustafslag. Het fort bewaakte de zeeroute en beschermde tegen piraterij. De kust lag in de Romeinse tijd kilometers verder westwaarts. Door zeespiegelstijging en erosie is het fort in de golven verdwenen. Na stormen spoelen soms vondsten aan op de stranden van Voorne-Putten: munten, aardewerk, metalen voorwerpen. De Brittenburg bij Katwijk was een soortgelijk lot beschoren.",watWasHier:"Kustfort bij riviermonding. Bewaking zeeroute.",watTeZien:"Fort verdwenen in zee. Soms strandvondsten na stormen.",verwachteVondsten:"Na stormen: munten, aardewerk, metalen op strand.",betekenis:"Toont voormalige kustlijn en Romeinse kustverdediging.",bronnen:[]},"Castellum Randwijk":{naam:"Castellum Randwijk",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Mogelijke locatie van een Romeins castellum bij Randwijk aan de Rijn in de Betuwe. Het bestaan en de exacte locatie zijn onzeker. De rivier heeft veel oude resten weggespoeld. Randwijk ligt tussen bekende fortlocaties wat een fort hier logisch zou maken. In de uiterwaarden zijn bij erosie Romeinse vondsten gedaan. Het dynamische rivierlandschap maakt onderzoek lastig maar kan ook vondsten blootleggen na hoog water.",watWasHier:"Mogelijk castellum. Bestaan en locatie onzeker.",watTeZien:"Geen zichtbare resten. Uiterwaarden.",verwachteVondsten:"Mogelijk vondsten na erosie of hoog water.",betekenis:"Zou gat in fortenketen opvullen indien bevestigd.",bronnen:[]},"Versterking Scheveningseweg":{naam:"Minifort Scheveningseweg",type:"minifort",periode:"2e eeuw n.Chr.",beschrijving:"Vermoede locatie van een klein Romeins kustfort bij de Scheveningseweg in Den Haag, vergelijkbaar met het nabije Minifort Ockenburg. Dit type miniforten bewaakte de kust tegen piraten en Germaanse raids over zee. Ruimte voor 20-30 soldaten. De exacte locatie is niet vastgesteld maar vondsten in de omgeving suggereren Romeinse militaire aanwezigheid. Het zou aantonen dat de gehele Noordzeekust werd bewaakt, niet alleen de riviermonding.",watWasHier:"Vermoedelijk klein kustfort zoals Ockenburg. 20-30 soldaten.",watTeZien:"Locatie niet vastgesteld.",verwachteVondsten:"Militaria, aardewerk 2e eeuw indien locatie gevonden.",betekenis:"Zou Romeinse kustverdediging Den Haag bevestigen.",bronnen:[]},"Tongeren - Sacramentstraat":{naam:"Atuatuca Tungrorum",latinNaam:"Atuatuca Tungrorum / Municipium Tungrorum",type:"legerkamp",periode:"ca. 10 v.Chr. - 400 n.Chr.",beschrijving:"Oudste stad van Belgi, gesticht ca. 10 v.Chr. Hoofdstad van de Civitas Tungrorum - met 150 hectare de grootste civitas van Noordwest-Europa! Strategisch gelegen op de weg Boulogne-Bavay-Keulen. Onder keizer Trajanus (2e eeuw) ommuurd met meer dan 4,5 km muren en tot 3 grachten - waarvan nog 1,5 km staat! Een 1e-eeuwse buste van Julius Caesar is een topstuk. Het Gallo-Romeins Museum (Europees Museum van het Jaar 2011) toont een schat aan vondsten: beelden, steles, sieraden, architectuurelementen. Ook de Romeinse muren, het tempelcomplex, het aquaduct van Beukenberg en tumuli zijn te bezoeken.",watWasHier:"Civitas-hoofdstad Tungri (150 ha). 4,5 km stadsmuur. Politiek en religieus centrum.",watTeZien:"Gallo-Romeins Museum. Romeinse muren (1,5 km). Tempelcomplex. Aquaduct Beukenberg. Tumuli.",verwachteVondsten:"Stadsaardewerk, bouwmateriaal, munten, inscripties, religieuze objecten.",betekenis:"Oudste stad van Belgi. Grootste civitas van Noordwest-Europa.",bronnen:["https://www.galloromeinsmuseum.be","https://www.canonvanvlaanderen.be/en/events/tongeren-a-roman-town/"]},"Valkenburg-Marktveld, mini-castellum":{naam:"Marktveld Valkenburg",type:"minifort",periode:"1e - 2e eeuw n.Chr.",beschrijving:"Klein Romeins castellum met wachttoren bij het Marktveld in Valkenburg (Zuid-Holland), nabij het grotere Praetorium Agrippinae. Dit type miniforten vulde de ruimtes tussen de grote castella op. Wachttoren voor signalering en kleine bezetting voor patrouilles. De combinatie van toren en klein fort was effectief voor grensbewaking. Bij opgravingen zijn de contouren vastgesteld. Vondsten in Archeologisch Steunpunt Valkenburg.",watWasHier:"Klein fort met wachttoren. Aanvulling op Praetorium Agrippinae.",watTeZien:"Archeologisch Steunpunt Valkenburg.",verwachteVondsten:"Militaria, aardewerk, kleine persoonlijke voorwerpen.",betekenis:"Toont gelaagdheid Romeinse grensverdediging.",bronnen:[]},"Wachttoren a":{naam:"Wachttoren Utrecht-West",type:"wachttoren",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Een van meerdere Romeinse wachttorens in de omgeving van Utrecht, onderdeel van het signaleringssysteem langs de Limes. De torens stonden om de 1-2 kilometer met zicht op elkaar. Bij nadering van vijanden werden vuur- of rooksignalen gegeven. Binnen minuten kon de hele grens gewaarschuwd zijn. Kleine houten constructie op aarden verhoging met bezetting van 4-8 soldaten. Vondsten zijn schaars door de kleine schaal.",watWasHier:"Houten signaleertoren. 4-8 soldaten.",watTeZien:"Geen zichtbare resten.",verwachteVondsten:"Kleine hoeveelheden aardewerk en militaria.",betekenis:"Onderdeel vroegwaarschuwingssysteem.",bronnen:[]},"Wachttoren b":{naam:"Wachttoren Utrecht-Oost",type:"wachttoren",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeinse wachttoren ten oosten van Utrecht, onderdeel van de keten signaleertorens langs de Rijn. Elke toren had zichtlijn naar de volgende. Dit systeem maakte snelle communicatie mogelijk in een tijd zonder telegraaf of telefoon. De soldaten woonden in of bij de toren en hielden permanent wacht. Bij gevaar werden brandende fakkels of rookpotten gebruikt. De locatie is archeologisch vastgesteld maar niet zichtbaar.",watWasHier:"Signaleertoren in torenketen. Permanente wacht.",watTeZien:"Geen zichtbare resten.",verwachteVondsten:"Aardewerk, militaria, persoonlijke bezittingen.",betekenis:"Onderdeel communicatienetwerk Limes.",bronnen:[]},"Wachttoren c":{naam:"Wachttoren Hoge Woerd",type:"wachttoren",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeinse wachttoren nabij Castellum Op de Hoge Woerd, onderdeel van het signaleringssysteem. Torens bij forten dienden als vooruitgeschoven posten en waarschuwingsplaatsen. De combinatie van fort met omringende torens was de standaard Romeinse grensverdediging. Het Archeologisch Park Hoge Woerd geeft een goed beeld van hoe dit systeem functioneerde. De toren zelf is niet gereconstrueerd maar de context is te begrijpen.",watWasHier:"Signaleertoren bij castellum. Vooruitgeschoven post.",watTeZien:"Archeologisch Park Hoge Woerd toont context.",verwachteVondsten:"Aardewerk, militaria.",betekenis:"Toont samenhang fort en torens.",bronnen:[]},"Zwammerdam-Rijksstraatweg":{naam:"Zwammerdam-Rijksstraatweg",type:"versterking",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Mogelijke militaire nederzetting aan de Rijksstraatweg in Zwammerdam, naast het bekende Nigrum Pullum fort. Mogelijk een vicus (burgerdorp) of aparte militaire faciliteit. Bij Zwammerdam werden de beroemde Romeinse schepen gevonden. De hele zone langs de Oude Rijn was dicht bezet met militaire en civiele structuren. Vondsten wijzen op intensieve Romeinse activiteit: aardewerk, munten, militaria en door de natte veenbodem ook organisch materiaal.",watWasHier:"Mogelijk vicus of militaire faciliteit nabij Nigrum Pullum.",watTeZien:"Geen zichtbare resten.",verwachteVondsten:"Aardewerk, munten, militaria, organisch materiaal.",betekenis:"Toont dichtheid Romeinse bewoning langs Oude Rijn.",bronnen:[]},"Kastell Aachen":{naam:"Aquae Granni",latinNaam:"Aquae Granni",type:"versterking",periode:"1e - 4e eeuw n.Chr.",beschrijving:'Romeinse kuuroord bij de hete bronnen (tot 75C!) gewijd aan Apollo en de Keltische geneesheer Grannos - "aan de wateren van Grannos". In de 1e eeuw uitgebouwd tot kurort voor de legioenen van Neder-Germani. Onder keizer Trajanus bouwden legioenen uit Xanten een aquaduct en thermen onder de huidige Dom. De Mnsterthermen hadden de indeling van een valetudinarium (Romeins hospitaal). Karel de Grote bouwde hier zijn Pfalz (793-813) en maakte Aken tot keizerlijke residentie - bewust als "vernieuwer van het Romeinse Rijk". De Dom (UNESCO 1978, eerste in Duitsland!) staat op Romeinse fundamenten. Karel stierf hier in 814.',watWasHier:"Kurort voor legioenen. Thermen. Later keizerlijke Pfalz van Karel de Grote.",watTeZien:"Dom (UNESCO). Centre Charlemagne. Thermen onder de stad.",verwachteVondsten:"Badhuisresten, inscripties, munten, Romeins en Karolingisch bouwmateriaal.",betekenis:"Ononderbroken bewoning van Romeinse tijd tot Karel de Grote. Eerste UNESCO-site Duitsland.",bronnen:["https://centre-charlemagne.eu/zeitreise/?lang=en","http://www.aquaegranni.de/","https://de.wikipedia.org/wiki/Aquae_Granni"]},Hazerswoude:{naam:"Hazerswoude-Rijndijk",type:"wachttoren",periode:"2e - 3e eeuw n.Chr.",beschrijving:"Bevestigde Romeinse wachtpost langs de Limesweg bij Hazerswoude-Rijndijk. Bij opgravingen in 2021-2023 door Vestigia BV en het Rijksmuseum van Oudheden zijn spectaculaire vondsten gedaan: resten van de houten Limesweg (eiken palen uit 124-125 n.Chr.), een Romeinse dam, en aanwijzingen voor een kleine wachtpost. Bijzondere vondsten: de eerste Romeinse mijlpaal in Nederland (2023), een muntschat met 22 zilveren munten (na 166 n.Chr.), aardewerk, mantelspelden, leren schoenzolen en ca. 40.000-50.000 objecten. De locatie ligt precies tussen Albaniana (Alphen) en Matilo (Leiden).",watWasHier:"Wachtpost langs de Limesweg. Houten wegdek uit 124-125 n.Chr.",watTeZien:"Opgravingen afgerond. Vondsten naar Rijksmuseum van Oudheden.",verwachteVondsten:"Militaria, munten, aardewerk. Gebied grotendeels onderzocht.",betekenis:"Eerste Romeinse mijlpaal in Nederland. Bevestigt trac Limesweg.",bronnen:["https://www.rmo.nl/onderzoek/opgravingsprojecten/hazerswoude/","https://www.vestigia.nl/opgraving-hazerswoude-in-samenwerking-met-het-rijksmuseum-van-oudheden-en-de-gemeente-alphen-aan-den-rijn/","https://romeinsalphen.nl/themas/romeinse-weg-hazerswoude-rijndijk"]},Albaniana:{naam:"Albaniana",latinNaam:"Albaniana",type:"castellum",periode:"41 - 275 n.Chr.",beschrijving:"Groot Romeins castellum bij Alphen aan den Rijn, een van de belangrijkste forten aan de Nederlandse Limes. Het fort werd gesticht in 41-42 n.Chr., kort na de dood van keizer Caligula. De locatie is nauwkeurig bekend: bij het Rijnplein en Theater Castellum aan de Castellumstraat. Het fort (80x120m) was beschermd door een omgrachte aarden wal. Bij opgravingen tussen 1950 en 2002 zijn uitgebreide resten gevonden. Door de natte bodem zijn veel houten structuren bewaard gebleven. Een bronzen maquette van het castellum staat op het Rijnplein.",watWasHier:"Castellum met vicus. Locatie bekend: Rijnplein/Castellumstraat.",watTeZien:"Bronzen maquette Rijnplein. Theater Castellum op fortlocatie. Archeon.",verwachteVondsten:"Munten, militaria, aardewerk, dakpannen, fibulae. Veel bij bouwwerkzaamheden.",betekenis:"Een van de hoofdforten aan de Limes. UNESCO Werelderfgoed.",bronnen:["https://www.hierisalphen.nl/home/ontdekken/romeinse-limes","https://www.romeinen.nl/weten/nederland-in-de-romeinse-tijd/zuid-holland/alphen-aan-den-rijn","https://archeologiehuiszuidholland.nl/zien-en-doen/het-archeologiehuis/fort-aan-de-rijn"]}},dbe={naam:"Romeins fort",type:"versterking",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeinse militaire versterking langs de Limes, de noordgrens van het Romeinse Rijk. Forten lagen om de 10-15 km langs de Rijn. Garnizoen van hulptroepen (auxilia) die de grens bewaakten tegen Germaanse invallen. Standaard rechthoekige plattegrond met houten of stenen muur, gracht, poorten en binnengebouwen (barakken, commandopost, graanopslagplaats, werkplaatsen). Buiten de muren vaak een vicus (burgerdorp) met handelaren en soldatenfamilies. Vondsten: munten, fibulae (mantelspelden), aardewerk, wapens, gereedschap. Onderdeel van UNESCO Werelderfgoed sinds 2021."},fbe={castellum:"Castellum (legerplaats)",wachttoren:"Wachttoren (signaalpost)",vlootbasis:"Vlootbasis (haven)",legerkamp:"Legerkamp (castra)",minifort:"Minifort (wachtpost)",versterking:"Versterking",villa:"Villa (militair gebruikt)"};Tn.defs("EPSG:28992","+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m +no_defs");function nD(n){if(!n)return n;const e={Mo:"ma",Tu:"di",We:"wo",Th:"do",Fr:"vr",Sa:"za",Su:"zo",Mon:"ma",Tue:"di",Wed:"wo",Thu:"do",Fri:"vr",Sat:"za",Sun:"zo",PH:"feestdagen",SH:"schoolvakantie"};let t=n;return Object.entries(e).forEach(([r,i])=>{t=t.replace(new RegExp(`\\b${r}\\b`,"gi"),i)}),t=t.replace(/\boff\b/gi,"gesloten").replace(/\bclosed\b/gi,"gesloten").replace(/\bopen\b/gi,"open"),t}async function gbe(n){try{const e=bn(n),t=Tn("EPSG:4326","EPSG:28992",e);if(t[0]<7e3||t[0]>3e5||t[1]<289e3||t[1]>629e3)return null;const r=1,s=`https://service.pdok.nl/rws/ahn/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=dtm_05m&QUERY_LAYERS=dtm_05m&INFO_FORMAT=application/json&CRS=EPSG:28992&BBOX=${`${t[0]-r},${t[1]-r},${t[0]+r},${t[1]+r}`}&WIDTH=1&HEIGHT=1&I=0&J=0`,o=await(await fetch(s)).json();if(o.features&&o.features.length>0){const l=o.features[0].properties,c=l?.value_list??l?.GRAY_INDEX??l?.value??l?.gray_index;if(c!=null){const h=typeof c=="number"?c:parseFloat(c);if(!isNaN(h))return h}}}catch(e){console.warn("AHN height query failed:",e)}return null}const mbe={ABG:"Alphen-Chaam",ACM:"Alkmaar",ALF:"Alfen",ALK:"Alkemade",AML:"Ameland",AMR:"Amerongen",AMS:"Amsterdam",ANL:"Anloo",APD:"Apeldoorn",ARN:"Arnhem",ASN:"Assen",AVW:"Avenhorn",BDA:"Breda",BLK:"Blokker",BRN:"Barneveld",DEL:"Delft",DHG:"Den Haag",DRD:"Dordrecht",EHV:"Eindhoven",EMN:"Emmen",EPE:"Epe",GNP:"Gennep",GRN:"Groningen",GRV:"Grave",GTB:"Giethoorn",HDK:"Harderwijk",HLM:"Haarlem",HLN:"Heiloo",HRL:"Harlingen",HTN:"Houten",LDN:"Leiden",LWR:"Leeuwarden",MST:"Maastricht",NKK:"Nijkerk",NMG:"Nijmegen",OTM:"Ootmarsum",RTD:"Rotterdam",SND:"Sneek",TBG:"Tilburg",UTR:"Utrecht",VLO:"Venlo",WGN:"Wageningen",ZWL:"Zwolle",ZTP:"Zutphen",444:"Houten",811:"Gouda",310:"Utrecht",344:"Amsterdam",363:"Rotterdam",518:"Den Haag",758:"Eindhoven",772:"Tilburg",855:"Breda",85:"Arnhem",268:"Nijmegen",14:"Groningen",80:"Leeuwarden",995:"Maastricht",106:"Enschede",153:"Zwolle",34:"Almere"},pbe={1:"Zeer lage trefkans op archeologische resten",2:"Lage trefkans op archeologische resten",3:"Middelhoge trefkans op archeologische resten",4:"Hoge trefkans op archeologische resten",5:"Lage trefkans (water)",6:"Middelhoge trefkans (water)",7:"Hoge trefkans (water)",8:"Water",9:"Niet gekarteerd"};function rD(n,e){const t=[],r=n.toLowerCase(),i=(e||"").toLowerCase();return r.includes("kalkhoudend")||i.endsWith("a")?t.push("Kalkhoudend = goede metaalconservering"):(r.includes("kalkarm")||r.includes("kalkloos"))&&t.push("Kalkarm = meer corrosie op metalen"),r.includes("poldervaag")?t.push("Poldervaaggrond = jonge rivierklei, ingepolderd gebied"):r.includes("enkeerdgrond")||r.includes("enk")?t.push("Enkeerdgrond = oude akkers met plaggenbemesting - archeologisch interessant!"):r.includes("podzol")?t.push("Podzolgrond = uitgeloogde zandgrond, vaak zuur"):(r.includes("veengrond")||r.includes("veen"))&&t.push("Veengrond = zuur, slechte metaalconservering (tenzij waterverzadigd)"),r.includes("zware klei")?t.push("Zware klei = moeilijk graven, goede conservering"):r.includes("lichte klei")||r.includes("zavel")?t.push("Zavel/lichte klei = redelijk te graven"):r.includes("zand")&&!r.includes("zavel")&&t.push("Zandgrond = makkelijk graven"),r.includes("rivierklei")||i.startsWith("r")?t.push("Rivierafzetting"):(r.includes("zeeklei")||i.startsWith("m"))&&t.push("Zeekleiafzetting"),t}function ybe(){const n=Xr(_t=>_t.map),e=ul(_t=>_t.removeVondst),t=ul(_t=>_t.updateVondst),r=ul(_t=>_t.vondsten),{layers:i,addPoint:s,addLayer:a}=Hi(),[o,l]=H.useState([]),[c,h]=H.useState(0),[g,m]=H.useState(!1),[y,_]=H.useState(null),[x,w]=H.useState(!1),[b,T]=H.useState(!1),[k,L]=H.useState(null),[O,B]=H.useState(null),[R,A]=H.useState(null),[P,D]=H.useState(null),[N,G]=H.useState(!1),[j,ve]=H.useState(null),[ce,je]=H.useState(null),[Pe,ue]=H.useState(null),[Ne,be]=H.useState(!1),[ie,V]=H.useState(""),[J,te]=H.useState([]),re=J[c]||null,[he,Be]=H.useState(()=>{const _t=localStorage.getItem("popupTextScale");return _t?parseInt(_t):100}),[Ge,ye]=H.useState("half"),pe=_t=>{Be(_t),localStorage.setItem("popupTextScale",_t.toString())},Et=o[c]||"",Ve=o.length>1,jt=_t=>{const xn=_t.match(/<strong[^>]*>(.*?)<\/strong>/);if(xn){const In=xn[1].replace(/<[^>]+>/g,""),Tt=_t.replace(xn[0],"").replace(/^(<br\s*\/?>)+/,"");return{title:In,contentWithoutTitle:Tt}}return{title:"",contentWithoutTitle:_t}},St=_t=>_t.replace(/class="([^"]*)"/g,(In,Tt)=>{if(Tt.includes("text-xs")){const an=Tt.replace(/\btext-xs\b/g,"").trim();return an?`style="font-size:0.857em" class="${an}"`:'style="font-size:0.857em"'}if(Tt.includes("text-sm")){const an=Tt.replace(/\btext-sm\b/g,"").trim();return an?`class="${an}"`:""}return In}).replace(/class=""/g,""),{title:Ut,contentWithoutTitle:Ht}=jt(Et),tt=St(Ht),kn=Et.includes("Landbouwperceel"),ln=Et.includes("data-vondst-id="),hn=()=>{h(_t=>(_t-1+o.length)%o.length)},sr=()=>{h(_t=>(_t+1)%o.length)},Pi=async()=>{if(console.log(" HOOGTEKAART KNOP GEKLIKT"),console.log(" parcelCoordinate uit state:",y),!n||!y||b){console.log(" STOP - map:",!!n,"coord:",y,"loading:",b);return}console.log(` DOORGEVEN AAN showParcelHeightMap: [${y[0]}, ${y[1]}]`),T(!0);try{await wye(n,y)&&w(!0)}catch(_t){console.error("Failed to load height map:",_t)}finally{T(!1)}},Gn=()=>{n&&(zR(n),w(!1))};H.useEffect(()=>{if(!n)return;const _t=Tt=>{let an='<strong class="text-purple-800">AMK Monument</strong>';if(Tt.toponiem&&(an+=`<br/><span class="text-sm font-semibold">${Tt.toponiem}</span>`),Tt.kwaliteitswaarde&&(an+=`<br/><span class="text-sm text-purple-700">${Tt.kwaliteitswaarde}</span>`),Tt.omschrijving&&(an+=`<br/><span class="text-xs text-gray-600 mt-1 block">${Tt.omschrijving}</span>`),Tt.txt_label){const Lt=Tt.txt_label.split(", ").slice(0,3).join(", ");an+=`<br/><span class="text-xs text-gray-500 italic">${Lt}${Tt.txt_label.split(", ").length>3?"...":""}</span>`}return an},xn=async(Tt,an)=>{const Lt=[],Yi=n.getLayers().getArray().filter(Mr=>Mr instanceof iu&&Mr.getVisible()?Mr.getSource()instanceof BX:!1);for(const Mr of Yi){const li=Mr.getSource();if(!li)continue;const rn=Mr.get("title")||"";if(rn.startsWith("Paleokaart"))continue;if(rn==="Archeo Landschappen"){try{const Fe=bn(Tt),xe=Tn("EPSG:4326","EPSG:28992",Fe),_e=100,M=`https://services.rce.geovoorziening.nl/landschappenkaart/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=landschappenkaart_nl&QUERY_LAYERS=landschappenkaart_nl&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-_e},${xe[1]-_e},${xe[0]+_e},${xe[1]+_e}`}`,W=await(await fetch(M)).json();if(W.features&&W.features.length>0){const ne=W.features[0].properties,Ce=ne.landschapsnaam||ne.naam||"Archeologisch Landschap",q=ne.omschrijving||"";let le=`<strong class="text-green-800">${Ce}</strong>`;q&&(le+=`<br/><span class="text-sm text-gray-600">${q}</span>`),le+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',le+='<div class="text-sm text-gray-700 mt-1">Een archeologisch landschap is een gebied waar het landschap nog sporen draagt van menselijke activiteit uit het verleden. Denk aan oude akkers, nederzettingen of verdedigingswerken.</div>',le+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',le+='<div class="text-sm text-gray-700 mt-1">Aardewerk, munten, gereedschap en andere voorwerpen van vroegere bewoners. De kans op vondsten hangt af van het type landschap.</div>',le+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',le+='<div class="text-sm text-gray-700 mt-1"><a href="https://www.cultureelerfgoed.nl/onderwerpen/bronnen-en-kaarten/overzicht/landschappenkaart" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">RCE Landschappenkaart</a></div>',le+='<div class="text-sm text-gray-700 mt-1"><a href="https://nl.wikipedia.org/wiki/Landschapstypen_van_Nederland" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia: Landschapstypen</a></div>',Lt.push(le)}}catch(Fe){console.warn("Archeo Landschappen WMS query failed:",Fe)}continue}if(rn==="Essen"){try{const Fe=bn(Tt),xe=Tn("EPSG:4326","EPSG:28992",Fe),_e=100,M=`https://services.rce.geovoorziening.nl/landschapsatlas/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=essen&QUERY_LAYERS=essen&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-_e},${xe[1]-_e},${xe[0]+_e},${xe[1]+_e}`}`,W=await(await fetch(M)).json();if(W.features&&W.features.length>0){const ne=W.features[0].properties;let Ce='<strong class="text-amber-800">Es (historisch akkercomplex)</strong>';(ne.naam||ne.Naam||ne.NAME)&&(Ce+=`<br/><span class="text-sm font-semibold text-amber-700">${ne.naam||ne.Naam||ne.NAME}</span>`),(ne.type||ne.Type||ne.TYPE)&&(Ce+=`<br/><span class="text-xs text-gray-600">${ne.type||ne.Type||ne.TYPE}</span>`),(ne.omschrijving||ne.Omschrijving)&&(Ce+=`<br/><span class="text-xs text-gray-500">${ne.omschrijving||ne.Omschrijving}</span>`),Ce+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is een es?</span></div>',Ce+='<div class="text-sm text-gray-700 mt-1">Een es is een oud akkercomplex op hogere zandgronden. Eeuwenlang werden hier gewassen verbouwd. De bodem werd bemest met plaggen en mest, waardoor de grond donker en vruchtbaar werd.</div>',Ce+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',Ce+='<div class="text-sm text-gray-700 mt-1">Munten, gespen, knopen, aardewerk en soms bijzondere voorwerpen die door bemesting op het land terechtkwamen. Essen behoren tot de beste vindplaatsen voor metaaldetectie.</div>',Ce+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Conservering</span></div>',Ce+='<div class="text-sm text-gray-700 mt-1 italic">De zure zandgrond tast metaal aan. IJzer en koper zijn vaak slecht bewaard. Zilver en brons houden zich beter.</div>',Ce+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',Ce+='<div class="text-sm text-gray-700 mt-1"><a href="https://nl.wikipedia.org/wiki/Es_(geografie)" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia: Es (geografie)</a></div>',Lt.push(Ce)}}catch(Fe){console.warn("Essen WMS query failed:",Fe)}continue}if(rn==="FAMKE Steentijd"){try{const Fe=bn(Tt),xe=Tn("EPSG:4326","EPSG:28992",Fe),_e=`https://geoportaal.fryslan.nl/arcgis/rest/services/Themas/cultuurhistorie/MapServer/2/query?geometry=${xe[0]},${xe[1]}&geometryType=esriGeometryPoint&spatialRel=esriSpatialRelIntersects&outFields=BESCHR,BESCHRTOELICHTING,BESCHRLINK&returnGeometry=false&f=json`,M=await(await fetch(_e)).json();if(M.features&&M.features.length>0){const ut=M.features[0].attributes;let W='<strong class="text-amber-800">FAMKE Steentijd-Bronstijd</strong>';W+='<br/><span class="text-sm text-gray-500">Friese verwachtingskaart</span>';const ne=ut.BESCHR||"";ne&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Advies</span></div>',W+=`<div class="text-sm text-amber-700 mt-1 font-medium">${ne}</div>`);const Ce=ut.BESCHRTOELICHTING||"";Ce&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Toelichting</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${Ce}</div>`);const q=ut.BESCHRLINK||"";q&&(W+=`<div class="mt-3"><a href="${q}" target="_blank" rel="noopener noreferrer" class="text-sm text-blue-600 hover:underline">Meer informatie</a></div>`),W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is FAMKE?</span></div>',W+='<div class="text-sm text-gray-700 mt-1">FAMKE is de Friese Archeologische Monumentenkaart Extra. Deze kaart toont waar in Friesland vondsten uit de steentijd en bronstijd te verwachten zijn.</div>',Lt.push(W)}}catch(Fe){console.warn("FAMKE Steentijd query failed:",Fe)}continue}if(rn==="FAMKE IJzertijd"){try{const Fe=bn(Tt),xe=Tn("EPSG:4326","EPSG:28992",Fe),_e=`https://geoportaal.fryslan.nl/arcgis/rest/services/Themas/cultuurhistorie/MapServer/1/query?geometry=${xe[0]},${xe[1]}&geometryType=esriGeometryPoint&spatialRel=esriSpatialRelIntersects&outFields=BESCHR,BESCHRTOELICHTING,BESCHRLINK&returnGeometry=false&f=json`,M=await(await fetch(_e)).json();if(M.features&&M.features.length>0){const ut=M.features[0].attributes;let W='<strong class="text-orange-800">FAMKE IJzertijd-Middeleeuwen</strong>';W+='<br/><span class="text-sm text-gray-500">Friese verwachtingskaart</span>';const ne=ut.BESCHR||"";ne&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Advies</span></div>',W+=`<div class="text-sm text-orange-700 mt-1 font-medium">${ne}</div>`);const Ce=ut.BESCHRTOELICHTING||"";Ce&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Toelichting</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${Ce}</div>`);const q=ut.BESCHRLINK||"";q&&(W+=`<div class="mt-3"><a href="${q}" target="_blank" rel="noopener noreferrer" class="text-sm text-blue-600 hover:underline">Meer informatie</a></div>`),W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is FAMKE?</span></div>',W+='<div class="text-sm text-gray-700 mt-1">FAMKE is de Friese Archeologische Monumentenkaart Extra. Deze kaart toont waar in Friesland vondsten uit de ijzertijd tot en met de middeleeuwen te verwachten zijn.</div>',Lt.push(W)}}catch(Fe){console.warn("FAMKE IJzertijd query failed:",Fe)}continue}if(rn==="Archeo Onderzoeken"){try{const Fe=bn(Tt),xe=Tn("EPSG:4326","EPSG:28992",Fe),_e=100,M=`https://data.geo.cultureelerfgoed.nl/openbaar/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=archeologische_onderzoeksmeldingen_openbaar_rd&QUERY_LAYERS=archeologische_onderzoeksmeldingen_openbaar_rd&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-_e},${xe[1]-_e},${xe[0]+_e},${xe[1]+_e}`}&FEATURE_COUNT=20`,W=await(await fetch(M)).json();if(W.features&&W.features.length>0)for(const ne of W.features){const Ce=ne.properties,q=Ce.type_onderzoek||"",le=Ce.projectnaam||Ce.project_naam||Ce.naam||"",Ae=le&&le!=="-"&&le.trim()!==""&&!/^\d+$/.test(le.trim())?le:"",ze=Ce.gemeente||"",Me=Ce.uitvoerder||"",He=Ce.onderzoeksmeldingnummer||"",$e=Ce.adres||Ce.straat||"";let yt="Archeologisch Onderzoek";Ae?yt=Ae:ze&&$e?yt=`${ze} - ${$e}`:ze&&(yt=`Onderzoek ${ze}`);let At=`<strong class="text-blue-800">${yt}</strong>`;if(q&&(At+=`<br/><span class="text-sm font-semibold text-blue-700">${q}</span>`),ze&&!yt.includes(ze)&&(At+=`<br/><span class="text-sm text-gray-700">${ze}</span>`),$e&&!yt.includes($e)&&(At+=`<br/><span class="text-sm text-gray-600">${$e}</span>`),He&&(At+=`<br/><span class="text-xs text-gray-500 font-mono">OM: ${He}</span>`),Me&&(At+=`<br/><span class="text-sm text-gray-700">Uitvoerder: ${Me}</span>`),Ce.startdatum||Ce.einddatum){const Z=[Ce.startdatum,Ce.einddatum].filter(Boolean).join(" - ");At+=`<br/><span class="text-xs text-gray-600">Periode: ${Z}</span>`}const Wt=[];Ce.periode_paleolithicum&&Wt.push("Paleolithicum"),Ce.periode_mesolithicum&&Wt.push("Mesolithicum"),Ce.periode_neolithicum&&Wt.push("Neolithicum"),Ce.periode_bronstijd&&Wt.push("Bronstijd"),Ce.periode_ijzertijd&&Wt.push("IJzertijd"),Ce.periode_romeins&&Wt.push("Romeins"),Ce.periode_middeleeuwen&&Wt.push("Middeleeuwen"),Ce.periode_nieuwe_tijd&&Wt.push("Nieuwe tijd"),Wt.length>0&&(At+=`<br/><span class="text-sm text-purple-700">Datering: ${Wt.join(", ")}</span>`),At+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat betekent dit?</span></div>',q.toLowerCase().includes("opgraving")?At+='<div class="text-sm text-gray-700 mt-1">Hier is een archeologische opgraving gedaan. Professionele archeologen hebben vondsten en sporen gedocumenteerd en geborgen.</div>':q.toLowerCase().includes("bureauonderzoek")?At+='<div class="text-sm text-gray-700 mt-1">Een bureauonderzoek naar de archeologische verwachting op basis van historische bronnen en kaarten.</div>':q.toLowerCase().includes("booronderzoek")?At+='<div class="text-sm text-gray-700 mt-1">Met boringen is onderzocht wat er in de grond zit. Vaak de eerste stap om te bepalen of er verder onderzoek nodig is.</div>':q.toLowerCase().includes("proefsleuven")?At+='<div class="text-sm text-gray-700 mt-1">Proefsleuven zijn gegraven om te kijken of er archeologische sporen in de grond zitten.</div>':q.toLowerCase().includes("begeleiding")?At+='<div class="text-sm text-gray-700 mt-1">Archeologische begeleiding bij graafwerk. Een archeoloog was aanwezig om te controleren of er vondsten naar boven kwamen.</div>':q.toLowerCase().includes("inventariserend")||q.toLowerCase().includes("karterend")?At+='<div class="text-sm text-gray-700 mt-1">Verkennend onderzoek om te bepalen of er archeologische resten in de grond kunnen zitten.</div>':At+='<div class="text-sm text-gray-700 mt-1">Op deze locatie is archeologisch onderzoek uitgevoerd. De resultaten zijn opgeslagen in het landelijke archief.</div>',At+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Interessant voor detectie?</span></div>',At+='<div class="text-sm text-gray-700 mt-1 italic">Onderzoekslocaties kunnen interessant zijn: archeologen vinden vaak niet alles. Maar check altijd eerst of je daar mag zoeken.</div>',At+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Rapport opzoeken</span></div>';let z="";if(Ae?z=Ae:Me&&ze?z=`${Me} ${ze}`:ze&&(z=ze),z){const Z=z.length>35?z.substring(0,35)+"...":z;At+=`<div class="text-sm text-gray-700 mt-1"><a href="https://archaeology.datastations.nl/dataverse/root?q=${encodeURIComponent(z)}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Zoek "${Z}" in DANS</a></div>`,At+=`<div class="text-sm text-gray-700 mt-1"><a href="https://scholar.google.nl/scholar?q=${encodeURIComponent(z+" archeologisch rapport")}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Zoek in Google Scholar</a></div>`}He&&(At+=`<div class="text-sm text-gray-700 mt-1"><a href="https://archis.cultureelerfgoed.nl/" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Zoek OM ${He} in ARCHIS</a> <span class="text-xs text-gray-400">(account nodig)</span></div>`),Lt.push(At)}}catch(Fe){console.warn("Archeo Onderzoeken WMS query failed:",Fe)}continue}if(rn==="IKAW"){try{const Fe=bn(Tt),xe=Tn("EPSG:4326","EPSG:28992",Fe),_e=500,M=`https://services.rce.geovoorziening.nl/ikaw/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=IKAW3Indicatievekaartarcheologischewaarden2008&QUERY_LAYERS=IKAW3Indicatievekaartarcheologischewaarden2008&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-_e},${xe[1]-_e},${xe[0]+_e},${xe[1]+_e}`}`,W=await(await fetch(M)).json();if(W.features&&W.features.length>0){const ne=W.features[0].properties,Ce=Math.round(ne.PALETTE_INDEX||ne.palette_index||0),q=pbe[Ce]||`Trefkans onbekend (${Ce})`;let le='<strong class="text-orange-800">IKAW Verwachtingskaart</strong>';le+='<br/><span class="text-sm text-gray-500">Kaart met kansen op archeologische vondsten</span>',le+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat betekent dit?</span></div>',le+=`<div class="text-sm text-orange-700 mt-1">${q}</div>`;const ze={1:{tekst:"De kans op archeologische vondsten is hier zeer klein. De grond is waarschijnlijk verstoord of te jong.",vondsten:"Niet veel te verwachten, maar verrassingen zijn altijd mogelijk.",kleur:"text-gray-600"},2:{tekst:"De kans op vondsten is laag, maar niet uitgesloten. Soms worden hier toch interessante objecten gevonden.",vondsten:"Af en toe losse vondsten uit verschillende periodes.",kleur:"text-yellow-600"},3:{tekst:"Dit is een interessant gebied met een redelijke kans op vondsten. Hier woonden of werkten mensen in het verleden.",vondsten:"Aardewerk, munten, metalen voorwerpen uit verschillende tijdperken.",kleur:"text-amber-600"},4:{tekst:"Dit is een zeer kansrijk gebied! Hier zijn waarschijnlijk resten van oude bewoning of activiteit. Let op: bij graafwerk kan een vergunning nodig zijn.",vondsten:"Grote kans op interessante vondsten: aardewerk, munten, sieraden, gereedschap.",kleur:"text-orange-600"},5:{tekst:"Dit is een waterbodem. Vondsten zijn hier moeilijker te bereiken maar kunnen goed bewaard zijn gebleven.",vondsten:"Scheepswrakken, verloren lading, gedumpte voorwerpen.",kleur:"text-blue-600"},6:{tekst:"Waterbodem met archeologische potentie. Hier kunnen interessante vondsten liggen die door het water goed bewaard zijn.",vondsten:"Scheepsresten, ankers, aardewerk, metalen voorwerpen.",kleur:"text-blue-600"},7:{tekst:"Waterbodem met hoge archeologische waarde. Hier zijn bekende vindplaatsen of scheepswrakken.",vondsten:"Belangrijke maritieme vondsten, beschermd gebied.",kleur:"text-blue-700"}}[Ce];ze&&(le+=`<div class="text-sm ${ze.kleur} mt-1">${ze.tekst}</div>`,le+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',le+=`<div class="text-sm text-gray-700 mt-1">${ze.vondsten}</div>`),le+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is de IKAW?</span></div>',le+='<div class="text-sm text-gray-700 mt-1">De IKAW (Indicatieve Kaart Archeologische Waarden) toont de kans op archeologische vondsten in heel Nederland. De kaart is gemaakt door de Rijksdienst voor het Cultureel Erfgoed.</div>',Lt.push(le)}}catch(Fe){console.warn("IKAW WMS query failed:",Fe)}continue}if(rn==="Inundatiegebieden"){try{const Fe=bn(Tt),xe=Tn("EPSG:4326","EPSG:28992",Fe),_e=100,M=`https://services.rce.geovoorziening.nl/liniesenstellingen/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=inundaties&QUERY_LAYERS=inundaties&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-_e},${xe[1]-_e},${xe[0]+_e},${xe[1]+_e}`}`,W=await(await fetch(M)).json();if(W.features&&W.features.length>0){const ne=W.features[0].properties;let Ce='<strong class="text-blue-800">Inundatiegebied</strong>';(ne["linie-naam"]||ne.linie_naam)&&(Ce+=`<br/><span class="text-sm font-semibold text-blue-700">${ne["linie-naam"]||ne.linie_naam}</span>`),ne.naam&&(Ce+=`<br/><span class="text-sm text-gray-700">${ne.naam}</span>`),ne.periode&&(Ce+=`<br/><span class="text-xs text-gray-500">${ne.periode}</span>`),ne.lin_period&&(Ce+=`<br/><span class="text-xs text-gray-400">${ne.lin_period}</span>`),Lt.push(Ce)}}catch(Fe){console.warn("Inundatiegebieden WMS query failed:",Fe)}continue}if(rn==="Militaire Objecten"){try{const Fe=bn(Tt),xe=Tn("EPSG:4326","EPSG:28992",Fe),_e=50,M=`https://services.rce.geovoorziening.nl/liniesenstellingen/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=objecten&QUERY_LAYERS=objecten&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-_e},${xe[1]-_e},${xe[0]+_e},${xe[1]+_e}`}`,W=await(await fetch(M)).json();if(W.features&&W.features.length>0){const ne=W.features[0].properties,Ce=ne.obj_soort||"",q=ne.obj_naam||"",le=ne.lin_period||"",Ae=ne["linie-naam"]||ne.linie_naam||"";let ze=Ce||"Militair Object",Me="Dit is een historisch militair object uit de Nederlandse verdedigingsgeschiedenis.",He="";const $e=Ce.toLowerCase();$e.includes("fort")?(Me="Een fort is een versterkte verdedigingspost, vaak met dikke muren en geschutsopstellingen. Forten maakten deel uit van grotere verdedigingslinies.",He="Rond forten worden soms kogels, knopen van uniformen, muntjes of andere militaire voorwerpen gevonden."):$e.includes("schans")?(Me="Een schans is een kleinere versterking, vaak gemaakt van aarde en palissaden. Schansen werden gebruikt om strategische punten te verdedigen.",He="Bij schansen kun je musketkogels, knopen en soms munten uit de 17e-18e eeuw tegenkomen."):$e.includes("batterij")||$e.includes("battery")?(Me="Een batterij is een geschutsopstelling, vaak op een strategische plek om vijanden onder vuur te nemen.",He="Bij batterijen worden soms kanonkogels of onderdelen van geschut gevonden."):$e.includes("bunker")||$e.includes("kazemat")?(Me="Een bunker of kazemat is een versterkte betonnen schuilplaats. Veel werden gebouwd rond 1940 als onderdeel van verdedigingslinies.",He="Bij bunkers worden soms militaire voorwerpen uit WOII gevonden, zoals knopen, gespen of munitieresten."):$e.includes("sluis")||$e.includes("inlaatwerk")?(Me="Militaire sluizen en inlaatwerken werden gebruikt om land onder water te zetten (inunderen). Dit was een belangrijke verdedigingstactiek.",He="Bij historische sluizen worden soms voorwerpen gevonden van soldaten die deze bewaakten."):$e.includes("toren")||$e.includes("wachttoren")?(Me="Wachttorens werden gebruikt om de omgeving in de gaten te houden en vijandelijke bewegingen te signaleren.",He="Bij torens worden soms persoonlijke voorwerpen van soldaten gevonden."):$e.includes("kazerne")&&(Me="Een kazerne is een gebouw waar soldaten gelegerd waren. Hier woonden, aten en oefenden de troepen.",He="Rond kazernes worden regelmatig knopen, gespen en andere persoonlijke voorwerpen gevonden.");let yt=`<strong class="text-stone-800">${ze}</strong>`;q&&(yt+=`<br/><span class="text-sm font-semibold text-stone-700">${q}</span>`),Ae&&(yt+=`<br/><span class="text-sm text-blue-600">${Ae}</span>`),le&&(yt+=`<br/><span class="text-xs text-gray-500">${le}</span>`),yt+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',yt+=`<div class="text-sm text-gray-700 mt-1">${Me}</div>`,He&&(yt+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',yt+=`<div class="text-sm text-gray-700 mt-1">${He}</div>`),yt+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',yt+='<div class="text-sm text-gray-700 mt-1">',yt+='<a href="https://erfgoedenlocatie.nl/linies-en-stellingen" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">RCE Linies en Stellingen</a>',yt+="</div>",Lt.push(yt)}}catch(Fe){console.warn("Militaire Objecten WMS query failed:",Fe)}continue}if(rn==="Verdedigingslinies"){try{const Fe=bn(Tt),xe=Tn("EPSG:4326","EPSG:28992",Fe),_e=100,M=`https://services.rce.geovoorziening.nl/liniesenstellingen/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=linies&QUERY_LAYERS=linies&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-_e},${xe[1]-_e},${xe[0]+_e},${xe[1]+_e}`}`,W=await(await fetch(M)).json();if(W.features&&W.features.length>0){const ne=W.features[0].properties;let Ce='<strong class="text-amber-800">Verdedigingslinie</strong>';const q={"Hollandse Waterlinie":"Verdedigingsstelsel (1815-1940) dat gebruik maakte van inundaties om Holland te beschermen. UNESCO Werelderfgoed.","Nieuwe Hollandse Waterlinie":"Uitgebreide versie (1815-1940) met forten en inundatiegebieden van Muiden tot Gorinchem.","Stelling van Amsterdam":"Ringverdediging rond Amsterdam (1880-1920) met 42 forten. UNESCO Werelderfgoed.",Grebbelinie:"Verdedigingslinie langs de Grebbe (17e-20e eeuw). Zware gevechten in mei 1940.",IJssellinie:"Koude Oorlog verdediging (1950-1968) langs de IJssel tegen Sovjet-invasie.",Atlantikwall:"Duitse kustverdediging WOII (1942-1945) van Noorwegen tot Spanje.","Peel-Raamstelling":"Verdedigingslinie in Brabant/Limburg. Gevechten mei 1940.","Maas-Waalstelling":"Linie tussen Maas en Waal, onderdeel landsverdediging.",Zuiderwaterlinie:"Waterlinie in West-Brabant en Zeeland (17e-19e eeuw).","Staats-Spaanse Linies":"Vestingwerken uit de 80-jarige oorlog (1568-1648)."},le=ne.naam||ne.lin_naam||"";if(le){Ce+=`<br/><span class="text-sm font-semibold text-amber-700">${le}</span>`;const Ae=Object.entries(q).find(([ze])=>le.toLowerCase().includes(ze.toLowerCase())||ze.toLowerCase().includes(le.toLowerCase()));Ae&&(Ce+=`<br/><span class="text-sm text-gray-700">${Ae[1]}</span>`)}ne.lin_period&&(Ce+=`<br/><span class="text-xs text-purple-600">${ne.lin_period}</span>`),ne.status&&(Ce+=`<br/><span class="text-xs text-gray-400">${ne.status}</span>`),Lt.push(Ce)}}catch(Fe){console.warn("Verdedigingslinies WMS query failed:",Fe)}continue}if(rn==="Rijksmonumenten"){try{const Fe=bn(Tt),xe=Tn("EPSG:4326","EPSG:28992",Fe),_e=50,M=`https://data.geo.cultureelerfgoed.nl/openbaar/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=rijksmonumentpunten&QUERY_LAYERS=rijksmonumentpunten&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-_e},${xe[1]-_e},${xe[0]+_e},${xe[1]+_e}`}`,W=await(await fetch(M)).json();if(W.features&&W.features.length>0){const ne=W.features[0].properties;let Ce='<strong class="text-red-800">Rijksmonument</strong>';(ne.cbsNaam||ne.cbs_naam)&&(Ce+=`<br/><span class="text-sm font-semibold">${ne.cbsNaam||ne.cbs_naam}</span>`),ne.hoofdcategorie&&(Ce+=`<br/><span class="text-sm text-red-700">${ne.hoofdcategorie}</span>`),ne.subcategorie&&(Ce+=`<br/><span class="text-xs text-gray-600">${ne.subcategorie}</span>`),ne.rijksmonumentnummer&&(Ce+=`<br/><span class="text-xs text-gray-500">Nr: ${ne.rijksmonumentnummer}</span>`),(ne.bouwjaar||ne.oorspronkelijkebouwjaar)&&(Ce+=`<br/><span class="text-xs text-gray-500">Bouwjaar: ${ne.bouwjaar||ne.oorspronkelijkebouwjaar}</span>`),Ce+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',ne.rijksmonumentnummer&&(Ce+=`<div class="text-sm text-gray-700 mt-1"><a href="https://monumentenregister.cultureelerfgoed.nl/monumenten/${ne.rijksmonumentnummer}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Bekijk in Monumentenregister</a></div>`),Ce+='<div class="text-sm text-gray-700 mt-1"><a href="https://nl.wikipedia.org/wiki/Rijksmonument" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia: Rijksmonument</a></div>',Lt.push(Ce)}}catch(Fe){console.warn("Rijksmonumenten WMS query failed:",Fe)}continue}if(rn==="Werelderfgoed"){try{const Fe=bn(Tt),xe=Tn("EPSG:4326","EPSG:28992",Fe),_e=500,M=`https://service.pdok.nl/rce/ps-ch/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=PS.ProtectedSite&QUERY_LAYERS=PS.ProtectedSite&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-_e},${xe[1]-_e},${xe[0]+_e},${xe[1]+_e}`}`,W=await(await fetch(M)).json();if(W.features&&W.features.length>0){const ne=W.features[0].properties;let Ce='<strong class="text-cyan-800">UNESCO Werelderfgoed</strong>';(ne.siteName||ne.naam)&&(Ce+=`<br/><span class="text-sm font-semibold text-cyan-700">${ne.siteName||ne.naam}</span>`),ne.siteDesignation&&(Ce+=`<br/><span class="text-xs text-gray-600">${ne.siteDesignation}</span>`),Lt.push(Ce)}}catch(Fe){console.warn("Werelderfgoed WMS query failed:",Fe)}continue}if(rn==="Terpen"){try{const Fe=bn(Tt),xe=Tn("EPSG:4326","EPSG:28992",Fe),_e=`https://geoportaal.fryslan.nl/arcgis/rest/services/ProvinciaalGeoRegister/PGR2/MapServer/66/query?geometry=${xe[0]},${xe[1]}&geometryType=esriGeometryPoint&spatialRel=esriSpatialRelIntersects&outFields=SOORT,SHAPE_Area&returnGeometry=false&f=json`,M=await(await fetch(_e)).json();if(M.features&&M.features.length>0){const ut=M.features[0].attributes,W=ut.SOORT||"Terp",ne=ut.SHAPE_Area?Math.round(ut.SHAPE_Area):null;let Ce="",q="",le=!1;try{const yt=`https://service.pdok.nl/rce/ps-ch/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=PS.ProtectedSite&QUERY_LAYERS=PS.ProtectedSite&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-100},${xe[1]-100},${xe[0]+100},${xe[1]+100}`}`,Wt=await(await fetch(yt)).json();if(Wt.features&&Wt.features.length>0){const z=Wt.features[0].properties;Ce=z.siteName||z.naam||"",q=z.inspireId||z.monumentnummer||"",le=!0}}catch{}let Ae="";Ce?(Ae=`<strong class="text-orange-800">${Ce}</strong>`,Ae+=`<br/><span class="text-sm text-orange-600 font-medium">${W}</span>`):Ae=`<strong class="text-orange-800">${W}</strong>`,Ae+='<br/><span class="text-sm text-gray-600">Friese terp (woonheuvel)</span>';const Me={terp:{uitleg:"Een kunstmatige woonheuvel waar mensen woonden om droge voeten te houden.",periode:"IJzertijd tot Middeleeuwen"},"afgegraven terp":{uitleg:"Deze terp is deels of geheel afgegraven voor de vruchtbare grond (terpaarde).",periode:"Oorspronkelijk IJzertijd-Middeleeuwen"},terprestant:{uitleg:"Hier lag ooit een terp, waarvan nu alleen nog resten over zijn.",periode:"IJzertijd tot Middeleeuwen"},"deels afgegraven terp":{uitleg:"Een deel van deze terp is afgegraven, een deel is nog intact.",periode:"IJzertijd tot Middeleeuwen"},"verhoogd kerkhof":{uitleg:"Een verhoogd kerkhof, vaak op een oude terplocatie gebouwd.",periode:"Middeleeuwen"},kerkterp:{uitleg:"Een terp met daarop een kerk, vaak het centrum van een terpdorp.",periode:"IJzertijd tot heden"}}[W.toLowerCase()]||{uitleg:"Een kunstmatige woonheuvel uit de tijd dat dit gebied vaak overstroomde.",periode:"IJzertijd tot Middeleeuwen"};if(Ae+=`<div class="mt-2 text-sm text-gray-700">${Me.uitleg}</div>`,Ae+=`<br/><span class="text-sm text-gray-600">Periode: ${Me.periode}</span>`,ne&&ne>100){const He=(ne/1e4).toFixed(1);Ae+=`<br/><span class="text-sm text-gray-500">Oppervlak: ${He} hectare</span>`}if(le&&(Ae+='<div class="mt-2 p-2 bg-orange-100 rounded text-xs text-orange-800">',Ae+="<strong> Rijksmonument</strong> - Deze terp is wettelijk beschermd. Detecteren is niet toegestaan zonder vergunning.",q&&(Ae+=`<br/>Monumentnummer: ${q}`),Ae+="</div>"),Ae+='<div class="mt-2 p-2 bg-amber-50 rounded text-xs text-amber-800">',Ae+="<strong>Detectietip:</strong> ",W.toLowerCase().includes("afgegraven")?Ae+="Afgegraven terpen zijn interessant! Bij het afgraven kwam materiaal aan de oppervlakte. Zoek op akkers rond de oude terplocatie.":Ae+="Terpen zijn rijk aan vondsten: aardewerk, munten, fibulae, botten, gereedschap. De grond is vaak donker en vruchtbaar door eeuwenlange bewoning.",Ae+="</div>",Ae+='<div class="mt-3 space-y-1">',Ae+='<a href="https://www.terpenonderzoek.nl/" target="_blank" class="block text-blue-600 hover:underline text-sm">Terpenonderzoek.nl - Wetenschappelijk onderzoek</a>',Ae+='<a href="https://www.friesmuseum.nl/collectie/archeologie/" target="_blank" class="block text-blue-600 hover:underline text-sm">Fries Museum - Terpvondsten</a>',Ae+='<a href="https://nl.wikipedia.org/wiki/Terp" target="_blank" class="block text-blue-600 hover:underline text-sm">Wikipedia - Terpen</a>',Ce){const He=encodeURIComponent(Ce+" terp friesland");Ae+=`<a href="https://www.google.com/search?q=${He}" target="_blank" class="block text-blue-600 hover:underline text-sm">Zoek meer over ${Ce}</a>`}Ae+="</div>",Lt.push(Ae)}}catch(Fe){console.warn("Terpen query failed:",Fe)}continue}if(rn==="Religieus Erfgoed"){try{const Fe=bn(Tt),xe=Tn("EPSG:4326","EPSG:28992",Fe),_e=50,M=`https://services.rce.geovoorziening.nl/landschapsatlas_view/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=religieuserfgoed&QUERY_LAYERS=religieuserfgoed&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-_e},${xe[1]-_e},${xe[0]+_e},${xe[1]+_e}`}`,W=await(await fetch(M)).json();if(W.features&&W.features.length>0){const ne=W.features[0].properties,Ce=ne.naam||ne.NAAM||ne.name||ne.NAME||"Onbekend",q=ne.denominatie||ne.DENOMINATIE||ne.religie||"",le=ne.type||ne.TYPE||ne.functie||"",Ae=ne.bouwjaar||ne.BOUWJAAR||ne.jaar||"",ze=ne.gemeente||ne.GEMEENTE||ne.plaats||"";let Me=`<strong class="text-purple-800">${Ce}</strong>`;const He=le.toLowerCase();let $e="Een religieus gebouw of heilige plek.",yt="Munten van kerkgangers, knopen, gespen, religieuze voorwerpen";He.includes("kerk")||He.includes("church")?($e="Een kerk was het hart van de gemeenschap. Hier kwamen mensen samen voor diensten, maar ook voor belangrijke gebeurtenissen.",yt="Munten uit de collecte, knopen, gespen, pelgrimsinsignes, loden zegels"):He.includes("kapel")||He.includes("chapel")?($e="Een kapel is een klein gebedshuis, vaak bij een landgoed, langs een weg, of op een bijzondere plek.",yt="Devotionalia, munten, kruisjes, rozenkransen"):He.includes("synagoge")?($e="Een synagoge is een Joods gebedshuis. Veel synagogen in Nederland zijn verwoest of herbestemd na de Tweede Wereldoorlog.",yt="Munten, knopen, kleine religieuze voorwerpen"):He.includes("klooster")||He.includes("monastery")?($e="Een klooster was een woon- en werkplek voor monniken of nonnen. Veel kloosters hadden eigen werkplaatsen en landerijen.",yt="Religieuze voorwerpen, zegels, gereedschap, aardewerk, middeleeuwse munten"):He.includes("toren")||He.includes("tower")?($e="Een kerktoren of klokkentoren. Soms is alleen de toren nog over van een verdwenen kerk.",yt="Munten, knopen, bouwmateriaal"):(He.includes("begraafplaats")||He.includes("cemetery"))&&($e="Een historische begraafplaats. Detecteren op begraafplaatsen is niet toegestaan zonder toestemming.",yt="Detecteren hier niet toegestaan"),q&&(Me+=`<br/><span class="text-sm text-purple-600">${q}</span>`),le&&(Me+=`<br/><span class="text-sm text-gray-600">${le}</span>`),Ae&&(Me+=`<br/><span class="text-sm text-gray-500">Bouwjaar: ${Ae}</span>`),ze&&(Me+=`<br/><span class="text-xs text-gray-400">${ze}</span>`),Me+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',Me+=`<div class="text-sm text-gray-700 mt-1">${$e}</div>`,Me+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',Me+=`<div class="text-sm text-gray-700 mt-1">${yt}</div>`,Me+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bezoeken</span></div>',He.includes("begraafplaats")?Me+='<div class="text-sm text-red-600 mt-1">Detecteren op begraafplaatsen is niet toegestaan. Respecteer de rust van de overledenen.</div>':Me+='<div class="text-sm text-gray-700 mt-1">Veel kerken en religieuze gebouwen zijn beschermd monument. Vraag altijd toestemming voordat je gaat detecteren op het terrein.</div>',Lt.push(Me)}}catch(Fe){console.warn("Religieus Erfgoed WMS query failed:",Fe)}continue}if(rn==="Gewaspercelen"){try{const Fe=bn(Tt),xe=Tn("EPSG:4326","EPSG:28992",Fe),_e=50,Dt=`${xe[0]-_e},${xe[1]-_e},${xe[0]+_e},${xe[1]+_e}`,M=`https://service.pdok.nl/rvo/brpgewaspercelen/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=BrpGewas&QUERY_LAYERS=BrpGewas&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${Dt}`,ut=`https://service.pdok.nl/bzk/bro-bodemkaart/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=soilarea&QUERY_LAYERS=soilarea&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${Dt}`,[W,ne]=await Promise.all([fetch(M),fetch(ut).catch(()=>null)]),Ce=await W.json();if(Ce.features&&Ce.features.length>0){const q=Ce.features[0].properties;let le='<strong class="text-green-800">Landbouwperceel</strong>';if((q.gewas||q.gewasnaam)&&(le+=`<br/><span class="text-sm font-semibold text-green-700">${q.gewas||q.gewasnaam}</span>`),(q.categorie||q.category)&&(le+=`<br/><span class="text-xs text-gray-600">${q.categorie||q.category}</span>`),q.oppervlakte&&(le+=`<br/><span class="text-xs text-gray-500">${q.oppervlakte} ha</span>`),ne)try{const Ae=await ne.json();if(Ae.features&&Ae.features.length>0){const ze=Ae.features[0].properties,Me=ze.first_soilname||ze.soilname||ze.bodemtype,He=ze.first_soilcode||ze.soilcode||ze.maparea_soilcode;if(Me){le+=`<br/><span class="text-xs text-amber-700 font-medium">Grondsoort: ${Me}</span>`;const $e=rD(Me,He);$e.length>0&&(le+=`<br/><span class="text-xs text-gray-500 italic">${$e.join("  ")}</span>`)}}}catch{}Lt.push(le)}}catch(Fe){console.warn("BRP Gewaspercelen WMS query failed:",Fe)}continue}if(rn==="Kadastrale Grenzen"){try{const Fe=bn(Tt),xe=Tn("EPSG:4326","EPSG:28992",Fe),_e=20,M=`https://service.pdok.nl/kadaster/kadastralekaart/wms/v5_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=Perceel&QUERY_LAYERS=Perceel&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-_e},${xe[1]-_e},${xe[0]+_e},${xe[1]+_e}`}`,W=await(await fetch(M)).json();if(W.features&&W.features.length>0){const ne=W.features[0].properties,Ce=ne.kadastraleGemeenteWaarde||ne.kadastrale_gemeente_waarde||ne.kadastraleGemeente||mbe[String(ne.kadastraleGemeenteCode)]||ne.kadastraleGemeenteCode,q=ne.sectie||ne.Sectie||"",le=ne.perceelnummer||ne.perceelNummer||ne.Perceelnummer||"",Ae=ne.kadastraleGrootteWaarde||ne.kadastrale_grootte_waarde||ne.kadastraleGrootte||ne.oppervlakte,ze=ne.AKRKadastraleGemeenteCodeWaarde||ne.akrKadastraleGemeenteCodeWaarde||"",Me=[Ce,q,le].filter(Boolean).join(" "),He=ze&&q&&le?`${ze}-${q}-${le}`:"";let $e='<strong class="text-indigo-800">Kadastraal Perceel</strong>';if(Me&&($e+=`<br/><span class="text-sm text-indigo-700">${Me}</span>`),He&&($e+=`<br/><span class="text-sm font-bold text-gray-800 font-mono">${He}</span>`),Ae){const yt=typeof Ae=="number"?Ae:parseFloat(Ae);isNaN(yt)||($e+=`<br/><span class="text-xs text-gray-600">${yt.toLocaleString("nl-NL")} m</span>`)}$e+='<br/><br/><span class="text-xs text-gray-600">Eigenaar opzoeken? Kopieer bovenstaande code, ga naar </span><a href="https://www.kadaster.nl/winkel" target="_blank" rel="noopener" class="text-xs text-blue-600 hover:underline">kadaster.nl/winkel</a><span class="text-xs text-gray-600"> en klik "Zoek op aanduiding"</span><span class="text-xs text-gray-400"> (betaalde dienst)</span>',Lt.push($e)}}catch(Fe){console.warn("Kadastrale Grenzen WMS query failed:",Fe)}continue}if(rn==="Scheepswrakken"){try{const Fe=bn(Tt),xe=Tn("EPSG:4326","EPSG:28992",Fe),_e=100,M=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_ARCHEOLOGIE_SCHEEPSRESTANTEN&QUERY_LAYERS=CHS_2015_ARCHEOLOGIE_SCHEEPSRESTANTEN&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-_e},${xe[1]-_e},${xe[0]+_e},${xe[1]+_e}`}`,W=await(await fetch(M)).json();if(W.features&&W.features.length>0){const ne=W.features[0].properties;let q=`<strong class="text-cyan-800">${ne.naam||ne.NAAM||"Scheepswrak"}</strong>`;q+='<br/><span class="text-sm text-gray-800">Historisch scheepswrak in Zuid-Holland</span>',q+='<div class="mt-2 text-sm text-gray-700">',q+="Op deze plek ligt een oud scheepswrak. Dit is een schip dat lang geleden is gezonken. ",q+="In de bodem kunnen nog resten van het schip en de lading liggen.",q+="</div>",(ne.type||ne.TYPE)&&(q+=`<br/><span class="text-sm text-cyan-700">Type: ${ne.type||ne.TYPE}</span>`),(ne.datering||ne.DATERING)&&(q+=`<br/><span class="text-sm text-gray-600">Periode: ${ne.datering||ne.DATERING}</span>`),(ne.bron||ne.BRON)&&(q+=`<br/><span class="text-xs text-gray-500">Bron: ${ne.bron||ne.BRON}</span>`),q+='<div class="mt-2 p-2 bg-cyan-50 rounded text-xs text-cyan-800">',q+="<strong>Detectietip:</strong> Bij scheepswrakken kun je bijzondere vondsten doen zoals scheepsonderdelen, munten, gereedschap en lading. Let op: vaak is een vergunning nodig.",q+="</div>",q+='<div class="mt-2"><a href="https://www.zuid-holland.nl/onderwerpen/cultuur-erfgoed/" target="_blank" class="text-blue-600 hover:underline text-sm">Meer over erfgoed Zuid-Holland</a></div>',Lt.push(q)}}catch(Fe){console.warn("Scheepswrakken WMS query failed:",Fe)}continue}if(rn==="Woonheuvels ZH"){try{const Fe=bn(Tt),xe=Tn("EPSG:4326","EPSG:28992",Fe),_e=100,M=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_ARCHEOLOGIE_WOONHEUVEL&QUERY_LAYERS=CHS_2015_ARCHEOLOGIE_WOONHEUVEL&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-_e},${xe[1]-_e},${xe[0]+_e},${xe[1]+_e}`}`,W=await(await fetch(M)).json();if(W.features&&W.features.length>0){const ne=W.features[0].properties;let q=`<strong class="text-orange-800">${ne.naam||ne.NAAM||"Woonheuvel"}</strong>`;q+='<br/><span class="text-sm text-gray-800">Historische woonheuvel (terp)</span>',q+='<div class="mt-2 text-sm text-gray-700">',q+="Een woonheuvel is een door mensen opgeworpen heuvel. Mensen woonden hierop om droge voeten te houden bij hoog water. ",q+="Deze heuvels werden steeds hoger gemaakt. Je vindt ze vooral in laaggelegen gebieden.",q+="</div>",(ne.type||ne.TYPE)&&(q+=`<br/><span class="text-sm text-orange-700">Type: ${ne.type||ne.TYPE}</span>`),q+='<div class="mt-2 p-2 bg-orange-50 rounded text-xs text-orange-800">',q+="<strong>Detectietip:</strong> Woonheuvels zijn rijk aan vondsten! Denk aan aardewerk, munten, sieraden en huisraad uit de middeleeuwen. De grond bevat vaak veel materiaal.",q+="</div>",q+='<div class="mt-2"><a href="https://www.zuid-holland.nl/onderwerpen/cultuur-erfgoed/" target="_blank" class="text-blue-600 hover:underline text-sm">Meer over erfgoed Zuid-Holland</a></div>',Lt.push(q)}}catch(Fe){console.warn("Woonheuvels WMS query failed:",Fe)}continue}if(rn==="Romeinse Forten"){try{const Fe=bn(Tt),xe=Tn("EPSG:4326","EPSG:28992",Fe),_e=200,M=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_ARCHEOLOGIE_ROMEINSFORT&QUERY_LAYERS=CHS_2015_ARCHEOLOGIE_ROMEINSFORT&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-_e},${xe[1]-_e},${xe[0]+_e},${xe[1]+_e}`}`,W=await(await fetch(M)).json();if(W.features&&W.features.length>0){const ne=W.features[0].properties;let q=`<strong class="text-red-800">${ne.naam||ne.NAAM||"Romeins Fort"}</strong>`;q+='<br/><span class="text-sm text-gray-800">Romeins militair fort (castellum)</span>',q+='<div class="mt-2 text-sm text-gray-700">',q+="Dit was een Romeins legerfort. De Romeinen bouwden deze forten langs de Rijn, de grens van hun rijk. ",q+="Soldaten woonden hier en bewaakten de grens. Deze forten zijn ongeveer 2000 jaar oud.",q+="</div>",(ne.type||ne.TYPE)&&(q+=`<br/><span class="text-sm text-red-700">Type: ${ne.type||ne.TYPE}</span>`),(ne.periode||ne.PERIODE)&&(q+=`<br/><span class="text-sm text-gray-600">Periode: ${ne.periode||ne.PERIODE}</span>`),q+='<div class="mt-2 p-2 bg-red-50 rounded text-xs text-red-800">',q+="<strong>Detectietip:</strong> Romeinse forten zijn toplocaties! Je kunt hier Romeinse munten, fibulae (mantelspelden), militaire uitrusting en aardewerk vinden. Vaak beschermd, check de regels!",q+="</div>",q+='<div class="mt-2"><a href="https://www.limesworld.nl/" target="_blank" class="text-blue-600 hover:underline text-sm">Meer over de Romeinse Limes</a></div>',Lt.push(q)}}catch(Fe){console.warn("Romeinse Forten WMS query failed:",Fe)}continue}if(rn==="Windmolens"){try{const Fe=bn(Tt),xe=Tn("EPSG:4326","EPSG:28992",Fe),_e=50,M=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_NEDERZETTING_WINDMOLENS&QUERY_LAYERS=CHS_2015_NEDERZETTING_WINDMOLENS&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-_e},${xe[1]-_e},${xe[0]+_e},${xe[1]+_e}`}`,W=await(await fetch(M)).json();if(W.features&&W.features.length>0){const ne=W.features[0].properties;let q=`<strong class="text-amber-800">${ne.naam||ne.NAAM||"Windmolen"}</strong>`;if(q+='<br/><span class="text-sm text-gray-800">Historische windmolen</span>',q+='<div class="mt-2 text-sm text-gray-700">',q+="Windmolens gebruikten de kracht van de wind. Ze maalden graan tot meel of pompten water weg uit polders. ",q+="Nederland heeft veel molens omdat we laaggelegen land droog moesten houden.",q+="</div>",ne.type||ne.TYPE||ne.functie||ne.FUNCTIE){const le=ne.functie||ne.FUNCTIE||ne.type||ne.TYPE;q+=`<br/><span class="text-sm text-amber-700">Functie: ${le}</span>`}(ne.bouwjaar||ne.BOUWJAAR)&&(q+=`<br/><span class="text-sm text-gray-600">Bouwjaar: ${ne.bouwjaar||ne.BOUWJAAR}</span>`),q+='<div class="mt-2 p-2 bg-amber-50 rounded text-xs text-amber-800">',q+="<strong>Detectietip:</strong> Bij molens vind je vaak voorwerpen van de molenaar en bezoekers: munten, knopen, gereedschap. Ook de grond rond verdwenen molens kan interessant zijn.",q+="</div>",q+='<div class="mt-2"><a href="https://www.molendatabase.nl/" target="_blank" class="text-blue-600 hover:underline text-sm">Meer over Nederlandse molens</a></div>',Lt.push(q)}}catch(Fe){console.warn("Windmolens WMS query failed:",Fe)}continue}if(rn==="Erfgoedlijnen"){try{const Fe=bn(Tt),xe=Tn("EPSG:4326","EPSG:28992",Fe),_e=200,M=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_ERFGOEDLIJN_HOOFDSTRUCTUUR&QUERY_LAYERS=CHS_ERFGOEDLIJN_HOOFDSTRUCTUUR&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-_e},${xe[1]-_e},${xe[0]+_e},${xe[1]+_e}`}`,W=await(await fetch(M)).json();if(W.features&&W.features.length>0){const ne=W.features[0].properties;let q=`<strong class="text-purple-800">${ne.naam||ne.NAAM||ne.erfgoedlijn||"Erfgoedlijn"}</strong>`;q+='<br/><span class="text-sm text-gray-800">Historische lijn in het landschap</span>',q+='<div class="mt-2 text-sm text-gray-700">',q+="Een erfgoedlijn is een route of lijn met veel geschiedenis. Dit kunnen oude dijken, wegen, kanalen of verdedigingslinies zijn. ",q+="Langs deze lijnen vind je vaak bijzondere plekken.",q+="</div>",(ne.type||ne.TYPE)&&(q+=`<br/><span class="text-sm text-purple-700">Type: ${ne.type||ne.TYPE}</span>`),(ne.omschrijving||ne.OMSCHRIJVING)&&(q+=`<br/><span class="text-sm text-gray-600">${ne.omschrijving||ne.OMSCHRIJVING}</span>`),q+='<div class="mt-2 p-2 bg-purple-50 rounded text-xs text-purple-800">',q+="<strong>Detectietip:</strong> Erfgoedlijnen volgen oude routes waar mensen langskwamen. Denk aan munten, knopen, gespen en andere verloren voorwerpen. Dijken en wegen zijn vaak interessant.",q+="</div>",q+='<div class="mt-2"><a href="https://www.erfgoedlijnen.nl/" target="_blank" class="text-blue-600 hover:underline text-sm">Meer over Erfgoedlijnen</a></div>',Lt.push(q)}}catch(Fe){console.warn("Erfgoedlijnen WMS query failed:",Fe)}continue}if(rn==="Oude Kernen"){try{const Fe=bn(Tt),xe=Tn("EPSG:4326","EPSG:28992",Fe),_e=200,M=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_ARCHEOLOGIE_KERNEN&QUERY_LAYERS=CHS_2015_ARCHEOLOGIE_KERNEN&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-_e},${xe[1]-_e},${xe[0]+_e},${xe[1]+_e}`}`,W=await(await fetch(M)).json();if(W.features&&W.features.length>0){const ne=W.features[0].properties;let q=`<strong class="text-stone-800">${ne.naam||ne.NAAM||"Historische Kern"}</strong>`;q+='<br/><span class="text-sm text-gray-800">Oude dorps- of stadskern</span>',q+='<div class="mt-2 text-sm text-gray-700">',q+="Dit is het oude centrum van een dorp of stad. Hier woonden en werkten mensen al honderden jaren geleden. ",q+="De grond bevat vaak veel sporen van het verleden.",q+="</div>",(ne.type||ne.TYPE)&&(q+=`<br/><span class="text-sm text-stone-700">Type: ${ne.type||ne.TYPE}</span>`),(ne.periode||ne.PERIODE)&&(q+=`<br/><span class="text-sm text-gray-600">Periode: ${ne.periode||ne.PERIODE}</span>`),q+='<div class="mt-2 p-2 bg-stone-100 rounded text-xs text-stone-800">',q+="<strong>Detectietip:</strong> Oude kernen zijn rijk aan vondsten! Munten, knopen, sieraden, gereedschap en huisraad. Let op: detecteren is vaak niet toegestaan in beschermde kernen.",q+="</div>",q+='<div class="mt-2"><a href="https://www.zuid-holland.nl/onderwerpen/cultuur-erfgoed/" target="_blank" class="text-blue-600 hover:underline text-sm">Meer over erfgoed Zuid-Holland</a></div>',Lt.push(q)}}catch(Fe){console.warn("Oude Kernen WMS query failed:",Fe)}continue}if(rn==="Relictenkaart Punten"){try{const Fe=bn(Tt),xe=Tn("EPSG:4326","EPSG:28992",Fe),_e=50,M=`https://geoserver.gelderland.nl/geoserver/ngr_a/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=ChAr_Relictenkaart_p&QUERY_LAYERS=ChAr_Relictenkaart_p&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-_e},${xe[1]-_e},${xe[0]+_e},${xe[1]+_e}`}`,W=await(await fetch(M)).json();if(W.features&&W.features.length>0){const ne=W.features[0].properties,Ce={KV:{naam:"Kasteel of Vesting",uitleg:"Een versterkt gebouw uit de middeleeuwen. Vaak zijn er nog resten in de grond."},K:{naam:"Kapel",uitleg:"Een klein kerkgebouw. Rond kapellen worden vaak religieuze voorwerpen gevonden."},KE:{naam:"Kerkhof",uitleg:"Historische begraafplaats. Respecteer deze plek en vraag altijd toestemming."},B:{naam:"Buitenhuis",uitleg:"Een landhuis van welgestelde families. Vaak met tuinen en bijgebouwen."},OB:{naam:"Oud Bebouwingsrelict",uitleg:"Resten van oude bebouwing. Hier stonden ooit huizen of boerderijen."},OV:{naam:"Oude Verkaveling",uitleg:"Historisch patroon van akkers en weilanden uit vroeger tijden."},NR:{naam:"Nijverheidsrelict",uitleg:"Plek waar vroeger ambacht of industrie was, zoals smederijen of molens."},GH:{naam:"Grafheuvel",uitleg:"Prehistorische begraafplaats. Beschermd monument - niet detecteren!"},BP:{naam:"Begraafplaats",uitleg:"Historische begraafplaats. Respecteer deze plek."},HH:{naam:"Havezate",uitleg:"Adellijk huis met landerijen. Interessant voor middeleeuwse vondsten."},RM:{naam:"Rosmolen",uitleg:"Molen aangedreven door paarden. Zeldzaam cultuurhistorisch object."},WM:{naam:"Windmolen",uitleg:"Historische windmolen. Vaak zijn funderingen nog zichtbaar."},PM:{naam:"Poldermolen",uitleg:"Molen voor waterbeheer. Belangrijk voor de waterhuishouding."},EK:{naam:"Eendenkooi",uitleg:"Plek om wilde eenden te vangen. Bijzonder cultuurlandschap."},SH:{naam:"Scholtenhoeve",uitleg:"Boerderij van een welgestelde boer. Vaak eeuwenoud."},SL:{naam:"Slot",uitleg:"Versterkt kasteel of adellijke woning."},MO:{naam:"Motte",uitleg:"Vroegmiddeleeuwse kasteelberg. Zeer interessant voor detectie."},BR:{naam:"Borg",uitleg:"Versterkte adellijke woning, typisch voor het noorden."}},q=ne.type?.replace(/[0-9]/g,"")||"",le=Ce[q]||{naam:ne.type||"Cultuurhistorisch object",uitleg:"Een historisch relict in het Gelderse landschap."};let Ae=`<strong class="text-emerald-800">${le.naam}</strong>`;Ae+='<br/><span class="text-sm text-gray-800">Gelders cultuurhistorisch relict</span>',ne.streek&&(Ae+=`<br/><span class="text-sm text-gray-600">Streek: ${ne.streek}</span>`),Ae+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is dit?</span></div>',Ae+=`<div class="text-sm text-gray-700 mt-1">${le.uitleg}</div>`,Ae+='<div class="mt-3"><a href="https://www.gelderland.nl/erfgoed" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline text-sm">Meer over Gelders erfgoed</a></div>',Lt.push(Ae)}}catch(Fe){console.warn("Relictenkaart Punten WMS query failed:",Fe)}continue}if(rn==="Relictenkaart Lijnen"){try{const Fe=bn(Tt),xe=Tn("EPSG:4326","EPSG:28992",Fe),_e=50,M=`https://geoserver.gelderland.nl/geoserver/ngr_a/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=ChAr_Relictenkaart_l&QUERY_LAYERS=ChAr_Relictenkaart_l&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-_e},${xe[1]-_e},${xe[0]+_e},${xe[1]+_e}`}`,W=await(await fetch(M)).json();if(W.features&&W.features.length>0){const ne=W.features[0].properties,q={1:{naam:"Sprengenbeek",uitleg:"Kunstmatig aangelegde beek voor waterkracht. Vaak bij papiermolens."},2:{naam:"Oude waterloop",uitleg:"Historische beek of rivier. Langs waterlopen vind je vaak oude bewoningssporen."},3:{naam:"Doorgaande weg",uitleg:"Eeuwenoude handelsroute. Langs deze wegen gingen reizigers en handelaren."},4:{naam:"Hessenweg",uitleg:"Historische handelsweg naar Duitsland. Gebruikt door marskramers en kooplieden."},5:{naam:"Oude weg",uitleg:"Historische route door het landschap. Vaak al eeuwen in gebruik."},6:{naam:"Historische grens",uitleg:"Oude eigendoms- of gebiedsgrens. Soms gemarkeerd met grenspalen."},7:{naam:"Trekpad",uitleg:"Pad langs een kanaal waar paarden schepen trokken."},8:{naam:"Jaagpad",uitleg:"Pad langs water voor scheepvaart met paardentractie."}}[ne.klasse]||{naam:"Historisch lijnrelict",uitleg:"Een lijnvormig historisch element in het landschap."};let le=`<strong class="text-teal-800">${q.naam}</strong>`;le+='<br/><span class="text-sm text-gray-800">Gelders lijnrelict</span>',le+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is dit?</span></div>',le+=`<div class="text-sm text-gray-700 mt-1">${q.uitleg}</div>`,le+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Tip</span></div>',le+='<div class="text-sm text-gray-700 mt-1">Langs oude wegen en waterlopen worden vaak vondsten gedaan. Mensen verloren er munten en voorwerpen.</div>',Lt.push(le)}}catch(Fe){console.warn("Relictenkaart Lijnen WMS query failed:",Fe)}continue}if(rn==="Relictenkaart Vlakken"){try{const Fe=bn(Tt),xe=Tn("EPSG:4326","EPSG:28992",Fe),_e=100,M=`https://geoserver.gelderland.nl/geoserver/ngr_a/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=ChAr_Relictenkaart_v&QUERY_LAYERS=ChAr_Relictenkaart_v&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-_e},${xe[1]-_e},${xe[0]+_e},${xe[1]+_e}`}`,W=await(await fetch(M)).json();if(W.features&&W.features.length>0){const ne=W.features[0].properties,q={1:{naam:"Oud agrarisch land",uitleg:"Gebied dat al voor 1850 als landbouwgrond werd gebruikt. Rijk aan geschiedenis."},2:{naam:"Jonge heideontginning",uitleg:"Heide die tussen 1850 en 1950 is ontgonnen voor landbouw."},3:{naam:"Open essencomplex",uitleg:"Historische akkers op hoge grond. Vaak eeuwenoud en rijk aan vondsten."},4:{naam:"Kampenlandschap",uitleg:"Landschap met kleine akkers omringd door houtwallen. Typisch voor Oost-Nederland."},5:{naam:"Heiderelict",uitleg:"Restant van het vroegere uitgestrekte heidelandschap. Vaak prehistorische vondsten."},6:{naam:"Oud bosrelict",uitleg:"Bos dat al in 1850 bestond. Oude bossen bevatten vaak cultuurhistorische resten."},7:{naam:"Stuifzandrelict",uitleg:"Overblijfsel van actief stuifzand. Vaak bij grafheuvels en prehistorische sites."},8:{naam:"Oud bouwland",uitleg:"Historische akkergrond. Boeren hebben hier eeuwenlang gewerkt."},9:{naam:"Historisch grasland",uitleg:"Oud weiland of hooiland. Vaak bij boerderijen en dorpen."},10:{naam:"Beekdal",uitleg:"Laagte langs een beek. Mensen woonden graag bij water."}}[ne.klasse]||{naam:"Historisch landschap",uitleg:"Een waardevol cultuurlandschap in Gelderland."};let le=`<strong class="text-lime-800">${q.naam}</strong>`;if(le+='<br/><span class="text-sm text-gray-800">Gelders landschapsrelict</span>',ne.st_area_shape_){const Ae=(ne.st_area_shape_/1e4).toFixed(1);le+=`<br/><span class="text-sm text-gray-600">${Ae} hectare</span>`}le+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is dit?</span></div>',le+=`<div class="text-sm text-gray-700 mt-1">${q.uitleg}</div>`,Lt.push(le)}}catch(Fe){console.warn("Relictenkaart Vlakken WMS query failed:",Fe)}continue}if(rn==="Verdronken Dorpen"){try{const Fe=bn(Tt),xe=Tn("EPSG:4326","EPSG:28992",Fe),_e=200,M=`https://opengeodata.zeeland.nl/geoserver/chs/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=geocmd_vrddrppnt&QUERY_LAYERS=geocmd_vrddrppnt&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-_e},${xe[1]-_e},${xe[0]+_e},${xe[1]+_e}`}`,W=await(await fetch(M)).json();if(W.features&&W.features.length>0){const ne=W.features[0].properties;let q=`<strong class="text-blue-800">${ne.naam||ne.NAAM||"Verdronken dorp"}</strong>`;q+='<br/><span class="text-sm text-gray-800">Verdronken dorp in Zeeland</span>',q+='<div class="mt-2 text-sm text-gray-700">',q+="Dit dorp is lang geleden door de zee verzwolgen. Bij stormvloeden brak de zeedijk door en liep het land onder water. ",q+="De mensen vluchtten, maar hun huizen en bezittingen bleven achter. In de bodem liggen nog resten van dit dorp.",q+="</div>",(ne.verdronken||ne.VERDRONKEN||ne.jaar||ne.JAAR)&&(q+=`<br/><span class="text-sm text-blue-700">Verdronken in: ${ne.verdronken||ne.VERDRONKEN||ne.jaar||ne.JAAR}</span>`),(ne.gemeente||ne.GEMEENTE)&&(q+=`<br/><span class="text-sm text-gray-600">Gemeente: ${ne.gemeente||ne.GEMEENTE}</span>`),(ne.bron||ne.BRON)&&(q+=`<br/><span class="text-xs text-gray-500">Bron: ${ne.bron||ne.BRON}</span>`),q+='<div class="mt-2 p-2 bg-blue-50 rounded text-xs text-blue-800">',q+="<strong>Detectietip:</strong> Verdronken dorpen bevatten veel vondsten! Aardewerk, munten, sieraden, gereedschap en huisraad. Bij laag water komen soms stukken vrij. Let op getijden en veiligheid!",q+="</div>",q+='<div class="mt-2"><a href="https://www.verdronkengeschiedenis.nl/" target="_blank" class="text-blue-600 hover:underline text-sm">Meer over verdronken dorpen</a></div>',Lt.push(q)}}catch(Fe){console.warn("Verdronken Dorpen WMS query failed:",Fe)}continue}const Tr=li.getFeatureInfoUrl(Tt,an,"EPSG:3857",{INFO_FORMAT:"application/json"});if(Tr)try{const xe=await(await fetch(Tr)).json();if(xe.features&&xe.features.length>0){const _e=xe.features[0].properties;if(rn==="AHN 0.5m"){let W='<strong class="text-blue-800">AHN Hoogtekaart</strong>';const ne=_e.value_list??_e.GRAY_INDEX??_e.value??_e.gray_index??_e.dtm_05m??_e.DTM_05M??_e.hoogte??_e.HOOGTE??_e.elevation??_e.ELEVATION;if(ne!=null&&!isNaN(Number(ne))){const Ce=typeof ne=="number"?ne.toFixed(2):Number(ne).toFixed(2);W+=`<br/><span class="text-sm text-blue-700">Hoogte: ${Ce} m NAP</span>`,Lt.push(W)}else{let Ce=!1;const q=["geometry","id","fid","gml_id","bbox"];for(const[le,Ae]of Object.entries(_e))!q.includes(le.toLowerCase())&&Ae!==null&&Ae!==""&&(W+=`<br/><span class="text-xs text-gray-600">${le}: ${Ae}</span>`,Ce=!0);Ce&&Lt.push(W)}continue}if(rn==="Geomorfologie"){let W='<strong class="text-green-800">Geomorfologie</strong>',ne=!1;const Ce=_e.landform_subgroup_description,q=_e.relief_klasse,le=_e.relief_subklasse,Ae=_e.genese_description,ze=_e.active_process;if(Ce&&(W+=`<br/><span class="text-sm text-green-700">${Ce}</span>`,ne=!0),q){const Me=le&&le!==q?`${q} (${le})`:q;W+=`<br/><span class="text-xs text-gray-600">Relief: ${Me}</span>`,ne=!0}if(Ae&&(W+=`<br/><span class="text-xs text-gray-500">Ontstaan: ${Ae}</span>`,ne=!0),ze&&ze!=="onbekend"&&(W+=`<br/><span class="text-xs text-gray-500">Actief proces: ${ze}</span>`,ne=!0),!ne){const Me=["geometry","id","fid","gml_id","bbox","fuuid","geom","collection_id"];for(const[He,$e]of Object.entries(_e))!Me.includes(He.toLowerCase())&&$e!==null&&$e!==""&&!He.includes("validfrom")&&!He.includes("validto")&&(W+=`<br/><span class="text-xs text-gray-600">${He}: ${$e}</span>`)}W+='<br/><a href="https://legendageomorfologie.wur.nl/" target="_blank" rel="noopener" class="text-xs text-blue-600 hover:underline">Meer over geomorfologie</a>',Lt.push(W);continue}let Dt=`<strong>${rn}</strong>`;const M=_e.first_soilname||_e.soilname,ut=_e.soilcode||_e.first_soilcode;if(M&&(Dt+=`<br/><span class="text-sm text-amber-700">${M}</span>`,rn==="Bodemkaart")){const W=rD(M,ut);W.length>0&&(Dt+=`<br/><span class="text-xs text-gray-500 italic">${W.join("  ")}</span>`)}if(_e.soilslope&&_e.soilslope!=="Niet opgenomen"&&(Dt+=`<br/><span class="text-xs text-gray-500">Helling: ${_e.soilslope}</span>`),!M){const W=["geometry","id","fid","gml_id","GRAY_INDEX","gray_index","value"];for(const[ne,Ce]of Object.entries(_e))!W.includes(ne)&&Ce&&Ce!=="Niet opgenomen"&&(Dt+=`<br/><span class="text-xs text-gray-600">${ne}: ${Ce}</span>`)}Lt.push(Dt)}}catch(Fe){console.warn("WMS GetFeatureInfo failed:",Fe)}}return Lt},In=async Tt=>{const an=[],Lt=[],Yi=xe=>{if(!xe)return;const _e=xe.getType(),M=xe.clone().transform("EPSG:3857","EPSG:4326").getCoordinates();return{type:_e,coordinates:M}},Mr=gbe(Tt.coordinate),li=[];n.forEachFeatureAtPixel(Tt.pixel,xe=>{li.push(xe)});for(const xe of li){const _e=xe.getProperties(),{geometry:Dt,...M}=_e;if(M.vondst){const q=M.vondst,le=`<strong>${q.objectType}</strong>
            <div data-vondst-id="${q.id}"></div>
            <br/><span class="text-sm text-gray-600"><strong>Materiaal:</strong> ${q.material}</span>
            <br/><span class="text-sm text-gray-600"><strong>Periode:</strong> ${q.period}</span>
            ${q.depth?`<br/><span class="text-sm text-gray-600"><strong>Diepte:</strong> ${q.depth} cm</span>`:""}
            ${q.condition&&q.condition!=="Onbekend"?`<br/><span class="text-sm text-gray-600"><strong>Conditie:</strong> ${q.condition}</span>`:""}
            ${q.weight?`<br/><span class="text-sm text-gray-600"><strong>Gewicht:</strong> ${q.weight} gram</span>`:""}
            ${q.notes?`<br/><span class="text-sm text-gray-600"><strong>Notities:</strong> ${q.notes}</span>`:""}
            ${q.photoUrl?`<br/><a href="${q.photoUrl}" target="_blank" rel="noopener" class="text-blue-600 hover:underline text-sm"> Bekijk foto</a>`:""}
            <br/><span class="text-xs text-gray-400">${new Date(q.timestamp).toLocaleDateString("nl-NL")}</span>`;an.push(le),Lt.push(null),L(q.id);continue}if(M.layerType==="customPoint"&&M.customPoint){const q=M.customPoint,le=M.customLayerName||"Mijn Laag",Ae=M.customLayerColor||"#f97316";let ze="";if(q.popupContent?(ze=`<div class="flex items-center gap-2 mb-2 pb-2 border-b border-gray-100">
              <span class="w-3 h-3 rounded-full flex-shrink-0" style="background-color: ${Ae}"></span>
              <span class="text-xs font-medium" style="color: ${Ae}">${le}</span>
            </div>`,ze+=q.popupContent):(ze=`<strong>${q.name}</strong>`,ze+=`<br/><span class="text-xs text-gray-500">${le}</span>`,q.category&&q.category!=="Overig"&&(ze+=`<br/><span class="text-sm text-gray-600"><strong>Categorie:</strong> ${q.category}</span>`)),q.photos&&q.photos.length>0){ze+='<div class="flex flex-wrap gap-1 my-2">';for(const Me of q.photos.slice(0,3)){const He=Me.thumbnailUrl||Me.thumbnailBase64;He&&(ze+=`<img src="${He}" alt="Foto" class="w-16 h-16 object-cover rounded border border-gray-200" />`)}q.photos.length>3&&(ze+=`<span class="text-xs text-gray-400 self-end">+${q.photos.length-3} meer</span>`),ze+="</div>"}q.notes&&!q.popupContent&&(ze+=`<br/><span class="text-sm text-gray-600 mt-1">${q.notes}</span>`),q.url&&(ze+=`<br/><a href="${q.url}" target="_blank" rel="noopener" class="text-blue-600 hover:underline text-sm">Meer info</a>`),ze+=`<br/><span class="text-xs text-gray-400">${new Date(q.createdAt).toLocaleDateString("nl-NL")}</span>`,an.push(ze),Lt.push(null);continue}if(M.layerType==="importedLayer"){const q=M.layerName||"Gemporteerde laag",le=M.layerColor||"#8b5cf6",Ae=["layerType","layerId","layerName","layerColor","featureIndex","geometry"],ze=M.name||M.Name||M.naam||M.title||M.NAAM||M.NAME||M.label||M.description||"Feature";let Me=`<strong style="color: ${le}">${ze}</strong>`;Me+=`<br/><span class="text-xs text-gray-500">${q}</span>`;const He=Object.entries(M).filter(([$e])=>!Ae.includes($e)&&$e!=="name"&&$e!=="Name");if(He.length>0){Me+='<div class="mt-2 space-y-1">';for(const[$e,yt]of He)if(yt!=null&&yt!==""){const At=$e.replace(/_/g," ").replace(/([a-z])([A-Z])/g,"$1 $2").replace(/^./,z=>z.toUpperCase());let Wt=String(yt);Wt.length>200&&(Wt=Wt.substring(0,200)+"..."),Wt.startsWith("http://")||Wt.startsWith("https://")?Me+=`<div class="text-sm"><span class="text-gray-500">${At}:</span> <a href="${Wt}" target="_blank" rel="noopener" class="text-blue-600 hover:underline">Link</a></div>`:Me+=`<div class="text-sm"><span class="text-gray-500">${At}:</span> <span class="text-gray-700">${Wt}</span></div>`}Me+="</div>"}an.push(Me),Lt.push({geometry:Yi(Dt),properties:M,popupHtml:Me});continue}if(M.kwaliteitswaarde&&M.kwaliteitswaarde.includes("archeologische waarde")){const q=_t(M);an.push(q),Lt.push({geometry:Yi(Dt),properties:M,popupHtml:q});continue}if(M.layerType==="romeinsFort"||M.layerType==="romeinsFortLijn"){const q=M.Name||M.name||"";M.description;const le=hbe[q]||null,Ae=le||dbe;let ze=`<strong class="text-red-800">${le?Ae.naam:q||"Romeins Fort"}</strong>`;if(ze+=`<br/><span class="text-sm text-red-700">${fbe[Ae.type]||Ae.type}</span>`,ze+=`<br/><span class="text-sm text-gray-500">${Ae.periode}</span>`,M.layerType==="romeinsFortLijn"&&(ze+='<br/><span class="text-sm text-red-600"> Gereconstrueerde fortomtrek</span>'),ze+=`<br/><span class="text-xs text-gray-600 mt-1 block">${Ae.beschrijving}</span>`,le?.bronnen&&le.bronnen.length>0){const Me=le.bronnen[0].replace(/^https?:\/\//,"").split("/")[0];ze+=`<br/><a href="${le.bronnen[0]}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline text-xs">${Me}</a>`}an.push(ze),Lt.push({geometry:Yi(Dt),properties:M,popupHtml:ze});continue}let ut=M.name||M.Name||M.naam||M.title||M.NAAM||M.NAME||M.label||M.route_name||M.road_name;ut||(M.leisure==="playground"?ut="Speeltuin":M.leisure==="park"?ut="Park":M.leisure==="swimming_area"||M.sport==="swimming"?ut="Zwemplek":M.tourism==="museum"?ut="Museum":M.amenity==="cafe"||M.amenity==="restaurant"?ut=M.amenity==="cafe"?"Caf":"Restaurant":M.historic==="castle"?ut="Kasteel":ut="Info"),(M.bunker_type||M.name&&(M.name.toLowerCase().includes("bunker")||M.name.toLowerCase().includes("kazemat")||M.name.toLowerCase().includes("schuilplaats")))&&(ut="Bunker"),M.historic==="battlefield"&&(ut="Historisch slagveld");let W=`<strong>${ut}</strong>`,ne=!1;if(M.category&&(W+=`<br/><span class="text-sm text-gray-600">Categorie: ${M.category}</span>`),M.from_to&&M.from_to!==ut&&(W+=`<br/><span class="text-sm text-gray-600">${M.from_to}</span>`),M.route&&M.route!==ut&&(W+=`<br/><span class="text-sm text-gray-600">${M.route}</span>`),M.TOPONIEM&&(W+=`<br/><span class="text-sm font-semibold text-gray-800">${M.TOPONIEM}</span>`,M.PLAATS&&(W+=`<br/><span class="text-xs text-gray-500">${M.PLAATS}</span>`)),(M.AARD_VINDP||M.Aard_vindp)&&(W+=`<br/><span class="text-sm text-gray-700">Aard: ${M.AARD_VINDP||M.Aard_vindp}</span>`),M.BEGIN_PER&&M.EIND_PER&&(W+=`<br/><span class="text-sm text-purple-700">Periode: ${M.BEGIN_PER} - ${M.EIND_PER}</span>`),(M.AARD_OPM||M.Aard_opmer)&&(W+=`<br/><span class="text-xs text-gray-600 italic">${M.AARD_OPM||M.Aard_opmer}</span>`),M.Gemeente&&(W+=`<br/><span class="text-sm text-gray-600">Gemeente: ${M.Gemeente}</span>`),M.Bron&&(W+=`<br/><span class="text-xs text-gray-500">Bron: ${M.Bron}</span>`),M.Bron_besch&&(W+=`<br/><span class="text-xs text-gray-500">${M.Bron_besch}</span>`),M.Dat_st_z&&M.Dat_ei_z&&(W+=`<br/><span class="text-sm text-purple-700">Datering: ${M.Dat_st_z} - ${M.Dat_ei_z}</span>`),M.Begin&&M.Einde&&(W+=`<br/><span class="text-sm text-purple-700">Periode: ${M.Begin} - ${M.Einde}</span>`),M.Uiterwaard&&(W+=`<br/><span class="text-sm font-semibold">${M.Uiterwaard}</span>`),M.rivier&&(W+=`<br/><span class="text-sm text-blue-600">Rivier: ${M.rivier}</span>`),M.Beschrijvi&&(W+=`<br/><span class="text-sm text-gray-700">${M.Beschrijvi}</span>`),M.leisure==="park"){ne=!0,W=`<strong class="text-green-800">${M.name||"Park"}</strong>`,W+='<br/><span class="text-sm text-gray-800">Park</span>',M.description&&(W+=`<div class="mt-2 text-sm text-gray-700">${M.description}</div>`),M.area&&(W+=`<br/><span class="text-sm text-gray-600">Oppervlakte: ${M.area}</span>`);const le=[];if(M.dog==="yes"&&le.push("Honden toegestaan"),M.lit==="yes"&&le.push("Verlicht"),M.bench==="yes"&&le.push("Bankjes"),le.length>0&&(W+=`<br/><span class="text-sm text-gray-600">${le.join("  ")}</span>`),M.operator&&(W+=`<br/><span class="text-xs text-gray-500">Beheer: ${M.operator}</span>`),W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Tip voor detectie</span></div>',W+='<div class="text-sm text-gray-700">Parken zijn populair bij detectoristen. Mensen verliezen hier munten en sieraden. Vraag eerst toestemming aan de gemeente of beheerder.</div>',M.website){const Ae=M.website.replace(/^https?:\/\//,"").split("/")[0];W+=`<div class="mt-2"><a href="${M.website}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline text-sm">${Ae}</a></div>`}}else M.leisure==="playground"&&(ne=!0,W=`<strong class="text-orange-800">${M.name||"Speeltuin"}</strong>`,W+='<br/><span class="text-sm text-gray-800">Speeltuin</span>',M.description&&(W+=`<div class="mt-2 text-sm text-gray-700">${M.description}</div>`));if(M.tourism==="museum"||M.museum){ne=!0;const q=M.name||"Museum",le=M.museum||M["museum:type"]||"",ze=le&&le!=="yes"?{art:"Kunstmuseum",history:"Geschiedenismuseum",archaeology:"Archeologisch museum",science:"Wetenschapsmuseum",technology:"Techniekmuseum",nature:"Natuurmuseum",open_air:"Openluchtmuseum",local:"Streekmuseum",military:"Militair museum",railway:"Spoorwegmuseum",maritime:"Maritiem museum",children:"Kindermuseum"}[le.toLowerCase()]||le:"Museum";if(W=`<strong class="text-purple-800">${q}</strong>`,W+=`<br/><span class="text-sm text-purple-600">${ze}</span>`,M.description&&(W+=`<div class="mt-2 text-sm text-gray-700">${M.description}</div>`),M.fee){const Me=M.fee==="yes"?"Toegangsprijs":M.fee==="no"?"Gratis toegang":M.fee;W+=`<div class="mt-2"><span class="text-sm text-gray-600">${Me}</span></div>`}if(M.opening_hours){const Me=nD(String(M.opening_hours));W+=`<div class="mt-2"><span class="text-xs text-green-600">Open: ${Me}</span></div>`}if(M.website||M.url){const Me=M.website||M.url;W+=`<div class="mt-1"><a href="${Me}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline text-sm">Bezoek ${q}</a></div>`}if(M.wikipedia){const Me=M.wikipedia.split(":")[0]||"nl",He=M.wikipedia.split(":")[1]||M.wikipedia;W+=`<div class="text-sm"><a href="https://${Me}.wikipedia.org/wiki/${encodeURIComponent(He)}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Meer info op Wikipedia</a></div>`}if(M["addr:street"]||M["addr:housenumber"]||M["addr:city"]){if(W+='<div class="mt-2 text-xs text-gray-400">',M["addr:street"]||M["addr:housenumber"]){const Me=[M["addr:street"],M["addr:housenumber"]].filter(Boolean).join(" ");Me&&(W+=`${Me}<br/>`)}M["addr:city"]&&(W+=`${M["addr:postcode"]||""} ${M["addr:city"]}`),W+="</div>"}}if(M.leisure==="swimming_area"||M.sport==="swimming"||M.natural==="beach"){ne=!0,W=`<strong class="text-cyan-800">${M.name||"Zwemplek"}</strong>`;const le=M.natural==="beach"?"Strand":M.leisure==="swimming_area"?"Zwemplek":"Zwemwater";W+=`<br/><span class="text-sm text-gray-800">${le}</span>`,M.water&&(W+=`<br/><span class="text-sm text-gray-700">${{lake:"Meer",river:"Rivier",pond:"Vijver",reservoir:"Reservoir",canal:"Kanaal"}[M.water]||M.water}</span>`),M.supervised==="yes"&&(W+='<br/><span class="text-sm text-green-700">Met toezicht</span>'),M.changing_rooms==="yes"&&(W+='<br/><span class="text-sm text-gray-600">Kleedruimte aanwezig</span>'),M.description&&(W+=`<div class="mt-2 text-sm text-gray-700">${M.description}</div>`),W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Tip voor detectie</span></div>',W+='<div class="text-sm text-gray-700">Zwemplekken kunnen interessant zijn voor detectie. Mensen verliezen hier sieraden en munten. Let op: niet overal is detecteren toegestaan.</div>'}if(M.osm_id&&M.address!==void 0&&(W+='<br/><span class="text-sm text-lime-700">Kringloopwinkel</span>',M.address&&(W+=`<br/><span class="text-xs text-gray-500">${M.address}</span>`),M.phone&&(W+=`<br/><span class="text-xs text-gray-600">${M.phone}</span>`)),M.site_type==="tumulus"){ne=!0;const q=xe.getGeometry()?.getCoordinates();let le="",Ae="";if(q){const ze=bn(q),Me=ze[0],He=ze[1];Me>5.5&&Me<6.3&&He>52&&He<52.5?(le="Veluwe",Ae="De Veluwe heeft de grootste concentratie grafheuvels van Nederland. Veel heuvels liggen in grafvelden met tientallen heuvels bij elkaar."):Me>6.2&&Me<7.1&&He>52.6&&He<53.3?(le="Drenthe",Ae="Drenthe is beroemd om zijn prehistorische monumenten. Naast hunebedden liggen hier honderden grafheuvels uit de Bronstijd."):Me>4.5&&Me<6&&He>51.3&&He<51.9?(le="Noord-Brabant",Ae="Op de Brabantse zandgronden liggen veel grafheuvels, vaak in kleine groepjes op hogere gronden."):Me>5.5&&Me<6.3&&He>50.7&&He<51.6?(le="Limburg",Ae="De Limburgse heuvels en plateaus herbergen grafheuvels uit verschillende periodes, van Bronstijd tot Romeinse tijd."):Me>5&&Me<5.6&&He>52&&He<52.4&&(le="Utrechtse Heuvelrug",Ae="De stuwwallen van de Utrechtse Heuvelrug en het Gooi waren al in de prehistorie bewoond. Grafheuvels markeren de laatste rustplaats van de vroege bewoners.")}W+='<br/><span class="text-sm text-amber-700">Grafheuvel uit de Bronstijd of IJzertijd</span>',le&&(W+=`<br/><span class="text-sm text-gray-500">${le}</span>`),W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',W+='<div class="text-sm text-gray-700 mt-1">Een grafheuvel is een kunstmatige heuvel over een of meerdere graven. De meeste Nederlandse grafheuvels zijn 3000 tot 4000 jaar oud, uit de Bronstijd (2000-800 v.Chr.) of vroege IJzertijd.</div>',Ae&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Over deze regio</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${Ae}</div>`),W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Hoe herken je een grafheuvel?</span></div>',W+='<div class="text-sm text-gray-700 mt-1">Grafheuvels zijn vaak ronde, lage heuvels van 10-30 meter doorsnee en 1-3 meter hoog. Ze liggen meestal op zandgronden, vaak in groepjes (grafvelden). Let op de kenmerkende ronde vorm in het landschap.</div>',M.wikidata?(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer informatie</span></div>',W+=`<div class="text-sm text-gray-700 mt-1"><a href="https://www.wikidata.org/wiki/${M.wikidata}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Bekijk op Wikidata</a></div>`):(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer informatie</span></div>',W+='<div class="text-sm text-gray-700 mt-1"><a href="https://nl.wikipedia.org/wiki/Grafheuvel" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Lees meer over grafheuvels op Wikipedia</a></div>')}if(M.historic==="castle"||M.castle_type){ne=!0;const q={manor:{label:"Landhuis",uitleg:"Een landhuis of havezate was het woonhuis van een adellijke familie. Vaak met een landgoed eromheen.",vondsten:"Sieraden, gespen, munten, aardewerk van rijke bewoners"},stately:{label:"Statig huis",uitleg:"Een groot en deftig woonhuis, vaak van welgestelde families. Soms met kasteelachtige kenmerken.",vondsten:"Huishoudelijke voorwerpen, munten, knopen, aardewerk"},fortress:{label:"Fort/Vesting",uitleg:"Een versterkte militaire bouwwerk, gebouwd om een gebied te verdedigen.",vondsten:"Militaire voorwerpen, kogels, gespen, uniformonderdelen"},defensive:{label:"Verdedigingskasteel",uitleg:"Een kasteel gebouwd voor verdediging, met dikke muren, een gracht en torens.",vondsten:"Wapens, harnasonderdelen, pijlpunten, middeleeuwse munten"},palace:{label:"Paleis",uitleg:"Een groot en luxueus gebouw voor koningen, prinsen of zeer rijke families.",vondsten:"Luxe voorwerpen, sieraden, zegels, zeldzame munten"},castrum:{label:"Romeins fort",uitleg:"Een Romeins legerkamp of fort. Deze zijn bijna 2000 jaar oud!",vondsten:"Romeinse munten, fibulae, militaria, aardewerk"},citadel:{label:"Citadel",uitleg:"Een sterk versterkte kern binnen een stad, als laatste verdedigingslinie.",vondsten:"Militaire voorwerpen uit verschillende periodes"}},le=M.castle_type?q[M.castle_type]:null,Ae=le?.label||"Kasteel";if(W+=`<br/><span class="text-sm text-purple-700">${Ae}</span>`,M.start_date&&(W+=`<br/><span class="text-xs text-gray-500">Bouwjaar: ${M.start_date}</span>`),M.heritage&&(W+='<br/><span class="text-sm text-amber-700">Rijksmonument</span>'),W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',le?W+=`<div class="text-sm text-gray-700 mt-1">${le.uitleg}</div>`:W+='<div class="text-sm text-gray-700 mt-1">Een historisch kasteel of adellijk huis. Kastelen waren vaak het middelpunt van macht en rijkdom in een gebied.</div>',W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',le?W+=`<div class="text-sm text-gray-700 mt-1">${le.vondsten}</div>`:W+='<div class="text-sm text-gray-700 mt-1">Munten, sieraden, gespen, aardewerk en andere voorwerpen van de vroegere bewoners.</div>',M.wikipedia||M.website){if(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',M.wikipedia){const ze=M.wikipedia.startsWith("http")?M.wikipedia:`https://nl.wikipedia.org/wiki/${M.wikipedia.replace(/^nl:/,"")}`;W+=`<div class="text-sm text-gray-700 mt-1"><a href="${ze}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a></div>`}M.website&&(W+=`<div class="text-sm text-gray-700 mt-1"><a href="${M.website}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Website bezoeken</a></div>`)}}if(M.historic==="ruins"){const q=M.ruins_type||"";let le="Rune",Ae="Een rune is wat overblijft van een oud gebouw. Het kan een kerk, kasteel, molen of ander bouwwerk zijn geweest.",ze="Baksteenfragmenten, aardewerk, metalen voorwerpen van vroegere bewoners of gebruikers";if(q.toLowerCase().includes("church")||q.toLowerCase().includes("kerk")?(le="Kerkrune",Ae="De overblijfselen van een oude kerk. Vaak nog te herkennen aan de fundering of een paar muren.",ze="Religieuze voorwerpen, munten van kerkgangers, knopen, gespen"):q.toLowerCase().includes("castle")||q.toLowerCase().includes("kasteel")?(le="Kasteelrune",Ae="De resten van een middeleeuws kasteel. Soms is alleen de gracht of fundering nog zichtbaar.",ze="Middeleeuwse munten, sieraden, harnasonderdelen, pijlpunten"):q.toLowerCase().includes("mill")||q.toLowerCase().includes("molen")?(le="Molenrune",Ae="Wat rest van een oude molen. Vaak nog te zien aan de stenen fundering of de molenberg.",ze="Gereedschap, munten, huishoudelijke voorwerpen"):q.toLowerCase().includes("fort")&&(le="Fortrune",Ae="De overblijfselen van een militair fort of verdedigingswerk.",ze="Militaire voorwerpen, kogels, gespen, uniformonderdelen"),W+=`<br/><span class="text-sm text-amber-700">${le}</span>`,W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${Ae}</div>`,W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${ze}</div>`,M.description&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Beschrijving</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${M.description}</div>`),M.wikipedia){const Me=M.wikipedia.startsWith("http")?M.wikipedia:`https://${M.wikipedia.split(":")[0]||"nl"}.wikipedia.org/wiki/${M.wikipedia.replace(/^[a-z]{2}:/,"")}`;W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">Lees meer op <a href="${Me}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a></div>`}}if(M.bunker_type||M.name&&(M.name.toLowerCase().includes("bunker")||M.name.toLowerCase().includes("kazemat")||M.name.toLowerCase().includes("schuilplaats"))){ne=!0;const q={munitions:"Munitiebunker",personnel_shelter:"Personeelsschuilplaats",personell_shelter:"Personeelsschuilplaats",command:"Commandobunker",gun_emplacement:"Geschutsbunker",mg_nest:"Mitrailleursnest",technical:"Technische bunker",storage:"Opslagbunker",tobruk:"Tobruk",kazemat:"Kazemat",Flak:"Luchtafweerstelling",hardened_aircraft_shelter:"Vliegtuigshelter",shelter:"Schuilkelder",observation:"Observatiebunker",anti_aircraft:"Luchtafweerstelling"},le=M.name||"",Ae=M.bunker_type?q[M.bunker_type]||M.bunker_type:"";le&&le!=="Bunker"&&(W+=`<br/><span class="text-sm font-semibold text-gray-700">${le}</span>`),Ae&&Ae!==le&&(W+=`<br/><span class="text-xs text-gray-500">${Ae}</span>`);const ze=xe.getGeometry()?.getCoordinates();let Me="",He="",$e="";if(ze){const yt=bn(ze),At=yt[0],Wt=yt[1],z=At<4.8||At<5.2&&Wt>51.8&&Wt<53.5,Z=At>4.2&&At<4.4&&Wt>52&&Wt<52.15,X=At>4.5&&At<4.7&&Wt>52.4&&Wt<52.5,Y=At>4&&At<4.2&&Wt>51.95&&Wt<52.05,Q=At<4.2&&Wt<51.6,ee=At>5.2&&At<5.8&&Wt>51.9&&Wt<52.3;Z?(Me="Deze bunker maakt deel uit van de Atlantikwall bij Scheveningen. De Duitsers bouwden hier tijdens WOII zo'n 80 bunkers in de duinen. De muren zijn soms 3 meter dik beton. Voor deze bunkers moesten 138.000 mensen uit Den Haag en Scheveningen hun huis verlaten.",He="https://nl.wikipedia.org/wiki/Atlantikwall_Museum_Scheveningen",$e="Atlantikwall Museum Scheveningen"):X?(Me="Deze bunker hoort bij Festung IJmuiden, een van de zwaarst verdedigde punten van de Atlantikwall. De Duitsers bouwden hier bunkers om de haventoegang te beschermen. Er zijn nu rondleidingen door het Bunkermuseum.",He="https://www.bunkermuseum.nl/",$e="Bunkermuseum IJmuiden"):Y?(Me="Deze bunker maakt deel uit van de Atlantikwall bij Hoek van Holland. Dit was een strategisch punt voor de Duitsers vanwege de Nieuwe Waterweg. Veel bunkers zijn nog te bezoeken.",He="https://www.atlantikwallhoekvanholland.nl/",$e="Atlantikwall Hoek van Holland"):Q?(Me="Deze bunker hoort bij de Atlantikwall in Zeeland. De Duitsers verdedigden hier de Westerschelde en de kust. Bij Zoutelande en Westkapelle zijn veel bunkers bewaard gebleven.",He="https://www.bunkermuseumzoutelande.nl/",$e="Bunkermuseum Zoutelande"):z?(Me="Deze bunker maakt deel uit van de Atlantikwall: de Duitse verdedigingslinie langs de hele kust van Europa. In Nederland bouwden de Duitsers duizenden bunkers tussen 1942 en 1944.",He="https://nl.wikipedia.org/wiki/Atlantikwall",$e="Atlantikwall (Wikipedia)"):ee?(Me="Deze bunker hoort mogelijk bij de Grebbelinie of de Nieuwe Hollandse Waterlinie. Dit waren Nederlandse verdedigingslinies die de Duitsers na 1940 versterkten met bunkers.",He="https://nl.wikipedia.org/wiki/Grebbelinie",$e="Grebbelinie (Wikipedia)"):(Me="Een bunker uit de Tweede Wereldoorlog. De meeste bunkers in Nederland zijn gebouwd tussen 1940 en 1944, als onderdeel van de Duitse verdediging of langs bestaande Nederlandse linies.",He="https://nl.wikipedia.org/wiki/Atlantikwall",$e="WOII bunkers (Wikipedia)")}else Me="Een bunker uit de Tweede Wereldoorlog.",He="https://nl.wikipedia.org/wiki/Atlantikwall",$e="WOII bunkers (Wikipedia)";W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${Me}</div>`,W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je vinden?</span></div>',W+='<div class="text-sm text-gray-700 mt-1">Bij bunkers worden soms voorwerpen gevonden zoals patronen, uniformknopen, gespen en persoonlijke spullen van soldaten.</div>',W+='<div class="mt-2 text-xs text-gray-500 italic">Let op: betreed nooit een bunker zonder toestemming. Raak munitieresten niet aan.</div>',W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bronnen</span></div>',W+='<div class="text-sm text-gray-700 mt-1">',W+=`<a href="${He}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">${$e}</a>`,M.website?W+=`<br/><a href="${M.website}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">TracesOfWar</a>`:W+='<br/><a href="https://www.tracesofwar.nl/" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">TracesOfWar</a>',W+="</div>"}if(M.historic==="battlefield"){ne=!0;const q=M.name||"Onbekend slagveld",Ae={"Slag om Arnhem":{periode:"September 1944",samenvatting:"De Slag om Arnhem was onderdeel van Operatie Market Garden. Geallieerde parachutisten probeerden de brug over de Rijn te veroveren. Na negen dagen hevige gevechten moesten ze zich terugtrekken. Van de 10.000 Britse soldaten werden er 1.500 gedood en 6.500 krijgsgevangen gemaakt.",watZieJe:"Er zijn veel monumenten en infoborden. Het Airborne Museum in Oosterbeek vertelt het hele verhaal. Elk jaar in september is er een herdenking.",uitkomst:"De geallieerden verloren de slag. Nederland bleef nog tot mei 1945 bezet.",wikiUrl:"https://nl.wikipedia.org/wiki/Slag_om_Arnhem"},"Slag om de Sloedam":{periode:"1-2 november 1944",samenvatting:"Canadese soldaten vielen de Sloedam aan om Walcheren te bevrijden. De dam was smal en de Duitsers verdedigden fel. Veel soldaten sneuvelden bij deze bloedige aanval.",watZieJe:"Bij de dam staat een monument voor de gevallen Canadezen. Er zijn infoborden die de slag uitleggen.",uitkomst:"De Canadezen wonnen na zware verliezen. Dit opende de weg naar de bevrijding van Walcheren.",wikiUrl:"https://nl.wikipedia.org/wiki/Slag_om_de_Sloedam"},"Slag bij Heiligerlee (1568)":{periode:"23 mei 1568",samenvatting:"De eerste veldslag van de Tachtigjarige Oorlog. Lodewijk van Nassau versloeg het Spaanse leger. Zijn broer Adolf sneuvelde tijdens de strijd.",watZieJe:"In Heiligerlee staat het Slag bij Heiligerlee monument. Het klooster waar Adolf van Nassau begraven ligt is nog te bezoeken.",uitkomst:"De opstandelingen wonnen, maar dit was pas het begin van 80 jaar oorlog.",wikiUrl:"https://nl.wikipedia.org/wiki/Slag_bij_Heiligerlee_(1568)"},Overloon:{periode:"Oktober 1944",samenvatting:"Bij Overloon vochten Britten en Amerikanen tegen de Duitsers. Het was een van de zwaarste tankgevechten op Nederlandse bodem. Het dorp werd volledig verwoest.",watZieJe:"Het Oorlogsmuseum Overloon staat op het voormalige slagveld. Je kunt tanks, vliegtuigen en andere voertuigen zien.",uitkomst:"De geallieerden wonnen na wekenlange gevechten.",wikiUrl:"https://nl.wikipedia.org/wiki/Slag_om_Overloon"},"Slagveld Lanakerveld":{periode:"1568",samenvatting:"Onderdeel van de Nederlandse opstand tegen Spanje. Hier vonden gevechten plaats tijdens de beginjaren van de Tachtigjarige Oorlog.",watZieJe:"Het gebied is nu grotendeels landbouwgrond. Lokaal zijn er soms infoborden.",uitkomst:"Onderdeel van de lange strijd tegen de Spaanse overheersing.",wikiUrl:"https://nl.wikipedia.org/wiki/Tachtigjarige_Oorlog"},Blessebrugschans:{periode:"Diverse periodes",samenvatting:"Een historische schans die meerdere keren werd gebruikt in militaire conflicten.",watZieJe:"De resten van de schans zijn nog zichtbaar in het landschap.",uitkomst:"De schans speelde een rol in verschillende conflicten.",wikiUrl:"https://nl.wikipedia.org/wiki/Schans_(vestingwerk)"}}[q];if(q!=="Onbekend slagveld"&&q!=="Historisch slagveld"&&(W+=`<br/><span class="text-sm font-semibold text-red-700">${q}</span>`),Ae)W+=`<br/><span class="text-xs text-gray-500">${Ae.periode}</span>`,W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat gebeurde hier?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${Ae.samenvatting}</div>`,W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Hoe liep het af?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${Ae.uitkomst}</div>`,W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je zien?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${Ae.watZieJe}</div>`,W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bronnen</span></div>',W+='<div class="text-sm text-gray-700 mt-1">',W+=`<a href="${Ae.wikiUrl}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a>`,q.includes("Arnhem")&&(W+='<br/><a href="https://www.airbornemuseum.nl/" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Airborne Museum Oosterbeek</a>'),q.includes("Overloon")&&(W+='<br/><a href="https://www.oorlogsmuseum.nl/" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Oorlogsmuseum Overloon</a>'),W+="</div>";else if(M.date&&(W+=`<br/><span class="text-xs text-gray-500">${M.date}</span>`),M.description?(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat gebeurde hier?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${M.description}</div>`):(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat gebeurde hier?</span></div>',W+='<div class="text-sm text-gray-700 mt-1">Op deze plek vonden historische gevechten plaats. Zoek lokaal naar infoborden of monumenten.</div>'),M.wikipedia){const ze=M.wikipedia.startsWith("http")?M.wikipedia:`https://nl.wikipedia.org/wiki/${M.wikipedia.replace("nl:","")}`;W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bronnen</span></div>',W+=`<div class="text-sm text-gray-700 mt-1"><a href="${ze}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a></div>`}}if(M.bron==="Paleobiology Database"){const q=Me=>{const He={Mollusca:"weekdieren zoals schelpen en slakken",Brachiopoda:"armpotigen, schelp-achtige dieren",Echinodermata:"stekelhuidigen zoals zee-egels en zeesterren",Chordata:"gewervelde dieren",Arthropoda:"geleedpotigen zoals kreeften en trilobieten",Cnidaria:"neteldieren zoals koralen en kwallen",Bryozoa:"mosdiertjes",Foraminifera:"eencellige schelpdieren",Plantae:"planten",Crinoidea:"zeelelies",Gastropoda:"slakken",Bivalvia:"tweekleppigen zoals mossels en oesters",Cephalopoda:"koppotigen zoals inktvissen en ammonieten",Trilobita:"trilobieten, uitgestorven kreeftachtigen",Mammalia:"zoogdieren",Reptilia:"reptielen",Pisces:"vissen",Amphibia:"amfibien"};for(const[$e,yt]of Object.entries(He))if(Me.toLowerCase().includes($e.toLowerCase()))return yt;return""},le=Me=>{const He={Cambrium:"541-485 miljoen jaar geleden",Ordovicium:"485-444 miljoen jaar geleden",Siluur:"444-419 miljoen jaar geleden",Devoon:"419-359 miljoen jaar geleden",Carboon:"359-299 miljoen jaar geleden",Perm:"299-252 miljoen jaar geleden",Trias:"252-201 miljoen jaar geleden",Jura:"201-145 miljoen jaar geleden",Krijt:"145-66 miljoen jaar geleden",Paleogeen:"66-23 miljoen jaar geleden",Neogeen:"23-2,6 miljoen jaar geleden",Kwartair:"2,6 miljoen jaar - nu",Pleistoceen:"2,6 miljoen - 11.700 jaar geleden",Holoceen:"11.700 jaar geleden - nu"};for(const[$e,yt]of Object.entries(He))if(Me.toLowerCase().includes($e.toLowerCase()))return yt;return""},Ae=Me=>{const He={limestone:"kalksteen",sandstone:"zandsteen",shale:"schalie",clay:"klei",sand:"zand",gravel:"grind",marl:"mergel",chalk:"krijt",mudstone:"moddersteen",siltstone:"siltsteen"};let $e=Me;for(const[yt,At]of Object.entries(He))$e=$e.replace(new RegExp(yt,"gi"),At);return $e},ze=Me=>{const He={marine:"zee",coastal:"kust",terrestrial:"land",fluvial:"rivier",lacustrine:"meer",reef:"rif",deltaic:"delta",shallow:"ondiep water",deep:"diep water"};let $e=Me;for(const[yt,At]of Object.entries(He))$e=$e.replace(new RegExp(yt,"gi"),At);return $e};if(M.vindplaats&&(W+=`<br/><span class="text-xs text-gray-600">${M.vindplaats}</span>`),W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is hier gevonden?</span></div>',M.taxonomie&&M.taxonomie!=="Onbekend"){const Me=q(M.taxonomie);Me?(W+=`<div class="text-sm text-gray-700 mt-1">${Me}</div>`,W+=`<div class="text-xs text-gray-500 italic">(${M.taxonomie})</div>`):W+=`<div class="text-sm text-gray-700 mt-1">${M.taxonomie}</div>`}if(M.aantal_fossielen){const Me=parseInt(M.aantal_fossielen),He=Me>100?"Veel fossielen gevonden op deze locatie.":Me>10?"Meerdere fossielen gevonden op deze locatie.":`${M.aantal_fossielen} fossiel${Me>1?"en":""} gevonden op deze locatie.`;W+=`<div class="text-sm text-gray-600 mt-1">${He}</div>`}if(M.periode&&M.periode!=="Onbekend"){W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wanneer leefden deze dieren?</span></div>';const Me=le(M.periode);W+=`<div class="text-sm text-gray-700 mt-1">${M.periode}</div>`,Me&&(W+=`<div class="text-sm text-gray-600">${Me}</div>`),M.ouderdom&&M.ouderdom!=="Onbekend"&&(W+=`<div class="text-sm text-gray-600">Ouderdom: ${M.ouderdom}</div>`)}(M.gesteente||M.formatie||M.milieu)&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">In wat voor gesteente?</span></div>',M.gesteente&&(W+=`<div class="text-sm text-gray-700 mt-1">${Ae(M.gesteente)}</div>`),M.formatie&&(W+=`<div class="text-sm text-gray-600">Formatie: ${M.formatie}</div>`,M.lid&&(W+=`<div class="text-sm text-gray-600 ml-3">Lid: ${M.lid}</div>`)),M.milieu&&(W+=`<div class="text-sm text-gray-600">Leefomgeving: ${ze(M.milieu)}</div>`))}if(M.layerType==="fossielHotspot"){const q=[];if(M.type&&q.push(M.type),M.region&&q.push(M.region),M.country){const le={NL:"Nederland",BE:"Belgi",DE:"Duitsland",FR:"Frankrijk"};q.push(le[M.country]||M.country)}if(q.length>0&&(W+=`<br/><span class="text-xs text-gray-600">${q.join("  ")}</span>`),(M.finds||M.period)&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kan ik er vinden?</span></div>',M.finds&&(W+=`<div class="text-sm text-gray-700 mt-1">${M.finds}</div>`),M.period&&(W+=`<div class="text-sm text-gray-600 mt-1">Periode: ${M.period}</div>`),M.geology&&(W+=`<div class="text-sm text-gray-600 mt-1">Geologie: ${M.geology}</div>`)),M.access||M.tips){if(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Hoe kom ik er?</span></div>',M.access){const Ae=M.access.toLowerCase().includes("verboden")||M.access.toLowerCase().includes("niet toegankelijk")?"text-red-600":"text-gray-700";W+=`<div class="text-sm ${Ae} mt-1">${M.access}</div>`}M.tips&&(W+=`<div class="text-sm text-gray-600 mt-1 italic">Tip: ${M.tips}</div>`)}}if(M.layerType==="mineralenHotspot"){const q=[];if(M.region&&q.push(M.region),M.country){const le={NL:"Nederland",BE:"Belgi",DE:"Duitsland",FR:"Frankrijk"};q.push(le[M.country]||M.country)}if(q.length>0&&(W+=`<br/><span class="text-xs text-gray-600">${q.join("  ")}</span>`),M.minerals&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kan ik er vinden?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${M.minerals}</div>`,M.geology&&(W+=`<div class="text-sm text-gray-600 mt-1">Geologie: ${M.geology}</div>`)),M.access||M.tips){if(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Hoe kom ik er?</span></div>',M.access){const Ae=M.access.toLowerCase().includes("verboden")||M.access.toLowerCase().includes("niet toegankelijk")||M.access.toLowerCase().includes("gesloten")?"text-red-600":"text-gray-700";W+=`<div class="text-sm ${Ae} mt-1">${M.access}</div>`}M.tips&&(W+=`<div class="text-sm text-gray-600 mt-1 italic">Tip: ${M.tips}</div>`)}}if(M.layerType==="goudrivier"){const q=[];if(M.river&&q.push(M.river),M.region&&q.push(M.region),M.country){const le={NL:"Nederland",BE:"Belgi",DE:"Duitsland",FR:"Frankrijk"};q.push(le[M.country]||M.country)}if(q.length>0&&(W+=`<br/><span class="text-xs text-gray-600">${q.join("  ")}</span>`),(M.goldType||M.origin)&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kan ik er vinden?</span></div>',M.goldType&&(W+=`<div class="text-sm text-gray-700 mt-1">${M.goldType}</div>`),M.origin&&(W+=`<div class="text-sm text-gray-600 mt-1">Herkomst: ${M.origin}</div>`)),M.legal||M.tips){if(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Mag ik hier zoeken?</span></div>',M.legal){const Ae=M.legal.includes("VERBODEN")?"text-red-600 font-semibold":"text-gray-700";W+=`<div class="text-sm ${Ae} mt-1">${M.legal}</div>`}M.tips&&(W+=`<div class="text-sm text-gray-600 mt-1 italic">Tip: ${M.tips}</div>`)}}if(M.layerType==="wandelroute"){const q=[];if(M.region&&q.push(M.region),M.country){const le={NL:"Nederland",BE:"Belgi"};q.push(le[M.country]||M.country)}if(q.length>0&&(W+=`<br/><span class="text-xs text-gray-600">${q.join("  ")}</span>`),M.distance||M.duration){const le=M.distance?`${M.distance} km`:"",Ae=M.duration?`${M.duration}`:"",ze=[le,Ae].filter(Boolean).join("  ");ze&&(W+=`<br/><span class="text-sm text-green-700 font-medium">${ze}</span>`)}(M.description||M.highlights)&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat ga je zien?</span></div>',M.description&&(W+=`<div class="text-sm text-gray-700 mt-1">${M.description}</div>`),M.highlights&&(W+=`<div class="text-sm text-gray-600 mt-1">Hoogtepunten: ${M.highlights}</div>`)),M.startAddress&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Waar begin ik?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${M.startAddress}</div>`),M.url&&(W+=`<div class="mt-3"><a href="${M.url}" target="_blank" class="text-sm text-blue-600 hover:underline">Bekijk route en download GPX</a></div>`)}if(M.layerType==="hunebed"){M.period&&(W+=`<br/><span class="text-sm text-purple-700">Periode: ${M.period}</span>`),W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',M.description&&(W+=`<div class="text-sm text-gray-700 mt-1">${M.description}</div>`);const q=[];if(M.stones){const le=M.stones.toLowerCase(),Ae=le.match(/(\d+)\s*dekst[^\s,]*/i),ze=le.match(/(\d+)\s*draagst[^\s,]*/i),Me=le.match(/(\d+)\s*sluitst[^\s,]*/i),He=le.match(/(\d+)\s*poortst[^\s,]*/i),$e=le.match(/(\d+)\s*gangdekst[^\s,]*/i),yt=le.match(/(\d+)\s*gangzijst[^\s,]*/i);Ae&&q.push(`${Ae[1]} deksteen${parseInt(Ae[1])>1?"en":""} (de grote steen${parseInt(Ae[1])>1?"en":""} bovenop)`),ze&&q.push(`${ze[1]} draagstenen (de stenen die de dekstenen dragen)`),Me&&q.push(`${Me[1]} sluitsteen${parseInt(Me[1])>1?"en":""} (afsluiting aan de korte zijden)`),He&&q.push(`${He[1]} poortsteen${parseInt(He[1])>1?"en":""} (bij de ingang)`),$e&&q.push(`${$e[1]} gangdeksteen${parseInt($e[1])>1?"en":""} (boven de toegangsgang)`),yt&&q.push(`${yt[1]} gangzijstenen (langs de toegangsgang)`)}if(M.length&&q.push(`Een grafkamer van ${M.length} lang`),M.width&&q.push(`${M.width}`),q.length>0&&(W+='<div class="text-sm text-gray-700 mt-1">Het hunebed heeft:</div>',W+='<ul class="list-disc list-inside text-sm text-gray-700 mt-1 space-y-0.5">',q.forEach(le=>{W+=`<li>${le}</li>`}),W+="</ul>"),M.notable){const le=M.notable.toLowerCase();let Ae="Wat is hier bijzonder?";le.includes("grootste")?Ae="Waarom is dit het grootste hunebed?":le.includes("klein")||le.includes("kindhunebed")?Ae="Waarom is dit hunebed zo klein?":le.includes("cluster")||le.includes("naast elkaar")?Ae="Waarom liggen hier meerdere hunebedden?":(le.includes("enige")||le.includes("westelijk")||le.includes("noordelijk"))&&(Ae="Wat maakt deze locatie bijzonder?"),W+=`<div class="mt-3"><span class="text-sm font-semibold text-gray-800">${Ae}</span></div>`,W+=`<div class="text-sm text-gray-700 mt-1">${M.notable}</div>`}W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is de Trechterbeker cultuur?</span></div>',W+='<div class="text-sm text-gray-700 mt-1">De Trechterbeker cultuur is de naam voor de mensen die 5.000 jaar geleden in Nederland woonden. Ze maakten potten met een trechter-vorm. Daarom heten ze zo. Deze mensen bouwden de hunebedden als graven voor hun doden.</div>',M.finds&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is hier gevonden?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${M.finds}</div>`),M.museum&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Museum in de buurt</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${M.museum}</div>`),W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bezoeken</span></div>',M.access?W+=`<div class="text-sm text-gray-700 mt-1">${M.access}</div>`:W+='<div class="text-sm text-gray-700 mt-1">Je kunt dit hunebed gratis bezoeken.</div>',M.wikipedia&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">Lees meer op <a href="${M.wikipedia}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a></div>`)}if((M.inventarisnummer||M.locatie_naam)&&(M.locatie_naam&&(W+=`<br/><span class="text-sm font-semibold">${M.locatie_naam}</span>`),M.inventarisnummer&&(W+=`<br/><span class="text-xs text-gray-500">CAI: ${M.inventarisnummer}</span>`),M.datering_tekst&&(W+=`<br/><span class="text-sm text-purple-700">${M.datering_tekst}</span>`)),(M.veensoort||M.dikte)&&(M.veensoort&&(W+=`<br/><span class="text-sm text-amber-700">${M.veensoort}</span>`),M.dikte&&(W+=`<br/><span class="text-xs text-gray-600">Dikte: ${M.dikte}</span>`)),M.nature&&M.debut){W+=`<br/><span class="text-sm text-purple-700">${M.nature}</span>`;const q=M.debut===M.fin?M.debut:`${M.debut} - ${M.fin}`;q&&(W+=`<br/><span class="text-sm text-gray-700">Periode: ${q}</span>`),M.structure&&(W+=`<br/><span class="text-xs text-gray-600">${M.structure}</span>`),M.commune&&(W+=`<br/><span class="text-xs text-gray-500">${M.commune}</span>`),M.decouvert&&(W+=`<br/><span class="text-xs text-gray-400">Ontdekt: ${M.decouvert}</span>`),M.numero&&(W+=`<br/><span class="text-xs text-gray-400">${M.numero}</span>`)}if((M.NATURE_OPE||M.CODE_OPERA)&&(M.TITRE&&(W+=`<br/><span class="text-sm font-semibold">${M.TITRE}</span>`),M.NATURE_OPE&&(W+=`<br/><span class="text-sm text-amber-700">${M.NATURE_OPE}</span>`),M.AUTEUR&&(W+=`<br/><span class="text-xs text-gray-600">Auteur: ${M.AUTEUR}</span>`),M.DATE&&(W+=`<br/><span class="text-xs text-gray-500">Datum: ${M.DATE}</span>`),M.COMMUNE&&(W+=`<br/><span class="text-xs text-gray-500">${M.COMMUNE}</span>`)),M.type_protection&&(M.n_site||M.t_site)){const q=M.type_protection==="Classe"?"text-red-700":"text-amber-700";W+=`<br/><span class="text-sm ${q}">${M.type_protection}</span>`,M.n_site&&(W+=`<br/><span class="text-sm font-semibold">${M.n_site}</span>`),M.t_site&&(W+=`<br/><span class="text-xs text-gray-600">${M.t_site}</span>`),M.c_site&&(W+=`<br/><span class="text-xs text-gray-500">Code: ${M.c_site}</span>`),M.d_creation&&(W+=`<br/><span class="text-xs text-gray-400">Beschermd sinds: ${M.d_creation}</span>`)}if(M.type_protection&&M.cod_diren){const q=M.type_protection==="Classe"?"text-red-700":"text-amber-700";if(W+=`<br/><span class="text-sm ${q}">${M.type_protection}</span>`,M.proced&&(W+=`<br/><span class="text-xs text-gray-600">${M.proced}</span>`),M.d_proced&&(W+=`<br/><span class="text-xs text-gray-500">Date: ${M.d_proced}</span>`),M.comment){const le=String(M.comment).slice(0,150);W+=`<br/><span class="text-xs text-gray-600 italic">${le}${String(M.comment).length>150?"...":""}</span>`}}if(M.type_protection&&M.nomsite){const q=M.type_protection==="Classe"?"text-red-700":"text-amber-700";if(W+=`<br/><span class="text-sm ${q}">${M.type_protection}</span>`,M.caractere&&(W+=`<br/><span class="text-xs text-gray-600">${M.caractere}</span>`),M.datedecis&&(W+=`<br/><span class="text-xs text-gray-500">Date: ${M.datedecis}</span>`),M.descriptio){const le=String(M.descriptio).slice(0,150);W+=`<br/><span class="text-xs text-gray-600 italic">${le}${String(M.descriptio).length>150?"...":""}</span>`}}if(M.secteur&&M.style){if(W+=`<br/><span class="text-sm text-gray-700">${M.secteur}</span>`,M["sous-secteur"]&&(W+=`<br/><span class="text-xs text-gray-600">${M["sous-secteur"]}</span>`),M.description){const q=String(M.description).slice(0,150);W+=`<br/><span class="text-xs text-gray-600 italic">${q}${String(M.description).length>150?"...":""}</span>`}M.url&&(W+=`<br/><a href="${M.url}" target="_blank" class="text-xs text-blue-600 hover:underline">Meer info</a>`)}if(M.nature_operation||M.synthese){M.nature_operation&&(W+=`<br/><span class="text-sm text-red-700">${M.nature_operation}</span>`),M.responsable_operation&&(W+=`<br/><span class="text-xs text-gray-600">Responsable: ${M.responsable_operation}</span>`),M.date_operation&&(W+=`<br/><span class="text-xs text-gray-500">Datum: ${M.date_operation}</span>`);const q=[];if(M.prehistoire==="Oui"&&q.push("Prehistorie"),M.protohistoire==="Oui"&&q.push("Protohistorie"),M.antiquite==="Oui"&&q.push("Romeins"),M.moyen_age==="Oui"&&q.push("Middeleeuwen"),M.temps_modernes==="Oui"&&q.push("Moderne tijd"),q.length>0&&(W+=`<br/><span class="text-sm text-purple-700">${q.join(", ")}</span>`),M.adresse&&(W+=`<br/><span class="text-xs text-gray-500">${M.adresse}</span>`),M.synthese){const le=String(M.synthese).slice(0,200);W+=`<br/><span class="text-xs text-gray-600 italic">${le}${String(M.synthese).length>200?"...":""}</span>`}}if(M.operator&&(W+=`<br/><span class="text-sm text-gray-600">${M.operator}</span>`),!ne){if(M.opening_hours){const q=nD(String(M.opening_hours));W+=`<br/><span class="text-xs text-green-600">Open: ${q}</span>`}M.website&&(W+=`<br/><a href="${M.website}" target="_blank" class="text-xs text-blue-600 underline">Website</a>`)}if(M.addr_street){const q=[M.addr_street,M.addr_housenumber,M.addr_postcode].filter(Boolean).join(" ");W+=`<br/><span class="text-xs text-gray-500">${q}</span>`}const Ce=M.description||M.omschrijving||M.descr||M.info;Ce&&Ce!==ut&&(W+=`<br/><span class="text-sm text-gray-600">${Ce}</span>`),an.push(W),Lt.push({geometry:Yi(Dt),properties:M,popupHtml:W})}const rn=n.getView().getResolution()||1,Tr=await xn(Tt.coordinate,rn);an.push(...Tr);for(const xe of Tr)Lt.push(null);const Fe=await Mr;if(an.length===0&&Fe!==null){const xe=`<strong class="text-blue-800">Terrein</strong>
          <br/><div class="mt-2 pt-2 border-t border-gray-100 flex items-center gap-1">
            <span class="text-xs text-gray-400">Hoogte:</span>
            <span class="text-sm font-medium text-blue-600">${Fe.toFixed(2)} m NAP</span>
          </div>`;an.push(xe),Lt.push(null)}if(an.length>0&&Fe!==null&&(an[0]+=`<br/><div class="mt-2 pt-2 border-t border-gray-100 flex items-center gap-1">
          <span class="text-xs text-gray-400">Hoogte:</span>
          <span class="text-sm font-medium text-blue-600">${Fe.toFixed(2)} m NAP</span>
        </div>`),an.length>0){l(an),te(Lt),h(0),console.log(` KLIK OPGESLAGEN: [${Tt.coordinate[0].toFixed(0)}, ${Tt.coordinate[1].toFixed(0)}]`),_(Tt.coordinate),w(!1),G(!1),be(!1),V(""),ve(null);const xe=bn(Tt.coordinate);je(xe),A(`https://www.google.com/maps/dir/?api=1&destination=${xe[1]},${xe[0]}`),D(`https://www.google.com/maps/@?api=1&map_action=pano&viewpoint=${xe[1]},${xe[0]}`),m(!0)}};return n.on("click",In),()=>{n.un("click",In)}},[n]);const br=()=>{m(!1),ye("half"),n&&x&&(zR(n),w(!1))},oi=(_t,xn)=>{const In=xn.velocity.y,Tt=xn.offset.y;Ge==="half"?Tt<-50||In<-500?ye("full"):(Tt>100||In>500)&&br():(Tt>50||In>300)&&ye("half")};return f.jsx(An,{children:g&&f.jsxs(f.Fragment,{children:[f.jsx(wt.div,{className:"fixed inset-0 z-[1500]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:br}),f.jsxs(wt.div,{className:"fixed bottom-0 left-0 right-0 z-[1501] bg-white rounded-t-2xl shadow-2xl overflow-hidden flex flex-col",style:{fontSize:`${14*he/100}px`,height:Ge==="full"?"90vh":"auto",maxHeight:Ge==="full"?"90vh":"35vh"},initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{type:"spring",damping:25,stiffness:300},drag:"y",dragConstraints:{top:0,bottom:0},dragElastic:.3,onDragEnd:oi,children:[f.jsx("div",{className:"flex justify-center pt-2 pb-1 cursor-grab active:cursor-grabbing",onClick:()=>ye(Ge==="half"?"full":"half"),children:f.jsx("div",{className:"w-10 h-1 bg-gray-300 rounded-full"})}),f.jsxs("div",{className:"flex items-center gap-2 px-3 pb-2 border-b border-gray-100",children:[Ve&&f.jsxs("div",{className:"flex items-center gap-0.5 flex-shrink-0",children:[f.jsx("button",{onClick:hn,className:"p-1 text-blue-500 hover:text-blue-600 transition-colors border-0 outline-none bg-transparent","aria-label":"Vorige laag",children:f.jsx(uV,{size:18})}),f.jsxs("span",{className:"text-gray-500 font-medium min-w-[32px] text-center",style:{fontSize:"0.857em"},children:[c+1,"/",o.length]}),f.jsx("button",{onClick:sr,className:"p-1 text-blue-500 hover:text-blue-600 transition-colors border-0 outline-none bg-transparent","aria-label":"Volgende laag",children:f.jsx(yg,{size:18})})]}),f.jsx("span",{className:"flex-1 font-semibold text-gray-800 truncate",style:{fontSize:"1em"},children:Ut||"Info"}),ce&&f.jsxs("div",{className:"relative",children:[f.jsx("button",{onClick:()=>G(!N),className:`p-1.5 transition-colors flex-shrink-0 border-0 outline-none bg-transparent ${j?"text-green-500":"text-orange-500 hover:text-orange-600"}`,title:"Toevoegen aan mijn laag","aria-label":"Toevoegen aan mijn laag",children:j?f.jsx(uc,{size:18}):f.jsx(Wa,{size:18})}),N&&f.jsxs("div",{className:"absolute right-0 top-full mt-1 z-50 bg-white rounded-lg shadow-lg border border-gray-200 py-1 min-w-[180px] max-w-[220px]",children:[f.jsx("div",{className:"px-3 py-1 text-xs text-gray-400 font-medium",children:"Toevoegen aan:"}),f.jsx("div",{className:"max-h-[200px] overflow-y-auto",children:i.filter(_t=>!_t.archived).map(_t=>f.jsxs("button",{onClick:()=>{const xn=re;s(_t.id,{name:Ut||"Punt",category:"Overig",notes:"",url:void 0,coordinates:[ce[0],ce[1]],sourceLayer:Ut,geometry:xn?.geometry,sourceProperties:xn?.properties,popupContent:xn?.popupHtml}),G(!1),ve(_t.name),setTimeout(()=>ve(null),2e3)},className:"w-full px-3 py-1.5 text-left text-sm text-gray-700 hover:bg-blue-50 border-0 outline-none bg-transparent flex items-center gap-2",children:[f.jsx("span",{className:"w-2 h-2 rounded-full flex-shrink-0",style:{backgroundColor:_t.color}}),f.jsx("span",{className:"truncate",children:_t.name})]},_t.id))}),f.jsx("div",{className:"border-t border-gray-100 mt-1 pt-1",children:Ne?f.jsxs("div",{className:"px-2 py-1",children:[f.jsx("input",{type:"text",value:ie,onChange:_t=>V(_t.target.value),placeholder:"Naam nieuwe laag...",className:"w-full px-2 py-1 text-sm border border-gray-200 rounded focus:outline-none focus:border-orange-400",autoFocus:!0,onKeyDown:_t=>{if(_t.key==="Enter"&&ie.trim()){const xn=a(ie.trim()),In=re;s(xn,{name:Ut||"Punt",category:"Overig",notes:"",url:void 0,coordinates:[ce[0],ce[1]],sourceLayer:Ut,geometry:In?.geometry,sourceProperties:In?.properties,popupContent:In?.popupHtml}),G(!1),be(!1),V(""),ve(ie.trim()),setTimeout(()=>ve(null),2e3)}else _t.key==="Escape"&&(be(!1),V(""))}}),f.jsxs("div",{className:"flex gap-1 mt-1",children:[f.jsx("button",{onClick:()=>{if(ie.trim()){const _t=a(ie.trim()),xn=re;s(_t,{name:Ut||"Punt",category:"Overig",notes:"",url:void 0,coordinates:[ce[0],ce[1]],sourceLayer:Ut,geometry:xn?.geometry,sourceProperties:xn?.properties,popupContent:xn?.popupHtml}),G(!1),be(!1),V(""),ve(ie.trim()),setTimeout(()=>ve(null),2e3)}},disabled:!ie.trim(),className:"flex-1 px-2 py-1 text-xs bg-orange-500 text-white rounded disabled:opacity-50",children:"Toevoegen"}),f.jsx("button",{onClick:()=>{be(!1),V("")},className:"px-2 py-1 text-xs text-gray-500 hover:text-gray-700",children:"Annuleer"})]})]}):f.jsxs("button",{onClick:()=>be(!0),className:"w-full px-3 py-1.5 text-left text-sm text-orange-600 hover:bg-orange-50 border-0 outline-none bg-transparent flex items-center gap-2",children:[f.jsx(Wa,{size:14}),f.jsx("span",{children:"Nieuwe laag maken..."})]})})]})]}),P&&f.jsx("a",{href:P,target:"_blank",rel:"noopener noreferrer",className:"p-1.5 text-amber-500 hover:text-amber-600 transition-colors flex-shrink-0",title:"Open Street View","aria-label":"Open Street View",children:f.jsx(yV,{size:18})}),R&&f.jsx("a",{href:R,target:"_blank",rel:"noopener noreferrer",className:"p-1.5 text-blue-500 hover:text-blue-600 transition-colors flex-shrink-0",title:"Navigeer naar locatie","aria-label":"Open in Google Maps",children:f.jsx(Cu,{size:18})}),f.jsx("button",{onClick:br,className:"p-1.5 text-gray-400 hover:text-gray-600 transition-colors flex-shrink-0 border-0 outline-none bg-transparent","aria-label":"Sluiten",children:f.jsx(Sr,{size:18})})]}),f.jsx("div",{className:`px-4 py-3 overflow-y-auto select-text min-h-0 ${Ge==="full"?"flex-1":""}`,style:{userSelect:"text",WebkitUserSelect:"text"},dangerouslySetInnerHTML:{__html:tt}}),f.jsxs("div",{className:"px-4 py-2 border-t border-gray-100 flex items-center gap-2 flex-shrink-0",children:[f.jsx(vV,{size:14,className:"text-gray-400 flex-shrink-0"}),f.jsx("input",{type:"range",min:"80",max:"150",value:he,onChange:_t=>pe(parseInt(_t.target.value)),className:"flex-1 h-1.5 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500"}),f.jsxs("span",{className:"text-gray-400 w-8 text-right",style:{fontSize:"0.857em"},children:[he,"%"]})]}),ln&&k&&!O&&f.jsxs("div",{className:"px-4 pb-4 flex gap-2 flex-shrink-0",children:[f.jsxs("button",{onClick:()=>{const _t=r.find(xn=>xn.id===k);_t&&B(_t)},className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 text-white bg-blue-500 hover:bg-blue-600 rounded-lg transition-colors border-0 outline-none",children:[f.jsx(eg,{size:16}),f.jsx("span",{children:"Bewerken"})]}),f.jsxs("button",{onClick:()=>{e(k),m(!1),L(null)},className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 text-white bg-red-500 hover:bg-red-600 rounded-lg transition-colors border-0 outline-none",children:[f.jsx(_c,{size:16}),f.jsx("span",{children:"Verwijderen"})]})]}),O&&f.jsxs("div",{className:"px-4 pb-4 space-y-3 border-t border-gray-100 pt-3 flex-shrink-0 overflow-y-auto max-h-[40vh]",children:[f.jsx("div",{className:"text-sm font-medium text-blue-600",children:"Vondst bewerken"}),f.jsxs("div",{children:[f.jsx("label",{className:"text-xs text-gray-500",children:"Objecttype"}),f.jsx("input",{type:"text",value:O.objectType,onChange:_t=>B({...O,objectType:_t.target.value}),className:"w-full px-2 py-1 text-sm bg-gray-50 rounded border-0 outline-none focus:bg-blue-50"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-xs text-gray-500",children:"Materiaal"}),f.jsx("input",{type:"text",value:O.material,onChange:_t=>B({...O,material:_t.target.value}),className:"w-full px-2 py-1 text-sm bg-gray-50 rounded border-0 outline-none focus:bg-blue-50"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-xs text-gray-500",children:"Periode"}),f.jsx("input",{type:"text",value:O.period,onChange:_t=>B({...O,period:_t.target.value}),className:"w-full px-2 py-1 text-sm bg-gray-50 rounded border-0 outline-none focus:bg-blue-50"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-xs text-gray-500",children:"Notities"}),f.jsx("textarea",{value:O.notes,onChange:_t=>B({...O,notes:_t.target.value}),className:"w-full px-2 py-1 text-sm bg-gray-50 rounded border-0 outline-none focus:bg-blue-50 resize-none h-16"})]}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("button",{onClick:()=>B(null),className:"flex-1 px-3 py-2 text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors border-0 outline-none text-sm",children:"Annuleren"}),f.jsx("button",{onClick:()=>{t(O.id,{objectType:O.objectType,material:O.material,period:O.period,notes:O.notes}),B(null),m(!1)},className:"flex-1 px-3 py-2 text-white bg-blue-500 hover:bg-blue-600 rounded-lg transition-colors border-0 outline-none text-sm",children:"Opslaan"})]})]}),kn&&y&&f.jsx("div",{className:"px-4 pb-4 border-t border-gray-100",children:x?f.jsxs("button",{onClick:Gn,className:"w-full flex items-center justify-center gap-2 px-3 py-2 mt-3 text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors border-0 outline-none",children:[f.jsx(Q0,{size:16}),f.jsx("span",{children:"Hoogtekaart verbergen"})]}):f.jsx("button",{onClick:Pi,disabled:b,className:`w-full flex items-center justify-center gap-2 px-3 py-2 mt-3 text-white rounded-lg transition-colors border-0 outline-none ${b?"bg-blue-400 cursor-wait":"bg-blue-500 hover:bg-blue-600"}`,children:b?f.jsxs(f.Fragment,{children:[f.jsx(DI,{size:16,className:"animate-spin"}),f.jsx("span",{children:"Laden..."})]}):f.jsxs(f.Fragment,{children:[f.jsx(Q0,{size:16}),f.jsx("span",{children:"Hoogtekaart tonen"})]})})})]})]})})}const iD=1e-4;function xbe(n,e){return n.points.some(t=>{const r=Math.abs(t.coordinates[0]-e[0]),i=Math.abs(t.coordinates[1]-e[1]);return r<iD&&i<iD})}function _be(){const n=Xr(D=>D.map),e=ur(D=>D.openVondstForm),{openAddPointModal:t,openCreateLayerModal:r,openLayerManagerModal:i}=ur(),s=Hi(D=>D.layers),[a,o]=H.useState(null),[l,c]=H.useState(!1),[h,g]=H.useState(!1),[m,y]=H.useState(!1),_=H.useRef(null),x=H.useRef(null);H.useEffect(()=>{if(!n){console.log(" LongPressMenu: map not ready");return}const D=n.getViewport();if(!D){console.log(" LongPressMenu: viewport not ready");return}console.log(" LongPressMenu: attached to viewport",D);const N=600,G=15,j=be=>{if(console.log(" Touch start, touches:",be.touches.length),be.touches.length!==1)return;const ie=be.touches[0];x.current={x:ie.clientX,y:ie.clientY},console.log(" Starting long press timer at:",x.current),_.current&&clearTimeout(_.current),_.current=window.setTimeout(()=>{if(console.log(" Timer fired! startPos:",x.current),!x.current)return;const V=window.__olMap;if(!V){console.log(" Map not available (global)");return}const J=D.getBoundingClientRect(),te=[x.current.x-J.left,x.current.y-J.top],re=V.getCoordinateFromPixel(te);if(re){const he=bn(re);be.preventDefault(),o({pixel:[x.current.x,x.current.y],coordinate:he}),c(!0),g(!1),setTimeout(()=>g(!0),300),"vibrate"in navigator&&navigator.vibrate(50),console.log(" Long press detected at:",he)}},N)},ve=be=>{if(!_.current||!x.current)return;const ie=be.touches[0],V=ie.clientX-x.current.x,J=ie.clientY-x.current.y,te=Math.sqrt(V*V+J*J);te>G&&(console.log(" Touch moved too much, cancelling. Distance:",te),clearTimeout(_.current),_.current=null)},ce=()=>{console.log(" Touch end, timer active:",!!_.current),_.current&&(console.log(" Cancelling timer on touch end"),clearTimeout(_.current),_.current=null),x.current=null},je=be=>{l&&be.preventDefault()},Pe=be=>{be.button===0&&(console.log(" Mouse down"),x.current={x:be.clientX,y:be.clientY},_.current&&clearTimeout(_.current),_.current=window.setTimeout(()=>{if(console.log(" Mouse timer fired!"),!x.current)return;const ie=window.__olMap;if(console.log(" __olMap:",ie),console.log(" __olMap constructor:",ie?.constructor?.name),console.log(" has getCoordinateAtPixel:",typeof ie?.getCoordinateAtPixel),!ie){console.log(" Map not available (global)");return}const V=D.getBoundingClientRect(),J=[x.current.x-V.left,x.current.y-V.top];console.log(" Pixel:",J);const te=ie.getCoordinateFromPixel(J);if(console.log(" Coordinate:",te),te){const re=bn(te);o({pixel:[x.current.x,x.current.y],coordinate:re}),c(!0),g(!1),setTimeout(()=>g(!0),300),console.log(" Long press (mouse) detected at:",re)}},N))},ue=be=>{if(!_.current||!x.current)return;const ie=be.clientX-x.current.x,V=be.clientY-x.current.y;Math.sqrt(ie*ie+V*V)>G&&(console.log(" Mouse moved, cancelling"),clearTimeout(_.current),_.current=null)},Ne=()=>{console.log(" Mouse up"),_.current&&(clearTimeout(_.current),_.current=null),x.current=null};return D.addEventListener("touchstart",j,{passive:!1}),D.addEventListener("touchmove",ve,{passive:!0}),D.addEventListener("touchend",ce),D.addEventListener("touchcancel",ce),D.addEventListener("contextmenu",je),D.addEventListener("mousedown",Pe),D.addEventListener("mousemove",ue),D.addEventListener("mouseup",Ne),D.addEventListener("mouseleave",Ne),()=>{D.removeEventListener("touchstart",j),D.removeEventListener("touchmove",ve),D.removeEventListener("touchend",ce),D.removeEventListener("touchcancel",ce),D.removeEventListener("contextmenu",je),D.removeEventListener("mousedown",Pe),D.removeEventListener("mousemove",ue),D.removeEventListener("mouseup",Ne),D.removeEventListener("mouseleave",Ne),_.current&&clearTimeout(_.current)}},[n,l]);const w=()=>{h&&(c(!1),o(null),g(!1),y(!1))},b=()=>{c(!1),o(null),g(!1),y(!1)},T=D=>{if(!a)return;const[N,G]=a.coordinate;t(D,{lat:G,lng:N}),b()},k=()=>{r(),b()},L=()=>{if(!a)return;const[D,N]=a.coordinate;e({lat:N,lng:D}),c(!1),o(null),g(!1)},O=()=>{if(!a)return;const[D,N]=a.coordinate,G=`https://www.google.com/maps?q=${N},${D}`;window.open(G,"_blank"),c(!1),o(null),g(!1)},B=()=>{if(!a)return;const[D,N]=a.coordinate,G=`https://www.google.com/maps?layer=c&cbll=${N},${D}`;window.open(G,"_blank"),b()},R=()=>{if(!a)return;const D=document.createElement("input");D.type="file",D.accept="image/*",D.capture="environment",D.onchange=async N=>{const G=N.target.files?.[0];if(!G)return;const[j,ve]=a.coordinate;e({lat:ve,lng:j},G)},D.click(),b()},A=()=>{i(),b()},P=D=>{const[N,G]=D;return`${G.toFixed(5)}N, ${N.toFixed(5)}E`};return f.jsx(An,{children:l&&a&&f.jsxs(f.Fragment,{children:[f.jsx(wt.div,{className:"fixed inset-0 z-[1600]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:w}),f.jsxs(wt.div,{className:"fixed z-[1601] bg-white rounded-xl shadow-md overflow-hidden min-w-[200px] border-0 outline-none",style:{left:Math.min(a.pixel[0],window.innerWidth-220),top:(()=>{const D=m?480:380;return window.innerHeight-a.pixel[1]<D&&a.pixel[1]>D?a.pixel[1]-D+40:Math.min(a.pixel[1],window.innerHeight-D)})()},initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.15},children:[f.jsx("div",{className:"px-4 py-3 bg-white border-b border-gray-100",children:f.jsxs("div",{className:"flex items-center gap-2 text-blue-600",children:[f.jsx(pa,{size:16}),f.jsx("span",{className:"text-xs font-mono",children:P(a.coordinate)})]})}),f.jsxs("div",{className:"bg-white",children:[f.jsxs("button",{onClick:L,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-orange-50 text-gray-700 bg-white border-0 outline-none",children:[f.jsx(jv,{size:20,className:"text-orange-500"}),f.jsx("span",{className:"font-medium",children:"Vondst toevoegen"})]}),f.jsxs("button",{onClick:R,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-green-50 text-gray-700 bg-white border-0 outline-none",children:[f.jsx(RE,{size:20,className:"text-green-500"}),f.jsx("span",{className:"font-medium",children:"Foto maken"})]}),f.jsxs("div",{className:"relative",children:[f.jsxs("button",{onClick:()=>y(!m),className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-blue-50 text-gray-700 bg-white border-0 outline-none",children:[f.jsx(Va,{size:20,className:"text-purple-500"}),f.jsx("span",{className:"font-medium flex-1 text-left",children:"Voeg toe aan laag..."}),f.jsx(yg,{size:16,className:`text-gray-400 transition-transform ${m?"rotate-90":""}`})]}),f.jsx(An,{children:m&&f.jsx(wt.div,{className:"bg-gray-50 border-t border-gray-100",initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},children:s.length===0?f.jsxs("button",{onClick:k,className:"w-full px-4 py-2 pl-11 flex items-center gap-2 text-sm text-purple-600 hover:bg-purple-50 bg-transparent border-0 outline-none",children:[f.jsx(Wa,{size:14}),f.jsx("span",{children:"Maak eerst een laag aan"})]}):f.jsxs(f.Fragment,{children:[s.map(D=>{const N=a?xbe(D,a.coordinate):!1;return f.jsxs("button",{onClick:()=>!N&&T(D.id),className:`w-full px-4 py-2 pl-11 flex items-center gap-2 text-sm bg-transparent border-0 outline-none ${N?"text-gray-400 cursor-not-allowed":"text-gray-700 hover:bg-gray-100"}`,title:N?"Al toegevoegd aan deze laag":void 0,disabled:N,children:[N&&f.jsx(uc,{size:14,className:"text-green-500 flex-shrink-0"}),f.jsx("span",{className:"truncate",children:D.name}),f.jsx("span",{className:"text-xs text-gray-400 ml-auto",children:N?"al toegevoegd":`(${D.points.length})`})]},D.id)}),f.jsxs("button",{onClick:k,className:"w-full px-4 py-2 pl-11 flex items-center gap-2 text-sm text-purple-600 hover:bg-purple-50 bg-transparent border-0 outline-none border-t border-gray-200",children:[f.jsx(Wa,{size:14}),f.jsx("span",{children:"Nieuwe laag..."})]})]})})})]}),f.jsxs("button",{onClick:A,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-purple-50 text-gray-700 bg-white border-0 outline-none",children:[f.jsx(Sue,{size:20,className:"text-purple-500"}),f.jsx("span",{className:"font-medium",children:"Lagen beheren"})]}),f.jsxs("button",{onClick:O,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-blue-50 text-gray-700 bg-white border-0 outline-none",children:[f.jsx(Cu,{size:20,className:"text-blue-600"}),f.jsx("span",{className:"font-medium",children:"Open in Google Maps"})]}),f.jsxs("button",{onClick:B,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-yellow-50 text-gray-700 bg-white border-0 outline-none",children:[f.jsx(yV,{size:20,className:"text-yellow-600"}),f.jsx("span",{className:"font-medium",children:"Street View"})]})]}),f.jsx("div",{className:"bg-white",children:f.jsxs("button",{onClick:b,className:"w-full px-4 py-3 flex items-center justify-center gap-2 text-gray-500 hover:bg-blue-50 transition-colors bg-white border-0 outline-none",children:[f.jsx(Sr,{size:18}),f.jsx("span",{children:"Annuleren"})]})})]})]})})}const vbe={Compass:lce,TreePalm:Hue,Mountain:Q0,Waves:rhe,Search:zv,Target:Gue,Layers:Va,Grid:dV},wbe={Compass:"text-purple-600",Waves:"text-cyan-600",TreePalm:"text-green-600",Mountain:"text-stone-600",Search:"text-amber-600",Target:"text-red-600",Layers:"text-blue-600",Grid:"text-lime-600"},Ebe={Compass:"hover:bg-purple-50",Waves:"hover:bg-cyan-50",TreePalm:"hover:bg-green-50",Mountain:"hover:bg-stone-50",Search:"hover:bg-amber-50",Target:"hover:bg-red-50",Layers:"hover:bg-blue-50",Grid:"hover:bg-lime-50"},sD=["Mijn Vondsten","Labels Overlay","TMK 1850","Bonnebladen 1900","Hunebedden","FAMKE Steentijd","FAMKE IJzertijd","Grafheuvels","Terpen","AMK Monumenten","AMK Romeins","AMK Steentijd","AMK Vroege ME","AMK Late ME","AMK Overig","Romeinse wegen (regio)","Romeinse wegen (Wereld)","Romeinse Forten","Romeinse Forten Lijnen","Kastelen","IKAW","Archeo Onderzoeken","Rijksmonumenten","Werelderfgoed","Religieus Erfgoed","Essen","Runes","WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Inundatiegebieden","Militaire Objecten","Paleokaart 800 n.Chr.","Paleokaart 100 n.Chr.","Paleokaart 500 v.Chr.","Paleokaart 1500 v.Chr.","Paleokaart 2750 v.Chr.","Paleokaart 5500 v.Chr.","Paleokaart 9000 v.Chr.","UIKAV Punten","UIKAV Vlakken","UIKAV Expert","UIKAV Buffer","UIKAV Indeling","Hoogtekaart (WebGL)","AHN4 Hoogtekaart Kleur","AHN4 Hillshade NL","AHN4 Multi-Hillshade NL","AHN 0.5m","Veengebieden","Geomorfologie","Bodemkaart","Fossiel Hotspots","Mineralen Hotspots","Goudrivieren","Fossielen Nederland","Fossielen Belgi","Fossielen Duitsland","Fossielen Frankrijk","Parken","Speeltuinen","Musea","Strandjes","Kringloopwinkels","Ruiterpaden","Laarzenpaden","Gewaspercelen","Kadastrale Grenzen","Scheepswrakken","Woonheuvels ZH","Windmolens","Erfgoedlijnen","Oude Kernen","Relictenkaart Punten","Relictenkaart Lijnen","Relictenkaart Vlakken","Verdronken Dorpen"],Sbe=["CartoDB (licht)","OpenStreetMap","Luchtfoto","TMK 1850","Bonnebladen 1900"],bbe=[5.2913,52.1326],Tbe=8;function Rbe(){const n=Ti(N=>N.setLayerVisibility),e=ls(N=>N.stopTracking),t=Xr(N=>N.map),{presetsPanelOpen:r,togglePresetsPanel:i,closeAllPanels:s}=ur(),{presets:a,applyPreset:o,updatePreset:l,createPreset:c,resetToDefaults:h}=C9(),g=Ti(N=>N.visible),m=dn(N=>N.presetPanelFontScale),y=dn(N=>N.setPresetPanelFontScale),_=dn(N=>N.showFontSliders),x=12*m/100,[w,b]=H.useState(null),[T,k]=H.useState(!1),[L,O]=H.useState(""),B=()=>{s(),sD.forEach(N=>n(N,!1)),Sbe.forEach(N=>{n(N,N==="CartoDB (licht)")}),e(),t&&t.getView().animate({center:Ir(bbe),zoom:Tbe,duration:500}),console.log(" Reset: CartoDB, alle lagen uit, GPS uit, zoom naar Nederland")},R=N=>{o(N),s()},A=(N,G)=>{N.stopPropagation();const j=Object.entries(g).filter(([ve,ce])=>ce&&sD.includes(ve)).map(([ve])=>ve);l(G,{layers:j}),b(G),setTimeout(()=>b(null),2e3),console.log(" Lagen opgeslagen naar preset")},P=()=>{L.trim()&&(c(L.trim(),"Layers"),O(""),k(!1))},D=()=>{confirm("Alle presets terugzetten naar standaard? Dit verwijdert aangepaste presets.")&&h()};return f.jsxs(f.Fragment,{children:[f.jsx(wt.button,{onClick:B,className:"fixed bottom-2 left-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},title:"Reset - CartoDB, alle lagen uit, GPS uit",children:f.jsx(due,{size:20,className:"text-gray-600"})}),f.jsx(wt.button,{onClick:i,className:"fixed bottom-[60px] left-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},title:"Presets",children:r?f.jsx(AE,{size:20,className:"text-blue-600"}):f.jsx(Va,{size:20,className:"text-blue-600"})}),f.jsx(An,{children:r&&f.jsxs(f.Fragment,{children:[f.jsx(wt.div,{className:"fixed inset-0 z-[800]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:i}),f.jsxs(wt.div,{initial:{opacity:0,x:-10,scale:.95},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:-10,scale:.95},transition:{duration:.15},className:"fixed bottom-[60px] left-[56px] bg-white/95 rounded-xl shadow-lg overflow-hidden w-[240px] backdrop-blur-sm z-[801]",children:[f.jsxs("div",{className:"flex items-center justify-between gap-2 px-3 py-1.5 bg-blue-500",style:{fontSize:`${x}px`},children:[f.jsx("span",{className:"font-medium text-white",children:"Presets"}),_&&f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("span",{className:"text-[9px] text-blue-200",children:"T"}),f.jsx("input",{type:"range",min:"80",max:"130",step:"10",value:m,onInput:N=>{y(parseInt(N.target.value))},onChange:N=>y(parseInt(N.target.value)),className:"w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${m}%`}),f.jsx("span",{className:"text-[11px] text-blue-200",children:"T"})]})]}),f.jsx("div",{className:"p-2 max-h-[300px] overflow-y-auto",children:a.map(N=>{const G=vbe[N.icon]||Va,j=wbe[N.icon]||"text-blue-600",ve=Ebe[N.icon]||"hover:bg-blue-50",ce=w===N.id;return f.jsxs("button",{onClick:()=>R(N.id),className:`w-full h-8 flex items-center gap-2 px-2 ${ve} rounded text-left transition-colors border-0 outline-none bg-transparent overflow-hidden ${ce?"bg-green-50":""}`,style:{fontSize:`${x}px`},children:[f.jsx(G,{size:14,className:`${j} flex-shrink-0`}),f.jsx("span",{className:"text-gray-700 truncate flex-1",children:N.name}),ce?f.jsx("span",{className:"ml-auto p-1 flex-shrink-0",children:f.jsx(uc,{size:14,className:"text-green-500"})}):f.jsx("span",{onClick:je=>A(je,N.id),className:"ml-auto p-1 hover:bg-gray-200 rounded transition-colors flex-shrink-0",title:"Huidige lagen opslaan naar deze preset",children:f.jsx(_V,{size:12,className:"text-gray-400 hover:text-blue-500"})})]},N.id)})}),f.jsx("div",{className:"border-t border-gray-200 p-2",children:T?f.jsxs("div",{className:"flex gap-1",children:[f.jsx("input",{type:"text",value:L,onChange:N=>O(N.target.value),onKeyDown:N=>{N.key==="Enter"&&P(),N.key==="Escape"&&k(!1)},placeholder:"Naam preset...",autoFocus:!0,className:"flex-1 px-2 py-1 text-sm rounded bg-gray-50 border-0 outline-none focus:ring-1 focus:ring-blue-400",style:{fontSize:`${x}px`}}),f.jsx("button",{onClick:P,disabled:!L.trim(),className:"px-2 py-1 bg-blue-500 text-white rounded text-sm disabled:opacity-50 border-0 outline-none",children:f.jsx(uc,{size:14})})]}):f.jsxs("div",{className:"flex gap-1",children:[f.jsxs("button",{onClick:()=>k(!0),className:"flex-1 flex items-center justify-center gap-1 px-2 py-1.5 text-sm text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none",style:{fontSize:`${x}px`},children:[f.jsx(Wa,{size:14}),f.jsx("span",{children:"Nieuwe preset"})]}),f.jsx("button",{onClick:D,className:"p-1.5 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded transition-colors border-0 outline-none",title:"Presets terugzetten naar standaard",children:f.jsx(gue,{size:14})})]})})]})]})})]})}function Abe(){const n=Xr(a=>a.map),[e,t]=H.useState(0),[r,i]=H.useState(!1);H.useEffect(()=>{if(!n)return;const a=n.getView(),o=()=>{const l=a.getRotation(),c=l*180/Math.PI;t(c),i(Math.abs(l)>.087)};return o(),a.on("change:rotation",o),()=>{a.un("change:rotation",o)}},[n]);const s=()=>{n&&n.getView().animate({rotation:0,duration:300})};return f.jsx(An,{children:r&&f.jsx(wt.button,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{duration:.2},onClick:s,className:"fixed top-[60px] right-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",title:"Klik om noorden te herstellen",children:f.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",style:{transform:`rotate(${-e}deg)`},children:[f.jsx("path",{d:"M12 2 L14.5 12 L12 10 L9.5 12 Z",fill:"#EA4335"}),f.jsx("path",{d:"M12 22 L9.5 12 L12 14 L14.5 12 Z",fill:"white",stroke:"#9CA3AF",strokeWidth:"0.5"}),f.jsx("circle",{cx:"12",cy:"12",r:"2",fill:"#374151"})]})})})}const kbe=[{name:"AHN4 Hoogtekaart Kleur",color:"blue",default:.85},{name:"AHN4 Hillshade NL",color:"blue",default:.7},{name:"AHN4 Multi-Hillshade NL",color:"blue",default:.7},{name:"AHN 0.5m",color:"blue",default:.7},{name:"TMK 1850",color:"amber",default:.8},{name:"Bonnebladen 1900",color:"amber",default:.8},{name:"Geomorfologie",color:"green",default:.5},{name:"Bodemkaart",color:"amber",default:.6},{name:"Veengebieden",color:"amber",default:.6},{name:"IKAW",color:"orange",default:.5},{name:"Archeo Landschappen",color:"green",default:.5},{name:"Terpen",color:"orange",default:.7},{name:"Essen",color:"amber",default:.6},{name:"AMK Monumenten",color:"purple",default:.45},{name:"AMK Romeins",color:"red",default:.6},{name:"AMK Steentijd",color:"amber",default:.6},{name:"AMK Vroege ME",color:"green",default:.6},{name:"AMK Late ME",color:"blue",default:.6},{name:"AMK Overig",color:"purple",default:.6},{name:"Paleokaart 9000 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 5500 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 2750 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 1500 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 500 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 100 n.Chr.",color:"indigo",default:.7},{name:"Paleokaart 800 n.Chr.",color:"indigo",default:.7},{name:"Verdedigingslinies",color:"red",default:.7},{name:"Inundatiegebieden",color:"red",default:.5},{name:"Gewaspercelen",color:"green",default:.6},{name:"Erfgoedlijnen",color:"purple",default:.7},{name:"Oude Kernen",color:"orange",default:.6},{name:"Relictenkaart Vlakken",color:"green",default:.5}],Ibe={blue:"accent-blue-500",amber:"accent-amber-500",red:"accent-red-500",indigo:"accent-indigo-500",green:"accent-green-500",orange:"accent-orange-500",purple:"accent-purple-500"};function Cbe(){const[n,e]=H.useState(!1),[t,r]=H.useState(!1),i=Ti(h=>h.visible),s=Ti(h=>h.opacity),a=Ti(h=>h.setLayerOpacity),o=kbe.filter(h=>i[h.name]);if(o.length===0)return null;const l=t?o:o.slice(0,3),c=o.length>3;return f.jsxs("div",{className:"fixed bottom-[112px] right-2 z-[900]",children:[f.jsxs(wt.button,{onClick:()=>e(!n),className:"w-11 h-11 bg-white/80 rounded-xl backdrop-blur-sm shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none hover:bg-white/90 transition-colors",whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":"Opacity sliders",title:n?"Sluit opacity sliders":"Open opacity sliders",children:[f.jsx(Iue,{size:22,strokeWidth:2,className:"text-gray-500"}),o.length>0&&f.jsx("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-blue-500 text-white text-[10px] rounded-full flex items-center justify-center",children:o.length})]}),f.jsx(An,{children:n&&f.jsxs(f.Fragment,{children:[f.jsx(wt.div,{className:"fixed inset-0 z-[-1]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>e(!1)}),f.jsxs(wt.div,{initial:{opacity:0,x:20,scale:.9},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:20,scale:.9},transition:{duration:.2},className:"absolute bottom-0 right-14 bg-white/95 rounded-lg shadow-lg p-3 min-w-[220px] max-h-[60vh] overflow-y-auto",children:[f.jsx("div",{className:"text-xs font-semibold text-gray-500 mb-2 uppercase tracking-wide",children:"Transparantie"}),f.jsx("div",{className:"space-y-3",children:l.map(h=>{const g=s[h.name]??h.default;return f.jsxs("div",{children:[f.jsx("label",{className:"text-xs font-medium text-gray-700 mb-1 block truncate",title:h.name,children:h.name}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("input",{type:"range",min:"0",max:"100",value:g*100,onChange:m=>a(h.name,parseInt(m.target.value)/100),className:`flex-1 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer ${Ibe[h.color]}`}),f.jsxs("span",{className:"text-xs text-gray-500 w-8 text-right select-none pointer-events-none",children:[Math.round(g*100),"%"]})]})]},h.name)})}),c&&f.jsx("button",{onClick:()=>r(!t),className:"w-full mt-3 pt-2 border-t border-gray-200 flex items-center justify-center gap-1 text-xs text-gray-500 hover:text-gray-700",children:t?f.jsxs(f.Fragment,{children:[f.jsx(AE,{size:14}),"Minder tonen"]}):f.jsxs(f.Fragment,{children:[f.jsx(pg,{size:14}),o.length-3," meer..."]})})]})]})})]})}function Pbe(){const n=Xr(O=>O.map),e=dn(O=>O.showWeatherButton),[t,r]=H.useState(!1),[i,s]=H.useState(""),[a,o]=H.useState([]),[l,c]=H.useState(!1),[h,g]=H.useState(!1),m=H.useRef(null),y=H.useRef(null),_=H.useRef();H.useEffect(()=>{t&&m.current&&m.current.focus()},[t]),H.useEffect(()=>{if(!t)return;const O=B=>{y.current&&!y.current.contains(B.target)&&x()};return document.addEventListener("mousedown",O),()=>document.removeEventListener("mousedown",O)},[t]),H.useEffect(()=>{if(!t)return;const O=B=>{B.key==="Escape"&&x()};return document.addEventListener("keydown",O),()=>document.removeEventListener("keydown",O)},[t]),H.useEffect(()=>{if(_.current&&clearTimeout(_.current),i.length<2){o([]);return}return _.current=window.setTimeout(async()=>{g(!0);try{const B=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/suggest?q=${encodeURIComponent(i)}&rows=7`)).json();B.response?.docs&&o(B.response.docs)}catch(O){console.error("Search error:",O),o([])}finally{g(!1)}},300),()=>{_.current&&clearTimeout(_.current)}},[i]);const x=()=>{r(!1),s(""),o([]),c(!1)},w=async O=>{try{const R=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/lookup?id=${encodeURIComponent(O)}`)).json();if(R.response?.docs?.[0]?.centroide_ll){const P=R.response.docs[0].centroide_ll.match(/POINT\(([^ ]+) ([^)]+)\)/);if(P)return{lng:parseFloat(P[1]),lat:parseFloat(P[2])}}}catch(B){console.error("Lookup error:",B)}return null},b=async O=>{if(!n)return;const B=await w(O.id);B&&n.getView().animate({center:Ir([B.lng,B.lat]),zoom:16,duration:1e3}),x()},T=async(O,B)=>{B.stopPropagation();const R=await w(O.id);if(R){const A=`https://www.google.com/maps?q=${R.lat},${R.lng}`;window.open(A,"_blank")}x()},k={top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"};if(!t)return f.jsx(wt.button,{className:"fixed right-14 z-[800] w-11 h-11 flex items-center justify-center bg-white/90 hover:bg-white rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",style:k,onClick:()=>r(!0),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Zoeken",children:f.jsx(zv,{size:22,className:"text-gray-600"})});const L=e?"220px":"52px";return f.jsxs("div",{ref:y,className:"fixed right-14 z-[850]",style:{...k,left:L},children:[f.jsxs(wt.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"search-input-wrapper",children:[f.jsx(zv,{size:18,className:"search-icon"}),f.jsx("input",{ref:m,type:"text",value:i,onChange:O=>{s(O.target.value),c(!0)},onFocus:()=>c(!0),placeholder:"Zoek adres of plaats...",className:"search-input"}),f.jsx("button",{onClick:x,className:"search-clear",title:"Sluiten",children:f.jsx(Sr,{size:18})})]}),f.jsx(An,{children:l&&a.length>0&&f.jsx(wt.ul,{className:"search-results",initial:{opacity:0,y:-8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},children:a.map(O=>f.jsxs("li",{className:"search-result-item",children:[f.jsx("div",{className:"search-result-content",onClick:()=>b(O),children:f.jsx("span",{className:"search-result-text",children:O.weergavenaam})}),f.jsx("button",{className:"search-navigate-btn",onClick:B=>T(O,B),title:"Open in Google Maps",children:f.jsx(Cu,{size:20})})]},O.id))})}),l&&h&&f.jsx("div",{className:"search-loading",children:"Zoeken..."})]})}function Nbe(){const n=Xr(i=>i.map),e=()=>{if(!n)return;const i=n.getView(),s=i.getZoom();s!==void 0&&i.animate({zoom:s+1,duration:200})},t=()=>{if(!n)return;const i=n.getView(),s=i.getZoom();s!==void 0&&i.animate({zoom:s-1,duration:200})};return f.jsxs("div",{className:"fixed right-2 z-[800] flex flex-col gap-1",style:{top:"calc(max(0.5rem, env(safe-area-inset-top, 0.5rem)) + 52px)"},children:[f.jsx(wt.button,{className:"w-9 h-9 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},title:"Inzoomen",children:f.jsx(Wa,{size:18,className:"text-gray-600"})}),f.jsx(wt.button,{className:"w-9 h-9 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",onClick:t,whileHover:{scale:1.05},whileTap:{scale:.95},title:"Uitzoomen",children:f.jsx(mV,{size:18,className:"text-gray-600"})})]})}const Mbe="detector2024",KR="detectorapp-auth";function Lbe({children:n}){const[e,t]=H.useState(!1),[r,i]=H.useState(""),[s,a]=H.useState(!1),[o,l]=H.useState(""),[c,h]=H.useState(!0);H.useEffect(()=>{localStorage.getItem(KR)==="authenticated"&&t(!0),h(!1)},[]);const g=m=>{m.preventDefault(),l(""),r===Mbe?(localStorage.setItem(KR,"authenticated"),t(!0)):(l("Onjuist wachtwoord"),i(""))};return c?f.jsx("div",{className:"fixed inset-0 bg-gradient-to-br from-blue-600 to-blue-800 flex items-center justify-center",children:f.jsx("div",{className:"text-white text-lg",children:"Laden..."})}):e?f.jsx(f.Fragment,{children:n}):f.jsx("div",{className:"fixed inset-0 bg-gradient-to-br from-blue-600 to-blue-800 flex items-center justify-center p-4",children:f.jsxs(wt.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-2xl shadow-2xl p-8 w-full max-w-sm",children:[f.jsxs("div",{className:"text-center mb-6",children:[f.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:f.jsx(AR,{size:32,className:"text-blue-600"})}),f.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"DetectorApp"}),f.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Test versie - Toegang beveiligd"})]}),f.jsxs("form",{onSubmit:g,className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Wachtwoord"}),f.jsxs("div",{className:"relative",children:[f.jsx("input",{type:s?"text":"password",value:r,onChange:m=>i(m.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none pr-12",placeholder:"Voer wachtwoord in",autoFocus:!0}),f.jsx("button",{type:"button",onClick:()=>a(!s),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:s?f.jsx(Vv,{size:20}):f.jsx(Bv,{size:20})})]})]}),o&&f.jsx(wt.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-red-500 text-sm text-center",children:o}),f.jsx("button",{type:"submit",className:"w-full py-3 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors",children:"Inloggen"})]}),f.jsx("p",{className:"text-center text-xs text-gray-400 mt-6",children:"Alleen voor testers"})]})})}function Obe(){localStorage.removeItem(KR),window.location.reload()}function Dbe({isOpen:n,onClose:e}){const t=ul(l=>l.vondsten),r={total:t.length,byType:{},byMaterial:{},byPeriod:{},byCondition:{},avgDepth:0,totalWeight:0,recent:t.slice(-5).reverse()};let i=0,s=0;t.forEach(l=>{r.byType[l.objectType]=(r.byType[l.objectType]||0)+1,r.byMaterial[l.material]=(r.byMaterial[l.material]||0)+1,r.byPeriod[l.period]=(r.byPeriod[l.period]||0)+1,l.condition&&(r.byCondition[l.condition]=(r.byCondition[l.condition]||0)+1),l.depth&&(i+=l.depth,s++),l.weight&&(r.totalWeight+=l.weight)}),r.avgDepth=s>0?Math.round(i/s):0;const a=l=>Object.entries(l).sort((c,h)=>h[1]-c[1]),o=l=>Math.max(...Object.values(l),1);return f.jsx(An,{children:n&&f.jsxs(f.Fragment,{children:[f.jsx(wt.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),f.jsxs(wt.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-md mx-auto my-auto max-h-[90vh]",initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},children:[f.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(cV,{size:18}),f.jsx("span",{className:"font-medium",children:"Mijn Vondsten Dashboard"})]}),f.jsx("button",{onClick:e,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none",children:f.jsx(Sr,{size:18})})]}),f.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-5",children:t.length===0?f.jsxs("div",{className:"text-center py-8 text-gray-500",children:[f.jsx(pa,{size:48,className:"mx-auto mb-3 opacity-30"}),f.jsx("p",{className:"font-medium",children:"Nog geen vondsten"}),f.jsx("p",{className:"text-sm mt-1",children:"Voeg je eerste vondst toe via de oranje knop of long-press op de kaart"})]}):f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[f.jsx(Kb,{icon:f.jsx(pa,{size:20}),value:r.total,label:"Totaal",color:"bg-orange-100 text-orange-700"}),f.jsx(Kb,{icon:f.jsx(e1,{size:20}),value:r.avgDepth>0?`${r.avgDepth}cm`:"-",label:"Gem. diepte",color:"bg-blue-100 text-blue-700"}),f.jsx(Kb,{icon:f.jsx(_ue,{size:20}),value:r.totalWeight>0?`${r.totalWeight.toFixed(1)}g`:"-",label:"Tot. gewicht",color:"bg-green-100 text-green-700"})]}),f.jsx(Qx,{title:"Per Type",data:a(r.byType),max:o(r.byType),color:"bg-orange-500"}),f.jsx(Qx,{title:"Per Periode",data:a(r.byPeriod),max:o(r.byPeriod),color:"bg-amber-500"}),f.jsx(Qx,{title:"Per Materiaal",data:a(r.byMaterial),max:o(r.byMaterial),color:"bg-blue-500"}),Object.keys(r.byCondition).length>0&&f.jsx(Qx,{title:"Per Conditie",data:a(r.byCondition),max:o(r.byCondition),color:"bg-green-500"}),f.jsxs("div",{children:[f.jsxs("h3",{className:"text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2",children:[f.jsx(NI,{size:14}),"Recente Vondsten"]}),f.jsx("div",{className:"space-y-2",children:r.recent.map(l=>f.jsxs("div",{className:"flex items-center justify-between py-2 px-3 bg-gray-50 rounded-lg",children:[f.jsxs("div",{children:[f.jsx("span",{className:"font-medium text-sm text-gray-800",children:l.objectType}),f.jsx("span",{className:"text-gray-400 mx-1",children:"-"}),f.jsx("span",{className:"text-sm text-gray-600",children:l.material})]}),f.jsx("span",{className:"text-xs text-gray-400",children:new Date(l.timestamp).toLocaleDateString("nl-NL")})]},l.id))})]})]})})]})]})})}function Kb({icon:n,value:e,label:t,color:r}){return f.jsxs("div",{className:`rounded-lg p-3 ${r}`,children:[f.jsx("div",{className:"flex items-center gap-2 mb-1 opacity-70",children:n}),f.jsx("div",{className:"text-xl font-bold",children:e}),f.jsx("div",{className:"text-xs opacity-70",children:t})]})}function Qx({title:n,data:e,max:t,color:r}){return e.length===0?null:f.jsxs("div",{children:[f.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:n}),f.jsx("div",{className:"space-y-1.5",children:e.slice(0,6).map(([i,s])=>f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:"w-24 text-xs text-gray-600 truncate",title:i,children:i}),f.jsx("div",{className:"flex-1 h-4 bg-gray-100 rounded-full overflow-hidden",children:f.jsx(wt.div,{className:`h-full ${r} rounded-full`,initial:{width:0},animate:{width:`${s/t*100}%`},transition:{duration:.5,ease:"easeOut"}})}),f.jsx("div",{className:"w-6 text-xs text-gray-600 text-right font-medium",children:s})]},i))})]})}function jbe(n){const{type:e,coordinates:t}=n,r=o=>Ir(o),i=o=>o.map(r),s=o=>o.map(i),a=o=>o.map(s);switch(e){case"Point":return new mi(r(t));case"LineString":return new bi(i(t));case"Polygon":return new Ua(s(t));case"MultiPoint":return new Nd(i(t));case"MultiLineString":return new ic(s(t));case"MultiPolygon":return new cd(a(t));default:return console.warn(`Unsupported geometry type: ${e}`),null}}function Fbe(n,e,t){const r=n.color,i=10,s=5,a=14;let o=i;if(t>50?o=s:t>10?o=Math.max(s,i-(t-10)/10):t<2&&(o=a),e==="Point"||e==="MultiPoint")return new gn({image:new Us({radius:o,fill:new Jn({color:r}),stroke:new Hn({color:"#ffffff",width:2})})});if(e==="LineString"||e==="MultiLineString")return new gn({stroke:new Hn({color:r,width:3})});if(e==="Polygon"||e==="MultiPolygon"){const l=Vbe(r,.3);return new gn({fill:new Jn({color:l}),stroke:new Hn({color:r,width:2})})}return new gn({image:new Us({radius:o,fill:new Jn({color:r}),stroke:new Hn({color:"#ffffff",width:2})})})}function Vbe(n,e){const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(n);if(t){const r=parseInt(t[1],16),i=parseInt(t[2],16),s=parseInt(t[3],16);return`rgba(${r}, ${i}, ${s}, ${e})`}return n}function Bbe(){const n=Xr(r=>r.map),e=W1(r=>r.layers),t=H.useRef(new Map);return H.useEffect(()=>{if(!n)return;const r=new Set;e.forEach(i=>{r.add(i.id);const s=new xl;i.features.features.forEach((o,l)=>{if(!o.geometry)return;const c=jbe(o.geometry);if(!c)return;const h=new vr({geometry:c,...o.properties,layerType:"importedLayer",layerId:i.id,layerName:i.name,layerColor:i.color,featureIndex:l});h.setStyle((g,m)=>Fbe(i,o.geometry.type,m)),s.addFeature(h)});const a=t.current.get(i.id);if(a)a.setSource(s),a.setVisible(i.visible),a.setOpacity(i.opacity);else{const o=new pc({source:s,zIndex:900,visible:i.visible,opacity:i.opacity,properties:{title:i.name,customLayerId:i.id}});n.addLayer(o),t.current.set(i.id,o)}}),t.current.forEach((i,s)=>{r.has(s)||(n.removeLayer(i),t.current.delete(s))})},[n,e]),H.useEffect(()=>()=>{n&&(t.current.forEach(r=>{n.removeLayer(r)}),t.current.clear())},[n]),null}Tn.defs("EPSG:28992","+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m +no_defs");bB(Tn);function Gbe(n){if(!n||n.length<2)return"unknown";const[e,t]=n;return e>=7e3&&e<=3e5&&t>=289e3&&t<=629e3?"RD":Math.abs(e)<=180&&Math.abs(t)<=90?"WGS84":"unknown"}function zbe(n){const[e,t]=n;return Tn("EPSG:28992","EPSG:4326",[e,t])}function sz(n,e){return typeof n[0]=="number"?e(n):n.map(t=>sz(t,e))}function Ube(n){const e=n.coordinates;return!e||Array.isArray(e)&&e.length===0?null:n.type==="Point"?e:n.type==="LineString"||n.type==="MultiPoint"?e[0]:n.type==="Polygon"||n.type==="MultiLineString"?e[0]?.[0]:n.type==="MultiPolygon"?e[0]?.[0]?.[0]:null}async function $be(n){const e=[],t=[];try{const r=await n.text(),i=JSON.parse(r);if(!i.type)return e.push('Ongeldig GeoJSON: geen "type" veld gevonden'),{success:!1,features:{type:"FeatureCollection",features:[]},errors:e,warnings:t,metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}};let s=[];i.type==="FeatureCollection"?s=i.features||[]:i.type==="Feature"?s=[i]:i.type==="GeometryCollection"?s=(i.geometries||[]).map((c,h)=>({type:"Feature",geometry:c,properties:{id:h}})):s=[{type:"Feature",geometry:i,properties:{}}],s.length===0&&t.push("Geen features gevonden in bestand");let a="unknown",o=!1;if(s.length>0&&s[0].geometry){const c=Ube(s[0].geometry);c&&(a=Gbe(c))}a==="RD"&&(t.push("Rijksdriehoek coordinaten gedetecteerd, worden omgezet naar WGS84"),o=!0,s=s.map(c=>{if(!c.geometry)return c;const h=sz(c.geometry.coordinates,zbe);return{...c,geometry:{...c.geometry,coordinates:h}}}),a="WGS84");const l=[...new Set(s.filter(c=>c.geometry).map(c=>c.geometry.type))];return{success:!0,features:{type:"FeatureCollection",features:s},errors:e,warnings:t,metadata:{featureCount:s.length,geometryTypes:l,coordinateSystem:a,transformed:o}}}catch(r){return e.push(`Fout bij parsen: ${r instanceof Error?r.message:"Onbekende fout"}`),{success:!1,features:{type:"FeatureCollection",features:[]},errors:e,warnings:t,metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}}}}async function Wbe(n){const e=[],t=[];try{const r=await n.text(),s=new Hpe({extractStyles:!1}).readFeatures(r,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"});s.length===0&&t.push("Geen features gevonden in KML bestand");const l=new IE().writeFeaturesObject(s,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"}).features.map((h,g)=>{const m={...h.properties},y=m.name||m.Name||`Feature ${g+1}`,_=m.description||m.Description||"";return{type:"Feature",geometry:h.geometry,properties:{...m,name:y,description:_}}}),c=[...new Set(l.filter(h=>h.geometry).map(h=>h.geometry.type))];return{success:!0,features:{type:"FeatureCollection",features:l},errors:e,warnings:t,metadata:{featureCount:l.length,geometryTypes:c,coordinateSystem:"WGS84",transformed:!1}}}catch(r){return e.push(`Fout bij parsen KML: ${r instanceof Error?r.message:"Onbekende fout"}`),{success:!1,features:{type:"FeatureCollection",features:[]},errors:e,warnings:t,metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}}}}async function Hbe(n){const e=[],t=[];try{const r=await n.text(),s=new ape().readFeatures(r,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"});s.length===0&&t.push("Geen features gevonden in GPX bestand");const l=new IE().writeFeaturesObject(s,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"}).features.map((h,g)=>{const m={...h.properties},y=m.name||m.Name||`Waypoint ${g+1}`,_=m.desc||m.description||"",x=m.time||null,w=m.ele||null;return{type:"Feature",geometry:h.geometry,properties:{...m,name:y,description:_,time:x,elevation:w}}}),c=[...new Set(l.filter(h=>h.geometry).map(h=>h.geometry.type))];return c.includes("LineString")&&t.push("GPX track routes worden als lijnen weergegeven"),{success:!0,features:{type:"FeatureCollection",features:l},errors:e,warnings:t,metadata:{featureCount:l.length,geometryTypes:c,coordinateSystem:"WGS84",transformed:!1}}}catch(r){return e.push(`Fout bij parsen GPX: ${r instanceof Error?r.message:"Onbekende fout"}`),{success:!1,features:{type:"FeatureCollection",features:[]},errors:e,warnings:t,metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}}}}function AC(n){switch(n.split(".").pop()?.toLowerCase()){case"geojson":case"json":return"geojson";case"kml":case"kmz":return"kml";case"gpx":return"gpx";default:return"unsupported"}}function Kbe(){return".geojson,.json,.kml,.gpx"}function kC(){return"GeoJSON, KML (Google My Maps), GPX"}async function Xbe(n){switch(AC(n.name)){case"geojson":return $be(n);case"kml":return Wbe(n);case"gpx":return Hbe(n);case"unsupported":default:return{success:!1,features:{type:"FeatureCollection",features:[]},errors:[`Niet-ondersteund bestandsformaat: ${n.name}. Ondersteunde formaten: ${kC()}`],warnings:[],metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}}}}function qbe(n){return n.size>10485760?{valid:!1,error:`Bestand te groot (${(n.size/1024/1024).toFixed(1)} MB). Maximum is 10 MB.`}:AC(n.name)==="unsupported"?{valid:!1,error:`Niet-ondersteund bestandsformaat. Ondersteunde formaten: ${kC()}`}:n.name.toLowerCase().endsWith(".kmz")?{valid:!1,error:"KMZ bestanden worden nog niet ondersteund. Pak het bestand uit en importeer het .kml bestand."}:{valid:!0}}function Ybe({isOpen:n,onClose:e}){const t=W1(A=>A.addLayer),r=H.useRef(null),[i,s]=H.useState("idle"),[a,o]=H.useState(null),[l,c]=H.useState(null),[h,g]=H.useState(""),[m,y]=H.useState(null),[_,x]=H.useState(!1),w=H.useCallback(()=>{s("idle"),o(null),c(null),g(""),y(null),r.current&&(r.current.value="")},[]),b=H.useCallback(()=>{w(),e()},[w,e]),T=H.useCallback(async A=>{const P=qbe(A);if(!P.valid){y(P.error||"Ongeldig bestand"),s("error");return}o(A),s("parsing"),y(null);const D=A.name.replace(/\.[^/.]+$/,"");g(D);try{const N=await Xbe(A);if(!N.success){y(N.errors.join(`
`)),s("error");return}if(N.features.features.length===0){y("Geen features gevonden in het bestand"),s("error");return}c(N),s("preview")}catch(N){y(N instanceof Error?N.message:"Onbekende fout bij parsen"),s("error")}},[]),k=H.useCallback(A=>{const P=A.target.files?.[0];P&&T(P)},[T]),L=H.useCallback(A=>{A.preventDefault(),x(!0)},[]),O=H.useCallback(A=>{A.preventDefault(),x(!1)},[]),B=H.useCallback(A=>{A.preventDefault(),x(!1);const P=A.dataTransfer.files?.[0];P&&T(P)},[T]),R=H.useCallback(()=>{if(!l||!h.trim())return;const A=a?AC(a.name):"geojson";t({name:h.trim(),type:A==="unsupported"?"geojson":A,features:l.features,visible:!0,opacity:1,color:"",sourceFileName:a?.name||"unknown"}),b()},[l,h,a,t,b]);return f.jsx(An,{children:n&&f.jsxs(f.Fragment,{children:[f.jsx(wt.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:b}),f.jsxs(wt.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-md mx-auto my-auto max-h-[80vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[f.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-purple-500 to-purple-600 text-white",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(Z1,{size:18}),f.jsx("span",{className:"font-medium",children:"Laag Importeren"})]}),f.jsx("button",{onClick:b,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none",children:f.jsx(Sr,{size:18})})]}),f.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[i==="idle"&&f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${_?"border-purple-500 bg-purple-50":"border-gray-300 hover:border-gray-400"}`,onDragOver:L,onDragLeave:O,onDrop:B,children:[f.jsx(LI,{size:40,className:"mx-auto text-gray-400 mb-3"}),f.jsx("p",{className:"text-gray-600 mb-2",children:"Sleep een bestand hierheen"}),f.jsx("p",{className:"text-gray-400 text-sm mb-4",children:"of"}),f.jsx("button",{onClick:()=>r.current?.click(),className:"px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors border-0 outline-none",children:"Bestand kiezen"}),f.jsx("input",{ref:r,type:"file",accept:Kbe(),onChange:k,className:"hidden"})]}),f.jsxs("div",{className:"text-xs text-gray-500 text-center",children:[f.jsx("p",{className:"font-medium",children:"Ondersteunde formaten:"}),f.jsx("p",{children:kC()})]})]}),i==="parsing"&&f.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[f.jsx(DI,{size:40,className:"text-purple-500 animate-spin mb-4"}),f.jsx("p",{className:"text-gray-600",children:"Bestand verwerken..."}),f.jsx("p",{className:"text-gray-400 text-sm",children:a?.name})]}),i==="error"&&f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-start gap-3 p-4 bg-red-50 rounded-lg",children:[f.jsx(hV,{size:20,className:"text-red-500 flex-shrink-0 mt-0.5"}),f.jsxs("div",{children:[f.jsx("p",{className:"font-medium text-red-700",children:"Import mislukt"}),f.jsx("p",{className:"text-sm text-red-600 mt-1 whitespace-pre-wrap",children:m})]})]}),f.jsx("button",{onClick:w,className:"w-full px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors border-0 outline-none",children:"Opnieuw proberen"})]}),i==="preview"&&l&&f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-start gap-3 p-3 bg-green-50 rounded-lg",children:[f.jsx(Kle,{size:20,className:"text-green-500 flex-shrink-0 mt-0.5"}),f.jsxs("div",{children:[f.jsx("p",{className:"font-medium text-green-700",children:"Bestand geladen"}),f.jsx("p",{className:"text-sm text-green-600",children:a?.name})]})]}),l.warnings.length>0&&f.jsxs("div",{className:"p-3 bg-amber-50 rounded-lg",children:[f.jsx("p",{className:"font-medium text-amber-700 text-sm",children:"Let op:"}),f.jsx("ul",{className:"text-sm text-amber-600 mt-1 list-disc list-inside",children:l.warnings.map((A,P)=>f.jsx("li",{children:A},P))})]}),f.jsx("div",{className:"p-3 bg-gray-50 rounded-lg text-sm",children:f.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[f.jsxs("div",{children:[f.jsx("span",{className:"text-gray-500",children:"Features:"}),f.jsx("span",{className:"ml-2 font-medium",children:l.metadata.featureCount})]}),f.jsxs("div",{children:[f.jsx("span",{className:"text-gray-500",children:"Types:"}),f.jsx("span",{className:"ml-2 font-medium",children:l.metadata.geometryTypes.join(", ")||"-"})]})]})}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Naam van de laag"}),f.jsx("input",{type:"text",value:h,onChange:A=>g(A.target.value),placeholder:"Bijv. Mijn locaties",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]})]}),i==="preview"&&f.jsxs("div",{className:"px-4 py-3 border-t border-gray-100 flex gap-2",children:[f.jsx("button",{onClick:w,className:"flex-1 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors border-0 outline-none",children:"Annuleren"}),f.jsx("button",{onClick:R,disabled:!h.trim(),className:"flex-1 px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors border-0 outline-none disabled:opacity-50 disabled:cursor-not-allowed",children:"Importeren"})]})]})]})})}function Zbe(){const{user:n,loading:e,error:t,signInWithGoogle:r,logout:i,initAuth:s}=_E();return H.useEffect(()=>{s()},[s]),e?f.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-white rounded-lg text-gray-500",children:[f.jsx(hc,{size:16,className:"animate-pulse"}),f.jsx("span",{className:"text-sm",children:"Laden..."})]}):n?f.jsxs("div",{className:"flex items-center gap-3 px-3 py-2.5 bg-green-50 rounded-lg",children:[n.photoURL?f.jsx("img",{src:n.photoURL,alt:n.displayName||"User",className:"w-8 h-8 rounded-full border-2 border-green-200",referrerPolicy:"no-referrer"}):f.jsx("div",{className:"w-8 h-8 rounded-full bg-green-200 flex items-center justify-center",children:f.jsx(VI,{size:16,className:"text-green-600"})}),f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsx("div",{className:"text-sm font-medium text-green-800 truncate",children:n.displayName||n.email}),f.jsxs("div",{className:"text-xs text-green-600 flex items-center gap-1",children:[f.jsx(hc,{size:12}),"Cloud sync actief"]})]}),f.jsx("button",{onClick:i,className:"p-1.5 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none bg-transparent",title:"Uitloggen",children:f.jsx(jI,{size:16})})]}):f.jsxs("div",{className:"space-y-2",children:[f.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-gray-50 rounded-lg text-gray-500",children:[f.jsx(ece,{size:16}),f.jsx("span",{className:"text-sm",children:"Alleen lokale opslag"})]}),f.jsxs("button",{onClick:r,className:"w-full flex items-center justify-center gap-2 px-3 py-2 bg-white hover:bg-blue-50 rounded-lg transition-colors border-0 outline-none",children:[f.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",children:[f.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),f.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),f.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),f.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),f.jsx("span",{className:"text-sm text-gray-700",children:"Inloggen met Google"})]}),t&&f.jsx("div",{className:"px-3 py-2 bg-red-50 text-red-700 text-xs rounded-lg",children:t})]})}const Jbe="https://forms.gle/R5LCk11Bzu5XrkBj8";function Qbe(){const{settingsPanelOpen:n,toggleSettingsPanel:e,vondstDashboardOpen:t,toggleVondstDashboard:r,openLayerManagerModal:i}=ur(),s=dn(),{presets:a,createPreset:o,deletePreset:l,updatePreset:c}=C9(),h=ul(J=>J.vondsten),g=W1(J=>J.layers),{layers:m,updateLayer:y}=Hi(),{devMode:_,setDevMode:x,tier:w}=Zk(),[b,T]=H.useState(""),[k,L]=H.useState(!1),[O,B]=H.useState(!1),[R,A]=H.useState(null),[P,D]=H.useState(""),[N,G]=H.useState(null),[j,ve]=H.useState(""),[ce,je]=H.useState("algemeen"),Pe=14*s.fontScale/100,ue=()=>{b.trim()&&(o(b.trim(),"Layers"),T(""),L(!1))},Ne=(J,te)=>{A(J),D(te)},be=J=>{P.trim()&&(c(J,{name:P.trim()}),console.log(` Preset hernoemd naar "${P.trim()}"`)),A(null),D("")},ie=()=>{A(null),D("")},V=[{id:"algemeen",label:"Algemeen",icon:f.jsx(Pue,{size:14})},{id:"lagen",label:"Lagen",icon:f.jsx(Va,{size:14})},{id:"vondsten",label:"Vondsten",icon:f.jsx(pa,{size:14})}];return f.jsxs(f.Fragment,{children:[f.jsx(An,{children:n&&f.jsxs(f.Fragment,{children:[f.jsx(wt.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),f.jsxs(wt.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-sm mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[f.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-blue-500",style:{fontSize:`${Pe}px`},children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(kR,{size:18,className:"text-white"}),f.jsx("span",{className:"font-medium text-white",children:"Instellingen"})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[s.showFontSliders&&f.jsxs(f.Fragment,{children:[f.jsx("span",{className:"text-[10px] text-blue-200",children:"T"}),f.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:s.fontScale,onInput:J=>{s.setFontScale(parseInt(J.target.value))},onChange:J=>s.setFontScale(parseInt(J.target.value)),className:"w-20 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${s.fontScale}%`}),f.jsx("span",{className:"text-xs text-blue-200",children:"T"})]}),f.jsx("button",{onClick:e,className:"p-1 rounded bg-blue-400/50 hover:bg-blue-400 transition-colors border-0 outline-none ml-1",children:f.jsx(Sr,{size:18,className:"text-white",strokeWidth:2.5})})]})]}),f.jsx("div",{className:"flex border-b border-gray-200",children:V.map(J=>f.jsxs("button",{onClick:()=>je(J.id),className:`flex-1 flex items-center justify-center gap-1.5 px-3 py-2.5 text-sm font-medium transition-colors border-0 outline-none ${ce===J.id?"text-blue-600 border-b-2 border-blue-600 bg-blue-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[J.icon,J.label]},J.id))}),f.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-5",style:{fontSize:`${Pe}px`},children:[ce==="algemeen"&&f.jsxs(f.Fragment,{children:[f.jsx(Wo,{title:"Account",icon:f.jsx(VI,{size:16}),children:f.jsx(Zbe,{})}),f.jsxs(Wo,{title:"Kaart",icon:f.jsx(FI,{size:16}),children:[f.jsx(eTe,{label:"Standaard achtergrond",children:f.jsxs("select",{value:s.defaultBackground,onChange:J=>s.setDefaultBackground(J.target.value),className:"px-2 py-1 bg-gray-100 rounded border-0 outline-none",style:{fontSize:"0.9em"},children:[f.jsx("option",{value:"CartoDB (licht)",children:"Licht"}),f.jsx("option",{value:"OpenStreetMap",children:"OSM"}),f.jsx("option",{value:"Luchtfoto",children:"Luchtfoto"})]})}),f.jsx(bh,{label:"Schaalbalk tonen",checked:s.showScaleBar,onChange:s.setShowScaleBar})]}),f.jsxs(Wo,{title:"GPS",icon:f.jsx(Y1,{size:16}),children:[f.jsx(bh,{label:"GPS aan bij start",checked:s.gpsAutoStart,onChange:s.setGpsAutoStart}),f.jsx(bh,{label:"Nauwkeurigheidscirkel",checked:s.showAccuracyCircle,onChange:s.setShowAccuracyCircle})]}),f.jsxs(Wo,{title:"Feedback",icon:f.jsx(Mue,{size:16}),children:[f.jsx(bh,{label:"Trillen bij acties",checked:s.hapticFeedback,onChange:s.setHapticFeedback}),f.jsx(bh,{label:"Spraakfeedback vondsten",checked:s.voiceFeedbackEnabled,onChange:s.setVoiceFeedbackEnabled}),s.voiceFeedbackEnabled&&f.jsxs("p",{className:"text-gray-500 mt-1",style:{fontSize:"0.75em"},children:[f.jsx(the,{size:12,className:"inline mr-1"}),"Spreekt vondst info uit bij toevoegen"]})]}),f.jsxs(Wo,{title:"Weer",icon:f.jsx(hc,{size:16}),children:[f.jsx(bh,{label:"Weerwidget tonen",checked:s.showWeatherButton,onChange:s.setShowWeatherButton}),f.jsx("p",{className:"text-gray-500 mt-1",style:{fontSize:"0.75em"},children:"Actueel weer, voorspelling en buienradar"})]}),f.jsxs(Wo,{title:"Development",icon:f.jsx(ace,{size:16}),children:[f.jsx(bh,{label:"Dev Mode (alles ontgrendeld)",checked:_,onChange:x}),f.jsxs("p",{className:"text-gray-500 mt-1",style:{fontSize:"0.75em"},children:["Huidige tier: ",f.jsx("span",{className:"font-medium text-blue-600",children:w}),_&&f.jsx("span",{className:"text-green-600",children:" (alle lagen ontgrendeld)"})]})]})]}),ce==="lagen"&&f.jsxs(f.Fragment,{children:[f.jsx(Wo,{title:"Mijn lagen",icon:f.jsx(Va,{size:16}),isOwn:!0,children:f.jsxs("div",{className:"space-y-1",children:[m.filter(J=>!J.archived).length===0?f.jsx("p",{className:"text-gray-500 py-1",style:{fontSize:"0.75em"},children:"Nog geen eigen lagen aangemaakt."}):m.filter(J=>!J.archived).map(J=>f.jsx("div",{className:"flex items-center gap-2 py-1.5 px-2 hover:bg-gray-50 rounded",children:N===J.id?f.jsx("input",{type:"text",value:j,onChange:te=>ve(te.target.value),onKeyDown:te=>{te.key==="Enter"?(j.trim()&&y(J.id,{name:j.trim()}),G(null)):te.key==="Escape"&&G(null)},onBlur:()=>{j.trim()&&y(J.id,{name:j.trim()}),G(null)},autoFocus:!0,className:"flex-1 px-1.5 py-0.5 text-sm bg-orange-50 rounded outline-none focus:ring-1 focus:ring-orange-400"}):f.jsxs(f.Fragment,{children:[f.jsx("span",{className:"flex-1 text-sm text-gray-700 truncate",children:J.name}),f.jsxs("span",{className:"text-xs text-gray-400",children:[J.points.length," punten"]}),f.jsx("button",{onClick:()=>{G(J.id),ve(J.name)},className:"p-1 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none bg-transparent",title:"Naam bewerken",children:f.jsx(eg,{size:12})})]})},J.id)),f.jsxs("button",{onClick:()=>{i(),e()},className:"flex items-center gap-2 mt-2 px-2 py-1.5 text-orange-600 hover:bg-orange-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[f.jsx(kR,{size:14}),f.jsx("span",{children:"Lagen beheren"})]})]})}),f.jsx(Wo,{title:"Lagen importeren",icon:f.jsx(Z1,{size:16}),children:f.jsxs("div",{className:"space-y-1",children:[g.length>0&&f.jsxs(f.Fragment,{children:[g.map(J=>f.jsx(EV,{layer:J},J.id)),f.jsx("div",{className:"border-t border-gray-100 my-2"})]}),f.jsxs("button",{onClick:()=>B(!0),className:"flex items-center gap-2 px-2 py-1.5 text-cyan-600 hover:bg-cyan-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[f.jsx(Wa,{size:14}),f.jsx("span",{children:"Nieuwe laag importeren"})]}),f.jsx("p",{className:"text-gray-400 mt-1",style:{fontSize:"0.7em"},children:"GeoJSON, KML (Google My Maps), GPX"})]})}),f.jsx(Wo,{title:"Presets",icon:f.jsx(Va,{size:16}),children:f.jsxs("div",{className:"space-y-2",children:[a.map(J=>f.jsx("div",{className:"flex items-center justify-between py-1",children:R===J.id?f.jsxs("div",{className:"flex-1 flex items-center gap-1",children:[f.jsx("input",{type:"text",value:P,onChange:te=>D(te.target.value),onKeyDown:te=>{te.key==="Enter"&&be(J.id),te.key==="Escape"&&ie()},className:"flex-1 px-2 py-0.5 bg-blue-50 rounded border border-blue-300 outline-none",style:{fontSize:"0.9em"},autoFocus:!0}),f.jsx("button",{onClick:()=>be(J.id),className:"px-2 py-0.5 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors border-0 outline-none",style:{fontSize:"0.7em"},children:"OK"}),f.jsx("button",{onClick:ie,className:"px-2 py-0.5 bg-gray-200 text-gray-600 rounded hover:bg-gray-300 transition-colors border-0 outline-none",style:{fontSize:"0.7em"},children:""})]}):f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsxs("span",{className:"text-gray-600",style:{fontSize:"0.9em"},children:[J.name,J.isBuiltIn&&f.jsx("span",{className:"ml-1 text-gray-400",style:{fontSize:"0.7em"},children:"(standaard)"})]}),f.jsxs("span",{className:"ml-1 text-gray-400",style:{fontSize:"0.7em"},children:["(",J.layers.length," lagen)"]})]}),!J.isBuiltIn&&f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("button",{onClick:()=>Ne(J.id,J.name),className:"p-1 text-blue-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none",title:"Naam wijzigen",children:f.jsx(eg,{size:14})}),f.jsx("button",{onClick:()=>l(J.id),className:"p-1 text-red-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors border-0 outline-none",title:"Verwijderen",children:f.jsx(_c,{size:14})})]})]})},J.id)),k?f.jsxs("div",{className:"flex gap-2 mt-2",children:[f.jsx("input",{type:"text",value:b,onChange:J=>T(J.target.value),placeholder:"Naam nieuwe preset",className:"flex-1 px-2 py-1 bg-gray-100 rounded border-0 outline-none",style:{fontSize:"0.9em"},onKeyDown:J=>J.key==="Enter"&&ue(),autoFocus:!0}),f.jsx("button",{onClick:ue,className:"px-2 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors border-0 outline-none",style:{fontSize:"0.75em"},children:"Opslaan"}),f.jsx("button",{onClick:()=>L(!1),className:"px-2 py-1 bg-gray-200 text-gray-600 rounded hover:bg-gray-300 transition-colors border-0 outline-none",style:{fontSize:"0.75em"},children:"Annuleren"})]}):f.jsxs("button",{onClick:()=>L(!0),className:"flex items-center gap-2 mt-2 px-2 py-1.5 text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[f.jsx(Wa,{size:14}),f.jsx("span",{children:"Huidige lagen als preset opslaan"})]})]})})]}),ce==="vondsten"&&f.jsx(f.Fragment,{children:f.jsxs(Wo,{title:"Vondsten",icon:f.jsx(pa,{size:16}),isOwn:!0,children:[f.jsx("p",{className:"text-gray-500 py-1",style:{fontSize:"0.75em"},children:"Vondsten worden altijd lokaal op dit apparaat opgeslagen."}),f.jsxs("button",{onClick:r,className:"flex items-center gap-2 mt-2 px-2 py-1.5 text-orange-600 hover:bg-orange-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[f.jsx(cV,{size:14}),f.jsxs("span",{children:["Dashboard (",h.length," vondsten)"]})]}),f.jsx(tTe,{})]})})]}),f.jsxs("div",{className:"px-4 py-3 border-t border-gray-100 space-y-2",style:{fontSize:`${Pe}px`},children:[f.jsxs("a",{href:Jbe,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 w-full px-3 py-2 text-orange-600 hover:bg-orange-50 rounded-lg transition-colors border-0 outline-none",style:{fontSize:"0.9em"},children:[f.jsx(lV,{size:16}),f.jsx("span",{children:"Meld een bug"})]}),f.jsxs("button",{onClick:Obe,className:"flex items-center justify-center gap-2 w-full px-3 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none",style:{fontSize:"0.9em"},children:[f.jsx(jI,{size:16}),f.jsx("span",{children:"Uitloggen"})]}),f.jsx("p",{className:"text-gray-400 text-center",style:{fontSize:"0.75em"},children:"Instellingen worden lokaal opgeslagen"})]})]})]})}),f.jsx(Dbe,{isOpen:t,onClose:r}),f.jsx(Ybe,{isOpen:O,onClose:()=>B(!1)})]})}function Wo({title:n,icon:e,children:t,isOwn:r}){return f.jsxs("section",{children:[f.jsxs("div",{className:"flex items-center gap-2 mb-2 pb-1 border-b border-gray-100",children:[f.jsx("span",{className:r?"text-orange-600":"text-blue-600",children:e}),f.jsx("span",{className:`font-medium ${r?"text-orange-600":"text-gray-800"}`,style:{fontSize:"1em"},children:n})]}),f.jsx("div",{className:"space-y-2",children:t})]})}function eTe({label:n,children:e}){return f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("span",{className:"text-gray-600",style:{fontSize:"0.9em"},children:n}),e]})}function bh({label:n,checked:e,onChange:t}){return f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("span",{className:"text-gray-600",style:{fontSize:"0.9em"},children:n}),f.jsx("button",{onClick:()=>t(!e),className:`w-10 h-5 rounded-full transition-all border-0 outline-none relative ${e?"bg-gradient-to-r from-blue-500 to-blue-600":"bg-gray-300"}`,children:f.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white shadow-sm transition-all ${e?"left-[22px]":"left-0.5"}`})})]})}function tTe(){const[n,e]=H.useState(!1),{vondsten:t,exportAsGeoJSON:r,exportAsCSV:i,exportAsExcel:s,exportAsGPX:a,exportAsKML:o}=ul(),l=[{label:"Excel (.xlsx)",action:s,desc:"Spreadsheet"},{label:"CSV",action:i,desc:"Comma-separated"},{label:"GeoJSON",action:r,desc:"GIS software"},{label:"GPX",action:a,desc:"GPS apparaten"},{label:"KML",action:o,desc:"Google Earth"}],c=h=>{h(),e(!1)};return t.length===0?f.jsxs("div",{className:"flex items-center gap-2 mt-2 px-2 py-1.5 text-gray-400 bg-gray-100 rounded w-full cursor-not-allowed",style:{fontSize:"0.9em"},children:[f.jsx(Fv,{size:14}),f.jsx("span",{children:"Geen vondsten om te exporteren"})]}):f.jsxs("div",{className:"relative mt-2",children:[f.jsxs("button",{onClick:()=>e(!n),className:"flex items-center justify-between gap-2 px-2 py-1.5 text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(Fv,{size:14}),f.jsxs("span",{children:["Exporteer vondsten (",t.length,")"]})]}),f.jsx("span",{style:{fontSize:"0.8em"},children:""})]}),n&&f.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-200 rounded-lg shadow-lg z-10 overflow-hidden",children:l.map((h,g)=>f.jsxs("button",{onClick:()=>c(h.action),className:"w-full px-3 py-2 text-left hover:bg-blue-50 transition-colors border-0 outline-none flex justify-between items-center",style:{fontSize:"0.9em"},children:[f.jsx("span",{className:"text-gray-700",children:h.label}),f.jsx("span",{className:"text-gray-400",style:{fontSize:"0.8em"},children:h.desc})]},g))})]})}const pw="2.30.93";function nTe({size:n=18}){return f.jsxs("svg",{viewBox:"0 0 24 24",width:n,height:n,children:[f.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),f.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),f.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),f.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]})}function rTe(){const[n,e]=H.useState(!1),{user:t,loading:r,signInWithGoogle:i,logout:s}=_E(),{toggleInfoPanel:a,toggleSettingsPanel:o,toggleMonumentSearch:l}=ur(),c=dn(j=>j.menuFontScale),h=dn(j=>j.setMenuFontScale),g=dn(j=>j.showFontSliders),m=dn(j=>j.setShowFontSliders),y=dn(j=>j.showVondstButton),_=dn(j=>j.setShowVondstButton),x=dn(j=>j.showRouteRecordButton),w=dn(j=>j.setShowRouteRecordButton),b=dn(j=>j.showCustomPointLayers),T=dn(j=>j.setShowCustomPointLayers),k=dn(j=>j.showWeatherButton),L=dn(j=>j.setShowWeatherButton),O={top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"},B=()=>e(!1),R=()=>{B(),a()},A=()=>{B(),o()},P=()=>{B(),l()},D=()=>{B(),i()},N=()=>{B(),s()},G=13*c/100;return f.jsxs(f.Fragment,{children:[f.jsx(wt.button,{className:`fixed right-2 z-[800] w-11 h-11 flex items-center justify-center rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm ${n?"bg-blue-500 hover:bg-blue-600":"bg-white/90 hover:bg-white"}`,style:O,onClick:()=>e(!n),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Menu",children:n?f.jsx(Sr,{size:22,className:"text-white"}):f.jsx(qce,{size:22,className:"text-gray-600"})}),f.jsx(An,{children:n&&f.jsxs(f.Fragment,{children:[f.jsx(wt.div,{className:"fixed inset-0 z-[799]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:B}),f.jsxs(wt.div,{initial:{opacity:0,y:-8,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-8,scale:.95},transition:{duration:.15},className:"fixed right-2 z-[801] w-64 bg-white rounded-xl shadow-lg overflow-hidden flex flex-col",style:{top:"calc(max(0.5rem, env(safe-area-inset-top, 0.5rem)) + 52px)",fontSize:`${G}px`},children:[f.jsxs("div",{className:"flex items-center justify-between gap-2 px-3 py-1.5 bg-blue-500",children:[f.jsx("span",{className:"font-medium text-white",style:{fontSize:`${G}px`},children:"Menu"}),g&&f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("span",{className:"text-[9px] text-blue-200",children:"T"}),f.jsx("input",{type:"range",min:"80",max:"130",step:"10",value:c,onInput:j=>h(parseInt(j.target.value)),onChange:j=>h(parseInt(j.target.value)),className:"w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${c}%`}),f.jsx("span",{className:"text-[11px] text-blue-200",children:"T"})]})]}),r?f.jsx("div",{className:"px-3 py-4 flex items-center justify-center",children:f.jsx("div",{className:"w-5 h-5 border-2 border-gray-300 border-t-blue-500 rounded-full animate-spin"})}):t?f.jsx("div",{className:"px-3 py-3 border-b border-gray-100",children:f.jsxs("div",{className:"flex items-center gap-3",children:[t.photoURL?f.jsx("img",{src:t.photoURL,alt:t.displayName||"User",className:"w-8 h-8 rounded-full",referrerPolicy:"no-referrer"}):f.jsx("div",{className:"w-8 h-8 rounded-full bg-green-500 flex items-center justify-center",children:f.jsx(VI,{size:16,className:"text-white"})}),f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsx("div",{className:"font-medium text-gray-800 truncate",style:{fontSize:"0.85em"},children:t.displayName||"Gebruiker"}),f.jsx("div",{className:"text-green-600",style:{fontSize:"0.7em"},children:"Cloud sync actief"})]}),f.jsx("button",{onClick:N,className:"p-1.5 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none bg-transparent",title:"Uitloggen",children:f.jsx(jI,{size:16})})]})}):f.jsxs("button",{onClick:D,className:"w-full px-3 py-3 flex items-center gap-3 hover:bg-blue-50 transition-colors border-0 outline-none bg-transparent",children:[f.jsx(nTe,{size:18}),f.jsx("span",{className:"text-gray-700",style:{fontSize:"0.9em"},children:"Inloggen met Google"})]}),f.jsxs("div",{className:"py-1",children:[f.jsxs("button",{onClick:R,className:"w-full px-3 py-2.5 text-left flex items-center gap-3 border-0 outline-none bg-transparent transition-colors text-gray-700 hover:bg-blue-50",style:{fontSize:"0.95em"},children:[f.jsx(OI,{size:18,className:"text-blue-500"}),f.jsx("span",{children:"Info & handleiding"})]}),f.jsxs("button",{onClick:P,className:"w-full px-3 py-2.5 text-left flex items-center gap-3 border-0 outline-none bg-transparent transition-colors text-gray-700 hover:bg-purple-50",style:{fontSize:"0.95em"},children:[f.jsx(fV,{size:18,className:"text-purple-500"}),f.jsx("span",{children:"Zoek in monumenten"})]})]}),f.jsxs("div",{className:"py-1 border-t border-gray-100",children:[f.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx(pa,{size:18,className:"text-orange-500"}),f.jsx("span",{className:"text-gray-700",style:{fontSize:"0.9em"},children:"Vondst knop"})]}),f.jsx("button",{onClick:()=>_(!y),className:`w-10 h-5 rounded-full transition-all border-0 outline-none relative ${y?"bg-gradient-to-r from-orange-500 to-orange-600":"bg-gray-300"}`,children:f.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white shadow-sm transition-all ${y?"left-[22px]":"left-0.5"}`})})]}),f.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx(Gv,{size:18,className:"text-green-500"}),f.jsx("span",{className:"text-gray-700",style:{fontSize:"0.9em"},children:"Route knop"})]}),f.jsx("button",{onClick:()=>w(!x),className:`w-10 h-5 rounded-full transition-all border-0 outline-none relative ${x?"bg-gradient-to-r from-green-500 to-green-600":"bg-gray-300"}`,children:f.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white shadow-sm transition-all ${x?"left-[22px]":"left-0.5"}`})})]}),f.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx(hc,{size:18,className:"text-cyan-500"}),f.jsx("span",{className:"text-gray-700",style:{fontSize:"0.9em"},children:"Weerwidget"})]}),f.jsx("button",{onClick:()=>L(!k),className:`w-10 h-5 rounded-full transition-all border-0 outline-none relative ${k?"bg-gradient-to-r from-cyan-500 to-cyan-600":"bg-gray-300"}`,children:f.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white shadow-sm transition-all ${k?"left-[22px]":"left-0.5"}`})})]}),f.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx(Va,{size:18,className:"text-amber-500"}),f.jsx("span",{className:"text-gray-700",style:{fontSize:"0.9em"},children:"Mijn lagen"})]}),f.jsx("button",{onClick:()=>T(!b),className:`w-10 h-5 rounded-full transition-all border-0 outline-none relative ${b?"bg-gradient-to-r from-amber-500 to-amber-600":"bg-gray-300"}`,children:f.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white shadow-sm transition-all ${b?"left-[22px]":"left-0.5"}`})})]}),f.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx(vV,{size:18,className:"text-purple-500"}),f.jsx("span",{className:"text-gray-700",style:{fontSize:"0.9em"},children:"Tekstgrootte"})]}),f.jsx("button",{onClick:()=>m(!g),className:`w-10 h-5 rounded-full transition-all border-0 outline-none relative ${g?"bg-gradient-to-r from-purple-500 to-purple-600":"bg-gray-300"}`,children:f.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white shadow-sm transition-all ${g?"left-[22px]":"left-0.5"}`})})]})]}),f.jsx("div",{className:"mt-auto border-t border-gray-100",children:f.jsxs("button",{onClick:A,className:"w-full px-3 py-2.5 text-left flex items-center gap-3 border-0 outline-none bg-transparent transition-colors text-gray-700 hover:bg-gray-50",style:{fontSize:"0.95em"},children:[f.jsx(kR,{size:18,className:"text-gray-500"}),f.jsx("span",{children:"Instellingen"})]})}),f.jsxs("div",{className:"px-3 py-1.5 bg-gray-50 text-center text-gray-400",style:{fontSize:"0.65em"},children:["DetectorApp NL v",pw]})]})]})})]})}const iTe="https://forms.gle/R5LCk11Bzu5XrkBj8";function sTe(){const{infoPanelOpen:n,toggleInfoPanel:e}=ur(),[t,r]=H.useState("info"),i=[{id:"info",label:"Info",icon:f.jsx(OI,{size:14})},{id:"functies",label:"Functies",icon:f.jsx(LI,{size:14})},{id:"handleiding",label:"Handleiding",icon:f.jsx(Ole,{size:14})}];return f.jsx(An,{children:n&&f.jsxs(f.Fragment,{children:[f.jsx(wt.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),f.jsxs(wt.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[90vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[f.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-blue-500",children:[f.jsxs("span",{className:"font-medium text-white",children:["DetectorApp NL v",pw]}),f.jsx("button",{onClick:e,className:"p-1 rounded bg-blue-400/50 hover:bg-blue-400 transition-colors border-0 outline-none",children:f.jsx(Sr,{size:18,className:"text-white",strokeWidth:2.5})})]}),f.jsx("div",{className:"flex border-b border-gray-200",children:i.map(s=>f.jsxs("button",{onClick:()=>r(s.id),className:`flex-1 flex items-center justify-center gap-1.5 px-3 py-2.5 text-sm font-medium transition-colors border-0 outline-none ${t===s.id?"text-blue-600 border-b-2 border-blue-600 bg-blue-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[s.icon,s.label]},s.id))}),f.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 text-sm",children:[t==="info"&&f.jsx(aTe,{}),t==="functies"&&f.jsx(oTe,{}),t==="handleiding"&&f.jsx(lTe,{}),f.jsxs("section",{className:"pt-2 border-t border-gray-200 space-y-2",children:[f.jsxs("a",{href:iTe,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 w-full px-3 py-2 text-orange-600 hover:bg-orange-50 rounded-lg transition-colors",children:[f.jsx(lV,{size:14}),f.jsx("span",{className:"text-sm",children:"Meld een bug of geef feedback"})]}),f.jsxs("p",{className:"text-xs text-gray-400 text-center",children:["DetectorApp NL v",pw," - Gratis en zonder tracking"]})]})]})]})]})})}function aTe(){return f.jsxs(f.Fragment,{children:[f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Over deze app"}),f.jsx("p",{className:"text-gray-600",children:"DetectorApp NL is d gratis kaartapplicatie voor metaaldetectie, fossielen zoeken en archeologische verkenning in Nederland. Met 70+ kaartlagen, GPS tracking met richtingspijl, eigen lagen, cloud sync en uitgebreid vondstenbeheer."})]}),f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Databronnen & Licenties"}),f.jsxs("ul",{className:"space-y-2 text-gray-600",children:[f.jsxs("li",{children:[f.jsx("strong",{children:"RCE / Cultureelerfgoed.nl"})," (CC0/CC-BY)",f.jsx("br",{}),f.jsx("span",{className:"text-xs",children:"AMK Monumenten, Rijksmonumenten, Werelderfgoed, Paleokaarten, Religieus Erfgoed, Essen, Archeo Onderzoeken"})]}),f.jsxs("li",{children:[f.jsx("strong",{children:"PDOK / Kadaster"})," (CC0/CC-BY)",f.jsx("br",{}),f.jsx("span",{className:"text-xs",children:"Luchtfoto, AHN Hoogtekaarten, IKAW, Bodemkaart, Geomorfologie, Kadastrale Grenzen, Gewaspercelen"})]}),f.jsxs("li",{children:[f.jsx("strong",{children:"OpenStreetMap"})," (ODbL)",f.jsx("br",{}),f.jsx("span",{className:"text-xs",children:"Hunebedden, Grafheuvels, Bunkers, Kastelen, Terpen, Parken, Kringloopwinkels, Musea, Speeltuinen, Strandjes"})]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Itiner-E / Wetenschappelijk"})," (CC BY 4.0)",f.jsx("br",{}),f.jsx("span",{className:"text-xs",children:"Romeinse wegen - Brughmans, Paout, de Soto & Bjerregaard Vahlstrup"})]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Mindat.org"}),f.jsx("br",{}),f.jsx("span",{className:"text-xs",children:"Mineralen hotspots en vindplaatsen"})]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Paleontica / Fossielen data"}),f.jsx("br",{}),f.jsx("span",{className:"text-xs",children:"Fossiel hotspots en vindplaatsen"})]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Map5.nl / Kadaster"}),f.jsx("br",{}),f.jsx("span",{className:"text-xs",children:"Historische kaarten (TMK 1850, Bonnebladen 1900)"})]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Provinciale data"}),f.jsx("br",{}),f.jsx("span",{className:"text-xs",children:"Relictenkaart (Gelderland), Scheepswrakken (Zuid-Holland), Verdronken Dorpen (Zeeland)"})]}),f.jsxs("li",{children:[f.jsx("strong",{children:"UIKAV / Rijkswaterstaat"}),f.jsx("br",{}),f.jsx("span",{className:"text-xs",children:"Uiterwaarden archeologische data, Expert advies, Bufferlagen"})]})]})]}),f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Privacy & Opslag"}),f.jsxs("div",{className:"text-gray-600 space-y-2",children:[f.jsxs("p",{children:[f.jsx("strong",{children:"Volledig anoniem mogelijk:"})," Je kunt deze app gebruiken zonder enige registratie of login. Al je data blijft dan 100% op je eigen apparaat."]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Geen tracking:"})," Deze app verzamelt geen analytics, cookies, gebruiksstatistieken of persoonlijke gegevens. Er is geen server die je gedrag registreert."]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Locatiegegevens:"})," Je GPS-positie wordt alleen gebruikt om je locatie op de kaart te tonen. Deze wordt niet opgeslagen of gedeeld met derden."]})]})]}),f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Google Login - Wat betekent het?"}),f.jsxs("div",{className:"text-gray-600 space-y-2",children:[f.jsx("p",{className:"font-medium text-green-700",children:" Google login is volledig optioneel"}),f.jsx("p",{children:f.jsx("strong",{children:"Wat wordt gesynchroniseerd:"})}),f.jsxs("ul",{className:"list-disc list-inside ml-2 text-xs space-y-1",children:[f.jsx("li",{children:"Je eigen aangemaakte lagen (Mijn Lagen)"}),f.jsx("li",{children:"Je vondsten registraties"}),f.jsx("li",{children:"Je preset-instellingen"})]}),f.jsx("p",{children:f.jsx("strong",{children:"Wat NIET wordt gedeeld:"})}),f.jsxs("ul",{className:"list-disc list-inside ml-2 text-xs space-y-1",children:[f.jsx("li",{children:"Je GPS-locatie wordt niet opgeslagen in de cloud"}),f.jsx("li",{children:"Je zoekgeschiedenis wordt niet bewaard"}),f.jsx("li",{children:"Welke kaartlagen je bekijkt wordt niet geregistreerd"}),f.jsx("li",{children:"Niemand anders kan je data zien - alleen jij"})]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Waarom inloggen?"})," Alleen voor synchronisatie tussen apparaten (telefoon/tablet/PC) en als backup voor je vondsten."]}),f.jsx("p",{className:"text-xs text-gray-500 italic",children:"Tip: Gebruik de app gerust zonder login als je privacy belangrijker vindt dan synchronisatie. Alle functies werken ook offline."})]})]}),f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Zonder login (anoniem)"}),f.jsxs("div",{className:"text-gray-600 space-y-2",children:[f.jsx("p",{className:"font-medium text-blue-700",children:" 95% van de functies werkt zonder login"}),f.jsx("p",{children:f.jsx("strong",{children:"Beschikbaar zonder login:"})}),f.jsxs("ul",{className:"list-disc list-inside ml-2 text-xs space-y-1",children:[f.jsx("li",{children:"Alle 70+ kaartlagen bekijken"}),f.jsx("li",{children:"GPS tracking en navigatie"}),f.jsx("li",{children:"Vondsten registreren (lokaal opgeslagen)"}),f.jsx("li",{children:"Eigen lagen aanmaken (lokaal opgeslagen)"}),f.jsx("li",{children:"Export naar Excel/CSV/GeoJSON/GPX/KML"}),f.jsx("li",{children:"Lagen importeren"}),f.jsx("li",{children:"Alle presets en instellingen"})]}),f.jsx("p",{children:f.jsx("strong",{children:"Alleen met login:"})}),f.jsxs("ul",{className:"list-disc list-inside ml-2 text-xs space-y-1",children:[f.jsx("li",{children:"Synchronisatie tussen apparaten"}),f.jsx("li",{children:"Cloud backup van je vondsten"})]})]})]})]})}function oTe(){return f.jsxs(f.Fragment,{children:[f.jsxs("section",{children:[f.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[f.jsx(FI,{size:16,className:"text-blue-600"}),"Kaartlagen (70+)"]}),f.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[f.jsxs("li",{children:[f.jsx("strong",{children:"Basis:"})," CartoDB, OpenStreetMap, PDOK Luchtfoto"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Historisch:"})," TMK 1850, Bonnebladen 1900"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Hoogtekaarten:"})," AHN4 Hillshade, Multi-Hillshade, Hoogtekaart Kleur, AHN 0.5m"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Archeologie:"})," AMK Monumenten (per periode), Archeo Onderzoeken, IKAW, Essen"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Romeins:"})," Romeinse wegen, Romeinse Forten met historische info, Limesweg"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Prehistorie:"})," Hunebedden, Grafheuvels, Terpen, Paleokaarten (7 periodes)"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Militair:"})," WWII Bunkers, Slagvelden, Vliegvelden, Verdedigingslinies"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Erfgoed:"})," Rijksmonumenten, Kastelen, Runes, Religieus Erfgoed"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Terrein:"})," Veengebieden, Geomorfologie, Bodemkaart"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Percelen:"})," Gewaspercelen (met bouwplantoelichting), Kadastrale Grenzen"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Recreatie:"})," Parken, Musea, Kringloopwinkels, Strandjes, Wandelroutes"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Provinciaal:"})," Relictenkaart, Scheepswrakken, Verdronken Dorpen"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"UIKAV:"})," Uiterwaard data, Expert advies, Vlakken, Punten, Bufferlagen"]})]})]}),f.jsxs("section",{children:[f.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[f.jsx(Ice,{size:16,className:"text-purple-600"}),"Mineralen & Fossielen"]}),f.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[f.jsxs("li",{children:[f.jsx("strong",{children:"Mineralen hotspots:"})," Vindplaatsen uit Mindat.org met mineralenlijst"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Goudrivieren:"})," Bekende locaties voor goud zoeken"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Fossiel hotspots:"})," Vindplaatsen met fossieltypen en periodes"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Premium lagen:"})," Gedetailleerde data (beschikbaar met account)"]})]})]}),f.jsxs("section",{children:[f.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[f.jsx(Sce,{size:16,className:"text-orange-600"}),"Mijn Lagen"]}),f.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[f.jsxs("li",{children:[f.jsx("strong",{children:"Eigen lagen:"})," Maak lagen voor vakantie, projecten, etc."]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Toevoegen:"})," Tik op + in popup om monument/locatie aan laag toe te voegen"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Polygonen:"})," Hele monumentgebieden worden opgeslagen, niet alleen een punt"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Originele info:"})," Popup content blijft behouden"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Kleuren:"})," Elke laag krijgt eigen kleur (aanpasbaar)"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Import:"})," Laad GeoJSON, KML of GPX bestanden"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Export:"})," Exporteer lagen als GeoJSON"]})]})]}),f.jsxs("section",{children:[f.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[f.jsx(hc,{size:16,className:"text-green-600"}),"Google Cloud Sync"]}),f.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[f.jsxs("li",{children:[f.jsx("strong",{children:"Inloggen:"})," Via hamburger menu rechtsboven"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Synchronisatie:"})," Lagen en vondsten automatisch naar cloud"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Meerdere apparaten:"})," Altijd toegang tot je data"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Veilig:"})," Alleen jij hebt toegang tot je gegevens"]})]})]}),f.jsxs("section",{children:[f.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[f.jsx(Y1,{size:16,className:"text-green-600"}),"GPS & Navigatie"]}),f.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[f.jsx("li",{children:"Live GPS tracking met nauwkeurigheidscirkel"}),f.jsx("li",{children:"Richtingspijl draait mee met je telefoon"}),f.jsx("li",{children:"Kaart handmatig draaien + kompasknop naar noorden"}),f.jsx("li",{children:"Schaalbalk onderaan (aan/uit in Instellingen)"}),f.jsx("li",{children:"Open locatie in Google Maps vanuit popup"}),f.jsx("li",{children:"Zoekbalk voor adressen en plaatsen"})]})]}),f.jsxs("section",{children:[f.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[f.jsx(pa,{size:16,className:"text-orange-600"}),"Vondsten"]}),f.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[f.jsx("li",{children:"Toevoegen via GPS locatie, long-press of handmatig"}),f.jsx("li",{children:"Velden: type, materiaal, periode, diepte, conditie, gewicht"}),f.jsx("li",{children:"Foto's toevoegen (link of upload)"}),f.jsx("li",{children:"Export: Excel, CSV, GeoJSON, GPX, KML"}),f.jsx("li",{children:"Dashboard met statistieken"}),f.jsx("li",{children:"Cloud sync met Google account"})]})]}),f.jsxs("section",{children:[f.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[f.jsx(Va,{size:16,className:"text-purple-600"}),"Presets"]}),f.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[f.jsxs("li",{children:[f.jsx("strong",{children:"Standaard:"})," Detectie, Steentijd, Romeins, Middeleeuwen, WOII, Analyse, Fossielen, Mineralen"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Aanpasbaar:"})," Overschrijf preset met huidige lagen (diskette-icoon)"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Eigen presets:"})," Maak nieuwe via Instellingen"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Tekstgrootte:"})," Aanpasbaar per panel via slider"]})]})]}),f.jsxs("section",{children:[f.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[f.jsx(Qce,{size:16,className:"text-cyan-600"}),"Perceelinformatie"]}),f.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[f.jsx("li",{children:"Kadastrale aanduiding (gemeente, sectie, nummer)"}),f.jsx("li",{children:"Oppervlakte in m en hectare"}),f.jsx("li",{children:"Gewas en bouwplan met uitleg"}),f.jsx("li",{children:"Bodemtype met beschrijving"}),f.jsx("li",{children:"AHN hoogte in meters NAP"}),f.jsx("li",{children:"Hoogtekaart per perceel (bergje-icoon)"}),f.jsx("li",{children:"Link naar eigenaar opzoeken (Kadaster)"})]})]}),f.jsxs("section",{children:[f.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[f.jsx(Aue,{size:16,className:"text-red-600"}),"Monumenten & Erfgoed"]}),f.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[f.jsxs("li",{children:[f.jsx("strong",{children:"AMK:"})," Archeologische Monumenten per periode"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Romeinse Forten:"})," Uitgebreide historische info per fort"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Rijksmonumenten:"})," Met bescherming en historie"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Verdedigingswerken:"})," Linies, forten, schansen"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Popup info:"})," Directe uitleg over archeologische waarde"]})]})]})]})}function lTe(){return f.jsxs(f.Fragment,{children:[f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Eerste stappen"}),f.jsxs("ol",{className:"text-gray-600 space-y-2 text-xs list-decimal list-inside",children:[f.jsxs("li",{children:["Tik op de ",f.jsx("strong",{children:"GPS knop"})," (rechtsonder, oranje) om je locatie te zien"]}),f.jsxs("li",{children:["Kies een ",f.jsx("strong",{children:"preset"})," (linksonder, laagjes-icoon) voor een snelle start"]}),f.jsxs("li",{children:["Of open ",f.jsx("strong",{children:"Kaartlagen"})," om individuele lagen aan te zetten"]}),f.jsx("li",{children:"Tik op objecten op de kaart voor gedetailleerde informatie"})]})]}),f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Hamburger Menu"}),f.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[f.jsx("p",{children:"Rechtsboven vind je het menu met:"}),f.jsxs("ul",{className:"list-disc list-inside ml-2 space-y-1",children:[f.jsxs("li",{children:[f.jsx("strong",{children:"Google Login:"})," Synchroniseer je data naar de cloud"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Vondst toevoegen:"})," Registreer een nieuwe vondst"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Info & Handleiding:"})," Dit scherm"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Instellingen:"})," Presets, export, weergave"]})]})]})]}),f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"GPS & Navigatie"}),f.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[f.jsxs("p",{children:[f.jsx("strong",{children:"GPS knop (oranje):"})," Aan/uit toggle voor locatie tracking."]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Richtingspijl:"})," Blauwe pijl toont de richting van je telefoon."]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Kaart draaien:"})," Met twee vingers of via kompas."]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Kompasknop:"})," Verschijnt rechtsboven als kaart gedraaid is. Tik om naar noorden te draaien."]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Google Maps:"})," Vanuit elke popup kun je direct navigeren."]})]})]}),f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Locaties opslaan in Mijn Lagen"}),f.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[f.jsxs("p",{children:[f.jsx("strong",{children:"Stap 1:"})," Tik op een object op de kaart (monument, bunker, etc.)"]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Stap 2:"})," Tik op de ",f.jsx("strong",{children:"oranje +"})," knop in de popup header"]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Stap 3:"})," Kies een bestaande laag of maak een nieuwe aan"]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Resultaat:"})," De locatie inclusief vorm (polygoon) en info wordt opgeslagen!"]}),f.jsx("p",{className:"text-gray-500 italic",children:"Tip: Maak lagen voor vakantiebestemmingen, projecten of interessante locaties."})]})]}),f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Vondst registreren"}),f.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[f.jsxs("p",{children:[f.jsx("strong",{children:"Via GPS:"})," Open menu  Vondst toevoegen. Je locatie wordt automatisch ingevuld."]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Via long-press:"}),' Houd je vinger op de kaart  kies "Vondst toevoegen".']}),f.jsxs("p",{children:[f.jsx("strong",{children:"Handmatig:"}),' In het formulier  "Kies op kaart" voor exacte locatie.']}),f.jsxs("p",{children:[f.jsx("strong",{children:"Foto's:"})," Voeg foto-links toe of upload direct."]})]})]}),f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Presets gebruiken"}),f.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[f.jsxs("p",{children:[f.jsx("strong",{children:"Toepassen:"})," Linksonder  preset kiezen."]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Aanpassen:"})," Zet gewenste lagen aan  tik diskette-icoon naast preset."]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Nieuw maken:"}),' Instellingen  Presets  "Huidige lagen opslaan".']})]})]}),f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Cloud Sync instellen"}),f.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[f.jsxs("p",{children:[f.jsx("strong",{children:"Stap 1:"})," Open hamburger menu rechtsboven"]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Stap 2:"}),' Tik op "Inloggen met Google"']}),f.jsxs("p",{children:[f.jsx("strong",{children:"Stap 3:"})," Kies je Google account"]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Klaar!"})," Je lagen en vondsten worden automatisch gesynchroniseerd."]}),f.jsx("p",{className:"text-gray-500 italic",children:"Je data is veilig en alleen voor jou toegankelijk."})]})]}),f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Lagen importeren"}),f.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[f.jsxs("p",{children:[f.jsx("strong",{children:"Stap 1:"})," Ga naar Instellingen (hamburger menu)"]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Stap 2:"}),' Scroll naar "Lagen importeren"']}),f.jsxs("p",{children:[f.jsx("strong",{children:"Stap 3:"})," Kies een GeoJSON, KML of GPX bestand"]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Resultaat:"})," Nieuwe laag met je geimporteerde data!"]}),f.jsx("p",{className:"text-gray-500 italic",children:"Handig voor routes, waypoints of eigen datasets."})]})]}),f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Tips voor detectie"}),f.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs list-disc list-inside",children:[f.jsxs("li",{children:["Gebruik ",f.jsx("strong",{children:"AHN Hillshade"})," om relif te zien (grafheuvels, wallen)"]}),f.jsxs("li",{children:["Combineer ",f.jsx("strong",{children:"AMK"})," met ",f.jsx("strong",{children:"Gewaspercelen"})," voor slimme zoeklocaties"]}),f.jsxs("li",{children:["Check ",f.jsx("strong",{children:"IKAW"})," voor archeologische verwachting"]}),f.jsxs("li",{children:["Gebruik ",f.jsx("strong",{children:"historische kaarten"})," (TMK 1850) om oude structuren te vinden"]}),f.jsxs("li",{children:["Bekijk ",f.jsx("strong",{children:"Archeo Onderzoeken"})," voor eerdere vondsten in het gebied"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Bodemkaart"})," toont of grond geschikt is (popup legt uit)"]})]})]}),f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Tips voor fossielen"}),f.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs list-disc list-inside",children:[f.jsxs("li",{children:["Zet ",f.jsx("strong",{children:"Fossiel hotspots"})," aan voor bekende vindplaatsen"]}),f.jsxs("li",{children:["Bekijk ",f.jsx("strong",{children:"Paleokaarten"})," voor historische kustlijnen"]}),f.jsxs("li",{children:["Check ",f.jsx("strong",{children:"Geomorfologie"})," voor oude zeebodems en rivieren"]}),f.jsx("li",{children:"Popup toont welke fossielen op elke locatie gevonden zijn"})]})]}),f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Tips voor mineralen"}),f.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs list-disc list-inside",children:[f.jsxs("li",{children:["Zet ",f.jsx("strong",{children:"Mineralen hotspots"})," aan voor vindplaatsen"]}),f.jsxs("li",{children:["Bekijk ",f.jsx("strong",{children:"Goudrivieren"})," voor goudzoekmogelijkheden"]}),f.jsx("li",{children:"Popup toont welke mineralen op elke locatie voorkomen"}),f.jsx("li",{children:"Links naar Mindat.org voor gedetailleerde info"})]})]}),f.jsxs("section",{children:[f.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[f.jsx(Cu,{size:16,className:"text-blue-600"}),"Handige links"]}),f.jsxs("ul",{className:"text-gray-600 space-y-2 text-xs",children:[f.jsxs("li",{children:[f.jsx("a",{href:"https://legendageomorfologie.wur.nl/",target:"_blank",rel:"noopener",className:"text-blue-600 hover:underline font-medium",children:"Geomorfologie legenda (WUR)"}),f.jsx("br",{}),f.jsx("span",{className:"text-gray-500",children:"Uitgebreide uitleg over landvormen"})]}),f.jsxs("li",{children:[f.jsx("a",{href:"https://legenda-bodemkaart.bodemdata.nl/",target:"_blank",rel:"noopener",className:"text-blue-600 hover:underline font-medium",children:"Bodemkaart legenda (BRO)"}),f.jsx("br",{}),f.jsx("span",{className:"text-gray-500",children:"Volledige bodemclassificatie"})]}),f.jsxs("li",{children:[f.jsx("a",{href:"https://www.mindat.org/",target:"_blank",rel:"noopener",className:"text-blue-600 hover:underline font-medium",children:"Mindat.org - Mineralen database"}),f.jsx("br",{}),f.jsx("span",{className:"text-gray-500",children:"Wereldwijde mineralen informatie"})]}),f.jsxs("li",{children:[f.jsx("a",{href:"https://www.cultureelerfgoed.nl/",target:"_blank",rel:"noopener",className:"text-blue-600 hover:underline font-medium",children:"Rijksdienst voor Cultureel Erfgoed"}),f.jsx("br",{}),f.jsx("span",{className:"text-gray-500",children:"Officile monumenten informatie"})]})]})]})]})}function az(n,e,t,r){const s=(r-e)*Math.PI/180,a=(t-n)*Math.PI/180,o=Math.sin(s/2)*Math.sin(s/2)+Math.cos(e*Math.PI/180)*Math.cos(r*Math.PI/180)*Math.sin(a/2)*Math.sin(a/2);return 6371e3*(2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o)))}function Xb(n){let e=0;for(let t=1;t<n.length;t++)e+=az(n[t-1].coordinates[0],n[t-1].coordinates[1],n[t].coordinates[0],n[t].coordinates[1]);return e}const wo=qi()(bo((n,e)=>({state:"idle",currentPoints:[],startTime:null,pauseStartTime:null,totalPausedTime:0,savedRoutes:[],visibleRouteIds:new Set,heatmapEnabled:!1,gridEnabled:!1,gridCenter:null,gridSize:20,gridCount:10,gridColor:"rgba(139, 92, 246, 0.6)",autoPauseEnabled:!1,autoPauseSeconds:120,startRecording:()=>{n({state:"recording",currentPoints:[],startTime:Date.now(),pauseStartTime:null,totalPausedTime:0})},pauseRecording:()=>{const{state:t}=e();t==="recording"&&n({state:"paused",pauseStartTime:Date.now()})},resumeRecording:()=>{const{state:t,pauseStartTime:r,totalPausedTime:i}=e();if(t!=="paused"||!r)return;const s=Date.now()-r;n({state:"recording",pauseStartTime:null,totalPausedTime:i+s})},stopRecording:t=>{const{state:r,currentPoints:i,startTime:s,totalPausedTime:a,pauseStartTime:o}=e();if(r==="idle"||!s||i.length<2)return n({state:"idle",currentPoints:[],startTime:null,pauseStartTime:null,totalPausedTime:0}),null;const l=Date.now();let c=a;o&&(c+=l-o);const h=l-s-c,g=Xb(i),m={id:crypto.randomUUID(),name:t||`Route ${new Date().toLocaleDateString("nl-NL")} ${new Date().toLocaleTimeString("nl-NL",{hour:"2-digit",minute:"2-digit"})}`,points:i,startTime:s,endTime:l,totalDistance:g,totalDuration:h,pausedDuration:c,createdAt:new Date().toISOString()};return n(y=>({state:"idle",currentPoints:[],startTime:null,pauseStartTime:null,totalPausedTime:0,savedRoutes:[m,...y.savedRoutes]})),m},cancelRecording:()=>{n({state:"idle",currentPoints:[],startTime:null,pauseStartTime:null,totalPausedTime:0})},addPoint:(t,r,i)=>{const{state:s,currentPoints:a}=e();if(s!=="recording")return;if(a.length>0){const l=a[a.length-1];if(az(l.coordinates[0],l.coordinates[1],t,r)<2)return}const o={coordinates:[t,r],timestamp:Date.now(),accuracy:i};n({currentPoints:[...a,o]})},deleteRoute:t=>{n(r=>({savedRoutes:r.savedRoutes.filter(i=>i.id!==t)}))},renameRoute:(t,r)=>{n(i=>({savedRoutes:i.savedRoutes.map(s=>s.id===t?{...s,name:r}:s)}))},clearAllRoutes:()=>{n({savedRoutes:[],visibleRouteIds:new Set})},toggleRouteVisibility:t=>{n(r=>{const i=new Set(r.visibleRouteIds);return i.has(t)?i.delete(t):i.add(t),{visibleRouteIds:i}})},showRoute:t=>{n(r=>{const i=new Set(r.visibleRouteIds);return i.add(t),{visibleRouteIds:i}})},hideRoute:t=>{n(r=>{const i=new Set(r.visibleRouteIds);return i.delete(t),{visibleRouteIds:i}})},showAllRoutes:()=>{n(t=>({visibleRouteIds:new Set(t.savedRoutes.map(r=>r.id))}))},hideAllRoutes:()=>{n({visibleRouteIds:new Set})},toggleHeatmap:()=>{n(t=>({heatmapEnabled:!t.heatmapEnabled}))},setHeatmapEnabled:t=>{n({heatmapEnabled:t})},toggleGrid:()=>{n(t=>({gridEnabled:!t.gridEnabled}))},setGridEnabled:t=>{n({gridEnabled:t})},setGridCenter:t=>{n({gridCenter:t})},setGridSize:t=>{n({gridSize:t})},setGridCount:t=>{n({gridCount:t})},setGridColor:t=>{n({gridColor:t})},centerGridOnCurrentLocation:()=>{"geolocation"in navigator&&navigator.geolocation.getCurrentPosition(t=>{n({gridCenter:[t.coords.longitude,t.coords.latitude],gridEnabled:!0})},t=>{console.error("Could not get location:",t)})},setAutoPauseEnabled:t=>{n({autoPauseEnabled:t})},setAutoPauseSeconds:t=>{n({autoPauseSeconds:t})},importRouteFromGPX:(t,r)=>{try{const s=new DOMParser().parseFromString(t,"application/xml");if(s.querySelector("parsererror"))return{success:!1,error:"Ongeldig XML formaat"};const o=s.querySelectorAll("trkpt");if(o.length<2&&s.querySelectorAll("wpt").length<2)return{success:!1,error:"Geen route punten gevonden in GPX bestand"};const l=[];if((o.length>0?o:s.querySelectorAll("wpt")).forEach(w=>{const b=parseFloat(w.getAttribute("lat")||"0"),T=parseFloat(w.getAttribute("lon")||"0"),k=w.querySelector("time"),L=k?new Date(k.textContent||"").getTime():Date.now();!isNaN(b)&&!isNaN(T)&&l.push({coordinates:[T,b],timestamp:isNaN(L)?Date.now():L})}),l.length<2)return{success:!1,error:"Niet genoeg geldige punten in GPX bestand"};const h=s.querySelector("trk > name")?.textContent||s.querySelector("metadata > name")?.textContent||r||`Import ${new Date().toLocaleDateString("nl-NL")}`,g=Xb(l),m=l[0].timestamp,y=l[l.length-1].timestamp,_=y-m,x={id:crypto.randomUUID(),name:h,points:l,startTime:m,endTime:y,totalDistance:g,totalDuration:_>0?_:0,pausedDuration:0,createdAt:new Date().toISOString()};return n(w=>({savedRoutes:[x,...w.savedRoutes]})),{success:!0,routeId:x.id}}catch(i){return console.error("GPX import error:",i),{success:!1,error:"Fout bij importeren van GPX bestand"}}},updateRouteNotes:(t,r)=>{n(i=>({savedRoutes:i.savedRoutes.map(s=>s.id===t?{...s,notes:r}:s)}))},addPhotoToRoute:(t,r)=>{const i={...r,id:crypto.randomUUID(),timestamp:new Date().toISOString()};n(s=>({savedRoutes:s.savedRoutes.map(a=>a.id===t?{...a,photos:[...a.photos||[],i]}:a)}))},removePhotoFromRoute:(t,r)=>{n(i=>({savedRoutes:i.savedRoutes.map(s=>s.id===t?{...s,photos:(s.photos||[]).filter(a=>a.id!==r)}:s)}))},getCurrentDistance:()=>{const{currentPoints:t}=e();return Xb(t)},getCurrentDuration:()=>{const{state:t,startTime:r,totalPausedTime:i,pauseStartTime:s}=e();if(!r)return 0;const a=Date.now();let o=i;return t==="paused"&&s&&(o+=a-s),a-r-o},getAverageSpeed:()=>{const t=e().getCurrentDistance(),r=e().getCurrentDuration();return r===0?0:t/1e3/(r/36e5)}}),{name:"detectorapp-route-recording",version:2,partialize:n=>({savedRoutes:n.savedRoutes,visibleRouteIds:Array.from(n.visibleRouteIds),heatmapEnabled:n.heatmapEnabled,gridEnabled:n.gridEnabled,gridCenter:n.gridCenter,gridSize:n.gridSize,gridCount:n.gridCount,gridColor:n.gridColor,autoPauseEnabled:n.autoPauseEnabled,autoPauseSeconds:n.autoPauseSeconds}),merge:(n,e)=>({...e,...n,visibleRouteIds:new Set(n?.visibleRouteIds||[])})}));function oz(n){const e=`<?xml version="1.0" encoding="UTF-8"?>
<gpx version="1.1" creator="DetectorApp NL"
  xmlns="http://www.topografix.com/GPX/1/1"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd">
  <metadata>
    <name>${n.name}</name>
    <time>${new Date(n.startTime).toISOString()}</time>
  </metadata>
  <trk>
    <name>${n.name}</name>
    <trkseg>
${n.points.map(s=>`      <trkpt lat="${s.coordinates[1]}" lon="${s.coordinates[0]}">
        <time>${new Date(s.timestamp).toISOString()}</time>
      </trkpt>`).join(`
`)}
    </trkseg>
  </trk>
</gpx>`,t=new Blob([e],{type:"application/gpx+xml"}),r=URL.createObjectURL(t),i=document.createElement("a");i.href=r,i.download=`${n.name.replace(/[^a-zA-Z0-9]/g,"-")}.gpx`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(r)}let wu=null,yp=null;function lz(){if(typeof window>"u"||!("speechSynthesis"in window))return!1;wu=window.speechSynthesis;const n=()=>{const e=wu?.getVoices()||[];yp=e.find(t=>t.lang.startsWith("nl")||t.name.toLowerCase().includes("dutch")||t.name.toLowerCase().includes("nederland"))||null,!yp&&e.length>0&&(yp=e[0])};return n(),wu&&(wu.onvoiceschanged=n),!0}function cTe(n,e){if(!wu&&!lz()||!wu)return;wu.cancel();const t=new SpeechSynthesisUtterance(n);yp&&(t.voice=yp),t.lang="nl-NL",t.rate=e?.rate,t.pitch=e?.pitch??1,t.volume=e?.volume??1,wu.speak(t)}function uTe(n){const e=[];e.push(`${n.type} toegevoegd`),n.material&&n.material!=="Onbekend"&&e.push(`Materiaal: ${n.material}`),n.period&&n.period!=="Onbekend"&&e.push(`Periode: ${n.period}`),n.layerName&&n.layerName!=="Vondsten"&&e.push(`Opgeslagen in ${n.layerName}`);const t=e.join(". ");cTe(t,{rate:1.1})}lz();const hTe="detectorapp-photos",dTe=1,yw="photos",fTe=1024,gTe=200,mTe=.8,pTe=.7;function yTe(){return new Promise((n,e)=>{const t=indexedDB.open(hTe,dTe);t.onerror=()=>e(t.error),t.onsuccess=()=>n(t.result),t.onupgradeneeded=r=>{const i=r.target.result;i.objectStoreNames.contains(yw)||i.createObjectStore(yw,{keyPath:"id"}).createIndex("createdAt","createdAt",{unique:!1})}})}async function aD(n,e,t){return new Promise((r,i)=>{const s=new Image,a=URL.createObjectURL(n);s.onload=()=>{URL.revokeObjectURL(a);let{width:o,height:l}=s;(o>e||l>e)&&(o>l?(l=Math.round(l*e/o),o=e):(o=Math.round(o*e/l),l=e));const c=document.createElement("canvas");c.width=o,c.height=l;const h=c.getContext("2d");if(!h){i(new Error("Could not get canvas context"));return}h.imageSmoothingEnabled=!0,h.imageSmoothingQuality="high",h.drawImage(s,0,0,o,l),c.toBlob(g=>{g?r({blob:g,width:o,height:l}):i(new Error("Could not create blob"))},"image/jpeg",t)},s.onerror=()=>{URL.revokeObjectURL(a),i(new Error("Could not load image"))},s.src=a})}async function xTe(n,e){const{blob:t,width:r,height:i}=await aD(e,fTe,mTe),{blob:s}=await aD(e,gTe,pTe),a={id:n,fullImage:t,thumbnail:s,originalName:e.name,mimeType:"image/jpeg",width:r,height:i,size:t.size,createdAt:new Date().toISOString()},o=await yTe();return new Promise((l,c)=>{const h=o.transaction(yw,"readwrite"),m=h.objectStore(yw).put(a);m.onsuccess=()=>l(a),m.onerror=()=>c(m.error),h.oncomplete=()=>o.close()})}function qb({label:n,value:e,onChange:t,options:r,required:i=!1,placeholder:s="Typ hier..."}){const[a,o]=H.useState(!1),[l,c]=H.useState(!1),[h,g]=H.useState(""),m=e&&!r.includes(e),y=()=>{c(!0),g(m?e:""),o(!1)},_=()=>{h.trim()&&t(h.trim()),c(!1)};return l?f.jsxs("div",{children:[f.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:[n,i&&f.jsx("span",{className:"text-orange-500 ml-0.5",children:"*"})]}),f.jsx("input",{type:"text",value:h,onChange:x=>g(x.target.value),onKeyDown:x=>{x.key==="Enter"&&(x.preventDefault(),_()),x.key==="Escape"&&c(!1)},onBlur:_,placeholder:s,autoFocus:!0,className:"w-full px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 focus:bg-white focus:ring-2 focus:ring-orange-500 transition-all",style:{border:"none",outline:"none"}})]}):f.jsxs("div",{className:"relative",children:[f.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:[n,i&&f.jsx("span",{className:"text-orange-500 ml-0.5",children:"*"})]}),f.jsxs("button",{type:"button",onClick:()=>o(!a),className:"w-full flex items-center justify-between px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 hover:bg-gray-100 transition-colors text-left",style:{border:"none",outline:"none"},children:[f.jsxs("span",{className:e?"":"text-gray-400",children:[e||"Selecteer...",m&&f.jsx(B5,{size:12,className:"inline ml-1 text-orange-500"})]}),f.jsx(pg,{size:16,className:`text-gray-400 transition-transform ${a?"rotate-180":""}`})]}),a&&f.jsxs("div",{className:"absolute z-50 w-full mt-1 bg-white rounded-lg shadow-lg max-h-48 overflow-y-auto",children:[f.jsxs("button",{type:"button",onClick:y,className:"w-full px-3 py-2 text-left text-sm text-orange-600 hover:bg-orange-50 transition-colors flex items-center gap-2",style:{border:"none",outline:"none"},children:[f.jsx(B5,{size:12}),"Eigen invoer..."]}),f.jsx("div",{className:"border-t border-gray-100"}),r.map(x=>f.jsx("button",{type:"button",onClick:()=>{t(x),o(!1)},className:`w-full px-3 py-2 text-left text-sm transition-colors ${x===e?"bg-orange-50 text-orange-600":"text-gray-600 hover:bg-gray-50"}`,style:{border:"none",outline:"none"},children:x},x))]})]})}function cz({onClose:n,initialLocation:e}){const t=ls(Ve=>Ve.position),r=Xr(Ve=>Ve.map),i=ur(Ve=>Ve.vondstFormPhoto),s=Hi(Ve=>Ve.layers),a=Hi(Ve=>Ve.addPoint);Hi(Ve=>Ve.addPhotoToPoint);const o=dn(Ve=>Ve.voiceFeedbackEnabled),l=wo(Ve=>Ve.state),c=wo(Ve=>Ve.startTime);wo(Ve=>Ve.savedRoutes);const h=()=>l==="idle"||!c?null:`Route ${new Date(c).toLocaleDateString("nl-NL")} ${new Date(c).toLocaleTimeString("nl-NL",{hour:"2-digit",minute:"2-digit"})}`,g=l==="recording"||l==="paused",m=h(),[y,_]=H.useState(""),[x,w]=H.useState(""),[b,T]=H.useState(""),[k,L]=H.useState(""),[O,B]=H.useState(!1),[R,A]=H.useState(void 0),[P,D]=H.useState(void 0),[N,G]=H.useState(oo),[j,ve]=H.useState(i),[ce,je]=H.useState(null);H.useEffect(()=>{if(j){const Ve=URL.createObjectURL(j);return je(Ve),()=>URL.revokeObjectURL(Ve)}else je(null)},[j]);const[Pe,ue]=H.useState(e?"map-pick":t?"gps":"map-center"),[Ne,be]=H.useState(e||null),[ie,V]=H.useState(!1),J=()=>{if(Pe==="gps"&&t)return{lat:t.lat,lng:t.lng};if(Pe==="map-pick"&&Ne)return Ne;if(r){const Ve=r.getView().getCenter();if(Ve){const[jt,St]=bn(Ve);return{lat:St,lng:jt}}}return null},te=J();H.useEffect(()=>{if(!ie||!r)return;const Ve=jt=>{const[St,Ut]=bn(jt.coordinate);be({lat:Ut,lng:St}),ue("map-pick"),V(!1)};return r.on("click",Ve),()=>r.un("click",Ve)},[ie,r]);const re=()=>V(!0),he=()=>{t&&(ue("gps"),be(null))},Be=()=>{const Ve=document.createElement("input");Ve.type="file",Ve.accept="image/*",Ve.capture="environment",Ve.onchange=jt=>{const St=jt.target.files?.[0];St&&ve(St)},Ve.click()},Ge=()=>ve(null),ye=async Ve=>{Ve.preventDefault();const jt=J();if(!jt){alert("Geen locatie beschikbaar");return}if(!x){alert("Vul een naam/type in");return}B(!0);try{let St=y||"";if(N===oo){const tt=[];b&&tt.push(`Materiaal: ${b}`),k&&tt.push(`Periode: ${k}`),R&&tt.push(`Gewicht: ${R}g`),P&&tt.push(`Lengte: ${P}mm`),tt.length>0&&(St=tt.join(" | ")+(y?` | ${y}`:""))}let Ut;if(j){const tt=crypto.randomUUID();try{const kn=await xTe(tt,j),ln=await pe(kn.thumbnail);Ut={id:tt,thumbnailBase64:ln,createdAt:kn.createdAt}}catch(kn){console.error("Failed to save photo:",kn)}}a(N,{coordinates:[jt.lng,jt.lat],name:x,category:N===oo?x:"Overig",notes:St||"",...Ut?{photos:[Ut]}:{},...g&&c?{routeId:`recording-${c}`,routeName:m||void 0}:{}});const Ht=s.find(tt=>tt.id===N)?.name||"Vondsten";o&&uTe({type:x,material:b||void 0,period:k||void 0,layerName:Ht}),alert(`Toegevoegd aan ${Ht}! ${Ut?" (met foto)":""}`),n()}catch(St){alert("Fout bij opslaan: "+St.message)}finally{B(!1)}},pe=Ve=>new Promise((jt,St)=>{const Ut=new FileReader;Ut.onloadend=()=>jt(Ut.result),Ut.onerror=St,Ut.readAsDataURL(Ve)}),Et=H.useMemo(()=>s.map(Ve=>({id:Ve.id,name:Ve.name,color:Ve.color})),[s]);return ie?f.jsx(wt.div,{className:"fixed bottom-0 left-0 right-0 z-[2000] p-4",initial:{y:100},animate:{y:0},exit:{y:100},children:f.jsxs("div",{className:"bg-orange-500 text-white rounded-xl shadow-xl p-4 flex items-center justify-between max-w-md mx-auto",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx(jv,{size:24,className:"animate-pulse"}),f.jsxs("div",{children:[f.jsx("div",{className:"font-medium",children:"Tik op de kaart"}),f.jsx("div",{className:"text-sm opacity-90",children:"om locatie te kiezen"})]})]}),f.jsx("button",{onClick:()=>V(!1),className:"px-4 py-2 bg-white/20 hover:bg-white/30 rounded-lg transition-colors border-0 outline-none",children:"Annuleren"})]})}):f.jsx(wt.div,{className:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:f.jsxs(wt.div,{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full max-h-[90vh] overflow-hidden flex flex-col",initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},children:[f.jsxs("div",{className:"bg-gradient-to-r from-orange-500 to-orange-600 text-white px-5 py-4 flex justify-between items-center flex-shrink-0",children:[f.jsx("h2",{className:"text-lg font-semibold",children:"Nieuwe Vondst"}),f.jsx("button",{onClick:n,className:"w-8 h-8 flex items-center justify-center rounded-full hover:bg-white/20 transition-colors border-0 outline-none",children:f.jsx(Sr,{size:20})})]}),f.jsxs("form",{onSubmit:ye,className:"flex-1 overflow-y-auto",children:[f.jsxs("div",{className:"p-5 space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Foto"}),ce?f.jsxs("div",{className:"relative",children:[f.jsx("img",{src:ce,alt:"Vondst",className:"w-full h-40 object-cover rounded-xl"}),f.jsx("button",{type:"button",onClick:Ge,className:"absolute top-2 right-2 w-8 h-8 bg-red-500 text-white rounded-full flex items-center justify-center hover:bg-red-600 transition-colors border-0 outline-none shadow-lg",children:f.jsx(_c,{size:16})})]}):f.jsxs("button",{type:"button",onClick:Be,className:"w-full h-32 bg-gray-50 rounded-xl flex flex-col items-center justify-center gap-2 hover:bg-gray-100 transition-colors text-gray-500 border-2 border-dashed border-gray-200",style:{outline:"none"},children:[f.jsx(RE,{size:32}),f.jsx("span",{className:"text-sm",children:"Maak een foto"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Locatie"}),te&&f.jsxs("div",{className:"bg-orange-50 rounded-xl px-4 py-3 mb-2",children:[f.jsxs("div",{className:"text-sm text-orange-800 font-mono",children:[te.lat.toFixed(6),"N, ",te.lng.toFixed(6),"E"]}),f.jsx("div",{className:"text-xs text-orange-600 mt-1",children:Pe==="gps"?" GPS locatie":Pe==="map-pick"?" Gekozen op kaart":" Kaart midden"})]}),!te&&f.jsx("div",{className:"bg-red-50 rounded-xl px-4 py-3 mb-2",children:f.jsx("div",{className:"text-sm text-red-600",children:"Geen locatie beschikbaar"})}),f.jsxs("div",{className:"flex gap-2",children:[t&&Pe!=="gps"&&f.jsxs("button",{type:"button",onClick:he,className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 text-sm bg-green-50 text-green-700 rounded-lg hover:bg-green-100 transition-colors border-0 outline-none",children:[f.jsx(Y1,{size:16}),"GPS"]}),f.jsxs("button",{type:"button",onClick:re,className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 text-sm bg-blue-50 text-blue-700 rounded-lg hover:bg-blue-100 transition-colors border-0 outline-none",children:[f.jsx(jv,{size:16}),"Kies op kaart"]})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Opslaan naar"}),f.jsx("div",{className:"flex flex-wrap gap-2",children:Et.map(Ve=>f.jsx("button",{type:"button",onClick:()=>G(Ve.id),className:`px-3 py-2 rounded-lg text-sm font-medium transition-all border-0 outline-none ${N===Ve.id?"bg-gray-800 text-white shadow-md":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:Ve.name},Ve.id))})]}),N===oo&&f.jsx(qb,{label:"Type vondst",value:x,onChange:w,options:["Munt","Aardewerk","Gesp","Fibula","Ring","Speld","Sieraad","Gereedschap","Wapen","Anders"],required:!0,placeholder:"Typ type vondst..."}),N!==oo&&f.jsxs("div",{children:[f.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:["Naam",f.jsx("span",{className:"text-orange-500 ml-0.5",children:"*"})]}),f.jsx("input",{type:"text",value:x,onChange:Ve=>w(Ve.target.value),placeholder:"Naam van het punt...",className:"w-full px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 focus:bg-white focus:ring-2 focus:ring-orange-500 transition-all",style:{border:"none",outline:"none"}})]}),N===oo&&f.jsxs(f.Fragment,{children:[f.jsx(qb,{label:"Materiaal",value:b,onChange:T,options:["Brons","IJzer","Zilver","Goud","Koper","Lood","Tin","Keramiek","Steen","Glas","Bot","Hout","Leer","Onbekend"],placeholder:"Typ materiaal..."}),f.jsx(qb,{label:"Periode",value:k,onChange:L,options:["Steentijd","Bronstijd","IJzertijd","Romeins","Middeleeuws","Nieuwetijd","Modern","Onbekend"],placeholder:"Typ periode..."}),f.jsxs("div",{className:"flex gap-3",children:[f.jsxs("div",{className:"flex-1",children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Gewicht (g)"}),f.jsx("input",{type:"number",value:R??"",onChange:Ve=>A(Ve.target.value?parseFloat(Ve.target.value):void 0),className:"w-full px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 focus:bg-white focus:ring-2 focus:ring-orange-500 transition-all",style:{border:"none",outline:"none"},min:"0",step:"0.1"})]}),f.jsxs("div",{className:"flex-1",children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Lengte (mm)"}),f.jsx("input",{type:"number",value:P??"",onChange:Ve=>D(Ve.target.value?parseFloat(Ve.target.value):void 0),className:"w-full px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 focus:bg-white focus:ring-2 focus:ring-orange-500 transition-all",style:{border:"none",outline:"none"},min:"0",step:"0.1"})]})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Notities"}),f.jsx("textarea",{value:y,onChange:Ve=>_(Ve.target.value),className:"w-full px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 focus:bg-white focus:ring-2 focus:ring-orange-500 transition-all resize-none h-20",style:{border:"none",outline:"none"},placeholder:"Beschrijving, context, vindplaats details..."})]}),f.jsx("div",{className:"rounded-xl px-4 py-3 bg-orange-50",children:f.jsx("p",{className:"text-sm text-orange-700",children:' Opgeslagen in "Mijn Lagen" op dit apparaat'})})]}),f.jsxs("div",{className:"p-5 pt-0 flex gap-3",children:[f.jsx("button",{type:"button",onClick:n,className:"flex-1 px-4 py-3 bg-gray-100 text-gray-700 rounded-xl hover:bg-gray-200 transition-colors font-medium border-0 outline-none",children:"Annuleren"}),f.jsx("button",{type:"submit",disabled:O||!te||ie||!x,className:"flex-1 px-4 py-3 bg-orange-500 text-white rounded-xl hover:bg-orange-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium border-0 outline-none",children:O?"Opslaan...":"Opslaan"})]})]})]})})}function _Te(){const{user:n,setUser:e,setLoading:t}=_E();return H.useEffect(()=>{const s=YF(Hh,a=>{e(a),t(!1)});return()=>s()},[e,t]),{user:n,loginAnonymous:async()=>{try{await oJ(Hh)}catch(s){console.error("Login failed:",s)}},logout:async()=>{try{await ZF(Hh)}catch(s){console.error("Logout failed:",s)}},isAuthenticated:!!n}}function vTe(){const{isAuthenticated:n,loginAnonymous:e}=_Te(),t=dn(c=>c.vondstenLocalOnly),r=dn(c=>c.showVondstButton),i=ur(c=>c.vondstFormOpen),s=ur(c=>c.vondstFormLocation),a=ur(c=>c.openVondstForm),o=ur(c=>c.closeVondstForm);if(!r)return null;const l=()=>{if(t){a();return}if(!n){confirm("Je moet ingelogd zijn om vondsten in de cloud op te slaan. Anoniem inloggen?")&&e();return}a()};return f.jsxs(f.Fragment,{children:[f.jsx(wt.button,{className:"fixed bottom-2 right-[60px] z-[1000] w-11 h-11 bg-orange-500 hover:bg-orange-600 text-white rounded-xl shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},onClick:l,title:"Vondst toevoegen",children:f.jsx(pa,{size:22,strokeWidth:2})}),f.jsx(An,{children:i&&f.jsx(cz,{onClose:o,initialLocation:s||void 0})})]})}function wTe(){const n=dn(pe=>pe.showRouteRecordButton),e=dn(pe=>pe.showVondstButton),t=ur(pe=>pe.toggleRouteDashboard),{state:r,startRecording:i,pauseRecording:s,resumeRecording:a,stopRecording:o,cancelRecording:l,addPoint:c,getCurrentDistance:h,getCurrentDuration:g,getAverageSpeed:m,currentPoints:y,savedRoutes:_,autoPauseEnabled:x,autoPauseSeconds:w}=wo(),[b,T]=H.useState(!1),[k,L]=H.useState(""),[O,B]=H.useState(!1),[R,A]=H.useState(!1),P=H.useRef(null),D=H.useRef(null),N=H.useRef(null),G=pe=>{const Et=Math.floor(pe/1e3),Ve=Math.floor(Et/3600),jt=Math.floor(Et%3600/60),St=Et%60;return Ve>0?`${Ve}:${jt.toString().padStart(2,"0")}:${St.toString().padStart(2,"0")}`:`${jt}:${St.toString().padStart(2,"0")}`},j=pe=>pe<1e3?`${Math.round(pe)} m`:`${(pe/1e3).toFixed(2)} km`,ve=pe=>`${pe.toFixed(1)} km/h`,ce=(pe,Et,Ve,jt)=>{const Ut=(jt-Et)*Math.PI/180,Ht=(Ve-pe)*Math.PI/180,tt=Math.sin(Ut/2)*Math.sin(Ut/2)+Math.cos(Et*Math.PI/180)*Math.cos(jt*Math.PI/180)*Math.sin(Ht/2)*Math.sin(Ht/2);return 6371e3*(2*Math.atan2(Math.sqrt(tt),Math.sqrt(1-tt)))};if(H.useEffect(()=>(r==="recording"?(A(!1),"geolocation"in navigator&&P.current===null&&(P.current=navigator.geolocation.watchPosition(pe=>{const Et=pe.coords.longitude,Ve=pe.coords.latitude,jt=Date.now();c(Et,Ve,pe.coords.accuracy),x&&D.current?ce(D.current.lon,D.current.lat,Et,Ve)>3?(D.current={lon:Et,lat:Ve,time:jt},N.current&&(clearTimeout(N.current),N.current=null)):jt-D.current.time>=w*1e3&&(s(),A(!0),D.current=null):D.current={lon:Et,lat:Ve,time:jt}},pe=>{console.error("GPS error:",pe)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:1e3}))):(P.current!==null&&(navigator.geolocation.clearWatch(P.current),P.current=null),N.current&&(clearTimeout(N.current),N.current=null)),()=>{P.current!==null&&(navigator.geolocation.clearWatch(P.current),P.current=null),N.current&&(clearTimeout(N.current),N.current=null)}),[r,c,x,w,s]),!n)return null;const je=e?"right-[114px]":"right-[60px]",Pe=e?"right-[168px]":"right-[114px]",ue=()=>{i(),B(!0)},Ne=()=>{s()},be=()=>{a()},ie=()=>{L(`Route ${new Date().toLocaleDateString("nl-NL")}`),T(!0)},V=()=>{const pe=o(k);T(!1),B(!1),L(""),pe&&confirm(`Route "${pe.name}" opgeslagen! (${j(pe.totalDistance)})

Direct exporteren als GPX?`)&&oz(pe)},J=()=>{y.length>2&&!confirm("Weet je zeker dat je de opname wilt annuleren? De route wordt niet opgeslagen.")||(l(),T(!1),B(!1))},te=h(),re=g(),he=m(),Be=pe=>{switch(pe){case"recording":return"bg-red-500 hover:bg-red-600";case"paused":return"bg-yellow-500 hover:bg-yellow-600";default:return"bg-green-500 hover:bg-green-600"}},Ge=pe=>{switch(pe){case"recording":return f.jsx(pV,{size:22,strokeWidth:2});case"paused":return f.jsx(xV,{size:22,strokeWidth:2});default:return f.jsx(Gv,{size:22,strokeWidth:2})}},ye=()=>{switch(r){case"idle":ue();break;case"recording":Ne();break;case"paused":be();break}};return f.jsxs(f.Fragment,{children:[f.jsxs(wt.button,{className:`fixed bottom-2 ${je} z-[1000] w-11 h-11 ${Be(r)} text-white rounded-xl shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none backdrop-blur-sm`,whileHover:{scale:1.05},whileTap:{scale:.95},onClick:ye,title:r==="idle"?"Route opnemen":r==="recording"?"Pauzeren":"Hervatten",children:[Ge(r),r==="recording"&&f.jsx(wt.div,{className:"absolute inset-0 rounded-xl bg-red-400",animate:{opacity:[.5,0,.5]},transition:{duration:1.5,repeat:1/0}})]}),f.jsx(An,{children:r==="idle"&&_.length>0&&f.jsxs(wt.button,{className:`fixed bottom-2 ${Pe} z-[1000] w-11 h-11 bg-green-400 hover:bg-green-500 text-white rounded-xl shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none`,initial:{opacity:0,scale:.8,x:20},animate:{opacity:1,scale:1,x:0},exit:{opacity:0,scale:.8,x:20},whileHover:{scale:1.05},whileTap:{scale:.95},onClick:t,title:`Mijn routes (${_.length})`,children:[f.jsx(gV,{size:18,strokeWidth:2}),f.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-white text-green-600 text-xs font-bold rounded-full flex items-center justify-center shadow-sm",children:_.length})]})}),f.jsx(An,{children:(r==="recording"||r==="paused")&&f.jsx(wt.button,{className:`fixed bottom-2 ${Pe} z-[1000] w-11 h-11 bg-gray-700 hover:bg-gray-800 text-white rounded-xl shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none`,initial:{opacity:0,scale:.8,x:20},animate:{opacity:1,scale:1,x:0},exit:{opacity:0,scale:.8,x:20},whileHover:{scale:1.05},whileTap:{scale:.95},onClick:ie,title:"Stoppen en opslaan",children:f.jsx(Oue,{size:18,strokeWidth:2,fill:"currentColor"})})}),f.jsx(An,{children:O&&r!=="idle"&&f.jsxs(wt.div,{className:"fixed bottom-16 right-2 z-[999] bg-white/95 backdrop-blur-sm rounded-xl shadow-lg p-3 min-w-[180px]",initial:{opacity:0,y:20,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.9},children:[f.jsxs("div",{className:"flex items-center justify-between mb-2",children:[f.jsx("span",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:r==="recording"?" Opname":R?" Auto-pauze":" Gepauzeerd"}),f.jsx("button",{onClick:()=>B(!1),className:"p-0.5 text-gray-400 hover:text-gray-600 border-0 outline-none bg-transparent",children:f.jsx(Sr,{size:14})})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(e1,{size:16,className:"text-green-500"}),f.jsx("span",{className:"text-lg font-semibold text-gray-800",children:j(te)})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(Dv,{size:16,className:"text-blue-500"}),f.jsx(ETe,{duration:re,recordingState:r,formatTime:G})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(Ace,{size:16,className:"text-green-500"}),f.jsx("span",{className:"text-sm text-gray-600",children:ve(he)})]}),f.jsxs("div",{className:"text-xs text-gray-400 pt-1 border-t border-gray-100",children:[y.length," punten opgenomen"]})]})]})}),f.jsx(An,{children:b&&f.jsxs(f.Fragment,{children:[f.jsx(wt.div,{className:"fixed inset-0 z-[1500] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>T(!1)}),f.jsxs(wt.div,{className:"fixed left-4 right-4 top-1/2 z-[1501] bg-white rounded-xl shadow-2xl p-4 max-w-sm mx-auto",initial:{opacity:0,scale:.9,y:"-40%"},animate:{opacity:1,scale:1,y:"-50%"},exit:{opacity:0,scale:.9,y:"-40%"},children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Route opslaan"}),f.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 mb-4 space-y-1",children:[f.jsxs("div",{className:"flex justify-between text-sm",children:[f.jsx("span",{className:"text-gray-500",children:"Afstand:"}),f.jsx("span",{className:"font-medium",children:j(te)})]}),f.jsxs("div",{className:"flex justify-between text-sm",children:[f.jsx("span",{className:"text-gray-500",children:"Duur:"}),f.jsx("span",{className:"font-medium",children:G(re)})]}),f.jsxs("div",{className:"flex justify-between text-sm",children:[f.jsx("span",{className:"text-gray-500",children:"Gem. snelheid:"}),f.jsx("span",{className:"font-medium",children:ve(he)})]}),f.jsxs("div",{className:"flex justify-between text-sm",children:[f.jsx("span",{className:"text-gray-500",children:"Punten:"}),f.jsx("span",{className:"font-medium",children:y.length})]})]}),f.jsxs("div",{className:"mb-4",children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Naam van de route"}),f.jsx("input",{type:"text",value:k,onChange:pe=>L(pe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Route naam...",autoFocus:!0})]}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("button",{onClick:J,className:"flex-1 px-4 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none",children:"Annuleren"}),f.jsxs("button",{onClick:V,disabled:y.length<2,className:"flex-1 px-4 py-2 bg-green-500 hover:bg-green-600 disabled:bg-gray-300 text-white rounded-lg transition-colors border-0 outline-none flex items-center justify-center gap-2",children:[f.jsx(_V,{size:16}),"Opslaan"]})]}),y.length<2&&f.jsx("p",{className:"text-xs text-red-500 text-center mt-2",children:"Minimaal 2 punten nodig om op te slaan"})]})]})})]})}function ETe({duration:n,recordingState:e,formatTime:t}){const[r,i]=H.useState(n);return H.useEffect(()=>{if(e!=="recording"){i(n);return}const s=setInterval(()=>{i(a=>a+1e3)},1e3);return()=>clearInterval(s)},[e,n]),H.useEffect(()=>{i(n)},[n]),f.jsx("span",{className:"text-lg font-semibold text-gray-800",children:t(r)})}function STe(){const n=Xr(s=>s.map),{currentPoints:e,state:t}=wo(),r=H.useRef(null),i=H.useRef(null);return H.useEffect(()=>{if(!n)return;const s=new xl;i.current=s;const a=new pc({source:s,zIndex:999,properties:{name:"route-recording-layer"}});return r.current=a,n.addLayer(a),()=>{r.current&&n&&n.removeLayer(r.current)}},[n]),H.useEffect(()=>{if(!i.current||(i.current.clear(),t==="idle"||e.length===0))return;const s=e.map(a=>Ir(a.coordinates));if(s.length>=2){const a=new vr({geometry:new bi(s)});a.setStyle(new gn({stroke:new Hn({color:t==="paused"?"rgba(234, 179, 8, 0.8)":"rgba(168, 85, 247, 0.8)",width:4,lineCap:"round",lineJoin:"round"})})),i.current.addFeature(a)}if(s.length>=1){const a=new vr({geometry:new mi(s[0])});a.setStyle(new gn({image:new Us({radius:8,fill:new Jn({color:"rgba(34, 197, 94, 1)"}),stroke:new Hn({color:"white",width:2})})})),i.current.addFeature(a)}if(s.length>=1){const a=new vr({geometry:new mi(s[s.length-1])});a.setStyle(new gn({image:new Us({radius:6,fill:new Jn({color:t==="paused"?"rgba(234, 179, 8, 1)":"rgba(168, 85, 247, 1)"}),stroke:new Hn({color:"white",width:2})})})),i.current.addFeature(a)}},[e,t]),null}const oD=["#a855f7","#3b82f6","#22c55e","#f97316","#ec4899","#14b8a6","#eab308","#8b5cf6"];function bTe(){const n=Xr(s=>s.map),{savedRoutes:e,visibleRouteIds:t}=wo(),r=H.useRef(null),i=H.useRef(null);return H.useEffect(()=>{if(!n)return;const s=new xl;i.current=s;const a=new pc({source:s,zIndex:998,properties:{name:"saved-routes-layer"}});return r.current=a,n.addLayer(a),()=>{r.current&&n&&n.removeLayer(r.current)}},[n]),H.useEffect(()=>{if(!i.current)return;i.current.clear(),e.filter(a=>t.has(a.id)).forEach((a,o)=>{const l=oD[o%oD.length],c=a.points.map(x=>Ir(x.coordinates));if(c.length<2)return;const h=new vr({geometry:new bi(c),routeId:a.id,routeName:a.name});h.setStyle(new gn({stroke:new Hn({color:l,width:4,lineCap:"round",lineJoin:"round"})})),i.current.addFeature(h);const g=new vr({geometry:new mi(c[0]),routeId:a.id,type:"start"});g.setStyle(new gn({image:new Us({radius:8,fill:new Jn({color:"#22c55e"}),stroke:new Hn({color:"white",width:2})}),text:new yo({text:"S",font:"bold 10px sans-serif",fill:new Jn({color:"white"}),offsetY:1})})),i.current.addFeature(g);const m=new vr({geometry:new mi(c[c.length-1]),routeId:a.id,type:"end"});m.setStyle(new gn({image:new Us({radius:8,fill:new Jn({color:"#ef4444"}),stroke:new Hn({color:"white",width:2})}),text:new yo({text:"E",font:"bold 10px sans-serif",fill:new Jn({color:"white"}),offsetY:1})})),i.current.addFeature(m);const y=Math.floor(c.length/2),_=new vr({geometry:new mi(c[y]),routeId:a.id,type:"label"});_.setStyle(new gn({text:new yo({text:a.name,font:"12px sans-serif",fill:new Jn({color:"#1f2937"}),stroke:new Hn({color:"white",width:3}),offsetY:-15})})),i.current.addFeature(_)})},[e,t]),null}function TTe(){const n=Xr(a=>a.map),{savedRoutes:e,visibleRouteIds:t,heatmapEnabled:r}=wo(),i=H.useRef(null),s=H.useRef(null);return H.useEffect(()=>{if(!n)return;const a=new xl;s.current=a;const o=new tX({source:a,blur:15,radius:10,weight:()=>1,gradient:["#00f","#0ff","#0f0","#ff0","#f00"],opacity:.6,zIndex:90});return i.current=o,n.addLayer(o),()=>{n&&i.current&&n.removeLayer(i.current)}},[n]),H.useEffect(()=>{if(!s.current||!i.current)return;if(s.current.clear(),!r){i.current.setVisible(!1);return}const a=e.filter(l=>t.has(l.id)),o=[];for(const l of a)for(const c of l.points){const h=new vr({geometry:new mi(Ir(c.coordinates))});o.push(h)}s.current.addFeatures(o),i.current.setVisible(o.length>0)},[e,t,r]),null}function RTe(n,e,t,r){const i=[],s=e/111e3,a=e/(111e3*Math.cos(n[1]*Math.PI/180)),o=Math.floor(t/2),l=n[0]-o*a,c=n[0]+o*a,h=n[1]-o*s,g=n[1]+o*s;for(let x=-o;x<=o;x++){const w=n[0]+x*a,b=[Ir([w,h]),Ir([w,g])],T=new vr({geometry:new bi(b),type:"grid-line"});T.setStyle(new gn({stroke:new Hn({color:r,width:x===0?2:1,lineDash:x===0?void 0:[5,5]})})),i.push(T)}for(let x=-o;x<=o;x++){const w=n[1]+x*s,b=[Ir([l,w]),Ir([c,w])],T=new vr({geometry:new bi(b),type:"grid-line"});T.setStyle(new gn({stroke:new Hn({color:r,width:x===0?2:1,lineDash:x===0?void 0:[5,5]})})),i.push(T)}const m="ABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let x=-o;x<o;x++)for(let w=-o;w<o;w++){const b=n[0]+(w+.5)*a,T=n[1]+(x+.5)*s,k=x+o,L=w+o;if(k>=0&&k<m.length){const O=`${m[k]}${L+1}`,B=new vr({geometry:new bi([Ir([b,T]),Ir([b,T])]),type:"grid-label"});B.setStyle(new gn({text:new yo({text:O,font:"12px sans-serif",fill:new Jn({color:r}),stroke:new Hn({color:"rgba(255,255,255,0.8)",width:3})})})),i.push(B)}}const y=new vr({geometry:new bi([Ir([n[0]-a*.2,n[1]]),Ir([n[0]+a*.2,n[1]])]),type:"grid-center"});y.setStyle(new gn({stroke:new Hn({color:"#ef4444",width:3})})),i.push(y);const _=new vr({geometry:new bi([Ir([n[0],n[1]-s*.2]),Ir([n[0],n[1]+s*.2])]),type:"grid-center"});return _.setStyle(new gn({stroke:new Hn({color:"#ef4444",width:3})})),i.push(_),i}function ATe(){const n=Xr(l=>l.map),{gridEnabled:e,gridCenter:t,gridSize:r,gridCount:i,gridColor:s}=wo(),a=H.useRef(null),o=H.useRef(null);return H.useEffect(()=>{if(!n)return;const l=new xl;o.current=l;const c=new pc({source:l,zIndex:85,properties:{name:"grid-overlay-layer"}});return a.current=c,n.addLayer(c),()=>{a.current&&n&&n.removeLayer(a.current)}},[n]),H.useEffect(()=>{if(!o.current||!a.current)return;if(o.current.clear(),!e||!t){a.current.setVisible(!1);return}const l=RTe(t,r,i,s);o.current.addFeatures(l),a.current.setVisible(!0)},[e,t,r,i,s]),null}function kTe(n){const e=[];let t=0;return n.points.forEach((r,i)=>{if(i>0){const o=n.points[i-1],l=6371e3,c=(r.coordinates[1]-o.coordinates[1])*Math.PI/180,h=(r.coordinates[0]-o.coordinates[0])*Math.PI/180,g=Math.sin(c/2)*Math.sin(c/2)+Math.cos(o.coordinates[1]*Math.PI/180)*Math.cos(r.coordinates[1]*Math.PI/180)*Math.sin(h/2)*Math.sin(h/2),m=2*Math.atan2(Math.sqrt(g),Math.sqrt(1-g));t+=l*m}const s=5,a=Math.sin(t/50)*2+Math.sin(t/120)*1.5+Math.sin(t/30+r.coordinates[0]*1e3)*.5;e.push({distance:t,elevation:Math.max(0,s+a)})}),e}function ITe({route:n,onClose:e}){const t=H.useRef(null),[r,i]=H.useState([]),[s,a]=H.useState({min:0,max:0,gain:0,loss:0});H.useEffect(()=>{const l=kTe(n);if(i(l),l.length>0){const c=l.map(_=>_.elevation),h=Math.min(...c),g=Math.max(...c);let m=0,y=0;for(let _=1;_<l.length;_++){const x=l[_].elevation-l[_-1].elevation;x>0?m+=x:y+=Math.abs(x)}a({min:h,max:g,gain:m,loss:y})}},[n]),H.useEffect(()=>{const l=t.current;if(!l||r.length<2)return;const c=l.getContext("2d");if(!c)return;const h=l.width,g=l.height,m={top:20,right:20,bottom:30,left:40};c.fillStyle="#f9fafb",c.fillRect(0,0,h,g);const y=Math.max(...r.map(O=>O.distance)),_=Math.min(...r.map(O=>O.elevation))-1,x=Math.max(...r.map(O=>O.elevation))+1,w=O=>m.left+O/y*(h-m.left-m.right),b=O=>g-m.bottom-(O-_)/(x-_)*(g-m.top-m.bottom);c.strokeStyle="#e5e7eb",c.lineWidth=1;const T=5;for(let O=0;O<=T;O++){const B=_+(x-_)*(O/T),R=b(B);c.beginPath(),c.moveTo(m.left,R),c.lineTo(h-m.right,R),c.stroke(),c.fillStyle="#9ca3af",c.font="10px sans-serif",c.textAlign="right",c.fillText(`${B.toFixed(1)}m`,m.left-5,R+3)}const k=5;for(let O=0;O<=k;O++){const B=y/k*O,R=w(B);c.fillStyle="#9ca3af",c.font="10px sans-serif",c.textAlign="center",c.fillText(B<1e3?`${Math.round(B)}m`:`${(B/1e3).toFixed(1)}km`,R,g-10)}c.beginPath(),c.moveTo(w(r[0].distance),g-m.bottom),r.forEach(O=>{c.lineTo(w(O.distance),b(O.elevation))}),c.lineTo(w(r[r.length-1].distance),g-m.bottom),c.closePath();const L=c.createLinearGradient(0,m.top,0,g-m.bottom);L.addColorStop(0,"rgba(139, 92, 246, 0.3)"),L.addColorStop(1,"rgba(139, 92, 246, 0.05)"),c.fillStyle=L,c.fill(),c.strokeStyle="#8b5cf6",c.lineWidth=2,c.lineJoin="round",c.lineCap="round",c.beginPath(),r.forEach((O,B)=>{const R=w(O.distance),A=b(O.elevation);B===0?c.moveTo(R,A):c.lineTo(R,A)}),c.stroke()},[r]);const o=l=>l<1e3?`${Math.round(l)} m`:`${(l/1e3).toFixed(2)} km`;return f.jsxs(wt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},className:"fixed inset-4 z-[1700] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[70vh]",children:[f.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-purple-500 text-white",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(Q0,{size:20}),f.jsx("span",{className:"font-medium",children:"Hoogteprofiel"})]}),f.jsx("button",{onClick:e,className:"p-1 rounded bg-purple-400/50 hover:bg-purple-400 transition-colors border-0 outline-none",children:f.jsx(Sr,{size:18})})]}),f.jsxs("div",{className:"px-4 py-2 bg-purple-50 border-b border-purple-100",children:[f.jsx("h3",{className:"font-medium text-gray-800 truncate",children:n.name}),f.jsx("p",{className:"text-xs text-gray-500",children:o(n.totalDistance)})]}),f.jsxs("div",{className:"grid grid-cols-4 gap-2 p-3 border-b border-gray-100",children:[f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"flex items-center justify-center text-blue-500 mb-1",children:f.jsx(mV,{size:14})}),f.jsx("div",{className:"text-xs text-gray-500",children:"Min"}),f.jsxs("div",{className:"text-sm font-medium",children:[s.min.toFixed(1),"m"]})]}),f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"flex items-center justify-center text-purple-500 mb-1",children:f.jsx(Q0,{size:14})}),f.jsx("div",{className:"text-xs text-gray-500",children:"Max"}),f.jsxs("div",{className:"text-sm font-medium",children:[s.max.toFixed(1),"m"]})]}),f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"flex items-center justify-center text-green-500 mb-1",children:f.jsx(Yue,{size:14})}),f.jsx("div",{className:"text-xs text-gray-500",children:"Stijging"}),f.jsxs("div",{className:"text-sm font-medium",children:[s.gain.toFixed(1),"m"]})]}),f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"flex items-center justify-center text-red-500 mb-1",children:f.jsx(Xue,{size:14})}),f.jsx("div",{className:"text-xs text-gray-500",children:"Daling"}),f.jsxs("div",{className:"text-sm font-medium",children:[s.loss.toFixed(1),"m"]})]})]}),f.jsx("div",{className:"flex-1 p-3",children:f.jsx("canvas",{ref:t,width:350,height:200,className:"w-full h-full"})}),f.jsx("div",{className:"px-4 py-2 bg-yellow-50 border-t border-yellow-100",children:f.jsxs("p",{className:"text-xs text-yellow-700",children:[f.jsx("strong",{children:"Let op:"})," Dit zijn gesimuleerde hoogtewaarden. Koppeling met AHN-data komt binnenkort."]})})]})}const CTe=n=>n<1e3?`${Math.round(n)} m`:`${(n/1e3).toFixed(2)} km`,PTe=n=>{const e=Math.floor(n/1e3),t=Math.floor(e/3600),r=Math.floor(e%3600/60);return t>0?`${t}u ${r}m`:`${r} min`},lD=n=>new Date(n).toLocaleDateString("nl-NL",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"});function NTe({route:n,onClose:e}){const{updateRouteNotes:t,addPhotoToRoute:r,removePhotoFromRoute:i}=wo(),[s,a]=H.useState(n.notes||""),[o,l]=H.useState("info"),c=H.useRef(null),h=()=>{t(n.id,s)},g=async _=>{const x=_.target.files?.[0];if(!x)return;const w=URL.createObjectURL(x);r(n.id,{url:w,caption:x.name}),c.current&&(c.current.value="")},m=_=>{confirm("Foto verwijderen?")&&i(n.id,_)},y=wo(_=>_.savedRoutes.find(x=>x.id===n.id))||n;return f.jsxs(wt.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[1700] flex items-center justify-center p-4",children:[f.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:e}),f.jsxs(wt.div,{initial:{scale:.95,y:20},animate:{scale:1,y:0},exit:{scale:.95,y:20},className:"relative bg-white rounded-xl shadow-2xl overflow-hidden w-full max-w-md max-h-[85vh] flex flex-col",children:[f.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-purple-500 text-white",children:[f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsx("h3",{className:"font-medium truncate",children:y.name}),f.jsx("p",{className:"text-xs text-purple-200",children:lD(y.createdAt)})]}),f.jsx("button",{onClick:e,className:"p-1 rounded bg-purple-400/50 hover:bg-purple-400 transition-colors border-0 outline-none ml-2",children:f.jsx(Sr,{size:18})})]}),f.jsxs("div",{className:"flex border-b border-gray-200",children:[f.jsxs("button",{onClick:()=>l("info"),className:`flex-1 py-2 text-sm font-medium border-0 outline-none transition-colors ${o==="info"?"text-purple-600 border-b-2 border-purple-500":"text-gray-500 hover:text-gray-700"}`,children:[f.jsx(pa,{size:16,className:"inline mr-1"}),"Info"]}),f.jsxs("button",{onClick:()=>l("photos"),className:`flex-1 py-2 text-sm font-medium border-0 outline-none transition-colors ${o==="photos"?"text-purple-600 border-b-2 border-purple-500":"text-gray-500 hover:text-gray-700"}`,children:[f.jsx(RE,{size:16,className:"inline mr-1"}),"Foto's (",y.photos?.length||0,")"]}),f.jsxs("button",{onClick:()=>l("notes"),className:`flex-1 py-2 text-sm font-medium border-0 outline-none transition-colors ${o==="notes"?"text-purple-600 border-b-2 border-purple-500":"text-gray-500 hover:text-gray-700"}`,children:[f.jsx(LI,{size:16,className:"inline mr-1"}),"Notities"]})]}),f.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[o==="info"&&f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[f.jsxs("div",{className:"flex items-center gap-2 text-purple-600 mb-1",children:[f.jsx(e1,{size:16}),f.jsx("span",{className:"text-xs text-gray-500",children:"Afstand"})]}),f.jsx("p",{className:"text-lg font-semibold",children:CTe(y.totalDistance)})]}),f.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[f.jsxs("div",{className:"flex items-center gap-2 text-blue-600 mb-1",children:[f.jsx(Dv,{size:16}),f.jsx("span",{className:"text-xs text-gray-500",children:"Duur"})]}),f.jsx("p",{className:"text-lg font-semibold",children:PTe(y.totalDuration)})]})]}),f.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[f.jsxs("div",{className:"flex items-center gap-2 text-green-600 mb-1",children:[f.jsx(pa,{size:16}),f.jsx("span",{className:"text-xs text-gray-500",children:"Punten"})]}),f.jsxs("p",{className:"text-lg font-semibold",children:[y.points.length," GPS punten"]})]}),f.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[f.jsxs("div",{className:"flex items-center gap-2 text-orange-600 mb-1",children:[f.jsx(NI,{size:16}),f.jsx("span",{className:"text-xs text-gray-500",children:"Aangemaakt"})]}),f.jsx("p",{className:"text-sm",children:lD(y.createdAt)})]})]}),o==="photos"&&f.jsxs("div",{className:"space-y-4",children:[f.jsx("input",{ref:c,type:"file",accept:"image/*",onChange:g,className:"hidden"}),f.jsxs("button",{onClick:()=>c.current?.click(),className:"w-full py-8 border-2 border-dashed border-purple-300 rounded-lg text-purple-500 hover:bg-purple-50 transition-colors flex flex-col items-center gap-2",children:[f.jsx(Wa,{size:24}),f.jsx("span",{className:"text-sm",children:"Foto toevoegen"})]}),y.photos&&y.photos.length>0?f.jsx("div",{className:"grid grid-cols-2 gap-2",children:y.photos.map(_=>f.jsxs("div",{className:"relative aspect-square rounded-lg overflow-hidden bg-gray-100",children:[f.jsx("img",{src:_.url,alt:_.caption||"Route foto",className:"w-full h-full object-cover"}),f.jsx("button",{onClick:()=>m(_.id),className:"absolute top-1 right-1 p-1 bg-red-500 text-white rounded-full hover:bg-red-600 transition-colors border-0 outline-none",children:f.jsx(_c,{size:12})}),_.caption&&f.jsx("div",{className:"absolute bottom-0 left-0 right-0 px-2 py-1 bg-black/50 text-white text-xs truncate",children:_.caption})]},_.id))}):f.jsx("p",{className:"text-center text-gray-400 text-sm py-4",children:"Nog geen foto's toegevoegd"})]}),o==="notes"&&f.jsxs("div",{className:"space-y-4",children:[f.jsx("textarea",{value:s,onChange:_=>a(_.target.value),placeholder:"Voeg notities toe over deze route...",className:"w-full h-48 p-3 border border-gray-300 rounded-lg outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent resize-none"}),f.jsx("button",{onClick:h,className:"w-full px-4 py-2 bg-purple-500 hover:bg-purple-600 text-white rounded-lg transition-colors border-0 outline-none",children:"Notities opslaan"})]})]})]})]})}function MTe({route:n,size:e=80}){const t=H.useRef(null);return H.useEffect(()=>{const r=t.current;if(!r||n.points.length<2)return;const i=r.getContext("2d");if(!i)return;i.fillStyle="#f3f4f6",i.fillRect(0,0,e,e);const s=n.points.map(L=>L.coordinates[0]),a=n.points.map(L=>L.coordinates[1]),o=Math.min(...s),l=Math.max(...s),c=Math.min(...a),h=Math.max(...a),g=8,m=e-g*2,y=e-g*2,_=L=>l===o?e/2:g+(L-o)/(l-o)*m,x=L=>h===c?e/2:g+y-(L-c)/(h-c)*y;i.strokeStyle="#a855f7",i.lineWidth=2,i.lineCap="round",i.lineJoin="round",i.beginPath(),n.points.forEach((L,O)=>{const B=_(L.coordinates[0]),R=x(L.coordinates[1]);O===0?i.moveTo(B,R):i.lineTo(B,R)}),i.stroke();const w=_(n.points[0].coordinates[0]),b=x(n.points[0].coordinates[1]);i.fillStyle="#22c55e",i.beginPath(),i.arc(w,b,4,0,Math.PI*2),i.fill();const T=_(n.points[n.points.length-1].coordinates[0]),k=x(n.points[n.points.length-1].coordinates[1]);i.fillStyle="#ef4444",i.beginPath(),i.arc(T,k,4,0,Math.PI*2),i.fill()},[n,e]),n.points.length<2?f.jsx("div",{className:"bg-gray-100 rounded flex items-center justify-center text-gray-400",style:{width:e,height:e},children:f.jsx(pa,{size:20})}):f.jsx("canvas",{ref:t,width:e,height:e,className:"rounded"})}const Yb=n=>n<1e3?`${Math.round(n)} m`:`${(n/1e3).toFixed(2)} km`,Zb=n=>{const e=Math.floor(n/1e3),t=Math.floor(e/3600),r=Math.floor(e%3600/60);return t>0?`${t}u ${r}m`:`${r} min`},cD=n=>new Date(n).toLocaleDateString("nl-NL",{day:"numeric",month:"short",year:"numeric"});function LTe({isOpen:n,onClose:e,onViewRoute:t}){const{savedRoutes:r,deleteRoute:i,renameRoute:s,clearAllRoutes:a,visibleRouteIds:o,toggleRouteVisibility:l,showAllRoutes:c,hideAllRoutes:h,heatmapEnabled:g,toggleHeatmap:m,gridEnabled:y,toggleGrid:_,centerGridOnCurrentLocation:x,gridSize:w,setGridSize:b,autoPauseEnabled:T,setAutoPauseEnabled:k,autoPauseSeconds:L,setAutoPauseSeconds:O,importRouteFromGPX:B}=wo(),[R,A]=H.useState(null),[P,D]=H.useState(""),[N,G]=H.useState(!1),[j,ve]=H.useState(!1),[ce,je]=H.useState(null),[Pe,ue]=H.useState(null),Ne=H.useRef(null),be=async ye=>{const pe=` ${ye.name}

 Afstand: ${Yb(ye.totalDistance)}
 Duur: ${Zb(ye.totalDuration)}
 ${ye.points.length} GPS punten
 ${cD(ye.createdAt)}

Opgenomen met DetectorApp NL`;if(navigator.share)try{await navigator.share({title:ye.name,text:pe});return}catch(Et){Et.name!=="AbortError"&&console.error("Share failed:",Et)}try{await navigator.clipboard.writeText(pe),alert("Route info gekopieerd naar klembord!")}catch{prompt("Kopieer de route info:",pe)}},ie=async ye=>{const pe=ye.target.files?.[0];if(pe){try{const Et=await pe.text(),Ve=B(Et,pe.name.replace(".gpx",""));Ve.success?alert(`Route gemporteerd: ${pe.name}`):alert(`Import mislukt: ${Ve.error}`)}catch{alert("Fout bij lezen van bestand")}Ne.current&&(Ne.current.value="")}},V=ye=>{A(ye.id),D(ye.name)},J=ye=>{P.trim()&&s(ye,P.trim()),A(null),D("")},te=ye=>{confirm(`Weet je zeker dat je "${ye.name}" wilt verwijderen?`)&&i(ye.id)},re=()=>{r.length!==0&&confirm(`Weet je zeker dat je alle ${r.length} routes wilt verwijderen? Dit kan niet ongedaan worden gemaakt.`)&&a()},he=ye=>{l(ye);const pe=r.find(Et=>Et.id===ye);pe&&t&&t(pe)},Be=r.reduce((ye,pe)=>ye+pe.totalDistance,0),Ge=r.reduce((ye,pe)=>ye+pe.totalDuration,0);return f.jsxs(f.Fragment,{children:[f.jsx(An,{children:n&&f.jsxs(f.Fragment,{children:[f.jsx(wt.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),f.jsxs(wt.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-md mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[f.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-purple-500 text-white",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(Gv,{size:20}),f.jsx("span",{className:"font-medium",children:"Mijn Routes"}),f.jsxs("span",{className:"text-purple-200 text-sm",children:["(",r.length,")"]})]}),f.jsx("button",{onClick:e,className:"p-1 rounded bg-purple-400/50 hover:bg-purple-400 transition-colors border-0 outline-none",children:f.jsx(Sr,{size:18})})]}),r.length>0&&f.jsxs("div",{className:"px-4 py-2 bg-purple-50 border-b border-purple-100 flex items-center justify-between text-sm",children:[f.jsxs("div",{className:"flex gap-4",children:[f.jsxs("div",{className:"flex items-center gap-1.5 text-purple-700",children:[f.jsx(e1,{size:14}),f.jsxs("span",{children:["Totaal: ",Yb(Be)]})]}),f.jsxs("div",{className:"flex items-center gap-1.5 text-purple-700",children:[f.jsx(Dv,{size:14}),f.jsx("span",{children:Zb(Ge)})]})]}),f.jsxs("div",{className:"flex gap-1",children:[f.jsx("button",{onClick:()=>ve(!j),className:`px-2 py-1 text-xs rounded transition-colors border-0 outline-none ${T?"bg-green-100 text-green-600":"text-purple-600 hover:bg-purple-100"}`,title:T?"Auto-pauze uit":"Auto-pauze aan",children:f.jsx(Uue,{size:14})}),f.jsx("button",{onClick:()=>G(!N),className:`px-2 py-1 text-xs rounded transition-colors border-0 outline-none ${y?"bg-blue-100 text-blue-600":"text-purple-600 hover:bg-purple-100"}`,title:y?"Grid verbergen":"Grid tonen",children:f.jsx(dV,{size:14})}),f.jsx("button",{onClick:m,className:`px-2 py-1 text-xs rounded transition-colors border-0 outline-none ${g?"bg-orange-100 text-orange-600":"text-purple-600 hover:bg-purple-100"}`,title:g?"Heatmap verbergen":"Heatmap tonen",children:f.jsx(xce,{size:14})}),f.jsx("button",{onClick:c,className:"px-2 py-1 text-xs text-purple-600 hover:bg-purple-100 rounded transition-colors border-0 outline-none",title:"Alle tonen",children:f.jsx(Bv,{size:14})}),f.jsx("button",{onClick:h,className:"px-2 py-1 text-xs text-purple-600 hover:bg-purple-100 rounded transition-colors border-0 outline-none",title:"Alle verbergen",children:f.jsx(Vv,{size:14})})]})]}),f.jsx(An,{children:N&&f.jsx(wt.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden border-b border-purple-100",children:f.jsxs("div",{className:"px-4 py-3 bg-blue-50 space-y-3",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("span",{className:"text-sm font-medium text-blue-800",children:"Grid Assistent"}),f.jsx("button",{onClick:_,className:`px-3 py-1 text-xs rounded-full transition-colors border-0 outline-none ${y?"bg-blue-500 text-white":"bg-blue-200 text-blue-700"}`,children:y?"Aan":"Uit"})]}),f.jsx("div",{className:"flex items-center gap-2",children:f.jsxs("button",{onClick:x,className:"flex-1 px-3 py-2 bg-blue-500 hover:bg-blue-600 text-white text-sm rounded-lg transition-colors border-0 outline-none flex items-center justify-center gap-2",children:[f.jsx(jv,{size:14}),"Centreer op mijn locatie"]})}),f.jsxs("div",{className:"space-y-1",children:[f.jsxs("label",{className:"text-xs text-blue-700",children:["Celgrootte: ",w,"m"]}),f.jsx("input",{type:"range",min:"5",max:"50",step:"5",value:w,onChange:ye=>b(Number(ye.target.value)),className:"w-full h-2 bg-blue-200 rounded-lg appearance-none cursor-pointer"}),f.jsxs("div",{className:"flex justify-between text-xs text-blue-600",children:[f.jsx("span",{children:"5m"}),f.jsx("span",{children:"50m"})]})]}),f.jsx("p",{className:"text-xs text-blue-600",children:"Gebruik het grid om systematisch een veld af te zoeken. Elk vak heeft een label (A1, B2, etc.) voor referentie."})]})})}),f.jsx(An,{children:j&&f.jsx(wt.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden border-b border-purple-100",children:f.jsxs("div",{className:"px-4 py-3 bg-green-50 space-y-3",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("span",{className:"text-sm font-medium text-green-800",children:"Auto-pauze"}),f.jsx("button",{onClick:()=>k(!T),className:`px-3 py-1 text-xs rounded-full transition-colors border-0 outline-none ${T?"bg-green-500 text-white":"bg-green-200 text-green-700"}`,children:T?"Aan":"Uit"})]}),f.jsxs("div",{className:"space-y-1",children:[f.jsxs("label",{className:"text-xs text-green-700",children:["Pauze na: ",L<60?`${L}s`:`${Math.floor(L/60)}m ${L%60}s`]}),f.jsx("input",{type:"range",min:"30",max:"300",step:"30",value:L,onChange:ye=>O(Number(ye.target.value)),className:"w-full h-2 bg-green-200 rounded-lg appearance-none cursor-pointer"}),f.jsxs("div",{className:"flex justify-between text-xs text-green-600",children:[f.jsx("span",{children:"30s"}),f.jsx("span",{children:"5min"})]})]}),f.jsxs("p",{className:"text-xs text-green-600",children:["De opname pauzeert automatisch als je langer dan ",L<60?`${L} seconden`:`${Math.floor(L/60)} minuten`," stilstaat. Ideaal voor pauzes tijdens het detecteren."]})]})})}),f.jsx("div",{className:"flex-1 overflow-y-auto p-3 space-y-2",children:r.length===0?f.jsxs("div",{className:"text-center py-12 text-gray-500",children:[f.jsx(Gv,{size:48,className:"mx-auto mb-3 text-gray-300"}),f.jsx("p",{className:"font-medium",children:"Nog geen routes"}),f.jsx("p",{className:"text-sm mt-1",children:"Start een opname om je eerste route vast te leggen"})]}):r.map(ye=>f.jsxs(wt.div,{layout:!0,className:"bg-gray-50 rounded-lg p-3 flex gap-3",children:[f.jsx(MTe,{route:ye,size:70}),f.jsxs("div",{className:"flex-1 min-w-0",children:[R===ye.id?f.jsx("input",{type:"text",value:P,onChange:pe=>D(pe.target.value),onKeyDown:pe=>{pe.key==="Enter"&&J(ye.id),pe.key==="Escape"&&A(null)},onBlur:()=>J(ye.id),className:"w-full px-2 py-1 text-sm bg-white border border-purple-300 rounded outline-none focus:ring-2 focus:ring-purple-400",autoFocus:!0}):f.jsx("h3",{className:"font-medium text-gray-800 truncate",children:ye.name}),f.jsx("div",{className:"flex items-center gap-3 mt-1 text-xs text-gray-500",children:f.jsxs("span",{className:"flex items-center gap-1",children:[f.jsx(NI,{size:12}),cD(ye.createdAt)]})}),f.jsxs("div",{className:"flex items-center gap-3 mt-1 text-xs text-gray-600",children:[f.jsxs("span",{className:"flex items-center gap-1",children:[f.jsx(e1,{size:12}),Yb(ye.totalDistance)]}),f.jsxs("span",{className:"flex items-center gap-1",children:[f.jsx(Dv,{size:12}),Zb(ye.totalDuration)]}),f.jsxs("span",{children:[ye.points.length," punten"]})]})]}),f.jsxs("div",{className:"flex flex-col gap-1",children:[f.jsx("button",{onClick:()=>he(ye.id),className:`p-1.5 rounded transition-colors border-0 outline-none ${o.has(ye.id)?"bg-purple-100 text-purple-600":"text-gray-400 hover:text-purple-600 hover:bg-purple-50"}`,title:o.has(ye.id)?"Verbergen op kaart":"Tonen op kaart",children:o.has(ye.id)?f.jsx(Bv,{size:16}):f.jsx(Vv,{size:16})}),f.jsx("button",{onClick:()=>V(ye),className:"p-1.5 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none",title:"Naam wijzigen",children:f.jsx(eg,{size:16})}),f.jsx("button",{onClick:()=>ue(ye),className:"p-1.5 text-gray-400 hover:text-cyan-600 hover:bg-cyan-50 rounded transition-colors border-0 outline-none",title:"Details & foto's",children:f.jsx(OI,{size:16})}),f.jsx("button",{onClick:()=>je(ye),className:"p-1.5 text-gray-400 hover:text-orange-600 hover:bg-orange-50 rounded transition-colors border-0 outline-none",title:"Hoogteprofiel",children:f.jsx(Q0,{size:16})}),f.jsx("button",{onClick:()=>be(ye),className:"p-1.5 text-gray-400 hover:text-pink-600 hover:bg-pink-50 rounded transition-colors border-0 outline-none",title:"Delen",children:f.jsx(Tue,{size:16})}),f.jsx("button",{onClick:()=>oz(ye),className:"p-1.5 text-gray-400 hover:text-green-600 hover:bg-green-50 rounded transition-colors border-0 outline-none",title:"Exporteer als GPX",children:f.jsx(Fv,{size:16})}),f.jsx("button",{onClick:()=>te(ye),className:"p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors border-0 outline-none",title:"Verwijderen",children:f.jsx(_c,{size:16})})]})]},ye.id))}),f.jsxs("div",{className:"px-4 py-3 border-t border-gray-100 space-y-2",children:[f.jsx("input",{ref:Ne,type:"file",accept:".gpx",onChange:ie,className:"hidden"}),f.jsxs("button",{onClick:()=>Ne.current?.click(),className:"w-full px-3 py-2 text-purple-600 hover:bg-purple-50 rounded-lg transition-colors border-0 outline-none text-sm flex items-center justify-center gap-2",children:[f.jsx(Z1,{size:16}),"GPX bestand importeren"]}),r.length>0&&f.jsx("button",{onClick:re,className:"w-full px-3 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none text-sm",children:"Alle routes verwijderen"})]})]})]})}),f.jsx(An,{children:ce&&f.jsx(ITe,{route:ce,onClose:()=>je(null)})}),f.jsx(An,{children:Pe&&f.jsx(NTe,{route:Pe,onClose:()=>ue(null)})})]})}const Jb={lat:52.1326,lon:5.2913};function uz({code:n,size:e=18}){return n===0?f.jsx(jue,{size:e,className:"text-yellow-500"}):n>=1&&n<=3?f.jsx(hc,{size:e,className:"text-gray-400"}):n===45||n===48?f.jsx(Yle,{size:e,className:"text-gray-400"}):n>=51&&n<=67||n>=80&&n<=82?f.jsx(MI,{size:e,className:"text-blue-500"}):n>=71&&n<=77||n>=85&&n<=86?f.jsx(rce,{size:e,className:"text-cyan-500"}):n>=95?f.jsx(Jle,{size:e,className:"text-purple-500"}):f.jsx(hc,{size:e,className:"text-gray-400"})}function OTe({degrees:n,size:e=14}){return f.jsx("div",{style:{transform:`rotate(${n+180}deg)`},className:"inline-flex",children:f.jsx(Y1,{size:e,className:"text-blue-500"})})}function DTe({data:n}){if(!n||n.length===0)return null;const e=Math.max(...n.map(r=>r.precipitation),.5),t=n.some(r=>r.precipitation>0);return f.jsxs("div",{className:"space-y-1",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("span",{className:"text-[10px] text-gray-500",children:"Neerslag 2 uur"}),!t&&f.jsx("span",{className:"text-[10px] text-green-600 font-medium",children:"Droog"})]}),f.jsxs("div",{className:"relative h-8 bg-gray-100 rounded-lg overflow-hidden",children:[f.jsx("div",{className:"absolute inset-0 flex items-end px-0.5",children:n.map((r,i)=>{const s=r.precipitation/e*100,a=r.precipitation>2?"bg-blue-600":r.precipitation>.5?"bg-blue-500":r.precipitation>0?"bg-blue-400":"bg-transparent";return f.jsx("div",{className:"flex-1 mx-px",children:f.jsx("div",{className:`w-full rounded-t transition-all ${a}`,style:{height:`${Math.max(s,r.precipitation>0?8:0)}%`}})},i)})}),f.jsxs("div",{className:"absolute bottom-0 left-0 right-0 flex justify-between px-1 text-[8px] text-gray-400",children:[f.jsx("span",{children:"Nu"}),f.jsx("span",{children:"+1u"}),f.jsx("span",{children:"+2u"})]})]})]})}function jTe({pollen:n}){const e=[{name:"Gras",value:n.grass},{name:"Berk",value:n.birch},{name:"Els",value:n.alder},{name:"Bijvoet",value:n.mugwort}].filter(i=>i.value>0).sort((i,s)=>s.value-i.value);if(e.length===0)return f.jsxs("div",{className:"flex items-center gap-1.5 text-[10px] text-green-600",children:[f.jsx(V5,{size:12}),f.jsx("span",{children:"Lage pollenconcentratie"})]});const t=e[0],r=t.value>=4?"text-red-500":t.value>=3?"text-orange-500":t.value>=2?"text-amber-500":"text-green-600";return f.jsxs("div",{className:`flex items-center gap-1.5 text-[10px] ${r}`,children:[f.jsx(V5,{size:12}),f.jsxs("span",{children:[t.name,": ",t.value>=4?"Zeer hoog":t.value>=3?"Hoog":t.value>=2?"Matig":"Laag"]})]})}function FTe({hourly:n}){const e=n.slice(0,6);return e.length===0?null:f.jsxs("div",{className:"space-y-1",children:[f.jsx("div",{className:"text-[10px] text-gray-500",children:"Komende uren"}),f.jsx("div",{className:"flex gap-1",children:e.map((t,r)=>{const i=new Date(t.time),s=r===0;return f.jsxs("div",{className:`flex flex-col items-center p-1.5 rounded-lg flex-1 ${s?"bg-blue-100":"bg-gray-50"}`,children:[f.jsx("span",{className:"text-[9px] text-gray-500",children:s?"Nu":`${i.getHours()}u`}),f.jsx(uz,{code:t.weatherCode,size:14}),f.jsxs("span",{className:"text-[10px] font-medium",children:[Math.round(t.temperature),""]})]},t.time)})})]})}function VTe(){const n=dn(g=>g.showWeatherButton),e=ls(),t=Zm(),[r,i]=H.useState(!1),s=Zm(g=>g.showBuienradar),a=Zm(g=>g.setShowBuienradar);if(H.useEffect(()=>{s&&i(!1)},[s]),H.useEffect(()=>{if(!n)return;const g=e.position||Jb;(!t.weatherData||Date.now()-t.weatherData.lastUpdated>600*1e3)&&t.fetchWeather(g.lat,g.lon)},[n,e.position?.lat]),H.useEffect(()=>{if(!n)return;const g=setInterval(()=>{const m=e.position||Jb;t.fetchWeather(m.lat,m.lon)},600*1e3);return()=>clearInterval(g)},[n,e.position?.lat]),!n)return null;const o=t.weatherData?.current,l=t.weatherData?.hourly||[],c=t.weatherData?.precipitation15min||[],h=t.weatherData?.pollen;return f.jsxs(f.Fragment,{children:[r&&f.jsx("div",{className:"fixed inset-0 z-[1099]",onClick:()=>i(!1)}),f.jsx(wt.div,{className:"fixed left-2 z-[1100] bg-white shadow-lg border border-gray-200 select-none rounded-xl",style:{top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))",width:r?"200px":"auto",maxWidth:"200px"},initial:{opacity:0,x:-20},animate:{opacity:1,x:0},layout:!0,children:t.isLoading&&!o?f.jsxs("div",{className:"p-3 flex items-center gap-2",children:[f.jsx(uue,{size:16,className:"animate-spin text-blue-500"}),f.jsx("span",{className:"text-sm text-gray-500",children:"Laden..."})]}):o?f.jsxs("div",{className:"p-2.5",children:[f.jsxs("button",{onClick:()=>i(!r),className:"w-full border-0 outline-none bg-transparent p-0",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(uz,{code:o.weatherCode,size:24}),f.jsx("div",{className:"flex flex-col leading-tight",children:f.jsxs("span",{className:"text-lg font-bold text-gray-800",children:[Math.round(o.temperature),""]})})]}),f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx(G5,{size:14,className:"text-gray-400"}),f.jsx("span",{className:"text-sm text-gray-600",children:Math.round(o.windSpeed)}),f.jsx(OTe,{degrees:o.windDirection,size:12})]}),f.jsx("div",{className:"ml-auto",children:r?f.jsx(AE,{size:16,className:"text-gray-400"}):f.jsx(pg,{size:16,className:"text-gray-400"})})]}),f.jsxs("div",{className:"text-[11px] text-gray-500 text-left mt-1",children:[Xre[o.weatherCode]||"Onbekend",f.jsxs("span",{className:"text-gray-400 ml-1",children:[" ",Math.round(o.apparentTemperature),""]})]})]}),f.jsx(An,{children:r&&f.jsx(wt.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:f.jsxs("div",{className:"pt-2 mt-2 border-t border-gray-200/50 space-y-3",children:[f.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[f.jsxs("div",{className:"bg-blue-50 rounded-lg p-2",children:[f.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-gray-500",children:[f.jsx(dce,{size:12,className:"text-blue-500"}),f.jsx("span",{children:"Vocht"})]}),f.jsxs("div",{className:"text-sm font-bold text-blue-600",children:[o.humidity,"%"]})]}),f.jsxs("div",{className:"bg-gray-50 rounded-lg p-2",children:[f.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-gray-500",children:[f.jsx(G5,{size:12,className:"text-gray-500"}),f.jsx("span",{children:"Windstoten"})]}),f.jsxs("div",{className:"text-sm font-bold text-gray-600",children:[Math.round(o.windGusts)," km/u"]})]}),f.jsxs("div",{className:"bg-cyan-50 rounded-lg p-2",children:[f.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-gray-500",children:[f.jsx(Y1,{size:12,className:"text-cyan-500"}),f.jsx("span",{children:"Wind"})]}),f.jsx("div",{className:"text-sm font-bold text-cyan-600",children:qre(o.windDirection)})]}),f.jsxs("div",{className:"bg-purple-50 rounded-lg p-2",children:[f.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-gray-500",children:[f.jsx(hc,{size:12,className:"text-purple-500"}),f.jsx("span",{children:"Bewolking"})]}),f.jsxs("div",{className:"text-sm font-bold text-purple-600",children:[o.cloudCover,"%"]})]})]}),f.jsxs("button",{onClick:()=>a(!s),className:`w-full flex items-center gap-2 p-2 rounded-lg transition-colors border-0 cursor-pointer ${s?"bg-blue-500 hover:bg-blue-600":"bg-blue-50 hover:bg-blue-100"}`,children:[f.jsx(MI,{size:16,className:s?"text-white":"text-blue-500"}),f.jsx("span",{className:`text-sm font-medium ${s?"text-white":"text-blue-700"}`,children:"Buienradar"}),f.jsx("span",{className:`text-xs ml-auto ${s?"text-blue-100":"text-blue-500"}`,children:s?"Aan":"Uit"})]}),c.length>0&&f.jsx(DTe,{data:c}),l.length>0&&f.jsx(FTe,{hourly:l}),h&&f.jsx(jTe,{pollen:h}),f.jsxs("div",{className:"text-[9px] text-gray-400 text-center pt-1",children:["Bijgewerkt: ",new Date(t.weatherData.lastUpdated).toLocaleTimeString("nl-NL",{hour:"2-digit",minute:"2-digit"})]})]})})})]}):f.jsxs("button",{onClick:()=>{const g=e.position||Jb;t.fetchWeather(g.lat,g.lon)},className:"p-3 flex items-center gap-2 border-0 outline-none bg-transparent",children:[f.jsx(hc,{size:18,className:"text-gray-400"}),f.jsx("span",{className:"text-sm text-gray-500",children:"Weer laden"})]})})]})}function BTe({isVisible:n,onClose:e}){const t=Xr(O=>O.map),r=H.useRef(null),i=H.useRef(null),[s,a]=H.useState([]),[o,l]=H.useState(0),[c,h]=H.useState(!0),[g,m]=H.useState(!0),[y,_]=H.useState("normal"),[x,w]=H.useState(70),b=y==="slow"?800:y==="normal"?500:250,T=H.useCallback(async()=>{m(!0);try{const B=await(await fetch("https://api.rainviewer.com/public/weather-maps.json")).json(),R=[];B.radar?.past&&B.radar.past.forEach(P=>{R.push({path:P.path,time:P.time*1e3})}),B.radar?.nowcast&&B.radar.nowcast.forEach(P=>{R.push({path:P.path,time:P.time*1e3})}),a(R);const A=B.radar?.past?.length?B.radar.past.length-1:0;l(A)}catch(O){console.error("Failed to fetch radar data:",O)}finally{m(!1)}},[]);H.useEffect(()=>{if(n){T();const O=setInterval(T,300*1e3);return()=>clearInterval(O)}},[n,T]),H.useEffect(()=>{if(!t||!n||s.length===0)return;const O=s[o];if(!O)return;const B=`https://tilecache.rainviewer.com${O.path}/256/{z}/{x}/{y}/2/1_1.png`;if(r.current){const R=r.current.getSource();R&&(R.setUrl(B),R.refresh())}else{const R=new Lh({url:B,crossOrigin:"anonymous"}),A=new iu({source:R,opacity:x/100,zIndex:1500,properties:{name:"rain-radar-layer",title:"Buienradar"}});r.current=A,t.addLayer(A)}return()=>{}},[t,n,s,o]),H.useEffect(()=>{r.current&&r.current.setOpacity(x/100)},[x]),H.useEffect(()=>{!n&&r.current&&t&&(t.removeLayer(r.current),r.current=null)},[n,t]),H.useEffect(()=>()=>{r.current&&t&&(t.removeLayer(r.current),r.current=null),i.current&&clearInterval(i.current)},[t]),H.useEffect(()=>{if(!c||s.length===0||!n){i.current&&(clearInterval(i.current),i.current=null);return}return i.current=setInterval(()=>{l(O=>(O+1)%s.length)},b),()=>{i.current&&(clearInterval(i.current),i.current=null)}},[c,s.length,b,n]);const k=H.useCallback(()=>{if(s.length===0||!s[o])return"--:--";const O=s[o].time,B=Date.now(),R=Math.round((O-B)/6e4),P=new Date(O).toLocaleTimeString("nl-NL",{hour:"2-digit",minute:"2-digit"});return Math.abs(R)<3?`${P} (nu)`:R<0?`${P} (${R}m)`:`${P} (+${R}m)`},[s,o]),L=O=>{h(!1),l(B=>O==="prev"?B>0?B-1:s.length-1:(B+1)%s.length)};return n?f.jsx(An,{children:f.jsxs(wt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},className:"fixed bottom-4 left-2 right-2 z-[1600] bg-white/95 backdrop-blur-sm rounded-xl shadow-xl border border-gray-200",style:{maxWidth:"400px",margin:"0 auto"},children:[f.jsxs("div",{className:"flex items-center justify-between px-3 py-1.5 border-b border-gray-100",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(MI,{size:14,className:"text-blue-500"}),f.jsx("span",{className:"text-xs font-medium text-gray-700",children:g?"Laden...":k()})]}),f.jsx("button",{onClick:e,className:"p-1 hover:bg-gray-100 rounded transition-colors border-0 outline-none bg-transparent",children:f.jsx(Sr,{size:14,className:"text-gray-500"})})]}),f.jsxs("div",{className:"px-3 py-2 flex items-center gap-2",children:[f.jsxs("div",{className:"flex items-center gap-0.5",children:[f.jsx("button",{onClick:()=>L("prev"),className:"p-1.5 hover:bg-gray-100 rounded transition-colors border-0 outline-none bg-transparent",children:f.jsx(uV,{size:14,className:"text-gray-600"})}),f.jsx("button",{onClick:()=>h(!c),className:`p-1.5 rounded transition-colors border-0 outline-none ${c?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-600"}`,children:c?f.jsx(pV,{size:14}):f.jsx(xV,{size:14})}),f.jsx("button",{onClick:()=>L("next"),className:"p-1.5 hover:bg-gray-100 rounded transition-colors border-0 outline-none bg-transparent",children:f.jsx(yg,{size:14,className:"text-gray-600"})})]}),f.jsxs("div",{className:"flex-1 flex items-center gap-1",children:[f.jsx("span",{className:"text-[9px] text-gray-400 w-6",children:"-2u"}),f.jsx("input",{type:"range",min:"0",max:Math.max(0,s.length-1),value:o,onChange:O=>{h(!1),l(parseInt(O.target.value))},className:"flex-1 h-1.5 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500"}),f.jsx("span",{className:"text-[9px] text-gray-400 w-8 text-right",children:"+30m"})]}),f.jsx("div",{className:"flex items-center gap-0.5 bg-gray-100 rounded p-0.5",children:["slow","normal","fast"].map(O=>f.jsxs("button",{onClick:()=>_(O),className:`px-1.5 py-0.5 text-[9px] rounded transition-colors border-0 outline-none ${y===O?"bg-white text-blue-600 shadow-sm":"text-gray-500 bg-transparent"}`,children:[O==="slow"?"":O==="normal"?"1":"2",""]},O))})]}),f.jsxs("div",{className:"px-3 py-1.5 flex items-center gap-2 border-t border-gray-100",children:[f.jsx("span",{className:"text-[10px] text-gray-500 w-14",children:"Dekking"}),f.jsx("input",{type:"range",min:"10",max:"100",value:x,onChange:O=>w(parseInt(O.target.value)),className:"flex-1 h-1.5 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500"}),f.jsxs("span",{className:"text-[10px] text-gray-500 w-8 text-right",children:[x,"%"]})]}),f.jsxs("div",{className:"px-3 pb-1.5 flex items-center justify-center gap-1.5",children:[f.jsx("span",{className:"text-[8px] text-gray-400",children:"Licht"}),f.jsxs("div",{className:"flex h-1.5 rounded overflow-hidden",children:[f.jsx("div",{className:"w-3",style:{backgroundColor:"#88D0F3"}}),f.jsx("div",{className:"w-3",style:{backgroundColor:"#32B8A4"}}),f.jsx("div",{className:"w-3",style:{backgroundColor:"#F4E61F"}}),f.jsx("div",{className:"w-3",style:{backgroundColor:"#F09D1C"}}),f.jsx("div",{className:"w-3",style:{backgroundColor:"#E12E18"}})]}),f.jsx("span",{className:"text-[8px] text-gray-400",children:"Zwaar"})]})]})}):null}const uD={Munt:"#f59e0b",Aardewerk:"#a16207",Gesp:"#6b7280",Fibula:"#8b5cf6",Ring:"#ec4899",Speld:"#6366f1",Sieraad:"#f43f5e",Gereedschap:"#64748b",Wapen:"#ef4444",Anders:"#3b82f6"},GTe={Munt:"M",Aardewerk:"A",Gesp:"G",Fibula:"F",Ring:"R",Speld:"S",Sieraad:"Si",Gereedschap:"Gr",Wapen:"W",Anders:"?"};function zTe(){const n=Xr(i=>i.map),e=ul(i=>i.vondsten),t=dn(i=>i.showLocalVondsten),r=H.useRef(null);return H.useEffect(()=>{if(!n)return;const i=new xl;return e.forEach(s=>{const a=new vr({geometry:new mi(Ir([s.location.lng,s.location.lat])),vondst:s}),o=uD[s.objectType]||uD.Anders,l=GTe[s.objectType]||"?";a.setStyle((c,h)=>{let _=12;h>50?_=6:h>10?_=Math.max(6,12-(h-10)/10):h<2&&(_=14);const x=Math.max(8,Math.min(12,_-2));return new gn({image:new Us({radius:_,fill:new Jn({color:o}),stroke:new Hn({color:"#ffffff",width:_>8?2:1})}),text:_>=8?new yo({text:l,font:`bold ${x}px sans-serif`,fill:new Jn({color:"#ffffff"}),offsetY:1}):void 0})}),i.addFeature(a)}),r.current?r.current.setSource(i):(r.current=new pc({source:i,zIndex:1e3,properties:{title:"Mijn Vondsten"}}),r.current.setVisible(t),n.addLayer(r.current)),()=>{r.current&&n&&(n.removeLayer(r.current),r.current=null)}},[n,e]),H.useEffect(()=>{r.current&&r.current.setVisible(t)},[t]),null}const UTe={Mineraal:"M",Fossiel:"F",Erfgoed:"E",Monument:"Mo",Overig:""};function $Te(n){const{type:e,coordinates:t}=n,r=s=>typeof s[0]=="number"?Ir(s):s.map(r),i=r(t);switch(e){case"Point":return new mi(i);case"LineString":return new bi(i);case"Polygon":return new Ua(i);case"MultiPoint":return new Nd(i);case"MultiLineString":return new ic(i);case"MultiPolygon":return new cd(i);default:return new mi(Ir(t))}}function WTe(){const n=Xr(i=>i.map),e=Hi(i=>i.layers),t=dn(i=>i.showCustomPointLayers),r=H.useRef(new Map);return H.useEffect(()=>{if(!n)return;const i=new Set(e.map(s=>s.id));return r.current.forEach((s,a)=>{i.has(a)||(n.removeLayer(s),r.current.delete(a))}),e.forEach(s=>{const a=new xl;s.points.forEach(l=>{let c;const h=l.geometry&&l.geometry.type!=="Point";l.geometry?c=$Te(l.geometry):c=new mi(Ir(l.coordinates));const g=new vr({geometry:c,layerType:"customPoint",customPoint:l,customLayerId:s.id,customLayerName:s.name,customLayerColor:s.color}),m=UTe[l.category]||l.category.charAt(0).toUpperCase();if(h){const y=l.geometry.type;g.setStyle(()=>y==="Polygon"||y==="MultiPolygon"?new gn({fill:new Jn({color:s.color+"40"}),stroke:new Hn({color:s.color,width:2})}):y==="LineString"||y==="MultiLineString"?new gn({stroke:new Hn({color:s.color,width:3})}):new gn({image:new Us({radius:8,fill:new Jn({color:s.color}),stroke:new Hn({color:"#ffffff",width:2})})}))}else g.setStyle((y,_)=>{let T=12;_>50?T=6:_>10?T=Math.max(6,12-(_-10)/10):_<2&&(T=14);const k=Math.max(8,Math.min(12,T-2));return new gn({image:new Us({radius:T,fill:new Jn({color:s.color}),stroke:new Hn({color:"#ffffff",width:T>8?2:1})}),text:T>=8?new yo({text:m,font:`bold ${k}px sans-serif`,fill:new Jn({color:"#ffffff"}),offsetY:1}):void 0})});a.addFeature(g)});const o=r.current.get(s.id);if(o)o.setSource(a),o.setVisible(t&&s.visible);else{const l=new pc({source:a,zIndex:950,properties:{title:s.name,customPointLayerId:s.id},visible:t&&s.visible});n.addLayer(l),r.current.set(s.id,l)}}),()=>{r.current.forEach(s=>{n&&n.removeLayer(s)}),r.current.clear()}},[n,e,t]),null}function HTe(){const{createLayerModalOpen:n,closeCreateLayerModal:e}=ur(),{addLayer:t}=Hi(),r=dn(),[i,s]=H.useState(""),[a,o]=H.useState([...su]),[l,c]=H.useState(""),h=14*r.fontScale/100,g=()=>{const w=l.trim();w&&!a.includes(w)&&(o([...a,w]),c(""))},m=w=>{o(a.filter(b=>b!==w))},y=w=>{a.includes(w)?o(a.filter(b=>b!==w)):o([...a,w])},_=()=>{i.trim()&&(t(i.trim(),a),s(""),o([...su]),c(""),e())},x=()=>{s(""),o([...su]),c(""),e()};return f.jsx(An,{children:n&&f.jsxs(f.Fragment,{children:[f.jsx(wt.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:x}),f.jsxs(wt.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-sm mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[f.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(Va,{size:18}),f.jsx("span",{className:"font-medium",children:"Nieuwe laag"})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"text-[10px] opacity-70",children:"T"}),f.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:r.fontScale,onChange:w=>r.setFontScale(parseInt(w.target.value)),className:"header-slider w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${r.fontScale}%`}),f.jsx("span",{className:"text-xs opacity-70",children:"T"}),f.jsx("button",{onClick:x,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none ml-1",children:f.jsx(Sr,{size:18})})]})]}),f.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",style:{fontSize:`${h}px`},children:[f.jsxs("div",{children:[f.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Naam van de laag"}),f.jsx("input",{type:"text",value:i,onChange:w=>s(w.target.value),placeholder:"bijv. Vakantie Frankrijk 2026",className:"w-full px-3 py-2 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors",style:{fontSize:"1em"},autoFocus:!0})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block font-medium text-gray-700 mb-2",style:{fontSize:"0.9em"},children:"Categorien"}),f.jsx("div",{className:"flex flex-wrap gap-2",children:su.map(w=>f.jsx("button",{onClick:()=>y(w),className:`px-3 py-1 rounded-full transition-colors border-0 outline-none ${a.includes(w)?"bg-orange-500 text-white":"bg-white text-gray-600 hover:bg-blue-50"}`,style:{fontSize:"0.9em"},children:w},w))})]}),a.filter(w=>!su.includes(w)).length>0&&f.jsxs("div",{children:[f.jsx("label",{className:"block font-medium text-gray-700 mb-2",style:{fontSize:"0.9em"},children:"Eigen categorien"}),f.jsx("div",{className:"flex flex-wrap gap-2",children:a.filter(w=>!su.includes(w)).map(w=>f.jsxs("div",{className:"flex items-center",children:[f.jsx("button",{onClick:()=>y(w),className:"px-3 py-1 rounded-l-full bg-orange-500 text-white hover:bg-orange-600 transition-colors border-0 outline-none",style:{fontSize:"0.9em"},children:w}),f.jsx("button",{onClick:()=>m(w),className:"px-2 py-1 rounded-r-full bg-orange-600 text-white hover:bg-orange-700 transition-colors border-0 outline-none",title:"Verwijder categorie",children:f.jsx(_c,{size:12})})]},w))})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Eigen categorie toevoegen"}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("input",{type:"text",value:l,onChange:w=>c(w.target.value),placeholder:"bijv. Grot, Bron, ...",className:"flex-1 px-3 py-2 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors",style:{fontSize:"1em"},onKeyDown:w=>w.key==="Enter"&&g()}),f.jsx("button",{onClick:g,disabled:!l.trim(),className:"px-3 py-2 bg-white hover:bg-blue-50 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg transition-colors border-0 outline-none text-gray-600",children:f.jsx(Wa,{size:20})})]})]})]}),f.jsxs("div",{className:"p-4 flex gap-3",style:{fontSize:`${h}px`},children:[f.jsx("button",{onClick:x,className:"flex-1 px-4 py-2 bg-white hover:bg-blue-50 rounded-lg transition-colors border-0 outline-none text-gray-600",style:{fontSize:"1em"},children:"Annuleren"}),f.jsx("button",{onClick:_,disabled:!i.trim(),className:"flex-1 px-4 py-2 bg-orange-500 hover:bg-orange-600 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-lg transition-colors border-0 outline-none",style:{fontSize:"1em"},children:"Aanmaken"})]})]})]})})}const hz=200,KTe=.7;async function XTe(n,e=hz){return new Promise((t,r)=>{const i=new Image,s=document.createElement("canvas"),a=s.getContext("2d");i.onload=()=>{let o=i.width,l=i.height;o>l?o>e&&(l=Math.round(l*e/o),o=e):l>e&&(o=Math.round(o*e/l),l=e),s.width=o,s.height=l,a?.drawImage(i,0,0,o,l),s.toBlob(c=>{c?t(c):r(new Error("Failed to create blob from canvas"))},"image/jpeg",KTe)},i.onerror=()=>r(new Error("Failed to load image")),i.src=URL.createObjectURL(n)})}function qTe(n){return new Promise((e,t)=>{const r=new FileReader;r.onloadend=()=>{typeof r.result=="string"?e(r.result):t(new Error("Failed to convert blob to base64"))},r.onerror=()=>t(new Error("Failed to read blob")),r.readAsDataURL(n)})}async function YTe(n){const e=await XTe(n,hz),t=await qTe(e);return{thumbnailBlob:e,thumbnailBase64:t}}function ZTe(){return`photo_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}const Qb=5;function JTe({photos:n,onAddPhoto:e,onRemovePhoto:t,disabled:r}){const i=H.useRef(null),s=H.useRef(null),a=async l=>{const c=l.target.files;if(!c||c.length===0)return;const h=Qb-n.length,g=Array.from(c).slice(0,h);for(const m of g)try{const{thumbnailBase64:y}=await YTe(m),_={id:ZTe(),thumbnailBase64:y,createdAt:new Date().toISOString(),pendingUpload:!0};e(_)}catch(y){console.error("Failed to process image:",y)}l.target.value=""},o=n.length<Qb;return f.jsxs("div",{className:"space-y-2",children:[f.jsxs("label",{className:"block font-medium text-gray-700",style:{fontSize:"0.9em"},children:["Foto's (",n.length,"/",Qb,")"]}),f.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.map(l=>f.jsxs("div",{className:"relative w-16 h-16 rounded-lg overflow-hidden bg-gray-100 border border-gray-200",children:[f.jsx("img",{src:l.thumbnailUrl||l.thumbnailBase64,alt:"Foto",className:"w-full h-full object-cover"}),!r&&f.jsx("button",{type:"button",onClick:()=>t(l.id),className:"absolute top-0.5 right-0.5 w-5 h-5 bg-red-500 rounded-full flex items-center justify-center border-0 outline-none",children:f.jsx(Sr,{size:12,className:"text-white"})}),l.pendingUpload&&f.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-orange-500/80 text-white text-center py-0.5",style:{fontSize:"0.6em"},children:"Wacht..."})]},l.id)),o&&!r&&f.jsxs(f.Fragment,{children:[f.jsxs("button",{type:"button",onClick:()=>s.current?.click(),className:"w-16 h-16 rounded-lg border-2 border-dashed border-gray-300 hover:border-orange-400 hover:bg-orange-50 flex flex-col items-center justify-center gap-1 transition-colors bg-transparent outline-none",title:"Maak foto",children:[f.jsx(RE,{size:20,className:"text-gray-400"}),f.jsx("span",{className:"text-gray-400",style:{fontSize:"0.6em"},children:"Camera"})]}),f.jsxs("button",{type:"button",onClick:()=>i.current?.click(),className:"w-16 h-16 rounded-lg border-2 border-dashed border-gray-300 hover:border-orange-400 hover:bg-orange-50 flex flex-col items-center justify-center gap-1 transition-colors bg-transparent outline-none",title:"Kies foto",children:[f.jsx(Dce,{size:20,className:"text-gray-400"}),f.jsx("span",{className:"text-gray-400",style:{fontSize:"0.6em"},children:"Gallerij"})]})]})]}),f.jsx("input",{ref:s,type:"file",accept:"image/*",capture:"environment",onChange:a,className:"hidden"}),f.jsx("input",{ref:i,type:"file",accept:"image/*",multiple:!0,onChange:a,className:"hidden"})]})}function QTe(){const{addPointModalOpen:n,addPointModalLayerId:e,addPointModalLocation:t,closeAddPointModal:r}=ur(),{addPoint:i,getLayer:s}=Hi(),a=dn(),[o,l]=H.useState(""),[c,h]=H.useState(""),[g,m]=H.useState(""),[y,_]=H.useState([]),x=e?s(e):null,w=14*a.fontScale/100,b=()=>{!o.trim()||!e||!t||(i(e,{name:o.trim(),category:"Overig",notes:c.trim(),url:g.trim()||void 0,coordinates:[t.lng,t.lat],photos:y.length>0?y:void 0}),l(""),h(""),m(""),_([]),r())},T=()=>{l(""),h(""),m(""),_([]),r()};return x?f.jsx(An,{children:n&&f.jsxs(f.Fragment,{children:[f.jsx(wt.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:T}),f.jsxs(wt.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-sm mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[f.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(pa,{size:18}),f.jsx("span",{className:"font-medium",children:"Punt toevoegen"})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"text-[10px] opacity-70",children:"T"}),f.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:a.fontScale,onChange:k=>a.setFontScale(parseInt(k.target.value)),className:"header-slider w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${a.fontScale}%`}),f.jsx("span",{className:"text-xs opacity-70",children:"T"}),f.jsx("button",{onClick:T,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none ml-1",children:f.jsx(Sr,{size:18})})]})]}),f.jsx("div",{className:"px-4 py-1.5",children:f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:x.color}}),f.jsx("span",{className:"text-sm text-gray-600",children:x.name})]})}),f.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",style:{fontSize:`${w}px`},children:[f.jsxs("div",{children:[f.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Naam *"}),f.jsx("input",{type:"text",value:o,onChange:k=>l(k.target.value),className:"w-full px-3 py-1.5 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors",style:{fontSize:"1em"},autoFocus:!0})]}),f.jsx(JTe,{photos:y,onAddPhoto:k=>_([...y,k]),onRemovePhoto:k=>_(y.filter(L=>L.id!==k))}),f.jsxs("div",{children:[f.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Notities"}),f.jsx("textarea",{value:c,onChange:k=>h(k.target.value),placeholder:"Beschrijving, tips, opmerkingen...",rows:2,className:"w-full px-3 py-1.5 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors resize-none",style:{fontSize:"1em"}})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Link"}),f.jsx("input",{type:"url",value:g,onChange:k=>m(k.target.value),placeholder:"https://...",className:"w-full px-3 py-1.5 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors",style:{fontSize:"1em"}})]})]}),f.jsxs("div",{className:"p-3 flex gap-3",style:{fontSize:`${w}px`},children:[f.jsx("button",{onClick:T,className:"flex-1 px-4 py-1.5 bg-white hover:bg-blue-50 rounded-lg transition-colors border-0 outline-none text-gray-600",style:{fontSize:"1em"},children:"Annuleren"}),f.jsx("button",{onClick:b,disabled:!o.trim(),className:"flex-1 px-4 py-1.5 bg-orange-500 hover:bg-orange-600 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-lg transition-colors border-0 outline-none",style:{fontSize:"1em"},children:"Toevoegen"})]})]})]})}):null}function eRe(){const{layerManagerModalOpen:n,closeLayerManagerModal:e,openCreateLayerModal:t,openLayerDashboard:r}=ur(),{layers:i,removeLayer:s,toggleVisibility:a,toggleArchived:o,exportLayerAsGeoJSON:l,importLayerFromGeoJSON:c}=Hi(),h=dn(),g=14*h.fontScale/100,[m,y]=H.useState(null),[_,x]=H.useState(null),[w,b]=H.useState(null),[T,k]=H.useState(!1),L=i.filter(j=>!j.archived),O=i.filter(j=>j.archived),B=T?O:L,R=j=>{_===j?(s(j),x(null)):(x(j),setTimeout(()=>x(null),3e3))},A=j=>{l(j)},P=async j=>{const ve=j.target.files?.[0];if(ve){try{const ce=await ve.text(),je=c(ce);je.success||(b(je.error||"Import mislukt"),setTimeout(()=>b(null),3e3))}catch{b("Kon bestand niet lezen"),setTimeout(()=>b(null),3e3)}j.target.value=""}},D=()=>{y(null),x(null),b(null),k(!1),e()},N=j=>{r(j)},G=()=>{D(),t()};return f.jsx(An,{children:n&&f.jsxs(f.Fragment,{children:[f.jsx(wt.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:D}),f.jsxs(wt.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[f.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(Va,{size:18}),f.jsx("span",{className:"font-medium",children:"Mijn Lagen beheren"})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"text-[10px] opacity-70",children:"T"}),f.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:h.fontScale,onChange:j=>h.setFontScale(parseInt(j.target.value)),className:"header-slider w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${h.fontScale}%`}),f.jsx("span",{className:"text-xs opacity-70",children:"T"}),f.jsx("button",{onClick:D,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none ml-1",children:f.jsx(Sr,{size:18})})]})]}),f.jsxs("div",{className:"flex border-b border-gray-100",children:[f.jsxs("button",{onClick:()=>k(!1),className:`flex-1 px-3 py-2 text-sm transition-colors border-0 outline-none ${T?"text-gray-500 hover:text-gray-700 hover:bg-gray-50":"text-orange-600 border-b-2 border-orange-500 bg-orange-50/50"}`,children:["Actief (",L.length,")"]}),f.jsxs("button",{onClick:()=>k(!0),className:`flex-1 px-3 py-2 text-sm transition-colors border-0 outline-none flex items-center justify-center gap-1 ${T?"text-orange-600 border-b-2 border-orange-500 bg-orange-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[f.jsx(oV,{size:14}),"Archief (",O.length,")"]})]}),f.jsxs("div",{className:"flex-1 overflow-y-auto",style:{fontSize:`${g}px`},children:[B.length===0?f.jsx("div",{className:"p-8 text-center text-gray-500",children:T?f.jsx("p",{style:{fontSize:"1em"},children:"Geen gearchiveerde lagen."}):f.jsxs(f.Fragment,{children:[f.jsx("p",{className:"mb-4",style:{fontSize:"1em"},children:"Je hebt nog geen eigen lagen."}),f.jsxs("button",{onClick:G,className:"px-4 py-2 bg-orange-500 hover:bg-orange-600 text-white rounded-lg transition-colors border-0 outline-none",style:{fontSize:"1em"},children:[f.jsx(Wa,{size:16,className:"inline mr-2"}),"Nieuwe laag aanmaken"]})]})}):f.jsx("div",{className:"divide-y divide-gray-100",children:B.map(j=>f.jsx(nRe,{layer:j,isExpanded:m===j.id,onToggleExpand:()=>y(m===j.id?null:j.id),onToggleVisibility:()=>a(j.id),onToggleArchived:()=>o(j.id),onOpenDashboard:()=>N(j.id),onExport:()=>A(j.id),onDelete:()=>R(j.id),confirmDelete:_===j.id,onRename:ve=>Hi.getState().updateLayer(j.id,{name:ve}),onChangeColor:ve=>Hi.getState().updateLayer(j.id,{color:ve})},j.id))}),w&&f.jsx("div",{className:"mx-4 my-2 p-3 bg-red-50 text-red-700 text-sm rounded-lg",children:w})]}),f.jsxs("div",{className:"p-4 flex gap-3",style:{fontSize:`${g}px`},children:[f.jsxs("label",{className:"flex-1 px-4 py-2 bg-white hover:bg-blue-50 rounded-lg transition-colors cursor-pointer flex items-center justify-center gap-2 border-0 outline-none text-gray-600",children:[f.jsx(Z1,{size:16}),f.jsx("span",{style:{fontSize:"1em"},children:"Importeren"}),f.jsx("input",{type:"file",accept:".geojson,.json",onChange:P,className:"hidden"})]}),f.jsxs("button",{onClick:G,className:"flex-1 px-4 py-2 bg-orange-500 hover:bg-orange-600 text-white rounded-lg transition-colors border-0 outline-none flex items-center justify-center gap-2",style:{fontSize:"1em"},children:[f.jsx(Wa,{size:16}),f.jsx("span",{children:"Nieuwe laag"})]})]})]})]})})}const tRe=["#ef4444","#f97316","#eab308","#22c55e","#06b6d4","#3b82f6","#8b5cf6","#ec4899"];function nRe({layer:n,isExpanded:e,onToggleExpand:t,onToggleVisibility:r,onToggleArchived:i,onOpenDashboard:s,onExport:a,onDelete:o,confirmDelete:l,onRename:c,onChangeColor:h}){const[g,m]=H.useState(!1),[y,_]=H.useState(n.name),[x,w]=H.useState(!1),b=H.useRef(null);H.useEffect(()=>{g&&b.current&&(b.current.focus(),b.current.select())},[g]);const T=()=>{_(n.name),m(!0)},k=()=>{const A=y.trim();A&&A!==n.name&&c(A),m(!1)},L=()=>{_(n.name),m(!1)},O=A=>{A.key==="Enter"?k():A.key==="Escape"&&L()},B=n.points.filter(A=>A.status==="completed").length,R=n.points.length;return f.jsxs("div",{className:"bg-white",children:[f.jsxs("div",{className:"flex items-center gap-3 px-4 py-3",children:[f.jsx("button",{onClick:t,className:"p-1 text-gray-400 hover:text-gray-600 transition-colors border-0 outline-none bg-transparent",children:e?f.jsx(pg,{size:16}):f.jsx(yg,{size:16})}),f.jsxs("div",{className:"relative",children:[f.jsx("button",{onClick:()=>w(!x),className:"w-5 h-5 rounded-full flex-shrink-0 border-2 border-white shadow-sm hover:scale-110 transition-transform cursor-pointer",style:{backgroundColor:n.color},title:"Kleur wijzigen"}),x&&f.jsx("div",{className:"absolute top-7 left-0 z-50 bg-white rounded-lg shadow-lg p-2 flex flex-wrap gap-1 w-24",children:tRe.map(A=>f.jsx("button",{onClick:()=>{h(A),w(!1)},className:`w-5 h-5 rounded-full border-2 hover:scale-110 transition-transform ${A===n.color?"border-gray-800":"border-white"}`,style:{backgroundColor:A}},A))})]}),g?f.jsxs("div",{className:"flex-1 min-w-0 flex items-center gap-2",children:[f.jsx("input",{ref:b,type:"text",value:y,onChange:A=>_(A.target.value),onKeyDown:O,onBlur:k,className:"flex-1 px-2 py-1 text-gray-800 font-medium bg-orange-50 rounded outline-none focus:ring-2 focus:ring-orange-400"}),f.jsx("button",{onClick:k,className:"p-1 text-green-600 hover:bg-green-50 rounded transition-colors border-0 outline-none",title:"Opslaan",children:f.jsx(uc,{size:16})})]}):f.jsxs("button",{onClick:s,className:"flex-1 min-w-0 text-left border-0 outline-none bg-transparent hover:bg-orange-50 rounded px-2 py-1 -ml-2 transition-colors",title:"Bekijk dashboard",children:[f.jsx("div",{className:"font-medium text-gray-800 truncate hover:text-orange-600",children:n.name}),f.jsx("div",{className:"text-xs text-gray-500",children:R>0?f.jsxs("span",{className:B===R?"text-green-600":"",children:[B,"/",R," voltooid"]}):"Geen punten"})]}),!g&&f.jsx("button",{onClick:T,className:"p-2 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none",title:"Naam bewerken",children:f.jsx(eg,{size:16})}),f.jsx("button",{onClick:s,className:"p-2 text-orange-400 hover:text-orange-600 hover:bg-orange-50 rounded transition-colors border-0 outline-none",title:"Open dashboard",children:f.jsx(gV,{size:18})}),!n.archived&&f.jsx("button",{onClick:r,className:`p-2 rounded transition-colors border-0 outline-none ${n.visible?"text-blue-500 hover:bg-blue-50":"text-gray-400 hover:bg-gray-100"}`,title:n.visible?"Verbergen":"Tonen",children:n.visible?f.jsx(Bv,{size:18}):f.jsx(Vv,{size:18})}),f.jsx("button",{onClick:i,className:`p-2 rounded transition-colors border-0 outline-none ${n.archived?"text-green-500 hover:text-green-600 hover:bg-green-50":"text-gray-400 hover:text-amber-600 hover:bg-amber-50"}`,title:n.archived?"Herstellen":"Archiveren",children:n.archived?f.jsx(Cle,{size:18}):f.jsx(oV,{size:18})}),f.jsx("button",{onClick:a,className:"p-2 text-gray-400 hover:text-green-600 hover:bg-green-50 rounded transition-colors border-0 outline-none",title:"Exporteren als GeoJSON",children:f.jsx(Fv,{size:18})}),f.jsx("button",{onClick:o,className:`p-2 rounded transition-colors border-0 outline-none ${l?"text-white bg-red-500 hover:bg-red-600":"text-gray-400 hover:text-red-600 hover:bg-red-50"}`,title:l?"Klik nogmaals om te verwijderen":"Verwijderen",children:f.jsx(_c,{size:18})})]}),f.jsx(An,{children:e&&f.jsx(wt.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:f.jsxs("div",{className:"px-4 pb-3 pl-12 space-y-2",children:[n.categories.length>0&&f.jsx("div",{className:"flex flex-wrap gap-1",children:n.categories.map(A=>f.jsx("span",{className:"px-2 py-0.5 bg-gray-100 text-gray-600 text-xs rounded-full",children:A},A))}),n.points.length>0&&f.jsxs("div",{className:"text-xs text-gray-500 space-y-1 max-h-32 overflow-y-auto",children:[n.points.slice(0,5).map(A=>f.jsx("div",{className:"flex items-center gap-2",children:f.jsx("span",{className:`font-medium ${A.status==="completed"?"text-green-600 line-through":A.status==="skipped"?"text-gray-400 line-through":"text-gray-700"}`,children:A.name})},A.id)),n.points.length>5&&f.jsxs("div",{className:"text-gray-400",children:["...en ",n.points.length-5," meer"]})]}),f.jsxs("div",{className:"text-xs text-gray-400",children:["Aangemaakt: ",new Date(n.createdAt).toLocaleDateString("nl-NL")]})]})})})]})}function rRe(){const{layerDashboardOpen:n,layerDashboardLayerId:e,closeLayerDashboard:t}=ur(),{getLayer:r,setPointStatus:i,updatePoint:s,removePoint:a}=Hi(),o=dn(),[l,c]=H.useState("all"),[h,g]=H.useState(null),[m,y]=H.useState(""),[_,x]=H.useState(null),w=e?r(e):null,b=14*o.fontScale/100;if(!w)return null;const T=w.points.filter(N=>l==="all"?!0:N.status===l),k=w.points.length,L=w.points.filter(N=>N.status==="completed").length,O=w.points.filter(N=>N.status==="todo").length,B=w.points.filter(N=>N.status==="skipped").length,R=(N,G)=>{i(w.id,N,G)},A=N=>{s(w.id,N,{notes:m}),g(null),y("")},P=N=>{_===N?(a(w.id,N),x(null)):(x(N),setTimeout(()=>x(null),3e3))},D=()=>{g(null),x(null),t()};return f.jsx(An,{children:n&&f.jsxs(f.Fragment,{children:[f.jsx(wt.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:D}),f.jsxs(wt.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[90vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[f.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:"w-4 h-4 rounded-full border-2 border-white/50",style:{backgroundColor:w.color}}),f.jsx("span",{className:"font-medium truncate",children:w.name})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"text-[10px] opacity-70",children:"T"}),f.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:o.fontScale,onChange:N=>o.setFontScale(parseInt(N.target.value)),className:"header-slider w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${o.fontScale}%`}),f.jsx("span",{className:"text-xs opacity-70",children:"T"}),f.jsx("button",{onClick:D,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none ml-1",children:f.jsx(Sr,{size:18})})]})]}),f.jsxs("div",{className:"px-4 py-2 bg-orange-50 flex items-center justify-between text-sm",children:[f.jsxs("span",{className:"text-orange-800 font-medium",children:[L,"/",k," voltooid"]}),f.jsxs("div",{className:"flex items-center gap-3 text-xs",children:[f.jsxs("span",{className:"text-orange-600",children:[O," te doen"]}),B>0&&f.jsxs("span",{className:"text-gray-500",children:[B," overgeslagen"]})]})]}),f.jsx("div",{className:"flex border-b border-gray-100",children:["all","todo","completed","skipped"].map(N=>f.jsxs("button",{onClick:()=>c(N),className:`flex-1 px-3 py-2 text-sm transition-colors border-0 outline-none ${l===N?"text-orange-600 border-b-2 border-orange-500 bg-orange-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[N==="all"&&"Alles",N==="todo"&&"Te doen",N==="completed"&&"Voltooid",N==="skipped"&&"Overgeslagen"]},N))}),f.jsx("div",{className:"flex-1 overflow-y-auto",style:{fontSize:`${b}px`},children:T.length===0?f.jsx("div",{className:"p-8 text-center text-gray-500",children:f.jsx("p",{children:"Geen punten gevonden"})}):f.jsx("div",{className:"divide-y divide-gray-100",children:T.map(N=>f.jsx("div",{className:"p-3",children:f.jsxs("div",{className:"flex items-start gap-3",children:[f.jsxs("div",{className:"flex flex-col gap-1 pt-0.5",children:[f.jsx("button",{onClick:()=>R(N.id,N.status==="completed"?"todo":"completed"),className:`w-6 h-6 flex items-center justify-center rounded border-0 outline-none transition-colors ${N.status==="completed"?"bg-green-100 hover:bg-green-200":"bg-gray-100 hover:bg-green-100"}`,title:N.status==="completed"?"Markeer als te doen":"Markeer als voltooid",children:f.jsx(uc,{size:14,className:N.status==="completed"?"text-green-600":"text-gray-400"})}),f.jsx("button",{onClick:()=>R(N.id,N.status==="skipped"?"todo":"skipped"),className:`w-6 h-6 flex items-center justify-center rounded border-0 outline-none transition-colors ${N.status==="skipped"?"bg-gray-200 hover:bg-gray-300":"bg-gray-100 hover:bg-gray-200"}`,title:N.status==="skipped"?"Markeer als te doen":"Overslaan",children:f.jsx(Mle,{size:14,className:N.status==="skipped"?"text-gray-600":"text-gray-400"})})]}),N.photos&&N.photos.length>0&&f.jsxs("div",{className:"relative flex-shrink-0",children:[f.jsx("img",{src:N.photos[0].thumbnailUrl||N.photos[0].thumbnailBase64,alt:"Foto",className:"w-12 h-12 object-cover rounded border border-gray-200"}),N.photos.length>1&&f.jsxs("span",{className:"absolute -bottom-1 -right-1 bg-orange-500 text-white text-[9px] px-1 rounded-full",children:["+",N.photos.length-1]})]}),f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:`font-medium truncate ${N.status==="completed"?"text-green-700 line-through":N.status==="skipped"?"text-gray-400 line-through":"text-gray-800"}`,children:N.name}),N.sourceLayer&&f.jsxs("span",{className:"text-xs text-gray-400 truncate",children:["via ",N.sourceLayer]})]}),h===N.id?f.jsxs("div",{className:"mt-2",children:[f.jsx("textarea",{value:m,onChange:G=>y(G.target.value),placeholder:"Notities...",rows:2,className:"w-full px-2 py-1 bg-white rounded border-0 outline-none hover:bg-blue-50 transition-colors resize-none text-sm",autoFocus:!0}),f.jsxs("div",{className:"flex gap-2 mt-1",children:[f.jsx("button",{onClick:()=>A(N.id),className:"px-2 py-1 text-xs bg-orange-500 text-white rounded hover:bg-orange-600 border-0 outline-none",children:"Opslaan"}),f.jsx("button",{onClick:()=>{g(null),y("")},className:"px-2 py-1 text-xs bg-white text-gray-600 rounded hover:bg-blue-50 border-0 outline-none",children:"Annuleren"})]})]}):N.notes?f.jsx("p",{className:"text-sm text-gray-600 mt-1",children:N.notes}):null,N.url&&f.jsxs("a",{href:N.url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-xs text-blue-500 hover:text-blue-700 mt-1",children:[f.jsx(Cu,{size:12}),"Link"]})]}),f.jsxs("div",{className:"flex flex-col gap-1",children:[f.jsx("button",{onClick:()=>{g(N.id),y(N.notes)},className:"w-6 h-6 flex items-center justify-center text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded border-0 outline-none",title:"Notities bewerken",children:f.jsx(iue,{size:14})}),f.jsx("button",{onClick:()=>{window.open(`https://www.google.com/maps/dir/?api=1&destination=${N.coordinates[1]},${N.coordinates[0]}`,"_blank")},className:"w-6 h-6 flex items-center justify-center text-blue-400 hover:text-blue-600 hover:bg-blue-50 rounded border-0 outline-none",title:"Navigeer naar",children:f.jsx(pa,{size:14})}),f.jsx("button",{onClick:()=>P(N.id),className:`w-6 h-6 flex items-center justify-center rounded border-0 outline-none ${_===N.id?"text-white bg-red-500 hover:bg-red-600":"text-gray-400 hover:text-red-600 hover:bg-red-50"}`,title:_===N.id?"Klik nogmaals":"Verwijderen",children:f.jsx(_c,{size:14})})]})]})},N.id))})})]})]})})}function iRe(){const[n,e]=H.useState(navigator.onLine),[t,r]=H.useState(!1);return H.useEffect(()=>{const i=()=>{e(!0),r(!1)},s=()=>{e(!1),r(!1)};return window.addEventListener("online",i),window.addEventListener("offline",s),()=>{window.removeEventListener("online",i),window.removeEventListener("offline",s)}},[]),n||t?null:f.jsx(An,{children:f.jsx(wt.div,{initial:{y:-50,opacity:0},animate:{y:0,opacity:1},exit:{y:-50,opacity:0},className:"fixed top-0 left-0 right-0 z-[2000] bg-amber-500 text-white px-4 py-2 shadow-lg",children:f.jsxs("div",{className:"flex items-center justify-between max-w-lg mx-auto",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(she,{size:18}),f.jsx("span",{className:"text-sm font-medium",children:"Offline modus - Kaart werkt met gecachede data"})]}),f.jsx("button",{onClick:()=>r(!0),className:"p-1 hover:bg-white/20 rounded transition-colors border-0 outline-none bg-transparent",children:f.jsx(Sr,{size:16})})]})})})}function sRe(n){return n}function aRe(n){if(n==null)return sRe;var e,t,r=n.scale[0],i=n.scale[1],s=n.translate[0],a=n.translate[1];return function(o,l){l||(e=t=0);var c=2,h=o.length,g=new Array(h);for(g[0]=(e+=o[0])*r+s,g[1]=(t+=o[1])*i+a;c<h;)g[c]=o[c],++c;return g}}function oRe(n,e){for(var t,r=n.length,i=r-e;i<--r;)t=n[i],n[i++]=n[r],n[r]=t}function lRe(n,e){return typeof e=="string"&&(e=n.objects[e]),e.type==="GeometryCollection"?{type:"FeatureCollection",features:e.geometries.map(function(t){return hD(n,t)})}:hD(n,e)}function hD(n,e){var t=e.id,r=e.bbox,i=e.properties==null?{}:e.properties,s=cRe(n,e);return t==null&&r==null?{type:"Feature",properties:i,geometry:s}:r==null?{type:"Feature",id:t,properties:i,geometry:s}:{type:"Feature",id:t,bbox:r,properties:i,geometry:s}}function cRe(n,e){var t=aRe(n.transform),r=n.arcs;function i(h,g){g.length&&g.pop();for(var m=r[h<0?~h:h],y=0,_=m.length;y<_;++y)g.push(t(m[y],y));h<0&&oRe(g,_)}function s(h){return t(h)}function a(h){for(var g=[],m=0,y=h.length;m<y;++m)i(h[m],g);return g.length<2&&g.push(g[0]),g}function o(h){for(var g=a(h);g.length<4;)g.push(g[0]);return g}function l(h){return h.map(o)}function c(h){var g=h.type,m;switch(g){case"GeometryCollection":return{type:g,geometries:h.geometries.map(c)};case"Point":m=s(h.coordinates);break;case"MultiPoint":m=h.coordinates.map(s);break;case"LineString":m=a(h.arcs);break;case"MultiLineString":m=h.arcs.map(a);break;case"Polygon":m=l(h.arcs);break;case"MultiPolygon":m=h.arcs.map(l);break;default:return null}return{type:g,coordinates:m}}return c(e)}async function MRe(n){try{const e=await fetch(n);if(!e.ok)throw new Error(`Failed to load ${n}: ${e.statusText}`);const t=await e.json();return console.log(` Loaded GeoJSON from ${n}`),t}catch(e){throw console.error(`Error loading GeoJSON from ${n}:`,e),e}}async function uRe(n){try{const e=await fetch(n);if(!e.ok)throw new Error(`Failed to load ${n}: ${e.statusText}`);const t=await e.json(),r=Object.keys(t.objects)[0],i=lRe(t,t.objects[r]);return console.log(` Loaded and converted TopoJSON from ${n}`),i}catch(e){throw console.error(`Error loading TopoJSON from ${n}:`,e),e}}function hRe(n){return new IE({featureProjection:"EPSG:3857"}).readFeatures(n)}const dz={all:{name:"Alle provincies",bounds:[3.37,50.75,7.21,53.47]},groningen:{name:"Groningen",bounds:[6.2,53.1,7.21,53.47]},friesland:{name:"Friesland",bounds:[5.05,52.85,6.25,53.45]},drenthe:{name:"Drenthe",bounds:[6.1,52.65,7.1,53.15]},overijssel:{name:"Overijssel",bounds:[5.85,52.15,6.9,52.7]},flevoland:{name:"Flevoland",bounds:[5.15,52.25,6,52.65]},gelderland:{name:"Gelderland",bounds:[5,51.75,6.4,52.45]},utrecht:{name:"Utrecht",bounds:[4.85,51.9,5.65,52.25]},"noord-holland":{name:"Noord-Holland",bounds:[4.5,52.2,5.25,52.95]},"zuid-holland":{name:"Zuid-Holland",bounds:[3.85,51.8,4.9,52.35]},zeeland:{name:"Zeeland",bounds:[3.37,51.2,4.3,51.75]},"noord-brabant":{name:"Noord-Brabant",bounds:[4.35,51.25,6,51.85]},limburg:{name:"Limburg",bounds:[5.55,50.75,6.25,51.8]}};function dRe(n,e,t){if(t==="all")return!0;const r=dz[t];if(!r)return!0;const[i,s,a,o]=r.bounds;return n>=i&&n<=a&&e>=s&&e<=o}let e_=null;async function fz(){if(e_)return e_;const n=await uRe("/detectorapp-nl/data/amk_monumenten_full.topojson");return e_=hRe(n),e_}function fRe(n,e,t=50){const r=n.toLowerCase(),i=e.toLowerCase(),s=r.indexOf(i);if(s===-1)return n.substring(0,100)+"...";const a=Math.max(0,s-t),o=Math.min(n.length,s+e.length+t);let l="";return a>0&&(l+="..."),l+=n.substring(a,o),o<n.length&&(l+="..."),l}async function gRe(n,e=50,t="all"){if(!n||n.length<2)return[];const r=await fz(),i=[],a=n.toLowerCase().split(/\s+/).filter(o=>o.length>=2);for(const o of r){const l=(o.get("omschrijving")||"").toLowerCase(),c=(o.get("toponiem")||"").toLowerCase(),h=(o.get("txt_label")||"").toLowerCase();if(a.every(m=>l.includes(m)||c.includes(m)||h.includes(m))){const m=o.getGeometry();if(!m)continue;const y=m.getExtent(),_=Eo(y),[x,w]=ag(_,"EPSG:3857","EPSG:4326");if(!dRe(x,w,t))continue;const b=o.get("omschrijving")||"";if(i.push({id:o.get("ID")||o.get("monumentnummer"),monumentnummer:o.get("monumentnummer"),toponiem:o.get("toponiem")||"Onbekend",kwaliteitswaarde:o.get("kwaliteitswaarde")||"",periode:o.get("txt_label")||"",omschrijving:b,matchedText:fRe(b,a[0]),coordinates:[x,w],extent:y}),i.length>=e)break}}return i.sort((o,l)=>{const c={"zeer hoge archeologische waarde":3,"hoge archeologische waarde":2,"archeologische waarde":1};return(c[l.kwaliteitswaarde]||0)-(c[o.kwaliteitswaarde]||0)}),i}async function mRe(n){return(await fz()).find(t=>t.get("monumentnummer")===n)||null}const pRe={"zeer hoge archeologische waarde":"bg-purple-600","hoge archeologische waarde":"bg-purple-500","archeologische waarde":"bg-purple-400"},yRe={"zeer hoge archeologische waarde":"Zeer hoog","hoge archeologische waarde":"Hoog","archeologische waarde":"Waarde"};let d0=null;function xRe(n){return d0||(d0=new pc({source:new xl,style:new gn({fill:new Jn({color:"rgba(147, 51, 234, 0.5)"}),stroke:new Hn({color:"#9333ea",width:3})}),zIndex:9999}),n.addLayer(d0)),d0}function _Re(){d0&&d0.getSource()?.clear()}async function vRe(n,e){const t=await mRe(e);if(!t)return;const i=xRe(n).getSource();i?.clear();const s=t.clone();i?.addFeature(s)}function wRe({isOpen:n,onClose:e}){const t=Xr(ce=>ce.map),r=dn(),[i,s]=H.useState(""),[a,o]=H.useState("all"),[l,c]=H.useState([]),[h,g]=H.useState(!1),[m,y]=H.useState(!1),[_,x]=H.useState(null),[w,b]=H.useState(null),[T,k]=H.useState(50),[L,O]=H.useState(!1),B=H.useRef(null),R=H.useRef(),A=13*r.fontScale/100;H.useEffect(()=>{n&&B.current&&setTimeout(()=>B.current?.focus(),100)},[n]),H.useEffect(()=>{n||O(!1)},[n]),H.useEffect(()=>{if(R.current&&clearTimeout(R.current),i.length<2){c([]),y(!1);return}return R.current=window.setTimeout(async()=>{g(!0),y(!0);try{const ce=await gRe(i,T,a);c(ce)}catch(ce){console.error("Monument search error:",ce),c([])}finally{g(!1)}},400),()=>{R.current&&clearTimeout(R.current)}},[i,a,T]);const P=async ce=>{if(!t)return;const je=t.getView();if(_===ce.id){const Pe=Xl(ce.extent,50);je.fit(Pe,{duration:500,maxZoom:18})}else{const Pe=Xl(ce.extent,200);je.fit(Pe,{duration:500,maxZoom:16}),await vRe(t,ce.monumentnummer),x(ce.id),b(ce.id)}},D=(ce,je)=>{if(je.stopPropagation(),!t)return;const Pe=t.getView(),ue=Xl(ce.extent,20);Pe.fit(ue,{duration:500,maxZoom:18})},N=(ce,je)=>{je.stopPropagation(),b(w===ce?null:ce)},G=()=>{e()},j=()=>{_Re(),s(""),o("all"),c([]),y(!1),x(null),b(null),k(50),e()},ve=ce=>{if(!i||i.length<2)return ce;const je=i.toLowerCase().split(/\s+/).filter(ue=>ue.length>=2);let Pe=ce;return je.forEach(ue=>{const Ne=ue.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),be=new RegExp(`(${Ne})`,"gi");Pe=Pe.replace(be,'<mark class="bg-yellow-200 px-0.5">$1</mark>')}),Pe};return n?f.jsx(An,{children:f.jsxs(wt.div,{initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{type:"spring",damping:25,stiffness:300},className:"fixed bottom-0 left-0 right-0 z-[1701] bg-white rounded-t-2xl shadow-2xl overflow-hidden flex flex-col",style:{height:L?"85vh":"38vh"},children:[f.jsxs("div",{className:"flex items-center justify-between px-4 py-2 bg-gradient-to-r from-purple-500 to-purple-600 text-white cursor-pointer select-none",onClick:()=>O(!L),children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(fV,{size:16}),f.jsx("span",{className:"font-medium text-sm",children:"Zoek monumenten"})]}),f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx(Lce,{size:20,className:"opacity-70"}),f.jsx("button",{onClick:ce=>{ce.stopPropagation(),G()},className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none ml-2",children:f.jsx(Sr,{size:16})})]})]}),f.jsx("div",{className:"p-2 border-b border-gray-100 space-y-2",children:f.jsxs("div",{className:"flex gap-2",children:[f.jsxs("div",{className:"relative flex-1",children:[f.jsx(zv,{size:16,className:"absolute left-2.5 top-1/2 -translate-y-1/2 text-gray-400"}),f.jsx("input",{ref:B,type:"text",value:i,onChange:ce=>{s(ce.target.value),x(null),b(null)},placeholder:"bouwvoor, scherven...",className:"w-full pl-8 pr-8 py-2 bg-gray-100 rounded-lg border-0 outline-none focus:ring-2 focus:ring-purple-500 text-sm"}),i&&f.jsx("button",{onClick:()=>{s(""),x(null),b(null)},className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 border-0 outline-none bg-transparent",children:f.jsx(Sr,{size:14})})]}),f.jsx("select",{value:a,onChange:ce=>{o(ce.target.value),x(null),b(null)},className:"py-1.5 px-2 bg-gray-100 rounded-lg border-0 outline-none focus:ring-2 focus:ring-purple-500 text-sm text-gray-700 w-28",children:Object.entries(dz).map(([ce,{name:je}])=>f.jsx("option",{value:ce,children:je},ce))})]})}),f.jsxs("div",{className:"flex-1 overflow-y-auto",style:{fontSize:`${A}px`},children:[h&&f.jsx("div",{className:"p-3 text-center text-gray-500 text-sm",children:"Zoeken..."}),!h&&m&&l.length===0&&f.jsx("div",{className:"p-3 text-center text-gray-500 text-sm",children:"Geen resultaten"}),!h&&l.length>0&&f.jsxs("div",{className:"divide-y divide-gray-100",children:[f.jsxs("div",{className:"px-3 py-1.5 bg-gray-50 text-xs text-gray-500 flex justify-between items-center",children:[f.jsxs("span",{children:[l.length,l.length>=T?"+":""," gevonden"]}),l.length>=T&&f.jsx("button",{onClick:()=>k(T+50),className:"text-purple-600 hover:text-purple-700 border-0 outline-none bg-transparent",children:"Meer laden"})]}),l.map(ce=>f.jsxs("div",{className:`transition-colors ${_===ce.id?"bg-purple-50":"bg-transparent"}`,children:[f.jsx("button",{onClick:()=>P(ce),className:"w-full text-left px-3 py-2 hover:bg-purple-50 transition-colors border-0 outline-none bg-transparent",children:f.jsxs("div",{className:"flex items-start justify-between gap-2",children:[f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsx("p",{className:"font-medium text-gray-800 text-sm",children:ce.toponiem}),f.jsx("p",{className:"text-xs text-purple-600 mt-0.5",children:ce.periode})]}),f.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[f.jsx("span",{className:`px-1.5 py-0.5 rounded text-white text-[9px] ${pRe[ce.kwaliteitswaarde]||"bg-gray-500"}`,children:yRe[ce.kwaliteitswaarde]||"AMK"}),_===ce.id&&f.jsx("button",{onClick:je=>D(ce,je),className:"p-1 bg-purple-500 hover:bg-purple-600 text-white rounded transition-colors border-0 outline-none",title:"Zoom in",children:f.jsx(che,{size:12})})]})]})}),_===ce.id&&f.jsxs("div",{className:"px-3 pb-2",children:[f.jsxs("button",{onClick:je=>N(ce.id,je),className:"flex items-center gap-1 text-xs text-purple-600 hover:text-purple-700 border-0 outline-none bg-transparent mb-1",children:[w===ce.id?f.jsx(AE,{size:14}):f.jsx(pg,{size:14}),w===ce.id?"Minder":"Omschrijving"]}),w===ce.id&&f.jsx("div",{className:"text-xs text-gray-700 bg-gray-50 rounded p-2 max-h-32 overflow-y-auto whitespace-pre-wrap",dangerouslySetInnerHTML:{__html:ve(ce.omschrijving)}})]})]},ce.id))]}),!h&&!m&&f.jsx("div",{className:"p-3 text-xs text-gray-500",children:"Zoek op trefwoorden in 13.000+ AMK monumenten"})]}),(_||i)&&f.jsx("div",{className:"p-2 border-t border-gray-100",children:f.jsx("button",{onClick:j,className:"w-full py-2 text-sm text-gray-600 hover:text-gray-800 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors border-0 outline-none",children:"Wis zoekopdracht en highlight"})})]})}):null}class dD{buffer=[];size;weights;constructor(e=8){this.size=e,this.weights=Array.from({length:e},(r,i)=>Math.pow(2,i));const t=this.weights.reduce((r,i)=>r+i,0);this.weights=this.weights.map(r=>r/t)}add(e){if(this.buffer.length>0){const t=this.buffer[this.buffer.length-1];let r=e-t;r>180&&(e-=360),r<-180&&(e+=360)}this.buffer.push(e),this.buffer.length>this.size&&this.buffer.shift()}getSmoothed(){if(this.buffer.length===0)return null;if(this.buffer.length===1)return this.normalizeHeading(this.buffer[0]);let e=0,t=0;const r=this.size-this.buffer.length;for(let i=0;i<this.buffer.length;i++){const s=this.weights[r+i];e+=this.buffer[i]*s,t+=s}return this.normalizeHeading(e/t)}normalizeHeading(e){return(e%360+360)%360}clear(){this.buffer=[]}}function ERe(){const n=ls(c=>c.tracking),e=ls(c=>c.headingSource);ls(c=>c.speed);const t=ls(c=>c.setSmoothedHeading),r=H.useRef(new dD(6)),i=H.useRef(new dD(10)),s=H.useRef(0),a=H.useRef(null),o=33,l=H.useCallback((c,h)=>{const g=performance.now();if(g-s.current<o)return;const m=h==="gps"?r.current:i.current;m.add(c);const y=m.getSmoothed();y!==null&&(s.current=g,t(y))},[t]);H.useEffect(()=>{if(!n)return;const c=g=>{g.coords.heading!==null&&g.coords.speed!==null&&g.coords.speed>.8&&g.coords.accuracy<20&&l(g.coords.heading,"gps")},h=navigator.geolocation.watchPosition(c,()=>{},{enableHighAccuracy:!0,maximumAge:500,timeout:1e4});return()=>navigator.geolocation.clearWatch(h)},[n,l]),H.useEffect(()=>{if(!n||e!=="compass")return;let c=0;const h=50,g=y=>{const _=performance.now();if(!(_-c<h)&&(c=_,y.alpha!==null)){const x=(360-y.alpha)%360;l(x,"compass")}},m=y=>{const _=performance.now();_-c<h||(c=_,y.webkitCompassHeading!==void 0&&l(y.webkitCompassHeading,"compass"))};return window.addEventListener("deviceorientationabsolute",g),window.addEventListener("deviceorientation",m),()=>{window.removeEventListener("deviceorientationabsolute",g),window.removeEventListener("deviceorientation",m)}},[n,e,l]),H.useEffect(()=>{n||(r.current.clear(),i.current.clear())},[n]),H.useEffect(()=>()=>{a.current&&cancelAnimationFrame(a.current)},[])}function SRe(){const n=Xr(i=>i.map),e=Ti(i=>i.setLayerOpacity),t=Ti(i=>i.visible),r=H.useRef(null);H.useEffect(()=>{if(!n)return;const i=()=>{const s=n.getView().getZoom();if(!s||r.current!==null&&Math.abs(s-r.current)<.5)return;r.current=s;const a=t["AHN 0.5m"],o=t["AHN4 Multi-Hillshade NL"];!a&&!o||(a&&(s>=18?e("AHN 0.5m",.85):s>=16?e("AHN 0.5m",.75):s>=14?e("AHN 0.5m",.65):e("AHN 0.5m",.55)),o&&(s>=18?e("AHN4 Multi-Hillshade NL",.8):s>=16?e("AHN4 Multi-Hillshade NL",.7):s>=14?e("AHN4 Multi-Hillshade NL",.6):e("AHN4 Multi-Hillshade NL",.5)))};return n.on("moveend",i),i(),()=>{n.un("moveend",i)}},[n,t,e])}const fD=2e3;function bRe(){const n=_E(m=>m.user),{layers:e,clearAll:t}=Hi(),{vondsten:r,clearAll:i}=ul(),s=H.useRef(null),a=H.useRef(!0),o=H.useRef(""),l=H.useRef(""),c=H.useCallback(async m=>{if(n)try{const y=v0(yu,"users",n.uid);await h3(y,{layers:m,layersUpdatedAt:d3()},{merge:!0}),console.log(" Lagen gesynchroniseerd naar cloud")}catch(y){console.error(" Fout bij synchroniseren lagen:",y)}},[n]),h=H.useCallback(async m=>{if(n)try{const y=v0(yu,"users",n.uid);await h3(y,{vondsten:m,vondstenUpdatedAt:d3()},{merge:!0}),console.log(" Vondsten gesynchroniseerd naar cloud")}catch(y){console.error(" Fout bij synchroniseren vondsten:",y)}},[n]),g=H.useCallback(async()=>{if(n)try{const m=v0(yu,"users",n.uid),y=await sre(m);if(y.exists()){const _=y.data();if(_.layers&&Array.isArray(_.layers)){const x=_.layers,w=Hi.getState().layers,b=[...x],T=new Set(x.map(k=>k.id));w.forEach(k=>{T.has(k.id)||b.push(k)}),Hi.setState({layers:b}),o.current=JSON.stringify(b),console.log(` ${x.length} lagen geladen uit cloud`)}if(_.vondsten&&Array.isArray(_.vondsten)){const x=_.vondsten,w=ul.getState().vondsten,b=[...x],T=new Set(x.map(k=>k.id));w.forEach(k=>{T.has(k.id)||b.push(k)}),ul.setState({vondsten:b}),l.current=JSON.stringify(b),console.log(` ${x.length} vondsten geladen uit cloud`)}}else console.log(" Geen cloud data gevonden, lokale data wordt gesynchroniseerd..."),await c(e),await h(r);a.current=!1}catch(m){console.error(" Fout bij laden uit cloud:",m),a.current=!1}},[n,e,r,c,h]);return H.useEffect(()=>{n?(a.current=!0,g()):(a.current=!0,o.current="",l.current="")},[n?.uid]),H.useEffect(()=>{if(!n||a.current)return;const m=JSON.stringify(e);if(m!==o.current)return s.current&&clearTimeout(s.current),s.current=setTimeout(()=>{o.current=m,c(e)},fD),()=>{s.current&&clearTimeout(s.current)}},[n,e,c]),H.useEffect(()=>{if(!n||a.current)return;const m=JSON.stringify(r);if(m!==l.current)return s.current&&clearTimeout(s.current),s.current=setTimeout(()=>{l.current=m,h(r)},fD),()=>{s.current&&clearTimeout(s.current)}},[n,r,h]),{isLoggedIn:!!n,syncLayersToCloud:c,syncVondstenToCloud:h}}function TRe(){ERe(),SRe(),bRe();const e=14*dn(g=>g.fontScale)/100,t=ur(g=>g.vondstFormOpen),r=ur(g=>g.vondstFormLocation),i=ur(g=>g.closeVondstForm),s=ur(g=>g.routeDashboardOpen),a=ur(g=>g.toggleRouteDashboard),o=ur(g=>g.monumentSearchOpen),l=ur(g=>g.closeMonumentSearch),c=Zm(g=>g.showBuienradar),h=Zm(g=>g.setShowBuienradar);return f.jsx(Lbe,{children:f.jsxs("div",{style:{fontSize:`${e}px`},children:[f.jsx(iRe,{}),f.jsx(Zre,{}),f.jsx(fhe,{}),f.jsx(zTe,{}),f.jsx(Bbe,{}),f.jsx(WTe,{}),f.jsx(STe,{}),f.jsx(bTe,{}),f.jsx(TTe,{}),f.jsx(ATe,{}),f.jsx(ybe,{}),f.jsx(_be,{}),f.jsx(Pbe,{}),f.jsx(hhe,{}),f.jsx(vTe,{}),f.jsx(wTe,{}),f.jsx(Nbe,{}),f.jsx(mhe,{}),f.jsx(vhe,{}),f.jsx(Cbe,{}),f.jsx(rTe,{}),f.jsx(Rbe,{}),f.jsx(sTe,{}),f.jsx(Abe,{}),f.jsx(VTe,{}),f.jsx(BTe,{isVisible:c,onClose:()=>h(!1)}),f.jsx(Qbe,{}),f.jsx(HTe,{}),f.jsx(QTe,{}),f.jsx(eRe,{}),f.jsx(rRe,{}),f.jsx(LTe,{isOpen:s,onClose:a}),f.jsx(An,{children:t&&f.jsx(cz,{onClose:i,initialLocation:r||void 0})}),f.jsx(wRe,{isOpen:o,onClose:l})]})})}console.log(`%c DetectorApp v${pw}`,"background: #4CAF50; color: white; padding: 4px 8px; border-radius: 4px; font-weight: bold;");IU.createRoot(document.getElementById("root")).render(f.jsx(TRe,{}));export{Us as C,vr as F,IE as G,sX as I,Ow as L,mi as P,gn as S,iu as T,xl as V,BX as a,NX as b,pc as c,Hn as d,S1 as e,Jn as f,hRe as g,MRe as h,yo as i,Ir as j,bi as k,uRe as l,Tn as p,bB as r};
//# sourceMappingURL=index-DnndzbEy.js.map
