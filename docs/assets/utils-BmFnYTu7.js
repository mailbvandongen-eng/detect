const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/symbolLayerUtils-Qt6gGLRH.js","assets/index-CNFGw7t3.js","assets/index-CkSBzscD.css","assets/LRUCache-DcUYMRcX.js","assets/MemCache-D78-dcPf.js"])))=>i.map(i=>d[i]);
import{aE as s,gM as y,gN as m,gO as b,gP as w,gQ as g,s as k}from"./index-CNFGw7t3.js";import{S as L,u as v}from"./cimSymbolUtils-BhxseeT5.js";import{e as z}from"./LRUCache-DcUYMRcX.js";new z(1e3);new s([128,128,128]);function I(n){if(n==null||!("symbolLayers"in n)||n.symbolLayers==null)return!1;switch(n.type){case"point-3d":return n.symbolLayers.some(r=>r.type==="object");case"line-3d":return n.symbolLayers.some(r=>r.type==="path");case"polygon-3d":return n.symbolLayers.some(r=>r.type==="object"||r.type==="extrude");default:return!1}}function J(n){return n.resource?.href??""}function Q(n,r){if(!n)return null;let o=null;return y(n)?o=S(n):m(n)&&(o=n.type==="cim"?v(n):n.color?new s(n.color):null),o?u(o,r):null}function S(n){const r=n.symbolLayers;if(!r)return null;let o=null;return r.forEach(l=>{l.type==="object"&&l.resource?.href||(o=l.type==="water"?l.color:l.material?l.material.color:null)}),o?new s(o):null}function u(n,r){if(r==null||n==null)return n;const o=n.toRgba();return o[3]=o[3]*r,new s(o)}function x(n,r,o){const l=n.symbolLayers;if(!l)return;const e=(t,c=!1)=>{let i=r??t??null;return o?.override!=null&&(!i&&c&&(i=new s([255,255,255])),i&&(i.a=o.override)),u(i,o?.add)};l.forEach(t=>{if(t.type==="water")return void(t.color=u(t.color,o?.add));const c=t.material!=null?t.material.color:null,i=e(c,t.type==="icon"&&t.resource?.href!=null);t.material==null?t.material=new w({color:i}):t.material.color=i,"outline"in t&&t.outline?.color&&o?.add!=null&&(t.outline.color=u(t.outline.color,o.add)),"marker"in t&&t.marker!=null&&(t.marker.color=e(t.marker.color))})}function _(n,r,o){r=r??n.color,o?.override!=null&&r&&(r.a=o.override),r&&(n.color=u(r,o?.add)),"outline"in n&&n.outline?.color&&(n.outline.color=u(n.outline.color,o?.add))}function T(n,r,o){n&&(r||o!=null)&&(r&&(r=new s(r)),y(n)?x(n,r,o):m(n)&&_(n,r,o))}async function j(n,r){const o=n.symbolLayers;o&&await b(o,async l=>E(l,r))}async function E(n,r){switch(n.type){case"extrude":O(n,r);break;case"icon":case"line":case"text":$(n,r);break;case"path":P(n,r);break;case"object":await R(n,r)}}function $(n,r){const o=h(r);o!=null&&(n.size=o)}function h(n){for(const r of n)if(typeof r=="number")return r;return null}function O(n,r){const o=r[2];typeof o=="number"&&(n.size=o)}async function R(n,r){const{resourceSize:o,symbolSize:l}=await A(n),e=p(r,o,l);e!=null&&(n.width=f(r[0],l[0],o[0],e),n.depth=f(r[1],l[1],o[1],e),n.height=f(r[2],l[2],o[2],e))}function P(n,r){const o=p(r,g,[n.width,void 0,n.height]);o!=null&&(n.width=f(r[0],n.width,1,o),n.height=f(r[2],n.height,1,o))}function p(n,r,o){for(let l=0;l<3;l++){const e=n[l];switch(e){case"symbol-value":{const t=o[l];return t!=null?t/r[l]:1}case"proportional":break;default:if(e&&r[l])return e/r[l]}}return null}async function A(n){const{computeObjectLayerResourceSize:r}=await k(()=>import("./symbolLayerUtils-Qt6gGLRH.js"),__vite__mapDeps([0,1,2,3,4])),o=await r(n,10),{width:l,height:e,depth:t}=n,c=[l,t,e];let i=1;for(let a=0;a<3;a++){const d=c[a];if(d!=null){i=d/o[a];break}}for(let a=0;a<3;a++)c[a]==null&&(c[a]=o[a]*i);return{resourceSize:o,symbolSize:c}}function f(n,r,o,l){switch(n){case"proportional":return o*l;case"symbol-value":return r??o;default:return n}}function D(n,r){const o=h(r);if(o!=null)switch(n.type){case"simple-marker":n.size=o;break;case"picture-marker":{const l=n.width/n.height;l>1?(n.width=o,n.height=o*l):(n.width=o*l,n.height=o);break}case"simple-line":n.width=o;break;case"text":n.font.size=o}}async function U(n,r){if(n&&r)return y(n)?j(n,r):void(m(n)&&D(n,r))}function V(n,r,o){if(n&&r!=null){if(y(n)){const l=n.symbolLayers;l&&l.forEach(e=>{if(e.type==="object")switch(o){case"tilt":e.tilt=(e.tilt??0)+r;break;case"roll":e.roll=(e.roll??0)+r;break;default:e.heading=(e.heading??0)+r}e.type==="icon"&&(e.angle+=r)})}else if(m(n))switch(n.type){case"simple-marker":case"picture-marker":case"text":n.angle+=r;break;case"cim":L(n,r,!0)}}}function q(n){return n!=null&&n.type==="polygon-3d"&&n.symbolLayers.some(r=>r.type==="extrude")}export{q as A,T as L,U as M,V as N,Q as b,J as d,I as h};
//# sourceMappingURL=utils-BmFnYTu7.js.map
